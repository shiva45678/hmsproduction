var aA=Object.defineProperty;var sA=(e,n,t)=>n in e?aA(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var Rn=(e,n,t)=>sA(e,typeof n!="symbol"?n+"":n,t);function lA(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const l=Object.getOwnPropertyDescriptor(r,a);l&&Object.defineProperty(e,a,l.get?l:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();var Uc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Fd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var P0={exports:{}},bm={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ww;function oA(){if(Ww)return bm;Ww=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function t(r,a,l){var o=null;if(l!==void 0&&(o=""+l),a.key!==void 0&&(o=""+a.key),"key"in a){l={};for(var f in a)f!=="key"&&(l[f]=a[f])}else l=a;return a=l.ref,{$$typeof:e,type:r,key:o,ref:a!==void 0?a:null,props:l}}return bm.Fragment=n,bm.jsx=t,bm.jsxs=t,bm}var Qw;function cA(){return Qw||(Qw=1,P0.exports=oA()),P0.exports}var i=cA(),I0={exports:{}},zt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jw;function uA(){if(Jw)return zt;Jw=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),o=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;function b(A){return A===null||typeof A!="object"?null:(A=g&&A[g]||A["@@iterator"],typeof A=="function"?A:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,k={};function T(A,ae,ce){this.props=A,this.context=ae,this.refs=k,this.updater=ce||v}T.prototype.isReactComponent={},T.prototype.setState=function(A,ae){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,ae,"setState")},T.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function E(){}E.prototype=T.prototype;function I(A,ae,ce){this.props=A,this.context=ae,this.refs=k,this.updater=ce||v}var P=I.prototype=new E;P.constructor=I,N(P,T.prototype),P.isPureReactComponent=!0;var V=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},$=Object.prototype.hasOwnProperty;function B(A,ae,ce,M,de,Se){return ce=Se.ref,{$$typeof:e,type:A,key:ae,ref:ce!==void 0?ce:null,props:Se}}function z(A,ae){return B(A.type,ae,void 0,void 0,void 0,A.props)}function q(A){return typeof A=="object"&&A!==null&&A.$$typeof===e}function O(A){var ae={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(ce){return ae[ce]})}var R=/\/+/g;function G(A,ae){return typeof A=="object"&&A!==null&&A.key!=null?O(""+A.key):ae.toString(36)}function ee(){}function te(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(ee,ee):(A.status="pending",A.then(function(ae){A.status==="pending"&&(A.status="fulfilled",A.value=ae)},function(ae){A.status==="pending"&&(A.status="rejected",A.reason=ae)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function le(A,ae,ce,M,de){var Se=typeof A;(Se==="undefined"||Se==="boolean")&&(A=null);var fe=!1;if(A===null)fe=!0;else switch(Se){case"bigint":case"string":case"number":fe=!0;break;case"object":switch(A.$$typeof){case e:case n:fe=!0;break;case h:return fe=A._init,le(fe(A._payload),ae,ce,M,de)}}if(fe)return de=de(A),fe=M===""?"."+G(A,0):M,V(de)?(ce="",fe!=null&&(ce=fe.replace(R,"$&/")+"/"),le(de,ae,ce,"",function(_e){return _e})):de!=null&&(q(de)&&(de=z(de,ce+(de.key==null||A&&A.key===de.key?"":(""+de.key).replace(R,"$&/")+"/")+fe)),ae.push(de)),1;fe=0;var we=M===""?".":M+":";if(V(A))for(var re=0;re<A.length;re++)M=A[re],Se=we+G(M,re),fe+=le(M,ae,ce,Se,de);else if(re=b(A),typeof re=="function")for(A=re.call(A),re=0;!(M=A.next()).done;)M=M.value,Se=we+G(M,re++),fe+=le(M,ae,ce,Se,de);else if(Se==="object"){if(typeof A.then=="function")return le(te(A),ae,ce,M,de);throw ae=String(A),Error("Objects are not valid as a React child (found: "+(ae==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":ae)+"). If you meant to render a collection of children, use an array instead.")}return fe}function K(A,ae,ce){if(A==null)return A;var M=[],de=0;return le(A,M,"","",function(Se){return ae.call(ce,Se,de++)}),M}function U(A){if(A._status===-1){var ae=A._result;ae=ae(),ae.then(function(ce){(A._status===0||A._status===-1)&&(A._status=1,A._result=ce)},function(ce){(A._status===0||A._status===-1)&&(A._status=2,A._result=ce)}),A._status===-1&&(A._status=0,A._result=ae)}if(A._status===1)return A._result.default;throw A._result}var J=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ae=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(ae))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)};function ne(){}return zt.Children={map:K,forEach:function(A,ae,ce){K(A,function(){ae.apply(this,arguments)},ce)},count:function(A){var ae=0;return K(A,function(){ae++}),ae},toArray:function(A){return K(A,function(ae){return ae})||[]},only:function(A){if(!q(A))throw Error("React.Children.only expected to receive a single React element child.");return A}},zt.Component=T,zt.Fragment=t,zt.Profiler=a,zt.PureComponent=I,zt.StrictMode=r,zt.Suspense=u,zt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,zt.__COMPILER_RUNTIME={__proto__:null,c:function(A){return F.H.useMemoCache(A)}},zt.cache=function(A){return function(){return A.apply(null,arguments)}},zt.cloneElement=function(A,ae,ce){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var M=N({},A.props),de=A.key,Se=void 0;if(ae!=null)for(fe in ae.ref!==void 0&&(Se=void 0),ae.key!==void 0&&(de=""+ae.key),ae)!$.call(ae,fe)||fe==="key"||fe==="__self"||fe==="__source"||fe==="ref"&&ae.ref===void 0||(M[fe]=ae[fe]);var fe=arguments.length-2;if(fe===1)M.children=ce;else if(1<fe){for(var we=Array(fe),re=0;re<fe;re++)we[re]=arguments[re+2];M.children=we}return B(A.type,de,void 0,void 0,Se,M)},zt.createContext=function(A){return A={$$typeof:o,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:l,_context:A},A},zt.createElement=function(A,ae,ce){var M,de={},Se=null;if(ae!=null)for(M in ae.key!==void 0&&(Se=""+ae.key),ae)$.call(ae,M)&&M!=="key"&&M!=="__self"&&M!=="__source"&&(de[M]=ae[M]);var fe=arguments.length-2;if(fe===1)de.children=ce;else if(1<fe){for(var we=Array(fe),re=0;re<fe;re++)we[re]=arguments[re+2];de.children=we}if(A&&A.defaultProps)for(M in fe=A.defaultProps,fe)de[M]===void 0&&(de[M]=fe[M]);return B(A,Se,void 0,void 0,null,de)},zt.createRef=function(){return{current:null}},zt.forwardRef=function(A){return{$$typeof:f,render:A}},zt.isValidElement=q,zt.lazy=function(A){return{$$typeof:h,_payload:{_status:-1,_result:A},_init:U}},zt.memo=function(A,ae){return{$$typeof:d,type:A,compare:ae===void 0?null:ae}},zt.startTransition=function(A){var ae=F.T,ce={};F.T=ce;try{var M=A(),de=F.S;de!==null&&de(ce,M),typeof M=="object"&&M!==null&&typeof M.then=="function"&&M.then(ne,J)}catch(Se){J(Se)}finally{F.T=ae}},zt.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},zt.use=function(A){return F.H.use(A)},zt.useActionState=function(A,ae,ce){return F.H.useActionState(A,ae,ce)},zt.useCallback=function(A,ae){return F.H.useCallback(A,ae)},zt.useContext=function(A){return F.H.useContext(A)},zt.useDebugValue=function(){},zt.useDeferredValue=function(A,ae){return F.H.useDeferredValue(A,ae)},zt.useEffect=function(A,ae,ce){var M=F.H;if(typeof ce=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return M.useEffect(A,ae)},zt.useId=function(){return F.H.useId()},zt.useImperativeHandle=function(A,ae,ce){return F.H.useImperativeHandle(A,ae,ce)},zt.useInsertionEffect=function(A,ae){return F.H.useInsertionEffect(A,ae)},zt.useLayoutEffect=function(A,ae){return F.H.useLayoutEffect(A,ae)},zt.useMemo=function(A,ae){return F.H.useMemo(A,ae)},zt.useOptimistic=function(A,ae){return F.H.useOptimistic(A,ae)},zt.useReducer=function(A,ae,ce){return F.H.useReducer(A,ae,ce)},zt.useRef=function(A){return F.H.useRef(A)},zt.useState=function(A){return F.H.useState(A)},zt.useSyncExternalStore=function(A,ae,ce){return F.H.useSyncExternalStore(A,ae,ce)},zt.useTransition=function(){return F.H.useTransition()},zt.version="19.1.0",zt}var Kw;function B1(){return Kw||(Kw=1,I0.exports=uA()),I0.exports}var w=B1();const En=Fd(w),Xw=lA({__proto__:null,default:En},[w]);var M0={exports:{}},vm={},R0={exports:{}},L0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zw;function dA(){return Zw||(Zw=1,function(e){function n(K,U){var J=K.length;K.push(U);e:for(;0<J;){var ne=J-1>>>1,A=K[ne];if(0<a(A,U))K[ne]=U,K[J]=A,J=ne;else break e}}function t(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var U=K[0],J=K.pop();if(J!==U){K[0]=J;e:for(var ne=0,A=K.length,ae=A>>>1;ne<ae;){var ce=2*(ne+1)-1,M=K[ce],de=ce+1,Se=K[de];if(0>a(M,J))de<A&&0>a(Se,M)?(K[ne]=Se,K[de]=J,ne=de):(K[ne]=M,K[ce]=J,ne=ce);else if(de<A&&0>a(Se,J))K[ne]=Se,K[de]=J,ne=de;else break e}}return U}function a(K,U){var J=K.sortIndex-U.sortIndex;return J!==0?J:K.id-U.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,f=o.now();e.unstable_now=function(){return o.now()-f}}var u=[],d=[],h=1,g=null,b=3,v=!1,N=!1,k=!1,T=!1,E=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;function V(K){for(var U=t(d);U!==null;){if(U.callback===null)r(d);else if(U.startTime<=K)r(d),U.sortIndex=U.expirationTime,n(u,U);else break;U=t(d)}}function F(K){if(k=!1,V(K),!N)if(t(u)!==null)N=!0,$||($=!0,G());else{var U=t(d);U!==null&&le(F,U.startTime-K)}}var $=!1,B=-1,z=5,q=-1;function O(){return T?!0:!(e.unstable_now()-q<z)}function R(){if(T=!1,$){var K=e.unstable_now();q=K;var U=!0;try{e:{N=!1,k&&(k=!1,I(B),B=-1),v=!0;var J=b;try{t:{for(V(K),g=t(u);g!==null&&!(g.expirationTime>K&&O());){var ne=g.callback;if(typeof ne=="function"){g.callback=null,b=g.priorityLevel;var A=ne(g.expirationTime<=K);if(K=e.unstable_now(),typeof A=="function"){g.callback=A,V(K),U=!0;break t}g===t(u)&&r(u),V(K)}else r(u);g=t(u)}if(g!==null)U=!0;else{var ae=t(d);ae!==null&&le(F,ae.startTime-K),U=!1}}break e}finally{g=null,b=J,v=!1}U=void 0}}finally{U?G():$=!1}}}var G;if(typeof P=="function")G=function(){P(R)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,te=ee.port2;ee.port1.onmessage=R,G=function(){te.postMessage(null)}}else G=function(){E(R,0)};function le(K,U){B=E(function(){K(e.unstable_now())},U)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(K){K.callback=null},e.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<K?Math.floor(1e3/K):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(K){switch(b){case 1:case 2:case 3:var U=3;break;default:U=b}var J=b;b=U;try{return K()}finally{b=J}},e.unstable_requestPaint=function(){T=!0},e.unstable_runWithPriority=function(K,U){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var J=b;b=K;try{return U()}finally{b=J}},e.unstable_scheduleCallback=function(K,U,J){var ne=e.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?ne+J:ne):J=ne,K){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=J+A,K={id:h++,callback:U,priorityLevel:K,startTime:J,expirationTime:A,sortIndex:-1},J>ne?(K.sortIndex=J,n(d,K),t(u)===null&&K===t(d)&&(k?(I(B),B=-1):k=!0,le(F,J-ne))):(K.sortIndex=A,n(u,K),N||v||(N=!0,$||($=!0,G()))),K},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(K){var U=b;return function(){var J=b;b=U;try{return K.apply(this,arguments)}finally{b=J}}}}(L0)),L0}var eS;function fA(){return eS||(eS=1,R0.exports=dA()),R0.exports}var O0={exports:{}},vr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tS;function hA(){if(tS)return vr;tS=1;var e=B1();function n(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)d+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(n(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(u,d,h){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:g==null?null:""+g,children:u,containerInfo:d,implementation:h}}var o=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return vr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,vr.createPortal=function(u,d){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(n(299));return l(u,d,null,h)},vr.flushSync=function(u){var d=o.T,h=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=d,r.p=h,r.d.f()}},vr.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(u,d))},vr.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},vr.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var h=d.as,g=f(h,d.crossOrigin),b=typeof d.integrity=="string"?d.integrity:void 0,v=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;h==="style"?r.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:g,integrity:b,fetchPriority:v}):h==="script"&&r.d.X(u,{crossOrigin:g,integrity:b,fetchPriority:v,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},vr.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var h=f(d.as,d.crossOrigin);r.d.M(u,{crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(u)},vr.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var h=d.as,g=f(h,d.crossOrigin);r.d.L(u,h,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},vr.preloadModule=function(u,d){if(typeof u=="string")if(d){var h=f(d.as,d.crossOrigin);r.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(u)},vr.requestFormReset=function(u){r.d.r(u)},vr.unstable_batchedUpdates=function(u,d){return u(d)},vr.useFormState=function(u,d,h){return o.H.useFormState(u,d,h)},vr.useFormStatus=function(){return o.H.useHostTransitionStatus()},vr.version="19.1.0",vr}var nS;function a_(){if(nS)return O0.exports;nS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),O0.exports=hA(),O0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iS;function pA(){if(iS)return vm;iS=1;var e=fA(),n=B1(),t=a_();function r(s){var c="https://react.dev/errors/"+s;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)c+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+s+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var c=s,p=s;if(s.alternate)for(;c.return;)c=c.return;else{s=c;do c=s,(c.flags&4098)!==0&&(p=c.return),s=c.return;while(s)}return c.tag===3?p:null}function o(s){if(s.tag===13){var c=s.memoizedState;if(c===null&&(s=s.alternate,s!==null&&(c=s.memoizedState)),c!==null)return c.dehydrated}return null}function f(s){if(l(s)!==s)throw Error(r(188))}function u(s){var c=s.alternate;if(!c){if(c=l(s),c===null)throw Error(r(188));return c!==s?null:s}for(var p=s,x=c;;){var S=p.return;if(S===null)break;var D=S.alternate;if(D===null){if(x=S.return,x!==null){p=x;continue}break}if(S.child===D.child){for(D=S.child;D;){if(D===p)return f(S),s;if(D===x)return f(S),c;D=D.sibling}throw Error(r(188))}if(p.return!==x.return)p=S,x=D;else{for(var H=!1,Z=S.child;Z;){if(Z===p){H=!0,p=S,x=D;break}if(Z===x){H=!0,x=S,p=D;break}Z=Z.sibling}if(!H){for(Z=D.child;Z;){if(Z===p){H=!0,p=D,x=S;break}if(Z===x){H=!0,x=D,p=S;break}Z=Z.sibling}if(!H)throw Error(r(189))}}if(p.alternate!==x)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?s:c}function d(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s;for(s=s.child;s!==null;){if(c=d(s),c!==null)return c;s=s.sibling}return null}var h=Object.assign,g=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),I=Symbol.for("react.consumer"),P=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),$=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),q=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),R=Symbol.iterator;function G(s){return s===null||typeof s!="object"?null:(s=R&&s[R]||s["@@iterator"],typeof s=="function"?s:null)}var ee=Symbol.for("react.client.reference");function te(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===ee?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case N:return"Fragment";case T:return"Profiler";case k:return"StrictMode";case F:return"Suspense";case $:return"SuspenseList";case q:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case v:return"Portal";case P:return(s.displayName||"Context")+".Provider";case I:return(s._context.displayName||"Context")+".Consumer";case V:var c=s.render;return s=s.displayName,s||(s=c.displayName||c.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case B:return c=s.displayName||null,c!==null?c:te(s.type)||"Memo";case z:c=s._payload,s=s._init;try{return te(s(c))}catch{}}return null}var le=Array.isArray,K=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J={pending:!1,data:null,method:null,action:null},ne=[],A=-1;function ae(s){return{current:s}}function ce(s){0>A||(s.current=ne[A],ne[A]=null,A--)}function M(s,c){A++,ne[A]=s.current,s.current=c}var de=ae(null),Se=ae(null),fe=ae(null),we=ae(null);function re(s,c){switch(M(fe,c),M(Se,s),M(de,null),c.nodeType){case 9:case 11:s=(s=c.documentElement)&&(s=s.namespaceURI)?Gn(s):0;break;default:if(s=c.tagName,c=c.namespaceURI)c=Gn(c),s=Zn(c,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ce(de),M(de,s)}function _e(){ce(de),ce(Se),ce(fe)}function qe(s){s.memoizedState!==null&&M(we,s);var c=de.current,p=Zn(c,s.type);c!==p&&(M(Se,s),M(de,p))}function et(s){Se.current===s&&(ce(de),ce(Se)),we.current===s&&(ce(we),Ic._currentValue=J)}var Je=Object.prototype.hasOwnProperty,Le=e.unstable_scheduleCallback,xe=e.unstable_cancelCallback,Me=e.unstable_shouldYield,ve=e.unstable_requestPaint,Ee=e.unstable_now,De=e.unstable_getCurrentPriorityLevel,nt=e.unstable_ImmediatePriority,lt=e.unstable_UserBlockingPriority,Xe=e.unstable_NormalPriority,Mt=e.unstable_LowPriority,_t=e.unstable_IdlePriority,an=e.log,se=e.unstable_setDisableYieldValue,Q=null,ie=null;function je(s){if(typeof an=="function"&&se(s),ie&&typeof ie.setStrictMode=="function")try{ie.setStrictMode(Q,s)}catch{}}var Ae=Math.clz32?Math.clz32:pt,Be=Math.log,st=Math.LN2;function pt(s){return s>>>=0,s===0?32:31-(Be(s)/st|0)|0}var dt=256,ze=4194304;function Ke(s){var c=s&42;if(c!==0)return c;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Fe(s,c,p){var x=s.pendingLanes;if(x===0)return 0;var S=0,D=s.suspendedLanes,H=s.pingedLanes;s=s.warmLanes;var Z=x&134217727;return Z!==0?(x=Z&~D,x!==0?S=Ke(x):(H&=Z,H!==0?S=Ke(H):p||(p=Z&~s,p!==0&&(S=Ke(p))))):(Z=x&~D,Z!==0?S=Ke(Z):H!==0?S=Ke(H):p||(p=x&~s,p!==0&&(S=Ke(p)))),S===0?0:c!==0&&c!==S&&(c&D)===0&&(D=S&-S,p=c&-c,D>=p||D===32&&(p&4194048)!==0)?c:S}function at(s,c){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&c)===0}function Qe(s,c){switch(s){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yt(){var s=dt;return dt<<=1,(dt&4194048)===0&&(dt=256),s}function Un(){var s=ze;return ze<<=1,(ze&62914560)===0&&(ze=4194304),s}function On(s){for(var c=[],p=0;31>p;p++)c.push(s);return c}function Cn(s,c){s.pendingLanes|=c,c!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function mn(s,c,p,x,S,D){var H=s.pendingLanes;s.pendingLanes=p,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=p,s.entangledLanes&=p,s.errorRecoveryDisabledLanes&=p,s.shellSuspendCounter=0;var Z=s.entanglements,ye=s.expirationTimes,Ie=s.hiddenUpdates;for(p=H&~p;0<p;){var Ue=31-Ae(p),Ge=1<<Ue;Z[Ue]=0,ye[Ue]=-1;var Oe=Ie[Ue];if(Oe!==null)for(Ie[Ue]=null,Ue=0;Ue<Oe.length;Ue++){var Re=Oe[Ue];Re!==null&&(Re.lane&=-536870913)}p&=~Ge}x!==0&&un(s,x,0),D!==0&&S===0&&s.tag!==0&&(s.suspendedLanes|=D&~(H&~c))}function un(s,c,p){s.pendingLanes|=c,s.suspendedLanes&=~c;var x=31-Ae(c);s.entangledLanes|=c,s.entanglements[x]=s.entanglements[x]|1073741824|p&4194090}function Ni(s,c){var p=s.entangledLanes|=c;for(s=s.entanglements;p;){var x=31-Ae(p),S=1<<x;S&c|s[x]&c&&(s[x]|=c),p&=~S}}function Hi(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function ar(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function oa(){var s=U.p;return s!==0?s:(s=window.event,s===void 0?32:ex(s.type))}function kr(s,c){var p=U.p;try{return U.p=s,c()}finally{U.p=p}}var ni=Math.random().toString(36).slice(2),Kn="__reactFiber$"+ni,Fn="__reactProps$"+ni,La="__reactContainer$"+ni,ss="__reactEvents$"+ni,Vh="__reactListeners$"+ni,Hh="__reactHandles$"+ni,Bd="__reactResources$"+ni,ls="__reactMarker$"+ni;function Zc(s){delete s[Kn],delete s[Fn],delete s[ss],delete s[Vh],delete s[Hh]}function Us(s){var c=s[Kn];if(c)return c;for(var p=s.parentNode;p;){if(c=p[La]||p[Kn]){if(p=c.alternate,c.child!==null||p!==null&&p.child!==null)for(s=Uy(s);s!==null;){if(p=s[Kn])return p;s=Uy(s)}return c}s=p,p=s.parentNode}return null}function qs(s){if(s=s[Kn]||s[La]){var c=s.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return s}return null}function Oa(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s.stateNode;throw Error(r(33))}function Vs(s){var c=s[Bd];return c||(c=s[Bd]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function ci(s){s[ls]=!0}var Ud=new Set,Ro={};function os(s,c){Fa(s,c),Fa(s+"Capture",c)}function Fa(s,c){for(Ro[s]=c,s=0;s<c.length;s++)Ud.add(c[s])}var Gi=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Hs={},$a={};function qd(s){return Je.call($a,s)?!0:Je.call(Hs,s)?!1:Gi.test(s)?$a[s]=!0:(Hs[s]=!0,!1)}function Fl(s,c,p){if(qd(c))if(p===null)s.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":s.removeAttribute(c);return;case"boolean":var x=c.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){s.removeAttribute(c);return}}s.setAttribute(c,""+p)}}function Gs(s,c,p){if(p===null)s.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttribute(c,""+p)}}function sr(s,c,p,x){if(x===null)s.removeAttribute(p);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(p);return}s.setAttributeNS(c,p,""+x)}}var $l,Lo;function ca(s){if($l===void 0)try{throw Error()}catch(p){var c=p.stack.trim().match(/\n( *(at )?)/);$l=c&&c[1]||"",Lo=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+$l+s+Lo}var eu=!1;function tu(s,c){if(!s||eu)return"";eu=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(c){var Ge=function(){throw Error()};if(Object.defineProperty(Ge.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ge,[])}catch(Re){var Oe=Re}Reflect.construct(s,[],Ge)}else{try{Ge.call()}catch(Re){Oe=Re}s.call(Ge.prototype)}}else{try{throw Error()}catch(Re){Oe=Re}(Ge=s())&&typeof Ge.catch=="function"&&Ge.catch(function(){})}}catch(Re){if(Re&&Oe&&typeof Re.stack=="string")return[Re.stack,Oe.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var D=x.DetermineComponentFrameRoot(),H=D[0],Z=D[1];if(H&&Z){var ye=H.split(`
`),Ie=Z.split(`
`);for(S=x=0;x<ye.length&&!ye[x].includes("DetermineComponentFrameRoot");)x++;for(;S<Ie.length&&!Ie[S].includes("DetermineComponentFrameRoot");)S++;if(x===ye.length||S===Ie.length)for(x=ye.length-1,S=Ie.length-1;1<=x&&0<=S&&ye[x]!==Ie[S];)S--;for(;1<=x&&0<=S;x--,S--)if(ye[x]!==Ie[S]){if(x!==1||S!==1)do if(x--,S--,0>S||ye[x]!==Ie[S]){var Ue=`
`+ye[x].replace(" at new "," at ");return s.displayName&&Ue.includes("<anonymous>")&&(Ue=Ue.replace("<anonymous>",s.displayName)),Ue}while(1<=x&&0<=S);break}}}finally{eu=!1,Error.prepareStackTrace=p}return(p=s?s.displayName||s.name:"")?ca(p):""}function Vd(s){switch(s.tag){case 26:case 27:case 5:return ca(s.type);case 16:return ca("Lazy");case 13:return ca("Suspense");case 19:return ca("SuspenseList");case 0:case 15:return tu(s.type,!1);case 11:return tu(s.type.render,!1);case 1:return tu(s.type,!0);case 31:return ca("Activity");default:return""}}function nu(s){try{var c="";do c+=Vd(s),s=s.return;while(s);return c}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function Oi(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Ys(s){var c=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Oo(s){var c=Ys(s)?"checked":"value",p=Object.getOwnPropertyDescriptor(s.constructor.prototype,c),x=""+s[c];if(!s.hasOwnProperty(c)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var S=p.get,D=p.set;return Object.defineProperty(s,c,{configurable:!0,get:function(){return S.call(this)},set:function(H){x=""+H,D.call(this,H)}}),Object.defineProperty(s,c,{enumerable:p.enumerable}),{getValue:function(){return x},setValue:function(H){x=""+H},stopTracking:function(){s._valueTracker=null,delete s[c]}}}}function cs(s){s._valueTracker||(s._valueTracker=Oo(s))}function Fo(s){if(!s)return!1;var c=s._valueTracker;if(!c)return!0;var p=c.getValue(),x="";return s&&(x=Ys(s)?s.checked?"true":"false":s.value),s=x,s!==p?(c.setValue(s),!0):!1}function Or(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var iu=/[\n"\\]/g;function Di(s){return s.replace(iu,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function zl(s,c,p,x,S,D,H,Z){s.name="",H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"?s.type=H:s.removeAttribute("type"),c!=null?H==="number"?(c===0&&s.value===""||s.value!=c)&&(s.value=""+Oi(c)):s.value!==""+Oi(c)&&(s.value=""+Oi(c)):H!=="submit"&&H!=="reset"||s.removeAttribute("value"),c!=null?Qs(s,H,Oi(c)):p!=null?Qs(s,H,Oi(p)):x!=null&&s.removeAttribute("value"),S==null&&D!=null&&(s.defaultChecked=!!D),S!=null&&(s.checked=S&&typeof S!="function"&&typeof S!="symbol"),Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"?s.name=""+Oi(Z):s.removeAttribute("name")}function Ws(s,c,p,x,S,D,H,Z){if(D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(s.type=D),c!=null||p!=null){if(!(D!=="submit"&&D!=="reset"||c!=null))return;p=p!=null?""+Oi(p):"",c=c!=null?""+Oi(c):p,Z||c===s.value||(s.value=c),s.defaultValue=c}x=x??S,x=typeof x!="function"&&typeof x!="symbol"&&!!x,s.checked=Z?s.checked:!!x,s.defaultChecked=!!x,H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"&&(s.name=H)}function Qs(s,c,p){c==="number"&&Or(s.ownerDocument)===s||s.defaultValue===""+p||(s.defaultValue=""+p)}function ua(s,c,p,x){if(s=s.options,c){c={};for(var S=0;S<p.length;S++)c["$"+p[S]]=!0;for(p=0;p<s.length;p++)S=c.hasOwnProperty("$"+s[p].value),s[p].selected!==S&&(s[p].selected=S),S&&x&&(s[p].defaultSelected=!0)}else{for(p=""+Oi(p),c=null,S=0;S<s.length;S++){if(s[S].value===p){s[S].selected=!0,x&&(s[S].defaultSelected=!0);return}c!==null||s[S].disabled||(c=s[S])}c!==null&&(c.selected=!0)}}function Js(s,c,p){if(c!=null&&(c=""+Oi(c),c!==s.value&&(s.value=c),p==null)){s.defaultValue!==c&&(s.defaultValue=c);return}s.defaultValue=p!=null?""+Oi(p):""}function us(s,c,p,x){if(c==null){if(x!=null){if(p!=null)throw Error(r(92));if(le(x)){if(1<x.length)throw Error(r(93));x=x[0]}p=x}p==null&&(p=""),c=p}p=Oi(c),s.defaultValue=p,x=s.textContent,x===p&&x!==""&&x!==null&&(s.value=x)}function da(s,c){if(c){var p=s.firstChild;if(p&&p===s.lastChild&&p.nodeType===3){p.nodeValue=c;return}}s.textContent=c}var fa=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Bl(s,c,p){var x=c.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?x?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="":x?s.setProperty(c,p):typeof p!="number"||p===0||fa.has(c)?c==="float"?s.cssFloat=p:s[c]=(""+p).trim():s[c]=p+"px"}function Ul(s,c,p){if(c!=null&&typeof c!="object")throw Error(r(62));if(s=s.style,p!=null){for(var x in p)!p.hasOwnProperty(x)||c!=null&&c.hasOwnProperty(x)||(x.indexOf("--")===0?s.setProperty(x,""):x==="float"?s.cssFloat="":s[x]="");for(var S in c)x=c[S],c.hasOwnProperty(S)&&p[S]!==x&&Bl(s,S,x)}else for(var D in c)c.hasOwnProperty(D)&&Bl(s,D,c[D])}function ql(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $o=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),zo=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ds(s){return zo.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var Ks=null;function Vl(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Fi=null,za=null;function Bo(s){var c=qs(s);if(c&&(s=c.stateNode)){var p=s[Fn]||null;e:switch(s=c.stateNode,c.type){case"input":if(zl(s,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),c=p.name,p.type==="radio"&&c!=null){for(p=s;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+Di(""+c)+'"][type="radio"]'),c=0;c<p.length;c++){var x=p[c];if(x!==s&&x.form===s.form){var S=x[Fn]||null;if(!S)throw Error(r(90));zl(x,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(c=0;c<p.length;c++)x=p[c],x.form===s.form&&Fo(x)}break e;case"textarea":Js(s,p.value,p.defaultValue);break e;case"select":c=p.value,c!=null&&ua(s,!!p.multiple,c,!1)}}}var ha=!1;function Xs(s,c,p){if(ha)return s(c,p);ha=!0;try{var x=s(c);return x}finally{if(ha=!1,(Fi!==null||za!==null)&&(Ff(),Fi&&(c=Fi,s=za,za=Fi=null,Bo(c),s)))for(c=0;c<s.length;c++)Bo(s[c])}}function Hl(s,c){var p=s.stateNode;if(p===null)return null;var x=p[Fn]||null;if(x===null)return null;p=x[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(s=s.type,x=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!x;break e;default:s=!1}if(s)return null;if(p&&typeof p!="function")throw Error(r(231,c,typeof p));return p}var lr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zs=!1;if(lr)try{var fs={};Object.defineProperty(fs,"passive",{get:function(){Zs=!0}}),window.addEventListener("test",fs,fs),window.removeEventListener("test",fs,fs)}catch{Zs=!1}var Fr=null,Uo=null,hs=null;function Hd(){if(hs)return hs;var s,c=Uo,p=c.length,x,S="value"in Fr?Fr.value:Fr.textContent,D=S.length;for(s=0;s<p&&c[s]===S[s];s++);var H=p-s;for(x=1;x<=H&&c[p-x]===S[D-x];x++);return hs=S.slice(s,1<x?1-x:void 0)}function gn(s){var c=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&c===13&&(s=13)):s=c,s===10&&(s=13),32<=s||s===13?s:0}function ln(){return!0}function qo(){return!1}function Pi(s){function c(p,x,S,D,H){this._reactName=p,this._targetInst=S,this.type=x,this.nativeEvent=D,this.target=H,this.currentTarget=null;for(var Z in s)s.hasOwnProperty(Z)&&(p=s[Z],this[Z]=p?p(D):D[Z]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?ln:qo,this.isPropagationStopped=qo,this}return h(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=ln)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=ln)},persist:function(){},isPersistent:ln}),c}var Qt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},el=Pi(Qt),Ba=h({},Qt,{view:0,detail:0}),ru=Pi(Ba),Ua,ps,Xn,ms=h({},Ba,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$r,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Xn&&(Xn&&s.type==="mousemove"?(Ua=s.screenX-Xn.screenX,ps=s.screenY-Xn.screenY):ps=Ua=0,Xn=s),Ua)},movementY:function(s){return"movementY"in s?s.movementY:ps}}),Yi=Pi(ms),au=h({},ms,{dataTransfer:0}),Gl=Pi(au),Ii=h({},Ba,{relatedTarget:0}),pa=Pi(Ii),su=h({},Qt,{animationName:0,elapsedTime:0,pseudoElement:0}),Vo=Pi(su),gs=h({},Qt,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Gd=Pi(gs),lu=h({},Qt,{data:0}),ui=Pi(lu),Ho={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$i={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Yl(s){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(s):(s=Gh[s])?!!c[s]:!1}function $r(){return Yl}var Go=h({},Ba,{key:function(s){if(s.key){var c=Ho[s.key]||s.key;if(c!=="Unidentified")return c}return s.type==="keypress"?(s=gn(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?$i[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$r,charCode:function(s){return s.type==="keypress"?gn(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?gn(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),ou=Pi(Go),In=h({},ms,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ma=Pi(In),cu=h({},Ba,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$r}),Yh=Pi(cu),uu=h({},Qt,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wh=Pi(uu),Yd=h({},ms,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Qh=Pi(Yd),Wl=h({},Qt,{newState:0,oldState:0}),Yo=Pi(Wl),Wi=[9,13,27,32],zr=lr&&"CompositionEvent"in window,zi=null;lr&&"documentMode"in document&&(zi=document.documentMode);var du=lr&&"TextEvent"in window&&!zi,Ql=lr&&(!zr||zi&&8<zi&&11>=zi),Jl=" ",Wo=!1;function Qo(s,c){switch(s){case"keyup":return Wi.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Kl(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ga=!1;function Jh(s,c){switch(s){case"compositionend":return Kl(c);case"keypress":return c.which!==32?null:(Wo=!0,Jl);case"textInput":return s=c.data,s===Jl&&Wo?null:s;default:return null}}function fu(s,c){if(ga)return s==="compositionend"||!zr&&Qo(s,c)?(s=Hd(),hs=Uo=Fr=null,ga=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Ql&&c.locale!=="ko"?null:c.data;default:return null}}var Qi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jo(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c==="input"?!!Qi[s.type]:c==="textarea"}function tl(s,c,p,x){Fi?za?za.push(x):za=[x]:Fi=x,c=Hf(c,"onChange"),0<c.length&&(p=new el("onChange","change",null,p,x),s.push({event:p,listeners:c}))}var nl=null,il=null;function Kh(s){My(s,0)}function ya(s){var c=Oa(s);if(Fo(c))return s}function Wd(s,c){if(s==="change")return c}var Ko=!1;if(lr){var hu;if(lr){var qa="oninput"in document;if(!qa){var Qd=document.createElement("div");Qd.setAttribute("oninput","return;"),qa=typeof Qd.oninput=="function"}hu=qa}else hu=!1;Ko=hu&&(!document.documentMode||9<document.documentMode)}function Br(){nl&&(nl.detachEvent("onpropertychange",Xo),il=nl=null)}function Xo(s){if(s.propertyName==="value"&&ya(il)){var c=[];tl(c,il,s,Vl(s)),Xs(Kh,c)}}function pu(s,c,p){s==="focusin"?(Br(),nl=c,il=p,nl.attachEvent("onpropertychange",Xo)):s==="focusout"&&Br()}function Va(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return ya(il)}function Zo(s,c){if(s==="click")return ya(c)}function Xh(s,c){if(s==="input"||s==="change")return ya(c)}function Zh(s,c){return s===c&&(s!==0||1/s===1/c)||s!==s&&c!==c}var Ji=typeof Object.is=="function"?Object.is:Zh;function Ur(s,c){if(Ji(s,c))return!0;if(typeof s!="object"||s===null||typeof c!="object"||c===null)return!1;var p=Object.keys(s),x=Object.keys(c);if(p.length!==x.length)return!1;for(x=0;x<p.length;x++){var S=p[x];if(!Je.call(c,S)||!Ji(s[S],c[S]))return!1}return!0}function or(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function mu(s,c){var p=or(s);s=0;for(var x;p;){if(p.nodeType===3){if(x=s+p.textContent.length,s<=c&&x>=c)return{node:p,offset:c-s};s=x}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=or(p)}}function Jd(s,c){return s&&c?s===c?!0:s&&s.nodeType===3?!1:c&&c.nodeType===3?Jd(s,c.parentNode):"contains"in s?s.contains(c):s.compareDocumentPosition?!!(s.compareDocumentPosition(c)&16):!1:!1}function gu(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var c=Or(s.document);c instanceof s.HTMLIFrameElement;){try{var p=typeof c.contentWindow.location.href=="string"}catch{p=!1}if(p)s=c.contentWindow;else break;c=Or(s.document)}return c}function ec(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c&&(c==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||c==="textarea"||s.contentEditable==="true")}var Kd=lr&&"documentMode"in document&&11>=document.documentMode,he=null,be=null,W=null,ue=!1;function ge(s,c,p){var x=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;ue||he==null||he!==Or(x)||(x=he,"selectionStart"in x&&ec(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),W&&Ur(W,x)||(W=x,x=Hf(be,"onSelect"),0<x.length&&(c=new el("onSelect","select",null,c,p),s.push({event:c,listeners:x}),c.target=he)))}function $e(s,c){var p={};return p[s.toLowerCase()]=c.toLowerCase(),p["Webkit"+s]="webkit"+c,p["Moz"+s]="moz"+c,p}var We={animationend:$e("Animation","AnimationEnd"),animationiteration:$e("Animation","AnimationIteration"),animationstart:$e("Animation","AnimationStart"),transitionrun:$e("Transition","TransitionRun"),transitionstart:$e("Transition","TransitionStart"),transitioncancel:$e("Transition","TransitionCancel"),transitionend:$e("Transition","TransitionEnd")},tt={},Jt={};lr&&(Jt=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function qt(s){if(tt[s])return tt[s];if(!We[s])return s;var c=We[s],p;for(p in c)if(c.hasOwnProperty(p)&&p in Jt)return tt[s]=c[p];return s}var rl=qt("animationend"),yu=qt("animationiteration"),di=qt("animationstart"),Xd=qt("transitionrun"),Bb=qt("transitionstart"),tc=qt("transitioncancel"),xu=qt("transitionend"),bu=new Map,fn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");fn.push("scrollEnd");function xa(s,c){bu.set(s,c),os(c,[s])}var ep=new WeakMap;function Ki(s,c){if(typeof s=="object"&&s!==null){var p=ep.get(s);return p!==void 0?p:(c={value:s,source:c,stack:nu(c)},ep.set(s,c),c)}return{value:s,source:c,stack:nu(c)}}var qr=[],nc=0,tp=0;function Xl(){for(var s=nc,c=tp=nc=0;c<s;){var p=qr[c];qr[c++]=null;var x=qr[c];qr[c++]=null;var S=qr[c];qr[c++]=null;var D=qr[c];if(qr[c++]=null,x!==null&&S!==null){var H=x.pending;H===null?S.next=S:(S.next=H.next,H.next=S),x.pending=S}D!==0&&vu(p,S,D)}}function ba(s,c,p,x){qr[nc++]=s,qr[nc++]=c,qr[nc++]=p,qr[nc++]=x,tp|=x,s.lanes|=x,s=s.alternate,s!==null&&(s.lanes|=x)}function ic(s,c,p,x){return ba(s,c,p,x),wu(s)}function Zl(s,c){return ba(s,null,null,c),wu(s)}function vu(s,c,p){s.lanes|=p;var x=s.alternate;x!==null&&(x.lanes|=p);for(var S=!1,D=s.return;D!==null;)D.childLanes|=p,x=D.alternate,x!==null&&(x.childLanes|=p),D.tag===22&&(s=D.stateNode,s===null||s._visibility&1||(S=!0)),s=D,D=D.return;return s.tag===3?(D=s.stateNode,S&&c!==null&&(S=31-Ae(p),s=D.hiddenUpdates,x=s[S],x===null?s[S]=[c]:x.push(c),c.lane=p|536870912),D):null}function wu(s){if(50<jc)throw jc=0,Qp=null,Error(r(185));for(var c=s.return;c!==null;)s=c,c=s.return;return s.tag===3?s.stateNode:null}var eo={};function Zd(s,c,p,x){this.tag=s,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cr(s,c,p,x){return new Zd(s,c,p,x)}function to(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Xi(s,c){var p=s.alternate;return p===null?(p=cr(s.tag,c,s.key,s.mode),p.elementType=s.elementType,p.type=s.type,p.stateNode=s.stateNode,p.alternate=s,s.alternate=p):(p.pendingProps=c,p.type=s.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=s.flags&65011712,p.childLanes=s.childLanes,p.lanes=s.lanes,p.child=s.child,p.memoizedProps=s.memoizedProps,p.memoizedState=s.memoizedState,p.updateQueue=s.updateQueue,c=s.dependencies,p.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},p.sibling=s.sibling,p.index=s.index,p.ref=s.ref,p.refCleanup=s.refCleanup,p}function Su(s,c){s.flags&=65011714;var p=s.alternate;return p===null?(s.childLanes=0,s.lanes=c,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=p.childLanes,s.lanes=p.lanes,s.child=p.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=p.memoizedProps,s.memoizedState=p.memoizedState,s.updateQueue=p.updateQueue,s.type=p.type,c=p.dependencies,s.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),s}function ef(s,c,p,x,S,D){var H=0;if(x=s,typeof s=="function")to(s)&&(H=1);else if(typeof s=="string")H=x0(s,p,de.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case q:return s=cr(31,p,c,S),s.elementType=q,s.lanes=D,s;case N:return no(p.children,S,D,c);case k:H=8,S|=24;break;case T:return s=cr(12,p,c,S|2),s.elementType=T,s.lanes=D,s;case F:return s=cr(13,p,c,S),s.elementType=F,s.lanes=D,s;case $:return s=cr(19,p,c,S),s.elementType=$,s.lanes=D,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case E:case P:H=10;break e;case I:H=9;break e;case V:H=11;break e;case B:H=14;break e;case z:H=16,x=null;break e}H=29,p=Error(r(130,s===null?"null":typeof s,"")),x=null}return c=cr(H,p,c,S),c.elementType=s,c.type=x,c.lanes=D,c}function no(s,c,p,x){return s=cr(7,s,x,c),s.lanes=p,s}function np(s,c,p){return s=cr(6,s,null,c),s.lanes=p,s}function rc(s,c,p){return c=cr(4,s.children!==null?s.children:[],s.key,c),c.lanes=p,c.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},c}var ys=[],al=0,tf=null,Nu=0,Vr=[],Hr=0,$n=null,qn=1,xs="";function io(s,c){ys[al++]=Nu,ys[al++]=tf,tf=s,Nu=c}function ip(s,c,p){Vr[Hr++]=qn,Vr[Hr++]=xs,Vr[Hr++]=$n,$n=s;var x=qn;s=xs;var S=32-Ae(x)-1;x&=~(1<<S),p+=1;var D=32-Ae(c)+S;if(30<D){var H=S-S%5;D=(x&(1<<H)-1).toString(32),x>>=H,S-=H,qn=1<<32-Ae(c)+S|p<<S|x,xs=D+s}else qn=1<<D|p<<S|x,xs=s}function rp(s){s.return!==null&&(io(s,1),ip(s,1,0))}function Cu(s){for(;s===tf;)tf=ys[--al],ys[al]=null,Nu=ys[--al],ys[al]=null;for(;s===$n;)$n=Vr[--Hr],Vr[Hr]=null,xs=Vr[--Hr],Vr[Hr]=null,qn=Vr[--Hr],Vr[Hr]=null}var mi=null,Vn=null,Kt=!1,va=null,ur=!1,ac=Error(r(519));function Gr(s){var c=Error(r(418,""));throw sl(Ki(c,s)),ac}function pg(s){var c=s.stateNode,p=s.type,x=s.memoizedProps;switch(c[Kn]=s,c[Fn]=x,p){case"dialog":Wt("cancel",c),Wt("close",c);break;case"iframe":case"object":case"embed":Wt("load",c);break;case"video":case"audio":for(p=0;p<fd.length;p++)Wt(fd[p],c);break;case"source":Wt("error",c);break;case"img":case"image":case"link":Wt("error",c),Wt("load",c);break;case"details":Wt("toggle",c);break;case"input":Wt("invalid",c),Ws(c,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),cs(c);break;case"select":Wt("invalid",c);break;case"textarea":Wt("invalid",c),us(c,x.value,x.defaultValue,x.children),cs(c)}p=x.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||c.textContent===""+p||x.suppressHydrationWarning===!0||Oy(c.textContent,p)?(x.popover!=null&&(Wt("beforetoggle",c),Wt("toggle",c)),x.onScroll!=null&&Wt("scroll",c),x.onScrollEnd!=null&&Wt("scrollend",c),x.onClick!=null&&(c.onclick=Gf),c=!0):c=!1,c||Gr(s)}function mg(s){for(mi=s.return;mi;)switch(mi.tag){case 5:case 13:ur=!1;return;case 27:case 3:ur=!0;return;default:mi=mi.return}}function ju(s){if(s!==mi)return!1;if(!Kt)return mg(s),Kt=!0,!1;var c=s.tag,p;if((p=c!==3&&c!==27)&&((p=c===5)&&(p=s.type,p=!(p!=="form"&&p!=="button")||Wf(s.type,s.memoizedProps)),p=!p),p&&Vn&&Gr(s),mg(s),c===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,c=0;s;){if(s.nodeType===8)if(p=s.data,p==="/$"){if(c===0){Vn=_a(s.nextSibling);break e}c--}else p!=="$"&&p!=="$!"&&p!=="$?"||c++;s=s.nextSibling}Vn=null}}else c===27?(c=Vn,Xr(s.type)?(s=cm,cm=null,Vn=s):Vn=c):Vn=mi?_a(s.stateNode.nextSibling):null;return!0}function _u(){Vn=mi=null,Kt=!1}function gg(){var s=va;return s!==null&&(xr===null?xr=s:xr.push.apply(xr,s),va=null),s}function sl(s){va===null?va=[s]:va.push(s)}var ro=ae(null),ll=null,X=null;function Er(s,c,p){M(ro,c._currentValue),c._currentValue=p}function Yr(s){s._currentValue=ro.current,ce(ro)}function dr(s,c,p){for(;s!==null;){var x=s.alternate;if((s.childLanes&c)!==c?(s.childLanes|=c,x!==null&&(x.childLanes|=c)):x!==null&&(x.childLanes&c)!==c&&(x.childLanes|=c),s===p)break;s=s.return}}function Vt(s,c,p,x){var S=s.child;for(S!==null&&(S.return=s);S!==null;){var D=S.dependencies;if(D!==null){var H=S.child;D=D.firstContext;e:for(;D!==null;){var Z=D;D=S;for(var ye=0;ye<c.length;ye++)if(Z.context===c[ye]){D.lanes|=p,Z=D.alternate,Z!==null&&(Z.lanes|=p),dr(D.return,p,s),x||(H=null);break e}D=Z.next}}else if(S.tag===18){if(H=S.return,H===null)throw Error(r(341));H.lanes|=p,D=H.alternate,D!==null&&(D.lanes|=p),dr(H,p,s),H=null}else H=S.child;if(H!==null)H.return=S;else for(H=S;H!==null;){if(H===s){H=null;break}if(S=H.sibling,S!==null){S.return=H.return,H=S;break}H=H.return}S=H}}function ku(s,c,p,x){s=null;for(var S=c,D=!1;S!==null;){if(!D){if((S.flags&524288)!==0)D=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var H=S.alternate;if(H===null)throw Error(r(387));if(H=H.memoizedProps,H!==null){var Z=S.type;Ji(S.pendingProps.value,H.value)||(s!==null?s.push(Z):s=[Z])}}else if(S===we.current){if(H=S.alternate,H===null)throw Error(r(387));H.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(s!==null?s.push(Ic):s=[Ic])}S=S.return}s!==null&&Vt(c,s,p,x),c.flags|=262144}function nf(s){for(s=s.firstContext;s!==null;){if(!Ji(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function ao(s){ll=s,X=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function ii(s){return yg(ll,s)}function rf(s,c){return ll===null&&ao(s),yg(s,c)}function yg(s,c){var p=c._currentValue;if(c={context:c,memoizedValue:p,next:null},X===null){if(s===null)throw Error(r(308));X=c,s.dependencies={lanes:0,firstContext:c},s.flags|=524288}else X=X.next=c;return p}var Ub=typeof AbortController<"u"?AbortController:function(){var s=[],c=this.signal={aborted:!1,addEventListener:function(p,x){s.push(x)}};this.abort=function(){c.aborted=!0,s.forEach(function(p){return p()})}},qb=e.unstable_scheduleCallback,Vb=e.unstable_NormalPriority,Tn={$$typeof:P,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ap(){return{controller:new Ub,data:new Map,refCount:0}}function Eu(s){s.refCount--,s.refCount===0&&qb(Vb,function(){s.controller.abort()})}var Tu=null,sp=0,sc=0,fr=null;function Hb(s,c){if(Tu===null){var p=Tu=[];sp=0,sc=Vf(),fr={status:"pending",value:void 0,then:function(x){p.push(x)}}}return sp++,c.then(xg,xg),c}function xg(){if(--sp===0&&Tu!==null){fr!==null&&(fr.status="fulfilled");var s=Tu;Tu=null,sc=0,fr=null;for(var c=0;c<s.length;c++)(0,s[c])()}}function Gb(s,c){var p=[],x={status:"pending",value:null,reason:null,then:function(S){p.push(S)}};return s.then(function(){x.status="fulfilled",x.value=c;for(var S=0;S<p.length;S++)(0,p[S])(c)},function(S){for(x.status="rejected",x.reason=S,S=0;S<p.length;S++)(0,p[S])(void 0)}),x}var bg=K.S;K.S=function(s,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&Hb(s,c),bg!==null&&bg(s,c)};var so=ae(null);function bs(){var s=so.current;return s!==null?s:Mn.pooledCache}function af(s,c){c===null?M(so,so.current):M(so,c.pool)}function vg(){var s=bs();return s===null?null:{parent:Tn._currentValue,pool:s}}var Zi=Error(r(460)),wg=Error(r(474)),sf=Error(r(542)),lp={then:function(){}};function Sg(s){return s=s.status,s==="fulfilled"||s==="rejected"}function lf(){}function op(s,c,p){switch(p=s[p],p===void 0?s.push(c):p!==c&&(c.then(lf,lf),c=p),c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,Cg(s),s;default:if(typeof c.status=="string")c.then(lf,lf);else{if(s=Mn,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=c,s.status="pending",s.then(function(x){if(c.status==="pending"){var S=c;S.status="fulfilled",S.value=x}},function(x){if(c.status==="pending"){var S=c;S.status="rejected",S.reason=x}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,Cg(s),s}throw lc=c,Zi}}var lc=null;function Ng(){if(lc===null)throw Error(r(459));var s=lc;return lc=null,s}function Cg(s){if(s===Zi||s===sf)throw Error(r(483))}var Ha=!1;function lo(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function oc(s,c){s=s.updateQueue,c.updateQueue===s&&(c.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function ol(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function vs(s,c,p){var x=s.updateQueue;if(x===null)return null;if(x=x.shared,(bn&2)!==0){var S=x.pending;return S===null?c.next=c:(c.next=S.next,S.next=c),x.pending=c,c=wu(s),vu(s,null,p),c}return ba(s,x,c,p),wu(s)}function Au(s,c,p){if(c=c.updateQueue,c!==null&&(c=c.shared,(p&4194048)!==0)){var x=c.lanes;x&=s.pendingLanes,p|=x,c.lanes=p,Ni(s,p)}}function wa(s,c){var p=s.updateQueue,x=s.alternate;if(x!==null&&(x=x.updateQueue,p===x)){var S=null,D=null;if(p=p.firstBaseUpdate,p!==null){do{var H={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};D===null?S=D=H:D=D.next=H,p=p.next}while(p!==null);D===null?S=D=c:D=D.next=c}else S=D=c;p={baseState:x.baseState,firstBaseUpdate:S,lastBaseUpdate:D,shared:x.shared,callbacks:x.callbacks},s.updateQueue=p;return}s=p.lastBaseUpdate,s===null?p.firstBaseUpdate=c:s.next=c,p.lastBaseUpdate=c}var Du=!1;function Sa(){if(Du){var s=fr;if(s!==null)throw s}}function Bi(s,c,p,x){Du=!1;var S=s.updateQueue;Ha=!1;var D=S.firstBaseUpdate,H=S.lastBaseUpdate,Z=S.shared.pending;if(Z!==null){S.shared.pending=null;var ye=Z,Ie=ye.next;ye.next=null,H===null?D=Ie:H.next=Ie,H=ye;var Ue=s.alternate;Ue!==null&&(Ue=Ue.updateQueue,Z=Ue.lastBaseUpdate,Z!==H&&(Z===null?Ue.firstBaseUpdate=Ie:Z.next=Ie,Ue.lastBaseUpdate=ye))}if(D!==null){var Ge=S.baseState;H=0,Ue=Ie=ye=null,Z=D;do{var Oe=Z.lane&-536870913,Re=Oe!==Z.lane;if(Re?(sn&Oe)===Oe:(x&Oe)===Oe){Oe!==0&&Oe===sc&&(Du=!0),Ue!==null&&(Ue=Ue.next={lane:0,tag:Z.tag,payload:Z.payload,callback:null,next:null});e:{var St=s,vt=Z;Oe=c;var _n=p;switch(vt.tag){case 1:if(St=vt.payload,typeof St=="function"){Ge=St.call(_n,Ge,Oe);break e}Ge=St;break e;case 3:St.flags=St.flags&-65537|128;case 0:if(St=vt.payload,Oe=typeof St=="function"?St.call(_n,Ge,Oe):St,Oe==null)break e;Ge=h({},Ge,Oe);break e;case 2:Ha=!0}}Oe=Z.callback,Oe!==null&&(s.flags|=64,Re&&(s.flags|=8192),Re=S.callbacks,Re===null?S.callbacks=[Oe]:Re.push(Oe))}else Re={lane:Oe,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null},Ue===null?(Ie=Ue=Re,ye=Ge):Ue=Ue.next=Re,H|=Oe;if(Z=Z.next,Z===null){if(Z=S.shared.pending,Z===null)break;Re=Z,Z=Re.next,Re.next=null,S.lastBaseUpdate=Re,S.shared.pending=null}}while(!0);Ue===null&&(ye=Ge),S.baseState=ye,S.firstBaseUpdate=Ie,S.lastBaseUpdate=Ue,D===null&&(S.shared.lanes=0),yl|=H,s.lanes=H,s.memoizedState=Ge}}function jg(s,c){if(typeof s!="function")throw Error(r(191,s));s.call(c)}function cp(s,c){var p=s.callbacks;if(p!==null)for(s.callbacks=null,s=0;s<p.length;s++)jg(p[s],c)}var oo=ae(null),cl=ae(0);function ws(s,c){s=As,M(cl,s),M(oo,c),As=s|c.baseLanes}function of(){M(cl,As),M(oo,oo.current)}function up(){As=cl.current,ce(oo),ce(cl)}var Na=0,$t=null,xn=null,Xt=null,cc=!1,co=!1,Ui=!1,uc=0,ul=0,Wr=null,_g=0;function Zt(){throw Error(r(321))}function Pu(s,c){if(c===null)return!1;for(var p=0;p<c.length&&p<s.length;p++)if(!Ji(s[p],c[p]))return!1;return!0}function dp(s,c,p,x,S,D){return Na=D,$t=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,K.H=s===null||s.memoizedState===null?$g:Tp,Ui=!1,D=p(x,S),Ui=!1,co&&(D=Eg(c,p,x,S)),kg(s),D}function kg(s){K.H=qu;var c=xn!==null&&xn.next!==null;if(Na=0,Xt=xn=$t=null,cc=!1,ul=0,Wr=null,c)throw Error(r(300));s===null||Ci||(s=s.dependencies,s!==null&&nf(s)&&(Ci=!0))}function Eg(s,c,p,x){$t=s;var S=0;do{if(co&&(Wr=null),ul=0,co=!1,25<=S)throw Error(r(301));if(S+=1,Xt=xn=null,s.updateQueue!=null){var D=s.updateQueue;D.lastEffect=null,D.events=null,D.stores=null,D.memoCache!=null&&(D.memoCache.index=0)}K.H=zg,D=c(p,x)}while(co);return D}function fp(){var s=K.H,c=s.useState()[0];return c=typeof c.then=="function"?Iu(c):c,s=s.useState()[0],(xn!==null?xn.memoizedState:null)!==s&&($t.flags|=1024),c}function hp(){var s=uc!==0;return uc=0,s}function uo(s,c,p){c.updateQueue=s.updateQueue,c.flags&=-2053,s.lanes&=~p}function cf(s){if(cc){for(s=s.memoizedState;s!==null;){var c=s.queue;c!==null&&(c.pending=null),s=s.next}cc=!1}Na=0,Xt=xn=$t=null,co=!1,ul=uc=0,Wr=null}function hr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xt===null?$t.memoizedState=Xt=s:Xt=Xt.next=s,Xt}function fi(){if(xn===null){var s=$t.alternate;s=s!==null?s.memoizedState:null}else s=xn.next;var c=Xt===null?$t.memoizedState:Xt.next;if(c!==null)Xt=c,xn=s;else{if(s===null)throw $t.alternate===null?Error(r(467)):Error(r(310));xn=s,s={memoizedState:xn.memoizedState,baseState:xn.baseState,baseQueue:xn.baseQueue,queue:xn.queue,next:null},Xt===null?$t.memoizedState=Xt=s:Xt=Xt.next=s}return Xt}function fo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Iu(s){var c=ul;return ul+=1,Wr===null&&(Wr=[]),s=op(Wr,s,c),c=$t,(Xt===null?c.memoizedState:Xt.next)===null&&(c=c.alternate,K.H=c===null||c.memoizedState===null?$g:Tp),s}function uf(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Iu(s);if(s.$$typeof===P)return ii(s)}throw Error(r(438,String(s)))}function Mu(s){var c=null,p=$t.updateQueue;if(p!==null&&(c=p.memoCache),c==null){var x=$t.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(c={data:x.data.map(function(S){return S.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),p===null&&(p=fo(),$t.updateQueue=p),p.memoCache=c,p=c.data[c.index],p===void 0)for(p=c.data[c.index]=Array(s),x=0;x<s;x++)p[x]=O;return c.index++,p}function Ga(s,c){return typeof c=="function"?c(s):c}function df(s){var c=fi();return pp(c,xn,s)}function pp(s,c,p){var x=s.queue;if(x===null)throw Error(r(311));x.lastRenderedReducer=p;var S=s.baseQueue,D=x.pending;if(D!==null){if(S!==null){var H=S.next;S.next=D.next,D.next=H}c.baseQueue=S=D,x.pending=null}if(D=s.baseState,S===null)s.memoizedState=D;else{c=S.next;var Z=H=null,ye=null,Ie=c,Ue=!1;do{var Ge=Ie.lane&-536870913;if(Ge!==Ie.lane?(sn&Ge)===Ge:(Na&Ge)===Ge){var Oe=Ie.revertLane;if(Oe===0)ye!==null&&(ye=ye.next={lane:0,revertLane:0,action:Ie.action,hasEagerState:Ie.hasEagerState,eagerState:Ie.eagerState,next:null}),Ge===sc&&(Ue=!0);else if((Na&Oe)===Oe){Ie=Ie.next,Oe===sc&&(Ue=!0);continue}else Ge={lane:0,revertLane:Ie.revertLane,action:Ie.action,hasEagerState:Ie.hasEagerState,eagerState:Ie.eagerState,next:null},ye===null?(Z=ye=Ge,H=D):ye=ye.next=Ge,$t.lanes|=Oe,yl|=Oe;Ge=Ie.action,Ui&&p(D,Ge),D=Ie.hasEagerState?Ie.eagerState:p(D,Ge)}else Oe={lane:Ge,revertLane:Ie.revertLane,action:Ie.action,hasEagerState:Ie.hasEagerState,eagerState:Ie.eagerState,next:null},ye===null?(Z=ye=Oe,H=D):ye=ye.next=Oe,$t.lanes|=Ge,yl|=Ge;Ie=Ie.next}while(Ie!==null&&Ie!==c);if(ye===null?H=D:ye.next=Z,!Ji(D,s.memoizedState)&&(Ci=!0,Ue&&(p=fr,p!==null)))throw p;s.memoizedState=D,s.baseState=H,s.baseQueue=ye,x.lastRenderedState=D}return S===null&&(x.lanes=0),[s.memoizedState,x.dispatch]}function mp(s){var c=fi(),p=c.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=s;var x=p.dispatch,S=p.pending,D=c.memoizedState;if(S!==null){p.pending=null;var H=S=S.next;do D=s(D,H.action),H=H.next;while(H!==S);Ji(D,c.memoizedState)||(Ci=!0),c.memoizedState=D,c.baseQueue===null&&(c.baseState=D),p.lastRenderedState=D}return[D,x]}function gp(s,c,p){var x=$t,S=fi(),D=Kt;if(D){if(p===void 0)throw Error(r(407));p=p()}else p=c();var H=!Ji((xn||S).memoizedState,p);H&&(S.memoizedState=p,Ci=!0),S=S.queue;var Z=hf.bind(null,x,S,s);if(Ou(2048,8,Z,[s]),S.getSnapshot!==c||H||Xt!==null&&Xt.memoizedState.tag&1){if(x.flags|=2048,dc(9,xf(),Tg.bind(null,x,S,p,c),null),Mn===null)throw Error(r(349));D||(Na&124)!==0||ff(x,c,p)}return p}function ff(s,c,p){s.flags|=16384,s={getSnapshot:c,value:p},c=$t.updateQueue,c===null?(c=fo(),$t.updateQueue=c,c.stores=[s]):(p=c.stores,p===null?c.stores=[s]:p.push(s))}function Tg(s,c,p,x){c.value=p,c.getSnapshot=x,yp(c)&&xp(s)}function hf(s,c,p){return p(function(){yp(c)&&xp(s)})}function yp(s){var c=s.getSnapshot;s=s.value;try{var p=c();return!Ji(s,p)}catch{return!0}}function xp(s){var c=Zl(s,2);c!==null&&Ir(c,s,2)}function pf(s){var c=hr();if(typeof s=="function"){var p=s;if(s=p(),Ui){je(!0);try{p()}finally{je(!1)}}}return c.memoizedState=c.baseState=s,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ga,lastRenderedState:s},c}function Ru(s,c,p,x){return s.baseState=p,pp(s,xn,typeof x=="function"?x:Ga)}function Yb(s,c,p,x,S){if(Sf(s))throw Error(r(485));if(s=c.action,s!==null){var D={payload:S,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(H){D.listeners.push(H)}};K.T!==null?p(!0):D.isTransition=!1,x(D),p=c.pending,p===null?(D.next=c.pending=D,bp(c,D)):(D.next=p.next,c.pending=p.next=D)}}function bp(s,c){var p=c.action,x=c.payload,S=s.state;if(c.isTransition){var D=K.T,H={};K.T=H;try{var Z=p(S,x),ye=K.S;ye!==null&&ye(H,Z),vp(s,c,Z)}catch(Ie){mf(s,c,Ie)}finally{K.T=D}}else try{D=p(S,x),vp(s,c,D)}catch(Ie){mf(s,c,Ie)}}function vp(s,c,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(x){Ag(s,c,x)},function(x){return mf(s,c,x)}):Ag(s,c,p)}function Ag(s,c,p){c.status="fulfilled",c.value=p,Dg(c),s.state=p,c=s.pending,c!==null&&(p=c.next,p===c?s.pending=null:(p=p.next,c.next=p,bp(s,p)))}function mf(s,c,p){var x=s.pending;if(s.pending=null,x!==null){x=x.next;do c.status="rejected",c.reason=p,Dg(c),c=c.next;while(c!==x)}s.action=null}function Dg(s){s=s.listeners;for(var c=0;c<s.length;c++)(0,s[c])()}function gf(s,c){return c}function wp(s,c){if(Kt){var p=Mn.formState;if(p!==null){e:{var x=$t;if(Kt){if(Vn){t:{for(var S=Vn,D=ur;S.nodeType!==8;){if(!D){S=null;break t}if(S=_a(S.nextSibling),S===null){S=null;break t}}D=S.data,S=D==="F!"||D==="F"?S:null}if(S){Vn=_a(S.nextSibling),x=S.data==="F!";break e}}Gr(x)}x=!1}x&&(c=p[0])}}return p=hr(),p.memoizedState=p.baseState=c,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gf,lastRenderedState:c},p.queue=x,p=_p.bind(null,$t,x),x.dispatch=p,x=pf(!1),D=kp.bind(null,$t,!1,x.queue),x=hr(),S={state:c,dispatch:null,action:s,pending:null},x.queue=S,p=Yb.bind(null,$t,S,D,p),S.dispatch=p,x.memoizedState=s,[c,p,!1]}function yf(s){var c=fi();return Pg(c,xn,s)}function Pg(s,c,p){if(c=pp(s,c,gf)[0],s=df(Ga)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var x=Iu(c)}catch(H){throw H===Zi?sf:H}else x=c;c=fi();var S=c.queue,D=S.dispatch;return p!==c.memoizedState&&($t.flags|=2048,dc(9,xf(),Sp.bind(null,S,p),null)),[x,D,s]}function Sp(s,c){s.action=c}function Ot(s){var c=fi(),p=xn;if(p!==null)return Pg(c,p,s);fi(),c=c.memoizedState,p=fi();var x=p.queue.dispatch;return p.memoizedState=s,[c,x,!1]}function dc(s,c,p,x){return s={tag:s,create:p,deps:x,inst:c,next:null},c=$t.updateQueue,c===null&&(c=fo(),$t.updateQueue=c),p=c.lastEffect,p===null?c.lastEffect=s.next=s:(x=p.next,p.next=s,s.next=x,c.lastEffect=s),s}function xf(){return{destroy:void 0,resource:void 0}}function fc(){return fi().memoizedState}function Lu(s,c,p,x){var S=hr();x=x===void 0?null:x,$t.flags|=s,S.memoizedState=dc(1|c,xf(),p,x)}function Ou(s,c,p,x){var S=fi();x=x===void 0?null:x;var D=S.memoizedState.inst;xn!==null&&x!==null&&Pu(x,xn.memoizedState.deps)?S.memoizedState=dc(c,D,p,x):($t.flags|=s,S.memoizedState=dc(1|c,D,p,x))}function Ig(s,c){Lu(8390656,8,s,c)}function Tr(s,c){Ou(2048,8,s,c)}function Mg(s,c){return Ou(4,2,s,c)}function Fu(s,c){return Ou(4,4,s,c)}function bf(s,c){if(typeof c=="function"){s=s();var p=c(s);return function(){typeof p=="function"?p():c(null)}}if(c!=null)return s=s(),c.current=s,function(){c.current=null}}function Np(s,c,p){p=p!=null?p.concat([s]):null,Ou(4,4,bf.bind(null,c,s),p)}function vf(){}function pr(s,c){var p=fi();c=c===void 0?null:c;var x=p.memoizedState;return c!==null&&Pu(c,x[1])?x[0]:(p.memoizedState=[s,c],s)}function Ss(s,c){var p=fi();c=c===void 0?null:c;var x=p.memoizedState;if(c!==null&&Pu(c,x[1]))return x[0];if(x=s(),Ui){je(!0);try{s()}finally{je(!1)}}return p.memoizedState=[x,c],x}function $u(s,c,p){return p===void 0||(Na&1073741824)!==0?s.memoizedState=c:(s.memoizedState=p,s=hy(),$t.lanes|=s,yl|=s,p)}function Cp(s,c,p,x){return Ji(p,c)?p:oo.current!==null?(s=$u(s,p,x),Ji(s,c)||(Ci=!0),s):(Na&42)===0?(Ci=!0,s.memoizedState=p):(s=hy(),$t.lanes|=s,yl|=s,c)}function zu(s,c,p,x,S){var D=U.p;U.p=D!==0&&8>D?D:8;var H=K.T,Z={};K.T=Z,kp(s,!1,c,p);try{var ye=S(),Ie=K.S;if(Ie!==null&&Ie(Z,ye),ye!==null&&typeof ye=="object"&&typeof ye.then=="function"){var Ue=Gb(ye,x);ho(s,c,Ue,Vi(s))}else ho(s,c,x,Vi(s))}catch(Ge){ho(s,c,{then:function(){},status:"rejected",reason:Ge},Vi())}finally{U.p=D,K.T=H}}function Rg(){}function Bu(s,c,p,x){if(s.tag!==5)throw Error(r(476));var S=jp(s).queue;zu(s,S,c,J,p===null?Rg:function(){return wf(s),p(x)})}function jp(s){var c=s.memoizedState;if(c!==null)return c;c={memoizedState:J,baseState:J,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ga,lastRenderedState:J},next:null};var p={};return c.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ga,lastRenderedState:p},next:null},s.memoizedState=c,s=s.alternate,s!==null&&(s.memoizedState=c),c}function wf(s){var c=jp(s).next.queue;ho(s,c,{},Vi())}function Uu(){return ii(Ic)}function Ns(){return fi().memoizedState}function Lg(){return fi().memoizedState}function dl(s){for(var c=s.return;c!==null;){switch(c.tag){case 24:case 3:var p=Vi();s=ol(p);var x=vs(c,s,p);x!==null&&(Ir(x,c,p),Au(x,c,p)),c={cache:ap()},s.payload=c;return}c=c.return}}function Og(s,c,p){var x=Vi();p={lane:x,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},Sf(s)?Fg(c,p):(p=ic(s,c,p,x),p!==null&&(Ir(p,s,x),Ep(p,c,x)))}function _p(s,c,p){var x=Vi();ho(s,c,p,x)}function ho(s,c,p,x){var S={lane:x,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(Sf(s))Fg(c,S);else{var D=s.alternate;if(s.lanes===0&&(D===null||D.lanes===0)&&(D=c.lastRenderedReducer,D!==null))try{var H=c.lastRenderedState,Z=D(H,p);if(S.hasEagerState=!0,S.eagerState=Z,Ji(Z,H))return ba(s,c,S,0),Mn===null&&Xl(),!1}catch{}finally{}if(p=ic(s,c,S,x),p!==null)return Ir(p,s,x),Ep(p,c,x),!0}return!1}function kp(s,c,p,x){if(x={lane:2,revertLane:Vf(),action:x,hasEagerState:!1,eagerState:null,next:null},Sf(s)){if(c)throw Error(r(479))}else c=ic(s,p,x,2),c!==null&&Ir(c,s,2)}function Sf(s){var c=s.alternate;return s===$t||c!==null&&c===$t}function Fg(s,c){co=cc=!0;var p=s.pending;p===null?c.next=c:(c.next=p.next,p.next=c),s.pending=c}function Ep(s,c,p){if((p&4194048)!==0){var x=c.lanes;x&=s.pendingLanes,p|=x,c.lanes=p,Ni(s,p)}}var qu={readContext:ii,use:uf,useCallback:Zt,useContext:Zt,useEffect:Zt,useImperativeHandle:Zt,useLayoutEffect:Zt,useInsertionEffect:Zt,useMemo:Zt,useReducer:Zt,useRef:Zt,useState:Zt,useDebugValue:Zt,useDeferredValue:Zt,useTransition:Zt,useSyncExternalStore:Zt,useId:Zt,useHostTransitionStatus:Zt,useFormState:Zt,useActionState:Zt,useOptimistic:Zt,useMemoCache:Zt,useCacheRefresh:Zt},$g={readContext:ii,use:uf,useCallback:function(s,c){return hr().memoizedState=[s,c===void 0?null:c],s},useContext:ii,useEffect:Ig,useImperativeHandle:function(s,c,p){p=p!=null?p.concat([s]):null,Lu(4194308,4,bf.bind(null,c,s),p)},useLayoutEffect:function(s,c){return Lu(4194308,4,s,c)},useInsertionEffect:function(s,c){Lu(4,2,s,c)},useMemo:function(s,c){var p=hr();c=c===void 0?null:c;var x=s();if(Ui){je(!0);try{s()}finally{je(!1)}}return p.memoizedState=[x,c],x},useReducer:function(s,c,p){var x=hr();if(p!==void 0){var S=p(c);if(Ui){je(!0);try{p(c)}finally{je(!1)}}}else S=c;return x.memoizedState=x.baseState=S,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:S},x.queue=s,s=s.dispatch=Og.bind(null,$t,s),[x.memoizedState,s]},useRef:function(s){var c=hr();return s={current:s},c.memoizedState=s},useState:function(s){s=pf(s);var c=s.queue,p=_p.bind(null,$t,c);return c.dispatch=p,[s.memoizedState,p]},useDebugValue:vf,useDeferredValue:function(s,c){var p=hr();return $u(p,s,c)},useTransition:function(){var s=pf(!1);return s=zu.bind(null,$t,s.queue,!0,!1),hr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,c,p){var x=$t,S=hr();if(Kt){if(p===void 0)throw Error(r(407));p=p()}else{if(p=c(),Mn===null)throw Error(r(349));(sn&124)!==0||ff(x,c,p)}S.memoizedState=p;var D={value:p,getSnapshot:c};return S.queue=D,Ig(hf.bind(null,x,D,s),[s]),x.flags|=2048,dc(9,xf(),Tg.bind(null,x,D,p,c),null),p},useId:function(){var s=hr(),c=Mn.identifierPrefix;if(Kt){var p=xs,x=qn;p=(x&~(1<<32-Ae(x)-1)).toString(32)+p,c=""+c+"R"+p,p=uc++,0<p&&(c+="H"+p.toString(32)),c+=""}else p=_g++,c=""+c+"r"+p.toString(32)+"";return s.memoizedState=c},useHostTransitionStatus:Uu,useFormState:wp,useActionState:wp,useOptimistic:function(s){var c=hr();c.memoizedState=c.baseState=s;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=p,c=kp.bind(null,$t,!0,p),p.dispatch=c,[s,c]},useMemoCache:Mu,useCacheRefresh:function(){return hr().memoizedState=dl.bind(null,$t)}},Tp={readContext:ii,use:uf,useCallback:pr,useContext:ii,useEffect:Tr,useImperativeHandle:Np,useInsertionEffect:Mg,useLayoutEffect:Fu,useMemo:Ss,useReducer:df,useRef:fc,useState:function(){return df(Ga)},useDebugValue:vf,useDeferredValue:function(s,c){var p=fi();return Cp(p,xn.memoizedState,s,c)},useTransition:function(){var s=df(Ga)[0],c=fi().memoizedState;return[typeof s=="boolean"?s:Iu(s),c]},useSyncExternalStore:gp,useId:Ns,useHostTransitionStatus:Uu,useFormState:yf,useActionState:yf,useOptimistic:function(s,c){var p=fi();return Ru(p,xn,s,c)},useMemoCache:Mu,useCacheRefresh:Lg},zg={readContext:ii,use:uf,useCallback:pr,useContext:ii,useEffect:Tr,useImperativeHandle:Np,useInsertionEffect:Mg,useLayoutEffect:Fu,useMemo:Ss,useReducer:mp,useRef:fc,useState:function(){return mp(Ga)},useDebugValue:vf,useDeferredValue:function(s,c){var p=fi();return xn===null?$u(p,s,c):Cp(p,xn.memoizedState,s,c)},useTransition:function(){var s=mp(Ga)[0],c=fi().memoizedState;return[typeof s=="boolean"?s:Iu(s),c]},useSyncExternalStore:gp,useId:Ns,useHostTransitionStatus:Uu,useFormState:Ot,useActionState:Ot,useOptimistic:function(s,c){var p=fi();return xn!==null?Ru(p,xn,s,c):(p.baseState=s,[s,p.queue.dispatch])},useMemoCache:Mu,useCacheRefresh:Lg},gi=null,mr=0;function Nf(s){var c=mr;return mr+=1,gi===null&&(gi=[]),op(gi,s,c)}function Vu(s,c){c=c.props.ref,s.ref=c!==void 0?c:null}function po(s,c){throw c.$$typeof===g?Error(r(525)):(s=Object.prototype.toString.call(c),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":s)))}function mo(s){var c=s._init;return c(s._payload)}function Ap(s){function c(ke,Ce){if(s){var Pe=ke.deletions;Pe===null?(ke.deletions=[Ce],ke.flags|=16):Pe.push(Ce)}}function p(ke,Ce){if(!s)return null;for(;Ce!==null;)c(ke,Ce),Ce=Ce.sibling;return null}function x(ke){for(var Ce=new Map;ke!==null;)ke.key!==null?Ce.set(ke.key,ke):Ce.set(ke.index,ke),ke=ke.sibling;return Ce}function S(ke,Ce){return ke=Xi(ke,Ce),ke.index=0,ke.sibling=null,ke}function D(ke,Ce,Pe){return ke.index=Pe,s?(Pe=ke.alternate,Pe!==null?(Pe=Pe.index,Pe<Ce?(ke.flags|=67108866,Ce):Pe):(ke.flags|=67108866,Ce)):(ke.flags|=1048576,Ce)}function H(ke){return s&&ke.alternate===null&&(ke.flags|=67108866),ke}function Z(ke,Ce,Pe,Ve){return Ce===null||Ce.tag!==6?(Ce=np(Pe,ke.mode,Ve),Ce.return=ke,Ce):(Ce=S(Ce,Pe),Ce.return=ke,Ce)}function ye(ke,Ce,Pe,Ve){var ft=Pe.type;return ft===N?Ue(ke,Ce,Pe.props.children,Ve,Pe.key):Ce!==null&&(Ce.elementType===ft||typeof ft=="object"&&ft!==null&&ft.$$typeof===z&&mo(ft)===Ce.type)?(Ce=S(Ce,Pe.props),Vu(Ce,Pe),Ce.return=ke,Ce):(Ce=ef(Pe.type,Pe.key,Pe.props,null,ke.mode,Ve),Vu(Ce,Pe),Ce.return=ke,Ce)}function Ie(ke,Ce,Pe,Ve){return Ce===null||Ce.tag!==4||Ce.stateNode.containerInfo!==Pe.containerInfo||Ce.stateNode.implementation!==Pe.implementation?(Ce=rc(Pe,ke.mode,Ve),Ce.return=ke,Ce):(Ce=S(Ce,Pe.children||[]),Ce.return=ke,Ce)}function Ue(ke,Ce,Pe,Ve,ft){return Ce===null||Ce.tag!==7?(Ce=no(Pe,ke.mode,Ve,ft),Ce.return=ke,Ce):(Ce=S(Ce,Pe),Ce.return=ke,Ce)}function Ge(ke,Ce,Pe){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return Ce=np(""+Ce,ke.mode,Pe),Ce.return=ke,Ce;if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case b:return Pe=ef(Ce.type,Ce.key,Ce.props,null,ke.mode,Pe),Vu(Pe,Ce),Pe.return=ke,Pe;case v:return Ce=rc(Ce,ke.mode,Pe),Ce.return=ke,Ce;case z:var Ve=Ce._init;return Ce=Ve(Ce._payload),Ge(ke,Ce,Pe)}if(le(Ce)||G(Ce))return Ce=no(Ce,ke.mode,Pe,null),Ce.return=ke,Ce;if(typeof Ce.then=="function")return Ge(ke,Nf(Ce),Pe);if(Ce.$$typeof===P)return Ge(ke,rf(ke,Ce),Pe);po(ke,Ce)}return null}function Oe(ke,Ce,Pe,Ve){var ft=Ce!==null?Ce.key:null;if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number"||typeof Pe=="bigint")return ft!==null?null:Z(ke,Ce,""+Pe,Ve);if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case b:return Pe.key===ft?ye(ke,Ce,Pe,Ve):null;case v:return Pe.key===ft?Ie(ke,Ce,Pe,Ve):null;case z:return ft=Pe._init,Pe=ft(Pe._payload),Oe(ke,Ce,Pe,Ve)}if(le(Pe)||G(Pe))return ft!==null?null:Ue(ke,Ce,Pe,Ve,null);if(typeof Pe.then=="function")return Oe(ke,Ce,Nf(Pe),Ve);if(Pe.$$typeof===P)return Oe(ke,Ce,rf(ke,Pe),Ve);po(ke,Pe)}return null}function Re(ke,Ce,Pe,Ve,ft){if(typeof Ve=="string"&&Ve!==""||typeof Ve=="number"||typeof Ve=="bigint")return ke=ke.get(Pe)||null,Z(Ce,ke,""+Ve,ft);if(typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case b:return ke=ke.get(Ve.key===null?Pe:Ve.key)||null,ye(Ce,ke,Ve,ft);case v:return ke=ke.get(Ve.key===null?Pe:Ve.key)||null,Ie(Ce,ke,Ve,ft);case z:var Ht=Ve._init;return Ve=Ht(Ve._payload),Re(ke,Ce,Pe,Ve,ft)}if(le(Ve)||G(Ve))return ke=ke.get(Pe)||null,Ue(Ce,ke,Ve,ft,null);if(typeof Ve.then=="function")return Re(ke,Ce,Pe,Nf(Ve),ft);if(Ve.$$typeof===P)return Re(ke,Ce,Pe,rf(Ce,Ve),ft);po(Ce,Ve)}return null}function St(ke,Ce,Pe,Ve){for(var ft=null,Ht=null,mt=Ce,Nt=Ce=0,ki=null;mt!==null&&Nt<Pe.length;Nt++){mt.index>Nt?(ki=mt,mt=null):ki=mt.sibling;var on=Oe(ke,mt,Pe[Nt],Ve);if(on===null){mt===null&&(mt=ki);break}s&&mt&&on.alternate===null&&c(ke,mt),Ce=D(on,Ce,Nt),Ht===null?ft=on:Ht.sibling=on,Ht=on,mt=ki}if(Nt===Pe.length)return p(ke,mt),Kt&&io(ke,Nt),ft;if(mt===null){for(;Nt<Pe.length;Nt++)mt=Ge(ke,Pe[Nt],Ve),mt!==null&&(Ce=D(mt,Ce,Nt),Ht===null?ft=mt:Ht.sibling=mt,Ht=mt);return Kt&&io(ke,Nt),ft}for(mt=x(mt);Nt<Pe.length;Nt++)ki=Re(mt,ke,Nt,Pe[Nt],Ve),ki!==null&&(s&&ki.alternate!==null&&mt.delete(ki.key===null?Nt:ki.key),Ce=D(ki,Ce,Nt),Ht===null?ft=ki:Ht.sibling=ki,Ht=ki);return s&&mt.forEach(function(kl){return c(ke,kl)}),Kt&&io(ke,Nt),ft}function vt(ke,Ce,Pe,Ve){if(Pe==null)throw Error(r(151));for(var ft=null,Ht=null,mt=Ce,Nt=Ce=0,ki=null,on=Pe.next();mt!==null&&!on.done;Nt++,on=Pe.next()){mt.index>Nt?(ki=mt,mt=null):ki=mt.sibling;var kl=Oe(ke,mt,on.value,Ve);if(kl===null){mt===null&&(mt=ki);break}s&&mt&&kl.alternate===null&&c(ke,mt),Ce=D(kl,Ce,Nt),Ht===null?ft=kl:Ht.sibling=kl,Ht=kl,mt=ki}if(on.done)return p(ke,mt),Kt&&io(ke,Nt),ft;if(mt===null){for(;!on.done;Nt++,on=Pe.next())on=Ge(ke,on.value,Ve),on!==null&&(Ce=D(on,Ce,Nt),Ht===null?ft=on:Ht.sibling=on,Ht=on);return Kt&&io(ke,Nt),ft}for(mt=x(mt);!on.done;Nt++,on=Pe.next())on=Re(mt,ke,Nt,on.value,Ve),on!==null&&(s&&on.alternate!==null&&mt.delete(on.key===null?Nt:on.key),Ce=D(on,Ce,Nt),Ht===null?ft=on:Ht.sibling=on,Ht=on);return s&&mt.forEach(function(T0){return c(ke,T0)}),Kt&&io(ke,Nt),ft}function _n(ke,Ce,Pe,Ve){if(typeof Pe=="object"&&Pe!==null&&Pe.type===N&&Pe.key===null&&(Pe=Pe.props.children),typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case b:e:{for(var ft=Pe.key;Ce!==null;){if(Ce.key===ft){if(ft=Pe.type,ft===N){if(Ce.tag===7){p(ke,Ce.sibling),Ve=S(Ce,Pe.props.children),Ve.return=ke,ke=Ve;break e}}else if(Ce.elementType===ft||typeof ft=="object"&&ft!==null&&ft.$$typeof===z&&mo(ft)===Ce.type){p(ke,Ce.sibling),Ve=S(Ce,Pe.props),Vu(Ve,Pe),Ve.return=ke,ke=Ve;break e}p(ke,Ce);break}else c(ke,Ce);Ce=Ce.sibling}Pe.type===N?(Ve=no(Pe.props.children,ke.mode,Ve,Pe.key),Ve.return=ke,ke=Ve):(Ve=ef(Pe.type,Pe.key,Pe.props,null,ke.mode,Ve),Vu(Ve,Pe),Ve.return=ke,ke=Ve)}return H(ke);case v:e:{for(ft=Pe.key;Ce!==null;){if(Ce.key===ft)if(Ce.tag===4&&Ce.stateNode.containerInfo===Pe.containerInfo&&Ce.stateNode.implementation===Pe.implementation){p(ke,Ce.sibling),Ve=S(Ce,Pe.children||[]),Ve.return=ke,ke=Ve;break e}else{p(ke,Ce);break}else c(ke,Ce);Ce=Ce.sibling}Ve=rc(Pe,ke.mode,Ve),Ve.return=ke,ke=Ve}return H(ke);case z:return ft=Pe._init,Pe=ft(Pe._payload),_n(ke,Ce,Pe,Ve)}if(le(Pe))return St(ke,Ce,Pe,Ve);if(G(Pe)){if(ft=G(Pe),typeof ft!="function")throw Error(r(150));return Pe=ft.call(Pe),vt(ke,Ce,Pe,Ve)}if(typeof Pe.then=="function")return _n(ke,Ce,Nf(Pe),Ve);if(Pe.$$typeof===P)return _n(ke,Ce,rf(ke,Pe),Ve);po(ke,Pe)}return typeof Pe=="string"&&Pe!==""||typeof Pe=="number"||typeof Pe=="bigint"?(Pe=""+Pe,Ce!==null&&Ce.tag===6?(p(ke,Ce.sibling),Ve=S(Ce,Pe),Ve.return=ke,ke=Ve):(p(ke,Ce),Ve=np(Pe,ke.mode,Ve),Ve.return=ke,ke=Ve),H(ke)):p(ke,Ce)}return function(ke,Ce,Pe,Ve){try{mr=0;var ft=_n(ke,Ce,Pe,Ve);return gi=null,ft}catch(mt){if(mt===Zi||mt===sf)throw mt;var Ht=cr(29,mt,null,ke.mode);return Ht.lanes=Ve,Ht.return=ke,Ht}finally{}}}var go=Ap(!0),Bg=Ap(!1),Ar=ae(null),er=null;function Qr(s){var c=s.alternate;M(ri,ri.current&1),M(Ar,s),er===null&&(c===null||oo.current!==null||c.memoizedState!==null)&&(er=s)}function Ug(s){if(s.tag===22){if(M(ri,ri.current),M(Ar,s),er===null){var c=s.alternate;c!==null&&c.memoizedState!==null&&(er=s)}}else Cs()}function Cs(){M(ri,ri.current),M(Ar,Ar.current)}function Ya(s){ce(Ar),er===s&&(er=null),ce(ri)}var ri=ae(0);function Hu(s){for(var c=s;c!==null;){if(c.tag===13){var p=c.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||nr(p)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function hc(s,c,p,x){c=s.memoizedState,p=p(x,c),p=p==null?c:h({},c,p),s.memoizedState=p,s.lanes===0&&(s.updateQueue.baseState=p)}var Gu={enqueueSetState:function(s,c,p){s=s._reactInternals;var x=Vi(),S=ol(x);S.payload=c,p!=null&&(S.callback=p),c=vs(s,S,x),c!==null&&(Ir(c,s,x),Au(c,s,x))},enqueueReplaceState:function(s,c,p){s=s._reactInternals;var x=Vi(),S=ol(x);S.tag=1,S.payload=c,p!=null&&(S.callback=p),c=vs(s,S,x),c!==null&&(Ir(c,s,x),Au(c,s,x))},enqueueForceUpdate:function(s,c){s=s._reactInternals;var p=Vi(),x=ol(p);x.tag=2,c!=null&&(x.callback=c),c=vs(s,x,p),c!==null&&(Ir(c,s,p),Au(c,s,p))}};function Yu(s,c,p,x,S,D,H){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(x,D,H):c.prototype&&c.prototype.isPureReactComponent?!Ur(p,x)||!Ur(S,D):!0}function qg(s,c,p,x){s=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(p,x),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(p,x),c.state!==s&&Gu.enqueueReplaceState(c,c.state,null)}function fl(s,c){var p=c;if("ref"in c){p={};for(var x in c)x!=="ref"&&(p[x]=c[x])}if(s=s.defaultProps){p===c&&(p=h({},p));for(var S in s)p[S]===void 0&&(p[S]=s[S])}return p}var yo=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Dp(s){yo(s)}function Cf(s){console.error(s)}function Vg(s){yo(s)}function Wu(s,c){try{var p=s.onUncaughtError;p(c.value,{componentStack:c.stack})}catch(x){setTimeout(function(){throw x})}}function Wa(s,c,p){try{var x=s.onCaughtError;x(p.value,{componentStack:p.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function jf(s,c,p){return p=ol(p),p.tag=3,p.payload={element:null},p.callback=function(){Wu(s,c)},p}function Pp(s){return s=ol(s),s.tag=3,s}function Hg(s,c,p,x){var S=p.type.getDerivedStateFromError;if(typeof S=="function"){var D=x.value;s.payload=function(){return S(D)},s.callback=function(){Wa(c,p,x)}}var H=p.stateNode;H!==null&&typeof H.componentDidCatch=="function"&&(s.callback=function(){Wa(c,p,x),typeof S!="function"&&(xl===null?xl=new Set([this]):xl.add(this));var Z=x.stack;this.componentDidCatch(x.value,{componentStack:Z!==null?Z:""})})}function Gg(s,c,p,x,S){if(p.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(c=p.alternate,c!==null&&ku(c,p,S,!0),p=Ar.current,p!==null){switch(p.tag){case 13:return er===null?Kp():p.alternate===null&&ai===0&&(ai=3),p.flags&=-257,p.flags|=65536,p.lanes=S,x===lp?p.flags|=16384:(c=p.updateQueue,c===null?p.updateQueue=new Set([x]):c.add(x),em(s,x,S)),!1;case 22:return p.flags|=65536,x===lp?p.flags|=16384:(c=p.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([x])},p.updateQueue=c):(p=c.retryQueue,p===null?c.retryQueue=new Set([x]):p.add(x)),em(s,x,S)),!1}throw Error(r(435,p.tag))}return em(s,x,S),Kp(),!1}if(Kt)return c=Ar.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=S,x!==ac&&(s=Error(r(422),{cause:x}),sl(Ki(s,p)))):(x!==ac&&(c=Error(r(423),{cause:x}),sl(Ki(c,p))),s=s.current.alternate,s.flags|=65536,S&=-S,s.lanes|=S,x=Ki(x,p),S=jf(s.stateNode,x,S),wa(s,S),ai!==4&&(ai=2)),!1;var D=Error(r(520),{cause:x});if(D=Ki(D,p),rd===null?rd=[D]:rd.push(D),ai!==4&&(ai=2),c===null)return!0;x=Ki(x,p),p=c;do{switch(p.tag){case 3:return p.flags|=65536,s=S&-S,p.lanes|=s,s=jf(p.stateNode,x,s),wa(p,s),!1;case 1:if(c=p.type,D=p.stateNode,(p.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(xl===null||!xl.has(D))))return p.flags|=65536,S&=-S,p.lanes|=S,S=Pp(S),Hg(S,s,p,x),wa(p,S),!1}p=p.return}while(p!==null);return!1}var Yg=Error(r(461)),Ci=!1;function zn(s,c,p,x){c.child=s===null?Bg(c,null,p,x):go(c,s.child,p,x)}function _f(s,c,p,x,S){p=p.render;var D=c.ref;if("ref"in x){var H={};for(var Z in x)Z!=="ref"&&(H[Z]=x[Z])}else H=x;return ao(c),x=dp(s,c,p,H,D,S),Z=hp(),s!==null&&!Ci?(uo(s,c,S),js(s,c,S)):(Kt&&Z&&rp(c),c.flags|=1,zn(s,c,x,S),c.child)}function kf(s,c,p,x,S){if(s===null){var D=p.type;return typeof D=="function"&&!to(D)&&D.defaultProps===void 0&&p.compare===null?(c.tag=15,c.type=D,Ef(s,c,D,x,S)):(s=ef(p.type,null,x,c,c.mode,S),s.ref=c.ref,s.return=c,c.child=s)}if(D=s.child,!Ca(s,S)){var H=D.memoizedProps;if(p=p.compare,p=p!==null?p:Ur,p(H,x)&&s.ref===c.ref)return js(s,c,S)}return c.flags|=1,s=Xi(D,x),s.ref=c.ref,s.return=c,c.child=s}function Ef(s,c,p,x,S){if(s!==null){var D=s.memoizedProps;if(Ur(D,x)&&s.ref===c.ref)if(Ci=!1,c.pendingProps=x=D,Ca(s,S))(s.flags&131072)!==0&&(Ci=!0);else return c.lanes=s.lanes,js(s,c,S)}return pc(s,c,p,x,S)}function Qu(s,c,p){var x=c.pendingProps,S=x.children,D=s!==null?s.memoizedState:null;if(x.mode==="hidden"){if((c.flags&128)!==0){if(x=D!==null?D.baseLanes|p:p,s!==null){for(S=c.child=s.child,D=0;S!==null;)D=D|S.lanes|S.childLanes,S=S.sibling;c.childLanes=D&~x}else c.childLanes=0,c.child=null;return xo(s,c,x,p)}if((p&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},s!==null&&af(c,D!==null?D.cachePool:null),D!==null?ws(c,D):of(),Ug(c);else return c.lanes=c.childLanes=536870912,xo(s,c,D!==null?D.baseLanes|p:p,p)}else D!==null?(af(c,D.cachePool),ws(c,D),Cs(),c.memoizedState=null):(s!==null&&af(c,null),of(),Cs());return zn(s,c,S,p),c.child}function xo(s,c,p,x){var S=bs();return S=S===null?null:{parent:Tn._currentValue,pool:S},c.memoizedState={baseLanes:p,cachePool:S},s!==null&&af(c,null),of(),Ug(c),s!==null&&ku(s,c,x,!0),null}function xt(s,c){var p=c.ref;if(p===null)s!==null&&s.ref!==null&&(c.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(r(284));(s===null||s.ref!==p)&&(c.flags|=4194816)}}function pc(s,c,p,x,S){return ao(c),p=dp(s,c,p,x,void 0,S),x=hp(),s!==null&&!Ci?(uo(s,c,S),js(s,c,S)):(Kt&&x&&rp(c),c.flags|=1,zn(s,c,p,S),c.child)}function Tf(s,c,p,x,S,D){return ao(c),c.updateQueue=null,p=Eg(c,x,p,S),kg(s),x=hp(),s!==null&&!Ci?(uo(s,c,D),js(s,c,D)):(Kt&&x&&rp(c),c.flags|=1,zn(s,c,p,D),c.child)}function hl(s,c,p,x,S){if(ao(c),c.stateNode===null){var D=eo,H=p.contextType;typeof H=="object"&&H!==null&&(D=ii(H)),D=new p(x,D),c.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,D.updater=Gu,c.stateNode=D,D._reactInternals=c,D=c.stateNode,D.props=x,D.state=c.memoizedState,D.refs={},lo(c),H=p.contextType,D.context=typeof H=="object"&&H!==null?ii(H):eo,D.state=c.memoizedState,H=p.getDerivedStateFromProps,typeof H=="function"&&(hc(c,p,H,x),D.state=c.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(H=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),H!==D.state&&Gu.enqueueReplaceState(D,D.state,null),Bi(c,x,D,S),Sa(),D.state=c.memoizedState),typeof D.componentDidMount=="function"&&(c.flags|=4194308),x=!0}else if(s===null){D=c.stateNode;var Z=c.memoizedProps,ye=fl(p,Z);D.props=ye;var Ie=D.context,Ue=p.contextType;H=eo,typeof Ue=="object"&&Ue!==null&&(H=ii(Ue));var Ge=p.getDerivedStateFromProps;Ue=typeof Ge=="function"||typeof D.getSnapshotBeforeUpdate=="function",Z=c.pendingProps!==Z,Ue||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(Z||Ie!==H)&&qg(c,D,x,H),Ha=!1;var Oe=c.memoizedState;D.state=Oe,Bi(c,x,D,S),Sa(),Ie=c.memoizedState,Z||Oe!==Ie||Ha?(typeof Ge=="function"&&(hc(c,p,Ge,x),Ie=c.memoizedState),(ye=Ha||Yu(c,p,ye,x,Oe,Ie,H))?(Ue||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(c.flags|=4194308)):(typeof D.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=x,c.memoizedState=Ie),D.props=x,D.state=Ie,D.context=H,x=ye):(typeof D.componentDidMount=="function"&&(c.flags|=4194308),x=!1)}else{D=c.stateNode,oc(s,c),H=c.memoizedProps,Ue=fl(p,H),D.props=Ue,Ge=c.pendingProps,Oe=D.context,Ie=p.contextType,ye=eo,typeof Ie=="object"&&Ie!==null&&(ye=ii(Ie)),Z=p.getDerivedStateFromProps,(Ie=typeof Z=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(H!==Ge||Oe!==ye)&&qg(c,D,x,ye),Ha=!1,Oe=c.memoizedState,D.state=Oe,Bi(c,x,D,S),Sa();var Re=c.memoizedState;H!==Ge||Oe!==Re||Ha||s!==null&&s.dependencies!==null&&nf(s.dependencies)?(typeof Z=="function"&&(hc(c,p,Z,x),Re=c.memoizedState),(Ue=Ha||Yu(c,p,Ue,x,Oe,Re,ye)||s!==null&&s.dependencies!==null&&nf(s.dependencies))?(Ie||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(x,Re,ye),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(x,Re,ye)),typeof D.componentDidUpdate=="function"&&(c.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof D.componentDidUpdate!="function"||H===s.memoizedProps&&Oe===s.memoizedState||(c.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||H===s.memoizedProps&&Oe===s.memoizedState||(c.flags|=1024),c.memoizedProps=x,c.memoizedState=Re),D.props=x,D.state=Re,D.context=ye,x=Ue):(typeof D.componentDidUpdate!="function"||H===s.memoizedProps&&Oe===s.memoizedState||(c.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||H===s.memoizedProps&&Oe===s.memoizedState||(c.flags|=1024),x=!1)}return D=x,xt(s,c),x=(c.flags&128)!==0,D||x?(D=c.stateNode,p=x&&typeof p.getDerivedStateFromError!="function"?null:D.render(),c.flags|=1,s!==null&&x?(c.child=go(c,s.child,null,S),c.child=go(c,null,p,S)):zn(s,c,p,S),c.memoizedState=D.state,s=c.child):s=js(s,c,S),s}function Wg(s,c,p,x){return _u(),c.flags|=256,zn(s,c,p,x),c.child}var Ju={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Af(s){return{baseLanes:s,cachePool:vg()}}function ji(s,c,p){return s=s!==null?s.childLanes&~p:0,c&&(s|=Kr),s}function Qg(s,c,p){var x=c.pendingProps,S=!1,D=(c.flags&128)!==0,H;if((H=D)||(H=s!==null&&s.memoizedState===null?!1:(ri.current&2)!==0),H&&(S=!0,c.flags&=-129),H=(c.flags&32)!==0,c.flags&=-33,s===null){if(Kt){if(S?Qr(c):Cs(),Kt){var Z=Vn,ye;if(ye=Z){e:{for(ye=Z,Z=ur;ye.nodeType!==8;){if(!Z){Z=null;break e}if(ye=_a(ye.nextSibling),ye===null){Z=null;break e}}Z=ye}Z!==null?(c.memoizedState={dehydrated:Z,treeContext:$n!==null?{id:qn,overflow:xs}:null,retryLane:536870912,hydrationErrors:null},ye=cr(18,null,null,0),ye.stateNode=Z,ye.return=c,c.child=ye,mi=c,Vn=null,ye=!0):ye=!1}ye||Gr(c)}if(Z=c.memoizedState,Z!==null&&(Z=Z.dehydrated,Z!==null))return nr(Z)?c.lanes=32:c.lanes=536870912,null;Ya(c)}return Z=x.children,x=x.fallback,S?(Cs(),S=c.mode,Z=Ku({mode:"hidden",children:Z},S),x=no(x,S,p,null),Z.return=c,x.return=c,Z.sibling=x,c.child=Z,S=c.child,S.memoizedState=Af(p),S.childLanes=ji(s,H,p),c.memoizedState=Ju,x):(Qr(c),Ip(c,Z))}if(ye=s.memoizedState,ye!==null&&(Z=ye.dehydrated,Z!==null)){if(D)c.flags&256?(Qr(c),c.flags&=-257,c=Mp(s,c,p)):c.memoizedState!==null?(Cs(),c.child=s.child,c.flags|=128,c=null):(Cs(),S=x.fallback,Z=c.mode,x=Ku({mode:"visible",children:x.children},Z),S=no(S,Z,p,null),S.flags|=2,x.return=c,S.return=c,x.sibling=S,c.child=x,go(c,s.child,null,p),x=c.child,x.memoizedState=Af(p),x.childLanes=ji(s,H,p),c.memoizedState=Ju,c=S);else if(Qr(c),nr(Z)){if(H=Z.nextSibling&&Z.nextSibling.dataset,H)var Ie=H.dgst;H=Ie,x=Error(r(419)),x.stack="",x.digest=H,sl({value:x,source:null,stack:null}),c=Mp(s,c,p)}else if(Ci||ku(s,c,p,!1),H=(p&s.childLanes)!==0,Ci||H){if(H=Mn,H!==null&&(x=p&-p,x=(x&42)!==0?1:Hi(x),x=(x&(H.suspendedLanes|p))!==0?0:x,x!==0&&x!==ye.retryLane))throw ye.retryLane=x,Zl(s,x),Ir(H,s,x),Yg;Z.data==="$?"||Kp(),c=Mp(s,c,p)}else Z.data==="$?"?(c.flags|=192,c.child=s.child,c=null):(s=ye.treeContext,Vn=_a(Z.nextSibling),mi=c,Kt=!0,va=null,ur=!1,s!==null&&(Vr[Hr++]=qn,Vr[Hr++]=xs,Vr[Hr++]=$n,qn=s.id,xs=s.overflow,$n=c),c=Ip(c,x.children),c.flags|=4096);return c}return S?(Cs(),S=x.fallback,Z=c.mode,ye=s.child,Ie=ye.sibling,x=Xi(ye,{mode:"hidden",children:x.children}),x.subtreeFlags=ye.subtreeFlags&65011712,Ie!==null?S=Xi(Ie,S):(S=no(S,Z,p,null),S.flags|=2),S.return=c,x.return=c,x.sibling=S,c.child=x,x=S,S=c.child,Z=s.child.memoizedState,Z===null?Z=Af(p):(ye=Z.cachePool,ye!==null?(Ie=Tn._currentValue,ye=ye.parent!==Ie?{parent:Ie,pool:Ie}:ye):ye=vg(),Z={baseLanes:Z.baseLanes|p,cachePool:ye}),S.memoizedState=Z,S.childLanes=ji(s,H,p),c.memoizedState=Ju,x):(Qr(c),p=s.child,s=p.sibling,p=Xi(p,{mode:"visible",children:x.children}),p.return=c,p.sibling=null,s!==null&&(H=c.deletions,H===null?(c.deletions=[s],c.flags|=16):H.push(s)),c.child=p,c.memoizedState=null,p)}function Ip(s,c){return c=Ku({mode:"visible",children:c},s.mode),c.return=s,s.child=c}function Ku(s,c){return s=cr(22,s,null,c),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Mp(s,c,p){return go(c,s.child,null,p),s=Ip(c,c.pendingProps.children),s.flags|=2,c.memoizedState=null,s}function Rp(s,c,p){s.lanes|=c;var x=s.alternate;x!==null&&(x.lanes|=c),dr(s.return,c,p)}function Lp(s,c,p,x,S){var D=s.memoizedState;D===null?s.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:x,tail:p,tailMode:S}:(D.isBackwards=c,D.rendering=null,D.renderingStartTime=0,D.last=x,D.tail=p,D.tailMode=S)}function Jg(s,c,p){var x=c.pendingProps,S=x.revealOrder,D=x.tail;if(zn(s,c,x.children,p),x=ri.current,(x&2)!==0)x=x&1|2,c.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=c.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Rp(s,p,c);else if(s.tag===19)Rp(s,p,c);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===c)break e;for(;s.sibling===null;){if(s.return===null||s.return===c)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}x&=1}switch(M(ri,x),S){case"forwards":for(p=c.child,S=null;p!==null;)s=p.alternate,s!==null&&Hu(s)===null&&(S=p),p=p.sibling;p=S,p===null?(S=c.child,c.child=null):(S=p.sibling,p.sibling=null),Lp(c,!1,S,p,D);break;case"backwards":for(p=null,S=c.child,c.child=null;S!==null;){if(s=S.alternate,s!==null&&Hu(s)===null){c.child=S;break}s=S.sibling,S.sibling=p,p=S,S=s}Lp(c,!0,p,null,D);break;case"together":Lp(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function js(s,c,p){if(s!==null&&(c.dependencies=s.dependencies),yl|=c.lanes,(p&c.childLanes)===0)if(s!==null){if(ku(s,c,p,!1),(p&c.childLanes)===0)return null}else return null;if(s!==null&&c.child!==s.child)throw Error(r(153));if(c.child!==null){for(s=c.child,p=Xi(s,s.pendingProps),c.child=p,p.return=c;s.sibling!==null;)s=s.sibling,p=p.sibling=Xi(s,s.pendingProps),p.return=c;p.sibling=null}return c.child}function Ca(s,c){return(s.lanes&c)!==0?!0:(s=s.dependencies,!!(s!==null&&nf(s)))}function tr(s,c,p){switch(c.tag){case 3:re(c,c.stateNode.containerInfo),Er(c,Tn,s.memoizedState.cache),_u();break;case 27:case 5:qe(c);break;case 4:re(c,c.stateNode.containerInfo);break;case 10:Er(c,c.type,c.memoizedProps.value);break;case 13:var x=c.memoizedState;if(x!==null)return x.dehydrated!==null?(Qr(c),c.flags|=128,null):(p&c.child.childLanes)!==0?Qg(s,c,p):(Qr(c),s=js(s,c,p),s!==null?s.sibling:null);Qr(c);break;case 19:var S=(s.flags&128)!==0;if(x=(p&c.childLanes)!==0,x||(ku(s,c,p,!1),x=(p&c.childLanes)!==0),S){if(x)return Jg(s,c,p);c.flags|=128}if(S=c.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),M(ri,ri.current),x)break;return null;case 22:case 23:return c.lanes=0,Qu(s,c,p);case 24:Er(c,Tn,s.memoizedState.cache)}return js(s,c,p)}function Df(s,c,p){if(s!==null)if(s.memoizedProps!==c.pendingProps)Ci=!0;else{if(!Ca(s,p)&&(c.flags&128)===0)return Ci=!1,tr(s,c,p);Ci=(s.flags&131072)!==0}else Ci=!1,Kt&&(c.flags&1048576)!==0&&ip(c,Nu,c.index);switch(c.lanes=0,c.tag){case 16:e:{s=c.pendingProps;var x=c.elementType,S=x._init;if(x=S(x._payload),c.type=x,typeof x=="function")to(x)?(s=fl(x,s),c.tag=1,c=hl(null,c,x,s,p)):(c.tag=0,c=pc(null,c,x,s,p));else{if(x!=null){if(S=x.$$typeof,S===V){c.tag=11,c=_f(null,c,x,s,p);break e}else if(S===B){c.tag=14,c=kf(null,c,x,s,p);break e}}throw c=te(x)||x,Error(r(306,c,""))}}return c;case 0:return pc(s,c,c.type,c.pendingProps,p);case 1:return x=c.type,S=fl(x,c.pendingProps),hl(s,c,x,S,p);case 3:e:{if(re(c,c.stateNode.containerInfo),s===null)throw Error(r(387));x=c.pendingProps;var D=c.memoizedState;S=D.element,oc(s,c),Bi(c,x,null,p);var H=c.memoizedState;if(x=H.cache,Er(c,Tn,x),x!==D.cache&&Vt(c,[Tn],p,!0),Sa(),x=H.element,D.isDehydrated)if(D={element:x,isDehydrated:!1,cache:H.cache},c.updateQueue.baseState=D,c.memoizedState=D,c.flags&256){c=Wg(s,c,x,p);break e}else if(x!==S){S=Ki(Error(r(424)),c),sl(S),c=Wg(s,c,x,p);break e}else{switch(s=c.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Vn=_a(s.firstChild),mi=c,Kt=!0,va=null,ur=!0,p=Bg(c,null,x,p),c.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(_u(),x===S){c=js(s,c,p);break e}zn(s,c,x,p)}c=c.child}return c;case 26:return xt(s,c),s===null?(p=Gy(c.type,null,c.pendingProps,null))?c.memoizedState=p:Kt||(p=c.type,s=c.pendingProps,x=wo(fe.current).createElement(p),x[Kn]=c,x[Fn]=s,bi(x,p,s),ci(x),c.stateNode=x):c.memoizedState=Gy(c.type,s.memoizedProps,c.pendingProps,s.memoizedState),null;case 27:return qe(c),s===null&&Kt&&(x=c.stateNode=qy(c.type,c.pendingProps,fe.current),mi=c,ur=!0,S=Vn,Xr(c.type)?(cm=S,Vn=_a(x.firstChild)):Vn=S),zn(s,c,c.pendingProps.children,p),xt(s,c),s===null&&(c.flags|=4194304),c.child;case 5:return s===null&&Kt&&((S=x=Vn)&&(x=By(x,c.type,c.pendingProps,ur),x!==null?(c.stateNode=x,mi=c,Vn=_a(x.firstChild),ur=!1,S=!0):S=!1),S||Gr(c)),qe(c),S=c.type,D=c.pendingProps,H=s!==null?s.memoizedProps:null,x=D.children,Wf(S,D)?x=null:H!==null&&Wf(S,H)&&(c.flags|=32),c.memoizedState!==null&&(S=dp(s,c,fp,null,null,p),Ic._currentValue=S),xt(s,c),zn(s,c,x,p),c.child;case 6:return s===null&&Kt&&((s=p=Vn)&&(p=Jf(p,c.pendingProps,ur),p!==null?(c.stateNode=p,mi=c,Vn=null,s=!0):s=!1),s||Gr(c)),null;case 13:return Qg(s,c,p);case 4:return re(c,c.stateNode.containerInfo),x=c.pendingProps,s===null?c.child=go(c,null,x,p):zn(s,c,x,p),c.child;case 11:return _f(s,c,c.type,c.pendingProps,p);case 7:return zn(s,c,c.pendingProps,p),c.child;case 8:return zn(s,c,c.pendingProps.children,p),c.child;case 12:return zn(s,c,c.pendingProps.children,p),c.child;case 10:return x=c.pendingProps,Er(c,c.type,x.value),zn(s,c,x.children,p),c.child;case 9:return S=c.type._context,x=c.pendingProps.children,ao(c),S=ii(S),x=x(S),c.flags|=1,zn(s,c,x,p),c.child;case 14:return kf(s,c,c.type,c.pendingProps,p);case 15:return Ef(s,c,c.type,c.pendingProps,p);case 19:return Jg(s,c,p);case 31:return x=c.pendingProps,p=c.mode,x={mode:x.mode,children:x.children},s===null?(p=Ku(x,p),p.ref=c.ref,c.child=p,p.return=c,c=p):(p=Xi(s.child,x),p.ref=c.ref,c.child=p,p.return=c,c=p),c;case 22:return Qu(s,c,p);case 24:return ao(c),x=ii(Tn),s===null?(S=bs(),S===null&&(S=Mn,D=ap(),S.pooledCache=D,D.refCount++,D!==null&&(S.pooledCacheLanes|=p),S=D),c.memoizedState={parent:x,cache:S},lo(c),Er(c,Tn,S)):((s.lanes&p)!==0&&(oc(s,c),Bi(c,null,null,p),Sa()),S=s.memoizedState,D=c.memoizedState,S.parent!==x?(S={parent:x,cache:x},c.memoizedState=S,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=S),Er(c,Tn,x)):(x=D.cache,Er(c,Tn,x),x!==S.cache&&Vt(c,[Tn],p,!0))),zn(s,c,c.pendingProps.children,p),c.child;case 29:throw c.pendingProps}throw Error(r(156,c.tag))}function _s(s){s.flags|=4}function Pf(s,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!vi(c)){if(c=Ar.current,c!==null&&((sn&4194048)===sn?er!==null:(sn&62914560)!==sn&&(sn&536870912)===0||c!==er))throw lc=lp,wg;s.flags|=8192}}function If(s,c){c!==null&&(s.flags|=4),s.flags&16384&&(c=s.tag!==22?Un():536870912,s.lanes|=c,wc|=c)}function Xu(s,c){if(!Kt)switch(s.tailMode){case"hidden":c=s.tail;for(var p=null;c!==null;)c.alternate!==null&&(p=c),c=c.sibling;p===null?s.tail=null:p.sibling=null;break;case"collapsed":p=s.tail;for(var x=null;p!==null;)p.alternate!==null&&(x=p),p=p.sibling;x===null?c||s.tail===null?s.tail=null:s.tail.sibling=null:x.sibling=null}}function An(s){var c=s.alternate!==null&&s.alternate.child===s.child,p=0,x=0;if(c)for(var S=s.child;S!==null;)p|=S.lanes|S.childLanes,x|=S.subtreeFlags&65011712,x|=S.flags&65011712,S.return=s,S=S.sibling;else for(S=s.child;S!==null;)p|=S.lanes|S.childLanes,x|=S.subtreeFlags,x|=S.flags,S.return=s,S=S.sibling;return s.subtreeFlags|=x,s.childLanes=p,c}function Kg(s,c,p){var x=c.pendingProps;switch(Cu(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return An(c),null;case 1:return An(c),null;case 3:return p=c.stateNode,x=null,s!==null&&(x=s.memoizedState.cache),c.memoizedState.cache!==x&&(c.flags|=2048),Yr(Tn),_e(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(s===null||s.child===null)&&(ju(c)?_s(c):s===null||s.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,gg())),An(c),null;case 26:return p=c.memoizedState,s===null?(_s(c),p!==null?(An(c),Pf(c,p)):(An(c),c.flags&=-16777217)):p?p!==s.memoizedState?(_s(c),An(c),Pf(c,p)):(An(c),c.flags&=-16777217):(s.memoizedProps!==x&&_s(c),An(c),c.flags&=-16777217),null;case 27:et(c),p=fe.current;var S=c.type;if(s!==null&&c.stateNode!=null)s.memoizedProps!==x&&_s(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return An(c),null}s=de.current,ju(c)?pg(c):(s=qy(S,x,p),c.stateNode=s,_s(c))}return An(c),null;case 5:if(et(c),p=c.type,s!==null&&c.stateNode!=null)s.memoizedProps!==x&&_s(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return An(c),null}if(s=de.current,ju(c))pg(c);else{switch(S=wo(fe.current),s){case 1:s=S.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:s=S.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":s=S.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":s=S.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":s=S.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof x.is=="string"?S.createElement("select",{is:x.is}):S.createElement("select"),x.multiple?s.multiple=!0:x.size&&(s.size=x.size);break;default:s=typeof x.is=="string"?S.createElement(p,{is:x.is}):S.createElement(p)}}s[Kn]=c,s[Fn]=x;e:for(S=c.child;S!==null;){if(S.tag===5||S.tag===6)s.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===c)break e;for(;S.sibling===null;){if(S.return===null||S.return===c)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}c.stateNode=s;e:switch(bi(s,p,x),p){case"button":case"input":case"select":case"textarea":s=!!x.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&_s(c)}}return An(c),c.flags&=-16777217,null;case 6:if(s&&c.stateNode!=null)s.memoizedProps!==x&&_s(c);else{if(typeof x!="string"&&c.stateNode===null)throw Error(r(166));if(s=fe.current,ju(c)){if(s=c.stateNode,p=c.memoizedProps,x=null,S=mi,S!==null)switch(S.tag){case 27:case 5:x=S.memoizedProps}s[Kn]=c,s=!!(s.nodeValue===p||x!==null&&x.suppressHydrationWarning===!0||Oy(s.nodeValue,p)),s||Gr(c)}else s=wo(s).createTextNode(x),s[Kn]=c,c.stateNode=s}return An(c),null;case 13:if(x=c.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(S=ju(c),x!==null&&x.dehydrated!==null){if(s===null){if(!S)throw Error(r(318));if(S=c.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(r(317));S[Kn]=c}else _u(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;An(c),S=!1}else S=gg(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=S),S=!0;if(!S)return c.flags&256?(Ya(c),c):(Ya(c),null)}if(Ya(c),(c.flags&128)!==0)return c.lanes=p,c;if(p=x!==null,s=s!==null&&s.memoizedState!==null,p){x=c.child,S=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(S=x.alternate.memoizedState.cachePool.pool);var D=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(D=x.memoizedState.cachePool.pool),D!==S&&(x.flags|=2048)}return p!==s&&p&&(c.child.flags|=8192),If(c,c.updateQueue),An(c),null;case 4:return _e(),s===null&&am(c.stateNode.containerInfo),An(c),null;case 10:return Yr(c.type),An(c),null;case 19:if(ce(ri),S=c.memoizedState,S===null)return An(c),null;if(x=(c.flags&128)!==0,D=S.rendering,D===null)if(x)Xu(S,!1);else{if(ai!==0||s!==null&&(s.flags&128)!==0)for(s=c.child;s!==null;){if(D=Hu(s),D!==null){for(c.flags|=128,Xu(S,!1),s=D.updateQueue,c.updateQueue=s,If(c,s),c.subtreeFlags=0,s=p,p=c.child;p!==null;)Su(p,s),p=p.sibling;return M(ri,ri.current&1|2),c.child}s=s.sibling}S.tail!==null&&Ee()>Sc&&(c.flags|=128,x=!0,Xu(S,!1),c.lanes=4194304)}else{if(!x)if(s=Hu(D),s!==null){if(c.flags|=128,x=!0,s=s.updateQueue,c.updateQueue=s,If(c,s),Xu(S,!0),S.tail===null&&S.tailMode==="hidden"&&!D.alternate&&!Kt)return An(c),null}else 2*Ee()-S.renderingStartTime>Sc&&p!==536870912&&(c.flags|=128,x=!0,Xu(S,!1),c.lanes=4194304);S.isBackwards?(D.sibling=c.child,c.child=D):(s=S.last,s!==null?s.sibling=D:c.child=D,S.last=D)}return S.tail!==null?(c=S.tail,S.rendering=c,S.tail=c.sibling,S.renderingStartTime=Ee(),c.sibling=null,s=ri.current,M(ri,x?s&1|2:s&1),c):(An(c),null);case 22:case 23:return Ya(c),up(),x=c.memoizedState!==null,s!==null?s.memoizedState!==null!==x&&(c.flags|=8192):x&&(c.flags|=8192),x?(p&536870912)!==0&&(c.flags&128)===0&&(An(c),c.subtreeFlags&6&&(c.flags|=8192)):An(c),p=c.updateQueue,p!==null&&If(c,p.retryQueue),p=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),x=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(x=c.memoizedState.cachePool.pool),x!==p&&(c.flags|=2048),s!==null&&ce(so),null;case 24:return p=null,s!==null&&(p=s.memoizedState.cache),c.memoizedState.cache!==p&&(c.flags|=2048),Yr(Tn),An(c),null;case 25:return null;case 30:return null}throw Error(r(156,c.tag))}function Xg(s,c){switch(Cu(c),c.tag){case 1:return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 3:return Yr(Tn),_e(),s=c.flags,(s&65536)!==0&&(s&128)===0?(c.flags=s&-65537|128,c):null;case 26:case 27:case 5:return et(c),null;case 13:if(Ya(c),s=c.memoizedState,s!==null&&s.dehydrated!==null){if(c.alternate===null)throw Error(r(340));_u()}return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 19:return ce(ri),null;case 4:return _e(),null;case 10:return Yr(c.type),null;case 22:case 23:return Ya(c),up(),s!==null&&ce(so),s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 24:return Yr(Tn),null;case 25:return null;default:return null}}function Zg(s,c){switch(Cu(c),c.tag){case 3:Yr(Tn),_e();break;case 26:case 27:case 5:et(c);break;case 4:_e();break;case 13:Ya(c);break;case 19:ce(ri);break;case 10:Yr(c.type);break;case 22:case 23:Ya(c),up(),s!==null&&ce(so);break;case 24:Yr(Tn)}}function Zu(s,c){try{var p=c.updateQueue,x=p!==null?p.lastEffect:null;if(x!==null){var S=x.next;p=S;do{if((p.tag&s)===s){x=void 0;var D=p.create,H=p.inst;x=D(),H.destroy=x}p=p.next}while(p!==S)}}catch(Z){Dn(c,c.return,Z)}}function pl(s,c,p){try{var x=c.updateQueue,S=x!==null?x.lastEffect:null;if(S!==null){var D=S.next;x=D;do{if((x.tag&s)===s){var H=x.inst,Z=H.destroy;if(Z!==void 0){H.destroy=void 0,S=c;var ye=p,Ie=Z;try{Ie()}catch(Ue){Dn(S,ye,Ue)}}}x=x.next}while(x!==D)}}catch(Ue){Dn(c,c.return,Ue)}}function ey(s){var c=s.updateQueue;if(c!==null){var p=s.stateNode;try{cp(c,p)}catch(x){Dn(s,s.return,x)}}}function Op(s,c,p){p.props=fl(s.type,s.memoizedProps),p.state=s.memoizedState;try{p.componentWillUnmount()}catch(x){Dn(s,c,x)}}function mc(s,c){try{var p=s.ref;if(p!==null){switch(s.tag){case 26:case 27:case 5:var x=s.stateNode;break;case 30:x=s.stateNode;break;default:x=s.stateNode}typeof p=="function"?s.refCleanup=p(x):p.current=x}}catch(S){Dn(s,c,S)}}function Qa(s,c){var p=s.ref,x=s.refCleanup;if(p!==null)if(typeof x=="function")try{x()}catch(S){Dn(s,c,S)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(S){Dn(s,c,S)}else p.current=null}function Mf(s){var c=s.type,p=s.memoizedProps,x=s.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":p.autoFocus&&x.focus();break e;case"img":p.src?x.src=p.src:p.srcSet&&(x.srcset=p.srcSet)}}catch(S){Dn(s,s.return,S)}}function Rf(s,c,p){try{var x=s.stateNode;o0(x,s.type,p,c),x[Fn]=c}catch(S){Dn(s,s.return,S)}}function gc(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Xr(s.type)||s.tag===4}function ed(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||gc(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Xr(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Lf(s,c,p){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(s,c):(c=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,c.appendChild(s),p=p._reactRootContainer,p!=null||c.onclick!==null||(c.onclick=Gf));else if(x!==4&&(x===27&&Xr(s.type)&&(p=s.stateNode,c=null),s=s.child,s!==null))for(Lf(s,c,p),s=s.sibling;s!==null;)Lf(s,c,p),s=s.sibling}function td(s,c,p){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?p.insertBefore(s,c):p.appendChild(s);else if(x!==4&&(x===27&&Xr(s.type)&&(p=s.stateNode),s=s.child,s!==null))for(td(s,c,p),s=s.sibling;s!==null;)td(s,c,p),s=s.sibling}function nd(s){var c=s.stateNode,p=s.memoizedProps;try{for(var x=s.type,S=c.attributes;S.length;)c.removeAttributeNode(S[0]);bi(c,x,p),c[Kn]=s,c[Fn]=p}catch(D){Dn(s,s.return,D)}}var Ja=!1,yn=!1,ks=!1,ty=typeof WeakSet=="function"?WeakSet:Set,yi=null;function Wb(s,c){if(s=s.containerInfo,ja=eh,s=gu(s),ec(s)){if("selectionStart"in s)var p={start:s.selectionStart,end:s.selectionEnd};else e:{p=(p=s.ownerDocument)&&p.defaultView||window;var x=p.getSelection&&p.getSelection();if(x&&x.rangeCount!==0){p=x.anchorNode;var S=x.anchorOffset,D=x.focusNode;x=x.focusOffset;try{p.nodeType,D.nodeType}catch{p=null;break e}var H=0,Z=-1,ye=-1,Ie=0,Ue=0,Ge=s,Oe=null;t:for(;;){for(var Re;Ge!==p||S!==0&&Ge.nodeType!==3||(Z=H+S),Ge!==D||x!==0&&Ge.nodeType!==3||(ye=H+x),Ge.nodeType===3&&(H+=Ge.nodeValue.length),(Re=Ge.firstChild)!==null;)Oe=Ge,Ge=Re;for(;;){if(Ge===s)break t;if(Oe===p&&++Ie===S&&(Z=H),Oe===D&&++Ue===x&&(ye=H),(Re=Ge.nextSibling)!==null)break;Ge=Oe,Oe=Ge.parentNode}Ge=Re}p=Z===-1||ye===-1?null:{start:Z,end:ye}}else p=null}p=p||{start:0,end:0}}else p=null;for(Yf={focusedElem:s,selectionRange:p},eh=!1,yi=c;yi!==null;)if(c=yi,s=c.child,(c.subtreeFlags&1024)!==0&&s!==null)s.return=c,yi=s;else for(;yi!==null;){switch(c=yi,D=c.alternate,s=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&D!==null){s=void 0,p=c,S=D.memoizedProps,D=D.memoizedState,x=p.stateNode;try{var St=fl(p.type,S,p.elementType===p.type);s=x.getSnapshotBeforeUpdate(St,D),x.__reactInternalSnapshotBeforeUpdate=s}catch(vt){Dn(p,p.return,vt)}}break;case 3:if((s&1024)!==0){if(s=c.stateNode.containerInfo,p=s.nodeType,p===9)om(s);else if(p===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":om(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=c.sibling,s!==null){s.return=c.return,yi=s;break}yi=c.return}}function ny(s,c,p){var x=p.flags;switch(p.tag){case 0:case 11:case 15:ml(s,p),x&4&&Zu(5,p);break;case 1:if(ml(s,p),x&4)if(s=p.stateNode,c===null)try{s.componentDidMount()}catch(H){Dn(p,p.return,H)}else{var S=fl(p.type,c.memoizedProps);c=c.memoizedState;try{s.componentDidUpdate(S,c,s.__reactInternalSnapshotBeforeUpdate)}catch(H){Dn(p,p.return,H)}}x&64&&ey(p),x&512&&mc(p,p.return);break;case 3:if(ml(s,p),x&64&&(s=p.updateQueue,s!==null)){if(c=null,p.child!==null)switch(p.child.tag){case 27:case 5:c=p.child.stateNode;break;case 1:c=p.child.stateNode}try{cp(s,c)}catch(H){Dn(p,p.return,H)}}break;case 27:c===null&&x&4&&nd(p);case 26:case 5:ml(s,p),c===null&&x&4&&Mf(p),x&512&&mc(p,p.return);break;case 12:ml(s,p);break;case 13:ml(s,p),x&4&&ay(s,p),x&64&&(s=p.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(p=Bf.bind(null,p),Ec(s,p))));break;case 22:if(x=p.memoizedState!==null||Ja,!x){c=c!==null&&c.memoizedState!==null||yn,S=Ja;var D=yn;Ja=x,(yn=c)&&!D?Ts(s,p,(p.subtreeFlags&8772)!==0):ml(s,p),Ja=S,yn=D}break;case 30:break;default:ml(s,p)}}function iy(s){var c=s.alternate;c!==null&&(s.alternate=null,iy(c)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(c=s.stateNode,c!==null&&Zc(c)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Hn=null,gr=!1;function Es(s,c,p){for(p=p.child;p!==null;)ry(s,c,p),p=p.sibling}function ry(s,c,p){if(ie&&typeof ie.onCommitFiberUnmount=="function")try{ie.onCommitFiberUnmount(Q,p)}catch{}switch(p.tag){case 26:yn||Qa(p,c),Es(s,c,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:yn||Qa(p,c);var x=Hn,S=gr;Xr(p.type)&&(Hn=p.stateNode,gr=!1),Es(s,c,p),hd(p.stateNode),Hn=x,gr=S;break;case 5:yn||Qa(p,c);case 6:if(x=Hn,S=gr,Hn=null,Es(s,c,p),Hn=x,gr=S,Hn!==null)if(gr)try{(Hn.nodeType===9?Hn.body:Hn.nodeName==="HTML"?Hn.ownerDocument.body:Hn).removeChild(p.stateNode)}catch(D){Dn(p,c,D)}else try{Hn.removeChild(p.stateNode)}catch(D){Dn(p,c,D)}break;case 18:Hn!==null&&(gr?(s=Hn,Qf(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,p.stateNode),wd(s)):Qf(Hn,p.stateNode));break;case 4:x=Hn,S=gr,Hn=p.stateNode.containerInfo,gr=!0,Es(s,c,p),Hn=x,gr=S;break;case 0:case 11:case 14:case 15:yn||pl(2,p,c),yn||pl(4,p,c),Es(s,c,p);break;case 1:yn||(Qa(p,c),x=p.stateNode,typeof x.componentWillUnmount=="function"&&Op(p,c,x)),Es(s,c,p);break;case 21:Es(s,c,p);break;case 22:yn=(x=yn)||p.memoizedState!==null,Es(s,c,p),yn=x;break;default:Es(s,c,p)}}function ay(s,c){if(c.memoizedState===null&&(s=c.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{wd(s)}catch(p){Dn(c,c.return,p)}}function Qb(s){switch(s.tag){case 13:case 19:var c=s.stateNode;return c===null&&(c=s.stateNode=new ty),c;case 22:return s=s.stateNode,c=s._retryCache,c===null&&(c=s._retryCache=new ty),c;default:throw Error(r(435,s.tag))}}function Fp(s,c){var p=Qb(s);c.forEach(function(x){var S=t0.bind(null,s,x);p.has(x)||(p.add(x),x.then(S,S))})}function Dr(s,c){var p=c.deletions;if(p!==null)for(var x=0;x<p.length;x++){var S=p[x],D=s,H=c,Z=H;e:for(;Z!==null;){switch(Z.tag){case 27:if(Xr(Z.type)){Hn=Z.stateNode,gr=!1;break e}break;case 5:Hn=Z.stateNode,gr=!1;break e;case 3:case 4:Hn=Z.stateNode.containerInfo,gr=!0;break e}Z=Z.return}if(Hn===null)throw Error(r(160));ry(D,H,S),Hn=null,gr=!1,D=S.alternate,D!==null&&(D.return=null),S.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)$p(c,s),c=c.sibling}var Jr=null;function $p(s,c){var p=s.alternate,x=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Dr(c,s),yr(s),x&4&&(pl(3,s,s.return),Zu(3,s),pl(5,s,s.return));break;case 1:Dr(c,s),yr(s),x&512&&(yn||p===null||Qa(p,p.return)),x&64&&Ja&&(s=s.updateQueue,s!==null&&(x=s.callbacks,x!==null&&(p=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=p===null?x:p.concat(x))));break;case 26:var S=Jr;if(Dr(c,s),yr(s),x&512&&(yn||p===null||Qa(p,p.return)),x&4){var D=p!==null?p.memoizedState:null;if(x=s.memoizedState,p===null)if(x===null)if(s.stateNode===null){e:{x=s.type,p=s.memoizedProps,S=S.ownerDocument||S;t:switch(x){case"title":D=S.getElementsByTagName("title")[0],(!D||D[ls]||D[Kn]||D.namespaceURI==="http://www.w3.org/2000/svg"||D.hasAttribute("itemprop"))&&(D=S.createElement(x),S.head.insertBefore(D,S.querySelector("head > title"))),bi(D,x,p),D[Kn]=s,ci(D),x=D;break e;case"link":var H=Qy("link","href",S).get(x+(p.href||""));if(H){for(var Z=0;Z<H.length;Z++)if(D=H[Z],D.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&D.getAttribute("rel")===(p.rel==null?null:p.rel)&&D.getAttribute("title")===(p.title==null?null:p.title)&&D.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){H.splice(Z,1);break t}}D=S.createElement(x),bi(D,x,p),S.head.appendChild(D);break;case"meta":if(H=Qy("meta","content",S).get(x+(p.content||""))){for(Z=0;Z<H.length;Z++)if(D=H[Z],D.getAttribute("content")===(p.content==null?null:""+p.content)&&D.getAttribute("name")===(p.name==null?null:p.name)&&D.getAttribute("property")===(p.property==null?null:p.property)&&D.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&D.getAttribute("charset")===(p.charSet==null?null:p.charSet)){H.splice(Z,1);break t}}D=S.createElement(x),bi(D,x,p),S.head.appendChild(D);break;default:throw Error(r(468,x))}D[Kn]=s,ci(D),x=D}s.stateNode=x}else Jy(S,s.type,s.stateNode);else s.stateNode=Wy(S,x,s.memoizedProps);else D!==x?(D===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):D.count--,x===null?Jy(S,s.type,s.stateNode):Wy(S,x,s.memoizedProps)):x===null&&s.stateNode!==null&&Rf(s,s.memoizedProps,p.memoizedProps)}break;case 27:Dr(c,s),yr(s),x&512&&(yn||p===null||Qa(p,p.return)),p!==null&&x&4&&Rf(s,s.memoizedProps,p.memoizedProps);break;case 5:if(Dr(c,s),yr(s),x&512&&(yn||p===null||Qa(p,p.return)),s.flags&32){S=s.stateNode;try{da(S,"")}catch(Re){Dn(s,s.return,Re)}}x&4&&s.stateNode!=null&&(S=s.memoizedProps,Rf(s,S,p!==null?p.memoizedProps:S)),x&1024&&(ks=!0);break;case 6:if(Dr(c,s),yr(s),x&4){if(s.stateNode===null)throw Error(r(162));x=s.memoizedProps,p=s.stateNode;try{p.nodeValue=x}catch(Re){Dn(s,s.return,Re)}}break;case 3:if(Pc=null,S=Jr,Jr=Rt(c.containerInfo),Dr(c,s),Jr=S,yr(s),x&4&&p!==null&&p.memoizedState.isDehydrated)try{wd(c.containerInfo)}catch(Re){Dn(s,s.return,Re)}ks&&(ks=!1,sy(s));break;case 4:x=Jr,Jr=Rt(s.stateNode.containerInfo),Dr(c,s),yr(s),Jr=x;break;case 12:Dr(c,s),yr(s);break;case 13:Dr(c,s),yr(s),s.child.flags&8192&&s.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(Gp=Ee()),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,Fp(s,x)));break;case 22:S=s.memoizedState!==null;var ye=p!==null&&p.memoizedState!==null,Ie=Ja,Ue=yn;if(Ja=Ie||S,yn=Ue||ye,Dr(c,s),yn=Ue,Ja=Ie,yr(s),x&8192)e:for(c=s.stateNode,c._visibility=S?c._visibility&-2:c._visibility|1,S&&(p===null||ye||Ja||yn||bo(s)),p=null,c=s;;){if(c.tag===5||c.tag===26){if(p===null){ye=p=c;try{if(D=ye.stateNode,S)H=D.style,typeof H.setProperty=="function"?H.setProperty("display","none","important"):H.display="none";else{Z=ye.stateNode;var Ge=ye.memoizedProps.style,Oe=Ge!=null&&Ge.hasOwnProperty("display")?Ge.display:null;Z.style.display=Oe==null||typeof Oe=="boolean"?"":(""+Oe).trim()}}catch(Re){Dn(ye,ye.return,Re)}}}else if(c.tag===6){if(p===null){ye=c;try{ye.stateNode.nodeValue=S?"":ye.memoizedProps}catch(Re){Dn(ye,ye.return,Re)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===s)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break e;for(;c.sibling===null;){if(c.return===null||c.return===s)break e;p===c&&(p=null),c=c.return}p===c&&(p=null),c.sibling.return=c.return,c=c.sibling}x&4&&(x=s.updateQueue,x!==null&&(p=x.retryQueue,p!==null&&(x.retryQueue=null,Fp(s,p))));break;case 19:Dr(c,s),yr(s),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,Fp(s,x)));break;case 30:break;case 21:break;default:Dr(c,s),yr(s)}}function yr(s){var c=s.flags;if(c&2){try{for(var p,x=s.return;x!==null;){if(gc(x)){p=x;break}x=x.return}if(p==null)throw Error(r(160));switch(p.tag){case 27:var S=p.stateNode,D=ed(s);td(s,D,S);break;case 5:var H=p.stateNode;p.flags&32&&(da(H,""),p.flags&=-33);var Z=ed(s);td(s,Z,H);break;case 3:case 4:var ye=p.stateNode.containerInfo,Ie=ed(s);Lf(s,Ie,ye);break;default:throw Error(r(161))}}catch(Ue){Dn(s,s.return,Ue)}s.flags&=-3}c&4096&&(s.flags&=-4097)}function sy(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var c=s;sy(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),s=s.sibling}}function ml(s,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)ny(s,c.alternate,c),c=c.sibling}function bo(s){for(s=s.child;s!==null;){var c=s;switch(c.tag){case 0:case 11:case 14:case 15:pl(4,c,c.return),bo(c);break;case 1:Qa(c,c.return);var p=c.stateNode;typeof p.componentWillUnmount=="function"&&Op(c,c.return,p),bo(c);break;case 27:hd(c.stateNode);case 26:case 5:Qa(c,c.return),bo(c);break;case 22:c.memoizedState===null&&bo(c);break;case 30:bo(c);break;default:bo(c)}s=s.sibling}}function Ts(s,c,p){for(p=p&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var x=c.alternate,S=s,D=c,H=D.flags;switch(D.tag){case 0:case 11:case 15:Ts(S,D,p),Zu(4,D);break;case 1:if(Ts(S,D,p),x=D,S=x.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(Ie){Dn(x,x.return,Ie)}if(x=D,S=x.updateQueue,S!==null){var Z=x.stateNode;try{var ye=S.shared.hiddenCallbacks;if(ye!==null)for(S.shared.hiddenCallbacks=null,S=0;S<ye.length;S++)jg(ye[S],Z)}catch(Ie){Dn(x,x.return,Ie)}}p&&H&64&&ey(D),mc(D,D.return);break;case 27:nd(D);case 26:case 5:Ts(S,D,p),p&&x===null&&H&4&&Mf(D),mc(D,D.return);break;case 12:Ts(S,D,p);break;case 13:Ts(S,D,p),p&&H&4&&ay(S,D);break;case 22:D.memoizedState===null&&Ts(S,D,p),mc(D,D.return);break;case 30:break;default:Ts(S,D,p)}c=c.sibling}}function zp(s,c){var p=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),s=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(s=c.memoizedState.cachePool.pool),s!==p&&(s!=null&&s.refCount++,p!=null&&Eu(p))}function Bp(s,c){s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&Eu(s))}function Ka(s,c,p,x){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)ly(s,c,p,x),c=c.sibling}function ly(s,c,p,x){var S=c.flags;switch(c.tag){case 0:case 11:case 15:Ka(s,c,p,x),S&2048&&Zu(9,c);break;case 1:Ka(s,c,p,x);break;case 3:Ka(s,c,p,x),S&2048&&(s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&Eu(s)));break;case 12:if(S&2048){Ka(s,c,p,x),s=c.stateNode;try{var D=c.memoizedProps,H=D.id,Z=D.onPostCommit;typeof Z=="function"&&Z(H,c.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(ye){Dn(c,c.return,ye)}}else Ka(s,c,p,x);break;case 13:Ka(s,c,p,x);break;case 23:break;case 22:D=c.stateNode,H=c.alternate,c.memoizedState!==null?D._visibility&2?Ka(s,c,p,x):id(s,c):D._visibility&2?Ka(s,c,p,x):(D._visibility|=2,yc(s,c,p,x,(c.subtreeFlags&10256)!==0)),S&2048&&zp(H,c);break;case 24:Ka(s,c,p,x),S&2048&&Bp(c.alternate,c);break;default:Ka(s,c,p,x)}}function yc(s,c,p,x,S){for(S=S&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var D=s,H=c,Z=p,ye=x,Ie=H.flags;switch(H.tag){case 0:case 11:case 15:yc(D,H,Z,ye,S),Zu(8,H);break;case 23:break;case 22:var Ue=H.stateNode;H.memoizedState!==null?Ue._visibility&2?yc(D,H,Z,ye,S):id(D,H):(Ue._visibility|=2,yc(D,H,Z,ye,S)),S&&Ie&2048&&zp(H.alternate,H);break;case 24:yc(D,H,Z,ye,S),S&&Ie&2048&&Bp(H.alternate,H);break;default:yc(D,H,Z,ye,S)}c=c.sibling}}function id(s,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var p=s,x=c,S=x.flags;switch(x.tag){case 22:id(p,x),S&2048&&zp(x.alternate,x);break;case 24:id(p,x),S&2048&&Bp(x.alternate,x);break;default:id(p,x)}c=c.sibling}}var qi=8192;function xc(s){if(s.subtreeFlags&qi)for(s=s.child;s!==null;)oy(s),s=s.sibling}function oy(s){switch(s.tag){case 26:xc(s),s.flags&qi&&s.memoizedState!==null&&v0(Jr,s.memoizedState,s.memoizedProps);break;case 5:xc(s);break;case 3:case 4:var c=Jr;Jr=Rt(s.stateNode.containerInfo),xc(s),Jr=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=qi,qi=16777216,xc(s),qi=c):xc(s));break;default:xc(s)}}function cy(s){var c=s.alternate;if(c!==null&&(s=c.child,s!==null)){c.child=null;do c=s.sibling,s.sibling=null,s=c;while(s!==null)}}function bc(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var p=0;p<c.length;p++){var x=c[p];yi=x,dy(x,s)}cy(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)uy(s),s=s.sibling}function uy(s){switch(s.tag){case 0:case 11:case 15:bc(s),s.flags&2048&&pl(9,s,s.return);break;case 3:bc(s);break;case 12:bc(s);break;case 22:var c=s.stateNode;s.memoizedState!==null&&c._visibility&2&&(s.return===null||s.return.tag!==13)?(c._visibility&=-3,Of(s)):bc(s);break;default:bc(s)}}function Of(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var p=0;p<c.length;p++){var x=c[p];yi=x,dy(x,s)}cy(s)}for(s=s.child;s!==null;){switch(c=s,c.tag){case 0:case 11:case 15:pl(8,c,c.return),Of(c);break;case 22:p=c.stateNode,p._visibility&2&&(p._visibility&=-3,Of(c));break;default:Of(c)}s=s.sibling}}function dy(s,c){for(;yi!==null;){var p=yi;switch(p.tag){case 0:case 11:case 15:pl(8,p,c);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var x=p.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Eu(p.memoizedState.cache)}if(x=p.child,x!==null)x.return=p,yi=x;else e:for(p=s;yi!==null;){x=yi;var S=x.sibling,D=x.return;if(iy(x),x===p){yi=null;break e}if(S!==null){S.return=D,yi=S;break e}yi=D}}}var Jb={getCacheForType:function(s){var c=ii(Tn),p=c.data.get(s);return p===void 0&&(p=s(),c.data.set(s,p)),p}},Up=typeof WeakMap=="function"?WeakMap:Map,bn=0,Mn=null,Yt=null,sn=0,vn=0,Pr=null,gl=!1,vc=!1,qp=!1,As=0,ai=0,yl=0,vo=0,Vp=0,Kr=0,wc=0,rd=null,xr=null,Hp=!1,Gp=0,Sc=1/0,ad=null,xl=null,Mi=0,bl=null,Nc=null,Cc=0,Yp=0,Wp=null,fy=null,jc=0,Qp=null;function Vi(){if((bn&2)!==0&&sn!==0)return sn&-sn;if(K.T!==null){var s=sc;return s!==0?s:Vf()}return oa()}function hy(){Kr===0&&(Kr=(sn&536870912)===0||Kt?yt():536870912);var s=Ar.current;return s!==null&&(s.flags|=32),Kr}function Ir(s,c,p){(s===Mn&&(vn===2||vn===9)||s.cancelPendingCommit!==null)&&(_c(s,0),vl(s,sn,Kr,!1)),Cn(s,p),((bn&2)===0||s!==Mn)&&(s===Mn&&((bn&2)===0&&(vo|=p),ai===4&&vl(s,sn,Kr,!1)),Xa(s))}function py(s,c,p){if((bn&6)!==0)throw Error(r(327));var x=!p&&(c&124)===0&&(c&s.expiredLanes)===0||at(s,c),S=x?Zb(s,c):Xp(s,c,!0),D=x;do{if(S===0){vc&&!x&&vl(s,c,0,!1);break}else{if(p=s.current.alternate,D&&!Kb(p)){S=Xp(s,c,!1),D=!1;continue}if(S===2){if(D=c,s.errorRecoveryDisabledLanes&D)var H=0;else H=s.pendingLanes&-536870913,H=H!==0?H:H&536870912?536870912:0;if(H!==0){c=H;e:{var Z=s;S=rd;var ye=Z.current.memoizedState.isDehydrated;if(ye&&(_c(Z,H).flags|=256),H=Xp(Z,H,!1),H!==2){if(qp&&!ye){Z.errorRecoveryDisabledLanes|=D,vo|=D,S=4;break e}D=xr,xr=S,D!==null&&(xr===null?xr=D:xr.push.apply(xr,D))}S=H}if(D=!1,S!==2)continue}}if(S===1){_c(s,0),vl(s,c,0,!0);break}e:{switch(x=s,D=S,D){case 0:case 1:throw Error(r(345));case 4:if((c&4194048)!==c)break;case 6:vl(x,c,Kr,!gl);break e;case 2:xr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((c&62914560)===c&&(S=Gp+300-Ee(),10<S)){if(vl(x,c,Kr,!gl),Fe(x,0,!0)!==0)break e;x.timeoutHandle=Fy(my.bind(null,x,p,xr,ad,Hp,c,Kr,vo,wc,gl,D,2,-0,0),S);break e}my(x,p,xr,ad,Hp,c,Kr,vo,wc,gl,D,0,-0,0)}}break}while(!0);Xa(s)}function my(s,c,p,x,S,D,H,Z,ye,Ie,Ue,Ge,Oe,Re){if(s.timeoutHandle=-1,Ge=c.subtreeFlags,(Ge&8192||(Ge&16785408)===16785408)&&(_i={stylesheets:null,count:0,unsuspend:b0},oy(c),Ge=w0(),Ge!==null)){s.cancelPendingCommit=Ge(sd.bind(null,s,c,D,p,x,S,H,Z,ye,Ue,1,Oe,Re)),vl(s,D,H,!Ie);return}sd(s,c,D,p,x,S,H,Z,ye)}function Kb(s){for(var c=s;;){var p=c.tag;if((p===0||p===11||p===15)&&c.flags&16384&&(p=c.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var x=0;x<p.length;x++){var S=p[x],D=S.getSnapshot;S=S.value;try{if(!Ji(D(),S))return!1}catch{return!1}}if(p=c.child,c.subtreeFlags&16384&&p!==null)p.return=c,c=p;else{if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function vl(s,c,p,x){c&=~Vp,c&=~vo,s.suspendedLanes|=c,s.pingedLanes&=~c,x&&(s.warmLanes|=c),x=s.expirationTimes;for(var S=c;0<S;){var D=31-Ae(S),H=1<<D;x[D]=-1,S&=~H}p!==0&&un(s,p,c)}function Ff(){return(bn&6)===0?(cd(0),!1):!0}function Jp(){if(Yt!==null){if(vn===0)var s=Yt.return;else s=Yt,X=ll=null,cf(s),gi=null,mr=0,s=Yt;for(;s!==null;)Zg(s.alternate,s),s=s.return;Yt=null}}function _c(s,c){var p=s.timeoutHandle;p!==-1&&(s.timeoutHandle=-1,u0(p)),p=s.cancelPendingCommit,p!==null&&(s.cancelPendingCommit=null,p()),Jp(),Mn=s,Yt=p=Xi(s.current,null),sn=c,vn=0,Pr=null,gl=!1,vc=at(s,c),qp=!1,wc=Kr=Vp=vo=yl=ai=0,xr=rd=null,Hp=!1,(c&8)!==0&&(c|=c&32);var x=s.entangledLanes;if(x!==0)for(s=s.entanglements,x&=c;0<x;){var S=31-Ae(x),D=1<<S;c|=s[S],x&=~D}return As=c,Xl(),p}function gy(s,c){$t=null,K.H=qu,c===Zi||c===sf?(c=Ng(),vn=3):c===wg?(c=Ng(),vn=4):vn=c===Yg?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,Pr=c,Yt===null&&(ai=1,Wu(s,Ki(c,s.current)))}function yy(){var s=K.H;return K.H=qu,s===null?qu:s}function xy(){var s=K.A;return K.A=Jb,s}function Kp(){ai=4,gl||(sn&4194048)!==sn&&Ar.current!==null||(vc=!0),(yl&134217727)===0&&(vo&134217727)===0||Mn===null||vl(Mn,sn,Kr,!1)}function Xp(s,c,p){var x=bn;bn|=2;var S=yy(),D=xy();(Mn!==s||sn!==c)&&(ad=null,_c(s,c)),c=!1;var H=ai;e:do try{if(vn!==0&&Yt!==null){var Z=Yt,ye=Pr;switch(vn){case 8:Jp(),H=6;break e;case 3:case 2:case 9:case 6:Ar.current===null&&(c=!0);var Ie=vn;if(vn=0,Pr=null,kc(s,Z,ye,Ie),p&&vc){H=0;break e}break;default:Ie=vn,vn=0,Pr=null,kc(s,Z,ye,Ie)}}Xb(),H=ai;break}catch(Ue){gy(s,Ue)}while(!0);return c&&s.shellSuspendCounter++,X=ll=null,bn=x,K.H=S,K.A=D,Yt===null&&(Mn=null,sn=0,Xl()),H}function Xb(){for(;Yt!==null;)Zp(Yt)}function Zb(s,c){var p=bn;bn|=2;var x=yy(),S=xy();Mn!==s||sn!==c?(ad=null,Sc=Ee()+500,_c(s,c)):vc=at(s,c);e:do try{if(vn!==0&&Yt!==null){c=Yt;var D=Pr;t:switch(vn){case 1:vn=0,Pr=null,kc(s,c,D,1);break;case 2:case 9:if(Sg(D)){vn=0,Pr=null,vy(c);break}c=function(){vn!==2&&vn!==9||Mn!==s||(vn=7),Xa(s)},D.then(c,c);break e;case 3:vn=7;break e;case 4:vn=5;break e;case 7:Sg(D)?(vn=0,Pr=null,vy(c)):(vn=0,Pr=null,kc(s,c,D,7));break;case 5:var H=null;switch(Yt.tag){case 26:H=Yt.memoizedState;case 5:case 27:var Z=Yt;if(!H||vi(H)){vn=0,Pr=null;var ye=Z.sibling;if(ye!==null)Yt=ye;else{var Ie=Z.return;Ie!==null?(Yt=Ie,$f(Ie)):Yt=null}break t}}vn=0,Pr=null,kc(s,c,D,5);break;case 6:vn=0,Pr=null,kc(s,c,D,6);break;case 8:Jp(),ai=6;break e;default:throw Error(r(462))}}by();break}catch(Ue){gy(s,Ue)}while(!0);return X=ll=null,K.H=x,K.A=S,bn=p,Yt!==null?0:(Mn=null,sn=0,Xl(),ai)}function by(){for(;Yt!==null&&!Me();)Zp(Yt)}function Zp(s){var c=Df(s.alternate,s,As);s.memoizedProps=s.pendingProps,c===null?$f(s):Yt=c}function vy(s){var c=s,p=c.alternate;switch(c.tag){case 15:case 0:c=Tf(p,c,c.pendingProps,c.type,void 0,sn);break;case 11:c=Tf(p,c,c.pendingProps,c.type.render,c.ref,sn);break;case 5:cf(c);default:Zg(p,c),c=Yt=Su(c,As),c=Df(p,c,As)}s.memoizedProps=s.pendingProps,c===null?$f(s):Yt=c}function kc(s,c,p,x){X=ll=null,cf(c),gi=null,mr=0;var S=c.return;try{if(Gg(s,S,c,p,sn)){ai=1,Wu(s,Ki(p,s.current)),Yt=null;return}}catch(D){if(S!==null)throw Yt=S,D;ai=1,Wu(s,Ki(p,s.current)),Yt=null;return}c.flags&32768?(Kt||x===1?s=!0:vc||(sn&536870912)!==0?s=!1:(gl=s=!0,(x===2||x===9||x===3||x===6)&&(x=Ar.current,x!==null&&x.tag===13&&(x.flags|=16384))),wy(c,s)):$f(c)}function $f(s){var c=s;do{if((c.flags&32768)!==0){wy(c,gl);return}s=c.return;var p=Kg(c.alternate,c,As);if(p!==null){Yt=p;return}if(c=c.sibling,c!==null){Yt=c;return}Yt=c=s}while(c!==null);ai===0&&(ai=5)}function wy(s,c){do{var p=Xg(s.alternate,s);if(p!==null){p.flags&=32767,Yt=p;return}if(p=s.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!c&&(s=s.sibling,s!==null)){Yt=s;return}Yt=s=p}while(s!==null);ai=6,Yt=null}function sd(s,c,p,x,S,D,H,Z,ye){s.cancelPendingCommit=null;do zf();while(Mi!==0);if((bn&6)!==0)throw Error(r(327));if(c!==null){if(c===s.current)throw Error(r(177));if(D=c.lanes|c.childLanes,D|=tp,mn(s,p,D,H,Z,ye),s===Mn&&(Yt=Mn=null,sn=0),Nc=c,bl=s,Cc=p,Yp=D,Wp=S,fy=x,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Ty(Xe,function(){return _y(),null})):(s.callbackNode=null,s.callbackPriority=0),x=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||x){x=K.T,K.T=null,S=U.p,U.p=2,H=bn,bn|=4;try{Wb(s,c,p)}finally{bn=H,U.p=S,K.T=x}}Mi=1,Sy(),Ny(),Cy()}}function Sy(){if(Mi===1){Mi=0;var s=bl,c=Nc,p=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||p){p=K.T,K.T=null;var x=U.p;U.p=2;var S=bn;bn|=4;try{$p(c,s);var D=Yf,H=gu(s.containerInfo),Z=D.focusedElem,ye=D.selectionRange;if(H!==Z&&Z&&Z.ownerDocument&&Jd(Z.ownerDocument.documentElement,Z)){if(ye!==null&&ec(Z)){var Ie=ye.start,Ue=ye.end;if(Ue===void 0&&(Ue=Ie),"selectionStart"in Z)Z.selectionStart=Ie,Z.selectionEnd=Math.min(Ue,Z.value.length);else{var Ge=Z.ownerDocument||document,Oe=Ge&&Ge.defaultView||window;if(Oe.getSelection){var Re=Oe.getSelection(),St=Z.textContent.length,vt=Math.min(ye.start,St),_n=ye.end===void 0?vt:Math.min(ye.end,St);!Re.extend&&vt>_n&&(H=_n,_n=vt,vt=H);var ke=mu(Z,vt),Ce=mu(Z,_n);if(ke&&Ce&&(Re.rangeCount!==1||Re.anchorNode!==ke.node||Re.anchorOffset!==ke.offset||Re.focusNode!==Ce.node||Re.focusOffset!==Ce.offset)){var Pe=Ge.createRange();Pe.setStart(ke.node,ke.offset),Re.removeAllRanges(),vt>_n?(Re.addRange(Pe),Re.extend(Ce.node,Ce.offset)):(Pe.setEnd(Ce.node,Ce.offset),Re.addRange(Pe))}}}}for(Ge=[],Re=Z;Re=Re.parentNode;)Re.nodeType===1&&Ge.push({element:Re,left:Re.scrollLeft,top:Re.scrollTop});for(typeof Z.focus=="function"&&Z.focus(),Z=0;Z<Ge.length;Z++){var Ve=Ge[Z];Ve.element.scrollLeft=Ve.left,Ve.element.scrollTop=Ve.top}}eh=!!ja,Yf=ja=null}finally{bn=S,U.p=x,K.T=p}}s.current=c,Mi=2}}function Ny(){if(Mi===2){Mi=0;var s=bl,c=Nc,p=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||p){p=K.T,K.T=null;var x=U.p;U.p=2;var S=bn;bn|=4;try{ny(s,c.alternate,c)}finally{bn=S,U.p=x,K.T=p}}Mi=3}}function Cy(){if(Mi===4||Mi===3){Mi=0,ve();var s=bl,c=Nc,p=Cc,x=fy;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Mi=5:(Mi=0,Nc=bl=null,jy(s,s.pendingLanes));var S=s.pendingLanes;if(S===0&&(xl=null),ar(p),c=c.stateNode,ie&&typeof ie.onCommitFiberRoot=="function")try{ie.onCommitFiberRoot(Q,c,void 0,(c.current.flags&128)===128)}catch{}if(x!==null){c=K.T,S=U.p,U.p=2,K.T=null;try{for(var D=s.onRecoverableError,H=0;H<x.length;H++){var Z=x[H];D(Z.value,{componentStack:Z.stack})}}finally{K.T=c,U.p=S}}(Cc&3)!==0&&zf(),Xa(s),S=s.pendingLanes,(p&4194090)!==0&&(S&42)!==0?s===Qp?jc++:(jc=0,Qp=s):jc=0,cd(0)}}function jy(s,c){(s.pooledCacheLanes&=c)===0&&(c=s.pooledCache,c!=null&&(s.pooledCache=null,Eu(c)))}function zf(s){return Sy(),Ny(),Cy(),_y()}function _y(){if(Mi!==5)return!1;var s=bl,c=Yp;Yp=0;var p=ar(Cc),x=K.T,S=U.p;try{U.p=32>p?32:p,K.T=null,p=Wp,Wp=null;var D=bl,H=Cc;if(Mi=0,Nc=bl=null,Cc=0,(bn&6)!==0)throw Error(r(331));var Z=bn;if(bn|=4,uy(D.current),ly(D,D.current,H,p),bn=Z,cd(0,!1),ie&&typeof ie.onPostCommitFiberRoot=="function")try{ie.onPostCommitFiberRoot(Q,D)}catch{}return!0}finally{U.p=S,K.T=x,jy(s,c)}}function ky(s,c,p){c=Ki(p,c),c=jf(s.stateNode,c,2),s=vs(s,c,2),s!==null&&(Cn(s,2),Xa(s))}function Dn(s,c,p){if(s.tag===3)ky(s,s,p);else for(;c!==null;){if(c.tag===3){ky(c,s,p);break}else if(c.tag===1){var x=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(xl===null||!xl.has(x))){s=Ki(p,s),p=Pp(2),x=vs(c,p,2),x!==null&&(Hg(p,x,c,s),Cn(x,2),Xa(x));break}}c=c.return}}function em(s,c,p){var x=s.pingCache;if(x===null){x=s.pingCache=new Up;var S=new Set;x.set(c,S)}else S=x.get(c),S===void 0&&(S=new Set,x.set(c,S));S.has(p)||(qp=!0,S.add(p),s=e0.bind(null,s,c,p),c.then(s,s))}function e0(s,c,p){var x=s.pingCache;x!==null&&x.delete(c),s.pingedLanes|=s.suspendedLanes&p,s.warmLanes&=~p,Mn===s&&(sn&p)===p&&(ai===4||ai===3&&(sn&62914560)===sn&&300>Ee()-Gp?(bn&2)===0&&_c(s,0):Vp|=p,wc===sn&&(wc=0)),Xa(s)}function Ey(s,c){c===0&&(c=Un()),s=Zl(s,c),s!==null&&(Cn(s,c),Xa(s))}function Bf(s){var c=s.memoizedState,p=0;c!==null&&(p=c.retryLane),Ey(s,p)}function t0(s,c){var p=0;switch(s.tag){case 13:var x=s.stateNode,S=s.memoizedState;S!==null&&(p=S.retryLane);break;case 19:x=s.stateNode;break;case 22:x=s.stateNode._retryCache;break;default:throw Error(r(314))}x!==null&&x.delete(c),Ey(s,p)}function Ty(s,c){return Le(s,c)}var ld=null,wl=null,Uf=!1,od=!1,qf=!1,Sl=0;function Xa(s){s!==wl&&s.next===null&&(wl===null?ld=wl=s:wl=wl.next=s),od=!0,Uf||(Uf=!0,tm())}function cd(s,c){if(!qf&&od){qf=!0;do for(var p=!1,x=ld;x!==null;){if(s!==0){var S=x.pendingLanes;if(S===0)var D=0;else{var H=x.suspendedLanes,Z=x.pingedLanes;D=(1<<31-Ae(42|s)+1)-1,D&=S&~(H&~Z),D=D&201326741?D&201326741|1:D?D|2:0}D!==0&&(p=!0,Dy(x,D))}else D=sn,D=Fe(x,x===Mn?D:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(D&3)===0||at(x,D)||(p=!0,Dy(x,D));x=x.next}while(p);qf=!1}}function n0(){ud()}function ud(){od=Uf=!1;var s=0;Sl!==0&&(c0()&&(s=Sl),Sl=0);for(var c=Ee(),p=null,x=ld;x!==null;){var S=x.next,D=dd(x,c);D===0?(x.next=null,p===null?ld=S:p.next=S,S===null&&(wl=p)):(p=x,(s!==0||(D&3)!==0)&&(od=!0)),x=S}cd(s)}function dd(s,c){for(var p=s.suspendedLanes,x=s.pingedLanes,S=s.expirationTimes,D=s.pendingLanes&-62914561;0<D;){var H=31-Ae(D),Z=1<<H,ye=S[H];ye===-1?((Z&p)===0||(Z&x)!==0)&&(S[H]=Qe(Z,c)):ye<=c&&(s.expiredLanes|=Z),D&=~Z}if(c=Mn,p=sn,p=Fe(s,s===c?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x=s.callbackNode,p===0||s===c&&(vn===2||vn===9)||s.cancelPendingCommit!==null)return x!==null&&x!==null&&xe(x),s.callbackNode=null,s.callbackPriority=0;if((p&3)===0||at(s,p)){if(c=p&-p,c===s.callbackPriority)return c;switch(x!==null&&xe(x),ar(p)){case 2:case 8:p=lt;break;case 32:p=Xe;break;case 268435456:p=_t;break;default:p=Xe}return x=Ay.bind(null,s),p=Le(p,x),s.callbackPriority=c,s.callbackNode=p,c}return x!==null&&x!==null&&xe(x),s.callbackPriority=2,s.callbackNode=null,2}function Ay(s,c){if(Mi!==0&&Mi!==5)return s.callbackNode=null,s.callbackPriority=0,null;var p=s.callbackNode;if(zf()&&s.callbackNode!==p)return null;var x=sn;return x=Fe(s,s===Mn?x:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x===0?null:(py(s,x,c),dd(s,Ee()),s.callbackNode!=null&&s.callbackNode===p?Ay.bind(null,s):null)}function Dy(s,c){if(zf())return null;py(s,c,!0)}function tm(){d0(function(){(bn&6)!==0?Le(nt,n0):ud()})}function Vf(){return Sl===0&&(Sl=yt()),Sl}function Py(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:ds(""+s)}function Iy(s,c){var p=c.ownerDocument.createElement("input");return p.name=c.name,p.value=c.value,s.id&&p.setAttribute("form",s.id),c.parentNode.insertBefore(p,c),s=new FormData(s),p.parentNode.removeChild(p),s}function i0(s,c,p,x,S){if(c==="submit"&&p&&p.stateNode===S){var D=Py((S[Fn]||null).action),H=x.submitter;H&&(c=(c=H[Fn]||null)?Py(c.formAction):H.getAttribute("formAction"),c!==null&&(D=c,H=null));var Z=new el("action","action",null,x,S);s.push({event:Z,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Sl!==0){var ye=H?Iy(S,H):new FormData(S);Bu(p,{pending:!0,data:ye,method:S.method,action:D},null,ye)}}else typeof D=="function"&&(Z.preventDefault(),ye=H?Iy(S,H):new FormData(S),Bu(p,{pending:!0,data:ye,method:S.method,action:D},D,ye))},currentTarget:S}]})}}for(var nm=0;nm<fn.length;nm++){var im=fn[nm],r0=im.toLowerCase(),a0=im[0].toUpperCase()+im.slice(1);xa(r0,"on"+a0)}xa(rl,"onAnimationEnd"),xa(yu,"onAnimationIteration"),xa(di,"onAnimationStart"),xa("dblclick","onDoubleClick"),xa("focusin","onFocus"),xa("focusout","onBlur"),xa(Xd,"onTransitionRun"),xa(Bb,"onTransitionStart"),xa(tc,"onTransitionCancel"),xa(xu,"onTransitionEnd"),Fa("onMouseEnter",["mouseout","mouseover"]),Fa("onMouseLeave",["mouseout","mouseover"]),Fa("onPointerEnter",["pointerout","pointerover"]),Fa("onPointerLeave",["pointerout","pointerover"]),os("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),os("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),os("onBeforeInput",["compositionend","keypress","textInput","paste"]),os("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),os("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),os("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),s0=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(fd));function My(s,c){c=(c&4)!==0;for(var p=0;p<s.length;p++){var x=s[p],S=x.event;x=x.listeners;e:{var D=void 0;if(c)for(var H=x.length-1;0<=H;H--){var Z=x[H],ye=Z.instance,Ie=Z.currentTarget;if(Z=Z.listener,ye!==D&&S.isPropagationStopped())break e;D=Z,S.currentTarget=Ie;try{D(S)}catch(Ue){yo(Ue)}S.currentTarget=null,D=ye}else for(H=0;H<x.length;H++){if(Z=x[H],ye=Z.instance,Ie=Z.currentTarget,Z=Z.listener,ye!==D&&S.isPropagationStopped())break e;D=Z,S.currentTarget=Ie;try{D(S)}catch(Ue){yo(Ue)}S.currentTarget=null,D=ye}}}}function Wt(s,c){var p=c[ss];p===void 0&&(p=c[ss]=new Set);var x=s+"__bubble";p.has(x)||(Ry(c,s,2,!1),p.add(x))}function rm(s,c,p){var x=0;c&&(x|=4),Ry(p,s,x,c)}var br="_reactListening"+Math.random().toString(36).slice(2);function am(s){if(!s[br]){s[br]=!0,Ud.forEach(function(p){p!=="selectionchange"&&(s0.has(p)||rm(p,!1,s),rm(p,!0,s))});var c=s.nodeType===9?s:s.ownerDocument;c===null||c[br]||(c[br]=!0,rm("selectionchange",!1,c))}}function Ry(s,c,p,x){switch(ex(c)){case 2:var S=C0;break;case 8:S=Mc;break;default:S=mm}p=S.bind(null,c,p,s),S=void 0,!Zs||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(S=!0),x?S!==void 0?s.addEventListener(c,p,{capture:!0,passive:S}):s.addEventListener(c,p,!0):S!==void 0?s.addEventListener(c,p,{passive:S}):s.addEventListener(c,p,!1)}function Ds(s,c,p,x,S){var D=x;if((c&1)===0&&(c&2)===0&&x!==null)e:for(;;){if(x===null)return;var H=x.tag;if(H===3||H===4){var Z=x.stateNode.containerInfo;if(Z===S)break;if(H===4)for(H=x.return;H!==null;){var ye=H.tag;if((ye===3||ye===4)&&H.stateNode.containerInfo===S)return;H=H.return}for(;Z!==null;){if(H=Us(Z),H===null)return;if(ye=H.tag,ye===5||ye===6||ye===26||ye===27){x=D=H;continue e}Z=Z.parentNode}}x=x.return}Xs(function(){var Ie=D,Ue=Vl(p),Ge=[];e:{var Oe=bu.get(s);if(Oe!==void 0){var Re=el,St=s;switch(s){case"keypress":if(gn(p)===0)break e;case"keydown":case"keyup":Re=ou;break;case"focusin":St="focus",Re=pa;break;case"focusout":St="blur",Re=pa;break;case"beforeblur":case"afterblur":Re=pa;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Re=Yi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Re=Gl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Re=Yh;break;case rl:case yu:case di:Re=Vo;break;case xu:Re=Wh;break;case"scroll":case"scrollend":Re=ru;break;case"wheel":Re=Qh;break;case"copy":case"cut":case"paste":Re=Gd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Re=ma;break;case"toggle":case"beforetoggle":Re=Yo}var vt=(c&4)!==0,_n=!vt&&(s==="scroll"||s==="scrollend"),ke=vt?Oe!==null?Oe+"Capture":null:Oe;vt=[];for(var Ce=Ie,Pe;Ce!==null;){var Ve=Ce;if(Pe=Ve.stateNode,Ve=Ve.tag,Ve!==5&&Ve!==26&&Ve!==27||Pe===null||ke===null||(Ve=Hl(Ce,ke),Ve!=null&&vt.push(At(Ce,Ve,Pe))),_n)break;Ce=Ce.return}0<vt.length&&(Oe=new Re(Oe,St,null,p,Ue),Ge.push({event:Oe,listeners:vt}))}}if((c&7)===0){e:{if(Oe=s==="mouseover"||s==="pointerover",Re=s==="mouseout"||s==="pointerout",Oe&&p!==Ks&&(St=p.relatedTarget||p.fromElement)&&(Us(St)||St[La]))break e;if((Re||Oe)&&(Oe=Ue.window===Ue?Ue:(Oe=Ue.ownerDocument)?Oe.defaultView||Oe.parentWindow:window,Re?(St=p.relatedTarget||p.toElement,Re=Ie,St=St?Us(St):null,St!==null&&(_n=l(St),vt=St.tag,St!==_n||vt!==5&&vt!==27&&vt!==6)&&(St=null)):(Re=null,St=Ie),Re!==St)){if(vt=Yi,Ve="onMouseLeave",ke="onMouseEnter",Ce="mouse",(s==="pointerout"||s==="pointerover")&&(vt=ma,Ve="onPointerLeave",ke="onPointerEnter",Ce="pointer"),_n=Re==null?Oe:Oa(Re),Pe=St==null?Oe:Oa(St),Oe=new vt(Ve,Ce+"leave",Re,p,Ue),Oe.target=_n,Oe.relatedTarget=Pe,Ve=null,Us(Ue)===Ie&&(vt=new vt(ke,Ce+"enter",St,p,Ue),vt.target=Pe,vt.relatedTarget=_n,Ve=vt),_n=Ve,Re&&St)t:{for(vt=Re,ke=St,Ce=0,Pe=vt;Pe;Pe=xi(Pe))Ce++;for(Pe=0,Ve=ke;Ve;Ve=xi(Ve))Pe++;for(;0<Ce-Pe;)vt=xi(vt),Ce--;for(;0<Pe-Ce;)ke=xi(ke),Pe--;for(;Ce--;){if(vt===ke||ke!==null&&vt===ke.alternate)break t;vt=xi(vt),ke=xi(ke)}vt=null}else vt=null;Re!==null&&si(Ge,Oe,Re,vt,!1),St!==null&&_n!==null&&si(Ge,_n,St,vt,!0)}}e:{if(Oe=Ie?Oa(Ie):window,Re=Oe.nodeName&&Oe.nodeName.toLowerCase(),Re==="select"||Re==="input"&&Oe.type==="file")var ft=Wd;else if(Jo(Oe))if(Ko)ft=Xh;else{ft=Va;var Ht=pu}else Re=Oe.nodeName,!Re||Re.toLowerCase()!=="input"||Oe.type!=="checkbox"&&Oe.type!=="radio"?Ie&&ql(Ie.elementType)&&(ft=Wd):ft=Zo;if(ft&&(ft=ft(s,Ie))){tl(Ge,ft,p,Ue);break e}Ht&&Ht(s,Oe,Ie),s==="focusout"&&Ie&&Oe.type==="number"&&Ie.memoizedProps.value!=null&&Qs(Oe,"number",Oe.value)}switch(Ht=Ie?Oa(Ie):window,s){case"focusin":(Jo(Ht)||Ht.contentEditable==="true")&&(he=Ht,be=Ie,W=null);break;case"focusout":W=be=he=null;break;case"mousedown":ue=!0;break;case"contextmenu":case"mouseup":case"dragend":ue=!1,ge(Ge,p,Ue);break;case"selectionchange":if(Kd)break;case"keydown":case"keyup":ge(Ge,p,Ue)}var mt;if(zr)e:{switch(s){case"compositionstart":var Nt="onCompositionStart";break e;case"compositionend":Nt="onCompositionEnd";break e;case"compositionupdate":Nt="onCompositionUpdate";break e}Nt=void 0}else ga?Qo(s,p)&&(Nt="onCompositionEnd"):s==="keydown"&&p.keyCode===229&&(Nt="onCompositionStart");Nt&&(Ql&&p.locale!=="ko"&&(ga||Nt!=="onCompositionStart"?Nt==="onCompositionEnd"&&ga&&(mt=Hd()):(Fr=Ue,Uo="value"in Fr?Fr.value:Fr.textContent,ga=!0)),Ht=Hf(Ie,Nt),0<Ht.length&&(Nt=new ui(Nt,s,null,p,Ue),Ge.push({event:Nt,listeners:Ht}),mt?Nt.data=mt:(mt=Kl(p),mt!==null&&(Nt.data=mt)))),(mt=du?Jh(s,p):fu(s,p))&&(Nt=Hf(Ie,"onBeforeInput"),0<Nt.length&&(Ht=new ui("onBeforeInput","beforeinput",null,p,Ue),Ge.push({event:Ht,listeners:Nt}),Ht.data=mt)),i0(Ge,s,Ie,p,Ue)}My(Ge,c)})}function At(s,c,p){return{instance:s,listener:c,currentTarget:p}}function Hf(s,c){for(var p=c+"Capture",x=[];s!==null;){var S=s,D=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||D===null||(S=Hl(s,p),S!=null&&x.unshift(At(s,S,D)),S=Hl(s,c),S!=null&&x.push(At(s,S,D))),s.tag===3)return x;s=s.return}return[]}function xi(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function si(s,c,p,x,S){for(var D=c._reactName,H=[];p!==null&&p!==x;){var Z=p,ye=Z.alternate,Ie=Z.stateNode;if(Z=Z.tag,ye!==null&&ye===x)break;Z!==5&&Z!==26&&Z!==27||Ie===null||(ye=Ie,S?(Ie=Hl(p,D),Ie!=null&&H.unshift(At(p,Ie,ye))):S||(Ie=Hl(p,D),Ie!=null&&H.push(At(p,Ie,ye)))),p=p.return}H.length!==0&&s.push({event:c,listeners:H})}var l0=/\r\n?/g,Nl=/\u0000|\uFFFD/g;function Ly(s){return(typeof s=="string"?s:""+s).replace(l0,`
`).replace(Nl,"")}function Oy(s,c){return c=Ly(c),Ly(s)===c}function Gf(){}function jn(s,c,p,x,S,D){switch(p){case"children":typeof x=="string"?c==="body"||c==="textarea"&&x===""||da(s,x):(typeof x=="number"||typeof x=="bigint")&&c!=="body"&&da(s,""+x);break;case"className":Gs(s,"class",x);break;case"tabIndex":Gs(s,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":Gs(s,p,x);break;case"style":Ul(s,x,D);break;case"data":if(c!=="object"){Gs(s,"data",x);break}case"src":case"href":if(x===""&&(c!=="a"||p!=="href")){s.removeAttribute(p);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(p);break}x=ds(""+x),s.setAttribute(p,x);break;case"action":case"formAction":if(typeof x=="function"){s.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof D=="function"&&(p==="formAction"?(c!=="input"&&jn(s,c,"name",S.name,S,null),jn(s,c,"formEncType",S.formEncType,S,null),jn(s,c,"formMethod",S.formMethod,S,null),jn(s,c,"formTarget",S.formTarget,S,null)):(jn(s,c,"encType",S.encType,S,null),jn(s,c,"method",S.method,S,null),jn(s,c,"target",S.target,S,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(p);break}x=ds(""+x),s.setAttribute(p,x);break;case"onClick":x!=null&&(s.onclick=Gf);break;case"onScroll":x!=null&&Wt("scroll",s);break;case"onScrollEnd":x!=null&&Wt("scrollend",s);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(p=x.__html,p!=null){if(S.children!=null)throw Error(r(60));s.innerHTML=p}}break;case"multiple":s.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":s.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){s.removeAttribute("xlink:href");break}p=ds(""+x),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,""+x):s.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,""):s.removeAttribute(p);break;case"capture":case"download":x===!0?s.setAttribute(p,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,x):s.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?s.setAttribute(p,x):s.removeAttribute(p);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?s.removeAttribute(p):s.setAttribute(p,x);break;case"popover":Wt("beforetoggle",s),Wt("toggle",s),Fl(s,"popover",x);break;case"xlinkActuate":sr(s,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":sr(s,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":sr(s,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":sr(s,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":sr(s,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":sr(s,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":sr(s,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":sr(s,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":sr(s,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":Fl(s,"is",x);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=$o.get(p)||p,Fl(s,p,x))}}function sm(s,c,p,x,S,D){switch(p){case"style":Ul(s,x,D);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(p=x.__html,p!=null){if(S.children!=null)throw Error(r(60));s.innerHTML=p}}break;case"children":typeof x=="string"?da(s,x):(typeof x=="number"||typeof x=="bigint")&&da(s,""+x);break;case"onScroll":x!=null&&Wt("scroll",s);break;case"onScrollEnd":x!=null&&Wt("scrollend",s);break;case"onClick":x!=null&&(s.onclick=Gf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ro.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(S=p.endsWith("Capture"),c=p.slice(2,S?p.length-7:void 0),D=s[Fn]||null,D=D!=null?D[p]:null,typeof D=="function"&&s.removeEventListener(c,D,S),typeof x=="function")){typeof D!="function"&&D!==null&&(p in s?s[p]=null:s.hasAttribute(p)&&s.removeAttribute(p)),s.addEventListener(c,x,S);break e}p in s?s[p]=x:x===!0?s.setAttribute(p,""):Fl(s,p,x)}}}function bi(s,c,p){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Wt("error",s),Wt("load",s);var x=!1,S=!1,D;for(D in p)if(p.hasOwnProperty(D)){var H=p[D];if(H!=null)switch(D){case"src":x=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:jn(s,c,D,H,p,null)}}S&&jn(s,c,"srcSet",p.srcSet,p,null),x&&jn(s,c,"src",p.src,p,null);return;case"input":Wt("invalid",s);var Z=D=H=S=null,ye=null,Ie=null;for(x in p)if(p.hasOwnProperty(x)){var Ue=p[x];if(Ue!=null)switch(x){case"name":S=Ue;break;case"type":H=Ue;break;case"checked":ye=Ue;break;case"defaultChecked":Ie=Ue;break;case"value":D=Ue;break;case"defaultValue":Z=Ue;break;case"children":case"dangerouslySetInnerHTML":if(Ue!=null)throw Error(r(137,c));break;default:jn(s,c,x,Ue,p,null)}}Ws(s,D,Z,ye,Ie,H,S,!1),cs(s);return;case"select":Wt("invalid",s),x=H=D=null;for(S in p)if(p.hasOwnProperty(S)&&(Z=p[S],Z!=null))switch(S){case"value":D=Z;break;case"defaultValue":H=Z;break;case"multiple":x=Z;default:jn(s,c,S,Z,p,null)}c=D,p=H,s.multiple=!!x,c!=null?ua(s,!!x,c,!1):p!=null&&ua(s,!!x,p,!0);return;case"textarea":Wt("invalid",s),D=S=x=null;for(H in p)if(p.hasOwnProperty(H)&&(Z=p[H],Z!=null))switch(H){case"value":x=Z;break;case"defaultValue":S=Z;break;case"children":D=Z;break;case"dangerouslySetInnerHTML":if(Z!=null)throw Error(r(91));break;default:jn(s,c,H,Z,p,null)}us(s,x,S,D),cs(s);return;case"option":for(ye in p)if(p.hasOwnProperty(ye)&&(x=p[ye],x!=null))switch(ye){case"selected":s.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:jn(s,c,ye,x,p,null)}return;case"dialog":Wt("beforetoggle",s),Wt("toggle",s),Wt("cancel",s),Wt("close",s);break;case"iframe":case"object":Wt("load",s);break;case"video":case"audio":for(x=0;x<fd.length;x++)Wt(fd[x],s);break;case"image":Wt("error",s),Wt("load",s);break;case"details":Wt("toggle",s);break;case"embed":case"source":case"link":Wt("error",s),Wt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ie in p)if(p.hasOwnProperty(Ie)&&(x=p[Ie],x!=null))switch(Ie){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:jn(s,c,Ie,x,p,null)}return;default:if(ql(c)){for(Ue in p)p.hasOwnProperty(Ue)&&(x=p[Ue],x!==void 0&&sm(s,c,Ue,x,p,void 0));return}}for(Z in p)p.hasOwnProperty(Z)&&(x=p[Z],x!=null&&jn(s,c,Z,x,p,null))}function o0(s,c,p,x){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,D=null,H=null,Z=null,ye=null,Ie=null,Ue=null;for(Re in p){var Ge=p[Re];if(p.hasOwnProperty(Re)&&Ge!=null)switch(Re){case"checked":break;case"value":break;case"defaultValue":ye=Ge;default:x.hasOwnProperty(Re)||jn(s,c,Re,null,x,Ge)}}for(var Oe in x){var Re=x[Oe];if(Ge=p[Oe],x.hasOwnProperty(Oe)&&(Re!=null||Ge!=null))switch(Oe){case"type":D=Re;break;case"name":S=Re;break;case"checked":Ie=Re;break;case"defaultChecked":Ue=Re;break;case"value":H=Re;break;case"defaultValue":Z=Re;break;case"children":case"dangerouslySetInnerHTML":if(Re!=null)throw Error(r(137,c));break;default:Re!==Ge&&jn(s,c,Oe,Re,x,Ge)}}zl(s,H,Z,ye,Ie,Ue,D,S);return;case"select":Re=H=Z=Oe=null;for(D in p)if(ye=p[D],p.hasOwnProperty(D)&&ye!=null)switch(D){case"value":break;case"multiple":Re=ye;default:x.hasOwnProperty(D)||jn(s,c,D,null,x,ye)}for(S in x)if(D=x[S],ye=p[S],x.hasOwnProperty(S)&&(D!=null||ye!=null))switch(S){case"value":Oe=D;break;case"defaultValue":Z=D;break;case"multiple":H=D;default:D!==ye&&jn(s,c,S,D,x,ye)}c=Z,p=H,x=Re,Oe!=null?ua(s,!!p,Oe,!1):!!x!=!!p&&(c!=null?ua(s,!!p,c,!0):ua(s,!!p,p?[]:"",!1));return;case"textarea":Re=Oe=null;for(Z in p)if(S=p[Z],p.hasOwnProperty(Z)&&S!=null&&!x.hasOwnProperty(Z))switch(Z){case"value":break;case"children":break;default:jn(s,c,Z,null,x,S)}for(H in x)if(S=x[H],D=p[H],x.hasOwnProperty(H)&&(S!=null||D!=null))switch(H){case"value":Oe=S;break;case"defaultValue":Re=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(r(91));break;default:S!==D&&jn(s,c,H,S,x,D)}Js(s,Oe,Re);return;case"option":for(var St in p)if(Oe=p[St],p.hasOwnProperty(St)&&Oe!=null&&!x.hasOwnProperty(St))switch(St){case"selected":s.selected=!1;break;default:jn(s,c,St,null,x,Oe)}for(ye in x)if(Oe=x[ye],Re=p[ye],x.hasOwnProperty(ye)&&Oe!==Re&&(Oe!=null||Re!=null))switch(ye){case"selected":s.selected=Oe&&typeof Oe!="function"&&typeof Oe!="symbol";break;default:jn(s,c,ye,Oe,x,Re)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var vt in p)Oe=p[vt],p.hasOwnProperty(vt)&&Oe!=null&&!x.hasOwnProperty(vt)&&jn(s,c,vt,null,x,Oe);for(Ie in x)if(Oe=x[Ie],Re=p[Ie],x.hasOwnProperty(Ie)&&Oe!==Re&&(Oe!=null||Re!=null))switch(Ie){case"children":case"dangerouslySetInnerHTML":if(Oe!=null)throw Error(r(137,c));break;default:jn(s,c,Ie,Oe,x,Re)}return;default:if(ql(c)){for(var _n in p)Oe=p[_n],p.hasOwnProperty(_n)&&Oe!==void 0&&!x.hasOwnProperty(_n)&&sm(s,c,_n,void 0,x,Oe);for(Ue in x)Oe=x[Ue],Re=p[Ue],!x.hasOwnProperty(Ue)||Oe===Re||Oe===void 0&&Re===void 0||sm(s,c,Ue,Oe,x,Re);return}}for(var ke in p)Oe=p[ke],p.hasOwnProperty(ke)&&Oe!=null&&!x.hasOwnProperty(ke)&&jn(s,c,ke,null,x,Oe);for(Ge in x)Oe=x[Ge],Re=p[Ge],!x.hasOwnProperty(Ge)||Oe===Re||Oe==null&&Re==null||jn(s,c,Ge,Oe,x,Re)}var ja=null,Yf=null;function wo(s){return s.nodeType===9?s:s.ownerDocument}function Gn(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Zn(s,c){if(s===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&c==="foreignObject"?0:s}function Wf(s,c){return s==="textarea"||s==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var lm=null;function c0(){var s=window.event;return s&&s.type==="popstate"?s===lm?!1:(lm=s,!0):(lm=null,!1)}var Fy=typeof setTimeout=="function"?setTimeout:void 0,u0=typeof clearTimeout=="function"?clearTimeout:void 0,$y=typeof Promise=="function"?Promise:void 0,d0=typeof queueMicrotask=="function"?queueMicrotask:typeof $y<"u"?function(s){return $y.resolve(null).then(s).catch(zy)}:Fy;function zy(s){setTimeout(function(){throw s})}function Xr(s){return s==="head"}function Qf(s,c){var p=c,x=0,S=0;do{var D=p.nextSibling;if(s.removeChild(p),D&&D.nodeType===8)if(p=D.data,p==="/$"){if(0<x&&8>x){p=x;var H=s.ownerDocument;if(p&1&&hd(H.documentElement),p&2&&hd(H.body),p&4)for(p=H.head,hd(p),H=p.firstChild;H;){var Z=H.nextSibling,ye=H.nodeName;H[ls]||ye==="SCRIPT"||ye==="STYLE"||ye==="LINK"&&H.rel.toLowerCase()==="stylesheet"||p.removeChild(H),H=Z}}if(S===0){s.removeChild(D),wd(c);return}S--}else p==="$"||p==="$?"||p==="$!"?S++:x=p.charCodeAt(0)-48;else x=0;p=D}while(p);wd(c)}function om(s){var c=s.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var p=c;switch(c=c.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":om(p),Zc(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}s.removeChild(p)}}function By(s,c,p,x){for(;s.nodeType===1;){var S=p;if(s.nodeName.toLowerCase()!==c.toLowerCase()){if(!x&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(x){if(!s[ls])switch(c){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(D=s.getAttribute("rel"),D==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(D!==S.rel||s.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||s.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||s.getAttribute("title")!==(S.title==null?null:S.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(D=s.getAttribute("src"),(D!==(S.src==null?null:S.src)||s.getAttribute("type")!==(S.type==null?null:S.type)||s.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&D&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(c==="input"&&s.type==="hidden"){var D=S.name==null?null:""+S.name;if(S.type==="hidden"&&s.getAttribute("name")===D)return s}else return s;if(s=_a(s.nextSibling),s===null)break}return null}function Jf(s,c,p){if(c==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!p||(s=_a(s.nextSibling),s===null))return null;return s}function nr(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function Ec(s,c){var p=s.ownerDocument;if(s.data!=="$?"||p.readyState==="complete")c();else{var x=function(){c(),p.removeEventListener("DOMContentLoaded",x)};p.addEventListener("DOMContentLoaded",x),s._reactRetry=x}}function _a(s){for(;s!=null;s=s.nextSibling){var c=s.nodeType;if(c===1||c===3)break;if(c===8){if(c=s.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return s}var cm=null;function Uy(s){s=s.previousSibling;for(var c=0;s;){if(s.nodeType===8){var p=s.data;if(p==="$"||p==="$!"||p==="$?"){if(c===0)return s;c--}else p==="/$"&&c++}s=s.previousSibling}return null}function qy(s,c,p){switch(c=wo(p),s){case"html":if(s=c.documentElement,!s)throw Error(r(452));return s;case"head":if(s=c.head,!s)throw Error(r(453));return s;case"body":if(s=c.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function hd(s){for(var c=s.attributes;c.length;)s.removeAttributeNode(c[0]);Zc(s)}var Mr=new Map,Za=new Set;function Rt(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var es=U.d;U.d={f:Zr,r:Vy,D:f0,C:Hy,L:Kf,m:h0,X:m0,S:p0,M:g0};function Zr(){var s=es.f(),c=Ff();return s||c}function Vy(s){var c=qs(s);c!==null&&c.tag===5&&c.type==="form"?wf(c):es.r(s)}var Tc=typeof document>"u"?null:document;function hn(s,c,p){var x=Tc;if(x&&typeof c=="string"&&c){var S=Di(c);S='link[rel="'+s+'"][href="'+S+'"]',typeof p=="string"&&(S+='[crossorigin="'+p+'"]'),Za.has(S)||(Za.add(S),s={rel:s,crossOrigin:p,href:c},x.querySelector(S)===null&&(c=x.createElement("link"),bi(c,"link",s),ci(c),x.head.appendChild(c)))}}function f0(s){es.D(s),hn("dns-prefetch",s,null)}function Hy(s,c){es.C(s,c),hn("preconnect",s,c)}function Kf(s,c,p){es.L(s,c,p);var x=Tc;if(x&&s&&c){var S='link[rel="preload"][as="'+Di(c)+'"]';c==="image"&&p&&p.imageSrcSet?(S+='[imagesrcset="'+Di(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(S+='[imagesizes="'+Di(p.imageSizes)+'"]')):S+='[href="'+Di(s)+'"]';var D=S;switch(c){case"style":D=Ac(s);break;case"script":D=Dc(s)}Mr.has(D)||(s=h({rel:"preload",href:c==="image"&&p&&p.imageSrcSet?void 0:s,as:c},p),Mr.set(D,s),x.querySelector(S)!==null||c==="style"&&x.querySelector(pd(D))||c==="script"&&x.querySelector(md(D))||(c=x.createElement("link"),bi(c,"link",s),ci(c),x.head.appendChild(c)))}}function h0(s,c){es.m(s,c);var p=Tc;if(p&&s){var x=c&&typeof c.as=="string"?c.as:"script",S='link[rel="modulepreload"][as="'+Di(x)+'"][href="'+Di(s)+'"]',D=S;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":D=Dc(s)}if(!Mr.has(D)&&(s=h({rel:"modulepreload",href:s},c),Mr.set(D,s),p.querySelector(S)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(md(D)))return}x=p.createElement("link"),bi(x,"link",s),ci(x),p.head.appendChild(x)}}}function p0(s,c,p){es.S(s,c,p);var x=Tc;if(x&&s){var S=Vs(x).hoistableStyles,D=Ac(s);c=c||"default";var H=S.get(D);if(!H){var Z={loading:0,preload:null};if(H=x.querySelector(pd(D)))Z.loading=5;else{s=h({rel:"stylesheet",href:s,"data-precedence":c},p),(p=Mr.get(D))&&gd(s,p);var ye=H=x.createElement("link");ci(ye),bi(ye,"link",s),ye._p=new Promise(function(Ie,Ue){ye.onload=Ie,ye.onerror=Ue}),ye.addEventListener("load",function(){Z.loading|=1}),ye.addEventListener("error",function(){Z.loading|=2}),Z.loading|=4,Xf(H,c,x)}H={type:"stylesheet",instance:H,count:1,state:Z},S.set(D,H)}}}function m0(s,c){es.X(s,c);var p=Tc;if(p&&s){var x=Vs(p).hoistableScripts,S=Dc(s),D=x.get(S);D||(D=p.querySelector(md(S)),D||(s=h({src:s,async:!0},c),(c=Mr.get(S))&&um(s,c),D=p.createElement("script"),ci(D),bi(D,"link",s),p.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},x.set(S,D))}}function g0(s,c){es.M(s,c);var p=Tc;if(p&&s){var x=Vs(p).hoistableScripts,S=Dc(s),D=x.get(S);D||(D=p.querySelector(md(S)),D||(s=h({src:s,async:!0,type:"module"},c),(c=Mr.get(S))&&um(s,c),D=p.createElement("script"),ci(D),bi(D,"link",s),p.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},x.set(S,D))}}function Gy(s,c,p,x){var S=(S=fe.current)?Rt(S):null;if(!S)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(c=Ac(p.href),p=Vs(S).hoistableStyles,x=p.get(c),x||(x={type:"style",instance:null,count:0,state:null},p.set(c,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){s=Ac(p.href);var D=Vs(S).hoistableStyles,H=D.get(s);if(H||(S=S.ownerDocument||S,H={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},D.set(s,H),(D=S.querySelector(pd(s)))&&!D._p&&(H.instance=D,H.state.loading=5),Mr.has(s)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},Mr.set(s,p),D||y0(S,s,p,H.state))),c&&x===null)throw Error(r(528,""));return H}if(c&&x!==null)throw Error(r(529,""));return null;case"script":return c=p.async,p=p.src,typeof p=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Dc(p),p=Vs(S).hoistableScripts,x=p.get(c),x||(x={type:"script",instance:null,count:0,state:null},p.set(c,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Ac(s){return'href="'+Di(s)+'"'}function pd(s){return'link[rel="stylesheet"]['+s+"]"}function Yy(s){return h({},s,{"data-precedence":s.precedence,precedence:null})}function y0(s,c,p,x){s.querySelector('link[rel="preload"][as="style"]['+c+"]")?x.loading=1:(c=s.createElement("link"),x.preload=c,c.addEventListener("load",function(){return x.loading|=1}),c.addEventListener("error",function(){return x.loading|=2}),bi(c,"link",p),ci(c),s.head.appendChild(c))}function Dc(s){return'[src="'+Di(s)+'"]'}function md(s){return"script[async]"+s}function Wy(s,c,p){if(c.count++,c.instance===null)switch(c.type){case"style":var x=s.querySelector('style[data-href~="'+Di(p.href)+'"]');if(x)return c.instance=x,ci(x),x;var S=h({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return x=(s.ownerDocument||s).createElement("style"),ci(x),bi(x,"style",S),Xf(x,p.precedence,s),c.instance=x;case"stylesheet":S=Ac(p.href);var D=s.querySelector(pd(S));if(D)return c.state.loading|=4,c.instance=D,ci(D),D;x=Yy(p),(S=Mr.get(S))&&gd(x,S),D=(s.ownerDocument||s).createElement("link"),ci(D);var H=D;return H._p=new Promise(function(Z,ye){H.onload=Z,H.onerror=ye}),bi(D,"link",x),c.state.loading|=4,Xf(D,p.precedence,s),c.instance=D;case"script":return D=Dc(p.src),(S=s.querySelector(md(D)))?(c.instance=S,ci(S),S):(x=p,(S=Mr.get(D))&&(x=h({},p),um(x,S)),s=s.ownerDocument||s,S=s.createElement("script"),ci(S),bi(S,"link",x),s.head.appendChild(S),c.instance=S);case"void":return null;default:throw Error(r(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(x=c.instance,c.state.loading|=4,Xf(x,p.precedence,s));return c.instance}function Xf(s,c,p){for(var x=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=x.length?x[x.length-1]:null,D=S,H=0;H<x.length;H++){var Z=x[H];if(Z.dataset.precedence===c)D=Z;else if(D!==S)break}D?D.parentNode.insertBefore(s,D.nextSibling):(c=p.nodeType===9?p.head:p,c.insertBefore(s,c.firstChild))}function gd(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.title==null&&(s.title=c.title)}function um(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.integrity==null&&(s.integrity=c.integrity)}var Pc=null;function Qy(s,c,p){if(Pc===null){var x=new Map,S=Pc=new Map;S.set(p,x)}else S=Pc,x=S.get(p),x||(x=new Map,S.set(p,x));if(x.has(s))return x;for(x.set(s,null),p=p.getElementsByTagName(s),S=0;S<p.length;S++){var D=p[S];if(!(D[ls]||D[Kn]||s==="link"&&D.getAttribute("rel")==="stylesheet")&&D.namespaceURI!=="http://www.w3.org/2000/svg"){var H=D.getAttribute(c)||"";H=s+H;var Z=x.get(H);Z?Z.push(D):x.set(H,[D])}}return x}function Jy(s,c,p){s=s.ownerDocument||s,s.head.insertBefore(p,c==="title"?s.querySelector("head > title"):null)}function x0(s,c,p){if(p===1||c.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return s=c.disabled,typeof c.precedence=="string"&&s==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function vi(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var _i=null;function b0(){}function v0(s,c,p){if(_i===null)throw Error(r(475));var x=_i;if(c.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var S=Ac(p.href),D=s.querySelector(pd(S));if(D){s=D._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(x.count++,x=yd.bind(x),s.then(x,x)),c.state.loading|=4,c.instance=D,ci(D);return}D=s.ownerDocument||s,p=Yy(p),(S=Mr.get(S))&&gd(p,S),D=D.createElement("link"),ci(D);var H=D;H._p=new Promise(function(Z,ye){H.onload=Z,H.onerror=ye}),bi(D,"link",p),c.instance=D}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(x.count++,c=yd.bind(x),s.addEventListener("load",c),s.addEventListener("error",c))}}function w0(){if(_i===null)throw Error(r(475));var s=_i;return s.stylesheets&&s.count===0&&dm(s,s.stylesheets),0<s.count?function(c){var p=setTimeout(function(){if(s.stylesheets&&dm(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(p)}}:null}function yd(){if(this.count--,this.count===0){if(this.stylesheets)dm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Zf=null;function dm(s,c){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Zf=new Map,c.forEach(S0,s),Zf=null,yd.call(s))}function S0(s,c){if(!(c.state.loading&4)){var p=Zf.get(s);if(p)var x=p.get(null);else{p=new Map,Zf.set(s,p);for(var S=s.querySelectorAll("link[data-precedence],style[data-precedence]"),D=0;D<S.length;D++){var H=S[D];(H.nodeName==="LINK"||H.getAttribute("media")!=="not all")&&(p.set(H.dataset.precedence,H),x=H)}x&&p.set(null,x)}S=c.instance,H=S.getAttribute("data-precedence"),D=p.get(H)||x,D===x&&p.set(null,S),p.set(H,S),this.count++,x=yd.bind(this),S.addEventListener("load",x),S.addEventListener("error",x),D?D.parentNode.insertBefore(S,D.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(S,s.firstChild)),c.state.loading|=4}}var Ic={$$typeof:P,Provider:null,Consumer:null,_currentValue:J,_currentValue2:J,_threadCount:0};function N0(s,c,p,x,S,D,H,Z){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=On(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=On(0),this.hiddenUpdates=On(null),this.identifierPrefix=x,this.onUncaughtError=S,this.onCaughtError=D,this.onRecoverableError=H,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Z,this.incompleteTransitions=new Map}function Ky(s,c,p,x,S,D,H,Z,ye,Ie,Ue,Ge){return s=new N0(s,c,p,H,Z,ye,Ie,Ge),c=1,D===!0&&(c|=24),D=cr(3,null,null,c),s.current=D,D.stateNode=s,c=ap(),c.refCount++,s.pooledCache=c,c.refCount++,D.memoizedState={element:x,isDehydrated:p,cache:c},lo(D),s}function Xy(s){return s?(s=eo,s):eo}function fm(s,c,p,x,S,D){S=Xy(S),x.context===null?x.context=S:x.pendingContext=S,x=ol(c),x.payload={element:p},D=D===void 0?null:D,D!==null&&(x.callback=D),p=vs(s,x,c),p!==null&&(Ir(p,s,c),Au(p,s,c))}function hm(s,c){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var p=s.retryLane;s.retryLane=p!==0&&p<c?p:c}}function pm(s,c){hm(s,c),(s=s.alternate)&&hm(s,c)}function Zy(s){if(s.tag===13){var c=Zl(s,67108864);c!==null&&Ir(c,s,67108864),pm(s,67108864)}}var eh=!0;function C0(s,c,p,x){var S=K.T;K.T=null;var D=U.p;try{U.p=2,mm(s,c,p,x)}finally{U.p=D,K.T=S}}function Mc(s,c,p,x){var S=K.T;K.T=null;var D=U.p;try{U.p=8,mm(s,c,p,x)}finally{U.p=D,K.T=S}}function mm(s,c,p,x){if(eh){var S=gm(x);if(S===null)Ds(s,c,x,th,p),tx(s,x);else if(_0(S,s,c,p,x))x.stopPropagation();else if(tx(s,x),c&4&&-1<j0.indexOf(s)){for(;S!==null;){var D=qs(S);if(D!==null)switch(D.tag){case 3:if(D=D.stateNode,D.current.memoizedState.isDehydrated){var H=Ke(D.pendingLanes);if(H!==0){var Z=D;for(Z.pendingLanes|=2,Z.entangledLanes|=2;H;){var ye=1<<31-Ae(H);Z.entanglements[1]|=ye,H&=~ye}Xa(D),(bn&6)===0&&(Sc=Ee()+500,cd(0))}}break;case 13:Z=Zl(D,2),Z!==null&&Ir(Z,D,2),Ff(),pm(D,2)}if(D=gm(x),D===null&&Ds(s,c,x,th,p),D===S)break;S=D}S!==null&&x.stopPropagation()}else Ds(s,c,x,null,p)}}function gm(s){return s=Vl(s),ym(s)}var th=null;function ym(s){if(th=null,s=Us(s),s!==null){var c=l(s);if(c===null)s=null;else{var p=c.tag;if(p===13){if(s=o(c),s!==null)return s;s=null}else if(p===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;s=null}else c!==s&&(s=null)}}return th=s,null}function ex(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(De()){case nt:return 2;case lt:return 8;case Xe:case Mt:return 32;case _t:return 268435456;default:return 32}default:return 32}}var nh=!1,Ps=null,Cl=null,jl=null,xd=new Map,bd=new Map,_l=[],j0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function tx(s,c){switch(s){case"focusin":case"focusout":Ps=null;break;case"dragenter":case"dragleave":Cl=null;break;case"mouseover":case"mouseout":jl=null;break;case"pointerover":case"pointerout":xd.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":bd.delete(c.pointerId)}}function vd(s,c,p,x,S,D){return s===null||s.nativeEvent!==D?(s={blockedOn:c,domEventName:p,eventSystemFlags:x,nativeEvent:D,targetContainers:[S]},c!==null&&(c=qs(c),c!==null&&Zy(c)),s):(s.eventSystemFlags|=x,c=s.targetContainers,S!==null&&c.indexOf(S)===-1&&c.push(S),s)}function _0(s,c,p,x,S){switch(c){case"focusin":return Ps=vd(Ps,s,c,p,x,S),!0;case"dragenter":return Cl=vd(Cl,s,c,p,x,S),!0;case"mouseover":return jl=vd(jl,s,c,p,x,S),!0;case"pointerover":var D=S.pointerId;return xd.set(D,vd(xd.get(D)||null,s,c,p,x,S)),!0;case"gotpointercapture":return D=S.pointerId,bd.set(D,vd(bd.get(D)||null,s,c,p,x,S)),!0}return!1}function nx(s){var c=Us(s.target);if(c!==null){var p=l(c);if(p!==null){if(c=p.tag,c===13){if(c=o(p),c!==null){s.blockedOn=c,kr(s.priority,function(){if(p.tag===13){var x=Vi();x=Hi(x);var S=Zl(p,x);S!==null&&Ir(S,p,x),pm(p,x)}});return}}else if(c===3&&p.stateNode.current.memoizedState.isDehydrated){s.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ih(s){if(s.blockedOn!==null)return!1;for(var c=s.targetContainers;0<c.length;){var p=gm(s.nativeEvent);if(p===null){p=s.nativeEvent;var x=new p.constructor(p.type,p);Ks=x,p.target.dispatchEvent(x),Ks=null}else return c=qs(p),c!==null&&Zy(c),s.blockedOn=p,!1;c.shift()}return!0}function ix(s,c,p){ih(s)&&p.delete(c)}function k0(){nh=!1,Ps!==null&&ih(Ps)&&(Ps=null),Cl!==null&&ih(Cl)&&(Cl=null),jl!==null&&ih(jl)&&(jl=null),xd.forEach(ix),bd.forEach(ix)}function rh(s,c){s.blockedOn===c&&(s.blockedOn=null,nh||(nh=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,k0)))}var ah=null;function rx(s){ah!==s&&(ah=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){ah===s&&(ah=null);for(var c=0;c<s.length;c+=3){var p=s[c],x=s[c+1],S=s[c+2];if(typeof x!="function"){if(ym(x||p)===null)continue;break}var D=qs(p);D!==null&&(s.splice(c,3),c-=3,Bu(D,{pending:!0,data:S,method:p.method,action:x},x,S))}}))}function wd(s){function c(ye){return rh(ye,s)}Ps!==null&&rh(Ps,s),Cl!==null&&rh(Cl,s),jl!==null&&rh(jl,s),xd.forEach(c),bd.forEach(c);for(var p=0;p<_l.length;p++){var x=_l[p];x.blockedOn===s&&(x.blockedOn=null)}for(;0<_l.length&&(p=_l[0],p.blockedOn===null);)nx(p),p.blockedOn===null&&_l.shift();if(p=(s.ownerDocument||s).$$reactFormReplay,p!=null)for(x=0;x<p.length;x+=3){var S=p[x],D=p[x+1],H=S[Fn]||null;if(typeof D=="function")H||rx(p);else if(H){var Z=null;if(D&&D.hasAttribute("formAction")){if(S=D,H=D[Fn]||null)Z=H.formAction;else if(ym(S)!==null)continue}else Z=H.action;typeof Z=="function"?p[x+1]=Z:(p.splice(x,3),x-=3),rx(p)}}}function xm(s){this._internalRoot=s}sh.prototype.render=xm.prototype.render=function(s){var c=this._internalRoot;if(c===null)throw Error(r(409));var p=c.current,x=Vi();fm(p,x,s,c,null,null)},sh.prototype.unmount=xm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var c=s.containerInfo;fm(s.current,2,null,s,null,null),Ff(),c[La]=null}};function sh(s){this._internalRoot=s}sh.prototype.unstable_scheduleHydration=function(s){if(s){var c=oa();s={blockedOn:null,target:s,priority:c};for(var p=0;p<_l.length&&c!==0&&c<_l[p].priority;p++);_l.splice(p,0,s),p===0&&nx(s)}};var ax=n.version;if(ax!=="19.1.0")throw Error(r(527,ax,"19.1.0"));U.findDOMNode=function(s){var c=s._reactInternals;if(c===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=u(c),s=s!==null?d(s):null,s=s===null?null:s.stateNode,s};var E0={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:K,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var lh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lh.isDisabled&&lh.supportsFiber)try{Q=lh.inject(E0),ie=lh}catch{}}return vm.createRoot=function(s,c){if(!a(s))throw Error(r(299));var p=!1,x="",S=Dp,D=Cf,H=Vg,Z=null;return c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(S=c.onUncaughtError),c.onCaughtError!==void 0&&(D=c.onCaughtError),c.onRecoverableError!==void 0&&(H=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(Z=c.unstable_transitionCallbacks)),c=Ky(s,1,!1,null,null,p,x,S,D,H,Z,null),s[La]=c.current,am(s),new xm(c)},vm.hydrateRoot=function(s,c,p){if(!a(s))throw Error(r(299));var x=!1,S="",D=Dp,H=Cf,Z=Vg,ye=null,Ie=null;return p!=null&&(p.unstable_strictMode===!0&&(x=!0),p.identifierPrefix!==void 0&&(S=p.identifierPrefix),p.onUncaughtError!==void 0&&(D=p.onUncaughtError),p.onCaughtError!==void 0&&(H=p.onCaughtError),p.onRecoverableError!==void 0&&(Z=p.onRecoverableError),p.unstable_transitionCallbacks!==void 0&&(ye=p.unstable_transitionCallbacks),p.formState!==void 0&&(Ie=p.formState)),c=Ky(s,1,!0,c,p??null,x,S,D,H,Z,ye,Ie),c.context=Xy(null),p=c.current,x=Vi(),x=Hi(x),S=ol(x),S.callback=null,vs(p,S,x),p=x,c.current.lanes=p,Cn(c,p),Xa(c),s[La]=c.current,am(s),new sh(c)},vm.version="19.1.0",vm}var rS;function mA(){if(rS)return M0.exports;rS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),M0.exports=pA(),M0.exports}var gA=mA(),wm={},aS;function yA(){if(aS)return wm;aS=1,Object.defineProperty(wm,"__esModule",{value:!0}),wm.parse=o,wm.serialize=d;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,n=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,l=(()=>{const b=function(){};return b.prototype=Object.create(null),b})();function o(b,v){const N=new l,k=b.length;if(k<2)return N;const T=(v==null?void 0:v.decode)||h;let E=0;do{const I=b.indexOf("=",E);if(I===-1)break;const P=b.indexOf(";",E),V=P===-1?k:P;if(I>V){E=b.lastIndexOf(";",I-1)+1;continue}const F=f(b,E,I),$=u(b,I,F),B=b.slice(F,$);if(N[B]===void 0){let z=f(b,I+1,V),q=u(b,V,z);const O=T(b.slice(z,q));N[B]=O}E=V+1}while(E<k);return N}function f(b,v,N){do{const k=b.charCodeAt(v);if(k!==32&&k!==9)return v}while(++v<N);return N}function u(b,v,N){for(;v>N;){const k=b.charCodeAt(--v);if(k!==32&&k!==9)return v+1}return N}function d(b,v,N){const k=(N==null?void 0:N.encode)||encodeURIComponent;if(!e.test(b))throw new TypeError(`argument name is invalid: ${b}`);const T=k(v);if(!n.test(T))throw new TypeError(`argument val is invalid: ${v}`);let E=b+"="+T;if(!N)return E;if(N.maxAge!==void 0){if(!Number.isInteger(N.maxAge))throw new TypeError(`option maxAge is invalid: ${N.maxAge}`);E+="; Max-Age="+N.maxAge}if(N.domain){if(!t.test(N.domain))throw new TypeError(`option domain is invalid: ${N.domain}`);E+="; Domain="+N.domain}if(N.path){if(!r.test(N.path))throw new TypeError(`option path is invalid: ${N.path}`);E+="; Path="+N.path}if(N.expires){if(!g(N.expires)||!Number.isFinite(N.expires.valueOf()))throw new TypeError(`option expires is invalid: ${N.expires}`);E+="; Expires="+N.expires.toUTCString()}if(N.httpOnly&&(E+="; HttpOnly"),N.secure&&(E+="; Secure"),N.partitioned&&(E+="; Partitioned"),N.priority)switch(typeof N.priority=="string"?N.priority.toLowerCase():void 0){case"low":E+="; Priority=Low";break;case"medium":E+="; Priority=Medium";break;case"high":E+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${N.priority}`)}if(N.sameSite)switch(typeof N.sameSite=="string"?N.sameSite.toLowerCase():N.sameSite){case!0:case"strict":E+="; SameSite=Strict";break;case"lax":E+="; SameSite=Lax";break;case"none":E+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${N.sameSite}`)}return E}function h(b){if(b.indexOf("%")===-1)return b;try{return decodeURIComponent(b)}catch{return b}}function g(b){return a.call(b)==="[object Date]"}return wm}yA();var sS="popstate";function xA(e={}){function n(r,a){let{pathname:l,search:o,hash:f}=r.location;return Fv("",{pathname:l,search:o,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(r,a){return typeof a=="string"?a:Gm(a)}return vA(n,t,null,e)}function li(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function Os(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function bA(){return Math.random().toString(36).substring(2,10)}function lS(e,n){return{usr:e.state,key:e.key,idx:n}}function Fv(e,n,t=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof n=="string"?Mh(n):n,state:t,key:n&&n.key||r||bA()}}function Gm({pathname:e="/",search:n="",hash:t=""}){return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function Mh(e){let n={};if(e){let t=e.indexOf("#");t>=0&&(n.hash=e.substring(t),e=e.substring(0,t));let r=e.indexOf("?");r>=0&&(n.search=e.substring(r),e=e.substring(0,r)),e&&(n.pathname=e)}return n}function vA(e,n,t,r={}){let{window:a=document.defaultView,v5Compat:l=!1}=r,o=a.history,f="POP",u=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function g(){f="POP";let T=h(),E=T==null?null:T-d;d=T,u&&u({action:f,location:k.location,delta:E})}function b(T,E){f="PUSH";let I=Fv(k.location,T,E);d=h()+1;let P=lS(I,d),V=k.createHref(I);try{o.pushState(P,"",V)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;a.location.assign(V)}l&&u&&u({action:f,location:k.location,delta:1})}function v(T,E){f="REPLACE";let I=Fv(k.location,T,E);d=h();let P=lS(I,d),V=k.createHref(I);o.replaceState(P,"",V),l&&u&&u({action:f,location:k.location,delta:0})}function N(T){return wA(T)}let k={get action(){return f},get location(){return e(a,o)},listen(T){if(u)throw new Error("A history only accepts one active listener");return a.addEventListener(sS,g),u=T,()=>{a.removeEventListener(sS,g),u=null}},createHref(T){return n(a,T)},createURL:N,encodeLocation(T){let E=N(T);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:b,replace:v,go(T){return o.go(T)}};return k}function wA(e,n=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),li(t,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:Gm(e);return r=r.replace(/ $/,"%20"),!n&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function s_(e,n,t="/"){return SA(e,n,t,!1)}function SA(e,n,t,r){let a=typeof n=="string"?Mh(n):n,l=Eo(a.pathname||"/",t);if(l==null)return null;let o=l_(e);NA(o);let f=null;for(let u=0;f==null&&u<o.length;++u){let d=MA(l);f=PA(o[u],d,r)}return f}function l_(e,n=[],t=[],r=""){let a=(l,o,f)=>{let u={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};u.relativePath.startsWith("/")&&(li(u.relativePath.startsWith(r),`Absolute route path "${u.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(r.length));let d=_o([r,u.relativePath]),h=t.concat(u);l.children&&l.children.length>0&&(li(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),l_(l.children,n,h,d)),!(l.path==null&&!l.index)&&n.push({path:d,score:AA(d,l.index),routesMeta:h})};return e.forEach((l,o)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))a(l,o);else for(let u of o_(l.path))a(l,o,u)}),n}function o_(e){let n=e.split("/");if(n.length===0)return[];let[t,...r]=n,a=t.endsWith("?"),l=t.replace(/\?$/,"");if(r.length===0)return a?[l,""]:[l];let o=o_(r.join("/")),f=[];return f.push(...o.map(u=>u===""?l:[l,u].join("/"))),a&&f.push(...o),f.map(u=>e.startsWith("/")&&u===""?"/":u)}function NA(e){e.sort((n,t)=>n.score!==t.score?t.score-n.score:DA(n.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var CA=/^:[\w-]+$/,jA=3,_A=2,kA=1,EA=10,TA=-2,oS=e=>e==="*";function AA(e,n){let t=e.split("/"),r=t.length;return t.some(oS)&&(r+=TA),n&&(r+=_A),t.filter(a=>!oS(a)).reduce((a,l)=>a+(CA.test(l)?jA:l===""?kA:EA),r)}function DA(e,n){return e.length===n.length&&e.slice(0,-1).every((r,a)=>r===n[a])?e[e.length-1]-n[n.length-1]:0}function PA(e,n,t=!1){let{routesMeta:r}=e,a={},l="/",o=[];for(let f=0;f<r.length;++f){let u=r[f],d=f===r.length-1,h=l==="/"?n:n.slice(l.length)||"/",g=Ux({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),b=u.route;if(!g&&d&&t&&!r[r.length-1].route.index&&(g=Ux({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!g)return null;Object.assign(a,g.params),o.push({params:a,pathname:_o([l,g.pathname]),pathnameBase:FA(_o([l,g.pathnameBase])),route:b}),g.pathnameBase!=="/"&&(l=_o([l,g.pathnameBase]))}return o}function Ux(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,r]=IA(e.path,e.caseSensitive,e.end),a=n.match(t);if(!a)return null;let l=a[0],o=l.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:g},b)=>{if(h==="*"){let N=f[b]||"";o=l.slice(0,l.length-N.length).replace(/(.)\/+$/,"$1")}const v=f[b];return g&&!v?d[h]=void 0:d[h]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:l,pathnameBase:o,pattern:e}}function IA(e,n=!1,t=!0){Os(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,f,u)=>(r.push({paramName:f,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,n?void 0:"i"),r]}function MA(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return Os(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),e}}function Eo(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let t=n.endsWith("/")?n.length-1:n.length,r=e.charAt(t);return r&&r!=="/"?null:e.slice(t)||"/"}function RA(e,n="/"){let{pathname:t,search:r="",hash:a=""}=typeof e=="string"?Mh(e):e;return{pathname:t?t.startsWith("/")?t:LA(t,n):n,search:$A(r),hash:zA(a)}}function LA(e,n){let t=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function F0(e,n,t,r){return`Cannot include a '${e}' character in a manually specified \`to.${n}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function OA(e){return e.filter((n,t)=>t===0||n.route.path&&n.route.path.length>0)}function U1(e){let n=OA(e);return n.map((t,r)=>r===n.length-1?t.pathname:t.pathnameBase)}function q1(e,n,t,r=!1){let a;typeof e=="string"?a=Mh(e):(a={...e},li(!a.pathname||!a.pathname.includes("?"),F0("?","pathname","search",a)),li(!a.pathname||!a.pathname.includes("#"),F0("#","pathname","hash",a)),li(!a.search||!a.search.includes("#"),F0("#","search","hash",a)));let l=e===""||a.pathname==="",o=l?"/":a.pathname,f;if(o==null)f=t;else{let g=n.length-1;if(!r&&o.startsWith("..")){let b=o.split("/");for(;b[0]==="..";)b.shift(),g-=1;a.pathname=b.join("/")}f=g>=0?n[g]:"/"}let u=RA(a,f),d=o&&o!=="/"&&o.endsWith("/"),h=(l||o===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}var _o=e=>e.join("/").replace(/\/\/+/g,"/"),FA=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),$A=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,zA=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function BA(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var c_=["POST","PUT","PATCH","DELETE"];new Set(c_);var UA=["GET",...c_];new Set(UA);var Rh=w.createContext(null);Rh.displayName="DataRouter";var xb=w.createContext(null);xb.displayName="DataRouterState";var u_=w.createContext({isTransitioning:!1});u_.displayName="ViewTransition";var qA=w.createContext(new Map);qA.displayName="Fetchers";var VA=w.createContext(null);VA.displayName="Await";var zs=w.createContext(null);zs.displayName="Navigation";var ng=w.createContext(null);ng.displayName="Location";var Bs=w.createContext({outlet:null,matches:[],isDataRoute:!1});Bs.displayName="Route";var V1=w.createContext(null);V1.displayName="RouteError";function HA(e,{relative:n}={}){li(Lh(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=w.useContext(zs),{hash:a,pathname:l,search:o}=ig(e,{relative:n}),f=l;return t!=="/"&&(f=l==="/"?t:_o([t,l])),r.createHref({pathname:f,search:o,hash:a})}function Lh(){return w.useContext(ng)!=null}function rr(){return li(Lh(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(ng).location}var d_="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function f_(e){w.useContext(zs).static||w.useLayoutEffect(e)}function gt(){let{isDataRoute:e}=w.useContext(Bs);return e?rD():GA()}function GA(){li(Lh(),"useNavigate() may be used only in the context of a <Router> component.");let e=w.useContext(Rh),{basename:n,navigator:t}=w.useContext(zs),{matches:r}=w.useContext(Bs),{pathname:a}=rr(),l=JSON.stringify(U1(r)),o=w.useRef(!1);return f_(()=>{o.current=!0}),w.useCallback((u,d={})=>{if(Os(o.current,d_),!o.current)return;if(typeof u=="number"){t.go(u);return}let h=q1(u,JSON.parse(l),a,d.relative==="path");e==null&&n!=="/"&&(h.pathname=h.pathname==="/"?n:_o([n,h.pathname])),(d.replace?t.replace:t.push)(h,d.state,d)},[n,t,l,a,e])}w.createContext(null);function jr(){let{matches:e}=w.useContext(Bs),n=e[e.length-1];return n?n.params:{}}function ig(e,{relative:n}={}){let{matches:t}=w.useContext(Bs),{pathname:r}=rr(),a=JSON.stringify(U1(t));return w.useMemo(()=>q1(e,JSON.parse(a),r,n==="path"),[e,a,r,n])}function YA(e,n){return h_(e,n)}function h_(e,n,t,r){var I;li(Lh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:l}=w.useContext(zs),{matches:o}=w.useContext(Bs),f=o[o.length-1],u=f?f.params:{},d=f?f.pathname:"/",h=f?f.pathnameBase:"/",g=f&&f.route;{let P=g&&g.path||"";p_(d,!g||P.endsWith("*")||P.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${P}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${P}"> to <Route path="${P==="/"?"*":`${P}/*`}">.`)}let b=rr(),v;if(n){let P=typeof n=="string"?Mh(n):n;li(h==="/"||((I=P.pathname)==null?void 0:I.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${P.pathname}" was given in the \`location\` prop.`),v=P}else v=b;let N=v.pathname||"/",k=N;if(h!=="/"){let P=h.replace(/^\//,"").split("/");k="/"+N.replace(/^\//,"").split("/").slice(P.length).join("/")}let T=!l&&t&&t.matches&&t.matches.length>0?t.matches:s_(e,{pathname:k});Os(g||T!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Os(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=XA(T&&T.map(P=>Object.assign({},P,{params:Object.assign({},u,P.params),pathname:_o([h,a.encodeLocation?a.encodeLocation(P.pathname).pathname:P.pathname]),pathnameBase:P.pathnameBase==="/"?h:_o([h,a.encodeLocation?a.encodeLocation(P.pathnameBase).pathname:P.pathnameBase])})),o,t,r);return n&&E?w.createElement(ng.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},E):E}function WA(){let e=iD(),n=BA(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},l={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:l},"ErrorBoundary")," or"," ",w.createElement("code",{style:l},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},n),t?w.createElement("pre",{style:a},t):null,o)}var QA=w.createElement(WA,null),JA=class extends w.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?w.createElement(Bs.Provider,{value:this.props.routeContext},w.createElement(V1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function KA({routeContext:e,match:n,children:t}){let r=w.useContext(Rh);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),w.createElement(Bs.Provider,{value:e},t)}function XA(e,n=[],t=null,r=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(n.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let a=e,l=t==null?void 0:t.errors;if(l!=null){let u=a.findIndex(d=>d.route.id&&(l==null?void 0:l[d.route.id])!==void 0);li(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),a=a.slice(0,Math.min(a.length,u+1))}let o=!1,f=-1;if(t)for(let u=0;u<a.length;u++){let d=a[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(f=u),d.route.id){let{loaderData:h,errors:g}=t,b=d.route.loader&&!h.hasOwnProperty(d.route.id)&&(!g||g[d.route.id]===void 0);if(d.route.lazy||b){o=!0,f>=0?a=a.slice(0,f+1):a=[a[0]];break}}}return a.reduceRight((u,d,h)=>{let g,b=!1,v=null,N=null;t&&(g=l&&d.route.id?l[d.route.id]:void 0,v=d.route.errorElement||QA,o&&(f<0&&h===0?(p_("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,N=null):f===h&&(b=!0,N=d.route.hydrateFallbackElement||null)));let k=n.concat(a.slice(0,h+1)),T=()=>{let E;return g?E=v:b?E=N:d.route.Component?E=w.createElement(d.route.Component,null):d.route.element?E=d.route.element:E=u,w.createElement(KA,{match:d,routeContext:{outlet:u,matches:k,isDataRoute:t!=null},children:E})};return t&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?w.createElement(JA,{location:t.location,revalidation:t.revalidation,component:v,error:g,children:T(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):T()},null)}function H1(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ZA(e){let n=w.useContext(Rh);return li(n,H1(e)),n}function eD(e){let n=w.useContext(xb);return li(n,H1(e)),n}function tD(e){let n=w.useContext(Bs);return li(n,H1(e)),n}function G1(e){let n=tD(e),t=n.matches[n.matches.length-1];return li(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function nD(){return G1("useRouteId")}function iD(){var r;let e=w.useContext(V1),n=eD("useRouteError"),t=G1("useRouteError");return e!==void 0?e:(r=n.errors)==null?void 0:r[t]}function rD(){let{router:e}=ZA("useNavigate"),n=G1("useNavigate"),t=w.useRef(!1);return f_(()=>{t.current=!0}),w.useCallback(async(a,l={})=>{Os(t.current,d_),t.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:n,...l}))},[e,n])}var cS={};function p_(e,n,t){!n&&!cS[e]&&(cS[e]=!0,Os(!1,t))}w.memo(aD);function aD({routes:e,future:n,state:t}){return h_(e,void 0,t,n)}function pn({to:e,replace:n,state:t,relative:r}){li(Lh(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=w.useContext(zs);Os(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=w.useContext(Bs),{pathname:o}=rr(),f=gt(),u=q1(e,U1(l),o,r==="path"),d=JSON.stringify(u);return w.useEffect(()=>{f(JSON.parse(d),{replace:n,state:t,relative:r})},[f,d,r,n,t]),null}function ct(e){li(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function sD({basename:e="/",children:n=null,location:t,navigationType:r="POP",navigator:a,static:l=!1}){li(!Lh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),f=w.useMemo(()=>({basename:o,navigator:a,static:l,future:{}}),[o,a,l]);typeof t=="string"&&(t=Mh(t));let{pathname:u="/",search:d="",hash:h="",state:g=null,key:b="default"}=t,v=w.useMemo(()=>{let N=Eo(u,o);return N==null?null:{location:{pathname:N,search:d,hash:h,state:g,key:b},navigationType:r}},[o,u,d,h,g,b,r]);return Os(v!=null,`<Router basename="${o}"> is not able to match the URL "${u}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:w.createElement(zs.Provider,{value:f},w.createElement(ng.Provider,{children:n,value:v}))}function gh({children:e,location:n}){return YA($v(e),n)}function $v(e,n=[]){let t=[];return w.Children.forEach(e,(r,a)=>{if(!w.isValidElement(r))return;let l=[...n,a];if(r.type===w.Fragment){t.push.apply(t,$v(r.props.children,l));return}li(r.type===ct,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),li(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=$v(r.props.children,l)),t.push(o)}),t}var Px="get",Ix="application/x-www-form-urlencoded";function bb(e){return e!=null&&typeof e.tagName=="string"}function lD(e){return bb(e)&&e.tagName.toLowerCase()==="button"}function oD(e){return bb(e)&&e.tagName.toLowerCase()==="form"}function cD(e){return bb(e)&&e.tagName.toLowerCase()==="input"}function uD(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function dD(e,n){return e.button===0&&(!n||n==="_self")&&!uD(e)}var sx=null;function fD(){if(sx===null)try{new FormData(document.createElement("form"),0),sx=!1}catch{sx=!0}return sx}var hD=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function $0(e){return e!=null&&!hD.has(e)?(Os(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ix}"`),null):e}function pD(e,n){let t,r,a,l,o;if(oD(e)){let f=e.getAttribute("action");r=f?Eo(f,n):null,t=e.getAttribute("method")||Px,a=$0(e.getAttribute("enctype"))||Ix,l=new FormData(e)}else if(lD(e)||cD(e)&&(e.type==="submit"||e.type==="image")){let f=e.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=e.getAttribute("formaction")||f.getAttribute("action");if(r=u?Eo(u,n):null,t=e.getAttribute("formmethod")||f.getAttribute("method")||Px,a=$0(e.getAttribute("formenctype"))||$0(f.getAttribute("enctype"))||Ix,l=new FormData(f,e),!fD()){let{name:d,type:h,value:g}=e;if(h==="image"){let b=d?`${d}.`:"";l.append(`${b}x`,"0"),l.append(`${b}y`,"0")}else d&&l.append(d,g)}}else{if(bb(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Px,r=null,a=Ix,o=e}return l&&a==="text/plain"&&(o=l,l=void 0),{action:r,method:t.toLowerCase(),encType:a,formData:l,body:o}}function Y1(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}async function mD(e,n){if(e.id in n)return n[e.id];try{let t=await import(e.module);return n[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function gD(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function yD(e,n,t){let r=await Promise.all(e.map(async a=>{let l=n.routes[a.route.id];if(l){let o=await mD(l,t);return o.links?o.links():[]}return[]}));return wD(r.flat(1).filter(gD).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function uS(e,n,t,r,a,l){let o=(u,d)=>t[d]?u.route.id!==t[d].route.id:!0,f=(u,d)=>{var h;return t[d].pathname!==u.pathname||((h=t[d].route.path)==null?void 0:h.endsWith("*"))&&t[d].params["*"]!==u.params["*"]};return l==="assets"?n.filter((u,d)=>o(u,d)||f(u,d)):l==="data"?n.filter((u,d)=>{var g;let h=r.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,d)||f(u,d))return!0;if(u.route.shouldRevalidate){let b=u.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((g=t[0])==null?void 0:g.params)||{},nextUrl:new URL(e,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function xD(e,n,{includeHydrateFallback:t}={}){return bD(e.map(r=>{let a=n.routes[r.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function bD(e){return[...new Set(e)]}function vD(e){let n={},t=Object.keys(e).sort();for(let r of t)n[r]=e[r];return n}function wD(e,n){let t=new Set;return new Set(n),e.reduce((r,a)=>{let l=JSON.stringify(vD(a));return t.has(l)||(t.add(l),r.push({key:l,link:a})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var SD=new Set([100,101,204,205]);function ND(e,n){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":n&&Eo(t.pathname,n)==="/"?t.pathname=`${n.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function m_(){let e=w.useContext(Rh);return Y1(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function CD(){let e=w.useContext(xb);return Y1(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var W1=w.createContext(void 0);W1.displayName="FrameworkContext";function g_(){let e=w.useContext(W1);return Y1(e,"You must render this element inside a <HydratedRouter> element"),e}function jD(e,n){let t=w.useContext(W1),[r,a]=w.useState(!1),[l,o]=w.useState(!1),{onFocus:f,onBlur:u,onMouseEnter:d,onMouseLeave:h,onTouchStart:g}=n,b=w.useRef(null);w.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let k=E=>{E.forEach(I=>{o(I.isIntersecting)})},T=new IntersectionObserver(k,{threshold:.5});return b.current&&T.observe(b.current),()=>{T.disconnect()}}},[e]),w.useEffect(()=>{if(r){let k=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(k)}}},[r]);let v=()=>{a(!0)},N=()=>{a(!1),o(!1)};return t?e!=="intent"?[l,b,{}]:[l,b,{onFocus:Sm(f,v),onBlur:Sm(u,N),onMouseEnter:Sm(d,v),onMouseLeave:Sm(h,N),onTouchStart:Sm(g,v)}]:[!1,b,{}]}function Sm(e,n){return t=>{e&&e(t),t.defaultPrevented||n(t)}}function _D({page:e,...n}){let{router:t}=m_(),r=w.useMemo(()=>s_(t.routes,e,t.basename),[t.routes,e,t.basename]);return r?w.createElement(ED,{page:e,matches:r,...n}):null}function kD(e){let{manifest:n,routeModules:t}=g_(),[r,a]=w.useState([]);return w.useEffect(()=>{let l=!1;return yD(e,n,t).then(o=>{l||a(o)}),()=>{l=!0}},[e,n,t]),r}function ED({page:e,matches:n,...t}){let r=rr(),{manifest:a,routeModules:l}=g_(),{basename:o}=m_(),{loaderData:f,matches:u}=CD(),d=w.useMemo(()=>uS(e,n,u,a,r,"data"),[e,n,u,a,r]),h=w.useMemo(()=>uS(e,n,u,a,r,"assets"),[e,n,u,a,r]),g=w.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let N=new Set,k=!1;if(n.forEach(E=>{var P;let I=a.routes[E.route.id];!I||!I.hasLoader||(!d.some(V=>V.route.id===E.route.id)&&E.route.id in f&&((P=l[E.route.id])!=null&&P.shouldRevalidate)||I.hasClientLoader?k=!0:N.add(E.route.id))}),N.size===0)return[];let T=ND(e,o);return k&&N.size>0&&T.searchParams.set("_routes",n.filter(E=>N.has(E.route.id)).map(E=>E.route.id).join(",")),[T.pathname+T.search]},[o,f,r,a,d,n,e,l]),b=w.useMemo(()=>xD(h,a),[h,a]),v=kD(h);return w.createElement(w.Fragment,null,g.map(N=>w.createElement("link",{key:N,rel:"prefetch",as:"fetch",href:N,...t})),b.map(N=>w.createElement("link",{key:N,rel:"modulepreload",href:N,...t})),v.map(({key:N,link:k})=>w.createElement("link",{key:N,...k})))}function TD(...e){return n=>{e.forEach(t=>{typeof t=="function"?t(n):t!=null&&(t.current=n)})}}var y_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{y_&&(window.__reactRouterVersion="7.6.0")}catch{}function AD({basename:e,children:n,window:t}){let r=w.useRef();r.current==null&&(r.current=xA({window:t,v5Compat:!0}));let a=r.current,[l,o]=w.useState({action:a.action,location:a.location}),f=w.useCallback(u=>{w.startTransition(()=>o(u))},[o]);return w.useLayoutEffect(()=>a.listen(f),[a,f]),w.createElement(sD,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:a})}var x_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,is=w.forwardRef(function({onClick:n,discover:t="render",prefetch:r="none",relative:a,reloadDocument:l,replace:o,state:f,target:u,to:d,preventScrollReset:h,viewTransition:g,...b},v){let{basename:N}=w.useContext(zs),k=typeof d=="string"&&x_.test(d),T,E=!1;if(typeof d=="string"&&k&&(T=d,y_))try{let q=new URL(window.location.href),O=d.startsWith("//")?new URL(q.protocol+d):new URL(d),R=Eo(O.pathname,N);O.origin===q.origin&&R!=null?d=R+O.search+O.hash:E=!0}catch{Os(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let I=HA(d,{relative:a}),[P,V,F]=jD(r,b),$=MD(d,{replace:o,state:f,target:u,preventScrollReset:h,relative:a,viewTransition:g});function B(q){n&&n(q),q.defaultPrevented||$(q)}let z=w.createElement("a",{...b,...F,href:T||I,onClick:E||l?n:B,ref:TD(v,V),target:u,"data-discover":!k&&t==="render"?"true":void 0});return P&&!k?w.createElement(w.Fragment,null,z,w.createElement(_D,{page:I})):z});is.displayName="Link";var DD=w.forwardRef(function({"aria-current":n="page",caseSensitive:t=!1,className:r="",end:a=!1,style:l,to:o,viewTransition:f,children:u,...d},h){let g=ig(o,{relative:d.relative}),b=rr(),v=w.useContext(xb),{navigator:N,basename:k}=w.useContext(zs),T=v!=null&&$D(g)&&f===!0,E=N.encodeLocation?N.encodeLocation(g).pathname:g.pathname,I=b.pathname,P=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(I=I.toLowerCase(),P=P?P.toLowerCase():null,E=E.toLowerCase()),P&&k&&(P=Eo(P,k)||P);const V=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let F=I===E||!a&&I.startsWith(E)&&I.charAt(V)==="/",$=P!=null&&(P===E||!a&&P.startsWith(E)&&P.charAt(E.length)==="/"),B={isActive:F,isPending:$,isTransitioning:T},z=F?n:void 0,q;typeof r=="function"?q=r(B):q=[r,F?"active":null,$?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let O=typeof l=="function"?l(B):l;return w.createElement(is,{...d,"aria-current":z,className:q,ref:h,style:O,to:o,viewTransition:f},typeof u=="function"?u(B):u)});DD.displayName="NavLink";var PD=w.forwardRef(({discover:e="render",fetcherKey:n,navigate:t,reloadDocument:r,replace:a,state:l,method:o=Px,action:f,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:g,...b},v)=>{let N=OD(),k=FD(f,{relative:d}),T=o.toLowerCase()==="get"?"get":"post",E=typeof f=="string"&&x_.test(f),I=P=>{if(u&&u(P),P.defaultPrevented)return;P.preventDefault();let V=P.nativeEvent.submitter,F=(V==null?void 0:V.getAttribute("formmethod"))||o;N(V||P.currentTarget,{fetcherKey:n,method:F,navigate:t,replace:a,state:l,relative:d,preventScrollReset:h,viewTransition:g})};return w.createElement("form",{ref:v,method:T,action:k,onSubmit:r?u:I,...b,"data-discover":!E&&e==="render"?"true":void 0})});PD.displayName="Form";function ID(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function b_(e){let n=w.useContext(Rh);return li(n,ID(e)),n}function MD(e,{target:n,replace:t,state:r,preventScrollReset:a,relative:l,viewTransition:o}={}){let f=gt(),u=rr(),d=ig(e,{relative:l});return w.useCallback(h=>{if(dD(h,n)){h.preventDefault();let g=t!==void 0?t:Gm(u)===Gm(d);f(e,{replace:g,state:r,preventScrollReset:a,relative:l,viewTransition:o})}},[u,f,d,t,r,n,e,a,l,o])}var RD=0,LD=()=>`__${String(++RD)}__`;function OD(){let{router:e}=b_("useSubmit"),{basename:n}=w.useContext(zs),t=nD();return w.useCallback(async(r,a={})=>{let{action:l,method:o,encType:f,formData:u,body:d}=pD(r,n);if(a.navigate===!1){let h=a.fetcherKey||LD();await e.fetch(h,t,a.action||l,{preventScrollReset:a.preventScrollReset,formData:u,body:d,formMethod:a.method||o,formEncType:a.encType||f,flushSync:a.flushSync})}else await e.navigate(a.action||l,{preventScrollReset:a.preventScrollReset,formData:u,body:d,formMethod:a.method||o,formEncType:a.encType||f,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,n,t])}function FD(e,{relative:n}={}){let{basename:t}=w.useContext(zs),r=w.useContext(Bs);li(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),l={...ig(e||".",{relative:n})},o=rr();if(e==null){l.search=o.search;let f=new URLSearchParams(l.search),u=f.getAll("index");if(u.some(h=>h==="")){f.delete("index"),u.filter(g=>g).forEach(g=>f.append("index",g));let h=f.toString();l.search=h?`?${h}`:""}}return(!e||e===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(l.pathname=l.pathname==="/"?t:_o([t,l.pathname])),Gm(l)}function $D(e,n={}){let t=w.useContext(u_);li(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=b_("useViewTransitionState"),a=ig(e,{relative:n.relative});if(!t.isTransitioning)return!1;let l=Eo(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=Eo(t.nextLocation.pathname,r)||t.nextLocation.pathname;return Ux(a.pathname,o)!=null||Ux(a.pathname,l)!=null}[...SD];var zD=a_();class BD extends w.Component{constructor(){super(...arguments);Rn(this,"state",{hasError:!1})}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){console.error("Uncaught error:",t,r)}render(){return this.state.hasError?i.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"red",border:"1px solid red",borderRadius:"5px"},children:[i.jsx("h1",{children:"Something went wrong."}),i.jsx("p",{children:"We are sorry for the inconvenience. Please try again later."})]}):this.props.children}}class UD{constructor(){Rn(this,"requestCount",0);Rn(this,"listeners",[])}subscribe(n){return this.listeners.push(n),()=>{this.listeners=this.listeners.filter(t=>t!==n)}}notify(){const n=this.requestCount>0;this.listeners.forEach(t=>t(n))}addRequest(){this.requestCount++,this.notify()}removeRequest(){this.requestCount--,this.requestCount<0&&(this.requestCount=0),this.notify()}}const Ms=new UD,qD="https://backend.newtons.in",VD=()=>localStorage.getItem("authToken"),pe=async(e,n={})=>{const t=VD(),r={...n.headers};t&&(r.Authorization=`Bearer ${t}`),!(n.body instanceof FormData)&&!r["Content-Type"]&&(r["Content-Type"]="application/json");const a=r;let l=e.startsWith("/")?e:`/${e}`;l.startsWith("/api/")||(l=`/api${l}`);const o=`${qD}${l}`;Ms.addRequest();try{console.log(`Making API call to: ${o}`);const f=await fetch(o,{...n,headers:a});if(f.status===401)throw console.error("Unauthorized access - Token might be invalid or expired. Logging out."),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser"),window.location.href="/login",new Error("Unauthorized");if(!f.ok){let u=`HTTP error! status: ${f.status}`;try{const d=await f.json();u=(d==null?void 0:d.message)||(d==null?void 0:d.error)||u}catch{}throw console.error(`API Error: ${f.status} ${f.statusText} - ${u}`),new Error(u)}return f}catch(f){throw f instanceof TypeError&&f.message==="Failed to fetch"?console.error("API Fetch Error: Network error or CORS issue. Check backend CORS configuration.",f):console.error("API Fetch Error:",f),f}finally{Ms.removeRequest()}},HD=({onLoginSuccess:e})=>{const[n,t]=w.useState(""),[r,a]=w.useState(""),[l,o]=w.useState(null),[f,u]=w.useState(!1),d=gt(),h=async g=>{g.preventDefault(),u(!0),o(null);try{const b=await pe("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});if(!b.ok){let N=`Login failed with status: ${b.status}`;try{N=(await b.json()).message||N}catch{try{const T=await b.text();T&&(N=`${N} - ${T}`)}catch{}}throw new Error(N)}const v=await b.json();console.log("Login successful:",v),localStorage.setItem("authToken",v.token),localStorage.setItem("currentUser",JSON.stringify(v.user)),v.user.clinic_id&&localStorage.setItem("currentClinicId",v.user.clinic_id),e(v.user),v.user.role==="doctor"?d("/dashboard/queue"):d("/dashboard")}catch(b){console.error("Login failed:",b),o(b.message||"Login failed. Please check your credentials.")}finally{u(!1)}};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Sign in to Newtons OPD Zero"}),i.jsxs("form",{onSubmit:h,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email address"}),i.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:n,onChange:g=>t(g.target.value),className:"auth-text-input",placeholder:"you@example.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"Password"}),i.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:r,onChange:g=>a(g.target.value),className:"auth-text-input",placeholder:"Password"})]}),l&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:l})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:f,className:"auth-submit-button",children:f?"Signing in...":"Sign In"})})]}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Don't have an account?"," ",i.jsx(is,{to:"/register",className:"auth-navigation-link",children:"Register a new clinic"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})},GD=()=>{const[e,n]=w.useState(""),[t,r]=w.useState(""),[a,l]=w.useState(""),[o,f]=w.useState(""),[u,d]=w.useState(null),[h,g]=w.useState(!1),b=gt(),v=async N=>{N.preventDefault(),g(!0),d(null);try{const k=await pe("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicName:e,userName:t,userEmail:a,userPassword:o})}),T=await k.json();if(!k.ok)throw new Error(T.message||`HTTP error! status: ${k.status}`);console.log("Registration successful:",T),alert("Registration successful! Please log in."),b("/login")}catch(k){console.error("Registration failed:",k),d(k.message||"Registration failed. Please try again.")}finally{g(!1)}};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Register Clinic & Admin"}),i.jsxs("form",{onSubmit:v,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"clinicName",children:"Clinic Name"}),i.jsx("input",{id:"clinicName",name:"clinicName",type:"text",required:!0,value:e,onChange:N=>n(N.target.value),className:"auth-text-input",placeholder:"Your Clinic's Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userName",children:"Your Name (Admin)"}),i.jsx("input",{id:"userName",name:"userName",type:"text",required:!0,value:t,onChange:N=>r(N.target.value),className:"auth-text-input",placeholder:"Your Full Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userEmail",children:"Your Email (Admin Login)"}),i.jsx("input",{id:"userEmail",name:"userEmail",type:"email",autoComplete:"email",required:!0,value:a,onChange:N=>l(N.target.value),className:"auth-text-input",placeholder:"you@example.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userPassword",children:"Password"}),i.jsx("input",{id:"userPassword",name:"userPassword",type:"password",required:!0,minLength:6,value:o,onChange:N=>f(N.target.value),className:"auth-text-input",placeholder:"Min. 6 characters"})]}),u&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:u})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:h,className:"auth-submit-button",children:h?"Registering...":"Register Clinic & Admin"})})]}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Already have an account?"," ",i.jsx(is,{to:"/login",className:"auth-navigation-link",children:"Sign in"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})};var v_={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},dS=En.createContext&&En.createContext(v_),YD=["attr","size","title"];function WD(e,n){if(e==null)return{};var t=QD(e,n),r,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}function QD(e,n){if(e==null)return{};var t={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(n.indexOf(r)>=0)continue;t[r]=e[r]}return t}function qx(){return qx=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},qx.apply(this,arguments)}function fS(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function Vx(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?fS(Object(t),!0).forEach(function(r){JD(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):fS(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function JD(e,n,t){return n=KD(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function KD(e){var n=XD(e,"string");return typeof n=="symbol"?n:n+""}function XD(e,n){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function w_(e){return e&&e.map((n,t)=>En.createElement(n.tag,Vx({key:t},n.attr),w_(n.child)))}function as(e){return n=>En.createElement(ZD,qx({attr:Vx({},e.attr)},n),w_(e.child))}function ZD(e){var n=t=>{var{attr:r,size:a,title:l}=e,o=WD(e,YD),f=a||t.size||"1em",u;return t.className&&(u=t.className),e.className&&(u=(u?u+" ":"")+e.className),En.createElement("svg",qx({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,o,{className:u,style:Vx(Vx({color:e.color||t.color},t.style),e.style),height:f,width:f,xmlns:"http://www.w3.org/2000/svg"}),l&&En.createElement("title",null,l),e.children)};return dS!==void 0?En.createElement(dS.Consumer,null,t=>n(t)):n(v_)}function Nm(e){return as({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(e)}function eP(e){return as({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function hS(e){return as({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M437.2 403.5L320 215V64h8c13.3 0 24-10.7 24-24V24c0-13.3-10.7-24-24-24H120c-13.3 0-24 10.7-24 24v16c0 13.3 10.7 24 24 24h8v151L10.8 403.5C-18.5 450.6 15.3 512 70.9 512h306.2c55.7 0 89.4-61.5 60.1-108.5zM137.9 320l48.2-77.6c3.7-5.2 5.8-11.6 5.8-18.4V64h64v160c0 6.9 2.2 13.2 5.8 18.4l48.2 77.6h-172z"},child:[]}]})(e)}function yh(e){return as({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function lx(e){return as({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M480 320a96 96 0 1 0-96-96 96 96 0 0 0 96 96zm48 32a22.88 22.88 0 0 0-7.06 1.09 124.76 124.76 0 0 1-81.89 0A22.82 22.82 0 0 0 432 352a112 112 0 0 0-112 112.62c.14 26.26 21.73 47.38 48 47.38h224c26.27 0 47.86-21.12 48-47.38A112 112 0 0 0 528 352zm-198.09 10.45A145.19 145.19 0 0 1 352 344.62V128a32 32 0 0 0-32-32h-32V32a32 32 0 0 0-32-32H96a32 32 0 0 0-32 32v64H32a32 32 0 0 0-32 32v368a16 16 0 0 0 16 16h288.31A78.62 78.62 0 0 1 288 464.79a143.06 143.06 0 0 1 41.91-102.34zM144 404a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm48-122a6 6 0 0 1-6 6h-20a6 6 0 0 1-6-6v-26h-26a6 6 0 0 1-6-6v-20a6 6 0 0 1 6-6h26V70a6 6 0 0 1 6-6h20a6 6 0 0 1 6 6v26h26a6 6 0 0 1 6 6v20a6 6 0 0 1-6 6h-26zm80 250a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12z"},child:[]}]})(e)}function ox(e){return as({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M352 288h-16v-88c0-4.42-3.58-8-8-8h-13.58c-4.74 0-9.37 1.4-13.31 4.03l-15.33 10.22a7.994 7.994 0 0 0-2.22 11.09l8.88 13.31a7.994 7.994 0 0 0 11.09 2.22l.47-.31V288h-16c-4.42 0-8 3.58-8 8v16c0 4.42 3.58 8 8 8h64c4.42 0 8-3.58 8-8v-16c0-4.42-3.58-8-8-8zM608 64H32C14.33 64 0 78.33 0 96v320c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V96c0-17.67-14.33-32-32-32zM48 400v-64c35.35 0 64 28.65 64 64H48zm0-224v-64h64c0 35.35-28.65 64-64 64zm272 192c-53.02 0-96-50.15-96-112 0-61.86 42.98-112 96-112s96 50.14 96 112c0 61.87-43 112-96 112zm272 32h-64c0-35.35 28.65-64 64-64v64zm0-224c-35.35 0-64-28.65-64-64h64v64z"},child:[]}]})(e)}function cx(e){return as({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M112 32C50.1 32 0 82.1 0 144v224c0 61.9 50.1 112 112 112s112-50.1 112-112V144c0-61.9-50.1-112-112-112zm48 224H64V144c0-26.5 21.5-48 48-48s48 21.5 48 48v112zm139.7-29.7c-3.5-3.5-9.4-3.1-12.3.8-45.3 62.5-40.4 150.1 15.9 206.4 56.3 56.3 143.9 61.2 206.4 15.9 4-2.9 4.3-8.8.8-12.3L299.7 226.3zm229.8-19c-56.3-56.3-143.9-61.2-206.4-15.9-4 2.9-4.3 8.8-.8 12.3l210.8 210.8c3.5 3.5 9.4 3.1 12.3-.8 45.3-62.6 40.5-150.1-15.9-206.4z"},child:[]}]})(e)}function xh(e){return as({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function S_(e){return as({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(e)}function pS(e){return as({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M447.1 112c-34.2.5-62.3 28.4-63 62.6-.5 24.3 12.5 45.6 32 56.8V344c0 57.3-50.2 104-112 104-60 0-109.2-44.1-111.9-99.2C265 333.8 320 269.2 320 192V36.6c0-11.4-8.1-21.3-19.3-23.5L237.8.5c-13-2.6-25.6 5.8-28.2 18.8L206.4 35c-2.6 13 5.8 25.6 18.8 28.2l30.7 6.1v121.4c0 52.9-42.2 96.7-95.1 97.2-53.4.5-96.9-42.7-96.9-96V69.4l30.7-6.1c13-2.6 21.4-15.2 18.8-28.2l-3.1-15.7C107.7 6.4 95.1-2 82.1.6L19.3 13C8.1 15.3 0 25.1 0 36.6V192c0 77.3 55.1 142 128.1 156.8C130.7 439.2 208.6 512 304 512c97 0 176-75.4 176-168V231.4c19.1-11.1 32-31.7 32-55.4 0-35.7-29.2-64.5-64.9-64zm.9 80c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16z"},child:[]}]})(e)}function z0(e){return as({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zM104 424c0 13.3 10.7 24 24 24s24-10.7 24-24-10.7-24-24-24-24 10.7-24 24zm216-135.4v49c36.5 7.4 64 39.8 64 78.4v41.7c0 7.6-5.4 14.2-12.9 15.7l-32.2 6.4c-4.3.9-8.5-1.9-9.4-6.3l-3.1-15.7c-.9-4.3 1.9-8.6 6.3-9.4l19.3-3.9V416c0-62.8-96-65.1-96 1.9v26.7l19.3 3.9c4.3.9 7.1 5.1 6.3 9.4l-3.1 15.7c-.9 4.3-5.1 7.1-9.4 6.3l-31.2-4.2c-7.9-1.1-13.8-7.8-13.8-15.9V416c0-38.6 27.5-70.9 64-78.4v-45.2c-2.2.7-4.4 1.1-6.6 1.9-18 6.3-37.3 9.8-57.4 9.8s-39.4-3.5-57.4-9.8c-7.4-2.6-14.9-4.2-22.6-5.2v81.6c23.1 6.9 40 28.1 40 53.4 0 30.9-25.1 56-56 56s-56-25.1-56-56c0-25.3 16.9-46.5 40-53.4v-80.4C48.5 301 0 355.8 0 422.4v44.8C0 491.9 20.1 512 44.8 512h358.4c24.7 0 44.8-20.1 44.8-44.8v-44.8c0-72-56.8-130.3-128-133.8z"},child:[]}]})(e)}function oh(e){return as({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(e)}const Q1={superadmin:[{title:"Admin Pages",links:[{path:"/dashboard",name:"Super Admin Dashboard",icon:yh},{path:"/dashboard/clinic-subscriptions",name:"Clinic Subscriptions",icon:lx},{path:"/dashboard/users",name:"User Management",icon:oh}]}],admin:[{title:"Dashboard",links:[{path:"/dashboard",name:"Admin Dashboard",icon:yh}]},{title:"Staff Management",links:[{path:"/dashboard/staff",name:"Manage Staff",icon:oh},{path:"/dashboard/staff/add",name:"Add Staff",icon:z0}]},{title:"Patient Management",links:[{path:"/dashboard/patients/add",name:"Add Patient",icon:lx},{path:"/dashboard/patients",name:"All Patients",icon:oh},{path:"/dashboard/patients/search",name:"Search Patient",icon:xh}]},{title:"Inventory & Pharmacy",links:[{path:"/dashboard/analysis",name:"Inventory Analysis",icon:Nm},{path:"/dashboard/inventory",name:"Pharmacy Inventory",icon:cx},{path:"/dashboard/purchase",name:"Add Drug",icon:cx},{path:"/dashboard/recurring-medications",name:"Recurring Medications",icon:Nm},{path:"/dashboard/distributors",name:"Distributor Management",icon:oh}]},{title:"Queue & Subscriptions",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:pS},{path:"/dashboard/subscriptions",name:"Manage Subscriptions",icon:ox},{path:"/dashboard/subscriptions/add",name:"Add Subscription Plan",icon:ox}]}],doctor:[{title:"Patient & Admissions",links:[{path:"/dashboard/search",name:"Patient Search",icon:xh},{path:"/dashboard/add-patient",name:"Add Patient",icon:lx},{path:"/manage-admission",name:"Manage Admission",icon:z0}]},{title:"Lab & Billing",links:[{path:"/create-lab-order",name:"Create Lab Order",icon:hS},{path:"/billing",name:"Billing",icon:ox}]},{title:"Queue",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:pS}]}],receptionist:[{title:"Reception",links:[{path:"/dashboard",name:"Reception Dashboard",icon:yh}]},{title:"Patient Management",links:[{path:"/dashboard/all-patients",name:"All Patients",icon:oh},{path:"/dashboard/patients/add",name:"Add Patient",icon:lx},{path:"/dashboard/patients/search",name:"Search Patient",icon:xh}]},{title:"Billing & Admissions",links:[{path:"/billing",name:"Billing",icon:ox},{path:"/manage-admission",name:"Manage Admission",icon:z0}]}],lab:[{title:"Lab Operations",links:[{path:"/dashboard",name:"Lab Dashboard",icon:yh},{path:"/lab-inventory",name:"Lab Test Inventory",icon:hS},{path:"/lab/search-report",name:"Search Lab Report",icon:xh}]}],pharmacy:[{title:"Pharmacy Operations",links:[{path:"/dashboard",name:"Pharmacy Queue",icon:yh},{path:"/dashboard/inventory",name:"Pharmacy Inventory",icon:cx},{path:"/dashboard/purchase",name:"Add Drug",icon:cx},{path:"/dashboard/add-order",name:"Add Pharmacy Order",icon:Nm},{path:"/dashboard/recurring-medications",name:"Recurring Medications",icon:Nm},{path:"/dashboard/distributors",name:"Distributor Management",icon:oh}]},{title:"Analysis & Settings",links:[{path:"/dashboard/analysis",name:"Inventory Analysis",icon:Nm},{path:"/dashboard/settings",name:"Pharmacy Settings",icon:eP},{path:"/dashboard/search-patient-records",name:"Search Patient Records",icon:xh}]}]},tP=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a})=>{const l=rr(),[o,f]=w.useState(""),u=Q1[t]||[],[d,h]=w.useState(500),g=w.useRef(!1),b=w.useCallback(T=>{g.current=!0,T.preventDefault()},[]),v=w.useCallback(()=>{g.current=!1},[]),N=w.useCallback(T=>{if(g.current){const E=window.innerWidth-T.clientX;E>250&&E<window.innerWidth*.8&&h(E)}},[]);w.useEffect(()=>(window.addEventListener("mousemove",N),window.addEventListener("mouseup",v),()=>{window.removeEventListener("mousemove",N),window.removeEventListener("mouseup",v)}),[N,v]);const k=u.map(T=>({...T,links:T.links.filter(E=>E.name.toLowerCase().includes(o.toLowerCase()))})).filter(T=>T.links.length>0);return i.jsxs("div",{className:`side-panel ${r?"open":""}`,style:{width:`${d}px`,right:r?"0":`-${d}px`},children:[i.jsx("div",{className:"resizer",onMouseDown:b}),i.jsxs("div",{className:"side-panel-header",children:[i.jsx(is,{to:"/dashboard",className:"home-button",onClick:a,children:i.jsx(yh,{})}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx(xh,{style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",color:"#94a3b8"}}),i.jsx("input",{type:"text",placeholder:"Search pages...",className:"search-bar",value:o,onChange:T=>f(T.target.value)})]}),i.jsx("button",{className:"close-button",onClick:a,children:""})]}),i.jsx("nav",{children:k.map((T,E)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:T.title}),i.jsx("ul",{className:"sub-page-list",children:T.links.map(I=>{const P=I.icon;return i.jsx("li",{children:i.jsxs(is,{to:I.path,className:l.pathname===I.path?"active":"",onClick:a,children:[P&&i.jsx(P,{})," ",I.name]})},I.path)})})]},E))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx(S_,{})," Logout"]})]})]})},nP=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a,roleNavigation:l})=>{const o=rr(),f=l[t]||[];return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:`mobile-side-panel-overlay ${r?"open":""}`,onClick:a}),i.jsxs("div",{className:`mobile-side-panel ${r?"open":""}`,children:[i.jsxs("div",{className:"mobile-side-panel-header",children:[i.jsx("h3",{children:"Menu"}),i.jsx("button",{className:"close-button",onClick:a,children:""})]}),i.jsx("nav",{children:f.map((u,d)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:u.title}),i.jsx("ul",{className:"sub-page-list",children:u.links.map(h=>{const g=h.icon;return i.jsx("li",{children:i.jsxs(is,{to:h.path,className:o.pathname===h.path?"active":"",onClick:a,children:[g&&i.jsx(g,{})," ",h.name]})},h.path)})})]},d))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx(S_,{})," Logout"]})]})]})]})};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iP=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),rP=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,t,r)=>r?r.toUpperCase():t.toLowerCase()),mS=e=>{const n=rP(e);return n.charAt(0).toUpperCase()+n.slice(1)},N_=(...e)=>e.filter((n,t,r)=>!!n&&n.trim()!==""&&r.indexOf(n)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var aP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sP=w.forwardRef(({color:e="currentColor",size:n=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:a="",children:l,iconNode:o,...f},u)=>w.createElement("svg",{ref:u,...aP,width:n,height:n,stroke:e,strokeWidth:r?Number(t)*24/Number(n):t,className:N_("lucide",a),...f},[...o.map(([d,h])=>w.createElement(d,h)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=(e,n)=>{const t=w.forwardRef(({className:r,...a},l)=>w.createElement(sP,{ref:l,iconNode:n,className:N_(`lucide-${iP(mS(e))}`,`lucide-${e}`,r),...a}));return t.displayName=mS(e),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lP=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],$c=ot("arrow-down",lP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oP=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Lt=ot("arrow-left",oP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cP=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],No=ot("arrow-up",cP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uP=[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]],J1=ot("beaker",uP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dP=[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]],fP=ot("bed-double",dP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hP=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],pP=ot("bell",hP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mP=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}]],gP=ot("bell-ring",mP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yP=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],zv=ot("brain",yP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xP=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],bP=ot("building",xP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vP=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]],wP=ot("calendar-check-2",vP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SP=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],NP=ot("calendar-days",SP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CP=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Ym=ot("calendar",CP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jP=[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]],_P=ot("chart-no-axes-column",jP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kP=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],vb=ot("check",kP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EP=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Hx=ot("chevron-down",EP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TP=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],wb=ot("chevron-left",TP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AP=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],rg=ot("chevron-right",AP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DP=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Bv=ot("chevron-up",DP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ti=ot("circle-alert",PP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IP=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ra=ot("circle-check-big",IP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]],RP=ot("circle-minus",MP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],jo=ot("circle-plus",LP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],FP=ot("circle-user",OP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $P=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],gS=ot("clipboard-list",$P);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zP=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],C_=ot("clipboard",zP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],UP=ot("clock",BP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qP=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],VP=ot("copy",qP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HP=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],j_=ot("credit-card",HP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GP=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Ad=ot("dollar-sign",GP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YP=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],__=ot("eye",YP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WP=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],yS=ot("file-check",WP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QP=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],rs=ot("file-text",QP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JP=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],Gx=ot("flask-conical",JP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KP=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],k_=ot("funnel",KP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XP=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Ed=ot("hash",XP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZP=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],E_=ot("house",ZP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Il=ot("info",eI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tI=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],nI=ot("key",tI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iI=[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]],rI=ot("list-ordered",iI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],sI=ot("list",aI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lI=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Dd=ot("loader-circle",lI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oI=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],xS=ot("lock",oI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cI=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],uI=ot("message-square",cI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dI=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],fI=ot("mic-off",dI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hI=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],T_=ot("mic",hI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pI=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],mI=ot("monitor",pI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gI=[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]],yI=ot("moon",gI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xI=[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]],bI=ot("package-open",xI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vI=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Pd=ot("package",vI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wI=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],SI=ot("paperclip",wI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NI=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],CI=ot("pause",NI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jI=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],_d=ot("pencil",jI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _I=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],kI=ot("phone",_I);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EI=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],To=ot("pill",EI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TI=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],AI=ot("play",TI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DI=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ao=ot("plus",DI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PI=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Rs=ot("printer",PI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const II=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Yx=ot("refresh-cw",II);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MI=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Id=ot("save",MI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RI=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Si=ot("search",RI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LI=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],OI=ot("send",LI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FI=[["path",{d:"M6 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-2",key:"4b9dqc"}],["path",{d:"M6 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-2",key:"22nnkd"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m13 6-4 6h6l-4 6",key:"14hqih"}]],Wx=ot("server-crash",FI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $I=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ag=ot("settings",$I);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zI=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],A_=ot("share-2",zI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BI=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],UI=ot("shield-check",BI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qI=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],VI=ot("shopping-cart",qI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HI=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Md=ot("square-pen",HI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GI=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],YI=ot("stethoscope",GI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WI=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],QI=ot("sun",WI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JI=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],KI=ot("tag",JI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XI=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Ri=ot("trash-2",XI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZI=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],D_=ot("triangle-alert",ZI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eM=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],tM=ot("truck",eM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nM=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],iM=ot("upload",nM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rM=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],P_=ot("user-check",rM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aM=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],I_=ot("user-plus",aM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sM=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Fs=ot("user",sM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lM=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],kh=ot("users",lM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oM=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],cM=ot("video",oM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uM=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],M_=ot("wallet",uM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dM=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Qn=ot("x",dM),fM="_container_djej9_1",hM="_title_djej9_17",pM="_filtersContainer_djej9_31",mM="_dateInputLabel_djej9_55",gM="_dateInput_djej9_55",yM="_fetchButton_djej9_105",xM="_summarySection_djej9_145",bM="_totalRevenue_djej9_153",vM="_totalRevenueAmount_djej9_175",wM="_card_djej9_187",SM="_cardTitle_djej9_203",NM="_cardList_djej9_217",CM="_cardListItem_djej9_227",jM="_cardListItemAmount_djej9_247",_M="_revenueGrid_djej9_257",kM="_revenueCard_djej9_271",EM="_revenueCardTitle_djej9_285",TM="_revenueCardAmount_djej9_297",AM="_revenueCardSubtitle_djej9_307",DM="_receptionRevenue_djej9_317",PM="_pharmacyRevenue_djej9_323",IM="_labRevenue_djej9_329",MM="_revenueCardList_djej9_337",RM="_tableSectionTitle_djej9_377",LM="_tableContainer_djej9_397",OM="_styledTable_djej9_411",FM="_capitalize_djej9_461",$M="_noDataMessage_djej9_469",zM="_errorAlert_djej9_489",BM="_loadingContainer_djej9_521",UM="_breathingBall_djej9_543",wt={container:fM,title:hM,filtersContainer:pM,dateInputLabel:mM,dateInput:gM,fetchButton:yM,summarySection:xM,totalRevenue:bM,totalRevenueAmount:vM,card:wM,cardTitle:SM,cardList:NM,cardListItem:CM,cardListItemAmount:jM,revenueGrid:_M,revenueCard:kM,revenueCardTitle:EM,revenueCardAmount:TM,revenueCardSubtitle:AM,receptionRevenue:DM,pharmacyRevenue:PM,labRevenue:IM,revenueCardList:MM,tableSectionTitle:RM,tableContainer:LM,styledTable:OM,capitalize:FM,noDataMessage:$M,errorAlert:zM,loadingContainer:BM,breathingBall:UM},qM=()=>{const e=new Date().toISOString().split("T")[0],[n,t]=w.useState(e),[r,a]=w.useState(e),[l,o]=w.useState([]),[f,u]=w.useState([]),[d,h]=w.useState([]),[g,b]=w.useState(0),[v,N]=w.useState(0),[k,T]=w.useState(null),[E,I]=w.useState(null),[P,V]=w.useState({reception:{},pharmacy:{},lab:{}}),[F,$]=w.useState(!1),[B,z]=w.useState(null),q=async()=>{if($(!0),z(null),o([]),u([]),h([]),b(0),N(0),T(null),I(null),V({reception:{},pharmacy:{},lab:{}}),!n||!r){z("Please select both start and end dates."),$(!1);return}if(new Date(n)>new Date(r)){z("Start date cannot be after end date."),$(!1);return}try{const[R,G,ee]=await Promise.all([pe(`/api/bills?startDate=${n}&endDate=${r}`),pe(`/api/payment/admission?startDate=${n}&endDate=${r}`),pe(`/api/subscriptions/transactions/manual?startDate=${n}&endDate=${r}`)]);if(!R.ok){const Se=await R.json().catch(()=>({}));throw new Error(`Bills fetch error: ${Se.message||R.statusText}`)}if(!G.ok){const Se=await G.json().catch(()=>({}));throw new Error(`Admission Payments fetch error: ${Se.message||G.statusText}`)}if(!ee.ok){const Se=await ee.json().catch(()=>({}));throw new Error(`Manual Subscriptions fetch error: ${Se.message||ee.statusText}`)}const te=await R.json(),le=await G.json(),K=await ee.json(),U=te.bills||[],J=le.admissionPayments||[],ne=K||[];o(U),u(J),h(ne);let A=0,ae=0;const ce={},M={consultation:0,pharmacy:0,lab:0,other:0},de={reception:{},pharmacy:{},lab:{}};U.forEach(Se=>{if(Se.status==="paid"||Se.type==="pharmacy_return"){const fe=parseFloat(Se.amount.toString()),we=Se.payment_mode||"Unknown";let re=Se.type||"other";re==="pharmacy_return"&&(ae+=fe,re="pharmacy"),A+=fe,ce[we]=(ce[we]||0)+fe,M.hasOwnProperty(re)?M[re]=(M[re]||0)+fe:M.other=(M.other||0)+fe,re==="pharmacy"?de.pharmacy[we]=(de.pharmacy[we]||0)+fe:re==="lab"?de.lab[we]=(de.lab[we]||0)+fe:de.reception[we]=(de.reception[we]||0)+fe}}),J.forEach(Se=>{const fe=parseFloat(Se.amount_paid.toString()),we=Se.payment_mode||"Unknown";A+=fe,ce[we]=(ce[we]||0)+fe,de.reception[we]=(de.reception[we]||0)+fe}),ne.forEach(Se=>{var re,_e;const fe=parseFloat(((_e=(re=Se.subscriptionPlan)==null?void 0:re.price)==null?void 0:_e.toString())??"0"),we=Se.subscription_payment_method||"Unknown";A+=fe,ce[we]=(ce[we]||0)+fe,de.reception[we]=(de.reception[we]||0)+fe}),T(ce),I(M),V(de),b(A),N(ae)}catch(R){console.error("Failed to fetch money flow data:",R),z(R.message||"Failed to fetch data. Check console for details.")}finally{$(!1)}},O=()=>{q()};return i.jsxs("div",{className:wt.container,children:[i.jsx("h2",{className:wt.title,children:"Money Flow Analysis"}),i.jsxs("div",{className:wt.filtersContainer,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"start-date-money",className:wt.dateInputLabel,children:"Start Date:"}),i.jsx("input",{type:"date",id:"start-date-money",value:n,onChange:R=>t(R.target.value),className:wt.dateInput})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"end-date-money",className:wt.dateInputLabel,children:"End Date:"}),i.jsx("input",{type:"date",id:"end-date-money",value:r,onChange:R=>a(R.target.value),className:wt.dateInput})]}),i.jsx("button",{onClick:O,disabled:F,className:wt.fetchButton,children:F?"Loading...":"Fetch Data"})]}),B&&i.jsxs("div",{className:wt.errorAlert,role:"alert",children:[i.jsx(ti,{size:20})," ",i.jsxs("span",{children:["Error: ",B]})]}),!F&&!B&&(l.length>0||f.length>0||d.length>0)&&i.jsxs("div",{className:wt.summarySection,children:[i.jsxs("h3",{className:wt.totalRevenue,children:["Total Paid Revenue (",n," to ",r,"):",i.jsxs("span",{className:wt.totalRevenueAmount,children:["",g.toFixed(2)]})]}),k&&Object.keys(k).length>0&&i.jsxs("div",{className:wt.card,children:[i.jsx("h4",{className:wt.cardTitle,children:"Revenue by Payment Mode:"}),i.jsx("ul",{className:wt.cardList,children:Object.entries(k).map(([R,G])=>i.jsxs("li",{className:wt.cardListItem,children:[R,": ",i.jsxs("span",{className:wt.cardListItemAmount,children:["",G.toFixed(2)]})]},R))})]}),E&&P&&i.jsxs("div",{className:wt.revenueGrid,children:[i.jsxs("div",{className:`${wt.revenueCard} ${wt.receptionRevenue}`,children:[i.jsx("h4",{className:wt.revenueCardTitle,children:"Reception Revenue"}),i.jsxs("p",{className:wt.revenueCardAmount,children:["",(E.consultation+E.other).toFixed(2)]}),i.jsx("span",{className:wt.revenueCardSubtitle,children:"(Consultation + Other + Admissions + Subscriptions)"}),Object.keys(P.reception).length>0&&i.jsx("ul",{className:wt.revenueCardList,children:Object.entries(P.reception).map(([R,G])=>i.jsxs("li",{children:[R,": ",i.jsxs("span",{children:["",G.toFixed(2)]})]},`reception-${R}`))})]}),i.jsxs("div",{className:`${wt.revenueCard} ${wt.pharmacyRevenue}`,children:[i.jsx("h4",{className:wt.revenueCardTitle,children:"Pharmacy Revenue"}),i.jsxs("p",{className:wt.revenueCardAmount,children:["",E.pharmacy.toFixed(2)]}),v<0&&i.jsxs("p",{className:wt.revenueCardSubtitle,children:["Returns: ",i.jsxs("span",{className:wt.negativeAmount,children:["",v.toFixed(2)]})]}),Object.keys(P.pharmacy).length>0&&i.jsx("ul",{className:wt.revenueCardList,children:Object.entries(P.pharmacy).map(([R,G])=>i.jsxs("li",{children:[R,": ",i.jsxs("span",{children:["",G.toFixed(2)]})]},`pharmacy-${R}`))})]}),i.jsxs("div",{className:`${wt.revenueCard} ${wt.labRevenue}`,children:[i.jsx("h4",{className:wt.revenueCardTitle,children:"Lab Revenue"}),i.jsxs("p",{className:wt.revenueCardAmount,children:["",E.lab.toFixed(2)]}),Object.keys(P.lab).length>0&&i.jsx("ul",{className:wt.revenueCardList,children:Object.entries(P.lab).map(([R,G])=>i.jsxs("li",{children:[R,": ",i.jsxs("span",{children:["",G.toFixed(2)]})]},`lab-${R}`))})]})]}),i.jsxs("h4",{className:wt.tableSectionTitle,children:["Individual Bills (",l.filter(R=>R.status==="paid"||R.type==="pharmacy_return").length,"):"]}),l.filter(R=>R.status==="paid"||R.type==="pharmacy_return").length>0?i.jsx("div",{className:wt.tableContainer,children:i.jsxs("table",{className:wt.styledTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Bill ID"}),i.jsx("th",{children:"Patient ID"}),i.jsx("th",{children:"Type"}),i.jsx("th",{children:"Amount"}),i.jsx("th",{children:"Payment Mode"})]})}),i.jsx("tbody",{children:l.filter(R=>R.status==="paid"||R.type==="pharmacy_return").map(R=>i.jsxs("tr",{children:[i.jsx("td",{children:new Date(R.createdAt).toLocaleDateString()}),i.jsx("td",{children:R.id}),i.jsx("td",{children:R.patient_id}),i.jsx("td",{className:wt.capitalize,children:R.type}),i.jsxs("td",{children:["",parseFloat(R.amount.toString()).toFixed(2)]}),i.jsx("td",{children:R.payment_mode})]},`bill-${R.id}`))})]})}):i.jsx("p",{className:wt.noDataMessage,children:"No relevant bills found for the selected period."}),i.jsxs("h4",{className:wt.tableSectionTitle,children:["Admission Payments (",f.length,"):"]}),f.length>0?i.jsx("div",{className:wt.tableContainer,children:i.jsxs("table",{className:wt.styledTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Payment ID"}),i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Payment Mode"})]})}),i.jsx("tbody",{children:f.map(R=>{var G;return i.jsxs("tr",{children:[i.jsx("td",{children:new Date(R.payment_date).toLocaleDateString()}),i.jsx("td",{children:R.id}),i.jsx("td",{children:((G=R.Patient)==null?void 0:G.name)??R.patient_id})," ",i.jsxs("td",{children:["",parseFloat(R.amount_paid.toString()).toFixed(2)]}),i.jsx("td",{children:R.payment_mode})]},`admission-${R.id}`)})})]})}):i.jsx("p",{className:wt.noDataMessage,children:"No admission payments found for the selected period."}),i.jsxs("h4",{className:wt.tableSectionTitle,children:["Manual Subscription Payments (",d.length,"):"]}),d.length>0?i.jsx("div",{className:wt.tableContainer,children:i.jsxs("table",{className:wt.styledTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Start Date"}),i.jsx("th",{children:"Patient ID"}),i.jsx("th",{children:"Patient Name"}),i.jsx("th",{children:"Plan Name"}),i.jsx("th",{children:"Plan Amount"}),i.jsx("th",{children:"Payment Mode"})]})}),i.jsx("tbody",{children:d.map(R=>{var G,ee,te;return i.jsxs("tr",{children:[i.jsx("td",{children:new Date(R.subscription_start_date).toLocaleDateString()}),i.jsx("td",{children:R.id}),i.jsx("td",{children:R.name}),i.jsx("td",{children:((G=R.subscriptionPlan)==null?void 0:G.name)??"N/A"}),i.jsxs("td",{children:["",parseFloat(((te=(ee=R.subscriptionPlan)==null?void 0:ee.price)==null?void 0:te.toString())??"0").toFixed(2)]}),i.jsx("td",{className:wt.capitalize,children:R.subscription_payment_method})]},`sub-patient-${R.id}`)})})]})}):i.jsx("p",{className:wt.noDataMessage,children:"No manual subscription payments found for the selected period."})]}),F&&i.jsxs("div",{className:wt.loadingContainer,children:[i.jsx("div",{className:wt.breathingBall}),i.jsx("p",{children:"Loading data..."})]}),!F&&!B&&l.length===0&&f.length===0&&d.length===0&&i.jsx("p",{className:wt.noDataMessage,children:"No data found for the selected period. Click 'Fetch Data'."})]})},VM=()=>{const e=localStorage.getItem("currentClinicId");return e||(console.warn("getCurrentClinicId: Clinic ID not found. Returning null. Ensure this is implemented correctly."),null)},Qx=()=>localStorage.getItem("authToken"),K1=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!1),[a,l]=w.useState(null),[o,f]=w.useState(!1),[u,d]=w.useState(null),h=w.useRef(null),[g,b]=w.useState(!1),[v,N]=w.useState(null),[k,T]=w.useState(!1),[E,I]=w.useState(!1),[P,V]=w.useState(null),[F,$]=w.useState({name:"",description:"",price:"",default_parameters:[]}),B=w.useCallback(async()=>{r(!0),l(null),d(null),N(null);try{const ce=await pe("/api/lab-tests");if(!ce.ok)throw new Error(`HTTP error! status: ${ce.status}`);const M=await ce.json();n(M)}catch(ce){console.error("Error fetching lab tests:",ce),l(ce.message||"Failed to fetch lab tests.")}finally{r(!1)}},[]);w.useEffect(()=>{B()},[B]);const z=ce=>{const{name:M,value:de}=ce.target;$(Se=>({...Se,[M]:de}))},q=(ce,M,de)=>{const Se=[...F.default_parameters],fe=Se[ce];if(M==="type")switch(fe.type=de,de){case"number":fe.defaultValue=0,fe.lower_limit=null,fe.upper_limit=null,fe.unit="";break;case"boolean":fe.defaultValue=!1,fe.lower_limit=void 0,fe.upper_limit=void 0,fe.unit=void 0;break;case"string":default:fe.defaultValue="",fe.lower_limit=void 0,fe.upper_limit=void 0,fe.unit=void 0;break}else M==="defaultValue"?fe.type==="number"?fe.defaultValue=parseFloat(de)||0:(fe.type,fe.defaultValue=de):M==="lower_limit"||M==="upper_limit"?fe[M]=de===""?null:parseFloat(de):fe[M]=de;$(we=>({...we,default_parameters:Se}))},O=()=>{$(ce=>({...ce,default_parameters:[...ce.default_parameters,{name:"",type:"string",defaultValue:"",unit:"",lower_limit:null,upper_limit:null}]}))},R=ce=>{$(M=>({...M,default_parameters:M.default_parameters.filter((de,Se)=>Se!==ce)}))},G=async ce=>{ce.preventDefault(),r(!0),l(null);const M=P!==null,de=M?`/api/lab-tests/${P}`:"/api/lab-tests",Se=M?"PUT":"POST";try{const fe=await pe(de,{method:Se,headers:{"Content-Type":"application/json"},body:JSON.stringify({name:F.name,description:F.description,price:parseFloat(F.price),default_parameters:F.default_parameters})});if(!fe.ok){const we=await fe.json();throw new Error(we.message||`HTTP error! status: ${fe.status}`)}I(!1),V(null),$({name:"",description:"",price:"",default_parameters:[]}),B()}catch(fe){console.error(`Error ${M?"updating":"adding"} lab test:`,fe),l(fe.message||`Failed to ${M?"update":"add"} lab test.`)}finally{r(!1)}},ee=()=>{V(null),$({name:"",description:"",price:"",default_parameters:[]}),I(!0)},te=ce=>{if(P===ce.id)V(null);else{V(ce.id);const M=(ce.default_parameters||[]).map(de=>({...de,unit:de.unit||"",lower_limit:de.lower_limit===void 0?null:de.lower_limit,upper_limit:de.upper_limit===void 0?null:de.upper_limit}));$({name:ce.name,description:ce.description||"",price:ce.price,default_parameters:M}),I(!1)}},le=async ce=>{if(window.confirm("Are you sure you want to delete this lab test?")){r(!0),l(null);try{const M=await pe(`/api/lab-tests/${ce}`,{method:"DELETE"});if(!M.ok){const de=await M.json();throw new Error(de.message||`HTTP error! status: ${M.status}`)}B()}catch(M){console.error("Error deleting lab test:",M),l(M.message||"Failed to delete lab test.")}finally{r(!1)}}},K=()=>{I(!1),V(null),l(null),$({name:"",description:"",price:"",default_parameters:[]})},U=async ce=>{if(!ce){d("No file selected.");return}f(!0),d(null),l(null);const M=new FormData;M.append("file",ce);try{const de=await pe("/api/lab-tests/import",{method:"POST",body:M});if(!de.ok){const Se=await de.json();throw new Error(Se.message||`Import failed: ${de.statusText}`)}B()}catch(de){console.error("Error importing lab tests from Excel:",de),d(de.message||"Failed to import lab tests from Excel.")}finally{f(!1)}},J=async ce=>{if(ce.target.files&&ce.target.files[0]){const M=ce.target.files[0];await U(M),ce.target&&(ce.target.value="")}},ne=async()=>{if(window.confirm("Are you sure you want to import default biochemistry and pathology tests? This will add new tests and may duplicate existing ones if names match.")){b(!0),N(null),l(null);try{const ce=await pe("/api/lab-tests/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"}});if(!ce.ok){const M=await ce.json();throw new Error(M.message||`Default import failed: ${ce.statusText}`)}B()}catch(ce){console.error("Error importing default lab tests:",ce),N(ce.message||"Failed to import default lab tests.")}finally{b(!1)}}},A=async()=>{if(window.confirm("Are you sure you want to delete ALL lab tests? This action cannot be undone.")){T(!0),l(null),d(null),N(null);try{const ce=await pe("/api/lab-tests/all",{method:"DELETE"});if(!ce.ok){const M=await ce.json();throw new Error(M.message||`Delete all failed: ${ce.statusText}`)}B()}catch(ce){console.error("Error deleting all lab tests:",ce),l(ce.message||"Failed to delete all lab tests.")}finally{T(!1)}}},ae=t||o||g||k;return i.jsxs("div",{className:"lab-inventory-card",children:[i.jsx("h2",{className:"lab-inventory-header",children:"Available Lab Tests"}),i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px"},children:[i.jsx("button",{onClick:ee,className:"lab-inventory-button",disabled:ae,children:"Add New Test"}),i.jsx("button",{onClick:()=>{var ce;return(ce=h.current)==null?void 0:ce.click()},className:"lab-inventory-button lab-inventory-button-secondary",disabled:ae,children:o?"Importing...":"Import from Excel"}),i.jsx("input",{type:"file",ref:h,onChange:J,accept:".xlsx, .xls",style:{display:"none"},disabled:o}),i.jsx("button",{onClick:ne,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ae,children:g?"Importing Defaults...":"Import Default Tests"}),i.jsx("button",{onClick:A,className:"lab-inventory-button lab-inventory-button-danger",disabled:ae,style:{backgroundColor:"#dc3545",borderColor:"#dc3545",color:"white"},children:k?"Deleting All...":"Delete All Tests"})]}),a&&i.jsx("div",{className:"error-text mb-4",children:a}),u&&i.jsxs("div",{className:"error-text mb-4",children:["Import Excel Error: ",u]}),v&&i.jsxs("div",{className:"error-text mb-4",children:["Import Default Error: ",v]}),E&&i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"20px",marginBottom:"20px"},children:[" ",i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"1px solid #eee",marginBottom:"15px"},children:"Add New Lab Test"}),i.jsxs("form",{onSubmit:G,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:F.name,onChange:z,className:"lab-inventory-input",required:!0,disabled:ae})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:F.description,onChange:z,rows:3,className:"lab-inventory-input",disabled:ae})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:F.price,onChange:z,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:ae})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginTop:"20px",marginBottom:"10px"},children:"Default Parameters"}),F.default_parameters.map((ce,M)=>{var de,Se;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:ce.name,onChange:fe=>q(M,"name",fe.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:ce.type,onChange:fe=>q(M,"type",fe.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),ce.type==="boolean"?i.jsxs("select",{value:ce.defaultValue.toString(),onChange:fe=>q(M,"defaultValue",fe.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:ce.type==="number"?"number":"text",placeholder:"Default Value",value:ce.defaultValue.toString(),onChange:fe=>q(M,"defaultValue",fe.target.value),className:"lab-inventory-input"}),ce.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:ce.lower_limit===null?"":((de=ce.lower_limit)==null?void 0:de.toString())??"",onChange:fe=>q(M,"lower_limit",fe.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:ce.upper_limit===null?"":((Se=ce.upper_limit)==null?void 0:Se.toString())??"",onChange:fe=>q(M,"upper_limit",fe.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:ce.unit||"",onChange:fe=>q(M,"unit",fe.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>R(M),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},M)}),i.jsx("button",{type:"button",onClick:O,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:K,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ae,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:ae,children:t?"Saving...":"Add Test"})]})]})]}),ae&&!E&&i.jsxs("p",{className:"loading-text",children:[" ",o?"Importing Excel data...":g?"Importing default data...":"Loading tests..."]}),!ae&&e.length===0&&!a&&!u&&!v&&i.jsx("p",{className:"no-data-message",children:"No lab tests found. Add one or import from Excel to get started."}),!ae&&e.length>0&&i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{className:"hidden md:table-cell",children:"Description"})," ",i.jsx("th",{children:"Price"}),i.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),i.jsx("tbody",{children:e.map(ce=>{const M=P===ce.id,de=ce.price&&typeof ce.price=="string"?parseFloat(ce.price):NaN,Se=isNaN(de)?"0.00":de.toFixed(2);return i.jsxs(En.Fragment,{children:[i.jsxs("tr",{onClick:()=>te(ce),style:{cursor:"pointer"},children:[i.jsx("td",{children:ce.name}),i.jsx("td",{className:"hidden md:table-cell",style:{whiteSpace:"pre-wrap"},children:ce.description||"-"}),i.jsxs("td",{children:["",Se]}),i.jsx("td",{style:{textAlign:"right"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[i.jsx("button",{onClick:fe=>{fe.stopPropagation(),te(ce)},className:"lab-inventory-link",disabled:ae,style:{background:"none",border:"none",padding:"0",cursor:"pointer"},children:"Edit"}),i.jsx("button",{onClick:fe=>{fe.stopPropagation(),le(ce.id)},className:"lab-inventory-link",disabled:ae,style:{background:"none",border:"none",padding:"0",cursor:"pointer",color:"#dc3545"},children:"Delete"})]})})]}),M&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"10px",marginBottom:"10px",border:"1px solid #ddd",padding:"15px"},children:[i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em"},children:"Edit Lab Test"}),i.jsxs("form",{onSubmit:G,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:F.name,onChange:z,className:"lab-inventory-input",required:!0,disabled:ae})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:F.description,onChange:z,rows:3,className:"lab-inventory-input",disabled:ae})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:F.price,onChange:z,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:ae})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",marginTop:"15px"},children:"Default Parameters"}),F.default_parameters.map((fe,we)=>{var re,_e;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:fe.name,onChange:qe=>q(we,"name",qe.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:fe.type,onChange:qe=>q(we,"type",qe.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),fe.type==="boolean"?i.jsxs("select",{value:fe.defaultValue.toString(),onChange:qe=>q(we,"defaultValue",qe.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:fe.type==="number"?"number":"text",placeholder:"Default Value",value:fe.defaultValue.toString(),onChange:qe=>q(we,"defaultValue",qe.target.value),className:"lab-inventory-input"}),fe.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:fe.lower_limit===null?"":((re=fe.lower_limit)==null?void 0:re.toString())??"",onChange:qe=>q(we,"lower_limit",qe.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:fe.upper_limit===null?"":((_e=fe.upper_limit)==null?void 0:_e.toString())??"",onChange:qe=>q(we,"upper_limit",qe.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:fe.unit||"",onChange:qe=>q(we,"unit",qe.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>R(we),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},we)}),i.jsx("button",{type:"button",onClick:O,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:K,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ae,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:ae,children:t?"Saving...":"Update Test"})]})]})]})})})]},ce.id)})})]})]})]})},R_=6048e5,HM=864e5,L_=6e4,O_=36e5,bS=Symbol.for("constructDateFrom");function $s(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&bS in e?e[bS](n):e instanceof Date?new e.constructor(n):new Date(n)}function Cr(e,n){return $s(n||e,e)}function Uv(e,n,t){const r=Cr(e,t==null?void 0:t.in);if(isNaN(n))return $s(e,NaN);if(!n)return r;const a=r.getDate(),l=$s(e,r.getTime());l.setMonth(r.getMonth()+n+1,0);const o=l.getDate();return a>=o?l:(r.setFullYear(l.getFullYear(),l.getMonth(),a),r)}let GM={};function Sb(){return GM}function Wm(e,n){var f,u,d,h;const t=Sb(),r=(n==null?void 0:n.weekStartsOn)??((u=(f=n==null?void 0:n.locale)==null?void 0:f.options)==null?void 0:u.weekStartsOn)??t.weekStartsOn??((h=(d=t.locale)==null?void 0:d.options)==null?void 0:h.weekStartsOn)??0,a=Cr(e,n==null?void 0:n.in),l=a.getDay(),o=(l<r?7:0)+l-r;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function Jx(e,n){return Wm(e,{...n,weekStartsOn:1})}function F_(e,n){const t=Cr(e,n==null?void 0:n.in),r=t.getFullYear(),a=$s(t,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const l=Jx(a),o=$s(t,0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);const f=Jx(o);return t.getTime()>=l.getTime()?r+1:t.getTime()>=f.getTime()?r:r-1}function vS(e){const n=Cr(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function YM(e,...n){const t=$s.bind(null,n.find(r=>typeof r=="object"));return n.map(t)}function wS(e,n){const t=Cr(e,n==null?void 0:n.in);return t.setHours(0,0,0,0),t}function WM(e,n,t){const[r,a]=YM(t==null?void 0:t.in,e,n),l=wS(r),o=wS(a),f=+l-vS(l),u=+o-vS(o);return Math.round((f-u)/HM)}function QM(e,n){const t=F_(e,n),r=$s(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Jx(r)}function JM(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Qm(e){return!(!JM(e)&&typeof e!="number"||isNaN(+Cr(e)))}function KM(e,n){const t=Cr(e,n==null?void 0:n.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}const XM={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},ZM=(e,n,t)=>{let r;const a=XM[e];return typeof a=="string"?r=a:n===1?r=a.one:r=a.other.replace("{{count}}",n.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function B0(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const eR={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},tR={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},nR={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},iR={date:B0({formats:eR,defaultWidth:"full"}),time:B0({formats:tR,defaultWidth:"full"}),dateTime:B0({formats:nR,defaultWidth:"full"})},rR={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},aR=(e,n,t,r)=>rR[e];function Cm(e){return(n,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,f=t!=null&&t.width?String(t.width):o;a=e.formattingValues[f]||e.formattingValues[o]}else{const o=e.defaultWidth,f=t!=null&&t.width?String(t.width):e.defaultWidth;a=e.values[f]||e.values[o]}const l=e.argumentCallback?e.argumentCallback(n):n;return a[l]}}const sR={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},lR={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},oR={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},cR={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},uR={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},dR={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},fR=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},hR={ordinalNumber:fR,era:Cm({values:sR,defaultWidth:"wide"}),quarter:Cm({values:lR,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Cm({values:oR,defaultWidth:"wide"}),day:Cm({values:cR,defaultWidth:"wide"}),dayPeriod:Cm({values:uR,defaultWidth:"wide",formattingValues:dR,defaultFormattingWidth:"wide"})};function jm(e){return(n,t={})=>{const r=t.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],l=n.match(a);if(!l)return null;const o=l[0],f=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(f)?mR(f,g=>g.test(o)):pR(f,g=>g.test(o));let d;d=e.valueCallback?e.valueCallback(u):u,d=t.valueCallback?t.valueCallback(d):d;const h=n.slice(o.length);return{value:d,rest:h}}}function pR(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function mR(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function gR(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const a=r[0],l=n.match(e.parsePattern);if(!l)return null;let o=e.valueCallback?e.valueCallback(l[0]):l[0];o=t.valueCallback?t.valueCallback(o):o;const f=n.slice(a.length);return{value:o,rest:f}}}const yR=/^(\d+)(th|st|nd|rd)?/i,xR=/\d+/i,bR={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},vR={any:[/^b/i,/^(a|c)/i]},wR={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},SR={any:[/1/i,/2/i,/3/i,/4/i]},NR={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},CR={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},jR={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},_R={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},kR={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},ER={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},TR={ordinalNumber:gR({matchPattern:yR,parsePattern:xR,valueCallback:e=>parseInt(e,10)}),era:jm({matchPatterns:bR,defaultMatchWidth:"wide",parsePatterns:vR,defaultParseWidth:"any"}),quarter:jm({matchPatterns:wR,defaultMatchWidth:"wide",parsePatterns:SR,defaultParseWidth:"any",valueCallback:e=>e+1}),month:jm({matchPatterns:NR,defaultMatchWidth:"wide",parsePatterns:CR,defaultParseWidth:"any"}),day:jm({matchPatterns:jR,defaultMatchWidth:"wide",parsePatterns:_R,defaultParseWidth:"any"}),dayPeriod:jm({matchPatterns:kR,defaultMatchWidth:"any",parsePatterns:ER,defaultParseWidth:"any"})},AR={code:"en-US",formatDistance:ZM,formatLong:iR,formatRelative:aR,localize:hR,match:TR,options:{weekStartsOn:0,firstWeekContainsDate:1}};function DR(e,n){const t=Cr(e,n==null?void 0:n.in);return WM(t,KM(t))+1}function PR(e,n){const t=Cr(e,n==null?void 0:n.in),r=+Jx(t)-+QM(t);return Math.round(r/R_)+1}function $_(e,n){var h,g,b,v;const t=Cr(e,n==null?void 0:n.in),r=t.getFullYear(),a=Sb(),l=(n==null?void 0:n.firstWeekContainsDate)??((g=(h=n==null?void 0:n.locale)==null?void 0:h.options)==null?void 0:g.firstWeekContainsDate)??a.firstWeekContainsDate??((v=(b=a.locale)==null?void 0:b.options)==null?void 0:v.firstWeekContainsDate)??1,o=$s((n==null?void 0:n.in)||e,0);o.setFullYear(r+1,0,l),o.setHours(0,0,0,0);const f=Wm(o,n),u=$s((n==null?void 0:n.in)||e,0);u.setFullYear(r,0,l),u.setHours(0,0,0,0);const d=Wm(u,n);return+t>=+f?r+1:+t>=+d?r:r-1}function IR(e,n){var f,u,d,h;const t=Sb(),r=(n==null?void 0:n.firstWeekContainsDate)??((u=(f=n==null?void 0:n.locale)==null?void 0:f.options)==null?void 0:u.firstWeekContainsDate)??t.firstWeekContainsDate??((h=(d=t.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??1,a=$_(e,n),l=$s((n==null?void 0:n.in)||e,0);return l.setFullYear(a,0,r),l.setHours(0,0,0,0),Wm(l,n)}function MR(e,n){const t=Cr(e,n==null?void 0:n.in),r=+Wm(t,n)-+IR(t,n);return Math.round(r/R_)+1}function Pn(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const Rc={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return Pn(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):Pn(t+1,2)},d(e,n){return Pn(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return Pn(e.getHours()%12||12,n.length)},H(e,n){return Pn(e.getHours(),n.length)},m(e,n){return Pn(e.getMinutes(),n.length)},s(e,n){return Pn(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,t-3));return Pn(a,n.length)}},ch={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},SS={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return t.ordinalNumber(a,{unit:"year"})}return Rc.y(e,n)},Y:function(e,n,t,r){const a=$_(e,r),l=a>0?a:1-a;if(n==="YY"){const o=l%100;return Pn(o,2)}return n==="Yo"?t.ordinalNumber(l,{unit:"year"}):Pn(l,n.length)},R:function(e,n){const t=F_(e);return Pn(t,n.length)},u:function(e,n){const t=e.getFullYear();return Pn(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return Pn(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return Pn(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return Rc.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return Pn(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const a=MR(e,r);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):Pn(a,n.length)},I:function(e,n,t){const r=PR(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):Pn(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):Rc.d(e,n)},D:function(e,n,t){const r=DR(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):Pn(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const a=e.getDay(),l=(a-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(l);case"ee":return Pn(l,2);case"eo":return t.ordinalNumber(l,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const a=e.getDay(),l=(a-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(l);case"cc":return Pn(l,n.length);case"co":return t.ordinalNumber(l,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),a=r===0?7:r;switch(n){case"i":return String(a);case"ii":return Pn(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let a;switch(r===12?a=ch.noon:r===0?a=ch.midnight:a=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let a;switch(r>=17?a=ch.evening:r>=12?a=ch.afternoon:r>=4?a=ch.morning:a=ch.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return Rc.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):Rc.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):Pn(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):Pn(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):Rc.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):Rc.s(e,n)},S:function(e,n){return Rc.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return CS(r);case"XXXX":case"XX":return jd(r);case"XXXXX":case"XXX":default:return jd(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return CS(r);case"xxxx":case"xx":return jd(r);case"xxxxx":case"xxx":default:return jd(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+NS(r,":");case"OOOO":default:return"GMT"+jd(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+NS(r,":");case"zzzz":default:return"GMT"+jd(r,":")}},t:function(e,n,t){const r=Math.trunc(+e/1e3);return Pn(r,n.length)},T:function(e,n,t){return Pn(+e,n.length)}};function NS(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),l=r%60;return l===0?t+String(a):t+String(a)+n+Pn(l,2)}function CS(e,n){return e%60===0?(e>0?"-":"+")+Pn(Math.abs(e)/60,2):jd(e,n)}function jd(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Pn(Math.trunc(r/60),2),l=Pn(r%60,2);return t+a+n+l}const jS=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},z_=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},RR=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],a=t[2];if(!a)return jS(e,n);let l;switch(r){case"P":l=n.dateTime({width:"short"});break;case"PP":l=n.dateTime({width:"medium"});break;case"PPP":l=n.dateTime({width:"long"});break;case"PPPP":default:l=n.dateTime({width:"full"});break}return l.replace("{{date}}",jS(r,n)).replace("{{time}}",z_(a,n))},LR={p:z_,P:RR},OR=/^D+$/,FR=/^Y+$/,$R=["D","DD","YY","YYYY"];function zR(e){return OR.test(e)}function BR(e){return FR.test(e)}function UR(e,n,t){const r=qR(e,n,t);if(console.warn(r),$R.includes(e))throw new RangeError(r)}function qR(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const VR=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,HR=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,GR=/^'([^]*?)'?$/,YR=/''/g,WR=/[a-zA-Z]/;function Eh(e,n,t){var h,g,b,v;const r=Sb(),a=r.locale??AR,l=r.firstWeekContainsDate??((g=(h=r.locale)==null?void 0:h.options)==null?void 0:g.firstWeekContainsDate)??1,o=r.weekStartsOn??((v=(b=r.locale)==null?void 0:b.options)==null?void 0:v.weekStartsOn)??0,f=Cr(e,t==null?void 0:t.in);if(!Qm(f))throw new RangeError("Invalid time value");let u=n.match(HR).map(N=>{const k=N[0];if(k==="p"||k==="P"){const T=LR[k];return T(N,a.formatLong)}return N}).join("").match(VR).map(N=>{if(N==="''")return{isToken:!1,value:"'"};const k=N[0];if(k==="'")return{isToken:!1,value:QR(N)};if(SS[k])return{isToken:!0,value:N};if(k.match(WR))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");return{isToken:!1,value:N}});a.localize.preprocessor&&(u=a.localize.preprocessor(f,u));const d={firstWeekContainsDate:l,weekStartsOn:o,locale:a};return u.map(N=>{if(!N.isToken)return N.value;const k=N.value;(BR(k)||zR(k))&&UR(k,n,String(e));const T=SS[k[0]];return T(f,k,a.localize,d)}).join("")}function QR(e){const n=e.match(GR);return n?n[1].replace(YR,"'"):e}function Td(e,n){return+Cr(e)<+Cr(n)}function Kx(e,n){const t=()=>$s(n==null?void 0:n.in,NaN),a=ZR(e);let l;if(a.date){const d=e4(a.date,2);l=t4(d.restDateString,d.year)}if(!l||isNaN(+l))return t();const o=+l;let f=0,u;if(a.time&&(f=n4(a.time),isNaN(f)))return t();if(a.timezone){if(u=i4(a.timezone),isNaN(u))return t()}else{const d=new Date(o+f),h=Cr(0,n==null?void 0:n.in);return h.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),h.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),h}return Cr(o+f+u,n==null?void 0:n.in)}const ux={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},JR=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,KR=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,XR=/^([+-])(\d{2})(?::?(\d{2}))?$/;function ZR(e){const n={},t=e.split(ux.dateTimeDelimiter);let r;if(t.length>2)return n;if(/:/.test(t[0])?r=t[0]:(n.date=t[0],r=t[1],ux.timeZoneDelimiter.test(n.date)&&(n.date=e.split(ux.timeZoneDelimiter)[0],r=e.substr(n.date.length,e.length))),r){const a=ux.timezone.exec(r);a?(n.time=r.replace(a[1],""),n.timezone=a[1]):n.time=r}return n}function e4(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),r=e.match(t);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,l=r[2]?parseInt(r[2]):null;return{year:l===null?a:l*100,restDateString:e.slice((r[1]||r[2]).length)}}function t4(e,n){if(n===null)return new Date(NaN);const t=e.match(JR);if(!t)return new Date(NaN);const r=!!t[4],a=_m(t[1]),l=_m(t[2])-1,o=_m(t[3]),f=_m(t[4]),u=_m(t[5])-1;if(r)return o4(n,f,u)?r4(n,f,u):new Date(NaN);{const d=new Date(0);return!s4(n,l,o)||!l4(n,a)?new Date(NaN):(d.setUTCFullYear(n,l,Math.max(a,o)),d)}}function _m(e){return e?parseInt(e):1}function n4(e){const n=e.match(KR);if(!n)return NaN;const t=U0(n[1]),r=U0(n[2]),a=U0(n[3]);return c4(t,r,a)?t*O_+r*L_+a*1e3:NaN}function U0(e){return e&&parseFloat(e.replace(",","."))||0}function i4(e){if(e==="Z")return 0;const n=e.match(XR);if(!n)return 0;const t=n[1]==="+"?-1:1,r=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return u4(r,a)?t*(r*O_+a*L_):NaN}function r4(e,n,t){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,l=(n-1)*7+t+1-a;return r.setUTCDate(r.getUTCDate()+l),r}const a4=[31,null,31,30,31,30,31,31,30,31,30,31];function B_(e){return e%400===0||e%4===0&&e%100!==0}function s4(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(a4[n]||(B_(e)?29:28))}function l4(e,n){return n>=1&&n<=(B_(e)?366:365)}function o4(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function c4(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function u4(e,n){return n>=0&&n<=59}const _S=10,d4=3,U_=()=>{const e=gt(),[n,t]=w.useState([]),[r,a]=w.useState([]),[l,o]=w.useState(""),[f,u]=w.useState(!0),[d,h]=w.useState(null),[g,b]=w.useState(new Set),[v,N]=w.useState("all"),k=async()=>{try{const se=await pe("/api/inventory/download-csv");if(!se.ok)throw new Error(`Failed to download CSV: ${se.statusText}`);const Q=await se.blob(),ie=window.URL.createObjectURL(Q),je=document.createElement("a");je.href=ie,je.download="pharmacy_inventory.csv",document.body.appendChild(je),je.click(),je.remove(),window.URL.revokeObjectURL(ie)}catch(se){console.error("Failed to download CSV:",se),h(se.message||"Failed to download inventory CSV. Please try again.")}},[T,E]=w.useState(!1),[I,P]=w.useState(!1),[V,F]=w.useState(null),[$,B]=w.useState(!1),[z,q]=w.useState(new Set),[O,R]=w.useState(null),[G,ee]=w.useState(0),[te,le]=w.useState(!1),[K,U]=w.useState(null),[J,ne]=w.useState(1),[A,ae]=w.useState(!1),ce=w.useCallback(async()=>{u(!0),h(null);try{const se=await pe("/api/drugs");if(!se.ok)throw new Error(`Failed to fetch drugs: ${se.statusText} (${se.status})`);let Q=await se.json();Q=Q.map(ie=>({...ie,price:parseFloat(String(ie.price))||0,buying_price:ie.buying_price!==null&&ie.buying_price!==void 0?parseFloat(String(ie.buying_price)):null,quantity_in_stock:parseInt(String(ie.quantity_in_stock),10)||0,gst:ie.gst!==null&&ie.gst!==void 0?parseFloat(String(ie.gst)):null,margin:ie.margin!==null&&ie.margin!==void 0?parseFloat(String(ie.margin)):null,discount:ie.discount!==null&&ie.discount!==void 0?parseFloat(String(ie.discount)):null})),t(Q),a(Q)}catch(se){console.error("Failed to fetch drugs:",se),h(se.message||"Failed to load inventory. Please try again.")}finally{u(!1)}},[]);w.useEffect(()=>{ce()},[ce]),w.useEffect(()=>{const se=l.toLowerCase();let Q=n.filter(Ae=>{var Ke,Fe,at,Qe,yt;const Be=((Ke=Ae.name)==null?void 0:Ke.toLowerCase())||"",st=((Fe=Ae.description)==null?void 0:Fe.toLowerCase())||"",pt=((at=Ae.supplier)==null?void 0:at.toLowerCase())||"",dt=((Qe=Ae.box_number)==null?void 0:Qe.toLowerCase())||"",ze=((yt=Ae.brand_name)==null?void 0:yt.toLowerCase())||"";return Be.includes(se)||st.includes(se)||pt.includes(se)||dt.includes(se)||ze.includes(se)});const ie=new Date,je=Uv(ie,d4);v==="low-stock"?Q=Q.filter(Ae=>Ae.quantity_in_stock<=_S):v==="near-expiry"?Q=Q.filter(Ae=>{if(!Ae.expiry_date)return!1;const Be=Kx(Ae.expiry_date);return Qm(Be)&&Td(Be,je)&&!Td(Be,ie)}):v==="expired"&&(Q=Q.filter(Ae=>{if(!Ae.expiry_date)return!1;const Be=Kx(Ae.expiry_date);return Qm(Be)&&Td(Be,ie)})),a(Q)},[l,n,v]);const M=()=>{E(!1),R(null)},de=se=>{ee(parseInt(se.target.value,10)||0)},Se=async se=>{if(se.preventDefault(),h(null),!O||!O.id||G===0){h("No drug selected or adjustment amount is zero.");return}try{const Q=await pe(`/api/drugs/${O.id}/adjust-stock`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantityChange:G})});if(!Q.ok){const je=await Q.json();throw new Error(je.message||`Failed to adjust stock: ${Q.statusText}`)}const ie=await Q.json();t(je=>je.map(Ae=>Ae.id===ie.id?ie:Ae)),M(),alert(`Stock for "${ie.name}" adjusted successfully. New stock: ${ie.quantity_in_stock}`)}catch(Q){console.error("Failed to adjust stock:",Q),h(Q.message||"Failed to adjust stock. Please try again.")}},fe=se=>{F(se),P(!0)},we=()=>{P(!1),F(null)},re=async()=>{if(!V||!V.id){h("No drug selected for deletion.");return}u(!0),h(null);try{const se=await pe(`/api/drugs/${V.id}`,{method:"DELETE"});if(!se.ok){const Q=await se.json();throw new Error(Q.message||`Failed to delete drug: ${se.statusText}`)}alert(`Drug "${V.name}" deleted successfully.`),ce(),we()}catch(se){console.error("Failed to delete drug:",se),h(se.message||"Failed to delete drug. Please try again.")}finally{u(!1)}},_e=()=>{B(!0)},qe=()=>{B(!1)},[et,Je]=w.useState(!1),Le=()=>{z.size>0&&Je(!0)},xe=()=>{Je(!1)},Me=async()=>{if(z.size===0){h("No drugs selected for deletion.");return}u(!0),h(null);try{const se=await pe("/api/drugs/batch-delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({drugIds:Array.from(z)})});if(!se.ok){const Q=await se.json();throw new Error(Q.message||`Failed to delete selected drugs: ${se.statusText}`)}alert(`${z.size} drug(s) deleted successfully.`),ce(),q(new Set),xe()}catch(se){console.error("Failed to delete selected drugs:",se),h(se.message||"Failed to delete selected drugs. Please try again.")}finally{u(!1)}},ve=async()=>{u(!0),h(null);try{const se=await pe("/api/drugs/all",{method:"DELETE"});if(!se.ok){const Q=await se.json();throw new Error(Q.message||`Failed to delete all drugs: ${se.statusText}`)}alert("All drugs deleted successfully."),ce(),qe()}catch(se){console.error("Failed to delete all drugs:",se),h(se.message||"Failed to delete all drugs. Please try again.")}finally{u(!1)}},Ee=se=>{if(!se)return null;const Q=se.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return Q?parseInt(Q[1],10):null},De=se=>{U(se),ne(1),le(!0)},nt=()=>{le(!1),U(null),ne(1)},lt=se=>{ne(parseInt(se.target.value,10)||0)},Xe=async se=>{if(se.preventDefault(),h(null),!K||!K.id||J<=0){h("No drug selected or invalid number of packs to convert.");return}const Q=Ee(K.unit);if(!Q||Q<=0){h(`Cannot convert "${K.name}" to loose. Invalid pack unit: ${K.unit||"N/A"}.`);return}if(J>(K.quantity_in_stock??0)){h(`Cannot convert ${J} packs. Only ${K.quantity_in_stock??0} packs are in stock.`);return}try{const ie=await pe(`/api/drugs/${K.id}/convert-to-loose`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({packsToConvert:J,packSize:Q})});if(!ie.ok){const Ae=await ie.json();throw new Error(Ae.message||`Failed to convert to loose: ${ie.statusText}`)}const je=await ie.json();t(Ae=>Ae.map(Be=>Be.id===je.id?je:Be)),nt(),alert(`Converted ${J} pack(s) of "${je.name}" to loose. New stock: ${je.quantity_in_stock} packs, ${je.loose??0} loose units.`)}catch(ie){console.error("Failed to convert to loose:",ie),h(ie.message||"Failed to convert to loose. Please try again.")}finally{u(!1)}},Mt=()=>{ae(!0)},_t=()=>{ae(!1)},an=async()=>{u(!0),h(null);try{const se=await pe("/api/drugs/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!se.ok){const Q=await se.json();throw new Error(Q.message||`Failed to add default medications: ${se.statusText}`)}alert("Default medications added successfully."),ce(),_t()}catch(se){console.error("Failed to add default medications:",se),h(se.message||"Failed to add default medications. Please try again.")}finally{u(!1)}};return f?i.jsx("div",{className:"loading-indicator",children:"Loading Inventory..."}):d?i.jsxs("div",{className:"error-indicator",children:["Error: ",d]}):i.jsxs("div",{className:"pharmacy-inventory-page",children:[i.jsxs("div",{className:"inventory-header-controls",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsx("button",{onClick:()=>e(-1),className:"action-icon-button",title:"Go Back",children:i.jsx(Lt,{size:24})}),i.jsx("h2",{className:"inventory-page-title",children:"Pharmacy Inventory"})]}),i.jsxs("div",{className:"inventory-actions-group",children:[i.jsxs("div",{className:"action-group-left",children:[i.jsxs("button",{onClick:()=>e("/dashboard/purchase"),className:"action-button add-drug-button",children:[i.jsx(jo,{size:18,className:"button-icon"}),"Add New Drug"]}),i.jsxs("button",{onClick:()=>e("/dashboard/purchase"),className:"action-button add-purchase-button",children:[i.jsx(jo,{size:18,className:"button-icon"}),"Open Purchase Page"]}),i.jsxs("button",{onClick:()=>e("/dashboard/distributors"),className:"action-button view-distributors-button",children:[i.jsx(jo,{size:18,className:"button-icon"}),"View Distributors"]})]}),i.jsxs("div",{className:"action-group-right",children:[i.jsx("button",{onClick:k,className:"action-button download-csv-button",children:"Download CSV"}),i.jsxs("button",{onClick:Mt,className:"action-button add-defaults-button",children:[i.jsx(jo,{size:18,className:"button-icon"}),"Add Default Medications"]}),i.jsxs("button",{onClick:Le,className:"action-button delete-selected-drugs-button",disabled:z.size===0,children:[i.jsx(Ri,{size:18,className:"button-icon"}),"Delete Selected (",z.size,")"]}),i.jsxs("button",{onClick:_e,className:"action-button delete-all-drugs-button",children:[i.jsx(Ri,{size:18,className:"button-icon"}),"Delete All Drugs"]})]})]})]}),i.jsxs("div",{className:"search-bar-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search drugs by name, brand, description, or supplier...",value:l,onChange:se=>o(se.target.value),className:"inventory-search-input"}),i.jsx(Si,{size:18,className:"search-input-icon"})]}),i.jsxs("div",{className:"filter-dropdown-wrapper",children:[i.jsx("label",{htmlFor:"filter-option",className:"sr-only",children:"Filter Inventory"}),i.jsxs("select",{id:"filter-option",value:v,onChange:se=>N(se.target.value),className:"inventory-filter-select",children:[i.jsx("option",{value:"all",children:"All Drugs"}),i.jsx("option",{value:"low-stock",children:"Low Stock"}),i.jsx("option",{value:"near-expiry",children:"Near Expiry"}),i.jsx("option",{value:"expired",children:"Expired"})]})]})]}),i.jsx("div",{className:"inventory-table-container",children:i.jsxs("table",{className:"inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"checkbox-header",children:i.jsx("input",{type:"checkbox",onChange:se=>{if(se.target.checked){const Q=new Set(r.map(ie=>ie.id));q(Q)}else q(new Set)},checked:z.size===r.length&&r.length>0,disabled:r.length===0})}),i.jsx("th",{className:"drug-name-header",children:"Drug Name"}),i.jsx("th",{className:"brand-name-header",children:"Brand Name"}),i.jsx("th",{className:"pack-header",children:"Pack"}),i.jsx("th",{className:"expiry-header",children:"Expiry"}),i.jsx("th",{className:"text-stock qty-header",children:"Stock"}),i.jsx("th",{className:"text-price mrp-header",children:"MRP"}),i.jsx("th",{className:"text-cost rate-header",children:"Rate"}),i.jsx("th",{className:"box-number-header",children:"Box Number"}),i.jsx("th",{className:"discount-header",children:"Discount (%)"}),i.jsx("th",{className:"margin-header",children:"Margin (%)"}),i.jsx("th",{className:"hidden-loose-price",children:"Loose Price"}),i.jsx("th",{className:"actions-cell",children:"Actions"}),i.jsx("th",{className:"expand-collapse-header"})]})}),i.jsxs("tbody",{children:[r.length===0&&i.jsx("tr",{className:"no-results-message",children:i.jsx("td",{colSpan:15,children:"No drugs found matching your search."})}),r.map(se=>i.jsxs(i.Fragment,{children:[i.jsxs("tr",{className:"drug-row",onClick:()=>{const Q=new Set(g);Q.has(se.id)&&se.id!==void 0?Q.delete(se.id):se.id!==void 0&&Q.add(se.id),b(Q)},children:[i.jsx("td",{className:"checkbox-cell",children:i.jsx("input",{type:"checkbox",onClick:Q=>Q.stopPropagation(),checked:z.has(se.id),onChange:()=>{const Q=new Set(z);Q.has(se.id)?Q.delete(se.id):Q.add(se.id),q(Q)}})}),i.jsx("td",{className:"drug-name-cell",children:se.name||"-"}),i.jsx("td",{className:"brand-name-cell",children:se.brand_name||"-"}),i.jsx("td",{className:"text-muted pack-cell",children:se.unit||"-"}),i.jsx("td",{className:"text-muted",children:se.expiry_date?new Date(se.expiry_date).toLocaleDateString():"-"}),i.jsxs("td",{className:`text-stock ${se.quantity_in_stock<=_S?"low-stock":""}`,children:[i.jsxs("div",{children:[se.quantity_in_stock," packs"]}),i.jsx("div",{className:"loose-quantity",children:se.loose!==null&&se.loose!==void 0?`${se.loose} loose`:""})]}),i.jsxs("td",{className:"text-muted text-price",children:["",typeof se.price=="number"?se.price.toFixed(2):"N/A"]}),i.jsx("td",{className:"text-muted text-cost",children:se.buying_price!==null&&se.buying_price!==void 0?`${se.buying_price.toFixed(2)}`:"-"}),i.jsx("td",{className:"text-muted",children:se.box_number||"-"}),i.jsx("td",{className:"text-muted",children:se.discount!==null&&se.discount!==void 0?`${se.discount.toFixed(2)}%`:"-"}),i.jsx("td",{className:"text-muted",children:(()=>{const Q=se.price||0,ie=se.buying_price||0,je=se.discount||0,Ae=se.gst||0,st=ie*(1-je/100)*(1+Ae/100),pt=Q-st;return`${(Q>0?pt/Q*100:0).toFixed(2)}%`})()}),i.jsx("td",{className:"text-muted hidden-loose-price",children:(()=>{const Q=Ee(se.unit);return Q&&Q>0&&typeof se.price=="number"?`${(se.price/Q).toFixed(2)}`:"N/A"})()}),i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsx("button",{onClick:()=>e(`/dashboard/inventory/edit/${se.id}`),className:"action-icon-button",title:"Edit Drug",children:i.jsx(Md,{size:18})}),i.jsx("button",{onClick:()=>fe(se),className:"action-icon-button delete-button",title:"Delete Drug",children:i.jsx(Ri,{size:18})}),i.jsx("button",{onClick:()=>{R(se),E(!0)},className:"action-icon-button adjust-stock-button",title:"Adjust Stock",children:i.jsx(RP,{size:18})}),i.jsx("button",{onClick:()=>De(se),className:"action-icon-button convert-to-loose-button",title:"Convert to Loose",disabled:!se.unit||Ee(se.unit)===null,children:i.jsx(bI,{size:18})})]})}),i.jsx("td",{className:"expand-collapse-cell",children:g.has(se.id)?i.jsx(Bv,{size:20}):i.jsx(Hx,{size:20})})]},se.id),g.has(se.id)&&i.jsx("tr",{className:"collapsible-row",children:i.jsx("td",{colSpan:15,children:i.jsxs("div",{className:"collapsible-content",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Drug Name:"})," ",se.name||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Description:"})," ",se.description||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Supplier:"})," ",se.supplier||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Brand Name:"})," ",se.brand_name||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Batch:"})," ",se.batch||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"HSN Code:"})," ",se.hsn_code||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"MFG:"})," ",se.mfg||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Loose:"})," ",se.loose!==null&&se.loose!==void 0?se.loose:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Loose Price:"}),(()=>{const Q=Ee(se.unit);return Q&&Q>0&&typeof se.price=="number"?`${(se.price/Q).toFixed(2)}`:"N/A"})()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"GST:"})," ",se.gst!==null&&se.gst!==void 0?`${se.gst.toFixed(2)}%`:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Discount:"})," ",se.discount!==null&&se.discount!==void 0?`${se.discount.toFixed(2)}%`:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Calculated Margin:"}),(()=>{const Q=se.price||0,ie=se.buying_price||0,je=se.discount||0,Ae=se.gst||0,st=ie*(1-je/100)*(1+Ae/100),pt=Q-st;return`${(Q>0?pt/Q*100:0).toFixed(2)}%`})()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Last Updated:"})," ",new Date(se.last_updated).toLocaleString()]})]})})})]}))]})]})}),I&&V&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:we,className:"modal-close-button",children:i.jsx(Qn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion"}),i.jsxs("p",{className:"modal-description",children:['Are you sure you want to delete "',i.jsx("span",{className:"drug-name",children:V.name||"Unnamed Drug"}),'"? This action cannot be undone.']}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:we,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:re,className:"button-delete",children:"Delete"})]})]})}),T&&O&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:M,className:"modal-close-button",children:i.jsx(Qn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Adjust Stock"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:O.name||"Unnamed Drug"}),i.jsx("br",{}),"Current Stock: ",O.quantity_in_stock]}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("form",{onSubmit:Se,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"adjustment",className:"form-label",children:"Adjustment Amount"}),i.jsx("input",{type:"number",name:"adjustment",id:"adjustment",required:!0,step:"1",value:G,onChange:de,placeholder:"e.g., 10 or -5",className:"form-input"}),i.jsx("p",{className:"form-help-text",children:"Enter a positive number to add stock, negative to remove."})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:M,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Adjust Stock"})]})]})]})}),$&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:qe,className:"modal-close-button",children:i.jsx(Qn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of All Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:"ALL"})," drugs from the inventory? This action cannot be undone."]}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:qe,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:ve,className:"button-delete",children:"Delete All"})]})]})}),et&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:xe,className:"modal-close-button",children:i.jsx(Qn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of Selected Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:z.size})," selected drug(s)? This action cannot be undone."]}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:xe,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Me,className:"button-delete",children:"Delete Selected"})]})]})}),te&&K&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:nt,className:"modal-close-button",children:i.jsx(Qn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Convert Pack to Loose"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:K.name||"Unnamed Drug"}),i.jsx("br",{}),"Current Packs in Stock: ",K.quantity_in_stock??0,i.jsx("br",{}),"Current Loose Units: ",K.loose??0,i.jsx("br",{}),"Pack Size: ",Ee(K.unit)||"N/A"," units per pack"]}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("form",{onSubmit:Xe,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"packs-to-convert",className:"form-label",children:"Number of Packs to Convert"}),i.jsx("input",{type:"number",name:"packs-to-convert",id:"packs-to-convert",required:!0,min:"1",step:"1",value:J,onChange:lt,placeholder:"e.g., 1",className:"form-input"}),i.jsxs("p",{className:"form-help-text",children:["This will reduce pack quantity by ",J," and add ",J*(Ee(K.unit)||0)," to loose quantity."]})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:nt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Convert to Loose"})]})]})]})}),A&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:_t,className:"modal-close-button",children:i.jsx(Qn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Add Default Medications"}),i.jsx("p",{className:"modal-description",children:"Are you sure you want to add default medications to the inventory? This will add a predefined set of common medications."}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:_t,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:an,className:"button-submit",children:"Add Defaults"})]})]})})]})},f4="_container_1ihgb_1",h4="_title_1ihgb_17",p4="_dateRangeContainer_1ihgb_31",m4="_dateInputLabel_1ihgb_51",g4="_dateInput_1ihgb_51",y4="_fetchButton_1ihgb_87",x4="_sectionTitle_1ihgb_123",b4="_tableContainer_1ihgb_137",v4="_analysisTable_1ihgb_153",w4="_textRight_1ihgb_217",S4="_textGreen_1ihgb_225",N4="_textRed_1ihgb_233",C4="_textOrange_1ihgb_249",j4="_alertBox_1ihgb_265",_4="_alertBoxError_1ihgb_283",k4="_alertBoxIcon_1ihgb_295",E4="_loadingContainer_1ihgb_303",T4="_viewSwitcher_1ihgb_321",A4="_viewButton_1ihgb_339",D4="_viewButtonActive_1ihgb_365",P4="_viewButtonInactive_1ihgb_383",I4="_reasonDistribution_1ihgb_497",M4="_totalRow_1ihgb_513",Bt={container:f4,title:h4,dateRangeContainer:p4,dateInputLabel:m4,dateInput:g4,fetchButton:y4,sectionTitle:x4,tableContainer:b4,analysisTable:v4,textRight:w4,textGreen:S4,textRed:N4,textOrange:C4,alertBox:j4,alertBoxError:_4,alertBoxIcon:k4,loadingContainer:E4,viewSwitcher:T4,viewButton:A4,viewButtonActive:D4,viewButtonInactive:P4,reasonDistribution:I4,totalRow:M4},qv=()=>{const e=gt(),n=new Date().toISOString().split("T")[0],[t,r]=w.useState(n),[a,l]=w.useState(n),[o,f]=w.useState(null),[u,d]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState("analysis"),N=async()=>{if(d(!0),g(null),f(null),!t||!a){g("Please select both start and end dates."),d(!1);return}if(new Date(t)>new Date(a)){g("Start date cannot be after end date."),d(!1);return}try{const E=VM();if(!E){g("Clinic ID not found. Please log in again."),d(!1);return}const I=await pe(`/api/inventory/comprehensive-analysis?startDate=${t}&endDate=${a}&clinicId=${E}`);if(!I.ok){const V=await I.json();throw new Error(V.message||`HTTP error! status: ${I.status}`)}const P=await I.json();f(P)}catch(E){console.error("Failed to fetch comprehensive inventory analysis data:",E),g(E.message||"Failed to fetch data. Check console for details.")}finally{d(!1)}},k=()=>{N()},T=E=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(E);return i.jsxs("div",{className:Bt.container,children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[" ",i.jsx("h2",{className:Bt.title,children:"Inventory Analysis & Management"}),i.jsx("button",{onClick:()=>e(-1),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 text-sm",children:"Back"})]}),i.jsxs("div",{className:Bt.viewSwitcher,children:[i.jsxs("button",{onClick:()=>v("analysis"),className:`${Bt.viewButton} ${b==="analysis"?Bt.viewButtonActive:Bt.viewButtonInactive}`,children:[i.jsx(_P,{size:16})," ","Analysis"]}),i.jsxs("button",{onClick:()=>v("labInventory"),className:`${Bt.viewButton} ${b==="labInventory"?Bt.viewButtonActive:Bt.viewButtonInactive}`,children:[i.jsx(J1,{size:16}),"Lab Test Inventory"]}),i.jsxs("button",{onClick:()=>e("/dashboard/inventory"),className:`${Bt.viewButton} ${b==="pharmacyInventory"?Bt.viewButtonActive:Bt.viewButtonInactive}`,children:[i.jsx(To,{size:16}),"Pharmacy Inventory"]})]}),b==="analysis"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:Bt.dateRangeContainer,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"start-date-inventory",className:Bt.dateInputLabel,children:"Start Date:"}),i.jsx("input",{type:"date",id:"start-date-inventory",value:t,onChange:E=>r(E.target.value),className:Bt.dateInput})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"end-date-inventory",className:Bt.dateInputLabel,children:"End Date:"}),i.jsx("input",{type:"date",id:"end-date-inventory",value:a,onChange:E=>l(E.target.value),className:Bt.dateInput})]}),i.jsx("button",{onClick:k,disabled:u,className:Bt.fetchButton,children:u?"Loading...":"Fetch Comprehensive Analysis"})]}),h&&i.jsxs("div",{className:`${Bt.alertBox} ${Bt.alertBoxError}`,role:"alert",children:[i.jsx("div",{className:Bt.alertBoxIcon,children:i.jsx(ti,{size:18})}),i.jsxs("div",{children:[" ",i.jsxs("span",{children:["Error: ",h]})]})]}),u&&i.jsxs("div",{className:Bt.loadingContainer,children:[" ",i.jsx("p",{children:"Loading data..."})]}),o&&!u&&i.jsxs("div",{className:"space-y-6",children:[" ",i.jsxs("div",{children:[i.jsxs("h3",{className:Bt.sectionTitle,children:["Pharmacy Inventory Changes (",o.startDate," to ",o.endDate,")"]}),o.pharmacyAnalysis.length>0?i.jsx("div",{className:Bt.tableContainer,children:i.jsxs("table",{className:Bt.analysisTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Drug Name"}),i.jsx("th",{children:"Unit"}),i.jsx("th",{className:Bt.textRight,children:"Price"}),i.jsx("th",{children:"Qty In (+)"}),i.jsx("th",{className:Bt.textRight,children:"Packs Out (-)"}),i.jsx("th",{className:Bt.textRight,children:"Loose Qty Out (-)"}),i.jsx("th",{className:Bt.textRight,children:"Packs Converted"})]})}),i.jsx("tbody",{children:o.pharmacyAnalysis.map(E=>i.jsxs("tr",{children:[i.jsx("td",{children:E.name}),i.jsx("td",{children:E.unit||"N/A"}),i.jsx("td",{className:Bt.textRight,children:T(E.price)}),i.jsxs("td",{className:Bt.textGreen,children:[" ",i.jsxs("div",{className:Bt.reasonDistribution,children:[Object.entries(E.quantity_in_by_reason).map(([I,P])=>i.jsxs("div",{children:[i.jsxs("span",{children:[I,":"]}),i.jsx("span",{children:P})]},I)),Object.keys(E.quantity_in_by_reason).length>0&&i.jsxs("div",{className:Bt.totalRow,children:[i.jsx("span",{children:"Total:"}),i.jsx("span",{children:E.quantity_in})]})]})]}),i.jsxs("td",{className:Bt.textRed,children:[" ",i.jsxs("div",{className:Bt.reasonDistribution,children:[Object.entries(E.quantity_out_by_reason||{}).map(([I,P])=>i.jsxs("div",{children:[i.jsxs("span",{children:[I,":"]}),i.jsx("span",{children:P})]},I)),Object.keys(E.quantity_out_by_reason||{}).length>0&&i.jsxs("div",{className:Bt.totalRow,children:[i.jsx("span",{children:"Total:"}),i.jsx("span",{children:E.quantity_out})]}),(!E.quantity_out_by_reason||Object.keys(E.quantity_out_by_reason).length===0)&&i.jsx("div",{className:Bt.textRight,children:E.quantity_out})]})]}),i.jsx("td",{className:`${Bt.textRed} ${Bt.textRight}`,children:E.loose_quantity_out}),i.jsx("td",{className:`${Bt.textOrange} ${Bt.textRight}`,children:E.quantity_converted})]},E.drug_id))})]})}):i.jsx("p",{className:"text-gray-500",children:"No pharmacy inventory changes found for the selected period."})]})]})]}),b==="labInventory"&&i.jsxs("div",{className:"mt-4",children:[" ",i.jsx(K1,{})]}),b==="pharmacyInventory"&&i.jsxs("div",{className:"mt-4",children:[" ",i.jsx(U_,{})]})]})};var q0,kS;function R4(){if(kS)return q0;kS=1;var e="Expected a function",n=NaN,t="[object Symbol]",r=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,o=/^0o[0-7]+$/i,f=parseInt,u=typeof Uc=="object"&&Uc&&Uc.Object===Object&&Uc,d=typeof self=="object"&&self&&self.Object===Object&&self,h=u||d||Function("return this")(),g=Object.prototype,b=g.toString,v=Math.max,N=Math.min,k=function(){return h.Date.now()};function T(F,$,B){var z,q,O,R,G,ee,te=0,le=!1,K=!1,U=!0;if(typeof F!="function")throw new TypeError(e);$=V($)||0,E(B)&&(le=!!B.leading,K="maxWait"in B,O=K?v(V(B.maxWait)||0,$):O,U="trailing"in B?!!B.trailing:U);function J(we){var re=z,_e=q;return z=q=void 0,te=we,R=F.apply(_e,re),R}function ne(we){return te=we,G=setTimeout(ce,$),le?J(we):R}function A(we){var re=we-ee,_e=we-te,qe=$-re;return K?N(qe,O-_e):qe}function ae(we){var re=we-ee,_e=we-te;return ee===void 0||re>=$||re<0||K&&_e>=O}function ce(){var we=k();if(ae(we))return M(we);G=setTimeout(ce,A(we))}function M(we){return G=void 0,U&&z?J(we):(z=q=void 0,R)}function de(){G!==void 0&&clearTimeout(G),te=0,z=ee=q=G=void 0}function Se(){return G===void 0?R:M(k())}function fe(){var we=k(),re=ae(we);if(z=arguments,q=this,ee=we,re){if(G===void 0)return ne(ee);if(K)return G=setTimeout(ce,$),J(ee)}return G===void 0&&(G=setTimeout(ce,$)),R}return fe.cancel=de,fe.flush=Se,fe}function E(F){var $=typeof F;return!!F&&($=="object"||$=="function")}function I(F){return!!F&&typeof F=="object"}function P(F){return typeof F=="symbol"||I(F)&&b.call(F)==t}function V(F){if(typeof F=="number")return F;if(P(F))return n;if(E(F)){var $=typeof F.valueOf=="function"?F.valueOf():F;F=E($)?$+"":$}if(typeof F!="string")return F===0?F:+F;F=F.replace(r,"");var B=l.test(F);return B||o.test(F)?f(F.slice(2),B?2:8):a.test(F)?n:+F}return q0=T,q0}var L4=R4();const Nb=Fd(L4),X1=async()=>{const e=await pe("/api/clinic-subscriptions/plans",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription plans")}return e.json()},O4=async e=>{const n=await pe(`/api/clinic-subscriptions/cancel/${e}`,{method:"PUT"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to cancel clinic subscription")}return n.json()},F4=async e=>{const n=await pe(`/api/clinics/${e}/subscription-status`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||`Failed to fetch subscription status for clinic ${e}`)}return n.json()},$4=async e=>{const n=await pe(`/api/clinic-subscriptions/plans/${e}`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to fetch clinic subscription plan")}return n.json()},z4=async e=>{const n=await pe("/api/clinic-subscriptions/plans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to create clinic subscription plan")}return n.json()},B4=async(e,n)=>{const t=await pe(`/api/clinic-subscriptions/plans/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Failed to update clinic subscription plan")}return t.json()},U4=async e=>{const n=await pe(`/api/clinic-subscriptions/plans/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to deactivate clinic subscription plan")}return n.json()},q4=async e=>{const n=await pe("/api/clinic-subscriptions/initiate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:e})});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to initiate clinic subscription")}return n.json()},V4=async()=>{try{const e=await pe("/api/clinic-subscriptions/pending",{method:"GET"});return e.ok?e.json():null}catch(e){return console.error("Error checking for pending subscription:",e),null}},q_=async()=>{const e=await pe("/api/clinics/subscription-status",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription status")}return e.json()};var V0={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var ES;function H4(){return ES||(ES=1,function(e){(function(){var n={}.hasOwnProperty;function t(){for(var l="",o=0;o<arguments.length;o++){var f=arguments[o];f&&(l=a(l,r(f)))}return l}function r(l){if(typeof l=="string"||typeof l=="number")return l;if(typeof l!="object")return"";if(Array.isArray(l))return t.apply(null,l);if(l.toString!==Object.prototype.toString&&!l.toString.toString().includes("[native code]"))return l.toString();var o="";for(var f in l)n.call(l,f)&&l[f]&&(o=a(o,f));return o}function a(l,o){return o?l?l+" "+o:l+o:l}e.exports?(t.default=t,e.exports=t):window.classNames=t})()}(V0)),V0.exports}var G4=H4();const qc=Fd(G4);function Rd(e){"@babel/helpers - typeof";return Rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Rd(e)}function Y4(e,n){if(Rd(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(Rd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function V_(e){var n=Y4(e,"string");return Rd(n)=="symbol"?n:n+""}function Om(e,n,t){return(n=V_(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function TS(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function Ct(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?TS(Object(t),!0).forEach(function(r){Om(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):TS(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function W4(e){if(Array.isArray(e))return e}function Q4(e,n){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var r,a,l,o,f=[],u=!0,d=!1;try{if(l=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;u=!1}else for(;!(u=(r=l.call(t)).done)&&(f.push(r.value),f.length!==n);u=!0);}catch(h){d=!0,a=h}finally{try{if(!u&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(d)throw a}}return f}}function Vv(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function H_(e,n){if(e){if(typeof e=="string")return Vv(e,n);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Vv(e,n):void 0}}function J4(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ko(e,n){return W4(e)||Q4(e,n)||H_(e,n)||J4()}function K4(e,n){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(n.indexOf(r)!==-1)continue;t[r]=e[r]}return t}function Io(e,n){if(e==null)return{};var t,r,a=K4(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var X4=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function Z4(e){var n=e.defaultInputValue,t=n===void 0?"":n,r=e.defaultMenuIsOpen,a=r===void 0?!1:r,l=e.defaultValue,o=l===void 0?null:l,f=e.inputValue,u=e.menuIsOpen,d=e.onChange,h=e.onInputChange,g=e.onMenuClose,b=e.onMenuOpen,v=e.value,N=Io(e,X4),k=w.useState(f!==void 0?f:t),T=ko(k,2),E=T[0],I=T[1],P=w.useState(u!==void 0?u:a),V=ko(P,2),F=V[0],$=V[1],B=w.useState(v!==void 0?v:o),z=ko(B,2),q=z[0],O=z[1],R=w.useCallback(function(J,ne){typeof d=="function"&&d(J,ne),O(J)},[d]),G=w.useCallback(function(J,ne){var A;typeof h=="function"&&(A=h(J,ne)),I(A!==void 0?A:J)},[h]),ee=w.useCallback(function(){typeof b=="function"&&b(),$(!0)},[b]),te=w.useCallback(function(){typeof g=="function"&&g(),$(!1)},[g]),le=f!==void 0?f:E,K=u!==void 0?u:F,U=v!==void 0?v:q;return Ct(Ct({},N),{},{inputValue:le,menuIsOpen:K,onChange:R,onInputChange:G,onMenuClose:te,onMenuOpen:ee,value:U})}function Tt(){return Tt=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Tt.apply(null,arguments)}function eL(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function AS(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,V_(r.key),r)}}function tL(e,n,t){return n&&AS(e.prototype,n),t&&AS(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hv(e,n){return Hv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Hv(e,n)}function nL(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&Hv(e,n)}function Xx(e){return Xx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Xx(e)}function G_(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(G_=function(){return!!e})()}function iL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rL(e,n){if(n&&(Rd(n)=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iL(e)}function aL(e){var n=G_();return function(){var t,r=Xx(e);if(n){var a=Xx(this).constructor;t=Reflect.construct(r,arguments,a)}else t=r.apply(this,arguments);return rL(this,t)}}function sL(e){if(Array.isArray(e))return Vv(e)}function lL(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function oL(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Z1(e){return sL(e)||lL(e)||H_(e)||oL()}function cL(e){if(e.sheet)return e.sheet;for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].ownerNode===e)return document.styleSheets[n]}function uL(e){var n=document.createElement("style");return n.setAttribute("data-emotion",e.key),e.nonce!==void 0&&n.setAttribute("nonce",e.nonce),n.appendChild(document.createTextNode("")),n.setAttribute("data-s",""),n}var dL=function(){function e(t){var r=this;this._insertTag=function(a){var l;r.tags.length===0?r.insertionPoint?l=r.insertionPoint.nextSibling:r.prepend?l=r.container.firstChild:l=r.before:l=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(a,l),r.tags.push(a)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var n=e.prototype;return n.hydrate=function(r){r.forEach(this._insertTag)},n.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(uL(this));var a=this.tags[this.tags.length-1];if(this.isSpeedy){var l=cL(a);try{l.insertRule(r,l.cssRules.length)}catch{}}else a.appendChild(document.createTextNode(r));this.ctr++},n.flush=function(){this.tags.forEach(function(r){var a;return(a=r.parentNode)==null?void 0:a.removeChild(r)}),this.tags=[],this.ctr=0},e}(),wr="-ms-",Zx="-moz-",wn="-webkit-",Y_="comm",ew="rule",tw="decl",fL="@import",W_="@keyframes",hL="@layer",pL=Math.abs,Cb=String.fromCharCode,mL=Object.assign;function gL(e,n){return ir(e,0)^45?(((n<<2^ir(e,0))<<2^ir(e,1))<<2^ir(e,2))<<2^ir(e,3):0}function Q_(e){return e.trim()}function yL(e,n){return(e=n.exec(e))?e[0]:e}function Sn(e,n,t){return e.replace(n,t)}function Gv(e,n){return e.indexOf(n)}function ir(e,n){return e.charCodeAt(n)|0}function Jm(e,n,t){return e.slice(n,t)}function Al(e){return e.length}function nw(e){return e.length}function dx(e,n){return n.push(e),e}function xL(e,n){return e.map(n).join("")}var jb=1,Th=1,J_=0,ra=0,Ai=0,Oh="";function _b(e,n,t,r,a,l,o){return{value:e,root:n,parent:t,type:r,props:a,children:l,line:jb,column:Th,length:o,return:""}}function km(e,n){return mL(_b("",null,null,"",null,null,0),e,{length:-e.length},n)}function bL(){return Ai}function vL(){return Ai=ra>0?ir(Oh,--ra):0,Th--,Ai===10&&(Th=1,jb--),Ai}function Ia(){return Ai=ra<J_?ir(Oh,ra++):0,Th++,Ai===10&&(Th=1,jb++),Ai}function Rl(){return ir(Oh,ra)}function Mx(){return ra}function sg(e,n){return Jm(Oh,e,n)}function Km(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function K_(e){return jb=Th=1,J_=Al(Oh=e),ra=0,[]}function X_(e){return Oh="",e}function Rx(e){return Q_(sg(ra-1,Yv(e===91?e+2:e===40?e+1:e)))}function wL(e){for(;(Ai=Rl())&&Ai<33;)Ia();return Km(e)>2||Km(Ai)>3?"":" "}function SL(e,n){for(;--n&&Ia()&&!(Ai<48||Ai>102||Ai>57&&Ai<65||Ai>70&&Ai<97););return sg(e,Mx()+(n<6&&Rl()==32&&Ia()==32))}function Yv(e){for(;Ia();)switch(Ai){case e:return ra;case 34:case 39:e!==34&&e!==39&&Yv(Ai);break;case 40:e===41&&Yv(e);break;case 92:Ia();break}return ra}function NL(e,n){for(;Ia()&&e+Ai!==57;)if(e+Ai===84&&Rl()===47)break;return"/*"+sg(n,ra-1)+"*"+Cb(e===47?e:Ia())}function CL(e){for(;!Km(Rl());)Ia();return sg(e,ra)}function jL(e){return X_(Lx("",null,null,null,[""],e=K_(e),0,[0],e))}function Lx(e,n,t,r,a,l,o,f,u){for(var d=0,h=0,g=o,b=0,v=0,N=0,k=1,T=1,E=1,I=0,P="",V=a,F=l,$=r,B=P;T;)switch(N=I,I=Ia()){case 40:if(N!=108&&ir(B,g-1)==58){Gv(B+=Sn(Rx(I),"&","&\f"),"&\f")!=-1&&(E=-1);break}case 34:case 39:case 91:B+=Rx(I);break;case 9:case 10:case 13:case 32:B+=wL(N);break;case 92:B+=SL(Mx()-1,7);continue;case 47:switch(Rl()){case 42:case 47:dx(_L(NL(Ia(),Mx()),n,t),u);break;default:B+="/"}break;case 123*k:f[d++]=Al(B)*E;case 125*k:case 59:case 0:switch(I){case 0:case 125:T=0;case 59+h:E==-1&&(B=Sn(B,/\f/g,"")),v>0&&Al(B)-g&&dx(v>32?PS(B+";",r,t,g-1):PS(Sn(B," ","")+";",r,t,g-2),u);break;case 59:B+=";";default:if(dx($=DS(B,n,t,d,h,a,f,P,V=[],F=[],g),l),I===123)if(h===0)Lx(B,n,$,$,V,l,g,f,F);else switch(b===99&&ir(B,3)===110?100:b){case 100:case 108:case 109:case 115:Lx(e,$,$,r&&dx(DS(e,$,$,0,0,a,f,P,a,V=[],g),F),a,F,g,f,r?V:F);break;default:Lx(B,$,$,$,[""],F,0,f,F)}}d=h=v=0,k=E=1,P=B="",g=o;break;case 58:g=1+Al(B),v=N;default:if(k<1){if(I==123)--k;else if(I==125&&k++==0&&vL()==125)continue}switch(B+=Cb(I),I*k){case 38:E=h>0?1:(B+="\f",-1);break;case 44:f[d++]=(Al(B)-1)*E,E=1;break;case 64:Rl()===45&&(B+=Rx(Ia())),b=Rl(),h=g=Al(P=B+=CL(Mx())),I++;break;case 45:N===45&&Al(B)==2&&(k=0)}}return l}function DS(e,n,t,r,a,l,o,f,u,d,h){for(var g=a-1,b=a===0?l:[""],v=nw(b),N=0,k=0,T=0;N<r;++N)for(var E=0,I=Jm(e,g+1,g=pL(k=o[N])),P=e;E<v;++E)(P=Q_(k>0?b[E]+" "+I:Sn(I,/&\f/g,b[E])))&&(u[T++]=P);return _b(e,n,t,a===0?ew:f,u,d,h)}function _L(e,n,t){return _b(e,n,t,Y_,Cb(bL()),Jm(e,2,-2),0)}function PS(e,n,t,r){return _b(e,n,t,tw,Jm(e,0,r),Jm(e,r+1,-1),r)}function Sh(e,n){for(var t="",r=nw(e),a=0;a<r;a++)t+=n(e[a],a,e,n)||"";return t}function kL(e,n,t,r){switch(e.type){case hL:if(e.children.length)break;case fL:case tw:return e.return=e.return||e.value;case Y_:return"";case W_:return e.return=e.value+"{"+Sh(e.children,r)+"}";case ew:e.value=e.props.join(",")}return Al(t=Sh(e.children,r))?e.return=e.value+"{"+t+"}":""}function EL(e){var n=nw(e);return function(t,r,a,l){for(var o="",f=0;f<n;f++)o+=e[f](t,r,a,l)||"";return o}}function TL(e){return function(n){n.root||(n=n.return)&&e(n)}}function AL(e){var n=Object.create(null);return function(t){return n[t]===void 0&&(n[t]=e(t)),n[t]}}var DL=function(n,t,r){for(var a=0,l=0;a=l,l=Rl(),a===38&&l===12&&(t[r]=1),!Km(l);)Ia();return sg(n,ra)},PL=function(n,t){var r=-1,a=44;do switch(Km(a)){case 0:a===38&&Rl()===12&&(t[r]=1),n[r]+=DL(ra-1,t,r);break;case 2:n[r]+=Rx(a);break;case 4:if(a===44){n[++r]=Rl()===58?"&\f":"",t[r]=n[r].length;break}default:n[r]+=Cb(a)}while(a=Ia());return n},IL=function(n,t){return X_(PL(K_(n),t))},IS=new WeakMap,ML=function(n){if(!(n.type!=="rule"||!n.parent||n.length<1)){for(var t=n.value,r=n.parent,a=n.column===r.column&&n.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(n.props.length===1&&t.charCodeAt(0)!==58&&!IS.get(r))&&!a){IS.set(n,!0);for(var l=[],o=IL(t,l),f=r.props,u=0,d=0;u<o.length;u++)for(var h=0;h<f.length;h++,d++)n.props[d]=l[u]?o[u].replace(/&\f/g,f[h]):f[h]+" "+o[u]}}},RL=function(n){if(n.type==="decl"){var t=n.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(n.return="",n.value="")}};function Z_(e,n){switch(gL(e,n)){case 5103:return wn+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return wn+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return wn+e+Zx+e+wr+e+e;case 6828:case 4268:return wn+e+wr+e+e;case 6165:return wn+e+wr+"flex-"+e+e;case 5187:return wn+e+Sn(e,/(\w+).+(:[^]+)/,wn+"box-$1$2"+wr+"flex-$1$2")+e;case 5443:return wn+e+wr+"flex-item-"+Sn(e,/flex-|-self/,"")+e;case 4675:return wn+e+wr+"flex-line-pack"+Sn(e,/align-content|flex-|-self/,"")+e;case 5548:return wn+e+wr+Sn(e,"shrink","negative")+e;case 5292:return wn+e+wr+Sn(e,"basis","preferred-size")+e;case 6060:return wn+"box-"+Sn(e,"-grow","")+wn+e+wr+Sn(e,"grow","positive")+e;case 4554:return wn+Sn(e,/([^-])(transform)/g,"$1"+wn+"$2")+e;case 6187:return Sn(Sn(Sn(e,/(zoom-|grab)/,wn+"$1"),/(image-set)/,wn+"$1"),e,"")+e;case 5495:case 3959:return Sn(e,/(image-set\([^]*)/,wn+"$1$`$1");case 4968:return Sn(Sn(e,/(.+:)(flex-)?(.*)/,wn+"box-pack:$3"+wr+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+wn+e+e;case 4095:case 3583:case 4068:case 2532:return Sn(e,/(.+)-inline(.+)/,wn+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Al(e)-1-n>6)switch(ir(e,n+1)){case 109:if(ir(e,n+4)!==45)break;case 102:return Sn(e,/(.+:)(.+)-([^]+)/,"$1"+wn+"$2-$3$1"+Zx+(ir(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~Gv(e,"stretch")?Z_(Sn(e,"stretch","fill-available"),n)+e:e}break;case 4949:if(ir(e,n+1)!==115)break;case 6444:switch(ir(e,Al(e)-3-(~Gv(e,"!important")&&10))){case 107:return Sn(e,":",":"+wn)+e;case 101:return Sn(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+wn+(ir(e,14)===45?"inline-":"")+"box$3$1"+wn+"$2$3$1"+wr+"$2box$3")+e}break;case 5936:switch(ir(e,n+11)){case 114:return wn+e+wr+Sn(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return wn+e+wr+Sn(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return wn+e+wr+Sn(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return wn+e+wr+e+e}return e}var LL=function(n,t,r,a){if(n.length>-1&&!n.return)switch(n.type){case tw:n.return=Z_(n.value,n.length);break;case W_:return Sh([km(n,{value:Sn(n.value,"@","@"+wn)})],a);case ew:if(n.length)return xL(n.props,function(l){switch(yL(l,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Sh([km(n,{props:[Sn(l,/:(read-\w+)/,":"+Zx+"$1")]})],a);case"::placeholder":return Sh([km(n,{props:[Sn(l,/:(plac\w+)/,":"+wn+"input-$1")]}),km(n,{props:[Sn(l,/:(plac\w+)/,":"+Zx+"$1")]}),km(n,{props:[Sn(l,/:(plac\w+)/,wr+"input-$1")]})],a)}return""})}},OL=[LL],FL=function(n){var t=n.key;if(t==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(k){var T=k.getAttribute("data-emotion");T.indexOf(" ")!==-1&&(document.head.appendChild(k),k.setAttribute("data-s",""))})}var a=n.stylisPlugins||OL,l={},o,f=[];o=n.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(k){for(var T=k.getAttribute("data-emotion").split(" "),E=1;E<T.length;E++)l[T[E]]=!0;f.push(k)});var u,d=[ML,RL];{var h,g=[kL,TL(function(k){h.insert(k)})],b=EL(d.concat(a,g)),v=function(T){return Sh(jL(T),b)};u=function(T,E,I,P){h=I,v(T?T+"{"+E.styles+"}":E.styles),P&&(N.inserted[E.name]=!0)}}var N={key:t,sheet:new dL({key:t,container:o,nonce:n.nonce,speedy:n.speedy,prepend:n.prepend,insertionPoint:n.insertionPoint}),nonce:n.nonce,inserted:l,registered:{},insert:u};return N.sheet.hydrate(f),N},H0={exports:{}},kn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MS;function $L(){if(MS)return kn;MS=1;var e=typeof Symbol=="function"&&Symbol.for,n=e?Symbol.for("react.element"):60103,t=e?Symbol.for("react.portal"):60106,r=e?Symbol.for("react.fragment"):60107,a=e?Symbol.for("react.strict_mode"):60108,l=e?Symbol.for("react.profiler"):60114,o=e?Symbol.for("react.provider"):60109,f=e?Symbol.for("react.context"):60110,u=e?Symbol.for("react.async_mode"):60111,d=e?Symbol.for("react.concurrent_mode"):60111,h=e?Symbol.for("react.forward_ref"):60112,g=e?Symbol.for("react.suspense"):60113,b=e?Symbol.for("react.suspense_list"):60120,v=e?Symbol.for("react.memo"):60115,N=e?Symbol.for("react.lazy"):60116,k=e?Symbol.for("react.block"):60121,T=e?Symbol.for("react.fundamental"):60117,E=e?Symbol.for("react.responder"):60118,I=e?Symbol.for("react.scope"):60119;function P(F){if(typeof F=="object"&&F!==null){var $=F.$$typeof;switch($){case n:switch(F=F.type,F){case u:case d:case r:case l:case a:case g:return F;default:switch(F=F&&F.$$typeof,F){case f:case h:case N:case v:case o:return F;default:return $}}case t:return $}}}function V(F){return P(F)===d}return kn.AsyncMode=u,kn.ConcurrentMode=d,kn.ContextConsumer=f,kn.ContextProvider=o,kn.Element=n,kn.ForwardRef=h,kn.Fragment=r,kn.Lazy=N,kn.Memo=v,kn.Portal=t,kn.Profiler=l,kn.StrictMode=a,kn.Suspense=g,kn.isAsyncMode=function(F){return V(F)||P(F)===u},kn.isConcurrentMode=V,kn.isContextConsumer=function(F){return P(F)===f},kn.isContextProvider=function(F){return P(F)===o},kn.isElement=function(F){return typeof F=="object"&&F!==null&&F.$$typeof===n},kn.isForwardRef=function(F){return P(F)===h},kn.isFragment=function(F){return P(F)===r},kn.isLazy=function(F){return P(F)===N},kn.isMemo=function(F){return P(F)===v},kn.isPortal=function(F){return P(F)===t},kn.isProfiler=function(F){return P(F)===l},kn.isStrictMode=function(F){return P(F)===a},kn.isSuspense=function(F){return P(F)===g},kn.isValidElementType=function(F){return typeof F=="string"||typeof F=="function"||F===r||F===d||F===l||F===a||F===g||F===b||typeof F=="object"&&F!==null&&(F.$$typeof===N||F.$$typeof===v||F.$$typeof===o||F.$$typeof===f||F.$$typeof===h||F.$$typeof===T||F.$$typeof===E||F.$$typeof===I||F.$$typeof===k)},kn.typeOf=P,kn}var RS;function zL(){return RS||(RS=1,H0.exports=$L()),H0.exports}var G0,LS;function BL(){if(LS)return G0;LS=1;var e=zL(),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},t={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},l={};l[e.ForwardRef]=r,l[e.Memo]=a;function o(N){return e.isMemo(N)?a:l[N.$$typeof]||n}var f=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,g=Object.getPrototypeOf,b=Object.prototype;function v(N,k,T){if(typeof k!="string"){if(b){var E=g(k);E&&E!==b&&v(N,E,T)}var I=u(k);d&&(I=I.concat(d(k)));for(var P=o(N),V=o(k),F=0;F<I.length;++F){var $=I[F];if(!t[$]&&!(T&&T[$])&&!(V&&V[$])&&!(P&&P[$])){var B=h(k,$);try{f(N,$,B)}catch{}}}}return N}return G0=v,G0}BL();var UL=!0;function qL(e,n,t){var r="";return t.split(" ").forEach(function(a){e[a]!==void 0?n.push(e[a]+";"):a&&(r+=a+" ")}),r}var e2=function(n,t,r){var a=n.key+"-"+t.name;(r===!1||UL===!1)&&n.registered[a]===void 0&&(n.registered[a]=t.styles)},VL=function(n,t,r){e2(n,t,r);var a=n.key+"-"+t.name;if(n.inserted[t.name]===void 0){var l=t;do n.insert(t===l?"."+a:"",l,n.sheet,!0),l=l.next;while(l!==void 0)}};function HL(e){for(var n=0,t,r=0,a=e.length;a>=4;++r,a-=4)t=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,n=(t&65535)*1540483477+((t>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(a){case 3:n^=(e.charCodeAt(r+2)&255)<<16;case 2:n^=(e.charCodeAt(r+1)&255)<<8;case 1:n^=e.charCodeAt(r)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}var GL={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},YL=/[A-Z]|^ms/g,WL=/_EMO_([^_]+?)_([^]*?)_EMO_/g,t2=function(n){return n.charCodeAt(1)===45},OS=function(n){return n!=null&&typeof n!="boolean"},Y0=AL(function(e){return t2(e)?e:e.replace(YL,"-$&").toLowerCase()}),FS=function(n,t){switch(n){case"animation":case"animationName":if(typeof t=="string")return t.replace(WL,function(r,a,l){return Dl={name:a,styles:l,next:Dl},a})}return GL[n]!==1&&!t2(n)&&typeof t=="number"&&t!==0?t+"px":t};function Xm(e,n,t){if(t==null)return"";var r=t;if(r.__emotion_styles!==void 0)return r;switch(typeof t){case"boolean":return"";case"object":{var a=t;if(a.anim===1)return Dl={name:a.name,styles:a.styles,next:Dl},a.name;var l=t;if(l.styles!==void 0){var o=l.next;if(o!==void 0)for(;o!==void 0;)Dl={name:o.name,styles:o.styles,next:Dl},o=o.next;var f=l.styles+";";return f}return QL(e,n,t)}case"function":{if(e!==void 0){var u=Dl,d=t(e);return Dl=u,Xm(e,n,d)}break}}var h=t;return h}function QL(e,n,t){var r="";if(Array.isArray(t))for(var a=0;a<t.length;a++)r+=Xm(e,n,t[a])+";";else for(var l in t){var o=t[l];if(typeof o!="object"){var f=o;OS(f)&&(r+=Y0(l)+":"+FS(l,f)+";")}else if(Array.isArray(o)&&typeof o[0]=="string"&&n==null)for(var u=0;u<o.length;u++)OS(o[u])&&(r+=Y0(l)+":"+FS(l,o[u])+";");else{var d=Xm(e,n,o);switch(l){case"animation":case"animationName":{r+=Y0(l)+":"+d+";";break}default:r+=l+"{"+d+"}"}}}return r}var $S=/label:\s*([^\s;{]+)\s*(;|$)/g,Dl;function n2(e,n,t){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var r=!0,a="";Dl=void 0;var l=e[0];if(l==null||l.raw===void 0)r=!1,a+=Xm(t,n,l);else{var o=l;a+=o[0]}for(var f=1;f<e.length;f++)if(a+=Xm(t,n,e[f]),r){var u=l;a+=u[f]}$S.lastIndex=0;for(var d="",h;(h=$S.exec(a))!==null;)d+="-"+h[1];var g=HL(a)+d;return{name:g,styles:a,next:Dl}}var JL=function(n){return n()},KL=Xw.useInsertionEffect?Xw.useInsertionEffect:!1,XL=KL||JL,i2=w.createContext(typeof HTMLElement<"u"?FL({key:"css"}):null);i2.Provider;var ZL=function(n){return w.forwardRef(function(t,r){var a=w.useContext(i2);return n(t,a,r)})},eO=w.createContext({}),iw={}.hasOwnProperty,Wv="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",tO=function(n,t){var r={};for(var a in t)iw.call(t,a)&&(r[a]=t[a]);return r[Wv]=n,r},nO=function(n){var t=n.cache,r=n.serialized,a=n.isStringTag;return e2(t,r,a),XL(function(){return VL(t,r,a)}),null},iO=ZL(function(e,n,t){var r=e.css;typeof r=="string"&&n.registered[r]!==void 0&&(r=n.registered[r]);var a=e[Wv],l=[r],o="";typeof e.className=="string"?o=qL(n.registered,l,e.className):e.className!=null&&(o=e.className+" ");var f=n2(l,void 0,w.useContext(eO));o+=n.key+"-"+f.name;var u={};for(var d in e)iw.call(e,d)&&d!=="css"&&d!==Wv&&(u[d]=e[d]);return u.className=o,t&&(u.ref=t),w.createElement(w.Fragment,null,w.createElement(nO,{cache:n,serialized:f,isStringTag:typeof a=="string"}),w.createElement(a,u))}),rO=iO,bt=function(n,t){var r=arguments;if(t==null||!iw.call(t,"css"))return w.createElement.apply(void 0,r);var a=r.length,l=new Array(a);l[0]=rO,l[1]=tO(n,t);for(var o=2;o<a;o++)l[o]=r[o];return w.createElement.apply(null,l)};(function(e){var n;n||(n=e.JSX||(e.JSX={}))})(bt||(bt={}));function rw(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return n2(n)}function aO(){var e=rw.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function sO(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}const lO=Math.min,oO=Math.max,eb=Math.round,fx=Math.floor,tb=e=>({x:e,y:e});function cO(e){const{x:n,y:t,width:r,height:a}=e;return{width:r,height:a,top:t,left:n,right:n+r,bottom:t+a,x:n,y:t}}function kb(){return typeof window<"u"}function r2(e){return s2(e)?(e.nodeName||"").toLowerCase():"#document"}function Do(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function a2(e){var n;return(n=(s2(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function s2(e){return kb()?e instanceof Node||e instanceof Do(e).Node:!1}function uO(e){return kb()?e instanceof Element||e instanceof Do(e).Element:!1}function aw(e){return kb()?e instanceof HTMLElement||e instanceof Do(e).HTMLElement:!1}function zS(e){return!kb()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Do(e).ShadowRoot}const dO=new Set(["inline","contents"]);function l2(e){const{overflow:n,overflowX:t,overflowY:r,display:a}=sw(e);return/auto|scroll|overlay|hidden|clip/.test(n+r+t)&&!dO.has(a)}function fO(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const hO=new Set(["html","body","#document"]);function pO(e){return hO.has(r2(e))}function sw(e){return Do(e).getComputedStyle(e)}function mO(e){if(r2(e)==="html")return e;const n=e.assignedSlot||e.parentNode||zS(e)&&e.host||a2(e);return zS(n)?n.host:n}function o2(e){const n=mO(e);return pO(n)?e.ownerDocument?e.ownerDocument.body:e.body:aw(n)&&l2(n)?n:o2(n)}function nb(e,n,t){var r;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=o2(e),l=a===((r=e.ownerDocument)==null?void 0:r.body),o=Do(a);if(l){const f=Qv(o);return n.concat(o,o.visualViewport||[],l2(a)?a:[],f&&t?nb(f):[])}return n.concat(a,nb(a,[],t))}function Qv(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function gO(e){const n=sw(e);let t=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const a=aw(e),l=a?e.offsetWidth:t,o=a?e.offsetHeight:r,f=eb(t)!==l||eb(r)!==o;return f&&(t=l,r=o),{width:t,height:r,$:f}}function lw(e){return uO(e)?e:e.contextElement}function BS(e){const n=lw(e);if(!aw(n))return tb(1);const t=n.getBoundingClientRect(),{width:r,height:a,$:l}=gO(n);let o=(l?eb(t.width):t.width)/r,f=(l?eb(t.height):t.height)/a;return(!o||!Number.isFinite(o))&&(o=1),(!f||!Number.isFinite(f))&&(f=1),{x:o,y:f}}const yO=tb(0);function xO(e){const n=Do(e);return!fO()||!n.visualViewport?yO:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function bO(e,n,t){return!1}function US(e,n,t,r){n===void 0&&(n=!1);const a=e.getBoundingClientRect(),l=lw(e);let o=tb(1);n&&(o=BS(e));const f=bO()?xO(l):tb(0);let u=(a.left+f.x)/o.x,d=(a.top+f.y)/o.y,h=a.width/o.x,g=a.height/o.y;if(l){const b=Do(l),v=r;let N=b,k=Qv(N);for(;k&&r&&v!==N;){const T=BS(k),E=k.getBoundingClientRect(),I=sw(k),P=E.left+(k.clientLeft+parseFloat(I.paddingLeft))*T.x,V=E.top+(k.clientTop+parseFloat(I.paddingTop))*T.y;u*=T.x,d*=T.y,h*=T.x,g*=T.y,u+=P,d+=V,N=Do(k),k=Qv(N)}}return cO({width:h,height:g,x:u,y:d})}function c2(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function vO(e,n){let t=null,r;const a=a2(e);function l(){var f;clearTimeout(r),(f=t)==null||f.disconnect(),t=null}function o(f,u){f===void 0&&(f=!1),u===void 0&&(u=1),l();const d=e.getBoundingClientRect(),{left:h,top:g,width:b,height:v}=d;if(f||n(),!b||!v)return;const N=fx(g),k=fx(a.clientWidth-(h+b)),T=fx(a.clientHeight-(g+v)),E=fx(h),P={rootMargin:-N+"px "+-k+"px "+-T+"px "+-E+"px",threshold:oO(0,lO(1,u))||1};let V=!0;function F($){const B=$[0].intersectionRatio;if(B!==u){if(!V)return o();B?o(!1,B):r=setTimeout(()=>{o(!1,1e-7)},1e3)}B===1&&!c2(d,e.getBoundingClientRect())&&o(),V=!1}try{t=new IntersectionObserver(F,{...P,root:a.ownerDocument})}catch{t=new IntersectionObserver(F,P)}t.observe(e)}return o(!0),l}function wO(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:l=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:f=typeof IntersectionObserver=="function",animationFrame:u=!1}=r,d=lw(e),h=a||l?[...d?nb(d):[],...nb(n)]:[];h.forEach(E=>{a&&E.addEventListener("scroll",t,{passive:!0}),l&&E.addEventListener("resize",t)});const g=d&&f?vO(d,t):null;let b=-1,v=null;o&&(v=new ResizeObserver(E=>{let[I]=E;I&&I.target===d&&v&&(v.unobserve(n),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var P;(P=v)==null||P.observe(n)})),t()}),d&&!u&&v.observe(d),v.observe(n));let N,k=u?US(e):null;u&&T();function T(){const E=US(e);k&&!c2(k,E)&&t(),k=E,N=requestAnimationFrame(T)}return t(),()=>{var E;h.forEach(I=>{a&&I.removeEventListener("scroll",t),l&&I.removeEventListener("resize",t)}),g==null||g(),(E=v)==null||E.disconnect(),v=null,u&&cancelAnimationFrame(N)}}var Jv=w.useLayoutEffect,SO=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],ib=function(){};function NO(e,n){return n?n[0]==="-"?e+n:e+"__"+n:e}function CO(e,n){for(var t=arguments.length,r=new Array(t>2?t-2:0),a=2;a<t;a++)r[a-2]=arguments[a];var l=[].concat(r);if(n&&e)for(var o in n)n.hasOwnProperty(o)&&n[o]&&l.push("".concat(NO(e,o)));return l.filter(function(f){return f}).map(function(f){return String(f).trim()}).join(" ")}var qS=function(n){return IO(n)?n.filter(Boolean):Rd(n)==="object"&&n!==null?[n]:[]},u2=function(n){n.className,n.clearValue,n.cx,n.getStyles,n.getClassNames,n.getValue,n.hasValue,n.isMulti,n.isRtl,n.options,n.selectOption,n.selectProps,n.setValue,n.theme;var t=Io(n,SO);return Ct({},t)},pi=function(n,t,r){var a=n.cx,l=n.getStyles,o=n.getClassNames,f=n.className;return{css:l(t,n),className:a(r??{},o(t,n),f)}};function Eb(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function jO(e){return Eb(e)?window.innerHeight:e.clientHeight}function d2(e){return Eb(e)?window.pageYOffset:e.scrollTop}function rb(e,n){if(Eb(e)){window.scrollTo(0,n);return}e.scrollTop=n}function _O(e){var n=getComputedStyle(e),t=n.position==="absolute",r=/(auto|scroll)/;if(n.position==="fixed")return document.documentElement;for(var a=e;a=a.parentElement;)if(n=getComputedStyle(a),!(t&&n.position==="static")&&r.test(n.overflow+n.overflowY+n.overflowX))return a;return document.documentElement}function kO(e,n,t,r){return t*((e=e/r-1)*e*e+1)+n}function hx(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ib,a=d2(e),l=n-a,o=10,f=0;function u(){f+=o;var d=kO(f,a,l,t);rb(e,d),f<t?window.requestAnimationFrame(u):r(e)}u()}function VS(e,n){var t=e.getBoundingClientRect(),r=n.getBoundingClientRect(),a=n.offsetHeight/3;r.bottom+a>t.bottom?rb(e,Math.min(n.offsetTop+n.clientHeight-e.offsetHeight+a,e.scrollHeight)):r.top-a<t.top&&rb(e,Math.max(n.offsetTop-a,0))}function EO(e){var n=e.getBoundingClientRect();return{bottom:n.bottom,height:n.height,left:n.left,right:n.right,top:n.top,width:n.width}}function HS(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function TO(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var f2=!1,AO={get passive(){return f2=!0}},px=typeof window<"u"?window:{};px.addEventListener&&px.removeEventListener&&(px.addEventListener("p",ib,AO),px.removeEventListener("p",ib,!1));var DO=f2;function PO(e){return e!=null}function IO(e){return Array.isArray(e)}function mx(e,n,t){return e?n:t}var MO=function(n){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];var l=Object.entries(n).filter(function(o){var f=ko(o,1),u=f[0];return!r.includes(u)});return l.reduce(function(o,f){var u=ko(f,2),d=u[0],h=u[1];return o[d]=h,o},{})},RO=["children","innerProps"],LO=["children","innerProps"];function OO(e){var n=e.maxHeight,t=e.menuEl,r=e.minHeight,a=e.placement,l=e.shouldScroll,o=e.isFixedPosition,f=e.controlHeight,u=_O(t),d={placement:"bottom",maxHeight:n};if(!t||!t.offsetParent)return d;var h=u.getBoundingClientRect(),g=h.height,b=t.getBoundingClientRect(),v=b.bottom,N=b.height,k=b.top,T=t.offsetParent.getBoundingClientRect(),E=T.top,I=o?window.innerHeight:jO(u),P=d2(u),V=parseInt(getComputedStyle(t).marginBottom,10),F=parseInt(getComputedStyle(t).marginTop,10),$=E-F,B=I-k,z=$+P,q=g-P-k,O=v-I+P+V,R=P+k-F,G=160;switch(a){case"auto":case"bottom":if(B>=N)return{placement:"bottom",maxHeight:n};if(q>=N&&!o)return l&&hx(u,O,G),{placement:"bottom",maxHeight:n};if(!o&&q>=r||o&&B>=r){l&&hx(u,O,G);var ee=o?B-V:q-V;return{placement:"bottom",maxHeight:ee}}if(a==="auto"||o){var te=n,le=o?$:z;return le>=r&&(te=Math.min(le-V-f,n)),{placement:"top",maxHeight:te}}if(a==="bottom")return l&&rb(u,O),{placement:"bottom",maxHeight:n};break;case"top":if($>=N)return{placement:"top",maxHeight:n};if(z>=N&&!o)return l&&hx(u,R,G),{placement:"top",maxHeight:n};if(!o&&z>=r||o&&$>=r){var K=n;return(!o&&z>=r||o&&$>=r)&&(K=o?$-F:z-F),l&&hx(u,R,G),{placement:"top",maxHeight:K}}return{placement:"bottom",maxHeight:n};default:throw new Error('Invalid placement provided "'.concat(a,'".'))}return d}function FO(e){var n={bottom:"top",top:"bottom"};return e?n[e]:"bottom"}var h2=function(n){return n==="auto"?"bottom":n},$O=function(n,t){var r,a=n.placement,l=n.theme,o=l.borderRadius,f=l.spacing,u=l.colors;return Ct((r={label:"menu"},Om(r,FO(a),"100%"),Om(r,"position","absolute"),Om(r,"width","100%"),Om(r,"zIndex",1),r),t?{}:{backgroundColor:u.neutral0,borderRadius:o,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:f.menuGutter,marginTop:f.menuGutter})},p2=w.createContext(null),zO=function(n){var t=n.children,r=n.minMenuHeight,a=n.maxMenuHeight,l=n.menuPlacement,o=n.menuPosition,f=n.menuShouldScrollIntoView,u=n.theme,d=w.useContext(p2)||{},h=d.setPortalPlacement,g=w.useRef(null),b=w.useState(a),v=ko(b,2),N=v[0],k=v[1],T=w.useState(null),E=ko(T,2),I=E[0],P=E[1],V=u.spacing.controlHeight;return Jv(function(){var F=g.current;if(F){var $=o==="fixed",B=f&&!$,z=OO({maxHeight:a,menuEl:F,minHeight:r,placement:l,shouldScroll:B,isFixedPosition:$,controlHeight:V});k(z.maxHeight),P(z.placement),h==null||h(z.placement)}},[a,l,o,f,r,h,V]),t({ref:g,placerProps:Ct(Ct({},n),{},{placement:I||h2(l),maxHeight:N})})},BO=function(n){var t=n.children,r=n.innerRef,a=n.innerProps;return bt("div",Tt({},pi(n,"menu",{menu:!0}),{ref:r},a),t)},UO=BO,qO=function(n,t){var r=n.maxHeight,a=n.theme.spacing.baseUnit;return Ct({maxHeight:r,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},t?{}:{paddingBottom:a,paddingTop:a})},VO=function(n){var t=n.children,r=n.innerProps,a=n.innerRef,l=n.isMulti;return bt("div",Tt({},pi(n,"menuList",{"menu-list":!0,"menu-list--is-multi":l}),{ref:a},r),t)},m2=function(n,t){var r=n.theme,a=r.spacing.baseUnit,l=r.colors;return Ct({textAlign:"center"},t?{}:{color:l.neutral40,padding:"".concat(a*2,"px ").concat(a*3,"px")})},HO=m2,GO=m2,YO=function(n){var t=n.children,r=t===void 0?"No options":t,a=n.innerProps,l=Io(n,RO);return bt("div",Tt({},pi(Ct(Ct({},l),{},{children:r,innerProps:a}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),a),r)},WO=function(n){var t=n.children,r=t===void 0?"Loading...":t,a=n.innerProps,l=Io(n,LO);return bt("div",Tt({},pi(Ct(Ct({},l),{},{children:r,innerProps:a}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),a),r)},QO=function(n){var t=n.rect,r=n.offset,a=n.position;return{left:t.left,position:a,top:r,width:t.width,zIndex:1}},JO=function(n){var t=n.appendTo,r=n.children,a=n.controlElement,l=n.innerProps,o=n.menuPlacement,f=n.menuPosition,u=w.useRef(null),d=w.useRef(null),h=w.useState(h2(o)),g=ko(h,2),b=g[0],v=g[1],N=w.useMemo(function(){return{setPortalPlacement:v}},[]),k=w.useState(null),T=ko(k,2),E=T[0],I=T[1],P=w.useCallback(function(){if(a){var B=EO(a),z=f==="fixed"?0:window.pageYOffset,q=B[b]+z;(q!==(E==null?void 0:E.offset)||B.left!==(E==null?void 0:E.rect.left)||B.width!==(E==null?void 0:E.rect.width))&&I({offset:q,rect:B})}},[a,f,b,E==null?void 0:E.offset,E==null?void 0:E.rect.left,E==null?void 0:E.rect.width]);Jv(function(){P()},[P]);var V=w.useCallback(function(){typeof d.current=="function"&&(d.current(),d.current=null),a&&u.current&&(d.current=wO(a,u.current,P,{elementResize:"ResizeObserver"in window}))},[a,P]);Jv(function(){V()},[V]);var F=w.useCallback(function(B){u.current=B,V()},[V]);if(!t&&f!=="fixed"||!E)return null;var $=bt("div",Tt({ref:F},pi(Ct(Ct({},n),{},{offset:E.offset,position:f,rect:E.rect}),"menuPortal",{"menu-portal":!0}),l),r);return bt(p2.Provider,{value:N},t?zD.createPortal($,t):$)},KO=function(n){var t=n.isDisabled,r=n.isRtl;return{label:"container",direction:r?"rtl":void 0,pointerEvents:t?"none":void 0,position:"relative"}},XO=function(n){var t=n.children,r=n.innerProps,a=n.isDisabled,l=n.isRtl;return bt("div",Tt({},pi(n,"container",{"--is-disabled":a,"--is-rtl":l}),r),t)},ZO=function(n,t){var r=n.theme.spacing,a=n.isMulti,l=n.hasValue,o=n.selectProps.controlShouldRenderValue;return Ct({alignItems:"center",display:a&&l&&o?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},t?{}:{padding:"".concat(r.baseUnit/2,"px ").concat(r.baseUnit*2,"px")})},e3=function(n){var t=n.children,r=n.innerProps,a=n.isMulti,l=n.hasValue;return bt("div",Tt({},pi(n,"valueContainer",{"value-container":!0,"value-container--is-multi":a,"value-container--has-value":l}),r),t)},t3=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},n3=function(n){var t=n.children,r=n.innerProps;return bt("div",Tt({},pi(n,"indicatorsContainer",{indicators:!0}),r),t)},GS,i3=["size"],r3=["innerProps","isRtl","size"],a3={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},g2=function(n){var t=n.size,r=Io(n,i3);return bt("svg",Tt({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:a3},r))},ow=function(n){return bt(g2,Tt({size:20},n),bt("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},y2=function(n){return bt(g2,Tt({size:20},n),bt("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},x2=function(n,t){var r=n.isFocused,a=n.theme,l=a.spacing.baseUnit,o=a.colors;return Ct({label:"indicatorContainer",display:"flex",transition:"color 150ms"},t?{}:{color:r?o.neutral60:o.neutral20,padding:l*2,":hover":{color:r?o.neutral80:o.neutral40}})},s3=x2,l3=function(n){var t=n.children,r=n.innerProps;return bt("div",Tt({},pi(n,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),r),t||bt(y2,null))},o3=x2,c3=function(n){var t=n.children,r=n.innerProps;return bt("div",Tt({},pi(n,"clearIndicator",{indicator:!0,"clear-indicator":!0}),r),t||bt(ow,null))},u3=function(n,t){var r=n.isDisabled,a=n.theme,l=a.spacing.baseUnit,o=a.colors;return Ct({label:"indicatorSeparator",alignSelf:"stretch",width:1},t?{}:{backgroundColor:r?o.neutral10:o.neutral20,marginBottom:l*2,marginTop:l*2})},d3=function(n){var t=n.innerProps;return bt("span",Tt({},t,pi(n,"indicatorSeparator",{"indicator-separator":!0})))},f3=aO(GS||(GS=sO([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),h3=function(n,t){var r=n.isFocused,a=n.size,l=n.theme,o=l.colors,f=l.spacing.baseUnit;return Ct({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:a,lineHeight:1,marginRight:a,textAlign:"center",verticalAlign:"middle"},t?{}:{color:r?o.neutral60:o.neutral20,padding:f*2})},W0=function(n){var t=n.delay,r=n.offset;return bt("span",{css:rw({animation:"".concat(f3," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:r?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},p3=function(n){var t=n.innerProps,r=n.isRtl,a=n.size,l=a===void 0?4:a,o=Io(n,r3);return bt("div",Tt({},pi(Ct(Ct({},o),{},{innerProps:t,isRtl:r,size:l}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),t),bt(W0,{delay:0,offset:r}),bt(W0,{delay:160,offset:!0}),bt(W0,{delay:320,offset:!r}))},m3=function(n,t){var r=n.isDisabled,a=n.isFocused,l=n.theme,o=l.colors,f=l.borderRadius,u=l.spacing;return Ct({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:u.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},t?{}:{backgroundColor:r?o.neutral5:o.neutral0,borderColor:r?o.neutral10:a?o.primary:o.neutral20,borderRadius:f,borderStyle:"solid",borderWidth:1,boxShadow:a?"0 0 0 1px ".concat(o.primary):void 0,"&:hover":{borderColor:a?o.primary:o.neutral30}})},g3=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,l=n.innerRef,o=n.innerProps,f=n.menuIsOpen;return bt("div",Tt({ref:l},pi(n,"control",{control:!0,"control--is-disabled":r,"control--is-focused":a,"control--menu-is-open":f}),o,{"aria-disabled":r||void 0}),t)},y3=g3,x3=["data"],b3=function(n,t){var r=n.theme.spacing;return t?{}:{paddingBottom:r.baseUnit*2,paddingTop:r.baseUnit*2}},v3=function(n){var t=n.children,r=n.cx,a=n.getStyles,l=n.getClassNames,o=n.Heading,f=n.headingProps,u=n.innerProps,d=n.label,h=n.theme,g=n.selectProps;return bt("div",Tt({},pi(n,"group",{group:!0}),u),bt(o,Tt({},f,{selectProps:g,theme:h,getStyles:a,getClassNames:l,cx:r}),d),bt("div",null,t))},w3=function(n,t){var r=n.theme,a=r.colors,l=r.spacing;return Ct({label:"group",cursor:"default",display:"block"},t?{}:{color:a.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:l.baseUnit*3,paddingRight:l.baseUnit*3,textTransform:"uppercase"})},S3=function(n){var t=u2(n);t.data;var r=Io(t,x3);return bt("div",Tt({},pi(n,"groupHeading",{"group-heading":!0}),r))},N3=v3,C3=["innerRef","isDisabled","isHidden","inputClassName"],j3=function(n,t){var r=n.isDisabled,a=n.value,l=n.theme,o=l.spacing,f=l.colors;return Ct(Ct({visibility:r?"hidden":"visible",transform:a?"translateZ(0)":""},_3),t?{}:{margin:o.baseUnit/2,paddingBottom:o.baseUnit/2,paddingTop:o.baseUnit/2,color:f.neutral80})},b2={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},_3={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Ct({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},b2)},k3=function(n){return Ct({label:"input",color:"inherit",background:0,opacity:n?0:1,width:"100%"},b2)},E3=function(n){var t=n.cx,r=n.value,a=u2(n),l=a.innerRef,o=a.isDisabled,f=a.isHidden,u=a.inputClassName,d=Io(a,C3);return bt("div",Tt({},pi(n,"input",{"input-container":!0}),{"data-value":r||""}),bt("input",Tt({className:t({input:!0},u),ref:l,style:k3(f),disabled:o},d)))},T3=E3,A3=function(n,t){var r=n.theme,a=r.spacing,l=r.borderRadius,o=r.colors;return Ct({label:"multiValue",display:"flex",minWidth:0},t?{}:{backgroundColor:o.neutral10,borderRadius:l/2,margin:a.baseUnit/2})},D3=function(n,t){var r=n.theme,a=r.borderRadius,l=r.colors,o=n.cropWithEllipsis;return Ct({overflow:"hidden",textOverflow:o||o===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},t?{}:{borderRadius:a/2,color:l.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},P3=function(n,t){var r=n.theme,a=r.spacing,l=r.borderRadius,o=r.colors,f=n.isFocused;return Ct({alignItems:"center",display:"flex"},t?{}:{borderRadius:l/2,backgroundColor:f?o.dangerLight:void 0,paddingLeft:a.baseUnit,paddingRight:a.baseUnit,":hover":{backgroundColor:o.dangerLight,color:o.danger}})},v2=function(n){var t=n.children,r=n.innerProps;return bt("div",r,t)},I3=v2,M3=v2;function R3(e){var n=e.children,t=e.innerProps;return bt("div",Tt({role:"button"},t),n||bt(ow,{size:14}))}var L3=function(n){var t=n.children,r=n.components,a=n.data,l=n.innerProps,o=n.isDisabled,f=n.removeProps,u=n.selectProps,d=r.Container,h=r.Label,g=r.Remove;return bt(d,{data:a,innerProps:Ct(Ct({},pi(n,"multiValue",{"multi-value":!0,"multi-value--is-disabled":o})),l),selectProps:u},bt(h,{data:a,innerProps:Ct({},pi(n,"multiValueLabel",{"multi-value__label":!0})),selectProps:u},t),bt(g,{data:a,innerProps:Ct(Ct({},pi(n,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(t||"option")},f),selectProps:u}))},O3=L3,F3=function(n,t){var r=n.isDisabled,a=n.isFocused,l=n.isSelected,o=n.theme,f=o.spacing,u=o.colors;return Ct({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},t?{}:{backgroundColor:l?u.primary:a?u.primary25:"transparent",color:r?u.neutral20:l?u.neutral0:"inherit",padding:"".concat(f.baseUnit*2,"px ").concat(f.baseUnit*3,"px"),":active":{backgroundColor:r?void 0:l?u.primary:u.primary50}})},$3=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,l=n.isSelected,o=n.innerRef,f=n.innerProps;return bt("div",Tt({},pi(n,"option",{option:!0,"option--is-disabled":r,"option--is-focused":a,"option--is-selected":l}),{ref:o,"aria-disabled":r},f),t)},z3=$3,B3=function(n,t){var r=n.theme,a=r.spacing,l=r.colors;return Ct({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},t?{}:{color:l.neutral50,marginLeft:a.baseUnit/2,marginRight:a.baseUnit/2})},U3=function(n){var t=n.children,r=n.innerProps;return bt("div",Tt({},pi(n,"placeholder",{placeholder:!0}),r),t)},q3=U3,V3=function(n,t){var r=n.isDisabled,a=n.theme,l=a.spacing,o=a.colors;return Ct({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t?{}:{color:r?o.neutral40:o.neutral80,marginLeft:l.baseUnit/2,marginRight:l.baseUnit/2})},H3=function(n){var t=n.children,r=n.isDisabled,a=n.innerProps;return bt("div",Tt({},pi(n,"singleValue",{"single-value":!0,"single-value--is-disabled":r}),a),t)},G3=H3,Y3={ClearIndicator:c3,Control:y3,DropdownIndicator:l3,DownChevron:y2,CrossIcon:ow,Group:N3,GroupHeading:S3,IndicatorsContainer:n3,IndicatorSeparator:d3,Input:T3,LoadingIndicator:p3,Menu:UO,MenuList:VO,MenuPortal:JO,LoadingMessage:WO,NoOptionsMessage:YO,MultiValue:O3,MultiValueContainer:I3,MultiValueLabel:M3,MultiValueRemove:R3,Option:z3,Placeholder:q3,SelectContainer:XO,SingleValue:G3,ValueContainer:e3},W3=function(n){return Ct(Ct({},Y3),n.components)},YS=Number.isNaN||function(n){return typeof n=="number"&&n!==n};function Q3(e,n){return!!(e===n||YS(e)&&YS(n))}function J3(e,n){if(e.length!==n.length)return!1;for(var t=0;t<e.length;t++)if(!Q3(e[t],n[t]))return!1;return!0}function K3(e,n){n===void 0&&(n=J3);var t=null;function r(){for(var a=[],l=0;l<arguments.length;l++)a[l]=arguments[l];if(t&&t.lastThis===this&&n(a,t.lastArgs))return t.lastResult;var o=e.apply(this,a);return t={lastResult:o,lastArgs:a,lastThis:this},o}return r.clear=function(){t=null},r}var X3={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},Z3=function(n){return bt("span",Tt({css:X3},n))},WS=Z3,eF={guidance:function(n){var t=n.isSearchable,r=n.isMulti,a=n.tabSelectsValue,l=n.context,o=n.isInitialFocus;switch(l){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(a?", press Tab to select the option and exit the menu":"",".");case"input":return o?"".concat(n["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(r?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(n){var t=n.action,r=n.label,a=r===void 0?"":r,l=n.labels,o=n.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(a,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(l.length>1?"s":""," ").concat(l.join(","),", selected.");case"select-option":return o?"option ".concat(a," is disabled. Select another option."):"option ".concat(a,", selected.");default:return""}},onFocus:function(n){var t=n.context,r=n.focused,a=n.options,l=n.label,o=l===void 0?"":l,f=n.selectValue,u=n.isDisabled,d=n.isSelected,h=n.isAppleDevice,g=function(k,T){return k&&k.length?"".concat(k.indexOf(T)+1," of ").concat(k.length):""};if(t==="value"&&f)return"value ".concat(o," focused, ").concat(g(f,r),".");if(t==="menu"&&h){var b=u?" disabled":"",v="".concat(d?" selected":"").concat(b);return"".concat(o).concat(v,", ").concat(g(a,r),".")}return""},onFilter:function(n){var t=n.inputValue,r=n.resultsMessage;return"".concat(r).concat(t?" for search term "+t:"",".")}},tF=function(n){var t=n.ariaSelection,r=n.focusedOption,a=n.focusedValue,l=n.focusableOptions,o=n.isFocused,f=n.selectValue,u=n.selectProps,d=n.id,h=n.isAppleDevice,g=u.ariaLiveMessages,b=u.getOptionLabel,v=u.inputValue,N=u.isMulti,k=u.isOptionDisabled,T=u.isSearchable,E=u.menuIsOpen,I=u.options,P=u.screenReaderStatus,V=u.tabSelectsValue,F=u.isLoading,$=u["aria-label"],B=u["aria-live"],z=w.useMemo(function(){return Ct(Ct({},eF),g||{})},[g]),q=w.useMemo(function(){var le="";if(t&&z.onChange){var K=t.option,U=t.options,J=t.removedValue,ne=t.removedValues,A=t.value,ae=function(re){return Array.isArray(re)?null:re},ce=J||K||ae(A),M=ce?b(ce):"",de=U||ne||void 0,Se=de?de.map(b):[],fe=Ct({isDisabled:ce&&k(ce,f),label:M,labels:Se},t);le=z.onChange(fe)}return le},[t,z,k,f,b]),O=w.useMemo(function(){var le="",K=r||a,U=!!(r&&f&&f.includes(r));if(K&&z.onFocus){var J={focused:K,label:b(K),isDisabled:k(K,f),isSelected:U,options:l,context:K===r?"menu":"value",selectValue:f,isAppleDevice:h};le=z.onFocus(J)}return le},[r,a,b,k,z,l,f,h]),R=w.useMemo(function(){var le="";if(E&&I.length&&!F&&z.onFilter){var K=P({count:l.length});le=z.onFilter({inputValue:v,resultsMessage:K})}return le},[l,v,E,z,I,P,F]),G=(t==null?void 0:t.action)==="initial-input-focus",ee=w.useMemo(function(){var le="";if(z.guidance){var K=a?"value":E?"menu":"input";le=z.guidance({"aria-label":$,context:K,isDisabled:r&&k(r,f),isMulti:N,isSearchable:T,tabSelectsValue:V,isInitialFocus:G})}return le},[$,r,a,N,k,T,E,z,f,V,G]),te=bt(w.Fragment,null,bt("span",{id:"aria-selection"},q),bt("span",{id:"aria-focused"},O),bt("span",{id:"aria-results"},R),bt("span",{id:"aria-guidance"},ee));return bt(w.Fragment,null,bt(WS,{id:d},G&&te),bt(WS,{"aria-live":B,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},o&&!G&&te))},nF=tF,Kv=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],iF=new RegExp("["+Kv.map(function(e){return e.letters}).join("")+"]","g"),w2={};for(var Q0=0;Q0<Kv.length;Q0++)for(var J0=Kv[Q0],K0=0;K0<J0.letters.length;K0++)w2[J0.letters[K0]]=J0.base;var S2=function(n){return n.replace(iF,function(t){return w2[t]})},rF=K3(S2),QS=function(n){return n.replace(/^\s+|\s+$/g,"")},aF=function(n){return"".concat(n.label," ").concat(n.value)},sF=function(n){return function(t,r){if(t.data.__isNew__)return!0;var a=Ct({ignoreCase:!0,ignoreAccents:!0,stringify:aF,trim:!0,matchFrom:"any"},n),l=a.ignoreCase,o=a.ignoreAccents,f=a.stringify,u=a.trim,d=a.matchFrom,h=u?QS(r):r,g=u?QS(f(t)):f(t);return l&&(h=h.toLowerCase(),g=g.toLowerCase()),o&&(h=rF(h),g=S2(g)),d==="start"?g.substr(0,h.length)===h:g.indexOf(h)>-1}},lF=["innerRef"];function oF(e){var n=e.innerRef,t=Io(e,lF),r=MO(t,"onExited","in","enter","exit","appear");return bt("input",Tt({ref:n},r,{css:rw({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var cF=function(n){n.cancelable&&n.preventDefault(),n.stopPropagation()};function uF(e){var n=e.isEnabled,t=e.onBottomArrive,r=e.onBottomLeave,a=e.onTopArrive,l=e.onTopLeave,o=w.useRef(!1),f=w.useRef(!1),u=w.useRef(0),d=w.useRef(null),h=w.useCallback(function(T,E){if(d.current!==null){var I=d.current,P=I.scrollTop,V=I.scrollHeight,F=I.clientHeight,$=d.current,B=E>0,z=V-F-P,q=!1;z>E&&o.current&&(r&&r(T),o.current=!1),B&&f.current&&(l&&l(T),f.current=!1),B&&E>z?(t&&!o.current&&t(T),$.scrollTop=V,q=!0,o.current=!0):!B&&-E>P&&(a&&!f.current&&a(T),$.scrollTop=0,q=!0,f.current=!0),q&&cF(T)}},[t,r,a,l]),g=w.useCallback(function(T){h(T,T.deltaY)},[h]),b=w.useCallback(function(T){u.current=T.changedTouches[0].clientY},[]),v=w.useCallback(function(T){var E=u.current-T.changedTouches[0].clientY;h(T,E)},[h]),N=w.useCallback(function(T){if(T){var E=DO?{passive:!1}:!1;T.addEventListener("wheel",g,E),T.addEventListener("touchstart",b,E),T.addEventListener("touchmove",v,E)}},[v,b,g]),k=w.useCallback(function(T){T&&(T.removeEventListener("wheel",g,!1),T.removeEventListener("touchstart",b,!1),T.removeEventListener("touchmove",v,!1))},[v,b,g]);return w.useEffect(function(){if(n){var T=d.current;return N(T),function(){k(T)}}},[n,N,k]),function(T){d.current=T}}var JS=["boxSizing","height","overflow","paddingRight","position"],KS={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function XS(e){e.cancelable&&e.preventDefault()}function ZS(e){e.stopPropagation()}function eN(){var e=this.scrollTop,n=this.scrollHeight,t=e+this.offsetHeight;e===0?this.scrollTop=1:t===n&&(this.scrollTop=e-1)}function tN(){return"ontouchstart"in window||navigator.maxTouchPoints}var nN=!!(typeof window<"u"&&window.document&&window.document.createElement),Em=0,uh={capture:!1,passive:!1};function dF(e){var n=e.isEnabled,t=e.accountForScrollbars,r=t===void 0?!0:t,a=w.useRef({}),l=w.useRef(null),o=w.useCallback(function(u){if(nN){var d=document.body,h=d&&d.style;if(r&&JS.forEach(function(N){var k=h&&h[N];a.current[N]=k}),r&&Em<1){var g=parseInt(a.current.paddingRight,10)||0,b=document.body?document.body.clientWidth:0,v=window.innerWidth-b+g||0;Object.keys(KS).forEach(function(N){var k=KS[N];h&&(h[N]=k)}),h&&(h.paddingRight="".concat(v,"px"))}d&&tN()&&(d.addEventListener("touchmove",XS,uh),u&&(u.addEventListener("touchstart",eN,uh),u.addEventListener("touchmove",ZS,uh))),Em+=1}},[r]),f=w.useCallback(function(u){if(nN){var d=document.body,h=d&&d.style;Em=Math.max(Em-1,0),r&&Em<1&&JS.forEach(function(g){var b=a.current[g];h&&(h[g]=b)}),d&&tN()&&(d.removeEventListener("touchmove",XS,uh),u&&(u.removeEventListener("touchstart",eN,uh),u.removeEventListener("touchmove",ZS,uh)))}},[r]);return w.useEffect(function(){if(n){var u=l.current;return o(u),function(){f(u)}}},[n,o,f]),function(u){l.current=u}}var fF=function(n){var t=n.target;return t.ownerDocument.activeElement&&t.ownerDocument.activeElement.blur()},hF={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function pF(e){var n=e.children,t=e.lockEnabled,r=e.captureEnabled,a=r===void 0?!0:r,l=e.onBottomArrive,o=e.onBottomLeave,f=e.onTopArrive,u=e.onTopLeave,d=uF({isEnabled:a,onBottomArrive:l,onBottomLeave:o,onTopArrive:f,onTopLeave:u}),h=dF({isEnabled:t}),g=function(v){d(v),h(v)};return bt(w.Fragment,null,t&&bt("div",{onClick:fF,css:hF}),n(g))}var mF={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},gF=function(n){var t=n.name,r=n.onFocus;return bt("input",{required:!0,name:t,tabIndex:-1,"aria-hidden":"true",onFocus:r,css:mF,value:"",onChange:function(){}})},yF=gF;function cw(e){var n;return typeof window<"u"&&window.navigator!=null?e.test(((n=window.navigator.userAgentData)===null||n===void 0?void 0:n.platform)||window.navigator.platform):!1}function xF(){return cw(/^iPhone/i)}function N2(){return cw(/^Mac/i)}function bF(){return cw(/^iPad/i)||N2()&&navigator.maxTouchPoints>1}function vF(){return xF()||bF()}function wF(){return N2()||vF()}var SF=function(n){return n.label},NF=function(n){return n.label},CF=function(n){return n.value},jF=function(n){return!!n.isDisabled},_F={clearIndicator:o3,container:KO,control:m3,dropdownIndicator:s3,group:b3,groupHeading:w3,indicatorsContainer:t3,indicatorSeparator:u3,input:j3,loadingIndicator:h3,loadingMessage:GO,menu:$O,menuList:qO,menuPortal:QO,multiValue:A3,multiValueLabel:D3,multiValueRemove:P3,noOptionsMessage:HO,option:F3,placeholder:B3,singleValue:V3,valueContainer:ZO},kF={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},EF=4,C2=4,TF=38,AF=C2*2,DF={baseUnit:C2,controlHeight:TF,menuGutter:AF},X0={borderRadius:EF,colors:kF,spacing:DF},PF={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:HS(),captureMenuScroll:!HS(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:sF(),formatGroupLabel:SF,getOptionLabel:NF,getOptionValue:CF,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:jF,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!TO(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(n){var t=n.count;return"".concat(t," result").concat(t!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function iN(e,n,t,r){var a=k2(e,n,t),l=E2(e,n,t),o=_2(e,n),f=ab(e,n);return{type:"option",data:n,isDisabled:a,isSelected:l,label:o,value:f,index:r}}function Ox(e,n){return e.options.map(function(t,r){if("options"in t){var a=t.options.map(function(o,f){return iN(e,o,n,f)}).filter(function(o){return aN(e,o)});return a.length>0?{type:"group",data:t,options:a,index:r}:void 0}var l=iN(e,t,n,r);return aN(e,l)?l:void 0}).filter(PO)}function j2(e){return e.reduce(function(n,t){return t.type==="group"?n.push.apply(n,Z1(t.options.map(function(r){return r.data}))):n.push(t.data),n},[])}function rN(e,n){return e.reduce(function(t,r){return r.type==="group"?t.push.apply(t,Z1(r.options.map(function(a){return{data:a.data,id:"".concat(n,"-").concat(r.index,"-").concat(a.index)}}))):t.push({data:r.data,id:"".concat(n,"-").concat(r.index)}),t},[])}function IF(e,n){return j2(Ox(e,n))}function aN(e,n){var t=e.inputValue,r=t===void 0?"":t,a=n.data,l=n.isSelected,o=n.label,f=n.value;return(!A2(e)||!l)&&T2(e,{label:o,value:f,data:a},r)}function MF(e,n){var t=e.focusedValue,r=e.selectValue,a=r.indexOf(t);if(a>-1){var l=n.indexOf(t);if(l>-1)return t;if(a<n.length)return n[a]}return null}function RF(e,n){var t=e.focusedOption;return t&&n.indexOf(t)>-1?t:n[0]}var Z0=function(n,t){var r,a=(r=n.find(function(l){return l.data===t}))===null||r===void 0?void 0:r.id;return a||null},_2=function(n,t){return n.getOptionLabel(t)},ab=function(n,t){return n.getOptionValue(t)};function k2(e,n,t){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(n,t):!1}function E2(e,n,t){if(t.indexOf(n)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(n,t);var r=ab(e,n);return t.some(function(a){return ab(e,a)===r})}function T2(e,n,t){return e.filterOption?e.filterOption(n,t):!0}var A2=function(n){var t=n.hideSelectedOptions,r=n.isMulti;return t===void 0?r:t},LF=1,D2=function(e){nL(t,e);var n=aL(t);function t(r){var a;if(eL(this,t),a=n.call(this,r),a.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},a.blockOptionHover=!1,a.isComposing=!1,a.commonProps=void 0,a.initialTouchX=0,a.initialTouchY=0,a.openAfterFocus=!1,a.scrollToFocusedOptionOnUpdate=!1,a.userIsDragging=void 0,a.controlRef=null,a.getControlRef=function(u){a.controlRef=u},a.focusedOptionRef=null,a.getFocusedOptionRef=function(u){a.focusedOptionRef=u},a.menuListRef=null,a.getMenuListRef=function(u){a.menuListRef=u},a.inputRef=null,a.getInputRef=function(u){a.inputRef=u},a.focus=a.focusInput,a.blur=a.blurInput,a.onChange=function(u,d){var h=a.props,g=h.onChange,b=h.name;d.name=b,a.ariaOnChange(u,d),g(u,d)},a.setValue=function(u,d,h){var g=a.props,b=g.closeMenuOnSelect,v=g.isMulti,N=g.inputValue;a.onInputChange("",{action:"set-value",prevInputValue:N}),b&&(a.setState({inputIsHiddenAfterUpdate:!v}),a.onMenuClose()),a.setState({clearFocusValueOnUpdate:!0}),a.onChange(u,{action:d,option:h})},a.selectOption=function(u){var d=a.props,h=d.blurInputOnSelect,g=d.isMulti,b=d.name,v=a.state.selectValue,N=g&&a.isOptionSelected(u,v),k=a.isOptionDisabled(u,v);if(N){var T=a.getOptionValue(u);a.setValue(v.filter(function(E){return a.getOptionValue(E)!==T}),"deselect-option",u)}else if(!k)g?a.setValue([].concat(Z1(v),[u]),"select-option",u):a.setValue(u,"select-option");else{a.ariaOnChange(u,{action:"select-option",option:u,name:b});return}h&&a.blurInput()},a.removeValue=function(u){var d=a.props.isMulti,h=a.state.selectValue,g=a.getOptionValue(u),b=h.filter(function(N){return a.getOptionValue(N)!==g}),v=mx(d,b,b[0]||null);a.onChange(v,{action:"remove-value",removedValue:u}),a.focusInput()},a.clearValue=function(){var u=a.state.selectValue;a.onChange(mx(a.props.isMulti,[],null),{action:"clear",removedValues:u})},a.popValue=function(){var u=a.props.isMulti,d=a.state.selectValue,h=d[d.length-1],g=d.slice(0,d.length-1),b=mx(u,g,g[0]||null);h&&a.onChange(b,{action:"pop-value",removedValue:h})},a.getFocusedOptionId=function(u){return Z0(a.state.focusableOptionsWithIds,u)},a.getFocusableOptionsWithIds=function(){return rN(Ox(a.props,a.state.selectValue),a.getElementId("option"))},a.getValue=function(){return a.state.selectValue},a.cx=function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return CO.apply(void 0,[a.props.classNamePrefix].concat(d))},a.getOptionLabel=function(u){return _2(a.props,u)},a.getOptionValue=function(u){return ab(a.props,u)},a.getStyles=function(u,d){var h=a.props.unstyled,g=_F[u](d,h);g.boxSizing="border-box";var b=a.props.styles[u];return b?b(g,d):g},a.getClassNames=function(u,d){var h,g;return(h=(g=a.props.classNames)[u])===null||h===void 0?void 0:h.call(g,d)},a.getElementId=function(u){return"".concat(a.state.instancePrefix,"-").concat(u)},a.getComponents=function(){return W3(a.props)},a.buildCategorizedOptions=function(){return Ox(a.props,a.state.selectValue)},a.getCategorizedOptions=function(){return a.props.menuIsOpen?a.buildCategorizedOptions():[]},a.buildFocusableOptions=function(){return j2(a.buildCategorizedOptions())},a.getFocusableOptions=function(){return a.props.menuIsOpen?a.buildFocusableOptions():[]},a.ariaOnChange=function(u,d){a.setState({ariaSelection:Ct({value:u},d)})},a.onMenuMouseDown=function(u){u.button===0&&(u.stopPropagation(),u.preventDefault(),a.focusInput())},a.onMenuMouseMove=function(u){a.blockOptionHover=!1},a.onControlMouseDown=function(u){if(!u.defaultPrevented){var d=a.props.openMenuOnClick;a.state.isFocused?a.props.menuIsOpen?u.target.tagName!=="INPUT"&&u.target.tagName!=="TEXTAREA"&&a.onMenuClose():d&&a.openMenu("first"):(d&&(a.openAfterFocus=!0),a.focusInput()),u.target.tagName!=="INPUT"&&u.target.tagName!=="TEXTAREA"&&u.preventDefault()}},a.onDropdownIndicatorMouseDown=function(u){if(!(u&&u.type==="mousedown"&&u.button!==0)&&!a.props.isDisabled){var d=a.props,h=d.isMulti,g=d.menuIsOpen;a.focusInput(),g?(a.setState({inputIsHiddenAfterUpdate:!h}),a.onMenuClose()):a.openMenu("first"),u.preventDefault()}},a.onClearIndicatorMouseDown=function(u){u&&u.type==="mousedown"&&u.button!==0||(a.clearValue(),u.preventDefault(),a.openAfterFocus=!1,u.type==="touchend"?a.focusInput():setTimeout(function(){return a.focusInput()}))},a.onScroll=function(u){typeof a.props.closeMenuOnScroll=="boolean"?u.target instanceof HTMLElement&&Eb(u.target)&&a.props.onMenuClose():typeof a.props.closeMenuOnScroll=="function"&&a.props.closeMenuOnScroll(u)&&a.props.onMenuClose()},a.onCompositionStart=function(){a.isComposing=!0},a.onCompositionEnd=function(){a.isComposing=!1},a.onTouchStart=function(u){var d=u.touches,h=d&&d.item(0);h&&(a.initialTouchX=h.clientX,a.initialTouchY=h.clientY,a.userIsDragging=!1)},a.onTouchMove=function(u){var d=u.touches,h=d&&d.item(0);if(h){var g=Math.abs(h.clientX-a.initialTouchX),b=Math.abs(h.clientY-a.initialTouchY),v=5;a.userIsDragging=g>v||b>v}},a.onTouchEnd=function(u){a.userIsDragging||(a.controlRef&&!a.controlRef.contains(u.target)&&a.menuListRef&&!a.menuListRef.contains(u.target)&&a.blurInput(),a.initialTouchX=0,a.initialTouchY=0)},a.onControlTouchEnd=function(u){a.userIsDragging||a.onControlMouseDown(u)},a.onClearIndicatorTouchEnd=function(u){a.userIsDragging||a.onClearIndicatorMouseDown(u)},a.onDropdownIndicatorTouchEnd=function(u){a.userIsDragging||a.onDropdownIndicatorMouseDown(u)},a.handleInputChange=function(u){var d=a.props.inputValue,h=u.currentTarget.value;a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange(h,{action:"input-change",prevInputValue:d}),a.props.menuIsOpen||a.onMenuOpen()},a.onInputFocus=function(u){a.props.onFocus&&a.props.onFocus(u),a.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(a.openAfterFocus||a.props.openMenuOnFocus)&&a.openMenu("first"),a.openAfterFocus=!1},a.onInputBlur=function(u){var d=a.props.inputValue;if(a.menuListRef&&a.menuListRef.contains(document.activeElement)){a.inputRef.focus();return}a.props.onBlur&&a.props.onBlur(u),a.onInputChange("",{action:"input-blur",prevInputValue:d}),a.onMenuClose(),a.setState({focusedValue:null,isFocused:!1})},a.onOptionHover=function(u){if(!(a.blockOptionHover||a.state.focusedOption===u)){var d=a.getFocusableOptions(),h=d.indexOf(u);a.setState({focusedOption:u,focusedOptionId:h>-1?a.getFocusedOptionId(u):null})}},a.shouldHideSelectedOptions=function(){return A2(a.props)},a.onValueInputFocus=function(u){u.preventDefault(),u.stopPropagation(),a.focus()},a.onKeyDown=function(u){var d=a.props,h=d.isMulti,g=d.backspaceRemovesValue,b=d.escapeClearsValue,v=d.inputValue,N=d.isClearable,k=d.isDisabled,T=d.menuIsOpen,E=d.onKeyDown,I=d.tabSelectsValue,P=d.openMenuOnFocus,V=a.state,F=V.focusedOption,$=V.focusedValue,B=V.selectValue;if(!k&&!(typeof E=="function"&&(E(u),u.defaultPrevented))){switch(a.blockOptionHover=!0,u.key){case"ArrowLeft":if(!h||v)return;a.focusValue("previous");break;case"ArrowRight":if(!h||v)return;a.focusValue("next");break;case"Delete":case"Backspace":if(v)return;if($)a.removeValue($);else{if(!g)return;h?a.popValue():N&&a.clearValue()}break;case"Tab":if(a.isComposing||u.shiftKey||!T||!I||!F||P&&a.isOptionSelected(F,B))return;a.selectOption(F);break;case"Enter":if(u.keyCode===229)break;if(T){if(!F||a.isComposing)return;a.selectOption(F);break}return;case"Escape":T?(a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange("",{action:"menu-close",prevInputValue:v}),a.onMenuClose()):N&&b&&a.clearValue();break;case" ":if(v)return;if(!T){a.openMenu("first");break}if(!F)return;a.selectOption(F);break;case"ArrowUp":T?a.focusOption("up"):a.openMenu("last");break;case"ArrowDown":T?a.focusOption("down"):a.openMenu("first");break;case"PageUp":if(!T)return;a.focusOption("pageup");break;case"PageDown":if(!T)return;a.focusOption("pagedown");break;case"Home":if(!T)return;a.focusOption("first");break;case"End":if(!T)return;a.focusOption("last");break;default:return}u.preventDefault()}},a.state.instancePrefix="react-select-"+(a.props.instanceId||++LF),a.state.selectValue=qS(r.value),r.menuIsOpen&&a.state.selectValue.length){var l=a.getFocusableOptionsWithIds(),o=a.buildFocusableOptions(),f=o.indexOf(a.state.selectValue[0]);a.state.focusableOptionsWithIds=l,a.state.focusedOption=o[f],a.state.focusedOptionId=Z0(l,o[f])}return a}return tL(t,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&VS(this.menuListRef,this.focusedOptionRef),wF()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(a){var l=this.props,o=l.isDisabled,f=l.menuIsOpen,u=this.state.isFocused;(u&&!o&&a.isDisabled||u&&f&&!a.menuIsOpen)&&this.focusInput(),u&&o&&!a.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!u&&!o&&a.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(VS(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(a,l){this.props.onInputChange(a,l)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(a){var l=this,o=this.state,f=o.selectValue,u=o.isFocused,d=this.buildFocusableOptions(),h=a==="first"?0:d.length-1;if(!this.props.isMulti){var g=d.indexOf(f[0]);g>-1&&(h=g)}this.scrollToFocusedOptionOnUpdate=!(u&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:d[h],focusedOptionId:this.getFocusedOptionId(d[h])},function(){return l.onMenuOpen()})}},{key:"focusValue",value:function(a){var l=this.state,o=l.selectValue,f=l.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var u=o.indexOf(f);f||(u=-1);var d=o.length-1,h=-1;if(o.length){switch(a){case"previous":u===0?h=0:u===-1?h=d:h=u-1;break;case"next":u>-1&&u<d&&(h=u+1);break}this.setState({inputIsHidden:h!==-1,focusedValue:o[h]})}}}},{key:"focusOption",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",l=this.props.pageSize,o=this.state.focusedOption,f=this.getFocusableOptions();if(f.length){var u=0,d=f.indexOf(o);o||(d=-1),a==="up"?u=d>0?d-1:f.length-1:a==="down"?u=(d+1)%f.length:a==="pageup"?(u=d-l,u<0&&(u=0)):a==="pagedown"?(u=d+l,u>f.length-1&&(u=f.length-1)):a==="last"&&(u=f.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:f[u],focusedValue:null,focusedOptionId:this.getFocusedOptionId(f[u])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(X0):Ct(Ct({},X0),this.props.theme):X0}},{key:"getCommonProps",value:function(){var a=this.clearValue,l=this.cx,o=this.getStyles,f=this.getClassNames,u=this.getValue,d=this.selectOption,h=this.setValue,g=this.props,b=g.isMulti,v=g.isRtl,N=g.options,k=this.hasValue();return{clearValue:a,cx:l,getStyles:o,getClassNames:f,getValue:u,hasValue:k,isMulti:b,isRtl:v,options:N,selectOption:d,selectProps:g,setValue:h,theme:this.getTheme()}}},{key:"hasValue",value:function(){var a=this.state.selectValue;return a.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var a=this.props,l=a.isClearable,o=a.isMulti;return l===void 0?o:l}},{key:"isOptionDisabled",value:function(a,l){return k2(this.props,a,l)}},{key:"isOptionSelected",value:function(a,l){return E2(this.props,a,l)}},{key:"filterOption",value:function(a,l){return T2(this.props,a,l)}},{key:"formatOptionLabel",value:function(a,l){if(typeof this.props.formatOptionLabel=="function"){var o=this.props.inputValue,f=this.state.selectValue;return this.props.formatOptionLabel(a,{context:l,inputValue:o,selectValue:f})}else return this.getOptionLabel(a)}},{key:"formatGroupLabel",value:function(a){return this.props.formatGroupLabel(a)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var a=this.props,l=a.isDisabled,o=a.isSearchable,f=a.inputId,u=a.inputValue,d=a.tabIndex,h=a.form,g=a.menuIsOpen,b=a.required,v=this.getComponents(),N=v.Input,k=this.state,T=k.inputIsHidden,E=k.ariaSelection,I=this.commonProps,P=f||this.getElementId("input"),V=Ct(Ct(Ct({"aria-autocomplete":"list","aria-expanded":g,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":b,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},g&&{"aria-controls":this.getElementId("listbox")}),!o&&{"aria-readonly":!0}),this.hasValue()?(E==null?void 0:E.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return o?w.createElement(N,Tt({},I,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:P,innerRef:this.getInputRef,isDisabled:l,isHidden:T,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:d,form:h,type:"text",value:u},V)):w.createElement(oF,Tt({id:P,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:ib,onFocus:this.onInputFocus,disabled:l,tabIndex:d,inputMode:"none",form:h,value:""},V))}},{key:"renderPlaceholderOrValue",value:function(){var a=this,l=this.getComponents(),o=l.MultiValue,f=l.MultiValueContainer,u=l.MultiValueLabel,d=l.MultiValueRemove,h=l.SingleValue,g=l.Placeholder,b=this.commonProps,v=this.props,N=v.controlShouldRenderValue,k=v.isDisabled,T=v.isMulti,E=v.inputValue,I=v.placeholder,P=this.state,V=P.selectValue,F=P.focusedValue,$=P.isFocused;if(!this.hasValue()||!N)return E?null:w.createElement(g,Tt({},b,{key:"placeholder",isDisabled:k,isFocused:$,innerProps:{id:this.getElementId("placeholder")}}),I);if(T)return V.map(function(z,q){var O=z===F,R="".concat(a.getOptionLabel(z),"-").concat(a.getOptionValue(z));return w.createElement(o,Tt({},b,{components:{Container:f,Label:u,Remove:d},isFocused:O,isDisabled:k,key:R,index:q,removeProps:{onClick:function(){return a.removeValue(z)},onTouchEnd:function(){return a.removeValue(z)},onMouseDown:function(ee){ee.preventDefault()}},data:z}),a.formatOptionLabel(z,"value"))});if(E)return null;var B=V[0];return w.createElement(h,Tt({},b,{data:B,isDisabled:k}),this.formatOptionLabel(B,"value"))}},{key:"renderClearIndicator",value:function(){var a=this.getComponents(),l=a.ClearIndicator,o=this.commonProps,f=this.props,u=f.isDisabled,d=f.isLoading,h=this.state.isFocused;if(!this.isClearable()||!l||u||!this.hasValue()||d)return null;var g={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(l,Tt({},o,{innerProps:g,isFocused:h}))}},{key:"renderLoadingIndicator",value:function(){var a=this.getComponents(),l=a.LoadingIndicator,o=this.commonProps,f=this.props,u=f.isDisabled,d=f.isLoading,h=this.state.isFocused;if(!l||!d)return null;var g={"aria-hidden":"true"};return w.createElement(l,Tt({},o,{innerProps:g,isDisabled:u,isFocused:h}))}},{key:"renderIndicatorSeparator",value:function(){var a=this.getComponents(),l=a.DropdownIndicator,o=a.IndicatorSeparator;if(!l||!o)return null;var f=this.commonProps,u=this.props.isDisabled,d=this.state.isFocused;return w.createElement(o,Tt({},f,{isDisabled:u,isFocused:d}))}},{key:"renderDropdownIndicator",value:function(){var a=this.getComponents(),l=a.DropdownIndicator;if(!l)return null;var o=this.commonProps,f=this.props.isDisabled,u=this.state.isFocused,d={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(l,Tt({},o,{innerProps:d,isDisabled:f,isFocused:u}))}},{key:"renderMenu",value:function(){var a=this,l=this.getComponents(),o=l.Group,f=l.GroupHeading,u=l.Menu,d=l.MenuList,h=l.MenuPortal,g=l.LoadingMessage,b=l.NoOptionsMessage,v=l.Option,N=this.commonProps,k=this.state.focusedOption,T=this.props,E=T.captureMenuScroll,I=T.inputValue,P=T.isLoading,V=T.loadingMessage,F=T.minMenuHeight,$=T.maxMenuHeight,B=T.menuIsOpen,z=T.menuPlacement,q=T.menuPosition,O=T.menuPortalTarget,R=T.menuShouldBlockScroll,G=T.menuShouldScrollIntoView,ee=T.noOptionsMessage,te=T.onMenuScrollToTop,le=T.onMenuScrollToBottom;if(!B)return null;var K=function(M,de){var Se=M.type,fe=M.data,we=M.isDisabled,re=M.isSelected,_e=M.label,qe=M.value,et=k===fe,Je=we?void 0:function(){return a.onOptionHover(fe)},Le=we?void 0:function(){return a.selectOption(fe)},xe="".concat(a.getElementId("option"),"-").concat(de),Me={id:xe,onClick:Le,onMouseMove:Je,onMouseOver:Je,tabIndex:-1,role:"option","aria-selected":a.state.isAppleDevice?void 0:re};return w.createElement(v,Tt({},N,{innerProps:Me,data:fe,isDisabled:we,isSelected:re,key:xe,label:_e,type:Se,value:qe,isFocused:et,innerRef:et?a.getFocusedOptionRef:void 0}),a.formatOptionLabel(M.data,"menu"))},U;if(this.hasOptions())U=this.getCategorizedOptions().map(function(ce){if(ce.type==="group"){var M=ce.data,de=ce.options,Se=ce.index,fe="".concat(a.getElementId("group"),"-").concat(Se),we="".concat(fe,"-heading");return w.createElement(o,Tt({},N,{key:fe,data:M,options:de,Heading:f,headingProps:{id:we,data:ce.data},label:a.formatGroupLabel(ce.data)}),ce.options.map(function(re){return K(re,"".concat(Se,"-").concat(re.index))}))}else if(ce.type==="option")return K(ce,"".concat(ce.index))});else if(P){var J=V({inputValue:I});if(J===null)return null;U=w.createElement(g,N,J)}else{var ne=ee({inputValue:I});if(ne===null)return null;U=w.createElement(b,N,ne)}var A={minMenuHeight:F,maxMenuHeight:$,menuPlacement:z,menuPosition:q,menuShouldScrollIntoView:G},ae=w.createElement(zO,Tt({},N,A),function(ce){var M=ce.ref,de=ce.placerProps,Se=de.placement,fe=de.maxHeight;return w.createElement(u,Tt({},N,A,{innerRef:M,innerProps:{onMouseDown:a.onMenuMouseDown,onMouseMove:a.onMenuMouseMove},isLoading:P,placement:Se}),w.createElement(pF,{captureEnabled:E,onTopArrive:te,onBottomArrive:le,lockEnabled:R},function(we){return w.createElement(d,Tt({},N,{innerRef:function(_e){a.getMenuListRef(_e),we(_e)},innerProps:{role:"listbox","aria-multiselectable":N.isMulti,id:a.getElementId("listbox")},isLoading:P,maxHeight:fe,focusedOption:k}),U)}))});return O||q==="fixed"?w.createElement(h,Tt({},N,{appendTo:O,controlElement:this.controlRef,menuPlacement:z,menuPosition:q}),ae):ae}},{key:"renderFormField",value:function(){var a=this,l=this.props,o=l.delimiter,f=l.isDisabled,u=l.isMulti,d=l.name,h=l.required,g=this.state.selectValue;if(h&&!this.hasValue()&&!f)return w.createElement(yF,{name:d,onFocus:this.onValueInputFocus});if(!(!d||f))if(u)if(o){var b=g.map(function(k){return a.getOptionValue(k)}).join(o);return w.createElement("input",{name:d,type:"hidden",value:b})}else{var v=g.length>0?g.map(function(k,T){return w.createElement("input",{key:"i-".concat(T),name:d,type:"hidden",value:a.getOptionValue(k)})}):w.createElement("input",{name:d,type:"hidden",value:""});return w.createElement("div",null,v)}else{var N=g[0]?this.getOptionValue(g[0]):"";return w.createElement("input",{name:d,type:"hidden",value:N})}}},{key:"renderLiveRegion",value:function(){var a=this.commonProps,l=this.state,o=l.ariaSelection,f=l.focusedOption,u=l.focusedValue,d=l.isFocused,h=l.selectValue,g=this.getFocusableOptions();return w.createElement(nF,Tt({},a,{id:this.getElementId("live-region"),ariaSelection:o,focusedOption:f,focusedValue:u,isFocused:d,selectValue:h,focusableOptions:g,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var a=this.getComponents(),l=a.Control,o=a.IndicatorsContainer,f=a.SelectContainer,u=a.ValueContainer,d=this.props,h=d.className,g=d.id,b=d.isDisabled,v=d.menuIsOpen,N=this.state.isFocused,k=this.commonProps=this.getCommonProps();return w.createElement(f,Tt({},k,{className:h,innerProps:{id:g,onKeyDown:this.onKeyDown},isDisabled:b,isFocused:N}),this.renderLiveRegion(),w.createElement(l,Tt({},k,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:b,isFocused:N,menuIsOpen:v}),w.createElement(u,Tt({},k,{isDisabled:b}),this.renderPlaceholderOrValue(),this.renderInput()),w.createElement(o,Tt({},k,{isDisabled:b}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(a,l){var o=l.prevProps,f=l.clearFocusValueOnUpdate,u=l.inputIsHiddenAfterUpdate,d=l.ariaSelection,h=l.isFocused,g=l.prevWasFocused,b=l.instancePrefix,v=a.options,N=a.value,k=a.menuIsOpen,T=a.inputValue,E=a.isMulti,I=qS(N),P={};if(o&&(N!==o.value||v!==o.options||k!==o.menuIsOpen||T!==o.inputValue)){var V=k?IF(a,I):[],F=k?rN(Ox(a,I),"".concat(b,"-option")):[],$=f?MF(l,I):null,B=RF(l,V),z=Z0(F,B);P={selectValue:I,focusedOption:B,focusedOptionId:z,focusableOptionsWithIds:F,focusedValue:$,clearFocusValueOnUpdate:!1}}var q=u!=null&&a!==o?{inputIsHidden:u,inputIsHiddenAfterUpdate:void 0}:{},O=d,R=h&&g;return h&&!R&&(O={value:mx(E,I,I[0]||null),options:I,action:"initial-input-focus"},R=!g),(d==null?void 0:d.action)==="initial-input-focus"&&(O=null),Ct(Ct(Ct({},P),q),{},{prevProps:a,ariaSelection:O,prevWasFocused:R})}}]),t}(w.Component);D2.defaultProps=PF;var OF=w.forwardRef(function(e,n){var t=Z4(e);return w.createElement(D2,Tt({ref:n},t))}),P2=OF;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let FF,$F;function zF(){return{geminiUrl:FF,vertexUrl:$F}}function BF(e,n,t){var r,a,l;if(!(!((r=e.httpOptions)===null||r===void 0)&&r.baseUrl)){const o=zF();return e.vertexai?(a=o.vertexUrl)!==null&&a!==void 0?a:n:(l=o.geminiUrl)!==null&&l!==void 0?l:t}return e.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lg{}function Pt(e,n){const t=/\{([^}]+)\}/g;return e.replace(t,(r,a)=>{if(Object.prototype.hasOwnProperty.call(n,a)){const l=n[a];return l!=null?String(l):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function j(e,n,t){for(let l=0;l<n.length-1;l++){const o=n[l];if(o.endsWith("[]")){const f=o.slice(0,-2);if(!(f in e))if(Array.isArray(t))e[f]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(e[f])){const u=e[f];if(Array.isArray(t))for(let d=0;d<u.length;d++){const h=u[d];j(h,n.slice(l+1),t[d])}else for(const d of u)j(d,n.slice(l+1),t)}return}else if(o.endsWith("[0]")){const f=o.slice(0,-3);f in e||(e[f]=[{}]);const u=e[f];j(u[0],n.slice(l+1),t);return}(!e[o]||typeof e[o]!="object")&&(e[o]={}),e=e[o]}const r=n[n.length-1],a=e[r];if(a!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===a)return;if(typeof a=="object"&&typeof t=="object"&&a!==null&&t!==null)Object.assign(a,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else e[r]=t}function C(e,n){try{if(n.length===1&&n[0]==="_self")return e;for(let t=0;t<n.length;t++){if(typeof e!="object"||e===null)return;const r=n[t];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in e){const l=e[a];return Array.isArray(l)?l.map(o=>C(o,n.slice(t+1))):void 0}else return}else e=e[r]}return e}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function oi(e,n){if(!n||typeof n!="string")throw new Error("model is required and must be a string");if(e.isVertexAI()){if(n.startsWith("publishers/")||n.startsWith("projects/")||n.startsWith("models/"))return n;if(n.indexOf("/")>=0){const t=n.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${n}`}else return n.startsWith("models/")||n.startsWith("tunedModels/")?n:`models/${n}`}function I2(e,n){const t=oi(e,n);return t?t.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:t.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${t}`:t:""}function M2(e,n){return Array.isArray(n)?n.map(t=>sb(e,t)):[sb(e,n)]}function sb(e,n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function UF(e,n){const t=sb(e,n);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function qF(e,n){const t=sb(e,n);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function sN(e,n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function R2(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(t=>sN(e,t)):[sN(e,n)]}function Xv(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function lN(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function oN(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function na(e,n){if(n==null)throw new Error("ContentUnion is required");return Xv(n)?n:{role:"user",parts:R2(e,n)}}function L2(e,n){if(!n)return[];if(e.isVertexAI()&&Array.isArray(n))return n.flatMap(t=>{const r=na(e,t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const t=na(e,n);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(n)?n.map(t=>na(e,t)):[na(e,n)]}function Gc(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(lN(n)||oN(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[na(e,n)]}const t=[],r=[],a=Xv(n[0]);for(const l of n){const o=Xv(l);if(o!=a)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)t.push(l);else{if(lN(l)||oN(l))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(l)}}return a||t.push({role:"user",parts:R2(e,r)}),t}function O2(e,n){return n}function F2(e,n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Tb(e,n){return n}function Ab(e,n){if(!Array.isArray(n))throw new Error("tool is required and must be an array of Tools");return n}function VF(e,n,t,r=1){const a=!n.startsWith(`${t}/`)&&n.split("/").length===r;return e.isVertexAI()?n.startsWith("projects/")?n:n.startsWith("locations/")?`projects/${e.getProject()}/${n}`:n.startsWith(`${t}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:a?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}/${n}`:n:a?`${t}/${n}`:n}function Yc(e,n){if(typeof n!="string")throw new Error("name must be a string");return VF(e,n,"cachedContents")}function $2(e,n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Wc(e,n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function HF(e){return e!=null&&typeof e=="object"&&"name"in e}function GF(e){return e!=null&&typeof e=="object"&&"video"in e}function YF(e){return e!=null&&typeof e=="object"&&"uri"in e}function z2(e,n){var t;let r;if(HF(n)&&(r=n.name),!(YF(n)&&(r=n.uri,r===void 0))&&!(GF(n)&&(r=(t=n.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof n=="string"&&(r=n),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const l=r.split("files/")[1].match(/[a-z0-9]+/);if(l===null)throw new Error(`Could not extract file name from URI ${r}`);r=l[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function B2(e,n){let t;return e.isVertexAI()?t=n?"publishers/google/models":"models":t=n?"models":"tunedModels",t}function U2(e,n){for(const t of["models","tunedModels","publisherModels"])if(WF(n,t))return n[t];return[]}function WF(e,n){return e!==null&&typeof e=="object"&&n in e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function QF(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&j(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function JF(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&j(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],QF(e,a));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const o=C(n,["executableCode"]);o!=null&&j(t,["executableCode"],o);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const d=C(n,["functionResponse"]);d!=null&&j(t,["functionResponse"],d);const h=C(n,["text"]);return h!=null&&j(t,["text"],h),t}function cN(e,n){const t={},r=C(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>JF(e,o))),j(t,["parts"],l)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function KF(){return{}}function XF(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function ZF(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],XF(e,r)),t}function e6(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&j(t,["googleSearch"],KF());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&j(t,["googleSearchRetrieval"],ZF(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=C(n,["codeExecution"]);l!=null&&j(t,["codeExecution"],l);const o=C(n,["functionDeclarations"]);return o!=null&&j(t,["functionDeclarations"],o),t}function t6(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function n6(e,n){const t={},r=C(n,["functionCallingConfig"]);if(r!=null&&j(t,["functionCallingConfig"],t6(e,r)),C(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function i6(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const l=C(n,["expireTime"]);t!==void 0&&l!=null&&j(t,["expireTime"],l);const o=C(n,["displayName"]);t!==void 0&&o!=null&&j(t,["displayName"],o);const f=C(n,["contents"]);if(t!==void 0&&f!=null){let g=Gc(e,f);Array.isArray(g)&&(g=g.map(b=>cN(e,b))),j(t,["contents"],g)}const u=C(n,["systemInstruction"]);t!==void 0&&u!=null&&j(t,["systemInstruction"],cN(e,na(e,u)));const d=C(n,["tools"]);if(t!==void 0&&d!=null){let g=d;Array.isArray(g)&&(g=g.map(b=>e6(e,b))),j(t,["tools"],g)}const h=C(n,["toolConfig"]);return t!==void 0&&h!=null&&j(t,["toolConfig"],n6(e,h)),r}function r6(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["model"],I2(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],i6(e,a,t)),t}function a6(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],Yc(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function s6(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],Yc(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function l6(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const l=C(n,["expireTime"]);return t!==void 0&&l!=null&&j(t,["expireTime"],l),r}function o6(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],Yc(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],l6(e,a,t)),t}function c6(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const l=C(n,["pageToken"]);return t!==void 0&&l!=null&&j(t,["_query","pageToken"],l),r}function u6(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],c6(e,r,t)),t}function d6(e,n){const t={},r=C(n,["displayName"]);r!=null&&j(t,["displayName"],r);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const l=C(n,["mimeType"]);return l!=null&&j(t,["mimeType"],l),t}function f6(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&j(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const l=C(n,["inlineData"]);l!=null&&j(t,["inlineData"],d6(e,l));const o=C(n,["codeExecutionResult"]);o!=null&&j(t,["codeExecutionResult"],o);const f=C(n,["executableCode"]);f!=null&&j(t,["executableCode"],f);const u=C(n,["fileData"]);u!=null&&j(t,["fileData"],u);const d=C(n,["functionCall"]);d!=null&&j(t,["functionCall"],d);const h=C(n,["functionResponse"]);h!=null&&j(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function uN(e,n){const t={},r=C(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>f6(e,o))),j(t,["parts"],l)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function h6(){return{}}function p6(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function m6(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],p6(e,r)),t}function g6(){return{}}function y6(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&j(t,["apiKeyString"],r),t}function x6(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&j(t,["apiKeyConfig"],y6(e,r));const a=C(n,["authType"]);a!=null&&j(t,["authType"],a);const l=C(n,["googleServiceAccountConfig"]);l!=null&&j(t,["googleServiceAccountConfig"],l);const o=C(n,["httpBasicAuthConfig"]);o!=null&&j(t,["httpBasicAuthConfig"],o);const f=C(n,["oauthConfig"]);f!=null&&j(t,["oauthConfig"],f);const u=C(n,["oidcConfig"]);return u!=null&&j(t,["oidcConfig"],u),t}function b6(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&j(t,["authConfig"],x6(e,r)),t}function v6(e,n){const t={},r=C(n,["retrieval"]);r!=null&&j(t,["retrieval"],r),C(n,["googleSearch"])!=null&&j(t,["googleSearch"],h6());const l=C(n,["googleSearchRetrieval"]);l!=null&&j(t,["googleSearchRetrieval"],m6(e,l)),C(n,["enterpriseWebSearch"])!=null&&j(t,["enterpriseWebSearch"],g6());const f=C(n,["googleMaps"]);f!=null&&j(t,["googleMaps"],b6(e,f));const u=C(n,["codeExecution"]);u!=null&&j(t,["codeExecution"],u);const d=C(n,["functionDeclarations"]);return d!=null&&j(t,["functionDeclarations"],d),t}function w6(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function S6(e,n){const t={},r=C(n,["latitude"]);r!=null&&j(t,["latitude"],r);const a=C(n,["longitude"]);return a!=null&&j(t,["longitude"],a),t}function N6(e,n){const t={},r=C(n,["latLng"]);return r!=null&&j(t,["latLng"],S6(e,r)),t}function C6(e,n){const t={},r=C(n,["functionCallingConfig"]);r!=null&&j(t,["functionCallingConfig"],w6(e,r));const a=C(n,["retrievalConfig"]);return a!=null&&j(t,["retrievalConfig"],N6(e,a)),t}function j6(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const l=C(n,["expireTime"]);t!==void 0&&l!=null&&j(t,["expireTime"],l);const o=C(n,["displayName"]);t!==void 0&&o!=null&&j(t,["displayName"],o);const f=C(n,["contents"]);if(t!==void 0&&f!=null){let g=Gc(e,f);Array.isArray(g)&&(g=g.map(b=>uN(e,b))),j(t,["contents"],g)}const u=C(n,["systemInstruction"]);t!==void 0&&u!=null&&j(t,["systemInstruction"],uN(e,na(e,u)));const d=C(n,["tools"]);if(t!==void 0&&d!=null){let g=d;Array.isArray(g)&&(g=g.map(b=>v6(e,b))),j(t,["tools"],g)}const h=C(n,["toolConfig"]);return t!==void 0&&h!=null&&j(t,["toolConfig"],C6(e,h)),r}function _6(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["model"],I2(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],j6(e,a,t)),t}function k6(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],Yc(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function E6(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],Yc(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function T6(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const l=C(n,["expireTime"]);return t!==void 0&&l!=null&&j(t,["expireTime"],l),r}function A6(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],Yc(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],T6(e,a,t)),t}function D6(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const l=C(n,["pageToken"]);return t!==void 0&&l!=null&&j(t,["_query","pageToken"],l),r}function P6(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],D6(e,r,t)),t}function Fx(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const l=C(n,["model"]);l!=null&&j(t,["model"],l);const o=C(n,["createTime"]);o!=null&&j(t,["createTime"],o);const f=C(n,["updateTime"]);f!=null&&j(t,["updateTime"],f);const u=C(n,["expireTime"]);u!=null&&j(t,["expireTime"],u);const d=C(n,["usageMetadata"]);return d!=null&&j(t,["usageMetadata"],d),t}function I6(){return{}}function M6(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["cachedContents"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(o=>Fx(e,o))),j(t,["cachedContents"],l)}return t}function $x(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const l=C(n,["model"]);l!=null&&j(t,["model"],l);const o=C(n,["createTime"]);o!=null&&j(t,["createTime"],o);const f=C(n,["updateTime"]);f!=null&&j(t,["updateTime"],f);const u=C(n,["expireTime"]);u!=null&&j(t,["expireTime"],u);const d=C(n,["usageMetadata"]);return d!=null&&j(t,["usageMetadata"],d),t}function R6(){return{}}function L6(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["cachedContents"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(o=>$x(e,o))),j(t,["cachedContents"],l)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ah;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Ah||(Ah={}));class Db{constructor(n,t,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(n,r,a)}init(n,t,r){var a,l;this.nameInternal=n,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let o={config:{}};r?typeof r=="object"?o=Object.assign({},r):o=r:o={config:{}},o.config&&(o.config.pageToken=t.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(l=(a=o.config)===null||a===void 0?void 0:a.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(n){this.init(this.nameInternal,n,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(n){return this.pageInternal[n]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const n=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:n,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const n=await this.requestInternal(this.params);return this.initNextPage(n),this.page}hasNextPage(){var n;return((n=this.params.config)===null||n===void 0?void 0:n.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var dN;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(dN||(dN={}));var fN;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(fN||(fN={}));var hN;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(hN||(hN={}));var pN;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(pN||(pN={}));var mN;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(mN||(mN={}));var gN;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(gN||(gN={}));var yN;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(yN||(yN={}));var Dh;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT"})(Dh||(Dh={}));var xN;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY"})(xN||(xN={}));var bN;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(bN||(bN={}));var vN;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(vN||(vN={}));var wN;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(wN||(wN={}));var SN;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(SN||(SN={}));var Vc;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(Vc||(Vc={}));var NN;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(NN||(NN={}));var Zv;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Zv||(Zv={}));var CN;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(CN||(CN={}));var jN;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(jN||(jN={}));var _N;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(_N||(_N={}));var kN;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(kN||(kN={}));var EN;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(EN||(EN={}));var TN;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(TN||(TN={}));var AN;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi"})(AN||(AN={}));var DN;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(DN||(DN={}));var PN;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(PN||(PN={}));var IN;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(IN||(IN={}));var MN;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(MN||(MN={}));var RN;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(RN||(RN={}));var LN;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(LN||(LN={}));var ON;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(ON||(ON={}));var FN;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(FN||(FN={}));var $N;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})($N||($N={}));var zN;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(zN||(zN={}));var BN;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(BN||(BN={}));class gx{get text(){var n,t,r,a,l,o,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",h=!1;const g=[];for(const b of(u=(f=(o=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||o===void 0?void 0:o.content)===null||f===void 0?void 0:f.parts)!==null&&u!==void 0?u:[]){for(const[v,N]of Object.entries(b))v!=="text"&&v!=="thought"&&(N!==null||N!==void 0)&&g.push(v);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;h=!0,d+=b.text}}return g.length>0&&console.warn(`there are non-text parts ${g} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?d:void 0}get data(){var n,t,r,a,l,o,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const h=[];for(const g of(u=(f=(o=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||o===void 0?void 0:o.content)===null||f===void 0?void 0:f.parts)!==null&&u!==void 0?u:[]){for(const[b,v]of Object.entries(g))b!=="inlineData"&&(v!==null||v!==void 0)&&h.push(b);g.inlineData&&typeof g.inlineData.data=="string"&&(d+=atob(g.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var n,t,r,a,l,o,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(u=(f=(o=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||o===void 0?void 0:o.content)===null||f===void 0?void 0:f.parts)===null||u===void 0?void 0:u.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var n,t,r,a,l,o,f,u,d;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(u=(f=(o=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||o===void 0?void 0:o.content)===null||f===void 0?void 0:f.parts)===null||u===void 0?void 0:u.filter(g=>g.executableCode).map(g=>g.executableCode).filter(g=>g!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var n,t,r,a,l,o,f,u,d;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(u=(f=(o=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||o===void 0?void 0:o.content)===null||f===void 0?void 0:f.parts)===null||u===void 0?void 0:u.filter(g=>g.codeExecutionResult).map(g=>g.codeExecutionResult).filter(g=>g!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.output}}class UN{}class qN{}class O6{}class F6{}class VN{}class HN{}class GN{}class $6{}class YN{}class WN{}class QN{}class z6{}class e1{constructor(n){const t={};for(const r of n.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=n}json(){return this.responseInternal.json()}}class B6{}class U6{}class q6{get text(){var n,t,r;let a="",l=!1;const o=[];for(const f of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[u,d]of Object.entries(f))u!=="text"&&u!=="thought"&&d!==null&&o.push(u);if(typeof f.text=="string"){if(typeof f.thought=="boolean"&&f.thought)continue;l=!0,a+=f.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?a:void 0}get data(){var n,t,r;let a="";const l=[];for(const o of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[f,u]of Object.entries(o))f!=="inlineData"&&u!==null&&l.push(f);o.inlineData&&typeof o.inlineData.data=="string"&&(a+=atob(o.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class V6 extends lg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Db(Ah.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=_6(this.apiClient,n);return f=Pt("cachedContents",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>$x(this.apiClient,h))}else{const d=r6(this.apiClient,n);return f=Pt("cachedContents",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>Fx(this.apiClient,h))}}async get(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=k6(this.apiClient,n);return f=Pt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>$x(this.apiClient,h))}else{const d=a6(this.apiClient,n);return f=Pt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>Fx(this.apiClient,h))}}async delete(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=E6(this.apiClient,n);return f=Pt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(()=>{const h=R6(),g=new WN;return Object.assign(g,h),g})}else{const d=s6(this.apiClient,n);return f=Pt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(()=>{const h=I6(),g=new WN;return Object.assign(g,h),g})}}async update(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=A6(this.apiClient,n);return f=Pt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>$x(this.apiClient,h))}else{const d=o6(this.apiClient,n);return f=Pt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>Fx(this.apiClient,h))}}async listInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=P6(this.apiClient,n);return f=Pt("cachedContents",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=L6(this.apiClient,h),b=new QN;return Object.assign(b,g),b})}else{const d=u6(this.apiClient,n);return f=Pt("cachedContents",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=M6(this.apiClient,h),b=new QN;return Object.assign(b,g),b})}}}function JN(e){var n=typeof Symbol=="function"&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function Sr(e){return this instanceof Sr?(this.v=e,this):new Sr(e)}function lb(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(e,n||[]),a,l=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),f("next"),f("throw"),f("return",o),a[Symbol.asyncIterator]=function(){return this},a;function o(v){return function(N){return Promise.resolve(N).then(v,g)}}function f(v,N){r[v]&&(a[v]=function(k){return new Promise(function(T,E){l.push([v,k,T,E])>1||u(v,k)})},N&&(a[v]=N(a[v])))}function u(v,N){try{d(r[v](N))}catch(k){b(l[0][3],k)}}function d(v){v.value instanceof Sr?Promise.resolve(v.value.v).then(h,g):b(l[0][2],v)}function h(v){u("next",v)}function g(v){u("throw",v)}function b(v,N){v(N),l.shift(),l.length&&u(l[0][0],l[0][1])}}function t1(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e[Symbol.asyncIterator],t;return n?n.call(e):(e=typeof JN=="function"?JN(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(l){t[l]=e[l]&&function(o){return new Promise(function(f,u){o=e[l](o),a(f,u,o.done,o.value)})}}function a(l,o,f,u){Promise.resolve(u).then(function(d){l({value:d,done:f})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function H6(e){var n;if(e.candidates==null||e.candidates.length===0)return!1;const t=(n=e.candidates[0])===null||n===void 0?void 0:n.content;return t===void 0?!1:q2(t)}function q2(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const n of e.parts)if(n===void 0||Object.keys(n).length===0||n.text!==void 0&&n.text==="")return!1;return!0}function G6(e){if(e.length!==0){if(e[0].role!=="user")throw new Error("History must start with a user turn.");for(const n of e)if(n.role!=="user"&&n.role!=="model")throw new Error(`Role must be user or model, but got ${n.role}.`)}}function Y6(e){if(e===void 0||e.length===0)return[];const n=[],t=e.length;let r=0,a=e[0];for(;r<t;)if(e[r].role==="user")a=e[r],r++;else{const l=[];let o=!0;for(;r<t&&e[r].role==="model";)l.push(e[r]),o&&!q2(e[r])&&(o=!1),r++;o&&(n.push(a),n.push(...l))}return n}class W6{constructor(n,t){this.modelsModule=n,this.apiClient=t}create(n){return new Q6(this.apiClient,this.modelsModule,n.model,n.config,n.history)}}class Q6{constructor(n,t,r,a={},l=[]){this.apiClient=n,this.modelsModule=t,this.model=r,this.config=a,this.history=l,this.sendPromise=Promise.resolve(),G6(l)}async sendMessage(n){var t;await this.sendPromise;const r=na(this.apiClient,n.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var l,o;const u=(o=(l=(await a).candidates)===null||l===void 0?void 0:l[0])===null||o===void 0?void 0:o.content,d=u?[u]:[];this.recordHistory(r,d)})(),await this.sendPromise,a}async sendMessageStream(n){var t;await this.sendPromise;const r=na(this.apiClient,n.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const l=await a;return this.processStreamResponse(l,r)}getHistory(n=!1){return n?Y6(this.history):this.history}processStreamResponse(n,t){var r,a;return lb(this,arguments,function*(){var o,f,u,d;const h=[];try{for(var g=!0,b=t1(n),v;v=yield Sr(b.next()),o=v.done,!o;g=!0){d=v.value,g=!1;const N=d;if(H6(N)){const k=(a=(r=N.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;k!==void 0&&h.push(k)}yield yield Sr(N)}}catch(N){f={error:N}}finally{try{!g&&!o&&(u=b.return)&&(yield Sr(u.call(b)))}finally{if(f)throw f.error}}this.recordHistory(t,h)})}recordHistory(n,t){let r=[];t.length>0&&t.every(a=>a.role==="model")?r=t:r.push({role:"model",parts:[]}),this.history.push(n),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function J6(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const l=C(n,["pageToken"]);return t!==void 0&&l!=null&&j(t,["_query","pageToken"],l),r}function K6(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],J6(e,r,t)),t}function X6(e,n){const t={},r=C(n,["details"]);r!=null&&j(t,["details"],r);const a=C(n,["message"]);a!=null&&j(t,["message"],a);const l=C(n,["code"]);return l!=null&&j(t,["code"],l),t}function Z6(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const l=C(n,["mimeType"]);l!=null&&j(t,["mimeType"],l);const o=C(n,["sizeBytes"]);o!=null&&j(t,["sizeBytes"],o);const f=C(n,["createTime"]);f!=null&&j(t,["createTime"],f);const u=C(n,["expirationTime"]);u!=null&&j(t,["expirationTime"],u);const d=C(n,["updateTime"]);d!=null&&j(t,["updateTime"],d);const h=C(n,["sha256Hash"]);h!=null&&j(t,["sha256Hash"],h);const g=C(n,["uri"]);g!=null&&j(t,["uri"],g);const b=C(n,["downloadUri"]);b!=null&&j(t,["downloadUri"],b);const v=C(n,["state"]);v!=null&&j(t,["state"],v);const N=C(n,["source"]);N!=null&&j(t,["source"],N);const k=C(n,["videoMetadata"]);k!=null&&j(t,["videoMetadata"],k);const T=C(n,["error"]);return T!=null&&j(t,["error"],X6(e,T)),t}function e5(e,n){const t={},r=C(n,["file"]);r!=null&&j(t,["file"],Z6(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function t5(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","file"],z2(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function n5(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","file"],z2(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function i5(e,n){const t={},r=C(n,["details"]);r!=null&&j(t,["details"],r);const a=C(n,["message"]);a!=null&&j(t,["message"],a);const l=C(n,["code"]);return l!=null&&j(t,["code"],l),t}function n1(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const l=C(n,["mimeType"]);l!=null&&j(t,["mimeType"],l);const o=C(n,["sizeBytes"]);o!=null&&j(t,["sizeBytes"],o);const f=C(n,["createTime"]);f!=null&&j(t,["createTime"],f);const u=C(n,["expirationTime"]);u!=null&&j(t,["expirationTime"],u);const d=C(n,["updateTime"]);d!=null&&j(t,["updateTime"],d);const h=C(n,["sha256Hash"]);h!=null&&j(t,["sha256Hash"],h);const g=C(n,["uri"]);g!=null&&j(t,["uri"],g);const b=C(n,["downloadUri"]);b!=null&&j(t,["downloadUri"],b);const v=C(n,["state"]);v!=null&&j(t,["state"],v);const N=C(n,["source"]);N!=null&&j(t,["source"],N);const k=C(n,["videoMetadata"]);k!=null&&j(t,["videoMetadata"],k);const T=C(n,["error"]);return T!=null&&j(t,["error"],i5(e,T)),t}function r5(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["files"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(o=>n1(e,o))),j(t,["files"],l)}return t}function a5(){return{}}function s5(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class l5 extends lg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Db(Ah.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(n){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(n.file,n.config).then(t=>n1(this.apiClient,t))}async download(n){await this.apiClient.downloadFile(n)}async listInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=K6(this.apiClient,n);return l=Pt("files",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>{const d=r5(this.apiClient,u),h=new z6;return Object.assign(h,d),h})}}async createInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=e5(this.apiClient,n);return l=Pt("upload/v1beta/files",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(()=>{const u=a5(),d=new B6;return Object.assign(d,u),d})}}async get(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=t5(this.apiClient,n);return l=Pt("files/{file}",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>n1(this.apiClient,u))}}async delete(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=n5(this.apiClient,n);return l=Pt("files/{file}",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(()=>{const u=s5(),d=new U6;return Object.assign(d,u),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function o5(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&j(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function c5(e,n){const t={},r=C(n,["displayName"]);r!=null&&j(t,["displayName"],r);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const l=C(n,["mimeType"]);return l!=null&&j(t,["mimeType"],l),t}function u5(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&j(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],o5(e,a));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const o=C(n,["executableCode"]);o!=null&&j(t,["executableCode"],o);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const d=C(n,["functionResponse"]);d!=null&&j(t,["functionResponse"],d);const h=C(n,["text"]);return h!=null&&j(t,["text"],h),t}function d5(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&j(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const l=C(n,["inlineData"]);l!=null&&j(t,["inlineData"],c5(e,l));const o=C(n,["codeExecutionResult"]);o!=null&&j(t,["codeExecutionResult"],o);const f=C(n,["executableCode"]);f!=null&&j(t,["executableCode"],f);const u=C(n,["fileData"]);u!=null&&j(t,["fileData"],u);const d=C(n,["functionCall"]);d!=null&&j(t,["functionCall"],d);const h=C(n,["functionResponse"]);h!=null&&j(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function f5(e,n){const t={},r=C(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>u5(e,o))),j(t,["parts"],l)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function h5(e,n){const t={},r=C(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>d5(e,o))),j(t,["parts"],l)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function p5(){return{}}function m5(){return{}}function g5(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function y5(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function x5(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],g5(e,r)),t}function b5(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],y5(e,r)),t}function v5(){return{}}function w5(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&j(t,["apiKeyString"],r),t}function S5(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&j(t,["apiKeyConfig"],w5(e,r));const a=C(n,["authType"]);a!=null&&j(t,["authType"],a);const l=C(n,["googleServiceAccountConfig"]);l!=null&&j(t,["googleServiceAccountConfig"],l);const o=C(n,["httpBasicAuthConfig"]);o!=null&&j(t,["httpBasicAuthConfig"],o);const f=C(n,["oauthConfig"]);f!=null&&j(t,["oauthConfig"],f);const u=C(n,["oidcConfig"]);return u!=null&&j(t,["oidcConfig"],u),t}function N5(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&j(t,["authConfig"],S5(e,r)),t}function C5(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&j(t,["googleSearch"],p5());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&j(t,["googleSearchRetrieval"],x5(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=C(n,["codeExecution"]);l!=null&&j(t,["codeExecution"],l);const o=C(n,["functionDeclarations"]);return o!=null&&j(t,["functionDeclarations"],o),t}function j5(e,n){const t={},r=C(n,["retrieval"]);r!=null&&j(t,["retrieval"],r),C(n,["googleSearch"])!=null&&j(t,["googleSearch"],m5());const l=C(n,["googleSearchRetrieval"]);l!=null&&j(t,["googleSearchRetrieval"],b5(e,l)),C(n,["enterpriseWebSearch"])!=null&&j(t,["enterpriseWebSearch"],v5());const f=C(n,["googleMaps"]);f!=null&&j(t,["googleMaps"],N5(e,f));const u=C(n,["codeExecution"]);u!=null&&j(t,["codeExecution"],u);const d=C(n,["functionDeclarations"]);return d!=null&&j(t,["functionDeclarations"],d),t}function _5(e,n){const t={},r=C(n,["handle"]);if(r!=null&&j(t,["handle"],r),C(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function k5(e,n){const t={},r=C(n,["handle"]);r!=null&&j(t,["handle"],r);const a=C(n,["transparent"]);return a!=null&&j(t,["transparent"],a),t}function KN(){return{}}function XN(){return{}}function E5(e,n){const t={},r=C(n,["disabled"]);r!=null&&j(t,["disabled"],r);const a=C(n,["startOfSpeechSensitivity"]);a!=null&&j(t,["startOfSpeechSensitivity"],a);const l=C(n,["endOfSpeechSensitivity"]);l!=null&&j(t,["endOfSpeechSensitivity"],l);const o=C(n,["prefixPaddingMs"]);o!=null&&j(t,["prefixPaddingMs"],o);const f=C(n,["silenceDurationMs"]);return f!=null&&j(t,["silenceDurationMs"],f),t}function T5(e,n){const t={},r=C(n,["disabled"]);r!=null&&j(t,["disabled"],r);const a=C(n,["startOfSpeechSensitivity"]);a!=null&&j(t,["startOfSpeechSensitivity"],a);const l=C(n,["endOfSpeechSensitivity"]);l!=null&&j(t,["endOfSpeechSensitivity"],l);const o=C(n,["prefixPaddingMs"]);o!=null&&j(t,["prefixPaddingMs"],o);const f=C(n,["silenceDurationMs"]);return f!=null&&j(t,["silenceDurationMs"],f),t}function A5(e,n){const t={},r=C(n,["automaticActivityDetection"]);r!=null&&j(t,["automaticActivityDetection"],E5(e,r));const a=C(n,["activityHandling"]);a!=null&&j(t,["activityHandling"],a);const l=C(n,["turnCoverage"]);return l!=null&&j(t,["turnCoverage"],l),t}function D5(e,n){const t={},r=C(n,["automaticActivityDetection"]);r!=null&&j(t,["automaticActivityDetection"],T5(e,r));const a=C(n,["activityHandling"]);a!=null&&j(t,["activityHandling"],a);const l=C(n,["turnCoverage"]);return l!=null&&j(t,["turnCoverage"],l),t}function P5(e,n){const t={},r=C(n,["targetTokens"]);return r!=null&&j(t,["targetTokens"],r),t}function I5(e,n){const t={},r=C(n,["targetTokens"]);return r!=null&&j(t,["targetTokens"],r),t}function M5(e,n){const t={},r=C(n,["triggerTokens"]);r!=null&&j(t,["triggerTokens"],r);const a=C(n,["slidingWindow"]);return a!=null&&j(t,["slidingWindow"],P5(e,a)),t}function R5(e,n){const t={},r=C(n,["triggerTokens"]);r!=null&&j(t,["triggerTokens"],r);const a=C(n,["slidingWindow"]);return a!=null&&j(t,["slidingWindow"],I5(e,a)),t}function L5(e,n,t){const r={},a=C(n,["generationConfig"]);t!==void 0&&a!=null&&j(t,["setup","generationConfig"],a);const l=C(n,["responseModalities"]);t!==void 0&&l!=null&&j(t,["setup","generationConfig","responseModalities"],l);const o=C(n,["temperature"]);t!==void 0&&o!=null&&j(t,["setup","generationConfig","temperature"],o);const f=C(n,["topP"]);t!==void 0&&f!=null&&j(t,["setup","generationConfig","topP"],f);const u=C(n,["topK"]);t!==void 0&&u!=null&&j(t,["setup","generationConfig","topK"],u);const d=C(n,["maxOutputTokens"]);t!==void 0&&d!=null&&j(t,["setup","generationConfig","maxOutputTokens"],d);const h=C(n,["mediaResolution"]);t!==void 0&&h!=null&&j(t,["setup","generationConfig","mediaResolution"],h);const g=C(n,["seed"]);t!==void 0&&g!=null&&j(t,["setup","generationConfig","seed"],g);const b=C(n,["speechConfig"]);t!==void 0&&b!=null&&j(t,["setup","generationConfig","speechConfig"],b);const v=C(n,["systemInstruction"]);t!==void 0&&v!=null&&j(t,["setup","systemInstruction"],f5(e,na(e,v)));const N=C(n,["tools"]);if(t!==void 0&&N!=null){let V=Ab(e,N);Array.isArray(V)&&(V=V.map(F=>C5(e,Tb(e,F)))),j(t,["setup","tools"],V)}const k=C(n,["sessionResumption"]);t!==void 0&&k!=null&&j(t,["setup","sessionResumption"],_5(e,k));const T=C(n,["inputAudioTranscription"]);t!==void 0&&T!=null&&j(t,["setup","inputAudioTranscription"],KN());const E=C(n,["outputAudioTranscription"]);t!==void 0&&E!=null&&j(t,["setup","outputAudioTranscription"],KN());const I=C(n,["realtimeInputConfig"]);t!==void 0&&I!=null&&j(t,["setup","realtimeInputConfig"],A5(e,I));const P=C(n,["contextWindowCompression"]);return t!==void 0&&P!=null&&j(t,["setup","contextWindowCompression"],M5(e,P)),r}function O5(e,n,t){const r={},a=C(n,["generationConfig"]);t!==void 0&&a!=null&&j(t,["setup","generationConfig"],a);const l=C(n,["responseModalities"]);t!==void 0&&l!=null&&j(t,["setup","generationConfig","responseModalities"],l);const o=C(n,["temperature"]);t!==void 0&&o!=null&&j(t,["setup","generationConfig","temperature"],o);const f=C(n,["topP"]);t!==void 0&&f!=null&&j(t,["setup","generationConfig","topP"],f);const u=C(n,["topK"]);t!==void 0&&u!=null&&j(t,["setup","generationConfig","topK"],u);const d=C(n,["maxOutputTokens"]);t!==void 0&&d!=null&&j(t,["setup","generationConfig","maxOutputTokens"],d);const h=C(n,["mediaResolution"]);t!==void 0&&h!=null&&j(t,["setup","generationConfig","mediaResolution"],h);const g=C(n,["seed"]);t!==void 0&&g!=null&&j(t,["setup","generationConfig","seed"],g);const b=C(n,["speechConfig"]);t!==void 0&&b!=null&&j(t,["setup","generationConfig","speechConfig"],b);const v=C(n,["systemInstruction"]);t!==void 0&&v!=null&&j(t,["setup","systemInstruction"],h5(e,na(e,v)));const N=C(n,["tools"]);if(t!==void 0&&N!=null){let V=Ab(e,N);Array.isArray(V)&&(V=V.map(F=>j5(e,Tb(e,F)))),j(t,["setup","tools"],V)}const k=C(n,["sessionResumption"]);t!==void 0&&k!=null&&j(t,["setup","sessionResumption"],k5(e,k));const T=C(n,["inputAudioTranscription"]);t!==void 0&&T!=null&&j(t,["setup","inputAudioTranscription"],XN());const E=C(n,["outputAudioTranscription"]);t!==void 0&&E!=null&&j(t,["setup","outputAudioTranscription"],XN());const I=C(n,["realtimeInputConfig"]);t!==void 0&&I!=null&&j(t,["setup","realtimeInputConfig"],D5(e,I));const P=C(n,["contextWindowCompression"]);return t!==void 0&&P!=null&&j(t,["setup","contextWindowCompression"],R5(e,P)),r}function F5(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["setup","model"],oi(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],L5(e,a,t)),t}function $5(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["setup","model"],oi(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],O5(e,a,t)),t}function z5(){return{}}function B5(){return{}}function U5(){return{}}function q5(){return{}}function V5(e,n){const t={},r=C(n,["media"]);r!=null&&j(t,["mediaChunks"],M2(e,r));const a=C(n,["audio"]);a!=null&&j(t,["audio"],qF(e,a));const l=C(n,["audioStreamEnd"]);l!=null&&j(t,["audioStreamEnd"],l);const o=C(n,["video"]);o!=null&&j(t,["video"],UF(e,o));const f=C(n,["text"]);return f!=null&&j(t,["text"],f),C(n,["activityStart"])!=null&&j(t,["activityStart"],z5()),C(n,["activityEnd"])!=null&&j(t,["activityEnd"],U5()),t}function H5(e,n){const t={},r=C(n,["media"]);if(r!=null&&j(t,["mediaChunks"],M2(e,r)),C(n,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const a=C(n,["audioStreamEnd"]);if(a!=null&&j(t,["audioStreamEnd"],a),C(n,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(C(n,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return C(n,["activityStart"])!=null&&j(t,["activityStart"],B5()),C(n,["activityEnd"])!=null&&j(t,["activityEnd"],q5()),t}function G5(){return{}}function Y5(){return{}}function W5(e,n){const t={},r=C(n,["data"]);r!=null&&j(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function Q5(e,n){const t={},r=C(n,["displayName"]);r!=null&&j(t,["displayName"],r);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const l=C(n,["mimeType"]);return l!=null&&j(t,["mimeType"],l),t}function J5(e,n){const t={},r=C(n,["thought"]);r!=null&&j(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],W5(e,a));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const o=C(n,["executableCode"]);o!=null&&j(t,["executableCode"],o);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const d=C(n,["functionResponse"]);d!=null&&j(t,["functionResponse"],d);const h=C(n,["text"]);return h!=null&&j(t,["text"],h),t}function K5(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&j(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const l=C(n,["inlineData"]);l!=null&&j(t,["inlineData"],Q5(e,l));const o=C(n,["codeExecutionResult"]);o!=null&&j(t,["codeExecutionResult"],o);const f=C(n,["executableCode"]);f!=null&&j(t,["executableCode"],f);const u=C(n,["fileData"]);u!=null&&j(t,["fileData"],u);const d=C(n,["functionCall"]);d!=null&&j(t,["functionCall"],d);const h=C(n,["functionResponse"]);h!=null&&j(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function X5(e,n){const t={},r=C(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>J5(e,o))),j(t,["parts"],l)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function Z5(e,n){const t={},r=C(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>K5(e,o))),j(t,["parts"],l)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function ZN(e,n){const t={},r=C(n,["text"]);r!=null&&j(t,["text"],r);const a=C(n,["finished"]);return a!=null&&j(t,["finished"],a),t}function eC(e,n){const t={},r=C(n,["text"]);r!=null&&j(t,["text"],r);const a=C(n,["finished"]);return a!=null&&j(t,["finished"],a),t}function e$(e,n){const t={},r=C(n,["modelTurn"]);r!=null&&j(t,["modelTurn"],X5(e,r));const a=C(n,["turnComplete"]);a!=null&&j(t,["turnComplete"],a);const l=C(n,["interrupted"]);l!=null&&j(t,["interrupted"],l);const o=C(n,["groundingMetadata"]);o!=null&&j(t,["groundingMetadata"],o);const f=C(n,["generationComplete"]);f!=null&&j(t,["generationComplete"],f);const u=C(n,["inputTranscription"]);u!=null&&j(t,["inputTranscription"],ZN(e,u));const d=C(n,["outputTranscription"]);return d!=null&&j(t,["outputTranscription"],ZN(e,d)),t}function t$(e,n){const t={},r=C(n,["modelTurn"]);r!=null&&j(t,["modelTurn"],Z5(e,r));const a=C(n,["turnComplete"]);a!=null&&j(t,["turnComplete"],a);const l=C(n,["interrupted"]);l!=null&&j(t,["interrupted"],l);const o=C(n,["groundingMetadata"]);o!=null&&j(t,["groundingMetadata"],o);const f=C(n,["generationComplete"]);f!=null&&j(t,["generationComplete"],f);const u=C(n,["inputTranscription"]);u!=null&&j(t,["inputTranscription"],eC(e,u));const d=C(n,["outputTranscription"]);return d!=null&&j(t,["outputTranscription"],eC(e,d)),t}function n$(e,n){const t={},r=C(n,["id"]);r!=null&&j(t,["id"],r);const a=C(n,["args"]);a!=null&&j(t,["args"],a);const l=C(n,["name"]);return l!=null&&j(t,["name"],l),t}function i$(e,n){const t={},r=C(n,["args"]);r!=null&&j(t,["args"],r);const a=C(n,["name"]);return a!=null&&j(t,["name"],a),t}function r$(e,n){const t={},r=C(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>n$(e,l))),j(t,["functionCalls"],a)}return t}function a$(e,n){const t={},r=C(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>i$(e,l))),j(t,["functionCalls"],a)}return t}function s$(e,n){const t={},r=C(n,["ids"]);return r!=null&&j(t,["ids"],r),t}function l$(e,n){const t={},r=C(n,["ids"]);return r!=null&&j(t,["ids"],r),t}function yx(e,n){const t={},r=C(n,["modality"]);r!=null&&j(t,["modality"],r);const a=C(n,["tokenCount"]);return a!=null&&j(t,["tokenCount"],a),t}function xx(e,n){const t={},r=C(n,["modality"]);r!=null&&j(t,["modality"],r);const a=C(n,["tokenCount"]);return a!=null&&j(t,["tokenCount"],a),t}function o$(e,n){const t={},r=C(n,["promptTokenCount"]);r!=null&&j(t,["promptTokenCount"],r);const a=C(n,["cachedContentTokenCount"]);a!=null&&j(t,["cachedContentTokenCount"],a);const l=C(n,["responseTokenCount"]);l!=null&&j(t,["responseTokenCount"],l);const o=C(n,["toolUsePromptTokenCount"]);o!=null&&j(t,["toolUsePromptTokenCount"],o);const f=C(n,["thoughtsTokenCount"]);f!=null&&j(t,["thoughtsTokenCount"],f);const u=C(n,["totalTokenCount"]);u!=null&&j(t,["totalTokenCount"],u);const d=C(n,["promptTokensDetails"]);if(d!=null){let v=d;Array.isArray(v)&&(v=v.map(N=>yx(e,N))),j(t,["promptTokensDetails"],v)}const h=C(n,["cacheTokensDetails"]);if(h!=null){let v=h;Array.isArray(v)&&(v=v.map(N=>yx(e,N))),j(t,["cacheTokensDetails"],v)}const g=C(n,["responseTokensDetails"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(N=>yx(e,N))),j(t,["responseTokensDetails"],v)}const b=C(n,["toolUsePromptTokensDetails"]);if(b!=null){let v=b;Array.isArray(v)&&(v=v.map(N=>yx(e,N))),j(t,["toolUsePromptTokensDetails"],v)}return t}function c$(e,n){const t={},r=C(n,["promptTokenCount"]);r!=null&&j(t,["promptTokenCount"],r);const a=C(n,["cachedContentTokenCount"]);a!=null&&j(t,["cachedContentTokenCount"],a);const l=C(n,["candidatesTokenCount"]);l!=null&&j(t,["responseTokenCount"],l);const o=C(n,["toolUsePromptTokenCount"]);o!=null&&j(t,["toolUsePromptTokenCount"],o);const f=C(n,["thoughtsTokenCount"]);f!=null&&j(t,["thoughtsTokenCount"],f);const u=C(n,["totalTokenCount"]);u!=null&&j(t,["totalTokenCount"],u);const d=C(n,["promptTokensDetails"]);if(d!=null){let N=d;Array.isArray(N)&&(N=N.map(k=>xx(e,k))),j(t,["promptTokensDetails"],N)}const h=C(n,["cacheTokensDetails"]);if(h!=null){let N=h;Array.isArray(N)&&(N=N.map(k=>xx(e,k))),j(t,["cacheTokensDetails"],N)}const g=C(n,["candidatesTokensDetails"]);if(g!=null){let N=g;Array.isArray(N)&&(N=N.map(k=>xx(e,k))),j(t,["responseTokensDetails"],N)}const b=C(n,["toolUsePromptTokensDetails"]);if(b!=null){let N=b;Array.isArray(N)&&(N=N.map(k=>xx(e,k))),j(t,["toolUsePromptTokensDetails"],N)}const v=C(n,["trafficType"]);return v!=null&&j(t,["trafficType"],v),t}function u$(e,n){const t={},r=C(n,["timeLeft"]);return r!=null&&j(t,["timeLeft"],r),t}function d$(e,n){const t={},r=C(n,["timeLeft"]);return r!=null&&j(t,["timeLeft"],r),t}function f$(e,n){const t={},r=C(n,["newHandle"]);r!=null&&j(t,["newHandle"],r);const a=C(n,["resumable"]);a!=null&&j(t,["resumable"],a);const l=C(n,["lastConsumedClientMessageIndex"]);return l!=null&&j(t,["lastConsumedClientMessageIndex"],l),t}function h$(e,n){const t={},r=C(n,["newHandle"]);r!=null&&j(t,["newHandle"],r);const a=C(n,["resumable"]);a!=null&&j(t,["resumable"],a);const l=C(n,["lastConsumedClientMessageIndex"]);return l!=null&&j(t,["lastConsumedClientMessageIndex"],l),t}function p$(e,n){const t={};C(n,["setupComplete"])!=null&&j(t,["setupComplete"],G5());const a=C(n,["serverContent"]);a!=null&&j(t,["serverContent"],e$(e,a));const l=C(n,["toolCall"]);l!=null&&j(t,["toolCall"],r$(e,l));const o=C(n,["toolCallCancellation"]);o!=null&&j(t,["toolCallCancellation"],s$(e,o));const f=C(n,["usageMetadata"]);f!=null&&j(t,["usageMetadata"],o$(e,f));const u=C(n,["goAway"]);u!=null&&j(t,["goAway"],u$(e,u));const d=C(n,["sessionResumptionUpdate"]);return d!=null&&j(t,["sessionResumptionUpdate"],f$(e,d)),t}function m$(e,n){const t={};C(n,["setupComplete"])!=null&&j(t,["setupComplete"],Y5());const a=C(n,["serverContent"]);a!=null&&j(t,["serverContent"],t$(e,a));const l=C(n,["toolCall"]);l!=null&&j(t,["toolCall"],a$(e,l));const o=C(n,["toolCallCancellation"]);o!=null&&j(t,["toolCallCancellation"],l$(e,o));const f=C(n,["usageMetadata"]);f!=null&&j(t,["usageMetadata"],c$(e,f));const u=C(n,["goAway"]);u!=null&&j(t,["goAway"],d$(e,u));const d=C(n,["sessionResumptionUpdate"]);return d!=null&&j(t,["sessionResumptionUpdate"],h$(e,d)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function g$(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&j(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function y$(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&j(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],g$(e,a));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const o=C(n,["executableCode"]);o!=null&&j(t,["executableCode"],o);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const d=C(n,["functionResponse"]);d!=null&&j(t,["functionResponse"],d);const h=C(n,["text"]);return h!=null&&j(t,["text"],h),t}function Pb(e,n){const t={},r=C(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>y$(e,o))),j(t,["parts"],l)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function x$(e,n){const t={};if(C(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=C(n,["category"]);r!=null&&j(t,["category"],r);const a=C(n,["threshold"]);return a!=null&&j(t,["threshold"],a),t}function b$(){return{}}function v$(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function w$(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],v$(e,r)),t}function S$(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&j(t,["googleSearch"],b$());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&j(t,["googleSearchRetrieval"],w$(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=C(n,["codeExecution"]);l!=null&&j(t,["codeExecution"],l);const o=C(n,["functionDeclarations"]);return o!=null&&j(t,["functionDeclarations"],o),t}function N$(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function C$(e,n){const t={},r=C(n,["functionCallingConfig"]);if(r!=null&&j(t,["functionCallingConfig"],N$(e,r)),C(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function j$(e,n){const t={},r=C(n,["voiceName"]);return r!=null&&j(t,["voiceName"],r),t}function _$(e,n){const t={},r=C(n,["prebuiltVoiceConfig"]);return r!=null&&j(t,["prebuiltVoiceConfig"],j$(e,r)),t}function k$(e,n){const t={},r=C(n,["voiceConfig"]);r!=null&&j(t,["voiceConfig"],_$(e,r));const a=C(n,["languageCode"]);return a!=null&&j(t,["languageCode"],a),t}function E$(e,n){const t={},r=C(n,["includeThoughts"]);r!=null&&j(t,["includeThoughts"],r);const a=C(n,["thinkingBudget"]);return a!=null&&j(t,["thinkingBudget"],a),t}function T$(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&j(t,["systemInstruction"],Pb(e,na(e,a)));const l=C(n,["temperature"]);l!=null&&j(r,["temperature"],l);const o=C(n,["topP"]);o!=null&&j(r,["topP"],o);const f=C(n,["topK"]);f!=null&&j(r,["topK"],f);const u=C(n,["candidateCount"]);u!=null&&j(r,["candidateCount"],u);const d=C(n,["maxOutputTokens"]);d!=null&&j(r,["maxOutputTokens"],d);const h=C(n,["stopSequences"]);h!=null&&j(r,["stopSequences"],h);const g=C(n,["responseLogprobs"]);g!=null&&j(r,["responseLogprobs"],g);const b=C(n,["logprobs"]);b!=null&&j(r,["logprobs"],b);const v=C(n,["presencePenalty"]);v!=null&&j(r,["presencePenalty"],v);const N=C(n,["frequencyPenalty"]);N!=null&&j(r,["frequencyPenalty"],N);const k=C(n,["seed"]);k!=null&&j(r,["seed"],k);const T=C(n,["responseMimeType"]);T!=null&&j(r,["responseMimeType"],T);const E=C(n,["responseSchema"]);if(E!=null&&j(r,["responseSchema"],O2(e,E)),C(n,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(C(n,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const I=C(n,["safetySettings"]);if(t!==void 0&&I!=null){let O=I;Array.isArray(O)&&(O=O.map(R=>x$(e,R))),j(t,["safetySettings"],O)}const P=C(n,["tools"]);if(t!==void 0&&P!=null){let O=Ab(e,P);Array.isArray(O)&&(O=O.map(R=>S$(e,Tb(e,R)))),j(t,["tools"],O)}const V=C(n,["toolConfig"]);if(t!==void 0&&V!=null&&j(t,["toolConfig"],C$(e,V)),C(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const F=C(n,["cachedContent"]);t!==void 0&&F!=null&&j(t,["cachedContent"],Yc(e,F));const $=C(n,["responseModalities"]);$!=null&&j(r,["responseModalities"],$);const B=C(n,["mediaResolution"]);B!=null&&j(r,["mediaResolution"],B);const z=C(n,["speechConfig"]);if(z!=null&&j(r,["speechConfig"],k$(e,F2(e,z))),C(n,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const q=C(n,["thinkingConfig"]);return q!=null&&j(r,["thinkingConfig"],E$(e,q)),r}function tC(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],oi(e,r));const a=C(n,["contents"]);if(a!=null){let o=Gc(e,a);Array.isArray(o)&&(o=o.map(f=>Pb(e,f))),j(t,["contents"],o)}const l=C(n,["config"]);return l!=null&&j(t,["generationConfig"],T$(e,l,t)),t}function A$(e,n,t){const r={},a=C(n,["taskType"]);t!==void 0&&a!=null&&j(t,["requests[]","taskType"],a);const l=C(n,["title"]);t!==void 0&&l!=null&&j(t,["requests[]","title"],l);const o=C(n,["outputDimensionality"]);if(t!==void 0&&o!=null&&j(t,["requests[]","outputDimensionality"],o),C(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(C(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function D$(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],oi(e,r));const a=C(n,["contents"]);a!=null&&j(t,["requests[]","content"],L2(e,a));const l=C(n,["config"]);l!=null&&j(t,["config"],A$(e,l,t));const o=C(n,["model"]);return o!==void 0&&j(t,["requests[]","model"],oi(e,o)),t}function P$(e,n,t){const r={};if(C(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(C(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const a=C(n,["numberOfImages"]);t!==void 0&&a!=null&&j(t,["parameters","sampleCount"],a);const l=C(n,["aspectRatio"]);t!==void 0&&l!=null&&j(t,["parameters","aspectRatio"],l);const o=C(n,["guidanceScale"]);if(t!==void 0&&o!=null&&j(t,["parameters","guidanceScale"],o),C(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const f=C(n,["safetyFilterLevel"]);t!==void 0&&f!=null&&j(t,["parameters","safetySetting"],f);const u=C(n,["personGeneration"]);t!==void 0&&u!=null&&j(t,["parameters","personGeneration"],u);const d=C(n,["includeSafetyAttributes"]);t!==void 0&&d!=null&&j(t,["parameters","includeSafetyAttributes"],d);const h=C(n,["includeRaiReason"]);t!==void 0&&h!=null&&j(t,["parameters","includeRaiReason"],h);const g=C(n,["language"]);t!==void 0&&g!=null&&j(t,["parameters","language"],g);const b=C(n,["outputMimeType"]);t!==void 0&&b!=null&&j(t,["parameters","outputOptions","mimeType"],b);const v=C(n,["outputCompressionQuality"]);if(t!==void 0&&v!=null&&j(t,["parameters","outputOptions","compressionQuality"],v),C(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(C(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function I$(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],oi(e,r));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const l=C(n,["config"]);return l!=null&&j(t,["config"],P$(e,l,t)),t}function M$(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","name"],oi(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function R$(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const l=C(n,["pageToken"]);t!==void 0&&l!=null&&j(t,["_query","pageToken"],l);const o=C(n,["filter"]);t!==void 0&&o!=null&&j(t,["_query","filter"],o);const f=C(n,["queryBase"]);return t!==void 0&&f!=null&&j(t,["_url","models_url"],B2(e,f)),r}function L$(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],R$(e,r,t)),t}function O$(e,n,t){const r={},a=C(n,["displayName"]);t!==void 0&&a!=null&&j(t,["displayName"],a);const l=C(n,["description"]);t!==void 0&&l!=null&&j(t,["description"],l);const o=C(n,["defaultCheckpointId"]);return t!==void 0&&o!=null&&j(t,["defaultCheckpointId"],o),r}function F$(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","name"],oi(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],O$(e,a,t)),t}function $$(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","name"],oi(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function z$(e,n){const t={};if(C(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(C(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(C(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function B$(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],oi(e,r));const a=C(n,["contents"]);if(a!=null){let o=Gc(e,a);Array.isArray(o)&&(o=o.map(f=>Pb(e,f))),j(t,["contents"],o)}const l=C(n,["config"]);return l!=null&&j(t,["config"],z$(e,l)),t}function U$(e,n){const t={};if(C(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=C(n,["imageBytes"]);r!=null&&j(t,["bytesBase64Encoded"],Wc(e,r));const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function q$(e,n,t){const r={},a=C(n,["numberOfVideos"]);if(t!==void 0&&a!=null&&j(t,["parameters","sampleCount"],a),C(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(C(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const l=C(n,["durationSeconds"]);if(t!==void 0&&l!=null&&j(t,["parameters","durationSeconds"],l),C(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=C(n,["aspectRatio"]);if(t!==void 0&&o!=null&&j(t,["parameters","aspectRatio"],o),C(n,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const f=C(n,["personGeneration"]);if(t!==void 0&&f!=null&&j(t,["parameters","personGeneration"],f),C(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const u=C(n,["negativePrompt"]);if(t!==void 0&&u!=null&&j(t,["parameters","negativePrompt"],u),C(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function V$(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],oi(e,r));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const l=C(n,["image"]);l!=null&&j(t,["instances[0]","image"],U$(e,l));const o=C(n,["config"]);return o!=null&&j(t,["config"],q$(e,o,t)),t}function H$(e,n){const t={},r=C(n,["displayName"]);r!=null&&j(t,["displayName"],r);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const l=C(n,["mimeType"]);return l!=null&&j(t,["mimeType"],l),t}function G$(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&j(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const l=C(n,["inlineData"]);l!=null&&j(t,["inlineData"],H$(e,l));const o=C(n,["codeExecutionResult"]);o!=null&&j(t,["codeExecutionResult"],o);const f=C(n,["executableCode"]);f!=null&&j(t,["executableCode"],f);const u=C(n,["fileData"]);u!=null&&j(t,["fileData"],u);const d=C(n,["functionCall"]);d!=null&&j(t,["functionCall"],d);const h=C(n,["functionResponse"]);h!=null&&j(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function Fh(e,n){const t={},r=C(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>G$(e,o))),j(t,["parts"],l)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function Y$(e,n){const t={},r=C(n,["featureSelectionPreference"]);return r!=null&&j(t,["featureSelectionPreference"],r),t}function W$(e,n){const t={},r=C(n,["method"]);r!=null&&j(t,["method"],r);const a=C(n,["category"]);a!=null&&j(t,["category"],a);const l=C(n,["threshold"]);return l!=null&&j(t,["threshold"],l),t}function Q$(){return{}}function J$(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function K$(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],J$(e,r)),t}function X$(){return{}}function Z$(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&j(t,["apiKeyString"],r),t}function ez(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&j(t,["apiKeyConfig"],Z$(e,r));const a=C(n,["authType"]);a!=null&&j(t,["authType"],a);const l=C(n,["googleServiceAccountConfig"]);l!=null&&j(t,["googleServiceAccountConfig"],l);const o=C(n,["httpBasicAuthConfig"]);o!=null&&j(t,["httpBasicAuthConfig"],o);const f=C(n,["oauthConfig"]);f!=null&&j(t,["oauthConfig"],f);const u=C(n,["oidcConfig"]);return u!=null&&j(t,["oidcConfig"],u),t}function tz(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&j(t,["authConfig"],ez(e,r)),t}function V2(e,n){const t={},r=C(n,["retrieval"]);r!=null&&j(t,["retrieval"],r),C(n,["googleSearch"])!=null&&j(t,["googleSearch"],Q$());const l=C(n,["googleSearchRetrieval"]);l!=null&&j(t,["googleSearchRetrieval"],K$(e,l)),C(n,["enterpriseWebSearch"])!=null&&j(t,["enterpriseWebSearch"],X$());const f=C(n,["googleMaps"]);f!=null&&j(t,["googleMaps"],tz(e,f));const u=C(n,["codeExecution"]);u!=null&&j(t,["codeExecution"],u);const d=C(n,["functionDeclarations"]);return d!=null&&j(t,["functionDeclarations"],d),t}function nz(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function iz(e,n){const t={},r=C(n,["latitude"]);r!=null&&j(t,["latitude"],r);const a=C(n,["longitude"]);return a!=null&&j(t,["longitude"],a),t}function rz(e,n){const t={},r=C(n,["latLng"]);return r!=null&&j(t,["latLng"],iz(e,r)),t}function az(e,n){const t={},r=C(n,["functionCallingConfig"]);r!=null&&j(t,["functionCallingConfig"],nz(e,r));const a=C(n,["retrievalConfig"]);return a!=null&&j(t,["retrievalConfig"],rz(e,a)),t}function sz(e,n){const t={},r=C(n,["voiceName"]);return r!=null&&j(t,["voiceName"],r),t}function lz(e,n){const t={},r=C(n,["prebuiltVoiceConfig"]);return r!=null&&j(t,["prebuiltVoiceConfig"],sz(e,r)),t}function oz(e,n){const t={},r=C(n,["voiceConfig"]);r!=null&&j(t,["voiceConfig"],lz(e,r));const a=C(n,["languageCode"]);return a!=null&&j(t,["languageCode"],a),t}function cz(e,n){const t={},r=C(n,["includeThoughts"]);r!=null&&j(t,["includeThoughts"],r);const a=C(n,["thinkingBudget"]);return a!=null&&j(t,["thinkingBudget"],a),t}function uz(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&j(t,["systemInstruction"],Fh(e,na(e,a)));const l=C(n,["temperature"]);l!=null&&j(r,["temperature"],l);const o=C(n,["topP"]);o!=null&&j(r,["topP"],o);const f=C(n,["topK"]);f!=null&&j(r,["topK"],f);const u=C(n,["candidateCount"]);u!=null&&j(r,["candidateCount"],u);const d=C(n,["maxOutputTokens"]);d!=null&&j(r,["maxOutputTokens"],d);const h=C(n,["stopSequences"]);h!=null&&j(r,["stopSequences"],h);const g=C(n,["responseLogprobs"]);g!=null&&j(r,["responseLogprobs"],g);const b=C(n,["logprobs"]);b!=null&&j(r,["logprobs"],b);const v=C(n,["presencePenalty"]);v!=null&&j(r,["presencePenalty"],v);const N=C(n,["frequencyPenalty"]);N!=null&&j(r,["frequencyPenalty"],N);const k=C(n,["seed"]);k!=null&&j(r,["seed"],k);const T=C(n,["responseMimeType"]);T!=null&&j(r,["responseMimeType"],T);const E=C(n,["responseSchema"]);E!=null&&j(r,["responseSchema"],O2(e,E));const I=C(n,["routingConfig"]);I!=null&&j(r,["routingConfig"],I);const P=C(n,["modelSelectionConfig"]);P!=null&&j(r,["modelConfig"],Y$(e,P));const V=C(n,["safetySettings"]);if(t!==void 0&&V!=null){let te=V;Array.isArray(te)&&(te=te.map(le=>W$(e,le))),j(t,["safetySettings"],te)}const F=C(n,["tools"]);if(t!==void 0&&F!=null){let te=Ab(e,F);Array.isArray(te)&&(te=te.map(le=>V2(e,Tb(e,le)))),j(t,["tools"],te)}const $=C(n,["toolConfig"]);t!==void 0&&$!=null&&j(t,["toolConfig"],az(e,$));const B=C(n,["labels"]);t!==void 0&&B!=null&&j(t,["labels"],B);const z=C(n,["cachedContent"]);t!==void 0&&z!=null&&j(t,["cachedContent"],Yc(e,z));const q=C(n,["responseModalities"]);q!=null&&j(r,["responseModalities"],q);const O=C(n,["mediaResolution"]);O!=null&&j(r,["mediaResolution"],O);const R=C(n,["speechConfig"]);R!=null&&j(r,["speechConfig"],oz(e,F2(e,R)));const G=C(n,["audioTimestamp"]);G!=null&&j(r,["audioTimestamp"],G);const ee=C(n,["thinkingConfig"]);return ee!=null&&j(r,["thinkingConfig"],cz(e,ee)),r}function nC(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],oi(e,r));const a=C(n,["contents"]);if(a!=null){let o=Gc(e,a);Array.isArray(o)&&(o=o.map(f=>Fh(e,f))),j(t,["contents"],o)}const l=C(n,["config"]);return l!=null&&j(t,["generationConfig"],uz(e,l,t)),t}function dz(e,n,t){const r={},a=C(n,["taskType"]);t!==void 0&&a!=null&&j(t,["instances[]","task_type"],a);const l=C(n,["title"]);t!==void 0&&l!=null&&j(t,["instances[]","title"],l);const o=C(n,["outputDimensionality"]);t!==void 0&&o!=null&&j(t,["parameters","outputDimensionality"],o);const f=C(n,["mimeType"]);t!==void 0&&f!=null&&j(t,["instances[]","mimeType"],f);const u=C(n,["autoTruncate"]);return t!==void 0&&u!=null&&j(t,["parameters","autoTruncate"],u),r}function fz(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],oi(e,r));const a=C(n,["contents"]);a!=null&&j(t,["instances[]","content"],L2(e,a));const l=C(n,["config"]);return l!=null&&j(t,["config"],dz(e,l,t)),t}function hz(e,n,t){const r={},a=C(n,["outputGcsUri"]);t!==void 0&&a!=null&&j(t,["parameters","storageUri"],a);const l=C(n,["negativePrompt"]);t!==void 0&&l!=null&&j(t,["parameters","negativePrompt"],l);const o=C(n,["numberOfImages"]);t!==void 0&&o!=null&&j(t,["parameters","sampleCount"],o);const f=C(n,["aspectRatio"]);t!==void 0&&f!=null&&j(t,["parameters","aspectRatio"],f);const u=C(n,["guidanceScale"]);t!==void 0&&u!=null&&j(t,["parameters","guidanceScale"],u);const d=C(n,["seed"]);t!==void 0&&d!=null&&j(t,["parameters","seed"],d);const h=C(n,["safetyFilterLevel"]);t!==void 0&&h!=null&&j(t,["parameters","safetySetting"],h);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&j(t,["parameters","personGeneration"],g);const b=C(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&j(t,["parameters","includeSafetyAttributes"],b);const v=C(n,["includeRaiReason"]);t!==void 0&&v!=null&&j(t,["parameters","includeRaiReason"],v);const N=C(n,["language"]);t!==void 0&&N!=null&&j(t,["parameters","language"],N);const k=C(n,["outputMimeType"]);t!==void 0&&k!=null&&j(t,["parameters","outputOptions","mimeType"],k);const T=C(n,["outputCompressionQuality"]);t!==void 0&&T!=null&&j(t,["parameters","outputOptions","compressionQuality"],T);const E=C(n,["addWatermark"]);t!==void 0&&E!=null&&j(t,["parameters","addWatermark"],E);const I=C(n,["enhancePrompt"]);return t!==void 0&&I!=null&&j(t,["parameters","enhancePrompt"],I),r}function pz(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],oi(e,r));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const l=C(n,["config"]);return l!=null&&j(t,["config"],hz(e,l,t)),t}function uw(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&j(t,["gcsUri"],r);const a=C(n,["imageBytes"]);a!=null&&j(t,["bytesBase64Encoded"],Wc(e,a));const l=C(n,["mimeType"]);return l!=null&&j(t,["mimeType"],l),t}function mz(e,n){const t={},r=C(n,["maskMode"]);r!=null&&j(t,["maskMode"],r);const a=C(n,["segmentationClasses"]);a!=null&&j(t,["maskClasses"],a);const l=C(n,["maskDilation"]);return l!=null&&j(t,["dilation"],l),t}function gz(e,n){const t={},r=C(n,["controlType"]);r!=null&&j(t,["controlType"],r);const a=C(n,["enableControlImageComputation"]);return a!=null&&j(t,["computeControl"],a),t}function yz(e,n){const t={},r=C(n,["styleDescription"]);return r!=null&&j(t,["styleDescription"],r),t}function xz(e,n){const t={},r=C(n,["subjectType"]);r!=null&&j(t,["subjectType"],r);const a=C(n,["subjectDescription"]);return a!=null&&j(t,["subjectDescription"],a),t}function bz(e,n){const t={},r=C(n,["referenceImage"]);r!=null&&j(t,["referenceImage"],uw(e,r));const a=C(n,["referenceId"]);a!=null&&j(t,["referenceId"],a);const l=C(n,["referenceType"]);l!=null&&j(t,["referenceType"],l);const o=C(n,["maskImageConfig"]);o!=null&&j(t,["maskImageConfig"],mz(e,o));const f=C(n,["controlImageConfig"]);f!=null&&j(t,["controlImageConfig"],gz(e,f));const u=C(n,["styleImageConfig"]);u!=null&&j(t,["styleImageConfig"],yz(e,u));const d=C(n,["subjectImageConfig"]);return d!=null&&j(t,["subjectImageConfig"],xz(e,d)),t}function vz(e,n,t){const r={},a=C(n,["outputGcsUri"]);t!==void 0&&a!=null&&j(t,["parameters","storageUri"],a);const l=C(n,["negativePrompt"]);t!==void 0&&l!=null&&j(t,["parameters","negativePrompt"],l);const o=C(n,["numberOfImages"]);t!==void 0&&o!=null&&j(t,["parameters","sampleCount"],o);const f=C(n,["aspectRatio"]);t!==void 0&&f!=null&&j(t,["parameters","aspectRatio"],f);const u=C(n,["guidanceScale"]);t!==void 0&&u!=null&&j(t,["parameters","guidanceScale"],u);const d=C(n,["seed"]);t!==void 0&&d!=null&&j(t,["parameters","seed"],d);const h=C(n,["safetyFilterLevel"]);t!==void 0&&h!=null&&j(t,["parameters","safetySetting"],h);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&j(t,["parameters","personGeneration"],g);const b=C(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&j(t,["parameters","includeSafetyAttributes"],b);const v=C(n,["includeRaiReason"]);t!==void 0&&v!=null&&j(t,["parameters","includeRaiReason"],v);const N=C(n,["language"]);t!==void 0&&N!=null&&j(t,["parameters","language"],N);const k=C(n,["outputMimeType"]);t!==void 0&&k!=null&&j(t,["parameters","outputOptions","mimeType"],k);const T=C(n,["outputCompressionQuality"]);t!==void 0&&T!=null&&j(t,["parameters","outputOptions","compressionQuality"],T);const E=C(n,["editMode"]);t!==void 0&&E!=null&&j(t,["parameters","editMode"],E);const I=C(n,["baseSteps"]);return t!==void 0&&I!=null&&j(t,["parameters","editConfig","baseSteps"],I),r}function wz(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],oi(e,r));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const l=C(n,["referenceImages"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(u=>bz(e,u))),j(t,["instances[0]","referenceImages"],f)}const o=C(n,["config"]);return o!=null&&j(t,["config"],vz(e,o,t)),t}function Sz(e,n,t){const r={},a=C(n,["includeRaiReason"]);t!==void 0&&a!=null&&j(t,["parameters","includeRaiReason"],a);const l=C(n,["outputMimeType"]);t!==void 0&&l!=null&&j(t,["parameters","outputOptions","mimeType"],l);const o=C(n,["outputCompressionQuality"]);t!==void 0&&o!=null&&j(t,["parameters","outputOptions","compressionQuality"],o);const f=C(n,["numberOfImages"]);t!==void 0&&f!=null&&j(t,["parameters","sampleCount"],f);const u=C(n,["mode"]);return t!==void 0&&u!=null&&j(t,["parameters","mode"],u),r}function Nz(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],oi(e,r));const a=C(n,["image"]);a!=null&&j(t,["instances[0]","image"],uw(e,a));const l=C(n,["upscaleFactor"]);l!=null&&j(t,["parameters","upscaleConfig","upscaleFactor"],l);const o=C(n,["config"]);return o!=null&&j(t,["config"],Sz(e,o,t)),t}function Cz(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","name"],oi(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function jz(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const l=C(n,["pageToken"]);t!==void 0&&l!=null&&j(t,["_query","pageToken"],l);const o=C(n,["filter"]);t!==void 0&&o!=null&&j(t,["_query","filter"],o);const f=C(n,["queryBase"]);return t!==void 0&&f!=null&&j(t,["_url","models_url"],B2(e,f)),r}function _z(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],jz(e,r,t)),t}function kz(e,n,t){const r={},a=C(n,["displayName"]);t!==void 0&&a!=null&&j(t,["displayName"],a);const l=C(n,["description"]);t!==void 0&&l!=null&&j(t,["description"],l);const o=C(n,["defaultCheckpointId"]);return t!==void 0&&o!=null&&j(t,["defaultCheckpointId"],o),r}function Ez(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],oi(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],kz(e,a,t)),t}function Tz(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","name"],oi(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function Az(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&j(t,["systemInstruction"],Fh(e,na(e,a)));const l=C(n,["tools"]);if(t!==void 0&&l!=null){let f=l;Array.isArray(f)&&(f=f.map(u=>V2(e,u))),j(t,["tools"],f)}const o=C(n,["generationConfig"]);return t!==void 0&&o!=null&&j(t,["generationConfig"],o),r}function Dz(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],oi(e,r));const a=C(n,["contents"]);if(a!=null){let o=Gc(e,a);Array.isArray(o)&&(o=o.map(f=>Fh(e,f))),j(t,["contents"],o)}const l=C(n,["config"]);return l!=null&&j(t,["config"],Az(e,l,t)),t}function Pz(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],oi(e,r));const a=C(n,["contents"]);if(a!=null){let o=Gc(e,a);Array.isArray(o)&&(o=o.map(f=>Fh(e,f))),j(t,["contents"],o)}const l=C(n,["config"]);return l!=null&&j(t,["config"],l),t}function Iz(e,n,t){const r={},a=C(n,["numberOfVideos"]);t!==void 0&&a!=null&&j(t,["parameters","sampleCount"],a);const l=C(n,["outputGcsUri"]);t!==void 0&&l!=null&&j(t,["parameters","storageUri"],l);const o=C(n,["fps"]);t!==void 0&&o!=null&&j(t,["parameters","fps"],o);const f=C(n,["durationSeconds"]);t!==void 0&&f!=null&&j(t,["parameters","durationSeconds"],f);const u=C(n,["seed"]);t!==void 0&&u!=null&&j(t,["parameters","seed"],u);const d=C(n,["aspectRatio"]);t!==void 0&&d!=null&&j(t,["parameters","aspectRatio"],d);const h=C(n,["resolution"]);t!==void 0&&h!=null&&j(t,["parameters","resolution"],h);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&j(t,["parameters","personGeneration"],g);const b=C(n,["pubsubTopic"]);t!==void 0&&b!=null&&j(t,["parameters","pubsubTopic"],b);const v=C(n,["negativePrompt"]);t!==void 0&&v!=null&&j(t,["parameters","negativePrompt"],v);const N=C(n,["enhancePrompt"]);return t!==void 0&&N!=null&&j(t,["parameters","enhancePrompt"],N),r}function Mz(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],oi(e,r));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const l=C(n,["image"]);l!=null&&j(t,["instances[0]","image"],uw(e,l));const o=C(n,["config"]);return o!=null&&j(t,["config"],Iz(e,o,t)),t}function Rz(e,n){const t={},r=C(n,["data"]);r!=null&&j(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function Lz(e,n){const t={},r=C(n,["thought"]);r!=null&&j(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],Rz(e,a));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const o=C(n,["executableCode"]);o!=null&&j(t,["executableCode"],o);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const d=C(n,["functionResponse"]);d!=null&&j(t,["functionResponse"],d);const h=C(n,["text"]);return h!=null&&j(t,["text"],h),t}function Oz(e,n){const t={},r=C(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>Lz(e,o))),j(t,["parts"],l)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function Fz(e,n){const t={},r=C(n,["citationSources"]);return r!=null&&j(t,["citations"],r),t}function $z(e,n){const t={},r=C(n,["content"]);r!=null&&j(t,["content"],Oz(e,r));const a=C(n,["citationMetadata"]);a!=null&&j(t,["citationMetadata"],Fz(e,a));const l=C(n,["tokenCount"]);l!=null&&j(t,["tokenCount"],l);const o=C(n,["finishReason"]);o!=null&&j(t,["finishReason"],o);const f=C(n,["avgLogprobs"]);f!=null&&j(t,["avgLogprobs"],f);const u=C(n,["groundingMetadata"]);u!=null&&j(t,["groundingMetadata"],u);const d=C(n,["index"]);d!=null&&j(t,["index"],d);const h=C(n,["logprobsResult"]);h!=null&&j(t,["logprobsResult"],h);const g=C(n,["safetyRatings"]);return g!=null&&j(t,["safetyRatings"],g),t}function iC(e,n){const t={},r=C(n,["candidates"]);if(r!=null){let f=r;Array.isArray(f)&&(f=f.map(u=>$z(e,u))),j(t,["candidates"],f)}const a=C(n,["modelVersion"]);a!=null&&j(t,["modelVersion"],a);const l=C(n,["promptFeedback"]);l!=null&&j(t,["promptFeedback"],l);const o=C(n,["usageMetadata"]);return o!=null&&j(t,["usageMetadata"],o),t}function zz(e,n){const t={},r=C(n,["values"]);return r!=null&&j(t,["values"],r),t}function Bz(){return{}}function Uz(e,n){const t={},r=C(n,["embeddings"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>zz(e,o))),j(t,["embeddings"],l)}return C(n,["metadata"])!=null&&j(t,["metadata"],Bz()),t}function qz(e,n){const t={},r=C(n,["bytesBase64Encoded"]);r!=null&&j(t,["imageBytes"],Wc(e,r));const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function H2(e,n){const t={},r=C(n,["safetyAttributes","categories"]);r!=null&&j(t,["categories"],r);const a=C(n,["safetyAttributes","scores"]);a!=null&&j(t,["scores"],a);const l=C(n,["contentType"]);return l!=null&&j(t,["contentType"],l),t}function Vz(e,n){const t={},r=C(n,["_self"]);r!=null&&j(t,["image"],qz(e,r));const a=C(n,["raiFilteredReason"]);a!=null&&j(t,["raiFilteredReason"],a);const l=C(n,["_self"]);return l!=null&&j(t,["safetyAttributes"],H2(e,l)),t}function Hz(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>Vz(e,o))),j(t,["generatedImages"],l)}const a=C(n,["positivePromptSafetyAttributes"]);return a!=null&&j(t,["positivePromptSafetyAttributes"],H2(e,a)),t}function Gz(e,n){const t={},r=C(n,["baseModel"]);r!=null&&j(t,["baseModel"],r);const a=C(n,["createTime"]);a!=null&&j(t,["createTime"],a);const l=C(n,["updateTime"]);return l!=null&&j(t,["updateTime"],l),t}function i1(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const l=C(n,["description"]);l!=null&&j(t,["description"],l);const o=C(n,["version"]);o!=null&&j(t,["version"],o);const f=C(n,["_self"]);f!=null&&j(t,["tunedModelInfo"],Gz(e,f));const u=C(n,["inputTokenLimit"]);u!=null&&j(t,["inputTokenLimit"],u);const d=C(n,["outputTokenLimit"]);d!=null&&j(t,["outputTokenLimit"],d);const h=C(n,["supportedGenerationMethods"]);return h!=null&&j(t,["supportedActions"],h),t}function Yz(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["_self"]);if(a!=null){let l=U2(e,a);Array.isArray(l)&&(l=l.map(o=>i1(e,o))),j(t,["models"],l)}return t}function Wz(){return{}}function Qz(e,n){const t={},r=C(n,["totalTokens"]);r!=null&&j(t,["totalTokens"],r);const a=C(n,["cachedContentTokenCount"]);return a!=null&&j(t,["cachedContentTokenCount"],a),t}function Jz(e,n){const t={},r=C(n,["video","uri"]);r!=null&&j(t,["uri"],r);const a=C(n,["video","encodedVideo"]);a!=null&&j(t,["videoBytes"],Wc(e,a));const l=C(n,["encoding"]);return l!=null&&j(t,["mimeType"],l),t}function Kz(e,n){const t={},r=C(n,["_self"]);return r!=null&&j(t,["video"],Jz(e,r)),t}function Xz(e,n){const t={},r=C(n,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(f=>Kz(e,f))),j(t,["generatedVideos"],o)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const l=C(n,["raiMediaFilteredReasons"]);return l!=null&&j(t,["raiMediaFilteredReasons"],l),t}function Zz(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const l=C(n,["done"]);l!=null&&j(t,["done"],l);const o=C(n,["error"]);o!=null&&j(t,["error"],o);const f=C(n,["response","generateVideoResponse"]);return f!=null&&j(t,["response"],Xz(e,f)),t}function e8(e,n){const t={},r=C(n,["displayName"]);r!=null&&j(t,["displayName"],r);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const l=C(n,["mimeType"]);return l!=null&&j(t,["mimeType"],l),t}function t8(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&j(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const l=C(n,["inlineData"]);l!=null&&j(t,["inlineData"],e8(e,l));const o=C(n,["codeExecutionResult"]);o!=null&&j(t,["codeExecutionResult"],o);const f=C(n,["executableCode"]);f!=null&&j(t,["executableCode"],f);const u=C(n,["fileData"]);u!=null&&j(t,["fileData"],u);const d=C(n,["functionCall"]);d!=null&&j(t,["functionCall"],d);const h=C(n,["functionResponse"]);h!=null&&j(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function n8(e,n){const t={},r=C(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>t8(e,o))),j(t,["parts"],l)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function i8(e,n){const t={},r=C(n,["citations"]);return r!=null&&j(t,["citations"],r),t}function r8(e,n){const t={},r=C(n,["content"]);r!=null&&j(t,["content"],n8(e,r));const a=C(n,["citationMetadata"]);a!=null&&j(t,["citationMetadata"],i8(e,a));const l=C(n,["finishMessage"]);l!=null&&j(t,["finishMessage"],l);const o=C(n,["finishReason"]);o!=null&&j(t,["finishReason"],o);const f=C(n,["avgLogprobs"]);f!=null&&j(t,["avgLogprobs"],f);const u=C(n,["groundingMetadata"]);u!=null&&j(t,["groundingMetadata"],u);const d=C(n,["index"]);d!=null&&j(t,["index"],d);const h=C(n,["logprobsResult"]);h!=null&&j(t,["logprobsResult"],h);const g=C(n,["safetyRatings"]);return g!=null&&j(t,["safetyRatings"],g),t}function rC(e,n){const t={},r=C(n,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(h=>r8(e,h))),j(t,["candidates"],d)}const a=C(n,["createTime"]);a!=null&&j(t,["createTime"],a);const l=C(n,["responseId"]);l!=null&&j(t,["responseId"],l);const o=C(n,["modelVersion"]);o!=null&&j(t,["modelVersion"],o);const f=C(n,["promptFeedback"]);f!=null&&j(t,["promptFeedback"],f);const u=C(n,["usageMetadata"]);return u!=null&&j(t,["usageMetadata"],u),t}function a8(e,n){const t={},r=C(n,["truncated"]);r!=null&&j(t,["truncated"],r);const a=C(n,["token_count"]);return a!=null&&j(t,["tokenCount"],a),t}function s8(e,n){const t={},r=C(n,["values"]);r!=null&&j(t,["values"],r);const a=C(n,["statistics"]);return a!=null&&j(t,["statistics"],a8(e,a)),t}function l8(e,n){const t={},r=C(n,["billableCharacterCount"]);return r!=null&&j(t,["billableCharacterCount"],r),t}function o8(e,n){const t={},r=C(n,["predictions[]","embeddings"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>s8(e,o))),j(t,["embeddings"],l)}const a=C(n,["metadata"]);return a!=null&&j(t,["metadata"],l8(e,a)),t}function c8(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&j(t,["gcsUri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&j(t,["imageBytes"],Wc(e,a));const l=C(n,["mimeType"]);return l!=null&&j(t,["mimeType"],l),t}function G2(e,n){const t={},r=C(n,["safetyAttributes","categories"]);r!=null&&j(t,["categories"],r);const a=C(n,["safetyAttributes","scores"]);a!=null&&j(t,["scores"],a);const l=C(n,["contentType"]);return l!=null&&j(t,["contentType"],l),t}function dw(e,n){const t={},r=C(n,["_self"]);r!=null&&j(t,["image"],c8(e,r));const a=C(n,["raiFilteredReason"]);a!=null&&j(t,["raiFilteredReason"],a);const l=C(n,["_self"]);l!=null&&j(t,["safetyAttributes"],G2(e,l));const o=C(n,["prompt"]);return o!=null&&j(t,["enhancedPrompt"],o),t}function u8(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>dw(e,o))),j(t,["generatedImages"],l)}const a=C(n,["positivePromptSafetyAttributes"]);return a!=null&&j(t,["positivePromptSafetyAttributes"],G2(e,a)),t}function d8(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>dw(e,l))),j(t,["generatedImages"],a)}return t}function f8(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>dw(e,l))),j(t,["generatedImages"],a)}return t}function h8(e,n){const t={},r=C(n,["endpoint"]);r!=null&&j(t,["name"],r);const a=C(n,["deployedModelId"]);return a!=null&&j(t,["deployedModelId"],a),t}function p8(e,n){const t={},r=C(n,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&j(t,["baseModel"],r);const a=C(n,["createTime"]);a!=null&&j(t,["createTime"],a);const l=C(n,["updateTime"]);return l!=null&&j(t,["updateTime"],l),t}function m8(e,n){const t={},r=C(n,["checkpointId"]);r!=null&&j(t,["checkpointId"],r);const a=C(n,["epoch"]);a!=null&&j(t,["epoch"],a);const l=C(n,["step"]);return l!=null&&j(t,["step"],l),t}function r1(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const l=C(n,["description"]);l!=null&&j(t,["description"],l);const o=C(n,["versionId"]);o!=null&&j(t,["version"],o);const f=C(n,["deployedModels"]);if(f!=null){let b=f;Array.isArray(b)&&(b=b.map(v=>h8(e,v))),j(t,["endpoints"],b)}const u=C(n,["labels"]);u!=null&&j(t,["labels"],u);const d=C(n,["_self"]);d!=null&&j(t,["tunedModelInfo"],p8(e,d));const h=C(n,["defaultCheckpointId"]);h!=null&&j(t,["defaultCheckpointId"],h);const g=C(n,["checkpoints"]);if(g!=null){let b=g;Array.isArray(b)&&(b=b.map(v=>m8(e,v))),j(t,["checkpoints"],b)}return t}function g8(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["_self"]);if(a!=null){let l=U2(e,a);Array.isArray(l)&&(l=l.map(o=>r1(e,o))),j(t,["models"],l)}return t}function y8(){return{}}function x8(e,n){const t={},r=C(n,["totalTokens"]);return r!=null&&j(t,["totalTokens"],r),t}function b8(e,n){const t={},r=C(n,["tokensInfo"]);return r!=null&&j(t,["tokensInfo"],r),t}function v8(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&j(t,["uri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&j(t,["videoBytes"],Wc(e,a));const l=C(n,["mimeType"]);return l!=null&&j(t,["mimeType"],l),t}function w8(e,n){const t={},r=C(n,["_self"]);return r!=null&&j(t,["video"],v8(e,r)),t}function S8(e,n){const t={},r=C(n,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(f=>w8(e,f))),j(t,["generatedVideos"],o)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const l=C(n,["raiMediaFilteredReasons"]);return l!=null&&j(t,["raiMediaFilteredReasons"],l),t}function N8(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const l=C(n,["done"]);l!=null&&j(t,["done"],l);const o=C(n,["error"]);o!=null&&j(t,["error"],o);const f=C(n,["response"]);return f!=null&&j(t,["response"],S8(e,f)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const C8="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function j8(e,n,t){const r=new q6;let a;if(t.data instanceof Blob?a=JSON.parse(await t.data.text()):a=JSON.parse(t.data),e.isVertexAI()){const l=m$(e,a);Object.assign(r,l)}else{const l=p$(e,a);Object.assign(r,l)}n(r)}class _8{constructor(n,t,r){this.apiClient=n,this.auth=t,this.webSocketFactory=r}async connect(n){var t,r,a,l;const o=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let u;const d=A8(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())u=`${o}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(d);else{const V=this.apiClient.getApiKey();u=`${o}/ws/google.ai.generativelanguage.${f}.GenerativeService.BidiGenerateContent?key=${V}`}let h=()=>{};const g=new Promise(V=>{h=V}),b=n.callbacks,v=function(){var V;(V=b==null?void 0:b.onopen)===null||V===void 0||V.call(b),h({})},N=this.apiClient,k={onopen:v,onmessage:V=>{j8(N,b.onmessage,V)},onerror:(t=b==null?void 0:b.onerror)!==null&&t!==void 0?t:function(V){},onclose:(r=b==null?void 0:b.onclose)!==null&&r!==void 0?r:function(V){}},T=this.webSocketFactory.create(u,T8(d),k);T.connect(),await g;let E=oi(this.apiClient,n.model);if(this.apiClient.isVertexAI()&&E.startsWith("publishers/")){const V=this.apiClient.getProject(),F=this.apiClient.getLocation();E=`projects/${V}/locations/${F}/`+E}let I={};this.apiClient.isVertexAI()&&((a=n.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(n.config===void 0?n.config={responseModalities:[Vc.AUDIO]}:n.config.responseModalities=[Vc.AUDIO]),!((l=n.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const P={model:E,config:n.config,callbacks:n.callbacks};return this.apiClient.isVertexAI()?I=$5(this.apiClient,P):I=F5(this.apiClient,P),delete I.config,T.send(JSON.stringify(I)),new E8(T,this.apiClient)}}const k8={turnComplete:!0};class E8{constructor(n,t){this.conn=n,this.apiClient=t}tLiveClientContent(n,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=Gc(n,t.turns),n.isVertexAI()?r=r.map(a=>Fh(n,a)):r=r.map(a=>Pb(n,a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(n,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const l of r){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!n.isVertexAI()&&!("id"in l))throw new Error(C8)}return{toolResponse:{functionResponses:r}}}sendClientContent(n){n=Object.assign(Object.assign({},k8),n);const t=this.tLiveClientContent(this.apiClient,n);this.conn.send(JSON.stringify(t))}sendRealtimeInput(n){let t={};this.apiClient.isVertexAI()?t={realtimeInput:H5(this.apiClient,n)}:t={realtimeInput:V5(this.apiClient,n)},this.conn.send(JSON.stringify(t))}sendToolResponse(n){if(n.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,n);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function T8(e){const n={};return e.forEach((t,r)=>{n[r]=t}),n}function A8(e){const n=new Headers;for(const[t,r]of Object.entries(e))n.append(t,r);return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class D8 extends lg{constructor(n){super(),this.apiClient=n,this.generateContent=async t=>await this.generateContentInternal(t),this.generateContentStream=async t=>await this.generateContentStreamInternal(t),this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var a;let l;const o=[];if(r!=null&&r.generatedImages)for(const u of r.generatedImages)u&&(u!=null&&u.safetyAttributes)&&((a=u==null?void 0:u.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?l=u==null?void 0:u.safetyAttributes:o.push(u);let f;return l?f={generatedImages:o,positivePromptSafetyAttributes:l}:f={generatedImages:o},f}),this.list=async t=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Db(Ah.PAGED_ITEM_MODELS,f=>this.listInternal(f),await this.listInternal(o),o)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const a={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(a)}}async generateContentInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=nC(this.apiClient,n);return f=Pt("{model}:generateContent",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=rC(this.apiClient,h),b=new gx;return Object.assign(b,g),b})}else{const d=tC(this.apiClient,n);return f=Pt("{model}:generateContent",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=iC(this.apiClient,h),b=new gx;return Object.assign(b,g),b})}}async generateContentStreamInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=nC(this.apiClient,n);f=Pt("{model}:streamGenerateContent?alt=sse",d._url),u=d._query,delete d.config,delete d._url,delete d._query;const h=this.apiClient;return o=h.requestStream({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(g){return lb(this,arguments,function*(){var b,v,N,k;try{for(var T=!0,E=t1(g),I;I=yield Sr(E.next()),b=I.done,!b;T=!0){k=I.value,T=!1;const V=rC(h,yield Sr(k.json())),F=new gx;Object.assign(F,V),yield yield Sr(F)}}catch(P){v={error:P}}finally{try{!T&&!b&&(N=E.return)&&(yield Sr(N.call(E)))}finally{if(v)throw v.error}}})})}else{const d=tC(this.apiClient,n);f=Pt("{model}:streamGenerateContent?alt=sse",d._url),u=d._query,delete d.config,delete d._url,delete d._query;const h=this.apiClient;return o=h.requestStream({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}),o.then(function(g){return lb(this,arguments,function*(){var b,v,N,k;try{for(var T=!0,E=t1(g),I;I=yield Sr(E.next()),b=I.done,!b;T=!0){k=I.value,T=!1;const V=iC(h,yield Sr(k.json())),F=new gx;Object.assign(F,V),yield yield Sr(F)}}catch(P){v={error:P}}finally{try{!T&&!b&&(N=E.return)&&(yield Sr(N.call(E)))}finally{if(v)throw v.error}}})})}}async embedContent(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=fz(this.apiClient,n);return f=Pt("{model}:predict",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=o8(this.apiClient,h),b=new UN;return Object.assign(b,g),b})}else{const d=D$(this.apiClient,n);return f=Pt("{model}:batchEmbedContents",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=Uz(this.apiClient,h),b=new UN;return Object.assign(b,g),b})}}async generateImagesInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=pz(this.apiClient,n);return f=Pt("{model}:predict",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=u8(this.apiClient,h),b=new qN;return Object.assign(b,g),b})}else{const d=I$(this.apiClient,n);return f=Pt("{model}:predict",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=Hz(this.apiClient,h),b=new qN;return Object.assign(b,g),b})}}async editImageInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI()){const f=wz(this.apiClient,n);return l=Pt("{model}:predict",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>{const d=d8(this.apiClient,u),h=new O6;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI()){const f=Nz(this.apiClient,n);return l=Pt("{model}:predict",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>{const d=f8(this.apiClient,u),h=new F6;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=Cz(this.apiClient,n);return f=Pt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>r1(this.apiClient,h))}else{const d=M$(this.apiClient,n);return f=Pt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>i1(this.apiClient,h))}}async listInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=_z(this.apiClient,n);return f=Pt("{models_url}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=g8(this.apiClient,h),b=new VN;return Object.assign(b,g),b})}else{const d=L$(this.apiClient,n);return f=Pt("{models_url}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=Yz(this.apiClient,h),b=new VN;return Object.assign(b,g),b})}}async update(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=Ez(this.apiClient,n);return f=Pt("{model}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>r1(this.apiClient,h))}else{const d=F$(this.apiClient,n);return f=Pt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>i1(this.apiClient,h))}}async delete(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=Tz(this.apiClient,n);return f=Pt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(()=>{const h=y8(),g=new HN;return Object.assign(g,h),g})}else{const d=$$(this.apiClient,n);return f=Pt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(()=>{const h=Wz(),g=new HN;return Object.assign(g,h),g})}}async countTokens(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=Dz(this.apiClient,n);return f=Pt("{model}:countTokens",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=x8(this.apiClient,h),b=new GN;return Object.assign(b,g),b})}else{const d=B$(this.apiClient,n);return f=Pt("{model}:countTokens",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=Qz(this.apiClient,h),b=new GN;return Object.assign(b,g),b})}}async computeTokens(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI()){const f=Pz(this.apiClient,n);return l=Pt("{model}:computeTokens",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>{const d=b8(this.apiClient,u),h=new $6;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=Mz(this.apiClient,n);return f=Pt("{model}:predictLongRunning",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>N8(this.apiClient,h))}else{const d=V$(this.apiClient,n);return f=Pt("{model}:predictLongRunning",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>Zz(this.apiClient,h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function P8(e,n){const t={},r=C(n,["operationName"]);r!=null&&j(t,["_url","operationName"],r);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function I8(e,n){const t={},r=C(n,["operationName"]);r!=null&&j(t,["_url","operationName"],r);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function M8(e,n){const t={},r=C(n,["operationName"]);r!=null&&j(t,["operationName"],r);const a=C(n,["resourceName"]);a!=null&&j(t,["_url","resourceName"],a);const l=C(n,["config"]);return l!=null&&j(t,["config"],l),t}function R8(e,n){const t={},r=C(n,["video","uri"]);r!=null&&j(t,["uri"],r);const a=C(n,["video","encodedVideo"]);a!=null&&j(t,["videoBytes"],Wc(e,a));const l=C(n,["encoding"]);return l!=null&&j(t,["mimeType"],l),t}function L8(e,n){const t={},r=C(n,["_self"]);return r!=null&&j(t,["video"],R8(e,r)),t}function O8(e,n){const t={},r=C(n,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(f=>L8(e,f))),j(t,["generatedVideos"],o)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const l=C(n,["raiMediaFilteredReasons"]);return l!=null&&j(t,["raiMediaFilteredReasons"],l),t}function F8(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const l=C(n,["done"]);l!=null&&j(t,["done"],l);const o=C(n,["error"]);o!=null&&j(t,["error"],o);const f=C(n,["response","generateVideoResponse"]);return f!=null&&j(t,["response"],O8(e,f)),t}function $8(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&j(t,["uri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&j(t,["videoBytes"],Wc(e,a));const l=C(n,["mimeType"]);return l!=null&&j(t,["mimeType"],l),t}function z8(e,n){const t={},r=C(n,["_self"]);return r!=null&&j(t,["video"],$8(e,r)),t}function B8(e,n){const t={},r=C(n,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(f=>z8(e,f))),j(t,["generatedVideos"],o)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const l=C(n,["raiMediaFilteredReasons"]);return l!=null&&j(t,["raiMediaFilteredReasons"],l),t}function aC(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const l=C(n,["done"]);l!=null&&j(t,["done"],l);const o=C(n,["error"]);o!=null&&j(t,["error"],o);const f=C(n,["response"]);return f!=null&&j(t,["response"],B8(e,f)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class U8 extends lg{constructor(n){super(),this.apiClient=n}async getVideosOperation(n){const t=n.operation,r=n.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=t.name.split("/operations/")[0];let l;return r&&"httpOptions"in r&&(l=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:a,config:{httpOptions:l}})}else return this.getVideosOperationInternal({operationName:t.name,config:r})}async getVideosOperationInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=I8(this.apiClient,n);return f=Pt("{operationName}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>aC(this.apiClient,h))}else{const d=P8(this.apiClient,n);return f=Pt("{operationName}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>F8(this.apiClient,h))}}async fetchPredictVideosOperationInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI()){const f=M8(this.apiClient,n);return l=Pt("{resourceName}:fetchPredictOperation",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>aC(this.apiClient,u))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const q8="Content-Type",V8="X-Server-Timeout",H8="User-Agent",G8="x-goog-api-client",Y8="0.14.1",W8=`google-genai-sdk/${Y8}`,Q8="v1beta1",J8="v1beta",sC=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Y2 extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ClientError"}}class a1 extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ServerError"}}class K8{constructor(n){var t,r;this.clientOptions=Object.assign(Object.assign({},n),{project:n.project,location:n.location,apiKey:n.apiKey,vertexai:n.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:Q8,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:J8,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,n.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,n.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var n;return(n=this.clientOptions.vertexai)!==null&&n!==void 0?n:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(n){if(!n||n.baseUrl===void 0||n.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[n.baseUrl.endsWith("/")?n.baseUrl.slice(0,-1):n.baseUrl];return n.apiVersion&&n.apiVersion!==""&&r.push(n.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const n=this.getBaseUrl(),t=new URL(n);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(n){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=n;else throw new Error("HTTP options are not correctly set.")}constructUrl(n,t,r){const a=[this.getRequestUrlInternal(t)];return r&&a.push(this.getBaseResourcePath()),n!==""&&a.push(n),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(n){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||n.path.startsWith("projects/")||n.httpMethod==="GET"&&n.path.startsWith("publishers/google/models"))}async request(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);if(n.queryParams)for(const[o,f]of Object.entries(n.queryParams))a.searchParams.append(o,String(f));let l={};if(n.httpMethod==="GET"){if(n.body&&n.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=n.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,t,n.abortSignal),this.unaryApiCall(a,l,n.httpMethod)}patchHttpOptions(n,t){const r=JSON.parse(JSON.stringify(n));for(const[a,l]of Object.entries(t))typeof l=="object"?r[a]=Object.assign(Object.assign({},r[a]),l):l!==void 0&&(r[a]=l);return r}async requestStream(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let l={};return l.body=n.body,l=await this.includeExtraHttpOptionsToRequestInit(l,t,n.abortSignal),this.streamApiCall(a,l,n.httpMethod)}async includeExtraHttpOptionsToRequestInit(n,t,r){if(t&&t.timeout||r){const a=new AbortController,l=a.signal;t.timeout&&(t==null?void 0:t.timeout)>0&&setTimeout(()=>a.abort(),t.timeout),r&&r.addEventListener("abort",()=>{a.abort()}),n.signal=l}return n.headers=await this.getHeadersInternal(t),n}async unaryApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await lC(a),new e1(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await lC(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(n){var t;return lb(this,arguments,function*(){const a=(t=n==null?void 0:n.body)===null||t===void 0?void 0:t.getReader(),l=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let o="";for(;;){const{done:f,value:u}=yield Sr(a.read());if(f){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=l.decode(u);try{const g=JSON.parse(d);if("error"in g){const b=JSON.parse(JSON.stringify(g.error)),v=b.status,N=b.code,k=`got status: ${v}. ${JSON.stringify(g)}`;if(N>=400&&N<500)throw new Y2(k);if(N>=500&&N<600)throw new a1(k)}}catch(g){const b=g;if(b.name==="ClientError"||b.name==="ServerError")throw g}o+=d;let h=o.match(sC);for(;h;){const g=h[1];try{const b=new Response(g,{headers:n==null?void 0:n.headers,status:n==null?void 0:n.status,statusText:n==null?void 0:n.statusText});yield yield Sr(new e1(b)),o=o.slice(h[0].length),h=o.match(sC)}catch(b){throw new Error(`exception parsing stream chunk ${g}. ${b}`)}}}}finally{a.releaseLock()}})}async apiCall(n,t){return fetch(n,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const n={},t=W8+" "+this.clientOptions.userAgentExtra;return n[H8]=t,n[G8]=t,n[q8]="application/json",n}async getHeadersInternal(n){const t=new Headers;if(n&&n.headers){for(const[r,a]of Object.entries(n.headers))t.append(r,a);n.timeout&&n.timeout>0&&t.append(V8,String(Math.ceil(n.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(n,t){var r;const a={};t!=null&&(a.mimeType=t.mimeType,a.name=t.name,a.displayName=t.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const l=this.clientOptions.uploader,o=await l.stat(n);a.sizeBytes=String(o.size);const f=(r=t==null?void 0:t.mimeType)!==null&&r!==void 0?r:o.type;if(f===void 0||f==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=f;const u=await this.fetchUploadUrl(a,t);return l.upload(n,u,this)}async downloadFile(n){await this.clientOptions.downloader.download(n,this)}async fetchUploadUrl(n,t){var r;let a={};t!=null&&t.httpOptions?a=t.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${n.mimeType}`}};const l={file:n},o=await this.request({path:Pt("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:a});if(!o||!(o!=null&&o.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const f=(r=o==null?void 0:o.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(f===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return f}}async function lC(e){var n;if(e===void 0)throw new a1("response is undefined");if(!e.ok){const t=e.status,r=e.statusText;let a;!((n=e.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?a=await e.json():a={error:{message:await e.text(),code:e.status,status:e.statusText}};const l=`got status: ${t} ${r}. ${JSON.stringify(a)}`;throw t>=400&&t<500?new Y2(l):t>=500&&t<600?new a1(l):new Error(l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function X8(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],r);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function Z8(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const l=C(n,["pageToken"]);t!==void 0&&l!=null&&j(t,["_query","pageToken"],l);const o=C(n,["filter"]);return t!==void 0&&o!=null&&j(t,["_query","filter"],o),r}function eB(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],Z8(e,r,t)),t}function tB(e,n){const t={},r=C(n,["textInput"]);r!=null&&j(t,["textInput"],r);const a=C(n,["output"]);return a!=null&&j(t,["output"],a),t}function nB(e,n){const t={};if(C(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=C(n,["examples"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>tB(e,l))),j(t,["examples","examples"],a)}return t}function iB(e,n,t){const r={};if(C(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const a=C(n,["tunedModelDisplayName"]);if(t!==void 0&&a!=null&&j(t,["displayName"],a),C(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const l=C(n,["epochCount"]);t!==void 0&&l!=null&&j(t,["tuningTask","hyperparameters","epochCount"],l);const o=C(n,["learningRateMultiplier"]);if(o!=null&&j(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),C(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(C(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const f=C(n,["batchSize"]);t!==void 0&&f!=null&&j(t,["tuningTask","hyperparameters","batchSize"],f);const u=C(n,["learningRate"]);return t!==void 0&&u!=null&&j(t,["tuningTask","hyperparameters","learningRate"],u),r}function rB(e,n){const t={},r=C(n,["baseModel"]);r!=null&&j(t,["baseModel"],r);const a=C(n,["trainingDataset"]);a!=null&&j(t,["tuningTask","trainingData"],nB(e,a));const l=C(n,["config"]);return l!=null&&j(t,["config"],iB(e,l,t)),t}function aB(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],r);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function sB(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const l=C(n,["pageToken"]);t!==void 0&&l!=null&&j(t,["_query","pageToken"],l);const o=C(n,["filter"]);return t!==void 0&&o!=null&&j(t,["_query","filter"],o),r}function lB(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],sB(e,r,t)),t}function oB(e,n,t){const r={},a=C(n,["gcsUri"]);if(t!==void 0&&a!=null&&j(t,["supervisedTuningSpec","trainingDatasetUri"],a),C(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function cB(e,n){const t={},r=C(n,["gcsUri"]);return r!=null&&j(t,["validationDatasetUri"],r),t}function uB(e,n,t){const r={},a=C(n,["validationDataset"]);t!==void 0&&a!=null&&j(t,["supervisedTuningSpec"],cB(e,a));const l=C(n,["tunedModelDisplayName"]);t!==void 0&&l!=null&&j(t,["tunedModelDisplayName"],l);const o=C(n,["description"]);t!==void 0&&o!=null&&j(t,["description"],o);const f=C(n,["epochCount"]);t!==void 0&&f!=null&&j(t,["supervisedTuningSpec","hyperParameters","epochCount"],f);const u=C(n,["learningRateMultiplier"]);t!==void 0&&u!=null&&j(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],u);const d=C(n,["exportLastCheckpointOnly"]);t!==void 0&&d!=null&&j(t,["supervisedTuningSpec","exportLastCheckpointOnly"],d);const h=C(n,["adapterSize"]);if(t!==void 0&&h!=null&&j(t,["supervisedTuningSpec","hyperParameters","adapterSize"],h),C(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(C(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function dB(e,n){const t={},r=C(n,["baseModel"]);r!=null&&j(t,["baseModel"],r);const a=C(n,["trainingDataset"]);a!=null&&j(t,["supervisedTuningSpec","trainingDatasetUri"],oB(e,a,t));const l=C(n,["config"]);return l!=null&&j(t,["config"],uB(e,l,t)),t}function fB(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["model"],r);const a=C(n,["name"]);return a!=null&&j(t,["endpoint"],a),t}function W2(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["state"]);a!=null&&j(t,["state"],$2(e,a));const l=C(n,["createTime"]);l!=null&&j(t,["createTime"],l);const o=C(n,["tuningTask","startTime"]);o!=null&&j(t,["startTime"],o);const f=C(n,["tuningTask","completeTime"]);f!=null&&j(t,["endTime"],f);const u=C(n,["updateTime"]);u!=null&&j(t,["updateTime"],u);const d=C(n,["description"]);d!=null&&j(t,["description"],d);const h=C(n,["baseModel"]);h!=null&&j(t,["baseModel"],h);const g=C(n,["_self"]);g!=null&&j(t,["tunedModel"],fB(e,g));const b=C(n,["distillationSpec"]);b!=null&&j(t,["distillationSpec"],b);const v=C(n,["experiment"]);v!=null&&j(t,["experiment"],v);const N=C(n,["labels"]);N!=null&&j(t,["labels"],N);const k=C(n,["pipelineJob"]);k!=null&&j(t,["pipelineJob"],k);const T=C(n,["tunedModelDisplayName"]);return T!=null&&j(t,["tunedModelDisplayName"],T),t}function hB(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["tunedModels"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(o=>W2(e,o))),j(t,["tuningJobs"],l)}return t}function pB(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const l=C(n,["done"]);l!=null&&j(t,["done"],l);const o=C(n,["error"]);return o!=null&&j(t,["error"],o),t}function mB(e,n){const t={},r=C(n,["checkpointId"]);r!=null&&j(t,["checkpointId"],r);const a=C(n,["epoch"]);a!=null&&j(t,["epoch"],a);const l=C(n,["step"]);l!=null&&j(t,["step"],l);const o=C(n,["endpoint"]);return o!=null&&j(t,["endpoint"],o),t}function gB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["model"],r);const a=C(n,["endpoint"]);a!=null&&j(t,["endpoint"],a);const l=C(n,["checkpoints"]);if(l!=null){let o=l;Array.isArray(o)&&(o=o.map(f=>mB(e,f))),j(t,["checkpoints"],o)}return t}function s1(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["state"]);a!=null&&j(t,["state"],$2(e,a));const l=C(n,["createTime"]);l!=null&&j(t,["createTime"],l);const o=C(n,["startTime"]);o!=null&&j(t,["startTime"],o);const f=C(n,["endTime"]);f!=null&&j(t,["endTime"],f);const u=C(n,["updateTime"]);u!=null&&j(t,["updateTime"],u);const d=C(n,["error"]);d!=null&&j(t,["error"],d);const h=C(n,["description"]);h!=null&&j(t,["description"],h);const g=C(n,["baseModel"]);g!=null&&j(t,["baseModel"],g);const b=C(n,["tunedModel"]);b!=null&&j(t,["tunedModel"],gB(e,b));const v=C(n,["supervisedTuningSpec"]);v!=null&&j(t,["supervisedTuningSpec"],v);const N=C(n,["tuningDataStats"]);N!=null&&j(t,["tuningDataStats"],N);const k=C(n,["encryptionSpec"]);k!=null&&j(t,["encryptionSpec"],k);const T=C(n,["partnerModelTuningSpec"]);T!=null&&j(t,["partnerModelTuningSpec"],T);const E=C(n,["distillationSpec"]);E!=null&&j(t,["distillationSpec"],E);const I=C(n,["experiment"]);I!=null&&j(t,["experiment"],I);const P=C(n,["labels"]);P!=null&&j(t,["labels"],P);const V=C(n,["pipelineJob"]);V!=null&&j(t,["pipelineJob"],V);const F=C(n,["tunedModelDisplayName"]);return F!=null&&j(t,["tunedModelDisplayName"],F),t}function yB(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["tuningJobs"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(o=>s1(e,o))),j(t,["tuningJobs"],l)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xB extends lg{constructor(n){super(),this.apiClient=n,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Db(Ah.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const r=await this.tuneMldevInternal(t);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:Zv.JOB_STATE_QUEUED}}}}async getInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=aB(this.apiClient,n);return f=Pt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>s1(this.apiClient,h))}else{const d=X8(this.apiClient,n);return f=Pt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>W2(this.apiClient,h))}}async listInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=lB(this.apiClient,n);return f=Pt("tuningJobs",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=yB(this.apiClient,h),b=new YN;return Object.assign(b,g),b})}else{const d=eB(this.apiClient,n);return f=Pt("tunedModels",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=hB(this.apiClient,h),b=new YN;return Object.assign(b,g),b})}}async tuneInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI()){const f=dB(this.apiClient,n);return l=Pt("tuningJobs",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>s1(this.apiClient,u))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=rB(this.apiClient,n);return l=Pt("tunedModels",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>pB(this.apiClient,u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class bB{async download(n,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const vB=1024*1024*8,wB=3,SB=1e3,NB=2,ev="x-goog-upload-status";async function CB(e,n,t){var r,a,l;let o=0,f=0,u=new e1(new Response),d="upload";for(o=e.size;f<o;){const g=Math.min(vB,o-f),b=e.slice(f,f+g);f+g>=o&&(d+=", finalize");let v=0,N=SB;for(;v<wB&&(u=await t.request({path:"",body:b,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:n,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(f),"Content-Length":String(g)}}}),!(!((r=u==null?void 0:u.headers)===null||r===void 0)&&r[ev]));)v++,await _B(N),N=N*NB;if(f+=g,((a=u==null?void 0:u.headers)===null||a===void 0?void 0:a[ev])!=="active")break;if(o<=f)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const h=await(u==null?void 0:u.json());if(((l=u==null?void 0:u.headers)===null||l===void 0?void 0:l[ev])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return h.file}async function jB(e){return{size:e.size,type:e.type}}function _B(e){return new Promise(n=>setTimeout(n,e))}class kB{async upload(n,t,r){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await CB(n,t,r)}async stat(n){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await jB(n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class EB{create(n,t,r){return new TB(n,t,r)}}class TB{constructor(n,t,r){this.url=n,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(n){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(n)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const oC="x-goog-api-key";class AB{constructor(n){this.apiKey=n}async addAuthHeaders(n){n.get(oC)===null&&n.append(oC,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const DB="gl-node/";class Q2{constructor(n){var t;if(n.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(n.project||n.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=n.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=n.apiKey;const r=BF(n,void 0,void 0);r&&(n.httpOptions?n.httpOptions.baseUrl=r:n.httpOptions={baseUrl:r}),this.apiVersion=n.apiVersion;const a=new AB(this.apiKey);this.apiClient=new K8({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:n.httpOptions,userAgentExtra:DB+"web",uploader:new kB,downloader:new bB}),this.models=new D8(this.apiClient),this.live=new _8(this.apiClient,a,new EB),this.chats=new W6(this.models,this.apiClient),this.caches=new V6(this.apiClient),this.files=new l5(this.apiClient),this.operations=new U8(this.apiClient),this.tunings=new xB(this.apiClient)}}const dh=new Map,J2=(()=>{const e=new Promise(n=>{window.addEventListener("pointerdown",n,{once:!0}),window.addEventListener("keydown",n,{once:!0})});return async n=>{try{const t=new Audio;if(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",await t.play(),n!=null&&n.id&&dh.has(n.id)){const a=dh.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&dh.set(n.id,r),r}catch{if(await e,n!=null&&n.id&&dh.has(n.id)){const a=dh.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&dh.set(n.id,r),r}}})();function PB(e){var n=atob(e),t=new Uint8Array(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t.buffer}const IB=`
class AudioProcessingWorklet extends AudioWorkletProcessor {

  // send and clear buffer every 2048 samples, 
  // which at 16khz is about 8 times a second
  buffer = new Int16Array(2048);

  // current write index
  bufferWriteIndex = 0;

  constructor() {
    super();
    this.hasAudio = false;
  }

  /**
   * @param inputs Float32Array[][] [input#][channel#][sample#] so to access first inputs 1st channel inputs[0][0]
   * @param outputs Float32Array[][]
   */
  process(inputs) {
    if (inputs[0].length) {
      const channel0 = inputs[0][0];
      this.processChunk(channel0);
    }
    return true;
  }

  sendAndClearBuffer(){
    this.port.postMessage({
      event: "chunk",
      data: {
        int16arrayBuffer: this.buffer.slice(0, this.bufferWriteIndex).buffer,
      },
    });
    this.bufferWriteIndex = 0;
  }

  processChunk(float32Array) {
    const l = float32Array.length;
    
    for (let i = 0; i < l; i++) {
      // convert float32 -1 to 1 to int16 -32768 to 32767
      const int16Value = float32Array[i] * 32768;
      this.buffer[this.bufferWriteIndex++] = int16Value;
      if(this.bufferWriteIndex >= this.buffer.length) {
        this.sendAndClearBuffer();
      }
    }

    if(this.bufferWriteIndex >= this.buffer.length) {
      this.sendAndClearBuffer();
    }
  }
}
`,K2=`
  class VolMeter extends AudioWorkletProcessor {
    volume
    updateIntervalInMS
    nextUpdateFrame

    constructor() {
      super()
      this.volume = 0
      this.updateIntervalInMS = 25
      this.nextUpdateFrame = this.updateIntervalInMS
      this.port.onmessage = event => {
        if (event.data.updateIntervalInMS) {
          this.updateIntervalInMS = event.data.updateIntervalInMS
        }
      }
    }

    get intervalInFrames() {
      return (this.updateIntervalInMS / 1000) * sampleRate
    }

    process(inputs) {
      const input = inputs[0]

      if (input.length > 0) {
        const samples = input[0]
        let sum = 0
        let rms = 0

        for (let i = 0; i < samples.length; ++i) {
          sum += samples[i] * samples[i]
        }

        rms = Math.sqrt(sum / samples.length)
        this.volume = Math.max(rms, this.volume * 0.7)

        this.nextUpdateFrame -= samples.length
        if (this.nextUpdateFrame < 0) {
          this.nextUpdateFrame += this.intervalInFrames
          this.port.postMessage({volume: this.volume})
        }
      }

      return true
    }
  }`,bx=new Map,l1=(e,n)=>{const t=new Blob([`registerProcessor("${e}", ${n})`],{type:"application/javascript"});return URL.createObjectURL(t)};var tv={exports:{}},cC;function MB(){return cC||(cC=1,function(e){var n=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function a(u,d,h){this.fn=u,this.context=d,this.once=h||!1}function l(u,d,h,g,b){if(typeof h!="function")throw new TypeError("The listener must be a function");var v=new a(h,g||u,b),N=t?t+d:d;return u._events[N]?u._events[N].fn?u._events[N]=[u._events[N],v]:u._events[N].push(v):(u._events[N]=v,u._eventsCount++),u}function o(u,d){--u._eventsCount===0?u._events=new r:delete u._events[d]}function f(){this._events=new r,this._eventsCount=0}f.prototype.eventNames=function(){var d=[],h,g;if(this._eventsCount===0)return d;for(g in h=this._events)n.call(h,g)&&d.push(t?g.slice(1):g);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(h)):d},f.prototype.listeners=function(d){var h=t?t+d:d,g=this._events[h];if(!g)return[];if(g.fn)return[g.fn];for(var b=0,v=g.length,N=new Array(v);b<v;b++)N[b]=g[b].fn;return N},f.prototype.listenerCount=function(d){var h=t?t+d:d,g=this._events[h];return g?g.fn?1:g.length:0},f.prototype.emit=function(d,h,g,b,v,N){var k=t?t+d:d;if(!this._events[k])return!1;var T=this._events[k],E=arguments.length,I,P;if(T.fn){switch(T.once&&this.removeListener(d,T.fn,void 0,!0),E){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,h),!0;case 3:return T.fn.call(T.context,h,g),!0;case 4:return T.fn.call(T.context,h,g,b),!0;case 5:return T.fn.call(T.context,h,g,b,v),!0;case 6:return T.fn.call(T.context,h,g,b,v,N),!0}for(P=1,I=new Array(E-1);P<E;P++)I[P-1]=arguments[P];T.fn.apply(T.context,I)}else{var V=T.length,F;for(P=0;P<V;P++)switch(T[P].once&&this.removeListener(d,T[P].fn,void 0,!0),E){case 1:T[P].fn.call(T[P].context);break;case 2:T[P].fn.call(T[P].context,h);break;case 3:T[P].fn.call(T[P].context,h,g);break;case 4:T[P].fn.call(T[P].context,h,g,b);break;default:if(!I)for(F=1,I=new Array(E-1);F<E;F++)I[F-1]=arguments[F];T[P].fn.apply(T[P].context,I)}}return!0},f.prototype.on=function(d,h,g){return l(this,d,h,g,!1)},f.prototype.once=function(d,h,g){return l(this,d,h,g,!0)},f.prototype.removeListener=function(d,h,g,b){var v=t?t+d:d;if(!this._events[v])return this;if(!h)return o(this,v),this;var N=this._events[v];if(N.fn)N.fn===h&&(!b||N.once)&&(!g||N.context===g)&&o(this,v);else{for(var k=0,T=[],E=N.length;k<E;k++)(N[k].fn!==h||b&&!N[k].once||g&&N[k].context!==g)&&T.push(N[k]);T.length?this._events[v]=T.length===1?T[0]:T:o(this,v)}return this},f.prototype.removeAllListeners=function(d){var h;return d?(h=t?t+d:d,this._events[h]&&o(this,h)):(this._events=new r,this._eventsCount=0),this},f.prototype.off=f.prototype.removeListener,f.prototype.addListener=f.prototype.on,f.prefixed=t,f.EventEmitter=f,e.exports=f}(tv)),tv.exports}var RB=MB();const X2=Fd(RB);function LB(e){for(var n="",t=new Uint8Array(e),r=t.byteLength,a=0;a<r;a++)n+=String.fromCharCode(t[a]);return window.btoa(n)}class Z2 extends X2{constructor(t=16e3){super();Rn(this,"stream");Rn(this,"audioContext");Rn(this,"source");Rn(this,"recording",!1);Rn(this,"recordingWorklet");Rn(this,"vuWorklet");Rn(this,"starting",null);this.sampleRate=t}async start(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Could not request user media");this.starting=new Promise(async t=>{this.stream=await navigator.mediaDevices.getUserMedia({audio:!0}),this.audioContext=await J2({sampleRate:this.sampleRate}),this.source=this.audioContext.createMediaStreamSource(this.stream);const r="audio-recorder-worklet",a=l1(r,IB);await this.audioContext.audioWorklet.addModule(a),this.recordingWorklet=new AudioWorkletNode(this.audioContext,r),this.recordingWorklet.port.onmessage=async o=>{const f=o.data.data.int16arrayBuffer;if(f){const u=LB(f);this.emit("data",u)}},this.source.connect(this.recordingWorklet);const l="vu-meter";await this.audioContext.audioWorklet.addModule(l1(l,K2)),this.vuWorklet=new AudioWorkletNode(this.audioContext,l),this.vuWorklet.port.onmessage=o=>{this.emit("volume",o.data.volume)},this.source.connect(this.vuWorklet),this.recording=!0,t(),this.starting=null})}stop(){const t=()=>{var r,a;(r=this.source)==null||r.disconnect(),(a=this.stream)==null||a.getTracks().forEach(l=>l.stop()),this.stream=void 0,this.recordingWorklet=void 0,this.vuWorklet=void 0,this.audioContext&&(this.audioContext.close(),this.audioContext=void 0)};if(this.starting){this.starting.then(t);return}t()}}const OB=3,FB=({active:e,volume:n,hover:t})=>{const r=w.useRef([]);return w.useEffect(()=>{let a=null;const l=()=>{r.current.forEach((o,f)=>{o&&(o.style.height=`${Math.min(24,4+n*(f===1?400:60))}px`)}),a=window.setTimeout(l,100)};return l(),()=>clearTimeout(a)},[n]),i.jsx("div",{className:qc("audioPulse",{active:e,hover:t}),children:Array(OB).fill(null).map((a,l)=>i.jsx("div",{ref:o=>{r.current[l]=o},style:{animationDelay:`${l*133}ms`}},l))})};var Fm={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var $B=Fm.exports,uC;function zB(){return uC||(uC=1,function(e,n){(function(){var t,r="4.17.21",a=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",f="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",d=500,h="__lodash_placeholder__",g=1,b=2,v=4,N=1,k=2,T=1,E=2,I=4,P=8,V=16,F=32,$=64,B=128,z=256,q=512,O=30,R="...",G=800,ee=16,te=1,le=2,K=3,U=1/0,J=9007199254740991,ne=17976931348623157e292,A=NaN,ae=4294967295,ce=ae-1,M=ae>>>1,de=[["ary",B],["bind",T],["bindKey",E],["curry",P],["curryRight",V],["flip",q],["partial",F],["partialRight",$],["rearg",z]],Se="[object Arguments]",fe="[object Array]",we="[object AsyncFunction]",re="[object Boolean]",_e="[object Date]",qe="[object DOMException]",et="[object Error]",Je="[object Function]",Le="[object GeneratorFunction]",xe="[object Map]",Me="[object Number]",ve="[object Null]",Ee="[object Object]",De="[object Promise]",nt="[object Proxy]",lt="[object RegExp]",Xe="[object Set]",Mt="[object String]",_t="[object Symbol]",an="[object Undefined]",se="[object WeakMap]",Q="[object WeakSet]",ie="[object ArrayBuffer]",je="[object DataView]",Ae="[object Float32Array]",Be="[object Float64Array]",st="[object Int8Array]",pt="[object Int16Array]",dt="[object Int32Array]",ze="[object Uint8Array]",Ke="[object Uint8ClampedArray]",Fe="[object Uint16Array]",at="[object Uint32Array]",Qe=/\b__p \+= '';/g,yt=/\b(__p \+=) '' \+/g,Un=/(__e\(.*?\)|\b__t\)) \+\n'';/g,On=/&(?:amp|lt|gt|quot|#39);/g,Cn=/[&<>"']/g,mn=RegExp(On.source),un=RegExp(Cn.source),Ni=/<%-([\s\S]+?)%>/g,Hi=/<%([\s\S]+?)%>/g,ar=/<%=([\s\S]+?)%>/g,oa=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,kr=/^\w*$/,ni=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Kn=/[\\^$.*+?()[\]{}|]/g,Fn=RegExp(Kn.source),La=/^\s+/,ss=/\s/,Vh=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Hh=/\{\n\/\* \[wrapped with (.+)\] \*/,Bd=/,? & /,ls=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Zc=/[()=,{}\[\]\/\s]/,Us=/\\(\\)?/g,qs=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Oa=/\w*$/,Vs=/^[-+]0x[0-9a-f]+$/i,ci=/^0b[01]+$/i,Ud=/^\[object .+?Constructor\]$/,Ro=/^0o[0-7]+$/i,os=/^(?:0|[1-9]\d*)$/,Fa=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Gi=/($^)/,Hs=/['\n\r\u2028\u2029\\]/g,$a="\\ud800-\\udfff",qd="\\u0300-\\u036f",Fl="\\ufe20-\\ufe2f",Gs="\\u20d0-\\u20ff",sr=qd+Fl+Gs,$l="\\u2700-\\u27bf",Lo="a-z\\xdf-\\xf6\\xf8-\\xff",ca="\\xac\\xb1\\xd7\\xf7",eu="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",tu="\\u2000-\\u206f",Vd=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",nu="A-Z\\xc0-\\xd6\\xd8-\\xde",Oi="\\ufe0e\\ufe0f",Ys=ca+eu+tu+Vd,Oo="[']",cs="["+$a+"]",Fo="["+Ys+"]",Or="["+sr+"]",iu="\\d+",Di="["+$l+"]",zl="["+Lo+"]",Ws="[^"+$a+Ys+iu+$l+Lo+nu+"]",Qs="\\ud83c[\\udffb-\\udfff]",ua="(?:"+Or+"|"+Qs+")",Js="[^"+$a+"]",us="(?:\\ud83c[\\udde6-\\uddff]){2}",da="[\\ud800-\\udbff][\\udc00-\\udfff]",fa="["+nu+"]",Bl="\\u200d",Ul="(?:"+zl+"|"+Ws+")",ql="(?:"+fa+"|"+Ws+")",$o="(?:"+Oo+"(?:d|ll|m|re|s|t|ve))?",zo="(?:"+Oo+"(?:D|LL|M|RE|S|T|VE))?",ds=ua+"?",Ks="["+Oi+"]?",Vl="(?:"+Bl+"(?:"+[Js,us,da].join("|")+")"+Ks+ds+")*",Fi="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",za="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Bo=Ks+ds+Vl,ha="(?:"+[Di,us,da].join("|")+")"+Bo,Xs="(?:"+[Js+Or+"?",Or,us,da,cs].join("|")+")",Hl=RegExp(Oo,"g"),lr=RegExp(Or,"g"),Zs=RegExp(Qs+"(?="+Qs+")|"+Xs+Bo,"g"),fs=RegExp([fa+"?"+zl+"+"+$o+"(?="+[Fo,fa,"$"].join("|")+")",ql+"+"+zo+"(?="+[Fo,fa+Ul,"$"].join("|")+")",fa+"?"+Ul+"+"+$o,fa+"+"+zo,za,Fi,iu,ha].join("|"),"g"),Fr=RegExp("["+Bl+$a+sr+Oi+"]"),Uo=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,hs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Hd=-1,gn={};gn[Ae]=gn[Be]=gn[st]=gn[pt]=gn[dt]=gn[ze]=gn[Ke]=gn[Fe]=gn[at]=!0,gn[Se]=gn[fe]=gn[ie]=gn[re]=gn[je]=gn[_e]=gn[et]=gn[Je]=gn[xe]=gn[Me]=gn[Ee]=gn[lt]=gn[Xe]=gn[Mt]=gn[se]=!1;var ln={};ln[Se]=ln[fe]=ln[ie]=ln[je]=ln[re]=ln[_e]=ln[Ae]=ln[Be]=ln[st]=ln[pt]=ln[dt]=ln[xe]=ln[Me]=ln[Ee]=ln[lt]=ln[Xe]=ln[Mt]=ln[_t]=ln[ze]=ln[Ke]=ln[Fe]=ln[at]=!0,ln[et]=ln[Je]=ln[se]=!1;var qo={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Pi={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Qt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},el={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ba=parseFloat,ru=parseInt,Ua=typeof Uc=="object"&&Uc&&Uc.Object===Object&&Uc,ps=typeof self=="object"&&self&&self.Object===Object&&self,Xn=Ua||ps||Function("return this")(),ms=n&&!n.nodeType&&n,Yi=ms&&!0&&e&&!e.nodeType&&e,au=Yi&&Yi.exports===ms,Gl=au&&Ua.process,Ii=function(){try{var W=Yi&&Yi.require&&Yi.require("util").types;return W||Gl&&Gl.binding&&Gl.binding("util")}catch{}}(),pa=Ii&&Ii.isArrayBuffer,su=Ii&&Ii.isDate,Vo=Ii&&Ii.isMap,gs=Ii&&Ii.isRegExp,Gd=Ii&&Ii.isSet,lu=Ii&&Ii.isTypedArray;function ui(W,ue,ge){switch(ge.length){case 0:return W.call(ue);case 1:return W.call(ue,ge[0]);case 2:return W.call(ue,ge[0],ge[1]);case 3:return W.call(ue,ge[0],ge[1],ge[2])}return W.apply(ue,ge)}function Ho(W,ue,ge,$e){for(var We=-1,tt=W==null?0:W.length;++We<tt;){var Jt=W[We];ue($e,Jt,ge(Jt),W)}return $e}function $i(W,ue){for(var ge=-1,$e=W==null?0:W.length;++ge<$e&&ue(W[ge],ge,W)!==!1;);return W}function Gh(W,ue){for(var ge=W==null?0:W.length;ge--&&ue(W[ge],ge,W)!==!1;);return W}function Yl(W,ue){for(var ge=-1,$e=W==null?0:W.length;++ge<$e;)if(!ue(W[ge],ge,W))return!1;return!0}function $r(W,ue){for(var ge=-1,$e=W==null?0:W.length,We=0,tt=[];++ge<$e;){var Jt=W[ge];ue(Jt,ge,W)&&(tt[We++]=Jt)}return tt}function Go(W,ue){var ge=W==null?0:W.length;return!!ge&&Wi(W,ue,0)>-1}function ou(W,ue,ge){for(var $e=-1,We=W==null?0:W.length;++$e<We;)if(ge(ue,W[$e]))return!0;return!1}function In(W,ue){for(var ge=-1,$e=W==null?0:W.length,We=Array($e);++ge<$e;)We[ge]=ue(W[ge],ge,W);return We}function ma(W,ue){for(var ge=-1,$e=ue.length,We=W.length;++ge<$e;)W[We+ge]=ue[ge];return W}function cu(W,ue,ge,$e){var We=-1,tt=W==null?0:W.length;for($e&&tt&&(ge=W[++We]);++We<tt;)ge=ue(ge,W[We],We,W);return ge}function Yh(W,ue,ge,$e){var We=W==null?0:W.length;for($e&&We&&(ge=W[--We]);We--;)ge=ue(ge,W[We],We,W);return ge}function uu(W,ue){for(var ge=-1,$e=W==null?0:W.length;++ge<$e;)if(ue(W[ge],ge,W))return!0;return!1}var Wh=Ql("length");function Yd(W){return W.split("")}function Qh(W){return W.match(ls)||[]}function Wl(W,ue,ge){var $e;return ge(W,function(We,tt,Jt){if(ue(We,tt,Jt))return $e=tt,!1}),$e}function Yo(W,ue,ge,$e){for(var We=W.length,tt=ge+($e?1:-1);$e?tt--:++tt<We;)if(ue(W[tt],tt,W))return tt;return-1}function Wi(W,ue,ge){return ue===ue?Zh(W,ue,ge):Yo(W,zi,ge)}function zr(W,ue,ge,$e){for(var We=ge-1,tt=W.length;++We<tt;)if($e(W[We],ue))return We;return-1}function zi(W){return W!==W}function du(W,ue){var ge=W==null?0:W.length;return ge?Kl(W,ue)/ge:A}function Ql(W){return function(ue){return ue==null?t:ue[W]}}function Jl(W){return function(ue){return W==null?t:W[ue]}}function Wo(W,ue,ge,$e,We){return We(W,function(tt,Jt,qt){ge=$e?($e=!1,tt):ue(ge,tt,Jt,qt)}),ge}function Qo(W,ue){var ge=W.length;for(W.sort(ue);ge--;)W[ge]=W[ge].value;return W}function Kl(W,ue){for(var ge,$e=-1,We=W.length;++$e<We;){var tt=ue(W[$e]);tt!==t&&(ge=ge===t?tt:ge+tt)}return ge}function ga(W,ue){for(var ge=-1,$e=Array(W);++ge<W;)$e[ge]=ue(ge);return $e}function Jh(W,ue){return In(ue,function(ge){return[ge,W[ge]]})}function fu(W){return W&&W.slice(0,mu(W)+1).replace(La,"")}function Qi(W){return function(ue){return W(ue)}}function Jo(W,ue){return In(ue,function(ge){return W[ge]})}function tl(W,ue){return W.has(ue)}function nl(W,ue){for(var ge=-1,$e=W.length;++ge<$e&&Wi(ue,W[ge],0)>-1;);return ge}function il(W,ue){for(var ge=W.length;ge--&&Wi(ue,W[ge],0)>-1;);return ge}function Kh(W,ue){for(var ge=W.length,$e=0;ge--;)W[ge]===ue&&++$e;return $e}var ya=Jl(qo),Wd=Jl(Pi);function Ko(W){return"\\"+el[W]}function hu(W,ue){return W==null?t:W[ue]}function qa(W){return Fr.test(W)}function Qd(W){return Uo.test(W)}function Br(W){for(var ue,ge=[];!(ue=W.next()).done;)ge.push(ue.value);return ge}function Xo(W){var ue=-1,ge=Array(W.size);return W.forEach(function($e,We){ge[++ue]=[We,$e]}),ge}function pu(W,ue){return function(ge){return W(ue(ge))}}function Va(W,ue){for(var ge=-1,$e=W.length,We=0,tt=[];++ge<$e;){var Jt=W[ge];(Jt===ue||Jt===h)&&(W[ge]=h,tt[We++]=ge)}return tt}function Zo(W){var ue=-1,ge=Array(W.size);return W.forEach(function($e){ge[++ue]=$e}),ge}function Xh(W){var ue=-1,ge=Array(W.size);return W.forEach(function($e){ge[++ue]=[$e,$e]}),ge}function Zh(W,ue,ge){for(var $e=ge-1,We=W.length;++$e<We;)if(W[$e]===ue)return $e;return-1}function Ji(W,ue,ge){for(var $e=ge+1;$e--;)if(W[$e]===ue)return $e;return $e}function Ur(W){return qa(W)?gu(W):Wh(W)}function or(W){return qa(W)?ec(W):Yd(W)}function mu(W){for(var ue=W.length;ue--&&ss.test(W.charAt(ue)););return ue}var Jd=Jl(Qt);function gu(W){for(var ue=Zs.lastIndex=0;Zs.test(W);)++ue;return ue}function ec(W){return W.match(Zs)||[]}function Kd(W){return W.match(fs)||[]}var he=function W(ue){ue=ue==null?Xn:be.defaults(Xn.Object(),ue,be.pick(Xn,hs));var ge=ue.Array,$e=ue.Date,We=ue.Error,tt=ue.Function,Jt=ue.Math,qt=ue.Object,rl=ue.RegExp,yu=ue.String,di=ue.TypeError,Xd=ge.prototype,Bb=tt.prototype,tc=qt.prototype,xu=ue["__core-js_shared__"],bu=Bb.toString,fn=tc.hasOwnProperty,xa=0,ep=function(){var m=/[^.]+$/.exec(xu&&xu.keys&&xu.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),Ki=tc.toString,qr=bu.call(qt),nc=Xn._,tp=rl("^"+bu.call(fn).replace(Kn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Xl=au?ue.Buffer:t,ba=ue.Symbol,ic=ue.Uint8Array,Zl=Xl?Xl.allocUnsafe:t,vu=pu(qt.getPrototypeOf,qt),wu=qt.create,eo=tc.propertyIsEnumerable,Zd=Xd.splice,cr=ba?ba.isConcatSpreadable:t,to=ba?ba.iterator:t,Xi=ba?ba.toStringTag:t,Su=function(){try{var m=hl(qt,"defineProperty");return m({},"",{}),m}catch{}}(),ef=ue.clearTimeout!==Xn.clearTimeout&&ue.clearTimeout,no=$e&&$e.now!==Xn.Date.now&&$e.now,np=ue.setTimeout!==Xn.setTimeout&&ue.setTimeout,rc=Jt.ceil,ys=Jt.floor,al=qt.getOwnPropertySymbols,tf=Xl?Xl.isBuffer:t,Nu=ue.isFinite,Vr=Xd.join,Hr=pu(qt.keys,qt),$n=Jt.max,qn=Jt.min,xs=$e.now,io=ue.parseInt,ip=Jt.random,rp=Xd.reverse,Cu=hl(ue,"DataView"),mi=hl(ue,"Map"),Vn=hl(ue,"Promise"),Kt=hl(ue,"Set"),va=hl(ue,"WeakMap"),ur=hl(qt,"create"),ac=va&&new va,Gr={},pg=ks(Cu),mg=ks(mi),ju=ks(Vn),_u=ks(Kt),gg=ks(va),sl=ba?ba.prototype:t,ro=sl?sl.valueOf:t,ll=sl?sl.toString:t;function X(m){if(Zn(m)&&!At(m)&&!(m instanceof Vt)){if(m instanceof dr)return m;if(fn.call(m,"__wrapped__"))return yi(m)}return new dr(m)}var Er=function(){function m(){}return function(y){if(!Gn(y))return{};if(wu)return wu(y);m.prototype=y;var _=new m;return m.prototype=t,_}}();function Yr(){}function dr(m,y){this.__wrapped__=m,this.__actions__=[],this.__chain__=!!y,this.__index__=0,this.__values__=t}X.templateSettings={escape:Ni,evaluate:Hi,interpolate:ar,variable:"",imports:{_:X}},X.prototype=Yr.prototype,X.prototype.constructor=X,dr.prototype=Er(Yr.prototype),dr.prototype.constructor=dr;function Vt(m){this.__wrapped__=m,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ae,this.__views__=[]}function ku(){var m=new Vt(this.__wrapped__);return m.__actions__=gi(this.__actions__),m.__dir__=this.__dir__,m.__filtered__=this.__filtered__,m.__iteratees__=gi(this.__iteratees__),m.__takeCount__=this.__takeCount__,m.__views__=gi(this.__views__),m}function nf(){if(this.__filtered__){var m=new Vt(this);m.__dir__=-1,m.__filtered__=!0}else m=this.clone(),m.__dir__*=-1;return m}function ao(){var m=this.__wrapped__.value(),y=this.__dir__,_=At(m),L=y<0,Y=_?m.length:0,oe=Qg(0,Y,this.__views__),me=oe.start,Ne=oe.end,Te=Ne-me,He=L?Ne:me-1,Ye=this.__iteratees__,Ze=Ye.length,ut=0,ht=qn(Te,this.__takeCount__);if(!_||!L&&Y==Te&&ht==Te)return Rg(m,this.__actions__);var kt=[];e:for(;Te--&&ut<ht;){He+=y;for(var Gt=-1,Et=m[He];++Gt<Ze;){var en=Ye[Gt],cn=en.iteratee,ka=en.type,Rr=cn(Et);if(ka==le)Et=Rr;else if(!Rr){if(ka==te)continue e;break e}}kt[ut++]=Et}return kt}Vt.prototype=Er(Yr.prototype),Vt.prototype.constructor=Vt;function ii(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var L=m[y];this.set(L[0],L[1])}}function rf(){this.__data__=ur?ur(null):{},this.size=0}function yg(m){var y=this.has(m)&&delete this.__data__[m];return this.size-=y?1:0,y}function Ub(m){var y=this.__data__;if(ur){var _=y[m];return _===u?t:_}return fn.call(y,m)?y[m]:t}function qb(m){var y=this.__data__;return ur?y[m]!==t:fn.call(y,m)}function Vb(m,y){var _=this.__data__;return this.size+=this.has(m)?0:1,_[m]=ur&&y===t?u:y,this}ii.prototype.clear=rf,ii.prototype.delete=yg,ii.prototype.get=Ub,ii.prototype.has=qb,ii.prototype.set=Vb;function Tn(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var L=m[y];this.set(L[0],L[1])}}function ap(){this.__data__=[],this.size=0}function Eu(m){var y=this.__data__,_=oc(y,m);if(_<0)return!1;var L=y.length-1;return _==L?y.pop():Zd.call(y,_,1),--this.size,!0}function Tu(m){var y=this.__data__,_=oc(y,m);return _<0?t:y[_][1]}function sp(m){return oc(this.__data__,m)>-1}function sc(m,y){var _=this.__data__,L=oc(_,m);return L<0?(++this.size,_.push([m,y])):_[L][1]=y,this}Tn.prototype.clear=ap,Tn.prototype.delete=Eu,Tn.prototype.get=Tu,Tn.prototype.has=sp,Tn.prototype.set=sc;function fr(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var L=m[y];this.set(L[0],L[1])}}function Hb(){this.size=0,this.__data__={hash:new ii,map:new(mi||Tn),string:new ii}}function xg(m){var y=pc(this,m).delete(m);return this.size-=y?1:0,y}function Gb(m){return pc(this,m).get(m)}function bg(m){return pc(this,m).has(m)}function so(m,y){var _=pc(this,m),L=_.size;return _.set(m,y),this.size+=_.size==L?0:1,this}fr.prototype.clear=Hb,fr.prototype.delete=xg,fr.prototype.get=Gb,fr.prototype.has=bg,fr.prototype.set=so;function bs(m){var y=-1,_=m==null?0:m.length;for(this.__data__=new fr;++y<_;)this.add(m[y])}function af(m){return this.__data__.set(m,u),this}function vg(m){return this.__data__.has(m)}bs.prototype.add=bs.prototype.push=af,bs.prototype.has=vg;function Zi(m){var y=this.__data__=new Tn(m);this.size=y.size}function wg(){this.__data__=new Tn,this.size=0}function sf(m){var y=this.__data__,_=y.delete(m);return this.size=y.size,_}function lp(m){return this.__data__.get(m)}function Sg(m){return this.__data__.has(m)}function lf(m,y){var _=this.__data__;if(_ instanceof Tn){var L=_.__data__;if(!mi||L.length<a-1)return L.push([m,y]),this.size=++_.size,this;_=this.__data__=new fr(L)}return _.set(m,y),this.size=_.size,this}Zi.prototype.clear=wg,Zi.prototype.delete=sf,Zi.prototype.get=lp,Zi.prototype.has=Sg,Zi.prototype.set=lf;function op(m,y){var _=At(m),L=!_&&Ds(m),Y=!_&&!L&&Nl(m),oe=!_&&!L&&!Y&&Ec(m),me=_||L||Y||oe,Ne=me?ga(m.length,yu):[],Te=Ne.length;for(var He in m)(y||fn.call(m,He))&&!(me&&(He=="length"||Y&&(He=="offset"||He=="parent")||oe&&(He=="buffer"||He=="byteLength"||He=="byteOffset")||Ca(He,Te)))&&Ne.push(He);return Ne}function lc(m){var y=m.length;return y?m[yf(0,y-1)]:t}function Ng(m,y){return nd(gi(m),Sa(y,0,m.length))}function Cg(m){return nd(gi(m))}function Ha(m,y,_){(_!==t&&!br(m[y],_)||_===t&&!(y in m))&&wa(m,y,_)}function lo(m,y,_){var L=m[y];(!(fn.call(m,y)&&br(L,_))||_===t&&!(y in m))&&wa(m,y,_)}function oc(m,y){for(var _=m.length;_--;)if(br(m[_][0],y))return _;return-1}function ol(m,y,_,L){return ws(m,function(Y,oe,me){y(L,Y,_(Y),me)}),L}function vs(m,y){return m&&mr(y,vi(y),m)}function Au(m,y){return m&&mr(y,_i(y),m)}function wa(m,y,_){y=="__proto__"&&Su?Su(m,y,{configurable:!0,enumerable:!0,value:_,writable:!0}):m[y]=_}function Du(m,y){for(var _=-1,L=y.length,Y=ge(L),oe=m==null;++_<L;)Y[_]=oe?t:gd(m,y[_]);return Y}function Sa(m,y,_){return m===m&&(_!==t&&(m=m<=_?m:_),y!==t&&(m=m>=y?m:y)),m}function Bi(m,y,_,L,Y,oe){var me,Ne=y&g,Te=y&b,He=y&v;if(_&&(me=Y?_(m,L,Y,oe):_(m)),me!==t)return me;if(!Gn(m))return m;var Ye=At(m);if(Ye){if(me=Mp(m),!Ne)return gi(m,me)}else{var Ze=ji(m),ut=Ze==Je||Ze==Le;if(Nl(m))return _p(m,Ne);if(Ze==Ee||Ze==Se||ut&&!Y){if(me=Te||ut?{}:Rp(m),!Ne)return Te?Vu(m,Au(me,m)):Nf(m,vs(me,m))}else{if(!ln[Ze])return Y?m:{};me=Lp(m,Ze,Ne)}}oe||(oe=new Zi);var ht=oe.get(m);if(ht)return ht;oe.set(m,me),By(m)?m.forEach(function(Et){me.add(Bi(Et,y,_,Et,m,oe))}):Wf(m)&&m.forEach(function(Et,en){me.set(en,Bi(Et,y,_,en,m,oe))});var kt=He?Te?kf:_f:Te?_i:vi,Gt=Ye?t:kt(m);return $i(Gt||m,function(Et,en){Gt&&(en=Et,Et=m[en]),lo(me,en,Bi(Et,y,_,en,m,oe))}),me}function jg(m){var y=vi(m);return function(_){return cp(_,m,y)}}function cp(m,y,_){var L=_.length;if(m==null)return!L;for(m=qt(m);L--;){var Y=_[L],oe=y[Y],me=m[Y];if(me===t&&!(Y in m)||!oe(me))return!1}return!0}function oo(m,y,_){if(typeof m!="function")throw new di(o);return gc(function(){m.apply(t,_)},y)}function cl(m,y,_,L){var Y=-1,oe=Go,me=!0,Ne=m.length,Te=[],He=y.length;if(!Ne)return Te;_&&(y=In(y,Qi(_))),L?(oe=ou,me=!1):y.length>=a&&(oe=tl,me=!1,y=new bs(y));e:for(;++Y<Ne;){var Ye=m[Y],Ze=_==null?Ye:_(Ye);if(Ye=L||Ye!==0?Ye:0,me&&Ze===Ze){for(var ut=He;ut--;)if(y[ut]===Ze)continue e;Te.push(Ye)}else oe(y,Ze,L)||Te.push(Ye)}return Te}var ws=Ap(Ui),of=Ap(uc,!0);function up(m,y){var _=!0;return ws(m,function(L,Y,oe){return _=!!y(L,Y,oe),_}),_}function Na(m,y,_){for(var L=-1,Y=m.length;++L<Y;){var oe=m[L],me=y(oe);if(me!=null&&(Ne===t?me===me&&!nr(me):_(me,Ne)))var Ne=me,Te=oe}return Te}function $t(m,y,_,L){var Y=m.length;for(_=Rt(_),_<0&&(_=-_>Y?0:Y+_),L=L===t||L>Y?Y:Rt(L),L<0&&(L+=Y),L=_>L?0:es(L);_<L;)m[_++]=y;return m}function xn(m,y){var _=[];return ws(m,function(L,Y,oe){y(L,Y,oe)&&_.push(L)}),_}function Xt(m,y,_,L,Y){var oe=-1,me=m.length;for(_||(_=js),Y||(Y=[]);++oe<me;){var Ne=m[oe];y>0&&_(Ne)?y>1?Xt(Ne,y-1,_,L,Y):ma(Y,Ne):L||(Y[Y.length]=Ne)}return Y}var cc=go(),co=go(!0);function Ui(m,y){return m&&cc(m,y,vi)}function uc(m,y){return m&&co(m,y,vi)}function ul(m,y){return $r(y,function(_){return ja(m[_])})}function Wr(m,y){y=Ns(y,m);for(var _=0,L=y.length;m!=null&&_<L;)m=m[yn(y[_++])];return _&&_==L?m:t}function _g(m,y,_){var L=y(m);return At(m)?L:ma(L,_(m))}function Zt(m){return m==null?m===t?an:ve:Xi&&Xi in qt(m)?Wg(m):ey(m)}function Pu(m,y){return m>y}function dp(m,y){return m!=null&&fn.call(m,y)}function kg(m,y){return m!=null&&y in qt(m)}function Eg(m,y,_){return m>=qn(y,_)&&m<$n(y,_)}function fp(m,y,_){for(var L=_?ou:Go,Y=m[0].length,oe=m.length,me=oe,Ne=ge(oe),Te=1/0,He=[];me--;){var Ye=m[me];me&&y&&(Ye=In(Ye,Qi(y))),Te=qn(Ye.length,Te),Ne[me]=!_&&(y||Y>=120&&Ye.length>=120)?new bs(me&&Ye):t}Ye=m[0];var Ze=-1,ut=Ne[0];e:for(;++Ze<Y&&He.length<Te;){var ht=Ye[Ze],kt=y?y(ht):ht;if(ht=_||ht!==0?ht:0,!(ut?tl(ut,kt):L(He,kt,_))){for(me=oe;--me;){var Gt=Ne[me];if(!(Gt?tl(Gt,kt):L(m[me],kt,_)))continue e}ut&&ut.push(kt),He.push(ht)}}return He}function hp(m,y,_,L){return Ui(m,function(Y,oe,me){y(L,_(Y),oe,me)}),L}function uo(m,y,_){y=Ns(y,m),m=mc(m,y);var L=m==null?m:m[yn(qi(y))];return L==null?t:ui(L,m,_)}function cf(m){return Zn(m)&&Zt(m)==Se}function hr(m){return Zn(m)&&Zt(m)==ie}function fi(m){return Zn(m)&&Zt(m)==_e}function fo(m,y,_,L,Y){return m===y?!0:m==null||y==null||!Zn(m)&&!Zn(y)?m!==m&&y!==y:Iu(m,y,_,L,fo,Y)}function Iu(m,y,_,L,Y,oe){var me=At(m),Ne=At(y),Te=me?fe:ji(m),He=Ne?fe:ji(y);Te=Te==Se?Ee:Te,He=He==Se?Ee:He;var Ye=Te==Ee,Ze=He==Ee,ut=Te==He;if(ut&&Nl(m)){if(!Nl(y))return!1;me=!0,Ye=!1}if(ut&&!Ye)return oe||(oe=new Zi),me||Ec(m)?Gg(m,y,_,L,Y,oe):Yg(m,y,Te,_,L,Y,oe);if(!(_&N)){var ht=Ye&&fn.call(m,"__wrapped__"),kt=Ze&&fn.call(y,"__wrapped__");if(ht||kt){var Gt=ht?m.value():m,Et=kt?y.value():y;return oe||(oe=new Zi),Y(Gt,Et,_,L,oe)}}return ut?(oe||(oe=new Zi),Ci(m,y,_,L,Y,oe)):!1}function uf(m){return Zn(m)&&ji(m)==xe}function Mu(m,y,_,L){var Y=_.length,oe=Y,me=!L;if(m==null)return!oe;for(m=qt(m);Y--;){var Ne=_[Y];if(me&&Ne[2]?Ne[1]!==m[Ne[0]]:!(Ne[0]in m))return!1}for(;++Y<oe;){Ne=_[Y];var Te=Ne[0],He=m[Te],Ye=Ne[1];if(me&&Ne[2]){if(He===t&&!(Te in m))return!1}else{var Ze=new Zi;if(L)var ut=L(He,Ye,Te,m,y,Ze);if(!(ut===t?fo(Ye,He,N|k,L,Ze):ut))return!1}}return!0}function Ga(m){if(!Gn(m)||If(m))return!1;var y=ja(m)?tp:Ud;return y.test(ks(m))}function df(m){return Zn(m)&&Zt(m)==lt}function pp(m){return Zn(m)&&ji(m)==Xe}function mp(m){return Zn(m)&&wo(m.length)&&!!gn[Zt(m)]}function gp(m){return typeof m=="function"?m:m==null?Re:typeof m=="object"?At(m)?pf(m[0],m[1]):xp(m):on(m)}function ff(m){if(!An(m))return Hr(m);var y=[];for(var _ in qt(m))fn.call(m,_)&&_!="constructor"&&y.push(_);return y}function Tg(m){if(!Gn(m))return pl(m);var y=An(m),_=[];for(var L in m)L=="constructor"&&(y||!fn.call(m,L))||_.push(L);return _}function hf(m,y){return m<y}function yp(m,y){var _=-1,L=xi(m)?ge(m.length):[];return ws(m,function(Y,oe,me){L[++_]=y(Y,oe,me)}),L}function xp(m){var y=Tf(m);return y.length==1&&y[0][2]?Xg(y[0][0],y[0][1]):function(_){return _===m||Mu(_,m,y)}}function pf(m,y){return Df(m)&&Kg(y)?Xg(yn(m),y):function(_){var L=gd(_,m);return L===t&&L===y?Pc(_,m):fo(y,L,N|k)}}function Ru(m,y,_,L,Y){m!==y&&cc(y,function(oe,me){if(Y||(Y=new Zi),Gn(oe))Yb(m,y,me,_,Ru,L,Y);else{var Ne=L?L(Mf(m,me),oe,me+"",m,y,Y):t;Ne===t&&(Ne=oe),Ha(m,me,Ne)}},_i)}function Yb(m,y,_,L,Y,oe,me){var Ne=Mf(m,_),Te=Mf(y,_),He=me.get(Te);if(He){Ha(m,_,He);return}var Ye=oe?oe(Ne,Te,_+"",m,y,me):t,Ze=Ye===t;if(Ze){var ut=At(Te),ht=!ut&&Nl(Te),kt=!ut&&!ht&&Ec(Te);Ye=Te,ut||ht||kt?At(Ne)?Ye=Ne:si(Ne)?Ye=gi(Ne):ht?(Ze=!1,Ye=_p(Te,!0)):kt?(Ze=!1,Ye=Ep(Te,!0)):Ye=[]:Xr(Te)||Ds(Te)?(Ye=Ne,Ds(Ne)?Ye=Vy(Ne):(!Gn(Ne)||ja(Ne))&&(Ye=Rp(Te))):Ze=!1}Ze&&(me.set(Te,Ye),Y(Ye,Te,L,oe,me),me.delete(Te)),Ha(m,_,Ye)}function bp(m,y){var _=m.length;if(_)return y+=y<0?_:0,Ca(y,_)?m[y]:t}function vp(m,y,_){y.length?y=In(y,function(oe){return At(oe)?function(me){return Wr(me,oe.length===1?oe[0]:oe)}:oe}):y=[Re];var L=-1;y=In(y,Qi(xt()));var Y=yp(m,function(oe,me,Ne){var Te=In(y,function(He){return He(oe)});return{criteria:Te,index:++L,value:oe}});return Qo(Y,function(oe,me){return $g(oe,me,_)})}function Ag(m,y){return mf(m,y,function(_,L){return Pc(m,L)})}function mf(m,y,_){for(var L=-1,Y=y.length,oe={};++L<Y;){var me=y[L],Ne=Wr(m,me);_(Ne,me)&&fc(oe,Ns(me,m),Ne)}return oe}function Dg(m){return function(y){return Wr(y,m)}}function gf(m,y,_,L){var Y=L?zr:Wi,oe=-1,me=y.length,Ne=m;for(m===y&&(y=gi(y)),_&&(Ne=In(m,Qi(_)));++oe<me;)for(var Te=0,He=y[oe],Ye=_?_(He):He;(Te=Y(Ne,Ye,Te,L))>-1;)Ne!==m&&Zd.call(Ne,Te,1),Zd.call(m,Te,1);return m}function wp(m,y){for(var _=m?y.length:0,L=_-1;_--;){var Y=y[_];if(_==L||Y!==oe){var oe=Y;Ca(Y)?Zd.call(m,Y,1):$u(m,Y)}}return m}function yf(m,y){return m+ys(ip()*(y-m+1))}function Pg(m,y,_,L){for(var Y=-1,oe=$n(rc((y-m)/(_||1)),0),me=ge(oe);oe--;)me[L?oe:++Y]=m,m+=_;return me}function Sp(m,y){var _="";if(!m||y<1||y>J)return _;do y%2&&(_+=m),y=ys(y/2),y&&(m+=m);while(y);return _}function Ot(m,y){return ed(Op(m,y,Re),m+"")}function dc(m){return lc(Mc(m))}function xf(m,y){var _=Mc(m);return nd(_,Sa(y,0,_.length))}function fc(m,y,_,L){if(!Gn(m))return m;y=Ns(y,m);for(var Y=-1,oe=y.length,me=oe-1,Ne=m;Ne!=null&&++Y<oe;){var Te=yn(y[Y]),He=_;if(Te==="__proto__"||Te==="constructor"||Te==="prototype")return m;if(Y!=me){var Ye=Ne[Te];He=L?L(Ye,Te,Ne):t,He===t&&(He=Gn(Ye)?Ye:Ca(y[Y+1])?[]:{})}lo(Ne,Te,He),Ne=Ne[Te]}return m}var Lu=ac?function(m,y){return ac.set(m,y),m}:Re,Ou=Su?function(m,y){return Su(m,"toString",{configurable:!0,enumerable:!1,value:Ie(y),writable:!0})}:Re;function Ig(m){return nd(Mc(m))}function Tr(m,y,_){var L=-1,Y=m.length;y<0&&(y=-y>Y?0:Y+y),_=_>Y?Y:_,_<0&&(_+=Y),Y=y>_?0:_-y>>>0,y>>>=0;for(var oe=ge(Y);++L<Y;)oe[L]=m[L+y];return oe}function Mg(m,y){var _;return ws(m,function(L,Y,oe){return _=y(L,Y,oe),!_}),!!_}function Fu(m,y,_){var L=0,Y=m==null?L:m.length;if(typeof y=="number"&&y===y&&Y<=M){for(;L<Y;){var oe=L+Y>>>1,me=m[oe];me!==null&&!nr(me)&&(_?me<=y:me<y)?L=oe+1:Y=oe}return Y}return bf(m,y,Re,_)}function bf(m,y,_,L){var Y=0,oe=m==null?0:m.length;if(oe===0)return 0;y=_(y);for(var me=y!==y,Ne=y===null,Te=nr(y),He=y===t;Y<oe;){var Ye=ys((Y+oe)/2),Ze=_(m[Ye]),ut=Ze!==t,ht=Ze===null,kt=Ze===Ze,Gt=nr(Ze);if(me)var Et=L||kt;else He?Et=kt&&(L||ut):Ne?Et=kt&&ut&&(L||!ht):Te?Et=kt&&ut&&!ht&&(L||!Gt):ht||Gt?Et=!1:Et=L?Ze<=y:Ze<y;Et?Y=Ye+1:oe=Ye}return qn(oe,ce)}function Np(m,y){for(var _=-1,L=m.length,Y=0,oe=[];++_<L;){var me=m[_],Ne=y?y(me):me;if(!_||!br(Ne,Te)){var Te=Ne;oe[Y++]=me===0?0:me}}return oe}function vf(m){return typeof m=="number"?m:nr(m)?A:+m}function pr(m){if(typeof m=="string")return m;if(At(m))return In(m,pr)+"";if(nr(m))return ll?ll.call(m):"";var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function Ss(m,y,_){var L=-1,Y=Go,oe=m.length,me=!0,Ne=[],Te=Ne;if(_)me=!1,Y=ou;else if(oe>=a){var He=y?null:Vg(m);if(He)return Zo(He);me=!1,Y=tl,Te=new bs}else Te=y?[]:Ne;e:for(;++L<oe;){var Ye=m[L],Ze=y?y(Ye):Ye;if(Ye=_||Ye!==0?Ye:0,me&&Ze===Ze){for(var ut=Te.length;ut--;)if(Te[ut]===Ze)continue e;y&&Te.push(Ze),Ne.push(Ye)}else Y(Te,Ze,_)||(Te!==Ne&&Te.push(Ze),Ne.push(Ye))}return Ne}function $u(m,y){return y=Ns(y,m),m=mc(m,y),m==null||delete m[yn(qi(y))]}function Cp(m,y,_,L){return fc(m,y,_(Wr(m,y)),L)}function zu(m,y,_,L){for(var Y=m.length,oe=L?Y:-1;(L?oe--:++oe<Y)&&y(m[oe],oe,m););return _?Tr(m,L?0:oe,L?oe+1:Y):Tr(m,L?oe+1:0,L?Y:oe)}function Rg(m,y){var _=m;return _ instanceof Vt&&(_=_.value()),cu(y,function(L,Y){return Y.func.apply(Y.thisArg,ma([L],Y.args))},_)}function Bu(m,y,_){var L=m.length;if(L<2)return L?Ss(m[0]):[];for(var Y=-1,oe=ge(L);++Y<L;)for(var me=m[Y],Ne=-1;++Ne<L;)Ne!=Y&&(oe[Y]=cl(oe[Y]||me,m[Ne],y,_));return Ss(Xt(oe,1),y,_)}function jp(m,y,_){for(var L=-1,Y=m.length,oe=y.length,me={};++L<Y;){var Ne=L<oe?y[L]:t;_(me,m[L],Ne)}return me}function wf(m){return si(m)?m:[]}function Uu(m){return typeof m=="function"?m:Re}function Ns(m,y){return At(m)?m:Df(m,y)?[m]:Ja(hn(m))}var Lg=Ot;function dl(m,y,_){var L=m.length;return _=_===t?L:_,!y&&_>=L?m:Tr(m,y,_)}var Og=ef||function(m){return Xn.clearTimeout(m)};function _p(m,y){if(y)return m.slice();var _=m.length,L=Zl?Zl(_):new m.constructor(_);return m.copy(L),L}function ho(m){var y=new m.constructor(m.byteLength);return new ic(y).set(new ic(m)),y}function kp(m,y){var _=y?ho(m.buffer):m.buffer;return new m.constructor(_,m.byteOffset,m.byteLength)}function Sf(m){var y=new m.constructor(m.source,Oa.exec(m));return y.lastIndex=m.lastIndex,y}function Fg(m){return ro?qt(ro.call(m)):{}}function Ep(m,y){var _=y?ho(m.buffer):m.buffer;return new m.constructor(_,m.byteOffset,m.length)}function qu(m,y){if(m!==y){var _=m!==t,L=m===null,Y=m===m,oe=nr(m),me=y!==t,Ne=y===null,Te=y===y,He=nr(y);if(!Ne&&!He&&!oe&&m>y||oe&&me&&Te&&!Ne&&!He||L&&me&&Te||!_&&Te||!Y)return 1;if(!L&&!oe&&!He&&m<y||He&&_&&Y&&!L&&!oe||Ne&&_&&Y||!me&&Y||!Te)return-1}return 0}function $g(m,y,_){for(var L=-1,Y=m.criteria,oe=y.criteria,me=Y.length,Ne=_.length;++L<me;){var Te=qu(Y[L],oe[L]);if(Te){if(L>=Ne)return Te;var He=_[L];return Te*(He=="desc"?-1:1)}}return m.index-y.index}function Tp(m,y,_,L){for(var Y=-1,oe=m.length,me=_.length,Ne=-1,Te=y.length,He=$n(oe-me,0),Ye=ge(Te+He),Ze=!L;++Ne<Te;)Ye[Ne]=y[Ne];for(;++Y<me;)(Ze||Y<oe)&&(Ye[_[Y]]=m[Y]);for(;He--;)Ye[Ne++]=m[Y++];return Ye}function zg(m,y,_,L){for(var Y=-1,oe=m.length,me=-1,Ne=_.length,Te=-1,He=y.length,Ye=$n(oe-Ne,0),Ze=ge(Ye+He),ut=!L;++Y<Ye;)Ze[Y]=m[Y];for(var ht=Y;++Te<He;)Ze[ht+Te]=y[Te];for(;++me<Ne;)(ut||Y<oe)&&(Ze[ht+_[me]]=m[Y++]);return Ze}function gi(m,y){var _=-1,L=m.length;for(y||(y=ge(L));++_<L;)y[_]=m[_];return y}function mr(m,y,_,L){var Y=!_;_||(_={});for(var oe=-1,me=y.length;++oe<me;){var Ne=y[oe],Te=L?L(_[Ne],m[Ne],Ne,_,m):t;Te===t&&(Te=m[Ne]),Y?wa(_,Ne,Te):lo(_,Ne,Te)}return _}function Nf(m,y){return mr(m,Ju(m),y)}function Vu(m,y){return mr(m,Af(m),y)}function po(m,y){return function(_,L){var Y=At(_)?Ho:ol,oe=y?y():{};return Y(_,m,xt(L,2),oe)}}function mo(m){return Ot(function(y,_){var L=-1,Y=_.length,oe=Y>1?_[Y-1]:t,me=Y>2?_[2]:t;for(oe=m.length>3&&typeof oe=="function"?(Y--,oe):t,me&&tr(_[0],_[1],me)&&(oe=Y<3?t:oe,Y=1),y=qt(y);++L<Y;){var Ne=_[L];Ne&&m(y,Ne,L,oe)}return y})}function Ap(m,y){return function(_,L){if(_==null)return _;if(!xi(_))return m(_,L);for(var Y=_.length,oe=y?Y:-1,me=qt(_);(y?oe--:++oe<Y)&&L(me[oe],oe,me)!==!1;);return _}}function go(m){return function(y,_,L){for(var Y=-1,oe=qt(y),me=L(y),Ne=me.length;Ne--;){var Te=me[m?Ne:++Y];if(_(oe[Te],Te,oe)===!1)break}return y}}function Bg(m,y,_){var L=y&T,Y=Qr(m);function oe(){var me=this&&this!==Xn&&this instanceof oe?Y:m;return me.apply(L?_:this,arguments)}return oe}function Ar(m){return function(y){y=hn(y);var _=qa(y)?or(y):t,L=_?_[0]:y.charAt(0),Y=_?dl(_,1).join(""):y.slice(1);return L[m]()+Y}}function er(m){return function(y){return cu(S(Ps(y).replace(Hl,"")),m,"")}}function Qr(m){return function(){var y=arguments;switch(y.length){case 0:return new m;case 1:return new m(y[0]);case 2:return new m(y[0],y[1]);case 3:return new m(y[0],y[1],y[2]);case 4:return new m(y[0],y[1],y[2],y[3]);case 5:return new m(y[0],y[1],y[2],y[3],y[4]);case 6:return new m(y[0],y[1],y[2],y[3],y[4],y[5]);case 7:return new m(y[0],y[1],y[2],y[3],y[4],y[5],y[6])}var _=Er(m.prototype),L=m.apply(_,y);return Gn(L)?L:_}}function Ug(m,y,_){var L=Qr(m);function Y(){for(var oe=arguments.length,me=ge(oe),Ne=oe,Te=xo(Y);Ne--;)me[Ne]=arguments[Ne];var He=oe<3&&me[0]!==Te&&me[oe-1]!==Te?[]:Va(me,Te);if(oe-=He.length,oe<_)return Dp(m,y,ri,Y.placeholder,t,me,He,t,t,_-oe);var Ye=this&&this!==Xn&&this instanceof Y?L:m;return ui(Ye,this,me)}return Y}function Cs(m){return function(y,_,L){var Y=qt(y);if(!xi(y)){var oe=xt(_,3);y=vi(y),_=function(Ne){return oe(Y[Ne],Ne,Y)}}var me=m(y,_,L);return me>-1?Y[oe?y[me]:me]:t}}function Ya(m){return zn(function(y){var _=y.length,L=_,Y=dr.prototype.thru;for(m&&y.reverse();L--;){var oe=y[L];if(typeof oe!="function")throw new di(o);if(Y&&!me&&Qu(oe)=="wrapper")var me=new dr([],!0)}for(L=me?L:_;++L<_;){oe=y[L];var Ne=Qu(oe),Te=Ne=="wrapper"?Ef(oe):t;Te&&Pf(Te[0])&&Te[1]==(B|P|F|z)&&!Te[4].length&&Te[9]==1?me=me[Qu(Te[0])].apply(me,Te[3]):me=oe.length==1&&Pf(oe)?me[Ne]():me.thru(oe)}return function(){var He=arguments,Ye=He[0];if(me&&He.length==1&&At(Ye))return me.plant(Ye).value();for(var Ze=0,ut=_?y[Ze].apply(this,He):Ye;++Ze<_;)ut=y[Ze].call(this,ut);return ut}})}function ri(m,y,_,L,Y,oe,me,Ne,Te,He){var Ye=y&B,Ze=y&T,ut=y&E,ht=y&(P|V),kt=y&q,Gt=ut?t:Qr(m);function Et(){for(var en=arguments.length,cn=ge(en),ka=en;ka--;)cn[ka]=arguments[ka];if(ht)var Rr=xo(Et),Ea=Kh(cn,Rr);if(L&&(cn=Tp(cn,L,Y,ht)),oe&&(cn=zg(cn,oe,me,ht)),en-=Ea,ht&&en<He){var wi=Va(cn,Rr);return Dp(m,y,ri,Et.placeholder,_,cn,wi,Ne,Te,He-en)}var Is=Ze?_:this,So=ut?Is[m]:m;return en=cn.length,Ne?cn=Qa(cn,Ne):kt&&en>1&&cn.reverse(),Ye&&Te<en&&(cn.length=Te),this&&this!==Xn&&this instanceof Et&&(So=Gt||Qr(So)),So.apply(Is,cn)}return Et}function Hu(m,y){return function(_,L){return hp(_,m,y(L),{})}}function hc(m,y){return function(_,L){var Y;if(_===t&&L===t)return y;if(_!==t&&(Y=_),L!==t){if(Y===t)return L;typeof _=="string"||typeof L=="string"?(_=pr(_),L=pr(L)):(_=vf(_),L=vf(L)),Y=m(_,L)}return Y}}function Gu(m){return zn(function(y){return y=In(y,Qi(xt())),Ot(function(_){var L=this;return m(y,function(Y){return ui(Y,L,_)})})})}function Yu(m,y){y=y===t?" ":pr(y);var _=y.length;if(_<2)return _?Sp(y,m):y;var L=Sp(y,rc(m/Ur(y)));return qa(y)?dl(or(L),0,m).join(""):L.slice(0,m)}function qg(m,y,_,L){var Y=y&T,oe=Qr(m);function me(){for(var Ne=-1,Te=arguments.length,He=-1,Ye=L.length,Ze=ge(Ye+Te),ut=this&&this!==Xn&&this instanceof me?oe:m;++He<Ye;)Ze[He]=L[He];for(;Te--;)Ze[He++]=arguments[++Ne];return ui(ut,Y?_:this,Ze)}return me}function fl(m){return function(y,_,L){return L&&typeof L!="number"&&tr(y,_,L)&&(_=L=t),y=Za(y),_===t?(_=y,y=0):_=Za(_),L=L===t?y<_?1:-1:Za(L),Pg(y,_,L,m)}}function yo(m){return function(y,_){return typeof y=="string"&&typeof _=="string"||(y=Zr(y),_=Zr(_)),m(y,_)}}function Dp(m,y,_,L,Y,oe,me,Ne,Te,He){var Ye=y&P,Ze=Ye?me:t,ut=Ye?t:me,ht=Ye?oe:t,kt=Ye?t:oe;y|=Ye?F:$,y&=~(Ye?$:F),y&I||(y&=-4);var Gt=[m,y,Y,ht,Ze,kt,ut,Ne,Te,He],Et=_.apply(t,Gt);return Pf(m)&&Rf(Et,Gt),Et.placeholder=L,Lf(Et,m,y)}function Cf(m){var y=Jt[m];return function(_,L){if(_=Zr(_),L=L==null?0:qn(Rt(L),292),L&&Nu(_)){var Y=(hn(_)+"e").split("e"),oe=y(Y[0]+"e"+(+Y[1]+L));return Y=(hn(oe)+"e").split("e"),+(Y[0]+"e"+(+Y[1]-L))}return y(_)}}var Vg=Kt&&1/Zo(new Kt([,-0]))[1]==U?function(m){return new Kt(m)}:ft;function Wu(m){return function(y){var _=ji(y);return _==xe?Xo(y):_==Xe?Xh(y):Jh(y,m(y))}}function Wa(m,y,_,L,Y,oe,me,Ne){var Te=y&E;if(!Te&&typeof m!="function")throw new di(o);var He=L?L.length:0;if(He||(y&=-97,L=Y=t),me=me===t?me:$n(Rt(me),0),Ne=Ne===t?Ne:Rt(Ne),He-=Y?Y.length:0,y&$){var Ye=L,Ze=Y;L=Y=t}var ut=Te?t:Ef(m),ht=[m,y,_,L,Y,Ye,Ze,oe,me,Ne];if(ut&&Zu(ht,ut),m=ht[0],y=ht[1],_=ht[2],L=ht[3],Y=ht[4],Ne=ht[9]=ht[9]===t?Te?0:m.length:$n(ht[9]-He,0),!Ne&&y&(P|V)&&(y&=-25),!y||y==T)var kt=Bg(m,y,_);else y==P||y==V?kt=Ug(m,y,Ne):(y==F||y==(T|F))&&!Y.length?kt=qg(m,y,_,L):kt=ri.apply(t,ht);var Gt=ut?Lu:Rf;return Lf(Gt(kt,ht),m,y)}function jf(m,y,_,L){return m===t||br(m,tc[_])&&!fn.call(L,_)?y:m}function Pp(m,y,_,L,Y,oe){return Gn(m)&&Gn(y)&&(oe.set(y,m),Ru(m,y,t,Pp,oe),oe.delete(y)),m}function Hg(m){return Xr(m)?t:m}function Gg(m,y,_,L,Y,oe){var me=_&N,Ne=m.length,Te=y.length;if(Ne!=Te&&!(me&&Te>Ne))return!1;var He=oe.get(m),Ye=oe.get(y);if(He&&Ye)return He==y&&Ye==m;var Ze=-1,ut=!0,ht=_&k?new bs:t;for(oe.set(m,y),oe.set(y,m);++Ze<Ne;){var kt=m[Ze],Gt=y[Ze];if(L)var Et=me?L(Gt,kt,Ze,y,m,oe):L(kt,Gt,Ze,m,y,oe);if(Et!==t){if(Et)continue;ut=!1;break}if(ht){if(!uu(y,function(en,cn){if(!tl(ht,cn)&&(kt===en||Y(kt,en,_,L,oe)))return ht.push(cn)})){ut=!1;break}}else if(!(kt===Gt||Y(kt,Gt,_,L,oe))){ut=!1;break}}return oe.delete(m),oe.delete(y),ut}function Yg(m,y,_,L,Y,oe,me){switch(_){case je:if(m.byteLength!=y.byteLength||m.byteOffset!=y.byteOffset)return!1;m=m.buffer,y=y.buffer;case ie:return!(m.byteLength!=y.byteLength||!oe(new ic(m),new ic(y)));case re:case _e:case Me:return br(+m,+y);case et:return m.name==y.name&&m.message==y.message;case lt:case Mt:return m==y+"";case xe:var Ne=Xo;case Xe:var Te=L&N;if(Ne||(Ne=Zo),m.size!=y.size&&!Te)return!1;var He=me.get(m);if(He)return He==y;L|=k,me.set(m,y);var Ye=Gg(Ne(m),Ne(y),L,Y,oe,me);return me.delete(m),Ye;case _t:if(ro)return ro.call(m)==ro.call(y)}return!1}function Ci(m,y,_,L,Y,oe){var me=_&N,Ne=_f(m),Te=Ne.length,He=_f(y),Ye=He.length;if(Te!=Ye&&!me)return!1;for(var Ze=Te;Ze--;){var ut=Ne[Ze];if(!(me?ut in y:fn.call(y,ut)))return!1}var ht=oe.get(m),kt=oe.get(y);if(ht&&kt)return ht==y&&kt==m;var Gt=!0;oe.set(m,y),oe.set(y,m);for(var Et=me;++Ze<Te;){ut=Ne[Ze];var en=m[ut],cn=y[ut];if(L)var ka=me?L(cn,en,ut,y,m,oe):L(en,cn,ut,m,y,oe);if(!(ka===t?en===cn||Y(en,cn,_,L,oe):ka)){Gt=!1;break}Et||(Et=ut=="constructor")}if(Gt&&!Et){var Rr=m.constructor,Ea=y.constructor;Rr!=Ea&&"constructor"in m&&"constructor"in y&&!(typeof Rr=="function"&&Rr instanceof Rr&&typeof Ea=="function"&&Ea instanceof Ea)&&(Gt=!1)}return oe.delete(m),oe.delete(y),Gt}function zn(m){return ed(Op(m,t,yr),m+"")}function _f(m){return _g(m,vi,Ju)}function kf(m){return _g(m,_i,Af)}var Ef=ac?function(m){return ac.get(m)}:ft;function Qu(m){for(var y=m.name+"",_=Gr[y],L=fn.call(Gr,y)?_.length:0;L--;){var Y=_[L],oe=Y.func;if(oe==null||oe==m)return Y.name}return y}function xo(m){var y=fn.call(X,"placeholder")?X:m;return y.placeholder}function xt(){var m=X.iteratee||St;return m=m===St?gp:m,arguments.length?m(arguments[0],arguments[1]):m}function pc(m,y){var _=m.__data__;return _s(y)?_[typeof y=="string"?"string":"hash"]:_.map}function Tf(m){for(var y=vi(m),_=y.length;_--;){var L=y[_],Y=m[L];y[_]=[L,Y,Kg(Y)]}return y}function hl(m,y){var _=hu(m,y);return Ga(_)?_:t}function Wg(m){var y=fn.call(m,Xi),_=m[Xi];try{m[Xi]=t;var L=!0}catch{}var Y=Ki.call(m);return L&&(y?m[Xi]=_:delete m[Xi]),Y}var Ju=al?function(m){return m==null?[]:(m=qt(m),$r(al(m),function(y){return eo.call(m,y)}))}:A0,Af=al?function(m){for(var y=[];m;)ma(y,Ju(m)),m=vu(m);return y}:A0,ji=Zt;(Cu&&ji(new Cu(new ArrayBuffer(1)))!=je||mi&&ji(new mi)!=xe||Vn&&ji(Vn.resolve())!=De||Kt&&ji(new Kt)!=Xe||va&&ji(new va)!=se)&&(ji=function(m){var y=Zt(m),_=y==Ee?m.constructor:t,L=_?ks(_):"";if(L)switch(L){case pg:return je;case mg:return xe;case ju:return De;case _u:return Xe;case gg:return se}return y});function Qg(m,y,_){for(var L=-1,Y=_.length;++L<Y;){var oe=_[L],me=oe.size;switch(oe.type){case"drop":m+=me;break;case"dropRight":y-=me;break;case"take":y=qn(y,m+me);break;case"takeRight":m=$n(m,y-me);break}}return{start:m,end:y}}function Ip(m){var y=m.match(Hh);return y?y[1].split(Bd):[]}function Ku(m,y,_){y=Ns(y,m);for(var L=-1,Y=y.length,oe=!1;++L<Y;){var me=yn(y[L]);if(!(oe=m!=null&&_(m,me)))break;m=m[me]}return oe||++L!=Y?oe:(Y=m==null?0:m.length,!!Y&&wo(Y)&&Ca(me,Y)&&(At(m)||Ds(m)))}function Mp(m){var y=m.length,_=new m.constructor(y);return y&&typeof m[0]=="string"&&fn.call(m,"index")&&(_.index=m.index,_.input=m.input),_}function Rp(m){return typeof m.constructor=="function"&&!An(m)?Er(vu(m)):{}}function Lp(m,y,_){var L=m.constructor;switch(y){case ie:return ho(m);case re:case _e:return new L(+m);case je:return kp(m,_);case Ae:case Be:case st:case pt:case dt:case ze:case Ke:case Fe:case at:return Ep(m,_);case xe:return new L;case Me:case Mt:return new L(m);case lt:return Sf(m);case Xe:return new L;case _t:return Fg(m)}}function Jg(m,y){var _=y.length;if(!_)return m;var L=_-1;return y[L]=(_>1?"& ":"")+y[L],y=y.join(_>2?", ":" "),m.replace(Vh,`{
/* [wrapped with `+y+`] */
`)}function js(m){return At(m)||Ds(m)||!!(cr&&m&&m[cr])}function Ca(m,y){var _=typeof m;return y=y??J,!!y&&(_=="number"||_!="symbol"&&os.test(m))&&m>-1&&m%1==0&&m<y}function tr(m,y,_){if(!Gn(_))return!1;var L=typeof y;return(L=="number"?xi(_)&&Ca(y,_.length):L=="string"&&y in _)?br(_[y],m):!1}function Df(m,y){if(At(m))return!1;var _=typeof m;return _=="number"||_=="symbol"||_=="boolean"||m==null||nr(m)?!0:kr.test(m)||!oa.test(m)||y!=null&&m in qt(y)}function _s(m){var y=typeof m;return y=="string"||y=="number"||y=="symbol"||y=="boolean"?m!=="__proto__":m===null}function Pf(m){var y=Qu(m),_=X[y];if(typeof _!="function"||!(y in Vt.prototype))return!1;if(m===_)return!0;var L=Ef(_);return!!L&&m===L[0]}function If(m){return!!ep&&ep in m}var Xu=xu?ja:D0;function An(m){var y=m&&m.constructor,_=typeof y=="function"&&y.prototype||tc;return m===_}function Kg(m){return m===m&&!Gn(m)}function Xg(m,y){return function(_){return _==null?!1:_[m]===y&&(y!==t||m in qt(_))}}function Zg(m){var y=ud(m,function(L){return _.size===d&&_.clear(),L}),_=y.cache;return y}function Zu(m,y){var _=m[1],L=y[1],Y=_|L,oe=Y<(T|E|B),me=L==B&&_==P||L==B&&_==z&&m[7].length<=y[8]||L==(B|z)&&y[7].length<=y[8]&&_==P;if(!(oe||me))return m;L&T&&(m[2]=y[2],Y|=_&T?0:I);var Ne=y[3];if(Ne){var Te=m[3];m[3]=Te?Tp(Te,Ne,y[4]):Ne,m[4]=Te?Va(m[3],h):y[4]}return Ne=y[5],Ne&&(Te=m[5],m[5]=Te?zg(Te,Ne,y[6]):Ne,m[6]=Te?Va(m[5],h):y[6]),Ne=y[7],Ne&&(m[7]=Ne),L&B&&(m[8]=m[8]==null?y[8]:qn(m[8],y[8])),m[9]==null&&(m[9]=y[9]),m[0]=y[0],m[1]=Y,m}function pl(m){var y=[];if(m!=null)for(var _ in qt(m))y.push(_);return y}function ey(m){return Ki.call(m)}function Op(m,y,_){return y=$n(y===t?m.length-1:y,0),function(){for(var L=arguments,Y=-1,oe=$n(L.length-y,0),me=ge(oe);++Y<oe;)me[Y]=L[y+Y];Y=-1;for(var Ne=ge(y+1);++Y<y;)Ne[Y]=L[Y];return Ne[y]=_(me),ui(m,this,Ne)}}function mc(m,y){return y.length<2?m:Wr(m,Tr(y,0,-1))}function Qa(m,y){for(var _=m.length,L=qn(y.length,_),Y=gi(m);L--;){var oe=y[L];m[L]=Ca(oe,_)?Y[oe]:t}return m}function Mf(m,y){if(!(y==="constructor"&&typeof m[y]=="function")&&y!="__proto__")return m[y]}var Rf=td(Lu),gc=np||function(m,y){return Xn.setTimeout(m,y)},ed=td(Ou);function Lf(m,y,_){var L=y+"";return ed(m,Jg(L,ty(Ip(L),_)))}function td(m){var y=0,_=0;return function(){var L=xs(),Y=ee-(L-_);if(_=L,Y>0){if(++y>=G)return arguments[0]}else y=0;return m.apply(t,arguments)}}function nd(m,y){var _=-1,L=m.length,Y=L-1;for(y=y===t?L:y;++_<y;){var oe=yf(_,Y),me=m[oe];m[oe]=m[_],m[_]=me}return m.length=y,m}var Ja=Zg(function(m){var y=[];return m.charCodeAt(0)===46&&y.push(""),m.replace(ni,function(_,L,Y,oe){y.push(Y?oe.replace(Us,"$1"):L||_)}),y});function yn(m){if(typeof m=="string"||nr(m))return m;var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function ks(m){if(m!=null){try{return bu.call(m)}catch{}try{return m+""}catch{}}return""}function ty(m,y){return $i(de,function(_){var L="_."+_[0];y&_[1]&&!Go(m,L)&&m.push(L)}),m.sort()}function yi(m){if(m instanceof Vt)return m.clone();var y=new dr(m.__wrapped__,m.__chain__);return y.__actions__=gi(m.__actions__),y.__index__=m.__index__,y.__values__=m.__values__,y}function Wb(m,y,_){(_?tr(m,y,_):y===t)?y=1:y=$n(Rt(y),0);var L=m==null?0:m.length;if(!L||y<1)return[];for(var Y=0,oe=0,me=ge(rc(L/y));Y<L;)me[oe++]=Tr(m,Y,Y+=y);return me}function ny(m){for(var y=-1,_=m==null?0:m.length,L=0,Y=[];++y<_;){var oe=m[y];oe&&(Y[L++]=oe)}return Y}function iy(){var m=arguments.length;if(!m)return[];for(var y=ge(m-1),_=arguments[0],L=m;L--;)y[L-1]=arguments[L];return ma(At(_)?gi(_):[_],Xt(y,1))}var Hn=Ot(function(m,y){return si(m)?cl(m,Xt(y,1,si,!0)):[]}),gr=Ot(function(m,y){var _=qi(y);return si(_)&&(_=t),si(m)?cl(m,Xt(y,1,si,!0),xt(_,2)):[]}),Es=Ot(function(m,y){var _=qi(y);return si(_)&&(_=t),si(m)?cl(m,Xt(y,1,si,!0),t,_):[]});function ry(m,y,_){var L=m==null?0:m.length;return L?(y=_||y===t?1:Rt(y),Tr(m,y<0?0:y,L)):[]}function ay(m,y,_){var L=m==null?0:m.length;return L?(y=_||y===t?1:Rt(y),y=L-y,Tr(m,0,y<0?0:y)):[]}function Qb(m,y){return m&&m.length?zu(m,xt(y,3),!0,!0):[]}function Fp(m,y){return m&&m.length?zu(m,xt(y,3),!0):[]}function Dr(m,y,_,L){var Y=m==null?0:m.length;return Y?(_&&typeof _!="number"&&tr(m,y,_)&&(_=0,L=Y),$t(m,y,_,L)):[]}function Jr(m,y,_){var L=m==null?0:m.length;if(!L)return-1;var Y=_==null?0:Rt(_);return Y<0&&(Y=$n(L+Y,0)),Yo(m,xt(y,3),Y)}function $p(m,y,_){var L=m==null?0:m.length;if(!L)return-1;var Y=L-1;return _!==t&&(Y=Rt(_),Y=_<0?$n(L+Y,0):qn(Y,L-1)),Yo(m,xt(y,3),Y,!0)}function yr(m){var y=m==null?0:m.length;return y?Xt(m,1):[]}function sy(m){var y=m==null?0:m.length;return y?Xt(m,U):[]}function ml(m,y){var _=m==null?0:m.length;return _?(y=y===t?1:Rt(y),Xt(m,y)):[]}function bo(m){for(var y=-1,_=m==null?0:m.length,L={};++y<_;){var Y=m[y];L[Y[0]]=Y[1]}return L}function Ts(m){return m&&m.length?m[0]:t}function zp(m,y,_){var L=m==null?0:m.length;if(!L)return-1;var Y=_==null?0:Rt(_);return Y<0&&(Y=$n(L+Y,0)),Wi(m,y,Y)}function Bp(m){var y=m==null?0:m.length;return y?Tr(m,0,-1):[]}var Ka=Ot(function(m){var y=In(m,wf);return y.length&&y[0]===m[0]?fp(y):[]}),ly=Ot(function(m){var y=qi(m),_=In(m,wf);return y===qi(_)?y=t:_.pop(),_.length&&_[0]===m[0]?fp(_,xt(y,2)):[]}),yc=Ot(function(m){var y=qi(m),_=In(m,wf);return y=typeof y=="function"?y:t,y&&_.pop(),_.length&&_[0]===m[0]?fp(_,t,y):[]});function id(m,y){return m==null?"":Vr.call(m,y)}function qi(m){var y=m==null?0:m.length;return y?m[y-1]:t}function xc(m,y,_){var L=m==null?0:m.length;if(!L)return-1;var Y=L;return _!==t&&(Y=Rt(_),Y=Y<0?$n(L+Y,0):qn(Y,L-1)),y===y?Ji(m,y,Y):Yo(m,zi,Y,!0)}function oy(m,y){return m&&m.length?bp(m,Rt(y)):t}var cy=Ot(bc);function bc(m,y){return m&&m.length&&y&&y.length?gf(m,y):m}function uy(m,y,_){return m&&m.length&&y&&y.length?gf(m,y,xt(_,2)):m}function Of(m,y,_){return m&&m.length&&y&&y.length?gf(m,y,t,_):m}var dy=zn(function(m,y){var _=m==null?0:m.length,L=Du(m,y);return wp(m,In(y,function(Y){return Ca(Y,_)?+Y:Y}).sort(qu)),L});function Jb(m,y){var _=[];if(!(m&&m.length))return _;var L=-1,Y=[],oe=m.length;for(y=xt(y,3);++L<oe;){var me=m[L];y(me,L,m)&&(_.push(me),Y.push(L))}return wp(m,Y),_}function Up(m){return m==null?m:rp.call(m)}function bn(m,y,_){var L=m==null?0:m.length;return L?(_&&typeof _!="number"&&tr(m,y,_)?(y=0,_=L):(y=y==null?0:Rt(y),_=_===t?L:Rt(_)),Tr(m,y,_)):[]}function Mn(m,y){return Fu(m,y)}function Yt(m,y,_){return bf(m,y,xt(_,2))}function sn(m,y){var _=m==null?0:m.length;if(_){var L=Fu(m,y);if(L<_&&br(m[L],y))return L}return-1}function vn(m,y){return Fu(m,y,!0)}function Pr(m,y,_){return bf(m,y,xt(_,2),!0)}function gl(m,y){var _=m==null?0:m.length;if(_){var L=Fu(m,y,!0)-1;if(br(m[L],y))return L}return-1}function vc(m){return m&&m.length?Np(m):[]}function qp(m,y){return m&&m.length?Np(m,xt(y,2)):[]}function As(m){var y=m==null?0:m.length;return y?Tr(m,1,y):[]}function ai(m,y,_){return m&&m.length?(y=_||y===t?1:Rt(y),Tr(m,0,y<0?0:y)):[]}function yl(m,y,_){var L=m==null?0:m.length;return L?(y=_||y===t?1:Rt(y),y=L-y,Tr(m,y<0?0:y,L)):[]}function vo(m,y){return m&&m.length?zu(m,xt(y,3),!1,!0):[]}function Vp(m,y){return m&&m.length?zu(m,xt(y,3)):[]}var Kr=Ot(function(m){return Ss(Xt(m,1,si,!0))}),wc=Ot(function(m){var y=qi(m);return si(y)&&(y=t),Ss(Xt(m,1,si,!0),xt(y,2))}),rd=Ot(function(m){var y=qi(m);return y=typeof y=="function"?y:t,Ss(Xt(m,1,si,!0),t,y)});function xr(m){return m&&m.length?Ss(m):[]}function Hp(m,y){return m&&m.length?Ss(m,xt(y,2)):[]}function Gp(m,y){return y=typeof y=="function"?y:t,m&&m.length?Ss(m,t,y):[]}function Sc(m){if(!(m&&m.length))return[];var y=0;return m=$r(m,function(_){if(si(_))return y=$n(_.length,y),!0}),ga(y,function(_){return In(m,Ql(_))})}function ad(m,y){if(!(m&&m.length))return[];var _=Sc(m);return y==null?_:In(_,function(L){return ui(y,t,L)})}var xl=Ot(function(m,y){return si(m)?cl(m,y):[]}),Mi=Ot(function(m){return Bu($r(m,si))}),bl=Ot(function(m){var y=qi(m);return si(y)&&(y=t),Bu($r(m,si),xt(y,2))}),Nc=Ot(function(m){var y=qi(m);return y=typeof y=="function"?y:t,Bu($r(m,si),t,y)}),Cc=Ot(Sc);function Yp(m,y){return jp(m||[],y||[],lo)}function Wp(m,y){return jp(m||[],y||[],fc)}var fy=Ot(function(m){var y=m.length,_=y>1?m[y-1]:t;return _=typeof _=="function"?(m.pop(),_):t,ad(m,_)});function jc(m){var y=X(m);return y.__chain__=!0,y}function Qp(m,y){return y(m),m}function Vi(m,y){return y(m)}var hy=zn(function(m){var y=m.length,_=y?m[0]:0,L=this.__wrapped__,Y=function(oe){return Du(oe,m)};return y>1||this.__actions__.length||!(L instanceof Vt)||!Ca(_)?this.thru(Y):(L=L.slice(_,+_+(y?1:0)),L.__actions__.push({func:Vi,args:[Y],thisArg:t}),new dr(L,this.__chain__).thru(function(oe){return y&&!oe.length&&oe.push(t),oe}))});function Ir(){return jc(this)}function py(){return new dr(this.value(),this.__chain__)}function my(){this.__values__===t&&(this.__values__=Mr(this.value()));var m=this.__index__>=this.__values__.length,y=m?t:this.__values__[this.__index__++];return{done:m,value:y}}function Kb(){return this}function vl(m){for(var y,_=this;_ instanceof Yr;){var L=yi(_);L.__index__=0,L.__values__=t,y?Y.__wrapped__=L:y=L;var Y=L;_=_.__wrapped__}return Y.__wrapped__=m,y}function Ff(){var m=this.__wrapped__;if(m instanceof Vt){var y=m;return this.__actions__.length&&(y=new Vt(this)),y=y.reverse(),y.__actions__.push({func:Vi,args:[Up],thisArg:t}),new dr(y,this.__chain__)}return this.thru(Up)}function Jp(){return Rg(this.__wrapped__,this.__actions__)}var _c=po(function(m,y,_){fn.call(m,_)?++m[_]:wa(m,_,1)});function gy(m,y,_){var L=At(m)?Yl:up;return _&&tr(m,y,_)&&(y=t),L(m,xt(y,3))}function yy(m,y){var _=At(m)?$r:xn;return _(m,xt(y,3))}var xy=Cs(Jr),Kp=Cs($p);function Xp(m,y){return Xt(sd(m,y),1)}function Xb(m,y){return Xt(sd(m,y),U)}function Zb(m,y,_){return _=_===t?1:Rt(_),Xt(sd(m,y),_)}function by(m,y){var _=At(m)?$i:ws;return _(m,xt(y,3))}function Zp(m,y){var _=At(m)?Gh:of;return _(m,xt(y,3))}var vy=po(function(m,y,_){fn.call(m,_)?m[_].push(y):wa(m,_,[y])});function kc(m,y,_,L){m=xi(m)?m:Mc(m),_=_&&!L?Rt(_):0;var Y=m.length;return _<0&&(_=$n(Y+_,0)),Jf(m)?_<=Y&&m.indexOf(y,_)>-1:!!Y&&Wi(m,y,_)>-1}var $f=Ot(function(m,y,_){var L=-1,Y=typeof y=="function",oe=xi(m)?ge(m.length):[];return ws(m,function(me){oe[++L]=Y?ui(y,me,_):uo(me,y,_)}),oe}),wy=po(function(m,y,_){wa(m,_,y)});function sd(m,y){var _=At(m)?In:yp;return _(m,xt(y,3))}function Sy(m,y,_,L){return m==null?[]:(At(y)||(y=y==null?[]:[y]),_=L?t:_,At(_)||(_=_==null?[]:[_]),vp(m,y,_))}var Ny=po(function(m,y,_){m[_?0:1].push(y)},function(){return[[],[]]});function Cy(m,y,_){var L=At(m)?cu:Wo,Y=arguments.length<3;return L(m,xt(y,4),_,Y,ws)}function jy(m,y,_){var L=At(m)?Yh:Wo,Y=arguments.length<3;return L(m,xt(y,4),_,Y,of)}function zf(m,y){var _=At(m)?$r:xn;return _(m,dd(xt(y,3)))}function _y(m){var y=At(m)?lc:dc;return y(m)}function ky(m,y,_){(_?tr(m,y,_):y===t)?y=1:y=Rt(y);var L=At(m)?Ng:xf;return L(m,y)}function Dn(m){var y=At(m)?Cg:Ig;return y(m)}function em(m){if(m==null)return 0;if(xi(m))return Jf(m)?Ur(m):m.length;var y=ji(m);return y==xe||y==Xe?m.size:ff(m).length}function e0(m,y,_){var L=At(m)?uu:Mg;return _&&tr(m,y,_)&&(y=t),L(m,xt(y,3))}var Ey=Ot(function(m,y){if(m==null)return[];var _=y.length;return _>1&&tr(m,y[0],y[1])?y=[]:_>2&&tr(y[0],y[1],y[2])&&(y=[y[0]]),vp(m,Xt(y,1),[])}),Bf=no||function(){return Xn.Date.now()};function t0(m,y){if(typeof y!="function")throw new di(o);return m=Rt(m),function(){if(--m<1)return y.apply(this,arguments)}}function Ty(m,y,_){return y=_?t:y,y=m&&y==null?m.length:y,Wa(m,B,t,t,t,t,y)}function ld(m,y){var _;if(typeof y!="function")throw new di(o);return m=Rt(m),function(){return--m>0&&(_=y.apply(this,arguments)),m<=1&&(y=t),_}}var wl=Ot(function(m,y,_){var L=T;if(_.length){var Y=Va(_,xo(wl));L|=F}return Wa(m,L,y,_,Y)}),Uf=Ot(function(m,y,_){var L=T|E;if(_.length){var Y=Va(_,xo(Uf));L|=F}return Wa(y,L,m,_,Y)});function od(m,y,_){y=_?t:y;var L=Wa(m,P,t,t,t,t,t,y);return L.placeholder=od.placeholder,L}function qf(m,y,_){y=_?t:y;var L=Wa(m,V,t,t,t,t,t,y);return L.placeholder=qf.placeholder,L}function Sl(m,y,_){var L,Y,oe,me,Ne,Te,He=0,Ye=!1,Ze=!1,ut=!0;if(typeof m!="function")throw new di(o);y=Zr(y)||0,Gn(_)&&(Ye=!!_.leading,Ze="maxWait"in _,oe=Ze?$n(Zr(_.maxWait)||0,y):oe,ut="trailing"in _?!!_.trailing:ut);function ht(wi){var Is=L,So=Y;return L=Y=t,He=wi,me=m.apply(So,Is),me}function kt(wi){return He=wi,Ne=gc(en,y),Ye?ht(wi):me}function Gt(wi){var Is=wi-Te,So=wi-He,Yw=y-Is;return Ze?qn(Yw,oe-So):Yw}function Et(wi){var Is=wi-Te,So=wi-He;return Te===t||Is>=y||Is<0||Ze&&So>=oe}function en(){var wi=Bf();if(Et(wi))return cn(wi);Ne=gc(en,Gt(wi))}function cn(wi){return Ne=t,ut&&L?ht(wi):(L=Y=t,me)}function ka(){Ne!==t&&Og(Ne),He=0,L=Te=Y=Ne=t}function Rr(){return Ne===t?me:cn(Bf())}function Ea(){var wi=Bf(),Is=Et(wi);if(L=arguments,Y=this,Te=wi,Is){if(Ne===t)return kt(Te);if(Ze)return Og(Ne),Ne=gc(en,y),ht(Te)}return Ne===t&&(Ne=gc(en,y)),me}return Ea.cancel=ka,Ea.flush=Rr,Ea}var Xa=Ot(function(m,y){return oo(m,1,y)}),cd=Ot(function(m,y,_){return oo(m,Zr(y)||0,_)});function n0(m){return Wa(m,q)}function ud(m,y){if(typeof m!="function"||y!=null&&typeof y!="function")throw new di(o);var _=function(){var L=arguments,Y=y?y.apply(this,L):L[0],oe=_.cache;if(oe.has(Y))return oe.get(Y);var me=m.apply(this,L);return _.cache=oe.set(Y,me)||oe,me};return _.cache=new(ud.Cache||fr),_}ud.Cache=fr;function dd(m){if(typeof m!="function")throw new di(o);return function(){var y=arguments;switch(y.length){case 0:return!m.call(this);case 1:return!m.call(this,y[0]);case 2:return!m.call(this,y[0],y[1]);case 3:return!m.call(this,y[0],y[1],y[2])}return!m.apply(this,y)}}function Ay(m){return ld(2,m)}var Dy=Lg(function(m,y){y=y.length==1&&At(y[0])?In(y[0],Qi(xt())):In(Xt(y,1),Qi(xt()));var _=y.length;return Ot(function(L){for(var Y=-1,oe=qn(L.length,_);++Y<oe;)L[Y]=y[Y].call(this,L[Y]);return ui(m,this,L)})}),tm=Ot(function(m,y){var _=Va(y,xo(tm));return Wa(m,F,t,y,_)}),Vf=Ot(function(m,y){var _=Va(y,xo(Vf));return Wa(m,$,t,y,_)}),Py=zn(function(m,y){return Wa(m,z,t,t,t,y)});function Iy(m,y){if(typeof m!="function")throw new di(o);return y=y===t?y:Rt(y),Ot(m,y)}function i0(m,y){if(typeof m!="function")throw new di(o);return y=y==null?0:$n(Rt(y),0),Ot(function(_){var L=_[y],Y=dl(_,0,y);return L&&ma(Y,L),ui(m,this,Y)})}function nm(m,y,_){var L=!0,Y=!0;if(typeof m!="function")throw new di(o);return Gn(_)&&(L="leading"in _?!!_.leading:L,Y="trailing"in _?!!_.trailing:Y),Sl(m,y,{leading:L,maxWait:y,trailing:Y})}function im(m){return Ty(m,1)}function r0(m,y){return tm(Uu(y),m)}function a0(){if(!arguments.length)return[];var m=arguments[0];return At(m)?m:[m]}function fd(m){return Bi(m,v)}function s0(m,y){return y=typeof y=="function"?y:t,Bi(m,v,y)}function My(m){return Bi(m,g|v)}function Wt(m,y){return y=typeof y=="function"?y:t,Bi(m,g|v,y)}function rm(m,y){return y==null||cp(m,y,vi(y))}function br(m,y){return m===y||m!==m&&y!==y}var am=yo(Pu),Ry=yo(function(m,y){return m>=y}),Ds=cf(function(){return arguments}())?cf:function(m){return Zn(m)&&fn.call(m,"callee")&&!eo.call(m,"callee")},At=ge.isArray,Hf=pa?Qi(pa):hr;function xi(m){return m!=null&&wo(m.length)&&!ja(m)}function si(m){return Zn(m)&&xi(m)}function l0(m){return m===!0||m===!1||Zn(m)&&Zt(m)==re}var Nl=tf||D0,Ly=su?Qi(su):fi;function Oy(m){return Zn(m)&&m.nodeType===1&&!Xr(m)}function Gf(m){if(m==null)return!0;if(xi(m)&&(At(m)||typeof m=="string"||typeof m.splice=="function"||Nl(m)||Ec(m)||Ds(m)))return!m.length;var y=ji(m);if(y==xe||y==Xe)return!m.size;if(An(m))return!ff(m).length;for(var _ in m)if(fn.call(m,_))return!1;return!0}function jn(m,y){return fo(m,y)}function sm(m,y,_){_=typeof _=="function"?_:t;var L=_?_(m,y):t;return L===t?fo(m,y,t,_):!!L}function bi(m){if(!Zn(m))return!1;var y=Zt(m);return y==et||y==qe||typeof m.message=="string"&&typeof m.name=="string"&&!Xr(m)}function o0(m){return typeof m=="number"&&Nu(m)}function ja(m){if(!Gn(m))return!1;var y=Zt(m);return y==Je||y==Le||y==we||y==nt}function Yf(m){return typeof m=="number"&&m==Rt(m)}function wo(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=J}function Gn(m){var y=typeof m;return m!=null&&(y=="object"||y=="function")}function Zn(m){return m!=null&&typeof m=="object"}var Wf=Vo?Qi(Vo):uf;function lm(m,y){return m===y||Mu(m,y,Tf(y))}function c0(m,y,_){return _=typeof _=="function"?_:t,Mu(m,y,Tf(y),_)}function Fy(m){return zy(m)&&m!=+m}function u0(m){if(Xu(m))throw new We(l);return Ga(m)}function $y(m){return m===null}function d0(m){return m==null}function zy(m){return typeof m=="number"||Zn(m)&&Zt(m)==Me}function Xr(m){if(!Zn(m)||Zt(m)!=Ee)return!1;var y=vu(m);if(y===null)return!0;var _=fn.call(y,"constructor")&&y.constructor;return typeof _=="function"&&_ instanceof _&&bu.call(_)==qr}var Qf=gs?Qi(gs):df;function om(m){return Yf(m)&&m>=-9007199254740991&&m<=J}var By=Gd?Qi(Gd):pp;function Jf(m){return typeof m=="string"||!At(m)&&Zn(m)&&Zt(m)==Mt}function nr(m){return typeof m=="symbol"||Zn(m)&&Zt(m)==_t}var Ec=lu?Qi(lu):mp;function _a(m){return m===t}function cm(m){return Zn(m)&&ji(m)==se}function Uy(m){return Zn(m)&&Zt(m)==Q}var qy=yo(hf),hd=yo(function(m,y){return m<=y});function Mr(m){if(!m)return[];if(xi(m))return Jf(m)?or(m):gi(m);if(to&&m[to])return Br(m[to]());var y=ji(m),_=y==xe?Xo:y==Xe?Zo:Mc;return _(m)}function Za(m){if(!m)return m===0?m:0;if(m=Zr(m),m===U||m===-1/0){var y=m<0?-1:1;return y*ne}return m===m?m:0}function Rt(m){var y=Za(m),_=y%1;return y===y?_?y-_:y:0}function es(m){return m?Sa(Rt(m),0,ae):0}function Zr(m){if(typeof m=="number")return m;if(nr(m))return A;if(Gn(m)){var y=typeof m.valueOf=="function"?m.valueOf():m;m=Gn(y)?y+"":y}if(typeof m!="string")return m===0?m:+m;m=fu(m);var _=ci.test(m);return _||Ro.test(m)?ru(m.slice(2),_?2:8):Vs.test(m)?A:+m}function Vy(m){return mr(m,_i(m))}function Tc(m){return m?Sa(Rt(m),-9007199254740991,J):m===0?m:0}function hn(m){return m==null?"":pr(m)}var f0=mo(function(m,y){if(An(y)||xi(y)){mr(y,vi(y),m);return}for(var _ in y)fn.call(y,_)&&lo(m,_,y[_])}),Hy=mo(function(m,y){mr(y,_i(y),m)}),Kf=mo(function(m,y,_,L){mr(y,_i(y),m,L)}),h0=mo(function(m,y,_,L){mr(y,vi(y),m,L)}),p0=zn(Du);function m0(m,y){var _=Er(m);return y==null?_:vs(_,y)}var g0=Ot(function(m,y){m=qt(m);var _=-1,L=y.length,Y=L>2?y[2]:t;for(Y&&tr(y[0],y[1],Y)&&(L=1);++_<L;)for(var oe=y[_],me=_i(oe),Ne=-1,Te=me.length;++Ne<Te;){var He=me[Ne],Ye=m[He];(Ye===t||br(Ye,tc[He])&&!fn.call(m,He))&&(m[He]=oe[He])}return m}),Gy=Ot(function(m){return m.push(t,Pp),ui(yd,t,m)});function Ac(m,y){return Wl(m,xt(y,3),Ui)}function pd(m,y){return Wl(m,xt(y,3),uc)}function Yy(m,y){return m==null?m:cc(m,xt(y,3),_i)}function y0(m,y){return m==null?m:co(m,xt(y,3),_i)}function Dc(m,y){return m&&Ui(m,xt(y,3))}function md(m,y){return m&&uc(m,xt(y,3))}function Wy(m){return m==null?[]:ul(m,vi(m))}function Xf(m){return m==null?[]:ul(m,_i(m))}function gd(m,y,_){var L=m==null?t:Wr(m,y);return L===t?_:L}function um(m,y){return m!=null&&Ku(m,y,dp)}function Pc(m,y){return m!=null&&Ku(m,y,kg)}var Qy=Hu(function(m,y,_){y!=null&&typeof y.toString!="function"&&(y=Ki.call(y)),m[y]=_},Ie(Re)),Jy=Hu(function(m,y,_){y!=null&&typeof y.toString!="function"&&(y=Ki.call(y)),fn.call(m,y)?m[y].push(_):m[y]=[_]},xt),x0=Ot(uo);function vi(m){return xi(m)?op(m):ff(m)}function _i(m){return xi(m)?op(m,!0):Tg(m)}function b0(m,y){var _={};return y=xt(y,3),Ui(m,function(L,Y,oe){wa(_,y(L,Y,oe),L)}),_}function v0(m,y){var _={};return y=xt(y,3),Ui(m,function(L,Y,oe){wa(_,Y,y(L,Y,oe))}),_}var w0=mo(function(m,y,_){Ru(m,y,_)}),yd=mo(function(m,y,_,L){Ru(m,y,_,L)}),Zf=zn(function(m,y){var _={};if(m==null)return _;var L=!1;y=In(y,function(oe){return oe=Ns(oe,m),L||(L=oe.length>1),oe}),mr(m,kf(m),_),L&&(_=Bi(_,g|b|v,Hg));for(var Y=y.length;Y--;)$u(_,y[Y]);return _});function dm(m,y){return Ic(m,dd(xt(y)))}var S0=zn(function(m,y){return m==null?{}:Ag(m,y)});function Ic(m,y){if(m==null)return{};var _=In(kf(m),function(L){return[L]});return y=xt(y),mf(m,_,function(L,Y){return y(L,Y[0])})}function N0(m,y,_){y=Ns(y,m);var L=-1,Y=y.length;for(Y||(Y=1,m=t);++L<Y;){var oe=m==null?t:m[yn(y[L])];oe===t&&(L=Y,oe=_),m=ja(oe)?oe.call(m):oe}return m}function Ky(m,y,_){return m==null?m:fc(m,y,_)}function Xy(m,y,_,L){return L=typeof L=="function"?L:t,m==null?m:fc(m,y,_,L)}var fm=Wu(vi),hm=Wu(_i);function pm(m,y,_){var L=At(m),Y=L||Nl(m)||Ec(m);if(y=xt(y,4),_==null){var oe=m&&m.constructor;Y?_=L?new oe:[]:Gn(m)?_=ja(oe)?Er(vu(m)):{}:_={}}return(Y?$i:Ui)(m,function(me,Ne,Te){return y(_,me,Ne,Te)}),_}function Zy(m,y){return m==null?!0:$u(m,y)}function eh(m,y,_){return m==null?m:Cp(m,y,Uu(_))}function C0(m,y,_,L){return L=typeof L=="function"?L:t,m==null?m:Cp(m,y,Uu(_),L)}function Mc(m){return m==null?[]:Jo(m,vi(m))}function mm(m){return m==null?[]:Jo(m,_i(m))}function gm(m,y,_){return _===t&&(_=y,y=t),_!==t&&(_=Zr(_),_=_===_?_:0),y!==t&&(y=Zr(y),y=y===y?y:0),Sa(Zr(m),y,_)}function th(m,y,_){return y=Za(y),_===t?(_=y,y=0):_=Za(_),m=Zr(m),Eg(m,y,_)}function ym(m,y,_){if(_&&typeof _!="boolean"&&tr(m,y,_)&&(y=_=t),_===t&&(typeof y=="boolean"?(_=y,y=t):typeof m=="boolean"&&(_=m,m=t)),m===t&&y===t?(m=0,y=1):(m=Za(m),y===t?(y=m,m=0):y=Za(y)),m>y){var L=m;m=y,y=L}if(_||m%1||y%1){var Y=ip();return qn(m+Y*(y-m+Ba("1e-"+((Y+"").length-1))),y)}return yf(m,y)}var ex=er(function(m,y,_){return y=y.toLowerCase(),m+(_?nh(y):y)});function nh(m){return x(hn(m).toLowerCase())}function Ps(m){return m=hn(m),m&&m.replace(Fa,ya).replace(lr,"")}function Cl(m,y,_){m=hn(m),y=pr(y);var L=m.length;_=_===t?L:Sa(Rt(_),0,L);var Y=_;return _-=y.length,_>=0&&m.slice(_,Y)==y}function jl(m){return m=hn(m),m&&un.test(m)?m.replace(Cn,Wd):m}function xd(m){return m=hn(m),m&&Fn.test(m)?m.replace(Kn,"\\$&"):m}var bd=er(function(m,y,_){return m+(_?"-":"")+y.toLowerCase()}),_l=er(function(m,y,_){return m+(_?" ":"")+y.toLowerCase()}),j0=Ar("toLowerCase");function tx(m,y,_){m=hn(m),y=Rt(y);var L=y?Ur(m):0;if(!y||L>=y)return m;var Y=(y-L)/2;return Yu(ys(Y),_)+m+Yu(rc(Y),_)}function vd(m,y,_){m=hn(m),y=Rt(y);var L=y?Ur(m):0;return y&&L<y?m+Yu(y-L,_):m}function _0(m,y,_){m=hn(m),y=Rt(y);var L=y?Ur(m):0;return y&&L<y?Yu(y-L,_)+m:m}function nx(m,y,_){return _||y==null?y=0:y&&(y=+y),io(hn(m).replace(La,""),y||0)}function ih(m,y,_){return(_?tr(m,y,_):y===t)?y=1:y=Rt(y),Sp(hn(m),y)}function ix(){var m=arguments,y=hn(m[0]);return m.length<3?y:y.replace(m[1],m[2])}var k0=er(function(m,y,_){return m+(_?"_":"")+y.toLowerCase()});function rh(m,y,_){return _&&typeof _!="number"&&tr(m,y,_)&&(y=_=t),_=_===t?ae:_>>>0,_?(m=hn(m),m&&(typeof y=="string"||y!=null&&!Qf(y))&&(y=pr(y),!y&&qa(m))?dl(or(m),0,_):m.split(y,_)):[]}var ah=er(function(m,y,_){return m+(_?" ":"")+x(y)});function rx(m,y,_){return m=hn(m),_=_==null?0:Sa(Rt(_),0,m.length),y=pr(y),m.slice(_,_+y.length)==y}function wd(m,y,_){var L=X.templateSettings;_&&tr(m,y,_)&&(y=t),m=hn(m),y=Kf({},y,L,jf);var Y=Kf({},y.imports,L.imports,jf),oe=vi(Y),me=Jo(Y,oe),Ne,Te,He=0,Ye=y.interpolate||Gi,Ze="__p += '",ut=rl((y.escape||Gi).source+"|"+Ye.source+"|"+(Ye===ar?qs:Gi).source+"|"+(y.evaluate||Gi).source+"|$","g"),ht="//# sourceURL="+(fn.call(y,"sourceURL")?(y.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Hd+"]")+`
`;m.replace(ut,function(Et,en,cn,ka,Rr,Ea){return cn||(cn=ka),Ze+=m.slice(He,Ea).replace(Hs,Ko),en&&(Ne=!0,Ze+=`' +
__e(`+en+`) +
'`),Rr&&(Te=!0,Ze+=`';
`+Rr+`;
__p += '`),cn&&(Ze+=`' +
((__t = (`+cn+`)) == null ? '' : __t) +
'`),He=Ea+Et.length,Et}),Ze+=`';
`;var kt=fn.call(y,"variable")&&y.variable;if(!kt)Ze=`with (obj) {
`+Ze+`
}
`;else if(Zc.test(kt))throw new We(f);Ze=(Te?Ze.replace(Qe,""):Ze).replace(yt,"$1").replace(Un,"$1;"),Ze="function("+(kt||"obj")+`) {
`+(kt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Ne?", __e = _.escape":"")+(Te?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Ze+`return __p
}`;var Gt=D(function(){return tt(oe,ht+"return "+Ze).apply(t,me)});if(Gt.source=Ze,bi(Gt))throw Gt;return Gt}function xm(m){return hn(m).toLowerCase()}function sh(m){return hn(m).toUpperCase()}function ax(m,y,_){if(m=hn(m),m&&(_||y===t))return fu(m);if(!m||!(y=pr(y)))return m;var L=or(m),Y=or(y),oe=nl(L,Y),me=il(L,Y)+1;return dl(L,oe,me).join("")}function E0(m,y,_){if(m=hn(m),m&&(_||y===t))return m.slice(0,mu(m)+1);if(!m||!(y=pr(y)))return m;var L=or(m),Y=il(L,or(y))+1;return dl(L,0,Y).join("")}function lh(m,y,_){if(m=hn(m),m&&(_||y===t))return m.replace(La,"");if(!m||!(y=pr(y)))return m;var L=or(m),Y=nl(L,or(y));return dl(L,Y).join("")}function s(m,y){var _=O,L=R;if(Gn(y)){var Y="separator"in y?y.separator:Y;_="length"in y?Rt(y.length):_,L="omission"in y?pr(y.omission):L}m=hn(m);var oe=m.length;if(qa(m)){var me=or(m);oe=me.length}if(_>=oe)return m;var Ne=_-Ur(L);if(Ne<1)return L;var Te=me?dl(me,0,Ne).join(""):m.slice(0,Ne);if(Y===t)return Te+L;if(me&&(Ne+=Te.length-Ne),Qf(Y)){if(m.slice(Ne).search(Y)){var He,Ye=Te;for(Y.global||(Y=rl(Y.source,hn(Oa.exec(Y))+"g")),Y.lastIndex=0;He=Y.exec(Ye);)var Ze=He.index;Te=Te.slice(0,Ze===t?Ne:Ze)}}else if(m.indexOf(pr(Y),Ne)!=Ne){var ut=Te.lastIndexOf(Y);ut>-1&&(Te=Te.slice(0,ut))}return Te+L}function c(m){return m=hn(m),m&&mn.test(m)?m.replace(On,Jd):m}var p=er(function(m,y,_){return m+(_?" ":"")+y.toUpperCase()}),x=Ar("toUpperCase");function S(m,y,_){return m=hn(m),y=_?t:y,y===t?Qd(m)?Kd(m):Qh(m):m.match(y)||[]}var D=Ot(function(m,y){try{return ui(m,t,y)}catch(_){return bi(_)?_:new We(_)}}),H=zn(function(m,y){return $i(y,function(_){_=yn(_),wa(m,_,wl(m[_],m))}),m});function Z(m){var y=m==null?0:m.length,_=xt();return m=y?In(m,function(L){if(typeof L[1]!="function")throw new di(o);return[_(L[0]),L[1]]}):[],Ot(function(L){for(var Y=-1;++Y<y;){var oe=m[Y];if(ui(oe[0],this,L))return ui(oe[1],this,L)}})}function ye(m){return jg(Bi(m,g))}function Ie(m){return function(){return m}}function Ue(m,y){return m==null||m!==m?y:m}var Ge=Ya(),Oe=Ya(!0);function Re(m){return m}function St(m){return gp(typeof m=="function"?m:Bi(m,g))}function vt(m){return xp(Bi(m,g))}function _n(m,y){return pf(m,Bi(y,g))}var ke=Ot(function(m,y){return function(_){return uo(_,m,y)}}),Ce=Ot(function(m,y){return function(_){return uo(m,_,y)}});function Pe(m,y,_){var L=vi(y),Y=ul(y,L);_==null&&!(Gn(y)&&(Y.length||!L.length))&&(_=y,y=m,m=this,Y=ul(y,vi(y)));var oe=!(Gn(_)&&"chain"in _)||!!_.chain,me=ja(m);return $i(Y,function(Ne){var Te=y[Ne];m[Ne]=Te,me&&(m.prototype[Ne]=function(){var He=this.__chain__;if(oe||He){var Ye=m(this.__wrapped__),Ze=Ye.__actions__=gi(this.__actions__);return Ze.push({func:Te,args:arguments,thisArg:m}),Ye.__chain__=He,Ye}return Te.apply(m,ma([this.value()],arguments))})}),m}function Ve(){return Xn._===this&&(Xn._=nc),this}function ft(){}function Ht(m){return m=Rt(m),Ot(function(y){return bp(y,m)})}var mt=Gu(In),Nt=Gu(Yl),ki=Gu(uu);function on(m){return Df(m)?Ql(yn(m)):Dg(m)}function kl(m){return function(y){return m==null?t:Wr(m,y)}}var T0=fl(),OT=fl(!0);function A0(){return[]}function D0(){return!1}function FT(){return{}}function $T(){return""}function zT(){return!0}function BT(m,y){if(m=Rt(m),m<1||m>J)return[];var _=ae,L=qn(m,ae);y=xt(y),m-=ae;for(var Y=ga(L,y);++_<m;)y(_);return Y}function UT(m){return At(m)?In(m,yn):nr(m)?[m]:gi(Ja(hn(m)))}function qT(m){var y=++xa;return hn(m)+y}var VT=hc(function(m,y){return m+y},0),HT=Cf("ceil"),GT=hc(function(m,y){return m/y},1),YT=Cf("floor");function WT(m){return m&&m.length?Na(m,Re,Pu):t}function QT(m,y){return m&&m.length?Na(m,xt(y,2),Pu):t}function JT(m){return du(m,Re)}function KT(m,y){return du(m,xt(y,2))}function XT(m){return m&&m.length?Na(m,Re,hf):t}function ZT(m,y){return m&&m.length?Na(m,xt(y,2),hf):t}var eA=hc(function(m,y){return m*y},1),tA=Cf("round"),nA=hc(function(m,y){return m-y},0);function iA(m){return m&&m.length?Kl(m,Re):0}function rA(m,y){return m&&m.length?Kl(m,xt(y,2)):0}return X.after=t0,X.ary=Ty,X.assign=f0,X.assignIn=Hy,X.assignInWith=Kf,X.assignWith=h0,X.at=p0,X.before=ld,X.bind=wl,X.bindAll=H,X.bindKey=Uf,X.castArray=a0,X.chain=jc,X.chunk=Wb,X.compact=ny,X.concat=iy,X.cond=Z,X.conforms=ye,X.constant=Ie,X.countBy=_c,X.create=m0,X.curry=od,X.curryRight=qf,X.debounce=Sl,X.defaults=g0,X.defaultsDeep=Gy,X.defer=Xa,X.delay=cd,X.difference=Hn,X.differenceBy=gr,X.differenceWith=Es,X.drop=ry,X.dropRight=ay,X.dropRightWhile=Qb,X.dropWhile=Fp,X.fill=Dr,X.filter=yy,X.flatMap=Xp,X.flatMapDeep=Xb,X.flatMapDepth=Zb,X.flatten=yr,X.flattenDeep=sy,X.flattenDepth=ml,X.flip=n0,X.flow=Ge,X.flowRight=Oe,X.fromPairs=bo,X.functions=Wy,X.functionsIn=Xf,X.groupBy=vy,X.initial=Bp,X.intersection=Ka,X.intersectionBy=ly,X.intersectionWith=yc,X.invert=Qy,X.invertBy=Jy,X.invokeMap=$f,X.iteratee=St,X.keyBy=wy,X.keys=vi,X.keysIn=_i,X.map=sd,X.mapKeys=b0,X.mapValues=v0,X.matches=vt,X.matchesProperty=_n,X.memoize=ud,X.merge=w0,X.mergeWith=yd,X.method=ke,X.methodOf=Ce,X.mixin=Pe,X.negate=dd,X.nthArg=Ht,X.omit=Zf,X.omitBy=dm,X.once=Ay,X.orderBy=Sy,X.over=mt,X.overArgs=Dy,X.overEvery=Nt,X.overSome=ki,X.partial=tm,X.partialRight=Vf,X.partition=Ny,X.pick=S0,X.pickBy=Ic,X.property=on,X.propertyOf=kl,X.pull=cy,X.pullAll=bc,X.pullAllBy=uy,X.pullAllWith=Of,X.pullAt=dy,X.range=T0,X.rangeRight=OT,X.rearg=Py,X.reject=zf,X.remove=Jb,X.rest=Iy,X.reverse=Up,X.sampleSize=ky,X.set=Ky,X.setWith=Xy,X.shuffle=Dn,X.slice=bn,X.sortBy=Ey,X.sortedUniq=vc,X.sortedUniqBy=qp,X.split=rh,X.spread=i0,X.tail=As,X.take=ai,X.takeRight=yl,X.takeRightWhile=vo,X.takeWhile=Vp,X.tap=Qp,X.throttle=nm,X.thru=Vi,X.toArray=Mr,X.toPairs=fm,X.toPairsIn=hm,X.toPath=UT,X.toPlainObject=Vy,X.transform=pm,X.unary=im,X.union=Kr,X.unionBy=wc,X.unionWith=rd,X.uniq=xr,X.uniqBy=Hp,X.uniqWith=Gp,X.unset=Zy,X.unzip=Sc,X.unzipWith=ad,X.update=eh,X.updateWith=C0,X.values=Mc,X.valuesIn=mm,X.without=xl,X.words=S,X.wrap=r0,X.xor=Mi,X.xorBy=bl,X.xorWith=Nc,X.zip=Cc,X.zipObject=Yp,X.zipObjectDeep=Wp,X.zipWith=fy,X.entries=fm,X.entriesIn=hm,X.extend=Hy,X.extendWith=Kf,Pe(X,X),X.add=VT,X.attempt=D,X.camelCase=ex,X.capitalize=nh,X.ceil=HT,X.clamp=gm,X.clone=fd,X.cloneDeep=My,X.cloneDeepWith=Wt,X.cloneWith=s0,X.conformsTo=rm,X.deburr=Ps,X.defaultTo=Ue,X.divide=GT,X.endsWith=Cl,X.eq=br,X.escape=jl,X.escapeRegExp=xd,X.every=gy,X.find=xy,X.findIndex=Jr,X.findKey=Ac,X.findLast=Kp,X.findLastIndex=$p,X.findLastKey=pd,X.floor=YT,X.forEach=by,X.forEachRight=Zp,X.forIn=Yy,X.forInRight=y0,X.forOwn=Dc,X.forOwnRight=md,X.get=gd,X.gt=am,X.gte=Ry,X.has=um,X.hasIn=Pc,X.head=Ts,X.identity=Re,X.includes=kc,X.indexOf=zp,X.inRange=th,X.invoke=x0,X.isArguments=Ds,X.isArray=At,X.isArrayBuffer=Hf,X.isArrayLike=xi,X.isArrayLikeObject=si,X.isBoolean=l0,X.isBuffer=Nl,X.isDate=Ly,X.isElement=Oy,X.isEmpty=Gf,X.isEqual=jn,X.isEqualWith=sm,X.isError=bi,X.isFinite=o0,X.isFunction=ja,X.isInteger=Yf,X.isLength=wo,X.isMap=Wf,X.isMatch=lm,X.isMatchWith=c0,X.isNaN=Fy,X.isNative=u0,X.isNil=d0,X.isNull=$y,X.isNumber=zy,X.isObject=Gn,X.isObjectLike=Zn,X.isPlainObject=Xr,X.isRegExp=Qf,X.isSafeInteger=om,X.isSet=By,X.isString=Jf,X.isSymbol=nr,X.isTypedArray=Ec,X.isUndefined=_a,X.isWeakMap=cm,X.isWeakSet=Uy,X.join=id,X.kebabCase=bd,X.last=qi,X.lastIndexOf=xc,X.lowerCase=_l,X.lowerFirst=j0,X.lt=qy,X.lte=hd,X.max=WT,X.maxBy=QT,X.mean=JT,X.meanBy=KT,X.min=XT,X.minBy=ZT,X.stubArray=A0,X.stubFalse=D0,X.stubObject=FT,X.stubString=$T,X.stubTrue=zT,X.multiply=eA,X.nth=oy,X.noConflict=Ve,X.noop=ft,X.now=Bf,X.pad=tx,X.padEnd=vd,X.padStart=_0,X.parseInt=nx,X.random=ym,X.reduce=Cy,X.reduceRight=jy,X.repeat=ih,X.replace=ix,X.result=N0,X.round=tA,X.runInContext=W,X.sample=_y,X.size=em,X.snakeCase=k0,X.some=e0,X.sortedIndex=Mn,X.sortedIndexBy=Yt,X.sortedIndexOf=sn,X.sortedLastIndex=vn,X.sortedLastIndexBy=Pr,X.sortedLastIndexOf=gl,X.startCase=ah,X.startsWith=rx,X.subtract=nA,X.sum=iA,X.sumBy=rA,X.template=wd,X.times=BT,X.toFinite=Za,X.toInteger=Rt,X.toLength=es,X.toLower=xm,X.toNumber=Zr,X.toSafeInteger=Tc,X.toString=hn,X.toUpper=sh,X.trim=ax,X.trimEnd=E0,X.trimStart=lh,X.truncate=s,X.unescape=c,X.uniqueId=qT,X.upperCase=p,X.upperFirst=x,X.each=by,X.eachRight=Zp,X.first=Ts,Pe(X,function(){var m={};return Ui(X,function(y,_){fn.call(X.prototype,_)||(m[_]=y)}),m}(),{chain:!1}),X.VERSION=r,$i(["bind","bindKey","curry","curryRight","partial","partialRight"],function(m){X[m].placeholder=X}),$i(["drop","take"],function(m,y){Vt.prototype[m]=function(_){_=_===t?1:$n(Rt(_),0);var L=this.__filtered__&&!y?new Vt(this):this.clone();return L.__filtered__?L.__takeCount__=qn(_,L.__takeCount__):L.__views__.push({size:qn(_,ae),type:m+(L.__dir__<0?"Right":"")}),L},Vt.prototype[m+"Right"]=function(_){return this.reverse()[m](_).reverse()}}),$i(["filter","map","takeWhile"],function(m,y){var _=y+1,L=_==te||_==K;Vt.prototype[m]=function(Y){var oe=this.clone();return oe.__iteratees__.push({iteratee:xt(Y,3),type:_}),oe.__filtered__=oe.__filtered__||L,oe}}),$i(["head","last"],function(m,y){var _="take"+(y?"Right":"");Vt.prototype[m]=function(){return this[_](1).value()[0]}}),$i(["initial","tail"],function(m,y){var _="drop"+(y?"":"Right");Vt.prototype[m]=function(){return this.__filtered__?new Vt(this):this[_](1)}}),Vt.prototype.compact=function(){return this.filter(Re)},Vt.prototype.find=function(m){return this.filter(m).head()},Vt.prototype.findLast=function(m){return this.reverse().find(m)},Vt.prototype.invokeMap=Ot(function(m,y){return typeof m=="function"?new Vt(this):this.map(function(_){return uo(_,m,y)})}),Vt.prototype.reject=function(m){return this.filter(dd(xt(m)))},Vt.prototype.slice=function(m,y){m=Rt(m);var _=this;return _.__filtered__&&(m>0||y<0)?new Vt(_):(m<0?_=_.takeRight(-m):m&&(_=_.drop(m)),y!==t&&(y=Rt(y),_=y<0?_.dropRight(-y):_.take(y-m)),_)},Vt.prototype.takeRightWhile=function(m){return this.reverse().takeWhile(m).reverse()},Vt.prototype.toArray=function(){return this.take(ae)},Ui(Vt.prototype,function(m,y){var _=/^(?:filter|find|map|reject)|While$/.test(y),L=/^(?:head|last)$/.test(y),Y=X[L?"take"+(y=="last"?"Right":""):y],oe=L||/^find/.test(y);Y&&(X.prototype[y]=function(){var me=this.__wrapped__,Ne=L?[1]:arguments,Te=me instanceof Vt,He=Ne[0],Ye=Te||At(me),Ze=function(en){var cn=Y.apply(X,ma([en],Ne));return L&&ut?cn[0]:cn};Ye&&_&&typeof He=="function"&&He.length!=1&&(Te=Ye=!1);var ut=this.__chain__,ht=!!this.__actions__.length,kt=oe&&!ut,Gt=Te&&!ht;if(!oe&&Ye){me=Gt?me:new Vt(this);var Et=m.apply(me,Ne);return Et.__actions__.push({func:Vi,args:[Ze],thisArg:t}),new dr(Et,ut)}return kt&&Gt?m.apply(this,Ne):(Et=this.thru(Ze),kt?L?Et.value()[0]:Et.value():Et)})}),$i(["pop","push","shift","sort","splice","unshift"],function(m){var y=Xd[m],_=/^(?:push|sort|unshift)$/.test(m)?"tap":"thru",L=/^(?:pop|shift)$/.test(m);X.prototype[m]=function(){var Y=arguments;if(L&&!this.__chain__){var oe=this.value();return y.apply(At(oe)?oe:[],Y)}return this[_](function(me){return y.apply(At(me)?me:[],Y)})}}),Ui(Vt.prototype,function(m,y){var _=X[y];if(_){var L=_.name+"";fn.call(Gr,L)||(Gr[L]=[]),Gr[L].push({name:y,func:_})}}),Gr[ri(t,E).name]=[{name:"wrapper",func:t}],Vt.prototype.clone=ku,Vt.prototype.reverse=nf,Vt.prototype.value=ao,X.prototype.at=hy,X.prototype.chain=Ir,X.prototype.commit=py,X.prototype.next=my,X.prototype.plant=vl,X.prototype.reverse=Ff,X.prototype.toJSON=X.prototype.valueOf=X.prototype.value=Jp,X.prototype.first=X.prototype.head,to&&(X.prototype[to]=Kb),X},be=he();Yi?((Yi.exports=be)._=be,ms._=be):Xn._=be}).call($B)}(Fm,Fm.exports)),Fm.exports}var ek=zB();class BB{constructor(n){Rn(this,"sampleRate",24e3);Rn(this,"bufferSize",7680);Rn(this,"audioQueue",[]);Rn(this,"isPlaying",!1);Rn(this,"isStreamComplete",!1);Rn(this,"checkInterval",null);Rn(this,"scheduledTime",0);Rn(this,"initialBufferTime",.1);Rn(this,"gainNode");Rn(this,"source");Rn(this,"endOfQueueAudioSource",null);Rn(this,"onComplete",()=>{});this.context=n,this.gainNode=this.context.createGain(),this.source=this.context.createBufferSource(),this.gainNode.connect(this.context.destination),this.addPCM16=this.addPCM16.bind(this)}async addWorklet(n,t,r){let a=bx.get(this.context);if(a&&a[n])return a[n].handlers.push(r),Promise.resolve(this);a||(bx.set(this.context,{}),a=bx.get(this.context)),a[n]={handlers:[r]};const l=l1(n,t);await this.context.audioWorklet.addModule(l);const o=new AudioWorkletNode(this.context,n);return a[n].node=o,this}_processPCM16Chunk(n){const t=new Float32Array(n.length/2),r=new DataView(n.buffer);for(let a=0;a<n.length/2;a++)try{const l=r.getInt16(a*2,!0);t[a]=l/32768}catch(l){console.error(l)}return t}addPCM16(n){this.isStreamComplete=!1;let t=this._processPCM16Chunk(n);for(;t.length>=this.bufferSize;){const r=t.slice(0,this.bufferSize);this.audioQueue.push(r),t=t.slice(this.bufferSize)}t.length>0&&this.audioQueue.push(t),this.isPlaying||(this.isPlaying=!0,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.scheduleNextBuffer())}createAudioBuffer(n){const t=this.context.createBuffer(1,n.length,this.sampleRate);return t.getChannelData(0).set(n),t}scheduleNextBuffer(){for(;this.audioQueue.length>0&&this.scheduledTime<this.context.currentTime+.2;){const t=this.audioQueue.shift(),r=this.createAudioBuffer(t),a=this.context.createBufferSource();this.audioQueue.length===0&&(this.endOfQueueAudioSource&&(this.endOfQueueAudioSource.onended=null),this.endOfQueueAudioSource=a,a.onended=()=>{!this.audioQueue.length&&this.endOfQueueAudioSource===a&&(this.endOfQueueAudioSource=null,this.onComplete())}),a.buffer=r,a.connect(this.gainNode);const l=bx.get(this.context);l&&Object.entries(l).forEach(([,f])=>{const{node:u,handlers:d}=f;u&&(a.connect(u),u.port.onmessage=function(h){d.forEach(g=>{g.call(u.port,h)})},u.connect(this.context.destination))});const o=Math.max(this.scheduledTime,this.context.currentTime);a.start(o),this.scheduledTime=o+r.duration}if(this.audioQueue.length===0)this.isStreamComplete?(this.isPlaying=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)):this.checkInterval||(this.checkInterval=window.setInterval(()=>{this.audioQueue.length>0&&this.scheduleNextBuffer()},100));else{const t=(this.scheduledTime-this.context.currentTime)*1e3;setTimeout(()=>this.scheduleNextBuffer(),Math.max(0,t-50))}}stop(){this.isPlaying=!1,this.isStreamComplete=!0,this.audioQueue=[],this.scheduledTime=this.context.currentTime,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.gainNode.gain.linearRampToValueAtTime(0,this.context.currentTime+.1),setTimeout(()=>{this.gainNode.disconnect(),this.gainNode=this.context.createGain(),this.gainNode.connect(this.context.destination)},200)}async resume(){this.context.state==="suspended"&&await this.context.resume(),this.isStreamComplete=!1,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.gainNode.gain.setValueAtTime(1,this.context.currentTime)}complete(){this.isStreamComplete=!0,this.onComplete()}}function UB(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const f=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(u=>u.addEventListener("ended",f)),()=>{e.getTracks().forEach(u=>u.removeEventListener("ended",f))}},[e]),{type:"screen",start:async()=>{const f=await navigator.mediaDevices.getDisplayMedia({video:!0});return n(f),r(!0),f},stop:()=>{e&&(e.getTracks().forEach(f=>f.stop()),n(null),r(!1))},isStreaming:t,stream:e}}function qB(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const f=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(u=>u.addEventListener("ended",f)),()=>{e.getTracks().forEach(u=>u.removeEventListener("ended",f))}},[e]),{type:"webcam",start:async()=>{const f=await navigator.mediaDevices.getUserMedia({video:!0});return n(f),r(!0),f},stop:()=>{e&&(e.getTracks().forEach(f=>f.stop()),n(null),r(!1))},isStreaming:t,stream:e}}class VB extends X2{constructor(t){super();Rn(this,"client");Rn(this,"_status","disconnected");Rn(this,"_session",null);Rn(this,"_model",null);Rn(this,"config",null);this.client=new Q2(t),this.send=this.send.bind(this),this.onopen=this.onopen.bind(this),this.onerror=this.onerror.bind(this),this.onclose=this.onclose.bind(this),this.onmessage=this.onmessage.bind(this)}get status(){return this._status}get session(){return this._session}get model(){return this._model}getConfig(){return{...this.config}}log(t,r){const a={date:new Date,type:t,message:r};this.emit("log",a)}async connect(t,r){if(this._status==="connected"||this._status==="connecting")return!1;this._status="connecting",this.config=r,this._model=t;const a={onopen:this.onopen,onmessage:this.onmessage,onerror:this.onerror,onclose:this.onclose};try{this._session=await this.client.live.connect({model:t,config:r,callbacks:a})}catch(l){return console.error("Error connecting to GenAI Live:",l),this._status="disconnected",!1}return this._status="connected",!0}disconnect(){var t;return this.session?((t=this.session)==null||t.close(),this._session=null,this._status="disconnected",this.log("client.close","Disconnected"),!0):!1}onopen(){this.log("client.open","Connected"),this.emit("open")}onerror(t){this.log("server.error",t.message),this.emit("error",t)}onclose(t){this.log("server.close",`disconnected ${t.reason?`with reason: ${t.reason}`:""}`),this.emit("close",t)}async onmessage(t){var r;if(t.setupComplete){this.log("server.send","setupComplete"),this.emit("setupcomplete");return}if(t.toolCall){this.log("server.toolCall",t),this.emit("toolcall",t.toolCall);return}if(t.toolCallCancellation){this.log("server.toolCallCancellation",t),this.emit("toolcallcancellation",t.toolCallCancellation);return}if(t.serverContent){const{serverContent:a}=t;if("interrupted"in a){this.log("server.content","interrupted"),this.emit("interrupted");return}if("turnComplete"in a&&(this.log("server.content","turnComplete"),this.emit("turncomplete")),"modelTurn"in a){let l=((r=a.modelTurn)==null?void 0:r.parts)||[];const o=l.filter(h=>{var g;return h.inlineData&&((g=h.inlineData.mimeType)==null?void 0:g.startsWith("audio/pcm"))}),f=o.map(h=>{var g;return(g=h.inlineData)==null?void 0:g.data}),u=ek.difference(l,o);if(f.forEach(h=>{if(h){const g=PB(h);this.emit("audio",g),this.log("server.audio",`buffer (${g.byteLength})`)}}),!u.length)return;l=u;const d={modelTurn:{parts:l}};this.emit("content",d),this.log("server.content",t)}}else console.log("received unmatched message",t)}sendRealtimeInput(t){var o;let r=!1,a=!1;for(const f of t)if((o=this.session)==null||o.sendRealtimeInput({media:f}),f.mimeType.includes("audio")&&(r=!0),f.mimeType.includes("image")&&(a=!0),r&&a)break;const l=r&&a?"audio + video":r?"audio":a?"video":"unknown";this.log("client.realtimeInput",l)}sendToolResponse(t){var r;t.functionResponses&&t.functionResponses.length&&((r=this.session)==null||r.sendToolResponse({functionResponses:t.functionResponses}),this.log("client.toolResponse",t))}send(t,r=!0){var a;(a=this.session)==null||a.sendClientContent({turns:t,turnComplete:r}),this.log("client.send",{turns:Array.isArray(t)?t:[t],turnComplete:r})}}function HB(e){const n=w.useMemo(()=>new VB(e),[e]),t=w.useRef(null),[r,a]=w.useState("models/gemini-2.5-flash-live-preview"),[l,o]=w.useState({}),[f,u]=w.useState(!1),[d,h]=w.useState(0),[g,b]=w.useState(null);w.useEffect(()=>{t.current||J2({id:"audio-out"}).then(k=>{t.current=new BB(k),t.current.addWorklet("vumeter-out",K2,T=>{h(T.data.volume)}).then(()=>{})})},[t]),w.useEffect(()=>{const k=()=>{u(!0)},T=()=>{u(!1)},E=F=>{console.error("error",F)},I=()=>{var F;return(F=t.current)==null?void 0:F.stop()},P=F=>{var $;return($=t.current)==null?void 0:$.addPCM16(new Uint8Array(F))},V=F=>{if(console.log("Received content event:",F),F.modelTurn&&F.modelTurn.parts){const $=F.modelTurn.parts.filter(B=>"text"in B&&B.text);if($.length>0){const B=$.map(z=>z.text).join(" ");b(B),console.log("AI Summary received:",B)}}};return n.on("error",E).on("open",k).on("close",T).on("interrupted",I).on("audio",P).on("content",V),()=>{n.off("error",E).off("open",k).off("close",T).off("interrupted",I).off("audio",P).off("content",V).disconnect()}},[n]);const v=w.useCallback(async()=>{if(!l)throw new Error("config has not been set");n.disconnect(),await n.connect(r,l)},[n,l,r]),N=w.useCallback(async()=>{n.disconnect(),u(!1)},[u,n]);return{client:n,config:l,setConfig:o,model:r,setModel:a,connected:f,connect:v,disconnect:N,volume:d,aiSummary:g}}const tk=w.createContext(void 0),fw=({options:e,children:n})=>{const t=HB(e);return i.jsx(tk.Provider,{value:t,children:n})},Qc=()=>{const e=w.useContext(tk);if(!e)throw new Error("useLiveAPIContext must be used wihin a LiveAPIProvider");return e};function GB(){const{config:e,setConfig:n}=Qc(),[t,r]=w.useState({value:"audio",label:"audio"}),a=w.useCallback(l=>{n({...e,responseModalities:[l==="audio"?Vc.AUDIO:Vc.TEXT]})},[e,n]);return i.jsxs("div",{className:"select-group",children:[i.jsx("label",{htmlFor:"response-modality-selector",children:"Response modality"}),i.jsx(P2,{id:"response-modality-selector",className:"react-select",classNamePrefix:"react-select",styles:{},defaultValue:t,options:[{value:"audio",label:"audio"},{value:"text",label:"text"}],onChange:l=>{r(l),l&&(l.value==="audio"||l.value==="text")&&a(l.value)}})]})}const dC=[{value:"Puck",label:"Puck"},{value:"Charon",label:"Charon"},{value:"Kore",label:"Kore"},{value:"Fenrir",label:"Fenrir"},{value:"Aoede",label:"Aoede"}];function YB(){const{config:e,setConfig:n}=Qc();w.useEffect(()=>{var f,u,d;const l=((d=(u=(f=e.speechConfig)==null?void 0:f.voiceConfig)==null?void 0:u.prebuiltVoiceConfig)==null?void 0:d.voiceName)||"Atari02";r({value:l,label:l})},[e]);const[t,r]=w.useState(dC[5]),a=w.useCallback(l=>{n({...e,speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:l}}}})},[e,n]);return i.jsxs("div",{className:"select-group",children:[i.jsx("label",{htmlFor:"voice-selector",children:"Voice"}),i.jsx(P2,{id:"voice-selector",className:"react-select",classNamePrefix:"react-select",styles:{},value:t,defaultValue:t,options:dC,onChange:l=>{r(l),l&&a(l.value)}})]})}function WB(){const[e,n]=w.useState(!1),{config:t,setConfig:r,connected:a}=Qc(),l=w.useMemo(()=>Array.isArray(t.tools)?t.tools.filter(d=>Array.isArray(d.functionDeclarations)).map(d=>d.functionDeclarations).filter(d=>!!d).flat():[],[t]),o=w.useMemo(()=>{var d;return t.systemInstruction?typeof t.systemInstruction=="string"?t.systemInstruction:Array.isArray(t.systemInstruction)?t.systemInstruction.map(h=>typeof h=="string"?h:h.text).join(`
`):typeof t.systemInstruction=="object"&&"parts"in t.systemInstruction&&((d=t.systemInstruction.parts)==null?void 0:d.map(h=>h.text).join(`
`))||"":""},[t]),f=w.useCallback(d=>{const h={...t,systemInstruction:d.target.value};r(h)},[t,r]),u=w.useCallback((d,h)=>{var b;const g={...t,tools:((b=t.tools)==null?void 0:b.map(v=>{const N=v;return Array.isArray(N.functionDeclarations)?{...v,functionDeclarations:N.functionDeclarations.map(k=>k.name===d?{...k,description:h}:k)}:v}))||[]};r(g)},[t,r]);return i.jsxs("div",{className:"settings-dialog",children:[i.jsx("button",{className:"action-button material-symbols-outlined",onClick:()=>n(!e),children:"settings"}),i.jsx("dialog",{className:"dialog",style:{display:e?"block":"none"},children:i.jsxs("div",{className:`dialog-container ${a?"disabled":""}`,children:[a&&i.jsx("div",{className:"connected-indicator",children:i.jsx("p",{children:"These settings can only be applied before connecting and will override other settings."})}),i.jsxs("div",{className:"mode-selectors",children:[i.jsx(GB,{}),i.jsx(YB,{})]}),i.jsx("h3",{children:"System Instructions"}),i.jsx("textarea",{className:"system",onChange:f,value:o}),i.jsx("h4",{children:"Function declarations"}),i.jsx("div",{className:"function-declarations",children:i.jsx("div",{className:"fd-rows",children:l.map((d,h)=>{var g;return i.jsxs("div",{className:"fd-row",children:[i.jsx("span",{className:"fd-row-name",children:d.name}),i.jsx("span",{className:"fd-row-args",children:Object.keys(((g=d.parameters)==null?void 0:g.properties)||{}).map((b,v)=>i.jsx("span",{children:b},v))}),i.jsx("input",{className:"fd-row-description",type:"text",defaultValue:d.description,onBlur:b=>u(d.name,b.target.value)},`fd-${d.description}`)]},`function-${h}`)})})})]})})]})}const fC=w.memo(({isStreaming:e,onIcon:n,offIcon:t,start:r,stop:a})=>e?i.jsx("button",{className:"action-button",onClick:a,children:i.jsx("span",{className:"material-symbols-outlined",children:n})}):i.jsx("button",{className:"action-button",onClick:r,children:i.jsx("span",{className:"material-symbols-outlined",children:t})}));function QB({videoRef:e,children:n,onVideoStreamChange:t=()=>{},supportsVideo:r,enableEditingSettings:a}){const l=[qB(),UB()],[o,f]=w.useState(null),[u,d]=l,[h,g]=w.useState(0),[b]=w.useState(()=>new Z2),[v,N]=w.useState(!1),k=w.useRef(null),T=w.useRef(null),{client:E,connected:I,connect:P,disconnect:V,volume:F}=Qc();w.useEffect(()=>{!I&&T.current&&T.current.focus()},[I]),w.useEffect(()=>{document.documentElement.style.setProperty("--volume",`${Math.max(5,Math.min(h*200,8))}px`)},[h]),w.useEffect(()=>{const B=z=>{E.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:z}])};return I&&!v&&b?b.on("data",B).on("volume",g).start():b.stop(),()=>{b.off("data",B).off("volume",g)}},[I,E,v,b]),w.useEffect(()=>{e.current&&(e.current.srcObject=o);let B=-1;function z(){const q=e.current,O=k.current;if(!q||!O)return;const R=O.getContext("2d");if(O.width=q.videoWidth*.25,O.height=q.videoHeight*.25,O.width+O.height>0){R.drawImage(q,0,0,O.width,O.height);const G=O.toDataURL("image/jpeg",1),ee=G.slice(G.indexOf(",")+1,1/0);E.sendRealtimeInput([{mimeType:"image/jpeg",data:ee}])}I&&(B=window.setTimeout(z,1e3/.5))}return I&&o!==null&&requestAnimationFrame(z),()=>{clearTimeout(B)}},[I,o,E,e]);const $=B=>async()=>{if(B){const z=await B.start();f(z),t(z)}else f(null),t(null);l.filter(z=>z!==B).forEach(z=>z.stop())};return i.jsxs("section",{className:"control-tray",children:[i.jsx("canvas",{style:{display:"none"},ref:k}),i.jsxs("nav",{className:qc("actions-nav",{disabled:!I}),children:[i.jsx("button",{className:qc("action-button mic-button",{recording:!v&&I}),onClick:()=>N(!v),children:v?i.jsx("span",{className:"material-symbols-outlined filled",children:"mic_off"}):i.jsx("span",{className:"material-symbols-outlined filled",children:"mic"})}),i.jsx("div",{className:"action-button no-action outlined",children:i.jsx(FB,{volume:F,active:I,hover:!1})}),r&&i.jsxs(i.Fragment,{children:[i.jsx(fC,{isStreaming:d.isStreaming,start:$(d),stop:$(),onIcon:"cancel_presentation",offIcon:"present_to_all"}),i.jsx(fC,{isStreaming:u.isStreaming,start:$(u),stop:$(),onIcon:"videocam_off",offIcon:"videocam"})]}),n]}),i.jsxs("div",{className:qc("connection-container",{connected:I}),children:[i.jsx("div",{className:"connection-button-container",children:i.jsx("button",{ref:T,className:qc("action-button connect-toggle",{connected:I}),onClick:I?V:P,children:i.jsx("span",{className:"material-symbols-outlined filled",children:I?"pause":"play_arrow"})})}),i.jsx("span",{className:"text-indicator",children:"Streaming"})]}),a?i.jsx(WB,{}):""]})}const hC={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Dh.OBJECT,properties:{summary:{type:Dh.STRING,description:"The summary of the patient's case."}},required:["summary"]}},JB=({patientData:e,tokenNumber:n})=>{const[t,r]=w.useState(""),{client:a,setConfig:l,setModel:o}=Qc();return w.useEffect(()=>{o("models/gemini-2.5-flash-live-preview"),l({responseModalities:[Vc.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:`Your job is to:

If patient details like name, age, sex, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details (e.g., phone number) are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's name, age, sex, and phone number.

When pronouncing a phone number, always state each digit individually (e.g., "six three" instead of "sixty-three" or "six billion three").

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in Telugu.dont write the telugu words in english`}]},tools:[{functionDeclarations:[hC]}]})},[l,o]),w.useEffect(()=>{const f=u=>{if(!u.functionCalls)return;const d=u.functionCalls.find(h=>h.name===hC.name);if(d){const h=d.args.summary;r(h)}u.functionCalls.length&&setTimeout(()=>{var h;return a.sendToolResponse({functionResponses:(h=u.functionCalls)==null?void 0:h.map(g=>({response:{output:{success:!0}},id:g.id,name:g.name}))})},200)};return a.on("toolcall",f),()=>{a.off("toolcall",f)}},[a]),w.useEffect(()=>{if(t){const f=encodeURIComponent(t);n?window.location.href=`https://hms.newtons.in/handle-complaint-url?token=${n}&caseDetails=${f}`:window.location.href=`https://hms.newtons.in/dashboard/search-patient?caseDetails=${f}`}},[t,n]),i.jsxs("div",{className:"hospital-reception",children:[i.jsx("h1",{children:"Newtons Ai"}),i.jsx("p",{children:"Newtons Ai"}),n&&i.jsxs("h2",{children:["Token Number: ",n]}),e&&i.jsxs("div",{children:[i.jsx("h2",{children:"Patient Details"}),i.jsx("pre",{children:JSON.stringify(e,null,2)})]}),t&&i.jsxs("div",{children:[i.jsx("h2",{children:"Case Summary (from Tool Call)"}),i.jsx("p",{children:t})]})]})};async function KB(){const e=Qx();if(!e)throw new Error("Authentication token not found. Please log in.");try{const r=(await(await pe("/api/clinics/settings",{headers:{Authorization:`Bearer ${e}`}})).json()).gemini_api_key;if(r)return console.log("Using clinic-specific Live API key."),r}catch(n){console.warn("Failed to fetch clinic-specific Live API key, trying global fallback.",n)}try{const r=(await(await pe("/api/super-admin-settings/gemini-api-key",{headers:{Authorization:`Bearer ${e}`}})).json()).gemini_api_key;if(r)return console.log("Using global Live API key."),r}catch(n){console.warn("Failed to fetch global Live API key.",n)}throw new Error("Live API key not found. Please contact your administrator.")}function XB(){const e=w.useRef(null),[n,t]=w.useState(null),[r,a]=w.useState(null);return w.useEffect(()=>{(async()=>{try{const o=await KB();a({apiKey:o})}catch(o){console.error("Error setting Live API options:",o)}})()},[]),r?i.jsx("div",{className:"App",children:i.jsx(fw,{options:r,children:i.jsx(ZB,{videoRef:e,setVideoStream:t,videoStream:n})})}):i.jsx("div",{children:"Loading Live API settings..."})}const ZB=({videoRef:e,setVideoStream:n,videoStream:t})=>{const[r,a]=w.useState(null),[l,o]=w.useState(null),{connected:f,client:u,connect:d,config:h,model:g}=Qc(),[b,v]=w.useState(""),N=w.useRef(null),[k,T]=w.useState(!1);w.useEffect(()=>{const I=window.matchMedia("(prefers-color-scheme: dark)"),P=V=>{document.documentElement.setAttribute("data-theme",V.matches?"dark":"light")};return P(I),I.addEventListener("change",P),()=>I.removeEventListener("change",P)},[]),w.useEffect(()=>{const I=new URLSearchParams(window.location.search),P={};for(const[V,F]of I.entries())V==="token_number"?o(F):P[V]=F;a(P)},[]),w.useEffect(()=>{Object.keys(h).length>0&&g&&d()},[d,h,g]),w.useEffect(()=>{if(f&&r&&!k){const I=JSON.stringify(r,null,2);u.send([{text:I}]),v(""),T(!0)}},[f,r,u,k]),w.useEffect(()=>{r&&v(JSON.stringify(r,null,2))},[r]);const E=()=>{u.send([{text:b}]),v(""),N.current&&(N.current.innerText="")};return i.jsx("div",{className:"streaming-console",children:i.jsxs("main",{children:[i.jsxs("div",{className:"main-app-area",children:[i.jsx(JB,{patientData:r,tokenNumber:l}),i.jsx("video",{className:qc("stream",{hidden:!e.current||!t}),ref:e,autoPlay:!0,playsInline:!0})]}),i.jsx("div",{className:qc("input-container",{disabled:!f}),children:i.jsxs("div",{className:"input-content",children:[i.jsx("textarea",{className:"input-area",ref:N,onKeyDown:I=>{I.key==="Enter"&&!I.shiftKey&&(I.preventDefault(),I.stopPropagation(),E())},onChange:I=>v(I.target.value),value:b}),i.jsx("span",{className:qc("input-content-placeholder",{hidden:b.length}),children:"Typesomething..."}),i.jsx("button",{className:"send-button material-symbols-outlined filled",onClick:E,children:"send"})]})}),i.jsx(QB,{videoRef:e,supportsVideo:!0,onVideoStreamChange:n,enableEditingSettings:!0})]})})},pC="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",eU=({volume:e,active:n})=>{const t=Array.from({length:5},(r,a)=>i.jsx("div",{className:`audio-bar ${n?"active":""}`,style:{height:n?`${Math.min(24,20+e*40*(1+Math.sin(a)*.3))}px`:"8px",animationDelay:`${a*.1}s`}},a));return i.jsx("div",{className:"audio-pulse",children:t})},tU=w.forwardRef(({videoRef:e,supportsVideo:n,onVideoStreamChange:t,textInput:r,onSubmitTextInput:a},l)=>{var $;const{connected:o,connect:f,disconnect:u,client:d,volume:h}=Qc(),[g,b]=w.useState(!1),[v,N]=w.useState(!1),[k,T]=w.useState(!1),[E]=w.useState(()=>new Z2),I=async()=>{o?await u():(await f(),r.trim()&&a())};w.useEffect(()=>{const B=z=>{d.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:z}])};return o&&!g?E.on("data",B).start():E.stop(),()=>{E.off("data",B),E.stop()}},[o,d,g,E]);const P=w.useCallback(async()=>{if(v)F==null||F.getTracks().forEach(B=>B.stop()),t(null),N(!1);else try{const B=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=B),t(B),N(!0)}catch(B){console.error("Error accessing webcam:",B),N(!1)}},[v,t,e]),V=w.useCallback(async()=>{if(k)F==null||F.getTracks().forEach(B=>B.stop()),t(null),T(!1);else try{const B=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=B),t(B),T(!0)}catch(B){console.error("Error accessing screen share:",B),T(!1)}},[k,t,e]),F=($=e.current)==null?void 0:$.srcObject;return w.useEffect(()=>()=>{F&&F.getTracks().forEach(B=>B.stop())},[F]),w.useImperativeHandle(l,()=>({handleConnect:I})),i.jsx("div",{className:"live-api-control-tray",children:i.jsxs("div",{className:"live-api-control-tray-inner",children:[i.jsxs("div",{className:"live-api-control-group",children:[i.jsx("button",{onClick:()=>b(!g),disabled:!o,className:`live-api-control-button ${o&&!g?"mic-active":"mic-inactive"}`,"aria-label":g?"Unmute microphone":"Mute microphone",children:g?i.jsx(fI,{className:"w-5 h-5"}):i.jsx(T_,{className:"w-5 h-5"})}),i.jsx("div",{className:"live-api-audio-pulse-container",children:i.jsx(eU,{volume:h,active:o})}),n&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:V,disabled:!o,className:`live-api-control-button ${k?"video-active":"video-inactive"}`,"aria-label":k?"Stop screen share":"Start screen share",children:i.jsx(mI,{className:"w-5 h-5"})}),i.jsx("button",{onClick:P,disabled:!o,className:`live-api-control-button ${v?"video-active":"video-inactive"}`,"aria-label":v?"Turn off webcam":"Turn on webcam",children:i.jsx(cM,{className:"w-5 h-5"})})]})]}),i.jsxs("div",{className:"live-api-control-group",children:[i.jsxs("div",{className:"live-api-status-indicator",children:[i.jsx("div",{className:`live-api-status-dot ${o?"connected":"disconnected"}`}),i.jsx("span",{className:"live-api-status-text",children:o?"Streaming":"Disconnected"})]}),i.jsx("button",{onClick:I,className:`live-api-connect-button ${o?"connected":"disconnected"}`,children:o?i.jsxs(i.Fragment,{children:[i.jsx(CI,{className:"w-5 h-5"}),i.jsx("span",{children:"Pause"})]}):i.jsxs(i.Fragment,{children:[i.jsx(AI,{className:"w-5 h-5"}),i.jsx("span",{children:"Start"})]})})]})]})})}),nU=({patientData:e,tokenNumber:n,aiSummary:t,clinicName:r})=>i.jsxs("div",{className:"hospital-reception-container",children:[i.jsxs("div",{className:"hospital-reception-logo-section",children:[i.jsx("div",{className:"hospital-reception-logo",children:i.jsx("span",{children:r.charAt(0)})}),i.jsxs("h1",{className:"hospital-reception-title",children:[r," AI"]}),i.jsxs("p",{className:"hospital-reception-subtitle",children:["Intelligent ",r," Reception Assistant"]})]}),n&&i.jsxs("div",{className:"hospital-reception-token-card",children:[i.jsx("h2",{className:"hospital-reception-token-title",children:"Token Number"}),i.jsx("p",{className:"hospital-reception-token-number",children:n})]}),e?i.jsxs("div",{className:"hospital-reception-patient-info-card",children:[i.jsx("h3",{className:"hospital-reception-patient-info-title",children:"Patient Information"}),i.jsx("div",{className:"hospital-reception-patient-info-content",children:i.jsx("pre",{className:"hospital-reception-patient-info-pre",children:JSON.stringify(e,null,2)})})]}):i.jsxs("div",{className:"hospital-reception-patient-info-card",children:[i.jsx("h3",{className:"hospital-reception-patient-info-title",children:"New Case"}),i.jsx("p",{className:"hospital-reception-patient-info-pre",children:"No patient data provided. This is a new case."})]}),t&&i.jsxs("div",{className:"hospital-reception-summary-card",children:[i.jsx("h3",{className:"hospital-reception-summary-title",children:"Case Summary"}),i.jsx("p",{className:"hospital-reception-summary-text",children:t})]})]}),mC={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Dh.OBJECT,properties:{summary:{type:Dh.STRING,description:"The summary of the patient's case."}},required:["summary"]}},iU=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:a,aiLanguage:l})=>{const o=w.useRef(null),f=w.useRef(null),[u,d]=w.useState(null),[h,g]=w.useState("hi"),{client:b,connected:v,aiSummary:N,setConfig:k,setModel:T,disconnect:E}=Qc(),[I,P]=w.useState(null),V=w.useMemo(()=>{let B=`Your job is to:

If patient details like name, age, sex, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's name, age, and sex(dont ask for sex ,detect automatically through voice recognition).

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in ${l||"English"}.dont write the ${l||"English"} words in english.donot use function calls in the middle of the conversation`;return n&&(B+=`

Patient Data: ${JSON.stringify(n,null,2)}`),{responseModalities:[Vc.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:B}]},tools:[{functionDeclarations:[mC]}]}},[n,l]);w.useEffect(()=>{T("models/gemini-2.5-flash-native-audio-preview-09-2025"),k(V);const B=setTimeout(()=>{f.current&&!v&&f.current.handleConnect()},2e3);return()=>clearTimeout(B)},[k,T,V,v]),w.useEffect(()=>()=>{v&&E()},[v,E]),w.useEffect(()=>{r(N)},[N,r]),w.useEffect(()=>{const B=z=>{if(z.modelTurn&&z.modelTurn.parts){for(const q of z.modelTurn.parts)if(q.executableCode){const O=q.executableCode.code,R=/summary=["'](.*?)["']/.exec(O);if(R&&R[1]){const G=R[1];P(G),r(G)}}}};return b.on("content",B),()=>{b.off("content",B)}},[b,r]),w.useEffect(()=>{const B=z=>{if(!z.functionCalls)return;const q=z.functionCalls.find(O=>O.name===mC.name);if(q){const O=q.args.summary;r(O)}z.functionCalls.length&&setTimeout(()=>{var O;return b.sendToolResponse({functionResponses:(O=z.functionCalls)==null?void 0:O.map(R=>({response:{output:{success:!0}},id:R.id,name:R.name}))})},200)};return b.on("toolcall",B),()=>{b.off("toolcall",B)}},[b,r]);const F=()=>{h.trim()&&(b.send([{text:h}]),g(""))},$=B=>{B.key==="Enter"&&!B.shiftKey&&(B.preventDefault(),F())};return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsxs("div",{className:"live-api-modal-content",children:[i.jsxs("div",{className:"live-api-modal-header",children:[i.jsxs("div",{className:"live-api-modal-header-left",children:[i.jsx("div",{className:"live-api-modal-logo",children:i.jsx("span",{children:a.charAt(0)})}),i.jsxs("div",{children:[i.jsx("h1",{className:"live-api-modal-title",children:a}),i.jsxs("p",{className:"live-api-modal-subtitle",children:[a," Hospital Assistant"]})]})]}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("button",{onClick:e,className:"live-api-modal-close-button","aria-label":"Close modal",children:i.jsx(Qn,{className:"w-6 h-6"})})})]}),i.jsx("div",{className:"live-api-modal-main-content",children:i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsxs("div",{className:"live-api-reception-area",children:[i.jsx(nU,{patientData:n,tokenNumber:t,aiSummary:I??N,clinicName:a}),u&&i.jsx("video",{ref:o,autoPlay:!0,playsInline:!0,className:"live-api-video-stream"})]}),i.jsx("div",{className:"live-api-input-area",children:i.jsxs("div",{className:"live-api-input-container",children:[i.jsx("textarea",{value:h,onChange:B=>g(B.target.value),onKeyDown:$,placeholder:"Type your message here...",disabled:!v,rows:1,className:"live-api-textarea"}),i.jsx("button",{onClick:F,disabled:!v||!h.trim(),className:"live-api-send-button","aria-label":"Send message",children:i.jsx(OI,{className:"w-5 h-5"})})]})}),i.jsx(tU,{ref:f,videoRef:o,supportsVideo:!0,onVideoStreamChange:d,textInput:h,onSubmitTextInput:F})]})})]})})},nk=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r})=>{const[a,l]=w.useState(null),[o,f]=w.useState("Newtons Ai"),[u,d]=w.useState(""),[h,g]=w.useState(!0);if(w.useEffect(()=>{(async()=>{try{const k=await(await pe("/api/clinics/settings")).json();k.gemini_api_key?l(k.gemini_api_key):l(pC),k.name&&k.name!==""?f(k.name):f("Newtons Ai"),d(k.aiLanguage||"")}catch(N){console.error("Failed to fetch clinic settings, using default API key and unknown clinic name:",N),l(pC),f("Newtons Ai"),d("")}finally{g(!1)}})()},[]),h)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsx("div",{className:"live-api-modal-content",children:i.jsx("div",{children:"Loading API Key and Clinic Name..."})})});if(!a)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsx("div",{className:"live-api-modal-content",children:i.jsx("div",{children:"Error: API Key not available."})})});const b={apiKey:a};return i.jsx(fw,{options:b,children:i.jsx(iU,{onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:o,aiLanguage:u})})},rU=({onClose:e})=>{const n=gt(),t=()=>{e(),n("/start-clinic-subscription")};return i.jsx("div",{className:"go-pro-modal-overlay",children:i.jsxs("div",{className:"go-pro-modal-content",children:[i.jsx("button",{onClick:e,className:"go-pro-modal-close-button",children:i.jsx(Qn,{size:24})}),i.jsx("h2",{className:"go-pro-modal-title",children:"Voice AI Agent for Pro Members Only"}),i.jsx("p",{className:"go-pro-modal-message",children:"Unlock the full potential of our Voice AI Agent by upgrading to a Pro subscription. Enjoy advanced features and seamless patient interactions."}),i.jsx("button",{onClick:t,className:"go-pro-button",children:"Go Pro Now"})]})})},aU="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",sU={apiKey:aU},vh=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,l]=w.useState([]),[o,f]=w.useState(!1),[u,d]=w.useState(null),[h,g]=w.useState(!1),[b,v]=w.useState(null),[N,k]=w.useState(!1),[T,E]=w.useState(null),I=w.useRef(null),[P,V]=w.useState(!1),[F,$]=w.useState(!1),[B,z]=w.useState(null),[q,O]=w.useState(null),[R,G]=w.useState(null),[ee,te]=w.useState(!1),le=gt(),K=rr();w.useEffect(()=>{(async()=>{try{const Se=await q_();G(Se.hasProPlan)}catch(Se){console.error("Error fetching pro status:",Se),G(!1)}})(),U()},[]);const U=async()=>{try{const de=new URLSearchParams({page:"1",limit:"4",sortBy:"created_at",sortOrder:"desc"}),Se=await pe(`/api/patients?${de.toString()}`);if(Se.ok){const fe=await Se.json();l(fe.patients)}}catch(de){console.error("Error fetching recent patients:",de)}},J=w.useCallback(async de=>{const Se=de||e;if(!Se.trim()){E("Please enter complaint details.");return}k(!0),E(null);try{const fe=await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"New Patient - Direct Entry",age:null,gender:null,phone:null,address:null})});if(!fe.ok){const qe=await fe.json().catch(()=>({message:"Failed to create patient"}));if(fe.status===403&&qe.message.includes("Patient limit")){le("/start-clinic-subscription",{state:{errorMessage:qe.message}});return}throw new Error(qe.message||`Failed to create patient: ${fe.statusText}`)}const we=await fe.json();if(!we||!we.id)throw new Error("Failed to create new patient or retrieve patient ID.");const re=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:we.id,complaint:Se})});if(!re.ok){const qe=await re.text();throw new Error(`Failed to create queue entry: ${qe||re.statusText}`)}const _e=await re.json();if(!_e||!_e.id)throw new Error("Failed to create new complaint record or retrieve record ID.");le(`/dashboard/edit-complaint/${_e.id}`,{state:{initialComplaint:Se,patientId:we.id}})}catch(fe){console.error("Error starting new complaint:",fe),fe.message.includes("Patient limit")?(E(`Error: ${fe.message}. Please upgrade your plan.`),le("/start-clinic-subscription")):E(`Error: ${fe.message||"Failed to start new complaint process."}`)}finally{k(!1)}},[e,le]);w.useEffect(()=>{const de=I.current;de&&(de.style.height="auto",de.style.height=`${de.scrollHeight}px`);const fe=new URLSearchParams(K.search).get("caseDetails");if(fe){const we=decodeURIComponent(fe);we!==e&&(n(we),V(!0))}},[K.search,e]),w.useEffect(()=>{P&&e.trim()&&(le(K.pathname,{replace:!0}),J(e),V(!1))},[P,e,J,le,K.pathname]),w.useEffect(()=>{const de=I.current;de&&(de.style.height="auto",de.style.height=`${de.scrollHeight}px`)},[e]),w.useEffect(()=>{B&&(n(B),$(!1),J(B),z(null))},[B,J]);const ne=()=>{if(R===!1){te(!0);return}O({id:null,token:null,name:"New Case",age:null,gender:null}),$(!0)},A=w.useMemo(()=>Nb(async de=>{const Se=de.trim(),fe=/^\d+$/.test(Se),we=Se.split(/\s+/).length;if(Se.length<2||fe&&Se.length>10||!fe&&we>2){r([]),f(!1),d(null);return}f(!0),d(null);try{const re=new URLSearchParams({search:encodeURIComponent(de),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),_e=await pe(`/api/patients?${re.toString()}`);if(!_e.ok){const et=await _e.text();throw new Error(`API Error (${_e.status}): ${et||_e.statusText}`)}const qe=await _e.json();r(qe.patients)}catch(re){console.error("Error searching patients:",re),d(re.message||"Failed to search patients."),r([])}finally{f(!1)}},300),[]),ae=de=>{const Se=de.target.value;n(Se);const fe=Se.trim(),we=/^\d+$/.test(fe),re=fe.split(/\s+/).length;fe.length>=2&&!(we&&fe.length>10||!we&&re>2)?f(!0):(f(!1),r([])),A(Se)},ce=de=>{de.key==="Enter"&&!de.shiftKey&&(de.preventDefault(),t.length>0&&!o?M(t[0]):e.trim()&&!o&&J(e))},M=async de=>{r([]),n(""),g(!0),v(null);try{const Se=await pe(`/api/queue/patient/${de.id}/latest`);if(Se.ok){const re=await Se.json();if(re!=null&&re._id){if(re!=null&&re._id){le(`/dashboard/edit-complaint/${re._id}`,{state:{patientId:de.id}}),g(!1);return}g(!1);return}}else if(Se.status!==404){const re=await Se.text();throw new Error(`Failed to fetch queue entry: ${re||Se.statusText} (${Se.status})`)}const fe=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:de.id})});if(!fe.ok){const re=await fe.text();throw new Error(`Failed to create queue entry: ${re||fe.statusText} (${fe.status})`)}const we=await fe.json();if(we!=null&&we.id)le(`/dashboard/edit-complaint/${we.id}`,{state:{patientId:de.id}});else throw new Error("Failed to get ID from new queue entry.")}catch(Se){console.error("Error processing patient selection:",Se),v(Se.message||"An error occurred while processing the selection.")}finally{g(!1)}};return i.jsxs("div",{className:"patient-search-page-container",children:[i.jsxs("div",{className:"patient-search-header",children:[i.jsx("button",{onClick:()=>le("/dashboard/queue"),className:"patient-search-button patient-search-button-primary",children:"OPD Queue"}),i.jsxs("button",{onClick:()=>le(-1),className:"patient-search-button patient-search-button-back",children:[i.jsx(Lt,{size:16}),"Back"]})]}),i.jsxs("div",{className:"patient-search-content-box",children:[u&&i.jsx("p",{className:"patient-search-error",children:u}),b&&i.jsx("p",{className:"patient-search-error",children:b}),T&&i.jsx("p",{className:"patient-search-error",children:T})]}),!e&&a.length>0&&i.jsxs("div",{className:"recent-patients-section",children:[i.jsx("div",{className:"recent-patients-grid",children:a.map(de=>i.jsxs("div",{onClick:()=>M(de),className:"recent-patient-card",children:[i.jsxs("div",{className:"recent-patient-info",children:[i.jsx("span",{className:"recent-patient-name",children:de.name}),i.jsxs("span",{className:"recent-patient-details",children:[de.age?`${de.age} yrs`:"",de.age&&de.gender?" / ":"",de.gender||""]})]}),i.jsxs("div",{className:"recent-patient-token",children:["#",de.token]})]},de.id))}),i.jsx("h2",{className:"recent-patients-title",children:"Newly Registered"})]}),i.jsxs("div",{className:"sticky-chat-input-box",children:[t.length>0&&!h&&!N&&i.jsx("ul",{className:"patient-search-results-list",children:t.map(de=>i.jsxs("li",{onClick:()=>M(de),className:"patient-search-result-item",children:[i.jsxs("div",{className:"patient-search-result-item-name-container",children:[i.jsxs("span",{className:"patient-search-result-item-token",children:["[#",de.token,"]"]}),i.jsx("span",{className:"patient-search-result-item-name",children:de.name})]}),i.jsxs("div",{className:"patient-search-result-item-details",children:[de.age?`${de.age} yrs`:"",de.age&&de.gender?" / ":"",de.gender||"N/A"]})]},de.id))}),e.length>=2&&!o&&t.length===0&&!u&&!h&&i.jsxs("p",{className:"patient-search-no-results",children:['No patients found matching, taking new case: "',e,'".']}),i.jsxs("div",{className:"chat-input-controls",children:[i.jsx("textarea",{ref:I,placeholder:"Search by Name/Phone/Token or Enter New Case: Name, Age, Sex, Complaint...",value:e,onChange:ae,onKeyDown:ce,className:"chat-input",autoFocus:!0,disabled:h||N,rows:1}),i.jsx("button",{onClick:e.trim()?()=>J(e):ne,className:`chat-submit-button ${N||o?"opacity-50":""}`,disabled:N||o||!!e.trim()&&!e.trim(),"aria-label":e.trim()?"Create New Case":"Use Microphone",children:N||o?i.jsxs("div",{className:"spinner-dots",children:[i.jsx("div",{}),i.jsx("div",{}),i.jsx("div",{})]}):e.trim()?i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24",children:i.jsx("path",{d:"M12 4l1.41 1.41L7.83 11H20v2H7.83l5.58 5.59L12 20l-8-8 8-8z",transform:"rotate(90 12 12)"})}):i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24",children:i.jsx("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm-1.2-9.1c0-.66.54-1.2 1.2-1.2s1.2.54 1.2 1.2V9c0 .66-.54 1.2-1.2 1.2s-1.2-.54-1.2-1.2V4.9zM17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"})})})]})]}),F&&i.jsx(fw,{options:sU,children:i.jsx(nk,{onClose:()=>$(!1),patientData:q,tokenNumber:null,onAiSummaryChange:z})}),ee&&i.jsx(rU,{onClose:()=>te(!1)})]})},lU=()=>{const e=gt(),[n,t]=w.useState({admissionCharge:"0.00",perDayCharge:"0.00",otherCharges:"0.00",aiMemory:"",clinicWideSystemPrompt:"",gemini_api_key:"",low_stock_threshold:"10",aiLanguage:"",name:"",logoUrl:"",upi_id:"",address:"",notes:""}),[r,a]=w.useState(!0),[l,o]=w.useState(!1),[f,u]=w.useState(null),[d,h]=w.useState(null);w.useEffect(()=>{(async()=>{a(!0),u(null);try{const N=await pe("/api/clinics/settings");if(!N.ok){const T=await N.json();throw new Error(T.message||"Failed to fetch clinic settings.")}const k=await N.json();t({admissionCharge:parseFloat(k.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(k.perDayCharge||0).toFixed(2),otherCharges:parseFloat(k.otherCharges||0).toFixed(2),aiMemory:k.aiMemory||"",clinicWideSystemPrompt:k.clinicWideSystemPrompt||"",gemini_api_key:k.gemini_api_key||"",low_stock_threshold:k.low_stock_threshold!==void 0&&k.low_stock_threshold!==null?String(k.low_stock_threshold):"10",aiLanguage:k.aiLanguage||"",name:k.name||"",logoUrl:k.logoUrl||"",upi_id:k.upi_id||"",address:k.address||"",notes:k.notes||""})}catch(N){console.error("Error fetching settings:",N),u(`Failed to load settings: ${N.message}`),t({admissionCharge:"0.00",perDayCharge:"0.00",otherCharges:"0.00",aiMemory:"",clinicWideSystemPrompt:"",gemini_api_key:"",low_stock_threshold:"10",aiLanguage:"",name:"Unknown Clinic",logoUrl:"",upi_id:"",address:"",notes:""})}finally{a(!1)}})()},[]);const g=v=>{const{name:N,value:k}=v.target;t(T=>({...T,[N]:k}))},b=async v=>{v.preventDefault(),u(null),h(null),o(!0);const N=parseFloat(n.admissionCharge),k=parseFloat(n.perDayCharge),T=parseFloat(n.otherCharges),E=parseInt(n.low_stock_threshold);if(isNaN(N)||N<0||isNaN(k)||k<0||isNaN(T)||T<0){u("Invalid charge amount. Please enter non-negative numbers for all fields."),o(!1);return}if(isNaN(E)||E<0){u("Invalid low stock threshold. Please enter a non-negative number."),o(!1);return}try{const I=await pe("/api/clinics/settings",{method:"PUT",body:JSON.stringify({name:n.name,admissionCharge:N,perDayCharge:k,otherCharges:T,aiMemory:n.aiMemory,clinicWideSystemPrompt:n.clinicWideSystemPrompt,gemini_api_key:n.gemini_api_key,low_stock_threshold:E,aiLanguage:n.aiLanguage,logoUrl:n.logoUrl,upi_id:n.upi_id,address:n.address,notes:n.notes})});if(!I.ok){const V=await I.json();throw new Error(V.message||"Failed to update settings.")}const P=await I.json();t({admissionCharge:parseFloat(P.settings.admissionCharge).toFixed(2),perDayCharge:parseFloat(P.settings.perDayCharge).toFixed(2),otherCharges:parseFloat(P.settings.otherCharges).toFixed(2),aiMemory:P.settings.aiMemory||"",clinicWideSystemPrompt:P.settings.clinicWideSystemPrompt||"",gemini_api_key:P.settings.gemini_api_key||"",low_stock_threshold:P.settings.low_stock_threshold!==void 0&&P.settings.low_stock_threshold!==null?String(P.settings.low_stock_threshold):"10",aiLanguage:P.settings.aiLanguage||"",name:P.settings.name||"",logoUrl:P.settings.logoUrl||"",upi_id:P.settings.upi_id||"",address:P.settings.address||"",notes:P.settings.notes||""}),h("Clinic settings updated successfully!"),setTimeout(()=>h(null),3e3)}catch(I){console.error("Error updating settings:",I),u(`Update failed: ${I.message}`)}finally{o(!1)}};return r?i.jsxs("div",{className:"loading-animation-container",children:[i.jsx("div",{className:"breathing-ball"}),i.jsx("div",{className:"loading-text",children:"Loading settings..."})]}):i.jsxs("div",{className:"clinic-settings-container",children:[i.jsxs("div",{className:"clinic-settings-header-container",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button",children:i.jsx(Lt,{size:24})}),i.jsxs("h3",{className:"clinic-settings-header",children:[i.jsx(ag,{size:24}),"Clinic Settings"]})]}),f&&i.jsx("div",{className:"clinic-settings-alert clinic-settings-alert-error",role:"alert",children:f}),d&&i.jsx("div",{className:"clinic-settings-alert clinic-settings-alert-success",role:"alert",children:d}),i.jsxs("form",{onSubmit:b,className:"clinic-settings-form",children:[i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"name",className:"clinic-settings-label",children:"Clinic Name"}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name,onChange:g,className:"clinic-settings-input",disabled:l,placeholder:"e.g., My Awesome Clinic"})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"admissionCharge",className:"clinic-settings-label",children:[i.jsx(Ad,{size:16})," Admission Charge ()"]}),i.jsx("input",{type:"number",id:"admissionCharge",name:"admissionCharge",value:n.admissionCharge,onChange:g,className:"clinic-settings-input",step:"0.01",min:"0",required:!0,disabled:l,placeholder:"e.g., 500.00"})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"perDayCharge",className:"clinic-settings-label",children:[i.jsx(Ad,{size:16})," Per Day Charge ()"]}),i.jsx("input",{type:"number",id:"perDayCharge",name:"perDayCharge",value:n.perDayCharge,onChange:g,className:"clinic-settings-input",step:"0.01",min:"0",required:!0,disabled:l,placeholder:"e.g., 1000.00"})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"otherCharges",className:"clinic-settings-label",children:[i.jsx(Ad,{size:16})," Other Charges (Default/Misc.) ()"]}),i.jsx("input",{type:"number",id:"otherCharges",name:"otherCharges",value:n.otherCharges,onChange:g,className:"clinic-settings-input",step:"0.01",min:"0",required:!0,disabled:l,placeholder:"e.g., 50.00"})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"low_stock_threshold",className:"clinic-settings-label",children:[i.jsx(pP,{size:16})," Low Stock Notification Threshold"]}),i.jsx("input",{type:"number",id:"low_stock_threshold",name:"low_stock_threshold",value:n.low_stock_threshold,onChange:g,className:"clinic-settings-input",min:"0",required:!0,disabled:l,placeholder:"e.g., 10"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Set the minimum quantity of a drug to trigger a low stock notification."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"aiMemory",className:"clinic-settings-label",children:[i.jsx(zv,{size:16})," AI Memory (Plain Text)"]}),i.jsx("textarea",{id:"aiMemory",name:"aiMemory",value:n.aiMemory,onChange:g,className:"clinic-settings-textarea",disabled:l,placeholder:"Enter any clinic-wide notes or context for the AI..."}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter clinic-wide AI memory data as plain text."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"clinicWideSystemPrompt",className:"clinic-settings-label",children:[i.jsx(uI,{size:16})," Clinic-Wide AI System Prompt"]}),i.jsx("textarea",{id:"clinicWideSystemPrompt",name:"clinicWideSystemPrompt",value:n.clinicWideSystemPrompt,onChange:g,className:"clinic-settings-textarea",disabled:l,placeholder:"Enter the system prompt for the AI that will apply to all interactions within this clinic..."}),i.jsx("p",{className:"clinic-settings-help-text",children:"This prompt will be used as the base instruction for the AI across the clinic."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"aiLanguage",className:"clinic-settings-label",children:"AI Language"}),i.jsxs("select",{id:"aiLanguage",name:"aiLanguage",value:n.aiLanguage,onChange:g,className:"clinic-settings-input",disabled:l,children:[i.jsx("option",{value:"",children:"Select Language"}),i.jsx("option",{value:"English",children:"English"}),i.jsx("option",{value:"Hindi",children:"Hindi"}),i.jsx("option",{value:"Telugu",children:"Telugu"}),i.jsx("option",{value:"Tamil",children:"Tamil"}),i.jsx("option",{value:"Kannada",children:"Kannada"}),i.jsx("option",{value:"Malayalam",children:"Malayalam"}),i.jsx("option",{value:"Bengali",children:"Bengali"}),i.jsx("option",{value:"Gujarati",children:"Gujarati"}),i.jsx("option",{value:"Marathi",children:"Marathi"}),i.jsx("option",{value:"Punjabi",children:"Punjabi"})]}),i.jsx("p",{className:"clinic-settings-help-text",children:"Specify the language for AI interactions."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"logoUrl",className:"clinic-settings-label",children:"Clinic Logo URL"}),i.jsx("input",{type:"url",id:"logoUrl",name:"logoUrl",value:n.logoUrl,onChange:g,className:"clinic-settings-input",disabled:l,placeholder:"e.g., https://example.com/logo.png"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter the URL for your clinic's logo."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"upi_id",className:"clinic-settings-label",children:"UPI ID"}),i.jsx("input",{type:"text",id:"upi_id",name:"upi_id",value:n.upi_id,onChange:g,className:"clinic-settings-input",disabled:l,placeholder:"e.g., yourclinic@upi"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter your clinic's UPI ID for payments."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"address",className:"clinic-settings-label",children:"Clinic Address"}),i.jsx("textarea",{id:"address",name:"address",value:n.address,onChange:g,className:"clinic-settings-textarea",disabled:l,placeholder:"Enter your clinic's full address"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter the physical address of your clinic."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"notes",className:"clinic-settings-label",children:"Other Clinic Details/Notes"}),i.jsx("textarea",{id:"notes",name:"notes",value:n.notes,onChange:g,className:"clinic-settings-textarea",disabled:l,placeholder:"Enter any other relevant clinic details or notes"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Add any additional information or notes about your clinic."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"gemini_api_key",className:"clinic-settings-label",children:[i.jsx(zv,{size:16})," Gemini API Key"]}),i.jsx("input",{type:"text",id:"gemini_api_key",name:"gemini_api_key",value:n.gemini_api_key,onChange:g,className:"clinic-settings-input",disabled:l,placeholder:"Enter your Gemini API key"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter your Gemini API key to enable AI features."})]}),i.jsx("div",{className:"clinic-settings-button-container",children:i.jsxs("button",{type:"submit",className:"clinic-settings-button",disabled:l,children:[i.jsx(Id,{size:18})," ",l?"Saving...":"Save Settings"]})})]})]})},oU=({})=>{const e=gt(),[n,t]=w.useState("patientSearch"),[r]=w.useState(!1),[a,l]=w.useState(null),[o,f]=w.useState(null);return w.useEffect(()=>{if(o){const u=setTimeout(()=>f(null),5e3);return()=>clearTimeout(u)}},[o]),r?i.jsxs("div",{className:"loading-animation-container",children:[" ",i.jsx("div",{className:"breathing-ball"}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Admin Panel..."})]}):i.jsxs("div",{className:"admin-panel-container",children:[" ",o&&i.jsxs("div",{className:`alert-box ${o.type==="success"?"alert-box-success":"alert-box-error"} fixed top-4 right-4 z-[100]`,role:"alert",children:[i.jsx("div",{className:"alert-box-icon",children:o.type==="success"?i.jsx(Ra,{size:18}):i.jsx(ti,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{children:o.message})}),i.jsx("button",{onClick:()=>f(null),className:"alert-box-close",children:i.jsx(Qn,{size:16})})]}),a&&i.jsxs("div",{className:"alert-box alert-box-error mb-4",role:"alert",children:[" ",i.jsx("div",{className:"alert-box-icon",children:i.jsx(ti,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{className:"block sm:inline flex-1",children:a})}),i.jsx("button",{onClick:()=>l(null),className:"alert-box-close",children:i.jsx(Qn,{size:16})})]}),i.jsxs("div",{className:"admin-nav-bar",children:[" ",i.jsxs("button",{onClick:()=>window.location.reload(),className:"admin-nav-button",title:"Refresh Page",children:[i.jsx(E_,{})," "]}),i.jsxs("button",{onClick:()=>e("/dashboard/staff"),className:"admin-nav-button",children:[i.jsx(kh,{})," Staff"]}),i.jsx("button",{onClick:()=>t("moneyFlow"),className:`admin-nav-button ${n==="moneyFlow"?"active":""}`,children:"Money"}),i.jsx("button",{onClick:()=>t("inventory"),className:`admin-nav-button ${n==="inventory"?"active":""}`,children:"Inventory"}),i.jsx("button",{onClick:()=>e("/lab-inventory"),className:"admin-nav-button hidden-button",children:"Lab Inventory"}),i.jsxs("button",{onClick:()=>t("clinicSettings"),className:`admin-nav-button ${n==="clinicSettings"?"active":""}`,children:[i.jsx(ag,{})," Settings"]}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions"),className:"admin-nav-button hidden-button",children:[i.jsx(j_,{})," Patient Subscriptions"]}),i.jsxs("button",{onClick:()=>e("/dashboard/add-pharmacy-order"),className:"admin-nav-button",children:[i.jsx(To,{})," Order Meds"]}),i.jsx("button",{onClick:()=>e("/dashboard/recurring-medications"),className:"admin-nav-button",children:"Daily Meds"}),i.jsxs("button",{onClick:()=>e("/create-lab-order"),className:"admin-nav-button",children:[i.jsx(C_,{})," Order Tests"]}),i.jsxs("button",{onClick:()=>e("/dashboard/patients"),className:"admin-nav-button",children:[i.jsx(kh,{})," All Patients"]})]}),i.jsxs("div",{className:"space-y-6",children:[" ",n==="patientSearch"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(vh,{})}),n==="moneyFlow"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(qM,{})}),n==="inventory"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(qv,{})}),n==="clinicSettings"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(lU,{})})]})]})},Lc=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},cU=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},fh=({title:e,icon:n,items:t,renderItemContent:r,isLoading:a,loadingText:l,noDataText:o})=>{const f=w.useMemo(()=>{const u={};t.forEach(h=>{if(isNaN(h.date.getTime())){u["Unknown Date"]||(u["Unknown Date"]=[]),u["Unknown Date"].push(h);return}const g=cU(h.originalDateString);u[g]||(u[g]=[]),u[g].push(h)});const d=Object.keys(u);return d.sort((h,g)=>{if(h==="Unknown Date")return 1;if(g==="Unknown Date")return-1;try{const b=k=>{const T=k.split(" ");if(T.length===3){const I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(T[1]);if(I!==-1)return new Date(parseInt(T[2]),I,parseInt(T[0]))}return new Date(k)},v=b(h),N=b(g);if(!isNaN(v.getTime())&&!isNaN(N.getTime()))return N.getTime()-v.getTime()}catch(b){console.error("Error parsing date for sorting:",b)}return g.localeCompare(h)}),d.map(h=>({date:h,items:u[h]}))},[t]);return i.jsxs("div",{className:"mb-2 p-2 bg-gray-50 rounded-md border border-gray-200",children:[i.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-1.5 border-b border-gray-300 pb-1 flex items-center",children:[" ",n&&i.jsx(n,{size:14,className:"mr-1.5 text-indigo-600"})," ",e]}),a&&i.jsx("p",{className:"text-gray-500 italic text-xs px-1",children:l}),!a&&t.length===0&&i.jsx("p",{className:"text-gray-500 italic text-xs px-1",children:o}),!a&&t.length>0&&i.jsxs("div",{className:"space-y-2",children:[" ",f.map(({date:u,items:d})=>i.jsxs("div",{className:"pl-0.5",children:[" ",i.jsxs("h5",{className:"text-[11px] font-medium text-indigo-700 mb-1 bg-indigo-50 px-1 py-0.5 rounded-sm inline-block",children:[" ",u]}),i.jsx("div",{className:"space-y-1 pl-1.5 border-l-2 border-indigo-200 ml-0.5",children:d.map((h,g)=>i.jsxs("div",{className:"text-xs py-0 flex items-start",children:[" ",i.jsx("div",{className:"flex-grow mr-1",children:r(h)})," "]},`${h.type}-${h.originalDateString}-${g}`))})]},u))]})]})},nv=()=>{var le,K;const[e,n]=w.useState({currentPatient:null,nextPatient:null,waitingCount:0}),[t,r]=w.useState(!0),[a,l]=w.useState(null),[o,f]=w.useState(null),[u,d]=w.useState(null),[h,g]=w.useState(null),[b,v]=w.useState({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),[N,k]=w.useState(!1),[T,E]=w.useState(null),{patientId:I}=jr(),P=gt(),V=w.useCallback(async U=>{g(null),f(null),d(null),k(!0),E(null),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]});try{const J=await pe(`/api/patients/${U}`);if(!J.ok)throw new Error(`Patient details fetch failed (${J.status})`);const ne=await J.json();f(ne);const A=await pe(`/api/queue/patient/${U}/latest`);if(!A.ok&&A.status!==404)throw new Error(`Queue entry fetch failed (${A.status})`);if(A.ok){const ae=await A.json();d(ae)}await F(U)}catch(J){console.error("Error fetching specific patient data:",J),g(J.message||"Failed to load patient data."),E(J.message||"Failed to load patient history.")}finally{k(!1)}},[]),F=w.useCallback(async U=>{k(!0),E(null);try{const[J,ne,A,ae]=await Promise.all([pe(`/api/queue/patient/${U}/complaints`),pe(`/api/lab/patient/${U}`),pe(`/api/lab/orders/patient/${U}?status=pending`),pe(`/api/pharmacy-orders/patient/${U}`)]),ce=J.ok?await J.json():[],M=ne.ok?await ne.json():[],de=A.ok?await A.json():[],Se=ae.ok?await ae.json():[];v({pastComplaints:ce||[],labReports:M||[],pendingLabOrders:de||[],pharmacyOrders:Se||[]})}catch(J){console.error("Error fetching patient history:",J),E(J.message||"Failed to load patient history."),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]})}finally{k(!1)}},[]),$=w.useCallback(async()=>{r(!0),l(null);try{const U=await pe("/api/queue/doctor");if(!U.ok){const ne=await U.text();throw new Error(`API Error (${U.status}): ${ne||U.statusText}`)}const J=await U.json();if(J===null||typeof J!="object"||typeof J.waitingCount!="number")throw console.error("Invalid queue data format:",J),new Error("Invalid queue data format received");n({currentPatient:J.currentPatient||null,nextPatient:J.nextPatient||null,waitingCount:J.waitingCount})}catch(U){console.error("Error fetching queue data:",U),l(U.message||"Failed to fetch queue data.")}finally{r(!1)}},[]);w.useEffect(()=>{let U=null;return I?(V(I),n({currentPatient:null,nextPatient:null,waitingCount:0})):($(),U=setInterval($,1e4),f(null),d(null)),()=>{U&&clearInterval(U)}},[I,V,$]),w.useEffect(()=>{var U;!I&&((U=e.currentPatient)!=null&&U.patientId)?F(e.currentPatient.patientId):!I&&!e.currentPatient&&(v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),E(null))},[I,(le=e.currentPatient)==null?void 0:le.patientId,F]);const B=((K=e.currentPatient)==null?void 0:K.patientId)||(I?parseInt(I,10):null),z=w.useMemo(()=>{if(!B||!b.pastComplaints)return[];const U=b.pastComplaints.map(J=>({date:new Date(J.createdAt),type:"Complaint",data:J,originalDateString:J.createdAt})).filter(J=>!isNaN(J.date.getTime()));return U.sort((J,ne)=>ne.date.getTime()-J.date.getTime()),U},[B,b.pastComplaints]),q=w.useMemo(()=>{if(!B)return[];const U=[];return(b.pendingLabOrders??[]).forEach(J=>{const ne=new Date(J.createdAt);isNaN(ne.getTime())||U.push({date:ne,type:"Lab Order (Pending)",data:J,originalDateString:J.createdAt})}),(b.labReports??[]).forEach(J=>{const ne=J.reportCreatedAt?new Date(J.reportCreatedAt):null;ne&&!isNaN(ne.getTime())&&U.push({date:ne,type:"Lab Report",data:J,originalDateString:J.reportCreatedAt})}),U.sort((J,ne)=>ne.date.getTime()-J.date.getTime()),U},[B,b.pendingLabOrders,b.labReports]),O=w.useMemo(()=>{if(!B||!b.pharmacyOrders)return[];const U=b.pharmacyOrders.map(J=>({date:new Date(J.date),type:"Pharmacy Order",data:J,originalDateString:J.date})).filter(J=>!isNaN(J.date.getTime()));return U.sort((J,ne)=>ne.date.getTime()-J.date.getTime()),U},[B,b.pharmacyOrders]),R=async()=>{r(!0),l(null);try{await pe("/api/queue/doctor/next",{method:"POST"}),await $()}catch(U){console.error("Error calling next patient:",U),l(U.message||"Failed to call next patient.")}finally{r(!1)}},G=async()=>{if(!(!e.currentPatient||I)){r(!0),l(null);try{await pe(`/api/queue/doctor/complete/${e.currentPatient._id}`,{method:"POST"}),await $(),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),E(null)}catch(U){console.error("Error completing consultation:",U),l(U.message||"Failed to complete consultation.")}finally{r(!1)}}},ee=U=>{switch(U){case"waiting":return"Waiting";case"consulting":return"Consulting";case"seen":return"Seen";case"cancelled":return"Cancelled";default:return U}};let te=null;return e.currentPatient&&(te=i.jsxs("div",{className:"patient-info-section bg-white rounded-lg shadow-md p-4 md:p-6 border-l-8 border-teal-500",children:[i.jsx("h2",{className:"text-xl text-teal-700 font-semibold mb-3",children:"NOW SEEING:"}),i.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[i.jsxs("div",{className:"flex-grow md:w-1/2",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{className:"flex-grow mr-4",children:[i.jsx("div",{className:"text-3xl md:text-4xl font-bold text-gray-800 mb-1",children:e.currentPatient.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-600",children:[i.jsx("span",{className:"font-bold",children:e.currentPatient.age})," | ",i.jsx("span",{className:"font-bold",children:e.currentPatient.gender})]})]}),i.jsxs("div",{className:"text-right flex-shrink-0",children:[i.jsx("div",{className:"text-2xl md:text-3xl font-bold text-gray-700 mb-1",children:e.currentPatient.token}),i.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-sm md:text-base font-medium ${e.currentPatient.status==="consulting"?"bg-teal-100 text-teal-800":"bg-gray-100 text-gray-800"}`,children:ee(e.currentPatient.status)})]})]}),i.jsxs("div",{className:"actions-section mt-4 md:mt-6 flex justify-end space-x-3 border-t pt-4",children:[i.jsx("button",{onClick:()=>{var J;const U=(J=e.currentPatient)==null?void 0:J._id;U&&P(`/dashboard/edit-complaint/${U}`)},disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:"Edit Complaint / AI"}),i.jsx("button",{onClick:G,disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-success disabled:opacity-50 disabled:cursor-not-allowed",children:"Complete Consultation"})]})]})," ",i.jsxs("div",{className:"complaint-section md:w-1/2 mt-4 md:mt-0 border-t md:border-t-0 md:border-l md:pl-6 pt-4 md:pt-0",children:[i.jsx("h3",{className:"text-base font-semibold text-gray-800 mb-2",children:"Context & History:"}),T&&i.jsx("p",{className:"text-red-500 text-xs mb-2",children:T}),i.jsxs("div",{className:"space-y-2 pr-2",children:[i.jsx(fh,{title:"Complaints History",icon:rs,items:z,isLoading:N,loadingText:"Loading complaints...",noDataText:"No past complaints found.",renderItemContent:U=>i.jsxs("span",{className:"block text-xs",children:[U.data.complaint,i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Lc(U.originalDateString),")"]})]})}),i.jsx(fh,{title:"Lab History (Orders & Reports)",icon:Gx,items:q,isLoading:N,loadingText:"Loading lab history...",noDataText:"No lab history found.",renderItemContent:U=>U.type==="Lab Order (Pending)"?i.jsxs("span",{className:"flex items-start text-xs",children:[i.jsx(gS,{size:12,className:"mr-1.5 mt-0.5 text-blue-600 flex-shrink-0"}),i.jsxs("span",{className:"block",children:[i.jsx("span",{className:"font-medium text-blue-700",children:"Order:"})," ",U.data.tests.map(J=>J.name).join(", ")," ",i.jsxs("span",{className:"text-gray-600",children:["(",U.data.status,")"]}),i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Lc(U.originalDateString),")"]})]})]}):i.jsxs("span",{className:"flex items-start text-xs",children:[i.jsx(yS,{size:12,className:"mr-1.5 mt-0.5 text-green-600 flex-shrink-0"}),i.jsxs("span",{className:"block",children:[i.jsx("span",{className:"font-medium text-green-700",children:"Report:"})," ",U.data.testName," - ",U.data.reportFindings.substring(0,50),U.data.reportFindings.length>50?"...":"",i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Lc(U.originalDateString),")"]})]})]})}),i.jsx(fh,{title:"Pharmacy Order History",icon:Pd,items:O,isLoading:N,loadingText:"Loading pharmacy orders...",noDataText:"No pharmacy order history found.",renderItemContent:U=>i.jsxs("span",{className:"block text-xs",children:[U.data.medications.map(J=>`${J.name} (Qty: ${J.quantity})`).join(", ")," ",i.jsxs("span",{className:"text-gray-600",children:["(",U.data.status,")"]}),i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Lc(U.originalDateString),")"]})]})}),z.length===0&&q.length===0&&O.length===0&&!N&&i.jsx("p",{className:"text-gray-500 italic text-xs mt-2 px-1",children:"No history found for this patient."})]})," "]})," "]})," "]})),i.jsx(i.Fragment,{children:i.jsxs("div",{className:"doctor-screen-container flex-grow flex flex-col space-y-6 md:space-y-8",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("button",{onClick:()=>P(-1),className:"back-button mr-4",children:i.jsx(Lt,{size:24})}),i.jsx("h1",{className:"doctor-screen-header",children:"Doctor Consultation Panel"})]}),I?i.jsxs(i.Fragment,{children:[h&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:h}),o&&i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border-l-8 border-purple-500",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"text-xl text-purple-700 font-semibold",children:"Patient Record:"}),i.jsx("button",{onClick:()=>P("/dashboard/doctor"),className:"text-sm text-blue-600 hover:underline",children:"Back to Queue"})]}),i.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-1 md:mb-2",children:o.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-600 mb-3 md:mb-4",children:["Age: ",o.age??"N/A"," | ",o.gender??"N/A"]}),i.jsxs("div",{className:"mt-3 md:mt-4 p-3 bg-gray-50 rounded border border-gray-200",children:[i.jsx("label",{className:"font-medium block mb-1 text-sm text-gray-600",children:"Latest Queue Entry:"}),u?i.jsxs("div",{className:"space-y-2",children:[" ",i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("span",{className:"text-sm flex-1 break-words",children:[i.jsxs("span",{className:"font-medium text-gray-700",children:["(",u.age," / ",u.gender,")"]}),": ",u.complaint||i.jsx("span",{className:"text-gray-400 italic",children:"No complaint"}),i.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full text-xs font-medium ${u.status==="consulting"?"bg-teal-100 text-teal-800":u.status==="seen"?"bg-green-100 text-green-800":u.status==="waiting"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:ee(u.status)})]}),u.status==="consulting"&&u._id&&i.jsx("button",{onClick:()=>P(`/dashboard/edit-complaint/${u._id}`),className:"ml-4 px-2 py-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 rounded flex-shrink-0",children:"Edit"})]}),u.case_summary&&i.jsxs("p",{className:"text-xs text-gray-700 bg-yellow-50 p-2 rounded border border-yellow-200",children:[i.jsx("span",{className:"font-semibold text-gray-800",children:"AI Summary:"})," ",u.case_summary]})]}):i.jsx("p",{className:"text-gray-500 italic text-sm",children:"No queue entry found for this patient today."})]}),i.jsxs("div",{className:"mt-4 border-t pt-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Patient History:"}),T&&i.jsx("p",{className:"text-red-500 text-xs mb-2",children:T}),i.jsx(fh,{title:"Complaints History",icon:rs,items:z,isLoading:N,loadingText:"Loading complaints...",noDataText:"No past complaints found.",renderItemContent:U=>i.jsxs("span",{className:"block text-xs",children:[" ",U.data.complaint,i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Lc(U.originalDateString),")"]})]})}),i.jsx(fh,{title:"Lab History (Orders & Reports)",icon:Gx,items:q,isLoading:N,loadingText:"Loading lab history...",noDataText:"No lab history found.",renderItemContent:U=>U.type==="Lab Order (Pending)"?i.jsxs("span",{className:"flex items-start text-xs",children:[" ",i.jsx(gS,{size:12,className:"mr-1.5 mt-0.5 text-blue-600 flex-shrink-0"})," ",i.jsxs("span",{className:"block",children:[i.jsx("span",{className:"font-medium text-blue-700",children:"Order:"})," ",U.data.tests.map(J=>J.name).join(", ")," ",i.jsxs("span",{className:"text-gray-600",children:["(",U.data.status,")"]}),i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Lc(U.originalDateString),")"]})]})]}):i.jsxs("span",{className:"flex items-start text-xs",children:[" ",i.jsx(yS,{size:12,className:"mr-1.5 mt-0.5 text-green-600 flex-shrink-0"})," ",i.jsxs("span",{className:"block",children:[i.jsx("span",{className:"font-medium text-green-700",children:"Report:"})," ",U.data.testName," - ",U.data.reportFindings.substring(0,50),U.data.reportFindings.length>50?"...":"",i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Lc(U.originalDateString),")"]})]})]})}),i.jsx(fh,{title:"Pharmacy Order History",icon:Pd,items:O,isLoading:N,loadingText:"Loading pharmacy orders...",noDataText:"No pharmacy order history found.",renderItemContent:U=>i.jsxs("span",{className:"block text-xs",children:[" ",U.data.medications.map(J=>`${J.name} (Qty: ${J.quantity})`).join(", ")," ",i.jsxs("span",{className:"text-gray-600",children:["(",U.data.status,")"]}),i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Lc(U.originalDateString),")"]})]})}),z.length===0&&q.length===0&&O.length===0&&!N&&i.jsx("p",{className:"text-gray-500 italic text-sm mt-2",children:"No history found."})]})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex justify-end space-x-3 mb-4",children:[i.jsxs("button",{onClick:()=>P("/dashboard/add-patient"),className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded shadow flex items-center",children:[i.jsx(I_,{size:18,className:"mr-2"})," Add Patient"]}),i.jsx("button",{onClick:()=>P("/search-patient"),className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded shadow",children:"Search Patient"})]}),a&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:a}),t&&!e.currentPatient&&i.jsx("p",{className:"text-gray-500 p-4 text-center",children:"Loading queue..."}),i.jsx("div",{className:"mb-6 md:mb-8",children:te||i.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 text-center text-gray-500",children:"No patient currently being seen. Use 'Call Next' or search for a patient record."})}),i.jsxs("div",{className:"current-queue-section mb-6 md:mb-8",children:[i.jsx("h2",{className:"text-xl text-blue-700 font-semibold mb-3 md:mb-4",children:"NEXT IN QUEUE:"}),e.nextPatient?i.jsxs("div",{className:"patient-info-section bg-blue-50 rounded-lg shadow-md p-5 md:p-6 border-l-8 border-blue-500",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 md:mb-4",children:[i.jsxs("span",{className:"text-2xl md:text-3xl font-bold text-blue-800 mb-2 sm:mb-0",children:["Token #",e.nextPatient.token]}),i.jsx("span",{className:`px-3 py-1 rounded-full text-sm md:text-base font-medium ${e.nextPatient.status==="waiting"?"bg-blue-200 text-blue-900":"bg-gray-200 text-gray-800"}`,children:ee(e.nextPatient.status)})]}),i.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-2 md:mb-3",children:e.nextPatient.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-700 mb-3 md:mb-4",children:["Age: ",e.nextPatient.age," | ",e.nextPatient.gender]}),(e.nextPatient.complaint||e.nextPatient.case_summary)&&i.jsxs("div",{className:"mt-3 md:mt-4 pt-3 border-t border-blue-200 space-y-2",children:[e.nextPatient.complaint&&i.jsxs("p",{className:"text-base md:text-lg text-gray-800",children:[i.jsx("span",{className:"font-semibold text-gray-900",children:"Complaint:"})," ",e.nextPatient.complaint]}),e.nextPatient.case_summary&&i.jsxs("p",{className:"text-sm text-gray-700 bg-yellow-50 p-2 rounded border border-yellow-200",children:[i.jsx("span",{className:"font-semibold text-gray-800",children:"AI Summary:"})," ",e.nextPatient.case_summary]})]})]}):i.jsx("div",{className:"bg-gray-50 rounded-lg shadow-inner p-6 text-center text-gray-600 border border-gray-200",children:"No patient waiting next in the queue."})]}),i.jsxs("div",{className:"actions-section mt-auto pt-4 md:pt-6 flex flex-col sm:flex-row justify-between items-center gap-4",children:[i.jsx("button",{onClick:R,disabled:t||!e.nextPatient||!!e.currentPatient,className:"btn btn-primary w-full sm:w-auto disabled:opacity-50 disabled:cursor-not-allowed order-1 sm:order-none",children:"Call Next Patient"}),i.jsx("div",{className:"bg-gray-200 inline-block px-4 py-2 rounded-full order-2 sm:order-none",children:i.jsxs("span",{className:"text-base md:text-lg font-medium",children:[e.waitingCount," patients waiting"]})})]})]})]})})},ik=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,l]=w.useState(null),[o,f]=w.useState(null),[u,d]=w.useState(null),[h,g]=w.useState(null),[b,v]=w.useState(!1),[N,k]=w.useState(!1),[T,E]=w.useState(null),I=gt(),P=w.useCallback(ek.debounce(async O=>{if(O.trim().length<2){r([]),k(!1);return}k(!0),E(null);try{const R=new URLSearchParams({search:encodeURIComponent(O),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),G=await pe(`/api/patients?${R.toString()}`);if(!G.ok){const te=await G.text();throw new Error(`API Error (${G.status}): ${te||G.statusText||"Failed to fetch patients"}`)}const ee=await G.json();r(ee.patients)}catch(R){E(R instanceof Error?R.message:"An unknown error occurred while searching patients"),r([])}finally{k(!1)}},500),[]);w.useEffect(()=>(e?(k(!0),P(e)):(r([]),P.cancel()),()=>{P.cancel()}),[e,P]);const V=O=>{l(O),n(""),r([]),E(null),f(null),d(null),g(null),v(!1)},F=async()=>{if(!a){E("No patient selected.");return}E(null),k(!0);try{const O=await pe(`/api/patients/${a.id}/admit`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!O.ok){const G=await O.json().catch(()=>({message:"Failed to admit patient"}));throw new Error(G.message||"Failed to admit patient")}const R=await O.json();alert(R.message||"Patient admitted successfully!"),R.bill&&R.bill.id?I(`/patient/${a.id}/admission-bill/${R.bill.id}`):(console.error("Admission successful, but bill ID missing in response."),E("Admission successful, but couldn't navigate to billing."),l(R.patient))}catch(O){E(O instanceof Error?O.message:"Failed to admit patient")}finally{k(!1)}};w.useEffect(()=>{(async()=>{if(!a||!a.admission_date||a.discharge_date){f(null),g(null);return}v(!0),d(null),f(null),g(null);try{const R=await pe(`/api/patients/${a.id}/active-bill?type=admission`);if(!R.ok)throw R.status===404?new Error("No active admission bill found."):new Error("Failed to fetch active bill ID.");const G=await R.json(),ee=G==null?void 0:G.id;if(!ee)throw new Error("Active admission bill ID not found in response.");f(ee);const te=await pe(`/api/bills/${ee}`);if(!te.ok)throw new Error(`Failed to fetch bill details (ID: ${ee}). Status: ${te.status}`);const le=await te.json();if(le&&le.calculated)g(le.calculated);else throw console.error("Fetched bill details missing 'calculated' object:",le),new Error("Fetched bill details are incomplete (missing calculated data).")}catch(R){d(R instanceof Error?R.message:"An unknown error occurred while fetching bill details."),f(null),g(null)}finally{v(!1)}})()},[a]);const $=async()=>{if(!a){E("No patient selected.");return}if(!a.admission_date||a.discharge_date){E("Patient is not currently admitted.");return}E(null),k(!0);try{const O=await pe(`/api/patients/${a.id}/discharge`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!O.ok){const G=await O.json().catch(()=>({message:"Failed to discharge patient"}));throw new Error(G.message||"Failed to discharge patient")}const R=await O.json();alert(R.message||"Patient discharged successfully!"),R.patient?l(R.patient):(console.error("Discharge successful, but updated patient info missing in response."),l(null),E("Discharge successful, but couldn't update patient details locally."))}catch(O){E(O instanceof Error?O.message:"Failed to discharge patient")}finally{k(!1)}},B=()=>{if(!a||!o){E("Cannot navigate to billing: Patient or Bill ID missing.");return}I(`/patient/${a.id}/admission-bill/${o}`)};let z="",q=null;if(a){const O=a.admission_date?new Date(a.admission_date).toLocaleDateString():null,R=a.discharge_date?new Date(a.discharge_date).toLocaleDateString():null;a.admission_date?a.admission_date&&!a.discharge_date?(z=`Patient admitted on: ${O}`,q=i.jsxs("div",{className:"space-y-4",children:[" ",b&&i.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Loading billing details..."})," ",u&&i.jsx("p",{className:"text-sm text-red-500 text-center",children:u})," ",!b&&h&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Total Due:"}),i.jsxs("span",{children:["",(Number(h.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[" ",i.jsx("span",{children:"Total Paid:"}),i.jsxs("span",{children:["",(Number(h.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm font-bold mt-1 text-red-600",children:[" ",i.jsx("span",{children:"Balance Due:"}),i.jsxs("span",{children:["",(Number(h.balance)||0).toFixed(2)]})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("button",{onClick:B,disabled:N||b||!o,className:`admission-button admission-button-secondary ${N||b||!o?"opacity-50 cursor-not-allowed":""}`,children:b?"Loading Bill...":!o&&!u?"Finding Bill...":"Pay Bill / View Details"}),i.jsx("button",{onClick:$,disabled:N||b,className:`admission-button admission-button-danger ${N||b?"opacity-50 cursor-not-allowed":""}`,children:N?"Processing...":"Discharge Patient"})]})]})):(z=`Patient admitted on ${O} and discharged on ${R}.`,q=i.jsx("p",{className:"text-center text-gray-600 italic",children:"Patient has been discharged."})):(z="Patient is not admitted.",q=i.jsx("button",{onClick:F,disabled:N,className:`admission-button ${N?"opacity-50 cursor-not-allowed":""}`,children:N?"Processing...":"Admit Patient"}))}return i.jsxs("div",{className:"admission-page-container",children:[i.jsxs("div",{className:"admission-header-container",children:[i.jsxs("button",{onClick:()=>I(-1),className:"back-button",children:[i.jsx(Lt,{size:16}),"Back"]}),i.jsx("h1",{className:"admission-header",children:"Manage Admission/Discharge"})]}),i.jsxs("div",{className:"admission-section mb-6 relative",children:[i.jsx("label",{htmlFor:"patientSearch",className:"admission-label",children:"Search Patient (Name, Phone, or Token)"}),i.jsx("input",{type:"text",id:"patientSearch",value:e,onChange:O=>n(O.target.value),placeholder:"Start typing to search...",className:"admission-input"}),N&&!a&&i.jsx("div",{className:"absolute right-3 top-9 text-sm text-gray-500",children:"Loading..."})," ",t.length>0&&!a&&i.jsxs("ul",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[" ",t.map(O=>i.jsxs("li",{onClick:()=>V(O),className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",children:[" ",O.name," (Token: ",O.token,")",i.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[O.admission_date?`Admitted: ${new Date(O.admission_date).toLocaleDateString()}`:"Not Admitted",O.discharge_date?`, Discharged: ${new Date(O.discharge_date).toLocaleDateString()}`:""]})]},O.id))]}),t.length===0&&e&&!N&&!a&&i.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg p-4 text-gray-500",children:['No patients found matching "',e,'".']})]}),a&&i.jsxs("div",{className:"admission-section",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"admission-section-title",children:"Selected Patient"}),i.jsx("button",{onClick:()=>l(null),className:"admission-link",children:"Clear Selection"})]}),i.jsxs("div",{className:"admission-card-content mb-4 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",a.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Token:"})," ",a.token]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Age:"})," ",a.age??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Gender:"})," ",a.gender??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Phone:"})," ",a.phone??"N/A"]}),i.jsxs("p",{className:"col-span-2",children:[i.jsx("strong",{children:"Address:"})," ",a.address??"N/A"]})]}),i.jsx("hr",{className:"my-4"}),i.jsx("p",{className:"text-sm text-gray-600 mb-3",children:z})," ",T&&i.jsx("p",{className:"text-red-500 text-sm mb-3",children:T})," ",q]})]})},iv=15,o1=()=>{const e=gt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[l,o]=w.useState(null),[f,u]=w.useState(""),[d,h]=w.useState(1),[g,b]=w.useState(1),[v,N]=w.useState(0),[k,T]=w.useState("created_at"),[E,I]=w.useState("desc"),[P,V]=w.useState(""),[F,$]=w.useState(!1),[B,z]=w.useState(null),[q,O]=w.useState([]),[R,G]=w.useState(""),[ee,te]=w.useState(!1),[le,K]=w.useState(null),[U,J]=w.useState(null),[ne,A]=w.useState(!0),[ae,ce]=w.useState(null),[M,de]=w.useState(f);w.useEffect(()=>{const xe=setTimeout(()=>{de(f),h(1)},500);return()=>{clearTimeout(xe)}},[f]);const Se=w.useCallback(async()=>{A(!0),ce(null);try{const xe=await pe("/api/subscriptions");if(!xe.ok){let ve=`Failed to fetch subscription plans (${xe.status})`;try{ve=(await xe.json()).message||ve}catch{}throw new Error(ve)}const Me=await xe.json();O(Me)}catch(xe){console.error("Error fetching subscription plans:",xe),ce(xe.message||"An unknown error occurred while fetching plans."),O([])}finally{A(!1)}},[]),fe=w.useCallback(async(xe,Me,ve,Ee,De)=>{a(!0),o(null);try{const nt=new URLSearchParams({page:xe.toString(),limit:iv.toString(),sortBy:ve,sortOrder:Ee});Me&&nt.append("search",Me),De&&nt.append("gender",De);const lt=await pe(`/api/patients?${nt.toString()}`);if(!lt.ok){const Mt=await lt.json();throw new Error(Mt.message||"Failed to fetch patients")}const Xe=await lt.json();t(Xe.patients),N(Xe.totalCount),h(Xe.currentPage),b(Xe.totalPages)}catch(nt){console.error("Error fetching patients:",nt),o(`Failed to load patients: ${nt.message}`),t([]),N(0),h(1),b(1)}finally{a(!1)}},[]);w.useEffect(()=>{fe(d,M,k,E,P),Se()},[d,M,k,E,P,fe,Se]);const we=xe=>{const Me=k===xe&&E==="asc"?"desc":"asc";T(xe),I(Me),h(1)},re=xe=>{try{return new Date(xe).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},_e=()=>{$(!1),z(null),G(""),K(null),te(!1)},qe=async(xe,Me)=>{t(ve=>ve.map(Ee=>Ee.id===xe?{...Ee,insurance_type:Me}:Ee));try{const ve=await pe(`/api/patients/${xe}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:Me})});if(!ve.ok){const Ee=await ve.json();throw new Error(Ee.message||"Failed to update insurance type")}}catch(ve){console.error("Error updating insurance type:",ve),fe(d,M,k,E,P)}},et=(xe,Me)=>{const ve=new Date(xe),Ee=Me.interval||1;switch(Me.period){case"daily":ve.setDate(xe.getDate()+Ee);break;case"weekly":ve.setDate(xe.getDate()+Ee*7);break;case"monthly":ve.setMonth(xe.getMonth()+Ee);break;case"yearly":ve.setFullYear(xe.getFullYear()+Ee);break;default:console.warn(`Unknown subscription period: ${Me.period}. Defaulting to 1 month.`),ve.setMonth(xe.getMonth()+1)}return ve},Je=async()=>{if(!B||!R){K("Please select a subscription plan.");return}const xe=q.find(Me=>Me.id===R);if(!xe){K("Selected plan details not found.");return}te(!0),K(null);try{const Me=new Date,ve=et(Me,xe),Ee={subscription_plan_id:R,subscription_status:"active",subscription_start_date:Me.toISOString(),subscription_end_date:ve.toISOString(),subscription_payment_method:"manual"},De=await pe(`/api/patients/${B.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ee)});if(!De.ok){const nt=await De.json();throw new Error(nt.message||"Failed to update patient subscription")}_e(),fe(d,M,k,E,P)}catch(Me){console.error("Error starting subscription:",Me),K(`Failed to start subscription: ${Me.message}`)}finally{te(!1)}},Le=async xe=>{if(!U){J(xe.id);try{const Me=await pe(`/api/queue/patient/${xe.id}/latest`);if(Me.ok){const De=await Me.json();if(De!=null&&De._id){e(`/dashboard/edit-complaint/${De._id}`,{state:{patientId:xe.id}});return}}else if(Me.status!==404){const De=await Me.text();throw new Error(`Failed to fetch queue entry: ${De||Me.statusText}`)}const ve=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:xe.id})});if(!ve.ok){const De=await ve.text();throw new Error(`Failed to create queue entry: ${De||ve.statusText}`)}const Ee=await ve.json();if(Ee!=null&&Ee.id)e(`/dashboard/edit-complaint/${Ee.id}`,{state:{patientId:xe.id}});else throw new Error("Failed to get ID from new queue entry.")}catch(Me){console.error("Error processing patient selection:",Me),alert(Me.message||"An error occurred while processing the selection.")}finally{J(null)}}};return i.jsxs("div",{className:"all-patients-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(Lt,{size:16}),"Back"]}),i.jsxs("h1",{className:"all-patients-title",children:[i.jsx(Fs,{size:28}),"All Registered Patients"]}),l&&i.jsxs("div",{className:"error-alert",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:l})]}),i.jsxs("div",{className:"subscription-plans-card",children:[i.jsx("h2",{className:"subscription-plans-title",children:"Available Subscription Plans"}),i.jsx("div",{children:ne?i.jsx("p",{className:"loading-state",children:"Loading plans..."}):ae?i.jsxs("p",{className:"error-message",children:["Error loading plans: ",ae]}):q.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("ul",{className:"subscription-plans-list",children:q.map(xe=>i.jsxs("li",{children:[i.jsx("strong",{children:xe.name}),": ",xe.price," / ",xe.interval," ",xe.period,xe.interval>1?"s":"",xe.description&&i.jsx("span",{className:"plan-description",children:xe.description})]},xe.id))})})]}),i.jsxs("div",{className:"controls-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by name or phone...",className:"search-input",value:f,onChange:xe=>u(xe.target.value)}),i.jsx(Si,{className:"search-input-icon",size:20})]}),i.jsxs("div",{className:"filter-dropdown-wrapper",children:[i.jsx("label",{htmlFor:"genderFilter",className:"sr-only",children:"Filter by Gender"}),i.jsxs("div",{className:"filter-select-container",children:[i.jsx(k_,{size:16,className:"filter-select-icon"}),i.jsxs("select",{id:"genderFilter",value:P,onChange:xe=>V(xe.target.value),className:"filter-select",children:[i.jsx("option",{value:"",children:"All Genders"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]})]})]}),r?i.jsx("div",{className:"loading-state",children:"Loading patients..."}):n.length===0?i.jsx("div",{className:"empty-state",children:M?"No patients found matching your search.":"No patients registered yet."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"patients-table-wrapper",children:i.jsxs("table",{className:"patients-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Token"}),i.jsxs("th",{className:"sortable-header",onClick:()=>we("name"),children:["Name",k==="name"&&(E==="asc"?i.jsx(No,{size:14,className:"sort-icon"}):i.jsx($c,{size:14,className:"sort-icon"}))]}),i.jsx("th",{children:"Age"}),i.jsx("th",{children:"Gender"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Address"}),i.jsxs("th",{className:"sortable-header",onClick:()=>we("created_at"),children:["Registered On",k==="created_at"&&(E==="asc"?i.jsx(No,{size:14,className:"sort-icon"}):i.jsx($c,{size:14,className:"sort-icon"}))]}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Insurance Type"})," ",i.jsx("th",{children:"Action"})," "]})}),i.jsx("tbody",{children:n.map(xe=>i.jsxs("tr",{onClick:()=>Le(xe),className:`patient-row ${U===xe.id?"navigating":""}`,style:{cursor:"pointer",opacity:U===xe.id?.7:1},children:[i.jsx("td",{children:xe.token??"-"}),i.jsx("td",{className:"patient-name",children:xe.name}),i.jsx("td",{children:xe.age??"-"}),i.jsx("td",{children:xe.gender??"-"}),i.jsx("td",{children:xe.phone??"-"}),i.jsx("td",{children:xe.address??"-"}),i.jsx("td",{children:re(xe.created_at)}),i.jsx("td",{children:i.jsx("span",{className:`status-badge ${xe.subscription_status==="active"?"active":xe.subscription_status==="cancelled"||xe.subscription_status==="expired"?"inactive":"none"}`,children:xe.subscription_status??"None"})}),i.jsx("td",{children:i.jsxs("select",{value:xe.insurance_type,onChange:Me=>qe(xe.id,Me.target.value),onClick:Me=>Me.stopPropagation(),className:"form-select insurance-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"insurance",children:"Insurance"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})}),i.jsx("td",{children:i.jsx("button",{onClick:Me=>{Me.stopPropagation(),e(`/start-subscription/${xe.id}`)},className:"action-button",children:"Start Sub"})})]},xe.id))})]})}),g>1&&i.jsxs("div",{className:"pagination-controls",children:[i.jsxs("div",{className:"pagination-info",children:["Showing"," ",i.jsx("span",{className:"font-medium",children:(d-1)*iv+1})," ","to"," ",i.jsx("span",{className:"font-medium",children:Math.min(d*iv,v)})," ","of"," ",i.jsx("span",{className:"font-medium",children:v})," results"]}),i.jsxs("div",{className:"pagination-buttons",children:[i.jsxs("button",{onClick:()=>h(xe=>Math.max(xe-1,1)),disabled:d===1||r,className:"pagination-button",children:[i.jsx(wb,{size:16,className:"prev-icon"}),"Previous"]}),i.jsxs("span",{className:"pagination-current-page",children:["Page ",i.jsx("span",{className:"font-medium",children:d})," of ",i.jsx("span",{className:"font-medium",children:g})]}),i.jsxs("button",{onClick:()=>h(xe=>Math.min(xe+1,g)),disabled:d===g||r,className:"pagination-button",children:["Next",i.jsx(rg,{size:16,className:"next-icon"})]})]})]})]}),F&&B&&i.jsx("div",{className:"subscription-modal-overlay",children:i.jsxs("div",{className:"subscription-modal-content",children:[i.jsxs("div",{className:"subscription-modal-header",children:[i.jsxs("h2",{className:"subscription-modal-title",children:["Start Subscription for ",B.name]}),i.jsx("button",{onClick:_e,className:"subscription-modal-close-button",children:i.jsx(Qn,{size:24})})]}),le&&i.jsx("div",{className:"error-alert",role:"alert",children:i.jsx("span",{children:le})}),i.jsxs("div",{className:"subscription-modal-body",children:[i.jsx("label",{htmlFor:"subscriptionPlan",className:"form-label",children:"Select Plan:"}),i.jsxs("select",{id:"subscriptionPlan",value:R,onChange:xe=>G(xe.target.value),className:"form-select",disabled:ee||ne||ae!==null||q.length===0,children:[i.jsx("option",{value:"",disabled:!0,children:"-- Select a Plan --"}),ne?i.jsx("option",{value:"",disabled:!0,children:"Loading plans..."}):ae?i.jsx("option",{value:"",disabled:!0,children:"Error loading plans"}):q.length>0?q.map(xe=>i.jsxs("option",{value:xe.id,children:[xe.name," - ",xe.price," (",xe.interval," ",xe.period,xe.interval>1?"s":"",")"]},xe.id)):i.jsx("option",{value:"",disabled:!0,children:"No active plans found"})]}),ae&&i.jsx("p",{className:"error-message",children:ae}),q.length===0&&!ne&&!ae&&i.jsx("p",{className:"empty-state",children:"No active subscription plans available."})]}),i.jsxs("div",{className:"subscription-modal-footer",children:[i.jsx("button",{onClick:_e,disabled:ee,className:"subscription-modal-button cancel",children:"Cancel"}),i.jsx("button",{onClick:Je,disabled:!R||ee,className:"subscription-modal-button submit",children:ee?"Starting...":"Start Subscription"})]})]})})]})},rk=()=>{const e=gt(),[n]=w.useState(!0),[t,r]=w.useState(""),[a,l]=w.useState([]),[o,f]=w.useState(!1),[u,d]=w.useState(null),[h,g]=w.useState(!1),b=/^\+?[0-9\s\-().]{7,20}$/,v=w.useMemo(()=>Nb(async E=>{if(E.trim().length<2){l([]),f(!1),d(null);return}f(!0),d(null);try{const I=new URLSearchParams({search:encodeURIComponent(E),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),P=await pe(`/api/patients?${I.toString()}`);if(!P.ok){const F=await P.text();throw new Error(`API Error (${P.status}): ${F||P.statusText}`)}const V=await P.json();l(V.patients)}catch(I){console.error("Error searching patients:",I),d(I.message||"Failed to search patients."),l([])}finally{f(!1)}},300),[]),N=E=>{const I=E.target.value;r(I),g(b.test(I)),f(!0),v(I)},k=w.useCallback(E=>{e("/billing",{state:{patientId:E.id,patientName:E.name}})},[e]),T=w.useCallback(async()=>{if(!t||!h){d("Invalid phone number to create a new patient.");return}f(!0),d(null);try{const I=await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"direct pharmacy",phone:t,age:null,gender:null,token:null})});if(!I.ok){const V=await I.json();throw new Error(V.message||`Failed to create patient: ${I.statusText}`)}const P=await I.json();alert(`New patient "direct pharmacy" created with phone ${P.phone}.`),k(P)}catch(E){console.error("Error creating new patient:",E),d(E.message||"Failed to create new patient.")}finally{f(!1)}},[t,h,k]);return i.jsxs("div",{className:"create-custom-bill-page p-4 md:p-6 max-w-5xl mx-auto",children:[i.jsx("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:i.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:i.jsx(Lt,{size:20})}),i.jsx("h2",{className:"text-2xl",children:"Create Custom Bill"})]})}),n&&i.jsxs("div",{className:"content-section",children:[i.jsx("h3",{className:"section-title",children:"Select Patient"}),i.jsxs("div",{className:"mb-3 relative",children:[i.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"}),i.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:t,onChange:N,className:"custom-text-input mt-1",autoFocus:!0}),o&&i.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),u&&i.jsx("div",{className:"ai-function-status error mb-3 p-3",children:u}),a.length>0&&i.jsx("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:i.jsx("ul",{children:a.map(E=>i.jsxs("li",{onClick:()=>k({id:E.id,name:E.name,token:E.token,age:E.age,gender:E.gender,phone:E.phone}),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[i.jsxs("div",{className:"font-medium",children:[i.jsxs("span",{className:"patient-token mr-2",children:["#",E.token]}),E.name]}),i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[E.age?`${E.age} yrs`:"Age N/A",E.gender?` / ${E.gender}`:" / Gender N/A",E.phone&&i.jsxs("span",{className:"hidden sm:inline",children:[" / ",E.phone]})]})]}),E.phone&&i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",E.phone]})]},E.id))})}),t.length>=2&&!o&&a.length===0&&!u&&i.jsxs(i.Fragment,{children:[i.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',t,'".']}),h&&i.jsx("button",{type:"button",onClick:T,className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:o,children:'Create "direct pharmacy" Patient with this Phone'})]}),t.length<2&&!o&&i.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]})]})},ak=({currentUser:e})=>{const n=gt(),[t,r]=w.useState("select_patient"),[a,l]=w.useState({name:"",age:void 0,gender:null,phone:"",address:""}),[o,f]=w.useState(null),[u,d]=w.useState([]),[h,g]=w.useState([]),[b,v]=w.useState(""),[N,k]=w.useState([]),[T,E]=w.useState(""),[I,P]=w.useState([]),[V,F]=w.useState(!1),[$,B]=w.useState(null),[z,q]=w.useState(null),[O,R]=w.useState(null),[G,ee]=w.useState(!1),[te,le]=w.useState(!1),[K,U]=w.useState(!1),J=/^\+?[0-9\s\-().]{7,20}$/,ne=/^[a-zA-Z\s'-]{2,}$/,A=w.useCallback(async()=>{if(!(u.length>0)){ee(!0),R(null);try{const Le=await pe("/api/lab-tests");if(!Le.ok)throw new Error("Failed to fetch lab tests");const xe=await Le.json();d(xe)}catch(Le){console.error("Failed to fetch available lab tests:",Le),R("Could not load lab test list: "+Le.message),d([])}finally{ee(!1)}}},[u.length]);w.useEffect(()=>{if(!b){k([]);return}const Le=b.toLowerCase();k(u.filter(xe=>xe.name.toLowerCase().includes(Le)||xe.description&&xe.description.toLowerCase().includes(Le)).slice(0,10))},[b,u]);const ae=w.useCallback(Le=>{const xe={id:Le.id,name:Le.name,token:Le.token,age:Le.age,gender:Le.gender,phone:Le.phone};f(xe),r("create_order"),g([]),v(""),k([]),R(null),A()},[A]),ce=w.useMemo(()=>Nb(async Le=>{if(Le.trim().length<2){P([]),F(!1),B(null);return}F(!0),B(null);try{const xe=new URLSearchParams({search:encodeURIComponent(Le),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Me=await pe(`/api/patients?${xe.toString()}`);if(!Me.ok){const Ee=await Me.text();throw new Error(`API Error (${Me.status}): ${Ee||Me.statusText}`)}const ve=await Me.json();P(ve.patients)}catch(xe){console.error("Error searching lab patients:",xe),B(xe.message||"Failed to search lab patients."),P([])}finally{F(!1)}},300),[J,ne]),M=Le=>{const xe=Le.target.value;E(xe),le(J.test(xe)),U(ne.test(xe)&&!J.test(xe)),F(!0),ce(xe)},de=w.useCallback(async Le=>{if(!T||Le==="phone"&&!te||Le==="name"&&!K){B(`Invalid ${Le} to create a new patient.`);return}F(!0),B(null);try{const ve=await(await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Le==="name"?T:"direct lab",phone:Le==="phone"?T:null,age:null,gender:null,token:null})})).json();alert(`New patient "${ve.name}" created with ${Le==="phone"?`phone ${ve.phone}`:`name ${ve.name}`}.`),ae({id:ve.id,name:ve.name,token:ve.token??null,age:ve.age??null,gender:ve.gender??null,phone:ve.phone})}catch(xe){console.error("Error creating new patient:",xe);const Me=xe.message||"";if(Me.toLowerCase().includes("patient limit")){n("/start-clinic-subscription",{state:{errorMessage:Me}});return}B(Me||"Failed to create new patient.")}finally{F(!1)}},[T,te,K,ae]),Se=()=>{l({name:"",age:void 0,gender:null,phone:"",address:""}),q(null),r("create_patient"),f(null)},fe=()=>{r("select_patient"),f(null),E(""),P([]),B(null)},we=Le=>{const{name:xe,value:Me}=Le.target;l(ve=>({...ve,[xe]:xe==="age"?Me?parseInt(Me,10):void 0:Me}))},re=async Le=>{if(Le.preventDefault(),q(null),!a.name){q("Patient Name is required.");return}const xe={name:a.name,age:a.age,gender:a.gender,phone:a.phone,address:a.address};try{const ve=await(await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(xe)})).json();ae({id:ve.id,name:ve.name,token:ve.token??null,age:ve.age??null,gender:ve.gender??null,phone:ve.phone})}catch(Me){console.error("Failed to create patient:",Me);const ve=Me.message||"";if(ve.toLowerCase().includes("patient limit")){n("/start-clinic-subscription",{state:{errorMessage:ve}});return}q(ve||"Failed to create patient. Please try again.")}},_e=Le=>{if(h.some(xe=>xe.id===Le.id)){R(`${Le.name} is already in the order.`),setTimeout(()=>R(null),3e3),v(""),k([]);return}g(xe=>[...xe,{...Le}]),v(""),k([])},qe=Le=>{g(xe=>xe.filter(Me=>Me.id!==Le))},et=async Le=>{if(Le.preventDefault(),R(null),!o){R("No patient selected.");return}if(h.length===0){R("No lab tests selected.");return}const xe={patient_id:o.id,tests:h.map(Me=>({id:Me.id,name:Me.name,price:Me.price}))};try{const Me=await pe("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(xe)});if(!Me.ok){const Ee=await Me.json();throw new Error(Ee.message||`Failed to create lab order: ${Me.statusText}`)}await Me.json();let ve=o.queueId;if(!ve){const Ee=await pe(`/api/queue/patient/${o.id}/latest`);if(Ee.ok){const De=await Ee.json();De!=null&&De._id&&(ve=De._id)}}if(!ve){const Ee=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:o.id})});if(!Ee.ok){const nt=await Ee.text();throw new Error(`Failed to create queue entry for redirection: ${nt||Ee.statusText}`)}const De=await Ee.json();De!=null&&De.id&&(ve=De.id)}alert(`Lab order created successfully for ${o.name}!`),(e==null?void 0:e.role)==="lab"?n("/dashboard"):n(`/dashboard/edit-complaint/${ve}`,{state:{patientId:o.id}})}catch(Me){console.error("Failed to create lab order:",Me),R(Me.message||"Failed to create lab order.")}};w.useEffect(()=>{A()},[A]);const Je=()=>h.reduce((Le,xe)=>Le+parseFloat(xe.price),0).toFixed(2);return i.jsxs("div",{className:"create-lab-order-page",children:[i.jsxs("div",{className:"page-header",children:[i.jsx("button",{onClick:()=>n(-1),className:"back-button","aria-label":"Go back",children:i.jsx(Lt,{size:20})}),i.jsx("h1",{children:"Create New Lab Order"}),i.jsx("div",{className:"w-10"})," "]}),(t==="select_patient"||t==="create_patient")&&i.jsxs("div",{className:"patient-selection-container",children:[t==="select_patient"&&i.jsxs("div",{className:"content-panel",children:[i.jsx("h2",{className:"section-title",style:{justifyContent:"center"},children:"Select Patient"}),i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(Si,{className:"search-icon",size:20}),i.jsx("input",{type:"text",placeholder:"Search by Name, Token, or Phone...",value:T,onChange:M,className:"custom-text-input",autoFocus:!0})]}),V&&i.jsx("div",{className:"loading-text",style:{marginTop:"1rem"},children:"detail..."}),$&&i.jsx("div",{className:"error-text",children:$}),I.length>0&&i.jsx("div",{className:"search-results-dropdown",style:{position:"relative",boxShadow:"none",borderTop:"none",maxHeight:"40vh"},children:I.map(Le=>i.jsxs("div",{onClick:()=>ae(Le),className:"search-result-item",children:[i.jsxs("div",{children:[Le.token&&i.jsxs("span",{className:"token-badge",children:["#",Le.token]}),i.jsx("span",{style:{fontWeight:500},children:Le.name})]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"var(--text-secondary)"},children:[Le.age?`${Le.age}y`:"",Le.gender?` / ${Le.gender}`:"",Le.phone?` / ${Le.phone}`:""]})]},Le.id))}),T.length>=2&&!V&&I.length===0&&!$&&i.jsxs("div",{style:{marginTop:"1.5rem"},children:[i.jsxs("p",{className:"no-data",children:['No patients found matching "',T,'".']}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px",marginTop:"10px"},children:[te&&i.jsxs("button",{type:"button",onClick:()=>de("phone"),className:"btn-primary",children:["Create Patient with Phone ",T]}),K&&i.jsxs("button",{type:"button",onClick:()=>de("name"),className:"btn-primary",children:['Create Patient with Name "',T,'"']})]})]}),i.jsx("div",{className:"or-divider",children:"OR"}),i.jsxs("button",{onClick:Se,className:"btn-secondary",style:{width:"100%"},children:[i.jsx(Ao,{size:18,style:{marginRight:"8px",verticalAlign:"text-bottom"}}),"Register New Patient manually"]})]}),t==="create_patient"&&i.jsxs("div",{className:"content-panel",children:[i.jsxs("div",{className:"section-title",style:{justifyContent:"space-between"},children:[i.jsx("span",{children:"Register New Patient"}),i.jsx("button",{onClick:fe,className:"action-link-btn",children:"Back to Search"})]}),z&&i.jsx("div",{className:"error-text",children:z}),i.jsxs("form",{onSubmit:re,children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[i.jsx("label",{htmlFor:"lab-patient-name",children:"Name *"}),i.jsx("input",{type:"text",name:"name",id:"lab-patient-name",required:!0,value:a.name,onChange:we,className:"form-input",placeholder:"Patient Full Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lab-patient-age",children:"Age"}),i.jsx("input",{type:"number",name:"age",id:"lab-patient-age",value:a.age??"",onChange:we,className:"form-input",placeholder:"Age"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lab-patient-gender",children:"Gender"}),i.jsxs("select",{name:"gender",id:"lab-patient-gender",value:a.gender??"",onChange:we,className:"form-select",children:[i.jsx("option",{value:"",children:"Select..."})," ",i.jsx("option",{value:"M",children:"Male"})," ",i.jsx("option",{value:"F",children:"Female"})," ",i.jsx("option",{value:"O",children:"Other"})]})]}),i.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[i.jsx("label",{htmlFor:"lab-patient-phone",children:"Phone"}),i.jsx("input",{type:"tel",name:"phone",id:"lab-patient-phone",value:a.phone||"",onChange:we,className:"form-input",placeholder:"Phone Number"})]}),i.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[i.jsx("label",{htmlFor:"lab-patient-address",children:"Address"}),i.jsx("textarea",{name:"address",id:"lab-patient-address",rows:2,value:a.address||"",onChange:we,className:"form-textarea",placeholder:"Address (Optional)"})]})]}),i.jsxs("div",{style:{marginTop:"2rem",display:"flex",justifyContent:"flex-end",gap:"1rem"},children:[i.jsx("button",{type:"button",onClick:fe,className:"btn-secondary",children:" Cancel "}),i.jsx("button",{type:"submit",className:"btn-primary",children:" Create & Proceed "})]})]})]})]}),t==="create_order"&&o&&i.jsxs("div",{className:"lab-order-grid",children:[i.jsx("div",{className:"left-column",children:i.jsxs("div",{className:"content-panel",children:[i.jsx("h2",{className:"section-title",children:"Add Lab Tests"}),i.jsxs("div",{className:"search-input-wrapper",style:{marginBottom:"1.5rem"},children:[i.jsx(Si,{className:"search-icon",size:20}),i.jsx("input",{type:"text",placeholder:"Search available lab tests...",value:b,onChange:Le=>v(Le.target.value),className:"custom-text-input",disabled:G,autoFocus:!0}),G&&i.jsx("span",{style:{position:"absolute",right:"15px",fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Loading..."}),b&&N.length>0&&i.jsx("div",{className:"search-results-dropdown",children:N.map(Le=>i.jsxs("div",{onClick:()=>_e(Le),className:"search-result-item",children:[i.jsx("span",{children:Le.name}),i.jsxs("span",{style:{fontWeight:600,color:"var(--primary-color)"},children:["",parseFloat(Le.price).toFixed(2)]})]},Le.id))}),b&&N.length===0&&!G&&i.jsx("div",{className:"search-results-dropdown",style:{padding:"1rem",color:"var(--text-secondary)",textAlign:"center"},children:"No tests found."})]}),O&&i.jsxs("div",{className:"error-text",style:{display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx(ti,{size:18})," ",O]}),i.jsx("div",{className:"order-table-container",children:i.jsxs("table",{className:"order-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Test Name"}),i.jsx("th",{style:{width:"100px",textAlign:"right"},children:"Price"}),i.jsx("th",{style:{width:"60px",textAlign:"center"},children:"Action"})]})}),i.jsx("tbody",{children:h.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"no-data",children:"No tests added yet. Search above to add."})}):h.map(Le=>i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("span",{style:{fontWeight:500},children:Le.name})}),i.jsxs("td",{style:{textAlign:"right",fontWeight:600},children:["",parseFloat(Le.price).toFixed(2)]}),i.jsx("td",{style:{textAlign:"center"},children:i.jsx("button",{type:"button",onClick:()=>qe(Le.id),className:"delete-btn",title:"Remove",children:i.jsx(Ri,{size:16})})})]},Le.id))})]})})]})}),i.jsxs("div",{className:"right-column",children:[i.jsxs("div",{className:"patient-card",children:[i.jsx("div",{className:"patient-avatar",children:i.jsx(Fs,{size:32})}),i.jsx("h3",{className:"patient-name",children:o.name}),i.jsxs("div",{className:"patient-info-text",children:[o.age?`${o.age} yrs`:"",o.gender?`  ${o.gender}`:""]}),o.phone&&i.jsx("div",{className:"patient-info-text",style:{marginTop:"4px"},children:o.phone}),i.jsx("button",{onClick:fe,className:"change-patient-btn",children:"Change Patient"})]}),i.jsxs("div",{className:"order-summary-container",children:[i.jsx("h3",{className:"section-title",style:{marginBottom:"1rem"},children:"Order Summary"}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Tests"}),i.jsx("span",{children:h.length})]}),i.jsxs("div",{className:"summary-total",children:[i.jsx("span",{className:"total-label",children:"Total Amount"}),i.jsxs("span",{className:"total-value",children:["",Je()]})]}),i.jsx("button",{onClick:et,disabled:h.length===0,className:"create-order-btn",children:"Confirm Order"}),i.jsx("button",{type:"button",onClick:()=>n(-1),className:"btn-secondary",style:{width:"100%",marginTop:"1rem",border:"none",color:"var(--text-secondary)"},children:"Cancel"})]})]})]})]})},uU=({currentUser:e})=>{const[n,t]=w.useState("newtons-ai"),[r,a]=w.useState(""),[l,o]=w.useState([]),[f,u]=w.useState(!0),[d,h]=w.useState([]),[g,b]=w.useState(!1),[v,N]=w.useState(null),[k,T]=w.useState(null),E=gt(),I=async()=>{u(!0),T(null);let q=[];try{const O=await pe("/api/queue");if(!O.ok){const ee=await O.json();throw new Error(ee.message||"Failed to fetch queue")}q=await O.json(),console.log("Fetched Initial Queue Data:",JSON.stringify(q,null,2));const R=q.map(async ee=>{if(!ee.patient_id)return console.warn(`Queue entry ${ee.id} has no patient_id.`),ee;try{const te=await pe(`/api/patients/${ee.patient_id}`);if(!te.ok)return console.error(`Failed to fetch patient details for ${ee.patient_id}: ${te.status}`),ee;const le=await te.json();return{...ee,Patient:{...ee.Patient??{},...le}}}catch(te){return console.error(`Error fetching patient details for ${ee.patient_id}:`,te),ee}}),G=await Promise.all(R);console.log("Enriched Queue Data (Before Sort):",JSON.stringify(G,null,2)),G.sort((ee,te)=>{var ne,A;const le=((ne=ee.Patient)==null?void 0:ne.subscription_status)==="active",K=((A=te.Patient)==null?void 0:A.subscription_status)==="active";if(le&&!K)return-1;if(!le&&K)return 1;const U=ee.created_at?new Date(ee.created_at).getTime():0,J=te.created_at?new Date(te.created_at).getTime():0;return U-J}),console.log("Sorted Queue Data:",JSON.stringify(G,null,2)),o(G)}catch(O){console.error("Error in fetchQueue process:",O),T(`Failed to load queue: ${O.message}`),o(q)}finally{u(!1)}},P=async()=>{b(!0),T(null);try{const q=await pe("/api/staff?role=doctor");if(!q.ok){const R=await q.json();throw new Error(R.message||"Failed to fetch doctors")}const O=await q.json();h(O.filter(R=>R.active))}catch(q){console.error("Error fetching doctors:",q),T(`Failed to fetch doctors: ${q.message}`)}finally{b(!1)}};w.useEffect(()=>{n==="queue"&&(I(),P()),N(null)},[n]);const V=w.useCallback(async(q,O)=>{if(console.log(`Attempting to assign doctor ${O} to queue ${q}`),T(null),N(null),!O){console.log("No doctor ID provided, skipping assignment.");return}const R=l.find(te=>te.id===q);if(!R){console.error(`Queue entry ${q} not found in local state.`),T("Queue entry not found.");return}if(R.doctor_id===O){console.log(`Queue ${q} already assigned to doctor ${O}. Skipping.`);return}const G=async te=>{if(!te||!te.id||!te.name){T("Cannot proceed: Patient ID or Name is missing."),console.error("assignAndNavigate called with invalid patientInfo",te);return}const le=async()=>{try{const K={status:"waiting",doctorId:O},U=await pe(`/api/queue/${q}/status`,{method:"PATCH",body:JSON.stringify(K)}),J=await U.json();if(!U.ok)throw new Error(J.message||`HTTP error! status: ${U.status}`);const ne=d.find(A=>A.id===O);return console.log(`Successfully assigned doctor ${ne==null?void 0:ne.name} to queue ${q}.`),o(A=>A.map(ae=>ae.id===q?{...ae,doctor_id:O,status:J.status||ae.status,User:ne?{name:ne.name}:null,Patient:te}:ae)),!0}catch(K){return console.error(`Error assigning doctor for queue ${q}:`,K),T(`Failed to assign doctor: ${K.message}`),!1}};te.subscription_status==="active"?(console.log(`Patient ${te.name} (ID: ${te.id}) has active subscription. Assigning doctor directly.`),await le()):(console.log(`Patient ${te.name} (ID: ${te.id}) does not have active subscription (Status: ${te.subscription_status}). Assigning doctor and proceeding to billing.`),await le()?(console.log(`Navigating to billing for patient ${te.name} (ID: ${te.id}), queue ID: ${q}, doctor ID: ${O}`),E("/billing",{state:{patientId:te.id,queueId:q,patientName:te.name,doctorId:O,billType:"consultation"}})):console.log(`Assignment failed for patient ${te.name}, skipping navigation.`))},ee=R.Patient;if(ee&&ee.id&&ee.name)console.log("Patient details found in state. Proceeding with assignment."),await G(ee);else{console.warn(`Patient details missing for queue entry ${q}. Fetching patient ${R.patient_id}...`);try{const te=await pe(`/api/patients/${R.patient_id}`);if(!te.ok){const K=await te.json().catch(()=>({}));throw new Error(K.message||`Failed to fetch patient details (status ${te.status})`)}const le=await te.json();console.log("Successfully fetched patient details:",le),await G(le)}catch(te){console.error(`Failed to fetch patient details for patient ID ${R.patient_id}:`,te),T(`Failed to fetch required patient details: ${te.message}`)}}},[d,l,E]),F=async(q,O)=>{T(null);const R=O==="consulting"?"start consultation":"complete visit";try{const G=l.find(K=>K.id===q);if(!G&&O==="consulting")throw new Error("Queue entry not found to start consultation.");let ee={status:O};if(O==="consulting"){if(!(G!=null&&G.doctor_id))throw new Error("Cannot start consultation without an assigned doctor.");ee.doctorId=G.doctor_id}const te=await pe(`/api/queue/${q}/status`,{method:"PATCH",body:JSON.stringify(ee)}),le=await te.json();if(!te.ok)throw new Error(le.message||`HTTP error! status: ${te.status}`);o(K=>K.map(U=>U.id===q?{...U,status:O}:U))}catch(G){console.error(`Error trying to ${R}:`,G),T(`Failed to ${R}: ${G.message}`)}},$=[{id:"queue",label:"Queue",icon:i.jsx(kh,{size:20})},{id:"newtons-ai",label:"Newtons AI",icon:i.jsx(Si,{size:20})},{id:"manage-admission",label:"Manage Admission",icon:i.jsx(fP,{size:20})},{id:"all-patients",label:"All Patients",icon:i.jsx(sI,{size:20})},{id:"lab",label:"Lab Tests",icon:i.jsx(C_,{size:20})},{id:"custom-bill",label:"Custom Bill",icon:i.jsx(jo,{size:20})}],B=q=>{try{return new Date(q).toLocaleTimeString("en-IN",{hour:"numeric",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},z=l.filter(q=>{var O,R;return(R=(O=q.Patient)==null?void 0:O.name)==null?void 0:R.toLowerCase().includes(r.toLowerCase())});return i.jsx("div",{className:"reception-dashboard-container",children:i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[k&&i.jsxs("div",{className:"error-message-reception",role:"alert",children:[" ",i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:k})]}),i.jsxs("div",{className:"reception-tab-nav",children:[" ",$.map(q=>i.jsxs("button",{className:`reception-tab-button ${n===q.id?"active":""}`,onClick:()=>t(q.id),children:[i.jsx("span",{children:q.icon}),q.label]},q.id))]}),n==="queue"&&i.jsxs("div",{className:"space-y-6",children:[" ",i.jsxs("div",{className:"queue-header",children:[" ",i.jsxs("div",{className:"queue-actions",children:[" ",i.jsxs("div",{className:"search-bar-container",children:[" ",i.jsx("input",{type:"text",placeholder:"Search patients in queue...",className:"search-input",value:r,onChange:q=>a(q.target.value)}),i.jsx(Si,{className:"search-icon",size:18})]})]}),i.jsxs("div",{className:"summary-cards-grid",children:[" ",i.jsxs("div",{className:"summary-card card-waiting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Waiting"})," ",i.jsx("div",{className:"summary-card-value",children:l.filter(q=>q.status==="waiting").length})," "]}),i.jsxs("div",{className:"summary-card card-consulting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Consulting"})," ",i.jsx("div",{className:"summary-card-value",children:l.filter(q=>q.status==="consulting").length})," "]}),i.jsxs("div",{className:"summary-card card-completed",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Completed"})," ",i.jsx("div",{className:"summary-card-value",children:l.filter(q=>q.status==="seen").length})," "]})]})]}),f?i.jsxs("div",{className:"loading-container",children:[" ",i.jsx("div",{className:"breathing-ball"})," ",i.jsx("span",{children:"Loading queue..."})]}):z.length===0?i.jsx("div",{className:"empty-queue-message",children:r?"No patients found matching your search.":"Queue is empty."}):i.jsxs("div",{className:"queue-table-wrapper",children:[" ",i.jsxs("table",{className:"queue-table",children:[" ",i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Queue"}),i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Phone Number"}),i.jsx("th",{children:"Complaint"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{className:"hidden md:table-cell",children:"Time Added"})," ",i.jsx("th",{className:"text-center",children:"Action / Doctor"})," "]})}),i.jsx("tbody",{children:z.map(q=>{var O,R,G,ee,te,le,K,U,J,ne,A;return i.jsxs("tr",{onClick:()=>E(`/dashboard/edit-complaint/${q.id}`),className:"queue-row-clickable",children:[i.jsxs("td",{children:[" ",i.jsxs("span",{className:"queue-token",children:["#",q.token_no]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-name",children:((O=q.Patient)==null?void 0:O.name)||"N/A"})," ",i.jsxs("div",{className:"patient-details",children:[(R=q.Patient)!=null&&R.age?`${q.Patient.age} yrs, `:"",((G=q.Patient)==null?void 0:G.gender)||""]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-phone",children:((ee=q.Patient)==null?void 0:ee.phone)||"N/A"})," "]}),i.jsx("td",{className:"complaint-text",children:q.complaint||"-"}),i.jsxs("td",{children:[i.jsx("span",{className:`subscription-status-badge ${((te=q.Patient)==null?void 0:te.subscription_status)==="active"?"status-active":((le=q.Patient)==null?void 0:le.subscription_status)==="cancelled"||((K=q.Patient)==null?void 0:K.subscription_status)==="expired"?"status-inactive":"status-none"}`,children:((U=q.Patient)==null?void 0:U.subscription_status)??"None"}),q.Patient&&q.Patient.id&&q.Patient.subscription_status!=="active"&&i.jsx("button",{onClick:ae=>{ae.stopPropagation(),q.Patient&&E(`/start-subscription/${q.Patient.id}`)},className:"action-button btn-start-sub-queue mt-2",children:"Start Sub"})]}),i.jsx("td",{className:"hidden md:table-cell time-added",children:B(q.created_at)}),i.jsx("td",{className:"action-doctor-cell",children:v===q.id?i.jsx("div",{className:"relative inline-block text-left w-full",onClick:ae=>ae.stopPropagation(),children:i.jsxs("select",{value:"",onChange:ae=>V(q.id,ae.target.value),onBlur:()=>N(null),className:"doctor-select-dropdown",autoFocus:!0,children:[i.jsx("option",{value:"",disabled:!0,children:"Select Doctor..."}),g?i.jsx("option",{disabled:!0,children:"Loading..."}):d.length>0?d.map(ae=>i.jsx("option",{value:ae.id,children:ae.name},ae.id)):i.jsx("option",{disabled:!0,children:"No doctors available"})]})}):i.jsxs("div",{className:"action-doctor-content",onClick:ae=>ae.stopPropagation(),children:[" ",q.status==="waiting"&&i.jsx(i.Fragment,{children:(J=q.User)!=null&&J.name?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"doctor-name-display",children:q.User.name}),i.jsx("button",{onClick:()=>F(q.id,"consulting"),className:"action-button btn-start",children:"Start"})]}):g?i.jsx("span",{className:"status-text-italic",children:"Loading..."}):d.length===0?i.jsx("span",{className:"status-text-red",children:"No doctors"}):d.length===1?i.jsxs("button",{onClick:()=>V(q.id,d[0].id),className:"action-button btn-assign",children:["Assign ",d[0].name]}):i.jsx("button",{onClick:()=>N(q.id),className:"action-button btn-assign",children:"Assign"})}),q.status==="consulting"&&i.jsxs(i.Fragment,{children:[((ne=q.User)==null?void 0:ne.name)&&i.jsx("span",{className:"doctor-name-display",children:q.User.name}),i.jsx("button",{onClick:()=>F(q.id,"seen"),className:"action-button btn-complete",children:"Complete"})]}),q.status==="seen"&&i.jsxs(i.Fragment,{children:[((A=q.User)==null?void 0:A.name)&&i.jsx("span",{className:"doctor-name-display",children:q.User.name}),i.jsx("span",{className:"status-text-italic",children:"Completed"})]}),q.status==="cancelled"&&i.jsx("span",{className:"status-text-red",children:"Cancelled"})]})})]},q.id)})})]})]})]}),n==="lab"&&i.jsxs("div",{className:"lab-tab-content",children:[" ",i.jsx(ak,{currentUser:e}),i.jsxs("button",{onClick:()=>E("/lab/search-report"),className:"lab-action-button btn-search-lab-reports",children:[i.jsx(Si,{size:16}),"Search Lab Reports"]})]}),n==="newtons-ai"&&i.jsx("div",{className:"newtons-ai-tab-content",children:i.jsx(vh,{})}),n==="manage-admission"&&i.jsx("div",{className:"manage-admission-tab-content",children:i.jsx(ik,{})}),n==="all-patients"&&i.jsx("div",{className:"all-patients-tab-content",children:i.jsx(o1,{})}),n==="custom-bill"&&i.jsx("div",{className:"custom-bill-tab-content",children:i.jsx(rk,{})})]})})},dU=e=>{let n="";if(!e.report_content)return"No report content available.";n+=`*Report Date:* ${e.report_date?new Date(e.report_date).toLocaleDateString():"N/A"}

`;try{const t=JSON.parse(e.report_content);typeof t=="object"&&t!==null&&e.tests?e.tests.forEach((r,a)=>{n+=`*Test: ${r.name}*
`,t[r.id]?Object.entries(t[r.id]).forEach(([l,o])=>{var h;const f=(h=r.default_parameters)==null?void 0:h.find(g=>g.name===l);let u=String(o),d="";if(f){const g=f.unit?` _${f.unit}_`:"";if(f.type==="boolean"){const b=o===!0||o==="true";u=b?"*Reactive*":"Non-Reactive",b||(d="`Normal: Non-Reactive`")}else if(f.type==="number"){const b=typeof o=="string"?parseFloat(o):typeof o=="number"?o:NaN;if(f.lower_limit!=null||f.upper_limit!=null){let v=[];f.lower_limit!=null&&v.push(`${f.lower_limit}`),f.upper_limit!=null&&v.push(`${f.upper_limit}`),d=`\`Normal: ${v.join(" - ")}\`${g}`,!isNaN(b)&&(f.lower_limit!=null&&b<f.lower_limit||f.upper_limit!=null&&b>f.upper_limit)&&(u=`*${u}*`)}}f.unit&&(u+=g)}n+=`${l}: ${u}
`,d&&((f==null?void 0:f.type)==="boolean"&&(o===!0||o==="true")||(n+=`${d}
`))}):n+=`_No parameters reported for this test._
`,a<e.tests.length-1&&(n+=`
`)}):n+=e.report_content}catch{n+=e.report_content}return n},hw=e=>{var o;if(!((o=e==null?void 0:e.Patient)!=null&&o.phone)){alert("Cannot share report via WhatsApp: Patient phone number is not available.");return}if(!(e!=null&&e.report_content)){alert("Cannot share report: No report content is available to share.");return}const n=e.Patient.name||"Patient",t=dU(e),r=`Hello ${n},

Your lab report is ready.

${t}`,l=`https://wa.me/${fU(e.Patient.phone)}?text=${encodeURIComponent(r)}`;window.open(l,"_blank")},fU=e=>{let n=e.replace(/\D/g,"");const t=/^(?:\\+?91)?[\\s-]*?(\\d{10})$/,r=n.match(t);return r?n="91"+r[1]:n.startsWith("91")||(n="91"+n),n},hU=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,l]=w.useState(!0),[o,f]=w.useState(null),[u,d]=w.useState("orders"),[h,g]=w.useState(1),[b]=w.useState(20),[v,N]=w.useState(0),k=w.useMemo(()=>Math.ceil(v/b),[v,b]),T=w.useCallback(async(z=1,q="")=>{l(!0),f(null);try{const O=new URLSearchParams({page:String(z),limit:String(b)});q&&O.append("search",q);const R=await pe(`/api/lab?${O.toString()}`);if(!R.ok)throw new Error(`HTTP error! status: ${R.status}`);const G=await R.json(),ee=G.orders.map(te=>{var le,K;return{id:te.id,labTokenNumber:String(te.lab_token_number??"N/A"),patientName:((le=te.Patient)==null?void 0:le.name)||"N/A",patientId:te.patient_id,patientTokenNumber:String(((K=te.Patient)==null?void 0:K.patient_token_number)??"N/A"),tests:(te.tests||[]).map(U=>U.name||"Unknown Test"),date:Eh(new Date(te.createdAt),"yyyy-MM-dd"),status:te.status,reportId:te.reportId,billId:te.billId}});n(ee),N(G.totalCount),g(z)}catch(O){console.error("Failed to fetch lab orders:",O),f(O instanceof Error?O.message:"An unknown error occurred"),n([]),N(0)}finally{l(!1)}},[b]);w.useEffect(()=>{console.log(`Fetch effect triggered. Current page: ${h}, Search term: "${t}"`),t.length===0||t.length>=2?(console.log(`Condition met (length ${t.length}). Fetching orders...`),T(h,t)):console.log(`Condition not met (length ${t.length}). Not fetching.`)},[T,h,t]),w.useEffect(()=>{const z=setTimeout(()=>{t.length>=2?h!==1&&g(1):t.length<2&&h!==1&&g(1)},1e3);return()=>{clearTimeout(z)}},[t]);const E=async(z,q)=>{console.log(`Updating order ${z} to status ${q}`);try{const O=await pe(`/api/lab/${z}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:q})});if(!O.ok){const R=await O.json();throw new Error(R.message||`Failed to update status: ${O.status}`)}if(q==="completed"){const R=await pe(`/api/lab/orders/${z}/report`);if(R.ok){const G=await R.json();hw(G)}}await T(h,t),console.log(`Order ${z} status updated to ${q}, refetching page ${h}`)}catch(O){console.error("Error updating status:",O),alert(`Failed to update status: ${O instanceof Error?O.message:"Unknown error"}`)}},I=gt(),P=z=>{if(!z){console.error("Cannot navigate to billing: Order data is missing."),alert("Could not open billing page: Order information is missing.");return}z.billId?(console.log(`Navigating to existing bill for Bill ID: ${z.billId}, Patient: ${z.patientName}`),I("/billing",{state:{billId:z.billId,patientId:z.patientId,patientName:z.patientName,billType:"lab"}})):(console.log(`Navigating to create new bill for Lab Order ID: ${z.id}, Patient: ${z.patientName}`),I("/lab-billing",{state:{labOrderId:z.id}}))},V=z=>{z&&z.id?I(`/lab/report/${z.id}`):(console.error("Cannot navigate: Order or Order ID is missing."),alert("Could not open the report entry page: Order information is missing."))},F=z=>{switch(z){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:z,className:"status-badge"}}};if(a)return i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsx("div",{className:"text-teal-600 text-xl animate-pulse",children:"Loading Lab Panel..."})});if(o)return i.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-red-50 text-red-700",children:[i.jsx(ti,{size:48,className:"mb-4"}),i.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Error Loading Lab Data"}),i.jsx("p",{className:"mb-4",children:o}),i.jsx("button",{onClick:()=>T(1,""),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry Fetch"})]});const $=()=>{h>1&&g(z=>z-1)},B=()=>{h<k&&g(z=>z+1)};return i.jsxs("div",{className:"lab-inventory-container",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("button",{onClick:()=>I(-1),className:"back-button mr-4",children:i.jsx(Lt,{size:24})}),i.jsx("h2",{className:"text-2xl font-semibold",children:"Lab Panel"})]}),i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px",borderBottom:"1px solid #ddd",paddingBottom:"10px"},children:[i.jsxs("button",{onClick:()=>d("orders"),className:`lab-inventory-button ${u==="orders"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[i.jsx(E_,{size:16,style:{marginRight:"8px"}}),"Orders"]}),i.jsx("button",{onClick:()=>I("/create-lab-order"),className:"lab-inventory-button",style:{display:"flex",alignItems:"center"},children:"Create New Lab Order"}),i.jsxs("button",{onClick:()=>d("inventory"),className:`lab-inventory-button ${u==="inventory"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[i.jsx(J1,{size:16,style:{marginRight:"8px"}}),"Inventory"]})]}),u==="orders"&&i.jsxs("div",{className:"lab-orders-view",children:[" ",i.jsxs("div",{className:"lab-orders-header-controls",children:[i.jsx("h3",{className:"lab-orders-title",children:"Current Lab Orders"}),i.jsxs("div",{className:"lab-orders-search-container",children:[i.jsx("input",{type:"text",placeholder:"Search name, token, tests...",value:t,onChange:z=>r(z.target.value),className:"lab-inventory-input lab-orders-search-input"}),i.jsx(Si,{size:18,className:"lab-orders-search-icon"})]})]}),i.jsx("div",{className:"lab-orders-table-container",children:i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient (Token)"}),i.jsx("th",{children:"Tests"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"lab-table-actions-header",children:"Actions"})]})}),i.jsxs("tbody",{children:[a&&!o&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:"Loading orders..."})}),!a&&!o&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."})}),!a&&!o&&e.map(z=>{const q=F(z.status);return i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{children:z.patientName}),i.jsxs("div",{className:"lab-table-patient-token",children:["Token: ",z.patientTokenNumber]})]}),i.jsx("td",{children:z.tests.map((O,R)=>i.jsx("div",{children:O},R))}),i.jsx("td",{className:"hidden md:table-cell",children:z.date}),i.jsx("td",{children:i.jsx("span",{className:q.className,children:q.text})}),i.jsx("td",{children:i.jsxs("div",{className:"lab-table-actions",children:[z.status==="pending"&&i.jsx("button",{onClick:()=>P(z),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),z.status==="billed"&&i.jsx("button",{onClick:()=>E(z.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),z.status==="collected"&&i.jsx("button",{onClick:()=>E(z.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(z.status==="processing"||z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>V(z),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>E(z.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(z.status==="completed"||z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>{z.id?I(`/lab/view-report/${z.id}`):(console.error("Attempted to view report for an order with no ID:",z),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})})]},z.id)})]})]})}),i.jsxs("div",{className:"lab-orders-card-container",children:[a&&!o&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:"Loading orders..."}),!a&&!o&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."}),!a&&!o&&e.map(z=>{const q=F(z.status);return i.jsxs("div",{className:"lab-order-card",children:[i.jsxs("div",{className:"lab-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"lab-card-patient-name",children:z.patientName}),i.jsxs("div",{className:"lab-card-patient-token",children:["Token: ",z.patientTokenNumber]}),i.jsx("div",{className:"lab-card-date",children:z.date})]}),i.jsx("span",{className:`${q.className} lab-card-status-pill`,children:q.text})]}),i.jsxs("div",{className:"lab-card-section",children:[i.jsx("p",{className:"lab-card-section-title",children:"Tests:"}),z.tests.map((O,R)=>i.jsx("div",{className:"lab-card-test-item",children:O},R)),z.tests.length===0&&i.jsx("div",{className:"lab-card-no-tests",children:"No tests listed."})]}),i.jsxs("div",{className:"lab-card-actions",children:[z.status==="pending"&&i.jsx("button",{onClick:()=>P(z),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),z.status==="billed"&&i.jsx("button",{onClick:()=>E(z.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),z.status==="collected"&&i.jsx("button",{onClick:()=>E(z.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(z.status==="processing"||z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>V(z),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>E(z.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(z.status==="completed"||z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>{z.id?I(`/lab/view-report/${z.id}`):(console.error("Attempted to view report for an order with no ID:",z),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})]},z.id)})]}),!a&&v>0&&i.jsxs("div",{className:"lab-pagination-controls",children:[i.jsxs("div",{className:"lab-pagination-info",children:["Showing"," ",i.jsx("strong",{children:(h-1)*b+1})," ","to"," ",i.jsx("strong",{children:Math.min(h*b,v)})," ","of"," ",i.jsx("strong",{children:v})," ","results"]}),i.jsxs("div",{className:"lab-pagination-buttons",children:[i.jsx("button",{onClick:$,disabled:h===1,className:"lab-pagination-button","aria-label":"Previous page",children:i.jsx(wb,{size:18})}),i.jsxs("span",{children:["Page ",h," of ",k]}),i.jsx("button",{onClick:B,disabled:h===k,className:"lab-pagination-button","aria-label":"Next page",children:i.jsx(rg,{size:18})})]})]})]}),u==="inventory"&&i.jsxs("div",{className:"lab-inventory-content-wrapper",children:[" ",i.jsx(K1,{})]})]})]})},pU=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,l]=w.useState(!0),[o,f]=w.useState(null),u=gt(),d=w.useRef(null),[h,g]=w.useState(1),[b,v]=w.useState(1),[N,k]=w.useState(0),T=10,E=w.useCallback(async(B,z,q)=>{l(!0),f(null);try{let O=`/api/pharmacy-orders?page=${B}&limit=${z}`;q&&q.trim()!==""&&(O+=`&search=${encodeURIComponent(q.trim())}`);const R=await pe(O);if(!R.ok)throw new Error(`Failed to fetch orders: ${R.statusText} (${R.status})`);const G=await R.json();if(G&&Array.isArray(G.orders)&&typeof G.totalOrders=="number"&&typeof G.totalPages=="number")console.log("Fetched pharmacy orders data:",G.orders),n(G.orders),k(G.totalOrders),v(G.totalPages),g(G.currentPage||B);else throw console.error("Received data does not match expected paginated structure:",G),new Error("Invalid data format received from API")}catch(O){console.error("Failed to fetch pharmacy orders:",O),f(O.message||"Failed to fetch orders. Please try again."),n([]),v(1),k(0)}finally{l(!1)}},[]);w.useEffect(()=>(d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{const B=t===""?h:1;t!==""&&h!==1&&g(1),E(B,T,t)},500),()=>{d.current&&clearTimeout(d.current)}),[t,h,E,T]);const I=B=>{u(`/dashboard/edit-pharmacy-order/${B}`)},P=B=>{f(null),console.log(`Preparing billing navigation for order: ${B}`);const z=e.find(q=>q.id===B);if(z){const q=z.medications.map(O=>{const R=O.price??0;return(O.price===void 0||O.price===null)&&console.warn(`Medication "${O.name}" in order ${B} is missing a price. Defaulting to 0.`),{name:O.name,pack_quantity:O.pack_quantity,loose_quantity:O.loose_quantity,price:R,pack_price:O.pack_price,loose_price:O.loose_price,total_price:O.total_price,isLoose:O.isLoose,unit:O.unit,drug_id:O.drug_id?String(O.drug_id):null,tabletsPerDay:O.tabletsPerDay,numberOfDays:O.numberOfDays,directions_to_use:O.directions_to_use,discount_percentage:0,batch:O.batch,expiry_date:O.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:q}),u(`/dashboard/pharmacy-billing/${B}`,{state:{initialItems:q}})}else console.error(`Order with ID ${B} not found.`),f(`Order with ID ${B} not found.`),alert(`Error: Could not find order ${B} to bill.`)},V=async(B,z)=>{f(null);const q=e.find(R=>R.id===B);if(!q){f(`Order with ID ${B} not found.`);return}const O={status:z,medications:q.medications};try{const R=await pe(`/api/pharmacy-orders/${B}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(O)});if(!R.ok){const ee=await R.text();throw new Error(`Failed to update status: ${R.statusText} (${R.status}) - ${ee}`)}const G=await R.json();n(ee=>ee.map(te=>te.id===G.id?{...te,status:G.status}:te))}catch(R){console.error("Failed to update order status:",R),f(R.message||`Failed to update status for order ${B}.`),alert(`Error updating status for order ${B}: ${R.message||"Please try again."}`)}},F=B=>{switch(B){case"pending":return"status-pill status-pill-pending";case"billed":return"status-pill status-pill-billed";case"dispensed":return"status-pill status-pill-dispensed";case"cancelled":return"status-pill status-pill-cancelled";default:return"status-pill status-pill-default"}},$=B=>{u(`/dashboard/orders/${B.id}`)};return a&&e.length===0&&!o?i.jsx("div",{className:"loading-pulse",children:"Loading Orders..."}):o&&e.length===0?i.jsxs("div",{className:"error-message-box",children:["Error loading orders: ",o]}):i.jsxs("div",{className:"pharmacy-queue-container",children:[i.jsxs("div",{className:"pharmacy-queue-header",children:[i.jsx("h3",{className:"pharmacy-queue-title",children:"Pharmacy Queue"}),i.jsxs("div",{className:"pharmacy-actions-container",children:[i.jsxs("div",{className:"pharmacy-buttons-group",children:[i.jsxs("button",{onClick:()=>u("/dashboard/add-order"),className:"pharmacy-action-button btn-add-order",children:[i.jsx(jo,{size:16}),"Add Order"]}),i.jsxs("button",{onClick:()=>u("/dashboard/inventory"),className:"pharmacy-action-button btn-inventory",title:"View Pharmacy Inventory",children:[i.jsx(Pd,{size:16}),"Inventory"]}),i.jsxs("button",{onClick:()=>u("/dashboard/search-patient-records"),className:"pharmacy-action-button btn-ai-search",title:"Search Patient Records with Newton's AI",children:[i.jsx(zv,{size:16}),"Newton's AI"]}),i.jsxs("button",{onClick:()=>u("/dashboard/distributors"),className:"pharmacy-action-button btn-distributors",title:"Manage Distributors",children:[i.jsx(Pd,{size:16}),"Distributors"]}),i.jsxs("button",{onClick:()=>u("/dashboard/recurring-medications"),className:"pharmacy-action-button btn-refill-reminders",title:"View Recurring Medications",children:[i.jsx(gP,{size:16}),"Recurring Meds"]})]}),i.jsxs("div",{className:"pharmacy-search-input-container",children:[i.jsx("input",{type:"text",placeholder:"Search orders by patient name, token, or medication...",value:t,onChange:B=>r(B.target.value),className:"pharmacy-search-input"}),i.jsx(Si,{size:18,className:"pharmacy-search-icon"})]})]})]}),i.jsxs("div",{className:"pharmacy-orders-scroll-container",children:[o&&e.length>0&&i.jsxs("div",{className:"error-message-box",children:["Error: ",o]}),a&&e.length>0&&i.jsx("div",{className:"loading-pulse",children:"Updating Orders..."}),!a&&e.length===0&&!o&&i.jsx("div",{className:"empty-state-message",children:t?`No pharmacy orders found matching "${t}".`:"There are currently no pharmacy orders."}),e.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"pharmacy-table-container",children:i.jsxs("table",{className:"pharmacy-queue-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Medications"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Order Total"}),i.jsx("th",{children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map(B=>i.jsxs("tr",{onClick:()=>$(B),style:{cursor:"pointer"},children:[i.jsxs("td",{children:[i.jsx("div",{className:"patient-name",children:B.patientName}),i.jsx("div",{className:"patient-token",title:`Patient Token: ${B.patientTokenNumber}`,children:B.patientTokenNumber})]}),i.jsxs("td",{className:"medication-info",children:[B.medications.map((z,q)=>i.jsxs("div",{className:"medication-item",children:[i.jsxs("span",{children:[z.name," (Packs: ",z.pack_quantity,", Loose: ",z.loose_quantity,", ",z.tabletsPerDay??"N/A","x",z.numberOfDays??"N/A","d)",z.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",z.box_number,")"]})]}),z.directions_to_use&&i.jsxs("span",{className:"medication-directions",children:["Directions: ",z.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[z.pack_price!==void 0&&`Pack Price: ${Number(z.pack_price).toFixed(2)}`,z.loose_price!==void 0&&` | Loose Price: ${Number(z.loose_price).toFixed(2)}`,z.total_price!==void 0&&` | Item Total: ${Number(z.total_price).toFixed(2)}`]})]},q)),B.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",B.prescriptionForUnavailableDrugs]})]}),i.jsx("td",{className:"hidden md:table-cell date-info",children:new Date(B.date).toLocaleDateString()}),i.jsxs("td",{className:"order-total-cell font-semibold",children:["",Number(B.order_total??0).toFixed(2)]}),i.jsx("td",{children:i.jsx("span",{className:F(B.status),children:B.status})}),i.jsx("td",{children:i.jsxs("div",{className:"pharmacy-table-actions",children:[B.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:z=>{z.stopPropagation(),I(B.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx(Md,{size:14})," Edit"]}),i.jsxs("button",{onClick:z=>{z.stopPropagation(),P(B.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx(Ad,{size:14})," Bill"]})]}),B.status==="billed"&&i.jsxs("button",{onClick:z=>{z.stopPropagation(),V(B.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx(Ra,{size:14})," Dispense"]}),(B.status==="pending"||B.status==="billed")&&i.jsx("button",{onClick:z=>{z.stopPropagation(),V(B.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:z=>{z.stopPropagation(),$(B)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})})]},B.id))})]})}),i.jsx("div",{className:"pharmacy-card-view-container",children:e.map(B=>{const z=F(B.status);return i.jsxs("div",{className:"pharmacy-order-card",onClick:()=>$(B),children:[i.jsxs("div",{className:"pharmacy-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"pharmacy-card-patient-name",children:B.patientName||"N/A"}),i.jsxs("div",{className:"pharmacy-card-patient-token",title:`Patient Token: ${B.patientTokenNumber}`,children:["Token: ",B.patientTokenNumber||"N/A"]}),i.jsx("div",{className:"pharmacy-card-date",children:new Date(B.date).toLocaleDateString()})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:z,children:B.status}),B.order_total!==void 0&&i.jsxs("span",{className:"pharmacy-card-order-total font-semibold",children:["",Number(B.order_total).toFixed(2)]})]})]}),i.jsxs("div",{className:"pharmacy-card-medications",children:[i.jsx("p",{className:"pharmacy-card-medications-title",children:"Medications:"}),i.jsxs("div",{className:"space-y-0_5",children:[B.medications.slice(0,2).map((q,O)=>i.jsxs("div",{className:"pharmacy-card-medication-item",children:[i.jsxs("span",{title:`${q.name} (Packs: ${q.pack_quantity}, Loose: ${q.loose_quantity}, ${q.tabletsPerDay??"N/A"}x${q.numberOfDays??"N/A"}d)`,children:[q.name," (Packs: ",q.pack_quantity,", Loose: ",q.loose_quantity,", ",q.tabletsPerDay??"N/A","x",q.numberOfDays??"N/A","d)",q.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",q.box_number,")"]})]}),q.directions_to_use&&i.jsxs("span",{className:"medication-directions",title:`Directions: ${q.directions_to_use}`,children:["Directions: ",q.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[q.pack_price!==void 0&&`Pack Price: ${Number(q.pack_price).toFixed(2)}`,q.loose_price!==void 0&&` | Loose Price: ${Number(q.loose_price).toFixed(2)}`,q.total_price!==void 0&&` | Item Total: ${Number(q.total_price).toFixed(2)}`]})]},O)),B.medications.length>2&&i.jsxs("div",{className:"pharmacy-card-medications-more",children:["...and ",B.medications.length-2," more"]}),B.medications.length===0&&i.jsx("div",{className:"pharmacy-card-no-medications",children:"No medications listed."})]}),B.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",B.prescriptionForUnavailableDrugs]})]}),i.jsxs("div",{className:"pharmacy-card-actions",children:[B.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:q=>{q.stopPropagation(),I(B.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx(Md,{size:14})," Edit"]}),i.jsxs("button",{onClick:q=>{q.stopPropagation(),P(B.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx(Ad,{size:14})," Bill"]})]}),B.status==="billed"&&i.jsxs("button",{onClick:q=>{q.stopPropagation(),V(B.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx(Ra,{size:14})," Dispense"]}),(B.status==="pending"||B.status==="billed")&&i.jsx("button",{onClick:q=>{q.stopPropagation(),V(B.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:q=>{q.stopPropagation(),$(B)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})]},B.id)})})]}),!a&&b>1&&i.jsxs("div",{className:"pharmacy-pagination-container",children:[i.jsxs("div",{className:"pagination-mobile-controls",children:[i.jsx("button",{onClick:()=>g(B=>Math.max(B-1,1)),disabled:h===1,className:"pagination-button prev",children:"Previous"}),i.jsx("button",{onClick:()=>g(B=>Math.min(B+1,b)),disabled:h===b,className:"pagination-button next",children:"Next"})]}),i.jsxs("div",{className:"pagination-desktop-controls",children:[i.jsx("div",{className:"pagination-info",children:i.jsxs("p",{children:["Showing ",i.jsx("span",{className:"font-medium",children:(h-1)*T+1})," ","to ",i.jsx("span",{className:"font-medium",children:Math.min(h*T,N)})," ","of ",i.jsx("span",{className:"font-medium",children:N})," results"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"pagination-nav","aria-label":"Pagination",children:[i.jsxs("button",{onClick:()=>g(B=>Math.max(B-1,1)),disabled:h===1,className:"pagination-nav-button prev",children:[i.jsx("span",{className:"sr-only",children:"Previous"}),i.jsx(wb,{"aria-hidden":"true"})]}),i.jsxs("span",{"aria-current":"page",className:"pagination-current-page",children:["Page ",h," of ",b]}),i.jsxs("button",{onClick:()=>g(B=>Math.min(B+1,b)),disabled:h===b,className:"pagination-nav-button next",children:[i.jsx("span",{className:"sr-only",children:"Next"}),i.jsx(rg,{"aria-hidden":"true"})]})]})})]})]})]})," "]})},mU=()=>{const e=gt();return i.jsxs("div",{className:"bg-white p-3 md:p-6 rounded-lg shadow",children:[i.jsx("button",{onClick:()=>e(-1),className:"mb-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Back"}),i.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Settings"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Pharmacy settings will be configured here."})]})},gU=()=>{const{id:e}=jr(),n=gt(),[t,r]=w.useState(null),[a,l]=w.useState(!0),[o,f]=w.useState(null),[u,d]=w.useState(!1),[h,g]=w.useState(!1),b=w.useRef(null),v=w.useRef(null),N=w.useRef(null),k=w.useCallback(async()=>{if(!e){f("Drug ID is missing."),l(!1);return}l(!0),f(null);try{const P=await pe(`/api/drugs/${e}`);if(!P.ok){const F=await P.json();throw new Error(F.message||`Failed to fetch drug: ${P.statusText}`)}let V=await P.json();V={...V,name:V.name||"",brand_name:V.brand_name||"",price:parseFloat(String(V.price))||0,buying_price:V.buying_price!==null&&V.buying_price!==void 0?parseFloat(String(V.buying_price)):null,quantity_in_stock:parseInt(String(V.quantity_in_stock),10)||0,gst:V.gst!==null&&V.gst!==void 0?parseFloat(String(V.gst)):null,margin:V.margin!==null&&V.margin!==void 0?parseFloat(String(V.margin)):null,discount:V.discount!==null&&V.discount!==void 0?parseFloat(String(V.discount)):null,batch:V.batch||"",hsn_code:V.hsn_code||"",mfg:V.mfg||"",loose:V.loose!==null&&V.loose!==void 0?parseInt(String(V.loose),10):null},r(V)}catch(P){console.error("Failed to fetch drug:",P),f(P.message||"Failed to load drug data. Please try again.")}finally{l(!1)}},[e]);w.useEffect(()=>{k()},[k]),w.useEffect(()=>{const P=F=>{F.key==="Tab"&&v.current===document.activeElement&&(h||(g(!0),setTimeout(()=>{var $;($=N.current)==null||$.focus()},0),F.preventDefault()))},V=F=>{b.current&&!b.current.contains(F.target)&&g(!1)};return document.addEventListener("keydown",P),document.addEventListener("mousedown",V),()=>{document.removeEventListener("keydown",P),document.removeEventListener("mousedown",V)}},[h]);const T=P=>{const{name:V,value:F,type:$}=P.target;r(B=>B?{...B,[V]:$==="number"?parseFloat(F)||null:F}:null)},E=()=>{n(-1)},I=async P=>{if(P.preventDefault(),f(null),d(!0),!t||!t.id){f("Cannot edit drug: No drug data available."),d(!1);return}if(t.price===void 0||t.quantity_in_stock===void 0){f("Price and Stock Quantity are required."),d(!1);return}const V={...t,name:t.name===""?null:t.name,brand_name:t.brand_name===""?null:t.brand_name,buying_price:t.buying_price===0?null:t.buying_price,expiry_date:t.expiry_date===""?null:t.expiry_date,gst:t.gst===0?null:t.gst,margin:t.margin===0?null:t.margin,discount:t.discount===0?null:t.discount,batch:t.batch===""?null:t.batch,hsn_code:t.hsn_code===""?null:t.hsn_code,mfg:t.mfg===""?null:t.mfg,loose:t.loose===0?null:t.loose};try{const F=await pe(`/api/drugs/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(V)});if(!F.ok){const B=await F.json();throw new Error(B.message||`Failed to update drug: ${F.statusText}`)}const $=await F.json();alert(`Drug "${$.name}" updated successfully!`),n(-1)}catch(F){console.error("Failed to update drug:",F),f(F.message||"Failed to update drug. Please try again.")}finally{d(!1)}};return a?i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"loading-message",children:"Loading drug data..."})}):o&&!t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"error-message-load",children:["Error: ",o]})}):t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"edit-drug-form-container",children:[i.jsxs("div",{className:"edit-drug-form-header",children:[i.jsxs("h2",{children:["Edit Drug: ",t.name]}),i.jsx("button",{onClick:E,className:"cancel-button",title:"Go Back",children:i.jsx(Qn,{size:24})})]}),o&&i.jsx("div",{className:"error-message-submit",children:o}),i.jsxs("form",{onSubmit:I,className:"edit-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-name",className:"form-label",children:"Composition Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Il,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"edit-name",value:t.name||"",onChange:T,className:"custom-text-input",placeholder:"e.g., Paracetamol",tabIndex:1})," "]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-brand_name",className:"form-label",children:"Brand Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Il,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"edit-brand_name",value:t.brand_name||"",onChange:T,className:"custom-text-input",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-price",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Il,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"price",id:"edit-price",required:!0,step:"0.01",min:"0",value:t.price,onChange:T,className:"custom-text-input",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-quantity_in_stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Il,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"quantity_in_stock",id:"edit-quantity_in_stock",required:!0,step:"1",min:"0",value:t.quantity_in_stock,onChange:T,className:"custom-text-input",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-unit",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"unit",id:"edit-unit",value:t.unit||"",onChange:T,className:"custom-text-input",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"edit-expiry_date",value:t.expiry_date||"",onChange:T,className:"custom-text-input",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"edit-box_number",value:t.box_number||"",onChange:T,className:"custom-text-input",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:b,children:[i.jsx("button",{type:"button",onClick:()=>g(!h),className:"form-button w-full text-left",tabIndex:8,ref:v,children:"Others"}),h&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"edit-description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"edit-description",rows:3,value:t.description||"",onChange:T,className:"custom-text-input",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-supplier",className:"form-label",children:"Supplier"}),i.jsx("input",{type:"text",name:"supplier",id:"edit-supplier",value:t.supplier||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:10})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-buying_price",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"buying_price",id:"edit-buying_price",step:"0.01",min:"0",value:t.buying_price??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:11,ref:N})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"edit-gst",step:"0.01",min:"0",max:"100",value:t.gst??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"edit-margin",step:"0.01",min:"0",max:"100",value:t.margin??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"edit-discount",step:"0.01",min:"0",max:"100",value:t.discount??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"edit-batch",value:t.batch||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"edit-hsn_code",value:t.hsn_code||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"edit-mfg",value:t.mfg||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:17})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-loose",className:"form-label",children:"Loose"}),i.jsx("input",{type:"number",name:"loose",id:"edit-loose",step:"1",min:"0",value:t.loose??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:18})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:E,disabled:u,className:"form-button cancel-form-button",tabIndex:19,children:"Back"}),i.jsx("button",{type:"submit",disabled:u,className:"form-button submit-form-button",tabIndex:20,children:u?"Saving...":"Save Changes"})]})]})]})}):i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"not-found-message",children:"Drug not found."})})},c1=()=>{const e=gt(),[n,t]=w.useState({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),[r,a]=w.useState(!1),[l,o]=w.useState(null),[f,u]=w.useState(null),[d,h]=w.useState(""),[g,b]=w.useState([]),[v,N]=w.useState(null),[k,T]=w.useState(!1),[E,I]=w.useState([]),[P,V]=w.useState(!0);w.useEffect(()=>{(async()=>{V(!0);try{const R=await pe("/api/staff?role=doctor");if(!R.ok)throw new Error("Failed to fetch doctors");const G=await R.json();I(G),G.length>0&&t(ee=>({...ee,doctorId:""}))}catch(R){console.error("Error fetching doctors:",R),o(`Failed to load doctors: ${R.message}`)}finally{V(!1)}})()},[]);const F=w.useCallback(async()=>{if(d.trim()){T(!0),o(null),b([]);try{const O=encodeURIComponent(d.trim()),R=await pe(`/api/patients?search=${O}&limit=10`);if(!R.ok){const ee=await R.json().catch(()=>({message:"Failed to search patients"}));throw new Error(ee.message||"Failed to search patients")}const G=await R.json();G&&Array.isArray(G.patients)?b(G.patients):(console.error("Unexpected response format from patient search:",G),b([]))}catch(O){console.error("Error searching patients:",O),o(`Search failed: ${O.message}`)}finally{T(!1)}}},[d]);w.useEffect(()=>{if(d.trim().length<2){b([]),o(null);return}const O=setTimeout(()=>{F()},300);return()=>clearTimeout(O)},[d,F]);const $=O=>{N(O),h(""),b([]),o(null),t(R=>({...R,name:"",age:"",gender:"",phone:""}))},B=()=>{N(null),h(""),b([]),o(null),t(O=>({...O,name:"",age:"",gender:"",phone:""}))},z=O=>{const{name:R,value:G}=O.target;t(ee=>({...ee,[R]:G}))},q=async O=>{var R;O.preventDefault(),o(null),u(null),a(!0);try{let G,ee;if(v)G=v.id,ee=v.name,console.log(`Adding existing patient ${G} to queue.`);else{console.log("Registering new patient...");const U=await pe("/api/patients",{method:"POST",body:JSON.stringify({name:n.name,age:n.age?parseInt(n.age,10):null,gender:n.gender||null,phone:n.phone||null})});if(!U.ok){const ne=await U.json();if(U.status===403&&ne.message.includes("Patient limit")){e("/start-clinic-subscription",{state:{errorMessage:ne.message}});return}throw new Error(ne.message||"Failed to register patient")}const J=await U.json();G=J.id,ee=J.name,console.log(`New patient ${G} registered.`)}const te=n.doctorId||null;console.log(`Adding patient ${G} to queue for doctor ${te||"Unassigned"}`);const le=await pe("/api/queue",{method:"POST",body:JSON.stringify({patientId:G,complaint:n.complaint||null,doctorId:te})});if(!le.ok){const U=await le.json();throw new Error(U.message||"Failed to add patient to queue")}const K=await le.json();if(console.log(`Patient added to queue, entry ID: ${K.id}`),N(null),h(""),b([]),t({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),te){const U=((R=E.find(ne=>ne.id===te))==null?void 0:R.name)||"Selected Doctor",J=v?`Existing patient "${ee}" added to queue for Dr. ${U}. Redirecting to billing...`:`Patient "${ee}" registered and added to queue for Dr. ${U}. Redirecting to billing...`;u(J),e("/billing",{state:{patientId:G,queueId:K.id,patientName:ee,doctorId:te,billType:"consultation"}})}else{const U=v?`Existing patient "${ee}" added to the general queue.`:`Patient "${ee}" registered and added to the general queue.`;u(U)}}catch(G){console.error("Error in add/queue process:",G),G.message.includes("Patient limit")?(o(`Operation failed: ${G.message}. Please upgrade your plan.`),e("/start-clinic-subscription")):o(`Operation failed: ${G.message}`)}finally{a(!1)}};return i.jsxs("div",{className:"add-patient-page-container flex flex-col items-center justify-start",children:[i.jsxs("div",{className:"w-full max-w-3xl mb-2 flex justify-start",children:[" ",i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Back to Previous Page",children:[i.jsx(Lt,{size:20,className:"btn-icon"})," Back"]})]}),i.jsxs("div",{className:"add-patient-card",children:[i.jsxs("h3",{className:"add-patient-title",children:[i.jsx(I_,{size:28})," ",v?"Add Existing Patient to Queue":"Register New Patient & Add to Queue"]}),i.jsxs("div",{className:"search-section",children:[i.jsx("legend",{className:"form-fieldset legend",children:"Find Existing Patient"})," ",i.jsxs("div",{className:"flex items-center space-x-2",children:[" ",i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by Name or Phone...",value:d,onChange:O=>h(O.target.value),className:"form-input",disabled:r||!!v}),i.jsx(Si,{size:18,className:`${k?"text-primary animate-pulse":""}`})," "]}),v&&i.jsxs("button",{type:"button",onClick:B,className:"btn btn-danger",title:"Clear Selection",children:[i.jsx(Qn,{size:16,className:"btn-icon"})," Clear"]})]}),g.length>0&&!v&&i.jsx("ul",{className:"search-results-list",children:g.map(O=>i.jsxs("li",{onClick:()=>$(O),children:[O.name," (ID: ",O.id,", Phone: ",O.phone||"N/A",")"]},O.id))}),d.length>=2&&g.length===0&&!k&&!v&&i.jsxs("p",{className:"search-info-text",children:['No patients found matching "',d,'". You can register them below.']}),k&&d.length>=2&&i.jsx("p",{className:"search-info-text searching",children:"Searching..."})]}),l&&i.jsxs("div",{className:"alert alert-danger",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:l})]}),f&&i.jsxs("div",{className:"alert alert-success",role:"alert",children:[i.jsx("strong",{children:"Success: "}),i.jsx("span",{children:f})]}),i.jsxs("form",{onSubmit:q,className:"space-y-5",children:[" ",i.jsxs("fieldset",{className:`form-fieldset ${v?"fieldset-disabled":""}`,children:[i.jsx("legend",{children:v?`Selected Patient: ${v.name}`:"New Patient Details"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Full Name *"}),i.jsx("input",{type:"text",name:"name",value:v?v.name:n.name,onChange:z,className:"form-input",required:!v,disabled:r||!!v})]}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Age"}),i.jsx("input",{type:"number",name:"age",value:v?v.age??"":n.age,onChange:z,className:"form-input",min:"0",disabled:r||!!v})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Gender"}),i.jsxs("select",{name:"gender",value:v?v.gender??"":n.gender,onChange:z,className:"form-select",disabled:r||!!v,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Phone"}),i.jsx("input",{type:"tel",name:"phone",value:v?v.phone??"":n.phone,onChange:z,className:"form-input",disabled:r||!!v})]})]})]}),i.jsxs("fieldset",{className:"form-fieldset",children:[i.jsx("legend",{children:"Visit Details"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Assign Doctor (Optional)"}),i.jsxs("select",{name:"doctorId",value:n.doctorId,onChange:z,className:`form-select ${P?"opacity-50":""}`,disabled:r||P,children:[i.jsx("option",{value:"",children:P?"Loading doctors...":E.length===0?"No doctors available":"-- No Doctor (Add to General Queue) --"}),E.map(O=>i.jsx("option",{value:O.id,children:O.name},O.id))]}),E.length===0&&!P&&i.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Please add doctors via the Admin Panel."})]}),i.jsxs("div",{className:"form-grid-col-span-2",children:[" ",i.jsx("label",{className:"form-label",children:"Patient Data / Reason"}),i.jsx("textarea",{name:"complaint",value:n.complaint,onChange:z,rows:2,className:"form-textarea",disabled:r})]})]})]}),i.jsxs("button",{type:"submit",className:`btn btn-primary floating-action-btn ${r||P?"disabled":""}`,disabled:r||P,children:[i.jsx(P_,{size:18,className:"btn-icon"}),r?"Processing...":v?"Add Existing to Queue":"Register & Add to Queue"]})]})]})]})},yU=({clinicId:e})=>{const n=gt(),[t,r]=w.useState({name:"",email:"",role:"receptionist",password:"",opd_fee:""}),[a,l]=w.useState(null),[o,f]=w.useState(!1);w.useEffect(()=>{l(e?null:"Clinic information is missing. Cannot add staff. Please ensure you are logged in correctly.")},[e]);const u=g=>{const{name:b,value:v}=g.target;r(N=>{const k={...N,[b]:v};return b==="role"&&v!=="doctor"&&(k.opd_fee=""),k})},d=async g=>{if(g.preventDefault(),l(null),!t.name||!t.email||!t.role||!t.password){l("Name, Email, Role, and Password are required.");return}if(!e){l("Clinic information is missing. Cannot add staff.");return}const b={...t,clinic_id:e,opd_fee:t.role==="doctor"&&t.opd_fee?parseFloat(String(t.opd_fee)):null};if(b.role==="doctor"&&t.opd_fee&&isNaN(b.opd_fee)){l("Invalid OPD Fee format. Please enter a number.");return}f(!0);try{const v=await pe("/api/staff",{method:"POST",body:JSON.stringify(b)});if(!v.ok){const N=await v.json();throw new Error(N.message||"Server responded with an error")}n(-1)}catch(v){l(`Failed to add staff: ${v.message}`)}finally{f(!1)}},h=()=>{n(-1)};return i.jsxs("div",{className:"staff-page-container",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("button",{onClick:h,className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[i.jsx(Lt,{size:18,className:"mr-2"}),"Back"]}),i.jsx("h1",{children:"Add New Staff Member"}),i.jsx("div",{className:"w-16"})," "]}),a&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[i.jsx(ti,{size:18,className:"mr-2 text-red-500"}),a]}),i.jsxs("form",{onSubmit:d,className:`staff-form ${e?"":"opacity-50 pointer-events-none"}`,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Full Name"}),i.jsx("input",{id:"name",type:"text",name:"name",value:t.name||"",onChange:u,required:!0,disabled:o||!e,placeholder:"Enter full name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email Address"}),i.jsx("input",{id:"email",type:"email",name:"email",value:t.email||"",onChange:u,required:!0,disabled:o||!e,placeholder:"Enter email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"role",children:"Assign Role"}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:u,required:!0,disabled:o||!e,children:[i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"}),i.jsx("option",{value:"lab",children:"Lab Technician"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"Set Initial Password"}),i.jsx("input",{id:"password",type:"password",name:"password",value:t.password||"",onChange:u,required:!0,disabled:o||!e,placeholder:"Create a password"})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"opd_fee",children:"OPD Consultation Fee () (Optional)"}),i.jsx("input",{id:"opd_fee",type:"number",name:"opd_fee",value:t.opd_fee||"",onChange:u,step:"0.01",min:"0",placeholder:"e.g., 150.00",disabled:o||!e}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank if no specific fee is set for this doctor."})]}),i.jsxs("button",{type:"submit",disabled:o||!e,children:[o?i.jsx(Dd,{size:18,className:"animate-spin mr-2"}):i.jsx(Ao,{size:18,className:"mr-2"}),o?"Adding...":"Add Staff Member"]})]})]})},xU=()=>{const{id:e}=jr(),n=gt(),[t,r]=w.useState({name:"",email:"",role:"receptionist",opd_fee:"",active:!0}),[a,l]=w.useState(""),[o,f]=w.useState(!0),[u,d]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(null),N=w.useCallback(async()=>{if(!e){g("Staff ID is missing."),f(!1);return}f(!0),g(null),v(null);try{const I=await pe(`/staff/${e}`);if(!I.ok){const V=await I.json();throw new Error(V.message||`HTTP error! status: ${I.status}`)}const P=await I.json();r({name:P.name,email:P.email,role:P.role,opd_fee:P.opd_fee??"",active:P.active})}catch(I){g(`Failed to load staff details: ${I.message}`)}finally{f(!1)}},[e]);w.useEffect(()=>{N()},[N]);const k=I=>{const{name:P,value:V,type:F}=I.target;if(F==="checkbox"){const{checked:$}=I.target;r(B=>({...B,[P]:$}))}else r($=>({...$,[P]:V}))},T=I=>{l(I.target.value)},E=async I=>{if(I.preventDefault(),!e){g("Staff ID is missing.");return}d(!0),g(null),v(null);const P={name:t.name,email:t.email,role:t.role,active:t.active};if(t.role==="doctor"){const V=t.opd_fee?parseFloat(String(t.opd_fee)):null;if(V!==null&&isNaN(V)){g("OPD Fee must be a valid number."),d(!1);return}P.opd_fee=V}else P.opd_fee=null;a.trim()!==""&&(P.password=a.trim());try{const V=await pe(`/staff/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(P)});if(!V.ok){const F=await V.json();throw new Error(F.message||`HTTP error! status: ${V.status}`)}v("Staff details updated successfully!"),l(""),setTimeout(()=>n(-1),1500)}catch(V){g(`Failed to update staff: ${V.message}`)}finally{d(!1)}};return o?i.jsxs("div",{className:"flex justify-center items-center h-screen",children:[i.jsx(Dd,{className:"h-12 w-12 animate-spin text-teal-600"}),i.jsx("span",{className:"ml-4 text-xl text-gray-700",children:"Loading Staff Details..."})]}):i.jsxs("div",{className:"staff-page-container",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[i.jsx(Lt,{size:18,className:"mr-2"}),"Back"]}),i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Edit Staff Member"}),i.jsx("div",{className:"w-16"})," "]}),h&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[i.jsx(ti,{size:18,className:"mr-2 text-red-500"}),h,i.jsx("button",{onClick:()=>g(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),b&&i.jsxs("div",{className:"success-message mb-4 p-3 bg-green-100 border border-green-400 rounded-md flex items-center",children:[i.jsx(Ra,{size:18,className:"mr-2 text-green-500"}),b,i.jsx("button",{onClick:()=>v(null),className:"ml-auto text-green-600 hover:text-green-800 text-xl font-bold",children:""})]}),i.jsxs("form",{onSubmit:E,className:"staff-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Full Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:t.name||"",onChange:k,required:!0,placeholder:"Enter full name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"email",children:["Email Address ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"email",id:"email",name:"email",value:t.email||"",onChange:k,required:!0,placeholder:"Enter email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"role",children:["Role ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:k,required:!0,children:[i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"lab",children:"Lab Technician"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"})]})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"opd_fee",children:"OPD Fee ()"}),i.jsx("input",{type:"number",id:"opd_fee",name:"opd_fee",value:t.opd_fee||"",onChange:k,min:"0",step:"0.01",placeholder:"Enter OPD consultation fee (optional)"})]}),i.jsxs("div",{className:"form-group checkbox-group",children:[i.jsx("input",{id:"active",name:"active",type:"checkbox",checked:t.active??!0,onChange:k}),i.jsxs("label",{htmlFor:"active",className:"mb-0",children:[" ","Account Active"]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"New Password (optional)"}),i.jsx("input",{type:"password",id:"password",name:"password",value:a,onChange:T,placeholder:"Leave blank to keep current password",autoComplete:"new-password"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter a new password only if you want to change it. Minimum 6 characters."})]}),i.jsx("button",{type:"submit",disabled:u,children:u?i.jsxs(i.Fragment,{children:[i.jsx(Dd,{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Id,{size:16,className:"mr-2"}),"Save Changes"]})})]})]})};function bU(e,n){const t={};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const vU=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,wU=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,SU={};function gC(e,n){return(SU.jsx?wU:vU).test(e)}const NU=/[ \t\n\f\r]/g;function CU(e){return typeof e=="object"?e.type==="text"?yC(e.value):!1:yC(e)}function yC(e){return e.replace(NU,"")===""}let og=class{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}};og.prototype.normal={};og.prototype.property={};og.prototype.space=void 0;function sk(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new og(t,r,n)}function u1(e){return e.toLowerCase()}let aa=class{constructor(n,t){this.attribute=t,this.property=n}};aa.prototype.attribute="";aa.prototype.booleanish=!1;aa.prototype.boolean=!1;aa.prototype.commaOrSpaceSeparated=!1;aa.prototype.commaSeparated=!1;aa.prototype.defined=!1;aa.prototype.mustUseProperty=!1;aa.prototype.number=!1;aa.prototype.overloadedBoolean=!1;aa.prototype.property="";aa.prototype.spaceSeparated=!1;aa.prototype.space=void 0;let jU=0;const Ft=$d(),Ei=$d(),lk=$d(),it=$d(),Yn=$d(),Nh=$d(),Ta=$d();function $d(){return 2**++jU}const d1=Object.freeze(Object.defineProperty({__proto__:null,boolean:Ft,booleanish:Ei,commaOrSpaceSeparated:Ta,commaSeparated:Nh,number:it,overloadedBoolean:lk,spaceSeparated:Yn},Symbol.toStringTag,{value:"Module"})),rv=Object.keys(d1);let pw=class extends aa{constructor(n,t,r,a){let l=-1;if(super(n,t),xC(this,"space",a),typeof r=="number")for(;++l<rv.length;){const o=rv[l];xC(this,rv[l],(r&d1[o])===d1[o])}}};pw.prototype.defined=!0;function xC(e,n,t){t&&(e[n]=t)}function $h(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const l=new pw(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(l.mustUseProperty=!0),n[r]=l,t[u1(r)]=r,t[u1(l.attribute)]=r}return new og(n,t,e.space)}const ok=$h({properties:{ariaActiveDescendant:null,ariaAtomic:Ei,ariaAutoComplete:null,ariaBusy:Ei,ariaChecked:Ei,ariaColCount:it,ariaColIndex:it,ariaColSpan:it,ariaControls:Yn,ariaCurrent:null,ariaDescribedBy:Yn,ariaDetails:null,ariaDisabled:Ei,ariaDropEffect:Yn,ariaErrorMessage:null,ariaExpanded:Ei,ariaFlowTo:Yn,ariaGrabbed:Ei,ariaHasPopup:null,ariaHidden:Ei,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Yn,ariaLevel:it,ariaLive:null,ariaModal:Ei,ariaMultiLine:Ei,ariaMultiSelectable:Ei,ariaOrientation:null,ariaOwns:Yn,ariaPlaceholder:null,ariaPosInSet:it,ariaPressed:Ei,ariaReadOnly:Ei,ariaRelevant:null,ariaRequired:Ei,ariaRoleDescription:Yn,ariaRowCount:it,ariaRowIndex:it,ariaRowSpan:it,ariaSelected:Ei,ariaSetSize:it,ariaSort:null,ariaValueMax:it,ariaValueMin:it,ariaValueNow:it,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function ck(e,n){return n in e?e[n]:n}function uk(e,n){return ck(e,n.toLowerCase())}const _U=$h({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Nh,acceptCharset:Yn,accessKey:Yn,action:null,allow:null,allowFullScreen:Ft,allowPaymentRequest:Ft,allowUserMedia:Ft,alt:null,as:null,async:Ft,autoCapitalize:null,autoComplete:Yn,autoFocus:Ft,autoPlay:Ft,blocking:Yn,capture:null,charSet:null,checked:Ft,cite:null,className:Yn,cols:it,colSpan:null,content:null,contentEditable:Ei,controls:Ft,controlsList:Yn,coords:it|Nh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Ft,defer:Ft,dir:null,dirName:null,disabled:Ft,download:lk,draggable:Ei,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Ft,formTarget:null,headers:Yn,height:it,hidden:Ft,high:it,href:null,hrefLang:null,htmlFor:Yn,httpEquiv:Yn,id:null,imageSizes:null,imageSrcSet:null,inert:Ft,inputMode:null,integrity:null,is:null,isMap:Ft,itemId:null,itemProp:Yn,itemRef:Yn,itemScope:Ft,itemType:Yn,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Ft,low:it,manifest:null,max:null,maxLength:it,media:null,method:null,min:null,minLength:it,multiple:Ft,muted:Ft,name:null,nonce:null,noModule:Ft,noValidate:Ft,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Ft,optimum:it,pattern:null,ping:Yn,placeholder:null,playsInline:Ft,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Ft,referrerPolicy:null,rel:Yn,required:Ft,reversed:Ft,rows:it,rowSpan:it,sandbox:Yn,scope:null,scoped:Ft,seamless:Ft,selected:Ft,shadowRootClonable:Ft,shadowRootDelegatesFocus:Ft,shadowRootMode:null,shape:null,size:it,sizes:null,slot:null,span:it,spellCheck:Ei,src:null,srcDoc:null,srcLang:null,srcSet:null,start:it,step:null,style:null,tabIndex:it,target:null,title:null,translate:null,type:null,typeMustMatch:Ft,useMap:null,value:Ei,width:it,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Yn,axis:null,background:null,bgColor:null,border:it,borderColor:null,bottomMargin:it,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Ft,declare:Ft,event:null,face:null,frame:null,frameBorder:null,hSpace:it,leftMargin:it,link:null,longDesc:null,lowSrc:null,marginHeight:it,marginWidth:it,noResize:Ft,noHref:Ft,noShade:Ft,noWrap:Ft,object:null,profile:null,prompt:null,rev:null,rightMargin:it,rules:null,scheme:null,scrolling:Ei,standby:null,summary:null,text:null,topMargin:it,valueType:null,version:null,vAlign:null,vLink:null,vSpace:it,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Ft,disableRemotePlayback:Ft,prefix:null,property:null,results:it,security:null,unselectable:null},space:"html",transform:uk}),kU=$h({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ta,accentHeight:it,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:it,amplitude:it,arabicForm:null,ascent:it,attributeName:null,attributeType:null,azimuth:it,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:it,by:null,calcMode:null,capHeight:it,className:Yn,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:it,diffuseConstant:it,direction:null,display:null,dur:null,divisor:it,dominantBaseline:null,download:Ft,dx:null,dy:null,edgeMode:null,editable:null,elevation:it,enableBackground:null,end:null,event:null,exponent:it,externalResourcesRequired:null,fill:null,fillOpacity:it,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Nh,g2:Nh,glyphName:Nh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:it,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:it,horizOriginX:it,horizOriginY:it,id:null,ideographic:it,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:it,k:it,k1:it,k2:it,k3:it,k4:it,kernelMatrix:Ta,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:it,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:it,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:it,overlineThickness:it,paintOrder:null,panose1:null,path:null,pathLength:it,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Yn,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:it,pointsAtY:it,pointsAtZ:it,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ta,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ta,rev:Ta,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ta,requiredFeatures:Ta,requiredFonts:Ta,requiredFormats:Ta,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:it,specularExponent:it,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:it,strikethroughThickness:it,string:null,stroke:null,strokeDashArray:Ta,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:it,strokeOpacity:it,strokeWidth:null,style:null,surfaceScale:it,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ta,tabIndex:it,tableValues:null,target:null,targetX:it,targetY:it,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ta,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:it,underlineThickness:it,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:it,values:null,vAlphabetic:it,vMathematical:it,vectorEffect:null,vHanging:it,vIdeographic:it,version:null,vertAdvY:it,vertOriginX:it,vertOriginY:it,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:it,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:ck}),dk=$h({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),fk=$h({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:uk}),hk=$h({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),EU={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},TU=/[A-Z]/g,bC=/-[a-z]/g,AU=/^data[-\w.:]+$/i;function DU(e,n){const t=u1(n);let r=n,a=aa;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&AU.test(n)){if(n.charAt(4)==="-"){const l=n.slice(5).replace(bC,IU);r="data"+l.charAt(0).toUpperCase()+l.slice(1)}else{const l=n.slice(4);if(!bC.test(l)){let o=l.replace(TU,PU);o.charAt(0)!=="-"&&(o="-"+o),n="data"+o}}a=pw}return new a(r,n)}function PU(e){return"-"+e.toLowerCase()}function IU(e){return e.charAt(1).toUpperCase()}const MU=sk([ok,_U,dk,fk,hk],"html"),mw=sk([ok,kU,dk,fk,hk],"svg");function RU(e){return e.join(" ").trim()}var hh={},av,vC;function LU(){if(vC)return av;vC=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=/\n/g,t=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,a=/^:\s*/,l=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,o=/^[;\s]*/,f=/^\s+|\s+$/g,u=`
`,d="/",h="*",g="",b="comment",v="declaration";av=function(k,T){if(typeof k!="string")throw new TypeError("First argument must be a string");if(!k)return[];T=T||{};var E=1,I=1;function P(ee){var te=ee.match(n);te&&(E+=te.length);var le=ee.lastIndexOf(u);I=~le?ee.length-le:I+ee.length}function V(){var ee={line:E,column:I};return function(te){return te.position=new F(ee),z(),te}}function F(ee){this.start=ee,this.end={line:E,column:I},this.source=T.source}F.prototype.content=k;function $(ee){var te=new Error(T.source+":"+E+":"+I+": "+ee);if(te.reason=ee,te.filename=T.source,te.line=E,te.column=I,te.source=k,!T.silent)throw te}function B(ee){var te=ee.exec(k);if(te){var le=te[0];return P(le),k=k.slice(le.length),te}}function z(){B(t)}function q(ee){var te;for(ee=ee||[];te=O();)te!==!1&&ee.push(te);return ee}function O(){var ee=V();if(!(d!=k.charAt(0)||h!=k.charAt(1))){for(var te=2;g!=k.charAt(te)&&(h!=k.charAt(te)||d!=k.charAt(te+1));)++te;if(te+=2,g===k.charAt(te-1))return $("End of comment missing");var le=k.slice(2,te-2);return I+=2,P(le),k=k.slice(te),I+=2,ee({type:b,comment:le})}}function R(){var ee=V(),te=B(r);if(te){if(O(),!B(a))return $("property missing ':'");var le=B(l),K=ee({type:v,property:N(te[0].replace(e,g)),value:le?N(le[0].replace(e,g)):g});return B(o),K}}function G(){var ee=[];q(ee);for(var te;te=R();)te!==!1&&(ee.push(te),q(ee));return ee}return z(),G()};function N(k){return k?k.replace(f,g):g}return av}var wC;function OU(){if(wC)return hh;wC=1;var e=hh&&hh.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(hh,"__esModule",{value:!0}),hh.default=t;var n=e(LU());function t(r,a){var l=null;if(!r||typeof r!="string")return l;var o=(0,n.default)(r),f=typeof a=="function";return o.forEach(function(u){if(u.type==="declaration"){var d=u.property,h=u.value;f?a(d,h,u):h&&(l=l||{},l[d]=h)}}),l}return hh}var Tm={},SC;function FU(){if(SC)return Tm;SC=1,Object.defineProperty(Tm,"__esModule",{value:!0}),Tm.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,n=/-([a-z])/g,t=/^[^-]+$/,r=/^-(webkit|moz|ms|o|khtml)-/,a=/^-(ms)-/,l=function(d){return!d||t.test(d)||e.test(d)},o=function(d,h){return h.toUpperCase()},f=function(d,h){return"".concat(h,"-")},u=function(d,h){return h===void 0&&(h={}),l(d)?d:(d=d.toLowerCase(),h.reactCompat?d=d.replace(a,f):d=d.replace(r,f),d.replace(n,o))};return Tm.camelCase=u,Tm}var Am,NC;function $U(){if(NC)return Am;NC=1;var e=Am&&Am.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},n=e(OU()),t=FU();function r(a,l){var o={};return!a||typeof a!="string"||(0,n.default)(a,function(f,u){f&&u&&(o[(0,t.camelCase)(f,l)]=u)}),o}return r.default=r,Am=r,Am}var zU=$U();const BU=Fd(zU),pk=mk("end"),gw=mk("start");function mk(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function UU(e){const n=gw(e),t=pk(e);if(n&&t)return{start:n,end:t}}function zm(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?CC(e.position):"start"in e||"end"in e?CC(e):"line"in e||"column"in e?f1(e):""}function f1(e){return jC(e&&e.line)+":"+jC(e&&e.column)}function CC(e){return f1(e&&e.start)+"-"+f1(e&&e.end)}function jC(e){return e&&typeof e=="number"?e:1}let _r=class extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",l={},o=!1;if(t&&("line"in t&&"column"in t?l={place:t}:"start"in t&&"end"in t?l={place:t}:"type"in t?l={ancestors:[t],place:t.position}:l={...t}),typeof n=="string"?a=n:!l.cause&&n&&(o=!0,a=n.message,l.cause=n),!l.ruleId&&!l.source&&typeof r=="string"){const u=r.indexOf(":");u===-1?l.ruleId=r:(l.source=r.slice(0,u),l.ruleId=r.slice(u+1))}if(!l.place&&l.ancestors&&l.ancestors){const u=l.ancestors[l.ancestors.length-1];u&&(l.place=u.position)}const f=l.place&&"start"in l.place?l.place.start:l.place;this.ancestors=l.ancestors||void 0,this.cause=l.cause||void 0,this.column=f?f.column:void 0,this.fatal=void 0,this.file,this.message=a,this.line=f?f.line:void 0,this.name=zm(l.place)||"1:1",this.place=l.place||void 0,this.reason=this.message,this.ruleId=l.ruleId||void 0,this.source=l.source||void 0,this.stack=o&&l.cause&&typeof l.cause.stack=="string"?l.cause.stack:"",this.actual,this.expected,this.note,this.url}};_r.prototype.file="";_r.prototype.name="";_r.prototype.reason="";_r.prototype.message="";_r.prototype.stack="";_r.prototype.column=void 0;_r.prototype.line=void 0;_r.prototype.ancestors=void 0;_r.prototype.cause=void 0;_r.prototype.fatal=void 0;_r.prototype.place=void 0;_r.prototype.ruleId=void 0;_r.prototype.source=void 0;const yw={}.hasOwnProperty,qU=new Map,VU=/[A-Z]/g,HU=new Set(["table","tbody","thead","tfoot","tr"]),GU=new Set(["td","th"]),gk="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function YU(e,n){if(!n||n.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=n.filePath||void 0;let r;if(n.development){if(typeof n.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=t9(t,n.jsxDEV)}else{if(typeof n.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof n.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=e9(t,n.jsx,n.jsxs)}const a={Fragment:n.Fragment,ancestors:[],components:n.components||{},create:r,elementAttributeNameCase:n.elementAttributeNameCase||"react",evaluater:n.createEvaluater?n.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:n.ignoreInvalidStyle||!1,passKeys:n.passKeys!==!1,passNode:n.passNode||!1,schema:n.space==="svg"?mw:MU,stylePropertyNameCase:n.stylePropertyNameCase||"dom",tableCellAlignToStyle:n.tableCellAlignToStyle!==!1},l=yk(a,e,void 0);return l&&typeof l!="string"?l:a.create(e,a.Fragment,{children:l||void 0},void 0)}function yk(e,n,t){if(n.type==="element")return WU(e,n,t);if(n.type==="mdxFlowExpression"||n.type==="mdxTextExpression")return QU(e,n);if(n.type==="mdxJsxFlowElement"||n.type==="mdxJsxTextElement")return KU(e,n,t);if(n.type==="mdxjsEsm")return JU(e,n);if(n.type==="root")return XU(e,n,t);if(n.type==="text")return ZU(e,n)}function WU(e,n,t){const r=e.schema;let a=r;n.tagName.toLowerCase()==="svg"&&r.space==="html"&&(a=mw,e.schema=a),e.ancestors.push(n);const l=bk(e,n.tagName,!1),o=n9(e,n);let f=bw(e,n);return HU.has(n.tagName)&&(f=f.filter(function(u){return typeof u=="string"?!CU(u):!0})),xk(e,o,l,n),xw(o,f),e.ancestors.pop(),e.schema=r,e.create(n,l,o,t)}function QU(e,n){if(n.data&&n.data.estree&&e.evaluater){const r=n.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}Zm(e,n.position)}function JU(e,n){if(n.data&&n.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(n.data.estree);Zm(e,n.position)}function KU(e,n,t){const r=e.schema;let a=r;n.name==="svg"&&r.space==="html"&&(a=mw,e.schema=a),e.ancestors.push(n);const l=n.name===null?e.Fragment:bk(e,n.name,!0),o=i9(e,n),f=bw(e,n);return xk(e,o,l,n),xw(o,f),e.ancestors.pop(),e.schema=r,e.create(n,l,o,t)}function XU(e,n,t){const r={};return xw(r,bw(e,n)),e.create(n,e.Fragment,r,t)}function ZU(e,n){return n.value}function xk(e,n,t,r){typeof t!="string"&&t!==e.Fragment&&e.passNode&&(n.node=r)}function xw(e,n){if(n.length>0){const t=n.length>1?n:n[0];t&&(e.children=t)}}function e9(e,n,t){return r;function r(a,l,o,f){const d=Array.isArray(o.children)?t:n;return f?d(l,o,f):d(l,o)}}function t9(e,n){return t;function t(r,a,l,o){const f=Array.isArray(l.children),u=gw(r);return n(a,l,o,f,{columnNumber:u?u.column-1:void 0,fileName:e,lineNumber:u?u.line:void 0},void 0)}}function n9(e,n){const t={};let r,a;for(a in n.properties)if(a!=="children"&&yw.call(n.properties,a)){const l=r9(e,a,n.properties[a]);if(l){const[o,f]=l;e.tableCellAlignToStyle&&o==="align"&&typeof f=="string"&&GU.has(n.tagName)?r=f:t[o]=f}}if(r){const l=t.style||(t.style={});l[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return t}function i9(e,n){const t={};for(const r of n.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const l=r.data.estree.body[0];l.type;const o=l.expression;o.type;const f=o.properties[0];f.type,Object.assign(t,e.evaluater.evaluateExpression(f.argument))}else Zm(e,n.position);else{const a=r.name;let l;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const f=r.value.data.estree.body[0];f.type,l=e.evaluater.evaluateExpression(f.expression)}else Zm(e,n.position);else l=r.value===null?!0:r.value;t[a]=l}return t}function bw(e,n){const t=[];let r=-1;const a=e.passKeys?new Map:qU;for(;++r<n.children.length;){const l=n.children[r];let o;if(e.passKeys){const u=l.type==="element"?l.tagName:l.type==="mdxJsxFlowElement"||l.type==="mdxJsxTextElement"?l.name:void 0;if(u){const d=a.get(u)||0;o=u+"-"+d,a.set(u,d+1)}}const f=yk(e,l,o);f!==void 0&&t.push(f)}return t}function r9(e,n,t){const r=DU(e.schema,n);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=r.commaSeparated?bU(t):RU(t)),r.property==="style"){let a=typeof t=="object"?t:a9(e,String(t));return e.stylePropertyNameCase==="css"&&(a=s9(a)),["style",a]}return[e.elementAttributeNameCase==="react"&&r.space?EU[r.property]||r.property:r.attribute,t]}}function a9(e,n){try{return BU(n,{reactCompat:!0})}catch(t){if(e.ignoreInvalidStyle)return{};const r=t,a=new _r("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=e.filePath||void 0,a.url=gk+"#cannot-parse-style-attribute",a}}function bk(e,n,t){let r;if(!t)r={type:"Literal",value:n};else if(n.includes(".")){const a=n.split(".");let l=-1,o;for(;++l<a.length;){const f=gC(a[l])?{type:"Identifier",name:a[l]}:{type:"Literal",value:a[l]};o=o?{type:"MemberExpression",object:o,property:f,computed:!!(l&&f.type==="Literal"),optional:!1}:f}r=o}else r=gC(n)&&!/^[a-z]/.test(n)?{type:"Identifier",name:n}:{type:"Literal",value:n};if(r.type==="Literal"){const a=r.value;return yw.call(e.components,a)?e.components[a]:a}if(e.evaluater)return e.evaluater.evaluateExpression(r);Zm(e)}function Zm(e,n){const t=new _r("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:n,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=e.filePath||void 0,t.url=gk+"#cannot-handle-mdx-estrees-without-createevaluater",t}function s9(e){const n={};let t;for(t in e)yw.call(e,t)&&(n[l9(t)]=e[t]);return n}function l9(e){let n=e.replace(VU,o9);return n.slice(0,3)==="ms-"&&(n="-"+n),n}function o9(e){return"-"+e.toLowerCase()}const sv={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},c9={};function vw(e,n){const t=c9,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return vk(e,r,a)}function vk(e,n,t){if(u9(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return _C(e.children,n,t)}return Array.isArray(e)?_C(e,n,t):""}function _C(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=vk(e[a],n,t);return r.join("")}function u9(e){return!!(e&&typeof e=="object")}const kC=document.createElement("i");function ww(e){const n="&"+e+";";kC.innerHTML=n;const t=kC.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function Ma(e,n,t,r){const a=e.length;let l=0,o;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)o=Array.from(r),o.unshift(n,t),e.splice(...o);else for(t&&e.splice(n,t);l<r.length;)o=r.slice(l,l+1e4),o.unshift(n,0),e.splice(...o),l+=1e4,n+=1e4}function ts(e,n){return e.length>0?(Ma(e,e.length,0,n),e):n}const EC={}.hasOwnProperty;function wk(e){const n={};let t=-1;for(;++t<e.length;)d9(n,e[t]);return n}function d9(e,n){let t;for(t in n){const a=(EC.call(e,t)?e[t]:void 0)||(e[t]={}),l=n[t];let o;if(l)for(o in l){EC.call(a,o)||(a[o]=[]);const f=l[o];f9(a[o],Array.isArray(f)?f:f?[f]:[])}}}function f9(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);Ma(e,0,0,r)}function Sk(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function Ls(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Lr=Jc(/[A-Za-z]/),Nr=Jc(/[\dA-Za-z]/),h9=Jc(/[#-'*+\--9=?A-Z^-~]/);function ob(e){return e!==null&&(e<32||e===127)}const h1=Jc(/\d/),p9=Jc(/[\dA-Fa-f]/),m9=Jc(/[!-/:-@[-`{-~]/);function jt(e){return e!==null&&e<-2}function Bn(e){return e!==null&&(e<0||e===32)}function rn(e){return e===-2||e===-1||e===32}const Ib=Jc(new RegExp("\\p{P}|\\p{S}","u")),Ld=Jc(/\s/);function Jc(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function zh(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const l=e.charCodeAt(t);let o="";if(l===37&&Nr(e.charCodeAt(t+1))&&Nr(e.charCodeAt(t+2)))a=2;else if(l<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(l))||(o=String.fromCharCode(l));else if(l>55295&&l<57344){const f=e.charCodeAt(t+1);l<56320&&f>56319&&f<57344?(o=String.fromCharCode(l,f),a=1):o=""}else o=String.fromCharCode(l);o&&(n.push(e.slice(r,t),encodeURIComponent(o)),r=t+a+1,o=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function dn(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let l=0;return o;function o(u){return rn(u)?(e.enter(t),f(u)):n(u)}function f(u){return rn(u)&&l++<a?(e.consume(u),f):(e.exit(t),n(u))}}const g9={tokenize:y9};function y9(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(f){if(f===null){e.consume(f);return}return e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),dn(e,n,"linePrefix")}function a(f){return e.enter("paragraph"),l(f)}function l(f){const u=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=u),t=u,o(f)}function o(f){if(f===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(f);return}return jt(f)?(e.consume(f),e.exit("chunkText"),l):(e.consume(f),o)}}const x9={tokenize:b9},TC={tokenize:v9};function b9(e){const n=this,t=[];let r=0,a,l,o;return f;function f(P){if(r<t.length){const V=t[r];return n.containerState=V[1],e.attempt(V[0].continuation,u,d)(P)}return d(P)}function u(P){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&I();const V=n.events.length;let F=V,$;for(;F--;)if(n.events[F][0]==="exit"&&n.events[F][1].type==="chunkFlow"){$=n.events[F][1].end;break}E(r);let B=V;for(;B<n.events.length;)n.events[B][1].end={...$},B++;return Ma(n.events,F+1,0,n.events.slice(V)),n.events.length=B,d(P)}return f(P)}function d(P){if(r===t.length){if(!a)return b(P);if(a.currentConstruct&&a.currentConstruct.concrete)return N(P);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(TC,h,g)(P)}function h(P){return a&&I(),E(r),b(P)}function g(P){return n.parser.lazy[n.now().line]=r!==t.length,o=n.now().offset,N(P)}function b(P){return n.containerState={},e.attempt(TC,v,N)(P)}function v(P){return r++,t.push([n.currentConstruct,n.containerState]),b(P)}function N(P){if(P===null){a&&I(),E(0),e.consume(P);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:l}),k(P)}function k(P){if(P===null){T(e.exit("chunkFlow"),!0),E(0),e.consume(P);return}return jt(P)?(e.consume(P),T(e.exit("chunkFlow")),r=0,n.interrupt=void 0,f):(e.consume(P),k)}function T(P,V){const F=n.sliceStream(P);if(V&&F.push(null),P.previous=l,l&&(l.next=P),l=P,a.defineSkip(P.start),a.write(F),n.parser.lazy[P.start.line]){let $=a.events.length;for(;$--;)if(a.events[$][1].start.offset<o&&(!a.events[$][1].end||a.events[$][1].end.offset>o))return;const B=n.events.length;let z=B,q,O;for(;z--;)if(n.events[z][0]==="exit"&&n.events[z][1].type==="chunkFlow"){if(q){O=n.events[z][1].end;break}q=!0}for(E(r),$=B;$<n.events.length;)n.events[$][1].end={...O},$++;Ma(n.events,z+1,0,n.events.slice(B)),n.events.length=$}}function E(P){let V=t.length;for(;V-- >P;){const F=t[V];n.containerState=F[1],F[0].exit.call(n,e)}t.length=P}function I(){a.write([null]),l=void 0,a=void 0,n.containerState._closeFlow=void 0}}function v9(e,n,t){return dn(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Ph(e){if(e===null||Bn(e)||Ld(e))return 1;if(Ib(e))return 2}function Mb(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const l=e[a].resolveAll;l&&!r.includes(l)&&(n=l(n,t),r.push(l))}return n}const p1={name:"attention",resolveAll:w9,tokenize:S9};function w9(e,n){let t=-1,r,a,l,o,f,u,d,h;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;u=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};AC(g,-u),AC(b,u),o={type:u>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},f={type:u>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},l={type:u>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:u>1?"strong":"emphasis",start:{...o.start},end:{...f.end}},e[r][1].end={...o.start},e[t][1].start={...f.end},d=[],e[r][1].end.offset-e[r][1].start.offset&&(d=ts(d,[["enter",e[r][1],n],["exit",e[r][1],n]])),d=ts(d,[["enter",a,n],["enter",o,n],["exit",o,n],["enter",l,n]]),d=ts(d,Mb(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),d=ts(d,[["exit",l,n],["enter",f,n],["exit",f,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(h=2,d=ts(d,[["enter",e[t][1],n],["exit",e[t][1],n]])):h=0,Ma(e,r-1,t-r+3,d),t=r+d.length-h-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function S9(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=Ph(r);let l;return o;function o(u){return l=u,e.enter("attentionSequence"),f(u)}function f(u){if(u===l)return e.consume(u),f;const d=e.exit("attentionSequence"),h=Ph(u),g=!h||h===2&&a||t.includes(u),b=!a||a===2&&h||t.includes(r);return d._open=!!(l===42?g:g&&(a||!b)),d._close=!!(l===42?b:b&&(h||!g)),n(u)}}function AC(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const N9={name:"autolink",tokenize:C9};function C9(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),l}function l(v){return Lr(v)?(e.consume(v),o):v===64?t(v):d(v)}function o(v){return v===43||v===45||v===46||Nr(v)?(r=1,f(v)):d(v)}function f(v){return v===58?(e.consume(v),r=0,u):(v===43||v===45||v===46||Nr(v))&&r++<32?(e.consume(v),f):(r=0,d(v))}function u(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||ob(v)?t(v):(e.consume(v),u)}function d(v){return v===64?(e.consume(v),h):h9(v)?(e.consume(v),d):t(v)}function h(v){return Nr(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,h):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||Nr(v))&&r++<63){const N=v===45?b:g;return e.consume(v),N}return t(v)}}const cg={partial:!0,tokenize:j9};function j9(e,n,t){return r;function r(l){return rn(l)?dn(e,a,"linePrefix")(l):a(l)}function a(l){return l===null||jt(l)?n(l):t(l)}}const Nk={continuation:{tokenize:k9},exit:E9,name:"blockQuote",tokenize:_9};function _9(e,n,t){const r=this;return a;function a(o){if(o===62){const f=r.containerState;return f.open||(e.enter("blockQuote",{_container:!0}),f.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(o),e.exit("blockQuoteMarker"),l}return t(o)}function l(o){return rn(o)?(e.enter("blockQuotePrefixWhitespace"),e.consume(o),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(o))}}function k9(e,n,t){const r=this;return a;function a(o){return rn(o)?dn(e,l,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):l(o)}function l(o){return e.attempt(Nk,n,t)(o)}}function E9(e){e.exit("blockQuote")}const Ck={name:"characterEscape",tokenize:T9};function T9(e,n,t){return r;function r(l){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(l),e.exit("escapeMarker"),a}function a(l){return m9(l)?(e.enter("characterEscapeValue"),e.consume(l),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(l)}}const jk={name:"characterReference",tokenize:A9};function A9(e,n,t){const r=this;let a=0,l,o;return f;function f(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),u}function u(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),d):(e.enter("characterReferenceValue"),l=31,o=Nr,h(g))}function d(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),l=6,o=p9,h):(e.enter("characterReferenceValue"),l=7,o=h1,h(g))}function h(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return o===Nr&&!ww(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return o(g)&&a++<l?(e.consume(g),h):t(g)}}const DC={partial:!0,tokenize:P9},PC={concrete:!0,name:"codeFenced",tokenize:D9};function D9(e,n,t){const r=this,a={partial:!0,tokenize:F};let l=0,o=0,f;return u;function u($){return d($)}function d($){const B=r.events[r.events.length-1];return l=B&&B[1].type==="linePrefix"?B[2].sliceSerialize(B[1],!0).length:0,f=$,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),h($)}function h($){return $===f?(o++,e.consume($),h):o<3?t($):(e.exit("codeFencedFenceSequence"),rn($)?dn(e,g,"whitespace")($):g($))}function g($){return $===null||jt($)?(e.exit("codeFencedFence"),r.interrupt?n($):e.check(DC,k,V)($)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b($))}function b($){return $===null||jt($)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g($)):rn($)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),dn(e,v,"whitespace")($)):$===96&&$===f?t($):(e.consume($),b)}function v($){return $===null||jt($)?g($):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),N($))}function N($){return $===null||jt($)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g($)):$===96&&$===f?t($):(e.consume($),N)}function k($){return e.attempt(a,V,T)($)}function T($){return e.enter("lineEnding"),e.consume($),e.exit("lineEnding"),E}function E($){return l>0&&rn($)?dn(e,I,"linePrefix",l+1)($):I($)}function I($){return $===null||jt($)?e.check(DC,k,V)($):(e.enter("codeFlowValue"),P($))}function P($){return $===null||jt($)?(e.exit("codeFlowValue"),I($)):(e.consume($),P)}function V($){return e.exit("codeFenced"),n($)}function F($,B,z){let q=0;return O;function O(le){return $.enter("lineEnding"),$.consume(le),$.exit("lineEnding"),R}function R(le){return $.enter("codeFencedFence"),rn(le)?dn($,G,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(le):G(le)}function G(le){return le===f?($.enter("codeFencedFenceSequence"),ee(le)):z(le)}function ee(le){return le===f?(q++,$.consume(le),ee):q>=o?($.exit("codeFencedFenceSequence"),rn(le)?dn($,te,"whitespace")(le):te(le)):z(le)}function te(le){return le===null||jt(le)?($.exit("codeFencedFence"),B(le)):z(le)}}}function P9(e,n,t){const r=this;return a;function a(o){return o===null?t(o):(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),l)}function l(o){return r.parser.lazy[r.now().line]?t(o):n(o)}}const lv={name:"codeIndented",tokenize:M9},I9={partial:!0,tokenize:R9};function M9(e,n,t){const r=this;return a;function a(d){return e.enter("codeIndented"),dn(e,l,"linePrefix",5)(d)}function l(d){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?o(d):t(d)}function o(d){return d===null?u(d):jt(d)?e.attempt(I9,o,u)(d):(e.enter("codeFlowValue"),f(d))}function f(d){return d===null||jt(d)?(e.exit("codeFlowValue"),o(d)):(e.consume(d),f)}function u(d){return e.exit("codeIndented"),n(d)}}function R9(e,n,t){const r=this;return a;function a(o){return r.parser.lazy[r.now().line]?t(o):jt(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a):dn(e,l,"linePrefix",5)(o)}function l(o){const f=r.events[r.events.length-1];return f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?n(o):jt(o)?a(o):t(o)}}const L9={name:"codeText",previous:F9,resolve:O9,tokenize:$9};function O9(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function F9(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function $9(e,n,t){let r=0,a,l;return o;function o(g){return e.enter("codeText"),e.enter("codeTextSequence"),f(g)}function f(g){return g===96?(e.consume(g),r++,f):(e.exit("codeTextSequence"),u(g))}function u(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),u):g===96?(l=e.enter("codeTextSequence"),a=0,h(g)):jt(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),u):(e.enter("codeTextData"),d(g))}function d(g){return g===null||g===32||g===96||jt(g)?(e.exit("codeTextData"),u(g)):(e.consume(g),d)}function h(g){return g===96?(e.consume(g),a++,h):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(l.type="codeTextData",d(g))}}let z9=class{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const l=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&Dm(this.left,r),l.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Dm(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Dm(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Dm(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Dm(this.left,t.reverse())}}};function Dm(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function _k(e){const n={};let t=-1,r,a,l,o,f,u,d;const h=new z9(e);for(;++t<h.length;){for(;t in n;)t=n[t];if(r=h.get(t),t&&r[1].type==="chunkFlow"&&h.get(t-1)[1].type==="listItemPrefix"&&(u=r[1]._tokenizer.events,l=0,l<u.length&&u[l][1].type==="lineEndingBlank"&&(l+=2),l<u.length&&u[l][1].type==="content"))for(;++l<u.length&&u[l][1].type!=="content";)u[l][1].type==="chunkText"&&(u[l][1]._isInFirstContentOfListItem=!0,l++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,B9(h,t)),t=n[t],d=!0);else if(r[1]._container){for(l=t,a=void 0;l--;)if(o=h.get(l),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(a&&(h.get(a)[1].type="lineEndingBlank"),o[1].type="lineEnding",a=l);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;a&&(r[1].end={...h.get(a)[1].start},f=h.slice(a,t),f.unshift(r),h.splice(a,t-a+1,f))}}return Ma(e,0,Number.POSITIVE_INFINITY,h.slice(0)),!d}function B9(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const l=[];let o=t._tokenizer;o||(o=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const f=o.events,u=[],d={};let h,g,b=-1,v=t,N=0,k=0;const T=[k];for(;v;){for(;e.get(++a)[1]!==v;);l.push(a),v._tokenizer||(h=r.sliceStream(v),v.next||h.push(null),g&&o.defineSkip(v.start),v._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(h),v._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<f.length;)f[b][0]==="exit"&&f[b-1][0]==="enter"&&f[b][1].type===f[b-1][1].type&&f[b][1].start.line!==f[b][1].end.line&&(k=b+1,T.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(o.events=[],v?(v._tokenizer=void 0,v.previous=void 0):T.pop(),b=T.length;b--;){const E=f.slice(T[b],T[b+1]),I=l.pop();u.push([I,I+E.length-1]),e.splice(I,2,E)}for(u.reverse(),b=-1;++b<u.length;)d[N+u[b][0]]=N+u[b][1],N+=u[b][1]-u[b][0]-1;return d}const U9={resolve:V9,tokenize:H9},q9={partial:!0,tokenize:G9};function V9(e){return _k(e),e}function H9(e,n){let t;return r;function r(f){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(f)}function a(f){return f===null?l(f):jt(f)?e.check(q9,o,l)(f):(e.consume(f),a)}function l(f){return e.exit("chunkContent"),e.exit("content"),n(f)}function o(f){return e.consume(f),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function G9(e,n,t){const r=this;return a;function a(o){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),dn(e,l,"linePrefix")}function l(o){if(o===null||jt(o))return t(o);const f=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?n(o):e.interrupt(r.parser.constructs.flow,t,n)(o)}}function kk(e,n,t,r,a,l,o,f,u){const d=u||Number.POSITIVE_INFINITY;let h=0;return g;function g(E){return E===60?(e.enter(r),e.enter(a),e.enter(l),e.consume(E),e.exit(l),b):E===null||E===32||E===41||ob(E)?t(E):(e.enter(r),e.enter(o),e.enter(f),e.enter("chunkString",{contentType:"string"}),k(E))}function b(E){return E===62?(e.enter(l),e.consume(E),e.exit(l),e.exit(a),e.exit(r),n):(e.enter(f),e.enter("chunkString",{contentType:"string"}),v(E))}function v(E){return E===62?(e.exit("chunkString"),e.exit(f),b(E)):E===null||E===60||jt(E)?t(E):(e.consume(E),E===92?N:v)}function N(E){return E===60||E===62||E===92?(e.consume(E),v):v(E)}function k(E){return!h&&(E===null||E===41||Bn(E))?(e.exit("chunkString"),e.exit(f),e.exit(o),e.exit(r),n(E)):h<d&&E===40?(e.consume(E),h++,k):E===41?(e.consume(E),h--,k):E===null||E===32||E===40||ob(E)?t(E):(e.consume(E),E===92?T:k)}function T(E){return E===40||E===41||E===92?(e.consume(E),k):k(E)}}function Ek(e,n,t,r,a,l){const o=this;let f=0,u;return d;function d(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(l),h}function h(v){return f>999||v===null||v===91||v===93&&!u||v===94&&!f&&"_hiddenFootnoteSupport"in o.parser.constructs?t(v):v===93?(e.exit(l),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):jt(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),h):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||jt(v)||f++>999?(e.exit("chunkString"),h(v)):(e.consume(v),u||(u=!rn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),f++,g):g(v)}}function Tk(e,n,t,r,a,l){let o;return f;function f(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),o=b===40?41:b,u):t(b)}function u(b){return b===o?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(l),d(b))}function d(b){return b===o?(e.exit(l),u(o)):b===null?t(b):jt(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),dn(e,d,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),h(b))}function h(b){return b===o||b===null||jt(b)?(e.exit("chunkString"),d(b)):(e.consume(b),b===92?g:h)}function g(b){return b===o||b===92?(e.consume(b),h):h(b)}}function Bm(e,n){let t;return r;function r(a){return jt(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):rn(a)?dn(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const Y9={name:"definition",tokenize:Q9},W9={partial:!0,tokenize:J9};function Q9(e,n,t){const r=this;let a;return l;function l(v){return e.enter("definition"),o(v)}function o(v){return Ek.call(r,e,f,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function f(v){return a=Ls(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),u):t(v)}function u(v){return Bn(v)?Bm(e,d)(v):d(v)}function d(v){return kk(e,h,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function h(v){return e.attempt(W9,g,g)(v)}function g(v){return rn(v)?dn(e,b,"whitespace")(v):b(v)}function b(v){return v===null||jt(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function J9(e,n,t){return r;function r(f){return Bn(f)?Bm(e,a)(f):t(f)}function a(f){return Tk(e,l,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(f)}function l(f){return rn(f)?dn(e,o,"whitespace")(f):o(f)}function o(f){return f===null||jt(f)?n(f):t(f)}}const K9={name:"hardBreakEscape",tokenize:X9};function X9(e,n,t){return r;function r(l){return e.enter("hardBreakEscape"),e.consume(l),a}function a(l){return jt(l)?(e.exit("hardBreakEscape"),n(l)):t(l)}}const Z9={name:"headingAtx",resolve:e7,tokenize:t7};function e7(e,n){let t=e.length-2,r=3,a,l;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},l={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},Ma(e,r,t-r+1,[["enter",a,n],["enter",l,n],["exit",l,n],["exit",a,n]])),e}function t7(e,n,t){let r=0;return a;function a(h){return e.enter("atxHeading"),l(h)}function l(h){return e.enter("atxHeadingSequence"),o(h)}function o(h){return h===35&&r++<6?(e.consume(h),o):h===null||Bn(h)?(e.exit("atxHeadingSequence"),f(h)):t(h)}function f(h){return h===35?(e.enter("atxHeadingSequence"),u(h)):h===null||jt(h)?(e.exit("atxHeading"),n(h)):rn(h)?dn(e,f,"whitespace")(h):(e.enter("atxHeadingText"),d(h))}function u(h){return h===35?(e.consume(h),u):(e.exit("atxHeadingSequence"),f(h))}function d(h){return h===null||h===35||Bn(h)?(e.exit("atxHeadingText"),f(h)):(e.consume(h),d)}}const n7=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],IC=["pre","script","style","textarea"],i7={concrete:!0,name:"htmlFlow",resolveTo:s7,tokenize:l7},r7={partial:!0,tokenize:c7},a7={partial:!0,tokenize:o7};function s7(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function l7(e,n,t){const r=this;let a,l,o,f,u;return d;function d(M){return h(M)}function h(M){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(M),g}function g(M){return M===33?(e.consume(M),b):M===47?(e.consume(M),l=!0,k):M===63?(e.consume(M),a=3,r.interrupt?n:A):Lr(M)?(e.consume(M),o=String.fromCharCode(M),T):t(M)}function b(M){return M===45?(e.consume(M),a=2,v):M===91?(e.consume(M),a=5,f=0,N):Lr(M)?(e.consume(M),a=4,r.interrupt?n:A):t(M)}function v(M){return M===45?(e.consume(M),r.interrupt?n:A):t(M)}function N(M){const de="CDATA[";return M===de.charCodeAt(f++)?(e.consume(M),f===de.length?r.interrupt?n:G:N):t(M)}function k(M){return Lr(M)?(e.consume(M),o=String.fromCharCode(M),T):t(M)}function T(M){if(M===null||M===47||M===62||Bn(M)){const de=M===47,Se=o.toLowerCase();return!de&&!l&&IC.includes(Se)?(a=1,r.interrupt?n(M):G(M)):n7.includes(o.toLowerCase())?(a=6,de?(e.consume(M),E):r.interrupt?n(M):G(M)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(M):l?I(M):P(M))}return M===45||Nr(M)?(e.consume(M),o+=String.fromCharCode(M),T):t(M)}function E(M){return M===62?(e.consume(M),r.interrupt?n:G):t(M)}function I(M){return rn(M)?(e.consume(M),I):O(M)}function P(M){return M===47?(e.consume(M),O):M===58||M===95||Lr(M)?(e.consume(M),V):rn(M)?(e.consume(M),P):O(M)}function V(M){return M===45||M===46||M===58||M===95||Nr(M)?(e.consume(M),V):F(M)}function F(M){return M===61?(e.consume(M),$):rn(M)?(e.consume(M),F):P(M)}function $(M){return M===null||M===60||M===61||M===62||M===96?t(M):M===34||M===39?(e.consume(M),u=M,B):rn(M)?(e.consume(M),$):z(M)}function B(M){return M===u?(e.consume(M),u=null,q):M===null||jt(M)?t(M):(e.consume(M),B)}function z(M){return M===null||M===34||M===39||M===47||M===60||M===61||M===62||M===96||Bn(M)?F(M):(e.consume(M),z)}function q(M){return M===47||M===62||rn(M)?P(M):t(M)}function O(M){return M===62?(e.consume(M),R):t(M)}function R(M){return M===null||jt(M)?G(M):rn(M)?(e.consume(M),R):t(M)}function G(M){return M===45&&a===2?(e.consume(M),K):M===60&&a===1?(e.consume(M),U):M===62&&a===4?(e.consume(M),ae):M===63&&a===3?(e.consume(M),A):M===93&&a===5?(e.consume(M),ne):jt(M)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(r7,ce,ee)(M)):M===null||jt(M)?(e.exit("htmlFlowData"),ee(M)):(e.consume(M),G)}function ee(M){return e.check(a7,te,ce)(M)}function te(M){return e.enter("lineEnding"),e.consume(M),e.exit("lineEnding"),le}function le(M){return M===null||jt(M)?ee(M):(e.enter("htmlFlowData"),G(M))}function K(M){return M===45?(e.consume(M),A):G(M)}function U(M){return M===47?(e.consume(M),o="",J):G(M)}function J(M){if(M===62){const de=o.toLowerCase();return IC.includes(de)?(e.consume(M),ae):G(M)}return Lr(M)&&o.length<8?(e.consume(M),o+=String.fromCharCode(M),J):G(M)}function ne(M){return M===93?(e.consume(M),A):G(M)}function A(M){return M===62?(e.consume(M),ae):M===45&&a===2?(e.consume(M),A):G(M)}function ae(M){return M===null||jt(M)?(e.exit("htmlFlowData"),ce(M)):(e.consume(M),ae)}function ce(M){return e.exit("htmlFlow"),n(M)}}function o7(e,n,t){const r=this;return a;function a(o){return jt(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),l):t(o)}function l(o){return r.parser.lazy[r.now().line]?t(o):n(o)}}function c7(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(cg,n,t)}}const u7={name:"htmlText",tokenize:d7};function d7(e,n,t){const r=this;let a,l,o;return f;function f(A){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(A),u}function u(A){return A===33?(e.consume(A),d):A===47?(e.consume(A),F):A===63?(e.consume(A),P):Lr(A)?(e.consume(A),z):t(A)}function d(A){return A===45?(e.consume(A),h):A===91?(e.consume(A),l=0,N):Lr(A)?(e.consume(A),I):t(A)}function h(A){return A===45?(e.consume(A),v):t(A)}function g(A){return A===null?t(A):A===45?(e.consume(A),b):jt(A)?(o=g,U(A)):(e.consume(A),g)}function b(A){return A===45?(e.consume(A),v):g(A)}function v(A){return A===62?K(A):A===45?b(A):g(A)}function N(A){const ae="CDATA[";return A===ae.charCodeAt(l++)?(e.consume(A),l===ae.length?k:N):t(A)}function k(A){return A===null?t(A):A===93?(e.consume(A),T):jt(A)?(o=k,U(A)):(e.consume(A),k)}function T(A){return A===93?(e.consume(A),E):k(A)}function E(A){return A===62?K(A):A===93?(e.consume(A),E):k(A)}function I(A){return A===null||A===62?K(A):jt(A)?(o=I,U(A)):(e.consume(A),I)}function P(A){return A===null?t(A):A===63?(e.consume(A),V):jt(A)?(o=P,U(A)):(e.consume(A),P)}function V(A){return A===62?K(A):P(A)}function F(A){return Lr(A)?(e.consume(A),$):t(A)}function $(A){return A===45||Nr(A)?(e.consume(A),$):B(A)}function B(A){return jt(A)?(o=B,U(A)):rn(A)?(e.consume(A),B):K(A)}function z(A){return A===45||Nr(A)?(e.consume(A),z):A===47||A===62||Bn(A)?q(A):t(A)}function q(A){return A===47?(e.consume(A),K):A===58||A===95||Lr(A)?(e.consume(A),O):jt(A)?(o=q,U(A)):rn(A)?(e.consume(A),q):K(A)}function O(A){return A===45||A===46||A===58||A===95||Nr(A)?(e.consume(A),O):R(A)}function R(A){return A===61?(e.consume(A),G):jt(A)?(o=R,U(A)):rn(A)?(e.consume(A),R):q(A)}function G(A){return A===null||A===60||A===61||A===62||A===96?t(A):A===34||A===39?(e.consume(A),a=A,ee):jt(A)?(o=G,U(A)):rn(A)?(e.consume(A),G):(e.consume(A),te)}function ee(A){return A===a?(e.consume(A),a=void 0,le):A===null?t(A):jt(A)?(o=ee,U(A)):(e.consume(A),ee)}function te(A){return A===null||A===34||A===39||A===60||A===61||A===96?t(A):A===47||A===62||Bn(A)?q(A):(e.consume(A),te)}function le(A){return A===47||A===62||Bn(A)?q(A):t(A)}function K(A){return A===62?(e.consume(A),e.exit("htmlTextData"),e.exit("htmlText"),n):t(A)}function U(A){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(A),e.exit("lineEnding"),J}function J(A){return rn(A)?dn(e,ne,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(A):ne(A)}function ne(A){return e.enter("htmlTextData"),o(A)}}const Sw={name:"labelEnd",resolveAll:m7,resolveTo:g7,tokenize:y7},f7={tokenize:x7},h7={tokenize:b7},p7={tokenize:v7};function m7(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&Ma(e,0,e.length,t),e}function g7(e,n){let t=e.length,r=0,a,l,o,f;for(;t--;)if(a=e[t][1],l){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(o){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(l=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(o=t);const u={type:e[l][1].type==="labelLink"?"link":"image",start:{...e[l][1].start},end:{...e[e.length-1][1].end}},d={type:"label",start:{...e[l][1].start},end:{...e[o][1].end}},h={type:"labelText",start:{...e[l+r+2][1].end},end:{...e[o-2][1].start}};return f=[["enter",u,n],["enter",d,n]],f=ts(f,e.slice(l+1,l+r+3)),f=ts(f,[["enter",h,n]]),f=ts(f,Mb(n.parser.constructs.insideSpan.null,e.slice(l+r+4,o-3),n)),f=ts(f,[["exit",h,n],e[o-2],e[o-1],["exit",d,n]]),f=ts(f,e.slice(o+1)),f=ts(f,[["exit",u,n]]),Ma(e,l,e.length,f),e}function y7(e,n,t){const r=this;let a=r.events.length,l,o;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){l=r.events[a][1];break}return f;function f(b){return l?l._inactive?g(b):(o=r.parser.defined.includes(Ls(r.sliceSerialize({start:l.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),u):t(b)}function u(b){return b===40?e.attempt(f7,h,o?h:g)(b):b===91?e.attempt(h7,h,o?d:g)(b):o?h(b):g(b)}function d(b){return e.attempt(p7,h,g)(b)}function h(b){return n(b)}function g(b){return l._balanced=!0,t(b)}}function x7(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return Bn(g)?Bm(e,l)(g):l(g)}function l(g){return g===41?h(g):kk(e,o,f,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function o(g){return Bn(g)?Bm(e,u)(g):h(g)}function f(g){return t(g)}function u(g){return g===34||g===39||g===40?Tk(e,d,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):h(g)}function d(g){return Bn(g)?Bm(e,h)(g):h(g)}function h(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function b7(e,n,t){const r=this;return a;function a(f){return Ek.call(r,e,l,o,"reference","referenceMarker","referenceString")(f)}function l(f){return r.parser.defined.includes(Ls(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(f):t(f)}function o(f){return t(f)}}function v7(e,n,t){return r;function r(l){return e.enter("reference"),e.enter("referenceMarker"),e.consume(l),e.exit("referenceMarker"),a}function a(l){return l===93?(e.enter("referenceMarker"),e.consume(l),e.exit("referenceMarker"),e.exit("reference"),n):t(l)}}const w7={name:"labelStartImage",resolveAll:Sw.resolveAll,tokenize:S7};function S7(e,n,t){const r=this;return a;function a(f){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(f),e.exit("labelImageMarker"),l}function l(f){return f===91?(e.enter("labelMarker"),e.consume(f),e.exit("labelMarker"),e.exit("labelImage"),o):t(f)}function o(f){return f===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(f):n(f)}}const N7={name:"labelStartLink",resolveAll:Sw.resolveAll,tokenize:C7};function C7(e,n,t){const r=this;return a;function a(o){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelLink"),l}function l(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(o):n(o)}}const ov={name:"lineEnding",tokenize:j7};function j7(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),dn(e,n,"linePrefix")}}const zx={name:"thematicBreak",tokenize:_7};function _7(e,n,t){let r=0,a;return l;function l(d){return e.enter("thematicBreak"),o(d)}function o(d){return a=d,f(d)}function f(d){return d===a?(e.enter("thematicBreakSequence"),u(d)):r>=3&&(d===null||jt(d))?(e.exit("thematicBreak"),n(d)):t(d)}function u(d){return d===a?(e.consume(d),r++,u):(e.exit("thematicBreakSequence"),rn(d)?dn(e,f,"whitespace")(d):f(d))}}const ea={continuation:{tokenize:A7},exit:P7,name:"list",tokenize:T7},k7={partial:!0,tokenize:I7},E7={partial:!0,tokenize:D7};function T7(e,n,t){const r=this,a=r.events[r.events.length-1];let l=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,o=0;return f;function f(v){const N=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(N==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:h1(v)){if(r.containerState.type||(r.containerState.type=N,e.enter(N,{_container:!0})),N==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(zx,t,d)(v):d(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),u(v)}return t(v)}function u(v){return h1(v)&&++o<10?(e.consume(v),u):(!r.interrupt||o<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),d(v)):t(v)}function d(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(cg,r.interrupt?t:h,e.attempt(k7,b,g))}function h(v){return r.containerState.initialBlankLine=!0,l++,b(v)}function g(v){return rn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=l+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function A7(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(cg,a,l);function a(f){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,dn(e,n,"listItemIndent",r.containerState.size+1)(f)}function l(f){return r.containerState.furtherBlankLines||!rn(f)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(f)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(E7,n,o)(f))}function o(f){return r.containerState._closeFlow=!0,r.interrupt=void 0,dn(e,e.attempt(ea,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(f)}}function D7(e,n,t){const r=this;return dn(e,a,"listItemIndent",r.containerState.size+1);function a(l){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?n(l):t(l)}}function P7(e){e.exit(this.containerState.type)}function I7(e,n,t){const r=this;return dn(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(l){const o=r.events[r.events.length-1];return!rn(l)&&o&&o[1].type==="listItemPrefixWhitespace"?n(l):t(l)}}const MC={name:"setextUnderline",resolveTo:M7,tokenize:R7};function M7(e,n){let t=e.length,r,a,l;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!l&&e[t][1].type==="definition"&&(l=t);const o={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",l?(e.splice(a,0,["enter",o,n]),e.splice(l+1,0,["exit",e[r][1],n]),e[r][1].end={...e[l][1].end}):e[r][1]=o,e.push(["exit",o,n]),e}function R7(e,n,t){const r=this;let a;return l;function l(d){let h=r.events.length,g;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){g=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=d,o(d)):t(d)}function o(d){return e.enter("setextHeadingLineSequence"),f(d)}function f(d){return d===a?(e.consume(d),f):(e.exit("setextHeadingLineSequence"),rn(d)?dn(e,u,"lineSuffix")(d):u(d))}function u(d){return d===null||jt(d)?(e.exit("setextHeadingLine"),n(d)):t(d)}}const L7={tokenize:O7};function O7(e){const n=this,t=e.attempt(cg,r,e.attempt(this.parser.constructs.flowInitial,a,dn(e,e.attempt(this.parser.constructs.flow,a,e.attempt(U9,a)),"linePrefix")));return t;function r(l){if(l===null){e.consume(l);return}return e.enter("lineEndingBlank"),e.consume(l),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(l){if(l===null){e.consume(l);return}return e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const F7={resolveAll:Dk()},$7=Ak("string"),z7=Ak("text");function Ak(e){return{resolveAll:Dk(e==="text"?B7:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],l=t.attempt(a,o,f);return o;function o(h){return d(h)?l(h):f(h)}function f(h){if(h===null){t.consume(h);return}return t.enter("data"),t.consume(h),u}function u(h){return d(h)?(t.exit("data"),l(h)):(t.consume(h),u)}function d(h){if(h===null)return!0;const g=a[h];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function Dk(e){return n;function n(t,r){let a=-1,l;for(;++a<=t.length;)l===void 0?t[a]&&t[a][1].type==="data"&&(l=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==l+2&&(t[l][1].end=t[a-1][1].end,t.splice(l+2,a-l-2),a=l+2),l=void 0);return e?e(t,r):t}}function B7(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let l=a.length,o=-1,f=0,u;for(;l--;){const d=a[l];if(typeof d=="string"){for(o=d.length;d.charCodeAt(o-1)===32;)f++,o--;if(o)break;o=-1}else if(d===-2)u=!0,f++;else if(d!==-1){l++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(f=0),f){const d={type:t===e.length||u||f<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:l?o:r.start._bufferIndex+o,_index:r.start._index+l,line:r.end.line,column:r.end.column-f,offset:r.end.offset-f},end:{...r.end}};r.end={...d.start},r.start.offset===r.end.offset?Object.assign(r,d):(e.splice(t,0,["enter",d,n],["exit",d,n]),t+=2)}t++}return e}const U7={42:ea,43:ea,45:ea,48:ea,49:ea,50:ea,51:ea,52:ea,53:ea,54:ea,55:ea,56:ea,57:ea,62:Nk},q7={91:Y9},V7={[-2]:lv,[-1]:lv,32:lv},H7={35:Z9,42:zx,45:[MC,zx],60:i7,61:MC,95:zx,96:PC,126:PC},G7={38:jk,92:Ck},Y7={[-5]:ov,[-4]:ov,[-3]:ov,33:w7,38:jk,42:p1,60:[N9,u7],91:N7,92:[K9,Ck],93:Sw,95:p1,96:L9},W7={null:[p1,F7]},Q7={null:[42,95]},J7={null:[]},K7=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:Q7,contentInitial:q7,disable:J7,document:U7,flow:H7,flowInitial:V7,insideSpan:W7,string:G7,text:Y7},Symbol.toStringTag,{value:"Module"}));function X7(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},l=[];let o=[],f=[];const u={attempt:B(F),check:B($),consume:I,enter:P,exit:V,interrupt:B($,{interrupt:!0})},d={code:null,containerState:{},defineSkip:k,events:[],now:N,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let h=n.tokenize.call(d,u);return n.resolveAll&&l.push(n),d;function g(R){return o=ts(o,R),T(),o[o.length-1]!==null?[]:(z(n,0),d.events=Mb(l,d.events,d),d.events)}function b(R,G){return eq(v(R),G)}function v(R){return Z7(o,R)}function N(){const{_bufferIndex:R,_index:G,line:ee,column:te,offset:le}=r;return{_bufferIndex:R,_index:G,line:ee,column:te,offset:le}}function k(R){a[R.line]=R.column,O()}function T(){let R;for(;r._index<o.length;){const G=o[r._index];if(typeof G=="string")for(R=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===R&&r._bufferIndex<G.length;)E(G.charCodeAt(r._bufferIndex));else E(G)}}function E(R){h=h(R)}function I(R){jt(R)?(r.line++,r.column=1,r.offset+=R===-3?2:1,O()):R!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),d.previous=R}function P(R,G){const ee=G||{};return ee.type=R,ee.start=N(),d.events.push(["enter",ee,d]),f.push(ee),ee}function V(R){const G=f.pop();return G.end=N(),d.events.push(["exit",G,d]),G}function F(R,G){z(R,G.from)}function $(R,G){G.restore()}function B(R,G){return ee;function ee(te,le,K){let U,J,ne,A;return Array.isArray(te)?ce(te):"tokenize"in te?ce([te]):ae(te);function ae(fe){return we;function we(re){const _e=re!==null&&fe[re],qe=re!==null&&fe.null,et=[...Array.isArray(_e)?_e:_e?[_e]:[],...Array.isArray(qe)?qe:qe?[qe]:[]];return ce(et)(re)}}function ce(fe){return U=fe,J=0,fe.length===0?K:M(fe[J])}function M(fe){return we;function we(re){return A=q(),ne=fe,fe.partial||(d.currentConstruct=fe),fe.name&&d.parser.constructs.disable.null.includes(fe.name)?Se():fe.tokenize.call(G?Object.assign(Object.create(d),G):d,u,de,Se)(re)}}function de(fe){return R(ne,A),le}function Se(fe){return A.restore(),++J<U.length?M(U[J]):K}}}function z(R,G){R.resolveAll&&!l.includes(R)&&l.push(R),R.resolve&&Ma(d.events,G,d.events.length-G,R.resolve(d.events.slice(G),d)),R.resolveTo&&(d.events=R.resolveTo(d.events,d))}function q(){const R=N(),G=d.previous,ee=d.currentConstruct,te=d.events.length,le=Array.from(f);return{from:te,restore:K};function K(){r=R,d.previous=G,d.currentConstruct=ee,d.events.length=te,f=le,O()}}function O(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function Z7(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,l=n.end._bufferIndex;let o;if(t===a)o=[e[t].slice(r,l)];else{if(o=e.slice(t,a),r>-1){const f=o[0];typeof f=="string"?o[0]=f.slice(r):o.shift()}l>0&&o.push(e[a].slice(0,l))}return o}function eq(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const l=e[t];let o;if(typeof l=="string")o=l;else switch(l){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=n?" ":"	";break}case-1:{if(!n&&a)continue;o=" ";break}default:o=String.fromCharCode(l)}a=l===-2,r.push(o)}return r.join("")}function tq(e){const r={constructs:wk([K7,...(e||{}).extensions||[]]),content:a(g9),defined:[],document:a(x9),flow:a(L7),lazy:{},string:a($7),text:a(z7)};return r;function a(l){return o;function o(f){return X7(r,l,f)}}}function nq(e){for(;!_k(e););return e}const RC=/[\0\t\n\r]/g;function iq(){let e=1,n="",t=!0,r;return a;function a(l,o,f){const u=[];let d,h,g,b,v;for(l=n+(typeof l=="string"?l.toString():new TextDecoder(o||void 0).decode(l)),g=0,n="",t&&(l.charCodeAt(0)===65279&&g++,t=void 0);g<l.length;){if(RC.lastIndex=g,d=RC.exec(l),b=d&&d.index!==void 0?d.index:l.length,v=l.charCodeAt(b),!d){n=l.slice(g);break}if(v===10&&g===b&&r)u.push(-3),r=void 0;else switch(r&&(u.push(-5),r=void 0),g<b&&(u.push(l.slice(g,b)),e+=b-g),v){case 0:{u.push(65533),e++;break}case 9:{for(h=Math.ceil(e/4)*4,u.push(-2);e++<h;)u.push(-1);break}case 10:{u.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return f&&(r&&u.push(-5),n&&u.push(n),u.push(null)),u}}const rq=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function aq(e){return e.replace(rq,sq)}function sq(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),l=a===120||a===88;return Sk(t.slice(l?2:1),l?16:10)}return ww(t)||e}const Pk={}.hasOwnProperty;function lq(e,n,t){return typeof n!="string"&&(t=n,n=void 0),oq(t)(nq(tq(t).document().write(iq()(e,n,!0))))}function oq(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:l(nt),autolinkProtocol:q,autolinkEmail:q,atxHeading:l(Me),blockQuote:l(qe),characterEscape:q,characterReference:q,codeFenced:l(et),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:l(et,o),codeText:l(Je,o),codeTextData:q,data:q,codeFlowValue:q,definition:l(Le),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:l(xe),hardBreakEscape:l(ve),hardBreakTrailing:l(ve),htmlFlow:l(Ee,o),htmlFlowData:q,htmlText:l(Ee,o),htmlTextData:q,image:l(De),label:o,link:l(nt),listItem:l(Xe),listItemValue:b,listOrdered:l(lt,g),listUnordered:l(lt),paragraph:l(Mt),reference:M,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:l(Me),strong:l(_t),thematicBreak:l(se)},exit:{atxHeading:u(),atxHeadingSequence:F,autolink:u(),autolinkEmail:_e,autolinkProtocol:re,blockQuote:u(),characterEscapeValue:O,characterReferenceMarkerHexadecimal:Se,characterReferenceMarkerNumeric:Se,characterReferenceValue:fe,characterReference:we,codeFenced:u(T),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:N,codeFlowValue:O,codeIndented:u(E),codeText:u(le),codeTextData:O,data:O,definition:u(),definitionDestinationString:V,definitionLabelString:I,definitionTitleString:P,emphasis:u(),hardBreakEscape:u(G),hardBreakTrailing:u(G),htmlFlow:u(ee),htmlFlowData:O,htmlText:u(te),htmlTextData:O,image:u(U),label:ne,labelText:J,lineEnding:R,link:u(K),listItem:u(),listOrdered:u(),listUnordered:u(),paragraph:u(),referenceString:de,resourceDestinationString:A,resourceTitleString:ae,resource:ce,setextHeading:u(z),setextHeadingLineSequence:B,setextHeadingText:$,strong:u(),thematicBreak:u()}};Ik(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(Q){let ie={type:"root",children:[]};const je={stack:[ie],tokenStack:[],config:n,enter:f,exit:d,buffer:o,resume:h,data:t},Ae=[];let Be=-1;for(;++Be<Q.length;)if(Q[Be][1].type==="listOrdered"||Q[Be][1].type==="listUnordered")if(Q[Be][0]==="enter")Ae.push(Be);else{const st=Ae.pop();Be=a(Q,st,Be)}for(Be=-1;++Be<Q.length;){const st=n[Q[Be][0]];Pk.call(st,Q[Be][1].type)&&st[Q[Be][1].type].call(Object.assign({sliceSerialize:Q[Be][2].sliceSerialize},je),Q[Be][1])}if(je.tokenStack.length>0){const st=je.tokenStack[je.tokenStack.length-1];(st[1]||LC).call(je,void 0,st[0])}for(ie.position={start:Oc(Q.length>0?Q[0][1].start:{line:1,column:1,offset:0}),end:Oc(Q.length>0?Q[Q.length-2][1].end:{line:1,column:1,offset:0})},Be=-1;++Be<n.transforms.length;)ie=n.transforms[Be](ie)||ie;return ie}function a(Q,ie,je){let Ae=ie-1,Be=-1,st=!1,pt,dt,ze,Ke;for(;++Ae<=je;){const Fe=Q[Ae];switch(Fe[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Fe[0]==="enter"?Be++:Be--,Ke=void 0;break}case"lineEndingBlank":{Fe[0]==="enter"&&(pt&&!Ke&&!Be&&!ze&&(ze=Ae),Ke=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Ke=void 0}if(!Be&&Fe[0]==="enter"&&Fe[1].type==="listItemPrefix"||Be===-1&&Fe[0]==="exit"&&(Fe[1].type==="listUnordered"||Fe[1].type==="listOrdered")){if(pt){let at=Ae;for(dt=void 0;at--;){const Qe=Q[at];if(Qe[1].type==="lineEnding"||Qe[1].type==="lineEndingBlank"){if(Qe[0]==="exit")continue;dt&&(Q[dt][1].type="lineEndingBlank",st=!0),Qe[1].type="lineEnding",dt=at}else if(!(Qe[1].type==="linePrefix"||Qe[1].type==="blockQuotePrefix"||Qe[1].type==="blockQuotePrefixWhitespace"||Qe[1].type==="blockQuoteMarker"||Qe[1].type==="listItemIndent"))break}ze&&(!dt||ze<dt)&&(pt._spread=!0),pt.end=Object.assign({},dt?Q[dt][1].start:Fe[1].end),Q.splice(dt||Ae,0,["exit",pt,Fe[2]]),Ae++,je++}if(Fe[1].type==="listItemPrefix"){const at={type:"listItem",_spread:!1,start:Object.assign({},Fe[1].start),end:void 0};pt=at,Q.splice(Ae,0,["enter",at,Fe[2]]),Ae++,je++,ze=void 0,Ke=!0}}}return Q[ie][1]._spread=st,je}function l(Q,ie){return je;function je(Ae){f.call(this,Q(Ae),Ae),ie&&ie.call(this,Ae)}}function o(){this.stack.push({type:"fragment",children:[]})}function f(Q,ie,je){this.stack[this.stack.length-1].children.push(Q),this.stack.push(Q),this.tokenStack.push([ie,je||void 0]),Q.position={start:Oc(ie.start),end:void 0}}function u(Q){return ie;function ie(je){Q&&Q.call(this,je),d.call(this,je)}}function d(Q,ie){const je=this.stack.pop(),Ae=this.tokenStack.pop();if(Ae)Ae[0].type!==Q.type&&(ie?ie.call(this,Q,Ae[0]):(Ae[1]||LC).call(this,Q,Ae[0]));else throw new Error("Cannot close `"+Q.type+"` ("+zm({start:Q.start,end:Q.end})+"): its not open");je.position.end=Oc(Q.end)}function h(){return vw(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(Q){if(this.data.expectingFirstListItemValue){const ie=this.stack[this.stack.length-2];ie.start=Number.parseInt(this.sliceSerialize(Q),10),this.data.expectingFirstListItemValue=void 0}}function v(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.lang=Q}function N(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.meta=Q}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.value=Q.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function E(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.value=Q.replace(/(\r?\n|\r)$/g,"")}function I(Q){const ie=this.resume(),je=this.stack[this.stack.length-1];je.label=ie,je.identifier=Ls(this.sliceSerialize(Q)).toLowerCase()}function P(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.title=Q}function V(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.url=Q}function F(Q){const ie=this.stack[this.stack.length-1];if(!ie.depth){const je=this.sliceSerialize(Q).length;ie.depth=je}}function $(){this.data.setextHeadingSlurpLineEnding=!0}function B(Q){const ie=this.stack[this.stack.length-1];ie.depth=this.sliceSerialize(Q).codePointAt(0)===61?1:2}function z(){this.data.setextHeadingSlurpLineEnding=void 0}function q(Q){const je=this.stack[this.stack.length-1].children;let Ae=je[je.length-1];(!Ae||Ae.type!=="text")&&(Ae=an(),Ae.position={start:Oc(Q.start),end:void 0},je.push(Ae)),this.stack.push(Ae)}function O(Q){const ie=this.stack.pop();ie.value+=this.sliceSerialize(Q),ie.position.end=Oc(Q.end)}function R(Q){const ie=this.stack[this.stack.length-1];if(this.data.atHardBreak){const je=ie.children[ie.children.length-1];je.position.end=Oc(Q.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(ie.type)&&(q.call(this,Q),O.call(this,Q))}function G(){this.data.atHardBreak=!0}function ee(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.value=Q}function te(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.value=Q}function le(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.value=Q}function K(){const Q=this.stack[this.stack.length-1];if(this.data.inReference){const ie=this.data.referenceType||"shortcut";Q.type+="Reference",Q.referenceType=ie,delete Q.url,delete Q.title}else delete Q.identifier,delete Q.label;this.data.referenceType=void 0}function U(){const Q=this.stack[this.stack.length-1];if(this.data.inReference){const ie=this.data.referenceType||"shortcut";Q.type+="Reference",Q.referenceType=ie,delete Q.url,delete Q.title}else delete Q.identifier,delete Q.label;this.data.referenceType=void 0}function J(Q){const ie=this.sliceSerialize(Q),je=this.stack[this.stack.length-2];je.label=aq(ie),je.identifier=Ls(ie).toLowerCase()}function ne(){const Q=this.stack[this.stack.length-1],ie=this.resume(),je=this.stack[this.stack.length-1];if(this.data.inReference=!0,je.type==="link"){const Ae=Q.children;je.children=Ae}else je.alt=ie}function A(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.url=Q}function ae(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.title=Q}function ce(){this.data.inReference=void 0}function M(){this.data.referenceType="collapsed"}function de(Q){const ie=this.resume(),je=this.stack[this.stack.length-1];je.label=ie,je.identifier=Ls(this.sliceSerialize(Q)).toLowerCase(),this.data.referenceType="full"}function Se(Q){this.data.characterReferenceType=Q.type}function fe(Q){const ie=this.sliceSerialize(Q),je=this.data.characterReferenceType;let Ae;je?(Ae=Sk(ie,je==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Ae=ww(ie);const Be=this.stack[this.stack.length-1];Be.value+=Ae}function we(Q){const ie=this.stack.pop();ie.position.end=Oc(Q.end)}function re(Q){O.call(this,Q);const ie=this.stack[this.stack.length-1];ie.url=this.sliceSerialize(Q)}function _e(Q){O.call(this,Q);const ie=this.stack[this.stack.length-1];ie.url="mailto:"+this.sliceSerialize(Q)}function qe(){return{type:"blockquote",children:[]}}function et(){return{type:"code",lang:null,meta:null,value:""}}function Je(){return{type:"inlineCode",value:""}}function Le(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function xe(){return{type:"emphasis",children:[]}}function Me(){return{type:"heading",depth:0,children:[]}}function ve(){return{type:"break"}}function Ee(){return{type:"html",value:""}}function De(){return{type:"image",title:null,url:"",alt:null}}function nt(){return{type:"link",title:null,url:"",children:[]}}function lt(Q){return{type:"list",ordered:Q.type==="listOrdered",start:null,spread:Q._spread,children:[]}}function Xe(Q){return{type:"listItem",spread:Q._spread,checked:null,children:[]}}function Mt(){return{type:"paragraph",children:[]}}function _t(){return{type:"strong",children:[]}}function an(){return{type:"text",value:""}}function se(){return{type:"thematicBreak"}}}function Oc(e){return{line:e.line,column:e.column,offset:e.offset}}function Ik(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?Ik(e,r):cq(e,r)}}function cq(e,n){let t;for(t in n)if(Pk.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function LC(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+zm({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+zm({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+zm({start:n.start,end:n.end})+") is still open")}function uq(e){const n=this;n.parser=t;function t(r){return lq(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}function dq(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function fq(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function hq(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function pq(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function mq(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function gq(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=zh(r.toLowerCase()),l=e.footnoteOrder.indexOf(r);let o,f=e.footnoteCounts.get(r);f===void 0?(f=0,e.footnoteOrder.push(r),o=e.footnoteOrder.length):o=l+1,f+=1,e.footnoteCounts.set(r,f);const u={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(f>1?"-"+f:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};e.patch(n,u);const d={type:"element",tagName:"sup",properties:{},children:[u]};return e.patch(n,d),e.applyData(n,d)}function yq(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function xq(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function Mk(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),l=a[0];l&&l.type==="text"?l.value="["+l.value:a.unshift({type:"text",value:"["});const o=a[a.length-1];return o&&o.type==="text"?o.value+=r:a.push({type:"text",value:r}),a}function bq(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return Mk(e,n);const a={src:zh(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const l={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,l),e.applyData(n,l)}function vq(e,n){const t={src:zh(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function wq(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function Sq(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return Mk(e,n);const a={href:zh(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const l={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,l),e.applyData(n,l)}function Nq(e,n){const t={href:zh(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function Cq(e,n,t){const r=e.all(n),a=t?jq(t):Rk(n),l={},o=[];if(typeof n.checked=="boolean"){const h=r[0];let g;h&&h.type==="element"&&h.tagName==="p"?g=h:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),l.className=["task-list-item"]}let f=-1;for(;++f<r.length;){const h=r[f];(a||f!==0||h.type!=="element"||h.tagName!=="p")&&o.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!a?o.push(...h.children):o.push(h)}const u=r[r.length-1];u&&(a||u.type!=="element"||u.tagName!=="p")&&o.push({type:"text",value:`
`});const d={type:"element",tagName:"li",properties:l,children:o};return e.patch(n,d),e.applyData(n,d)}function jq(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=Rk(t[r])}return n}function Rk(e){const n=e.spread;return n??e.children.length>1}function _q(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const o=r[a];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const l={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,l),e.applyData(n,l)}function kq(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Eq(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function Tq(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Aq(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],o),a.push(o)}if(t.length>0){const o={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},f=gw(n.children[1]),u=pk(n.children[n.children.length-1]);f&&u&&(o.position={start:f,end:u}),a.push(o)}const l={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,l),e.applyData(n,l)}function Dq(e,n,t){const r=t?t.children:void 0,l=(r?r.indexOf(n):1)===0?"th":"td",o=t&&t.type==="table"?t.align:void 0,f=o?o.length:n.children.length;let u=-1;const d=[];for(;++u<f;){const g=n.children[u],b={},v=o?o[u]:void 0;v&&(b.align=v);let N={type:"element",tagName:l,properties:b,children:[]};g&&(N.children=e.all(g),e.patch(g,N),N=e.applyData(g,N)),d.push(N)}const h={type:"element",tagName:"tr",properties:{},children:e.wrap(d,!0)};return e.patch(n,h),e.applyData(n,h)}function Pq(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const OC=9,FC=32;function Iq(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const l=[];for(;r;)l.push($C(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return l.push($C(n.slice(a),a>0,!1)),l.join("")}function $C(e,n,t){let r=0,a=e.length;if(n){let l=e.codePointAt(r);for(;l===OC||l===FC;)r++,l=e.codePointAt(r)}if(t){let l=e.codePointAt(a-1);for(;l===OC||l===FC;)a--,l=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function Mq(e,n){const t={type:"text",value:Iq(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function Rq(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const Lq={blockquote:dq,break:fq,code:hq,delete:pq,emphasis:mq,footnoteReference:gq,heading:yq,html:xq,imageReference:bq,image:vq,inlineCode:wq,linkReference:Sq,link:Nq,listItem:Cq,list:_q,paragraph:kq,root:Eq,strong:Tq,table:Aq,tableCell:Pq,tableRow:Dq,text:Mq,thematicBreak:Rq,toml:vx,yaml:vx,definition:vx,footnoteDefinition:vx};function vx(){}const Lk=-1,Rb=0,Um=1,cb=2,Nw=3,Cw=4,jw=5,_w=6,Ok=7,Fk=8,zC=typeof self=="object"?self:globalThis,Oq=(e,n)=>{const t=(a,l)=>(e.set(l,a),a),r=a=>{if(e.has(a))return e.get(a);const[l,o]=n[a];switch(l){case Rb:case Lk:return t(o,a);case Um:{const f=t([],a);for(const u of o)f.push(r(u));return f}case cb:{const f=t({},a);for(const[u,d]of o)f[r(u)]=r(d);return f}case Nw:return t(new Date(o),a);case Cw:{const{source:f,flags:u}=o;return t(new RegExp(f,u),a)}case jw:{const f=t(new Map,a);for(const[u,d]of o)f.set(r(u),r(d));return f}case _w:{const f=t(new Set,a);for(const u of o)f.add(r(u));return f}case Ok:{const{name:f,message:u}=o;return t(new zC[f](u),a)}case Fk:return t(BigInt(o),a);case"BigInt":return t(Object(BigInt(o)),a);case"ArrayBuffer":return t(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:f}=new Uint8Array(o);return t(new DataView(f),o)}}return t(new zC[l](o),a)};return r},BC=e=>Oq(new Map,e)(0),ph="",{toString:Fq}={},{keys:$q}=Object,Pm=e=>{const n=typeof e;if(n!=="object"||!e)return[Rb,n];const t=Fq.call(e).slice(8,-1);switch(t){case"Array":return[Um,ph];case"Object":return[cb,ph];case"Date":return[Nw,ph];case"RegExp":return[Cw,ph];case"Map":return[jw,ph];case"Set":return[_w,ph];case"DataView":return[Um,t]}return t.includes("Array")?[Um,t]:t.includes("Error")?[Ok,t]:[cb,t]},wx=([e,n])=>e===Rb&&(n==="function"||n==="symbol"),zq=(e,n,t,r)=>{const a=(o,f)=>{const u=r.push(o)-1;return t.set(f,u),u},l=o=>{if(t.has(o))return t.get(o);let[f,u]=Pm(o);switch(f){case Rb:{let h=o;switch(u){case"bigint":f=Fk,h=o.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+u);h=null;break;case"undefined":return a([Lk],o)}return a([f,h],o)}case Um:{if(u){let b=o;return u==="DataView"?b=new Uint8Array(o.buffer):u==="ArrayBuffer"&&(b=new Uint8Array(o)),a([u,[...b]],o)}const h=[],g=a([f,h],o);for(const b of o)h.push(l(b));return g}case cb:{if(u)switch(u){case"BigInt":return a([u,o.toString()],o);case"Boolean":case"Number":case"String":return a([u,o.valueOf()],o)}if(n&&"toJSON"in o)return l(o.toJSON());const h=[],g=a([f,h],o);for(const b of $q(o))(e||!wx(Pm(o[b])))&&h.push([l(b),l(o[b])]);return g}case Nw:return a([f,o.toISOString()],o);case Cw:{const{source:h,flags:g}=o;return a([f,{source:h,flags:g}],o)}case jw:{const h=[],g=a([f,h],o);for(const[b,v]of o)(e||!(wx(Pm(b))||wx(Pm(v))))&&h.push([l(b),l(v)]);return g}case _w:{const h=[],g=a([f,h],o);for(const b of o)(e||!wx(Pm(b)))&&h.push(l(b));return g}}const{message:d}=o;return a([f,{name:u,message:d}],o)};return l},UC=(e,{json:n,lossy:t}={})=>{const r=[];return zq(!(n||t),!!n,new Map,r)(e),r},ub=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?BC(UC(e,n)):structuredClone(e):(e,n)=>BC(UC(e,n));function Bq(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function Uq(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function qq(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||Bq,r=e.options.footnoteBackLabel||Uq,a=e.options.footnoteLabel||"Footnotes",l=e.options.footnoteLabelTagName||"h2",o=e.options.footnoteLabelProperties||{className:["sr-only"]},f=[];let u=-1;for(;++u<e.footnoteOrder.length;){const d=e.footnoteById.get(e.footnoteOrder[u]);if(!d)continue;const h=e.all(d),g=String(d.identifier).toUpperCase(),b=zh(g.toLowerCase());let v=0;const N=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){N.length>0&&N.push({type:"text",value:" "});let I=typeof t=="string"?t:t(u,v);typeof I=="string"&&(I={type:"text",value:I}),N.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(u,v),className:["data-footnote-backref"]},children:Array.isArray(I)?I:[I]})}const T=h[h.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const I=T.children[T.children.length-1];I&&I.type==="text"?I.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...N)}else h.push(...N);const E={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(h,!0)};e.patch(d,E),f.push(E)}if(f.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:l,properties:{...ub(o),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(f,!0)},{type:"text",value:`
`}]}}const Lb=function(e){if(e==null)return Yq;if(typeof e=="function")return Ob(e);if(typeof e=="object")return Array.isArray(e)?Vq(e):Hq(e);if(typeof e=="string")return Gq(e);throw new Error("Expected function, string, or object as test")};function Vq(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=Lb(e[t]);return Ob(r);function r(...a){let l=-1;for(;++l<n.length;)if(n[l].apply(this,a))return!0;return!1}}function Hq(e){const n=e;return Ob(t);function t(r){const a=r;let l;for(l in e)if(a[l]!==n[l])return!1;return!0}}function Gq(e){return Ob(n);function n(t){return t&&t.type===e}}function Ob(e){return n;function n(t,r,a){return!!(Wq(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function Yq(){return!0}function Wq(e){return e!==null&&typeof e=="object"&&"type"in e}const $k=[],Qq=!0,m1=!1,Jq="skip";function zk(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const l=Lb(a),o=r?-1:1;f(e,void 0,[])();function f(u,d,h){const g=u&&typeof u=="object"?u:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(u.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=$k,N,k,T;if((!n||l(u,d,h[h.length-1]||void 0))&&(v=Kq(t(u,h)),v[0]===m1))return v;if("children"in u&&u.children){const E=u;if(E.children&&v[0]!==Jq)for(k=(r?E.children.length:-1)+o,T=h.concat(E);k>-1&&k<E.children.length;){const I=E.children[k];if(N=f(I,k,T)(),N[0]===m1)return N;k=typeof N[1]=="number"?N[1]:k+o}}return v}}}function Kq(e){return Array.isArray(e)?e:typeof e=="number"?[Qq,e]:e==null?$k:[e]}function kw(e,n,t,r){let a,l,o;typeof n=="function"?(l=void 0,o=n,a=t):(l=n,o=t,a=r),zk(e,l,f,a);function f(u,d){const h=d[d.length-1],g=h?h.children.indexOf(u):void 0;return o(u,g,h)}}const g1={}.hasOwnProperty,Xq={};function Zq(e,n){const t=n||Xq,r=new Map,a=new Map,l=new Map,o={...Lq,...t.handlers},f={all:d,applyData:tV,definitionById:r,footnoteById:a,footnoteCounts:l,footnoteOrder:[],handlers:o,one:u,options:t,patch:eV,wrap:iV};return kw(e,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const g=h.type==="definition"?r:a,b=String(h.identifier).toUpperCase();g.has(b)||g.set(b,h)}}),f;function u(h,g){const b=h.type,v=f.handlers[b];if(g1.call(f.handlers,b)&&v)return v(f,h,g);if(f.options.passThrough&&f.options.passThrough.includes(b)){if("children"in h){const{children:k,...T}=h,E=ub(T);return E.children=f.all(h),E}return ub(h)}return(f.options.unknownHandler||nV)(f,h,g)}function d(h){const g=[];if("children"in h){const b=h.children;let v=-1;for(;++v<b.length;){const N=f.one(b[v],h);if(N){if(v&&b[v-1].type==="break"&&(!Array.isArray(N)&&N.type==="text"&&(N.value=qC(N.value)),!Array.isArray(N)&&N.type==="element")){const k=N.children[0];k&&k.type==="text"&&(k.value=qC(k.value))}Array.isArray(N)?g.push(...N):g.push(N)}}}return g}}function eV(e,n){e.position&&(n.position=UU(e))}function tV(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,l=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const o="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:o}}t.type==="element"&&l&&Object.assign(t.properties,ub(l)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function nV(e,n){const t=n.data||{},r="value"in n&&!(g1.call(t,"hProperties")||g1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function iV(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function qC(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function VC(e,n){const t=Zq(e,n),r=t.one(e,void 0),a=qq(t),l=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&l.children.push({type:"text",value:`
`},a),l}function rV(e,n){return e&&"run"in e?async function(t,r){const a=VC(t,{file:r,...n});await e.run(a,r)}:function(t,r){return VC(t,{file:r,...e||n})}}function HC(e){if(e)throw e}var cv,GC;function aV(){if(GC)return cv;GC=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(d){return typeof Array.isArray=="function"?Array.isArray(d):n.call(d)==="[object Array]"},l=function(d){if(!d||n.call(d)!=="[object Object]")return!1;var h=e.call(d,"constructor"),g=d.constructor&&d.constructor.prototype&&e.call(d.constructor.prototype,"isPrototypeOf");if(d.constructor&&!h&&!g)return!1;var b;for(b in d);return typeof b>"u"||e.call(d,b)},o=function(d,h){t&&h.name==="__proto__"?t(d,h.name,{enumerable:!0,configurable:!0,value:h.newValue,writable:!0}):d[h.name]=h.newValue},f=function(d,h){if(h==="__proto__")if(e.call(d,h)){if(r)return r(d,h).value}else return;return d[h]};return cv=function u(){var d,h,g,b,v,N,k=arguments[0],T=1,E=arguments.length,I=!1;for(typeof k=="boolean"&&(I=k,k=arguments[1]||{},T=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});T<E;++T)if(d=arguments[T],d!=null)for(h in d)g=f(k,h),b=f(d,h),k!==b&&(I&&b&&(l(b)||(v=a(b)))?(v?(v=!1,N=g&&a(g)?g:[]):N=g&&l(g)?g:{},o(k,{name:h,newValue:u(I,N,b)})):typeof b<"u"&&o(k,{name:h,newValue:b}));return k},cv}var sV=aV();const uv=Fd(sV);function y1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function lV(){const e=[],n={run:t,use:r};return n;function t(...a){let l=-1;const o=a.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);f(null,...a);function f(u,...d){const h=e[++l];let g=-1;if(u){o(u);return}for(;++g<a.length;)(d[g]===null||d[g]===void 0)&&(d[g]=a[g]);a=d,h?oV(h,f)(...d):o(null,...d)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function oV(e,n){let t;return r;function r(...o){const f=e.length>o.length;let u;f&&o.push(a);try{u=e.apply(this,o)}catch(d){const h=d;if(f&&t)throw h;return a(h)}f||(u&&u.then&&typeof u.then=="function"?u.then(l,a):u instanceof Error?a(u):l(u))}function a(o,...f){t||(t=!0,n(o,...f))}function l(o){a(null,o)}}const El={basename:cV,dirname:uV,extname:dV,join:fV,sep:"/"};function cV(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');ug(e);let t=0,r=-1,a=e.length,l;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(l){t=a+1;break}}else r<0&&(l=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let o=-1,f=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(l){t=a+1;break}}else o<0&&(l=!0,o=a+1),f>-1&&(e.codePointAt(a)===n.codePointAt(f--)?f<0&&(r=a):(f=-1,r=o));return t===r?r=o:r<0&&(r=e.length),e.slice(t,r)}function uV(e){if(ug(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function dV(e){ug(e);let n=e.length,t=-1,r=0,a=-1,l=0,o;for(;n--;){const f=e.codePointAt(n);if(f===47){if(o){r=n+1;break}continue}t<0&&(o=!0,t=n+1),f===46?a<0?a=n:l!==1&&(l=1):a>-1&&(l=-1)}return a<0||t<0||l===0||l===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function fV(...e){let n=-1,t;for(;++n<e.length;)ug(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":hV(t)}function hV(e){ug(e);const n=e.codePointAt(0)===47;let t=pV(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function pV(e,n){let t="",r=0,a=-1,l=0,o=-1,f,u;for(;++o<=e.length;){if(o<e.length)f=e.codePointAt(o);else{if(f===47)break;f=47}if(f===47){if(!(a===o-1||l===1))if(a!==o-1&&l===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(u=t.lastIndexOf("/"),u!==t.length-1){u<0?(t="",r=0):(t=t.slice(0,u),r=t.length-1-t.lastIndexOf("/")),a=o,l=0;continue}}else if(t.length>0){t="",r=0,a=o,l=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,o):t=e.slice(a+1,o),r=o-a-1;a=o,l=0}else f===46&&l>-1?l++:l=-1}return t}function ug(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const mV={cwd:gV};function gV(){return"/"}function x1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function yV(e){if(typeof e=="string")e=new URL(e);else if(!x1(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return xV(e)}function xV(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const dv=["history","path","basename","stem","extname","dirname"];let Bk=class{constructor(n){let t;n?x1(n)?t={path:n}:typeof n=="string"||bV(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":mV.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<dv.length;){const l=dv[r];l in t&&t[l]!==void 0&&t[l]!==null&&(this[l]=l==="history"?[...t[l]]:t[l])}let a;for(a in t)dv.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?El.basename(this.path):void 0}set basename(n){hv(n,"basename"),fv(n,"basename"),this.path=El.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?El.dirname(this.path):void 0}set dirname(n){YC(this.basename,"dirname"),this.path=El.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?El.extname(this.path):void 0}set extname(n){if(fv(n,"extname"),YC(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=El.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){x1(n)&&(n=yV(n)),hv(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?El.basename(this.path,this.extname):void 0}set stem(n){hv(n,"stem"),fv(n,"stem"),this.path=El.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new _r(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}};function fv(e,n){if(e&&e.includes(El.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+El.sep+"`")}function hv(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function YC(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function bV(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const vV=function(e){const r=this.constructor.prototype,a=r[e],l=function(){return a.apply(l,arguments)};return Object.setPrototypeOf(l,r),l},wV={}.hasOwnProperty;let SV=class Uk extends vV{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=lV()}copy(){const n=new Uk;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data(uv(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(gv("data",this.frozen),this.namespace[n]=t,this):wV.call(this.namespace,n)&&this.namespace[n]||void 0:n?(gv("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=Sx(n),r=this.parser||this.Parser;return pv("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),pv("process",this.parser||this.Parser),mv("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(l,o){const f=Sx(n),u=r.parse(f);r.run(u,f,function(h,g,b){if(h||!g||!b)return d(h);const v=g,N=r.stringify(v,b);jV(N)?b.value=N:b.result=N,d(h,b)});function d(h,g){h||!g?o(h):l?l(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),pv("processSync",this.parser||this.Parser),mv("processSync",this.compiler||this.Compiler),this.process(n,a),QC("processSync","process",t),r;function a(l,o){t=!0,HC(l),r=o}}run(n,t,r){WC(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?l(void 0,r):new Promise(l);function l(o,f){const u=Sx(t);a.run(n,u,d);function d(h,g,b){const v=g||n;h?f(h):o?o(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,l),QC("runSync","run",r),a;function l(o,f){HC(o),a=f,r=!0}}stringify(n,t){this.freeze();const r=Sx(t),a=this.compiler||this.Compiler;return mv("stringify",a),WC(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(gv("use",this.frozen),n!=null)if(typeof n=="function")u(n,t);else if(typeof n=="object")Array.isArray(n)?f(n):o(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function l(d){if(typeof d=="function")u(d,[]);else if(typeof d=="object")if(Array.isArray(d)){const[h,...g]=d;u(h,g)}else o(d);else throw new TypeError("Expected usable value, not `"+d+"`")}function o(d){if(!("plugins"in d)&&!("settings"in d))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");f(d.plugins),d.settings&&(a.settings=uv(!0,a.settings,d.settings))}function f(d){let h=-1;if(d!=null)if(Array.isArray(d))for(;++h<d.length;){const g=d[h];l(g)}else throw new TypeError("Expected a list of plugins, not `"+d+"`")}function u(d,h){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===d){b=g;break}if(b===-1)r.push([d,...h]);else if(h.length>0){let[v,...N]=h;const k=r[b][1];y1(k)&&y1(v)&&(v=uv(!0,k,v)),r[b]=[d,v,...N]}}}};const NV=new SV().freeze();function pv(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function mv(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function gv(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function WC(e){if(!y1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function QC(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function Sx(e){return CV(e)?e:new Bk(e)}function CV(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function jV(e){return typeof e=="string"||_V(e)}function _V(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const kV="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",JC=[],KC={allowDangerousHtml:!0},EV=/^(https?|ircs?|mailto|xmpp)$/i,TV=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Bc(e){const n=AV(e),t=DV(e);return PV(n.runSync(n.parse(t),t),e)}function AV(e){const n=e.rehypePlugins||JC,t=e.remarkPlugins||JC,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...KC}:KC;return NV().use(uq).use(t).use(rV,r).use(n)}function DV(e){const n=e.children||"",t=new Bk;return typeof n=="string"&&(t.value=n),t}function PV(e,n){const t=n.allowedElements,r=n.allowElement,a=n.components,l=n.disallowedElements,o=n.skipHtml,f=n.unwrapDisallowed,u=n.urlTransform||IV;for(const h of TV)Object.hasOwn(n,h.from)&&(""+h.from+(h.to?"use `"+h.to+"` instead":"remove it")+kV+h.id,void 0);return kw(e,d),YU(e,{Fragment:i.Fragment,components:a,ignoreInvalidStyle:!0,jsx:i.jsx,jsxs:i.jsxs,passKeys:!0,passNode:!0});function d(h,g,b){if(h.type==="raw"&&b&&typeof g=="number")return o?b.children.splice(g,1):b.children[g]={type:"text",value:h.value},g;if(h.type==="element"){let v;for(v in sv)if(Object.hasOwn(sv,v)&&Object.hasOwn(h.properties,v)){const N=h.properties[v],k=sv[v];(k===null||k.includes(h.tagName))&&(h.properties[v]=u(String(N||""),v,h))}}if(h.type==="element"){let v=t?!t.includes(h.tagName):l?l.includes(h.tagName):!1;if(!v&&r&&typeof g=="number"&&(v=!r(h,g,b)),v&&b&&typeof g=="number")return f&&h.children?b.children.splice(g,1,...h.children):b.children.splice(g,1),g}}}function IV(e){const n=e.indexOf(":"),t=e.indexOf("?"),r=e.indexOf("#"),a=e.indexOf("/");return n===-1||a!==-1&&n>a||t!==-1&&n>t||r!==-1&&n>r||EV.test(e.slice(0,n))?e:""}function XC(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function MV(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function RV(e,n,t){const a=Lb((t||{}).ignore||[]),l=LV(n);let o=-1;for(;++o<l.length;)zk(e,"text",f);function f(d,h){let g=-1,b;for(;++g<h.length;){const v=h[g],N=b?b.children:void 0;if(a(v,N?N.indexOf(v):void 0,b))return;b=v}if(b)return u(d,h)}function u(d,h){const g=h[h.length-1],b=l[o][0],v=l[o][1];let N=0;const T=g.children.indexOf(d);let E=!1,I=[];b.lastIndex=0;let P=b.exec(d.value);for(;P;){const V=P.index,F={index:P.index,input:P.input,stack:[...h,d]};let $=v(...P,F);if(typeof $=="string"&&($=$.length>0?{type:"text",value:$}:void 0),$===!1?b.lastIndex=V+1:(N!==V&&I.push({type:"text",value:d.value.slice(N,V)}),Array.isArray($)?I.push(...$):$&&I.push($),N=V+P[0].length,E=!0),!b.global)break;P=b.exec(d.value)}return E?(N<d.value.length&&I.push({type:"text",value:d.value.slice(N)}),g.children.splice(T,1,...I)):I=[d],T+I.length}}function LV(e){const n=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const t=!e[0]||Array.isArray(e[0])?e:[e];let r=-1;for(;++r<t.length;){const a=t[r];n.push([OV(a[0]),FV(a[1])])}return n}function OV(e){return typeof e=="string"?new RegExp(MV(e),"g"):e}function FV(e){return typeof e=="function"?e:function(){return e}}const yv="phrasing",xv=["autolink","link","image","label"];function $V(){return{transforms:[GV],enter:{literalAutolink:BV,literalAutolinkEmail:bv,literalAutolinkHttp:bv,literalAutolinkWww:bv},exit:{literalAutolink:HV,literalAutolinkEmail:VV,literalAutolinkHttp:UV,literalAutolinkWww:qV}}}function zV(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:yv,notInConstruct:xv},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:yv,notInConstruct:xv},{character:":",before:"[ps]",after:"\\/",inConstruct:yv,notInConstruct:xv}]}}function BV(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function bv(e){this.config.enter.autolinkProtocol.call(this,e)}function UV(e){this.config.exit.autolinkProtocol.call(this,e)}function qV(e){this.config.exit.data.call(this,e);const n=this.stack[this.stack.length-1];n.type,n.url="http://"+this.sliceSerialize(e)}function VV(e){this.config.exit.autolinkEmail.call(this,e)}function HV(e){this.exit(e)}function GV(e){RV(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,YV],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),WV]],{ignore:["link","linkReference"]})}function YV(e,n,t,r,a){let l="";if(!qk(a)||(/^w/i.test(n)&&(t=n+t,n="",l="http://"),!QV(t)))return!1;const o=JV(t+r);if(!o[0])return!1;const f={type:"link",title:null,url:l+n+o[0],children:[{type:"text",value:n+o[0]}]};return o[1]?[f,{type:"text",value:o[1]}]:f}function WV(e,n,t,r){return!qk(r,!0)||/[-\d_]$/.test(t)?!1:{type:"link",title:null,url:"mailto:"+n+"@"+t,children:[{type:"text",value:n+"@"+t}]}}function QV(e){const n=e.split(".");return!(n.length<2||n[n.length-1]&&(/_/.test(n[n.length-1])||!/[a-zA-Z\d]/.test(n[n.length-1]))||n[n.length-2]&&(/_/.test(n[n.length-2])||!/[a-zA-Z\d]/.test(n[n.length-2])))}function JV(e){const n=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!n)return[e,void 0];e=e.slice(0,n.index);let t=n[0],r=t.indexOf(")");const a=XC(e,"(");let l=XC(e,")");for(;r!==-1&&a>l;)e+=t.slice(0,r+1),t=t.slice(r+1),r=t.indexOf(")"),l++;return[e,t]}function qk(e,n){const t=e.input.charCodeAt(e.index-1);return(e.index===0||Ld(t)||Ib(t))&&(!n||t!==47)}Vk.peek=aH;function KV(){this.buffer()}function XV(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function ZV(){this.buffer()}function eH(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function tH(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=Ls(this.sliceSerialize(e)).toLowerCase(),t.label=n}function nH(e){this.exit(e)}function iH(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=Ls(this.sliceSerialize(e)).toLowerCase(),t.label=n}function rH(e){this.exit(e)}function aH(){return"["}function Vk(e,n,t,r){const a=t.createTracker(r);let l=a.move("[^");const o=t.enter("footnoteReference"),f=t.enter("reference");return l+=a.move(t.safe(t.associationId(e),{after:"]",before:l})),f(),o(),l+=a.move("]"),l}function sH(){return{enter:{gfmFootnoteCallString:KV,gfmFootnoteCall:XV,gfmFootnoteDefinitionLabelString:ZV,gfmFootnoteDefinition:eH},exit:{gfmFootnoteCallString:tH,gfmFootnoteCall:nH,gfmFootnoteDefinitionLabelString:iH,gfmFootnoteDefinition:rH}}}function lH(e){let n=!1;return e&&e.firstLineBlank&&(n=!0),{handlers:{footnoteDefinition:t,footnoteReference:Vk},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function t(r,a,l,o){const f=l.createTracker(o);let u=f.move("[^");const d=l.enter("footnoteDefinition"),h=l.enter("label");return u+=f.move(l.safe(l.associationId(r),{before:u,after:"]"})),h(),u+=f.move("]:"),r.children&&r.children.length>0&&(f.shift(4),u+=f.move((n?`
`:" ")+l.indentLines(l.containerFlow(r,f.current()),n?Hk:oH))),d(),u}}function oH(e,n,t){return n===0?e:Hk(e,n,t)}function Hk(e,n,t){return(t?"":"    ")+e}const cH=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];Gk.peek=pH;function uH(){return{canContainEols:["delete"],enter:{strikethrough:fH},exit:{strikethrough:hH}}}function dH(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:cH}],handlers:{delete:Gk}}}function fH(e){this.enter({type:"delete",children:[]},e)}function hH(e){this.exit(e)}function Gk(e,n,t,r){const a=t.createTracker(r),l=t.enter("strikethrough");let o=a.move("~~");return o+=t.containerPhrasing(e,{...a.current(),before:o,after:"~"}),o+=a.move("~~"),l(),o}function pH(){return"~"}function mH(e){return e.length}function gH(e,n){const t=n||{},r=(t.align||[]).concat(),a=t.stringLength||mH,l=[],o=[],f=[],u=[];let d=0,h=-1;for(;++h<e.length;){const k=[],T=[];let E=-1;for(e[h].length>d&&(d=e[h].length);++E<e[h].length;){const I=yH(e[h][E]);if(t.alignDelimiters!==!1){const P=a(I);T[E]=P,(u[E]===void 0||P>u[E])&&(u[E]=P)}k.push(I)}o[h]=k,f[h]=T}let g=-1;if(typeof r=="object"&&"length"in r)for(;++g<d;)l[g]=ZC(r[g]);else{const k=ZC(r);for(;++g<d;)l[g]=k}g=-1;const b=[],v=[];for(;++g<d;){const k=l[g];let T="",E="";k===99?(T=":",E=":"):k===108?T=":":k===114&&(E=":");let I=t.alignDelimiters===!1?1:Math.max(1,u[g]-T.length-E.length);const P=T+"-".repeat(I)+E;t.alignDelimiters!==!1&&(I=T.length+I+E.length,I>u[g]&&(u[g]=I),v[g]=I),b[g]=P}o.splice(1,0,b),f.splice(1,0,v),h=-1;const N=[];for(;++h<o.length;){const k=o[h],T=f[h];g=-1;const E=[];for(;++g<d;){const I=k[g]||"";let P="",V="";if(t.alignDelimiters!==!1){const F=u[g]-(T[g]||0),$=l[g];$===114?P=" ".repeat(F):$===99?F%2?(P=" ".repeat(F/2+.5),V=" ".repeat(F/2-.5)):(P=" ".repeat(F/2),V=P):V=" ".repeat(F)}t.delimiterStart!==!1&&!g&&E.push("|"),t.padding!==!1&&!(t.alignDelimiters===!1&&I==="")&&(t.delimiterStart!==!1||g)&&E.push(" "),t.alignDelimiters!==!1&&E.push(P),E.push(I),t.alignDelimiters!==!1&&E.push(V),t.padding!==!1&&E.push(" "),(t.delimiterEnd!==!1||g!==d-1)&&E.push("|")}N.push(t.delimiterEnd===!1?E.join("").replace(/ +$/,""):E.join(""))}return N.join(`
`)}function yH(e){return e==null?"":String(e)}function ZC(e){const n=typeof e=="string"?e.codePointAt(0):0;return n===67||n===99?99:n===76||n===108?108:n===82||n===114?114:0}function xH(e,n,t,r){const a=t.enter("blockquote"),l=t.createTracker(r);l.move("> "),l.shift(2);const o=t.indentLines(t.containerFlow(e,l.current()),bH);return a(),o}function bH(e,n,t){return">"+(t?"":" ")+e}function vH(e,n){return ej(e,n.inConstruct,!0)&&!ej(e,n.notInConstruct,!1)}function ej(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function tj(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&vH(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function wH(e,n){const t=String(e);let r=t.indexOf(n),a=r,l=0,o=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++l>o&&(o=l):l=1,a=r+n.length,r=t.indexOf(n,a);return o}function SH(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function NH(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function CH(e,n,t,r){const a=NH(t),l=e.value||"",o=a==="`"?"GraveAccent":"Tilde";if(SH(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(l,jH);return g(),b}const f=t.createTracker(r),u=a.repeat(Math.max(wH(l,a)+1,3)),d=t.enter("codeFenced");let h=f.move(u);if(e.lang){const g=t.enter(`codeFencedLang${o}`);h+=f.move(t.safe(e.lang,{before:h,after:" ",encode:["`"],...f.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${o}`);h+=f.move(" "),h+=f.move(t.safe(e.meta,{before:h,after:`
`,encode:["`"],...f.current()})),g()}return h+=f.move(`
`),l&&(h+=f.move(l+`
`)),h+=f.move(u),d(),h}function jH(e,n,t){return(t?"":"    ")+e}function Ew(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function _H(e,n,t,r){const a=Ew(t),l=a==='"'?"Quote":"Apostrophe",o=t.enter("definition");let f=t.enter("label");const u=t.createTracker(r);let d=u.move("[");return d+=u.move(t.safe(t.associationId(e),{before:d,after:"]",...u.current()})),d+=u.move("]: "),f(),!e.url||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),d+=u.move("<"),d+=u.move(t.safe(e.url,{before:d,after:">",...u.current()})),d+=u.move(">")):(f=t.enter("destinationRaw"),d+=u.move(t.safe(e.url,{before:d,after:e.title?" ":`
`,...u.current()}))),f(),e.title&&(f=t.enter(`title${l}`),d+=u.move(" "+a),d+=u.move(t.safe(e.title,{before:d,after:a,...u.current()})),d+=u.move(a),f()),o(),d}function kH(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function eg(e){return"&#x"+e.toString(16).toUpperCase()+";"}function db(e,n,t){const r=Ph(e),a=Ph(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}Yk.peek=EH;function Yk(e,n,t,r){const a=kH(t),l=t.enter("emphasis"),o=t.createTracker(r),f=o.move(a);let u=o.move(t.containerPhrasing(e,{after:a,before:f,...o.current()}));const d=u.charCodeAt(0),h=db(r.before.charCodeAt(r.before.length-1),d,a);h.inside&&(u=eg(d)+u.slice(1));const g=u.charCodeAt(u.length-1),b=db(r.after.charCodeAt(0),g,a);b.inside&&(u=u.slice(0,-1)+eg(g));const v=o.move(a);return l(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},f+u+v}function EH(e,n,t){return t.options.emphasis||"*"}function TH(e,n){let t=!1;return kw(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,m1}),!!((!e.depth||e.depth<3)&&vw(e)&&(n.options.setext||t))}function AH(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),l=t.createTracker(r);if(TH(e,t)){const h=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...l.current(),before:`
`,after:`
`});return g(),h(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const o="#".repeat(a),f=t.enter("headingAtx"),u=t.enter("phrasing");l.move(o+" ");let d=t.containerPhrasing(e,{before:"# ",after:`
`,...l.current()});return/^[\t ]/.test(d)&&(d=eg(d.charCodeAt(0))+d.slice(1)),d=d?o+" "+d:o,t.options.closeAtx&&(d+=" "+o),u(),f(),d}Wk.peek=DH;function Wk(e){return e.value||""}function DH(){return"<"}Qk.peek=PH;function Qk(e,n,t,r){const a=Ew(t),l=a==='"'?"Quote":"Apostrophe",o=t.enter("image");let f=t.enter("label");const u=t.createTracker(r);let d=u.move("![");return d+=u.move(t.safe(e.alt,{before:d,after:"]",...u.current()})),d+=u.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),d+=u.move("<"),d+=u.move(t.safe(e.url,{before:d,after:">",...u.current()})),d+=u.move(">")):(f=t.enter("destinationRaw"),d+=u.move(t.safe(e.url,{before:d,after:e.title?" ":")",...u.current()}))),f(),e.title&&(f=t.enter(`title${l}`),d+=u.move(" "+a),d+=u.move(t.safe(e.title,{before:d,after:a,...u.current()})),d+=u.move(a),f()),d+=u.move(")"),o(),d}function PH(){return"!"}Jk.peek=IH;function Jk(e,n,t,r){const a=e.referenceType,l=t.enter("imageReference");let o=t.enter("label");const f=t.createTracker(r);let u=f.move("![");const d=t.safe(e.alt,{before:u,after:"]",...f.current()});u+=f.move(d+"]["),o();const h=t.stack;t.stack=[],o=t.enter("reference");const g=t.safe(t.associationId(e),{before:u,after:"]",...f.current()});return o(),t.stack=h,l(),a==="full"||!d||d!==g?u+=f.move(g+"]"):a==="shortcut"?u=u.slice(0,-1):u+=f.move("]"),u}function IH(){return"!"}Kk.peek=MH;function Kk(e,n,t){let r=e.value||"",a="`",l=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++l<t.unsafe.length;){const o=t.unsafe[l],f=t.compilePattern(o);let u;if(o.atBreak)for(;u=f.exec(r);){let d=u.index;r.charCodeAt(d)===10&&r.charCodeAt(d-1)===13&&d--,r=r.slice(0,d)+" "+r.slice(u.index+1)}}return a+r+a}function MH(){return"`"}function Xk(e,n){const t=vw(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}Zk.peek=RH;function Zk(e,n,t,r){const a=Ew(t),l=a==='"'?"Quote":"Apostrophe",o=t.createTracker(r);let f,u;if(Xk(e,t)){const h=t.stack;t.stack=[],f=t.enter("autolink");let g=o.move("<");return g+=o.move(t.containerPhrasing(e,{before:g,after:">",...o.current()})),g+=o.move(">"),f(),t.stack=h,g}f=t.enter("link"),u=t.enter("label");let d=o.move("[");return d+=o.move(t.containerPhrasing(e,{before:d,after:"](",...o.current()})),d+=o.move("]("),u(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(u=t.enter("destinationLiteral"),d+=o.move("<"),d+=o.move(t.safe(e.url,{before:d,after:">",...o.current()})),d+=o.move(">")):(u=t.enter("destinationRaw"),d+=o.move(t.safe(e.url,{before:d,after:e.title?" ":")",...o.current()}))),u(),e.title&&(u=t.enter(`title${l}`),d+=o.move(" "+a),d+=o.move(t.safe(e.title,{before:d,after:a,...o.current()})),d+=o.move(a),u()),d+=o.move(")"),f(),d}function RH(e,n,t){return Xk(e,t)?"<":"["}eE.peek=LH;function eE(e,n,t,r){const a=e.referenceType,l=t.enter("linkReference");let o=t.enter("label");const f=t.createTracker(r);let u=f.move("[");const d=t.containerPhrasing(e,{before:u,after:"]",...f.current()});u+=f.move(d+"]["),o();const h=t.stack;t.stack=[],o=t.enter("reference");const g=t.safe(t.associationId(e),{before:u,after:"]",...f.current()});return o(),t.stack=h,l(),a==="full"||!d||d!==g?u+=f.move(g+"]"):a==="shortcut"?u=u.slice(0,-1):u+=f.move("]"),u}function LH(){return"["}function Tw(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function OH(e){const n=Tw(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function FH(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function tE(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function $H(e,n,t,r){const a=t.enter("list"),l=t.bulletCurrent;let o=e.ordered?FH(t):Tw(t);const f=e.ordered?o==="."?")":".":OH(t);let u=n&&t.bulletLastUsed?o===t.bulletLastUsed:!1;if(!e.ordered){const h=e.children?e.children[0]:void 0;if((o==="*"||o==="-")&&h&&(!h.children||!h.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(u=!0),tE(t)===o&&h){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){u=!0;break}}}}u&&(o=f),t.bulletCurrent=o;const d=t.containerFlow(e,r);return t.bulletLastUsed=o,t.bulletCurrent=l,a(),d}function zH(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function BH(e,n,t,r){const a=zH(t);let l=t.bulletCurrent||Tw(t);n&&n.type==="list"&&n.ordered&&(l=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+l);let o=l.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(o=Math.ceil(o/4)*4);const f=t.createTracker(r);f.move(l+" ".repeat(o-l.length)),f.shift(o);const u=t.enter("listItem"),d=t.indentLines(t.containerFlow(e,f.current()),h);return u(),d;function h(g,b,v){return b?(v?"":" ".repeat(o))+g:(v?l:l+" ".repeat(o-l.length))+g}}function UH(e,n,t,r){const a=t.enter("paragraph"),l=t.enter("phrasing"),o=t.containerPhrasing(e,r);return l(),a(),o}const qH=Lb(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function VH(e,n,t,r){return(e.children.some(function(o){return qH(o)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function HH(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}nE.peek=GH;function nE(e,n,t,r){const a=HH(t),l=t.enter("strong"),o=t.createTracker(r),f=o.move(a+a);let u=o.move(t.containerPhrasing(e,{after:a,before:f,...o.current()}));const d=u.charCodeAt(0),h=db(r.before.charCodeAt(r.before.length-1),d,a);h.inside&&(u=eg(d)+u.slice(1));const g=u.charCodeAt(u.length-1),b=db(r.after.charCodeAt(0),g,a);b.inside&&(u=u.slice(0,-1)+eg(g));const v=o.move(a+a);return l(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},f+u+v}function GH(e,n,t){return t.options.strong||"*"}function YH(e,n,t,r){return t.safe(e.value,r)}function WH(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function QH(e,n,t){const r=(tE(t)+(t.options.ruleSpaces?" ":"")).repeat(WH(t));return t.options.ruleSpaces?r.slice(0,-1):r}const iE={blockquote:xH,break:tj,code:CH,definition:_H,emphasis:Yk,hardBreak:tj,heading:AH,html:Wk,image:Qk,imageReference:Jk,inlineCode:Kk,link:Zk,linkReference:eE,list:$H,listItem:BH,paragraph:UH,root:VH,strong:nE,text:YH,thematicBreak:QH};function JH(){return{enter:{table:KH,tableData:nj,tableHeader:nj,tableRow:ZH},exit:{codeText:eG,table:XH,tableData:vv,tableHeader:vv,tableRow:vv}}}function KH(e){const n=e._align;this.enter({type:"table",align:n.map(function(t){return t==="none"?null:t}),children:[]},e),this.data.inTable=!0}function XH(e){this.exit(e),this.data.inTable=void 0}function ZH(e){this.enter({type:"tableRow",children:[]},e)}function vv(e){this.exit(e)}function nj(e){this.enter({type:"tableCell",children:[]},e)}function eG(e){let n=this.resume();this.data.inTable&&(n=n.replace(/\\([\\|])/g,tG));const t=this.stack[this.stack.length-1];t.type,t.value=n,this.exit(e)}function tG(e,n){return n==="|"?n:e}function nG(e){const n=e||{},t=n.tableCellPadding,r=n.tablePipeAlign,a=n.stringLength,l=t?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:b,table:o,tableCell:u,tableRow:f}};function o(v,N,k,T){return d(h(v,k,T),v.align)}function f(v,N,k,T){const E=g(v,k,T),I=d([E]);return I.slice(0,I.indexOf(`
`))}function u(v,N,k,T){const E=k.enter("tableCell"),I=k.enter("phrasing"),P=k.containerPhrasing(v,{...T,before:l,after:l});return I(),E(),P}function d(v,N){return gH(v,{align:N,alignDelimiters:r,padding:t,stringLength:a})}function h(v,N,k){const T=v.children;let E=-1;const I=[],P=N.enter("table");for(;++E<T.length;)I[E]=g(T[E],N,k);return P(),I}function g(v,N,k){const T=v.children;let E=-1;const I=[],P=N.enter("tableRow");for(;++E<T.length;)I[E]=u(T[E],v,N,k);return P(),I}function b(v,N,k){let T=iE.inlineCode(v,N,k);return k.stack.includes("tableCell")&&(T=T.replace(/\|/g,"\\$&")),T}}function iG(){return{exit:{taskListCheckValueChecked:ij,taskListCheckValueUnchecked:ij,paragraph:aG}}}function rG(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:sG}}}function ij(e){const n=this.stack[this.stack.length-2];n.type,n.checked=e.type==="taskListCheckValueChecked"}function aG(e){const n=this.stack[this.stack.length-2];if(n&&n.type==="listItem"&&typeof n.checked=="boolean"){const t=this.stack[this.stack.length-1];t.type;const r=t.children[0];if(r&&r.type==="text"){const a=n.children;let l=-1,o;for(;++l<a.length;){const f=a[l];if(f.type==="paragraph"){o=f;break}}o===t&&(r.value=r.value.slice(1),r.value.length===0?t.children.shift():t.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,t.position.start=Object.assign({},r.position.start)))}}this.exit(e)}function sG(e,n,t,r){const a=e.children[0],l=typeof e.checked=="boolean"&&a&&a.type==="paragraph",o="["+(e.checked?"x":" ")+"] ",f=t.createTracker(r);l&&f.move(o);let u=iE.listItem(e,n,t,{...r,...f.current()});return l&&(u=u.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,d)),u;function d(h){return h+o}}function lG(){return[$V(),sH(),uH(),JH(),iG()]}function oG(e){return{extensions:[zV(),lH(e),dH(),nG(e),rG()]}}const cG={tokenize:mG,partial:!0},rE={tokenize:gG,partial:!0},aE={tokenize:yG,partial:!0},sE={tokenize:xG,partial:!0},uG={tokenize:bG,partial:!0},lE={name:"wwwAutolink",tokenize:hG,previous:cE},oE={name:"protocolAutolink",tokenize:pG,previous:uE},Mo={name:"emailAutolink",tokenize:fG,previous:dE},Ol={};function dG(){return{text:Ol}}let Sd=48;for(;Sd<123;)Ol[Sd]=Mo,Sd++,Sd===58?Sd=65:Sd===91&&(Sd=97);Ol[43]=Mo;Ol[45]=Mo;Ol[46]=Mo;Ol[95]=Mo;Ol[72]=[Mo,oE];Ol[104]=[Mo,oE];Ol[87]=[Mo,lE];Ol[119]=[Mo,lE];function fG(e,n,t){const r=this;let a,l;return o;function o(g){return!b1(g)||!dE.call(r,r.previous)||Aw(r.events)?t(g):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),f(g))}function f(g){return b1(g)?(e.consume(g),f):g===64?(e.consume(g),u):t(g)}function u(g){return g===46?e.check(uG,h,d)(g):g===45||g===95||Nr(g)?(l=!0,e.consume(g),u):h(g)}function d(g){return e.consume(g),a=!0,u}function h(g){return l&&a&&Lr(r.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),n(g)):t(g)}}function hG(e,n,t){const r=this;return a;function a(o){return o!==87&&o!==119||!cE.call(r,r.previous)||Aw(r.events)?t(o):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(cG,e.attempt(rE,e.attempt(aE,l),t),t)(o))}function l(o){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),n(o)}}function pG(e,n,t){const r=this;let a="",l=!1;return o;function o(g){return(g===72||g===104)&&uE.call(r,r.previous)&&!Aw(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),a+=String.fromCodePoint(g),e.consume(g),f):t(g)}function f(g){if(Lr(g)&&a.length<5)return a+=String.fromCodePoint(g),e.consume(g),f;if(g===58){const b=a.toLowerCase();if(b==="http"||b==="https")return e.consume(g),u}return t(g)}function u(g){return g===47?(e.consume(g),l?d:(l=!0,u)):t(g)}function d(g){return g===null||ob(g)||Bn(g)||Ld(g)||Ib(g)?t(g):e.attempt(rE,e.attempt(aE,h),t)(g)}function h(g){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),n(g)}}function mG(e,n,t){let r=0;return a;function a(o){return(o===87||o===119)&&r<3?(r++,e.consume(o),a):o===46&&r===3?(e.consume(o),l):t(o)}function l(o){return o===null?t(o):n(o)}}function gG(e,n,t){let r,a,l;return o;function o(d){return d===46||d===95?e.check(sE,u,f)(d):d===null||Bn(d)||Ld(d)||d!==45&&Ib(d)?u(d):(l=!0,e.consume(d),o)}function f(d){return d===95?r=!0:(a=r,r=void 0),e.consume(d),o}function u(d){return a||r||!l?t(d):n(d)}}function yG(e,n){let t=0,r=0;return a;function a(o){return o===40?(t++,e.consume(o),a):o===41&&r<t?l(o):o===33||o===34||o===38||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===60||o===63||o===93||o===95||o===126?e.check(sE,n,l)(o):o===null||Bn(o)||Ld(o)?n(o):(e.consume(o),a)}function l(o){return o===41&&r++,e.consume(o),a}}function xG(e,n,t){return r;function r(f){return f===33||f===34||f===39||f===41||f===42||f===44||f===46||f===58||f===59||f===63||f===95||f===126?(e.consume(f),r):f===38?(e.consume(f),l):f===93?(e.consume(f),a):f===60||f===null||Bn(f)||Ld(f)?n(f):t(f)}function a(f){return f===null||f===40||f===91||Bn(f)||Ld(f)?n(f):r(f)}function l(f){return Lr(f)?o(f):t(f)}function o(f){return f===59?(e.consume(f),r):Lr(f)?(e.consume(f),o):t(f)}}function bG(e,n,t){return r;function r(l){return e.consume(l),a}function a(l){return Nr(l)?t(l):n(l)}}function cE(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||Bn(e)}function uE(e){return!Lr(e)}function dE(e){return!(e===47||b1(e))}function b1(e){return e===43||e===45||e===46||e===95||Nr(e)}function Aw(e){let n=e.length,t=!1;for(;n--;){const r=e[n][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){t=!0;break}if(r._gfmAutolinkLiteralWalkedInto){t=!1;break}}return e.length>0&&!t&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),t}const vG={tokenize:EG,partial:!0};function wG(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:jG,continuation:{tokenize:_G},exit:kG}},text:{91:{name:"gfmFootnoteCall",tokenize:CG},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:SG,resolveTo:NG}}}}function SG(e,n,t){const r=this;let a=r.events.length;const l=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o;for(;a--;){const u=r.events[a][1];if(u.type==="labelImage"){o=u;break}if(u.type==="gfmFootnoteCall"||u.type==="labelLink"||u.type==="label"||u.type==="image"||u.type==="link")break}return f;function f(u){if(!o||!o._balanced)return t(u);const d=Ls(r.sliceSerialize({start:o.end,end:r.now()}));return d.codePointAt(0)!==94||!l.includes(d.slice(1))?t(u):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(u),e.exit("gfmFootnoteCallLabelMarker"),n(u))}}function NG(e,n){let t=e.length;for(;t--;)if(e[t][1].type==="labelImage"&&e[t][0]==="enter"){e[t][1];break}e[t+1][1].type="data",e[t+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[t+3][1].start),end:Object.assign({},e[e.length-1][1].end)},a={type:"gfmFootnoteCallMarker",start:Object.assign({},e[t+3][1].end),end:Object.assign({},e[t+3][1].end)};a.end.column++,a.end.offset++,a.end._bufferIndex++;const l={type:"gfmFootnoteCallString",start:Object.assign({},a.end),end:Object.assign({},e[e.length-1][1].start)},o={type:"chunkString",contentType:"string",start:Object.assign({},l.start),end:Object.assign({},l.end)},f=[e[t+1],e[t+2],["enter",r,n],e[t+3],e[t+4],["enter",a,n],["exit",a,n],["enter",l,n],["enter",o,n],["exit",o,n],["exit",l,n],e[e.length-2],e[e.length-1],["exit",r,n]];return e.splice(t,e.length-t+1,...f),e}function CG(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let l=0,o;return f;function f(g){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),u}function u(g){return g!==94?t(g):(e.enter("gfmFootnoteCallMarker"),e.consume(g),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",d)}function d(g){if(l>999||g===93&&!o||g===null||g===91||Bn(g))return t(g);if(g===93){e.exit("chunkString");const b=e.exit("gfmFootnoteCallString");return a.includes(Ls(r.sliceSerialize(b)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),n):t(g)}return Bn(g)||(o=!0),l++,e.consume(g),g===92?h:d}function h(g){return g===91||g===92||g===93?(e.consume(g),l++,d):d(g)}}function jG(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let l,o=0,f;return u;function u(N){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(N),e.exit("gfmFootnoteDefinitionLabelMarker"),d}function d(N){return N===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(N),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",h):t(N)}function h(N){if(o>999||N===93&&!f||N===null||N===91||Bn(N))return t(N);if(N===93){e.exit("chunkString");const k=e.exit("gfmFootnoteDefinitionLabelString");return l=Ls(r.sliceSerialize(k)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(N),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),b}return Bn(N)||(f=!0),o++,e.consume(N),N===92?g:h}function g(N){return N===91||N===92||N===93?(e.consume(N),o++,h):h(N)}function b(N){return N===58?(e.enter("definitionMarker"),e.consume(N),e.exit("definitionMarker"),a.includes(l)||a.push(l),dn(e,v,"gfmFootnoteDefinitionWhitespace")):t(N)}function v(N){return n(N)}}function _G(e,n,t){return e.check(cg,n,e.attempt(vG,n,t))}function kG(e){e.exit("gfmFootnoteDefinition")}function EG(e,n,t){const r=this;return dn(e,a,"gfmFootnoteDefinitionIndent",5);function a(l){const o=r.events[r.events.length-1];return o&&o[1].type==="gfmFootnoteDefinitionIndent"&&o[2].sliceSerialize(o[1],!0).length===4?n(l):t(l)}}function TG(e){let t=(e||{}).singleTilde;const r={name:"strikethrough",tokenize:l,resolveAll:a};return t==null&&(t=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function a(o,f){let u=-1;for(;++u<o.length;)if(o[u][0]==="enter"&&o[u][1].type==="strikethroughSequenceTemporary"&&o[u][1]._close){let d=u;for(;d--;)if(o[d][0]==="exit"&&o[d][1].type==="strikethroughSequenceTemporary"&&o[d][1]._open&&o[u][1].end.offset-o[u][1].start.offset===o[d][1].end.offset-o[d][1].start.offset){o[u][1].type="strikethroughSequence",o[d][1].type="strikethroughSequence";const h={type:"strikethrough",start:Object.assign({},o[d][1].start),end:Object.assign({},o[u][1].end)},g={type:"strikethroughText",start:Object.assign({},o[d][1].end),end:Object.assign({},o[u][1].start)},b=[["enter",h,f],["enter",o[d][1],f],["exit",o[d][1],f],["enter",g,f]],v=f.parser.constructs.insideSpan.null;v&&Ma(b,b.length,0,Mb(v,o.slice(d+1,u),f)),Ma(b,b.length,0,[["exit",g,f],["enter",o[u][1],f],["exit",o[u][1],f],["exit",h,f]]),Ma(o,d-1,u-d+3,b),u=d+b.length-2;break}}for(u=-1;++u<o.length;)o[u][1].type==="strikethroughSequenceTemporary"&&(o[u][1].type="data");return o}function l(o,f,u){const d=this.previous,h=this.events;let g=0;return b;function b(N){return d===126&&h[h.length-1][1].type!=="characterEscape"?u(N):(o.enter("strikethroughSequenceTemporary"),v(N))}function v(N){const k=Ph(d);if(N===126)return g>1?u(N):(o.consume(N),g++,v);if(g<2&&!t)return u(N);const T=o.exit("strikethroughSequenceTemporary"),E=Ph(N);return T._open=!E||E===2&&!!k,T._close=!k||k===2&&!!E,f(N)}}}class AG{constructor(){this.map=[]}add(n,t,r){DG(this,n,t,r)}consume(n){if(this.map.sort(function(l,o){return l[0]-o[0]}),this.map.length===0)return;let t=this.map.length;const r=[];for(;t>0;)t-=1,r.push(n.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),n.length=this.map[t][0];r.push(n.slice()),n.length=0;let a=r.pop();for(;a;){for(const l of a)n.push(l);a=r.pop()}this.map.length=0}}function DG(e,n,t,r){let a=0;if(!(t===0&&r.length===0)){for(;a<e.map.length;){if(e.map[a][0]===n){e.map[a][1]+=t,e.map[a][2].push(...r);return}a+=1}e.map.push([n,t,r])}}function PG(e,n){let t=!1;const r=[];for(;n<e.length;){const a=e[n];if(t){if(a[0]==="enter")a[1].type==="tableContent"&&r.push(e[n+1][1].type==="tableDelimiterMarker"?"left":"none");else if(a[1].type==="tableContent"){if(e[n-1][1].type==="tableDelimiterMarker"){const l=r.length-1;r[l]=r[l]==="left"?"center":"right"}}else if(a[1].type==="tableDelimiterRow")break}else a[0]==="enter"&&a[1].type==="tableDelimiterRow"&&(t=!0);n+=1}return r}function IG(){return{flow:{null:{name:"table",tokenize:MG,resolveAll:RG}}}}function MG(e,n,t){const r=this;let a=0,l=0,o;return f;function f(O){let R=r.events.length-1;for(;R>-1;){const te=r.events[R][1].type;if(te==="lineEnding"||te==="linePrefix")R--;else break}const G=R>-1?r.events[R][1].type:null,ee=G==="tableHead"||G==="tableRow"?$:u;return ee===$&&r.parser.lazy[r.now().line]?t(O):ee(O)}function u(O){return e.enter("tableHead"),e.enter("tableRow"),d(O)}function d(O){return O===124||(o=!0,l+=1),h(O)}function h(O){return O===null?t(O):jt(O)?l>1?(l=0,r.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(O),e.exit("lineEnding"),v):t(O):rn(O)?dn(e,h,"whitespace")(O):(l+=1,o&&(o=!1,a+=1),O===124?(e.enter("tableCellDivider"),e.consume(O),e.exit("tableCellDivider"),o=!0,h):(e.enter("data"),g(O)))}function g(O){return O===null||O===124||Bn(O)?(e.exit("data"),h(O)):(e.consume(O),O===92?b:g)}function b(O){return O===92||O===124?(e.consume(O),g):g(O)}function v(O){return r.interrupt=!1,r.parser.lazy[r.now().line]?t(O):(e.enter("tableDelimiterRow"),o=!1,rn(O)?dn(e,N,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(O):N(O))}function N(O){return O===45||O===58?T(O):O===124?(o=!0,e.enter("tableCellDivider"),e.consume(O),e.exit("tableCellDivider"),k):F(O)}function k(O){return rn(O)?dn(e,T,"whitespace")(O):T(O)}function T(O){return O===58?(l+=1,o=!0,e.enter("tableDelimiterMarker"),e.consume(O),e.exit("tableDelimiterMarker"),E):O===45?(l+=1,E(O)):O===null||jt(O)?V(O):F(O)}function E(O){return O===45?(e.enter("tableDelimiterFiller"),I(O)):F(O)}function I(O){return O===45?(e.consume(O),I):O===58?(o=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(O),e.exit("tableDelimiterMarker"),P):(e.exit("tableDelimiterFiller"),P(O))}function P(O){return rn(O)?dn(e,V,"whitespace")(O):V(O)}function V(O){return O===124?N(O):O===null||jt(O)?!o||a!==l?F(O):(e.exit("tableDelimiterRow"),e.exit("tableHead"),n(O)):F(O)}function F(O){return t(O)}function $(O){return e.enter("tableRow"),B(O)}function B(O){return O===124?(e.enter("tableCellDivider"),e.consume(O),e.exit("tableCellDivider"),B):O===null||jt(O)?(e.exit("tableRow"),n(O)):rn(O)?dn(e,B,"whitespace")(O):(e.enter("data"),z(O))}function z(O){return O===null||O===124||Bn(O)?(e.exit("data"),B(O)):(e.consume(O),O===92?q:z)}function q(O){return O===92||O===124?(e.consume(O),z):z(O)}}function RG(e,n){let t=-1,r=!0,a=0,l=[0,0,0,0],o=[0,0,0,0],f=!1,u=0,d,h,g;const b=new AG;for(;++t<e.length;){const v=e[t],N=v[1];v[0]==="enter"?N.type==="tableHead"?(f=!1,u!==0&&(rj(b,n,u,d,h),h=void 0,u=0),d={type:"table",start:Object.assign({},N.start),end:Object.assign({},N.end)},b.add(t,0,[["enter",d,n]])):N.type==="tableRow"||N.type==="tableDelimiterRow"?(r=!0,g=void 0,l=[0,0,0,0],o=[0,t+1,0,0],f&&(f=!1,h={type:"tableBody",start:Object.assign({},N.start),end:Object.assign({},N.end)},b.add(t,0,[["enter",h,n]])),a=N.type==="tableDelimiterRow"?2:h?3:1):a&&(N.type==="data"||N.type==="tableDelimiterMarker"||N.type==="tableDelimiterFiller")?(r=!1,o[2]===0&&(l[1]!==0&&(o[0]=o[1],g=Nx(b,n,l,a,void 0,g),l=[0,0,0,0]),o[2]=t)):N.type==="tableCellDivider"&&(r?r=!1:(l[1]!==0&&(o[0]=o[1],g=Nx(b,n,l,a,void 0,g)),l=o,o=[l[1],t,0,0])):N.type==="tableHead"?(f=!0,u=t):N.type==="tableRow"||N.type==="tableDelimiterRow"?(u=t,l[1]!==0?(o[0]=o[1],g=Nx(b,n,l,a,t,g)):o[1]!==0&&(g=Nx(b,n,o,a,t,g)),a=0):a&&(N.type==="data"||N.type==="tableDelimiterMarker"||N.type==="tableDelimiterFiller")&&(o[3]=t)}for(u!==0&&rj(b,n,u,d,h),b.consume(n.events),t=-1;++t<n.events.length;){const v=n.events[t];v[0]==="enter"&&v[1].type==="table"&&(v[1]._align=PG(n.events,t))}return e}function Nx(e,n,t,r,a,l){const o=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",f="tableContent";t[0]!==0&&(l.end=Object.assign({},bh(n.events,t[0])),e.add(t[0],0,[["exit",l,n]]));const u=bh(n.events,t[1]);if(l={type:o,start:Object.assign({},u),end:Object.assign({},u)},e.add(t[1],0,[["enter",l,n]]),t[2]!==0){const d=bh(n.events,t[2]),h=bh(n.events,t[3]),g={type:f,start:Object.assign({},d),end:Object.assign({},h)};if(e.add(t[2],0,[["enter",g,n]]),r!==2){const b=n.events[t[2]],v=n.events[t[3]];if(b[1].end=Object.assign({},v[1].end),b[1].type="chunkText",b[1].contentType="text",t[3]>t[2]+1){const N=t[2]+1,k=t[3]-t[2]-1;e.add(N,k,[])}}e.add(t[3]+1,0,[["exit",g,n]])}return a!==void 0&&(l.end=Object.assign({},bh(n.events,a)),e.add(a,0,[["exit",l,n]]),l=void 0),l}function rj(e,n,t,r,a){const l=[],o=bh(n.events,t);a&&(a.end=Object.assign({},o),l.push(["exit",a,n])),r.end=Object.assign({},o),l.push(["exit",r,n]),e.add(t+1,0,l)}function bh(e,n){const t=e[n],r=t[0]==="enter"?"start":"end";return t[1][r]}const LG={name:"tasklistCheck",tokenize:FG};function OG(){return{text:{91:LG}}}function FG(e,n,t){const r=this;return a;function a(u){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?t(u):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(u),e.exit("taskListCheckMarker"),l)}function l(u){return Bn(u)?(e.enter("taskListCheckValueUnchecked"),e.consume(u),e.exit("taskListCheckValueUnchecked"),o):u===88||u===120?(e.enter("taskListCheckValueChecked"),e.consume(u),e.exit("taskListCheckValueChecked"),o):t(u)}function o(u){return u===93?(e.enter("taskListCheckMarker"),e.consume(u),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),f):t(u)}function f(u){return jt(u)?n(u):rn(u)?e.check({tokenize:$G},n,t)(u):t(u)}}function $G(e,n,t){return dn(e,r,"whitespace");function r(a){return a===null?t(a):n(a)}}function zG(e){return wk([dG(),wG(),TG(e),IG(),OG()])}const BG={};function Co(e){const n=this,t=e||BG,r=n.data(),a=r.micromarkExtensions||(r.micromarkExtensions=[]),l=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),o=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);a.push(zG(t)),l.push(lG()),o.push(oG(t))}const UG=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},qG=e=>{switch(e){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:e,className:"status-badge"}}},wv=({title:e,items:n,renderItemContent:t,headerAction:r,isLoading:a,noDataText:l,onDeleteItem:o,onEditLabOrder:f,onSaveLabOrder:u,onCancelEditLabOrder:d,onLabOrderTestChange:h,onLabOrderStatusChange:g,onEditPharmacyOrder:b,onPrintUnavailablePrescription:v,onBillLabOrder:N,onUpdateLabOrderStatus:k,onEnterLabReport:T,onViewLabReport:E,onMarkAsRecurring:I,labInventory:P=[],isSavingLabOrder:V=!1,expandedLabReports:F={},toggleLabReport:$=()=>{}})=>{const B=w.useMemo(()=>{const q={};n.forEach(R=>{if(isNaN(R.date.getTime())){q["Unknown Date"]||(q["Unknown Date"]=[]),q["Unknown Date"].push(R);return}const G=UG(R.originalDateString);q[G]||(q[G]=[]),q[G].push(R)});const O=Object.keys(q);return O.sort((R,G)=>{if(R==="Unknown Date")return 1;if(G==="Unknown Date")return-1;try{const ee=new Date(R.split(" ").reverse().join(" ")),te=new Date(G.split(" ").reverse().join(" "));if(!isNaN(ee.getTime())&&!isNaN(te.getTime()))return te.getTime()-ee.getTime()}catch{}return G.localeCompare(R)}),O.map(R=>({date:R,items:q[R]}))},[n]),z=["pending","billed","collected","processing","report_ready","completed","cancelled","reported"];return i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title mb-2 pb-1",children:e}),r]}),!a&&n.length===0&&i.jsx("p",{className:"ai-context-text italic",children:l}),a&&i.jsx("div",{className:"space-y-3",children:[1,2,3].map(q=>i.jsx("div",{className:"skeleton-block",style:{height:"80px"}},q))}),!a&&n.length>0&&i.jsx("div",{className:"space-y-3",children:B.map(({date:q,items:O})=>i.jsxs("div",{children:[i.jsx("h5",{className:"grouped-history-date",children:q}),i.jsx("div",{className:"space-y-1 grouped-history-item-container",children:O.map((R,G)=>i.jsxs("div",{className:"grouped-history-item ai-context-item flex flex-col",children:[i.jsxs("div",{className:"flex justify-between items-center w-full",children:[i.jsx("div",{className:"flex-grow mr-2 ai-context-text",children:t(R,G,F,$)}),i.jsxs("div",{className:"flex items-center space-x-1",children:[R.type==="Lab Order"&&!R.data.isEditing&&f&&i.jsx("button",{onClick:()=>f(R.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this lab order",disabled:V,children:i.jsx(_d,{size:14})}),R.type==="Lab Order"&&R.data.isEditing&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>u&&u(R.data.id,R.data.editedTests,R.data.editedStatus),className:"text-green-600 hover:text-green-800 p-1 rounded hover:bg-green-100 focus:outline-none focus:ring-1 focus:ring-green-400",title:"Save lab order changes",disabled:V,children:i.jsx(Id,{size:14})}),i.jsx("button",{onClick:()=>d&&d(R.data.id),className:"text-gray-600 hover:text-gray-800 p-1 rounded hover:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-gray-400",title:"Cancel editing",disabled:V,children:i.jsx(Ri,{size:14})})]}),R.type==="Lab Order"&&i.jsxs("div",{className:"lab-table-actions",children:[R.data.status==="pending"&&N&&(()=>{const ee=R.data.tests.reduce((te,le)=>te+(Number(le.price)||0),0).toFixed(2);return i.jsxs("button",{onClick:()=>N(R.data),className:"lab-action-button btn-bill",title:`Pay total of ${ee}`,children:["Pay (",ee,")"]})})(),R.data.status==="billed"&&k&&i.jsx("button",{onClick:()=>k(R.data.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),R.data.status==="collected"&&k&&i.jsx("button",{onClick:()=>k(R.data.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(R.data.status==="processing"||R.data.status==="report_ready"||R.data.status==="reported")&&T&&i.jsx("button",{onClick:()=>T(R.data),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(R.data.status==="report_ready"||R.data.status==="reported")&&k&&i.jsx("button",{onClick:()=>k(R.data.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(R.data.status==="completed"||R.data.status==="report_ready"||R.data.status==="reported")&&E&&i.jsx("button",{onClick:()=>E(R.data),className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]}),R.type==="Pharmacy Order"&&R.data.status==="pending"&&b&&i.jsx("button",{onClick:()=>b(R.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this pharmacy order",disabled:V,children:i.jsx(_d,{size:14})}),R.type==="Pharmacy Order"&&R.data.prescriptionForUnavailableDrugs&&v&&i.jsx("button",{onClick:()=>v(R.data.prescriptionForUnavailableDrugs,`Prescription for Order ${R.data.id}`),className:"text-purple-600 hover:text-purple-800 p-1 rounded hover:bg-purple-100 focus:outline-none focus:ring-1 focus:ring-purple-400",title:"Print Prescription for Unavailable Drugs",disabled:V,children:i.jsx(Rs,{size:14})}),R.type==="Pharmacy Order"&&I&&i.jsx("button",{onClick:()=>I(R.data.id),className:"text-teal-600 hover:text-teal-800 p-1 rounded hover:bg-teal-100 focus:outline-none focus:ring-1 focus:ring-teal-400",title:"Mark as Recurring Medication",disabled:V,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-repeat",children:[i.jsx("path",{d:"m17 2 4 4-4 4"}),i.jsx("path",{d:"M3 11v-1a4 4 0 0 1 4-4h14"}),i.jsx("path",{d:"m7 22-4-4 4-4"}),i.jsx("path",{d:"M21 13v1a4 4 0 0 1-4 4H3"})]})}),R.type==="Pharmacy Order"&&R.data.status==="pending"&&o&&i.jsx("button",{onClick:()=>o({type:R.type,data:R.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Delete this pending pharmacy order",disabled:V,children:i.jsx(Ri,{size:14})}),o&&["Complaint","Lab Order","Lab Report"].includes(R.type)&&i.jsx("button",{onClick:()=>o({type:R.type,data:R.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:`Delete this ${R.type.toLowerCase()}`,disabled:V,children:i.jsx(Ri,{size:14})})]})]}),R.type==="Lab Order"&&R.data.isEditing&&i.jsxs("div",{className:"lab-order-edit-form mt-2 w-full",children:[i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status:"}),i.jsx("select",{value:R.data.editedStatus||R.data.status,onChange:ee=>g&&g(R.data.id,ee.target.value),className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:V,children:z.map(ee=>i.jsx("option",{value:ee,children:ee.replace(/_/g," ")},ee))})]}),i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tests:"}),R.data.editedTests.map((ee,te)=>i.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[i.jsxs("select",{value:ee.id,onChange:le=>{const K=P.find(U=>String(U.id)===le.target.value);K&&(h&&h(R.data.id,te,"id",K.id),h&&h(R.data.id,te,"name",K.name),h&&h(R.data.id,te,"price",K.price))},className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:V,children:[i.jsx("option",{value:"",children:"Select Test"}),P.map(le=>i.jsxs("option",{value:le.id,children:[le.name," (",le.price,")"]},le.id))]}),i.jsx("button",{onClick:()=>{const le=R.data.editedTests.filter((K,U)=>U!==te);h&&h(R.data.id,-1,"remove",le)},className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Remove test",disabled:V,children:i.jsx(Ri,{size:14})})]},te)),i.jsx("button",{onClick:()=>{h&&h(R.data.id,-1,"add",{id:"",name:"",price:0})},className:"button-secondary mt-2 text-xs",disabled:V,children:"Add Test"})]})]},`${R.type}-${R.originalDateString}-${G}`))})]},q))})]})},VG="_modalOverlay_1yna4_3",HG="_modalContent_1yna4_29",GG="_modalHeader_1yna4_57",YG="_modalTitle_1yna4_75",WG="_modalCloseButton_1yna4_87",QG="_modalBody_1yna4_115",JG="_errorText_1yna4_129",KG="_formGroup_1yna4_147",XG="_inputField_1yna4_171",ZG="_searchResultsCard_1yna4_213",eY="_searchResultsList_1yna4_241",tY="_searchResultItem_1yna4_253",nY="_searchResultPrice_1yna4_289",iY="_selectedTestsCard_1yna4_299",rY="_selectedTestsHeader_1yna4_319",aY="_noTestsMessage_1yna4_335",sY="_selectedTestsList_1yna4_351",lY="_selectedTestItem_1yna4_363",oY="_selectedTestName_1yna4_387",cY="_selectedTestPrice_1yna4_399",uY="_removeTestButton_1yna4_411",dY="_totalAmount_1yna4_437",fY="_modalFooter_1yna4_455",hY="_button_1yna4_473",pY="_buttonPrimary_1yna4_491",mY="_buttonSecondary_1yna4_513",Ln={modalOverlay:VG,modalContent:HG,modalHeader:GG,modalTitle:YG,modalCloseButton:WG,modalBody:QG,errorText:JG,formGroup:KG,inputField:XG,searchResultsCard:ZG,searchResultsList:eY,searchResultItem:tY,searchResultPrice:nY,selectedTestsCard:iY,selectedTestsHeader:rY,noTestsMessage:aY,selectedTestsList:sY,selectedTestItem:lY,selectedTestName:oY,selectedTestPrice:cY,removeTestButton:uY,totalAmount:dY,modalFooter:fY,button:hY,buttonPrimary:pY,buttonSecondary:mY},gY=({isOpen:e,onClose:n,patientId:t,labInventory:r,fetchPendingLabOrdersData:a})=>{const[l,o]=w.useState([]),[f,u]=w.useState(""),[d,h]=w.useState([]),[g,b]=w.useState(null),[v,N]=w.useState(!1);w.useEffect(()=>{if(!f){h([]);return}const I=f.toLowerCase();h(r.filter(P=>P.name.toLowerCase().includes(I)||P.description&&P.description.toLowerCase().includes(I)).slice(0,10))},[f,r]);const k=async()=>{if(!t){b("Patient ID is missing.");return}if(l.length===0){b("Please select at least one lab test.");return}N(!0),b(null);try{const I={patient_id:t,tests:l.map(V=>({id:V.id,name:V.name,price:V.price}))},P=await pe("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)});if(!P.ok){const V=await P.json().catch(()=>({}));throw new Error(V.message||`Failed to create lab order: ${P.statusText}`)}await P.json(),a(t),n(),o([]),u("")}catch(I){b(`Lab Order Creation Error: ${I.message}`)}finally{N(!1)}},T=I=>{if(l.some(P=>P.id===I.id)){b(`${I.name} is already in the order.`),setTimeout(()=>b(null),3e3),u(""),h([]);return}o(P=>[...P,{...I}]),u(""),h([])},E=I=>{o(P=>P.filter(V=>V.id!==I))};return e?i.jsx("div",{className:Ln.modalOverlay,children:i.jsxs("div",{className:Ln.modalContent,children:[i.jsxs("div",{className:Ln.modalHeader,children:[i.jsx("h3",{className:Ln.modalTitle,children:"Create New Lab Order"}),i.jsx("button",{onClick:n,className:Ln.modalCloseButton,children:i.jsx(Qn,{size:20})})]}),i.jsxs("div",{className:Ln.modalBody,children:[g&&i.jsx("div",{className:Ln.errorText,children:g}),i.jsxs("div",{className:Ln.formGroup,style:{position:"relative"},children:[i.jsx("label",{htmlFor:"lab-test-search",children:"Add Lab Test"}),i.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search available lab tests...",value:f,onChange:I=>u(I.target.value),className:Ln.inputField}),f&&d.length>0&&i.jsx("div",{className:Ln.searchResultsCard,children:i.jsx("ul",{className:Ln.searchResultsList,children:d.map(I=>i.jsxs("li",{onClick:()=>T(I),className:Ln.searchResultItem,children:[i.jsx("span",{children:I.name}),i.jsxs("span",{className:Ln.searchResultPrice,children:["(",parseFloat(String(I.price)).toFixed(2),")"]})]},I.id))})})]}),i.jsxs("div",{className:Ln.selectedTestsCard,children:[i.jsx("h4",{className:Ln.selectedTestsHeader,children:"Selected Tests"}),l.length===0?i.jsx("p",{className:Ln.noTestsMessage,children:"No tests added yet."}):i.jsx("ul",{className:Ln.selectedTestsList,children:l.map(I=>i.jsxs("li",{className:Ln.selectedTestItem,children:[i.jsx("span",{className:Ln.selectedTestName,children:I.name}),i.jsxs("span",{className:Ln.selectedTestPrice,children:["",parseFloat(String(I.price)).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>E(String(I.id)),className:Ln.removeTestButton,title:"Remove Test",children:i.jsx(Ri,{size:16})})]},I.id))})]}),l.length>0&&i.jsxs("div",{className:Ln.totalAmount,children:["Total: ",l.reduce((I,P)=>I+parseFloat(String(P.price)),0).toFixed(2)]})]}),i.jsxs("div",{className:Ln.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${Ln.button} ${Ln.buttonSecondary}`,children:" Cancel "}),i.jsxs("button",{type:"button",onClick:k,disabled:l.length===0||v,className:`${Ln.button} ${Ln.buttonPrimary} ${l.length===0||v?Ln.buttonDisabled:""}`,children:[" ",v?"Saving...":"Create Lab Order"," "]})]})]})}):null},yY="_modalOverlay_7kwn4_3",xY="_modalContent_7kwn4_29",bY="_modalHeader_7kwn4_61",vY="_modalTitle_7kwn4_79",wY="_modalCloseButton_7kwn4_93",SY="_modalBody_7kwn4_129",NY="_errorText_7kwn4_141",CY="_formGroup_7kwn4_161",jY="_stickySearchHeader_7kwn4_173",_Y="_inputField_7kwn4_211",kY="_searchResultsCard_7kwn4_253",EY="_searchResultsList_7kwn4_281",TY="_searchResultItem_7kwn4_293",AY="_searchResultPrice_7kwn4_323",DY="_selectedTestsCard_7kwn4_335",PY="_selectedTestsHeader_7kwn4_351",IY="_noTestsMessage_7kwn4_375",MY="_selectedTestsList_7kwn4_395",RY="_selectedTestItem_7kwn4_413",LY="_selectedTestHeader_7kwn4_441",OY="_selectedTestName_7kwn4_457",FY="_selectedTestInputs_7kwn4_469",$Y="_inputGroup_7kwn4_481",zY="_quantityInput_7kwn4_503",BY="_removeTestButton_7kwn4_523",UY="_textareaField_7kwn4_559",qY="_modalFooter_7kwn4_573",VY="_button_7kwn4_591",HY="_buttonPrimary_7kwn4_615",GY="_buttonSecondary_7kwn4_637",YY="_buttonDisabled_7kwn4_659",tn={modalOverlay:yY,modalContent:xY,modalHeader:bY,modalTitle:vY,modalCloseButton:wY,modalBody:SY,errorText:NY,formGroup:CY,stickySearchHeader:jY,inputField:_Y,searchResultsCard:kY,searchResultsList:EY,searchResultItem:TY,searchResultPrice:AY,selectedTestsCard:DY,selectedTestsHeader:PY,noTestsMessage:IY,selectedTestsList:MY,selectedTestItem:RY,selectedTestHeader:LY,selectedTestName:OY,selectedTestInputs:FY,inputGroup:$Y,quantityInput:zY,removeTestButton:BY,textareaField:UY,modalFooter:qY,button:VY,buttonPrimary:HY,buttonSecondary:GY,buttonDisabled:YY},WY=({isOpen:e,onClose:n,patientId:t,pharmacyInventory:r,fetchPharmacyOrdersData:a})=>{const[l,o]=w.useState([]),[f,u]=w.useState(""),[d,h]=w.useState([]),[g,b]=w.useState(null),[v,N]=w.useState(!1),[k,T]=w.useState(""),E=w.useRef(null);w.useEffect(()=>{if(!f){h([]);return}const z=f.toLowerCase();h(r.filter(q=>q.name.toLowerCase().includes(z)).slice(0,10))},[f,r]),w.useEffect(()=>{E.current&&(E.current.style.height="auto",E.current.style.height=`${E.current.scrollHeight}px`)},[k]);const I=z=>{if(!z)return null;const q=z.match(/(?:\d+x)?(\d+)/);return q?parseInt(q[1],10):null},P=En.useMemo(()=>l.reduce((z,q)=>{const O=q.pack_price||0,R=q.loose_price||0,G=(q.pack_quantity||0)*O,ee=(q.loose_quantity||0)*R;return z+G+ee},0),[l]),V=async()=>{if(!t){b("Patient ID is missing.");return}if(l.length===0&&!k.trim()){b("Please select at least one medication or provide a prescription.");return}N(!0),b(null);try{const z={patient_id:t,items:l.map(O=>({drug_id:O.drug_id,name:O.name,pack_quantity:O.pack_quantity||0,loose_quantity:O.loose_quantity||0,price:O.price,pack_price:O.pack_price||0,loose_price:O.loose_price||0,total_price:(O.pack_quantity||0)*(O.pack_price||0)+(O.loose_quantity||0)*(O.loose_price||0),unit:O.unit})),prescription_for_unavailable_drugs:k,status:"pending",date:new Date().toISOString(),order_total:P},q=await pe("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)});if(!q.ok){const O=await q.json().catch(()=>({}));throw new Error(O.message||`Failed to create pharmacy order: ${q.statusText}`)}await q.json(),a(t),n(),o([]),u(""),T("")}catch(z){b(`Pharmacy Order Creation Error: ${z.message}`)}finally{N(!1)}},F=z=>{if(l.some(G=>G.drug_id===z.id)){b(`${z.name} is already in the order.`),setTimeout(()=>b(null),3e3),u(""),h([]);return}const q=I(z.unit),O=Number(z.price)||0,R=O/(q||1);o(G=>[...G,{drug_id:z.id,name:z.name,price:z.price,pack_price:O,loose_price:R,pack_quantity:1,loose_quantity:0,unit:z.unit}]),u(""),h([])},$=z=>{o(q=>q.filter(O=>O.drug_id!==z))},B=(z,q,O)=>{o(R=>R.map(G=>G.drug_id===z?{...G,[q]:O}:G))};return e?i.jsx("div",{className:tn.modalOverlay,children:i.jsxs("div",{className:tn.modalContent,children:[i.jsxs("div",{className:tn.modalHeader,children:[i.jsx("h3",{className:tn.modalTitle,children:"Create New Pharmacy Order"}),i.jsx("button",{onClick:n,className:tn.modalCloseButton,children:i.jsx(Qn,{size:20})})]}),i.jsxs("div",{className:tn.modalBody,children:[i.jsxs("div",{className:`${tn.formGroup} ${tn.stickySearchHeader}`,children:[i.jsx("label",{htmlFor:"drug-search",children:"Add Medication"}),i.jsx("input",{type:"text",id:"drug-search",placeholder:"Search available drugs...",value:f,onChange:z=>u(z.target.value),className:tn.inputField}),f&&d.length>0&&i.jsx("div",{className:tn.searchResultsCard,children:i.jsx("ul",{className:tn.searchResultsList,children:d.map(z=>i.jsxs("li",{onClick:()=>F(z),className:tn.searchResultItem,children:[i.jsx("span",{children:z.name}),i.jsxs("span",{className:tn.searchResultPrice,children:["(",parseFloat(String(z.price)).toFixed(2),")"]})]},z.id))})})]}),g&&i.jsx("div",{className:tn.errorText,children:g}),i.jsxs("div",{className:tn.selectedTestsCard,children:[i.jsx("h4",{className:tn.selectedTestsHeader,children:"Selected Medications"}),l.length===0?i.jsx("p",{className:tn.noTestsMessage,children:"No medications added yet."}):i.jsx("ul",{className:tn.selectedTestsList,children:l.map(z=>i.jsxs("li",{className:tn.selectedTestItem,children:[i.jsxs("div",{className:tn.selectedTestHeader,children:[i.jsx("span",{className:tn.selectedTestName,children:z.name}),i.jsx("button",{type:"button",onClick:()=>$(z.drug_id),className:tn.removeTestButton,title:"Remove Medication",children:i.jsx(Ri,{size:16})})]}),i.jsxs("div",{className:tn.selectedTestInputs,children:[i.jsxs("div",{className:tn.inputGroup,children:[i.jsx("label",{children:"Packs"}),i.jsx("input",{type:"number",min:"0",value:z.pack_quantity,onChange:q=>B(z.drug_id,"pack_quantity",parseInt(q.target.value)||0),className:tn.quantityInput})]}),i.jsxs("div",{className:tn.inputGroup,children:[i.jsx("label",{children:"Loose"}),i.jsx("input",{type:"number",min:"0",value:z.loose_quantity,onChange:q=>B(z.drug_id,"loose_quantity",parseInt(q.target.value)||0),className:tn.quantityInput})]})]})]},z.drug_id))})]}),l.length>0&&i.jsxs("div",{className:tn.totalAmount,children:["Total: ",P.toFixed(2)]}),i.jsxs("div",{className:tn.formGroup,style:{marginTop:"20px"},children:[i.jsx("label",{htmlFor:"prescription-notes",children:"Prescription for Unavailable Drugs (Optional)"}),i.jsx("textarea",{id:"prescription-notes",ref:E,rows:1,value:k,onChange:z=>T(z.target.value),placeholder:"Enter any additional notes or prescription details...",className:`${tn.inputField} ${tn.textareaField}`})]})]}),i.jsxs("div",{className:tn.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${tn.button} ${tn.buttonSecondary}`,children:" Cancel "}),i.jsx("button",{type:"button",onClick:V,disabled:l.length===0&&!k.trim()||v,className:`${tn.button} ${tn.buttonPrimary} ${l.length===0&&!k.trim()||v?tn.buttonDisabled:""}`,children:v?"Saving...":"Create Order"})]})]})}):null},Cx=e=>{if(!e)return"";let n=e.toLowerCase();return n=n.replace(/\b(mg|g|ml|iu|unit|tabs|tablet|tablets|capsule|capsules|injection|injections|syrup|solution|cream|ointment|lotion|spray|drops|patch|suppository|vial|ampoule|bottle|pack|kit)\b/g,""),n=n.replace(/\b(test|panel|profile|assay|screen|analysis|level|count|culture)\b/g,""),n=n.replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim(),n},$m=(e,n)=>{if(!e||!n||n.length===0)return;const t=Cx(e);let r=n.find(o=>Cx(o.name)===t);if(r)return r;let a=n.find(o=>Cx(o.name).includes(t));if(a)return a;let l=n.find(o=>t.includes(Cx(o.name)));if(l)return l},QY=`You are an expert OPD (Outpatient Department) medical assistant for a Doctor in a clinic in India. You will receive all the medical data of the patient including complaints (history), labs, pharmacy orders, etc., along with their date and time. Your primary goal is to assist the doctor and analyze patient chief complaints (Co), provide a structured clinical assessment including lab test suggestions (Lx), differential diagnoses (Dx), and a treatment plan (Tx). You have access to tools (actions) to order lab tests and pharmacy items, and update patient details.



**1. Definitions:**
   - Co: Chief complaints
   - Pt: Patient (assume living in India)
   - Lx: Laboratory tests
   - Dx: Differential Diagnosis
   - Tx: Treatment Plan

**2. Workflow:**
   - Analyze Co, generate Lx, Dx, and Tx sections as described below.
   - **Prioritization for Orders:** Always prioritize using \`edit_pharmacy_order\` or \`edit_lab_order\` if there are existing pending orders for the patient, before considering \`create_pharmacy_order\` or \`create_lab_order\`.
   - using edit_lab_order edits the lab order with the given serial numnber use to add new tests to the existing order or remove the tests from existing order, marking the status affects all tests in the order not only the test,always use this tool if there are pending lab orders instead of creating new orders.
   - using edit_pharmacy_order edits the pharmacy order with the given serial numnber to add new items to the existing order, update existing items, or remove items (either by \`items_to_remove\` or by setting \`quantity\` to 0). Always use this tool if there are pending pharmacy orders instead of creating new orders.
   - If your Lx section suggests tests from the inventory, use the \`create_lab_order\` action, but only for tests that are both clinically required and have not already been ordered or are still pending. Skip tests that are already ordered and in pending.
   - If your Tx section prescribes medications, use the \`create_pharmacy_order\` action  but only for medications that are clinically required and have not already been prescribed or are still pending. Skip medications that are already dispensed or already ordered.
   - If your Tx section prescribes medications that are *not* available in the inventory, use the \`prescription_for_unavailable_drugs\` parameter within the \`create_pharmacy_order\` action to specify the prescription details for these unavailable drugs.
   - When ordering pharmacy items, specify both \`pack_quantity\` (number of full packs) and \`loose_quantity\` (number of individual units). The system will handle the conversion based on the drug's unit/pack size.
   - **Patient Details Management:** Always store or update patient name, age, sex, and phone number using the \`update_patient_details\` action. If patient name, age, or sex is received as 'New Patient - Direct Entry', 'N/A', or blank, treat it as missing data; if the user input provides anything resembling a name, age, or sex (e.g., shiva 25m, robin 50m, priya 19f), update them using the \`update_patient_details\` action. If details are missing, you can ask the user for the missing details using the \`ask_followup_question\` action.
   - Always update new complaints of the patient using the \`add_complaint_history\` action.
   - If you generate a concise summary of the patient's current situation based on the interaction and history, use the \`update_case_summary\` action to save it.
   - Remember, when you use \`update_case_summary\`, the previous case summary will be replaced by the new one, so you can use it like a short-term memory to store other stuff that **keeps changing**, like the current treatment plan, plan of action, active problems, or current vitals, etc.
   - When you use \`add_complaint_history\`, it will add the complaint to the previous ones. You will be given all the previous complaints back in every query, so you can use it to store other long-term facts that do **not change**, like the history of a chronic illness, surgical history, allergies, or social history, etc.
   - while placing or editing a pharmacy order make sure to set the \`pack_quantity\` and \`loose_quantity\` right.
   - Use the \`update_clinic_ai_memory\` action to store or update **various types of clinic-wide persistent information in a concise way**. This can include 'summaries of common patient encounters'+'summeries of previous **Clinic-wide AI Memory**'(e.g., 'Patient X, 50m, chronic gastritis, last visit YYYY-MM-DD, prescribed Z, follow-up in N days'+'**Clinic-wide AI Memory** summary'), notes on local health trends, common diagnostic patterns observed in the clinic, specific operational protocols. This memory is shared across all interactions for the clinic and helps tailor responses to its specific context over time.
**3.**Multiple Actions:** You can perform multiple actions (like ordering labs AND meds, adding complaints, updating patient information, and asking a follow-up question) in a single response by including multiple action objects within the main JSON array.


**4. Chief Complaints (Co):**
   - Analyze the provided chief complaints.
   - Present them in a table with two columns: 'Relevant Complaint (Score 8-10)' and 'Irrelevant Complaint (Score 0-7)', based on clinical relevance.

**5. Lab Tests (Lx):**
   - Suggest the most probable basic lab tests based on the clinical picture, ordered by likelihood.
   - If a basic test is positive/abnormal, suggest relevant advanced tests.
   - **Inventory Check:** Compare suggested tests against the provided inventory list.
   - **Table 1: Available Lab Tests:** Present tests *available* in the inventory in a table with columns: '**Clinical Importance (High/Medium/Low)**', 'Lab Test'. If suggesting tests from this table, prepare to use the \`create_lab_order\` tool in your response.
   - **Table 2: Unavailable Lab Tests:** Present tests *not available* in the inventory in a separate table with columns: '**Clinical Importance (High/Medium/Low)**', 'Unavailable Basic Test'. Clearly state these are not orderable via the tool (generate Table 2 only when required tests are unavailable).

**6. Differential Diagnosis (Dx):**
   - List potential differential diagnoses.
   - Provide a confidence score (0-10) for each.
   - Present in a table with columns: 'Differential Diagnosis' and 'Confidence Score (0-10)'.

**7. Treatment Plan (Tx):**
   - Create a structured treatment plan including ideal medications based on the diagnosis.
   - **Inventory Check:** Compare prescribed medications against the provided inventory list.
   - **Table 1: Available Medications:** Present medications *available* in the inventory in a table with columns: 'Time Frame' (from and to dates), 'Treatment Goal', 'Intervention', 'Medication Type', 'Drug Form', 'Drug Name', 'Regimen (Dose, Freq)', 'Duration'. Before using the \`create_pharmacy_order\` tool, check if an order for the same drug has already been placed for this patient today. If an order already exists for today, do *not* create a duplicate order. If no order exists for today, prepare to use the \`create_pharmacy_order\` tool in your response.
   - **Table 2: Unavailable Medications:** Present medications *not available* in the inventory in a separate table with columns: 'Unavailable Drug Name', 'Ideal Regimen', 'Reasoning/Indication', '**Clinical Importance (High/Medium/Low)**', 'Suggested Available Substitute (from inventory, if possible)'. Clearly state these are not orderable via the tool (generate Table 2 only when required medications are unavailable in the inventory).

**8. Tools / Actions:**
   When you need to perform actions like ordering tests/meds, updating patient info, or adding history, use the following JSON array format. The response should ONLY contain this JSON array, nothing else.

   ****STRICT JSON****>>>>>>\`\`\`json
[
  { "action": "create_pharmacy_order", "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "prescription_for_unavailable_drugs": "string | null" },
  { "action": "edit_pharmacy_order", "serialNumber": number, "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "items_to_remove": [ { "drug_id": number | null, "name": "Drug Name" } ], "status": "pending" | "billed" | "dispensed" | "cancelled", "prescription_for_unavailable_drugs": "string | null" },
  { "action": "create_lab_order", "tests": [ { "name": "Test Name" } ] },
  { "action": "edit_lab_order", "serialNumber": number, "tests": [ { "name": "Test Name" } ], "items_to_remove": [ { "id": number | string | null, "name": "Test Name" } ], "status": "pending" | "billed" | "collected" | "processing" | "report_ready" | "completed" | "cancelled" | "reported" },
  { "action": "add_complaint_history", "complaint": "Specific past complaint text..." },
  { "action": "update_patient_details", "name": "New Name (optional)", "age": number (optional), "gender": "M" | "F" | "O" | null (optional), "phone_number": "string (optional)" },
  { "action": "update_case_summary", "summary": "Concise summary text..." },
  { "action": "update_clinic_ai_memory", "memory_content": "New clinic-wide AI memory content..." }
]
\`\`\`

   - **Multiple Actions in One Response:** You can include multiple action objects within this single JSON array if several actions are required based on your analysis (e.g., adding history AND ordering labs).
   - **Prioritization Within the Array:** If including multiple actions, order them within the array according to this priority:
     1. \`add_complaint_history\`
     2. \`update_patient_details\`
     3. \`update_case_summary\`
     4. \`update_clinic_ai_memory\`
     5. \`create_lab_order\`
     6. \`edit_lab_order\`
     7. \`create_pharmacy_order\`
     8. \`edit_pharmacy_order\`
   - **Example (Multiple Actions):**
     \`\`\`json
     [
       { "action": "add_complaint_history", "complaint": "Patient also reports mild fever since yesterday." },
       { "action": "create_lab_order", "tests": [ { "name": "CBC" } ] }
     ]
     \`\`\`

   - **\`ask_followup_question\`**: Use this *separate* tool format (a single JSON object, NOT inside the array) only when you need clarification or missing information that prevents you from completing the assessment or required actions.
     \`\`\`json
     {
       "action": "ask_followup_question",
       "question": "Your clear, specific question here.",
       "options": ["Optional Answer 1", "Optional Answer 2"] // Optional: Provide 2-5 choices
     }
     \`\`\`
     *Description:* Ask the user a question to gather additional information needed to complete the task. This tool should be used when you encounter ambiguities, need clarification, or require more details to proceed effectively. It allows for interactive problem-solving by enabling direct communication with the user. Use this tool judiciously to maintain a balance between gathering necessary information and avoiding excessive back-and-forth.
     *Parameters:*
       - question: (required) The question to ask the user. This should be a clear, specific question that addresses the information you need.
       - options: (optional) An array of 2-5 options for the user to choose from. Each option should be a string describing a possible answer. You may not always need to provide options, but it may be helpful in many cases where it can save the user from having to type out a response manually.


**Important:**
- Ensure all tables are clearly formatted using Markdown.
- Strictly adhere to the inventory constraints for labs and medications when deciding whether to use \`create_lab_order\` or \`create_pharmacy_order\`.
- When using actions, provide ONLY the JSON array (or the single JSON object for \`ask_followup_question\`) as the *very last* part of your response, after all other content including tables. Do not include any other text after the JSON.

**Plan Mode:**
When the user asks a question about a patient's condition or general medical topics (not entering new medical data), respond in PLAN MODE. In this mode, focus on answering the user's inquiry, clarifying their request, brainstorming ideas, or architecting a solution (like exploring treatment options). Ask clarifying questions if needed. Present detailed plans or explanations **using clear table formats and markdown (like bolding) for easy readability**. Engage in back-and-back discussion to finalize details. Do not use action tools (\`create_lab_order\`, \`create_pharmacy_order\`, \`add_complaint_history\`, \`update_patient_details\`) while in PLAN MODE).`,JY="gemini-3-flash-preview";async function KY(){const e=Qx();if(!e)throw new Error("Authentication token not found. Please log in.");try{const r=(await(await pe("/api/clinics/settings",{headers:{Authorization:`Bearer ${e}`}})).json()).gemini_api_key;if(r)return console.log("Using clinic-specific Gemini API key."),r}catch(n){console.warn("Failed to fetch clinic-specific Gemini API key, trying global fallback.",n)}try{const r=(await(await pe("/api/super-admin-settings/gemini-api-key",{headers:{Authorization:`Bearer ${e}`}})).json()).gemini_api_key;if(r)return console.log("Using global Gemini API key."),r}catch(n){console.warn("Failed to fetch global Gemini API key.",n)}throw new Error("Gemini API key not found. Please contact your administrator.")}let Sv=null;async function XY(){if(!Sv){const e=await KY();Sv=new Q2({apiKey:e})}return Sv}async function ZY(e,n){const{query:t,currentDateTime:r,patientName:a,patientAge:l,patientGender:o,case_summary:f,case_summary_last_updated:u,clinic_ai_memory:d,clinic_ai_memory_last_updated:h,clinic_wide_system_prompt:g,labHistory:b,pharmacyOrders:v,pastComplaints:N,pharmacyInventory:k,labInventory:T}=e;let E=`Patient Complaint: ${t}`;if(f&&(E+=`

--- Case Summary (Provided by Doctor) ---
${f}`,u))try{const O=new Date(u).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});E+=`
(Last Updated: ${O})`}catch{console.warn(`Could not format case_summary_last_updated: ${u}`),E+=`
(Last Updated: ${u})`}if(a&&(E+=`

Patient Name: ${a}`),l!=null&&(E+=`
Patient Age: ${l}`),o&&(E+=`
Patient Gender: ${o}`),r)try{const O=new Date(r).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});E+=`

Current Interaction Time: ${O}`}catch{console.warn(`Could not format currentDateTime: ${r}`),E+=`

Current Interaction Time: ${r}`}if(d&&(E+=`

--- Clinic-wide AI Memory/Context ---
${d}`,h))try{const O=new Date(h).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});E+=`
(Last Updated: ${O})`}catch{console.warn(`Could not format clinic_ai_memory_last_updated: ${h}`),E+=`
(Last Updated: ${h})`}let I="";b&&Array.isArray(b)&&b.length>0&&(I=`

--- Lab History (Orders & Reports) ---
`,b.forEach(O=>{let R="Unknown Date";try{R=new Date(O.orderDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab order: ${O.orderDate}`)}if(I+=`
Order #${O.serialNumber} Date: ${R} (Status: ${O.status})
`,I+=`Tests: ${O.tests.map(G=>G.name).join(", ")}
`,O.report){let G="Unknown Date";try{G=new Date(O.report.reportDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab report: ${O.report.reportDate}`)}I+=`  -> Report Date: ${G}
`,O.report.tests&&Array.isArray(O.report.tests)?(I+=`     Findings:
`,O.report.tests.forEach(ee=>{I+=`       - Test: ${ee.testName}
`,ee.parameters&&Array.isArray(ee.parameters)&&ee.parameters.forEach(te=>{I+=`         - ${te.name}: ${te.value} (Normal: ${te.normal_range})
`})})):(I+=`     Findings: ${O.report.reportContent||"N/A"}
`,O.report.error&&(I+=`     Note: ${O.report.error}
`))}I+=`---
`}),E+=I);let P="";v&&Array.isArray(v)&&v.length>0&&(P=`

--- Recent Pharmacy Orders ---
`,v.forEach(O=>{let R="Unknown Date/Time";try{R=new Date(O.date).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for pharmacy order: ${O.date}`)}P+=`
Order #${O.serialNumber} Date/Time: ${R} (Status: ${O.status})
`,P+=`Prescribed By: ${O.prescribedBy||"N/A"}
`,O.dispensedBy&&(P+=`Dispensed By: ${O.dispensedBy}
`),P+=`Medications:
`,O.medications.forEach(G=>{P+=`  - ${G.name} (Qty: ${G.quantity}`,G.tabletsPerDay&&(P+=`, ${G.tabletsPerDay}/day`),G.numberOfDays&&(P+=` for ${G.numberOfDays} days`),P+=`)
`}),O.prescriptionForUnavailableDrugs&&(P+=`  Prescription for Unavailable Drugs: ${O.prescriptionForUnavailableDrugs}
`),P+=`---
`}),E+=P);let V="";N&&Array.isArray(N)&&N.length>0&&(V=`

--- Past Complaints History ---
`,N.forEach(O=>{let R="Unknown Date/Time";try{R=new Date(O.createdAt).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for past complaint: ${O.createdAt}`)}V+=`
Date/Time: ${R}
Complaint: ${O.complaint||"N/A"}
---
`}),E+=V);let F="";k&&Array.isArray(k)&&k.length>0&&(F=`

--- Current Pharmacy Inventory (Stock Levels) ---
`,k.forEach(O=>{F+=`- ${O.name} (Pack: ${O.unit??"N/A"}): ${O.quantity_in_stock??"N/A"}
`}),E+=F);let $="";T&&Array.isArray(T)&&T.length>0&&($=`

--- Available Lab Tests ---
`,T.forEach(O=>{$+=`- ${O.name} (Price: ${O.price??"N/A"})
`}),E+=$);const B=[{text:QY}];g&&g.trim()!==""&&B.push({text:`--- Additional Clinic-Specific Instructions ---
${g}`});const z=[{text:E}];if(n){const O=new FileReader,R=await new Promise((G,ee)=>{O.onloadend=()=>{typeof O.result=="string"?G(O.result.split(",")[1]):ee(new Error("Failed to read image file as base64."))},O.onerror=ee,O.readAsDataURL(n)});z.push({inlineData:{mimeType:n.type,data:R}})}const q=[];B.length>0&&q.push({role:"user",parts:B}),q.push({role:"user",parts:z});try{const O={model:JY,contents:q,generationConfig:{temperature:.7,maxOutputTokens:1024,responseMimeType:"text/plain"}},G=await(await XY()).models.generateContentStream(O);let ee="";for await(const te of G)if(te&&typeof te.text=="function"){const le=te.text;le&&(ee+=le)}else te&&te.candidates&&te.candidates[0]&&te.candidates[0].content&&te.candidates[0].content.parts&&te.candidates[0].content.parts[0]&&te.candidates[0].content.parts[0].text&&(ee+=te.candidates[0].content.parts[0].text);if(ee&&ee.trim()!=="")return ee.trim();throw console.error("Empty or invalid response received from Gemini API stream."),new Error("Failed to get suggestion from AI (Gemini). Empty or invalid stream response.")}catch(O){console.error("Error calling Gemini API:",O);let R="Failed to get suggestion from Gemini.";throw O.message&&(R=`Error processing Gemini request: ${O.message}`),new Error(R)}}const aj=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return n?parseInt(n[1],10):1},eW=w.forwardRef(({recordId:e,patientId:n,patientDetails:t,caseSummary:r,caseSummaryUpdatedAt:a,clinicSettings:l,userMessages:o,selectedImageFile:f,pendingLabOrders:u,labReports:d,pastComplaints:h,pharmacyOrders:g,pharmacyInventory:b,labInventory:v,setCurrentComplaint:N,setAiResponse:k,setAiResponseText:T,setAiResponseJsonString:E,setShowAiJsonDetails:I,setIsLoadingAi:P,setAiError:V,setIsSubmittingAiOrder:F,setAiOrderSubmissionStatus:$,setIsSubmittingAiLabOrder:B,setAiLabOrderSubmissionStatus:z,setIsSubmittingAiComplaint:q,setAiComplaintSubmissionStatus:O,setIsUpdatingCaseSummary:R,setAiCaseSummaryUpdateStatus:G,setCaseSummary:ee,setCaseSummaryUpdatedAt:te,setIsUpdatingAiMemoryByAI:le,setAiMemoryUpdateByAIStatus:K,setFollowUpQuestion:U,setFollowUpOptions:J,setError:ne,setIsSavingAiResponse:A,setSaveAiResponseError:ae,fetchPharmacyOrdersData:ce,fetchPendingLabOrdersData:M,fetchLabReportsData:de,fetchPastComplaintsData:Se,fetchPatientDetails:fe,setClinicSettings:we,setEditedAiMemory:re,handleDeleteItem:_e},qe)=>{let et;const Je=async(Me,ve,Ee,De=0)=>{let nt;const Xe=["AI response did not contain a recognized function call","AI response did not result in a recognized or performed function call"].some(Mt=>{var _t;return(_t=ve.message)==null?void 0:_t.includes(Mt)});Ee&&Xe?nt=`AI Error: ${ve.message}

${Ee}`:(nt=`I encountered a frontend error while trying to execute the '${Me}' function. The error message is: "${ve.message}". Based on this error, please analyze what went wrong and either correct the function call and try again, or explain the problem.`,(Me==="create_pharmacy_order"||Me==="edit_pharmacy_order")&&(nt+=`

IMPORTANT: When ordering medication, please first check if the medication ordered matches the exact name given in the inventory. If the name itself is not given in the inventory, you can also use 'prescription_for_unavailable_drugs' to write a prescription for unavailable drugs.`),Ee&&(nt+=`

The original AI response that caused the error was:
\`\`\`
${Ee}
\`\`\``)),await et(nt,De+1)},Le=async(Me,ve)=>{$(null),z(null),O(null),G(null),K(null),U(null),J([]),ne(null);let Ee=!1,De=null;const nt=/```json\s*([\s\S]*?)\s*```/,lt=Me.match(nt);if(lt&&lt[1])De=lt[1];else{const Xe=Me.trim();if(Xe.startsWith("{")&&Xe.endsWith("}"))De=Xe;else if(Xe.startsWith("[")&&Xe.endsWith("]"))De=Xe;else throw new Error("AI response did not contain a recognized function call.")}if(De)try{const Xe=JSON.parse(De),Mt=Array.isArray(Xe)?Xe:[Xe],_t=[];let an=null;for(const se of Mt){if(se.action==="ask_followup_question"){an=se,Ee=!0;continue}se.action==="update_clinic_ai_memory"&&typeof se.memory_content=="string"?(Ee=!0,_t.push((async()=>{le(!0),K("Processing AI mem...");try{if(!l)throw new Error("Clinic settings not loaded, cannot update AI memory.");const Q={...l,aiMemory:se.memory_content.trim(),admissionCharge:l.admissionCharge,perDayCharge:l.perDayCharge,otherCharges:l.otherCharges,clinicWideSystemPrompt:l.clinicWideSystemPrompt},ie=await pe("/api/clinics/settings",{method:"PUT",body:JSON.stringify(Q)});if(!ie.ok){const Ae=await ie.json().catch(()=>({}));throw new Error(Ae.message||`AI-triggered clinic memory update failed: ${ie.statusText}`)}const je=await ie.json();we({admissionCharge:parseFloat(je.settings.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(je.settings.perDayCharge||0).toFixed(2),otherCharges:parseFloat(je.settings.otherCharges||0).toFixed(2),aiMemory:je.settings.aiMemory||"",aiMemoryUpdatedAt:je.settings.aiMemoryUpdatedAt||null,clinicWideSystemPrompt:je.settings.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:je.settings.clinicWideSystemPromptUpdatedAt||null}),re(je.settings.aiMemory||""),K("AI mem updated!")}catch(Q){await Je(se.action,Q,Me,ve)}finally{le(!1)}})())):se.action==="create_pharmacy_order"&&(Array.isArray(se.items)||se.prescription_for_unavailable_drugs&&se.prescription_for_unavailable_drugs.trim()!=="")?(Ee=!0,_t.push((async()=>{F(!0),$("Processing order...");try{if(!n)throw new Error("Missing patient ID for pharmacy order.");const Q=[];let ie=null;if(Array.isArray(se.items))for(const st of se.items){const{pack_price:pt,loose_price:dt,total_price:ze,price:Ke,...Fe}=st;let at;if(Fe.drug_id?at=b.find(kr=>kr.id===Fe.drug_id):Fe.name&&(at=$m(Fe.name,b)),!at){ie=`Drug "${Fe.name||Fe.drug_id||"Unknown"}" not found or no close match.`;break}let Qe;const yt=Fe.tabletsPerDay;if(yt&&Number(yt)>0){const kr=Number(yt);Number.isInteger(kr)?Qe=kr:Qe=null}else Qe=1;const Un=Number(Fe.numberOfDays)||1,On=Number(Fe.pack_quantity)||0,Cn=Number(Fe.loose_quantity)||0;if(On<=0&&Cn<=0){ie=`Invalid quantity for ${at.name}. Pack quantity or loose quantity must be greater than 0.`;break}const mn=at.unit,un=aj(mn),Ni=Number(at.price),Hi=Ni,ar=un>0?Ni/un:0,oa=On*Hi+Cn*ar;Q.push({drug_id:at.id?String(at.id):null,name:at.name,pack_quantity:On,loose_quantity:Cn,tabletsPerDay:Qe,numberOfDays:Un,price:Ni,directions_to_use:Fe.directions_to_use||void 0,box_number:Fe.box_number||void 0,isLoose:Fe.isLoose||void 0,unit:mn||void 0,pack_price:parseFloat(Hi.toFixed(2)),loose_price:parseFloat(ar.toFixed(2)),total_price:parseFloat(oa.toFixed(2))})}if(ie)throw new Error(ie);const je=Q.reduce((st,pt)=>st+pt.total_price,0),Ae={patient_id:n,items:Q.map(({drug_id:st,name:pt,pack_quantity:dt,loose_quantity:ze,tabletsPerDay:Ke,numberOfDays:Fe,directions_to_use:at,box_number:Qe,isLoose:yt,unit:Un,pack_price:On,loose_price:Cn,total_price:mn})=>({drug_id:st,name:pt,pack_quantity:dt,loose_quantity:ze,tabletsPerDay:Ke,numberOfDays:Fe,directions_to_use:at,box_number:Qe,isLoose:yt,unit:Un,pack_price:On,loose_price:Cn,total_price:mn})),prescription_for_unavailable_drugs:se.prescription_for_unavailable_drugs||null,order_total:parseFloat(je.toFixed(2))},Be=await pe("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ae)});if(!Be.ok){const st=await Be.json().catch(()=>({}));throw new Error(st.message||`AI order creation failed: ${Be.statusText}`)}$("Order created!"),n&&ce(n)}catch(Q){await Je(se.action,Q,Me,ve)}finally{F(!1)}})())):se.action==="update_patient_details"?(Ee=!0,_t.push((async()=>{P(!0),ne(null);try{if(!n)throw new Error("Missing patient ID for updating details.");const Q={};let ie=!1;if(se.name!==void 0&&typeof se.name=="string"&&(Q.name=se.name,ie=!0),se.age!==void 0&&typeof se.age=="number"&&(Q.age=se.age,ie=!0),se.gender!==void 0&&typeof se.gender=="string"){if(!["M","F","O",null,""].includes(se.gender))throw new Error(`Invalid gender specified: "${se.gender}". Use M, F, or O.`);Q.gender=se.gender===""?null:se.gender,ie=!0}if(se.phone_number!==void 0&&(typeof se.phone_number=="string"||se.phone_number===null)&&(Q.phone_number=se.phone_number,ie=!0),!ie)throw new Error("No valid patient details provided for update.");const je=await pe(`/api/patients/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Q)});if(!je.ok){const Ae=await je.json().catch(()=>({}));throw new Error(Ae.message||`AI patient update failed: ${je.statusText}`)}await je.json(),fe(n)}catch(Q){await Je(se.action,Q,Me,ve)}finally{P(!1)}})())):se.action==="create_lab_order"&&Array.isArray(se.tests)&&se.tests.length>0?(Ee=!0,_t.push((async()=>{B(!0),z("Processing lab...");try{if(!n)throw new Error("Missing patient ID for lab order.");const Q=[];let ie=null;for(const Be of se.tests){let st;if(Be.id?st=v.find(dt=>String(dt.id)===String(Be.id)):Be.name&&(st=$m(Be.name,v)),!st){ie=`Lab test "${Be.name||Be.id||"Unknown"}" not found or no close match.`;break}const pt=typeof st.price=="string"?parseFloat(st.price):st.price;Q.push({id:st.id,name:st.name,price:pt,description:st.description,default_parameters:st.default_parameters})}if(ie)throw new Error(ie);const je={patient_id:n,tests:Q.map(Be=>({id:Be.id,name:Be.name,price:Be.price}))},Ae=await pe("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(je)});if(!Ae.ok){const Be=await Ae.json().catch(()=>({}));throw new Error(Be.message||`AI lab order creation failed: ${Ae.statusText}`)}await Ae.json(),z("Success: Lab order created!"),n&&M(n)}catch(Q){await Je(se.action,Q,Me,ve)}finally{B(!1)}})())):se.action==="edit_pharmacy_order"?(Ee=!0,_t.push((async()=>{F(!0),$("Processing pharmacy order edit...");try{const Q=se.serialNumber;let ie;if(Q?ie=[...g].sort((ze,Ke)=>{const Fe=new Date(ze.date).getTime(),at=new Date(Ke.date).getTime();return Fe-at})[Q-1]:ie=g.sort((dt,ze)=>new Date(dt.date).getTime()-new Date(ze.date).getTime()).find(dt=>dt.status==="pending"),!ie)throw new Error(`Pharmacy order with serial number ${Q} not found, or no pending order to edit.`);const je=ie.id,Ae=se.items,Be=se.items_to_remove,st=se.status,pt=se.prescription_for_unavailable_drugs;if((!Ae||Array.isArray(Ae)&&Ae.length===0)&&!Be&&!st&&(!pt||pt.trim()===""))throw new Error("No items, items to remove, status, or unavailable drugs prescription provided for pharmacy order edit.");if(st==="cancelled")await _e({type:"Pharmacy Order",data:ie}),$("Success: Pharmacy order cancelled and deleted!");else{let dt=[...ie.medications];if(Array.isArray(Be)&&Be.length>0&&(dt=dt.filter(Qe=>{const yt=Qe.name.toLowerCase().replace(/\s+/g," ").trim();return!Be.some(Un=>{if(Un.drug_id&&String(Qe.drug_id)===String(Un.drug_id))return!0;if(Un.name){const On=Un.name.toLowerCase().replace(/\s+/g," ").trim();return yt===On}return!1})})),Array.isArray(Ae)&&Ae.length>0)for(const Qe of Ae){const{pack_price:yt,loose_price:Un,total_price:On,price:Cn,...mn}=Qe;let un;if(mn.drug_id?un=b.find(Fn=>Fn.id===String(mn.drug_id)):mn.name&&(un=$m(mn.name,b)),!un)throw new Error(`Drug "${mn.name||mn.drug_id||"Unknown"}" not found or no close match for update.`);let Ni;const Hi=mn.tabletsPerDay;if(Hi&&Number(Hi)>0){const Fn=Number(Hi);Number.isInteger(Fn)?Ni=Fn:Ni=null}else Ni=1;const ar=Number(mn.numberOfDays)||1,oa=Number(mn.pack_quantity)||0,kr=Number(mn.loose_quantity)||0,ni=dt.findIndex(Fn=>Fn.drug_id&&Fn.drug_id===(un==null?void 0:un.id)||Fn.name.toLowerCase()===(un==null?void 0:un.name.toLowerCase()));if(oa<=0&&kr<=0){ni!==-1&&dt.splice(ni,1);continue}const Kn={drug_id:un.id?String(un.id):null,name:un.name,pack_quantity:oa,loose_quantity:kr,tabletsPerDay:Ni,numberOfDays:ar,price:un.price,directions_to_use:mn.directions_to_use||void 0,box_number:mn.box_number||void 0,isLoose:mn.isLoose||void 0,unit:un.unit||void 0};ni!==-1?dt[ni]={...dt[ni],...Kn}:dt.push(Kn)}const ze=dt.map(Qe=>{const yt=b.find(Ni=>Ni.id===Qe.drug_id),Un=yt?aj(yt.unit):1,On=Number(yt==null?void 0:yt.price)||0,Cn=On,mn=Un>0?On/Un:0,un=(Qe.pack_quantity||0)*Cn+(Qe.loose_quantity||0)*mn;return{...Qe,pack_price:parseFloat(Cn.toFixed(2)),loose_price:parseFloat(mn.toFixed(2)),total_price:parseFloat(un.toFixed(2))}}),Ke=ze.reduce((Qe,yt)=>Qe+yt.total_price,0),Fe={};if(ze.length>0?Fe.items=ze.map(({drug_id:Qe,name:yt,pack_quantity:Un,loose_quantity:On,tabletsPerDay:Cn,numberOfDays:mn,directions_to_use:un,box_number:Ni,isLoose:Hi,unit:ar,pack_price:oa,loose_price:kr,total_price:ni})=>({drug_id:Qe,name:yt,pack_quantity:Un,loose_quantity:On,tabletsPerDay:Cn===null?null:Cn,numberOfDays:mn,directions_to_use:un,box_number:Ni,isLoose:Hi,unit:ar,pack_price:oa,loose_price:kr,total_price:ni})):Ae&&Ae.length>0&&(Fe.items=[]),pt!==void 0&&(Fe.prescription_for_unavailable_drugs=pt),Fe.order_total=parseFloat(Ke.toFixed(2)),st){if(!["pending","billed","dispensed","cancelled"].includes(st))throw new Error(`Invalid status for pharmacy order: ${st}.`);Fe.status=st}const at=await pe(`/api/pharmacy-orders/${je}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Fe)});if(!at.ok){const Qe=await at.json().catch(()=>({}));throw new Error(Qe.message||`AI pharmacy order edit failed: ${at.statusText}`)}$("Success: Pharmacy order updated!"),n&&ce(n)}}catch(Q){await Je(se.action,Q,Me,ve)}finally{F(!1)}})())):se.action==="edit_lab_order"?(Ee=!0,_t.push((async()=>{B(!0),z("Processing lab order edit...");try{const Q=u.sort((st,pt)=>new Date(pt.createdAt).getTime()-new Date(st.createdAt).getTime()).find(st=>st.status==="pending");if(!Q)throw new Error("No pending lab orders found to edit.");const ie=Q.id,je=se.tests,Ae=se.items_to_remove,Be=se.status;if(!je&&!Ae&&!Be)throw new Error("No tests, items to remove, or status provided for lab order edit.");if(Be==="cancelled"){if(Q.report)throw new Error("Cannot delete lab order with an associated report. Please delete the report first.");await _e({type:"Lab Order",data:Q}),z("Success: Lab order cancelled and deleted!")}else{let st=[...Q.tests];if(Array.isArray(Ae)&&Ae.length>0&&(st=st.filter(ze=>!Ae.some(Ke=>!!(Ke.id&&String(ze.id)===String(Ke.id)||Ke.name&&ze.name.toLowerCase()===Ke.name.toLowerCase())))),Array.isArray(je)&&je.length>0)for(const ze of je){let Ke;if(ze.id?Ke=v.find(yt=>String(yt.id)===String(ze.id)):ze.name&&(Ke=$m(ze.name,v)),!Ke)throw new Error(`Lab test "${ze.name||ze.id||"Unknown"}" not found or no close match for update.`);const Fe=typeof Ke.price=="string"?parseFloat(Ke.price):Ke.price,at=st.findIndex(yt=>yt.id&&String(yt.id)===String(Ke==null?void 0:Ke.id)||yt.name.toLowerCase()===(Ke==null?void 0:Ke.name.toLowerCase())),Qe={id:Ke.id,name:Ke.name,price:Fe};at!==-1?st[at]={...st[at],...Qe}:st.push(Qe)}const pt={};if(st.length>0?pt.tests=st:je&&je.length>0&&(pt.tests=[]),Be){if(!["pending","billed","collected","processing","report_ready","completed","cancelled","reported"].includes(Be))throw new Error(`Invalid status for lab order: ${Be}.`);pt.status=Be}const dt=await pe(`/api/lab/orders/${ie}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(pt)});if(!dt.ok){const ze=await dt.json().catch(()=>({}));throw new Error(ze.message||`AI lab order edit failed: ${dt.statusText}`)}z("Success: Lab order updated!"),n&&(M(n),de(n))}}catch(Q){await Je(se.action,Q,Me,ve)}finally{B(!1)}})())):se.action==="add_complaint_history"&&se.complaint?(Ee=!0,_t.push((async()=>{q(!0),O("Processing Hx...");try{if(!e)throw new Error("Missing Record ID for complaint history.");if(!se.complaint||typeof se.complaint!="string")throw new Error("Invalid AI complaint text.");const Q={complaint:se.complaint.trim()},ie=await pe(`/api/queue/doctor/complaint/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Q)});if(!ie.ok){const je=await ie.json().catch(()=>({}));throw new Error(je.message||`AI complaint add failed: ${ie.statusText}`)}N(Q.complaint),O("Hx updated!"),n&&Se(n)}catch(Q){await Je(se.action,Q,Me,ve)}finally{q(!1)}})())):se.action==="update_case_summary"&&se.summary?(Ee=!0,_t.push((async()=>{R(!0),G("Processing summary...");try{if(!e)throw new Error("Missing Record ID for case summary update.");if(typeof se.summary!="string")throw new Error("Invalid AI case summary text.");const Q={case_summary:se.summary.trim()},ie=await pe(`/api/queue/doctor/complaint/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Q)});if(!ie.ok){const Ae=await ie.json().catch(()=>({}));throw new Error(Ae.message||`AI case summary update failed: ${ie.statusText}`)}const je=await ie.json();ee(je.case_summary),te(je.updatedAt),G("Summary updated!")}catch(Q){await Je(se.action,Q,Me,ve)}finally{R(!1)}})())):se.action&&console.warn(`Unrecognized AI action: ${se.action}`)}if(await Promise.allSettled(_t),an)typeof an.question=="string"?(U(an.question),J(Array.isArray(an.options)?an.options:[])):console.warn("Invalid 'ask_followup_question' format.");else if(!Ee)throw new Error("AI response did not result in a recognized or performed function call.")}catch(Xe){await Je("parse_json_actions",Xe,Me,ve)}else throw new Error("AI response did not contain a recognized function call.")};et=async(Me,ve=0)=>{if(ve>1){V("AI call failed after multiple retries. Please try a different prompt."),P(!1);return}P(!0),V(null);let Ee;const nt=[...o,Me].join(`

`);try{const lt=new Map;(u??[]).forEach(ie=>{lt.set(ie.id,{...ie})}),(d??[]).forEach(ie=>{if(!lt.has(ie.id))lt.set(ie.id,{id:ie.id,patient_id:ie.patient_id,tests:ie.tests,status:ie.status,createdAt:ie.createdAt,report:ie});else{const je=lt.get(ie.id);je&&(je.report=ie,je.status=ie.status)}});const Xe=Array.from(lt.values());Xe.sort((ie,je)=>new Date(je.createdAt).getTime()-new Date(ie.createdAt).getTime());const Mt=Xe.map((ie,je)=>{let Ae=null;if(ie.report)try{const Be=typeof ie.report.report_content=="string"?ie.report.report_content:JSON.stringify(ie.report.report_content||{}),st=JSON.parse(Be||"{}"),pt=(ie.report.tests||[]).map(dt=>{const ze=st[dt.id]||{},Ke=Fe=>({name:Fe.name,value:ze[Fe.name]!==void 0?String(ze[Fe.name]):String(Fe.defaultValue),normal_range:Fe.normal_range||"N/A"});return{testId:dt.id,testName:dt.name,parameters:(dt.default_parameters||[]).map(Ke)}});Ae={reportId:ie.report.reportId,reportDate:ie.report.report_date,tests:pt}}catch{Ae={reportId:ie.report.reportId,reportDate:ie.report.report_date,reportContent:typeof ie.report.report_content=="string"?ie.report.report_content:JSON.stringify(ie.report.report_content),error:"Failed to parse report content JSON."}}return{serialNumber:Xe.length-je,orderId:ie.id,orderDate:isNaN(new Date(ie.createdAt).getTime())?ie.createdAt:new Date(ie.createdAt).toISOString(),tests:ie.tests.map(Be=>({id:Be.id,name:Be.name,price:Be.price})),status:ie.status,report:Ae}}),_t=h.map(ie=>{try{return{...ie,createdAt:isNaN(new Date(ie.createdAt).getTime())?ie.createdAt:new Date(ie.createdAt).toISOString()}}catch{return ie}}),se=[...g].sort((ie,je)=>{const Ae=new Date(ie.date).getTime(),Be=new Date(je.date).getTime();return Ae-Be}).map((ie,je)=>{try{return{serialNumber:je+1,...ie,date:ie.date&&!isNaN(new Date(ie.date).getTime())?new Date(ie.date).toISOString():ie.date}}catch{return{serialNumber:je+1,...ie}}}),Q={query:nt,currentDateTime:new Date().toISOString(),patientName:(t==null?void 0:t.name)||"",patientAge:(t==null?void 0:t.age)||void 0,patientGender:(t==null?void 0:t.gender)||void 0,case_summary:r||"",case_summary_last_updated:a?new Date(a).toISOString():void 0,clinic_ai_memory:(l==null?void 0:l.aiMemory)||"",clinic_ai_memory_last_updated:l!=null&&l.aiMemoryUpdatedAt?new Date(l.aiMemoryUpdatedAt).toISOString():void 0,clinic_wide_system_prompt:(l==null?void 0:l.clinicWideSystemPrompt)||"",labHistory:Mt,pharmacyOrders:se,pastComplaints:_t,pharmacyInventory:b,labInventory:v};if(console.log("DEBUG: Payload before sending to Gemini API:",JSON.stringify(Q,null,2)),Ee=await ZY(Q,f),Ee){k(Ee);const ie=/```json\s*([\s\S]*?)\s*```/,je=Ee.match(ie);if(je&&je[1])T(Ee.replace(ie,"").trim()),E(je[1].trim());else{const Ae=Ee.trim();if(Ae.startsWith("{")&&Ae.endsWith("}"))try{JSON.parse(Ae),T(""),E(Ae)}catch{T(Ae),E(null)}else if(Ae.startsWith("[")&&Ae.endsWith("]"))try{JSON.parse(Ae),T(""),E(Ae)}catch{T(Ae),E(null)}else T(Ae),E(null)}I(!1),n&&Ee&&await xe(n,Ee),await Le(Ee,ve),N("")}else throw new Error("Invalid AI response format.")}catch(lt){await Je("call_generative_api",lt,Ee,ve)}finally{P(!1)}};const xe=async(Me,ve)=>{A(!0),ae(null);try{const Ee={ai_response:ve},De=await pe(`/api/patients/${Me}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ee)});if(!De.ok){const nt=await De.json().catch(()=>({}));throw new Error(nt.message||`Failed to save AI response to patient: ${De.statusText}`)}}catch(Ee){ae(`AI Response Save Error: ${Ee.message}`)}finally{A(!1)}};return w.useImperativeHandle(qe,()=>({callGenerativeApi:et})),null}),tW={};function Dw(e,n){const t=tW,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return fE(e,r,a)}function fE(e,n,t){if(nW(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return sj(e.children,n,t)}return Array.isArray(e)?sj(e,n,t):""}function sj(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=fE(e[a],n,t);return r.join("")}function nW(e){return!!(e&&typeof e=="object")}const lj=document.createElement("i");function Pw(e){const n="&"+e+";";lj.innerHTML=n;const t=lj.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function Ll(e,n,t,r){const a=e.length;let l=0,o;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)o=Array.from(r),o.unshift(n,t),e.splice(...o);else for(t&&e.splice(n,t);l<r.length;)o=r.slice(l,l+1e4),o.unshift(n,0),e.splice(...o),l+=1e4,n+=1e4}function ns(e,n){return e.length>0?(Ll(e,e.length,0,n),e):n}const oj={}.hasOwnProperty;function iW(e){const n={};let t=-1;for(;++t<e.length;)rW(n,e[t]);return n}function rW(e,n){let t;for(t in n){const a=(oj.call(e,t)?e[t]:void 0)||(e[t]={}),l=n[t];let o;if(l)for(o in l){oj.call(a,o)||(a[o]=[]);const f=l[o];aW(a[o],Array.isArray(f)?f:f?[f]:[])}}}function aW(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);Ll(e,0,0,r)}function hE(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function Ch(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Pl=Kc(/[A-Za-z]/),Pa=Kc(/[\dA-Za-z]/),sW=Kc(/[#-'*+\--9=?A-Z^-~]/);function v1(e){return e!==null&&(e<32||e===127)}const w1=Kc(/\d/),lW=Kc(/[\dA-Fa-f]/),oW=Kc(/[!-/:-@[-`{-~]/);function It(e){return e!==null&&e<-2}function ia(e){return e!==null&&(e<0||e===32)}function Nn(e){return e===-2||e===-1||e===32}const cW=Kc(new RegExp("\\p{P}|\\p{S}","u")),uW=Kc(/\s/);function Kc(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function Bh(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const l=e.charCodeAt(t);let o="";if(l===37&&Pa(e.charCodeAt(t+1))&&Pa(e.charCodeAt(t+2)))a=2;else if(l<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(l))||(o=String.fromCharCode(l));else if(l>55295&&l<57344){const f=e.charCodeAt(t+1);l<56320&&f>56319&&f<57344?(o=String.fromCharCode(l,f),a=1):o=""}else o=String.fromCharCode(l);o&&(n.push(e.slice(r,t),encodeURIComponent(o)),r=t+a+1,o=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function Jn(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let l=0;return o;function o(u){return Nn(u)?(e.enter(t),f(u)):n(u)}function f(u){return Nn(u)&&l++<a?(e.consume(u),f):(e.exit(t),n(u))}}const dW={tokenize:fW};function fW(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(f){if(f===null){e.consume(f);return}return e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),Jn(e,n,"linePrefix")}function a(f){return e.enter("paragraph"),l(f)}function l(f){const u=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=u),t=u,o(f)}function o(f){if(f===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(f);return}return It(f)?(e.consume(f),e.exit("chunkText"),l):(e.consume(f),o)}}const hW={tokenize:pW},cj={tokenize:mW};function pW(e){const n=this,t=[];let r=0,a,l,o;return f;function f(P){if(r<t.length){const V=t[r];return n.containerState=V[1],e.attempt(V[0].continuation,u,d)(P)}return d(P)}function u(P){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&I();const V=n.events.length;let F=V,$;for(;F--;)if(n.events[F][0]==="exit"&&n.events[F][1].type==="chunkFlow"){$=n.events[F][1].end;break}E(r);let B=V;for(;B<n.events.length;)n.events[B][1].end={...$},B++;return Ll(n.events,F+1,0,n.events.slice(V)),n.events.length=B,d(P)}return f(P)}function d(P){if(r===t.length){if(!a)return b(P);if(a.currentConstruct&&a.currentConstruct.concrete)return N(P);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(cj,h,g)(P)}function h(P){return a&&I(),E(r),b(P)}function g(P){return n.parser.lazy[n.now().line]=r!==t.length,o=n.now().offset,N(P)}function b(P){return n.containerState={},e.attempt(cj,v,N)(P)}function v(P){return r++,t.push([n.currentConstruct,n.containerState]),b(P)}function N(P){if(P===null){a&&I(),E(0),e.consume(P);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:l}),k(P)}function k(P){if(P===null){T(e.exit("chunkFlow"),!0),E(0),e.consume(P);return}return It(P)?(e.consume(P),T(e.exit("chunkFlow")),r=0,n.interrupt=void 0,f):(e.consume(P),k)}function T(P,V){const F=n.sliceStream(P);if(V&&F.push(null),P.previous=l,l&&(l.next=P),l=P,a.defineSkip(P.start),a.write(F),n.parser.lazy[P.start.line]){let $=a.events.length;for(;$--;)if(a.events[$][1].start.offset<o&&(!a.events[$][1].end||a.events[$][1].end.offset>o))return;const B=n.events.length;let z=B,q,O;for(;z--;)if(n.events[z][0]==="exit"&&n.events[z][1].type==="chunkFlow"){if(q){O=n.events[z][1].end;break}q=!0}for(E(r),$=B;$<n.events.length;)n.events[$][1].end={...O},$++;Ll(n.events,z+1,0,n.events.slice(B)),n.events.length=$}}function E(P){let V=t.length;for(;V-- >P;){const F=t[V];n.containerState=F[1],F[0].exit.call(n,e)}t.length=P}function I(){a.write([null]),l=void 0,a=void 0,n.containerState._closeFlow=void 0}}function mW(e,n,t){return Jn(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function fb(e){if(e===null||ia(e)||uW(e))return 1;if(cW(e))return 2}function Iw(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const l=e[a].resolveAll;l&&!r.includes(l)&&(n=l(n,t),r.push(l))}return n}const S1={name:"attention",resolveAll:gW,tokenize:yW};function gW(e,n){let t=-1,r,a,l,o,f,u,d,h;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;u=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};uj(g,-u),uj(b,u),o={type:u>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},f={type:u>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},l={type:u>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:u>1?"strong":"emphasis",start:{...o.start},end:{...f.end}},e[r][1].end={...o.start},e[t][1].start={...f.end},d=[],e[r][1].end.offset-e[r][1].start.offset&&(d=ns(d,[["enter",e[r][1],n],["exit",e[r][1],n]])),d=ns(d,[["enter",a,n],["enter",o,n],["exit",o,n],["enter",l,n]]),d=ns(d,Iw(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),d=ns(d,[["exit",l,n],["enter",f,n],["exit",f,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(h=2,d=ns(d,[["enter",e[t][1],n],["exit",e[t][1],n]])):h=0,Ll(e,r-1,t-r+3,d),t=r+d.length-h-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function yW(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=fb(r);let l;return o;function o(u){return l=u,e.enter("attentionSequence"),f(u)}function f(u){if(u===l)return e.consume(u),f;const d=e.exit("attentionSequence"),h=fb(u),g=!h||h===2&&a||t.includes(u),b=!a||a===2&&h||t.includes(r);return d._open=!!(l===42?g:g&&(a||!b)),d._close=!!(l===42?b:b&&(h||!g)),n(u)}}function uj(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const xW={name:"autolink",tokenize:bW};function bW(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),l}function l(v){return Pl(v)?(e.consume(v),o):v===64?t(v):d(v)}function o(v){return v===43||v===45||v===46||Pa(v)?(r=1,f(v)):d(v)}function f(v){return v===58?(e.consume(v),r=0,u):(v===43||v===45||v===46||Pa(v))&&r++<32?(e.consume(v),f):(r=0,d(v))}function u(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||v1(v)?t(v):(e.consume(v),u)}function d(v){return v===64?(e.consume(v),h):sW(v)?(e.consume(v),d):t(v)}function h(v){return Pa(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,h):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||Pa(v))&&r++<63){const N=v===45?b:g;return e.consume(v),N}return t(v)}}const Fb={partial:!0,tokenize:vW};function vW(e,n,t){return r;function r(l){return Nn(l)?Jn(e,a,"linePrefix")(l):a(l)}function a(l){return l===null||It(l)?n(l):t(l)}}const pE={continuation:{tokenize:SW},exit:NW,name:"blockQuote",tokenize:wW};function wW(e,n,t){const r=this;return a;function a(o){if(o===62){const f=r.containerState;return f.open||(e.enter("blockQuote",{_container:!0}),f.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(o),e.exit("blockQuoteMarker"),l}return t(o)}function l(o){return Nn(o)?(e.enter("blockQuotePrefixWhitespace"),e.consume(o),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(o))}}function SW(e,n,t){const r=this;return a;function a(o){return Nn(o)?Jn(e,l,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):l(o)}function l(o){return e.attempt(pE,n,t)(o)}}function NW(e){e.exit("blockQuote")}const mE={name:"characterEscape",tokenize:CW};function CW(e,n,t){return r;function r(l){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(l),e.exit("escapeMarker"),a}function a(l){return oW(l)?(e.enter("characterEscapeValue"),e.consume(l),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(l)}}const gE={name:"characterReference",tokenize:jW};function jW(e,n,t){const r=this;let a=0,l,o;return f;function f(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),u}function u(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),d):(e.enter("characterReferenceValue"),l=31,o=Pa,h(g))}function d(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),l=6,o=lW,h):(e.enter("characterReferenceValue"),l=7,o=w1,h(g))}function h(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return o===Pa&&!Pw(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return o(g)&&a++<l?(e.consume(g),h):t(g)}}const dj={partial:!0,tokenize:kW},fj={concrete:!0,name:"codeFenced",tokenize:_W};function _W(e,n,t){const r=this,a={partial:!0,tokenize:F};let l=0,o=0,f;return u;function u($){return d($)}function d($){const B=r.events[r.events.length-1];return l=B&&B[1].type==="linePrefix"?B[2].sliceSerialize(B[1],!0).length:0,f=$,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),h($)}function h($){return $===f?(o++,e.consume($),h):o<3?t($):(e.exit("codeFencedFenceSequence"),Nn($)?Jn(e,g,"whitespace")($):g($))}function g($){return $===null||It($)?(e.exit("codeFencedFence"),r.interrupt?n($):e.check(dj,k,V)($)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b($))}function b($){return $===null||It($)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g($)):Nn($)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Jn(e,v,"whitespace")($)):$===96&&$===f?t($):(e.consume($),b)}function v($){return $===null||It($)?g($):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),N($))}function N($){return $===null||It($)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g($)):$===96&&$===f?t($):(e.consume($),N)}function k($){return e.attempt(a,V,T)($)}function T($){return e.enter("lineEnding"),e.consume($),e.exit("lineEnding"),E}function E($){return l>0&&Nn($)?Jn(e,I,"linePrefix",l+1)($):I($)}function I($){return $===null||It($)?e.check(dj,k,V)($):(e.enter("codeFlowValue"),P($))}function P($){return $===null||It($)?(e.exit("codeFlowValue"),I($)):(e.consume($),P)}function V($){return e.exit("codeFenced"),n($)}function F($,B,z){let q=0;return O;function O(le){return $.enter("lineEnding"),$.consume(le),$.exit("lineEnding"),R}function R(le){return $.enter("codeFencedFence"),Nn(le)?Jn($,G,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(le):G(le)}function G(le){return le===f?($.enter("codeFencedFenceSequence"),ee(le)):z(le)}function ee(le){return le===f?(q++,$.consume(le),ee):q>=o?($.exit("codeFencedFenceSequence"),Nn(le)?Jn($,te,"whitespace")(le):te(le)):z(le)}function te(le){return le===null||It(le)?($.exit("codeFencedFence"),B(le)):z(le)}}}function kW(e,n,t){const r=this;return a;function a(o){return o===null?t(o):(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),l)}function l(o){return r.parser.lazy[r.now().line]?t(o):n(o)}}const Nv={name:"codeIndented",tokenize:TW},EW={partial:!0,tokenize:AW};function TW(e,n,t){const r=this;return a;function a(d){return e.enter("codeIndented"),Jn(e,l,"linePrefix",5)(d)}function l(d){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?o(d):t(d)}function o(d){return d===null?u(d):It(d)?e.attempt(EW,o,u)(d):(e.enter("codeFlowValue"),f(d))}function f(d){return d===null||It(d)?(e.exit("codeFlowValue"),o(d)):(e.consume(d),f)}function u(d){return e.exit("codeIndented"),n(d)}}function AW(e,n,t){const r=this;return a;function a(o){return r.parser.lazy[r.now().line]?t(o):It(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a):Jn(e,l,"linePrefix",5)(o)}function l(o){const f=r.events[r.events.length-1];return f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?n(o):It(o)?a(o):t(o)}}const DW={name:"codeText",previous:IW,resolve:PW,tokenize:MW};function PW(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function IW(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function MW(e,n,t){let r=0,a,l;return o;function o(g){return e.enter("codeText"),e.enter("codeTextSequence"),f(g)}function f(g){return g===96?(e.consume(g),r++,f):(e.exit("codeTextSequence"),u(g))}function u(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),u):g===96?(l=e.enter("codeTextSequence"),a=0,h(g)):It(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),u):(e.enter("codeTextData"),d(g))}function d(g){return g===null||g===32||g===96||It(g)?(e.exit("codeTextData"),u(g)):(e.consume(g),d)}function h(g){return g===96?(e.consume(g),a++,h):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(l.type="codeTextData",d(g))}}class RW{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const l=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&Im(this.left,r),l.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Im(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Im(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Im(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Im(this.left,t.reverse())}}}function Im(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function yE(e){const n={};let t=-1,r,a,l,o,f,u,d;const h=new RW(e);for(;++t<h.length;){for(;t in n;)t=n[t];if(r=h.get(t),t&&r[1].type==="chunkFlow"&&h.get(t-1)[1].type==="listItemPrefix"&&(u=r[1]._tokenizer.events,l=0,l<u.length&&u[l][1].type==="lineEndingBlank"&&(l+=2),l<u.length&&u[l][1].type==="content"))for(;++l<u.length&&u[l][1].type!=="content";)u[l][1].type==="chunkText"&&(u[l][1]._isInFirstContentOfListItem=!0,l++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,LW(h,t)),t=n[t],d=!0);else if(r[1]._container){for(l=t,a=void 0;l--;)if(o=h.get(l),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(a&&(h.get(a)[1].type="lineEndingBlank"),o[1].type="lineEnding",a=l);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;a&&(r[1].end={...h.get(a)[1].start},f=h.slice(a,t),f.unshift(r),h.splice(a,t-a+1,f))}}return Ll(e,0,Number.POSITIVE_INFINITY,h.slice(0)),!d}function LW(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const l=[];let o=t._tokenizer;o||(o=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const f=o.events,u=[],d={};let h,g,b=-1,v=t,N=0,k=0;const T=[k];for(;v;){for(;e.get(++a)[1]!==v;);l.push(a),v._tokenizer||(h=r.sliceStream(v),v.next||h.push(null),g&&o.defineSkip(v.start),v._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(h),v._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<f.length;)f[b][0]==="exit"&&f[b-1][0]==="enter"&&f[b][1].type===f[b-1][1].type&&f[b][1].start.line!==f[b][1].end.line&&(k=b+1,T.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(o.events=[],v?(v._tokenizer=void 0,v.previous=void 0):T.pop(),b=T.length;b--;){const E=f.slice(T[b],T[b+1]),I=l.pop();u.push([I,I+E.length-1]),e.splice(I,2,E)}for(u.reverse(),b=-1;++b<u.length;)d[N+u[b][0]]=N+u[b][1],N+=u[b][1]-u[b][0]-1;return d}const OW={resolve:$W,tokenize:zW},FW={partial:!0,tokenize:BW};function $W(e){return yE(e),e}function zW(e,n){let t;return r;function r(f){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(f)}function a(f){return f===null?l(f):It(f)?e.check(FW,o,l)(f):(e.consume(f),a)}function l(f){return e.exit("chunkContent"),e.exit("content"),n(f)}function o(f){return e.consume(f),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function BW(e,n,t){const r=this;return a;function a(o){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),Jn(e,l,"linePrefix")}function l(o){if(o===null||It(o))return t(o);const f=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?n(o):e.interrupt(r.parser.constructs.flow,t,n)(o)}}function xE(e,n,t,r,a,l,o,f,u){const d=u||Number.POSITIVE_INFINITY;let h=0;return g;function g(E){return E===60?(e.enter(r),e.enter(a),e.enter(l),e.consume(E),e.exit(l),b):E===null||E===32||E===41||v1(E)?t(E):(e.enter(r),e.enter(o),e.enter(f),e.enter("chunkString",{contentType:"string"}),k(E))}function b(E){return E===62?(e.enter(l),e.consume(E),e.exit(l),e.exit(a),e.exit(r),n):(e.enter(f),e.enter("chunkString",{contentType:"string"}),v(E))}function v(E){return E===62?(e.exit("chunkString"),e.exit(f),b(E)):E===null||E===60||It(E)?t(E):(e.consume(E),E===92?N:v)}function N(E){return E===60||E===62||E===92?(e.consume(E),v):v(E)}function k(E){return!h&&(E===null||E===41||ia(E))?(e.exit("chunkString"),e.exit(f),e.exit(o),e.exit(r),n(E)):h<d&&E===40?(e.consume(E),h++,k):E===41?(e.consume(E),h--,k):E===null||E===32||E===40||v1(E)?t(E):(e.consume(E),E===92?T:k)}function T(E){return E===40||E===41||E===92?(e.consume(E),k):k(E)}}function bE(e,n,t,r,a,l){const o=this;let f=0,u;return d;function d(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(l),h}function h(v){return f>999||v===null||v===91||v===93&&!u||v===94&&!f&&"_hiddenFootnoteSupport"in o.parser.constructs?t(v):v===93?(e.exit(l),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):It(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),h):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||It(v)||f++>999?(e.exit("chunkString"),h(v)):(e.consume(v),u||(u=!Nn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),f++,g):g(v)}}function vE(e,n,t,r,a,l){let o;return f;function f(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),o=b===40?41:b,u):t(b)}function u(b){return b===o?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(l),d(b))}function d(b){return b===o?(e.exit(l),u(o)):b===null?t(b):It(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),Jn(e,d,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),h(b))}function h(b){return b===o||b===null||It(b)?(e.exit("chunkString"),d(b)):(e.consume(b),b===92?g:h)}function g(b){return b===o||b===92?(e.consume(b),h):h(b)}}function qm(e,n){let t;return r;function r(a){return It(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):Nn(a)?Jn(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const UW={name:"definition",tokenize:VW},qW={partial:!0,tokenize:HW};function VW(e,n,t){const r=this;let a;return l;function l(v){return e.enter("definition"),o(v)}function o(v){return bE.call(r,e,f,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function f(v){return a=Ch(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),u):t(v)}function u(v){return ia(v)?qm(e,d)(v):d(v)}function d(v){return xE(e,h,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function h(v){return e.attempt(qW,g,g)(v)}function g(v){return Nn(v)?Jn(e,b,"whitespace")(v):b(v)}function b(v){return v===null||It(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function HW(e,n,t){return r;function r(f){return ia(f)?qm(e,a)(f):t(f)}function a(f){return vE(e,l,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(f)}function l(f){return Nn(f)?Jn(e,o,"whitespace")(f):o(f)}function o(f){return f===null||It(f)?n(f):t(f)}}const GW={name:"hardBreakEscape",tokenize:YW};function YW(e,n,t){return r;function r(l){return e.enter("hardBreakEscape"),e.consume(l),a}function a(l){return It(l)?(e.exit("hardBreakEscape"),n(l)):t(l)}}const WW={name:"headingAtx",resolve:QW,tokenize:JW};function QW(e,n){let t=e.length-2,r=3,a,l;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},l={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},Ll(e,r,t-r+1,[["enter",a,n],["enter",l,n],["exit",l,n],["exit",a,n]])),e}function JW(e,n,t){let r=0;return a;function a(h){return e.enter("atxHeading"),l(h)}function l(h){return e.enter("atxHeadingSequence"),o(h)}function o(h){return h===35&&r++<6?(e.consume(h),o):h===null||ia(h)?(e.exit("atxHeadingSequence"),f(h)):t(h)}function f(h){return h===35?(e.enter("atxHeadingSequence"),u(h)):h===null||It(h)?(e.exit("atxHeading"),n(h)):Nn(h)?Jn(e,f,"whitespace")(h):(e.enter("atxHeadingText"),d(h))}function u(h){return h===35?(e.consume(h),u):(e.exit("atxHeadingSequence"),f(h))}function d(h){return h===null||h===35||ia(h)?(e.exit("atxHeadingText"),f(h)):(e.consume(h),d)}}const KW=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],hj=["pre","script","style","textarea"],XW={concrete:!0,name:"htmlFlow",resolveTo:tQ,tokenize:nQ},ZW={partial:!0,tokenize:rQ},eQ={partial:!0,tokenize:iQ};function tQ(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function nQ(e,n,t){const r=this;let a,l,o,f,u;return d;function d(M){return h(M)}function h(M){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(M),g}function g(M){return M===33?(e.consume(M),b):M===47?(e.consume(M),l=!0,k):M===63?(e.consume(M),a=3,r.interrupt?n:A):Pl(M)?(e.consume(M),o=String.fromCharCode(M),T):t(M)}function b(M){return M===45?(e.consume(M),a=2,v):M===91?(e.consume(M),a=5,f=0,N):Pl(M)?(e.consume(M),a=4,r.interrupt?n:A):t(M)}function v(M){return M===45?(e.consume(M),r.interrupt?n:A):t(M)}function N(M){const de="CDATA[";return M===de.charCodeAt(f++)?(e.consume(M),f===de.length?r.interrupt?n:G:N):t(M)}function k(M){return Pl(M)?(e.consume(M),o=String.fromCharCode(M),T):t(M)}function T(M){if(M===null||M===47||M===62||ia(M)){const de=M===47,Se=o.toLowerCase();return!de&&!l&&hj.includes(Se)?(a=1,r.interrupt?n(M):G(M)):KW.includes(o.toLowerCase())?(a=6,de?(e.consume(M),E):r.interrupt?n(M):G(M)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(M):l?I(M):P(M))}return M===45||Pa(M)?(e.consume(M),o+=String.fromCharCode(M),T):t(M)}function E(M){return M===62?(e.consume(M),r.interrupt?n:G):t(M)}function I(M){return Nn(M)?(e.consume(M),I):O(M)}function P(M){return M===47?(e.consume(M),O):M===58||M===95||Pl(M)?(e.consume(M),V):Nn(M)?(e.consume(M),P):O(M)}function V(M){return M===45||M===46||M===58||M===95||Pa(M)?(e.consume(M),V):F(M)}function F(M){return M===61?(e.consume(M),$):Nn(M)?(e.consume(M),F):P(M)}function $(M){return M===null||M===60||M===61||M===62||M===96?t(M):M===34||M===39?(e.consume(M),u=M,B):Nn(M)?(e.consume(M),$):z(M)}function B(M){return M===u?(e.consume(M),u=null,q):M===null||It(M)?t(M):(e.consume(M),B)}function z(M){return M===null||M===34||M===39||M===47||M===60||M===61||M===62||M===96||ia(M)?F(M):(e.consume(M),z)}function q(M){return M===47||M===62||Nn(M)?P(M):t(M)}function O(M){return M===62?(e.consume(M),R):t(M)}function R(M){return M===null||It(M)?G(M):Nn(M)?(e.consume(M),R):t(M)}function G(M){return M===45&&a===2?(e.consume(M),K):M===60&&a===1?(e.consume(M),U):M===62&&a===4?(e.consume(M),ae):M===63&&a===3?(e.consume(M),A):M===93&&a===5?(e.consume(M),ne):It(M)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(ZW,ce,ee)(M)):M===null||It(M)?(e.exit("htmlFlowData"),ee(M)):(e.consume(M),G)}function ee(M){return e.check(eQ,te,ce)(M)}function te(M){return e.enter("lineEnding"),e.consume(M),e.exit("lineEnding"),le}function le(M){return M===null||It(M)?ee(M):(e.enter("htmlFlowData"),G(M))}function K(M){return M===45?(e.consume(M),A):G(M)}function U(M){return M===47?(e.consume(M),o="",J):G(M)}function J(M){if(M===62){const de=o.toLowerCase();return hj.includes(de)?(e.consume(M),ae):G(M)}return Pl(M)&&o.length<8?(e.consume(M),o+=String.fromCharCode(M),J):G(M)}function ne(M){return M===93?(e.consume(M),A):G(M)}function A(M){return M===62?(e.consume(M),ae):M===45&&a===2?(e.consume(M),A):G(M)}function ae(M){return M===null||It(M)?(e.exit("htmlFlowData"),ce(M)):(e.consume(M),ae)}function ce(M){return e.exit("htmlFlow"),n(M)}}function iQ(e,n,t){const r=this;return a;function a(o){return It(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),l):t(o)}function l(o){return r.parser.lazy[r.now().line]?t(o):n(o)}}function rQ(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(Fb,n,t)}}const aQ={name:"htmlText",tokenize:sQ};function sQ(e,n,t){const r=this;let a,l,o;return f;function f(A){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(A),u}function u(A){return A===33?(e.consume(A),d):A===47?(e.consume(A),F):A===63?(e.consume(A),P):Pl(A)?(e.consume(A),z):t(A)}function d(A){return A===45?(e.consume(A),h):A===91?(e.consume(A),l=0,N):Pl(A)?(e.consume(A),I):t(A)}function h(A){return A===45?(e.consume(A),v):t(A)}function g(A){return A===null?t(A):A===45?(e.consume(A),b):It(A)?(o=g,U(A)):(e.consume(A),g)}function b(A){return A===45?(e.consume(A),v):g(A)}function v(A){return A===62?K(A):A===45?b(A):g(A)}function N(A){const ae="CDATA[";return A===ae.charCodeAt(l++)?(e.consume(A),l===ae.length?k:N):t(A)}function k(A){return A===null?t(A):A===93?(e.consume(A),T):It(A)?(o=k,U(A)):(e.consume(A),k)}function T(A){return A===93?(e.consume(A),E):k(A)}function E(A){return A===62?K(A):A===93?(e.consume(A),E):k(A)}function I(A){return A===null||A===62?K(A):It(A)?(o=I,U(A)):(e.consume(A),I)}function P(A){return A===null?t(A):A===63?(e.consume(A),V):It(A)?(o=P,U(A)):(e.consume(A),P)}function V(A){return A===62?K(A):P(A)}function F(A){return Pl(A)?(e.consume(A),$):t(A)}function $(A){return A===45||Pa(A)?(e.consume(A),$):B(A)}function B(A){return It(A)?(o=B,U(A)):Nn(A)?(e.consume(A),B):K(A)}function z(A){return A===45||Pa(A)?(e.consume(A),z):A===47||A===62||ia(A)?q(A):t(A)}function q(A){return A===47?(e.consume(A),K):A===58||A===95||Pl(A)?(e.consume(A),O):It(A)?(o=q,U(A)):Nn(A)?(e.consume(A),q):K(A)}function O(A){return A===45||A===46||A===58||A===95||Pa(A)?(e.consume(A),O):R(A)}function R(A){return A===61?(e.consume(A),G):It(A)?(o=R,U(A)):Nn(A)?(e.consume(A),R):q(A)}function G(A){return A===null||A===60||A===61||A===62||A===96?t(A):A===34||A===39?(e.consume(A),a=A,ee):It(A)?(o=G,U(A)):Nn(A)?(e.consume(A),G):(e.consume(A),te)}function ee(A){return A===a?(e.consume(A),a=void 0,le):A===null?t(A):It(A)?(o=ee,U(A)):(e.consume(A),ee)}function te(A){return A===null||A===34||A===39||A===60||A===61||A===96?t(A):A===47||A===62||ia(A)?q(A):(e.consume(A),te)}function le(A){return A===47||A===62||ia(A)?q(A):t(A)}function K(A){return A===62?(e.consume(A),e.exit("htmlTextData"),e.exit("htmlText"),n):t(A)}function U(A){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(A),e.exit("lineEnding"),J}function J(A){return Nn(A)?Jn(e,ne,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(A):ne(A)}function ne(A){return e.enter("htmlTextData"),o(A)}}const Mw={name:"labelEnd",resolveAll:uQ,resolveTo:dQ,tokenize:fQ},lQ={tokenize:hQ},oQ={tokenize:pQ},cQ={tokenize:mQ};function uQ(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&Ll(e,0,e.length,t),e}function dQ(e,n){let t=e.length,r=0,a,l,o,f;for(;t--;)if(a=e[t][1],l){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(o){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(l=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(o=t);const u={type:e[l][1].type==="labelLink"?"link":"image",start:{...e[l][1].start},end:{...e[e.length-1][1].end}},d={type:"label",start:{...e[l][1].start},end:{...e[o][1].end}},h={type:"labelText",start:{...e[l+r+2][1].end},end:{...e[o-2][1].start}};return f=[["enter",u,n],["enter",d,n]],f=ns(f,e.slice(l+1,l+r+3)),f=ns(f,[["enter",h,n]]),f=ns(f,Iw(n.parser.constructs.insideSpan.null,e.slice(l+r+4,o-3),n)),f=ns(f,[["exit",h,n],e[o-2],e[o-1],["exit",d,n]]),f=ns(f,e.slice(o+1)),f=ns(f,[["exit",u,n]]),Ll(e,l,e.length,f),e}function fQ(e,n,t){const r=this;let a=r.events.length,l,o;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){l=r.events[a][1];break}return f;function f(b){return l?l._inactive?g(b):(o=r.parser.defined.includes(Ch(r.sliceSerialize({start:l.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),u):t(b)}function u(b){return b===40?e.attempt(lQ,h,o?h:g)(b):b===91?e.attempt(oQ,h,o?d:g)(b):o?h(b):g(b)}function d(b){return e.attempt(cQ,h,g)(b)}function h(b){return n(b)}function g(b){return l._balanced=!0,t(b)}}function hQ(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return ia(g)?qm(e,l)(g):l(g)}function l(g){return g===41?h(g):xE(e,o,f,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function o(g){return ia(g)?qm(e,u)(g):h(g)}function f(g){return t(g)}function u(g){return g===34||g===39||g===40?vE(e,d,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):h(g)}function d(g){return ia(g)?qm(e,h)(g):h(g)}function h(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function pQ(e,n,t){const r=this;return a;function a(f){return bE.call(r,e,l,o,"reference","referenceMarker","referenceString")(f)}function l(f){return r.parser.defined.includes(Ch(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(f):t(f)}function o(f){return t(f)}}function mQ(e,n,t){return r;function r(l){return e.enter("reference"),e.enter("referenceMarker"),e.consume(l),e.exit("referenceMarker"),a}function a(l){return l===93?(e.enter("referenceMarker"),e.consume(l),e.exit("referenceMarker"),e.exit("reference"),n):t(l)}}const gQ={name:"labelStartImage",resolveAll:Mw.resolveAll,tokenize:yQ};function yQ(e,n,t){const r=this;return a;function a(f){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(f),e.exit("labelImageMarker"),l}function l(f){return f===91?(e.enter("labelMarker"),e.consume(f),e.exit("labelMarker"),e.exit("labelImage"),o):t(f)}function o(f){return f===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(f):n(f)}}const xQ={name:"labelStartLink",resolveAll:Mw.resolveAll,tokenize:bQ};function bQ(e,n,t){const r=this;return a;function a(o){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelLink"),l}function l(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(o):n(o)}}const Cv={name:"lineEnding",tokenize:vQ};function vQ(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),Jn(e,n,"linePrefix")}}const Bx={name:"thematicBreak",tokenize:wQ};function wQ(e,n,t){let r=0,a;return l;function l(d){return e.enter("thematicBreak"),o(d)}function o(d){return a=d,f(d)}function f(d){return d===a?(e.enter("thematicBreakSequence"),u(d)):r>=3&&(d===null||It(d))?(e.exit("thematicBreak"),n(d)):t(d)}function u(d){return d===a?(e.consume(d),r++,u):(e.exit("thematicBreakSequence"),Nn(d)?Jn(e,f,"whitespace")(d):f(d))}}const ta={continuation:{tokenize:jQ},exit:kQ,name:"list",tokenize:CQ},SQ={partial:!0,tokenize:EQ},NQ={partial:!0,tokenize:_Q};function CQ(e,n,t){const r=this,a=r.events[r.events.length-1];let l=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,o=0;return f;function f(v){const N=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(N==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:w1(v)){if(r.containerState.type||(r.containerState.type=N,e.enter(N,{_container:!0})),N==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(Bx,t,d)(v):d(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),u(v)}return t(v)}function u(v){return w1(v)&&++o<10?(e.consume(v),u):(!r.interrupt||o<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),d(v)):t(v)}function d(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(Fb,r.interrupt?t:h,e.attempt(SQ,b,g))}function h(v){return r.containerState.initialBlankLine=!0,l++,b(v)}function g(v){return Nn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=l+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function jQ(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(Fb,a,l);function a(f){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,Jn(e,n,"listItemIndent",r.containerState.size+1)(f)}function l(f){return r.containerState.furtherBlankLines||!Nn(f)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(f)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(NQ,n,o)(f))}function o(f){return r.containerState._closeFlow=!0,r.interrupt=void 0,Jn(e,e.attempt(ta,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(f)}}function _Q(e,n,t){const r=this;return Jn(e,a,"listItemIndent",r.containerState.size+1);function a(l){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?n(l):t(l)}}function kQ(e){e.exit(this.containerState.type)}function EQ(e,n,t){const r=this;return Jn(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(l){const o=r.events[r.events.length-1];return!Nn(l)&&o&&o[1].type==="listItemPrefixWhitespace"?n(l):t(l)}}const pj={name:"setextUnderline",resolveTo:TQ,tokenize:AQ};function TQ(e,n){let t=e.length,r,a,l;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!l&&e[t][1].type==="definition"&&(l=t);const o={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",l?(e.splice(a,0,["enter",o,n]),e.splice(l+1,0,["exit",e[r][1],n]),e[r][1].end={...e[l][1].end}):e[r][1]=o,e.push(["exit",o,n]),e}function AQ(e,n,t){const r=this;let a;return l;function l(d){let h=r.events.length,g;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){g=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=d,o(d)):t(d)}function o(d){return e.enter("setextHeadingLineSequence"),f(d)}function f(d){return d===a?(e.consume(d),f):(e.exit("setextHeadingLineSequence"),Nn(d)?Jn(e,u,"lineSuffix")(d):u(d))}function u(d){return d===null||It(d)?(e.exit("setextHeadingLine"),n(d)):t(d)}}const DQ={tokenize:PQ};function PQ(e){const n=this,t=e.attempt(Fb,r,e.attempt(this.parser.constructs.flowInitial,a,Jn(e,e.attempt(this.parser.constructs.flow,a,e.attempt(OW,a)),"linePrefix")));return t;function r(l){if(l===null){e.consume(l);return}return e.enter("lineEndingBlank"),e.consume(l),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(l){if(l===null){e.consume(l);return}return e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const IQ={resolveAll:SE()},MQ=wE("string"),RQ=wE("text");function wE(e){return{resolveAll:SE(e==="text"?LQ:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],l=t.attempt(a,o,f);return o;function o(h){return d(h)?l(h):f(h)}function f(h){if(h===null){t.consume(h);return}return t.enter("data"),t.consume(h),u}function u(h){return d(h)?(t.exit("data"),l(h)):(t.consume(h),u)}function d(h){if(h===null)return!0;const g=a[h];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function SE(e){return n;function n(t,r){let a=-1,l;for(;++a<=t.length;)l===void 0?t[a]&&t[a][1].type==="data"&&(l=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==l+2&&(t[l][1].end=t[a-1][1].end,t.splice(l+2,a-l-2),a=l+2),l=void 0);return e?e(t,r):t}}function LQ(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let l=a.length,o=-1,f=0,u;for(;l--;){const d=a[l];if(typeof d=="string"){for(o=d.length;d.charCodeAt(o-1)===32;)f++,o--;if(o)break;o=-1}else if(d===-2)u=!0,f++;else if(d!==-1){l++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(f=0),f){const d={type:t===e.length||u||f<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:l?o:r.start._bufferIndex+o,_index:r.start._index+l,line:r.end.line,column:r.end.column-f,offset:r.end.offset-f},end:{...r.end}};r.end={...d.start},r.start.offset===r.end.offset?Object.assign(r,d):(e.splice(t,0,["enter",d,n],["exit",d,n]),t+=2)}t++}return e}const OQ={42:ta,43:ta,45:ta,48:ta,49:ta,50:ta,51:ta,52:ta,53:ta,54:ta,55:ta,56:ta,57:ta,62:pE},FQ={91:UW},$Q={[-2]:Nv,[-1]:Nv,32:Nv},zQ={35:WW,42:Bx,45:[pj,Bx],60:XW,61:pj,95:Bx,96:fj,126:fj},BQ={38:gE,92:mE},UQ={[-5]:Cv,[-4]:Cv,[-3]:Cv,33:gQ,38:gE,42:S1,60:[xW,aQ],91:xQ,92:[GW,mE],93:Mw,95:S1,96:DW},qQ={null:[S1,IQ]},VQ={null:[42,95]},HQ={null:[]},GQ=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:VQ,contentInitial:FQ,disable:HQ,document:OQ,flow:zQ,flowInitial:$Q,insideSpan:qQ,string:BQ,text:UQ},Symbol.toStringTag,{value:"Module"}));function YQ(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},l=[];let o=[],f=[];const u={attempt:B(F),check:B($),consume:I,enter:P,exit:V,interrupt:B($,{interrupt:!0})},d={code:null,containerState:{},defineSkip:k,events:[],now:N,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let h=n.tokenize.call(d,u);return n.resolveAll&&l.push(n),d;function g(R){return o=ns(o,R),T(),o[o.length-1]!==null?[]:(z(n,0),d.events=Iw(l,d.events,d),d.events)}function b(R,G){return QQ(v(R),G)}function v(R){return WQ(o,R)}function N(){const{_bufferIndex:R,_index:G,line:ee,column:te,offset:le}=r;return{_bufferIndex:R,_index:G,line:ee,column:te,offset:le}}function k(R){a[R.line]=R.column,O()}function T(){let R;for(;r._index<o.length;){const G=o[r._index];if(typeof G=="string")for(R=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===R&&r._bufferIndex<G.length;)E(G.charCodeAt(r._bufferIndex));else E(G)}}function E(R){h=h(R)}function I(R){It(R)?(r.line++,r.column=1,r.offset+=R===-3?2:1,O()):R!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),d.previous=R}function P(R,G){const ee=G||{};return ee.type=R,ee.start=N(),d.events.push(["enter",ee,d]),f.push(ee),ee}function V(R){const G=f.pop();return G.end=N(),d.events.push(["exit",G,d]),G}function F(R,G){z(R,G.from)}function $(R,G){G.restore()}function B(R,G){return ee;function ee(te,le,K){let U,J,ne,A;return Array.isArray(te)?ce(te):"tokenize"in te?ce([te]):ae(te);function ae(fe){return we;function we(re){const _e=re!==null&&fe[re],qe=re!==null&&fe.null,et=[...Array.isArray(_e)?_e:_e?[_e]:[],...Array.isArray(qe)?qe:qe?[qe]:[]];return ce(et)(re)}}function ce(fe){return U=fe,J=0,fe.length===0?K:M(fe[J])}function M(fe){return we;function we(re){return A=q(),ne=fe,fe.partial||(d.currentConstruct=fe),fe.name&&d.parser.constructs.disable.null.includes(fe.name)?Se():fe.tokenize.call(G?Object.assign(Object.create(d),G):d,u,de,Se)(re)}}function de(fe){return R(ne,A),le}function Se(fe){return A.restore(),++J<U.length?M(U[J]):K}}}function z(R,G){R.resolveAll&&!l.includes(R)&&l.push(R),R.resolve&&Ll(d.events,G,d.events.length-G,R.resolve(d.events.slice(G),d)),R.resolveTo&&(d.events=R.resolveTo(d.events,d))}function q(){const R=N(),G=d.previous,ee=d.currentConstruct,te=d.events.length,le=Array.from(f);return{from:te,restore:K};function K(){r=R,d.previous=G,d.currentConstruct=ee,d.events.length=te,f=le,O()}}function O(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function WQ(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,l=n.end._bufferIndex;let o;if(t===a)o=[e[t].slice(r,l)];else{if(o=e.slice(t,a),r>-1){const f=o[0];typeof f=="string"?o[0]=f.slice(r):o.shift()}l>0&&o.push(e[a].slice(0,l))}return o}function QQ(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const l=e[t];let o;if(typeof l=="string")o=l;else switch(l){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=n?" ":"	";break}case-1:{if(!n&&a)continue;o=" ";break}default:o=String.fromCharCode(l)}a=l===-2,r.push(o)}return r.join("")}function JQ(e){const r={constructs:iW([GQ,...(e||{}).extensions||[]]),content:a(dW),defined:[],document:a(hW),flow:a(DQ),lazy:{},string:a(MQ),text:a(RQ)};return r;function a(l){return o;function o(f){return YQ(r,l,f)}}}function KQ(e){for(;!yE(e););return e}const mj=/[\0\t\n\r]/g;function XQ(){let e=1,n="",t=!0,r;return a;function a(l,o,f){const u=[];let d,h,g,b,v;for(l=n+(typeof l=="string"?l.toString():new TextDecoder(o||void 0).decode(l)),g=0,n="",t&&(l.charCodeAt(0)===65279&&g++,t=void 0);g<l.length;){if(mj.lastIndex=g,d=mj.exec(l),b=d&&d.index!==void 0?d.index:l.length,v=l.charCodeAt(b),!d){n=l.slice(g);break}if(v===10&&g===b&&r)u.push(-3),r=void 0;else switch(r&&(u.push(-5),r=void 0),g<b&&(u.push(l.slice(g,b)),e+=b-g),v){case 0:{u.push(65533),e++;break}case 9:{for(h=Math.ceil(e/4)*4,u.push(-2);e++<h;)u.push(-1);break}case 10:{u.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return f&&(r&&u.push(-5),n&&u.push(n),u.push(null)),u}}const ZQ=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function NE(e){return e.replace(ZQ,eJ)}function eJ(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),l=a===120||a===88;return hE(t.slice(l?2:1),l?16:10)}return Pw(t)||e}function Vm(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?gj(e.position):"start"in e||"end"in e?gj(e):"line"in e||"column"in e?N1(e):""}function N1(e){return yj(e&&e.line)+":"+yj(e&&e.column)}function gj(e){return N1(e&&e.start)+"-"+N1(e&&e.end)}function yj(e){return e&&typeof e=="number"?e:1}const CE={}.hasOwnProperty;function tJ(e,n,t){return typeof n!="string"&&(t=n,n=void 0),nJ(t)(KQ(JQ(t).document().write(XQ()(e,n,!0))))}function nJ(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:l(nt),autolinkProtocol:q,autolinkEmail:q,atxHeading:l(Me),blockQuote:l(qe),characterEscape:q,characterReference:q,codeFenced:l(et),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:l(et,o),codeText:l(Je,o),codeTextData:q,data:q,codeFlowValue:q,definition:l(Le),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:l(xe),hardBreakEscape:l(ve),hardBreakTrailing:l(ve),htmlFlow:l(Ee,o),htmlFlowData:q,htmlText:l(Ee,o),htmlTextData:q,image:l(De),label:o,link:l(nt),listItem:l(Xe),listItemValue:b,listOrdered:l(lt,g),listUnordered:l(lt),paragraph:l(Mt),reference:M,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:l(Me),strong:l(_t),thematicBreak:l(se)},exit:{atxHeading:u(),atxHeadingSequence:F,autolink:u(),autolinkEmail:_e,autolinkProtocol:re,blockQuote:u(),characterEscapeValue:O,characterReferenceMarkerHexadecimal:Se,characterReferenceMarkerNumeric:Se,characterReferenceValue:fe,characterReference:we,codeFenced:u(T),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:N,codeFlowValue:O,codeIndented:u(E),codeText:u(le),codeTextData:O,data:O,definition:u(),definitionDestinationString:V,definitionLabelString:I,definitionTitleString:P,emphasis:u(),hardBreakEscape:u(G),hardBreakTrailing:u(G),htmlFlow:u(ee),htmlFlowData:O,htmlText:u(te),htmlTextData:O,image:u(U),label:ne,labelText:J,lineEnding:R,link:u(K),listItem:u(),listOrdered:u(),listUnordered:u(),paragraph:u(),referenceString:de,resourceDestinationString:A,resourceTitleString:ae,resource:ce,setextHeading:u(z),setextHeadingLineSequence:B,setextHeadingText:$,strong:u(),thematicBreak:u()}};jE(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(Q){let ie={type:"root",children:[]};const je={stack:[ie],tokenStack:[],config:n,enter:f,exit:d,buffer:o,resume:h,data:t},Ae=[];let Be=-1;for(;++Be<Q.length;)if(Q[Be][1].type==="listOrdered"||Q[Be][1].type==="listUnordered")if(Q[Be][0]==="enter")Ae.push(Be);else{const st=Ae.pop();Be=a(Q,st,Be)}for(Be=-1;++Be<Q.length;){const st=n[Q[Be][0]];CE.call(st,Q[Be][1].type)&&st[Q[Be][1].type].call(Object.assign({sliceSerialize:Q[Be][2].sliceSerialize},je),Q[Be][1])}if(je.tokenStack.length>0){const st=je.tokenStack[je.tokenStack.length-1];(st[1]||xj).call(je,void 0,st[0])}for(ie.position={start:Fc(Q.length>0?Q[0][1].start:{line:1,column:1,offset:0}),end:Fc(Q.length>0?Q[Q.length-2][1].end:{line:1,column:1,offset:0})},Be=-1;++Be<n.transforms.length;)ie=n.transforms[Be](ie)||ie;return ie}function a(Q,ie,je){let Ae=ie-1,Be=-1,st=!1,pt,dt,ze,Ke;for(;++Ae<=je;){const Fe=Q[Ae];switch(Fe[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Fe[0]==="enter"?Be++:Be--,Ke=void 0;break}case"lineEndingBlank":{Fe[0]==="enter"&&(pt&&!Ke&&!Be&&!ze&&(ze=Ae),Ke=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Ke=void 0}if(!Be&&Fe[0]==="enter"&&Fe[1].type==="listItemPrefix"||Be===-1&&Fe[0]==="exit"&&(Fe[1].type==="listUnordered"||Fe[1].type==="listOrdered")){if(pt){let at=Ae;for(dt=void 0;at--;){const Qe=Q[at];if(Qe[1].type==="lineEnding"||Qe[1].type==="lineEndingBlank"){if(Qe[0]==="exit")continue;dt&&(Q[dt][1].type="lineEndingBlank",st=!0),Qe[1].type="lineEnding",dt=at}else if(!(Qe[1].type==="linePrefix"||Qe[1].type==="blockQuotePrefix"||Qe[1].type==="blockQuotePrefixWhitespace"||Qe[1].type==="blockQuoteMarker"||Qe[1].type==="listItemIndent"))break}ze&&(!dt||ze<dt)&&(pt._spread=!0),pt.end=Object.assign({},dt?Q[dt][1].start:Fe[1].end),Q.splice(dt||Ae,0,["exit",pt,Fe[2]]),Ae++,je++}if(Fe[1].type==="listItemPrefix"){const at={type:"listItem",_spread:!1,start:Object.assign({},Fe[1].start),end:void 0};pt=at,Q.splice(Ae,0,["enter",at,Fe[2]]),Ae++,je++,ze=void 0,Ke=!0}}}return Q[ie][1]._spread=st,je}function l(Q,ie){return je;function je(Ae){f.call(this,Q(Ae),Ae),ie&&ie.call(this,Ae)}}function o(){this.stack.push({type:"fragment",children:[]})}function f(Q,ie,je){this.stack[this.stack.length-1].children.push(Q),this.stack.push(Q),this.tokenStack.push([ie,je||void 0]),Q.position={start:Fc(ie.start),end:void 0}}function u(Q){return ie;function ie(je){Q&&Q.call(this,je),d.call(this,je)}}function d(Q,ie){const je=this.stack.pop(),Ae=this.tokenStack.pop();if(Ae)Ae[0].type!==Q.type&&(ie?ie.call(this,Q,Ae[0]):(Ae[1]||xj).call(this,Q,Ae[0]));else throw new Error("Cannot close `"+Q.type+"` ("+Vm({start:Q.start,end:Q.end})+"): its not open");je.position.end=Fc(Q.end)}function h(){return Dw(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(Q){if(this.data.expectingFirstListItemValue){const ie=this.stack[this.stack.length-2];ie.start=Number.parseInt(this.sliceSerialize(Q),10),this.data.expectingFirstListItemValue=void 0}}function v(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.lang=Q}function N(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.meta=Q}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.value=Q.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function E(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.value=Q.replace(/(\r?\n|\r)$/g,"")}function I(Q){const ie=this.resume(),je=this.stack[this.stack.length-1];je.label=ie,je.identifier=Ch(this.sliceSerialize(Q)).toLowerCase()}function P(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.title=Q}function V(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.url=Q}function F(Q){const ie=this.stack[this.stack.length-1];if(!ie.depth){const je=this.sliceSerialize(Q).length;ie.depth=je}}function $(){this.data.setextHeadingSlurpLineEnding=!0}function B(Q){const ie=this.stack[this.stack.length-1];ie.depth=this.sliceSerialize(Q).codePointAt(0)===61?1:2}function z(){this.data.setextHeadingSlurpLineEnding=void 0}function q(Q){const je=this.stack[this.stack.length-1].children;let Ae=je[je.length-1];(!Ae||Ae.type!=="text")&&(Ae=an(),Ae.position={start:Fc(Q.start),end:void 0},je.push(Ae)),this.stack.push(Ae)}function O(Q){const ie=this.stack.pop();ie.value+=this.sliceSerialize(Q),ie.position.end=Fc(Q.end)}function R(Q){const ie=this.stack[this.stack.length-1];if(this.data.atHardBreak){const je=ie.children[ie.children.length-1];je.position.end=Fc(Q.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(ie.type)&&(q.call(this,Q),O.call(this,Q))}function G(){this.data.atHardBreak=!0}function ee(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.value=Q}function te(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.value=Q}function le(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.value=Q}function K(){const Q=this.stack[this.stack.length-1];if(this.data.inReference){const ie=this.data.referenceType||"shortcut";Q.type+="Reference",Q.referenceType=ie,delete Q.url,delete Q.title}else delete Q.identifier,delete Q.label;this.data.referenceType=void 0}function U(){const Q=this.stack[this.stack.length-1];if(this.data.inReference){const ie=this.data.referenceType||"shortcut";Q.type+="Reference",Q.referenceType=ie,delete Q.url,delete Q.title}else delete Q.identifier,delete Q.label;this.data.referenceType=void 0}function J(Q){const ie=this.sliceSerialize(Q),je=this.stack[this.stack.length-2];je.label=NE(ie),je.identifier=Ch(ie).toLowerCase()}function ne(){const Q=this.stack[this.stack.length-1],ie=this.resume(),je=this.stack[this.stack.length-1];if(this.data.inReference=!0,je.type==="link"){const Ae=Q.children;je.children=Ae}else je.alt=ie}function A(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.url=Q}function ae(){const Q=this.resume(),ie=this.stack[this.stack.length-1];ie.title=Q}function ce(){this.data.inReference=void 0}function M(){this.data.referenceType="collapsed"}function de(Q){const ie=this.resume(),je=this.stack[this.stack.length-1];je.label=ie,je.identifier=Ch(this.sliceSerialize(Q)).toLowerCase(),this.data.referenceType="full"}function Se(Q){this.data.characterReferenceType=Q.type}function fe(Q){const ie=this.sliceSerialize(Q),je=this.data.characterReferenceType;let Ae;je?(Ae=hE(ie,je==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Ae=Pw(ie);const Be=this.stack[this.stack.length-1];Be.value+=Ae}function we(Q){const ie=this.stack.pop();ie.position.end=Fc(Q.end)}function re(Q){O.call(this,Q);const ie=this.stack[this.stack.length-1];ie.url=this.sliceSerialize(Q)}function _e(Q){O.call(this,Q);const ie=this.stack[this.stack.length-1];ie.url="mailto:"+this.sliceSerialize(Q)}function qe(){return{type:"blockquote",children:[]}}function et(){return{type:"code",lang:null,meta:null,value:""}}function Je(){return{type:"inlineCode",value:""}}function Le(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function xe(){return{type:"emphasis",children:[]}}function Me(){return{type:"heading",depth:0,children:[]}}function ve(){return{type:"break"}}function Ee(){return{type:"html",value:""}}function De(){return{type:"image",title:null,url:"",alt:null}}function nt(){return{type:"link",title:null,url:"",children:[]}}function lt(Q){return{type:"list",ordered:Q.type==="listOrdered",start:null,spread:Q._spread,children:[]}}function Xe(Q){return{type:"listItem",spread:Q._spread,checked:null,children:[]}}function Mt(){return{type:"paragraph",children:[]}}function _t(){return{type:"strong",children:[]}}function an(){return{type:"text",value:""}}function se(){return{type:"thematicBreak"}}}function Fc(e){return{line:e.line,column:e.column,offset:e.offset}}function jE(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?jE(e,r):iJ(e,r)}}function iJ(e,n){let t;for(t in n)if(CE.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function xj(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+Vm({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+Vm({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+Vm({start:n.start,end:n.end})+") is still open")}function rJ(e){const n=this;n.parser=t;function t(r){return tJ(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}const bj={}.hasOwnProperty;function _E(e,n){const t=n||{};function r(a,...l){let o=r.invalid;const f=r.handlers;if(a&&bj.call(a,e)){const u=String(a[e]);o=bj.call(f,u)?f[u]:r.unknown}if(o)return o.call(this,a,...l)}return r.handlers=t.handlers||{},r.invalid=t.invalid,r.unknown=t.unknown,r}const aJ={}.hasOwnProperty;function kE(e,n){let t=-1,r;if(n.extensions)for(;++t<n.extensions.length;)kE(e,n.extensions[t]);for(r in n)if(aJ.call(n,r))switch(r){case"extensions":break;case"unsafe":{vj(e[r],n[r]);break}case"join":{vj(e[r],n[r]);break}case"handlers":{sJ(e[r],n[r]);break}default:e.options[r]=n[r]}return e}function vj(e,n){n&&e.push(...n)}function sJ(e,n){n&&Object.assign(e,n)}function lJ(e,n,t,r){const a=t.enter("blockquote"),l=t.createTracker(r);l.move("> "),l.shift(2);const o=t.indentLines(t.containerFlow(e,l.current()),oJ);return a(),o}function oJ(e,n,t){return">"+(t?"":" ")+e}function EE(e,n){return wj(e,n.inConstruct,!0)&&!wj(e,n.notInConstruct,!1)}function wj(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function Sj(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&EE(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function cJ(e,n){const t=String(e);let r=t.indexOf(n),a=r,l=0,o=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++l>o&&(o=l):l=1,a=r+n.length,r=t.indexOf(n,a);return o}function C1(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function uJ(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function dJ(e,n,t,r){const a=uJ(t),l=e.value||"",o=a==="`"?"GraveAccent":"Tilde";if(C1(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(l,fJ);return g(),b}const f=t.createTracker(r),u=a.repeat(Math.max(cJ(l,a)+1,3)),d=t.enter("codeFenced");let h=f.move(u);if(e.lang){const g=t.enter(`codeFencedLang${o}`);h+=f.move(t.safe(e.lang,{before:h,after:" ",encode:["`"],...f.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${o}`);h+=f.move(" "),h+=f.move(t.safe(e.meta,{before:h,after:`
`,encode:["`"],...f.current()})),g()}return h+=f.move(`
`),l&&(h+=f.move(l+`
`)),h+=f.move(u),d(),h}function fJ(e,n,t){return(t?"":"    ")+e}function Rw(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function hJ(e,n,t,r){const a=Rw(t),l=a==='"'?"Quote":"Apostrophe",o=t.enter("definition");let f=t.enter("label");const u=t.createTracker(r);let d=u.move("[");return d+=u.move(t.safe(t.associationId(e),{before:d,after:"]",...u.current()})),d+=u.move("]: "),f(),!e.url||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),d+=u.move("<"),d+=u.move(t.safe(e.url,{before:d,after:">",...u.current()})),d+=u.move(">")):(f=t.enter("destinationRaw"),d+=u.move(t.safe(e.url,{before:d,after:e.title?" ":`
`,...u.current()}))),f(),e.title&&(f=t.enter(`title${l}`),d+=u.move(" "+a),d+=u.move(t.safe(e.title,{before:d,after:a,...u.current()})),d+=u.move(a),f()),o(),d}function pJ(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function Hc(e){return"&#x"+e.toString(16).toUpperCase()+";"}function hb(e,n,t){const r=fb(e),a=fb(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}TE.peek=mJ;function TE(e,n,t,r){const a=pJ(t),l=t.enter("emphasis"),o=t.createTracker(r),f=o.move(a);let u=o.move(t.containerPhrasing(e,{after:a,before:f,...o.current()}));const d=u.charCodeAt(0),h=hb(r.before.charCodeAt(r.before.length-1),d,a);h.inside&&(u=Hc(d)+u.slice(1));const g=u.charCodeAt(u.length-1),b=hb(r.after.charCodeAt(0),g,a);b.inside&&(u=u.slice(0,-1)+Hc(g));const v=o.move(a);return l(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},f+u+v}function mJ(e,n,t){return t.options.emphasis||"*"}const Lw=function(e){if(e==null)return bJ;if(typeof e=="function")return $b(e);if(typeof e=="object")return Array.isArray(e)?gJ(e):yJ(e);if(typeof e=="string")return xJ(e);throw new Error("Expected function, string, or object as test")};function gJ(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=Lw(e[t]);return $b(r);function r(...a){let l=-1;for(;++l<n.length;)if(n[l].apply(this,a))return!0;return!1}}function yJ(e){const n=e;return $b(t);function t(r){const a=r;let l;for(l in e)if(a[l]!==n[l])return!1;return!0}}function xJ(e){return $b(n);function n(t){return t&&t.type===e}}function $b(e){return n;function n(t,r,a){return!!(vJ(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function bJ(){return!0}function vJ(e){return e!==null&&typeof e=="object"&&"type"in e}const AE=[],wJ=!0,j1=!1,SJ="skip";function NJ(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const l=Lw(a),o=r?-1:1;f(e,void 0,[])();function f(u,d,h){const g=u&&typeof u=="object"?u:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(u.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=AE,N,k,T;if((!n||l(u,d,h[h.length-1]||void 0))&&(v=CJ(t(u,h)),v[0]===j1))return v;if("children"in u&&u.children){const E=u;if(E.children&&v[0]!==SJ)for(k=(r?E.children.length:-1)+o,T=h.concat(E);k>-1&&k<E.children.length;){const I=E.children[k];if(N=f(I,k,T)(),N[0]===j1)return N;k=typeof N[1]=="number"?N[1]:k+o}}return v}}}function CJ(e){return Array.isArray(e)?e:typeof e=="number"?[wJ,e]:e==null?AE:[e]}function DE(e,n,t,r){let a,l,o;typeof n=="function"?(l=void 0,o=n,a=t):(l=n,o=t,a=r),NJ(e,l,f,a);function f(u,d){const h=d[d.length-1],g=h?h.children.indexOf(u):void 0;return o(u,g,h)}}function PE(e,n){let t=!1;return DE(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,j1}),!!((!e.depth||e.depth<3)&&Dw(e)&&(n.options.setext||t))}function jJ(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),l=t.createTracker(r);if(PE(e,t)){const h=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...l.current(),before:`
`,after:`
`});return g(),h(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const o="#".repeat(a),f=t.enter("headingAtx"),u=t.enter("phrasing");l.move(o+" ");let d=t.containerPhrasing(e,{before:"# ",after:`
`,...l.current()});return/^[\t ]/.test(d)&&(d=Hc(d.charCodeAt(0))+d.slice(1)),d=d?o+" "+d:o,t.options.closeAtx&&(d+=" "+o),u(),f(),d}IE.peek=_J;function IE(e){return e.value||""}function _J(){return"<"}ME.peek=kJ;function ME(e,n,t,r){const a=Rw(t),l=a==='"'?"Quote":"Apostrophe",o=t.enter("image");let f=t.enter("label");const u=t.createTracker(r);let d=u.move("![");return d+=u.move(t.safe(e.alt,{before:d,after:"]",...u.current()})),d+=u.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),d+=u.move("<"),d+=u.move(t.safe(e.url,{before:d,after:">",...u.current()})),d+=u.move(">")):(f=t.enter("destinationRaw"),d+=u.move(t.safe(e.url,{before:d,after:e.title?" ":")",...u.current()}))),f(),e.title&&(f=t.enter(`title${l}`),d+=u.move(" "+a),d+=u.move(t.safe(e.title,{before:d,after:a,...u.current()})),d+=u.move(a),f()),d+=u.move(")"),o(),d}function kJ(){return"!"}RE.peek=EJ;function RE(e,n,t,r){const a=e.referenceType,l=t.enter("imageReference");let o=t.enter("label");const f=t.createTracker(r);let u=f.move("![");const d=t.safe(e.alt,{before:u,after:"]",...f.current()});u+=f.move(d+"]["),o();const h=t.stack;t.stack=[],o=t.enter("reference");const g=t.safe(t.associationId(e),{before:u,after:"]",...f.current()});return o(),t.stack=h,l(),a==="full"||!d||d!==g?u+=f.move(g+"]"):a==="shortcut"?u=u.slice(0,-1):u+=f.move("]"),u}function EJ(){return"!"}LE.peek=TJ;function LE(e,n,t){let r=e.value||"",a="`",l=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++l<t.unsafe.length;){const o=t.unsafe[l],f=t.compilePattern(o);let u;if(o.atBreak)for(;u=f.exec(r);){let d=u.index;r.charCodeAt(d)===10&&r.charCodeAt(d-1)===13&&d--,r=r.slice(0,d)+" "+r.slice(u.index+1)}}return a+r+a}function TJ(){return"`"}function OE(e,n){const t=Dw(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}FE.peek=AJ;function FE(e,n,t,r){const a=Rw(t),l=a==='"'?"Quote":"Apostrophe",o=t.createTracker(r);let f,u;if(OE(e,t)){const h=t.stack;t.stack=[],f=t.enter("autolink");let g=o.move("<");return g+=o.move(t.containerPhrasing(e,{before:g,after:">",...o.current()})),g+=o.move(">"),f(),t.stack=h,g}f=t.enter("link"),u=t.enter("label");let d=o.move("[");return d+=o.move(t.containerPhrasing(e,{before:d,after:"](",...o.current()})),d+=o.move("]("),u(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(u=t.enter("destinationLiteral"),d+=o.move("<"),d+=o.move(t.safe(e.url,{before:d,after:">",...o.current()})),d+=o.move(">")):(u=t.enter("destinationRaw"),d+=o.move(t.safe(e.url,{before:d,after:e.title?" ":")",...o.current()}))),u(),e.title&&(u=t.enter(`title${l}`),d+=o.move(" "+a),d+=o.move(t.safe(e.title,{before:d,after:a,...o.current()})),d+=o.move(a),u()),d+=o.move(")"),f(),d}function AJ(e,n,t){return OE(e,t)?"<":"["}$E.peek=DJ;function $E(e,n,t,r){const a=e.referenceType,l=t.enter("linkReference");let o=t.enter("label");const f=t.createTracker(r);let u=f.move("[");const d=t.containerPhrasing(e,{before:u,after:"]",...f.current()});u+=f.move(d+"]["),o();const h=t.stack;t.stack=[],o=t.enter("reference");const g=t.safe(t.associationId(e),{before:u,after:"]",...f.current()});return o(),t.stack=h,l(),a==="full"||!d||d!==g?u+=f.move(g+"]"):a==="shortcut"?u=u.slice(0,-1):u+=f.move("]"),u}function DJ(){return"["}function Ow(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function PJ(e){const n=Ow(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function IJ(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function zE(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function MJ(e,n,t,r){const a=t.enter("list"),l=t.bulletCurrent;let o=e.ordered?IJ(t):Ow(t);const f=e.ordered?o==="."?")":".":PJ(t);let u=n&&t.bulletLastUsed?o===t.bulletLastUsed:!1;if(!e.ordered){const h=e.children?e.children[0]:void 0;if((o==="*"||o==="-")&&h&&(!h.children||!h.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(u=!0),zE(t)===o&&h){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){u=!0;break}}}}u&&(o=f),t.bulletCurrent=o;const d=t.containerFlow(e,r);return t.bulletLastUsed=o,t.bulletCurrent=l,a(),d}function RJ(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function LJ(e,n,t,r){const a=RJ(t);let l=t.bulletCurrent||Ow(t);n&&n.type==="list"&&n.ordered&&(l=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+l);let o=l.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(o=Math.ceil(o/4)*4);const f=t.createTracker(r);f.move(l+" ".repeat(o-l.length)),f.shift(o);const u=t.enter("listItem"),d=t.indentLines(t.containerFlow(e,f.current()),h);return u(),d;function h(g,b,v){return b?(v?"":" ".repeat(o))+g:(v?l:l+" ".repeat(o-l.length))+g}}function OJ(e,n,t,r){const a=t.enter("paragraph"),l=t.enter("phrasing"),o=t.containerPhrasing(e,r);return l(),a(),o}const FJ=Lw(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function $J(e,n,t,r){return(e.children.some(function(o){return FJ(o)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function zJ(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}BE.peek=BJ;function BE(e,n,t,r){const a=zJ(t),l=t.enter("strong"),o=t.createTracker(r),f=o.move(a+a);let u=o.move(t.containerPhrasing(e,{after:a,before:f,...o.current()}));const d=u.charCodeAt(0),h=hb(r.before.charCodeAt(r.before.length-1),d,a);h.inside&&(u=Hc(d)+u.slice(1));const g=u.charCodeAt(u.length-1),b=hb(r.after.charCodeAt(0),g,a);b.inside&&(u=u.slice(0,-1)+Hc(g));const v=o.move(a+a);return l(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},f+u+v}function BJ(e,n,t){return t.options.strong||"*"}function UJ(e,n,t,r){return t.safe(e.value,r)}function qJ(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function VJ(e,n,t){const r=(zE(t)+(t.options.ruleSpaces?" ":"")).repeat(qJ(t));return t.options.ruleSpaces?r.slice(0,-1):r}const HJ={blockquote:lJ,break:Sj,code:dJ,definition:hJ,emphasis:TE,hardBreak:Sj,heading:jJ,html:IE,image:ME,imageReference:RE,inlineCode:LE,link:FE,linkReference:$E,list:MJ,listItem:LJ,paragraph:OJ,root:$J,strong:BE,text:UJ,thematicBreak:VJ},GJ=[YJ];function YJ(e,n,t,r){if(n.type==="code"&&C1(n,r)&&(e.type==="list"||e.type===n.type&&C1(e,r)))return!1;if("spread"in t&&typeof t.spread=="boolean")return e.type==="paragraph"&&(e.type===n.type||n.type==="definition"||n.type==="heading"&&PE(n,r))?void 0:t.spread?1:0}const Nd=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],WJ=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:Nd},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:Nd},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:Nd},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:Nd},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:Nd},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:Nd},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:Nd},{atBreak:!0,character:"~"}];function QJ(e){return e.label||!e.identifier?e.label||"":NE(e.identifier)}function JJ(e){if(!e._compiled){const n=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((n?"("+n+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function KJ(e,n,t){const r=n.indexStack,a=e.children||[],l=[];let o=-1,f=t.before,u;r.push(-1);let d=n.createTracker(t);for(;++o<a.length;){const h=a[o];let g;if(r[r.length-1]=o,o+1<a.length){let N=n.handle.handlers[a[o+1].type];N&&N.peek&&(N=N.peek),g=N?N(a[o+1],e,n,{before:"",after:"",...d.current()}).charAt(0):""}else g=t.after;l.length>0&&(f==="\r"||f===`
`)&&h.type==="html"&&(l[l.length-1]=l[l.length-1].replace(/(\r?\n|\r)$/," "),f=" ",d=n.createTracker(t),d.move(l.join("")));let b=n.handle(h,e,n,{...d.current(),after:g,before:f});u&&u===b.slice(0,1)&&(b=Hc(u.charCodeAt(0))+b.slice(1));const v=n.attentionEncodeSurroundingInfo;n.attentionEncodeSurroundingInfo=void 0,u=void 0,v&&(l.length>0&&v.before&&f===l[l.length-1].slice(-1)&&(l[l.length-1]=l[l.length-1].slice(0,-1)+Hc(f.charCodeAt(0))),v.after&&(u=g)),d.move(b),l.push(b),f=b.slice(-1)}return r.pop(),l.join("")}function XJ(e,n,t){const r=n.indexStack,a=e.children||[],l=n.createTracker(t),o=[];let f=-1;for(r.push(-1);++f<a.length;){const u=a[f];r[r.length-1]=f,o.push(l.move(n.handle(u,e,n,{before:`
`,after:`
`,...l.current()}))),u.type!=="list"&&(n.bulletLastUsed=void 0),f<a.length-1&&o.push(l.move(ZJ(u,a[f+1],e,n)))}return r.pop(),o.join("")}function ZJ(e,n,t,r){let a=r.join.length;for(;a--;){const l=r.join[a](e,n,t,r);if(l===!0||l===1)break;if(typeof l=="number")return`
`.repeat(1+l);if(l===!1)return`

<!---->

`}return`

`}const eK=/\r?\n|\r/g;function tK(e,n){const t=[];let r=0,a=0,l;for(;l=eK.exec(e);)o(e.slice(r,l.index)),t.push(l[0]),r=l.index+l[0].length,a++;return o(e.slice(r)),t.join("");function o(f){t.push(n(f,a,!f))}}function nK(e,n,t){const r=(t.before||"")+(n||"")+(t.after||""),a=[],l=[],o={};let f=-1;for(;++f<e.unsafe.length;){const h=e.unsafe[f];if(!EE(e.stack,h))continue;const g=e.compilePattern(h);let b;for(;b=g.exec(r);){const v="before"in h||!!h.atBreak,N="after"in h,k=b.index+(v?b[1].length:0);a.includes(k)?(o[k].before&&!v&&(o[k].before=!1),o[k].after&&!N&&(o[k].after=!1)):(a.push(k),o[k]={before:v,after:N})}}a.sort(iK);let u=t.before?t.before.length:0;const d=r.length-(t.after?t.after.length:0);for(f=-1;++f<a.length;){const h=a[f];h<u||h>=d||h+1<d&&a[f+1]===h+1&&o[h].after&&!o[h+1].before&&!o[h+1].after||a[f-1]===h-1&&o[h].before&&!o[h-1].before&&!o[h-1].after||(u!==h&&l.push(Nj(r.slice(u,h),"\\")),u=h,/[!-/:-@[-`{-~]/.test(r.charAt(h))&&(!t.encode||!t.encode.includes(r.charAt(h)))?l.push("\\"):(l.push(Hc(r.charCodeAt(h))),u++))}return l.push(Nj(r.slice(u,d),t.after)),l.join("")}function iK(e,n){return e-n}function Nj(e,n){const t=/\\(?=[!-/:-@[-`{-~])/g,r=[],a=[],l=e+n;let o=-1,f=0,u;for(;u=t.exec(l);)r.push(u.index);for(;++o<r.length;)f!==r[o]&&a.push(e.slice(f,r[o])),a.push("\\"),f=r[o];return a.push(e.slice(f)),a.join("")}function rK(e){const n=e||{},t=n.now||{};let r=n.lineShift||0,a=t.line||1,l=t.column||1;return{move:u,current:o,shift:f};function o(){return{now:{line:a,column:l},lineShift:r}}function f(d){r+=d}function u(d){const h=d||"",g=h.split(/\r?\n|\r/g),b=g[g.length-1];return a+=g.length-1,l=g.length===1?l+b.length:1+b.length+r,h}}function aK(e,n){const t=n||{},r={associationId:QJ,containerPhrasing:cK,containerFlow:uK,createTracker:rK,compilePattern:JJ,enter:l,handlers:{...HJ},handle:void 0,indentLines:tK,indexStack:[],join:[...GJ],options:{},safe:dK,stack:[],unsafe:[...WJ]};kE(r,t),r.options.tightDefinitions&&r.join.push(oK),r.handle=_E("type",{invalid:sK,unknown:lK,handlers:r.handlers});let a=r.handle(e,void 0,r,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return a&&a.charCodeAt(a.length-1)!==10&&a.charCodeAt(a.length-1)!==13&&(a+=`
`),a;function l(o){return r.stack.push(o),f;function f(){r.stack.pop()}}}function sK(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function lK(e){const n=e;throw new Error("Cannot handle unknown node `"+n.type+"`")}function oK(e,n){if(e.type==="definition"&&e.type===n.type)return 0}function cK(e,n){return KJ(e,this,n)}function uK(e,n){return XJ(e,this,n)}function dK(e,n){return nK(this,e,n)}function fK(e){const n=this;n.compiler=t;function t(r){return aK(r,{...n.data("settings"),...e,extensions:n.data("toMarkdownExtensions")||[]})}}function Cj(e){if(e)throw e}var jv,jj;function hK(){if(jj)return jv;jj=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(d){return typeof Array.isArray=="function"?Array.isArray(d):n.call(d)==="[object Array]"},l=function(d){if(!d||n.call(d)!=="[object Object]")return!1;var h=e.call(d,"constructor"),g=d.constructor&&d.constructor.prototype&&e.call(d.constructor.prototype,"isPrototypeOf");if(d.constructor&&!h&&!g)return!1;var b;for(b in d);return typeof b>"u"||e.call(d,b)},o=function(d,h){t&&h.name==="__proto__"?t(d,h.name,{enumerable:!0,configurable:!0,value:h.newValue,writable:!0}):d[h.name]=h.newValue},f=function(d,h){if(h==="__proto__")if(e.call(d,h)){if(r)return r(d,h).value}else return;return d[h]};return jv=function u(){var d,h,g,b,v,N,k=arguments[0],T=1,E=arguments.length,I=!1;for(typeof k=="boolean"&&(I=k,k=arguments[1]||{},T=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});T<E;++T)if(d=arguments[T],d!=null)for(h in d)g=f(k,h),b=f(d,h),k!==b&&(I&&b&&(l(b)||(v=a(b)))?(v?(v=!1,N=g&&a(g)?g:[]):N=g&&l(g)?g:{},o(k,{name:h,newValue:u(I,N,b)})):typeof b<"u"&&o(k,{name:h,newValue:b}));return k},jv}var pK=hK();const _v=Fd(pK);function _1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function mK(){const e=[],n={run:t,use:r};return n;function t(...a){let l=-1;const o=a.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);f(null,...a);function f(u,...d){const h=e[++l];let g=-1;if(u){o(u);return}for(;++g<a.length;)(d[g]===null||d[g]===void 0)&&(d[g]=a[g]);a=d,h?gK(h,f)(...d):o(null,...d)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function gK(e,n){let t;return r;function r(...o){const f=e.length>o.length;let u;f&&o.push(a);try{u=e.apply(this,o)}catch(d){const h=d;if(f&&t)throw h;return a(h)}f||(u&&u.then&&typeof u.then=="function"?u.then(l,a):u instanceof Error?a(u):l(u))}function a(o,...f){t||(t=!0,n(o,...f))}function l(o){a(null,o)}}class sa extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",l={},o=!1;if(t&&("line"in t&&"column"in t?l={place:t}:"start"in t&&"end"in t?l={place:t}:"type"in t?l={ancestors:[t],place:t.position}:l={...t}),typeof n=="string"?a=n:!l.cause&&n&&(o=!0,a=n.message,l.cause=n),!l.ruleId&&!l.source&&typeof r=="string"){const u=r.indexOf(":");u===-1?l.ruleId=r:(l.source=r.slice(0,u),l.ruleId=r.slice(u+1))}if(!l.place&&l.ancestors&&l.ancestors){const u=l.ancestors[l.ancestors.length-1];u&&(l.place=u.position)}const f=l.place&&"start"in l.place?l.place.start:l.place;this.ancestors=l.ancestors||void 0,this.cause=l.cause||void 0,this.column=f?f.column:void 0,this.fatal=void 0,this.file="",this.message=a,this.line=f?f.line:void 0,this.name=Vm(l.place)||"1:1",this.place=l.place||void 0,this.reason=this.message,this.ruleId=l.ruleId||void 0,this.source=l.source||void 0,this.stack=o&&l.cause&&typeof l.cause.stack=="string"?l.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}sa.prototype.file="";sa.prototype.name="";sa.prototype.reason="";sa.prototype.message="";sa.prototype.stack="";sa.prototype.column=void 0;sa.prototype.line=void 0;sa.prototype.ancestors=void 0;sa.prototype.cause=void 0;sa.prototype.fatal=void 0;sa.prototype.place=void 0;sa.prototype.ruleId=void 0;sa.prototype.source=void 0;const Tl={basename:yK,dirname:xK,extname:bK,join:vK,sep:"/"};function yK(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');dg(e);let t=0,r=-1,a=e.length,l;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(l){t=a+1;break}}else r<0&&(l=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let o=-1,f=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(l){t=a+1;break}}else o<0&&(l=!0,o=a+1),f>-1&&(e.codePointAt(a)===n.codePointAt(f--)?f<0&&(r=a):(f=-1,r=o));return t===r?r=o:r<0&&(r=e.length),e.slice(t,r)}function xK(e){if(dg(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function bK(e){dg(e);let n=e.length,t=-1,r=0,a=-1,l=0,o;for(;n--;){const f=e.codePointAt(n);if(f===47){if(o){r=n+1;break}continue}t<0&&(o=!0,t=n+1),f===46?a<0?a=n:l!==1&&(l=1):a>-1&&(l=-1)}return a<0||t<0||l===0||l===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function vK(...e){let n=-1,t;for(;++n<e.length;)dg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":wK(t)}function wK(e){dg(e);const n=e.codePointAt(0)===47;let t=SK(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function SK(e,n){let t="",r=0,a=-1,l=0,o=-1,f,u;for(;++o<=e.length;){if(o<e.length)f=e.codePointAt(o);else{if(f===47)break;f=47}if(f===47){if(!(a===o-1||l===1))if(a!==o-1&&l===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(u=t.lastIndexOf("/"),u!==t.length-1){u<0?(t="",r=0):(t=t.slice(0,u),r=t.length-1-t.lastIndexOf("/")),a=o,l=0;continue}}else if(t.length>0){t="",r=0,a=o,l=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,o):t=e.slice(a+1,o),r=o-a-1;a=o,l=0}else f===46&&l>-1?l++:l=-1}return t}function dg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const NK={cwd:CK};function CK(){return"/"}function k1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function jK(e){if(typeof e=="string")e=new URL(e);else if(!k1(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return _K(e)}function _K(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const kv=["history","path","basename","stem","extname","dirname"];class kK{constructor(n){let t;n?k1(n)?t={path:n}:typeof n=="string"||EK(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":NK.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<kv.length;){const l=kv[r];l in t&&t[l]!==void 0&&t[l]!==null&&(this[l]=l==="history"?[...t[l]]:t[l])}let a;for(a in t)kv.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?Tl.basename(this.path):void 0}set basename(n){Tv(n,"basename"),Ev(n,"basename"),this.path=Tl.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?Tl.dirname(this.path):void 0}set dirname(n){_j(this.basename,"dirname"),this.path=Tl.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?Tl.extname(this.path):void 0}set extname(n){if(Ev(n,"extname"),_j(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Tl.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){k1(n)&&(n=jK(n)),Tv(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?Tl.basename(this.path,this.extname):void 0}set stem(n){Tv(n,"stem"),Ev(n,"stem"),this.path=Tl.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new sa(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}}function Ev(e,n){if(e&&e.includes(Tl.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+Tl.sep+"`")}function Tv(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function _j(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function EK(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const TK=function(e){const r=this.constructor.prototype,a=r[e],l=function(){return a.apply(l,arguments)};return Object.setPrototypeOf(l,r),l},AK={}.hasOwnProperty;class Fw extends TK{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=mK()}copy(){const n=new Fw;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data(_v(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(Pv("data",this.frozen),this.namespace[n]=t,this):AK.call(this.namespace,n)&&this.namespace[n]||void 0:n?(Pv("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=jx(n),r=this.parser||this.Parser;return Av("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),Av("process",this.parser||this.Parser),Dv("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(l,o){const f=jx(n),u=r.parse(f);r.run(u,f,function(h,g,b){if(h||!g||!b)return d(h);const v=g,N=r.stringify(v,b);IK(N)?b.value=N:b.result=N,d(h,b)});function d(h,g){h||!g?o(h):l?l(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),Av("processSync",this.parser||this.Parser),Dv("processSync",this.compiler||this.Compiler),this.process(n,a),Ej("processSync","process",t),r;function a(l,o){t=!0,Cj(l),r=o}}run(n,t,r){kj(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?l(void 0,r):new Promise(l);function l(o,f){const u=jx(t);a.run(n,u,d);function d(h,g,b){const v=g||n;h?f(h):o?o(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,l),Ej("runSync","run",r),a;function l(o,f){Cj(o),a=f,r=!0}}stringify(n,t){this.freeze();const r=jx(t),a=this.compiler||this.Compiler;return Dv("stringify",a),kj(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(Pv("use",this.frozen),n!=null)if(typeof n=="function")u(n,t);else if(typeof n=="object")Array.isArray(n)?f(n):o(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function l(d){if(typeof d=="function")u(d,[]);else if(typeof d=="object")if(Array.isArray(d)){const[h,...g]=d;u(h,g)}else o(d);else throw new TypeError("Expected usable value, not `"+d+"`")}function o(d){if(!("plugins"in d)&&!("settings"in d))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");f(d.plugins),d.settings&&(a.settings=_v(!0,a.settings,d.settings))}function f(d){let h=-1;if(d!=null)if(Array.isArray(d))for(;++h<d.length;){const g=d[h];l(g)}else throw new TypeError("Expected a list of plugins, not `"+d+"`")}function u(d,h){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===d){b=g;break}if(b===-1)r.push([d,...h]);else if(h.length>0){let[v,...N]=h;const k=r[b][1];_1(k)&&_1(v)&&(v=_v(!0,k,v)),r[b]=[d,v,...N]}}}}const DK=new Fw().freeze();function Av(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function Dv(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function Pv(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function kj(e){if(!_1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function Ej(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function jx(e){return PK(e)?e:new kK(e)}function PK(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function IK(e){return typeof e=="string"||MK(e)}function MK(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const RK=DK().use(rJ).use(fK).freeze(),UE=-1,zb=0,Hm=1,pb=2,$w=3,zw=4,Bw=5,Uw=6,qE=7,VE=8,Tj=typeof self=="object"?self:globalThis,LK=(e,n)=>{const t=(a,l)=>(e.set(l,a),a),r=a=>{if(e.has(a))return e.get(a);const[l,o]=n[a];switch(l){case zb:case UE:return t(o,a);case Hm:{const f=t([],a);for(const u of o)f.push(r(u));return f}case pb:{const f=t({},a);for(const[u,d]of o)f[r(u)]=r(d);return f}case $w:return t(new Date(o),a);case zw:{const{source:f,flags:u}=o;return t(new RegExp(f,u),a)}case Bw:{const f=t(new Map,a);for(const[u,d]of o)f.set(r(u),r(d));return f}case Uw:{const f=t(new Set,a);for(const u of o)f.add(r(u));return f}case qE:{const{name:f,message:u}=o;return t(new Tj[f](u),a)}case VE:return t(BigInt(o),a);case"BigInt":return t(Object(BigInt(o)),a);case"ArrayBuffer":return t(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:f}=new Uint8Array(o);return t(new DataView(f),o)}}return t(new Tj[l](o),a)};return r},Aj=e=>LK(new Map,e)(0),mh="",{toString:OK}={},{keys:FK}=Object,Mm=e=>{const n=typeof e;if(n!=="object"||!e)return[zb,n];const t=OK.call(e).slice(8,-1);switch(t){case"Array":return[Hm,mh];case"Object":return[pb,mh];case"Date":return[$w,mh];case"RegExp":return[zw,mh];case"Map":return[Bw,mh];case"Set":return[Uw,mh];case"DataView":return[Hm,t]}return t.includes("Array")?[Hm,t]:t.includes("Error")?[qE,t]:[pb,t]},_x=([e,n])=>e===zb&&(n==="function"||n==="symbol"),$K=(e,n,t,r)=>{const a=(o,f)=>{const u=r.push(o)-1;return t.set(f,u),u},l=o=>{if(t.has(o))return t.get(o);let[f,u]=Mm(o);switch(f){case zb:{let h=o;switch(u){case"bigint":f=VE,h=o.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+u);h=null;break;case"undefined":return a([UE],o)}return a([f,h],o)}case Hm:{if(u){let b=o;return u==="DataView"?b=new Uint8Array(o.buffer):u==="ArrayBuffer"&&(b=new Uint8Array(o)),a([u,[...b]],o)}const h=[],g=a([f,h],o);for(const b of o)h.push(l(b));return g}case pb:{if(u)switch(u){case"BigInt":return a([u,o.toString()],o);case"Boolean":case"Number":case"String":return a([u,o.valueOf()],o)}if(n&&"toJSON"in o)return l(o.toJSON());const h=[],g=a([f,h],o);for(const b of FK(o))(e||!_x(Mm(o[b])))&&h.push([l(b),l(o[b])]);return g}case $w:return a([f,o.toISOString()],o);case zw:{const{source:h,flags:g}=o;return a([f,{source:h,flags:g}],o)}case Bw:{const h=[],g=a([f,h],o);for(const[b,v]of o)(e||!(_x(Mm(b))||_x(Mm(v))))&&h.push([l(b),l(v)]);return g}case Uw:{const h=[],g=a([f,h],o);for(const b of o)(e||!_x(Mm(b)))&&h.push(l(b));return g}}const{message:d}=o;return a([f,{name:u,message:d}],o)};return l},Dj=(e,{json:n,lossy:t}={})=>{const r=[];return $K(!(n||t),!!n,new Map,r)(e),r},tg=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?Aj(Dj(e,n)):structuredClone(e):(e,n)=>Aj(Dj(e,n)),HE=YE("end"),GE=YE("start");function YE(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function WE(e){const n=GE(e),t=HE(e);if(n&&t)return{start:n,end:t}}const Cd=["ariaDescribedBy","ariaLabel","ariaLabelledBy"],Pj={ancestors:{tbody:["table"],td:["table"],th:["table"],thead:["table"],tfoot:["table"],tr:["table"]},attributes:{a:[...Cd,"dataFootnoteBackref","dataFootnoteRef",["className","data-footnote-backref"],"href"],blockquote:["cite"],code:[["className",/^language-./]],del:["cite"],div:["itemScope","itemType"],dl:[...Cd],h2:[["className","sr-only"]],img:[...Cd,"longDesc","src"],input:[["disabled",!0],["type","checkbox"]],ins:["cite"],li:[["className","task-list-item"]],ol:[...Cd,["className","contains-task-list"]],q:["cite"],section:["dataFootnotes",["className","footnotes"]],source:["srcSet"],summary:[...Cd],table:[...Cd],ul:[...Cd,["className","contains-task-list"]],"*":["abbr","accept","acceptCharset","accessKey","action","align","alt","axis","border","cellPadding","cellSpacing","char","charOff","charSet","checked","clear","colSpan","color","cols","compact","coords","dateTime","dir","encType","frame","hSpace","headers","height","hrefLang","htmlFor","id","isMap","itemProp","label","lang","maxLength","media","method","multiple","name","noHref","noShade","noWrap","open","prompt","readOnly","rev","rowSpan","rows","rules","scope","selected","shape","size","span","start","summary","tabIndex","title","useMap","vAlign","value","width"]},clobber:["ariaDescribedBy","ariaLabelledBy","id","name"],clobberPrefix:"user-content-",protocols:{cite:["http","https"],href:["http","https","irc","ircs","mailto","xmpp"],longDesc:["http","https"],src:["http","https"]},required:{input:{disabled:!0,type:"checkbox"}},strip:["script"],tagNames:["a","b","blockquote","br","code","dd","del","details","div","dl","dt","em","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","li","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","tr","tt","ul","var"]},zc={}.hasOwnProperty;function zK(e,n){let t={type:"root",children:[]};const r={schema:n?{...Pj,...n}:Pj,stack:[]},a=QE(r,e);return a&&(Array.isArray(a)?a.length===1?t=a[0]:t.children=a:t=a),t}function QE(e,n){if(n&&typeof n=="object"){const t=n;switch(typeof t.type=="string"?t.type:""){case"comment":return BK(e,t);case"doctype":return UK(e,t);case"element":return qK(e,t);case"root":return VK(e,t);case"text":return HK(e,t)}}}function BK(e,n){if(e.schema.allowComments){const t=typeof n.value=="string"?n.value:"",r=t.indexOf("-->"),l={type:"comment",value:r<0?t:t.slice(0,r)};return fg(l,n),l}}function UK(e,n){if(e.schema.allowDoctypes){const t={type:"doctype"};return fg(t,n),t}}function qK(e,n){const t=typeof n.tagName=="string"?n.tagName:"";e.stack.push(t);const r=JE(e,n.children),a=GK(e,n.properties);e.stack.pop();let l=!1;if(t&&t!=="*"&&(!e.schema.tagNames||e.schema.tagNames.includes(t))&&(l=!0,e.schema.ancestors&&zc.call(e.schema.ancestors,t))){const f=e.schema.ancestors[t];let u=-1;for(l=!1;++u<f.length;)e.stack.includes(f[u])&&(l=!0)}if(!l)return e.schema.strip&&!e.schema.strip.includes(t)?r:void 0;const o={type:"element",tagName:t,properties:a,children:r};return fg(o,n),o}function VK(e,n){const r={type:"root",children:JE(e,n.children)};return fg(r,n),r}function HK(e,n){const r={type:"text",value:typeof n.value=="string"?n.value:""};return fg(r,n),r}function JE(e,n){const t=[];if(Array.isArray(n)){const r=n;let a=-1;for(;++a<r.length;){const l=QE(e,r[a]);l&&(Array.isArray(l)?t.push(...l):t.push(l))}}return t}function GK(e,n){const t=e.stack[e.stack.length-1],r=e.schema.attributes,a=e.schema.required,l=r&&zc.call(r,t)?r[t]:void 0,o=r&&zc.call(r,"*")?r["*"]:void 0,f=n&&typeof n=="object"?n:{},u={};let d;for(d in f)if(zc.call(f,d)){const h=f[d];let g=Ij(e,Mj(l,d),d,h);g==null&&(g=Ij(e,Mj(o,d),d,h)),g!=null&&(u[d]=g)}if(a&&zc.call(a,t)){const h=a[t];for(d in h)zc.call(h,d)&&!zc.call(u,d)&&(u[d]=h[d])}return u}function Ij(e,n,t,r){return n?Array.isArray(r)?YK(e,n,t,r):KE(e,n,t,r):void 0}function YK(e,n,t,r){let a=-1;const l=[];for(;++a<r.length;){const o=KE(e,n,t,r[a]);(typeof o=="number"||typeof o=="string")&&l.push(o)}return l}function KE(e,n,t,r){if(!(typeof r!="boolean"&&typeof r!="number"&&typeof r!="string")&&WK(e,t,r)){if(typeof n=="object"&&n.length>1){let a=!1,l=0;for(;++l<n.length;){const o=n[l];if(o&&typeof o=="object"&&"flags"in o){if(o.test(String(r))){a=!0;break}}else if(o===r){a=!0;break}}if(!a)return}return e.schema.clobber&&e.schema.clobberPrefix&&e.schema.clobber.includes(t)?e.schema.clobberPrefix+r:r}}function WK(e,n,t){const r=e.schema.protocols&&zc.call(e.schema.protocols,n)?e.schema.protocols[n]:void 0;if(!r||r.length===0)return!0;const a=String(t),l=a.indexOf(":"),o=a.indexOf("?"),f=a.indexOf("#"),u=a.indexOf("/");if(l<0||u>-1&&l>u||o>-1&&l>o||f>-1&&l>f)return!0;let d=-1;for(;++d<r.length;){const h=r[d];if(l===h.length&&a.slice(0,h.length)===h)return!0}return!1}function fg(e,n){const t=WE(n);n.data&&(e.data=tg(n.data)),t&&(e.position=t)}function Mj(e,n){let t,r=-1;if(e)for(;++r<e.length;){const a=e[r],l=typeof a=="string"?a:a[0];if(l===n)return a;l==="data*"&&(t=a)}if(n.length>4&&n.slice(0,4).toLowerCase()==="data")return t}function QK(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function JK(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function KK(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function XK(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function ZK(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function eX(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=Bh(r.toLowerCase()),l=e.footnoteOrder.indexOf(r);let o,f=e.footnoteCounts.get(r);f===void 0?(f=0,e.footnoteOrder.push(r),o=e.footnoteOrder.length):o=l+1,f+=1,e.footnoteCounts.set(r,f);const u={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(f>1?"-"+f:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};e.patch(n,u);const d={type:"element",tagName:"sup",properties:{},children:[u]};return e.patch(n,d),e.applyData(n,d)}function tX(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function nX(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function XE(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),l=a[0];l&&l.type==="text"?l.value="["+l.value:a.unshift({type:"text",value:"["});const o=a[a.length-1];return o&&o.type==="text"?o.value+=r:a.push({type:"text",value:r}),a}function iX(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return XE(e,n);const a={src:Bh(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const l={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,l),e.applyData(n,l)}function rX(e,n){const t={src:Bh(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function aX(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function sX(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return XE(e,n);const a={href:Bh(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const l={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,l),e.applyData(n,l)}function lX(e,n){const t={href:Bh(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function oX(e,n,t){const r=e.all(n),a=t?cX(t):ZE(n),l={},o=[];if(typeof n.checked=="boolean"){const h=r[0];let g;h&&h.type==="element"&&h.tagName==="p"?g=h:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),l.className=["task-list-item"]}let f=-1;for(;++f<r.length;){const h=r[f];(a||f!==0||h.type!=="element"||h.tagName!=="p")&&o.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!a?o.push(...h.children):o.push(h)}const u=r[r.length-1];u&&(a||u.type!=="element"||u.tagName!=="p")&&o.push({type:"text",value:`
`});const d={type:"element",tagName:"li",properties:l,children:o};return e.patch(n,d),e.applyData(n,d)}function cX(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=ZE(t[r])}return n}function ZE(e){const n=e.spread;return n??e.children.length>1}function uX(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const o=r[a];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const l={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,l),e.applyData(n,l)}function dX(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function fX(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function hX(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function pX(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],o),a.push(o)}if(t.length>0){const o={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},f=GE(n.children[1]),u=HE(n.children[n.children.length-1]);f&&u&&(o.position={start:f,end:u}),a.push(o)}const l={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,l),e.applyData(n,l)}function mX(e,n,t){const r=t?t.children:void 0,l=(r?r.indexOf(n):1)===0?"th":"td",o=t&&t.type==="table"?t.align:void 0,f=o?o.length:n.children.length;let u=-1;const d=[];for(;++u<f;){const g=n.children[u],b={},v=o?o[u]:void 0;v&&(b.align=v);let N={type:"element",tagName:l,properties:b,children:[]};g&&(N.children=e.all(g),e.patch(g,N),N=e.applyData(g,N)),d.push(N)}const h={type:"element",tagName:"tr",properties:{},children:e.wrap(d,!0)};return e.patch(n,h),e.applyData(n,h)}function gX(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const Rj=9,Lj=32;function yX(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const l=[];for(;r;)l.push(Oj(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return l.push(Oj(n.slice(a),a>0,!1)),l.join("")}function Oj(e,n,t){let r=0,a=e.length;if(n){let l=e.codePointAt(r);for(;l===Rj||l===Lj;)r++,l=e.codePointAt(r)}if(t){let l=e.codePointAt(a-1);for(;l===Rj||l===Lj;)a--,l=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function xX(e,n){const t={type:"text",value:yX(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function bX(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const vX={blockquote:QK,break:JK,code:KK,delete:XK,emphasis:ZK,footnoteReference:eX,heading:tX,html:nX,imageReference:iX,image:rX,inlineCode:aX,linkReference:sX,link:lX,listItem:oX,list:uX,paragraph:dX,root:fX,strong:hX,table:pX,tableCell:gX,tableRow:mX,text:xX,thematicBreak:bX,toml:kx,yaml:kx,definition:kx,footnoteDefinition:kx};function kx(){}function wX(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function SX(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function NX(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||wX,r=e.options.footnoteBackLabel||SX,a=e.options.footnoteLabel||"Footnotes",l=e.options.footnoteLabelTagName||"h2",o=e.options.footnoteLabelProperties||{className:["sr-only"]},f=[];let u=-1;for(;++u<e.footnoteOrder.length;){const d=e.footnoteById.get(e.footnoteOrder[u]);if(!d)continue;const h=e.all(d),g=String(d.identifier).toUpperCase(),b=Bh(g.toLowerCase());let v=0;const N=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){N.length>0&&N.push({type:"text",value:" "});let I=typeof t=="string"?t:t(u,v);typeof I=="string"&&(I={type:"text",value:I}),N.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(u,v),className:["data-footnote-backref"]},children:Array.isArray(I)?I:[I]})}const T=h[h.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const I=T.children[T.children.length-1];I&&I.type==="text"?I.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...N)}else h.push(...N);const E={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(h,!0)};e.patch(d,E),f.push(E)}if(f.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:l,properties:{...tg(o),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(f,!0)},{type:"text",value:`
`}]}}const E1={}.hasOwnProperty,CX={};function jX(e,n){const t=n||CX,r=new Map,a=new Map,l=new Map,o={...vX,...t.handlers},f={all:d,applyData:kX,definitionById:r,footnoteById:a,footnoteCounts:l,footnoteOrder:[],handlers:o,one:u,options:t,patch:_X,wrap:TX};return DE(e,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const g=h.type==="definition"?r:a,b=String(h.identifier).toUpperCase();g.has(b)||g.set(b,h)}}),f;function u(h,g){const b=h.type,v=f.handlers[b];if(E1.call(f.handlers,b)&&v)return v(f,h,g);if(f.options.passThrough&&f.options.passThrough.includes(b)){if("children"in h){const{children:k,...T}=h,E=tg(T);return E.children=f.all(h),E}return tg(h)}return(f.options.unknownHandler||EX)(f,h,g)}function d(h){const g=[];if("children"in h){const b=h.children;let v=-1;for(;++v<b.length;){const N=f.one(b[v],h);if(N){if(v&&b[v-1].type==="break"&&(!Array.isArray(N)&&N.type==="text"&&(N.value=Fj(N.value)),!Array.isArray(N)&&N.type==="element")){const k=N.children[0];k&&k.type==="text"&&(k.value=Fj(k.value))}Array.isArray(N)?g.push(...N):g.push(N)}}}return g}}function _X(e,n){e.position&&(n.position=WE(e))}function kX(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,l=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const o="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:o}}t.type==="element"&&l&&Object.assign(t.properties,tg(l)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function EX(e,n){const t=n.data||{},r="value"in n&&!(E1.call(t,"hProperties")||E1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function TX(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function Fj(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function AX(e,n){const t=jX(e,n),r=t.one(e,void 0),a=NX(t),l=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&l.children.push({type:"text",value:`
`},a),l}const DX=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"];class hg{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}}hg.prototype.normal={};hg.prototype.property={};hg.prototype.space=void 0;function eT(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new hg(t,r,n)}function T1(e){return e.toLowerCase()}class la{constructor(n,t){this.attribute=t,this.property=n}}la.prototype.attribute="";la.prototype.booleanish=!1;la.prototype.boolean=!1;la.prototype.commaOrSpaceSeparated=!1;la.prototype.commaSeparated=!1;la.prototype.defined=!1;la.prototype.mustUseProperty=!1;la.prototype.number=!1;la.prototype.overloadedBoolean=!1;la.prototype.property="";la.prototype.spaceSeparated=!1;la.prototype.space=void 0;let PX=0;const Ut=zd(),Ti=zd(),A1=zd(),rt=zd(),Wn=zd(),jh=zd(),Aa=zd();function zd(){return 2**++PX}const D1=Object.freeze(Object.defineProperty({__proto__:null,boolean:Ut,booleanish:Ti,commaOrSpaceSeparated:Aa,commaSeparated:jh,number:rt,overloadedBoolean:A1,spaceSeparated:Wn},Symbol.toStringTag,{value:"Module"})),Iv=Object.keys(D1);class qw extends la{constructor(n,t,r,a){let l=-1;if(super(n,t),$j(this,"space",a),typeof r=="number")for(;++l<Iv.length;){const o=Iv[l];$j(this,Iv[l],(r&D1[o])===D1[o])}}}qw.prototype.defined=!0;function $j(e,n,t){t&&(e[n]=t)}function Uh(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const l=new qw(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(l.mustUseProperty=!0),n[r]=l,t[T1(r)]=r,t[T1(l.attribute)]=r}return new hg(n,t,e.space)}const tT=Uh({properties:{ariaActiveDescendant:null,ariaAtomic:Ti,ariaAutoComplete:null,ariaBusy:Ti,ariaChecked:Ti,ariaColCount:rt,ariaColIndex:rt,ariaColSpan:rt,ariaControls:Wn,ariaCurrent:null,ariaDescribedBy:Wn,ariaDetails:null,ariaDisabled:Ti,ariaDropEffect:Wn,ariaErrorMessage:null,ariaExpanded:Ti,ariaFlowTo:Wn,ariaGrabbed:Ti,ariaHasPopup:null,ariaHidden:Ti,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Wn,ariaLevel:rt,ariaLive:null,ariaModal:Ti,ariaMultiLine:Ti,ariaMultiSelectable:Ti,ariaOrientation:null,ariaOwns:Wn,ariaPlaceholder:null,ariaPosInSet:rt,ariaPressed:Ti,ariaReadOnly:Ti,ariaRelevant:null,ariaRequired:Ti,ariaRoleDescription:Wn,ariaRowCount:rt,ariaRowIndex:rt,ariaRowSpan:rt,ariaSelected:Ti,ariaSetSize:rt,ariaSort:null,ariaValueMax:rt,ariaValueMin:rt,ariaValueNow:rt,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function nT(e,n){return n in e?e[n]:n}function iT(e,n){return nT(e,n.toLowerCase())}const IX=Uh({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:jh,acceptCharset:Wn,accessKey:Wn,action:null,allow:null,allowFullScreen:Ut,allowPaymentRequest:Ut,allowUserMedia:Ut,alt:null,as:null,async:Ut,autoCapitalize:null,autoComplete:Wn,autoFocus:Ut,autoPlay:Ut,blocking:Wn,capture:null,charSet:null,checked:Ut,cite:null,className:Wn,cols:rt,colSpan:null,content:null,contentEditable:Ti,controls:Ut,controlsList:Wn,coords:rt|jh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Ut,defer:Ut,dir:null,dirName:null,disabled:Ut,download:A1,draggable:Ti,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Ut,formTarget:null,headers:Wn,height:rt,hidden:A1,high:rt,href:null,hrefLang:null,htmlFor:Wn,httpEquiv:Wn,id:null,imageSizes:null,imageSrcSet:null,inert:Ut,inputMode:null,integrity:null,is:null,isMap:Ut,itemId:null,itemProp:Wn,itemRef:Wn,itemScope:Ut,itemType:Wn,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Ut,low:rt,manifest:null,max:null,maxLength:rt,media:null,method:null,min:null,minLength:rt,multiple:Ut,muted:Ut,name:null,nonce:null,noModule:Ut,noValidate:Ut,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Ut,optimum:rt,pattern:null,ping:Wn,placeholder:null,playsInline:Ut,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Ut,referrerPolicy:null,rel:Wn,required:Ut,reversed:Ut,rows:rt,rowSpan:rt,sandbox:Wn,scope:null,scoped:Ut,seamless:Ut,selected:Ut,shadowRootClonable:Ut,shadowRootDelegatesFocus:Ut,shadowRootMode:null,shape:null,size:rt,sizes:null,slot:null,span:rt,spellCheck:Ti,src:null,srcDoc:null,srcLang:null,srcSet:null,start:rt,step:null,style:null,tabIndex:rt,target:null,title:null,translate:null,type:null,typeMustMatch:Ut,useMap:null,value:Ti,width:rt,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Wn,axis:null,background:null,bgColor:null,border:rt,borderColor:null,bottomMargin:rt,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Ut,declare:Ut,event:null,face:null,frame:null,frameBorder:null,hSpace:rt,leftMargin:rt,link:null,longDesc:null,lowSrc:null,marginHeight:rt,marginWidth:rt,noResize:Ut,noHref:Ut,noShade:Ut,noWrap:Ut,object:null,profile:null,prompt:null,rev:null,rightMargin:rt,rules:null,scheme:null,scrolling:Ti,standby:null,summary:null,text:null,topMargin:rt,valueType:null,version:null,vAlign:null,vLink:null,vSpace:rt,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Ut,disableRemotePlayback:Ut,prefix:null,property:null,results:rt,security:null,unselectable:null},space:"html",transform:iT}),MX=Uh({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Aa,accentHeight:rt,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:rt,amplitude:rt,arabicForm:null,ascent:rt,attributeName:null,attributeType:null,azimuth:rt,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:rt,by:null,calcMode:null,capHeight:rt,className:Wn,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:rt,diffuseConstant:rt,direction:null,display:null,dur:null,divisor:rt,dominantBaseline:null,download:Ut,dx:null,dy:null,edgeMode:null,editable:null,elevation:rt,enableBackground:null,end:null,event:null,exponent:rt,externalResourcesRequired:null,fill:null,fillOpacity:rt,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:jh,g2:jh,glyphName:jh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:rt,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:rt,horizOriginX:rt,horizOriginY:rt,id:null,ideographic:rt,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:rt,k:rt,k1:rt,k2:rt,k3:rt,k4:rt,kernelMatrix:Aa,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:rt,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:rt,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:rt,overlineThickness:rt,paintOrder:null,panose1:null,path:null,pathLength:rt,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Wn,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:rt,pointsAtY:rt,pointsAtZ:rt,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Aa,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Aa,rev:Aa,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Aa,requiredFeatures:Aa,requiredFonts:Aa,requiredFormats:Aa,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:rt,specularExponent:rt,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:rt,strikethroughThickness:rt,string:null,stroke:null,strokeDashArray:Aa,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:rt,strokeOpacity:rt,strokeWidth:null,style:null,surfaceScale:rt,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Aa,tabIndex:rt,tableValues:null,target:null,targetX:rt,targetY:rt,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Aa,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:rt,underlineThickness:rt,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:rt,values:null,vAlphabetic:rt,vMathematical:rt,vectorEffect:null,vHanging:rt,vIdeographic:rt,version:null,vertAdvY:rt,vertOriginX:rt,vertOriginY:rt,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:rt,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:nT}),rT=Uh({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),aT=Uh({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:iT}),sT=Uh({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),RX=/[A-Z]/g,zj=/-[a-z]/g,LX=/^data[-\w.:]+$/i;function OX(e,n){const t=T1(n);let r=n,a=la;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&LX.test(n)){if(n.charAt(4)==="-"){const l=n.slice(5).replace(zj,$X);r="data"+l.charAt(0).toUpperCase()+l.slice(1)}else{const l=n.slice(4);if(!zj.test(l)){let o=l.replace(RX,FX);o.charAt(0)!=="-"&&(o="-"+o),n="data"+o}}a=qw}return new a(r,n)}function FX(e){return"-"+e.toLowerCase()}function $X(e){return e.charAt(1).toUpperCase()}const zX=eT([tT,IX,rT,aT,sT],"html"),lT=eT([tT,MX,rT,aT,sT],"svg"),BX=/["&'<>`]/g,UX=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,qX=/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,VX=/[|\\{}()[\]^$+*?.]/g,Bj=new WeakMap;function HX(e,n){if(e=e.replace(n.subset?GX(n.subset):BX,r),n.subset||n.escapeOnly)return e;return e.replace(UX,t).replace(qX,r);function t(a,l,o){return n.format((a.charCodeAt(0)-55296)*1024+a.charCodeAt(1)-56320+65536,o.charCodeAt(l+2),n)}function r(a,l,o){return n.format(a.charCodeAt(0),o.charCodeAt(l+1),n)}}function GX(e){let n=Bj.get(e);return n||(n=YX(e),Bj.set(e,n)),n}function YX(e){const n=[];let t=-1;for(;++t<e.length;)n.push(e[t].replace(VX,"\\$&"));return new RegExp("(?:"+n.join("|")+")","g")}const WX=/[\dA-Fa-f]/;function QX(e,n,t){const r="&#x"+e.toString(16).toUpperCase();return t&&n&&!WX.test(String.fromCharCode(n))?r:r+";"}const JX=/\d/;function KX(e,n,t){const r="&#"+String(e);return t&&n&&!JX.test(String.fromCharCode(n))?r:r+";"}const XX=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],Mv={nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",fnof:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",bull:"",hellip:"",prime:"",Prime:"",oline:"",frasl:"",weierp:"",image:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",quot:'"',amp:"&",lt:"<",gt:">",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",permil:"",lsaquo:"",rsaquo:"",euro:""},ZX=["cent","copy","divide","gt","lt","not","para","times"],oT={}.hasOwnProperty,P1={};let Ex;for(Ex in Mv)oT.call(Mv,Ex)&&(P1[Mv[Ex]]=Ex);const eZ=/[^\dA-Za-z]/;function tZ(e,n,t,r){const a=String.fromCharCode(e);if(oT.call(P1,a)){const l=P1[a],o="&"+l;return t&&XX.includes(l)&&!ZX.includes(l)&&(!r||n&&n!==61&&eZ.test(String.fromCharCode(n)))?o:o+";"}return""}function nZ(e,n,t){let r=QX(e,n,t.omitOptionalSemicolons),a;if((t.useNamedReferences||t.useShortestReferences)&&(a=tZ(e,n,t.omitOptionalSemicolons,t.attribute)),(t.useShortestReferences||!a)&&t.useShortestReferences){const l=KX(e,n,t.omitOptionalSemicolons);l.length<r.length&&(r=l)}return a&&(!t.useShortestReferences||a.length<r.length)?a:r}function _h(e,n){return HX(e,Object.assign({format:nZ},n))}const iZ=/^>|^->|<!--|-->|--!>|<!-$/g,rZ=[">"],aZ=["<",">"];function sZ(e,n,t,r){return r.settings.bogusComments?"<?"+_h(e.value,Object.assign({},r.settings.characterReferences,{subset:rZ}))+">":"<!--"+e.value.replace(iZ,a)+"-->";function a(l){return _h(l,Object.assign({},r.settings.characterReferences,{subset:aZ}))}}function lZ(e,n,t,r){return"<!"+(r.settings.upperDoctype?"DOCTYPE":"doctype")+(r.settings.tightDoctype?"":" ")+"html>"}function Uj(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function oZ(e,n){const t=n||{};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}function cZ(e){return e.join(" ").trim()}const uZ=/[ \t\n\f\r]/g;function Vw(e){return typeof e=="object"?e.type==="text"?qj(e.value):!1:qj(e)}function qj(e){return e.replace(uZ,"")===""}const Li=uT(1),cT=uT(-1),dZ=[];function uT(e){return n;function n(t,r,a){const l=t?t.children:dZ;let o=(r||0)+e,f=l[o];if(!a)for(;f&&Vw(f);)o+=e,f=l[o];return f}}const fZ={}.hasOwnProperty;function dT(e){return n;function n(t,r,a){return fZ.call(e,t.tagName)&&e[t.tagName](t,r,a)}}const Hw=dT({body:pZ,caption:Rv,colgroup:Rv,dd:xZ,dt:yZ,head:Rv,html:hZ,li:gZ,optgroup:bZ,option:vZ,p:mZ,rp:Vj,rt:Vj,tbody:SZ,td:Hj,tfoot:NZ,th:Hj,thead:wZ,tr:CZ});function Rv(e,n,t){const r=Li(t,n,!0);return!r||r.type!=="comment"&&!(r.type==="text"&&Vw(r.value.charAt(0)))}function hZ(e,n,t){const r=Li(t,n);return!r||r.type!=="comment"}function pZ(e,n,t){const r=Li(t,n);return!r||r.type!=="comment"}function mZ(e,n,t){const r=Li(t,n);return r?r.type==="element"&&(r.tagName==="address"||r.tagName==="article"||r.tagName==="aside"||r.tagName==="blockquote"||r.tagName==="details"||r.tagName==="div"||r.tagName==="dl"||r.tagName==="fieldset"||r.tagName==="figcaption"||r.tagName==="figure"||r.tagName==="footer"||r.tagName==="form"||r.tagName==="h1"||r.tagName==="h2"||r.tagName==="h3"||r.tagName==="h4"||r.tagName==="h5"||r.tagName==="h6"||r.tagName==="header"||r.tagName==="hgroup"||r.tagName==="hr"||r.tagName==="main"||r.tagName==="menu"||r.tagName==="nav"||r.tagName==="ol"||r.tagName==="p"||r.tagName==="pre"||r.tagName==="section"||r.tagName==="table"||r.tagName==="ul"):!t||!(t.type==="element"&&(t.tagName==="a"||t.tagName==="audio"||t.tagName==="del"||t.tagName==="ins"||t.tagName==="map"||t.tagName==="noscript"||t.tagName==="video"))}function gZ(e,n,t){const r=Li(t,n);return!r||r.type==="element"&&r.tagName==="li"}function yZ(e,n,t){const r=Li(t,n);return!!(r&&r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd"))}function xZ(e,n,t){const r=Li(t,n);return!r||r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd")}function Vj(e,n,t){const r=Li(t,n);return!r||r.type==="element"&&(r.tagName==="rp"||r.tagName==="rt")}function bZ(e,n,t){const r=Li(t,n);return!r||r.type==="element"&&r.tagName==="optgroup"}function vZ(e,n,t){const r=Li(t,n);return!r||r.type==="element"&&(r.tagName==="option"||r.tagName==="optgroup")}function wZ(e,n,t){const r=Li(t,n);return!!(r&&r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot"))}function SZ(e,n,t){const r=Li(t,n);return!r||r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot")}function NZ(e,n,t){return!Li(t,n)}function CZ(e,n,t){const r=Li(t,n);return!r||r.type==="element"&&r.tagName==="tr"}function Hj(e,n,t){const r=Li(t,n);return!r||r.type==="element"&&(r.tagName==="td"||r.tagName==="th")}const jZ=dT({body:EZ,colgroup:TZ,head:kZ,html:_Z,tbody:AZ});function _Z(e){const n=Li(e,-1);return!n||n.type!=="comment"}function kZ(e){const n=new Set;for(const r of e.children)if(r.type==="element"&&(r.tagName==="base"||r.tagName==="title")){if(n.has(r.tagName))return!1;n.add(r.tagName)}const t=e.children[0];return!t||t.type==="element"}function EZ(e){const n=Li(e,-1,!0);return!n||n.type!=="comment"&&!(n.type==="text"&&Vw(n.value.charAt(0)))&&!(n.type==="element"&&(n.tagName==="meta"||n.tagName==="link"||n.tagName==="script"||n.tagName==="style"||n.tagName==="template"))}function TZ(e,n,t){const r=cT(t,n),a=Li(e,-1,!0);return t&&r&&r.type==="element"&&r.tagName==="colgroup"&&Hw(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="col")}function AZ(e,n,t){const r=cT(t,n),a=Li(e,-1);return t&&r&&r.type==="element"&&(r.tagName==="thead"||r.tagName==="tbody")&&Hw(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="tr")}const Tx={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function DZ(e,n,t,r){const a=r.schema,l=a.space==="svg"?!1:r.settings.omitOptionalTags;let o=a.space==="svg"?r.settings.closeEmptyElements:r.settings.voids.includes(e.tagName.toLowerCase());const f=[];let u;a.space==="html"&&e.tagName==="svg"&&(r.schema=lT);const d=PZ(r,e.properties),h=r.all(a.space==="html"&&e.tagName==="template"?e.content:e);return r.schema=a,h&&(o=!1),(d||!l||!jZ(e,n,t))&&(f.push("<",e.tagName,d?" "+d:""),o&&(a.space==="svg"||r.settings.closeSelfClosing)&&(u=d.charAt(d.length-1),(!r.settings.tightSelfClosing||u==="/"||u&&u!=='"'&&u!=="'")&&f.push(" "),f.push("/")),f.push(">")),f.push(h),!o&&(!l||!Hw(e,n,t))&&f.push("</"+e.tagName+">"),f.join("")}function PZ(e,n){const t=[];let r=-1,a;if(n){for(a in n)if(n[a]!==null&&n[a]!==void 0){const l=IZ(e,a,n[a]);l&&t.push(l)}}for(;++r<t.length;){const l=e.settings.tightAttributes?t[r].charAt(t[r].length-1):void 0;r!==t.length-1&&l!=='"'&&l!=="'"&&(t[r]+=" ")}return t.join("")}function IZ(e,n,t){const r=OX(e.schema,n),a=e.settings.allowParseErrors&&e.schema.space==="html"?0:1,l=e.settings.allowDangerousCharacters?0:1;let o=e.quote,f;if(r.overloadedBoolean&&(t===r.attribute||t==="")?t=!0:(r.boolean||r.overloadedBoolean)&&(typeof t!="string"||t===r.attribute||t==="")&&(t=!!t),t==null||t===!1||typeof t=="number"&&Number.isNaN(t))return"";const u=_h(r.attribute,Object.assign({},e.settings.characterReferences,{subset:Tx.name[a][l]}));return t===!0||(t=Array.isArray(t)?(r.commaSeparated?oZ:cZ)(t,{padLeft:!e.settings.tightCommaSeparatedLists}):String(t),e.settings.collapseEmptyAttributes&&!t)?u:(e.settings.preferUnquoted&&(f=_h(t,Object.assign({},e.settings.characterReferences,{attribute:!0,subset:Tx.unquoted[a][l]}))),f!==t&&(e.settings.quoteSmart&&Uj(t,o)>Uj(t,e.alternative)&&(o=e.alternative),f=o+_h(t,Object.assign({},e.settings.characterReferences,{subset:(o==="'"?Tx.single:Tx.double)[a][l],attribute:!0}))+o),u+(f&&"="+f))}const MZ=["<","&"];function fT(e,n,t,r){return t&&t.type==="element"&&(t.tagName==="script"||t.tagName==="style")?e.value:_h(e.value,Object.assign({},r.settings.characterReferences,{subset:MZ}))}function RZ(e,n,t,r){return r.settings.allowDangerousHtml?e.value:fT(e,n,t,r)}function LZ(e,n,t,r){return r.all(e)}const OZ=_E("type",{invalid:FZ,unknown:$Z,handlers:{comment:sZ,doctype:lZ,element:DZ,raw:RZ,root:LZ,text:fT}});function FZ(e){throw new Error("Expected node, not `"+e+"`")}function $Z(e){const n=e;throw new Error("Cannot compile unknown node `"+n.type+"`")}const zZ={},BZ={},UZ=[];function qZ(e,n){const t=n||zZ,r=t.quote||'"',a=r==='"'?"'":'"';if(r!=='"'&&r!=="'")throw new Error("Invalid quote `"+r+"`, expected `'` or `\"`");return{one:VZ,all:HZ,settings:{omitOptionalTags:t.omitOptionalTags||!1,allowParseErrors:t.allowParseErrors||!1,allowDangerousCharacters:t.allowDangerousCharacters||!1,quoteSmart:t.quoteSmart||!1,preferUnquoted:t.preferUnquoted||!1,tightAttributes:t.tightAttributes||!1,upperDoctype:t.upperDoctype||!1,tightDoctype:t.tightDoctype||!1,bogusComments:t.bogusComments||!1,tightCommaSeparatedLists:t.tightCommaSeparatedLists||!1,tightSelfClosing:t.tightSelfClosing||!1,collapseEmptyAttributes:t.collapseEmptyAttributes||!1,allowDangerousHtml:t.allowDangerousHtml||!1,voids:t.voids||DX,characterReferences:t.characterReferences||BZ,closeSelfClosing:t.closeSelfClosing||!1,closeEmptyElements:t.closeEmptyElements||!1},schema:t.space==="svg"?lT:zX,quote:r,alternative:a}.one(Array.isArray(e)?{type:"root",children:e}:e,void 0,void 0)}function VZ(e,n,t){return OZ(e,n,t,this)}function HZ(e){const n=[],t=e&&e.children||UZ;let r=-1;for(;++r<t.length;)n[r]=this.one(t[r],r,e);return n.join("")}const GZ={};function YZ(e){const n=this,{handlers:t,sanitize:r,...a}=e||GZ;let l=!1,o;typeof r=="boolean"?l=!r:r&&(o=r),n.compiler=f;function f(u,d){const h=AX(u,{handlers:t,allowDangerousHtml:l}),g=l?h:zK(h,o),b=qZ(g,{...a,allowDangerousHtml:l});return d.extname&&(d.extname=".html"),u&&u.type==="root"&&b&&/[^\r\n]/.test(b.charAt(b.length-1))?b+`
`:b}}const WZ=()=>{var gu,ec,Kd;const{recordId:e}=jr(),n=gt(),t=rr(),[r,a]=w.useState(""),[l]=w.useState([]),[o,f]=w.useState(null),[u,d]=w.useState(null),[h,g]=w.useState(void 0),[b,v]=w.useState(void 0),[N,k]=w.useState(null),[T,E]=w.useState(!1),[I,P]=w.useState(""),[V,F]=w.useState(!1),[$,B]=w.useState(null),[z,q]=w.useState(null),[O,R]=w.useState(!1),[G,ee]=w.useState(!1),[te,le]=w.useState(null),[K,U]=w.useState(""),[J,ne]=w.useState(""),[A,ae]=w.useState(null),[ce,M]=w.useState(!1),[de,Se]=w.useState(!1),[fe,we]=w.useState(null),[re,_e]=w.useState(!1),[qe,et]=w.useState(null),[Je,Le]=w.useState(window.innerHeight),[xe,Me]=w.useState([]),[ve,Ee]=w.useState(!1),[De,nt]=w.useState(null),[lt,Xe]=w.useState([]),[Mt,_t]=w.useState([]),[an,se]=w.useState(!1),[Q,ie]=w.useState(null),je=w.useRef(null),Ae=w.useRef(null),Be=w.useRef(!1),st=w.useRef(null),pt=w.useRef(null),[dt,ze]=w.useState(33.33),[Ke,Fe]=w.useState(!1),at=w.useRef(null),Qe=w.useRef(null),yt=150,[Un,On]=w.useState([]),[Cn,mn]=w.useState([]),[un,Ni]=w.useState(!1),[Hi,ar]=w.useState(null),[oa,kr]=w.useState(!1),[ni,Kn]=w.useState(null),[Fn,La]=w.useState(!1),[ss,Vh]=w.useState(null),[Hh,Bd]=w.useState(!1),[ls,Zc]=w.useState(null),[Us,qs]=w.useState(!1),[Oa,Vs]=w.useState(null),[ci,Ud]=w.useState(!1),[Ro,os]=w.useState(null),[Fa,Gi]=w.useState([]),[Hs,$a]=w.useState(!1),[qd,Fl]=w.useState(null),[Gs,sr]=w.useState(!1),[$l,Lo]=w.useState(null),[ca,eu]=w.useState({}),[tu,Vd]=w.useState(!1),[nu,Oi]=w.useState(!1),[Ys,Oo]=w.useState(!1),[cs,Fo]=w.useState(!1),[Or,iu]=w.useState(!1),[Di,zl]=w.useState(!1),[Ws,Qs]=w.useState(!1),[ua,Js]=w.useState(!1),us=w.useMemo(()=>(u==null?void 0:u.admission_date)&&!(u!=null&&u.discharge_date),[u]),[da,fa]=w.useState(!1),[Bl,Ul]=w.useState(""),[ql,$o]=w.useState(void 0),[zo,ds]=w.useState(void 0),[Ks,Vl]=w.useState(void 0),[Fi,za]=w.useState(!1),[Bo,ha]=w.useState(null),[Xs,Hl]=w.useState(!1),lr=w.useRef(null),[Zs,fs]=w.useState(null),[Fr,Uo]=w.useState(null),hs=w.useRef(null),[Hd]=w.useState("Loading..."),[gn,ln]=w.useState(!1),[qo,Pi]=w.useState(!1),[Qt,el]=w.useState(null),[Ba,ru]=w.useState(""),[Ua,ps]=w.useState(""),[Xn,ms]=w.useState(!0),[Yi,au]=w.useState(!1),[Gl,Ii]=w.useState(!1),[pa,su]=w.useState(!1),Vo=w.useRef(null),gs=async he=>{try{const be=await pe(`/api/patients/${he}`);if(!be.ok){const ue=await be.json().catch(()=>({}));throw new Error(ue.message||`Failed to fetch patient details: ${be.status}`)}const W=await be.json();if(d(W),g(W.age),v(W.gender),U(W.ai_response||""),d(ue=>ue?{...ue,current_status:W.current_status,admission_date:W.admission_date,discharge_date:W.discharge_date}:{...W,current_status:W.current_status,admission_date:W.admission_date,discharge_date:W.discharge_date}),W.insurance_type&&d(ue=>ue?{...ue,insurance_type:W.insurance_type}:{...W}),Yl(he),W.ai_response){const ue=/```json\s*([\s\S]*?)\s*```/,ge=W.ai_response.match(ue);if(ge&&ge[1])ne(W.ai_response.replace(ue,"").trim()),ae(ge[1].trim());else{const $e=W.ai_response.trim();if($e.startsWith("{")&&$e.endsWith("}"))try{JSON.parse($e),ne(""),ae($e)}catch{ne($e),ae(null)}else if($e.startsWith("[")&&$e.endsWith("]"))try{JSON.parse($e),ne(""),ae($e)}catch{ne($e),ae(null)}else ne($e),ae(null)}}else ne(""),ae(null)}catch{d(null),U(""),ne(""),ae(null)}},Gd=async(he,be)=>{d(W=>W?{...W,insurance_type:be}:null);try{const W=await pe(`/api/patients/${he}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:be})});if(!W.ok){const ue=await W.json();throw new Error(ue.message||"Failed to update insurance type")}}catch(W){console.error("Error updating insurance type:",W),he&&gs(he)}},lu=async he=>{se(!0),ie(null),_t([]);try{const be=await pe(`/api/queue/patient/${he}/complaints`);if(!be.ok){const ue=await be.json().catch(()=>({}));throw new Error(ue.message||`HTTP error! status: ${be.status}`)}const W=await be.json();_t(W||[])}catch(be){ie(`Past complaints error: ${be.message}`)}finally{se(!1)}},ui=async he=>{Xe([]);try{const be=await pe(`/api/pharmacy-orders/patient/${he}`);if(!be.ok){const ue=await be.json().catch(()=>({}));throw new Error(ue.message||`HTTP error! status: ${be.status}`)}const W=await be.json();Xe(W||[])}catch{}},Ho=async he=>{$a(!0),Fl(null),Gi([]);try{const be=await pe(`/api/lab/orders/patient/${he}`);if(!be.ok){const ue=await be.json().catch(()=>({}));throw new Error(ue.message||`HTTP error! status: ${be.status}`)}const W=await be.json();Gi(W||[])}catch(be){Fl(`Pending labs error: ${be.message}`)}finally{$a(!1)}},$i=async he=>{Ee(!0),nt(null),Me([]);try{const be=await pe(`/api/lab/patient/${he}`);if(!be.ok){const ue=await be.json().catch(()=>({}));throw new Error(ue.message||`HTTP error! status: ${be.status}`)}const W=await be.json();Me(W||[])}catch(be){nt(`Lab reports error: ${be.message}`)}finally{Ee(!1)}},Gh=async he=>{R(!0),se(!0),$a(!0),Ee(!0),Xe([]);try{const be=await pe(`/api/patients/${he}/context`);if(!be.ok){const ge=await be.json().catch(()=>({}));throw new Error(ge.message||`Failed to fetch patient context: ${be.status}`)}const W=await be.json(),ue=W.patient;if(d(ue),g(ue.age),v(ue.gender),U(ue.ai_response||""),Yl(he),ue.ai_response){const ge=/```json\s*([\s\S]*?)\s*```/,$e=ue.ai_response.match(ge);if($e&&$e[1])ne(ue.ai_response.replace(ge,"").trim()),ae($e[1].trim());else{const We=ue.ai_response.trim();if(We.startsWith("{")&&We.endsWith("}"))try{JSON.parse(We),ne(""),ae(We)}catch{ne(We),ae(null)}else if(We.startsWith("[")&&We.endsWith("]"))try{JSON.parse(We),ne(""),ae(We)}catch{ne(We),ae(null)}else ne(We),ae(null)}}else ne(""),ae(null);_t(W.pastComplaints||[]),Xe(W.pharmacyOrders||[]),Gi(W.labOrders||[]),Me(W.labReports||[])}catch(be){console.error("Error fetching patient context:",be),le(be.message),d(null),U(""),ne(""),ae(null),_t([]),Xe([]),Gi([]),Me([])}finally{R(!1),se(!1),$a(!1),Ee(!1)}},Yl=async he=>{try{const be=await pe(`/api/queue/patient/${he}/latest`);if(!be.ok){const ue=await be.json().catch(()=>({}));throw new Error(ue.message||`Failed to fetch queue status: ${be.status}`)}const W=await be.json();if(W){const ue=new Date(W.createdAt),ge=new Date,$e=ue.getDate()===ge.getDate()&&ue.getMonth()===ge.getMonth()&&ue.getFullYear()===ge.getFullYear(),We=["waiting","consulting"].includes(W.status);Js($e&&We)}else Js(!1)}catch(be){console.error("Error checking patient queue status:",be),Js(!1)}},$r=he=>{n(`/dashboard/edit-pharmacy-order/${he}`)},Go=he=>{le(null),console.log(`Preparing billing navigation for order: ${he}`);const be=lt.find(W=>W.id===he);if(be){const W=be.medications.map(ue=>{const ge=ue.price??0;return(ue.price===void 0||ue.price===null)&&console.warn(`Medication "${ue.name}" in order ${he} is missing a price. Defaulting to 0.`),{name:ue.name,pack_quantity:ue.pack_quantity,loose_quantity:ue.loose_quantity,price:ge,pack_price:ue.pack_price,loose_price:ue.loose_price,total_price:Number(ue.total_price)||0,isLoose:ue.isLoose,unit:ue.unit,drug_id:ue.drug_id?String(ue.drug_id):null,tabletsPerDay:ue.tabletsPerDay,numberOfDays:ue.numberOfDays,directions_to_use:ue.directions_to_use,discount_percentage:ue.discount_percentage??0,batch:ue.batch,expiry_date:ue.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:W}),n(`/dashboard/pharmacy-billing/${he}`,{state:{initialItems:W}})}else console.error(`Order with ID ${he} not found.`),le(`Order with ID ${he} not found.`),alert(`Error: Could not find order ${he} to bill.`)},ou=async(he,be)=>{le(null);const W=lt.find(ge=>ge.id===he);if(!W){le(`Order with ID ${he} not found.`);return}const ue={status:be,medications:W.medications};try{const ge=await pe(`/api/pharmacy-orders/${he}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ue)});if(!ge.ok){const We=await ge.text();throw new Error(`Failed to update status: ${ge.statusText} (${ge.status}) - ${We}`)}const $e=await ge.json();Xe(We=>We.map(tt=>tt.id===$e.id?$e:tt)),o&&ui(o)}catch(ge){console.error("Failed to update order status:",ge),le(ge.message||`Failed to update status for order ${he}.`),alert(`Error updating status for order ${he}: ${ge.message||"Please try again."}`)}},In=async he=>{le(null);try{const be=await pe(`/api/pharmacy-orders/${he}/recurring`,{method:"POST"});if(!be.ok){const W=await be.json().catch(()=>({}));throw new Error(W.message||"Failed to mark order as recurring")}alert("Order marked as recurring successfully!")}catch(be){console.error("Failed to mark order as recurring:",be),le(be.message||`Failed to mark order ${he} as recurring.`),alert(`Error: ${be.message||"Please try again."}`)}},ma=he=>{Gi(be=>be.map(W=>W.id===he?{...W,isEditing:!0,editedTests:[...W.tests],editedStatus:W.status}:{...W,isEditing:!1}))},cu=he=>{Gi(be=>be.map(W=>W.id===he?{...W,isEditing:!1,editedTests:void 0,editedStatus:void 0}:W))},Yh=(he,be,W,ue)=>{Gi(ge=>ge.map($e=>{if($e.id===he){const We=$e.editedTests?[...$e.editedTests]:[...$e.tests];if(W==="add")return{...$e,editedTests:[...We,{id:"",name:"",price:0}]};if(W==="remove")return{...$e,editedTests:ue};if(be!==-1){const tt={...We[be],[W]:ue};return We[be]=tt,{...$e,editedTests:We}}}return $e}))},uu=(he,be)=>{Gi(W=>W.map(ue=>ue.id===he?{...ue,editedStatus:be}:ue))},Wh=he=>{if(!he||!he.id){console.error("Cannot navigate to billing: Lab Order data or ID is missing."),alert("Could not open billing page: Lab Order information is missing.");return}n("/lab-billing",{state:{labOrderId:he.id}})},Yd=he=>{he&&he.id?n(`/lab/report/${he.id}`):(console.error("Cannot navigate: Lab Order or Lab Order ID is missing."),alert("Could not open the lab report page: Lab Order information is missing."))},Qh=async(he,be,W)=>{Oo(!0),le(null);try{if(!be||be.length===0)throw new Error("Lab order must have at least one test.");for(const $e of be)if(!$e.id||!$e.name||isNaN($e.price)||$e.price<0)throw new Error(`Invalid test data: ${JSON.stringify($e)}. Each test must have id, name, and a valid price.`);const ue={tests:be,status:W},ge=await pe(`/api/lab/orders/${he}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ue)});if(!ge.ok){const $e=await ge.json().catch(()=>({}));throw new Error($e.message||`Failed to update lab order: ${ge.statusText}`)}o&&Ho(o),Gi($e=>$e.map(We=>We.id===he?{...We,isEditing:!1,editedTests:void 0,editedStatus:void 0}:We))}catch(ue){le(`Lab Order Save Error: ${ue.message}`)}finally{Oo(!1)}},Wl=async he=>{if(!window.confirm(`Are you sure you want to delete this ${he.type.toLowerCase()} record? This action cannot be undone.`))return;sr(!0),Lo(null);let W=null,ue;const ge=he.type;try{switch(ge){case"Complaint":if(ue=he.data.id,!ue)throw new Error("Complaint ID is missing.");W=`/api/patients/complaints/${ue}`;break;case"Lab Order":if(ue=he.data.id,!ue)throw new Error("Lab Order ID is missing.");W=`/api/lab/orders/${ue}`;break;case"Lab Report":if(ue=he.data.reportId,!ue)throw new Error("Lab Report ID is missing.");W=`/api/lab/reports/${ue}`;break;case"Pharmacy Order":if(ue=he.data.id,!ue)throw new Error("Pharmacy Order ID is missing.");W=`/api/pharmacy-orders/${ue}`;break;default:throw new Error(`Deletion not supported for item type: ${ge}`)}if(!W)throw new Error(`Could not determine delete URL for type: ${ge}`);const $e=await pe(W,{method:"DELETE"});if(!$e.ok){const We=await $e.json().catch(()=>({}));throw new Error(We.message||`Failed to delete ${ge}: ${$e.statusText}`)}o&&(ge==="Complaint"?lu(o):ge==="Lab Order"?(Ho(o),$i(o)):ge==="Lab Report"?$i(o):ge==="Pharmacy Order"&&ui(o))}catch($e){Lo(`Delete Error (${ge}): ${$e.message}`),Gs&&sr(!1)}finally{sr(!1)}},Yo=async()=>{if(!o)return;if(lt.filter(be=>be.status==="pending").length<2){alert("You need at least two pending orders to merge.");return}Pi(!0);try{const be=await pe(`/api/pharmacy-orders/patient/${o}/merge-pending`,{method:"POST"});if(!be.ok){const W=await be.json().catch(()=>({}));throw new Error(W.message||"Failed to merge orders")}ui(o)}catch(be){le(`Merge Error: ${be.message}`)}finally{Pi(!1)}},Wi=w.useMemo(()=>{if(!o||!Mt)return[];const he=Mt.map(be=>({date:new Date(be.createdAt),type:"Complaint",data:be,originalDateString:be.createdAt})).filter(be=>!isNaN(be.date.getTime()));return he.sort((be,W)=>W.date.getTime()-be.date.getTime()),he},[o,Mt]),zr=w.useMemo(()=>{if(!o)return[];const he=new Map;(Fa??[]).forEach(W=>{he.set(W.id,{...W})}),(xe??[]).forEach(W=>{if(!he.has(W.id))he.set(W.id,{id:W.id,patient_id:W.patient_id,tests:W.tests,status:W.status,createdAt:W.createdAt,report:W});else{const ue=he.get(W.id);ue&&(ue.report=W,ue.status=W.status)}});let be=Array.from(he.values());return be.sort((W,ue)=>new Date(W.createdAt).getTime()-new Date(ue.createdAt).getTime()),be=be.map((W,ue)=>({...W,serialNumber:ue+1})),be.map(W=>({date:new Date(W.createdAt),type:"Lab Order",data:W,originalDateString:W.createdAt}))},[o,Fa,xe]),zi=w.useMemo(()=>{if(!o||!lt)return[];const he=lt.map(be=>({date:new Date(be.date),type:"Pharmacy Order",data:be,originalDateString:be.date})).filter(be=>!isNaN(be.date.getTime()));return he.sort((be,W)=>W.date.getTime()-be.date.getTime()),he},[o,lt]),[du,Ql]=w.useState(null),[Jl,Wo]=w.useState([]),[Qo,Kl]=w.useState(""),ga=(he,be)=>{if(!he||!he.report_content||!be)return"";try{const W=JSON.parse(he.report_content||"{}");if(typeof W!="object"||W===null)return`<p class="italic text-gray-500 text-xs">Report content is not structured data.</p><pre>${he.report_content}</pre>`;let ue="";return be.forEach(ge=>{W[ge.id]?(ue+=`<h5 class="font-semibold text-sm mt-2 mb-1">${ge.name}</h5>`,ue+='<table class="lab-report-print-table"><thead><tr><th>Parameter</th><th>Value</th><th>Normal Range</th></tr></thead><tbody>',Object.entries(W[ge.id]).map(([$e,We])=>{var qt;const tt=(qt=ge.default_parameters)==null?void 0:qt.find(rl=>rl.name===$e);let Jt="N/A";tt&&tt.type==="number"&&(tt.lower_limit!=null||tt.upper_limit!=null)?(Jt="",tt.lower_limit!=null&&(Jt+=` > ${tt.lower_limit}`),tt.lower_limit!=null&&tt.upper_limit!=null&&(Jt+=" - "),tt.upper_limit!=null&&(Jt+=` < ${tt.upper_limit}`),Jt=Jt.trim()||"N/A"):(tt==null?void 0:tt.type)==="boolean"?Jt="N/A":tt!=null&&tt.normal_range&&(Jt=tt.normal_range),ue+=`<tr><td>${$e}</td><td>${String(We)} ${(tt==null?void 0:tt.unit)||""}</td><td>${Jt}</td></tr>`}),ue+="</tbody></table>"):ue+=`<p class="italic text-gray-500 text-xs">No parameters reported for ${ge.name}.</p>`}),ue}catch{return`<p class="italic text-gray-500 text-xs">Error parsing report content.</p><pre>${he.report_content}</pre>`}};w.useEffect(()=>{const he=()=>{Le(window.innerHeight)};return window.addEventListener("resize",he),he(),()=>window.removeEventListener("resize",he)},[]),w.useEffect(()=>{const he=W=>{if(!Ke||!Qe.current||!at.current)return;const ue=at.current.getBoundingClientRect(),$e=W.clientX-Qe.current.x;let We=Qe.current.initialWidth-$e;const tt=ue.width-yt-10;We=Math.max(yt,We),We=Math.min(We,tt);const Jt=We/ue.width*100;ze(Jt)},be=()=>{Fe(!1),Qe.current=null,document.body.style.cursor="",document.body.style.userSelect=""};return Ke&&(window.addEventListener("mousemove",he),window.addEventListener("mouseup",be),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{window.removeEventListener("mousemove",he),window.removeEventListener("mouseup",be),document.body.style.cursor="",document.body.style.userSelect=""}},[Ke]);const Jh=he=>{if(!at.current)return;he.preventDefault();const be=at.current.querySelector(".edit-complaint-context-column");be&&(Qe.current={x:he.clientX,initialWidth:be.offsetWidth},Fe(!0))},fu=w.useCallback(async()=>{ee(!0),le(null);try{const he=await pe("/api/queue/doctor/new",{method:"POST"});if(!he.ok){const W=await he.json().catch(()=>({}));throw new Error(W.message||`Failed to create record: ${he.statusText}`)}const be=await he.json();if(!be.recordId)throw new Error("New record ID not received from server.");n(`/edit-complaint/${be.recordId}`,{replace:!0})}catch(he){le(`Failed to create new complaint record: ${he.message}`)}finally{ee(!1)}},[n]);w.useEffect(()=>{(async()=>{ms(!0);try{const be=await pe("/api/clinics/settings");if(!be.ok){const ue=await be.json().catch(()=>({}));throw new Error(ue.message||"Failed to fetch clinic settings.")}const W=await be.json();el({admissionCharge:parseFloat(W.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(W.perDayCharge||0).toFixed(2),otherCharges:parseFloat(W.otherCharges||0).toFixed(2),aiMemory:W.aiMemory||"",aiMemoryUpdatedAt:W.aiMemoryUpdatedAt||null,clinicWideSystemPrompt:W.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:W.clinicWideSystemPromptUpdatedAt||null,gemini_api_key:W.gemini_api_key||""}),ru(W.aiMemory||""),ps(W.clinicWideSystemPrompt||"")}catch{}finally{ms(!1)}})()},[]),w.useEffect(()=>{var be,W;(be=t.state)!=null&&be.patientId&&f(Number(t.state.patientId)),(W=t.state)!=null&&W.initialComplaint&&a(t.state.initialComplaint),e?(async ue=>{var ge;R(!0),le(null);try{const $e=await pe(`/api/queue/doctor/complaint/${ue}`);if(!$e.ok){const tt=await $e.json().catch(()=>({}));throw new Error(tt.message||`HTTP error! status: ${$e.status}`)}const We=await $e.json();f(tt=>tt===We.patientId?tt:We.patientId),g(We.age),v(We.gender),k(We.case_summary||null),q(We.updatedAt||null)}catch{le("Failed to load current complaint details."),(ge=t.state)!=null&&ge.patientId||f(null),g(void 0),v(void 0),k(null),q(null)}finally{R(!1)}})(e):fu()},[e,fu,(gu=t.state)==null?void 0:gu.initialComplaint,(ec=t.state)==null?void 0:ec.patientId]),w.useEffect(()=>{o?Gh(o):(d(null),_t([]),Xe([]),Gi([]),Me([]),q(null),Js(!1))},[o]),w.useEffect(()=>{var W;const he=(W=t.state)==null?void 0:W.initialComplaint;he&&e&&(!O&&!an&&!Hs&&!ve&&!un)&&!Be.current&&r===he&&(Be.current=!0,ya(),n(t.pathname,{replace:!0,state:{}}))},[(Kd=t.state)==null?void 0:Kd.initialComplaint,e,r,O,an,Hs,ve,un,n]);const Qi=()=>{P(N||""),E(!0),B(null)},Jo=()=>{E(!1),P(""),B(null)},tl=async()=>{if(!e){B("Missing Record ID.");return}F(!0),B(null);try{const he=await pe(`/api/queue/doctor/complaint/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:I.trim()})});if(!he.ok){const W=await he.json().catch(()=>({}));throw new Error(W.message||`Failed to save case summary: ${he.statusText}`)}const be=await he.json();k(be.case_summary||I.trim()),q(be.updatedAt||null),E(!1)}catch(he){B(`Save Error: ${he.message}`)}finally{F(!1)}};w.useEffect(()=>{(async()=>{Ni(!0),ar(null);try{const[be,W]=await Promise.all([pe("/api/drugs"),pe("/api/lab-tests")]);if(!be.ok)throw new Error(`Pharmacy inventory error! status: ${be.status}`);const ue=await be.json();if(On(ue||[]),!W.ok)throw new Error(`Lab inventory error! status: ${W.status}`);const ge=await W.json();mn(ge||[])}catch(be){ar(be.message)}finally{Ni(!1)}})()},[]);const nl=async()=>{if(!Qt)return;if(Ba===Qt.aiMemory&&Ua===Qt.clinicWideSystemPrompt){Ii(!1);return}const he=Ba!==Qt.aiMemory,be=Ua!==Qt.clinicWideSystemPrompt;he&&au(!0),be&&su(!0);try{const W={...Qt};he&&(W.aiMemory=Ba),be&&(W.clinicWideSystemPrompt=Ua);const ue=await pe("/api/clinics/settings",{method:"PUT",body:JSON.stringify(W)});if(!ue.ok){const $e=await ue.json().catch(()=>({}));throw new Error($e.message||"Failed to update clinic settings.")}const ge=await ue.json();el({admissionCharge:parseFloat(ge.settings.admissionCharge).toFixed(2),perDayCharge:parseFloat(ge.settings.perDayCharge).toFixed(2),otherCharges:parseFloat(ge.settings.otherCharges).toFixed(2),aiMemory:ge.settings.aiMemory||"",aiMemoryUpdatedAt:ge.settings.aiMemoryUpdatedAt||(Qt==null?void 0:Qt.aiMemoryUpdatedAt)||null,clinicWideSystemPrompt:ge.settings.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:ge.settings.clinicWideSystemPromptUpdatedAt||(Qt==null?void 0:Qt.clinicWideSystemPromptUpdatedAt)||null}),he&&ru(ge.settings.aiMemory||""),be&&(ps(ge.settings.clinicWideSystemPrompt||""),Ii(!1))}catch{}finally{he&&au(!1),be&&su(!1)}},il=()=>{Qt&&(ps(Qt.clinicWideSystemPrompt||""),Ii(!0))},Kh=()=>{Ii(!1),Qt&&ps(Qt.clinicWideSystemPrompt||"")},ya=async he=>{const be=he??r;Vo.current&&await Vo.current.callGenerativeApi(be)},Wd=he=>{navigator.clipboard.writeText(he).then(()=>{}).catch(be=>{console.error("Failed to copy text: ",be)})},Ko=(he,be)=>{const W=window.open("","_blank");W&&(W.document.write(`
        <html>
          <head>
            <title>${be}</title>
            <style>
              body { font-family: sans-serif; margin: 20px; }
              h2 { text-align: center; margin-bottom: 20px; }
              table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
              th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
              th { background-color: #f2f2f2; }
              pre { white-space: pre-wrap; word-wrap: break-word; }
              .ai-context-section { margin-bottom: 20px; border: 1px solid #eee; padding: 15px; border-radius: 5px; }
              .ai-context-section-title { font-size: 1.1em; font-weight: bold; margin-bottom: 10px; color: #333; }
              .ai-context-text { margin-bottom: 5px; }
              .text-gray-400 { color: #999; }
              .font-semibold { font-weight: 600; }
              .italic { font-style: italic; }
              .mt-2 { margin-top: 8px; }
              .ml-1 { margin-left: 4px; }
              .ml-2 { margin-left: 8px; }
              .flex { display: flex; }
              .flex-col { flex-direction: column; }
              .w-full { width: 100%; }
              .text-xs { font-size: 0.75rem; }
              .text-sm { font-size: 0.875rem; }
              .prose { max-width: 65ch; }
              .prose table { display: table; } /* Ensure tables in markdown render correctly */
            </style>
          </head>
          <body>
            <h2>${be}</h2>
            <div id="print-content">${he}</div>
          </body>
        </html>
      `),W.document.close(),W.print())},hu=()=>{if(K){const he=RK().use(Co).use(YZ).processSync(J).toString();Ko(`<div class="prose">${he}</div>`,"AI Response")}};w.useEffect(()=>{if(u){let he=`
        <div class="print-section">
          <h3>Patient Details</h3>
          <p><strong>Name:</strong> ${u.name||"N/A"}</p>
          <p><strong>Token:</strong> ${u.patient_token_number||"N/A"}</p>
          <p><strong>Age:</strong> ${u.age||"N/A"}</p>
          <p><strong>Gender:</strong> ${u.gender||"N/A"}</p>
          <p><strong>Phone:</strong> ${u.phone||"N/A"}</p>
          <p><strong>Insurance:</strong> ${u.insurance_type||"N/A"}</p>
          <p><strong>Status:</strong> ${u.current_status||"N/A"}</p>
          <p><strong>Admitted:</strong> ${u.admission_date?new Date(u.admission_date).toLocaleDateString():"N/A"}</p>
          <p><strong>Discharged:</strong> ${u.discharge_date?new Date(u.discharge_date).toLocaleDateString():"N/A"}</p>
        </div>
        <div class="print-section">
          <h3>Case Summary</h3>
          <p>${N||"No summary available."}</p>
        </div>
        <div class="print-section">
          <h3>Complaints History</h3>
          ${Wi.length>0?`
            <ul>
              ${Wi.map(be=>`<li>${new Date(be.originalDateString).toLocaleDateString()}: ${be.data.complaint}</li>`).join("")}
            </ul>
          `:"<p>No past complaints.</p>"}
        </div>
        <div class="print-section">
          <h3>Pharmacy Orders</h3>
          ${zi.length>0?`
            <table class="print-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Status</th>
                  <th>Drug Name</th>
                  <th>Quantity</th>
                  <th>Dosage</th>
                  <th>Directions</th>
                </tr>
              </thead>
              <tbody>
                ${zi.map(be=>be.data.medications.map((W,ue)=>`
                    <tr>
                      ${ue===0?`<td rowspan="${be.data.medications.length}">${new Date(be.originalDateString).toLocaleDateString()}</td>`:""}
                      ${ue===0?`<td rowspan="${be.data.medications.length}">${be.data.status}</td>`:""}
                      <td><strong>${W.name}</strong></td>
                      <td>
                        ${W.pack_quantity!==void 0&&W.pack_quantity>0?`Packs: ${W.pack_quantity}`:""}
                        ${W.pack_quantity!==void 0&&W.pack_quantity>0&&W.loose_quantity!==void 0&&W.loose_quantity>0?", ":""}
                        ${W.loose_quantity!==void 0&&W.loose_quantity>0?`Loose: ${W.loose_quantity}`:""}
                      </td>
                      <td>${W.tabletsPerDay&&W.numberOfDays?`${W.tabletsPerDay} tab/day for ${W.numberOfDays} days`:"N/A"}</td>
                      <td>${W.directions_to_use||"N/A"}</td>
                    </tr>
                  `).join("")).join("")}
              </tbody>
            </table>
          `:"<p>No pharmacy orders.</p>"}
        </div>
        <div class="print-section">
          <h3>Lab History (Orders & Reports)</h3>
          ${zr.length>0?`
            ${zr.map(be=>{const W=be.data.tests.map(ge=>ge.name).join(", ");let ue="";return be.data.report&&(ue=`
                  <div class="lab-report-print-container">
                    <h4>Lab Report (${new Date(be.data.report.report_date).toLocaleDateString()})</h4>
                    ${ga(be.data.report,be.data.report.tests)}
                  </div>
                `),`
                <div class="lab-history-item">
                  <p><strong>Order Date:</strong> ${new Date(be.originalDateString).toLocaleDateString()}</p>
                  <p><strong>Status:</strong> ${be.data.status}</p>
                  <p><strong>Tests:</strong> ${W}</p>
                  ${ue}
                </div>
              `}).join("")}
          `:"<p>No lab history.</p>"}
        </div>
      `;Kl(he)}else Kl("")},[u,N,Wi,zi,zr,ga]);const qa=()=>{Qo&&Ko(Qo,`Patient Details - ${u==null?void 0:u.name}`)},Qd=he=>{a(he),Ql(null),Wo([]),setTimeout(()=>{ya(he)},0)},Br=O||de||re||G||Fi||Ys||Gs||cs||Or||Di||Ws||qo,Xo=()=>{a("reports came,please anaylse"),setTimeout(()=>{ya()},0)},pu=he=>{eu(be=>({...be,[he]:!be[he]}))},Va=he=>{he.key==="Enter"&&!he.shiftKey&&(he.preventDefault(),!Br&&!un&&!G&&r.trim()&&e&&ya())};w.useEffect(()=>{const he=window.SpeechRecognition||window.webkitSpeechRecognition;if(!he){fs("Speech recognition not supported in this browser.");return}const be=new he;return be.continuous=!0,be.interimResults=!0,be.lang="en-US",be.onresult=W=>{let ue="";for(let ge=W.resultIndex;ge<W.results.length;++ge)W.results[ge].isFinal&&(ue+=W.results[ge][0].transcript);ue&&a(ge=>ge+(ge.endsWith(" ")||ge===""?"":" ")+ue)},be.onerror=W=>{fs(`Speech error: ${W.error}`),Hl(!1)},be.onend=()=>{},lr.current=be,()=>{lr.current&&lr.current.stop()}},[]);const Zo=async()=>{if(o)if(us){iu(!0);try{const he=await pe(`/api/patients/${o}/discharge`,{method:"POST"});if(!he.ok){const be=await he.json().catch(()=>({}));throw new Error(be.message||`Failed to discharge patient: ${he.status}`)}gs(o)}catch(he){le(`Discharge Error: ${he.message}`)}finally{iu(!1)}}else{Fo(!0);try{const he=await pe(`/api/patients/${o}/admit`,{method:"POST"});if(!he.ok){const be=await he.json().catch(()=>({}));throw new Error(be.message||`Failed to admit patient: ${he.status}`)}gs(o)}catch(he){le(`Admit Error: ${he.message}`)}finally{Fo(!1)}}},Xh=async he=>{if(o){zl(!0);try{const W=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:o})});if(!W.ok){const ue=await W.json().catch(()=>({}));throw new Error(ue.message||`Failed to add patient to ${he} queue: ${W.status}`)}alert(`Patient added to ${he} queue successfully!`),o&&(gs(o),Yl(o))}catch(be){le(`Add to Queue Error: ${be.message}`)}finally{zl(!1)}}},Zh=async()=>{if(e){Qs(!0),le(null);try{const he=await pe(`/api/queue/${e}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"seen"})});if(!he.ok){const be=await he.json().catch(()=>({}));throw new Error(be.message||"Failed to complete consultation")}alert("Consultation completed successfully!"),o&&(gs(o),Yl(o))}catch(he){le(`Error completing consultation: ${he.message}`)}finally{Qs(!1)}}},Ji=async()=>{if(!o){ha("Missing Patient ID.");return}if(!u){ha("Patient details not loaded.");return}za(!0),ha(null);try{const he={};let be=!1;if(Bl!==u.name&&(he.name=Bl,be=!0),ql!==u.age&&(he.age=ql,be=!0),zo!==u.gender&&(he.gender=zo,be=!0),Ks!==u.phone&&(he.phone=Ks,be=!0),!be){ha("No changes detected."),za(!1),fa(!1);return}const W=await pe(`/api/patients/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(he)});if(!W.ok){const ge=await W.json().catch(()=>({}));throw new Error(ge.message||`Failed to update patient details: ${W.statusText}`)}const ue=await W.json();d(ue),g(ue.age),v(ue.gender),Ul(ue.name),$o(ue.age),ds(ue.gender),Vl(ue.phone),fa(!1)}catch(he){ha(`Save Error: ${he.message}`)}finally{za(!1)}},Ur=w.useCallback(()=>{if(!u)return null;const he={token_number:u.patient_token_number||"N/A",name:u.name||"N/A",age:u.age||"N/A",gender:u.gender||"N/A",phone:u.phone||"N/A"};return Wi.length>0?he.complaints_history=Wi.map(be=>`${be.data.complaint} (${new Date(be.originalDateString).toLocaleDateString()})`).join("; "):he.complaints_history="No past complaints.",zi.length>0?he.pharmacy_orders_history=zi.map(be=>`Order: ${be.data.medications.map(ue=>{let ge=`${ue.name}`;return ue.pack_quantity!==void 0&&ue.pack_quantity>0&&(ge+=` Packs: ${ue.pack_quantity}`),ue.loose_quantity!==void 0&&ue.loose_quantity>0&&(ge+=` Loose: ${ue.loose_quantity}`),ge}).join(", ")} (${be.data.status}, ${new Date(be.originalDateString).toLocaleDateString()})`).join("; "):he.pharmacy_orders_history="No pharmacy orders.",zr.length>0?he.lab_orders_history=zr.map(be=>{let ue=`Lab Order: ${be.data.tests.map(ge=>ge.name).join(", ")} (${be.data.status}, ${new Date(be.originalDateString).toLocaleDateString()})`;return be.data.report&&(ue+=` - Report: ${be.data.report.report_content} (${new Date(be.data.report.report_date).toLocaleDateString()})`),ue}).join("; "):he.lab_orders_history="No lab history.",he},[u,Wi,zi,zr]),or=()=>{if(!u){fs("Patient details are required to use the Live API.");return}ln(!0)},mu=()=>{var he;(he=hs.current)==null||he.click()},Jd=he=>{var W;const be=(W=he.target.files)==null?void 0:W[0];be&&Uo(be)};return i.jsxs("div",{className:"edit-complaint-page",style:{height:`${Je}px`},children:[i.jsx(eW,{ref:Vo,recordId:e,patientId:o,patientDetails:u,caseSummary:N,caseSummaryUpdatedAt:z,clinicSettings:Qt,userMessages:l,selectedImageFile:Fr,pendingLabOrders:Fa,labReports:xe,pastComplaints:Mt,pharmacyOrders:lt,pharmacyInventory:Un,labInventory:Cn,setCurrentComplaint:a,setAiResponse:U,setAiResponseText:ne,setAiResponseJsonString:ae,setShowAiJsonDetails:M,setIsLoadingAi:Se,setAiError:we,setIsSubmittingAiOrder:kr,setAiOrderSubmissionStatus:Kn,setIsSubmittingAiLabOrder:La,setAiLabOrderSubmissionStatus:Vh,setIsSubmittingAiComplaint:Bd,setAiComplaintSubmissionStatus:Zc,setIsUpdatingCaseSummary:qs,setAiCaseSummaryUpdateStatus:Vs,setCaseSummary:k,setCaseSummaryUpdatedAt:q,setIsUpdatingAiMemoryByAI:Ud,setAiMemoryUpdateByAIStatus:os,setFollowUpQuestion:Ql,setFollowUpOptions:Wo,setError:le,setIsSavingAiResponse:_e,setSaveAiResponseError:et,fetchPharmacyOrdersData:ui,fetchPendingLabOrdersData:Ho,fetchLabReportsData:$i,fetchPastComplaintsData:lu,fetchPatientDetails:gs,setClinicSettings:el,setEditedAiMemory:ru,handleDeleteItem:Wl}),gn&&u&&i.jsx(nk,{onClose:()=>ln(!1),patientData:Ur(),tokenNumber:u.patient_token_number?String(u.patient_token_number):null,onAiSummaryChange:he=>{he&&(a(he),ya(he),ln(!1))}}),i.jsxs("div",{className:"edit-complaint-header",children:[i.jsx("button",{onClick:()=>n(-1),disabled:Br,className:"back-button",title:"Go Back",children:i.jsx(Lt,{size:18})}),i.jsx("span",{ref:pt,style:{position:"absolute",visibility:"hidden",height:"auto",width:"auto",whiteSpace:"nowrap"}}),O&&!u&&i.jsx("div",{className:"edit-complaint-patient-details skeleton",style:{width:"300px",height:"2.5rem"}}),u&&i.jsx("div",{className:"edit-complaint-patient-details",children:u&&!da?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>{fa(!0),Ul(u.name||""),$o(u.age),ds(u.gender),Vl(u.phone),ha(null)},className:"edit-button mr-2",title:"Edit Patient Details",disabled:Fi,children:i.jsx(_d,{size:14})}),u.name??"N/A",u.patient_token_number!==null&&u.patient_token_number!==void 0&&` (${u.patient_token_number})`," - ",u.age??"N/A"," / ",u.gender??"N/A",u.phone&&` / ${u.phone}`]}):u&&da?i.jsxs("div",{className:"patient-details-edit-form",children:[i.jsx("input",{type:"text",value:Bl,onChange:he=>Ul(he.target.value),placeholder:"Name",className:"edit-input",disabled:Fi}),i.jsx("input",{type:"number",value:ql??"",onChange:he=>$o(he.target.value?parseInt(he.target.value):null),placeholder:"Age",className:"edit-input",disabled:Fi}),i.jsxs("select",{value:zo??"",onChange:he=>ds(he.target.value||null),className:"edit-input",disabled:Fi,children:[i.jsx("option",{value:"",children:"Select Gender"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]}),i.jsx("input",{type:"text",value:Ks??"",onChange:he=>Vl(he.target.value||null),placeholder:"Phone Number",className:"edit-input",disabled:Fi}),i.jsxs("div",{className:"edit-actions",children:[i.jsx("button",{onClick:()=>{fa(!1),ha(null)},className:"button-secondary",disabled:Fi,children:"Cancel"}),i.jsx("button",{onClick:Ji,className:"button-primary blue",disabled:Fi,children:Fi?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),"Saving..."]}):"Save"})]}),Bo&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:Bo})]}):i.jsxs("div",{className:"edit-complaint-patient-details",children:[h??"N/A"," / ",b??"N/A"]})}),!u&&h!==void 0&&b!==void 0&&i.jsxs("div",{className:"edit-complaint-patient-details",children:[h??"N/A"," / ",b??"N/A"]}),i.jsx("div",{style:{width:"64px"}})]}),i.jsxs("div",{className:"edit-complaint-content-area",ref:at,children:[i.jsxs("div",{className:"edit-complaint-main-column",style:{flexBasis:`calc(${100-dt}% - 5px)`},children:[te&&i.jsxs("div",{className:"general-error-message",children:["Error: ",te]}),G&&i.jsx("div",{className:"ai-function-status info text-center",children:"Creating record..."}),de&&i.jsxs("div",{className:"loading-animation-container",children:[i.jsx("div",{className:"spinner"}),i.jsx("div",{className:"loading-text loading-dots",children:Hd})]}),fe&&i.jsx("div",{className:"ai-error-message",children:fe}),ni&&i.jsxs("div",{className:`ai-function-status ${ni.toLowerCase().includes("error:")?"error":ni.toLowerCase().startsWith("order created")||ni.toLowerCase().startsWith("success:")?"success":"info"}`,children:[oa&&i.jsx("span",{className:"animate-spin",role:"status"}),ni]}),ss&&i.jsxs("div",{className:`ai-function-status ${ss.toLowerCase().includes("error:")?"error":ss.toLowerCase().startsWith("success:")||ss.toLowerCase().startsWith("lab order created")?"success":"info"}`,children:[Fn&&i.jsx("span",{className:"animate-spin",role:"status"}),ss]}),ls&&i.jsxs("div",{className:`ai-function-status ${ls.toLowerCase().includes("error:")?"error":"info"}`,children:[Hh&&i.jsx("span",{className:"animate-spin",role:"status"}),ls]}),Oa&&i.jsxs("div",{className:`ai-function-status ${Oa.toLowerCase().includes("error:")?"error":"info"}`,children:[Us&&i.jsx("span",{className:"animate-spin",role:"status"}),Oa]}),Ro&&i.jsxs("div",{className:`ai-function-status ${Ro.toLowerCase().includes("error:")?"error":"info"}`,children:[ci&&i.jsx("span",{className:"animate-spin",role:"status"}),Ro]}),qe&&i.jsxs("div",{className:"general-error-message",children:["Error saving AI response: ",qe]}),re&&i.jsx("div",{className:"ai-function-status info text-center",children:"Saving AI response..."}),(J||A)&&i.jsxs("div",{ref:je,className:`${A?"ai-function-call-block":"ai-response-container"} group`,children:[J&&i.jsx(Bc,{remarkPlugins:[Co],children:J}),A&&i.jsxs("div",{className:"ai-json-details-container",children:[i.jsxs("button",{onClick:()=>M(!ce),className:"ai-json-toggle-button",children:[ce?i.jsx(Bv,{size:14,className:"mr-1"}):i.jsx(Hx,{size:14,className:"mr-1"}),ce?"Hide":"Show"," AI Function Call Details"]}),ce&&i.jsx("pre",{className:"ai-json-pre",children:i.jsx("code",{children:JSON.stringify(JSON.parse(A),null,2)})})]}),i.jsxs("div",{className:"ai-response-actions",children:[i.jsx("button",{onClick:()=>Wd(K),disabled:!K,title:"Copy Full AI Response",children:i.jsx(VP,{size:12})}),i.jsx("button",{onClick:hu,disabled:!K,title:"Print AI Response",children:i.jsx(Rs,{size:12})})]})]})]}),i.jsx("div",{className:"draggable-divider",onMouseDown:Jh}),i.jsx("div",{className:"edit-complaint-context-column",style:{flexBasis:`calc(${100-dt}% - 5px)`},children:i.jsxs("div",{className:"ai-context-container",children:[i.jsxs("h3",{className:"ai-context-header",children:[i.jsx("span",{children:"AI Context:"}),i.jsx("div",{className:"ai-context-actions-top",children:i.jsxs("button",{onClick:qa,disabled:!Qo,title:"Print All Patient Details",className:"context-action-button",children:[i.jsx(Rs,{size:14})," Print"]})}),(u==null?void 0:u.insurance_type)&&i.jsx("div",{className:"insurance-type-container mt-2",children:i.jsxs("select",{ref:st,value:u.insurance_type,onChange:he=>Gd(u.id,he.target.value),className:"insurance-type-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"insurance",children:"Insurance"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})})]}),i.jsxs("div",{className:"ai-context-section",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Admission Status"}),O&&!u?i.jsxs("div",{className:"space-y-2 mt-2",children:[i.jsx("div",{className:"skeleton-text"}),i.jsx("div",{className:"skeleton-text short"})]}):i.jsxs(i.Fragment,{children:[(u==null?void 0:u.admission_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Admitted:"})," ",new Date(u.admission_date).toLocaleDateString()]}),(u==null?void 0:u.discharge_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Discharged:"})," ",new Date(u.discharge_date).toLocaleDateString()]}),(u==null?void 0:u.current_status)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Current Status:"})," ",i.jsx("span",{className:"font-semibold",children:u.current_status})]}),i.jsxs("div",{className:"flex space-x-2 mt-2",children:[i.jsxs("button",{onClick:Zo,className:`admit-discharge-button ${us?"discharge":"admit"}`,title:us?"Discharge Patient":"Admit Patient",disabled:!o||cs||Or,children:[(cs||Or)&&i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),cs?"Admitting...":Or?"Discharging...":us?"Discharge":"Admit"]}),i.jsxs("button",{onClick:()=>Xh("doctor"),className:`queue-status-button ${ua?"in-queue":"add-to-queue"}`,title:ua?"Patient is in Doctor Queue":"Add Patient to Doctor Queue",disabled:!o||Di||ua,children:[Di&&i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),Di?"Adding...":ua?"In Queue":"Add to Queue"]}),i.jsxs("button",{onClick:Zh,className:"complete-consultation-button",title:"Mark Consultation as Complete",disabled:Ws,children:[Ws&&i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),Ws?"Completing...":"Complete Consultation"]})]})]})]}),i.jsx(wv,{title:"Pharmacy Order History",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:Yo,className:"button-primary blue text-xs px-2 py-1",disabled:qo||lt.filter(he=>he.status==="pending").length<2,title:"Merge all pending orders into one",children:qo?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),"Merging..."]}):"Merge Orders"}),i.jsxs("button",{onClick:()=>Oi(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new pharmacy order",disabled:!o,children:[i.jsx(Ao,{size:12,className:"mr-1"})," Add Pharmacy Order"]})]}),items:zi,onMarkAsRecurring:In,isLoading:O,loadingText:"Loading...",noDataText:"No orders.",renderItemContent:(he,be)=>i.jsxs("div",{className:"flex flex-col w-full",children:[i.jsxs("span",{className:"ai-context-text flex items-center",children:[" ",zi.length-be,". Order Status: (",he.data.status,")",i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(he.originalDateString).toLocaleDateString(),")"]}),i.jsxs("div",{className:"inline-flex space-x-2 ml-2",children:[" ",i.jsx("button",{onClick:()=>$r(he.data.id),className:"icon-button small",title:"Edit Pharmacy Order",children:i.jsx(_d,{size:12})}),he.data.prescriptionForUnavailableDrugs&&i.jsx("button",{onClick:()=>Ko(he.data.prescriptionForUnavailableDrugs,"Unavailable Drugs Prescription"),className:"icon-button small",title:"Print Unavailable Drugs Prescription",children:i.jsx(Rs,{size:12})}),i.jsx("button",{onClick:()=>Wl({type:"Pharmacy Order",data:he.data}),className:"icon-button small text-red-500",title:"Delete Pharmacy Order",children:i.jsx(Ri,{size:12})}),he.data.status==="pending"&&i.jsx("button",{onClick:()=>Go(he.data.id),className:"icon-button small",title:"Bill this pharmacy order",disabled:Ys,children:i.jsx(Ad,{size:12})}),he.data.status==="billed"&&i.jsx("button",{onClick:()=>ou(he.data.id,"dispensed"),className:"icon-button small",title:"Dispense this pharmacy order",disabled:Ys,children:i.jsx(Ra,{size:12})}),he.data.status==="dispensed"&&i.jsx("button",{onClick:async()=>{var W;try{const ue=await pe(`/api/bills?patientId=${he.data.patientId}`);if(!ue.ok)throw new Error("Failed to fetch bills");const $e=(W=(await ue.json()).bills)==null?void 0:W.find(We=>We.related_id===he.data.id&&We.type==="pharmacy");$e?n(`/dashboard/bills/${$e.id}`):alert("Bill not found for this order.")}catch(ue){console.error("Error fetching bill:",ue),alert("Failed to fetch bill. Please try again.")}},className:"icon-button small",title:"View Bill",children:i.jsx(__,{size:12})})]})]}),i.jsx("div",{className:"pharmacy-order-drugs-table-container mt-2",children:i.jsxs("table",{className:"pharmacy-order-drugs-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2 text-left",children:"Drug Name"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Quantity"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Dosage"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Directions"})]})}),i.jsx("tbody",{children:he.data.medications.map((W,ue)=>i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:i.jsx("strong",{children:W.name})}),i.jsxs("td",{className:"py-1 px-2",children:[W.pack_quantity!==void 0&&W.pack_quantity>0&&`Packs: ${W.pack_quantity}`,W.pack_quantity!==void 0&&W.pack_quantity>0&&W.loose_quantity!==void 0&&W.loose_quantity>0&&", ",W.loose_quantity!==void 0&&W.loose_quantity>0&&`Loose: ${W.loose_quantity}`]}),i.jsx("td",{className:"py-1 px-2",children:W.tabletsPerDay&&W.numberOfDays?`${W.tabletsPerDay} tab/day for ${W.numberOfDays} days`:"N/A"}),i.jsx("td",{className:"py-1 px-2",children:W.directions_to_use||"N/A"})]},W.drug_id||W.name||ue))})]})}),he.data.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[i.jsx("span",{className:"font-semibold",children:"Prescription:"})," ",he.data.prescriptionForUnavailableDrugs]})]})}),i.jsx(WY,{isOpen:nu,onClose:()=>Oi(!1),patientId:o,pharmacyInventory:Un,fetchPharmacyOrdersData:ui}),i.jsx(wv,{title:"Lab History (Orders & Reports)",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:Xo,className:"button-primary blue text-xs px-2 py-1",title:"Tell AI to analyse the reports",disabled:Br,children:"Analyse Reports"}),i.jsxs("button",{onClick:()=>Vd(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new lab order",disabled:!o,children:[i.jsx(Ao,{size:12,className:"mr-1"})," Create Lab Order"]})]}),items:zr,onSaveLabOrder:Qh,onCancelEditLabOrder:cu,onLabOrderTestChange:Yh,onLabOrderStatusChange:uu,onBillLabOrder:Wh,labInventory:Cn,isSavingLabOrder:Ys,isLoading:Hs||ve,loadingText:"Loading...",noDataText:"No lab Hx.",expandedLabReports:ca,toggleLabReport:pu,renderItemContent:(he,be)=>{const W=qG(he.data.report?he.data.report.status:he.data.status);return i.jsxs("div",{className:"ai-context-text",children:[i.jsxs("span",{onClick:()=>Yd(he.data),style:{cursor:"pointer"},className:"hover:text-blue-600",title:"Click to open lab report",children:[he.data.serialNumber,". ",i.jsx("span",{className:"font-medium",children:"[Order]"})," ",he.data.tests&&he.data.tests.length>0?he.data.tests.map(ue=>i.jsxs("strong",{children:[ue.name," (",ue.price,")"]},ue.id||ue.name)).reduce((ue,ge)=>[ue,", ",ge]):i.jsx("span",{className:"italic text-gray-500",children:"No tests specified"})," ",he.data.tests&&he.data.tests.length>0&&i.jsxs("span",{className:"font-bold ml-2",children:["Total: ",he.data.tests.reduce((ue,ge)=>ue+(Number(ge.price)||0),0).toFixed(2)]}),"(",i.jsx("span",{className:W.className,children:W.text}),")",i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(he.originalDateString).toLocaleDateString(),")"]})]}),i.jsxs("div",{className:"inline-flex space-x-2 ml-2",children:[i.jsx("button",{onClick:()=>Yd(he.data),className:"icon-button small",title:"Manage Lab Report",children:i.jsx(rs,{size:12})}),i.jsx("button",{onClick:()=>ma(he.data.id),className:"icon-button small",title:"Edit Order Details",children:i.jsx(_d,{size:12})}),i.jsx("button",{onClick:()=>Wl({type:"Lab Order",data:he.data}),className:"icon-button small text-red-500",title:"Delete Lab Order",children:i.jsx(Ri,{size:12})})]}),he.data.report&&i.jsxs("div",{className:"ml-4 mt-1 p-2 border-l-2 border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-medium",children:"[Report]"}),i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(he.data.report.report_date).toLocaleDateString(),")"]}),i.jsx("button",{onClick:()=>pu(he.data.report.reportId),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:ca[he.data.report.reportId]?"Collapse Report":"Expand Report",children:ca[he.data.report.reportId]?i.jsx(Bv,{size:14}):i.jsx(Hx,{size:14})})]}),ca[he.data.report.reportId]&&(()=>{try{const ue=JSON.parse(he.data.report.report_content||"{}");return typeof ue=="object"&&ue!==null&&he.data.report.tests?he.data.report.tests.map(ge=>i.jsxs("div",{style:{marginBottom:"10px"},children:[i.jsx("h5",{className:"font-semibold text-sm mt-2 mb-1",children:ge.name}),ue[ge.id]?i.jsxs("table",{className:"lab-inventory-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2",children:"Parameter"}),i.jsx("th",{className:"py-1 px-2",children:"Value"}),i.jsx("th",{className:"py-1 px-2",children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(ue[ge.id]).map(([$e,We])=>{var yu;const tt=(yu=ge.default_parameters)==null?void 0:yu.find(di=>di.name===$e),Jt=typeof We=="string"?parseFloat(We):typeof We=="number"?We:NaN,qt=(tt==null?void 0:tt.type)==="number"&&!isNaN(Jt)&&We!==""&&We!==null&&We!==void 0&&(tt.lower_limit!=null&&Jt<tt.lower_limit||tt.upper_limit!=null&&Jt>tt.upper_limit),rl=(tt==null?void 0:tt.type)==="boolean"&&(We===!0||We==="true");return i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:$e}),i.jsxs("td",{className:`py-1 px-2 ${qt?"abnormal-result":""} ${rl?"reactive-result":""}`,children:[String(We)," ",(tt==null?void 0:tt.unit)||""]}),i.jsx("td",{className:"py-1 px-2",children:(()=>{if(tt&&tt.type==="number"&&(tt.lower_limit!=null||tt.upper_limit!=null)){let di="";return tt.lower_limit!=null&&(di+=` > ${tt.lower_limit}`),tt.lower_limit!=null&&tt.upper_limit!=null&&(di+=" - "),tt.upper_limit!=null&&(di+=` < ${tt.upper_limit}`),di.trim()||"N/A"}else if((tt==null?void 0:tt.type)==="boolean")return"Non-Reactive";return(tt==null?void 0:tt.normal_range)||"N/A"})()})]},$e)})})]}):i.jsx("p",{className:"italic text-gray-500 text-xs",children:"No parameters reported for this test."})]},ge.id)):i.jsx(Bc,{remarkPlugins:[Co],children:he.data.report.report_content})}catch{return i.jsx(Bc,{remarkPlugins:[Co],children:he.data.report.report_content||"*No findings recorded.*"})}})()]})]})}}),i.jsx(gY,{isOpen:tu,onClose:()=>Vd(!1),patientId:o,labInventory:Cn,fetchPendingLabOrdersData:Ho}),i.jsx(wv,{title:"Complaints History",items:Wi,isLoading:an,loadingText:"Loading...",noDataText:"No past Hx.",renderItemContent:(he,be)=>i.jsxs("span",{className:"ai-context-text",children:[he.data.complaint,i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(he.originalDateString).toLocaleDateString(),")"]})]}),onDeleteItem:Wl}),i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("h4",{className:"ai-context-section-title",children:[i.jsx(ag,{size:16,className:"text-purple-600"})," Clinic-wide System Prompt"]}),!Gl&&i.jsx("button",{onClick:il,className:"edit-button",title:"Edit System Prompt",disabled:Xn||Yi||pa,children:i.jsx(_d,{size:14})})]}),Gl&&Qt?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:Ua,onChange:he=>ps(he.target.value),className:"context-edit-textarea",placeholder:"Enter clinic system prompt...",disabled:Yi||pa}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:Kh,disabled:Yi||pa,className:"button-secondary",children:"Cancel"}),i.jsxs("button",{onClick:nl,disabled:Yi||pa||Ba===Qt.aiMemory&&Ua===Qt.clinicWideSystemPrompt,className:"button-primary purple",children:[pa||Yi?i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}):i.jsx(Id,{size:14,className:"mr-1"}),pa||Yi?"Saving...":"Save Settings"]})]})]}):i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:Qt!=null&&Qt.clinicWideSystemPrompt?i.jsx(Bc,{remarkPlugins:[Co],children:Qt.clinicWideSystemPrompt}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),!Gl&&(Qt==null?void 0:Qt.clinicWideSystemPromptUpdatedAt)&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Prompt Last Updated: ",new Date(Qt.clinicWideSystemPromptUpdatedAt).toLocaleDateString()]})]}),i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Case Summary"}),!T&&i.jsx("button",{onClick:Qi,className:"edit-button",title:"Edit Case Summary",disabled:O||V,children:i.jsx(_d,{size:14})})]}),T?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:I,onChange:he=>P(he.target.value),className:"context-edit-textarea",rows:4,placeholder:"Enter case summary...",disabled:V}),$&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:$}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:Jo,disabled:V,className:"button-secondary",children:"Cancel"}),i.jsx("button",{onClick:tl,disabled:V||I===N,className:"button-primary blue",children:V?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),"Saving..."]}):"Save"})]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:N?i.jsx(Bc,{remarkPlugins:[Co],components:{},children:N}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),z&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Last Edited: ",new Date(z).toLocaleDateString()]})]})]}),Wi.length===0&&zr.length===0&&zi.length===0&&!(an||Hs||ve)&&i.jsx("p",{className:"ai-context-text italic mt-4",children:"No recent history for this patient."}),Gs&&i.jsx("p",{className:"text-yellow-600 text-xs mt-2 ai-context-text",children:"Deleting..."}),$l&&i.jsx("p",{className:"text-red-600 text-xs mt-2 ai-context-text",children:$l})]})})]}),i.jsxs("div",{className:"edit-complaint-input-area",children:[i.jsxs("div",{className:"status-messages-container",children:[De&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:De}),an&&i.jsx("div",{className:"loading-animation-container",children:i.jsx("div",{className:"loading-text",children:"Loading past complaints..."})}),Q&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Q}),Hs&&i.jsx("div",{className:"loading-animation-container",children:i.jsx("div",{className:"loading-text",children:"Loading pending lab orders..."})}),qd&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:qd}),un&&i.jsx("div",{className:"loading-animation-container",children:i.jsx("div",{className:"loading-text",children:"Loading inventory..."})}),Hi&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Hi}),O&&i.jsx("div",{className:"loading-animation-container",children:i.jsx("div",{className:"loading-text",children:"Loading..."})})]}),e&&!G&&i.jsxs(w.Fragment,{children:[du&&i.jsxs("div",{className:"follow-up-question-container",children:[i.jsx("p",{className:"question-text",children:du}),Jl.length>0&&i.jsx("div",{className:"options-grid",children:Jl.map((he,be)=>i.jsx("button",{onClick:()=>Qd(he),className:"option-button",children:he},be))})]}),Zs&&i.jsx("div",{className:"speech-error-display",children:Zs}),Fr&&i.jsxs("div",{className:"selected-file-display",children:[i.jsxs("span",{children:["Selected: ",Fr.name]}),i.jsx("button",{onClick:()=>{Uo(null),hs.current&&(hs.current.value="")},className:"remove-file-button",title:"Remove image",children:""})]}),i.jsx("div",{className:"input-wrapper",children:i.jsxs("div",{className:"main-input-container",children:[i.jsx("input",{type:"file",ref:hs,onChange:Jd,accept:"image/*",className:"hidden"}),i.jsx("textarea",{ref:Ae,className:"complaint-textarea",value:r,onChange:he=>a(he.target.value),onKeyDown:Va,placeholder:"name,age,sex,phone,complaints,reports,history",disabled:Br||!e||Xs}),i.jsxs("div",{className:"chat-input-actions-container",children:[o&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>n(`/patient/${o}/lab-reports`),disabled:ve||!o,className:"icon-button",title:"View Lab Reports",children:i.jsx(rs,{size:14})}),i.jsx("button",{onClick:()=>n("/inventory"),disabled:un,className:"icon-button",title:"View Inventory",children:i.jsx(Pd,{size:14})})]}),i.jsx("button",{type:"button",onClick:mu,disabled:Br||!e||Xs,className:"icon-button",title:"Attach Image",children:i.jsx(SI,{size:14})}),i.jsx("button",{type:"button",onClick:or,disabled:Br||!e||!lr.current,className:`mic-button ${Xs?"listening":""}`,title:Xs?"Stop":"Mic",children:i.jsx(T_,{size:14})}),i.jsx("button",{onClick:()=>ya(),disabled:Br||un||G||!r.trim()||!e||Xs,className:"send-button",title:Br||un||G?"Processing...":"Save & Ask AI",children:Br?i.jsx("span",{className:"animate-spin",role:"status","aria-label":"loading"}):i.jsx(No,{size:14})})]})]})})]})]})]})},QZ=()=>{const{patientId:e}=jr(),n=gt(),[t,r]=w.useState([]),[a,l]=w.useState(null),[o,f]=w.useState(!1),[u,d]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){d("Patient ID not provided.");return}f(!0),d(null);try{const b=await pe(`/api/patients/${e}`);if(!b.ok)throw new Error(`Failed to fetch patient details: ${b.status}`);const v=await b.json();l({name:v.name,age:v.age,gender:v.gender});const N=await pe(`/api/patients/${e}/complaints`);if(N.ok){const T=(await N.json()).sort((E,I)=>new Date(I.createdAt).getTime()-new Date(E.createdAt).getTime());r(T)}else if(N.status===404)r([]);else throw new Error(`Failed to fetch complaints: ${N.status}`)}catch(b){console.error("Error fetching past complaints or patient info:",b),d(`Failed to load data. ${b.message}`),r([]),l(null)}finally{f(!1)}})()},[e]);const h=g=>{navigator.clipboard.writeText(g).then(()=>console.log("Complaint copied to clipboard")).catch(b=>console.error("Failed to copy complaint: ",b))};return i.jsxs("div",{className:"container mx-auto p-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-1 px-3 rounded text-sm",children:"< Back"}),i.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-center flex-grow",children:"Past Complaints"}),i.jsx("div",{className:"w-16"})," "]}),a&&i.jsxs("div",{className:"mb-4 p-2 bg-gray-100 rounded text-center text-sm sm:text-base",children:["Patient: ",i.jsx("strong",{children:a.name})," (",a.age??"N/A"," / ",a.gender??"N/A",")"]}),u&&i.jsxs("div",{className:"text-red-500 p-3 mb-4 border border-red-500 rounded bg-red-50 text-sm",children:["Error: ",u]}),o&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading..."}),!o&&t.length===0&&!u&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No past complaints found for this patient."}),!o&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(g=>i.jsxs("div",{className:"p-3 border rounded shadow-sm bg-white group relative",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:new Date(g.createdAt).toLocaleString()}),i.jsx("p",{className:"text-sm whitespace-pre-wrap",children:g.complaint}),i.jsx("button",{onClick:()=>h(g.complaint),className:"absolute top-1 right-1 bg-gray-200 hover:bg-gray-300 text-gray-600 text-xs p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Copy complaint text",children:""})]},g.id))})]})},Ax=500,Gj="defaultConsultationFee",JZ=({patientId:e,billId:n,queueId:t,onBillCreated:r,onBillUpdated:a,initialItems:l=[],billType:o="other",relatedId:f,initialStatus:u="pending",initialDiscountPercentage:d=0,readOnlyMode:h=!1,doctorId:g,labOrderId:b,patientInsuranceType:v})=>{const[N,k]=w.useState(null),[T,E]=w.useState([]),I=w.useRef([]),[P,V]=w.useState(""),[F,$]=w.useState(""),[B,z]=w.useState(1),[q,O]=w.useState(d),[R,G]=w.useState("cash"),[ee,te]=w.useState(!1),[le,K]=w.useState(null),[U,J]=w.useState(!1),[ne,A]=w.useState(!1),[ae,ce]=w.useState(!1),[M,de]=w.useState(null),[,Se]=w.useState([]),[fe,we]=w.useState(null),[re,_e]=w.useState(""),[qe,et]=w.useState("cash"),[Je,Le]=w.useState(!1),[xe,Me]=w.useState(Ax),[ve,Ee]=w.useState(Ax.toString()),De=n?"view_pay":"create";w.useEffect(()=>{const ze=localStorage.getItem(Gj),Ke=ze?parseFloat(ze):Ax;isNaN(Ke)||(Me(Ke),Ee(Ke.toString()))},[]);const nt=l.length===0;w.useEffect(()=>{e?(async()=>{te(!0),K(null);try{const Ke=await pe(`/api/patients/${e}`);if(!Ke.ok){const at=await Ke.json().catch(()=>({}));throw new Error(at.message||"Failed to fetch patient details")}const Fe=await Ke.json();k(Fe)}catch(Ke){K(`Failed to load patient details: ${Ke.message}`),k(null)}finally{te(!1)}})():k(null)},[e]),w.useEffect(()=>{n?(async()=>{ce(!0),K(null),de(null),Se([]),we(null);try{const Ke=await pe(`/api/bills/${n}`);if(!Ke.ok){const at=await Ke.json().catch(()=>({}));throw new Error(at.message||"Failed to fetch bill details")}const Fe=await Ke.json();if(!Fe.bill||!Fe.payments||!Fe.calculated)throw new Error("Invalid bill details structure.");de(Fe.bill),Se(Fe.payments),we(Fe.calculated),O(Fe.bill.discount_percentage!==void 0&&Fe.bill.discount_percentage!==null?parseFloat(Fe.bill.discount_percentage.toString()):0),!N&&Fe.bill.patient_id&&lt(Fe.bill.patient_id.toString())}catch(Ke){K(`Failed to load bill details: ${Ke.message}`),de(null),Se([]),we(null)}finally{ce(!1)}})():(de(null),Se([]),we(null))},[n]);const lt=async ze=>{te(!0);try{const Ke=await pe(`/api/patients/${ze}`);if(!Ke.ok)throw new Error("Failed to fetch patient");const Fe=await Ke.json();k(Fe)}catch(Ke){console.error("Error fetching patient details:",Ke),k(null)}finally{te(!1)}},Xe=w.useCallback(async ze=>{A(!0),K(null);const Ke=ze.filter(Fe=>Fe.drug_id!=null).map(async Fe=>{try{const at=await pe(`/api/drugs/${Fe.drug_id}`);if(!at.ok)throw new Error(`Drug ${Fe.drug_id} not found.`);const Qe=await at.json();return{...Fe,price:Qe.price,total:Qe.price*Fe.quantity}}catch{return K(Qe=>`${Qe?Qe+"; ":""}Failed to fetch price for ${Fe.name}`),Fe}});try{const Fe=await Promise.all(Ke);E(at=>{const Qe=new Map(Fe.map(yt=>[yt.id,yt]));return at.map(yt=>Qe.get(yt.id)||yt)})}catch{}finally{A(!1)}},[pe]);w.useEffect(()=>{if(n){E([]),I.current=[];return}JSON.stringify(l)===JSON.stringify(I.current)||(async()=>{let Fe=[];if(l&&l.length>0)Fe=l.map((at,Qe)=>({...at,id:`initial-${Qe}-${Date.now()}`})),G(u==="paid"?"cash":v==="no_cash_insurance"?"no_cash_insurance":"cash"),O(d),o==="pharmacy"&&!h&&await Xe(Fe);else if(e&&nt&&o==="consultation"){let at=xe;if(g)try{const Qe=await pe(`/api/staff/${g}`);if(!Qe.ok){const Un=await Qe.json().catch(()=>({}));throw new Error(Un.message||"Doctor not found or error fetching fee")}const yt=await Qe.json();yt.opd_fee!=null&&!isNaN(parseFloat(String(yt.opd_fee)))&&parseFloat(String(yt.opd_fee))>=0&&(at=parseFloat(String(yt.opd_fee)))}catch(Qe){K(yt=>`${yt?yt+"; ":""}Could not fetch doctor's fee, using default. (${Qe.message})`)}Fe=[{id:Date.now(),name:"Consultation Fee",price:at,quantity:1,total:at*1,drug_id:null}],G(v==="no_cash_insurance"?"no_cash_insurance":"cash")}else Fe=[],G(v==="no_cash_insurance"?"no_cash_insurance":"cash");E(Fe),I.current=l})()},[n,e,g,l,o,xe,nt,u,h,Xe,d,v]);const Mt=()=>{const ze=parseFloat(F);if(!h)if(P&&!isNaN(ze)&&ze>=0&&B>0){if(P.trim().toLowerCase()==="consultation fee"&&T.some(Fe=>Fe.name.toLowerCase()==="consultation fee")){alert("Consultation Fee already added.");return}const Ke={id:Date.now(),name:P.trim(),price:ze,quantity:B,total:ze*B,drug_id:null};E([...T,Ke]),V(""),$(""),z(1)}else alert("Invalid item details.")},_t=ze=>{h||E(T.filter(Ke=>Ke.id!==ze))},an=w.useMemo(()=>{let ze=T.reduce((Ke,Fe)=>Ke+Fe.total,0);return De==="create"&&q>0&&(ze=ze*(1-q/100)),(fe==null?void 0:fe.totalDue)!==void 0&&(fe==null?void 0:fe.totalDue)!==null?fe.totalDue:ze},[T,fe,q,De]),se=w.useMemo(()=>(fe==null?void 0:fe.totalPaid)??0,[fe]),Q=w.useMemo(()=>(fe==null?void 0:fe.balance)!==void 0&&(fe==null?void 0:fe.balance)!==null?fe.balance:an-se,[fe,an,se]),ie=()=>{const ze=parseFloat(ve);!isNaN(ze)&&ze>=0?(Me(ze),localStorage.setItem(Gj,ze.toString()),alert(`Default Fee set to ${ze.toFixed(2)}`)):alert("Invalid fee amount.")},je=async(ze,Ke)=>{J(!0),K(null);try{const Fe=await pe("/api/payment/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Ke,billId:ze})}),at=await Fe.json();if(!Fe.ok||!at.order)throw new Error(at.message||"Failed to create Razorpay order.");const{key_id:Qe,order:yt}=at,Un={key:Qe,amount:yt.amount,currency:yt.currency,name:"Newtons OPD Zero Clinic",description:`Bill Payment for Patient ID: ${e}`,order_id:yt.id,handler:async function(On){try{const Cn=await pe("/api/payment/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({razorpay_payment_id:On.razorpay_payment_id,razorpay_order_id:On.razorpay_order_id,razorpay_signature:On.razorpay_signature,billId:ze})}),mn=await Cn.json();if(Cn.ok&&mn.success)alert("Payment Successful!"),r&&r(ze),a&&a(),setTimeout(()=>window.print(),200);else throw new Error(mn.message||"Payment verification failed.")}catch(Cn){K(`Payment verification failed: ${Cn.message}. Contact support.`)}finally{J(!1)}},prefill:{name:(N==null?void 0:N.name)||""},notes:{bill_id:ze,patient_id:e},theme:{color:"#3399cc"},modal:{ondismiss:function(){K("Payment cancelled."),J(!1)}}};if(window.Razorpay)new window.Razorpay(Un).open();else throw new Error("Razorpay SDK not loaded.")}catch(Fe){K(`Failed to initiate online payment: ${Fe.message}`),J(!1)}},Ae=async()=>{if(!n){K("Bill ID is missing.");return}if(!re||isNaN(parseFloat(re))||parseFloat(re)<=0){K("Please enter a valid positive payment amount.");return}Le(!0),K(null);const ze={amount_paid:parseFloat(re),payment_mode:qe};try{const Ke=await pe(`/api/bills/${n}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ze)}),Fe=await Ke.json();if(!Ke.ok)throw new Error(Fe.message||`Failed to record payment (Status: ${Ke.status})`);alert(`Payment of ${ze.amount_paid.toFixed(2)} recorded.`),_e(""),a?a():console.log("Payment recorded.")}catch(Ke){K(`Failed to record payment: ${Ke.message}`)}finally{Le(!1)}},Be=async()=>{if(De==="view_pay")return;if(!e){K("Patient ID is missing for creating a bill.");return}if(T.length===0){K("Cannot finalize an empty bill.");return}J(!0),K(null);const ze=an,Ke=T.map(({id:Fe,...at})=>at);if(R==="online"){const Fe={patientId:e,queueId:t||null,items:Ke,amount:ze,paymentMode:"online",type:o,related_id:f||b||null,status:"pending",discountPercentage:q,labOrderId:b||null};try{const at=await pe("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Fe)}),Qe=await at.json();if(!at.ok)throw new Error(Qe.message||"Failed to create pending bill.");je(Qe.id,Math.round(ze*100))}catch(at){K(`Failed to create pending bill: ${at.message}`),J(!1)}}else{const Fe="paid";if(!R){K("Payment mode required."),J(!1);return}const at={patientId:e,queueId:t||null,items:Ke,amount:ze,paymentMode:R,type:o,related_id:f||b||null,status:Fe,discountPercentage:q,labOrderId:b||null};setTimeout(()=>window.print(),200);try{const Qe=await pe("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(at)}),yt=await Qe.json();if(!Qe.ok)throw new Error(yt.message||"Failed to create bill.");alert("Bill marked as paid!"),r&&r(yt.id),J(!1)}catch(Qe){K(`Failed to process bill: ${Qe.message}`),J(!1)}}},st=(M==null?void 0:M.type)??o,pt=(M==null?void 0:M.status)??u,dt=De==="view_pay"&&M&&pt==="pending";return!e&&!n?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow text-gray-500",children:"Select patient or provide Bill ID."}):ee||De==="view_pay"&&ae?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow",children:"Loading..."}):De==="view_pay"&&!M&&!ae&&le?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading bill: ",le]}):De==="create"&&!N&&!ee&&le?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading patient: ",le]}):i.jsxs("div",{className:"billing-component-container printable-section",children:[i.jsxs("div",{className:"billing-header",children:[i.jsx("h2",{children:De==="create"?"Create Bill":"Bill Details"}),De==="create"&&o==="consultation"&&!h&&i.jsxs("div",{className:"default-fee-section",children:[i.jsx("label",{htmlFor:"defaultFee",className:"whitespace-nowrap",children:"Default Fee:"}),i.jsx("input",{id:"defaultFee",type:"number",value:ve,onChange:ze=>Ee(ze.target.value),className:"",placeholder:Ax.toString(),disabled:h}),i.jsx("button",{onClick:ie,title:"Set Default Fee",className:"",disabled:h,children:i.jsx(Id,{size:16})})]})]}),le&&!ae&&!Je&&i.jsxs("div",{className:"error-message",role:"alert",children:[i.jsx("strong",{children:"Error: "}),le]}),N&&i.jsxs("div",{className:"patient-details-section",children:[i.jsx("h3",{children:"Patient Details"}),i.jsxs("p",{children:[i.jsx("strong",{children:"ID:"})," ",N.id]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",N.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Age:"})," ",N.age||"N/A",", ",i.jsx("strong",{children:"Gender:"})," ",N.gender||"N/A"]})]}),i.jsxs("div",{className:"bill-items-summary-section",children:[i.jsxs("div",{className:"bill-items-header",children:[i.jsx("h3",{children:De==="create"?"Bill Items":"Billing Summary"}),De==="create"&&o==="pharmacy"&&!h&&T.some(ze=>ze.drug_id!=null)&&i.jsxs("button",{onClick:()=>Xe(T),disabled:ne,className:"refresh-prices-button",title:"Refresh item prices from inventory",children:[i.jsx(Yx,{size:14,className:`lucide ${ne?"animate-spin":""}`}),ne?"Refreshing...":"Refresh"]})]}),De==="view_pay"&&M&&i.jsxs("div",{className:"bill-info-bar",children:[i.jsxs("span",{children:["Bill ID: ",i.jsx("strong",{children:M.id})]}),i.jsxs("span",{children:["Type: ",i.jsx("strong",{className:"capitalize",children:st})]}),i.jsxs("span",{children:["Status: ",i.jsx("strong",{className:`capitalize ${pt==="paid"?"status-paid":"status-pending"}`,children:pt})]})]}),(De==="create"||De==="view_pay"&&M)&&i.jsxs("div",{className:"bill-items-list",children:[De==="create"&&ne&&T.length>0&&i.jsx("div",{className:"loading-placeholder",children:"Updating prices..."}),De==="create"&&!ne&&T.map((ze,Ke)=>i.jsxs("div",{className:"bill-item",children:[i.jsxs("div",{className:"bill-item-details",children:[i.jsxs("span",{children:[Ke+1,". ",ze.name]}),ze.quantity>1&&i.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",ze.quantity,")"]})]}),i.jsxs("div",{className:"bill-item-price-actions",children:[i.jsxs("span",{className:"bill-item-price",children:["",ze.total.toFixed(2)]}),De==="create"&&typeof ze.id=="number"&&!h&&i.jsxs("button",{onClick:()=>_t(ze.id),className:"remove-item-button",title:"Remove",children:[" ",i.jsx(Qn,{size:16})," "]}),(typeof ze.id!="number"||h||ze.name==="Consultation Fee")&&i.jsxs("span",{className:"lock-icon",title:"Cannot remove",children:[" ",i.jsx(xS,{size:14})," "]})]})]},ze.id)),De==="view_pay"&&M&&M.items.map((ze,Ke)=>i.jsxs("div",{className:"bill-item",children:[i.jsxs("div",{className:"bill-item-details",children:[i.jsxs("span",{children:[Ke+1,". ",ze.name]}),ze.quantity>1&&i.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",ze.quantity,")"]})]}),i.jsxs("div",{className:"bill-item-price-actions",children:[i.jsxs("span",{className:"bill-item-price",children:["",(ze.total??ze.price*ze.quantity).toFixed(2)]}),i.jsxs("span",{className:"lock-icon",title:"Cannot remove from existing bill",children:[" ",i.jsx(xS,{size:14})," "]})]})]},Ke)),De==="create"&&T.length===0&&i.jsx("p",{className:"empty-items-message",children:"No items added."}),De==="view_pay"&&M&&M.items.length===0&&i.jsx("p",{className:"empty-items-message",children:"No items in bill."})]}),De==="create"&&!h&&i.jsxs("div",{className:"add-item-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Item"}),i.jsx("input",{type:"text",value:P,onChange:ze=>V(ze.target.value),placeholder:"Service/Item",className:"custom-text-input"})]}),i.jsxs("div",{className:"form-group",style:{flexGrow:.5,minWidth:"80px"},children:[i.jsx("label",{children:"Qty"}),i.jsx("input",{type:"number",min:"1",value:B,onChange:ze=>z(parseInt(ze.target.value)||1),placeholder:"1",className:"custom-text-input"})]}),i.jsxs("div",{className:"form-group",style:{flexGrow:.7,minWidth:"100px"},children:[i.jsx("label",{children:"Price ()"}),i.jsx("input",{type:"number",value:F,onChange:ze=>$(ze.target.value),placeholder:"0.00",className:"custom-text-input"})]}),i.jsx("button",{onClick:Mt,className:"add-item-button",children:"Add"})]})]})," ",i.jsxs("div",{className:"billing-footer",children:[i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Total Amount:"}),i.jsxs("span",{className:"total-amount-value",children:["",typeof an=="number"?an.toFixed(2):"0.00"]}),De==="create"&&!h&&i.jsxs("div",{className:"discount-section",children:[i.jsx("label",{htmlFor:"discountPercentage",className:"whitespace-nowrap",children:"Discount (%):"}),i.jsx("input",{id:"discountPercentage",type:"number",min:"0",max:"100",step:"0.01",value:q,onChange:ze=>O(parseFloat(ze.target.value)||0),className:"",disabled:h||U})]}),De==="view_pay"&&M&&(M.status==="pending"||M.status==="paid")&&i.jsxs("div",{className:"discount-section",children:[i.jsx("label",{className:"whitespace-nowrap",children:"Discount (%):"}),i.jsxs("span",{className:"discount-value",children:[q.toFixed(2),"%"]})]})]}),De==="view_pay"&&fe&&i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Amount Paid:"}),i.jsxs("span",{className:"total-amount-value",children:["",se.toFixed(2)]})]}),De==="view_pay"&&fe&&i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Balance Due:"}),i.jsxs("span",{className:"total-amount-value",children:["",Q.toFixed(2)]})]}),i.jsxs("div",{className:"footer-actions",children:[De==="create"&&!h&&i.jsxs("div",{className:"action-group",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Payment Mode"}),i.jsxs("select",{value:R,onChange:ze=>G(ze.target.value),className:"custom-select-input",disabled:h||U,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"online",children:"Pay Online (Razorpay)"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsx("button",{onClick:Be,disabled:U||T.length===0||h,className:"finalize-button",children:U?"Processing...":"Finalize Bill"})]}),De==="view_pay"&&dt&&!h&&i.jsxs("div",{className:"action-group",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Record Payment Amount ()"}),i.jsx("input",{type:"number",value:re,onChange:ze=>_e(ze.target.value),placeholder:`Max: ${Q.toFixed(2)}`,className:"custom-text-input",disabled:Je})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Payment Mode"}),i.jsxs("select",{value:qe,onChange:ze=>et(ze.target.value),className:"custom-select-input",disabled:Je,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),i.jsx("button",{onClick:Ae,disabled:Je||!re||parseFloat(re)<=0||parseFloat(re)>Q,className:"record-payment-button",children:Je?"Recording...":"Record Payment"})]}),De==="create"&&h&&T.length>0&&i.jsx("div",{className:"status-message read-only",children:"Read-only."}),De==="view_pay"&&pt==="paid"&&i.jsx("div",{className:"status-message paid",children:"PAID."}),De==="view_pay"&&pt==="cancelled"&&i.jsx("div",{className:"status-message cancelled",children:"CANCELLED."})]})]})]})},KZ=()=>{const e=gt(),n=rr(),{patientId:t,queueId:r,patientName:a,initialItems:l,billType:o,relatedId:f,initialStatus:u,initialDiscountPercentage:d,doctorId:h,billId:g,labOrderId:b}=n.state||{},[v,N]=w.useState(null),[k,T]=w.useState(null),[E,I]=w.useState(null),[P,V]=w.useState(null),[F,$]=w.useState(null),[B,z]=w.useState(null),[q,O]=w.useState(null),[R,G]=w.useState(null),[ee,te]=w.useState(!0),[le,K]=w.useState(null),[U,J]=w.useState(a||"");w.useEffect(()=>{if(!t){console.error("BillingPage loaded without required patientId in location state."),e("/");return}(async()=>{te(!0),K(null);try{let de=t,Se=l||null,fe=u||null,we=o||null,re=f||null,_e=d!==void 0?parseFloat(d):null,qe=a||null,et=null;if(g){console.log(`Fetching details for Bill ID: ${g}`);const Je=await pe(`/api/bills/${g}`);if(!Je.ok){const xe=await Je.json().catch(()=>({message:`Failed to fetch bill details for ID ${g}`}));throw new Error(xe.message||`Failed to fetch bill details (Status: ${Je.status})`)}const Le=await Je.json();if(console.log("Fetched Bill Data:",Le),Se=Le.bill.items||[],fe=Le.bill.status||"pending",we=Le.bill.type||null,re=Le.bill.related_id||null,_e=Le.bill.discount_percentage!==void 0&&Le.bill.discount_percentage!==null?parseFloat(Le.bill.discount_percentage):0,de=Le.bill.patient_id,V(Se),$(fe),z(we),O(re),G(_e),de){const xe=await pe(`/api/patients/${de}`);if(xe.ok){const Me=await xe.json();qe=Me.name,et=Me.phone??null,I(Me.insurance_type??null),J(qe),T(et)}else console.warn(`Could not fetch patient details for ID ${de} from bill.`),J("Patient (Not Found)")}else console.warn(`Bill ${g} does not have an associated patient_id.`),J("Patient (Unknown)")}else if(o==="consultation"&&h){console.log(`Creating consultation bill for doctor ID: ${h}`);const Je=await pe(`/api/staff/${h}`);if(!Je.ok){const Me=await Je.json().catch(()=>({}));throw new Error(Me.message||`Failed to fetch doctor details (status ${Je.status})`)}const Le=await Je.json();console.log("Fetched Doctor Data:",Le);const xe=Le.opd_fee?parseFloat(String(Le.opd_fee)):0;if(xe>0?Se=[{drug_id:h,name:`Consultation Fee - Dr. ${Le.name}`,price:xe,quantity:1,total:xe}]:Se=[],fe="pending",we="consultation",re=r,V(Se),$(fe),z(we),O(re),de){const Me=await pe(`/api/patients/${de}`);if(Me.ok){const ve=await Me.json();T(ve.phone??null),I(ve.insurance_type??null)}else console.warn(`Could not fetch patient details for ID ${de}.`)}}else if(b){console.log(`Fetching details for Lab Order ID: ${b}`);const Je=await pe(`/api/lab/${b}`);if(!Je.ok){let xe=`Failed to fetch lab order details (Status: ${Je.status} ${Je.statusText})`;try{xe=(await Je.json()).message||xe}catch{console.error("Response was not valid JSON:",await Je.text())}throw new Error(xe)}const Le=await Je.json();if(console.log("Fetched Lab Order Data:",JSON.stringify(Le,null,2)),Se=(Le.tests||[]).filter(xe=>xe&&typeof xe.name=="string"&&xe.price!==void 0&&xe.id!==void 0).map(xe=>{const Me=parseFloat(xe.price||"0"),ve=!isNaN(Me)&&isFinite(Me)?Me:0;return{drug_id:xe.id,name:xe.name,price:ve,quantity:1,total:ve*1,type:"lab_test"}}),Se&&Se.length===0&&(Le.tests||[]).length>0&&(console.warn("Warning: Some tests from the lab order were filtered out due to missing id, name, or price.",Le.tests),K(xe=>`${xe?xe+"; ":""}Warning: Some lab items could not be added to the bill due to missing details.`)),fe="pending",we="lab",re=b,de=Le.patient_id,V(Se),$(fe),z(we),O(re),de){const xe=await pe(`/api/patients/${de}`);if(xe.ok){const Me=await xe.json();qe=Me.name,et=Me.phone??null,I(Me.insurance_type??null),J(qe),T(et)}else console.warn(`Could not fetch patient details for ID ${de} from lab order.`),J("Patient (Not Found)")}else console.warn(`Lab Order ${b} does not have an associated patient_id.`),J("Patient (Unknown)")}else if(V(l||null),$(u||null),z(o||null),O(f||null),G(d!==void 0?parseFloat(d):null),J(a||`ID ${t}`),de){const Je=await pe(`/api/patients/${de}`);if(Je.ok){const Le=await Je.json();T(Le.phone??null),I(Le.insurance_type??null)}else console.warn(`Could not fetch patient details for ID ${de}.`)}if(r){const Je=await pe(`/api/queue/${r}`);if(Je.ok){const Le=await Je.json();N(Le.token_number)}else console.warn(`Could not fetch queue details for ID ${r}.`)}}catch(de){console.error("Error fetching billing page details:",de),K(`Failed to load details: ${de.message}`),V(null),$(null),z(null),O(null),J(a||""),T(null),N(null)}finally{te(!1)}})()},[t,g,b,r,e]);const ne=M=>{console.log(`Billing process completed for patient ID ${t}. New Bill ID: ${M}`),e(-1)},A=()=>{console.log(`Bill updated for patient ID ${t}.`),e(-1)};if(!t)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-gray-600",children:[i.jsx(Wx,{size:48,className:"mb-4 text-red-500"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Missing Patient Information"}),i.jsx("p",{className:"text-sm",children:"Cannot load the billing page without a patient ID."}),i.jsx("button",{onClick:()=>e("/"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Go to Dashboard"})]});if(ee)return i.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:i.jsx("p",{className:"text-teal-600 animate-pulse",children:"Loading Billing Details..."})});if(le)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-red-600 p-4",children:[i.jsx(Wx,{size:48,className:"mb-4"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Error Loading Billing Details"}),i.jsx("p",{className:"text-sm text-center mb-4",children:le}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"}),i.jsx("button",{onClick:()=>e(-1),className:"mt-2 text-sm text-gray-600 hover:text-teal-700",children:"Go Back"})]});const ce=(F??u)==="paid";return i.jsxs("div",{className:"billing-page-container",children:[i.jsx("div",{className:"back-button-container",children:i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[i.jsx(Lt,{size:20,className:"lucide"})," Back"]})}),i.jsxs("div",{className:"billing-content-wrapper",children:[i.jsxs("h3",{className:"billing-page-title",children:[g?"Bill Details":b?"Create Lab Bill":"Create Bill"," for Patient: ",U||`ID ${t}`]}),i.jsxs("div",{className:"patient-info-bar",children:[v!==null&&i.jsxs("span",{children:[i.jsx(Ed,{size:14,className:"lucide"})," Token: ",v]}),k&&i.jsxs("span",{children:[i.jsx(kI,{size:14,className:"lucide"})," Phone: ",k]}),b&&i.jsxs("span",{className:"lab-order-info",children:[i.jsx(Gx,{size:14,className:"lucide"})," Lab Order: ",b.substring(0,8),"..."]}),!k&&v===null&&!b&&i.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"}),E&&i.jsxs("span",{className:"insurance-info",children:[i.jsx(UI,{size:14,className:"lucide"})," Insurance: ",E.replace(/_/g," ").replace(/\b\w/g,M=>M.toUpperCase())]}),!k&&v===null&&!b&&!E&&i.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"})]}),i.jsx(JZ,{patientId:t,labOrderId:b,queueId:r,onBillCreated:ne,onBillUpdated:A,initialItems:P??l,billType:B??o,relatedId:q??f,initialStatus:F??u,initialDiscountPercentage:R??d,readOnlyMode:ce,doctorId:h,patientInsuranceType:E??void 0})]})]})},XZ=({patientId:e,labOrderId:n,onBillingSuccess:t,initialItems:r,patientName:a})=>{const[l]=w.useState(r),[o,f]=w.useState(0),[u,d]=w.useState("cash"),[h,g]=w.useState(null),[b,v]=w.useState(!1),N=w.useMemo(()=>l.reduce((E,I)=>E+I.total,0)*(1-o/100),[l,o]),k=async()=>{if(l.length===0){g("Cannot finalize an empty bill.");return}v(!0),g(null);const T={patientId:e,items:l,amount:N,paymentMode:u,type:"lab",related_id:n,status:"paid",discountPercentage:o,labOrderId:n};try{const E=await pe("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)}),I=await E.json();if(!E.ok)throw new Error(I.message||"Failed to create bill.");alert("Bill created successfully!");const P=window.open("","_blank");if(P){const V=`
                    <html>
                        <head>
                            <title>Lab Bill</title>
                            <style>
                                body { font-family: sans-serif; }
                                .bill-container { max-width: 800px; margin: auto; padding: 20px; border: 1px solid #ccc; }
                                .bill-header { text-align: center; margin-bottom: 20px; }
                                .bill-item { display: flex; justify-content: space-between; padding: 5px 0; }
                                .bill-total { text-align: right; margin-top: 20px; font-weight: bold; }
                            </style>
                        </head>
                        <body>
                            <div class="bill-container">
                                <div class="bill-header">
                                    <h2>Lab Bill for ${a}</h2>
                                </div>
                                <div class="bill-items-list">
                                    ${l.map(F=>`
                                        <div class="bill-item">
                                            <span>${F.name}</span>
                                            <span>${F.total.toFixed(2)}</span>
                                        </div>
                                    `).join("")}
                                </div>
                                <div class="bill-total">
                                    Total: ${N.toFixed(2)}
                                </div>
                            </div>
                        </body>
                    </html>
                `;P.document.write(V),P.document.close(),P.print()}t()}catch(E){g(`Failed to process bill: ${E.message}`)}finally{v(!1)}};return i.jsxs("div",{className:"billing-layout",children:[i.jsx("main",{className:"order-content",children:i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Lab Tests"})}),l.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"PRICE"})]})}),i.jsx("tbody",{children:l.map((T,E)=>i.jsxs("tr",{children:[i.jsx("td",{children:E+1}),i.jsx("td",{children:T.name}),i.jsx("td",{children:T.total.toFixed(2)})]},E))})]}):i.jsx("p",{children:"No lab tests in this order."})]})}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",l.reduce((T,E)=>T+E.total,0).toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:o,onChange:T=>f(parseFloat(T.target.value)||0),min:"0",max:"100",className:"discount-input-total",disabled:b}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",N.toFixed(2)]})]}),h&&i.jsx("p",{className:"error-message",style:{color:"red",textAlign:"center"},children:h}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:u,onChange:T=>d(T.target.value),className:"payment-mode-select",disabled:b,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsx("div",{className:"bill-actions",children:i.jsx("button",{onClick:k,className:"primary-button",disabled:b||l.length===0,children:b?"Processing...":"Finalise and Bill"})})]})})]})},ZZ=()=>{const e=gt(),n=rr(),{labOrderId:t}=n.state||{},[r,a]=w.useState(null),[l,o]=w.useState(""),[f,u]=w.useState(null),[d,h]=w.useState(null),[g,b]=w.useState(null),[v,N]=w.useState(!0),[k,T]=w.useState(null);w.useEffect(()=>{if(!t){console.error("LabBillingPage loaded without a labOrderId."),e("/");return}(async()=>{N(!0),T(null);try{const P=await pe(`/api/lab/${t}`);if(!P.ok){const $=await P.json().catch(()=>({}));throw new Error($.message||`Failed to fetch lab order details (Status: ${P.status})`)}const V=await P.json(),F=(V.tests||[]).filter($=>$&&typeof $.name=="string"&&$.price!==void 0&&$.id!==void 0).map($=>{const B=parseFloat($.price||"0"),z=!isNaN(B)&&isFinite(B)?B:0;return{drug_id:$.id,name:$.name,price:z,quantity:1,total:z,type:"lab_test"}});if(b(F),V.patient_id){a(V.patient_id);const $=await pe(`/api/patients/${V.patient_id}`);if($.ok){const B=await $.json();o(B.name),u(B.phone??null),h(B.insurance_type??null)}else o("Patient (Not Found)")}else throw new Error("Lab order does not have an associated patient.")}catch(P){console.error("Error fetching lab billing details:",P),T(`Failed to load details: ${P.message}`)}finally{N(!1)}})()},[t,e]);const E=()=>{console.log(`Lab billing process completed for Lab Order ID: ${t}`),e(-1)};return t?v?i.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:i.jsx("p",{className:"text-teal-600 animate-pulse",children:"Loading Lab Bill..."})}):k?i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-red-600 p-4",children:[i.jsx(Wx,{size:48,className:"mb-4"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Error Loading Lab Bill"}),i.jsx("p",{className:"text-sm text-center mb-4",children:k}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"}),i.jsx("button",{onClick:()=>e(-1),className:"mt-2 text-sm text-gray-600 hover:text-teal-700",children:"Go Back"})]}):i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(Lt,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Lab Bill"})]}),i.jsx("div",{className:"billing-layout",children:i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Patient Name:"})," ",l]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Phone:"})," ",f||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Lab Order ID:"})," ",t]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Insurance:"})," ",d?d.replace(/_/g," "):"N/A"]})]})]}),r&&g&&i.jsx(XZ,{patientId:r,labOrderId:t,onBillingSuccess:E,initialItems:g,patientInsuranceType:d,patientName:l})]})})]})}):i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-gray-600",children:[i.jsx(Wx,{size:48,className:"mb-4 text-red-500"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Missing Lab Order Information"}),i.jsx("p",{className:"text-sm",children:"Cannot load the lab billing page without a lab order ID."}),i.jsx("button",{onClick:()=>e("/"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Go to Dashboard"})]})},eee=()=>{const{patientId:e}=jr(),n=gt(),[t,r]=w.useState([]),[a,l]=w.useState(!1),[o,f]=w.useState(null),[u,d]=w.useState("");return w.useEffect(()=>{(async()=>{if(!e){f("Patient ID not provided in URL.");return}l(!0),f(null),r([]);try{try{const v=await pe(`/api/patients/${e}`);if(v.ok){const N=await v.json();d(N.name)}}catch(v){console.warn("Could not fetch patient name:",v)}console.log(`Fetching pharmacy orders for patient ID: ${e}`);const g=await pe(`/api/pharmacy-orders/patient/${e}`);if(!g.ok){const v=await g.json().catch(()=>({}));throw new Error(v.message||`HTTP error! status: ${g.status}`)}const b=await g.json();console.log("Fetched Pharmacy Orders:",b),r(b||[])}catch(g){console.error("Error fetching pharmacy orders:",g),f(`Failed to load pharmacy orders: ${g.message}`)}finally{l(!1)}})()},[e]),i.jsxs("div",{className:"p-4 md:p-6 max-w-4xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6 border-b pb-3",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-900",children:[i.jsx(Lt,{size:16,className:"mr-1"}),"Back"]}),i.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[i.jsx(Pd,{size:20,className:"mr-2 text-purple-600"}),"Pharmacy Order History ",u&&`for ${u}`]}),i.jsx("div",{})," "]}),a&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading pharmacy orders..."}),o&&i.jsx("p",{className:"text-center text-red-500 bg-red-100 p-3 rounded border border-red-300",children:o}),!a&&t.length===0&&!o&&i.jsx("p",{className:"text-center text-gray-500",children:"No pharmacy orders found for this patient."}),!a&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(h=>i.jsxs("div",{className:"p-4 border rounded bg-white shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Date:"})," ",new Date(h.date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm font-medium capitalize",children:[i.jsx("strong",{children:"Status:"})," ",h.status]})]}),i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Prescribed By:"})," ",h.prescribedBy||"N/A"]}),h.dispensedBy&&i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Dispensed By:"})," ",h.dispensedBy]}),i.jsx("h4",{className:"text-md font-semibold mt-3 mb-1",children:"Medications:"}),i.jsx("ul",{className:"list-disc list-inside ml-4 text-sm text-gray-700 space-y-1",children:h.medications.map((g,b)=>i.jsxs("li",{children:[g.name," - Qty: ",g.quantity,g.tabletsPerDay&&` (${g.tabletsPerDay} per day`,g.numberOfDays&&` for ${g.numberOfDays} days)`,!g.tabletsPerDay&&g.numberOfDays&&` (for ${g.numberOfDays} days)`,g.tabletsPerDay&&!g.numberOfDays&&")"]},b))})]},h.id))})]})},Yj=()=>{const e=gt(),n=rr(),[t,r]=w.useState(null),[a,l]=w.useState([]),[o,f]=w.useState([]),[u,d]=w.useState(""),[h,g]=w.useState([]),[b,v]=w.useState(null),[N,k]=w.useState(!1),[T,E]=w.useState(null),[I,P]=w.useState(!0),[V,F]=w.useState(""),[$,B]=w.useState([]),[z,q]=w.useState(!1),[O,R]=w.useState(null),[G,ee]=w.useState(!1),[te,le]=w.useState(!1),[K,U]=w.useState([]),J=/^\+?[0-9\s\-().]{7,20}$/,ne=/^[a-zA-Z\s'-]{2,}$/,A=w.useCallback(async()=>{try{const ve=await pe("/api/drugs");if(!ve.ok)throw new Error("Failed to fetch drugs");const Ee=await ve.json();l(Ee)}catch(ve){console.error("Failed to fetch available drugs:",ve),v("Could not load drug list. "+ve.message)}},[]),ae=w.useCallback(async ve=>{try{const Ee=await pe(`/api/pharmacy-orders/patient/${ve}`);if(!Ee.ok){const nt=await Ee.json().catch(()=>({}));throw new Error(nt.message||`HTTP error! status: ${Ee.status}`)}const De=await Ee.json();U(De||[])}catch(Ee){console.error("Failed to fetch previous pharmacy orders:",Ee)}finally{}},[]);w.useEffect(()=>{var ve;A(),(ve=n.state)!=null&&ve.patient?de(n.state.patient):P(!0)},[A,n.state]),w.useEffect(()=>{t!=null&&t.id?ae(t.id):U([])},[t,ae]),w.useEffect(()=>{if(!u){g([]);return}const ve=u.toLowerCase();g(a.filter(Ee=>{const De=Ee.name&&Ee.name.toLowerCase().includes(ve),nt=Ee.brand_name&&Ee.brand_name.toLowerCase().includes(ve);return De||nt}).slice(0,10))},[u,a]);const ce=w.useMemo(()=>Nb(async ve=>{if(ve.trim().length<2){B([]),q(!1),R(null);return}q(!0),R(null);try{const Ee=new URLSearchParams({search:encodeURIComponent(ve),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),De=await pe(`/api/patients?${Ee.toString()}`);if(!De.ok)throw new Error("API Error");const nt=await De.json();B(nt.patients)}catch(Ee){console.error("Error searching patients:",Ee),R(Ee.message||"Failed to search patients."),B([])}finally{q(!1)}},300),[J]),M=ve=>{const Ee=ve.target.value;F(Ee),ee(J.test(Ee)),le(ne.test(Ee)&&!J.test(Ee)),q(!0),ce(Ee)},de=w.useCallback(ve=>{r(ve),P(!1),F(""),B([]),R(null)},[]),Se=w.useCallback(async ve=>{if(!V||ve==="phone"&&!G||ve==="name"&&!te){R(`Invalid ${ve} to create a new patient.`);return}q(!0),R(null);try{const nt=await(await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:ve==="name"?V:"direct pharmacy",phone:ve==="phone"?V:null,age:null,gender:null,token:null})})).json();de(nt)}catch(Ee){const De=Ee.message||"";if(De.toLowerCase().includes("patient limit")){e("/start-clinic-subscription",{state:{errorMessage:De}});return}R(De||"Failed to create new patient.")}finally{q(!1)}},[V,G,te,de]),fe=()=>{r(null),P(!0),f([]),v(null),U([])},we=ve=>{if(!ve)return null;const Ee=ve.match(/(?:\d+x)?(\d+)/);return Ee?parseInt(Ee[1],10):null},re=ve=>{if(o.some(Ee=>Ee.drug_id===ve.id)){v(`${ve.name||ve.brand_name} is already in the order.`),setTimeout(()=>v(null),3e3),d(""),g([]);return}f(Ee=>[...Ee,{drug_id:ve.id,name:ve.name||ve.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,tabletsPerDay:1,numberOfDays:1,price:Number(ve.price)||0,originalPrice:Number(ve.price)||0,stock:ve.quantity_in_stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(ve.price)||0)/(we(ve.unit)||1),unit:ve.unit}]),d(""),g([])},_e=()=>{const ve=u.trim();ve&&e("/dashboard/inventory/add",{state:{initialDrugName:ve}})},qe=ve=>{f(Ee=>Ee.filter(De=>(De.drug_id??De.name)!==ve))},et=(ve,Ee)=>{f(De=>De.map(nt=>{if((nt.drug_id??nt.name)===ve&&nt.isLoose){const lt=we(nt.unit),Xe=Math.max(0,Ee),Mt=Xe*(lt??1)+(nt.looseUnits??0);return{...nt,loosePacks:Xe,looseQuantity:Mt}}return nt}))},Je=(ve,Ee)=>{f(De=>De.map(nt=>{if((nt.drug_id??nt.name)===ve&&nt.isLoose){const lt=we(nt.unit),Xe=Math.max(0,Ee),Mt=(nt.loosePacks??0)*(lt??1)+Xe;return{...nt,looseUnits:Xe,looseQuantity:Mt}}return nt}))},Le=ve=>{const Ee=[];ve.medications.forEach(De=>{if(!o.find(lt=>lt.drug_id&&De.drug_id&&lt.drug_id===De.drug_id||lt.name.toLowerCase()===De.name.toLowerCase())){let lt=De.drug_id,Xe=De.drug_id?a.find(Mt=>Mt.id===De.drug_id):void 0;if(!Xe&&De.name){const Mt=a.find(_t=>_t.name&&_t.name.toLowerCase()===De.name.toLowerCase());Mt?(lt=Mt.id,Xe=Mt):lt&&(lt=null)}Ee.push({drug_id:lt,name:De.name,pack_quantity:De.pack_quantity??0,loose_quantity:De.loose_quantity??0,directions_to_use:De.directions_to_use,tabletsPerDay:De.tabletsPerDay??1,numberOfDays:De.numberOfDays??1,price:Xe?Xe.price:De.price,stock:Xe?Xe.quantity_in_stock:De.stock,isLoose:!0,loosePacks:0,looseUnits:(De.pack_quantity??0)*(we((Xe==null?void 0:Xe.unit)||De.unit)??1)+(De.loose_quantity??0),looseQuantity:(De.pack_quantity??0)*(we((Xe==null?void 0:Xe.unit)||De.unit)??1)+(De.loose_quantity??0),pricePerLooseUnit:(Xe?Number(Xe.price):Number(De.price)||0)/(we((Xe==null?void 0:Xe.unit)||De.unit)||1),unit:(Xe==null?void 0:Xe.unit)||De.unit})}}),f(De=>[...De,...Ee]),ve.prescriptionForUnavailableDrugs&&(!T||!T.includes(ve.prescriptionForUnavailableDrugs))&&E(De=>De?`${De}

-- From previous order --
${ve.prescriptionForUnavailableDrugs}`:ve.prescriptionForUnavailableDrugs),v("Medications from previous order added."),setTimeout(()=>v(null),3e3)},xe=async ve=>{if(ve.preventDefault(),v(null),k(!0),!t){v("No patient selected."),k(!1);return}if(o.length===0&&!(T!=null&&T.trim())){v("Add medication or prescription notes."),k(!1);return}const Ee={patient_id:t.id,items:o.map(De=>{const nt=Number(De.price??0),lt=Number(De.pricePerLooseUnit??0),Xe=Number((lt*(De.looseQuantity??0)).toFixed(2));return{drug_id:De.drug_id||null,name:De.name,pack_quantity:De.loosePacks??0,loose_quantity:De.looseUnits??0,pack_price:nt,loose_price:lt,total_price:Xe,price:Number(De.originalPrice??0),directions_to_use:De.directions_to_use??null,tabletsPerDay:Number(De.tabletsPerDay??1),numberOfDays:Number(De.numberOfDays??1)}}),order_total:Me,prescription_for_unavailable_drugs:T};try{const De=await pe("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ee)});if(!De.ok)throw new Error("Order creation failed");await De.json(),alert(`Order created successfully for ${t.name}!`);let nt=t.queueId;if(!nt)try{const lt=await pe(`/api/queue/patient/${t.id}/latest`);if(lt.ok){const Xe=await lt.json();Xe!=null&&Xe._id&&(nt=Xe._id)}}catch(lt){console.error("Error checking queue:",lt)}if(!nt)try{const lt=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:t.id})});if(lt.ok){const Xe=await lt.json();Xe!=null&&Xe.id&&(nt=Xe.id)}}catch(lt){console.error("Error creating queue:",lt)}nt?e(`/dashboard/edit-complaint/${nt}`,{state:{patientId:t.id}}):e(-1)}catch(De){v(De.message||"Failed to create order.")}finally{k(!1)}},Me=w.useMemo(()=>o.reduce((ve,Ee)=>{const De=Ee.isLoose?Ee.pricePerLooseUnit??0:Ee.price??0,nt=Ee.isLoose?Ee.looseQuantity??0:Ee.quantity??0;return ve+De*nt},0),[o]);return i.jsxs("div",{className:"add-pharmacy-order-page p-4 md:p-8 max-w-7xl mx-auto",children:[i.jsx("div",{className:"page-header",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:i.jsx(Lt,{size:20})}),i.jsx("h2",{children:"Create Pharmacy Order"})]})}),b&&i.jsxs("div",{className:"bg-red-900/20 border border-red-500/50 text-red-200 p-4 rounded-xl mb-6 flex items-start gap-3 animate-fade-in",children:[i.jsx(ti,{className:"shrink-0 mt-0.5",size:18}),i.jsx("span",{children:b})]}),I&&i.jsx("div",{className:"max-w-2xl mx-auto mt-10",children:i.jsxs("div",{className:"content-panel",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(Fs,{size:20,className:"text-indigo-400"})," Select Patient"]}),i.jsxs("div",{className:"patient-search-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(Si,{className:"search-icon",size:20}),i.jsx("input",{type:"text",placeholder:"Search by Name, Token # or Phone...",value:V,onChange:M,className:"custom-text-input",autoFocus:!0}),z&&i.jsx("div",{className:"pr-4 text-xs text-indigo-400 animate-pulse",children:"Searching..."})]}),O&&i.jsx("p",{className:"text-red-400 text-sm mt-2 pl-1 animate-fadeIn",children:O}),$.length>0&&i.jsx("div",{className:"search-results-dropdown",children:$.map(ve=>i.jsxs("div",{onClick:()=>de(ve),className:"search-result-item",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsxs("span",{className:"text-white font-medium flex items-center",children:[i.jsxs("span",{className:"token-badge",children:["#",ve.token]}),ve.name]}),i.jsxs("span",{className:"text-xs text-gray-400 mt-1 pl-1",children:[ve.gender,"  ",ve.age," yrs  ",ve.phone||"No phone"]})]}),i.jsx(Hx,{size:16,className:"text-gray-600 -rotate-90"})]},ve.id))}),!z&&V.length>2&&$.length===0&&i.jsxs("div",{className:"mt-4 p-4 bg-zinc-800/50 rounded-lg text-center border border-dashed border-zinc-700",children:[i.jsxs("p",{className:"text-gray-400 mb-3 text-sm",children:['No patient found matching "',V,'"']}),i.jsxs("div",{className:"flex justify-center gap-3",children:[G&&i.jsx("button",{onClick:()=>Se("phone"),className:"px-4 py-2 bg-green-600/20 text-green-400 border border-green-600/50 rounded-lg text-sm hover:bg-green-600/30 transition-colors",children:"Create with Phone"}),te&&i.jsx("button",{onClick:()=>Se("name"),className:"px-4 py-2 bg-indigo-600/20 text-indigo-400 border border-indigo-600/50 rounded-lg text-sm hover:bg-indigo-600/30 transition-colors",children:"Create with Name"})]})]})]})]})}),!I&&t&&i.jsxs("form",{onSubmit:xe,className:"pharmacy-order-grid animate-fade-in",children:[i.jsxs("div",{className:"order-main-column",children:[i.jsxs("div",{className:"content-panel mb-6",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(Si,{size:18,className:"text-indigo-400"})," Add Medication"]}),i.jsxs("div",{className:"relative drug-search-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(Si,{className:"search-icon",size:18}),i.jsx("input",{type:"text",placeholder:"Search for drugs...",value:u,onChange:ve=>d(ve.target.value),className:"custom-text-input"})]}),h.length>0&&i.jsx("div",{className:"search-results-dropdown",children:h.map(ve=>i.jsx("div",{onClick:()=>re(ve),className:"search-result-item",children:i.jsxs("div",{className:"flex justify-between w-full",children:[i.jsxs("div",{children:[i.jsx("span",{className:"drug-name",children:ve.name||ve.brand_name}),i.jsxs("span",{className:"drug-meta text-xs",children:["Stock: ",ve.quantity_in_stock]})]}),i.jsx("div",{className:"text-right",children:i.jsxs("span",{className:"text-indigo-300 font-mono",children:["",Number(ve.price).toFixed(2)]})})]})},ve.id))}),u&&h.length===0&&!a.find(ve=>{var Ee;return((Ee=ve.name)==null?void 0:Ee.toLowerCase())===u.toLowerCase()})&&i.jsx("div",{className:"search-results-dropdown p-2",children:i.jsxs("button",{type:"button",onClick:_e,className:"w-full text-left px-4 py-2 text-indigo-400 hover:bg-zinc-800 rounded-lg text-sm transition-colors",children:['+ Add "',u,'" to Inventory']})})]})]}),i.jsxs("div",{className:"content-panel min-h-[400px]",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(To,{size:18,className:"text-indigo-400"})," Order Items (",o.length,")"]}),o.length===0?i.jsxs("div",{className:"empty-state",children:[i.jsx(To,{size:48,className:"empty-icon mx-auto",strokeWidth:1}),i.jsx("p",{className:"empty-text",children:"No medications added yet"}),i.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Search above to add items to the order"})]}):i.jsx("div",{className:"order-table-container",children:i.jsxs("table",{className:"order-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{width:"30%"},children:"Drug Name"}),i.jsx("th",{children:"Dosage / Directions"}),i.jsx("th",{children:"Qty (Packs/Loose)"}),i.jsx("th",{children:"Price"}),i.jsx("th",{})]})}),i.jsx("tbody",{children:o.map((ve,Ee)=>{const De=ve.drug_id??ve.name,nt=(ve.pricePerLooseUnit??0)*(ve.looseQuantity??0);return i.jsxs("tr",{className:"group",children:[i.jsxs("td",{children:[i.jsx("span",{className:"drug-name",children:ve.name}),i.jsxs("span",{className:"drug-meta",children:["Stock: ",ve.stock,"  Box of ",we(ve.unit)||1]})]}),i.jsx("td",{children:i.jsx("div",{className:"flex flex-col gap-2",children:i.jsx("input",{type:"text",placeholder:"Directions...",value:ve.directions_to_use||"",onChange:lt=>{const Xe=lt.target.value;f(Mt=>Mt.map(_t=>(_t.drug_id??_t.name)===De?{..._t,directions_to_use:Xe}:_t))},className:"table-input w-full"})})}),i.jsx("td",{children:i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("div",{className:"qty-input-group",children:[i.jsx("span",{className:"text-xs text-gray-500 w-8",children:"Pks:"}),i.jsx("input",{type:"number",min:"0",value:ve.loosePacks,onChange:lt=>et(De,parseInt(lt.target.value,10)),className:"table-input medium"})]}),i.jsxs("div",{className:"qty-input-group",children:[i.jsx("span",{className:"text-xs text-gray-500 w-8",children:"Unit:"}),i.jsx("input",{type:"number",min:"0",value:ve.looseUnits,onChange:lt=>Je(De,parseInt(lt.target.value,10)),className:"table-input medium"})]})]})}),i.jsx("td",{children:i.jsxs("div",{className:"font-mono text-sm",children:["",nt.toFixed(2)]})}),i.jsx("td",{children:i.jsx("button",{type:"button",onClick:()=>qe(De),className:"delete-btn opacity-0 group-hover:opacity-100",title:"Remove Item",children:i.jsx(Ri,{size:16})})})]},`${De}-${Ee}`)})})]})})]}),i.jsxs("div",{className:"content-panel",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(rs,{size:18,className:"text-indigo-400"})," Additional Notes / Prescription"]}),i.jsx("textarea",{value:T??"",onChange:ve=>E(ve.target.value||null),placeholder:"Enter notes for unavailable drugs or special instructions...",className:"custom-text-input bg-zinc-900/50 min-h-[100px] border border-zinc-800 rounded-lg resize-y"})]})]}),i.jsxs("div",{className:"order-sidebar",children:[i.jsxs("div",{className:"patient-card mb-6",children:[i.jsx("div",{className:"patient-avatar",children:t.name.charAt(0).toUpperCase()}),i.jsx("h3",{className:"patient-name",children:t.name}),i.jsx("div",{className:"patient-meta",children:i.jsxs("span",{children:["Token: #",t.token]})}),i.jsxs("div",{className:"patient-detail-grid",children:[i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Age / Gender"}),i.jsxs("p",{children:[t.age||"--"," / ",t.gender||"--"]})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Phone"}),i.jsx("p",{children:t.phone||"--"})]})]}),i.jsx("button",{type:"button",onClick:fe,className:"change-patient-btn",children:"Change Patient"})]}),K.length>0&&i.jsxs("div",{className:"content-panel mb-6 p-4",children:[i.jsxs("div",{className:"section-title text-sm mb-3",children:[i.jsx(UP,{size:16,className:"text-indigo-400"})," Recent Orders"]}),i.jsx("div",{className:"max-h-[200px] overflow-y-auto pr-1 custom-scrollbar",children:K.map(ve=>i.jsxs("div",{className:`prev-order-item status-${ve.status}`,children:[i.jsxs("div",{className:"prev-order-header",children:[i.jsx("span",{className:"prev-order-date",children:new Date(ve.date).toLocaleDateString()}),i.jsx("span",{className:`status-badge ${ve.status}`,children:ve.status})]}),i.jsx("div",{className:"text-xs text-gray-500 mb-2 truncate",children:ve.medications.map(Ee=>Ee.name).join(", ")}),i.jsx("button",{type:"button",onClick:()=>Le(ve),className:"add-prev-btn",children:"+ Add items"})]},ve.id))})]}),i.jsxs("div",{className:"content-panel order-summary-container",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(M_,{size:18,className:"text-indigo-400"})," Summary"]}),i.jsx("div",{className:"summary-details",children:i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Items"}),i.jsx("span",{children:o.length})]})}),i.jsxs("div",{className:"summary-total",children:[i.jsx("span",{className:"total-label",children:"Grand Total"}),i.jsxs("span",{className:"total-value",children:["",Me.toFixed(2)]})]}),i.jsxs("button",{type:"submit",disabled:N||o.length===0&&!T,className:"create-order-btn",children:[N?i.jsx("div",{className:"spinner"}):i.jsx(vb,{size:20}),N?"Processing...":"Create Order"]})]})]})]})]})},hT=()=>{var K;const{orderId:e}=jr(),n=gt(),[t,r]=w.useState(null),[a,l]=w.useState(null),[o,f]=w.useState([]),[u,d]=w.useState([]),[h,g]=w.useState(""),[b,v]=w.useState([]),[N,k]=w.useState(null),[T,E]=w.useState(!1),[I,P]=w.useState(null),[V,F]=w.useState(!0),$=U=>{if(!U)return null;const J=U.match(/(?:\d+x)?(\d+)/);return J?parseInt(J[1],10):null},B=w.useCallback(async()=>{F(!0);try{const U=await pe(`/api/pharmacy-orders/${e}`);if(!U.ok)throw new Error("Failed to fetch order details");const J=await U.json();r(J),l({id:J.patientId,name:J.patientName||"N/A",token:J.patientTokenNumber}),P(J.prescriptionForUnavailableDrugs);const ne=J.medications.map(A=>{const ae=$(A.unit),ce=A.pack_quantity*(ae??1)+A.loose_quantity;return{...A,isLoose:!0,loosePacks:A.pack_quantity,looseUnits:A.loose_quantity,looseQuantity:ce,pack_price:A.pack_price,loose_price:A.loose_price,total_price:A.total_price,pricePerLooseUnit:A.loose_price,originalPrice:A.pack_price,box_number:A.box_number,unit:A.unit,batch:A.batch,expiry_date:A.expiry_date,discount_percentage:A.discount_percentage}});d(ne)}catch(U){k("Could not load order details. "+U.message)}finally{F(!1)}},[e]),z=w.useCallback(async()=>{try{const U=await pe("/api/drugs");if(!U.ok)throw new Error("Failed to fetch drugs");const J=await U.json();f(J)}catch(U){k("Could not load drug list. "+U.message)}},[]);w.useEffect(()=>{B(),z()},[B,z]),w.useEffect(()=>{if(!h){v([]);return}const U=h.toLowerCase();v(o.filter(J=>{const ne=J.name&&J.name.toLowerCase().includes(U),A=J.brand_name&&J.brand_name.toLowerCase().includes(U);return ne||A}).slice(0,10))},[h,o]);const q=U=>{if(u.some(J=>J.drug_id===U.id)){k(`${U.name||U.brand_name} is already in the order.`),setTimeout(()=>k(null),3e3),g(""),v([]);return}d(J=>[...J,{drug_id:U.id,name:U.name||U.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,pack_price:Number(U.price)||0,loose_price:(Number(U.price)||0)/($(U.unit)||1),total_price:(Number(U.price)||0)/($(U.unit)||1),discount_percentage:0,directions_to_use:"",tabletsPerDay:1,numberOfDays:1,stock:U.quantity_in_stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(U.price)||0)/($(U.unit)||1),originalPrice:Number(U.price)||0,unit:U.unit}]),g(""),v([])},O=U=>{d(J=>J.filter(ne=>(ne.drug_id??ne.name)!==U))},R=(U,J)=>{d(ne=>ne.map(A=>{if((A.drug_id??A.name)===U&&A.isLoose){const ae=$(A.unit),ce=Math.max(0,J),M=ce*(ae??1)+(A.looseUnits??0);return{...A,loosePacks:ce,looseQuantity:M,pack_quantity:ce}}return A}))},G=(U,J)=>{d(ne=>ne.map(A=>{if((A.drug_id??A.name)===U&&A.isLoose){const ae=$(A.unit),ce=Math.max(0,J),M=(A.loosePacks??0)*(ae??1)+ce;return{...A,looseUnits:ce,looseQuantity:M,loose_quantity:ce}}return A}))},ee=w.useMemo(()=>u.reduce((U,J)=>{const ne=J.loose_price??0,A=J.looseQuantity??0;return U+ne*A},0),[u]),te=(Number(ee)||0).toFixed(2),le=async U=>{if(U.preventDefault(),k(null),E(!0),u.length===0&&!(I!=null&&I.trim())){k("Please add at least one medication or provide a prescription."),E(!1);return}const J={items:u.map(ne=>({drug_id:ne.drug_id??null,name:ne.name,pack_quantity:ne.loosePacks??0,loose_quantity:ne.looseUnits??0,pack_price:ne.pack_price??0,loose_price:ne.loose_price??0,total_price:(ne.loose_price??0)*(ne.looseQuantity??0),discount_percentage:ne.discount_percentage??0,directions_to_use:ne.directions_to_use??null,tabletsPerDay:ne.tabletsPerDay??1,numberOfDays:ne.numberOfDays??1})),prescription_for_unavailable_drugs:I,order_total:ee};try{if(!(await pe(`/api/pharmacy-orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)})).ok)throw new Error("Failed to update order");alert("Pharmacy order updated successfully!"),n(-1)}catch(ne){k(ne.message||"Failed to update order.")}finally{E(!1)}};return V?i.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading order details..."}):t?i.jsxs("div",{className:"add-pharmacy-order-page p-4 md:p-8 max-w-7xl mx-auto",children:[i.jsx("div",{className:"page-header",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"back-button",title:"Go Back",children:i.jsx(Lt,{size:20})}),i.jsxs("div",{children:[i.jsx("h2",{children:"Edit Order"}),i.jsxs("span",{className:"text-sm text-gray-500 font-mono",children:["#",t.id.substring(0,8)]})]})]})}),i.jsxs("form",{onSubmit:le,className:"pharmacy-order-grid animate-fade-in",children:[i.jsxs("div",{className:"order-main-column",children:[i.jsxs("div",{className:"content-panel mb-6",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(Si,{size:18,className:"text-indigo-400"})," Add Medication"]}),i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(Si,{className:"search-icon",size:18}),i.jsx("input",{type:"text",placeholder:"Search for drugs...",value:h,onChange:U=>g(U.target.value),className:"custom-text-input"})]}),b.length>0&&i.jsx("div",{className:"search-results-dropdown",children:b.map(U=>i.jsx("div",{onClick:()=>q(U),className:"search-result-item",children:i.jsxs("div",{className:"flex justify-between w-full",children:[i.jsxs("div",{children:[i.jsx("span",{className:"drug-name",children:U.name||U.brand_name}),i.jsxs("span",{className:"drug-meta text-xs",children:["Stock: ",U.quantity_in_stock]})]}),i.jsx("div",{className:"text-right",children:i.jsxs("span",{className:"text-indigo-300 font-mono",children:["",Number(U.price).toFixed(2)]})})]})},U.id))})]})]}),i.jsxs("div",{className:"content-panel min-h-[400px]",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(To,{size:18,className:"text-indigo-400"})," Order Items (",u.length,")"]}),u.length===0?i.jsxs("div",{className:"empty-state",children:[i.jsx(To,{size:48,className:"empty-icon mx-auto",strokeWidth:1}),i.jsx("p",{className:"empty-text",children:"No medications in order"})]}):i.jsx("div",{className:"order-table-container",children:i.jsxs("table",{className:"order-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{width:"30%"},children:"Drug Name"}),i.jsx("th",{children:"Directions"}),i.jsx("th",{children:"Qty (Packs/Loose)"}),i.jsx("th",{children:"Price"}),i.jsx("th",{})]})}),i.jsx("tbody",{children:u.map((U,J)=>{const ne=U.drug_id??U.name,A=(U.loose_price??0)*(U.looseQuantity??0);return i.jsxs("tr",{className:"group",children:[i.jsxs("td",{children:[i.jsx("span",{className:"drug-name",children:U.name}),i.jsxs("span",{className:"drug-meta",children:["Stock: ",U.stock,"  Box of ",$(U.unit)||1]})]}),i.jsx("td",{children:i.jsx("input",{type:"text",placeholder:"Directions...",value:U.directions_to_use||"",onChange:ae=>{const ce=ae.target.value;d(M=>M.map(de=>(de.drug_id??de.name)===ne?{...de,directions_to_use:ce}:de))},className:"table-input w-full"})}),i.jsx("td",{children:i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("div",{className:"qty-input-group",children:[i.jsx("span",{className:"text-xs text-gray-500 w-8",children:"Pks:"}),i.jsx("input",{type:"number",min:"0",value:U.loosePacks,onChange:ae=>R(ne,parseInt(ae.target.value,10)),className:"table-input medium"})]}),i.jsxs("div",{className:"qty-input-group",children:[i.jsx("span",{className:"text-xs text-gray-500 w-8",children:"Unit:"}),i.jsx("input",{type:"number",min:"0",value:U.looseUnits,onChange:ae=>G(ne,parseInt(ae.target.value,10)),className:"table-input medium"})]})]})}),i.jsx("td",{children:i.jsxs("div",{className:"font-mono text-sm",children:["",A.toFixed(2)]})}),i.jsx("td",{children:i.jsx("button",{type:"button",onClick:()=>O(ne),className:"delete-btn opacity-0 group-hover:opacity-100",title:"Remove Item",children:i.jsx(Ri,{size:16})})})]},`${ne}-${J}`)})})]})})]}),i.jsxs("div",{className:"content-section mt-6",children:[i.jsx("label",{className:"text-sm font-medium text-gray-400 mb-2 block",children:"Prescription Notes"}),i.jsx("textarea",{rows:3,value:I??"",onChange:U=>P(U.target.value||null),placeholder:"Additional notes...",className:"custom-text-input bg-zinc-900/50 border border-zinc-800 rounded-lg w-full resize-none"})]})]}),i.jsxs("div",{className:"order-sidebar",children:[i.jsxs("div",{className:"patient-card mb-6",children:[i.jsx("div",{className:"patient-avatar",children:((K=a==null?void 0:a.name)==null?void 0:K.charAt(0).toUpperCase())||i.jsx(Fs,{})}),i.jsx("h3",{className:"patient-name",children:a==null?void 0:a.name}),i.jsx("div",{className:"patient-meta",children:i.jsxs("span",{children:["Token: #",(a==null?void 0:a.token)||"N/A"]})}),i.jsxs("div",{className:"flex justify-between border-t border-gray-700 pt-3 mt-3 px-2",children:[i.jsxs("span",{className:"text-sm text-gray-400 flex items-center gap-1",children:[i.jsx(Ym,{size:14})," Date"]}),i.jsx("span",{className:"text-sm text-white",children:new Date(t.date).toLocaleDateString()})]}),i.jsxs("div",{className:"flex justify-between pt-2 px-2",children:[i.jsx("span",{className:"text-sm text-gray-400",children:"Status"}),i.jsx("span",{className:`status-badge ${t.status}`,children:t.status})]})]}),i.jsxs("div",{className:"content-panel order-summary-container",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(M_,{size:18,className:"text-indigo-400"})," Summary"]}),i.jsx("div",{className:"summary-details",children:i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Item Count"}),i.jsx("span",{children:u.length})]})}),i.jsxs("div",{className:"summary-total",children:[i.jsx("span",{className:"total-label",children:"Grand Total"}),i.jsxs("span",{className:"total-value",children:["",te]})]}),N&&i.jsxs("div",{className:"p-3 bg-red-900/20 border border-red-500/50 rounded-lg flex items-start gap-2 text-sm text-red-200",children:[i.jsx(ti,{size:16,className:"shrink-0 mt-0.5"}),i.jsx("span",{children:N})]}),i.jsxs("button",{type:"submit",disabled:T,className:`floating-action-btn ${T?"disabled":""}`,children:[T?i.jsx("div",{className:"spinner"}):i.jsx(vb,{size:20,className:"btn-icon"}),T?"Updating...":"Update Order"]})]})]})]})]}):i.jsx("div",{className:"p-8 text-center text-red-400",children:"Order not found."})},tee=(e,n,t,r="non-black")=>{if(isNaN(e)||isNaN(n)||e<=0||n<=0)return null;let a;return t==="female"?e<=.7?a=141*Math.pow(e/.7,-.329)*Math.pow(.993,n):a=141*Math.pow(e/.7,-1.209)*Math.pow(.993,n):e<=.9?a=141*Math.pow(e/.9,-.411)*Math.pow(.993,n):a=141*Math.pow(e/.9,-1.209)*Math.pow(.993,n),r==="black"&&(a*=1.018),parseFloat(a.toFixed(2))},nee=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0||t>=400)return null;const r=e-n-t/5;return parseFloat(r.toFixed(2))},iee=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},ree=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},aee=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=e-(n+t);return parseFloat(r.toFixed(2))},see=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=2*e+n/18+t/2.8;return parseFloat(r.toFixed(2))},Wj=e=>["eGFR","LDL Cholesterol","Indirect Bilirubin","Globulin","Anion Gap","Osmolality"].includes(e),Qj=()=>{var te,le,K;const{orderId:e}=jr(),n=gt(),[t,r]=w.useState(null),[a,l]=w.useState({}),[o,f]=w.useState(!0),[u,d]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(null),[N,k]=w.useState(null),[T,E]=w.useState({}),[I,P]=w.useState(null),V=U=>{const J=document.querySelector(`[data-test-id='${U}']`);J&&(document.body.classList.add("printing-single-test"),J.classList.add("printing"),window.print())};w.useEffect(()=>{const U=()=>{document.body.classList.remove("printing-single-test");const J=document.querySelector(".printing");J&&J.classList.remove("printing")};return window.addEventListener("afterprint",U),()=>{window.removeEventListener("afterprint",U)}},[]);const F=()=>{t&&hw(t)},$=w.useCallback(async U=>{var J;try{const ne=await pe(`/api/patients/${U}`);if(!ne.ok)throw new Error(`Failed to fetch patient details: ${ne.status}`);const A=await ne.json();v(A.age),k(((J=A.sex)==null?void 0:J.toLowerCase())==="female"?"female":"male")}catch(ne){console.error("Error fetching patient details:",ne),v(null),k(null)}},[]),B=w.useCallback(async()=>{if(e){f(!0),g(null);try{const U=await pe(`/api/lab/${e}`);if(!U.ok){const A=await U.json().catch(()=>({message:`HTTP error! status: ${U.status}`}));throw new Error(A.message||`HTTP error! status: ${U.status}`)}const J=await U.json();r(J),J.patient_id&&$(J.patient_id);const ne={};if(J.tests&&J.tests.forEach(A=>{ne[A.id]={},A.default_parameters&&A.default_parameters.length>0?A.default_parameters.forEach(ae=>{ne[A.id][ae.name]=ae.defaultValue}):ne[A.id].report_content=""}),J.report_content)try{const A=JSON.parse(J.report_content);if(typeof A=="object"&&A!==null&&!Array.isArray(A)){const ae={...ne};Object.keys(A).forEach(ce=>{ae[ce]?ae[ce]={...ae[ce],...A[ce]}:ae[ce]=A[ce]}),l(ae)}else console.warn("Legacy or unexpected report content format detected. Initializing with defaults."),l(ne)}catch{console.warn("Legacy report content detected (not JSON). Initializing with defaults."),l(ne)}else l(ne)}catch(U){console.error("Failed to fetch lab order details:",U),g(U instanceof Error?U.message:"An unknown error occurred while fetching order details.")}finally{f(!1)}}},[e,$]);w.useEffect(()=>{e?B():(g("No Order ID provided in the URL."),f(!1))},[e,B]);const z=(U,J,ne)=>{l(A=>{var Ee,De,nt,lt,Xe,Mt,_t,an,se,Q,ie,je,Ae,Be,st,pt,dt,ze,Ke;const ae={...A,[U]:{...A[U],[J]:ne}},ce=parseFloat((Ee=ae[U])==null?void 0:Ee.Creatinine),M=b,de=N;if(J==="Creatinine"&&!isNaN(ce)&&M!==null&&de!==null){const Fe=tee(ce,M,de);Fe!==null&&((De=t==null?void 0:t.tests.find(Qe=>Qe.id===U))!=null&&De.default_parameters.find(Qe=>Qe.name==="eGFR"))&&(ae[U].eGFR=Fe)}const Se=parseFloat((nt=ae[U])==null?void 0:nt["Total Cholesterol"]),fe=parseFloat((lt=ae[U])==null?void 0:lt["HDL Cholesterol"]),we=parseFloat((Xe=ae[U])==null?void 0:Xe.Triglycerides);if((J==="Total Cholesterol"||J==="HDL Cholesterol"||J==="Triglycerides")&&!isNaN(Se)&&!isNaN(fe)&&!isNaN(we)){const Fe=nee(Se,fe,we);Fe!==null&&((Mt=t==null?void 0:t.tests.find(Qe=>Qe.id===U))!=null&&Mt.default_parameters.find(Qe=>Qe.name==="LDL Cholesterol"))&&(ae[U]["LDL Cholesterol"]=Fe)}const re=parseFloat((_t=ae[U])==null?void 0:_t["Total Bilirubin"]),_e=parseFloat((an=ae[U])==null?void 0:an["Direct Bilirubin"]);if((J==="Total Bilirubin"||J==="Direct Bilirubin")&&!isNaN(re)&&!isNaN(_e)){const Fe=iee(re,_e);Fe!==null&&((se=t==null?void 0:t.tests.find(Qe=>Qe.id===U))!=null&&se.default_parameters.find(Qe=>Qe.name==="Indirect Bilirubin"))&&(ae[U]["Indirect Bilirubin"]=Fe)}const qe=parseFloat((Q=ae[U])==null?void 0:Q["Total Protein"]),et=parseFloat((ie=ae[U])==null?void 0:ie.Albumin);if((J==="Total Protein"||J==="Albumin")&&!isNaN(qe)&&!isNaN(et)){const Fe=ree(qe,et);Fe!==null&&((je=t==null?void 0:t.tests.find(Qe=>Qe.id===U))!=null&&je.default_parameters.find(Qe=>Qe.name==="Globulin"))&&(ae[U].Globulin=Fe)}const Je=parseFloat((Ae=ae[U])==null?void 0:Ae.Sodium),Le=parseFloat((Be=ae[U])==null?void 0:Be.Chloride),xe=parseFloat((st=ae[U])==null?void 0:st.Bicarbonate);if((J==="Sodium"||J==="Chloride"||J==="Bicarbonate")&&!isNaN(Je)&&!isNaN(Le)&&!isNaN(xe)){const Fe=aee(Je,Le,xe);Fe!==null&&((pt=t==null?void 0:t.tests.find(Qe=>Qe.id===U))!=null&&pt.default_parameters.find(Qe=>Qe.name==="Anion Gap"))&&(ae[U]["Anion Gap"]=Fe)}const Me=parseFloat((dt=ae[U])==null?void 0:dt.Glucose),ve=parseFloat((ze=ae[U])==null?void 0:ze.BUN);if((J==="Sodium"||J==="Glucose"||J==="BUN")&&!isNaN(Je)&&!isNaN(Me)&&!isNaN(ve)){const Fe=see(Je,Me,ve);Fe!==null&&((Ke=t==null?void 0:t.tests.find(Qe=>Qe.id===U))!=null&&Ke.default_parameters.find(Qe=>Qe.name==="Osmolality"))&&(ae[U].Osmolality=Fe)}return ae})},q=async(U,J)=>{if(!e){alert("Cannot submit report without an Order ID.");return}if(!a[U]||Object.keys(a[U]).length===0){alert(`Please enter data for ${J} before saving.`);return}P(U),g(null);try{const A={...t!=null&&t.report_content?JSON.parse(t.report_content):{}};A[U]=a[U];const ae=await pe(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(A)})});if(!ae.ok){const ce=await ae.json().catch(()=>({message:`Submission failed: ${ae.status}`}));throw new Error(ce.message||`Submission failed: ${ae.status}`)}t&&r({...t,report_content:JSON.stringify(A)}),alert(`Report for ${J} saved successfully!`)}catch(ne){console.error(`Error submitting report for ${J}:`,ne),alert(`Failed to save report for ${J}: ${ne instanceof Error?ne.message:"Unknown error"}`)}finally{P(null)}},O=async()=>{if(Object.keys(a).length===0){alert("Report content cannot be empty.");return}if(!e){alert("Cannot submit report without an Order ID.");return}d(!0),g(null);try{const U=await pe(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(a)})});if(!U.ok){const J=await U.json().catch(()=>({message:`Submission failed: ${U.status}`}));throw new Error(J.message||`Submission failed: ${U.status}`)}alert("Report submitted successfully!"),n(-1)}catch(U){console.error("Error submitting report:",U),g(U instanceof Error?U.message:"An unknown error occurred during submission.")}finally{d(!1)}};if(o)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",style:{textAlign:"center",padding:"50px"},children:[" ",i.jsxs("div",{className:"loading-text",children:[i.jsx(Dd,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading details..."]})]})});if(h&&!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card error-message-container",style:{textAlign:"center",padding:"30px"},children:[i.jsx(ti,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("h3",{className:"error-title",style:{borderBottom:"none"},children:"Error Loading Details"}),i.jsx("p",{className:"error-text",children:h}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"20px"},children:[i.jsx(Lt,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});if(!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(Il,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("p",{className:"no-data-message",style:{fontSize:"1.1em"},children:`Lab order not found for ID: ${e}.`}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"15px"},children:[i.jsx(Lt,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});const R=(te=t==null?void 0:t.Patient)==null?void 0:te.name,G=(le=t==null?void 0:t.Patient)==null?void 0:le.patient_token_number,ee=`Enter Report for Order #${(t==null?void 0:t.lab_token_number)??e}`;return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"none",paddingBottom:0,marginBottom:0},children:[" ",i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:ee})," ",i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs("button",{onClick:()=>window.print(),className:"lab-inventory-button",disabled:u,"aria-label":"Print report",children:[i.jsx(Rs,{size:16,style:{marginRight:"5px"}}),"Print"]}),i.jsxs("button",{onClick:F,className:"lab-inventory-button",disabled:u||!((K=t==null?void 0:t.Patient)!=null&&K.phone)||!(t!=null&&t.report_content),"aria-label":"Share report via WhatsApp",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},children:[i.jsx(A_,{size:16,style:{marginRight:"5px"}}),"WhatsApp"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",disabled:u,children:[i.jsx(Lt,{size:16,style:{marginRight:"5px"}}),"Back"]})]})]}),t&&i.jsxs("div",{className:"lab-inventory-card printable-section patient-info-section",style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:[i.jsx(Il,{size:18,className:"no-print",style:{marginRight:"8px",verticalAlign:"middle"}})," Order Summary"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"10px",fontSize:"0.95em"},children:[i.jsxs("div",{children:[i.jsx(Fs,{size:15,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Patient:"})," ",R??"N/A"," (Token: ",G??"N/A",")"]}),i.jsxs("div",{children:[i.jsx(rs,{size:15,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Order Token:"})," ",t.lab_token_number??"N/A"]}),i.jsxs("div",{children:[i.jsx(wP,{size:15,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Order Date:"})," ",Eh(new Date(t.createdAt),"PPpp")]}),i.jsxs("div",{style:{gridColumn:"1 / -1"},children:[i.jsx(rI,{size:15,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Tests:"})," ",(t.tests||[]).map(U=>U.name).join(", ")]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:oee(t.status),children:lee(t.status)})]})]})]}),i.jsxs("div",{className:"printable-section",style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:[i.jsx(rs,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}}),"Lab Report"]}),t==null?void 0:t.tests.map(U=>{var J;return i.jsxs("div",{"data-test-id":U.id,className:"lab-inventory-card test-report-container",style:{marginBottom:"15px"},children:[i.jsxs("div",{className:"lab-inventory-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[i.jsx("h4",{style:{fontSize:"1.1em",margin:0},children:U.name}),i.jsx("div",{className:"no-print",style:{display:"flex",gap:"10px"},children:i.jsx("button",{onClick:()=>V(U.id),className:"lab-inventory-button print-test-button","aria-label":`Print ${U.name}`,children:i.jsx(Rs,{size:16})})})]}),U.default_parameters&&U.default_parameters.length>0?i.jsx(i.Fragment,{children:i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Parameter"}),i.jsx("th",{children:"Value"}),i.jsx("th",{children:"Normal Range"})]})}),i.jsx("tbody",{children:U.default_parameters.map(ne=>{var de,Se,fe;const A=(de=a[U.id])==null?void 0:de[ne.name],ae=typeof A=="string"?parseFloat(A):typeof A=="number"?A:NaN,ce=ne.type==="number"&&!isNaN(ae)&&A!==""&&A!==null&&A!==void 0&&(ne.lower_limit!=null&&ae<ne.lower_limit||ne.upper_limit!=null&&ae>ne.upper_limit),M=ne.type==="boolean"&&(A===!0||A==="true");return i.jsxs("tr",{children:[i.jsxs("td",{style:{fontWeight:"500"},children:[ne.name,ne.unit&&i.jsxs("span",{style:{color:"#6b7280",fontSize:"0.9em"},children:[" (",ne.unit,")"]})]}),i.jsxs("td",{className:`${ce?"abnormal-result":""} ${M?"reactive-result":""}`,children:[i.jsxs("div",{className:"no-print",children:[ne.type==="boolean"?i.jsxs("select",{id:`${U.id}-${ne.name}`,value:(A==null?void 0:A.toString())??"false",onChange:we=>z(U.id,ne.name,we.target.value==="true"),className:"lab-inventory-input",style:{margin:0,width:"100%"},disabled:u,children:[i.jsx("option",{value:"false",children:"Non-Reactive"}),i.jsx("option",{value:"true",children:"Reactive"})]}):i.jsx("input",{id:`${U.id}-${ne.name}`,type:ne.type==="number"?"number":"text",value:A??"",onChange:we=>{const re=ne.type==="number"&&we.target.value===""?0:we.target.value;z(U.id,ne.name,re)},className:"lab-inventory-input",style:{margin:0,width:"100%"},disabled:u||Wj(ne.name)&&!((Se=T[U.id])!=null&&Se[ne.name]),placeholder:`Enter ${ne.name.toLowerCase()}`}),Wj(ne.name)&&i.jsx("button",{type:"button",onClick:()=>E(we=>{var re;return{...we,[U.id]:{...we[U.id]||{},[ne.name]:!((re=we[U.id])!=null&&re[ne.name])}}}),className:"lab-inventory-button lab-inventory-button-tertiary",style:{fontSize:"0.75em",padding:"3px 8px",marginTop:"5px"},disabled:u,children:(fe=T[U.id])!=null&&fe[ne.name]?"Lock":"Edit"})]}),i.jsx("span",{className:"print-only",children:ne.type==="boolean"?A===!0||A==="true"?"Reactive":"Non-Reactive":`${A??""} ${ne.unit??""}`})]}),i.jsx("td",{style:{color:"#6b7280",fontSize:"0.9em"},children:ne.type==="number"&&(ne.lower_limit!==null||ne.upper_limit!==null)?i.jsxs(i.Fragment,{children:[ne.lower_limit!=null&&`> ${ne.lower_limit}`,ne.lower_limit!=null&&ne.upper_limit!=null&&" - ",ne.upper_limit!=null&&`< ${ne.upper_limit}`,ne.unit&&` ${ne.unit}`]}):ne.type==="boolean"?"Non-Reactive":"N/A"})]},ne.name)})})]})}):i.jsxs("div",{className:"lab-inventory-form-group no-print",children:[i.jsx("label",{htmlFor:`${U.id}-report_content`,children:"Report Content"}),i.jsx("textarea",{id:`${U.id}-report_content`,value:((J=a[U.id])==null?void 0:J.report_content)??"",onChange:ne=>z(U.id,"report_content",ne.target.value),className:"lab-inventory-input",rows:5,placeholder:`Enter report for ${U.name}...`,disabled:u})]}),i.jsx("div",{className:"no-print",style:{marginTop:"15px",textAlign:"right"},children:i.jsx("button",{type:"button",onClick:()=>q(U.id,U.name),disabled:u||I===U.id,className:"lab-inventory-button",style:{fontSize:"0.9em",padding:"8px 16px"},children:I===U.id?i.jsxs(i.Fragment,{children:[i.jsx(Dd,{className:"animate-spin mr-2",size:14})," Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Id,{size:14,style:{marginRight:"5px"}})," Save ",U.name]})})})]},U.id)}),h&&i.jsxs("p",{className:"error-text no-print",style:{marginTop:"10px"},children:[i.jsx(ti,{size:15,className:"inline mr-1"}),h]})]}),i.jsxs("div",{className:"no-print",style:{marginTop:"20px",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[" ",i.jsx("button",{type:"button",onClick:()=>n(-1),disabled:u,className:"lab-inventory-button lab-inventory-button-secondary",children:"Cancel"}),i.jsx("button",{type:"button",onClick:O,disabled:u||Object.keys(a).length===0,className:"lab-inventory-button",children:u?i.jsxs(i.Fragment,{children:[i.jsx(Dd,{className:"animate-spin mr-2",size:16})," Submitting..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Id,{size:16,style:{marginRight:"5px"}})," Submit All Reports"]})})]})]})})},lee=e=>e?e.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()):"Unknown",oee=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},cee=()=>{const{orderId:e}=jr(),n=gt(),[t,r]=w.useState(null),[a,l]=w.useState(!0),[o,f]=w.useState(null),u=w.useCallback(async g=>{if(!g){f("No Order ID specified in the URL."),l(!1),r(null);return}l(!0),f(null),r(null);try{console.log(`Fetching order details for ID: ${g}`);const b=await pe(`/api/lab/orders/${g}/report`);if(!b.ok){let N;try{N=await b.json()}catch{N={message:`Server returned status ${b.status}`}}throw console.error("Fetch order details error response:",N),new Error(N.message||`Failed to fetch order details: ${b.status}`)}const v=await b.json();if(console.log("Received order data:",v),!v)throw console.error("Invalid order data structure:",v),new Error("Invalid order data received from server.");r(v)}catch(b){console.error("Error fetching order details:",b),f(b instanceof Error?b.message:"An unknown error occurred while fetching the order details")}finally{l(!1)}},[pe]);w.useEffect(()=>{u(e)},[e,u]);const d=g=>{const b=document.querySelector(`[data-test-id='${g}']`);b&&(document.body.classList.add("printing-single-test"),b.classList.add("printing"),window.print())};w.useEffect(()=>{const g=()=>{document.body.classList.remove("printing-single-test");const b=document.querySelector(".printing");b&&b.classList.remove("printing")};return window.addEventListener("afterprint",g),()=>{window.removeEventListener("afterprint",g)}},[]);const h=()=>{t&&hw(t)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:0,paddingBottom:0,borderBottom:"none"},children:[i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:"Lab Report Viewer"})," ",i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs(is,{to:"/lab/search-report",className:"lab-inventory-button","aria-label":"Search for other reports",children:[i.jsx(Si,{size:16,style:{marginRight:"5px"}}),"Search Reports"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(Lt,{size:16,style:{marginRight:"5px"}}),"Back"]}),i.jsxs("button",{onClick:()=>window.print(),className:"lab-inventory-button","aria-label":"Print report",children:[i.jsx(Rs,{size:16,style:{marginRight:"5px"}}),"Print"]}),i.jsxs("button",{onClick:h,className:"lab-inventory-button","aria-label":"Share report via WhatsApp",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},children:[i.jsx(A_,{size:16,style:{marginRight:"5px"}}),"WhatsApp"]})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:["Report Details (Order ID: ",e||"None Specified",")"]}),a&&i.jsx("div",{className:"loading-text",children:"Loading report..."}),o&&!a&&i.jsxs("div",{className:"error-message-container",style:{textAlign:"center"},children:[i.jsx(ti,{size:48}),i.jsx("h3",{className:"error-title",children:"Error Loading Report"}),i.jsx("p",{children:o}),e&&i.jsx("button",{onClick:()=>u(e),className:"retry-button",children:"Retry"})]}),i.jsxs("div",{className:"printable-section",children:[!a&&!o&&(t==null?void 0:t.Patient)&&i.jsxs("div",{className:"lab-inventory-card",style:{marginBottom:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(Fs,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Patient Information"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"10px",fontSize:"0.9em"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Name:"})," ",t.Patient.name||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Age:"})," ",t.Patient.age??"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Gender:"})," ",t.Patient.gender||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Token No:"})," ",t.Patient.patient_token_number||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Patient ID:"})," ",t.Patient.id]}),t.Patient.phone&&i.jsxs("div",{children:[i.jsx("strong",{children:"Phone:"})," ",t.Patient.phone]})]})]}),!a&&!o&&(t==null?void 0:t.report_content)&&i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(rs,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Report Findings"]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6"},children:(()=>{try{const g=JSON.parse(t.report_content||"{}");return typeof g=="object"&&g!==null&&t.tests?t.tests.map(b=>i.jsxs("div",{"data-test-id":b.id,className:"test-report-container",style:{marginBottom:"20px"},children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h4",{style:{fontSize:"1.1em",margin:0},children:b.name}),i.jsx("button",{onClick:()=>d(b.id),className:"lab-inventory-button print-test-button","aria-label":`Print ${b.name}`,children:i.jsx(Rs,{size:16})})]}),g[b.id]?i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Parameter"}),i.jsx("th",{children:"Value"}),i.jsx("th",{children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(g[b.id]).map(([v,N])=>{var V;const k=(V=b.default_parameters)==null?void 0:V.find(F=>F.name===v),T=typeof N=="string"?parseFloat(N):typeof N=="number"?N:NaN,E=(k==null?void 0:k.type)==="number"&&!isNaN(T)&&(k.lower_limit!=null&&T<k.lower_limit||k.upper_limit!=null&&T>k.upper_limit),I=(k==null?void 0:k.type)==="boolean"?N===!0||N==="true"?"Reactive":"Non-Reactive":String(N),P=(k==null?void 0:k.type)==="boolean"&&(N===!0||N==="true");return i.jsxs("tr",{children:[i.jsx("td",{children:v}),i.jsxs("td",{className:`${E?"abnormal-result":""} ${P?"reactive-result":""}`,children:[I," ",k==null?void 0:k.unit]}),i.jsx("td",{children:k&&k.type==="number"&&(k.lower_limit!==null||k.upper_limit!==null)?i.jsxs(i.Fragment,{children:[k.lower_limit!=null&&` > ${k.lower_limit}`,k.lower_limit!=null&&k.upper_limit!=null&&" - ",k.upper_limit!=null&&` < ${k.upper_limit}`,k.unit&&` ${k.unit}`]}):((k==null?void 0:k.type)==="boolean","N/A")})]},v)})})]}):i.jsx("p",{children:"No parameters reported for this test."})]},b.id)):i.jsx(Bc,{remarkPlugins:[Co],children:t.report_content})}catch{return i.jsx(Bc,{remarkPlugins:[Co],children:t.report_content||"*No findings recorded.*"})}})()})]})]}),!a&&!o&&!(t!=null&&t.report_content)&&!(t!=null&&t.Patient)&&e&&i.jsxs("div",{className:"no-data-message",children:["No report content or patient details found for Order ID: ",e,". The order might be processing, does not exist, or the ID is incorrect."]}),!e&&!a&&!o&&i.jsxs("div",{className:"no-data-message",children:["No order ID specified in the URL.",i.jsx(is,{to:"/lab/search-report",className:"lab-inventory-link",style:{display:"block",marginTop:"10px"},children:"Go to Search Page"})]})]})]})})},uee=()=>{const e=gt(),[n,t]=w.useState(""),[r,a]=w.useState(!1),[l,o]=w.useState([]),[f,u]=w.useState(null),[d,h]=w.useState(n);w.useEffect(()=>{const k=setTimeout(()=>{h(n)},500);return()=>{clearTimeout(k)}},[n]),w.useEffect(()=>{g()},[d]);const g=async()=>{const k=n.trim();if(!k){o([]),u(null);return}a(!0),u(null),o([]),console.log(`Searching for: ${k}`);try{const T=await pe("/api/lab");if(!T.ok){let $;try{$=await T.json()}catch{$={message:`Server returned status ${T.status}`}}throw console.error("Search fetch error response:",$),new Error($.message||`HTTP error! status: ${T.status}`)}const{orders:E}=await T.json();console.log("Received lab orders for search:",E);const P=E.filter($=>!!$.report_content).map($=>{var B,z;return{id:$.id,labTokenNumber:String($.lab_token_number??"N/A"),patientName:((B=$.Patient)==null?void 0:B.name)||"N/A",patientId:$.patient_id,patientTokenNumber:String(((z=$.Patient)==null?void 0:z.patient_token_number)??"N/A"),tests:($.tests||[]).map(q=>q.name||"Unknown Test"),date:Eh(new Date($.createdAt),"yyyy-MM-dd"),status:$.status}}),V=n.toLowerCase(),F=P.filter($=>{var q,O,R,G,ee;const B=String($.labTokenNumber).toLowerCase(),z=String($.patientTokenNumber).toLowerCase();return(((q=$.patientName)==null?void 0:q.toLowerCase())||"").includes(V)||B.includes(V)||z.includes(V)||(((R=(O=$.tests)==null?void 0:O.join(" "))==null?void 0:R.toLowerCase())||"").includes(V)||(((G=$.id)==null?void 0:G.toLowerCase())||"").includes(V)||(((ee=$.patientId)==null?void 0:ee.toLowerCase())||"").includes(V)});console.log("Filtered search results:",F),o(F),F.length===0&&k?u(`No matching reports found for "${k}".`):u(null)}catch(T){console.error("Failed to search lab reports:",T),u(T instanceof Error?T.message:"An unknown error occurred during search")}finally{a(!1)}},b=k=>{console.log(`Result clicked, navigating to view report for order ID: ${k}`),e(`/lab/view-report/${k}`)},v=k=>{switch(k){case"pending":return{text:"Sample Pending",color:"text-red-600 bg-red-100"};case"collected":return{text:"Sample Collected",color:"text-yellow-600 bg-yellow-100"};case"processing":return{text:"Processing",color:"text-blue-600 bg-blue-100"};case"completed":return{text:"Completed",color:"text-green-600 bg-green-100"};case"cancelled":return{text:"Cancelled",color:"text-gray-600 bg-gray-100 line-through"};case"reported":return{text:"Reported",color:"text-purple-600 bg-purple-100"};default:return{text:k,color:"text-gray-600 bg-gray-100"}}},N=k=>{switch(k){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h2",{style:{margin:0},children:"Search Lab Reports"}),i.jsxs("button",{onClick:()=>e(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(Lt,{size:16,style:{marginRight:"5px"}}),"Back"]})]}),i.jsxs("div",{className:"lab-inventory-form-group",style:{marginTop:"20px",position:"relative"},children:[i.jsx("label",{htmlFor:"report-search",children:"Enter Search Term"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",position:"relative"},children:[i.jsx(Si,{size:20,style:{position:"absolute",left:"10px",color:"#777"}}),i.jsx("input",{id:"report-search",type:"text",placeholder:"Patient name, ID, token, report ID, test name...",value:n,onChange:k=>t(k.target.value),className:"lab-inventory-input",style:{paddingLeft:"40px",marginBottom:"0"}})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[r&&i.jsx("div",{className:"loading-text",children:"Searching..."}),f&&!r&&i.jsxs("div",{className:"error-text",children:[i.jsx(ti,{size:20,className:"inline mr-2"})," ",f]}),l.length>0&&!r&&i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:l.map(k=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(k.id),style:{marginBottom:"15px",cursor:"pointer",padding:"15px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:[i.jsx(FP,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}}),k.patientName," (Token: ",k.patientTokenNumber,")"]}),i.jsx("span",{className:N(k.status),children:v(k.status).text})]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:[i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(rs,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Order ID: ",k.id]}),i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(KI,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Tests: ",k.tests.join(", ")]}),i.jsxs("div",{children:[i.jsx(NP,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Date: ",k.date]})]})]},k.id))}),!r&&l.length===0&&!f&&n.trim()&&i.jsxs("div",{className:"no-data-message",children:['No results found for "',n,'".']}),!r&&l.length===0&&!f&&!n.trim()&&i.jsx("div",{className:"no-data-message",style:{backgroundColor:"transparent",border:"none",textAlign:"left",padding:"5px 0"},children:"Enter a search term above to find lab reports."})]})]})})},dee=()=>{const{patientId:e}=jr(),n=gt(),[t,r]=w.useState([]),[a,l]=w.useState(!0),[o,f]=w.useState(null),[u,d]=w.useState(null),[h,g]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){f("Patient ID is missing from the URL."),l(!1);return}l(!0),f(null),r([]),g(null);try{const N=await pe(`/api/patients/${e}`);if(N.ok){const E=await N.json();g(E.name||`Patient ID: ${e}`)}else console.warn(`Failed to fetch patient name for ID ${e}`),g(`Patient ID: ${e}`);const k=await pe(`/api/lab/patient/${e}`);if(!k.ok){const E=await k.json().catch(()=>({}));throw new Error(E.message||`HTTP error! status: ${k.status}`)}const T=await k.json();r(T||[])}catch(N){console.error("Error fetching data:",N),f(`Failed to load data: ${N.message}`)}finally{l(!1)}})()},[e]);const b=v=>{v.report_content?n(`/lab/view-report/${v.id}`):n(`/lab/enter-report/${v.id}`)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("h2",{style:{margin:0},children:["Lab Reports ",h?`for ${h}`:`for Patient ID: ${e}`]}),i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs("button",{onClick:async()=>{if(!e){alert("Patient ID is missing. Cannot create a new report.");return}try{const v=await pe("/api/lab/create-empty-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:e})});if(!v.ok){const k=await v.json().catch(()=>({message:`Failed to create new lab order: ${v.status}`}));throw new Error(k.message||`Failed to create new lab order: ${v.status}`)}const N=await v.json();n(`/lab/enter-report/${N.newOrderId}`)}catch(v){console.error("Error creating new lab order:",v),alert(`Error creating new lab order: ${v.message}`)}},className:"lab-inventory-button",disabled:!e,title:e?"Enter a new lab report for this patient":"Patient ID missing",children:[i.jsx(jo,{size:16,style:{marginRight:"5px"}}),"Enter New Report"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",children:[i.jsx(Lt,{size:16,style:{marginRight:"5px"}}),"Back"]})]})]}),i.jsx("div",{style:{marginTop:"20px"},children:a?i.jsxs("div",{className:"loading-text",children:[i.jsx(Dd,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading reports..."]}):o?i.jsxs("div",{className:"error-text",style:{textAlign:"center",padding:"20px"},children:[i.jsx(D_,{size:40,style:{marginBottom:"10px",color:"#721c24"}}),i.jsx("h3",{style:{fontSize:"1.2em",color:"#721c24",margin:"10px 0"},children:"Error Loading Reports"}),i.jsx("p",{children:o})]}):t.length===0?i.jsxs("div",{className:"no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(rs,{size:48,className:"mb-3",style:{margin:"0 auto 15px auto",display:"block"}}),i.jsx("p",{children:"No lab reports found for this patient."}),i.jsxs("p",{children:["You can ",i.jsx(is,{to:`/lab/create-order/${e}`,className:"lab-inventory-link",children:"create a new lab order"}),"."]})]}):u?i.jsxs("div",{className:"lab-inventory-card",style:{backgroundColor:"#fdfdfd"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.3em",borderBottom:"none",margin:0},children:["Report from: ",u.report_date?Eh(new Date(u.report_date),"PPP p"):"N/A"]}),i.jsxs("button",{onClick:()=>d(null),className:"lab-inventory-button lab-inventory-button-secondary",style:{fontSize:"0.9em",padding:"8px 12px"},children:[i.jsx(Lt,{size:16,style:{marginRight:"5px"}})," Back to List"]})]}),i.jsxs("p",{style:{marginBottom:"15px",fontSize:"1em"},children:[i.jsx("strong",{children:"Tests Ordered:"})," ",(u.tests||[]).map(v=>v.name).join(", ")]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6",border:"1px solid #eee",padding:"15px",borderRadius:"4px",background:"#fff"},children:i.jsx(Bc,{remarkPlugins:[Co],children:u.report_content||"*No findings recorded.*"})})]}):i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:t.map(v=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(v),tabIndex:0,onKeyPress:N=>N.key==="Enter"&&b(v),style:{marginBottom:"15px",cursor:"pointer",padding:"15px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx(rs,{size:24,style:{marginRight:"15px",color:"#007bff"}}),i.jsxs("div",{children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:["Order Date: ",Eh(new Date(v.createdAt),"PPP")]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:["Tests: ",v.tests&&v.tests.length>0?v.tests.map(N=>N.name).join(", "):"N/A"]})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[v.status&&i.jsx("span",{className:hee(v.status),children:fee(v.status)}),i.jsx(rg,{size:20,style:{color:"#6c757d"}})]})]},v.id))})})]})})},fee=e=>{if(!e)return"Unknown";switch(e.toLowerCase()){case"pending":return"Pending Sample";case"collected":return"Sample Collected";case"processing":return"Processing";case"report_ready":return"Report Ready";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return e.charAt(0).toUpperCase()+e.slice(1)}},hee=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},pT=()=>{const e=gt(),[n,t]=w.useState([]),[r,a]=w.useState([]),[l,o]=w.useState(!1),[f,u]=w.useState(null),[d,h]=w.useState(""),[g,b]=w.useState("all"),v=10,N=1;w.useEffect(()=>{(async()=>{o(!0),u(null);try{console.log("Fetching pharmacy inventory for view page...");const E=await pe("/api/drugs");if(!E.ok)throw new Error(`HTTP error! status: ${E.status}`);const I=await E.json();console.log("Fetched Pharmacy Inventory for view page:",I),t(I||[])}catch(E){console.error("Error fetching pharmacy inventory:",E),u("Failed to load pharmacy inventory.")}finally{}})()},[]),w.useEffect(()=>{(async()=>{try{console.log("Fetching lab inventory for view page...");const E=await pe("/api/lab-tests");if(!E.ok)throw new Error(`HTTP error! status: ${E.status}`);const I=await E.json();console.log("Fetched Lab Inventory for view page:",I),a(I||[])}catch(E){console.error("Error fetching lab inventory:",E),u(I=>I?`${I} & Failed to load lab inventory.`:"Failed to load lab inventory.")}finally{o(!1)}})()},[]);const k=w.useMemo(()=>{let T=n;return d&&(T=T.filter(E=>E.name.toLowerCase().includes(d.toLowerCase()))),g!=="all"&&(T=T.filter(E=>{const I=(E.quantity_in_stock??1/0)<=v;let P=!1,V=!1;if(E.expiry_date)try{const F=Kx(E.expiry_date);if(Qm(F)){const $=Uv(new Date,N),B=new Date;B.setHours(0,0,0,0),V=Td(F,B),P=!V&&Td(F,$)}}catch(F){console.error("Error parsing expiry date for filter:",E.expiry_date,F),P=!0}else P=!0;switch(g){case"low-stock":return I;case"near-expiry":return P;case"expired":return V;default:return!0}})),T},[n,d,g]);return i.jsxs("div",{className:"lab-inventory-container",children:[i.jsxs("div",{className:"lab-inventory-header",children:[i.jsx("h1",{children:"Inventory Overview"}),i.jsxs("button",{onClick:()=>e(-1),className:"lab-inventory-button lab-inventory-button-secondary",title:"Go Back",children:[i.jsx(Lt,{size:18,style:{marginRight:"5px"}})," Back"]})]}),l&&i.jsx("p",{className:"loading-text",children:"Loading inventory..."}),f&&i.jsx("p",{className:"error-text",children:f}),!l&&!f&&i.jsxs("div",{className:"inventory-sections-container",children:[i.jsxs("div",{className:"lab-inventory-card",children:[" ",i.jsxs("div",{className:"inventory-section__header-bar",children:[i.jsxs("h2",{className:"lab-inventory-header",children:[i.jsx(To,{size:24,style:{marginRight:"10px",verticalAlign:"middle"}})," Pharmacy Inventory"]}),i.jsxs("div",{className:"inventory-section__controls",children:[" ",i.jsxs("div",{className:"inventory-section__search-area",children:[i.jsx("input",{type:"text",placeholder:"Search drugs...",value:d,onChange:T=>h(T.target.value),className:"lab-inventory-input",style:{marginRight:"5px",marginBottom:"0"}}),i.jsx(Si,{size:18,style:{color:"#777"}})]}),i.jsxs("div",{className:"inventory-section__filter-area",children:[" ",i.jsxs("select",{value:g,onChange:T=>b(T.target.value),className:"lab-inventory-select",children:[i.jsx("option",{value:"all",children:"All Drugs"}),i.jsx("option",{value:"low-stock",children:"Low Stock"}),i.jsx("option",{value:"near-expiry",children:"Near Expiry"}),i.jsx("option",{value:"expired",children:"Expired"})]})]})]})]}),k.length>0?i.jsxs("div",{className:"table-container",children:[" ",i.jsxs("div",{className:"table-scroll-wrapper",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Stock"}),i.jsx("th",{children:"Expiry Date"}),i.jsx("th",{children:"Buying Price"}),i.jsx("th",{children:"Selling Price"})]})}),i.jsx("tbody",{children:k.map(T=>{let E="N/A",I="";const P=(T.quantity_in_stock??1/0)<=v;if(T.expiry_date)try{const V=Kx(T.expiry_date);if(Qm(V)){E=Eh(V,"dd/MM/yyyy");const F=Uv(new Date,1),$=new Date;$.setHours(0,0,0,0),Td(V,$)?I="highlight-expired":Td(V,F)&&(I="highlight-near-expiry")}else E="Invalid Date",I="highlight-near-expiry"}catch(V){console.error("Error parsing expiry date:",T.expiry_date,V),E="Error Parsing",I="highlight-near-expiry"}else I="highlight-near-expiry";return i.jsxs("tr",{children:[i.jsx("td",{children:T.name}),i.jsx("td",{children:i.jsx("span",{className:`highlight-box ${P?"highlight-low-stock":""}`,children:T.quantity_in_stock??"N/A"})}),i.jsx("td",{children:i.jsx("span",{className:`highlight-box ${I}`,children:E})}),i.jsx("td",{className:"price-text",children:T.buying_price?`${T.buying_price}`:"N/A"}),i.jsx("td",{className:"price-text",children:T.price?`${T.price}`:"N/A"})]},T.id)})})]})]})]}):i.jsx("p",{className:"no-data-message",children:d?`No drugs found matching "${d}".`:"No pharmacy inventory data available."})]}),i.jsxs("div",{className:"lab-inventory-card",children:[" ",i.jsxs("h2",{className:"lab-inventory-header inventory-section__lab-title",children:[i.jsx(J1,{size:24,style:{marginRight:"10px",verticalAlign:"middle"}})," Lab Test Inventory"]}),r.length>0?i.jsxs("div",{className:"table-container",children:[" ",i.jsxs("div",{className:"table-scroll-wrapper",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"})]})}),i.jsx("tbody",{children:r.map(T=>i.jsxs("tr",{children:[i.jsx("td",{children:T.name}),i.jsx("td",{className:"price-text",children:T.price?`${T.price}`:"N/A"})]},T.id))})]})]})]}):i.jsx("p",{className:"no-data-message",children:"No lab test inventory data available."})]})]})]})},pee=({fetchWithAuth:e})=>{const n=gt(),[t,r]=w.useState(!0),[a,l]=w.useState([]),[o,f]=w.useState(null),[u,d]=w.useState(null),h=w.useCallback(async()=>{r(!0),f(null);try{const N=await(await e("/staff")).json();l(N.map(k=>({...k,id:k._id||k.id})))}catch(v){f(`Failed to load staff data: ${v.message}`),l([])}finally{r(!1)}},[e]);w.useEffect(()=>{h()},[h]),w.useEffect(()=>{if(u){const v=setTimeout(()=>d(null),5e3);return()=>clearTimeout(v)}},[u]);const g=v=>{switch(v){case"doctor":return"admin-pill-info";case"receptionist":return"admin-pill-success";case"pharmacy":return"admin-pill-primary";case"lab":return"admin-pill-warning";case"admin":return"admin-pill-neutral";default:return"admin-pill-neutral"}},b=v=>{switch(v){case"doctor":return i.jsx(YI,{size:16,className:"mr-2 text-blue-600"});case"receptionist":return i.jsx(P_,{size:16,className:"mr-2 text-green-600"});case"pharmacy":return i.jsx(To,{size:16,className:"mr-2 text-purple-600"});case"lab":return i.jsx(Gx,{size:16,className:"mr-2 text-yellow-600"});case"admin":return i.jsx(ag,{size:16,className:"mr-2 text-teal-600"});default:return i.jsx(kh,{size:16,className:"mr-2 text-gray-500"})}};return t?i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:[" ",i.jsx("div",{className:"breathing-ball",style:{width:"30px",height:"30px"}})," "]}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Staff..."})]})}):i.jsxs("div",{className:"staff-page-container",children:[u&&i.jsxs("div",{className:`mb-4 p-3 rounded-md flex items-center ${u.type==="success"?"bg-green-100 border border-green-400 text-green-700":"bg-red-100 border border-red-400 text-red-700"}`,role:"alert",children:[u.type==="success"?i.jsx(Ra,{size:18,className:"mr-2"}):i.jsx(ti,{size:18,className:"mr-2"}),i.jsx("span",{children:u.message}),i.jsx("button",{onClick:()=>d(null),className:"ml-auto text-xl font-bold",children:""})]}),o&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",role:"alert",children:[i.jsx(ti,{size:18,className:"mr-2 text-red-500"}),o,i.jsx("button",{onClick:()=>f(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"p-2 rounded-md hover:bg-gray-200",children:i.jsx(Lt,{size:20})}),i.jsx("h1",{className:"text-2xl font-bold",children:"Manage Staff"})]}),i.jsxs("button",{onClick:()=>n("/dashboard/staff/add"),className:"bg-teal-600 text-white px-4 py-2 rounded-md hover:bg-teal-700 flex items-center",children:[i.jsx(Ao,{size:16,className:"mr-2"})," Add New Staff"]})]}),i.jsx("div",{className:"staff-table-container",children:i.jsxs("table",{className:"staff-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{className:"hidden md:table-cell",children:"Email"}),i.jsx("th",{children:"Role"}),i.jsx("th",{className:"hidden md:table-cell",children:"OPD Fee ()"}),i.jsx("th",{className:"hidden md:table-cell",children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:a.length===0&&!t?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-4",children:"No staff members found."})}):a.map(v=>i.jsxs("tr",{children:[i.jsx("td",{children:v.name}),i.jsx("td",{className:"hidden md:table-cell",children:v.email}),i.jsx("td",{children:i.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g(v.role)}`,children:[b(v.role),v.role.charAt(0).toUpperCase()+v.role.slice(1)]})}),i.jsx("td",{className:"hidden md:table-cell",children:v.role==="doctor"?v.opd_fee?parseFloat(String(v.opd_fee)).toFixed(2):"Not Set":"N/A"}),i.jsx("td",{className:"hidden md:table-cell",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.status==="active"?"Active":"Inactive"})}),i.jsx("td",{className:"actions",children:i.jsxs("button",{onClick:()=>n(`/dashboard/staff/edit/${v.id}`),className:"edit-link",disabled:v.role==="admin",title:"Edit Staff",children:[i.jsx(Md,{size:16})," Edit"]})})]},v.id))})]})})]})},mee=()=>{var k,T,E,I,P,V,F,$,B,z,q,O,R,G;const{patientId:e,billId:n}=jr(),t=gt(),[r,a]=w.useState(null),[l,o]=w.useState(!0),[f,u]=w.useState(null),[d,h]=w.useState(""),[g,b]=w.useState("cash"),v=((k=r==null?void 0:r.patient)==null?void 0:k.insurance_type)==="no_cash_insurance";w.useEffect(()=>{b(v?"no_cash_insurance":"cash")},[v]),w.useEffect(()=>{n?(async()=>{o(!0),u(null);try{const te=await pe(`/api/bills/${n}`);if(!te.ok)throw new Error(`HTTP error! status: ${te.status}`);const le=await te.json();if(!le||!le.bill||!le.calculated)throw new Error("Incomplete data structure received from backend (missing bill or calculated fields).");if(le.bill.type!=="admission")throw console.error("Fetched bill is not an admission bill. Bill Type:",le.bill.type),new Error(`Unexpected bill type received: ${le.bill.type}. Expected 'admission'.`);console.log("Raw API data received:",JSON.stringify(le,null,2));const K=Array.isArray(le.admissionPayments)?le.admissionPayments:[];console.log("Processed admissionPaymentsData:",K);const U={...le.bill,amount:le.bill.amount,AdmissionPayments:K,calculated:le.calculated,patient:le.bill.Patient?{id:le.bill.Patient.id,name:le.bill.Patient.name,admission_date:le.bill.Patient.admission_date,discharge_date:le.bill.Patient.discharge_date}:void 0};console.log("Setting billDetails state to:",JSON.stringify(U,null,2)),a(U)}catch(te){console.error("Failed to fetch admission bill details:",te),u(te instanceof Error?te.message:"An unknown error occurred")}finally{o(!1)}})():(u("Bill ID is missing."),o(!1))},[n,e]);const N=async ee=>{var te;if(ee.preventDefault(),!e||!d||isNaN(parseFloat(d))||parseFloat(d)<=0||parseFloat(d)>(((te=r==null?void 0:r.calculated)==null?void 0:te.balance)??0)){u("Please enter a valid payment amount within the balance due. Patient ID must be present.");return}u(null);try{const le=await pe(`/api/patients/${e}/admission-payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount_paid:parseFloat(d),payment_mode:g})});if(!le.ok){const J=await le.json();throw new Error(J.message||`HTTP error! status: ${le.status}`)}const U=await(await pe(`/api/bills/${n}`)).json();if(U&&U.bill&&U.calculated&&U.admissionPayments)a({...U.bill,amount:parseFloat(U.bill.amount),AdmissionPayments:U.admissionPayments,calculated:U.calculated,patient:U.bill.Patient?{id:U.bill.Patient.id,name:U.bill.Patient.name,admission_date:U.bill.Patient.admission_date,discharge_date:U.bill.Patient.discharge_date}:void 0});else throw new Error("Invalid data structure received after payment submission.");h("")}catch(le){console.error("Failed to submit payment:",le),u(le instanceof Error?le.message:"Failed to record payment")}};return l?i.jsx("div",{className:"p-4",children:"Loading admission bill details..."}):f?i.jsxs("div",{className:"p-4 text-red-600",children:["Error: ",f]}):!r||!r.calculated?i.jsx("div",{className:"p-4",children:"No bill details found or data is incomplete."}):i.jsx("div",{className:"admission-page-container",children:i.jsxs("div",{className:"admission-section",children:[" ",i.jsxs("div",{className:"p-4 border-b",children:[" ",i.jsxs("h2",{className:"admission-header",children:["Admission Billing Details (Bill #",r.id,")"]}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Patient: ",((T=r.patient)==null?void 0:T.name)??"N/A"," (ID: ",r.patient_id,")"]})," ",i.jsxs("p",{className:"text-sm text-gray-600",children:["Admission Date: ",(E=r.patient)!=null&&E.admission_date?new Date(r.patient.admission_date).toLocaleDateString():"N/A"]}),((I=r.patient)==null?void 0:I.discharge_date)&&i.jsxs("p",{className:"text-sm text-gray-600",children:["Discharge Date: ",new Date(r.patient.discharge_date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm",children:["Status: ",i.jsx("span",{className:`font-semibold ${r.status==="paid"?"text-green-600":"text-orange-600"}`,children:((P=r.status)==null?void 0:P.toUpperCase())??"UNKNOWN"})]})]}),i.jsxs("div",{className:"p-4",children:[" ",i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Initial Charges:"})," ",i.jsxs("span",{children:["",(parseFloat((r==null?void 0:r.amount)||"0")||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Days Stayed:"})," ",i.jsx("span",{children:((V=r==null?void 0:r.calculated)==null?void 0:V.daysStayed)??0})]}),i.jsxs("p",{className:"flex justify-between text-sm font-semibold mt-2 pt-2 border-t",children:[i.jsx("span",{children:"Total Due:"})," ",i.jsxs("span",{children:["",(Number((F=r==null?void 0:r.calculated)==null?void 0:F.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[i.jsx("span",{children:"Total Paid:"})," ",i.jsxs("span",{children:["",(Number(($=r==null?void 0:r.calculated)==null?void 0:$.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-lg font-bold mt-1 text-red-600",children:[i.jsx("span",{children:"Balance Due:"})," ",i.jsxs("span",{children:["",(Number((B=r==null?void 0:r.calculated)==null?void 0:B.balance)||0).toFixed(2)]})]})]})]}),(r==null?void 0:r.status)!=="paid"&&(Number((z=r==null?void 0:r.calculated)==null?void 0:z.balance)||0)>0&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title text-blue-800",children:"Record New Payment"}),i.jsxs("form",{onSubmit:N,className:"space-y-4",children:[i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentAmount",className:"admission-label",children:"Amount Paid ()"}),i.jsx("input",{id:"paymentAmount",type:"number",value:d,onChange:ee=>h(ee.target.value),placeholder:`Max ${(Number((q=r==null?void 0:r.calculated)==null?void 0:q.balance)||0).toFixed(2)}`,required:!0,min:"0.01",step:"0.01",max:Number((O=r==null?void 0:r.calculated)==null?void 0:O.balance)||0,className:"admission-input"})]}),i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentMode",className:"admission-label",children:"Payment Mode"}),i.jsxs("select",{id:"paymentMode",value:g,onChange:ee=>b(ee.target.value),className:"admission-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"upi",children:"UPI"}),v&&i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),i.jsx("button",{type:"submit",className:"admission-button",disabled:l||!d||parseFloat(d)<=0||parseFloat(d)>(Number((R=r==null?void 0:r.calculated)==null?void 0:R.balance)||0)||v&&g!=="no_cash_insurance",children:"Record Payment"})]})]})]}),i.jsx("h3",{className:"admission-section-title mt-6 border-t pt-4",children:"Admission Payment History"}),Array.isArray(r==null?void 0:r.AdmissionPayments)&&r.AdmissionPayments.length>0?i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"admission-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Payment ID"}),i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Mode"})]})}),i.jsx("tbody",{children:(G=r==null?void 0:r.AdmissionPayments)==null?void 0:G.map(ee=>{if(!ee||typeof ee!="object")return null;let te="Invalid Date";try{ee.payment_date&&!isNaN(new Date(ee.payment_date).getTime())&&(te=new Date(ee.payment_date).toLocaleString())}catch(le){console.error("Error formatting payment date:",ee.payment_date,le)}return i.jsxs("tr",{children:[" ",i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ee.id??"N/A"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:te}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["",(Number(ee.amount_paid)||0).toFixed(2)]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:ee.payment_mode??"N/A"})]},ee.id??Math.random())})})]})]}):i.jsx("p",{className:"text-gray-500 text-sm",children:"No payments recorded yet."})]}),i.jsxs("div",{className:"p-4 border-t bg-gray-50 text-right",children:[" ",i.jsx("button",{type:"button",onClick:()=>t(-1),className:"admission-button admission-button-secondary",children:"Back"})]})]})})};var gee=Object.defineProperty,mb=Object.getOwnPropertySymbols,mT=Object.prototype.hasOwnProperty,gT=Object.prototype.propertyIsEnumerable,Jj=(e,n,t)=>n in e?gee(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,I1=(e,n)=>{for(var t in n||(n={}))mT.call(n,t)&&Jj(e,t,n[t]);if(mb)for(var t of mb(n))gT.call(n,t)&&Jj(e,t,n[t]);return e},M1=(e,n)=>{var t={};for(var r in e)mT.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&mb)for(var r of mb(e))n.indexOf(r)<0&&gT.call(e,r)&&(t[r]=e[r]);return t};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Od;(e=>{const n=class nn{constructor(u,d,h,g){if(this.version=u,this.errorCorrectionLevel=d,this.modules=[],this.isFunction=[],u<nn.MIN_VERSION||u>nn.MAX_VERSION)throw new RangeError("Version value out of range");if(g<-1||g>7)throw new RangeError("Mask value out of range");this.size=u*4+17;let b=[];for(let N=0;N<this.size;N++)b.push(!1);for(let N=0;N<this.size;N++)this.modules.push(b.slice()),this.isFunction.push(b.slice());this.drawFunctionPatterns();const v=this.addEccAndInterleave(h);if(this.drawCodewords(v),g==-1){let N=1e9;for(let k=0;k<8;k++){this.applyMask(k),this.drawFormatBits(k);const T=this.getPenaltyScore();T<N&&(g=k,N=T),this.applyMask(k)}}a(0<=g&&g<=7),this.mask=g,this.applyMask(g),this.drawFormatBits(g),this.isFunction=[]}static encodeText(u,d){const h=e.QrSegment.makeSegments(u);return nn.encodeSegments(h,d)}static encodeBinary(u,d){const h=e.QrSegment.makeBytes(u);return nn.encodeSegments([h],d)}static encodeSegments(u,d,h=1,g=40,b=-1,v=!0){if(!(nn.MIN_VERSION<=h&&h<=g&&g<=nn.MAX_VERSION)||b<-1||b>7)throw new RangeError("Invalid value");let N,k;for(N=h;;N++){const P=nn.getNumDataCodewords(N,d)*8,V=o.getTotalBits(u,N);if(V<=P){k=V;break}if(N>=g)throw new RangeError("Data too long")}for(const P of[nn.Ecc.MEDIUM,nn.Ecc.QUARTILE,nn.Ecc.HIGH])v&&k<=nn.getNumDataCodewords(N,P)*8&&(d=P);let T=[];for(const P of u){t(P.mode.modeBits,4,T),t(P.numChars,P.mode.numCharCountBits(N),T);for(const V of P.getData())T.push(V)}a(T.length==k);const E=nn.getNumDataCodewords(N,d)*8;a(T.length<=E),t(0,Math.min(4,E-T.length),T),t(0,(8-T.length%8)%8,T),a(T.length%8==0);for(let P=236;T.length<E;P^=253)t(P,8,T);let I=[];for(;I.length*8<T.length;)I.push(0);return T.forEach((P,V)=>I[V>>>3]|=P<<7-(V&7)),new nn(N,d,I,b)}getModule(u,d){return 0<=u&&u<this.size&&0<=d&&d<this.size&&this.modules[d][u]}getModules(){return this.modules}drawFunctionPatterns(){for(let h=0;h<this.size;h++)this.setFunctionModule(6,h,h%2==0),this.setFunctionModule(h,6,h%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const u=this.getAlignmentPatternPositions(),d=u.length;for(let h=0;h<d;h++)for(let g=0;g<d;g++)h==0&&g==0||h==0&&g==d-1||h==d-1&&g==0||this.drawAlignmentPattern(u[h],u[g]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(u){const d=this.errorCorrectionLevel.formatBits<<3|u;let h=d;for(let b=0;b<10;b++)h=h<<1^(h>>>9)*1335;const g=(d<<10|h)^21522;a(g>>>15==0);for(let b=0;b<=5;b++)this.setFunctionModule(8,b,r(g,b));this.setFunctionModule(8,7,r(g,6)),this.setFunctionModule(8,8,r(g,7)),this.setFunctionModule(7,8,r(g,8));for(let b=9;b<15;b++)this.setFunctionModule(14-b,8,r(g,b));for(let b=0;b<8;b++)this.setFunctionModule(this.size-1-b,8,r(g,b));for(let b=8;b<15;b++)this.setFunctionModule(8,this.size-15+b,r(g,b));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let u=this.version;for(let h=0;h<12;h++)u=u<<1^(u>>>11)*7973;const d=this.version<<12|u;a(d>>>18==0);for(let h=0;h<18;h++){const g=r(d,h),b=this.size-11+h%3,v=Math.floor(h/3);this.setFunctionModule(b,v,g),this.setFunctionModule(v,b,g)}}drawFinderPattern(u,d){for(let h=-4;h<=4;h++)for(let g=-4;g<=4;g++){const b=Math.max(Math.abs(g),Math.abs(h)),v=u+g,N=d+h;0<=v&&v<this.size&&0<=N&&N<this.size&&this.setFunctionModule(v,N,b!=2&&b!=4)}}drawAlignmentPattern(u,d){for(let h=-2;h<=2;h++)for(let g=-2;g<=2;g++)this.setFunctionModule(u+g,d+h,Math.max(Math.abs(g),Math.abs(h))!=1)}setFunctionModule(u,d,h){this.modules[d][u]=h,this.isFunction[d][u]=!0}addEccAndInterleave(u){const d=this.version,h=this.errorCorrectionLevel;if(u.length!=nn.getNumDataCodewords(d,h))throw new RangeError("Invalid argument");const g=nn.NUM_ERROR_CORRECTION_BLOCKS[h.ordinal][d],b=nn.ECC_CODEWORDS_PER_BLOCK[h.ordinal][d],v=Math.floor(nn.getNumRawDataModules(d)/8),N=g-v%g,k=Math.floor(v/g);let T=[];const E=nn.reedSolomonComputeDivisor(b);for(let P=0,V=0;P<g;P++){let F=u.slice(V,V+k-b+(P<N?0:1));V+=F.length;const $=nn.reedSolomonComputeRemainder(F,E);P<N&&F.push(0),T.push(F.concat($))}let I=[];for(let P=0;P<T[0].length;P++)T.forEach((V,F)=>{(P!=k-b||F>=N)&&I.push(V[P])});return a(I.length==v),I}drawCodewords(u){if(u.length!=Math.floor(nn.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let d=0;for(let h=this.size-1;h>=1;h-=2){h==6&&(h=5);for(let g=0;g<this.size;g++)for(let b=0;b<2;b++){const v=h-b,k=(h+1&2)==0?this.size-1-g:g;!this.isFunction[k][v]&&d<u.length*8&&(this.modules[k][v]=r(u[d>>>3],7-(d&7)),d++)}}a(d==u.length*8)}applyMask(u){if(u<0||u>7)throw new RangeError("Mask value out of range");for(let d=0;d<this.size;d++)for(let h=0;h<this.size;h++){let g;switch(u){case 0:g=(h+d)%2==0;break;case 1:g=d%2==0;break;case 2:g=h%3==0;break;case 3:g=(h+d)%3==0;break;case 4:g=(Math.floor(h/3)+Math.floor(d/2))%2==0;break;case 5:g=h*d%2+h*d%3==0;break;case 6:g=(h*d%2+h*d%3)%2==0;break;case 7:g=((h+d)%2+h*d%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[d][h]&&g&&(this.modules[d][h]=!this.modules[d][h])}}getPenaltyScore(){let u=0;for(let b=0;b<this.size;b++){let v=!1,N=0,k=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[b][T]==v?(N++,N==5?u+=nn.PENALTY_N1:N>5&&u++):(this.finderPenaltyAddHistory(N,k),v||(u+=this.finderPenaltyCountPatterns(k)*nn.PENALTY_N3),v=this.modules[b][T],N=1);u+=this.finderPenaltyTerminateAndCount(v,N,k)*nn.PENALTY_N3}for(let b=0;b<this.size;b++){let v=!1,N=0,k=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[T][b]==v?(N++,N==5?u+=nn.PENALTY_N1:N>5&&u++):(this.finderPenaltyAddHistory(N,k),v||(u+=this.finderPenaltyCountPatterns(k)*nn.PENALTY_N3),v=this.modules[T][b],N=1);u+=this.finderPenaltyTerminateAndCount(v,N,k)*nn.PENALTY_N3}for(let b=0;b<this.size-1;b++)for(let v=0;v<this.size-1;v++){const N=this.modules[b][v];N==this.modules[b][v+1]&&N==this.modules[b+1][v]&&N==this.modules[b+1][v+1]&&(u+=nn.PENALTY_N2)}let d=0;for(const b of this.modules)d=b.reduce((v,N)=>v+(N?1:0),d);const h=this.size*this.size,g=Math.ceil(Math.abs(d*20-h*10)/h)-1;return a(0<=g&&g<=9),u+=g*nn.PENALTY_N4,a(0<=u&&u<=2568888),u}getAlignmentPatternPositions(){if(this.version==1)return[];{const u=Math.floor(this.version/7)+2,d=this.version==32?26:Math.ceil((this.version*4+4)/(u*2-2))*2;let h=[6];for(let g=this.size-7;h.length<u;g-=d)h.splice(1,0,g);return h}}static getNumRawDataModules(u){if(u<nn.MIN_VERSION||u>nn.MAX_VERSION)throw new RangeError("Version number out of range");let d=(16*u+128)*u+64;if(u>=2){const h=Math.floor(u/7)+2;d-=(25*h-10)*h-55,u>=7&&(d-=36)}return a(208<=d&&d<=29648),d}static getNumDataCodewords(u,d){return Math.floor(nn.getNumRawDataModules(u)/8)-nn.ECC_CODEWORDS_PER_BLOCK[d.ordinal][u]*nn.NUM_ERROR_CORRECTION_BLOCKS[d.ordinal][u]}static reedSolomonComputeDivisor(u){if(u<1||u>255)throw new RangeError("Degree out of range");let d=[];for(let g=0;g<u-1;g++)d.push(0);d.push(1);let h=1;for(let g=0;g<u;g++){for(let b=0;b<d.length;b++)d[b]=nn.reedSolomonMultiply(d[b],h),b+1<d.length&&(d[b]^=d[b+1]);h=nn.reedSolomonMultiply(h,2)}return d}static reedSolomonComputeRemainder(u,d){let h=d.map(g=>0);for(const g of u){const b=g^h.shift();h.push(0),d.forEach((v,N)=>h[N]^=nn.reedSolomonMultiply(v,b))}return h}static reedSolomonMultiply(u,d){if(u>>>8||d>>>8)throw new RangeError("Byte out of range");let h=0;for(let g=7;g>=0;g--)h=h<<1^(h>>>7)*285,h^=(d>>>g&1)*u;return a(h>>>8==0),h}finderPenaltyCountPatterns(u){const d=u[1];a(d<=this.size*3);const h=d>0&&u[2]==d&&u[3]==d*3&&u[4]==d&&u[5]==d;return(h&&u[0]>=d*4&&u[6]>=d?1:0)+(h&&u[6]>=d*4&&u[0]>=d?1:0)}finderPenaltyTerminateAndCount(u,d,h){return u&&(this.finderPenaltyAddHistory(d,h),d=0),d+=this.size,this.finderPenaltyAddHistory(d,h),this.finderPenaltyCountPatterns(h)}finderPenaltyAddHistory(u,d){d[0]==0&&(u+=this.size),d.pop(),d.unshift(u)}};n.MIN_VERSION=1,n.MAX_VERSION=40,n.PENALTY_N1=3,n.PENALTY_N2=3,n.PENALTY_N3=40,n.PENALTY_N4=10,n.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],n.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=n;function t(f,u,d){if(u<0||u>31||f>>>u)throw new RangeError("Value out of range");for(let h=u-1;h>=0;h--)d.push(f>>>h&1)}function r(f,u){return(f>>>u&1)!=0}function a(f){if(!f)throw new Error("Assertion error")}const l=class hi{constructor(u,d,h){if(this.mode=u,this.numChars=d,this.bitData=h,d<0)throw new RangeError("Invalid argument");this.bitData=h.slice()}static makeBytes(u){let d=[];for(const h of u)t(h,8,d);return new hi(hi.Mode.BYTE,u.length,d)}static makeNumeric(u){if(!hi.isNumeric(u))throw new RangeError("String contains non-numeric characters");let d=[];for(let h=0;h<u.length;){const g=Math.min(u.length-h,3);t(parseInt(u.substring(h,h+g),10),g*3+1,d),h+=g}return new hi(hi.Mode.NUMERIC,u.length,d)}static makeAlphanumeric(u){if(!hi.isAlphanumeric(u))throw new RangeError("String contains unencodable characters in alphanumeric mode");let d=[],h;for(h=0;h+2<=u.length;h+=2){let g=hi.ALPHANUMERIC_CHARSET.indexOf(u.charAt(h))*45;g+=hi.ALPHANUMERIC_CHARSET.indexOf(u.charAt(h+1)),t(g,11,d)}return h<u.length&&t(hi.ALPHANUMERIC_CHARSET.indexOf(u.charAt(h)),6,d),new hi(hi.Mode.ALPHANUMERIC,u.length,d)}static makeSegments(u){return u==""?[]:hi.isNumeric(u)?[hi.makeNumeric(u)]:hi.isAlphanumeric(u)?[hi.makeAlphanumeric(u)]:[hi.makeBytes(hi.toUtf8ByteArray(u))]}static makeEci(u){let d=[];if(u<0)throw new RangeError("ECI assignment value out of range");if(u<128)t(u,8,d);else if(u<16384)t(2,2,d),t(u,14,d);else if(u<1e6)t(6,3,d),t(u,21,d);else throw new RangeError("ECI assignment value out of range");return new hi(hi.Mode.ECI,0,d)}static isNumeric(u){return hi.NUMERIC_REGEX.test(u)}static isAlphanumeric(u){return hi.ALPHANUMERIC_REGEX.test(u)}getData(){return this.bitData.slice()}static getTotalBits(u,d){let h=0;for(const g of u){const b=g.mode.numCharCountBits(d);if(g.numChars>=1<<b)return 1/0;h+=4+b+g.bitData.length}return h}static toUtf8ByteArray(u){u=encodeURI(u);let d=[];for(let h=0;h<u.length;h++)u.charAt(h)!="%"?d.push(u.charCodeAt(h)):(d.push(parseInt(u.substring(h+1,h+3),16)),h+=2);return d}};l.NUMERIC_REGEX=/^[0-9]*$/,l.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,l.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let o=l;e.QrSegment=l})(Od||(Od={}));(e=>{(n=>{const t=class{constructor(a,l){this.ordinal=a,this.formatBits=l}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),n.Ecc=t})(e.QrCode||(e.QrCode={}))})(Od||(Od={}));(e=>{(n=>{const t=class{constructor(a,l){this.modeBits=a,this.numBitsCharCount=l}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),n.Mode=t})(e.QrSegment||(e.QrSegment={}))})(Od||(Od={}));var wh=Od;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var yee={L:wh.QrCode.Ecc.LOW,M:wh.QrCode.Ecc.MEDIUM,Q:wh.QrCode.Ecc.QUARTILE,H:wh.QrCode.Ecc.HIGH},yT=128,xT="L",bT="#FFFFFF",vT="#000000",wT=!1,ST=1,xee=4,bee=0,vee=.1;function NT(e,n=0){const t=[];return e.forEach(function(r,a){let l=null;r.forEach(function(o,f){if(!o&&l!==null){t.push(`M${l+n} ${a+n}h${f-l}v1H${l+n}z`),l=null;return}if(f===r.length-1){if(!o)return;l===null?t.push(`M${f+n},${a+n} h1v1H${f+n}z`):t.push(`M${l+n},${a+n} h${f+1-l}v1H${l+n}z`);return}o&&l===null&&(l=f)})}),t.join("")}function CT(e,n){return e.slice().map((t,r)=>r<n.y||r>=n.y+n.h?t:t.map((a,l)=>l<n.x||l>=n.x+n.w?a:!1))}function wee(e,n,t,r){if(r==null)return null;const a=e.length+t*2,l=Math.floor(n*vee),o=a/n,f=(r.width||l)*o,u=(r.height||l)*o,d=r.x==null?e.length/2-f/2:r.x*o,h=r.y==null?e.length/2-u/2:r.y*o,g=r.opacity==null?1:r.opacity;let b=null;if(r.excavate){let N=Math.floor(d),k=Math.floor(h),T=Math.ceil(f+d-N),E=Math.ceil(u+h-k);b={x:N,y:k,w:T,h:E}}const v=r.crossOrigin;return{x:d,y:h,h:u,w:f,excavation:b,opacity:g,crossOrigin:v}}function See(e,n){return n!=null?Math.max(Math.floor(n),0):e?xee:bee}function jT({value:e,level:n,minVersion:t,includeMargin:r,marginSize:a,imageSettings:l,size:o,boostLevel:f}){let u=En.useMemo(()=>{const N=(Array.isArray(e)?e:[e]).reduce((k,T)=>(k.push(...wh.QrSegment.makeSegments(T)),k),[]);return wh.QrCode.encodeSegments(N,yee[n],t,void 0,void 0,f)},[e,n,t,f]);const{cells:d,margin:h,numCells:g,calculatedImageSettings:b}=En.useMemo(()=>{let v=u.getModules();const N=See(r,a),k=v.length+N*2,T=wee(v,o,N,l);return{cells:v,margin:N,numCells:k,calculatedImageSettings:T}},[u,o,l,r,a]);return{qrcode:u,margin:h,cells:d,numCells:g,calculatedImageSettings:b}}var Nee=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),Ih=En.forwardRef(function(n,t){const r=n,{value:a,size:l=yT,level:o=xT,bgColor:f=bT,fgColor:u=vT,includeMargin:d=wT,minVersion:h=ST,boostLevel:g,marginSize:b,imageSettings:v}=r,k=M1(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:T}=k,E=M1(k,["style"]),I=v==null?void 0:v.src,P=En.useRef(null),V=En.useRef(null),F=En.useCallback(te=>{P.current=te,typeof t=="function"?t(te):t&&(t.current=te)},[t]),[$,B]=En.useState(!1),{margin:z,cells:q,numCells:O,calculatedImageSettings:R}=jT({value:a,level:o,minVersion:h,boostLevel:g,includeMargin:d,marginSize:b,imageSettings:v,size:l});En.useEffect(()=>{if(P.current!=null){const te=P.current,le=te.getContext("2d");if(!le)return;let K=q;const U=V.current,J=R!=null&&U!==null&&U.complete&&U.naturalHeight!==0&&U.naturalWidth!==0;J&&R.excavation!=null&&(K=CT(q,R.excavation));const ne=window.devicePixelRatio||1;te.height=te.width=l*ne;const A=l/O*ne;le.scale(A,A),le.fillStyle=f,le.fillRect(0,0,O,O),le.fillStyle=u,Nee?le.fill(new Path2D(NT(K,z))):q.forEach(function(ae,ce){ae.forEach(function(M,de){M&&le.fillRect(de+z,ce+z,1,1)})}),R&&(le.globalAlpha=R.opacity),J&&le.drawImage(U,R.x+z,R.y+z,R.w,R.h)}}),En.useEffect(()=>{B(!1)},[I]);const G=I1({height:l,width:l},T);let ee=null;return I!=null&&(ee=En.createElement("img",{src:I,key:I,style:{display:"none"},onLoad:()=>{B(!0)},ref:V,crossOrigin:R==null?void 0:R.crossOrigin})),En.createElement(En.Fragment,null,En.createElement("canvas",I1({style:G,height:l,width:l,ref:F,role:"img"},E)),ee)});Ih.displayName="QRCodeCanvas";var Cee=En.forwardRef(function(n,t){const r=n,{value:a,size:l=yT,level:o=xT,bgColor:f=bT,fgColor:u=vT,includeMargin:d=wT,minVersion:h=ST,boostLevel:g,title:b,marginSize:v,imageSettings:N}=r,k=M1(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:T,cells:E,numCells:I,calculatedImageSettings:P}=jT({value:a,level:o,minVersion:h,boostLevel:g,includeMargin:d,marginSize:v,imageSettings:N,size:l});let V=E,F=null;N!=null&&P!=null&&(P.excavation!=null&&(V=CT(E,P.excavation)),F=En.createElement("image",{href:N.src,height:P.h,width:P.w,x:P.x+T,y:P.y+T,preserveAspectRatio:"none",opacity:P.opacity,crossOrigin:P.crossOrigin}));const $=NT(V,T);return En.createElement("svg",I1({height:l,width:l,viewBox:`0 0 ${I} ${I}`,ref:t,role:"img"},k),!!b&&En.createElement("title",null,b),En.createElement("path",{fill:f,d:`M0,0 h${I}v${I}H0z`,shapeRendering:"crispEdges"}),En.createElement("path",{fill:u,d:$,shapeRendering:"crispEdges"}),F)});Cee.displayName="QRCodeSVG";const jee=e=>{switch(e){case"pending":return{text:"text-orange-700",bg:"bg-orange-100"};case"billed":return{text:"text-blue-700",bg:"bg-blue-100"};case"dispensed":return{text:"text-green-700",bg:"bg-green-100"};case"cancelled":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},_ee=()=>{const{orderId:e}=jr(),n=gt(),[t,r]=w.useState(null),[a,l]=w.useState(!0),[o,f]=w.useState(null),[u,d]=w.useState(!1),[h,g]=w.useState({}),[b,v]=w.useState(""),[N,k]=w.useState(""),[T,E]=w.useState("cash"),I=w.useMemo(()=>(t==null?void 0:t.medications.reduce((R,G)=>{const ee=G.total_price??0,te=ee*(G.discount_percentage??0)/100;return R+ee-te},0))??0,[t==null?void 0:t.medications]),P=5,V=w.useMemo(()=>!t||!t.medications?0:t.medications.reduce((R,G,ee)=>{var ne,A;const te=G.drug_id??`index-${ee}`,le=((ne=h[te])==null?void 0:ne.pack)||0,K=((A=h[te])==null?void 0:A.loose)||0,U=G.pack_price??0,J=G.loose_price??0;return R+le*U+K*J},0),[t,h]),F=w.useCallback(async()=>{if(!e){f("Order ID is missing."),l(!1);return}l(!0),f(null);try{const R=await pe(`/api/pharmacy-orders/${e}`);if(!R.ok)throw R.status===404?new Error(`Order with ID ${e} not found.`):new Error(`Failed to fetch order details: ${R.statusText} (${R.status})`);const G=await R.json();console.log("Fetched order data after return:",G);const te=G.medications.map(K=>K.pack_price&&K.loose_price&&K.loose_price>0?{...K,unitsPerPack:Math.round(K.pack_price/K.loose_price)}:{...K,unitsPerPack:0}).map(K=>({...K,discount_percentage:K.discount_percentage??0}));r({...G,medications:te});const le={};te.forEach((K,U)=>{const J=K.drug_id??`index-${U}`;le[J]={pack:0,loose:0}}),g(le)}catch(R){console.error("Failed to fetch order details:",R),f(R.message||"Failed to load order details.")}finally{l(!1)}},[e]);w.useEffect(()=>{F()},[F]),w.useEffect(()=>{(async()=>{try{const G=await pe("/api/clinics/settings");if(!G.ok)throw new Error("Failed to fetch clinic settings");const ee=await G.json();console.log("Fetched clinic settings:",ee),v(ee.upi_id||"")}catch(G){console.error("Error fetching clinic settings:",G)}})()},[]),w.useEffect(()=>{if((t==null?void 0:t.order_total)!==void 0&&t.order_total>0&&b){const R=`upi://pay?pa=${b}&pn=ClinicName&am=${t.order_total.toFixed(2)}&cu=INR`;k(R)}else k("")},[t==null?void 0:t.order_total,b]);const $=(R,G)=>{r(ee=>{if(!ee)return null;const te=ee.medications.map((K,U)=>(K.drug_id??`index-${U}`)===R?{...K,discount_percentage:isNaN(G)?0:G}:K),le=te.reduce((K,U)=>{const J=U.total_price??0,ne=J*(U.discount_percentage??0)/100;return K+J-ne},0);return{...ee,medications:te,order_total:le}})},B=(R,G,ee)=>{g(te=>{const le=ee.unitsPerPack||0,U=ee.pack_quantity*le+ee.loose_quantity,J=Math.max(0,Math.min(G,U));let ne=0,A=J;return le>0&&(ne=Math.floor(J/le),A=J%le),{...te,[R]:{pack:ne,loose:A}}})},z=async()=>{const R=t==null?void 0:t.medications.map((G,ee)=>{var U,J;const te=G.drug_id??`index-${ee}`,le=((U=h[te])==null?void 0:U.pack)||0,K=((J=h[te])==null?void 0:J.loose)||0;return le>0||K>0?{drug_id:G.drug_id,name:G.name,pack_quantity:G.pack_quantity,loose_quantity:G.loose_quantity,returnPackQuantity:le,returnLooseQuantity:K}:null}).filter(G=>G!==null);if(!R||R.length===0){alert("Please select a quantity greater than 0 for at least one item to return.");return}if(!e){alert("Order ID is missing. Cannot process return.");return}if(!R){alert("Could not prepare items for return.");return}d(!0),f(null);try{const G=await pe(`/api/pharmacy-orders/${e}/return`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemsToReturn:R})}),ee=await G.json();if(!G.ok)throw new Error(ee.message||`Failed to process return: ${G.statusText}`);alert("Return processed successfully! Stock has been updated.");const te={};t==null||t.medications.forEach((le,K)=>{const U=le.drug_id??`index-${K}`;te[U]={pack:0,loose:0}}),g(te),F()}catch(G){console.error("Failed to process return:",G),f(G.message||"An error occurred while processing the return."),alert(`Error processing return: ${G.message||"Unknown error"}`)}finally{d(!1)}};if(a)return i.jsx("div",{className:"text-center p-6 text-gray-500 animate-pulse",children:"Loading Order Details..."});if(o)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(Lt,{size:14,className:"mr-1.5"})," Back"]}),i.jsxs("div",{className:"bg-red-50 border border-red-300 text-red-700 rounded p-4",children:["Error: ",o]})]});if(!t)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(Lt,{size:14,className:"mr-1.5"})," Back"]}),i.jsx("div",{className:"text-center py-10 px-4 text-gray-500 bg-white rounded-lg shadow",children:"Order details could not be loaded."})]});const q=()=>{window.print()},O=jee(t.status);return i.jsx("div",{className:"pharmacy-order-details-page",children:i.jsxs("div",{className:"order-details-container printable-section",children:[i.jsxs("div",{className:"order-details-header no-print",children:[i.jsx("h1",{children:"Pharmacy Order Details"}),i.jsxs("div",{className:"actions",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:[i.jsx(Lt,{size:18})," Back to Queue"]}),i.jsxs("button",{onClick:q,className:"print-button",children:[i.jsx(Rs,{size:18})," Print Bill"]})]})]}),i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{children:"Mahajan Pharmacy"}),i.jsxs("div",{className:"clinic-details-print",children:[i.jsx("span",{className:"small-text clinic-address",children:"D.No: 3-1-289, Plot No. 101, Kabela Center, RR Nagar, Vijayawada  520012."}),i.jsx("span",{className:"small-text clinic-notes",children:"Phone: 93919 44733"}),i.jsx("span",{className:"small-text clinic-license",children:"Licence No:RLF20AP2025003328"})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Patient Name:"})," RESHMA"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Token:"})," 12"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Order Date:"})," 31/10/2025"]})]})]}),i.jsxs("div",{className:"order-info-section no-print",children:[i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Order ID:"})," ",t.id]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Patient:"})," ",t.patientName||"N/A"," (",t.patientTokenNumber||"N/A",")"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Date:"})," ",new Date(t.date).toLocaleString()]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Prescribed By:"})," ",t.prescribedBy||"N/A"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:`status-pill ${O.text} ${O.bg}`,children:t.status})]})]}),i.jsxs("div",{className:"medications-section",children:[i.jsx("h2",{children:"Medications Ordered"}),t.medications.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"PACK QTY"}),i.jsx("th",{children:"PACK PRICE"}),i.jsx("th",{children:"LOOSE QTY"}),i.jsx("th",{children:"LOOSE PRICE"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"no-print",children:"RETURN PACK QTY"}),i.jsx("th",{className:"no-print",children:"RETURN LOOSE QTY"})]})]})}),i.jsx("tbody",{children:t.medications.map((R,G)=>{var ne,A,ae,ce,M,de;const ee=R.drug_id??`index-${G}`,te=R.total_price??0,le=te*(R.discount_percentage??0)/100,K=te-le,U=((ne=h[ee])==null?void 0:ne.pack)||0,J=((A=h[ee])==null?void 0:A.loose)||0;return i.jsxs("tr",{children:[i.jsx("td",{children:R.name}),i.jsx("td",{children:R.pack_quantity??0}),i.jsx("td",{children:((ae=R.pack_price)==null?void 0:ae.toFixed(2))??"N/A"}),i.jsx("td",{children:R.loose_quantity??0}),i.jsx("td",{children:((ce=R.loose_price)==null?void 0:ce.toFixed(2))??"N/A"}),i.jsx("td",{children:((M=R.price)==null?void 0:M.toFixed(2))??"N/A"})," ",i.jsx("td",{children:((de=R.price)==null?void 0:de.toFixed(2))??"N/A"})," ",i.jsxs("td",{children:[i.jsx("input",{type:"number",value:R.discount_percentage??0,onChange:Se=>$(ee,parseFloat(Se.target.value)),min:"0",max:"100",className:"discount-input-table no-print"}),i.jsxs("span",{className:"print-only",children:[R.discount_percentage??0,"%"]})]}),i.jsxs("td",{children:[P.toFixed(1),"%"]}),i.jsx("td",{children:K.toFixed(2)}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:R.pack_quantity,value:U,onChange:Se=>{const we=(parseInt(Se.target.value,10)||0)*(R.unitsPerPack||0)+J;B(ee,we,R)},className:"return-quantity-input"})}),i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:R.loose_quantity+R.pack_quantity*(R.unitsPerPack||0)-U*(R.unitsPerPack||0),value:J,onChange:Se=>{const fe=parseInt(Se.target.value,10)||0,we=U*(R.unitsPerPack||0)+fe;B(ee,we,R)},className:"return-quantity-input"})})]})]},ee)})})]}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No medications listed for this order."})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",I.toFixed(2)]})}),i.jsxs("div",{className:"order-total-section no-print",children:[i.jsx("span",{className:"total-label",children:"Order Total:"}),i.jsxs("span",{className:"total-amount",children:["",I.toFixed(2)]})]}),i.jsxs("div",{className:"payment-section no-print",children:[i.jsxs("div",{className:"payment-mode-group",children:[i.jsx("label",{htmlFor:"paymentMode",children:"Payment Mode:"}),i.jsxs("select",{id:"paymentMode",value:T,onChange:R=>E(R.target.value),className:"payment-mode-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),N&&i.jsxs("div",{className:"qr-code-container",children:[i.jsx(Ih,{value:N,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]})]}),(t.status==="dispensed"||t.status==="billed")&&t.medications.length>0&&i.jsxs("div",{className:"return-action-section no-print",children:[V>0&&i.jsxs("div",{className:"total-refund-display",children:["Total Refund: ",V.toFixed(2)]}),i.jsx("button",{onClick:z,disabled:Object.values(h).every(R=>R.pack===0&&R.loose===0)||u,className:"process-return-button",children:u?i.jsxs(i.Fragment,{children:[i.jsx(Yx,{size:16,className:"mr-2 animate-spin"})," Processing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Yx,{size:16,className:"mr-2"})," Process Return"]})})]})]})})},kee=async()=>{const e=await pe("/subscriptions");if(!e.ok)throw new Error("Failed to fetch subscription plans");return await e.json()},Eee=async e=>{const n=await pe(`/subscriptions/${e}`);if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to fetch subscription plan details"}));throw new Error(t.message||"Failed to fetch subscription plan details")}return await n.json()},Tee=async e=>{const n=await pe("/subscriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to create subscription plan"}));throw new Error(t.message||"Failed to create subscription plan")}return await n.json()},Aee=async(e,n)=>{const t=await pe(`/subscriptions/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to update subscription plan"}));throw new Error(r.message||"Failed to update subscription plan")}return await t.json()},Dee=async e=>{const n=await pe(`/subscriptions/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to deactivate subscription plan"}));throw new Error(t.message||"Failed to deactivate subscription plan")}return await n.json()},Pee=async(e,n)=>{const t=await pe("/api/payment/razorpay-subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:e,planId:n})});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to initiate Razorpay subscription"}));throw new Error(r.message||"Failed to initiate Razorpay subscription")}return await t.json()},Iee=()=>{const e=gt(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[l,o]=w.useState(null),[f,u]=w.useState(null),d=w.useCallback(async()=>{a(!0),o(null);try{const g=await kee();t(g)}catch(g){o(g.message||"Failed to fetch subscription plans."),u({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{d()},[d]),w.useEffect(()=>{if(f){const g=setTimeout(()=>u(null),5e3);return()=>clearTimeout(g)}},[f]);const h=async g=>{if(u(null),o(null),window.confirm("Are you sure you want to deactivate this plan? This action cannot be undone directly.")){a(!0),o(null),u(null);try{await Dee(g),u({type:"success",message:"Plan deactivated successfully!"}),d()}catch(b){o(b.message||"Failed to deactivate plan."),u({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[f&&i.jsxs("div",{className:`${f.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[f.type==="success"?i.jsx(Ra,{size:18,className:"mr-2 text-green-500"}):i.jsx(ti,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:f.message})]}),i.jsx("button",{onClick:()=>u(null),className:`${f.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Qn,{size:16})})]}),i.jsxs("div",{children:[" ",i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(Lt,{size:16}),"Back"]}),i.jsx("h1",{children:"Manage Subscription Plans"}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions/add"),className:"subscription-btn",children:[i.jsx(Ao,{size:16,className:"mr-1 inline-block"})," Add New Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading plans..."})]})}),!r&&l&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:l}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx(Md,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>h(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(Ri,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!l&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No subscription plans found. Add one to get started!"})]})]})},Mee=()=>{const e=gt(),[n,t]=w.useState({name:"",description:"",price:"",period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[l,o]=w.useState(null),[f,u]=w.useState(null);w.useEffect(()=>{if(f){const b=setTimeout(()=>u(null),5e3);return()=>clearTimeout(b)}},[f]);const d=b=>{const{name:v,value:N}=b.target;t(k=>({...k,[v]:N}))},h=async b=>{if(b.preventDefault(),a(!0),o(null),u(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){o("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await Tee(n),u({type:"success",message:"Plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/subscriptions")},2e3)}catch(v){const N=v.message||"Failed to create plan.";o(N),u({type:"error",message:N})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[f&&i.jsxs("div",{className:`${f.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[f.type==="success"?i.jsx(Ra,{size:18,className:"mr-2 text-green-500"}):i.jsx(ti,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:f.message})]}),i.jsx("button",{onClick:()=>u(null),className:`${f.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Qn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Subscription Plan"}),l&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:l}),i.jsxs("form",{onSubmit:h,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:d,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:d})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:d,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:d,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:d,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:d})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},Ree=()=>{const{id:e}=jr(),n=gt(),[t,r]=w.useState(null),[a,l]=w.useState({}),[o,f]=w.useState(!1),[u,d]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState(null),N=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),d(!1);return}d(!0),g(null);try{const I=await Eee(e);r(I),l({name:I.name,description:I.description||"",price:I.price,period:I.period,interval:I.interval,razorpay_plan_id:I.razorpay_plan_id||"",status:I.status})}catch(I){g(I.message||"Failed to fetch plan details."),v({type:"error",message:I.message||"Failed to fetch plan details."})}finally{d(!1)}},[e]);w.useEffect(()=>{N()},[N]),w.useEffect(()=>{if(b){const I=setTimeout(()=>v(null),5e3);return()=>clearTimeout(I)}},[b]);const k=I=>{const{name:P,value:V}=I.target;l(F=>({...F,[P]:V}))},T=async I=>{if(I.preventDefault(),!e){g("Plan ID is missing.");return}if(f(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),f(!1);return}try{await Aee(e,a),v({type:"success",message:"Plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(P){const V=P.message||"Failed to update plan.";g(V),v({type:"error",message:V})}finally{f(!1)}},E=()=>{n(-1)};return u?i.jsx("div",{className:"p-6 text-center",children:"Loading plan details..."}):h&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:h}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx(Ra,{size:18,className:"mr-2"}):i.jsx(ti,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(Qn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Subscription Plan"}),h&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:h}),i.jsxs("form",{onSubmit:T,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval||1,onChange:k,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:E,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:o,className:"subscription-btn",children:[o?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,o?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Plan not found."})},Lee=()=>{const{patientId:e}=jr(),n=gt(),[t,r]=w.useState(null),[a,l]=w.useState([]),[o,f]=w.useState(""),[u,d]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState("manual"),[N,k]=w.useState(!1),[T,E]=w.useState(null),I=w.useCallback(async()=>{d(!0),g(null);try{const F=await pe(`/api/patients/${e}`);if(!F.ok){const q=await F.json();throw new Error(q.message||"Failed to fetch patient details")}const $=await F.json();r($);const B=await pe("/api/subscriptions");if(!B.ok){const q=await B.json();throw new Error(q.message||"Failed to fetch subscription plans")}const z=await B.json();l(z.filter(q=>q.status==="active"))}catch(F){console.error("Error fetching data:",F),g(`Failed to load data: ${F.message}`)}finally{d(!1)}},[e]);w.useEffect(()=>{e?I():(g("Patient ID is missing."),d(!1))},[e,I]);const P=(F,$)=>{const B=new Date(F),z=$.interval||1;switch($.period){case"daily":B.setDate(F.getDate()+z);break;case"weekly":B.setDate(F.getDate()+z*7);break;case"monthly":B.setMonth(F.getMonth()+z);break;case"yearly":B.setFullYear(F.getFullYear()+z);break;default:console.warn(`Unknown subscription period: ${$.period}. Defaulting to 1 month.`),B.setMonth(F.getMonth()+1)}return B},V=async()=>{if(!e||!o){E("Please select a subscription plan.");return}const F=a.find($=>$.id===o);if(!F){E("Selected plan details not found.");return}k(!0),E(null);try{const $=new Date,B=P($,F);if(b==="manual"){const z={subscription_plan_id:o,subscription_status:"active",subscription_start_date:$.toISOString(),subscription_end_date:B.toISOString(),subscription_payment_method:"manual"},q=await pe(`/api/patients/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)});if(!q.ok){const O=await q.json();throw new Error(O.message||"Failed to start subscription manually")}alert(`Subscription started successfully for ${t==null?void 0:t.name} (Manual Payment)!`),n("/all-patients")}else if(b==="razorpay"){console.log("Initiating Razorpay subscription for plan:",F);const z=await Pee(e,o);if(z&&z.short_url)window.location.href=z.short_url;else throw new Error("Failed to get Razorpay subscription link from backend.")}}catch($){console.error("Error starting subscription:",$),E(`Failed to start subscription: ${$.message}`),k(!1)}};return u?i.jsx("div",{className:"loading-state-subscription",children:"Loading patient and plans..."}):h?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:h})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(Lt,{size:16})," ","Back"]})]}):t?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(Lt,{size:16})," ","Back"]}),i.jsxs("h1",{children:[i.jsx(Fs,{size:28})," ","Start Subscription for ",t.name]}),T&&i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[" ",i.jsx("span",{children:T})]}),i.jsxs("div",{className:"subscription-form",children:[" ",i.jsx("h2",{children:"Available Subscription Plans"}),a.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:a.map(F=>i.jsxs("div",{className:`subscription-plan-card ${o===F.id?"selected-plan":""}`,onClick:()=>f(F.id),children:[i.jsx("h3",{children:F.name}),i.jsxs("p",{className:"price",children:["",F.price]}),i.jsxs("p",{className:"duration",children:["Every ",F.interval," ",F.period,F.interval>1?"s":""]}),F.description&&i.jsx("p",{children:F.description})]},F.id))})]}),i.jsxs("div",{className:"subscription-form mb-6",children:[" ",i.jsx("h2",{children:"Select Payment Method"}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"manual",checked:b==="manual",onChange:()=>v("manual"),className:"mr-2"}),i.jsx("span",{children:"Cash (Manual)"})]})}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"razorpay",checked:b==="razorpay",onChange:()=>v("razorpay"),className:"mr-2"}),i.jsx("span",{children:"Razorpay"})]})})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:V,disabled:!o||N||a.length===0,className:"subscription-btn",children:[N&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),N?"Starting...":"Start Subscription"]})})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Warning: "}),i.jsx("span",{children:"Patient not found."})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(Lt,{size:16}),"Back"]})]})},Oee=()=>{const e=gt(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[l,o]=w.useState(null),[f,u]=w.useState(null),d=w.useCallback(async()=>{a(!0),o(null);try{const g=await X1();t(g)}catch(g){o(g.message||"Failed to fetch clinic subscription plans."),u({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{d()},[d]),w.useEffect(()=>{if(f){const g=setTimeout(()=>u(null),5e3);return()=>clearTimeout(g)}},[f]);const h=async g=>{if(u(null),o(null),window.confirm("Are you sure you want to deactivate this clinic plan? This action cannot be undone directly.")){a(!0),o(null),u(null);try{await U4(g),u({type:"success",message:"Clinic plan deactivated successfully!"}),d()}catch(b){o(b.message||"Failed to deactivate clinic plan."),u({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[f&&i.jsxs("div",{className:`${f.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[f.type==="success"?i.jsx(Ra,{size:18,className:"mr-2 text-green-500"}):i.jsx(ti,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:f.message})]}),i.jsx("button",{onClick:()=>u(null),className:`${f.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Qn,{size:16})})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"p-2 rounded-md hover:bg-gray-200",children:i.jsx(Lt,{size:20})}),i.jsx("h1",{className:"text-2xl font-bold",children:"Manage Clinic Subscription Plans"})]}),i.jsxs("button",{onClick:()=>e("/dashboard/clinic-subscriptions/add"),className:"subscription-btn",children:[i.jsx(Ao,{size:16,className:"mr-1 inline-block"})," Add New Clinic Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading clinic plans..."})]})}),!r&&l&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:l}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/clinic-subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx(Md,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>h(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(Ri,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!l&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No clinic subscription plans found. Add one to get started!"})]})]})},Fee=()=>{const e=gt(),[n,t]=w.useState({name:"",description:"",price:0,period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[l,o]=w.useState(null),[f,u]=w.useState(null);w.useEffect(()=>{if(f){const b=setTimeout(()=>u(null),5e3);return()=>clearTimeout(b)}},[f]);const d=b=>{const{name:v,value:N,type:k}=b.target;t(T=>({...T,[v]:k==="number"?parseFloat(N):N}))},h=async b=>{if(b.preventDefault(),a(!0),o(null),u(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){o("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await z4(n),u({type:"success",message:"Clinic plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/clinic-subscriptions")},2e3)}catch(v){const N=v.message||"Failed to create clinic plan.";o(N),u({type:"error",message:N})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[f&&i.jsxs("div",{className:`${f.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[f.type==="success"?i.jsx(Ra,{size:18,className:"mr-2 text-green-500"}):i.jsx(ti,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:f.message})]}),i.jsx("button",{onClick:()=>u(null),className:`${f.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Qn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Clinic Subscription Plan"}),l&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:l}),i.jsxs("form",{onSubmit:h,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:d,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:d})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:d,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:d,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:d,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:d})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},$ee=()=>{const{id:e}=jr(),n=gt(),[t,r]=w.useState(null),[a,l]=w.useState({}),[o,f]=w.useState(!1),[u,d]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState(null),N=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),d(!1);return}d(!0),g(null);try{const I=await $4(e);r(I),l({name:I.name,description:I.description||"",price:Number(I.price),period:I.period,interval:Number(I.interval),razorpay_plan_id:I.razorpay_plan_id||"",status:I.status})}catch(I){g(I.message||"Failed to fetch clinic plan details."),v({type:"error",message:I.message||"Failed to fetch plan details."})}finally{d(!1)}},[e]);w.useEffect(()=>{N()},[N]),w.useEffect(()=>{if(b){const I=setTimeout(()=>v(null),5e3);return()=>clearTimeout(I)}},[b]);const k=I=>{const{name:P,value:V,type:F}=I.target;l($=>({...$,[P]:F==="number"?parseFloat(V):V}))},T=async I=>{if(I.preventDefault(),!e){g("Plan ID is missing.");return}if(f(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),f(!1);return}try{await B4(e,a),v({type:"success",message:"Clinic plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(P){const V=P.message||"Failed to update clinic plan.";g(V),v({type:"error",message:V})}finally{f(!1)}},E=()=>{n(-1)};return u?i.jsx("div",{className:"p-6 text-center",children:"Loading clinic plan details..."}):h&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:h}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx(Ra,{size:18,className:"mr-2"}):i.jsx(ti,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(Qn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Clinic Subscription Plan"}),h&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:h}),i.jsxs("form",{onSubmit:T,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price!==void 0?a.price:"",onChange:k,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval!==void 0?a.interval:"",onChange:k,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:E,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:o,className:"subscription-btn",children:[o?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,o?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Clinic plan not found."})},zee=()=>{const e=gt(),[n,t]=w.useState([]),[r,a]=w.useState(""),[l,o]=w.useState(!0),[f,u]=w.useState(null),[d,h]=w.useState(!1),[g,b]=w.useState(null),v=w.useCallback(async()=>{u(null);try{const T=(await X1()).filter(E=>E.status==="active");t(T),T.length>0&&!r&&a(T[0].id)}catch(k){console.error("Error fetching plans:",k),u(`Failed to load subscription plans: ${k.message}`)}},[]);w.useEffect(()=>{(async()=>{o(!0);try{const T=await V4();if(T&&T.short_url){window.location.href=T.short_url,u("You have a pending subscription. Redirecting to payment...");return}await v()}catch(T){console.error("Error during initial page load:",T),u(`An unexpected error occurred: ${T.message}`)}finally{o(!1)}})()},[v]);const N=async()=>{if(!r){b("Please select a clinic subscription plan.");return}const k=n.find(T=>T.id===r);if(!k){b("Selected plan details not found.");return}h(!0),b(null);try{console.log("Initiating Razorpay clinic subscription for plan:",k);const T=await q4(r);if(T&&T.short_url)window.location.href=T.short_url;else throw new Error("Failed to get Razorpay clinic subscription link from backend.")}catch(T){console.error("Error starting clinic subscription:",T),b(`Failed to start clinic subscription: ${T.message}`),h(!1)}};return l?i.jsx("div",{className:"loading-state-subscription",children:"Loading clinic plans..."}):f?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:f})]}),i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(Lt,{size:16}),"Back"]})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(Lt,{size:16}),"Back"]}),i.jsxs("h1",{children:[i.jsx(bP,{size:28}),"Buy Pro Plan for Clinic"]}),g&&i.jsx("div",{className:"error-alert-subscription",role:"alert",children:i.jsx("span",{children:g})}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h2",{children:"Available Pro Plans"}),n.length===0?i.jsx("p",{className:"empty-state",children:"No active clinic subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:n.map(k=>i.jsxs("div",{className:`subscription-plan-card ${r===k.id?"selected-plan":""}`,onClick:()=>a(k.id),children:[i.jsx("h3",{children:k.name}),i.jsxs("p",{className:"price",children:["",Number(k.price).toFixed(2)]}),i.jsxs("p",{className:"duration",children:["Every ",k.interval," ",k.period,k.interval>1?"s":""]}),k.description&&i.jsx("p",{children:k.description})]},k.id))})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:N,disabled:!r||d||n.length===0,className:"subscription-btn",children:[d&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),d?"Initiating Payment...":"Buy Pro Plan"]})})]})},Bee=()=>{const e=gt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[l,o]=w.useState(null),[f,u]=w.useState(!1),[d,h]=w.useState(!1),[g,b]=w.useState(null),[v,N]=w.useState({name:"",email:"",password:"",role:"user"}),[k,T]=w.useState({name:"",email:"",role:"",password:"",confirmPassword:""}),[E,I]=w.useState(""),[P,V]=w.useState(""),[F,$]=w.useState({}),[B,z]=w.useState(!1),[q,O]=w.useState(null),[R,G]=w.useState([]),[ee,te]=w.useState(""),[le,K]=w.useState(!1),[U,J]=w.useState(null);w.useEffect(()=>{const re=setTimeout(()=>{V(E)},500);return()=>{clearTimeout(re)}},[E]),w.useEffect(()=>{ne(P)},[P]);const ne=async(re="")=>{a(!0);try{const _e=re?`/api/users?search=${encodeURIComponent(re)}`:"/api/users",et=await(await pe(_e)).json();if(t(et),et.length>0){const Je=[...new Set(et.map(xe=>xe.clinic_id).filter(xe=>!!xe))],Le={};await Promise.all(Je.map(async xe=>{try{const Me=await F4(xe);Le[xe]=Me}catch(Me){console.error(`Failed to fetch subscription status for clinic ${xe}`,Me),Le[xe]={hasProPlan:!1}}})),$(Le)}o(null)}catch(_e){o("Failed to fetch users."),console.error(_e)}finally{a(!1)}},A=async re=>{re.preventDefault();try{await pe("/users",{method:"POST",body:JSON.stringify(v)}),u(!1),N({name:"",email:"",password:"",role:"user"}),ne()}catch(_e){o("Failed to add user."),console.error(_e)}},ae=async re=>{if(re.preventDefault(),!g)return;const{password:_e,confirmPassword:qe,...et}=k,Je={...et};if(_e){if(_e.length<6){o("Password must be at least 6 characters long.");return}if(_e!==qe){o("Passwords do not match.");return}Je.password=_e}try{await pe(`/users/${g.id}`,{method:"PUT",body:JSON.stringify(Je)}),h(!1),b(null),T({...k,password:"",confirmPassword:""}),ne()}catch(Le){o("Failed to update user."),console.error(Le)}},ce=async re=>{if(window.confirm("Are you sure you want to delete this user?"))try{await pe(`/users/${re}`,{method:"DELETE"}),ne()}catch(_e){o("Failed to delete user."),console.error(_e)}},M=re=>{b(re),T({name:re.name,email:re.email,role:re.role,password:"",confirmPassword:""}),h(!0)},de=async()=>{K(!0);try{const re=await X1();G(re),re.length>0&&te(re[0].id),J(null)}catch(re){J("Failed to fetch subscription plans."),console.error(re)}finally{K(!1)}},Se=re=>{O(re),z(!0),de()},fe=async re=>{if(re.preventDefault(),!q||!ee){o("Please select a clinic and a plan.");return}try{await pe("/clinic-subscriptions/manual-activate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicId:q,planId:ee})}),z(!1),O(null),te(""),ne(),o(null)}catch(_e){o("Failed to manually activate clinic subscription."),console.error(_e)}},we=async re=>{if(window.confirm("Are you sure you want to cancel this clinic's subscription? This action cannot be undone."))try{await O4(re),ne(),o(null)}catch(_e){o("Failed to cancel subscription."),console.error(_e)}};return r?i.jsx("div",{children:"Loading users..."}):l?i.jsx("div",{className:"error-message",children:l}):i.jsxs("div",{className:"user-management-page",children:[i.jsxs("div",{className:"user-management-header",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(Lt,{size:16}),"Back"]}),i.jsx("h1",{children:"User Management"})]}),i.jsxs("div",{className:"controls-container",children:[i.jsx("input",{type:"text",placeholder:"Search by name or email...",value:E,onChange:re=>I(re.target.value),className:"search-input"}),i.jsx("button",{onClick:()=>u(!0),className:"add-user-button",children:"Add New User"})]}),f&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>u(!1),children:""}),i.jsx("h2",{children:"Add New User"}),i.jsxs("form",{onSubmit:A,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:v.name,onChange:re=>N({...v,name:re.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:v.email,onChange:re=>N({...v,email:re.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Password:"}),i.jsx("input",{type:"password",value:v.password,onChange:re=>N({...v,password:re.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:v.role,onChange:re=>N({...v,role:re.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsx("button",{type:"submit",children:"Add User"})]})]})}),d&&g&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>h(!1),children:""}),i.jsx("h2",{children:"Edit User"}),i.jsxs("form",{onSubmit:ae,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:k.name,onChange:re=>T({...k,name:re.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:k.email,onChange:re=>T({...k,email:re.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:k.role,onChange:re=>T({...k,role:re.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"New Password (optional):"}),i.jsx("input",{type:"password",value:k.password,onChange:re=>T({...k,password:re.target.value})})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Confirm New Password:"}),i.jsx("input",{type:"password",value:k.confirmPassword,onChange:re=>T({...k,confirmPassword:re.target.value})})]}),i.jsx("button",{type:"submit",children:"Update User"})]})]})}),B&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>z(!1),children:""}),i.jsx("h2",{children:"Select Subscription Plan for Clinic"}),le&&i.jsx("div",{children:"Loading plans..."}),U&&i.jsx("div",{className:"error-message",children:U}),!le&&!U&&R.length===0&&i.jsx("div",{children:"No active subscription plans available."}),!le&&!U&&R.length>0&&i.jsxs("form",{onSubmit:fe,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Select Plan:"}),i.jsx("select",{value:ee,onChange:re=>te(re.target.value),required:!0,children:R.map(re=>i.jsxs("option",{value:re.id,children:[re.name," - $",re.price,"/",re.interval," ",re.period]},re.id))})]}),i.jsx("button",{type:"submit",children:"Activate Selected Plan"})]})]})}),i.jsxs("table",{className:"user-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Role"}),i.jsx("th",{children:"Clinic ID"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:n.map(re=>{const _e=re.clinic_id||"N/A",qe=_e!=="N/A"?F[_e]:null,et=(qe==null?void 0:qe.hasProPlan)??!1,Je=et?"PRO":"Standard";return i.jsxs("tr",{children:[i.jsx("td",{children:re.name}),i.jsx("td",{children:re.email}),i.jsx("td",{children:re.role}),i.jsx("td",{children:_e}),i.jsx("td",{children:_e!=="N/A"?i.jsx("span",{className:et?"pro-badge":"standard-badge",children:Je}):"N/A"}),i.jsxs("td",{children:[i.jsx("button",{onClick:()=>M(re),className:"edit-button",children:"Edit"}),i.jsx("button",{onClick:()=>ce(re.id),className:"delete-button",children:"Delete"}),re.clinic_id&&!et&&i.jsx("button",{onClick:()=>Se(re.clinic_id),className:"start-subscription-button",children:"Start Subscription"}),re.clinic_id&&et&&i.jsx("button",{onClick:()=>we(re.clinic_id),className:"cancel-subscription-button",children:"Cancel Subscription"})]})]},re.id)})})]})]})},Uee=()=>{const[e,n]=w.useState(""),[t,r]=w.useState(!0),[a,l]=w.useState(null);w.useEffect(()=>{(async()=>{try{const u=Qx();if(!u)throw new Error("Authentication token not found.");const h=await(await pe("/api/super-admin-settings/gemini-api-key",{headers:{Authorization:`Bearer ${u}`}})).json();n(h.gemini_api_key||"")}catch(u){console.error("Error fetching Gemini API key:",u),l({type:"error",text:"Failed to fetch Gemini API key."})}finally{r(!1)}})()},[]);const o=async()=>{r(!0),l(null);try{const f=Qx();if(!f)throw new Error("Authentication token not found.");await pe("/api/super-admin-settings/gemini-api-key",{method:"PUT",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"},body:JSON.stringify({gemini_api_key:e})}),l({type:"success",text:"Gemini API key updated successfully!"})}catch(f){console.error("Error updating Gemini API key:",f),l({type:"error",text:"Failed to update Gemini API key."})}finally{r(!1)}};return i.jsxs("div",{className:"admin-panel-container",children:[i.jsxs("h1",{className:"admin-panel-title",children:[i.jsx(ag,{size:32,className:"icon-margin"}),"Super Admin Dashboard"]}),i.jsxs("div",{className:"admin-panel-grid",children:[i.jsxs(is,{to:"/dashboard/clinic-subscriptions",className:"admin-panel-card",children:[i.jsx(Ad,{size:48,className:"card-icon"}),i.jsx("h2",{children:"Manage Clinic Subscription Plans"}),i.jsx("p",{children:"Add, edit, and view clinic subscription plans."})]}),i.jsxs(is,{to:"/dashboard/users",className:"admin-panel-card",children:[i.jsx(kh,{size:48,className:"card-icon"}),i.jsx("h2",{children:"User Management"}),i.jsx("p",{children:"Add, edit, and delete users; manage user roles."})]}),i.jsxs("div",{className:"admin-panel-card",children:[i.jsx(nI,{size:48,className:"card-icon"}),i.jsx("h2",{children:"Global Gemini API Key"}),i.jsx("p",{children:"Set the global default Gemini API key."}),i.jsxs("div",{className:"flex flex-col mt-4",children:[i.jsx("input",{type:"password",value:e,onChange:f=>n(f.target.value),placeholder:"Enter Global Gemini API Key",className:"p-2 border border-gray-300 rounded mb-2",disabled:t}),i.jsx("button",{onClick:o,className:"bg-blue-500 text-white p-2 rounded hover:bg-blue-600 disabled:bg-blue-300",disabled:t,children:t?"Saving...":"Save Global API Key"}),a&&i.jsx("p",{className:`mt-2 text-sm ${a.type==="success"?"text-green-600":"text-red-600"}`,children:a.text})]})]})]})]})},Rm="tutorialCurrentStep",_T=({onActionComplete:e,onStaffAdded:n,requiredRole:t})=>{const[r,a]=w.useState(""),[l,o]=w.useState(""),[f,u]=w.useState(""),[d,h]=w.useState(!1),g=t||"receptionist";w.useEffect(()=>{a(t==="lab"?"Lab":t==="pharmacy"?"Pharmacy":"")},[t]);const b=async()=>{if(!r||!l||!f){e(!1,"Please fill all fields.");return}h(!0);try{const v=await pe("/api/staff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,email:l,role:g,password:f})});if(v.ok)e(!0,`Successfully added "${r}" as a ${g}!`),a(""),o(""),u(""),n&&n(g);else{const N=await v.json();e(!1,`Failed to add staff: ${N.message||v.statusText}`)}}catch(v){console.error("Error adding staff:",v),e(!1,`Error adding staff: ${v instanceof Error?v.message:String(v)}`)}finally{h(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("h3",{children:"Add a New Staff Member"}),i.jsx("input",{type:"text",placeholder:"Staff Name",value:r,onChange:v=>a(v.target.value),className:"tutorial-input",disabled:d}),i.jsx("input",{type:"email",placeholder:"Email",value:l,onChange:v=>o(v.target.value),className:"tutorial-input",disabled:d}),i.jsx("input",{type:"password",placeholder:"Password",value:f,onChange:v=>u(v.target.value),className:"tutorial-input",disabled:d}),i.jsx("input",{type:"text",placeholder:"Role",value:g==="lab"?"Lab Technician":g==="pharmacy"?"Pharmacist":"Receptionist",className:"tutorial-input",disabled:!0}),i.jsx("button",{onClick:b,className:"tutorial-button primary",disabled:d,children:d?"Adding...":"Add Staff"})]})},qee=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState([]),[l,o]=w.useState(!1),f=async()=>{t(!0);try{const u=await pe("/api/drugs/import-defaults",{method:"POST"});if(u.ok){const d=await u.json(),h=d.drugs?d.drugs.map(g=>g.name):[];a(h),o(!0),e(!0,`Default medications imported: Added ${d.details.added}, Updated ${d.details.updated}.`,"pharmacyImport")}else{const d=await u.json();e(!1,`Failed to import default medications: ${d.message||u.statusText}`)}}catch(u){console.error("Error importing default medications:",u),e(!1,`Error importing default medications: ${u instanceof Error?u.message:String(u)}`)}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("h3",{children:"Import Default Medications"}),i.jsx("p",{children:"Click the button below to populate your pharmacy inventory with a list of common medications."}),i.jsx("button",{onClick:f,className:"tutorial-button primary",disabled:n,children:n?"Importing...":i.jsxs(i.Fragment,{children:[" ",i.jsx("i",{className:"fas fa-pills"})," Import Default Drugs"]})}),l&&r.length>0&&i.jsxs("div",{className:"imported-drugs-list",children:[i.jsx("h4",{children:"Medications Imported:"}),i.jsx("ul",{children:r.map((u,d)=>i.jsx("li",{children:u},d))})]})]})},Vee=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState([]),[l,o]=w.useState(!1),f=async()=>{t(!0);try{const u=await pe("/api/lab-tests/import-defaults",{method:"POST"});if(u.ok){const d=await u.json(),h=d.tests?d.tests.map(g=>g.name):[];a(h),o(!0),e(!0,`Default lab tests imported: Added ${d.details.added}, Updated ${d.details.updated}.`,"labImport")}else{const d=await u.json();e(!1,`Failed to import default lab tests: ${d.message||u.statusText}`)}}catch(u){console.error("Error importing default lab tests:",u),e(!1,`Error importing default lab tests: ${u instanceof Error?u.message:String(u)}`)}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("h3",{children:"Import Default Lab Tests"}),i.jsx("p",{children:"Click the button below to populate your lab test inventory with a list of common tests."}),i.jsx("button",{onClick:f,className:"tutorial-button primary",disabled:n,children:n?"Importing...":i.jsxs(i.Fragment,{children:[" ",i.jsx("i",{className:"fas fa-flask"})," Import Default Lab Tests"]})}),l&&r.length>0&&i.jsxs("div",{className:"imported-drugs-list",children:[i.jsx("h4",{children:"Tests Imported:"}),i.jsx("ul",{children:r.map((u,d)=>i.jsx("li",{children:u},d))})]})]})},Lm=[{title:"Welcome to Your Admin Dashboard!",description:"This quick tour will guide you through essential features to get your clinic set up.",actionText:"Let's Start!",actionPath:null,component:null},{title:"Step 1: Manage Pharmacy Inventory",description:"Set up your pharmacy by adding drugs, managing stock levels, and importing default drug lists. This ensures smooth prescription fulfillment. Import default medications now!",actionText:"Go to Pharmacy Inventory",actionPath:"/dashboard/inventory",component:qee},{title:"Step 2: Manage Lab Test Inventory",description:"Configure your laboratory by adding available lab tests and importing default test lists. This is crucial for accurate diagnostics. Import default lab tests now!",actionText:"Go to Lab Test Inventory",actionPath:"/lab-inventory",component:Vee},{title:"Step 3: Add Staff Members (Optional)",description:"You can add your clinic's staff, including doctors, receptionists, lab technicians, and pharmacists. Each role has specific permissions. You can skip this step for now.",actionText:"Go to Staff Management",actionPath:null,component:_T},{title:"You're All Set!",description:"You've completed the basic setup tour. Now, try out the AI-powered complaint analysis feature!",actionText:"Try the AI!",actionPath:"/edit-complaints",component:null}],Hee=({onClose:e,onMarkAsSeen:n})=>{const[t,r]=w.useState(()=>{const F=localStorage.getItem(Rm);return F?parseInt(F,10):0}),[a,l]=w.useState(null),[o,f]=w.useState(null),[u,d]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(4),N=gt();w.useEffect(()=>{if(localStorage.setItem(Rm,t.toString()),l(null),f(null),t===0){v(4);const F=setTimeout(()=>{r(B=>B+1)},4e3),$=setInterval(()=>{v(B=>B-1)},1e3);return()=>{clearTimeout(F),clearInterval($)}}},[t]);const k=(F,$,B)=>{f(F),l($),F&&(B==="pharmacyImport"||B==="labImport")&&r(z=>z+1)},T=()=>{},E=()=>{n(),e(),localStorage.removeItem(Rm)},I=async()=>{const F=Lm[t];if(V&&F.actionPath==="/edit-complaints"){d(!0),g(null);try{const $=await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"New Patient - AI Entry",age:null,gender:null,phone:null,address:null})});if(!$.ok){const G=await $.text();throw new Error(`Failed to create patient: ${G||$.statusText} (${$.status})`)}const B=await $.json();if(!B||!B.id)throw new Error("Failed to create new patient or retrieve patient ID.");const z=B.id,q=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:z,complaint:""})});if(!q.ok){const G=await q.text();throw new Error(`Failed to create queue entry: ${G||q.statusText} (${q.status})`)}const O=await q.json();if(!O||!O.id)throw new Error("Failed to create new complaint record or retrieve record ID.");const R=O.id;N(`/dashboard/edit-complaint/${R}`),e(),n(),localStorage.removeItem(Rm)}catch($){console.error("Error starting new AI complaint:",$);const B=`Error: ${$.message||"Failed to start new AI complaint process."}`;g(B)}finally{d(!1)}}else F.actionPath&&(N(F.actionPath),e(),t===Lm.length-1&&(n(),localStorage.removeItem(Rm)))},P=Lm[t],V=t===Lm.length-1;return i.jsx("div",{className:"tutorial-modal-overlay",children:i.jsxs("div",{className:"tutorial-modal-content",children:[i.jsx("h2",{children:P.title}),i.jsx("p",{children:P.description}),P.component&&i.jsxs("div",{className:"tutorial-interactive-area",children:[t===3?i.jsx(_T,{onActionComplete:k,onStaffAdded:T,requiredRole:null}):i.jsx(P.component,{onActionComplete:k}),a&&i.jsx("p",{className:`tutorial-message ${o?"success":"error"}`,children:a})]}),h&&i.jsx("p",{className:"tutorial-message error",children:h})," ",i.jsxs("div",{className:"tutorial-modal-actions",children:[P.actionPath&&i.jsx("button",{onClick:I,className:"tutorial-button action",disabled:u,children:u?"Creating AI Patient...":P.actionText}),t===3&&i.jsx("button",{onClick:()=>r(t+1),className:"tutorial-button secondary",children:"Next Step"}),i.jsx("button",{onClick:E,className:"tutorial-button secondary",disabled:u,children:"Skip Tutorial"})]}),t===0&&i.jsxs("div",{className:"tutorial-countdown-indicator",children:["Next step in ",b," seconds..."]}),i.jsxs("div",{className:"tutorial-step-indicator",children:["Step ",t+1," of ",Lm.length]})]})})},Gee=(e,n,t)=>{const r=Math.abs(e.getTime()-n.getTime());return Math.ceil(r/(1e3*60*60*24))<=t},Kj=e=>{if(e.match(/^\d{4}-\d{2}-\d{2}$/))return new Date(e);const n=e.split("/");if(n.length===3){const t=parseInt(n[0],10),r=parseInt(n[1],10)-1,a=parseInt(n[2],10),l=new Date(a,r,t),o=parseInt(n[0],10)-1,f=parseInt(n[1],10),u=parseInt(n[2],10),d=new Date(u,o,f),h=!isNaN(l.getTime()),g=!isNaN(d.getTime());if(h&&g)return l;if(h)return l;if(g)return d}return new Date(e)},kT=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,l]=w.useState(null),[o,f]=w.useState(""),[u,d]=w.useState(""),[h,g]=w.useState(1),[b]=w.useState(10),v=new Date,N=gt();w.useEffect(()=>{(async()=>{r(!0);try{const O=await pe("/api/pharmacy-orders/refill-reminders");if(O.ok){const R=await O.json();n(R)}else l("Failed to fetch refill reminders.")}catch{l("An error occurred while fetching data.")}finally{r(!1)}})()},[]);const k=z=>{f(z.target.value),g(1)},T=z=>{d(z.target.value),g(1)},E=e.filter(z=>{const q=o?z.medicationRefillDates.some(R=>{const G=Kj(R.refillDate);return!isNaN(G.getTime())&&G.toISOString().split("T")[0]===o}):!0,O=u?z.patientName.toLowerCase().includes(u.toLowerCase())||z.patientPhoneNumber.includes(u)||z.items.some(R=>R.name.toLowerCase().includes(u.toLowerCase())):!0;return q&&O}),I=h*b,P=I-b,V=E.slice(P,I),F=Math.ceil(E.length/b),$=z=>g(z),B=async z=>{try{const q=await pe(`/api/queue/patient/${z}/latest`);if(q.ok){const R=await q.json();if(R!=null&&R._id){N(`/dashboard/edit-complaint/${R._id}`,{state:{patientId:z}});return}}const O=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:z})});if(O.ok){const R=await O.json();R!=null&&R.id&&N(`/dashboard/edit-complaint/${R.id}`,{state:{patientId:z}})}}catch(q){console.error("Error handling row click:",q),l("Failed to navigate to patient complaint.")}};return t?i.jsx("div",{children:"Loading..."}):a?i.jsx("div",{children:a}):i.jsxs("div",{className:"refill-reminders-container",children:[i.jsx("h1",{children:"Refill Reminders"}),i.jsxs("div",{className:"controls-container",children:[i.jsxs("div",{className:"filter-container",children:[i.jsx("label",{htmlFor:"refillDate",children:"Filter by Refill Date: "}),i.jsx("input",{type:"date",id:"refillDate",value:o,onChange:k})]}),i.jsxs("div",{className:"search-container",children:[i.jsx("label",{htmlFor:"search",children:"Search: "}),i.jsx("input",{type:"text",id:"search",placeholder:"Search by patient name, phone, or medication",value:u,onChange:T})]})]}),i.jsxs("table",{children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient Name"}),i.jsx("th",{children:"Patient Phone Number"}),i.jsx("th",{children:"Medications"}),i.jsx("th",{children:"Refill Dates"})]})}),i.jsx("tbody",{children:V.length>0?V.map(z=>i.jsxs("tr",{onClick:()=>B(z.patientId),style:{cursor:"pointer"},children:[i.jsx("td",{children:z.patientName}),i.jsx("td",{children:z.patientPhoneNumber}),i.jsxs("td",{children:[i.jsx("ul",{children:z.items.map((q,O)=>i.jsxs("li",{children:[q.name," (Qty: ",q.quantity,")",q.tabletsPerDay&&i.jsxs("span",{children:[" - ",q.tabletsPerDay," / day"]}),q.numberOfDays&&i.jsxs("span",{children:[" for ",q.numberOfDays," days"]})]},O))}),i.jsxs("div",{children:["Last Updated: ",new Date(z.updatedAt).toLocaleDateString()]}),z.prescription_for_unavailable_drugs&&i.jsxs("div",{className:"unavailable-prescription",children:[i.jsx("strong",{children:"Unavailable:"})," ",z.prescription_for_unavailable_drugs]})]}),i.jsx("td",{children:i.jsx("ul",{children:z.medicationRefillDates.map((q,O)=>{const R=Kj(q.refillDate),G=!isNaN(R.getTime())&&Gee(R,v,2);return i.jsxs("li",{className:G?"highlight-refill-date":"",children:[q.name,": ",isNaN(R.getTime())?"Invalid Date":R.toLocaleDateString()]},O)})})})]},z.id)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:"No refill reminders found."})})})]}),i.jsxs("div",{className:"pagination-container",children:[i.jsx("button",{onClick:()=>$(h-1),disabled:h===1,children:"Previous"}),Array.from({length:F},(z,q)=>i.jsx("button",{onClick:()=>$(q+1),className:h===q+1?"active":"",children:q+1},q+1)),i.jsx("button",{onClick:()=>$(h+1),disabled:h===F,children:"Next"})]})]})},Yee=()=>{const e=gt(),n=rr();return w.useEffect(()=>{const t=new URLSearchParams(n.search),r=t.get("token"),a=t.get("caseDetails");r?(async()=>{try{const o=await pe(`/api/patients?search=${r}&limit=1`);if(!o.ok)throw new Error("Failed to fetch patient by token");const u=(await o.json()).patients[0];if(!u)throw new Error("Patient with the given token not found");const d=await pe(`/api/queue/patient/${u.id}/latest`);if(d.ok){const b=await d.json();if(b!=null&&b._id){e(`/dashboard/edit-complaint/${b._id}`,{state:{initialComplaint:a,patientId:u.id}});return}}const h=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:u.id,complaint:a})});if(!h.ok)throw new Error("Failed to create queue entry");const g=await h.json();if(g!=null&&g.id)e(`/dashboard/edit-complaint/${g.id}`,{state:{initialComplaint:a,patientId:u.id}});else throw new Error("Failed to get ID from new queue entry.")}catch(o){console.error("Error handling complaint URL:",o),e("/dashboard/search-patient")}})():e("/dashboard/search-patient")},[n,e]),i.jsx("div",{children:"Loading..."})},Wee=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,l]=w.useState(null),o=w.useCallback(async()=>{r(!0),l(null);try{const d=await pe("/api/notifications?all=true");if(d.ok){const g=(await d.json()).sort((b,v)=>{const N={expired_drug:1,near_expiry_drug:2,low_stock:3},k=N[b.type]||99,T=N[v.type]||99;return k!==T?k-T:new Date(v.created_at).getTime()-new Date(b.created_at).getTime()});n(g)}else l("Failed to fetch notifications."),console.error("Failed to fetch notifications:",d.statusText)}catch(d){l("Error fetching notifications."),console.error("Error fetching notifications:",d)}finally{r(!1)}},[]);w.useEffect(()=>{o()},[o]);const f=async d=>{try{const h=await pe(`/api/notifications/${d}/read`,{method:"PUT"});h.ok?n(g=>g.map(b=>b.id===d?{...b,is_read:!0}:b)):console.error("Failed to mark notification as read:",h.statusText)}catch(h){console.error("Error marking notification as read:",h)}},u=async()=>{try{const d=e.filter(g=>!g.is_read).map(g=>g.id);if(d.length===0)return;const h=await pe("/api/notifications/mark-all-read",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationIds:d})});h.ok?n(g=>g.map(b=>({...b,is_read:!0}))):console.error("Failed to mark all notifications as read:",h.statusText)}catch(d){console.error("Error marking all notifications as read:",d)}};return t?i.jsx("div",{className:"notifications-page-container",children:"Loading notifications..."}):a?i.jsx("div",{className:"notifications-page-container error-message",children:a}):i.jsxs("div",{className:"notifications-page-container",children:[i.jsx("h2",{className:"notifications-page-title",children:"All Notifications"}),i.jsx("div",{className:"notifications-actions",children:i.jsx("button",{onClick:u,disabled:e.every(d=>d.is_read),className:"mark-all-read-button",children:"Mark All As Read"})}),e.length===0?i.jsx("p",{className:"no-notifications-message",children:"No notifications to display."}):i.jsx("ul",{className:"notifications-list",children:e.map(d=>i.jsxs("li",{className:`notification-item ${d.is_read?"read":"unread"}`,children:[i.jsxs("div",{className:"notification-content",children:[i.jsxs("span",{className:"notification-type",children:[d.type.replace(/_/g," "),": "]}),d.message]}),i.jsxs("div",{className:"notification-meta",children:[i.jsx("span",{className:"notification-timestamp",children:new Date(d.created_at).toLocaleString()}),!d.is_read&&i.jsx("button",{onClick:()=>f(d.id),className:"mark-read-button",children:"Mark as Read"})]})]},d.id))})]})},Xj=()=>{const e=gt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[l,o]=w.useState(null),[f,u]=w.useState(!1),[d,h]=w.useState(!1),[g,b]=w.useState(!1),[v,N]=w.useState(!1),[k,T]=w.useState(!1),[E,I]=w.useState(null),[P,V]=w.useState([]),[F,$]=w.useState(null),[B,z]=w.useState(""),[q,O]=w.useState(""),[R,G]=w.useState(""),[ee,te]=w.useState(""),[le,K]=w.useState(""),[U,J]=w.useState(""),[ne,A]=w.useState(""),[ae,ce]=w.useState(""),[M,de]=w.useState(""),[Se,fe]=w.useState(""),[we,re]=w.useState(""),_e=w.useCallback(async()=>{a(!0),o(null);try{const se=await pe("/api/distributors");if(!se.ok)throw new Error(`Failed to fetch distributors: ${se.statusText}`);const Q=await se.json();t(Q)}catch(se){console.error("Failed to fetch distributors:",se),o(se.message||"Failed to load distributors.")}finally{a(!1)}},[]);w.useEffect(()=>{_e()},[_e]);const qe=async se=>{se.preventDefault(),o(null);try{const Q=await pe("/api/distributors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:B,contact_person:q,phone:R,email:ee,address:le,gst_number:U,drug_license_number:ne})});if(!Q.ok){const ie=await Q.json();throw new Error(ie.message||"Failed to add distributor.")}alert("Distributor added successfully!"),ve(),_e()}catch(Q){console.error("Error adding distributor:",Q),o(Q.message||"Failed to add distributor.")}},et=async se=>{if(se.preventDefault(),o(null),!!E)try{const Q=await pe(`/api/distributors/${E.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:B,contact_person:q,phone:R,email:ee,address:le,gst_number:U,drug_license_number:ne})});if(!Q.ok){const ie=await Q.json();throw new Error(ie.message||"Failed to update distributor.")}alert("Distributor updated successfully!"),De(),_e()}catch(Q){console.error("Error updating distributor:",Q),o(Q.message||"Failed to update distributor.")}},Je=async()=>{if(o(null),!!E)try{const se=await pe(`/api/distributors/${E.id}`,{method:"DELETE"});if(!se.ok){const Q=await se.json();throw new Error(Q.message||"Failed to delete distributor.")}alert("Distributor deleted successfully!"),lt(),_e()}catch(se){console.error("Error deleting distributor:",se),o(se.message||"Failed to delete distributor.")}},Le=w.useCallback(async se=>{o(null);try{const Q=await pe(`/api/distributors/${se}/payments`);if(!Q.ok)throw new Error(`Failed to fetch payments: ${Q.statusText}`);const je=(await Q.json()).map(st=>({...st,order_value:parseFloat(st.order_value),amount_paid:parseFloat(st.amount_paid),balance_remaining:parseFloat(st.balance_remaining)}));V(je);const Ae=await pe(`/api/distributors/${se}/balance`);if(!Ae.ok)throw new Error(`Failed to fetch balance: ${Ae.statusText}`);const Be=await Ae.json();$({totalOrderValue:parseFloat(Be.totalOrderValue),totalAmountPaid:parseFloat(Be.totalAmountPaid),remainingBalance:parseFloat(Be.remainingBalance)})}catch(Q){console.error("Error fetching payments/balance:",Q),o(Q.message||"Failed to load payments or balance.")}},[]),xe=async se=>{if(se.preventDefault(),o(null),!!E)try{const Q=await pe(`/api/distributors/${E.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:ae,order_value:parseFloat(M||"0"),amount_paid:parseFloat(Se||"0"),notes:we})});if(!Q.ok){const ie=await Q.json();throw new Error(ie.message||"Failed to add payment.")}alert("Payment added successfully!"),an(),Le(E.id)}catch(Q){console.error("Error adding payment:",Q),o(Q.message||"Failed to add payment.")}},Me=()=>{z(""),O(""),G(""),te(""),K(""),J(""),A(""),o(null),u(!0)},ve=()=>{u(!1)},Ee=se=>{I(se),z(se.name),O(se.contact_person||""),G(se.phone||""),te(se.email||""),K(se.address||""),J(se.gst_number||""),A(se.drug_license_number||""),o(null),h(!0)},De=()=>{h(!1),I(null)},nt=se=>{I(se),o(null),b(!0)},lt=()=>{b(!1),I(null)},Xe=se=>{I(se),Le(se.id),o(null),N(!0)},Mt=()=>{N(!1),I(null),V([]),$(null)},_t=se=>{I(se),ce(new Date().toISOString().split("T")[0]),de("0"),fe("0"),re(""),o(null),T(!0)},an=()=>{T(!1),I(null)};return r?i.jsx("div",{className:"loading-indicator",children:"Loading Distributors..."}):l?i.jsxs("div",{className:"error-indicator",children:["Error: ",l]}):i.jsxs("div",{className:"distributor-management-page",children:[i.jsxs("div",{className:"distributor-management-header",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[i.jsx(Lt,{size:24})," Back"]}),i.jsx("h2",{children:"Distributor Management"})]}),(()=>{const se=n.reduce((ie,je)=>ie+parseFloat(je.remainingBalance||"0"),0),Q=se>=0?"balance-positive":"balance-negative";return i.jsxs("div",{className:`total-balance-display ${Q}`,children:[i.jsx("strong",{children:"Total Combined Balance:"})," ",se.toFixed(2)]})})(),i.jsxs("button",{onClick:Me,className:"add-distributor-button",children:[i.jsx(jo,{size:18}),"Add New Distributor"]})]}),i.jsx("div",{className:"distributor-table-container",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Contact Person"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Address"}),i.jsx("th",{children:"GST Number"})," ",i.jsx("th",{children:"Drug License Number"})," ",i.jsx("th",{children:"Remaining Balance"})," ",i.jsx("th",{className:"actions-cell",children:"Actions"})]})}),i.jsx("tbody",{children:n.length===0?i.jsxs("tr",{children:[i.jsx("td",{colSpan:9,className:"no-results-message",children:"No distributors found."})," "]}):n.map(se=>i.jsxs("tr",{children:[i.jsx("td",{children:se.name}),i.jsx("td",{children:se.contact_person||"-"}),i.jsx("td",{children:se.phone||"-"}),i.jsx("td",{children:se.email||"-"}),i.jsx("td",{children:se.address||"-"}),i.jsx("td",{children:se.gst_number||"-"})," ",i.jsx("td",{children:se.drug_license_number||"-"})," ",i.jsxs("td",{className:parseFloat(se.remainingBalance||"0")>0?"balance-positive":"balance-negative",children:["",se.remainingBalance||"0.00"]})," ",i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsxs("button",{onClick:()=>Xe(se),className:"action-text-button view-button",title:"View Payments & Balance",children:[i.jsx(__,{size:16})," View Payments"]}),i.jsxs("button",{onClick:()=>_t(se),className:"action-text-button add-payment-button",title:"Add Payment",children:[i.jsx(jo,{size:16})," Add Payment"]}),i.jsx("button",{onClick:()=>Ee(se),className:"action-icon-button edit-button",title:"Edit Distributor",children:i.jsx(Md,{size:16})}),i.jsx("button",{onClick:()=>nt(se),className:"action-icon-button delete-button",title:"Delete Distributor",children:i.jsx(Ri,{size:16})})]})})]},se.id))})]})}),f&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:ve,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Add New Distributor"}),l&&i.jsx("div",{className:"modal-error-message",children:l}),i.jsxs("form",{onSubmit:qe,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Name:"}),i.jsx("input",{type:"text",id:"name",value:B,onChange:se=>z(se.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"contact_person",value:q,onChange:se=>O(se.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"phone",value:R,onChange:se=>G(se.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email:"}),i.jsx("input",{type:"email",id:"email",value:ee,onChange:se=>te(se.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"address",children:"Address:"}),i.jsx("textarea",{id:"address",value:le,onChange:se=>K(se.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"gst_number",value:U,onChange:se=>J(se.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"drug_license_number",value:ne,onChange:se=>A(se.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:ve,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Distributor"})]})]})]})}),d&&E&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:De,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Edit Distributor"}),l&&i.jsx("div",{className:"modal-error-message",children:l}),i.jsxs("form",{onSubmit:et,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-name",children:"Name:"}),i.jsx("input",{type:"text",id:"edit-name",value:B,onChange:se=>z(se.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"edit-contact_person",value:q,onChange:se=>O(se.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"edit-phone",value:R,onChange:se=>G(se.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-email",children:"Email:"}),i.jsx("input",{type:"email",id:"edit-email",value:ee,onChange:se=>te(se.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-address",children:"Address:"}),i.jsx("textarea",{id:"edit-address",value:le,onChange:se=>K(se.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"edit-gst_number",value:U,onChange:se=>J(se.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"edit-drug_license_number",value:ne,onChange:se=>A(se.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:De,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Save Changes"})]})]})]})}),g&&E&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:lt,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Confirm Delete"}),i.jsxs("p",{children:['Are you sure you want to delete distributor "',E.name,'"?']}),l&&i.jsx("div",{className:"modal-error-message",children:l}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:lt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Je,className:"button-delete",children:"Delete"})]})]})}),v&&E&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content large-modal",children:[i.jsx("button",{onClick:Mt,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Payments & Balance for ",E.name]}),l&&i.jsx("div",{className:"modal-error-message",children:l}),F&&i.jsxs("div",{className:"balance-summary",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Total Order Value:"})," ",F.totalOrderValue.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Total Amount Paid:"})," ",F.totalAmountPaid.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Remaining Balance:"})," ",F.remainingBalance.toFixed(2)]})]}),i.jsx("h4",{children:"Payment History"}),P.length===0?i.jsx("p",{children:"No payments recorded for this distributor."}):i.jsx("div",{className:"table-responsive",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Order Value"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Balance Remaining"}),i.jsx("th",{children:"Notes"})]})}),i.jsx("tbody",{children:P.map(se=>i.jsxs("tr",{children:[i.jsx("td",{children:new Date(se.payment_date).toLocaleDateString()}),i.jsxs("td",{children:["",se.order_value.toFixed(2)]}),i.jsxs("td",{children:["",se.amount_paid.toFixed(2)]}),i.jsxs("td",{children:["",se.balance_remaining.toFixed(2)]}),i.jsx("td",{children:se.notes||"-"})]},se.id))})]})}),i.jsx("div",{className:"modal-actions",children:i.jsx("button",{type:"button",onClick:Mt,className:"button-cancel",children:"Close"})})]})}),k&&E&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:an,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Add Payment for ",E.name]}),l&&i.jsx("div",{className:"modal-error-message",children:l}),i.jsxs("form",{onSubmit:xe,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_date",children:"Payment Date:"}),i.jsx("input",{type:"date",id:"payment_date",value:ae,onChange:se=>ce(se.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"order_value",children:"Order Value:"}),i.jsx("input",{type:"number",id:"order_value",value:M,onChange:se=>de(se.target.value),step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"amount_paid",children:"Amount Paid:"}),i.jsx("input",{type:"number",id:"amount_paid",value:Se,onChange:se=>fe(se.target.value),step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_notes",children:"Notes:"}),i.jsx("textarea",{id:"payment_notes",value:we,onChange:se=>re(se.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:an,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Payment"})]})]})]})})]})},Qee=({isOpen:e,onClose:n,excelHeaders:t,onConfirm:r,availableFields:a})=>{const[l,o]=w.useState({});if(w.useEffect(()=>{e&&u()},[e,t,a]),!e)return null;const f=(h,g)=>{o(b=>({...b,[h]:g}))},u=()=>{const h={};t.forEach(g=>{const b=a.map(N=>({name:N})),v=$m(g,b);v&&(h[g]=v.name)}),o(h)},d=()=>{const h={};for(const g in l)l[g]&&l[g]!=="none"&&(h[g]=l[g]);r(h),n()};return i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:n,className:"modal-close-button",children:i.jsx(Qn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Match File Columns"}),i.jsx("p",{className:"modal-description",children:'Please match the columns from your uploaded file to the corresponding fields in the drug inventory. You can use the "Auto Match" button for suggestions.'}),i.jsx("div",{className:"modal-actions-top",children:i.jsx("button",{type:"button",onClick:u,className:"button-auto-match",children:"Auto Match"})}),i.jsxs("div",{className:"column-mapping-grid",children:[i.jsx("div",{className:"grid-header",children:"Excel Column"}),i.jsx("div",{className:"grid-header",children:"App Field"}),t.map((h,g)=>i.jsxs(En.Fragment,{children:[i.jsx("div",{className:"excel-header-cell",children:h}),i.jsx("div",{className:"app-field-cell",children:i.jsxs("select",{value:l[h]||"",onChange:b=>f(h,b.target.value),className:"app-field-select",children:[i.jsx("option",{value:"",children:"-- Select Field --"}),i.jsx("option",{value:"none",children:"None (Ignore Column)"}),a.map((b,v)=>i.jsxs("option",{value:b,children:[b==="name"?"Composition Name":b==="brand_name"?"Brand Name":b==="price"?"MRP":b==="buying_price"?"Rate":b==="unit"?"Pack":b==="batch"?"Batch":b==="hsn_code"?"HSN Code":b==="mfg"?"MFG":b==="loose_quantity"?"Loose":b.replace(/_/g," ").replace(/\b\w/g,N=>N.toUpperCase())," "]},v))]})})]},g))]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:n,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:d,className:"button-submit",children:"Confirm Mapping"})]})]})})},Jee=({isOpen:e,onClose:n,onDrugAddedToPurchase:t})=>{const[r,a]=w.useState({name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",expiry_date:"",buying_price:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),[l,o]=w.useState(null),[f,u]=w.useState(!1),[d,h]=w.useState(!1),g=w.useRef(null),b=w.useRef(null),v=w.useRef(null);w.useEffect(()=>{e&&(a({name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",expiry_date:"",buying_price:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),o(null),u(!1),h(!1))},[e]),w.useEffect(()=>{const T=I=>{I.key==="Tab"&&b.current===document.activeElement&&(d||(h(!0),setTimeout(()=>{var P;(P=v.current)==null||P.focus()},0),I.preventDefault()))},E=I=>{g.current&&!g.current.contains(I.target)&&h(!1)};return document.addEventListener("keydown",T),document.addEventListener("mousedown",E),()=>{document.removeEventListener("keydown",T),document.removeEventListener("mousedown",E)}},[d]);const N=T=>{const{name:E,value:I,type:P}=T.target;a(V=>({...V,[E]:P==="number"?parseFloat(I)||null:I}))},k=T=>{if(T.preventDefault(),o(null),u(!0),r.price===void 0||r.quantity_in_stock===void 0){o("MRP and Stock Quantity are required."),u(!1);return}const E={...r,name:r.name===""?null:r.name,composition:r.composition===""?null:r.composition,buying_price:r.buying_price===0?null:r.buying_price,expiry_date:r.expiry_date===""?null:r.expiry_date,gst:r.gst===0?null:r.gst,margin:r.margin===0?null:r.margin,discount:r.discount===0?null:r.discount,brand_name:r.brand_name===""?null:r.brand_name,batch:r.batch===""?null:r.batch,hsn_code:r.hsn_code===""?null:r.hsn_code,mfg:r.mfg===""?null:r.mfg,loose:r.loose===0?null:r.loose};t(E),u(!1),n()};return e?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content add-drug-form-container max-w-2xl mx-auto",children:[i.jsxs("div",{className:"add-drug-form-header",children:[i.jsx("h2",{children:"Add New Drug"}),i.jsx("button",{onClick:n,className:"cancel-button",title:"Close",children:i.jsx(Qn,{size:24})})]}),l&&i.jsx("div",{className:"error-message",children:l}),i.jsxs("form",{onSubmit:k,className:"add-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"name",className:"form-label",children:"Composition Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Il,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"name",value:r.name||"",onChange:N,className:"custom-text-input mt-1",placeholder:"e.g., Paracetamol",tabIndex:1})]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"brand_name",className:"form-label",children:"Brand Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Il,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"brand_name",value:r.brand_name||"",onChange:N,className:"custom-text-input mt-1",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"price",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Il,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"price",id:"price",required:!0,step:"0.01",min:"0",value:r.price,onChange:N,className:"custom-text-input mt-1",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"quantity_in_stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Il,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"quantity_in_stock",id:"quantity_in_stock",required:!0,step:"1",min:"0",value:r.quantity_in_stock,onChange:N,className:"custom-text-input mt-1",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"unit",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"unit",id:"unit",value:r.unit||"",onChange:N,className:"custom-text-input mt-1",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"expiry_date",value:r.expiry_date||"",onChange:N,className:"custom-text-input mt-1",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"box_number",value:r.box_number||"",onChange:N,className:"custom-text-input mt-1",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:g,children:[i.jsx("button",{type:"button",onClick:()=>h(!d),className:"form-button w-full text-left",tabIndex:8,ref:b,children:"Others"}),d&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"description",rows:3,value:r.description||"",onChange:N,className:"custom-text-input mt-1",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"buying_price",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"buying_price",id:"buying_price",step:"0.01",min:"0",value:r.buying_price??"",onChange:N,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:10,ref:v})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"gst",step:"0.01",min:"0",max:"100",value:r.gst??"",onChange:N,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:11})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"margin",step:"0.01",min:"0",max:"100",value:r.margin??"",onChange:N,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"discount",step:"0.01",min:"0",max:"100",value:r.discount??"",onChange:N,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"batch",value:r.batch||"",onChange:N,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"hsn_code",value:r.hsn_code||"",onChange:N,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"mfg",value:r.mfg||"",onChange:N,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"loose",className:"form-label",children:"Loose Quantity"}),i.jsx("input",{type:"number",name:"loose",id:"loose",step:"1",min:"0",value:r.loose??"",onChange:N,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:17})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:n,disabled:f,className:"form-button cancel-form-button",tabIndex:18,children:"Cancel"}),i.jsx("button",{type:"submit",disabled:f,className:"form-button submit-form-button inline-flex justify-center",tabIndex:19,children:f?"Adding...":"Add Drug"})]})]})]})}):null},Kee=e=>{if(!e)return null;const n=String(e).trim().toLowerCase();if(!n)return null;const t={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12",january:"01",february:"02",march:"03",april:"04",june:"06",july:"07",august:"08",september:"09",october:"10",november:"11",december:"12"};let r,a,l;const o=n.match(/^(\d{1,2})[\s\-./]*([a-z]{3})[a-z]*[\s\-./]*(\d{2,4})$/),f=n.match(/^([a-z]{3})[a-z]*[\s\-./]*(\d{1,2})[\s\-./]*(\d{2,4})$/),u=n.match(/^(\d{1,2})[\s\-./]+(\d{1,2})[\s\-./]+(\d{2,4})$/);if(o)r=o[1],a=t[o[2].substring(0,3)],l=o[3];else if(f)a=t[f[1].substring(0,3)],r=f[2],l=f[3];else if(u)r=u[1],a=u[2],l=u[3];else{const h=Date.parse(n);return isNaN(h)?null:new Date(h).toISOString().split("T")[0]}if(!r||!a||!l)return null;l.length===2&&(l=(parseInt(l)<50?"20":"19")+l),r=r.padStart(2,"0"),a=a.padStart(2,"0");const d=new Date(parseInt(l),parseInt(a)-1,parseInt(r));return d.getFullYear()===parseInt(l)&&d.getMonth()===parseInt(a)-1&&d.getDate()===parseInt(r)?`${l}-${a}-${r}`:null},Xee=({purchaseRows:e,onCellChange:n,onRemoveDrug:t,onAddEmptyRow:r,lastAddMethod:a})=>{const l=w.useRef(new Map),[o,f]=w.useState(e.length);w.useEffect(()=>{var d;if(e.length>o&&a==="manual"){const h=e.length-1;(d=l.current.get(`${h}-name`))==null||d.focus()}f(e.length)},[e.length,o,a]);const u=(d,h,g)=>{const b=h===e.length-1;b&&d.key==="Enter"&&(d.preventDefault(),r()),b&&d.key==="Tab"&&g==="box_number"&&!d.shiftKey&&(d.preventDefault(),r())};return i.jsxs("table",{className:"data-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{width:"40px"},children:"#"}),i.jsx("th",{style:{minWidth:"180px"},children:"Drug Name"}),i.jsx("th",{style:{minWidth:"120px"},children:"Brand"}),i.jsx("th",{style:{minWidth:"100px"},children:"Batch"}),i.jsx("th",{style:{minWidth:"130px"},children:"Expiry"}),i.jsx("th",{style:{minWidth:"70px"},children:"Qty"}),i.jsx("th",{style:{minWidth:"70px"},children:"Free"}),i.jsx("th",{style:{minWidth:"70px"},children:"Unit"}),i.jsx("th",{style:{minWidth:"90px"},children:"Buy "}),i.jsx("th",{style:{minWidth:"90px"},children:"MRP "}),i.jsx("th",{style:{minWidth:"60px"},children:"Disc%"}),i.jsx("th",{style:{minWidth:"60px"},children:"GST%"}),i.jsx("th",{style:{minWidth:"70px"},children:"Mrgn%"}),i.jsx("th",{style:{minWidth:"80px"},children:"HSN"}),i.jsx("th",{style:{minWidth:"80px"},children:"Mfg"}),i.jsx("th",{style:{minWidth:"80px"},children:"Rack"}),i.jsx("th",{className:"sticky-col-right",style:{width:"50px",textAlign:"center"},children:i.jsx(Ri,{size:16})})]})}),i.jsx("tbody",{children:e.map((d,h)=>i.jsxs("tr",{children:[i.jsx("td",{style:{textAlign:"center",color:"var(--text-tertiary)",fontWeight:600,fontSize:"0.85rem"},children:h+1}),i.jsx("td",{children:i.jsx("input",{ref:g=>{l.current.set(`${h}-name`,g)},className:"table-input",value:d.name||"",placeholder:"Name",onChange:g=>n(g,d.id||"","name"),onKeyDown:g=>u(g,h,"name"),autoComplete:"off"})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.brand_name||"",placeholder:"Brand",onChange:g=>n(g,d.id||"","brand_name"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.batch||"",placeholder:"Batch",onChange:g=>n(g,d.id||"","batch"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"date",className:"table-input",value:d.expiry_date||"",onChange:g=>n(g,d.id||"","expiry_date"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.quantity_in_stock||"",placeholder:"0",onChange:g=>n(g,d.id||"","quantity_in_stock"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.loose||"",placeholder:"0",onChange:g=>n(g,d.id||"","loose"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.unit||"",placeholder:"Tab/Strip",onChange:g=>n(g,d.id||"","unit"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.buying_price||"",placeholder:"0.00",onChange:g=>n(g,d.id||"","buying_price"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.price||"",placeholder:"0.00",onChange:g=>n(g,d.id||"","price"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.discount||"",placeholder:"0",onChange:g=>n(g,d.id||"","discount"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.gst||"",placeholder:"5",onChange:g=>n(g,d.id||"","gst"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.margin||"",placeholder:"0",onChange:g=>n(g,d.id||"","margin"),onKeyDown:g=>u(g,h),readOnly:!0,style:{color:"var(--secondary)",fontWeight:"bold",cursor:"default"}})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.hsn_code||"",placeholder:"HSN",onChange:g=>n(g,d.id||"","hsn_code"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.mfg||"",placeholder:"Mfg",onChange:g=>n(g,d.id||"","mfg"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.box_number||"",placeholder:"Rack",onChange:g=>n(g,d.id||"","box_number"),onKeyDown:g=>u(g,h,"box_number")})}),i.jsx("td",{className:"sticky-col-right",style:{textAlign:"center"},children:i.jsx("button",{onClick:()=>t(d.id||""),className:"delete-row-btn",tabIndex:-1,title:"Remove Row",children:i.jsx(Ri,{size:16})})})]},d.id))})]})},Zj=()=>{const e=gt(),[n,t]=w.useState(()=>{const we=localStorage.getItem("theme");return we||(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});w.useEffect(()=>{document.documentElement.setAttribute("data-theme",n)},[n]),w.useEffect(()=>{const we=window.matchMedia("(prefers-color-scheme: dark)"),re=_e=>{localStorage.getItem("theme")||t(_e.matches?"dark":"light")};return we.addEventListener("change",re),()=>we.removeEventListener("change",re)},[]);const r=()=>t(we=>{const re=we==="light"?"dark":"light";return localStorage.setItem("theme",re),re}),[,a]=w.useState(!1),l=w.useRef(null),[o,f]=w.useState(""),[u,d]=w.useState([]),[h,g]=w.useState(null),[b,v]=w.useState(!1),N=w.useRef(null),[k,T]=w.useState(!1),[E,I]=w.useState(!1),[P,V]=w.useState([]),[F,$]=w.useState(null),[B,z]=w.useState(null),[q,O]=w.useState(0),[R,G]=w.useState([]),[ee,te]=w.useState("manual"),le=["name","description","price","quantity_in_stock","unit","supplier","expiry_date","buying_price","box_number","gst","margin","discount","brand_name","batch","hsn_code","mfg","loose"],K=w.useCallback((we,re="manual")=>{const _e=we||(h?h.name:"");te(re),G(qe=>[...qe,{id:Date.now().toString()+Math.random().toString(36).substring(2,9),name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",supplier:_e,expiry_date:"",buying_price:0,box_number:"",gst:5,margin:0,discount:0,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:0,last_updated:"",created_at:""}])},[h]),U=we=>G(re=>re.filter(_e=>_e.id!==we)),J=(we,re,_e)=>{const{value:qe}=we.target;G(et=>(et.findIndex(Le=>Le.id===re)===et.length-1&&qe.trim()!==""&&setTimeout(()=>K(void 0,"auto"),0),et.map(Le=>{if(Le.id===re){let xe=qe;["price","quantity_in_stock","buying_price","gst","margin","discount","loose"].includes(_e)?(xe=parseFloat(qe),isNaN(xe)&&(xe=null)):_e==="expiry_date"&&(xe=qe.trim()===""?null:qe);const Me={...Le,[_e]:xe};if(h&&(Me.supplier=h.name),["buying_price","price","gst"].includes(_e)){const ve=_e==="buying_price"?xe:Me.buying_price,Ee=_e==="price"?xe:Me.price,De=_e==="gst"?xe:Me.gst;if(Ee&&Ee>0&&ve!==void 0&&ve!==null){const nt=ve*(1+(De||0)/100);Me.margin=parseFloat(((Ee-nt)/Ee*100).toFixed(2))}}return Me}return Le})))},ne=w.useCallback(()=>R.reduce((we,re)=>{const _e=re.quantity_in_stock||0,qe=re.buying_price||0,et=re.gst||0,Je=re.discount||0;let Le=qe*(1-Je/100),xe=_e*Le;return xe+=xe*(et/100),we+xe},0),[R]),A=async()=>{if(!h){z("Select a distributor.");return}const we=R.filter(re=>re.name&&re.name.trim()!==""||re.buying_price&&re.buying_price>0);if(we.length===0){z("No valid items.");return}a(!0),z(null),Ms.addRequest();try{for(const qe of we){const et={...qe,supplier:h.name,expiry_date:qe.expiry_date||null,distributorId:h.id};if(!(await pe("/api/drugs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(et)})).ok)throw new Error(`Failed to add ${qe.name}`)}const re=ne();if(!(await pe(`/api/distributors/${h.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:new Date().toISOString().split("T")[0],order_value:re,amount_paid:q,notes:`Purchase - ${we.length} items`})})).ok)throw new Error("Payment record failed.");G([]),g(null),f(""),O(0),alert("Success!"),e("/dashboard/inventory")}catch(re){z(re.message||"Failed.")}finally{a(!1),Ms.removeRequest()}},ae=async we=>{var qe,et;const re=(qe=we.target.files)==null?void 0:qe[0];if(!re)return;a(!0),Ms.addRequest(),z(null),$(re);const _e=(et=re.name.split(".").pop())==null?void 0:et.toLowerCase();if(["xlsx","xls","csv"].includes(_e||"")){const Je=new FormData;Je.append("inventoryFile",re);try{const Le=await pe("/api/drugs/get-file-headers",{method:"POST",body:Je});if(!Le.ok)throw new Error("Failed headers");const{headers:xe}=await Le.json();V(xe),T(!0)}catch(Le){z(Le.message),$(null)}finally{a(!1),Ms.removeRequest()}}else if(["pdf","png","jpg","jpeg"].includes(_e||"")){const Je=new FormData;Je.append("file",re),Je.append("output_type","csv");const Le="00841ac4-b279-11f0-ab55-0a3a41e3fad1";try{const xe=await fetch("https://extraction-api.nanonets.com/extract",{method:"POST",headers:{Authorization:`Bearer ${Le}`},body:Je});if(!xe.ok)throw new Error("OCR Failed");const Me=await xe.json();if(!Me.success||!Me.content)throw new Error("No data from OCR");let ve=Me.content.split(`
`).filter(Xe=>!Xe.startsWith("#")&&Xe.trim()).join(`
`);const Ee=new File([ve],"ocr.csv",{type:"text/csv"}),De=new FormData;De.append("inventoryFile",Ee);const nt=await pe("/api/drugs/get-file-headers",{method:"POST",body:De});if(!nt.ok)throw new Error("Failed parsing OCR CSV");const{headers:lt}=await nt.json();V(lt),$(Ee),T(!0)}catch(xe){z(xe.message),$(null)}finally{a(!1),Ms.removeRequest()}}else z("Unsupported file"),a(!1),Ms.removeRequest()},ce=async we=>{if(!F)return;a(!0),Ms.addRequest();const re=new FormData;re.append("inventoryFile",F),re.append("columnMapping",JSON.stringify(we));try{const _e=await pe("/api/drugs/parse-excel",{method:"POST",body:re});if(!_e.ok)throw new Error("Parse Failed");const et=(await _e.json()).map(Je=>({...Je,id:Date.now().toString()+Math.random(),supplier:(h==null?void 0:h.name)||Je.supplier,expiry_date:Kee(Je.expiry_date)}));G(Je=>[...Je,...et])}catch(_e){z(_e.message)}finally{a(!1),Ms.removeRequest(),T(!1),l.current&&(l.current.value="")}},M=w.useCallback(async we=>{const re=we.trim()===""?"/api/distributors":`/api/distributors?search=${encodeURIComponent(we)}`;try{const _e=await pe(re);if(_e.ok){const qe=await _e.json();d(we.trim()===""?qe.slice(0,4):qe)}}catch(_e){console.error(_e)}},[]),de=we=>{const re=we.target.value;f(re),N.current&&clearTimeout(N.current),N.current=setTimeout(()=>{M(re),v(!0)},300)},Se=()=>{o.trim()===""&&M(""),v(!0)},fe=we=>{g(we),f(""),v(!1),d([]),G(re=>re.map(_e=>({..._e,supplier:we.name}))),R.length===0&&K(we.name,"manual")};return i.jsxs("div",{className:"purchase-page",children:[i.jsxs("div",{className:"purchase-header",children:[i.jsxs("div",{className:"header-left",children:[i.jsx("button",{onClick:()=>e(-1),className:"icon-btn",children:i.jsx(Lt,{size:20})}),i.jsx("h2",{className:"purchase-page-title",children:"New Purchase"})]}),i.jsx("button",{onClick:r,className:"icon-btn",title:"Toggle Theme",children:n==="light"?i.jsx(yI,{size:20}):i.jsx(QI,{size:20})})]}),B&&i.jsxs("div",{className:"error-banner",style:{background:"var(--danger-bg)",color:"var(--danger)",padding:"12px",borderRadius:"8px",marginBottom:"20px",display:"flex",gap:"10px"},children:[i.jsx(ti,{size:20}),i.jsx("span",{children:B})]}),i.jsxs("div",{className:"purchase-controls-grid",children:[i.jsxs("div",{className:"control-card",children:[i.jsxs("div",{className:"card-header",children:[i.jsxs("h3",{children:[i.jsx(tM,{size:20,className:"card-icon"})," Distributor"]}),i.jsxs("button",{onClick:()=>e("/dashboard/distributors"),className:"icon-btn",style:{width:"auto",borderRadius:"6px",fontSize:"0.8rem",padding:"6px 12px"},children:[i.jsx(kh,{size:16})," Manage"]})]}),h?i.jsxs("div",{className:"selected-distributor-card",children:[i.jsxs("div",{children:[i.jsx("strong",{children:h.name}),i.jsx("br",{}),i.jsx("span",{style:{opacity:.8},children:h.contact_person})]}),i.jsx("button",{onClick:()=>g(null),style:{background:"none",border:"none",color:"var(--primary)",fontWeight:"bold",cursor:"pointer"},children:"Change"})]}):i.jsxs("div",{className:"distributor-search-wrapper",children:[i.jsxs("div",{className:"search-input-group",children:[i.jsx(Si,{size:18,className:"search-input-icon"}),i.jsx("input",{className:"distributor-input",placeholder:"Search...",value:o,onChange:de,onFocus:Se})]}),b&&u.length>0&&i.jsx("ul",{className:"search-dropdown",children:u.map(we=>i.jsx("li",{onClick:()=>fe(we),children:we.name},we.id))})]})]}),i.jsxs("div",{className:"control-card",children:[i.jsx("div",{className:"card-header",children:i.jsxs("h3",{children:[i.jsx(iM,{size:20,className:"card-icon"})," Import & Actions"]})}),i.jsxs("div",{className:"action-buttons-row",children:[i.jsx("input",{ref:l,type:"file",hidden:!0,accept:".xlsx,.xls,.csv,.pdf,.png,.jpg",onChange:ae}),i.jsxs("button",{onClick:()=>{var we;return(we=l.current)==null?void 0:we.click()},disabled:!h,className:"btn-base btn-primary",children:[i.jsx(rs,{size:18})," Import File"]}),i.jsxs("button",{onClick:()=>I(!0),disabled:!h,className:"btn-base btn-manual",children:[i.jsx(Ao,{size:18})," Manual"]})]}),i.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-tertiary)",marginTop:"8px",textAlign:"center"},children:"Supports Excel, CSV, PDF, Images"})]})]}),i.jsx(Qee,{isOpen:k,onClose:()=>T(!1),excelHeaders:P,onConfirm:ce,availableFields:le}),E&&i.jsx(Jee,{isOpen:E,onClose:()=>I(!1),onDrugAddedToPurchase:we=>{G(re=>[...re,{...we,id:Date.now().toString(),supplier:(h==null?void 0:h.name)||""}]),I(!1)}}),i.jsxs("div",{className:"table-container",children:[i.jsx("div",{className:"table-header-title",children:i.jsxs("h3",{children:["Items (",R.length,")"]})}),i.jsx("div",{className:"table-scroll-wrapper",children:i.jsx(Xee,{purchaseRows:R,onCellChange:J,onRemoveDrug:U,onAddEmptyRow:()=>K(void 0,"manual"),lastAddMethod:ee})}),R.length===0&&i.jsx("div",{style:{padding:"40px",textAlign:"center",color:"var(--text-tertiary)"},children:"Select distributor to start."})]}),i.jsxs("div",{className:"purchase-footer",children:[i.jsxs("button",{onClick:()=>K(void 0,"manual"),className:"btn-base btn-secondary",style:{width:"auto",flex:0},children:[i.jsx(Ao,{size:16})," Add Row"]}),i.jsxs("div",{className:"footer-right",children:[i.jsxs("div",{className:"financial-input-group",children:[i.jsx("label",{children:"Paid:"}),i.jsx("input",{type:"number",value:q,onChange:we=>O(parseFloat(we.target.value)||0),className:"amount-paid-input"})]}),i.jsxs("div",{className:"total-display",children:[i.jsx("span",{children:"Total"}),i.jsxs("span",{className:"total-value",children:["",ne().toFixed(2)]})]}),i.jsxs("button",{onClick:A,className:"floating-action-btn success",disabled:R.length===0,children:[i.jsx(vb,{size:20,className:"btn-icon"}),"Submit Purchase"]})]})]})]})},Zee=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)/);return n&&n[1]?parseInt(n[1],10):1},ete=()=>{const e=gt(),n=rr(),[t,r]=w.useState(null),[a,l]=w.useState([]),[o,f]=w.useState(!0),[u,d]=w.useState(null),[h,g]=w.useState(!1),[b,v]=w.useState("cash"),[N,k]=w.useState(""),[T,E]=w.useState(""),[I,P]=w.useState(""),[V,F]=w.useState(""),[$,B]=w.useState(""),[z,q]=w.useState(0),O=w.useRef(!1),R=ne=>{const A=Math.max(0,Math.min(100,isNaN(ne)?0:ne));O.current=!0,q(A);const ae=a.map(ce=>({...ce,discount_percentage:A}));l(ae)},G=(ne,A)=>{const ae=[...a];ae[ne].discount_percentage=isNaN(A)?0:A,l(ae)};w.useEffect(()=>{if(O.current){O.current=!1;return}const ne=a.reduce((ce,M)=>ce+(M.total_price??0),0);if(ne===0){q(0);return}const ae=a.reduce((ce,M)=>{const Se=(M.total_price??0)*((M.discount_percentage??0)/100);return ce+Se},0)/ne*100;q(ce=>Math.abs(ce-ae)>.01?ae:ce)},[a]);const ee=async()=>{if(!t)return d("No order data available to bill."),null;if(a.length===0)return d("Cannot bill an empty order."),null;g(!0),d(null);try{const ne=a.map(de=>{const Se=(de.pricePerLooseUnit??0)*(de.looseQuantity??0),fe=Se*((de.discount_percentage??0)/100),we=Se-fe;return{name:de.name,pack_quantity:de.loosePacks??0,loose_quantity:de.looseUnits??0,price:de.originalPrice??0,pack_price:de.originalPrice??0,loose_price:de.pricePerLooseUnit??0,total:we,drug_id:de.drug_id,discount_percentage:de.discount_percentage??0,batch:de.batch,expiry_date:de.expiry_date}}),A={patientId:t.patientId,queueId:t.id,items:ne,amount:J,paymentMode:b,type:"pharmacy",related_id:t.id,status:"paid",discountPercentage:z},ae=await pe("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)}),ce=await ae.json();if(!ae.ok||!ce.id)throw new Error(ce.message||"Failed to create bill.");const M=await pe(`/api/pharmacy-orders/${t.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"billed",bill_id:ce.id,medications:a})});if(!M.ok){const de=await M.text();throw new Error(`Failed to update pharmacy order status: ${M.statusText} - ${de}`)}return r(de=>de?{...de,status:"billed",bill_id:ce.id}:null),alert(`Order ${t.patientName}'s bill created (ID: ${ce.id}) and marked as billed.`),e(`/dashboard/pharmacy-billing/${t.id}`,{replace:!0,state:{order:{...t,status:"billed",bill_id:ce.id},initialItems:a}}),ce.id}catch(ne){return console.error("Billing process failed:",ne),d(ne.message||"Failed to mark order as billed. Please try again."),null}finally{g(!1)}},te=()=>{window.print()},le=async()=>{await ee()&&(window.print(),e(-1))};w.useEffect(()=>{const ne=n.pathname.split("/"),A=ne[ne.length-1];A?(async()=>{try{const ce=await pe(`/api/pharmacy-orders/${A}`);if(!ce.ok)throw new Error("Failed to fetch pharmacy order details");const M=await ce.json();r(M);const de=M.medications.map(Se=>{const fe=Zee(Se.unit),we=(Se.pack_quantity??0)*fe+(Se.loose_quantity??0);return{...Se,isLoose:!0,loosePacks:Se.pack_quantity??0,looseUnits:Se.loose_quantity??0,looseQuantity:we,pack_price:Number(Se.pack_price)||0,loose_price:Number(Se.loose_price)||0,total_price:Number(Se.total_price)||0,pricePerLooseUnit:Number(Se.loose_price)||0,originalPrice:Number(Se.pack_price)||0,discount_percentage:Number(Se.discount_percentage)??0,directions_to_use:Se.directions_to_use,tabletsPerDay:Se.tabletsPerDay,numberOfDays:Se.numberOfDays,batch:Se.batch,expiry_date:Se.expiry_date}});l(de)}catch(ce){console.error("Failed to fetch order:",ce),d(ce.message||"Failed to load order details.")}finally{f(!1)}})():(d("No pharmacy order ID provided."),f(!1))},[n.pathname]),w.useEffect(()=>{(async()=>{try{const A=await pe("/api/clinics/settings");if(!A.ok)throw new Error("Failed to fetch clinic settings");const ae=await A.json();E(ae.upi_id||""),P(ae.name||""),F(ae.address||""),B(ae.notes||"")}catch(A){console.error("Error fetching clinic settings:",A)}})()},[]);const K=w.useMemo(()=>a.reduce((ne,A)=>ne+(A.total_price??0),0),[a]),U=w.useMemo(()=>a.reduce((ne,A)=>{const ce=(A.total_price??0)*(A.discount_percentage??0)/100;return ne+ce},0),[a]),J=w.useMemo(()=>K-U,[K,U]);return w.useEffect(()=>{if(J>0&&T){const ne=`upi://pay?pa=${T}&pn=ClinicName&am=${J.toFixed(2)}&cu=INR`;k(ne)}else k("")},[J,T]),o?i.jsx("div",{className:"loading-pulse",children:"Loading Bill..."}):u?i.jsxs("div",{className:"error-message-box",children:["Error: ",u]}):t?i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"TAX INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:I?`${I} Pharmacy`:"Pharmacy Bill"}),(V||$)&&i.jsxs("div",{className:"clinic-details-print",children:[V&&i.jsx("span",{className:"small-text clinic-address",children:V}),$&&i.jsx("span",{className:"small-text clinic-notes",children:$})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Fs,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ed,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ym,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(Lt,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Pharmacy Bill"})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Fs,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ed,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item no-print",children:[i.jsxs("strong",{children:[i.jsx(To,{size:16})," Order ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ym,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Medications"})}),a.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"BATCH"}),i.jsx("th",{children:"EXPIRY"}),i.jsx("th",{children:"QUANTITY"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:a.map((ne,A)=>{var Se,fe;const ae=ne.total_price??0,ce=ae*(ne.discount_percentage??0)/100,M=ae-ce;return i.jsxs("tr",{children:[i.jsx("td",{children:A+1}),i.jsx("td",{children:ne.name}),i.jsx("td",{children:ne.batch||"N/A"}),i.jsx("td",{children:ne.expiry_date?new Date(ne.expiry_date).toLocaleDateString():"N/A"}),i.jsxs("td",{children:[i.jsxs("div",{children:["Packs: ",ne.loosePacks??0]}),i.jsxs("div",{children:["Loose: ",ne.looseUnits??0]})]}),i.jsx("td",{children:((Se=ne.originalPrice)==null?void 0:Se.toFixed(2))??"N/A"}),i.jsx("td",{children:((fe=ne.pricePerLooseUnit)==null?void 0:fe.toFixed(2))??"N/A"}),i.jsxs("td",{children:[i.jsx("input",{type:"number",value:ne.discount_percentage??0,onChange:we=>G(A,parseFloat(we.target.value)),min:"0",max:"100",className:"discount-input-table"}),"%"]}),i.jsxs("td",{children:[5 .toFixed(1),"%"]}),i.jsx("td",{children:M.toFixed(2)})]},A)})})]}):i.jsx("p",{children:"No medications in this order."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[N&&i.jsxs("div",{className:`qr-code-container qr-code-printable-section ${b!=="upi"?"hide-on-screen":""}`,children:[i.jsx(Ih,{value:N,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",K.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsxs("span",{children:["Total Discount (",z.toFixed(2),"%)"]}),i.jsxs("span",{children:["- ",U.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"GST (Included)"}),i.jsxs("span",{children:["",(J*.05).toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",J.toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",K.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",U.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount Percentage"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:z,onChange:ne=>R(parseFloat(ne.target.value)),min:"0",max:"100",className:"discount-input-total",disabled:h||t.status==="billed"}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",J.toFixed(2)]})]}),i.jsx("div",{className:"qr-code-container",children:N?i.jsxs(i.Fragment,{children:[i.jsx(Ih,{value:N,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]}):i.jsx("p",{children:"UPI QR code not available. Please ensure UPI ID is configured."})}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:b,onChange:ne=>v(ne.target.value),className:"payment-mode-select",disabled:h||t.status==="billed",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsxs("div",{className:"bill-actions",children:[t.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:te,className:"secondary-button print-preview-button no-print",disabled:h||a.length===0,children:"Print Preview"}),i.jsx("button",{onClick:le,className:"primary-button",disabled:h||a.length===0,children:h?"Processing...":"Finalise and Bill"})]}),t.status==="billed"&&i.jsx("button",{onClick:()=>e(`/dashboard/bills/${t.bill_id}`),className:"secondary-button",children:"View Bill"})]})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})}):i.jsx("div",{className:"error-message-box",children:"No order data available."})},tte=()=>{var V,F,$,B,z;const{billId:e}=jr(),n=gt(),[t,r]=w.useState(null),[a,l]=w.useState(!0),[o,f]=w.useState(null),[u,d]=w.useState(""),[h,g]=w.useState(""),[b,v]=w.useState(""),[N,k]=w.useState("");w.useEffect(()=>{(async()=>{try{if(!e)throw new Error("Bill ID is missing");const O=await pe(`/api/bills/${e}`);if(!O.ok)throw new Error("Failed to fetch bill details");const R=await O.json();r(R.bill);const G=await pe("/api/clinics/settings");if(G.ok){const ee=await G.json();if(d(ee.name||""),g(ee.address||""),v(ee.notes||""),ee.upi_id&&R.amount>0){const te=`upi://pay?pa=${ee.upi_id}&pn=${encodeURIComponent(ee.name||"Clinic")}&am=${Number(R.amount).toFixed(2)}&cu=INR`;k(te)}}}catch(O){console.error("Error fetching data:",O),f(O.message||"Failed to load bill details.")}finally{l(!1)}})()},[e]);const T=()=>{window.print()};if(a)return i.jsx("div",{className:"loading-pulse",children:"Loading Bill..."});if(o)return i.jsxs("div",{className:"error-message-box",children:["Error: ",o]});if(!t)return i.jsx("div",{className:"error-message-box",children:"No bill found."});const E=(t.items||[]).reduce((q,O)=>{const R=(Number(O.pack_price)||0)*(Number(O.pack_quantity)||0),G=(Number(O.loose_price)||0)*(Number(O.loose_quantity)||0);return q+R+G},0),I=E-Number(t.amount),P=Number(t.amount)*.05;return i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"TAX INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:u?`${u} Pharmacy`:"Pharmacy Bill"}),(h||b)&&i.jsxs("div",{className:"clinic-details-print",children:[h&&i.jsx("span",{className:"small-text clinic-address",children:h}),b&&i.jsx("span",{className:"small-text clinic-notes",children:b})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Fs,{size:16})," Patient Name"]})," ",((V=t.Patient)==null?void 0:V.name)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ed,{size:16})," Token"]})," ",((F=t.Patient)==null?void 0:F.token_no)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ym,{size:16})," Bill Date"]})," ",new Date(t.createdAt).toLocaleDateString()]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ed,{size:16})," Bill No"]})," ",(($=t.id)==null?void 0:$.slice(0,8).toUpperCase())||"N/A"]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:[i.jsx(Lt,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"View Bill"}),i.jsxs("button",{onClick:T,className:"primary-button",style:{marginLeft:"auto",width:"auto",padding:"0.5rem 1rem"},children:[i.jsx(Rs,{size:16,style:{marginRight:"8px"}})," Print"]})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Bill Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Fs,{size:16})," Patient Name"]})," ",((B=t.Patient)==null?void 0:B.name)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ed,{size:16})," Token"]})," ",((z=t.Patient)==null?void 0:z.token_no)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ed,{size:16})," Bill ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ym,{size:16})," Date"]})," ",new Date(t.createdAt).toLocaleString()]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Status"})," ",i.jsx("span",{className:"status-badge status-billed",children:t.status})]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Items"})}),t.items&&t.items.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"BATCH"}),i.jsx("th",{children:"EXPIRY"}),i.jsx("th",{children:"QUANTITY"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:t.items.map((q,O)=>{const R=Number(q.total)||0,G=5;let ee="N/A";if(q.expiry_date)try{ee=new Date(q.expiry_date).toLocaleDateString()}catch{}return i.jsxs("tr",{children:[i.jsx("td",{children:O+1}),i.jsx("td",{children:q.name}),i.jsx("td",{children:q.batch||"N/A"}),i.jsx("td",{children:ee}),i.jsxs("td",{children:[i.jsxs("div",{children:["Packs: ",q.pack_quantity??0]}),i.jsxs("div",{children:["Loose: ",q.loose_quantity??0]})]}),i.jsx("td",{children:Number(q.pack_price||0).toFixed(2)}),i.jsx("td",{children:Number(q.loose_price||0).toFixed(2)}),i.jsxs("td",{children:[Number(q.discount_percentage||0),"%"]}),i.jsxs("td",{children:[G.toFixed(1),"%"]}),i.jsx("td",{children:R.toFixed(2)})]},O)})})]}):i.jsx("p",{children:"No items in this bill."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[N&&i.jsxs("div",{className:"qr-code-container qr-code-printable-section",children:[i.jsx(Ih,{value:N,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",E.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Discount"}),i.jsxs("span",{children:["- ",I.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"GST (Included)"}),i.jsxs("span",{children:["",P.toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",Number(t.amount).toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Payment Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",E.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",I.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",Number(t.amount).toFixed(2)]})]}),i.jsxs("div",{className:"payment-mode-section",style:{marginTop:"1rem",padding:"1rem",background:"#f8f9fa",borderRadius:"8px"},children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Payment Mode:"})," ",(t.payment_mode||"N/A").toUpperCase()]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Payment Status:"})," ",(t.status||"N/A").toUpperCase()]})]}),i.jsx("div",{className:"qr-code-container",children:N&&i.jsxs(i.Fragment,{children:[i.jsx(Ih,{value:N,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]})}),i.jsx("div",{className:"bill-actions",children:i.jsxs("button",{onClick:T,className:"primary-button",style:{width:"100%"},children:[i.jsx(Rs,{size:16,style:{marginRight:"8px"}})," Print Bill"]})})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})})};function Po(e){return Array.isArray?Array.isArray(e):AT(e)==="[object Array]"}function nte(e){if(typeof e=="string")return e;let n=e+"";return n=="0"&&1/e==-1/0?"-0":n}function ite(e){return e==null?"":nte(e)}function Ml(e){return typeof e=="string"}function ET(e){return typeof e=="number"}function rte(e){return e===!0||e===!1||ate(e)&&AT(e)=="[object Boolean]"}function TT(e){return typeof e=="object"}function ate(e){return TT(e)&&e!==null}function Da(e){return e!=null}function Lv(e){return!e.trim().length}function AT(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const ste="Incorrect 'index' type",lte=e=>`Invalid value for key ${e}`,ote=e=>`Pattern length exceeds max of ${e}.`,cte=e=>`Missing ${e} property in key`,ute=e=>`Property 'weight' in key '${e}' must be a positive integer`,e_=Object.prototype.hasOwnProperty;class dte{constructor(n){this._keys=[],this._keyMap={};let t=0;n.forEach(r=>{let a=DT(r);this._keys.push(a),this._keyMap[a.id]=a,t+=a.weight}),this._keys.forEach(r=>{r.weight/=t})}get(n){return this._keyMap[n]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function DT(e){let n=null,t=null,r=null,a=1,l=null;if(Ml(e)||Po(e))r=e,n=t_(e),t=R1(e);else{if(!e_.call(e,"name"))throw new Error(cte("name"));const o=e.name;if(r=o,e_.call(e,"weight")&&(a=e.weight,a<=0))throw new Error(ute(o));n=t_(o),t=R1(o),l=e.getFn}return{path:n,id:t,weight:a,src:r,getFn:l}}function t_(e){return Po(e)?e:e.split(".")}function R1(e){return Po(e)?e.join("."):e}function fte(e,n){let t=[],r=!1;const a=(l,o,f)=>{if(Da(l))if(!o[f])t.push(l);else{let u=o[f];const d=l[u];if(!Da(d))return;if(f===o.length-1&&(Ml(d)||ET(d)||rte(d)))t.push(ite(d));else if(Po(d)){r=!0;for(let h=0,g=d.length;h<g;h+=1)a(d[h],o,f+1)}else o.length&&a(d,o,f+1)}};return a(e,Ml(n)?n.split("."):n,0),r?t:t[0]}const hte={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},pte={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,n)=>e.score===n.score?e.idx<n.idx?-1:1:e.score<n.score?-1:1},mte={location:0,threshold:.6,distance:100},gte={useExtendedSearch:!1,getFn:fte,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var Dt={...pte,...hte,...mte,...gte};const yte=/[^ ]+/g;function xte(e=1,n=3){const t=new Map,r=Math.pow(10,n);return{get(a){const l=a.match(yte).length;if(t.has(l))return t.get(l);const o=1/Math.pow(l,.5*e),f=parseFloat(Math.round(o*r)/r);return t.set(l,f),f},clear(){t.clear()}}}class Gw{constructor({getFn:n=Dt.getFn,fieldNormWeight:t=Dt.fieldNormWeight}={}){this.norm=xte(t,3),this.getFn=n,this.isCreated=!1,this.setIndexRecords()}setSources(n=[]){this.docs=n}setIndexRecords(n=[]){this.records=n}setKeys(n=[]){this.keys=n,this._keysMap={},n.forEach((t,r)=>{this._keysMap[t.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,Ml(this.docs[0])?this.docs.forEach((n,t)=>{this._addString(n,t)}):this.docs.forEach((n,t)=>{this._addObject(n,t)}),this.norm.clear())}add(n){const t=this.size();Ml(n)?this._addString(n,t):this._addObject(n,t)}removeAt(n){this.records.splice(n,1);for(let t=n,r=this.size();t<r;t+=1)this.records[t].i-=1}getValueForItemAtKeyId(n,t){return n[this._keysMap[t]]}size(){return this.records.length}_addString(n,t){if(!Da(n)||Lv(n))return;let r={v:n,i:t,n:this.norm.get(n)};this.records.push(r)}_addObject(n,t){let r={i:t,$:{}};this.keys.forEach((a,l)=>{let o=a.getFn?a.getFn(n):this.getFn(n,a.path);if(Da(o)){if(Po(o)){let f=[];const u=[{nestedArrIndex:-1,value:o}];for(;u.length;){const{nestedArrIndex:d,value:h}=u.pop();if(Da(h))if(Ml(h)&&!Lv(h)){let g={v:h,i:d,n:this.norm.get(h)};f.push(g)}else Po(h)&&h.forEach((g,b)=>{u.push({nestedArrIndex:b,value:g})})}r.$[l]=f}else if(Ml(o)&&!Lv(o)){let f={v:o,n:this.norm.get(o)};r.$[l]=f}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}}function PT(e,n,{getFn:t=Dt.getFn,fieldNormWeight:r=Dt.fieldNormWeight}={}){const a=new Gw({getFn:t,fieldNormWeight:r});return a.setKeys(e.map(DT)),a.setSources(n),a.create(),a}function bte(e,{getFn:n=Dt.getFn,fieldNormWeight:t=Dt.fieldNormWeight}={}){const{keys:r,records:a}=e,l=new Gw({getFn:n,fieldNormWeight:t});return l.setKeys(r),l.setIndexRecords(a),l}function Dx(e,{errors:n=0,currentLocation:t=0,expectedLocation:r=0,distance:a=Dt.distance,ignoreLocation:l=Dt.ignoreLocation}={}){const o=n/e.length;if(l)return o;const f=Math.abs(r-t);return a?o+f/a:f?1:o}function vte(e=[],n=Dt.minMatchCharLength){let t=[],r=-1,a=-1,l=0;for(let o=e.length;l<o;l+=1){let f=e[l];f&&r===-1?r=l:!f&&r!==-1&&(a=l-1,a-r+1>=n&&t.push([r,a]),r=-1)}return e[l-1]&&l-r>=n&&t.push([r,l-1]),t}const kd=32;function wte(e,n,t,{location:r=Dt.location,distance:a=Dt.distance,threshold:l=Dt.threshold,findAllMatches:o=Dt.findAllMatches,minMatchCharLength:f=Dt.minMatchCharLength,includeMatches:u=Dt.includeMatches,ignoreLocation:d=Dt.ignoreLocation}={}){if(n.length>kd)throw new Error(ote(kd));const h=n.length,g=e.length,b=Math.max(0,Math.min(r,g));let v=l,N=b;const k=f>1||u,T=k?Array(g):[];let E;for(;(E=e.indexOf(n,N))>-1;){let B=Dx(n,{currentLocation:E,expectedLocation:b,distance:a,ignoreLocation:d});if(v=Math.min(B,v),N=E+h,k){let z=0;for(;z<h;)T[E+z]=1,z+=1}}N=-1;let I=[],P=1,V=h+g;const F=1<<h-1;for(let B=0;B<h;B+=1){let z=0,q=V;for(;z<q;)Dx(n,{errors:B,currentLocation:b+q,expectedLocation:b,distance:a,ignoreLocation:d})<=v?z=q:V=q,q=Math.floor((V-z)/2+z);V=q;let O=Math.max(1,b-q+1),R=o?g:Math.min(b+q,g)+h,G=Array(R+2);G[R+1]=(1<<B)-1;for(let te=R;te>=O;te-=1){let le=te-1,K=t[e.charAt(le)];if(k&&(T[le]=+!!K),G[te]=(G[te+1]<<1|1)&K,B&&(G[te]|=(I[te+1]|I[te])<<1|1|I[te+1]),G[te]&F&&(P=Dx(n,{errors:B,currentLocation:le,expectedLocation:b,distance:a,ignoreLocation:d}),P<=v)){if(v=P,N=le,N<=b)break;O=Math.max(1,2*b-N)}}if(Dx(n,{errors:B+1,currentLocation:b,expectedLocation:b,distance:a,ignoreLocation:d})>v)break;I=G}const $={isMatch:N>=0,score:Math.max(.001,P)};if(k){const B=vte(T,f);B.length?u&&($.indices=B):$.isMatch=!1}return $}function Ste(e){let n={};for(let t=0,r=e.length;t<r;t+=1){const a=e.charAt(t);n[a]=(n[a]||0)|1<<r-t-1}return n}const gb=String.prototype.normalize?e=>e.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):e=>e;class IT{constructor(n,{location:t=Dt.location,threshold:r=Dt.threshold,distance:a=Dt.distance,includeMatches:l=Dt.includeMatches,findAllMatches:o=Dt.findAllMatches,minMatchCharLength:f=Dt.minMatchCharLength,isCaseSensitive:u=Dt.isCaseSensitive,ignoreDiacritics:d=Dt.ignoreDiacritics,ignoreLocation:h=Dt.ignoreLocation}={}){if(this.options={location:t,threshold:r,distance:a,includeMatches:l,findAllMatches:o,minMatchCharLength:f,isCaseSensitive:u,ignoreDiacritics:d,ignoreLocation:h},n=u?n:n.toLowerCase(),n=d?gb(n):n,this.pattern=n,this.chunks=[],!this.pattern.length)return;const g=(v,N)=>{this.chunks.push({pattern:v,alphabet:Ste(v),startIndex:N})},b=this.pattern.length;if(b>kd){let v=0;const N=b%kd,k=b-N;for(;v<k;)g(this.pattern.substr(v,kd),v),v+=kd;if(N){const T=b-kd;g(this.pattern.substr(T),T)}}else g(this.pattern,0)}searchIn(n){const{isCaseSensitive:t,ignoreDiacritics:r,includeMatches:a}=this.options;if(n=t?n:n.toLowerCase(),n=r?gb(n):n,this.pattern===n){let k={isMatch:!0,score:0};return a&&(k.indices=[[0,n.length-1]]),k}const{location:l,distance:o,threshold:f,findAllMatches:u,minMatchCharLength:d,ignoreLocation:h}=this.options;let g=[],b=0,v=!1;this.chunks.forEach(({pattern:k,alphabet:T,startIndex:E})=>{const{isMatch:I,score:P,indices:V}=wte(n,k,T,{location:l+E,distance:o,threshold:f,findAllMatches:u,minMatchCharLength:d,includeMatches:a,ignoreLocation:h});I&&(v=!0),b+=P,I&&V&&(g=[...g,...V])});let N={isMatch:v,score:v?b/this.chunks.length:1};return v&&a&&(N.indices=g),N}}class Xc{constructor(n){this.pattern=n}static isMultiMatch(n){return n_(n,this.multiRegex)}static isSingleMatch(n){return n_(n,this.singleRegex)}search(){}}function n_(e,n){const t=e.match(n);return t?t[1]:null}class Nte extends Xc{constructor(n){super(n)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(n){const t=n===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class Cte extends Xc{constructor(n){super(n)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(n){const r=n.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,n.length-1]}}}class jte extends Xc{constructor(n){super(n)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(n){const t=n.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class _te extends Xc{constructor(n){super(n)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(n){const t=!n.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,n.length-1]}}}class kte extends Xc{constructor(n){super(n)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(n){const t=n.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[n.length-this.pattern.length,n.length-1]}}}class Ete extends Xc{constructor(n){super(n)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(n){const t=!n.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,n.length-1]}}}class MT extends Xc{constructor(n,{location:t=Dt.location,threshold:r=Dt.threshold,distance:a=Dt.distance,includeMatches:l=Dt.includeMatches,findAllMatches:o=Dt.findAllMatches,minMatchCharLength:f=Dt.minMatchCharLength,isCaseSensitive:u=Dt.isCaseSensitive,ignoreDiacritics:d=Dt.ignoreDiacritics,ignoreLocation:h=Dt.ignoreLocation}={}){super(n),this._bitapSearch=new IT(n,{location:t,threshold:r,distance:a,includeMatches:l,findAllMatches:o,minMatchCharLength:f,isCaseSensitive:u,ignoreDiacritics:d,ignoreLocation:h})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(n){return this._bitapSearch.searchIn(n)}}class RT extends Xc{constructor(n){super(n)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(n){let t=0,r;const a=[],l=this.pattern.length;for(;(r=n.indexOf(this.pattern,t))>-1;)t=r+l,a.push([r,t-1]);const o=!!a.length;return{isMatch:o,score:o?0:1,indices:a}}}const L1=[Nte,RT,jte,_te,Ete,kte,Cte,MT],i_=L1.length,Tte=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,Ate="|";function Dte(e,n={}){return e.split(Ate).map(t=>{let r=t.trim().split(Tte).filter(l=>l&&!!l.trim()),a=[];for(let l=0,o=r.length;l<o;l+=1){const f=r[l];let u=!1,d=-1;for(;!u&&++d<i_;){const h=L1[d];let g=h.isMultiMatch(f);g&&(a.push(new h(g,n)),u=!0)}if(!u)for(d=-1;++d<i_;){const h=L1[d];let g=h.isSingleMatch(f);if(g){a.push(new h(g,n));break}}}return a})}const Pte=new Set([MT.type,RT.type]);class Ite{constructor(n,{isCaseSensitive:t=Dt.isCaseSensitive,ignoreDiacritics:r=Dt.ignoreDiacritics,includeMatches:a=Dt.includeMatches,minMatchCharLength:l=Dt.minMatchCharLength,ignoreLocation:o=Dt.ignoreLocation,findAllMatches:f=Dt.findAllMatches,location:u=Dt.location,threshold:d=Dt.threshold,distance:h=Dt.distance}={}){this.query=null,this.options={isCaseSensitive:t,ignoreDiacritics:r,includeMatches:a,minMatchCharLength:l,findAllMatches:f,ignoreLocation:o,location:u,threshold:d,distance:h},n=t?n:n.toLowerCase(),n=r?gb(n):n,this.pattern=n,this.query=Dte(this.pattern,this.options)}static condition(n,t){return t.useExtendedSearch}searchIn(n){const t=this.query;if(!t)return{isMatch:!1,score:1};const{includeMatches:r,isCaseSensitive:a,ignoreDiacritics:l}=this.options;n=a?n:n.toLowerCase(),n=l?gb(n):n;let o=0,f=[],u=0;for(let d=0,h=t.length;d<h;d+=1){const g=t[d];f.length=0,o=0;for(let b=0,v=g.length;b<v;b+=1){const N=g[b],{isMatch:k,indices:T,score:E}=N.search(n);if(k){if(o+=1,u+=E,r){const I=N.constructor.type;Pte.has(I)?f=[...f,...T]:f.push(T)}}else{u=0,o=0,f.length=0;break}}if(o){let b={isMatch:!0,score:u/o};return r&&(b.indices=f),b}}return{isMatch:!1,score:1}}}const O1=[];function Mte(...e){O1.push(...e)}function F1(e,n){for(let t=0,r=O1.length;t<r;t+=1){let a=O1[t];if(a.condition(e,n))return new a(e,n)}return new IT(e,n)}const yb={AND:"$and",OR:"$or"},$1={PATH:"$path",PATTERN:"$val"},z1=e=>!!(e[yb.AND]||e[yb.OR]),Rte=e=>!!e[$1.PATH],Lte=e=>!Po(e)&&TT(e)&&!z1(e),r_=e=>({[yb.AND]:Object.keys(e).map(n=>({[n]:e[n]}))});function LT(e,n,{auto:t=!0}={}){const r=a=>{let l=Object.keys(a);const o=Rte(a);if(!o&&l.length>1&&!z1(a))return r(r_(a));if(Lte(a)){const u=o?a[$1.PATH]:l[0],d=o?a[$1.PATTERN]:a[u];if(!Ml(d))throw new Error(lte(u));const h={keyId:R1(u),pattern:d};return t&&(h.searcher=F1(d,n)),h}let f={children:[],operator:l[0]};return l.forEach(u=>{const d=a[u];Po(d)&&d.forEach(h=>{f.children.push(r(h))})}),f};return z1(e)||(e=r_(e)),r(e)}function Ote(e,{ignoreFieldNorm:n=Dt.ignoreFieldNorm}){e.forEach(t=>{let r=1;t.matches.forEach(({key:a,norm:l,score:o})=>{const f=a?a.weight:null;r*=Math.pow(o===0&&f?Number.EPSILON:o,(f||1)*(n?1:l))}),t.score=r})}function Fte(e,n){const t=e.matches;n.matches=[],Da(t)&&t.forEach(r=>{if(!Da(r.indices)||!r.indices.length)return;const{indices:a,value:l}=r;let o={indices:a,value:l};r.key&&(o.key=r.key.src),r.idx>-1&&(o.refIndex=r.idx),n.matches.push(o)})}function $te(e,n){n.score=e.score}function zte(e,n,{includeMatches:t=Dt.includeMatches,includeScore:r=Dt.includeScore}={}){const a=[];return t&&a.push(Fte),r&&a.push($te),e.map(l=>{const{idx:o}=l,f={item:n[o],refIndex:o};return a.length&&a.forEach(u=>{u(l,f)}),f})}class qh{constructor(n,t={},r){this.options={...Dt,...t},this.options.useExtendedSearch,this._keyStore=new dte(this.options.keys),this.setCollection(n,r)}setCollection(n,t){if(this._docs=n,t&&!(t instanceof Gw))throw new Error(ste);this._myIndex=t||PT(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(n){Da(n)&&(this._docs.push(n),this._myIndex.add(n))}remove(n=()=>!1){const t=[];for(let r=0,a=this._docs.length;r<a;r+=1){const l=this._docs[r];n(l,r)&&(this.removeAt(r),r-=1,a-=1,t.push(l))}return t}removeAt(n){this._docs.splice(n,1),this._myIndex.removeAt(n)}getIndex(){return this._myIndex}search(n,{limit:t=-1}={}){const{includeMatches:r,includeScore:a,shouldSort:l,sortFn:o,ignoreFieldNorm:f}=this.options;let u=Ml(n)?Ml(this._docs[0])?this._searchStringList(n):this._searchObjectList(n):this._searchLogical(n);return Ote(u,{ignoreFieldNorm:f}),l&&u.sort(o),ET(t)&&t>-1&&(u=u.slice(0,t)),zte(u,this._docs,{includeMatches:r,includeScore:a})}_searchStringList(n){const t=F1(n,this.options),{records:r}=this._myIndex,a=[];return r.forEach(({v:l,i:o,n:f})=>{if(!Da(l))return;const{isMatch:u,score:d,indices:h}=t.searchIn(l);u&&a.push({item:l,idx:o,matches:[{score:d,value:l,norm:f,indices:h}]})}),a}_searchLogical(n){const t=LT(n,this.options),r=(f,u,d)=>{if(!f.children){const{keyId:g,searcher:b}=f,v=this._findMatches({key:this._keyStore.get(g),value:this._myIndex.getValueForItemAtKeyId(u,g),searcher:b});return v&&v.length?[{idx:d,item:u,matches:v}]:[]}const h=[];for(let g=0,b=f.children.length;g<b;g+=1){const v=f.children[g],N=r(v,u,d);if(N.length)h.push(...N);else if(f.operator===yb.AND)return[]}return h},a=this._myIndex.records,l={},o=[];return a.forEach(({$:f,i:u})=>{if(Da(f)){let d=r(t,f,u);d.length&&(l[u]||(l[u]={idx:u,item:f,matches:[]},o.push(l[u])),d.forEach(({matches:h})=>{l[u].matches.push(...h)}))}}),o}_searchObjectList(n){const t=F1(n,this.options),{keys:r,records:a}=this._myIndex,l=[];return a.forEach(({$:o,i:f})=>{if(!Da(o))return;let u=[];r.forEach((d,h)=>{u.push(...this._findMatches({key:d,value:o[h],searcher:t}))}),u.length&&l.push({idx:f,item:o,matches:u})}),l}_findMatches({key:n,value:t,searcher:r}){if(!Da(t))return[];let a=[];if(Po(t))t.forEach(({v:l,i:o,n:f})=>{if(!Da(l))return;const{isMatch:u,score:d,indices:h}=r.searchIn(l);u&&a.push({score:d,key:n,value:l,idx:o,norm:f,indices:h})});else{const{v:l,n:o}=t,{isMatch:f,score:u,indices:d}=r.searchIn(l);f&&a.push({score:u,key:n,value:l,norm:o,indices:d})}return a}}qh.version="7.1.0";qh.createIndex=PT;qh.parseIndex=bte;qh.config=Dt;qh.parseQuery=LT;Mte(Ite);const Bte=({isOpen:e,onClose:n,recurringItems:t,inventory:r,onCreateOrder:a})=>{const[l,o]=w.useState([]),[f,u]=w.useState(""),[d,h]=w.useState(null),[g,b]=w.useState([]),v=w.useMemo(()=>new qh(r,{keys:["name","composition"],threshold:.4,includeScore:!0}),[r]);w.useEffect(()=>{if(e&&t.length>0&&r.length>0){const E=t.map(I=>{const P=v.search(I.name);let V=null,F="none";if(P.length>0){V=P[0].item;const $=P[0].score||1;$<.1?F="high":$<.4?F="medium":F="low"}return{original:I,matchedDrug:V,confidence:F}});o(E)}},[e,t,r,v]),w.useEffect(()=>{if(f){const E=v.search(f).map(I=>I.item);b(E.slice(0,10))}else b([])},[f,v]);const N=(E,I)=>{o(P=>{const V=[...P];return V[E]={...V[E],matchedDrug:I,confidence:"high"},V}),h(null),u("")},k=()=>{const E=l.filter(I=>I.matchedDrug).map(I=>{const P=Number(I.matchedDrug.price),V=T(I.matchedDrug.unit),F=P/(V||1),$=I.original.pack_quantity||0,B=I.original.loose_quantity||0,z=$*P+B*F;return{drug_id:I.matchedDrug.id,name:I.matchedDrug.name,pack_quantity:$,loose_quantity:B,pack_price:P,loose_price:F,total_price:z,unit:I.matchedDrug.unit}});a(E)},T=E=>{if(!E)return 1;const I=E.match(/(?:\d+x)?(\d+)/);return I?parseInt(I[1],10):1};return e?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-container",children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h2",{className:"modal-title",children:"Review Recurring Order Items"}),i.jsx("button",{onClick:n,className:"modal-close-button",children:i.jsx(Qn,{size:24})})]}),i.jsx("div",{className:"modal-content",children:i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:l.map((E,I)=>i.jsx("div",{className:`modal-item-card ${E.confidence==="high"?"high-confidence":E.confidence==="medium"?"medium-confidence":"low-confidence"}`,children:i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"1rem"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsx("p",{style:{fontSize:"0.875rem",fontWeight:500,color:"#6b7280"},children:"Recurring Item"}),i.jsx("p",{style:{fontSize:"1.125rem",fontWeight:600,color:"#1f2937"},children:E.original.name}),i.jsxs("p",{style:{fontSize:"0.875rem",color:"#4b5563"},children:["Qty: ",E.original.pack_quantity?`${E.original.pack_quantity} packs`:"",E.original.loose_quantity?` ${E.original.loose_quantity} loose`:""]})]}),i.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"0 1rem"},children:E.confidence==="high"?i.jsx(vb,{style:{color:"#22c55e"}}):i.jsx(D_,{style:{color:"#eab308"}})}),i.jsxs("div",{style:{flex:1},children:[i.jsx("p",{style:{fontSize:"0.875rem",fontWeight:500,color:"#6b7280"},children:"Matched Inventory Item"}),d===I?i.jsxs("div",{style:{position:"relative"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",border:"1px solid #d1d5db",borderRadius:"0.375rem",backgroundColor:"#ffffff"},children:[i.jsx(Si,{size:16,style:{marginLeft:"0.5rem",color:"#9ca3af"}}),i.jsx("input",{type:"text",value:f,onChange:P=>u(P.target.value),placeholder:"Search inventory...",style:{width:"100%",padding:"0.5rem",outline:"none",fontSize:"0.875rem",border:"none"},autoFocus:!0}),i.jsx("button",{onClick:()=>h(null),style:{padding:"0.5rem",color:"#9ca3af",background:"transparent",border:"none",cursor:"pointer"},children:i.jsx(Qn,{size:16})})]}),g.length>0&&i.jsx("div",{style:{position:"absolute",zIndex:10,width:"100%",marginTop:"0.25rem",backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"0.375rem",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1)",maxHeight:"12rem",overflowY:"auto"},children:g.map(P=>i.jsxs("div",{onClick:()=>N(I,P),style:{padding:"0.5rem",cursor:"pointer",fontSize:"0.875rem"},onMouseEnter:V=>V.currentTarget.style.backgroundColor="#f3f4f6",onMouseLeave:V=>V.currentTarget.style.backgroundColor="transparent",children:[i.jsx("div",{style:{fontWeight:500},children:P.name}),i.jsxs("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:["Stock: ",P.quantity_in_stock," | ",P.price]})]},P.id))})]}):i.jsx("div",{onClick:()=>{h(I),u("")},style:{cursor:"pointer",padding:"0.5rem",borderRadius:"0.375rem",border:"1px solid transparent",transition:"all 0.2s"},onMouseEnter:P=>{P.currentTarget.style.backgroundColor="#ffffff",P.currentTarget.style.borderColor="#d1d5db"},onMouseLeave:P=>{P.currentTarget.style.backgroundColor="transparent",P.currentTarget.style.borderColor="transparent"},children:E.matchedDrug?i.jsxs("div",{children:[i.jsx("p",{style:{fontWeight:600,color:"#1f2937"},children:E.matchedDrug.name}),i.jsxs("p",{style:{fontSize:"0.75rem",color:"#6b7280"},children:["Stock: ",E.matchedDrug.quantity_in_stock," | ",E.matchedDrug.price]})]}):i.jsx("p",{style:{color:"#ef4444",fontWeight:500},children:"No match found. Click to search."})})]})]})},I))})}),i.jsxs("div",{className:"modal-footer",children:[i.jsx("button",{onClick:n,className:"recurring-medications-button recurring-medications-button-secondary",children:"Cancel"}),i.jsx("button",{onClick:k,disabled:l.some(E=>!E.matchedDrug),className:"recurring-medications-button recurring-medications-button-primary",style:{opacity:l.some(E=>!E.matchedDrug)?.5:1,cursor:l.some(E=>!E.matchedDrug)?"not-allowed":"pointer"},children:"Create Order"})]})]})}):null},Ov=15,Ute=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,l]=w.useState(null),[o,f]=w.useState(!1),[u,d]=w.useState(null),[h,g]=w.useState([]),[b,v]=w.useState(null),[N,k]=w.useState(30),T=gt(),[E,I]=w.useState(""),[P,V]=w.useState(""),[F,$]=w.useState(1),[B,z]=w.useState(1),[q,O]=w.useState(0),[R,G]=w.useState("next_delivery_date"),[ee,te]=w.useState("asc"),[le,K]=w.useState("");w.useEffect(()=>{const re=setTimeout(()=>{V(E),$(1)},500);return()=>{clearTimeout(re)}},[E]);const U=w.useCallback(async(re,_e,qe,et,Je)=>{r(!0),l(null);try{const Le=new URLSearchParams({page:re.toString(),limit:Ov.toString(),sortBy:qe,sortOrder:et});_e&&Le.append("search",_e),Je&&Le.append("status",Je);const xe=await pe(`/api/recurring-medications?${Le.toString()}`);if(!xe.ok){const ve=await xe.json().catch(()=>({}));throw new Error(ve.message||"Failed to fetch recurring medications")}const Me=await xe.json();n(Me.recurringMedications),O(Me.totalCount),$(Me.currentPage),z(Me.totalPages)}catch(Le){l(Le.message),n([]),O(0),$(1),z(1)}finally{r(!1)}},[]),J=async()=>{try{const re=await pe("/api/drugs");if(re.ok){const _e=await re.json();g(_e)}}catch(re){console.error("Failed to fetch inventory:",re)}};w.useEffect(()=>{U(F,P,R,ee,le),J()},[F,P,R,ee,le,U]);const ne=re=>{const _e=R===re&&ee==="asc"?"desc":"asc";G(re),te(_e),$(1)},A=async(re,_e)=>{try{if(!(await pe(`/api/recurring-medications/${re}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:_e})})).ok)throw new Error("Failed to update status");U(F,P,R,ee,le)}catch(qe){alert(`Error updating status: ${qe.message}`)}},ae=(re,_e)=>{v(re),k(_e)},ce=async re=>{if(N<1||N>365){alert("Frequency must be between 1 and 365 days");return}try{const _e=await pe(`/api/recurring-medications/${re}/frequency`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({frequency_days:N})});if(!_e.ok){const qe=await _e.json().catch(()=>({}));throw new Error(qe.message||"Failed to update frequency")}v(null),U(F,P,R,ee,le)}catch(_e){alert(`Error updating frequency: ${_e.message}`)}},M=()=>{v(null)},de=re=>{d(re),f(!0)},Se=async re=>{if(u)try{const _e={patient_id:u.patient_id,items:re,prescription_for_unavailable_drugs:"",status:"pending",date:new Date().toISOString(),order_total:re.reduce((et,Je)=>et+(Je.total_price||Je.pack_quantity*Je.pack_price+Je.loose_quantity*Je.loose_price),0),recurring_medication_id:u.id},qe=await pe("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_e)});if(!qe.ok){const et=await qe.json().catch(()=>({}));throw new Error(et.message||"Failed to create order")}alert("Order created successfully!"),f(!1),d(null),U(F,P,R,ee,le)}catch(_e){alert(`Failed to create order: ${_e.message}`)}},fe=(re,_e)=>{const qe=_e.map(et=>({name:et.name,pack_quantity:et.pack_quantity,loose_quantity:et.loose_quantity,price:et.price,pack_price:et.pack_price,loose_price:et.loose_price,total_price:Number(et.total_price)||0,isLoose:et.isLoose,unit:et.unit,drug_id:et.drug_id?String(et.drug_id):null,tabletsPerDay:et.tabletsPerDay,numberOfDays:et.numberOfDays,directions_to_use:et.directions_to_use,discount_percentage:et.discount_percentage??0,batch:et.batch,expiry_date:et.expiry_date}));T(`/dashboard/pharmacy-billing/${re}`,{state:{initialItems:qe}})},we=async(re,_e)=>{try{const qe=await pe(`/api/pharmacy-orders/${re}`);if(!qe.ok)throw new Error("Failed to fetch order details");const et=await qe.json(),Je={status:_e,medications:et.medications},Le=await pe(`/api/pharmacy-orders/${re}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Je)});if(!Le.ok){const xe=await Le.text();throw new Error(`Failed to update status: ${Le.statusText} (${Le.status}) - ${xe}`)}U(F,P,R,ee,le),alert(`Order marked as ${_e} successfully!`)}catch(qe){console.error("Failed to update order status:",qe),alert(`Error updating status: ${qe.message}`)}};return i.jsxs("div",{className:"recurring-medications-page-container",children:[i.jsxs("div",{className:"recurring-medications-header",children:[i.jsxs("div",{className:"recurring-medications-header-left",children:[i.jsxs("button",{onClick:()=>T(-1),className:"recurring-medications-button recurring-medications-button-back",children:[i.jsx(Lt,{size:20}),"Back"]}),i.jsx("h1",{className:"recurring-medications-page-title",children:"Recurring Medications"})]}),i.jsxs("button",{onClick:()=>U(F,P,R,ee,le),className:"recurring-medications-button recurring-medications-button-primary",children:[i.jsx(Yx,{size:18}),"Refresh"]})]}),i.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",flexDirection:"column",gap:"1rem"},children:[i.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center",flexWrap:"wrap"},children:[i.jsxs("div",{style:{flex:"1 1 300px",position:"relative"},children:[i.jsx("input",{type:"text",placeholder:"Search by name, phone, or token...",value:E,onChange:re=>I(re.target.value),style:{width:"100%",padding:"0.75rem 3rem 0.75rem 1rem",border:"2px solid #e5e7eb",borderRadius:"0.5rem",fontSize:"0.95rem",transition:"all 0.2s ease",outline:"none"},onFocus:re=>re.target.style.borderColor="#6d28d9",onBlur:re=>re.target.style.borderColor="#e5e7eb"}),i.jsx(Si,{size:20,style:{position:"absolute",right:"1rem",top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",border:"2px solid #e5e7eb",borderRadius:"0.5rem",padding:"0.75rem 1rem",backgroundColor:"#ffffff"},children:[i.jsx(k_,{size:18,style:{color:"#6b7280"}}),i.jsxs("select",{id:"statusFilter",value:le,onChange:re=>K(re.target.value),style:{border:"none",outline:"none",fontSize:"0.95rem",backgroundColor:"transparent",cursor:"pointer",fontWeight:500,color:"#374151"},children:[i.jsx("option",{value:"",children:"All Status"}),i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"paused",children:"Paused"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})]}),!t&&q>0&&i.jsxs("div",{style:{fontSize:"0.875rem",color:"#6b7280",fontWeight:500},children:["Found ",i.jsx("span",{style:{color:"#6d28d9",fontWeight:700},children:q})," recurring medication",q!==1?"s":"",(P||le)&&" matching your criteria"]})]}),i.jsxs("div",{className:"recurring-medications-content-box",children:[a&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"1rem 1.25rem",backgroundColor:"#fee2e2",border:"2px solid #fca5a5",borderRadius:"0.75rem",color:"#991b1b",marginBottom:"1.5rem",boxShadow:"0 2px 4px rgba(239, 68, 68, 0.1)"},children:[i.jsx(ti,{size:24,style:{flexShrink:0}}),i.jsxs("div",{children:[i.jsx("p",{style:{fontWeight:600,marginBottom:"0.25rem"},children:"Error Loading Data"}),i.jsx("p",{style:{fontSize:"0.875rem",margin:0},children:a})]})]}),t?i.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"20rem",gap:"1rem"},children:[i.jsx("div",{className:"spinner"}),i.jsx("p",{style:{color:"#6b7280",fontSize:"0.95rem",fontWeight:500},children:"Loading recurring medications..."})]}):e.length===0?i.jsxs("div",{style:{textAlign:"center",padding:"4rem 2rem",background:"linear-gradient(135deg, #f9fafb 0%, #ffffff 100%)",borderRadius:"1rem",border:"2px dashed #d1d5db",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[i.jsx("div",{style:{width:"4rem",height:"4rem",margin:"0 auto 1.5rem",borderRadius:"50%",background:"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx(ti,{size:32,style:{color:"#3b82f6"}})}),i.jsx("p",{style:{color:"#1f2937",fontSize:"1.125rem",fontWeight:600,marginBottom:"0.5rem"},children:P||le?"No matches found":"No recurring medications"}),i.jsx("p",{style:{color:"#6b7280",fontSize:"0.95rem"},children:P||le?"Try adjusting your search or filter criteria":"Recurring medications will appear here once created"})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"recurring-medications-table-container",children:i.jsxs("table",{className:"recurring-medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[i.jsxs("div",{className:"sortable-header",onClick:()=>ne("patient_name"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"0.25rem"},children:[i.jsx("span",{children:"Name"}),R==="patient_name"&&(ee==="asc"?i.jsx(No,{size:12}):i.jsx($c,{size:12}))]}),i.jsxs("div",{style:{display:"flex",gap:"0.5rem",fontSize:"0.75rem",color:"#6b7280"},children:[i.jsxs("div",{className:"sortable-header",onClick:()=>ne("patient_phone"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"0.25rem"},children:[i.jsx("span",{children:"Phone"}),R==="patient_phone"&&(ee==="asc"?i.jsx(No,{size:10}):i.jsx($c,{size:10}))]}),i.jsx("span",{children:"|"}),i.jsxs("div",{className:"sortable-header",onClick:()=>ne("patient_token"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"0.25rem"},children:[i.jsx("span",{children:"Token"}),R==="patient_token"&&(ee==="asc"?i.jsx(No,{size:10}):i.jsx($c,{size:10}))]})]})]})}),i.jsx("th",{children:"Medications"}),i.jsxs("th",{className:"sortable-header",onClick:()=>ne("next_delivery_date"),style:{cursor:"pointer",userSelect:"none"},children:["Next Delivery",R==="next_delivery_date"&&(ee==="asc"?i.jsx(No,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}):i.jsx($c,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}))]}),i.jsxs("th",{className:"sortable-header",onClick:()=>ne("frequency_days"),style:{cursor:"pointer",userSelect:"none"},children:["Frequency",R==="frequency_days"&&(ee==="asc"?i.jsx(No,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}):i.jsx($c,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}))]}),i.jsxs("th",{className:"sortable-header",onClick:()=>ne("status"),style:{cursor:"pointer",userSelect:"none"},children:["Status",R==="status"&&(ee==="asc"?i.jsx(No,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}):i.jsx($c,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}))]}),i.jsx("th",{children:"Last Order"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map(re=>i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{style:{fontWeight:500,color:"#1f2937"},children:re.patient_name}),i.jsx("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:re.patient_phone}),i.jsxs("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:["Token: ",re.patient_token]})]}),i.jsx("td",{children:i.jsx("ul",{style:{listStyleType:"disc",paddingLeft:"1.25rem",fontSize:"0.875rem",color:"#4b5563"},children:re.medications.map((_e,qe)=>i.jsxs("li",{children:[_e.name,_e.pack_quantity?` (${_e.pack_quantity} packs)`:"",_e.loose_quantity?` (${_e.loose_quantity} loose)`:""]},qe))})}),i.jsx("td",{children:i.jsx("div",{style:{fontSize:"0.875rem"},children:new Date(re.next_delivery_date).toLocaleDateString()})}),i.jsx("td",{children:b===re.id?i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.jsx("input",{type:"number",min:"1",max:"365",value:N,onChange:_e=>k(parseInt(_e.target.value,10)||1),style:{width:"4rem",padding:"0.25rem 0.5rem",border:"2px solid #6d28d9",borderRadius:"0.375rem",fontSize:"0.875rem",outline:"none"},autoFocus:!0,onKeyDown:_e=>{_e.key==="Enter"&&ce(re.id),_e.key==="Escape"&&M()}}),i.jsx("span",{style:{fontSize:"0.875rem",color:"#4b5563"},children:"days"}),i.jsx("button",{onClick:()=>ce(re.id),style:{padding:"0.25rem 0.5rem",backgroundColor:"#22c55e",color:"white",border:"none",borderRadius:"0.375rem",cursor:"pointer",fontSize:"0.75rem",fontWeight:600},title:"Save (Enter)",children:""}),i.jsx("button",{onClick:M,style:{padding:"0.25rem 0.5rem",backgroundColor:"#ef4444",color:"white",border:"none",borderRadius:"0.375rem",cursor:"pointer",fontSize:"0.75rem",fontWeight:600},title:"Cancel (Esc)",children:""})]}):i.jsxs("div",{onClick:()=>ae(re.id,re.frequency_days||30),style:{fontSize:"0.875rem",color:"#4b5563",cursor:"pointer",padding:"0.25rem 0.5rem",borderRadius:"0.375rem",transition:"all 0.2s ease",display:"inline-block"},onMouseEnter:_e=>{_e.currentTarget.style.backgroundColor="#f3f4f6",_e.currentTarget.style.color="#6d28d9"},onMouseLeave:_e=>{_e.currentTarget.style.backgroundColor="transparent",_e.currentTarget.style.color="#4b5563"},title:"Click to edit frequency",children:["Every ",re.frequency_days||30," days "]})}),i.jsx("td",{children:i.jsx("span",{className:`status-badge ${re.status}`,children:re.status})}),i.jsx("td",{children:re.last_order?i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[i.jsxs("div",{style:{fontSize:"0.875rem"},children:[i.jsx("span",{style:{fontWeight:500},children:"Status: "}),i.jsx("span",{className:`status-badge ${re.last_order.status}`,children:re.last_order.status})]}),i.jsx("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:new Date(re.last_order.date).toLocaleDateString()}),i.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[re.last_order.status==="pending"&&i.jsxs("button",{onClick:()=>fe(re.last_order.id,re.medications),className:"small-action-button bill",children:[i.jsx(j_,{size:12})," Bill"]}),re.last_order.status==="billed"&&i.jsxs("button",{onClick:()=>we(re.last_order.id,"dispensed"),className:"small-action-button dispense",children:[i.jsx(Pd,{size:12})," Dispense"]}),re.last_order.status==="dispensed"&&i.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem",color:"#16a34a"},children:[i.jsx(Ra,{size:12})," Complete"]})]})]}):i.jsx("span",{style:{fontSize:"0.875rem",color:"#9ca3af"},children:"No recent order"})}),i.jsx("td",{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.jsxs("select",{value:re.status,onChange:_e=>A(re.id,_e.target.value),style:{fontSize:"0.875rem",borderColor:"#d1d5db",borderRadius:"0.375rem",padding:"0.25rem 0.5rem"},children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"paused",children:"Paused"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]}),i.jsx("button",{onClick:()=>de(re),className:"action-button",title:"Create Order",children:i.jsx(VI,{size:18})})]})})]},re.id))})]})}),B>1&&i.jsxs("div",{className:"pagination-controls",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"1.5rem",padding:"1rem",backgroundColor:"#f9fafb",borderRadius:"0.5rem"},children:[i.jsxs("div",{className:"pagination-info",style:{fontSize:"0.875rem",color:"#6b7280"},children:["Showing"," ",i.jsx("span",{style:{fontWeight:500,color:"#1f2937"},children:(F-1)*Ov+1})," ","to"," ",i.jsx("span",{style:{fontWeight:500,color:"#1f2937"},children:Math.min(F*Ov,q)})," ","of"," ",i.jsx("span",{style:{fontWeight:500,color:"#1f2937"},children:q})," results"]}),i.jsxs("div",{className:"pagination-buttons",style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[i.jsxs("button",{onClick:()=>$(re=>Math.max(re-1,1)),disabled:F===1||t,className:"pagination-button",style:{display:"flex",alignItems:"center",gap:"0.25rem",padding:"0.5rem 1rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",backgroundColor:F===1?"#f3f4f6":"#fff",cursor:F===1?"not-allowed":"pointer",fontSize:"0.875rem"},children:[i.jsx(wb,{size:16}),"Previous"]}),i.jsxs("span",{style:{fontSize:"0.875rem",color:"#6b7280"},children:["Page ",i.jsx("span",{style:{fontWeight:500,color:"#1f2937"},children:F})," of ",i.jsx("span",{style:{fontWeight:500,color:"#1f2937"},children:B})]}),i.jsxs("button",{onClick:()=>$(re=>Math.min(re+1,B)),disabled:F===B||t,className:"pagination-button",style:{display:"flex",alignItems:"center",gap:"0.25rem",padding:"0.5rem 1rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",backgroundColor:F===B?"#f3f4f6":"#fff",cursor:F===B?"not-allowed":"pointer",fontSize:"0.875rem"},children:["Next",i.jsx(rg,{size:16})]})]})]})]})]}),u&&i.jsx(Bte,{isOpen:o,onClose:()=>f(!1),recurringItems:u.medications,inventory:h,onCreateOrder:Se})]})},qte=({isOpen:e,onClose:n,userRole:t})=>{const[r,a]=w.useState(""),l=gt(),o=w.useMemo(()=>(Q1[t]||[]).flatMap(h=>h.links),[t]),f=w.useMemo(()=>r?o.filter(d=>d.name.toLowerCase().includes(r.toLowerCase())):[],[r,o]);w.useEffect(()=>{e&&a("")},[e]);const u=d=>{l(d),n()};return e?i.jsx("div",{className:"search-modal-overlay",onClick:n,children:i.jsxs("div",{className:"search-modal-content",onClick:d=>d.stopPropagation(),children:[i.jsx("div",{className:"search-modal-header",children:i.jsx("input",{type:"text",placeholder:"Search for pages...",className:"search-modal-input",value:r,onChange:d=>a(d.target.value),autoFocus:!0})}),i.jsx("div",{className:"search-modal-results",children:f.length>0?i.jsx("ul",{children:f.map(d=>i.jsx("li",{onClick:()=>u(d.path),children:d.name},d.path))}):r&&i.jsx("p",{children:"No results found"})})]})}):null};function Vte(){const[e,n]=w.useState(!1),[t,r]=w.useState(null),[a,l]=w.useState(!0),[o,f]=w.useState(null),[u,d]=w.useState(!1),h=I=>{r(I),n(!0),I.role==="admin"&&!I.has_seen_tutorial&&d(!0)},g=()=>{n(!1),r(null),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")};w.useEffect(()=>{const I=localStorage.getItem("authToken"),P=localStorage.getItem("currentUser");if(I&&P)try{const V=JSON.parse(P);r(V),n(!0),V.role==="admin"&&!V.has_seen_tutorial&&d(!0)}catch(V){console.error("Error parsing stored user data:",V),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")}l(!1)},[]),w.useEffect(()=>{(async()=>{if(e&&t)try{const P=await q_();f(P)}catch(P){console.error("Error fetching clinic pro plan status:",P),f({hasProPlan:!1})}else f(null)})()},[e,t]);const[b,v]=w.useState(null),[N,k]=w.useState(!1);w.useEffect(()=>{const I=P=>{P.preventDefault(),v(P),k(!0),console.log("beforeinstallprompt event fired")};return window.addEventListener("beforeinstallprompt",I),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&(console.log("App is already installed (standalone)."),k(!1)),()=>{window.removeEventListener("beforeinstallprompt",I)}},[]),w.useEffect(()=>{const I=window.matchMedia("(prefers-color-scheme: dark)"),P=()=>{I.matches?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")};return P(),I.addEventListener("change",P),()=>{I.removeEventListener("change",P),document.body.classList.remove("dark-mode")}},[]);const T=w.useCallback(async()=>{if(!b){console.log("Install prompt event not available.");return}const I=b;I.prompt();const{outcome:P}=await I.userChoice;console.log(`User response to the install prompt: ${P}`),v(null),k(!1)},[b]),E=async()=>{if(t)try{(await pe(`/api/users/${t.id}/tutorial-seen`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({has_seen_tutorial:!0})})).ok?(r(P=>P?{...P,has_seen_tutorial:!0}:null),localStorage.setItem("currentUser",JSON.stringify({...t,has_seen_tutorial:!0})),d(!1)):console.error("Failed to update tutorial status on backend.")}catch(I){console.error("Error marking tutorial as seen:",I)}};return a?i.jsx("div",{className:"initial-app-loading-screen",children:i.jsx("img",{src:"/logo.png",alt:"Loading App",className:"initial-app-loader-logo"})}):i.jsxs(AD,{children:[i.jsx(BD,{children:i.jsxs(gh,{children:[i.jsx(ct,{path:"/login",element:e?i.jsx(pn,{to:"/dashboard"}):i.jsx(HD,{onLoginSuccess:h})}),i.jsx(ct,{path:"/register",element:e?i.jsx(pn,{to:"/dashboard"}):i.jsx(GD,{})}),i.jsx(ct,{path:"/handle-complaint-url",element:e?i.jsx(Yee,{}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/live-api",element:e?i.jsx(XB,{}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/create-lab-order",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(ak,{currentUser:t})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/manage-admission",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(ik,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/lab/report/:orderId",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(Qj,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/lab/enter-report/:orderId",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(Qj,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/dashboard/add-patient",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(c1,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/billing",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(KZ,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/lab-billing",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(ZZ,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/dashboard/edit-complaint/:recordId",element:e&&t?i.jsx(WZ,{}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/dashboard/edit-pharmacy-order/:orderId",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(hT,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/dashboard/*",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:Hte(t.role,t,pe)}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/lab/view-report/:orderId",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(cee,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/lab/search-report",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(uee,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/patient/:patientId/lab-reports",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(dee,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/patient/:patientId/pharmacy-orders",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(eee,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/inventory",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(pT,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/lab-inventory",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(K1,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/patient/:patientId/complaints",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(QZ,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/patient/:patientId/admission-bill/:billId",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(mee,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/start-subscription/:patientId",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(Lee,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/start-clinic-subscription",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(zee,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/refill-reminders",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(kT,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/dashboard/notifications",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(Wee,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/create-custom-bill",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(rk,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/dashboard/pharmacy-billing/:orderId",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(ete,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/dashboard/bills/:billId",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(tte,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"/dashboard/recurring-medications",element:e&&t?i.jsx(ei,{user:t,onLogout:g,showInstallPrompt:N,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(Ute,{})}):i.jsx(pn,{to:"/login"})}),i.jsx(ct,{path:"*",element:i.jsx(pn,{to:e?"/dashboard":"/login"})})]})}),u&&i.jsx(Hee,{onClose:()=>d(!1),onMarkAsSeen:E})]})}const Hte=(e,n,t)=>{switch(e){case"superadmin":return i.jsxs(gh,{children:[i.jsx(ct,{index:!0,element:i.jsx(Uee,{})}),i.jsx(ct,{path:"clinic-subscriptions",element:i.jsx(Oee,{})}),i.jsx(ct,{path:"clinic-subscriptions/add",element:i.jsx(Fee,{})}),i.jsx(ct,{path:"clinic-subscriptions/edit/:id",element:i.jsx($ee,{})}),i.jsx(ct,{path:"users",element:i.jsx(Bee,{})})," ",i.jsx(ct,{path:"*",element:i.jsx("div",{children:"Unknown Super Admin Section"})})]});case"admin":return i.jsxs(gh,{children:[i.jsx(ct,{index:!0,element:i.jsx(oU,{fetchWithAuth:t})}),i.jsx(ct,{path:"staff",element:i.jsx(pee,{fetchWithAuth:t})}),i.jsx(ct,{path:"staff/add",element:i.jsx(yU,{clinicId:n==null?void 0:n.clinic_id})}),i.jsx(ct,{path:"staff/edit/:id",element:i.jsx(xU,{})}),i.jsx(ct,{path:"patients/add",element:i.jsx(c1,{})}),i.jsx(ct,{path:"search-patient",element:i.jsx(vh,{})}),i.jsx(ct,{path:"patients",element:i.jsx(o1,{})}),i.jsx(ct,{path:"analysis",element:i.jsx(qv,{})}),i.jsx(ct,{path:"inventory",element:i.jsx(U_,{})}),i.jsx(ct,{path:"inventory/edit/:id",element:i.jsx(gU,{})}),i.jsx(ct,{path:"distributors",element:i.jsx(Xj,{})}),i.jsx(ct,{path:"purchase",element:i.jsx(Zj,{})})," ",i.jsx(ct,{path:"queue",element:i.jsx(nv,{})}),i.jsx(ct,{path:"subscriptions",element:i.jsx(Iee,{})}),i.jsx(ct,{path:"subscriptions/add",element:i.jsx(Mee,{})}),i.jsx(ct,{path:"subscriptions/edit/:id",element:i.jsx(Ree,{})}),i.jsx(ct,{path:"add-pharmacy-order",element:i.jsx(Yj,{})}),i.jsx(ct,{path:"*",element:i.jsx("div",{children:"Unknown Admin Section"})})," "]});case"doctor":return i.jsxs(gh,{children:[i.jsx(ct,{index:!0,element:i.jsx(pn,{to:"search-patient",replace:!0})}),i.jsx(ct,{path:"search-patient",element:i.jsx(vh,{})}),i.jsx(ct,{path:"queue",element:i.jsx(nv,{})}),i.jsx(ct,{path:":patientId",element:i.jsx(nv,{})}),i.jsx(ct,{path:"add-patient",element:i.jsx(c1,{})}),i.jsx(ct,{path:"*",element:i.jsx("div",{children:"Unknown Doctor Section"})})]});case"receptionist":return i.jsxs(gh,{children:[i.jsx(ct,{index:!0,element:i.jsx(uU,{currentUser:n})}),i.jsx(ct,{path:"all-patients",element:i.jsx(o1,{})}),i.jsx(ct,{path:"search-patient",element:i.jsx(vh,{})}),i.jsx(ct,{path:"*",element:i.jsx("div",{children:"Unknown Reception Section"})})," "]});case"lab":return i.jsx(hU,{});case"pharmacy":return i.jsxs(gh,{children:[i.jsx(ct,{index:!0,element:i.jsx(pU,{})}),i.jsx(ct,{path:"inventory",element:i.jsx(pT,{})}),i.jsx(ct,{path:"settings",element:i.jsx(mU,{})}),i.jsx(ct,{path:"add-order",element:i.jsx(Yj,{})}),i.jsx(ct,{path:"edit-pharmacy-order/:orderId",element:i.jsx(hT,{})}),i.jsx(ct,{path:"analysis",element:i.jsx(qv,{})}),i.jsx(ct,{path:"orders/:orderId",element:i.jsx(_ee,{})}),i.jsx(ct,{path:"search-patient-records",element:i.jsx(vh,{})}),i.jsx(ct,{path:"distributors",element:i.jsx(Xj,{})}),i.jsx(ct,{path:"purchase",element:i.jsx(Zj,{})})," ",i.jsx(ct,{path:"refill-reminders",element:i.jsx(kT,{})})," ",i.jsx(ct,{path:"*",element:i.jsx(pn,{to:"/dashboard",replace:!0})})]});default:return i.jsxs("div",{children:["Unknown role (",e,") or dashboard not implemented."]},e)}},ei=({user:e,onLogout:n,children:t,showInstallPrompt:r,onInstallClick:a,clinicProPlanStatus:l})=>{const o=gt(),[f,u]=w.useState(!1),[d,h]=w.useState(!1),[g,b]=w.useState(window.innerWidth<=768),[v,N]=w.useState(!1),[k,T]=w.useState([]),[E,I]=w.useState(0),[P,V]=w.useState(!1),[F,$]=w.useState("Newtons Ai"),[B,z]=w.useState(null),[q,O]=w.useState(!1),R=w.useRef(null);w.useEffect(()=>{const J=()=>{b(window.innerWidth<=768)};return window.addEventListener("resize",J),()=>window.removeEventListener("resize",J)},[]),w.useEffect(()=>Ms.subscribe(ne=>{O(ne)}),[]);const G=w.useCallback(async()=>{try{const J=await pe("/api/notifications");if(J.ok){const ae=(await J.json()).reduce((ce,M)=>{const de=ce.find(Se=>Se.message===M.message);return de?new Date(M.created_at)>new Date(de.created_at)?ce.map(Se=>Se.message===M.message?M:Se):ce:[...ce,M]},[]).sort((ce,M)=>{const de={expired_drug:1,near_expiry_drug:2,low_stock:3},Se=de[ce.type]||99,fe=de[M.type]||99;return Se!==fe?Se-fe:new Date(M.created_at).getTime()-new Date(ce.created_at).getTime()});T(ae),I(ae.filter(ce=>!ce.is_read).length)}else console.error("Failed to fetch notifications:",J.statusText)}catch(J){console.error("Error fetching notifications:",J)}},[]);w.useEffect(()=>{(async()=>{if(e!=null&&e.clinic_id)try{const ne=await pe("/api/clinics/settings");if(ne.ok){const A=await ne.json();A.name===""?$("Newtons Ai"):$(A.name),z(A.logoUrl)}else console.error("Failed to fetch clinic details for display:",ne.statusText),$("Newtons Ai"),z(null)}catch(ne){console.error("Error fetching clinic details for display:",ne),$("Newtons Ai"),z(null)}else $("Newtons Ai"),z(null)})()},[e==null?void 0:e.clinic_id]),w.useEffect(()=>{if(e!=null&&e.clinic_id){G();const J=setInterval(G,5*60*1e3);return()=>clearInterval(J)}},[e==null?void 0:e.clinic_id,G]);const ee=()=>{u(!f),f||(h(!1),N(!1))},te=()=>{h(!d),d||(u(!1),N(!1))},le=()=>{N(!v),v||(u(!1),h(!1))};w.useEffect(()=>{const J=ne=>{R.current&&!R.current.contains(ne.target)&&v&&N(!1)};return v&&document.addEventListener("mousedown",J),()=>{document.removeEventListener("mousedown",J)}},[v]);const K=async J=>{try{const ne=await pe(`/api/notifications/${J}/read`,{method:"PUT"});ne.ok?G():console.error("Failed to mark notification as read:",ne.statusText)}catch(ne){console.error("Error marking notification as read:",ne)}},U=async()=>{V(!0);try{const J=await pe("/api/notifications/trigger-all",{method:"POST"});J.ok?(console.log("Notification checks triggered successfully."),await G()):console.error("Failed to trigger notification checks:",J.statusText)}catch(J){console.error("Error triggering notification checks:",J)}finally{V(!1)}};return i.jsxs("div",{className:"dashboard-layout",children:[" ",i.jsxs("nav",{className:"app-header no-print",children:[i.jsxs("div",{className:"header-left",children:[g&&q?i.jsx("div",{className:"global-loading-indicator",title:"Loading...",children:i.jsx("div",{className:"spinner"})}):i.jsx("a",{href:"#",onClick:J=>{J.preventDefault(),o("/dashboard")},className:"logo-container",children:i.jsx("img",{src:B||"/logo.png",alt:"App Logo",className:"logo-image"})}),i.jsxs("div",{className:"title-section",children:[i.jsx("span",{className:"app-title-link",children:F}),i.jsxs("span",{className:"user-role-panel",children:["(",e.role.charAt(0).toUpperCase()+e.role.slice(1)," Panel)"]})]})]}),i.jsxs("div",{className:"header-right",children:[!g&&q&&i.jsx("div",{className:"global-loading-indicator",title:"Loading...",children:i.jsx("div",{className:"spinner"})}),r&&i.jsxs("button",{onClick:a,className:"install-button",title:"Install App",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),i.jsx("span",{children:"Install"})]}),l&&(l.hasProPlan?i.jsx("span",{className:"pro-badge",children:"PRO"}):i.jsx("button",{onClick:()=>o("/start-clinic-subscription"),className:"go-pro-button",children:"GoPro"})),!g&&i.jsx("button",{className:"header-search-button",onClick:te,"aria-label":"Search pages",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),i.jsxs("div",{className:"notifications-section",ref:R,children:[" ",i.jsxs("button",{className:"notification-icon","aria-label":"Notifications",onClick:le,children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),E>0&&i.jsx("span",{className:"notification-count",children:E})]}),v&&i.jsxs("div",{className:"notifications-dropdown",children:[i.jsx("div",{className:"dropdown-header",children:"Notifications"}),i.jsx("ul",{className:"dropdown-list",children:k.length>0?k.map(J=>i.jsxs("li",{className:`dropdown-item ${J.is_read?"read":"unread"}`,onClick:()=>K(J.id),children:[J.message,i.jsx("span",{className:"notification-timestamp",children:new Date(J.created_at).toLocaleString()})]},J.id)):i.jsx("li",{className:"dropdown-item",children:"No new notifications"})}),i.jsxs("div",{className:"dropdown-footer",children:[i.jsx("button",{onClick:()=>o("/dashboard/notifications"),children:"View All"}),(e.role==="admin"||e.role==="superadmin")&&i.jsx("button",{onClick:U,className:"fetch-all-button",disabled:P,children:P?"Fetching...":"Fetch All"})]})]})]}),i.jsx("button",{className:"hamburger-icon",onClick:ee,"aria-label":"Open navigation",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})})]})]}),i.jsx("main",{className:"main-content",children:t}),g?i.jsx(nP,{user:e,onLogout:n,userRole:e.role,isOpen:f,onClose:ee,roleNavigation:Q1}):i.jsx(tP,{user:e,onLogout:n,userRole:e.role,isOpen:f,onClose:ee}),!g&&f&&i.jsx("div",{className:"side-panel-overlay",onClick:ee}),i.jsx(qte,{isOpen:d,onClose:()=>h(!1),userRole:e.role})]})};gA.createRoot(document.getElementById("root")).render(i.jsx(w.StrictMode,{children:i.jsx(Vte,{})}));
