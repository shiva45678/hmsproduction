var cA=Object.defineProperty;var uA=(e,n,t)=>n in e?cA(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var Vn=(e,n,t)=>uA(e,typeof n!="symbol"?n+"":n,t);function dA(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const l=Object.getOwnPropertyDescriptor(r,a);l&&Object.defineProperty(e,a,l.get?l:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();var Xc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Gd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Rv={exports:{}},_m={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xw;function fA(){if(Xw)return _m;Xw=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function t(r,a,l){var o=null;if(l!==void 0&&(o=""+l),a.key!==void 0&&(o=""+a.key),"key"in a){l={};for(var f in a)f!=="key"&&(l[f]=a[f])}else l=a;return a=l.ref,{$$typeof:e,type:r,key:o,ref:a!==void 0?a:null,props:l}}return _m.Fragment=n,_m.jsx=t,_m.jsxs=t,_m}var Zw;function hA(){return Zw||(Zw=1,Rv.exports=fA()),Rv.exports}var i=hA(),Lv={exports:{}},Qt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eN;function pA(){if(eN)return Qt;eN=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),o=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;function b(A){return A===null||typeof A!="object"?null:(A=g&&A[g]||A["@@iterator"],typeof A=="function"?A:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,k={};function T(A,ie,se){this.props=A,this.context=ie,this.refs=k,this.updater=se||v}T.prototype.isReactComponent={},T.prototype.setState=function(A,ie){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,ie,"setState")},T.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function E(){}E.prototype=T.prototype;function P(A,ie,se){this.props=A,this.context=ie,this.refs=k,this.updater=se||v}var I=P.prototype=new E;I.constructor=P,S(I,T.prototype),I.isPureReactComponent=!0;var V=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},O=Object.prototype.hasOwnProperty;function B(A,ie,se,M,ce,ve){return se=ve.ref,{$$typeof:e,type:A,key:ie,ref:se!==void 0?se:null,props:ve}}function U(A,ie){return B(A.type,ie,void 0,void 0,void 0,A.props)}function z(A){return typeof A=="object"&&A!==null&&A.$$typeof===e}function $(A){var ie={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(se){return ie[se]})}var R=/\/+/g;function H(A,ie){return typeof A=="object"&&A!==null&&A.key!=null?$(""+A.key):ie.toString(36)}function ee(){}function Z(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(ee,ee):(A.status="pending",A.then(function(ie){A.status==="pending"&&(A.status="fulfilled",A.value=ie)},function(ie){A.status==="pending"&&(A.status="rejected",A.reason=ie)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function te(A,ie,se,M,ce){var ve=typeof A;(ve==="undefined"||ve==="boolean")&&(A=null);var le=!1;if(A===null)le=!0;else switch(ve){case"bigint":case"string":case"number":le=!0;break;case"object":switch(A.$$typeof){case e:case n:le=!0;break;case h:return le=A._init,te(le(A._payload),ie,se,M,ce)}}if(le)return ce=ce(A),le=M===""?"."+H(A,0):M,V(ce)?(se="",le!=null&&(se=le.replace(R,"$&/")+"/"),te(ce,ie,se,"",function(ze){return ze})):ce!=null&&(z(ce)&&(ce=U(ce,se+(ce.key==null||A&&A.key===ce.key?"":(""+ce.key).replace(R,"$&/")+"/")+le)),ie.push(ce)),1;le=0;var xe=M===""?".":M+":";if(V(A))for(var ue=0;ue<A.length;ue++)M=A[ue],ve=xe+H(M,ue),le+=te(M,ie,se,ve,ce);else if(ue=b(A),typeof ue=="function")for(A=ue.call(A),ue=0;!(M=A.next()).done;)M=M.value,ve=xe+H(M,ue++),le+=te(M,ie,se,ve,ce);else if(ve==="object"){if(typeof A.then=="function")return te(Z(A),ie,se,M,ce);throw ie=String(A),Error("Objects are not valid as a React child (found: "+(ie==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":ie)+"). If you meant to render a collection of children, use an array instead.")}return le}function Q(A,ie,se){if(A==null)return A;var M=[],ce=0;return te(A,M,"","",function(ve){return ie.call(se,ve,ce++)}),M}function q(A){if(A._status===-1){var ie=A._result;ie=ie(),ie.then(function(se){(A._status===0||A._status===-1)&&(A._status=1,A._result=se)},function(se){(A._status===0||A._status===-1)&&(A._status=2,A._result=se)}),A._status===-1&&(A._status=0,A._result=ie)}if(A._status===1)return A._result.default;throw A._result}var W=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ie=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(ie))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)};function ne(){}return Qt.Children={map:Q,forEach:function(A,ie,se){Q(A,function(){ie.apply(this,arguments)},se)},count:function(A){var ie=0;return Q(A,function(){ie++}),ie},toArray:function(A){return Q(A,function(ie){return ie})||[]},only:function(A){if(!z(A))throw Error("React.Children.only expected to receive a single React element child.");return A}},Qt.Component=T,Qt.Fragment=t,Qt.Profiler=a,Qt.PureComponent=P,Qt.StrictMode=r,Qt.Suspense=u,Qt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,Qt.__COMPILER_RUNTIME={__proto__:null,c:function(A){return F.H.useMemoCache(A)}},Qt.cache=function(A){return function(){return A.apply(null,arguments)}},Qt.cloneElement=function(A,ie,se){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var M=S({},A.props),ce=A.key,ve=void 0;if(ie!=null)for(le in ie.ref!==void 0&&(ve=void 0),ie.key!==void 0&&(ce=""+ie.key),ie)!O.call(ie,le)||le==="key"||le==="__self"||le==="__source"||le==="ref"&&ie.ref===void 0||(M[le]=ie[le]);var le=arguments.length-2;if(le===1)M.children=se;else if(1<le){for(var xe=Array(le),ue=0;ue<le;ue++)xe[ue]=arguments[ue+2];M.children=xe}return B(A.type,ce,void 0,void 0,ve,M)},Qt.createContext=function(A){return A={$$typeof:o,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:l,_context:A},A},Qt.createElement=function(A,ie,se){var M,ce={},ve=null;if(ie!=null)for(M in ie.key!==void 0&&(ve=""+ie.key),ie)O.call(ie,M)&&M!=="key"&&M!=="__self"&&M!=="__source"&&(ce[M]=ie[M]);var le=arguments.length-2;if(le===1)ce.children=se;else if(1<le){for(var xe=Array(le),ue=0;ue<le;ue++)xe[ue]=arguments[ue+2];ce.children=xe}if(A&&A.defaultProps)for(M in le=A.defaultProps,le)ce[M]===void 0&&(ce[M]=le[M]);return B(A,ve,void 0,void 0,null,ce)},Qt.createRef=function(){return{current:null}},Qt.forwardRef=function(A){return{$$typeof:f,render:A}},Qt.isValidElement=z,Qt.lazy=function(A){return{$$typeof:h,_payload:{_status:-1,_result:A},_init:q}},Qt.memo=function(A,ie){return{$$typeof:d,type:A,compare:ie===void 0?null:ie}},Qt.startTransition=function(A){var ie=F.T,se={};F.T=se;try{var M=A(),ce=F.S;ce!==null&&ce(se,M),typeof M=="object"&&M!==null&&typeof M.then=="function"&&M.then(ne,W)}catch(ve){W(ve)}finally{F.T=ie}},Qt.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},Qt.use=function(A){return F.H.use(A)},Qt.useActionState=function(A,ie,se){return F.H.useActionState(A,ie,se)},Qt.useCallback=function(A,ie){return F.H.useCallback(A,ie)},Qt.useContext=function(A){return F.H.useContext(A)},Qt.useDebugValue=function(){},Qt.useDeferredValue=function(A,ie){return F.H.useDeferredValue(A,ie)},Qt.useEffect=function(A,ie,se){var M=F.H;if(typeof se=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return M.useEffect(A,ie)},Qt.useId=function(){return F.H.useId()},Qt.useImperativeHandle=function(A,ie,se){return F.H.useImperativeHandle(A,ie,se)},Qt.useInsertionEffect=function(A,ie){return F.H.useInsertionEffect(A,ie)},Qt.useLayoutEffect=function(A,ie){return F.H.useLayoutEffect(A,ie)},Qt.useMemo=function(A,ie){return F.H.useMemo(A,ie)},Qt.useOptimistic=function(A,ie){return F.H.useOptimistic(A,ie)},Qt.useReducer=function(A,ie,se){return F.H.useReducer(A,ie,se)},Qt.useRef=function(A){return F.H.useRef(A)},Qt.useState=function(A){return F.H.useState(A)},Qt.useSyncExternalStore=function(A,ie,se){return F.H.useSyncExternalStore(A,ie,se)},Qt.useTransition=function(){return F.H.useTransition()},Qt.version="19.1.0",Qt}var tN;function H1(){return tN||(tN=1,Lv.exports=pA()),Lv.exports}var w=H1();const Rn=Gd(w),nN=dA({__proto__:null,default:Rn},[w]);var Ov={exports:{}},km={},Fv={exports:{}},$v={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iN;function mA(){return iN||(iN=1,function(e){function n(Q,q){var W=Q.length;Q.push(q);e:for(;0<W;){var ne=W-1>>>1,A=Q[ne];if(0<a(A,q))Q[ne]=q,Q[W]=A,W=ne;else break e}}function t(Q){return Q.length===0?null:Q[0]}function r(Q){if(Q.length===0)return null;var q=Q[0],W=Q.pop();if(W!==q){Q[0]=W;e:for(var ne=0,A=Q.length,ie=A>>>1;ne<ie;){var se=2*(ne+1)-1,M=Q[se],ce=se+1,ve=Q[ce];if(0>a(M,W))ce<A&&0>a(ve,M)?(Q[ne]=ve,Q[ce]=W,ne=ce):(Q[ne]=M,Q[se]=W,ne=se);else if(ce<A&&0>a(ve,W))Q[ne]=ve,Q[ce]=W,ne=ce;else break e}}return q}function a(Q,q){var W=Q.sortIndex-q.sortIndex;return W!==0?W:Q.id-q.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,f=o.now();e.unstable_now=function(){return o.now()-f}}var u=[],d=[],h=1,g=null,b=3,v=!1,S=!1,k=!1,T=!1,E=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function V(Q){for(var q=t(d);q!==null;){if(q.callback===null)r(d);else if(q.startTime<=Q)r(d),q.sortIndex=q.expirationTime,n(u,q);else break;q=t(d)}}function F(Q){if(k=!1,V(Q),!S)if(t(u)!==null)S=!0,O||(O=!0,H());else{var q=t(d);q!==null&&te(F,q.startTime-Q)}}var O=!1,B=-1,U=5,z=-1;function $(){return T?!0:!(e.unstable_now()-z<U)}function R(){if(T=!1,O){var Q=e.unstable_now();z=Q;var q=!0;try{e:{S=!1,k&&(k=!1,P(B),B=-1),v=!0;var W=b;try{t:{for(V(Q),g=t(u);g!==null&&!(g.expirationTime>Q&&$());){var ne=g.callback;if(typeof ne=="function"){g.callback=null,b=g.priorityLevel;var A=ne(g.expirationTime<=Q);if(Q=e.unstable_now(),typeof A=="function"){g.callback=A,V(Q),q=!0;break t}g===t(u)&&r(u),V(Q)}else r(u);g=t(u)}if(g!==null)q=!0;else{var ie=t(d);ie!==null&&te(F,ie.startTime-Q),q=!1}}break e}finally{g=null,b=W,v=!1}q=void 0}}finally{q?H():O=!1}}}var H;if(typeof I=="function")H=function(){I(R)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,Z=ee.port2;ee.port1.onmessage=R,H=function(){Z.postMessage(null)}}else H=function(){E(R,0)};function te(Q,q){B=E(function(){Q(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Q){Q.callback=null},e.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<Q?Math.floor(1e3/Q):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(Q){switch(b){case 1:case 2:case 3:var q=3;break;default:q=b}var W=b;b=q;try{return Q()}finally{b=W}},e.unstable_requestPaint=function(){T=!0},e.unstable_runWithPriority=function(Q,q){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var W=b;b=Q;try{return q()}finally{b=W}},e.unstable_scheduleCallback=function(Q,q,W){var ne=e.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?ne+W:ne):W=ne,Q){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=W+A,Q={id:h++,callback:q,priorityLevel:Q,startTime:W,expirationTime:A,sortIndex:-1},W>ne?(Q.sortIndex=W,n(d,Q),t(u)===null&&Q===t(d)&&(k?(P(B),B=-1):k=!0,te(F,W-ne))):(Q.sortIndex=A,n(u,Q),S||v||(S=!0,O||(O=!0,H()))),Q},e.unstable_shouldYield=$,e.unstable_wrapCallback=function(Q){var q=b;return function(){var W=b;b=q;try{return Q.apply(this,arguments)}finally{b=W}}}}($v)),$v}var rN;function gA(){return rN||(rN=1,Fv.exports=mA()),Fv.exports}var zv={exports:{}},Ar={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aN;function yA(){if(aN)return Ar;aN=1;var e=H1();function n(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)d+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(n(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(u,d,h){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:g==null?null:""+g,children:u,containerInfo:d,implementation:h}}var o=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Ar.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Ar.createPortal=function(u,d){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(n(299));return l(u,d,null,h)},Ar.flushSync=function(u){var d=o.T,h=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=d,r.p=h,r.d.f()}},Ar.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(u,d))},Ar.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},Ar.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var h=d.as,g=f(h,d.crossOrigin),b=typeof d.integrity=="string"?d.integrity:void 0,v=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;h==="style"?r.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:g,integrity:b,fetchPriority:v}):h==="script"&&r.d.X(u,{crossOrigin:g,integrity:b,fetchPriority:v,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Ar.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var h=f(d.as,d.crossOrigin);r.d.M(u,{crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(u)},Ar.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var h=d.as,g=f(h,d.crossOrigin);r.d.L(u,h,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Ar.preloadModule=function(u,d){if(typeof u=="string")if(d){var h=f(d.as,d.crossOrigin);r.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:h,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(u)},Ar.requestFormReset=function(u){r.d.r(u)},Ar.unstable_batchedUpdates=function(u,d){return u(d)},Ar.useFormState=function(u,d,h){return o.H.useFormState(u,d,h)},Ar.useFormStatus=function(){return o.H.useHostTransitionStatus()},Ar.version="19.1.0",Ar}var sN;function o_(){if(sN)return zv.exports;sN=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),zv.exports=yA(),zv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lN;function xA(){if(lN)return km;lN=1;var e=gA(),n=H1(),t=o_();function r(s){var c="https://react.dev/errors/"+s;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)c+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+s+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var c=s,p=s;if(s.alternate)for(;c.return;)c=c.return;else{s=c;do c=s,(c.flags&4098)!==0&&(p=c.return),s=c.return;while(s)}return c.tag===3?p:null}function o(s){if(s.tag===13){var c=s.memoizedState;if(c===null&&(s=s.alternate,s!==null&&(c=s.memoizedState)),c!==null)return c.dehydrated}return null}function f(s){if(l(s)!==s)throw Error(r(188))}function u(s){var c=s.alternate;if(!c){if(c=l(s),c===null)throw Error(r(188));return c!==s?null:s}for(var p=s,x=c;;){var N=p.return;if(N===null)break;var D=N.alternate;if(D===null){if(x=N.return,x!==null){p=x;continue}break}if(N.child===D.child){for(D=N.child;D;){if(D===p)return f(N),s;if(D===x)return f(N),c;D=D.sibling}throw Error(r(188))}if(p.return!==x.return)p=N,x=D;else{for(var G=!1,X=N.child;X;){if(X===p){G=!0,p=N,x=D;break}if(X===x){G=!0,x=N,p=D;break}X=X.sibling}if(!G){for(X=D.child;X;){if(X===p){G=!0,p=D,x=N;break}if(X===x){G=!0,x=D,p=N;break}X=X.sibling}if(!G)throw Error(r(189))}}if(p.alternate!==x)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?s:c}function d(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s;for(s=s.child;s!==null;){if(c=d(s),c!==null)return c;s=s.sibling}return null}var h=Object.assign,g=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),P=Symbol.for("react.consumer"),I=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),z=Symbol.for("react.activity"),$=Symbol.for("react.memo_cache_sentinel"),R=Symbol.iterator;function H(s){return s===null||typeof s!="object"?null:(s=R&&s[R]||s["@@iterator"],typeof s=="function"?s:null)}var ee=Symbol.for("react.client.reference");function Z(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===ee?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case S:return"Fragment";case T:return"Profiler";case k:return"StrictMode";case F:return"Suspense";case O:return"SuspenseList";case z:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case v:return"Portal";case I:return(s.displayName||"Context")+".Provider";case P:return(s._context.displayName||"Context")+".Consumer";case V:var c=s.render;return s=s.displayName,s||(s=c.displayName||c.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case B:return c=s.displayName||null,c!==null?c:Z(s.type)||"Memo";case U:c=s._payload,s=s._init;try{return Z(s(c))}catch{}}return null}var te=Array.isArray,Q=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W={pending:!1,data:null,method:null,action:null},ne=[],A=-1;function ie(s){return{current:s}}function se(s){0>A||(s.current=ne[A],ne[A]=null,A--)}function M(s,c){A++,ne[A]=s.current,s.current=c}var ce=ie(null),ve=ie(null),le=ie(null),xe=ie(null);function ue(s,c){switch(M(le,c),M(ve,s),M(ce,null),c.nodeType){case 9:case 11:s=(s=c.documentElement)&&(s=s.namespaceURI)?ni(s):0;break;default:if(s=c.tagName,c=c.namespaceURI)c=ni(c),s=di(c,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}se(ce),M(ce,s)}function ze(){se(ce),se(ve),se(le)}function tt(s){s.memoizedState!==null&&M(xe,s);var c=ce.current,p=di(c,s.type);c!==p&&(M(ve,s),M(ce,p))}function ft(s){ve.current===s&&(se(ce),se(ve)),xe.current===s&&(se(xe),Bc._currentValue=W)}var Re=Object.prototype.hasOwnProperty,je=e.unstable_scheduleCallback,he=e.unstable_cancelCallback,Ae=e.unstable_shouldYield,we=e.unstable_requestPaint,Me=e.unstable_now,De=e.unstable_getCurrentPriorityLevel,Je=e.unstable_ImmediatePriority,nt=e.unstable_UserBlockingPriority,Ge=e.unstable_NormalPriority,St=e.unstable_LowPriority,It=e.unstable_IdlePriority,Vt=e.log,oe=e.unstable_setDisableYieldValue,J=null,de=null;function Be(s){if(typeof Vt=="function"&&oe(s),de&&typeof de.setStrictMode=="function")try{de.setStrictMode(J,s)}catch{}}var be=Math.clz32?Math.clz32:st,Fe=Math.log,$e=Math.LN2;function st(s){return s>>>=0,s===0?32:31-(Fe(s)/$e|0)|0}var rt=256,Le=4194304;function Ve(s){var c=s&42;if(c!==0)return c;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function qe(s,c,p){var x=s.pendingLanes;if(x===0)return 0;var N=0,D=s.suspendedLanes,G=s.pingedLanes;s=s.warmLanes;var X=x&134217727;return X!==0?(x=X&~D,x!==0?N=Ve(x):(G&=X,G!==0?N=Ve(G):p||(p=X&~s,p!==0&&(N=Ve(p))))):(X=x&~D,X!==0?N=Ve(X):G!==0?N=Ve(G):p||(p=x&~s,p!==0&&(N=Ve(p)))),N===0?0:c!==0&&c!==N&&(c&D)===0&&(D=N&-N,p=c&-c,D>=p||D===32&&(p&4194048)!==0)?c:N}function Ke(s,c){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&c)===0}function We(s,c){switch(s){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zt(){var s=rt;return rt<<=1,(rt&4194048)===0&&(rt=256),s}function _t(){var s=Le;return Le<<=1,(Le&62914560)===0&&(Le=4194304),s}function rn(s){for(var c=[],p=0;31>p;p++)c.push(s);return c}function Ot(s,c){s.pendingLanes|=c,c!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Yn(s,c,p,x,N,D){var G=s.pendingLanes;s.pendingLanes=p,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=p,s.entangledLanes&=p,s.errorRecoveryDisabledLanes&=p,s.shellSuspendCounter=0;var X=s.entanglements,ye=s.expirationTimes,Pe=s.hiddenUpdates;for(p=G&~p;0<p;){var Ye=31-be(p),Ze=1<<Ye;X[Ye]=0,ye[Ye]=-1;var Oe=Pe[Ye];if(Oe!==null)for(Pe[Ye]=null,Ye=0;Ye<Oe.length;Ye++){var Ie=Oe[Ye];Ie!==null&&(Ie.lane&=-536870913)}p&=~Ze}x!==0&&Wn(s,x,0),D!==0&&N===0&&s.tag!==0&&(s.suspendedLanes|=D&~(G&~c))}function Wn(s,c,p){s.pendingLanes|=c,s.suspendedLanes&=~c;var x=31-be(c);s.entangledLanes|=c,s.entanglements[x]=s.entanglements[x]|1073741824|p&4194090}function Ei(s,c){var p=s.entangledLanes|=c;for(s=s.entanglements;p;){var x=31-be(p),N=1<<x;N&c|s[x]&c&&(s[x]|=c),p&=~N}}function Ti(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function wn(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Bn(){var s=q.p;return s!==0?s:(s=window.event,s===void 0?32:sx(s.type))}function Ji(s,c){var p=q.p;try{return q.p=s,c()}finally{q.p=p}}var li=Math.random().toString(36).slice(2),Ln="__reactFiber$"+li,oi="__reactProps$"+li,Si="__reactContainer$"+li,Hi="__reactEvents$"+li,Yo="__reactListeners$"+li,Qr="__reactHandles$"+li,Qd="__reactResources$"+li,gs="__reactMarker$"+li;function du(s){delete s[Ln],delete s[oi],delete s[Hi],delete s[Yo],delete s[Qr]}function Ks(s){var c=s[Ln];if(c)return c;for(var p=s.parentNode;p;){if(c=p[Si]||p[Ln]){if(p=c.alternate,c.child!==null||p!==null&&p.child!==null)for(s=Wy(s);s!==null;){if(p=s[Ln])return p;s=Wy(s)}return c}s=p,p=s.parentNode}return null}function Xs(s){if(s=s[Ln]||s[Si]){var c=s.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return s}return null}function qa(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s.stateNode;throw Error(r(33))}function Zs(s){var c=s[Qd];return c||(c=s[Qd]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function ji(s){s[gs]=!0}var Jd=new Set,Wo={};function ys(s,c){Va(s,c),Va(s+"Capture",c)}function Va(s,c){for(Wo[s]=c,s=0;s<c.length;s++)Jd.add(c[s])}var ar=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),el={},Ha={};function Kd(s){return Re.call(Ha,s)?!0:Re.call(el,s)?!1:ar.test(s)?Ha[s]=!0:(el[s]=!0,!1)}function Ql(s,c,p){if(Kd(c))if(p===null)s.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":s.removeAttribute(c);return;case"boolean":var x=c.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){s.removeAttribute(c);return}}s.setAttribute(c,""+p)}}function tl(s,c,p){if(p===null)s.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttribute(c,""+p)}}function yr(s,c,p,x){if(x===null)s.removeAttribute(p);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(p);return}s.setAttributeNS(c,p,""+x)}}var Jl,Qo;function va(s){if(Jl===void 0)try{throw Error()}catch(p){var c=p.stack.trim().match(/\n( *(at )?)/);Jl=c&&c[1]||"",Qo=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Jl+s+Qo}var fu=!1;function hu(s,c){if(!s||fu)return"";fu=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(c){var Ze=function(){throw Error()};if(Object.defineProperty(Ze.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ze,[])}catch(Ie){var Oe=Ie}Reflect.construct(s,[],Ze)}else{try{Ze.call()}catch(Ie){Oe=Ie}s.call(Ze.prototype)}}else{try{throw Error()}catch(Ie){Oe=Ie}(Ze=s())&&typeof Ze.catch=="function"&&Ze.catch(function(){})}}catch(Ie){if(Ie&&Oe&&typeof Ie.stack=="string")return[Ie.stack,Oe.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var D=x.DetermineComponentFrameRoot(),G=D[0],X=D[1];if(G&&X){var ye=G.split(`
`),Pe=X.split(`
`);for(N=x=0;x<ye.length&&!ye[x].includes("DetermineComponentFrameRoot");)x++;for(;N<Pe.length&&!Pe[N].includes("DetermineComponentFrameRoot");)N++;if(x===ye.length||N===Pe.length)for(x=ye.length-1,N=Pe.length-1;1<=x&&0<=N&&ye[x]!==Pe[N];)N--;for(;1<=x&&0<=N;x--,N--)if(ye[x]!==Pe[N]){if(x!==1||N!==1)do if(x--,N--,0>N||ye[x]!==Pe[N]){var Ye=`
`+ye[x].replace(" at new "," at ");return s.displayName&&Ye.includes("<anonymous>")&&(Ye=Ye.replace("<anonymous>",s.displayName)),Ye}while(1<=x&&0<=N);break}}}finally{fu=!1,Error.prepareStackTrace=p}return(p=s?s.displayName||s.name:"")?va(p):""}function Xd(s){switch(s.tag){case 26:case 27:case 5:return va(s.type);case 16:return va("Lazy");case 13:return va("Suspense");case 19:return va("SuspenseList");case 0:case 15:return hu(s.type,!1);case 11:return hu(s.type.render,!1);case 1:return hu(s.type,!0);case 31:return va("Activity");default:return""}}function pu(s){try{var c="";do c+=Xd(s),s=s.return;while(s);return c}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function Ki(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function mu(s){var c=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Jo(s){var c=mu(s)?"checked":"value",p=Object.getOwnPropertyDescriptor(s.constructor.prototype,c),x=""+s[c];if(!s.hasOwnProperty(c)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var N=p.get,D=p.set;return Object.defineProperty(s,c,{configurable:!0,get:function(){return N.call(this)},set:function(G){x=""+G,D.call(this,G)}}),Object.defineProperty(s,c,{enumerable:p.enumerable}),{getValue:function(){return x},setValue:function(G){x=""+G},stopTracking:function(){s._valueTracker=null,delete s[c]}}}}function Kl(s){s._valueTracker||(s._valueTracker=Jo(s))}function gu(s){if(!s)return!1;var c=s._valueTracker;if(!c)return!0;var p=c.getValue(),x="";return s&&(x=mu(s)?s.checked?"true":"false":s.value),s=x,s!==p?(c.setValue(s),!0):!1}function Jr(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var yu=/[\n"\\]/g;function Gi(s){return s.replace(yu,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function Xl(s,c,p,x,N,D,G,X){s.name="",G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"?s.type=G:s.removeAttribute("type"),c!=null?G==="number"?(c===0&&s.value===""||s.value!=c)&&(s.value=""+Ki(c)):s.value!==""+Ki(c)&&(s.value=""+Ki(c)):G!=="submit"&&G!=="reset"||s.removeAttribute("value"),c!=null?il(s,G,Ki(c)):p!=null?il(s,G,Ki(p)):x!=null&&s.removeAttribute("value"),N==null&&D!=null&&(s.defaultChecked=!!D),N!=null&&(s.checked=N&&typeof N!="function"&&typeof N!="symbol"),X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"?s.name=""+Ki(X):s.removeAttribute("name")}function nl(s,c,p,x,N,D,G,X){if(D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(s.type=D),c!=null||p!=null){if(!(D!=="submit"&&D!=="reset"||c!=null))return;p=p!=null?""+Ki(p):"",c=c!=null?""+Ki(c):p,X||c===s.value||(s.value=c),s.defaultValue=c}x=x??N,x=typeof x!="function"&&typeof x!="symbol"&&!!x,s.checked=X?s.checked:!!x,s.defaultChecked=!!x,G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"&&(s.name=G)}function il(s,c,p){c==="number"&&Jr(s.ownerDocument)===s||s.defaultValue===""+p||(s.defaultValue=""+p)}function wa(s,c,p,x){if(s=s.options,c){c={};for(var N=0;N<p.length;N++)c["$"+p[N]]=!0;for(p=0;p<s.length;p++)N=c.hasOwnProperty("$"+s[p].value),s[p].selected!==N&&(s[p].selected=N),N&&x&&(s[p].defaultSelected=!0)}else{for(p=""+Ki(p),c=null,N=0;N<s.length;N++){if(s[N].value===p){s[N].selected=!0,x&&(s[N].defaultSelected=!0);return}c!==null||s[N].disabled||(c=s[N])}c!==null&&(c.selected=!0)}}function Ko(s,c,p){if(c!=null&&(c=""+Ki(c),c!==s.value&&(s.value=c),p==null)){s.defaultValue!==c&&(s.defaultValue=c);return}s.defaultValue=p!=null?""+Ki(p):""}function xs(s,c,p,x){if(c==null){if(x!=null){if(p!=null)throw Error(r(92));if(te(x)){if(1<x.length)throw Error(r(93));x=x[0]}p=x}p==null&&(p=""),c=p}p=Ki(c),s.defaultValue=p,x=s.textContent,x===p&&x!==""&&x!==null&&(s.value=x)}function Na(s,c){if(c){var p=s.firstChild;if(p&&p===s.lastChild&&p.nodeType===3){p.nodeValue=c;return}}s.textContent=c}var Sa=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function rl(s,c,p){var x=c.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?x?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="":x?s.setProperty(c,p):typeof p!="number"||p===0||Sa.has(c)?c==="float"?s.cssFloat=p:s[c]=(""+p).trim():s[c]=p+"px"}function al(s,c,p){if(c!=null&&typeof c!="object")throw Error(r(62));if(s=s.style,p!=null){for(var x in p)!p.hasOwnProperty(x)||c!=null&&c.hasOwnProperty(x)||(x.indexOf("--")===0?s.setProperty(x,""):x==="float"?s.cssFloat="":s[x]="");for(var N in c)x=c[N],c.hasOwnProperty(N)&&p[N]!==x&&rl(s,N,x)}else for(var D in c)c.hasOwnProperty(D)&&rl(s,D,c[D])}function Xo(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zl=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Zo=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function bs(s){return Zo.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var sl=null;function eo(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Ga=null,Ya=null;function to(s){var c=Xs(s);if(c&&(s=c.stateNode)){var p=s[oi]||null;e:switch(s=c.stateNode,c.type){case"input":if(Xl(s,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),c=p.name,p.type==="radio"&&c!=null){for(p=s;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+Gi(""+c)+'"][type="radio"]'),c=0;c<p.length;c++){var x=p[c];if(x!==s&&x.form===s.form){var N=x[oi]||null;if(!N)throw Error(r(90));Xl(x,N.value,N.defaultValue,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name)}}for(c=0;c<p.length;c++)x=p[c],x.form===s.form&&gu(x)}break e;case"textarea":Ko(s,p.value,p.defaultValue);break e;case"select":c=p.value,c!=null&&wa(s,!!p.multiple,c,!1)}}}var no=!1;function Kr(s,c,p){if(no)return s(c,p);no=!0;try{var x=s(c);return x}finally{if(no=!1,(Ga!==null||Ya!==null)&&(Wf(),Ga&&(c=Ga,s=Ya,Ya=Ga=null,to(c),s)))for(c=0;c<s.length;c++)to(s[c])}}function vs(s,c){var p=s.stateNode;if(p===null)return null;var x=p[oi]||null;if(x===null)return null;p=x[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(s=s.type,x=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!x;break e;default:s=!1}if(s)return null;if(p&&typeof p!="function")throw Error(r(231,c,typeof p));return p}var Xr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Or=!1;if(Xr)try{var ja={};Object.defineProperty(ja,"passive",{get:function(){Or=!0}}),window.addEventListener("test",ja,ja),window.removeEventListener("test",ja,ja)}catch{Or=!1}var Wa=null,ll=null,io=null;function ec(){if(io)return io;var s,c=ll,p=c.length,x,N="value"in Wa?Wa.value:Wa.textContent,D=N.length;for(s=0;s<p&&c[s]===N[s];s++);var G=p-s;for(x=1;x<=G&&c[p-x]===N[D-x];x++);return io=N.slice(s,1<x?1-x:void 0)}function xn(s){var c=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&c===13&&(s=13)):s=c,s===10&&(s=13),32<=s||s===13?s:0}function bn(){return!0}function ro(){return!1}function Xi(s){function c(p,x,N,D,G){this._reactName=p,this._targetInst=N,this.type=x,this.nativeEvent=D,this.target=G,this.currentTarget=null;for(var X in s)s.hasOwnProperty(X)&&(p=s[X],this[X]=p?p(D):D[X]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?bn:ro,this.isPropagationStopped=ro,this}return h(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=bn)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=bn)},persist:function(){},isPersistent:bn}),c}var ws={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ol=Xi(ws),Ns=h({},ws,{view:0,detail:0}),Zd=Xi(Ns),mn,ao,Un,Qa=h({},Ns,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fr,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Un&&(Un&&s.type==="mousemove"?(mn=s.screenX-Un.screenX,ao=s.screenY-Un.screenY):ao=mn=0,Un=s),mn)},movementY:function(s){return"movementY"in s?s.movementY:ao}}),xr=Xi(Qa),cl=h({},Qa,{dataTransfer:0}),xu=Xi(cl),sr=h({},Ns,{relatedTarget:0}),Ca=Xi(sr),bu=h({},ws,{animationName:0,elapsedTime:0,pseudoElement:0}),tc=Xi(bu),so=h({},ws,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Ss=Xi(so),vu=h({},ws,{data:0}),ci=Xi(vu),nc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Zi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ul={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ef(s){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(s):(s=ul[s])?!!c[s]:!1}function Fr(){return ef}var Ja=h({},Ns,{key:function(s){if(s.key){var c=nc[s.key]||s.key;if(c!=="Unidentified")return c}return s.type==="keypress"?(s=xn(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Zi[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fr,charCode:function(s){return s.type==="keypress"?xn(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?xn(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),dl=Xi(Ja),Dn=h({},Qa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$r=Xi(Dn),wu=h({},Ns,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fr}),ic=Xi(wu),Nu=h({},ws,{propertyName:0,elapsedTime:0,pseudoElement:0}),ip=Xi(Nu),rp=h({},Qa,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ap=Xi(rp),tf=h({},ws,{newState:0,oldState:0}),rc=Xi(tf),fl=[9,13,27,32],Su=Xr&&"CompositionEvent"in window,hl=null;Xr&&"documentMode"in document&&(hl=document.documentMode);var nf=Xr&&"TextEvent"in window&&!hl,ac=Xr&&(!Su||hl&&8<hl&&11>=hl),lo=" ",ju=!1;function oo(s,c){switch(s){case"keyup":return fl.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sc(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Yi=!1;function Ka(s,c){switch(s){case"compositionend":return sc(c);case"keypress":return c.which!==32?null:(ju=!0,lo);case"textInput":return s=c.data,s===lo&&ju?null:s;default:return null}}function Zr(s,c){if(Yi)return s==="compositionend"||!Su&&oo(s,c)?(s=ec(),io=ll=Wa=null,Yi=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return ac&&c.locale!=="ko"?null:c.data;default:return null}}var er={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function co(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c==="input"?!!er[s.type]:c==="textarea"}function js(s,c,p,x){Ga?Ya?Ya.push(x):Ya=[x]:Ga=x,c=th(c,"onChange"),0<c.length&&(p=new ol("onChange","change",null,p,x),s.push({event:p,listeners:c}))}var Cs=null,Xa=null;function rf(s){zy(s,0)}function uo(s){var c=qa(s);if(gu(c))return s}function af(s,c){if(s==="change")return c}var Cu=!1;if(Xr){var _u;if(Xr){var Za="oninput"in document;if(!Za){var sf=document.createElement("div");sf.setAttribute("oninput","return;"),Za=typeof sf.oninput=="function"}_u=Za}else _u=!1;Cu=_u&&(!document.documentMode||9<document.documentMode)}function lf(){Cs&&(Cs.detachEvent("onpropertychange",lc),Xa=Cs=null)}function lc(s){if(s.propertyName==="value"&&uo(Xa)){var c=[];js(c,Xa,s,eo(s)),Kr(rf,c)}}function of(s,c,p){s==="focusin"?(lf(),Cs=c,Xa=p,Cs.attachEvent("onpropertychange",lc)):s==="focusout"&&lf()}function lr(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return uo(Xa)}function oc(s,c){if(s==="click")return uo(c)}function ku(s,c){if(s==="input"||s==="change")return uo(c)}function sp(s,c){return s===c&&(s!==0||1/s===1/c)||s!==s&&c!==c}var or=typeof Object.is=="function"?Object.is:sp;function ea(s,c){if(or(s,c))return!0;if(typeof s!="object"||s===null||typeof c!="object"||c===null)return!1;var p=Object.keys(s),x=Object.keys(c);if(p.length!==x.length)return!1;for(x=0;x<p.length;x++){var N=p[x];if(!Re.call(c,N)||!or(s[N],c[N]))return!1}return!0}function hi(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Eu(s,c){var p=hi(s);s=0;for(var x;p;){if(p.nodeType===3){if(x=s+p.textContent.length,s<=c&&x>=c)return{node:p,offset:c-s};s=x}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=hi(p)}}function Tu(s,c){return s&&c?s===c?!0:s&&s.nodeType===3?!1:c&&c.nodeType===3?Tu(s,c.parentNode):"contains"in s?s.contains(c):s.compareDocumentPosition?!!(s.compareDocumentPosition(c)&16):!1:!1}function cf(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var c=Jr(s.document);c instanceof s.HTMLIFrameElement;){try{var p=typeof c.contentWindow.location.href=="string"}catch{p=!1}if(p)s=c.contentWindow;else break;c=Jr(s.document)}return c}function Au(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c&&(c==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||c==="textarea"||s.contentEditable==="true")}var lp=Xr&&"documentMode"in document&&11>=document.documentMode,pl=null,es=null,Ce=null,He=!1;function Ue(s,c,p){var x=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;He||pl==null||pl!==Jr(x)||(x=pl,"selectionStart"in x&&Au(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Ce&&ea(Ce,x)||(Ce=x,x=th(es,"onSelect"),0<x.length&&(c=new ol("onSelect","select",null,c,p),s.push({event:c,listeners:x}),c.target=pl)))}function dt(s,c){var p={};return p[s.toLowerCase()]=c.toLowerCase(),p["Webkit"+s]="webkit"+c,p["Moz"+s]="moz"+c,p}var Ct={animationend:dt("Animation","AnimationEnd"),animationiteration:dt("Animation","AnimationIteration"),animationstart:dt("Animation","AnimationStart"),transitionrun:dt("Transition","TransitionRun"),transitionstart:dt("Transition","TransitionStart"),transitioncancel:dt("Transition","TransitionCancel"),transitionend:dt("Transition","TransitionEnd")},an={},ui={};Xr&&(ui=document.createElement("div").style,"AnimationEvent"in window||(delete Ct.animationend.animation,delete Ct.animationiteration.animation,delete Ct.animationstart.animation),"TransitionEvent"in window||delete Ct.transitionend.transition);function ae(s){if(an[s])return an[s];if(!Ct[s])return s;var c=Ct[s],p;for(p in c)if(c.hasOwnProperty(p)&&p in ui)return an[s]=c[p];return s}var ge=ae("animationend"),pe=ae("animationiteration"),_e=ae("animationstart"),at=ae("transitionrun"),gt=ae("transitionstart"),yt=ae("transitioncancel"),pt=ae("transitionend"),Ni=new Map,sn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");sn.push("scrollEnd");function cr(s,c){Ni.set(s,c),ys(c,[s])}var cc=new WeakMap;function pi(s,c){if(typeof s=="object"&&s!==null){var p=cc.get(s);return p!==void 0?p:(c={value:s,source:c,stack:pu(c)},cc.set(s,c),c)}return{value:s,source:c,stack:pu(c)}}var ta=[],uc=0,op=0;function fo(){for(var s=uc,c=op=uc=0;c<s;){var p=ta[c];ta[c++]=null;var x=ta[c];ta[c++]=null;var N=ta[c];ta[c++]=null;var D=ta[c];if(ta[c++]=null,x!==null&&N!==null){var G=x.pending;G===null?N.next=N:(N.next=G.next,G.next=N),x.pending=N}D!==0&&Du(p,N,D)}}function _a(s,c,p,x){ta[uc++]=s,ta[uc++]=c,ta[uc++]=p,ta[uc++]=x,op|=x,s.lanes|=x,s=s.alternate,s!==null&&(s.lanes|=x)}function dc(s,c,p,x){return _a(s,c,p,x),Pu(s)}function ho(s,c){return _a(s,null,null,c),Pu(s)}function Du(s,c,p){s.lanes|=p;var x=s.alternate;x!==null&&(x.lanes|=p);for(var N=!1,D=s.return;D!==null;)D.childLanes|=p,x=D.alternate,x!==null&&(x.childLanes|=p),D.tag===22&&(s=D.stateNode,s===null||s._visibility&1||(N=!0)),s=D,D=D.return;return s.tag===3?(D=s.stateNode,N&&c!==null&&(N=31-be(p),s=D.hiddenUpdates,x=s[N],x===null?s[N]=[c]:x.push(c),c.lane=p|536870912),D):null}function Pu(s){if(50<Ic)throw Ic=0,nm=null,Error(r(185));for(var c=s.return;c!==null;)s=c,c=s.return;return s.tag===3?s.stateNode:null}var po={};function uf(s,c,p,x){this.tag=s,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function br(s,c,p,x){return new uf(s,c,p,x)}function mo(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ur(s,c){var p=s.alternate;return p===null?(p=br(s.tag,c,s.key,s.mode),p.elementType=s.elementType,p.type=s.type,p.stateNode=s.stateNode,p.alternate=s,s.alternate=p):(p.pendingProps=c,p.type=s.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=s.flags&65011712,p.childLanes=s.childLanes,p.lanes=s.lanes,p.child=s.child,p.memoizedProps=s.memoizedProps,p.memoizedState=s.memoizedState,p.updateQueue=s.updateQueue,c=s.dependencies,p.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},p.sibling=s.sibling,p.index=s.index,p.ref=s.ref,p.refCleanup=s.refCleanup,p}function Iu(s,c){s.flags&=65011714;var p=s.alternate;return p===null?(s.childLanes=0,s.lanes=c,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=p.childLanes,s.lanes=p.lanes,s.child=p.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=p.memoizedProps,s.memoizedState=p.memoizedState,s.updateQueue=p.updateQueue,s.type=p.type,c=p.dependencies,s.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),s}function df(s,c,p,x,N,D){var G=0;if(x=s,typeof s=="function")mo(s)&&(G=1);else if(typeof s=="string")G=wv(s,p,ce.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case z:return s=br(31,p,c,N),s.elementType=z,s.lanes=D,s;case S:return go(p.children,N,D,c);case k:G=8,N|=24;break;case T:return s=br(12,p,c,N|2),s.elementType=T,s.lanes=D,s;case F:return s=br(13,p,c,N),s.elementType=F,s.lanes=D,s;case O:return s=br(19,p,c,N),s.elementType=O,s.lanes=D,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case E:case I:G=10;break e;case P:G=9;break e;case V:G=11;break e;case B:G=14;break e;case U:G=16,x=null;break e}G=29,p=Error(r(130,s===null?"null":typeof s,"")),x=null}return c=br(G,p,c,N),c.elementType=s,c.type=x,c.lanes=D,c}function go(s,c,p,x){return s=br(7,s,x,c),s.lanes=p,s}function cp(s,c,p){return s=br(6,s,null,c),s.lanes=p,s}function fc(s,c,p){return c=br(4,s.children!==null?s.children:[],s.key,c),c.lanes=p,c.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},c}var _s=[],ml=0,ff=null,Mu=0,na=[],ia=0,Qn=null,Zn=1,ks="";function yo(s,c){_s[ml++]=Mu,_s[ml++]=ff,ff=s,Mu=c}function up(s,c,p){na[ia++]=Zn,na[ia++]=ks,na[ia++]=Qn,Qn=s;var x=Zn;s=ks;var N=32-be(x)-1;x&=~(1<<N),p+=1;var D=32-be(c)+N;if(30<D){var G=N-N%5;D=(x&(1<<G)-1).toString(32),x>>=G,N-=G,Zn=1<<32-be(c)+N|p<<N|x,ks=D+s}else Zn=1<<D|p<<N|x,ks=s}function dp(s){s.return!==null&&(yo(s,1),up(s,1,0))}function Ru(s){for(;s===ff;)ff=_s[--ml],_s[ml]=null,Mu=_s[--ml],_s[ml]=null;for(;s===Qn;)Qn=na[--ia],na[ia]=null,ks=na[--ia],na[ia]=null,Zn=na[--ia],na[ia]=null}var Ai=null,ei=null,ln=!1,ka=null,vr=!1,hc=Error(r(519));function ra(s){var c=Error(r(418,""));throw gl(pi(c,s)),hc}function vg(s){var c=s.stateNode,p=s.type,x=s.memoizedProps;switch(c[Ln]=s,c[oi]=x,p){case"dialog":nn("cancel",c),nn("close",c);break;case"iframe":case"object":case"embed":nn("load",c);break;case"video":case"audio":for(p=0;p<Sd.length;p++)nn(Sd[p],c);break;case"source":nn("error",c);break;case"img":case"image":case"link":nn("error",c),nn("load",c);break;case"details":nn("toggle",c);break;case"input":nn("invalid",c),nl(c,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),Kl(c);break;case"select":nn("invalid",c);break;case"textarea":nn("invalid",c),xs(c,x.value,x.defaultValue,x.children),Kl(c)}p=x.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||c.textContent===""+p||x.suppressHydrationWarning===!0||qy(c.textContent,p)?(x.popover!=null&&(nn("beforetoggle",c),nn("toggle",c)),x.onScroll!=null&&nn("scroll",c),x.onScrollEnd!=null&&nn("scrollend",c),x.onClick!=null&&(c.onclick=nh),c=!0):c=!1,c||ra(s)}function wg(s){for(Ai=s.return;Ai;)switch(Ai.tag){case 5:case 13:vr=!1;return;case 27:case 3:vr=!0;return;default:Ai=Ai.return}}function Lu(s){if(s!==Ai)return!1;if(!ln)return wg(s),ln=!0,!1;var c=s.tag,p;if((p=c!==3&&c!==27)&&((p=c===5)&&(p=s.type,p=!(p!=="form"&&p!=="button")||rh(s.type,s.memoizedProps)),p=!p),p&&ei&&ra(s),wg(s),c===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,c=0;s;){if(s.nodeType===8)if(p=s.data,p==="/$"){if(c===0){ei=Ia(s.nextSibling);break e}c--}else p!=="$"&&p!=="$!"&&p!=="$?"||c++;s=s.nextSibling}ei=null}}else c===27?(c=ei,ua(s.type)?(s=gm,gm=null,ei=s):ei=c):ei=Ai?Ia(s.stateNode.nextSibling):null;return!0}function Ou(){ei=Ai=null,ln=!1}function Ng(){var s=ka;return s!==null&&(Er===null?Er=s:Er.push.apply(Er,s),ka=null),s}function gl(s){ka===null?ka=[s]:ka.push(s)}var xo=ie(null),yl=null,K=null;function zr(s,c,p){M(xo,c._currentValue),c._currentValue=p}function aa(s){s._currentValue=xo.current,se(xo)}function wr(s,c,p){for(;s!==null;){var x=s.alternate;if((s.childLanes&c)!==c?(s.childLanes|=c,x!==null&&(x.childLanes|=c)):x!==null&&(x.childLanes&c)!==c&&(x.childLanes|=c),s===p)break;s=s.return}}function Xt(s,c,p,x){var N=s.child;for(N!==null&&(N.return=s);N!==null;){var D=N.dependencies;if(D!==null){var G=N.child;D=D.firstContext;e:for(;D!==null;){var X=D;D=N;for(var ye=0;ye<c.length;ye++)if(X.context===c[ye]){D.lanes|=p,X=D.alternate,X!==null&&(X.lanes|=p),wr(D.return,p,s),x||(G=null);break e}D=X.next}}else if(N.tag===18){if(G=N.return,G===null)throw Error(r(341));G.lanes|=p,D=G.alternate,D!==null&&(D.lanes|=p),wr(G,p,s),G=null}else G=N.child;if(G!==null)G.return=N;else for(G=N;G!==null;){if(G===s){G=null;break}if(N=G.sibling,N!==null){N.return=G.return,G=N;break}G=G.return}N=G}}function Fu(s,c,p,x){s=null;for(var N=c,D=!1;N!==null;){if(!D){if((N.flags&524288)!==0)D=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var G=N.alternate;if(G===null)throw Error(r(387));if(G=G.memoizedProps,G!==null){var X=N.type;or(N.pendingProps.value,G.value)||(s!==null?s.push(X):s=[X])}}else if(N===xe.current){if(G=N.alternate,G===null)throw Error(r(387));G.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(s!==null?s.push(Bc):s=[Bc])}N=N.return}s!==null&&Xt(c,s,p,x),c.flags|=262144}function hf(s){for(s=s.firstContext;s!==null;){if(!or(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function bo(s){yl=s,K=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function mi(s){return Sg(yl,s)}function pf(s,c){return yl===null&&bo(s),Sg(s,c)}function Sg(s,c){var p=c._currentValue;if(c={context:c,memoizedValue:p,next:null},K===null){if(s===null)throw Error(r(308));K=c,s.dependencies={lanes:0,firstContext:c},s.flags|=524288}else K=K.next=c;return p}var Hb=typeof AbortController<"u"?AbortController:function(){var s=[],c=this.signal={aborted:!1,addEventListener:function(p,x){s.push(x)}};this.abort=function(){c.aborted=!0,s.forEach(function(p){return p()})}},Gb=e.unstable_scheduleCallback,Yb=e.unstable_NormalPriority,On={$$typeof:I,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function fp(){return{controller:new Hb,data:new Map,refCount:0}}function $u(s){s.refCount--,s.refCount===0&&Gb(Yb,function(){s.controller.abort()})}var zu=null,hp=0,pc=0,Nr=null;function Wb(s,c){if(zu===null){var p=zu=[];hp=0,pc=eh(),Nr={status:"pending",value:void 0,then:function(x){p.push(x)}}}return hp++,c.then(jg,jg),c}function jg(){if(--hp===0&&zu!==null){Nr!==null&&(Nr.status="fulfilled");var s=zu;zu=null,pc=0,Nr=null;for(var c=0;c<s.length;c++)(0,s[c])()}}function Qb(s,c){var p=[],x={status:"pending",value:null,reason:null,then:function(N){p.push(N)}};return s.then(function(){x.status="fulfilled",x.value=c;for(var N=0;N<p.length;N++)(0,p[N])(c)},function(N){for(x.status="rejected",x.reason=N,N=0;N<p.length;N++)(0,p[N])(void 0)}),x}var Cg=Q.S;Q.S=function(s,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&Wb(s,c),Cg!==null&&Cg(s,c)};var vo=ie(null);function Es(){var s=vo.current;return s!==null?s:qn.pooledCache}function mf(s,c){c===null?M(vo,vo.current):M(vo,c.pool)}function _g(){var s=Es();return s===null?null:{parent:On._currentValue,pool:s}}var dr=Error(r(460)),kg=Error(r(474)),gf=Error(r(542)),pp={then:function(){}};function Eg(s){return s=s.status,s==="fulfilled"||s==="rejected"}function yf(){}function mp(s,c,p){switch(p=s[p],p===void 0?s.push(c):p!==c&&(c.then(yf,yf),c=p),c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,Ag(s),s;default:if(typeof c.status=="string")c.then(yf,yf);else{if(s=qn,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=c,s.status="pending",s.then(function(x){if(c.status==="pending"){var N=c;N.status="fulfilled",N.value=x}},function(x){if(c.status==="pending"){var N=c;N.status="rejected",N.reason=x}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,Ag(s),s}throw mc=c,dr}}var mc=null;function Tg(){if(mc===null)throw Error(r(459));var s=mc;return mc=null,s}function Ag(s){if(s===dr||s===gf)throw Error(r(483))}var ts=!1;function wo(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function gc(s,c){s=s.updateQueue,c.updateQueue===s&&(c.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function xl(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ts(s,c,p){var x=s.updateQueue;if(x===null)return null;if(x=x.shared,(_n&2)!==0){var N=x.pending;return N===null?c.next=c:(c.next=N.next,N.next=c),x.pending=c,c=Pu(s),Du(s,null,p),c}return _a(s,x,c,p),Pu(s)}function Bu(s,c,p){if(c=c.updateQueue,c!==null&&(c=c.shared,(p&4194048)!==0)){var x=c.lanes;x&=s.pendingLanes,p|=x,c.lanes=p,Ei(s,p)}}function Ea(s,c){var p=s.updateQueue,x=s.alternate;if(x!==null&&(x=x.updateQueue,p===x)){var N=null,D=null;if(p=p.firstBaseUpdate,p!==null){do{var G={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};D===null?N=D=G:D=D.next=G,p=p.next}while(p!==null);D===null?N=D=c:D=D.next=c}else N=D=c;p={baseState:x.baseState,firstBaseUpdate:N,lastBaseUpdate:D,shared:x.shared,callbacks:x.callbacks},s.updateQueue=p;return}s=p.lastBaseUpdate,s===null?p.firstBaseUpdate=c:s.next=c,p.lastBaseUpdate=c}var Uu=!1;function Ta(){if(Uu){var s=Nr;if(s!==null)throw s}}function tr(s,c,p,x){Uu=!1;var N=s.updateQueue;ts=!1;var D=N.firstBaseUpdate,G=N.lastBaseUpdate,X=N.shared.pending;if(X!==null){N.shared.pending=null;var ye=X,Pe=ye.next;ye.next=null,G===null?D=Pe:G.next=Pe,G=ye;var Ye=s.alternate;Ye!==null&&(Ye=Ye.updateQueue,X=Ye.lastBaseUpdate,X!==G&&(X===null?Ye.firstBaseUpdate=Pe:X.next=Pe,Ye.lastBaseUpdate=ye))}if(D!==null){var Ze=N.baseState;G=0,Ye=Pe=ye=null,X=D;do{var Oe=X.lane&-536870913,Ie=Oe!==X.lane;if(Ie?(pn&Oe)===Oe:(x&Oe)===Oe){Oe!==0&&Oe===pc&&(Uu=!0),Ye!==null&&(Ye=Ye.next={lane:0,tag:X.tag,payload:X.payload,callback:null,next:null});e:{var Tt=s,kt=X;Oe=c;var In=p;switch(kt.tag){case 1:if(Tt=kt.payload,typeof Tt=="function"){Ze=Tt.call(In,Ze,Oe);break e}Ze=Tt;break e;case 3:Tt.flags=Tt.flags&-65537|128;case 0:if(Tt=kt.payload,Oe=typeof Tt=="function"?Tt.call(In,Ze,Oe):Tt,Oe==null)break e;Ze=h({},Ze,Oe);break e;case 2:ts=!0}}Oe=X.callback,Oe!==null&&(s.flags|=64,Ie&&(s.flags|=8192),Ie=N.callbacks,Ie===null?N.callbacks=[Oe]:Ie.push(Oe))}else Ie={lane:Oe,tag:X.tag,payload:X.payload,callback:X.callback,next:null},Ye===null?(Pe=Ye=Ie,ye=Ze):Ye=Ye.next=Ie,G|=Oe;if(X=X.next,X===null){if(X=N.shared.pending,X===null)break;Ie=X,X=Ie.next,Ie.next=null,N.lastBaseUpdate=Ie,N.shared.pending=null}}while(!0);Ye===null&&(ye=Ze),N.baseState=ye,N.firstBaseUpdate=Pe,N.lastBaseUpdate=Ye,D===null&&(N.shared.lanes=0),kl|=G,s.lanes=G,s.memoizedState=Ze}}function Dg(s,c){if(typeof s!="function")throw Error(r(191,s));s.call(c)}function gp(s,c){var p=s.callbacks;if(p!==null)for(s.callbacks=null,s=0;s<p.length;s++)Dg(p[s],c)}var No=ie(null),bl=ie(0);function As(s,c){s=$s,M(bl,s),M(No,c),$s=s|c.baseLanes}function xf(){M(bl,$s),M(No,No.current)}function yp(){$s=bl.current,se(No),se(bl)}var Aa=0,Wt=null,Cn=null,on=null,yc=!1,So=!1,nr=!1,xc=0,vl=0,sa=null,Pg=0;function cn(){throw Error(r(321))}function qu(s,c){if(c===null)return!1;for(var p=0;p<c.length&&p<s.length;p++)if(!or(s[p],c[p]))return!1;return!0}function xp(s,c,p,x,N,D){return Aa=D,Wt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Q.H=s===null||s.memoizedState===null?Hg:Lp,nr=!1,D=p(x,N),nr=!1,So&&(D=Mg(c,p,x,N)),Ig(s),D}function Ig(s){Q.H=ed;var c=Cn!==null&&Cn.next!==null;if(Aa=0,on=Cn=Wt=null,yc=!1,vl=0,sa=null,c)throw Error(r(300));s===null||Fi||(s=s.dependencies,s!==null&&hf(s)&&(Fi=!0))}function Mg(s,c,p,x){Wt=s;var N=0;do{if(So&&(sa=null),vl=0,So=!1,25<=N)throw Error(r(301));if(N+=1,on=Cn=null,s.updateQueue!=null){var D=s.updateQueue;D.lastEffect=null,D.events=null,D.stores=null,D.memoCache!=null&&(D.memoCache.index=0)}Q.H=Gg,D=c(p,x)}while(So);return D}function bp(){var s=Q.H,c=s.useState()[0];return c=typeof c.then=="function"?Vu(c):c,s=s.useState()[0],(Cn!==null?Cn.memoizedState:null)!==s&&(Wt.flags|=1024),c}function vp(){var s=xc!==0;return xc=0,s}function jo(s,c,p){c.updateQueue=s.updateQueue,c.flags&=-2053,s.lanes&=~p}function bf(s){if(yc){for(s=s.memoizedState;s!==null;){var c=s.queue;c!==null&&(c.pending=null),s=s.next}yc=!1}Aa=0,on=Cn=Wt=null,So=!1,vl=xc=0,sa=null}function Sr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return on===null?Wt.memoizedState=on=s:on=on.next=s,on}function Ci(){if(Cn===null){var s=Wt.alternate;s=s!==null?s.memoizedState:null}else s=Cn.next;var c=on===null?Wt.memoizedState:on.next;if(c!==null)on=c,Cn=s;else{if(s===null)throw Wt.alternate===null?Error(r(467)):Error(r(310));Cn=s,s={memoizedState:Cn.memoizedState,baseState:Cn.baseState,baseQueue:Cn.baseQueue,queue:Cn.queue,next:null},on===null?Wt.memoizedState=on=s:on=on.next=s}return on}function Co(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Vu(s){var c=vl;return vl+=1,sa===null&&(sa=[]),s=mp(sa,s,c),c=Wt,(on===null?c.memoizedState:on.next)===null&&(c=c.alternate,Q.H=c===null||c.memoizedState===null?Hg:Lp),s}function vf(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Vu(s);if(s.$$typeof===I)return mi(s)}throw Error(r(438,String(s)))}function Hu(s){var c=null,p=Wt.updateQueue;if(p!==null&&(c=p.memoCache),c==null){var x=Wt.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(c={data:x.data.map(function(N){return N.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),p===null&&(p=Co(),Wt.updateQueue=p),p.memoCache=c,p=c.data[c.index],p===void 0)for(p=c.data[c.index]=Array(s),x=0;x<s;x++)p[x]=$;return c.index++,p}function ns(s,c){return typeof c=="function"?c(s):c}function wf(s){var c=Ci();return wp(c,Cn,s)}function wp(s,c,p){var x=s.queue;if(x===null)throw Error(r(311));x.lastRenderedReducer=p;var N=s.baseQueue,D=x.pending;if(D!==null){if(N!==null){var G=N.next;N.next=D.next,D.next=G}c.baseQueue=N=D,x.pending=null}if(D=s.baseState,N===null)s.memoizedState=D;else{c=N.next;var X=G=null,ye=null,Pe=c,Ye=!1;do{var Ze=Pe.lane&-536870913;if(Ze!==Pe.lane?(pn&Ze)===Ze:(Aa&Ze)===Ze){var Oe=Pe.revertLane;if(Oe===0)ye!==null&&(ye=ye.next={lane:0,revertLane:0,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null}),Ze===pc&&(Ye=!0);else if((Aa&Oe)===Oe){Pe=Pe.next,Oe===pc&&(Ye=!0);continue}else Ze={lane:0,revertLane:Pe.revertLane,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null},ye===null?(X=ye=Ze,G=D):ye=ye.next=Ze,Wt.lanes|=Oe,kl|=Oe;Ze=Pe.action,nr&&p(D,Ze),D=Pe.hasEagerState?Pe.eagerState:p(D,Ze)}else Oe={lane:Ze,revertLane:Pe.revertLane,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null},ye===null?(X=ye=Oe,G=D):ye=ye.next=Oe,Wt.lanes|=Ze,kl|=Ze;Pe=Pe.next}while(Pe!==null&&Pe!==c);if(ye===null?G=D:ye.next=X,!or(D,s.memoizedState)&&(Fi=!0,Ye&&(p=Nr,p!==null)))throw p;s.memoizedState=D,s.baseState=G,s.baseQueue=ye,x.lastRenderedState=D}return N===null&&(x.lanes=0),[s.memoizedState,x.dispatch]}function Np(s){var c=Ci(),p=c.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=s;var x=p.dispatch,N=p.pending,D=c.memoizedState;if(N!==null){p.pending=null;var G=N=N.next;do D=s(D,G.action),G=G.next;while(G!==N);or(D,c.memoizedState)||(Fi=!0),c.memoizedState=D,c.baseQueue===null&&(c.baseState=D),p.lastRenderedState=D}return[D,x]}function Sp(s,c,p){var x=Wt,N=Ci(),D=ln;if(D){if(p===void 0)throw Error(r(407));p=p()}else p=c();var G=!or((Cn||N).memoizedState,p);G&&(N.memoizedState=p,Fi=!0),N=N.queue;var X=Sf.bind(null,x,N,s);if(Wu(2048,8,X,[s]),N.getSnapshot!==c||G||on!==null&&on.memoizedState.tag&1){if(x.flags|=2048,bc(9,Ef(),Rg.bind(null,x,N,p,c),null),qn===null)throw Error(r(349));D||(Aa&124)!==0||Nf(x,c,p)}return p}function Nf(s,c,p){s.flags|=16384,s={getSnapshot:c,value:p},c=Wt.updateQueue,c===null?(c=Co(),Wt.updateQueue=c,c.stores=[s]):(p=c.stores,p===null?c.stores=[s]:p.push(s))}function Rg(s,c,p,x){c.value=p,c.getSnapshot=x,jp(c)&&Cp(s)}function Sf(s,c,p){return p(function(){jp(c)&&Cp(s)})}function jp(s){var c=s.getSnapshot;s=s.value;try{var p=c();return!or(s,p)}catch{return!0}}function Cp(s){var c=ho(s,2);c!==null&&Hr(c,s,2)}function jf(s){var c=Sr();if(typeof s=="function"){var p=s;if(s=p(),nr){Be(!0);try{p()}finally{Be(!1)}}}return c.memoizedState=c.baseState=s,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ns,lastRenderedState:s},c}function Gu(s,c,p,x){return s.baseState=p,wp(s,Cn,typeof x=="function"?x:ns)}function Jb(s,c,p,x,N){if(Pf(s))throw Error(r(485));if(s=c.action,s!==null){var D={payload:N,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(G){D.listeners.push(G)}};Q.T!==null?p(!0):D.isTransition=!1,x(D),p=c.pending,p===null?(D.next=c.pending=D,_p(c,D)):(D.next=p.next,c.pending=p.next=D)}}function _p(s,c){var p=c.action,x=c.payload,N=s.state;if(c.isTransition){var D=Q.T,G={};Q.T=G;try{var X=p(N,x),ye=Q.S;ye!==null&&ye(G,X),kp(s,c,X)}catch(Pe){Cf(s,c,Pe)}finally{Q.T=D}}else try{D=p(N,x),kp(s,c,D)}catch(Pe){Cf(s,c,Pe)}}function kp(s,c,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(x){Lg(s,c,x)},function(x){return Cf(s,c,x)}):Lg(s,c,p)}function Lg(s,c,p){c.status="fulfilled",c.value=p,Og(c),s.state=p,c=s.pending,c!==null&&(p=c.next,p===c?s.pending=null:(p=p.next,c.next=p,_p(s,p)))}function Cf(s,c,p){var x=s.pending;if(s.pending=null,x!==null){x=x.next;do c.status="rejected",c.reason=p,Og(c),c=c.next;while(c!==x)}s.action=null}function Og(s){s=s.listeners;for(var c=0;c<s.length;c++)(0,s[c])()}function _f(s,c){return c}function Ep(s,c){if(ln){var p=qn.formState;if(p!==null){e:{var x=Wt;if(ln){if(ei){t:{for(var N=ei,D=vr;N.nodeType!==8;){if(!D){N=null;break t}if(N=Ia(N.nextSibling),N===null){N=null;break t}}D=N.data,N=D==="F!"||D==="F"?N:null}if(N){ei=Ia(N.nextSibling),x=N.data==="F!";break e}}ra(x)}x=!1}x&&(c=p[0])}}return p=Sr(),p.memoizedState=p.baseState=c,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_f,lastRenderedState:c},p.queue=x,p=Ip.bind(null,Wt,x),x.dispatch=p,x=jf(!1),D=Mp.bind(null,Wt,!1,x.queue),x=Sr(),N={state:c,dispatch:null,action:s,pending:null},x.queue=N,p=Jb.bind(null,Wt,N,D,p),N.dispatch=p,x.memoizedState=s,[c,p,!1]}function kf(s){var c=Ci();return Fg(c,Cn,s)}function Fg(s,c,p){if(c=wp(s,c,_f)[0],s=wf(ns)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var x=Vu(c)}catch(G){throw G===dr?gf:G}else x=c;c=Ci();var N=c.queue,D=N.dispatch;return p!==c.memoizedState&&(Wt.flags|=2048,bc(9,Ef(),Tp.bind(null,N,p),null)),[x,D,s]}function Tp(s,c){s.action=c}function Gt(s){var c=Ci(),p=Cn;if(p!==null)return Fg(c,p,s);Ci(),c=c.memoizedState,p=Ci();var x=p.queue.dispatch;return p.memoizedState=s,[c,x,!1]}function bc(s,c,p,x){return s={tag:s,create:p,deps:x,inst:c,next:null},c=Wt.updateQueue,c===null&&(c=Co(),Wt.updateQueue=c),p=c.lastEffect,p===null?c.lastEffect=s.next=s:(x=p.next,p.next=s,s.next=x,c.lastEffect=s),s}function Ef(){return{destroy:void 0,resource:void 0}}function vc(){return Ci().memoizedState}function Yu(s,c,p,x){var N=Sr();x=x===void 0?null:x,Wt.flags|=s,N.memoizedState=bc(1|c,Ef(),p,x)}function Wu(s,c,p,x){var N=Ci();x=x===void 0?null:x;var D=N.memoizedState.inst;Cn!==null&&x!==null&&qu(x,Cn.memoizedState.deps)?N.memoizedState=bc(c,D,p,x):(Wt.flags|=s,N.memoizedState=bc(1|c,D,p,x))}function $g(s,c){Yu(8390656,8,s,c)}function Br(s,c){Wu(2048,8,s,c)}function zg(s,c){return Wu(4,2,s,c)}function Qu(s,c){return Wu(4,4,s,c)}function Tf(s,c){if(typeof c=="function"){s=s();var p=c(s);return function(){typeof p=="function"?p():c(null)}}if(c!=null)return s=s(),c.current=s,function(){c.current=null}}function Ap(s,c,p){p=p!=null?p.concat([s]):null,Wu(4,4,Tf.bind(null,c,s),p)}function Af(){}function jr(s,c){var p=Ci();c=c===void 0?null:c;var x=p.memoizedState;return c!==null&&qu(c,x[1])?x[0]:(p.memoizedState=[s,c],s)}function Ds(s,c){var p=Ci();c=c===void 0?null:c;var x=p.memoizedState;if(c!==null&&qu(c,x[1]))return x[0];if(x=s(),nr){Be(!0);try{s()}finally{Be(!1)}}return p.memoizedState=[x,c],x}function Ju(s,c,p){return p===void 0||(Aa&1073741824)!==0?s.memoizedState=c:(s.memoizedState=p,s=by(),Wt.lanes|=s,kl|=s,p)}function Dp(s,c,p,x){return or(p,c)?p:No.current!==null?(s=Ju(s,p,x),or(s,c)||(Fi=!0),s):(Aa&42)===0?(Fi=!0,s.memoizedState=p):(s=by(),Wt.lanes|=s,kl|=s,c)}function Ku(s,c,p,x,N){var D=q.p;q.p=D!==0&&8>D?D:8;var G=Q.T,X={};Q.T=X,Mp(s,!1,c,p);try{var ye=N(),Pe=Q.S;if(Pe!==null&&Pe(X,ye),ye!==null&&typeof ye=="object"&&typeof ye.then=="function"){var Ye=Qb(ye,x);_o(s,c,Ye,rr(s))}else _o(s,c,x,rr(s))}catch(Ze){_o(s,c,{then:function(){},status:"rejected",reason:Ze},rr())}finally{q.p=D,Q.T=G}}function Bg(){}function Xu(s,c,p,x){if(s.tag!==5)throw Error(r(476));var N=Pp(s).queue;Ku(s,N,c,W,p===null?Bg:function(){return Df(s),p(x)})}function Pp(s){var c=s.memoizedState;if(c!==null)return c;c={memoizedState:W,baseState:W,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ns,lastRenderedState:W},next:null};var p={};return c.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ns,lastRenderedState:p},next:null},s.memoizedState=c,s=s.alternate,s!==null&&(s.memoizedState=c),c}function Df(s){var c=Pp(s).next.queue;_o(s,c,{},rr())}function Zu(){return mi(Bc)}function Ps(){return Ci().memoizedState}function Ug(){return Ci().memoizedState}function wl(s){for(var c=s.return;c!==null;){switch(c.tag){case 24:case 3:var p=rr();s=xl(p);var x=Ts(c,s,p);x!==null&&(Hr(x,c,p),Bu(x,c,p)),c={cache:fp()},s.payload=c;return}c=c.return}}function qg(s,c,p){var x=rr();p={lane:x,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},Pf(s)?Vg(c,p):(p=dc(s,c,p,x),p!==null&&(Hr(p,s,x),Rp(p,c,x)))}function Ip(s,c,p){var x=rr();_o(s,c,p,x)}function _o(s,c,p,x){var N={lane:x,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(Pf(s))Vg(c,N);else{var D=s.alternate;if(s.lanes===0&&(D===null||D.lanes===0)&&(D=c.lastRenderedReducer,D!==null))try{var G=c.lastRenderedState,X=D(G,p);if(N.hasEagerState=!0,N.eagerState=X,or(X,G))return _a(s,c,N,0),qn===null&&fo(),!1}catch{}finally{}if(p=dc(s,c,N,x),p!==null)return Hr(p,s,x),Rp(p,c,x),!0}return!1}function Mp(s,c,p,x){if(x={lane:2,revertLane:eh(),action:x,hasEagerState:!1,eagerState:null,next:null},Pf(s)){if(c)throw Error(r(479))}else c=dc(s,p,x,2),c!==null&&Hr(c,s,2)}function Pf(s){var c=s.alternate;return s===Wt||c!==null&&c===Wt}function Vg(s,c){So=yc=!0;var p=s.pending;p===null?c.next=c:(c.next=p.next,p.next=c),s.pending=c}function Rp(s,c,p){if((p&4194048)!==0){var x=c.lanes;x&=s.pendingLanes,p|=x,c.lanes=p,Ei(s,p)}}var ed={readContext:mi,use:vf,useCallback:cn,useContext:cn,useEffect:cn,useImperativeHandle:cn,useLayoutEffect:cn,useInsertionEffect:cn,useMemo:cn,useReducer:cn,useRef:cn,useState:cn,useDebugValue:cn,useDeferredValue:cn,useTransition:cn,useSyncExternalStore:cn,useId:cn,useHostTransitionStatus:cn,useFormState:cn,useActionState:cn,useOptimistic:cn,useMemoCache:cn,useCacheRefresh:cn},Hg={readContext:mi,use:vf,useCallback:function(s,c){return Sr().memoizedState=[s,c===void 0?null:c],s},useContext:mi,useEffect:$g,useImperativeHandle:function(s,c,p){p=p!=null?p.concat([s]):null,Yu(4194308,4,Tf.bind(null,c,s),p)},useLayoutEffect:function(s,c){return Yu(4194308,4,s,c)},useInsertionEffect:function(s,c){Yu(4,2,s,c)},useMemo:function(s,c){var p=Sr();c=c===void 0?null:c;var x=s();if(nr){Be(!0);try{s()}finally{Be(!1)}}return p.memoizedState=[x,c],x},useReducer:function(s,c,p){var x=Sr();if(p!==void 0){var N=p(c);if(nr){Be(!0);try{p(c)}finally{Be(!1)}}}else N=c;return x.memoizedState=x.baseState=N,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:N},x.queue=s,s=s.dispatch=qg.bind(null,Wt,s),[x.memoizedState,s]},useRef:function(s){var c=Sr();return s={current:s},c.memoizedState=s},useState:function(s){s=jf(s);var c=s.queue,p=Ip.bind(null,Wt,c);return c.dispatch=p,[s.memoizedState,p]},useDebugValue:Af,useDeferredValue:function(s,c){var p=Sr();return Ju(p,s,c)},useTransition:function(){var s=jf(!1);return s=Ku.bind(null,Wt,s.queue,!0,!1),Sr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,c,p){var x=Wt,N=Sr();if(ln){if(p===void 0)throw Error(r(407));p=p()}else{if(p=c(),qn===null)throw Error(r(349));(pn&124)!==0||Nf(x,c,p)}N.memoizedState=p;var D={value:p,getSnapshot:c};return N.queue=D,$g(Sf.bind(null,x,D,s),[s]),x.flags|=2048,bc(9,Ef(),Rg.bind(null,x,D,p,c),null),p},useId:function(){var s=Sr(),c=qn.identifierPrefix;if(ln){var p=ks,x=Zn;p=(x&~(1<<32-be(x)-1)).toString(32)+p,c=""+c+"R"+p,p=xc++,0<p&&(c+="H"+p.toString(32)),c+=""}else p=Pg++,c=""+c+"r"+p.toString(32)+"";return s.memoizedState=c},useHostTransitionStatus:Zu,useFormState:Ep,useActionState:Ep,useOptimistic:function(s){var c=Sr();c.memoizedState=c.baseState=s;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=p,c=Mp.bind(null,Wt,!0,p),p.dispatch=c,[s,c]},useMemoCache:Hu,useCacheRefresh:function(){return Sr().memoizedState=wl.bind(null,Wt)}},Lp={readContext:mi,use:vf,useCallback:jr,useContext:mi,useEffect:Br,useImperativeHandle:Ap,useInsertionEffect:zg,useLayoutEffect:Qu,useMemo:Ds,useReducer:wf,useRef:vc,useState:function(){return wf(ns)},useDebugValue:Af,useDeferredValue:function(s,c){var p=Ci();return Dp(p,Cn.memoizedState,s,c)},useTransition:function(){var s=wf(ns)[0],c=Ci().memoizedState;return[typeof s=="boolean"?s:Vu(s),c]},useSyncExternalStore:Sp,useId:Ps,useHostTransitionStatus:Zu,useFormState:kf,useActionState:kf,useOptimistic:function(s,c){var p=Ci();return Gu(p,Cn,s,c)},useMemoCache:Hu,useCacheRefresh:Ug},Gg={readContext:mi,use:vf,useCallback:jr,useContext:mi,useEffect:Br,useImperativeHandle:Ap,useInsertionEffect:zg,useLayoutEffect:Qu,useMemo:Ds,useReducer:Np,useRef:vc,useState:function(){return Np(ns)},useDebugValue:Af,useDeferredValue:function(s,c){var p=Ci();return Cn===null?Ju(p,s,c):Dp(p,Cn.memoizedState,s,c)},useTransition:function(){var s=Np(ns)[0],c=Ci().memoizedState;return[typeof s=="boolean"?s:Vu(s),c]},useSyncExternalStore:Sp,useId:Ps,useHostTransitionStatus:Zu,useFormState:Gt,useActionState:Gt,useOptimistic:function(s,c){var p=Ci();return Cn!==null?Gu(p,Cn,s,c):(p.baseState=s,[s,p.queue.dispatch])},useMemoCache:Hu,useCacheRefresh:Ug},Di=null,Cr=0;function If(s){var c=Cr;return Cr+=1,Di===null&&(Di=[]),mp(Di,s,c)}function td(s,c){c=c.props.ref,s.ref=c!==void 0?c:null}function ko(s,c){throw c.$$typeof===g?Error(r(525)):(s=Object.prototype.toString.call(c),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":s)))}function Eo(s){var c=s._init;return c(s._payload)}function Op(s){function c(ke,Se){if(s){var Te=ke.deletions;Te===null?(ke.deletions=[Se],ke.flags|=16):Te.push(Se)}}function p(ke,Se){if(!s)return null;for(;Se!==null;)c(ke,Se),Se=Se.sibling;return null}function x(ke){for(var Se=new Map;ke!==null;)ke.key!==null?Se.set(ke.key,ke):Se.set(ke.index,ke),ke=ke.sibling;return Se}function N(ke,Se){return ke=ur(ke,Se),ke.index=0,ke.sibling=null,ke}function D(ke,Se,Te){return ke.index=Te,s?(Te=ke.alternate,Te!==null?(Te=Te.index,Te<Se?(ke.flags|=67108866,Se):Te):(ke.flags|=67108866,Se)):(ke.flags|=1048576,Se)}function G(ke){return s&&ke.alternate===null&&(ke.flags|=67108866),ke}function X(ke,Se,Te,Qe){return Se===null||Se.tag!==6?(Se=cp(Te,ke.mode,Qe),Se.return=ke,Se):(Se=N(Se,Te),Se.return=ke,Se)}function ye(ke,Se,Te,Qe){var xt=Te.type;return xt===S?Ye(ke,Se,Te.props.children,Qe,Te.key):Se!==null&&(Se.elementType===xt||typeof xt=="object"&&xt!==null&&xt.$$typeof===U&&Eo(xt)===Se.type)?(Se=N(Se,Te.props),td(Se,Te),Se.return=ke,Se):(Se=df(Te.type,Te.key,Te.props,null,ke.mode,Qe),td(Se,Te),Se.return=ke,Se)}function Pe(ke,Se,Te,Qe){return Se===null||Se.tag!==4||Se.stateNode.containerInfo!==Te.containerInfo||Se.stateNode.implementation!==Te.implementation?(Se=fc(Te,ke.mode,Qe),Se.return=ke,Se):(Se=N(Se,Te.children||[]),Se.return=ke,Se)}function Ye(ke,Se,Te,Qe,xt){return Se===null||Se.tag!==7?(Se=go(Te,ke.mode,Qe,xt),Se.return=ke,Se):(Se=N(Se,Te),Se.return=ke,Se)}function Ze(ke,Se,Te){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return Se=cp(""+Se,ke.mode,Te),Se.return=ke,Se;if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case b:return Te=df(Se.type,Se.key,Se.props,null,ke.mode,Te),td(Te,Se),Te.return=ke,Te;case v:return Se=fc(Se,ke.mode,Te),Se.return=ke,Se;case U:var Qe=Se._init;return Se=Qe(Se._payload),Ze(ke,Se,Te)}if(te(Se)||H(Se))return Se=go(Se,ke.mode,Te,null),Se.return=ke,Se;if(typeof Se.then=="function")return Ze(ke,If(Se),Te);if(Se.$$typeof===I)return Ze(ke,pf(ke,Se),Te);ko(ke,Se)}return null}function Oe(ke,Se,Te,Qe){var xt=Se!==null?Se.key:null;if(typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint")return xt!==null?null:X(ke,Se,""+Te,Qe);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case b:return Te.key===xt?ye(ke,Se,Te,Qe):null;case v:return Te.key===xt?Pe(ke,Se,Te,Qe):null;case U:return xt=Te._init,Te=xt(Te._payload),Oe(ke,Se,Te,Qe)}if(te(Te)||H(Te))return xt!==null?null:Ye(ke,Se,Te,Qe,null);if(typeof Te.then=="function")return Oe(ke,Se,If(Te),Qe);if(Te.$$typeof===I)return Oe(ke,Se,pf(ke,Te),Qe);ko(ke,Te)}return null}function Ie(ke,Se,Te,Qe,xt){if(typeof Qe=="string"&&Qe!==""||typeof Qe=="number"||typeof Qe=="bigint")return ke=ke.get(Te)||null,X(Se,ke,""+Qe,xt);if(typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case b:return ke=ke.get(Qe.key===null?Te:Qe.key)||null,ye(Se,ke,Qe,xt);case v:return ke=ke.get(Qe.key===null?Te:Qe.key)||null,Pe(Se,ke,Qe,xt);case U:var Zt=Qe._init;return Qe=Zt(Qe._payload),Ie(ke,Se,Te,Qe,xt)}if(te(Qe)||H(Qe))return ke=ke.get(Te)||null,Ye(Se,ke,Qe,xt,null);if(typeof Qe.then=="function")return Ie(ke,Se,Te,If(Qe),xt);if(Qe.$$typeof===I)return Ie(ke,Se,Te,pf(Se,Qe),xt);ko(Se,Qe)}return null}function Tt(ke,Se,Te,Qe){for(var xt=null,Zt=null,vt=Se,At=Se=0,Bi=null;vt!==null&&At<Te.length;At++){vt.index>At?(Bi=vt,vt=null):Bi=vt.sibling;var gn=Oe(ke,vt,Te[At],Qe);if(gn===null){vt===null&&(vt=Bi);break}s&&vt&&gn.alternate===null&&c(ke,vt),Se=D(gn,Se,At),Zt===null?xt=gn:Zt.sibling=gn,Zt=gn,vt=Bi}if(At===Te.length)return p(ke,vt),ln&&yo(ke,At),xt;if(vt===null){for(;At<Te.length;At++)vt=Ze(ke,Te[At],Qe),vt!==null&&(Se=D(vt,Se,At),Zt===null?xt=vt:Zt.sibling=vt,Zt=vt);return ln&&yo(ke,At),xt}for(vt=x(vt);At<Te.length;At++)Bi=Ie(vt,ke,At,Te[At],Qe),Bi!==null&&(s&&Bi.alternate!==null&&vt.delete(Bi.key===null?At:Bi.key),Se=D(Bi,Se,At),Zt===null?xt=Bi:Zt.sibling=Bi,Zt=Bi);return s&&vt.forEach(function(Ol){return c(ke,Ol)}),ln&&yo(ke,At),xt}function kt(ke,Se,Te,Qe){if(Te==null)throw Error(r(151));for(var xt=null,Zt=null,vt=Se,At=Se=0,Bi=null,gn=Te.next();vt!==null&&!gn.done;At++,gn=Te.next()){vt.index>At?(Bi=vt,vt=null):Bi=vt.sibling;var Ol=Oe(ke,vt,gn.value,Qe);if(Ol===null){vt===null&&(vt=Bi);break}s&&vt&&Ol.alternate===null&&c(ke,vt),Se=D(Ol,Se,At),Zt===null?xt=Ol:Zt.sibling=Ol,Zt=Ol,vt=Bi}if(gn.done)return p(ke,vt),ln&&yo(ke,At),xt;if(vt===null){for(;!gn.done;At++,gn=Te.next())gn=Ze(ke,gn.value,Qe),gn!==null&&(Se=D(gn,Se,At),Zt===null?xt=gn:Zt.sibling=gn,Zt=gn);return ln&&yo(ke,At),xt}for(vt=x(vt);!gn.done;At++,gn=Te.next())gn=Ie(vt,ke,At,gn.value,Qe),gn!==null&&(s&&gn.alternate!==null&&vt.delete(gn.key===null?At:gn.key),Se=D(gn,Se,At),Zt===null?xt=gn:Zt.sibling=gn,Zt=gn);return s&&vt.forEach(function(Pv){return c(ke,Pv)}),ln&&yo(ke,At),xt}function In(ke,Se,Te,Qe){if(typeof Te=="object"&&Te!==null&&Te.type===S&&Te.key===null&&(Te=Te.props.children),typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case b:e:{for(var xt=Te.key;Se!==null;){if(Se.key===xt){if(xt=Te.type,xt===S){if(Se.tag===7){p(ke,Se.sibling),Qe=N(Se,Te.props.children),Qe.return=ke,ke=Qe;break e}}else if(Se.elementType===xt||typeof xt=="object"&&xt!==null&&xt.$$typeof===U&&Eo(xt)===Se.type){p(ke,Se.sibling),Qe=N(Se,Te.props),td(Qe,Te),Qe.return=ke,ke=Qe;break e}p(ke,Se);break}else c(ke,Se);Se=Se.sibling}Te.type===S?(Qe=go(Te.props.children,ke.mode,Qe,Te.key),Qe.return=ke,ke=Qe):(Qe=df(Te.type,Te.key,Te.props,null,ke.mode,Qe),td(Qe,Te),Qe.return=ke,ke=Qe)}return G(ke);case v:e:{for(xt=Te.key;Se!==null;){if(Se.key===xt)if(Se.tag===4&&Se.stateNode.containerInfo===Te.containerInfo&&Se.stateNode.implementation===Te.implementation){p(ke,Se.sibling),Qe=N(Se,Te.children||[]),Qe.return=ke,ke=Qe;break e}else{p(ke,Se);break}else c(ke,Se);Se=Se.sibling}Qe=fc(Te,ke.mode,Qe),Qe.return=ke,ke=Qe}return G(ke);case U:return xt=Te._init,Te=xt(Te._payload),In(ke,Se,Te,Qe)}if(te(Te))return Tt(ke,Se,Te,Qe);if(H(Te)){if(xt=H(Te),typeof xt!="function")throw Error(r(150));return Te=xt.call(Te),kt(ke,Se,Te,Qe)}if(typeof Te.then=="function")return In(ke,Se,If(Te),Qe);if(Te.$$typeof===I)return In(ke,Se,pf(ke,Te),Qe);ko(ke,Te)}return typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint"?(Te=""+Te,Se!==null&&Se.tag===6?(p(ke,Se.sibling),Qe=N(Se,Te),Qe.return=ke,ke=Qe):(p(ke,Se),Qe=cp(Te,ke.mode,Qe),Qe.return=ke,ke=Qe),G(ke)):p(ke,Se)}return function(ke,Se,Te,Qe){try{Cr=0;var xt=In(ke,Se,Te,Qe);return Di=null,xt}catch(vt){if(vt===dr||vt===gf)throw vt;var Zt=br(29,vt,null,ke.mode);return Zt.lanes=Qe,Zt.return=ke,Zt}finally{}}}var To=Op(!0),Yg=Op(!1),Ur=ie(null),fr=null;function la(s){var c=s.alternate;M(gi,gi.current&1),M(Ur,s),fr===null&&(c===null||No.current!==null||c.memoizedState!==null)&&(fr=s)}function Wg(s){if(s.tag===22){if(M(gi,gi.current),M(Ur,s),fr===null){var c=s.alternate;c!==null&&c.memoizedState!==null&&(fr=s)}}else Is()}function Is(){M(gi,gi.current),M(Ur,Ur.current)}function is(s){se(Ur),fr===s&&(fr=null),se(gi)}var gi=ie(0);function nd(s){for(var c=s;c!==null;){if(c.tag===13){var p=c.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||pr(p)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function wc(s,c,p,x){c=s.memoizedState,p=p(x,c),p=p==null?c:h({},c,p),s.memoizedState=p,s.lanes===0&&(s.updateQueue.baseState=p)}var id={enqueueSetState:function(s,c,p){s=s._reactInternals;var x=rr(),N=xl(x);N.payload=c,p!=null&&(N.callback=p),c=Ts(s,N,x),c!==null&&(Hr(c,s,x),Bu(c,s,x))},enqueueReplaceState:function(s,c,p){s=s._reactInternals;var x=rr(),N=xl(x);N.tag=1,N.payload=c,p!=null&&(N.callback=p),c=Ts(s,N,x),c!==null&&(Hr(c,s,x),Bu(c,s,x))},enqueueForceUpdate:function(s,c){s=s._reactInternals;var p=rr(),x=xl(p);x.tag=2,c!=null&&(x.callback=c),c=Ts(s,x,p),c!==null&&(Hr(c,s,p),Bu(c,s,p))}};function rd(s,c,p,x,N,D,G){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(x,D,G):c.prototype&&c.prototype.isPureReactComponent?!ea(p,x)||!ea(N,D):!0}function Qg(s,c,p,x){s=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(p,x),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(p,x),c.state!==s&&id.enqueueReplaceState(c,c.state,null)}function Nl(s,c){var p=c;if("ref"in c){p={};for(var x in c)x!=="ref"&&(p[x]=c[x])}if(s=s.defaultProps){p===c&&(p=h({},p));for(var N in s)p[N]===void 0&&(p[N]=s[N])}return p}var Ao=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Fp(s){Ao(s)}function Mf(s){console.error(s)}function Jg(s){Ao(s)}function ad(s,c){try{var p=s.onUncaughtError;p(c.value,{componentStack:c.stack})}catch(x){setTimeout(function(){throw x})}}function rs(s,c,p){try{var x=s.onCaughtError;x(p.value,{componentStack:p.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function Rf(s,c,p){return p=xl(p),p.tag=3,p.payload={element:null},p.callback=function(){ad(s,c)},p}function $p(s){return s=xl(s),s.tag=3,s}function Kg(s,c,p,x){var N=p.type.getDerivedStateFromError;if(typeof N=="function"){var D=x.value;s.payload=function(){return N(D)},s.callback=function(){rs(c,p,x)}}var G=p.stateNode;G!==null&&typeof G.componentDidCatch=="function"&&(s.callback=function(){rs(c,p,x),typeof N!="function"&&(El===null?El=new Set([this]):El.add(this));var X=x.stack;this.componentDidCatch(x.value,{componentStack:X!==null?X:""})})}function Xg(s,c,p,x,N){if(p.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(c=p.alternate,c!==null&&Fu(c,p,N,!0),p=Ur.current,p!==null){switch(p.tag){case 13:return fr===null?rm():p.alternate===null&&yi===0&&(yi=3),p.flags&=-257,p.flags|=65536,p.lanes=N,x===pp?p.flags|=16384:(c=p.updateQueue,c===null?p.updateQueue=new Set([x]):c.add(x),lm(s,x,N)),!1;case 22:return p.flags|=65536,x===pp?p.flags|=16384:(c=p.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([x])},p.updateQueue=c):(p=c.retryQueue,p===null?c.retryQueue=new Set([x]):p.add(x)),lm(s,x,N)),!1}throw Error(r(435,p.tag))}return lm(s,x,N),rm(),!1}if(ln)return c=Ur.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=N,x!==hc&&(s=Error(r(422),{cause:x}),gl(pi(s,p)))):(x!==hc&&(c=Error(r(423),{cause:x}),gl(pi(c,p))),s=s.current.alternate,s.flags|=65536,N&=-N,s.lanes|=N,x=pi(x,p),N=Rf(s.stateNode,x,N),Ea(s,N),yi!==4&&(yi=2)),!1;var D=Error(r(520),{cause:x});if(D=pi(D,p),md===null?md=[D]:md.push(D),yi!==4&&(yi=2),c===null)return!0;x=pi(x,p),p=c;do{switch(p.tag){case 3:return p.flags|=65536,s=N&-N,p.lanes|=s,s=Rf(p.stateNode,x,s),Ea(p,s),!1;case 1:if(c=p.type,D=p.stateNode,(p.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(El===null||!El.has(D))))return p.flags|=65536,N&=-N,p.lanes|=N,N=$p(N),Kg(N,s,p,x),Ea(p,N),!1}p=p.return}while(p!==null);return!1}var Zg=Error(r(461)),Fi=!1;function Jn(s,c,p,x){c.child=s===null?Yg(c,null,p,x):To(c,s.child,p,x)}function Lf(s,c,p,x,N){p=p.render;var D=c.ref;if("ref"in x){var G={};for(var X in x)X!=="ref"&&(G[X]=x[X])}else G=x;return bo(c),x=xp(s,c,p,G,D,N),X=vp(),s!==null&&!Fi?(jo(s,c,N),Ms(s,c,N)):(ln&&X&&dp(c),c.flags|=1,Jn(s,c,x,N),c.child)}function Of(s,c,p,x,N){if(s===null){var D=p.type;return typeof D=="function"&&!mo(D)&&D.defaultProps===void 0&&p.compare===null?(c.tag=15,c.type=D,Ff(s,c,D,x,N)):(s=df(p.type,null,x,c,c.mode,N),s.ref=c.ref,s.return=c,c.child=s)}if(D=s.child,!Da(s,N)){var G=D.memoizedProps;if(p=p.compare,p=p!==null?p:ea,p(G,x)&&s.ref===c.ref)return Ms(s,c,N)}return c.flags|=1,s=ur(D,x),s.ref=c.ref,s.return=c,c.child=s}function Ff(s,c,p,x,N){if(s!==null){var D=s.memoizedProps;if(ea(D,x)&&s.ref===c.ref)if(Fi=!1,c.pendingProps=x=D,Da(s,N))(s.flags&131072)!==0&&(Fi=!0);else return c.lanes=s.lanes,Ms(s,c,N)}return Nc(s,c,p,x,N)}function sd(s,c,p){var x=c.pendingProps,N=x.children,D=s!==null?s.memoizedState:null;if(x.mode==="hidden"){if((c.flags&128)!==0){if(x=D!==null?D.baseLanes|p:p,s!==null){for(N=c.child=s.child,D=0;N!==null;)D=D|N.lanes|N.childLanes,N=N.sibling;c.childLanes=D&~x}else c.childLanes=0,c.child=null;return Do(s,c,x,p)}if((p&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},s!==null&&mf(c,D!==null?D.cachePool:null),D!==null?As(c,D):xf(),Wg(c);else return c.lanes=c.childLanes=536870912,Do(s,c,D!==null?D.baseLanes|p:p,p)}else D!==null?(mf(c,D.cachePool),As(c,D),Is(),c.memoizedState=null):(s!==null&&mf(c,null),xf(),Is());return Jn(s,c,N,p),c.child}function Do(s,c,p,x){var N=Es();return N=N===null?null:{parent:On._currentValue,pool:N},c.memoizedState={baseLanes:p,cachePool:N},s!==null&&mf(c,null),xf(),Wg(c),s!==null&&Fu(s,c,x,!0),null}function Nt(s,c){var p=c.ref;if(p===null)s!==null&&s.ref!==null&&(c.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(r(284));(s===null||s.ref!==p)&&(c.flags|=4194816)}}function Nc(s,c,p,x,N){return bo(c),p=xp(s,c,p,x,void 0,N),x=vp(),s!==null&&!Fi?(jo(s,c,N),Ms(s,c,N)):(ln&&x&&dp(c),c.flags|=1,Jn(s,c,p,N),c.child)}function $f(s,c,p,x,N,D){return bo(c),c.updateQueue=null,p=Mg(c,x,p,N),Ig(s),x=vp(),s!==null&&!Fi?(jo(s,c,D),Ms(s,c,D)):(ln&&x&&dp(c),c.flags|=1,Jn(s,c,p,D),c.child)}function Sl(s,c,p,x,N){if(bo(c),c.stateNode===null){var D=po,G=p.contextType;typeof G=="object"&&G!==null&&(D=mi(G)),D=new p(x,D),c.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,D.updater=id,c.stateNode=D,D._reactInternals=c,D=c.stateNode,D.props=x,D.state=c.memoizedState,D.refs={},wo(c),G=p.contextType,D.context=typeof G=="object"&&G!==null?mi(G):po,D.state=c.memoizedState,G=p.getDerivedStateFromProps,typeof G=="function"&&(wc(c,p,G,x),D.state=c.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(G=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),G!==D.state&&id.enqueueReplaceState(D,D.state,null),tr(c,x,D,N),Ta(),D.state=c.memoizedState),typeof D.componentDidMount=="function"&&(c.flags|=4194308),x=!0}else if(s===null){D=c.stateNode;var X=c.memoizedProps,ye=Nl(p,X);D.props=ye;var Pe=D.context,Ye=p.contextType;G=po,typeof Ye=="object"&&Ye!==null&&(G=mi(Ye));var Ze=p.getDerivedStateFromProps;Ye=typeof Ze=="function"||typeof D.getSnapshotBeforeUpdate=="function",X=c.pendingProps!==X,Ye||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(X||Pe!==G)&&Qg(c,D,x,G),ts=!1;var Oe=c.memoizedState;D.state=Oe,tr(c,x,D,N),Ta(),Pe=c.memoizedState,X||Oe!==Pe||ts?(typeof Ze=="function"&&(wc(c,p,Ze,x),Pe=c.memoizedState),(ye=ts||rd(c,p,ye,x,Oe,Pe,G))?(Ye||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(c.flags|=4194308)):(typeof D.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=x,c.memoizedState=Pe),D.props=x,D.state=Pe,D.context=G,x=ye):(typeof D.componentDidMount=="function"&&(c.flags|=4194308),x=!1)}else{D=c.stateNode,gc(s,c),G=c.memoizedProps,Ye=Nl(p,G),D.props=Ye,Ze=c.pendingProps,Oe=D.context,Pe=p.contextType,ye=po,typeof Pe=="object"&&Pe!==null&&(ye=mi(Pe)),X=p.getDerivedStateFromProps,(Pe=typeof X=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(G!==Ze||Oe!==ye)&&Qg(c,D,x,ye),ts=!1,Oe=c.memoizedState,D.state=Oe,tr(c,x,D,N),Ta();var Ie=c.memoizedState;G!==Ze||Oe!==Ie||ts||s!==null&&s.dependencies!==null&&hf(s.dependencies)?(typeof X=="function"&&(wc(c,p,X,x),Ie=c.memoizedState),(Ye=ts||rd(c,p,Ye,x,Oe,Ie,ye)||s!==null&&s.dependencies!==null&&hf(s.dependencies))?(Pe||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(x,Ie,ye),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(x,Ie,ye)),typeof D.componentDidUpdate=="function"&&(c.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof D.componentDidUpdate!="function"||G===s.memoizedProps&&Oe===s.memoizedState||(c.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||G===s.memoizedProps&&Oe===s.memoizedState||(c.flags|=1024),c.memoizedProps=x,c.memoizedState=Ie),D.props=x,D.state=Ie,D.context=ye,x=Ye):(typeof D.componentDidUpdate!="function"||G===s.memoizedProps&&Oe===s.memoizedState||(c.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||G===s.memoizedProps&&Oe===s.memoizedState||(c.flags|=1024),x=!1)}return D=x,Nt(s,c),x=(c.flags&128)!==0,D||x?(D=c.stateNode,p=x&&typeof p.getDerivedStateFromError!="function"?null:D.render(),c.flags|=1,s!==null&&x?(c.child=To(c,s.child,null,N),c.child=To(c,null,p,N)):Jn(s,c,p,N),c.memoizedState=D.state,s=c.child):s=Ms(s,c,N),s}function ey(s,c,p,x){return Ou(),c.flags|=256,Jn(s,c,p,x),c.child}var ld={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function zf(s){return{baseLanes:s,cachePool:_g()}}function $i(s,c,p){return s=s!==null?s.childLanes&~p:0,c&&(s|=ca),s}function ty(s,c,p){var x=c.pendingProps,N=!1,D=(c.flags&128)!==0,G;if((G=D)||(G=s!==null&&s.memoizedState===null?!1:(gi.current&2)!==0),G&&(N=!0,c.flags&=-129),G=(c.flags&32)!==0,c.flags&=-33,s===null){if(ln){if(N?la(c):Is(),ln){var X=ei,ye;if(ye=X){e:{for(ye=X,X=vr;ye.nodeType!==8;){if(!X){X=null;break e}if(ye=Ia(ye.nextSibling),ye===null){X=null;break e}}X=ye}X!==null?(c.memoizedState={dehydrated:X,treeContext:Qn!==null?{id:Zn,overflow:ks}:null,retryLane:536870912,hydrationErrors:null},ye=br(18,null,null,0),ye.stateNode=X,ye.return=c,c.child=ye,Ai=c,ei=null,ye=!0):ye=!1}ye||ra(c)}if(X=c.memoizedState,X!==null&&(X=X.dehydrated,X!==null))return pr(X)?c.lanes=32:c.lanes=536870912,null;is(c)}return X=x.children,x=x.fallback,N?(Is(),N=c.mode,X=od({mode:"hidden",children:X},N),x=go(x,N,p,null),X.return=c,x.return=c,X.sibling=x,c.child=X,N=c.child,N.memoizedState=zf(p),N.childLanes=$i(s,G,p),c.memoizedState=ld,x):(la(c),zp(c,X))}if(ye=s.memoizedState,ye!==null&&(X=ye.dehydrated,X!==null)){if(D)c.flags&256?(la(c),c.flags&=-257,c=Bp(s,c,p)):c.memoizedState!==null?(Is(),c.child=s.child,c.flags|=128,c=null):(Is(),N=x.fallback,X=c.mode,x=od({mode:"visible",children:x.children},X),N=go(N,X,p,null),N.flags|=2,x.return=c,N.return=c,x.sibling=N,c.child=x,To(c,s.child,null,p),x=c.child,x.memoizedState=zf(p),x.childLanes=$i(s,G,p),c.memoizedState=ld,c=N);else if(la(c),pr(X)){if(G=X.nextSibling&&X.nextSibling.dataset,G)var Pe=G.dgst;G=Pe,x=Error(r(419)),x.stack="",x.digest=G,gl({value:x,source:null,stack:null}),c=Bp(s,c,p)}else if(Fi||Fu(s,c,p,!1),G=(p&s.childLanes)!==0,Fi||G){if(G=qn,G!==null&&(x=p&-p,x=(x&42)!==0?1:Ti(x),x=(x&(G.suspendedLanes|p))!==0?0:x,x!==0&&x!==ye.retryLane))throw ye.retryLane=x,ho(s,x),Hr(G,s,x),Zg;X.data==="$?"||rm(),c=Bp(s,c,p)}else X.data==="$?"?(c.flags|=192,c.child=s.child,c=null):(s=ye.treeContext,ei=Ia(X.nextSibling),Ai=c,ln=!0,ka=null,vr=!1,s!==null&&(na[ia++]=Zn,na[ia++]=ks,na[ia++]=Qn,Zn=s.id,ks=s.overflow,Qn=c),c=zp(c,x.children),c.flags|=4096);return c}return N?(Is(),N=x.fallback,X=c.mode,ye=s.child,Pe=ye.sibling,x=ur(ye,{mode:"hidden",children:x.children}),x.subtreeFlags=ye.subtreeFlags&65011712,Pe!==null?N=ur(Pe,N):(N=go(N,X,p,null),N.flags|=2),N.return=c,x.return=c,x.sibling=N,c.child=x,x=N,N=c.child,X=s.child.memoizedState,X===null?X=zf(p):(ye=X.cachePool,ye!==null?(Pe=On._currentValue,ye=ye.parent!==Pe?{parent:Pe,pool:Pe}:ye):ye=_g(),X={baseLanes:X.baseLanes|p,cachePool:ye}),N.memoizedState=X,N.childLanes=$i(s,G,p),c.memoizedState=ld,x):(la(c),p=s.child,s=p.sibling,p=ur(p,{mode:"visible",children:x.children}),p.return=c,p.sibling=null,s!==null&&(G=c.deletions,G===null?(c.deletions=[s],c.flags|=16):G.push(s)),c.child=p,c.memoizedState=null,p)}function zp(s,c){return c=od({mode:"visible",children:c},s.mode),c.return=s,s.child=c}function od(s,c){return s=br(22,s,null,c),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Bp(s,c,p){return To(c,s.child,null,p),s=zp(c,c.pendingProps.children),s.flags|=2,c.memoizedState=null,s}function Up(s,c,p){s.lanes|=c;var x=s.alternate;x!==null&&(x.lanes|=c),wr(s.return,c,p)}function qp(s,c,p,x,N){var D=s.memoizedState;D===null?s.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:x,tail:p,tailMode:N}:(D.isBackwards=c,D.rendering=null,D.renderingStartTime=0,D.last=x,D.tail=p,D.tailMode=N)}function ny(s,c,p){var x=c.pendingProps,N=x.revealOrder,D=x.tail;if(Jn(s,c,x.children,p),x=gi.current,(x&2)!==0)x=x&1|2,c.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=c.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Up(s,p,c);else if(s.tag===19)Up(s,p,c);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===c)break e;for(;s.sibling===null;){if(s.return===null||s.return===c)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}x&=1}switch(M(gi,x),N){case"forwards":for(p=c.child,N=null;p!==null;)s=p.alternate,s!==null&&nd(s)===null&&(N=p),p=p.sibling;p=N,p===null?(N=c.child,c.child=null):(N=p.sibling,p.sibling=null),qp(c,!1,N,p,D);break;case"backwards":for(p=null,N=c.child,c.child=null;N!==null;){if(s=N.alternate,s!==null&&nd(s)===null){c.child=N;break}s=N.sibling,N.sibling=p,p=N,N=s}qp(c,!0,p,null,D);break;case"together":qp(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Ms(s,c,p){if(s!==null&&(c.dependencies=s.dependencies),kl|=c.lanes,(p&c.childLanes)===0)if(s!==null){if(Fu(s,c,p,!1),(p&c.childLanes)===0)return null}else return null;if(s!==null&&c.child!==s.child)throw Error(r(153));if(c.child!==null){for(s=c.child,p=ur(s,s.pendingProps),c.child=p,p.return=c;s.sibling!==null;)s=s.sibling,p=p.sibling=ur(s,s.pendingProps),p.return=c;p.sibling=null}return c.child}function Da(s,c){return(s.lanes&c)!==0?!0:(s=s.dependencies,!!(s!==null&&hf(s)))}function hr(s,c,p){switch(c.tag){case 3:ue(c,c.stateNode.containerInfo),zr(c,On,s.memoizedState.cache),Ou();break;case 27:case 5:tt(c);break;case 4:ue(c,c.stateNode.containerInfo);break;case 10:zr(c,c.type,c.memoizedProps.value);break;case 13:var x=c.memoizedState;if(x!==null)return x.dehydrated!==null?(la(c),c.flags|=128,null):(p&c.child.childLanes)!==0?ty(s,c,p):(la(c),s=Ms(s,c,p),s!==null?s.sibling:null);la(c);break;case 19:var N=(s.flags&128)!==0;if(x=(p&c.childLanes)!==0,x||(Fu(s,c,p,!1),x=(p&c.childLanes)!==0),N){if(x)return ny(s,c,p);c.flags|=128}if(N=c.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),M(gi,gi.current),x)break;return null;case 22:case 23:return c.lanes=0,sd(s,c,p);case 24:zr(c,On,s.memoizedState.cache)}return Ms(s,c,p)}function Bf(s,c,p){if(s!==null)if(s.memoizedProps!==c.pendingProps)Fi=!0;else{if(!Da(s,p)&&(c.flags&128)===0)return Fi=!1,hr(s,c,p);Fi=(s.flags&131072)!==0}else Fi=!1,ln&&(c.flags&1048576)!==0&&up(c,Mu,c.index);switch(c.lanes=0,c.tag){case 16:e:{s=c.pendingProps;var x=c.elementType,N=x._init;if(x=N(x._payload),c.type=x,typeof x=="function")mo(x)?(s=Nl(x,s),c.tag=1,c=Sl(null,c,x,s,p)):(c.tag=0,c=Nc(null,c,x,s,p));else{if(x!=null){if(N=x.$$typeof,N===V){c.tag=11,c=Lf(null,c,x,s,p);break e}else if(N===B){c.tag=14,c=Of(null,c,x,s,p);break e}}throw c=Z(x)||x,Error(r(306,c,""))}}return c;case 0:return Nc(s,c,c.type,c.pendingProps,p);case 1:return x=c.type,N=Nl(x,c.pendingProps),Sl(s,c,x,N,p);case 3:e:{if(ue(c,c.stateNode.containerInfo),s===null)throw Error(r(387));x=c.pendingProps;var D=c.memoizedState;N=D.element,gc(s,c),tr(c,x,null,p);var G=c.memoizedState;if(x=G.cache,zr(c,On,x),x!==D.cache&&Xt(c,[On],p,!0),Ta(),x=G.element,D.isDehydrated)if(D={element:x,isDehydrated:!1,cache:G.cache},c.updateQueue.baseState=D,c.memoizedState=D,c.flags&256){c=ey(s,c,x,p);break e}else if(x!==N){N=pi(Error(r(424)),c),gl(N),c=ey(s,c,x,p);break e}else{switch(s=c.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(ei=Ia(s.firstChild),Ai=c,ln=!0,ka=null,vr=!0,p=Yg(c,null,x,p),c.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(Ou(),x===N){c=Ms(s,c,p);break e}Jn(s,c,x,p)}c=c.child}return c;case 26:return Nt(s,c),s===null?(p=Xy(c.type,null,c.pendingProps,null))?c.memoizedState=p:ln||(p=c.type,s=c.pendingProps,x=Mo(le.current).createElement(p),x[Ln]=c,x[oi]=s,Mi(x,p,s),ji(x),c.stateNode=x):c.memoizedState=Xy(c.type,s.memoizedProps,c.pendingProps,s.memoizedState),null;case 27:return tt(c),s===null&&ln&&(x=c.stateNode=Qy(c.type,c.pendingProps,le.current),Ai=c,vr=!0,N=ei,ua(c.type)?(gm=N,ei=Ia(x.firstChild)):ei=N),Jn(s,c,c.pendingProps.children,p),Nt(s,c),s===null&&(c.flags|=4194304),c.child;case 5:return s===null&&ln&&((N=x=ei)&&(x=Yy(x,c.type,c.pendingProps,vr),x!==null?(c.stateNode=x,Ai=c,ei=Ia(x.firstChild),vr=!1,N=!0):N=!1),N||ra(c)),tt(c),N=c.type,D=c.pendingProps,G=s!==null?s.memoizedProps:null,x=D.children,rh(N,D)?x=null:G!==null&&rh(N,G)&&(c.flags|=32),c.memoizedState!==null&&(N=xp(s,c,bp,null,null,p),Bc._currentValue=N),Nt(s,c),Jn(s,c,x,p),c.child;case 6:return s===null&&ln&&((s=p=ei)&&(p=sh(p,c.pendingProps,vr),p!==null?(c.stateNode=p,Ai=c,ei=null,s=!0):s=!1),s||ra(c)),null;case 13:return ty(s,c,p);case 4:return ue(c,c.stateNode.containerInfo),x=c.pendingProps,s===null?c.child=To(c,null,x,p):Jn(s,c,x,p),c.child;case 11:return Lf(s,c,c.type,c.pendingProps,p);case 7:return Jn(s,c,c.pendingProps,p),c.child;case 8:return Jn(s,c,c.pendingProps.children,p),c.child;case 12:return Jn(s,c,c.pendingProps.children,p),c.child;case 10:return x=c.pendingProps,zr(c,c.type,x.value),Jn(s,c,x.children,p),c.child;case 9:return N=c.type._context,x=c.pendingProps.children,bo(c),N=mi(N),x=x(N),c.flags|=1,Jn(s,c,x,p),c.child;case 14:return Of(s,c,c.type,c.pendingProps,p);case 15:return Ff(s,c,c.type,c.pendingProps,p);case 19:return ny(s,c,p);case 31:return x=c.pendingProps,p=c.mode,x={mode:x.mode,children:x.children},s===null?(p=od(x,p),p.ref=c.ref,c.child=p,p.return=c,c=p):(p=ur(s.child,x),p.ref=c.ref,c.child=p,p.return=c,c=p),c;case 22:return sd(s,c,p);case 24:return bo(c),x=mi(On),s===null?(N=Es(),N===null&&(N=qn,D=fp(),N.pooledCache=D,D.refCount++,D!==null&&(N.pooledCacheLanes|=p),N=D),c.memoizedState={parent:x,cache:N},wo(c),zr(c,On,N)):((s.lanes&p)!==0&&(gc(s,c),tr(c,null,null,p),Ta()),N=s.memoizedState,D=c.memoizedState,N.parent!==x?(N={parent:x,cache:x},c.memoizedState=N,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=N),zr(c,On,x)):(x=D.cache,zr(c,On,x),x!==N.cache&&Xt(c,[On],p,!0))),Jn(s,c,c.pendingProps.children,p),c.child;case 29:throw c.pendingProps}throw Error(r(156,c.tag))}function Rs(s){s.flags|=4}function Uf(s,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Ri(c)){if(c=Ur.current,c!==null&&((pn&4194048)===pn?fr!==null:(pn&62914560)!==pn&&(pn&536870912)===0||c!==fr))throw mc=pp,kg;s.flags|=8192}}function qf(s,c){c!==null&&(s.flags|=4),s.flags&16384&&(c=s.tag!==22?_t():536870912,s.lanes|=c,Tc|=c)}function cd(s,c){if(!ln)switch(s.tailMode){case"hidden":c=s.tail;for(var p=null;c!==null;)c.alternate!==null&&(p=c),c=c.sibling;p===null?s.tail=null:p.sibling=null;break;case"collapsed":p=s.tail;for(var x=null;p!==null;)p.alternate!==null&&(x=p),p=p.sibling;x===null?c||s.tail===null?s.tail=null:s.tail.sibling=null:x.sibling=null}}function Fn(s){var c=s.alternate!==null&&s.alternate.child===s.child,p=0,x=0;if(c)for(var N=s.child;N!==null;)p|=N.lanes|N.childLanes,x|=N.subtreeFlags&65011712,x|=N.flags&65011712,N.return=s,N=N.sibling;else for(N=s.child;N!==null;)p|=N.lanes|N.childLanes,x|=N.subtreeFlags,x|=N.flags,N.return=s,N=N.sibling;return s.subtreeFlags|=x,s.childLanes=p,c}function iy(s,c,p){var x=c.pendingProps;switch(Ru(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fn(c),null;case 1:return Fn(c),null;case 3:return p=c.stateNode,x=null,s!==null&&(x=s.memoizedState.cache),c.memoizedState.cache!==x&&(c.flags|=2048),aa(On),ze(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(s===null||s.child===null)&&(Lu(c)?Rs(c):s===null||s.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Ng())),Fn(c),null;case 26:return p=c.memoizedState,s===null?(Rs(c),p!==null?(Fn(c),Uf(c,p)):(Fn(c),c.flags&=-16777217)):p?p!==s.memoizedState?(Rs(c),Fn(c),Uf(c,p)):(Fn(c),c.flags&=-16777217):(s.memoizedProps!==x&&Rs(c),Fn(c),c.flags&=-16777217),null;case 27:ft(c),p=le.current;var N=c.type;if(s!==null&&c.stateNode!=null)s.memoizedProps!==x&&Rs(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Fn(c),null}s=ce.current,Lu(c)?vg(c):(s=Qy(N,x,p),c.stateNode=s,Rs(c))}return Fn(c),null;case 5:if(ft(c),p=c.type,s!==null&&c.stateNode!=null)s.memoizedProps!==x&&Rs(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Fn(c),null}if(s=ce.current,Lu(c))vg(c);else{switch(N=Mo(le.current),s){case 1:s=N.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:s=N.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":s=N.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":s=N.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":s=N.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof x.is=="string"?N.createElement("select",{is:x.is}):N.createElement("select"),x.multiple?s.multiple=!0:x.size&&(s.size=x.size);break;default:s=typeof x.is=="string"?N.createElement(p,{is:x.is}):N.createElement(p)}}s[Ln]=c,s[oi]=x;e:for(N=c.child;N!==null;){if(N.tag===5||N.tag===6)s.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===c)break e;for(;N.sibling===null;){if(N.return===null||N.return===c)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}c.stateNode=s;e:switch(Mi(s,p,x),p){case"button":case"input":case"select":case"textarea":s=!!x.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Rs(c)}}return Fn(c),c.flags&=-16777217,null;case 6:if(s&&c.stateNode!=null)s.memoizedProps!==x&&Rs(c);else{if(typeof x!="string"&&c.stateNode===null)throw Error(r(166));if(s=le.current,Lu(c)){if(s=c.stateNode,p=c.memoizedProps,x=null,N=Ai,N!==null)switch(N.tag){case 27:case 5:x=N.memoizedProps}s[Ln]=c,s=!!(s.nodeValue===p||x!==null&&x.suppressHydrationWarning===!0||qy(s.nodeValue,p)),s||ra(c)}else s=Mo(s).createTextNode(x),s[Ln]=c,c.stateNode=s}return Fn(c),null;case 13:if(x=c.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(N=Lu(c),x!==null&&x.dehydrated!==null){if(s===null){if(!N)throw Error(r(318));if(N=c.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(r(317));N[Ln]=c}else Ou(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Fn(c),N=!1}else N=Ng(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=N),N=!0;if(!N)return c.flags&256?(is(c),c):(is(c),null)}if(is(c),(c.flags&128)!==0)return c.lanes=p,c;if(p=x!==null,s=s!==null&&s.memoizedState!==null,p){x=c.child,N=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(N=x.alternate.memoizedState.cachePool.pool);var D=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(D=x.memoizedState.cachePool.pool),D!==N&&(x.flags|=2048)}return p!==s&&p&&(c.child.flags|=8192),qf(c,c.updateQueue),Fn(c),null;case 4:return ze(),s===null&&fm(c.stateNode.containerInfo),Fn(c),null;case 10:return aa(c.type),Fn(c),null;case 19:if(se(gi),N=c.memoizedState,N===null)return Fn(c),null;if(x=(c.flags&128)!==0,D=N.rendering,D===null)if(x)cd(N,!1);else{if(yi!==0||s!==null&&(s.flags&128)!==0)for(s=c.child;s!==null;){if(D=nd(s),D!==null){for(c.flags|=128,cd(N,!1),s=D.updateQueue,c.updateQueue=s,qf(c,s),c.subtreeFlags=0,s=p,p=c.child;p!==null;)Iu(p,s),p=p.sibling;return M(gi,gi.current&1|2),c.child}s=s.sibling}N.tail!==null&&Me()>Ac&&(c.flags|=128,x=!0,cd(N,!1),c.lanes=4194304)}else{if(!x)if(s=nd(D),s!==null){if(c.flags|=128,x=!0,s=s.updateQueue,c.updateQueue=s,qf(c,s),cd(N,!0),N.tail===null&&N.tailMode==="hidden"&&!D.alternate&&!ln)return Fn(c),null}else 2*Me()-N.renderingStartTime>Ac&&p!==536870912&&(c.flags|=128,x=!0,cd(N,!1),c.lanes=4194304);N.isBackwards?(D.sibling=c.child,c.child=D):(s=N.last,s!==null?s.sibling=D:c.child=D,N.last=D)}return N.tail!==null?(c=N.tail,N.rendering=c,N.tail=c.sibling,N.renderingStartTime=Me(),c.sibling=null,s=gi.current,M(gi,x?s&1|2:s&1),c):(Fn(c),null);case 22:case 23:return is(c),yp(),x=c.memoizedState!==null,s!==null?s.memoizedState!==null!==x&&(c.flags|=8192):x&&(c.flags|=8192),x?(p&536870912)!==0&&(c.flags&128)===0&&(Fn(c),c.subtreeFlags&6&&(c.flags|=8192)):Fn(c),p=c.updateQueue,p!==null&&qf(c,p.retryQueue),p=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),x=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(x=c.memoizedState.cachePool.pool),x!==p&&(c.flags|=2048),s!==null&&se(vo),null;case 24:return p=null,s!==null&&(p=s.memoizedState.cache),c.memoizedState.cache!==p&&(c.flags|=2048),aa(On),Fn(c),null;case 25:return null;case 30:return null}throw Error(r(156,c.tag))}function ry(s,c){switch(Ru(c),c.tag){case 1:return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 3:return aa(On),ze(),s=c.flags,(s&65536)!==0&&(s&128)===0?(c.flags=s&-65537|128,c):null;case 26:case 27:case 5:return ft(c),null;case 13:if(is(c),s=c.memoizedState,s!==null&&s.dehydrated!==null){if(c.alternate===null)throw Error(r(340));Ou()}return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 19:return se(gi),null;case 4:return ze(),null;case 10:return aa(c.type),null;case 22:case 23:return is(c),yp(),s!==null&&se(vo),s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 24:return aa(On),null;case 25:return null;default:return null}}function ay(s,c){switch(Ru(c),c.tag){case 3:aa(On),ze();break;case 26:case 27:case 5:ft(c);break;case 4:ze();break;case 13:is(c);break;case 19:se(gi);break;case 10:aa(c.type);break;case 22:case 23:is(c),yp(),s!==null&&se(vo);break;case 24:aa(On)}}function ud(s,c){try{var p=c.updateQueue,x=p!==null?p.lastEffect:null;if(x!==null){var N=x.next;p=N;do{if((p.tag&s)===s){x=void 0;var D=p.create,G=p.inst;x=D(),G.destroy=x}p=p.next}while(p!==N)}}catch(X){$n(c,c.return,X)}}function jl(s,c,p){try{var x=c.updateQueue,N=x!==null?x.lastEffect:null;if(N!==null){var D=N.next;x=D;do{if((x.tag&s)===s){var G=x.inst,X=G.destroy;if(X!==void 0){G.destroy=void 0,N=c;var ye=p,Pe=X;try{Pe()}catch(Ye){$n(N,ye,Ye)}}}x=x.next}while(x!==D)}}catch(Ye){$n(c,c.return,Ye)}}function sy(s){var c=s.updateQueue;if(c!==null){var p=s.stateNode;try{gp(c,p)}catch(x){$n(s,s.return,x)}}}function Vp(s,c,p){p.props=Nl(s.type,s.memoizedProps),p.state=s.memoizedState;try{p.componentWillUnmount()}catch(x){$n(s,c,x)}}function Sc(s,c){try{var p=s.ref;if(p!==null){switch(s.tag){case 26:case 27:case 5:var x=s.stateNode;break;case 30:x=s.stateNode;break;default:x=s.stateNode}typeof p=="function"?s.refCleanup=p(x):p.current=x}}catch(N){$n(s,c,N)}}function as(s,c){var p=s.ref,x=s.refCleanup;if(p!==null)if(typeof x=="function")try{x()}catch(N){$n(s,c,N)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(N){$n(s,c,N)}else p.current=null}function Vf(s){var c=s.type,p=s.memoizedProps,x=s.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":p.autoFocus&&x.focus();break e;case"img":p.src?x.src=p.src:p.srcSet&&(x.srcset=p.srcSet)}}catch(N){$n(s,s.return,N)}}function Hf(s,c,p){try{var x=s.stateNode;dv(x,s.type,p,c),x[oi]=c}catch(N){$n(s,s.return,N)}}function jc(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ua(s.type)||s.tag===4}function dd(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||jc(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ua(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Gf(s,c,p){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(s,c):(c=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,c.appendChild(s),p=p._reactRootContainer,p!=null||c.onclick!==null||(c.onclick=nh));else if(x!==4&&(x===27&&ua(s.type)&&(p=s.stateNode,c=null),s=s.child,s!==null))for(Gf(s,c,p),s=s.sibling;s!==null;)Gf(s,c,p),s=s.sibling}function fd(s,c,p){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?p.insertBefore(s,c):p.appendChild(s);else if(x!==4&&(x===27&&ua(s.type)&&(p=s.stateNode),s=s.child,s!==null))for(fd(s,c,p),s=s.sibling;s!==null;)fd(s,c,p),s=s.sibling}function hd(s){var c=s.stateNode,p=s.memoizedProps;try{for(var x=s.type,N=c.attributes;N.length;)c.removeAttributeNode(N[0]);Mi(c,x,p),c[Ln]=s,c[oi]=p}catch(D){$n(s,s.return,D)}}var ss=!1,jn=!1,Ls=!1,ly=typeof WeakSet=="function"?WeakSet:Set,Pi=null;function Kb(s,c){if(s=s.containerInfo,Pa=uh,s=cf(s),Au(s)){if("selectionStart"in s)var p={start:s.selectionStart,end:s.selectionEnd};else e:{p=(p=s.ownerDocument)&&p.defaultView||window;var x=p.getSelection&&p.getSelection();if(x&&x.rangeCount!==0){p=x.anchorNode;var N=x.anchorOffset,D=x.focusNode;x=x.focusOffset;try{p.nodeType,D.nodeType}catch{p=null;break e}var G=0,X=-1,ye=-1,Pe=0,Ye=0,Ze=s,Oe=null;t:for(;;){for(var Ie;Ze!==p||N!==0&&Ze.nodeType!==3||(X=G+N),Ze!==D||x!==0&&Ze.nodeType!==3||(ye=G+x),Ze.nodeType===3&&(G+=Ze.nodeValue.length),(Ie=Ze.firstChild)!==null;)Oe=Ze,Ze=Ie;for(;;){if(Ze===s)break t;if(Oe===p&&++Pe===N&&(X=G),Oe===D&&++Ye===x&&(ye=G),(Ie=Ze.nextSibling)!==null)break;Ze=Oe,Oe=Ze.parentNode}Ze=Ie}p=X===-1||ye===-1?null:{start:X,end:ye}}else p=null}p=p||{start:0,end:0}}else p=null;for(ih={focusedElem:s,selectionRange:p},uh=!1,Pi=c;Pi!==null;)if(c=Pi,s=c.child,(c.subtreeFlags&1024)!==0&&s!==null)s.return=c,Pi=s;else for(;Pi!==null;){switch(c=Pi,D=c.alternate,s=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&D!==null){s=void 0,p=c,N=D.memoizedProps,D=D.memoizedState,x=p.stateNode;try{var Tt=Nl(p.type,N,p.elementType===p.type);s=x.getSnapshotBeforeUpdate(Tt,D),x.__reactInternalSnapshotBeforeUpdate=s}catch(kt){$n(p,p.return,kt)}}break;case 3:if((s&1024)!==0){if(s=c.stateNode.containerInfo,p=s.nodeType,p===9)mm(s);else if(p===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":mm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=c.sibling,s!==null){s.return=c.return,Pi=s;break}Pi=c.return}}function oy(s,c,p){var x=p.flags;switch(p.tag){case 0:case 11:case 15:Cl(s,p),x&4&&ud(5,p);break;case 1:if(Cl(s,p),x&4)if(s=p.stateNode,c===null)try{s.componentDidMount()}catch(G){$n(p,p.return,G)}else{var N=Nl(p.type,c.memoizedProps);c=c.memoizedState;try{s.componentDidUpdate(N,c,s.__reactInternalSnapshotBeforeUpdate)}catch(G){$n(p,p.return,G)}}x&64&&sy(p),x&512&&Sc(p,p.return);break;case 3:if(Cl(s,p),x&64&&(s=p.updateQueue,s!==null)){if(c=null,p.child!==null)switch(p.child.tag){case 27:case 5:c=p.child.stateNode;break;case 1:c=p.child.stateNode}try{gp(s,c)}catch(G){$n(p,p.return,G)}}break;case 27:c===null&&x&4&&hd(p);case 26:case 5:Cl(s,p),c===null&&x&4&&Vf(p),x&512&&Sc(p,p.return);break;case 12:Cl(s,p);break;case 13:Cl(s,p),x&4&&dy(s,p),x&64&&(s=p.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(p=Kf.bind(null,p),Lc(s,p))));break;case 22:if(x=p.memoizedState!==null||ss,!x){c=c!==null&&c.memoizedState!==null||jn,N=ss;var D=jn;ss=x,(jn=c)&&!D?Fs(s,p,(p.subtreeFlags&8772)!==0):Cl(s,p),ss=N,jn=D}break;case 30:break;default:Cl(s,p)}}function cy(s){var c=s.alternate;c!==null&&(s.alternate=null,cy(c)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(c=s.stateNode,c!==null&&du(c)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var ti=null,_r=!1;function Os(s,c,p){for(p=p.child;p!==null;)uy(s,c,p),p=p.sibling}function uy(s,c,p){if(de&&typeof de.onCommitFiberUnmount=="function")try{de.onCommitFiberUnmount(J,p)}catch{}switch(p.tag){case 26:jn||as(p,c),Os(s,c,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:jn||as(p,c);var x=ti,N=_r;ua(p.type)&&(ti=p.stateNode,_r=!1),Os(s,c,p),jd(p.stateNode),ti=x,_r=N;break;case 5:jn||as(p,c);case 6:if(x=ti,N=_r,ti=null,Os(s,c,p),ti=x,_r=N,ti!==null)if(_r)try{(ti.nodeType===9?ti.body:ti.nodeName==="HTML"?ti.ownerDocument.body:ti).removeChild(p.stateNode)}catch(D){$n(p,c,D)}else try{ti.removeChild(p.stateNode)}catch(D){$n(p,c,D)}break;case 18:ti!==null&&(_r?(s=ti,ah(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,p.stateNode),Pd(s)):ah(ti,p.stateNode));break;case 4:x=ti,N=_r,ti=p.stateNode.containerInfo,_r=!0,Os(s,c,p),ti=x,_r=N;break;case 0:case 11:case 14:case 15:jn||jl(2,p,c),jn||jl(4,p,c),Os(s,c,p);break;case 1:jn||(as(p,c),x=p.stateNode,typeof x.componentWillUnmount=="function"&&Vp(p,c,x)),Os(s,c,p);break;case 21:Os(s,c,p);break;case 22:jn=(x=jn)||p.memoizedState!==null,Os(s,c,p),jn=x;break;default:Os(s,c,p)}}function dy(s,c){if(c.memoizedState===null&&(s=c.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Pd(s)}catch(p){$n(c,c.return,p)}}function Xb(s){switch(s.tag){case 13:case 19:var c=s.stateNode;return c===null&&(c=s.stateNode=new ly),c;case 22:return s=s.stateNode,c=s._retryCache,c===null&&(c=s._retryCache=new ly),c;default:throw Error(r(435,s.tag))}}function Hp(s,c){var p=Xb(s);c.forEach(function(x){var N=rv.bind(null,s,x);p.has(x)||(p.add(x),x.then(N,N))})}function qr(s,c){var p=c.deletions;if(p!==null)for(var x=0;x<p.length;x++){var N=p[x],D=s,G=c,X=G;e:for(;X!==null;){switch(X.tag){case 27:if(ua(X.type)){ti=X.stateNode,_r=!1;break e}break;case 5:ti=X.stateNode,_r=!1;break e;case 3:case 4:ti=X.stateNode.containerInfo,_r=!0;break e}X=X.return}if(ti===null)throw Error(r(160));uy(D,G,N),ti=null,_r=!1,D=N.alternate,D!==null&&(D.return=null),N.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)Gp(c,s),c=c.sibling}var oa=null;function Gp(s,c){var p=s.alternate,x=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:qr(c,s),kr(s),x&4&&(jl(3,s,s.return),ud(3,s),jl(5,s,s.return));break;case 1:qr(c,s),kr(s),x&512&&(jn||p===null||as(p,p.return)),x&64&&ss&&(s=s.updateQueue,s!==null&&(x=s.callbacks,x!==null&&(p=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=p===null?x:p.concat(x))));break;case 26:var N=oa;if(qr(c,s),kr(s),x&512&&(jn||p===null||as(p,p.return)),x&4){var D=p!==null?p.memoizedState:null;if(x=s.memoizedState,p===null)if(x===null)if(s.stateNode===null){e:{x=s.type,p=s.memoizedProps,N=N.ownerDocument||N;t:switch(x){case"title":D=N.getElementsByTagName("title")[0],(!D||D[gs]||D[Ln]||D.namespaceURI==="http://www.w3.org/2000/svg"||D.hasAttribute("itemprop"))&&(D=N.createElement(x),N.head.insertBefore(D,N.querySelector("head > title"))),Mi(D,x,p),D[Ln]=s,ji(D),x=D;break e;case"link":var G=tx("link","href",N).get(x+(p.href||""));if(G){for(var X=0;X<G.length;X++)if(D=G[X],D.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&D.getAttribute("rel")===(p.rel==null?null:p.rel)&&D.getAttribute("title")===(p.title==null?null:p.title)&&D.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){G.splice(X,1);break t}}D=N.createElement(x),Mi(D,x,p),N.head.appendChild(D);break;case"meta":if(G=tx("meta","content",N).get(x+(p.content||""))){for(X=0;X<G.length;X++)if(D=G[X],D.getAttribute("content")===(p.content==null?null:""+p.content)&&D.getAttribute("name")===(p.name==null?null:p.name)&&D.getAttribute("property")===(p.property==null?null:p.property)&&D.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&D.getAttribute("charset")===(p.charSet==null?null:p.charSet)){G.splice(X,1);break t}}D=N.createElement(x),Mi(D,x,p),N.head.appendChild(D);break;default:throw Error(r(468,x))}D[Ln]=s,ji(D),x=D}s.stateNode=x}else nx(N,s.type,s.stateNode);else s.stateNode=ex(N,x,s.memoizedProps);else D!==x?(D===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):D.count--,x===null?nx(N,s.type,s.stateNode):ex(N,x,s.memoizedProps)):x===null&&s.stateNode!==null&&Hf(s,s.memoizedProps,p.memoizedProps)}break;case 27:qr(c,s),kr(s),x&512&&(jn||p===null||as(p,p.return)),p!==null&&x&4&&Hf(s,s.memoizedProps,p.memoizedProps);break;case 5:if(qr(c,s),kr(s),x&512&&(jn||p===null||as(p,p.return)),s.flags&32){N=s.stateNode;try{Na(N,"")}catch(Ie){$n(s,s.return,Ie)}}x&4&&s.stateNode!=null&&(N=s.memoizedProps,Hf(s,N,p!==null?p.memoizedProps:N)),x&1024&&(Ls=!0);break;case 6:if(qr(c,s),kr(s),x&4){if(s.stateNode===null)throw Error(r(162));x=s.memoizedProps,p=s.stateNode;try{p.nodeValue=x}catch(Ie){$n(s,s.return,Ie)}}break;case 3:if(zc=null,N=oa,oa=qt(c.containerInfo),qr(c,s),oa=N,kr(s),x&4&&p!==null&&p.memoizedState.isDehydrated)try{Pd(c.containerInfo)}catch(Ie){$n(s,s.return,Ie)}Ls&&(Ls=!1,fy(s));break;case 4:x=oa,oa=qt(s.stateNode.containerInfo),qr(c,s),kr(s),oa=x;break;case 12:qr(c,s),kr(s);break;case 13:qr(c,s),kr(s),s.child.flags&8192&&s.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(Zp=Me()),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,Hp(s,x)));break;case 22:N=s.memoizedState!==null;var ye=p!==null&&p.memoizedState!==null,Pe=ss,Ye=jn;if(ss=Pe||N,jn=Ye||ye,qr(c,s),jn=Ye,ss=Pe,kr(s),x&8192)e:for(c=s.stateNode,c._visibility=N?c._visibility&-2:c._visibility|1,N&&(p===null||ye||ss||jn||Po(s)),p=null,c=s;;){if(c.tag===5||c.tag===26){if(p===null){ye=p=c;try{if(D=ye.stateNode,N)G=D.style,typeof G.setProperty=="function"?G.setProperty("display","none","important"):G.display="none";else{X=ye.stateNode;var Ze=ye.memoizedProps.style,Oe=Ze!=null&&Ze.hasOwnProperty("display")?Ze.display:null;X.style.display=Oe==null||typeof Oe=="boolean"?"":(""+Oe).trim()}}catch(Ie){$n(ye,ye.return,Ie)}}}else if(c.tag===6){if(p===null){ye=c;try{ye.stateNode.nodeValue=N?"":ye.memoizedProps}catch(Ie){$n(ye,ye.return,Ie)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===s)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break e;for(;c.sibling===null;){if(c.return===null||c.return===s)break e;p===c&&(p=null),c=c.return}p===c&&(p=null),c.sibling.return=c.return,c=c.sibling}x&4&&(x=s.updateQueue,x!==null&&(p=x.retryQueue,p!==null&&(x.retryQueue=null,Hp(s,p))));break;case 19:qr(c,s),kr(s),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,Hp(s,x)));break;case 30:break;case 21:break;default:qr(c,s),kr(s)}}function kr(s){var c=s.flags;if(c&2){try{for(var p,x=s.return;x!==null;){if(jc(x)){p=x;break}x=x.return}if(p==null)throw Error(r(160));switch(p.tag){case 27:var N=p.stateNode,D=dd(s);fd(s,D,N);break;case 5:var G=p.stateNode;p.flags&32&&(Na(G,""),p.flags&=-33);var X=dd(s);fd(s,X,G);break;case 3:case 4:var ye=p.stateNode.containerInfo,Pe=dd(s);Gf(s,Pe,ye);break;default:throw Error(r(161))}}catch(Ye){$n(s,s.return,Ye)}s.flags&=-3}c&4096&&(s.flags&=-4097)}function fy(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var c=s;fy(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),s=s.sibling}}function Cl(s,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)oy(s,c.alternate,c),c=c.sibling}function Po(s){for(s=s.child;s!==null;){var c=s;switch(c.tag){case 0:case 11:case 14:case 15:jl(4,c,c.return),Po(c);break;case 1:as(c,c.return);var p=c.stateNode;typeof p.componentWillUnmount=="function"&&Vp(c,c.return,p),Po(c);break;case 27:jd(c.stateNode);case 26:case 5:as(c,c.return),Po(c);break;case 22:c.memoizedState===null&&Po(c);break;case 30:Po(c);break;default:Po(c)}s=s.sibling}}function Fs(s,c,p){for(p=p&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var x=c.alternate,N=s,D=c,G=D.flags;switch(D.tag){case 0:case 11:case 15:Fs(N,D,p),ud(4,D);break;case 1:if(Fs(N,D,p),x=D,N=x.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(Pe){$n(x,x.return,Pe)}if(x=D,N=x.updateQueue,N!==null){var X=x.stateNode;try{var ye=N.shared.hiddenCallbacks;if(ye!==null)for(N.shared.hiddenCallbacks=null,N=0;N<ye.length;N++)Dg(ye[N],X)}catch(Pe){$n(x,x.return,Pe)}}p&&G&64&&sy(D),Sc(D,D.return);break;case 27:hd(D);case 26:case 5:Fs(N,D,p),p&&x===null&&G&4&&Vf(D),Sc(D,D.return);break;case 12:Fs(N,D,p);break;case 13:Fs(N,D,p),p&&G&4&&dy(N,D);break;case 22:D.memoizedState===null&&Fs(N,D,p),Sc(D,D.return);break;case 30:break;default:Fs(N,D,p)}c=c.sibling}}function Yp(s,c){var p=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),s=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(s=c.memoizedState.cachePool.pool),s!==p&&(s!=null&&s.refCount++,p!=null&&$u(p))}function Wp(s,c){s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&$u(s))}function ls(s,c,p,x){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)hy(s,c,p,x),c=c.sibling}function hy(s,c,p,x){var N=c.flags;switch(c.tag){case 0:case 11:case 15:ls(s,c,p,x),N&2048&&ud(9,c);break;case 1:ls(s,c,p,x);break;case 3:ls(s,c,p,x),N&2048&&(s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&$u(s)));break;case 12:if(N&2048){ls(s,c,p,x),s=c.stateNode;try{var D=c.memoizedProps,G=D.id,X=D.onPostCommit;typeof X=="function"&&X(G,c.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(ye){$n(c,c.return,ye)}}else ls(s,c,p,x);break;case 13:ls(s,c,p,x);break;case 23:break;case 22:D=c.stateNode,G=c.alternate,c.memoizedState!==null?D._visibility&2?ls(s,c,p,x):pd(s,c):D._visibility&2?ls(s,c,p,x):(D._visibility|=2,Cc(s,c,p,x,(c.subtreeFlags&10256)!==0)),N&2048&&Yp(G,c);break;case 24:ls(s,c,p,x),N&2048&&Wp(c.alternate,c);break;default:ls(s,c,p,x)}}function Cc(s,c,p,x,N){for(N=N&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var D=s,G=c,X=p,ye=x,Pe=G.flags;switch(G.tag){case 0:case 11:case 15:Cc(D,G,X,ye,N),ud(8,G);break;case 23:break;case 22:var Ye=G.stateNode;G.memoizedState!==null?Ye._visibility&2?Cc(D,G,X,ye,N):pd(D,G):(Ye._visibility|=2,Cc(D,G,X,ye,N)),N&&Pe&2048&&Yp(G.alternate,G);break;case 24:Cc(D,G,X,ye,N),N&&Pe&2048&&Wp(G.alternate,G);break;default:Cc(D,G,X,ye,N)}c=c.sibling}}function pd(s,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var p=s,x=c,N=x.flags;switch(x.tag){case 22:pd(p,x),N&2048&&Yp(x.alternate,x);break;case 24:pd(p,x),N&2048&&Wp(x.alternate,x);break;default:pd(p,x)}c=c.sibling}}var ir=8192;function _c(s){if(s.subtreeFlags&ir)for(s=s.child;s!==null;)py(s),s=s.sibling}function py(s){switch(s.tag){case 26:_c(s),s.flags&ir&&s.memoizedState!==null&&Sv(oa,s.memoizedState,s.memoizedProps);break;case 5:_c(s);break;case 3:case 4:var c=oa;oa=qt(s.stateNode.containerInfo),_c(s),oa=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=ir,ir=16777216,_c(s),ir=c):_c(s));break;default:_c(s)}}function my(s){var c=s.alternate;if(c!==null&&(s=c.child,s!==null)){c.child=null;do c=s.sibling,s.sibling=null,s=c;while(s!==null)}}function kc(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var p=0;p<c.length;p++){var x=c[p];Pi=x,yy(x,s)}my(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)gy(s),s=s.sibling}function gy(s){switch(s.tag){case 0:case 11:case 15:kc(s),s.flags&2048&&jl(9,s,s.return);break;case 3:kc(s);break;case 12:kc(s);break;case 22:var c=s.stateNode;s.memoizedState!==null&&c._visibility&2&&(s.return===null||s.return.tag!==13)?(c._visibility&=-3,Yf(s)):kc(s);break;default:kc(s)}}function Yf(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var p=0;p<c.length;p++){var x=c[p];Pi=x,yy(x,s)}my(s)}for(s=s.child;s!==null;){switch(c=s,c.tag){case 0:case 11:case 15:jl(8,c,c.return),Yf(c);break;case 22:p=c.stateNode,p._visibility&2&&(p._visibility&=-3,Yf(c));break;default:Yf(c)}s=s.sibling}}function yy(s,c){for(;Pi!==null;){var p=Pi;switch(p.tag){case 0:case 11:case 15:jl(8,p,c);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var x=p.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:$u(p.memoizedState.cache)}if(x=p.child,x!==null)x.return=p,Pi=x;else e:for(p=s;Pi!==null;){x=Pi;var N=x.sibling,D=x.return;if(cy(x),x===p){Pi=null;break e}if(N!==null){N.return=D,Pi=N;break e}Pi=D}}}var Zb={getCacheForType:function(s){var c=mi(On),p=c.data.get(s);return p===void 0&&(p=s(),c.data.set(s,p)),p}},Qp=typeof WeakMap=="function"?WeakMap:Map,_n=0,qn=null,tn=null,pn=0,kn=0,Vr=null,_l=!1,Ec=!1,Jp=!1,$s=0,yi=0,kl=0,Io=0,Kp=0,ca=0,Tc=0,md=null,Er=null,Xp=!1,Zp=0,Ac=1/0,gd=null,El=null,Wi=0,Tl=null,Dc=null,Pc=0,em=0,tm=null,xy=null,Ic=0,nm=null;function rr(){if((_n&2)!==0&&pn!==0)return pn&-pn;if(Q.T!==null){var s=pc;return s!==0?s:eh()}return Bn()}function by(){ca===0&&(ca=(pn&536870912)===0||ln?zt():536870912);var s=Ur.current;return s!==null&&(s.flags|=32),ca}function Hr(s,c,p){(s===qn&&(kn===2||kn===9)||s.cancelPendingCommit!==null)&&(Mc(s,0),Al(s,pn,ca,!1)),Ot(s,p),((_n&2)===0||s!==qn)&&(s===qn&&((_n&2)===0&&(Io|=p),yi===4&&Al(s,pn,ca,!1)),os(s))}function vy(s,c,p){if((_n&6)!==0)throw Error(r(327));var x=!p&&(c&124)===0&&(c&s.expiredLanes)===0||Ke(s,c),N=x?nv(s,c):am(s,c,!0),D=x;do{if(N===0){Ec&&!x&&Al(s,c,0,!1);break}else{if(p=s.current.alternate,D&&!ev(p)){N=am(s,c,!1),D=!1;continue}if(N===2){if(D=c,s.errorRecoveryDisabledLanes&D)var G=0;else G=s.pendingLanes&-536870913,G=G!==0?G:G&536870912?536870912:0;if(G!==0){c=G;e:{var X=s;N=md;var ye=X.current.memoizedState.isDehydrated;if(ye&&(Mc(X,G).flags|=256),G=am(X,G,!1),G!==2){if(Jp&&!ye){X.errorRecoveryDisabledLanes|=D,Io|=D,N=4;break e}D=Er,Er=N,D!==null&&(Er===null?Er=D:Er.push.apply(Er,D))}N=G}if(D=!1,N!==2)continue}}if(N===1){Mc(s,0),Al(s,c,0,!0);break}e:{switch(x=s,D=N,D){case 0:case 1:throw Error(r(345));case 4:if((c&4194048)!==c)break;case 6:Al(x,c,ca,!_l);break e;case 2:Er=null;break;case 3:case 5:break;default:throw Error(r(329))}if((c&62914560)===c&&(N=Zp+300-Me(),10<N)){if(Al(x,c,ca,!_l),qe(x,0,!0)!==0)break e;x.timeoutHandle=Vy(wy.bind(null,x,p,Er,gd,Xp,c,ca,Io,Tc,_l,D,2,-0,0),N);break e}wy(x,p,Er,gd,Xp,c,ca,Io,Tc,_l,D,0,-0,0)}}break}while(!0);os(s)}function wy(s,c,p,x,N,D,G,X,ye,Pe,Ye,Ze,Oe,Ie){if(s.timeoutHandle=-1,Ze=c.subtreeFlags,(Ze&8192||(Ze&16785408)===16785408)&&(zi={stylesheets:null,count:0,unsuspend:Nv},py(c),Ze=jv(),Ze!==null)){s.cancelPendingCommit=Ze(yd.bind(null,s,c,D,p,x,N,G,X,ye,Ye,1,Oe,Ie)),Al(s,D,G,!Pe);return}yd(s,c,D,p,x,N,G,X,ye)}function ev(s){for(var c=s;;){var p=c.tag;if((p===0||p===11||p===15)&&c.flags&16384&&(p=c.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var x=0;x<p.length;x++){var N=p[x],D=N.getSnapshot;N=N.value;try{if(!or(D(),N))return!1}catch{return!1}}if(p=c.child,c.subtreeFlags&16384&&p!==null)p.return=c,c=p;else{if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Al(s,c,p,x){c&=~Kp,c&=~Io,s.suspendedLanes|=c,s.pingedLanes&=~c,x&&(s.warmLanes|=c),x=s.expirationTimes;for(var N=c;0<N;){var D=31-be(N),G=1<<D;x[D]=-1,N&=~G}p!==0&&Wn(s,p,c)}function Wf(){return(_n&6)===0?(vd(0),!1):!0}function im(){if(tn!==null){if(kn===0)var s=tn.return;else s=tn,K=yl=null,bf(s),Di=null,Cr=0,s=tn;for(;s!==null;)ay(s.alternate,s),s=s.return;tn=null}}function Mc(s,c){var p=s.timeoutHandle;p!==-1&&(s.timeoutHandle=-1,hv(p)),p=s.cancelPendingCommit,p!==null&&(s.cancelPendingCommit=null,p()),im(),qn=s,tn=p=ur(s.current,null),pn=c,kn=0,Vr=null,_l=!1,Ec=Ke(s,c),Jp=!1,Tc=ca=Kp=Io=kl=yi=0,Er=md=null,Xp=!1,(c&8)!==0&&(c|=c&32);var x=s.entangledLanes;if(x!==0)for(s=s.entanglements,x&=c;0<x;){var N=31-be(x),D=1<<N;c|=s[N],x&=~D}return $s=c,fo(),p}function Ny(s,c){Wt=null,Q.H=ed,c===dr||c===gf?(c=Tg(),kn=3):c===kg?(c=Tg(),kn=4):kn=c===Zg?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,Vr=c,tn===null&&(yi=1,ad(s,pi(c,s.current)))}function Sy(){var s=Q.H;return Q.H=ed,s===null?ed:s}function jy(){var s=Q.A;return Q.A=Zb,s}function rm(){yi=4,_l||(pn&4194048)!==pn&&Ur.current!==null||(Ec=!0),(kl&134217727)===0&&(Io&134217727)===0||qn===null||Al(qn,pn,ca,!1)}function am(s,c,p){var x=_n;_n|=2;var N=Sy(),D=jy();(qn!==s||pn!==c)&&(gd=null,Mc(s,c)),c=!1;var G=yi;e:do try{if(kn!==0&&tn!==null){var X=tn,ye=Vr;switch(kn){case 8:im(),G=6;break e;case 3:case 2:case 9:case 6:Ur.current===null&&(c=!0);var Pe=kn;if(kn=0,Vr=null,Rc(s,X,ye,Pe),p&&Ec){G=0;break e}break;default:Pe=kn,kn=0,Vr=null,Rc(s,X,ye,Pe)}}tv(),G=yi;break}catch(Ye){Ny(s,Ye)}while(!0);return c&&s.shellSuspendCounter++,K=yl=null,_n=x,Q.H=N,Q.A=D,tn===null&&(qn=null,pn=0,fo()),G}function tv(){for(;tn!==null;)sm(tn)}function nv(s,c){var p=_n;_n|=2;var x=Sy(),N=jy();qn!==s||pn!==c?(gd=null,Ac=Me()+500,Mc(s,c)):Ec=Ke(s,c);e:do try{if(kn!==0&&tn!==null){c=tn;var D=Vr;t:switch(kn){case 1:kn=0,Vr=null,Rc(s,c,D,1);break;case 2:case 9:if(Eg(D)){kn=0,Vr=null,_y(c);break}c=function(){kn!==2&&kn!==9||qn!==s||(kn=7),os(s)},D.then(c,c);break e;case 3:kn=7;break e;case 4:kn=5;break e;case 7:Eg(D)?(kn=0,Vr=null,_y(c)):(kn=0,Vr=null,Rc(s,c,D,7));break;case 5:var G=null;switch(tn.tag){case 26:G=tn.memoizedState;case 5:case 27:var X=tn;if(!G||Ri(G)){kn=0,Vr=null;var ye=X.sibling;if(ye!==null)tn=ye;else{var Pe=X.return;Pe!==null?(tn=Pe,Qf(Pe)):tn=null}break t}}kn=0,Vr=null,Rc(s,c,D,5);break;case 6:kn=0,Vr=null,Rc(s,c,D,6);break;case 8:im(),yi=6;break e;default:throw Error(r(462))}}Cy();break}catch(Ye){Ny(s,Ye)}while(!0);return K=yl=null,Q.H=x,Q.A=N,_n=p,tn!==null?0:(qn=null,pn=0,fo(),yi)}function Cy(){for(;tn!==null&&!Ae();)sm(tn)}function sm(s){var c=Bf(s.alternate,s,$s);s.memoizedProps=s.pendingProps,c===null?Qf(s):tn=c}function _y(s){var c=s,p=c.alternate;switch(c.tag){case 15:case 0:c=$f(p,c,c.pendingProps,c.type,void 0,pn);break;case 11:c=$f(p,c,c.pendingProps,c.type.render,c.ref,pn);break;case 5:bf(c);default:ay(p,c),c=tn=Iu(c,$s),c=Bf(p,c,$s)}s.memoizedProps=s.pendingProps,c===null?Qf(s):tn=c}function Rc(s,c,p,x){K=yl=null,bf(c),Di=null,Cr=0;var N=c.return;try{if(Xg(s,N,c,p,pn)){yi=1,ad(s,pi(p,s.current)),tn=null;return}}catch(D){if(N!==null)throw tn=N,D;yi=1,ad(s,pi(p,s.current)),tn=null;return}c.flags&32768?(ln||x===1?s=!0:Ec||(pn&536870912)!==0?s=!1:(_l=s=!0,(x===2||x===9||x===3||x===6)&&(x=Ur.current,x!==null&&x.tag===13&&(x.flags|=16384))),ky(c,s)):Qf(c)}function Qf(s){var c=s;do{if((c.flags&32768)!==0){ky(c,_l);return}s=c.return;var p=iy(c.alternate,c,$s);if(p!==null){tn=p;return}if(c=c.sibling,c!==null){tn=c;return}tn=c=s}while(c!==null);yi===0&&(yi=5)}function ky(s,c){do{var p=ry(s.alternate,s);if(p!==null){p.flags&=32767,tn=p;return}if(p=s.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!c&&(s=s.sibling,s!==null)){tn=s;return}tn=s=p}while(s!==null);yi=6,tn=null}function yd(s,c,p,x,N,D,G,X,ye){s.cancelPendingCommit=null;do Jf();while(Wi!==0);if((_n&6)!==0)throw Error(r(327));if(c!==null){if(c===s.current)throw Error(r(177));if(D=c.lanes|c.childLanes,D|=op,Yn(s,p,D,G,X,ye),s===qn&&(tn=qn=null,pn=0),Dc=c,Tl=s,Pc=p,em=D,tm=N,xy=x,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Ry(Ge,function(){return Py(),null})):(s.callbackNode=null,s.callbackPriority=0),x=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||x){x=Q.T,Q.T=null,N=q.p,q.p=2,G=_n,_n|=4;try{Kb(s,c,p)}finally{_n=G,q.p=N,Q.T=x}}Wi=1,Ey(),Ty(),Ay()}}function Ey(){if(Wi===1){Wi=0;var s=Tl,c=Dc,p=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||p){p=Q.T,Q.T=null;var x=q.p;q.p=2;var N=_n;_n|=4;try{Gp(c,s);var D=ih,G=cf(s.containerInfo),X=D.focusedElem,ye=D.selectionRange;if(G!==X&&X&&X.ownerDocument&&Tu(X.ownerDocument.documentElement,X)){if(ye!==null&&Au(X)){var Pe=ye.start,Ye=ye.end;if(Ye===void 0&&(Ye=Pe),"selectionStart"in X)X.selectionStart=Pe,X.selectionEnd=Math.min(Ye,X.value.length);else{var Ze=X.ownerDocument||document,Oe=Ze&&Ze.defaultView||window;if(Oe.getSelection){var Ie=Oe.getSelection(),Tt=X.textContent.length,kt=Math.min(ye.start,Tt),In=ye.end===void 0?kt:Math.min(ye.end,Tt);!Ie.extend&&kt>In&&(G=In,In=kt,kt=G);var ke=Eu(X,kt),Se=Eu(X,In);if(ke&&Se&&(Ie.rangeCount!==1||Ie.anchorNode!==ke.node||Ie.anchorOffset!==ke.offset||Ie.focusNode!==Se.node||Ie.focusOffset!==Se.offset)){var Te=Ze.createRange();Te.setStart(ke.node,ke.offset),Ie.removeAllRanges(),kt>In?(Ie.addRange(Te),Ie.extend(Se.node,Se.offset)):(Te.setEnd(Se.node,Se.offset),Ie.addRange(Te))}}}}for(Ze=[],Ie=X;Ie=Ie.parentNode;)Ie.nodeType===1&&Ze.push({element:Ie,left:Ie.scrollLeft,top:Ie.scrollTop});for(typeof X.focus=="function"&&X.focus(),X=0;X<Ze.length;X++){var Qe=Ze[X];Qe.element.scrollLeft=Qe.left,Qe.element.scrollTop=Qe.top}}uh=!!Pa,ih=Pa=null}finally{_n=N,q.p=x,Q.T=p}}s.current=c,Wi=2}}function Ty(){if(Wi===2){Wi=0;var s=Tl,c=Dc,p=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||p){p=Q.T,Q.T=null;var x=q.p;q.p=2;var N=_n;_n|=4;try{oy(s,c.alternate,c)}finally{_n=N,q.p=x,Q.T=p}}Wi=3}}function Ay(){if(Wi===4||Wi===3){Wi=0,we();var s=Tl,c=Dc,p=Pc,x=xy;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Wi=5:(Wi=0,Dc=Tl=null,Dy(s,s.pendingLanes));var N=s.pendingLanes;if(N===0&&(El=null),wn(p),c=c.stateNode,de&&typeof de.onCommitFiberRoot=="function")try{de.onCommitFiberRoot(J,c,void 0,(c.current.flags&128)===128)}catch{}if(x!==null){c=Q.T,N=q.p,q.p=2,Q.T=null;try{for(var D=s.onRecoverableError,G=0;G<x.length;G++){var X=x[G];D(X.value,{componentStack:X.stack})}}finally{Q.T=c,q.p=N}}(Pc&3)!==0&&Jf(),os(s),N=s.pendingLanes,(p&4194090)!==0&&(N&42)!==0?s===nm?Ic++:(Ic=0,nm=s):Ic=0,vd(0)}}function Dy(s,c){(s.pooledCacheLanes&=c)===0&&(c=s.pooledCache,c!=null&&(s.pooledCache=null,$u(c)))}function Jf(s){return Ey(),Ty(),Ay(),Py()}function Py(){if(Wi!==5)return!1;var s=Tl,c=em;em=0;var p=wn(Pc),x=Q.T,N=q.p;try{q.p=32>p?32:p,Q.T=null,p=tm,tm=null;var D=Tl,G=Pc;if(Wi=0,Dc=Tl=null,Pc=0,(_n&6)!==0)throw Error(r(331));var X=_n;if(_n|=4,gy(D.current),hy(D,D.current,G,p),_n=X,vd(0,!1),de&&typeof de.onPostCommitFiberRoot=="function")try{de.onPostCommitFiberRoot(J,D)}catch{}return!0}finally{q.p=N,Q.T=x,Dy(s,c)}}function Iy(s,c,p){c=pi(p,c),c=Rf(s.stateNode,c,2),s=Ts(s,c,2),s!==null&&(Ot(s,2),os(s))}function $n(s,c,p){if(s.tag===3)Iy(s,s,p);else for(;c!==null;){if(c.tag===3){Iy(c,s,p);break}else if(c.tag===1){var x=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(El===null||!El.has(x))){s=pi(p,s),p=$p(2),x=Ts(c,p,2),x!==null&&(Kg(p,x,c,s),Ot(x,2),os(x));break}}c=c.return}}function lm(s,c,p){var x=s.pingCache;if(x===null){x=s.pingCache=new Qp;var N=new Set;x.set(c,N)}else N=x.get(c),N===void 0&&(N=new Set,x.set(c,N));N.has(p)||(Jp=!0,N.add(p),s=iv.bind(null,s,c,p),c.then(s,s))}function iv(s,c,p){var x=s.pingCache;x!==null&&x.delete(c),s.pingedLanes|=s.suspendedLanes&p,s.warmLanes&=~p,qn===s&&(pn&p)===p&&(yi===4||yi===3&&(pn&62914560)===pn&&300>Me()-Zp?(_n&2)===0&&Mc(s,0):Kp|=p,Tc===pn&&(Tc=0)),os(s)}function My(s,c){c===0&&(c=_t()),s=ho(s,c),s!==null&&(Ot(s,c),os(s))}function Kf(s){var c=s.memoizedState,p=0;c!==null&&(p=c.retryLane),My(s,p)}function rv(s,c){var p=0;switch(s.tag){case 13:var x=s.stateNode,N=s.memoizedState;N!==null&&(p=N.retryLane);break;case 19:x=s.stateNode;break;case 22:x=s.stateNode._retryCache;break;default:throw Error(r(314))}x!==null&&x.delete(c),My(s,p)}function Ry(s,c){return je(s,c)}var xd=null,Dl=null,Xf=!1,bd=!1,Zf=!1,Pl=0;function os(s){s!==Dl&&s.next===null&&(Dl===null?xd=Dl=s:Dl=Dl.next=s),bd=!0,Xf||(Xf=!0,om())}function vd(s,c){if(!Zf&&bd){Zf=!0;do for(var p=!1,x=xd;x!==null;){if(s!==0){var N=x.pendingLanes;if(N===0)var D=0;else{var G=x.suspendedLanes,X=x.pingedLanes;D=(1<<31-be(42|s)+1)-1,D&=N&~(G&~X),D=D&201326741?D&201326741|1:D?D|2:0}D!==0&&(p=!0,Oy(x,D))}else D=pn,D=qe(x,x===qn?D:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(D&3)===0||Ke(x,D)||(p=!0,Oy(x,D));x=x.next}while(p);Zf=!1}}function av(){wd()}function wd(){bd=Xf=!1;var s=0;Pl!==0&&(fv()&&(s=Pl),Pl=0);for(var c=Me(),p=null,x=xd;x!==null;){var N=x.next,D=Nd(x,c);D===0?(x.next=null,p===null?xd=N:p.next=N,N===null&&(Dl=p)):(p=x,(s!==0||(D&3)!==0)&&(bd=!0)),x=N}vd(s)}function Nd(s,c){for(var p=s.suspendedLanes,x=s.pingedLanes,N=s.expirationTimes,D=s.pendingLanes&-62914561;0<D;){var G=31-be(D),X=1<<G,ye=N[G];ye===-1?((X&p)===0||(X&x)!==0)&&(N[G]=We(X,c)):ye<=c&&(s.expiredLanes|=X),D&=~X}if(c=qn,p=pn,p=qe(s,s===c?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x=s.callbackNode,p===0||s===c&&(kn===2||kn===9)||s.cancelPendingCommit!==null)return x!==null&&x!==null&&he(x),s.callbackNode=null,s.callbackPriority=0;if((p&3)===0||Ke(s,p)){if(c=p&-p,c===s.callbackPriority)return c;switch(x!==null&&he(x),wn(p)){case 2:case 8:p=nt;break;case 32:p=Ge;break;case 268435456:p=It;break;default:p=Ge}return x=Ly.bind(null,s),p=je(p,x),s.callbackPriority=c,s.callbackNode=p,c}return x!==null&&x!==null&&he(x),s.callbackPriority=2,s.callbackNode=null,2}function Ly(s,c){if(Wi!==0&&Wi!==5)return s.callbackNode=null,s.callbackPriority=0,null;var p=s.callbackNode;if(Jf()&&s.callbackNode!==p)return null;var x=pn;return x=qe(s,s===qn?x:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x===0?null:(vy(s,x,c),Nd(s,Me()),s.callbackNode!=null&&s.callbackNode===p?Ly.bind(null,s):null)}function Oy(s,c){if(Jf())return null;vy(s,c,!0)}function om(){pv(function(){(_n&6)!==0?je(Je,av):wd()})}function eh(){return Pl===0&&(Pl=zt()),Pl}function Fy(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:bs(""+s)}function $y(s,c){var p=c.ownerDocument.createElement("input");return p.name=c.name,p.value=c.value,s.id&&p.setAttribute("form",s.id),c.parentNode.insertBefore(p,c),s=new FormData(s),p.parentNode.removeChild(p),s}function sv(s,c,p,x,N){if(c==="submit"&&p&&p.stateNode===N){var D=Fy((N[oi]||null).action),G=x.submitter;G&&(c=(c=G[oi]||null)?Fy(c.formAction):G.getAttribute("formAction"),c!==null&&(D=c,G=null));var X=new ol("action","action",null,x,N);s.push({event:X,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Pl!==0){var ye=G?$y(N,G):new FormData(N);Xu(p,{pending:!0,data:ye,method:N.method,action:D},null,ye)}}else typeof D=="function"&&(X.preventDefault(),ye=G?$y(N,G):new FormData(N),Xu(p,{pending:!0,data:ye,method:N.method,action:D},D,ye))},currentTarget:N}]})}}for(var cm=0;cm<sn.length;cm++){var um=sn[cm],lv=um.toLowerCase(),ov=um[0].toUpperCase()+um.slice(1);cr(lv,"on"+ov)}cr(ge,"onAnimationEnd"),cr(pe,"onAnimationIteration"),cr(_e,"onAnimationStart"),cr("dblclick","onDoubleClick"),cr("focusin","onFocus"),cr("focusout","onBlur"),cr(at,"onTransitionRun"),cr(gt,"onTransitionStart"),cr(yt,"onTransitionCancel"),cr(pt,"onTransitionEnd"),Va("onMouseEnter",["mouseout","mouseover"]),Va("onMouseLeave",["mouseout","mouseover"]),Va("onPointerEnter",["pointerout","pointerover"]),Va("onPointerLeave",["pointerout","pointerover"]),ys("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ys("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ys("onBeforeInput",["compositionend","keypress","textInput","paste"]),ys("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ys("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ys("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Sd));function zy(s,c){c=(c&4)!==0;for(var p=0;p<s.length;p++){var x=s[p],N=x.event;x=x.listeners;e:{var D=void 0;if(c)for(var G=x.length-1;0<=G;G--){var X=x[G],ye=X.instance,Pe=X.currentTarget;if(X=X.listener,ye!==D&&N.isPropagationStopped())break e;D=X,N.currentTarget=Pe;try{D(N)}catch(Ye){Ao(Ye)}N.currentTarget=null,D=ye}else for(G=0;G<x.length;G++){if(X=x[G],ye=X.instance,Pe=X.currentTarget,X=X.listener,ye!==D&&N.isPropagationStopped())break e;D=X,N.currentTarget=Pe;try{D(N)}catch(Ye){Ao(Ye)}N.currentTarget=null,D=ye}}}}function nn(s,c){var p=c[Hi];p===void 0&&(p=c[Hi]=new Set);var x=s+"__bubble";p.has(x)||(By(c,s,2,!1),p.add(x))}function dm(s,c,p){var x=0;c&&(x|=4),By(p,s,x,c)}var Tr="_reactListening"+Math.random().toString(36).slice(2);function fm(s){if(!s[Tr]){s[Tr]=!0,Jd.forEach(function(p){p!=="selectionchange"&&(cv.has(p)||dm(p,!1,s),dm(p,!0,s))});var c=s.nodeType===9?s:s.ownerDocument;c===null||c[Tr]||(c[Tr]=!0,dm("selectionchange",!1,c))}}function By(s,c,p,x){switch(sx(c)){case 2:var N=kv;break;case 8:N=Uc;break;default:N=Nm}p=N.bind(null,c,p,s),N=void 0,!Or||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(N=!0),x?N!==void 0?s.addEventListener(c,p,{capture:!0,passive:N}):s.addEventListener(c,p,!0):N!==void 0?s.addEventListener(c,p,{passive:N}):s.addEventListener(c,p,!1)}function zs(s,c,p,x,N){var D=x;if((c&1)===0&&(c&2)===0&&x!==null)e:for(;;){if(x===null)return;var G=x.tag;if(G===3||G===4){var X=x.stateNode.containerInfo;if(X===N)break;if(G===4)for(G=x.return;G!==null;){var ye=G.tag;if((ye===3||ye===4)&&G.stateNode.containerInfo===N)return;G=G.return}for(;X!==null;){if(G=Ks(X),G===null)return;if(ye=G.tag,ye===5||ye===6||ye===26||ye===27){x=D=G;continue e}X=X.parentNode}}x=x.return}Kr(function(){var Pe=D,Ye=eo(p),Ze=[];e:{var Oe=Ni.get(s);if(Oe!==void 0){var Ie=ol,Tt=s;switch(s){case"keypress":if(xn(p)===0)break e;case"keydown":case"keyup":Ie=dl;break;case"focusin":Tt="focus",Ie=Ca;break;case"focusout":Tt="blur",Ie=Ca;break;case"beforeblur":case"afterblur":Ie=Ca;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ie=xr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ie=xu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ie=ic;break;case ge:case pe:case _e:Ie=tc;break;case pt:Ie=ip;break;case"scroll":case"scrollend":Ie=Zd;break;case"wheel":Ie=ap;break;case"copy":case"cut":case"paste":Ie=Ss;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ie=$r;break;case"toggle":case"beforetoggle":Ie=rc}var kt=(c&4)!==0,In=!kt&&(s==="scroll"||s==="scrollend"),ke=kt?Oe!==null?Oe+"Capture":null:Oe;kt=[];for(var Se=Pe,Te;Se!==null;){var Qe=Se;if(Te=Qe.stateNode,Qe=Qe.tag,Qe!==5&&Qe!==26&&Qe!==27||Te===null||ke===null||(Qe=vs(Se,ke),Qe!=null&&kt.push(Ft(Se,Qe,Te))),In)break;Se=Se.return}0<kt.length&&(Oe=new Ie(Oe,Tt,null,p,Ye),Ze.push({event:Oe,listeners:kt}))}}if((c&7)===0){e:{if(Oe=s==="mouseover"||s==="pointerover",Ie=s==="mouseout"||s==="pointerout",Oe&&p!==sl&&(Tt=p.relatedTarget||p.fromElement)&&(Ks(Tt)||Tt[Si]))break e;if((Ie||Oe)&&(Oe=Ye.window===Ye?Ye:(Oe=Ye.ownerDocument)?Oe.defaultView||Oe.parentWindow:window,Ie?(Tt=p.relatedTarget||p.toElement,Ie=Pe,Tt=Tt?Ks(Tt):null,Tt!==null&&(In=l(Tt),kt=Tt.tag,Tt!==In||kt!==5&&kt!==27&&kt!==6)&&(Tt=null)):(Ie=null,Tt=Pe),Ie!==Tt)){if(kt=xr,Qe="onMouseLeave",ke="onMouseEnter",Se="mouse",(s==="pointerout"||s==="pointerover")&&(kt=$r,Qe="onPointerLeave",ke="onPointerEnter",Se="pointer"),In=Ie==null?Oe:qa(Ie),Te=Tt==null?Oe:qa(Tt),Oe=new kt(Qe,Se+"leave",Ie,p,Ye),Oe.target=In,Oe.relatedTarget=Te,Qe=null,Ks(Ye)===Pe&&(kt=new kt(ke,Se+"enter",Tt,p,Ye),kt.target=Te,kt.relatedTarget=In,Qe=kt),In=Qe,Ie&&Tt)t:{for(kt=Ie,ke=Tt,Se=0,Te=kt;Te;Te=Ii(Te))Se++;for(Te=0,Qe=ke;Qe;Qe=Ii(Qe))Te++;for(;0<Se-Te;)kt=Ii(kt),Se--;for(;0<Te-Se;)ke=Ii(ke),Te--;for(;Se--;){if(kt===ke||ke!==null&&kt===ke.alternate)break t;kt=Ii(kt),ke=Ii(ke)}kt=null}else kt=null;Ie!==null&&xi(Ze,Oe,Ie,kt,!1),Tt!==null&&In!==null&&xi(Ze,In,Tt,kt,!0)}}e:{if(Oe=Pe?qa(Pe):window,Ie=Oe.nodeName&&Oe.nodeName.toLowerCase(),Ie==="select"||Ie==="input"&&Oe.type==="file")var xt=af;else if(co(Oe))if(Cu)xt=ku;else{xt=lr;var Zt=of}else Ie=Oe.nodeName,!Ie||Ie.toLowerCase()!=="input"||Oe.type!=="checkbox"&&Oe.type!=="radio"?Pe&&Xo(Pe.elementType)&&(xt=af):xt=oc;if(xt&&(xt=xt(s,Pe))){js(Ze,xt,p,Ye);break e}Zt&&Zt(s,Oe,Pe),s==="focusout"&&Pe&&Oe.type==="number"&&Pe.memoizedProps.value!=null&&il(Oe,"number",Oe.value)}switch(Zt=Pe?qa(Pe):window,s){case"focusin":(co(Zt)||Zt.contentEditable==="true")&&(pl=Zt,es=Pe,Ce=null);break;case"focusout":Ce=es=pl=null;break;case"mousedown":He=!0;break;case"contextmenu":case"mouseup":case"dragend":He=!1,Ue(Ze,p,Ye);break;case"selectionchange":if(lp)break;case"keydown":case"keyup":Ue(Ze,p,Ye)}var vt;if(Su)e:{switch(s){case"compositionstart":var At="onCompositionStart";break e;case"compositionend":At="onCompositionEnd";break e;case"compositionupdate":At="onCompositionUpdate";break e}At=void 0}else Yi?oo(s,p)&&(At="onCompositionEnd"):s==="keydown"&&p.keyCode===229&&(At="onCompositionStart");At&&(ac&&p.locale!=="ko"&&(Yi||At!=="onCompositionStart"?At==="onCompositionEnd"&&Yi&&(vt=ec()):(Wa=Ye,ll="value"in Wa?Wa.value:Wa.textContent,Yi=!0)),Zt=th(Pe,At),0<Zt.length&&(At=new ci(At,s,null,p,Ye),Ze.push({event:At,listeners:Zt}),vt?At.data=vt:(vt=sc(p),vt!==null&&(At.data=vt)))),(vt=nf?Ka(s,p):Zr(s,p))&&(At=th(Pe,"onBeforeInput"),0<At.length&&(Zt=new ci("onBeforeInput","beforeinput",null,p,Ye),Ze.push({event:Zt,listeners:At}),Zt.data=vt)),sv(Ze,s,Pe,p,Ye)}zy(Ze,c)})}function Ft(s,c,p){return{instance:s,listener:c,currentTarget:p}}function th(s,c){for(var p=c+"Capture",x=[];s!==null;){var N=s,D=N.stateNode;if(N=N.tag,N!==5&&N!==26&&N!==27||D===null||(N=vs(s,p),N!=null&&x.unshift(Ft(s,N,D)),N=vs(s,c),N!=null&&x.push(Ft(s,N,D))),s.tag===3)return x;s=s.return}return[]}function Ii(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function xi(s,c,p,x,N){for(var D=c._reactName,G=[];p!==null&&p!==x;){var X=p,ye=X.alternate,Pe=X.stateNode;if(X=X.tag,ye!==null&&ye===x)break;X!==5&&X!==26&&X!==27||Pe===null||(ye=Pe,N?(Pe=vs(p,D),Pe!=null&&G.unshift(Ft(p,Pe,ye))):N||(Pe=vs(p,D),Pe!=null&&G.push(Ft(p,Pe,ye)))),p=p.return}G.length!==0&&s.push({event:c,listeners:G})}var uv=/\r\n?/g,Il=/\u0000|\uFFFD/g;function Uy(s){return(typeof s=="string"?s:""+s).replace(uv,`
`).replace(Il,"")}function qy(s,c){return c=Uy(c),Uy(s)===c}function nh(){}function Pn(s,c,p,x,N,D){switch(p){case"children":typeof x=="string"?c==="body"||c==="textarea"&&x===""||Na(s,x):(typeof x=="number"||typeof x=="bigint")&&c!=="body"&&Na(s,""+x);break;case"className":tl(s,"class",x);break;case"tabIndex":tl(s,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":tl(s,p,x);break;case"style":al(s,x,D);break;case"data":if(c!=="object"){tl(s,"data",x);break}case"src":case"href":if(x===""&&(c!=="a"||p!=="href")){s.removeAttribute(p);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(p);break}x=bs(""+x),s.setAttribute(p,x);break;case"action":case"formAction":if(typeof x=="function"){s.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof D=="function"&&(p==="formAction"?(c!=="input"&&Pn(s,c,"name",N.name,N,null),Pn(s,c,"formEncType",N.formEncType,N,null),Pn(s,c,"formMethod",N.formMethod,N,null),Pn(s,c,"formTarget",N.formTarget,N,null)):(Pn(s,c,"encType",N.encType,N,null),Pn(s,c,"method",N.method,N,null),Pn(s,c,"target",N.target,N,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(p);break}x=bs(""+x),s.setAttribute(p,x);break;case"onClick":x!=null&&(s.onclick=nh);break;case"onScroll":x!=null&&nn("scroll",s);break;case"onScrollEnd":x!=null&&nn("scrollend",s);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(p=x.__html,p!=null){if(N.children!=null)throw Error(r(60));s.innerHTML=p}}break;case"multiple":s.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":s.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){s.removeAttribute("xlink:href");break}p=bs(""+x),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,""+x):s.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,""):s.removeAttribute(p);break;case"capture":case"download":x===!0?s.setAttribute(p,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,x):s.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?s.setAttribute(p,x):s.removeAttribute(p);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?s.removeAttribute(p):s.setAttribute(p,x);break;case"popover":nn("beforetoggle",s),nn("toggle",s),Ql(s,"popover",x);break;case"xlinkActuate":yr(s,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":yr(s,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":yr(s,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":yr(s,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":yr(s,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":yr(s,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":yr(s,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":yr(s,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":yr(s,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":Ql(s,"is",x);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=Zl.get(p)||p,Ql(s,p,x))}}function hm(s,c,p,x,N,D){switch(p){case"style":al(s,x,D);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(p=x.__html,p!=null){if(N.children!=null)throw Error(r(60));s.innerHTML=p}}break;case"children":typeof x=="string"?Na(s,x):(typeof x=="number"||typeof x=="bigint")&&Na(s,""+x);break;case"onScroll":x!=null&&nn("scroll",s);break;case"onScrollEnd":x!=null&&nn("scrollend",s);break;case"onClick":x!=null&&(s.onclick=nh);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Wo.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(N=p.endsWith("Capture"),c=p.slice(2,N?p.length-7:void 0),D=s[oi]||null,D=D!=null?D[p]:null,typeof D=="function"&&s.removeEventListener(c,D,N),typeof x=="function")){typeof D!="function"&&D!==null&&(p in s?s[p]=null:s.hasAttribute(p)&&s.removeAttribute(p)),s.addEventListener(c,x,N);break e}p in s?s[p]=x:x===!0?s.setAttribute(p,""):Ql(s,p,x)}}}function Mi(s,c,p){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":nn("error",s),nn("load",s);var x=!1,N=!1,D;for(D in p)if(p.hasOwnProperty(D)){var G=p[D];if(G!=null)switch(D){case"src":x=!0;break;case"srcSet":N=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:Pn(s,c,D,G,p,null)}}N&&Pn(s,c,"srcSet",p.srcSet,p,null),x&&Pn(s,c,"src",p.src,p,null);return;case"input":nn("invalid",s);var X=D=G=N=null,ye=null,Pe=null;for(x in p)if(p.hasOwnProperty(x)){var Ye=p[x];if(Ye!=null)switch(x){case"name":N=Ye;break;case"type":G=Ye;break;case"checked":ye=Ye;break;case"defaultChecked":Pe=Ye;break;case"value":D=Ye;break;case"defaultValue":X=Ye;break;case"children":case"dangerouslySetInnerHTML":if(Ye!=null)throw Error(r(137,c));break;default:Pn(s,c,x,Ye,p,null)}}nl(s,D,X,ye,Pe,G,N,!1),Kl(s);return;case"select":nn("invalid",s),x=G=D=null;for(N in p)if(p.hasOwnProperty(N)&&(X=p[N],X!=null))switch(N){case"value":D=X;break;case"defaultValue":G=X;break;case"multiple":x=X;default:Pn(s,c,N,X,p,null)}c=D,p=G,s.multiple=!!x,c!=null?wa(s,!!x,c,!1):p!=null&&wa(s,!!x,p,!0);return;case"textarea":nn("invalid",s),D=N=x=null;for(G in p)if(p.hasOwnProperty(G)&&(X=p[G],X!=null))switch(G){case"value":x=X;break;case"defaultValue":N=X;break;case"children":D=X;break;case"dangerouslySetInnerHTML":if(X!=null)throw Error(r(91));break;default:Pn(s,c,G,X,p,null)}xs(s,x,N,D),Kl(s);return;case"option":for(ye in p)if(p.hasOwnProperty(ye)&&(x=p[ye],x!=null))switch(ye){case"selected":s.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:Pn(s,c,ye,x,p,null)}return;case"dialog":nn("beforetoggle",s),nn("toggle",s),nn("cancel",s),nn("close",s);break;case"iframe":case"object":nn("load",s);break;case"video":case"audio":for(x=0;x<Sd.length;x++)nn(Sd[x],s);break;case"image":nn("error",s),nn("load",s);break;case"details":nn("toggle",s);break;case"embed":case"source":case"link":nn("error",s),nn("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Pe in p)if(p.hasOwnProperty(Pe)&&(x=p[Pe],x!=null))switch(Pe){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:Pn(s,c,Pe,x,p,null)}return;default:if(Xo(c)){for(Ye in p)p.hasOwnProperty(Ye)&&(x=p[Ye],x!==void 0&&hm(s,c,Ye,x,p,void 0));return}}for(X in p)p.hasOwnProperty(X)&&(x=p[X],x!=null&&Pn(s,c,X,x,p,null))}function dv(s,c,p,x){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var N=null,D=null,G=null,X=null,ye=null,Pe=null,Ye=null;for(Ie in p){var Ze=p[Ie];if(p.hasOwnProperty(Ie)&&Ze!=null)switch(Ie){case"checked":break;case"value":break;case"defaultValue":ye=Ze;default:x.hasOwnProperty(Ie)||Pn(s,c,Ie,null,x,Ze)}}for(var Oe in x){var Ie=x[Oe];if(Ze=p[Oe],x.hasOwnProperty(Oe)&&(Ie!=null||Ze!=null))switch(Oe){case"type":D=Ie;break;case"name":N=Ie;break;case"checked":Pe=Ie;break;case"defaultChecked":Ye=Ie;break;case"value":G=Ie;break;case"defaultValue":X=Ie;break;case"children":case"dangerouslySetInnerHTML":if(Ie!=null)throw Error(r(137,c));break;default:Ie!==Ze&&Pn(s,c,Oe,Ie,x,Ze)}}Xl(s,G,X,ye,Pe,Ye,D,N);return;case"select":Ie=G=X=Oe=null;for(D in p)if(ye=p[D],p.hasOwnProperty(D)&&ye!=null)switch(D){case"value":break;case"multiple":Ie=ye;default:x.hasOwnProperty(D)||Pn(s,c,D,null,x,ye)}for(N in x)if(D=x[N],ye=p[N],x.hasOwnProperty(N)&&(D!=null||ye!=null))switch(N){case"value":Oe=D;break;case"defaultValue":X=D;break;case"multiple":G=D;default:D!==ye&&Pn(s,c,N,D,x,ye)}c=X,p=G,x=Ie,Oe!=null?wa(s,!!p,Oe,!1):!!x!=!!p&&(c!=null?wa(s,!!p,c,!0):wa(s,!!p,p?[]:"",!1));return;case"textarea":Ie=Oe=null;for(X in p)if(N=p[X],p.hasOwnProperty(X)&&N!=null&&!x.hasOwnProperty(X))switch(X){case"value":break;case"children":break;default:Pn(s,c,X,null,x,N)}for(G in x)if(N=x[G],D=p[G],x.hasOwnProperty(G)&&(N!=null||D!=null))switch(G){case"value":Oe=N;break;case"defaultValue":Ie=N;break;case"children":break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(r(91));break;default:N!==D&&Pn(s,c,G,N,x,D)}Ko(s,Oe,Ie);return;case"option":for(var Tt in p)if(Oe=p[Tt],p.hasOwnProperty(Tt)&&Oe!=null&&!x.hasOwnProperty(Tt))switch(Tt){case"selected":s.selected=!1;break;default:Pn(s,c,Tt,null,x,Oe)}for(ye in x)if(Oe=x[ye],Ie=p[ye],x.hasOwnProperty(ye)&&Oe!==Ie&&(Oe!=null||Ie!=null))switch(ye){case"selected":s.selected=Oe&&typeof Oe!="function"&&typeof Oe!="symbol";break;default:Pn(s,c,ye,Oe,x,Ie)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var kt in p)Oe=p[kt],p.hasOwnProperty(kt)&&Oe!=null&&!x.hasOwnProperty(kt)&&Pn(s,c,kt,null,x,Oe);for(Pe in x)if(Oe=x[Pe],Ie=p[Pe],x.hasOwnProperty(Pe)&&Oe!==Ie&&(Oe!=null||Ie!=null))switch(Pe){case"children":case"dangerouslySetInnerHTML":if(Oe!=null)throw Error(r(137,c));break;default:Pn(s,c,Pe,Oe,x,Ie)}return;default:if(Xo(c)){for(var In in p)Oe=p[In],p.hasOwnProperty(In)&&Oe!==void 0&&!x.hasOwnProperty(In)&&hm(s,c,In,void 0,x,Oe);for(Ye in x)Oe=x[Ye],Ie=p[Ye],!x.hasOwnProperty(Ye)||Oe===Ie||Oe===void 0&&Ie===void 0||hm(s,c,Ye,Oe,x,Ie);return}}for(var ke in p)Oe=p[ke],p.hasOwnProperty(ke)&&Oe!=null&&!x.hasOwnProperty(ke)&&Pn(s,c,ke,null,x,Oe);for(Ze in x)Oe=x[Ze],Ie=p[Ze],!x.hasOwnProperty(Ze)||Oe===Ie||Oe==null&&Ie==null||Pn(s,c,Ze,Oe,x,Ie)}var Pa=null,ih=null;function Mo(s){return s.nodeType===9?s:s.ownerDocument}function ni(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function di(s,c){if(s===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&c==="foreignObject"?0:s}function rh(s,c){return s==="textarea"||s==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var pm=null;function fv(){var s=window.event;return s&&s.type==="popstate"?s===pm?!1:(pm=s,!0):(pm=null,!1)}var Vy=typeof setTimeout=="function"?setTimeout:void 0,hv=typeof clearTimeout=="function"?clearTimeout:void 0,Hy=typeof Promise=="function"?Promise:void 0,pv=typeof queueMicrotask=="function"?queueMicrotask:typeof Hy<"u"?function(s){return Hy.resolve(null).then(s).catch(Gy)}:Vy;function Gy(s){setTimeout(function(){throw s})}function ua(s){return s==="head"}function ah(s,c){var p=c,x=0,N=0;do{var D=p.nextSibling;if(s.removeChild(p),D&&D.nodeType===8)if(p=D.data,p==="/$"){if(0<x&&8>x){p=x;var G=s.ownerDocument;if(p&1&&jd(G.documentElement),p&2&&jd(G.body),p&4)for(p=G.head,jd(p),G=p.firstChild;G;){var X=G.nextSibling,ye=G.nodeName;G[gs]||ye==="SCRIPT"||ye==="STYLE"||ye==="LINK"&&G.rel.toLowerCase()==="stylesheet"||p.removeChild(G),G=X}}if(N===0){s.removeChild(D),Pd(c);return}N--}else p==="$"||p==="$?"||p==="$!"?N++:x=p.charCodeAt(0)-48;else x=0;p=D}while(p);Pd(c)}function mm(s){var c=s.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var p=c;switch(c=c.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":mm(p),du(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}s.removeChild(p)}}function Yy(s,c,p,x){for(;s.nodeType===1;){var N=p;if(s.nodeName.toLowerCase()!==c.toLowerCase()){if(!x&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(x){if(!s[gs])switch(c){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(D=s.getAttribute("rel"),D==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(D!==N.rel||s.getAttribute("href")!==(N.href==null||N.href===""?null:N.href)||s.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin)||s.getAttribute("title")!==(N.title==null?null:N.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(D=s.getAttribute("src"),(D!==(N.src==null?null:N.src)||s.getAttribute("type")!==(N.type==null?null:N.type)||s.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin))&&D&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(c==="input"&&s.type==="hidden"){var D=N.name==null?null:""+N.name;if(N.type==="hidden"&&s.getAttribute("name")===D)return s}else return s;if(s=Ia(s.nextSibling),s===null)break}return null}function sh(s,c,p){if(c==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!p||(s=Ia(s.nextSibling),s===null))return null;return s}function pr(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function Lc(s,c){var p=s.ownerDocument;if(s.data!=="$?"||p.readyState==="complete")c();else{var x=function(){c(),p.removeEventListener("DOMContentLoaded",x)};p.addEventListener("DOMContentLoaded",x),s._reactRetry=x}}function Ia(s){for(;s!=null;s=s.nextSibling){var c=s.nodeType;if(c===1||c===3)break;if(c===8){if(c=s.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return s}var gm=null;function Wy(s){s=s.previousSibling;for(var c=0;s;){if(s.nodeType===8){var p=s.data;if(p==="$"||p==="$!"||p==="$?"){if(c===0)return s;c--}else p==="/$"&&c++}s=s.previousSibling}return null}function Qy(s,c,p){switch(c=Mo(p),s){case"html":if(s=c.documentElement,!s)throw Error(r(452));return s;case"head":if(s=c.head,!s)throw Error(r(453));return s;case"body":if(s=c.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function jd(s){for(var c=s.attributes;c.length;)s.removeAttributeNode(c[0]);du(s)}var Gr=new Map,cs=new Set;function qt(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var us=q.d;q.d={f:da,r:Jy,D:mv,C:Ky,L:lh,m:gv,X:xv,S:yv,M:bv};function da(){var s=us.f(),c=Wf();return s||c}function Jy(s){var c=Xs(s);c!==null&&c.tag===5&&c.type==="form"?Df(c):us.r(s)}var Oc=typeof document>"u"?null:document;function Nn(s,c,p){var x=Oc;if(x&&typeof c=="string"&&c){var N=Gi(c);N='link[rel="'+s+'"][href="'+N+'"]',typeof p=="string"&&(N+='[crossorigin="'+p+'"]'),cs.has(N)||(cs.add(N),s={rel:s,crossOrigin:p,href:c},x.querySelector(N)===null&&(c=x.createElement("link"),Mi(c,"link",s),ji(c),x.head.appendChild(c)))}}function mv(s){us.D(s),Nn("dns-prefetch",s,null)}function Ky(s,c){us.C(s,c),Nn("preconnect",s,c)}function lh(s,c,p){us.L(s,c,p);var x=Oc;if(x&&s&&c){var N='link[rel="preload"][as="'+Gi(c)+'"]';c==="image"&&p&&p.imageSrcSet?(N+='[imagesrcset="'+Gi(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(N+='[imagesizes="'+Gi(p.imageSizes)+'"]')):N+='[href="'+Gi(s)+'"]';var D=N;switch(c){case"style":D=Fc(s);break;case"script":D=$c(s)}Gr.has(D)||(s=h({rel:"preload",href:c==="image"&&p&&p.imageSrcSet?void 0:s,as:c},p),Gr.set(D,s),x.querySelector(N)!==null||c==="style"&&x.querySelector(Cd(D))||c==="script"&&x.querySelector(_d(D))||(c=x.createElement("link"),Mi(c,"link",s),ji(c),x.head.appendChild(c)))}}function gv(s,c){us.m(s,c);var p=Oc;if(p&&s){var x=c&&typeof c.as=="string"?c.as:"script",N='link[rel="modulepreload"][as="'+Gi(x)+'"][href="'+Gi(s)+'"]',D=N;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":D=$c(s)}if(!Gr.has(D)&&(s=h({rel:"modulepreload",href:s},c),Gr.set(D,s),p.querySelector(N)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(_d(D)))return}x=p.createElement("link"),Mi(x,"link",s),ji(x),p.head.appendChild(x)}}}function yv(s,c,p){us.S(s,c,p);var x=Oc;if(x&&s){var N=Zs(x).hoistableStyles,D=Fc(s);c=c||"default";var G=N.get(D);if(!G){var X={loading:0,preload:null};if(G=x.querySelector(Cd(D)))X.loading=5;else{s=h({rel:"stylesheet",href:s,"data-precedence":c},p),(p=Gr.get(D))&&kd(s,p);var ye=G=x.createElement("link");ji(ye),Mi(ye,"link",s),ye._p=new Promise(function(Pe,Ye){ye.onload=Pe,ye.onerror=Ye}),ye.addEventListener("load",function(){X.loading|=1}),ye.addEventListener("error",function(){X.loading|=2}),X.loading|=4,oh(G,c,x)}G={type:"stylesheet",instance:G,count:1,state:X},N.set(D,G)}}}function xv(s,c){us.X(s,c);var p=Oc;if(p&&s){var x=Zs(p).hoistableScripts,N=$c(s),D=x.get(N);D||(D=p.querySelector(_d(N)),D||(s=h({src:s,async:!0},c),(c=Gr.get(N))&&ym(s,c),D=p.createElement("script"),ji(D),Mi(D,"link",s),p.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},x.set(N,D))}}function bv(s,c){us.M(s,c);var p=Oc;if(p&&s){var x=Zs(p).hoistableScripts,N=$c(s),D=x.get(N);D||(D=p.querySelector(_d(N)),D||(s=h({src:s,async:!0,type:"module"},c),(c=Gr.get(N))&&ym(s,c),D=p.createElement("script"),ji(D),Mi(D,"link",s),p.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},x.set(N,D))}}function Xy(s,c,p,x){var N=(N=le.current)?qt(N):null;if(!N)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(c=Fc(p.href),p=Zs(N).hoistableStyles,x=p.get(c),x||(x={type:"style",instance:null,count:0,state:null},p.set(c,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){s=Fc(p.href);var D=Zs(N).hoistableStyles,G=D.get(s);if(G||(N=N.ownerDocument||N,G={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},D.set(s,G),(D=N.querySelector(Cd(s)))&&!D._p&&(G.instance=D,G.state.loading=5),Gr.has(s)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},Gr.set(s,p),D||vv(N,s,p,G.state))),c&&x===null)throw Error(r(528,""));return G}if(c&&x!==null)throw Error(r(529,""));return null;case"script":return c=p.async,p=p.src,typeof p=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=$c(p),p=Zs(N).hoistableScripts,x=p.get(c),x||(x={type:"script",instance:null,count:0,state:null},p.set(c,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Fc(s){return'href="'+Gi(s)+'"'}function Cd(s){return'link[rel="stylesheet"]['+s+"]"}function Zy(s){return h({},s,{"data-precedence":s.precedence,precedence:null})}function vv(s,c,p,x){s.querySelector('link[rel="preload"][as="style"]['+c+"]")?x.loading=1:(c=s.createElement("link"),x.preload=c,c.addEventListener("load",function(){return x.loading|=1}),c.addEventListener("error",function(){return x.loading|=2}),Mi(c,"link",p),ji(c),s.head.appendChild(c))}function $c(s){return'[src="'+Gi(s)+'"]'}function _d(s){return"script[async]"+s}function ex(s,c,p){if(c.count++,c.instance===null)switch(c.type){case"style":var x=s.querySelector('style[data-href~="'+Gi(p.href)+'"]');if(x)return c.instance=x,ji(x),x;var N=h({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return x=(s.ownerDocument||s).createElement("style"),ji(x),Mi(x,"style",N),oh(x,p.precedence,s),c.instance=x;case"stylesheet":N=Fc(p.href);var D=s.querySelector(Cd(N));if(D)return c.state.loading|=4,c.instance=D,ji(D),D;x=Zy(p),(N=Gr.get(N))&&kd(x,N),D=(s.ownerDocument||s).createElement("link"),ji(D);var G=D;return G._p=new Promise(function(X,ye){G.onload=X,G.onerror=ye}),Mi(D,"link",x),c.state.loading|=4,oh(D,p.precedence,s),c.instance=D;case"script":return D=$c(p.src),(N=s.querySelector(_d(D)))?(c.instance=N,ji(N),N):(x=p,(N=Gr.get(D))&&(x=h({},p),ym(x,N)),s=s.ownerDocument||s,N=s.createElement("script"),ji(N),Mi(N,"link",x),s.head.appendChild(N),c.instance=N);case"void":return null;default:throw Error(r(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(x=c.instance,c.state.loading|=4,oh(x,p.precedence,s));return c.instance}function oh(s,c,p){for(var x=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),N=x.length?x[x.length-1]:null,D=N,G=0;G<x.length;G++){var X=x[G];if(X.dataset.precedence===c)D=X;else if(D!==N)break}D?D.parentNode.insertBefore(s,D.nextSibling):(c=p.nodeType===9?p.head:p,c.insertBefore(s,c.firstChild))}function kd(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.title==null&&(s.title=c.title)}function ym(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.integrity==null&&(s.integrity=c.integrity)}var zc=null;function tx(s,c,p){if(zc===null){var x=new Map,N=zc=new Map;N.set(p,x)}else N=zc,x=N.get(p),x||(x=new Map,N.set(p,x));if(x.has(s))return x;for(x.set(s,null),p=p.getElementsByTagName(s),N=0;N<p.length;N++){var D=p[N];if(!(D[gs]||D[Ln]||s==="link"&&D.getAttribute("rel")==="stylesheet")&&D.namespaceURI!=="http://www.w3.org/2000/svg"){var G=D.getAttribute(c)||"";G=s+G;var X=x.get(G);X?X.push(D):x.set(G,[D])}}return x}function nx(s,c,p){s=s.ownerDocument||s,s.head.insertBefore(p,c==="title"?s.querySelector("head > title"):null)}function wv(s,c,p){if(p===1||c.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return s=c.disabled,typeof c.precedence=="string"&&s==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function Ri(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var zi=null;function Nv(){}function Sv(s,c,p){if(zi===null)throw Error(r(475));var x=zi;if(c.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var N=Fc(p.href),D=s.querySelector(Cd(N));if(D){s=D._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(x.count++,x=Ed.bind(x),s.then(x,x)),c.state.loading|=4,c.instance=D,ji(D);return}D=s.ownerDocument||s,p=Zy(p),(N=Gr.get(N))&&kd(p,N),D=D.createElement("link"),ji(D);var G=D;G._p=new Promise(function(X,ye){G.onload=X,G.onerror=ye}),Mi(D,"link",p),c.instance=D}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(x.count++,c=Ed.bind(x),s.addEventListener("load",c),s.addEventListener("error",c))}}function jv(){if(zi===null)throw Error(r(475));var s=zi;return s.stylesheets&&s.count===0&&xm(s,s.stylesheets),0<s.count?function(c){var p=setTimeout(function(){if(s.stylesheets&&xm(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(p)}}:null}function Ed(){if(this.count--,this.count===0){if(this.stylesheets)xm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var ch=null;function xm(s,c){s.stylesheets=null,s.unsuspend!==null&&(s.count++,ch=new Map,c.forEach(Cv,s),ch=null,Ed.call(s))}function Cv(s,c){if(!(c.state.loading&4)){var p=ch.get(s);if(p)var x=p.get(null);else{p=new Map,ch.set(s,p);for(var N=s.querySelectorAll("link[data-precedence],style[data-precedence]"),D=0;D<N.length;D++){var G=N[D];(G.nodeName==="LINK"||G.getAttribute("media")!=="not all")&&(p.set(G.dataset.precedence,G),x=G)}x&&p.set(null,x)}N=c.instance,G=N.getAttribute("data-precedence"),D=p.get(G)||x,D===x&&p.set(null,N),p.set(G,N),this.count++,x=Ed.bind(this),N.addEventListener("load",x),N.addEventListener("error",x),D?D.parentNode.insertBefore(N,D.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(N,s.firstChild)),c.state.loading|=4}}var Bc={$$typeof:I,Provider:null,Consumer:null,_currentValue:W,_currentValue2:W,_threadCount:0};function _v(s,c,p,x,N,D,G,X){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=rn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rn(0),this.hiddenUpdates=rn(null),this.identifierPrefix=x,this.onUncaughtError=N,this.onCaughtError=D,this.onRecoverableError=G,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=X,this.incompleteTransitions=new Map}function ix(s,c,p,x,N,D,G,X,ye,Pe,Ye,Ze){return s=new _v(s,c,p,G,X,ye,Pe,Ze),c=1,D===!0&&(c|=24),D=br(3,null,null,c),s.current=D,D.stateNode=s,c=fp(),c.refCount++,s.pooledCache=c,c.refCount++,D.memoizedState={element:x,isDehydrated:p,cache:c},wo(D),s}function rx(s){return s?(s=po,s):po}function bm(s,c,p,x,N,D){N=rx(N),x.context===null?x.context=N:x.pendingContext=N,x=xl(c),x.payload={element:p},D=D===void 0?null:D,D!==null&&(x.callback=D),p=Ts(s,x,c),p!==null&&(Hr(p,s,c),Bu(p,s,c))}function vm(s,c){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var p=s.retryLane;s.retryLane=p!==0&&p<c?p:c}}function wm(s,c){vm(s,c),(s=s.alternate)&&vm(s,c)}function ax(s){if(s.tag===13){var c=ho(s,67108864);c!==null&&Hr(c,s,67108864),wm(s,67108864)}}var uh=!0;function kv(s,c,p,x){var N=Q.T;Q.T=null;var D=q.p;try{q.p=2,Nm(s,c,p,x)}finally{q.p=D,Q.T=N}}function Uc(s,c,p,x){var N=Q.T;Q.T=null;var D=q.p;try{q.p=8,Nm(s,c,p,x)}finally{q.p=D,Q.T=N}}function Nm(s,c,p,x){if(uh){var N=Sm(x);if(N===null)zs(s,c,x,dh,p),lx(s,x);else if(Tv(N,s,c,p,x))x.stopPropagation();else if(lx(s,x),c&4&&-1<Ev.indexOf(s)){for(;N!==null;){var D=Xs(N);if(D!==null)switch(D.tag){case 3:if(D=D.stateNode,D.current.memoizedState.isDehydrated){var G=Ve(D.pendingLanes);if(G!==0){var X=D;for(X.pendingLanes|=2,X.entangledLanes|=2;G;){var ye=1<<31-be(G);X.entanglements[1]|=ye,G&=~ye}os(D),(_n&6)===0&&(Ac=Me()+500,vd(0))}}break;case 13:X=ho(D,2),X!==null&&Hr(X,D,2),Wf(),wm(D,2)}if(D=Sm(x),D===null&&zs(s,c,x,dh,p),D===N)break;N=D}N!==null&&x.stopPropagation()}else zs(s,c,x,null,p)}}function Sm(s){return s=eo(s),jm(s)}var dh=null;function jm(s){if(dh=null,s=Ks(s),s!==null){var c=l(s);if(c===null)s=null;else{var p=c.tag;if(p===13){if(s=o(c),s!==null)return s;s=null}else if(p===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;s=null}else c!==s&&(s=null)}}return dh=s,null}function sx(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(De()){case Je:return 2;case nt:return 8;case Ge:case St:return 32;case It:return 268435456;default:return 32}default:return 32}}var fh=!1,Bs=null,Ml=null,Rl=null,Td=new Map,Ad=new Map,Ll=[],Ev="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function lx(s,c){switch(s){case"focusin":case"focusout":Bs=null;break;case"dragenter":case"dragleave":Ml=null;break;case"mouseover":case"mouseout":Rl=null;break;case"pointerover":case"pointerout":Td.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ad.delete(c.pointerId)}}function Dd(s,c,p,x,N,D){return s===null||s.nativeEvent!==D?(s={blockedOn:c,domEventName:p,eventSystemFlags:x,nativeEvent:D,targetContainers:[N]},c!==null&&(c=Xs(c),c!==null&&ax(c)),s):(s.eventSystemFlags|=x,c=s.targetContainers,N!==null&&c.indexOf(N)===-1&&c.push(N),s)}function Tv(s,c,p,x,N){switch(c){case"focusin":return Bs=Dd(Bs,s,c,p,x,N),!0;case"dragenter":return Ml=Dd(Ml,s,c,p,x,N),!0;case"mouseover":return Rl=Dd(Rl,s,c,p,x,N),!0;case"pointerover":var D=N.pointerId;return Td.set(D,Dd(Td.get(D)||null,s,c,p,x,N)),!0;case"gotpointercapture":return D=N.pointerId,Ad.set(D,Dd(Ad.get(D)||null,s,c,p,x,N)),!0}return!1}function ox(s){var c=Ks(s.target);if(c!==null){var p=l(c);if(p!==null){if(c=p.tag,c===13){if(c=o(p),c!==null){s.blockedOn=c,Ji(s.priority,function(){if(p.tag===13){var x=rr();x=Ti(x);var N=ho(p,x);N!==null&&Hr(N,p,x),wm(p,x)}});return}}else if(c===3&&p.stateNode.current.memoizedState.isDehydrated){s.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}s.blockedOn=null}function hh(s){if(s.blockedOn!==null)return!1;for(var c=s.targetContainers;0<c.length;){var p=Sm(s.nativeEvent);if(p===null){p=s.nativeEvent;var x=new p.constructor(p.type,p);sl=x,p.target.dispatchEvent(x),sl=null}else return c=Xs(p),c!==null&&ax(c),s.blockedOn=p,!1;c.shift()}return!0}function cx(s,c,p){hh(s)&&p.delete(c)}function Av(){fh=!1,Bs!==null&&hh(Bs)&&(Bs=null),Ml!==null&&hh(Ml)&&(Ml=null),Rl!==null&&hh(Rl)&&(Rl=null),Td.forEach(cx),Ad.forEach(cx)}function ph(s,c){s.blockedOn===c&&(s.blockedOn=null,fh||(fh=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Av)))}var mh=null;function ux(s){mh!==s&&(mh=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){mh===s&&(mh=null);for(var c=0;c<s.length;c+=3){var p=s[c],x=s[c+1],N=s[c+2];if(typeof x!="function"){if(jm(x||p)===null)continue;break}var D=Xs(p);D!==null&&(s.splice(c,3),c-=3,Xu(D,{pending:!0,data:N,method:p.method,action:x},x,N))}}))}function Pd(s){function c(ye){return ph(ye,s)}Bs!==null&&ph(Bs,s),Ml!==null&&ph(Ml,s),Rl!==null&&ph(Rl,s),Td.forEach(c),Ad.forEach(c);for(var p=0;p<Ll.length;p++){var x=Ll[p];x.blockedOn===s&&(x.blockedOn=null)}for(;0<Ll.length&&(p=Ll[0],p.blockedOn===null);)ox(p),p.blockedOn===null&&Ll.shift();if(p=(s.ownerDocument||s).$$reactFormReplay,p!=null)for(x=0;x<p.length;x+=3){var N=p[x],D=p[x+1],G=N[oi]||null;if(typeof D=="function")G||ux(p);else if(G){var X=null;if(D&&D.hasAttribute("formAction")){if(N=D,G=D[oi]||null)X=G.formAction;else if(jm(N)!==null)continue}else X=G.action;typeof X=="function"?p[x+1]=X:(p.splice(x,3),x-=3),ux(p)}}}function Cm(s){this._internalRoot=s}gh.prototype.render=Cm.prototype.render=function(s){var c=this._internalRoot;if(c===null)throw Error(r(409));var p=c.current,x=rr();bm(p,x,s,c,null,null)},gh.prototype.unmount=Cm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var c=s.containerInfo;bm(s.current,2,null,s,null,null),Wf(),c[Si]=null}};function gh(s){this._internalRoot=s}gh.prototype.unstable_scheduleHydration=function(s){if(s){var c=Bn();s={blockedOn:null,target:s,priority:c};for(var p=0;p<Ll.length&&c!==0&&c<Ll[p].priority;p++);Ll.splice(p,0,s),p===0&&ox(s)}};var dx=n.version;if(dx!=="19.1.0")throw Error(r(527,dx,"19.1.0"));q.findDOMNode=function(s){var c=s._reactInternals;if(c===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=u(c),s=s!==null?d(s):null,s=s===null?null:s.stateNode,s};var Dv={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Q,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yh.isDisabled&&yh.supportsFiber)try{J=yh.inject(Dv),de=yh}catch{}}return km.createRoot=function(s,c){if(!a(s))throw Error(r(299));var p=!1,x="",N=Fp,D=Mf,G=Jg,X=null;return c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(N=c.onUncaughtError),c.onCaughtError!==void 0&&(D=c.onCaughtError),c.onRecoverableError!==void 0&&(G=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(X=c.unstable_transitionCallbacks)),c=ix(s,1,!1,null,null,p,x,N,D,G,X,null),s[Si]=c.current,fm(s),new Cm(c)},km.hydrateRoot=function(s,c,p){if(!a(s))throw Error(r(299));var x=!1,N="",D=Fp,G=Mf,X=Jg,ye=null,Pe=null;return p!=null&&(p.unstable_strictMode===!0&&(x=!0),p.identifierPrefix!==void 0&&(N=p.identifierPrefix),p.onUncaughtError!==void 0&&(D=p.onUncaughtError),p.onCaughtError!==void 0&&(G=p.onCaughtError),p.onRecoverableError!==void 0&&(X=p.onRecoverableError),p.unstable_transitionCallbacks!==void 0&&(ye=p.unstable_transitionCallbacks),p.formState!==void 0&&(Pe=p.formState)),c=ix(s,1,!0,c,p??null,x,N,D,G,X,ye,Pe),c.context=rx(null),p=c.current,x=rr(),x=Ti(x),N=xl(x),N.callback=null,Ts(p,N,x),p=x,c.current.lanes=p,Ot(c,p),os(c),s[Si]=c.current,fm(s),new gh(c)},km.version="19.1.0",km}var oN;function bA(){if(oN)return Ov.exports;oN=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),Ov.exports=xA(),Ov.exports}var vA=bA(),Em={},cN;function wA(){if(cN)return Em;cN=1,Object.defineProperty(Em,"__esModule",{value:!0}),Em.parse=o,Em.serialize=d;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,n=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,l=(()=>{const b=function(){};return b.prototype=Object.create(null),b})();function o(b,v){const S=new l,k=b.length;if(k<2)return S;const T=(v==null?void 0:v.decode)||h;let E=0;do{const P=b.indexOf("=",E);if(P===-1)break;const I=b.indexOf(";",E),V=I===-1?k:I;if(P>V){E=b.lastIndexOf(";",P-1)+1;continue}const F=f(b,E,P),O=u(b,P,F),B=b.slice(F,O);if(S[B]===void 0){let U=f(b,P+1,V),z=u(b,V,U);const $=T(b.slice(U,z));S[B]=$}E=V+1}while(E<k);return S}function f(b,v,S){do{const k=b.charCodeAt(v);if(k!==32&&k!==9)return v}while(++v<S);return S}function u(b,v,S){for(;v>S;){const k=b.charCodeAt(--v);if(k!==32&&k!==9)return v+1}return S}function d(b,v,S){const k=(S==null?void 0:S.encode)||encodeURIComponent;if(!e.test(b))throw new TypeError(`argument name is invalid: ${b}`);const T=k(v);if(!n.test(T))throw new TypeError(`argument val is invalid: ${v}`);let E=b+"="+T;if(!S)return E;if(S.maxAge!==void 0){if(!Number.isInteger(S.maxAge))throw new TypeError(`option maxAge is invalid: ${S.maxAge}`);E+="; Max-Age="+S.maxAge}if(S.domain){if(!t.test(S.domain))throw new TypeError(`option domain is invalid: ${S.domain}`);E+="; Domain="+S.domain}if(S.path){if(!r.test(S.path))throw new TypeError(`option path is invalid: ${S.path}`);E+="; Path="+S.path}if(S.expires){if(!g(S.expires)||!Number.isFinite(S.expires.valueOf()))throw new TypeError(`option expires is invalid: ${S.expires}`);E+="; Expires="+S.expires.toUTCString()}if(S.httpOnly&&(E+="; HttpOnly"),S.secure&&(E+="; Secure"),S.partitioned&&(E+="; Partitioned"),S.priority)switch(typeof S.priority=="string"?S.priority.toLowerCase():void 0){case"low":E+="; Priority=Low";break;case"medium":E+="; Priority=Medium";break;case"high":E+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${S.priority}`)}if(S.sameSite)switch(typeof S.sameSite=="string"?S.sameSite.toLowerCase():S.sameSite){case!0:case"strict":E+="; SameSite=Strict";break;case"lax":E+="; SameSite=Lax";break;case"none":E+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${S.sameSite}`)}return E}function h(b){if(b.indexOf("%")===-1)return b;try{return decodeURIComponent(b)}catch{return b}}function g(b){return a.call(b)==="[object Date]"}return Em}wA();var uN="popstate";function NA(e={}){function n(r,a){let{pathname:l,search:o,hash:f}=r.location;return U0("",{pathname:l,search:o,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(r,a){return typeof a=="string"?a:Xm(a)}return jA(n,t,null,e)}function bi(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function Gs(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function SA(){return Math.random().toString(36).substring(2,10)}function dN(e,n){return{usr:e.state,key:e.key,idx:n}}function U0(e,n,t=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof n=="string"?Yh(n):n,state:t,key:n&&n.key||r||SA()}}function Xm({pathname:e="/",search:n="",hash:t=""}){return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function Yh(e){let n={};if(e){let t=e.indexOf("#");t>=0&&(n.hash=e.substring(t),e=e.substring(0,t));let r=e.indexOf("?");r>=0&&(n.search=e.substring(r),e=e.substring(0,r)),e&&(n.pathname=e)}return n}function jA(e,n,t,r={}){let{window:a=document.defaultView,v5Compat:l=!1}=r,o=a.history,f="POP",u=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function g(){f="POP";let T=h(),E=T==null?null:T-d;d=T,u&&u({action:f,location:k.location,delta:E})}function b(T,E){f="PUSH";let P=U0(k.location,T,E);d=h()+1;let I=dN(P,d),V=k.createHref(P);try{o.pushState(I,"",V)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;a.location.assign(V)}l&&u&&u({action:f,location:k.location,delta:1})}function v(T,E){f="REPLACE";let P=U0(k.location,T,E);d=h();let I=dN(P,d),V=k.createHref(P);o.replaceState(I,"",V),l&&u&&u({action:f,location:k.location,delta:0})}function S(T){return CA(T)}let k={get action(){return f},get location(){return e(a,o)},listen(T){if(u)throw new Error("A history only accepts one active listener");return a.addEventListener(uN,g),u=T,()=>{a.removeEventListener(uN,g),u=null}},createHref(T){return n(a,T)},createURL:S,encodeLocation(T){let E=S(T);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:b,replace:v,go(T){return o.go(T)}};return k}function CA(e,n=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),bi(t,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:Xm(e);return r=r.replace(/ $/,"%20"),!n&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function c_(e,n,t="/"){return _A(e,n,t,!1)}function _A(e,n,t,r){let a=typeof n=="string"?Yh(n):n,l=Bo(a.pathname||"/",t);if(l==null)return null;let o=u_(e);kA(o);let f=null;for(let u=0;f==null&&u<o.length;++u){let d=FA(l);f=LA(o[u],d,r)}return f}function u_(e,n=[],t=[],r=""){let a=(l,o,f)=>{let u={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};u.relativePath.startsWith("/")&&(bi(u.relativePath.startsWith(r),`Absolute route path "${u.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(r.length));let d=$o([r,u.relativePath]),h=t.concat(u);l.children&&l.children.length>0&&(bi(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),u_(l.children,n,h,d)),!(l.path==null&&!l.index)&&n.push({path:d,score:MA(d,l.index),routesMeta:h})};return e.forEach((l,o)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))a(l,o);else for(let u of d_(l.path))a(l,o,u)}),n}function d_(e){let n=e.split("/");if(n.length===0)return[];let[t,...r]=n,a=t.endsWith("?"),l=t.replace(/\?$/,"");if(r.length===0)return a?[l,""]:[l];let o=d_(r.join("/")),f=[];return f.push(...o.map(u=>u===""?l:[l,u].join("/"))),a&&f.push(...o),f.map(u=>e.startsWith("/")&&u===""?"/":u)}function kA(e){e.sort((n,t)=>n.score!==t.score?t.score-n.score:RA(n.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var EA=/^:[\w-]+$/,TA=3,AA=2,DA=1,PA=10,IA=-2,fN=e=>e==="*";function MA(e,n){let t=e.split("/"),r=t.length;return t.some(fN)&&(r+=IA),n&&(r+=AA),t.filter(a=>!fN(a)).reduce((a,l)=>a+(EA.test(l)?TA:l===""?DA:PA),r)}function RA(e,n){return e.length===n.length&&e.slice(0,-1).every((r,a)=>r===n[a])?e[e.length-1]-n[n.length-1]:0}function LA(e,n,t=!1){let{routesMeta:r}=e,a={},l="/",o=[];for(let f=0;f<r.length;++f){let u=r[f],d=f===r.length-1,h=l==="/"?n:n.slice(l.length)||"/",g=Wx({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),b=u.route;if(!g&&d&&t&&!r[r.length-1].route.index&&(g=Wx({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!g)return null;Object.assign(a,g.params),o.push({params:a,pathname:$o([l,g.pathname]),pathnameBase:UA($o([l,g.pathnameBase])),route:b}),g.pathnameBase!=="/"&&(l=$o([l,g.pathnameBase]))}return o}function Wx(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,r]=OA(e.path,e.caseSensitive,e.end),a=n.match(t);if(!a)return null;let l=a[0],o=l.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:g},b)=>{if(h==="*"){let S=f[b]||"";o=l.slice(0,l.length-S.length).replace(/(.)\/+$/,"$1")}const v=f[b];return g&&!v?d[h]=void 0:d[h]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:l,pathnameBase:o,pattern:e}}function OA(e,n=!1,t=!0){Gs(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,f,u)=>(r.push({paramName:f,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,n?void 0:"i"),r]}function FA(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return Gs(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),e}}function Bo(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let t=n.endsWith("/")?n.length-1:n.length,r=e.charAt(t);return r&&r!=="/"?null:e.slice(t)||"/"}function $A(e,n="/"){let{pathname:t,search:r="",hash:a=""}=typeof e=="string"?Yh(e):e;return{pathname:t?t.startsWith("/")?t:zA(t,n):n,search:qA(r),hash:VA(a)}}function zA(e,n){let t=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function Bv(e,n,t,r){return`Cannot include a '${e}' character in a manually specified \`to.${n}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function BA(e){return e.filter((n,t)=>t===0||n.route.path&&n.route.path.length>0)}function G1(e){let n=BA(e);return n.map((t,r)=>r===n.length-1?t.pathname:t.pathnameBase)}function Y1(e,n,t,r=!1){let a;typeof e=="string"?a=Yh(e):(a={...e},bi(!a.pathname||!a.pathname.includes("?"),Bv("?","pathname","search",a)),bi(!a.pathname||!a.pathname.includes("#"),Bv("#","pathname","hash",a)),bi(!a.search||!a.search.includes("#"),Bv("#","search","hash",a)));let l=e===""||a.pathname==="",o=l?"/":a.pathname,f;if(o==null)f=t;else{let g=n.length-1;if(!r&&o.startsWith("..")){let b=o.split("/");for(;b[0]==="..";)b.shift(),g-=1;a.pathname=b.join("/")}f=g>=0?n[g]:"/"}let u=$A(a,f),d=o&&o!=="/"&&o.endsWith("/"),h=(l||o===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}var $o=e=>e.join("/").replace(/\/\/+/g,"/"),UA=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),qA=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,VA=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function HA(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var f_=["POST","PUT","PATCH","DELETE"];new Set(f_);var GA=["GET",...f_];new Set(GA);var Wh=w.createContext(null);Wh.displayName="DataRouter";var Sb=w.createContext(null);Sb.displayName="DataRouterState";var h_=w.createContext({isTransitioning:!1});h_.displayName="ViewTransition";var YA=w.createContext(new Map);YA.displayName="Fetchers";var WA=w.createContext(null);WA.displayName="Await";var Qs=w.createContext(null);Qs.displayName="Navigation";var og=w.createContext(null);og.displayName="Location";var Js=w.createContext({outlet:null,matches:[],isDataRoute:!1});Js.displayName="Route";var W1=w.createContext(null);W1.displayName="RouteError";function QA(e,{relative:n}={}){bi(Qh(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=w.useContext(Qs),{hash:a,pathname:l,search:o}=cg(e,{relative:n}),f=l;return t!=="/"&&(f=l==="/"?t:$o([t,l])),r.createHref({pathname:f,search:o,hash:a})}function Qh(){return w.useContext(og)!=null}function gr(){return bi(Qh(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(og).location}var p_="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function m_(e){w.useContext(Qs).static||w.useLayoutEffect(e)}function wt(){let{isDataRoute:e}=w.useContext(Js);return e?oD():JA()}function JA(){bi(Qh(),"useNavigate() may be used only in the context of a <Router> component.");let e=w.useContext(Wh),{basename:n,navigator:t}=w.useContext(Qs),{matches:r}=w.useContext(Js),{pathname:a}=gr(),l=JSON.stringify(G1(r)),o=w.useRef(!1);return m_(()=>{o.current=!0}),w.useCallback((u,d={})=>{if(Gs(o.current,p_),!o.current)return;if(typeof u=="number"){t.go(u);return}let h=Y1(u,JSON.parse(l),a,d.relative==="path");e==null&&n!=="/"&&(h.pathname=h.pathname==="/"?n:$o([n,h.pathname])),(d.replace?t.replace:t.push)(h,d.state,d)},[n,t,l,a,e])}w.createContext(null);function Rr(){let{matches:e}=w.useContext(Js),n=e[e.length-1];return n?n.params:{}}function cg(e,{relative:n}={}){let{matches:t}=w.useContext(Js),{pathname:r}=gr(),a=JSON.stringify(G1(t));return w.useMemo(()=>Y1(e,JSON.parse(a),r,n==="path"),[e,a,r,n])}function KA(e,n){return g_(e,n)}function g_(e,n,t,r){var P;bi(Qh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:l}=w.useContext(Qs),{matches:o}=w.useContext(Js),f=o[o.length-1],u=f?f.params:{},d=f?f.pathname:"/",h=f?f.pathnameBase:"/",g=f&&f.route;{let I=g&&g.path||"";y_(d,!g||I.endsWith("*")||I.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${I}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${I}"> to <Route path="${I==="/"?"*":`${I}/*`}">.`)}let b=gr(),v;if(n){let I=typeof n=="string"?Yh(n):n;bi(h==="/"||((P=I.pathname)==null?void 0:P.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${I.pathname}" was given in the \`location\` prop.`),v=I}else v=b;let S=v.pathname||"/",k=S;if(h!=="/"){let I=h.replace(/^\//,"").split("/");k="/"+S.replace(/^\//,"").split("/").slice(I.length).join("/")}let T=!l&&t&&t.matches&&t.matches.length>0?t.matches:c_(e,{pathname:k});Gs(g||T!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Gs(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=nD(T&&T.map(I=>Object.assign({},I,{params:Object.assign({},u,I.params),pathname:$o([h,a.encodeLocation?a.encodeLocation(I.pathname).pathname:I.pathname]),pathnameBase:I.pathnameBase==="/"?h:$o([h,a.encodeLocation?a.encodeLocation(I.pathnameBase).pathname:I.pathnameBase])})),o,t,r);return n&&E?w.createElement(og.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},E):E}function XA(){let e=lD(),n=HA(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},l={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:l},"ErrorBoundary")," or"," ",w.createElement("code",{style:l},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},n),t?w.createElement("pre",{style:a},t):null,o)}var ZA=w.createElement(XA,null),eD=class extends w.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?w.createElement(Js.Provider,{value:this.props.routeContext},w.createElement(W1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function tD({routeContext:e,match:n,children:t}){let r=w.useContext(Wh);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),w.createElement(Js.Provider,{value:e},t)}function nD(e,n=[],t=null,r=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(n.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let a=e,l=t==null?void 0:t.errors;if(l!=null){let u=a.findIndex(d=>d.route.id&&(l==null?void 0:l[d.route.id])!==void 0);bi(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),a=a.slice(0,Math.min(a.length,u+1))}let o=!1,f=-1;if(t)for(let u=0;u<a.length;u++){let d=a[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(f=u),d.route.id){let{loaderData:h,errors:g}=t,b=d.route.loader&&!h.hasOwnProperty(d.route.id)&&(!g||g[d.route.id]===void 0);if(d.route.lazy||b){o=!0,f>=0?a=a.slice(0,f+1):a=[a[0]];break}}}return a.reduceRight((u,d,h)=>{let g,b=!1,v=null,S=null;t&&(g=l&&d.route.id?l[d.route.id]:void 0,v=d.route.errorElement||ZA,o&&(f<0&&h===0?(y_("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,S=null):f===h&&(b=!0,S=d.route.hydrateFallbackElement||null)));let k=n.concat(a.slice(0,h+1)),T=()=>{let E;return g?E=v:b?E=S:d.route.Component?E=w.createElement(d.route.Component,null):d.route.element?E=d.route.element:E=u,w.createElement(tD,{match:d,routeContext:{outlet:u,matches:k,isDataRoute:t!=null},children:E})};return t&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?w.createElement(eD,{location:t.location,revalidation:t.revalidation,component:v,error:g,children:T(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):T()},null)}function Q1(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function iD(e){let n=w.useContext(Wh);return bi(n,Q1(e)),n}function rD(e){let n=w.useContext(Sb);return bi(n,Q1(e)),n}function aD(e){let n=w.useContext(Js);return bi(n,Q1(e)),n}function J1(e){let n=aD(e),t=n.matches[n.matches.length-1];return bi(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function sD(){return J1("useRouteId")}function lD(){var r;let e=w.useContext(W1),n=rD("useRouteError"),t=J1("useRouteError");return e!==void 0?e:(r=n.errors)==null?void 0:r[t]}function oD(){let{router:e}=iD("useNavigate"),n=J1("useNavigate"),t=w.useRef(!1);return m_(()=>{t.current=!0}),w.useCallback(async(a,l={})=>{Gs(t.current,p_),t.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:n,...l}))},[e,n])}var hN={};function y_(e,n,t){!n&&!hN[e]&&(hN[e]=!0,Gs(!1,t))}w.memo(cD);function cD({routes:e,future:n,state:t}){return g_(e,void 0,t,n)}function Sn({to:e,replace:n,state:t,relative:r}){bi(Qh(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=w.useContext(Qs);Gs(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=w.useContext(Js),{pathname:o}=gr(),f=wt(),u=Y1(e,G1(l),o,r==="path"),d=JSON.stringify(u);return w.useEffect(()=>{f(JSON.parse(d),{replace:n,state:t,relative:r})},[f,d,r,n,t]),null}function ut(e){bi(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function uD({basename:e="/",children:n=null,location:t,navigationType:r="POP",navigator:a,static:l=!1}){bi(!Qh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),f=w.useMemo(()=>({basename:o,navigator:a,static:l,future:{}}),[o,a,l]);typeof t=="string"&&(t=Yh(t));let{pathname:u="/",search:d="",hash:h="",state:g=null,key:b="default"}=t,v=w.useMemo(()=>{let S=Bo(u,o);return S==null?null:{location:{pathname:S,search:d,hash:h,state:g,key:b},navigationType:r}},[o,u,d,h,g,b,r]);return Gs(v!=null,`<Router basename="${o}"> is not able to match the URL "${u}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:w.createElement(Qs.Provider,{value:f},w.createElement(og.Provider,{children:n,value:v}))}function _h({children:e,location:n}){return KA(q0(e),n)}function q0(e,n=[]){let t=[];return w.Children.forEach(e,(r,a)=>{if(!w.isValidElement(r))return;let l=[...n,a];if(r.type===w.Fragment){t.push.apply(t,q0(r.props.children,l));return}bi(r.type===ut,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),bi(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=q0(r.props.children,l)),t.push(o)}),t}var Fx="get",$x="application/x-www-form-urlencoded";function jb(e){return e!=null&&typeof e.tagName=="string"}function dD(e){return jb(e)&&e.tagName.toLowerCase()==="button"}function fD(e){return jb(e)&&e.tagName.toLowerCase()==="form"}function hD(e){return jb(e)&&e.tagName.toLowerCase()==="input"}function pD(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function mD(e,n){return e.button===0&&(!n||n==="_self")&&!pD(e)}var fx=null;function gD(){if(fx===null)try{new FormData(document.createElement("form"),0),fx=!1}catch{fx=!0}return fx}var yD=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Uv(e){return e!=null&&!yD.has(e)?(Gs(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${$x}"`),null):e}function xD(e,n){let t,r,a,l,o;if(fD(e)){let f=e.getAttribute("action");r=f?Bo(f,n):null,t=e.getAttribute("method")||Fx,a=Uv(e.getAttribute("enctype"))||$x,l=new FormData(e)}else if(dD(e)||hD(e)&&(e.type==="submit"||e.type==="image")){let f=e.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=e.getAttribute("formaction")||f.getAttribute("action");if(r=u?Bo(u,n):null,t=e.getAttribute("formmethod")||f.getAttribute("method")||Fx,a=Uv(e.getAttribute("formenctype"))||Uv(f.getAttribute("enctype"))||$x,l=new FormData(f,e),!gD()){let{name:d,type:h,value:g}=e;if(h==="image"){let b=d?`${d}.`:"";l.append(`${b}x`,"0"),l.append(`${b}y`,"0")}else d&&l.append(d,g)}}else{if(jb(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Fx,r=null,a=$x,o=e}return l&&a==="text/plain"&&(o=l,l=void 0),{action:r,method:t.toLowerCase(),encType:a,formData:l,body:o}}function K1(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}async function bD(e,n){if(e.id in n)return n[e.id];try{let t=await import(e.module);return n[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function vD(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function wD(e,n,t){let r=await Promise.all(e.map(async a=>{let l=n.routes[a.route.id];if(l){let o=await bD(l,t);return o.links?o.links():[]}return[]}));return CD(r.flat(1).filter(vD).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function pN(e,n,t,r,a,l){let o=(u,d)=>t[d]?u.route.id!==t[d].route.id:!0,f=(u,d)=>{var h;return t[d].pathname!==u.pathname||((h=t[d].route.path)==null?void 0:h.endsWith("*"))&&t[d].params["*"]!==u.params["*"]};return l==="assets"?n.filter((u,d)=>o(u,d)||f(u,d)):l==="data"?n.filter((u,d)=>{var g;let h=r.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,d)||f(u,d))return!0;if(u.route.shouldRevalidate){let b=u.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((g=t[0])==null?void 0:g.params)||{},nextUrl:new URL(e,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function ND(e,n,{includeHydrateFallback:t}={}){return SD(e.map(r=>{let a=n.routes[r.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function SD(e){return[...new Set(e)]}function jD(e){let n={},t=Object.keys(e).sort();for(let r of t)n[r]=e[r];return n}function CD(e,n){let t=new Set;return new Set(n),e.reduce((r,a)=>{let l=JSON.stringify(jD(a));return t.has(l)||(t.add(l),r.push({key:l,link:a})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var _D=new Set([100,101,204,205]);function kD(e,n){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":n&&Bo(t.pathname,n)==="/"?t.pathname=`${n.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function x_(){let e=w.useContext(Wh);return K1(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function ED(){let e=w.useContext(Sb);return K1(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var X1=w.createContext(void 0);X1.displayName="FrameworkContext";function b_(){let e=w.useContext(X1);return K1(e,"You must render this element inside a <HydratedRouter> element"),e}function TD(e,n){let t=w.useContext(X1),[r,a]=w.useState(!1),[l,o]=w.useState(!1),{onFocus:f,onBlur:u,onMouseEnter:d,onMouseLeave:h,onTouchStart:g}=n,b=w.useRef(null);w.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let k=E=>{E.forEach(P=>{o(P.isIntersecting)})},T=new IntersectionObserver(k,{threshold:.5});return b.current&&T.observe(b.current),()=>{T.disconnect()}}},[e]),w.useEffect(()=>{if(r){let k=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(k)}}},[r]);let v=()=>{a(!0)},S=()=>{a(!1),o(!1)};return t?e!=="intent"?[l,b,{}]:[l,b,{onFocus:Tm(f,v),onBlur:Tm(u,S),onMouseEnter:Tm(d,v),onMouseLeave:Tm(h,S),onTouchStart:Tm(g,v)}]:[!1,b,{}]}function Tm(e,n){return t=>{e&&e(t),t.defaultPrevented||n(t)}}function AD({page:e,...n}){let{router:t}=x_(),r=w.useMemo(()=>c_(t.routes,e,t.basename),[t.routes,e,t.basename]);return r?w.createElement(PD,{page:e,matches:r,...n}):null}function DD(e){let{manifest:n,routeModules:t}=b_(),[r,a]=w.useState([]);return w.useEffect(()=>{let l=!1;return wD(e,n,t).then(o=>{l||a(o)}),()=>{l=!0}},[e,n,t]),r}function PD({page:e,matches:n,...t}){let r=gr(),{manifest:a,routeModules:l}=b_(),{basename:o}=x_(),{loaderData:f,matches:u}=ED(),d=w.useMemo(()=>pN(e,n,u,a,r,"data"),[e,n,u,a,r]),h=w.useMemo(()=>pN(e,n,u,a,r,"assets"),[e,n,u,a,r]),g=w.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let S=new Set,k=!1;if(n.forEach(E=>{var I;let P=a.routes[E.route.id];!P||!P.hasLoader||(!d.some(V=>V.route.id===E.route.id)&&E.route.id in f&&((I=l[E.route.id])!=null&&I.shouldRevalidate)||P.hasClientLoader?k=!0:S.add(E.route.id))}),S.size===0)return[];let T=kD(e,o);return k&&S.size>0&&T.searchParams.set("_routes",n.filter(E=>S.has(E.route.id)).map(E=>E.route.id).join(",")),[T.pathname+T.search]},[o,f,r,a,d,n,e,l]),b=w.useMemo(()=>ND(h,a),[h,a]),v=DD(h);return w.createElement(w.Fragment,null,g.map(S=>w.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...t})),b.map(S=>w.createElement("link",{key:S,rel:"modulepreload",href:S,...t})),v.map(({key:S,link:k})=>w.createElement("link",{key:S,...k})))}function ID(...e){return n=>{e.forEach(t=>{typeof t=="function"?t(n):t!=null&&(t.current=n)})}}var v_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{v_&&(window.__reactRouterVersion="7.6.0")}catch{}function MD({basename:e,children:n,window:t}){let r=w.useRef();r.current==null&&(r.current=NA({window:t,v5Compat:!0}));let a=r.current,[l,o]=w.useState({action:a.action,location:a.location}),f=w.useCallback(u=>{w.startTransition(()=>o(u))},[o]);return w.useLayoutEffect(()=>a.listen(f),[a,f]),w.createElement(uD,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:a})}var w_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,hs=w.forwardRef(function({onClick:n,discover:t="render",prefetch:r="none",relative:a,reloadDocument:l,replace:o,state:f,target:u,to:d,preventScrollReset:h,viewTransition:g,...b},v){let{basename:S}=w.useContext(Qs),k=typeof d=="string"&&w_.test(d),T,E=!1;if(typeof d=="string"&&k&&(T=d,v_))try{let z=new URL(window.location.href),$=d.startsWith("//")?new URL(z.protocol+d):new URL(d),R=Bo($.pathname,S);$.origin===z.origin&&R!=null?d=R+$.search+$.hash:E=!0}catch{Gs(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let P=QA(d,{relative:a}),[I,V,F]=TD(r,b),O=FD(d,{replace:o,state:f,target:u,preventScrollReset:h,relative:a,viewTransition:g});function B(z){n&&n(z),z.defaultPrevented||O(z)}let U=w.createElement("a",{...b,...F,href:T||P,onClick:E||l?n:B,ref:ID(v,V),target:u,"data-discover":!k&&t==="render"?"true":void 0});return I&&!k?w.createElement(w.Fragment,null,U,w.createElement(AD,{page:P})):U});hs.displayName="Link";var RD=w.forwardRef(function({"aria-current":n="page",caseSensitive:t=!1,className:r="",end:a=!1,style:l,to:o,viewTransition:f,children:u,...d},h){let g=cg(o,{relative:d.relative}),b=gr(),v=w.useContext(Sb),{navigator:S,basename:k}=w.useContext(Qs),T=v!=null&&qD(g)&&f===!0,E=S.encodeLocation?S.encodeLocation(g).pathname:g.pathname,P=b.pathname,I=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(P=P.toLowerCase(),I=I?I.toLowerCase():null,E=E.toLowerCase()),I&&k&&(I=Bo(I,k)||I);const V=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let F=P===E||!a&&P.startsWith(E)&&P.charAt(V)==="/",O=I!=null&&(I===E||!a&&I.startsWith(E)&&I.charAt(E.length)==="/"),B={isActive:F,isPending:O,isTransitioning:T},U=F?n:void 0,z;typeof r=="function"?z=r(B):z=[r,F?"active":null,O?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let $=typeof l=="function"?l(B):l;return w.createElement(hs,{...d,"aria-current":U,className:z,ref:h,style:$,to:o,viewTransition:f},typeof u=="function"?u(B):u)});RD.displayName="NavLink";var LD=w.forwardRef(({discover:e="render",fetcherKey:n,navigate:t,reloadDocument:r,replace:a,state:l,method:o=Fx,action:f,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:g,...b},v)=>{let S=BD(),k=UD(f,{relative:d}),T=o.toLowerCase()==="get"?"get":"post",E=typeof f=="string"&&w_.test(f),P=I=>{if(u&&u(I),I.defaultPrevented)return;I.preventDefault();let V=I.nativeEvent.submitter,F=(V==null?void 0:V.getAttribute("formmethod"))||o;S(V||I.currentTarget,{fetcherKey:n,method:F,navigate:t,replace:a,state:l,relative:d,preventScrollReset:h,viewTransition:g})};return w.createElement("form",{ref:v,method:T,action:k,onSubmit:r?u:P,...b,"data-discover":!E&&e==="render"?"true":void 0})});LD.displayName="Form";function OD(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function N_(e){let n=w.useContext(Wh);return bi(n,OD(e)),n}function FD(e,{target:n,replace:t,state:r,preventScrollReset:a,relative:l,viewTransition:o}={}){let f=wt(),u=gr(),d=cg(e,{relative:l});return w.useCallback(h=>{if(mD(h,n)){h.preventDefault();let g=t!==void 0?t:Xm(u)===Xm(d);f(e,{replace:g,state:r,preventScrollReset:a,relative:l,viewTransition:o})}},[u,f,d,t,r,n,e,a,l,o])}var $D=0,zD=()=>`__${String(++$D)}__`;function BD(){let{router:e}=N_("useSubmit"),{basename:n}=w.useContext(Qs),t=sD();return w.useCallback(async(r,a={})=>{let{action:l,method:o,encType:f,formData:u,body:d}=xD(r,n);if(a.navigate===!1){let h=a.fetcherKey||zD();await e.fetch(h,t,a.action||l,{preventScrollReset:a.preventScrollReset,formData:u,body:d,formMethod:a.method||o,formEncType:a.encType||f,flushSync:a.flushSync})}else await e.navigate(a.action||l,{preventScrollReset:a.preventScrollReset,formData:u,body:d,formMethod:a.method||o,formEncType:a.encType||f,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,n,t])}function UD(e,{relative:n}={}){let{basename:t}=w.useContext(Qs),r=w.useContext(Js);bi(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),l={...cg(e||".",{relative:n})},o=gr();if(e==null){l.search=o.search;let f=new URLSearchParams(l.search),u=f.getAll("index");if(u.some(h=>h==="")){f.delete("index"),u.filter(g=>g).forEach(g=>f.append("index",g));let h=f.toString();l.search=h?`?${h}`:""}}return(!e||e===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(l.pathname=l.pathname==="/"?t:$o([t,l.pathname])),Xm(l)}function qD(e,n={}){let t=w.useContext(h_);bi(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=N_("useViewTransitionState"),a=cg(e,{relative:n.relative});if(!t.isTransitioning)return!1;let l=Bo(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=Bo(t.nextLocation.pathname,r)||t.nextLocation.pathname;return Wx(a.pathname,o)!=null||Wx(a.pathname,l)!=null}[..._D];var VD=o_();class HD extends w.Component{constructor(){super(...arguments);Vn(this,"state",{hasError:!1})}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){console.error("Uncaught error:",t,r)}render(){return this.state.hasError?i.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"red",border:"1px solid red",borderRadius:"5px"},children:[i.jsx("h1",{children:"Something went wrong."}),i.jsx("p",{children:"We are sorry for the inconvenience. Please try again later."})]}):this.props.children}}class GD{constructor(){Vn(this,"requestCount",0);Vn(this,"listeners",[])}subscribe(n){return this.listeners.push(n),()=>{this.listeners=this.listeners.filter(t=>t!==n)}}notify(){const n=this.requestCount>0;this.listeners.forEach(t=>t(n))}addRequest(){this.requestCount++,this.notify()}removeRequest(){this.requestCount--,this.requestCount<0&&(this.requestCount=0),this.notify()}}const qs=new GD,YD="https://backend.newtons.in",WD=()=>localStorage.getItem("authToken"),fe=async(e,n={})=>{const t=WD(),r={...n.headers};t&&(r.Authorization=`Bearer ${t}`),!(n.body instanceof FormData)&&!r["Content-Type"]&&(r["Content-Type"]="application/json");const a=r;let l=e.startsWith("/")?e:`/${e}`;l.startsWith("/api/")||(l=`/api${l}`);const o=`${YD}${l}`;qs.addRequest();try{console.log(`Making API call to: ${o}`);const f=await fetch(o,{...n,headers:a});if(f.status===401)throw console.error("Unauthorized access - Token might be invalid or expired. Logging out."),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser"),window.location.href="/login",new Error("Unauthorized");if(!f.ok){let u=`HTTP error! status: ${f.status}`;try{const d=await f.json();u=(d==null?void 0:d.message)||(d==null?void 0:d.error)||u}catch{}throw console.error(`API Error: ${f.status} ${f.statusText} - ${u}`),new Error(u)}return f}catch(f){throw f instanceof TypeError&&f.message==="Failed to fetch"?console.error("API Fetch Error: Network error or CORS issue. Check backend CORS configuration.",f):console.error("API Fetch Error:",f),f}finally{qs.removeRequest()}},QD=({onLoginSuccess:e})=>{const[n,t]=w.useState(""),[r,a]=w.useState(""),[l,o]=w.useState(null),[f,u]=w.useState(!1),d=wt(),h=async g=>{g.preventDefault(),u(!0),o(null);try{const b=await fe("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});if(!b.ok){let S=`Login failed with status: ${b.status}`;try{S=(await b.json()).message||S}catch{try{const T=await b.text();T&&(S=`${S} - ${T}`)}catch{}}throw new Error(S)}const v=await b.json();console.log("Login successful:",v),localStorage.setItem("authToken",v.token),localStorage.setItem("currentUser",JSON.stringify(v.user)),v.user.clinic_id&&localStorage.setItem("currentClinicId",v.user.clinic_id),e(v.user),v.user.role==="doctor"?d("/dashboard/queue"):d("/dashboard")}catch(b){console.error("Login failed:",b),o(b.message||"Login failed. Please check your credentials.")}finally{u(!1)}};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Sign in to Newtons OPD Zero"}),i.jsxs("form",{onSubmit:h,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email address"}),i.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:n,onChange:g=>t(g.target.value),className:"auth-text-input",placeholder:"you@example.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"Password"}),i.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:r,onChange:g=>a(g.target.value),className:"auth-text-input",placeholder:"Password"})]}),l&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:l})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:f,className:"auth-submit-button",children:f?"Signing in...":"Sign In"})})]}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Don't have an account?"," ",i.jsx(hs,{to:"/register",className:"auth-navigation-link",children:"Register a new clinic"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})},JD=()=>{const[e,n]=w.useState(""),[t,r]=w.useState(""),[a,l]=w.useState(""),[o,f]=w.useState(""),[u,d]=w.useState(null),[h,g]=w.useState(!1),b=wt(),v=async S=>{S.preventDefault(),g(!0),d(null);try{const k=await fe("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicName:e,userName:t,userEmail:a,userPassword:o})}),T=await k.json();if(!k.ok)throw new Error(T.message||`HTTP error! status: ${k.status}`);console.log("Registration successful:",T),alert("Registration successful! Please log in."),b("/login")}catch(k){console.error("Registration failed:",k),d(k.message||"Registration failed. Please try again.")}finally{g(!1)}};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Register Clinic & Admin"}),i.jsxs("form",{onSubmit:v,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"clinicName",children:"Clinic Name"}),i.jsx("input",{id:"clinicName",name:"clinicName",type:"text",required:!0,value:e,onChange:S=>n(S.target.value),className:"auth-text-input",placeholder:"Your Clinic's Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userName",children:"Your Name (Admin)"}),i.jsx("input",{id:"userName",name:"userName",type:"text",required:!0,value:t,onChange:S=>r(S.target.value),className:"auth-text-input",placeholder:"Your Full Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userEmail",children:"Your Email (Admin Login)"}),i.jsx("input",{id:"userEmail",name:"userEmail",type:"email",autoComplete:"email",required:!0,value:a,onChange:S=>l(S.target.value),className:"auth-text-input",placeholder:"you@example.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userPassword",children:"Password"}),i.jsx("input",{id:"userPassword",name:"userPassword",type:"password",required:!0,minLength:6,value:o,onChange:S=>f(S.target.value),className:"auth-text-input",placeholder:"Min. 6 characters"})]}),u&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:u})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:h,className:"auth-submit-button",children:h?"Registering...":"Register Clinic & Admin"})})]}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Already have an account?"," ",i.jsx(hs,{to:"/login",className:"auth-navigation-link",children:"Sign in"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})};var S_={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},mN=Rn.createContext&&Rn.createContext(S_),KD=["attr","size","title"];function XD(e,n){if(e==null)return{};var t=ZD(e,n),r,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}function ZD(e,n){if(e==null)return{};var t={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(n.indexOf(r)>=0)continue;t[r]=e[r]}return t}function Qx(){return Qx=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Qx.apply(this,arguments)}function gN(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function Jx(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?gN(Object(t),!0).forEach(function(r){eP(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):gN(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function eP(e,n,t){return n=tP(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function tP(e){var n=nP(e,"string");return typeof n=="symbol"?n:n+""}function nP(e,n){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function j_(e){return e&&e.map((n,t)=>Rn.createElement(n.tag,Jx({key:t},n.attr),j_(n.child)))}function ms(e){return n=>Rn.createElement(iP,Qx({attr:Jx({},e.attr)},n),j_(e.child))}function iP(e){var n=t=>{var{attr:r,size:a,title:l}=e,o=XD(e,KD),f=a||t.size||"1em",u;return t.className&&(u=t.className),e.className&&(u=(u?u+" ":"")+e.className),Rn.createElement("svg",Qx({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,o,{className:u,style:Jx(Jx({color:e.color||t.color},t.style),e.style),height:f,width:f,xmlns:"http://www.w3.org/2000/svg"}),l&&Rn.createElement("title",null,l),e.children)};return mN!==void 0?Rn.createElement(mN.Consumer,null,t=>n(t)):n(S_)}function Am(e){return ms({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(e)}function rP(e){return ms({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function yN(e){return ms({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M437.2 403.5L320 215V64h8c13.3 0 24-10.7 24-24V24c0-13.3-10.7-24-24-24H120c-13.3 0-24 10.7-24 24v16c0 13.3 10.7 24 24 24h8v151L10.8 403.5C-18.5 450.6 15.3 512 70.9 512h306.2c55.7 0 89.4-61.5 60.1-108.5zM137.9 320l48.2-77.6c3.7-5.2 5.8-11.6 5.8-18.4V64h64v160c0 6.9 2.2 13.2 5.8 18.4l48.2 77.6h-172z"},child:[]}]})(e)}function kh(e){return ms({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function hx(e){return ms({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M480 320a96 96 0 1 0-96-96 96 96 0 0 0 96 96zm48 32a22.88 22.88 0 0 0-7.06 1.09 124.76 124.76 0 0 1-81.89 0A22.82 22.82 0 0 0 432 352a112 112 0 0 0-112 112.62c.14 26.26 21.73 47.38 48 47.38h224c26.27 0 47.86-21.12 48-47.38A112 112 0 0 0 528 352zm-198.09 10.45A145.19 145.19 0 0 1 352 344.62V128a32 32 0 0 0-32-32h-32V32a32 32 0 0 0-32-32H96a32 32 0 0 0-32 32v64H32a32 32 0 0 0-32 32v368a16 16 0 0 0 16 16h288.31A78.62 78.62 0 0 1 288 464.79a143.06 143.06 0 0 1 41.91-102.34zM144 404a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm48-122a6 6 0 0 1-6 6h-20a6 6 0 0 1-6-6v-26h-26a6 6 0 0 1-6-6v-20a6 6 0 0 1 6-6h26V70a6 6 0 0 1 6-6h20a6 6 0 0 1 6 6v26h26a6 6 0 0 1 6 6v20a6 6 0 0 1-6 6h-26zm80 250a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12z"},child:[]}]})(e)}function px(e){return ms({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M352 288h-16v-88c0-4.42-3.58-8-8-8h-13.58c-4.74 0-9.37 1.4-13.31 4.03l-15.33 10.22a7.994 7.994 0 0 0-2.22 11.09l8.88 13.31a7.994 7.994 0 0 0 11.09 2.22l.47-.31V288h-16c-4.42 0-8 3.58-8 8v16c0 4.42 3.58 8 8 8h64c4.42 0 8-3.58 8-8v-16c0-4.42-3.58-8-8-8zM608 64H32C14.33 64 0 78.33 0 96v320c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V96c0-17.67-14.33-32-32-32zM48 400v-64c35.35 0 64 28.65 64 64H48zm0-224v-64h64c0 35.35-28.65 64-64 64zm272 192c-53.02 0-96-50.15-96-112 0-61.86 42.98-112 96-112s96 50.14 96 112c0 61.87-43 112-96 112zm272 32h-64c0-35.35 28.65-64 64-64v64zm0-224c-35.35 0-64-28.65-64-64h64v64z"},child:[]}]})(e)}function mx(e){return ms({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M112 32C50.1 32 0 82.1 0 144v224c0 61.9 50.1 112 112 112s112-50.1 112-112V144c0-61.9-50.1-112-112-112zm48 224H64V144c0-26.5 21.5-48 48-48s48 21.5 48 48v112zm139.7-29.7c-3.5-3.5-9.4-3.1-12.3.8-45.3 62.5-40.4 150.1 15.9 206.4 56.3 56.3 143.9 61.2 206.4 15.9 4-2.9 4.3-8.8.8-12.3L299.7 226.3zm229.8-19c-56.3-56.3-143.9-61.2-206.4-15.9-4 2.9-4.3 8.8-.8 12.3l210.8 210.8c3.5 3.5 9.4 3.1 12.3-.8 45.3-62.6 40.5-150.1-15.9-206.4z"},child:[]}]})(e)}function Eh(e){return ms({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function C_(e){return ms({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(e)}function xN(e){return ms({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M447.1 112c-34.2.5-62.3 28.4-63 62.6-.5 24.3 12.5 45.6 32 56.8V344c0 57.3-50.2 104-112 104-60 0-109.2-44.1-111.9-99.2C265 333.8 320 269.2 320 192V36.6c0-11.4-8.1-21.3-19.3-23.5L237.8.5c-13-2.6-25.6 5.8-28.2 18.8L206.4 35c-2.6 13 5.8 25.6 18.8 28.2l30.7 6.1v121.4c0 52.9-42.2 96.7-95.1 97.2-53.4.5-96.9-42.7-96.9-96V69.4l30.7-6.1c13-2.6 21.4-15.2 18.8-28.2l-3.1-15.7C107.7 6.4 95.1-2 82.1.6L19.3 13C8.1 15.3 0 25.1 0 36.6V192c0 77.3 55.1 142 128.1 156.8C130.7 439.2 208.6 512 304 512c97 0 176-75.4 176-168V231.4c19.1-11.1 32-31.7 32-55.4 0-35.7-29.2-64.5-64.9-64zm.9 80c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16z"},child:[]}]})(e)}function qv(e){return ms({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zM104 424c0 13.3 10.7 24 24 24s24-10.7 24-24-10.7-24-24-24-24 10.7-24 24zm216-135.4v49c36.5 7.4 64 39.8 64 78.4v41.7c0 7.6-5.4 14.2-12.9 15.7l-32.2 6.4c-4.3.9-8.5-1.9-9.4-6.3l-3.1-15.7c-.9-4.3 1.9-8.6 6.3-9.4l19.3-3.9V416c0-62.8-96-65.1-96 1.9v26.7l19.3 3.9c4.3.9 7.1 5.1 6.3 9.4l-3.1 15.7c-.9 4.3-5.1 7.1-9.4 6.3l-31.2-4.2c-7.9-1.1-13.8-7.8-13.8-15.9V416c0-38.6 27.5-70.9 64-78.4v-45.2c-2.2.7-4.4 1.1-6.6 1.9-18 6.3-37.3 9.8-57.4 9.8s-39.4-3.5-57.4-9.8c-7.4-2.6-14.9-4.2-22.6-5.2v81.6c23.1 6.9 40 28.1 40 53.4 0 30.9-25.1 56-56 56s-56-25.1-56-56c0-25.3 16.9-46.5 40-53.4v-80.4C48.5 301 0 355.8 0 422.4v44.8C0 491.9 20.1 512 44.8 512h358.4c24.7 0 44.8-20.1 44.8-44.8v-44.8c0-72-56.8-130.3-128-133.8z"},child:[]}]})(e)}function xh(e){return ms({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(e)}const Z1={superadmin:[{title:"Admin Pages",links:[{path:"/dashboard",name:"Super Admin Dashboard",icon:kh},{path:"/dashboard/clinic-subscriptions",name:"Clinic Subscriptions",icon:hx},{path:"/dashboard/users",name:"User Management",icon:xh}]}],admin:[{title:"Dashboard",links:[{path:"/dashboard",name:"Admin Dashboard",icon:kh}]},{title:"Staff Management",links:[{path:"/dashboard/staff",name:"Manage Staff",icon:xh},{path:"/dashboard/staff/add",name:"Add Staff",icon:qv}]},{title:"Patient Management",links:[{path:"/dashboard/patients/add",name:"Add Patient",icon:hx},{path:"/dashboard/patients",name:"All Patients",icon:xh},{path:"/dashboard/patients/search",name:"Search Patient",icon:Eh}]},{title:"Inventory & Pharmacy",links:[{path:"/dashboard/analysis",name:"Inventory Analysis",icon:Am},{path:"/dashboard/inventory",name:"Pharmacy Inventory",icon:mx},{path:"/dashboard/purchase",name:"Add Drug",icon:mx},{path:"/dashboard/recurring-medications",name:"Recurring Medications",icon:Am},{path:"/dashboard/distributors",name:"Distributor Management",icon:xh}]},{title:"Queue & Subscriptions",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:xN},{path:"/dashboard/subscriptions",name:"Manage Subscriptions",icon:px},{path:"/dashboard/subscriptions/add",name:"Add Subscription Plan",icon:px}]}],doctor:[{title:"Patient & Admissions",links:[{path:"/dashboard/search",name:"Patient Search",icon:Eh},{path:"/dashboard/add-patient",name:"Add Patient",icon:hx},{path:"/manage-admission",name:"Manage Admission",icon:qv}]},{title:"Lab & Billing",links:[{path:"/create-lab-order",name:"Create Lab Order",icon:yN},{path:"/billing",name:"Billing",icon:px}]},{title:"Queue",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:xN}]}],receptionist:[{title:"Reception",links:[{path:"/dashboard",name:"Reception Dashboard",icon:kh}]},{title:"Patient Management",links:[{path:"/dashboard/all-patients",name:"All Patients",icon:xh},{path:"/dashboard/patients/add",name:"Add Patient",icon:hx},{path:"/dashboard/patients/search",name:"Search Patient",icon:Eh}]},{title:"Billing & Admissions",links:[{path:"/billing",name:"Billing",icon:px},{path:"/manage-admission",name:"Manage Admission",icon:qv}]}],lab:[{title:"Lab Operations",links:[{path:"/dashboard",name:"Lab Dashboard",icon:kh},{path:"/lab-inventory",name:"Lab Test Inventory",icon:yN},{path:"/lab/search-report",name:"Search Lab Report",icon:Eh}]}],pharmacy:[{title:"Pharmacy Operations",links:[{path:"/dashboard",name:"Pharmacy Queue",icon:kh},{path:"/dashboard/inventory",name:"Pharmacy Inventory",icon:mx},{path:"/dashboard/purchase",name:"Add Drug",icon:mx},{path:"/dashboard/add-order",name:"Add Pharmacy Order",icon:Am},{path:"/dashboard/recurring-medications",name:"Recurring Medications",icon:Am},{path:"/dashboard/distributors",name:"Distributor Management",icon:xh}]},{title:"Analysis & Settings",links:[{path:"/dashboard/analysis",name:"Inventory Analysis",icon:Am},{path:"/dashboard/settings",name:"Pharmacy Settings",icon:rP},{path:"/dashboard/search-patient-records",name:"Search Patient Records",icon:Eh}]}]},aP=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a})=>{const l=gr(),[o,f]=w.useState(""),u=Z1[t]||[],[d,h]=w.useState(500),g=w.useRef(!1),b=w.useCallback(T=>{g.current=!0,T.preventDefault()},[]),v=w.useCallback(()=>{g.current=!1},[]),S=w.useCallback(T=>{if(g.current){const E=window.innerWidth-T.clientX;E>250&&E<window.innerWidth*.8&&h(E)}},[]);w.useEffect(()=>(window.addEventListener("mousemove",S),window.addEventListener("mouseup",v),()=>{window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",v)}),[S,v]);const k=u.map(T=>({...T,links:T.links.filter(E=>E.name.toLowerCase().includes(o.toLowerCase()))})).filter(T=>T.links.length>0);return i.jsxs("div",{className:`side-panel ${r?"open":""}`,style:{width:`${d}px`,right:r?"0":`-${d}px`},children:[i.jsx("div",{className:"resizer",onMouseDown:b}),i.jsxs("div",{className:"side-panel-header",children:[i.jsx(hs,{to:"/dashboard",className:"home-button",onClick:a,children:i.jsx(kh,{})}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx(Eh,{style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",color:"#94a3b8"}}),i.jsx("input",{type:"text",placeholder:"Search pages...",className:"search-bar",value:o,onChange:T=>f(T.target.value)})]}),i.jsx("button",{className:"close-button",onClick:a,children:""})]}),i.jsx("nav",{children:k.map((T,E)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:T.title}),i.jsx("ul",{className:"sub-page-list",children:T.links.map(P=>{const I=P.icon;return i.jsx("li",{children:i.jsxs(hs,{to:P.path,className:l.pathname===P.path?"active":"",onClick:a,children:[I&&i.jsx(I,{})," ",P.name]})},P.path)})})]},E))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx(C_,{})," Logout"]})]})]})},sP=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a,roleNavigation:l})=>{const o=gr(),f=l[t]||[];return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:`mobile-side-panel-overlay ${r?"open":""}`,onClick:a}),i.jsxs("div",{className:`mobile-side-panel ${r?"open":""}`,children:[i.jsxs("div",{className:"mobile-side-panel-header",children:[i.jsx("h3",{children:"Menu"}),i.jsx("button",{className:"close-button",onClick:a,children:""})]}),i.jsx("nav",{children:f.map((u,d)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:u.title}),i.jsx("ul",{className:"sub-page-list",children:u.links.map(h=>{const g=h.icon;return i.jsx("li",{children:i.jsxs(hs,{to:h.path,className:o.pathname===h.path?"active":"",onClick:a,children:[g&&i.jsx(g,{})," ",h.name]})},h.path)})})]},d))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx(C_,{})," Logout"]})]})]})]})};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lP=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),oP=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,t,r)=>r?r.toUpperCase():t.toLowerCase()),bN=e=>{const n=oP(e);return n.charAt(0).toUpperCase()+n.slice(1)},__=(...e)=>e.filter((n,t,r)=>!!n&&n.trim()!==""&&r.indexOf(n)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var cP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uP=w.forwardRef(({color:e="currentColor",size:n=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:a="",children:l,iconNode:o,...f},u)=>w.createElement("svg",{ref:u,...cP,width:n,height:n,stroke:e,strokeWidth:r?Number(t)*24/Number(n):t,className:__("lucide",a),...f},[...o.map(([d,h])=>w.createElement(d,h)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=(e,n)=>{const t=w.forwardRef(({className:r,...a},l)=>w.createElement(uP,{ref:l,iconNode:n,className:__(`lucide-${lP(bN(e))}`,`lucide-${e}`,r),...a}));return t.displayName=bN(e),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dP=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],Wc=ct("arrow-down",dP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fP=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Ht=ct("arrow-left",fP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hP=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],pP=ct("arrow-right",hP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mP=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],Lo=ct("arrow-up",mP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gP=[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]],ew=ct("beaker",gP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yP=[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]],xP=ct("bed-double",yP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bP=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],vP=ct("bell",bP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wP=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}]],NP=ct("bell-ring",wP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SP=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],V0=ct("brain",SP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jP=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],CP=ct("building",jP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _P=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]],kP=ct("calendar-check-2",_P);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EP=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],TP=ct("calendar-days",EP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AP=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Fh=ct("calendar",AP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DP=[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]],PP=ct("chart-no-axes-column",DP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IP=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Zm=ct("check",IP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MP=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Kx=ct("chevron-down",MP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RP=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Cb=ct("chevron-left",RP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LP=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ug=ct("chevron-right",LP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OP=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],H0=ct("chevron-up",OP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],si=ct("circle-alert",FP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $P=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ua=ct("circle-check-big",$P);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]],BP=ct("circle-minus",zP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],Fo=ct("circle-plus",UP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],VP=ct("circle-user",qP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HP=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],vN=ct("clipboard-list",HP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GP=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],k_=ct("clipboard",GP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],WP=ct("clock",YP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QP=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],JP=ct("copy",QP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KP=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],E_=ct("credit-card",KP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XP=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],zd=ct("dollar-sign",XP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZP=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],T_=ct("eye",ZP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eI=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],wN=ct("file-check",eI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tI=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ps=ct("file-text",tI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],Xx=ct("flask-conical",nI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iI=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],A_=ct("funnel",iI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rI=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Fd=ct("hash",rI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],D_=ct("house",aI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],ql=ct("info",sI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lI=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],oI=ct("key",lI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cI=[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]],uI=ct("list-ordered",cI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dI=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],fI=ct("list",dI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hI=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Bd=ct("loader-circle",hI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pI=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],NN=ct("lock",pI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mI=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],gI=ct("message-square",mI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yI=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],xI=ct("mic-off",yI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bI=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],P_=ct("mic",bI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vI=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],wI=ct("monitor",vI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NI=[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]],SI=ct("moon",NI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jI=[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]],CI=ct("package-open",jI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _I=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Ud=ct("package",_I);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kI=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],EI=ct("paperclip",kI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TI=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],AI=ct("pause",TI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DI=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Qc=ct("pencil",DI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PI=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],II=ct("phone",PI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MI=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],Uo=ct("pill",MI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RI=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],LI=ct("play",RI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OI=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Gl=ct("plus",OI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FI=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Vs=ct("printer",FI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $I=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],$h=ct("refresh-cw",$I);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zI=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],eu=ct("save",zI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BI=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],vi=ct("search",BI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UI=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],qI=ct("send",UI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VI=[["path",{d:"M6 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-2",key:"4b9dqc"}],["path",{d:"M6 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-2",key:"22nnkd"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m13 6-4 6h6l-4 6",key:"14hqih"}]],Zx=ct("server-crash",VI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HI=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],dg=ct("settings",HI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GI=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],I_=ct("share-2",GI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YI=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],WI=ct("shield-check",YI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QI=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],JI=ct("shopping-cart",QI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KI=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],tu=ct("square-pen",KI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XI=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],ZI=ct("stethoscope",XI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eM=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],tM=ct("sun",eM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nM=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],iM=ct("tag",nM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rM=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Oi=ct("trash-2",rM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aM=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],M_=ct("triangle-alert",aM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sM=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],lM=ct("truck",sM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oM=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],cM=ct("upload",oM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uM=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],R_=ct("user-check",uM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dM=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],L_=ct("user-plus",dM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fM=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Ys=ct("user",fM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hM=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],zh=ct("users",hM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pM=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],mM=ct("video",pM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gM=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],O_=ct("wallet",gM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yM=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Kn=ct("x",yM),xM="_container_djej9_1",bM="_title_djej9_17",vM="_filtersContainer_djej9_31",wM="_dateInputLabel_djej9_55",NM="_dateInput_djej9_55",SM="_fetchButton_djej9_105",jM="_summarySection_djej9_145",CM="_totalRevenue_djej9_153",_M="_totalRevenueAmount_djej9_175",kM="_card_djej9_187",EM="_cardTitle_djej9_203",TM="_cardList_djej9_217",AM="_cardListItem_djej9_227",DM="_cardListItemAmount_djej9_247",PM="_revenueGrid_djej9_257",IM="_revenueCard_djej9_271",MM="_revenueCardTitle_djej9_285",RM="_revenueCardAmount_djej9_297",LM="_revenueCardSubtitle_djej9_307",OM="_receptionRevenue_djej9_317",FM="_pharmacyRevenue_djej9_323",$M="_labRevenue_djej9_329",zM="_revenueCardList_djej9_337",BM="_tableSectionTitle_djej9_377",UM="_tableContainer_djej9_397",qM="_styledTable_djej9_411",VM="_capitalize_djej9_461",HM="_noDataMessage_djej9_469",GM="_errorAlert_djej9_489",YM="_loadingContainer_djej9_521",WM="_breathingBall_djej9_543",Et={container:xM,title:bM,filtersContainer:vM,dateInputLabel:wM,dateInput:NM,fetchButton:SM,summarySection:jM,totalRevenue:CM,totalRevenueAmount:_M,card:kM,cardTitle:EM,cardList:TM,cardListItem:AM,cardListItemAmount:DM,revenueGrid:PM,revenueCard:IM,revenueCardTitle:MM,revenueCardAmount:RM,revenueCardSubtitle:LM,receptionRevenue:OM,pharmacyRevenue:FM,labRevenue:$M,revenueCardList:zM,tableSectionTitle:BM,tableContainer:UM,styledTable:qM,capitalize:VM,noDataMessage:HM,errorAlert:GM,loadingContainer:YM,breathingBall:WM},QM=()=>{const e=new Date().toISOString().split("T")[0],[n,t]=w.useState(e),[r,a]=w.useState(e),[l,o]=w.useState([]),[f,u]=w.useState([]),[d,h]=w.useState([]),[g,b]=w.useState(0),[v,S]=w.useState(0),[k,T]=w.useState(null),[E,P]=w.useState(null),[I,V]=w.useState({reception:{},pharmacy:{},lab:{}}),[F,O]=w.useState(!1),[B,U]=w.useState(null),z=async()=>{if(O(!0),U(null),o([]),u([]),h([]),b(0),S(0),T(null),P(null),V({reception:{},pharmacy:{},lab:{}}),!n||!r){U("Please select both start and end dates."),O(!1);return}if(new Date(n)>new Date(r)){U("Start date cannot be after end date."),O(!1);return}try{const[R,H,ee]=await Promise.all([fe(`/api/bills?startDate=${n}&endDate=${r}`),fe(`/api/payment/admission?startDate=${n}&endDate=${r}`),fe(`/api/subscriptions/transactions/manual?startDate=${n}&endDate=${r}`)]);if(!R.ok){const ve=await R.json().catch(()=>({}));throw new Error(`Bills fetch error: ${ve.message||R.statusText}`)}if(!H.ok){const ve=await H.json().catch(()=>({}));throw new Error(`Admission Payments fetch error: ${ve.message||H.statusText}`)}if(!ee.ok){const ve=await ee.json().catch(()=>({}));throw new Error(`Manual Subscriptions fetch error: ${ve.message||ee.statusText}`)}const Z=await R.json(),te=await H.json(),Q=await ee.json(),q=Z.bills||[],W=te.admissionPayments||[],ne=Q||[];o(q),u(W),h(ne);let A=0,ie=0;const se={},M={consultation:0,pharmacy:0,lab:0,other:0},ce={reception:{},pharmacy:{},lab:{}};q.forEach(ve=>{if(ve.status==="paid"||ve.type==="pharmacy_return"){const le=parseFloat(ve.amount.toString()),xe=ve.payment_mode||"Unknown";let ue=ve.type||"other";ue==="pharmacy_return"&&(ie+=le,ue="pharmacy"),A+=le,se[xe]=(se[xe]||0)+le,M.hasOwnProperty(ue)?M[ue]=(M[ue]||0)+le:M.other=(M.other||0)+le,ue==="pharmacy"?ce.pharmacy[xe]=(ce.pharmacy[xe]||0)+le:ue==="lab"?ce.lab[xe]=(ce.lab[xe]||0)+le:ce.reception[xe]=(ce.reception[xe]||0)+le}}),W.forEach(ve=>{const le=parseFloat(ve.amount_paid.toString()),xe=ve.payment_mode||"Unknown";A+=le,se[xe]=(se[xe]||0)+le,ce.reception[xe]=(ce.reception[xe]||0)+le}),ne.forEach(ve=>{var ue,ze;const le=parseFloat(((ze=(ue=ve.subscriptionPlan)==null?void 0:ue.price)==null?void 0:ze.toString())??"0"),xe=ve.subscription_payment_method||"Unknown";A+=le,se[xe]=(se[xe]||0)+le,ce.reception[xe]=(ce.reception[xe]||0)+le}),T(se),P(M),V(ce),b(A),S(ie)}catch(R){console.error("Failed to fetch money flow data:",R),U(R.message||"Failed to fetch data. Check console for details.")}finally{O(!1)}},$=()=>{z()};return i.jsxs("div",{className:Et.container,children:[i.jsx("h2",{className:Et.title,children:"Money Flow Analysis"}),i.jsxs("div",{className:Et.filtersContainer,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"start-date-money",className:Et.dateInputLabel,children:"Start Date:"}),i.jsx("input",{type:"date",id:"start-date-money",value:n,onChange:R=>t(R.target.value),className:Et.dateInput})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"end-date-money",className:Et.dateInputLabel,children:"End Date:"}),i.jsx("input",{type:"date",id:"end-date-money",value:r,onChange:R=>a(R.target.value),className:Et.dateInput})]}),i.jsx("button",{onClick:$,disabled:F,className:Et.fetchButton,children:F?"Loading...":"Fetch Data"})]}),B&&i.jsxs("div",{className:Et.errorAlert,role:"alert",children:[i.jsx(si,{size:20})," ",i.jsxs("span",{children:["Error: ",B]})]}),!F&&!B&&(l.length>0||f.length>0||d.length>0)&&i.jsxs("div",{className:Et.summarySection,children:[i.jsxs("h3",{className:Et.totalRevenue,children:["Total Paid Revenue (",n," to ",r,"):",i.jsxs("span",{className:Et.totalRevenueAmount,children:["",g.toFixed(2)]})]}),k&&Object.keys(k).length>0&&i.jsxs("div",{className:Et.card,children:[i.jsx("h4",{className:Et.cardTitle,children:"Revenue by Payment Mode:"}),i.jsx("ul",{className:Et.cardList,children:Object.entries(k).map(([R,H])=>i.jsxs("li",{className:Et.cardListItem,children:[R,": ",i.jsxs("span",{className:Et.cardListItemAmount,children:["",H.toFixed(2)]})]},R))})]}),E&&I&&i.jsxs("div",{className:Et.revenueGrid,children:[i.jsxs("div",{className:`${Et.revenueCard} ${Et.receptionRevenue}`,children:[i.jsx("h4",{className:Et.revenueCardTitle,children:"Reception Revenue"}),i.jsxs("p",{className:Et.revenueCardAmount,children:["",(E.consultation+E.other).toFixed(2)]}),i.jsx("span",{className:Et.revenueCardSubtitle,children:"(Consultation + Other + Admissions + Subscriptions)"}),Object.keys(I.reception).length>0&&i.jsx("ul",{className:Et.revenueCardList,children:Object.entries(I.reception).map(([R,H])=>i.jsxs("li",{children:[R,": ",i.jsxs("span",{children:["",H.toFixed(2)]})]},`reception-${R}`))})]}),i.jsxs("div",{className:`${Et.revenueCard} ${Et.pharmacyRevenue}`,children:[i.jsx("h4",{className:Et.revenueCardTitle,children:"Pharmacy Revenue"}),i.jsxs("p",{className:Et.revenueCardAmount,children:["",E.pharmacy.toFixed(2)]}),v<0&&i.jsxs("p",{className:Et.revenueCardSubtitle,children:["Returns: ",i.jsxs("span",{className:Et.negativeAmount,children:["",v.toFixed(2)]})]}),Object.keys(I.pharmacy).length>0&&i.jsx("ul",{className:Et.revenueCardList,children:Object.entries(I.pharmacy).map(([R,H])=>i.jsxs("li",{children:[R,": ",i.jsxs("span",{children:["",H.toFixed(2)]})]},`pharmacy-${R}`))})]}),i.jsxs("div",{className:`${Et.revenueCard} ${Et.labRevenue}`,children:[i.jsx("h4",{className:Et.revenueCardTitle,children:"Lab Revenue"}),i.jsxs("p",{className:Et.revenueCardAmount,children:["",E.lab.toFixed(2)]}),Object.keys(I.lab).length>0&&i.jsx("ul",{className:Et.revenueCardList,children:Object.entries(I.lab).map(([R,H])=>i.jsxs("li",{children:[R,": ",i.jsxs("span",{children:["",H.toFixed(2)]})]},`lab-${R}`))})]})]}),i.jsxs("h4",{className:Et.tableSectionTitle,children:["Individual Bills (",l.filter(R=>R.status==="paid"||R.type==="pharmacy_return").length,"):"]}),l.filter(R=>R.status==="paid"||R.type==="pharmacy_return").length>0?i.jsx("div",{className:Et.tableContainer,children:i.jsxs("table",{className:Et.styledTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Bill ID"}),i.jsx("th",{children:"Patient ID"}),i.jsx("th",{children:"Type"}),i.jsx("th",{children:"Amount"}),i.jsx("th",{children:"Payment Mode"})]})}),i.jsx("tbody",{children:l.filter(R=>R.status==="paid"||R.type==="pharmacy_return").map(R=>i.jsxs("tr",{children:[i.jsx("td",{children:new Date(R.createdAt).toLocaleDateString()}),i.jsx("td",{children:R.id}),i.jsx("td",{children:R.patient_id}),i.jsx("td",{className:Et.capitalize,children:R.type}),i.jsxs("td",{children:["",parseFloat(R.amount.toString()).toFixed(2)]}),i.jsx("td",{children:R.payment_mode})]},`bill-${R.id}`))})]})}):i.jsx("p",{className:Et.noDataMessage,children:"No relevant bills found for the selected period."}),i.jsxs("h4",{className:Et.tableSectionTitle,children:["Admission Payments (",f.length,"):"]}),f.length>0?i.jsx("div",{className:Et.tableContainer,children:i.jsxs("table",{className:Et.styledTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Payment ID"}),i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Payment Mode"})]})}),i.jsx("tbody",{children:f.map(R=>{var H;return i.jsxs("tr",{children:[i.jsx("td",{children:new Date(R.payment_date).toLocaleDateString()}),i.jsx("td",{children:R.id}),i.jsx("td",{children:((H=R.Patient)==null?void 0:H.name)??R.patient_id})," ",i.jsxs("td",{children:["",parseFloat(R.amount_paid.toString()).toFixed(2)]}),i.jsx("td",{children:R.payment_mode})]},`admission-${R.id}`)})})]})}):i.jsx("p",{className:Et.noDataMessage,children:"No admission payments found for the selected period."}),i.jsxs("h4",{className:Et.tableSectionTitle,children:["Manual Subscription Payments (",d.length,"):"]}),d.length>0?i.jsx("div",{className:Et.tableContainer,children:i.jsxs("table",{className:Et.styledTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Start Date"}),i.jsx("th",{children:"Patient ID"}),i.jsx("th",{children:"Patient Name"}),i.jsx("th",{children:"Plan Name"}),i.jsx("th",{children:"Plan Amount"}),i.jsx("th",{children:"Payment Mode"})]})}),i.jsx("tbody",{children:d.map(R=>{var H,ee,Z;return i.jsxs("tr",{children:[i.jsx("td",{children:new Date(R.subscription_start_date).toLocaleDateString()}),i.jsx("td",{children:R.id}),i.jsx("td",{children:R.name}),i.jsx("td",{children:((H=R.subscriptionPlan)==null?void 0:H.name)??"N/A"}),i.jsxs("td",{children:["",parseFloat(((Z=(ee=R.subscriptionPlan)==null?void 0:ee.price)==null?void 0:Z.toString())??"0").toFixed(2)]}),i.jsx("td",{className:Et.capitalize,children:R.subscription_payment_method})]},`sub-patient-${R.id}`)})})]})}):i.jsx("p",{className:Et.noDataMessage,children:"No manual subscription payments found for the selected period."})]}),F&&i.jsxs("div",{className:Et.loadingContainer,children:[i.jsx("div",{className:Et.breathingBall}),i.jsx("p",{children:"Loading data..."})]}),!F&&!B&&l.length===0&&f.length===0&&d.length===0&&i.jsx("p",{className:Et.noDataMessage,children:"No data found for the selected period. Click 'Fetch Data'."})]})},JM=()=>{const e=localStorage.getItem("currentClinicId");return e||(console.warn("getCurrentClinicId: Clinic ID not found. Returning null. Ensure this is implemented correctly."),null)},eb=()=>localStorage.getItem("authToken"),tw=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!1),[a,l]=w.useState(null),[o,f]=w.useState(!1),[u,d]=w.useState(null),h=w.useRef(null),[g,b]=w.useState(!1),[v,S]=w.useState(null),[k,T]=w.useState(!1),[E,P]=w.useState(!1),[I,V]=w.useState(null),[F,O]=w.useState({name:"",description:"",price:"",default_parameters:[]}),B=w.useCallback(async()=>{r(!0),l(null),d(null),S(null);try{const se=await fe("/api/lab-tests");if(!se.ok)throw new Error(`HTTP error! status: ${se.status}`);const M=await se.json();n(M)}catch(se){console.error("Error fetching lab tests:",se),l(se.message||"Failed to fetch lab tests.")}finally{r(!1)}},[]);w.useEffect(()=>{B()},[B]);const U=se=>{const{name:M,value:ce}=se.target;O(ve=>({...ve,[M]:ce}))},z=(se,M,ce)=>{const ve=[...F.default_parameters],le=ve[se];if(M==="type")switch(le.type=ce,ce){case"number":le.defaultValue=0,le.lower_limit=null,le.upper_limit=null,le.unit="";break;case"boolean":le.defaultValue=!1,le.lower_limit=void 0,le.upper_limit=void 0,le.unit=void 0;break;case"string":default:le.defaultValue="",le.lower_limit=void 0,le.upper_limit=void 0,le.unit=void 0;break}else M==="defaultValue"?le.type==="number"?le.defaultValue=parseFloat(ce)||0:(le.type,le.defaultValue=ce):M==="lower_limit"||M==="upper_limit"?le[M]=ce===""?null:parseFloat(ce):le[M]=ce;O(xe=>({...xe,default_parameters:ve}))},$=()=>{O(se=>({...se,default_parameters:[...se.default_parameters,{name:"",type:"string",defaultValue:"",unit:"",lower_limit:null,upper_limit:null}]}))},R=se=>{O(M=>({...M,default_parameters:M.default_parameters.filter((ce,ve)=>ve!==se)}))},H=async se=>{se.preventDefault(),r(!0),l(null);const M=I!==null,ce=M?`/api/lab-tests/${I}`:"/api/lab-tests",ve=M?"PUT":"POST";try{const le=await fe(ce,{method:ve,headers:{"Content-Type":"application/json"},body:JSON.stringify({name:F.name,description:F.description,price:parseFloat(F.price),default_parameters:F.default_parameters})});if(!le.ok){const xe=await le.json();throw new Error(xe.message||`HTTP error! status: ${le.status}`)}P(!1),V(null),O({name:"",description:"",price:"",default_parameters:[]}),B()}catch(le){console.error(`Error ${M?"updating":"adding"} lab test:`,le),l(le.message||`Failed to ${M?"update":"add"} lab test.`)}finally{r(!1)}},ee=()=>{V(null),O({name:"",description:"",price:"",default_parameters:[]}),P(!0)},Z=se=>{if(I===se.id)V(null);else{V(se.id);const M=(se.default_parameters||[]).map(ce=>({...ce,unit:ce.unit||"",lower_limit:ce.lower_limit===void 0?null:ce.lower_limit,upper_limit:ce.upper_limit===void 0?null:ce.upper_limit}));O({name:se.name,description:se.description||"",price:se.price,default_parameters:M}),P(!1)}},te=async se=>{if(window.confirm("Are you sure you want to delete this lab test?")){r(!0),l(null);try{const M=await fe(`/api/lab-tests/${se}`,{method:"DELETE"});if(!M.ok){const ce=await M.json();throw new Error(ce.message||`HTTP error! status: ${M.status}`)}B()}catch(M){console.error("Error deleting lab test:",M),l(M.message||"Failed to delete lab test.")}finally{r(!1)}}},Q=()=>{P(!1),V(null),l(null),O({name:"",description:"",price:"",default_parameters:[]})},q=async se=>{if(!se){d("No file selected.");return}f(!0),d(null),l(null);const M=new FormData;M.append("file",se);try{const ce=await fe("/api/lab-tests/import",{method:"POST",body:M});if(!ce.ok){const ve=await ce.json();throw new Error(ve.message||`Import failed: ${ce.statusText}`)}B()}catch(ce){console.error("Error importing lab tests from Excel:",ce),d(ce.message||"Failed to import lab tests from Excel.")}finally{f(!1)}},W=async se=>{if(se.target.files&&se.target.files[0]){const M=se.target.files[0];await q(M),se.target&&(se.target.value="")}},ne=async()=>{if(window.confirm("Are you sure you want to import default biochemistry and pathology tests? This will add new tests and may duplicate existing ones if names match.")){b(!0),S(null),l(null);try{const se=await fe("/api/lab-tests/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"}});if(!se.ok){const M=await se.json();throw new Error(M.message||`Default import failed: ${se.statusText}`)}B()}catch(se){console.error("Error importing default lab tests:",se),S(se.message||"Failed to import default lab tests.")}finally{b(!1)}}},A=async()=>{if(window.confirm("Are you sure you want to delete ALL lab tests? This action cannot be undone.")){T(!0),l(null),d(null),S(null);try{const se=await fe("/api/lab-tests/all",{method:"DELETE"});if(!se.ok){const M=await se.json();throw new Error(M.message||`Delete all failed: ${se.statusText}`)}B()}catch(se){console.error("Error deleting all lab tests:",se),l(se.message||"Failed to delete all lab tests.")}finally{T(!1)}}},ie=t||o||g||k;return i.jsxs("div",{className:"lab-inventory-card",children:[i.jsx("h2",{className:"lab-inventory-header",children:"Available Lab Tests"}),i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px"},children:[i.jsx("button",{onClick:ee,className:"lab-inventory-button",disabled:ie,children:"Add New Test"}),i.jsx("button",{onClick:()=>{var se;return(se=h.current)==null?void 0:se.click()},className:"lab-inventory-button lab-inventory-button-secondary",disabled:ie,children:o?"Importing...":"Import from Excel"}),i.jsx("input",{type:"file",ref:h,onChange:W,accept:".xlsx, .xls",style:{display:"none"},disabled:o}),i.jsx("button",{onClick:ne,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ie,children:g?"Importing Defaults...":"Import Default Tests"}),i.jsx("button",{onClick:A,className:"lab-inventory-button lab-inventory-button-danger",disabled:ie,style:{backgroundColor:"#dc3545",borderColor:"#dc3545",color:"white"},children:k?"Deleting All...":"Delete All Tests"})]}),a&&i.jsx("div",{className:"error-text mb-4",children:a}),u&&i.jsxs("div",{className:"error-text mb-4",children:["Import Excel Error: ",u]}),v&&i.jsxs("div",{className:"error-text mb-4",children:["Import Default Error: ",v]}),E&&i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"20px",marginBottom:"20px"},children:[" ",i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"1px solid #eee",marginBottom:"15px"},children:"Add New Lab Test"}),i.jsxs("form",{onSubmit:H,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:F.name,onChange:U,className:"lab-inventory-input",required:!0,disabled:ie})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:F.description,onChange:U,rows:3,className:"lab-inventory-input",disabled:ie})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:F.price,onChange:U,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:ie})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginTop:"20px",marginBottom:"10px"},children:"Default Parameters"}),F.default_parameters.map((se,M)=>{var ce,ve;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:se.name,onChange:le=>z(M,"name",le.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:se.type,onChange:le=>z(M,"type",le.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),se.type==="boolean"?i.jsxs("select",{value:se.defaultValue.toString(),onChange:le=>z(M,"defaultValue",le.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:se.type==="number"?"number":"text",placeholder:"Default Value",value:se.defaultValue.toString(),onChange:le=>z(M,"defaultValue",le.target.value),className:"lab-inventory-input"}),se.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:se.lower_limit===null?"":((ce=se.lower_limit)==null?void 0:ce.toString())??"",onChange:le=>z(M,"lower_limit",le.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:se.upper_limit===null?"":((ve=se.upper_limit)==null?void 0:ve.toString())??"",onChange:le=>z(M,"upper_limit",le.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:se.unit||"",onChange:le=>z(M,"unit",le.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>R(M),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},M)}),i.jsx("button",{type:"button",onClick:$,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:Q,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ie,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:ie,children:t?"Saving...":"Add Test"})]})]})]}),ie&&!E&&i.jsxs("p",{className:"loading-text",children:[" ",o?"Importing Excel data...":g?"Importing default data...":"Loading tests..."]}),!ie&&e.length===0&&!a&&!u&&!v&&i.jsx("p",{className:"no-data-message",children:"No lab tests found. Add one or import from Excel to get started."}),!ie&&e.length>0&&i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{className:"hidden md:table-cell",children:"Description"})," ",i.jsx("th",{children:"Price"}),i.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),i.jsx("tbody",{children:e.map(se=>{const M=I===se.id,ce=se.price&&typeof se.price=="string"?parseFloat(se.price):NaN,ve=isNaN(ce)?"0.00":ce.toFixed(2);return i.jsxs(Rn.Fragment,{children:[i.jsxs("tr",{onClick:()=>Z(se),style:{cursor:"pointer"},children:[i.jsx("td",{children:se.name}),i.jsx("td",{className:"hidden md:table-cell",style:{whiteSpace:"pre-wrap"},children:se.description||"-"}),i.jsxs("td",{children:["",ve]}),i.jsx("td",{style:{textAlign:"right"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[i.jsx("button",{onClick:le=>{le.stopPropagation(),Z(se)},className:"lab-inventory-link",disabled:ie,style:{background:"none",border:"none",padding:"0",cursor:"pointer"},children:"Edit"}),i.jsx("button",{onClick:le=>{le.stopPropagation(),te(se.id)},className:"lab-inventory-link",disabled:ie,style:{background:"none",border:"none",padding:"0",cursor:"pointer",color:"#dc3545"},children:"Delete"})]})})]}),M&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"10px",marginBottom:"10px",border:"1px solid #ddd",padding:"15px"},children:[i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em"},children:"Edit Lab Test"}),i.jsxs("form",{onSubmit:H,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:F.name,onChange:U,className:"lab-inventory-input",required:!0,disabled:ie})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:F.description,onChange:U,rows:3,className:"lab-inventory-input",disabled:ie})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:F.price,onChange:U,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:ie})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",marginTop:"15px"},children:"Default Parameters"}),F.default_parameters.map((le,xe)=>{var ue,ze;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:le.name,onChange:tt=>z(xe,"name",tt.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:le.type,onChange:tt=>z(xe,"type",tt.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),le.type==="boolean"?i.jsxs("select",{value:le.defaultValue.toString(),onChange:tt=>z(xe,"defaultValue",tt.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:le.type==="number"?"number":"text",placeholder:"Default Value",value:le.defaultValue.toString(),onChange:tt=>z(xe,"defaultValue",tt.target.value),className:"lab-inventory-input"}),le.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:le.lower_limit===null?"":((ue=le.lower_limit)==null?void 0:ue.toString())??"",onChange:tt=>z(xe,"lower_limit",tt.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:le.upper_limit===null?"":((ze=le.upper_limit)==null?void 0:ze.toString())??"",onChange:tt=>z(xe,"upper_limit",tt.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:le.unit||"",onChange:tt=>z(xe,"unit",tt.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>R(xe),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},xe)}),i.jsx("button",{type:"button",onClick:$,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:Q,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ie,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:ie,children:t?"Saving...":"Update Test"})]})]})]})})})]},se.id)})})]})]})]})},F_=6048e5,KM=864e5,$_=6e4,z_=36e5,SN=Symbol.for("constructDateFrom");function Ws(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&SN in e?e[SN](n):e instanceof Date?new e.constructor(n):new Date(n)}function Mr(e,n){return Ws(n||e,e)}function G0(e,n,t){const r=Mr(e,t==null?void 0:t.in);if(isNaN(n))return Ws(e,NaN);if(!n)return r;const a=r.getDate(),l=Ws(e,r.getTime());l.setMonth(r.getMonth()+n+1,0);const o=l.getDate();return a>=o?l:(r.setFullYear(l.getFullYear(),l.getMonth(),a),r)}let XM={};function _b(){return XM}function eg(e,n){var f,u,d,h;const t=_b(),r=(n==null?void 0:n.weekStartsOn)??((u=(f=n==null?void 0:n.locale)==null?void 0:f.options)==null?void 0:u.weekStartsOn)??t.weekStartsOn??((h=(d=t.locale)==null?void 0:d.options)==null?void 0:h.weekStartsOn)??0,a=Mr(e,n==null?void 0:n.in),l=a.getDay(),o=(l<r?7:0)+l-r;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function tb(e,n){return eg(e,{...n,weekStartsOn:1})}function B_(e,n){const t=Mr(e,n==null?void 0:n.in),r=t.getFullYear(),a=Ws(t,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const l=tb(a),o=Ws(t,0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);const f=tb(o);return t.getTime()>=l.getTime()?r+1:t.getTime()>=f.getTime()?r:r-1}function jN(e){const n=Mr(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function ZM(e,...n){const t=Ws.bind(null,n.find(r=>typeof r=="object"));return n.map(t)}function CN(e,n){const t=Mr(e,n==null?void 0:n.in);return t.setHours(0,0,0,0),t}function e4(e,n,t){const[r,a]=ZM(t==null?void 0:t.in,e,n),l=CN(r),o=CN(a),f=+l-jN(l),u=+o-jN(o);return Math.round((f-u)/KM)}function t4(e,n){const t=B_(e,n),r=Ws(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),tb(r)}function n4(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function tg(e){return!(!n4(e)&&typeof e!="number"||isNaN(+Mr(e)))}function i4(e,n){const t=Mr(e,n==null?void 0:n.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}const r4={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},a4=(e,n,t)=>{let r;const a=r4[e];return typeof a=="string"?r=a:n===1?r=a.one:r=a.other.replace("{{count}}",n.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function Vv(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const s4={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},l4={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},o4={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},c4={date:Vv({formats:s4,defaultWidth:"full"}),time:Vv({formats:l4,defaultWidth:"full"}),dateTime:Vv({formats:o4,defaultWidth:"full"})},u4={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},d4=(e,n,t,r)=>u4[e];function Dm(e){return(n,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,f=t!=null&&t.width?String(t.width):o;a=e.formattingValues[f]||e.formattingValues[o]}else{const o=e.defaultWidth,f=t!=null&&t.width?String(t.width):e.defaultWidth;a=e.values[f]||e.values[o]}const l=e.argumentCallback?e.argumentCallback(n):n;return a[l]}}const f4={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},h4={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},p4={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},m4={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},g4={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},y4={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},x4=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},b4={ordinalNumber:x4,era:Dm({values:f4,defaultWidth:"wide"}),quarter:Dm({values:h4,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Dm({values:p4,defaultWidth:"wide"}),day:Dm({values:m4,defaultWidth:"wide"}),dayPeriod:Dm({values:g4,defaultWidth:"wide",formattingValues:y4,defaultFormattingWidth:"wide"})};function Pm(e){return(n,t={})=>{const r=t.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],l=n.match(a);if(!l)return null;const o=l[0],f=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(f)?w4(f,g=>g.test(o)):v4(f,g=>g.test(o));let d;d=e.valueCallback?e.valueCallback(u):u,d=t.valueCallback?t.valueCallback(d):d;const h=n.slice(o.length);return{value:d,rest:h}}}function v4(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function w4(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function N4(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const a=r[0],l=n.match(e.parsePattern);if(!l)return null;let o=e.valueCallback?e.valueCallback(l[0]):l[0];o=t.valueCallback?t.valueCallback(o):o;const f=n.slice(a.length);return{value:o,rest:f}}}const S4=/^(\d+)(th|st|nd|rd)?/i,j4=/\d+/i,C4={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},_4={any:[/^b/i,/^(a|c)/i]},k4={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},E4={any:[/1/i,/2/i,/3/i,/4/i]},T4={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},A4={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},D4={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},P4={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},I4={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},M4={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},R4={ordinalNumber:N4({matchPattern:S4,parsePattern:j4,valueCallback:e=>parseInt(e,10)}),era:Pm({matchPatterns:C4,defaultMatchWidth:"wide",parsePatterns:_4,defaultParseWidth:"any"}),quarter:Pm({matchPatterns:k4,defaultMatchWidth:"wide",parsePatterns:E4,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Pm({matchPatterns:T4,defaultMatchWidth:"wide",parsePatterns:A4,defaultParseWidth:"any"}),day:Pm({matchPatterns:D4,defaultMatchWidth:"wide",parsePatterns:P4,defaultParseWidth:"any"}),dayPeriod:Pm({matchPatterns:I4,defaultMatchWidth:"any",parsePatterns:M4,defaultParseWidth:"any"})},L4={code:"en-US",formatDistance:a4,formatLong:c4,formatRelative:d4,localize:b4,match:R4,options:{weekStartsOn:0,firstWeekContainsDate:1}};function O4(e,n){const t=Mr(e,n==null?void 0:n.in);return e4(t,i4(t))+1}function F4(e,n){const t=Mr(e,n==null?void 0:n.in),r=+tb(t)-+t4(t);return Math.round(r/F_)+1}function U_(e,n){var h,g,b,v;const t=Mr(e,n==null?void 0:n.in),r=t.getFullYear(),a=_b(),l=(n==null?void 0:n.firstWeekContainsDate)??((g=(h=n==null?void 0:n.locale)==null?void 0:h.options)==null?void 0:g.firstWeekContainsDate)??a.firstWeekContainsDate??((v=(b=a.locale)==null?void 0:b.options)==null?void 0:v.firstWeekContainsDate)??1,o=Ws((n==null?void 0:n.in)||e,0);o.setFullYear(r+1,0,l),o.setHours(0,0,0,0);const f=eg(o,n),u=Ws((n==null?void 0:n.in)||e,0);u.setFullYear(r,0,l),u.setHours(0,0,0,0);const d=eg(u,n);return+t>=+f?r+1:+t>=+d?r:r-1}function $4(e,n){var f,u,d,h;const t=_b(),r=(n==null?void 0:n.firstWeekContainsDate)??((u=(f=n==null?void 0:n.locale)==null?void 0:f.options)==null?void 0:u.firstWeekContainsDate)??t.firstWeekContainsDate??((h=(d=t.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??1,a=U_(e,n),l=Ws((n==null?void 0:n.in)||e,0);return l.setFullYear(a,0,r),l.setHours(0,0,0,0),eg(l,n)}function z4(e,n){const t=Mr(e,n==null?void 0:n.in),r=+eg(t,n)-+$4(t,n);return Math.round(r/F_)+1}function zn(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const qc={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return zn(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):zn(t+1,2)},d(e,n){return zn(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return zn(e.getHours()%12||12,n.length)},H(e,n){return zn(e.getHours(),n.length)},m(e,n){return zn(e.getMinutes(),n.length)},s(e,n){return zn(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,t-3));return zn(a,n.length)}},bh={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},_N={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return t.ordinalNumber(a,{unit:"year"})}return qc.y(e,n)},Y:function(e,n,t,r){const a=U_(e,r),l=a>0?a:1-a;if(n==="YY"){const o=l%100;return zn(o,2)}return n==="Yo"?t.ordinalNumber(l,{unit:"year"}):zn(l,n.length)},R:function(e,n){const t=B_(e);return zn(t,n.length)},u:function(e,n){const t=e.getFullYear();return zn(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return zn(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return zn(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return qc.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return zn(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const a=z4(e,r);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):zn(a,n.length)},I:function(e,n,t){const r=F4(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):zn(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):qc.d(e,n)},D:function(e,n,t){const r=O4(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):zn(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const a=e.getDay(),l=(a-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(l);case"ee":return zn(l,2);case"eo":return t.ordinalNumber(l,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const a=e.getDay(),l=(a-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(l);case"cc":return zn(l,n.length);case"co":return t.ordinalNumber(l,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),a=r===0?7:r;switch(n){case"i":return String(a);case"ii":return zn(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let a;switch(r===12?a=bh.noon:r===0?a=bh.midnight:a=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let a;switch(r>=17?a=bh.evening:r>=12?a=bh.afternoon:r>=4?a=bh.morning:a=bh.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return qc.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):qc.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):zn(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):zn(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):qc.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):qc.s(e,n)},S:function(e,n){return qc.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return EN(r);case"XXXX":case"XX":return Ld(r);case"XXXXX":case"XXX":default:return Ld(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return EN(r);case"xxxx":case"xx":return Ld(r);case"xxxxx":case"xxx":default:return Ld(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+kN(r,":");case"OOOO":default:return"GMT"+Ld(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+kN(r,":");case"zzzz":default:return"GMT"+Ld(r,":")}},t:function(e,n,t){const r=Math.trunc(+e/1e3);return zn(r,n.length)},T:function(e,n,t){return zn(+e,n.length)}};function kN(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),l=r%60;return l===0?t+String(a):t+String(a)+n+zn(l,2)}function EN(e,n){return e%60===0?(e>0?"-":"+")+zn(Math.abs(e)/60,2):Ld(e,n)}function Ld(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=zn(Math.trunc(r/60),2),l=zn(r%60,2);return t+a+n+l}const TN=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},q_=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},B4=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],a=t[2];if(!a)return TN(e,n);let l;switch(r){case"P":l=n.dateTime({width:"short"});break;case"PP":l=n.dateTime({width:"medium"});break;case"PPP":l=n.dateTime({width:"long"});break;case"PPPP":default:l=n.dateTime({width:"full"});break}return l.replace("{{date}}",TN(r,n)).replace("{{time}}",q_(a,n))},U4={p:q_,P:B4},q4=/^D+$/,V4=/^Y+$/,H4=["D","DD","YY","YYYY"];function G4(e){return q4.test(e)}function Y4(e){return V4.test(e)}function W4(e,n,t){const r=Q4(e,n,t);if(console.warn(r),H4.includes(e))throw new RangeError(r)}function Q4(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const J4=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,K4=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,X4=/^'([^]*?)'?$/,Z4=/''/g,eR=/[a-zA-Z]/;function Bh(e,n,t){var h,g,b,v;const r=_b(),a=r.locale??L4,l=r.firstWeekContainsDate??((g=(h=r.locale)==null?void 0:h.options)==null?void 0:g.firstWeekContainsDate)??1,o=r.weekStartsOn??((v=(b=r.locale)==null?void 0:b.options)==null?void 0:v.weekStartsOn)??0,f=Mr(e,t==null?void 0:t.in);if(!tg(f))throw new RangeError("Invalid time value");let u=n.match(K4).map(S=>{const k=S[0];if(k==="p"||k==="P"){const T=U4[k];return T(S,a.formatLong)}return S}).join("").match(J4).map(S=>{if(S==="''")return{isToken:!1,value:"'"};const k=S[0];if(k==="'")return{isToken:!1,value:tR(S)};if(_N[k])return{isToken:!0,value:S};if(k.match(eR))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");return{isToken:!1,value:S}});a.localize.preprocessor&&(u=a.localize.preprocessor(f,u));const d={firstWeekContainsDate:l,weekStartsOn:o,locale:a};return u.map(S=>{if(!S.isToken)return S.value;const k=S.value;(Y4(k)||G4(k))&&W4(k,n,String(e));const T=_N[k[0]];return T(f,k,a.localize,d)}).join("")}function tR(e){const n=e.match(X4);return n?n[1].replace(Z4,"'"):e}function $d(e,n){return+Mr(e)<+Mr(n)}function nb(e,n){const t=()=>Ws(n==null?void 0:n.in,NaN),a=aR(e);let l;if(a.date){const d=sR(a.date,2);l=lR(d.restDateString,d.year)}if(!l||isNaN(+l))return t();const o=+l;let f=0,u;if(a.time&&(f=oR(a.time),isNaN(f)))return t();if(a.timezone){if(u=cR(a.timezone),isNaN(u))return t()}else{const d=new Date(o+f),h=Mr(0,n==null?void 0:n.in);return h.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),h.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),h}return Mr(o+f+u,n==null?void 0:n.in)}const gx={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},nR=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,iR=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,rR=/^([+-])(\d{2})(?::?(\d{2}))?$/;function aR(e){const n={},t=e.split(gx.dateTimeDelimiter);let r;if(t.length>2)return n;if(/:/.test(t[0])?r=t[0]:(n.date=t[0],r=t[1],gx.timeZoneDelimiter.test(n.date)&&(n.date=e.split(gx.timeZoneDelimiter)[0],r=e.substr(n.date.length,e.length))),r){const a=gx.timezone.exec(r);a?(n.time=r.replace(a[1],""),n.timezone=a[1]):n.time=r}return n}function sR(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),r=e.match(t);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,l=r[2]?parseInt(r[2]):null;return{year:l===null?a:l*100,restDateString:e.slice((r[1]||r[2]).length)}}function lR(e,n){if(n===null)return new Date(NaN);const t=e.match(nR);if(!t)return new Date(NaN);const r=!!t[4],a=Im(t[1]),l=Im(t[2])-1,o=Im(t[3]),f=Im(t[4]),u=Im(t[5])-1;if(r)return pR(n,f,u)?uR(n,f,u):new Date(NaN);{const d=new Date(0);return!fR(n,l,o)||!hR(n,a)?new Date(NaN):(d.setUTCFullYear(n,l,Math.max(a,o)),d)}}function Im(e){return e?parseInt(e):1}function oR(e){const n=e.match(iR);if(!n)return NaN;const t=Hv(n[1]),r=Hv(n[2]),a=Hv(n[3]);return mR(t,r,a)?t*z_+r*$_+a*1e3:NaN}function Hv(e){return e&&parseFloat(e.replace(",","."))||0}function cR(e){if(e==="Z")return 0;const n=e.match(rR);if(!n)return 0;const t=n[1]==="+"?-1:1,r=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return gR(r,a)?t*(r*z_+a*$_):NaN}function uR(e,n,t){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,l=(n-1)*7+t+1-a;return r.setUTCDate(r.getUTCDate()+l),r}const dR=[31,null,31,30,31,30,31,31,30,31,30,31];function V_(e){return e%400===0||e%4===0&&e%100!==0}function fR(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(dR[n]||(V_(e)?29:28))}function hR(e,n){return n>=1&&n<=(V_(e)?366:365)}function pR(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function mR(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function gR(e,n){return n>=0&&n<=59}const AN=10,yR=3,H_=()=>{const e=wt(),[n,t]=w.useState([]),[r,a]=w.useState([]),[l,o]=w.useState(""),[f,u]=w.useState(!0),[d,h]=w.useState(null),[g,b]=w.useState(new Set),[v,S]=w.useState("all"),k=async()=>{try{const oe=await fe("/api/inventory/download-csv");if(!oe.ok)throw new Error(`Failed to download CSV: ${oe.statusText}`);const J=await oe.blob(),de=window.URL.createObjectURL(J),Be=document.createElement("a");Be.href=de,Be.download="pharmacy_inventory.csv",document.body.appendChild(Be),Be.click(),Be.remove(),window.URL.revokeObjectURL(de)}catch(oe){console.error("Failed to download CSV:",oe),h(oe.message||"Failed to download inventory CSV. Please try again.")}},[T,E]=w.useState(!1),[P,I]=w.useState(!1),[V,F]=w.useState(null),[O,B]=w.useState(!1),[U,z]=w.useState(new Set),[$,R]=w.useState(null),[H,ee]=w.useState(0),[Z,te]=w.useState(!1),[Q,q]=w.useState(null),[W,ne]=w.useState(1),[A,ie]=w.useState(!1),se=w.useCallback(async()=>{u(!0),h(null);try{const oe=await fe("/api/drugs");if(!oe.ok)throw new Error(`Failed to fetch drugs: ${oe.statusText} (${oe.status})`);let J=await oe.json();J=J.map(de=>({...de,price:parseFloat(String(de.price))||0,buying_price:de.buying_price!==null&&de.buying_price!==void 0?parseFloat(String(de.buying_price)):null,quantity_in_stock:parseInt(String(de.quantity_in_stock),10)||0,gst:de.gst!==null&&de.gst!==void 0?parseFloat(String(de.gst)):null,margin:de.margin!==null&&de.margin!==void 0?parseFloat(String(de.margin)):null,discount:de.discount!==null&&de.discount!==void 0?parseFloat(String(de.discount)):null})),t(J),a(J)}catch(oe){console.error("Failed to fetch drugs:",oe),h(oe.message||"Failed to load inventory. Please try again.")}finally{u(!1)}},[]);w.useEffect(()=>{se()},[se]),w.useEffect(()=>{const oe=l.toLowerCase();let J=n.filter(be=>{var Ve,qe,Ke,We,zt;const Fe=((Ve=be.name)==null?void 0:Ve.toLowerCase())||"",$e=((qe=be.description)==null?void 0:qe.toLowerCase())||"",st=((Ke=be.supplier)==null?void 0:Ke.toLowerCase())||"",rt=((We=be.box_number)==null?void 0:We.toLowerCase())||"",Le=((zt=be.brand_name)==null?void 0:zt.toLowerCase())||"";return Fe.includes(oe)||$e.includes(oe)||st.includes(oe)||rt.includes(oe)||Le.includes(oe)});const de=new Date,Be=G0(de,yR);v==="low-stock"?J=J.filter(be=>be.quantity_in_stock<=AN):v==="near-expiry"?J=J.filter(be=>{if(!be.expiry_date)return!1;const Fe=nb(be.expiry_date);return tg(Fe)&&$d(Fe,Be)&&!$d(Fe,de)}):v==="expired"&&(J=J.filter(be=>{if(!be.expiry_date)return!1;const Fe=nb(be.expiry_date);return tg(Fe)&&$d(Fe,de)})),a(J)},[l,n,v]);const M=()=>{E(!1),R(null)},ce=oe=>{ee(parseInt(oe.target.value,10)||0)},ve=async oe=>{if(oe.preventDefault(),h(null),!$||!$.id||H===0){h("No drug selected or adjustment amount is zero.");return}try{const J=await fe(`/api/drugs/${$.id}/adjust-stock`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantityChange:H})});if(!J.ok){const Be=await J.json();throw new Error(Be.message||`Failed to adjust stock: ${J.statusText}`)}const de=await J.json();t(Be=>Be.map(be=>be.id===de.id?de:be)),M(),alert(`Stock for "${de.name}" adjusted successfully. New stock: ${de.quantity_in_stock}`)}catch(J){console.error("Failed to adjust stock:",J),h(J.message||"Failed to adjust stock. Please try again.")}},le=oe=>{F(oe),I(!0)},xe=()=>{I(!1),F(null)},ue=async()=>{if(!V||!V.id){h("No drug selected for deletion.");return}u(!0),h(null);try{const oe=await fe(`/api/drugs/${V.id}`,{method:"DELETE"});if(!oe.ok){const J=await oe.json();throw new Error(J.message||`Failed to delete drug: ${oe.statusText}`)}alert(`Drug "${V.name}" deleted successfully.`),se(),xe()}catch(oe){console.error("Failed to delete drug:",oe),h(oe.message||"Failed to delete drug. Please try again.")}finally{u(!1)}},ze=()=>{B(!0)},tt=()=>{B(!1)},[ft,Re]=w.useState(!1),je=()=>{U.size>0&&Re(!0)},he=()=>{Re(!1)},Ae=async()=>{if(U.size===0){h("No drugs selected for deletion.");return}u(!0),h(null);try{const oe=await fe("/api/drugs/batch-delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({drugIds:Array.from(U)})});if(!oe.ok){const J=await oe.json();throw new Error(J.message||`Failed to delete selected drugs: ${oe.statusText}`)}alert(`${U.size} drug(s) deleted successfully.`),se(),z(new Set),he()}catch(oe){console.error("Failed to delete selected drugs:",oe),h(oe.message||"Failed to delete selected drugs. Please try again.")}finally{u(!1)}},we=async()=>{u(!0),h(null);try{const oe=await fe("/api/drugs/all",{method:"DELETE"});if(!oe.ok){const J=await oe.json();throw new Error(J.message||`Failed to delete all drugs: ${oe.statusText}`)}alert("All drugs deleted successfully."),se(),tt()}catch(oe){console.error("Failed to delete all drugs:",oe),h(oe.message||"Failed to delete all drugs. Please try again.")}finally{u(!1)}},Me=oe=>{if(!oe)return null;const J=oe.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return J?parseInt(J[1],10):null},De=oe=>{q(oe),ne(1),te(!0)},Je=()=>{te(!1),q(null),ne(1)},nt=oe=>{ne(parseInt(oe.target.value,10)||0)},Ge=async oe=>{if(oe.preventDefault(),h(null),!Q||!Q.id||W<=0){h("No drug selected or invalid number of packs to convert.");return}const J=Me(Q.unit);if(!J||J<=0){h(`Cannot convert "${Q.name}" to loose. Invalid pack unit: ${Q.unit||"N/A"}.`);return}if(W>(Q.quantity_in_stock??0)){h(`Cannot convert ${W} packs. Only ${Q.quantity_in_stock??0} packs are in stock.`);return}try{const de=await fe(`/api/drugs/${Q.id}/convert-to-loose`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({packsToConvert:W,packSize:J})});if(!de.ok){const be=await de.json();throw new Error(be.message||`Failed to convert to loose: ${de.statusText}`)}const Be=await de.json();t(be=>be.map(Fe=>Fe.id===Be.id?Be:Fe)),Je(),alert(`Converted ${W} pack(s) of "${Be.name}" to loose. New stock: ${Be.quantity_in_stock} packs, ${Be.loose??0} loose units.`)}catch(de){console.error("Failed to convert to loose:",de),h(de.message||"Failed to convert to loose. Please try again.")}finally{u(!1)}},St=()=>{ie(!0)},It=()=>{ie(!1)},Vt=async()=>{u(!0),h(null);try{const oe=await fe("/api/drugs/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!oe.ok){const J=await oe.json();throw new Error(J.message||`Failed to add default medications: ${oe.statusText}`)}alert("Default medications added successfully."),se(),It()}catch(oe){console.error("Failed to add default medications:",oe),h(oe.message||"Failed to add default medications. Please try again.")}finally{u(!1)}};return f?i.jsx("div",{className:"loading-indicator",children:"Loading Inventory..."}):d?i.jsxs("div",{className:"error-indicator",children:["Error: ",d]}):i.jsxs("div",{className:"pharmacy-inventory-page",children:[i.jsxs("div",{className:"inventory-header-controls",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsx("button",{onClick:()=>e(-1),className:"action-icon-button",title:"Go Back",children:i.jsx(Ht,{size:24})}),i.jsx("h2",{className:"inventory-page-title",children:"Pharmacy Inventory"})]}),i.jsxs("div",{className:"inventory-actions-group",children:[i.jsxs("div",{className:"action-group-left",children:[i.jsxs("button",{onClick:()=>e("/dashboard/purchase"),className:"action-button add-drug-button",children:[i.jsx(Fo,{size:18,className:"button-icon"}),"Add New Drug"]}),i.jsxs("button",{onClick:()=>e("/dashboard/purchase"),className:"action-button add-purchase-button",children:[i.jsx(Fo,{size:18,className:"button-icon"}),"Open Purchase Page"]}),i.jsxs("button",{onClick:()=>e("/dashboard/distributors"),className:"action-button view-distributors-button",children:[i.jsx(Fo,{size:18,className:"button-icon"}),"View Distributors"]})]}),i.jsxs("div",{className:"action-group-right",children:[i.jsx("button",{onClick:k,className:"action-button download-csv-button",children:"Download CSV"}),i.jsxs("button",{onClick:St,className:"action-button add-defaults-button",children:[i.jsx(Fo,{size:18,className:"button-icon"}),"Add Default Medications"]}),i.jsxs("button",{onClick:je,className:"action-button delete-selected-drugs-button",disabled:U.size===0,children:[i.jsx(Oi,{size:18,className:"button-icon"}),"Delete Selected (",U.size,")"]}),i.jsxs("button",{onClick:ze,className:"action-button delete-all-drugs-button",children:[i.jsx(Oi,{size:18,className:"button-icon"}),"Delete All Drugs"]})]})]})]}),i.jsxs("div",{className:"search-bar-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search drugs by name, brand, description, or supplier...",value:l,onChange:oe=>o(oe.target.value),className:"inventory-search-input"}),i.jsx(vi,{size:18,className:"search-input-icon"})]}),i.jsxs("div",{className:"filter-dropdown-wrapper",children:[i.jsx("label",{htmlFor:"filter-option",className:"sr-only",children:"Filter Inventory"}),i.jsxs("select",{id:"filter-option",value:v,onChange:oe=>S(oe.target.value),className:"inventory-filter-select",children:[i.jsx("option",{value:"all",children:"All Drugs"}),i.jsx("option",{value:"low-stock",children:"Low Stock"}),i.jsx("option",{value:"near-expiry",children:"Near Expiry"}),i.jsx("option",{value:"expired",children:"Expired"})]})]})]}),i.jsx("div",{className:"inventory-table-container",children:i.jsxs("table",{className:"inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"checkbox-header",children:i.jsx("input",{type:"checkbox",onChange:oe=>{if(oe.target.checked){const J=new Set(r.map(de=>de.id));z(J)}else z(new Set)},checked:U.size===r.length&&r.length>0,disabled:r.length===0})}),i.jsx("th",{className:"drug-name-header",children:"Drug Name"}),i.jsx("th",{className:"brand-name-header",children:"Brand Name"}),i.jsx("th",{className:"pack-header",children:"Pack"}),i.jsx("th",{className:"expiry-header",children:"Expiry"}),i.jsx("th",{className:"text-stock qty-header",children:"Stock"}),i.jsx("th",{className:"text-price mrp-header",children:"MRP"}),i.jsx("th",{className:"text-cost rate-header",children:"Rate"}),i.jsx("th",{className:"box-number-header",children:"Box Number"}),i.jsx("th",{className:"discount-header",children:"Discount (%)"}),i.jsx("th",{className:"margin-header",children:"Margin (%)"}),i.jsx("th",{className:"hidden-loose-price",children:"Loose Price"}),i.jsx("th",{className:"actions-cell",children:"Actions"}),i.jsx("th",{className:"expand-collapse-header"})]})}),i.jsxs("tbody",{children:[r.length===0&&i.jsx("tr",{className:"no-results-message",children:i.jsx("td",{colSpan:15,children:"No drugs found matching your search."})}),r.map(oe=>i.jsxs(i.Fragment,{children:[i.jsxs("tr",{className:"drug-row",onClick:()=>{const J=new Set(g);J.has(oe.id)&&oe.id!==void 0?J.delete(oe.id):oe.id!==void 0&&J.add(oe.id),b(J)},children:[i.jsx("td",{className:"checkbox-cell",children:i.jsx("input",{type:"checkbox",onClick:J=>J.stopPropagation(),checked:U.has(oe.id),onChange:()=>{const J=new Set(U);J.has(oe.id)?J.delete(oe.id):J.add(oe.id),z(J)}})}),i.jsx("td",{className:"drug-name-cell",children:oe.name||"-"}),i.jsx("td",{className:"brand-name-cell",children:oe.brand_name||"-"}),i.jsx("td",{className:"text-muted pack-cell",children:oe.unit||"-"}),i.jsx("td",{className:"text-muted",children:oe.expiry_date?new Date(oe.expiry_date).toLocaleDateString():"-"}),i.jsxs("td",{className:`text-stock ${oe.quantity_in_stock<=AN?"low-stock":""}`,children:[i.jsxs("div",{children:[oe.quantity_in_stock," packs"]}),i.jsx("div",{className:"loose-quantity",children:oe.loose!==null&&oe.loose!==void 0?`${oe.loose} loose`:""})]}),i.jsxs("td",{className:"text-muted text-price",children:["",typeof oe.price=="number"?oe.price.toFixed(2):"N/A"]}),i.jsx("td",{className:"text-muted text-cost",children:oe.buying_price!==null&&oe.buying_price!==void 0?`${oe.buying_price.toFixed(2)}`:"-"}),i.jsx("td",{className:"text-muted",children:oe.box_number||"-"}),i.jsx("td",{className:"text-muted",children:oe.discount!==null&&oe.discount!==void 0?`${oe.discount.toFixed(2)}%`:"-"}),i.jsx("td",{className:"text-muted",children:(()=>{const J=oe.price||0,de=oe.buying_price||0,Be=oe.discount||0,be=oe.gst||0,$e=de*(1-Be/100)*(1+be/100),st=J-$e;return`${(J>0?st/J*100:0).toFixed(2)}%`})()}),i.jsx("td",{className:"text-muted hidden-loose-price",children:(()=>{const J=Me(oe.unit);return J&&J>0&&typeof oe.price=="number"?`${(oe.price/J).toFixed(2)}`:"N/A"})()}),i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsx("button",{onClick:()=>e(`/dashboard/inventory/edit/${oe.id}`),className:"action-icon-button",title:"Edit Drug",children:i.jsx(tu,{size:18})}),i.jsx("button",{onClick:()=>le(oe),className:"action-icon-button delete-button",title:"Delete Drug",children:i.jsx(Oi,{size:18})}),i.jsx("button",{onClick:()=>{R(oe),E(!0)},className:"action-icon-button adjust-stock-button",title:"Adjust Stock",children:i.jsx(BP,{size:18})}),i.jsx("button",{onClick:()=>De(oe),className:"action-icon-button convert-to-loose-button",title:"Convert to Loose",disabled:!oe.unit||Me(oe.unit)===null,children:i.jsx(CI,{size:18})})]})}),i.jsx("td",{className:"expand-collapse-cell",children:g.has(oe.id)?i.jsx(H0,{size:20}):i.jsx(Kx,{size:20})})]},oe.id),g.has(oe.id)&&i.jsx("tr",{className:"collapsible-row",children:i.jsx("td",{colSpan:15,children:i.jsxs("div",{className:"collapsible-content",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Drug Name:"})," ",oe.name||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Description:"})," ",oe.description||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Supplier:"})," ",oe.supplier||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Brand Name:"})," ",oe.brand_name||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Batch:"})," ",oe.batch||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"HSN Code:"})," ",oe.hsn_code||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"MFG:"})," ",oe.mfg||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Loose:"})," ",oe.loose!==null&&oe.loose!==void 0?oe.loose:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Loose Price:"}),(()=>{const J=Me(oe.unit);return J&&J>0&&typeof oe.price=="number"?`${(oe.price/J).toFixed(2)}`:"N/A"})()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"GST:"})," ",oe.gst!==null&&oe.gst!==void 0?`${oe.gst.toFixed(2)}%`:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Discount:"})," ",oe.discount!==null&&oe.discount!==void 0?`${oe.discount.toFixed(2)}%`:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Calculated Margin:"}),(()=>{const J=oe.price||0,de=oe.buying_price||0,Be=oe.discount||0,be=oe.gst||0,$e=de*(1-Be/100)*(1+be/100),st=J-$e;return`${(J>0?st/J*100:0).toFixed(2)}%`})()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Last Updated:"})," ",new Date(oe.last_updated).toLocaleString()]})]})})})]}))]})]})}),P&&V&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:xe,className:"modal-close-button",children:i.jsx(Kn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion"}),i.jsxs("p",{className:"modal-description",children:['Are you sure you want to delete "',i.jsx("span",{className:"drug-name",children:V.name||"Unnamed Drug"}),'"? This action cannot be undone.']}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:xe,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:ue,className:"button-delete",children:"Delete"})]})]})}),T&&$&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:M,className:"modal-close-button",children:i.jsx(Kn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Adjust Stock"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:$.name||"Unnamed Drug"}),i.jsx("br",{}),"Current Stock: ",$.quantity_in_stock]}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("form",{onSubmit:ve,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"adjustment",className:"form-label",children:"Adjustment Amount"}),i.jsx("input",{type:"number",name:"adjustment",id:"adjustment",required:!0,step:"1",value:H,onChange:ce,placeholder:"e.g., 10 or -5",className:"form-input"}),i.jsx("p",{className:"form-help-text",children:"Enter a positive number to add stock, negative to remove."})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:M,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Adjust Stock"})]})]})]})}),O&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:tt,className:"modal-close-button",children:i.jsx(Kn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of All Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:"ALL"})," drugs from the inventory? This action cannot be undone."]}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:tt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:we,className:"button-delete",children:"Delete All"})]})]})}),ft&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:he,className:"modal-close-button",children:i.jsx(Kn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of Selected Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:U.size})," selected drug(s)? This action cannot be undone."]}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:he,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Ae,className:"button-delete",children:"Delete Selected"})]})]})}),Z&&Q&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Je,className:"modal-close-button",children:i.jsx(Kn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Convert Pack to Loose"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:Q.name||"Unnamed Drug"}),i.jsx("br",{}),"Current Packs in Stock: ",Q.quantity_in_stock??0,i.jsx("br",{}),"Current Loose Units: ",Q.loose??0,i.jsx("br",{}),"Pack Size: ",Me(Q.unit)||"N/A"," units per pack"]}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("form",{onSubmit:Ge,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"packs-to-convert",className:"form-label",children:"Number of Packs to Convert"}),i.jsx("input",{type:"number",name:"packs-to-convert",id:"packs-to-convert",required:!0,min:"1",step:"1",value:W,onChange:nt,placeholder:"e.g., 1",className:"form-input"}),i.jsxs("p",{className:"form-help-text",children:["This will reduce pack quantity by ",W," and add ",W*(Me(Q.unit)||0)," to loose quantity."]})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Je,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Convert to Loose"})]})]})]})}),A&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:It,className:"modal-close-button",children:i.jsx(Kn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Add Default Medications"}),i.jsx("p",{className:"modal-description",children:"Are you sure you want to add default medications to the inventory? This will add a predefined set of common medications."}),d&&i.jsx("div",{className:"modal-error-message",children:d}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:It,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Vt,className:"button-submit",children:"Add Defaults"})]})]})})]})},xR="_container_1ihgb_1",bR="_title_1ihgb_17",vR="_dateRangeContainer_1ihgb_31",wR="_dateInputLabel_1ihgb_51",NR="_dateInput_1ihgb_51",SR="_fetchButton_1ihgb_87",jR="_sectionTitle_1ihgb_123",CR="_tableContainer_1ihgb_137",_R="_analysisTable_1ihgb_153",kR="_textRight_1ihgb_217",ER="_textGreen_1ihgb_225",TR="_textRed_1ihgb_233",AR="_textOrange_1ihgb_249",DR="_alertBox_1ihgb_265",PR="_alertBoxError_1ihgb_283",IR="_alertBoxIcon_1ihgb_295",MR="_loadingContainer_1ihgb_303",RR="_viewSwitcher_1ihgb_321",LR="_viewButton_1ihgb_339",OR="_viewButtonActive_1ihgb_365",FR="_viewButtonInactive_1ihgb_383",$R="_reasonDistribution_1ihgb_497",zR="_totalRow_1ihgb_513",Jt={container:xR,title:bR,dateRangeContainer:vR,dateInputLabel:wR,dateInput:NR,fetchButton:SR,sectionTitle:jR,tableContainer:CR,analysisTable:_R,textRight:kR,textGreen:ER,textRed:TR,textOrange:AR,alertBox:DR,alertBoxError:PR,alertBoxIcon:IR,loadingContainer:MR,viewSwitcher:RR,viewButton:LR,viewButtonActive:OR,viewButtonInactive:FR,reasonDistribution:$R,totalRow:zR},Y0=()=>{const e=wt(),n=new Date().toISOString().split("T")[0],[t,r]=w.useState(n),[a,l]=w.useState(n),[o,f]=w.useState(null),[u,d]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState("analysis"),S=async()=>{if(d(!0),g(null),f(null),!t||!a){g("Please select both start and end dates."),d(!1);return}if(new Date(t)>new Date(a)){g("Start date cannot be after end date."),d(!1);return}try{const E=JM();if(!E){g("Clinic ID not found. Please log in again."),d(!1);return}const P=await fe(`/api/inventory/comprehensive-analysis?startDate=${t}&endDate=${a}&clinicId=${E}`);if(!P.ok){const V=await P.json();throw new Error(V.message||`HTTP error! status: ${P.status}`)}const I=await P.json();f(I)}catch(E){console.error("Failed to fetch comprehensive inventory analysis data:",E),g(E.message||"Failed to fetch data. Check console for details.")}finally{d(!1)}},k=()=>{S()},T=E=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(E);return i.jsxs("div",{className:Jt.container,children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[" ",i.jsx("h2",{className:Jt.title,children:"Inventory Analysis & Management"}),i.jsx("button",{onClick:()=>e(-1),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 text-sm",children:"Back"})]}),i.jsxs("div",{className:Jt.viewSwitcher,children:[i.jsxs("button",{onClick:()=>v("analysis"),className:`${Jt.viewButton} ${b==="analysis"?Jt.viewButtonActive:Jt.viewButtonInactive}`,children:[i.jsx(PP,{size:16})," ","Analysis"]}),i.jsxs("button",{onClick:()=>v("labInventory"),className:`${Jt.viewButton} ${b==="labInventory"?Jt.viewButtonActive:Jt.viewButtonInactive}`,children:[i.jsx(ew,{size:16}),"Lab Test Inventory"]}),i.jsxs("button",{onClick:()=>e("/dashboard/inventory"),className:`${Jt.viewButton} ${b==="pharmacyInventory"?Jt.viewButtonActive:Jt.viewButtonInactive}`,children:[i.jsx(Uo,{size:16}),"Pharmacy Inventory"]})]}),b==="analysis"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:Jt.dateRangeContainer,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"start-date-inventory",className:Jt.dateInputLabel,children:"Start Date:"}),i.jsx("input",{type:"date",id:"start-date-inventory",value:t,onChange:E=>r(E.target.value),className:Jt.dateInput})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"end-date-inventory",className:Jt.dateInputLabel,children:"End Date:"}),i.jsx("input",{type:"date",id:"end-date-inventory",value:a,onChange:E=>l(E.target.value),className:Jt.dateInput})]}),i.jsx("button",{onClick:k,disabled:u,className:Jt.fetchButton,children:u?"Loading...":"Fetch Comprehensive Analysis"})]}),h&&i.jsxs("div",{className:`${Jt.alertBox} ${Jt.alertBoxError}`,role:"alert",children:[i.jsx("div",{className:Jt.alertBoxIcon,children:i.jsx(si,{size:18})}),i.jsxs("div",{children:[" ",i.jsxs("span",{children:["Error: ",h]})]})]}),u&&i.jsxs("div",{className:Jt.loadingContainer,children:[" ",i.jsx("p",{children:"Loading data..."})]}),o&&!u&&i.jsxs("div",{className:"space-y-6",children:[" ",i.jsxs("div",{children:[i.jsxs("h3",{className:Jt.sectionTitle,children:["Pharmacy Inventory Changes (",o.startDate," to ",o.endDate,")"]}),o.pharmacyAnalysis.length>0?i.jsx("div",{className:Jt.tableContainer,children:i.jsxs("table",{className:Jt.analysisTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Drug Name"}),i.jsx("th",{children:"Unit"}),i.jsx("th",{className:Jt.textRight,children:"Price"}),i.jsx("th",{children:"Qty In (+)"}),i.jsx("th",{className:Jt.textRight,children:"Packs Out (-)"}),i.jsx("th",{className:Jt.textRight,children:"Loose Qty Out (-)"}),i.jsx("th",{className:Jt.textRight,children:"Packs Converted"})]})}),i.jsx("tbody",{children:o.pharmacyAnalysis.map(E=>i.jsxs("tr",{children:[i.jsx("td",{children:E.name}),i.jsx("td",{children:E.unit||"N/A"}),i.jsx("td",{className:Jt.textRight,children:T(E.price)}),i.jsxs("td",{className:Jt.textGreen,children:[" ",i.jsxs("div",{className:Jt.reasonDistribution,children:[Object.entries(E.quantity_in_by_reason).map(([P,I])=>i.jsxs("div",{children:[i.jsxs("span",{children:[P,":"]}),i.jsx("span",{children:I})]},P)),Object.keys(E.quantity_in_by_reason).length>0&&i.jsxs("div",{className:Jt.totalRow,children:[i.jsx("span",{children:"Total:"}),i.jsx("span",{children:E.quantity_in})]})]})]}),i.jsxs("td",{className:Jt.textRed,children:[" ",i.jsxs("div",{className:Jt.reasonDistribution,children:[Object.entries(E.quantity_out_by_reason||{}).map(([P,I])=>i.jsxs("div",{children:[i.jsxs("span",{children:[P,":"]}),i.jsx("span",{children:I})]},P)),Object.keys(E.quantity_out_by_reason||{}).length>0&&i.jsxs("div",{className:Jt.totalRow,children:[i.jsx("span",{children:"Total:"}),i.jsx("span",{children:E.quantity_out})]}),(!E.quantity_out_by_reason||Object.keys(E.quantity_out_by_reason).length===0)&&i.jsx("div",{className:Jt.textRight,children:E.quantity_out})]})]}),i.jsx("td",{className:`${Jt.textRed} ${Jt.textRight}`,children:E.loose_quantity_out}),i.jsx("td",{className:`${Jt.textOrange} ${Jt.textRight}`,children:E.quantity_converted})]},E.drug_id))})]})}):i.jsx("p",{className:"text-gray-500",children:"No pharmacy inventory changes found for the selected period."})]})]})]}),b==="labInventory"&&i.jsxs("div",{className:"mt-4",children:[" ",i.jsx(tw,{})]}),b==="pharmacyInventory"&&i.jsxs("div",{className:"mt-4",children:[" ",i.jsx(H_,{})]})]})};var Gv,DN;function BR(){if(DN)return Gv;DN=1;var e="Expected a function",n=NaN,t="[object Symbol]",r=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,o=/^0o[0-7]+$/i,f=parseInt,u=typeof Xc=="object"&&Xc&&Xc.Object===Object&&Xc,d=typeof self=="object"&&self&&self.Object===Object&&self,h=u||d||Function("return this")(),g=Object.prototype,b=g.toString,v=Math.max,S=Math.min,k=function(){return h.Date.now()};function T(F,O,B){var U,z,$,R,H,ee,Z=0,te=!1,Q=!1,q=!0;if(typeof F!="function")throw new TypeError(e);O=V(O)||0,E(B)&&(te=!!B.leading,Q="maxWait"in B,$=Q?v(V(B.maxWait)||0,O):$,q="trailing"in B?!!B.trailing:q);function W(xe){var ue=U,ze=z;return U=z=void 0,Z=xe,R=F.apply(ze,ue),R}function ne(xe){return Z=xe,H=setTimeout(se,O),te?W(xe):R}function A(xe){var ue=xe-ee,ze=xe-Z,tt=O-ue;return Q?S(tt,$-ze):tt}function ie(xe){var ue=xe-ee,ze=xe-Z;return ee===void 0||ue>=O||ue<0||Q&&ze>=$}function se(){var xe=k();if(ie(xe))return M(xe);H=setTimeout(se,A(xe))}function M(xe){return H=void 0,q&&U?W(xe):(U=z=void 0,R)}function ce(){H!==void 0&&clearTimeout(H),Z=0,U=ee=z=H=void 0}function ve(){return H===void 0?R:M(k())}function le(){var xe=k(),ue=ie(xe);if(U=arguments,z=this,ee=xe,ue){if(H===void 0)return ne(ee);if(Q)return H=setTimeout(se,O),W(ee)}return H===void 0&&(H=setTimeout(se,O)),R}return le.cancel=ce,le.flush=ve,le}function E(F){var O=typeof F;return!!F&&(O=="object"||O=="function")}function P(F){return!!F&&typeof F=="object"}function I(F){return typeof F=="symbol"||P(F)&&b.call(F)==t}function V(F){if(typeof F=="number")return F;if(I(F))return n;if(E(F)){var O=typeof F.valueOf=="function"?F.valueOf():F;F=E(O)?O+"":O}if(typeof F!="string")return F===0?F:+F;F=F.replace(r,"");var B=l.test(F);return B||o.test(F)?f(F.slice(2),B?2:8):a.test(F)?n:+F}return Gv=T,Gv}var UR=BR();const kb=Gd(UR),nw=async()=>{const e=await fe("/api/clinic-subscriptions/plans",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription plans")}return e.json()},qR=async e=>{const n=await fe(`/api/clinic-subscriptions/cancel/${e}`,{method:"PUT"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to cancel clinic subscription")}return n.json()},VR=async e=>{const n=await fe(`/api/clinics/${e}/subscription-status`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||`Failed to fetch subscription status for clinic ${e}`)}return n.json()},HR=async e=>{const n=await fe(`/api/clinic-subscriptions/plans/${e}`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to fetch clinic subscription plan")}return n.json()},GR=async e=>{const n=await fe("/api/clinic-subscriptions/plans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to create clinic subscription plan")}return n.json()},YR=async(e,n)=>{const t=await fe(`/api/clinic-subscriptions/plans/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Failed to update clinic subscription plan")}return t.json()},WR=async e=>{const n=await fe(`/api/clinic-subscriptions/plans/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to deactivate clinic subscription plan")}return n.json()},QR=async e=>{const n=await fe("/api/clinic-subscriptions/initiate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:e})});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to initiate clinic subscription")}return n.json()},JR=async()=>{try{const e=await fe("/api/clinic-subscriptions/pending",{method:"GET"});return e.ok?e.json():null}catch(e){return console.error("Error checking for pending subscription:",e),null}},G_=async()=>{const e=await fe("/api/clinics/subscription-status",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription status")}return e.json()};var Yv={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var PN;function KR(){return PN||(PN=1,function(e){(function(){var n={}.hasOwnProperty;function t(){for(var l="",o=0;o<arguments.length;o++){var f=arguments[o];f&&(l=a(l,r(f)))}return l}function r(l){if(typeof l=="string"||typeof l=="number")return l;if(typeof l!="object")return"";if(Array.isArray(l))return t.apply(null,l);if(l.toString!==Object.prototype.toString&&!l.toString.toString().includes("[native code]"))return l.toString();var o="";for(var f in l)n.call(l,f)&&l[f]&&(o=a(o,f));return o}function a(l,o){return o?l?l+" "+o:l+o:l}e.exports?(t.default=t,e.exports=t):window.classNames=t})()}(Yv)),Yv.exports}var XR=KR();const Zc=Gd(XR);function qd(e){"@babel/helpers - typeof";return qd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},qd(e)}function ZR(e,n){if(qd(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(qd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Y_(e){var n=ZR(e,"string");return qd(n)=="symbol"?n:n+""}function Vm(e,n,t){return(n=Y_(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function IN(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function Dt(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?IN(Object(t),!0).forEach(function(r){Vm(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):IN(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function e3(e){if(Array.isArray(e))return e}function t3(e,n){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var r,a,l,o,f=[],u=!0,d=!1;try{if(l=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;u=!1}else for(;!(u=(r=l.call(t)).done)&&(f.push(r.value),f.length!==n);u=!0);}catch(h){d=!0,a=h}finally{try{if(!u&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(d)throw a}}return f}}function W0(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function W_(e,n){if(e){if(typeof e=="string")return W0(e,n);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?W0(e,n):void 0}}function n3(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zo(e,n){return e3(e)||t3(e,n)||W_(e,n)||n3()}function i3(e,n){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(n.indexOf(r)!==-1)continue;t[r]=e[r]}return t}function Ho(e,n){if(e==null)return{};var t,r,a=i3(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var r3=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function a3(e){var n=e.defaultInputValue,t=n===void 0?"":n,r=e.defaultMenuIsOpen,a=r===void 0?!1:r,l=e.defaultValue,o=l===void 0?null:l,f=e.inputValue,u=e.menuIsOpen,d=e.onChange,h=e.onInputChange,g=e.onMenuClose,b=e.onMenuOpen,v=e.value,S=Ho(e,r3),k=w.useState(f!==void 0?f:t),T=zo(k,2),E=T[0],P=T[1],I=w.useState(u!==void 0?u:a),V=zo(I,2),F=V[0],O=V[1],B=w.useState(v!==void 0?v:o),U=zo(B,2),z=U[0],$=U[1],R=w.useCallback(function(W,ne){typeof d=="function"&&d(W,ne),$(W)},[d]),H=w.useCallback(function(W,ne){var A;typeof h=="function"&&(A=h(W,ne)),P(A!==void 0?A:W)},[h]),ee=w.useCallback(function(){typeof b=="function"&&b(),O(!0)},[b]),Z=w.useCallback(function(){typeof g=="function"&&g(),O(!1)},[g]),te=f!==void 0?f:E,Q=u!==void 0?u:F,q=v!==void 0?v:z;return Dt(Dt({},S),{},{inputValue:te,menuIsOpen:Q,onChange:R,onInputChange:H,onMenuClose:Z,onMenuOpen:ee,value:q})}function Lt(){return Lt=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Lt.apply(null,arguments)}function s3(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function MN(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Y_(r.key),r)}}function l3(e,n,t){return n&&MN(e.prototype,n),t&&MN(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Q0(e,n){return Q0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Q0(e,n)}function o3(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&Q0(e,n)}function ib(e){return ib=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ib(e)}function Q_(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Q_=function(){return!!e})()}function c3(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u3(e,n){if(n&&(qd(n)=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c3(e)}function d3(e){var n=Q_();return function(){var t,r=ib(e);if(n){var a=ib(this).constructor;t=Reflect.construct(r,arguments,a)}else t=r.apply(this,arguments);return u3(this,t)}}function f3(e){if(Array.isArray(e))return W0(e)}function h3(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function p3(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iw(e){return f3(e)||h3(e)||W_(e)||p3()}function m3(e){if(e.sheet)return e.sheet;for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].ownerNode===e)return document.styleSheets[n]}function g3(e){var n=document.createElement("style");return n.setAttribute("data-emotion",e.key),e.nonce!==void 0&&n.setAttribute("nonce",e.nonce),n.appendChild(document.createTextNode("")),n.setAttribute("data-s",""),n}var y3=function(){function e(t){var r=this;this._insertTag=function(a){var l;r.tags.length===0?r.insertionPoint?l=r.insertionPoint.nextSibling:r.prepend?l=r.container.firstChild:l=r.before:l=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(a,l),r.tags.push(a)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var n=e.prototype;return n.hydrate=function(r){r.forEach(this._insertTag)},n.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(g3(this));var a=this.tags[this.tags.length-1];if(this.isSpeedy){var l=m3(a);try{l.insertRule(r,l.cssRules.length)}catch{}}else a.appendChild(document.createTextNode(r));this.ctr++},n.flush=function(){this.tags.forEach(function(r){var a;return(a=r.parentNode)==null?void 0:a.removeChild(r)}),this.tags=[],this.ctr=0},e}(),Dr="-ms-",rb="-moz-",En="-webkit-",J_="comm",rw="rule",aw="decl",x3="@import",K_="@keyframes",b3="@layer",v3=Math.abs,Eb=String.fromCharCode,w3=Object.assign;function N3(e,n){return mr(e,0)^45?(((n<<2^mr(e,0))<<2^mr(e,1))<<2^mr(e,2))<<2^mr(e,3):0}function X_(e){return e.trim()}function S3(e,n){return(e=n.exec(e))?e[0]:e}function Tn(e,n,t){return e.replace(n,t)}function J0(e,n){return e.indexOf(n)}function mr(e,n){return e.charCodeAt(n)|0}function ng(e,n,t){return e.slice(n,t)}function zl(e){return e.length}function sw(e){return e.length}function yx(e,n){return n.push(e),e}function j3(e,n){return e.map(n).join("")}var Tb=1,Uh=1,Z_=0,ga=0,Vi=0,Jh="";function Ab(e,n,t,r,a,l,o){return{value:e,root:n,parent:t,type:r,props:a,children:l,line:Tb,column:Uh,length:o,return:""}}function Mm(e,n){return w3(Ab("",null,null,"",null,null,0),e,{length:-e.length},n)}function C3(){return Vi}function _3(){return Vi=ga>0?mr(Jh,--ga):0,Uh--,Vi===10&&(Uh=1,Tb--),Vi}function za(){return Vi=ga<Z_?mr(Jh,ga++):0,Uh++,Vi===10&&(Uh=1,Tb++),Vi}function Hl(){return mr(Jh,ga)}function zx(){return ga}function fg(e,n){return ng(Jh,e,n)}function ig(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function e2(e){return Tb=Uh=1,Z_=zl(Jh=e),ga=0,[]}function t2(e){return Jh="",e}function Bx(e){return X_(fg(ga-1,K0(e===91?e+2:e===40?e+1:e)))}function k3(e){for(;(Vi=Hl())&&Vi<33;)za();return ig(e)>2||ig(Vi)>3?"":" "}function E3(e,n){for(;--n&&za()&&!(Vi<48||Vi>102||Vi>57&&Vi<65||Vi>70&&Vi<97););return fg(e,zx()+(n<6&&Hl()==32&&za()==32))}function K0(e){for(;za();)switch(Vi){case e:return ga;case 34:case 39:e!==34&&e!==39&&K0(Vi);break;case 40:e===41&&K0(e);break;case 92:za();break}return ga}function T3(e,n){for(;za()&&e+Vi!==57;)if(e+Vi===84&&Hl()===47)break;return"/*"+fg(n,ga-1)+"*"+Eb(e===47?e:za())}function A3(e){for(;!ig(Hl());)za();return fg(e,ga)}function D3(e){return t2(Ux("",null,null,null,[""],e=e2(e),0,[0],e))}function Ux(e,n,t,r,a,l,o,f,u){for(var d=0,h=0,g=o,b=0,v=0,S=0,k=1,T=1,E=1,P=0,I="",V=a,F=l,O=r,B=I;T;)switch(S=P,P=za()){case 40:if(S!=108&&mr(B,g-1)==58){J0(B+=Tn(Bx(P),"&","&\f"),"&\f")!=-1&&(E=-1);break}case 34:case 39:case 91:B+=Bx(P);break;case 9:case 10:case 13:case 32:B+=k3(S);break;case 92:B+=E3(zx()-1,7);continue;case 47:switch(Hl()){case 42:case 47:yx(P3(T3(za(),zx()),n,t),u);break;default:B+="/"}break;case 123*k:f[d++]=zl(B)*E;case 125*k:case 59:case 0:switch(P){case 0:case 125:T=0;case 59+h:E==-1&&(B=Tn(B,/\f/g,"")),v>0&&zl(B)-g&&yx(v>32?LN(B+";",r,t,g-1):LN(Tn(B," ","")+";",r,t,g-2),u);break;case 59:B+=";";default:if(yx(O=RN(B,n,t,d,h,a,f,I,V=[],F=[],g),l),P===123)if(h===0)Ux(B,n,O,O,V,l,g,f,F);else switch(b===99&&mr(B,3)===110?100:b){case 100:case 108:case 109:case 115:Ux(e,O,O,r&&yx(RN(e,O,O,0,0,a,f,I,a,V=[],g),F),a,F,g,f,r?V:F);break;default:Ux(B,O,O,O,[""],F,0,f,F)}}d=h=v=0,k=E=1,I=B="",g=o;break;case 58:g=1+zl(B),v=S;default:if(k<1){if(P==123)--k;else if(P==125&&k++==0&&_3()==125)continue}switch(B+=Eb(P),P*k){case 38:E=h>0?1:(B+="\f",-1);break;case 44:f[d++]=(zl(B)-1)*E,E=1;break;case 64:Hl()===45&&(B+=Bx(za())),b=Hl(),h=g=zl(I=B+=A3(zx())),P++;break;case 45:S===45&&zl(B)==2&&(k=0)}}return l}function RN(e,n,t,r,a,l,o,f,u,d,h){for(var g=a-1,b=a===0?l:[""],v=sw(b),S=0,k=0,T=0;S<r;++S)for(var E=0,P=ng(e,g+1,g=v3(k=o[S])),I=e;E<v;++E)(I=X_(k>0?b[E]+" "+P:Tn(P,/&\f/g,b[E])))&&(u[T++]=I);return Ab(e,n,t,a===0?rw:f,u,d,h)}function P3(e,n,t){return Ab(e,n,t,J_,Eb(C3()),ng(e,2,-2),0)}function LN(e,n,t,r){return Ab(e,n,t,aw,ng(e,0,r),ng(e,r+1,-1),r)}function Ih(e,n){for(var t="",r=sw(e),a=0;a<r;a++)t+=n(e[a],a,e,n)||"";return t}function I3(e,n,t,r){switch(e.type){case b3:if(e.children.length)break;case x3:case aw:return e.return=e.return||e.value;case J_:return"";case K_:return e.return=e.value+"{"+Ih(e.children,r)+"}";case rw:e.value=e.props.join(",")}return zl(t=Ih(e.children,r))?e.return=e.value+"{"+t+"}":""}function M3(e){var n=sw(e);return function(t,r,a,l){for(var o="",f=0;f<n;f++)o+=e[f](t,r,a,l)||"";return o}}function R3(e){return function(n){n.root||(n=n.return)&&e(n)}}function L3(e){var n=Object.create(null);return function(t){return n[t]===void 0&&(n[t]=e(t)),n[t]}}var O3=function(n,t,r){for(var a=0,l=0;a=l,l=Hl(),a===38&&l===12&&(t[r]=1),!ig(l);)za();return fg(n,ga)},F3=function(n,t){var r=-1,a=44;do switch(ig(a)){case 0:a===38&&Hl()===12&&(t[r]=1),n[r]+=O3(ga-1,t,r);break;case 2:n[r]+=Bx(a);break;case 4:if(a===44){n[++r]=Hl()===58?"&\f":"",t[r]=n[r].length;break}default:n[r]+=Eb(a)}while(a=za());return n},$3=function(n,t){return t2(F3(e2(n),t))},ON=new WeakMap,z3=function(n){if(!(n.type!=="rule"||!n.parent||n.length<1)){for(var t=n.value,r=n.parent,a=n.column===r.column&&n.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(n.props.length===1&&t.charCodeAt(0)!==58&&!ON.get(r))&&!a){ON.set(n,!0);for(var l=[],o=$3(t,l),f=r.props,u=0,d=0;u<o.length;u++)for(var h=0;h<f.length;h++,d++)n.props[d]=l[u]?o[u].replace(/&\f/g,f[h]):f[h]+" "+o[u]}}},B3=function(n){if(n.type==="decl"){var t=n.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(n.return="",n.value="")}};function n2(e,n){switch(N3(e,n)){case 5103:return En+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return En+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return En+e+rb+e+Dr+e+e;case 6828:case 4268:return En+e+Dr+e+e;case 6165:return En+e+Dr+"flex-"+e+e;case 5187:return En+e+Tn(e,/(\w+).+(:[^]+)/,En+"box-$1$2"+Dr+"flex-$1$2")+e;case 5443:return En+e+Dr+"flex-item-"+Tn(e,/flex-|-self/,"")+e;case 4675:return En+e+Dr+"flex-line-pack"+Tn(e,/align-content|flex-|-self/,"")+e;case 5548:return En+e+Dr+Tn(e,"shrink","negative")+e;case 5292:return En+e+Dr+Tn(e,"basis","preferred-size")+e;case 6060:return En+"box-"+Tn(e,"-grow","")+En+e+Dr+Tn(e,"grow","positive")+e;case 4554:return En+Tn(e,/([^-])(transform)/g,"$1"+En+"$2")+e;case 6187:return Tn(Tn(Tn(e,/(zoom-|grab)/,En+"$1"),/(image-set)/,En+"$1"),e,"")+e;case 5495:case 3959:return Tn(e,/(image-set\([^]*)/,En+"$1$`$1");case 4968:return Tn(Tn(e,/(.+:)(flex-)?(.*)/,En+"box-pack:$3"+Dr+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+En+e+e;case 4095:case 3583:case 4068:case 2532:return Tn(e,/(.+)-inline(.+)/,En+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(zl(e)-1-n>6)switch(mr(e,n+1)){case 109:if(mr(e,n+4)!==45)break;case 102:return Tn(e,/(.+:)(.+)-([^]+)/,"$1"+En+"$2-$3$1"+rb+(mr(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~J0(e,"stretch")?n2(Tn(e,"stretch","fill-available"),n)+e:e}break;case 4949:if(mr(e,n+1)!==115)break;case 6444:switch(mr(e,zl(e)-3-(~J0(e,"!important")&&10))){case 107:return Tn(e,":",":"+En)+e;case 101:return Tn(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+En+(mr(e,14)===45?"inline-":"")+"box$3$1"+En+"$2$3$1"+Dr+"$2box$3")+e}break;case 5936:switch(mr(e,n+11)){case 114:return En+e+Dr+Tn(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return En+e+Dr+Tn(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return En+e+Dr+Tn(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return En+e+Dr+e+e}return e}var U3=function(n,t,r,a){if(n.length>-1&&!n.return)switch(n.type){case aw:n.return=n2(n.value,n.length);break;case K_:return Ih([Mm(n,{value:Tn(n.value,"@","@"+En)})],a);case rw:if(n.length)return j3(n.props,function(l){switch(S3(l,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Ih([Mm(n,{props:[Tn(l,/:(read-\w+)/,":"+rb+"$1")]})],a);case"::placeholder":return Ih([Mm(n,{props:[Tn(l,/:(plac\w+)/,":"+En+"input-$1")]}),Mm(n,{props:[Tn(l,/:(plac\w+)/,":"+rb+"$1")]}),Mm(n,{props:[Tn(l,/:(plac\w+)/,Dr+"input-$1")]})],a)}return""})}},q3=[U3],V3=function(n){var t=n.key;if(t==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(k){var T=k.getAttribute("data-emotion");T.indexOf(" ")!==-1&&(document.head.appendChild(k),k.setAttribute("data-s",""))})}var a=n.stylisPlugins||q3,l={},o,f=[];o=n.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(k){for(var T=k.getAttribute("data-emotion").split(" "),E=1;E<T.length;E++)l[T[E]]=!0;f.push(k)});var u,d=[z3,B3];{var h,g=[I3,R3(function(k){h.insert(k)})],b=M3(d.concat(a,g)),v=function(T){return Ih(D3(T),b)};u=function(T,E,P,I){h=P,v(T?T+"{"+E.styles+"}":E.styles),I&&(S.inserted[E.name]=!0)}}var S={key:t,sheet:new y3({key:t,container:o,nonce:n.nonce,speedy:n.speedy,prepend:n.prepend,insertionPoint:n.insertionPoint}),nonce:n.nonce,inserted:l,registered:{},insert:u};return S.sheet.hydrate(f),S},Wv={exports:{}},Mn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FN;function H3(){if(FN)return Mn;FN=1;var e=typeof Symbol=="function"&&Symbol.for,n=e?Symbol.for("react.element"):60103,t=e?Symbol.for("react.portal"):60106,r=e?Symbol.for("react.fragment"):60107,a=e?Symbol.for("react.strict_mode"):60108,l=e?Symbol.for("react.profiler"):60114,o=e?Symbol.for("react.provider"):60109,f=e?Symbol.for("react.context"):60110,u=e?Symbol.for("react.async_mode"):60111,d=e?Symbol.for("react.concurrent_mode"):60111,h=e?Symbol.for("react.forward_ref"):60112,g=e?Symbol.for("react.suspense"):60113,b=e?Symbol.for("react.suspense_list"):60120,v=e?Symbol.for("react.memo"):60115,S=e?Symbol.for("react.lazy"):60116,k=e?Symbol.for("react.block"):60121,T=e?Symbol.for("react.fundamental"):60117,E=e?Symbol.for("react.responder"):60118,P=e?Symbol.for("react.scope"):60119;function I(F){if(typeof F=="object"&&F!==null){var O=F.$$typeof;switch(O){case n:switch(F=F.type,F){case u:case d:case r:case l:case a:case g:return F;default:switch(F=F&&F.$$typeof,F){case f:case h:case S:case v:case o:return F;default:return O}}case t:return O}}}function V(F){return I(F)===d}return Mn.AsyncMode=u,Mn.ConcurrentMode=d,Mn.ContextConsumer=f,Mn.ContextProvider=o,Mn.Element=n,Mn.ForwardRef=h,Mn.Fragment=r,Mn.Lazy=S,Mn.Memo=v,Mn.Portal=t,Mn.Profiler=l,Mn.StrictMode=a,Mn.Suspense=g,Mn.isAsyncMode=function(F){return V(F)||I(F)===u},Mn.isConcurrentMode=V,Mn.isContextConsumer=function(F){return I(F)===f},Mn.isContextProvider=function(F){return I(F)===o},Mn.isElement=function(F){return typeof F=="object"&&F!==null&&F.$$typeof===n},Mn.isForwardRef=function(F){return I(F)===h},Mn.isFragment=function(F){return I(F)===r},Mn.isLazy=function(F){return I(F)===S},Mn.isMemo=function(F){return I(F)===v},Mn.isPortal=function(F){return I(F)===t},Mn.isProfiler=function(F){return I(F)===l},Mn.isStrictMode=function(F){return I(F)===a},Mn.isSuspense=function(F){return I(F)===g},Mn.isValidElementType=function(F){return typeof F=="string"||typeof F=="function"||F===r||F===d||F===l||F===a||F===g||F===b||typeof F=="object"&&F!==null&&(F.$$typeof===S||F.$$typeof===v||F.$$typeof===o||F.$$typeof===f||F.$$typeof===h||F.$$typeof===T||F.$$typeof===E||F.$$typeof===P||F.$$typeof===k)},Mn.typeOf=I,Mn}var $N;function G3(){return $N||($N=1,Wv.exports=H3()),Wv.exports}var Qv,zN;function Y3(){if(zN)return Qv;zN=1;var e=G3(),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},t={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},l={};l[e.ForwardRef]=r,l[e.Memo]=a;function o(S){return e.isMemo(S)?a:l[S.$$typeof]||n}var f=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,g=Object.getPrototypeOf,b=Object.prototype;function v(S,k,T){if(typeof k!="string"){if(b){var E=g(k);E&&E!==b&&v(S,E,T)}var P=u(k);d&&(P=P.concat(d(k)));for(var I=o(S),V=o(k),F=0;F<P.length;++F){var O=P[F];if(!t[O]&&!(T&&T[O])&&!(V&&V[O])&&!(I&&I[O])){var B=h(k,O);try{f(S,O,B)}catch{}}}}return S}return Qv=v,Qv}Y3();var W3=!0;function Q3(e,n,t){var r="";return t.split(" ").forEach(function(a){e[a]!==void 0?n.push(e[a]+";"):a&&(r+=a+" ")}),r}var i2=function(n,t,r){var a=n.key+"-"+t.name;(r===!1||W3===!1)&&n.registered[a]===void 0&&(n.registered[a]=t.styles)},J3=function(n,t,r){i2(n,t,r);var a=n.key+"-"+t.name;if(n.inserted[t.name]===void 0){var l=t;do n.insert(t===l?"."+a:"",l,n.sheet,!0),l=l.next;while(l!==void 0)}};function K3(e){for(var n=0,t,r=0,a=e.length;a>=4;++r,a-=4)t=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,n=(t&65535)*1540483477+((t>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(a){case 3:n^=(e.charCodeAt(r+2)&255)<<16;case 2:n^=(e.charCodeAt(r+1)&255)<<8;case 1:n^=e.charCodeAt(r)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}var X3={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Z3=/[A-Z]|^ms/g,eL=/_EMO_([^_]+?)_([^]*?)_EMO_/g,r2=function(n){return n.charCodeAt(1)===45},BN=function(n){return n!=null&&typeof n!="boolean"},Jv=L3(function(e){return r2(e)?e:e.replace(Z3,"-$&").toLowerCase()}),UN=function(n,t){switch(n){case"animation":case"animationName":if(typeof t=="string")return t.replace(eL,function(r,a,l){return Bl={name:a,styles:l,next:Bl},a})}return X3[n]!==1&&!r2(n)&&typeof t=="number"&&t!==0?t+"px":t};function rg(e,n,t){if(t==null)return"";var r=t;if(r.__emotion_styles!==void 0)return r;switch(typeof t){case"boolean":return"";case"object":{var a=t;if(a.anim===1)return Bl={name:a.name,styles:a.styles,next:Bl},a.name;var l=t;if(l.styles!==void 0){var o=l.next;if(o!==void 0)for(;o!==void 0;)Bl={name:o.name,styles:o.styles,next:Bl},o=o.next;var f=l.styles+";";return f}return tL(e,n,t)}case"function":{if(e!==void 0){var u=Bl,d=t(e);return Bl=u,rg(e,n,d)}break}}var h=t;return h}function tL(e,n,t){var r="";if(Array.isArray(t))for(var a=0;a<t.length;a++)r+=rg(e,n,t[a])+";";else for(var l in t){var o=t[l];if(typeof o!="object"){var f=o;BN(f)&&(r+=Jv(l)+":"+UN(l,f)+";")}else if(Array.isArray(o)&&typeof o[0]=="string"&&n==null)for(var u=0;u<o.length;u++)BN(o[u])&&(r+=Jv(l)+":"+UN(l,o[u])+";");else{var d=rg(e,n,o);switch(l){case"animation":case"animationName":{r+=Jv(l)+":"+d+";";break}default:r+=l+"{"+d+"}"}}}return r}var qN=/label:\s*([^\s;{]+)\s*(;|$)/g,Bl;function a2(e,n,t){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var r=!0,a="";Bl=void 0;var l=e[0];if(l==null||l.raw===void 0)r=!1,a+=rg(t,n,l);else{var o=l;a+=o[0]}for(var f=1;f<e.length;f++)if(a+=rg(t,n,e[f]),r){var u=l;a+=u[f]}qN.lastIndex=0;for(var d="",h;(h=qN.exec(a))!==null;)d+="-"+h[1];var g=K3(a)+d;return{name:g,styles:a,next:Bl}}var nL=function(n){return n()},iL=nN.useInsertionEffect?nN.useInsertionEffect:!1,rL=iL||nL,s2=w.createContext(typeof HTMLElement<"u"?V3({key:"css"}):null);s2.Provider;var aL=function(n){return w.forwardRef(function(t,r){var a=w.useContext(s2);return n(t,a,r)})},sL=w.createContext({}),lw={}.hasOwnProperty,X0="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",lL=function(n,t){var r={};for(var a in t)lw.call(t,a)&&(r[a]=t[a]);return r[X0]=n,r},oL=function(n){var t=n.cache,r=n.serialized,a=n.isStringTag;return i2(t,r,a),rL(function(){return J3(t,r,a)}),null},cL=aL(function(e,n,t){var r=e.css;typeof r=="string"&&n.registered[r]!==void 0&&(r=n.registered[r]);var a=e[X0],l=[r],o="";typeof e.className=="string"?o=Q3(n.registered,l,e.className):e.className!=null&&(o=e.className+" ");var f=a2(l,void 0,w.useContext(sL));o+=n.key+"-"+f.name;var u={};for(var d in e)lw.call(e,d)&&d!=="css"&&d!==X0&&(u[d]=e[d]);return u.className=o,t&&(u.ref=t),w.createElement(w.Fragment,null,w.createElement(oL,{cache:n,serialized:f,isStringTag:typeof a=="string"}),w.createElement(a,u))}),uL=cL,jt=function(n,t){var r=arguments;if(t==null||!lw.call(t,"css"))return w.createElement.apply(void 0,r);var a=r.length,l=new Array(a);l[0]=uL,l[1]=lL(n,t);for(var o=2;o<a;o++)l[o]=r[o];return w.createElement.apply(null,l)};(function(e){var n;n||(n=e.JSX||(e.JSX={}))})(jt||(jt={}));function ow(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return a2(n)}function dL(){var e=ow.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function fL(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}const hL=Math.min,pL=Math.max,ab=Math.round,xx=Math.floor,sb=e=>({x:e,y:e});function mL(e){const{x:n,y:t,width:r,height:a}=e;return{width:r,height:a,top:t,left:n,right:n+r,bottom:t+a,x:n,y:t}}function Db(){return typeof window<"u"}function l2(e){return c2(e)?(e.nodeName||"").toLowerCase():"#document"}function qo(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function o2(e){var n;return(n=(c2(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function c2(e){return Db()?e instanceof Node||e instanceof qo(e).Node:!1}function gL(e){return Db()?e instanceof Element||e instanceof qo(e).Element:!1}function cw(e){return Db()?e instanceof HTMLElement||e instanceof qo(e).HTMLElement:!1}function VN(e){return!Db()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof qo(e).ShadowRoot}const yL=new Set(["inline","contents"]);function u2(e){const{overflow:n,overflowX:t,overflowY:r,display:a}=uw(e);return/auto|scroll|overlay|hidden|clip/.test(n+r+t)&&!yL.has(a)}function xL(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const bL=new Set(["html","body","#document"]);function vL(e){return bL.has(l2(e))}function uw(e){return qo(e).getComputedStyle(e)}function wL(e){if(l2(e)==="html")return e;const n=e.assignedSlot||e.parentNode||VN(e)&&e.host||o2(e);return VN(n)?n.host:n}function d2(e){const n=wL(e);return vL(n)?e.ownerDocument?e.ownerDocument.body:e.body:cw(n)&&u2(n)?n:d2(n)}function lb(e,n,t){var r;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=d2(e),l=a===((r=e.ownerDocument)==null?void 0:r.body),o=qo(a);if(l){const f=Z0(o);return n.concat(o,o.visualViewport||[],u2(a)?a:[],f&&t?lb(f):[])}return n.concat(a,lb(a,[],t))}function Z0(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function NL(e){const n=uw(e);let t=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const a=cw(e),l=a?e.offsetWidth:t,o=a?e.offsetHeight:r,f=ab(t)!==l||ab(r)!==o;return f&&(t=l,r=o),{width:t,height:r,$:f}}function dw(e){return gL(e)?e:e.contextElement}function HN(e){const n=dw(e);if(!cw(n))return sb(1);const t=n.getBoundingClientRect(),{width:r,height:a,$:l}=NL(n);let o=(l?ab(t.width):t.width)/r,f=(l?ab(t.height):t.height)/a;return(!o||!Number.isFinite(o))&&(o=1),(!f||!Number.isFinite(f))&&(f=1),{x:o,y:f}}const SL=sb(0);function jL(e){const n=qo(e);return!xL()||!n.visualViewport?SL:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function CL(e,n,t){return!1}function GN(e,n,t,r){n===void 0&&(n=!1);const a=e.getBoundingClientRect(),l=dw(e);let o=sb(1);n&&(o=HN(e));const f=CL()?jL(l):sb(0);let u=(a.left+f.x)/o.x,d=(a.top+f.y)/o.y,h=a.width/o.x,g=a.height/o.y;if(l){const b=qo(l),v=r;let S=b,k=Z0(S);for(;k&&r&&v!==S;){const T=HN(k),E=k.getBoundingClientRect(),P=uw(k),I=E.left+(k.clientLeft+parseFloat(P.paddingLeft))*T.x,V=E.top+(k.clientTop+parseFloat(P.paddingTop))*T.y;u*=T.x,d*=T.y,h*=T.x,g*=T.y,u+=I,d+=V,S=qo(k),k=Z0(S)}}return mL({width:h,height:g,x:u,y:d})}function f2(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function _L(e,n){let t=null,r;const a=o2(e);function l(){var f;clearTimeout(r),(f=t)==null||f.disconnect(),t=null}function o(f,u){f===void 0&&(f=!1),u===void 0&&(u=1),l();const d=e.getBoundingClientRect(),{left:h,top:g,width:b,height:v}=d;if(f||n(),!b||!v)return;const S=xx(g),k=xx(a.clientWidth-(h+b)),T=xx(a.clientHeight-(g+v)),E=xx(h),I={rootMargin:-S+"px "+-k+"px "+-T+"px "+-E+"px",threshold:pL(0,hL(1,u))||1};let V=!0;function F(O){const B=O[0].intersectionRatio;if(B!==u){if(!V)return o();B?o(!1,B):r=setTimeout(()=>{o(!1,1e-7)},1e3)}B===1&&!f2(d,e.getBoundingClientRect())&&o(),V=!1}try{t=new IntersectionObserver(F,{...I,root:a.ownerDocument})}catch{t=new IntersectionObserver(F,I)}t.observe(e)}return o(!0),l}function kL(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:l=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:f=typeof IntersectionObserver=="function",animationFrame:u=!1}=r,d=dw(e),h=a||l?[...d?lb(d):[],...lb(n)]:[];h.forEach(E=>{a&&E.addEventListener("scroll",t,{passive:!0}),l&&E.addEventListener("resize",t)});const g=d&&f?_L(d,t):null;let b=-1,v=null;o&&(v=new ResizeObserver(E=>{let[P]=E;P&&P.target===d&&v&&(v.unobserve(n),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var I;(I=v)==null||I.observe(n)})),t()}),d&&!u&&v.observe(d),v.observe(n));let S,k=u?GN(e):null;u&&T();function T(){const E=GN(e);k&&!f2(k,E)&&t(),k=E,S=requestAnimationFrame(T)}return t(),()=>{var E;h.forEach(P=>{a&&P.removeEventListener("scroll",t),l&&P.removeEventListener("resize",t)}),g==null||g(),(E=v)==null||E.disconnect(),v=null,u&&cancelAnimationFrame(S)}}var e1=w.useLayoutEffect,EL=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],ob=function(){};function TL(e,n){return n?n[0]==="-"?e+n:e+"__"+n:e}function AL(e,n){for(var t=arguments.length,r=new Array(t>2?t-2:0),a=2;a<t;a++)r[a-2]=arguments[a];var l=[].concat(r);if(n&&e)for(var o in n)n.hasOwnProperty(o)&&n[o]&&l.push("".concat(TL(e,o)));return l.filter(function(f){return f}).map(function(f){return String(f).trim()}).join(" ")}var YN=function(n){return $L(n)?n.filter(Boolean):qd(n)==="object"&&n!==null?[n]:[]},h2=function(n){n.className,n.clearValue,n.cx,n.getStyles,n.getClassNames,n.getValue,n.hasValue,n.isMulti,n.isRtl,n.options,n.selectOption,n.selectProps,n.setValue,n.theme;var t=Ho(n,EL);return Dt({},t)},ki=function(n,t,r){var a=n.cx,l=n.getStyles,o=n.getClassNames,f=n.className;return{css:l(t,n),className:a(r??{},o(t,n),f)}};function Pb(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function DL(e){return Pb(e)?window.innerHeight:e.clientHeight}function p2(e){return Pb(e)?window.pageYOffset:e.scrollTop}function cb(e,n){if(Pb(e)){window.scrollTo(0,n);return}e.scrollTop=n}function PL(e){var n=getComputedStyle(e),t=n.position==="absolute",r=/(auto|scroll)/;if(n.position==="fixed")return document.documentElement;for(var a=e;a=a.parentElement;)if(n=getComputedStyle(a),!(t&&n.position==="static")&&r.test(n.overflow+n.overflowY+n.overflowX))return a;return document.documentElement}function IL(e,n,t,r){return t*((e=e/r-1)*e*e+1)+n}function bx(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ob,a=p2(e),l=n-a,o=10,f=0;function u(){f+=o;var d=IL(f,a,l,t);cb(e,d),f<t?window.requestAnimationFrame(u):r(e)}u()}function WN(e,n){var t=e.getBoundingClientRect(),r=n.getBoundingClientRect(),a=n.offsetHeight/3;r.bottom+a>t.bottom?cb(e,Math.min(n.offsetTop+n.clientHeight-e.offsetHeight+a,e.scrollHeight)):r.top-a<t.top&&cb(e,Math.max(n.offsetTop-a,0))}function ML(e){var n=e.getBoundingClientRect();return{bottom:n.bottom,height:n.height,left:n.left,right:n.right,top:n.top,width:n.width}}function QN(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function RL(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var m2=!1,LL={get passive(){return m2=!0}},vx=typeof window<"u"?window:{};vx.addEventListener&&vx.removeEventListener&&(vx.addEventListener("p",ob,LL),vx.removeEventListener("p",ob,!1));var OL=m2;function FL(e){return e!=null}function $L(e){return Array.isArray(e)}function wx(e,n,t){return e?n:t}var zL=function(n){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];var l=Object.entries(n).filter(function(o){var f=zo(o,1),u=f[0];return!r.includes(u)});return l.reduce(function(o,f){var u=zo(f,2),d=u[0],h=u[1];return o[d]=h,o},{})},BL=["children","innerProps"],UL=["children","innerProps"];function qL(e){var n=e.maxHeight,t=e.menuEl,r=e.minHeight,a=e.placement,l=e.shouldScroll,o=e.isFixedPosition,f=e.controlHeight,u=PL(t),d={placement:"bottom",maxHeight:n};if(!t||!t.offsetParent)return d;var h=u.getBoundingClientRect(),g=h.height,b=t.getBoundingClientRect(),v=b.bottom,S=b.height,k=b.top,T=t.offsetParent.getBoundingClientRect(),E=T.top,P=o?window.innerHeight:DL(u),I=p2(u),V=parseInt(getComputedStyle(t).marginBottom,10),F=parseInt(getComputedStyle(t).marginTop,10),O=E-F,B=P-k,U=O+I,z=g-I-k,$=v-P+I+V,R=I+k-F,H=160;switch(a){case"auto":case"bottom":if(B>=S)return{placement:"bottom",maxHeight:n};if(z>=S&&!o)return l&&bx(u,$,H),{placement:"bottom",maxHeight:n};if(!o&&z>=r||o&&B>=r){l&&bx(u,$,H);var ee=o?B-V:z-V;return{placement:"bottom",maxHeight:ee}}if(a==="auto"||o){var Z=n,te=o?O:U;return te>=r&&(Z=Math.min(te-V-f,n)),{placement:"top",maxHeight:Z}}if(a==="bottom")return l&&cb(u,$),{placement:"bottom",maxHeight:n};break;case"top":if(O>=S)return{placement:"top",maxHeight:n};if(U>=S&&!o)return l&&bx(u,R,H),{placement:"top",maxHeight:n};if(!o&&U>=r||o&&O>=r){var Q=n;return(!o&&U>=r||o&&O>=r)&&(Q=o?O-F:U-F),l&&bx(u,R,H),{placement:"top",maxHeight:Q}}return{placement:"bottom",maxHeight:n};default:throw new Error('Invalid placement provided "'.concat(a,'".'))}return d}function VL(e){var n={bottom:"top",top:"bottom"};return e?n[e]:"bottom"}var g2=function(n){return n==="auto"?"bottom":n},HL=function(n,t){var r,a=n.placement,l=n.theme,o=l.borderRadius,f=l.spacing,u=l.colors;return Dt((r={label:"menu"},Vm(r,VL(a),"100%"),Vm(r,"position","absolute"),Vm(r,"width","100%"),Vm(r,"zIndex",1),r),t?{}:{backgroundColor:u.neutral0,borderRadius:o,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:f.menuGutter,marginTop:f.menuGutter})},y2=w.createContext(null),GL=function(n){var t=n.children,r=n.minMenuHeight,a=n.maxMenuHeight,l=n.menuPlacement,o=n.menuPosition,f=n.menuShouldScrollIntoView,u=n.theme,d=w.useContext(y2)||{},h=d.setPortalPlacement,g=w.useRef(null),b=w.useState(a),v=zo(b,2),S=v[0],k=v[1],T=w.useState(null),E=zo(T,2),P=E[0],I=E[1],V=u.spacing.controlHeight;return e1(function(){var F=g.current;if(F){var O=o==="fixed",B=f&&!O,U=qL({maxHeight:a,menuEl:F,minHeight:r,placement:l,shouldScroll:B,isFixedPosition:O,controlHeight:V});k(U.maxHeight),I(U.placement),h==null||h(U.placement)}},[a,l,o,f,r,h,V]),t({ref:g,placerProps:Dt(Dt({},n),{},{placement:P||g2(l),maxHeight:S})})},YL=function(n){var t=n.children,r=n.innerRef,a=n.innerProps;return jt("div",Lt({},ki(n,"menu",{menu:!0}),{ref:r},a),t)},WL=YL,QL=function(n,t){var r=n.maxHeight,a=n.theme.spacing.baseUnit;return Dt({maxHeight:r,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},t?{}:{paddingBottom:a,paddingTop:a})},JL=function(n){var t=n.children,r=n.innerProps,a=n.innerRef,l=n.isMulti;return jt("div",Lt({},ki(n,"menuList",{"menu-list":!0,"menu-list--is-multi":l}),{ref:a},r),t)},x2=function(n,t){var r=n.theme,a=r.spacing.baseUnit,l=r.colors;return Dt({textAlign:"center"},t?{}:{color:l.neutral40,padding:"".concat(a*2,"px ").concat(a*3,"px")})},KL=x2,XL=x2,ZL=function(n){var t=n.children,r=t===void 0?"No options":t,a=n.innerProps,l=Ho(n,BL);return jt("div",Lt({},ki(Dt(Dt({},l),{},{children:r,innerProps:a}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),a),r)},eO=function(n){var t=n.children,r=t===void 0?"Loading...":t,a=n.innerProps,l=Ho(n,UL);return jt("div",Lt({},ki(Dt(Dt({},l),{},{children:r,innerProps:a}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),a),r)},tO=function(n){var t=n.rect,r=n.offset,a=n.position;return{left:t.left,position:a,top:r,width:t.width,zIndex:1}},nO=function(n){var t=n.appendTo,r=n.children,a=n.controlElement,l=n.innerProps,o=n.menuPlacement,f=n.menuPosition,u=w.useRef(null),d=w.useRef(null),h=w.useState(g2(o)),g=zo(h,2),b=g[0],v=g[1],S=w.useMemo(function(){return{setPortalPlacement:v}},[]),k=w.useState(null),T=zo(k,2),E=T[0],P=T[1],I=w.useCallback(function(){if(a){var B=ML(a),U=f==="fixed"?0:window.pageYOffset,z=B[b]+U;(z!==(E==null?void 0:E.offset)||B.left!==(E==null?void 0:E.rect.left)||B.width!==(E==null?void 0:E.rect.width))&&P({offset:z,rect:B})}},[a,f,b,E==null?void 0:E.offset,E==null?void 0:E.rect.left,E==null?void 0:E.rect.width]);e1(function(){I()},[I]);var V=w.useCallback(function(){typeof d.current=="function"&&(d.current(),d.current=null),a&&u.current&&(d.current=kL(a,u.current,I,{elementResize:"ResizeObserver"in window}))},[a,I]);e1(function(){V()},[V]);var F=w.useCallback(function(B){u.current=B,V()},[V]);if(!t&&f!=="fixed"||!E)return null;var O=jt("div",Lt({ref:F},ki(Dt(Dt({},n),{},{offset:E.offset,position:f,rect:E.rect}),"menuPortal",{"menu-portal":!0}),l),r);return jt(y2.Provider,{value:S},t?VD.createPortal(O,t):O)},iO=function(n){var t=n.isDisabled,r=n.isRtl;return{label:"container",direction:r?"rtl":void 0,pointerEvents:t?"none":void 0,position:"relative"}},rO=function(n){var t=n.children,r=n.innerProps,a=n.isDisabled,l=n.isRtl;return jt("div",Lt({},ki(n,"container",{"--is-disabled":a,"--is-rtl":l}),r),t)},aO=function(n,t){var r=n.theme.spacing,a=n.isMulti,l=n.hasValue,o=n.selectProps.controlShouldRenderValue;return Dt({alignItems:"center",display:a&&l&&o?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},t?{}:{padding:"".concat(r.baseUnit/2,"px ").concat(r.baseUnit*2,"px")})},sO=function(n){var t=n.children,r=n.innerProps,a=n.isMulti,l=n.hasValue;return jt("div",Lt({},ki(n,"valueContainer",{"value-container":!0,"value-container--is-multi":a,"value-container--has-value":l}),r),t)},lO=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},oO=function(n){var t=n.children,r=n.innerProps;return jt("div",Lt({},ki(n,"indicatorsContainer",{indicators:!0}),r),t)},JN,cO=["size"],uO=["innerProps","isRtl","size"],dO={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},b2=function(n){var t=n.size,r=Ho(n,cO);return jt("svg",Lt({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:dO},r))},fw=function(n){return jt(b2,Lt({size:20},n),jt("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},v2=function(n){return jt(b2,Lt({size:20},n),jt("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},w2=function(n,t){var r=n.isFocused,a=n.theme,l=a.spacing.baseUnit,o=a.colors;return Dt({label:"indicatorContainer",display:"flex",transition:"color 150ms"},t?{}:{color:r?o.neutral60:o.neutral20,padding:l*2,":hover":{color:r?o.neutral80:o.neutral40}})},fO=w2,hO=function(n){var t=n.children,r=n.innerProps;return jt("div",Lt({},ki(n,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),r),t||jt(v2,null))},pO=w2,mO=function(n){var t=n.children,r=n.innerProps;return jt("div",Lt({},ki(n,"clearIndicator",{indicator:!0,"clear-indicator":!0}),r),t||jt(fw,null))},gO=function(n,t){var r=n.isDisabled,a=n.theme,l=a.spacing.baseUnit,o=a.colors;return Dt({label:"indicatorSeparator",alignSelf:"stretch",width:1},t?{}:{backgroundColor:r?o.neutral10:o.neutral20,marginBottom:l*2,marginTop:l*2})},yO=function(n){var t=n.innerProps;return jt("span",Lt({},t,ki(n,"indicatorSeparator",{"indicator-separator":!0})))},xO=dL(JN||(JN=fL([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),bO=function(n,t){var r=n.isFocused,a=n.size,l=n.theme,o=l.colors,f=l.spacing.baseUnit;return Dt({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:a,lineHeight:1,marginRight:a,textAlign:"center",verticalAlign:"middle"},t?{}:{color:r?o.neutral60:o.neutral20,padding:f*2})},Kv=function(n){var t=n.delay,r=n.offset;return jt("span",{css:ow({animation:"".concat(xO," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:r?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},vO=function(n){var t=n.innerProps,r=n.isRtl,a=n.size,l=a===void 0?4:a,o=Ho(n,uO);return jt("div",Lt({},ki(Dt(Dt({},o),{},{innerProps:t,isRtl:r,size:l}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),t),jt(Kv,{delay:0,offset:r}),jt(Kv,{delay:160,offset:!0}),jt(Kv,{delay:320,offset:!r}))},wO=function(n,t){var r=n.isDisabled,a=n.isFocused,l=n.theme,o=l.colors,f=l.borderRadius,u=l.spacing;return Dt({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:u.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},t?{}:{backgroundColor:r?o.neutral5:o.neutral0,borderColor:r?o.neutral10:a?o.primary:o.neutral20,borderRadius:f,borderStyle:"solid",borderWidth:1,boxShadow:a?"0 0 0 1px ".concat(o.primary):void 0,"&:hover":{borderColor:a?o.primary:o.neutral30}})},NO=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,l=n.innerRef,o=n.innerProps,f=n.menuIsOpen;return jt("div",Lt({ref:l},ki(n,"control",{control:!0,"control--is-disabled":r,"control--is-focused":a,"control--menu-is-open":f}),o,{"aria-disabled":r||void 0}),t)},SO=NO,jO=["data"],CO=function(n,t){var r=n.theme.spacing;return t?{}:{paddingBottom:r.baseUnit*2,paddingTop:r.baseUnit*2}},_O=function(n){var t=n.children,r=n.cx,a=n.getStyles,l=n.getClassNames,o=n.Heading,f=n.headingProps,u=n.innerProps,d=n.label,h=n.theme,g=n.selectProps;return jt("div",Lt({},ki(n,"group",{group:!0}),u),jt(o,Lt({},f,{selectProps:g,theme:h,getStyles:a,getClassNames:l,cx:r}),d),jt("div",null,t))},kO=function(n,t){var r=n.theme,a=r.colors,l=r.spacing;return Dt({label:"group",cursor:"default",display:"block"},t?{}:{color:a.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:l.baseUnit*3,paddingRight:l.baseUnit*3,textTransform:"uppercase"})},EO=function(n){var t=h2(n);t.data;var r=Ho(t,jO);return jt("div",Lt({},ki(n,"groupHeading",{"group-heading":!0}),r))},TO=_O,AO=["innerRef","isDisabled","isHidden","inputClassName"],DO=function(n,t){var r=n.isDisabled,a=n.value,l=n.theme,o=l.spacing,f=l.colors;return Dt(Dt({visibility:r?"hidden":"visible",transform:a?"translateZ(0)":""},PO),t?{}:{margin:o.baseUnit/2,paddingBottom:o.baseUnit/2,paddingTop:o.baseUnit/2,color:f.neutral80})},N2={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},PO={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Dt({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},N2)},IO=function(n){return Dt({label:"input",color:"inherit",background:0,opacity:n?0:1,width:"100%"},N2)},MO=function(n){var t=n.cx,r=n.value,a=h2(n),l=a.innerRef,o=a.isDisabled,f=a.isHidden,u=a.inputClassName,d=Ho(a,AO);return jt("div",Lt({},ki(n,"input",{"input-container":!0}),{"data-value":r||""}),jt("input",Lt({className:t({input:!0},u),ref:l,style:IO(f),disabled:o},d)))},RO=MO,LO=function(n,t){var r=n.theme,a=r.spacing,l=r.borderRadius,o=r.colors;return Dt({label:"multiValue",display:"flex",minWidth:0},t?{}:{backgroundColor:o.neutral10,borderRadius:l/2,margin:a.baseUnit/2})},OO=function(n,t){var r=n.theme,a=r.borderRadius,l=r.colors,o=n.cropWithEllipsis;return Dt({overflow:"hidden",textOverflow:o||o===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},t?{}:{borderRadius:a/2,color:l.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},FO=function(n,t){var r=n.theme,a=r.spacing,l=r.borderRadius,o=r.colors,f=n.isFocused;return Dt({alignItems:"center",display:"flex"},t?{}:{borderRadius:l/2,backgroundColor:f?o.dangerLight:void 0,paddingLeft:a.baseUnit,paddingRight:a.baseUnit,":hover":{backgroundColor:o.dangerLight,color:o.danger}})},S2=function(n){var t=n.children,r=n.innerProps;return jt("div",r,t)},$O=S2,zO=S2;function BO(e){var n=e.children,t=e.innerProps;return jt("div",Lt({role:"button"},t),n||jt(fw,{size:14}))}var UO=function(n){var t=n.children,r=n.components,a=n.data,l=n.innerProps,o=n.isDisabled,f=n.removeProps,u=n.selectProps,d=r.Container,h=r.Label,g=r.Remove;return jt(d,{data:a,innerProps:Dt(Dt({},ki(n,"multiValue",{"multi-value":!0,"multi-value--is-disabled":o})),l),selectProps:u},jt(h,{data:a,innerProps:Dt({},ki(n,"multiValueLabel",{"multi-value__label":!0})),selectProps:u},t),jt(g,{data:a,innerProps:Dt(Dt({},ki(n,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(t||"option")},f),selectProps:u}))},qO=UO,VO=function(n,t){var r=n.isDisabled,a=n.isFocused,l=n.isSelected,o=n.theme,f=o.spacing,u=o.colors;return Dt({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},t?{}:{backgroundColor:l?u.primary:a?u.primary25:"transparent",color:r?u.neutral20:l?u.neutral0:"inherit",padding:"".concat(f.baseUnit*2,"px ").concat(f.baseUnit*3,"px"),":active":{backgroundColor:r?void 0:l?u.primary:u.primary50}})},HO=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,l=n.isSelected,o=n.innerRef,f=n.innerProps;return jt("div",Lt({},ki(n,"option",{option:!0,"option--is-disabled":r,"option--is-focused":a,"option--is-selected":l}),{ref:o,"aria-disabled":r},f),t)},GO=HO,YO=function(n,t){var r=n.theme,a=r.spacing,l=r.colors;return Dt({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},t?{}:{color:l.neutral50,marginLeft:a.baseUnit/2,marginRight:a.baseUnit/2})},WO=function(n){var t=n.children,r=n.innerProps;return jt("div",Lt({},ki(n,"placeholder",{placeholder:!0}),r),t)},QO=WO,JO=function(n,t){var r=n.isDisabled,a=n.theme,l=a.spacing,o=a.colors;return Dt({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t?{}:{color:r?o.neutral40:o.neutral80,marginLeft:l.baseUnit/2,marginRight:l.baseUnit/2})},KO=function(n){var t=n.children,r=n.isDisabled,a=n.innerProps;return jt("div",Lt({},ki(n,"singleValue",{"single-value":!0,"single-value--is-disabled":r}),a),t)},XO=KO,ZO={ClearIndicator:mO,Control:SO,DropdownIndicator:hO,DownChevron:v2,CrossIcon:fw,Group:TO,GroupHeading:EO,IndicatorsContainer:oO,IndicatorSeparator:yO,Input:RO,LoadingIndicator:vO,Menu:WL,MenuList:JL,MenuPortal:nO,LoadingMessage:eO,NoOptionsMessage:ZL,MultiValue:qO,MultiValueContainer:$O,MultiValueLabel:zO,MultiValueRemove:BO,Option:GO,Placeholder:QO,SelectContainer:rO,SingleValue:XO,ValueContainer:sO},eF=function(n){return Dt(Dt({},ZO),n.components)},KN=Number.isNaN||function(n){return typeof n=="number"&&n!==n};function tF(e,n){return!!(e===n||KN(e)&&KN(n))}function nF(e,n){if(e.length!==n.length)return!1;for(var t=0;t<e.length;t++)if(!tF(e[t],n[t]))return!1;return!0}function iF(e,n){n===void 0&&(n=nF);var t=null;function r(){for(var a=[],l=0;l<arguments.length;l++)a[l]=arguments[l];if(t&&t.lastThis===this&&n(a,t.lastArgs))return t.lastResult;var o=e.apply(this,a);return t={lastResult:o,lastArgs:a,lastThis:this},o}return r.clear=function(){t=null},r}var rF={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},aF=function(n){return jt("span",Lt({css:rF},n))},XN=aF,sF={guidance:function(n){var t=n.isSearchable,r=n.isMulti,a=n.tabSelectsValue,l=n.context,o=n.isInitialFocus;switch(l){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(a?", press Tab to select the option and exit the menu":"",".");case"input":return o?"".concat(n["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(r?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(n){var t=n.action,r=n.label,a=r===void 0?"":r,l=n.labels,o=n.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(a,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(l.length>1?"s":""," ").concat(l.join(","),", selected.");case"select-option":return o?"option ".concat(a," is disabled. Select another option."):"option ".concat(a,", selected.");default:return""}},onFocus:function(n){var t=n.context,r=n.focused,a=n.options,l=n.label,o=l===void 0?"":l,f=n.selectValue,u=n.isDisabled,d=n.isSelected,h=n.isAppleDevice,g=function(k,T){return k&&k.length?"".concat(k.indexOf(T)+1," of ").concat(k.length):""};if(t==="value"&&f)return"value ".concat(o," focused, ").concat(g(f,r),".");if(t==="menu"&&h){var b=u?" disabled":"",v="".concat(d?" selected":"").concat(b);return"".concat(o).concat(v,", ").concat(g(a,r),".")}return""},onFilter:function(n){var t=n.inputValue,r=n.resultsMessage;return"".concat(r).concat(t?" for search term "+t:"",".")}},lF=function(n){var t=n.ariaSelection,r=n.focusedOption,a=n.focusedValue,l=n.focusableOptions,o=n.isFocused,f=n.selectValue,u=n.selectProps,d=n.id,h=n.isAppleDevice,g=u.ariaLiveMessages,b=u.getOptionLabel,v=u.inputValue,S=u.isMulti,k=u.isOptionDisabled,T=u.isSearchable,E=u.menuIsOpen,P=u.options,I=u.screenReaderStatus,V=u.tabSelectsValue,F=u.isLoading,O=u["aria-label"],B=u["aria-live"],U=w.useMemo(function(){return Dt(Dt({},sF),g||{})},[g]),z=w.useMemo(function(){var te="";if(t&&U.onChange){var Q=t.option,q=t.options,W=t.removedValue,ne=t.removedValues,A=t.value,ie=function(ue){return Array.isArray(ue)?null:ue},se=W||Q||ie(A),M=se?b(se):"",ce=q||ne||void 0,ve=ce?ce.map(b):[],le=Dt({isDisabled:se&&k(se,f),label:M,labels:ve},t);te=U.onChange(le)}return te},[t,U,k,f,b]),$=w.useMemo(function(){var te="",Q=r||a,q=!!(r&&f&&f.includes(r));if(Q&&U.onFocus){var W={focused:Q,label:b(Q),isDisabled:k(Q,f),isSelected:q,options:l,context:Q===r?"menu":"value",selectValue:f,isAppleDevice:h};te=U.onFocus(W)}return te},[r,a,b,k,U,l,f,h]),R=w.useMemo(function(){var te="";if(E&&P.length&&!F&&U.onFilter){var Q=I({count:l.length});te=U.onFilter({inputValue:v,resultsMessage:Q})}return te},[l,v,E,U,P,I,F]),H=(t==null?void 0:t.action)==="initial-input-focus",ee=w.useMemo(function(){var te="";if(U.guidance){var Q=a?"value":E?"menu":"input";te=U.guidance({"aria-label":O,context:Q,isDisabled:r&&k(r,f),isMulti:S,isSearchable:T,tabSelectsValue:V,isInitialFocus:H})}return te},[O,r,a,S,k,T,E,U,f,V,H]),Z=jt(w.Fragment,null,jt("span",{id:"aria-selection"},z),jt("span",{id:"aria-focused"},$),jt("span",{id:"aria-results"},R),jt("span",{id:"aria-guidance"},ee));return jt(w.Fragment,null,jt(XN,{id:d},H&&Z),jt(XN,{"aria-live":B,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},o&&!H&&Z))},oF=lF,t1=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],cF=new RegExp("["+t1.map(function(e){return e.letters}).join("")+"]","g"),j2={};for(var Xv=0;Xv<t1.length;Xv++)for(var Zv=t1[Xv],e0=0;e0<Zv.letters.length;e0++)j2[Zv.letters[e0]]=Zv.base;var C2=function(n){return n.replace(cF,function(t){return j2[t]})},uF=iF(C2),ZN=function(n){return n.replace(/^\s+|\s+$/g,"")},dF=function(n){return"".concat(n.label," ").concat(n.value)},fF=function(n){return function(t,r){if(t.data.__isNew__)return!0;var a=Dt({ignoreCase:!0,ignoreAccents:!0,stringify:dF,trim:!0,matchFrom:"any"},n),l=a.ignoreCase,o=a.ignoreAccents,f=a.stringify,u=a.trim,d=a.matchFrom,h=u?ZN(r):r,g=u?ZN(f(t)):f(t);return l&&(h=h.toLowerCase(),g=g.toLowerCase()),o&&(h=uF(h),g=C2(g)),d==="start"?g.substr(0,h.length)===h:g.indexOf(h)>-1}},hF=["innerRef"];function pF(e){var n=e.innerRef,t=Ho(e,hF),r=zL(t,"onExited","in","enter","exit","appear");return jt("input",Lt({ref:n},r,{css:ow({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var mF=function(n){n.cancelable&&n.preventDefault(),n.stopPropagation()};function gF(e){var n=e.isEnabled,t=e.onBottomArrive,r=e.onBottomLeave,a=e.onTopArrive,l=e.onTopLeave,o=w.useRef(!1),f=w.useRef(!1),u=w.useRef(0),d=w.useRef(null),h=w.useCallback(function(T,E){if(d.current!==null){var P=d.current,I=P.scrollTop,V=P.scrollHeight,F=P.clientHeight,O=d.current,B=E>0,U=V-F-I,z=!1;U>E&&o.current&&(r&&r(T),o.current=!1),B&&f.current&&(l&&l(T),f.current=!1),B&&E>U?(t&&!o.current&&t(T),O.scrollTop=V,z=!0,o.current=!0):!B&&-E>I&&(a&&!f.current&&a(T),O.scrollTop=0,z=!0,f.current=!0),z&&mF(T)}},[t,r,a,l]),g=w.useCallback(function(T){h(T,T.deltaY)},[h]),b=w.useCallback(function(T){u.current=T.changedTouches[0].clientY},[]),v=w.useCallback(function(T){var E=u.current-T.changedTouches[0].clientY;h(T,E)},[h]),S=w.useCallback(function(T){if(T){var E=OL?{passive:!1}:!1;T.addEventListener("wheel",g,E),T.addEventListener("touchstart",b,E),T.addEventListener("touchmove",v,E)}},[v,b,g]),k=w.useCallback(function(T){T&&(T.removeEventListener("wheel",g,!1),T.removeEventListener("touchstart",b,!1),T.removeEventListener("touchmove",v,!1))},[v,b,g]);return w.useEffect(function(){if(n){var T=d.current;return S(T),function(){k(T)}}},[n,S,k]),function(T){d.current=T}}var eS=["boxSizing","height","overflow","paddingRight","position"],tS={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function nS(e){e.cancelable&&e.preventDefault()}function iS(e){e.stopPropagation()}function rS(){var e=this.scrollTop,n=this.scrollHeight,t=e+this.offsetHeight;e===0?this.scrollTop=1:t===n&&(this.scrollTop=e-1)}function aS(){return"ontouchstart"in window||navigator.maxTouchPoints}var sS=!!(typeof window<"u"&&window.document&&window.document.createElement),Rm=0,vh={capture:!1,passive:!1};function yF(e){var n=e.isEnabled,t=e.accountForScrollbars,r=t===void 0?!0:t,a=w.useRef({}),l=w.useRef(null),o=w.useCallback(function(u){if(sS){var d=document.body,h=d&&d.style;if(r&&eS.forEach(function(S){var k=h&&h[S];a.current[S]=k}),r&&Rm<1){var g=parseInt(a.current.paddingRight,10)||0,b=document.body?document.body.clientWidth:0,v=window.innerWidth-b+g||0;Object.keys(tS).forEach(function(S){var k=tS[S];h&&(h[S]=k)}),h&&(h.paddingRight="".concat(v,"px"))}d&&aS()&&(d.addEventListener("touchmove",nS,vh),u&&(u.addEventListener("touchstart",rS,vh),u.addEventListener("touchmove",iS,vh))),Rm+=1}},[r]),f=w.useCallback(function(u){if(sS){var d=document.body,h=d&&d.style;Rm=Math.max(Rm-1,0),r&&Rm<1&&eS.forEach(function(g){var b=a.current[g];h&&(h[g]=b)}),d&&aS()&&(d.removeEventListener("touchmove",nS,vh),u&&(u.removeEventListener("touchstart",rS,vh),u.removeEventListener("touchmove",iS,vh)))}},[r]);return w.useEffect(function(){if(n){var u=l.current;return o(u),function(){f(u)}}},[n,o,f]),function(u){l.current=u}}var xF=function(n){var t=n.target;return t.ownerDocument.activeElement&&t.ownerDocument.activeElement.blur()},bF={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function vF(e){var n=e.children,t=e.lockEnabled,r=e.captureEnabled,a=r===void 0?!0:r,l=e.onBottomArrive,o=e.onBottomLeave,f=e.onTopArrive,u=e.onTopLeave,d=gF({isEnabled:a,onBottomArrive:l,onBottomLeave:o,onTopArrive:f,onTopLeave:u}),h=yF({isEnabled:t}),g=function(v){d(v),h(v)};return jt(w.Fragment,null,t&&jt("div",{onClick:xF,css:bF}),n(g))}var wF={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},NF=function(n){var t=n.name,r=n.onFocus;return jt("input",{required:!0,name:t,tabIndex:-1,"aria-hidden":"true",onFocus:r,css:wF,value:"",onChange:function(){}})},SF=NF;function hw(e){var n;return typeof window<"u"&&window.navigator!=null?e.test(((n=window.navigator.userAgentData)===null||n===void 0?void 0:n.platform)||window.navigator.platform):!1}function jF(){return hw(/^iPhone/i)}function _2(){return hw(/^Mac/i)}function CF(){return hw(/^iPad/i)||_2()&&navigator.maxTouchPoints>1}function _F(){return jF()||CF()}function kF(){return _2()||_F()}var EF=function(n){return n.label},TF=function(n){return n.label},AF=function(n){return n.value},DF=function(n){return!!n.isDisabled},PF={clearIndicator:pO,container:iO,control:wO,dropdownIndicator:fO,group:CO,groupHeading:kO,indicatorsContainer:lO,indicatorSeparator:gO,input:DO,loadingIndicator:bO,loadingMessage:XL,menu:HL,menuList:QL,menuPortal:tO,multiValue:LO,multiValueLabel:OO,multiValueRemove:FO,noOptionsMessage:KL,option:VO,placeholder:YO,singleValue:JO,valueContainer:aO},IF={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},MF=4,k2=4,RF=38,LF=k2*2,OF={baseUnit:k2,controlHeight:RF,menuGutter:LF},t0={borderRadius:MF,colors:IF,spacing:OF},FF={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:QN(),captureMenuScroll:!QN(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:fF(),formatGroupLabel:EF,getOptionLabel:TF,getOptionValue:AF,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:DF,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!RL(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(n){var t=n.count;return"".concat(t," result").concat(t!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function lS(e,n,t,r){var a=A2(e,n,t),l=D2(e,n,t),o=T2(e,n),f=ub(e,n);return{type:"option",data:n,isDisabled:a,isSelected:l,label:o,value:f,index:r}}function qx(e,n){return e.options.map(function(t,r){if("options"in t){var a=t.options.map(function(o,f){return lS(e,o,n,f)}).filter(function(o){return cS(e,o)});return a.length>0?{type:"group",data:t,options:a,index:r}:void 0}var l=lS(e,t,n,r);return cS(e,l)?l:void 0}).filter(FL)}function E2(e){return e.reduce(function(n,t){return t.type==="group"?n.push.apply(n,iw(t.options.map(function(r){return r.data}))):n.push(t.data),n},[])}function oS(e,n){return e.reduce(function(t,r){return r.type==="group"?t.push.apply(t,iw(r.options.map(function(a){return{data:a.data,id:"".concat(n,"-").concat(r.index,"-").concat(a.index)}}))):t.push({data:r.data,id:"".concat(n,"-").concat(r.index)}),t},[])}function $F(e,n){return E2(qx(e,n))}function cS(e,n){var t=e.inputValue,r=t===void 0?"":t,a=n.data,l=n.isSelected,o=n.label,f=n.value;return(!I2(e)||!l)&&P2(e,{label:o,value:f,data:a},r)}function zF(e,n){var t=e.focusedValue,r=e.selectValue,a=r.indexOf(t);if(a>-1){var l=n.indexOf(t);if(l>-1)return t;if(a<n.length)return n[a]}return null}function BF(e,n){var t=e.focusedOption;return t&&n.indexOf(t)>-1?t:n[0]}var n0=function(n,t){var r,a=(r=n.find(function(l){return l.data===t}))===null||r===void 0?void 0:r.id;return a||null},T2=function(n,t){return n.getOptionLabel(t)},ub=function(n,t){return n.getOptionValue(t)};function A2(e,n,t){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(n,t):!1}function D2(e,n,t){if(t.indexOf(n)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(n,t);var r=ub(e,n);return t.some(function(a){return ub(e,a)===r})}function P2(e,n,t){return e.filterOption?e.filterOption(n,t):!0}var I2=function(n){var t=n.hideSelectedOptions,r=n.isMulti;return t===void 0?r:t},UF=1,M2=function(e){o3(t,e);var n=d3(t);function t(r){var a;if(s3(this,t),a=n.call(this,r),a.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},a.blockOptionHover=!1,a.isComposing=!1,a.commonProps=void 0,a.initialTouchX=0,a.initialTouchY=0,a.openAfterFocus=!1,a.scrollToFocusedOptionOnUpdate=!1,a.userIsDragging=void 0,a.controlRef=null,a.getControlRef=function(u){a.controlRef=u},a.focusedOptionRef=null,a.getFocusedOptionRef=function(u){a.focusedOptionRef=u},a.menuListRef=null,a.getMenuListRef=function(u){a.menuListRef=u},a.inputRef=null,a.getInputRef=function(u){a.inputRef=u},a.focus=a.focusInput,a.blur=a.blurInput,a.onChange=function(u,d){var h=a.props,g=h.onChange,b=h.name;d.name=b,a.ariaOnChange(u,d),g(u,d)},a.setValue=function(u,d,h){var g=a.props,b=g.closeMenuOnSelect,v=g.isMulti,S=g.inputValue;a.onInputChange("",{action:"set-value",prevInputValue:S}),b&&(a.setState({inputIsHiddenAfterUpdate:!v}),a.onMenuClose()),a.setState({clearFocusValueOnUpdate:!0}),a.onChange(u,{action:d,option:h})},a.selectOption=function(u){var d=a.props,h=d.blurInputOnSelect,g=d.isMulti,b=d.name,v=a.state.selectValue,S=g&&a.isOptionSelected(u,v),k=a.isOptionDisabled(u,v);if(S){var T=a.getOptionValue(u);a.setValue(v.filter(function(E){return a.getOptionValue(E)!==T}),"deselect-option",u)}else if(!k)g?a.setValue([].concat(iw(v),[u]),"select-option",u):a.setValue(u,"select-option");else{a.ariaOnChange(u,{action:"select-option",option:u,name:b});return}h&&a.blurInput()},a.removeValue=function(u){var d=a.props.isMulti,h=a.state.selectValue,g=a.getOptionValue(u),b=h.filter(function(S){return a.getOptionValue(S)!==g}),v=wx(d,b,b[0]||null);a.onChange(v,{action:"remove-value",removedValue:u}),a.focusInput()},a.clearValue=function(){var u=a.state.selectValue;a.onChange(wx(a.props.isMulti,[],null),{action:"clear",removedValues:u})},a.popValue=function(){var u=a.props.isMulti,d=a.state.selectValue,h=d[d.length-1],g=d.slice(0,d.length-1),b=wx(u,g,g[0]||null);h&&a.onChange(b,{action:"pop-value",removedValue:h})},a.getFocusedOptionId=function(u){return n0(a.state.focusableOptionsWithIds,u)},a.getFocusableOptionsWithIds=function(){return oS(qx(a.props,a.state.selectValue),a.getElementId("option"))},a.getValue=function(){return a.state.selectValue},a.cx=function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return AL.apply(void 0,[a.props.classNamePrefix].concat(d))},a.getOptionLabel=function(u){return T2(a.props,u)},a.getOptionValue=function(u){return ub(a.props,u)},a.getStyles=function(u,d){var h=a.props.unstyled,g=PF[u](d,h);g.boxSizing="border-box";var b=a.props.styles[u];return b?b(g,d):g},a.getClassNames=function(u,d){var h,g;return(h=(g=a.props.classNames)[u])===null||h===void 0?void 0:h.call(g,d)},a.getElementId=function(u){return"".concat(a.state.instancePrefix,"-").concat(u)},a.getComponents=function(){return eF(a.props)},a.buildCategorizedOptions=function(){return qx(a.props,a.state.selectValue)},a.getCategorizedOptions=function(){return a.props.menuIsOpen?a.buildCategorizedOptions():[]},a.buildFocusableOptions=function(){return E2(a.buildCategorizedOptions())},a.getFocusableOptions=function(){return a.props.menuIsOpen?a.buildFocusableOptions():[]},a.ariaOnChange=function(u,d){a.setState({ariaSelection:Dt({value:u},d)})},a.onMenuMouseDown=function(u){u.button===0&&(u.stopPropagation(),u.preventDefault(),a.focusInput())},a.onMenuMouseMove=function(u){a.blockOptionHover=!1},a.onControlMouseDown=function(u){if(!u.defaultPrevented){var d=a.props.openMenuOnClick;a.state.isFocused?a.props.menuIsOpen?u.target.tagName!=="INPUT"&&u.target.tagName!=="TEXTAREA"&&a.onMenuClose():d&&a.openMenu("first"):(d&&(a.openAfterFocus=!0),a.focusInput()),u.target.tagName!=="INPUT"&&u.target.tagName!=="TEXTAREA"&&u.preventDefault()}},a.onDropdownIndicatorMouseDown=function(u){if(!(u&&u.type==="mousedown"&&u.button!==0)&&!a.props.isDisabled){var d=a.props,h=d.isMulti,g=d.menuIsOpen;a.focusInput(),g?(a.setState({inputIsHiddenAfterUpdate:!h}),a.onMenuClose()):a.openMenu("first"),u.preventDefault()}},a.onClearIndicatorMouseDown=function(u){u&&u.type==="mousedown"&&u.button!==0||(a.clearValue(),u.preventDefault(),a.openAfterFocus=!1,u.type==="touchend"?a.focusInput():setTimeout(function(){return a.focusInput()}))},a.onScroll=function(u){typeof a.props.closeMenuOnScroll=="boolean"?u.target instanceof HTMLElement&&Pb(u.target)&&a.props.onMenuClose():typeof a.props.closeMenuOnScroll=="function"&&a.props.closeMenuOnScroll(u)&&a.props.onMenuClose()},a.onCompositionStart=function(){a.isComposing=!0},a.onCompositionEnd=function(){a.isComposing=!1},a.onTouchStart=function(u){var d=u.touches,h=d&&d.item(0);h&&(a.initialTouchX=h.clientX,a.initialTouchY=h.clientY,a.userIsDragging=!1)},a.onTouchMove=function(u){var d=u.touches,h=d&&d.item(0);if(h){var g=Math.abs(h.clientX-a.initialTouchX),b=Math.abs(h.clientY-a.initialTouchY),v=5;a.userIsDragging=g>v||b>v}},a.onTouchEnd=function(u){a.userIsDragging||(a.controlRef&&!a.controlRef.contains(u.target)&&a.menuListRef&&!a.menuListRef.contains(u.target)&&a.blurInput(),a.initialTouchX=0,a.initialTouchY=0)},a.onControlTouchEnd=function(u){a.userIsDragging||a.onControlMouseDown(u)},a.onClearIndicatorTouchEnd=function(u){a.userIsDragging||a.onClearIndicatorMouseDown(u)},a.onDropdownIndicatorTouchEnd=function(u){a.userIsDragging||a.onDropdownIndicatorMouseDown(u)},a.handleInputChange=function(u){var d=a.props.inputValue,h=u.currentTarget.value;a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange(h,{action:"input-change",prevInputValue:d}),a.props.menuIsOpen||a.onMenuOpen()},a.onInputFocus=function(u){a.props.onFocus&&a.props.onFocus(u),a.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(a.openAfterFocus||a.props.openMenuOnFocus)&&a.openMenu("first"),a.openAfterFocus=!1},a.onInputBlur=function(u){var d=a.props.inputValue;if(a.menuListRef&&a.menuListRef.contains(document.activeElement)){a.inputRef.focus();return}a.props.onBlur&&a.props.onBlur(u),a.onInputChange("",{action:"input-blur",prevInputValue:d}),a.onMenuClose(),a.setState({focusedValue:null,isFocused:!1})},a.onOptionHover=function(u){if(!(a.blockOptionHover||a.state.focusedOption===u)){var d=a.getFocusableOptions(),h=d.indexOf(u);a.setState({focusedOption:u,focusedOptionId:h>-1?a.getFocusedOptionId(u):null})}},a.shouldHideSelectedOptions=function(){return I2(a.props)},a.onValueInputFocus=function(u){u.preventDefault(),u.stopPropagation(),a.focus()},a.onKeyDown=function(u){var d=a.props,h=d.isMulti,g=d.backspaceRemovesValue,b=d.escapeClearsValue,v=d.inputValue,S=d.isClearable,k=d.isDisabled,T=d.menuIsOpen,E=d.onKeyDown,P=d.tabSelectsValue,I=d.openMenuOnFocus,V=a.state,F=V.focusedOption,O=V.focusedValue,B=V.selectValue;if(!k&&!(typeof E=="function"&&(E(u),u.defaultPrevented))){switch(a.blockOptionHover=!0,u.key){case"ArrowLeft":if(!h||v)return;a.focusValue("previous");break;case"ArrowRight":if(!h||v)return;a.focusValue("next");break;case"Delete":case"Backspace":if(v)return;if(O)a.removeValue(O);else{if(!g)return;h?a.popValue():S&&a.clearValue()}break;case"Tab":if(a.isComposing||u.shiftKey||!T||!P||!F||I&&a.isOptionSelected(F,B))return;a.selectOption(F);break;case"Enter":if(u.keyCode===229)break;if(T){if(!F||a.isComposing)return;a.selectOption(F);break}return;case"Escape":T?(a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange("",{action:"menu-close",prevInputValue:v}),a.onMenuClose()):S&&b&&a.clearValue();break;case" ":if(v)return;if(!T){a.openMenu("first");break}if(!F)return;a.selectOption(F);break;case"ArrowUp":T?a.focusOption("up"):a.openMenu("last");break;case"ArrowDown":T?a.focusOption("down"):a.openMenu("first");break;case"PageUp":if(!T)return;a.focusOption("pageup");break;case"PageDown":if(!T)return;a.focusOption("pagedown");break;case"Home":if(!T)return;a.focusOption("first");break;case"End":if(!T)return;a.focusOption("last");break;default:return}u.preventDefault()}},a.state.instancePrefix="react-select-"+(a.props.instanceId||++UF),a.state.selectValue=YN(r.value),r.menuIsOpen&&a.state.selectValue.length){var l=a.getFocusableOptionsWithIds(),o=a.buildFocusableOptions(),f=o.indexOf(a.state.selectValue[0]);a.state.focusableOptionsWithIds=l,a.state.focusedOption=o[f],a.state.focusedOptionId=n0(l,o[f])}return a}return l3(t,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&WN(this.menuListRef,this.focusedOptionRef),kF()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(a){var l=this.props,o=l.isDisabled,f=l.menuIsOpen,u=this.state.isFocused;(u&&!o&&a.isDisabled||u&&f&&!a.menuIsOpen)&&this.focusInput(),u&&o&&!a.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!u&&!o&&a.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(WN(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(a,l){this.props.onInputChange(a,l)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(a){var l=this,o=this.state,f=o.selectValue,u=o.isFocused,d=this.buildFocusableOptions(),h=a==="first"?0:d.length-1;if(!this.props.isMulti){var g=d.indexOf(f[0]);g>-1&&(h=g)}this.scrollToFocusedOptionOnUpdate=!(u&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:d[h],focusedOptionId:this.getFocusedOptionId(d[h])},function(){return l.onMenuOpen()})}},{key:"focusValue",value:function(a){var l=this.state,o=l.selectValue,f=l.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var u=o.indexOf(f);f||(u=-1);var d=o.length-1,h=-1;if(o.length){switch(a){case"previous":u===0?h=0:u===-1?h=d:h=u-1;break;case"next":u>-1&&u<d&&(h=u+1);break}this.setState({inputIsHidden:h!==-1,focusedValue:o[h]})}}}},{key:"focusOption",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",l=this.props.pageSize,o=this.state.focusedOption,f=this.getFocusableOptions();if(f.length){var u=0,d=f.indexOf(o);o||(d=-1),a==="up"?u=d>0?d-1:f.length-1:a==="down"?u=(d+1)%f.length:a==="pageup"?(u=d-l,u<0&&(u=0)):a==="pagedown"?(u=d+l,u>f.length-1&&(u=f.length-1)):a==="last"&&(u=f.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:f[u],focusedValue:null,focusedOptionId:this.getFocusedOptionId(f[u])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(t0):Dt(Dt({},t0),this.props.theme):t0}},{key:"getCommonProps",value:function(){var a=this.clearValue,l=this.cx,o=this.getStyles,f=this.getClassNames,u=this.getValue,d=this.selectOption,h=this.setValue,g=this.props,b=g.isMulti,v=g.isRtl,S=g.options,k=this.hasValue();return{clearValue:a,cx:l,getStyles:o,getClassNames:f,getValue:u,hasValue:k,isMulti:b,isRtl:v,options:S,selectOption:d,selectProps:g,setValue:h,theme:this.getTheme()}}},{key:"hasValue",value:function(){var a=this.state.selectValue;return a.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var a=this.props,l=a.isClearable,o=a.isMulti;return l===void 0?o:l}},{key:"isOptionDisabled",value:function(a,l){return A2(this.props,a,l)}},{key:"isOptionSelected",value:function(a,l){return D2(this.props,a,l)}},{key:"filterOption",value:function(a,l){return P2(this.props,a,l)}},{key:"formatOptionLabel",value:function(a,l){if(typeof this.props.formatOptionLabel=="function"){var o=this.props.inputValue,f=this.state.selectValue;return this.props.formatOptionLabel(a,{context:l,inputValue:o,selectValue:f})}else return this.getOptionLabel(a)}},{key:"formatGroupLabel",value:function(a){return this.props.formatGroupLabel(a)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var a=this.props,l=a.isDisabled,o=a.isSearchable,f=a.inputId,u=a.inputValue,d=a.tabIndex,h=a.form,g=a.menuIsOpen,b=a.required,v=this.getComponents(),S=v.Input,k=this.state,T=k.inputIsHidden,E=k.ariaSelection,P=this.commonProps,I=f||this.getElementId("input"),V=Dt(Dt(Dt({"aria-autocomplete":"list","aria-expanded":g,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":b,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},g&&{"aria-controls":this.getElementId("listbox")}),!o&&{"aria-readonly":!0}),this.hasValue()?(E==null?void 0:E.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return o?w.createElement(S,Lt({},P,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:I,innerRef:this.getInputRef,isDisabled:l,isHidden:T,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:d,form:h,type:"text",value:u},V)):w.createElement(pF,Lt({id:I,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:ob,onFocus:this.onInputFocus,disabled:l,tabIndex:d,inputMode:"none",form:h,value:""},V))}},{key:"renderPlaceholderOrValue",value:function(){var a=this,l=this.getComponents(),o=l.MultiValue,f=l.MultiValueContainer,u=l.MultiValueLabel,d=l.MultiValueRemove,h=l.SingleValue,g=l.Placeholder,b=this.commonProps,v=this.props,S=v.controlShouldRenderValue,k=v.isDisabled,T=v.isMulti,E=v.inputValue,P=v.placeholder,I=this.state,V=I.selectValue,F=I.focusedValue,O=I.isFocused;if(!this.hasValue()||!S)return E?null:w.createElement(g,Lt({},b,{key:"placeholder",isDisabled:k,isFocused:O,innerProps:{id:this.getElementId("placeholder")}}),P);if(T)return V.map(function(U,z){var $=U===F,R="".concat(a.getOptionLabel(U),"-").concat(a.getOptionValue(U));return w.createElement(o,Lt({},b,{components:{Container:f,Label:u,Remove:d},isFocused:$,isDisabled:k,key:R,index:z,removeProps:{onClick:function(){return a.removeValue(U)},onTouchEnd:function(){return a.removeValue(U)},onMouseDown:function(ee){ee.preventDefault()}},data:U}),a.formatOptionLabel(U,"value"))});if(E)return null;var B=V[0];return w.createElement(h,Lt({},b,{data:B,isDisabled:k}),this.formatOptionLabel(B,"value"))}},{key:"renderClearIndicator",value:function(){var a=this.getComponents(),l=a.ClearIndicator,o=this.commonProps,f=this.props,u=f.isDisabled,d=f.isLoading,h=this.state.isFocused;if(!this.isClearable()||!l||u||!this.hasValue()||d)return null;var g={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(l,Lt({},o,{innerProps:g,isFocused:h}))}},{key:"renderLoadingIndicator",value:function(){var a=this.getComponents(),l=a.LoadingIndicator,o=this.commonProps,f=this.props,u=f.isDisabled,d=f.isLoading,h=this.state.isFocused;if(!l||!d)return null;var g={"aria-hidden":"true"};return w.createElement(l,Lt({},o,{innerProps:g,isDisabled:u,isFocused:h}))}},{key:"renderIndicatorSeparator",value:function(){var a=this.getComponents(),l=a.DropdownIndicator,o=a.IndicatorSeparator;if(!l||!o)return null;var f=this.commonProps,u=this.props.isDisabled,d=this.state.isFocused;return w.createElement(o,Lt({},f,{isDisabled:u,isFocused:d}))}},{key:"renderDropdownIndicator",value:function(){var a=this.getComponents(),l=a.DropdownIndicator;if(!l)return null;var o=this.commonProps,f=this.props.isDisabled,u=this.state.isFocused,d={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(l,Lt({},o,{innerProps:d,isDisabled:f,isFocused:u}))}},{key:"renderMenu",value:function(){var a=this,l=this.getComponents(),o=l.Group,f=l.GroupHeading,u=l.Menu,d=l.MenuList,h=l.MenuPortal,g=l.LoadingMessage,b=l.NoOptionsMessage,v=l.Option,S=this.commonProps,k=this.state.focusedOption,T=this.props,E=T.captureMenuScroll,P=T.inputValue,I=T.isLoading,V=T.loadingMessage,F=T.minMenuHeight,O=T.maxMenuHeight,B=T.menuIsOpen,U=T.menuPlacement,z=T.menuPosition,$=T.menuPortalTarget,R=T.menuShouldBlockScroll,H=T.menuShouldScrollIntoView,ee=T.noOptionsMessage,Z=T.onMenuScrollToTop,te=T.onMenuScrollToBottom;if(!B)return null;var Q=function(M,ce){var ve=M.type,le=M.data,xe=M.isDisabled,ue=M.isSelected,ze=M.label,tt=M.value,ft=k===le,Re=xe?void 0:function(){return a.onOptionHover(le)},je=xe?void 0:function(){return a.selectOption(le)},he="".concat(a.getElementId("option"),"-").concat(ce),Ae={id:he,onClick:je,onMouseMove:Re,onMouseOver:Re,tabIndex:-1,role:"option","aria-selected":a.state.isAppleDevice?void 0:ue};return w.createElement(v,Lt({},S,{innerProps:Ae,data:le,isDisabled:xe,isSelected:ue,key:he,label:ze,type:ve,value:tt,isFocused:ft,innerRef:ft?a.getFocusedOptionRef:void 0}),a.formatOptionLabel(M.data,"menu"))},q;if(this.hasOptions())q=this.getCategorizedOptions().map(function(se){if(se.type==="group"){var M=se.data,ce=se.options,ve=se.index,le="".concat(a.getElementId("group"),"-").concat(ve),xe="".concat(le,"-heading");return w.createElement(o,Lt({},S,{key:le,data:M,options:ce,Heading:f,headingProps:{id:xe,data:se.data},label:a.formatGroupLabel(se.data)}),se.options.map(function(ue){return Q(ue,"".concat(ve,"-").concat(ue.index))}))}else if(se.type==="option")return Q(se,"".concat(se.index))});else if(I){var W=V({inputValue:P});if(W===null)return null;q=w.createElement(g,S,W)}else{var ne=ee({inputValue:P});if(ne===null)return null;q=w.createElement(b,S,ne)}var A={minMenuHeight:F,maxMenuHeight:O,menuPlacement:U,menuPosition:z,menuShouldScrollIntoView:H},ie=w.createElement(GL,Lt({},S,A),function(se){var M=se.ref,ce=se.placerProps,ve=ce.placement,le=ce.maxHeight;return w.createElement(u,Lt({},S,A,{innerRef:M,innerProps:{onMouseDown:a.onMenuMouseDown,onMouseMove:a.onMenuMouseMove},isLoading:I,placement:ve}),w.createElement(vF,{captureEnabled:E,onTopArrive:Z,onBottomArrive:te,lockEnabled:R},function(xe){return w.createElement(d,Lt({},S,{innerRef:function(ze){a.getMenuListRef(ze),xe(ze)},innerProps:{role:"listbox","aria-multiselectable":S.isMulti,id:a.getElementId("listbox")},isLoading:I,maxHeight:le,focusedOption:k}),q)}))});return $||z==="fixed"?w.createElement(h,Lt({},S,{appendTo:$,controlElement:this.controlRef,menuPlacement:U,menuPosition:z}),ie):ie}},{key:"renderFormField",value:function(){var a=this,l=this.props,o=l.delimiter,f=l.isDisabled,u=l.isMulti,d=l.name,h=l.required,g=this.state.selectValue;if(h&&!this.hasValue()&&!f)return w.createElement(SF,{name:d,onFocus:this.onValueInputFocus});if(!(!d||f))if(u)if(o){var b=g.map(function(k){return a.getOptionValue(k)}).join(o);return w.createElement("input",{name:d,type:"hidden",value:b})}else{var v=g.length>0?g.map(function(k,T){return w.createElement("input",{key:"i-".concat(T),name:d,type:"hidden",value:a.getOptionValue(k)})}):w.createElement("input",{name:d,type:"hidden",value:""});return w.createElement("div",null,v)}else{var S=g[0]?this.getOptionValue(g[0]):"";return w.createElement("input",{name:d,type:"hidden",value:S})}}},{key:"renderLiveRegion",value:function(){var a=this.commonProps,l=this.state,o=l.ariaSelection,f=l.focusedOption,u=l.focusedValue,d=l.isFocused,h=l.selectValue,g=this.getFocusableOptions();return w.createElement(oF,Lt({},a,{id:this.getElementId("live-region"),ariaSelection:o,focusedOption:f,focusedValue:u,isFocused:d,selectValue:h,focusableOptions:g,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var a=this.getComponents(),l=a.Control,o=a.IndicatorsContainer,f=a.SelectContainer,u=a.ValueContainer,d=this.props,h=d.className,g=d.id,b=d.isDisabled,v=d.menuIsOpen,S=this.state.isFocused,k=this.commonProps=this.getCommonProps();return w.createElement(f,Lt({},k,{className:h,innerProps:{id:g,onKeyDown:this.onKeyDown},isDisabled:b,isFocused:S}),this.renderLiveRegion(),w.createElement(l,Lt({},k,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:b,isFocused:S,menuIsOpen:v}),w.createElement(u,Lt({},k,{isDisabled:b}),this.renderPlaceholderOrValue(),this.renderInput()),w.createElement(o,Lt({},k,{isDisabled:b}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(a,l){var o=l.prevProps,f=l.clearFocusValueOnUpdate,u=l.inputIsHiddenAfterUpdate,d=l.ariaSelection,h=l.isFocused,g=l.prevWasFocused,b=l.instancePrefix,v=a.options,S=a.value,k=a.menuIsOpen,T=a.inputValue,E=a.isMulti,P=YN(S),I={};if(o&&(S!==o.value||v!==o.options||k!==o.menuIsOpen||T!==o.inputValue)){var V=k?$F(a,P):[],F=k?oS(qx(a,P),"".concat(b,"-option")):[],O=f?zF(l,P):null,B=BF(l,V),U=n0(F,B);I={selectValue:P,focusedOption:B,focusedOptionId:U,focusableOptionsWithIds:F,focusedValue:O,clearFocusValueOnUpdate:!1}}var z=u!=null&&a!==o?{inputIsHidden:u,inputIsHiddenAfterUpdate:void 0}:{},$=d,R=h&&g;return h&&!R&&($={value:wx(E,P,P[0]||null),options:P,action:"initial-input-focus"},R=!g),(d==null?void 0:d.action)==="initial-input-focus"&&($=null),Dt(Dt(Dt({},I),z),{},{prevProps:a,ariaSelection:$,prevWasFocused:R})}}]),t}(w.Component);M2.defaultProps=FF;var qF=w.forwardRef(function(e,n){var t=a3(e);return w.createElement(M2,Lt({ref:n},t))}),R2=qF;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let VF,HF;function GF(){return{geminiUrl:VF,vertexUrl:HF}}function YF(e,n,t){var r,a,l;if(!(!((r=e.httpOptions)===null||r===void 0)&&r.baseUrl)){const o=GF();return e.vertexai?(a=o.vertexUrl)!==null&&a!==void 0?a:n:(l=o.geminiUrl)!==null&&l!==void 0?l:t}return e.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hg{}function Bt(e,n){const t=/\{([^}]+)\}/g;return e.replace(t,(r,a)=>{if(Object.prototype.hasOwnProperty.call(n,a)){const l=n[a];return l!=null?String(l):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function C(e,n,t){for(let l=0;l<n.length-1;l++){const o=n[l];if(o.endsWith("[]")){const f=o.slice(0,-2);if(!(f in e))if(Array.isArray(t))e[f]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(e[f])){const u=e[f];if(Array.isArray(t))for(let d=0;d<u.length;d++){const h=u[d];C(h,n.slice(l+1),t[d])}else for(const d of u)C(d,n.slice(l+1),t)}return}else if(o.endsWith("[0]")){const f=o.slice(0,-3);f in e||(e[f]=[{}]);const u=e[f];C(u[0],n.slice(l+1),t);return}(!e[o]||typeof e[o]!="object")&&(e[o]={}),e=e[o]}const r=n[n.length-1],a=e[r];if(a!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===a)return;if(typeof a=="object"&&typeof t=="object"&&a!==null&&t!==null)Object.assign(a,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else e[r]=t}function j(e,n){try{if(n.length===1&&n[0]==="_self")return e;for(let t=0;t<n.length;t++){if(typeof e!="object"||e===null)return;const r=n[t];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in e){const l=e[a];return Array.isArray(l)?l.map(o=>j(o,n.slice(t+1))):void 0}else return}else e=e[r]}return e}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wi(e,n){if(!n||typeof n!="string")throw new Error("model is required and must be a string");if(e.isVertexAI()){if(n.startsWith("publishers/")||n.startsWith("projects/")||n.startsWith("models/"))return n;if(n.indexOf("/")>=0){const t=n.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${n}`}else return n.startsWith("models/")||n.startsWith("tunedModels/")?n:`models/${n}`}function L2(e,n){const t=wi(e,n);return t?t.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:t.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${t}`:t:""}function O2(e,n){return Array.isArray(n)?n.map(t=>db(e,t)):[db(e,n)]}function db(e,n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function WF(e,n){const t=db(e,n);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function QF(e,n){const t=db(e,n);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function uS(e,n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function F2(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(t=>uS(e,t)):[uS(e,n)]}function n1(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function dS(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function fS(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function pa(e,n){if(n==null)throw new Error("ContentUnion is required");return n1(n)?n:{role:"user",parts:F2(e,n)}}function $2(e,n){if(!n)return[];if(e.isVertexAI()&&Array.isArray(n))return n.flatMap(t=>{const r=pa(e,t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const t=pa(e,n);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(n)?n.map(t=>pa(e,t)):[pa(e,n)]}function ru(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(dS(n)||fS(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[pa(e,n)]}const t=[],r=[],a=n1(n[0]);for(const l of n){const o=n1(l);if(o!=a)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)t.push(l);else{if(dS(l)||fS(l))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(l)}}return a||t.push({role:"user",parts:F2(e,r)}),t}function z2(e,n){return n}function B2(e,n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Ib(e,n){return n}function Mb(e,n){if(!Array.isArray(n))throw new Error("tool is required and must be an array of Tools");return n}function JF(e,n,t,r=1){const a=!n.startsWith(`${t}/`)&&n.split("/").length===r;return e.isVertexAI()?n.startsWith("projects/")?n:n.startsWith("locations/")?`projects/${e.getProject()}/${n}`:n.startsWith(`${t}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:a?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}/${n}`:n:a?`${t}/${n}`:n}function au(e,n){if(typeof n!="string")throw new Error("name must be a string");return JF(e,n,"cachedContents")}function U2(e,n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function su(e,n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function KF(e){return e!=null&&typeof e=="object"&&"name"in e}function XF(e){return e!=null&&typeof e=="object"&&"video"in e}function ZF(e){return e!=null&&typeof e=="object"&&"uri"in e}function q2(e,n){var t;let r;if(KF(n)&&(r=n.name),!(ZF(n)&&(r=n.uri,r===void 0))&&!(XF(n)&&(r=(t=n.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof n=="string"&&(r=n),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const l=r.split("files/")[1].match(/[a-z0-9]+/);if(l===null)throw new Error(`Could not extract file name from URI ${r}`);r=l[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function V2(e,n){let t;return e.isVertexAI()?t=n?"publishers/google/models":"models":t=n?"models":"tunedModels",t}function H2(e,n){for(const t of["models","tunedModels","publisherModels"])if(e6(n,t))return n[t];return[]}function e6(e,n){return e!==null&&typeof e=="object"&&n in e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function t6(e,n){const t={};if(j(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=j(n,["data"]);r!=null&&C(t,["data"],r);const a=j(n,["mimeType"]);return a!=null&&C(t,["mimeType"],a),t}function n6(e,n){const t={};if(j(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=j(n,["thought"]);r!=null&&C(t,["thought"],r);const a=j(n,["inlineData"]);a!=null&&C(t,["inlineData"],t6(e,a));const l=j(n,["codeExecutionResult"]);l!=null&&C(t,["codeExecutionResult"],l);const o=j(n,["executableCode"]);o!=null&&C(t,["executableCode"],o);const f=j(n,["fileData"]);f!=null&&C(t,["fileData"],f);const u=j(n,["functionCall"]);u!=null&&C(t,["functionCall"],u);const d=j(n,["functionResponse"]);d!=null&&C(t,["functionResponse"],d);const h=j(n,["text"]);return h!=null&&C(t,["text"],h),t}function hS(e,n){const t={},r=j(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>n6(e,o))),C(t,["parts"],l)}const a=j(n,["role"]);return a!=null&&C(t,["role"],a),t}function i6(){return{}}function r6(e,n){const t={},r=j(n,["mode"]);r!=null&&C(t,["mode"],r);const a=j(n,["dynamicThreshold"]);return a!=null&&C(t,["dynamicThreshold"],a),t}function a6(e,n){const t={},r=j(n,["dynamicRetrievalConfig"]);return r!=null&&C(t,["dynamicRetrievalConfig"],r6(e,r)),t}function s6(e,n){const t={};if(j(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");j(n,["googleSearch"])!=null&&C(t,["googleSearch"],i6());const a=j(n,["googleSearchRetrieval"]);if(a!=null&&C(t,["googleSearchRetrieval"],a6(e,a)),j(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(j(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=j(n,["codeExecution"]);l!=null&&C(t,["codeExecution"],l);const o=j(n,["functionDeclarations"]);return o!=null&&C(t,["functionDeclarations"],o),t}function l6(e,n){const t={},r=j(n,["mode"]);r!=null&&C(t,["mode"],r);const a=j(n,["allowedFunctionNames"]);return a!=null&&C(t,["allowedFunctionNames"],a),t}function o6(e,n){const t={},r=j(n,["functionCallingConfig"]);if(r!=null&&C(t,["functionCallingConfig"],l6(e,r)),j(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function c6(e,n,t){const r={},a=j(n,["ttl"]);t!==void 0&&a!=null&&C(t,["ttl"],a);const l=j(n,["expireTime"]);t!==void 0&&l!=null&&C(t,["expireTime"],l);const o=j(n,["displayName"]);t!==void 0&&o!=null&&C(t,["displayName"],o);const f=j(n,["contents"]);if(t!==void 0&&f!=null){let g=ru(e,f);Array.isArray(g)&&(g=g.map(b=>hS(e,b))),C(t,["contents"],g)}const u=j(n,["systemInstruction"]);t!==void 0&&u!=null&&C(t,["systemInstruction"],hS(e,pa(e,u)));const d=j(n,["tools"]);if(t!==void 0&&d!=null){let g=d;Array.isArray(g)&&(g=g.map(b=>s6(e,b))),C(t,["tools"],g)}const h=j(n,["toolConfig"]);return t!==void 0&&h!=null&&C(t,["toolConfig"],o6(e,h)),r}function u6(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["model"],L2(e,r));const a=j(n,["config"]);return a!=null&&C(t,["config"],c6(e,a,t)),t}function d6(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["_url","name"],au(e,r));const a=j(n,["config"]);return a!=null&&C(t,["config"],a),t}function f6(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["_url","name"],au(e,r));const a=j(n,["config"]);return a!=null&&C(t,["config"],a),t}function h6(e,n,t){const r={},a=j(n,["ttl"]);t!==void 0&&a!=null&&C(t,["ttl"],a);const l=j(n,["expireTime"]);return t!==void 0&&l!=null&&C(t,["expireTime"],l),r}function p6(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["_url","name"],au(e,r));const a=j(n,["config"]);return a!=null&&C(t,["config"],h6(e,a,t)),t}function m6(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&C(t,["_query","pageSize"],a);const l=j(n,["pageToken"]);return t!==void 0&&l!=null&&C(t,["_query","pageToken"],l),r}function g6(e,n){const t={},r=j(n,["config"]);return r!=null&&C(t,["config"],m6(e,r,t)),t}function y6(e,n){const t={},r=j(n,["displayName"]);r!=null&&C(t,["displayName"],r);const a=j(n,["data"]);a!=null&&C(t,["data"],a);const l=j(n,["mimeType"]);return l!=null&&C(t,["mimeType"],l),t}function x6(e,n){const t={},r=j(n,["videoMetadata"]);r!=null&&C(t,["videoMetadata"],r);const a=j(n,["thought"]);a!=null&&C(t,["thought"],a);const l=j(n,["inlineData"]);l!=null&&C(t,["inlineData"],y6(e,l));const o=j(n,["codeExecutionResult"]);o!=null&&C(t,["codeExecutionResult"],o);const f=j(n,["executableCode"]);f!=null&&C(t,["executableCode"],f);const u=j(n,["fileData"]);u!=null&&C(t,["fileData"],u);const d=j(n,["functionCall"]);d!=null&&C(t,["functionCall"],d);const h=j(n,["functionResponse"]);h!=null&&C(t,["functionResponse"],h);const g=j(n,["text"]);return g!=null&&C(t,["text"],g),t}function pS(e,n){const t={},r=j(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>x6(e,o))),C(t,["parts"],l)}const a=j(n,["role"]);return a!=null&&C(t,["role"],a),t}function b6(){return{}}function v6(e,n){const t={},r=j(n,["mode"]);r!=null&&C(t,["mode"],r);const a=j(n,["dynamicThreshold"]);return a!=null&&C(t,["dynamicThreshold"],a),t}function w6(e,n){const t={},r=j(n,["dynamicRetrievalConfig"]);return r!=null&&C(t,["dynamicRetrievalConfig"],v6(e,r)),t}function N6(){return{}}function S6(e,n){const t={},r=j(n,["apiKeyString"]);return r!=null&&C(t,["apiKeyString"],r),t}function j6(e,n){const t={},r=j(n,["apiKeyConfig"]);r!=null&&C(t,["apiKeyConfig"],S6(e,r));const a=j(n,["authType"]);a!=null&&C(t,["authType"],a);const l=j(n,["googleServiceAccountConfig"]);l!=null&&C(t,["googleServiceAccountConfig"],l);const o=j(n,["httpBasicAuthConfig"]);o!=null&&C(t,["httpBasicAuthConfig"],o);const f=j(n,["oauthConfig"]);f!=null&&C(t,["oauthConfig"],f);const u=j(n,["oidcConfig"]);return u!=null&&C(t,["oidcConfig"],u),t}function C6(e,n){const t={},r=j(n,["authConfig"]);return r!=null&&C(t,["authConfig"],j6(e,r)),t}function _6(e,n){const t={},r=j(n,["retrieval"]);r!=null&&C(t,["retrieval"],r),j(n,["googleSearch"])!=null&&C(t,["googleSearch"],b6());const l=j(n,["googleSearchRetrieval"]);l!=null&&C(t,["googleSearchRetrieval"],w6(e,l)),j(n,["enterpriseWebSearch"])!=null&&C(t,["enterpriseWebSearch"],N6());const f=j(n,["googleMaps"]);f!=null&&C(t,["googleMaps"],C6(e,f));const u=j(n,["codeExecution"]);u!=null&&C(t,["codeExecution"],u);const d=j(n,["functionDeclarations"]);return d!=null&&C(t,["functionDeclarations"],d),t}function k6(e,n){const t={},r=j(n,["mode"]);r!=null&&C(t,["mode"],r);const a=j(n,["allowedFunctionNames"]);return a!=null&&C(t,["allowedFunctionNames"],a),t}function E6(e,n){const t={},r=j(n,["latitude"]);r!=null&&C(t,["latitude"],r);const a=j(n,["longitude"]);return a!=null&&C(t,["longitude"],a),t}function T6(e,n){const t={},r=j(n,["latLng"]);return r!=null&&C(t,["latLng"],E6(e,r)),t}function A6(e,n){const t={},r=j(n,["functionCallingConfig"]);r!=null&&C(t,["functionCallingConfig"],k6(e,r));const a=j(n,["retrievalConfig"]);return a!=null&&C(t,["retrievalConfig"],T6(e,a)),t}function D6(e,n,t){const r={},a=j(n,["ttl"]);t!==void 0&&a!=null&&C(t,["ttl"],a);const l=j(n,["expireTime"]);t!==void 0&&l!=null&&C(t,["expireTime"],l);const o=j(n,["displayName"]);t!==void 0&&o!=null&&C(t,["displayName"],o);const f=j(n,["contents"]);if(t!==void 0&&f!=null){let g=ru(e,f);Array.isArray(g)&&(g=g.map(b=>pS(e,b))),C(t,["contents"],g)}const u=j(n,["systemInstruction"]);t!==void 0&&u!=null&&C(t,["systemInstruction"],pS(e,pa(e,u)));const d=j(n,["tools"]);if(t!==void 0&&d!=null){let g=d;Array.isArray(g)&&(g=g.map(b=>_6(e,b))),C(t,["tools"],g)}const h=j(n,["toolConfig"]);return t!==void 0&&h!=null&&C(t,["toolConfig"],A6(e,h)),r}function P6(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["model"],L2(e,r));const a=j(n,["config"]);return a!=null&&C(t,["config"],D6(e,a,t)),t}function I6(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["_url","name"],au(e,r));const a=j(n,["config"]);return a!=null&&C(t,["config"],a),t}function M6(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["_url","name"],au(e,r));const a=j(n,["config"]);return a!=null&&C(t,["config"],a),t}function R6(e,n,t){const r={},a=j(n,["ttl"]);t!==void 0&&a!=null&&C(t,["ttl"],a);const l=j(n,["expireTime"]);return t!==void 0&&l!=null&&C(t,["expireTime"],l),r}function L6(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["_url","name"],au(e,r));const a=j(n,["config"]);return a!=null&&C(t,["config"],R6(e,a,t)),t}function O6(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&C(t,["_query","pageSize"],a);const l=j(n,["pageToken"]);return t!==void 0&&l!=null&&C(t,["_query","pageToken"],l),r}function F6(e,n){const t={},r=j(n,["config"]);return r!=null&&C(t,["config"],O6(e,r,t)),t}function Vx(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["name"],r);const a=j(n,["displayName"]);a!=null&&C(t,["displayName"],a);const l=j(n,["model"]);l!=null&&C(t,["model"],l);const o=j(n,["createTime"]);o!=null&&C(t,["createTime"],o);const f=j(n,["updateTime"]);f!=null&&C(t,["updateTime"],f);const u=j(n,["expireTime"]);u!=null&&C(t,["expireTime"],u);const d=j(n,["usageMetadata"]);return d!=null&&C(t,["usageMetadata"],d),t}function $6(){return{}}function z6(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&C(t,["nextPageToken"],r);const a=j(n,["cachedContents"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(o=>Vx(e,o))),C(t,["cachedContents"],l)}return t}function Hx(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["name"],r);const a=j(n,["displayName"]);a!=null&&C(t,["displayName"],a);const l=j(n,["model"]);l!=null&&C(t,["model"],l);const o=j(n,["createTime"]);o!=null&&C(t,["createTime"],o);const f=j(n,["updateTime"]);f!=null&&C(t,["updateTime"],f);const u=j(n,["expireTime"]);u!=null&&C(t,["expireTime"],u);const d=j(n,["usageMetadata"]);return d!=null&&C(t,["usageMetadata"],d),t}function B6(){return{}}function U6(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&C(t,["nextPageToken"],r);const a=j(n,["cachedContents"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(o=>Hx(e,o))),C(t,["cachedContents"],l)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var qh;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(qh||(qh={}));class Rb{constructor(n,t,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(n,r,a)}init(n,t,r){var a,l;this.nameInternal=n,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let o={config:{}};r?typeof r=="object"?o=Object.assign({},r):o=r:o={config:{}},o.config&&(o.config.pageToken=t.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(l=(a=o.config)===null||a===void 0?void 0:a.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(n){this.init(this.nameInternal,n,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(n){return this.pageInternal[n]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const n=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:n,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const n=await this.requestInternal(this.params);return this.initNextPage(n),this.page}hasNextPage(){var n;return((n=this.params.config)===null||n===void 0?void 0:n.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var mS;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(mS||(mS={}));var gS;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(gS||(gS={}));var yS;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(yS||(yS={}));var xS;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(xS||(xS={}));var bS;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(bS||(bS={}));var vS;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(vS||(vS={}));var wS;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(wS||(wS={}));var Vh;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT"})(Vh||(Vh={}));var NS;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY"})(NS||(NS={}));var SS;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(SS||(SS={}));var jS;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(jS||(jS={}));var CS;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(CS||(CS={}));var _S;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(_S||(_S={}));var nu;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(nu||(nu={}));var kS;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(kS||(kS={}));var i1;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(i1||(i1={}));var ES;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(ES||(ES={}));var TS;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(TS||(TS={}));var AS;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(AS||(AS={}));var DS;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(DS||(DS={}));var PS;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(PS||(PS={}));var IS;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(IS||(IS={}));var MS;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi"})(MS||(MS={}));var RS;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(RS||(RS={}));var LS;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(LS||(LS={}));var OS;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(OS||(OS={}));var FS;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(FS||(FS={}));var $S;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})($S||($S={}));var zS;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(zS||(zS={}));var BS;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(BS||(BS={}));var US;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(US||(US={}));var qS;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(qS||(qS={}));var VS;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(VS||(VS={}));var HS;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(HS||(HS={}));class Nx{get text(){var n,t,r,a,l,o,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",h=!1;const g=[];for(const b of(u=(f=(o=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||o===void 0?void 0:o.content)===null||f===void 0?void 0:f.parts)!==null&&u!==void 0?u:[]){for(const[v,S]of Object.entries(b))v!=="text"&&v!=="thought"&&(S!==null||S!==void 0)&&g.push(v);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;h=!0,d+=b.text}}return g.length>0&&console.warn(`there are non-text parts ${g} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?d:void 0}get data(){var n,t,r,a,l,o,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const h=[];for(const g of(u=(f=(o=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||o===void 0?void 0:o.content)===null||f===void 0?void 0:f.parts)!==null&&u!==void 0?u:[]){for(const[b,v]of Object.entries(g))b!=="inlineData"&&(v!==null||v!==void 0)&&h.push(b);g.inlineData&&typeof g.inlineData.data=="string"&&(d+=atob(g.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var n,t,r,a,l,o,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(u=(f=(o=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||o===void 0?void 0:o.content)===null||f===void 0?void 0:f.parts)===null||u===void 0?void 0:u.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var n,t,r,a,l,o,f,u,d;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(u=(f=(o=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||o===void 0?void 0:o.content)===null||f===void 0?void 0:f.parts)===null||u===void 0?void 0:u.filter(g=>g.executableCode).map(g=>g.executableCode).filter(g=>g!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var n,t,r,a,l,o,f,u,d;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(u=(f=(o=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||o===void 0?void 0:o.content)===null||f===void 0?void 0:f.parts)===null||u===void 0?void 0:u.filter(g=>g.codeExecutionResult).map(g=>g.codeExecutionResult).filter(g=>g!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.output}}class GS{}class YS{}class q6{}class V6{}class WS{}class QS{}class JS{}class H6{}class KS{}class XS{}class ZS{}class G6{}class r1{constructor(n){const t={};for(const r of n.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=n}json(){return this.responseInternal.json()}}class Y6{}class W6{}class Q6{get text(){var n,t,r;let a="",l=!1;const o=[];for(const f of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[u,d]of Object.entries(f))u!=="text"&&u!=="thought"&&d!==null&&o.push(u);if(typeof f.text=="string"){if(typeof f.thought=="boolean"&&f.thought)continue;l=!0,a+=f.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?a:void 0}get data(){var n,t,r;let a="";const l=[];for(const o of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[f,u]of Object.entries(o))f!=="inlineData"&&u!==null&&l.push(f);o.inlineData&&typeof o.inlineData.data=="string"&&(a+=atob(o.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class J6 extends hg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Rb(qh.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=P6(this.apiClient,n);return f=Bt("cachedContents",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>Hx(this.apiClient,h))}else{const d=u6(this.apiClient,n);return f=Bt("cachedContents",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>Vx(this.apiClient,h))}}async get(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=I6(this.apiClient,n);return f=Bt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>Hx(this.apiClient,h))}else{const d=d6(this.apiClient,n);return f=Bt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>Vx(this.apiClient,h))}}async delete(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=M6(this.apiClient,n);return f=Bt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(()=>{const h=B6(),g=new XS;return Object.assign(g,h),g})}else{const d=f6(this.apiClient,n);return f=Bt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(()=>{const h=$6(),g=new XS;return Object.assign(g,h),g})}}async update(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=L6(this.apiClient,n);return f=Bt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>Hx(this.apiClient,h))}else{const d=p6(this.apiClient,n);return f=Bt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>Vx(this.apiClient,h))}}async listInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=F6(this.apiClient,n);return f=Bt("cachedContents",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=U6(this.apiClient,h),b=new ZS;return Object.assign(b,g),b})}else{const d=g6(this.apiClient,n);return f=Bt("cachedContents",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=z6(this.apiClient,h),b=new ZS;return Object.assign(b,g),b})}}}function ej(e){var n=typeof Symbol=="function"&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pr(e){return this instanceof Pr?(this.v=e,this):new Pr(e)}function fb(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(e,n||[]),a,l=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),f("next"),f("throw"),f("return",o),a[Symbol.asyncIterator]=function(){return this},a;function o(v){return function(S){return Promise.resolve(S).then(v,g)}}function f(v,S){r[v]&&(a[v]=function(k){return new Promise(function(T,E){l.push([v,k,T,E])>1||u(v,k)})},S&&(a[v]=S(a[v])))}function u(v,S){try{d(r[v](S))}catch(k){b(l[0][3],k)}}function d(v){v.value instanceof Pr?Promise.resolve(v.value.v).then(h,g):b(l[0][2],v)}function h(v){u("next",v)}function g(v){u("throw",v)}function b(v,S){v(S),l.shift(),l.length&&u(l[0][0],l[0][1])}}function a1(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e[Symbol.asyncIterator],t;return n?n.call(e):(e=typeof ej=="function"?ej(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(l){t[l]=e[l]&&function(o){return new Promise(function(f,u){o=e[l](o),a(f,u,o.done,o.value)})}}function a(l,o,f,u){Promise.resolve(u).then(function(d){l({value:d,done:f})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function K6(e){var n;if(e.candidates==null||e.candidates.length===0)return!1;const t=(n=e.candidates[0])===null||n===void 0?void 0:n.content;return t===void 0?!1:G2(t)}function G2(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const n of e.parts)if(n===void 0||Object.keys(n).length===0||n.text!==void 0&&n.text==="")return!1;return!0}function X6(e){if(e.length!==0){if(e[0].role!=="user")throw new Error("History must start with a user turn.");for(const n of e)if(n.role!=="user"&&n.role!=="model")throw new Error(`Role must be user or model, but got ${n.role}.`)}}function Z6(e){if(e===void 0||e.length===0)return[];const n=[],t=e.length;let r=0,a=e[0];for(;r<t;)if(e[r].role==="user")a=e[r],r++;else{const l=[];let o=!0;for(;r<t&&e[r].role==="model";)l.push(e[r]),o&&!G2(e[r])&&(o=!1),r++;o&&(n.push(a),n.push(...l))}return n}class e5{constructor(n,t){this.modelsModule=n,this.apiClient=t}create(n){return new t5(this.apiClient,this.modelsModule,n.model,n.config,n.history)}}class t5{constructor(n,t,r,a={},l=[]){this.apiClient=n,this.modelsModule=t,this.model=r,this.config=a,this.history=l,this.sendPromise=Promise.resolve(),X6(l)}async sendMessage(n){var t;await this.sendPromise;const r=pa(this.apiClient,n.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var l,o;const u=(o=(l=(await a).candidates)===null||l===void 0?void 0:l[0])===null||o===void 0?void 0:o.content,d=u?[u]:[];this.recordHistory(r,d)})(),await this.sendPromise,a}async sendMessageStream(n){var t;await this.sendPromise;const r=pa(this.apiClient,n.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const l=await a;return this.processStreamResponse(l,r)}getHistory(n=!1){return n?Z6(this.history):this.history}processStreamResponse(n,t){var r,a;return fb(this,arguments,function*(){var o,f,u,d;const h=[];try{for(var g=!0,b=a1(n),v;v=yield Pr(b.next()),o=v.done,!o;g=!0){d=v.value,g=!1;const S=d;if(K6(S)){const k=(a=(r=S.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;k!==void 0&&h.push(k)}yield yield Pr(S)}}catch(S){f={error:S}}finally{try{!g&&!o&&(u=b.return)&&(yield Pr(u.call(b)))}finally{if(f)throw f.error}}this.recordHistory(t,h)})}recordHistory(n,t){let r=[];t.length>0&&t.every(a=>a.role==="model")?r=t:r.push({role:"model",parts:[]}),this.history.push(n),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function n5(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&C(t,["_query","pageSize"],a);const l=j(n,["pageToken"]);return t!==void 0&&l!=null&&C(t,["_query","pageToken"],l),r}function i5(e,n){const t={},r=j(n,["config"]);return r!=null&&C(t,["config"],n5(e,r,t)),t}function r5(e,n){const t={},r=j(n,["details"]);r!=null&&C(t,["details"],r);const a=j(n,["message"]);a!=null&&C(t,["message"],a);const l=j(n,["code"]);return l!=null&&C(t,["code"],l),t}function a5(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["name"],r);const a=j(n,["displayName"]);a!=null&&C(t,["displayName"],a);const l=j(n,["mimeType"]);l!=null&&C(t,["mimeType"],l);const o=j(n,["sizeBytes"]);o!=null&&C(t,["sizeBytes"],o);const f=j(n,["createTime"]);f!=null&&C(t,["createTime"],f);const u=j(n,["expirationTime"]);u!=null&&C(t,["expirationTime"],u);const d=j(n,["updateTime"]);d!=null&&C(t,["updateTime"],d);const h=j(n,["sha256Hash"]);h!=null&&C(t,["sha256Hash"],h);const g=j(n,["uri"]);g!=null&&C(t,["uri"],g);const b=j(n,["downloadUri"]);b!=null&&C(t,["downloadUri"],b);const v=j(n,["state"]);v!=null&&C(t,["state"],v);const S=j(n,["source"]);S!=null&&C(t,["source"],S);const k=j(n,["videoMetadata"]);k!=null&&C(t,["videoMetadata"],k);const T=j(n,["error"]);return T!=null&&C(t,["error"],r5(e,T)),t}function s5(e,n){const t={},r=j(n,["file"]);r!=null&&C(t,["file"],a5(e,r));const a=j(n,["config"]);return a!=null&&C(t,["config"],a),t}function l5(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["_url","file"],q2(e,r));const a=j(n,["config"]);return a!=null&&C(t,["config"],a),t}function o5(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["_url","file"],q2(e,r));const a=j(n,["config"]);return a!=null&&C(t,["config"],a),t}function c5(e,n){const t={},r=j(n,["details"]);r!=null&&C(t,["details"],r);const a=j(n,["message"]);a!=null&&C(t,["message"],a);const l=j(n,["code"]);return l!=null&&C(t,["code"],l),t}function s1(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["name"],r);const a=j(n,["displayName"]);a!=null&&C(t,["displayName"],a);const l=j(n,["mimeType"]);l!=null&&C(t,["mimeType"],l);const o=j(n,["sizeBytes"]);o!=null&&C(t,["sizeBytes"],o);const f=j(n,["createTime"]);f!=null&&C(t,["createTime"],f);const u=j(n,["expirationTime"]);u!=null&&C(t,["expirationTime"],u);const d=j(n,["updateTime"]);d!=null&&C(t,["updateTime"],d);const h=j(n,["sha256Hash"]);h!=null&&C(t,["sha256Hash"],h);const g=j(n,["uri"]);g!=null&&C(t,["uri"],g);const b=j(n,["downloadUri"]);b!=null&&C(t,["downloadUri"],b);const v=j(n,["state"]);v!=null&&C(t,["state"],v);const S=j(n,["source"]);S!=null&&C(t,["source"],S);const k=j(n,["videoMetadata"]);k!=null&&C(t,["videoMetadata"],k);const T=j(n,["error"]);return T!=null&&C(t,["error"],c5(e,T)),t}function u5(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&C(t,["nextPageToken"],r);const a=j(n,["files"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(o=>s1(e,o))),C(t,["files"],l)}return t}function d5(){return{}}function f5(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class h5 extends hg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Rb(qh.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(n){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(n.file,n.config).then(t=>s1(this.apiClient,t))}async download(n){await this.apiClient.downloadFile(n)}async listInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=i5(this.apiClient,n);return l=Bt("files",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>{const d=u5(this.apiClient,u),h=new G6;return Object.assign(h,d),h})}}async createInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=s5(this.apiClient,n);return l=Bt("upload/v1beta/files",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(()=>{const u=d5(),d=new Y6;return Object.assign(d,u),d})}}async get(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=l5(this.apiClient,n);return l=Bt("files/{file}",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>s1(this.apiClient,u))}}async delete(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=o5(this.apiClient,n);return l=Bt("files/{file}",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(()=>{const u=f5(),d=new W6;return Object.assign(d,u),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function p5(e,n){const t={};if(j(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=j(n,["data"]);r!=null&&C(t,["data"],r);const a=j(n,["mimeType"]);return a!=null&&C(t,["mimeType"],a),t}function m5(e,n){const t={},r=j(n,["displayName"]);r!=null&&C(t,["displayName"],r);const a=j(n,["data"]);a!=null&&C(t,["data"],a);const l=j(n,["mimeType"]);return l!=null&&C(t,["mimeType"],l),t}function g5(e,n){const t={};if(j(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=j(n,["thought"]);r!=null&&C(t,["thought"],r);const a=j(n,["inlineData"]);a!=null&&C(t,["inlineData"],p5(e,a));const l=j(n,["codeExecutionResult"]);l!=null&&C(t,["codeExecutionResult"],l);const o=j(n,["executableCode"]);o!=null&&C(t,["executableCode"],o);const f=j(n,["fileData"]);f!=null&&C(t,["fileData"],f);const u=j(n,["functionCall"]);u!=null&&C(t,["functionCall"],u);const d=j(n,["functionResponse"]);d!=null&&C(t,["functionResponse"],d);const h=j(n,["text"]);return h!=null&&C(t,["text"],h),t}function y5(e,n){const t={},r=j(n,["videoMetadata"]);r!=null&&C(t,["videoMetadata"],r);const a=j(n,["thought"]);a!=null&&C(t,["thought"],a);const l=j(n,["inlineData"]);l!=null&&C(t,["inlineData"],m5(e,l));const o=j(n,["codeExecutionResult"]);o!=null&&C(t,["codeExecutionResult"],o);const f=j(n,["executableCode"]);f!=null&&C(t,["executableCode"],f);const u=j(n,["fileData"]);u!=null&&C(t,["fileData"],u);const d=j(n,["functionCall"]);d!=null&&C(t,["functionCall"],d);const h=j(n,["functionResponse"]);h!=null&&C(t,["functionResponse"],h);const g=j(n,["text"]);return g!=null&&C(t,["text"],g),t}function x5(e,n){const t={},r=j(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>g5(e,o))),C(t,["parts"],l)}const a=j(n,["role"]);return a!=null&&C(t,["role"],a),t}function b5(e,n){const t={},r=j(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>y5(e,o))),C(t,["parts"],l)}const a=j(n,["role"]);return a!=null&&C(t,["role"],a),t}function v5(){return{}}function w5(){return{}}function N5(e,n){const t={},r=j(n,["mode"]);r!=null&&C(t,["mode"],r);const a=j(n,["dynamicThreshold"]);return a!=null&&C(t,["dynamicThreshold"],a),t}function S5(e,n){const t={},r=j(n,["mode"]);r!=null&&C(t,["mode"],r);const a=j(n,["dynamicThreshold"]);return a!=null&&C(t,["dynamicThreshold"],a),t}function j5(e,n){const t={},r=j(n,["dynamicRetrievalConfig"]);return r!=null&&C(t,["dynamicRetrievalConfig"],N5(e,r)),t}function C5(e,n){const t={},r=j(n,["dynamicRetrievalConfig"]);return r!=null&&C(t,["dynamicRetrievalConfig"],S5(e,r)),t}function _5(){return{}}function k5(e,n){const t={},r=j(n,["apiKeyString"]);return r!=null&&C(t,["apiKeyString"],r),t}function E5(e,n){const t={},r=j(n,["apiKeyConfig"]);r!=null&&C(t,["apiKeyConfig"],k5(e,r));const a=j(n,["authType"]);a!=null&&C(t,["authType"],a);const l=j(n,["googleServiceAccountConfig"]);l!=null&&C(t,["googleServiceAccountConfig"],l);const o=j(n,["httpBasicAuthConfig"]);o!=null&&C(t,["httpBasicAuthConfig"],o);const f=j(n,["oauthConfig"]);f!=null&&C(t,["oauthConfig"],f);const u=j(n,["oidcConfig"]);return u!=null&&C(t,["oidcConfig"],u),t}function T5(e,n){const t={},r=j(n,["authConfig"]);return r!=null&&C(t,["authConfig"],E5(e,r)),t}function A5(e,n){const t={};if(j(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");j(n,["googleSearch"])!=null&&C(t,["googleSearch"],v5());const a=j(n,["googleSearchRetrieval"]);if(a!=null&&C(t,["googleSearchRetrieval"],j5(e,a)),j(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(j(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=j(n,["codeExecution"]);l!=null&&C(t,["codeExecution"],l);const o=j(n,["functionDeclarations"]);return o!=null&&C(t,["functionDeclarations"],o),t}function D5(e,n){const t={},r=j(n,["retrieval"]);r!=null&&C(t,["retrieval"],r),j(n,["googleSearch"])!=null&&C(t,["googleSearch"],w5());const l=j(n,["googleSearchRetrieval"]);l!=null&&C(t,["googleSearchRetrieval"],C5(e,l)),j(n,["enterpriseWebSearch"])!=null&&C(t,["enterpriseWebSearch"],_5());const f=j(n,["googleMaps"]);f!=null&&C(t,["googleMaps"],T5(e,f));const u=j(n,["codeExecution"]);u!=null&&C(t,["codeExecution"],u);const d=j(n,["functionDeclarations"]);return d!=null&&C(t,["functionDeclarations"],d),t}function P5(e,n){const t={},r=j(n,["handle"]);if(r!=null&&C(t,["handle"],r),j(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function I5(e,n){const t={},r=j(n,["handle"]);r!=null&&C(t,["handle"],r);const a=j(n,["transparent"]);return a!=null&&C(t,["transparent"],a),t}function tj(){return{}}function nj(){return{}}function M5(e,n){const t={},r=j(n,["disabled"]);r!=null&&C(t,["disabled"],r);const a=j(n,["startOfSpeechSensitivity"]);a!=null&&C(t,["startOfSpeechSensitivity"],a);const l=j(n,["endOfSpeechSensitivity"]);l!=null&&C(t,["endOfSpeechSensitivity"],l);const o=j(n,["prefixPaddingMs"]);o!=null&&C(t,["prefixPaddingMs"],o);const f=j(n,["silenceDurationMs"]);return f!=null&&C(t,["silenceDurationMs"],f),t}function R5(e,n){const t={},r=j(n,["disabled"]);r!=null&&C(t,["disabled"],r);const a=j(n,["startOfSpeechSensitivity"]);a!=null&&C(t,["startOfSpeechSensitivity"],a);const l=j(n,["endOfSpeechSensitivity"]);l!=null&&C(t,["endOfSpeechSensitivity"],l);const o=j(n,["prefixPaddingMs"]);o!=null&&C(t,["prefixPaddingMs"],o);const f=j(n,["silenceDurationMs"]);return f!=null&&C(t,["silenceDurationMs"],f),t}function L5(e,n){const t={},r=j(n,["automaticActivityDetection"]);r!=null&&C(t,["automaticActivityDetection"],M5(e,r));const a=j(n,["activityHandling"]);a!=null&&C(t,["activityHandling"],a);const l=j(n,["turnCoverage"]);return l!=null&&C(t,["turnCoverage"],l),t}function O5(e,n){const t={},r=j(n,["automaticActivityDetection"]);r!=null&&C(t,["automaticActivityDetection"],R5(e,r));const a=j(n,["activityHandling"]);a!=null&&C(t,["activityHandling"],a);const l=j(n,["turnCoverage"]);return l!=null&&C(t,["turnCoverage"],l),t}function F5(e,n){const t={},r=j(n,["targetTokens"]);return r!=null&&C(t,["targetTokens"],r),t}function $5(e,n){const t={},r=j(n,["targetTokens"]);return r!=null&&C(t,["targetTokens"],r),t}function z5(e,n){const t={},r=j(n,["triggerTokens"]);r!=null&&C(t,["triggerTokens"],r);const a=j(n,["slidingWindow"]);return a!=null&&C(t,["slidingWindow"],F5(e,a)),t}function B5(e,n){const t={},r=j(n,["triggerTokens"]);r!=null&&C(t,["triggerTokens"],r);const a=j(n,["slidingWindow"]);return a!=null&&C(t,["slidingWindow"],$5(e,a)),t}function U5(e,n,t){const r={},a=j(n,["generationConfig"]);t!==void 0&&a!=null&&C(t,["setup","generationConfig"],a);const l=j(n,["responseModalities"]);t!==void 0&&l!=null&&C(t,["setup","generationConfig","responseModalities"],l);const o=j(n,["temperature"]);t!==void 0&&o!=null&&C(t,["setup","generationConfig","temperature"],o);const f=j(n,["topP"]);t!==void 0&&f!=null&&C(t,["setup","generationConfig","topP"],f);const u=j(n,["topK"]);t!==void 0&&u!=null&&C(t,["setup","generationConfig","topK"],u);const d=j(n,["maxOutputTokens"]);t!==void 0&&d!=null&&C(t,["setup","generationConfig","maxOutputTokens"],d);const h=j(n,["mediaResolution"]);t!==void 0&&h!=null&&C(t,["setup","generationConfig","mediaResolution"],h);const g=j(n,["seed"]);t!==void 0&&g!=null&&C(t,["setup","generationConfig","seed"],g);const b=j(n,["speechConfig"]);t!==void 0&&b!=null&&C(t,["setup","generationConfig","speechConfig"],b);const v=j(n,["systemInstruction"]);t!==void 0&&v!=null&&C(t,["setup","systemInstruction"],x5(e,pa(e,v)));const S=j(n,["tools"]);if(t!==void 0&&S!=null){let V=Mb(e,S);Array.isArray(V)&&(V=V.map(F=>A5(e,Ib(e,F)))),C(t,["setup","tools"],V)}const k=j(n,["sessionResumption"]);t!==void 0&&k!=null&&C(t,["setup","sessionResumption"],P5(e,k));const T=j(n,["inputAudioTranscription"]);t!==void 0&&T!=null&&C(t,["setup","inputAudioTranscription"],tj());const E=j(n,["outputAudioTranscription"]);t!==void 0&&E!=null&&C(t,["setup","outputAudioTranscription"],tj());const P=j(n,["realtimeInputConfig"]);t!==void 0&&P!=null&&C(t,["setup","realtimeInputConfig"],L5(e,P));const I=j(n,["contextWindowCompression"]);return t!==void 0&&I!=null&&C(t,["setup","contextWindowCompression"],z5(e,I)),r}function q5(e,n,t){const r={},a=j(n,["generationConfig"]);t!==void 0&&a!=null&&C(t,["setup","generationConfig"],a);const l=j(n,["responseModalities"]);t!==void 0&&l!=null&&C(t,["setup","generationConfig","responseModalities"],l);const o=j(n,["temperature"]);t!==void 0&&o!=null&&C(t,["setup","generationConfig","temperature"],o);const f=j(n,["topP"]);t!==void 0&&f!=null&&C(t,["setup","generationConfig","topP"],f);const u=j(n,["topK"]);t!==void 0&&u!=null&&C(t,["setup","generationConfig","topK"],u);const d=j(n,["maxOutputTokens"]);t!==void 0&&d!=null&&C(t,["setup","generationConfig","maxOutputTokens"],d);const h=j(n,["mediaResolution"]);t!==void 0&&h!=null&&C(t,["setup","generationConfig","mediaResolution"],h);const g=j(n,["seed"]);t!==void 0&&g!=null&&C(t,["setup","generationConfig","seed"],g);const b=j(n,["speechConfig"]);t!==void 0&&b!=null&&C(t,["setup","generationConfig","speechConfig"],b);const v=j(n,["systemInstruction"]);t!==void 0&&v!=null&&C(t,["setup","systemInstruction"],b5(e,pa(e,v)));const S=j(n,["tools"]);if(t!==void 0&&S!=null){let V=Mb(e,S);Array.isArray(V)&&(V=V.map(F=>D5(e,Ib(e,F)))),C(t,["setup","tools"],V)}const k=j(n,["sessionResumption"]);t!==void 0&&k!=null&&C(t,["setup","sessionResumption"],I5(e,k));const T=j(n,["inputAudioTranscription"]);t!==void 0&&T!=null&&C(t,["setup","inputAudioTranscription"],nj());const E=j(n,["outputAudioTranscription"]);t!==void 0&&E!=null&&C(t,["setup","outputAudioTranscription"],nj());const P=j(n,["realtimeInputConfig"]);t!==void 0&&P!=null&&C(t,["setup","realtimeInputConfig"],O5(e,P));const I=j(n,["contextWindowCompression"]);return t!==void 0&&I!=null&&C(t,["setup","contextWindowCompression"],B5(e,I)),r}function V5(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["setup","model"],wi(e,r));const a=j(n,["config"]);return a!=null&&C(t,["config"],U5(e,a,t)),t}function H5(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["setup","model"],wi(e,r));const a=j(n,["config"]);return a!=null&&C(t,["config"],q5(e,a,t)),t}function G5(){return{}}function Y5(){return{}}function W5(){return{}}function Q5(){return{}}function J5(e,n){const t={},r=j(n,["media"]);r!=null&&C(t,["mediaChunks"],O2(e,r));const a=j(n,["audio"]);a!=null&&C(t,["audio"],QF(e,a));const l=j(n,["audioStreamEnd"]);l!=null&&C(t,["audioStreamEnd"],l);const o=j(n,["video"]);o!=null&&C(t,["video"],WF(e,o));const f=j(n,["text"]);return f!=null&&C(t,["text"],f),j(n,["activityStart"])!=null&&C(t,["activityStart"],G5()),j(n,["activityEnd"])!=null&&C(t,["activityEnd"],W5()),t}function K5(e,n){const t={},r=j(n,["media"]);if(r!=null&&C(t,["mediaChunks"],O2(e,r)),j(n,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const a=j(n,["audioStreamEnd"]);if(a!=null&&C(t,["audioStreamEnd"],a),j(n,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(j(n,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return j(n,["activityStart"])!=null&&C(t,["activityStart"],Y5()),j(n,["activityEnd"])!=null&&C(t,["activityEnd"],Q5()),t}function X5(){return{}}function Z5(){return{}}function e$(e,n){const t={},r=j(n,["data"]);r!=null&&C(t,["data"],r);const a=j(n,["mimeType"]);return a!=null&&C(t,["mimeType"],a),t}function t$(e,n){const t={},r=j(n,["displayName"]);r!=null&&C(t,["displayName"],r);const a=j(n,["data"]);a!=null&&C(t,["data"],a);const l=j(n,["mimeType"]);return l!=null&&C(t,["mimeType"],l),t}function n$(e,n){const t={},r=j(n,["thought"]);r!=null&&C(t,["thought"],r);const a=j(n,["inlineData"]);a!=null&&C(t,["inlineData"],e$(e,a));const l=j(n,["codeExecutionResult"]);l!=null&&C(t,["codeExecutionResult"],l);const o=j(n,["executableCode"]);o!=null&&C(t,["executableCode"],o);const f=j(n,["fileData"]);f!=null&&C(t,["fileData"],f);const u=j(n,["functionCall"]);u!=null&&C(t,["functionCall"],u);const d=j(n,["functionResponse"]);d!=null&&C(t,["functionResponse"],d);const h=j(n,["text"]);return h!=null&&C(t,["text"],h),t}function i$(e,n){const t={},r=j(n,["videoMetadata"]);r!=null&&C(t,["videoMetadata"],r);const a=j(n,["thought"]);a!=null&&C(t,["thought"],a);const l=j(n,["inlineData"]);l!=null&&C(t,["inlineData"],t$(e,l));const o=j(n,["codeExecutionResult"]);o!=null&&C(t,["codeExecutionResult"],o);const f=j(n,["executableCode"]);f!=null&&C(t,["executableCode"],f);const u=j(n,["fileData"]);u!=null&&C(t,["fileData"],u);const d=j(n,["functionCall"]);d!=null&&C(t,["functionCall"],d);const h=j(n,["functionResponse"]);h!=null&&C(t,["functionResponse"],h);const g=j(n,["text"]);return g!=null&&C(t,["text"],g),t}function r$(e,n){const t={},r=j(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>n$(e,o))),C(t,["parts"],l)}const a=j(n,["role"]);return a!=null&&C(t,["role"],a),t}function a$(e,n){const t={},r=j(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>i$(e,o))),C(t,["parts"],l)}const a=j(n,["role"]);return a!=null&&C(t,["role"],a),t}function ij(e,n){const t={},r=j(n,["text"]);r!=null&&C(t,["text"],r);const a=j(n,["finished"]);return a!=null&&C(t,["finished"],a),t}function rj(e,n){const t={},r=j(n,["text"]);r!=null&&C(t,["text"],r);const a=j(n,["finished"]);return a!=null&&C(t,["finished"],a),t}function s$(e,n){const t={},r=j(n,["modelTurn"]);r!=null&&C(t,["modelTurn"],r$(e,r));const a=j(n,["turnComplete"]);a!=null&&C(t,["turnComplete"],a);const l=j(n,["interrupted"]);l!=null&&C(t,["interrupted"],l);const o=j(n,["groundingMetadata"]);o!=null&&C(t,["groundingMetadata"],o);const f=j(n,["generationComplete"]);f!=null&&C(t,["generationComplete"],f);const u=j(n,["inputTranscription"]);u!=null&&C(t,["inputTranscription"],ij(e,u));const d=j(n,["outputTranscription"]);return d!=null&&C(t,["outputTranscription"],ij(e,d)),t}function l$(e,n){const t={},r=j(n,["modelTurn"]);r!=null&&C(t,["modelTurn"],a$(e,r));const a=j(n,["turnComplete"]);a!=null&&C(t,["turnComplete"],a);const l=j(n,["interrupted"]);l!=null&&C(t,["interrupted"],l);const o=j(n,["groundingMetadata"]);o!=null&&C(t,["groundingMetadata"],o);const f=j(n,["generationComplete"]);f!=null&&C(t,["generationComplete"],f);const u=j(n,["inputTranscription"]);u!=null&&C(t,["inputTranscription"],rj(e,u));const d=j(n,["outputTranscription"]);return d!=null&&C(t,["outputTranscription"],rj(e,d)),t}function o$(e,n){const t={},r=j(n,["id"]);r!=null&&C(t,["id"],r);const a=j(n,["args"]);a!=null&&C(t,["args"],a);const l=j(n,["name"]);return l!=null&&C(t,["name"],l),t}function c$(e,n){const t={},r=j(n,["args"]);r!=null&&C(t,["args"],r);const a=j(n,["name"]);return a!=null&&C(t,["name"],a),t}function u$(e,n){const t={},r=j(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>o$(e,l))),C(t,["functionCalls"],a)}return t}function d$(e,n){const t={},r=j(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>c$(e,l))),C(t,["functionCalls"],a)}return t}function f$(e,n){const t={},r=j(n,["ids"]);return r!=null&&C(t,["ids"],r),t}function h$(e,n){const t={},r=j(n,["ids"]);return r!=null&&C(t,["ids"],r),t}function Sx(e,n){const t={},r=j(n,["modality"]);r!=null&&C(t,["modality"],r);const a=j(n,["tokenCount"]);return a!=null&&C(t,["tokenCount"],a),t}function jx(e,n){const t={},r=j(n,["modality"]);r!=null&&C(t,["modality"],r);const a=j(n,["tokenCount"]);return a!=null&&C(t,["tokenCount"],a),t}function p$(e,n){const t={},r=j(n,["promptTokenCount"]);r!=null&&C(t,["promptTokenCount"],r);const a=j(n,["cachedContentTokenCount"]);a!=null&&C(t,["cachedContentTokenCount"],a);const l=j(n,["responseTokenCount"]);l!=null&&C(t,["responseTokenCount"],l);const o=j(n,["toolUsePromptTokenCount"]);o!=null&&C(t,["toolUsePromptTokenCount"],o);const f=j(n,["thoughtsTokenCount"]);f!=null&&C(t,["thoughtsTokenCount"],f);const u=j(n,["totalTokenCount"]);u!=null&&C(t,["totalTokenCount"],u);const d=j(n,["promptTokensDetails"]);if(d!=null){let v=d;Array.isArray(v)&&(v=v.map(S=>Sx(e,S))),C(t,["promptTokensDetails"],v)}const h=j(n,["cacheTokensDetails"]);if(h!=null){let v=h;Array.isArray(v)&&(v=v.map(S=>Sx(e,S))),C(t,["cacheTokensDetails"],v)}const g=j(n,["responseTokensDetails"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(S=>Sx(e,S))),C(t,["responseTokensDetails"],v)}const b=j(n,["toolUsePromptTokensDetails"]);if(b!=null){let v=b;Array.isArray(v)&&(v=v.map(S=>Sx(e,S))),C(t,["toolUsePromptTokensDetails"],v)}return t}function m$(e,n){const t={},r=j(n,["promptTokenCount"]);r!=null&&C(t,["promptTokenCount"],r);const a=j(n,["cachedContentTokenCount"]);a!=null&&C(t,["cachedContentTokenCount"],a);const l=j(n,["candidatesTokenCount"]);l!=null&&C(t,["responseTokenCount"],l);const o=j(n,["toolUsePromptTokenCount"]);o!=null&&C(t,["toolUsePromptTokenCount"],o);const f=j(n,["thoughtsTokenCount"]);f!=null&&C(t,["thoughtsTokenCount"],f);const u=j(n,["totalTokenCount"]);u!=null&&C(t,["totalTokenCount"],u);const d=j(n,["promptTokensDetails"]);if(d!=null){let S=d;Array.isArray(S)&&(S=S.map(k=>jx(e,k))),C(t,["promptTokensDetails"],S)}const h=j(n,["cacheTokensDetails"]);if(h!=null){let S=h;Array.isArray(S)&&(S=S.map(k=>jx(e,k))),C(t,["cacheTokensDetails"],S)}const g=j(n,["candidatesTokensDetails"]);if(g!=null){let S=g;Array.isArray(S)&&(S=S.map(k=>jx(e,k))),C(t,["responseTokensDetails"],S)}const b=j(n,["toolUsePromptTokensDetails"]);if(b!=null){let S=b;Array.isArray(S)&&(S=S.map(k=>jx(e,k))),C(t,["toolUsePromptTokensDetails"],S)}const v=j(n,["trafficType"]);return v!=null&&C(t,["trafficType"],v),t}function g$(e,n){const t={},r=j(n,["timeLeft"]);return r!=null&&C(t,["timeLeft"],r),t}function y$(e,n){const t={},r=j(n,["timeLeft"]);return r!=null&&C(t,["timeLeft"],r),t}function x$(e,n){const t={},r=j(n,["newHandle"]);r!=null&&C(t,["newHandle"],r);const a=j(n,["resumable"]);a!=null&&C(t,["resumable"],a);const l=j(n,["lastConsumedClientMessageIndex"]);return l!=null&&C(t,["lastConsumedClientMessageIndex"],l),t}function b$(e,n){const t={},r=j(n,["newHandle"]);r!=null&&C(t,["newHandle"],r);const a=j(n,["resumable"]);a!=null&&C(t,["resumable"],a);const l=j(n,["lastConsumedClientMessageIndex"]);return l!=null&&C(t,["lastConsumedClientMessageIndex"],l),t}function v$(e,n){const t={};j(n,["setupComplete"])!=null&&C(t,["setupComplete"],X5());const a=j(n,["serverContent"]);a!=null&&C(t,["serverContent"],s$(e,a));const l=j(n,["toolCall"]);l!=null&&C(t,["toolCall"],u$(e,l));const o=j(n,["toolCallCancellation"]);o!=null&&C(t,["toolCallCancellation"],f$(e,o));const f=j(n,["usageMetadata"]);f!=null&&C(t,["usageMetadata"],p$(e,f));const u=j(n,["goAway"]);u!=null&&C(t,["goAway"],g$(e,u));const d=j(n,["sessionResumptionUpdate"]);return d!=null&&C(t,["sessionResumptionUpdate"],x$(e,d)),t}function w$(e,n){const t={};j(n,["setupComplete"])!=null&&C(t,["setupComplete"],Z5());const a=j(n,["serverContent"]);a!=null&&C(t,["serverContent"],l$(e,a));const l=j(n,["toolCall"]);l!=null&&C(t,["toolCall"],d$(e,l));const o=j(n,["toolCallCancellation"]);o!=null&&C(t,["toolCallCancellation"],h$(e,o));const f=j(n,["usageMetadata"]);f!=null&&C(t,["usageMetadata"],m$(e,f));const u=j(n,["goAway"]);u!=null&&C(t,["goAway"],y$(e,u));const d=j(n,["sessionResumptionUpdate"]);return d!=null&&C(t,["sessionResumptionUpdate"],b$(e,d)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function N$(e,n){const t={};if(j(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=j(n,["data"]);r!=null&&C(t,["data"],r);const a=j(n,["mimeType"]);return a!=null&&C(t,["mimeType"],a),t}function S$(e,n){const t={};if(j(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=j(n,["thought"]);r!=null&&C(t,["thought"],r);const a=j(n,["inlineData"]);a!=null&&C(t,["inlineData"],N$(e,a));const l=j(n,["codeExecutionResult"]);l!=null&&C(t,["codeExecutionResult"],l);const o=j(n,["executableCode"]);o!=null&&C(t,["executableCode"],o);const f=j(n,["fileData"]);f!=null&&C(t,["fileData"],f);const u=j(n,["functionCall"]);u!=null&&C(t,["functionCall"],u);const d=j(n,["functionResponse"]);d!=null&&C(t,["functionResponse"],d);const h=j(n,["text"]);return h!=null&&C(t,["text"],h),t}function Lb(e,n){const t={},r=j(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>S$(e,o))),C(t,["parts"],l)}const a=j(n,["role"]);return a!=null&&C(t,["role"],a),t}function j$(e,n){const t={};if(j(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=j(n,["category"]);r!=null&&C(t,["category"],r);const a=j(n,["threshold"]);return a!=null&&C(t,["threshold"],a),t}function C$(){return{}}function _$(e,n){const t={},r=j(n,["mode"]);r!=null&&C(t,["mode"],r);const a=j(n,["dynamicThreshold"]);return a!=null&&C(t,["dynamicThreshold"],a),t}function k$(e,n){const t={},r=j(n,["dynamicRetrievalConfig"]);return r!=null&&C(t,["dynamicRetrievalConfig"],_$(e,r)),t}function E$(e,n){const t={};if(j(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");j(n,["googleSearch"])!=null&&C(t,["googleSearch"],C$());const a=j(n,["googleSearchRetrieval"]);if(a!=null&&C(t,["googleSearchRetrieval"],k$(e,a)),j(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(j(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=j(n,["codeExecution"]);l!=null&&C(t,["codeExecution"],l);const o=j(n,["functionDeclarations"]);return o!=null&&C(t,["functionDeclarations"],o),t}function T$(e,n){const t={},r=j(n,["mode"]);r!=null&&C(t,["mode"],r);const a=j(n,["allowedFunctionNames"]);return a!=null&&C(t,["allowedFunctionNames"],a),t}function A$(e,n){const t={},r=j(n,["functionCallingConfig"]);if(r!=null&&C(t,["functionCallingConfig"],T$(e,r)),j(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function D$(e,n){const t={},r=j(n,["voiceName"]);return r!=null&&C(t,["voiceName"],r),t}function P$(e,n){const t={},r=j(n,["prebuiltVoiceConfig"]);return r!=null&&C(t,["prebuiltVoiceConfig"],D$(e,r)),t}function I$(e,n){const t={},r=j(n,["voiceConfig"]);r!=null&&C(t,["voiceConfig"],P$(e,r));const a=j(n,["languageCode"]);return a!=null&&C(t,["languageCode"],a),t}function M$(e,n){const t={},r=j(n,["includeThoughts"]);r!=null&&C(t,["includeThoughts"],r);const a=j(n,["thinkingBudget"]);return a!=null&&C(t,["thinkingBudget"],a),t}function R$(e,n,t){const r={},a=j(n,["systemInstruction"]);t!==void 0&&a!=null&&C(t,["systemInstruction"],Lb(e,pa(e,a)));const l=j(n,["temperature"]);l!=null&&C(r,["temperature"],l);const o=j(n,["topP"]);o!=null&&C(r,["topP"],o);const f=j(n,["topK"]);f!=null&&C(r,["topK"],f);const u=j(n,["candidateCount"]);u!=null&&C(r,["candidateCount"],u);const d=j(n,["maxOutputTokens"]);d!=null&&C(r,["maxOutputTokens"],d);const h=j(n,["stopSequences"]);h!=null&&C(r,["stopSequences"],h);const g=j(n,["responseLogprobs"]);g!=null&&C(r,["responseLogprobs"],g);const b=j(n,["logprobs"]);b!=null&&C(r,["logprobs"],b);const v=j(n,["presencePenalty"]);v!=null&&C(r,["presencePenalty"],v);const S=j(n,["frequencyPenalty"]);S!=null&&C(r,["frequencyPenalty"],S);const k=j(n,["seed"]);k!=null&&C(r,["seed"],k);const T=j(n,["responseMimeType"]);T!=null&&C(r,["responseMimeType"],T);const E=j(n,["responseSchema"]);if(E!=null&&C(r,["responseSchema"],z2(e,E)),j(n,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(j(n,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=j(n,["safetySettings"]);if(t!==void 0&&P!=null){let $=P;Array.isArray($)&&($=$.map(R=>j$(e,R))),C(t,["safetySettings"],$)}const I=j(n,["tools"]);if(t!==void 0&&I!=null){let $=Mb(e,I);Array.isArray($)&&($=$.map(R=>E$(e,Ib(e,R)))),C(t,["tools"],$)}const V=j(n,["toolConfig"]);if(t!==void 0&&V!=null&&C(t,["toolConfig"],A$(e,V)),j(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const F=j(n,["cachedContent"]);t!==void 0&&F!=null&&C(t,["cachedContent"],au(e,F));const O=j(n,["responseModalities"]);O!=null&&C(r,["responseModalities"],O);const B=j(n,["mediaResolution"]);B!=null&&C(r,["mediaResolution"],B);const U=j(n,["speechConfig"]);if(U!=null&&C(r,["speechConfig"],I$(e,B2(e,U))),j(n,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const z=j(n,["thinkingConfig"]);return z!=null&&C(r,["thinkingConfig"],M$(e,z)),r}function aj(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["_url","model"],wi(e,r));const a=j(n,["contents"]);if(a!=null){let o=ru(e,a);Array.isArray(o)&&(o=o.map(f=>Lb(e,f))),C(t,["contents"],o)}const l=j(n,["config"]);return l!=null&&C(t,["generationConfig"],R$(e,l,t)),t}function L$(e,n,t){const r={},a=j(n,["taskType"]);t!==void 0&&a!=null&&C(t,["requests[]","taskType"],a);const l=j(n,["title"]);t!==void 0&&l!=null&&C(t,["requests[]","title"],l);const o=j(n,["outputDimensionality"]);if(t!==void 0&&o!=null&&C(t,["requests[]","outputDimensionality"],o),j(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(j(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function O$(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["_url","model"],wi(e,r));const a=j(n,["contents"]);a!=null&&C(t,["requests[]","content"],$2(e,a));const l=j(n,["config"]);l!=null&&C(t,["config"],L$(e,l,t));const o=j(n,["model"]);return o!==void 0&&C(t,["requests[]","model"],wi(e,o)),t}function F$(e,n,t){const r={};if(j(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(j(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const a=j(n,["numberOfImages"]);t!==void 0&&a!=null&&C(t,["parameters","sampleCount"],a);const l=j(n,["aspectRatio"]);t!==void 0&&l!=null&&C(t,["parameters","aspectRatio"],l);const o=j(n,["guidanceScale"]);if(t!==void 0&&o!=null&&C(t,["parameters","guidanceScale"],o),j(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const f=j(n,["safetyFilterLevel"]);t!==void 0&&f!=null&&C(t,["parameters","safetySetting"],f);const u=j(n,["personGeneration"]);t!==void 0&&u!=null&&C(t,["parameters","personGeneration"],u);const d=j(n,["includeSafetyAttributes"]);t!==void 0&&d!=null&&C(t,["parameters","includeSafetyAttributes"],d);const h=j(n,["includeRaiReason"]);t!==void 0&&h!=null&&C(t,["parameters","includeRaiReason"],h);const g=j(n,["language"]);t!==void 0&&g!=null&&C(t,["parameters","language"],g);const b=j(n,["outputMimeType"]);t!==void 0&&b!=null&&C(t,["parameters","outputOptions","mimeType"],b);const v=j(n,["outputCompressionQuality"]);if(t!==void 0&&v!=null&&C(t,["parameters","outputOptions","compressionQuality"],v),j(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(j(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function $$(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["_url","model"],wi(e,r));const a=j(n,["prompt"]);a!=null&&C(t,["instances[0]","prompt"],a);const l=j(n,["config"]);return l!=null&&C(t,["config"],F$(e,l,t)),t}function z$(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["_url","name"],wi(e,r));const a=j(n,["config"]);return a!=null&&C(t,["config"],a),t}function B$(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&C(t,["_query","pageSize"],a);const l=j(n,["pageToken"]);t!==void 0&&l!=null&&C(t,["_query","pageToken"],l);const o=j(n,["filter"]);t!==void 0&&o!=null&&C(t,["_query","filter"],o);const f=j(n,["queryBase"]);return t!==void 0&&f!=null&&C(t,["_url","models_url"],V2(e,f)),r}function U$(e,n){const t={},r=j(n,["config"]);return r!=null&&C(t,["config"],B$(e,r,t)),t}function q$(e,n,t){const r={},a=j(n,["displayName"]);t!==void 0&&a!=null&&C(t,["displayName"],a);const l=j(n,["description"]);t!==void 0&&l!=null&&C(t,["description"],l);const o=j(n,["defaultCheckpointId"]);return t!==void 0&&o!=null&&C(t,["defaultCheckpointId"],o),r}function V$(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["_url","name"],wi(e,r));const a=j(n,["config"]);return a!=null&&C(t,["config"],q$(e,a,t)),t}function H$(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["_url","name"],wi(e,r));const a=j(n,["config"]);return a!=null&&C(t,["config"],a),t}function G$(e,n){const t={};if(j(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(j(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(j(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function Y$(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["_url","model"],wi(e,r));const a=j(n,["contents"]);if(a!=null){let o=ru(e,a);Array.isArray(o)&&(o=o.map(f=>Lb(e,f))),C(t,["contents"],o)}const l=j(n,["config"]);return l!=null&&C(t,["config"],G$(e,l)),t}function W$(e,n){const t={};if(j(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=j(n,["imageBytes"]);r!=null&&C(t,["bytesBase64Encoded"],su(e,r));const a=j(n,["mimeType"]);return a!=null&&C(t,["mimeType"],a),t}function Q$(e,n,t){const r={},a=j(n,["numberOfVideos"]);if(t!==void 0&&a!=null&&C(t,["parameters","sampleCount"],a),j(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(j(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const l=j(n,["durationSeconds"]);if(t!==void 0&&l!=null&&C(t,["parameters","durationSeconds"],l),j(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=j(n,["aspectRatio"]);if(t!==void 0&&o!=null&&C(t,["parameters","aspectRatio"],o),j(n,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const f=j(n,["personGeneration"]);if(t!==void 0&&f!=null&&C(t,["parameters","personGeneration"],f),j(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const u=j(n,["negativePrompt"]);if(t!==void 0&&u!=null&&C(t,["parameters","negativePrompt"],u),j(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function J$(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["_url","model"],wi(e,r));const a=j(n,["prompt"]);a!=null&&C(t,["instances[0]","prompt"],a);const l=j(n,["image"]);l!=null&&C(t,["instances[0]","image"],W$(e,l));const o=j(n,["config"]);return o!=null&&C(t,["config"],Q$(e,o,t)),t}function K$(e,n){const t={},r=j(n,["displayName"]);r!=null&&C(t,["displayName"],r);const a=j(n,["data"]);a!=null&&C(t,["data"],a);const l=j(n,["mimeType"]);return l!=null&&C(t,["mimeType"],l),t}function X$(e,n){const t={},r=j(n,["videoMetadata"]);r!=null&&C(t,["videoMetadata"],r);const a=j(n,["thought"]);a!=null&&C(t,["thought"],a);const l=j(n,["inlineData"]);l!=null&&C(t,["inlineData"],K$(e,l));const o=j(n,["codeExecutionResult"]);o!=null&&C(t,["codeExecutionResult"],o);const f=j(n,["executableCode"]);f!=null&&C(t,["executableCode"],f);const u=j(n,["fileData"]);u!=null&&C(t,["fileData"],u);const d=j(n,["functionCall"]);d!=null&&C(t,["functionCall"],d);const h=j(n,["functionResponse"]);h!=null&&C(t,["functionResponse"],h);const g=j(n,["text"]);return g!=null&&C(t,["text"],g),t}function Kh(e,n){const t={},r=j(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>X$(e,o))),C(t,["parts"],l)}const a=j(n,["role"]);return a!=null&&C(t,["role"],a),t}function Z$(e,n){const t={},r=j(n,["featureSelectionPreference"]);return r!=null&&C(t,["featureSelectionPreference"],r),t}function ez(e,n){const t={},r=j(n,["method"]);r!=null&&C(t,["method"],r);const a=j(n,["category"]);a!=null&&C(t,["category"],a);const l=j(n,["threshold"]);return l!=null&&C(t,["threshold"],l),t}function tz(){return{}}function nz(e,n){const t={},r=j(n,["mode"]);r!=null&&C(t,["mode"],r);const a=j(n,["dynamicThreshold"]);return a!=null&&C(t,["dynamicThreshold"],a),t}function iz(e,n){const t={},r=j(n,["dynamicRetrievalConfig"]);return r!=null&&C(t,["dynamicRetrievalConfig"],nz(e,r)),t}function rz(){return{}}function az(e,n){const t={},r=j(n,["apiKeyString"]);return r!=null&&C(t,["apiKeyString"],r),t}function sz(e,n){const t={},r=j(n,["apiKeyConfig"]);r!=null&&C(t,["apiKeyConfig"],az(e,r));const a=j(n,["authType"]);a!=null&&C(t,["authType"],a);const l=j(n,["googleServiceAccountConfig"]);l!=null&&C(t,["googleServiceAccountConfig"],l);const o=j(n,["httpBasicAuthConfig"]);o!=null&&C(t,["httpBasicAuthConfig"],o);const f=j(n,["oauthConfig"]);f!=null&&C(t,["oauthConfig"],f);const u=j(n,["oidcConfig"]);return u!=null&&C(t,["oidcConfig"],u),t}function lz(e,n){const t={},r=j(n,["authConfig"]);return r!=null&&C(t,["authConfig"],sz(e,r)),t}function Y2(e,n){const t={},r=j(n,["retrieval"]);r!=null&&C(t,["retrieval"],r),j(n,["googleSearch"])!=null&&C(t,["googleSearch"],tz());const l=j(n,["googleSearchRetrieval"]);l!=null&&C(t,["googleSearchRetrieval"],iz(e,l)),j(n,["enterpriseWebSearch"])!=null&&C(t,["enterpriseWebSearch"],rz());const f=j(n,["googleMaps"]);f!=null&&C(t,["googleMaps"],lz(e,f));const u=j(n,["codeExecution"]);u!=null&&C(t,["codeExecution"],u);const d=j(n,["functionDeclarations"]);return d!=null&&C(t,["functionDeclarations"],d),t}function oz(e,n){const t={},r=j(n,["mode"]);r!=null&&C(t,["mode"],r);const a=j(n,["allowedFunctionNames"]);return a!=null&&C(t,["allowedFunctionNames"],a),t}function cz(e,n){const t={},r=j(n,["latitude"]);r!=null&&C(t,["latitude"],r);const a=j(n,["longitude"]);return a!=null&&C(t,["longitude"],a),t}function uz(e,n){const t={},r=j(n,["latLng"]);return r!=null&&C(t,["latLng"],cz(e,r)),t}function dz(e,n){const t={},r=j(n,["functionCallingConfig"]);r!=null&&C(t,["functionCallingConfig"],oz(e,r));const a=j(n,["retrievalConfig"]);return a!=null&&C(t,["retrievalConfig"],uz(e,a)),t}function fz(e,n){const t={},r=j(n,["voiceName"]);return r!=null&&C(t,["voiceName"],r),t}function hz(e,n){const t={},r=j(n,["prebuiltVoiceConfig"]);return r!=null&&C(t,["prebuiltVoiceConfig"],fz(e,r)),t}function pz(e,n){const t={},r=j(n,["voiceConfig"]);r!=null&&C(t,["voiceConfig"],hz(e,r));const a=j(n,["languageCode"]);return a!=null&&C(t,["languageCode"],a),t}function mz(e,n){const t={},r=j(n,["includeThoughts"]);r!=null&&C(t,["includeThoughts"],r);const a=j(n,["thinkingBudget"]);return a!=null&&C(t,["thinkingBudget"],a),t}function gz(e,n,t){const r={},a=j(n,["systemInstruction"]);t!==void 0&&a!=null&&C(t,["systemInstruction"],Kh(e,pa(e,a)));const l=j(n,["temperature"]);l!=null&&C(r,["temperature"],l);const o=j(n,["topP"]);o!=null&&C(r,["topP"],o);const f=j(n,["topK"]);f!=null&&C(r,["topK"],f);const u=j(n,["candidateCount"]);u!=null&&C(r,["candidateCount"],u);const d=j(n,["maxOutputTokens"]);d!=null&&C(r,["maxOutputTokens"],d);const h=j(n,["stopSequences"]);h!=null&&C(r,["stopSequences"],h);const g=j(n,["responseLogprobs"]);g!=null&&C(r,["responseLogprobs"],g);const b=j(n,["logprobs"]);b!=null&&C(r,["logprobs"],b);const v=j(n,["presencePenalty"]);v!=null&&C(r,["presencePenalty"],v);const S=j(n,["frequencyPenalty"]);S!=null&&C(r,["frequencyPenalty"],S);const k=j(n,["seed"]);k!=null&&C(r,["seed"],k);const T=j(n,["responseMimeType"]);T!=null&&C(r,["responseMimeType"],T);const E=j(n,["responseSchema"]);E!=null&&C(r,["responseSchema"],z2(e,E));const P=j(n,["routingConfig"]);P!=null&&C(r,["routingConfig"],P);const I=j(n,["modelSelectionConfig"]);I!=null&&C(r,["modelConfig"],Z$(e,I));const V=j(n,["safetySettings"]);if(t!==void 0&&V!=null){let Z=V;Array.isArray(Z)&&(Z=Z.map(te=>ez(e,te))),C(t,["safetySettings"],Z)}const F=j(n,["tools"]);if(t!==void 0&&F!=null){let Z=Mb(e,F);Array.isArray(Z)&&(Z=Z.map(te=>Y2(e,Ib(e,te)))),C(t,["tools"],Z)}const O=j(n,["toolConfig"]);t!==void 0&&O!=null&&C(t,["toolConfig"],dz(e,O));const B=j(n,["labels"]);t!==void 0&&B!=null&&C(t,["labels"],B);const U=j(n,["cachedContent"]);t!==void 0&&U!=null&&C(t,["cachedContent"],au(e,U));const z=j(n,["responseModalities"]);z!=null&&C(r,["responseModalities"],z);const $=j(n,["mediaResolution"]);$!=null&&C(r,["mediaResolution"],$);const R=j(n,["speechConfig"]);R!=null&&C(r,["speechConfig"],pz(e,B2(e,R)));const H=j(n,["audioTimestamp"]);H!=null&&C(r,["audioTimestamp"],H);const ee=j(n,["thinkingConfig"]);return ee!=null&&C(r,["thinkingConfig"],mz(e,ee)),r}function sj(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["_url","model"],wi(e,r));const a=j(n,["contents"]);if(a!=null){let o=ru(e,a);Array.isArray(o)&&(o=o.map(f=>Kh(e,f))),C(t,["contents"],o)}const l=j(n,["config"]);return l!=null&&C(t,["generationConfig"],gz(e,l,t)),t}function yz(e,n,t){const r={},a=j(n,["taskType"]);t!==void 0&&a!=null&&C(t,["instances[]","task_type"],a);const l=j(n,["title"]);t!==void 0&&l!=null&&C(t,["instances[]","title"],l);const o=j(n,["outputDimensionality"]);t!==void 0&&o!=null&&C(t,["parameters","outputDimensionality"],o);const f=j(n,["mimeType"]);t!==void 0&&f!=null&&C(t,["instances[]","mimeType"],f);const u=j(n,["autoTruncate"]);return t!==void 0&&u!=null&&C(t,["parameters","autoTruncate"],u),r}function xz(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["_url","model"],wi(e,r));const a=j(n,["contents"]);a!=null&&C(t,["instances[]","content"],$2(e,a));const l=j(n,["config"]);return l!=null&&C(t,["config"],yz(e,l,t)),t}function bz(e,n,t){const r={},a=j(n,["outputGcsUri"]);t!==void 0&&a!=null&&C(t,["parameters","storageUri"],a);const l=j(n,["negativePrompt"]);t!==void 0&&l!=null&&C(t,["parameters","negativePrompt"],l);const o=j(n,["numberOfImages"]);t!==void 0&&o!=null&&C(t,["parameters","sampleCount"],o);const f=j(n,["aspectRatio"]);t!==void 0&&f!=null&&C(t,["parameters","aspectRatio"],f);const u=j(n,["guidanceScale"]);t!==void 0&&u!=null&&C(t,["parameters","guidanceScale"],u);const d=j(n,["seed"]);t!==void 0&&d!=null&&C(t,["parameters","seed"],d);const h=j(n,["safetyFilterLevel"]);t!==void 0&&h!=null&&C(t,["parameters","safetySetting"],h);const g=j(n,["personGeneration"]);t!==void 0&&g!=null&&C(t,["parameters","personGeneration"],g);const b=j(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&C(t,["parameters","includeSafetyAttributes"],b);const v=j(n,["includeRaiReason"]);t!==void 0&&v!=null&&C(t,["parameters","includeRaiReason"],v);const S=j(n,["language"]);t!==void 0&&S!=null&&C(t,["parameters","language"],S);const k=j(n,["outputMimeType"]);t!==void 0&&k!=null&&C(t,["parameters","outputOptions","mimeType"],k);const T=j(n,["outputCompressionQuality"]);t!==void 0&&T!=null&&C(t,["parameters","outputOptions","compressionQuality"],T);const E=j(n,["addWatermark"]);t!==void 0&&E!=null&&C(t,["parameters","addWatermark"],E);const P=j(n,["enhancePrompt"]);return t!==void 0&&P!=null&&C(t,["parameters","enhancePrompt"],P),r}function vz(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["_url","model"],wi(e,r));const a=j(n,["prompt"]);a!=null&&C(t,["instances[0]","prompt"],a);const l=j(n,["config"]);return l!=null&&C(t,["config"],bz(e,l,t)),t}function pw(e,n){const t={},r=j(n,["gcsUri"]);r!=null&&C(t,["gcsUri"],r);const a=j(n,["imageBytes"]);a!=null&&C(t,["bytesBase64Encoded"],su(e,a));const l=j(n,["mimeType"]);return l!=null&&C(t,["mimeType"],l),t}function wz(e,n){const t={},r=j(n,["maskMode"]);r!=null&&C(t,["maskMode"],r);const a=j(n,["segmentationClasses"]);a!=null&&C(t,["maskClasses"],a);const l=j(n,["maskDilation"]);return l!=null&&C(t,["dilation"],l),t}function Nz(e,n){const t={},r=j(n,["controlType"]);r!=null&&C(t,["controlType"],r);const a=j(n,["enableControlImageComputation"]);return a!=null&&C(t,["computeControl"],a),t}function Sz(e,n){const t={},r=j(n,["styleDescription"]);return r!=null&&C(t,["styleDescription"],r),t}function jz(e,n){const t={},r=j(n,["subjectType"]);r!=null&&C(t,["subjectType"],r);const a=j(n,["subjectDescription"]);return a!=null&&C(t,["subjectDescription"],a),t}function Cz(e,n){const t={},r=j(n,["referenceImage"]);r!=null&&C(t,["referenceImage"],pw(e,r));const a=j(n,["referenceId"]);a!=null&&C(t,["referenceId"],a);const l=j(n,["referenceType"]);l!=null&&C(t,["referenceType"],l);const o=j(n,["maskImageConfig"]);o!=null&&C(t,["maskImageConfig"],wz(e,o));const f=j(n,["controlImageConfig"]);f!=null&&C(t,["controlImageConfig"],Nz(e,f));const u=j(n,["styleImageConfig"]);u!=null&&C(t,["styleImageConfig"],Sz(e,u));const d=j(n,["subjectImageConfig"]);return d!=null&&C(t,["subjectImageConfig"],jz(e,d)),t}function _z(e,n,t){const r={},a=j(n,["outputGcsUri"]);t!==void 0&&a!=null&&C(t,["parameters","storageUri"],a);const l=j(n,["negativePrompt"]);t!==void 0&&l!=null&&C(t,["parameters","negativePrompt"],l);const o=j(n,["numberOfImages"]);t!==void 0&&o!=null&&C(t,["parameters","sampleCount"],o);const f=j(n,["aspectRatio"]);t!==void 0&&f!=null&&C(t,["parameters","aspectRatio"],f);const u=j(n,["guidanceScale"]);t!==void 0&&u!=null&&C(t,["parameters","guidanceScale"],u);const d=j(n,["seed"]);t!==void 0&&d!=null&&C(t,["parameters","seed"],d);const h=j(n,["safetyFilterLevel"]);t!==void 0&&h!=null&&C(t,["parameters","safetySetting"],h);const g=j(n,["personGeneration"]);t!==void 0&&g!=null&&C(t,["parameters","personGeneration"],g);const b=j(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&C(t,["parameters","includeSafetyAttributes"],b);const v=j(n,["includeRaiReason"]);t!==void 0&&v!=null&&C(t,["parameters","includeRaiReason"],v);const S=j(n,["language"]);t!==void 0&&S!=null&&C(t,["parameters","language"],S);const k=j(n,["outputMimeType"]);t!==void 0&&k!=null&&C(t,["parameters","outputOptions","mimeType"],k);const T=j(n,["outputCompressionQuality"]);t!==void 0&&T!=null&&C(t,["parameters","outputOptions","compressionQuality"],T);const E=j(n,["editMode"]);t!==void 0&&E!=null&&C(t,["parameters","editMode"],E);const P=j(n,["baseSteps"]);return t!==void 0&&P!=null&&C(t,["parameters","editConfig","baseSteps"],P),r}function kz(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["_url","model"],wi(e,r));const a=j(n,["prompt"]);a!=null&&C(t,["instances[0]","prompt"],a);const l=j(n,["referenceImages"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(u=>Cz(e,u))),C(t,["instances[0]","referenceImages"],f)}const o=j(n,["config"]);return o!=null&&C(t,["config"],_z(e,o,t)),t}function Ez(e,n,t){const r={},a=j(n,["includeRaiReason"]);t!==void 0&&a!=null&&C(t,["parameters","includeRaiReason"],a);const l=j(n,["outputMimeType"]);t!==void 0&&l!=null&&C(t,["parameters","outputOptions","mimeType"],l);const o=j(n,["outputCompressionQuality"]);t!==void 0&&o!=null&&C(t,["parameters","outputOptions","compressionQuality"],o);const f=j(n,["numberOfImages"]);t!==void 0&&f!=null&&C(t,["parameters","sampleCount"],f);const u=j(n,["mode"]);return t!==void 0&&u!=null&&C(t,["parameters","mode"],u),r}function Tz(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["_url","model"],wi(e,r));const a=j(n,["image"]);a!=null&&C(t,["instances[0]","image"],pw(e,a));const l=j(n,["upscaleFactor"]);l!=null&&C(t,["parameters","upscaleConfig","upscaleFactor"],l);const o=j(n,["config"]);return o!=null&&C(t,["config"],Ez(e,o,t)),t}function Az(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["_url","name"],wi(e,r));const a=j(n,["config"]);return a!=null&&C(t,["config"],a),t}function Dz(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&C(t,["_query","pageSize"],a);const l=j(n,["pageToken"]);t!==void 0&&l!=null&&C(t,["_query","pageToken"],l);const o=j(n,["filter"]);t!==void 0&&o!=null&&C(t,["_query","filter"],o);const f=j(n,["queryBase"]);return t!==void 0&&f!=null&&C(t,["_url","models_url"],V2(e,f)),r}function Pz(e,n){const t={},r=j(n,["config"]);return r!=null&&C(t,["config"],Dz(e,r,t)),t}function Iz(e,n,t){const r={},a=j(n,["displayName"]);t!==void 0&&a!=null&&C(t,["displayName"],a);const l=j(n,["description"]);t!==void 0&&l!=null&&C(t,["description"],l);const o=j(n,["defaultCheckpointId"]);return t!==void 0&&o!=null&&C(t,["defaultCheckpointId"],o),r}function Mz(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["_url","model"],wi(e,r));const a=j(n,["config"]);return a!=null&&C(t,["config"],Iz(e,a,t)),t}function Rz(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["_url","name"],wi(e,r));const a=j(n,["config"]);return a!=null&&C(t,["config"],a),t}function Lz(e,n,t){const r={},a=j(n,["systemInstruction"]);t!==void 0&&a!=null&&C(t,["systemInstruction"],Kh(e,pa(e,a)));const l=j(n,["tools"]);if(t!==void 0&&l!=null){let f=l;Array.isArray(f)&&(f=f.map(u=>Y2(e,u))),C(t,["tools"],f)}const o=j(n,["generationConfig"]);return t!==void 0&&o!=null&&C(t,["generationConfig"],o),r}function Oz(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["_url","model"],wi(e,r));const a=j(n,["contents"]);if(a!=null){let o=ru(e,a);Array.isArray(o)&&(o=o.map(f=>Kh(e,f))),C(t,["contents"],o)}const l=j(n,["config"]);return l!=null&&C(t,["config"],Lz(e,l,t)),t}function Fz(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["_url","model"],wi(e,r));const a=j(n,["contents"]);if(a!=null){let o=ru(e,a);Array.isArray(o)&&(o=o.map(f=>Kh(e,f))),C(t,["contents"],o)}const l=j(n,["config"]);return l!=null&&C(t,["config"],l),t}function $z(e,n,t){const r={},a=j(n,["numberOfVideos"]);t!==void 0&&a!=null&&C(t,["parameters","sampleCount"],a);const l=j(n,["outputGcsUri"]);t!==void 0&&l!=null&&C(t,["parameters","storageUri"],l);const o=j(n,["fps"]);t!==void 0&&o!=null&&C(t,["parameters","fps"],o);const f=j(n,["durationSeconds"]);t!==void 0&&f!=null&&C(t,["parameters","durationSeconds"],f);const u=j(n,["seed"]);t!==void 0&&u!=null&&C(t,["parameters","seed"],u);const d=j(n,["aspectRatio"]);t!==void 0&&d!=null&&C(t,["parameters","aspectRatio"],d);const h=j(n,["resolution"]);t!==void 0&&h!=null&&C(t,["parameters","resolution"],h);const g=j(n,["personGeneration"]);t!==void 0&&g!=null&&C(t,["parameters","personGeneration"],g);const b=j(n,["pubsubTopic"]);t!==void 0&&b!=null&&C(t,["parameters","pubsubTopic"],b);const v=j(n,["negativePrompt"]);t!==void 0&&v!=null&&C(t,["parameters","negativePrompt"],v);const S=j(n,["enhancePrompt"]);return t!==void 0&&S!=null&&C(t,["parameters","enhancePrompt"],S),r}function zz(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["_url","model"],wi(e,r));const a=j(n,["prompt"]);a!=null&&C(t,["instances[0]","prompt"],a);const l=j(n,["image"]);l!=null&&C(t,["instances[0]","image"],pw(e,l));const o=j(n,["config"]);return o!=null&&C(t,["config"],$z(e,o,t)),t}function Bz(e,n){const t={},r=j(n,["data"]);r!=null&&C(t,["data"],r);const a=j(n,["mimeType"]);return a!=null&&C(t,["mimeType"],a),t}function Uz(e,n){const t={},r=j(n,["thought"]);r!=null&&C(t,["thought"],r);const a=j(n,["inlineData"]);a!=null&&C(t,["inlineData"],Bz(e,a));const l=j(n,["codeExecutionResult"]);l!=null&&C(t,["codeExecutionResult"],l);const o=j(n,["executableCode"]);o!=null&&C(t,["executableCode"],o);const f=j(n,["fileData"]);f!=null&&C(t,["fileData"],f);const u=j(n,["functionCall"]);u!=null&&C(t,["functionCall"],u);const d=j(n,["functionResponse"]);d!=null&&C(t,["functionResponse"],d);const h=j(n,["text"]);return h!=null&&C(t,["text"],h),t}function qz(e,n){const t={},r=j(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>Uz(e,o))),C(t,["parts"],l)}const a=j(n,["role"]);return a!=null&&C(t,["role"],a),t}function Vz(e,n){const t={},r=j(n,["citationSources"]);return r!=null&&C(t,["citations"],r),t}function Hz(e,n){const t={},r=j(n,["content"]);r!=null&&C(t,["content"],qz(e,r));const a=j(n,["citationMetadata"]);a!=null&&C(t,["citationMetadata"],Vz(e,a));const l=j(n,["tokenCount"]);l!=null&&C(t,["tokenCount"],l);const o=j(n,["finishReason"]);o!=null&&C(t,["finishReason"],o);const f=j(n,["avgLogprobs"]);f!=null&&C(t,["avgLogprobs"],f);const u=j(n,["groundingMetadata"]);u!=null&&C(t,["groundingMetadata"],u);const d=j(n,["index"]);d!=null&&C(t,["index"],d);const h=j(n,["logprobsResult"]);h!=null&&C(t,["logprobsResult"],h);const g=j(n,["safetyRatings"]);return g!=null&&C(t,["safetyRatings"],g),t}function lj(e,n){const t={},r=j(n,["candidates"]);if(r!=null){let f=r;Array.isArray(f)&&(f=f.map(u=>Hz(e,u))),C(t,["candidates"],f)}const a=j(n,["modelVersion"]);a!=null&&C(t,["modelVersion"],a);const l=j(n,["promptFeedback"]);l!=null&&C(t,["promptFeedback"],l);const o=j(n,["usageMetadata"]);return o!=null&&C(t,["usageMetadata"],o),t}function Gz(e,n){const t={},r=j(n,["values"]);return r!=null&&C(t,["values"],r),t}function Yz(){return{}}function Wz(e,n){const t={},r=j(n,["embeddings"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>Gz(e,o))),C(t,["embeddings"],l)}return j(n,["metadata"])!=null&&C(t,["metadata"],Yz()),t}function Qz(e,n){const t={},r=j(n,["bytesBase64Encoded"]);r!=null&&C(t,["imageBytes"],su(e,r));const a=j(n,["mimeType"]);return a!=null&&C(t,["mimeType"],a),t}function W2(e,n){const t={},r=j(n,["safetyAttributes","categories"]);r!=null&&C(t,["categories"],r);const a=j(n,["safetyAttributes","scores"]);a!=null&&C(t,["scores"],a);const l=j(n,["contentType"]);return l!=null&&C(t,["contentType"],l),t}function Jz(e,n){const t={},r=j(n,["_self"]);r!=null&&C(t,["image"],Qz(e,r));const a=j(n,["raiFilteredReason"]);a!=null&&C(t,["raiFilteredReason"],a);const l=j(n,["_self"]);return l!=null&&C(t,["safetyAttributes"],W2(e,l)),t}function Kz(e,n){const t={},r=j(n,["predictions"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>Jz(e,o))),C(t,["generatedImages"],l)}const a=j(n,["positivePromptSafetyAttributes"]);return a!=null&&C(t,["positivePromptSafetyAttributes"],W2(e,a)),t}function Xz(e,n){const t={},r=j(n,["baseModel"]);r!=null&&C(t,["baseModel"],r);const a=j(n,["createTime"]);a!=null&&C(t,["createTime"],a);const l=j(n,["updateTime"]);return l!=null&&C(t,["updateTime"],l),t}function l1(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["name"],r);const a=j(n,["displayName"]);a!=null&&C(t,["displayName"],a);const l=j(n,["description"]);l!=null&&C(t,["description"],l);const o=j(n,["version"]);o!=null&&C(t,["version"],o);const f=j(n,["_self"]);f!=null&&C(t,["tunedModelInfo"],Xz(e,f));const u=j(n,["inputTokenLimit"]);u!=null&&C(t,["inputTokenLimit"],u);const d=j(n,["outputTokenLimit"]);d!=null&&C(t,["outputTokenLimit"],d);const h=j(n,["supportedGenerationMethods"]);return h!=null&&C(t,["supportedActions"],h),t}function Zz(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&C(t,["nextPageToken"],r);const a=j(n,["_self"]);if(a!=null){let l=H2(e,a);Array.isArray(l)&&(l=l.map(o=>l1(e,o))),C(t,["models"],l)}return t}function e8(){return{}}function t8(e,n){const t={},r=j(n,["totalTokens"]);r!=null&&C(t,["totalTokens"],r);const a=j(n,["cachedContentTokenCount"]);return a!=null&&C(t,["cachedContentTokenCount"],a),t}function n8(e,n){const t={},r=j(n,["video","uri"]);r!=null&&C(t,["uri"],r);const a=j(n,["video","encodedVideo"]);a!=null&&C(t,["videoBytes"],su(e,a));const l=j(n,["encoding"]);return l!=null&&C(t,["mimeType"],l),t}function i8(e,n){const t={},r=j(n,["_self"]);return r!=null&&C(t,["video"],n8(e,r)),t}function r8(e,n){const t={},r=j(n,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(f=>i8(e,f))),C(t,["generatedVideos"],o)}const a=j(n,["raiMediaFilteredCount"]);a!=null&&C(t,["raiMediaFilteredCount"],a);const l=j(n,["raiMediaFilteredReasons"]);return l!=null&&C(t,["raiMediaFilteredReasons"],l),t}function a8(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["name"],r);const a=j(n,["metadata"]);a!=null&&C(t,["metadata"],a);const l=j(n,["done"]);l!=null&&C(t,["done"],l);const o=j(n,["error"]);o!=null&&C(t,["error"],o);const f=j(n,["response","generateVideoResponse"]);return f!=null&&C(t,["response"],r8(e,f)),t}function s8(e,n){const t={},r=j(n,["displayName"]);r!=null&&C(t,["displayName"],r);const a=j(n,["data"]);a!=null&&C(t,["data"],a);const l=j(n,["mimeType"]);return l!=null&&C(t,["mimeType"],l),t}function l8(e,n){const t={},r=j(n,["videoMetadata"]);r!=null&&C(t,["videoMetadata"],r);const a=j(n,["thought"]);a!=null&&C(t,["thought"],a);const l=j(n,["inlineData"]);l!=null&&C(t,["inlineData"],s8(e,l));const o=j(n,["codeExecutionResult"]);o!=null&&C(t,["codeExecutionResult"],o);const f=j(n,["executableCode"]);f!=null&&C(t,["executableCode"],f);const u=j(n,["fileData"]);u!=null&&C(t,["fileData"],u);const d=j(n,["functionCall"]);d!=null&&C(t,["functionCall"],d);const h=j(n,["functionResponse"]);h!=null&&C(t,["functionResponse"],h);const g=j(n,["text"]);return g!=null&&C(t,["text"],g),t}function o8(e,n){const t={},r=j(n,["parts"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>l8(e,o))),C(t,["parts"],l)}const a=j(n,["role"]);return a!=null&&C(t,["role"],a),t}function c8(e,n){const t={},r=j(n,["citations"]);return r!=null&&C(t,["citations"],r),t}function u8(e,n){const t={},r=j(n,["content"]);r!=null&&C(t,["content"],o8(e,r));const a=j(n,["citationMetadata"]);a!=null&&C(t,["citationMetadata"],c8(e,a));const l=j(n,["finishMessage"]);l!=null&&C(t,["finishMessage"],l);const o=j(n,["finishReason"]);o!=null&&C(t,["finishReason"],o);const f=j(n,["avgLogprobs"]);f!=null&&C(t,["avgLogprobs"],f);const u=j(n,["groundingMetadata"]);u!=null&&C(t,["groundingMetadata"],u);const d=j(n,["index"]);d!=null&&C(t,["index"],d);const h=j(n,["logprobsResult"]);h!=null&&C(t,["logprobsResult"],h);const g=j(n,["safetyRatings"]);return g!=null&&C(t,["safetyRatings"],g),t}function oj(e,n){const t={},r=j(n,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(h=>u8(e,h))),C(t,["candidates"],d)}const a=j(n,["createTime"]);a!=null&&C(t,["createTime"],a);const l=j(n,["responseId"]);l!=null&&C(t,["responseId"],l);const o=j(n,["modelVersion"]);o!=null&&C(t,["modelVersion"],o);const f=j(n,["promptFeedback"]);f!=null&&C(t,["promptFeedback"],f);const u=j(n,["usageMetadata"]);return u!=null&&C(t,["usageMetadata"],u),t}function d8(e,n){const t={},r=j(n,["truncated"]);r!=null&&C(t,["truncated"],r);const a=j(n,["token_count"]);return a!=null&&C(t,["tokenCount"],a),t}function f8(e,n){const t={},r=j(n,["values"]);r!=null&&C(t,["values"],r);const a=j(n,["statistics"]);return a!=null&&C(t,["statistics"],d8(e,a)),t}function h8(e,n){const t={},r=j(n,["billableCharacterCount"]);return r!=null&&C(t,["billableCharacterCount"],r),t}function p8(e,n){const t={},r=j(n,["predictions[]","embeddings"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>f8(e,o))),C(t,["embeddings"],l)}const a=j(n,["metadata"]);return a!=null&&C(t,["metadata"],h8(e,a)),t}function m8(e,n){const t={},r=j(n,["gcsUri"]);r!=null&&C(t,["gcsUri"],r);const a=j(n,["bytesBase64Encoded"]);a!=null&&C(t,["imageBytes"],su(e,a));const l=j(n,["mimeType"]);return l!=null&&C(t,["mimeType"],l),t}function Q2(e,n){const t={},r=j(n,["safetyAttributes","categories"]);r!=null&&C(t,["categories"],r);const a=j(n,["safetyAttributes","scores"]);a!=null&&C(t,["scores"],a);const l=j(n,["contentType"]);return l!=null&&C(t,["contentType"],l),t}function mw(e,n){const t={},r=j(n,["_self"]);r!=null&&C(t,["image"],m8(e,r));const a=j(n,["raiFilteredReason"]);a!=null&&C(t,["raiFilteredReason"],a);const l=j(n,["_self"]);l!=null&&C(t,["safetyAttributes"],Q2(e,l));const o=j(n,["prompt"]);return o!=null&&C(t,["enhancedPrompt"],o),t}function g8(e,n){const t={},r=j(n,["predictions"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(o=>mw(e,o))),C(t,["generatedImages"],l)}const a=j(n,["positivePromptSafetyAttributes"]);return a!=null&&C(t,["positivePromptSafetyAttributes"],Q2(e,a)),t}function y8(e,n){const t={},r=j(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>mw(e,l))),C(t,["generatedImages"],a)}return t}function x8(e,n){const t={},r=j(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>mw(e,l))),C(t,["generatedImages"],a)}return t}function b8(e,n){const t={},r=j(n,["endpoint"]);r!=null&&C(t,["name"],r);const a=j(n,["deployedModelId"]);return a!=null&&C(t,["deployedModelId"],a),t}function v8(e,n){const t={},r=j(n,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&C(t,["baseModel"],r);const a=j(n,["createTime"]);a!=null&&C(t,["createTime"],a);const l=j(n,["updateTime"]);return l!=null&&C(t,["updateTime"],l),t}function w8(e,n){const t={},r=j(n,["checkpointId"]);r!=null&&C(t,["checkpointId"],r);const a=j(n,["epoch"]);a!=null&&C(t,["epoch"],a);const l=j(n,["step"]);return l!=null&&C(t,["step"],l),t}function o1(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["name"],r);const a=j(n,["displayName"]);a!=null&&C(t,["displayName"],a);const l=j(n,["description"]);l!=null&&C(t,["description"],l);const o=j(n,["versionId"]);o!=null&&C(t,["version"],o);const f=j(n,["deployedModels"]);if(f!=null){let b=f;Array.isArray(b)&&(b=b.map(v=>b8(e,v))),C(t,["endpoints"],b)}const u=j(n,["labels"]);u!=null&&C(t,["labels"],u);const d=j(n,["_self"]);d!=null&&C(t,["tunedModelInfo"],v8(e,d));const h=j(n,["defaultCheckpointId"]);h!=null&&C(t,["defaultCheckpointId"],h);const g=j(n,["checkpoints"]);if(g!=null){let b=g;Array.isArray(b)&&(b=b.map(v=>w8(e,v))),C(t,["checkpoints"],b)}return t}function N8(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&C(t,["nextPageToken"],r);const a=j(n,["_self"]);if(a!=null){let l=H2(e,a);Array.isArray(l)&&(l=l.map(o=>o1(e,o))),C(t,["models"],l)}return t}function S8(){return{}}function j8(e,n){const t={},r=j(n,["totalTokens"]);return r!=null&&C(t,["totalTokens"],r),t}function C8(e,n){const t={},r=j(n,["tokensInfo"]);return r!=null&&C(t,["tokensInfo"],r),t}function _8(e,n){const t={},r=j(n,["gcsUri"]);r!=null&&C(t,["uri"],r);const a=j(n,["bytesBase64Encoded"]);a!=null&&C(t,["videoBytes"],su(e,a));const l=j(n,["mimeType"]);return l!=null&&C(t,["mimeType"],l),t}function k8(e,n){const t={},r=j(n,["_self"]);return r!=null&&C(t,["video"],_8(e,r)),t}function E8(e,n){const t={},r=j(n,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(f=>k8(e,f))),C(t,["generatedVideos"],o)}const a=j(n,["raiMediaFilteredCount"]);a!=null&&C(t,["raiMediaFilteredCount"],a);const l=j(n,["raiMediaFilteredReasons"]);return l!=null&&C(t,["raiMediaFilteredReasons"],l),t}function T8(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["name"],r);const a=j(n,["metadata"]);a!=null&&C(t,["metadata"],a);const l=j(n,["done"]);l!=null&&C(t,["done"],l);const o=j(n,["error"]);o!=null&&C(t,["error"],o);const f=j(n,["response"]);return f!=null&&C(t,["response"],E8(e,f)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const A8="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function D8(e,n,t){const r=new Q6;let a;if(t.data instanceof Blob?a=JSON.parse(await t.data.text()):a=JSON.parse(t.data),e.isVertexAI()){const l=w$(e,a);Object.assign(r,l)}else{const l=v$(e,a);Object.assign(r,l)}n(r)}class P8{constructor(n,t,r){this.apiClient=n,this.auth=t,this.webSocketFactory=r}async connect(n){var t,r,a,l;const o=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let u;const d=L8(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())u=`${o}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(d);else{const V=this.apiClient.getApiKey();u=`${o}/ws/google.ai.generativelanguage.${f}.GenerativeService.BidiGenerateContent?key=${V}`}let h=()=>{};const g=new Promise(V=>{h=V}),b=n.callbacks,v=function(){var V;(V=b==null?void 0:b.onopen)===null||V===void 0||V.call(b),h({})},S=this.apiClient,k={onopen:v,onmessage:V=>{D8(S,b.onmessage,V)},onerror:(t=b==null?void 0:b.onerror)!==null&&t!==void 0?t:function(V){},onclose:(r=b==null?void 0:b.onclose)!==null&&r!==void 0?r:function(V){}},T=this.webSocketFactory.create(u,R8(d),k);T.connect(),await g;let E=wi(this.apiClient,n.model);if(this.apiClient.isVertexAI()&&E.startsWith("publishers/")){const V=this.apiClient.getProject(),F=this.apiClient.getLocation();E=`projects/${V}/locations/${F}/`+E}let P={};this.apiClient.isVertexAI()&&((a=n.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(n.config===void 0?n.config={responseModalities:[nu.AUDIO]}:n.config.responseModalities=[nu.AUDIO]),!((l=n.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const I={model:E,config:n.config,callbacks:n.callbacks};return this.apiClient.isVertexAI()?P=H5(this.apiClient,I):P=V5(this.apiClient,I),delete P.config,T.send(JSON.stringify(P)),new M8(T,this.apiClient)}}const I8={turnComplete:!0};class M8{constructor(n,t){this.conn=n,this.apiClient=t}tLiveClientContent(n,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=ru(n,t.turns),n.isVertexAI()?r=r.map(a=>Kh(n,a)):r=r.map(a=>Lb(n,a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(n,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const l of r){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!n.isVertexAI()&&!("id"in l))throw new Error(A8)}return{toolResponse:{functionResponses:r}}}sendClientContent(n){n=Object.assign(Object.assign({},I8),n);const t=this.tLiveClientContent(this.apiClient,n);this.conn.send(JSON.stringify(t))}sendRealtimeInput(n){let t={};this.apiClient.isVertexAI()?t={realtimeInput:K5(this.apiClient,n)}:t={realtimeInput:J5(this.apiClient,n)},this.conn.send(JSON.stringify(t))}sendToolResponse(n){if(n.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,n);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function R8(e){const n={};return e.forEach((t,r)=>{n[r]=t}),n}function L8(e){const n=new Headers;for(const[t,r]of Object.entries(e))n.append(t,r);return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class O8 extends hg{constructor(n){super(),this.apiClient=n,this.generateContent=async t=>await this.generateContentInternal(t),this.generateContentStream=async t=>await this.generateContentStreamInternal(t),this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var a;let l;const o=[];if(r!=null&&r.generatedImages)for(const u of r.generatedImages)u&&(u!=null&&u.safetyAttributes)&&((a=u==null?void 0:u.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?l=u==null?void 0:u.safetyAttributes:o.push(u);let f;return l?f={generatedImages:o,positivePromptSafetyAttributes:l}:f={generatedImages:o},f}),this.list=async t=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Rb(qh.PAGED_ITEM_MODELS,f=>this.listInternal(f),await this.listInternal(o),o)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const a={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(a)}}async generateContentInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=sj(this.apiClient,n);return f=Bt("{model}:generateContent",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=oj(this.apiClient,h),b=new Nx;return Object.assign(b,g),b})}else{const d=aj(this.apiClient,n);return f=Bt("{model}:generateContent",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=lj(this.apiClient,h),b=new Nx;return Object.assign(b,g),b})}}async generateContentStreamInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=sj(this.apiClient,n);f=Bt("{model}:streamGenerateContent?alt=sse",d._url),u=d._query,delete d.config,delete d._url,delete d._query;const h=this.apiClient;return o=h.requestStream({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(g){return fb(this,arguments,function*(){var b,v,S,k;try{for(var T=!0,E=a1(g),P;P=yield Pr(E.next()),b=P.done,!b;T=!0){k=P.value,T=!1;const V=oj(h,yield Pr(k.json())),F=new Nx;Object.assign(F,V),yield yield Pr(F)}}catch(I){v={error:I}}finally{try{!T&&!b&&(S=E.return)&&(yield Pr(S.call(E)))}finally{if(v)throw v.error}}})})}else{const d=aj(this.apiClient,n);f=Bt("{model}:streamGenerateContent?alt=sse",d._url),u=d._query,delete d.config,delete d._url,delete d._query;const h=this.apiClient;return o=h.requestStream({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}),o.then(function(g){return fb(this,arguments,function*(){var b,v,S,k;try{for(var T=!0,E=a1(g),P;P=yield Pr(E.next()),b=P.done,!b;T=!0){k=P.value,T=!1;const V=lj(h,yield Pr(k.json())),F=new Nx;Object.assign(F,V),yield yield Pr(F)}}catch(I){v={error:I}}finally{try{!T&&!b&&(S=E.return)&&(yield Pr(S.call(E)))}finally{if(v)throw v.error}}})})}}async embedContent(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=xz(this.apiClient,n);return f=Bt("{model}:predict",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=p8(this.apiClient,h),b=new GS;return Object.assign(b,g),b})}else{const d=O$(this.apiClient,n);return f=Bt("{model}:batchEmbedContents",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=Wz(this.apiClient,h),b=new GS;return Object.assign(b,g),b})}}async generateImagesInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=vz(this.apiClient,n);return f=Bt("{model}:predict",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=g8(this.apiClient,h),b=new YS;return Object.assign(b,g),b})}else{const d=$$(this.apiClient,n);return f=Bt("{model}:predict",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=Kz(this.apiClient,h),b=new YS;return Object.assign(b,g),b})}}async editImageInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI()){const f=kz(this.apiClient,n);return l=Bt("{model}:predict",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>{const d=y8(this.apiClient,u),h=new q6;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI()){const f=Tz(this.apiClient,n);return l=Bt("{model}:predict",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>{const d=x8(this.apiClient,u),h=new V6;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=Az(this.apiClient,n);return f=Bt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>o1(this.apiClient,h))}else{const d=z$(this.apiClient,n);return f=Bt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>l1(this.apiClient,h))}}async listInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=Pz(this.apiClient,n);return f=Bt("{models_url}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=N8(this.apiClient,h),b=new WS;return Object.assign(b,g),b})}else{const d=U$(this.apiClient,n);return f=Bt("{models_url}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=Zz(this.apiClient,h),b=new WS;return Object.assign(b,g),b})}}async update(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=Mz(this.apiClient,n);return f=Bt("{model}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>o1(this.apiClient,h))}else{const d=V$(this.apiClient,n);return f=Bt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>l1(this.apiClient,h))}}async delete(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=Rz(this.apiClient,n);return f=Bt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(()=>{const h=S8(),g=new QS;return Object.assign(g,h),g})}else{const d=H$(this.apiClient,n);return f=Bt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(()=>{const h=e8(),g=new QS;return Object.assign(g,h),g})}}async countTokens(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=Oz(this.apiClient,n);return f=Bt("{model}:countTokens",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=j8(this.apiClient,h),b=new JS;return Object.assign(b,g),b})}else{const d=Y$(this.apiClient,n);return f=Bt("{model}:countTokens",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=t8(this.apiClient,h),b=new JS;return Object.assign(b,g),b})}}async computeTokens(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI()){const f=Fz(this.apiClient,n);return l=Bt("{model}:computeTokens",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>{const d=C8(this.apiClient,u),h=new H6;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=zz(this.apiClient,n);return f=Bt("{model}:predictLongRunning",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>T8(this.apiClient,h))}else{const d=J$(this.apiClient,n);return f=Bt("{model}:predictLongRunning",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>a8(this.apiClient,h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function F8(e,n){const t={},r=j(n,["operationName"]);r!=null&&C(t,["_url","operationName"],r);const a=j(n,["config"]);return a!=null&&C(t,["config"],a),t}function $8(e,n){const t={},r=j(n,["operationName"]);r!=null&&C(t,["_url","operationName"],r);const a=j(n,["config"]);return a!=null&&C(t,["config"],a),t}function z8(e,n){const t={},r=j(n,["operationName"]);r!=null&&C(t,["operationName"],r);const a=j(n,["resourceName"]);a!=null&&C(t,["_url","resourceName"],a);const l=j(n,["config"]);return l!=null&&C(t,["config"],l),t}function B8(e,n){const t={},r=j(n,["video","uri"]);r!=null&&C(t,["uri"],r);const a=j(n,["video","encodedVideo"]);a!=null&&C(t,["videoBytes"],su(e,a));const l=j(n,["encoding"]);return l!=null&&C(t,["mimeType"],l),t}function U8(e,n){const t={},r=j(n,["_self"]);return r!=null&&C(t,["video"],B8(e,r)),t}function q8(e,n){const t={},r=j(n,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(f=>U8(e,f))),C(t,["generatedVideos"],o)}const a=j(n,["raiMediaFilteredCount"]);a!=null&&C(t,["raiMediaFilteredCount"],a);const l=j(n,["raiMediaFilteredReasons"]);return l!=null&&C(t,["raiMediaFilteredReasons"],l),t}function V8(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["name"],r);const a=j(n,["metadata"]);a!=null&&C(t,["metadata"],a);const l=j(n,["done"]);l!=null&&C(t,["done"],l);const o=j(n,["error"]);o!=null&&C(t,["error"],o);const f=j(n,["response","generateVideoResponse"]);return f!=null&&C(t,["response"],q8(e,f)),t}function H8(e,n){const t={},r=j(n,["gcsUri"]);r!=null&&C(t,["uri"],r);const a=j(n,["bytesBase64Encoded"]);a!=null&&C(t,["videoBytes"],su(e,a));const l=j(n,["mimeType"]);return l!=null&&C(t,["mimeType"],l),t}function G8(e,n){const t={},r=j(n,["_self"]);return r!=null&&C(t,["video"],H8(e,r)),t}function Y8(e,n){const t={},r=j(n,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(f=>G8(e,f))),C(t,["generatedVideos"],o)}const a=j(n,["raiMediaFilteredCount"]);a!=null&&C(t,["raiMediaFilteredCount"],a);const l=j(n,["raiMediaFilteredReasons"]);return l!=null&&C(t,["raiMediaFilteredReasons"],l),t}function cj(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["name"],r);const a=j(n,["metadata"]);a!=null&&C(t,["metadata"],a);const l=j(n,["done"]);l!=null&&C(t,["done"],l);const o=j(n,["error"]);o!=null&&C(t,["error"],o);const f=j(n,["response"]);return f!=null&&C(t,["response"],Y8(e,f)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class W8 extends hg{constructor(n){super(),this.apiClient=n}async getVideosOperation(n){const t=n.operation,r=n.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=t.name.split("/operations/")[0];let l;return r&&"httpOptions"in r&&(l=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:a,config:{httpOptions:l}})}else return this.getVideosOperationInternal({operationName:t.name,config:r})}async getVideosOperationInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=$8(this.apiClient,n);return f=Bt("{operationName}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>cj(this.apiClient,h))}else{const d=F8(this.apiClient,n);return f=Bt("{operationName}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>V8(this.apiClient,h))}}async fetchPredictVideosOperationInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI()){const f=z8(this.apiClient,n);return l=Bt("{resourceName}:fetchPredictOperation",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>cj(this.apiClient,u))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Q8="Content-Type",J8="X-Server-Timeout",K8="User-Agent",X8="x-goog-api-client",Z8="0.14.1",eB=`google-genai-sdk/${Z8}`,tB="v1beta1",nB="v1beta",uj=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class J2 extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ClientError"}}class c1 extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ServerError"}}class iB{constructor(n){var t,r;this.clientOptions=Object.assign(Object.assign({},n),{project:n.project,location:n.location,apiKey:n.apiKey,vertexai:n.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:tB,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:nB,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,n.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,n.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var n;return(n=this.clientOptions.vertexai)!==null&&n!==void 0?n:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(n){if(!n||n.baseUrl===void 0||n.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[n.baseUrl.endsWith("/")?n.baseUrl.slice(0,-1):n.baseUrl];return n.apiVersion&&n.apiVersion!==""&&r.push(n.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const n=this.getBaseUrl(),t=new URL(n);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(n){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=n;else throw new Error("HTTP options are not correctly set.")}constructUrl(n,t,r){const a=[this.getRequestUrlInternal(t)];return r&&a.push(this.getBaseResourcePath()),n!==""&&a.push(n),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(n){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||n.path.startsWith("projects/")||n.httpMethod==="GET"&&n.path.startsWith("publishers/google/models"))}async request(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);if(n.queryParams)for(const[o,f]of Object.entries(n.queryParams))a.searchParams.append(o,String(f));let l={};if(n.httpMethod==="GET"){if(n.body&&n.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=n.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,t,n.abortSignal),this.unaryApiCall(a,l,n.httpMethod)}patchHttpOptions(n,t){const r=JSON.parse(JSON.stringify(n));for(const[a,l]of Object.entries(t))typeof l=="object"?r[a]=Object.assign(Object.assign({},r[a]),l):l!==void 0&&(r[a]=l);return r}async requestStream(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let l={};return l.body=n.body,l=await this.includeExtraHttpOptionsToRequestInit(l,t,n.abortSignal),this.streamApiCall(a,l,n.httpMethod)}async includeExtraHttpOptionsToRequestInit(n,t,r){if(t&&t.timeout||r){const a=new AbortController,l=a.signal;t.timeout&&(t==null?void 0:t.timeout)>0&&setTimeout(()=>a.abort(),t.timeout),r&&r.addEventListener("abort",()=>{a.abort()}),n.signal=l}return n.headers=await this.getHeadersInternal(t),n}async unaryApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await dj(a),new r1(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await dj(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(n){var t;return fb(this,arguments,function*(){const a=(t=n==null?void 0:n.body)===null||t===void 0?void 0:t.getReader(),l=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let o="";for(;;){const{done:f,value:u}=yield Pr(a.read());if(f){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=l.decode(u);try{const g=JSON.parse(d);if("error"in g){const b=JSON.parse(JSON.stringify(g.error)),v=b.status,S=b.code,k=`got status: ${v}. ${JSON.stringify(g)}`;if(S>=400&&S<500)throw new J2(k);if(S>=500&&S<600)throw new c1(k)}}catch(g){const b=g;if(b.name==="ClientError"||b.name==="ServerError")throw g}o+=d;let h=o.match(uj);for(;h;){const g=h[1];try{const b=new Response(g,{headers:n==null?void 0:n.headers,status:n==null?void 0:n.status,statusText:n==null?void 0:n.statusText});yield yield Pr(new r1(b)),o=o.slice(h[0].length),h=o.match(uj)}catch(b){throw new Error(`exception parsing stream chunk ${g}. ${b}`)}}}}finally{a.releaseLock()}})}async apiCall(n,t){return fetch(n,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const n={},t=eB+" "+this.clientOptions.userAgentExtra;return n[K8]=t,n[X8]=t,n[Q8]="application/json",n}async getHeadersInternal(n){const t=new Headers;if(n&&n.headers){for(const[r,a]of Object.entries(n.headers))t.append(r,a);n.timeout&&n.timeout>0&&t.append(J8,String(Math.ceil(n.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(n,t){var r;const a={};t!=null&&(a.mimeType=t.mimeType,a.name=t.name,a.displayName=t.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const l=this.clientOptions.uploader,o=await l.stat(n);a.sizeBytes=String(o.size);const f=(r=t==null?void 0:t.mimeType)!==null&&r!==void 0?r:o.type;if(f===void 0||f==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=f;const u=await this.fetchUploadUrl(a,t);return l.upload(n,u,this)}async downloadFile(n){await this.clientOptions.downloader.download(n,this)}async fetchUploadUrl(n,t){var r;let a={};t!=null&&t.httpOptions?a=t.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${n.mimeType}`}};const l={file:n},o=await this.request({path:Bt("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:a});if(!o||!(o!=null&&o.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const f=(r=o==null?void 0:o.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(f===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return f}}async function dj(e){var n;if(e===void 0)throw new c1("response is undefined");if(!e.ok){const t=e.status,r=e.statusText;let a;!((n=e.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?a=await e.json():a={error:{message:await e.text(),code:e.status,status:e.statusText}};const l=`got status: ${t} ${r}. ${JSON.stringify(a)}`;throw t>=400&&t<500?new J2(l):t>=500&&t<600?new c1(l):new Error(l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rB(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["_url","name"],r);const a=j(n,["config"]);return a!=null&&C(t,["config"],a),t}function aB(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&C(t,["_query","pageSize"],a);const l=j(n,["pageToken"]);t!==void 0&&l!=null&&C(t,["_query","pageToken"],l);const o=j(n,["filter"]);return t!==void 0&&o!=null&&C(t,["_query","filter"],o),r}function sB(e,n){const t={},r=j(n,["config"]);return r!=null&&C(t,["config"],aB(e,r,t)),t}function lB(e,n){const t={},r=j(n,["textInput"]);r!=null&&C(t,["textInput"],r);const a=j(n,["output"]);return a!=null&&C(t,["output"],a),t}function oB(e,n){const t={};if(j(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=j(n,["examples"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>lB(e,l))),C(t,["examples","examples"],a)}return t}function cB(e,n,t){const r={};if(j(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const a=j(n,["tunedModelDisplayName"]);if(t!==void 0&&a!=null&&C(t,["displayName"],a),j(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const l=j(n,["epochCount"]);t!==void 0&&l!=null&&C(t,["tuningTask","hyperparameters","epochCount"],l);const o=j(n,["learningRateMultiplier"]);if(o!=null&&C(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),j(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(j(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const f=j(n,["batchSize"]);t!==void 0&&f!=null&&C(t,["tuningTask","hyperparameters","batchSize"],f);const u=j(n,["learningRate"]);return t!==void 0&&u!=null&&C(t,["tuningTask","hyperparameters","learningRate"],u),r}function uB(e,n){const t={},r=j(n,["baseModel"]);r!=null&&C(t,["baseModel"],r);const a=j(n,["trainingDataset"]);a!=null&&C(t,["tuningTask","trainingData"],oB(e,a));const l=j(n,["config"]);return l!=null&&C(t,["config"],cB(e,l,t)),t}function dB(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["_url","name"],r);const a=j(n,["config"]);return a!=null&&C(t,["config"],a),t}function fB(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&C(t,["_query","pageSize"],a);const l=j(n,["pageToken"]);t!==void 0&&l!=null&&C(t,["_query","pageToken"],l);const o=j(n,["filter"]);return t!==void 0&&o!=null&&C(t,["_query","filter"],o),r}function hB(e,n){const t={},r=j(n,["config"]);return r!=null&&C(t,["config"],fB(e,r,t)),t}function pB(e,n,t){const r={},a=j(n,["gcsUri"]);if(t!==void 0&&a!=null&&C(t,["supervisedTuningSpec","trainingDatasetUri"],a),j(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function mB(e,n){const t={},r=j(n,["gcsUri"]);return r!=null&&C(t,["validationDatasetUri"],r),t}function gB(e,n,t){const r={},a=j(n,["validationDataset"]);t!==void 0&&a!=null&&C(t,["supervisedTuningSpec"],mB(e,a));const l=j(n,["tunedModelDisplayName"]);t!==void 0&&l!=null&&C(t,["tunedModelDisplayName"],l);const o=j(n,["description"]);t!==void 0&&o!=null&&C(t,["description"],o);const f=j(n,["epochCount"]);t!==void 0&&f!=null&&C(t,["supervisedTuningSpec","hyperParameters","epochCount"],f);const u=j(n,["learningRateMultiplier"]);t!==void 0&&u!=null&&C(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],u);const d=j(n,["exportLastCheckpointOnly"]);t!==void 0&&d!=null&&C(t,["supervisedTuningSpec","exportLastCheckpointOnly"],d);const h=j(n,["adapterSize"]);if(t!==void 0&&h!=null&&C(t,["supervisedTuningSpec","hyperParameters","adapterSize"],h),j(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(j(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function yB(e,n){const t={},r=j(n,["baseModel"]);r!=null&&C(t,["baseModel"],r);const a=j(n,["trainingDataset"]);a!=null&&C(t,["supervisedTuningSpec","trainingDatasetUri"],pB(e,a,t));const l=j(n,["config"]);return l!=null&&C(t,["config"],gB(e,l,t)),t}function xB(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["model"],r);const a=j(n,["name"]);return a!=null&&C(t,["endpoint"],a),t}function K2(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["name"],r);const a=j(n,["state"]);a!=null&&C(t,["state"],U2(e,a));const l=j(n,["createTime"]);l!=null&&C(t,["createTime"],l);const o=j(n,["tuningTask","startTime"]);o!=null&&C(t,["startTime"],o);const f=j(n,["tuningTask","completeTime"]);f!=null&&C(t,["endTime"],f);const u=j(n,["updateTime"]);u!=null&&C(t,["updateTime"],u);const d=j(n,["description"]);d!=null&&C(t,["description"],d);const h=j(n,["baseModel"]);h!=null&&C(t,["baseModel"],h);const g=j(n,["_self"]);g!=null&&C(t,["tunedModel"],xB(e,g));const b=j(n,["distillationSpec"]);b!=null&&C(t,["distillationSpec"],b);const v=j(n,["experiment"]);v!=null&&C(t,["experiment"],v);const S=j(n,["labels"]);S!=null&&C(t,["labels"],S);const k=j(n,["pipelineJob"]);k!=null&&C(t,["pipelineJob"],k);const T=j(n,["tunedModelDisplayName"]);return T!=null&&C(t,["tunedModelDisplayName"],T),t}function bB(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&C(t,["nextPageToken"],r);const a=j(n,["tunedModels"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(o=>K2(e,o))),C(t,["tuningJobs"],l)}return t}function vB(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["name"],r);const a=j(n,["metadata"]);a!=null&&C(t,["metadata"],a);const l=j(n,["done"]);l!=null&&C(t,["done"],l);const o=j(n,["error"]);return o!=null&&C(t,["error"],o),t}function wB(e,n){const t={},r=j(n,["checkpointId"]);r!=null&&C(t,["checkpointId"],r);const a=j(n,["epoch"]);a!=null&&C(t,["epoch"],a);const l=j(n,["step"]);l!=null&&C(t,["step"],l);const o=j(n,["endpoint"]);return o!=null&&C(t,["endpoint"],o),t}function NB(e,n){const t={},r=j(n,["model"]);r!=null&&C(t,["model"],r);const a=j(n,["endpoint"]);a!=null&&C(t,["endpoint"],a);const l=j(n,["checkpoints"]);if(l!=null){let o=l;Array.isArray(o)&&(o=o.map(f=>wB(e,f))),C(t,["checkpoints"],o)}return t}function u1(e,n){const t={},r=j(n,["name"]);r!=null&&C(t,["name"],r);const a=j(n,["state"]);a!=null&&C(t,["state"],U2(e,a));const l=j(n,["createTime"]);l!=null&&C(t,["createTime"],l);const o=j(n,["startTime"]);o!=null&&C(t,["startTime"],o);const f=j(n,["endTime"]);f!=null&&C(t,["endTime"],f);const u=j(n,["updateTime"]);u!=null&&C(t,["updateTime"],u);const d=j(n,["error"]);d!=null&&C(t,["error"],d);const h=j(n,["description"]);h!=null&&C(t,["description"],h);const g=j(n,["baseModel"]);g!=null&&C(t,["baseModel"],g);const b=j(n,["tunedModel"]);b!=null&&C(t,["tunedModel"],NB(e,b));const v=j(n,["supervisedTuningSpec"]);v!=null&&C(t,["supervisedTuningSpec"],v);const S=j(n,["tuningDataStats"]);S!=null&&C(t,["tuningDataStats"],S);const k=j(n,["encryptionSpec"]);k!=null&&C(t,["encryptionSpec"],k);const T=j(n,["partnerModelTuningSpec"]);T!=null&&C(t,["partnerModelTuningSpec"],T);const E=j(n,["distillationSpec"]);E!=null&&C(t,["distillationSpec"],E);const P=j(n,["experiment"]);P!=null&&C(t,["experiment"],P);const I=j(n,["labels"]);I!=null&&C(t,["labels"],I);const V=j(n,["pipelineJob"]);V!=null&&C(t,["pipelineJob"],V);const F=j(n,["tunedModelDisplayName"]);return F!=null&&C(t,["tunedModelDisplayName"],F),t}function SB(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&C(t,["nextPageToken"],r);const a=j(n,["tuningJobs"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(o=>u1(e,o))),C(t,["tuningJobs"],l)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class jB extends hg{constructor(n){super(),this.apiClient=n,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Rb(qh.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const r=await this.tuneMldevInternal(t);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:i1.JOB_STATE_QUEUED}}}}async getInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=dB(this.apiClient,n);return f=Bt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>u1(this.apiClient,h))}else{const d=rB(this.apiClient,n);return f=Bt("{name}",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>K2(this.apiClient,h))}}async listInternal(n){var t,r,a,l;let o,f="",u={};if(this.apiClient.isVertexAI()){const d=hB(this.apiClient,n);return f=Bt("tuningJobs",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const g=SB(this.apiClient,h),b=new KS;return Object.assign(b,g),b})}else{const d=sB(this.apiClient,n);return f=Bt("tunedModels",d._url),u=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:f,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=n.config)===null||l===void 0?void 0:l.abortSignal}).then(h=>h.json()),o.then(h=>{const g=bB(this.apiClient,h),b=new KS;return Object.assign(b,g),b})}}async tuneInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI()){const f=yB(this.apiClient,n);return l=Bt("tuningJobs",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>u1(this.apiClient,u))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(n){var t,r;let a,l="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=uB(this.apiClient,n);return l=Bt("tunedModels",f._url),o=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),a.then(u=>vB(this.apiClient,u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class CB{async download(n,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const _B=1024*1024*8,kB=3,EB=1e3,TB=2,i0="x-goog-upload-status";async function AB(e,n,t){var r,a,l;let o=0,f=0,u=new r1(new Response),d="upload";for(o=e.size;f<o;){const g=Math.min(_B,o-f),b=e.slice(f,f+g);f+g>=o&&(d+=", finalize");let v=0,S=EB;for(;v<kB&&(u=await t.request({path:"",body:b,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:n,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(f),"Content-Length":String(g)}}}),!(!((r=u==null?void 0:u.headers)===null||r===void 0)&&r[i0]));)v++,await PB(S),S=S*TB;if(f+=g,((a=u==null?void 0:u.headers)===null||a===void 0?void 0:a[i0])!=="active")break;if(o<=f)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const h=await(u==null?void 0:u.json());if(((l=u==null?void 0:u.headers)===null||l===void 0?void 0:l[i0])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return h.file}async function DB(e){return{size:e.size,type:e.type}}function PB(e){return new Promise(n=>setTimeout(n,e))}class IB{async upload(n,t,r){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await AB(n,t,r)}async stat(n){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await DB(n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class MB{create(n,t,r){return new RB(n,t,r)}}class RB{constructor(n,t,r){this.url=n,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(n){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(n)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fj="x-goog-api-key";class LB{constructor(n){this.apiKey=n}async addAuthHeaders(n){n.get(fj)===null&&n.append(fj,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const OB="gl-node/";class X2{constructor(n){var t;if(n.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(n.project||n.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=n.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=n.apiKey;const r=YF(n,void 0,void 0);r&&(n.httpOptions?n.httpOptions.baseUrl=r:n.httpOptions={baseUrl:r}),this.apiVersion=n.apiVersion;const a=new LB(this.apiKey);this.apiClient=new iB({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:n.httpOptions,userAgentExtra:OB+"web",uploader:new IB,downloader:new CB}),this.models=new O8(this.apiClient),this.live=new P8(this.apiClient,a,new MB),this.chats=new e5(this.models,this.apiClient),this.caches=new J6(this.apiClient),this.files=new h5(this.apiClient),this.operations=new W8(this.apiClient),this.tunings=new jB(this.apiClient)}}const wh=new Map,Z2=(()=>{const e=new Promise(n=>{window.addEventListener("pointerdown",n,{once:!0}),window.addEventListener("keydown",n,{once:!0})});return async n=>{try{const t=new Audio;if(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",await t.play(),n!=null&&n.id&&wh.has(n.id)){const a=wh.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&wh.set(n.id,r),r}catch{if(await e,n!=null&&n.id&&wh.has(n.id)){const a=wh.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&wh.set(n.id,r),r}}})();function FB(e){var n=atob(e),t=new Uint8Array(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t.buffer}const $B=`
class AudioProcessingWorklet extends AudioWorkletProcessor {

  // send and clear buffer every 2048 samples, 
  // which at 16khz is about 8 times a second
  buffer = new Int16Array(2048);

  // current write index
  bufferWriteIndex = 0;

  constructor() {
    super();
    this.hasAudio = false;
  }

  /**
   * @param inputs Float32Array[][] [input#][channel#][sample#] so to access first inputs 1st channel inputs[0][0]
   * @param outputs Float32Array[][]
   */
  process(inputs) {
    if (inputs[0].length) {
      const channel0 = inputs[0][0];
      this.processChunk(channel0);
    }
    return true;
  }

  sendAndClearBuffer(){
    this.port.postMessage({
      event: "chunk",
      data: {
        int16arrayBuffer: this.buffer.slice(0, this.bufferWriteIndex).buffer,
      },
    });
    this.bufferWriteIndex = 0;
  }

  processChunk(float32Array) {
    const l = float32Array.length;
    
    for (let i = 0; i < l; i++) {
      // convert float32 -1 to 1 to int16 -32768 to 32767
      const int16Value = float32Array[i] * 32768;
      this.buffer[this.bufferWriteIndex++] = int16Value;
      if(this.bufferWriteIndex >= this.buffer.length) {
        this.sendAndClearBuffer();
      }
    }

    if(this.bufferWriteIndex >= this.buffer.length) {
      this.sendAndClearBuffer();
    }
  }
}
`,ek=`
  class VolMeter extends AudioWorkletProcessor {
    volume
    updateIntervalInMS
    nextUpdateFrame

    constructor() {
      super()
      this.volume = 0
      this.updateIntervalInMS = 25
      this.nextUpdateFrame = this.updateIntervalInMS
      this.port.onmessage = event => {
        if (event.data.updateIntervalInMS) {
          this.updateIntervalInMS = event.data.updateIntervalInMS
        }
      }
    }

    get intervalInFrames() {
      return (this.updateIntervalInMS / 1000) * sampleRate
    }

    process(inputs) {
      const input = inputs[0]

      if (input.length > 0) {
        const samples = input[0]
        let sum = 0
        let rms = 0

        for (let i = 0; i < samples.length; ++i) {
          sum += samples[i] * samples[i]
        }

        rms = Math.sqrt(sum / samples.length)
        this.volume = Math.max(rms, this.volume * 0.7)

        this.nextUpdateFrame -= samples.length
        if (this.nextUpdateFrame < 0) {
          this.nextUpdateFrame += this.intervalInFrames
          this.port.postMessage({volume: this.volume})
        }
      }

      return true
    }
  }`,Cx=new Map,d1=(e,n)=>{const t=new Blob([`registerProcessor("${e}", ${n})`],{type:"application/javascript"});return URL.createObjectURL(t)};var r0={exports:{}},hj;function zB(){return hj||(hj=1,function(e){var n=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function a(u,d,h){this.fn=u,this.context=d,this.once=h||!1}function l(u,d,h,g,b){if(typeof h!="function")throw new TypeError("The listener must be a function");var v=new a(h,g||u,b),S=t?t+d:d;return u._events[S]?u._events[S].fn?u._events[S]=[u._events[S],v]:u._events[S].push(v):(u._events[S]=v,u._eventsCount++),u}function o(u,d){--u._eventsCount===0?u._events=new r:delete u._events[d]}function f(){this._events=new r,this._eventsCount=0}f.prototype.eventNames=function(){var d=[],h,g;if(this._eventsCount===0)return d;for(g in h=this._events)n.call(h,g)&&d.push(t?g.slice(1):g);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(h)):d},f.prototype.listeners=function(d){var h=t?t+d:d,g=this._events[h];if(!g)return[];if(g.fn)return[g.fn];for(var b=0,v=g.length,S=new Array(v);b<v;b++)S[b]=g[b].fn;return S},f.prototype.listenerCount=function(d){var h=t?t+d:d,g=this._events[h];return g?g.fn?1:g.length:0},f.prototype.emit=function(d,h,g,b,v,S){var k=t?t+d:d;if(!this._events[k])return!1;var T=this._events[k],E=arguments.length,P,I;if(T.fn){switch(T.once&&this.removeListener(d,T.fn,void 0,!0),E){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,h),!0;case 3:return T.fn.call(T.context,h,g),!0;case 4:return T.fn.call(T.context,h,g,b),!0;case 5:return T.fn.call(T.context,h,g,b,v),!0;case 6:return T.fn.call(T.context,h,g,b,v,S),!0}for(I=1,P=new Array(E-1);I<E;I++)P[I-1]=arguments[I];T.fn.apply(T.context,P)}else{var V=T.length,F;for(I=0;I<V;I++)switch(T[I].once&&this.removeListener(d,T[I].fn,void 0,!0),E){case 1:T[I].fn.call(T[I].context);break;case 2:T[I].fn.call(T[I].context,h);break;case 3:T[I].fn.call(T[I].context,h,g);break;case 4:T[I].fn.call(T[I].context,h,g,b);break;default:if(!P)for(F=1,P=new Array(E-1);F<E;F++)P[F-1]=arguments[F];T[I].fn.apply(T[I].context,P)}}return!0},f.prototype.on=function(d,h,g){return l(this,d,h,g,!1)},f.prototype.once=function(d,h,g){return l(this,d,h,g,!0)},f.prototype.removeListener=function(d,h,g,b){var v=t?t+d:d;if(!this._events[v])return this;if(!h)return o(this,v),this;var S=this._events[v];if(S.fn)S.fn===h&&(!b||S.once)&&(!g||S.context===g)&&o(this,v);else{for(var k=0,T=[],E=S.length;k<E;k++)(S[k].fn!==h||b&&!S[k].once||g&&S[k].context!==g)&&T.push(S[k]);T.length?this._events[v]=T.length===1?T[0]:T:o(this,v)}return this},f.prototype.removeAllListeners=function(d){var h;return d?(h=t?t+d:d,this._events[h]&&o(this,h)):(this._events=new r,this._eventsCount=0),this},f.prototype.off=f.prototype.removeListener,f.prototype.addListener=f.prototype.on,f.prefixed=t,f.EventEmitter=f,e.exports=f}(r0)),r0.exports}var BB=zB();const tk=Gd(BB);function UB(e){for(var n="",t=new Uint8Array(e),r=t.byteLength,a=0;a<r;a++)n+=String.fromCharCode(t[a]);return window.btoa(n)}class nk extends tk{constructor(t=16e3){super();Vn(this,"stream");Vn(this,"audioContext");Vn(this,"source");Vn(this,"recording",!1);Vn(this,"recordingWorklet");Vn(this,"vuWorklet");Vn(this,"starting",null);this.sampleRate=t}async start(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Could not request user media");this.starting=new Promise(async t=>{this.stream=await navigator.mediaDevices.getUserMedia({audio:!0}),this.audioContext=await Z2({sampleRate:this.sampleRate}),this.source=this.audioContext.createMediaStreamSource(this.stream);const r="audio-recorder-worklet",a=d1(r,$B);await this.audioContext.audioWorklet.addModule(a),this.recordingWorklet=new AudioWorkletNode(this.audioContext,r),this.recordingWorklet.port.onmessage=async o=>{const f=o.data.data.int16arrayBuffer;if(f){const u=UB(f);this.emit("data",u)}},this.source.connect(this.recordingWorklet);const l="vu-meter";await this.audioContext.audioWorklet.addModule(d1(l,ek)),this.vuWorklet=new AudioWorkletNode(this.audioContext,l),this.vuWorklet.port.onmessage=o=>{this.emit("volume",o.data.volume)},this.source.connect(this.vuWorklet),this.recording=!0,t(),this.starting=null})}stop(){const t=()=>{var r,a;(r=this.source)==null||r.disconnect(),(a=this.stream)==null||a.getTracks().forEach(l=>l.stop()),this.stream=void 0,this.recordingWorklet=void 0,this.vuWorklet=void 0,this.audioContext&&(this.audioContext.close(),this.audioContext=void 0)};if(this.starting){this.starting.then(t);return}t()}}const qB=3,VB=({active:e,volume:n,hover:t})=>{const r=w.useRef([]);return w.useEffect(()=>{let a=null;const l=()=>{r.current.forEach((o,f)=>{o&&(o.style.height=`${Math.min(24,4+n*(f===1?400:60))}px`)}),a=window.setTimeout(l,100)};return l(),()=>clearTimeout(a)},[n]),i.jsx("div",{className:Zc("audioPulse",{active:e,hover:t}),children:Array(qB).fill(null).map((a,l)=>i.jsx("div",{ref:o=>{r.current[l]=o},style:{animationDelay:`${l*133}ms`}},l))})};var Hm={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var HB=Hm.exports,pj;function GB(){return pj||(pj=1,function(e,n){(function(){var t,r="4.17.21",a=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",f="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",d=500,h="__lodash_placeholder__",g=1,b=2,v=4,S=1,k=2,T=1,E=2,P=4,I=8,V=16,F=32,O=64,B=128,U=256,z=512,$=30,R="...",H=800,ee=16,Z=1,te=2,Q=3,q=1/0,W=9007199254740991,ne=17976931348623157e292,A=NaN,ie=4294967295,se=ie-1,M=ie>>>1,ce=[["ary",B],["bind",T],["bindKey",E],["curry",I],["curryRight",V],["flip",z],["partial",F],["partialRight",O],["rearg",U]],ve="[object Arguments]",le="[object Array]",xe="[object AsyncFunction]",ue="[object Boolean]",ze="[object Date]",tt="[object DOMException]",ft="[object Error]",Re="[object Function]",je="[object GeneratorFunction]",he="[object Map]",Ae="[object Number]",we="[object Null]",Me="[object Object]",De="[object Promise]",Je="[object Proxy]",nt="[object RegExp]",Ge="[object Set]",St="[object String]",It="[object Symbol]",Vt="[object Undefined]",oe="[object WeakMap]",J="[object WeakSet]",de="[object ArrayBuffer]",Be="[object DataView]",be="[object Float32Array]",Fe="[object Float64Array]",$e="[object Int8Array]",st="[object Int16Array]",rt="[object Int32Array]",Le="[object Uint8Array]",Ve="[object Uint8ClampedArray]",qe="[object Uint16Array]",Ke="[object Uint32Array]",We=/\b__p \+= '';/g,zt=/\b(__p \+=) '' \+/g,_t=/(__e\(.*?\)|\b__t\)) \+\n'';/g,rn=/&(?:amp|lt|gt|quot|#39);/g,Ot=/[&<>"']/g,Yn=RegExp(rn.source),Wn=RegExp(Ot.source),Ei=/<%-([\s\S]+?)%>/g,Ti=/<%([\s\S]+?)%>/g,wn=/<%=([\s\S]+?)%>/g,Bn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ji=/^\w*$/,li=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ln=/[\\^$.*+?()[\]{}|]/g,oi=RegExp(Ln.source),Si=/^\s+/,Hi=/\s/,Yo=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qr=/\{\n\/\* \[wrapped with (.+)\] \*/,Qd=/,? & /,gs=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,du=/[()=,{}\[\]\/\s]/,Ks=/\\(\\)?/g,Xs=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,qa=/\w*$/,Zs=/^[-+]0x[0-9a-f]+$/i,ji=/^0b[01]+$/i,Jd=/^\[object .+?Constructor\]$/,Wo=/^0o[0-7]+$/i,ys=/^(?:0|[1-9]\d*)$/,Va=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ar=/($^)/,el=/['\n\r\u2028\u2029\\]/g,Ha="\\ud800-\\udfff",Kd="\\u0300-\\u036f",Ql="\\ufe20-\\ufe2f",tl="\\u20d0-\\u20ff",yr=Kd+Ql+tl,Jl="\\u2700-\\u27bf",Qo="a-z\\xdf-\\xf6\\xf8-\\xff",va="\\xac\\xb1\\xd7\\xf7",fu="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",hu="\\u2000-\\u206f",Xd=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pu="A-Z\\xc0-\\xd6\\xd8-\\xde",Ki="\\ufe0e\\ufe0f",mu=va+fu+hu+Xd,Jo="[']",Kl="["+Ha+"]",gu="["+mu+"]",Jr="["+yr+"]",yu="\\d+",Gi="["+Jl+"]",Xl="["+Qo+"]",nl="[^"+Ha+mu+yu+Jl+Qo+pu+"]",il="\\ud83c[\\udffb-\\udfff]",wa="(?:"+Jr+"|"+il+")",Ko="[^"+Ha+"]",xs="(?:\\ud83c[\\udde6-\\uddff]){2}",Na="[\\ud800-\\udbff][\\udc00-\\udfff]",Sa="["+pu+"]",rl="\\u200d",al="(?:"+Xl+"|"+nl+")",Xo="(?:"+Sa+"|"+nl+")",Zl="(?:"+Jo+"(?:d|ll|m|re|s|t|ve))?",Zo="(?:"+Jo+"(?:D|LL|M|RE|S|T|VE))?",bs=wa+"?",sl="["+Ki+"]?",eo="(?:"+rl+"(?:"+[Ko,xs,Na].join("|")+")"+sl+bs+")*",Ga="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ya="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",to=sl+bs+eo,no="(?:"+[Gi,xs,Na].join("|")+")"+to,Kr="(?:"+[Ko+Jr+"?",Jr,xs,Na,Kl].join("|")+")",vs=RegExp(Jo,"g"),Xr=RegExp(Jr,"g"),Or=RegExp(il+"(?="+il+")|"+Kr+to,"g"),ja=RegExp([Sa+"?"+Xl+"+"+Zl+"(?="+[gu,Sa,"$"].join("|")+")",Xo+"+"+Zo+"(?="+[gu,Sa+al,"$"].join("|")+")",Sa+"?"+al+"+"+Zl,Sa+"+"+Zo,Ya,Ga,yu,no].join("|"),"g"),Wa=RegExp("["+rl+Ha+yr+Ki+"]"),ll=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,io=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ec=-1,xn={};xn[be]=xn[Fe]=xn[$e]=xn[st]=xn[rt]=xn[Le]=xn[Ve]=xn[qe]=xn[Ke]=!0,xn[ve]=xn[le]=xn[de]=xn[ue]=xn[Be]=xn[ze]=xn[ft]=xn[Re]=xn[he]=xn[Ae]=xn[Me]=xn[nt]=xn[Ge]=xn[St]=xn[oe]=!1;var bn={};bn[ve]=bn[le]=bn[de]=bn[Be]=bn[ue]=bn[ze]=bn[be]=bn[Fe]=bn[$e]=bn[st]=bn[rt]=bn[he]=bn[Ae]=bn[Me]=bn[nt]=bn[Ge]=bn[St]=bn[It]=bn[Le]=bn[Ve]=bn[qe]=bn[Ke]=!0,bn[ft]=bn[Re]=bn[oe]=!1;var ro={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Xi={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ws={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},ol={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ns=parseFloat,Zd=parseInt,mn=typeof Xc=="object"&&Xc&&Xc.Object===Object&&Xc,ao=typeof self=="object"&&self&&self.Object===Object&&self,Un=mn||ao||Function("return this")(),Qa=n&&!n.nodeType&&n,xr=Qa&&!0&&e&&!e.nodeType&&e,cl=xr&&xr.exports===Qa,xu=cl&&mn.process,sr=function(){try{var Ce=xr&&xr.require&&xr.require("util").types;return Ce||xu&&xu.binding&&xu.binding("util")}catch{}}(),Ca=sr&&sr.isArrayBuffer,bu=sr&&sr.isDate,tc=sr&&sr.isMap,so=sr&&sr.isRegExp,Ss=sr&&sr.isSet,vu=sr&&sr.isTypedArray;function ci(Ce,He,Ue){switch(Ue.length){case 0:return Ce.call(He);case 1:return Ce.call(He,Ue[0]);case 2:return Ce.call(He,Ue[0],Ue[1]);case 3:return Ce.call(He,Ue[0],Ue[1],Ue[2])}return Ce.apply(He,Ue)}function nc(Ce,He,Ue,dt){for(var Ct=-1,an=Ce==null?0:Ce.length;++Ct<an;){var ui=Ce[Ct];He(dt,ui,Ue(ui),Ce)}return dt}function Zi(Ce,He){for(var Ue=-1,dt=Ce==null?0:Ce.length;++Ue<dt&&He(Ce[Ue],Ue,Ce)!==!1;);return Ce}function ul(Ce,He){for(var Ue=Ce==null?0:Ce.length;Ue--&&He(Ce[Ue],Ue,Ce)!==!1;);return Ce}function ef(Ce,He){for(var Ue=-1,dt=Ce==null?0:Ce.length;++Ue<dt;)if(!He(Ce[Ue],Ue,Ce))return!1;return!0}function Fr(Ce,He){for(var Ue=-1,dt=Ce==null?0:Ce.length,Ct=0,an=[];++Ue<dt;){var ui=Ce[Ue];He(ui,Ue,Ce)&&(an[Ct++]=ui)}return an}function Ja(Ce,He){var Ue=Ce==null?0:Ce.length;return!!Ue&&fl(Ce,He,0)>-1}function dl(Ce,He,Ue){for(var dt=-1,Ct=Ce==null?0:Ce.length;++dt<Ct;)if(Ue(He,Ce[dt]))return!0;return!1}function Dn(Ce,He){for(var Ue=-1,dt=Ce==null?0:Ce.length,Ct=Array(dt);++Ue<dt;)Ct[Ue]=He(Ce[Ue],Ue,Ce);return Ct}function $r(Ce,He){for(var Ue=-1,dt=He.length,Ct=Ce.length;++Ue<dt;)Ce[Ct+Ue]=He[Ue];return Ce}function wu(Ce,He,Ue,dt){var Ct=-1,an=Ce==null?0:Ce.length;for(dt&&an&&(Ue=Ce[++Ct]);++Ct<an;)Ue=He(Ue,Ce[Ct],Ct,Ce);return Ue}function ic(Ce,He,Ue,dt){var Ct=Ce==null?0:Ce.length;for(dt&&Ct&&(Ue=Ce[--Ct]);Ct--;)Ue=He(Ue,Ce[Ct],Ct,Ce);return Ue}function Nu(Ce,He){for(var Ue=-1,dt=Ce==null?0:Ce.length;++Ue<dt;)if(He(Ce[Ue],Ue,Ce))return!0;return!1}var ip=ac("length");function rp(Ce){return Ce.split("")}function ap(Ce){return Ce.match(gs)||[]}function tf(Ce,He,Ue){var dt;return Ue(Ce,function(Ct,an,ui){if(He(Ct,an,ui))return dt=an,!1}),dt}function rc(Ce,He,Ue,dt){for(var Ct=Ce.length,an=Ue+(dt?1:-1);dt?an--:++an<Ct;)if(He(Ce[an],an,Ce))return an;return-1}function fl(Ce,He,Ue){return He===He?sp(Ce,He,Ue):rc(Ce,hl,Ue)}function Su(Ce,He,Ue,dt){for(var Ct=Ue-1,an=Ce.length;++Ct<an;)if(dt(Ce[Ct],He))return Ct;return-1}function hl(Ce){return Ce!==Ce}function nf(Ce,He){var Ue=Ce==null?0:Ce.length;return Ue?sc(Ce,He)/Ue:A}function ac(Ce){return function(He){return He==null?t:He[Ce]}}function lo(Ce){return function(He){return Ce==null?t:Ce[He]}}function ju(Ce,He,Ue,dt,Ct){return Ct(Ce,function(an,ui,ae){Ue=dt?(dt=!1,an):He(Ue,an,ui,ae)}),Ue}function oo(Ce,He){var Ue=Ce.length;for(Ce.sort(He);Ue--;)Ce[Ue]=Ce[Ue].value;return Ce}function sc(Ce,He){for(var Ue,dt=-1,Ct=Ce.length;++dt<Ct;){var an=He(Ce[dt]);an!==t&&(Ue=Ue===t?an:Ue+an)}return Ue}function Yi(Ce,He){for(var Ue=-1,dt=Array(Ce);++Ue<Ce;)dt[Ue]=He(Ue);return dt}function Ka(Ce,He){return Dn(He,function(Ue){return[Ue,Ce[Ue]]})}function Zr(Ce){return Ce&&Ce.slice(0,Eu(Ce)+1).replace(Si,"")}function er(Ce){return function(He){return Ce(He)}}function co(Ce,He){return Dn(He,function(Ue){return Ce[Ue]})}function js(Ce,He){return Ce.has(He)}function Cs(Ce,He){for(var Ue=-1,dt=Ce.length;++Ue<dt&&fl(He,Ce[Ue],0)>-1;);return Ue}function Xa(Ce,He){for(var Ue=Ce.length;Ue--&&fl(He,Ce[Ue],0)>-1;);return Ue}function rf(Ce,He){for(var Ue=Ce.length,dt=0;Ue--;)Ce[Ue]===He&&++dt;return dt}var uo=lo(ro),af=lo(Xi);function Cu(Ce){return"\\"+ol[Ce]}function _u(Ce,He){return Ce==null?t:Ce[He]}function Za(Ce){return Wa.test(Ce)}function sf(Ce){return ll.test(Ce)}function lf(Ce){for(var He,Ue=[];!(He=Ce.next()).done;)Ue.push(He.value);return Ue}function lc(Ce){var He=-1,Ue=Array(Ce.size);return Ce.forEach(function(dt,Ct){Ue[++He]=[Ct,dt]}),Ue}function of(Ce,He){return function(Ue){return Ce(He(Ue))}}function lr(Ce,He){for(var Ue=-1,dt=Ce.length,Ct=0,an=[];++Ue<dt;){var ui=Ce[Ue];(ui===He||ui===h)&&(Ce[Ue]=h,an[Ct++]=Ue)}return an}function oc(Ce){var He=-1,Ue=Array(Ce.size);return Ce.forEach(function(dt){Ue[++He]=dt}),Ue}function ku(Ce){var He=-1,Ue=Array(Ce.size);return Ce.forEach(function(dt){Ue[++He]=[dt,dt]}),Ue}function sp(Ce,He,Ue){for(var dt=Ue-1,Ct=Ce.length;++dt<Ct;)if(Ce[dt]===He)return dt;return-1}function or(Ce,He,Ue){for(var dt=Ue+1;dt--;)if(Ce[dt]===He)return dt;return dt}function ea(Ce){return Za(Ce)?cf(Ce):ip(Ce)}function hi(Ce){return Za(Ce)?Au(Ce):rp(Ce)}function Eu(Ce){for(var He=Ce.length;He--&&Hi.test(Ce.charAt(He)););return He}var Tu=lo(ws);function cf(Ce){for(var He=Or.lastIndex=0;Or.test(Ce);)++He;return He}function Au(Ce){return Ce.match(Or)||[]}function lp(Ce){return Ce.match(ja)||[]}var pl=function Ce(He){He=He==null?Un:es.defaults(Un.Object(),He,es.pick(Un,io));var Ue=He.Array,dt=He.Date,Ct=He.Error,an=He.Function,ui=He.Math,ae=He.Object,ge=He.RegExp,pe=He.String,_e=He.TypeError,at=Ue.prototype,gt=an.prototype,yt=ae.prototype,pt=He["__core-js_shared__"],Ni=gt.toString,sn=yt.hasOwnProperty,cr=0,cc=function(){var m=/[^.]+$/.exec(pt&&pt.keys&&pt.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),pi=yt.toString,ta=Ni.call(ae),uc=Un._,op=ge("^"+Ni.call(sn).replace(Ln,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),fo=cl?He.Buffer:t,_a=He.Symbol,dc=He.Uint8Array,ho=fo?fo.allocUnsafe:t,Du=of(ae.getPrototypeOf,ae),Pu=ae.create,po=yt.propertyIsEnumerable,uf=at.splice,br=_a?_a.isConcatSpreadable:t,mo=_a?_a.iterator:t,ur=_a?_a.toStringTag:t,Iu=function(){try{var m=Sl(ae,"defineProperty");return m({},"",{}),m}catch{}}(),df=He.clearTimeout!==Un.clearTimeout&&He.clearTimeout,go=dt&&dt.now!==Un.Date.now&&dt.now,cp=He.setTimeout!==Un.setTimeout&&He.setTimeout,fc=ui.ceil,_s=ui.floor,ml=ae.getOwnPropertySymbols,ff=fo?fo.isBuffer:t,Mu=He.isFinite,na=at.join,ia=of(ae.keys,ae),Qn=ui.max,Zn=ui.min,ks=dt.now,yo=He.parseInt,up=ui.random,dp=at.reverse,Ru=Sl(He,"DataView"),Ai=Sl(He,"Map"),ei=Sl(He,"Promise"),ln=Sl(He,"Set"),ka=Sl(He,"WeakMap"),vr=Sl(ae,"create"),hc=ka&&new ka,ra={},vg=Ls(Ru),wg=Ls(Ai),Lu=Ls(ei),Ou=Ls(ln),Ng=Ls(ka),gl=_a?_a.prototype:t,xo=gl?gl.valueOf:t,yl=gl?gl.toString:t;function K(m){if(di(m)&&!Ft(m)&&!(m instanceof Xt)){if(m instanceof wr)return m;if(sn.call(m,"__wrapped__"))return Pi(m)}return new wr(m)}var zr=function(){function m(){}return function(y){if(!ni(y))return{};if(Pu)return Pu(y);m.prototype=y;var _=new m;return m.prototype=t,_}}();function aa(){}function wr(m,y){this.__wrapped__=m,this.__actions__=[],this.__chain__=!!y,this.__index__=0,this.__values__=t}K.templateSettings={escape:Ei,evaluate:Ti,interpolate:wn,variable:"",imports:{_:K}},K.prototype=aa.prototype,K.prototype.constructor=K,wr.prototype=zr(aa.prototype),wr.prototype.constructor=wr;function Xt(m){this.__wrapped__=m,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ie,this.__views__=[]}function Fu(){var m=new Xt(this.__wrapped__);return m.__actions__=Di(this.__actions__),m.__dir__=this.__dir__,m.__filtered__=this.__filtered__,m.__iteratees__=Di(this.__iteratees__),m.__takeCount__=this.__takeCount__,m.__views__=Di(this.__views__),m}function hf(){if(this.__filtered__){var m=new Xt(this);m.__dir__=-1,m.__filtered__=!0}else m=this.clone(),m.__dir__*=-1;return m}function bo(){var m=this.__wrapped__.value(),y=this.__dir__,_=Ft(m),L=y<0,Y=_?m.length:0,re=ty(0,Y,this.__views__),me=re.start,Ne=re.end,Ee=Ne-me,Xe=L?Ne:me-1,et=this.__iteratees__,it=et.length,ht=0,bt=Zn(Ee,this.__takeCount__);if(!_||!L&&Y==Ee&&bt==Ee)return Bg(m,this.__actions__);var Mt=[];e:for(;Ee--&&ht<bt;){Xe+=y;for(var en=-1,Rt=m[Xe];++en<it;){var un=et[en],yn=un.iteratee,Ma=un.type,Yr=yn(Rt);if(Ma==te)Rt=Yr;else if(!Yr){if(Ma==Z)continue e;break e}}Mt[ht++]=Rt}return Mt}Xt.prototype=zr(aa.prototype),Xt.prototype.constructor=Xt;function mi(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var L=m[y];this.set(L[0],L[1])}}function pf(){this.__data__=vr?vr(null):{},this.size=0}function Sg(m){var y=this.has(m)&&delete this.__data__[m];return this.size-=y?1:0,y}function Hb(m){var y=this.__data__;if(vr){var _=y[m];return _===u?t:_}return sn.call(y,m)?y[m]:t}function Gb(m){var y=this.__data__;return vr?y[m]!==t:sn.call(y,m)}function Yb(m,y){var _=this.__data__;return this.size+=this.has(m)?0:1,_[m]=vr&&y===t?u:y,this}mi.prototype.clear=pf,mi.prototype.delete=Sg,mi.prototype.get=Hb,mi.prototype.has=Gb,mi.prototype.set=Yb;function On(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var L=m[y];this.set(L[0],L[1])}}function fp(){this.__data__=[],this.size=0}function $u(m){var y=this.__data__,_=gc(y,m);if(_<0)return!1;var L=y.length-1;return _==L?y.pop():uf.call(y,_,1),--this.size,!0}function zu(m){var y=this.__data__,_=gc(y,m);return _<0?t:y[_][1]}function hp(m){return gc(this.__data__,m)>-1}function pc(m,y){var _=this.__data__,L=gc(_,m);return L<0?(++this.size,_.push([m,y])):_[L][1]=y,this}On.prototype.clear=fp,On.prototype.delete=$u,On.prototype.get=zu,On.prototype.has=hp,On.prototype.set=pc;function Nr(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var L=m[y];this.set(L[0],L[1])}}function Wb(){this.size=0,this.__data__={hash:new mi,map:new(Ai||On),string:new mi}}function jg(m){var y=Nc(this,m).delete(m);return this.size-=y?1:0,y}function Qb(m){return Nc(this,m).get(m)}function Cg(m){return Nc(this,m).has(m)}function vo(m,y){var _=Nc(this,m),L=_.size;return _.set(m,y),this.size+=_.size==L?0:1,this}Nr.prototype.clear=Wb,Nr.prototype.delete=jg,Nr.prototype.get=Qb,Nr.prototype.has=Cg,Nr.prototype.set=vo;function Es(m){var y=-1,_=m==null?0:m.length;for(this.__data__=new Nr;++y<_;)this.add(m[y])}function mf(m){return this.__data__.set(m,u),this}function _g(m){return this.__data__.has(m)}Es.prototype.add=Es.prototype.push=mf,Es.prototype.has=_g;function dr(m){var y=this.__data__=new On(m);this.size=y.size}function kg(){this.__data__=new On,this.size=0}function gf(m){var y=this.__data__,_=y.delete(m);return this.size=y.size,_}function pp(m){return this.__data__.get(m)}function Eg(m){return this.__data__.has(m)}function yf(m,y){var _=this.__data__;if(_ instanceof On){var L=_.__data__;if(!Ai||L.length<a-1)return L.push([m,y]),this.size=++_.size,this;_=this.__data__=new Nr(L)}return _.set(m,y),this.size=_.size,this}dr.prototype.clear=kg,dr.prototype.delete=gf,dr.prototype.get=pp,dr.prototype.has=Eg,dr.prototype.set=yf;function mp(m,y){var _=Ft(m),L=!_&&zs(m),Y=!_&&!L&&Il(m),re=!_&&!L&&!Y&&Lc(m),me=_||L||Y||re,Ne=me?Yi(m.length,pe):[],Ee=Ne.length;for(var Xe in m)(y||sn.call(m,Xe))&&!(me&&(Xe=="length"||Y&&(Xe=="offset"||Xe=="parent")||re&&(Xe=="buffer"||Xe=="byteLength"||Xe=="byteOffset")||Da(Xe,Ee)))&&Ne.push(Xe);return Ne}function mc(m){var y=m.length;return y?m[kf(0,y-1)]:t}function Tg(m,y){return hd(Di(m),Ta(y,0,m.length))}function Ag(m){return hd(Di(m))}function ts(m,y,_){(_!==t&&!Tr(m[y],_)||_===t&&!(y in m))&&Ea(m,y,_)}function wo(m,y,_){var L=m[y];(!(sn.call(m,y)&&Tr(L,_))||_===t&&!(y in m))&&Ea(m,y,_)}function gc(m,y){for(var _=m.length;_--;)if(Tr(m[_][0],y))return _;return-1}function xl(m,y,_,L){return As(m,function(Y,re,me){y(L,Y,_(Y),me)}),L}function Ts(m,y){return m&&Cr(y,Ri(y),m)}function Bu(m,y){return m&&Cr(y,zi(y),m)}function Ea(m,y,_){y=="__proto__"&&Iu?Iu(m,y,{configurable:!0,enumerable:!0,value:_,writable:!0}):m[y]=_}function Uu(m,y){for(var _=-1,L=y.length,Y=Ue(L),re=m==null;++_<L;)Y[_]=re?t:kd(m,y[_]);return Y}function Ta(m,y,_){return m===m&&(_!==t&&(m=m<=_?m:_),y!==t&&(m=m>=y?m:y)),m}function tr(m,y,_,L,Y,re){var me,Ne=y&g,Ee=y&b,Xe=y&v;if(_&&(me=Y?_(m,L,Y,re):_(m)),me!==t)return me;if(!ni(m))return m;var et=Ft(m);if(et){if(me=Bp(m),!Ne)return Di(m,me)}else{var it=$i(m),ht=it==Re||it==je;if(Il(m))return Ip(m,Ne);if(it==Me||it==ve||ht&&!Y){if(me=Ee||ht?{}:Up(m),!Ne)return Ee?td(m,Bu(me,m)):If(m,Ts(me,m))}else{if(!bn[it])return Y?m:{};me=qp(m,it,Ne)}}re||(re=new dr);var bt=re.get(m);if(bt)return bt;re.set(m,me),Yy(m)?m.forEach(function(Rt){me.add(tr(Rt,y,_,Rt,m,re))}):rh(m)&&m.forEach(function(Rt,un){me.set(un,tr(Rt,y,_,un,m,re))});var Mt=Xe?Ee?Of:Lf:Ee?zi:Ri,en=et?t:Mt(m);return Zi(en||m,function(Rt,un){en&&(un=Rt,Rt=m[un]),wo(me,un,tr(Rt,y,_,un,m,re))}),me}function Dg(m){var y=Ri(m);return function(_){return gp(_,m,y)}}function gp(m,y,_){var L=_.length;if(m==null)return!L;for(m=ae(m);L--;){var Y=_[L],re=y[Y],me=m[Y];if(me===t&&!(Y in m)||!re(me))return!1}return!0}function No(m,y,_){if(typeof m!="function")throw new _e(o);return jc(function(){m.apply(t,_)},y)}function bl(m,y,_,L){var Y=-1,re=Ja,me=!0,Ne=m.length,Ee=[],Xe=y.length;if(!Ne)return Ee;_&&(y=Dn(y,er(_))),L?(re=dl,me=!1):y.length>=a&&(re=js,me=!1,y=new Es(y));e:for(;++Y<Ne;){var et=m[Y],it=_==null?et:_(et);if(et=L||et!==0?et:0,me&&it===it){for(var ht=Xe;ht--;)if(y[ht]===it)continue e;Ee.push(et)}else re(y,it,L)||Ee.push(et)}return Ee}var As=Op(nr),xf=Op(xc,!0);function yp(m,y){var _=!0;return As(m,function(L,Y,re){return _=!!y(L,Y,re),_}),_}function Aa(m,y,_){for(var L=-1,Y=m.length;++L<Y;){var re=m[L],me=y(re);if(me!=null&&(Ne===t?me===me&&!pr(me):_(me,Ne)))var Ne=me,Ee=re}return Ee}function Wt(m,y,_,L){var Y=m.length;for(_=qt(_),_<0&&(_=-_>Y?0:Y+_),L=L===t||L>Y?Y:qt(L),L<0&&(L+=Y),L=_>L?0:us(L);_<L;)m[_++]=y;return m}function Cn(m,y){var _=[];return As(m,function(L,Y,re){y(L,Y,re)&&_.push(L)}),_}function on(m,y,_,L,Y){var re=-1,me=m.length;for(_||(_=Ms),Y||(Y=[]);++re<me;){var Ne=m[re];y>0&&_(Ne)?y>1?on(Ne,y-1,_,L,Y):$r(Y,Ne):L||(Y[Y.length]=Ne)}return Y}var yc=To(),So=To(!0);function nr(m,y){return m&&yc(m,y,Ri)}function xc(m,y){return m&&So(m,y,Ri)}function vl(m,y){return Fr(y,function(_){return Pa(m[_])})}function sa(m,y){y=Ps(y,m);for(var _=0,L=y.length;m!=null&&_<L;)m=m[jn(y[_++])];return _&&_==L?m:t}function Pg(m,y,_){var L=y(m);return Ft(m)?L:$r(L,_(m))}function cn(m){return m==null?m===t?Vt:we:ur&&ur in ae(m)?ey(m):sy(m)}function qu(m,y){return m>y}function xp(m,y){return m!=null&&sn.call(m,y)}function Ig(m,y){return m!=null&&y in ae(m)}function Mg(m,y,_){return m>=Zn(y,_)&&m<Qn(y,_)}function bp(m,y,_){for(var L=_?dl:Ja,Y=m[0].length,re=m.length,me=re,Ne=Ue(re),Ee=1/0,Xe=[];me--;){var et=m[me];me&&y&&(et=Dn(et,er(y))),Ee=Zn(et.length,Ee),Ne[me]=!_&&(y||Y>=120&&et.length>=120)?new Es(me&&et):t}et=m[0];var it=-1,ht=Ne[0];e:for(;++it<Y&&Xe.length<Ee;){var bt=et[it],Mt=y?y(bt):bt;if(bt=_||bt!==0?bt:0,!(ht?js(ht,Mt):L(Xe,Mt,_))){for(me=re;--me;){var en=Ne[me];if(!(en?js(en,Mt):L(m[me],Mt,_)))continue e}ht&&ht.push(Mt),Xe.push(bt)}}return Xe}function vp(m,y,_,L){return nr(m,function(Y,re,me){y(L,_(Y),re,me)}),L}function jo(m,y,_){y=Ps(y,m),m=Sc(m,y);var L=m==null?m:m[jn(ir(y))];return L==null?t:ci(L,m,_)}function bf(m){return di(m)&&cn(m)==ve}function Sr(m){return di(m)&&cn(m)==de}function Ci(m){return di(m)&&cn(m)==ze}function Co(m,y,_,L,Y){return m===y?!0:m==null||y==null||!di(m)&&!di(y)?m!==m&&y!==y:Vu(m,y,_,L,Co,Y)}function Vu(m,y,_,L,Y,re){var me=Ft(m),Ne=Ft(y),Ee=me?le:$i(m),Xe=Ne?le:$i(y);Ee=Ee==ve?Me:Ee,Xe=Xe==ve?Me:Xe;var et=Ee==Me,it=Xe==Me,ht=Ee==Xe;if(ht&&Il(m)){if(!Il(y))return!1;me=!0,et=!1}if(ht&&!et)return re||(re=new dr),me||Lc(m)?Xg(m,y,_,L,Y,re):Zg(m,y,Ee,_,L,Y,re);if(!(_&S)){var bt=et&&sn.call(m,"__wrapped__"),Mt=it&&sn.call(y,"__wrapped__");if(bt||Mt){var en=bt?m.value():m,Rt=Mt?y.value():y;return re||(re=new dr),Y(en,Rt,_,L,re)}}return ht?(re||(re=new dr),Fi(m,y,_,L,Y,re)):!1}function vf(m){return di(m)&&$i(m)==he}function Hu(m,y,_,L){var Y=_.length,re=Y,me=!L;if(m==null)return!re;for(m=ae(m);Y--;){var Ne=_[Y];if(me&&Ne[2]?Ne[1]!==m[Ne[0]]:!(Ne[0]in m))return!1}for(;++Y<re;){Ne=_[Y];var Ee=Ne[0],Xe=m[Ee],et=Ne[1];if(me&&Ne[2]){if(Xe===t&&!(Ee in m))return!1}else{var it=new dr;if(L)var ht=L(Xe,et,Ee,m,y,it);if(!(ht===t?Co(et,Xe,S|k,L,it):ht))return!1}}return!0}function ns(m){if(!ni(m)||qf(m))return!1;var y=Pa(m)?op:Jd;return y.test(Ls(m))}function wf(m){return di(m)&&cn(m)==nt}function wp(m){return di(m)&&$i(m)==Ge}function Np(m){return di(m)&&Mo(m.length)&&!!xn[cn(m)]}function Sp(m){return typeof m=="function"?m:m==null?Ie:typeof m=="object"?Ft(m)?jf(m[0],m[1]):Cp(m):gn(m)}function Nf(m){if(!Fn(m))return ia(m);var y=[];for(var _ in ae(m))sn.call(m,_)&&_!="constructor"&&y.push(_);return y}function Rg(m){if(!ni(m))return jl(m);var y=Fn(m),_=[];for(var L in m)L=="constructor"&&(y||!sn.call(m,L))||_.push(L);return _}function Sf(m,y){return m<y}function jp(m,y){var _=-1,L=Ii(m)?Ue(m.length):[];return As(m,function(Y,re,me){L[++_]=y(Y,re,me)}),L}function Cp(m){var y=$f(m);return y.length==1&&y[0][2]?ry(y[0][0],y[0][1]):function(_){return _===m||Hu(_,m,y)}}function jf(m,y){return Bf(m)&&iy(y)?ry(jn(m),y):function(_){var L=kd(_,m);return L===t&&L===y?zc(_,m):Co(y,L,S|k)}}function Gu(m,y,_,L,Y){m!==y&&yc(y,function(re,me){if(Y||(Y=new dr),ni(re))Jb(m,y,me,_,Gu,L,Y);else{var Ne=L?L(Vf(m,me),re,me+"",m,y,Y):t;Ne===t&&(Ne=re),ts(m,me,Ne)}},zi)}function Jb(m,y,_,L,Y,re,me){var Ne=Vf(m,_),Ee=Vf(y,_),Xe=me.get(Ee);if(Xe){ts(m,_,Xe);return}var et=re?re(Ne,Ee,_+"",m,y,me):t,it=et===t;if(it){var ht=Ft(Ee),bt=!ht&&Il(Ee),Mt=!ht&&!bt&&Lc(Ee);et=Ee,ht||bt||Mt?Ft(Ne)?et=Ne:xi(Ne)?et=Di(Ne):bt?(it=!1,et=Ip(Ee,!0)):Mt?(it=!1,et=Rp(Ee,!0)):et=[]:ua(Ee)||zs(Ee)?(et=Ne,zs(Ne)?et=Jy(Ne):(!ni(Ne)||Pa(Ne))&&(et=Up(Ee))):it=!1}it&&(me.set(Ee,et),Y(et,Ee,L,re,me),me.delete(Ee)),ts(m,_,et)}function _p(m,y){var _=m.length;if(_)return y+=y<0?_:0,Da(y,_)?m[y]:t}function kp(m,y,_){y.length?y=Dn(y,function(re){return Ft(re)?function(me){return sa(me,re.length===1?re[0]:re)}:re}):y=[Ie];var L=-1;y=Dn(y,er(Nt()));var Y=jp(m,function(re,me,Ne){var Ee=Dn(y,function(Xe){return Xe(re)});return{criteria:Ee,index:++L,value:re}});return oo(Y,function(re,me){return Hg(re,me,_)})}function Lg(m,y){return Cf(m,y,function(_,L){return zc(m,L)})}function Cf(m,y,_){for(var L=-1,Y=y.length,re={};++L<Y;){var me=y[L],Ne=sa(m,me);_(Ne,me)&&vc(re,Ps(me,m),Ne)}return re}function Og(m){return function(y){return sa(y,m)}}function _f(m,y,_,L){var Y=L?Su:fl,re=-1,me=y.length,Ne=m;for(m===y&&(y=Di(y)),_&&(Ne=Dn(m,er(_)));++re<me;)for(var Ee=0,Xe=y[re],et=_?_(Xe):Xe;(Ee=Y(Ne,et,Ee,L))>-1;)Ne!==m&&uf.call(Ne,Ee,1),uf.call(m,Ee,1);return m}function Ep(m,y){for(var _=m?y.length:0,L=_-1;_--;){var Y=y[_];if(_==L||Y!==re){var re=Y;Da(Y)?uf.call(m,Y,1):Ju(m,Y)}}return m}function kf(m,y){return m+_s(up()*(y-m+1))}function Fg(m,y,_,L){for(var Y=-1,re=Qn(fc((y-m)/(_||1)),0),me=Ue(re);re--;)me[L?re:++Y]=m,m+=_;return me}function Tp(m,y){var _="";if(!m||y<1||y>W)return _;do y%2&&(_+=m),y=_s(y/2),y&&(m+=m);while(y);return _}function Gt(m,y){return dd(Vp(m,y,Ie),m+"")}function bc(m){return mc(Uc(m))}function Ef(m,y){var _=Uc(m);return hd(_,Ta(y,0,_.length))}function vc(m,y,_,L){if(!ni(m))return m;y=Ps(y,m);for(var Y=-1,re=y.length,me=re-1,Ne=m;Ne!=null&&++Y<re;){var Ee=jn(y[Y]),Xe=_;if(Ee==="__proto__"||Ee==="constructor"||Ee==="prototype")return m;if(Y!=me){var et=Ne[Ee];Xe=L?L(et,Ee,Ne):t,Xe===t&&(Xe=ni(et)?et:Da(y[Y+1])?[]:{})}wo(Ne,Ee,Xe),Ne=Ne[Ee]}return m}var Yu=hc?function(m,y){return hc.set(m,y),m}:Ie,Wu=Iu?function(m,y){return Iu(m,"toString",{configurable:!0,enumerable:!1,value:Pe(y),writable:!0})}:Ie;function $g(m){return hd(Uc(m))}function Br(m,y,_){var L=-1,Y=m.length;y<0&&(y=-y>Y?0:Y+y),_=_>Y?Y:_,_<0&&(_+=Y),Y=y>_?0:_-y>>>0,y>>>=0;for(var re=Ue(Y);++L<Y;)re[L]=m[L+y];return re}function zg(m,y){var _;return As(m,function(L,Y,re){return _=y(L,Y,re),!_}),!!_}function Qu(m,y,_){var L=0,Y=m==null?L:m.length;if(typeof y=="number"&&y===y&&Y<=M){for(;L<Y;){var re=L+Y>>>1,me=m[re];me!==null&&!pr(me)&&(_?me<=y:me<y)?L=re+1:Y=re}return Y}return Tf(m,y,Ie,_)}function Tf(m,y,_,L){var Y=0,re=m==null?0:m.length;if(re===0)return 0;y=_(y);for(var me=y!==y,Ne=y===null,Ee=pr(y),Xe=y===t;Y<re;){var et=_s((Y+re)/2),it=_(m[et]),ht=it!==t,bt=it===null,Mt=it===it,en=pr(it);if(me)var Rt=L||Mt;else Xe?Rt=Mt&&(L||ht):Ne?Rt=Mt&&ht&&(L||!bt):Ee?Rt=Mt&&ht&&!bt&&(L||!en):bt||en?Rt=!1:Rt=L?it<=y:it<y;Rt?Y=et+1:re=et}return Zn(re,se)}function Ap(m,y){for(var _=-1,L=m.length,Y=0,re=[];++_<L;){var me=m[_],Ne=y?y(me):me;if(!_||!Tr(Ne,Ee)){var Ee=Ne;re[Y++]=me===0?0:me}}return re}function Af(m){return typeof m=="number"?m:pr(m)?A:+m}function jr(m){if(typeof m=="string")return m;if(Ft(m))return Dn(m,jr)+"";if(pr(m))return yl?yl.call(m):"";var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function Ds(m,y,_){var L=-1,Y=Ja,re=m.length,me=!0,Ne=[],Ee=Ne;if(_)me=!1,Y=dl;else if(re>=a){var Xe=y?null:Jg(m);if(Xe)return oc(Xe);me=!1,Y=js,Ee=new Es}else Ee=y?[]:Ne;e:for(;++L<re;){var et=m[L],it=y?y(et):et;if(et=_||et!==0?et:0,me&&it===it){for(var ht=Ee.length;ht--;)if(Ee[ht]===it)continue e;y&&Ee.push(it),Ne.push(et)}else Y(Ee,it,_)||(Ee!==Ne&&Ee.push(it),Ne.push(et))}return Ne}function Ju(m,y){return y=Ps(y,m),m=Sc(m,y),m==null||delete m[jn(ir(y))]}function Dp(m,y,_,L){return vc(m,y,_(sa(m,y)),L)}function Ku(m,y,_,L){for(var Y=m.length,re=L?Y:-1;(L?re--:++re<Y)&&y(m[re],re,m););return _?Br(m,L?0:re,L?re+1:Y):Br(m,L?re+1:0,L?Y:re)}function Bg(m,y){var _=m;return _ instanceof Xt&&(_=_.value()),wu(y,function(L,Y){return Y.func.apply(Y.thisArg,$r([L],Y.args))},_)}function Xu(m,y,_){var L=m.length;if(L<2)return L?Ds(m[0]):[];for(var Y=-1,re=Ue(L);++Y<L;)for(var me=m[Y],Ne=-1;++Ne<L;)Ne!=Y&&(re[Y]=bl(re[Y]||me,m[Ne],y,_));return Ds(on(re,1),y,_)}function Pp(m,y,_){for(var L=-1,Y=m.length,re=y.length,me={};++L<Y;){var Ne=L<re?y[L]:t;_(me,m[L],Ne)}return me}function Df(m){return xi(m)?m:[]}function Zu(m){return typeof m=="function"?m:Ie}function Ps(m,y){return Ft(m)?m:Bf(m,y)?[m]:ss(Nn(m))}var Ug=Gt;function wl(m,y,_){var L=m.length;return _=_===t?L:_,!y&&_>=L?m:Br(m,y,_)}var qg=df||function(m){return Un.clearTimeout(m)};function Ip(m,y){if(y)return m.slice();var _=m.length,L=ho?ho(_):new m.constructor(_);return m.copy(L),L}function _o(m){var y=new m.constructor(m.byteLength);return new dc(y).set(new dc(m)),y}function Mp(m,y){var _=y?_o(m.buffer):m.buffer;return new m.constructor(_,m.byteOffset,m.byteLength)}function Pf(m){var y=new m.constructor(m.source,qa.exec(m));return y.lastIndex=m.lastIndex,y}function Vg(m){return xo?ae(xo.call(m)):{}}function Rp(m,y){var _=y?_o(m.buffer):m.buffer;return new m.constructor(_,m.byteOffset,m.length)}function ed(m,y){if(m!==y){var _=m!==t,L=m===null,Y=m===m,re=pr(m),me=y!==t,Ne=y===null,Ee=y===y,Xe=pr(y);if(!Ne&&!Xe&&!re&&m>y||re&&me&&Ee&&!Ne&&!Xe||L&&me&&Ee||!_&&Ee||!Y)return 1;if(!L&&!re&&!Xe&&m<y||Xe&&_&&Y&&!L&&!re||Ne&&_&&Y||!me&&Y||!Ee)return-1}return 0}function Hg(m,y,_){for(var L=-1,Y=m.criteria,re=y.criteria,me=Y.length,Ne=_.length;++L<me;){var Ee=ed(Y[L],re[L]);if(Ee){if(L>=Ne)return Ee;var Xe=_[L];return Ee*(Xe=="desc"?-1:1)}}return m.index-y.index}function Lp(m,y,_,L){for(var Y=-1,re=m.length,me=_.length,Ne=-1,Ee=y.length,Xe=Qn(re-me,0),et=Ue(Ee+Xe),it=!L;++Ne<Ee;)et[Ne]=y[Ne];for(;++Y<me;)(it||Y<re)&&(et[_[Y]]=m[Y]);for(;Xe--;)et[Ne++]=m[Y++];return et}function Gg(m,y,_,L){for(var Y=-1,re=m.length,me=-1,Ne=_.length,Ee=-1,Xe=y.length,et=Qn(re-Ne,0),it=Ue(et+Xe),ht=!L;++Y<et;)it[Y]=m[Y];for(var bt=Y;++Ee<Xe;)it[bt+Ee]=y[Ee];for(;++me<Ne;)(ht||Y<re)&&(it[bt+_[me]]=m[Y++]);return it}function Di(m,y){var _=-1,L=m.length;for(y||(y=Ue(L));++_<L;)y[_]=m[_];return y}function Cr(m,y,_,L){var Y=!_;_||(_={});for(var re=-1,me=y.length;++re<me;){var Ne=y[re],Ee=L?L(_[Ne],m[Ne],Ne,_,m):t;Ee===t&&(Ee=m[Ne]),Y?Ea(_,Ne,Ee):wo(_,Ne,Ee)}return _}function If(m,y){return Cr(m,ld(m),y)}function td(m,y){return Cr(m,zf(m),y)}function ko(m,y){return function(_,L){var Y=Ft(_)?nc:xl,re=y?y():{};return Y(_,m,Nt(L,2),re)}}function Eo(m){return Gt(function(y,_){var L=-1,Y=_.length,re=Y>1?_[Y-1]:t,me=Y>2?_[2]:t;for(re=m.length>3&&typeof re=="function"?(Y--,re):t,me&&hr(_[0],_[1],me)&&(re=Y<3?t:re,Y=1),y=ae(y);++L<Y;){var Ne=_[L];Ne&&m(y,Ne,L,re)}return y})}function Op(m,y){return function(_,L){if(_==null)return _;if(!Ii(_))return m(_,L);for(var Y=_.length,re=y?Y:-1,me=ae(_);(y?re--:++re<Y)&&L(me[re],re,me)!==!1;);return _}}function To(m){return function(y,_,L){for(var Y=-1,re=ae(y),me=L(y),Ne=me.length;Ne--;){var Ee=me[m?Ne:++Y];if(_(re[Ee],Ee,re)===!1)break}return y}}function Yg(m,y,_){var L=y&T,Y=la(m);function re(){var me=this&&this!==Un&&this instanceof re?Y:m;return me.apply(L?_:this,arguments)}return re}function Ur(m){return function(y){y=Nn(y);var _=Za(y)?hi(y):t,L=_?_[0]:y.charAt(0),Y=_?wl(_,1).join(""):y.slice(1);return L[m]()+Y}}function fr(m){return function(y){return wu(N(Bs(y).replace(vs,"")),m,"")}}function la(m){return function(){var y=arguments;switch(y.length){case 0:return new m;case 1:return new m(y[0]);case 2:return new m(y[0],y[1]);case 3:return new m(y[0],y[1],y[2]);case 4:return new m(y[0],y[1],y[2],y[3]);case 5:return new m(y[0],y[1],y[2],y[3],y[4]);case 6:return new m(y[0],y[1],y[2],y[3],y[4],y[5]);case 7:return new m(y[0],y[1],y[2],y[3],y[4],y[5],y[6])}var _=zr(m.prototype),L=m.apply(_,y);return ni(L)?L:_}}function Wg(m,y,_){var L=la(m);function Y(){for(var re=arguments.length,me=Ue(re),Ne=re,Ee=Do(Y);Ne--;)me[Ne]=arguments[Ne];var Xe=re<3&&me[0]!==Ee&&me[re-1]!==Ee?[]:lr(me,Ee);if(re-=Xe.length,re<_)return Fp(m,y,gi,Y.placeholder,t,me,Xe,t,t,_-re);var et=this&&this!==Un&&this instanceof Y?L:m;return ci(et,this,me)}return Y}function Is(m){return function(y,_,L){var Y=ae(y);if(!Ii(y)){var re=Nt(_,3);y=Ri(y),_=function(Ne){return re(Y[Ne],Ne,Y)}}var me=m(y,_,L);return me>-1?Y[re?y[me]:me]:t}}function is(m){return Jn(function(y){var _=y.length,L=_,Y=wr.prototype.thru;for(m&&y.reverse();L--;){var re=y[L];if(typeof re!="function")throw new _e(o);if(Y&&!me&&sd(re)=="wrapper")var me=new wr([],!0)}for(L=me?L:_;++L<_;){re=y[L];var Ne=sd(re),Ee=Ne=="wrapper"?Ff(re):t;Ee&&Uf(Ee[0])&&Ee[1]==(B|I|F|U)&&!Ee[4].length&&Ee[9]==1?me=me[sd(Ee[0])].apply(me,Ee[3]):me=re.length==1&&Uf(re)?me[Ne]():me.thru(re)}return function(){var Xe=arguments,et=Xe[0];if(me&&Xe.length==1&&Ft(et))return me.plant(et).value();for(var it=0,ht=_?y[it].apply(this,Xe):et;++it<_;)ht=y[it].call(this,ht);return ht}})}function gi(m,y,_,L,Y,re,me,Ne,Ee,Xe){var et=y&B,it=y&T,ht=y&E,bt=y&(I|V),Mt=y&z,en=ht?t:la(m);function Rt(){for(var un=arguments.length,yn=Ue(un),Ma=un;Ma--;)yn[Ma]=arguments[Ma];if(bt)var Yr=Do(Rt),Ra=rf(yn,Yr);if(L&&(yn=Lp(yn,L,Y,bt)),re&&(yn=Gg(yn,re,me,bt)),un-=Ra,bt&&un<Xe){var Li=lr(yn,Yr);return Fp(m,y,gi,Rt.placeholder,_,yn,Li,Ne,Ee,Xe-un)}var Us=it?_:this,Ro=ht?Us[m]:m;return un=yn.length,Ne?yn=as(yn,Ne):Mt&&un>1&&yn.reverse(),et&&Ee<un&&(yn.length=Ee),this&&this!==Un&&this instanceof Rt&&(Ro=en||la(Ro)),Ro.apply(Us,yn)}return Rt}function nd(m,y){return function(_,L){return vp(_,m,y(L),{})}}function wc(m,y){return function(_,L){var Y;if(_===t&&L===t)return y;if(_!==t&&(Y=_),L!==t){if(Y===t)return L;typeof _=="string"||typeof L=="string"?(_=jr(_),L=jr(L)):(_=Af(_),L=Af(L)),Y=m(_,L)}return Y}}function id(m){return Jn(function(y){return y=Dn(y,er(Nt())),Gt(function(_){var L=this;return m(y,function(Y){return ci(Y,L,_)})})})}function rd(m,y){y=y===t?" ":jr(y);var _=y.length;if(_<2)return _?Tp(y,m):y;var L=Tp(y,fc(m/ea(y)));return Za(y)?wl(hi(L),0,m).join(""):L.slice(0,m)}function Qg(m,y,_,L){var Y=y&T,re=la(m);function me(){for(var Ne=-1,Ee=arguments.length,Xe=-1,et=L.length,it=Ue(et+Ee),ht=this&&this!==Un&&this instanceof me?re:m;++Xe<et;)it[Xe]=L[Xe];for(;Ee--;)it[Xe++]=arguments[++Ne];return ci(ht,Y?_:this,it)}return me}function Nl(m){return function(y,_,L){return L&&typeof L!="number"&&hr(y,_,L)&&(_=L=t),y=cs(y),_===t?(_=y,y=0):_=cs(_),L=L===t?y<_?1:-1:cs(L),Fg(y,_,L,m)}}function Ao(m){return function(y,_){return typeof y=="string"&&typeof _=="string"||(y=da(y),_=da(_)),m(y,_)}}function Fp(m,y,_,L,Y,re,me,Ne,Ee,Xe){var et=y&I,it=et?me:t,ht=et?t:me,bt=et?re:t,Mt=et?t:re;y|=et?F:O,y&=~(et?O:F),y&P||(y&=-4);var en=[m,y,Y,bt,it,Mt,ht,Ne,Ee,Xe],Rt=_.apply(t,en);return Uf(m)&&Hf(Rt,en),Rt.placeholder=L,Gf(Rt,m,y)}function Mf(m){var y=ui[m];return function(_,L){if(_=da(_),L=L==null?0:Zn(qt(L),292),L&&Mu(_)){var Y=(Nn(_)+"e").split("e"),re=y(Y[0]+"e"+(+Y[1]+L));return Y=(Nn(re)+"e").split("e"),+(Y[0]+"e"+(+Y[1]-L))}return y(_)}}var Jg=ln&&1/oc(new ln([,-0]))[1]==q?function(m){return new ln(m)}:xt;function ad(m){return function(y){var _=$i(y);return _==he?lc(y):_==Ge?ku(y):Ka(y,m(y))}}function rs(m,y,_,L,Y,re,me,Ne){var Ee=y&E;if(!Ee&&typeof m!="function")throw new _e(o);var Xe=L?L.length:0;if(Xe||(y&=-97,L=Y=t),me=me===t?me:Qn(qt(me),0),Ne=Ne===t?Ne:qt(Ne),Xe-=Y?Y.length:0,y&O){var et=L,it=Y;L=Y=t}var ht=Ee?t:Ff(m),bt=[m,y,_,L,Y,et,it,re,me,Ne];if(ht&&ud(bt,ht),m=bt[0],y=bt[1],_=bt[2],L=bt[3],Y=bt[4],Ne=bt[9]=bt[9]===t?Ee?0:m.length:Qn(bt[9]-Xe,0),!Ne&&y&(I|V)&&(y&=-25),!y||y==T)var Mt=Yg(m,y,_);else y==I||y==V?Mt=Wg(m,y,Ne):(y==F||y==(T|F))&&!Y.length?Mt=Qg(m,y,_,L):Mt=gi.apply(t,bt);var en=ht?Yu:Hf;return Gf(en(Mt,bt),m,y)}function Rf(m,y,_,L){return m===t||Tr(m,yt[_])&&!sn.call(L,_)?y:m}function $p(m,y,_,L,Y,re){return ni(m)&&ni(y)&&(re.set(y,m),Gu(m,y,t,$p,re),re.delete(y)),m}function Kg(m){return ua(m)?t:m}function Xg(m,y,_,L,Y,re){var me=_&S,Ne=m.length,Ee=y.length;if(Ne!=Ee&&!(me&&Ee>Ne))return!1;var Xe=re.get(m),et=re.get(y);if(Xe&&et)return Xe==y&&et==m;var it=-1,ht=!0,bt=_&k?new Es:t;for(re.set(m,y),re.set(y,m);++it<Ne;){var Mt=m[it],en=y[it];if(L)var Rt=me?L(en,Mt,it,y,m,re):L(Mt,en,it,m,y,re);if(Rt!==t){if(Rt)continue;ht=!1;break}if(bt){if(!Nu(y,function(un,yn){if(!js(bt,yn)&&(Mt===un||Y(Mt,un,_,L,re)))return bt.push(yn)})){ht=!1;break}}else if(!(Mt===en||Y(Mt,en,_,L,re))){ht=!1;break}}return re.delete(m),re.delete(y),ht}function Zg(m,y,_,L,Y,re,me){switch(_){case Be:if(m.byteLength!=y.byteLength||m.byteOffset!=y.byteOffset)return!1;m=m.buffer,y=y.buffer;case de:return!(m.byteLength!=y.byteLength||!re(new dc(m),new dc(y)));case ue:case ze:case Ae:return Tr(+m,+y);case ft:return m.name==y.name&&m.message==y.message;case nt:case St:return m==y+"";case he:var Ne=lc;case Ge:var Ee=L&S;if(Ne||(Ne=oc),m.size!=y.size&&!Ee)return!1;var Xe=me.get(m);if(Xe)return Xe==y;L|=k,me.set(m,y);var et=Xg(Ne(m),Ne(y),L,Y,re,me);return me.delete(m),et;case It:if(xo)return xo.call(m)==xo.call(y)}return!1}function Fi(m,y,_,L,Y,re){var me=_&S,Ne=Lf(m),Ee=Ne.length,Xe=Lf(y),et=Xe.length;if(Ee!=et&&!me)return!1;for(var it=Ee;it--;){var ht=Ne[it];if(!(me?ht in y:sn.call(y,ht)))return!1}var bt=re.get(m),Mt=re.get(y);if(bt&&Mt)return bt==y&&Mt==m;var en=!0;re.set(m,y),re.set(y,m);for(var Rt=me;++it<Ee;){ht=Ne[it];var un=m[ht],yn=y[ht];if(L)var Ma=me?L(yn,un,ht,y,m,re):L(un,yn,ht,m,y,re);if(!(Ma===t?un===yn||Y(un,yn,_,L,re):Ma)){en=!1;break}Rt||(Rt=ht=="constructor")}if(en&&!Rt){var Yr=m.constructor,Ra=y.constructor;Yr!=Ra&&"constructor"in m&&"constructor"in y&&!(typeof Yr=="function"&&Yr instanceof Yr&&typeof Ra=="function"&&Ra instanceof Ra)&&(en=!1)}return re.delete(m),re.delete(y),en}function Jn(m){return dd(Vp(m,t,kr),m+"")}function Lf(m){return Pg(m,Ri,ld)}function Of(m){return Pg(m,zi,zf)}var Ff=hc?function(m){return hc.get(m)}:xt;function sd(m){for(var y=m.name+"",_=ra[y],L=sn.call(ra,y)?_.length:0;L--;){var Y=_[L],re=Y.func;if(re==null||re==m)return Y.name}return y}function Do(m){var y=sn.call(K,"placeholder")?K:m;return y.placeholder}function Nt(){var m=K.iteratee||Tt;return m=m===Tt?Sp:m,arguments.length?m(arguments[0],arguments[1]):m}function Nc(m,y){var _=m.__data__;return Rs(y)?_[typeof y=="string"?"string":"hash"]:_.map}function $f(m){for(var y=Ri(m),_=y.length;_--;){var L=y[_],Y=m[L];y[_]=[L,Y,iy(Y)]}return y}function Sl(m,y){var _=_u(m,y);return ns(_)?_:t}function ey(m){var y=sn.call(m,ur),_=m[ur];try{m[ur]=t;var L=!0}catch{}var Y=pi.call(m);return L&&(y?m[ur]=_:delete m[ur]),Y}var ld=ml?function(m){return m==null?[]:(m=ae(m),Fr(ml(m),function(y){return po.call(m,y)}))}:Iv,zf=ml?function(m){for(var y=[];m;)$r(y,ld(m)),m=Du(m);return y}:Iv,$i=cn;(Ru&&$i(new Ru(new ArrayBuffer(1)))!=Be||Ai&&$i(new Ai)!=he||ei&&$i(ei.resolve())!=De||ln&&$i(new ln)!=Ge||ka&&$i(new ka)!=oe)&&($i=function(m){var y=cn(m),_=y==Me?m.constructor:t,L=_?Ls(_):"";if(L)switch(L){case vg:return Be;case wg:return he;case Lu:return De;case Ou:return Ge;case Ng:return oe}return y});function ty(m,y,_){for(var L=-1,Y=_.length;++L<Y;){var re=_[L],me=re.size;switch(re.type){case"drop":m+=me;break;case"dropRight":y-=me;break;case"take":y=Zn(y,m+me);break;case"takeRight":m=Qn(m,y-me);break}}return{start:m,end:y}}function zp(m){var y=m.match(Qr);return y?y[1].split(Qd):[]}function od(m,y,_){y=Ps(y,m);for(var L=-1,Y=y.length,re=!1;++L<Y;){var me=jn(y[L]);if(!(re=m!=null&&_(m,me)))break;m=m[me]}return re||++L!=Y?re:(Y=m==null?0:m.length,!!Y&&Mo(Y)&&Da(me,Y)&&(Ft(m)||zs(m)))}function Bp(m){var y=m.length,_=new m.constructor(y);return y&&typeof m[0]=="string"&&sn.call(m,"index")&&(_.index=m.index,_.input=m.input),_}function Up(m){return typeof m.constructor=="function"&&!Fn(m)?zr(Du(m)):{}}function qp(m,y,_){var L=m.constructor;switch(y){case de:return _o(m);case ue:case ze:return new L(+m);case Be:return Mp(m,_);case be:case Fe:case $e:case st:case rt:case Le:case Ve:case qe:case Ke:return Rp(m,_);case he:return new L;case Ae:case St:return new L(m);case nt:return Pf(m);case Ge:return new L;case It:return Vg(m)}}function ny(m,y){var _=y.length;if(!_)return m;var L=_-1;return y[L]=(_>1?"& ":"")+y[L],y=y.join(_>2?", ":" "),m.replace(Yo,`{
/* [wrapped with `+y+`] */
`)}function Ms(m){return Ft(m)||zs(m)||!!(br&&m&&m[br])}function Da(m,y){var _=typeof m;return y=y??W,!!y&&(_=="number"||_!="symbol"&&ys.test(m))&&m>-1&&m%1==0&&m<y}function hr(m,y,_){if(!ni(_))return!1;var L=typeof y;return(L=="number"?Ii(_)&&Da(y,_.length):L=="string"&&y in _)?Tr(_[y],m):!1}function Bf(m,y){if(Ft(m))return!1;var _=typeof m;return _=="number"||_=="symbol"||_=="boolean"||m==null||pr(m)?!0:Ji.test(m)||!Bn.test(m)||y!=null&&m in ae(y)}function Rs(m){var y=typeof m;return y=="string"||y=="number"||y=="symbol"||y=="boolean"?m!=="__proto__":m===null}function Uf(m){var y=sd(m),_=K[y];if(typeof _!="function"||!(y in Xt.prototype))return!1;if(m===_)return!0;var L=Ff(_);return!!L&&m===L[0]}function qf(m){return!!cc&&cc in m}var cd=pt?Pa:Mv;function Fn(m){var y=m&&m.constructor,_=typeof y=="function"&&y.prototype||yt;return m===_}function iy(m){return m===m&&!ni(m)}function ry(m,y){return function(_){return _==null?!1:_[m]===y&&(y!==t||m in ae(_))}}function ay(m){var y=wd(m,function(L){return _.size===d&&_.clear(),L}),_=y.cache;return y}function ud(m,y){var _=m[1],L=y[1],Y=_|L,re=Y<(T|E|B),me=L==B&&_==I||L==B&&_==U&&m[7].length<=y[8]||L==(B|U)&&y[7].length<=y[8]&&_==I;if(!(re||me))return m;L&T&&(m[2]=y[2],Y|=_&T?0:P);var Ne=y[3];if(Ne){var Ee=m[3];m[3]=Ee?Lp(Ee,Ne,y[4]):Ne,m[4]=Ee?lr(m[3],h):y[4]}return Ne=y[5],Ne&&(Ee=m[5],m[5]=Ee?Gg(Ee,Ne,y[6]):Ne,m[6]=Ee?lr(m[5],h):y[6]),Ne=y[7],Ne&&(m[7]=Ne),L&B&&(m[8]=m[8]==null?y[8]:Zn(m[8],y[8])),m[9]==null&&(m[9]=y[9]),m[0]=y[0],m[1]=Y,m}function jl(m){var y=[];if(m!=null)for(var _ in ae(m))y.push(_);return y}function sy(m){return pi.call(m)}function Vp(m,y,_){return y=Qn(y===t?m.length-1:y,0),function(){for(var L=arguments,Y=-1,re=Qn(L.length-y,0),me=Ue(re);++Y<re;)me[Y]=L[y+Y];Y=-1;for(var Ne=Ue(y+1);++Y<y;)Ne[Y]=L[Y];return Ne[y]=_(me),ci(m,this,Ne)}}function Sc(m,y){return y.length<2?m:sa(m,Br(y,0,-1))}function as(m,y){for(var _=m.length,L=Zn(y.length,_),Y=Di(m);L--;){var re=y[L];m[L]=Da(re,_)?Y[re]:t}return m}function Vf(m,y){if(!(y==="constructor"&&typeof m[y]=="function")&&y!="__proto__")return m[y]}var Hf=fd(Yu),jc=cp||function(m,y){return Un.setTimeout(m,y)},dd=fd(Wu);function Gf(m,y,_){var L=y+"";return dd(m,ny(L,ly(zp(L),_)))}function fd(m){var y=0,_=0;return function(){var L=ks(),Y=ee-(L-_);if(_=L,Y>0){if(++y>=H)return arguments[0]}else y=0;return m.apply(t,arguments)}}function hd(m,y){var _=-1,L=m.length,Y=L-1;for(y=y===t?L:y;++_<y;){var re=kf(_,Y),me=m[re];m[re]=m[_],m[_]=me}return m.length=y,m}var ss=ay(function(m){var y=[];return m.charCodeAt(0)===46&&y.push(""),m.replace(li,function(_,L,Y,re){y.push(Y?re.replace(Ks,"$1"):L||_)}),y});function jn(m){if(typeof m=="string"||pr(m))return m;var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function Ls(m){if(m!=null){try{return Ni.call(m)}catch{}try{return m+""}catch{}}return""}function ly(m,y){return Zi(ce,function(_){var L="_."+_[0];y&_[1]&&!Ja(m,L)&&m.push(L)}),m.sort()}function Pi(m){if(m instanceof Xt)return m.clone();var y=new wr(m.__wrapped__,m.__chain__);return y.__actions__=Di(m.__actions__),y.__index__=m.__index__,y.__values__=m.__values__,y}function Kb(m,y,_){(_?hr(m,y,_):y===t)?y=1:y=Qn(qt(y),0);var L=m==null?0:m.length;if(!L||y<1)return[];for(var Y=0,re=0,me=Ue(fc(L/y));Y<L;)me[re++]=Br(m,Y,Y+=y);return me}function oy(m){for(var y=-1,_=m==null?0:m.length,L=0,Y=[];++y<_;){var re=m[y];re&&(Y[L++]=re)}return Y}function cy(){var m=arguments.length;if(!m)return[];for(var y=Ue(m-1),_=arguments[0],L=m;L--;)y[L-1]=arguments[L];return $r(Ft(_)?Di(_):[_],on(y,1))}var ti=Gt(function(m,y){return xi(m)?bl(m,on(y,1,xi,!0)):[]}),_r=Gt(function(m,y){var _=ir(y);return xi(_)&&(_=t),xi(m)?bl(m,on(y,1,xi,!0),Nt(_,2)):[]}),Os=Gt(function(m,y){var _=ir(y);return xi(_)&&(_=t),xi(m)?bl(m,on(y,1,xi,!0),t,_):[]});function uy(m,y,_){var L=m==null?0:m.length;return L?(y=_||y===t?1:qt(y),Br(m,y<0?0:y,L)):[]}function dy(m,y,_){var L=m==null?0:m.length;return L?(y=_||y===t?1:qt(y),y=L-y,Br(m,0,y<0?0:y)):[]}function Xb(m,y){return m&&m.length?Ku(m,Nt(y,3),!0,!0):[]}function Hp(m,y){return m&&m.length?Ku(m,Nt(y,3),!0):[]}function qr(m,y,_,L){var Y=m==null?0:m.length;return Y?(_&&typeof _!="number"&&hr(m,y,_)&&(_=0,L=Y),Wt(m,y,_,L)):[]}function oa(m,y,_){var L=m==null?0:m.length;if(!L)return-1;var Y=_==null?0:qt(_);return Y<0&&(Y=Qn(L+Y,0)),rc(m,Nt(y,3),Y)}function Gp(m,y,_){var L=m==null?0:m.length;if(!L)return-1;var Y=L-1;return _!==t&&(Y=qt(_),Y=_<0?Qn(L+Y,0):Zn(Y,L-1)),rc(m,Nt(y,3),Y,!0)}function kr(m){var y=m==null?0:m.length;return y?on(m,1):[]}function fy(m){var y=m==null?0:m.length;return y?on(m,q):[]}function Cl(m,y){var _=m==null?0:m.length;return _?(y=y===t?1:qt(y),on(m,y)):[]}function Po(m){for(var y=-1,_=m==null?0:m.length,L={};++y<_;){var Y=m[y];L[Y[0]]=Y[1]}return L}function Fs(m){return m&&m.length?m[0]:t}function Yp(m,y,_){var L=m==null?0:m.length;if(!L)return-1;var Y=_==null?0:qt(_);return Y<0&&(Y=Qn(L+Y,0)),fl(m,y,Y)}function Wp(m){var y=m==null?0:m.length;return y?Br(m,0,-1):[]}var ls=Gt(function(m){var y=Dn(m,Df);return y.length&&y[0]===m[0]?bp(y):[]}),hy=Gt(function(m){var y=ir(m),_=Dn(m,Df);return y===ir(_)?y=t:_.pop(),_.length&&_[0]===m[0]?bp(_,Nt(y,2)):[]}),Cc=Gt(function(m){var y=ir(m),_=Dn(m,Df);return y=typeof y=="function"?y:t,y&&_.pop(),_.length&&_[0]===m[0]?bp(_,t,y):[]});function pd(m,y){return m==null?"":na.call(m,y)}function ir(m){var y=m==null?0:m.length;return y?m[y-1]:t}function _c(m,y,_){var L=m==null?0:m.length;if(!L)return-1;var Y=L;return _!==t&&(Y=qt(_),Y=Y<0?Qn(L+Y,0):Zn(Y,L-1)),y===y?or(m,y,Y):rc(m,hl,Y,!0)}function py(m,y){return m&&m.length?_p(m,qt(y)):t}var my=Gt(kc);function kc(m,y){return m&&m.length&&y&&y.length?_f(m,y):m}function gy(m,y,_){return m&&m.length&&y&&y.length?_f(m,y,Nt(_,2)):m}function Yf(m,y,_){return m&&m.length&&y&&y.length?_f(m,y,t,_):m}var yy=Jn(function(m,y){var _=m==null?0:m.length,L=Uu(m,y);return Ep(m,Dn(y,function(Y){return Da(Y,_)?+Y:Y}).sort(ed)),L});function Zb(m,y){var _=[];if(!(m&&m.length))return _;var L=-1,Y=[],re=m.length;for(y=Nt(y,3);++L<re;){var me=m[L];y(me,L,m)&&(_.push(me),Y.push(L))}return Ep(m,Y),_}function Qp(m){return m==null?m:dp.call(m)}function _n(m,y,_){var L=m==null?0:m.length;return L?(_&&typeof _!="number"&&hr(m,y,_)?(y=0,_=L):(y=y==null?0:qt(y),_=_===t?L:qt(_)),Br(m,y,_)):[]}function qn(m,y){return Qu(m,y)}function tn(m,y,_){return Tf(m,y,Nt(_,2))}function pn(m,y){var _=m==null?0:m.length;if(_){var L=Qu(m,y);if(L<_&&Tr(m[L],y))return L}return-1}function kn(m,y){return Qu(m,y,!0)}function Vr(m,y,_){return Tf(m,y,Nt(_,2),!0)}function _l(m,y){var _=m==null?0:m.length;if(_){var L=Qu(m,y,!0)-1;if(Tr(m[L],y))return L}return-1}function Ec(m){return m&&m.length?Ap(m):[]}function Jp(m,y){return m&&m.length?Ap(m,Nt(y,2)):[]}function $s(m){var y=m==null?0:m.length;return y?Br(m,1,y):[]}function yi(m,y,_){return m&&m.length?(y=_||y===t?1:qt(y),Br(m,0,y<0?0:y)):[]}function kl(m,y,_){var L=m==null?0:m.length;return L?(y=_||y===t?1:qt(y),y=L-y,Br(m,y<0?0:y,L)):[]}function Io(m,y){return m&&m.length?Ku(m,Nt(y,3),!1,!0):[]}function Kp(m,y){return m&&m.length?Ku(m,Nt(y,3)):[]}var ca=Gt(function(m){return Ds(on(m,1,xi,!0))}),Tc=Gt(function(m){var y=ir(m);return xi(y)&&(y=t),Ds(on(m,1,xi,!0),Nt(y,2))}),md=Gt(function(m){var y=ir(m);return y=typeof y=="function"?y:t,Ds(on(m,1,xi,!0),t,y)});function Er(m){return m&&m.length?Ds(m):[]}function Xp(m,y){return m&&m.length?Ds(m,Nt(y,2)):[]}function Zp(m,y){return y=typeof y=="function"?y:t,m&&m.length?Ds(m,t,y):[]}function Ac(m){if(!(m&&m.length))return[];var y=0;return m=Fr(m,function(_){if(xi(_))return y=Qn(_.length,y),!0}),Yi(y,function(_){return Dn(m,ac(_))})}function gd(m,y){if(!(m&&m.length))return[];var _=Ac(m);return y==null?_:Dn(_,function(L){return ci(y,t,L)})}var El=Gt(function(m,y){return xi(m)?bl(m,y):[]}),Wi=Gt(function(m){return Xu(Fr(m,xi))}),Tl=Gt(function(m){var y=ir(m);return xi(y)&&(y=t),Xu(Fr(m,xi),Nt(y,2))}),Dc=Gt(function(m){var y=ir(m);return y=typeof y=="function"?y:t,Xu(Fr(m,xi),t,y)}),Pc=Gt(Ac);function em(m,y){return Pp(m||[],y||[],wo)}function tm(m,y){return Pp(m||[],y||[],vc)}var xy=Gt(function(m){var y=m.length,_=y>1?m[y-1]:t;return _=typeof _=="function"?(m.pop(),_):t,gd(m,_)});function Ic(m){var y=K(m);return y.__chain__=!0,y}function nm(m,y){return y(m),m}function rr(m,y){return y(m)}var by=Jn(function(m){var y=m.length,_=y?m[0]:0,L=this.__wrapped__,Y=function(re){return Uu(re,m)};return y>1||this.__actions__.length||!(L instanceof Xt)||!Da(_)?this.thru(Y):(L=L.slice(_,+_+(y?1:0)),L.__actions__.push({func:rr,args:[Y],thisArg:t}),new wr(L,this.__chain__).thru(function(re){return y&&!re.length&&re.push(t),re}))});function Hr(){return Ic(this)}function vy(){return new wr(this.value(),this.__chain__)}function wy(){this.__values__===t&&(this.__values__=Gr(this.value()));var m=this.__index__>=this.__values__.length,y=m?t:this.__values__[this.__index__++];return{done:m,value:y}}function ev(){return this}function Al(m){for(var y,_=this;_ instanceof aa;){var L=Pi(_);L.__index__=0,L.__values__=t,y?Y.__wrapped__=L:y=L;var Y=L;_=_.__wrapped__}return Y.__wrapped__=m,y}function Wf(){var m=this.__wrapped__;if(m instanceof Xt){var y=m;return this.__actions__.length&&(y=new Xt(this)),y=y.reverse(),y.__actions__.push({func:rr,args:[Qp],thisArg:t}),new wr(y,this.__chain__)}return this.thru(Qp)}function im(){return Bg(this.__wrapped__,this.__actions__)}var Mc=ko(function(m,y,_){sn.call(m,_)?++m[_]:Ea(m,_,1)});function Ny(m,y,_){var L=Ft(m)?ef:yp;return _&&hr(m,y,_)&&(y=t),L(m,Nt(y,3))}function Sy(m,y){var _=Ft(m)?Fr:Cn;return _(m,Nt(y,3))}var jy=Is(oa),rm=Is(Gp);function am(m,y){return on(yd(m,y),1)}function tv(m,y){return on(yd(m,y),q)}function nv(m,y,_){return _=_===t?1:qt(_),on(yd(m,y),_)}function Cy(m,y){var _=Ft(m)?Zi:As;return _(m,Nt(y,3))}function sm(m,y){var _=Ft(m)?ul:xf;return _(m,Nt(y,3))}var _y=ko(function(m,y,_){sn.call(m,_)?m[_].push(y):Ea(m,_,[y])});function Rc(m,y,_,L){m=Ii(m)?m:Uc(m),_=_&&!L?qt(_):0;var Y=m.length;return _<0&&(_=Qn(Y+_,0)),sh(m)?_<=Y&&m.indexOf(y,_)>-1:!!Y&&fl(m,y,_)>-1}var Qf=Gt(function(m,y,_){var L=-1,Y=typeof y=="function",re=Ii(m)?Ue(m.length):[];return As(m,function(me){re[++L]=Y?ci(y,me,_):jo(me,y,_)}),re}),ky=ko(function(m,y,_){Ea(m,_,y)});function yd(m,y){var _=Ft(m)?Dn:jp;return _(m,Nt(y,3))}function Ey(m,y,_,L){return m==null?[]:(Ft(y)||(y=y==null?[]:[y]),_=L?t:_,Ft(_)||(_=_==null?[]:[_]),kp(m,y,_))}var Ty=ko(function(m,y,_){m[_?0:1].push(y)},function(){return[[],[]]});function Ay(m,y,_){var L=Ft(m)?wu:ju,Y=arguments.length<3;return L(m,Nt(y,4),_,Y,As)}function Dy(m,y,_){var L=Ft(m)?ic:ju,Y=arguments.length<3;return L(m,Nt(y,4),_,Y,xf)}function Jf(m,y){var _=Ft(m)?Fr:Cn;return _(m,Nd(Nt(y,3)))}function Py(m){var y=Ft(m)?mc:bc;return y(m)}function Iy(m,y,_){(_?hr(m,y,_):y===t)?y=1:y=qt(y);var L=Ft(m)?Tg:Ef;return L(m,y)}function $n(m){var y=Ft(m)?Ag:$g;return y(m)}function lm(m){if(m==null)return 0;if(Ii(m))return sh(m)?ea(m):m.length;var y=$i(m);return y==he||y==Ge?m.size:Nf(m).length}function iv(m,y,_){var L=Ft(m)?Nu:zg;return _&&hr(m,y,_)&&(y=t),L(m,Nt(y,3))}var My=Gt(function(m,y){if(m==null)return[];var _=y.length;return _>1&&hr(m,y[0],y[1])?y=[]:_>2&&hr(y[0],y[1],y[2])&&(y=[y[0]]),kp(m,on(y,1),[])}),Kf=go||function(){return Un.Date.now()};function rv(m,y){if(typeof y!="function")throw new _e(o);return m=qt(m),function(){if(--m<1)return y.apply(this,arguments)}}function Ry(m,y,_){return y=_?t:y,y=m&&y==null?m.length:y,rs(m,B,t,t,t,t,y)}function xd(m,y){var _;if(typeof y!="function")throw new _e(o);return m=qt(m),function(){return--m>0&&(_=y.apply(this,arguments)),m<=1&&(y=t),_}}var Dl=Gt(function(m,y,_){var L=T;if(_.length){var Y=lr(_,Do(Dl));L|=F}return rs(m,L,y,_,Y)}),Xf=Gt(function(m,y,_){var L=T|E;if(_.length){var Y=lr(_,Do(Xf));L|=F}return rs(y,L,m,_,Y)});function bd(m,y,_){y=_?t:y;var L=rs(m,I,t,t,t,t,t,y);return L.placeholder=bd.placeholder,L}function Zf(m,y,_){y=_?t:y;var L=rs(m,V,t,t,t,t,t,y);return L.placeholder=Zf.placeholder,L}function Pl(m,y,_){var L,Y,re,me,Ne,Ee,Xe=0,et=!1,it=!1,ht=!0;if(typeof m!="function")throw new _e(o);y=da(y)||0,ni(_)&&(et=!!_.leading,it="maxWait"in _,re=it?Qn(da(_.maxWait)||0,y):re,ht="trailing"in _?!!_.trailing:ht);function bt(Li){var Us=L,Ro=Y;return L=Y=t,Xe=Li,me=m.apply(Ro,Us),me}function Mt(Li){return Xe=Li,Ne=jc(un,y),et?bt(Li):me}function en(Li){var Us=Li-Ee,Ro=Li-Xe,Kw=y-Us;return it?Zn(Kw,re-Ro):Kw}function Rt(Li){var Us=Li-Ee,Ro=Li-Xe;return Ee===t||Us>=y||Us<0||it&&Ro>=re}function un(){var Li=Kf();if(Rt(Li))return yn(Li);Ne=jc(un,en(Li))}function yn(Li){return Ne=t,ht&&L?bt(Li):(L=Y=t,me)}function Ma(){Ne!==t&&qg(Ne),Xe=0,L=Ee=Y=Ne=t}function Yr(){return Ne===t?me:yn(Kf())}function Ra(){var Li=Kf(),Us=Rt(Li);if(L=arguments,Y=this,Ee=Li,Us){if(Ne===t)return Mt(Ee);if(it)return qg(Ne),Ne=jc(un,y),bt(Ee)}return Ne===t&&(Ne=jc(un,y)),me}return Ra.cancel=Ma,Ra.flush=Yr,Ra}var os=Gt(function(m,y){return No(m,1,y)}),vd=Gt(function(m,y,_){return No(m,da(y)||0,_)});function av(m){return rs(m,z)}function wd(m,y){if(typeof m!="function"||y!=null&&typeof y!="function")throw new _e(o);var _=function(){var L=arguments,Y=y?y.apply(this,L):L[0],re=_.cache;if(re.has(Y))return re.get(Y);var me=m.apply(this,L);return _.cache=re.set(Y,me)||re,me};return _.cache=new(wd.Cache||Nr),_}wd.Cache=Nr;function Nd(m){if(typeof m!="function")throw new _e(o);return function(){var y=arguments;switch(y.length){case 0:return!m.call(this);case 1:return!m.call(this,y[0]);case 2:return!m.call(this,y[0],y[1]);case 3:return!m.call(this,y[0],y[1],y[2])}return!m.apply(this,y)}}function Ly(m){return xd(2,m)}var Oy=Ug(function(m,y){y=y.length==1&&Ft(y[0])?Dn(y[0],er(Nt())):Dn(on(y,1),er(Nt()));var _=y.length;return Gt(function(L){for(var Y=-1,re=Zn(L.length,_);++Y<re;)L[Y]=y[Y].call(this,L[Y]);return ci(m,this,L)})}),om=Gt(function(m,y){var _=lr(y,Do(om));return rs(m,F,t,y,_)}),eh=Gt(function(m,y){var _=lr(y,Do(eh));return rs(m,O,t,y,_)}),Fy=Jn(function(m,y){return rs(m,U,t,t,t,y)});function $y(m,y){if(typeof m!="function")throw new _e(o);return y=y===t?y:qt(y),Gt(m,y)}function sv(m,y){if(typeof m!="function")throw new _e(o);return y=y==null?0:Qn(qt(y),0),Gt(function(_){var L=_[y],Y=wl(_,0,y);return L&&$r(Y,L),ci(m,this,Y)})}function cm(m,y,_){var L=!0,Y=!0;if(typeof m!="function")throw new _e(o);return ni(_)&&(L="leading"in _?!!_.leading:L,Y="trailing"in _?!!_.trailing:Y),Pl(m,y,{leading:L,maxWait:y,trailing:Y})}function um(m){return Ry(m,1)}function lv(m,y){return om(Zu(y),m)}function ov(){if(!arguments.length)return[];var m=arguments[0];return Ft(m)?m:[m]}function Sd(m){return tr(m,v)}function cv(m,y){return y=typeof y=="function"?y:t,tr(m,v,y)}function zy(m){return tr(m,g|v)}function nn(m,y){return y=typeof y=="function"?y:t,tr(m,g|v,y)}function dm(m,y){return y==null||gp(m,y,Ri(y))}function Tr(m,y){return m===y||m!==m&&y!==y}var fm=Ao(qu),By=Ao(function(m,y){return m>=y}),zs=bf(function(){return arguments}())?bf:function(m){return di(m)&&sn.call(m,"callee")&&!po.call(m,"callee")},Ft=Ue.isArray,th=Ca?er(Ca):Sr;function Ii(m){return m!=null&&Mo(m.length)&&!Pa(m)}function xi(m){return di(m)&&Ii(m)}function uv(m){return m===!0||m===!1||di(m)&&cn(m)==ue}var Il=ff||Mv,Uy=bu?er(bu):Ci;function qy(m){return di(m)&&m.nodeType===1&&!ua(m)}function nh(m){if(m==null)return!0;if(Ii(m)&&(Ft(m)||typeof m=="string"||typeof m.splice=="function"||Il(m)||Lc(m)||zs(m)))return!m.length;var y=$i(m);if(y==he||y==Ge)return!m.size;if(Fn(m))return!Nf(m).length;for(var _ in m)if(sn.call(m,_))return!1;return!0}function Pn(m,y){return Co(m,y)}function hm(m,y,_){_=typeof _=="function"?_:t;var L=_?_(m,y):t;return L===t?Co(m,y,t,_):!!L}function Mi(m){if(!di(m))return!1;var y=cn(m);return y==ft||y==tt||typeof m.message=="string"&&typeof m.name=="string"&&!ua(m)}function dv(m){return typeof m=="number"&&Mu(m)}function Pa(m){if(!ni(m))return!1;var y=cn(m);return y==Re||y==je||y==xe||y==Je}function ih(m){return typeof m=="number"&&m==qt(m)}function Mo(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=W}function ni(m){var y=typeof m;return m!=null&&(y=="object"||y=="function")}function di(m){return m!=null&&typeof m=="object"}var rh=tc?er(tc):vf;function pm(m,y){return m===y||Hu(m,y,$f(y))}function fv(m,y,_){return _=typeof _=="function"?_:t,Hu(m,y,$f(y),_)}function Vy(m){return Gy(m)&&m!=+m}function hv(m){if(cd(m))throw new Ct(l);return ns(m)}function Hy(m){return m===null}function pv(m){return m==null}function Gy(m){return typeof m=="number"||di(m)&&cn(m)==Ae}function ua(m){if(!di(m)||cn(m)!=Me)return!1;var y=Du(m);if(y===null)return!0;var _=sn.call(y,"constructor")&&y.constructor;return typeof _=="function"&&_ instanceof _&&Ni.call(_)==ta}var ah=so?er(so):wf;function mm(m){return ih(m)&&m>=-9007199254740991&&m<=W}var Yy=Ss?er(Ss):wp;function sh(m){return typeof m=="string"||!Ft(m)&&di(m)&&cn(m)==St}function pr(m){return typeof m=="symbol"||di(m)&&cn(m)==It}var Lc=vu?er(vu):Np;function Ia(m){return m===t}function gm(m){return di(m)&&$i(m)==oe}function Wy(m){return di(m)&&cn(m)==J}var Qy=Ao(Sf),jd=Ao(function(m,y){return m<=y});function Gr(m){if(!m)return[];if(Ii(m))return sh(m)?hi(m):Di(m);if(mo&&m[mo])return lf(m[mo]());var y=$i(m),_=y==he?lc:y==Ge?oc:Uc;return _(m)}function cs(m){if(!m)return m===0?m:0;if(m=da(m),m===q||m===-1/0){var y=m<0?-1:1;return y*ne}return m===m?m:0}function qt(m){var y=cs(m),_=y%1;return y===y?_?y-_:y:0}function us(m){return m?Ta(qt(m),0,ie):0}function da(m){if(typeof m=="number")return m;if(pr(m))return A;if(ni(m)){var y=typeof m.valueOf=="function"?m.valueOf():m;m=ni(y)?y+"":y}if(typeof m!="string")return m===0?m:+m;m=Zr(m);var _=ji.test(m);return _||Wo.test(m)?Zd(m.slice(2),_?2:8):Zs.test(m)?A:+m}function Jy(m){return Cr(m,zi(m))}function Oc(m){return m?Ta(qt(m),-9007199254740991,W):m===0?m:0}function Nn(m){return m==null?"":jr(m)}var mv=Eo(function(m,y){if(Fn(y)||Ii(y)){Cr(y,Ri(y),m);return}for(var _ in y)sn.call(y,_)&&wo(m,_,y[_])}),Ky=Eo(function(m,y){Cr(y,zi(y),m)}),lh=Eo(function(m,y,_,L){Cr(y,zi(y),m,L)}),gv=Eo(function(m,y,_,L){Cr(y,Ri(y),m,L)}),yv=Jn(Uu);function xv(m,y){var _=zr(m);return y==null?_:Ts(_,y)}var bv=Gt(function(m,y){m=ae(m);var _=-1,L=y.length,Y=L>2?y[2]:t;for(Y&&hr(y[0],y[1],Y)&&(L=1);++_<L;)for(var re=y[_],me=zi(re),Ne=-1,Ee=me.length;++Ne<Ee;){var Xe=me[Ne],et=m[Xe];(et===t||Tr(et,yt[Xe])&&!sn.call(m,Xe))&&(m[Xe]=re[Xe])}return m}),Xy=Gt(function(m){return m.push(t,$p),ci(Ed,t,m)});function Fc(m,y){return tf(m,Nt(y,3),nr)}function Cd(m,y){return tf(m,Nt(y,3),xc)}function Zy(m,y){return m==null?m:yc(m,Nt(y,3),zi)}function vv(m,y){return m==null?m:So(m,Nt(y,3),zi)}function $c(m,y){return m&&nr(m,Nt(y,3))}function _d(m,y){return m&&xc(m,Nt(y,3))}function ex(m){return m==null?[]:vl(m,Ri(m))}function oh(m){return m==null?[]:vl(m,zi(m))}function kd(m,y,_){var L=m==null?t:sa(m,y);return L===t?_:L}function ym(m,y){return m!=null&&od(m,y,xp)}function zc(m,y){return m!=null&&od(m,y,Ig)}var tx=nd(function(m,y,_){y!=null&&typeof y.toString!="function"&&(y=pi.call(y)),m[y]=_},Pe(Ie)),nx=nd(function(m,y,_){y!=null&&typeof y.toString!="function"&&(y=pi.call(y)),sn.call(m,y)?m[y].push(_):m[y]=[_]},Nt),wv=Gt(jo);function Ri(m){return Ii(m)?mp(m):Nf(m)}function zi(m){return Ii(m)?mp(m,!0):Rg(m)}function Nv(m,y){var _={};return y=Nt(y,3),nr(m,function(L,Y,re){Ea(_,y(L,Y,re),L)}),_}function Sv(m,y){var _={};return y=Nt(y,3),nr(m,function(L,Y,re){Ea(_,Y,y(L,Y,re))}),_}var jv=Eo(function(m,y,_){Gu(m,y,_)}),Ed=Eo(function(m,y,_,L){Gu(m,y,_,L)}),ch=Jn(function(m,y){var _={};if(m==null)return _;var L=!1;y=Dn(y,function(re){return re=Ps(re,m),L||(L=re.length>1),re}),Cr(m,Of(m),_),L&&(_=tr(_,g|b|v,Kg));for(var Y=y.length;Y--;)Ju(_,y[Y]);return _});function xm(m,y){return Bc(m,Nd(Nt(y)))}var Cv=Jn(function(m,y){return m==null?{}:Lg(m,y)});function Bc(m,y){if(m==null)return{};var _=Dn(Of(m),function(L){return[L]});return y=Nt(y),Cf(m,_,function(L,Y){return y(L,Y[0])})}function _v(m,y,_){y=Ps(y,m);var L=-1,Y=y.length;for(Y||(Y=1,m=t);++L<Y;){var re=m==null?t:m[jn(y[L])];re===t&&(L=Y,re=_),m=Pa(re)?re.call(m):re}return m}function ix(m,y,_){return m==null?m:vc(m,y,_)}function rx(m,y,_,L){return L=typeof L=="function"?L:t,m==null?m:vc(m,y,_,L)}var bm=ad(Ri),vm=ad(zi);function wm(m,y,_){var L=Ft(m),Y=L||Il(m)||Lc(m);if(y=Nt(y,4),_==null){var re=m&&m.constructor;Y?_=L?new re:[]:ni(m)?_=Pa(re)?zr(Du(m)):{}:_={}}return(Y?Zi:nr)(m,function(me,Ne,Ee){return y(_,me,Ne,Ee)}),_}function ax(m,y){return m==null?!0:Ju(m,y)}function uh(m,y,_){return m==null?m:Dp(m,y,Zu(_))}function kv(m,y,_,L){return L=typeof L=="function"?L:t,m==null?m:Dp(m,y,Zu(_),L)}function Uc(m){return m==null?[]:co(m,Ri(m))}function Nm(m){return m==null?[]:co(m,zi(m))}function Sm(m,y,_){return _===t&&(_=y,y=t),_!==t&&(_=da(_),_=_===_?_:0),y!==t&&(y=da(y),y=y===y?y:0),Ta(da(m),y,_)}function dh(m,y,_){return y=cs(y),_===t?(_=y,y=0):_=cs(_),m=da(m),Mg(m,y,_)}function jm(m,y,_){if(_&&typeof _!="boolean"&&hr(m,y,_)&&(y=_=t),_===t&&(typeof y=="boolean"?(_=y,y=t):typeof m=="boolean"&&(_=m,m=t)),m===t&&y===t?(m=0,y=1):(m=cs(m),y===t?(y=m,m=0):y=cs(y)),m>y){var L=m;m=y,y=L}if(_||m%1||y%1){var Y=up();return Zn(m+Y*(y-m+Ns("1e-"+((Y+"").length-1))),y)}return kf(m,y)}var sx=fr(function(m,y,_){return y=y.toLowerCase(),m+(_?fh(y):y)});function fh(m){return x(Nn(m).toLowerCase())}function Bs(m){return m=Nn(m),m&&m.replace(Va,uo).replace(Xr,"")}function Ml(m,y,_){m=Nn(m),y=jr(y);var L=m.length;_=_===t?L:Ta(qt(_),0,L);var Y=_;return _-=y.length,_>=0&&m.slice(_,Y)==y}function Rl(m){return m=Nn(m),m&&Wn.test(m)?m.replace(Ot,af):m}function Td(m){return m=Nn(m),m&&oi.test(m)?m.replace(Ln,"\\$&"):m}var Ad=fr(function(m,y,_){return m+(_?"-":"")+y.toLowerCase()}),Ll=fr(function(m,y,_){return m+(_?" ":"")+y.toLowerCase()}),Ev=Ur("toLowerCase");function lx(m,y,_){m=Nn(m),y=qt(y);var L=y?ea(m):0;if(!y||L>=y)return m;var Y=(y-L)/2;return rd(_s(Y),_)+m+rd(fc(Y),_)}function Dd(m,y,_){m=Nn(m),y=qt(y);var L=y?ea(m):0;return y&&L<y?m+rd(y-L,_):m}function Tv(m,y,_){m=Nn(m),y=qt(y);var L=y?ea(m):0;return y&&L<y?rd(y-L,_)+m:m}function ox(m,y,_){return _||y==null?y=0:y&&(y=+y),yo(Nn(m).replace(Si,""),y||0)}function hh(m,y,_){return(_?hr(m,y,_):y===t)?y=1:y=qt(y),Tp(Nn(m),y)}function cx(){var m=arguments,y=Nn(m[0]);return m.length<3?y:y.replace(m[1],m[2])}var Av=fr(function(m,y,_){return m+(_?"_":"")+y.toLowerCase()});function ph(m,y,_){return _&&typeof _!="number"&&hr(m,y,_)&&(y=_=t),_=_===t?ie:_>>>0,_?(m=Nn(m),m&&(typeof y=="string"||y!=null&&!ah(y))&&(y=jr(y),!y&&Za(m))?wl(hi(m),0,_):m.split(y,_)):[]}var mh=fr(function(m,y,_){return m+(_?" ":"")+x(y)});function ux(m,y,_){return m=Nn(m),_=_==null?0:Ta(qt(_),0,m.length),y=jr(y),m.slice(_,_+y.length)==y}function Pd(m,y,_){var L=K.templateSettings;_&&hr(m,y,_)&&(y=t),m=Nn(m),y=lh({},y,L,Rf);var Y=lh({},y.imports,L.imports,Rf),re=Ri(Y),me=co(Y,re),Ne,Ee,Xe=0,et=y.interpolate||ar,it="__p += '",ht=ge((y.escape||ar).source+"|"+et.source+"|"+(et===wn?Xs:ar).source+"|"+(y.evaluate||ar).source+"|$","g"),bt="//# sourceURL="+(sn.call(y,"sourceURL")?(y.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ec+"]")+`
`;m.replace(ht,function(Rt,un,yn,Ma,Yr,Ra){return yn||(yn=Ma),it+=m.slice(Xe,Ra).replace(el,Cu),un&&(Ne=!0,it+=`' +
__e(`+un+`) +
'`),Yr&&(Ee=!0,it+=`';
`+Yr+`;
__p += '`),yn&&(it+=`' +
((__t = (`+yn+`)) == null ? '' : __t) +
'`),Xe=Ra+Rt.length,Rt}),it+=`';
`;var Mt=sn.call(y,"variable")&&y.variable;if(!Mt)it=`with (obj) {
`+it+`
}
`;else if(du.test(Mt))throw new Ct(f);it=(Ee?it.replace(We,""):it).replace(zt,"$1").replace(_t,"$1;"),it="function("+(Mt||"obj")+`) {
`+(Mt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Ne?", __e = _.escape":"")+(Ee?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+it+`return __p
}`;var en=D(function(){return an(re,bt+"return "+it).apply(t,me)});if(en.source=it,Mi(en))throw en;return en}function Cm(m){return Nn(m).toLowerCase()}function gh(m){return Nn(m).toUpperCase()}function dx(m,y,_){if(m=Nn(m),m&&(_||y===t))return Zr(m);if(!m||!(y=jr(y)))return m;var L=hi(m),Y=hi(y),re=Cs(L,Y),me=Xa(L,Y)+1;return wl(L,re,me).join("")}function Dv(m,y,_){if(m=Nn(m),m&&(_||y===t))return m.slice(0,Eu(m)+1);if(!m||!(y=jr(y)))return m;var L=hi(m),Y=Xa(L,hi(y))+1;return wl(L,0,Y).join("")}function yh(m,y,_){if(m=Nn(m),m&&(_||y===t))return m.replace(Si,"");if(!m||!(y=jr(y)))return m;var L=hi(m),Y=Cs(L,hi(y));return wl(L,Y).join("")}function s(m,y){var _=$,L=R;if(ni(y)){var Y="separator"in y?y.separator:Y;_="length"in y?qt(y.length):_,L="omission"in y?jr(y.omission):L}m=Nn(m);var re=m.length;if(Za(m)){var me=hi(m);re=me.length}if(_>=re)return m;var Ne=_-ea(L);if(Ne<1)return L;var Ee=me?wl(me,0,Ne).join(""):m.slice(0,Ne);if(Y===t)return Ee+L;if(me&&(Ne+=Ee.length-Ne),ah(Y)){if(m.slice(Ne).search(Y)){var Xe,et=Ee;for(Y.global||(Y=ge(Y.source,Nn(qa.exec(Y))+"g")),Y.lastIndex=0;Xe=Y.exec(et);)var it=Xe.index;Ee=Ee.slice(0,it===t?Ne:it)}}else if(m.indexOf(jr(Y),Ne)!=Ne){var ht=Ee.lastIndexOf(Y);ht>-1&&(Ee=Ee.slice(0,ht))}return Ee+L}function c(m){return m=Nn(m),m&&Yn.test(m)?m.replace(rn,Tu):m}var p=fr(function(m,y,_){return m+(_?" ":"")+y.toUpperCase()}),x=Ur("toUpperCase");function N(m,y,_){return m=Nn(m),y=_?t:y,y===t?sf(m)?lp(m):ap(m):m.match(y)||[]}var D=Gt(function(m,y){try{return ci(m,t,y)}catch(_){return Mi(_)?_:new Ct(_)}}),G=Jn(function(m,y){return Zi(y,function(_){_=jn(_),Ea(m,_,Dl(m[_],m))}),m});function X(m){var y=m==null?0:m.length,_=Nt();return m=y?Dn(m,function(L){if(typeof L[1]!="function")throw new _e(o);return[_(L[0]),L[1]]}):[],Gt(function(L){for(var Y=-1;++Y<y;){var re=m[Y];if(ci(re[0],this,L))return ci(re[1],this,L)}})}function ye(m){return Dg(tr(m,g))}function Pe(m){return function(){return m}}function Ye(m,y){return m==null||m!==m?y:m}var Ze=is(),Oe=is(!0);function Ie(m){return m}function Tt(m){return Sp(typeof m=="function"?m:tr(m,g))}function kt(m){return Cp(tr(m,g))}function In(m,y){return jf(m,tr(y,g))}var ke=Gt(function(m,y){return function(_){return jo(_,m,y)}}),Se=Gt(function(m,y){return function(_){return jo(m,_,y)}});function Te(m,y,_){var L=Ri(y),Y=vl(y,L);_==null&&!(ni(y)&&(Y.length||!L.length))&&(_=y,y=m,m=this,Y=vl(y,Ri(y)));var re=!(ni(_)&&"chain"in _)||!!_.chain,me=Pa(m);return Zi(Y,function(Ne){var Ee=y[Ne];m[Ne]=Ee,me&&(m.prototype[Ne]=function(){var Xe=this.__chain__;if(re||Xe){var et=m(this.__wrapped__),it=et.__actions__=Di(this.__actions__);return it.push({func:Ee,args:arguments,thisArg:m}),et.__chain__=Xe,et}return Ee.apply(m,$r([this.value()],arguments))})}),m}function Qe(){return Un._===this&&(Un._=uc),this}function xt(){}function Zt(m){return m=qt(m),Gt(function(y){return _p(y,m)})}var vt=id(Dn),At=id(ef),Bi=id(Nu);function gn(m){return Bf(m)?ac(jn(m)):Og(m)}function Ol(m){return function(y){return m==null?t:sa(m,y)}}var Pv=Nl(),BT=Nl(!0);function Iv(){return[]}function Mv(){return!1}function UT(){return{}}function qT(){return""}function VT(){return!0}function HT(m,y){if(m=qt(m),m<1||m>W)return[];var _=ie,L=Zn(m,ie);y=Nt(y),m-=ie;for(var Y=Yi(L,y);++_<m;)y(_);return Y}function GT(m){return Ft(m)?Dn(m,jn):pr(m)?[m]:Di(ss(Nn(m)))}function YT(m){var y=++cr;return Nn(m)+y}var WT=wc(function(m,y){return m+y},0),QT=Mf("ceil"),JT=wc(function(m,y){return m/y},1),KT=Mf("floor");function XT(m){return m&&m.length?Aa(m,Ie,qu):t}function ZT(m,y){return m&&m.length?Aa(m,Nt(y,2),qu):t}function eA(m){return nf(m,Ie)}function tA(m,y){return nf(m,Nt(y,2))}function nA(m){return m&&m.length?Aa(m,Ie,Sf):t}function iA(m,y){return m&&m.length?Aa(m,Nt(y,2),Sf):t}var rA=wc(function(m,y){return m*y},1),aA=Mf("round"),sA=wc(function(m,y){return m-y},0);function lA(m){return m&&m.length?sc(m,Ie):0}function oA(m,y){return m&&m.length?sc(m,Nt(y,2)):0}return K.after=rv,K.ary=Ry,K.assign=mv,K.assignIn=Ky,K.assignInWith=lh,K.assignWith=gv,K.at=yv,K.before=xd,K.bind=Dl,K.bindAll=G,K.bindKey=Xf,K.castArray=ov,K.chain=Ic,K.chunk=Kb,K.compact=oy,K.concat=cy,K.cond=X,K.conforms=ye,K.constant=Pe,K.countBy=Mc,K.create=xv,K.curry=bd,K.curryRight=Zf,K.debounce=Pl,K.defaults=bv,K.defaultsDeep=Xy,K.defer=os,K.delay=vd,K.difference=ti,K.differenceBy=_r,K.differenceWith=Os,K.drop=uy,K.dropRight=dy,K.dropRightWhile=Xb,K.dropWhile=Hp,K.fill=qr,K.filter=Sy,K.flatMap=am,K.flatMapDeep=tv,K.flatMapDepth=nv,K.flatten=kr,K.flattenDeep=fy,K.flattenDepth=Cl,K.flip=av,K.flow=Ze,K.flowRight=Oe,K.fromPairs=Po,K.functions=ex,K.functionsIn=oh,K.groupBy=_y,K.initial=Wp,K.intersection=ls,K.intersectionBy=hy,K.intersectionWith=Cc,K.invert=tx,K.invertBy=nx,K.invokeMap=Qf,K.iteratee=Tt,K.keyBy=ky,K.keys=Ri,K.keysIn=zi,K.map=yd,K.mapKeys=Nv,K.mapValues=Sv,K.matches=kt,K.matchesProperty=In,K.memoize=wd,K.merge=jv,K.mergeWith=Ed,K.method=ke,K.methodOf=Se,K.mixin=Te,K.negate=Nd,K.nthArg=Zt,K.omit=ch,K.omitBy=xm,K.once=Ly,K.orderBy=Ey,K.over=vt,K.overArgs=Oy,K.overEvery=At,K.overSome=Bi,K.partial=om,K.partialRight=eh,K.partition=Ty,K.pick=Cv,K.pickBy=Bc,K.property=gn,K.propertyOf=Ol,K.pull=my,K.pullAll=kc,K.pullAllBy=gy,K.pullAllWith=Yf,K.pullAt=yy,K.range=Pv,K.rangeRight=BT,K.rearg=Fy,K.reject=Jf,K.remove=Zb,K.rest=$y,K.reverse=Qp,K.sampleSize=Iy,K.set=ix,K.setWith=rx,K.shuffle=$n,K.slice=_n,K.sortBy=My,K.sortedUniq=Ec,K.sortedUniqBy=Jp,K.split=ph,K.spread=sv,K.tail=$s,K.take=yi,K.takeRight=kl,K.takeRightWhile=Io,K.takeWhile=Kp,K.tap=nm,K.throttle=cm,K.thru=rr,K.toArray=Gr,K.toPairs=bm,K.toPairsIn=vm,K.toPath=GT,K.toPlainObject=Jy,K.transform=wm,K.unary=um,K.union=ca,K.unionBy=Tc,K.unionWith=md,K.uniq=Er,K.uniqBy=Xp,K.uniqWith=Zp,K.unset=ax,K.unzip=Ac,K.unzipWith=gd,K.update=uh,K.updateWith=kv,K.values=Uc,K.valuesIn=Nm,K.without=El,K.words=N,K.wrap=lv,K.xor=Wi,K.xorBy=Tl,K.xorWith=Dc,K.zip=Pc,K.zipObject=em,K.zipObjectDeep=tm,K.zipWith=xy,K.entries=bm,K.entriesIn=vm,K.extend=Ky,K.extendWith=lh,Te(K,K),K.add=WT,K.attempt=D,K.camelCase=sx,K.capitalize=fh,K.ceil=QT,K.clamp=Sm,K.clone=Sd,K.cloneDeep=zy,K.cloneDeepWith=nn,K.cloneWith=cv,K.conformsTo=dm,K.deburr=Bs,K.defaultTo=Ye,K.divide=JT,K.endsWith=Ml,K.eq=Tr,K.escape=Rl,K.escapeRegExp=Td,K.every=Ny,K.find=jy,K.findIndex=oa,K.findKey=Fc,K.findLast=rm,K.findLastIndex=Gp,K.findLastKey=Cd,K.floor=KT,K.forEach=Cy,K.forEachRight=sm,K.forIn=Zy,K.forInRight=vv,K.forOwn=$c,K.forOwnRight=_d,K.get=kd,K.gt=fm,K.gte=By,K.has=ym,K.hasIn=zc,K.head=Fs,K.identity=Ie,K.includes=Rc,K.indexOf=Yp,K.inRange=dh,K.invoke=wv,K.isArguments=zs,K.isArray=Ft,K.isArrayBuffer=th,K.isArrayLike=Ii,K.isArrayLikeObject=xi,K.isBoolean=uv,K.isBuffer=Il,K.isDate=Uy,K.isElement=qy,K.isEmpty=nh,K.isEqual=Pn,K.isEqualWith=hm,K.isError=Mi,K.isFinite=dv,K.isFunction=Pa,K.isInteger=ih,K.isLength=Mo,K.isMap=rh,K.isMatch=pm,K.isMatchWith=fv,K.isNaN=Vy,K.isNative=hv,K.isNil=pv,K.isNull=Hy,K.isNumber=Gy,K.isObject=ni,K.isObjectLike=di,K.isPlainObject=ua,K.isRegExp=ah,K.isSafeInteger=mm,K.isSet=Yy,K.isString=sh,K.isSymbol=pr,K.isTypedArray=Lc,K.isUndefined=Ia,K.isWeakMap=gm,K.isWeakSet=Wy,K.join=pd,K.kebabCase=Ad,K.last=ir,K.lastIndexOf=_c,K.lowerCase=Ll,K.lowerFirst=Ev,K.lt=Qy,K.lte=jd,K.max=XT,K.maxBy=ZT,K.mean=eA,K.meanBy=tA,K.min=nA,K.minBy=iA,K.stubArray=Iv,K.stubFalse=Mv,K.stubObject=UT,K.stubString=qT,K.stubTrue=VT,K.multiply=rA,K.nth=py,K.noConflict=Qe,K.noop=xt,K.now=Kf,K.pad=lx,K.padEnd=Dd,K.padStart=Tv,K.parseInt=ox,K.random=jm,K.reduce=Ay,K.reduceRight=Dy,K.repeat=hh,K.replace=cx,K.result=_v,K.round=aA,K.runInContext=Ce,K.sample=Py,K.size=lm,K.snakeCase=Av,K.some=iv,K.sortedIndex=qn,K.sortedIndexBy=tn,K.sortedIndexOf=pn,K.sortedLastIndex=kn,K.sortedLastIndexBy=Vr,K.sortedLastIndexOf=_l,K.startCase=mh,K.startsWith=ux,K.subtract=sA,K.sum=lA,K.sumBy=oA,K.template=Pd,K.times=HT,K.toFinite=cs,K.toInteger=qt,K.toLength=us,K.toLower=Cm,K.toNumber=da,K.toSafeInteger=Oc,K.toString=Nn,K.toUpper=gh,K.trim=dx,K.trimEnd=Dv,K.trimStart=yh,K.truncate=s,K.unescape=c,K.uniqueId=YT,K.upperCase=p,K.upperFirst=x,K.each=Cy,K.eachRight=sm,K.first=Fs,Te(K,function(){var m={};return nr(K,function(y,_){sn.call(K.prototype,_)||(m[_]=y)}),m}(),{chain:!1}),K.VERSION=r,Zi(["bind","bindKey","curry","curryRight","partial","partialRight"],function(m){K[m].placeholder=K}),Zi(["drop","take"],function(m,y){Xt.prototype[m]=function(_){_=_===t?1:Qn(qt(_),0);var L=this.__filtered__&&!y?new Xt(this):this.clone();return L.__filtered__?L.__takeCount__=Zn(_,L.__takeCount__):L.__views__.push({size:Zn(_,ie),type:m+(L.__dir__<0?"Right":"")}),L},Xt.prototype[m+"Right"]=function(_){return this.reverse()[m](_).reverse()}}),Zi(["filter","map","takeWhile"],function(m,y){var _=y+1,L=_==Z||_==Q;Xt.prototype[m]=function(Y){var re=this.clone();return re.__iteratees__.push({iteratee:Nt(Y,3),type:_}),re.__filtered__=re.__filtered__||L,re}}),Zi(["head","last"],function(m,y){var _="take"+(y?"Right":"");Xt.prototype[m]=function(){return this[_](1).value()[0]}}),Zi(["initial","tail"],function(m,y){var _="drop"+(y?"":"Right");Xt.prototype[m]=function(){return this.__filtered__?new Xt(this):this[_](1)}}),Xt.prototype.compact=function(){return this.filter(Ie)},Xt.prototype.find=function(m){return this.filter(m).head()},Xt.prototype.findLast=function(m){return this.reverse().find(m)},Xt.prototype.invokeMap=Gt(function(m,y){return typeof m=="function"?new Xt(this):this.map(function(_){return jo(_,m,y)})}),Xt.prototype.reject=function(m){return this.filter(Nd(Nt(m)))},Xt.prototype.slice=function(m,y){m=qt(m);var _=this;return _.__filtered__&&(m>0||y<0)?new Xt(_):(m<0?_=_.takeRight(-m):m&&(_=_.drop(m)),y!==t&&(y=qt(y),_=y<0?_.dropRight(-y):_.take(y-m)),_)},Xt.prototype.takeRightWhile=function(m){return this.reverse().takeWhile(m).reverse()},Xt.prototype.toArray=function(){return this.take(ie)},nr(Xt.prototype,function(m,y){var _=/^(?:filter|find|map|reject)|While$/.test(y),L=/^(?:head|last)$/.test(y),Y=K[L?"take"+(y=="last"?"Right":""):y],re=L||/^find/.test(y);Y&&(K.prototype[y]=function(){var me=this.__wrapped__,Ne=L?[1]:arguments,Ee=me instanceof Xt,Xe=Ne[0],et=Ee||Ft(me),it=function(un){var yn=Y.apply(K,$r([un],Ne));return L&&ht?yn[0]:yn};et&&_&&typeof Xe=="function"&&Xe.length!=1&&(Ee=et=!1);var ht=this.__chain__,bt=!!this.__actions__.length,Mt=re&&!ht,en=Ee&&!bt;if(!re&&et){me=en?me:new Xt(this);var Rt=m.apply(me,Ne);return Rt.__actions__.push({func:rr,args:[it],thisArg:t}),new wr(Rt,ht)}return Mt&&en?m.apply(this,Ne):(Rt=this.thru(it),Mt?L?Rt.value()[0]:Rt.value():Rt)})}),Zi(["pop","push","shift","sort","splice","unshift"],function(m){var y=at[m],_=/^(?:push|sort|unshift)$/.test(m)?"tap":"thru",L=/^(?:pop|shift)$/.test(m);K.prototype[m]=function(){var Y=arguments;if(L&&!this.__chain__){var re=this.value();return y.apply(Ft(re)?re:[],Y)}return this[_](function(me){return y.apply(Ft(me)?me:[],Y)})}}),nr(Xt.prototype,function(m,y){var _=K[y];if(_){var L=_.name+"";sn.call(ra,L)||(ra[L]=[]),ra[L].push({name:y,func:_})}}),ra[gi(t,E).name]=[{name:"wrapper",func:t}],Xt.prototype.clone=Fu,Xt.prototype.reverse=hf,Xt.prototype.value=bo,K.prototype.at=by,K.prototype.chain=Hr,K.prototype.commit=vy,K.prototype.next=wy,K.prototype.plant=Al,K.prototype.reverse=Wf,K.prototype.toJSON=K.prototype.valueOf=K.prototype.value=im,K.prototype.first=K.prototype.head,mo&&(K.prototype[mo]=ev),K},es=pl();xr?((xr.exports=es)._=es,Qa._=es):Un._=es}).call(HB)}(Hm,Hm.exports)),Hm.exports}var ik=GB();class YB{constructor(n){Vn(this,"sampleRate",24e3);Vn(this,"bufferSize",7680);Vn(this,"audioQueue",[]);Vn(this,"isPlaying",!1);Vn(this,"isStreamComplete",!1);Vn(this,"checkInterval",null);Vn(this,"scheduledTime",0);Vn(this,"initialBufferTime",.1);Vn(this,"gainNode");Vn(this,"source");Vn(this,"endOfQueueAudioSource",null);Vn(this,"onComplete",()=>{});this.context=n,this.gainNode=this.context.createGain(),this.source=this.context.createBufferSource(),this.gainNode.connect(this.context.destination),this.addPCM16=this.addPCM16.bind(this)}async addWorklet(n,t,r){let a=Cx.get(this.context);if(a&&a[n])return a[n].handlers.push(r),Promise.resolve(this);a||(Cx.set(this.context,{}),a=Cx.get(this.context)),a[n]={handlers:[r]};const l=d1(n,t);await this.context.audioWorklet.addModule(l);const o=new AudioWorkletNode(this.context,n);return a[n].node=o,this}_processPCM16Chunk(n){const t=new Float32Array(n.length/2),r=new DataView(n.buffer);for(let a=0;a<n.length/2;a++)try{const l=r.getInt16(a*2,!0);t[a]=l/32768}catch(l){console.error(l)}return t}addPCM16(n){this.isStreamComplete=!1;let t=this._processPCM16Chunk(n);for(;t.length>=this.bufferSize;){const r=t.slice(0,this.bufferSize);this.audioQueue.push(r),t=t.slice(this.bufferSize)}t.length>0&&this.audioQueue.push(t),this.isPlaying||(this.isPlaying=!0,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.scheduleNextBuffer())}createAudioBuffer(n){const t=this.context.createBuffer(1,n.length,this.sampleRate);return t.getChannelData(0).set(n),t}scheduleNextBuffer(){for(;this.audioQueue.length>0&&this.scheduledTime<this.context.currentTime+.2;){const t=this.audioQueue.shift(),r=this.createAudioBuffer(t),a=this.context.createBufferSource();this.audioQueue.length===0&&(this.endOfQueueAudioSource&&(this.endOfQueueAudioSource.onended=null),this.endOfQueueAudioSource=a,a.onended=()=>{!this.audioQueue.length&&this.endOfQueueAudioSource===a&&(this.endOfQueueAudioSource=null,this.onComplete())}),a.buffer=r,a.connect(this.gainNode);const l=Cx.get(this.context);l&&Object.entries(l).forEach(([,f])=>{const{node:u,handlers:d}=f;u&&(a.connect(u),u.port.onmessage=function(h){d.forEach(g=>{g.call(u.port,h)})},u.connect(this.context.destination))});const o=Math.max(this.scheduledTime,this.context.currentTime);a.start(o),this.scheduledTime=o+r.duration}if(this.audioQueue.length===0)this.isStreamComplete?(this.isPlaying=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)):this.checkInterval||(this.checkInterval=window.setInterval(()=>{this.audioQueue.length>0&&this.scheduleNextBuffer()},100));else{const t=(this.scheduledTime-this.context.currentTime)*1e3;setTimeout(()=>this.scheduleNextBuffer(),Math.max(0,t-50))}}stop(){this.isPlaying=!1,this.isStreamComplete=!0,this.audioQueue=[],this.scheduledTime=this.context.currentTime,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.gainNode.gain.linearRampToValueAtTime(0,this.context.currentTime+.1),setTimeout(()=>{this.gainNode.disconnect(),this.gainNode=this.context.createGain(),this.gainNode.connect(this.context.destination)},200)}async resume(){this.context.state==="suspended"&&await this.context.resume(),this.isStreamComplete=!1,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.gainNode.gain.setValueAtTime(1,this.context.currentTime)}complete(){this.isStreamComplete=!0,this.onComplete()}}function WB(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const f=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(u=>u.addEventListener("ended",f)),()=>{e.getTracks().forEach(u=>u.removeEventListener("ended",f))}},[e]),{type:"screen",start:async()=>{const f=await navigator.mediaDevices.getDisplayMedia({video:!0});return n(f),r(!0),f},stop:()=>{e&&(e.getTracks().forEach(f=>f.stop()),n(null),r(!1))},isStreaming:t,stream:e}}function QB(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const f=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(u=>u.addEventListener("ended",f)),()=>{e.getTracks().forEach(u=>u.removeEventListener("ended",f))}},[e]),{type:"webcam",start:async()=>{const f=await navigator.mediaDevices.getUserMedia({video:!0});return n(f),r(!0),f},stop:()=>{e&&(e.getTracks().forEach(f=>f.stop()),n(null),r(!1))},isStreaming:t,stream:e}}class JB extends tk{constructor(t){super();Vn(this,"client");Vn(this,"_status","disconnected");Vn(this,"_session",null);Vn(this,"_model",null);Vn(this,"config",null);this.client=new X2(t),this.send=this.send.bind(this),this.onopen=this.onopen.bind(this),this.onerror=this.onerror.bind(this),this.onclose=this.onclose.bind(this),this.onmessage=this.onmessage.bind(this)}get status(){return this._status}get session(){return this._session}get model(){return this._model}getConfig(){return{...this.config}}log(t,r){const a={date:new Date,type:t,message:r};this.emit("log",a)}async connect(t,r){if(this._status==="connected"||this._status==="connecting")return!1;this._status="connecting",this.config=r,this._model=t;const a={onopen:this.onopen,onmessage:this.onmessage,onerror:this.onerror,onclose:this.onclose};try{this._session=await this.client.live.connect({model:t,config:r,callbacks:a})}catch(l){return console.error("Error connecting to GenAI Live:",l),this._status="disconnected",!1}return this._status="connected",!0}disconnect(){var t;return this.session?((t=this.session)==null||t.close(),this._session=null,this._status="disconnected",this.log("client.close","Disconnected"),!0):!1}onopen(){this.log("client.open","Connected"),this.emit("open")}onerror(t){this.log("server.error",t.message),this.emit("error",t)}onclose(t){this.log("server.close",`disconnected ${t.reason?`with reason: ${t.reason}`:""}`),this.emit("close",t)}async onmessage(t){var r;if(t.setupComplete){this.log("server.send","setupComplete"),this.emit("setupcomplete");return}if(t.toolCall){this.log("server.toolCall",t),this.emit("toolcall",t.toolCall);return}if(t.toolCallCancellation){this.log("server.toolCallCancellation",t),this.emit("toolcallcancellation",t.toolCallCancellation);return}if(t.serverContent){const{serverContent:a}=t;if("interrupted"in a){this.log("server.content","interrupted"),this.emit("interrupted");return}if("turnComplete"in a&&(this.log("server.content","turnComplete"),this.emit("turncomplete")),"modelTurn"in a){let l=((r=a.modelTurn)==null?void 0:r.parts)||[];const o=l.filter(h=>{var g;return h.inlineData&&((g=h.inlineData.mimeType)==null?void 0:g.startsWith("audio/pcm"))}),f=o.map(h=>{var g;return(g=h.inlineData)==null?void 0:g.data}),u=ik.difference(l,o);if(f.forEach(h=>{if(h){const g=FB(h);this.emit("audio",g),this.log("server.audio",`buffer (${g.byteLength})`)}}),!u.length)return;l=u;const d={modelTurn:{parts:l}};this.emit("content",d),this.log("server.content",t)}}else console.log("received unmatched message",t)}sendRealtimeInput(t){var o;let r=!1,a=!1;for(const f of t)if((o=this.session)==null||o.sendRealtimeInput({media:f}),f.mimeType.includes("audio")&&(r=!0),f.mimeType.includes("image")&&(a=!0),r&&a)break;const l=r&&a?"audio + video":r?"audio":a?"video":"unknown";this.log("client.realtimeInput",l)}sendToolResponse(t){var r;t.functionResponses&&t.functionResponses.length&&((r=this.session)==null||r.sendToolResponse({functionResponses:t.functionResponses}),this.log("client.toolResponse",t))}send(t,r=!0){var a;(a=this.session)==null||a.sendClientContent({turns:t,turnComplete:r}),this.log("client.send",{turns:Array.isArray(t)?t:[t],turnComplete:r})}}function KB(e){const n=w.useMemo(()=>new JB(e),[e]),t=w.useRef(null),[r,a]=w.useState("models/gemini-2.5-flash-live-preview"),[l,o]=w.useState({}),[f,u]=w.useState(!1),[d,h]=w.useState(0),[g,b]=w.useState(null);w.useEffect(()=>{t.current||Z2({id:"audio-out"}).then(k=>{t.current=new YB(k),t.current.addWorklet("vumeter-out",ek,T=>{h(T.data.volume)}).then(()=>{})})},[t]),w.useEffect(()=>{const k=()=>{u(!0)},T=()=>{u(!1)},E=F=>{console.error("error",F)},P=()=>{var F;return(F=t.current)==null?void 0:F.stop()},I=F=>{var O;return(O=t.current)==null?void 0:O.addPCM16(new Uint8Array(F))},V=F=>{if(console.log("Received content event:",F),F.modelTurn&&F.modelTurn.parts){const O=F.modelTurn.parts.filter(B=>"text"in B&&B.text);if(O.length>0){const B=O.map(U=>U.text).join(" ");b(B),console.log("AI Summary received:",B)}}};return n.on("error",E).on("open",k).on("close",T).on("interrupted",P).on("audio",I).on("content",V),()=>{n.off("error",E).off("open",k).off("close",T).off("interrupted",P).off("audio",I).off("content",V).disconnect()}},[n]);const v=w.useCallback(async()=>{if(!l)throw new Error("config has not been set");n.disconnect(),await n.connect(r,l)},[n,l,r]),S=w.useCallback(async()=>{n.disconnect(),u(!1)},[u,n]);return{client:n,config:l,setConfig:o,model:r,setModel:a,connected:f,connect:v,disconnect:S,volume:d,aiSummary:g}}const rk=w.createContext(void 0),gw=({options:e,children:n})=>{const t=KB(e);return i.jsx(rk.Provider,{value:t,children:n})},lu=()=>{const e=w.useContext(rk);if(!e)throw new Error("useLiveAPIContext must be used wihin a LiveAPIProvider");return e};function XB(){const{config:e,setConfig:n}=lu(),[t,r]=w.useState({value:"audio",label:"audio"}),a=w.useCallback(l=>{n({...e,responseModalities:[l==="audio"?nu.AUDIO:nu.TEXT]})},[e,n]);return i.jsxs("div",{className:"select-group",children:[i.jsx("label",{htmlFor:"response-modality-selector",children:"Response modality"}),i.jsx(R2,{id:"response-modality-selector",className:"react-select",classNamePrefix:"react-select",styles:{},defaultValue:t,options:[{value:"audio",label:"audio"},{value:"text",label:"text"}],onChange:l=>{r(l),l&&(l.value==="audio"||l.value==="text")&&a(l.value)}})]})}const mj=[{value:"Puck",label:"Puck"},{value:"Charon",label:"Charon"},{value:"Kore",label:"Kore"},{value:"Fenrir",label:"Fenrir"},{value:"Aoede",label:"Aoede"}];function ZB(){const{config:e,setConfig:n}=lu();w.useEffect(()=>{var f,u,d;const l=((d=(u=(f=e.speechConfig)==null?void 0:f.voiceConfig)==null?void 0:u.prebuiltVoiceConfig)==null?void 0:d.voiceName)||"Atari02";r({value:l,label:l})},[e]);const[t,r]=w.useState(mj[5]),a=w.useCallback(l=>{n({...e,speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:l}}}})},[e,n]);return i.jsxs("div",{className:"select-group",children:[i.jsx("label",{htmlFor:"voice-selector",children:"Voice"}),i.jsx(R2,{id:"voice-selector",className:"react-select",classNamePrefix:"react-select",styles:{},value:t,defaultValue:t,options:mj,onChange:l=>{r(l),l&&a(l.value)}})]})}function eU(){const[e,n]=w.useState(!1),{config:t,setConfig:r,connected:a}=lu(),l=w.useMemo(()=>Array.isArray(t.tools)?t.tools.filter(d=>Array.isArray(d.functionDeclarations)).map(d=>d.functionDeclarations).filter(d=>!!d).flat():[],[t]),o=w.useMemo(()=>{var d;return t.systemInstruction?typeof t.systemInstruction=="string"?t.systemInstruction:Array.isArray(t.systemInstruction)?t.systemInstruction.map(h=>typeof h=="string"?h:h.text).join(`
`):typeof t.systemInstruction=="object"&&"parts"in t.systemInstruction&&((d=t.systemInstruction.parts)==null?void 0:d.map(h=>h.text).join(`
`))||"":""},[t]),f=w.useCallback(d=>{const h={...t,systemInstruction:d.target.value};r(h)},[t,r]),u=w.useCallback((d,h)=>{var b;const g={...t,tools:((b=t.tools)==null?void 0:b.map(v=>{const S=v;return Array.isArray(S.functionDeclarations)?{...v,functionDeclarations:S.functionDeclarations.map(k=>k.name===d?{...k,description:h}:k)}:v}))||[]};r(g)},[t,r]);return i.jsxs("div",{className:"settings-dialog",children:[i.jsx("button",{className:"action-button material-symbols-outlined",onClick:()=>n(!e),children:"settings"}),i.jsx("dialog",{className:"dialog",style:{display:e?"block":"none"},children:i.jsxs("div",{className:`dialog-container ${a?"disabled":""}`,children:[a&&i.jsx("div",{className:"connected-indicator",children:i.jsx("p",{children:"These settings can only be applied before connecting and will override other settings."})}),i.jsxs("div",{className:"mode-selectors",children:[i.jsx(XB,{}),i.jsx(ZB,{})]}),i.jsx("h3",{children:"System Instructions"}),i.jsx("textarea",{className:"system",onChange:f,value:o}),i.jsx("h4",{children:"Function declarations"}),i.jsx("div",{className:"function-declarations",children:i.jsx("div",{className:"fd-rows",children:l.map((d,h)=>{var g;return i.jsxs("div",{className:"fd-row",children:[i.jsx("span",{className:"fd-row-name",children:d.name}),i.jsx("span",{className:"fd-row-args",children:Object.keys(((g=d.parameters)==null?void 0:g.properties)||{}).map((b,v)=>i.jsx("span",{children:b},v))}),i.jsx("input",{className:"fd-row-description",type:"text",defaultValue:d.description,onBlur:b=>u(d.name,b.target.value)},`fd-${d.description}`)]},`function-${h}`)})})})]})})]})}const gj=w.memo(({isStreaming:e,onIcon:n,offIcon:t,start:r,stop:a})=>e?i.jsx("button",{className:"action-button",onClick:a,children:i.jsx("span",{className:"material-symbols-outlined",children:n})}):i.jsx("button",{className:"action-button",onClick:r,children:i.jsx("span",{className:"material-symbols-outlined",children:t})}));function tU({videoRef:e,children:n,onVideoStreamChange:t=()=>{},supportsVideo:r,enableEditingSettings:a}){const l=[QB(),WB()],[o,f]=w.useState(null),[u,d]=l,[h,g]=w.useState(0),[b]=w.useState(()=>new nk),[v,S]=w.useState(!1),k=w.useRef(null),T=w.useRef(null),{client:E,connected:P,connect:I,disconnect:V,volume:F}=lu();w.useEffect(()=>{!P&&T.current&&T.current.focus()},[P]),w.useEffect(()=>{document.documentElement.style.setProperty("--volume",`${Math.max(5,Math.min(h*200,8))}px`)},[h]),w.useEffect(()=>{const B=U=>{E.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:U}])};return P&&!v&&b?b.on("data",B).on("volume",g).start():b.stop(),()=>{b.off("data",B).off("volume",g)}},[P,E,v,b]),w.useEffect(()=>{e.current&&(e.current.srcObject=o);let B=-1;function U(){const z=e.current,$=k.current;if(!z||!$)return;const R=$.getContext("2d");if($.width=z.videoWidth*.25,$.height=z.videoHeight*.25,$.width+$.height>0){R.drawImage(z,0,0,$.width,$.height);const H=$.toDataURL("image/jpeg",1),ee=H.slice(H.indexOf(",")+1,1/0);E.sendRealtimeInput([{mimeType:"image/jpeg",data:ee}])}P&&(B=window.setTimeout(U,1e3/.5))}return P&&o!==null&&requestAnimationFrame(U),()=>{clearTimeout(B)}},[P,o,E,e]);const O=B=>async()=>{if(B){const U=await B.start();f(U),t(U)}else f(null),t(null);l.filter(U=>U!==B).forEach(U=>U.stop())};return i.jsxs("section",{className:"control-tray",children:[i.jsx("canvas",{style:{display:"none"},ref:k}),i.jsxs("nav",{className:Zc("actions-nav",{disabled:!P}),children:[i.jsx("button",{className:Zc("action-button mic-button",{recording:!v&&P}),onClick:()=>S(!v),children:v?i.jsx("span",{className:"material-symbols-outlined filled",children:"mic_off"}):i.jsx("span",{className:"material-symbols-outlined filled",children:"mic"})}),i.jsx("div",{className:"action-button no-action outlined",children:i.jsx(VB,{volume:F,active:P,hover:!1})}),r&&i.jsxs(i.Fragment,{children:[i.jsx(gj,{isStreaming:d.isStreaming,start:O(d),stop:O(),onIcon:"cancel_presentation",offIcon:"present_to_all"}),i.jsx(gj,{isStreaming:u.isStreaming,start:O(u),stop:O(),onIcon:"videocam_off",offIcon:"videocam"})]}),n]}),i.jsxs("div",{className:Zc("connection-container",{connected:P}),children:[i.jsx("div",{className:"connection-button-container",children:i.jsx("button",{ref:T,className:Zc("action-button connect-toggle",{connected:P}),onClick:P?V:I,children:i.jsx("span",{className:"material-symbols-outlined filled",children:P?"pause":"play_arrow"})})}),i.jsx("span",{className:"text-indicator",children:"Streaming"})]}),a?i.jsx(eU,{}):""]})}const yj={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Vh.OBJECT,properties:{summary:{type:Vh.STRING,description:"The summary of the patient's case."}},required:["summary"]}},nU=({patientData:e,tokenNumber:n})=>{const[t,r]=w.useState(""),{client:a,setConfig:l,setModel:o}=lu();return w.useEffect(()=>{o("models/gemini-2.5-flash-live-preview"),l({responseModalities:[nu.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:`Your job is to:

If patient details like name, age, sex, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details (e.g., phone number) are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's name, age, sex, and phone number.

When pronouncing a phone number, always state each digit individually (e.g., "six three" instead of "sixty-three" or "six billion three").

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in Telugu.dont write the telugu words in english`}]},tools:[{functionDeclarations:[yj]}]})},[l,o]),w.useEffect(()=>{const f=u=>{if(!u.functionCalls)return;const d=u.functionCalls.find(h=>h.name===yj.name);if(d){const h=d.args.summary;r(h)}u.functionCalls.length&&setTimeout(()=>{var h;return a.sendToolResponse({functionResponses:(h=u.functionCalls)==null?void 0:h.map(g=>({response:{output:{success:!0}},id:g.id,name:g.name}))})},200)};return a.on("toolcall",f),()=>{a.off("toolcall",f)}},[a]),w.useEffect(()=>{if(t){const f=encodeURIComponent(t);n?window.location.href=`https://hms.newtons.in/handle-complaint-url?token=${n}&caseDetails=${f}`:window.location.href=`https://hms.newtons.in/dashboard/search-patient?caseDetails=${f}`}},[t,n]),i.jsxs("div",{className:"hospital-reception",children:[i.jsx("h1",{children:"Newtons Ai"}),i.jsx("p",{children:"Newtons Ai"}),n&&i.jsxs("h2",{children:["Token Number: ",n]}),e&&i.jsxs("div",{children:[i.jsx("h2",{children:"Patient Details"}),i.jsx("pre",{children:JSON.stringify(e,null,2)})]}),t&&i.jsxs("div",{children:[i.jsx("h2",{children:"Case Summary (from Tool Call)"}),i.jsx("p",{children:t})]})]})};async function iU(){const e=eb();if(!e)throw new Error("Authentication token not found. Please log in.");try{const r=(await(await fe("/api/clinics/settings",{headers:{Authorization:`Bearer ${e}`}})).json()).gemini_api_key;if(r)return console.log("Using clinic-specific Live API key."),r}catch(n){console.warn("Failed to fetch clinic-specific Live API key, trying global fallback.",n)}try{const r=(await(await fe("/api/super-admin-settings/gemini-api-key",{headers:{Authorization:`Bearer ${e}`}})).json()).gemini_api_key;if(r)return console.log("Using global Live API key."),r}catch(n){console.warn("Failed to fetch global Live API key.",n)}throw new Error("Live API key not found. Please contact your administrator.")}function rU(){const e=w.useRef(null),[n,t]=w.useState(null),[r,a]=w.useState(null);return w.useEffect(()=>{(async()=>{try{const o=await iU();a({apiKey:o})}catch(o){console.error("Error setting Live API options:",o)}})()},[]),r?i.jsx("div",{className:"App",children:i.jsx(gw,{options:r,children:i.jsx(aU,{videoRef:e,setVideoStream:t,videoStream:n})})}):i.jsx("div",{children:"Loading Live API settings..."})}const aU=({videoRef:e,setVideoStream:n,videoStream:t})=>{const[r,a]=w.useState(null),[l,o]=w.useState(null),{connected:f,client:u,connect:d,config:h,model:g}=lu(),[b,v]=w.useState(""),S=w.useRef(null),[k,T]=w.useState(!1);w.useEffect(()=>{const P=window.matchMedia("(prefers-color-scheme: dark)"),I=V=>{document.documentElement.setAttribute("data-theme",V.matches?"dark":"light")};return I(P),P.addEventListener("change",I),()=>P.removeEventListener("change",I)},[]),w.useEffect(()=>{const P=new URLSearchParams(window.location.search),I={};for(const[V,F]of P.entries())V==="token_number"?o(F):I[V]=F;a(I)},[]),w.useEffect(()=>{Object.keys(h).length>0&&g&&d()},[d,h,g]),w.useEffect(()=>{if(f&&r&&!k){const P=JSON.stringify(r,null,2);u.send([{text:P}]),v(""),T(!0)}},[f,r,u,k]),w.useEffect(()=>{r&&v(JSON.stringify(r,null,2))},[r]);const E=()=>{u.send([{text:b}]),v(""),S.current&&(S.current.innerText="")};return i.jsx("div",{className:"streaming-console",children:i.jsxs("main",{children:[i.jsxs("div",{className:"main-app-area",children:[i.jsx(nU,{patientData:r,tokenNumber:l}),i.jsx("video",{className:Zc("stream",{hidden:!e.current||!t}),ref:e,autoPlay:!0,playsInline:!0})]}),i.jsx("div",{className:Zc("input-container",{disabled:!f}),children:i.jsxs("div",{className:"input-content",children:[i.jsx("textarea",{className:"input-area",ref:S,onKeyDown:P=>{P.key==="Enter"&&!P.shiftKey&&(P.preventDefault(),P.stopPropagation(),E())},onChange:P=>v(P.target.value),value:b}),i.jsx("span",{className:Zc("input-content-placeholder",{hidden:b.length}),children:"Typesomething..."}),i.jsx("button",{className:"send-button material-symbols-outlined filled",onClick:E,children:"send"})]})}),i.jsx(tU,{videoRef:e,supportsVideo:!0,onVideoStreamChange:n,enableEditingSettings:!0})]})})},xj="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",sU=({volume:e,active:n})=>{const t=Array.from({length:5},(r,a)=>i.jsx("div",{className:`audio-bar ${n?"active":""}`,style:{height:n?`${Math.min(24,20+e*40*(1+Math.sin(a)*.3))}px`:"8px",animationDelay:`${a*.1}s`}},a));return i.jsx("div",{className:"audio-pulse",children:t})},lU=w.forwardRef(({videoRef:e,supportsVideo:n,onVideoStreamChange:t,textInput:r,onSubmitTextInput:a},l)=>{var O;const{connected:o,connect:f,disconnect:u,client:d,volume:h}=lu(),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[E]=w.useState(()=>new nk),P=async()=>{o?await u():(await f(),r.trim()&&a())};w.useEffect(()=>{const B=U=>{d.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:U}])};return o&&!g?E.on("data",B).start():E.stop(),()=>{E.off("data",B),E.stop()}},[o,d,g,E]);const I=w.useCallback(async()=>{if(v)F==null||F.getTracks().forEach(B=>B.stop()),t(null),S(!1);else try{const B=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=B),t(B),S(!0)}catch(B){console.error("Error accessing webcam:",B),S(!1)}},[v,t,e]),V=w.useCallback(async()=>{if(k)F==null||F.getTracks().forEach(B=>B.stop()),t(null),T(!1);else try{const B=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=B),t(B),T(!0)}catch(B){console.error("Error accessing screen share:",B),T(!1)}},[k,t,e]),F=(O=e.current)==null?void 0:O.srcObject;return w.useEffect(()=>()=>{F&&F.getTracks().forEach(B=>B.stop())},[F]),w.useImperativeHandle(l,()=>({handleConnect:P})),i.jsx("div",{className:"live-api-control-tray",children:i.jsxs("div",{className:"live-api-control-tray-inner",children:[i.jsxs("div",{className:"live-api-control-group",children:[i.jsx("button",{onClick:()=>b(!g),disabled:!o,className:`live-api-control-button ${o&&!g?"mic-active":"mic-inactive"}`,"aria-label":g?"Unmute microphone":"Mute microphone",children:g?i.jsx(xI,{className:"w-5 h-5"}):i.jsx(P_,{className:"w-5 h-5"})}),i.jsx("div",{className:"live-api-audio-pulse-container",children:i.jsx(sU,{volume:h,active:o})}),n&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:V,disabled:!o,className:`live-api-control-button ${k?"video-active":"video-inactive"}`,"aria-label":k?"Stop screen share":"Start screen share",children:i.jsx(wI,{className:"w-5 h-5"})}),i.jsx("button",{onClick:I,disabled:!o,className:`live-api-control-button ${v?"video-active":"video-inactive"}`,"aria-label":v?"Turn off webcam":"Turn on webcam",children:i.jsx(mM,{className:"w-5 h-5"})})]})]}),i.jsxs("div",{className:"live-api-control-group",children:[i.jsxs("div",{className:"live-api-status-indicator",children:[i.jsx("div",{className:`live-api-status-dot ${o?"connected":"disconnected"}`}),i.jsx("span",{className:"live-api-status-text",children:o?"Streaming":"Disconnected"})]}),i.jsx("button",{onClick:P,className:`live-api-connect-button ${o?"connected":"disconnected"}`,children:o?i.jsxs(i.Fragment,{children:[i.jsx(AI,{className:"w-5 h-5"}),i.jsx("span",{children:"Pause"})]}):i.jsxs(i.Fragment,{children:[i.jsx(LI,{className:"w-5 h-5"}),i.jsx("span",{children:"Start"})]})})]})]})})}),oU=({patientData:e,tokenNumber:n,aiSummary:t,clinicName:r})=>i.jsxs("div",{className:"hospital-reception-container",children:[i.jsxs("div",{className:"hospital-reception-logo-section",children:[i.jsx("div",{className:"hospital-reception-logo",children:i.jsx("span",{children:r.charAt(0)})}),i.jsxs("h1",{className:"hospital-reception-title",children:[r," AI"]}),i.jsxs("p",{className:"hospital-reception-subtitle",children:["Intelligent ",r," Reception Assistant"]})]}),n&&i.jsxs("div",{className:"hospital-reception-token-card",children:[i.jsx("h2",{className:"hospital-reception-token-title",children:"Token Number"}),i.jsx("p",{className:"hospital-reception-token-number",children:n})]}),e?i.jsxs("div",{className:"hospital-reception-patient-info-card",children:[i.jsx("h3",{className:"hospital-reception-patient-info-title",children:"Patient Information"}),i.jsx("div",{className:"hospital-reception-patient-info-content",children:i.jsx("pre",{className:"hospital-reception-patient-info-pre",children:JSON.stringify(e,null,2)})})]}):i.jsxs("div",{className:"hospital-reception-patient-info-card",children:[i.jsx("h3",{className:"hospital-reception-patient-info-title",children:"New Case"}),i.jsx("p",{className:"hospital-reception-patient-info-pre",children:"No patient data provided. This is a new case."})]}),t&&i.jsxs("div",{className:"hospital-reception-summary-card",children:[i.jsx("h3",{className:"hospital-reception-summary-title",children:"Case Summary"}),i.jsx("p",{className:"hospital-reception-summary-text",children:t})]})]}),bj={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Vh.OBJECT,properties:{summary:{type:Vh.STRING,description:"The summary of the patient's case."}},required:["summary"]}},cU=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:a,aiLanguage:l})=>{const o=w.useRef(null),f=w.useRef(null),[u,d]=w.useState(null),[h,g]=w.useState("hi"),{client:b,connected:v,aiSummary:S,setConfig:k,setModel:T,disconnect:E}=lu(),[P,I]=w.useState(null),V=w.useMemo(()=>{let B=`Your job is to:

If patient details like name, age, sex, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's name, age, and sex(dont ask for sex ,detect automatically through voice recognition).

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in ${l||"English"}.dont write the ${l||"English"} words in english.donot use function calls in the middle of the conversation`;return n&&(B+=`

Patient Data: ${JSON.stringify(n,null,2)}`),{responseModalities:[nu.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:B}]},tools:[{functionDeclarations:[bj]}]}},[n,l]);w.useEffect(()=>{T("models/gemini-2.5-flash-native-audio-preview-09-2025"),k(V);const B=setTimeout(()=>{f.current&&!v&&f.current.handleConnect()},2e3);return()=>clearTimeout(B)},[k,T,V,v]),w.useEffect(()=>()=>{v&&E()},[v,E]),w.useEffect(()=>{r(S)},[S,r]),w.useEffect(()=>{const B=U=>{if(U.modelTurn&&U.modelTurn.parts){for(const z of U.modelTurn.parts)if(z.executableCode){const $=z.executableCode.code,R=/summary=["'](.*?)["']/.exec($);if(R&&R[1]){const H=R[1];I(H),r(H)}}}};return b.on("content",B),()=>{b.off("content",B)}},[b,r]),w.useEffect(()=>{const B=U=>{if(!U.functionCalls)return;const z=U.functionCalls.find($=>$.name===bj.name);if(z){const $=z.args.summary;r($)}U.functionCalls.length&&setTimeout(()=>{var $;return b.sendToolResponse({functionResponses:($=U.functionCalls)==null?void 0:$.map(R=>({response:{output:{success:!0}},id:R.id,name:R.name}))})},200)};return b.on("toolcall",B),()=>{b.off("toolcall",B)}},[b,r]);const F=()=>{h.trim()&&(b.send([{text:h}]),g(""))},O=B=>{B.key==="Enter"&&!B.shiftKey&&(B.preventDefault(),F())};return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsxs("div",{className:"live-api-modal-content",children:[i.jsxs("div",{className:"live-api-modal-header",children:[i.jsxs("div",{className:"live-api-modal-header-left",children:[i.jsx("div",{className:"live-api-modal-logo",children:i.jsx("span",{children:a.charAt(0)})}),i.jsxs("div",{children:[i.jsx("h1",{className:"live-api-modal-title",children:a}),i.jsxs("p",{className:"live-api-modal-subtitle",children:[a," Hospital Assistant"]})]})]}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("button",{onClick:e,className:"live-api-modal-close-button","aria-label":"Close modal",children:i.jsx(Kn,{className:"w-6 h-6"})})})]}),i.jsx("div",{className:"live-api-modal-main-content",children:i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsxs("div",{className:"live-api-reception-area",children:[i.jsx(oU,{patientData:n,tokenNumber:t,aiSummary:P??S,clinicName:a}),u&&i.jsx("video",{ref:o,autoPlay:!0,playsInline:!0,className:"live-api-video-stream"})]}),i.jsx("div",{className:"live-api-input-area",children:i.jsxs("div",{className:"live-api-input-container",children:[i.jsx("textarea",{value:h,onChange:B=>g(B.target.value),onKeyDown:O,placeholder:"Type your message here...",disabled:!v,rows:1,className:"live-api-textarea"}),i.jsx("button",{onClick:F,disabled:!v||!h.trim(),className:"live-api-send-button","aria-label":"Send message",children:i.jsx(qI,{className:"w-5 h-5"})})]})}),i.jsx(lU,{ref:f,videoRef:o,supportsVideo:!0,onVideoStreamChange:d,textInput:h,onSubmitTextInput:F})]})})]})})},ak=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r})=>{const[a,l]=w.useState(null),[o,f]=w.useState("Newtons Ai"),[u,d]=w.useState(""),[h,g]=w.useState(!0);if(w.useEffect(()=>{(async()=>{try{const k=await(await fe("/api/clinics/settings")).json();k.gemini_api_key?l(k.gemini_api_key):l(xj),k.name&&k.name!==""?f(k.name):f("Newtons Ai"),d(k.aiLanguage||"")}catch(S){console.error("Failed to fetch clinic settings, using default API key and unknown clinic name:",S),l(xj),f("Newtons Ai"),d("")}finally{g(!1)}})()},[]),h)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsx("div",{className:"live-api-modal-content",children:i.jsx("div",{children:"Loading API Key and Clinic Name..."})})});if(!a)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsx("div",{className:"live-api-modal-content",children:i.jsx("div",{children:"Error: API Key not available."})})});const b={apiKey:a};return i.jsx(gw,{options:b,children:i.jsx(cU,{onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:o,aiLanguage:u})})},uU=({onClose:e})=>{const n=wt(),t=()=>{e(),n("/start-clinic-subscription")};return i.jsx("div",{className:"go-pro-modal-overlay",children:i.jsxs("div",{className:"go-pro-modal-content",children:[i.jsx("button",{onClick:e,className:"go-pro-modal-close-button",children:i.jsx(Kn,{size:24})}),i.jsx("h2",{className:"go-pro-modal-title",children:"Voice AI Agent for Pro Members Only"}),i.jsx("p",{className:"go-pro-modal-message",children:"Unlock the full potential of our Voice AI Agent by upgrading to a Pro subscription. Enjoy advanced features and seamless patient interactions."}),i.jsx("button",{onClick:t,className:"go-pro-button",children:"Go Pro Now"})]})})},dU="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",fU={apiKey:dU},Dh=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,l]=w.useState([]),[o,f]=w.useState(!1),[u,d]=w.useState(null),[h,g]=w.useState(!1),[b,v]=w.useState(null),[S,k]=w.useState(!1),[T,E]=w.useState(null),P=w.useRef(null),[I,V]=w.useState(!1),[F,O]=w.useState(!1),[B,U]=w.useState(null),[z,$]=w.useState(null),[R,H]=w.useState(null),[ee,Z]=w.useState(!1),te=wt(),Q=gr();w.useEffect(()=>{(async()=>{try{const ve=await G_();H(ve.hasProPlan)}catch(ve){console.error("Error fetching pro status:",ve),H(!1)}})(),q()},[]);const q=async()=>{try{const ce=new URLSearchParams({page:"1",limit:"4",sortBy:"created_at",sortOrder:"desc"}),ve=await fe(`/api/patients?${ce.toString()}`);if(ve.ok){const le=await ve.json();l(le.patients)}}catch(ce){console.error("Error fetching recent patients:",ce)}},W=w.useCallback(async ce=>{const ve=ce||e;if(!ve.trim()){E("Please enter complaint details.");return}k(!0),E(null);try{const le=await fe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"New Patient - Direct Entry",age:null,gender:null,phone:null,address:null})});if(!le.ok){const tt=await le.json().catch(()=>({message:"Failed to create patient"}));if(le.status===403&&tt.message.includes("Patient limit")){te("/start-clinic-subscription",{state:{errorMessage:tt.message}});return}throw new Error(tt.message||`Failed to create patient: ${le.statusText}`)}const xe=await le.json();if(!xe||!xe.id)throw new Error("Failed to create new patient or retrieve patient ID.");const ue=await fe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:xe.id,complaint:ve})});if(!ue.ok){const tt=await ue.text();throw new Error(`Failed to create queue entry: ${tt||ue.statusText}`)}const ze=await ue.json();if(!ze||!ze.id)throw new Error("Failed to create new complaint record or retrieve record ID.");te(`/dashboard/edit-complaint/${ze.id}`,{state:{initialComplaint:ve,patientId:xe.id}})}catch(le){console.error("Error starting new complaint:",le),le.message.includes("Patient limit")?(E(`Error: ${le.message}. Please upgrade your plan.`),te("/start-clinic-subscription")):E(`Error: ${le.message||"Failed to start new complaint process."}`)}finally{k(!1)}},[e,te]);w.useEffect(()=>{const ce=P.current;ce&&(ce.style.height="auto",ce.style.height=`${ce.scrollHeight}px`);const le=new URLSearchParams(Q.search).get("caseDetails");if(le){const xe=decodeURIComponent(le);xe!==e&&(n(xe),V(!0))}},[Q.search,e]),w.useEffect(()=>{I&&e.trim()&&(te(Q.pathname,{replace:!0}),W(e),V(!1))},[I,e,W,te,Q.pathname]),w.useEffect(()=>{const ce=P.current;ce&&(ce.style.height="auto",ce.style.height=`${ce.scrollHeight}px`)},[e]),w.useEffect(()=>{B&&(n(B),O(!1),W(B),U(null))},[B,W]);const ne=()=>{if(R===!1){Z(!0);return}$({id:null,token:null,name:"New Case",age:null,gender:null}),O(!0)},A=w.useMemo(()=>kb(async ce=>{const ve=ce.trim(),le=/^\d+$/.test(ve),xe=ve.split(/\s+/).length;if(ve.length<2||le&&ve.length>10||!le&&xe>2){r([]),f(!1),d(null);return}f(!0),d(null);try{const ue=new URLSearchParams({search:encodeURIComponent(ce),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),ze=await fe(`/api/patients?${ue.toString()}`);if(!ze.ok){const ft=await ze.text();throw new Error(`API Error (${ze.status}): ${ft||ze.statusText}`)}const tt=await ze.json();r(tt.patients)}catch(ue){console.error("Error searching patients:",ue),d(ue.message||"Failed to search patients."),r([])}finally{f(!1)}},300),[]),ie=ce=>{const ve=ce.target.value;n(ve);const le=ve.trim(),xe=/^\d+$/.test(le),ue=le.split(/\s+/).length;le.length>=2&&!(xe&&le.length>10||!xe&&ue>2)?f(!0):(f(!1),r([])),A(ve)},se=ce=>{ce.key==="Enter"&&!ce.shiftKey&&(ce.preventDefault(),t.length>0&&!o?M(t[0]):e.trim()&&!o&&W(e))},M=async ce=>{r([]),n(""),g(!0),v(null);try{const ve=await fe(`/api/queue/patient/${ce.id}/latest`);if(ve.ok){const ue=await ve.json();if(ue!=null&&ue._id){if(ue!=null&&ue._id){te(`/dashboard/edit-complaint/${ue._id}`,{state:{patientId:ce.id}}),g(!1);return}g(!1);return}}else if(ve.status!==404){const ue=await ve.text();throw new Error(`Failed to fetch queue entry: ${ue||ve.statusText} (${ve.status})`)}const le=await fe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:ce.id})});if(!le.ok){const ue=await le.text();throw new Error(`Failed to create queue entry: ${ue||le.statusText} (${le.status})`)}const xe=await le.json();if(xe!=null&&xe.id)te(`/dashboard/edit-complaint/${xe.id}`,{state:{patientId:ce.id}});else throw new Error("Failed to get ID from new queue entry.")}catch(ve){console.error("Error processing patient selection:",ve),v(ve.message||"An error occurred while processing the selection.")}finally{g(!1)}};return i.jsxs("div",{className:"patient-search-page-container",children:[i.jsxs("div",{className:"patient-search-header",children:[i.jsx("button",{onClick:()=>te("/dashboard/queue"),className:"patient-search-button patient-search-button-primary",children:"OPD Queue"}),i.jsxs("button",{onClick:()=>te(-1),className:"patient-search-button patient-search-button-back",children:[i.jsx(Ht,{size:16}),"Back"]})]}),i.jsxs("div",{className:"patient-search-content-box",children:[u&&i.jsx("p",{className:"patient-search-error",children:u}),b&&i.jsx("p",{className:"patient-search-error",children:b}),T&&i.jsx("p",{className:"patient-search-error",children:T})]}),!e&&a.length>0&&i.jsxs("div",{className:"recent-patients-section",children:[i.jsx("div",{className:"recent-patients-grid",children:a.map(ce=>i.jsxs("div",{onClick:()=>M(ce),className:"recent-patient-card",children:[i.jsxs("div",{className:"recent-patient-info",children:[i.jsx("span",{className:"recent-patient-name",children:ce.name}),i.jsxs("span",{className:"recent-patient-details",children:[ce.age?`${ce.age} yrs`:"",ce.age&&ce.gender?" / ":"",ce.gender||""]})]}),i.jsxs("div",{className:"recent-patient-token",children:["#",ce.token]})]},ce.id))}),i.jsx("h2",{className:"recent-patients-title",children:"Newly Registered"})]}),i.jsxs("div",{className:"sticky-chat-input-box",children:[t.length>0&&!h&&!S&&i.jsx("ul",{className:"patient-search-results-list",children:t.map(ce=>i.jsxs("li",{onClick:()=>M(ce),className:"patient-search-result-item",children:[i.jsxs("div",{className:"patient-search-result-item-name-container",children:[i.jsxs("span",{className:"patient-search-result-item-token",children:["[#",ce.token,"]"]}),i.jsx("span",{className:"patient-search-result-item-name",children:ce.name})]}),i.jsxs("div",{className:"patient-search-result-item-details",children:[ce.age?`${ce.age} yrs`:"",ce.age&&ce.gender?" / ":"",ce.gender||"N/A"]})]},ce.id))}),e.length>=2&&!o&&t.length===0&&!u&&!h&&i.jsxs("p",{className:"patient-search-no-results",children:['No patients found matching, taking new case: "',e,'".']}),i.jsxs("div",{className:"chat-input-controls",children:[i.jsx("textarea",{ref:P,placeholder:"Search by Name/Phone/Token or Enter New Case: Name, Age, Sex, Complaint...",value:e,onChange:ie,onKeyDown:se,className:"chat-input",autoFocus:!0,disabled:h||S,rows:1}),i.jsx("button",{onClick:e.trim()?()=>W(e):ne,className:`chat-submit-button ${S||o?"opacity-50":""}`,disabled:S||o||!!e.trim()&&!e.trim(),"aria-label":e.trim()?"Create New Case":"Use Microphone",children:S||o?i.jsxs("div",{className:"spinner-dots",children:[i.jsx("div",{}),i.jsx("div",{}),i.jsx("div",{})]}):e.trim()?i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24",children:i.jsx("path",{d:"M12 4l1.41 1.41L7.83 11H20v2H7.83l5.58 5.59L12 20l-8-8 8-8z",transform:"rotate(90 12 12)"})}):i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24",children:i.jsx("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm-1.2-9.1c0-.66.54-1.2 1.2-1.2s1.2.54 1.2 1.2V9c0 .66-.54 1.2-1.2 1.2s-1.2-.54-1.2-1.2V4.9zM17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"})})})]})]}),F&&i.jsx(gw,{options:fU,children:i.jsx(ak,{onClose:()=>O(!1),patientData:z,tokenNumber:null,onAiSummaryChange:U})}),ee&&i.jsx(uU,{onClose:()=>Z(!1)})]})},hU=()=>{const e=wt(),[n,t]=w.useState({admissionCharge:"0.00",perDayCharge:"0.00",otherCharges:"0.00",aiMemory:"",clinicWideSystemPrompt:"",gemini_api_key:"",low_stock_threshold:"10",aiLanguage:"",name:"",logoUrl:"",upi_id:"",address:"",notes:""}),[r,a]=w.useState(!0),[l,o]=w.useState(!1),[f,u]=w.useState(null),[d,h]=w.useState(null);w.useEffect(()=>{(async()=>{a(!0),u(null);try{const S=await fe("/api/clinics/settings");if(!S.ok){const T=await S.json();throw new Error(T.message||"Failed to fetch clinic settings.")}const k=await S.json();t({admissionCharge:parseFloat(k.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(k.perDayCharge||0).toFixed(2),otherCharges:parseFloat(k.otherCharges||0).toFixed(2),aiMemory:k.aiMemory||"",clinicWideSystemPrompt:k.clinicWideSystemPrompt||"",gemini_api_key:k.gemini_api_key||"",low_stock_threshold:k.low_stock_threshold!==void 0&&k.low_stock_threshold!==null?String(k.low_stock_threshold):"10",aiLanguage:k.aiLanguage||"",name:k.name||"",logoUrl:k.logoUrl||"",upi_id:k.upi_id||"",address:k.address||"",notes:k.notes||""})}catch(S){console.error("Error fetching settings:",S),u(`Failed to load settings: ${S.message}`),t({admissionCharge:"0.00",perDayCharge:"0.00",otherCharges:"0.00",aiMemory:"",clinicWideSystemPrompt:"",gemini_api_key:"",low_stock_threshold:"10",aiLanguage:"",name:"Unknown Clinic",logoUrl:"",upi_id:"",address:"",notes:""})}finally{a(!1)}})()},[]);const g=v=>{const{name:S,value:k}=v.target;t(T=>({...T,[S]:k}))},b=async v=>{v.preventDefault(),u(null),h(null),o(!0);const S=parseFloat(n.admissionCharge),k=parseFloat(n.perDayCharge),T=parseFloat(n.otherCharges),E=parseInt(n.low_stock_threshold);if(isNaN(S)||S<0||isNaN(k)||k<0||isNaN(T)||T<0){u("Invalid charge amount. Please enter non-negative numbers for all fields."),o(!1);return}if(isNaN(E)||E<0){u("Invalid low stock threshold. Please enter a non-negative number."),o(!1);return}try{const P=await fe("/api/clinics/settings",{method:"PUT",body:JSON.stringify({name:n.name,admissionCharge:S,perDayCharge:k,otherCharges:T,aiMemory:n.aiMemory,clinicWideSystemPrompt:n.clinicWideSystemPrompt,gemini_api_key:n.gemini_api_key,low_stock_threshold:E,aiLanguage:n.aiLanguage,logoUrl:n.logoUrl,upi_id:n.upi_id,address:n.address,notes:n.notes})});if(!P.ok){const V=await P.json();throw new Error(V.message||"Failed to update settings.")}const I=await P.json();t({admissionCharge:parseFloat(I.settings.admissionCharge).toFixed(2),perDayCharge:parseFloat(I.settings.perDayCharge).toFixed(2),otherCharges:parseFloat(I.settings.otherCharges).toFixed(2),aiMemory:I.settings.aiMemory||"",clinicWideSystemPrompt:I.settings.clinicWideSystemPrompt||"",gemini_api_key:I.settings.gemini_api_key||"",low_stock_threshold:I.settings.low_stock_threshold!==void 0&&I.settings.low_stock_threshold!==null?String(I.settings.low_stock_threshold):"10",aiLanguage:I.settings.aiLanguage||"",name:I.settings.name||"",logoUrl:I.settings.logoUrl||"",upi_id:I.settings.upi_id||"",address:I.settings.address||"",notes:I.settings.notes||""}),h("Clinic settings updated successfully!"),setTimeout(()=>h(null),3e3)}catch(P){console.error("Error updating settings:",P),u(`Update failed: ${P.message}`)}finally{o(!1)}};return r?i.jsxs("div",{className:"loading-animation-container",children:[i.jsx("div",{className:"breathing-ball"}),i.jsx("div",{className:"loading-text",children:"Loading settings..."})]}):i.jsxs("div",{className:"clinic-settings-container",children:[i.jsxs("div",{className:"clinic-settings-header-container",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button",children:i.jsx(Ht,{size:24})}),i.jsxs("h3",{className:"clinic-settings-header",children:[i.jsx(dg,{size:24}),"Clinic Settings"]})]}),f&&i.jsx("div",{className:"clinic-settings-alert clinic-settings-alert-error",role:"alert",children:f}),d&&i.jsx("div",{className:"clinic-settings-alert clinic-settings-alert-success",role:"alert",children:d}),i.jsxs("form",{onSubmit:b,className:"clinic-settings-form",children:[i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"name",className:"clinic-settings-label",children:"Clinic Name"}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name,onChange:g,className:"clinic-settings-input",disabled:l,placeholder:"e.g., My Awesome Clinic"})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"admissionCharge",className:"clinic-settings-label",children:[i.jsx(zd,{size:16})," Admission Charge ()"]}),i.jsx("input",{type:"number",id:"admissionCharge",name:"admissionCharge",value:n.admissionCharge,onChange:g,className:"clinic-settings-input",step:"0.01",min:"0",required:!0,disabled:l,placeholder:"e.g., 500.00"})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"perDayCharge",className:"clinic-settings-label",children:[i.jsx(zd,{size:16})," Per Day Charge ()"]}),i.jsx("input",{type:"number",id:"perDayCharge",name:"perDayCharge",value:n.perDayCharge,onChange:g,className:"clinic-settings-input",step:"0.01",min:"0",required:!0,disabled:l,placeholder:"e.g., 1000.00"})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"otherCharges",className:"clinic-settings-label",children:[i.jsx(zd,{size:16})," Other Charges (Default/Misc.) ()"]}),i.jsx("input",{type:"number",id:"otherCharges",name:"otherCharges",value:n.otherCharges,onChange:g,className:"clinic-settings-input",step:"0.01",min:"0",required:!0,disabled:l,placeholder:"e.g., 50.00"})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"low_stock_threshold",className:"clinic-settings-label",children:[i.jsx(vP,{size:16})," Low Stock Notification Threshold"]}),i.jsx("input",{type:"number",id:"low_stock_threshold",name:"low_stock_threshold",value:n.low_stock_threshold,onChange:g,className:"clinic-settings-input",min:"0",required:!0,disabled:l,placeholder:"e.g., 10"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Set the minimum quantity of a drug to trigger a low stock notification."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"aiMemory",className:"clinic-settings-label",children:[i.jsx(V0,{size:16})," AI Memory (Plain Text)"]}),i.jsx("textarea",{id:"aiMemory",name:"aiMemory",value:n.aiMemory,onChange:g,className:"clinic-settings-textarea",disabled:l,placeholder:"Enter any clinic-wide notes or context for the AI..."}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter clinic-wide AI memory data as plain text."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"clinicWideSystemPrompt",className:"clinic-settings-label",children:[i.jsx(gI,{size:16})," Clinic-Wide AI System Prompt"]}),i.jsx("textarea",{id:"clinicWideSystemPrompt",name:"clinicWideSystemPrompt",value:n.clinicWideSystemPrompt,onChange:g,className:"clinic-settings-textarea",disabled:l,placeholder:"Enter the system prompt for the AI that will apply to all interactions within this clinic..."}),i.jsx("p",{className:"clinic-settings-help-text",children:"This prompt will be used as the base instruction for the AI across the clinic."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"aiLanguage",className:"clinic-settings-label",children:"AI Language"}),i.jsxs("select",{id:"aiLanguage",name:"aiLanguage",value:n.aiLanguage,onChange:g,className:"clinic-settings-input",disabled:l,children:[i.jsx("option",{value:"",children:"Select Language"}),i.jsx("option",{value:"English",children:"English"}),i.jsx("option",{value:"Hindi",children:"Hindi"}),i.jsx("option",{value:"Telugu",children:"Telugu"}),i.jsx("option",{value:"Tamil",children:"Tamil"}),i.jsx("option",{value:"Kannada",children:"Kannada"}),i.jsx("option",{value:"Malayalam",children:"Malayalam"}),i.jsx("option",{value:"Bengali",children:"Bengali"}),i.jsx("option",{value:"Gujarati",children:"Gujarati"}),i.jsx("option",{value:"Marathi",children:"Marathi"}),i.jsx("option",{value:"Punjabi",children:"Punjabi"})]}),i.jsx("p",{className:"clinic-settings-help-text",children:"Specify the language for AI interactions."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"logoUrl",className:"clinic-settings-label",children:"Clinic Logo URL"}),i.jsx("input",{type:"url",id:"logoUrl",name:"logoUrl",value:n.logoUrl,onChange:g,className:"clinic-settings-input",disabled:l,placeholder:"e.g., https://example.com/logo.png"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter the URL for your clinic's logo."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"upi_id",className:"clinic-settings-label",children:"UPI ID"}),i.jsx("input",{type:"text",id:"upi_id",name:"upi_id",value:n.upi_id,onChange:g,className:"clinic-settings-input",disabled:l,placeholder:"e.g., yourclinic@upi"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter your clinic's UPI ID for payments."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"address",className:"clinic-settings-label",children:"Clinic Address"}),i.jsx("textarea",{id:"address",name:"address",value:n.address,onChange:g,className:"clinic-settings-textarea",disabled:l,placeholder:"Enter your clinic's full address"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter the physical address of your clinic."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"notes",className:"clinic-settings-label",children:"Other Clinic Details/Notes"}),i.jsx("textarea",{id:"notes",name:"notes",value:n.notes,onChange:g,className:"clinic-settings-textarea",disabled:l,placeholder:"Enter any other relevant clinic details or notes"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Add any additional information or notes about your clinic."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"gemini_api_key",className:"clinic-settings-label",children:[i.jsx(V0,{size:16})," Gemini API Key"]}),i.jsx("input",{type:"text",id:"gemini_api_key",name:"gemini_api_key",value:n.gemini_api_key,onChange:g,className:"clinic-settings-input",disabled:l,placeholder:"Enter your Gemini API key"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter your Gemini API key to enable AI features."})]}),i.jsx("div",{className:"clinic-settings-button-container",children:i.jsxs("button",{type:"submit",className:"clinic-settings-button",disabled:l,children:[i.jsx(eu,{size:18})," ",l?"Saving...":"Save Settings"]})})]})]})},pU=({})=>{const e=wt(),[n,t]=w.useState("patientSearch"),[r]=w.useState(!1),[a,l]=w.useState(null),[o,f]=w.useState(null);return w.useEffect(()=>{if(o){const u=setTimeout(()=>f(null),5e3);return()=>clearTimeout(u)}},[o]),r?i.jsxs("div",{className:"loading-animation-container",children:[" ",i.jsx("div",{className:"breathing-ball"}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Admin Panel..."})]}):i.jsxs("div",{className:"admin-panel-container",children:[" ",o&&i.jsxs("div",{className:`alert-box ${o.type==="success"?"alert-box-success":"alert-box-error"} fixed top-4 right-4 z-[100]`,role:"alert",children:[i.jsx("div",{className:"alert-box-icon",children:o.type==="success"?i.jsx(Ua,{size:18}):i.jsx(si,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{children:o.message})}),i.jsx("button",{onClick:()=>f(null),className:"alert-box-close",children:i.jsx(Kn,{size:16})})]}),a&&i.jsxs("div",{className:"alert-box alert-box-error mb-4",role:"alert",children:[" ",i.jsx("div",{className:"alert-box-icon",children:i.jsx(si,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{className:"block sm:inline flex-1",children:a})}),i.jsx("button",{onClick:()=>l(null),className:"alert-box-close",children:i.jsx(Kn,{size:16})})]}),i.jsxs("div",{className:"admin-nav-bar",children:[" ",i.jsxs("button",{onClick:()=>window.location.reload(),className:"admin-nav-button",title:"Refresh Page",children:[i.jsx(D_,{})," "]}),i.jsxs("button",{onClick:()=>e("/dashboard/staff"),className:"admin-nav-button",children:[i.jsx(zh,{})," Staff"]}),i.jsx("button",{onClick:()=>t("moneyFlow"),className:`admin-nav-button ${n==="moneyFlow"?"active":""}`,children:"Money"}),i.jsx("button",{onClick:()=>t("inventory"),className:`admin-nav-button ${n==="inventory"?"active":""}`,children:"Inventory"}),i.jsx("button",{onClick:()=>e("/lab-inventory"),className:"admin-nav-button hidden-button",children:"Lab Inventory"}),i.jsxs("button",{onClick:()=>t("clinicSettings"),className:`admin-nav-button ${n==="clinicSettings"?"active":""}`,children:[i.jsx(dg,{})," Settings"]}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions"),className:"admin-nav-button hidden-button",children:[i.jsx(E_,{})," Patient Subscriptions"]}),i.jsxs("button",{onClick:()=>e("/dashboard/add-pharmacy-order"),className:"admin-nav-button",children:[i.jsx(Uo,{})," Order Meds"]}),i.jsx("button",{onClick:()=>e("/dashboard/recurring-medications"),className:"admin-nav-button",children:"Daily Meds"}),i.jsxs("button",{onClick:()=>e("/create-lab-order"),className:"admin-nav-button",children:[i.jsx(k_,{})," Order Tests"]}),i.jsxs("button",{onClick:()=>e("/dashboard/patients"),className:"admin-nav-button",children:[i.jsx(zh,{})," All Patients"]})]}),i.jsxs("div",{className:"space-y-6",children:[" ",n==="patientSearch"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(Dh,{})}),n==="moneyFlow"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(QM,{})}),n==="inventory"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(Y0,{})}),n==="clinicSettings"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(hU,{})})]})]})},Vc=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},mU=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},Nh=({title:e,icon:n,items:t,renderItemContent:r,isLoading:a,loadingText:l,noDataText:o})=>{const f=w.useMemo(()=>{const u={};t.forEach(h=>{if(isNaN(h.date.getTime())){u["Unknown Date"]||(u["Unknown Date"]=[]),u["Unknown Date"].push(h);return}const g=mU(h.originalDateString);u[g]||(u[g]=[]),u[g].push(h)});const d=Object.keys(u);return d.sort((h,g)=>{if(h==="Unknown Date")return 1;if(g==="Unknown Date")return-1;try{const b=k=>{const T=k.split(" ");if(T.length===3){const P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(T[1]);if(P!==-1)return new Date(parseInt(T[2]),P,parseInt(T[0]))}return new Date(k)},v=b(h),S=b(g);if(!isNaN(v.getTime())&&!isNaN(S.getTime()))return S.getTime()-v.getTime()}catch(b){console.error("Error parsing date for sorting:",b)}return g.localeCompare(h)}),d.map(h=>({date:h,items:u[h]}))},[t]);return i.jsxs("div",{className:"mb-2 p-2 bg-gray-50 rounded-md border border-gray-200",children:[i.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-1.5 border-b border-gray-300 pb-1 flex items-center",children:[" ",n&&i.jsx(n,{size:14,className:"mr-1.5 text-indigo-600"})," ",e]}),a&&i.jsx("p",{className:"text-gray-500 italic text-xs px-1",children:l}),!a&&t.length===0&&i.jsx("p",{className:"text-gray-500 italic text-xs px-1",children:o}),!a&&t.length>0&&i.jsxs("div",{className:"space-y-2",children:[" ",f.map(({date:u,items:d})=>i.jsxs("div",{className:"pl-0.5",children:[" ",i.jsxs("h5",{className:"text-[11px] font-medium text-indigo-700 mb-1 bg-indigo-50 px-1 py-0.5 rounded-sm inline-block",children:[" ",u]}),i.jsx("div",{className:"space-y-1 pl-1.5 border-l-2 border-indigo-200 ml-0.5",children:d.map((h,g)=>i.jsxs("div",{className:"text-xs py-0 flex items-start",children:[" ",i.jsx("div",{className:"flex-grow mr-1",children:r(h)})," "]},`${h.type}-${h.originalDateString}-${g}`))})]},u))]})]})},a0=()=>{var te,Q;const[e,n]=w.useState({currentPatient:null,nextPatient:null,waitingCount:0}),[t,r]=w.useState(!0),[a,l]=w.useState(null),[o,f]=w.useState(null),[u,d]=w.useState(null),[h,g]=w.useState(null),[b,v]=w.useState({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),[S,k]=w.useState(!1),[T,E]=w.useState(null),{patientId:P}=Rr(),I=wt(),V=w.useCallback(async q=>{g(null),f(null),d(null),k(!0),E(null),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]});try{const W=await fe(`/api/patients/${q}`);if(!W.ok)throw new Error(`Patient details fetch failed (${W.status})`);const ne=await W.json();f(ne);const A=await fe(`/api/queue/patient/${q}/latest`);if(!A.ok&&A.status!==404)throw new Error(`Queue entry fetch failed (${A.status})`);if(A.ok){const ie=await A.json();d(ie)}await F(q)}catch(W){console.error("Error fetching specific patient data:",W),g(W.message||"Failed to load patient data."),E(W.message||"Failed to load patient history.")}finally{k(!1)}},[]),F=w.useCallback(async q=>{k(!0),E(null);try{const[W,ne,A,ie]=await Promise.all([fe(`/api/queue/patient/${q}/complaints`),fe(`/api/lab/patient/${q}`),fe(`/api/lab/orders/patient/${q}?status=pending`),fe(`/api/pharmacy-orders/patient/${q}`)]),se=W.ok?await W.json():[],M=ne.ok?await ne.json():[],ce=A.ok?await A.json():[],ve=ie.ok?await ie.json():[];v({pastComplaints:se||[],labReports:M||[],pendingLabOrders:ce||[],pharmacyOrders:ve||[]})}catch(W){console.error("Error fetching patient history:",W),E(W.message||"Failed to load patient history."),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]})}finally{k(!1)}},[]),O=w.useCallback(async()=>{r(!0),l(null);try{const q=await fe("/api/queue/doctor");if(!q.ok){const ne=await q.text();throw new Error(`API Error (${q.status}): ${ne||q.statusText}`)}const W=await q.json();if(W===null||typeof W!="object"||typeof W.waitingCount!="number")throw console.error("Invalid queue data format:",W),new Error("Invalid queue data format received");n({currentPatient:W.currentPatient||null,nextPatient:W.nextPatient||null,waitingCount:W.waitingCount})}catch(q){console.error("Error fetching queue data:",q),l(q.message||"Failed to fetch queue data.")}finally{r(!1)}},[]);w.useEffect(()=>{let q=null;return P?(V(P),n({currentPatient:null,nextPatient:null,waitingCount:0})):(O(),q=setInterval(O,1e4),f(null),d(null)),()=>{q&&clearInterval(q)}},[P,V,O]),w.useEffect(()=>{var q;!P&&((q=e.currentPatient)!=null&&q.patientId)?F(e.currentPatient.patientId):!P&&!e.currentPatient&&(v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),E(null))},[P,(te=e.currentPatient)==null?void 0:te.patientId,F]);const B=((Q=e.currentPatient)==null?void 0:Q.patientId)||(P?parseInt(P,10):null),U=w.useMemo(()=>{if(!B||!b.pastComplaints)return[];const q=b.pastComplaints.map(W=>({date:new Date(W.createdAt),type:"Complaint",data:W,originalDateString:W.createdAt})).filter(W=>!isNaN(W.date.getTime()));return q.sort((W,ne)=>ne.date.getTime()-W.date.getTime()),q},[B,b.pastComplaints]),z=w.useMemo(()=>{if(!B)return[];const q=[];return(b.pendingLabOrders??[]).forEach(W=>{const ne=new Date(W.createdAt);isNaN(ne.getTime())||q.push({date:ne,type:"Lab Order (Pending)",data:W,originalDateString:W.createdAt})}),(b.labReports??[]).forEach(W=>{const ne=W.reportCreatedAt?new Date(W.reportCreatedAt):null;ne&&!isNaN(ne.getTime())&&q.push({date:ne,type:"Lab Report",data:W,originalDateString:W.reportCreatedAt})}),q.sort((W,ne)=>ne.date.getTime()-W.date.getTime()),q},[B,b.pendingLabOrders,b.labReports]),$=w.useMemo(()=>{if(!B||!b.pharmacyOrders)return[];const q=b.pharmacyOrders.map(W=>({date:new Date(W.date),type:"Pharmacy Order",data:W,originalDateString:W.date})).filter(W=>!isNaN(W.date.getTime()));return q.sort((W,ne)=>ne.date.getTime()-W.date.getTime()),q},[B,b.pharmacyOrders]),R=async()=>{r(!0),l(null);try{await fe("/api/queue/doctor/next",{method:"POST"}),await O()}catch(q){console.error("Error calling next patient:",q),l(q.message||"Failed to call next patient.")}finally{r(!1)}},H=async()=>{if(!(!e.currentPatient||P)){r(!0),l(null);try{await fe(`/api/queue/doctor/complete/${e.currentPatient._id}`,{method:"POST"}),await O(),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),E(null)}catch(q){console.error("Error completing consultation:",q),l(q.message||"Failed to complete consultation.")}finally{r(!1)}}},ee=q=>{switch(q){case"waiting":return"Waiting";case"consulting":return"Consulting";case"seen":return"Seen";case"cancelled":return"Cancelled";default:return q}};let Z=null;return e.currentPatient&&(Z=i.jsxs("div",{className:"patient-info-section bg-white rounded-lg shadow-md p-4 md:p-6 border-l-8 border-teal-500",children:[i.jsx("h2",{className:"text-xl text-teal-700 font-semibold mb-3",children:"NOW SEEING:"}),i.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[i.jsxs("div",{className:"flex-grow md:w-1/2",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{className:"flex-grow mr-4",children:[i.jsx("div",{className:"text-3xl md:text-4xl font-bold text-gray-800 mb-1",children:e.currentPatient.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-600",children:[i.jsx("span",{className:"font-bold",children:e.currentPatient.age})," | ",i.jsx("span",{className:"font-bold",children:e.currentPatient.gender})]})]}),i.jsxs("div",{className:"text-right flex-shrink-0",children:[i.jsx("div",{className:"text-2xl md:text-3xl font-bold text-gray-700 mb-1",children:e.currentPatient.token}),i.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-sm md:text-base font-medium ${e.currentPatient.status==="consulting"?"bg-teal-100 text-teal-800":"bg-gray-100 text-gray-800"}`,children:ee(e.currentPatient.status)})]})]}),i.jsxs("div",{className:"actions-section mt-4 md:mt-6 flex justify-end space-x-3 border-t pt-4",children:[i.jsx("button",{onClick:()=>{var W;const q=(W=e.currentPatient)==null?void 0:W._id;q&&I(`/dashboard/edit-complaint/${q}`)},disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:"Edit Complaint / AI"}),i.jsx("button",{onClick:H,disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-success disabled:opacity-50 disabled:cursor-not-allowed",children:"Complete Consultation"})]})]})," ",i.jsxs("div",{className:"complaint-section md:w-1/2 mt-4 md:mt-0 border-t md:border-t-0 md:border-l md:pl-6 pt-4 md:pt-0",children:[i.jsx("h3",{className:"text-base font-semibold text-gray-800 mb-2",children:"Context & History:"}),T&&i.jsx("p",{className:"text-red-500 text-xs mb-2",children:T}),i.jsxs("div",{className:"space-y-2 pr-2",children:[i.jsx(Nh,{title:"Complaints History",icon:ps,items:U,isLoading:S,loadingText:"Loading complaints...",noDataText:"No past complaints found.",renderItemContent:q=>i.jsxs("span",{className:"block text-xs",children:[q.data.complaint,i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(q.originalDateString),")"]})]})}),i.jsx(Nh,{title:"Lab History (Orders & Reports)",icon:Xx,items:z,isLoading:S,loadingText:"Loading lab history...",noDataText:"No lab history found.",renderItemContent:q=>q.type==="Lab Order (Pending)"?i.jsxs("span",{className:"flex items-start text-xs",children:[i.jsx(vN,{size:12,className:"mr-1.5 mt-0.5 text-blue-600 flex-shrink-0"}),i.jsxs("span",{className:"block",children:[i.jsx("span",{className:"font-medium text-blue-700",children:"Order:"})," ",q.data.tests.map(W=>W.name).join(", ")," ",i.jsxs("span",{className:"text-gray-600",children:["(",q.data.status,")"]}),i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(q.originalDateString),")"]})]})]}):i.jsxs("span",{className:"flex items-start text-xs",children:[i.jsx(wN,{size:12,className:"mr-1.5 mt-0.5 text-green-600 flex-shrink-0"}),i.jsxs("span",{className:"block",children:[i.jsx("span",{className:"font-medium text-green-700",children:"Report:"})," ",q.data.testName," - ",q.data.reportFindings.substring(0,50),q.data.reportFindings.length>50?"...":"",i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(q.originalDateString),")"]})]})]})}),i.jsx(Nh,{title:"Pharmacy Order History",icon:Ud,items:$,isLoading:S,loadingText:"Loading pharmacy orders...",noDataText:"No pharmacy order history found.",renderItemContent:q=>i.jsxs("span",{className:"block text-xs",children:[q.data.medications.map(W=>`${W.name} (Qty: ${W.quantity})`).join(", ")," ",i.jsxs("span",{className:"text-gray-600",children:["(",q.data.status,")"]}),i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(q.originalDateString),")"]})]})}),U.length===0&&z.length===0&&$.length===0&&!S&&i.jsx("p",{className:"text-gray-500 italic text-xs mt-2 px-1",children:"No history found for this patient."})]})," "]})," "]})," "]})),i.jsx(i.Fragment,{children:i.jsxs("div",{className:"doctor-screen-container flex-grow flex flex-col space-y-6 md:space-y-8",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("button",{onClick:()=>I(-1),className:"back-button mr-4",children:i.jsx(Ht,{size:24})}),i.jsx("h1",{className:"doctor-screen-header",children:"Doctor Consultation Panel"})]}),P?i.jsxs(i.Fragment,{children:[h&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:h}),o&&i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border-l-8 border-purple-500",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"text-xl text-purple-700 font-semibold",children:"Patient Record:"}),i.jsx("button",{onClick:()=>I("/dashboard/doctor"),className:"text-sm text-blue-600 hover:underline",children:"Back to Queue"})]}),i.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-1 md:mb-2",children:o.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-600 mb-3 md:mb-4",children:["Age: ",o.age??"N/A"," | ",o.gender??"N/A"]}),i.jsxs("div",{className:"mt-3 md:mt-4 p-3 bg-gray-50 rounded border border-gray-200",children:[i.jsx("label",{className:"font-medium block mb-1 text-sm text-gray-600",children:"Latest Queue Entry:"}),u?i.jsxs("div",{className:"space-y-2",children:[" ",i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("span",{className:"text-sm flex-1 break-words",children:[i.jsxs("span",{className:"font-medium text-gray-700",children:["(",u.age," / ",u.gender,")"]}),": ",u.complaint||i.jsx("span",{className:"text-gray-400 italic",children:"No complaint"}),i.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full text-xs font-medium ${u.status==="consulting"?"bg-teal-100 text-teal-800":u.status==="seen"?"bg-green-100 text-green-800":u.status==="waiting"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:ee(u.status)})]}),u.status==="consulting"&&u._id&&i.jsx("button",{onClick:()=>I(`/dashboard/edit-complaint/${u._id}`),className:"ml-4 px-2 py-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 rounded flex-shrink-0",children:"Edit"})]}),u.case_summary&&i.jsxs("p",{className:"text-xs text-gray-700 bg-yellow-50 p-2 rounded border border-yellow-200",children:[i.jsx("span",{className:"font-semibold text-gray-800",children:"AI Summary:"})," ",u.case_summary]})]}):i.jsx("p",{className:"text-gray-500 italic text-sm",children:"No queue entry found for this patient today."})]}),i.jsxs("div",{className:"mt-4 border-t pt-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Patient History:"}),T&&i.jsx("p",{className:"text-red-500 text-xs mb-2",children:T}),i.jsx(Nh,{title:"Complaints History",icon:ps,items:U,isLoading:S,loadingText:"Loading complaints...",noDataText:"No past complaints found.",renderItemContent:q=>i.jsxs("span",{className:"block text-xs",children:[" ",q.data.complaint,i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(q.originalDateString),")"]})]})}),i.jsx(Nh,{title:"Lab History (Orders & Reports)",icon:Xx,items:z,isLoading:S,loadingText:"Loading lab history...",noDataText:"No lab history found.",renderItemContent:q=>q.type==="Lab Order (Pending)"?i.jsxs("span",{className:"flex items-start text-xs",children:[" ",i.jsx(vN,{size:12,className:"mr-1.5 mt-0.5 text-blue-600 flex-shrink-0"})," ",i.jsxs("span",{className:"block",children:[i.jsx("span",{className:"font-medium text-blue-700",children:"Order:"})," ",q.data.tests.map(W=>W.name).join(", ")," ",i.jsxs("span",{className:"text-gray-600",children:["(",q.data.status,")"]}),i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(q.originalDateString),")"]})]})]}):i.jsxs("span",{className:"flex items-start text-xs",children:[" ",i.jsx(wN,{size:12,className:"mr-1.5 mt-0.5 text-green-600 flex-shrink-0"})," ",i.jsxs("span",{className:"block",children:[i.jsx("span",{className:"font-medium text-green-700",children:"Report:"})," ",q.data.testName," - ",q.data.reportFindings.substring(0,50),q.data.reportFindings.length>50?"...":"",i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(q.originalDateString),")"]})]})]})}),i.jsx(Nh,{title:"Pharmacy Order History",icon:Ud,items:$,isLoading:S,loadingText:"Loading pharmacy orders...",noDataText:"No pharmacy order history found.",renderItemContent:q=>i.jsxs("span",{className:"block text-xs",children:[" ",q.data.medications.map(W=>`${W.name} (Qty: ${W.quantity})`).join(", ")," ",i.jsxs("span",{className:"text-gray-600",children:["(",q.data.status,")"]}),i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Vc(q.originalDateString),")"]})]})}),U.length===0&&z.length===0&&$.length===0&&!S&&i.jsx("p",{className:"text-gray-500 italic text-sm mt-2",children:"No history found."})]})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex justify-end space-x-3 mb-4",children:[i.jsxs("button",{onClick:()=>I("/dashboard/add-patient"),className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded shadow flex items-center",children:[i.jsx(L_,{size:18,className:"mr-2"})," Add Patient"]}),i.jsx("button",{onClick:()=>I("/search-patient"),className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded shadow",children:"Search Patient"})]}),a&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:a}),t&&!e.currentPatient&&i.jsx("p",{className:"text-gray-500 p-4 text-center",children:"Loading queue..."}),i.jsx("div",{className:"mb-6 md:mb-8",children:Z||i.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 text-center text-gray-500",children:"No patient currently being seen. Use 'Call Next' or search for a patient record."})}),i.jsxs("div",{className:"current-queue-section mb-6 md:mb-8",children:[i.jsx("h2",{className:"text-xl text-blue-700 font-semibold mb-3 md:mb-4",children:"NEXT IN QUEUE:"}),e.nextPatient?i.jsxs("div",{className:"patient-info-section bg-blue-50 rounded-lg shadow-md p-5 md:p-6 border-l-8 border-blue-500",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 md:mb-4",children:[i.jsxs("span",{className:"text-2xl md:text-3xl font-bold text-blue-800 mb-2 sm:mb-0",children:["Token #",e.nextPatient.token]}),i.jsx("span",{className:`px-3 py-1 rounded-full text-sm md:text-base font-medium ${e.nextPatient.status==="waiting"?"bg-blue-200 text-blue-900":"bg-gray-200 text-gray-800"}`,children:ee(e.nextPatient.status)})]}),i.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-2 md:mb-3",children:e.nextPatient.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-700 mb-3 md:mb-4",children:["Age: ",e.nextPatient.age," | ",e.nextPatient.gender]}),(e.nextPatient.complaint||e.nextPatient.case_summary)&&i.jsxs("div",{className:"mt-3 md:mt-4 pt-3 border-t border-blue-200 space-y-2",children:[e.nextPatient.complaint&&i.jsxs("p",{className:"text-base md:text-lg text-gray-800",children:[i.jsx("span",{className:"font-semibold text-gray-900",children:"Complaint:"})," ",e.nextPatient.complaint]}),e.nextPatient.case_summary&&i.jsxs("p",{className:"text-sm text-gray-700 bg-yellow-50 p-2 rounded border border-yellow-200",children:[i.jsx("span",{className:"font-semibold text-gray-800",children:"AI Summary:"})," ",e.nextPatient.case_summary]})]})]}):i.jsx("div",{className:"bg-gray-50 rounded-lg shadow-inner p-6 text-center text-gray-600 border border-gray-200",children:"No patient waiting next in the queue."})]}),i.jsxs("div",{className:"actions-section mt-auto pt-4 md:pt-6 flex flex-col sm:flex-row justify-between items-center gap-4",children:[i.jsx("button",{onClick:R,disabled:t||!e.nextPatient||!!e.currentPatient,className:"btn btn-primary w-full sm:w-auto disabled:opacity-50 disabled:cursor-not-allowed order-1 sm:order-none",children:"Call Next Patient"}),i.jsx("div",{className:"bg-gray-200 inline-block px-4 py-2 rounded-full order-2 sm:order-none",children:i.jsxs("span",{className:"text-base md:text-lg font-medium",children:[e.waitingCount," patients waiting"]})})]})]})]})})},sk=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,l]=w.useState(null),[o,f]=w.useState(null),[u,d]=w.useState(null),[h,g]=w.useState(null),[b,v]=w.useState(!1),[S,k]=w.useState(!1),[T,E]=w.useState(null),P=wt(),I=w.useCallback(ik.debounce(async $=>{if($.trim().length<2){r([]),k(!1);return}k(!0),E(null);try{const R=new URLSearchParams({search:encodeURIComponent($),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),H=await fe(`/api/patients?${R.toString()}`);if(!H.ok){const Z=await H.text();throw new Error(`API Error (${H.status}): ${Z||H.statusText||"Failed to fetch patients"}`)}const ee=await H.json();r(ee.patients)}catch(R){E(R instanceof Error?R.message:"An unknown error occurred while searching patients"),r([])}finally{k(!1)}},500),[]);w.useEffect(()=>(e?(k(!0),I(e)):(r([]),I.cancel()),()=>{I.cancel()}),[e,I]);const V=$=>{l($),n(""),r([]),E(null),f(null),d(null),g(null),v(!1)},F=async()=>{if(!a){E("No patient selected.");return}E(null),k(!0);try{const $=await fe(`/api/patients/${a.id}/admit`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!$.ok){const H=await $.json().catch(()=>({message:"Failed to admit patient"}));throw new Error(H.message||"Failed to admit patient")}const R=await $.json();alert(R.message||"Patient admitted successfully!"),R.bill&&R.bill.id?P(`/patient/${a.id}/admission-bill/${R.bill.id}`):(console.error("Admission successful, but bill ID missing in response."),E("Admission successful, but couldn't navigate to billing."),l(R.patient))}catch($){E($ instanceof Error?$.message:"Failed to admit patient")}finally{k(!1)}};w.useEffect(()=>{(async()=>{if(!a||!a.admission_date||a.discharge_date){f(null),g(null);return}v(!0),d(null),f(null),g(null);try{const R=await fe(`/api/patients/${a.id}/active-bill?type=admission`);if(!R.ok)throw R.status===404?new Error("No active admission bill found."):new Error("Failed to fetch active bill ID.");const H=await R.json(),ee=H==null?void 0:H.id;if(!ee)throw new Error("Active admission bill ID not found in response.");f(ee);const Z=await fe(`/api/bills/${ee}`);if(!Z.ok)throw new Error(`Failed to fetch bill details (ID: ${ee}). Status: ${Z.status}`);const te=await Z.json();if(te&&te.calculated)g(te.calculated);else throw console.error("Fetched bill details missing 'calculated' object:",te),new Error("Fetched bill details are incomplete (missing calculated data).")}catch(R){d(R instanceof Error?R.message:"An unknown error occurred while fetching bill details."),f(null),g(null)}finally{v(!1)}})()},[a]);const O=async()=>{if(!a){E("No patient selected.");return}if(!a.admission_date||a.discharge_date){E("Patient is not currently admitted.");return}E(null),k(!0);try{const $=await fe(`/api/patients/${a.id}/discharge`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!$.ok){const H=await $.json().catch(()=>({message:"Failed to discharge patient"}));throw new Error(H.message||"Failed to discharge patient")}const R=await $.json();alert(R.message||"Patient discharged successfully!"),R.patient?l(R.patient):(console.error("Discharge successful, but updated patient info missing in response."),l(null),E("Discharge successful, but couldn't update patient details locally."))}catch($){E($ instanceof Error?$.message:"Failed to discharge patient")}finally{k(!1)}},B=()=>{if(!a||!o){E("Cannot navigate to billing: Patient or Bill ID missing.");return}P(`/patient/${a.id}/admission-bill/${o}`)};let U="",z=null;if(a){const $=a.admission_date?new Date(a.admission_date).toLocaleDateString():null,R=a.discharge_date?new Date(a.discharge_date).toLocaleDateString():null;a.admission_date?a.admission_date&&!a.discharge_date?(U=`Patient admitted on: ${$}`,z=i.jsxs("div",{className:"space-y-4",children:[" ",b&&i.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Loading billing details..."})," ",u&&i.jsx("p",{className:"text-sm text-red-500 text-center",children:u})," ",!b&&h&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Total Due:"}),i.jsxs("span",{children:["",(Number(h.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[" ",i.jsx("span",{children:"Total Paid:"}),i.jsxs("span",{children:["",(Number(h.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm font-bold mt-1 text-red-600",children:[" ",i.jsx("span",{children:"Balance Due:"}),i.jsxs("span",{children:["",(Number(h.balance)||0).toFixed(2)]})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("button",{onClick:B,disabled:S||b||!o,className:`admission-button admission-button-secondary ${S||b||!o?"opacity-50 cursor-not-allowed":""}`,children:b?"Loading Bill...":!o&&!u?"Finding Bill...":"Pay Bill / View Details"}),i.jsx("button",{onClick:O,disabled:S||b,className:`admission-button admission-button-danger ${S||b?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Discharge Patient"})]})]})):(U=`Patient admitted on ${$} and discharged on ${R}.`,z=i.jsx("p",{className:"text-center text-gray-600 italic",children:"Patient has been discharged."})):(U="Patient is not admitted.",z=i.jsx("button",{onClick:F,disabled:S,className:`admission-button ${S?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Admit Patient"}))}return i.jsxs("div",{className:"admission-page-container",children:[i.jsxs("div",{className:"admission-header-container",children:[i.jsxs("button",{onClick:()=>P(-1),className:"back-button",children:[i.jsx(Ht,{size:16}),"Back"]}),i.jsx("h1",{className:"admission-header",children:"Manage Admission/Discharge"})]}),i.jsxs("div",{className:"admission-section mb-6 relative",children:[i.jsx("label",{htmlFor:"patientSearch",className:"admission-label",children:"Search Patient (Name, Phone, or Token)"}),i.jsx("input",{type:"text",id:"patientSearch",value:e,onChange:$=>n($.target.value),placeholder:"Start typing to search...",className:"admission-input"}),S&&!a&&i.jsx("div",{className:"absolute right-3 top-9 text-sm text-gray-500",children:"Loading..."})," ",t.length>0&&!a&&i.jsxs("ul",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[" ",t.map($=>i.jsxs("li",{onClick:()=>V($),className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",children:[" ",$.name," (Token: ",$.token,")",i.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[$.admission_date?`Admitted: ${new Date($.admission_date).toLocaleDateString()}`:"Not Admitted",$.discharge_date?`, Discharged: ${new Date($.discharge_date).toLocaleDateString()}`:""]})]},$.id))]}),t.length===0&&e&&!S&&!a&&i.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg p-4 text-gray-500",children:['No patients found matching "',e,'".']})]}),a&&i.jsxs("div",{className:"admission-section",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"admission-section-title",children:"Selected Patient"}),i.jsx("button",{onClick:()=>l(null),className:"admission-link",children:"Clear Selection"})]}),i.jsxs("div",{className:"admission-card-content mb-4 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",a.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Token:"})," ",a.token]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Age:"})," ",a.age??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Gender:"})," ",a.gender??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Phone:"})," ",a.phone??"N/A"]}),i.jsxs("p",{className:"col-span-2",children:[i.jsx("strong",{children:"Address:"})," ",a.address??"N/A"]})]}),i.jsx("hr",{className:"my-4"}),i.jsx("p",{className:"text-sm text-gray-600 mb-3",children:U})," ",T&&i.jsx("p",{className:"text-red-500 text-sm mb-3",children:T})," ",z]})]})},s0=15,f1=()=>{const e=wt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[l,o]=w.useState(null),[f,u]=w.useState(""),[d,h]=w.useState(1),[g,b]=w.useState(1),[v,S]=w.useState(0),[k,T]=w.useState("created_at"),[E,P]=w.useState("desc"),[I,V]=w.useState(""),[F,O]=w.useState(!1),[B,U]=w.useState(null),[z,$]=w.useState([]),[R,H]=w.useState(""),[ee,Z]=w.useState(!1),[te,Q]=w.useState(null),[q,W]=w.useState(null),[ne,A]=w.useState(!0),[ie,se]=w.useState(null),[M,ce]=w.useState(f);w.useEffect(()=>{const he=setTimeout(()=>{ce(f),h(1)},500);return()=>{clearTimeout(he)}},[f]);const ve=w.useCallback(async()=>{A(!0),se(null);try{const he=await fe("/api/subscriptions");if(!he.ok){let we=`Failed to fetch subscription plans (${he.status})`;try{we=(await he.json()).message||we}catch{}throw new Error(we)}const Ae=await he.json();$(Ae)}catch(he){console.error("Error fetching subscription plans:",he),se(he.message||"An unknown error occurred while fetching plans."),$([])}finally{A(!1)}},[]),le=w.useCallback(async(he,Ae,we,Me,De)=>{a(!0),o(null);try{const Je=new URLSearchParams({page:he.toString(),limit:s0.toString(),sortBy:we,sortOrder:Me});Ae&&Je.append("search",Ae),De&&Je.append("gender",De);const nt=await fe(`/api/patients?${Je.toString()}`);if(!nt.ok){const St=await nt.json();throw new Error(St.message||"Failed to fetch patients")}const Ge=await nt.json();t(Ge.patients),S(Ge.totalCount),h(Ge.currentPage),b(Ge.totalPages)}catch(Je){console.error("Error fetching patients:",Je),o(`Failed to load patients: ${Je.message}`),t([]),S(0),h(1),b(1)}finally{a(!1)}},[]);w.useEffect(()=>{le(d,M,k,E,I),ve()},[d,M,k,E,I,le,ve]);const xe=he=>{const Ae=k===he&&E==="asc"?"desc":"asc";T(he),P(Ae),h(1)},ue=he=>{try{return new Date(he).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},ze=()=>{O(!1),U(null),H(""),Q(null),Z(!1)},tt=async(he,Ae)=>{t(we=>we.map(Me=>Me.id===he?{...Me,insurance_type:Ae}:Me));try{const we=await fe(`/api/patients/${he}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:Ae})});if(!we.ok){const Me=await we.json();throw new Error(Me.message||"Failed to update insurance type")}}catch(we){console.error("Error updating insurance type:",we),le(d,M,k,E,I)}},ft=(he,Ae)=>{const we=new Date(he),Me=Ae.interval||1;switch(Ae.period){case"daily":we.setDate(he.getDate()+Me);break;case"weekly":we.setDate(he.getDate()+Me*7);break;case"monthly":we.setMonth(he.getMonth()+Me);break;case"yearly":we.setFullYear(he.getFullYear()+Me);break;default:console.warn(`Unknown subscription period: ${Ae.period}. Defaulting to 1 month.`),we.setMonth(he.getMonth()+1)}return we},Re=async()=>{if(!B||!R){Q("Please select a subscription plan.");return}const he=z.find(Ae=>Ae.id===R);if(!he){Q("Selected plan details not found.");return}Z(!0),Q(null);try{const Ae=new Date,we=ft(Ae,he),Me={subscription_plan_id:R,subscription_status:"active",subscription_start_date:Ae.toISOString(),subscription_end_date:we.toISOString(),subscription_payment_method:"manual"},De=await fe(`/api/patients/${B.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Me)});if(!De.ok){const Je=await De.json();throw new Error(Je.message||"Failed to update patient subscription")}ze(),le(d,M,k,E,I)}catch(Ae){console.error("Error starting subscription:",Ae),Q(`Failed to start subscription: ${Ae.message}`)}finally{Z(!1)}},je=async he=>{if(!q){W(he.id);try{const Ae=await fe(`/api/queue/patient/${he.id}/latest`);if(Ae.ok){const De=await Ae.json();if(De!=null&&De._id){e(`/dashboard/edit-complaint/${De._id}`,{state:{patientId:he.id}});return}}else if(Ae.status!==404){const De=await Ae.text();throw new Error(`Failed to fetch queue entry: ${De||Ae.statusText}`)}const we=await fe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:he.id})});if(!we.ok){const De=await we.text();throw new Error(`Failed to create queue entry: ${De||we.statusText}`)}const Me=await we.json();if(Me!=null&&Me.id)e(`/dashboard/edit-complaint/${Me.id}`,{state:{patientId:he.id}});else throw new Error("Failed to get ID from new queue entry.")}catch(Ae){console.error("Error processing patient selection:",Ae),alert(Ae.message||"An error occurred while processing the selection.")}finally{W(null)}}};return i.jsxs("div",{className:"all-patients-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(Ht,{size:16}),"Back"]}),i.jsxs("h1",{className:"all-patients-title",children:[i.jsx(Ys,{size:28}),"All Registered Patients"]}),l&&i.jsxs("div",{className:"error-alert",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:l})]}),i.jsxs("div",{className:"subscription-plans-card",children:[i.jsx("h2",{className:"subscription-plans-title",children:"Available Subscription Plans"}),i.jsx("div",{children:ne?i.jsx("p",{className:"loading-state",children:"Loading plans..."}):ie?i.jsxs("p",{className:"error-message",children:["Error loading plans: ",ie]}):z.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("ul",{className:"subscription-plans-list",children:z.map(he=>i.jsxs("li",{children:[i.jsx("strong",{children:he.name}),": ",he.price," / ",he.interval," ",he.period,he.interval>1?"s":"",he.description&&i.jsx("span",{className:"plan-description",children:he.description})]},he.id))})})]}),i.jsxs("div",{className:"controls-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by name or phone...",className:"search-input",value:f,onChange:he=>u(he.target.value)}),i.jsx(vi,{className:"search-input-icon",size:20})]}),i.jsxs("div",{className:"filter-dropdown-wrapper",children:[i.jsx("label",{htmlFor:"genderFilter",className:"sr-only",children:"Filter by Gender"}),i.jsxs("div",{className:"filter-select-container",children:[i.jsx(A_,{size:16,className:"filter-select-icon"}),i.jsxs("select",{id:"genderFilter",value:I,onChange:he=>V(he.target.value),className:"filter-select",children:[i.jsx("option",{value:"",children:"All Genders"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]})]})]}),r?i.jsx("div",{className:"loading-state",children:"Loading patients..."}):n.length===0?i.jsx("div",{className:"empty-state",children:M?"No patients found matching your search.":"No patients registered yet."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"patients-table-wrapper",children:i.jsxs("table",{className:"patients-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Token"}),i.jsxs("th",{className:"sortable-header",onClick:()=>xe("name"),children:["Name",k==="name"&&(E==="asc"?i.jsx(Lo,{size:14,className:"sort-icon"}):i.jsx(Wc,{size:14,className:"sort-icon"}))]}),i.jsx("th",{children:"Age"}),i.jsx("th",{children:"Gender"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Address"}),i.jsxs("th",{className:"sortable-header",onClick:()=>xe("created_at"),children:["Registered On",k==="created_at"&&(E==="asc"?i.jsx(Lo,{size:14,className:"sort-icon"}):i.jsx(Wc,{size:14,className:"sort-icon"}))]}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Insurance Type"})," ",i.jsx("th",{children:"Action"})," "]})}),i.jsx("tbody",{children:n.map(he=>i.jsxs("tr",{onClick:()=>je(he),className:`patient-row ${q===he.id?"navigating":""}`,style:{cursor:"pointer",opacity:q===he.id?.7:1},children:[i.jsx("td",{children:he.token??"-"}),i.jsx("td",{className:"patient-name",children:he.name}),i.jsx("td",{children:he.age??"-"}),i.jsx("td",{children:he.gender??"-"}),i.jsx("td",{children:he.phone??"-"}),i.jsx("td",{children:he.address??"-"}),i.jsx("td",{children:ue(he.created_at)}),i.jsx("td",{children:i.jsx("span",{className:`status-badge ${he.subscription_status==="active"?"active":he.subscription_status==="cancelled"||he.subscription_status==="expired"?"inactive":"none"}`,children:he.subscription_status??"None"})}),i.jsx("td",{children:i.jsxs("select",{value:he.insurance_type,onChange:Ae=>tt(he.id,Ae.target.value),onClick:Ae=>Ae.stopPropagation(),className:"form-select insurance-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"insurance",children:"Insurance"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})}),i.jsx("td",{children:i.jsx("button",{onClick:Ae=>{Ae.stopPropagation(),e(`/start-subscription/${he.id}`)},className:"action-button",children:"Start Sub"})})]},he.id))})]})}),g>1&&i.jsxs("div",{className:"pagination-controls",children:[i.jsxs("div",{className:"pagination-info",children:["Showing"," ",i.jsx("span",{className:"font-medium",children:(d-1)*s0+1})," ","to"," ",i.jsx("span",{className:"font-medium",children:Math.min(d*s0,v)})," ","of"," ",i.jsx("span",{className:"font-medium",children:v})," results"]}),i.jsxs("div",{className:"pagination-buttons",children:[i.jsxs("button",{onClick:()=>h(he=>Math.max(he-1,1)),disabled:d===1||r,className:"pagination-button",children:[i.jsx(Cb,{size:16,className:"prev-icon"}),"Previous"]}),i.jsxs("span",{className:"pagination-current-page",children:["Page ",i.jsx("span",{className:"font-medium",children:d})," of ",i.jsx("span",{className:"font-medium",children:g})]}),i.jsxs("button",{onClick:()=>h(he=>Math.min(he+1,g)),disabled:d===g||r,className:"pagination-button",children:["Next",i.jsx(ug,{size:16,className:"next-icon"})]})]})]})]}),F&&B&&i.jsx("div",{className:"subscription-modal-overlay",children:i.jsxs("div",{className:"subscription-modal-content",children:[i.jsxs("div",{className:"subscription-modal-header",children:[i.jsxs("h2",{className:"subscription-modal-title",children:["Start Subscription for ",B.name]}),i.jsx("button",{onClick:ze,className:"subscription-modal-close-button",children:i.jsx(Kn,{size:24})})]}),te&&i.jsx("div",{className:"error-alert",role:"alert",children:i.jsx("span",{children:te})}),i.jsxs("div",{className:"subscription-modal-body",children:[i.jsx("label",{htmlFor:"subscriptionPlan",className:"form-label",children:"Select Plan:"}),i.jsxs("select",{id:"subscriptionPlan",value:R,onChange:he=>H(he.target.value),className:"form-select",disabled:ee||ne||ie!==null||z.length===0,children:[i.jsx("option",{value:"",disabled:!0,children:"-- Select a Plan --"}),ne?i.jsx("option",{value:"",disabled:!0,children:"Loading plans..."}):ie?i.jsx("option",{value:"",disabled:!0,children:"Error loading plans"}):z.length>0?z.map(he=>i.jsxs("option",{value:he.id,children:[he.name," - ",he.price," (",he.interval," ",he.period,he.interval>1?"s":"",")"]},he.id)):i.jsx("option",{value:"",disabled:!0,children:"No active plans found"})]}),ie&&i.jsx("p",{className:"error-message",children:ie}),z.length===0&&!ne&&!ie&&i.jsx("p",{className:"empty-state",children:"No active subscription plans available."})]}),i.jsxs("div",{className:"subscription-modal-footer",children:[i.jsx("button",{onClick:ze,disabled:ee,className:"subscription-modal-button cancel",children:"Cancel"}),i.jsx("button",{onClick:Re,disabled:!R||ee,className:"subscription-modal-button submit",children:ee?"Starting...":"Start Subscription"})]})]})})]})},lk=()=>{const e=wt(),[n]=w.useState(!0),[t,r]=w.useState(""),[a,l]=w.useState([]),[o,f]=w.useState(!1),[u,d]=w.useState(null),[h,g]=w.useState(!1),b=/^\+?[0-9\s\-().]{7,20}$/,v=w.useMemo(()=>kb(async E=>{if(E.trim().length<2){l([]),f(!1),d(null);return}f(!0),d(null);try{const P=new URLSearchParams({search:encodeURIComponent(E),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),I=await fe(`/api/patients?${P.toString()}`);if(!I.ok){const F=await I.text();throw new Error(`API Error (${I.status}): ${F||I.statusText}`)}const V=await I.json();l(V.patients)}catch(P){console.error("Error searching patients:",P),d(P.message||"Failed to search patients."),l([])}finally{f(!1)}},300),[]),S=E=>{const P=E.target.value;r(P),g(b.test(P)),f(!0),v(P)},k=w.useCallback(E=>{e("/billing",{state:{patientId:E.id,patientName:E.name}})},[e]),T=w.useCallback(async()=>{if(!t||!h){d("Invalid phone number to create a new patient.");return}f(!0),d(null);try{const P=await fe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"direct pharmacy",phone:t,age:null,gender:null,token:null})});if(!P.ok){const V=await P.json();throw new Error(V.message||`Failed to create patient: ${P.statusText}`)}const I=await P.json();alert(`New patient "direct pharmacy" created with phone ${I.phone}.`),k(I)}catch(E){console.error("Error creating new patient:",E),d(E.message||"Failed to create new patient.")}finally{f(!1)}},[t,h,k]);return i.jsxs("div",{className:"create-custom-bill-page p-4 md:p-6 max-w-5xl mx-auto",children:[i.jsx("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:i.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:i.jsx(Ht,{size:20})}),i.jsx("h2",{className:"text-2xl",children:"Create Custom Bill"})]})}),n&&i.jsxs("div",{className:"content-section",children:[i.jsx("h3",{className:"section-title",children:"Select Patient"}),i.jsxs("div",{className:"mb-3 relative",children:[i.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"}),i.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:t,onChange:S,className:"custom-text-input mt-1",autoFocus:!0}),o&&i.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),u&&i.jsx("div",{className:"ai-function-status error mb-3 p-3",children:u}),a.length>0&&i.jsx("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:i.jsx("ul",{children:a.map(E=>i.jsxs("li",{onClick:()=>k({id:E.id,name:E.name,token:E.token,age:E.age,gender:E.gender,phone:E.phone}),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[i.jsxs("div",{className:"font-medium",children:[i.jsxs("span",{className:"patient-token mr-2",children:["#",E.token]}),E.name]}),i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[E.age?`${E.age} yrs`:"Age N/A",E.gender?` / ${E.gender}`:" / Gender N/A",E.phone&&i.jsxs("span",{className:"hidden sm:inline",children:[" / ",E.phone]})]})]}),E.phone&&i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",E.phone]})]},E.id))})}),t.length>=2&&!o&&a.length===0&&!u&&i.jsxs(i.Fragment,{children:[i.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',t,'".']}),h&&i.jsx("button",{type:"button",onClick:T,className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:o,children:'Create "direct pharmacy" Patient with this Phone'})]}),t.length<2&&!o&&i.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]})]})},ok=({currentUser:e})=>{const n=wt(),[t,r]=w.useState("select_patient"),[a,l]=w.useState({name:"",age:void 0,gender:null,phone:"",address:""}),[o,f]=w.useState(null),[u,d]=w.useState([]),[h,g]=w.useState([]),[b,v]=w.useState(""),[S,k]=w.useState([]),[T,E]=w.useState(""),[P,I]=w.useState([]),[V,F]=w.useState(!1),[O,B]=w.useState(null),[U,z]=w.useState(null),[$,R]=w.useState(null),[H,ee]=w.useState(!1),[Z,te]=w.useState(!1),[Q,q]=w.useState(!1),W=/^\+?[0-9\s\-().]{7,20}$/,ne=/^[a-zA-Z\s'-]{2,}$/,A=w.useCallback(async()=>{if(!(u.length>0)){ee(!0),R(null);try{const je=await fe("/api/lab-tests");if(!je.ok)throw new Error("Failed to fetch lab tests");const he=await je.json();d(he)}catch(je){console.error("Failed to fetch available lab tests:",je),R("Could not load lab test list: "+je.message),d([])}finally{ee(!1)}}},[u.length]);w.useEffect(()=>{if(!b){k([]);return}const je=b.toLowerCase();k(u.filter(he=>he.name.toLowerCase().includes(je)||he.description&&he.description.toLowerCase().includes(je)).slice(0,10))},[b,u]);const ie=w.useCallback(je=>{const he={id:je.id,name:je.name,token:je.token,age:je.age,gender:je.gender,phone:je.phone};f(he),r("create_order"),g([]),v(""),k([]),R(null),A()},[A]),se=w.useMemo(()=>kb(async je=>{if(je.trim().length<2){I([]),F(!1),B(null);return}F(!0),B(null);try{const he=new URLSearchParams({search:encodeURIComponent(je),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Ae=await fe(`/api/patients?${he.toString()}`);if(!Ae.ok){const Me=await Ae.text();throw new Error(`API Error (${Ae.status}): ${Me||Ae.statusText}`)}const we=await Ae.json();I(we.patients)}catch(he){console.error("Error searching lab patients:",he),B(he.message||"Failed to search lab patients."),I([])}finally{F(!1)}},300),[W,ne]),M=je=>{const he=je.target.value;E(he),te(W.test(he)),q(ne.test(he)&&!W.test(he)),F(!0),se(he)},ce=w.useCallback(async je=>{if(!T||je==="phone"&&!Z||je==="name"&&!Q){B(`Invalid ${je} to create a new patient.`);return}F(!0),B(null);try{const we=await(await fe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:je==="name"?T:"direct lab",phone:je==="phone"?T:null,age:null,gender:null,token:null})})).json();alert(`New patient "${we.name}" created with ${je==="phone"?`phone ${we.phone}`:`name ${we.name}`}.`),ie({id:we.id,name:we.name,token:we.token??null,age:we.age??null,gender:we.gender??null,phone:we.phone})}catch(he){console.error("Error creating new patient:",he);const Ae=he.message||"";if(Ae.toLowerCase().includes("patient limit")){n("/start-clinic-subscription",{state:{errorMessage:Ae}});return}B(Ae||"Failed to create new patient.")}finally{F(!1)}},[T,Z,Q,ie]),ve=()=>{l({name:"",age:void 0,gender:null,phone:"",address:""}),z(null),r("create_patient"),f(null)},le=()=>{r("select_patient"),f(null),E(""),I([]),B(null)},xe=je=>{const{name:he,value:Ae}=je.target;l(we=>({...we,[he]:he==="age"?Ae?parseInt(Ae,10):void 0:Ae}))},ue=async je=>{if(je.preventDefault(),z(null),!a.name){z("Patient Name is required.");return}const he={name:a.name,age:a.age,gender:a.gender,phone:a.phone,address:a.address};try{const we=await(await fe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(he)})).json();ie({id:we.id,name:we.name,token:we.token??null,age:we.age??null,gender:we.gender??null,phone:we.phone})}catch(Ae){console.error("Failed to create patient:",Ae);const we=Ae.message||"";if(we.toLowerCase().includes("patient limit")){n("/start-clinic-subscription",{state:{errorMessage:we}});return}z(we||"Failed to create patient. Please try again.")}},ze=je=>{if(h.some(he=>he.id===je.id)){R(`${je.name} is already in the order.`),setTimeout(()=>R(null),3e3),v(""),k([]);return}g(he=>[...he,{...je}]),v(""),k([])},tt=je=>{g(he=>he.filter(Ae=>Ae.id!==je))},ft=async je=>{if(je.preventDefault(),R(null),!o){R("No patient selected.");return}if(h.length===0){R("No lab tests selected.");return}const he={patient_id:o.id,tests:h.map(Ae=>({id:Ae.id,name:Ae.name,price:Ae.price}))};try{const Ae=await fe("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(he)});if(!Ae.ok){const Me=await Ae.json();throw new Error(Me.message||`Failed to create lab order: ${Ae.statusText}`)}await Ae.json();let we=o.queueId;if(!we){const Me=await fe(`/api/queue/patient/${o.id}/latest`);if(Me.ok){const De=await Me.json();De!=null&&De._id&&(we=De._id)}}if(!we){const Me=await fe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:o.id})});if(!Me.ok){const Je=await Me.text();throw new Error(`Failed to create queue entry for redirection: ${Je||Me.statusText}`)}const De=await Me.json();De!=null&&De.id&&(we=De.id)}alert(`Lab order created successfully for ${o.name}!`),(e==null?void 0:e.role)==="lab"?n("/dashboard"):n(`/dashboard/edit-complaint/${we}`,{state:{patientId:o.id}})}catch(Ae){console.error("Failed to create lab order:",Ae),R(Ae.message||"Failed to create lab order.")}};w.useEffect(()=>{A()},[A]);const Re=()=>h.reduce((je,he)=>je+parseFloat(he.price),0).toFixed(2);return i.jsxs("div",{className:"create-lab-order-page",children:[i.jsxs("div",{className:"page-header",children:[i.jsx("button",{onClick:()=>n(-1),className:"back-button","aria-label":"Go back",children:i.jsx(Ht,{size:20})}),i.jsx("h1",{children:"Create New Lab Order"}),i.jsx("div",{className:"w-10"})," "]}),(t==="select_patient"||t==="create_patient")&&i.jsxs("div",{className:"patient-selection-container",children:[t==="select_patient"&&i.jsxs("div",{className:"content-panel",children:[i.jsx("h2",{className:"section-title",style:{justifyContent:"center"},children:"Select Patient"}),i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(vi,{className:"search-icon",size:20}),i.jsx("input",{type:"text",placeholder:"Search by Name, Token, or Phone...",value:T,onChange:M,className:"custom-text-input",autoFocus:!0})]}),V&&i.jsx("div",{className:"loading-text",style:{marginTop:"1rem"},children:"detail..."}),O&&i.jsx("div",{className:"error-text",children:O}),P.length>0&&i.jsx("div",{className:"search-results-dropdown",style:{position:"relative",boxShadow:"none",borderTop:"none",maxHeight:"40vh"},children:P.map(je=>i.jsxs("div",{onClick:()=>ie(je),className:"search-result-item",children:[i.jsxs("div",{children:[je.token&&i.jsxs("span",{className:"token-badge",children:["#",je.token]}),i.jsx("span",{style:{fontWeight:500},children:je.name})]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"var(--text-secondary)"},children:[je.age?`${je.age}y`:"",je.gender?` / ${je.gender}`:"",je.phone?` / ${je.phone}`:""]})]},je.id))}),T.length>=2&&!V&&P.length===0&&!O&&i.jsxs("div",{style:{marginTop:"1.5rem"},children:[i.jsxs("p",{className:"no-data",children:['No patients found matching "',T,'".']}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px",marginTop:"10px"},children:[Z&&i.jsxs("button",{type:"button",onClick:()=>ce("phone"),className:"btn-primary",children:["Create Patient with Phone ",T]}),Q&&i.jsxs("button",{type:"button",onClick:()=>ce("name"),className:"btn-primary",children:['Create Patient with Name "',T,'"']})]})]}),i.jsx("div",{className:"or-divider",children:"OR"}),i.jsxs("button",{onClick:ve,className:"btn-secondary",style:{width:"100%"},children:[i.jsx(Gl,{size:18,style:{marginRight:"8px",verticalAlign:"text-bottom"}}),"Register New Patient manually"]})]}),t==="create_patient"&&i.jsxs("div",{className:"content-panel",children:[i.jsxs("div",{className:"section-title",style:{justifyContent:"space-between"},children:[i.jsx("span",{children:"Register New Patient"}),i.jsx("button",{onClick:le,className:"action-link-btn",children:"Back to Search"})]}),U&&i.jsx("div",{className:"error-text",children:U}),i.jsxs("form",{onSubmit:ue,children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[i.jsx("label",{htmlFor:"lab-patient-name",children:"Name *"}),i.jsx("input",{type:"text",name:"name",id:"lab-patient-name",required:!0,value:a.name,onChange:xe,className:"form-input",placeholder:"Patient Full Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lab-patient-age",children:"Age"}),i.jsx("input",{type:"number",name:"age",id:"lab-patient-age",value:a.age??"",onChange:xe,className:"form-input",placeholder:"Age"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lab-patient-gender",children:"Gender"}),i.jsxs("select",{name:"gender",id:"lab-patient-gender",value:a.gender??"",onChange:xe,className:"form-select",children:[i.jsx("option",{value:"",children:"Select..."})," ",i.jsx("option",{value:"M",children:"Male"})," ",i.jsx("option",{value:"F",children:"Female"})," ",i.jsx("option",{value:"O",children:"Other"})]})]}),i.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[i.jsx("label",{htmlFor:"lab-patient-phone",children:"Phone"}),i.jsx("input",{type:"tel",name:"phone",id:"lab-patient-phone",value:a.phone||"",onChange:xe,className:"form-input",placeholder:"Phone Number"})]}),i.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[i.jsx("label",{htmlFor:"lab-patient-address",children:"Address"}),i.jsx("textarea",{name:"address",id:"lab-patient-address",rows:2,value:a.address||"",onChange:xe,className:"form-textarea",placeholder:"Address (Optional)"})]})]}),i.jsxs("div",{style:{marginTop:"2rem",display:"flex",justifyContent:"flex-end",gap:"1rem"},children:[i.jsx("button",{type:"button",onClick:le,className:"btn-secondary",children:" Cancel "}),i.jsx("button",{type:"submit",className:"btn-primary",children:" Create & Proceed "})]})]})]})]}),t==="create_order"&&o&&i.jsxs("div",{className:"lab-order-grid",children:[i.jsx("div",{className:"left-column",children:i.jsxs("div",{className:"content-panel",children:[i.jsx("h2",{className:"section-title",children:"Add Lab Tests"}),i.jsxs("div",{className:"search-input-wrapper",style:{marginBottom:"1.5rem"},children:[i.jsx(vi,{className:"search-icon",size:20}),i.jsx("input",{type:"text",placeholder:"Search available lab tests...",value:b,onChange:je=>v(je.target.value),className:"custom-text-input",disabled:H,autoFocus:!0}),H&&i.jsx("span",{style:{position:"absolute",right:"15px",fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Loading..."}),b&&S.length>0&&i.jsx("div",{className:"search-results-dropdown",children:S.map(je=>i.jsxs("div",{onClick:()=>ze(je),className:"search-result-item",children:[i.jsx("span",{children:je.name}),i.jsxs("span",{style:{fontWeight:600,color:"var(--primary-color)"},children:["",parseFloat(je.price).toFixed(2)]})]},je.id))}),b&&S.length===0&&!H&&i.jsx("div",{className:"search-results-dropdown",style:{padding:"1rem",color:"var(--text-secondary)",textAlign:"center"},children:"No tests found."})]}),$&&i.jsxs("div",{className:"error-text",style:{display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx(si,{size:18})," ",$]}),i.jsx("div",{className:"order-table-container",children:i.jsxs("table",{className:"order-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Test Name"}),i.jsx("th",{style:{width:"100px",textAlign:"right"},children:"Price"}),i.jsx("th",{style:{width:"60px",textAlign:"center"},children:"Action"})]})}),i.jsx("tbody",{children:h.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"no-data",children:"No tests added yet. Search above to add."})}):h.map(je=>i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("span",{style:{fontWeight:500},children:je.name})}),i.jsxs("td",{style:{textAlign:"right",fontWeight:600},children:["",parseFloat(je.price).toFixed(2)]}),i.jsx("td",{style:{textAlign:"center"},children:i.jsx("button",{type:"button",onClick:()=>tt(je.id),className:"delete-btn",title:"Remove",children:i.jsx(Oi,{size:16})})})]},je.id))})]})})]})}),i.jsxs("div",{className:"right-column",children:[i.jsxs("div",{className:"patient-card",children:[i.jsx("div",{className:"patient-avatar",children:i.jsx(Ys,{size:32})}),i.jsx("h3",{className:"patient-name",children:o.name}),i.jsxs("div",{className:"patient-info-text",children:[o.age?`${o.age} yrs`:"",o.gender?`  ${o.gender}`:""]}),o.phone&&i.jsx("div",{className:"patient-info-text",style:{marginTop:"4px"},children:o.phone}),i.jsx("button",{onClick:le,className:"change-patient-btn",children:"Change Patient"})]}),i.jsxs("div",{className:"order-summary-container",children:[i.jsx("h3",{className:"section-title",style:{marginBottom:"1rem"},children:"Order Summary"}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Tests"}),i.jsx("span",{children:h.length})]}),i.jsxs("div",{className:"summary-total",children:[i.jsx("span",{className:"total-label",children:"Total Amount"}),i.jsxs("span",{className:"total-value",children:["",Re()]})]}),i.jsx("button",{onClick:ft,disabled:h.length===0,className:"create-order-btn",children:"Confirm Order"}),i.jsx("button",{type:"button",onClick:()=>n(-1),className:"btn-secondary",style:{width:"100%",marginTop:"1rem",border:"none",color:"var(--text-secondary)"},children:"Cancel"})]})]})]})]})},gU=({currentUser:e})=>{const[n,t]=w.useState("newtons-ai"),[r,a]=w.useState(""),[l,o]=w.useState([]),[f,u]=w.useState(!0),[d,h]=w.useState([]),[g,b]=w.useState(!1),[v,S]=w.useState(null),[k,T]=w.useState(null),E=wt(),P=async()=>{u(!0),T(null);let z=[];try{const $=await fe("/api/queue");if(!$.ok){const ee=await $.json();throw new Error(ee.message||"Failed to fetch queue")}z=await $.json(),console.log("Fetched Initial Queue Data:",JSON.stringify(z,null,2));const R=z.map(async ee=>{if(!ee.patient_id)return console.warn(`Queue entry ${ee.id} has no patient_id.`),ee;try{const Z=await fe(`/api/patients/${ee.patient_id}`);if(!Z.ok)return console.error(`Failed to fetch patient details for ${ee.patient_id}: ${Z.status}`),ee;const te=await Z.json();return{...ee,Patient:{...ee.Patient??{},...te}}}catch(Z){return console.error(`Error fetching patient details for ${ee.patient_id}:`,Z),ee}}),H=await Promise.all(R);console.log("Enriched Queue Data (Before Sort):",JSON.stringify(H,null,2)),H.sort((ee,Z)=>{var ne,A;const te=((ne=ee.Patient)==null?void 0:ne.subscription_status)==="active",Q=((A=Z.Patient)==null?void 0:A.subscription_status)==="active";if(te&&!Q)return-1;if(!te&&Q)return 1;const q=ee.created_at?new Date(ee.created_at).getTime():0,W=Z.created_at?new Date(Z.created_at).getTime():0;return q-W}),console.log("Sorted Queue Data:",JSON.stringify(H,null,2)),o(H)}catch($){console.error("Error in fetchQueue process:",$),T(`Failed to load queue: ${$.message}`),o(z)}finally{u(!1)}},I=async()=>{b(!0),T(null);try{const z=await fe("/api/staff?role=doctor");if(!z.ok){const R=await z.json();throw new Error(R.message||"Failed to fetch doctors")}const $=await z.json();h($.filter(R=>R.active))}catch(z){console.error("Error fetching doctors:",z),T(`Failed to fetch doctors: ${z.message}`)}finally{b(!1)}};w.useEffect(()=>{n==="queue"&&(P(),I()),S(null)},[n]);const V=w.useCallback(async(z,$)=>{if(console.log(`Attempting to assign doctor ${$} to queue ${z}`),T(null),S(null),!$){console.log("No doctor ID provided, skipping assignment.");return}const R=l.find(Z=>Z.id===z);if(!R){console.error(`Queue entry ${z} not found in local state.`),T("Queue entry not found.");return}if(R.doctor_id===$){console.log(`Queue ${z} already assigned to doctor ${$}. Skipping.`);return}const H=async Z=>{if(!Z||!Z.id||!Z.name){T("Cannot proceed: Patient ID or Name is missing."),console.error("assignAndNavigate called with invalid patientInfo",Z);return}const te=async()=>{try{const Q={status:"waiting",doctorId:$},q=await fe(`/api/queue/${z}/status`,{method:"PATCH",body:JSON.stringify(Q)}),W=await q.json();if(!q.ok)throw new Error(W.message||`HTTP error! status: ${q.status}`);const ne=d.find(A=>A.id===$);return console.log(`Successfully assigned doctor ${ne==null?void 0:ne.name} to queue ${z}.`),o(A=>A.map(ie=>ie.id===z?{...ie,doctor_id:$,status:W.status||ie.status,User:ne?{name:ne.name}:null,Patient:Z}:ie)),!0}catch(Q){return console.error(`Error assigning doctor for queue ${z}:`,Q),T(`Failed to assign doctor: ${Q.message}`),!1}};Z.subscription_status==="active"?(console.log(`Patient ${Z.name} (ID: ${Z.id}) has active subscription. Assigning doctor directly.`),await te()):(console.log(`Patient ${Z.name} (ID: ${Z.id}) does not have active subscription (Status: ${Z.subscription_status}). Assigning doctor and proceeding to billing.`),await te()?(console.log(`Navigating to billing for patient ${Z.name} (ID: ${Z.id}), queue ID: ${z}, doctor ID: ${$}`),E("/billing",{state:{patientId:Z.id,queueId:z,patientName:Z.name,doctorId:$,billType:"consultation"}})):console.log(`Assignment failed for patient ${Z.name}, skipping navigation.`))},ee=R.Patient;if(ee&&ee.id&&ee.name)console.log("Patient details found in state. Proceeding with assignment."),await H(ee);else{console.warn(`Patient details missing for queue entry ${z}. Fetching patient ${R.patient_id}...`);try{const Z=await fe(`/api/patients/${R.patient_id}`);if(!Z.ok){const Q=await Z.json().catch(()=>({}));throw new Error(Q.message||`Failed to fetch patient details (status ${Z.status})`)}const te=await Z.json();console.log("Successfully fetched patient details:",te),await H(te)}catch(Z){console.error(`Failed to fetch patient details for patient ID ${R.patient_id}:`,Z),T(`Failed to fetch required patient details: ${Z.message}`)}}},[d,l,E]),F=async(z,$)=>{T(null);const R=$==="consulting"?"start consultation":"complete visit";try{const H=l.find(Q=>Q.id===z);if(!H&&$==="consulting")throw new Error("Queue entry not found to start consultation.");let ee={status:$};if($==="consulting"){if(!(H!=null&&H.doctor_id))throw new Error("Cannot start consultation without an assigned doctor.");ee.doctorId=H.doctor_id}const Z=await fe(`/api/queue/${z}/status`,{method:"PATCH",body:JSON.stringify(ee)}),te=await Z.json();if(!Z.ok)throw new Error(te.message||`HTTP error! status: ${Z.status}`);o(Q=>Q.map(q=>q.id===z?{...q,status:$}:q))}catch(H){console.error(`Error trying to ${R}:`,H),T(`Failed to ${R}: ${H.message}`)}},O=[{id:"queue",label:"Queue",icon:i.jsx(zh,{size:20})},{id:"newtons-ai",label:"Newtons AI",icon:i.jsx(vi,{size:20})},{id:"manage-admission",label:"Manage Admission",icon:i.jsx(xP,{size:20})},{id:"all-patients",label:"All Patients",icon:i.jsx(fI,{size:20})},{id:"lab",label:"Lab Tests",icon:i.jsx(k_,{size:20})},{id:"custom-bill",label:"Custom Bill",icon:i.jsx(Fo,{size:20})}],B=z=>{try{return new Date(z).toLocaleTimeString("en-IN",{hour:"numeric",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},U=l.filter(z=>{var $,R;return(R=($=z.Patient)==null?void 0:$.name)==null?void 0:R.toLowerCase().includes(r.toLowerCase())});return i.jsx("div",{className:"reception-dashboard-container",children:i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[k&&i.jsxs("div",{className:"error-message-reception",role:"alert",children:[" ",i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:k})]}),i.jsxs("div",{className:"reception-tab-nav",children:[" ",O.map(z=>i.jsxs("button",{className:`reception-tab-button ${n===z.id?"active":""}`,onClick:()=>t(z.id),children:[i.jsx("span",{children:z.icon}),z.label]},z.id))]}),n==="queue"&&i.jsxs("div",{className:"space-y-6",children:[" ",i.jsxs("div",{className:"queue-header",children:[" ",i.jsxs("div",{className:"queue-actions",children:[" ",i.jsxs("div",{className:"search-bar-container",children:[" ",i.jsx("input",{type:"text",placeholder:"Search patients in queue...",className:"search-input",value:r,onChange:z=>a(z.target.value)}),i.jsx(vi,{className:"search-icon",size:18})]})]}),i.jsxs("div",{className:"summary-cards-grid",children:[" ",i.jsxs("div",{className:"summary-card card-waiting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Waiting"})," ",i.jsx("div",{className:"summary-card-value",children:l.filter(z=>z.status==="waiting").length})," "]}),i.jsxs("div",{className:"summary-card card-consulting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Consulting"})," ",i.jsx("div",{className:"summary-card-value",children:l.filter(z=>z.status==="consulting").length})," "]}),i.jsxs("div",{className:"summary-card card-completed",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Completed"})," ",i.jsx("div",{className:"summary-card-value",children:l.filter(z=>z.status==="seen").length})," "]})]})]}),f?i.jsxs("div",{className:"loading-container",children:[" ",i.jsx("div",{className:"breathing-ball"})," ",i.jsx("span",{children:"Loading queue..."})]}):U.length===0?i.jsx("div",{className:"empty-queue-message",children:r?"No patients found matching your search.":"Queue is empty."}):i.jsxs("div",{className:"queue-table-wrapper",children:[" ",i.jsxs("table",{className:"queue-table",children:[" ",i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Queue"}),i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Phone Number"}),i.jsx("th",{children:"Complaint"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{className:"hidden md:table-cell",children:"Time Added"})," ",i.jsx("th",{className:"text-center",children:"Action / Doctor"})," "]})}),i.jsx("tbody",{children:U.map(z=>{var $,R,H,ee,Z,te,Q,q,W,ne,A;return i.jsxs("tr",{onClick:()=>E(`/dashboard/edit-complaint/${z.id}`),className:"queue-row-clickable",children:[i.jsxs("td",{children:[" ",i.jsxs("span",{className:"queue-token",children:["#",z.token_no]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-name",children:(($=z.Patient)==null?void 0:$.name)||"N/A"})," ",i.jsxs("div",{className:"patient-details",children:[(R=z.Patient)!=null&&R.age?`${z.Patient.age} yrs, `:"",((H=z.Patient)==null?void 0:H.gender)||""]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-phone",children:((ee=z.Patient)==null?void 0:ee.phone)||"N/A"})," "]}),i.jsx("td",{className:"complaint-text",children:z.complaint||"-"}),i.jsxs("td",{children:[i.jsx("span",{className:`subscription-status-badge ${((Z=z.Patient)==null?void 0:Z.subscription_status)==="active"?"status-active":((te=z.Patient)==null?void 0:te.subscription_status)==="cancelled"||((Q=z.Patient)==null?void 0:Q.subscription_status)==="expired"?"status-inactive":"status-none"}`,children:((q=z.Patient)==null?void 0:q.subscription_status)??"None"}),z.Patient&&z.Patient.id&&z.Patient.subscription_status!=="active"&&i.jsx("button",{onClick:ie=>{ie.stopPropagation(),z.Patient&&E(`/start-subscription/${z.Patient.id}`)},className:"action-button btn-start-sub-queue mt-2",children:"Start Sub"})]}),i.jsx("td",{className:"hidden md:table-cell time-added",children:B(z.created_at)}),i.jsx("td",{className:"action-doctor-cell",children:v===z.id?i.jsx("div",{className:"relative inline-block text-left w-full",onClick:ie=>ie.stopPropagation(),children:i.jsxs("select",{value:"",onChange:ie=>V(z.id,ie.target.value),onBlur:()=>S(null),className:"doctor-select-dropdown",autoFocus:!0,children:[i.jsx("option",{value:"",disabled:!0,children:"Select Doctor..."}),g?i.jsx("option",{disabled:!0,children:"Loading..."}):d.length>0?d.map(ie=>i.jsx("option",{value:ie.id,children:ie.name},ie.id)):i.jsx("option",{disabled:!0,children:"No doctors available"})]})}):i.jsxs("div",{className:"action-doctor-content",onClick:ie=>ie.stopPropagation(),children:[" ",z.status==="waiting"&&i.jsx(i.Fragment,{children:(W=z.User)!=null&&W.name?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"doctor-name-display",children:z.User.name}),i.jsx("button",{onClick:()=>F(z.id,"consulting"),className:"action-button btn-start",children:"Start"})]}):g?i.jsx("span",{className:"status-text-italic",children:"Loading..."}):d.length===0?i.jsx("span",{className:"status-text-red",children:"No doctors"}):d.length===1?i.jsxs("button",{onClick:()=>V(z.id,d[0].id),className:"action-button btn-assign",children:["Assign ",d[0].name]}):i.jsx("button",{onClick:()=>S(z.id),className:"action-button btn-assign",children:"Assign"})}),z.status==="consulting"&&i.jsxs(i.Fragment,{children:[((ne=z.User)==null?void 0:ne.name)&&i.jsx("span",{className:"doctor-name-display",children:z.User.name}),i.jsx("button",{onClick:()=>F(z.id,"seen"),className:"action-button btn-complete",children:"Complete"})]}),z.status==="seen"&&i.jsxs(i.Fragment,{children:[((A=z.User)==null?void 0:A.name)&&i.jsx("span",{className:"doctor-name-display",children:z.User.name}),i.jsx("span",{className:"status-text-italic",children:"Completed"})]}),z.status==="cancelled"&&i.jsx("span",{className:"status-text-red",children:"Cancelled"})]})})]},z.id)})})]})]})]}),n==="lab"&&i.jsxs("div",{className:"lab-tab-content",children:[" ",i.jsx(ok,{currentUser:e}),i.jsxs("button",{onClick:()=>E("/lab/search-report"),className:"lab-action-button btn-search-lab-reports",children:[i.jsx(vi,{size:16}),"Search Lab Reports"]})]}),n==="newtons-ai"&&i.jsx("div",{className:"newtons-ai-tab-content",children:i.jsx(Dh,{})}),n==="manage-admission"&&i.jsx("div",{className:"manage-admission-tab-content",children:i.jsx(sk,{})}),n==="all-patients"&&i.jsx("div",{className:"all-patients-tab-content",children:i.jsx(f1,{})}),n==="custom-bill"&&i.jsx("div",{className:"custom-bill-tab-content",children:i.jsx(lk,{})})]})})},yU=e=>{let n="";if(!e.report_content)return"No report content available.";n+=`*Report Date:* ${e.report_date?new Date(e.report_date).toLocaleDateString():"N/A"}

`;try{const t=JSON.parse(e.report_content);typeof t=="object"&&t!==null&&e.tests?e.tests.forEach((r,a)=>{n+=`*Test: ${r.name}*
`,t[r.id]?Object.entries(t[r.id]).forEach(([l,o])=>{var h;const f=(h=r.default_parameters)==null?void 0:h.find(g=>g.name===l);let u=String(o),d="";if(f){const g=f.unit?` _${f.unit}_`:"";if(f.type==="boolean"){const b=o===!0||o==="true";u=b?"*Reactive*":"Non-Reactive",b||(d="`Normal: Non-Reactive`")}else if(f.type==="number"){const b=typeof o=="string"?parseFloat(o):typeof o=="number"?o:NaN;if(f.lower_limit!=null||f.upper_limit!=null){let v=[];f.lower_limit!=null&&v.push(`${f.lower_limit}`),f.upper_limit!=null&&v.push(`${f.upper_limit}`),d=`\`Normal: ${v.join(" - ")}\`${g}`,!isNaN(b)&&(f.lower_limit!=null&&b<f.lower_limit||f.upper_limit!=null&&b>f.upper_limit)&&(u=`*${u}*`)}}f.unit&&(u+=g)}n+=`${l}: ${u}
`,d&&((f==null?void 0:f.type)==="boolean"&&(o===!0||o==="true")||(n+=`${d}
`))}):n+=`_No parameters reported for this test._
`,a<e.tests.length-1&&(n+=`
`)}):n+=e.report_content}catch{n+=e.report_content}return n},yw=e=>{var o;if(!((o=e==null?void 0:e.Patient)!=null&&o.phone)){alert("Cannot share report via WhatsApp: Patient phone number is not available.");return}if(!(e!=null&&e.report_content)){alert("Cannot share report: No report content is available to share.");return}const n=e.Patient.name||"Patient",t=yU(e),r=`Hello ${n},

Your lab report is ready.

${t}`,l=`https://wa.me/${xU(e.Patient.phone)}?text=${encodeURIComponent(r)}`;window.open(l,"_blank")},xU=e=>{let n=e.replace(/\D/g,"");const t=/^(?:\\+?91)?[\\s-]*?(\\d{10})$/,r=n.match(t);return r?n="91"+r[1]:n.startsWith("91")||(n="91"+n),n},bU=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,l]=w.useState(!0),[o,f]=w.useState(null),[u,d]=w.useState("orders"),[h,g]=w.useState(1),[b]=w.useState(20),[v,S]=w.useState(0),k=w.useMemo(()=>Math.ceil(v/b),[v,b]),T=w.useCallback(async(U=1,z="")=>{l(!0),f(null);try{const $=new URLSearchParams({page:String(U),limit:String(b)});z&&$.append("search",z);const R=await fe(`/api/lab?${$.toString()}`);if(!R.ok)throw new Error(`HTTP error! status: ${R.status}`);const H=await R.json(),ee=H.orders.map(Z=>{var te,Q;return{id:Z.id,labTokenNumber:String(Z.lab_token_number??"N/A"),patientName:((te=Z.Patient)==null?void 0:te.name)||"N/A",patientId:Z.patient_id,patientTokenNumber:String(((Q=Z.Patient)==null?void 0:Q.patient_token_number)??"N/A"),tests:(Z.tests||[]).map(q=>q.name||"Unknown Test"),date:Bh(new Date(Z.createdAt),"yyyy-MM-dd"),status:Z.status,reportId:Z.reportId,billId:Z.billId}});n(ee),S(H.totalCount),g(U)}catch($){console.error("Failed to fetch lab orders:",$),f($ instanceof Error?$.message:"An unknown error occurred"),n([]),S(0)}finally{l(!1)}},[b]);w.useEffect(()=>{console.log(`Fetch effect triggered. Current page: ${h}, Search term: "${t}"`),t.length===0||t.length>=2?(console.log(`Condition met (length ${t.length}). Fetching orders...`),T(h,t)):console.log(`Condition not met (length ${t.length}). Not fetching.`)},[T,h,t]),w.useEffect(()=>{const U=setTimeout(()=>{t.length>=2?h!==1&&g(1):t.length<2&&h!==1&&g(1)},1e3);return()=>{clearTimeout(U)}},[t]);const E=async(U,z)=>{console.log(`Updating order ${U} to status ${z}`);try{const $=await fe(`/api/lab/${U}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:z})});if(!$.ok){const R=await $.json();throw new Error(R.message||`Failed to update status: ${$.status}`)}if(z==="completed"){const R=await fe(`/api/lab/orders/${U}/report`);if(R.ok){const H=await R.json();yw(H)}}await T(h,t),console.log(`Order ${U} status updated to ${z}, refetching page ${h}`)}catch($){console.error("Error updating status:",$),alert(`Failed to update status: ${$ instanceof Error?$.message:"Unknown error"}`)}},P=wt(),I=U=>{if(!U){console.error("Cannot navigate to billing: Order data is missing."),alert("Could not open billing page: Order information is missing.");return}U.billId?(console.log(`Navigating to existing bill for Bill ID: ${U.billId}, Patient: ${U.patientName}`),P("/billing",{state:{billId:U.billId,patientId:U.patientId,patientName:U.patientName,billType:"lab"}})):(console.log(`Navigating to create new bill for Lab Order ID: ${U.id}, Patient: ${U.patientName}`),P("/lab-billing",{state:{labOrderId:U.id}}))},V=U=>{U&&U.id?P(`/lab/report/${U.id}`):(console.error("Cannot navigate: Order or Order ID is missing."),alert("Could not open the report entry page: Order information is missing."))},F=U=>{switch(U){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:U,className:"status-badge"}}};if(a)return i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsx("div",{className:"text-teal-600 text-xl animate-pulse",children:"Loading Lab Panel..."})});if(o)return i.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-red-50 text-red-700",children:[i.jsx(si,{size:48,className:"mb-4"}),i.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Error Loading Lab Data"}),i.jsx("p",{className:"mb-4",children:o}),i.jsx("button",{onClick:()=>T(1,""),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry Fetch"})]});const O=()=>{h>1&&g(U=>U-1)},B=()=>{h<k&&g(U=>U+1)};return i.jsxs("div",{className:"lab-inventory-container",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("button",{onClick:()=>P(-1),className:"back-button mr-4",children:i.jsx(Ht,{size:24})}),i.jsx("h2",{className:"text-2xl font-semibold",children:"Lab Panel"})]}),i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px",borderBottom:"1px solid #ddd",paddingBottom:"10px"},children:[i.jsxs("button",{onClick:()=>d("orders"),className:`lab-inventory-button ${u==="orders"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[i.jsx(D_,{size:16,style:{marginRight:"8px"}}),"Orders"]}),i.jsx("button",{onClick:()=>P("/create-lab-order"),className:"lab-inventory-button",style:{display:"flex",alignItems:"center"},children:"Create New Lab Order"}),i.jsxs("button",{onClick:()=>d("inventory"),className:`lab-inventory-button ${u==="inventory"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[i.jsx(ew,{size:16,style:{marginRight:"8px"}}),"Inventory"]})]}),u==="orders"&&i.jsxs("div",{className:"lab-orders-view",children:[" ",i.jsxs("div",{className:"lab-orders-header-controls",children:[i.jsx("h3",{className:"lab-orders-title",children:"Current Lab Orders"}),i.jsxs("div",{className:"lab-orders-search-container",children:[i.jsx("input",{type:"text",placeholder:"Search name, token, tests...",value:t,onChange:U=>r(U.target.value),className:"lab-inventory-input lab-orders-search-input"}),i.jsx(vi,{size:18,className:"lab-orders-search-icon"})]})]}),i.jsx("div",{className:"lab-orders-table-container",children:i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient (Token)"}),i.jsx("th",{children:"Tests"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"lab-table-actions-header",children:"Actions"})]})}),i.jsxs("tbody",{children:[a&&!o&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:"Loading orders..."})}),!a&&!o&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."})}),!a&&!o&&e.map(U=>{const z=F(U.status);return i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{children:U.patientName}),i.jsxs("div",{className:"lab-table-patient-token",children:["Token: ",U.patientTokenNumber]})]}),i.jsx("td",{children:U.tests.map(($,R)=>i.jsx("div",{children:$},R))}),i.jsx("td",{className:"hidden md:table-cell",children:U.date}),i.jsx("td",{children:i.jsx("span",{className:z.className,children:z.text})}),i.jsx("td",{children:i.jsxs("div",{className:"lab-table-actions",children:[U.status==="pending"&&i.jsx("button",{onClick:()=>I(U),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),U.status==="billed"&&i.jsx("button",{onClick:()=>E(U.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),U.status==="collected"&&i.jsx("button",{onClick:()=>E(U.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(U.status==="processing"||U.status==="report_ready"||U.status==="reported")&&i.jsx("button",{onClick:()=>V(U),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(U.status==="report_ready"||U.status==="reported")&&i.jsx("button",{onClick:()=>E(U.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(U.status==="completed"||U.status==="report_ready"||U.status==="reported")&&i.jsx("button",{onClick:()=>{U.id?P(`/lab/view-report/${U.id}`):(console.error("Attempted to view report for an order with no ID:",U),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})})]},U.id)})]})]})}),i.jsxs("div",{className:"lab-orders-card-container",children:[a&&!o&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:"Loading orders..."}),!a&&!o&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."}),!a&&!o&&e.map(U=>{const z=F(U.status);return i.jsxs("div",{className:"lab-order-card",children:[i.jsxs("div",{className:"lab-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"lab-card-patient-name",children:U.patientName}),i.jsxs("div",{className:"lab-card-patient-token",children:["Token: ",U.patientTokenNumber]}),i.jsx("div",{className:"lab-card-date",children:U.date})]}),i.jsx("span",{className:`${z.className} lab-card-status-pill`,children:z.text})]}),i.jsxs("div",{className:"lab-card-section",children:[i.jsx("p",{className:"lab-card-section-title",children:"Tests:"}),U.tests.map(($,R)=>i.jsx("div",{className:"lab-card-test-item",children:$},R)),U.tests.length===0&&i.jsx("div",{className:"lab-card-no-tests",children:"No tests listed."})]}),i.jsxs("div",{className:"lab-card-actions",children:[U.status==="pending"&&i.jsx("button",{onClick:()=>I(U),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),U.status==="billed"&&i.jsx("button",{onClick:()=>E(U.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),U.status==="collected"&&i.jsx("button",{onClick:()=>E(U.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(U.status==="processing"||U.status==="report_ready"||U.status==="reported")&&i.jsx("button",{onClick:()=>V(U),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(U.status==="report_ready"||U.status==="reported")&&i.jsx("button",{onClick:()=>E(U.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(U.status==="completed"||U.status==="report_ready"||U.status==="reported")&&i.jsx("button",{onClick:()=>{U.id?P(`/lab/view-report/${U.id}`):(console.error("Attempted to view report for an order with no ID:",U),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})]},U.id)})]}),!a&&v>0&&i.jsxs("div",{className:"lab-pagination-controls",children:[i.jsxs("div",{className:"lab-pagination-info",children:["Showing"," ",i.jsx("strong",{children:(h-1)*b+1})," ","to"," ",i.jsx("strong",{children:Math.min(h*b,v)})," ","of"," ",i.jsx("strong",{children:v})," ","results"]}),i.jsxs("div",{className:"lab-pagination-buttons",children:[i.jsx("button",{onClick:O,disabled:h===1,className:"lab-pagination-button","aria-label":"Previous page",children:i.jsx(Cb,{size:18})}),i.jsxs("span",{children:["Page ",h," of ",k]}),i.jsx("button",{onClick:B,disabled:h===k,className:"lab-pagination-button","aria-label":"Next page",children:i.jsx(ug,{size:18})})]})]})]}),u==="inventory"&&i.jsxs("div",{className:"lab-inventory-content-wrapper",children:[" ",i.jsx(tw,{})]})]})]})},vU=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,l]=w.useState(!0),[o,f]=w.useState(null),u=wt(),d=w.useRef(null),[h,g]=w.useState(1),[b,v]=w.useState(1),[S,k]=w.useState(0),T=10,E=w.useCallback(async(B,U,z)=>{l(!0),f(null);try{let $=`/api/pharmacy-orders?page=${B}&limit=${U}`;z&&z.trim()!==""&&($+=`&search=${encodeURIComponent(z.trim())}`);const R=await fe($);if(!R.ok)throw new Error(`Failed to fetch orders: ${R.statusText} (${R.status})`);const H=await R.json();if(H&&Array.isArray(H.orders)&&typeof H.totalOrders=="number"&&typeof H.totalPages=="number")console.log("Fetched pharmacy orders data:",H.orders),n(H.orders),k(H.totalOrders),v(H.totalPages),g(H.currentPage||B);else throw console.error("Received data does not match expected paginated structure:",H),new Error("Invalid data format received from API")}catch($){console.error("Failed to fetch pharmacy orders:",$),f($.message||"Failed to fetch orders. Please try again."),n([]),v(1),k(0)}finally{l(!1)}},[]);w.useEffect(()=>(d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{const B=t===""?h:1;t!==""&&h!==1&&g(1),E(B,T,t)},500),()=>{d.current&&clearTimeout(d.current)}),[t,h,E,T]);const P=B=>{u(`/dashboard/edit-pharmacy-order/${B}`)},I=B=>{f(null),console.log(`Preparing billing navigation for order: ${B}`);const U=e.find(z=>z.id===B);if(U){const z=U.medications.map($=>{const R=$.price??0;return($.price===void 0||$.price===null)&&console.warn(`Medication "${$.name}" in order ${B} is missing a price. Defaulting to 0.`),{name:$.name,pack_quantity:$.pack_quantity,loose_quantity:$.loose_quantity,price:R,pack_price:$.pack_price,loose_price:$.loose_price,total_price:$.total_price,isLoose:$.isLoose,unit:$.unit,drug_id:$.drug_id?String($.drug_id):null,tabletsPerDay:$.tabletsPerDay,numberOfDays:$.numberOfDays,directions_to_use:$.directions_to_use,discount_percentage:0,batch:$.batch,expiry_date:$.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:z}),u(`/dashboard/pharmacy-billing/${B}`,{state:{initialItems:z}})}else console.error(`Order with ID ${B} not found.`),f(`Order with ID ${B} not found.`),alert(`Error: Could not find order ${B} to bill.`)},V=async(B,U)=>{f(null);const z=e.find(R=>R.id===B);if(!z){f(`Order with ID ${B} not found.`);return}const $={status:U,medications:z.medications};try{const R=await fe(`/api/pharmacy-orders/${B}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify($)});if(!R.ok){const ee=await R.text();throw new Error(`Failed to update status: ${R.statusText} (${R.status}) - ${ee}`)}const H=await R.json();n(ee=>ee.map(Z=>Z.id===H.id?{...Z,status:H.status}:Z))}catch(R){console.error("Failed to update order status:",R),f(R.message||`Failed to update status for order ${B}.`),alert(`Error updating status for order ${B}: ${R.message||"Please try again."}`)}},F=B=>{switch(B){case"pending":return"status-pill status-pill-pending";case"billed":return"status-pill status-pill-billed";case"dispensed":return"status-pill status-pill-dispensed";case"cancelled":return"status-pill status-pill-cancelled";default:return"status-pill status-pill-default"}},O=B=>{u(`/dashboard/orders/${B.id}`)};return a&&e.length===0&&!o?i.jsx("div",{className:"loading-pulse",children:"Loading Orders..."}):o&&e.length===0?i.jsxs("div",{className:"error-message-box",children:["Error loading orders: ",o]}):i.jsxs("div",{className:"pharmacy-queue-container",children:[i.jsxs("div",{className:"pharmacy-queue-header",children:[i.jsx("h3",{className:"pharmacy-queue-title",children:"Pharmacy Queue"}),i.jsxs("div",{className:"pharmacy-actions-container",children:[i.jsxs("div",{className:"pharmacy-buttons-group",children:[i.jsxs("button",{onClick:()=>u("/dashboard/add-order"),className:"pharmacy-action-button btn-add-order",children:[i.jsx(Fo,{size:16}),"Add Order"]}),i.jsxs("button",{onClick:()=>u("/dashboard/inventory"),className:"pharmacy-action-button btn-inventory",title:"View Pharmacy Inventory",children:[i.jsx(Ud,{size:16}),"Inventory"]}),i.jsxs("button",{onClick:()=>u("/dashboard/search-patient-records"),className:"pharmacy-action-button btn-ai-search",title:"Search Patient Records with Newton's AI",children:[i.jsx(V0,{size:16}),"Newton's AI"]}),i.jsxs("button",{onClick:()=>u("/dashboard/distributors"),className:"pharmacy-action-button btn-distributors",title:"Manage Distributors",children:[i.jsx(Ud,{size:16}),"Distributors"]}),i.jsxs("button",{onClick:()=>u("/dashboard/recurring-medications"),className:"pharmacy-action-button btn-refill-reminders",title:"View Recurring Medications",children:[i.jsx(NP,{size:16}),"Recurring Meds"]})]}),i.jsxs("div",{className:"pharmacy-search-input-container",children:[i.jsx("input",{type:"text",placeholder:"Search orders by patient name, token, or medication...",value:t,onChange:B=>r(B.target.value),className:"pharmacy-search-input"}),i.jsx(vi,{size:18,className:"pharmacy-search-icon"})]})]})]}),i.jsxs("div",{className:"pharmacy-orders-scroll-container",children:[o&&e.length>0&&i.jsxs("div",{className:"error-message-box",children:["Error: ",o]}),a&&e.length>0&&i.jsx("div",{className:"loading-pulse",children:"Updating Orders..."}),!a&&e.length===0&&!o&&i.jsx("div",{className:"empty-state-message",children:t?`No pharmacy orders found matching "${t}".`:"There are currently no pharmacy orders."}),e.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"pharmacy-table-container",children:i.jsxs("table",{className:"pharmacy-queue-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Medications"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Order Total"}),i.jsx("th",{children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map(B=>i.jsxs("tr",{onClick:()=>O(B),style:{cursor:"pointer"},children:[i.jsxs("td",{children:[i.jsx("div",{className:"patient-name",children:B.patientName}),i.jsx("div",{className:"patient-token",title:`Patient Token: ${B.patientTokenNumber}`,children:B.patientTokenNumber})]}),i.jsxs("td",{className:"medication-info",children:[B.medications.map((U,z)=>i.jsxs("div",{className:"medication-item",children:[i.jsxs("span",{children:[U.name," (Packs: ",U.pack_quantity,", Loose: ",U.loose_quantity,", ",U.tabletsPerDay??"N/A","x",U.numberOfDays??"N/A","d)",U.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",U.box_number,")"]})]}),U.directions_to_use&&i.jsxs("span",{className:"medication-directions",children:["Directions: ",U.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[U.pack_price!==void 0&&`Pack Price: ${Number(U.pack_price).toFixed(2)}`,U.loose_price!==void 0&&` | Loose Price: ${Number(U.loose_price).toFixed(2)}`,U.total_price!==void 0&&` | Item Total: ${Number(U.total_price).toFixed(2)}`]})]},z)),B.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",B.prescriptionForUnavailableDrugs]})]}),i.jsx("td",{className:"hidden md:table-cell date-info",children:new Date(B.date).toLocaleDateString()}),i.jsxs("td",{className:"order-total-cell font-semibold",children:["",Number(B.order_total??0).toFixed(2)]}),i.jsx("td",{children:i.jsx("span",{className:F(B.status),children:B.status})}),i.jsx("td",{children:i.jsxs("div",{className:"pharmacy-table-actions",children:[B.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:U=>{U.stopPropagation(),P(B.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx(tu,{size:14})," Edit"]}),i.jsxs("button",{onClick:U=>{U.stopPropagation(),I(B.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx(zd,{size:14})," Bill"]})]}),B.status==="billed"&&i.jsxs("button",{onClick:U=>{U.stopPropagation(),V(B.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx(Ua,{size:14})," Dispense"]}),(B.status==="pending"||B.status==="billed")&&i.jsx("button",{onClick:U=>{U.stopPropagation(),V(B.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:U=>{U.stopPropagation(),O(B)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})})]},B.id))})]})}),i.jsx("div",{className:"pharmacy-card-view-container",children:e.map(B=>{const U=F(B.status);return i.jsxs("div",{className:"pharmacy-order-card",onClick:()=>O(B),children:[i.jsxs("div",{className:"pharmacy-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"pharmacy-card-patient-name",children:B.patientName||"N/A"}),i.jsxs("div",{className:"pharmacy-card-patient-token",title:`Patient Token: ${B.patientTokenNumber}`,children:["Token: ",B.patientTokenNumber||"N/A"]}),i.jsx("div",{className:"pharmacy-card-date",children:new Date(B.date).toLocaleDateString()})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:U,children:B.status}),B.order_total!==void 0&&i.jsxs("span",{className:"pharmacy-card-order-total font-semibold",children:["",Number(B.order_total).toFixed(2)]})]})]}),i.jsxs("div",{className:"pharmacy-card-medications",children:[i.jsx("p",{className:"pharmacy-card-medications-title",children:"Medications:"}),i.jsxs("div",{className:"space-y-0_5",children:[B.medications.slice(0,2).map((z,$)=>i.jsxs("div",{className:"pharmacy-card-medication-item",children:[i.jsxs("span",{title:`${z.name} (Packs: ${z.pack_quantity}, Loose: ${z.loose_quantity}, ${z.tabletsPerDay??"N/A"}x${z.numberOfDays??"N/A"}d)`,children:[z.name," (Packs: ",z.pack_quantity,", Loose: ",z.loose_quantity,", ",z.tabletsPerDay??"N/A","x",z.numberOfDays??"N/A","d)",z.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",z.box_number,")"]})]}),z.directions_to_use&&i.jsxs("span",{className:"medication-directions",title:`Directions: ${z.directions_to_use}`,children:["Directions: ",z.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[z.pack_price!==void 0&&`Pack Price: ${Number(z.pack_price).toFixed(2)}`,z.loose_price!==void 0&&` | Loose Price: ${Number(z.loose_price).toFixed(2)}`,z.total_price!==void 0&&` | Item Total: ${Number(z.total_price).toFixed(2)}`]})]},$)),B.medications.length>2&&i.jsxs("div",{className:"pharmacy-card-medications-more",children:["...and ",B.medications.length-2," more"]}),B.medications.length===0&&i.jsx("div",{className:"pharmacy-card-no-medications",children:"No medications listed."})]}),B.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",B.prescriptionForUnavailableDrugs]})]}),i.jsxs("div",{className:"pharmacy-card-actions",children:[B.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:z=>{z.stopPropagation(),P(B.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx(tu,{size:14})," Edit"]}),i.jsxs("button",{onClick:z=>{z.stopPropagation(),I(B.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx(zd,{size:14})," Bill"]})]}),B.status==="billed"&&i.jsxs("button",{onClick:z=>{z.stopPropagation(),V(B.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx(Ua,{size:14})," Dispense"]}),(B.status==="pending"||B.status==="billed")&&i.jsx("button",{onClick:z=>{z.stopPropagation(),V(B.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:z=>{z.stopPropagation(),O(B)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})]},B.id)})})]}),!a&&b>1&&i.jsxs("div",{className:"pharmacy-pagination-container",children:[i.jsxs("div",{className:"pagination-mobile-controls",children:[i.jsx("button",{onClick:()=>g(B=>Math.max(B-1,1)),disabled:h===1,className:"pagination-button prev",children:"Previous"}),i.jsx("button",{onClick:()=>g(B=>Math.min(B+1,b)),disabled:h===b,className:"pagination-button next",children:"Next"})]}),i.jsxs("div",{className:"pagination-desktop-controls",children:[i.jsx("div",{className:"pagination-info",children:i.jsxs("p",{children:["Showing ",i.jsx("span",{className:"font-medium",children:(h-1)*T+1})," ","to ",i.jsx("span",{className:"font-medium",children:Math.min(h*T,S)})," ","of ",i.jsx("span",{className:"font-medium",children:S})," results"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"pagination-nav","aria-label":"Pagination",children:[i.jsxs("button",{onClick:()=>g(B=>Math.max(B-1,1)),disabled:h===1,className:"pagination-nav-button prev",children:[i.jsx("span",{className:"sr-only",children:"Previous"}),i.jsx(Cb,{"aria-hidden":"true"})]}),i.jsxs("span",{"aria-current":"page",className:"pagination-current-page",children:["Page ",h," of ",b]}),i.jsxs("button",{onClick:()=>g(B=>Math.min(B+1,b)),disabled:h===b,className:"pagination-nav-button next",children:[i.jsx("span",{className:"sr-only",children:"Next"}),i.jsx(ug,{"aria-hidden":"true"})]})]})})]})]})]})," "]})},wU=()=>{const e=wt();return i.jsxs("div",{className:"bg-white p-3 md:p-6 rounded-lg shadow",children:[i.jsx("button",{onClick:()=>e(-1),className:"mb-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Back"}),i.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Settings"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Pharmacy settings will be configured here."})]})},NU=()=>{const{id:e}=Rr(),n=wt(),[t,r]=w.useState(null),[a,l]=w.useState(!0),[o,f]=w.useState(null),[u,d]=w.useState(!1),[h,g]=w.useState(!1),b=w.useRef(null),v=w.useRef(null),S=w.useRef(null),k=w.useCallback(async()=>{if(!e){f("Drug ID is missing."),l(!1);return}l(!0),f(null);try{const I=await fe(`/api/drugs/${e}`);if(!I.ok){const F=await I.json();throw new Error(F.message||`Failed to fetch drug: ${I.statusText}`)}let V=await I.json();V={...V,name:V.name||"",brand_name:V.brand_name||"",price:parseFloat(String(V.price))||0,buying_price:V.buying_price!==null&&V.buying_price!==void 0?parseFloat(String(V.buying_price)):null,quantity_in_stock:parseInt(String(V.quantity_in_stock),10)||0,gst:V.gst!==null&&V.gst!==void 0?parseFloat(String(V.gst)):null,margin:V.margin!==null&&V.margin!==void 0?parseFloat(String(V.margin)):null,discount:V.discount!==null&&V.discount!==void 0?parseFloat(String(V.discount)):null,batch:V.batch||"",hsn_code:V.hsn_code||"",mfg:V.mfg||"",loose:V.loose!==null&&V.loose!==void 0?parseInt(String(V.loose),10):null},r(V)}catch(I){console.error("Failed to fetch drug:",I),f(I.message||"Failed to load drug data. Please try again.")}finally{l(!1)}},[e]);w.useEffect(()=>{k()},[k]),w.useEffect(()=>{const I=F=>{F.key==="Tab"&&v.current===document.activeElement&&(h||(g(!0),setTimeout(()=>{var O;(O=S.current)==null||O.focus()},0),F.preventDefault()))},V=F=>{b.current&&!b.current.contains(F.target)&&g(!1)};return document.addEventListener("keydown",I),document.addEventListener("mousedown",V),()=>{document.removeEventListener("keydown",I),document.removeEventListener("mousedown",V)}},[h]);const T=I=>{const{name:V,value:F,type:O}=I.target;r(B=>B?{...B,[V]:O==="number"?parseFloat(F)||null:F}:null)},E=()=>{n(-1)},P=async I=>{if(I.preventDefault(),f(null),d(!0),!t||!t.id){f("Cannot edit drug: No drug data available."),d(!1);return}if(t.price===void 0||t.quantity_in_stock===void 0){f("Price and Stock Quantity are required."),d(!1);return}const V={...t,name:t.name===""?null:t.name,brand_name:t.brand_name===""?null:t.brand_name,buying_price:t.buying_price===0?null:t.buying_price,expiry_date:t.expiry_date===""?null:t.expiry_date,gst:t.gst===0?null:t.gst,margin:t.margin===0?null:t.margin,discount:t.discount===0?null:t.discount,batch:t.batch===""?null:t.batch,hsn_code:t.hsn_code===""?null:t.hsn_code,mfg:t.mfg===""?null:t.mfg,loose:t.loose===0?null:t.loose};try{const F=await fe(`/api/drugs/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(V)});if(!F.ok){const B=await F.json();throw new Error(B.message||`Failed to update drug: ${F.statusText}`)}const O=await F.json();alert(`Drug "${O.name}" updated successfully!`),n(-1)}catch(F){console.error("Failed to update drug:",F),f(F.message||"Failed to update drug. Please try again.")}finally{d(!1)}};return a?i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"loading-message",children:"Loading drug data..."})}):o&&!t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"error-message-load",children:["Error: ",o]})}):t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"edit-drug-form-container",children:[i.jsxs("div",{className:"edit-drug-form-header",children:[i.jsxs("h2",{children:["Edit Drug: ",t.name]}),i.jsx("button",{onClick:E,className:"cancel-button",title:"Go Back",children:i.jsx(Kn,{size:24})})]}),o&&i.jsx("div",{className:"error-message-submit",children:o}),i.jsxs("form",{onSubmit:P,className:"edit-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-name",className:"form-label",children:"Composition Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ql,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"edit-name",value:t.name||"",onChange:T,className:"custom-text-input",placeholder:"e.g., Paracetamol",tabIndex:1})," "]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-brand_name",className:"form-label",children:"Brand Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ql,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"edit-brand_name",value:t.brand_name||"",onChange:T,className:"custom-text-input",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-price",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ql,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"price",id:"edit-price",required:!0,step:"0.01",min:"0",value:t.price,onChange:T,className:"custom-text-input",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-quantity_in_stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ql,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"quantity_in_stock",id:"edit-quantity_in_stock",required:!0,step:"1",min:"0",value:t.quantity_in_stock,onChange:T,className:"custom-text-input",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-unit",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"unit",id:"edit-unit",value:t.unit||"",onChange:T,className:"custom-text-input",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"edit-expiry_date",value:t.expiry_date||"",onChange:T,className:"custom-text-input",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"edit-box_number",value:t.box_number||"",onChange:T,className:"custom-text-input",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:b,children:[i.jsx("button",{type:"button",onClick:()=>g(!h),className:"form-button w-full text-left",tabIndex:8,ref:v,children:"Others"}),h&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"edit-description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"edit-description",rows:3,value:t.description||"",onChange:T,className:"custom-text-input",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-supplier",className:"form-label",children:"Supplier"}),i.jsx("input",{type:"text",name:"supplier",id:"edit-supplier",value:t.supplier||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:10})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-buying_price",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"buying_price",id:"edit-buying_price",step:"0.01",min:"0",value:t.buying_price??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:11,ref:S})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"edit-gst",step:"0.01",min:"0",max:"100",value:t.gst??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"edit-margin",step:"0.01",min:"0",max:"100",value:t.margin??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"edit-discount",step:"0.01",min:"0",max:"100",value:t.discount??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"edit-batch",value:t.batch||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"edit-hsn_code",value:t.hsn_code||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"edit-mfg",value:t.mfg||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:17})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-loose",className:"form-label",children:"Loose"}),i.jsx("input",{type:"number",name:"loose",id:"edit-loose",step:"1",min:"0",value:t.loose??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:18})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:E,disabled:u,className:"form-button cancel-form-button",tabIndex:19,children:"Back"}),i.jsx("button",{type:"submit",disabled:u,className:"form-button submit-form-button",tabIndex:20,children:u?"Saving...":"Save Changes"})]})]})]})}):i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"not-found-message",children:"Drug not found."})})},h1=()=>{const e=wt(),[n,t]=w.useState({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),[r,a]=w.useState(!1),[l,o]=w.useState(null),[f,u]=w.useState(null),[d,h]=w.useState(""),[g,b]=w.useState([]),[v,S]=w.useState(null),[k,T]=w.useState(!1),[E,P]=w.useState([]),[I,V]=w.useState(!0);w.useEffect(()=>{(async()=>{V(!0);try{const R=await fe("/api/staff?role=doctor");if(!R.ok)throw new Error("Failed to fetch doctors");const H=await R.json();P(H),H.length>0&&t(ee=>({...ee,doctorId:""}))}catch(R){console.error("Error fetching doctors:",R),o(`Failed to load doctors: ${R.message}`)}finally{V(!1)}})()},[]);const F=w.useCallback(async()=>{if(d.trim()){T(!0),o(null),b([]);try{const $=encodeURIComponent(d.trim()),R=await fe(`/api/patients?search=${$}&limit=10`);if(!R.ok){const ee=await R.json().catch(()=>({message:"Failed to search patients"}));throw new Error(ee.message||"Failed to search patients")}const H=await R.json();H&&Array.isArray(H.patients)?b(H.patients):(console.error("Unexpected response format from patient search:",H),b([]))}catch($){console.error("Error searching patients:",$),o(`Search failed: ${$.message}`)}finally{T(!1)}}},[d]);w.useEffect(()=>{if(d.trim().length<2){b([]),o(null);return}const $=setTimeout(()=>{F()},300);return()=>clearTimeout($)},[d,F]);const O=$=>{S($),h(""),b([]),o(null),t(R=>({...R,name:"",age:"",gender:"",phone:""}))},B=()=>{S(null),h(""),b([]),o(null),t($=>({...$,name:"",age:"",gender:"",phone:""}))},U=$=>{const{name:R,value:H}=$.target;t(ee=>({...ee,[R]:H}))},z=async $=>{var R;$.preventDefault(),o(null),u(null),a(!0);try{let H,ee;if(v)H=v.id,ee=v.name,console.log(`Adding existing patient ${H} to queue.`);else{console.log("Registering new patient...");const q=await fe("/api/patients",{method:"POST",body:JSON.stringify({name:n.name,age:n.age?parseInt(n.age,10):null,gender:n.gender||null,phone:n.phone||null})});if(!q.ok){const ne=await q.json();if(q.status===403&&ne.message.includes("Patient limit")){e("/start-clinic-subscription",{state:{errorMessage:ne.message}});return}throw new Error(ne.message||"Failed to register patient")}const W=await q.json();H=W.id,ee=W.name,console.log(`New patient ${H} registered.`)}const Z=n.doctorId||null;console.log(`Adding patient ${H} to queue for doctor ${Z||"Unassigned"}`);const te=await fe("/api/queue",{method:"POST",body:JSON.stringify({patientId:H,complaint:n.complaint||null,doctorId:Z})});if(!te.ok){const q=await te.json();throw new Error(q.message||"Failed to add patient to queue")}const Q=await te.json();if(console.log(`Patient added to queue, entry ID: ${Q.id}`),S(null),h(""),b([]),t({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),Z){const q=((R=E.find(ne=>ne.id===Z))==null?void 0:R.name)||"Selected Doctor",W=v?`Existing patient "${ee}" added to queue for Dr. ${q}. Redirecting to billing...`:`Patient "${ee}" registered and added to queue for Dr. ${q}. Redirecting to billing...`;u(W),e("/billing",{state:{patientId:H,queueId:Q.id,patientName:ee,doctorId:Z,billType:"consultation"}})}else{const q=v?`Existing patient "${ee}" added to the general queue.`:`Patient "${ee}" registered and added to the general queue.`;u(q)}}catch(H){console.error("Error in add/queue process:",H),H.message.includes("Patient limit")?(o(`Operation failed: ${H.message}. Please upgrade your plan.`),e("/start-clinic-subscription")):o(`Operation failed: ${H.message}`)}finally{a(!1)}};return i.jsxs("div",{className:"add-patient-page-container flex flex-col items-center justify-start",children:[i.jsxs("div",{className:"w-full max-w-3xl mb-2 flex justify-start",children:[" ",i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Back to Previous Page",children:[i.jsx(Ht,{size:20,className:"btn-icon"})," Back"]})]}),i.jsxs("div",{className:"add-patient-card",children:[i.jsxs("h3",{className:"add-patient-title",children:[i.jsx(L_,{size:28})," ",v?"Add Existing Patient to Queue":"Register New Patient & Add to Queue"]}),i.jsxs("div",{className:"search-section",children:[i.jsx("legend",{className:"form-fieldset legend",children:"Find Existing Patient"})," ",i.jsxs("div",{className:"flex items-center space-x-2",children:[" ",i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by Name or Phone...",value:d,onChange:$=>h($.target.value),className:"form-input",disabled:r||!!v}),i.jsx(vi,{size:18,className:`${k?"text-primary animate-pulse":""}`})," "]}),v&&i.jsxs("button",{type:"button",onClick:B,className:"btn btn-danger",title:"Clear Selection",children:[i.jsx(Kn,{size:16,className:"btn-icon"})," Clear"]})]}),g.length>0&&!v&&i.jsx("ul",{className:"search-results-list",children:g.map($=>i.jsxs("li",{onClick:()=>O($),children:[$.name," (ID: ",$.id,", Phone: ",$.phone||"N/A",")"]},$.id))}),d.length>=2&&g.length===0&&!k&&!v&&i.jsxs("p",{className:"search-info-text",children:['No patients found matching "',d,'". You can register them below.']}),k&&d.length>=2&&i.jsx("p",{className:"search-info-text searching",children:"Searching..."})]}),l&&i.jsxs("div",{className:"alert alert-danger",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:l})]}),f&&i.jsxs("div",{className:"alert alert-success",role:"alert",children:[i.jsx("strong",{children:"Success: "}),i.jsx("span",{children:f})]}),i.jsxs("form",{onSubmit:z,className:"space-y-5",children:[" ",i.jsxs("fieldset",{className:`form-fieldset ${v?"fieldset-disabled":""}`,children:[i.jsx("legend",{children:v?`Selected Patient: ${v.name}`:"New Patient Details"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Full Name *"}),i.jsx("input",{type:"text",name:"name",value:v?v.name:n.name,onChange:U,className:"form-input",required:!v,disabled:r||!!v})]}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Age"}),i.jsx("input",{type:"number",name:"age",value:v?v.age??"":n.age,onChange:U,className:"form-input",min:"0",disabled:r||!!v})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Gender"}),i.jsxs("select",{name:"gender",value:v?v.gender??"":n.gender,onChange:U,className:"form-select",disabled:r||!!v,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Phone"}),i.jsx("input",{type:"tel",name:"phone",value:v?v.phone??"":n.phone,onChange:U,className:"form-input",disabled:r||!!v})]})]})]}),i.jsxs("fieldset",{className:"form-fieldset",children:[i.jsx("legend",{children:"Visit Details"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Assign Doctor (Optional)"}),i.jsxs("select",{name:"doctorId",value:n.doctorId,onChange:U,className:`form-select ${I?"opacity-50":""}`,disabled:r||I,children:[i.jsx("option",{value:"",children:I?"Loading doctors...":E.length===0?"No doctors available":"-- No Doctor (Add to General Queue) --"}),E.map($=>i.jsx("option",{value:$.id,children:$.name},$.id))]}),E.length===0&&!I&&i.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Please add doctors via the Admin Panel."})]}),i.jsxs("div",{className:"form-grid-col-span-2",children:[" ",i.jsx("label",{className:"form-label",children:"Patient Data / Reason"}),i.jsx("textarea",{name:"complaint",value:n.complaint,onChange:U,rows:2,className:"form-textarea",disabled:r})]})]})]}),i.jsxs("button",{type:"submit",className:`btn btn-primary floating-action-btn ${r||I?"disabled":""}`,disabled:r||I,children:[i.jsx(R_,{size:18,className:"btn-icon"}),r?"Processing...":v?"Add Existing to Queue":"Register & Add to Queue"]})]})]})]})},SU=({clinicId:e})=>{const n=wt(),[t,r]=w.useState({name:"",email:"",role:"receptionist",password:"",opd_fee:""}),[a,l]=w.useState(null),[o,f]=w.useState(!1);w.useEffect(()=>{l(e?null:"Clinic information is missing. Cannot add staff. Please ensure you are logged in correctly.")},[e]);const u=g=>{const{name:b,value:v}=g.target;r(S=>{const k={...S,[b]:v};return b==="role"&&v!=="doctor"&&(k.opd_fee=""),k})},d=async g=>{if(g.preventDefault(),l(null),!t.name||!t.email||!t.role||!t.password){l("Name, Email, Role, and Password are required.");return}if(!e){l("Clinic information is missing. Cannot add staff.");return}const b={...t,clinic_id:e,opd_fee:t.role==="doctor"&&t.opd_fee?parseFloat(String(t.opd_fee)):null};if(b.role==="doctor"&&t.opd_fee&&isNaN(b.opd_fee)){l("Invalid OPD Fee format. Please enter a number.");return}f(!0);try{const v=await fe("/api/staff",{method:"POST",body:JSON.stringify(b)});if(!v.ok){const S=await v.json();throw new Error(S.message||"Server responded with an error")}n(-1)}catch(v){l(`Failed to add staff: ${v.message}`)}finally{f(!1)}},h=()=>{n(-1)};return i.jsxs("div",{className:"staff-page-container",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("button",{onClick:h,className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[i.jsx(Ht,{size:18,className:"mr-2"}),"Back"]}),i.jsx("h1",{children:"Add New Staff Member"}),i.jsx("div",{className:"w-16"})," "]}),a&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[i.jsx(si,{size:18,className:"mr-2 text-red-500"}),a]}),i.jsxs("form",{onSubmit:d,className:`staff-form ${e?"":"opacity-50 pointer-events-none"}`,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Full Name"}),i.jsx("input",{id:"name",type:"text",name:"name",value:t.name||"",onChange:u,required:!0,disabled:o||!e,placeholder:"Enter full name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email Address"}),i.jsx("input",{id:"email",type:"email",name:"email",value:t.email||"",onChange:u,required:!0,disabled:o||!e,placeholder:"Enter email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"role",children:"Assign Role"}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:u,required:!0,disabled:o||!e,children:[i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"}),i.jsx("option",{value:"lab",children:"Lab Technician"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"Set Initial Password"}),i.jsx("input",{id:"password",type:"password",name:"password",value:t.password||"",onChange:u,required:!0,disabled:o||!e,placeholder:"Create a password"})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"opd_fee",children:"OPD Consultation Fee () (Optional)"}),i.jsx("input",{id:"opd_fee",type:"number",name:"opd_fee",value:t.opd_fee||"",onChange:u,step:"0.01",min:"0",placeholder:"e.g., 150.00",disabled:o||!e}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank if no specific fee is set for this doctor."})]}),i.jsxs("button",{type:"submit",disabled:o||!e,children:[o?i.jsx(Bd,{size:18,className:"animate-spin mr-2"}):i.jsx(Gl,{size:18,className:"mr-2"}),o?"Adding...":"Add Staff Member"]})]})]})},jU=()=>{const{id:e}=Rr(),n=wt(),[t,r]=w.useState({name:"",email:"",role:"receptionist",opd_fee:"",active:!0}),[a,l]=w.useState(""),[o,f]=w.useState(!0),[u,d]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Staff ID is missing."),f(!1);return}f(!0),g(null),v(null);try{const P=await fe(`/staff/${e}`);if(!P.ok){const V=await P.json();throw new Error(V.message||`HTTP error! status: ${P.status}`)}const I=await P.json();r({name:I.name,email:I.email,role:I.role,opd_fee:I.opd_fee??"",active:I.active})}catch(P){g(`Failed to load staff details: ${P.message}`)}finally{f(!1)}},[e]);w.useEffect(()=>{S()},[S]);const k=P=>{const{name:I,value:V,type:F}=P.target;if(F==="checkbox"){const{checked:O}=P.target;r(B=>({...B,[I]:O}))}else r(O=>({...O,[I]:V}))},T=P=>{l(P.target.value)},E=async P=>{if(P.preventDefault(),!e){g("Staff ID is missing.");return}d(!0),g(null),v(null);const I={name:t.name,email:t.email,role:t.role,active:t.active};if(t.role==="doctor"){const V=t.opd_fee?parseFloat(String(t.opd_fee)):null;if(V!==null&&isNaN(V)){g("OPD Fee must be a valid number."),d(!1);return}I.opd_fee=V}else I.opd_fee=null;a.trim()!==""&&(I.password=a.trim());try{const V=await fe(`/staff/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)});if(!V.ok){const F=await V.json();throw new Error(F.message||`HTTP error! status: ${V.status}`)}v("Staff details updated successfully!"),l(""),setTimeout(()=>n(-1),1500)}catch(V){g(`Failed to update staff: ${V.message}`)}finally{d(!1)}};return o?i.jsxs("div",{className:"flex justify-center items-center h-screen",children:[i.jsx(Bd,{className:"h-12 w-12 animate-spin text-teal-600"}),i.jsx("span",{className:"ml-4 text-xl text-gray-700",children:"Loading Staff Details..."})]}):i.jsxs("div",{className:"staff-page-container",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[i.jsx(Ht,{size:18,className:"mr-2"}),"Back"]}),i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Edit Staff Member"}),i.jsx("div",{className:"w-16"})," "]}),h&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[i.jsx(si,{size:18,className:"mr-2 text-red-500"}),h,i.jsx("button",{onClick:()=>g(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),b&&i.jsxs("div",{className:"success-message mb-4 p-3 bg-green-100 border border-green-400 rounded-md flex items-center",children:[i.jsx(Ua,{size:18,className:"mr-2 text-green-500"}),b,i.jsx("button",{onClick:()=>v(null),className:"ml-auto text-green-600 hover:text-green-800 text-xl font-bold",children:""})]}),i.jsxs("form",{onSubmit:E,className:"staff-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Full Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:t.name||"",onChange:k,required:!0,placeholder:"Enter full name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"email",children:["Email Address ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"email",id:"email",name:"email",value:t.email||"",onChange:k,required:!0,placeholder:"Enter email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"role",children:["Role ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:k,required:!0,children:[i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"lab",children:"Lab Technician"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"})]})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"opd_fee",children:"OPD Fee ()"}),i.jsx("input",{type:"number",id:"opd_fee",name:"opd_fee",value:t.opd_fee||"",onChange:k,min:"0",step:"0.01",placeholder:"Enter OPD consultation fee (optional)"})]}),i.jsxs("div",{className:"form-group checkbox-group",children:[i.jsx("input",{id:"active",name:"active",type:"checkbox",checked:t.active??!0,onChange:k}),i.jsxs("label",{htmlFor:"active",className:"mb-0",children:[" ","Account Active"]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"New Password (optional)"}),i.jsx("input",{type:"password",id:"password",name:"password",value:a,onChange:T,placeholder:"Leave blank to keep current password",autoComplete:"new-password"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter a new password only if you want to change it. Minimum 6 characters."})]}),i.jsx("button",{type:"submit",disabled:u,children:u?i.jsxs(i.Fragment,{children:[i.jsx(Bd,{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(eu,{size:16,className:"mr-2"}),"Save Changes"]})})]})]})};function CU(e,n){const t={};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const _U=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,kU=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,EU={};function vj(e,n){return(EU.jsx?kU:_U).test(e)}const TU=/[ \t\n\f\r]/g;function AU(e){return typeof e=="object"?e.type==="text"?wj(e.value):!1:wj(e)}function wj(e){return e.replace(TU,"")===""}let pg=class{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}};pg.prototype.normal={};pg.prototype.property={};pg.prototype.space=void 0;function ck(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new pg(t,r,n)}function p1(e){return e.toLowerCase()}let ya=class{constructor(n,t){this.attribute=t,this.property=n}};ya.prototype.attribute="";ya.prototype.booleanish=!1;ya.prototype.boolean=!1;ya.prototype.commaOrSpaceSeparated=!1;ya.prototype.commaSeparated=!1;ya.prototype.defined=!1;ya.prototype.mustUseProperty=!1;ya.prototype.number=!1;ya.prototype.overloadedBoolean=!1;ya.prototype.property="";ya.prototype.spaceSeparated=!1;ya.prototype.space=void 0;let DU=0;const Yt=Yd(),Ui=Yd(),uk=Yd(),lt=Yd(),ii=Yd(),Mh=Yd(),La=Yd();function Yd(){return 2**++DU}const m1=Object.freeze(Object.defineProperty({__proto__:null,boolean:Yt,booleanish:Ui,commaOrSpaceSeparated:La,commaSeparated:Mh,number:lt,overloadedBoolean:uk,spaceSeparated:ii},Symbol.toStringTag,{value:"Module"})),l0=Object.keys(m1);let xw=class extends ya{constructor(n,t,r,a){let l=-1;if(super(n,t),Nj(this,"space",a),typeof r=="number")for(;++l<l0.length;){const o=l0[l];Nj(this,l0[l],(r&m1[o])===m1[o])}}};xw.prototype.defined=!0;function Nj(e,n,t){t&&(e[n]=t)}function Xh(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const l=new xw(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(l.mustUseProperty=!0),n[r]=l,t[p1(r)]=r,t[p1(l.attribute)]=r}return new pg(n,t,e.space)}const dk=Xh({properties:{ariaActiveDescendant:null,ariaAtomic:Ui,ariaAutoComplete:null,ariaBusy:Ui,ariaChecked:Ui,ariaColCount:lt,ariaColIndex:lt,ariaColSpan:lt,ariaControls:ii,ariaCurrent:null,ariaDescribedBy:ii,ariaDetails:null,ariaDisabled:Ui,ariaDropEffect:ii,ariaErrorMessage:null,ariaExpanded:Ui,ariaFlowTo:ii,ariaGrabbed:Ui,ariaHasPopup:null,ariaHidden:Ui,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:ii,ariaLevel:lt,ariaLive:null,ariaModal:Ui,ariaMultiLine:Ui,ariaMultiSelectable:Ui,ariaOrientation:null,ariaOwns:ii,ariaPlaceholder:null,ariaPosInSet:lt,ariaPressed:Ui,ariaReadOnly:Ui,ariaRelevant:null,ariaRequired:Ui,ariaRoleDescription:ii,ariaRowCount:lt,ariaRowIndex:lt,ariaRowSpan:lt,ariaSelected:Ui,ariaSetSize:lt,ariaSort:null,ariaValueMax:lt,ariaValueMin:lt,ariaValueNow:lt,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function fk(e,n){return n in e?e[n]:n}function hk(e,n){return fk(e,n.toLowerCase())}const PU=Xh({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Mh,acceptCharset:ii,accessKey:ii,action:null,allow:null,allowFullScreen:Yt,allowPaymentRequest:Yt,allowUserMedia:Yt,alt:null,as:null,async:Yt,autoCapitalize:null,autoComplete:ii,autoFocus:Yt,autoPlay:Yt,blocking:ii,capture:null,charSet:null,checked:Yt,cite:null,className:ii,cols:lt,colSpan:null,content:null,contentEditable:Ui,controls:Yt,controlsList:ii,coords:lt|Mh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Yt,defer:Yt,dir:null,dirName:null,disabled:Yt,download:uk,draggable:Ui,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Yt,formTarget:null,headers:ii,height:lt,hidden:Yt,high:lt,href:null,hrefLang:null,htmlFor:ii,httpEquiv:ii,id:null,imageSizes:null,imageSrcSet:null,inert:Yt,inputMode:null,integrity:null,is:null,isMap:Yt,itemId:null,itemProp:ii,itemRef:ii,itemScope:Yt,itemType:ii,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Yt,low:lt,manifest:null,max:null,maxLength:lt,media:null,method:null,min:null,minLength:lt,multiple:Yt,muted:Yt,name:null,nonce:null,noModule:Yt,noValidate:Yt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Yt,optimum:lt,pattern:null,ping:ii,placeholder:null,playsInline:Yt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Yt,referrerPolicy:null,rel:ii,required:Yt,reversed:Yt,rows:lt,rowSpan:lt,sandbox:ii,scope:null,scoped:Yt,seamless:Yt,selected:Yt,shadowRootClonable:Yt,shadowRootDelegatesFocus:Yt,shadowRootMode:null,shape:null,size:lt,sizes:null,slot:null,span:lt,spellCheck:Ui,src:null,srcDoc:null,srcLang:null,srcSet:null,start:lt,step:null,style:null,tabIndex:lt,target:null,title:null,translate:null,type:null,typeMustMatch:Yt,useMap:null,value:Ui,width:lt,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:ii,axis:null,background:null,bgColor:null,border:lt,borderColor:null,bottomMargin:lt,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Yt,declare:Yt,event:null,face:null,frame:null,frameBorder:null,hSpace:lt,leftMargin:lt,link:null,longDesc:null,lowSrc:null,marginHeight:lt,marginWidth:lt,noResize:Yt,noHref:Yt,noShade:Yt,noWrap:Yt,object:null,profile:null,prompt:null,rev:null,rightMargin:lt,rules:null,scheme:null,scrolling:Ui,standby:null,summary:null,text:null,topMargin:lt,valueType:null,version:null,vAlign:null,vLink:null,vSpace:lt,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Yt,disableRemotePlayback:Yt,prefix:null,property:null,results:lt,security:null,unselectable:null},space:"html",transform:hk}),IU=Xh({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:La,accentHeight:lt,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:lt,amplitude:lt,arabicForm:null,ascent:lt,attributeName:null,attributeType:null,azimuth:lt,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:lt,by:null,calcMode:null,capHeight:lt,className:ii,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:lt,diffuseConstant:lt,direction:null,display:null,dur:null,divisor:lt,dominantBaseline:null,download:Yt,dx:null,dy:null,edgeMode:null,editable:null,elevation:lt,enableBackground:null,end:null,event:null,exponent:lt,externalResourcesRequired:null,fill:null,fillOpacity:lt,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Mh,g2:Mh,glyphName:Mh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:lt,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:lt,horizOriginX:lt,horizOriginY:lt,id:null,ideographic:lt,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:lt,k:lt,k1:lt,k2:lt,k3:lt,k4:lt,kernelMatrix:La,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:lt,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:lt,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:lt,overlineThickness:lt,paintOrder:null,panose1:null,path:null,pathLength:lt,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:ii,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:lt,pointsAtY:lt,pointsAtZ:lt,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:La,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:La,rev:La,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:La,requiredFeatures:La,requiredFonts:La,requiredFormats:La,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:lt,specularExponent:lt,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:lt,strikethroughThickness:lt,string:null,stroke:null,strokeDashArray:La,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:lt,strokeOpacity:lt,strokeWidth:null,style:null,surfaceScale:lt,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:La,tabIndex:lt,tableValues:null,target:null,targetX:lt,targetY:lt,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:La,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:lt,underlineThickness:lt,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:lt,values:null,vAlphabetic:lt,vMathematical:lt,vectorEffect:null,vHanging:lt,vIdeographic:lt,version:null,vertAdvY:lt,vertOriginX:lt,vertOriginY:lt,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:lt,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:fk}),pk=Xh({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),mk=Xh({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:hk}),gk=Xh({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),MU={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},RU=/[A-Z]/g,Sj=/-[a-z]/g,LU=/^data[-\w.:]+$/i;function OU(e,n){const t=p1(n);let r=n,a=ya;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&LU.test(n)){if(n.charAt(4)==="-"){const l=n.slice(5).replace(Sj,$U);r="data"+l.charAt(0).toUpperCase()+l.slice(1)}else{const l=n.slice(4);if(!Sj.test(l)){let o=l.replace(RU,FU);o.charAt(0)!=="-"&&(o="-"+o),n="data"+o}}a=xw}return new a(r,n)}function FU(e){return"-"+e.toLowerCase()}function $U(e){return e.charAt(1).toUpperCase()}const zU=ck([dk,PU,pk,mk,gk],"html"),bw=ck([dk,IU,pk,mk,gk],"svg");function BU(e){return e.join(" ").trim()}var Sh={},o0,jj;function UU(){if(jj)return o0;jj=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=/\n/g,t=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,a=/^:\s*/,l=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,o=/^[;\s]*/,f=/^\s+|\s+$/g,u=`
`,d="/",h="*",g="",b="comment",v="declaration";o0=function(k,T){if(typeof k!="string")throw new TypeError("First argument must be a string");if(!k)return[];T=T||{};var E=1,P=1;function I(ee){var Z=ee.match(n);Z&&(E+=Z.length);var te=ee.lastIndexOf(u);P=~te?ee.length-te:P+ee.length}function V(){var ee={line:E,column:P};return function(Z){return Z.position=new F(ee),U(),Z}}function F(ee){this.start=ee,this.end={line:E,column:P},this.source=T.source}F.prototype.content=k;function O(ee){var Z=new Error(T.source+":"+E+":"+P+": "+ee);if(Z.reason=ee,Z.filename=T.source,Z.line=E,Z.column=P,Z.source=k,!T.silent)throw Z}function B(ee){var Z=ee.exec(k);if(Z){var te=Z[0];return I(te),k=k.slice(te.length),Z}}function U(){B(t)}function z(ee){var Z;for(ee=ee||[];Z=$();)Z!==!1&&ee.push(Z);return ee}function $(){var ee=V();if(!(d!=k.charAt(0)||h!=k.charAt(1))){for(var Z=2;g!=k.charAt(Z)&&(h!=k.charAt(Z)||d!=k.charAt(Z+1));)++Z;if(Z+=2,g===k.charAt(Z-1))return O("End of comment missing");var te=k.slice(2,Z-2);return P+=2,I(te),k=k.slice(Z),P+=2,ee({type:b,comment:te})}}function R(){var ee=V(),Z=B(r);if(Z){if($(),!B(a))return O("property missing ':'");var te=B(l),Q=ee({type:v,property:S(Z[0].replace(e,g)),value:te?S(te[0].replace(e,g)):g});return B(o),Q}}function H(){var ee=[];z(ee);for(var Z;Z=R();)Z!==!1&&(ee.push(Z),z(ee));return ee}return U(),H()};function S(k){return k?k.replace(f,g):g}return o0}var Cj;function qU(){if(Cj)return Sh;Cj=1;var e=Sh&&Sh.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Sh,"__esModule",{value:!0}),Sh.default=t;var n=e(UU());function t(r,a){var l=null;if(!r||typeof r!="string")return l;var o=(0,n.default)(r),f=typeof a=="function";return o.forEach(function(u){if(u.type==="declaration"){var d=u.property,h=u.value;f?a(d,h,u):h&&(l=l||{},l[d]=h)}}),l}return Sh}var Lm={},_j;function VU(){if(_j)return Lm;_j=1,Object.defineProperty(Lm,"__esModule",{value:!0}),Lm.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,n=/-([a-z])/g,t=/^[^-]+$/,r=/^-(webkit|moz|ms|o|khtml)-/,a=/^-(ms)-/,l=function(d){return!d||t.test(d)||e.test(d)},o=function(d,h){return h.toUpperCase()},f=function(d,h){return"".concat(h,"-")},u=function(d,h){return h===void 0&&(h={}),l(d)?d:(d=d.toLowerCase(),h.reactCompat?d=d.replace(a,f):d=d.replace(r,f),d.replace(n,o))};return Lm.camelCase=u,Lm}var Om,kj;function HU(){if(kj)return Om;kj=1;var e=Om&&Om.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},n=e(qU()),t=VU();function r(a,l){var o={};return!a||typeof a!="string"||(0,n.default)(a,function(f,u){f&&u&&(o[(0,t.camelCase)(f,l)]=u)}),o}return r.default=r,Om=r,Om}var GU=HU();const YU=Gd(GU),yk=xk("end"),vw=xk("start");function xk(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function WU(e){const n=vw(e),t=yk(e);if(n&&t)return{start:n,end:t}}function Gm(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?Ej(e.position):"start"in e||"end"in e?Ej(e):"line"in e||"column"in e?g1(e):""}function g1(e){return Tj(e&&e.line)+":"+Tj(e&&e.column)}function Ej(e){return g1(e&&e.start)+"-"+g1(e&&e.end)}function Tj(e){return e&&typeof e=="number"?e:1}let Lr=class extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",l={},o=!1;if(t&&("line"in t&&"column"in t?l={place:t}:"start"in t&&"end"in t?l={place:t}:"type"in t?l={ancestors:[t],place:t.position}:l={...t}),typeof n=="string"?a=n:!l.cause&&n&&(o=!0,a=n.message,l.cause=n),!l.ruleId&&!l.source&&typeof r=="string"){const u=r.indexOf(":");u===-1?l.ruleId=r:(l.source=r.slice(0,u),l.ruleId=r.slice(u+1))}if(!l.place&&l.ancestors&&l.ancestors){const u=l.ancestors[l.ancestors.length-1];u&&(l.place=u.position)}const f=l.place&&"start"in l.place?l.place.start:l.place;this.ancestors=l.ancestors||void 0,this.cause=l.cause||void 0,this.column=f?f.column:void 0,this.fatal=void 0,this.file,this.message=a,this.line=f?f.line:void 0,this.name=Gm(l.place)||"1:1",this.place=l.place||void 0,this.reason=this.message,this.ruleId=l.ruleId||void 0,this.source=l.source||void 0,this.stack=o&&l.cause&&typeof l.cause.stack=="string"?l.cause.stack:"",this.actual,this.expected,this.note,this.url}};Lr.prototype.file="";Lr.prototype.name="";Lr.prototype.reason="";Lr.prototype.message="";Lr.prototype.stack="";Lr.prototype.column=void 0;Lr.prototype.line=void 0;Lr.prototype.ancestors=void 0;Lr.prototype.cause=void 0;Lr.prototype.fatal=void 0;Lr.prototype.place=void 0;Lr.prototype.ruleId=void 0;Lr.prototype.source=void 0;const ww={}.hasOwnProperty,QU=new Map,JU=/[A-Z]/g,KU=new Set(["table","tbody","thead","tfoot","tr"]),XU=new Set(["td","th"]),bk="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function ZU(e,n){if(!n||n.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=n.filePath||void 0;let r;if(n.development){if(typeof n.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=l9(t,n.jsxDEV)}else{if(typeof n.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof n.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=s9(t,n.jsx,n.jsxs)}const a={Fragment:n.Fragment,ancestors:[],components:n.components||{},create:r,elementAttributeNameCase:n.elementAttributeNameCase||"react",evaluater:n.createEvaluater?n.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:n.ignoreInvalidStyle||!1,passKeys:n.passKeys!==!1,passNode:n.passNode||!1,schema:n.space==="svg"?bw:zU,stylePropertyNameCase:n.stylePropertyNameCase||"dom",tableCellAlignToStyle:n.tableCellAlignToStyle!==!1},l=vk(a,e,void 0);return l&&typeof l!="string"?l:a.create(e,a.Fragment,{children:l||void 0},void 0)}function vk(e,n,t){if(n.type==="element")return e9(e,n,t);if(n.type==="mdxFlowExpression"||n.type==="mdxTextExpression")return t9(e,n);if(n.type==="mdxJsxFlowElement"||n.type==="mdxJsxTextElement")return i9(e,n,t);if(n.type==="mdxjsEsm")return n9(e,n);if(n.type==="root")return r9(e,n,t);if(n.type==="text")return a9(e,n)}function e9(e,n,t){const r=e.schema;let a=r;n.tagName.toLowerCase()==="svg"&&r.space==="html"&&(a=bw,e.schema=a),e.ancestors.push(n);const l=Nk(e,n.tagName,!1),o=o9(e,n);let f=Sw(e,n);return KU.has(n.tagName)&&(f=f.filter(function(u){return typeof u=="string"?!AU(u):!0})),wk(e,o,l,n),Nw(o,f),e.ancestors.pop(),e.schema=r,e.create(n,l,o,t)}function t9(e,n){if(n.data&&n.data.estree&&e.evaluater){const r=n.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}ag(e,n.position)}function n9(e,n){if(n.data&&n.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(n.data.estree);ag(e,n.position)}function i9(e,n,t){const r=e.schema;let a=r;n.name==="svg"&&r.space==="html"&&(a=bw,e.schema=a),e.ancestors.push(n);const l=n.name===null?e.Fragment:Nk(e,n.name,!0),o=c9(e,n),f=Sw(e,n);return wk(e,o,l,n),Nw(o,f),e.ancestors.pop(),e.schema=r,e.create(n,l,o,t)}function r9(e,n,t){const r={};return Nw(r,Sw(e,n)),e.create(n,e.Fragment,r,t)}function a9(e,n){return n.value}function wk(e,n,t,r){typeof t!="string"&&t!==e.Fragment&&e.passNode&&(n.node=r)}function Nw(e,n){if(n.length>0){const t=n.length>1?n:n[0];t&&(e.children=t)}}function s9(e,n,t){return r;function r(a,l,o,f){const d=Array.isArray(o.children)?t:n;return f?d(l,o,f):d(l,o)}}function l9(e,n){return t;function t(r,a,l,o){const f=Array.isArray(l.children),u=vw(r);return n(a,l,o,f,{columnNumber:u?u.column-1:void 0,fileName:e,lineNumber:u?u.line:void 0},void 0)}}function o9(e,n){const t={};let r,a;for(a in n.properties)if(a!=="children"&&ww.call(n.properties,a)){const l=u9(e,a,n.properties[a]);if(l){const[o,f]=l;e.tableCellAlignToStyle&&o==="align"&&typeof f=="string"&&XU.has(n.tagName)?r=f:t[o]=f}}if(r){const l=t.style||(t.style={});l[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return t}function c9(e,n){const t={};for(const r of n.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const l=r.data.estree.body[0];l.type;const o=l.expression;o.type;const f=o.properties[0];f.type,Object.assign(t,e.evaluater.evaluateExpression(f.argument))}else ag(e,n.position);else{const a=r.name;let l;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const f=r.value.data.estree.body[0];f.type,l=e.evaluater.evaluateExpression(f.expression)}else ag(e,n.position);else l=r.value===null?!0:r.value;t[a]=l}return t}function Sw(e,n){const t=[];let r=-1;const a=e.passKeys?new Map:QU;for(;++r<n.children.length;){const l=n.children[r];let o;if(e.passKeys){const u=l.type==="element"?l.tagName:l.type==="mdxJsxFlowElement"||l.type==="mdxJsxTextElement"?l.name:void 0;if(u){const d=a.get(u)||0;o=u+"-"+d,a.set(u,d+1)}}const f=vk(e,l,o);f!==void 0&&t.push(f)}return t}function u9(e,n,t){const r=OU(e.schema,n);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=r.commaSeparated?CU(t):BU(t)),r.property==="style"){let a=typeof t=="object"?t:d9(e,String(t));return e.stylePropertyNameCase==="css"&&(a=f9(a)),["style",a]}return[e.elementAttributeNameCase==="react"&&r.space?MU[r.property]||r.property:r.attribute,t]}}function d9(e,n){try{return YU(n,{reactCompat:!0})}catch(t){if(e.ignoreInvalidStyle)return{};const r=t,a=new Lr("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=e.filePath||void 0,a.url=bk+"#cannot-parse-style-attribute",a}}function Nk(e,n,t){let r;if(!t)r={type:"Literal",value:n};else if(n.includes(".")){const a=n.split(".");let l=-1,o;for(;++l<a.length;){const f=vj(a[l])?{type:"Identifier",name:a[l]}:{type:"Literal",value:a[l]};o=o?{type:"MemberExpression",object:o,property:f,computed:!!(l&&f.type==="Literal"),optional:!1}:f}r=o}else r=vj(n)&&!/^[a-z]/.test(n)?{type:"Identifier",name:n}:{type:"Literal",value:n};if(r.type==="Literal"){const a=r.value;return ww.call(e.components,a)?e.components[a]:a}if(e.evaluater)return e.evaluater.evaluateExpression(r);ag(e)}function ag(e,n){const t=new Lr("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:n,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=e.filePath||void 0,t.url=bk+"#cannot-handle-mdx-estrees-without-createevaluater",t}function f9(e){const n={};let t;for(t in e)ww.call(e,t)&&(n[h9(t)]=e[t]);return n}function h9(e){let n=e.replace(JU,p9);return n.slice(0,3)==="ms-"&&(n="-"+n),n}function p9(e){return"-"+e.toLowerCase()}const c0={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},m9={};function jw(e,n){const t=m9,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return Sk(e,r,a)}function Sk(e,n,t){if(g9(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return Aj(e.children,n,t)}return Array.isArray(e)?Aj(e,n,t):""}function Aj(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=Sk(e[a],n,t);return r.join("")}function g9(e){return!!(e&&typeof e=="object")}const Dj=document.createElement("i");function Cw(e){const n="&"+e+";";Dj.innerHTML=n;const t=Dj.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function Ba(e,n,t,r){const a=e.length;let l=0,o;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)o=Array.from(r),o.unshift(n,t),e.splice(...o);else for(t&&e.splice(n,t);l<r.length;)o=r.slice(l,l+1e4),o.unshift(n,0),e.splice(...o),l+=1e4,n+=1e4}function ds(e,n){return e.length>0?(Ba(e,e.length,0,n),e):n}const Pj={}.hasOwnProperty;function jk(e){const n={};let t=-1;for(;++t<e.length;)y9(n,e[t]);return n}function y9(e,n){let t;for(t in n){const a=(Pj.call(e,t)?e[t]:void 0)||(e[t]={}),l=n[t];let o;if(l)for(o in l){Pj.call(a,o)||(a[o]=[]);const f=l[o];x9(a[o],Array.isArray(f)?f:f?[f]:[])}}}function x9(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);Ba(e,0,0,r)}function Ck(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function Hs(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Wr=ou(/[A-Za-z]/),Ir=ou(/[\dA-Za-z]/),b9=ou(/[#-'*+\--9=?A-Z^-~]/);function hb(e){return e!==null&&(e<32||e===127)}const y1=ou(/\d/),v9=ou(/[\dA-Fa-f]/),w9=ou(/[!-/:-@[-`{-~]/);function Pt(e){return e!==null&&e<-2}function Xn(e){return e!==null&&(e<0||e===32)}function hn(e){return e===-2||e===-1||e===32}const Ob=ou(new RegExp("\\p{P}|\\p{S}","u")),Vd=ou(/\s/);function ou(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function Zh(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const l=e.charCodeAt(t);let o="";if(l===37&&Ir(e.charCodeAt(t+1))&&Ir(e.charCodeAt(t+2)))a=2;else if(l<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(l))||(o=String.fromCharCode(l));else if(l>55295&&l<57344){const f=e.charCodeAt(t+1);l<56320&&f>56319&&f<57344?(o=String.fromCharCode(l,f),a=1):o=""}else o=String.fromCharCode(l);o&&(n.push(e.slice(r,t),encodeURIComponent(o)),r=t+a+1,o=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function vn(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let l=0;return o;function o(u){return hn(u)?(e.enter(t),f(u)):n(u)}function f(u){return hn(u)&&l++<a?(e.consume(u),f):(e.exit(t),n(u))}}const N9={tokenize:S9};function S9(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(f){if(f===null){e.consume(f);return}return e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),vn(e,n,"linePrefix")}function a(f){return e.enter("paragraph"),l(f)}function l(f){const u=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=u),t=u,o(f)}function o(f){if(f===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(f);return}return Pt(f)?(e.consume(f),e.exit("chunkText"),l):(e.consume(f),o)}}const j9={tokenize:C9},Ij={tokenize:_9};function C9(e){const n=this,t=[];let r=0,a,l,o;return f;function f(I){if(r<t.length){const V=t[r];return n.containerState=V[1],e.attempt(V[0].continuation,u,d)(I)}return d(I)}function u(I){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&P();const V=n.events.length;let F=V,O;for(;F--;)if(n.events[F][0]==="exit"&&n.events[F][1].type==="chunkFlow"){O=n.events[F][1].end;break}E(r);let B=V;for(;B<n.events.length;)n.events[B][1].end={...O},B++;return Ba(n.events,F+1,0,n.events.slice(V)),n.events.length=B,d(I)}return f(I)}function d(I){if(r===t.length){if(!a)return b(I);if(a.currentConstruct&&a.currentConstruct.concrete)return S(I);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(Ij,h,g)(I)}function h(I){return a&&P(),E(r),b(I)}function g(I){return n.parser.lazy[n.now().line]=r!==t.length,o=n.now().offset,S(I)}function b(I){return n.containerState={},e.attempt(Ij,v,S)(I)}function v(I){return r++,t.push([n.currentConstruct,n.containerState]),b(I)}function S(I){if(I===null){a&&P(),E(0),e.consume(I);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:l}),k(I)}function k(I){if(I===null){T(e.exit("chunkFlow"),!0),E(0),e.consume(I);return}return Pt(I)?(e.consume(I),T(e.exit("chunkFlow")),r=0,n.interrupt=void 0,f):(e.consume(I),k)}function T(I,V){const F=n.sliceStream(I);if(V&&F.push(null),I.previous=l,l&&(l.next=I),l=I,a.defineSkip(I.start),a.write(F),n.parser.lazy[I.start.line]){let O=a.events.length;for(;O--;)if(a.events[O][1].start.offset<o&&(!a.events[O][1].end||a.events[O][1].end.offset>o))return;const B=n.events.length;let U=B,z,$;for(;U--;)if(n.events[U][0]==="exit"&&n.events[U][1].type==="chunkFlow"){if(z){$=n.events[U][1].end;break}z=!0}for(E(r),O=B;O<n.events.length;)n.events[O][1].end={...$},O++;Ba(n.events,U+1,0,n.events.slice(B)),n.events.length=O}}function E(I){let V=t.length;for(;V-- >I;){const F=t[V];n.containerState=F[1],F[0].exit.call(n,e)}t.length=I}function P(){a.write([null]),l=void 0,a=void 0,n.containerState._closeFlow=void 0}}function _9(e,n,t){return vn(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Hh(e){if(e===null||Xn(e)||Vd(e))return 1;if(Ob(e))return 2}function Fb(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const l=e[a].resolveAll;l&&!r.includes(l)&&(n=l(n,t),r.push(l))}return n}const x1={name:"attention",resolveAll:k9,tokenize:E9};function k9(e,n){let t=-1,r,a,l,o,f,u,d,h;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;u=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};Mj(g,-u),Mj(b,u),o={type:u>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},f={type:u>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},l={type:u>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:u>1?"strong":"emphasis",start:{...o.start},end:{...f.end}},e[r][1].end={...o.start},e[t][1].start={...f.end},d=[],e[r][1].end.offset-e[r][1].start.offset&&(d=ds(d,[["enter",e[r][1],n],["exit",e[r][1],n]])),d=ds(d,[["enter",a,n],["enter",o,n],["exit",o,n],["enter",l,n]]),d=ds(d,Fb(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),d=ds(d,[["exit",l,n],["enter",f,n],["exit",f,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(h=2,d=ds(d,[["enter",e[t][1],n],["exit",e[t][1],n]])):h=0,Ba(e,r-1,t-r+3,d),t=r+d.length-h-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function E9(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=Hh(r);let l;return o;function o(u){return l=u,e.enter("attentionSequence"),f(u)}function f(u){if(u===l)return e.consume(u),f;const d=e.exit("attentionSequence"),h=Hh(u),g=!h||h===2&&a||t.includes(u),b=!a||a===2&&h||t.includes(r);return d._open=!!(l===42?g:g&&(a||!b)),d._close=!!(l===42?b:b&&(h||!g)),n(u)}}function Mj(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const T9={name:"autolink",tokenize:A9};function A9(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),l}function l(v){return Wr(v)?(e.consume(v),o):v===64?t(v):d(v)}function o(v){return v===43||v===45||v===46||Ir(v)?(r=1,f(v)):d(v)}function f(v){return v===58?(e.consume(v),r=0,u):(v===43||v===45||v===46||Ir(v))&&r++<32?(e.consume(v),f):(r=0,d(v))}function u(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||hb(v)?t(v):(e.consume(v),u)}function d(v){return v===64?(e.consume(v),h):b9(v)?(e.consume(v),d):t(v)}function h(v){return Ir(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,h):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||Ir(v))&&r++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const mg={partial:!0,tokenize:D9};function D9(e,n,t){return r;function r(l){return hn(l)?vn(e,a,"linePrefix")(l):a(l)}function a(l){return l===null||Pt(l)?n(l):t(l)}}const _k={continuation:{tokenize:I9},exit:M9,name:"blockQuote",tokenize:P9};function P9(e,n,t){const r=this;return a;function a(o){if(o===62){const f=r.containerState;return f.open||(e.enter("blockQuote",{_container:!0}),f.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(o),e.exit("blockQuoteMarker"),l}return t(o)}function l(o){return hn(o)?(e.enter("blockQuotePrefixWhitespace"),e.consume(o),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(o))}}function I9(e,n,t){const r=this;return a;function a(o){return hn(o)?vn(e,l,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):l(o)}function l(o){return e.attempt(_k,n,t)(o)}}function M9(e){e.exit("blockQuote")}const kk={name:"characterEscape",tokenize:R9};function R9(e,n,t){return r;function r(l){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(l),e.exit("escapeMarker"),a}function a(l){return w9(l)?(e.enter("characterEscapeValue"),e.consume(l),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(l)}}const Ek={name:"characterReference",tokenize:L9};function L9(e,n,t){const r=this;let a=0,l,o;return f;function f(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),u}function u(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),d):(e.enter("characterReferenceValue"),l=31,o=Ir,h(g))}function d(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),l=6,o=v9,h):(e.enter("characterReferenceValue"),l=7,o=y1,h(g))}function h(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return o===Ir&&!Cw(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return o(g)&&a++<l?(e.consume(g),h):t(g)}}const Rj={partial:!0,tokenize:F9},Lj={concrete:!0,name:"codeFenced",tokenize:O9};function O9(e,n,t){const r=this,a={partial:!0,tokenize:F};let l=0,o=0,f;return u;function u(O){return d(O)}function d(O){const B=r.events[r.events.length-1];return l=B&&B[1].type==="linePrefix"?B[2].sliceSerialize(B[1],!0).length:0,f=O,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),h(O)}function h(O){return O===f?(o++,e.consume(O),h):o<3?t(O):(e.exit("codeFencedFenceSequence"),hn(O)?vn(e,g,"whitespace")(O):g(O))}function g(O){return O===null||Pt(O)?(e.exit("codeFencedFence"),r.interrupt?n(O):e.check(Rj,k,V)(O)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b(O))}function b(O){return O===null||Pt(O)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g(O)):hn(O)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),vn(e,v,"whitespace")(O)):O===96&&O===f?t(O):(e.consume(O),b)}function v(O){return O===null||Pt(O)?g(O):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S(O))}function S(O){return O===null||Pt(O)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g(O)):O===96&&O===f?t(O):(e.consume(O),S)}function k(O){return e.attempt(a,V,T)(O)}function T(O){return e.enter("lineEnding"),e.consume(O),e.exit("lineEnding"),E}function E(O){return l>0&&hn(O)?vn(e,P,"linePrefix",l+1)(O):P(O)}function P(O){return O===null||Pt(O)?e.check(Rj,k,V)(O):(e.enter("codeFlowValue"),I(O))}function I(O){return O===null||Pt(O)?(e.exit("codeFlowValue"),P(O)):(e.consume(O),I)}function V(O){return e.exit("codeFenced"),n(O)}function F(O,B,U){let z=0;return $;function $(te){return O.enter("lineEnding"),O.consume(te),O.exit("lineEnding"),R}function R(te){return O.enter("codeFencedFence"),hn(te)?vn(O,H,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(te):H(te)}function H(te){return te===f?(O.enter("codeFencedFenceSequence"),ee(te)):U(te)}function ee(te){return te===f?(z++,O.consume(te),ee):z>=o?(O.exit("codeFencedFenceSequence"),hn(te)?vn(O,Z,"whitespace")(te):Z(te)):U(te)}function Z(te){return te===null||Pt(te)?(O.exit("codeFencedFence"),B(te)):U(te)}}}function F9(e,n,t){const r=this;return a;function a(o){return o===null?t(o):(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),l)}function l(o){return r.parser.lazy[r.now().line]?t(o):n(o)}}const u0={name:"codeIndented",tokenize:z9},$9={partial:!0,tokenize:B9};function z9(e,n,t){const r=this;return a;function a(d){return e.enter("codeIndented"),vn(e,l,"linePrefix",5)(d)}function l(d){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?o(d):t(d)}function o(d){return d===null?u(d):Pt(d)?e.attempt($9,o,u)(d):(e.enter("codeFlowValue"),f(d))}function f(d){return d===null||Pt(d)?(e.exit("codeFlowValue"),o(d)):(e.consume(d),f)}function u(d){return e.exit("codeIndented"),n(d)}}function B9(e,n,t){const r=this;return a;function a(o){return r.parser.lazy[r.now().line]?t(o):Pt(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a):vn(e,l,"linePrefix",5)(o)}function l(o){const f=r.events[r.events.length-1];return f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?n(o):Pt(o)?a(o):t(o)}}const U9={name:"codeText",previous:V9,resolve:q9,tokenize:H9};function q9(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function V9(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function H9(e,n,t){let r=0,a,l;return o;function o(g){return e.enter("codeText"),e.enter("codeTextSequence"),f(g)}function f(g){return g===96?(e.consume(g),r++,f):(e.exit("codeTextSequence"),u(g))}function u(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),u):g===96?(l=e.enter("codeTextSequence"),a=0,h(g)):Pt(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),u):(e.enter("codeTextData"),d(g))}function d(g){return g===null||g===32||g===96||Pt(g)?(e.exit("codeTextData"),u(g)):(e.consume(g),d)}function h(g){return g===96?(e.consume(g),a++,h):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(l.type="codeTextData",d(g))}}let G9=class{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const l=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&Fm(this.left,r),l.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Fm(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Fm(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Fm(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Fm(this.left,t.reverse())}}};function Fm(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function Tk(e){const n={};let t=-1,r,a,l,o,f,u,d;const h=new G9(e);for(;++t<h.length;){for(;t in n;)t=n[t];if(r=h.get(t),t&&r[1].type==="chunkFlow"&&h.get(t-1)[1].type==="listItemPrefix"&&(u=r[1]._tokenizer.events,l=0,l<u.length&&u[l][1].type==="lineEndingBlank"&&(l+=2),l<u.length&&u[l][1].type==="content"))for(;++l<u.length&&u[l][1].type!=="content";)u[l][1].type==="chunkText"&&(u[l][1]._isInFirstContentOfListItem=!0,l++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,Y9(h,t)),t=n[t],d=!0);else if(r[1]._container){for(l=t,a=void 0;l--;)if(o=h.get(l),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(a&&(h.get(a)[1].type="lineEndingBlank"),o[1].type="lineEnding",a=l);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;a&&(r[1].end={...h.get(a)[1].start},f=h.slice(a,t),f.unshift(r),h.splice(a,t-a+1,f))}}return Ba(e,0,Number.POSITIVE_INFINITY,h.slice(0)),!d}function Y9(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const l=[];let o=t._tokenizer;o||(o=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const f=o.events,u=[],d={};let h,g,b=-1,v=t,S=0,k=0;const T=[k];for(;v;){for(;e.get(++a)[1]!==v;);l.push(a),v._tokenizer||(h=r.sliceStream(v),v.next||h.push(null),g&&o.defineSkip(v.start),v._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(h),v._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<f.length;)f[b][0]==="exit"&&f[b-1][0]==="enter"&&f[b][1].type===f[b-1][1].type&&f[b][1].start.line!==f[b][1].end.line&&(k=b+1,T.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(o.events=[],v?(v._tokenizer=void 0,v.previous=void 0):T.pop(),b=T.length;b--;){const E=f.slice(T[b],T[b+1]),P=l.pop();u.push([P,P+E.length-1]),e.splice(P,2,E)}for(u.reverse(),b=-1;++b<u.length;)d[S+u[b][0]]=S+u[b][1],S+=u[b][1]-u[b][0]-1;return d}const W9={resolve:J9,tokenize:K9},Q9={partial:!0,tokenize:X9};function J9(e){return Tk(e),e}function K9(e,n){let t;return r;function r(f){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(f)}function a(f){return f===null?l(f):Pt(f)?e.check(Q9,o,l)(f):(e.consume(f),a)}function l(f){return e.exit("chunkContent"),e.exit("content"),n(f)}function o(f){return e.consume(f),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function X9(e,n,t){const r=this;return a;function a(o){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),vn(e,l,"linePrefix")}function l(o){if(o===null||Pt(o))return t(o);const f=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?n(o):e.interrupt(r.parser.constructs.flow,t,n)(o)}}function Ak(e,n,t,r,a,l,o,f,u){const d=u||Number.POSITIVE_INFINITY;let h=0;return g;function g(E){return E===60?(e.enter(r),e.enter(a),e.enter(l),e.consume(E),e.exit(l),b):E===null||E===32||E===41||hb(E)?t(E):(e.enter(r),e.enter(o),e.enter(f),e.enter("chunkString",{contentType:"string"}),k(E))}function b(E){return E===62?(e.enter(l),e.consume(E),e.exit(l),e.exit(a),e.exit(r),n):(e.enter(f),e.enter("chunkString",{contentType:"string"}),v(E))}function v(E){return E===62?(e.exit("chunkString"),e.exit(f),b(E)):E===null||E===60||Pt(E)?t(E):(e.consume(E),E===92?S:v)}function S(E){return E===60||E===62||E===92?(e.consume(E),v):v(E)}function k(E){return!h&&(E===null||E===41||Xn(E))?(e.exit("chunkString"),e.exit(f),e.exit(o),e.exit(r),n(E)):h<d&&E===40?(e.consume(E),h++,k):E===41?(e.consume(E),h--,k):E===null||E===32||E===40||hb(E)?t(E):(e.consume(E),E===92?T:k)}function T(E){return E===40||E===41||E===92?(e.consume(E),k):k(E)}}function Dk(e,n,t,r,a,l){const o=this;let f=0,u;return d;function d(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(l),h}function h(v){return f>999||v===null||v===91||v===93&&!u||v===94&&!f&&"_hiddenFootnoteSupport"in o.parser.constructs?t(v):v===93?(e.exit(l),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):Pt(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),h):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||Pt(v)||f++>999?(e.exit("chunkString"),h(v)):(e.consume(v),u||(u=!hn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),f++,g):g(v)}}function Pk(e,n,t,r,a,l){let o;return f;function f(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),o=b===40?41:b,u):t(b)}function u(b){return b===o?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(l),d(b))}function d(b){return b===o?(e.exit(l),u(o)):b===null?t(b):Pt(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),vn(e,d,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),h(b))}function h(b){return b===o||b===null||Pt(b)?(e.exit("chunkString"),d(b)):(e.consume(b),b===92?g:h)}function g(b){return b===o||b===92?(e.consume(b),h):h(b)}}function Ym(e,n){let t;return r;function r(a){return Pt(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):hn(a)?vn(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const Z9={name:"definition",tokenize:t7},e7={partial:!0,tokenize:n7};function t7(e,n,t){const r=this;let a;return l;function l(v){return e.enter("definition"),o(v)}function o(v){return Dk.call(r,e,f,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function f(v){return a=Hs(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),u):t(v)}function u(v){return Xn(v)?Ym(e,d)(v):d(v)}function d(v){return Ak(e,h,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function h(v){return e.attempt(e7,g,g)(v)}function g(v){return hn(v)?vn(e,b,"whitespace")(v):b(v)}function b(v){return v===null||Pt(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function n7(e,n,t){return r;function r(f){return Xn(f)?Ym(e,a)(f):t(f)}function a(f){return Pk(e,l,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(f)}function l(f){return hn(f)?vn(e,o,"whitespace")(f):o(f)}function o(f){return f===null||Pt(f)?n(f):t(f)}}const i7={name:"hardBreakEscape",tokenize:r7};function r7(e,n,t){return r;function r(l){return e.enter("hardBreakEscape"),e.consume(l),a}function a(l){return Pt(l)?(e.exit("hardBreakEscape"),n(l)):t(l)}}const a7={name:"headingAtx",resolve:s7,tokenize:l7};function s7(e,n){let t=e.length-2,r=3,a,l;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},l={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},Ba(e,r,t-r+1,[["enter",a,n],["enter",l,n],["exit",l,n],["exit",a,n]])),e}function l7(e,n,t){let r=0;return a;function a(h){return e.enter("atxHeading"),l(h)}function l(h){return e.enter("atxHeadingSequence"),o(h)}function o(h){return h===35&&r++<6?(e.consume(h),o):h===null||Xn(h)?(e.exit("atxHeadingSequence"),f(h)):t(h)}function f(h){return h===35?(e.enter("atxHeadingSequence"),u(h)):h===null||Pt(h)?(e.exit("atxHeading"),n(h)):hn(h)?vn(e,f,"whitespace")(h):(e.enter("atxHeadingText"),d(h))}function u(h){return h===35?(e.consume(h),u):(e.exit("atxHeadingSequence"),f(h))}function d(h){return h===null||h===35||Xn(h)?(e.exit("atxHeadingText"),f(h)):(e.consume(h),d)}}const o7=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Oj=["pre","script","style","textarea"],c7={concrete:!0,name:"htmlFlow",resolveTo:f7,tokenize:h7},u7={partial:!0,tokenize:m7},d7={partial:!0,tokenize:p7};function f7(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function h7(e,n,t){const r=this;let a,l,o,f,u;return d;function d(M){return h(M)}function h(M){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(M),g}function g(M){return M===33?(e.consume(M),b):M===47?(e.consume(M),l=!0,k):M===63?(e.consume(M),a=3,r.interrupt?n:A):Wr(M)?(e.consume(M),o=String.fromCharCode(M),T):t(M)}function b(M){return M===45?(e.consume(M),a=2,v):M===91?(e.consume(M),a=5,f=0,S):Wr(M)?(e.consume(M),a=4,r.interrupt?n:A):t(M)}function v(M){return M===45?(e.consume(M),r.interrupt?n:A):t(M)}function S(M){const ce="CDATA[";return M===ce.charCodeAt(f++)?(e.consume(M),f===ce.length?r.interrupt?n:H:S):t(M)}function k(M){return Wr(M)?(e.consume(M),o=String.fromCharCode(M),T):t(M)}function T(M){if(M===null||M===47||M===62||Xn(M)){const ce=M===47,ve=o.toLowerCase();return!ce&&!l&&Oj.includes(ve)?(a=1,r.interrupt?n(M):H(M)):o7.includes(o.toLowerCase())?(a=6,ce?(e.consume(M),E):r.interrupt?n(M):H(M)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(M):l?P(M):I(M))}return M===45||Ir(M)?(e.consume(M),o+=String.fromCharCode(M),T):t(M)}function E(M){return M===62?(e.consume(M),r.interrupt?n:H):t(M)}function P(M){return hn(M)?(e.consume(M),P):$(M)}function I(M){return M===47?(e.consume(M),$):M===58||M===95||Wr(M)?(e.consume(M),V):hn(M)?(e.consume(M),I):$(M)}function V(M){return M===45||M===46||M===58||M===95||Ir(M)?(e.consume(M),V):F(M)}function F(M){return M===61?(e.consume(M),O):hn(M)?(e.consume(M),F):I(M)}function O(M){return M===null||M===60||M===61||M===62||M===96?t(M):M===34||M===39?(e.consume(M),u=M,B):hn(M)?(e.consume(M),O):U(M)}function B(M){return M===u?(e.consume(M),u=null,z):M===null||Pt(M)?t(M):(e.consume(M),B)}function U(M){return M===null||M===34||M===39||M===47||M===60||M===61||M===62||M===96||Xn(M)?F(M):(e.consume(M),U)}function z(M){return M===47||M===62||hn(M)?I(M):t(M)}function $(M){return M===62?(e.consume(M),R):t(M)}function R(M){return M===null||Pt(M)?H(M):hn(M)?(e.consume(M),R):t(M)}function H(M){return M===45&&a===2?(e.consume(M),Q):M===60&&a===1?(e.consume(M),q):M===62&&a===4?(e.consume(M),ie):M===63&&a===3?(e.consume(M),A):M===93&&a===5?(e.consume(M),ne):Pt(M)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(u7,se,ee)(M)):M===null||Pt(M)?(e.exit("htmlFlowData"),ee(M)):(e.consume(M),H)}function ee(M){return e.check(d7,Z,se)(M)}function Z(M){return e.enter("lineEnding"),e.consume(M),e.exit("lineEnding"),te}function te(M){return M===null||Pt(M)?ee(M):(e.enter("htmlFlowData"),H(M))}function Q(M){return M===45?(e.consume(M),A):H(M)}function q(M){return M===47?(e.consume(M),o="",W):H(M)}function W(M){if(M===62){const ce=o.toLowerCase();return Oj.includes(ce)?(e.consume(M),ie):H(M)}return Wr(M)&&o.length<8?(e.consume(M),o+=String.fromCharCode(M),W):H(M)}function ne(M){return M===93?(e.consume(M),A):H(M)}function A(M){return M===62?(e.consume(M),ie):M===45&&a===2?(e.consume(M),A):H(M)}function ie(M){return M===null||Pt(M)?(e.exit("htmlFlowData"),se(M)):(e.consume(M),ie)}function se(M){return e.exit("htmlFlow"),n(M)}}function p7(e,n,t){const r=this;return a;function a(o){return Pt(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),l):t(o)}function l(o){return r.parser.lazy[r.now().line]?t(o):n(o)}}function m7(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(mg,n,t)}}const g7={name:"htmlText",tokenize:y7};function y7(e,n,t){const r=this;let a,l,o;return f;function f(A){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(A),u}function u(A){return A===33?(e.consume(A),d):A===47?(e.consume(A),F):A===63?(e.consume(A),I):Wr(A)?(e.consume(A),U):t(A)}function d(A){return A===45?(e.consume(A),h):A===91?(e.consume(A),l=0,S):Wr(A)?(e.consume(A),P):t(A)}function h(A){return A===45?(e.consume(A),v):t(A)}function g(A){return A===null?t(A):A===45?(e.consume(A),b):Pt(A)?(o=g,q(A)):(e.consume(A),g)}function b(A){return A===45?(e.consume(A),v):g(A)}function v(A){return A===62?Q(A):A===45?b(A):g(A)}function S(A){const ie="CDATA[";return A===ie.charCodeAt(l++)?(e.consume(A),l===ie.length?k:S):t(A)}function k(A){return A===null?t(A):A===93?(e.consume(A),T):Pt(A)?(o=k,q(A)):(e.consume(A),k)}function T(A){return A===93?(e.consume(A),E):k(A)}function E(A){return A===62?Q(A):A===93?(e.consume(A),E):k(A)}function P(A){return A===null||A===62?Q(A):Pt(A)?(o=P,q(A)):(e.consume(A),P)}function I(A){return A===null?t(A):A===63?(e.consume(A),V):Pt(A)?(o=I,q(A)):(e.consume(A),I)}function V(A){return A===62?Q(A):I(A)}function F(A){return Wr(A)?(e.consume(A),O):t(A)}function O(A){return A===45||Ir(A)?(e.consume(A),O):B(A)}function B(A){return Pt(A)?(o=B,q(A)):hn(A)?(e.consume(A),B):Q(A)}function U(A){return A===45||Ir(A)?(e.consume(A),U):A===47||A===62||Xn(A)?z(A):t(A)}function z(A){return A===47?(e.consume(A),Q):A===58||A===95||Wr(A)?(e.consume(A),$):Pt(A)?(o=z,q(A)):hn(A)?(e.consume(A),z):Q(A)}function $(A){return A===45||A===46||A===58||A===95||Ir(A)?(e.consume(A),$):R(A)}function R(A){return A===61?(e.consume(A),H):Pt(A)?(o=R,q(A)):hn(A)?(e.consume(A),R):z(A)}function H(A){return A===null||A===60||A===61||A===62||A===96?t(A):A===34||A===39?(e.consume(A),a=A,ee):Pt(A)?(o=H,q(A)):hn(A)?(e.consume(A),H):(e.consume(A),Z)}function ee(A){return A===a?(e.consume(A),a=void 0,te):A===null?t(A):Pt(A)?(o=ee,q(A)):(e.consume(A),ee)}function Z(A){return A===null||A===34||A===39||A===60||A===61||A===96?t(A):A===47||A===62||Xn(A)?z(A):(e.consume(A),Z)}function te(A){return A===47||A===62||Xn(A)?z(A):t(A)}function Q(A){return A===62?(e.consume(A),e.exit("htmlTextData"),e.exit("htmlText"),n):t(A)}function q(A){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(A),e.exit("lineEnding"),W}function W(A){return hn(A)?vn(e,ne,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(A):ne(A)}function ne(A){return e.enter("htmlTextData"),o(A)}}const _w={name:"labelEnd",resolveAll:w7,resolveTo:N7,tokenize:S7},x7={tokenize:j7},b7={tokenize:C7},v7={tokenize:_7};function w7(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&Ba(e,0,e.length,t),e}function N7(e,n){let t=e.length,r=0,a,l,o,f;for(;t--;)if(a=e[t][1],l){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(o){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(l=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(o=t);const u={type:e[l][1].type==="labelLink"?"link":"image",start:{...e[l][1].start},end:{...e[e.length-1][1].end}},d={type:"label",start:{...e[l][1].start},end:{...e[o][1].end}},h={type:"labelText",start:{...e[l+r+2][1].end},end:{...e[o-2][1].start}};return f=[["enter",u,n],["enter",d,n]],f=ds(f,e.slice(l+1,l+r+3)),f=ds(f,[["enter",h,n]]),f=ds(f,Fb(n.parser.constructs.insideSpan.null,e.slice(l+r+4,o-3),n)),f=ds(f,[["exit",h,n],e[o-2],e[o-1],["exit",d,n]]),f=ds(f,e.slice(o+1)),f=ds(f,[["exit",u,n]]),Ba(e,l,e.length,f),e}function S7(e,n,t){const r=this;let a=r.events.length,l,o;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){l=r.events[a][1];break}return f;function f(b){return l?l._inactive?g(b):(o=r.parser.defined.includes(Hs(r.sliceSerialize({start:l.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),u):t(b)}function u(b){return b===40?e.attempt(x7,h,o?h:g)(b):b===91?e.attempt(b7,h,o?d:g)(b):o?h(b):g(b)}function d(b){return e.attempt(v7,h,g)(b)}function h(b){return n(b)}function g(b){return l._balanced=!0,t(b)}}function j7(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return Xn(g)?Ym(e,l)(g):l(g)}function l(g){return g===41?h(g):Ak(e,o,f,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function o(g){return Xn(g)?Ym(e,u)(g):h(g)}function f(g){return t(g)}function u(g){return g===34||g===39||g===40?Pk(e,d,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):h(g)}function d(g){return Xn(g)?Ym(e,h)(g):h(g)}function h(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function C7(e,n,t){const r=this;return a;function a(f){return Dk.call(r,e,l,o,"reference","referenceMarker","referenceString")(f)}function l(f){return r.parser.defined.includes(Hs(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(f):t(f)}function o(f){return t(f)}}function _7(e,n,t){return r;function r(l){return e.enter("reference"),e.enter("referenceMarker"),e.consume(l),e.exit("referenceMarker"),a}function a(l){return l===93?(e.enter("referenceMarker"),e.consume(l),e.exit("referenceMarker"),e.exit("reference"),n):t(l)}}const k7={name:"labelStartImage",resolveAll:_w.resolveAll,tokenize:E7};function E7(e,n,t){const r=this;return a;function a(f){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(f),e.exit("labelImageMarker"),l}function l(f){return f===91?(e.enter("labelMarker"),e.consume(f),e.exit("labelMarker"),e.exit("labelImage"),o):t(f)}function o(f){return f===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(f):n(f)}}const T7={name:"labelStartLink",resolveAll:_w.resolveAll,tokenize:A7};function A7(e,n,t){const r=this;return a;function a(o){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelLink"),l}function l(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(o):n(o)}}const d0={name:"lineEnding",tokenize:D7};function D7(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),vn(e,n,"linePrefix")}}const Gx={name:"thematicBreak",tokenize:P7};function P7(e,n,t){let r=0,a;return l;function l(d){return e.enter("thematicBreak"),o(d)}function o(d){return a=d,f(d)}function f(d){return d===a?(e.enter("thematicBreakSequence"),u(d)):r>=3&&(d===null||Pt(d))?(e.exit("thematicBreak"),n(d)):t(d)}function u(d){return d===a?(e.consume(d),r++,u):(e.exit("thematicBreakSequence"),hn(d)?vn(e,f,"whitespace")(d):f(d))}}const fa={continuation:{tokenize:L7},exit:F7,name:"list",tokenize:R7},I7={partial:!0,tokenize:$7},M7={partial:!0,tokenize:O7};function R7(e,n,t){const r=this,a=r.events[r.events.length-1];let l=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,o=0;return f;function f(v){const S=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:y1(v)){if(r.containerState.type||(r.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(Gx,t,d)(v):d(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),u(v)}return t(v)}function u(v){return y1(v)&&++o<10?(e.consume(v),u):(!r.interrupt||o<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),d(v)):t(v)}function d(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(mg,r.interrupt?t:h,e.attempt(I7,b,g))}function h(v){return r.containerState.initialBlankLine=!0,l++,b(v)}function g(v){return hn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=l+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function L7(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(mg,a,l);function a(f){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,vn(e,n,"listItemIndent",r.containerState.size+1)(f)}function l(f){return r.containerState.furtherBlankLines||!hn(f)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(f)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(M7,n,o)(f))}function o(f){return r.containerState._closeFlow=!0,r.interrupt=void 0,vn(e,e.attempt(fa,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(f)}}function O7(e,n,t){const r=this;return vn(e,a,"listItemIndent",r.containerState.size+1);function a(l){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?n(l):t(l)}}function F7(e){e.exit(this.containerState.type)}function $7(e,n,t){const r=this;return vn(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(l){const o=r.events[r.events.length-1];return!hn(l)&&o&&o[1].type==="listItemPrefixWhitespace"?n(l):t(l)}}const Fj={name:"setextUnderline",resolveTo:z7,tokenize:B7};function z7(e,n){let t=e.length,r,a,l;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!l&&e[t][1].type==="definition"&&(l=t);const o={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",l?(e.splice(a,0,["enter",o,n]),e.splice(l+1,0,["exit",e[r][1],n]),e[r][1].end={...e[l][1].end}):e[r][1]=o,e.push(["exit",o,n]),e}function B7(e,n,t){const r=this;let a;return l;function l(d){let h=r.events.length,g;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){g=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=d,o(d)):t(d)}function o(d){return e.enter("setextHeadingLineSequence"),f(d)}function f(d){return d===a?(e.consume(d),f):(e.exit("setextHeadingLineSequence"),hn(d)?vn(e,u,"lineSuffix")(d):u(d))}function u(d){return d===null||Pt(d)?(e.exit("setextHeadingLine"),n(d)):t(d)}}const U7={tokenize:q7};function q7(e){const n=this,t=e.attempt(mg,r,e.attempt(this.parser.constructs.flowInitial,a,vn(e,e.attempt(this.parser.constructs.flow,a,e.attempt(W9,a)),"linePrefix")));return t;function r(l){if(l===null){e.consume(l);return}return e.enter("lineEndingBlank"),e.consume(l),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(l){if(l===null){e.consume(l);return}return e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const V7={resolveAll:Mk()},H7=Ik("string"),G7=Ik("text");function Ik(e){return{resolveAll:Mk(e==="text"?Y7:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],l=t.attempt(a,o,f);return o;function o(h){return d(h)?l(h):f(h)}function f(h){if(h===null){t.consume(h);return}return t.enter("data"),t.consume(h),u}function u(h){return d(h)?(t.exit("data"),l(h)):(t.consume(h),u)}function d(h){if(h===null)return!0;const g=a[h];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function Mk(e){return n;function n(t,r){let a=-1,l;for(;++a<=t.length;)l===void 0?t[a]&&t[a][1].type==="data"&&(l=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==l+2&&(t[l][1].end=t[a-1][1].end,t.splice(l+2,a-l-2),a=l+2),l=void 0);return e?e(t,r):t}}function Y7(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let l=a.length,o=-1,f=0,u;for(;l--;){const d=a[l];if(typeof d=="string"){for(o=d.length;d.charCodeAt(o-1)===32;)f++,o--;if(o)break;o=-1}else if(d===-2)u=!0,f++;else if(d!==-1){l++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(f=0),f){const d={type:t===e.length||u||f<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:l?o:r.start._bufferIndex+o,_index:r.start._index+l,line:r.end.line,column:r.end.column-f,offset:r.end.offset-f},end:{...r.end}};r.end={...d.start},r.start.offset===r.end.offset?Object.assign(r,d):(e.splice(t,0,["enter",d,n],["exit",d,n]),t+=2)}t++}return e}const W7={42:fa,43:fa,45:fa,48:fa,49:fa,50:fa,51:fa,52:fa,53:fa,54:fa,55:fa,56:fa,57:fa,62:_k},Q7={91:Z9},J7={[-2]:u0,[-1]:u0,32:u0},K7={35:a7,42:Gx,45:[Fj,Gx],60:c7,61:Fj,95:Gx,96:Lj,126:Lj},X7={38:Ek,92:kk},Z7={[-5]:d0,[-4]:d0,[-3]:d0,33:k7,38:Ek,42:x1,60:[T9,g7],91:T7,92:[i7,kk],93:_w,95:x1,96:U9},eq={null:[x1,V7]},tq={null:[42,95]},nq={null:[]},iq=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:tq,contentInitial:Q7,disable:nq,document:W7,flow:K7,flowInitial:J7,insideSpan:eq,string:X7,text:Z7},Symbol.toStringTag,{value:"Module"}));function rq(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},l=[];let o=[],f=[];const u={attempt:B(F),check:B(O),consume:P,enter:I,exit:V,interrupt:B(O,{interrupt:!0})},d={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let h=n.tokenize.call(d,u);return n.resolveAll&&l.push(n),d;function g(R){return o=ds(o,R),T(),o[o.length-1]!==null?[]:(U(n,0),d.events=Fb(l,d.events,d),d.events)}function b(R,H){return sq(v(R),H)}function v(R){return aq(o,R)}function S(){const{_bufferIndex:R,_index:H,line:ee,column:Z,offset:te}=r;return{_bufferIndex:R,_index:H,line:ee,column:Z,offset:te}}function k(R){a[R.line]=R.column,$()}function T(){let R;for(;r._index<o.length;){const H=o[r._index];if(typeof H=="string")for(R=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===R&&r._bufferIndex<H.length;)E(H.charCodeAt(r._bufferIndex));else E(H)}}function E(R){h=h(R)}function P(R){Pt(R)?(r.line++,r.column=1,r.offset+=R===-3?2:1,$()):R!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),d.previous=R}function I(R,H){const ee=H||{};return ee.type=R,ee.start=S(),d.events.push(["enter",ee,d]),f.push(ee),ee}function V(R){const H=f.pop();return H.end=S(),d.events.push(["exit",H,d]),H}function F(R,H){U(R,H.from)}function O(R,H){H.restore()}function B(R,H){return ee;function ee(Z,te,Q){let q,W,ne,A;return Array.isArray(Z)?se(Z):"tokenize"in Z?se([Z]):ie(Z);function ie(le){return xe;function xe(ue){const ze=ue!==null&&le[ue],tt=ue!==null&&le.null,ft=[...Array.isArray(ze)?ze:ze?[ze]:[],...Array.isArray(tt)?tt:tt?[tt]:[]];return se(ft)(ue)}}function se(le){return q=le,W=0,le.length===0?Q:M(le[W])}function M(le){return xe;function xe(ue){return A=z(),ne=le,le.partial||(d.currentConstruct=le),le.name&&d.parser.constructs.disable.null.includes(le.name)?ve():le.tokenize.call(H?Object.assign(Object.create(d),H):d,u,ce,ve)(ue)}}function ce(le){return R(ne,A),te}function ve(le){return A.restore(),++W<q.length?M(q[W]):Q}}}function U(R,H){R.resolveAll&&!l.includes(R)&&l.push(R),R.resolve&&Ba(d.events,H,d.events.length-H,R.resolve(d.events.slice(H),d)),R.resolveTo&&(d.events=R.resolveTo(d.events,d))}function z(){const R=S(),H=d.previous,ee=d.currentConstruct,Z=d.events.length,te=Array.from(f);return{from:Z,restore:Q};function Q(){r=R,d.previous=H,d.currentConstruct=ee,d.events.length=Z,f=te,$()}}function $(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function aq(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,l=n.end._bufferIndex;let o;if(t===a)o=[e[t].slice(r,l)];else{if(o=e.slice(t,a),r>-1){const f=o[0];typeof f=="string"?o[0]=f.slice(r):o.shift()}l>0&&o.push(e[a].slice(0,l))}return o}function sq(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const l=e[t];let o;if(typeof l=="string")o=l;else switch(l){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=n?" ":"	";break}case-1:{if(!n&&a)continue;o=" ";break}default:o=String.fromCharCode(l)}a=l===-2,r.push(o)}return r.join("")}function lq(e){const r={constructs:jk([iq,...(e||{}).extensions||[]]),content:a(N9),defined:[],document:a(j9),flow:a(U7),lazy:{},string:a(H7),text:a(G7)};return r;function a(l){return o;function o(f){return rq(r,l,f)}}}function oq(e){for(;!Tk(e););return e}const $j=/[\0\t\n\r]/g;function cq(){let e=1,n="",t=!0,r;return a;function a(l,o,f){const u=[];let d,h,g,b,v;for(l=n+(typeof l=="string"?l.toString():new TextDecoder(o||void 0).decode(l)),g=0,n="",t&&(l.charCodeAt(0)===65279&&g++,t=void 0);g<l.length;){if($j.lastIndex=g,d=$j.exec(l),b=d&&d.index!==void 0?d.index:l.length,v=l.charCodeAt(b),!d){n=l.slice(g);break}if(v===10&&g===b&&r)u.push(-3),r=void 0;else switch(r&&(u.push(-5),r=void 0),g<b&&(u.push(l.slice(g,b)),e+=b-g),v){case 0:{u.push(65533),e++;break}case 9:{for(h=Math.ceil(e/4)*4,u.push(-2);e++<h;)u.push(-1);break}case 10:{u.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return f&&(r&&u.push(-5),n&&u.push(n),u.push(null)),u}}const uq=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function dq(e){return e.replace(uq,fq)}function fq(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),l=a===120||a===88;return Ck(t.slice(l?2:1),l?16:10)}return Cw(t)||e}const Rk={}.hasOwnProperty;function hq(e,n,t){return typeof n!="string"&&(t=n,n=void 0),pq(t)(oq(lq(t).document().write(cq()(e,n,!0))))}function pq(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:l(Je),autolinkProtocol:z,autolinkEmail:z,atxHeading:l(Ae),blockQuote:l(tt),characterEscape:z,characterReference:z,codeFenced:l(ft),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:l(ft,o),codeText:l(Re,o),codeTextData:z,data:z,codeFlowValue:z,definition:l(je),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:l(he),hardBreakEscape:l(we),hardBreakTrailing:l(we),htmlFlow:l(Me,o),htmlFlowData:z,htmlText:l(Me,o),htmlTextData:z,image:l(De),label:o,link:l(Je),listItem:l(Ge),listItemValue:b,listOrdered:l(nt,g),listUnordered:l(nt),paragraph:l(St),reference:M,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:l(Ae),strong:l(It),thematicBreak:l(oe)},exit:{atxHeading:u(),atxHeadingSequence:F,autolink:u(),autolinkEmail:ze,autolinkProtocol:ue,blockQuote:u(),characterEscapeValue:$,characterReferenceMarkerHexadecimal:ve,characterReferenceMarkerNumeric:ve,characterReferenceValue:le,characterReference:xe,codeFenced:u(T),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:$,codeIndented:u(E),codeText:u(te),codeTextData:$,data:$,definition:u(),definitionDestinationString:V,definitionLabelString:P,definitionTitleString:I,emphasis:u(),hardBreakEscape:u(H),hardBreakTrailing:u(H),htmlFlow:u(ee),htmlFlowData:$,htmlText:u(Z),htmlTextData:$,image:u(q),label:ne,labelText:W,lineEnding:R,link:u(Q),listItem:u(),listOrdered:u(),listUnordered:u(),paragraph:u(),referenceString:ce,resourceDestinationString:A,resourceTitleString:ie,resource:se,setextHeading:u(U),setextHeadingLineSequence:B,setextHeadingText:O,strong:u(),thematicBreak:u()}};Lk(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(J){let de={type:"root",children:[]};const Be={stack:[de],tokenStack:[],config:n,enter:f,exit:d,buffer:o,resume:h,data:t},be=[];let Fe=-1;for(;++Fe<J.length;)if(J[Fe][1].type==="listOrdered"||J[Fe][1].type==="listUnordered")if(J[Fe][0]==="enter")be.push(Fe);else{const $e=be.pop();Fe=a(J,$e,Fe)}for(Fe=-1;++Fe<J.length;){const $e=n[J[Fe][0]];Rk.call($e,J[Fe][1].type)&&$e[J[Fe][1].type].call(Object.assign({sliceSerialize:J[Fe][2].sliceSerialize},Be),J[Fe][1])}if(Be.tokenStack.length>0){const $e=Be.tokenStack[Be.tokenStack.length-1];($e[1]||zj).call(Be,void 0,$e[0])}for(de.position={start:Hc(J.length>0?J[0][1].start:{line:1,column:1,offset:0}),end:Hc(J.length>0?J[J.length-2][1].end:{line:1,column:1,offset:0})},Fe=-1;++Fe<n.transforms.length;)de=n.transforms[Fe](de)||de;return de}function a(J,de,Be){let be=de-1,Fe=-1,$e=!1,st,rt,Le,Ve;for(;++be<=Be;){const qe=J[be];switch(qe[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{qe[0]==="enter"?Fe++:Fe--,Ve=void 0;break}case"lineEndingBlank":{qe[0]==="enter"&&(st&&!Ve&&!Fe&&!Le&&(Le=be),Ve=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Ve=void 0}if(!Fe&&qe[0]==="enter"&&qe[1].type==="listItemPrefix"||Fe===-1&&qe[0]==="exit"&&(qe[1].type==="listUnordered"||qe[1].type==="listOrdered")){if(st){let Ke=be;for(rt=void 0;Ke--;){const We=J[Ke];if(We[1].type==="lineEnding"||We[1].type==="lineEndingBlank"){if(We[0]==="exit")continue;rt&&(J[rt][1].type="lineEndingBlank",$e=!0),We[1].type="lineEnding",rt=Ke}else if(!(We[1].type==="linePrefix"||We[1].type==="blockQuotePrefix"||We[1].type==="blockQuotePrefixWhitespace"||We[1].type==="blockQuoteMarker"||We[1].type==="listItemIndent"))break}Le&&(!rt||Le<rt)&&(st._spread=!0),st.end=Object.assign({},rt?J[rt][1].start:qe[1].end),J.splice(rt||be,0,["exit",st,qe[2]]),be++,Be++}if(qe[1].type==="listItemPrefix"){const Ke={type:"listItem",_spread:!1,start:Object.assign({},qe[1].start),end:void 0};st=Ke,J.splice(be,0,["enter",Ke,qe[2]]),be++,Be++,Le=void 0,Ve=!0}}}return J[de][1]._spread=$e,Be}function l(J,de){return Be;function Be(be){f.call(this,J(be),be),de&&de.call(this,be)}}function o(){this.stack.push({type:"fragment",children:[]})}function f(J,de,Be){this.stack[this.stack.length-1].children.push(J),this.stack.push(J),this.tokenStack.push([de,Be||void 0]),J.position={start:Hc(de.start),end:void 0}}function u(J){return de;function de(Be){J&&J.call(this,Be),d.call(this,Be)}}function d(J,de){const Be=this.stack.pop(),be=this.tokenStack.pop();if(be)be[0].type!==J.type&&(de?de.call(this,J,be[0]):(be[1]||zj).call(this,J,be[0]));else throw new Error("Cannot close `"+J.type+"` ("+Gm({start:J.start,end:J.end})+"): its not open");Be.position.end=Hc(J.end)}function h(){return jw(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(J){if(this.data.expectingFirstListItemValue){const de=this.stack[this.stack.length-2];de.start=Number.parseInt(this.sliceSerialize(J),10),this.data.expectingFirstListItemValue=void 0}}function v(){const J=this.resume(),de=this.stack[this.stack.length-1];de.lang=J}function S(){const J=this.resume(),de=this.stack[this.stack.length-1];de.meta=J}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const J=this.resume(),de=this.stack[this.stack.length-1];de.value=J.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function E(){const J=this.resume(),de=this.stack[this.stack.length-1];de.value=J.replace(/(\r?\n|\r)$/g,"")}function P(J){const de=this.resume(),Be=this.stack[this.stack.length-1];Be.label=de,Be.identifier=Hs(this.sliceSerialize(J)).toLowerCase()}function I(){const J=this.resume(),de=this.stack[this.stack.length-1];de.title=J}function V(){const J=this.resume(),de=this.stack[this.stack.length-1];de.url=J}function F(J){const de=this.stack[this.stack.length-1];if(!de.depth){const Be=this.sliceSerialize(J).length;de.depth=Be}}function O(){this.data.setextHeadingSlurpLineEnding=!0}function B(J){const de=this.stack[this.stack.length-1];de.depth=this.sliceSerialize(J).codePointAt(0)===61?1:2}function U(){this.data.setextHeadingSlurpLineEnding=void 0}function z(J){const Be=this.stack[this.stack.length-1].children;let be=Be[Be.length-1];(!be||be.type!=="text")&&(be=Vt(),be.position={start:Hc(J.start),end:void 0},Be.push(be)),this.stack.push(be)}function $(J){const de=this.stack.pop();de.value+=this.sliceSerialize(J),de.position.end=Hc(J.end)}function R(J){const de=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Be=de.children[de.children.length-1];Be.position.end=Hc(J.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(de.type)&&(z.call(this,J),$.call(this,J))}function H(){this.data.atHardBreak=!0}function ee(){const J=this.resume(),de=this.stack[this.stack.length-1];de.value=J}function Z(){const J=this.resume(),de=this.stack[this.stack.length-1];de.value=J}function te(){const J=this.resume(),de=this.stack[this.stack.length-1];de.value=J}function Q(){const J=this.stack[this.stack.length-1];if(this.data.inReference){const de=this.data.referenceType||"shortcut";J.type+="Reference",J.referenceType=de,delete J.url,delete J.title}else delete J.identifier,delete J.label;this.data.referenceType=void 0}function q(){const J=this.stack[this.stack.length-1];if(this.data.inReference){const de=this.data.referenceType||"shortcut";J.type+="Reference",J.referenceType=de,delete J.url,delete J.title}else delete J.identifier,delete J.label;this.data.referenceType=void 0}function W(J){const de=this.sliceSerialize(J),Be=this.stack[this.stack.length-2];Be.label=dq(de),Be.identifier=Hs(de).toLowerCase()}function ne(){const J=this.stack[this.stack.length-1],de=this.resume(),Be=this.stack[this.stack.length-1];if(this.data.inReference=!0,Be.type==="link"){const be=J.children;Be.children=be}else Be.alt=de}function A(){const J=this.resume(),de=this.stack[this.stack.length-1];de.url=J}function ie(){const J=this.resume(),de=this.stack[this.stack.length-1];de.title=J}function se(){this.data.inReference=void 0}function M(){this.data.referenceType="collapsed"}function ce(J){const de=this.resume(),Be=this.stack[this.stack.length-1];Be.label=de,Be.identifier=Hs(this.sliceSerialize(J)).toLowerCase(),this.data.referenceType="full"}function ve(J){this.data.characterReferenceType=J.type}function le(J){const de=this.sliceSerialize(J),Be=this.data.characterReferenceType;let be;Be?(be=Ck(de,Be==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):be=Cw(de);const Fe=this.stack[this.stack.length-1];Fe.value+=be}function xe(J){const de=this.stack.pop();de.position.end=Hc(J.end)}function ue(J){$.call(this,J);const de=this.stack[this.stack.length-1];de.url=this.sliceSerialize(J)}function ze(J){$.call(this,J);const de=this.stack[this.stack.length-1];de.url="mailto:"+this.sliceSerialize(J)}function tt(){return{type:"blockquote",children:[]}}function ft(){return{type:"code",lang:null,meta:null,value:""}}function Re(){return{type:"inlineCode",value:""}}function je(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function he(){return{type:"emphasis",children:[]}}function Ae(){return{type:"heading",depth:0,children:[]}}function we(){return{type:"break"}}function Me(){return{type:"html",value:""}}function De(){return{type:"image",title:null,url:"",alt:null}}function Je(){return{type:"link",title:null,url:"",children:[]}}function nt(J){return{type:"list",ordered:J.type==="listOrdered",start:null,spread:J._spread,children:[]}}function Ge(J){return{type:"listItem",spread:J._spread,checked:null,children:[]}}function St(){return{type:"paragraph",children:[]}}function It(){return{type:"strong",children:[]}}function Vt(){return{type:"text",value:""}}function oe(){return{type:"thematicBreak"}}}function Hc(e){return{line:e.line,column:e.column,offset:e.offset}}function Lk(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?Lk(e,r):mq(e,r)}}function mq(e,n){let t;for(t in n)if(Rk.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function zj(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+Gm({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+Gm({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+Gm({start:n.start,end:n.end})+") is still open")}function gq(e){const n=this;n.parser=t;function t(r){return hq(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}function yq(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function xq(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function bq(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function vq(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function wq(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Nq(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=Zh(r.toLowerCase()),l=e.footnoteOrder.indexOf(r);let o,f=e.footnoteCounts.get(r);f===void 0?(f=0,e.footnoteOrder.push(r),o=e.footnoteOrder.length):o=l+1,f+=1,e.footnoteCounts.set(r,f);const u={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(f>1?"-"+f:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};e.patch(n,u);const d={type:"element",tagName:"sup",properties:{},children:[u]};return e.patch(n,d),e.applyData(n,d)}function Sq(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function jq(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function Ok(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),l=a[0];l&&l.type==="text"?l.value="["+l.value:a.unshift({type:"text",value:"["});const o=a[a.length-1];return o&&o.type==="text"?o.value+=r:a.push({type:"text",value:r}),a}function Cq(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return Ok(e,n);const a={src:Zh(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const l={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,l),e.applyData(n,l)}function _q(e,n){const t={src:Zh(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function kq(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function Eq(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return Ok(e,n);const a={href:Zh(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const l={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,l),e.applyData(n,l)}function Tq(e,n){const t={href:Zh(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function Aq(e,n,t){const r=e.all(n),a=t?Dq(t):Fk(n),l={},o=[];if(typeof n.checked=="boolean"){const h=r[0];let g;h&&h.type==="element"&&h.tagName==="p"?g=h:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),l.className=["task-list-item"]}let f=-1;for(;++f<r.length;){const h=r[f];(a||f!==0||h.type!=="element"||h.tagName!=="p")&&o.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!a?o.push(...h.children):o.push(h)}const u=r[r.length-1];u&&(a||u.type!=="element"||u.tagName!=="p")&&o.push({type:"text",value:`
`});const d={type:"element",tagName:"li",properties:l,children:o};return e.patch(n,d),e.applyData(n,d)}function Dq(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=Fk(t[r])}return n}function Fk(e){const n=e.spread;return n??e.children.length>1}function Pq(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const o=r[a];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const l={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,l),e.applyData(n,l)}function Iq(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Mq(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function Rq(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Lq(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],o),a.push(o)}if(t.length>0){const o={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},f=vw(n.children[1]),u=yk(n.children[n.children.length-1]);f&&u&&(o.position={start:f,end:u}),a.push(o)}const l={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,l),e.applyData(n,l)}function Oq(e,n,t){const r=t?t.children:void 0,l=(r?r.indexOf(n):1)===0?"th":"td",o=t&&t.type==="table"?t.align:void 0,f=o?o.length:n.children.length;let u=-1;const d=[];for(;++u<f;){const g=n.children[u],b={},v=o?o[u]:void 0;v&&(b.align=v);let S={type:"element",tagName:l,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),d.push(S)}const h={type:"element",tagName:"tr",properties:{},children:e.wrap(d,!0)};return e.patch(n,h),e.applyData(n,h)}function Fq(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const Bj=9,Uj=32;function $q(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const l=[];for(;r;)l.push(qj(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return l.push(qj(n.slice(a),a>0,!1)),l.join("")}function qj(e,n,t){let r=0,a=e.length;if(n){let l=e.codePointAt(r);for(;l===Bj||l===Uj;)r++,l=e.codePointAt(r)}if(t){let l=e.codePointAt(a-1);for(;l===Bj||l===Uj;)a--,l=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function zq(e,n){const t={type:"text",value:$q(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function Bq(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const Uq={blockquote:yq,break:xq,code:bq,delete:vq,emphasis:wq,footnoteReference:Nq,heading:Sq,html:jq,imageReference:Cq,image:_q,inlineCode:kq,linkReference:Eq,link:Tq,listItem:Aq,list:Pq,paragraph:Iq,root:Mq,strong:Rq,table:Lq,tableCell:Fq,tableRow:Oq,text:zq,thematicBreak:Bq,toml:_x,yaml:_x,definition:_x,footnoteDefinition:_x};function _x(){}const $k=-1,$b=0,Wm=1,pb=2,kw=3,Ew=4,Tw=5,Aw=6,zk=7,Bk=8,Vj=typeof self=="object"?self:globalThis,qq=(e,n)=>{const t=(a,l)=>(e.set(l,a),a),r=a=>{if(e.has(a))return e.get(a);const[l,o]=n[a];switch(l){case $b:case $k:return t(o,a);case Wm:{const f=t([],a);for(const u of o)f.push(r(u));return f}case pb:{const f=t({},a);for(const[u,d]of o)f[r(u)]=r(d);return f}case kw:return t(new Date(o),a);case Ew:{const{source:f,flags:u}=o;return t(new RegExp(f,u),a)}case Tw:{const f=t(new Map,a);for(const[u,d]of o)f.set(r(u),r(d));return f}case Aw:{const f=t(new Set,a);for(const u of o)f.add(r(u));return f}case zk:{const{name:f,message:u}=o;return t(new Vj[f](u),a)}case Bk:return t(BigInt(o),a);case"BigInt":return t(Object(BigInt(o)),a);case"ArrayBuffer":return t(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:f}=new Uint8Array(o);return t(new DataView(f),o)}}return t(new Vj[l](o),a)};return r},Hj=e=>qq(new Map,e)(0),jh="",{toString:Vq}={},{keys:Hq}=Object,$m=e=>{const n=typeof e;if(n!=="object"||!e)return[$b,n];const t=Vq.call(e).slice(8,-1);switch(t){case"Array":return[Wm,jh];case"Object":return[pb,jh];case"Date":return[kw,jh];case"RegExp":return[Ew,jh];case"Map":return[Tw,jh];case"Set":return[Aw,jh];case"DataView":return[Wm,t]}return t.includes("Array")?[Wm,t]:t.includes("Error")?[zk,t]:[pb,t]},kx=([e,n])=>e===$b&&(n==="function"||n==="symbol"),Gq=(e,n,t,r)=>{const a=(o,f)=>{const u=r.push(o)-1;return t.set(f,u),u},l=o=>{if(t.has(o))return t.get(o);let[f,u]=$m(o);switch(f){case $b:{let h=o;switch(u){case"bigint":f=Bk,h=o.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+u);h=null;break;case"undefined":return a([$k],o)}return a([f,h],o)}case Wm:{if(u){let b=o;return u==="DataView"?b=new Uint8Array(o.buffer):u==="ArrayBuffer"&&(b=new Uint8Array(o)),a([u,[...b]],o)}const h=[],g=a([f,h],o);for(const b of o)h.push(l(b));return g}case pb:{if(u)switch(u){case"BigInt":return a([u,o.toString()],o);case"Boolean":case"Number":case"String":return a([u,o.valueOf()],o)}if(n&&"toJSON"in o)return l(o.toJSON());const h=[],g=a([f,h],o);for(const b of Hq(o))(e||!kx($m(o[b])))&&h.push([l(b),l(o[b])]);return g}case kw:return a([f,o.toISOString()],o);case Ew:{const{source:h,flags:g}=o;return a([f,{source:h,flags:g}],o)}case Tw:{const h=[],g=a([f,h],o);for(const[b,v]of o)(e||!(kx($m(b))||kx($m(v))))&&h.push([l(b),l(v)]);return g}case Aw:{const h=[],g=a([f,h],o);for(const b of o)(e||!kx($m(b)))&&h.push(l(b));return g}}const{message:d}=o;return a([f,{name:u,message:d}],o)};return l},Gj=(e,{json:n,lossy:t}={})=>{const r=[];return Gq(!(n||t),!!n,new Map,r)(e),r},mb=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?Hj(Gj(e,n)):structuredClone(e):(e,n)=>Hj(Gj(e,n));function Yq(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function Wq(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function Qq(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||Yq,r=e.options.footnoteBackLabel||Wq,a=e.options.footnoteLabel||"Footnotes",l=e.options.footnoteLabelTagName||"h2",o=e.options.footnoteLabelProperties||{className:["sr-only"]},f=[];let u=-1;for(;++u<e.footnoteOrder.length;){const d=e.footnoteById.get(e.footnoteOrder[u]);if(!d)continue;const h=e.all(d),g=String(d.identifier).toUpperCase(),b=Zh(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let P=typeof t=="string"?t:t(u,v);typeof P=="string"&&(P={type:"text",value:P}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(u,v),className:["data-footnote-backref"]},children:Array.isArray(P)?P:[P]})}const T=h[h.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const P=T.children[T.children.length-1];P&&P.type==="text"?P.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...S)}else h.push(...S);const E={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(h,!0)};e.patch(d,E),f.push(E)}if(f.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:l,properties:{...mb(o),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(f,!0)},{type:"text",value:`
`}]}}const zb=function(e){if(e==null)return Zq;if(typeof e=="function")return Bb(e);if(typeof e=="object")return Array.isArray(e)?Jq(e):Kq(e);if(typeof e=="string")return Xq(e);throw new Error("Expected function, string, or object as test")};function Jq(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=zb(e[t]);return Bb(r);function r(...a){let l=-1;for(;++l<n.length;)if(n[l].apply(this,a))return!0;return!1}}function Kq(e){const n=e;return Bb(t);function t(r){const a=r;let l;for(l in e)if(a[l]!==n[l])return!1;return!0}}function Xq(e){return Bb(n);function n(t){return t&&t.type===e}}function Bb(e){return n;function n(t,r,a){return!!(eV(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function Zq(){return!0}function eV(e){return e!==null&&typeof e=="object"&&"type"in e}const Uk=[],tV=!0,b1=!1,nV="skip";function qk(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const l=zb(a),o=r?-1:1;f(e,void 0,[])();function f(u,d,h){const g=u&&typeof u=="object"?u:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(u.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=Uk,S,k,T;if((!n||l(u,d,h[h.length-1]||void 0))&&(v=iV(t(u,h)),v[0]===b1))return v;if("children"in u&&u.children){const E=u;if(E.children&&v[0]!==nV)for(k=(r?E.children.length:-1)+o,T=h.concat(E);k>-1&&k<E.children.length;){const P=E.children[k];if(S=f(P,k,T)(),S[0]===b1)return S;k=typeof S[1]=="number"?S[1]:k+o}}return v}}}function iV(e){return Array.isArray(e)?e:typeof e=="number"?[tV,e]:e==null?Uk:[e]}function Dw(e,n,t,r){let a,l,o;typeof n=="function"?(l=void 0,o=n,a=t):(l=n,o=t,a=r),qk(e,l,f,a);function f(u,d){const h=d[d.length-1],g=h?h.children.indexOf(u):void 0;return o(u,g,h)}}const v1={}.hasOwnProperty,rV={};function aV(e,n){const t=n||rV,r=new Map,a=new Map,l=new Map,o={...Uq,...t.handlers},f={all:d,applyData:lV,definitionById:r,footnoteById:a,footnoteCounts:l,footnoteOrder:[],handlers:o,one:u,options:t,patch:sV,wrap:cV};return Dw(e,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const g=h.type==="definition"?r:a,b=String(h.identifier).toUpperCase();g.has(b)||g.set(b,h)}}),f;function u(h,g){const b=h.type,v=f.handlers[b];if(v1.call(f.handlers,b)&&v)return v(f,h,g);if(f.options.passThrough&&f.options.passThrough.includes(b)){if("children"in h){const{children:k,...T}=h,E=mb(T);return E.children=f.all(h),E}return mb(h)}return(f.options.unknownHandler||oV)(f,h,g)}function d(h){const g=[];if("children"in h){const b=h.children;let v=-1;for(;++v<b.length;){const S=f.one(b[v],h);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=Yj(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=Yj(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function sV(e,n){e.position&&(n.position=WU(e))}function lV(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,l=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const o="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:o}}t.type==="element"&&l&&Object.assign(t.properties,mb(l)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function oV(e,n){const t=n.data||{},r="value"in n&&!(v1.call(t,"hProperties")||v1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function cV(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function Yj(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function Wj(e,n){const t=aV(e,n),r=t.one(e,void 0),a=Qq(t),l=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&l.children.push({type:"text",value:`
`},a),l}function uV(e,n){return e&&"run"in e?async function(t,r){const a=Wj(t,{file:r,...n});await e.run(a,r)}:function(t,r){return Wj(t,{file:r,...e||n})}}function Qj(e){if(e)throw e}var f0,Jj;function dV(){if(Jj)return f0;Jj=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(d){return typeof Array.isArray=="function"?Array.isArray(d):n.call(d)==="[object Array]"},l=function(d){if(!d||n.call(d)!=="[object Object]")return!1;var h=e.call(d,"constructor"),g=d.constructor&&d.constructor.prototype&&e.call(d.constructor.prototype,"isPrototypeOf");if(d.constructor&&!h&&!g)return!1;var b;for(b in d);return typeof b>"u"||e.call(d,b)},o=function(d,h){t&&h.name==="__proto__"?t(d,h.name,{enumerable:!0,configurable:!0,value:h.newValue,writable:!0}):d[h.name]=h.newValue},f=function(d,h){if(h==="__proto__")if(e.call(d,h)){if(r)return r(d,h).value}else return;return d[h]};return f0=function u(){var d,h,g,b,v,S,k=arguments[0],T=1,E=arguments.length,P=!1;for(typeof k=="boolean"&&(P=k,k=arguments[1]||{},T=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});T<E;++T)if(d=arguments[T],d!=null)for(h in d)g=f(k,h),b=f(d,h),k!==b&&(P&&b&&(l(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&l(g)?g:{},o(k,{name:h,newValue:u(P,S,b)})):typeof b<"u"&&o(k,{name:h,newValue:b}));return k},f0}var fV=dV();const h0=Gd(fV);function w1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function hV(){const e=[],n={run:t,use:r};return n;function t(...a){let l=-1;const o=a.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);f(null,...a);function f(u,...d){const h=e[++l];let g=-1;if(u){o(u);return}for(;++g<a.length;)(d[g]===null||d[g]===void 0)&&(d[g]=a[g]);a=d,h?pV(h,f)(...d):o(null,...d)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function pV(e,n){let t;return r;function r(...o){const f=e.length>o.length;let u;f&&o.push(a);try{u=e.apply(this,o)}catch(d){const h=d;if(f&&t)throw h;return a(h)}f||(u&&u.then&&typeof u.then=="function"?u.then(l,a):u instanceof Error?a(u):l(u))}function a(o,...f){t||(t=!0,n(o,...f))}function l(o){a(null,o)}}const Fl={basename:mV,dirname:gV,extname:yV,join:xV,sep:"/"};function mV(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');gg(e);let t=0,r=-1,a=e.length,l;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(l){t=a+1;break}}else r<0&&(l=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let o=-1,f=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(l){t=a+1;break}}else o<0&&(l=!0,o=a+1),f>-1&&(e.codePointAt(a)===n.codePointAt(f--)?f<0&&(r=a):(f=-1,r=o));return t===r?r=o:r<0&&(r=e.length),e.slice(t,r)}function gV(e){if(gg(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function yV(e){gg(e);let n=e.length,t=-1,r=0,a=-1,l=0,o;for(;n--;){const f=e.codePointAt(n);if(f===47){if(o){r=n+1;break}continue}t<0&&(o=!0,t=n+1),f===46?a<0?a=n:l!==1&&(l=1):a>-1&&(l=-1)}return a<0||t<0||l===0||l===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function xV(...e){let n=-1,t;for(;++n<e.length;)gg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":bV(t)}function bV(e){gg(e);const n=e.codePointAt(0)===47;let t=vV(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function vV(e,n){let t="",r=0,a=-1,l=0,o=-1,f,u;for(;++o<=e.length;){if(o<e.length)f=e.codePointAt(o);else{if(f===47)break;f=47}if(f===47){if(!(a===o-1||l===1))if(a!==o-1&&l===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(u=t.lastIndexOf("/"),u!==t.length-1){u<0?(t="",r=0):(t=t.slice(0,u),r=t.length-1-t.lastIndexOf("/")),a=o,l=0;continue}}else if(t.length>0){t="",r=0,a=o,l=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,o):t=e.slice(a+1,o),r=o-a-1;a=o,l=0}else f===46&&l>-1?l++:l=-1}return t}function gg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const wV={cwd:NV};function NV(){return"/"}function N1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function SV(e){if(typeof e=="string")e=new URL(e);else if(!N1(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return jV(e)}function jV(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const p0=["history","path","basename","stem","extname","dirname"];let Vk=class{constructor(n){let t;n?N1(n)?t={path:n}:typeof n=="string"||CV(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":wV.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<p0.length;){const l=p0[r];l in t&&t[l]!==void 0&&t[l]!==null&&(this[l]=l==="history"?[...t[l]]:t[l])}let a;for(a in t)p0.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?Fl.basename(this.path):void 0}set basename(n){g0(n,"basename"),m0(n,"basename"),this.path=Fl.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?Fl.dirname(this.path):void 0}set dirname(n){Kj(this.basename,"dirname"),this.path=Fl.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?Fl.extname(this.path):void 0}set extname(n){if(m0(n,"extname"),Kj(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Fl.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){N1(n)&&(n=SV(n)),g0(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?Fl.basename(this.path,this.extname):void 0}set stem(n){g0(n,"stem"),m0(n,"stem"),this.path=Fl.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new Lr(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}};function m0(e,n){if(e&&e.includes(Fl.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+Fl.sep+"`")}function g0(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function Kj(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function CV(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const _V=function(e){const r=this.constructor.prototype,a=r[e],l=function(){return a.apply(l,arguments)};return Object.setPrototypeOf(l,r),l},kV={}.hasOwnProperty;let EV=class Hk extends _V{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=hV()}copy(){const n=new Hk;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data(h0(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(b0("data",this.frozen),this.namespace[n]=t,this):kV.call(this.namespace,n)&&this.namespace[n]||void 0:n?(b0("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=Ex(n),r=this.parser||this.Parser;return y0("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),y0("process",this.parser||this.Parser),x0("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(l,o){const f=Ex(n),u=r.parse(f);r.run(u,f,function(h,g,b){if(h||!g||!b)return d(h);const v=g,S=r.stringify(v,b);DV(S)?b.value=S:b.result=S,d(h,b)});function d(h,g){h||!g?o(h):l?l(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),y0("processSync",this.parser||this.Parser),x0("processSync",this.compiler||this.Compiler),this.process(n,a),Zj("processSync","process",t),r;function a(l,o){t=!0,Qj(l),r=o}}run(n,t,r){Xj(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?l(void 0,r):new Promise(l);function l(o,f){const u=Ex(t);a.run(n,u,d);function d(h,g,b){const v=g||n;h?f(h):o?o(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,l),Zj("runSync","run",r),a;function l(o,f){Qj(o),a=f,r=!0}}stringify(n,t){this.freeze();const r=Ex(t),a=this.compiler||this.Compiler;return x0("stringify",a),Xj(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(b0("use",this.frozen),n!=null)if(typeof n=="function")u(n,t);else if(typeof n=="object")Array.isArray(n)?f(n):o(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function l(d){if(typeof d=="function")u(d,[]);else if(typeof d=="object")if(Array.isArray(d)){const[h,...g]=d;u(h,g)}else o(d);else throw new TypeError("Expected usable value, not `"+d+"`")}function o(d){if(!("plugins"in d)&&!("settings"in d))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");f(d.plugins),d.settings&&(a.settings=h0(!0,a.settings,d.settings))}function f(d){let h=-1;if(d!=null)if(Array.isArray(d))for(;++h<d.length;){const g=d[h];l(g)}else throw new TypeError("Expected a list of plugins, not `"+d+"`")}function u(d,h){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===d){b=g;break}if(b===-1)r.push([d,...h]);else if(h.length>0){let[v,...S]=h;const k=r[b][1];w1(k)&&w1(v)&&(v=h0(!0,k,v)),r[b]=[d,v,...S]}}}};const TV=new EV().freeze();function y0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function x0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function b0(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function Xj(e){if(!w1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function Zj(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function Ex(e){return AV(e)?e:new Vk(e)}function AV(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function DV(e){return typeof e=="string"||PV(e)}function PV(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const IV="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",eC=[],tC={allowDangerousHtml:!0},MV=/^(https?|ircs?|mailto|xmpp)$/i,RV=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Kc(e){const n=LV(e),t=OV(e);return FV(n.runSync(n.parse(t),t),e)}function LV(e){const n=e.rehypePlugins||eC,t=e.remarkPlugins||eC,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...tC}:tC;return TV().use(gq).use(t).use(uV,r).use(n)}function OV(e){const n=e.children||"",t=new Vk;return typeof n=="string"&&(t.value=n),t}function FV(e,n){const t=n.allowedElements,r=n.allowElement,a=n.components,l=n.disallowedElements,o=n.skipHtml,f=n.unwrapDisallowed,u=n.urlTransform||$V;for(const h of RV)Object.hasOwn(n,h.from)&&(""+h.from+(h.to?"use `"+h.to+"` instead":"remove it")+IV+h.id,void 0);return Dw(e,d),ZU(e,{Fragment:i.Fragment,components:a,ignoreInvalidStyle:!0,jsx:i.jsx,jsxs:i.jsxs,passKeys:!0,passNode:!0});function d(h,g,b){if(h.type==="raw"&&b&&typeof g=="number")return o?b.children.splice(g,1):b.children[g]={type:"text",value:h.value},g;if(h.type==="element"){let v;for(v in c0)if(Object.hasOwn(c0,v)&&Object.hasOwn(h.properties,v)){const S=h.properties[v],k=c0[v];(k===null||k.includes(h.tagName))&&(h.properties[v]=u(String(S||""),v,h))}}if(h.type==="element"){let v=t?!t.includes(h.tagName):l?l.includes(h.tagName):!1;if(!v&&r&&typeof g=="number"&&(v=!r(h,g,b)),v&&b&&typeof g=="number")return f&&h.children?b.children.splice(g,1,...h.children):b.children.splice(g,1),g}}}function $V(e){const n=e.indexOf(":"),t=e.indexOf("?"),r=e.indexOf("#"),a=e.indexOf("/");return n===-1||a!==-1&&n>a||t!==-1&&n>t||r!==-1&&n>r||MV.test(e.slice(0,n))?e:""}function nC(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function zV(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function BV(e,n,t){const a=zb((t||{}).ignore||[]),l=UV(n);let o=-1;for(;++o<l.length;)qk(e,"text",f);function f(d,h){let g=-1,b;for(;++g<h.length;){const v=h[g],S=b?b.children:void 0;if(a(v,S?S.indexOf(v):void 0,b))return;b=v}if(b)return u(d,h)}function u(d,h){const g=h[h.length-1],b=l[o][0],v=l[o][1];let S=0;const T=g.children.indexOf(d);let E=!1,P=[];b.lastIndex=0;let I=b.exec(d.value);for(;I;){const V=I.index,F={index:I.index,input:I.input,stack:[...h,d]};let O=v(...I,F);if(typeof O=="string"&&(O=O.length>0?{type:"text",value:O}:void 0),O===!1?b.lastIndex=V+1:(S!==V&&P.push({type:"text",value:d.value.slice(S,V)}),Array.isArray(O)?P.push(...O):O&&P.push(O),S=V+I[0].length,E=!0),!b.global)break;I=b.exec(d.value)}return E?(S<d.value.length&&P.push({type:"text",value:d.value.slice(S)}),g.children.splice(T,1,...P)):P=[d],T+P.length}}function UV(e){const n=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const t=!e[0]||Array.isArray(e[0])?e:[e];let r=-1;for(;++r<t.length;){const a=t[r];n.push([qV(a[0]),VV(a[1])])}return n}function qV(e){return typeof e=="string"?new RegExp(zV(e),"g"):e}function VV(e){return typeof e=="function"?e:function(){return e}}const v0="phrasing",w0=["autolink","link","image","label"];function HV(){return{transforms:[XV],enter:{literalAutolink:YV,literalAutolinkEmail:N0,literalAutolinkHttp:N0,literalAutolinkWww:N0},exit:{literalAutolink:KV,literalAutolinkEmail:JV,literalAutolinkHttp:WV,literalAutolinkWww:QV}}}function GV(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:v0,notInConstruct:w0},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:v0,notInConstruct:w0},{character:":",before:"[ps]",after:"\\/",inConstruct:v0,notInConstruct:w0}]}}function YV(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function N0(e){this.config.enter.autolinkProtocol.call(this,e)}function WV(e){this.config.exit.autolinkProtocol.call(this,e)}function QV(e){this.config.exit.data.call(this,e);const n=this.stack[this.stack.length-1];n.type,n.url="http://"+this.sliceSerialize(e)}function JV(e){this.config.exit.autolinkEmail.call(this,e)}function KV(e){this.exit(e)}function XV(e){BV(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,ZV],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),eH]],{ignore:["link","linkReference"]})}function ZV(e,n,t,r,a){let l="";if(!Gk(a)||(/^w/i.test(n)&&(t=n+t,n="",l="http://"),!tH(t)))return!1;const o=nH(t+r);if(!o[0])return!1;const f={type:"link",title:null,url:l+n+o[0],children:[{type:"text",value:n+o[0]}]};return o[1]?[f,{type:"text",value:o[1]}]:f}function eH(e,n,t,r){return!Gk(r,!0)||/[-\d_]$/.test(t)?!1:{type:"link",title:null,url:"mailto:"+n+"@"+t,children:[{type:"text",value:n+"@"+t}]}}function tH(e){const n=e.split(".");return!(n.length<2||n[n.length-1]&&(/_/.test(n[n.length-1])||!/[a-zA-Z\d]/.test(n[n.length-1]))||n[n.length-2]&&(/_/.test(n[n.length-2])||!/[a-zA-Z\d]/.test(n[n.length-2])))}function nH(e){const n=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!n)return[e,void 0];e=e.slice(0,n.index);let t=n[0],r=t.indexOf(")");const a=nC(e,"(");let l=nC(e,")");for(;r!==-1&&a>l;)e+=t.slice(0,r+1),t=t.slice(r+1),r=t.indexOf(")"),l++;return[e,t]}function Gk(e,n){const t=e.input.charCodeAt(e.index-1);return(e.index===0||Vd(t)||Ob(t))&&(!n||t!==47)}Yk.peek=dH;function iH(){this.buffer()}function rH(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function aH(){this.buffer()}function sH(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function lH(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=Hs(this.sliceSerialize(e)).toLowerCase(),t.label=n}function oH(e){this.exit(e)}function cH(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=Hs(this.sliceSerialize(e)).toLowerCase(),t.label=n}function uH(e){this.exit(e)}function dH(){return"["}function Yk(e,n,t,r){const a=t.createTracker(r);let l=a.move("[^");const o=t.enter("footnoteReference"),f=t.enter("reference");return l+=a.move(t.safe(t.associationId(e),{after:"]",before:l})),f(),o(),l+=a.move("]"),l}function fH(){return{enter:{gfmFootnoteCallString:iH,gfmFootnoteCall:rH,gfmFootnoteDefinitionLabelString:aH,gfmFootnoteDefinition:sH},exit:{gfmFootnoteCallString:lH,gfmFootnoteCall:oH,gfmFootnoteDefinitionLabelString:cH,gfmFootnoteDefinition:uH}}}function hH(e){let n=!1;return e&&e.firstLineBlank&&(n=!0),{handlers:{footnoteDefinition:t,footnoteReference:Yk},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function t(r,a,l,o){const f=l.createTracker(o);let u=f.move("[^");const d=l.enter("footnoteDefinition"),h=l.enter("label");return u+=f.move(l.safe(l.associationId(r),{before:u,after:"]"})),h(),u+=f.move("]:"),r.children&&r.children.length>0&&(f.shift(4),u+=f.move((n?`
`:" ")+l.indentLines(l.containerFlow(r,f.current()),n?Wk:pH))),d(),u}}function pH(e,n,t){return n===0?e:Wk(e,n,t)}function Wk(e,n,t){return(t?"":"    ")+e}const mH=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];Qk.peek=vH;function gH(){return{canContainEols:["delete"],enter:{strikethrough:xH},exit:{strikethrough:bH}}}function yH(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:mH}],handlers:{delete:Qk}}}function xH(e){this.enter({type:"delete",children:[]},e)}function bH(e){this.exit(e)}function Qk(e,n,t,r){const a=t.createTracker(r),l=t.enter("strikethrough");let o=a.move("~~");return o+=t.containerPhrasing(e,{...a.current(),before:o,after:"~"}),o+=a.move("~~"),l(),o}function vH(){return"~"}function wH(e){return e.length}function NH(e,n){const t=n||{},r=(t.align||[]).concat(),a=t.stringLength||wH,l=[],o=[],f=[],u=[];let d=0,h=-1;for(;++h<e.length;){const k=[],T=[];let E=-1;for(e[h].length>d&&(d=e[h].length);++E<e[h].length;){const P=SH(e[h][E]);if(t.alignDelimiters!==!1){const I=a(P);T[E]=I,(u[E]===void 0||I>u[E])&&(u[E]=I)}k.push(P)}o[h]=k,f[h]=T}let g=-1;if(typeof r=="object"&&"length"in r)for(;++g<d;)l[g]=iC(r[g]);else{const k=iC(r);for(;++g<d;)l[g]=k}g=-1;const b=[],v=[];for(;++g<d;){const k=l[g];let T="",E="";k===99?(T=":",E=":"):k===108?T=":":k===114&&(E=":");let P=t.alignDelimiters===!1?1:Math.max(1,u[g]-T.length-E.length);const I=T+"-".repeat(P)+E;t.alignDelimiters!==!1&&(P=T.length+P+E.length,P>u[g]&&(u[g]=P),v[g]=P),b[g]=I}o.splice(1,0,b),f.splice(1,0,v),h=-1;const S=[];for(;++h<o.length;){const k=o[h],T=f[h];g=-1;const E=[];for(;++g<d;){const P=k[g]||"";let I="",V="";if(t.alignDelimiters!==!1){const F=u[g]-(T[g]||0),O=l[g];O===114?I=" ".repeat(F):O===99?F%2?(I=" ".repeat(F/2+.5),V=" ".repeat(F/2-.5)):(I=" ".repeat(F/2),V=I):V=" ".repeat(F)}t.delimiterStart!==!1&&!g&&E.push("|"),t.padding!==!1&&!(t.alignDelimiters===!1&&P==="")&&(t.delimiterStart!==!1||g)&&E.push(" "),t.alignDelimiters!==!1&&E.push(I),E.push(P),t.alignDelimiters!==!1&&E.push(V),t.padding!==!1&&E.push(" "),(t.delimiterEnd!==!1||g!==d-1)&&E.push("|")}S.push(t.delimiterEnd===!1?E.join("").replace(/ +$/,""):E.join(""))}return S.join(`
`)}function SH(e){return e==null?"":String(e)}function iC(e){const n=typeof e=="string"?e.codePointAt(0):0;return n===67||n===99?99:n===76||n===108?108:n===82||n===114?114:0}function jH(e,n,t,r){const a=t.enter("blockquote"),l=t.createTracker(r);l.move("> "),l.shift(2);const o=t.indentLines(t.containerFlow(e,l.current()),CH);return a(),o}function CH(e,n,t){return">"+(t?"":" ")+e}function _H(e,n){return rC(e,n.inConstruct,!0)&&!rC(e,n.notInConstruct,!1)}function rC(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function aC(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&_H(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function kH(e,n){const t=String(e);let r=t.indexOf(n),a=r,l=0,o=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++l>o&&(o=l):l=1,a=r+n.length,r=t.indexOf(n,a);return o}function EH(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function TH(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function AH(e,n,t,r){const a=TH(t),l=e.value||"",o=a==="`"?"GraveAccent":"Tilde";if(EH(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(l,DH);return g(),b}const f=t.createTracker(r),u=a.repeat(Math.max(kH(l,a)+1,3)),d=t.enter("codeFenced");let h=f.move(u);if(e.lang){const g=t.enter(`codeFencedLang${o}`);h+=f.move(t.safe(e.lang,{before:h,after:" ",encode:["`"],...f.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${o}`);h+=f.move(" "),h+=f.move(t.safe(e.meta,{before:h,after:`
`,encode:["`"],...f.current()})),g()}return h+=f.move(`
`),l&&(h+=f.move(l+`
`)),h+=f.move(u),d(),h}function DH(e,n,t){return(t?"":"    ")+e}function Pw(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function PH(e,n,t,r){const a=Pw(t),l=a==='"'?"Quote":"Apostrophe",o=t.enter("definition");let f=t.enter("label");const u=t.createTracker(r);let d=u.move("[");return d+=u.move(t.safe(t.associationId(e),{before:d,after:"]",...u.current()})),d+=u.move("]: "),f(),!e.url||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),d+=u.move("<"),d+=u.move(t.safe(e.url,{before:d,after:">",...u.current()})),d+=u.move(">")):(f=t.enter("destinationRaw"),d+=u.move(t.safe(e.url,{before:d,after:e.title?" ":`
`,...u.current()}))),f(),e.title&&(f=t.enter(`title${l}`),d+=u.move(" "+a),d+=u.move(t.safe(e.title,{before:d,after:a,...u.current()})),d+=u.move(a),f()),o(),d}function IH(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function sg(e){return"&#x"+e.toString(16).toUpperCase()+";"}function gb(e,n,t){const r=Hh(e),a=Hh(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}Jk.peek=MH;function Jk(e,n,t,r){const a=IH(t),l=t.enter("emphasis"),o=t.createTracker(r),f=o.move(a);let u=o.move(t.containerPhrasing(e,{after:a,before:f,...o.current()}));const d=u.charCodeAt(0),h=gb(r.before.charCodeAt(r.before.length-1),d,a);h.inside&&(u=sg(d)+u.slice(1));const g=u.charCodeAt(u.length-1),b=gb(r.after.charCodeAt(0),g,a);b.inside&&(u=u.slice(0,-1)+sg(g));const v=o.move(a);return l(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},f+u+v}function MH(e,n,t){return t.options.emphasis||"*"}function RH(e,n){let t=!1;return Dw(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,b1}),!!((!e.depth||e.depth<3)&&jw(e)&&(n.options.setext||t))}function LH(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),l=t.createTracker(r);if(RH(e,t)){const h=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...l.current(),before:`
`,after:`
`});return g(),h(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const o="#".repeat(a),f=t.enter("headingAtx"),u=t.enter("phrasing");l.move(o+" ");let d=t.containerPhrasing(e,{before:"# ",after:`
`,...l.current()});return/^[\t ]/.test(d)&&(d=sg(d.charCodeAt(0))+d.slice(1)),d=d?o+" "+d:o,t.options.closeAtx&&(d+=" "+o),u(),f(),d}Kk.peek=OH;function Kk(e){return e.value||""}function OH(){return"<"}Xk.peek=FH;function Xk(e,n,t,r){const a=Pw(t),l=a==='"'?"Quote":"Apostrophe",o=t.enter("image");let f=t.enter("label");const u=t.createTracker(r);let d=u.move("![");return d+=u.move(t.safe(e.alt,{before:d,after:"]",...u.current()})),d+=u.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),d+=u.move("<"),d+=u.move(t.safe(e.url,{before:d,after:">",...u.current()})),d+=u.move(">")):(f=t.enter("destinationRaw"),d+=u.move(t.safe(e.url,{before:d,after:e.title?" ":")",...u.current()}))),f(),e.title&&(f=t.enter(`title${l}`),d+=u.move(" "+a),d+=u.move(t.safe(e.title,{before:d,after:a,...u.current()})),d+=u.move(a),f()),d+=u.move(")"),o(),d}function FH(){return"!"}Zk.peek=$H;function Zk(e,n,t,r){const a=e.referenceType,l=t.enter("imageReference");let o=t.enter("label");const f=t.createTracker(r);let u=f.move("![");const d=t.safe(e.alt,{before:u,after:"]",...f.current()});u+=f.move(d+"]["),o();const h=t.stack;t.stack=[],o=t.enter("reference");const g=t.safe(t.associationId(e),{before:u,after:"]",...f.current()});return o(),t.stack=h,l(),a==="full"||!d||d!==g?u+=f.move(g+"]"):a==="shortcut"?u=u.slice(0,-1):u+=f.move("]"),u}function $H(){return"!"}eE.peek=zH;function eE(e,n,t){let r=e.value||"",a="`",l=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++l<t.unsafe.length;){const o=t.unsafe[l],f=t.compilePattern(o);let u;if(o.atBreak)for(;u=f.exec(r);){let d=u.index;r.charCodeAt(d)===10&&r.charCodeAt(d-1)===13&&d--,r=r.slice(0,d)+" "+r.slice(u.index+1)}}return a+r+a}function zH(){return"`"}function tE(e,n){const t=jw(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}nE.peek=BH;function nE(e,n,t,r){const a=Pw(t),l=a==='"'?"Quote":"Apostrophe",o=t.createTracker(r);let f,u;if(tE(e,t)){const h=t.stack;t.stack=[],f=t.enter("autolink");let g=o.move("<");return g+=o.move(t.containerPhrasing(e,{before:g,after:">",...o.current()})),g+=o.move(">"),f(),t.stack=h,g}f=t.enter("link"),u=t.enter("label");let d=o.move("[");return d+=o.move(t.containerPhrasing(e,{before:d,after:"](",...o.current()})),d+=o.move("]("),u(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(u=t.enter("destinationLiteral"),d+=o.move("<"),d+=o.move(t.safe(e.url,{before:d,after:">",...o.current()})),d+=o.move(">")):(u=t.enter("destinationRaw"),d+=o.move(t.safe(e.url,{before:d,after:e.title?" ":")",...o.current()}))),u(),e.title&&(u=t.enter(`title${l}`),d+=o.move(" "+a),d+=o.move(t.safe(e.title,{before:d,after:a,...o.current()})),d+=o.move(a),u()),d+=o.move(")"),f(),d}function BH(e,n,t){return tE(e,t)?"<":"["}iE.peek=UH;function iE(e,n,t,r){const a=e.referenceType,l=t.enter("linkReference");let o=t.enter("label");const f=t.createTracker(r);let u=f.move("[");const d=t.containerPhrasing(e,{before:u,after:"]",...f.current()});u+=f.move(d+"]["),o();const h=t.stack;t.stack=[],o=t.enter("reference");const g=t.safe(t.associationId(e),{before:u,after:"]",...f.current()});return o(),t.stack=h,l(),a==="full"||!d||d!==g?u+=f.move(g+"]"):a==="shortcut"?u=u.slice(0,-1):u+=f.move("]"),u}function UH(){return"["}function Iw(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function qH(e){const n=Iw(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function VH(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function rE(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function HH(e,n,t,r){const a=t.enter("list"),l=t.bulletCurrent;let o=e.ordered?VH(t):Iw(t);const f=e.ordered?o==="."?")":".":qH(t);let u=n&&t.bulletLastUsed?o===t.bulletLastUsed:!1;if(!e.ordered){const h=e.children?e.children[0]:void 0;if((o==="*"||o==="-")&&h&&(!h.children||!h.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(u=!0),rE(t)===o&&h){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){u=!0;break}}}}u&&(o=f),t.bulletCurrent=o;const d=t.containerFlow(e,r);return t.bulletLastUsed=o,t.bulletCurrent=l,a(),d}function GH(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function YH(e,n,t,r){const a=GH(t);let l=t.bulletCurrent||Iw(t);n&&n.type==="list"&&n.ordered&&(l=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+l);let o=l.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(o=Math.ceil(o/4)*4);const f=t.createTracker(r);f.move(l+" ".repeat(o-l.length)),f.shift(o);const u=t.enter("listItem"),d=t.indentLines(t.containerFlow(e,f.current()),h);return u(),d;function h(g,b,v){return b?(v?"":" ".repeat(o))+g:(v?l:l+" ".repeat(o-l.length))+g}}function WH(e,n,t,r){const a=t.enter("paragraph"),l=t.enter("phrasing"),o=t.containerPhrasing(e,r);return l(),a(),o}const QH=zb(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function JH(e,n,t,r){return(e.children.some(function(o){return QH(o)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function KH(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}aE.peek=XH;function aE(e,n,t,r){const a=KH(t),l=t.enter("strong"),o=t.createTracker(r),f=o.move(a+a);let u=o.move(t.containerPhrasing(e,{after:a,before:f,...o.current()}));const d=u.charCodeAt(0),h=gb(r.before.charCodeAt(r.before.length-1),d,a);h.inside&&(u=sg(d)+u.slice(1));const g=u.charCodeAt(u.length-1),b=gb(r.after.charCodeAt(0),g,a);b.inside&&(u=u.slice(0,-1)+sg(g));const v=o.move(a+a);return l(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},f+u+v}function XH(e,n,t){return t.options.strong||"*"}function ZH(e,n,t,r){return t.safe(e.value,r)}function eG(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function tG(e,n,t){const r=(rE(t)+(t.options.ruleSpaces?" ":"")).repeat(eG(t));return t.options.ruleSpaces?r.slice(0,-1):r}const sE={blockquote:jH,break:aC,code:AH,definition:PH,emphasis:Jk,hardBreak:aC,heading:LH,html:Kk,image:Xk,imageReference:Zk,inlineCode:eE,link:nE,linkReference:iE,list:HH,listItem:YH,paragraph:WH,root:JH,strong:aE,text:ZH,thematicBreak:tG};function nG(){return{enter:{table:iG,tableData:sC,tableHeader:sC,tableRow:aG},exit:{codeText:sG,table:rG,tableData:S0,tableHeader:S0,tableRow:S0}}}function iG(e){const n=e._align;this.enter({type:"table",align:n.map(function(t){return t==="none"?null:t}),children:[]},e),this.data.inTable=!0}function rG(e){this.exit(e),this.data.inTable=void 0}function aG(e){this.enter({type:"tableRow",children:[]},e)}function S0(e){this.exit(e)}function sC(e){this.enter({type:"tableCell",children:[]},e)}function sG(e){let n=this.resume();this.data.inTable&&(n=n.replace(/\\([\\|])/g,lG));const t=this.stack[this.stack.length-1];t.type,t.value=n,this.exit(e)}function lG(e,n){return n==="|"?n:e}function oG(e){const n=e||{},t=n.tableCellPadding,r=n.tablePipeAlign,a=n.stringLength,l=t?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:b,table:o,tableCell:u,tableRow:f}};function o(v,S,k,T){return d(h(v,k,T),v.align)}function f(v,S,k,T){const E=g(v,k,T),P=d([E]);return P.slice(0,P.indexOf(`
`))}function u(v,S,k,T){const E=k.enter("tableCell"),P=k.enter("phrasing"),I=k.containerPhrasing(v,{...T,before:l,after:l});return P(),E(),I}function d(v,S){return NH(v,{align:S,alignDelimiters:r,padding:t,stringLength:a})}function h(v,S,k){const T=v.children;let E=-1;const P=[],I=S.enter("table");for(;++E<T.length;)P[E]=g(T[E],S,k);return I(),P}function g(v,S,k){const T=v.children;let E=-1;const P=[],I=S.enter("tableRow");for(;++E<T.length;)P[E]=u(T[E],v,S,k);return I(),P}function b(v,S,k){let T=sE.inlineCode(v,S,k);return k.stack.includes("tableCell")&&(T=T.replace(/\|/g,"\\$&")),T}}function cG(){return{exit:{taskListCheckValueChecked:lC,taskListCheckValueUnchecked:lC,paragraph:dG}}}function uG(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:fG}}}function lC(e){const n=this.stack[this.stack.length-2];n.type,n.checked=e.type==="taskListCheckValueChecked"}function dG(e){const n=this.stack[this.stack.length-2];if(n&&n.type==="listItem"&&typeof n.checked=="boolean"){const t=this.stack[this.stack.length-1];t.type;const r=t.children[0];if(r&&r.type==="text"){const a=n.children;let l=-1,o;for(;++l<a.length;){const f=a[l];if(f.type==="paragraph"){o=f;break}}o===t&&(r.value=r.value.slice(1),r.value.length===0?t.children.shift():t.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,t.position.start=Object.assign({},r.position.start)))}}this.exit(e)}function fG(e,n,t,r){const a=e.children[0],l=typeof e.checked=="boolean"&&a&&a.type==="paragraph",o="["+(e.checked?"x":" ")+"] ",f=t.createTracker(r);l&&f.move(o);let u=sE.listItem(e,n,t,{...r,...f.current()});return l&&(u=u.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,d)),u;function d(h){return h+o}}function hG(){return[HV(),fH(),gH(),nG(),cG()]}function pG(e){return{extensions:[GV(),hH(e),yH(),oG(e),uG()]}}const mG={tokenize:wG,partial:!0},lE={tokenize:NG,partial:!0},oE={tokenize:SG,partial:!0},cE={tokenize:jG,partial:!0},gG={tokenize:CG,partial:!0},uE={name:"wwwAutolink",tokenize:bG,previous:fE},dE={name:"protocolAutolink",tokenize:vG,previous:hE},Go={name:"emailAutolink",tokenize:xG,previous:pE},Wl={};function yG(){return{text:Wl}}let Id=48;for(;Id<123;)Wl[Id]=Go,Id++,Id===58?Id=65:Id===91&&(Id=97);Wl[43]=Go;Wl[45]=Go;Wl[46]=Go;Wl[95]=Go;Wl[72]=[Go,dE];Wl[104]=[Go,dE];Wl[87]=[Go,uE];Wl[119]=[Go,uE];function xG(e,n,t){const r=this;let a,l;return o;function o(g){return!S1(g)||!pE.call(r,r.previous)||Mw(r.events)?t(g):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),f(g))}function f(g){return S1(g)?(e.consume(g),f):g===64?(e.consume(g),u):t(g)}function u(g){return g===46?e.check(gG,h,d)(g):g===45||g===95||Ir(g)?(l=!0,e.consume(g),u):h(g)}function d(g){return e.consume(g),a=!0,u}function h(g){return l&&a&&Wr(r.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),n(g)):t(g)}}function bG(e,n,t){const r=this;return a;function a(o){return o!==87&&o!==119||!fE.call(r,r.previous)||Mw(r.events)?t(o):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(mG,e.attempt(lE,e.attempt(oE,l),t),t)(o))}function l(o){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),n(o)}}function vG(e,n,t){const r=this;let a="",l=!1;return o;function o(g){return(g===72||g===104)&&hE.call(r,r.previous)&&!Mw(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),a+=String.fromCodePoint(g),e.consume(g),f):t(g)}function f(g){if(Wr(g)&&a.length<5)return a+=String.fromCodePoint(g),e.consume(g),f;if(g===58){const b=a.toLowerCase();if(b==="http"||b==="https")return e.consume(g),u}return t(g)}function u(g){return g===47?(e.consume(g),l?d:(l=!0,u)):t(g)}function d(g){return g===null||hb(g)||Xn(g)||Vd(g)||Ob(g)?t(g):e.attempt(lE,e.attempt(oE,h),t)(g)}function h(g){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),n(g)}}function wG(e,n,t){let r=0;return a;function a(o){return(o===87||o===119)&&r<3?(r++,e.consume(o),a):o===46&&r===3?(e.consume(o),l):t(o)}function l(o){return o===null?t(o):n(o)}}function NG(e,n,t){let r,a,l;return o;function o(d){return d===46||d===95?e.check(cE,u,f)(d):d===null||Xn(d)||Vd(d)||d!==45&&Ob(d)?u(d):(l=!0,e.consume(d),o)}function f(d){return d===95?r=!0:(a=r,r=void 0),e.consume(d),o}function u(d){return a||r||!l?t(d):n(d)}}function SG(e,n){let t=0,r=0;return a;function a(o){return o===40?(t++,e.consume(o),a):o===41&&r<t?l(o):o===33||o===34||o===38||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===60||o===63||o===93||o===95||o===126?e.check(cE,n,l)(o):o===null||Xn(o)||Vd(o)?n(o):(e.consume(o),a)}function l(o){return o===41&&r++,e.consume(o),a}}function jG(e,n,t){return r;function r(f){return f===33||f===34||f===39||f===41||f===42||f===44||f===46||f===58||f===59||f===63||f===95||f===126?(e.consume(f),r):f===38?(e.consume(f),l):f===93?(e.consume(f),a):f===60||f===null||Xn(f)||Vd(f)?n(f):t(f)}function a(f){return f===null||f===40||f===91||Xn(f)||Vd(f)?n(f):r(f)}function l(f){return Wr(f)?o(f):t(f)}function o(f){return f===59?(e.consume(f),r):Wr(f)?(e.consume(f),o):t(f)}}function CG(e,n,t){return r;function r(l){return e.consume(l),a}function a(l){return Ir(l)?t(l):n(l)}}function fE(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||Xn(e)}function hE(e){return!Wr(e)}function pE(e){return!(e===47||S1(e))}function S1(e){return e===43||e===45||e===46||e===95||Ir(e)}function Mw(e){let n=e.length,t=!1;for(;n--;){const r=e[n][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){t=!0;break}if(r._gfmAutolinkLiteralWalkedInto){t=!1;break}}return e.length>0&&!t&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),t}const _G={tokenize:MG,partial:!0};function kG(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:DG,continuation:{tokenize:PG},exit:IG}},text:{91:{name:"gfmFootnoteCall",tokenize:AG},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:EG,resolveTo:TG}}}}function EG(e,n,t){const r=this;let a=r.events.length;const l=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o;for(;a--;){const u=r.events[a][1];if(u.type==="labelImage"){o=u;break}if(u.type==="gfmFootnoteCall"||u.type==="labelLink"||u.type==="label"||u.type==="image"||u.type==="link")break}return f;function f(u){if(!o||!o._balanced)return t(u);const d=Hs(r.sliceSerialize({start:o.end,end:r.now()}));return d.codePointAt(0)!==94||!l.includes(d.slice(1))?t(u):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(u),e.exit("gfmFootnoteCallLabelMarker"),n(u))}}function TG(e,n){let t=e.length;for(;t--;)if(e[t][1].type==="labelImage"&&e[t][0]==="enter"){e[t][1];break}e[t+1][1].type="data",e[t+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[t+3][1].start),end:Object.assign({},e[e.length-1][1].end)},a={type:"gfmFootnoteCallMarker",start:Object.assign({},e[t+3][1].end),end:Object.assign({},e[t+3][1].end)};a.end.column++,a.end.offset++,a.end._bufferIndex++;const l={type:"gfmFootnoteCallString",start:Object.assign({},a.end),end:Object.assign({},e[e.length-1][1].start)},o={type:"chunkString",contentType:"string",start:Object.assign({},l.start),end:Object.assign({},l.end)},f=[e[t+1],e[t+2],["enter",r,n],e[t+3],e[t+4],["enter",a,n],["exit",a,n],["enter",l,n],["enter",o,n],["exit",o,n],["exit",l,n],e[e.length-2],e[e.length-1],["exit",r,n]];return e.splice(t,e.length-t+1,...f),e}function AG(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let l=0,o;return f;function f(g){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),u}function u(g){return g!==94?t(g):(e.enter("gfmFootnoteCallMarker"),e.consume(g),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",d)}function d(g){if(l>999||g===93&&!o||g===null||g===91||Xn(g))return t(g);if(g===93){e.exit("chunkString");const b=e.exit("gfmFootnoteCallString");return a.includes(Hs(r.sliceSerialize(b)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),n):t(g)}return Xn(g)||(o=!0),l++,e.consume(g),g===92?h:d}function h(g){return g===91||g===92||g===93?(e.consume(g),l++,d):d(g)}}function DG(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let l,o=0,f;return u;function u(S){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),d}function d(S){return S===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",h):t(S)}function h(S){if(o>999||S===93&&!f||S===null||S===91||Xn(S))return t(S);if(S===93){e.exit("chunkString");const k=e.exit("gfmFootnoteDefinitionLabelString");return l=Hs(r.sliceSerialize(k)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),b}return Xn(S)||(f=!0),o++,e.consume(S),S===92?g:h}function g(S){return S===91||S===92||S===93?(e.consume(S),o++,h):h(S)}function b(S){return S===58?(e.enter("definitionMarker"),e.consume(S),e.exit("definitionMarker"),a.includes(l)||a.push(l),vn(e,v,"gfmFootnoteDefinitionWhitespace")):t(S)}function v(S){return n(S)}}function PG(e,n,t){return e.check(mg,n,e.attempt(_G,n,t))}function IG(e){e.exit("gfmFootnoteDefinition")}function MG(e,n,t){const r=this;return vn(e,a,"gfmFootnoteDefinitionIndent",5);function a(l){const o=r.events[r.events.length-1];return o&&o[1].type==="gfmFootnoteDefinitionIndent"&&o[2].sliceSerialize(o[1],!0).length===4?n(l):t(l)}}function RG(e){let t=(e||{}).singleTilde;const r={name:"strikethrough",tokenize:l,resolveAll:a};return t==null&&(t=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function a(o,f){let u=-1;for(;++u<o.length;)if(o[u][0]==="enter"&&o[u][1].type==="strikethroughSequenceTemporary"&&o[u][1]._close){let d=u;for(;d--;)if(o[d][0]==="exit"&&o[d][1].type==="strikethroughSequenceTemporary"&&o[d][1]._open&&o[u][1].end.offset-o[u][1].start.offset===o[d][1].end.offset-o[d][1].start.offset){o[u][1].type="strikethroughSequence",o[d][1].type="strikethroughSequence";const h={type:"strikethrough",start:Object.assign({},o[d][1].start),end:Object.assign({},o[u][1].end)},g={type:"strikethroughText",start:Object.assign({},o[d][1].end),end:Object.assign({},o[u][1].start)},b=[["enter",h,f],["enter",o[d][1],f],["exit",o[d][1],f],["enter",g,f]],v=f.parser.constructs.insideSpan.null;v&&Ba(b,b.length,0,Fb(v,o.slice(d+1,u),f)),Ba(b,b.length,0,[["exit",g,f],["enter",o[u][1],f],["exit",o[u][1],f],["exit",h,f]]),Ba(o,d-1,u-d+3,b),u=d+b.length-2;break}}for(u=-1;++u<o.length;)o[u][1].type==="strikethroughSequenceTemporary"&&(o[u][1].type="data");return o}function l(o,f,u){const d=this.previous,h=this.events;let g=0;return b;function b(S){return d===126&&h[h.length-1][1].type!=="characterEscape"?u(S):(o.enter("strikethroughSequenceTemporary"),v(S))}function v(S){const k=Hh(d);if(S===126)return g>1?u(S):(o.consume(S),g++,v);if(g<2&&!t)return u(S);const T=o.exit("strikethroughSequenceTemporary"),E=Hh(S);return T._open=!E||E===2&&!!k,T._close=!k||k===2&&!!E,f(S)}}}class LG{constructor(){this.map=[]}add(n,t,r){OG(this,n,t,r)}consume(n){if(this.map.sort(function(l,o){return l[0]-o[0]}),this.map.length===0)return;let t=this.map.length;const r=[];for(;t>0;)t-=1,r.push(n.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),n.length=this.map[t][0];r.push(n.slice()),n.length=0;let a=r.pop();for(;a;){for(const l of a)n.push(l);a=r.pop()}this.map.length=0}}function OG(e,n,t,r){let a=0;if(!(t===0&&r.length===0)){for(;a<e.map.length;){if(e.map[a][0]===n){e.map[a][1]+=t,e.map[a][2].push(...r);return}a+=1}e.map.push([n,t,r])}}function FG(e,n){let t=!1;const r=[];for(;n<e.length;){const a=e[n];if(t){if(a[0]==="enter")a[1].type==="tableContent"&&r.push(e[n+1][1].type==="tableDelimiterMarker"?"left":"none");else if(a[1].type==="tableContent"){if(e[n-1][1].type==="tableDelimiterMarker"){const l=r.length-1;r[l]=r[l]==="left"?"center":"right"}}else if(a[1].type==="tableDelimiterRow")break}else a[0]==="enter"&&a[1].type==="tableDelimiterRow"&&(t=!0);n+=1}return r}function $G(){return{flow:{null:{name:"table",tokenize:zG,resolveAll:BG}}}}function zG(e,n,t){const r=this;let a=0,l=0,o;return f;function f($){let R=r.events.length-1;for(;R>-1;){const Z=r.events[R][1].type;if(Z==="lineEnding"||Z==="linePrefix")R--;else break}const H=R>-1?r.events[R][1].type:null,ee=H==="tableHead"||H==="tableRow"?O:u;return ee===O&&r.parser.lazy[r.now().line]?t($):ee($)}function u($){return e.enter("tableHead"),e.enter("tableRow"),d($)}function d($){return $===124||(o=!0,l+=1),h($)}function h($){return $===null?t($):Pt($)?l>1?(l=0,r.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume($),e.exit("lineEnding"),v):t($):hn($)?vn(e,h,"whitespace")($):(l+=1,o&&(o=!1,a+=1),$===124?(e.enter("tableCellDivider"),e.consume($),e.exit("tableCellDivider"),o=!0,h):(e.enter("data"),g($)))}function g($){return $===null||$===124||Xn($)?(e.exit("data"),h($)):(e.consume($),$===92?b:g)}function b($){return $===92||$===124?(e.consume($),g):g($)}function v($){return r.interrupt=!1,r.parser.lazy[r.now().line]?t($):(e.enter("tableDelimiterRow"),o=!1,hn($)?vn(e,S,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)($):S($))}function S($){return $===45||$===58?T($):$===124?(o=!0,e.enter("tableCellDivider"),e.consume($),e.exit("tableCellDivider"),k):F($)}function k($){return hn($)?vn(e,T,"whitespace")($):T($)}function T($){return $===58?(l+=1,o=!0,e.enter("tableDelimiterMarker"),e.consume($),e.exit("tableDelimiterMarker"),E):$===45?(l+=1,E($)):$===null||Pt($)?V($):F($)}function E($){return $===45?(e.enter("tableDelimiterFiller"),P($)):F($)}function P($){return $===45?(e.consume($),P):$===58?(o=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume($),e.exit("tableDelimiterMarker"),I):(e.exit("tableDelimiterFiller"),I($))}function I($){return hn($)?vn(e,V,"whitespace")($):V($)}function V($){return $===124?S($):$===null||Pt($)?!o||a!==l?F($):(e.exit("tableDelimiterRow"),e.exit("tableHead"),n($)):F($)}function F($){return t($)}function O($){return e.enter("tableRow"),B($)}function B($){return $===124?(e.enter("tableCellDivider"),e.consume($),e.exit("tableCellDivider"),B):$===null||Pt($)?(e.exit("tableRow"),n($)):hn($)?vn(e,B,"whitespace")($):(e.enter("data"),U($))}function U($){return $===null||$===124||Xn($)?(e.exit("data"),B($)):(e.consume($),$===92?z:U)}function z($){return $===92||$===124?(e.consume($),U):U($)}}function BG(e,n){let t=-1,r=!0,a=0,l=[0,0,0,0],o=[0,0,0,0],f=!1,u=0,d,h,g;const b=new LG;for(;++t<e.length;){const v=e[t],S=v[1];v[0]==="enter"?S.type==="tableHead"?(f=!1,u!==0&&(oC(b,n,u,d,h),h=void 0,u=0),d={type:"table",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",d,n]])):S.type==="tableRow"||S.type==="tableDelimiterRow"?(r=!0,g=void 0,l=[0,0,0,0],o=[0,t+1,0,0],f&&(f=!1,h={type:"tableBody",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",h,n]])),a=S.type==="tableDelimiterRow"?2:h?3:1):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")?(r=!1,o[2]===0&&(l[1]!==0&&(o[0]=o[1],g=Tx(b,n,l,a,void 0,g),l=[0,0,0,0]),o[2]=t)):S.type==="tableCellDivider"&&(r?r=!1:(l[1]!==0&&(o[0]=o[1],g=Tx(b,n,l,a,void 0,g)),l=o,o=[l[1],t,0,0])):S.type==="tableHead"?(f=!0,u=t):S.type==="tableRow"||S.type==="tableDelimiterRow"?(u=t,l[1]!==0?(o[0]=o[1],g=Tx(b,n,l,a,t,g)):o[1]!==0&&(g=Tx(b,n,o,a,t,g)),a=0):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")&&(o[3]=t)}for(u!==0&&oC(b,n,u,d,h),b.consume(n.events),t=-1;++t<n.events.length;){const v=n.events[t];v[0]==="enter"&&v[1].type==="table"&&(v[1]._align=FG(n.events,t))}return e}function Tx(e,n,t,r,a,l){const o=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",f="tableContent";t[0]!==0&&(l.end=Object.assign({},Th(n.events,t[0])),e.add(t[0],0,[["exit",l,n]]));const u=Th(n.events,t[1]);if(l={type:o,start:Object.assign({},u),end:Object.assign({},u)},e.add(t[1],0,[["enter",l,n]]),t[2]!==0){const d=Th(n.events,t[2]),h=Th(n.events,t[3]),g={type:f,start:Object.assign({},d),end:Object.assign({},h)};if(e.add(t[2],0,[["enter",g,n]]),r!==2){const b=n.events[t[2]],v=n.events[t[3]];if(b[1].end=Object.assign({},v[1].end),b[1].type="chunkText",b[1].contentType="text",t[3]>t[2]+1){const S=t[2]+1,k=t[3]-t[2]-1;e.add(S,k,[])}}e.add(t[3]+1,0,[["exit",g,n]])}return a!==void 0&&(l.end=Object.assign({},Th(n.events,a)),e.add(a,0,[["exit",l,n]]),l=void 0),l}function oC(e,n,t,r,a){const l=[],o=Th(n.events,t);a&&(a.end=Object.assign({},o),l.push(["exit",a,n])),r.end=Object.assign({},o),l.push(["exit",r,n]),e.add(t+1,0,l)}function Th(e,n){const t=e[n],r=t[0]==="enter"?"start":"end";return t[1][r]}const UG={name:"tasklistCheck",tokenize:VG};function qG(){return{text:{91:UG}}}function VG(e,n,t){const r=this;return a;function a(u){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?t(u):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(u),e.exit("taskListCheckMarker"),l)}function l(u){return Xn(u)?(e.enter("taskListCheckValueUnchecked"),e.consume(u),e.exit("taskListCheckValueUnchecked"),o):u===88||u===120?(e.enter("taskListCheckValueChecked"),e.consume(u),e.exit("taskListCheckValueChecked"),o):t(u)}function o(u){return u===93?(e.enter("taskListCheckMarker"),e.consume(u),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),f):t(u)}function f(u){return Pt(u)?n(u):hn(u)?e.check({tokenize:HG},n,t)(u):t(u)}}function HG(e,n,t){return vn(e,r,"whitespace");function r(a){return a===null?t(a):n(a)}}function GG(e){return jk([yG(),kG(),RG(e),$G(),qG()])}const YG={};function Oo(e){const n=this,t=e||YG,r=n.data(),a=r.micromarkExtensions||(r.micromarkExtensions=[]),l=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),o=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);a.push(GG(t)),l.push(hG()),o.push(pG(t))}const WG=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},QG=e=>{switch(e){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:e,className:"status-badge"}}},j0=({title:e,items:n,renderItemContent:t,headerAction:r,isLoading:a,noDataText:l,onDeleteItem:o,onEditLabOrder:f,onSaveLabOrder:u,onCancelEditLabOrder:d,onLabOrderTestChange:h,onLabOrderStatusChange:g,onEditPharmacyOrder:b,onPrintUnavailablePrescription:v,onBillLabOrder:S,onUpdateLabOrderStatus:k,onEnterLabReport:T,onViewLabReport:E,onMarkAsRecurring:P,labInventory:I=[],isSavingLabOrder:V=!1,expandedLabReports:F={},toggleLabReport:O=()=>{}})=>{const B=w.useMemo(()=>{const z={};n.forEach(R=>{if(isNaN(R.date.getTime())){z["Unknown Date"]||(z["Unknown Date"]=[]),z["Unknown Date"].push(R);return}const H=WG(R.originalDateString);z[H]||(z[H]=[]),z[H].push(R)});const $=Object.keys(z);return $.sort((R,H)=>{if(R==="Unknown Date")return 1;if(H==="Unknown Date")return-1;try{const ee=new Date(R.split(" ").reverse().join(" ")),Z=new Date(H.split(" ").reverse().join(" "));if(!isNaN(ee.getTime())&&!isNaN(Z.getTime()))return Z.getTime()-ee.getTime()}catch{}return H.localeCompare(R)}),$.map(R=>({date:R,items:z[R]}))},[n]),U=["pending","billed","collected","processing","report_ready","completed","cancelled","reported"];return i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title mb-2 pb-1",children:e}),r]}),!a&&n.length===0&&i.jsx("p",{className:"ai-context-text italic",children:l}),a&&i.jsx("div",{className:"space-y-3",children:[1,2,3].map(z=>i.jsx("div",{className:"skeleton-block",style:{height:"80px"}},z))}),!a&&n.length>0&&i.jsx("div",{className:"space-y-3",children:B.map(({date:z,items:$})=>i.jsxs("div",{children:[i.jsx("h5",{className:"grouped-history-date",children:z}),i.jsx("div",{className:"space-y-1 grouped-history-item-container",children:$.map((R,H)=>i.jsxs("div",{className:"grouped-history-item ai-context-item flex flex-col",children:[i.jsxs("div",{className:"flex justify-between items-center w-full",children:[i.jsx("div",{className:"flex-grow mr-2 ai-context-text",children:t(R,H,F,O)}),i.jsxs("div",{className:"flex items-center space-x-1",children:[R.type==="Lab Order"&&!R.data.isEditing&&f&&i.jsx("button",{onClick:()=>f(R.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this lab order",disabled:V,children:i.jsx(Qc,{size:14})}),R.type==="Lab Order"&&R.data.isEditing&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>u&&u(R.data.id,R.data.editedTests,R.data.editedStatus),className:"text-green-600 hover:text-green-800 p-1 rounded hover:bg-green-100 focus:outline-none focus:ring-1 focus:ring-green-400",title:"Save lab order changes",disabled:V,children:i.jsx(eu,{size:14})}),i.jsx("button",{onClick:()=>d&&d(R.data.id),className:"text-gray-600 hover:text-gray-800 p-1 rounded hover:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-gray-400",title:"Cancel editing",disabled:V,children:i.jsx(Oi,{size:14})})]}),R.type==="Lab Order"&&i.jsxs("div",{className:"lab-table-actions",children:[R.data.status==="pending"&&S&&(()=>{const ee=R.data.tests.reduce((Z,te)=>Z+(Number(te.price)||0),0).toFixed(2);return i.jsxs("button",{onClick:()=>S(R.data),className:"lab-action-button btn-bill",title:`Pay total of ${ee}`,children:["Pay (",ee,")"]})})(),R.data.status==="billed"&&k&&i.jsx("button",{onClick:()=>k(R.data.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),R.data.status==="collected"&&k&&i.jsx("button",{onClick:()=>k(R.data.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(R.data.status==="processing"||R.data.status==="report_ready"||R.data.status==="reported")&&T&&i.jsx("button",{onClick:()=>T(R.data),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(R.data.status==="report_ready"||R.data.status==="reported")&&k&&i.jsx("button",{onClick:()=>k(R.data.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(R.data.status==="completed"||R.data.status==="report_ready"||R.data.status==="reported")&&E&&i.jsx("button",{onClick:()=>E(R.data),className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]}),R.type==="Pharmacy Order"&&R.data.status==="pending"&&b&&i.jsx("button",{onClick:()=>b(R.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this pharmacy order",disabled:V,children:i.jsx(Qc,{size:14})}),R.type==="Pharmacy Order"&&R.data.prescriptionForUnavailableDrugs&&v&&i.jsx("button",{onClick:()=>v(R.data.prescriptionForUnavailableDrugs,`Prescription for Order ${R.data.id}`),className:"text-purple-600 hover:text-purple-800 p-1 rounded hover:bg-purple-100 focus:outline-none focus:ring-1 focus:ring-purple-400",title:"Print Prescription for Unavailable Drugs",disabled:V,children:i.jsx(Vs,{size:14})}),R.type==="Pharmacy Order"&&P&&i.jsx("button",{onClick:()=>P(R.data.id),className:"text-teal-600 hover:text-teal-800 p-1 rounded hover:bg-teal-100 focus:outline-none focus:ring-1 focus:ring-teal-400",title:"Mark as Recurring Medication",disabled:V,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-repeat",children:[i.jsx("path",{d:"m17 2 4 4-4 4"}),i.jsx("path",{d:"M3 11v-1a4 4 0 0 1 4-4h14"}),i.jsx("path",{d:"m7 22-4-4 4-4"}),i.jsx("path",{d:"M21 13v1a4 4 0 0 1-4 4H3"})]})}),R.type==="Pharmacy Order"&&R.data.status==="pending"&&o&&i.jsx("button",{onClick:()=>o({type:R.type,data:R.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Delete this pending pharmacy order",disabled:V,children:i.jsx(Oi,{size:14})}),o&&["Complaint","Lab Order","Lab Report"].includes(R.type)&&i.jsx("button",{onClick:()=>o({type:R.type,data:R.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:`Delete this ${R.type.toLowerCase()}`,disabled:V,children:i.jsx(Oi,{size:14})})]})]}),R.type==="Lab Order"&&R.data.isEditing&&i.jsxs("div",{className:"lab-order-edit-form mt-2 w-full",children:[i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status:"}),i.jsx("select",{value:R.data.editedStatus||R.data.status,onChange:ee=>g&&g(R.data.id,ee.target.value),className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:V,children:U.map(ee=>i.jsx("option",{value:ee,children:ee.replace(/_/g," ")},ee))})]}),i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tests:"}),R.data.editedTests.map((ee,Z)=>i.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[i.jsxs("select",{value:ee.id,onChange:te=>{const Q=I.find(q=>String(q.id)===te.target.value);Q&&(h&&h(R.data.id,Z,"id",Q.id),h&&h(R.data.id,Z,"name",Q.name),h&&h(R.data.id,Z,"price",Q.price))},className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:V,children:[i.jsx("option",{value:"",children:"Select Test"}),I.map(te=>i.jsxs("option",{value:te.id,children:[te.name," (",te.price,")"]},te.id))]}),i.jsx("button",{onClick:()=>{const te=R.data.editedTests.filter((Q,q)=>q!==Z);h&&h(R.data.id,-1,"remove",te)},className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Remove test",disabled:V,children:i.jsx(Oi,{size:14})})]},Z)),i.jsx("button",{onClick:()=>{h&&h(R.data.id,-1,"add",{id:"",name:"",price:0})},className:"button-secondary mt-2 text-xs",disabled:V,children:"Add Test"})]})]},`${R.type}-${R.originalDateString}-${H}`))})]},z))})]})},JG="_modalOverlay_1yna4_3",KG="_modalContent_1yna4_29",XG="_modalHeader_1yna4_57",ZG="_modalTitle_1yna4_75",eY="_modalCloseButton_1yna4_87",tY="_modalBody_1yna4_115",nY="_errorText_1yna4_129",iY="_formGroup_1yna4_147",rY="_inputField_1yna4_171",aY="_searchResultsCard_1yna4_213",sY="_searchResultsList_1yna4_241",lY="_searchResultItem_1yna4_253",oY="_searchResultPrice_1yna4_289",cY="_selectedTestsCard_1yna4_299",uY="_selectedTestsHeader_1yna4_319",dY="_noTestsMessage_1yna4_335",fY="_selectedTestsList_1yna4_351",hY="_selectedTestItem_1yna4_363",pY="_selectedTestName_1yna4_387",mY="_selectedTestPrice_1yna4_399",gY="_removeTestButton_1yna4_411",yY="_totalAmount_1yna4_437",xY="_modalFooter_1yna4_455",bY="_button_1yna4_473",vY="_buttonPrimary_1yna4_491",wY="_buttonSecondary_1yna4_513",Hn={modalOverlay:JG,modalContent:KG,modalHeader:XG,modalTitle:ZG,modalCloseButton:eY,modalBody:tY,errorText:nY,formGroup:iY,inputField:rY,searchResultsCard:aY,searchResultsList:sY,searchResultItem:lY,searchResultPrice:oY,selectedTestsCard:cY,selectedTestsHeader:uY,noTestsMessage:dY,selectedTestsList:fY,selectedTestItem:hY,selectedTestName:pY,selectedTestPrice:mY,removeTestButton:gY,totalAmount:yY,modalFooter:xY,button:bY,buttonPrimary:vY,buttonSecondary:wY},NY=({isOpen:e,onClose:n,patientId:t,labInventory:r,fetchPendingLabOrdersData:a})=>{const[l,o]=w.useState([]),[f,u]=w.useState(""),[d,h]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>{if(!f){h([]);return}const P=f.toLowerCase();h(r.filter(I=>I.name.toLowerCase().includes(P)||I.description&&I.description.toLowerCase().includes(P)).slice(0,10))},[f,r]);const k=async()=>{if(!t){b("Patient ID is missing.");return}if(l.length===0){b("Please select at least one lab test.");return}S(!0),b(null);try{const P={patient_id:t,tests:l.map(V=>({id:V.id,name:V.name,price:V.price}))},I=await fe("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(P)});if(!I.ok){const V=await I.json().catch(()=>({}));throw new Error(V.message||`Failed to create lab order: ${I.statusText}`)}await I.json(),a(t),n(),o([]),u("")}catch(P){b(`Lab Order Creation Error: ${P.message}`)}finally{S(!1)}},T=P=>{if(l.some(I=>I.id===P.id)){b(`${P.name} is already in the order.`),setTimeout(()=>b(null),3e3),u(""),h([]);return}o(I=>[...I,{...P}]),u(""),h([])},E=P=>{o(I=>I.filter(V=>V.id!==P))};return e?i.jsx("div",{className:Hn.modalOverlay,children:i.jsxs("div",{className:Hn.modalContent,children:[i.jsxs("div",{className:Hn.modalHeader,children:[i.jsx("h3",{className:Hn.modalTitle,children:"Create New Lab Order"}),i.jsx("button",{onClick:n,className:Hn.modalCloseButton,children:i.jsx(Kn,{size:20})})]}),i.jsxs("div",{className:Hn.modalBody,children:[g&&i.jsx("div",{className:Hn.errorText,children:g}),i.jsxs("div",{className:Hn.formGroup,style:{position:"relative"},children:[i.jsx("label",{htmlFor:"lab-test-search",children:"Add Lab Test"}),i.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search available lab tests...",value:f,onChange:P=>u(P.target.value),className:Hn.inputField}),f&&d.length>0&&i.jsx("div",{className:Hn.searchResultsCard,children:i.jsx("ul",{className:Hn.searchResultsList,children:d.map(P=>i.jsxs("li",{onClick:()=>T(P),className:Hn.searchResultItem,children:[i.jsx("span",{children:P.name}),i.jsxs("span",{className:Hn.searchResultPrice,children:["(",parseFloat(String(P.price)).toFixed(2),")"]})]},P.id))})})]}),i.jsxs("div",{className:Hn.selectedTestsCard,children:[i.jsx("h4",{className:Hn.selectedTestsHeader,children:"Selected Tests"}),l.length===0?i.jsx("p",{className:Hn.noTestsMessage,children:"No tests added yet."}):i.jsx("ul",{className:Hn.selectedTestsList,children:l.map(P=>i.jsxs("li",{className:Hn.selectedTestItem,children:[i.jsx("span",{className:Hn.selectedTestName,children:P.name}),i.jsxs("span",{className:Hn.selectedTestPrice,children:["",parseFloat(String(P.price)).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>E(String(P.id)),className:Hn.removeTestButton,title:"Remove Test",children:i.jsx(Oi,{size:16})})]},P.id))})]}),l.length>0&&i.jsxs("div",{className:Hn.totalAmount,children:["Total: ",l.reduce((P,I)=>P+parseFloat(String(I.price)),0).toFixed(2)]})]}),i.jsxs("div",{className:Hn.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${Hn.button} ${Hn.buttonSecondary}`,children:" Cancel "}),i.jsxs("button",{type:"button",onClick:k,disabled:l.length===0||v,className:`${Hn.button} ${Hn.buttonPrimary} ${l.length===0||v?Hn.buttonDisabled:""}`,children:[" ",v?"Saving...":"Create Lab Order"," "]})]})]})}):null},SY="_modalOverlay_7kwn4_3",jY="_modalContent_7kwn4_29",CY="_modalHeader_7kwn4_61",_Y="_modalTitle_7kwn4_79",kY="_modalCloseButton_7kwn4_93",EY="_modalBody_7kwn4_129",TY="_errorText_7kwn4_141",AY="_formGroup_7kwn4_161",DY="_stickySearchHeader_7kwn4_173",PY="_inputField_7kwn4_211",IY="_searchResultsCard_7kwn4_253",MY="_searchResultsList_7kwn4_281",RY="_searchResultItem_7kwn4_293",LY="_searchResultPrice_7kwn4_323",OY="_selectedTestsCard_7kwn4_335",FY="_selectedTestsHeader_7kwn4_351",$Y="_noTestsMessage_7kwn4_375",zY="_selectedTestsList_7kwn4_395",BY="_selectedTestItem_7kwn4_413",UY="_selectedTestHeader_7kwn4_441",qY="_selectedTestName_7kwn4_457",VY="_selectedTestInputs_7kwn4_469",HY="_inputGroup_7kwn4_481",GY="_quantityInput_7kwn4_503",YY="_removeTestButton_7kwn4_523",WY="_textareaField_7kwn4_559",QY="_modalFooter_7kwn4_573",JY="_button_7kwn4_591",KY="_buttonPrimary_7kwn4_615",XY="_buttonSecondary_7kwn4_637",ZY="_buttonDisabled_7kwn4_659",dn={modalOverlay:SY,modalContent:jY,modalHeader:CY,modalTitle:_Y,modalCloseButton:kY,modalBody:EY,errorText:TY,formGroup:AY,stickySearchHeader:DY,inputField:PY,searchResultsCard:IY,searchResultsList:MY,searchResultItem:RY,searchResultPrice:LY,selectedTestsCard:OY,selectedTestsHeader:FY,noTestsMessage:$Y,selectedTestsList:zY,selectedTestItem:BY,selectedTestHeader:UY,selectedTestName:qY,selectedTestInputs:VY,inputGroup:HY,quantityInput:GY,removeTestButton:YY,textareaField:WY,modalFooter:QY,button:JY,buttonPrimary:KY,buttonSecondary:XY,buttonDisabled:ZY},eW=({isOpen:e,onClose:n,patientId:t,pharmacyInventory:r,fetchPharmacyOrdersData:a})=>{const[l,o]=w.useState([]),[f,u]=w.useState(""),[d,h]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1),[k,T]=w.useState(""),E=w.useRef(null);w.useEffect(()=>{if(!f){h([]);return}const U=f.toLowerCase();h(r.filter(z=>z.name.toLowerCase().includes(U)).slice(0,10))},[f,r]),w.useEffect(()=>{E.current&&(E.current.style.height="auto",E.current.style.height=`${E.current.scrollHeight}px`)},[k]);const P=U=>{if(!U)return null;const z=U.match(/(?:\d+x)?(\d+)/);return z?parseInt(z[1],10):null},I=Rn.useMemo(()=>l.reduce((U,z)=>{const $=z.pack_price||0,R=z.loose_price||0,H=(z.pack_quantity||0)*$,ee=(z.loose_quantity||0)*R;return U+H+ee},0),[l]),V=async()=>{if(!t){b("Patient ID is missing.");return}if(l.length===0&&!k.trim()){b("Please select at least one medication or provide a prescription.");return}S(!0),b(null);try{const U={patient_id:t,items:l.map($=>({drug_id:$.drug_id,name:$.name,pack_quantity:$.pack_quantity||0,loose_quantity:$.loose_quantity||0,price:$.price,pack_price:$.pack_price||0,loose_price:$.loose_price||0,total_price:($.pack_quantity||0)*($.pack_price||0)+($.loose_quantity||0)*($.loose_price||0),unit:$.unit})),prescription_for_unavailable_drugs:k,status:"pending",date:new Date().toISOString(),order_total:I},z=await fe("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(U)});if(!z.ok){const $=await z.json().catch(()=>({}));throw new Error($.message||`Failed to create pharmacy order: ${z.statusText}`)}await z.json(),a(t),n(),o([]),u(""),T("")}catch(U){b(`Pharmacy Order Creation Error: ${U.message}`)}finally{S(!1)}},F=U=>{if(l.some(H=>H.drug_id===U.id)){b(`${U.name} is already in the order.`),setTimeout(()=>b(null),3e3),u(""),h([]);return}const z=P(U.unit),$=Number(U.price)||0,R=$/(z||1);o(H=>[...H,{drug_id:U.id,name:U.name,price:U.price,pack_price:$,loose_price:R,pack_quantity:1,loose_quantity:0,unit:U.unit}]),u(""),h([])},O=U=>{o(z=>z.filter($=>$.drug_id!==U))},B=(U,z,$)=>{o(R=>R.map(H=>H.drug_id===U?{...H,[z]:$}:H))};return e?i.jsx("div",{className:dn.modalOverlay,children:i.jsxs("div",{className:dn.modalContent,children:[i.jsxs("div",{className:dn.modalHeader,children:[i.jsx("h3",{className:dn.modalTitle,children:"Create New Pharmacy Order"}),i.jsx("button",{onClick:n,className:dn.modalCloseButton,children:i.jsx(Kn,{size:20})})]}),i.jsxs("div",{className:dn.modalBody,children:[i.jsxs("div",{className:`${dn.formGroup} ${dn.stickySearchHeader}`,children:[i.jsx("label",{htmlFor:"drug-search",children:"Add Medication"}),i.jsx("input",{type:"text",id:"drug-search",placeholder:"Search available drugs...",value:f,onChange:U=>u(U.target.value),className:dn.inputField}),f&&d.length>0&&i.jsx("div",{className:dn.searchResultsCard,children:i.jsx("ul",{className:dn.searchResultsList,children:d.map(U=>i.jsxs("li",{onClick:()=>F(U),className:dn.searchResultItem,children:[i.jsx("span",{children:U.name}),i.jsxs("span",{className:dn.searchResultPrice,children:["(",parseFloat(String(U.price)).toFixed(2),")"]})]},U.id))})})]}),g&&i.jsx("div",{className:dn.errorText,children:g}),i.jsxs("div",{className:dn.selectedTestsCard,children:[i.jsx("h4",{className:dn.selectedTestsHeader,children:"Selected Medications"}),l.length===0?i.jsx("p",{className:dn.noTestsMessage,children:"No medications added yet."}):i.jsx("ul",{className:dn.selectedTestsList,children:l.map(U=>i.jsxs("li",{className:dn.selectedTestItem,children:[i.jsxs("div",{className:dn.selectedTestHeader,children:[i.jsx("span",{className:dn.selectedTestName,children:U.name}),i.jsx("button",{type:"button",onClick:()=>O(U.drug_id),className:dn.removeTestButton,title:"Remove Medication",children:i.jsx(Oi,{size:16})})]}),i.jsxs("div",{className:dn.selectedTestInputs,children:[i.jsxs("div",{className:dn.inputGroup,children:[i.jsx("label",{children:"Packs"}),i.jsx("input",{type:"number",min:"0",value:U.pack_quantity,onChange:z=>B(U.drug_id,"pack_quantity",parseInt(z.target.value)||0),className:dn.quantityInput})]}),i.jsxs("div",{className:dn.inputGroup,children:[i.jsx("label",{children:"Loose"}),i.jsx("input",{type:"number",min:"0",value:U.loose_quantity,onChange:z=>B(U.drug_id,"loose_quantity",parseInt(z.target.value)||0),className:dn.quantityInput})]})]})]},U.drug_id))})]}),l.length>0&&i.jsxs("div",{className:dn.totalAmount,children:["Total: ",I.toFixed(2)]}),i.jsxs("div",{className:dn.formGroup,style:{marginTop:"20px"},children:[i.jsx("label",{htmlFor:"prescription-notes",children:"Prescription for Unavailable Drugs (Optional)"}),i.jsx("textarea",{id:"prescription-notes",ref:E,rows:1,value:k,onChange:U=>T(U.target.value),placeholder:"Enter any additional notes or prescription details...",className:`${dn.inputField} ${dn.textareaField}`})]})]}),i.jsxs("div",{className:dn.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${dn.button} ${dn.buttonSecondary}`,children:" Cancel "}),i.jsx("button",{type:"button",onClick:V,disabled:l.length===0&&!k.trim()||v,className:`${dn.button} ${dn.buttonPrimary} ${l.length===0&&!k.trim()||v?dn.buttonDisabled:""}`,children:v?"Saving...":"Create Order"})]})]})}):null},tW="_modalOverlay_13u8a_1",nW="_modalContent_13u8a_45",iW="_modalHeader_13u8a_99",rW="_modalTitle_13u8a_117",aW="_modalCloseButton_13u8a_139",sW="_modalBody_13u8a_177",lW="_section_13u8a_197",oW="_sectionTitle_13u8a_209",cW="_settingsGrid_13u8a_233",uW="_inputWrapper_13u8a_253",dW="_label_13u8a_265",fW="_inputGroup_13u8a_277",hW="_inputIcon_13u8a_289",pW="_inputField_13u8a_303",mW="_inputFieldWithAction_13u8a_327",gW="_selectField_13u8a_345",yW="_searchArea_13u8a_363",xW="_searchResults_13u8a_371",bW="_searchItem_13u8a_425",vW="_drugName_13u8a_461",wW="_drugInfo_13u8a_471",NW="_medList_13u8a_483",SW="_medCard_13u8a_495",jW="_medCardHeader_13u8a_529",CW="_medName_13u8a_541",_W="_medCardGrid_13u8a_553",kW="_removeMedBtn_13u8a_565",EW="_errorBanner_13u8a_595",TW="_modalFooter_13u8a_621",AW="_btn_13u8a_639",DW="_btnSecondary_13u8a_663",PW="_btnPrimary_13u8a_683",IW="_spinner_13u8a_717",MW="_noMeds_13u8a_747",mt={modalOverlay:tW,modalContent:nW,modalHeader:iW,modalTitle:rW,modalCloseButton:aW,modalBody:sW,section:lW,sectionTitle:oW,settingsGrid:cW,inputWrapper:uW,label:dW,inputGroup:fW,inputIcon:hW,inputField:pW,inputFieldWithAction:mW,selectField:gW,searchArea:yW,searchResults:xW,searchItem:bW,drugName:vW,drugInfo:wW,medList:NW,medCard:SW,medCardHeader:jW,medName:CW,medCardGrid:_W,removeMedBtn:kW,errorBanner:EW,modalFooter:TW,btn:AW,btnSecondary:DW,btnPrimary:PW,spinner:IW,noMeds:MW},mE=({isOpen:e,onClose:n,recurringMedication:t,onUpdate:r,inventory:a})=>{const[l,o]=w.useState([]),[f,u]=w.useState(30),[d,h]=w.useState("active"),[g,b]=w.useState(""),[v,S]=w.useState(""),[k,T]=w.useState([]),[E,P]=w.useState(!1),[I,V]=w.useState(null);w.useEffect(()=>{e&&t&&(o([...t.medications]),u(t.frequency_days||30),h(t.status),b(new Date(t.next_delivery_date).toISOString().split("T")[0]),V(null))},[e,t]),w.useEffect(()=>{if(v.trim().length>1){const z=v.toLowerCase(),$=a.filter(R=>R.name&&R.name.toLowerCase().includes(z)).slice(0,5);T($)}else T([])},[v,a]);const F=z=>{if(l.some(H=>H.drug_id===z.id)){V(`${z.name} is already in the list.`);return}const R={drug_id:z.id,name:z.name,pack_quantity:1,loose_quantity:0,pack_price:z.price,unit:z.unit,total_price:z.price};o([...l,R]),S(""),T([]),V(null)},O=z=>{const $=[...l];$.splice(z,1),o($)},B=(z,$,R)=>{const H=[...l];$==="pack_quantity"||$==="loose_quantity"||$==="tabletsPerDay"||$==="numberOfDays"?H[z]={...H[z],[$]:Math.max(0,Number(R))}:H[z]={...H[z],[$]:R},o(H)},U=async()=>{if(l.length===0){V("Please add at least one medication.");return}P(!0),V(null);try{const z=await fe(`/api/recurring-medications/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({medications:l,frequency_days:f,status:d,next_delivery_date:g})});if(!z.ok){const R=await z.json();throw new Error(R.message||"Failed to update recurring medication")}const $=await z.json();r($),n()}catch(z){V(z.message)}finally{P(!1)}};return e?i.jsx("div",{className:mt.modalOverlay,children:i.jsxs("div",{className:mt.modalContent,children:[i.jsxs("div",{className:mt.modalHeader,children:[i.jsx("h2",{className:mt.modalTitle,children:"Edit Recurring Medication"}),i.jsx("button",{onClick:n,className:mt.modalCloseButton,title:"Close",children:i.jsx(Kn,{size:24})})]}),i.jsxs("div",{className:mt.modalBody,children:[I&&i.jsxs("div",{className:mt.errorBanner,children:[i.jsx(si,{size:18}),i.jsx("span",{children:I})]}),i.jsxs("div",{className:mt.section,children:[i.jsxs("div",{className:mt.sectionTitle,children:[i.jsx($h,{size:14}),i.jsx("span",{children:"Subscription Settings"})]}),i.jsxs("div",{className:mt.settingsGrid,children:[i.jsxs("div",{className:mt.inputWrapper,children:[i.jsx("label",{className:mt.label,children:"Frequency (Days)"}),i.jsxs("div",{className:mt.inputGroup,children:[i.jsx($h,{size:16,className:mt.inputIcon}),i.jsx("input",{type:"number",value:f,onChange:z=>u(parseInt(z.target.value,10)||1),className:mt.inputField,min:"1"})]})]}),i.jsxs("div",{className:mt.inputWrapper,children:[i.jsx("label",{className:mt.label,children:"Subscription Status"}),i.jsx("div",{className:mt.inputGroup,children:i.jsxs("select",{value:d,onChange:z=>h(z.target.value),className:`${mt.inputField} ${mt.inputFieldWithAction} ${mt.selectField}`,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"paused",children:"Paused"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]})})]}),i.jsxs("div",{className:mt.inputWrapper,children:[i.jsx("label",{className:mt.label,children:"Next Delivery Date"}),i.jsxs("div",{className:mt.inputGroup,children:[i.jsx(Fh,{size:16,className:mt.inputIcon}),i.jsx("input",{type:"date",value:g,onChange:z=>b(z.target.value),className:mt.inputField})]})]})]})]}),i.jsxs("div",{className:mt.section,children:[i.jsxs("div",{className:mt.sectionTitle,children:[i.jsx(vi,{size:14}),i.jsx("span",{children:"Add & Manage Medications"})]}),i.jsxs("div",{className:mt.searchArea,children:[i.jsxs("div",{className:mt.inputGroup,children:[i.jsx(vi,{size:18,className:mt.inputIcon}),i.jsx("input",{type:"text",value:v,onChange:z=>S(z.target.value),placeholder:"Search pharmacy inventory...",className:mt.inputField})]}),k.length>0&&i.jsx("div",{className:mt.searchResults,children:k.map(z=>i.jsxs("div",{onClick:()=>F(z),className:mt.searchItem,children:[i.jsxs("div",{children:[i.jsx("div",{className:mt.drugName,children:z.name}),i.jsxs("div",{className:mt.drugInfo,children:["Stock: ",z.quantity_in_stock," | Unit: ",z.unit]})]}),i.jsxs("div",{className:mt.drugName,children:["",z.price]})]},z.id))})]}),i.jsxs("div",{className:mt.medList,children:[l.map((z,$)=>i.jsxs("div",{className:mt.medCard,children:[i.jsxs("div",{className:mt.medCardHeader,children:[i.jsx("span",{className:mt.medName,children:z.name}),i.jsx("button",{onClick:()=>O($),className:mt.removeMedBtn,title:"Remove",children:i.jsx(Oi,{size:18})})]}),i.jsxs("div",{className:mt.medCardGrid,children:[i.jsxs("div",{className:mt.inputWrapper,children:[i.jsx("label",{className:mt.label,children:"Packs"}),i.jsx("input",{type:"number",value:z.pack_quantity||0,onChange:R=>B($,"pack_quantity",R.target.value),className:`${mt.inputField} ${mt.inputFieldWithAction}`,placeholder:"0"})]}),i.jsxs("div",{className:mt.inputWrapper,children:[i.jsx("label",{className:mt.label,children:"Loose Qty"}),i.jsx("input",{type:"number",value:z.loose_quantity||0,onChange:R=>B($,"loose_quantity",R.target.value),className:`${mt.inputField} ${mt.inputFieldWithAction}`,placeholder:"0"})]}),i.jsxs("div",{className:mt.inputWrapper,children:[i.jsx("label",{className:mt.label,children:"Days"}),i.jsx("input",{type:"number",value:z.numberOfDays||0,onChange:R=>B($,"numberOfDays",R.target.value),className:`${mt.inputField} ${mt.inputFieldWithAction}`,placeholder:"0"})]}),i.jsxs("div",{className:mt.inputWrapper,children:[i.jsx("label",{className:mt.label,children:"Dosage (e.g. 1 tab/day for 10 days)"}),i.jsx("input",{type:"text",value:z.tabletsPerDay||"",onChange:R=>B($,"tabletsPerDay",R.target.value),className:`${mt.inputField} ${mt.inputFieldWithAction}`,placeholder:"e.g. 1 tab/day..."})]}),i.jsxs("div",{className:mt.inputWrapper,children:[i.jsx("label",{className:mt.label,children:"Directions"}),i.jsx("input",{type:"text",value:z.directions_to_use||"",onChange:R=>B($,"directions_to_use",R.target.value),className:`${mt.inputField} ${mt.inputFieldWithAction}`,placeholder:"Directions to use..."})]})]})]},$)),l.length===0&&i.jsxs("div",{className:mt.noMeds,children:[i.jsx(Gl,{size:32,style:{marginBottom:"12px",opacity:.5}}),i.jsx("p",{children:"No medications added to this recurring subscription yet."})]})]})]})]}),i.jsxs("div",{className:mt.modalFooter,children:[i.jsx("button",{onClick:n,className:`${mt.btn} ${mt.btnSecondary}`,children:"Cancel"}),i.jsxs("button",{onClick:U,disabled:E,className:`${mt.btn} ${mt.btnPrimary}`,children:[E?i.jsx("div",{className:mt.spinner}):i.jsx(eu,{size:18}),E?"Saving Changes...":"Save Subscription"]})]})]})}):null},Ax=e=>{if(!e)return"";let n=e.toLowerCase();return n=n.replace(/\b(mg|g|ml|iu|unit|tabs|tablet|tablets|capsule|capsules|injection|injections|syrup|solution|cream|ointment|lotion|spray|drops|patch|suppository|vial|ampoule|bottle|pack|kit)\b/g,""),n=n.replace(/\b(test|panel|profile|assay|screen|analysis|level|count|culture)\b/g,""),n=n.replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim(),n},Ah=(e,n)=>{if(!e||!n||n.length===0)return;const t=Ax(e);let r=n.find(o=>Ax(o.name)===t);if(r)return r;let a=n.find(o=>Ax(o.name).includes(t));if(a)return a;let l=n.find(o=>t.includes(Ax(o.name)));if(l)return l},RW=`You are an expert OPD (Outpatient Department) medical assistant for a Doctor in a clinic in India. You will receive all the medical data of the patient including complaints (history), labs, pharmacy orders, etc., along with their date and time. Your primary goal is to assist the doctor and analyze patient chief complaints (Co), provide a structured clinical assessment including lab test suggestions (Lx), differential diagnoses (Dx), and a treatment plan (Tx). You have access to tools (actions) to order lab tests and pharmacy items, and update patient details.



**1. Definitions:**
   - Co: Chief complaints
   - Pt: Patient (assume living in India)
   - Lx: Laboratory tests
   - Dx: Differential Diagnosis
   - Tx: Treatment Plan

**2. Workflow:**
   - Analyze Co, generate Lx, Dx, and Tx sections as described below.
   - **Prioritization for Orders:** Always prioritize using \`edit_pharmacy_order\` or \`edit_lab_order\` if there are existing pending orders for the patient, before considering \`create_pharmacy_order\` or \`create_lab_order\`.
   - using edit_lab_order edits the lab order with the given serial numnber use to add new tests to the existing order or remove the tests from existing order, marking the status affects all tests in the order not only the test,always use this tool if there are pending lab orders instead of creating new orders.
   - using edit_pharmacy_order edits the pharmacy order with the given serial numnber to add new items to the existing order, update existing items, or remove items (either by \`items_to_remove\` or by setting \`quantity\` to 0). Always use this tool if there are pending pharmacy orders instead of creating new orders.
   - If your Lx section suggests tests from the inventory, use the \`create_lab_order\` action, but only for tests that are both clinically required and have not already been ordered or are still pending. Skip tests that are already ordered and in pending.
   - If your Tx section prescribes medications, use the \`create_pharmacy_order\` action  but only for medications that are clinically required and have not already been prescribed or are still pending. Skip medications that are already dispensed or already ordered.
   - If your Tx section prescribes medications that are *not* available in the inventory, use the \`prescription_for_unavailable_drugs\` parameter within the \`create_pharmacy_order\` action to specify the prescription details for these unavailable drugs.
   - When ordering pharmacy items, specify both \`pack_quantity\` (number of full packs) and \`loose_quantity\` (number of individual units). The system will handle the conversion based on the drug's unit/pack size.
   - **Patient Details Management:** Always store or update patient name, age, sex, and phone number using the \`update_patient_details\` action. If patient name, age, or sex is received as 'New Patient - Direct Entry', 'N/A', or blank, treat it as missing data; if the user input provides anything resembling a name, age, or sex (e.g., shiva 25m, robin 50m, priya 19f), update them using the \`update_patient_details\` action. If details are missing, you can ask the user for the missing details using the \`ask_followup_question\` action.
   - Always update new complaints of the patient using the \`add_complaint_history\` action.
   - If you generate a concise summary of the patient's current situation based on the interaction and history, use the \`update_case_summary\` action to save it.
   - Remember, when you use \`update_case_summary\`, the previous case summary will be replaced by the new one, so you can use it like a short-term memory to store other stuff that **keeps changing**, like the current treatment plan, plan of action, active problems, or current vitals, etc.
   - When you use \`add_complaint_history\`, it will add the complaint to the previous ones. You will be given all the previous complaints back in every query, so you can use it to store other long-term facts that do **not change**, like the history of a chronic illness, surgical history, allergies, or social history, etc.
   - while placing or editing a pharmacy order make sure to set the \`pack_quantity\` and \`loose_quantity\` right.
   - Use the \`update_clinic_ai_memory\` action to store or update **various types of clinic-wide persistent information in a concise way**. This can include 'summaries of common patient encounters'+'summeries of previous **Clinic-wide AI Memory**'(e.g., 'Patient X, 50m, chronic gastritis, last visit YYYY-MM-DD, prescribed Z, follow-up in N days'+'**Clinic-wide AI Memory** summary'), notes on local health trends, common diagnostic patterns observed in the clinic, specific operational protocols. This memory is shared across all interactions for the clinic and helps tailor responses to its specific context over time.
    - **Recurring Medications Management:**
        - Use \`create_recurring_medication\` only when specifically asked to make a treatment or order recurring. It takes the same items structure as pharmacy orders but also requires \`frequency_days\` and \`next_delivery_date\`.
         - Use \`edit_recurring_medication\` to update an existing recurring medication entry. You must use \`serialNumber\` from the provided list.
        - Use \`delete_recurring_medication\` to stop/remove a recurring medication using its \`serialNumber\`.
**3.**Multiple Actions:** You can perform multiple actions (like ordering labs AND meds, adding complaints, updating patient information, and asking a follow-up question) in a single response by including multiple action objects within the main JSON array.


**4. Chief Complaints (Co):**
   - Analyze the provided chief complaints.
   - Present them in a table with two columns: 'Relevant Complaint (Score 8-10)' and 'Irrelevant Complaint (Score 0-7)', based on clinical relevance.

**5. Lab Tests (Lx):**
   - Suggest the most probable basic lab tests based on the clinical picture, ordered by likelihood.
   - If a basic test is positive/abnormal, suggest relevant advanced tests.
   - **Inventory Check:** Compare suggested tests against the provided inventory list.
   - **Table 1: Available Lab Tests:** Present tests *available* in the inventory in a table with columns: '**Clinical Importance (High/Medium/Low)**', 'Lab Test'. If suggesting tests from this table, prepare to use the \`create_lab_order\` tool in your response.
   - **Table 2: Unavailable Lab Tests:** Present tests *not available* in the inventory in a separate table with columns: '**Clinical Importance (High/Medium/Low)**', 'Unavailable Basic Test'. Clearly state these are not orderable via the tool (generate Table 2 only when required tests are unavailable).

**6. Differential Diagnosis (Dx):**
   - List potential differential diagnoses.
   - Provide a confidence score (0-10) for each.
   - Present in a table with columns: 'Differential Diagnosis' and 'Confidence Score (0-10)'.

**7. Treatment Plan (Tx):**
   - Create a structured treatment plan including ideal medications based on the diagnosis.
   - **Inventory Check:** Compare prescribed medications against the provided inventory list.
   - **Table 1: Available Medications:** Present medications *available* in the inventory in a table with columns: 'Time Frame' (from and to dates), 'Treatment Goal', 'Intervention', 'Medication Type', 'Drug Form', 'Drug Name', 'Regimen (Dose, Freq)', 'Duration'. Before using the \`create_pharmacy_order\` tool, check if an order for the same drug has already been placed for this patient today. If an order already exists for today, do *not* create a duplicate order. If no order exists for today, prepare to use the \`create_pharmacy_order\` tool in your response.
   - **Table 2: Unavailable Medications:** Present medications *not available* in the inventory in a separate table with columns: 'Unavailable Drug Name', 'Ideal Regimen', 'Reasoning/Indication', '**Clinical Importance (High/Medium/Low)**', 'Suggested Available Substitute (from inventory, if possible)'. Clearly state these are not orderable via the tool (generate Table 2 only when required medications are unavailable in the inventory).

**8. Tools / Actions:**
   When you need to perform actions like ordering tests/meds, updating patient info, or adding history, use the following JSON array format. The response should ONLY contain this JSON array, nothing else.

   ****STRICT JSON****>>>>>>\`\`\`json
[
  { "action": "create_pharmacy_order", "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "prescription_for_unavailable_drugs": "string | null" },
  { "action": "edit_pharmacy_order", "serialNumber": number, "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "items_to_remove": [ { "drug_id": number | null, "name": "Drug Name" } ], "status": "pending" | "billed" | "dispensed" | "cancelled", "prescription_for_unavailable_drugs": "string | null" },
  { "action": "create_lab_order", "tests": [ { "name": "Test Name" } ] },
  { "action": "edit_lab_order", "serialNumber": number, "tests": [ { "name": "Test Name" } ], "items_to_remove": [ { "id": number | string | null, "name": "Test Name" } ], "status": "pending" | "billed" | "collected" | "processing" | "report_ready" | "completed" | "cancelled" | "reported" },
  { "action": "add_complaint_history", "complaint": "Specific past complaint text..." },
  { "action": "update_patient_details", "name": "New Name (optional)", "age": number (optional), "gender": "M" | "F" | "O" | null (optional), "phone_number": "string (optional)" },
   { "action": "update_case_summary", "summary": "Concise summary text..." },
  { "action": "update_clinic_ai_memory", "memory_content": "New clinic-wide AI memory content..." },
  { "action": "create_recurring_medication", "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "frequency_days": number, "next_delivery_date": "YYYY-MM-DD" },
  { "action": "edit_recurring_medication", "serialNumber": number, "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "items_to_remove": [ { "drug_id": number | null, "name": "Drug Name" } ], "status": "active" | "paused" | "cancelled", "frequency_days": number, "next_delivery_date": "YYYY-MM-DD" },
  { "action": "delete_recurring_medication", "serialNumber": number }
]
\`\`\`

   - **Multiple Actions in One Response:** You can include multiple action objects within this single JSON array if several actions are required based on your analysis (e.g., adding history AND ordering labs).
   - **Prioritization Within the Array:** If including multiple actions, order them within the array according to this priority:
     1. \`add_complaint_history\`
     2. \`update_patient_details\`
     3. \`update_case_summary\`
     4. \`update_clinic_ai_memory\`
     5. \`create_lab_order\`
     6. \`edit_lab_order\`
     7. \`create_pharmacy_order\`
     8. \`edit_pharmacy_order\`
   - **Example (Multiple Actions):**
     \`\`\`json
     [
       { "action": "add_complaint_history", "complaint": "Patient also reports mild fever since yesterday." },
       { "action": "create_lab_order", "tests": [ { "name": "CBC" } ] }
     ]
     \`\`\`

   - **\`ask_followup_question\`**: Use this *separate* tool format (a single JSON object, NOT inside the array) only when you need clarification or missing information that prevents you from completing the assessment or required actions.
     \`\`\`json
     {
       "action": "ask_followup_question",
       "question": "Your clear, specific question here.",
       "options": ["Optional Answer 1", "Optional Answer 2"] // Optional: Provide 2-5 choices
     }
     \`\`\`
     *Description:* Ask the user a question to gather additional information needed to complete the task. This tool should be used when you encounter ambiguities, need clarification, or require more details to proceed effectively. It allows for interactive problem-solving by enabling direct communication with the user. Use this tool judiciously to maintain a balance between gathering necessary information and avoiding excessive back-and-forth.
     *Parameters:*
       - question: (required) The question to ask the user. This should be a clear, specific question that addresses the information you need.
       - options: (optional) An array of 2-5 options for the user to choose from. Each option should be a string describing a possible answer. You may not always need to provide options, but it may be helpful in many cases where it can save the user from having to type out a response manually.


**Important:**
- Ensure all tables are clearly formatted using Markdown.
- Strictly adhere to the inventory constraints for labs and medications when deciding whether to use \`create_lab_order\` or \`create_pharmacy_order\`.
- When using actions, provide ONLY the JSON array (or the single JSON object for \`ask_followup_question\`) as the *very last* part of your response, after all other content including tables. Do not include any other text after the JSON.

**Plan Mode:**
When the user asks a question about a patient's condition or general medical topics (not entering new medical data), respond in PLAN MODE. In this mode, focus on answering the user's inquiry, clarifying their request, brainstorming ideas, or architecting a solution (like exploring treatment options). Ask clarifying questions if needed. Present detailed plans or explanations **using clear table formats and markdown (like bolding) for easy readability**. Engage in back-and-back discussion to finalize details. Do not use action tools (\`create_lab_order\`, \`create_pharmacy_order\`, \`add_complaint_history\`, \`update_patient_details\`) while in PLAN MODE).`,LW="gemini-3-flash-preview";async function OW(){const e=eb();if(!e)throw new Error("Authentication token not found. Please log in.");try{const r=(await(await fe("/api/clinics/settings",{headers:{Authorization:`Bearer ${e}`}})).json()).gemini_api_key;if(r)return console.log("Using clinic-specific Gemini API key."),r}catch(n){console.warn("Failed to fetch clinic-specific Gemini API key, trying global fallback.",n)}try{const r=(await(await fe("/api/super-admin-settings/gemini-api-key",{headers:{Authorization:`Bearer ${e}`}})).json()).gemini_api_key;if(r)return console.log("Using global Gemini API key."),r}catch(n){console.warn("Failed to fetch global Gemini API key.",n)}throw new Error("Gemini API key not found. Please contact your administrator.")}let C0=null;async function FW(){if(!C0){const e=await OW();C0=new X2({apiKey:e})}return C0}async function $W(e,n){const{query:t,currentDateTime:r,patientName:a,patientAge:l,patientGender:o,case_summary:f,case_summary_last_updated:u,clinic_ai_memory:d,clinic_ai_memory_last_updated:h,clinic_wide_system_prompt:g,labHistory:b,pharmacyOrders:v,pastComplaints:S,recurringMedications:k,pharmacyInventory:T,labInventory:E}=e;let P=`Patient Complaint: ${t}`;if(f&&(P+=`

--- Case Summary (Provided by Doctor) ---
${f}`,u))try{const H=new Date(u).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});P+=`
(Last Updated: ${H})`}catch{console.warn(`Could not format case_summary_last_updated: ${u}`),P+=`
(Last Updated: ${u})`}if(a&&(P+=`

Patient Name: ${a}`),l!=null&&(P+=`
Patient Age: ${l}`),o&&(P+=`
Patient Gender: ${o}`),r)try{const H=new Date(r).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});P+=`

Current Interaction Time: ${H}`}catch{console.warn(`Could not format currentDateTime: ${r}`),P+=`

Current Interaction Time: ${r}`}if(d&&(P+=`

--- Clinic-wide AI Memory/Context ---
${d}`,h))try{const H=new Date(h).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});P+=`
(Last Updated: ${H})`}catch{console.warn(`Could not format clinic_ai_memory_last_updated: ${h}`),P+=`
(Last Updated: ${h})`}let I="";b&&Array.isArray(b)&&b.length>0&&(I=`

--- Lab History (Orders & Reports) ---
`,b.forEach(H=>{let ee="Unknown Date";try{ee=new Date(H.orderDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab order: ${H.orderDate}`)}if(I+=`
Order #${H.serialNumber} Date: ${ee} (Status: ${H.status})
`,I+=`Tests: ${H.tests.map(Z=>Z.name).join(", ")}
`,H.report){let Z="Unknown Date";try{Z=new Date(H.report.reportDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab report: ${H.report.reportDate}`)}I+=`  -> Report Date: ${Z}
`,H.report.tests&&Array.isArray(H.report.tests)?(I+=`     Findings:
`,H.report.tests.forEach(te=>{I+=`       - Test: ${te.testName}
`,te.parameters&&Array.isArray(te.parameters)&&te.parameters.forEach(Q=>{I+=`         - ${Q.name}: ${Q.value} (Normal: ${Q.normal_range})
`})})):(I+=`     Findings: ${H.report.reportContent||"N/A"}
`,H.report.error&&(I+=`     Note: ${H.report.error}
`))}I+=`---
`}),P+=I);let V="";v&&Array.isArray(v)&&v.length>0&&(V=`

--- Recent Pharmacy Orders ---
`,v.forEach(H=>{let ee="Unknown Date/Time";try{ee=new Date(H.date).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for pharmacy order: ${H.date}`)}V+=`
Order #${H.serialNumber} Date/Time: ${ee} (Status: ${H.status})
`,V+=`Prescribed By: ${H.prescribedBy||"N/A"}
`,H.dispensedBy&&(V+=`Dispensed By: ${H.dispensedBy}
`),V+=`Medications:
`,H.medications.forEach(Z=>{V+=`  - ${Z.name} (Qty: ${Z.quantity}`,Z.tabletsPerDay&&(V+=`, ${Z.tabletsPerDay}/day`),Z.numberOfDays&&(V+=` for ${Z.numberOfDays} days`),V+=`)
`}),H.prescriptionForUnavailableDrugs&&(V+=`  Prescription for Unavailable Drugs: ${H.prescriptionForUnavailableDrugs}
`),V+=`---
`}),P+=V);let F="";S&&Array.isArray(S)&&S.length>0&&(F=`

--- Past Complaints History ---
`,S.forEach(H=>{let ee="Unknown Date/Time";try{ee=new Date(H.createdAt).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for past complaint: ${H.createdAt}`)}F+=`
Date/Time: ${ee}
Complaint: ${H.complaint||"N/A"}
---
`}),P+=F);let O="";k&&Array.isArray(k)&&k.length>0&&(O=`

--- Recurring Medications ---
`,k.forEach((H,ee)=>{var Z;O+=`
#${ee+1} Status: ${H.status}, Freq: ${H.frequency_days} days, Next: ${H.next_delivery_date}
`,(Z=H.medications)==null||Z.forEach(te=>{O+=`  - ${te.name} (Qty: ${te.pack_quantity||0}P / ${te.loose_quantity||0}L, ${te.tabletsPerDay}/day for ${te.numberOfDays} days)
`}),O+=`---
`}),P+=O);let B="";T&&Array.isArray(T)&&T.length>0&&(B=`

--- Current Pharmacy Inventory (Stock Levels) ---
`,T.forEach(H=>{B+=`- ${H.name} (Pack: ${H.unit??"N/A"}): ${H.quantity_in_stock??"N/A"}
`}),P+=B);let U="";E&&Array.isArray(E)&&E.length>0&&(U=`

--- Available Lab Tests ---
`,E.forEach(H=>{U+=`- ${H.name} (Price: ${H.price??"N/A"})
`}),P+=U);const z=[{text:RW}];g&&g.trim()!==""&&z.push({text:`--- Additional Clinic-Specific Instructions ---
${g}`});const $=[{text:P}];if(n){const H=new FileReader,ee=await new Promise((Z,te)=>{H.onloadend=()=>{typeof H.result=="string"?Z(H.result.split(",")[1]):te(new Error("Failed to read image file as base64."))},H.onerror=te,H.readAsDataURL(n)});$.push({inlineData:{mimeType:n.type,data:ee}})}const R=[];z.length>0&&R.push({role:"user",parts:z}),R.push({role:"user",parts:$});try{const H={model:LW,contents:R,generationConfig:{temperature:.7,maxOutputTokens:1024,responseMimeType:"text/plain"}},Z=await(await FW()).models.generateContentStream(H);let te="";for await(const Q of Z)if(Q&&typeof Q.text=="function"){const q=Q.text;q&&(te+=q)}else Q&&Q.candidates&&Q.candidates[0]&&Q.candidates[0].content&&Q.candidates[0].content.parts&&Q.candidates[0].content.parts[0]&&Q.candidates[0].content.parts[0].text&&(te+=Q.candidates[0].content.parts[0].text);if(te&&te.trim()!=="")return te.trim();throw console.error("Empty or invalid response received from Gemini API stream."),new Error("Failed to get suggestion from AI (Gemini). Empty or invalid stream response.")}catch(H){console.error("Error calling Gemini API:",H);let ee="Failed to get suggestion from Gemini.";throw H.message&&(ee=`Error processing Gemini request: ${H.message}`),new Error(ee)}}const _0=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return n?parseInt(n[1],10):1},zW=w.forwardRef(({recordId:e,patientId:n,patientDetails:t,caseSummary:r,caseSummaryUpdatedAt:a,clinicSettings:l,userMessages:o,selectedImageFile:f,pendingLabOrders:u,labReports:d,pastComplaints:h,pharmacyOrders:g,recurringMedications:b,pharmacyInventory:v,labInventory:S,setCurrentComplaint:k,setAiResponse:T,setAiResponseText:E,setAiResponseJsonString:P,setShowAiJsonDetails:I,setIsLoadingAi:V,setAiError:F,setIsSubmittingAiOrder:O,setAiOrderSubmissionStatus:B,setIsSubmittingAiLabOrder:U,setAiLabOrderSubmissionStatus:z,setIsSubmittingAiComplaint:$,setAiComplaintSubmissionStatus:R,setIsUpdatingCaseSummary:H,setAiCaseSummaryUpdateStatus:ee,setCaseSummary:Z,setCaseSummaryUpdatedAt:te,setIsUpdatingAiMemoryByAI:Q,setAiMemoryUpdateByAIStatus:q,setFollowUpQuestion:W,setFollowUpOptions:ne,setError:A,setIsSavingAiResponse:ie,setSaveAiResponseError:se,fetchPharmacyOrdersData:M,fetchPendingLabOrdersData:ce,fetchLabReportsData:ve,fetchPastComplaintsData:le,fetchRecurringMedicationsData:xe,fetchPatientDetails:ue,setClinicSettings:ze,setEditedAiMemory:tt,handleDeleteItem:ft},Re)=>{let je;const he=async(Je,nt,Ge,St=0)=>{let It;const oe=["AI response did not contain a recognized function call","AI response did not result in a recognized or performed function call"].some(J=>{var de;return(de=nt.message)==null?void 0:de.includes(J)});Ge&&oe?It=`AI Error: ${nt.message}

${Ge}`:(It=`I encountered a frontend error while trying to execute the '${Je}' function. The error message is: "${nt.message}". Based on this error, please analyze what went wrong and either correct the function call and try again, or explain the problem.`,(Je==="create_pharmacy_order"||Je==="edit_pharmacy_order")&&(It+=`

IMPORTANT: When ordering medication, please first check if the medication ordered matches the exact name given in the inventory. If the name itself is not given in the inventory, you can also use 'prescription_for_unavailable_drugs' to write a prescription for unavailable drugs.`),Ge&&(It+=`

The original AI response that caused the error was:
\`\`\`
${Ge}
\`\`\``)),await je(It,St+1)},Ae=async(Je,nt)=>{B(null),z(null),R(null),ee(null),q(null),W(null),ne([]),A(null);let Ge=!1,St=null;const It=/```json\s*([\s\S]*?)\s*```/,Vt=Je.match(It);if(Vt&&Vt[1])St=Vt[1];else{const oe=Je.trim();if(oe.startsWith("{")&&oe.endsWith("}"))St=oe;else if(oe.startsWith("[")&&oe.endsWith("]"))St=oe;else throw new Error("AI response did not contain a recognized function call.")}if(St)try{const oe=JSON.parse(St),J=Array.isArray(oe)?oe:[oe],de=[];let Be=null;for(const be of J){if(be.action==="ask_followup_question"){Be=be,Ge=!0;continue}be.action==="update_clinic_ai_memory"&&typeof be.memory_content=="string"?(Ge=!0,de.push((async()=>{Q(!0),q("Processing AI mem...");try{if(!l)throw new Error("Clinic settings not loaded, cannot update AI memory.");const Fe={...l,aiMemory:be.memory_content.trim(),admissionCharge:l.admissionCharge,perDayCharge:l.perDayCharge,otherCharges:l.otherCharges,clinicWideSystemPrompt:l.clinicWideSystemPrompt},$e=await fe("/api/clinics/settings",{method:"PUT",body:JSON.stringify(Fe)});if(!$e.ok){const rt=await $e.json().catch(()=>({}));throw new Error(rt.message||`AI-triggered clinic memory update failed: ${$e.statusText}`)}const st=await $e.json();ze({admissionCharge:parseFloat(st.settings.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(st.settings.perDayCharge||0).toFixed(2),otherCharges:parseFloat(st.settings.otherCharges||0).toFixed(2),aiMemory:st.settings.aiMemory||"",aiMemoryUpdatedAt:st.settings.aiMemoryUpdatedAt||null,clinicWideSystemPrompt:st.settings.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:st.settings.clinicWideSystemPromptUpdatedAt||null}),tt(st.settings.aiMemory||""),q("AI mem updated!")}catch(Fe){await he(be.action,Fe,Je,nt)}finally{Q(!1)}})())):be.action==="create_pharmacy_order"&&(Array.isArray(be.items)||be.prescription_for_unavailable_drugs&&be.prescription_for_unavailable_drugs.trim()!=="")?(Ge=!0,de.push((async()=>{O(!0),B("Processing order...");try{if(!n)throw new Error("Missing patient ID for pharmacy order.");const Fe=[];let $e=null;if(Array.isArray(be.items))for(const Ve of be.items){const{pack_price:qe,loose_price:Ke,total_price:We,price:zt,..._t}=Ve;let rn;if(_t.drug_id?rn=v.find(Si=>Si.id===_t.drug_id):_t.name&&(rn=Ah(_t.name,v)),!rn){$e=`Drug "${_t.name||_t.drug_id||"Unknown"}" not found or no close match.`;break}let Ot;const Yn=_t.tabletsPerDay;if(Yn&&Number(Yn)>0){const Si=Number(Yn);Number.isInteger(Si)?Ot=Si:Ot=null}else Ot=1;const Wn=Number(_t.numberOfDays)||1,Ei=Number(_t.pack_quantity)||0,Ti=Number(_t.loose_quantity)||0;if(Ei<=0&&Ti<=0){$e=`Invalid quantity for ${rn.name}. Pack quantity or loose quantity must be greater than 0.`;break}const wn=rn.unit,Bn=_0(wn),Ji=Number(rn.price),li=Ji,Ln=Bn>0?Ji/Bn:0,oi=Ei*li+Ti*Ln;Fe.push({drug_id:rn.id?String(rn.id):null,name:rn.name,pack_quantity:Ei,loose_quantity:Ti,tabletsPerDay:Ot,numberOfDays:Wn,price:Ji,directions_to_use:_t.directions_to_use||void 0,box_number:_t.box_number||void 0,isLoose:_t.isLoose||void 0,unit:wn||void 0,pack_price:parseFloat(li.toFixed(2)),loose_price:parseFloat(Ln.toFixed(2)),total_price:parseFloat(oi.toFixed(2))})}if($e)throw new Error($e);const st=Fe.reduce((Ve,qe)=>Ve+qe.total_price,0),rt={patient_id:n,items:Fe.map(({drug_id:Ve,name:qe,pack_quantity:Ke,loose_quantity:We,tabletsPerDay:zt,numberOfDays:_t,directions_to_use:rn,box_number:Ot,isLoose:Yn,unit:Wn,pack_price:Ei,loose_price:Ti,total_price:wn})=>({drug_id:Ve,name:qe,pack_quantity:Ke,loose_quantity:We,tabletsPerDay:zt,numberOfDays:_t,directions_to_use:rn,box_number:Ot,isLoose:Yn,unit:Wn,pack_price:Ei,loose_price:Ti,total_price:wn})),prescription_for_unavailable_drugs:be.prescription_for_unavailable_drugs||null,order_total:parseFloat(st.toFixed(2))},Le=await fe("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(rt)});if(!Le.ok){const Ve=await Le.json().catch(()=>({}));throw new Error(Ve.message||`AI order creation failed: ${Le.statusText}`)}B("Order created!"),n&&M(n)}catch(Fe){await he(be.action,Fe,Je,nt)}finally{O(!1)}})())):be.action==="update_patient_details"?(Ge=!0,de.push((async()=>{V(!0),A(null);try{if(!n)throw new Error("Missing patient ID for updating details.");const Fe={};let $e=!1;if(be.name!==void 0&&typeof be.name=="string"&&(Fe.name=be.name,$e=!0),be.age!==void 0&&typeof be.age=="number"&&(Fe.age=be.age,$e=!0),be.gender!==void 0&&typeof be.gender=="string"){if(!["M","F","O",null,""].includes(be.gender))throw new Error(`Invalid gender specified: "${be.gender}". Use M, F, or O.`);Fe.gender=be.gender===""?null:be.gender,$e=!0}if(be.phone_number!==void 0&&(typeof be.phone_number=="string"||be.phone_number===null)&&(Fe.phone_number=be.phone_number,$e=!0),!$e)throw new Error("No valid patient details provided for update.");const st=await fe(`/api/patients/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Fe)});if(!st.ok){const rt=await st.json().catch(()=>({}));throw new Error(rt.message||`AI patient update failed: ${st.statusText}`)}await st.json(),ue(n)}catch(Fe){await he(be.action,Fe,Je,nt)}finally{V(!1)}})())):be.action==="create_lab_order"&&Array.isArray(be.tests)&&be.tests.length>0?(Ge=!0,de.push((async()=>{U(!0),z("Processing lab...");try{if(!n)throw new Error("Missing patient ID for lab order.");const Fe=[];let $e=null;for(const Le of be.tests){let Ve;if(Le.id?Ve=S.find(Ke=>String(Ke.id)===String(Le.id)):Le.name&&(Ve=Ah(Le.name,S)),!Ve){$e=`Lab test "${Le.name||Le.id||"Unknown"}" not found or no close match.`;break}const qe=typeof Ve.price=="string"?parseFloat(Ve.price):Ve.price;Fe.push({id:Ve.id,name:Ve.name,price:qe,description:Ve.description,default_parameters:Ve.default_parameters})}if($e)throw new Error($e);const st={patient_id:n,tests:Fe.map(Le=>({id:Le.id,name:Le.name,price:Le.price}))},rt=await fe("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(st)});if(!rt.ok){const Le=await rt.json().catch(()=>({}));throw new Error(Le.message||`AI lab order creation failed: ${rt.statusText}`)}await rt.json(),z("Success: Lab order created!"),n&&ce(n)}catch(Fe){await he(be.action,Fe,Je,nt)}finally{U(!1)}})())):be.action==="edit_pharmacy_order"?(Ge=!0,de.push((async()=>{O(!0),B("Processing pharmacy order edit...");try{const Fe=be.serialNumber;let $e;if(Fe?$e=[...g].sort((We,zt)=>{const _t=new Date(We.date).getTime(),rn=new Date(zt.date).getTime();return _t-rn})[Fe-1]:$e=g.sort((Ke,We)=>new Date(Ke.date).getTime()-new Date(We.date).getTime()).find(Ke=>Ke.status==="pending"),!$e)throw new Error(`Pharmacy order with serial number ${Fe} not found, or no pending order to edit.`);const st=$e.id,rt=be.items,Le=be.items_to_remove,Ve=be.status,qe=be.prescription_for_unavailable_drugs;if((!rt||Array.isArray(rt)&&rt.length===0)&&!Le&&!Ve&&(!qe||qe.trim()===""))throw new Error("No items, items to remove, status, or unavailable drugs prescription provided for pharmacy order edit.");if(Ve==="cancelled")await ft({type:"Pharmacy Order",data:$e}),B("Success: Pharmacy order cancelled and deleted!");else{let Ke=[...$e.medications];if(Array.isArray(Le)&&Le.length>0&&(Ke=Ke.filter(Ot=>{const Yn=Ot.name.toLowerCase().replace(/\s+/g," ").trim();return!Le.some(Wn=>{if(Wn.drug_id&&String(Ot.drug_id)===String(Wn.drug_id))return!0;if(Wn.name){const Ei=Wn.name.toLowerCase().replace(/\s+/g," ").trim();return Yn===Ei}return!1})})),Array.isArray(rt)&&rt.length>0)for(const Ot of rt){const{pack_price:Yn,loose_price:Wn,total_price:Ei,price:Ti,...wn}=Ot;let Bn;if(wn.drug_id?Bn=v.find(Qr=>Qr.id===String(wn.drug_id)):wn.name&&(Bn=Ah(wn.name,v)),!Bn)throw new Error(`Drug "${wn.name||wn.drug_id||"Unknown"}" not found or no close match for update.`);let Ji;const li=wn.tabletsPerDay;if(li&&Number(li)>0){const Qr=Number(li);Number.isInteger(Qr)?Ji=Qr:Ji=null}else Ji=1;const Ln=Number(wn.numberOfDays)||1,oi=Number(wn.pack_quantity)||0,Si=Number(wn.loose_quantity)||0,Hi=Ke.findIndex(Qr=>Qr.drug_id&&Qr.drug_id===(Bn==null?void 0:Bn.id)||Qr.name.toLowerCase()===(Bn==null?void 0:Bn.name.toLowerCase()));if(oi<=0&&Si<=0){Hi!==-1&&Ke.splice(Hi,1);continue}const Yo={drug_id:Bn.id?String(Bn.id):null,name:Bn.name,pack_quantity:oi,loose_quantity:Si,tabletsPerDay:Ji,numberOfDays:Ln,price:Bn.price,directions_to_use:wn.directions_to_use||void 0,box_number:wn.box_number||void 0,isLoose:wn.isLoose||void 0,unit:Bn.unit||void 0};Hi!==-1?Ke[Hi]={...Ke[Hi],...Yo}:Ke.push(Yo)}const We=Ke.map(Ot=>{const Yn=v.find(Ji=>Ji.id===Ot.drug_id),Wn=Yn?_0(Yn.unit):1,Ei=Number(Yn==null?void 0:Yn.price)||0,Ti=Ei,wn=Wn>0?Ei/Wn:0,Bn=(Ot.pack_quantity||0)*Ti+(Ot.loose_quantity||0)*wn;return{...Ot,pack_price:parseFloat(Ti.toFixed(2)),loose_price:parseFloat(wn.toFixed(2)),total_price:parseFloat(Bn.toFixed(2))}}),zt=We.reduce((Ot,Yn)=>Ot+Yn.total_price,0),_t={};if(We.length>0?_t.items=We.map(({drug_id:Ot,name:Yn,pack_quantity:Wn,loose_quantity:Ei,tabletsPerDay:Ti,numberOfDays:wn,directions_to_use:Bn,box_number:Ji,isLoose:li,unit:Ln,pack_price:oi,loose_price:Si,total_price:Hi})=>({drug_id:Ot,name:Yn,pack_quantity:Wn,loose_quantity:Ei,tabletsPerDay:Ti===null?null:Ti,numberOfDays:wn,directions_to_use:Bn,box_number:Ji,isLoose:li,unit:Ln,pack_price:oi,loose_price:Si,total_price:Hi})):rt&&rt.length>0&&(_t.items=[]),qe!==void 0&&(_t.prescription_for_unavailable_drugs=qe),_t.order_total=parseFloat(zt.toFixed(2)),Ve){if(!["pending","billed","dispensed","cancelled"].includes(Ve))throw new Error(`Invalid status for pharmacy order: ${Ve}.`);_t.status=Ve}const rn=await fe(`/api/pharmacy-orders/${st}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(_t)});if(!rn.ok){const Ot=await rn.json().catch(()=>({}));throw new Error(Ot.message||`AI pharmacy order edit failed: ${rn.statusText}`)}B("Success: Pharmacy order updated!"),n&&M(n)}}catch(Fe){await he(be.action,Fe,Je,nt)}finally{O(!1)}})())):be.action==="edit_lab_order"?(Ge=!0,de.push((async()=>{U(!0),z("Processing lab order edit...");try{const Fe=u.sort((Ve,qe)=>new Date(qe.createdAt).getTime()-new Date(Ve.createdAt).getTime()).find(Ve=>Ve.status==="pending");if(!Fe)throw new Error("No pending lab orders found to edit.");const $e=Fe.id,st=be.tests,rt=be.items_to_remove,Le=be.status;if(!st&&!rt&&!Le)throw new Error("No tests, items to remove, or status provided for lab order edit.");if(Le==="cancelled"){if(Fe.report)throw new Error("Cannot delete lab order with an associated report. Please delete the report first.");await ft({type:"Lab Order",data:Fe}),z("Success: Lab order cancelled and deleted!")}else{let Ve=[...Fe.tests];if(Array.isArray(rt)&&rt.length>0&&(Ve=Ve.filter(Ke=>!rt.some(We=>!!(We.id&&String(Ke.id)===String(We.id)||We.name&&Ke.name.toLowerCase()===We.name.toLowerCase())))),Array.isArray(st)&&st.length>0)for(const Ke of st){let We;if(Ke.id?We=S.find(Ot=>String(Ot.id)===String(Ke.id)):Ke.name&&(We=Ah(Ke.name,S)),!We)throw new Error(`Lab test "${Ke.name||Ke.id||"Unknown"}" not found or no close match for update.`);const zt=typeof We.price=="string"?parseFloat(We.price):We.price,_t=Ve.findIndex(Ot=>Ot.id&&String(Ot.id)===String(We==null?void 0:We.id)||Ot.name.toLowerCase()===(We==null?void 0:We.name.toLowerCase())),rn={id:We.id,name:We.name,price:zt};_t!==-1?Ve[_t]={...Ve[_t],...rn}:Ve.push(rn)}const qe=await fe(`/api/lab/orders/${$e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({tests:Ve,status:Le||Fe.status})});if(!qe.ok){const Ke=await qe.json().catch(()=>({}));throw new Error(Ke.message||`AI lab order edit failed: ${qe.statusText}`)}z("Success: Lab order updated!"),n&&(ce(n),ve(n))}}catch(Fe){await he(be.action,Fe,Je,nt)}finally{U(!1)}})())):be.action==="create_recurring_medication"&&(Array.isArray(be.items)||be.prescription_for_unavailable_drugs&&be.prescription_for_unavailable_drugs.trim()!=="")?(Ge=!0,de.push((async()=>{O(!0),B("Processing recurring order...");try{if(!n)throw new Error("Missing patient ID for recurring medication.");const Fe=[];let $e=null;if(Array.isArray(be.items))for(const Le of be.items){let Ve=Me(Le,v);if(!Ve){$e=`Drug "${Le.name||Le.drug_id}" not found.`;break}const{pack_quantity:qe,loose_quantity:Ke,tabletsPerDay:We,numberOfDays:zt,pack_price:_t,loose_price:rn,total_price:Ot}=De(Le,Ve);Fe.push({drug_id:Ve.id,name:Ve.name,pack_quantity:qe,loose_quantity:Ke,tabletsPerDay:We,numberOfDays:zt,price:Ve.price,directions_to_use:Le.directions_to_use,unit:Ve.unit,pack_price:_t,loose_price:rn,total_price:Ot})}if($e)throw new Error($e);const st={patient_id:n,medications:Fe,frequency_days:be.frequency_days||30,next_delivery_date:be.next_delivery_date||new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],status:"active"},rt=await fe("/api/recurring-medications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(st)});if(!rt.ok){const Le=await rt.json().catch(()=>({}));throw new Error(Le.message||`AI recurring medication creation failed: ${rt.statusText}`)}B("Recurring medication created!"),n&&xe(n)}catch(Fe){await he(be.action,Fe,Je,nt)}finally{O(!1)}})())):be.action==="edit_recurring_medication"?(Ge=!0,de.push((async()=>{O(!0),B("Processing recurring edit...");try{const Fe=be.serialNumber,$e=be.id;let st;if($e?st=b.find(qe=>qe.id===$e):Fe&&(st=b[Fe-1]),!st)throw new Error("Recurring medication not found.");const rt={};be.status&&(rt.status=be.status),be.frequency_days&&(rt.frequency_days=be.frequency_days),be.next_delivery_date&&(rt.next_delivery_date=be.next_delivery_date);let Le=[...st.medications];if(Array.isArray(be.items_to_remove)&&(Le=Le.filter(qe=>!be.items_to_remove.some(Ke=>!!(Ke.drug_id&&String(qe.drug_id)===String(Ke.drug_id)||Ke.name&&qe.name.toLowerCase().trim()===Ke.name.toLowerCase().trim())))),Array.isArray(be.items))for(const qe of be.items){let Ke=Me(qe,v);if(!Ke)throw new Error(`Drug "${qe.name}" not found.`);const We=De(qe,Ke),zt={drug_id:Ke.id,name:Ke.name,...We,directions_to_use:qe.directions_to_use,unit:Ke.unit},_t=Le.findIndex(rn=>String(rn.drug_id)===String(Ke.id));_t!==-1?Le[_t]={...Le[_t],...zt}:Le.push(zt)}(Array.isArray(be.items_to_remove)||Array.isArray(be.items))&&(rt.medications=Le);const Ve=await fe(`/api/recurring-medications/${st.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(rt)});if(!Ve.ok){const qe=await Ve.json().catch(()=>({}));throw new Error(qe.message||`AI recurring edit failed: ${Ve.statusText}`)}B("Recurring medication updated!"),n&&xe(n)}catch(Fe){await he(be.action,Fe,Je,nt)}finally{O(!1)}})())):be.action==="delete_recurring_medication"?(Ge=!0,de.push((async()=>{O(!0),B("Processing recurring deletion...");try{const Fe=be.serialNumber,$e=be.id;let st;if($e?st=b.find(Le=>Le.id===$e):Fe&&(st=b[Fe-1]),!st)throw new Error("Recurring medication not found.");const rt=await fe(`/api/recurring-medications/${st.id}`,{method:"DELETE"});if(!rt.ok){const Le=await rt.json().catch(()=>({}));throw new Error(Le.message||`AI recurring deletion failed: ${rt.statusText}`)}B("Recurring medication deleted!"),n&&xe(n)}catch(Fe){await he(be.action,Fe,Je,nt)}finally{O(!1)}})())):be.action==="add_complaint_history"&&be.complaint?(Ge=!0,de.push((async()=>{$(!0),R("Processing Hx...");try{if(!e)throw new Error("Missing Record ID for complaint history.");if(!be.complaint||typeof be.complaint!="string")throw new Error("Invalid AI complaint text.");const Fe={complaint:be.complaint.trim()},$e=await fe(`/api/queue/doctor/complaint/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Fe)});if(!$e.ok){const st=await $e.json().catch(()=>({}));throw new Error(st.message||`AI complaint add failed: ${$e.statusText}`)}k(Fe.complaint),R("Hx updated!"),n&&le(n)}catch(Fe){await he(be.action,Fe,Je,nt)}finally{$(!1)}})())):be.action==="update_case_summary"&&be.summary?(Ge=!0,de.push((async()=>{H(!0),ee("Processing summary...");try{if(!e)throw new Error("Missing Record ID for case summary update.");if(typeof be.summary!="string")throw new Error("Invalid AI case summary text.");const Fe={case_summary:be.summary.trim()},$e=await fe(`/api/queue/doctor/complaint/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Fe)});if(!$e.ok){const rt=await $e.json().catch(()=>({}));throw new Error(rt.message||`AI case summary update failed: ${$e.statusText}`)}const st=await $e.json();Z(st.case_summary),te(st.updatedAt),ee("Summary updated!")}catch(Fe){await he(be.action,Fe,Je,nt)}finally{H(!1)}})())):be.action&&console.warn(`Unrecognized AI action: ${be.action}`)}if(await Promise.allSettled(de),Be)typeof Be.question=="string"?(W(Be.question),ne(Array.isArray(Be.options)?Be.options:[])):console.warn("Invalid 'ask_followup_question' format.");else if(!Ge)throw new Error("AI response did not result in a recognized or performed function call.")}catch(oe){await he("parse_json_actions",oe,Je,nt)}else throw new Error("AI response did not contain a recognized function call.")};je=async(Je,nt=0)=>{if(nt>1){F("AI call failed after multiple retries. Please try a different prompt."),V(!1);return}V(!0),F(null);let Ge;const It=[...o,Je].join(`

`);try{const Vt=new Map;(u??[]).forEach($e=>{Vt.set($e.id,{...$e})}),(d??[]).forEach($e=>{if(!Vt.has($e.id))Vt.set($e.id,{id:$e.id,patient_id:$e.patient_id,tests:$e.tests,status:$e.status,createdAt:$e.createdAt,report:$e});else{const st=Vt.get($e.id);st&&(st.report=$e,st.status=$e.status)}});const oe=Array.from(Vt.values());oe.sort(($e,st)=>new Date(st.createdAt).getTime()-new Date($e.createdAt).getTime());const J=oe.map(($e,st)=>{let rt=null;if($e.report)try{const Le=typeof $e.report.report_content=="string"?$e.report.report_content:JSON.stringify($e.report.report_content||{}),Ve=JSON.parse(Le||"{}"),qe=($e.report.tests||[]).map(Ke=>{const We=Ve[Ke.id]||{},zt=_t=>({name:_t.name,value:We[_t.name]!==void 0?String(We[_t.name]):String(_t.defaultValue),normal_range:_t.normal_range||"N/A"});return{testId:Ke.id,testName:Ke.name,parameters:(Ke.default_parameters||[]).map(zt)}});rt={reportId:$e.report.reportId,reportDate:$e.report.report_date,tests:qe}}catch{rt={reportId:$e.report.reportId,reportDate:$e.report.report_date,reportContent:typeof $e.report.report_content=="string"?$e.report.report_content:JSON.stringify($e.report.report_content),error:"Failed to parse report content JSON."}}return{serialNumber:oe.length-st,orderId:$e.id,orderDate:isNaN(new Date($e.createdAt).getTime())?$e.createdAt:new Date($e.createdAt).toISOString(),tests:$e.tests.map(Le=>({id:Le.id,name:Le.name,price:Le.price})),status:$e.status,report:rt}}),de=h.map($e=>{try{return{...$e,createdAt:isNaN(new Date($e.createdAt).getTime())?$e.createdAt:new Date($e.createdAt).toISOString()}}catch{return $e}}),be=[...g].sort(($e,st)=>{const rt=new Date($e.date).getTime(),Le=new Date(st.date).getTime();return rt-Le}).map(($e,st)=>{try{return{serialNumber:st+1,...$e,date:$e.date&&!isNaN(new Date($e.date).getTime())?new Date($e.date).toISOString():$e.date}}catch{return{serialNumber:st+1,...$e}}}),Fe={query:It,currentDateTime:new Date().toISOString(),patientName:(t==null?void 0:t.name)||"",patientAge:(t==null?void 0:t.age)||void 0,patientGender:(t==null?void 0:t.gender)||void 0,case_summary:r||"",case_summary_last_updated:a?new Date(a).toISOString():void 0,clinic_ai_memory:(l==null?void 0:l.aiMemory)||"",clinic_ai_memory_last_updated:l!=null&&l.aiMemoryUpdatedAt?new Date(l.aiMemoryUpdatedAt).toISOString():void 0,clinic_wide_system_prompt:(l==null?void 0:l.clinicWideSystemPrompt)||"",labHistory:J,pharmacyOrders:be,pastComplaints:de,recurringMedications:b,pharmacyInventory:v,labInventory:S};if(console.log("DEBUG: Payload before sending to Gemini API:",JSON.stringify(Fe,null,2)),Ge=await $W(Fe,f),Ge){T(Ge);const $e=/```json\s*([\s\S]*?)\s*```/,st=Ge.match($e);if(st&&st[1])E(Ge.replace($e,"").trim()),P(st[1].trim());else{const rt=Ge.trim();if(rt.startsWith("{")&&rt.endsWith("}"))try{JSON.parse(rt),E(""),P(rt)}catch{E(rt),P(null)}else if(rt.startsWith("[")&&rt.endsWith("]"))try{JSON.parse(rt),E(""),P(rt)}catch{E(rt),P(null)}else E(rt),P(null)}I(!1),n&&Ge&&await we(n,Ge),await Ae(Ge,nt),k("")}else throw new Error("Invalid AI response format.")}catch(Vt){await he("call_generative_api",Vt,Ge,nt)}finally{V(!1)}};const we=async(Je,nt)=>{ie(!0),se(null);try{const Ge={ai_response:nt},St=await fe(`/api/patients/${Je}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ge)});if(!St.ok){const It=await St.json().catch(()=>({}));throw new Error(It.message||`Failed to save AI response to patient: ${St.statusText}`)}}catch(Ge){se(`AI Response Save Error: ${Ge.message}`)}finally{ie(!1)}},Me=(Je,nt)=>{if(Je.drug_id)return nt.find(Ge=>Ge.id===String(Je.drug_id));if(Je.name)return Ah(Je.name,nt)},De=(Je,nt)=>{const Ge=Number.isInteger(Number(Je.tabletsPerDay))?Number(Je.tabletsPerDay):1,St=Number(Je.numberOfDays)||1,It=Number(Je.pack_quantity)||0,Vt=Number(Je.loose_quantity)||0,oe=_0(nt.unit),J=Number(nt.price),de=J,Be=oe>0?J/oe:0,be=It*de+Vt*Be;return{pack_quantity:It,loose_quantity:Vt,tabletsPerDay:Ge,numberOfDays:St,pack_price:parseFloat(de.toFixed(2)),loose_price:parseFloat(Be.toFixed(2)),total_price:parseFloat(be.toFixed(2))}};return w.useImperativeHandle(Re,()=>({callGenerativeApi:je})),null}),BW={};function Rw(e,n){const t=BW,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return gE(e,r,a)}function gE(e,n,t){if(UW(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return cC(e.children,n,t)}return Array.isArray(e)?cC(e,n,t):""}function cC(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=gE(e[a],n,t);return r.join("")}function UW(e){return!!(e&&typeof e=="object")}const uC=document.createElement("i");function Lw(e){const n="&"+e+";";uC.innerHTML=n;const t=uC.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function Yl(e,n,t,r){const a=e.length;let l=0,o;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)o=Array.from(r),o.unshift(n,t),e.splice(...o);else for(t&&e.splice(n,t);l<r.length;)o=r.slice(l,l+1e4),o.unshift(n,0),e.splice(...o),l+=1e4,n+=1e4}function fs(e,n){return e.length>0?(Yl(e,e.length,0,n),e):n}const dC={}.hasOwnProperty;function qW(e){const n={};let t=-1;for(;++t<e.length;)VW(n,e[t]);return n}function VW(e,n){let t;for(t in n){const a=(dC.call(e,t)?e[t]:void 0)||(e[t]={}),l=n[t];let o;if(l)for(o in l){dC.call(a,o)||(a[o]=[]);const f=l[o];HW(a[o],Array.isArray(f)?f:f?[f]:[])}}}function HW(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);Yl(e,0,0,r)}function yE(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function Rh(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Ul=cu(/[A-Za-z]/),$a=cu(/[\dA-Za-z]/),GW=cu(/[#-'*+\--9=?A-Z^-~]/);function j1(e){return e!==null&&(e<32||e===127)}const C1=cu(/\d/),YW=cu(/[\dA-Fa-f]/),WW=cu(/[!-/:-@[-`{-~]/);function Ut(e){return e!==null&&e<-2}function ma(e){return e!==null&&(e<0||e===32)}function An(e){return e===-2||e===-1||e===32}const QW=cu(new RegExp("\\p{P}|\\p{S}","u")),JW=cu(/\s/);function cu(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function ep(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const l=e.charCodeAt(t);let o="";if(l===37&&$a(e.charCodeAt(t+1))&&$a(e.charCodeAt(t+2)))a=2;else if(l<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(l))||(o=String.fromCharCode(l));else if(l>55295&&l<57344){const f=e.charCodeAt(t+1);l<56320&&f>56319&&f<57344?(o=String.fromCharCode(l,f),a=1):o=""}else o=String.fromCharCode(l);o&&(n.push(e.slice(r,t),encodeURIComponent(o)),r=t+a+1,o=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function ai(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let l=0;return o;function o(u){return An(u)?(e.enter(t),f(u)):n(u)}function f(u){return An(u)&&l++<a?(e.consume(u),f):(e.exit(t),n(u))}}const KW={tokenize:XW};function XW(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(f){if(f===null){e.consume(f);return}return e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),ai(e,n,"linePrefix")}function a(f){return e.enter("paragraph"),l(f)}function l(f){const u=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=u),t=u,o(f)}function o(f){if(f===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(f);return}return Ut(f)?(e.consume(f),e.exit("chunkText"),l):(e.consume(f),o)}}const ZW={tokenize:eQ},fC={tokenize:tQ};function eQ(e){const n=this,t=[];let r=0,a,l,o;return f;function f(I){if(r<t.length){const V=t[r];return n.containerState=V[1],e.attempt(V[0].continuation,u,d)(I)}return d(I)}function u(I){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&P();const V=n.events.length;let F=V,O;for(;F--;)if(n.events[F][0]==="exit"&&n.events[F][1].type==="chunkFlow"){O=n.events[F][1].end;break}E(r);let B=V;for(;B<n.events.length;)n.events[B][1].end={...O},B++;return Yl(n.events,F+1,0,n.events.slice(V)),n.events.length=B,d(I)}return f(I)}function d(I){if(r===t.length){if(!a)return b(I);if(a.currentConstruct&&a.currentConstruct.concrete)return S(I);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(fC,h,g)(I)}function h(I){return a&&P(),E(r),b(I)}function g(I){return n.parser.lazy[n.now().line]=r!==t.length,o=n.now().offset,S(I)}function b(I){return n.containerState={},e.attempt(fC,v,S)(I)}function v(I){return r++,t.push([n.currentConstruct,n.containerState]),b(I)}function S(I){if(I===null){a&&P(),E(0),e.consume(I);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:l}),k(I)}function k(I){if(I===null){T(e.exit("chunkFlow"),!0),E(0),e.consume(I);return}return Ut(I)?(e.consume(I),T(e.exit("chunkFlow")),r=0,n.interrupt=void 0,f):(e.consume(I),k)}function T(I,V){const F=n.sliceStream(I);if(V&&F.push(null),I.previous=l,l&&(l.next=I),l=I,a.defineSkip(I.start),a.write(F),n.parser.lazy[I.start.line]){let O=a.events.length;for(;O--;)if(a.events[O][1].start.offset<o&&(!a.events[O][1].end||a.events[O][1].end.offset>o))return;const B=n.events.length;let U=B,z,$;for(;U--;)if(n.events[U][0]==="exit"&&n.events[U][1].type==="chunkFlow"){if(z){$=n.events[U][1].end;break}z=!0}for(E(r),O=B;O<n.events.length;)n.events[O][1].end={...$},O++;Yl(n.events,U+1,0,n.events.slice(B)),n.events.length=O}}function E(I){let V=t.length;for(;V-- >I;){const F=t[V];n.containerState=F[1],F[0].exit.call(n,e)}t.length=I}function P(){a.write([null]),l=void 0,a=void 0,n.containerState._closeFlow=void 0}}function tQ(e,n,t){return ai(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function yb(e){if(e===null||ma(e)||JW(e))return 1;if(QW(e))return 2}function Ow(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const l=e[a].resolveAll;l&&!r.includes(l)&&(n=l(n,t),r.push(l))}return n}const _1={name:"attention",resolveAll:nQ,tokenize:iQ};function nQ(e,n){let t=-1,r,a,l,o,f,u,d,h;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;u=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};hC(g,-u),hC(b,u),o={type:u>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},f={type:u>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},l={type:u>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:u>1?"strong":"emphasis",start:{...o.start},end:{...f.end}},e[r][1].end={...o.start},e[t][1].start={...f.end},d=[],e[r][1].end.offset-e[r][1].start.offset&&(d=fs(d,[["enter",e[r][1],n],["exit",e[r][1],n]])),d=fs(d,[["enter",a,n],["enter",o,n],["exit",o,n],["enter",l,n]]),d=fs(d,Ow(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),d=fs(d,[["exit",l,n],["enter",f,n],["exit",f,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(h=2,d=fs(d,[["enter",e[t][1],n],["exit",e[t][1],n]])):h=0,Yl(e,r-1,t-r+3,d),t=r+d.length-h-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function iQ(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=yb(r);let l;return o;function o(u){return l=u,e.enter("attentionSequence"),f(u)}function f(u){if(u===l)return e.consume(u),f;const d=e.exit("attentionSequence"),h=yb(u),g=!h||h===2&&a||t.includes(u),b=!a||a===2&&h||t.includes(r);return d._open=!!(l===42?g:g&&(a||!b)),d._close=!!(l===42?b:b&&(h||!g)),n(u)}}function hC(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const rQ={name:"autolink",tokenize:aQ};function aQ(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),l}function l(v){return Ul(v)?(e.consume(v),o):v===64?t(v):d(v)}function o(v){return v===43||v===45||v===46||$a(v)?(r=1,f(v)):d(v)}function f(v){return v===58?(e.consume(v),r=0,u):(v===43||v===45||v===46||$a(v))&&r++<32?(e.consume(v),f):(r=0,d(v))}function u(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||j1(v)?t(v):(e.consume(v),u)}function d(v){return v===64?(e.consume(v),h):GW(v)?(e.consume(v),d):t(v)}function h(v){return $a(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,h):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||$a(v))&&r++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const Ub={partial:!0,tokenize:sQ};function sQ(e,n,t){return r;function r(l){return An(l)?ai(e,a,"linePrefix")(l):a(l)}function a(l){return l===null||Ut(l)?n(l):t(l)}}const xE={continuation:{tokenize:oQ},exit:cQ,name:"blockQuote",tokenize:lQ};function lQ(e,n,t){const r=this;return a;function a(o){if(o===62){const f=r.containerState;return f.open||(e.enter("blockQuote",{_container:!0}),f.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(o),e.exit("blockQuoteMarker"),l}return t(o)}function l(o){return An(o)?(e.enter("blockQuotePrefixWhitespace"),e.consume(o),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(o))}}function oQ(e,n,t){const r=this;return a;function a(o){return An(o)?ai(e,l,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):l(o)}function l(o){return e.attempt(xE,n,t)(o)}}function cQ(e){e.exit("blockQuote")}const bE={name:"characterEscape",tokenize:uQ};function uQ(e,n,t){return r;function r(l){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(l),e.exit("escapeMarker"),a}function a(l){return WW(l)?(e.enter("characterEscapeValue"),e.consume(l),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(l)}}const vE={name:"characterReference",tokenize:dQ};function dQ(e,n,t){const r=this;let a=0,l,o;return f;function f(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),u}function u(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),d):(e.enter("characterReferenceValue"),l=31,o=$a,h(g))}function d(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),l=6,o=YW,h):(e.enter("characterReferenceValue"),l=7,o=C1,h(g))}function h(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return o===$a&&!Lw(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return o(g)&&a++<l?(e.consume(g),h):t(g)}}const pC={partial:!0,tokenize:hQ},mC={concrete:!0,name:"codeFenced",tokenize:fQ};function fQ(e,n,t){const r=this,a={partial:!0,tokenize:F};let l=0,o=0,f;return u;function u(O){return d(O)}function d(O){const B=r.events[r.events.length-1];return l=B&&B[1].type==="linePrefix"?B[2].sliceSerialize(B[1],!0).length:0,f=O,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),h(O)}function h(O){return O===f?(o++,e.consume(O),h):o<3?t(O):(e.exit("codeFencedFenceSequence"),An(O)?ai(e,g,"whitespace")(O):g(O))}function g(O){return O===null||Ut(O)?(e.exit("codeFencedFence"),r.interrupt?n(O):e.check(pC,k,V)(O)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b(O))}function b(O){return O===null||Ut(O)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g(O)):An(O)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),ai(e,v,"whitespace")(O)):O===96&&O===f?t(O):(e.consume(O),b)}function v(O){return O===null||Ut(O)?g(O):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S(O))}function S(O){return O===null||Ut(O)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g(O)):O===96&&O===f?t(O):(e.consume(O),S)}function k(O){return e.attempt(a,V,T)(O)}function T(O){return e.enter("lineEnding"),e.consume(O),e.exit("lineEnding"),E}function E(O){return l>0&&An(O)?ai(e,P,"linePrefix",l+1)(O):P(O)}function P(O){return O===null||Ut(O)?e.check(pC,k,V)(O):(e.enter("codeFlowValue"),I(O))}function I(O){return O===null||Ut(O)?(e.exit("codeFlowValue"),P(O)):(e.consume(O),I)}function V(O){return e.exit("codeFenced"),n(O)}function F(O,B,U){let z=0;return $;function $(te){return O.enter("lineEnding"),O.consume(te),O.exit("lineEnding"),R}function R(te){return O.enter("codeFencedFence"),An(te)?ai(O,H,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(te):H(te)}function H(te){return te===f?(O.enter("codeFencedFenceSequence"),ee(te)):U(te)}function ee(te){return te===f?(z++,O.consume(te),ee):z>=o?(O.exit("codeFencedFenceSequence"),An(te)?ai(O,Z,"whitespace")(te):Z(te)):U(te)}function Z(te){return te===null||Ut(te)?(O.exit("codeFencedFence"),B(te)):U(te)}}}function hQ(e,n,t){const r=this;return a;function a(o){return o===null?t(o):(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),l)}function l(o){return r.parser.lazy[r.now().line]?t(o):n(o)}}const k0={name:"codeIndented",tokenize:mQ},pQ={partial:!0,tokenize:gQ};function mQ(e,n,t){const r=this;return a;function a(d){return e.enter("codeIndented"),ai(e,l,"linePrefix",5)(d)}function l(d){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?o(d):t(d)}function o(d){return d===null?u(d):Ut(d)?e.attempt(pQ,o,u)(d):(e.enter("codeFlowValue"),f(d))}function f(d){return d===null||Ut(d)?(e.exit("codeFlowValue"),o(d)):(e.consume(d),f)}function u(d){return e.exit("codeIndented"),n(d)}}function gQ(e,n,t){const r=this;return a;function a(o){return r.parser.lazy[r.now().line]?t(o):Ut(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a):ai(e,l,"linePrefix",5)(o)}function l(o){const f=r.events[r.events.length-1];return f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?n(o):Ut(o)?a(o):t(o)}}const yQ={name:"codeText",previous:bQ,resolve:xQ,tokenize:vQ};function xQ(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function bQ(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function vQ(e,n,t){let r=0,a,l;return o;function o(g){return e.enter("codeText"),e.enter("codeTextSequence"),f(g)}function f(g){return g===96?(e.consume(g),r++,f):(e.exit("codeTextSequence"),u(g))}function u(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),u):g===96?(l=e.enter("codeTextSequence"),a=0,h(g)):Ut(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),u):(e.enter("codeTextData"),d(g))}function d(g){return g===null||g===32||g===96||Ut(g)?(e.exit("codeTextData"),u(g)):(e.consume(g),d)}function h(g){return g===96?(e.consume(g),a++,h):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(l.type="codeTextData",d(g))}}class wQ{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const l=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&zm(this.left,r),l.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),zm(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),zm(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);zm(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);zm(this.left,t.reverse())}}}function zm(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function wE(e){const n={};let t=-1,r,a,l,o,f,u,d;const h=new wQ(e);for(;++t<h.length;){for(;t in n;)t=n[t];if(r=h.get(t),t&&r[1].type==="chunkFlow"&&h.get(t-1)[1].type==="listItemPrefix"&&(u=r[1]._tokenizer.events,l=0,l<u.length&&u[l][1].type==="lineEndingBlank"&&(l+=2),l<u.length&&u[l][1].type==="content"))for(;++l<u.length&&u[l][1].type!=="content";)u[l][1].type==="chunkText"&&(u[l][1]._isInFirstContentOfListItem=!0,l++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,NQ(h,t)),t=n[t],d=!0);else if(r[1]._container){for(l=t,a=void 0;l--;)if(o=h.get(l),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(a&&(h.get(a)[1].type="lineEndingBlank"),o[1].type="lineEnding",a=l);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;a&&(r[1].end={...h.get(a)[1].start},f=h.slice(a,t),f.unshift(r),h.splice(a,t-a+1,f))}}return Yl(e,0,Number.POSITIVE_INFINITY,h.slice(0)),!d}function NQ(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const l=[];let o=t._tokenizer;o||(o=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const f=o.events,u=[],d={};let h,g,b=-1,v=t,S=0,k=0;const T=[k];for(;v;){for(;e.get(++a)[1]!==v;);l.push(a),v._tokenizer||(h=r.sliceStream(v),v.next||h.push(null),g&&o.defineSkip(v.start),v._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(h),v._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<f.length;)f[b][0]==="exit"&&f[b-1][0]==="enter"&&f[b][1].type===f[b-1][1].type&&f[b][1].start.line!==f[b][1].end.line&&(k=b+1,T.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(o.events=[],v?(v._tokenizer=void 0,v.previous=void 0):T.pop(),b=T.length;b--;){const E=f.slice(T[b],T[b+1]),P=l.pop();u.push([P,P+E.length-1]),e.splice(P,2,E)}for(u.reverse(),b=-1;++b<u.length;)d[S+u[b][0]]=S+u[b][1],S+=u[b][1]-u[b][0]-1;return d}const SQ={resolve:CQ,tokenize:_Q},jQ={partial:!0,tokenize:kQ};function CQ(e){return wE(e),e}function _Q(e,n){let t;return r;function r(f){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(f)}function a(f){return f===null?l(f):Ut(f)?e.check(jQ,o,l)(f):(e.consume(f),a)}function l(f){return e.exit("chunkContent"),e.exit("content"),n(f)}function o(f){return e.consume(f),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function kQ(e,n,t){const r=this;return a;function a(o){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),ai(e,l,"linePrefix")}function l(o){if(o===null||Ut(o))return t(o);const f=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?n(o):e.interrupt(r.parser.constructs.flow,t,n)(o)}}function NE(e,n,t,r,a,l,o,f,u){const d=u||Number.POSITIVE_INFINITY;let h=0;return g;function g(E){return E===60?(e.enter(r),e.enter(a),e.enter(l),e.consume(E),e.exit(l),b):E===null||E===32||E===41||j1(E)?t(E):(e.enter(r),e.enter(o),e.enter(f),e.enter("chunkString",{contentType:"string"}),k(E))}function b(E){return E===62?(e.enter(l),e.consume(E),e.exit(l),e.exit(a),e.exit(r),n):(e.enter(f),e.enter("chunkString",{contentType:"string"}),v(E))}function v(E){return E===62?(e.exit("chunkString"),e.exit(f),b(E)):E===null||E===60||Ut(E)?t(E):(e.consume(E),E===92?S:v)}function S(E){return E===60||E===62||E===92?(e.consume(E),v):v(E)}function k(E){return!h&&(E===null||E===41||ma(E))?(e.exit("chunkString"),e.exit(f),e.exit(o),e.exit(r),n(E)):h<d&&E===40?(e.consume(E),h++,k):E===41?(e.consume(E),h--,k):E===null||E===32||E===40||j1(E)?t(E):(e.consume(E),E===92?T:k)}function T(E){return E===40||E===41||E===92?(e.consume(E),k):k(E)}}function SE(e,n,t,r,a,l){const o=this;let f=0,u;return d;function d(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(l),h}function h(v){return f>999||v===null||v===91||v===93&&!u||v===94&&!f&&"_hiddenFootnoteSupport"in o.parser.constructs?t(v):v===93?(e.exit(l),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):Ut(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),h):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||Ut(v)||f++>999?(e.exit("chunkString"),h(v)):(e.consume(v),u||(u=!An(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),f++,g):g(v)}}function jE(e,n,t,r,a,l){let o;return f;function f(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),o=b===40?41:b,u):t(b)}function u(b){return b===o?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(l),d(b))}function d(b){return b===o?(e.exit(l),u(o)):b===null?t(b):Ut(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),ai(e,d,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),h(b))}function h(b){return b===o||b===null||Ut(b)?(e.exit("chunkString"),d(b)):(e.consume(b),b===92?g:h)}function g(b){return b===o||b===92?(e.consume(b),h):h(b)}}function Qm(e,n){let t;return r;function r(a){return Ut(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):An(a)?ai(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const EQ={name:"definition",tokenize:AQ},TQ={partial:!0,tokenize:DQ};function AQ(e,n,t){const r=this;let a;return l;function l(v){return e.enter("definition"),o(v)}function o(v){return SE.call(r,e,f,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function f(v){return a=Rh(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),u):t(v)}function u(v){return ma(v)?Qm(e,d)(v):d(v)}function d(v){return NE(e,h,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function h(v){return e.attempt(TQ,g,g)(v)}function g(v){return An(v)?ai(e,b,"whitespace")(v):b(v)}function b(v){return v===null||Ut(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function DQ(e,n,t){return r;function r(f){return ma(f)?Qm(e,a)(f):t(f)}function a(f){return jE(e,l,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(f)}function l(f){return An(f)?ai(e,o,"whitespace")(f):o(f)}function o(f){return f===null||Ut(f)?n(f):t(f)}}const PQ={name:"hardBreakEscape",tokenize:IQ};function IQ(e,n,t){return r;function r(l){return e.enter("hardBreakEscape"),e.consume(l),a}function a(l){return Ut(l)?(e.exit("hardBreakEscape"),n(l)):t(l)}}const MQ={name:"headingAtx",resolve:RQ,tokenize:LQ};function RQ(e,n){let t=e.length-2,r=3,a,l;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},l={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},Yl(e,r,t-r+1,[["enter",a,n],["enter",l,n],["exit",l,n],["exit",a,n]])),e}function LQ(e,n,t){let r=0;return a;function a(h){return e.enter("atxHeading"),l(h)}function l(h){return e.enter("atxHeadingSequence"),o(h)}function o(h){return h===35&&r++<6?(e.consume(h),o):h===null||ma(h)?(e.exit("atxHeadingSequence"),f(h)):t(h)}function f(h){return h===35?(e.enter("atxHeadingSequence"),u(h)):h===null||Ut(h)?(e.exit("atxHeading"),n(h)):An(h)?ai(e,f,"whitespace")(h):(e.enter("atxHeadingText"),d(h))}function u(h){return h===35?(e.consume(h),u):(e.exit("atxHeadingSequence"),f(h))}function d(h){return h===null||h===35||ma(h)?(e.exit("atxHeadingText"),f(h)):(e.consume(h),d)}}const OQ=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],gC=["pre","script","style","textarea"],FQ={concrete:!0,name:"htmlFlow",resolveTo:BQ,tokenize:UQ},$Q={partial:!0,tokenize:VQ},zQ={partial:!0,tokenize:qQ};function BQ(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function UQ(e,n,t){const r=this;let a,l,o,f,u;return d;function d(M){return h(M)}function h(M){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(M),g}function g(M){return M===33?(e.consume(M),b):M===47?(e.consume(M),l=!0,k):M===63?(e.consume(M),a=3,r.interrupt?n:A):Ul(M)?(e.consume(M),o=String.fromCharCode(M),T):t(M)}function b(M){return M===45?(e.consume(M),a=2,v):M===91?(e.consume(M),a=5,f=0,S):Ul(M)?(e.consume(M),a=4,r.interrupt?n:A):t(M)}function v(M){return M===45?(e.consume(M),r.interrupt?n:A):t(M)}function S(M){const ce="CDATA[";return M===ce.charCodeAt(f++)?(e.consume(M),f===ce.length?r.interrupt?n:H:S):t(M)}function k(M){return Ul(M)?(e.consume(M),o=String.fromCharCode(M),T):t(M)}function T(M){if(M===null||M===47||M===62||ma(M)){const ce=M===47,ve=o.toLowerCase();return!ce&&!l&&gC.includes(ve)?(a=1,r.interrupt?n(M):H(M)):OQ.includes(o.toLowerCase())?(a=6,ce?(e.consume(M),E):r.interrupt?n(M):H(M)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(M):l?P(M):I(M))}return M===45||$a(M)?(e.consume(M),o+=String.fromCharCode(M),T):t(M)}function E(M){return M===62?(e.consume(M),r.interrupt?n:H):t(M)}function P(M){return An(M)?(e.consume(M),P):$(M)}function I(M){return M===47?(e.consume(M),$):M===58||M===95||Ul(M)?(e.consume(M),V):An(M)?(e.consume(M),I):$(M)}function V(M){return M===45||M===46||M===58||M===95||$a(M)?(e.consume(M),V):F(M)}function F(M){return M===61?(e.consume(M),O):An(M)?(e.consume(M),F):I(M)}function O(M){return M===null||M===60||M===61||M===62||M===96?t(M):M===34||M===39?(e.consume(M),u=M,B):An(M)?(e.consume(M),O):U(M)}function B(M){return M===u?(e.consume(M),u=null,z):M===null||Ut(M)?t(M):(e.consume(M),B)}function U(M){return M===null||M===34||M===39||M===47||M===60||M===61||M===62||M===96||ma(M)?F(M):(e.consume(M),U)}function z(M){return M===47||M===62||An(M)?I(M):t(M)}function $(M){return M===62?(e.consume(M),R):t(M)}function R(M){return M===null||Ut(M)?H(M):An(M)?(e.consume(M),R):t(M)}function H(M){return M===45&&a===2?(e.consume(M),Q):M===60&&a===1?(e.consume(M),q):M===62&&a===4?(e.consume(M),ie):M===63&&a===3?(e.consume(M),A):M===93&&a===5?(e.consume(M),ne):Ut(M)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check($Q,se,ee)(M)):M===null||Ut(M)?(e.exit("htmlFlowData"),ee(M)):(e.consume(M),H)}function ee(M){return e.check(zQ,Z,se)(M)}function Z(M){return e.enter("lineEnding"),e.consume(M),e.exit("lineEnding"),te}function te(M){return M===null||Ut(M)?ee(M):(e.enter("htmlFlowData"),H(M))}function Q(M){return M===45?(e.consume(M),A):H(M)}function q(M){return M===47?(e.consume(M),o="",W):H(M)}function W(M){if(M===62){const ce=o.toLowerCase();return gC.includes(ce)?(e.consume(M),ie):H(M)}return Ul(M)&&o.length<8?(e.consume(M),o+=String.fromCharCode(M),W):H(M)}function ne(M){return M===93?(e.consume(M),A):H(M)}function A(M){return M===62?(e.consume(M),ie):M===45&&a===2?(e.consume(M),A):H(M)}function ie(M){return M===null||Ut(M)?(e.exit("htmlFlowData"),se(M)):(e.consume(M),ie)}function se(M){return e.exit("htmlFlow"),n(M)}}function qQ(e,n,t){const r=this;return a;function a(o){return Ut(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),l):t(o)}function l(o){return r.parser.lazy[r.now().line]?t(o):n(o)}}function VQ(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(Ub,n,t)}}const HQ={name:"htmlText",tokenize:GQ};function GQ(e,n,t){const r=this;let a,l,o;return f;function f(A){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(A),u}function u(A){return A===33?(e.consume(A),d):A===47?(e.consume(A),F):A===63?(e.consume(A),I):Ul(A)?(e.consume(A),U):t(A)}function d(A){return A===45?(e.consume(A),h):A===91?(e.consume(A),l=0,S):Ul(A)?(e.consume(A),P):t(A)}function h(A){return A===45?(e.consume(A),v):t(A)}function g(A){return A===null?t(A):A===45?(e.consume(A),b):Ut(A)?(o=g,q(A)):(e.consume(A),g)}function b(A){return A===45?(e.consume(A),v):g(A)}function v(A){return A===62?Q(A):A===45?b(A):g(A)}function S(A){const ie="CDATA[";return A===ie.charCodeAt(l++)?(e.consume(A),l===ie.length?k:S):t(A)}function k(A){return A===null?t(A):A===93?(e.consume(A),T):Ut(A)?(o=k,q(A)):(e.consume(A),k)}function T(A){return A===93?(e.consume(A),E):k(A)}function E(A){return A===62?Q(A):A===93?(e.consume(A),E):k(A)}function P(A){return A===null||A===62?Q(A):Ut(A)?(o=P,q(A)):(e.consume(A),P)}function I(A){return A===null?t(A):A===63?(e.consume(A),V):Ut(A)?(o=I,q(A)):(e.consume(A),I)}function V(A){return A===62?Q(A):I(A)}function F(A){return Ul(A)?(e.consume(A),O):t(A)}function O(A){return A===45||$a(A)?(e.consume(A),O):B(A)}function B(A){return Ut(A)?(o=B,q(A)):An(A)?(e.consume(A),B):Q(A)}function U(A){return A===45||$a(A)?(e.consume(A),U):A===47||A===62||ma(A)?z(A):t(A)}function z(A){return A===47?(e.consume(A),Q):A===58||A===95||Ul(A)?(e.consume(A),$):Ut(A)?(o=z,q(A)):An(A)?(e.consume(A),z):Q(A)}function $(A){return A===45||A===46||A===58||A===95||$a(A)?(e.consume(A),$):R(A)}function R(A){return A===61?(e.consume(A),H):Ut(A)?(o=R,q(A)):An(A)?(e.consume(A),R):z(A)}function H(A){return A===null||A===60||A===61||A===62||A===96?t(A):A===34||A===39?(e.consume(A),a=A,ee):Ut(A)?(o=H,q(A)):An(A)?(e.consume(A),H):(e.consume(A),Z)}function ee(A){return A===a?(e.consume(A),a=void 0,te):A===null?t(A):Ut(A)?(o=ee,q(A)):(e.consume(A),ee)}function Z(A){return A===null||A===34||A===39||A===60||A===61||A===96?t(A):A===47||A===62||ma(A)?z(A):(e.consume(A),Z)}function te(A){return A===47||A===62||ma(A)?z(A):t(A)}function Q(A){return A===62?(e.consume(A),e.exit("htmlTextData"),e.exit("htmlText"),n):t(A)}function q(A){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(A),e.exit("lineEnding"),W}function W(A){return An(A)?ai(e,ne,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(A):ne(A)}function ne(A){return e.enter("htmlTextData"),o(A)}}const Fw={name:"labelEnd",resolveAll:JQ,resolveTo:KQ,tokenize:XQ},YQ={tokenize:ZQ},WQ={tokenize:eJ},QQ={tokenize:tJ};function JQ(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&Yl(e,0,e.length,t),e}function KQ(e,n){let t=e.length,r=0,a,l,o,f;for(;t--;)if(a=e[t][1],l){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(o){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(l=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(o=t);const u={type:e[l][1].type==="labelLink"?"link":"image",start:{...e[l][1].start},end:{...e[e.length-1][1].end}},d={type:"label",start:{...e[l][1].start},end:{...e[o][1].end}},h={type:"labelText",start:{...e[l+r+2][1].end},end:{...e[o-2][1].start}};return f=[["enter",u,n],["enter",d,n]],f=fs(f,e.slice(l+1,l+r+3)),f=fs(f,[["enter",h,n]]),f=fs(f,Ow(n.parser.constructs.insideSpan.null,e.slice(l+r+4,o-3),n)),f=fs(f,[["exit",h,n],e[o-2],e[o-1],["exit",d,n]]),f=fs(f,e.slice(o+1)),f=fs(f,[["exit",u,n]]),Yl(e,l,e.length,f),e}function XQ(e,n,t){const r=this;let a=r.events.length,l,o;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){l=r.events[a][1];break}return f;function f(b){return l?l._inactive?g(b):(o=r.parser.defined.includes(Rh(r.sliceSerialize({start:l.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),u):t(b)}function u(b){return b===40?e.attempt(YQ,h,o?h:g)(b):b===91?e.attempt(WQ,h,o?d:g)(b):o?h(b):g(b)}function d(b){return e.attempt(QQ,h,g)(b)}function h(b){return n(b)}function g(b){return l._balanced=!0,t(b)}}function ZQ(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return ma(g)?Qm(e,l)(g):l(g)}function l(g){return g===41?h(g):NE(e,o,f,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function o(g){return ma(g)?Qm(e,u)(g):h(g)}function f(g){return t(g)}function u(g){return g===34||g===39||g===40?jE(e,d,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):h(g)}function d(g){return ma(g)?Qm(e,h)(g):h(g)}function h(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function eJ(e,n,t){const r=this;return a;function a(f){return SE.call(r,e,l,o,"reference","referenceMarker","referenceString")(f)}function l(f){return r.parser.defined.includes(Rh(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(f):t(f)}function o(f){return t(f)}}function tJ(e,n,t){return r;function r(l){return e.enter("reference"),e.enter("referenceMarker"),e.consume(l),e.exit("referenceMarker"),a}function a(l){return l===93?(e.enter("referenceMarker"),e.consume(l),e.exit("referenceMarker"),e.exit("reference"),n):t(l)}}const nJ={name:"labelStartImage",resolveAll:Fw.resolveAll,tokenize:iJ};function iJ(e,n,t){const r=this;return a;function a(f){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(f),e.exit("labelImageMarker"),l}function l(f){return f===91?(e.enter("labelMarker"),e.consume(f),e.exit("labelMarker"),e.exit("labelImage"),o):t(f)}function o(f){return f===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(f):n(f)}}const rJ={name:"labelStartLink",resolveAll:Fw.resolveAll,tokenize:aJ};function aJ(e,n,t){const r=this;return a;function a(o){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelLink"),l}function l(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(o):n(o)}}const E0={name:"lineEnding",tokenize:sJ};function sJ(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),ai(e,n,"linePrefix")}}const Yx={name:"thematicBreak",tokenize:lJ};function lJ(e,n,t){let r=0,a;return l;function l(d){return e.enter("thematicBreak"),o(d)}function o(d){return a=d,f(d)}function f(d){return d===a?(e.enter("thematicBreakSequence"),u(d)):r>=3&&(d===null||Ut(d))?(e.exit("thematicBreak"),n(d)):t(d)}function u(d){return d===a?(e.consume(d),r++,u):(e.exit("thematicBreakSequence"),An(d)?ai(e,f,"whitespace")(d):f(d))}}const ha={continuation:{tokenize:dJ},exit:hJ,name:"list",tokenize:uJ},oJ={partial:!0,tokenize:pJ},cJ={partial:!0,tokenize:fJ};function uJ(e,n,t){const r=this,a=r.events[r.events.length-1];let l=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,o=0;return f;function f(v){const S=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:C1(v)){if(r.containerState.type||(r.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(Yx,t,d)(v):d(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),u(v)}return t(v)}function u(v){return C1(v)&&++o<10?(e.consume(v),u):(!r.interrupt||o<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),d(v)):t(v)}function d(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(Ub,r.interrupt?t:h,e.attempt(oJ,b,g))}function h(v){return r.containerState.initialBlankLine=!0,l++,b(v)}function g(v){return An(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=l+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function dJ(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(Ub,a,l);function a(f){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,ai(e,n,"listItemIndent",r.containerState.size+1)(f)}function l(f){return r.containerState.furtherBlankLines||!An(f)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(f)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(cJ,n,o)(f))}function o(f){return r.containerState._closeFlow=!0,r.interrupt=void 0,ai(e,e.attempt(ha,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(f)}}function fJ(e,n,t){const r=this;return ai(e,a,"listItemIndent",r.containerState.size+1);function a(l){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?n(l):t(l)}}function hJ(e){e.exit(this.containerState.type)}function pJ(e,n,t){const r=this;return ai(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(l){const o=r.events[r.events.length-1];return!An(l)&&o&&o[1].type==="listItemPrefixWhitespace"?n(l):t(l)}}const yC={name:"setextUnderline",resolveTo:mJ,tokenize:gJ};function mJ(e,n){let t=e.length,r,a,l;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!l&&e[t][1].type==="definition"&&(l=t);const o={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",l?(e.splice(a,0,["enter",o,n]),e.splice(l+1,0,["exit",e[r][1],n]),e[r][1].end={...e[l][1].end}):e[r][1]=o,e.push(["exit",o,n]),e}function gJ(e,n,t){const r=this;let a;return l;function l(d){let h=r.events.length,g;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){g=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=d,o(d)):t(d)}function o(d){return e.enter("setextHeadingLineSequence"),f(d)}function f(d){return d===a?(e.consume(d),f):(e.exit("setextHeadingLineSequence"),An(d)?ai(e,u,"lineSuffix")(d):u(d))}function u(d){return d===null||Ut(d)?(e.exit("setextHeadingLine"),n(d)):t(d)}}const yJ={tokenize:xJ};function xJ(e){const n=this,t=e.attempt(Ub,r,e.attempt(this.parser.constructs.flowInitial,a,ai(e,e.attempt(this.parser.constructs.flow,a,e.attempt(SQ,a)),"linePrefix")));return t;function r(l){if(l===null){e.consume(l);return}return e.enter("lineEndingBlank"),e.consume(l),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(l){if(l===null){e.consume(l);return}return e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const bJ={resolveAll:_E()},vJ=CE("string"),wJ=CE("text");function CE(e){return{resolveAll:_E(e==="text"?NJ:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],l=t.attempt(a,o,f);return o;function o(h){return d(h)?l(h):f(h)}function f(h){if(h===null){t.consume(h);return}return t.enter("data"),t.consume(h),u}function u(h){return d(h)?(t.exit("data"),l(h)):(t.consume(h),u)}function d(h){if(h===null)return!0;const g=a[h];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function _E(e){return n;function n(t,r){let a=-1,l;for(;++a<=t.length;)l===void 0?t[a]&&t[a][1].type==="data"&&(l=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==l+2&&(t[l][1].end=t[a-1][1].end,t.splice(l+2,a-l-2),a=l+2),l=void 0);return e?e(t,r):t}}function NJ(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let l=a.length,o=-1,f=0,u;for(;l--;){const d=a[l];if(typeof d=="string"){for(o=d.length;d.charCodeAt(o-1)===32;)f++,o--;if(o)break;o=-1}else if(d===-2)u=!0,f++;else if(d!==-1){l++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(f=0),f){const d={type:t===e.length||u||f<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:l?o:r.start._bufferIndex+o,_index:r.start._index+l,line:r.end.line,column:r.end.column-f,offset:r.end.offset-f},end:{...r.end}};r.end={...d.start},r.start.offset===r.end.offset?Object.assign(r,d):(e.splice(t,0,["enter",d,n],["exit",d,n]),t+=2)}t++}return e}const SJ={42:ha,43:ha,45:ha,48:ha,49:ha,50:ha,51:ha,52:ha,53:ha,54:ha,55:ha,56:ha,57:ha,62:xE},jJ={91:EQ},CJ={[-2]:k0,[-1]:k0,32:k0},_J={35:MQ,42:Yx,45:[yC,Yx],60:FQ,61:yC,95:Yx,96:mC,126:mC},kJ={38:vE,92:bE},EJ={[-5]:E0,[-4]:E0,[-3]:E0,33:nJ,38:vE,42:_1,60:[rQ,HQ],91:rJ,92:[PQ,bE],93:Fw,95:_1,96:yQ},TJ={null:[_1,bJ]},AJ={null:[42,95]},DJ={null:[]},PJ=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:AJ,contentInitial:jJ,disable:DJ,document:SJ,flow:_J,flowInitial:CJ,insideSpan:TJ,string:kJ,text:EJ},Symbol.toStringTag,{value:"Module"}));function IJ(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},l=[];let o=[],f=[];const u={attempt:B(F),check:B(O),consume:P,enter:I,exit:V,interrupt:B(O,{interrupt:!0})},d={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let h=n.tokenize.call(d,u);return n.resolveAll&&l.push(n),d;function g(R){return o=fs(o,R),T(),o[o.length-1]!==null?[]:(U(n,0),d.events=Ow(l,d.events,d),d.events)}function b(R,H){return RJ(v(R),H)}function v(R){return MJ(o,R)}function S(){const{_bufferIndex:R,_index:H,line:ee,column:Z,offset:te}=r;return{_bufferIndex:R,_index:H,line:ee,column:Z,offset:te}}function k(R){a[R.line]=R.column,$()}function T(){let R;for(;r._index<o.length;){const H=o[r._index];if(typeof H=="string")for(R=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===R&&r._bufferIndex<H.length;)E(H.charCodeAt(r._bufferIndex));else E(H)}}function E(R){h=h(R)}function P(R){Ut(R)?(r.line++,r.column=1,r.offset+=R===-3?2:1,$()):R!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),d.previous=R}function I(R,H){const ee=H||{};return ee.type=R,ee.start=S(),d.events.push(["enter",ee,d]),f.push(ee),ee}function V(R){const H=f.pop();return H.end=S(),d.events.push(["exit",H,d]),H}function F(R,H){U(R,H.from)}function O(R,H){H.restore()}function B(R,H){return ee;function ee(Z,te,Q){let q,W,ne,A;return Array.isArray(Z)?se(Z):"tokenize"in Z?se([Z]):ie(Z);function ie(le){return xe;function xe(ue){const ze=ue!==null&&le[ue],tt=ue!==null&&le.null,ft=[...Array.isArray(ze)?ze:ze?[ze]:[],...Array.isArray(tt)?tt:tt?[tt]:[]];return se(ft)(ue)}}function se(le){return q=le,W=0,le.length===0?Q:M(le[W])}function M(le){return xe;function xe(ue){return A=z(),ne=le,le.partial||(d.currentConstruct=le),le.name&&d.parser.constructs.disable.null.includes(le.name)?ve():le.tokenize.call(H?Object.assign(Object.create(d),H):d,u,ce,ve)(ue)}}function ce(le){return R(ne,A),te}function ve(le){return A.restore(),++W<q.length?M(q[W]):Q}}}function U(R,H){R.resolveAll&&!l.includes(R)&&l.push(R),R.resolve&&Yl(d.events,H,d.events.length-H,R.resolve(d.events.slice(H),d)),R.resolveTo&&(d.events=R.resolveTo(d.events,d))}function z(){const R=S(),H=d.previous,ee=d.currentConstruct,Z=d.events.length,te=Array.from(f);return{from:Z,restore:Q};function Q(){r=R,d.previous=H,d.currentConstruct=ee,d.events.length=Z,f=te,$()}}function $(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function MJ(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,l=n.end._bufferIndex;let o;if(t===a)o=[e[t].slice(r,l)];else{if(o=e.slice(t,a),r>-1){const f=o[0];typeof f=="string"?o[0]=f.slice(r):o.shift()}l>0&&o.push(e[a].slice(0,l))}return o}function RJ(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const l=e[t];let o;if(typeof l=="string")o=l;else switch(l){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=n?" ":"	";break}case-1:{if(!n&&a)continue;o=" ";break}default:o=String.fromCharCode(l)}a=l===-2,r.push(o)}return r.join("")}function LJ(e){const r={constructs:qW([PJ,...(e||{}).extensions||[]]),content:a(KW),defined:[],document:a(ZW),flow:a(yJ),lazy:{},string:a(vJ),text:a(wJ)};return r;function a(l){return o;function o(f){return IJ(r,l,f)}}}function OJ(e){for(;!wE(e););return e}const xC=/[\0\t\n\r]/g;function FJ(){let e=1,n="",t=!0,r;return a;function a(l,o,f){const u=[];let d,h,g,b,v;for(l=n+(typeof l=="string"?l.toString():new TextDecoder(o||void 0).decode(l)),g=0,n="",t&&(l.charCodeAt(0)===65279&&g++,t=void 0);g<l.length;){if(xC.lastIndex=g,d=xC.exec(l),b=d&&d.index!==void 0?d.index:l.length,v=l.charCodeAt(b),!d){n=l.slice(g);break}if(v===10&&g===b&&r)u.push(-3),r=void 0;else switch(r&&(u.push(-5),r=void 0),g<b&&(u.push(l.slice(g,b)),e+=b-g),v){case 0:{u.push(65533),e++;break}case 9:{for(h=Math.ceil(e/4)*4,u.push(-2);e++<h;)u.push(-1);break}case 10:{u.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return f&&(r&&u.push(-5),n&&u.push(n),u.push(null)),u}}const $J=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function kE(e){return e.replace($J,zJ)}function zJ(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),l=a===120||a===88;return yE(t.slice(l?2:1),l?16:10)}return Lw(t)||e}function Jm(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?bC(e.position):"start"in e||"end"in e?bC(e):"line"in e||"column"in e?k1(e):""}function k1(e){return vC(e&&e.line)+":"+vC(e&&e.column)}function bC(e){return k1(e&&e.start)+"-"+k1(e&&e.end)}function vC(e){return e&&typeof e=="number"?e:1}const EE={}.hasOwnProperty;function BJ(e,n,t){return typeof n!="string"&&(t=n,n=void 0),UJ(t)(OJ(LJ(t).document().write(FJ()(e,n,!0))))}function UJ(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:l(Je),autolinkProtocol:z,autolinkEmail:z,atxHeading:l(Ae),blockQuote:l(tt),characterEscape:z,characterReference:z,codeFenced:l(ft),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:l(ft,o),codeText:l(Re,o),codeTextData:z,data:z,codeFlowValue:z,definition:l(je),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:l(he),hardBreakEscape:l(we),hardBreakTrailing:l(we),htmlFlow:l(Me,o),htmlFlowData:z,htmlText:l(Me,o),htmlTextData:z,image:l(De),label:o,link:l(Je),listItem:l(Ge),listItemValue:b,listOrdered:l(nt,g),listUnordered:l(nt),paragraph:l(St),reference:M,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:l(Ae),strong:l(It),thematicBreak:l(oe)},exit:{atxHeading:u(),atxHeadingSequence:F,autolink:u(),autolinkEmail:ze,autolinkProtocol:ue,blockQuote:u(),characterEscapeValue:$,characterReferenceMarkerHexadecimal:ve,characterReferenceMarkerNumeric:ve,characterReferenceValue:le,characterReference:xe,codeFenced:u(T),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:$,codeIndented:u(E),codeText:u(te),codeTextData:$,data:$,definition:u(),definitionDestinationString:V,definitionLabelString:P,definitionTitleString:I,emphasis:u(),hardBreakEscape:u(H),hardBreakTrailing:u(H),htmlFlow:u(ee),htmlFlowData:$,htmlText:u(Z),htmlTextData:$,image:u(q),label:ne,labelText:W,lineEnding:R,link:u(Q),listItem:u(),listOrdered:u(),listUnordered:u(),paragraph:u(),referenceString:ce,resourceDestinationString:A,resourceTitleString:ie,resource:se,setextHeading:u(U),setextHeadingLineSequence:B,setextHeadingText:O,strong:u(),thematicBreak:u()}};TE(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(J){let de={type:"root",children:[]};const Be={stack:[de],tokenStack:[],config:n,enter:f,exit:d,buffer:o,resume:h,data:t},be=[];let Fe=-1;for(;++Fe<J.length;)if(J[Fe][1].type==="listOrdered"||J[Fe][1].type==="listUnordered")if(J[Fe][0]==="enter")be.push(Fe);else{const $e=be.pop();Fe=a(J,$e,Fe)}for(Fe=-1;++Fe<J.length;){const $e=n[J[Fe][0]];EE.call($e,J[Fe][1].type)&&$e[J[Fe][1].type].call(Object.assign({sliceSerialize:J[Fe][2].sliceSerialize},Be),J[Fe][1])}if(Be.tokenStack.length>0){const $e=Be.tokenStack[Be.tokenStack.length-1];($e[1]||wC).call(Be,void 0,$e[0])}for(de.position={start:Gc(J.length>0?J[0][1].start:{line:1,column:1,offset:0}),end:Gc(J.length>0?J[J.length-2][1].end:{line:1,column:1,offset:0})},Fe=-1;++Fe<n.transforms.length;)de=n.transforms[Fe](de)||de;return de}function a(J,de,Be){let be=de-1,Fe=-1,$e=!1,st,rt,Le,Ve;for(;++be<=Be;){const qe=J[be];switch(qe[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{qe[0]==="enter"?Fe++:Fe--,Ve=void 0;break}case"lineEndingBlank":{qe[0]==="enter"&&(st&&!Ve&&!Fe&&!Le&&(Le=be),Ve=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Ve=void 0}if(!Fe&&qe[0]==="enter"&&qe[1].type==="listItemPrefix"||Fe===-1&&qe[0]==="exit"&&(qe[1].type==="listUnordered"||qe[1].type==="listOrdered")){if(st){let Ke=be;for(rt=void 0;Ke--;){const We=J[Ke];if(We[1].type==="lineEnding"||We[1].type==="lineEndingBlank"){if(We[0]==="exit")continue;rt&&(J[rt][1].type="lineEndingBlank",$e=!0),We[1].type="lineEnding",rt=Ke}else if(!(We[1].type==="linePrefix"||We[1].type==="blockQuotePrefix"||We[1].type==="blockQuotePrefixWhitespace"||We[1].type==="blockQuoteMarker"||We[1].type==="listItemIndent"))break}Le&&(!rt||Le<rt)&&(st._spread=!0),st.end=Object.assign({},rt?J[rt][1].start:qe[1].end),J.splice(rt||be,0,["exit",st,qe[2]]),be++,Be++}if(qe[1].type==="listItemPrefix"){const Ke={type:"listItem",_spread:!1,start:Object.assign({},qe[1].start),end:void 0};st=Ke,J.splice(be,0,["enter",Ke,qe[2]]),be++,Be++,Le=void 0,Ve=!0}}}return J[de][1]._spread=$e,Be}function l(J,de){return Be;function Be(be){f.call(this,J(be),be),de&&de.call(this,be)}}function o(){this.stack.push({type:"fragment",children:[]})}function f(J,de,Be){this.stack[this.stack.length-1].children.push(J),this.stack.push(J),this.tokenStack.push([de,Be||void 0]),J.position={start:Gc(de.start),end:void 0}}function u(J){return de;function de(Be){J&&J.call(this,Be),d.call(this,Be)}}function d(J,de){const Be=this.stack.pop(),be=this.tokenStack.pop();if(be)be[0].type!==J.type&&(de?de.call(this,J,be[0]):(be[1]||wC).call(this,J,be[0]));else throw new Error("Cannot close `"+J.type+"` ("+Jm({start:J.start,end:J.end})+"): its not open");Be.position.end=Gc(J.end)}function h(){return Rw(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(J){if(this.data.expectingFirstListItemValue){const de=this.stack[this.stack.length-2];de.start=Number.parseInt(this.sliceSerialize(J),10),this.data.expectingFirstListItemValue=void 0}}function v(){const J=this.resume(),de=this.stack[this.stack.length-1];de.lang=J}function S(){const J=this.resume(),de=this.stack[this.stack.length-1];de.meta=J}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const J=this.resume(),de=this.stack[this.stack.length-1];de.value=J.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function E(){const J=this.resume(),de=this.stack[this.stack.length-1];de.value=J.replace(/(\r?\n|\r)$/g,"")}function P(J){const de=this.resume(),Be=this.stack[this.stack.length-1];Be.label=de,Be.identifier=Rh(this.sliceSerialize(J)).toLowerCase()}function I(){const J=this.resume(),de=this.stack[this.stack.length-1];de.title=J}function V(){const J=this.resume(),de=this.stack[this.stack.length-1];de.url=J}function F(J){const de=this.stack[this.stack.length-1];if(!de.depth){const Be=this.sliceSerialize(J).length;de.depth=Be}}function O(){this.data.setextHeadingSlurpLineEnding=!0}function B(J){const de=this.stack[this.stack.length-1];de.depth=this.sliceSerialize(J).codePointAt(0)===61?1:2}function U(){this.data.setextHeadingSlurpLineEnding=void 0}function z(J){const Be=this.stack[this.stack.length-1].children;let be=Be[Be.length-1];(!be||be.type!=="text")&&(be=Vt(),be.position={start:Gc(J.start),end:void 0},Be.push(be)),this.stack.push(be)}function $(J){const de=this.stack.pop();de.value+=this.sliceSerialize(J),de.position.end=Gc(J.end)}function R(J){const de=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Be=de.children[de.children.length-1];Be.position.end=Gc(J.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(de.type)&&(z.call(this,J),$.call(this,J))}function H(){this.data.atHardBreak=!0}function ee(){const J=this.resume(),de=this.stack[this.stack.length-1];de.value=J}function Z(){const J=this.resume(),de=this.stack[this.stack.length-1];de.value=J}function te(){const J=this.resume(),de=this.stack[this.stack.length-1];de.value=J}function Q(){const J=this.stack[this.stack.length-1];if(this.data.inReference){const de=this.data.referenceType||"shortcut";J.type+="Reference",J.referenceType=de,delete J.url,delete J.title}else delete J.identifier,delete J.label;this.data.referenceType=void 0}function q(){const J=this.stack[this.stack.length-1];if(this.data.inReference){const de=this.data.referenceType||"shortcut";J.type+="Reference",J.referenceType=de,delete J.url,delete J.title}else delete J.identifier,delete J.label;this.data.referenceType=void 0}function W(J){const de=this.sliceSerialize(J),Be=this.stack[this.stack.length-2];Be.label=kE(de),Be.identifier=Rh(de).toLowerCase()}function ne(){const J=this.stack[this.stack.length-1],de=this.resume(),Be=this.stack[this.stack.length-1];if(this.data.inReference=!0,Be.type==="link"){const be=J.children;Be.children=be}else Be.alt=de}function A(){const J=this.resume(),de=this.stack[this.stack.length-1];de.url=J}function ie(){const J=this.resume(),de=this.stack[this.stack.length-1];de.title=J}function se(){this.data.inReference=void 0}function M(){this.data.referenceType="collapsed"}function ce(J){const de=this.resume(),Be=this.stack[this.stack.length-1];Be.label=de,Be.identifier=Rh(this.sliceSerialize(J)).toLowerCase(),this.data.referenceType="full"}function ve(J){this.data.characterReferenceType=J.type}function le(J){const de=this.sliceSerialize(J),Be=this.data.characterReferenceType;let be;Be?(be=yE(de,Be==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):be=Lw(de);const Fe=this.stack[this.stack.length-1];Fe.value+=be}function xe(J){const de=this.stack.pop();de.position.end=Gc(J.end)}function ue(J){$.call(this,J);const de=this.stack[this.stack.length-1];de.url=this.sliceSerialize(J)}function ze(J){$.call(this,J);const de=this.stack[this.stack.length-1];de.url="mailto:"+this.sliceSerialize(J)}function tt(){return{type:"blockquote",children:[]}}function ft(){return{type:"code",lang:null,meta:null,value:""}}function Re(){return{type:"inlineCode",value:""}}function je(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function he(){return{type:"emphasis",children:[]}}function Ae(){return{type:"heading",depth:0,children:[]}}function we(){return{type:"break"}}function Me(){return{type:"html",value:""}}function De(){return{type:"image",title:null,url:"",alt:null}}function Je(){return{type:"link",title:null,url:"",children:[]}}function nt(J){return{type:"list",ordered:J.type==="listOrdered",start:null,spread:J._spread,children:[]}}function Ge(J){return{type:"listItem",spread:J._spread,checked:null,children:[]}}function St(){return{type:"paragraph",children:[]}}function It(){return{type:"strong",children:[]}}function Vt(){return{type:"text",value:""}}function oe(){return{type:"thematicBreak"}}}function Gc(e){return{line:e.line,column:e.column,offset:e.offset}}function TE(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?TE(e,r):qJ(e,r)}}function qJ(e,n){let t;for(t in n)if(EE.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function wC(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+Jm({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+Jm({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+Jm({start:n.start,end:n.end})+") is still open")}function VJ(e){const n=this;n.parser=t;function t(r){return BJ(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}const NC={}.hasOwnProperty;function AE(e,n){const t=n||{};function r(a,...l){let o=r.invalid;const f=r.handlers;if(a&&NC.call(a,e)){const u=String(a[e]);o=NC.call(f,u)?f[u]:r.unknown}if(o)return o.call(this,a,...l)}return r.handlers=t.handlers||{},r.invalid=t.invalid,r.unknown=t.unknown,r}const HJ={}.hasOwnProperty;function DE(e,n){let t=-1,r;if(n.extensions)for(;++t<n.extensions.length;)DE(e,n.extensions[t]);for(r in n)if(HJ.call(n,r))switch(r){case"extensions":break;case"unsafe":{SC(e[r],n[r]);break}case"join":{SC(e[r],n[r]);break}case"handlers":{GJ(e[r],n[r]);break}default:e.options[r]=n[r]}return e}function SC(e,n){n&&e.push(...n)}function GJ(e,n){n&&Object.assign(e,n)}function YJ(e,n,t,r){const a=t.enter("blockquote"),l=t.createTracker(r);l.move("> "),l.shift(2);const o=t.indentLines(t.containerFlow(e,l.current()),WJ);return a(),o}function WJ(e,n,t){return">"+(t?"":" ")+e}function PE(e,n){return jC(e,n.inConstruct,!0)&&!jC(e,n.notInConstruct,!1)}function jC(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function CC(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&PE(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function QJ(e,n){const t=String(e);let r=t.indexOf(n),a=r,l=0,o=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++l>o&&(o=l):l=1,a=r+n.length,r=t.indexOf(n,a);return o}function E1(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function JJ(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function KJ(e,n,t,r){const a=JJ(t),l=e.value||"",o=a==="`"?"GraveAccent":"Tilde";if(E1(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(l,XJ);return g(),b}const f=t.createTracker(r),u=a.repeat(Math.max(QJ(l,a)+1,3)),d=t.enter("codeFenced");let h=f.move(u);if(e.lang){const g=t.enter(`codeFencedLang${o}`);h+=f.move(t.safe(e.lang,{before:h,after:" ",encode:["`"],...f.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${o}`);h+=f.move(" "),h+=f.move(t.safe(e.meta,{before:h,after:`
`,encode:["`"],...f.current()})),g()}return h+=f.move(`
`),l&&(h+=f.move(l+`
`)),h+=f.move(u),d(),h}function XJ(e,n,t){return(t?"":"    ")+e}function $w(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function ZJ(e,n,t,r){const a=$w(t),l=a==='"'?"Quote":"Apostrophe",o=t.enter("definition");let f=t.enter("label");const u=t.createTracker(r);let d=u.move("[");return d+=u.move(t.safe(t.associationId(e),{before:d,after:"]",...u.current()})),d+=u.move("]: "),f(),!e.url||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),d+=u.move("<"),d+=u.move(t.safe(e.url,{before:d,after:">",...u.current()})),d+=u.move(">")):(f=t.enter("destinationRaw"),d+=u.move(t.safe(e.url,{before:d,after:e.title?" ":`
`,...u.current()}))),f(),e.title&&(f=t.enter(`title${l}`),d+=u.move(" "+a),d+=u.move(t.safe(e.title,{before:d,after:a,...u.current()})),d+=u.move(a),f()),o(),d}function eK(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function iu(e){return"&#x"+e.toString(16).toUpperCase()+";"}function xb(e,n,t){const r=yb(e),a=yb(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}IE.peek=tK;function IE(e,n,t,r){const a=eK(t),l=t.enter("emphasis"),o=t.createTracker(r),f=o.move(a);let u=o.move(t.containerPhrasing(e,{after:a,before:f,...o.current()}));const d=u.charCodeAt(0),h=xb(r.before.charCodeAt(r.before.length-1),d,a);h.inside&&(u=iu(d)+u.slice(1));const g=u.charCodeAt(u.length-1),b=xb(r.after.charCodeAt(0),g,a);b.inside&&(u=u.slice(0,-1)+iu(g));const v=o.move(a);return l(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},f+u+v}function tK(e,n,t){return t.options.emphasis||"*"}const zw=function(e){if(e==null)return aK;if(typeof e=="function")return qb(e);if(typeof e=="object")return Array.isArray(e)?nK(e):iK(e);if(typeof e=="string")return rK(e);throw new Error("Expected function, string, or object as test")};function nK(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=zw(e[t]);return qb(r);function r(...a){let l=-1;for(;++l<n.length;)if(n[l].apply(this,a))return!0;return!1}}function iK(e){const n=e;return qb(t);function t(r){const a=r;let l;for(l in e)if(a[l]!==n[l])return!1;return!0}}function rK(e){return qb(n);function n(t){return t&&t.type===e}}function qb(e){return n;function n(t,r,a){return!!(sK(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function aK(){return!0}function sK(e){return e!==null&&typeof e=="object"&&"type"in e}const ME=[],lK=!0,T1=!1,oK="skip";function cK(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const l=zw(a),o=r?-1:1;f(e,void 0,[])();function f(u,d,h){const g=u&&typeof u=="object"?u:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(u.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=ME,S,k,T;if((!n||l(u,d,h[h.length-1]||void 0))&&(v=uK(t(u,h)),v[0]===T1))return v;if("children"in u&&u.children){const E=u;if(E.children&&v[0]!==oK)for(k=(r?E.children.length:-1)+o,T=h.concat(E);k>-1&&k<E.children.length;){const P=E.children[k];if(S=f(P,k,T)(),S[0]===T1)return S;k=typeof S[1]=="number"?S[1]:k+o}}return v}}}function uK(e){return Array.isArray(e)?e:typeof e=="number"?[lK,e]:e==null?ME:[e]}function RE(e,n,t,r){let a,l,o;typeof n=="function"?(l=void 0,o=n,a=t):(l=n,o=t,a=r),cK(e,l,f,a);function f(u,d){const h=d[d.length-1],g=h?h.children.indexOf(u):void 0;return o(u,g,h)}}function LE(e,n){let t=!1;return RE(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,T1}),!!((!e.depth||e.depth<3)&&Rw(e)&&(n.options.setext||t))}function dK(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),l=t.createTracker(r);if(LE(e,t)){const h=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...l.current(),before:`
`,after:`
`});return g(),h(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const o="#".repeat(a),f=t.enter("headingAtx"),u=t.enter("phrasing");l.move(o+" ");let d=t.containerPhrasing(e,{before:"# ",after:`
`,...l.current()});return/^[\t ]/.test(d)&&(d=iu(d.charCodeAt(0))+d.slice(1)),d=d?o+" "+d:o,t.options.closeAtx&&(d+=" "+o),u(),f(),d}OE.peek=fK;function OE(e){return e.value||""}function fK(){return"<"}FE.peek=hK;function FE(e,n,t,r){const a=$w(t),l=a==='"'?"Quote":"Apostrophe",o=t.enter("image");let f=t.enter("label");const u=t.createTracker(r);let d=u.move("![");return d+=u.move(t.safe(e.alt,{before:d,after:"]",...u.current()})),d+=u.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),d+=u.move("<"),d+=u.move(t.safe(e.url,{before:d,after:">",...u.current()})),d+=u.move(">")):(f=t.enter("destinationRaw"),d+=u.move(t.safe(e.url,{before:d,after:e.title?" ":")",...u.current()}))),f(),e.title&&(f=t.enter(`title${l}`),d+=u.move(" "+a),d+=u.move(t.safe(e.title,{before:d,after:a,...u.current()})),d+=u.move(a),f()),d+=u.move(")"),o(),d}function hK(){return"!"}$E.peek=pK;function $E(e,n,t,r){const a=e.referenceType,l=t.enter("imageReference");let o=t.enter("label");const f=t.createTracker(r);let u=f.move("![");const d=t.safe(e.alt,{before:u,after:"]",...f.current()});u+=f.move(d+"]["),o();const h=t.stack;t.stack=[],o=t.enter("reference");const g=t.safe(t.associationId(e),{before:u,after:"]",...f.current()});return o(),t.stack=h,l(),a==="full"||!d||d!==g?u+=f.move(g+"]"):a==="shortcut"?u=u.slice(0,-1):u+=f.move("]"),u}function pK(){return"!"}zE.peek=mK;function zE(e,n,t){let r=e.value||"",a="`",l=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++l<t.unsafe.length;){const o=t.unsafe[l],f=t.compilePattern(o);let u;if(o.atBreak)for(;u=f.exec(r);){let d=u.index;r.charCodeAt(d)===10&&r.charCodeAt(d-1)===13&&d--,r=r.slice(0,d)+" "+r.slice(u.index+1)}}return a+r+a}function mK(){return"`"}function BE(e,n){const t=Rw(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}UE.peek=gK;function UE(e,n,t,r){const a=$w(t),l=a==='"'?"Quote":"Apostrophe",o=t.createTracker(r);let f,u;if(BE(e,t)){const h=t.stack;t.stack=[],f=t.enter("autolink");let g=o.move("<");return g+=o.move(t.containerPhrasing(e,{before:g,after:">",...o.current()})),g+=o.move(">"),f(),t.stack=h,g}f=t.enter("link"),u=t.enter("label");let d=o.move("[");return d+=o.move(t.containerPhrasing(e,{before:d,after:"](",...o.current()})),d+=o.move("]("),u(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(u=t.enter("destinationLiteral"),d+=o.move("<"),d+=o.move(t.safe(e.url,{before:d,after:">",...o.current()})),d+=o.move(">")):(u=t.enter("destinationRaw"),d+=o.move(t.safe(e.url,{before:d,after:e.title?" ":")",...o.current()}))),u(),e.title&&(u=t.enter(`title${l}`),d+=o.move(" "+a),d+=o.move(t.safe(e.title,{before:d,after:a,...o.current()})),d+=o.move(a),u()),d+=o.move(")"),f(),d}function gK(e,n,t){return BE(e,t)?"<":"["}qE.peek=yK;function qE(e,n,t,r){const a=e.referenceType,l=t.enter("linkReference");let o=t.enter("label");const f=t.createTracker(r);let u=f.move("[");const d=t.containerPhrasing(e,{before:u,after:"]",...f.current()});u+=f.move(d+"]["),o();const h=t.stack;t.stack=[],o=t.enter("reference");const g=t.safe(t.associationId(e),{before:u,after:"]",...f.current()});return o(),t.stack=h,l(),a==="full"||!d||d!==g?u+=f.move(g+"]"):a==="shortcut"?u=u.slice(0,-1):u+=f.move("]"),u}function yK(){return"["}function Bw(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function xK(e){const n=Bw(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function bK(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function VE(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function vK(e,n,t,r){const a=t.enter("list"),l=t.bulletCurrent;let o=e.ordered?bK(t):Bw(t);const f=e.ordered?o==="."?")":".":xK(t);let u=n&&t.bulletLastUsed?o===t.bulletLastUsed:!1;if(!e.ordered){const h=e.children?e.children[0]:void 0;if((o==="*"||o==="-")&&h&&(!h.children||!h.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(u=!0),VE(t)===o&&h){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){u=!0;break}}}}u&&(o=f),t.bulletCurrent=o;const d=t.containerFlow(e,r);return t.bulletLastUsed=o,t.bulletCurrent=l,a(),d}function wK(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function NK(e,n,t,r){const a=wK(t);let l=t.bulletCurrent||Bw(t);n&&n.type==="list"&&n.ordered&&(l=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+l);let o=l.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(o=Math.ceil(o/4)*4);const f=t.createTracker(r);f.move(l+" ".repeat(o-l.length)),f.shift(o);const u=t.enter("listItem"),d=t.indentLines(t.containerFlow(e,f.current()),h);return u(),d;function h(g,b,v){return b?(v?"":" ".repeat(o))+g:(v?l:l+" ".repeat(o-l.length))+g}}function SK(e,n,t,r){const a=t.enter("paragraph"),l=t.enter("phrasing"),o=t.containerPhrasing(e,r);return l(),a(),o}const jK=zw(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function CK(e,n,t,r){return(e.children.some(function(o){return jK(o)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function _K(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}HE.peek=kK;function HE(e,n,t,r){const a=_K(t),l=t.enter("strong"),o=t.createTracker(r),f=o.move(a+a);let u=o.move(t.containerPhrasing(e,{after:a,before:f,...o.current()}));const d=u.charCodeAt(0),h=xb(r.before.charCodeAt(r.before.length-1),d,a);h.inside&&(u=iu(d)+u.slice(1));const g=u.charCodeAt(u.length-1),b=xb(r.after.charCodeAt(0),g,a);b.inside&&(u=u.slice(0,-1)+iu(g));const v=o.move(a+a);return l(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},f+u+v}function kK(e,n,t){return t.options.strong||"*"}function EK(e,n,t,r){return t.safe(e.value,r)}function TK(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function AK(e,n,t){const r=(VE(t)+(t.options.ruleSpaces?" ":"")).repeat(TK(t));return t.options.ruleSpaces?r.slice(0,-1):r}const DK={blockquote:YJ,break:CC,code:KJ,definition:ZJ,emphasis:IE,hardBreak:CC,heading:dK,html:OE,image:FE,imageReference:$E,inlineCode:zE,link:UE,linkReference:qE,list:vK,listItem:NK,paragraph:SK,root:CK,strong:HE,text:EK,thematicBreak:AK},PK=[IK];function IK(e,n,t,r){if(n.type==="code"&&E1(n,r)&&(e.type==="list"||e.type===n.type&&E1(e,r)))return!1;if("spread"in t&&typeof t.spread=="boolean")return e.type==="paragraph"&&(e.type===n.type||n.type==="definition"||n.type==="heading"&&LE(n,r))?void 0:t.spread?1:0}const Md=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],MK=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:Md},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:Md},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:Md},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:Md},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:Md},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:Md},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:Md},{atBreak:!0,character:"~"}];function RK(e){return e.label||!e.identifier?e.label||"":kE(e.identifier)}function LK(e){if(!e._compiled){const n=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((n?"("+n+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function OK(e,n,t){const r=n.indexStack,a=e.children||[],l=[];let o=-1,f=t.before,u;r.push(-1);let d=n.createTracker(t);for(;++o<a.length;){const h=a[o];let g;if(r[r.length-1]=o,o+1<a.length){let S=n.handle.handlers[a[o+1].type];S&&S.peek&&(S=S.peek),g=S?S(a[o+1],e,n,{before:"",after:"",...d.current()}).charAt(0):""}else g=t.after;l.length>0&&(f==="\r"||f===`
`)&&h.type==="html"&&(l[l.length-1]=l[l.length-1].replace(/(\r?\n|\r)$/," "),f=" ",d=n.createTracker(t),d.move(l.join("")));let b=n.handle(h,e,n,{...d.current(),after:g,before:f});u&&u===b.slice(0,1)&&(b=iu(u.charCodeAt(0))+b.slice(1));const v=n.attentionEncodeSurroundingInfo;n.attentionEncodeSurroundingInfo=void 0,u=void 0,v&&(l.length>0&&v.before&&f===l[l.length-1].slice(-1)&&(l[l.length-1]=l[l.length-1].slice(0,-1)+iu(f.charCodeAt(0))),v.after&&(u=g)),d.move(b),l.push(b),f=b.slice(-1)}return r.pop(),l.join("")}function FK(e,n,t){const r=n.indexStack,a=e.children||[],l=n.createTracker(t),o=[];let f=-1;for(r.push(-1);++f<a.length;){const u=a[f];r[r.length-1]=f,o.push(l.move(n.handle(u,e,n,{before:`
`,after:`
`,...l.current()}))),u.type!=="list"&&(n.bulletLastUsed=void 0),f<a.length-1&&o.push(l.move($K(u,a[f+1],e,n)))}return r.pop(),o.join("")}function $K(e,n,t,r){let a=r.join.length;for(;a--;){const l=r.join[a](e,n,t,r);if(l===!0||l===1)break;if(typeof l=="number")return`
`.repeat(1+l);if(l===!1)return`

<!---->

`}return`

`}const zK=/\r?\n|\r/g;function BK(e,n){const t=[];let r=0,a=0,l;for(;l=zK.exec(e);)o(e.slice(r,l.index)),t.push(l[0]),r=l.index+l[0].length,a++;return o(e.slice(r)),t.join("");function o(f){t.push(n(f,a,!f))}}function UK(e,n,t){const r=(t.before||"")+(n||"")+(t.after||""),a=[],l=[],o={};let f=-1;for(;++f<e.unsafe.length;){const h=e.unsafe[f];if(!PE(e.stack,h))continue;const g=e.compilePattern(h);let b;for(;b=g.exec(r);){const v="before"in h||!!h.atBreak,S="after"in h,k=b.index+(v?b[1].length:0);a.includes(k)?(o[k].before&&!v&&(o[k].before=!1),o[k].after&&!S&&(o[k].after=!1)):(a.push(k),o[k]={before:v,after:S})}}a.sort(qK);let u=t.before?t.before.length:0;const d=r.length-(t.after?t.after.length:0);for(f=-1;++f<a.length;){const h=a[f];h<u||h>=d||h+1<d&&a[f+1]===h+1&&o[h].after&&!o[h+1].before&&!o[h+1].after||a[f-1]===h-1&&o[h].before&&!o[h-1].before&&!o[h-1].after||(u!==h&&l.push(_C(r.slice(u,h),"\\")),u=h,/[!-/:-@[-`{-~]/.test(r.charAt(h))&&(!t.encode||!t.encode.includes(r.charAt(h)))?l.push("\\"):(l.push(iu(r.charCodeAt(h))),u++))}return l.push(_C(r.slice(u,d),t.after)),l.join("")}function qK(e,n){return e-n}function _C(e,n){const t=/\\(?=[!-/:-@[-`{-~])/g,r=[],a=[],l=e+n;let o=-1,f=0,u;for(;u=t.exec(l);)r.push(u.index);for(;++o<r.length;)f!==r[o]&&a.push(e.slice(f,r[o])),a.push("\\"),f=r[o];return a.push(e.slice(f)),a.join("")}function VK(e){const n=e||{},t=n.now||{};let r=n.lineShift||0,a=t.line||1,l=t.column||1;return{move:u,current:o,shift:f};function o(){return{now:{line:a,column:l},lineShift:r}}function f(d){r+=d}function u(d){const h=d||"",g=h.split(/\r?\n|\r/g),b=g[g.length-1];return a+=g.length-1,l=g.length===1?l+b.length:1+b.length+r,h}}function HK(e,n){const t=n||{},r={associationId:RK,containerPhrasing:QK,containerFlow:JK,createTracker:VK,compilePattern:LK,enter:l,handlers:{...DK},handle:void 0,indentLines:BK,indexStack:[],join:[...PK],options:{},safe:KK,stack:[],unsafe:[...MK]};DE(r,t),r.options.tightDefinitions&&r.join.push(WK),r.handle=AE("type",{invalid:GK,unknown:YK,handlers:r.handlers});let a=r.handle(e,void 0,r,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return a&&a.charCodeAt(a.length-1)!==10&&a.charCodeAt(a.length-1)!==13&&(a+=`
`),a;function l(o){return r.stack.push(o),f;function f(){r.stack.pop()}}}function GK(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function YK(e){const n=e;throw new Error("Cannot handle unknown node `"+n.type+"`")}function WK(e,n){if(e.type==="definition"&&e.type===n.type)return 0}function QK(e,n){return OK(e,this,n)}function JK(e,n){return FK(e,this,n)}function KK(e,n){return UK(this,e,n)}function XK(e){const n=this;n.compiler=t;function t(r){return HK(r,{...n.data("settings"),...e,extensions:n.data("toMarkdownExtensions")||[]})}}function kC(e){if(e)throw e}var T0,EC;function ZK(){if(EC)return T0;EC=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(d){return typeof Array.isArray=="function"?Array.isArray(d):n.call(d)==="[object Array]"},l=function(d){if(!d||n.call(d)!=="[object Object]")return!1;var h=e.call(d,"constructor"),g=d.constructor&&d.constructor.prototype&&e.call(d.constructor.prototype,"isPrototypeOf");if(d.constructor&&!h&&!g)return!1;var b;for(b in d);return typeof b>"u"||e.call(d,b)},o=function(d,h){t&&h.name==="__proto__"?t(d,h.name,{enumerable:!0,configurable:!0,value:h.newValue,writable:!0}):d[h.name]=h.newValue},f=function(d,h){if(h==="__proto__")if(e.call(d,h)){if(r)return r(d,h).value}else return;return d[h]};return T0=function u(){var d,h,g,b,v,S,k=arguments[0],T=1,E=arguments.length,P=!1;for(typeof k=="boolean"&&(P=k,k=arguments[1]||{},T=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});T<E;++T)if(d=arguments[T],d!=null)for(h in d)g=f(k,h),b=f(d,h),k!==b&&(P&&b&&(l(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&l(g)?g:{},o(k,{name:h,newValue:u(P,S,b)})):typeof b<"u"&&o(k,{name:h,newValue:b}));return k},T0}var eX=ZK();const A0=Gd(eX);function A1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function tX(){const e=[],n={run:t,use:r};return n;function t(...a){let l=-1;const o=a.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);f(null,...a);function f(u,...d){const h=e[++l];let g=-1;if(u){o(u);return}for(;++g<a.length;)(d[g]===null||d[g]===void 0)&&(d[g]=a[g]);a=d,h?nX(h,f)(...d):o(null,...d)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function nX(e,n){let t;return r;function r(...o){const f=e.length>o.length;let u;f&&o.push(a);try{u=e.apply(this,o)}catch(d){const h=d;if(f&&t)throw h;return a(h)}f||(u&&u.then&&typeof u.then=="function"?u.then(l,a):u instanceof Error?a(u):l(u))}function a(o,...f){t||(t=!0,n(o,...f))}function l(o){a(null,o)}}class xa extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",l={},o=!1;if(t&&("line"in t&&"column"in t?l={place:t}:"start"in t&&"end"in t?l={place:t}:"type"in t?l={ancestors:[t],place:t.position}:l={...t}),typeof n=="string"?a=n:!l.cause&&n&&(o=!0,a=n.message,l.cause=n),!l.ruleId&&!l.source&&typeof r=="string"){const u=r.indexOf(":");u===-1?l.ruleId=r:(l.source=r.slice(0,u),l.ruleId=r.slice(u+1))}if(!l.place&&l.ancestors&&l.ancestors){const u=l.ancestors[l.ancestors.length-1];u&&(l.place=u.position)}const f=l.place&&"start"in l.place?l.place.start:l.place;this.ancestors=l.ancestors||void 0,this.cause=l.cause||void 0,this.column=f?f.column:void 0,this.fatal=void 0,this.file="",this.message=a,this.line=f?f.line:void 0,this.name=Jm(l.place)||"1:1",this.place=l.place||void 0,this.reason=this.message,this.ruleId=l.ruleId||void 0,this.source=l.source||void 0,this.stack=o&&l.cause&&typeof l.cause.stack=="string"?l.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}xa.prototype.file="";xa.prototype.name="";xa.prototype.reason="";xa.prototype.message="";xa.prototype.stack="";xa.prototype.column=void 0;xa.prototype.line=void 0;xa.prototype.ancestors=void 0;xa.prototype.cause=void 0;xa.prototype.fatal=void 0;xa.prototype.place=void 0;xa.prototype.ruleId=void 0;xa.prototype.source=void 0;const $l={basename:iX,dirname:rX,extname:aX,join:sX,sep:"/"};function iX(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');yg(e);let t=0,r=-1,a=e.length,l;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(l){t=a+1;break}}else r<0&&(l=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let o=-1,f=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(l){t=a+1;break}}else o<0&&(l=!0,o=a+1),f>-1&&(e.codePointAt(a)===n.codePointAt(f--)?f<0&&(r=a):(f=-1,r=o));return t===r?r=o:r<0&&(r=e.length),e.slice(t,r)}function rX(e){if(yg(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function aX(e){yg(e);let n=e.length,t=-1,r=0,a=-1,l=0,o;for(;n--;){const f=e.codePointAt(n);if(f===47){if(o){r=n+1;break}continue}t<0&&(o=!0,t=n+1),f===46?a<0?a=n:l!==1&&(l=1):a>-1&&(l=-1)}return a<0||t<0||l===0||l===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function sX(...e){let n=-1,t;for(;++n<e.length;)yg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":lX(t)}function lX(e){yg(e);const n=e.codePointAt(0)===47;let t=oX(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function oX(e,n){let t="",r=0,a=-1,l=0,o=-1,f,u;for(;++o<=e.length;){if(o<e.length)f=e.codePointAt(o);else{if(f===47)break;f=47}if(f===47){if(!(a===o-1||l===1))if(a!==o-1&&l===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(u=t.lastIndexOf("/"),u!==t.length-1){u<0?(t="",r=0):(t=t.slice(0,u),r=t.length-1-t.lastIndexOf("/")),a=o,l=0;continue}}else if(t.length>0){t="",r=0,a=o,l=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,o):t=e.slice(a+1,o),r=o-a-1;a=o,l=0}else f===46&&l>-1?l++:l=-1}return t}function yg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const cX={cwd:uX};function uX(){return"/"}function D1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function dX(e){if(typeof e=="string")e=new URL(e);else if(!D1(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return fX(e)}function fX(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const D0=["history","path","basename","stem","extname","dirname"];class hX{constructor(n){let t;n?D1(n)?t={path:n}:typeof n=="string"||pX(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":cX.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<D0.length;){const l=D0[r];l in t&&t[l]!==void 0&&t[l]!==null&&(this[l]=l==="history"?[...t[l]]:t[l])}let a;for(a in t)D0.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?$l.basename(this.path):void 0}set basename(n){I0(n,"basename"),P0(n,"basename"),this.path=$l.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?$l.dirname(this.path):void 0}set dirname(n){TC(this.basename,"dirname"),this.path=$l.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?$l.extname(this.path):void 0}set extname(n){if(P0(n,"extname"),TC(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=$l.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){D1(n)&&(n=dX(n)),I0(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?$l.basename(this.path,this.extname):void 0}set stem(n){I0(n,"stem"),P0(n,"stem"),this.path=$l.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new xa(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}}function P0(e,n){if(e&&e.includes($l.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+$l.sep+"`")}function I0(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function TC(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function pX(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const mX=function(e){const r=this.constructor.prototype,a=r[e],l=function(){return a.apply(l,arguments)};return Object.setPrototypeOf(l,r),l},gX={}.hasOwnProperty;class Uw extends mX{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=tX()}copy(){const n=new Uw;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data(A0(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(L0("data",this.frozen),this.namespace[n]=t,this):gX.call(this.namespace,n)&&this.namespace[n]||void 0:n?(L0("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=Dx(n),r=this.parser||this.Parser;return M0("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),M0("process",this.parser||this.Parser),R0("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(l,o){const f=Dx(n),u=r.parse(f);r.run(u,f,function(h,g,b){if(h||!g||!b)return d(h);const v=g,S=r.stringify(v,b);bX(S)?b.value=S:b.result=S,d(h,b)});function d(h,g){h||!g?o(h):l?l(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),M0("processSync",this.parser||this.Parser),R0("processSync",this.compiler||this.Compiler),this.process(n,a),DC("processSync","process",t),r;function a(l,o){t=!0,kC(l),r=o}}run(n,t,r){AC(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?l(void 0,r):new Promise(l);function l(o,f){const u=Dx(t);a.run(n,u,d);function d(h,g,b){const v=g||n;h?f(h):o?o(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,l),DC("runSync","run",r),a;function l(o,f){kC(o),a=f,r=!0}}stringify(n,t){this.freeze();const r=Dx(t),a=this.compiler||this.Compiler;return R0("stringify",a),AC(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(L0("use",this.frozen),n!=null)if(typeof n=="function")u(n,t);else if(typeof n=="object")Array.isArray(n)?f(n):o(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function l(d){if(typeof d=="function")u(d,[]);else if(typeof d=="object")if(Array.isArray(d)){const[h,...g]=d;u(h,g)}else o(d);else throw new TypeError("Expected usable value, not `"+d+"`")}function o(d){if(!("plugins"in d)&&!("settings"in d))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");f(d.plugins),d.settings&&(a.settings=A0(!0,a.settings,d.settings))}function f(d){let h=-1;if(d!=null)if(Array.isArray(d))for(;++h<d.length;){const g=d[h];l(g)}else throw new TypeError("Expected a list of plugins, not `"+d+"`")}function u(d,h){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===d){b=g;break}if(b===-1)r.push([d,...h]);else if(h.length>0){let[v,...S]=h;const k=r[b][1];A1(k)&&A1(v)&&(v=A0(!0,k,v)),r[b]=[d,v,...S]}}}}const yX=new Uw().freeze();function M0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function R0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function L0(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function AC(e){if(!A1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function DC(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function Dx(e){return xX(e)?e:new hX(e)}function xX(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function bX(e){return typeof e=="string"||vX(e)}function vX(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const wX=yX().use(VJ).use(XK).freeze(),GE=-1,Vb=0,Km=1,bb=2,qw=3,Vw=4,Hw=5,Gw=6,YE=7,WE=8,PC=typeof self=="object"?self:globalThis,NX=(e,n)=>{const t=(a,l)=>(e.set(l,a),a),r=a=>{if(e.has(a))return e.get(a);const[l,o]=n[a];switch(l){case Vb:case GE:return t(o,a);case Km:{const f=t([],a);for(const u of o)f.push(r(u));return f}case bb:{const f=t({},a);for(const[u,d]of o)f[r(u)]=r(d);return f}case qw:return t(new Date(o),a);case Vw:{const{source:f,flags:u}=o;return t(new RegExp(f,u),a)}case Hw:{const f=t(new Map,a);for(const[u,d]of o)f.set(r(u),r(d));return f}case Gw:{const f=t(new Set,a);for(const u of o)f.add(r(u));return f}case YE:{const{name:f,message:u}=o;return t(new PC[f](u),a)}case WE:return t(BigInt(o),a);case"BigInt":return t(Object(BigInt(o)),a);case"ArrayBuffer":return t(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:f}=new Uint8Array(o);return t(new DataView(f),o)}}return t(new PC[l](o),a)};return r},IC=e=>NX(new Map,e)(0),Ch="",{toString:SX}={},{keys:jX}=Object,Bm=e=>{const n=typeof e;if(n!=="object"||!e)return[Vb,n];const t=SX.call(e).slice(8,-1);switch(t){case"Array":return[Km,Ch];case"Object":return[bb,Ch];case"Date":return[qw,Ch];case"RegExp":return[Vw,Ch];case"Map":return[Hw,Ch];case"Set":return[Gw,Ch];case"DataView":return[Km,t]}return t.includes("Array")?[Km,t]:t.includes("Error")?[YE,t]:[bb,t]},Px=([e,n])=>e===Vb&&(n==="function"||n==="symbol"),CX=(e,n,t,r)=>{const a=(o,f)=>{const u=r.push(o)-1;return t.set(f,u),u},l=o=>{if(t.has(o))return t.get(o);let[f,u]=Bm(o);switch(f){case Vb:{let h=o;switch(u){case"bigint":f=WE,h=o.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+u);h=null;break;case"undefined":return a([GE],o)}return a([f,h],o)}case Km:{if(u){let b=o;return u==="DataView"?b=new Uint8Array(o.buffer):u==="ArrayBuffer"&&(b=new Uint8Array(o)),a([u,[...b]],o)}const h=[],g=a([f,h],o);for(const b of o)h.push(l(b));return g}case bb:{if(u)switch(u){case"BigInt":return a([u,o.toString()],o);case"Boolean":case"Number":case"String":return a([u,o.valueOf()],o)}if(n&&"toJSON"in o)return l(o.toJSON());const h=[],g=a([f,h],o);for(const b of jX(o))(e||!Px(Bm(o[b])))&&h.push([l(b),l(o[b])]);return g}case qw:return a([f,o.toISOString()],o);case Vw:{const{source:h,flags:g}=o;return a([f,{source:h,flags:g}],o)}case Hw:{const h=[],g=a([f,h],o);for(const[b,v]of o)(e||!(Px(Bm(b))||Px(Bm(v))))&&h.push([l(b),l(v)]);return g}case Gw:{const h=[],g=a([f,h],o);for(const b of o)(e||!Px(Bm(b)))&&h.push(l(b));return g}}const{message:d}=o;return a([f,{name:u,message:d}],o)};return l},MC=(e,{json:n,lossy:t}={})=>{const r=[];return CX(!(n||t),!!n,new Map,r)(e),r},lg=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?IC(MC(e,n)):structuredClone(e):(e,n)=>IC(MC(e,n)),QE=KE("end"),JE=KE("start");function KE(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function XE(e){const n=JE(e),t=QE(e);if(n&&t)return{start:n,end:t}}const Rd=["ariaDescribedBy","ariaLabel","ariaLabelledBy"],RC={ancestors:{tbody:["table"],td:["table"],th:["table"],thead:["table"],tfoot:["table"],tr:["table"]},attributes:{a:[...Rd,"dataFootnoteBackref","dataFootnoteRef",["className","data-footnote-backref"],"href"],blockquote:["cite"],code:[["className",/^language-./]],del:["cite"],div:["itemScope","itemType"],dl:[...Rd],h2:[["className","sr-only"]],img:[...Rd,"longDesc","src"],input:[["disabled",!0],["type","checkbox"]],ins:["cite"],li:[["className","task-list-item"]],ol:[...Rd,["className","contains-task-list"]],q:["cite"],section:["dataFootnotes",["className","footnotes"]],source:["srcSet"],summary:[...Rd],table:[...Rd],ul:[...Rd,["className","contains-task-list"]],"*":["abbr","accept","acceptCharset","accessKey","action","align","alt","axis","border","cellPadding","cellSpacing","char","charOff","charSet","checked","clear","colSpan","color","cols","compact","coords","dateTime","dir","encType","frame","hSpace","headers","height","hrefLang","htmlFor","id","isMap","itemProp","label","lang","maxLength","media","method","multiple","name","noHref","noShade","noWrap","open","prompt","readOnly","rev","rowSpan","rows","rules","scope","selected","shape","size","span","start","summary","tabIndex","title","useMap","vAlign","value","width"]},clobber:["ariaDescribedBy","ariaLabelledBy","id","name"],clobberPrefix:"user-content-",protocols:{cite:["http","https"],href:["http","https","irc","ircs","mailto","xmpp"],longDesc:["http","https"],src:["http","https"]},required:{input:{disabled:!0,type:"checkbox"}},strip:["script"],tagNames:["a","b","blockquote","br","code","dd","del","details","div","dl","dt","em","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","li","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","tr","tt","ul","var"]},Jc={}.hasOwnProperty;function _X(e,n){let t={type:"root",children:[]};const r={schema:n?{...RC,...n}:RC,stack:[]},a=ZE(r,e);return a&&(Array.isArray(a)?a.length===1?t=a[0]:t.children=a:t=a),t}function ZE(e,n){if(n&&typeof n=="object"){const t=n;switch(typeof t.type=="string"?t.type:""){case"comment":return kX(e,t);case"doctype":return EX(e,t);case"element":return TX(e,t);case"root":return AX(e,t);case"text":return DX(e,t)}}}function kX(e,n){if(e.schema.allowComments){const t=typeof n.value=="string"?n.value:"",r=t.indexOf("-->"),l={type:"comment",value:r<0?t:t.slice(0,r)};return xg(l,n),l}}function EX(e,n){if(e.schema.allowDoctypes){const t={type:"doctype"};return xg(t,n),t}}function TX(e,n){const t=typeof n.tagName=="string"?n.tagName:"";e.stack.push(t);const r=eT(e,n.children),a=PX(e,n.properties);e.stack.pop();let l=!1;if(t&&t!=="*"&&(!e.schema.tagNames||e.schema.tagNames.includes(t))&&(l=!0,e.schema.ancestors&&Jc.call(e.schema.ancestors,t))){const f=e.schema.ancestors[t];let u=-1;for(l=!1;++u<f.length;)e.stack.includes(f[u])&&(l=!0)}if(!l)return e.schema.strip&&!e.schema.strip.includes(t)?r:void 0;const o={type:"element",tagName:t,properties:a,children:r};return xg(o,n),o}function AX(e,n){const r={type:"root",children:eT(e,n.children)};return xg(r,n),r}function DX(e,n){const r={type:"text",value:typeof n.value=="string"?n.value:""};return xg(r,n),r}function eT(e,n){const t=[];if(Array.isArray(n)){const r=n;let a=-1;for(;++a<r.length;){const l=ZE(e,r[a]);l&&(Array.isArray(l)?t.push(...l):t.push(l))}}return t}function PX(e,n){const t=e.stack[e.stack.length-1],r=e.schema.attributes,a=e.schema.required,l=r&&Jc.call(r,t)?r[t]:void 0,o=r&&Jc.call(r,"*")?r["*"]:void 0,f=n&&typeof n=="object"?n:{},u={};let d;for(d in f)if(Jc.call(f,d)){const h=f[d];let g=LC(e,OC(l,d),d,h);g==null&&(g=LC(e,OC(o,d),d,h)),g!=null&&(u[d]=g)}if(a&&Jc.call(a,t)){const h=a[t];for(d in h)Jc.call(h,d)&&!Jc.call(u,d)&&(u[d]=h[d])}return u}function LC(e,n,t,r){return n?Array.isArray(r)?IX(e,n,t,r):tT(e,n,t,r):void 0}function IX(e,n,t,r){let a=-1;const l=[];for(;++a<r.length;){const o=tT(e,n,t,r[a]);(typeof o=="number"||typeof o=="string")&&l.push(o)}return l}function tT(e,n,t,r){if(!(typeof r!="boolean"&&typeof r!="number"&&typeof r!="string")&&MX(e,t,r)){if(typeof n=="object"&&n.length>1){let a=!1,l=0;for(;++l<n.length;){const o=n[l];if(o&&typeof o=="object"&&"flags"in o){if(o.test(String(r))){a=!0;break}}else if(o===r){a=!0;break}}if(!a)return}return e.schema.clobber&&e.schema.clobberPrefix&&e.schema.clobber.includes(t)?e.schema.clobberPrefix+r:r}}function MX(e,n,t){const r=e.schema.protocols&&Jc.call(e.schema.protocols,n)?e.schema.protocols[n]:void 0;if(!r||r.length===0)return!0;const a=String(t),l=a.indexOf(":"),o=a.indexOf("?"),f=a.indexOf("#"),u=a.indexOf("/");if(l<0||u>-1&&l>u||o>-1&&l>o||f>-1&&l>f)return!0;let d=-1;for(;++d<r.length;){const h=r[d];if(l===h.length&&a.slice(0,h.length)===h)return!0}return!1}function xg(e,n){const t=XE(n);n.data&&(e.data=lg(n.data)),t&&(e.position=t)}function OC(e,n){let t,r=-1;if(e)for(;++r<e.length;){const a=e[r],l=typeof a=="string"?a:a[0];if(l===n)return a;l==="data*"&&(t=a)}if(n.length>4&&n.slice(0,4).toLowerCase()==="data")return t}function RX(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function LX(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function OX(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function FX(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function $X(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function zX(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=ep(r.toLowerCase()),l=e.footnoteOrder.indexOf(r);let o,f=e.footnoteCounts.get(r);f===void 0?(f=0,e.footnoteOrder.push(r),o=e.footnoteOrder.length):o=l+1,f+=1,e.footnoteCounts.set(r,f);const u={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(f>1?"-"+f:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};e.patch(n,u);const d={type:"element",tagName:"sup",properties:{},children:[u]};return e.patch(n,d),e.applyData(n,d)}function BX(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function UX(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function nT(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),l=a[0];l&&l.type==="text"?l.value="["+l.value:a.unshift({type:"text",value:"["});const o=a[a.length-1];return o&&o.type==="text"?o.value+=r:a.push({type:"text",value:r}),a}function qX(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return nT(e,n);const a={src:ep(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const l={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,l),e.applyData(n,l)}function VX(e,n){const t={src:ep(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function HX(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function GX(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return nT(e,n);const a={href:ep(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const l={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,l),e.applyData(n,l)}function YX(e,n){const t={href:ep(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function WX(e,n,t){const r=e.all(n),a=t?QX(t):iT(n),l={},o=[];if(typeof n.checked=="boolean"){const h=r[0];let g;h&&h.type==="element"&&h.tagName==="p"?g=h:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),l.className=["task-list-item"]}let f=-1;for(;++f<r.length;){const h=r[f];(a||f!==0||h.type!=="element"||h.tagName!=="p")&&o.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!a?o.push(...h.children):o.push(h)}const u=r[r.length-1];u&&(a||u.type!=="element"||u.tagName!=="p")&&o.push({type:"text",value:`
`});const d={type:"element",tagName:"li",properties:l,children:o};return e.patch(n,d),e.applyData(n,d)}function QX(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=iT(t[r])}return n}function iT(e){const n=e.spread;return n??e.children.length>1}function JX(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const o=r[a];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const l={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,l),e.applyData(n,l)}function KX(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function XX(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function ZX(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function eZ(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],o),a.push(o)}if(t.length>0){const o={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},f=JE(n.children[1]),u=QE(n.children[n.children.length-1]);f&&u&&(o.position={start:f,end:u}),a.push(o)}const l={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,l),e.applyData(n,l)}function tZ(e,n,t){const r=t?t.children:void 0,l=(r?r.indexOf(n):1)===0?"th":"td",o=t&&t.type==="table"?t.align:void 0,f=o?o.length:n.children.length;let u=-1;const d=[];for(;++u<f;){const g=n.children[u],b={},v=o?o[u]:void 0;v&&(b.align=v);let S={type:"element",tagName:l,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),d.push(S)}const h={type:"element",tagName:"tr",properties:{},children:e.wrap(d,!0)};return e.patch(n,h),e.applyData(n,h)}function nZ(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const FC=9,$C=32;function iZ(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const l=[];for(;r;)l.push(zC(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return l.push(zC(n.slice(a),a>0,!1)),l.join("")}function zC(e,n,t){let r=0,a=e.length;if(n){let l=e.codePointAt(r);for(;l===FC||l===$C;)r++,l=e.codePointAt(r)}if(t){let l=e.codePointAt(a-1);for(;l===FC||l===$C;)a--,l=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function rZ(e,n){const t={type:"text",value:iZ(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function aZ(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const sZ={blockquote:RX,break:LX,code:OX,delete:FX,emphasis:$X,footnoteReference:zX,heading:BX,html:UX,imageReference:qX,image:VX,inlineCode:HX,linkReference:GX,link:YX,listItem:WX,list:JX,paragraph:KX,root:XX,strong:ZX,table:eZ,tableCell:nZ,tableRow:tZ,text:rZ,thematicBreak:aZ,toml:Ix,yaml:Ix,definition:Ix,footnoteDefinition:Ix};function Ix(){}function lZ(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function oZ(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function cZ(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||lZ,r=e.options.footnoteBackLabel||oZ,a=e.options.footnoteLabel||"Footnotes",l=e.options.footnoteLabelTagName||"h2",o=e.options.footnoteLabelProperties||{className:["sr-only"]},f=[];let u=-1;for(;++u<e.footnoteOrder.length;){const d=e.footnoteById.get(e.footnoteOrder[u]);if(!d)continue;const h=e.all(d),g=String(d.identifier).toUpperCase(),b=ep(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let P=typeof t=="string"?t:t(u,v);typeof P=="string"&&(P={type:"text",value:P}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(u,v),className:["data-footnote-backref"]},children:Array.isArray(P)?P:[P]})}const T=h[h.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const P=T.children[T.children.length-1];P&&P.type==="text"?P.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...S)}else h.push(...S);const E={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(h,!0)};e.patch(d,E),f.push(E)}if(f.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:l,properties:{...lg(o),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(f,!0)},{type:"text",value:`
`}]}}const P1={}.hasOwnProperty,uZ={};function dZ(e,n){const t=n||uZ,r=new Map,a=new Map,l=new Map,o={...sZ,...t.handlers},f={all:d,applyData:hZ,definitionById:r,footnoteById:a,footnoteCounts:l,footnoteOrder:[],handlers:o,one:u,options:t,patch:fZ,wrap:mZ};return RE(e,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const g=h.type==="definition"?r:a,b=String(h.identifier).toUpperCase();g.has(b)||g.set(b,h)}}),f;function u(h,g){const b=h.type,v=f.handlers[b];if(P1.call(f.handlers,b)&&v)return v(f,h,g);if(f.options.passThrough&&f.options.passThrough.includes(b)){if("children"in h){const{children:k,...T}=h,E=lg(T);return E.children=f.all(h),E}return lg(h)}return(f.options.unknownHandler||pZ)(f,h,g)}function d(h){const g=[];if("children"in h){const b=h.children;let v=-1;for(;++v<b.length;){const S=f.one(b[v],h);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=BC(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=BC(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function fZ(e,n){e.position&&(n.position=XE(e))}function hZ(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,l=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const o="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:o}}t.type==="element"&&l&&Object.assign(t.properties,lg(l)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function pZ(e,n){const t=n.data||{},r="value"in n&&!(P1.call(t,"hProperties")||P1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function mZ(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function BC(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function gZ(e,n){const t=dZ(e,n),r=t.one(e,void 0),a=cZ(t),l=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&l.children.push({type:"text",value:`
`},a),l}const yZ=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"];class bg{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}}bg.prototype.normal={};bg.prototype.property={};bg.prototype.space=void 0;function rT(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new bg(t,r,n)}function I1(e){return e.toLowerCase()}class ba{constructor(n,t){this.attribute=t,this.property=n}}ba.prototype.attribute="";ba.prototype.booleanish=!1;ba.prototype.boolean=!1;ba.prototype.commaOrSpaceSeparated=!1;ba.prototype.commaSeparated=!1;ba.prototype.defined=!1;ba.prototype.mustUseProperty=!1;ba.prototype.number=!1;ba.prototype.overloadedBoolean=!1;ba.prototype.property="";ba.prototype.spaceSeparated=!1;ba.prototype.space=void 0;let xZ=0;const Kt=Wd(),qi=Wd(),M1=Wd(),ot=Wd(),ri=Wd(),Lh=Wd(),Oa=Wd();function Wd(){return 2**++xZ}const R1=Object.freeze(Object.defineProperty({__proto__:null,boolean:Kt,booleanish:qi,commaOrSpaceSeparated:Oa,commaSeparated:Lh,number:ot,overloadedBoolean:M1,spaceSeparated:ri},Symbol.toStringTag,{value:"Module"})),O0=Object.keys(R1);class Yw extends ba{constructor(n,t,r,a){let l=-1;if(super(n,t),UC(this,"space",a),typeof r=="number")for(;++l<O0.length;){const o=O0[l];UC(this,O0[l],(r&R1[o])===R1[o])}}}Yw.prototype.defined=!0;function UC(e,n,t){t&&(e[n]=t)}function tp(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const l=new Yw(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(l.mustUseProperty=!0),n[r]=l,t[I1(r)]=r,t[I1(l.attribute)]=r}return new bg(n,t,e.space)}const aT=tp({properties:{ariaActiveDescendant:null,ariaAtomic:qi,ariaAutoComplete:null,ariaBusy:qi,ariaChecked:qi,ariaColCount:ot,ariaColIndex:ot,ariaColSpan:ot,ariaControls:ri,ariaCurrent:null,ariaDescribedBy:ri,ariaDetails:null,ariaDisabled:qi,ariaDropEffect:ri,ariaErrorMessage:null,ariaExpanded:qi,ariaFlowTo:ri,ariaGrabbed:qi,ariaHasPopup:null,ariaHidden:qi,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:ri,ariaLevel:ot,ariaLive:null,ariaModal:qi,ariaMultiLine:qi,ariaMultiSelectable:qi,ariaOrientation:null,ariaOwns:ri,ariaPlaceholder:null,ariaPosInSet:ot,ariaPressed:qi,ariaReadOnly:qi,ariaRelevant:null,ariaRequired:qi,ariaRoleDescription:ri,ariaRowCount:ot,ariaRowIndex:ot,ariaRowSpan:ot,ariaSelected:qi,ariaSetSize:ot,ariaSort:null,ariaValueMax:ot,ariaValueMin:ot,ariaValueNow:ot,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function sT(e,n){return n in e?e[n]:n}function lT(e,n){return sT(e,n.toLowerCase())}const bZ=tp({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Lh,acceptCharset:ri,accessKey:ri,action:null,allow:null,allowFullScreen:Kt,allowPaymentRequest:Kt,allowUserMedia:Kt,alt:null,as:null,async:Kt,autoCapitalize:null,autoComplete:ri,autoFocus:Kt,autoPlay:Kt,blocking:ri,capture:null,charSet:null,checked:Kt,cite:null,className:ri,cols:ot,colSpan:null,content:null,contentEditable:qi,controls:Kt,controlsList:ri,coords:ot|Lh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Kt,defer:Kt,dir:null,dirName:null,disabled:Kt,download:M1,draggable:qi,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Kt,formTarget:null,headers:ri,height:ot,hidden:M1,high:ot,href:null,hrefLang:null,htmlFor:ri,httpEquiv:ri,id:null,imageSizes:null,imageSrcSet:null,inert:Kt,inputMode:null,integrity:null,is:null,isMap:Kt,itemId:null,itemProp:ri,itemRef:ri,itemScope:Kt,itemType:ri,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Kt,low:ot,manifest:null,max:null,maxLength:ot,media:null,method:null,min:null,minLength:ot,multiple:Kt,muted:Kt,name:null,nonce:null,noModule:Kt,noValidate:Kt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Kt,optimum:ot,pattern:null,ping:ri,placeholder:null,playsInline:Kt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Kt,referrerPolicy:null,rel:ri,required:Kt,reversed:Kt,rows:ot,rowSpan:ot,sandbox:ri,scope:null,scoped:Kt,seamless:Kt,selected:Kt,shadowRootClonable:Kt,shadowRootDelegatesFocus:Kt,shadowRootMode:null,shape:null,size:ot,sizes:null,slot:null,span:ot,spellCheck:qi,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ot,step:null,style:null,tabIndex:ot,target:null,title:null,translate:null,type:null,typeMustMatch:Kt,useMap:null,value:qi,width:ot,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:ri,axis:null,background:null,bgColor:null,border:ot,borderColor:null,bottomMargin:ot,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Kt,declare:Kt,event:null,face:null,frame:null,frameBorder:null,hSpace:ot,leftMargin:ot,link:null,longDesc:null,lowSrc:null,marginHeight:ot,marginWidth:ot,noResize:Kt,noHref:Kt,noShade:Kt,noWrap:Kt,object:null,profile:null,prompt:null,rev:null,rightMargin:ot,rules:null,scheme:null,scrolling:qi,standby:null,summary:null,text:null,topMargin:ot,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ot,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Kt,disableRemotePlayback:Kt,prefix:null,property:null,results:ot,security:null,unselectable:null},space:"html",transform:lT}),vZ=tp({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Oa,accentHeight:ot,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ot,amplitude:ot,arabicForm:null,ascent:ot,attributeName:null,attributeType:null,azimuth:ot,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ot,by:null,calcMode:null,capHeight:ot,className:ri,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ot,diffuseConstant:ot,direction:null,display:null,dur:null,divisor:ot,dominantBaseline:null,download:Kt,dx:null,dy:null,edgeMode:null,editable:null,elevation:ot,enableBackground:null,end:null,event:null,exponent:ot,externalResourcesRequired:null,fill:null,fillOpacity:ot,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Lh,g2:Lh,glyphName:Lh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ot,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ot,horizOriginX:ot,horizOriginY:ot,id:null,ideographic:ot,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ot,k:ot,k1:ot,k2:ot,k3:ot,k4:ot,kernelMatrix:Oa,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ot,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ot,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ot,overlineThickness:ot,paintOrder:null,panose1:null,path:null,pathLength:ot,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:ri,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ot,pointsAtY:ot,pointsAtZ:ot,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Oa,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Oa,rev:Oa,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Oa,requiredFeatures:Oa,requiredFonts:Oa,requiredFormats:Oa,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ot,specularExponent:ot,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ot,strikethroughThickness:ot,string:null,stroke:null,strokeDashArray:Oa,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ot,strokeOpacity:ot,strokeWidth:null,style:null,surfaceScale:ot,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Oa,tabIndex:ot,tableValues:null,target:null,targetX:ot,targetY:ot,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Oa,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ot,underlineThickness:ot,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ot,values:null,vAlphabetic:ot,vMathematical:ot,vectorEffect:null,vHanging:ot,vIdeographic:ot,version:null,vertAdvY:ot,vertOriginX:ot,vertOriginY:ot,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ot,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:sT}),oT=tp({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),cT=tp({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:lT}),uT=tp({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),wZ=/[A-Z]/g,qC=/-[a-z]/g,NZ=/^data[-\w.:]+$/i;function SZ(e,n){const t=I1(n);let r=n,a=ba;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&NZ.test(n)){if(n.charAt(4)==="-"){const l=n.slice(5).replace(qC,CZ);r="data"+l.charAt(0).toUpperCase()+l.slice(1)}else{const l=n.slice(4);if(!qC.test(l)){let o=l.replace(wZ,jZ);o.charAt(0)!=="-"&&(o="-"+o),n="data"+o}}a=Yw}return new a(r,n)}function jZ(e){return"-"+e.toLowerCase()}function CZ(e){return e.charAt(1).toUpperCase()}const _Z=rT([aT,bZ,oT,cT,uT],"html"),dT=rT([aT,vZ,oT,cT,uT],"svg"),kZ=/["&'<>`]/g,EZ=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,TZ=/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,AZ=/[|\\{}()[\]^$+*?.]/g,VC=new WeakMap;function DZ(e,n){if(e=e.replace(n.subset?PZ(n.subset):kZ,r),n.subset||n.escapeOnly)return e;return e.replace(EZ,t).replace(TZ,r);function t(a,l,o){return n.format((a.charCodeAt(0)-55296)*1024+a.charCodeAt(1)-56320+65536,o.charCodeAt(l+2),n)}function r(a,l,o){return n.format(a.charCodeAt(0),o.charCodeAt(l+1),n)}}function PZ(e){let n=VC.get(e);return n||(n=IZ(e),VC.set(e,n)),n}function IZ(e){const n=[];let t=-1;for(;++t<e.length;)n.push(e[t].replace(AZ,"\\$&"));return new RegExp("(?:"+n.join("|")+")","g")}const MZ=/[\dA-Fa-f]/;function RZ(e,n,t){const r="&#x"+e.toString(16).toUpperCase();return t&&n&&!MZ.test(String.fromCharCode(n))?r:r+";"}const LZ=/\d/;function OZ(e,n,t){const r="&#"+String(e);return t&&n&&!LZ.test(String.fromCharCode(n))?r:r+";"}const FZ=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],F0={nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",fnof:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",bull:"",hellip:"",prime:"",Prime:"",oline:"",frasl:"",weierp:"",image:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",quot:'"',amp:"&",lt:"<",gt:">",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",permil:"",lsaquo:"",rsaquo:"",euro:""},$Z=["cent","copy","divide","gt","lt","not","para","times"],fT={}.hasOwnProperty,L1={};let Mx;for(Mx in F0)fT.call(F0,Mx)&&(L1[F0[Mx]]=Mx);const zZ=/[^\dA-Za-z]/;function BZ(e,n,t,r){const a=String.fromCharCode(e);if(fT.call(L1,a)){const l=L1[a],o="&"+l;return t&&FZ.includes(l)&&!$Z.includes(l)&&(!r||n&&n!==61&&zZ.test(String.fromCharCode(n)))?o:o+";"}return""}function UZ(e,n,t){let r=RZ(e,n,t.omitOptionalSemicolons),a;if((t.useNamedReferences||t.useShortestReferences)&&(a=BZ(e,n,t.omitOptionalSemicolons,t.attribute)),(t.useShortestReferences||!a)&&t.useShortestReferences){const l=OZ(e,n,t.omitOptionalSemicolons);l.length<r.length&&(r=l)}return a&&(!t.useShortestReferences||a.length<r.length)?a:r}function Oh(e,n){return DZ(e,Object.assign({format:UZ},n))}const qZ=/^>|^->|<!--|-->|--!>|<!-$/g,VZ=[">"],HZ=["<",">"];function GZ(e,n,t,r){return r.settings.bogusComments?"<?"+Oh(e.value,Object.assign({},r.settings.characterReferences,{subset:VZ}))+">":"<!--"+e.value.replace(qZ,a)+"-->";function a(l){return Oh(l,Object.assign({},r.settings.characterReferences,{subset:HZ}))}}function YZ(e,n,t,r){return"<!"+(r.settings.upperDoctype?"DOCTYPE":"doctype")+(r.settings.tightDoctype?"":" ")+"html>"}function HC(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function WZ(e,n){const t=n||{};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}function QZ(e){return e.join(" ").trim()}const JZ=/[ \t\n\f\r]/g;function Ww(e){return typeof e=="object"?e.type==="text"?GC(e.value):!1:GC(e)}function GC(e){return e.replace(JZ,"")===""}const Qi=pT(1),hT=pT(-1),KZ=[];function pT(e){return n;function n(t,r,a){const l=t?t.children:KZ;let o=(r||0)+e,f=l[o];if(!a)for(;f&&Ww(f);)o+=e,f=l[o];return f}}const XZ={}.hasOwnProperty;function mT(e){return n;function n(t,r,a){return XZ.call(e,t.tagName)&&e[t.tagName](t,r,a)}}const Qw=mT({body:eee,caption:$0,colgroup:$0,dd:ree,dt:iee,head:$0,html:ZZ,li:nee,optgroup:aee,option:see,p:tee,rp:YC,rt:YC,tbody:oee,td:WC,tfoot:cee,th:WC,thead:lee,tr:uee});function $0(e,n,t){const r=Qi(t,n,!0);return!r||r.type!=="comment"&&!(r.type==="text"&&Ww(r.value.charAt(0)))}function ZZ(e,n,t){const r=Qi(t,n);return!r||r.type!=="comment"}function eee(e,n,t){const r=Qi(t,n);return!r||r.type!=="comment"}function tee(e,n,t){const r=Qi(t,n);return r?r.type==="element"&&(r.tagName==="address"||r.tagName==="article"||r.tagName==="aside"||r.tagName==="blockquote"||r.tagName==="details"||r.tagName==="div"||r.tagName==="dl"||r.tagName==="fieldset"||r.tagName==="figcaption"||r.tagName==="figure"||r.tagName==="footer"||r.tagName==="form"||r.tagName==="h1"||r.tagName==="h2"||r.tagName==="h3"||r.tagName==="h4"||r.tagName==="h5"||r.tagName==="h6"||r.tagName==="header"||r.tagName==="hgroup"||r.tagName==="hr"||r.tagName==="main"||r.tagName==="menu"||r.tagName==="nav"||r.tagName==="ol"||r.tagName==="p"||r.tagName==="pre"||r.tagName==="section"||r.tagName==="table"||r.tagName==="ul"):!t||!(t.type==="element"&&(t.tagName==="a"||t.tagName==="audio"||t.tagName==="del"||t.tagName==="ins"||t.tagName==="map"||t.tagName==="noscript"||t.tagName==="video"))}function nee(e,n,t){const r=Qi(t,n);return!r||r.type==="element"&&r.tagName==="li"}function iee(e,n,t){const r=Qi(t,n);return!!(r&&r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd"))}function ree(e,n,t){const r=Qi(t,n);return!r||r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd")}function YC(e,n,t){const r=Qi(t,n);return!r||r.type==="element"&&(r.tagName==="rp"||r.tagName==="rt")}function aee(e,n,t){const r=Qi(t,n);return!r||r.type==="element"&&r.tagName==="optgroup"}function see(e,n,t){const r=Qi(t,n);return!r||r.type==="element"&&(r.tagName==="option"||r.tagName==="optgroup")}function lee(e,n,t){const r=Qi(t,n);return!!(r&&r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot"))}function oee(e,n,t){const r=Qi(t,n);return!r||r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot")}function cee(e,n,t){return!Qi(t,n)}function uee(e,n,t){const r=Qi(t,n);return!r||r.type==="element"&&r.tagName==="tr"}function WC(e,n,t){const r=Qi(t,n);return!r||r.type==="element"&&(r.tagName==="td"||r.tagName==="th")}const dee=mT({body:pee,colgroup:mee,head:hee,html:fee,tbody:gee});function fee(e){const n=Qi(e,-1);return!n||n.type!=="comment"}function hee(e){const n=new Set;for(const r of e.children)if(r.type==="element"&&(r.tagName==="base"||r.tagName==="title")){if(n.has(r.tagName))return!1;n.add(r.tagName)}const t=e.children[0];return!t||t.type==="element"}function pee(e){const n=Qi(e,-1,!0);return!n||n.type!=="comment"&&!(n.type==="text"&&Ww(n.value.charAt(0)))&&!(n.type==="element"&&(n.tagName==="meta"||n.tagName==="link"||n.tagName==="script"||n.tagName==="style"||n.tagName==="template"))}function mee(e,n,t){const r=hT(t,n),a=Qi(e,-1,!0);return t&&r&&r.type==="element"&&r.tagName==="colgroup"&&Qw(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="col")}function gee(e,n,t){const r=hT(t,n),a=Qi(e,-1);return t&&r&&r.type==="element"&&(r.tagName==="thead"||r.tagName==="tbody")&&Qw(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="tr")}const Rx={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function yee(e,n,t,r){const a=r.schema,l=a.space==="svg"?!1:r.settings.omitOptionalTags;let o=a.space==="svg"?r.settings.closeEmptyElements:r.settings.voids.includes(e.tagName.toLowerCase());const f=[];let u;a.space==="html"&&e.tagName==="svg"&&(r.schema=dT);const d=xee(r,e.properties),h=r.all(a.space==="html"&&e.tagName==="template"?e.content:e);return r.schema=a,h&&(o=!1),(d||!l||!dee(e,n,t))&&(f.push("<",e.tagName,d?" "+d:""),o&&(a.space==="svg"||r.settings.closeSelfClosing)&&(u=d.charAt(d.length-1),(!r.settings.tightSelfClosing||u==="/"||u&&u!=='"'&&u!=="'")&&f.push(" "),f.push("/")),f.push(">")),f.push(h),!o&&(!l||!Qw(e,n,t))&&f.push("</"+e.tagName+">"),f.join("")}function xee(e,n){const t=[];let r=-1,a;if(n){for(a in n)if(n[a]!==null&&n[a]!==void 0){const l=bee(e,a,n[a]);l&&t.push(l)}}for(;++r<t.length;){const l=e.settings.tightAttributes?t[r].charAt(t[r].length-1):void 0;r!==t.length-1&&l!=='"'&&l!=="'"&&(t[r]+=" ")}return t.join("")}function bee(e,n,t){const r=SZ(e.schema,n),a=e.settings.allowParseErrors&&e.schema.space==="html"?0:1,l=e.settings.allowDangerousCharacters?0:1;let o=e.quote,f;if(r.overloadedBoolean&&(t===r.attribute||t==="")?t=!0:(r.boolean||r.overloadedBoolean)&&(typeof t!="string"||t===r.attribute||t==="")&&(t=!!t),t==null||t===!1||typeof t=="number"&&Number.isNaN(t))return"";const u=Oh(r.attribute,Object.assign({},e.settings.characterReferences,{subset:Rx.name[a][l]}));return t===!0||(t=Array.isArray(t)?(r.commaSeparated?WZ:QZ)(t,{padLeft:!e.settings.tightCommaSeparatedLists}):String(t),e.settings.collapseEmptyAttributes&&!t)?u:(e.settings.preferUnquoted&&(f=Oh(t,Object.assign({},e.settings.characterReferences,{attribute:!0,subset:Rx.unquoted[a][l]}))),f!==t&&(e.settings.quoteSmart&&HC(t,o)>HC(t,e.alternative)&&(o=e.alternative),f=o+Oh(t,Object.assign({},e.settings.characterReferences,{subset:(o==="'"?Rx.single:Rx.double)[a][l],attribute:!0}))+o),u+(f&&"="+f))}const vee=["<","&"];function gT(e,n,t,r){return t&&t.type==="element"&&(t.tagName==="script"||t.tagName==="style")?e.value:Oh(e.value,Object.assign({},r.settings.characterReferences,{subset:vee}))}function wee(e,n,t,r){return r.settings.allowDangerousHtml?e.value:gT(e,n,t,r)}function Nee(e,n,t,r){return r.all(e)}const See=AE("type",{invalid:jee,unknown:Cee,handlers:{comment:GZ,doctype:YZ,element:yee,raw:wee,root:Nee,text:gT}});function jee(e){throw new Error("Expected node, not `"+e+"`")}function Cee(e){const n=e;throw new Error("Cannot compile unknown node `"+n.type+"`")}const _ee={},kee={},Eee=[];function Tee(e,n){const t=n||_ee,r=t.quote||'"',a=r==='"'?"'":'"';if(r!=='"'&&r!=="'")throw new Error("Invalid quote `"+r+"`, expected `'` or `\"`");return{one:Aee,all:Dee,settings:{omitOptionalTags:t.omitOptionalTags||!1,allowParseErrors:t.allowParseErrors||!1,allowDangerousCharacters:t.allowDangerousCharacters||!1,quoteSmart:t.quoteSmart||!1,preferUnquoted:t.preferUnquoted||!1,tightAttributes:t.tightAttributes||!1,upperDoctype:t.upperDoctype||!1,tightDoctype:t.tightDoctype||!1,bogusComments:t.bogusComments||!1,tightCommaSeparatedLists:t.tightCommaSeparatedLists||!1,tightSelfClosing:t.tightSelfClosing||!1,collapseEmptyAttributes:t.collapseEmptyAttributes||!1,allowDangerousHtml:t.allowDangerousHtml||!1,voids:t.voids||yZ,characterReferences:t.characterReferences||kee,closeSelfClosing:t.closeSelfClosing||!1,closeEmptyElements:t.closeEmptyElements||!1},schema:t.space==="svg"?dT:_Z,quote:r,alternative:a}.one(Array.isArray(e)?{type:"root",children:e}:e,void 0,void 0)}function Aee(e,n,t){return See(e,n,t,this)}function Dee(e){const n=[],t=e&&e.children||Eee;let r=-1;for(;++r<t.length;)n[r]=this.one(t[r],r,e);return n.join("")}const Pee={};function Iee(e){const n=this,{handlers:t,sanitize:r,...a}=e||Pee;let l=!1,o;typeof r=="boolean"?l=!r:r&&(o=r),n.compiler=f;function f(u,d){const h=gZ(u,{handlers:t,allowDangerousHtml:l}),g=l?h:_X(h,o),b=Tee(g,{...a,allowDangerousHtml:l});return d.extname&&(d.extname=".html"),u&&u.type==="root"&&b&&/[^\r\n]/.test(b.charAt(b.length-1))?b+`
`:b}}const Mee=()=>{var Ct,an,ui;const{recordId:e}=Rr(),n=wt(),t=gr(),[r,a]=w.useState(""),[l]=w.useState([]),[o,f]=w.useState(null),[u,d]=w.useState(null),[h,g]=w.useState(void 0),[b,v]=w.useState(void 0),[S,k]=w.useState(null),[T,E]=w.useState(!1),[P,I]=w.useState(""),[V,F]=w.useState(!1),[O,B]=w.useState(null),[U,z]=w.useState(null),[$,R]=w.useState(!1),[H,ee]=w.useState(!1),[Z,te]=w.useState(null),[Q,q]=w.useState(""),[W,ne]=w.useState(""),[A,ie]=w.useState(null),[se,M]=w.useState(!1),[ce,ve]=w.useState(!1),[le,xe]=w.useState(null),[ue,ze]=w.useState(!1),[tt,ft]=w.useState(null),[Re,je]=w.useState(window.innerHeight),[he,Ae]=w.useState([]),[we,Me]=w.useState(!1),[De,Je]=w.useState(null),[nt,Ge]=w.useState([]),[St,It]=w.useState([]),[Vt,oe]=w.useState(!1),[J,de]=w.useState(null),Be=w.useRef(null),be=w.useRef(null),Fe=w.useRef(!1),$e=w.useRef(null),st=w.useRef(null),[rt,Le]=w.useState(33.33),[Ve,qe]=w.useState(!1),Ke=w.useRef(null),We=w.useRef(null),zt=150,[_t,rn]=w.useState([]),[Ot,Yn]=w.useState([]),[Wn,Ei]=w.useState(!1),[Ti,wn]=w.useState(null),[Bn,Ji]=w.useState(!1),[li,Ln]=w.useState(null),[oi,Si]=w.useState(!1),[Hi,Yo]=w.useState(null),[Qr,Qd]=w.useState(!1),[gs,du]=w.useState(null),[Ks,Xs]=w.useState(!1),[qa,Zs]=w.useState(null),[ji,Jd]=w.useState(!1),[Wo,ys]=w.useState(null),[Va,ar]=w.useState([]),[el,Ha]=w.useState(!1),[Kd,Ql]=w.useState(null),[tl,yr]=w.useState(!1),[Jl,Qo]=w.useState(null),[va,fu]=w.useState({}),[hu,Xd]=w.useState(!1),[pu,Ki]=w.useState(!1),[mu,Jo]=w.useState(!1),[Kl,gu]=w.useState(null),[Jr,yu]=w.useState(!1),[Gi,Xl]=w.useState(!1),[nl,il]=w.useState(!1),[wa,Ko]=w.useState(!1),[xs,Na]=w.useState(!1),[Sa,rl]=w.useState(!1),al=w.useMemo(()=>(u==null?void 0:u.admission_date)&&!(u!=null&&u.discharge_date),[u]),[Xo,Zl]=w.useState(!1),[Zo,bs]=w.useState(""),[sl,eo]=w.useState(void 0),[Ga,Ya]=w.useState(void 0),[to,no]=w.useState(void 0),[Kr,vs]=w.useState(!1),[Xr,Or]=w.useState(null),[ja,Wa]=w.useState(!1),ll=w.useRef(null),[io,ec]=w.useState(null),[xn,bn]=w.useState(null),ro=w.useRef(null),[Xi]=w.useState("Loading..."),[ws,ol]=w.useState(!1),[Ns,Zd]=w.useState(!1),[mn,ao]=w.useState(null),[Un,Qa]=w.useState(""),[xr,cl]=w.useState(""),[xu,sr]=w.useState(!0),[Ca,bu]=w.useState(!1),[tc,so]=w.useState(!1),[Ss,vu]=w.useState(!1),[ci,nc]=w.useState([]),Zi=w.useRef(null),ul=async ae=>{try{const ge=await fe(`/api/patients/${ae}`);if(!ge.ok){const _e=await ge.json().catch(()=>({}));throw new Error(_e.message||`Failed to fetch patient details: ${ge.status}`)}const pe=await ge.json();if(d(pe),g(pe.age),v(pe.gender),q(pe.ai_response||""),d(_e=>_e?{..._e,current_status:pe.current_status,admission_date:pe.admission_date,discharge_date:pe.discharge_date}:{...pe,current_status:pe.current_status,admission_date:pe.admission_date,discharge_date:pe.discharge_date}),pe.insurance_type&&d(_e=>_e?{..._e,insurance_type:pe.insurance_type}:{...pe}),ic(ae),pe.ai_response){const _e=/```json\s*([\s\S]*?)\s*```/,at=pe.ai_response.match(_e);if(at&&at[1])ne(pe.ai_response.replace(_e,"").trim()),ie(at[1].trim());else{const gt=pe.ai_response.trim();if(gt.startsWith("{")&&gt.endsWith("}"))try{JSON.parse(gt),ne(""),ie(gt)}catch{ne(gt),ie(null)}else if(gt.startsWith("[")&&gt.endsWith("]"))try{JSON.parse(gt),ne(""),ie(gt)}catch{ne(gt),ie(null)}else ne(gt),ie(null)}}else ne(""),ie(null)}catch{d(null),q(""),ne(""),ie(null)}},ef=async(ae,ge)=>{d(pe=>pe?{...pe,insurance_type:ge}:null);try{const pe=await fe(`/api/patients/${ae}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:ge})});if(!pe.ok){const _e=await pe.json();throw new Error(_e.message||"Failed to update insurance type")}}catch(pe){console.error("Error updating insurance type:",pe),ae&&ul(ae)}},Fr=async ae=>{oe(!0),de(null),It([]);try{const ge=await fe(`/api/queue/patient/${ae}/complaints`);if(!ge.ok){const _e=await ge.json().catch(()=>({}));throw new Error(_e.message||`HTTP error! status: ${ge.status}`)}const pe=await ge.json();It(pe||[])}catch(ge){de(`Past complaints error: ${ge.message}`)}finally{oe(!1)}},Ja=async ae=>{Ge([]);try{const ge=await fe(`/api/pharmacy-orders/patient/${ae}`);if(!ge.ok){const _e=await ge.json().catch(()=>({}));throw new Error(_e.message||`HTTP error! status: ${ge.status}`)}const pe=await ge.json();Ge(pe||[])}catch{}},dl=async ae=>{Ha(!0),Ql(null),ar([]);try{const ge=await fe(`/api/lab/orders/patient/${ae}`);if(!ge.ok){const _e=await ge.json().catch(()=>({}));throw new Error(_e.message||`HTTP error! status: ${ge.status}`)}const pe=await ge.json();ar(pe||[])}catch(ge){Ql(`Pending labs error: ${ge.message}`)}finally{Ha(!1)}},Dn=async ae=>{Me(!0),Je(null),Ae([]);try{const ge=await fe(`/api/lab/patient/${ae}`);if(!ge.ok){const _e=await ge.json().catch(()=>({}));throw new Error(_e.message||`HTTP error! status: ${ge.status}`)}const pe=await ge.json();Ae(pe||[])}catch(ge){Je(`Lab reports error: ${ge.message}`)}finally{Me(!1)}},$r=async ae=>{try{const ge=await fe(`/api/recurring-medications?patientId=${ae}`);if(!ge.ok){const _e=await ge.json().catch(()=>({}));throw new Error(_e.message||`Failed to fetch recurring medications: ${ge.status}`)}const pe=await ge.json();nc(pe.recurringMedications||[])}catch(ge){console.error("Error fetching recurring medications:",ge)}},wu=async ae=>{R(!0),oe(!0),Ha(!0),Me(!0),Ge([]);try{const ge=await fe(`/api/patients/${ae}/context`);if(!ge.ok){const at=await ge.json().catch(()=>({}));throw new Error(at.message||`Failed to fetch patient context: ${ge.status}`)}const pe=await ge.json(),_e=pe.patient;if(d(_e),g(_e.age),v(_e.gender),q(_e.ai_response||""),ic(ae),_e.ai_response){const at=/```json\s*([\s\S]*?)\s*```/,gt=_e.ai_response.match(at);if(gt&&gt[1])ne(_e.ai_response.replace(at,"").trim()),ie(gt[1].trim());else{const yt=_e.ai_response.trim();if(yt.startsWith("{")&&yt.endsWith("}"))try{JSON.parse(yt),ne(""),ie(yt)}catch{ne(yt),ie(null)}else if(yt.startsWith("[")&&yt.endsWith("]"))try{JSON.parse(yt),ne(""),ie(yt)}catch{ne(yt),ie(null)}else ne(yt),ie(null)}}else ne(""),ie(null);It(pe.pastComplaints||[]),Ge(pe.pharmacyOrders||[]),ar(pe.labOrders||[]),Ae(pe.labReports||[]),nc(pe.recurringMedications||[])}catch(ge){console.error("Error fetching patient context:",ge),te(ge.message),d(null),q(""),ne(""),ie(null),It([]),Ge([]),ar([]),Ae([]),nc([])}finally{R(!1),oe(!1),Ha(!1),Me(!1)}},ic=async ae=>{try{const ge=await fe(`/api/queue/patient/${ae}/latest`);if(!ge.ok){const _e=await ge.json().catch(()=>({}));throw new Error(_e.message||`Failed to fetch queue status: ${ge.status}`)}const pe=await ge.json();if(pe){const _e=new Date(pe.createdAt),at=new Date,gt=_e.getDate()===at.getDate()&&_e.getMonth()===at.getMonth()&&_e.getFullYear()===at.getFullYear(),yt=["waiting","consulting"].includes(pe.status);rl(gt&&yt)}else rl(!1)}catch(ge){console.error("Error checking patient queue status:",ge),rl(!1)}},Nu=ae=>{n(`/dashboard/edit-pharmacy-order/${ae}`)},ip=ae=>{te(null),console.log(`Preparing billing navigation for order: ${ae}`);const ge=nt.find(pe=>pe.id===ae);if(ge){const pe=ge.medications.map(_e=>{const at=_e.price??0;return(_e.price===void 0||_e.price===null)&&console.warn(`Medication "${_e.name}" in order ${ae} is missing a price. Defaulting to 0.`),{name:_e.name,pack_quantity:_e.pack_quantity,loose_quantity:_e.loose_quantity,price:at,pack_price:_e.pack_price,loose_price:_e.loose_price,total_price:Number(_e.total_price)||0,isLoose:_e.isLoose,unit:_e.unit,drug_id:_e.drug_id?String(_e.drug_id):null,tabletsPerDay:_e.tabletsPerDay,numberOfDays:_e.numberOfDays,directions_to_use:_e.directions_to_use,discount_percentage:_e.discount_percentage??0,batch:_e.batch,expiry_date:_e.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:pe}),n(`/dashboard/pharmacy-billing/${ae}`,{state:{initialItems:pe}})}else console.error(`Order with ID ${ae} not found.`),te(`Order with ID ${ae} not found.`),alert(`Error: Could not find order ${ae} to bill.`)},rp=async(ae,ge)=>{te(null);const pe=nt.find(at=>at.id===ae);if(!pe){te(`Order with ID ${ae} not found.`);return}const _e={status:ge,medications:pe.medications};try{const at=await fe(`/api/pharmacy-orders/${ae}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(_e)});if(!at.ok){const yt=await at.text();throw new Error(`Failed to update status: ${at.statusText} (${at.status}) - ${yt}`)}const gt=await at.json();Ge(yt=>yt.map(pt=>pt.id===gt.id?gt:pt)),o&&Ja(o)}catch(at){console.error("Failed to update order status:",at),te(at.message||`Failed to update status for order ${ae}.`),alert(`Error updating status for order ${ae}: ${at.message||"Please try again."}`)}},ap=async ae=>{te(null);try{const ge=await fe(`/api/pharmacy-orders/${ae}/recurring`,{method:"POST"});if(!ge.ok){const pe=await ge.json().catch(()=>({}));throw new Error(pe.message||"Failed to mark order as recurring")}alert("Order marked as recurring successfully!"),o&&$r(o)}catch(ge){console.error("Failed to mark order as recurring:",ge),te(ge.message||`Failed to mark order ${ae} as recurring.`),alert(`Error: ${ge.message||"Please try again."}`)}},tf=ae=>{gu(ae),Jo(!0)},rc=async ae=>{if(window.confirm("Are you sure you want to delete this recurring medication?"))try{if(!(await fe(`/api/recurring-medications/${ae}`,{method:"DELETE"})).ok)throw new Error("Failed to delete recurring medication");nc(pe=>pe.filter(_e=>_e.id!==ae))}catch(ge){console.error("Error deleting recurring medication:",ge),alert("Failed to delete. Please try again.")}},fl=ae=>{ar(ge=>ge.map(pe=>pe.id===ae?{...pe,isEditing:!0,editedTests:[...pe.tests],editedStatus:pe.status}:{...pe,isEditing:!1}))},Su=ae=>{ar(ge=>ge.map(pe=>pe.id===ae?{...pe,isEditing:!1,editedTests:void 0,editedStatus:void 0}:pe))},hl=(ae,ge,pe,_e)=>{ar(at=>at.map(gt=>{if(gt.id===ae){const yt=gt.editedTests?[...gt.editedTests]:[...gt.tests];if(pe==="add")return{...gt,editedTests:[...yt,{id:"",name:"",price:0}]};if(pe==="remove")return{...gt,editedTests:_e};if(ge!==-1){const pt={...yt[ge],[pe]:_e};return yt[ge]=pt,{...gt,editedTests:yt}}}return gt}))},nf=(ae,ge)=>{ar(pe=>pe.map(_e=>_e.id===ae?{..._e,editedStatus:ge}:_e))},ac=ae=>{if(!ae||!ae.id){console.error("Cannot navigate to billing: Lab Order data or ID is missing."),alert("Could not open billing page: Lab Order information is missing.");return}n("/lab-billing",{state:{labOrderId:ae.id}})},lo=ae=>{ae&&ae.id?n(`/lab/report/${ae.id}`):(console.error("Cannot navigate: Lab Order or Lab Order ID is missing."),alert("Could not open the lab report page: Lab Order information is missing."))},ju=async(ae,ge,pe)=>{yu(!0),te(null);try{if(!ge||ge.length===0)throw new Error("Lab order must have at least one test.");for(const gt of ge)if(!gt.id||!gt.name||isNaN(gt.price)||gt.price<0)throw new Error(`Invalid test data: ${JSON.stringify(gt)}. Each test must have id, name, and a valid price.`);const _e={tests:ge,status:pe},at=await fe(`/api/lab/orders/${ae}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(_e)});if(!at.ok){const gt=await at.json().catch(()=>({}));throw new Error(gt.message||`Failed to update lab order: ${at.statusText}`)}o&&dl(o),ar(gt=>gt.map(yt=>yt.id===ae?{...yt,isEditing:!1,editedTests:void 0,editedStatus:void 0}:yt))}catch(_e){te(`Lab Order Save Error: ${_e.message}`)}finally{yu(!1)}},oo=async ae=>{if(!window.confirm(`Are you sure you want to delete this ${ae.type.toLowerCase()} record? This action cannot be undone.`))return;yr(!0),Qo(null);let pe=null,_e;const at=ae.type;try{switch(at){case"Complaint":if(_e=ae.data.id,!_e)throw new Error("Complaint ID is missing.");pe=`/api/patients/complaints/${_e}`;break;case"Lab Order":if(_e=ae.data.id,!_e)throw new Error("Lab Order ID is missing.");pe=`/api/lab/orders/${_e}`;break;case"Lab Report":if(_e=ae.data.reportId,!_e)throw new Error("Lab Report ID is missing.");pe=`/api/lab/reports/${_e}`;break;case"Pharmacy Order":if(_e=ae.data.id,!_e)throw new Error("Pharmacy Order ID is missing.");pe=`/api/pharmacy-orders/${_e}`;break;default:throw new Error(`Deletion not supported for item type: ${at}`)}if(!pe)throw new Error(`Could not determine delete URL for type: ${at}`);const gt=await fe(pe,{method:"DELETE"});if(!gt.ok){const yt=await gt.json().catch(()=>({}));throw new Error(yt.message||`Failed to delete ${at}: ${gt.statusText}`)}o&&(at==="Complaint"?Fr(o):at==="Lab Order"?(dl(o),Dn(o)):at==="Lab Report"?Dn(o):at==="Pharmacy Order"&&Ja(o))}catch(gt){Qo(`Delete Error (${at}): ${gt.message}`),tl&&yr(!1)}finally{yr(!1)}},sc=async()=>{if(!o)return;if(nt.filter(ge=>ge.status==="pending").length<2){alert("You need at least two pending orders to merge.");return}Zd(!0);try{const ge=await fe(`/api/pharmacy-orders/patient/${o}/merge-pending`,{method:"POST"});if(!ge.ok){const pe=await ge.json().catch(()=>({}));throw new Error(pe.message||"Failed to merge orders")}Ja(o)}catch(ge){te(`Merge Error: ${ge.message}`)}finally{Zd(!1)}},Yi=w.useMemo(()=>{if(!o||!St)return[];const ae=St.map(ge=>({date:new Date(ge.createdAt),type:"Complaint",data:ge,originalDateString:ge.createdAt})).filter(ge=>!isNaN(ge.date.getTime()));return ae.sort((ge,pe)=>pe.date.getTime()-ge.date.getTime()),ae},[o,St]),Ka=w.useMemo(()=>{if(!o)return[];const ae=new Map;(Va??[]).forEach(pe=>{ae.set(pe.id,{...pe})}),(he??[]).forEach(pe=>{if(!ae.has(pe.id))ae.set(pe.id,{id:pe.id,patient_id:pe.patient_id,tests:pe.tests,status:pe.status,createdAt:pe.createdAt,report:pe});else{const _e=ae.get(pe.id);_e&&(_e.report=pe,_e.status=pe.status)}});let ge=Array.from(ae.values());return ge.sort((pe,_e)=>new Date(pe.createdAt).getTime()-new Date(_e.createdAt).getTime()),ge=ge.map((pe,_e)=>({...pe,serialNumber:_e+1})),ge.map(pe=>({date:new Date(pe.createdAt),type:"Lab Order",data:pe,originalDateString:pe.createdAt}))},[o,Va,he]),Zr=w.useMemo(()=>{if(!o||!nt)return[];const ae=nt.map(ge=>({date:new Date(ge.date),type:"Pharmacy Order",data:ge,originalDateString:ge.date})).filter(ge=>!isNaN(ge.date.getTime()));return ae.sort((ge,pe)=>pe.date.getTime()-ge.date.getTime()),ae},[o,nt]),[er,co]=w.useState(null),[js,Cs]=w.useState([]),[Xa,rf]=w.useState(""),uo=(ae,ge)=>{if(!ae||!ae.report_content||!ge)return"";try{const pe=JSON.parse(ae.report_content||"{}");if(typeof pe!="object"||pe===null)return`<p class="italic text-gray-500 text-xs">Report content is not structured data.</p><pre>${ae.report_content}</pre>`;let _e="";return ge.forEach(at=>{pe[at.id]?(_e+=`<h5 class="font-semibold text-sm mt-2 mb-1">${at.name}</h5>`,_e+='<table class="lab-report-print-table"><thead><tr><th>Parameter</th><th>Value</th><th>Normal Range</th></tr></thead><tbody>',Object.entries(pe[at.id]).map(([gt,yt])=>{var sn;const pt=(sn=at.default_parameters)==null?void 0:sn.find(cr=>cr.name===gt);let Ni="N/A";pt&&pt.type==="number"&&(pt.lower_limit!=null||pt.upper_limit!=null)?(Ni="",pt.lower_limit!=null&&(Ni+=` > ${pt.lower_limit}`),pt.lower_limit!=null&&pt.upper_limit!=null&&(Ni+=" - "),pt.upper_limit!=null&&(Ni+=` < ${pt.upper_limit}`),Ni=Ni.trim()||"N/A"):(pt==null?void 0:pt.type)==="boolean"?Ni="N/A":pt!=null&&pt.normal_range&&(Ni=pt.normal_range),_e+=`<tr><td>${gt}</td><td>${String(yt)} ${(pt==null?void 0:pt.unit)||""}</td><td>${Ni}</td></tr>`}),_e+="</tbody></table>"):_e+=`<p class="italic text-gray-500 text-xs">No parameters reported for ${at.name}.</p>`}),_e}catch{return`<p class="italic text-gray-500 text-xs">Error parsing report content.</p><pre>${ae.report_content}</pre>`}};w.useEffect(()=>{const ae=()=>{je(window.innerHeight)};return window.addEventListener("resize",ae),ae(),()=>window.removeEventListener("resize",ae)},[]),w.useEffect(()=>{const ae=pe=>{if(!Ve||!We.current||!Ke.current)return;const _e=Ke.current.getBoundingClientRect(),gt=pe.clientX-We.current.x;let yt=We.current.initialWidth-gt;const pt=_e.width-zt-10;yt=Math.max(zt,yt),yt=Math.min(yt,pt);const Ni=yt/_e.width*100;Le(Ni)},ge=()=>{qe(!1),We.current=null,document.body.style.cursor="",document.body.style.userSelect=""};return Ve&&(window.addEventListener("mousemove",ae),window.addEventListener("mouseup",ge),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{window.removeEventListener("mousemove",ae),window.removeEventListener("mouseup",ge),document.body.style.cursor="",document.body.style.userSelect=""}},[Ve]);const af=ae=>{if(!Ke.current)return;ae.preventDefault();const ge=Ke.current.querySelector(".edit-complaint-context-column");ge&&(We.current={x:ae.clientX,initialWidth:ge.offsetWidth},qe(!0))},Cu=w.useCallback(async()=>{ee(!0),te(null);try{const ae=await fe("/api/queue/doctor/new",{method:"POST"});if(!ae.ok){const pe=await ae.json().catch(()=>({}));throw new Error(pe.message||`Failed to create record: ${ae.statusText}`)}const ge=await ae.json();if(!ge.recordId)throw new Error("New record ID not received from server.");n(`/edit-complaint/${ge.recordId}`,{replace:!0})}catch(ae){te(`Failed to create new complaint record: ${ae.message}`)}finally{ee(!1)}},[n]);w.useEffect(()=>{(async()=>{sr(!0);try{const ge=await fe("/api/clinics/settings");if(!ge.ok){const _e=await ge.json().catch(()=>({}));throw new Error(_e.message||"Failed to fetch clinic settings.")}const pe=await ge.json();ao({admissionCharge:parseFloat(pe.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(pe.perDayCharge||0).toFixed(2),otherCharges:parseFloat(pe.otherCharges||0).toFixed(2),aiMemory:pe.aiMemory||"",aiMemoryUpdatedAt:pe.aiMemoryUpdatedAt||null,clinicWideSystemPrompt:pe.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:pe.clinicWideSystemPromptUpdatedAt||null,gemini_api_key:pe.gemini_api_key||""}),Qa(pe.aiMemory||""),cl(pe.clinicWideSystemPrompt||"")}catch{}finally{sr(!1)}})()},[]),w.useEffect(()=>{var ge,pe;(ge=t.state)!=null&&ge.patientId&&f(Number(t.state.patientId)),(pe=t.state)!=null&&pe.initialComplaint&&a(t.state.initialComplaint),e?(async _e=>{var at;R(!0),te(null);try{const gt=await fe(`/api/queue/doctor/complaint/${_e}`);if(!gt.ok){const pt=await gt.json().catch(()=>({}));throw new Error(pt.message||`HTTP error! status: ${gt.status}`)}const yt=await gt.json();f(pt=>pt===yt.patientId?pt:yt.patientId),g(yt.age),v(yt.gender),k(yt.case_summary||null),z(yt.updatedAt||null)}catch{te("Failed to load current complaint details."),(at=t.state)!=null&&at.patientId||f(null),g(void 0),v(void 0),k(null),z(null)}finally{R(!1)}})(e):Cu()},[e,Cu,(Ct=t.state)==null?void 0:Ct.initialComplaint,(an=t.state)==null?void 0:an.patientId]),w.useEffect(()=>{o?wu(o):(d(null),It([]),Ge([]),ar([]),Ae([]),z(null),rl(!1))},[o]),w.useEffect(()=>{var pe;const ae=(pe=t.state)==null?void 0:pe.initialComplaint;ae&&e&&(!$&&!Vt&&!el&&!we&&!Wn)&&!Fe.current&&r===ae&&(Fe.current=!0,lr(),n(t.pathname,{replace:!0,state:{}}))},[(ui=t.state)==null?void 0:ui.initialComplaint,e,r,$,Vt,el,we,Wn,n]);const _u=()=>{I(S||""),E(!0),B(null)},Za=()=>{E(!1),I(""),B(null)},sf=async()=>{if(!e){B("Missing Record ID.");return}F(!0),B(null);try{const ae=await fe(`/api/queue/doctor/complaint/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:P.trim()})});if(!ae.ok){const pe=await ae.json().catch(()=>({}));throw new Error(pe.message||`Failed to save case summary: ${ae.statusText}`)}const ge=await ae.json();k(ge.case_summary||P.trim()),z(ge.updatedAt||null),E(!1)}catch(ae){B(`Save Error: ${ae.message}`)}finally{F(!1)}};w.useEffect(()=>{(async()=>{Ei(!0),wn(null);try{const[ge,pe]=await Promise.all([fe("/api/drugs"),fe("/api/lab-tests")]);if(!ge.ok)throw new Error(`Pharmacy inventory error! status: ${ge.status}`);const _e=await ge.json();if(rn(_e||[]),!pe.ok)throw new Error(`Lab inventory error! status: ${pe.status}`);const at=await pe.json();Yn(at||[])}catch(ge){wn(ge.message)}finally{Ei(!1)}})()},[]);const lf=async()=>{if(!mn)return;if(Un===mn.aiMemory&&xr===mn.clinicWideSystemPrompt){so(!1);return}const ae=Un!==mn.aiMemory,ge=xr!==mn.clinicWideSystemPrompt;ae&&bu(!0),ge&&vu(!0);try{const pe={...mn};ae&&(pe.aiMemory=Un),ge&&(pe.clinicWideSystemPrompt=xr);const _e=await fe("/api/clinics/settings",{method:"PUT",body:JSON.stringify(pe)});if(!_e.ok){const gt=await _e.json().catch(()=>({}));throw new Error(gt.message||"Failed to update clinic settings.")}const at=await _e.json();ao({admissionCharge:parseFloat(at.settings.admissionCharge).toFixed(2),perDayCharge:parseFloat(at.settings.perDayCharge).toFixed(2),otherCharges:parseFloat(at.settings.otherCharges).toFixed(2),aiMemory:at.settings.aiMemory||"",aiMemoryUpdatedAt:at.settings.aiMemoryUpdatedAt||(mn==null?void 0:mn.aiMemoryUpdatedAt)||null,clinicWideSystemPrompt:at.settings.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:at.settings.clinicWideSystemPromptUpdatedAt||(mn==null?void 0:mn.clinicWideSystemPromptUpdatedAt)||null}),ae&&Qa(at.settings.aiMemory||""),ge&&(cl(at.settings.clinicWideSystemPrompt||""),so(!1))}catch{}finally{ae&&bu(!1),ge&&vu(!1)}},lc=()=>{mn&&(cl(mn.clinicWideSystemPrompt||""),so(!0))},of=()=>{so(!1),mn&&cl(mn.clinicWideSystemPrompt||"")},lr=async ae=>{const ge=ae??r;Zi.current&&await Zi.current.callGenerativeApi(ge)},oc=ae=>{navigator.clipboard.writeText(ae).then(()=>{}).catch(ge=>{console.error("Failed to copy text: ",ge)})},ku=(ae,ge)=>{const pe=window.open("","_blank");pe&&(pe.document.write(`
        <html>
          <head>
            <title>${ge}</title>
            <style>
              body { font-family: sans-serif; margin: 20px; }
              h2 { text-align: center; margin-bottom: 20px; }
              table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
              th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
              th { background-color: #f2f2f2; }
              pre { white-space: pre-wrap; word-wrap: break-word; }
              .ai-context-section { margin-bottom: 20px; border: 1px solid #eee; padding: 15px; border-radius: 5px; }
              .ai-context-section-title { font-size: 1.1em; font-weight: bold; margin-bottom: 10px; color: #333; }
              .ai-context-text { margin-bottom: 5px; }
              .text-gray-400 { color: #999; }
              .font-semibold { font-weight: 600; }
              .italic { font-style: italic; }
              .mt-2 { margin-top: 8px; }
              .ml-1 { margin-left: 4px; }
              .ml-2 { margin-left: 8px; }
              .flex { display: flex; }
              .flex-col { flex-direction: column; }
              .w-full { width: 100%; }
              .text-xs { font-size: 0.75rem; }
              .text-sm { font-size: 0.875rem; }
              .prose { max-width: 65ch; }
              .prose table { display: table; } /* Ensure tables in markdown render correctly */
            </style>
          </head>
          <body>
            <h2>${ge}</h2>
            <div id="print-content">${ae}</div>
          </body>
        </html>
      `),pe.document.close(),pe.print())},sp=()=>{if(Q){const ae=wX().use(Oo).use(Iee).processSync(W).toString();ku(`<div class="prose">${ae}</div>`,"AI Response")}};w.useEffect(()=>{if(u){let ae=`
        <div class="print-section">
          <h3>Patient Details</h3>
          <p><strong>Name:</strong> ${u.name||"N/A"}</p>
          <p><strong>Token:</strong> ${u.patient_token_number||"N/A"}</p>
          <p><strong>Age:</strong> ${u.age||"N/A"}</p>
          <p><strong>Gender:</strong> ${u.gender||"N/A"}</p>
          <p><strong>Phone:</strong> ${u.phone||"N/A"}</p>
          <p><strong>Insurance:</strong> ${u.insurance_type||"N/A"}</p>
          <p><strong>Status:</strong> ${u.current_status||"N/A"}</p>
          <p><strong>Admitted:</strong> ${u.admission_date?new Date(u.admission_date).toLocaleDateString():"N/A"}</p>
          <p><strong>Discharged:</strong> ${u.discharge_date?new Date(u.discharge_date).toLocaleDateString():"N/A"}</p>
        </div>
        <div class="print-section">
          <h3>Case Summary</h3>
          <p>${S||"No summary available."}</p>
        </div>
        <div class="print-section">
          <h3>Complaints History</h3>
          ${Yi.length>0?`
            <ul>
              ${Yi.map(ge=>`<li>${new Date(ge.originalDateString).toLocaleDateString()}: ${ge.data.complaint}</li>`).join("")}
            </ul>
          `:"<p>No past complaints.</p>"}
        </div>
        <div class="print-section">
          <h3>Pharmacy Orders</h3>
          ${Zr.length>0?`
            <table class="print-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Status</th>
                  <th>Drug Name</th>
                  <th>Quantity</th>
                  <th>Dosage</th>
                  <th>Directions</th>
                </tr>
              </thead>
              <tbody>
                ${Zr.map(ge=>ge.data.medications.map((pe,_e)=>`
                    <tr>
                      ${_e===0?`<td rowspan="${ge.data.medications.length}">${new Date(ge.originalDateString).toLocaleDateString()}</td>`:""}
                      ${_e===0?`<td rowspan="${ge.data.medications.length}">${ge.data.status}</td>`:""}
                      <td><strong>${pe.name}</strong></td>
                      <td>
                        ${pe.pack_quantity!==void 0&&pe.pack_quantity>0?`Packs: ${pe.pack_quantity}`:""}
                        ${pe.pack_quantity!==void 0&&pe.pack_quantity>0&&pe.loose_quantity!==void 0&&pe.loose_quantity>0?", ":""}
                        ${pe.loose_quantity!==void 0&&pe.loose_quantity>0?`Loose: ${pe.loose_quantity}`:""}
                      </td>
                      <td>${pe.tabletsPerDay&&pe.numberOfDays?`${pe.tabletsPerDay} tab/day for ${pe.numberOfDays} days`:"N/A"}</td>
                      <td>${pe.directions_to_use||"N/A"}</td>
                    </tr>
                  `).join("")).join("")}
              </tbody>
            </table>
          `:"<p>No pharmacy orders.</p>"}
        </div>
        <div class="print-section">
          <h3>Lab History (Orders & Reports)</h3>
          ${Ka.length>0?`
            ${Ka.map(ge=>{const pe=ge.data.tests.map(at=>at.name).join(", ");let _e="";return ge.data.report&&(_e=`
                  <div class="lab-report-print-container">
                    <h4>Lab Report (${new Date(ge.data.report.report_date).toLocaleDateString()})</h4>
                    ${uo(ge.data.report,ge.data.report.tests)}
                  </div>
                `),`
                <div class="lab-history-item">
                  <p><strong>Order Date:</strong> ${new Date(ge.originalDateString).toLocaleDateString()}</p>
                  <p><strong>Status:</strong> ${ge.data.status}</p>
                  <p><strong>Tests:</strong> ${pe}</p>
                  ${_e}
                </div>
              `}).join("")}
          `:"<p>No lab history.</p>"}
        </div>
      `;rf(ae)}else rf("")},[u,S,Yi,Zr,Ka,uo]);const or=()=>{Xa&&ku(Xa,`Patient Details - ${u==null?void 0:u.name}`)},ea=ae=>{a(ae),co(null),Cs([]),setTimeout(()=>{lr(ae)},0)},hi=$||ce||ue||H||Kr||Jr||tl||Gi||nl||wa||xs||Ns,Eu=()=>{a("reports came,please anaylse"),setTimeout(()=>{lr()},0)},Tu=ae=>{fu(ge=>({...ge,[ae]:!ge[ae]}))},cf=ae=>{ae.key==="Enter"&&!ae.shiftKey&&(ae.preventDefault(),!hi&&!Wn&&!H&&r.trim()&&e&&lr())};w.useEffect(()=>{const ae=window.SpeechRecognition||window.webkitSpeechRecognition;if(!ae){ec("Speech recognition not supported in this browser.");return}const ge=new ae;return ge.continuous=!0,ge.interimResults=!0,ge.lang="en-US",ge.onresult=pe=>{let _e="";for(let at=pe.resultIndex;at<pe.results.length;++at)pe.results[at].isFinal&&(_e+=pe.results[at][0].transcript);_e&&a(at=>at+(at.endsWith(" ")||at===""?"":" ")+_e)},ge.onerror=pe=>{ec(`Speech error: ${pe.error}`),Wa(!1)},ge.onend=()=>{},ll.current=ge,()=>{ll.current&&ll.current.stop()}},[]);const Au=async()=>{if(o)if(al){il(!0);try{const ae=await fe(`/api/patients/${o}/discharge`,{method:"POST"});if(!ae.ok){const ge=await ae.json().catch(()=>({}));throw new Error(ge.message||`Failed to discharge patient: ${ae.status}`)}ul(o)}catch(ae){te(`Discharge Error: ${ae.message}`)}finally{il(!1)}}else{Xl(!0);try{const ae=await fe(`/api/patients/${o}/admit`,{method:"POST"});if(!ae.ok){const ge=await ae.json().catch(()=>({}));throw new Error(ge.message||`Failed to admit patient: ${ae.status}`)}ul(o)}catch(ae){te(`Admit Error: ${ae.message}`)}finally{Xl(!1)}}},lp=async ae=>{if(o){Ko(!0);try{const pe=await fe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:o})});if(!pe.ok){const _e=await pe.json().catch(()=>({}));throw new Error(_e.message||`Failed to add patient to ${ae} queue: ${pe.status}`)}alert(`Patient added to ${ae} queue successfully!`),o&&(ul(o),ic(o))}catch(ge){te(`Add to Queue Error: ${ge.message}`)}finally{Ko(!1)}}},pl=async()=>{if(e){Na(!0),te(null);try{const ae=await fe(`/api/queue/${e}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"seen"})});if(!ae.ok){const ge=await ae.json().catch(()=>({}));throw new Error(ge.message||"Failed to complete consultation")}alert("Consultation completed successfully!"),o&&(ul(o),ic(o))}catch(ae){te(`Error completing consultation: ${ae.message}`)}finally{Na(!1)}}},es=async()=>{if(!o){Or("Missing Patient ID.");return}if(!u){Or("Patient details not loaded.");return}vs(!0),Or(null);try{const ae={};let ge=!1;if(Zo!==u.name&&(ae.name=Zo,ge=!0),sl!==u.age&&(ae.age=sl,ge=!0),Ga!==u.gender&&(ae.gender=Ga,ge=!0),to!==u.phone&&(ae.phone=to,ge=!0),!ge){Or("No changes detected."),vs(!1),Zl(!1);return}const pe=await fe(`/api/patients/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ae)});if(!pe.ok){const at=await pe.json().catch(()=>({}));throw new Error(at.message||`Failed to update patient details: ${pe.statusText}`)}const _e=await pe.json();d(_e),g(_e.age),v(_e.gender),bs(_e.name),eo(_e.age),Ya(_e.gender),no(_e.phone),Zl(!1)}catch(ae){Or(`Save Error: ${ae.message}`)}finally{vs(!1)}},Ce=w.useCallback(()=>{if(!u)return null;const ae={token_number:u.patient_token_number||"N/A",name:u.name||"N/A",age:u.age||"N/A",gender:u.gender||"N/A",phone:u.phone||"N/A"};return Yi.length>0?ae.complaints_history=Yi.map(ge=>`${ge.data.complaint} (${new Date(ge.originalDateString).toLocaleDateString()})`).join("; "):ae.complaints_history="No past complaints.",Zr.length>0?ae.pharmacy_orders_history=Zr.map(ge=>`Order: ${ge.data.medications.map(_e=>{let at=`${_e.name}`;return _e.pack_quantity!==void 0&&_e.pack_quantity>0&&(at+=` Packs: ${_e.pack_quantity}`),_e.loose_quantity!==void 0&&_e.loose_quantity>0&&(at+=` Loose: ${_e.loose_quantity}`),at}).join(", ")} (${ge.data.status}, ${new Date(ge.originalDateString).toLocaleDateString()})`).join("; "):ae.pharmacy_orders_history="No pharmacy orders.",Ka.length>0?ae.lab_orders_history=Ka.map(ge=>{let _e=`Lab Order: ${ge.data.tests.map(at=>at.name).join(", ")} (${ge.data.status}, ${new Date(ge.originalDateString).toLocaleDateString()})`;return ge.data.report&&(_e+=` - Report: ${ge.data.report.report_content} (${new Date(ge.data.report.report_date).toLocaleDateString()})`),_e}).join("; "):ae.lab_orders_history="No lab history.",ci&&ci.length>0?ae.recurring_medications=ci.map(ge=>`${ge.medications.map(_e=>_e.name).join(", ")} (Freq: ${ge.frequency_days}d, Next: ${new Date(ge.next_delivery_date).toLocaleDateString()})`).join("; "):ae.recurring_medications="No recurring medications.",ae},[u,Yi,Zr,Ka,ci]),He=()=>{if(!u){ec("Patient details are required to use the Live API.");return}ol(!0)},Ue=()=>{var ae;(ae=ro.current)==null||ae.click()},dt=ae=>{var pe;const ge=(pe=ae.target.files)==null?void 0:pe[0];ge&&bn(ge)};return i.jsxs("div",{className:"edit-complaint-page",style:{height:`${Re}px`},children:[i.jsx(zW,{ref:Zi,recordId:e,patientId:o,patientDetails:u,caseSummary:S,caseSummaryUpdatedAt:U,clinicSettings:mn,userMessages:l,selectedImageFile:xn,pendingLabOrders:Va,labReports:he,pastComplaints:St,recurringMedications:ci,pharmacyOrders:nt,pharmacyInventory:_t,labInventory:Ot,setCurrentComplaint:a,setAiResponse:q,setAiResponseText:ne,setAiResponseJsonString:ie,setShowAiJsonDetails:M,setIsLoadingAi:ve,setAiError:xe,setIsSubmittingAiOrder:Ji,setAiOrderSubmissionStatus:Ln,setIsSubmittingAiLabOrder:Si,setAiLabOrderSubmissionStatus:Yo,setIsSubmittingAiComplaint:Qd,setAiComplaintSubmissionStatus:du,setIsUpdatingCaseSummary:Xs,setAiCaseSummaryUpdateStatus:Zs,setCaseSummary:k,setCaseSummaryUpdatedAt:z,setIsUpdatingAiMemoryByAI:Jd,setAiMemoryUpdateByAIStatus:ys,setFollowUpQuestion:co,setFollowUpOptions:Cs,setError:te,setIsSavingAiResponse:ze,setSaveAiResponseError:ft,fetchPharmacyOrdersData:Ja,fetchPendingLabOrdersData:dl,fetchLabReportsData:Dn,fetchPastComplaintsData:Fr,fetchRecurringMedicationsData:$r,fetchPatientDetails:ul,setClinicSettings:ao,setEditedAiMemory:Qa,handleDeleteItem:oo}),ws&&u&&i.jsx(ak,{onClose:()=>ol(!1),patientData:Ce(),tokenNumber:u.patient_token_number?String(u.patient_token_number):null,onAiSummaryChange:ae=>{ae&&(a(ae),lr(ae),ol(!1))}}),i.jsxs("div",{className:"edit-complaint-header",children:[i.jsx("button",{onClick:()=>n(-1),disabled:hi,className:"back-button",title:"Go Back",children:i.jsx(Ht,{size:18})}),i.jsx("span",{ref:st,style:{position:"absolute",visibility:"hidden",height:"auto",width:"auto",whiteSpace:"nowrap"}}),$&&!u&&i.jsx("div",{className:"edit-complaint-patient-details skeleton",style:{width:"300px",height:"2.5rem"}}),u&&i.jsx("div",{className:"edit-complaint-patient-details",children:u&&!Xo?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>{Zl(!0),bs(u.name||""),eo(u.age),Ya(u.gender),no(u.phone),Or(null)},className:"edit-button mr-2",title:"Edit Patient Details",disabled:Kr,children:i.jsx(Qc,{size:14})}),u.name??"N/A",u.patient_token_number!==null&&u.patient_token_number!==void 0&&` (${u.patient_token_number})`," - ",u.age??"N/A"," / ",u.gender??"N/A",u.phone&&` / ${u.phone}`]}):u&&Xo?i.jsxs("div",{className:"patient-details-edit-form",children:[i.jsx("input",{type:"text",value:Zo,onChange:ae=>bs(ae.target.value),placeholder:"Name",className:"edit-input",disabled:Kr}),i.jsx("input",{type:"number",value:sl??"",onChange:ae=>eo(ae.target.value?parseInt(ae.target.value):null),placeholder:"Age",className:"edit-input",disabled:Kr}),i.jsxs("select",{value:Ga??"",onChange:ae=>Ya(ae.target.value||null),className:"edit-input",disabled:Kr,children:[i.jsx("option",{value:"",children:"Select Gender"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]}),i.jsx("input",{type:"text",value:to??"",onChange:ae=>no(ae.target.value||null),placeholder:"Phone Number",className:"edit-input",disabled:Kr}),i.jsxs("div",{className:"edit-actions",children:[i.jsx("button",{onClick:()=>{Zl(!1),Or(null)},className:"button-secondary",disabled:Kr,children:"Cancel"}),i.jsx("button",{onClick:es,className:"button-primary blue",disabled:Kr,children:Kr?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),"Saving..."]}):"Save"})]}),Xr&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:Xr})]}):i.jsxs("div",{className:"edit-complaint-patient-details",children:[h??"N/A"," / ",b??"N/A"]})}),!u&&h!==void 0&&b!==void 0&&i.jsxs("div",{className:"edit-complaint-patient-details",children:[h??"N/A"," / ",b??"N/A"]}),i.jsx("div",{style:{width:"64px"}})]}),i.jsxs("div",{className:"edit-complaint-content-area",ref:Ke,children:[i.jsxs("div",{className:"edit-complaint-main-column",style:{flexBasis:`calc(${100-rt}% - 5px)`},children:[Z&&i.jsxs("div",{className:"general-error-message",children:["Error: ",Z]}),H&&i.jsx("div",{className:"ai-function-status info text-center",children:"Creating record..."}),ce&&i.jsxs("div",{className:"loading-animation-container",children:[i.jsx("div",{className:"spinner"}),i.jsx("div",{className:"loading-text loading-dots",children:Xi})]}),le&&i.jsx("div",{className:"ai-error-message",children:le}),li&&i.jsxs("div",{className:`ai-function-status ${li.toLowerCase().includes("error:")?"error":li.toLowerCase().startsWith("order created")||li.toLowerCase().startsWith("success:")?"success":"info"}`,children:[Bn&&i.jsx("span",{className:"animate-spin",role:"status"}),li]}),Hi&&i.jsxs("div",{className:`ai-function-status ${Hi.toLowerCase().includes("error:")?"error":Hi.toLowerCase().startsWith("success:")||Hi.toLowerCase().startsWith("lab order created")?"success":"info"}`,children:[oi&&i.jsx("span",{className:"animate-spin",role:"status"}),Hi]}),gs&&i.jsxs("div",{className:`ai-function-status ${gs.toLowerCase().includes("error:")?"error":"info"}`,children:[Qr&&i.jsx("span",{className:"animate-spin",role:"status"}),gs]}),qa&&i.jsxs("div",{className:`ai-function-status ${qa.toLowerCase().includes("error:")?"error":"info"}`,children:[Ks&&i.jsx("span",{className:"animate-spin",role:"status"}),qa]}),Wo&&i.jsxs("div",{className:`ai-function-status ${Wo.toLowerCase().includes("error:")?"error":"info"}`,children:[ji&&i.jsx("span",{className:"animate-spin",role:"status"}),Wo]}),tt&&i.jsxs("div",{className:"general-error-message",children:["Error saving AI response: ",tt]}),ue&&i.jsx("div",{className:"ai-function-status info text-center",children:"Saving AI response..."}),(W||A)&&i.jsxs("div",{ref:Be,className:`${A?"ai-function-call-block":"ai-response-container"} group`,children:[W&&i.jsx(Kc,{remarkPlugins:[Oo],children:W}),A&&i.jsxs("div",{className:"ai-json-details-container",children:[i.jsxs("button",{onClick:()=>M(!se),className:"ai-json-toggle-button",children:[se?i.jsx(H0,{size:14,className:"mr-1"}):i.jsx(Kx,{size:14,className:"mr-1"}),se?"Hide":"Show"," AI Function Call Details"]}),se&&i.jsx("pre",{className:"ai-json-pre",children:i.jsx("code",{children:JSON.stringify(JSON.parse(A),null,2)})})]}),i.jsxs("div",{className:"ai-response-actions",children:[i.jsx("button",{onClick:()=>oc(Q),disabled:!Q,title:"Copy Full AI Response",children:i.jsx(JP,{size:12})}),i.jsx("button",{onClick:sp,disabled:!Q,title:"Print AI Response",children:i.jsx(Vs,{size:12})})]})]})]}),i.jsx("div",{className:"draggable-divider",onMouseDown:af}),i.jsx("div",{className:"edit-complaint-context-column",style:{flexBasis:`calc(${100-rt}% - 5px)`},children:i.jsxs("div",{className:"ai-context-container",children:[i.jsxs("h3",{className:"ai-context-header",children:[i.jsx("span",{children:"AI Context:"}),i.jsx("div",{className:"ai-context-actions-top",children:i.jsxs("button",{onClick:or,disabled:!Xa,title:"Print All Patient Details",className:"context-action-button",children:[i.jsx(Vs,{size:14})," Print"]})}),(u==null?void 0:u.insurance_type)&&i.jsx("div",{className:"insurance-type-container mt-2",children:i.jsxs("select",{ref:$e,value:u.insurance_type,onChange:ae=>ef(u.id,ae.target.value),className:"insurance-type-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"insurance",children:"Insurance"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})})]}),i.jsxs("div",{className:"ai-context-section",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Admission Status"}),$&&!u?i.jsxs("div",{className:"space-y-2 mt-2",children:[i.jsx("div",{className:"skeleton-text"}),i.jsx("div",{className:"skeleton-text short"})]}):i.jsxs(i.Fragment,{children:[(u==null?void 0:u.admission_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Admitted:"})," ",new Date(u.admission_date).toLocaleDateString()]}),(u==null?void 0:u.discharge_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Discharged:"})," ",new Date(u.discharge_date).toLocaleDateString()]}),(u==null?void 0:u.current_status)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Current Status:"})," ",i.jsx("span",{className:"font-semibold",children:u.current_status})]}),i.jsxs("div",{className:"flex space-x-2 mt-2",children:[i.jsxs("button",{onClick:Au,className:`admit-discharge-button ${al?"discharge":"admit"}`,title:al?"Discharge Patient":"Admit Patient",disabled:!o||Gi||nl,children:[(Gi||nl)&&i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),Gi?"Admitting...":nl?"Discharging...":al?"Discharge":"Admit"]}),i.jsxs("button",{onClick:()=>lp("doctor"),className:`queue-status-button ${Sa?"in-queue":"add-to-queue"}`,title:Sa?"Patient is in Doctor Queue":"Add Patient to Doctor Queue",disabled:!o||wa||Sa,children:[wa&&i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),wa?"Adding...":Sa?"In Queue":"Add to Queue"]}),i.jsxs("button",{onClick:pl,className:"complete-consultation-button",title:"Mark Consultation as Complete",disabled:xs,children:[xs&&i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),xs?"Completing...":"Complete Consultation"]})]})]})]}),i.jsxs("div",{className:"ai-context-section border-t border-gray-100 dark:border-gray-800 pt-4",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Recurring Medications"}),$&&ci.length===0?i.jsxs("div",{className:"space-y-2 mt-2",children:[i.jsx("div",{className:"skeleton-text"}),i.jsx("div",{className:"skeleton-text short"})]}):ci.length>0?i.jsx("div",{className:"recurring-meds-container space-y-3 mt-2",children:ci.map((ae,ge)=>i.jsxs("div",{className:"ai-context-item flex flex-col p-3 rounded-lg border border-gray-100 dark:border-gray-800",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2 pb-2 border-b border-gray-50 dark:border-gray-800",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("span",{className:"text-xs font-semibold text-gray-500",children:["#",ge+1," Status:"]}),i.jsx("span",{className:`status-badge text-[10px] uppercase font-bold px-1.5 py-0.5 rounded ${ae.status==="active"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":ae.status==="paused"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"}`,children:ae.status})]}),i.jsxs("div",{className:"flex space-x-1",children:[i.jsx("button",{onClick:()=>tf(ae),className:"icon-button small",title:"Edit Recurring Medication",children:i.jsx(Qc,{size:12})}),i.jsx("button",{onClick:()=>rc(ae.id),className:"icon-button small text-red-500",title:"Delete Recurring Medication",children:i.jsx(Oi,{size:12})})]})]}),i.jsx("div",{className:"pharmacy-order-drugs-table-container",children:i.jsxs("table",{className:"pharmacy-order-drugs-table w-full text-[11px] table-fixed",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2 text-left w-[40%]",children:"Medications"}),i.jsx("th",{className:"py-1 px-2 text-left w-[20%]",children:"Dosage"}),i.jsx("th",{className:"py-1 px-2 text-left w-[40%]",children:"Freq / Next"})]})}),i.jsx("tbody",{children:i.jsxs("tr",{children:[i.jsx("td",{className:"py-2 px-2 align-top",children:i.jsx("div",{className:"space-y-2",children:ae.medications.map((pe,_e)=>i.jsxs("div",{className:"flex flex-col border-b border-gray-50 dark:border-gray-800/50 last:border-0 pb-1 last:pb-0",children:[i.jsx("strong",{className:"break-words leading-tight",children:pe.name}),i.jsx("div",{className:"flex flex-wrap gap-x-2 text-gray-500 text-[10px]",children:i.jsxs("span",{children:[pe.pack_quantity?`${pe.pack_quantity}p`:"",pe.pack_quantity&&pe.loose_quantity?" + ":"",pe.loose_quantity?`${pe.loose_quantity}l`:""]})}),pe.directions_to_use&&i.jsx("span",{className:"text-[10px] text-blue-600 dark:text-blue-400 italic mt-0.5 line-clamp-2",title:pe.directions_to_use,children:pe.directions_to_use})]},_e))})}),i.jsx("td",{className:"py-2 px-2 align-top",children:i.jsx("div",{className:"space-y-2",children:ae.medications.map((pe,_e)=>i.jsx("div",{className:"flex flex-col border-b border-gray-50 dark:border-gray-800/50 last:border-0 pb-1 last:pb-0 h-[32px] justify-center",children:pe.tabletsPerDay?`${pe.tabletsPerDay} / day`:"-"},_e))})}),i.jsxs("td",{className:"py-2 px-2 align-top italic text-gray-500 break-words leading-tight",children:[i.jsxs("div",{className:"font-semibold text-gray-700 dark:text-gray-300",children:["Every ",ae.frequency_days,"d"]}),i.jsxs("div",{className:"text-[10px] not-italic mt-1 text-gray-400",children:["Next: ",new Date(ae.next_delivery_date).toLocaleDateString()]}),ae.last_delivery_date&&i.jsxs("div",{className:"text-[9px] not-italic mt-0.5 text-gray-400",children:["Last: ",new Date(ae.last_delivery_date).toLocaleDateString()]})]})]})})]})})]},ae.id))}):i.jsx("p",{className:"ai-context-text italic text-gray-400 mt-2",children:"No recurring medications."})]}),i.jsx(j0,{title:"Pharmacy Order History",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:sc,className:"button-primary blue text-xs px-2 py-1",disabled:Ns||nt.filter(ae=>ae.status==="pending").length<2,title:"Merge all pending orders into one",children:Ns?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),"Merging..."]}):"Merge Orders"}),i.jsxs("button",{onClick:()=>Ki(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new pharmacy order",disabled:!o,children:[i.jsx(Gl,{size:12,className:"mr-1"})," Add Pharmacy Order"]})]}),items:Zr,onMarkAsRecurring:ap,isLoading:$,loadingText:"Loading...",noDataText:"No orders.",renderItemContent:(ae,ge)=>i.jsxs("div",{className:"flex flex-col w-full",children:[i.jsxs("span",{className:"ai-context-text flex items-center",children:[" ",Zr.length-ge,". Order Status: (",ae.data.status,")",i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(ae.originalDateString).toLocaleDateString(),")"]}),i.jsxs("div",{className:"inline-flex space-x-2 ml-2",children:[" ",i.jsx("button",{onClick:()=>Nu(ae.data.id),className:"icon-button small",title:"Edit Pharmacy Order",children:i.jsx(Qc,{size:12})}),ae.data.prescriptionForUnavailableDrugs&&i.jsx("button",{onClick:()=>ku(ae.data.prescriptionForUnavailableDrugs,"Unavailable Drugs Prescription"),className:"icon-button small",title:"Print Unavailable Drugs Prescription",children:i.jsx(Vs,{size:12})}),i.jsx("button",{onClick:()=>oo({type:"Pharmacy Order",data:ae.data}),className:"icon-button small text-red-500",title:"Delete Pharmacy Order",children:i.jsx(Oi,{size:12})}),ae.data.status==="pending"&&i.jsx("button",{onClick:()=>ip(ae.data.id),className:"icon-button small",title:"Bill this pharmacy order",disabled:Jr,children:i.jsx(zd,{size:12})}),ae.data.status==="billed"&&i.jsx("button",{onClick:()=>rp(ae.data.id,"dispensed"),className:"icon-button small",title:"Dispense this pharmacy order",disabled:Jr,children:i.jsx(Ua,{size:12})}),ae.data.status==="dispensed"&&i.jsx("button",{onClick:async()=>{var pe;try{const _e=await fe(`/api/bills?patientId=${ae.data.patientId}`);if(!_e.ok)throw new Error("Failed to fetch bills");const gt=(pe=(await _e.json()).bills)==null?void 0:pe.find(yt=>yt.related_id===ae.data.id&&yt.type==="pharmacy");gt?n(`/dashboard/bills/${gt.id}`):alert("Bill not found for this order.")}catch(_e){console.error("Error fetching bill:",_e),alert("Failed to fetch bill. Please try again.")}},className:"icon-button small",title:"View Bill",children:i.jsx(T_,{size:12})})]})]}),i.jsx("div",{className:"pharmacy-order-drugs-table-container mt-2",children:i.jsxs("table",{className:"pharmacy-order-drugs-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2 text-left",children:"Drug Name"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Quantity"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Dosage"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Directions"})]})}),i.jsx("tbody",{children:ae.data.medications.map((pe,_e)=>i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:i.jsx("strong",{children:pe.name})}),i.jsxs("td",{className:"py-1 px-2",children:[pe.pack_quantity!==void 0&&pe.pack_quantity>0&&`Packs: ${pe.pack_quantity}`,pe.pack_quantity!==void 0&&pe.pack_quantity>0&&pe.loose_quantity!==void 0&&pe.loose_quantity>0&&", ",pe.loose_quantity!==void 0&&pe.loose_quantity>0&&`Loose: ${pe.loose_quantity}`]}),i.jsx("td",{className:"py-1 px-2",children:pe.tabletsPerDay&&pe.numberOfDays?`${pe.tabletsPerDay} tab/day for ${pe.numberOfDays} days`:"N/A"}),i.jsx("td",{className:"py-1 px-2",children:pe.directions_to_use||"N/A"})]},pe.drug_id||pe.name||_e))})]})}),ae.data.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[i.jsx("span",{className:"font-semibold",children:"Prescription:"})," ",ae.data.prescriptionForUnavailableDrugs]})]})}),i.jsx(eW,{isOpen:pu,onClose:()=>Ki(!1),patientId:o,pharmacyInventory:_t,fetchPharmacyOrdersData:Ja}),i.jsx(j0,{title:"Lab History (Orders & Reports)",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:Eu,className:"button-primary blue text-xs px-2 py-1",title:"Tell AI to analyse the reports",disabled:hi,children:"Analyse Reports"}),i.jsxs("button",{onClick:()=>Xd(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new lab order",disabled:!o,children:[i.jsx(Gl,{size:12,className:"mr-1"})," Create Lab Order"]})]}),items:Ka,onSaveLabOrder:ju,onCancelEditLabOrder:Su,onLabOrderTestChange:hl,onLabOrderStatusChange:nf,onBillLabOrder:ac,labInventory:Ot,isSavingLabOrder:Jr,isLoading:el||we,loadingText:"Loading...",noDataText:"No lab Hx.",expandedLabReports:va,toggleLabReport:Tu,renderItemContent:(ae,ge)=>{const pe=QG(ae.data.report?ae.data.report.status:ae.data.status);return i.jsxs("div",{className:"ai-context-text",children:[i.jsxs("span",{onClick:()=>lo(ae.data),style:{cursor:"pointer"},className:"hover:text-blue-600",title:"Click to open lab report",children:[ae.data.serialNumber,". ",i.jsx("span",{className:"font-medium",children:"[Order]"})," ",ae.data.tests&&ae.data.tests.length>0?ae.data.tests.map(_e=>i.jsxs("strong",{children:[_e.name," (",_e.price,")"]},_e.id||_e.name)).reduce((_e,at)=>[_e,", ",at]):i.jsx("span",{className:"italic text-gray-500",children:"No tests specified"})," ",ae.data.tests&&ae.data.tests.length>0&&i.jsxs("span",{className:"font-bold ml-2",children:["Total: ",ae.data.tests.reduce((_e,at)=>_e+(Number(at.price)||0),0).toFixed(2)]}),"(",i.jsx("span",{className:pe.className,children:pe.text}),")",i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(ae.originalDateString).toLocaleDateString(),")"]})]}),i.jsxs("div",{className:"inline-flex space-x-2 ml-2",children:[i.jsx("button",{onClick:()=>lo(ae.data),className:"icon-button small",title:"Manage Lab Report",children:i.jsx(ps,{size:12})}),i.jsx("button",{onClick:()=>fl(ae.data.id),className:"icon-button small",title:"Edit Order Details",children:i.jsx(Qc,{size:12})}),i.jsx("button",{onClick:()=>oo({type:"Lab Order",data:ae.data}),className:"icon-button small text-red-500",title:"Delete Lab Order",children:i.jsx(Oi,{size:12})})]}),ae.data.report&&i.jsxs("div",{className:"ml-4 mt-1 p-2 border-l-2 border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-medium",children:"[Report]"}),i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(ae.data.report.report_date).toLocaleDateString(),")"]}),i.jsx("button",{onClick:()=>Tu(ae.data.report.reportId),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:va[ae.data.report.reportId]?"Collapse Report":"Expand Report",children:va[ae.data.report.reportId]?i.jsx(H0,{size:14}):i.jsx(Kx,{size:14})})]}),va[ae.data.report.reportId]&&(()=>{try{const _e=JSON.parse(ae.data.report.report_content||"{}");return typeof _e=="object"&&_e!==null&&ae.data.report.tests?ae.data.report.tests.map(at=>i.jsxs("div",{style:{marginBottom:"10px"},children:[i.jsx("h5",{className:"font-semibold text-sm mt-2 mb-1",children:at.name}),_e[at.id]?i.jsxs("table",{className:"lab-inventory-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2",children:"Parameter"}),i.jsx("th",{className:"py-1 px-2",children:"Value"}),i.jsx("th",{className:"py-1 px-2",children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(_e[at.id]).map(([gt,yt])=>{var cc;const pt=(cc=at.default_parameters)==null?void 0:cc.find(pi=>pi.name===gt),Ni=typeof yt=="string"?parseFloat(yt):typeof yt=="number"?yt:NaN,sn=(pt==null?void 0:pt.type)==="number"&&!isNaN(Ni)&&yt!==""&&yt!==null&&yt!==void 0&&(pt.lower_limit!=null&&Ni<pt.lower_limit||pt.upper_limit!=null&&Ni>pt.upper_limit),cr=(pt==null?void 0:pt.type)==="boolean"&&(yt===!0||yt==="true");return i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:gt}),i.jsxs("td",{className:`py-1 px-2 ${sn?"abnormal-result":""} ${cr?"reactive-result":""}`,children:[String(yt)," ",(pt==null?void 0:pt.unit)||""]}),i.jsx("td",{className:"py-1 px-2",children:(()=>{if(pt&&pt.type==="number"&&(pt.lower_limit!=null||pt.upper_limit!=null)){let pi="";return pt.lower_limit!=null&&(pi+=` > ${pt.lower_limit}`),pt.lower_limit!=null&&pt.upper_limit!=null&&(pi+=" - "),pt.upper_limit!=null&&(pi+=` < ${pt.upper_limit}`),pi.trim()||"N/A"}else if((pt==null?void 0:pt.type)==="boolean")return"Non-Reactive";return(pt==null?void 0:pt.normal_range)||"N/A"})()})]},gt)})})]}):i.jsx("p",{className:"italic text-gray-500 text-xs",children:"No parameters reported for this test."})]},at.id)):i.jsx(Kc,{remarkPlugins:[Oo],children:ae.data.report.report_content})}catch{return i.jsx(Kc,{remarkPlugins:[Oo],children:ae.data.report.report_content||"*No findings recorded.*"})}})()]})]})}}),i.jsx(NY,{isOpen:hu,onClose:()=>Xd(!1),patientId:o,labInventory:Ot,fetchPendingLabOrdersData:dl}),Kl&&i.jsx(mE,{isOpen:mu,onClose:()=>Jo(!1),recurringMedication:Kl,onUpdate:()=>o&&$r(o),inventory:_t}),i.jsx(j0,{title:"Complaints History",items:Yi,isLoading:Vt,loadingText:"Loading...",noDataText:"No past Hx.",renderItemContent:(ae,ge)=>i.jsxs("span",{className:"ai-context-text",children:[ae.data.complaint,i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(ae.originalDateString).toLocaleDateString(),")"]})]}),onDeleteItem:oo}),i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("h4",{className:"ai-context-section-title",children:[i.jsx(dg,{size:16,className:"text-purple-600"})," Clinic-wide System Prompt"]}),!tc&&i.jsx("button",{onClick:lc,className:"edit-button",title:"Edit System Prompt",disabled:xu||Ca||Ss,children:i.jsx(Qc,{size:14})})]}),tc&&mn?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:xr,onChange:ae=>cl(ae.target.value),className:"context-edit-textarea",placeholder:"Enter clinic system prompt...",disabled:Ca||Ss}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:of,disabled:Ca||Ss,className:"button-secondary",children:"Cancel"}),i.jsxs("button",{onClick:lf,disabled:Ca||Ss||Un===mn.aiMemory&&xr===mn.clinicWideSystemPrompt,className:"button-primary purple",children:[Ss||Ca?i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}):i.jsx(eu,{size:14,className:"mr-1"}),Ss||Ca?"Saving...":"Save Settings"]})]})]}):i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:mn!=null&&mn.clinicWideSystemPrompt?i.jsx(Kc,{remarkPlugins:[Oo],children:mn.clinicWideSystemPrompt}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),!tc&&(mn==null?void 0:mn.clinicWideSystemPromptUpdatedAt)&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Prompt Last Updated: ",new Date(mn.clinicWideSystemPromptUpdatedAt).toLocaleDateString()]})]}),i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Case Summary"}),!T&&i.jsx("button",{onClick:_u,className:"edit-button",title:"Edit Case Summary",disabled:$||V,children:i.jsx(Qc,{size:14})})]}),T?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:P,onChange:ae=>I(ae.target.value),className:"context-edit-textarea",rows:4,placeholder:"Enter case summary...",disabled:V}),O&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:O}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:Za,disabled:V,className:"button-secondary",children:"Cancel"}),i.jsx("button",{onClick:sf,disabled:V||P===S,className:"button-primary blue",children:V?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),"Saving..."]}):"Save"})]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:S?i.jsx(Kc,{remarkPlugins:[Oo],components:{},children:S}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),U&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Last Edited: ",new Date(U).toLocaleDateString()]})]})]}),Yi.length===0&&Ka.length===0&&Zr.length===0&&!(Vt||el||we)&&i.jsx("p",{className:"ai-context-text italic mt-4",children:"No recent history for this patient."}),tl&&i.jsx("p",{className:"text-yellow-600 text-xs mt-2 ai-context-text",children:"Deleting..."}),Jl&&i.jsx("p",{className:"text-red-600 text-xs mt-2 ai-context-text",children:Jl})]})})]}),i.jsxs("div",{className:"edit-complaint-input-area",children:[i.jsxs("div",{className:"status-messages-container",children:[De&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:De}),Vt&&i.jsx("div",{className:"loading-animation-container",children:i.jsx("div",{className:"loading-text",children:"Loading past complaints..."})}),J&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:J}),el&&i.jsx("div",{className:"loading-animation-container",children:i.jsx("div",{className:"loading-text",children:"Loading pending lab orders..."})}),Kd&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Kd}),Wn&&i.jsx("div",{className:"loading-animation-container",children:i.jsx("div",{className:"loading-text",children:"Loading inventory..."})}),Ti&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Ti}),$&&i.jsx("div",{className:"loading-animation-container",children:i.jsx("div",{className:"loading-text",children:"Loading..."})})]}),e&&!H&&i.jsxs(w.Fragment,{children:[er&&i.jsxs("div",{className:"follow-up-question-container",children:[i.jsx("p",{className:"question-text",children:er}),js.length>0&&i.jsx("div",{className:"options-grid",children:js.map((ae,ge)=>i.jsx("button",{onClick:()=>ea(ae),className:"option-button",children:ae},ge))})]}),io&&i.jsx("div",{className:"speech-error-display",children:io}),xn&&i.jsxs("div",{className:"selected-file-display",children:[i.jsxs("span",{children:["Selected: ",xn.name]}),i.jsx("button",{onClick:()=>{bn(null),ro.current&&(ro.current.value="")},className:"remove-file-button",title:"Remove image",children:""})]}),i.jsx("div",{className:"input-wrapper",children:i.jsxs("div",{className:"main-input-container",children:[i.jsx("input",{type:"file",ref:ro,onChange:dt,accept:"image/*",className:"hidden"}),i.jsx("textarea",{ref:be,className:"complaint-textarea",value:r,onChange:ae=>a(ae.target.value),onKeyDown:cf,placeholder:"name,age,sex,phone,complaints,reports,history",disabled:hi||!e||ja}),i.jsxs("div",{className:"chat-input-actions-container",children:[o&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>n(`/patient/${o}/lab-reports`),disabled:we||!o,className:"icon-button",title:"View Lab Reports",children:i.jsx(ps,{size:14})}),i.jsx("button",{onClick:()=>n("/inventory"),disabled:Wn,className:"icon-button",title:"View Inventory",children:i.jsx(Ud,{size:14})})]}),i.jsx("button",{type:"button",onClick:Ue,disabled:hi||!e||ja,className:"icon-button",title:"Attach Image",children:i.jsx(EI,{size:14})}),i.jsx("button",{type:"button",onClick:He,disabled:hi||!e||!ll.current,className:`mic-button ${ja?"listening":""}`,title:ja?"Stop":"Mic",children:i.jsx(P_,{size:14})}),i.jsx("button",{onClick:()=>lr(),disabled:hi||Wn||H||!r.trim()||!e||ja,className:"send-button",title:hi||Wn||H?"Processing...":"Save & Ask AI",children:hi?i.jsx("span",{className:"animate-spin",role:"status","aria-label":"loading"}):i.jsx(Lo,{size:14})})]})]})})]})]})]})},Ree=()=>{const{patientId:e}=Rr(),n=wt(),[t,r]=w.useState([]),[a,l]=w.useState(null),[o,f]=w.useState(!1),[u,d]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){d("Patient ID not provided.");return}f(!0),d(null);try{const b=await fe(`/api/patients/${e}`);if(!b.ok)throw new Error(`Failed to fetch patient details: ${b.status}`);const v=await b.json();l({name:v.name,age:v.age,gender:v.gender});const S=await fe(`/api/patients/${e}/complaints`);if(S.ok){const T=(await S.json()).sort((E,P)=>new Date(P.createdAt).getTime()-new Date(E.createdAt).getTime());r(T)}else if(S.status===404)r([]);else throw new Error(`Failed to fetch complaints: ${S.status}`)}catch(b){console.error("Error fetching past complaints or patient info:",b),d(`Failed to load data. ${b.message}`),r([]),l(null)}finally{f(!1)}})()},[e]);const h=g=>{navigator.clipboard.writeText(g).then(()=>console.log("Complaint copied to clipboard")).catch(b=>console.error("Failed to copy complaint: ",b))};return i.jsxs("div",{className:"container mx-auto p-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-1 px-3 rounded text-sm",children:"< Back"}),i.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-center flex-grow",children:"Past Complaints"}),i.jsx("div",{className:"w-16"})," "]}),a&&i.jsxs("div",{className:"mb-4 p-2 bg-gray-100 rounded text-center text-sm sm:text-base",children:["Patient: ",i.jsx("strong",{children:a.name})," (",a.age??"N/A"," / ",a.gender??"N/A",")"]}),u&&i.jsxs("div",{className:"text-red-500 p-3 mb-4 border border-red-500 rounded bg-red-50 text-sm",children:["Error: ",u]}),o&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading..."}),!o&&t.length===0&&!u&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No past complaints found for this patient."}),!o&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(g=>i.jsxs("div",{className:"p-3 border rounded shadow-sm bg-white group relative",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:new Date(g.createdAt).toLocaleString()}),i.jsx("p",{className:"text-sm whitespace-pre-wrap",children:g.complaint}),i.jsx("button",{onClick:()=>h(g.complaint),className:"absolute top-1 right-1 bg-gray-200 hover:bg-gray-300 text-gray-600 text-xs p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Copy complaint text",children:""})]},g.id))})]})},Lx=500,QC="defaultConsultationFee",Lee=({patientId:e,billId:n,queueId:t,onBillCreated:r,onBillUpdated:a,initialItems:l=[],billType:o="other",relatedId:f,initialStatus:u="pending",initialDiscountPercentage:d=0,readOnlyMode:h=!1,doctorId:g,labOrderId:b,patientInsuranceType:v})=>{const[S,k]=w.useState(null),[T,E]=w.useState([]),P=w.useRef([]),[I,V]=w.useState(""),[F,O]=w.useState(""),[B,U]=w.useState(1),[z,$]=w.useState(d),[R,H]=w.useState("cash"),[ee,Z]=w.useState(!1),[te,Q]=w.useState(null),[q,W]=w.useState(!1),[ne,A]=w.useState(!1),[ie,se]=w.useState(!1),[M,ce]=w.useState(null),[,ve]=w.useState([]),[le,xe]=w.useState(null),[ue,ze]=w.useState(""),[tt,ft]=w.useState("cash"),[Re,je]=w.useState(!1),[he,Ae]=w.useState(Lx),[we,Me]=w.useState(Lx.toString()),De=n?"view_pay":"create";w.useEffect(()=>{const Le=localStorage.getItem(QC),Ve=Le?parseFloat(Le):Lx;isNaN(Ve)||(Ae(Ve),Me(Ve.toString()))},[]);const Je=l.length===0;w.useEffect(()=>{e?(async()=>{Z(!0),Q(null);try{const Ve=await fe(`/api/patients/${e}`);if(!Ve.ok){const Ke=await Ve.json().catch(()=>({}));throw new Error(Ke.message||"Failed to fetch patient details")}const qe=await Ve.json();k(qe)}catch(Ve){Q(`Failed to load patient details: ${Ve.message}`),k(null)}finally{Z(!1)}})():k(null)},[e]),w.useEffect(()=>{n?(async()=>{se(!0),Q(null),ce(null),ve([]),xe(null);try{const Ve=await fe(`/api/bills/${n}`);if(!Ve.ok){const Ke=await Ve.json().catch(()=>({}));throw new Error(Ke.message||"Failed to fetch bill details")}const qe=await Ve.json();if(!qe.bill||!qe.payments||!qe.calculated)throw new Error("Invalid bill details structure.");ce(qe.bill),ve(qe.payments),xe(qe.calculated),$(qe.bill.discount_percentage!==void 0&&qe.bill.discount_percentage!==null?parseFloat(qe.bill.discount_percentage.toString()):0),!S&&qe.bill.patient_id&&nt(qe.bill.patient_id.toString())}catch(Ve){Q(`Failed to load bill details: ${Ve.message}`),ce(null),ve([]),xe(null)}finally{se(!1)}})():(ce(null),ve([]),xe(null))},[n]);const nt=async Le=>{Z(!0);try{const Ve=await fe(`/api/patients/${Le}`);if(!Ve.ok)throw new Error("Failed to fetch patient");const qe=await Ve.json();k(qe)}catch(Ve){console.error("Error fetching patient details:",Ve),k(null)}finally{Z(!1)}},Ge=w.useCallback(async Le=>{A(!0),Q(null);const Ve=Le.filter(qe=>qe.drug_id!=null).map(async qe=>{try{const Ke=await fe(`/api/drugs/${qe.drug_id}`);if(!Ke.ok)throw new Error(`Drug ${qe.drug_id} not found.`);const We=await Ke.json();return{...qe,price:We.price,total:We.price*qe.quantity}}catch{return Q(We=>`${We?We+"; ":""}Failed to fetch price for ${qe.name}`),qe}});try{const qe=await Promise.all(Ve);E(Ke=>{const We=new Map(qe.map(zt=>[zt.id,zt]));return Ke.map(zt=>We.get(zt.id)||zt)})}catch{}finally{A(!1)}},[fe]);w.useEffect(()=>{if(n){E([]),P.current=[];return}JSON.stringify(l)===JSON.stringify(P.current)||(async()=>{let qe=[];if(l&&l.length>0)qe=l.map((Ke,We)=>({...Ke,id:`initial-${We}-${Date.now()}`})),H(u==="paid"?"cash":v==="no_cash_insurance"?"no_cash_insurance":"cash"),$(d),o==="pharmacy"&&!h&&await Ge(qe);else if(e&&Je&&o==="consultation"){let Ke=he;if(g)try{const We=await fe(`/api/staff/${g}`);if(!We.ok){const _t=await We.json().catch(()=>({}));throw new Error(_t.message||"Doctor not found or error fetching fee")}const zt=await We.json();zt.opd_fee!=null&&!isNaN(parseFloat(String(zt.opd_fee)))&&parseFloat(String(zt.opd_fee))>=0&&(Ke=parseFloat(String(zt.opd_fee)))}catch(We){Q(zt=>`${zt?zt+"; ":""}Could not fetch doctor's fee, using default. (${We.message})`)}qe=[{id:Date.now(),name:"Consultation Fee",price:Ke,quantity:1,total:Ke*1,drug_id:null}],H(v==="no_cash_insurance"?"no_cash_insurance":"cash")}else qe=[],H(v==="no_cash_insurance"?"no_cash_insurance":"cash");E(qe),P.current=l})()},[n,e,g,l,o,he,Je,u,h,Ge,d,v]);const St=()=>{const Le=parseFloat(F);if(!h)if(I&&!isNaN(Le)&&Le>=0&&B>0){if(I.trim().toLowerCase()==="consultation fee"&&T.some(qe=>qe.name.toLowerCase()==="consultation fee")){alert("Consultation Fee already added.");return}const Ve={id:Date.now(),name:I.trim(),price:Le,quantity:B,total:Le*B,drug_id:null};E([...T,Ve]),V(""),O(""),U(1)}else alert("Invalid item details.")},It=Le=>{h||E(T.filter(Ve=>Ve.id!==Le))},Vt=w.useMemo(()=>{let Le=T.reduce((Ve,qe)=>Ve+qe.total,0);return De==="create"&&z>0&&(Le=Le*(1-z/100)),(le==null?void 0:le.totalDue)!==void 0&&(le==null?void 0:le.totalDue)!==null?le.totalDue:Le},[T,le,z,De]),oe=w.useMemo(()=>(le==null?void 0:le.totalPaid)??0,[le]),J=w.useMemo(()=>(le==null?void 0:le.balance)!==void 0&&(le==null?void 0:le.balance)!==null?le.balance:Vt-oe,[le,Vt,oe]),de=()=>{const Le=parseFloat(we);!isNaN(Le)&&Le>=0?(Ae(Le),localStorage.setItem(QC,Le.toString()),alert(`Default Fee set to ${Le.toFixed(2)}`)):alert("Invalid fee amount.")},Be=async(Le,Ve)=>{W(!0),Q(null);try{const qe=await fe("/api/payment/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Ve,billId:Le})}),Ke=await qe.json();if(!qe.ok||!Ke.order)throw new Error(Ke.message||"Failed to create Razorpay order.");const{key_id:We,order:zt}=Ke,_t={key:We,amount:zt.amount,currency:zt.currency,name:"Newtons OPD Zero Clinic",description:`Bill Payment for Patient ID: ${e}`,order_id:zt.id,handler:async function(rn){try{const Ot=await fe("/api/payment/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({razorpay_payment_id:rn.razorpay_payment_id,razorpay_order_id:rn.razorpay_order_id,razorpay_signature:rn.razorpay_signature,billId:Le})}),Yn=await Ot.json();if(Ot.ok&&Yn.success)alert("Payment Successful!"),r&&r(Le),a&&a(),setTimeout(()=>window.print(),200);else throw new Error(Yn.message||"Payment verification failed.")}catch(Ot){Q(`Payment verification failed: ${Ot.message}. Contact support.`)}finally{W(!1)}},prefill:{name:(S==null?void 0:S.name)||""},notes:{bill_id:Le,patient_id:e},theme:{color:"#3399cc"},modal:{ondismiss:function(){Q("Payment cancelled."),W(!1)}}};if(window.Razorpay)new window.Razorpay(_t).open();else throw new Error("Razorpay SDK not loaded.")}catch(qe){Q(`Failed to initiate online payment: ${qe.message}`),W(!1)}},be=async()=>{if(!n){Q("Bill ID is missing.");return}if(!ue||isNaN(parseFloat(ue))||parseFloat(ue)<=0){Q("Please enter a valid positive payment amount.");return}je(!0),Q(null);const Le={amount_paid:parseFloat(ue),payment_mode:tt};try{const Ve=await fe(`/api/bills/${n}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Le)}),qe=await Ve.json();if(!Ve.ok)throw new Error(qe.message||`Failed to record payment (Status: ${Ve.status})`);alert(`Payment of ${Le.amount_paid.toFixed(2)} recorded.`),ze(""),a?a():console.log("Payment recorded.")}catch(Ve){Q(`Failed to record payment: ${Ve.message}`)}finally{je(!1)}},Fe=async()=>{if(De==="view_pay")return;if(!e){Q("Patient ID is missing for creating a bill.");return}if(T.length===0){Q("Cannot finalize an empty bill.");return}W(!0),Q(null);const Le=Vt,Ve=T.map(({id:qe,...Ke})=>Ke);if(R==="online"){const qe={patientId:e,queueId:t||null,items:Ve,amount:Le,paymentMode:"online",type:o,related_id:f||b||null,status:"pending",discountPercentage:z,labOrderId:b||null};try{const Ke=await fe("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(qe)}),We=await Ke.json();if(!Ke.ok)throw new Error(We.message||"Failed to create pending bill.");Be(We.id,Math.round(Le*100))}catch(Ke){Q(`Failed to create pending bill: ${Ke.message}`),W(!1)}}else{const qe="paid";if(!R){Q("Payment mode required."),W(!1);return}const Ke={patientId:e,queueId:t||null,items:Ve,amount:Le,paymentMode:R,type:o,related_id:f||b||null,status:qe,discountPercentage:z,labOrderId:b||null};setTimeout(()=>window.print(),200);try{const We=await fe("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ke)}),zt=await We.json();if(!We.ok)throw new Error(zt.message||"Failed to create bill.");alert("Bill marked as paid!"),r&&r(zt.id),W(!1)}catch(We){Q(`Failed to process bill: ${We.message}`),W(!1)}}},$e=(M==null?void 0:M.type)??o,st=(M==null?void 0:M.status)??u,rt=De==="view_pay"&&M&&st==="pending";return!e&&!n?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow text-gray-500",children:"Select patient or provide Bill ID."}):ee||De==="view_pay"&&ie?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow",children:"Loading..."}):De==="view_pay"&&!M&&!ie&&te?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading bill: ",te]}):De==="create"&&!S&&!ee&&te?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading patient: ",te]}):i.jsxs("div",{className:"billing-component-container printable-section",children:[i.jsxs("div",{className:"billing-header",children:[i.jsx("h2",{children:De==="create"?"Create Bill":"Bill Details"}),De==="create"&&o==="consultation"&&!h&&i.jsxs("div",{className:"default-fee-section",children:[i.jsx("label",{htmlFor:"defaultFee",className:"whitespace-nowrap",children:"Default Fee:"}),i.jsx("input",{id:"defaultFee",type:"number",value:we,onChange:Le=>Me(Le.target.value),className:"",placeholder:Lx.toString(),disabled:h}),i.jsx("button",{onClick:de,title:"Set Default Fee",className:"",disabled:h,children:i.jsx(eu,{size:16})})]})]}),te&&!ie&&!Re&&i.jsxs("div",{className:"error-message",role:"alert",children:[i.jsx("strong",{children:"Error: "}),te]}),S&&i.jsxs("div",{className:"patient-details-section",children:[i.jsx("h3",{children:"Patient Details"}),i.jsxs("p",{children:[i.jsx("strong",{children:"ID:"})," ",S.id]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",S.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Age:"})," ",S.age||"N/A",", ",i.jsx("strong",{children:"Gender:"})," ",S.gender||"N/A"]})]}),i.jsxs("div",{className:"bill-items-summary-section",children:[i.jsxs("div",{className:"bill-items-header",children:[i.jsx("h3",{children:De==="create"?"Bill Items":"Billing Summary"}),De==="create"&&o==="pharmacy"&&!h&&T.some(Le=>Le.drug_id!=null)&&i.jsxs("button",{onClick:()=>Ge(T),disabled:ne,className:"refresh-prices-button",title:"Refresh item prices from inventory",children:[i.jsx($h,{size:14,className:`lucide ${ne?"animate-spin":""}`}),ne?"Refreshing...":"Refresh"]})]}),De==="view_pay"&&M&&i.jsxs("div",{className:"bill-info-bar",children:[i.jsxs("span",{children:["Bill ID: ",i.jsx("strong",{children:M.id})]}),i.jsxs("span",{children:["Type: ",i.jsx("strong",{className:"capitalize",children:$e})]}),i.jsxs("span",{children:["Status: ",i.jsx("strong",{className:`capitalize ${st==="paid"?"status-paid":"status-pending"}`,children:st})]})]}),(De==="create"||De==="view_pay"&&M)&&i.jsxs("div",{className:"bill-items-list",children:[De==="create"&&ne&&T.length>0&&i.jsx("div",{className:"loading-placeholder",children:"Updating prices..."}),De==="create"&&!ne&&T.map((Le,Ve)=>i.jsxs("div",{className:"bill-item",children:[i.jsxs("div",{className:"bill-item-details",children:[i.jsxs("span",{children:[Ve+1,". ",Le.name]}),Le.quantity>1&&i.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",Le.quantity,")"]})]}),i.jsxs("div",{className:"bill-item-price-actions",children:[i.jsxs("span",{className:"bill-item-price",children:["",Le.total.toFixed(2)]}),De==="create"&&typeof Le.id=="number"&&!h&&i.jsxs("button",{onClick:()=>It(Le.id),className:"remove-item-button",title:"Remove",children:[" ",i.jsx(Kn,{size:16})," "]}),(typeof Le.id!="number"||h||Le.name==="Consultation Fee")&&i.jsxs("span",{className:"lock-icon",title:"Cannot remove",children:[" ",i.jsx(NN,{size:14})," "]})]})]},Le.id)),De==="view_pay"&&M&&M.items.map((Le,Ve)=>i.jsxs("div",{className:"bill-item",children:[i.jsxs("div",{className:"bill-item-details",children:[i.jsxs("span",{children:[Ve+1,". ",Le.name]}),Le.quantity>1&&i.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",Le.quantity,")"]})]}),i.jsxs("div",{className:"bill-item-price-actions",children:[i.jsxs("span",{className:"bill-item-price",children:["",(Le.total??Le.price*Le.quantity).toFixed(2)]}),i.jsxs("span",{className:"lock-icon",title:"Cannot remove from existing bill",children:[" ",i.jsx(NN,{size:14})," "]})]})]},Ve)),De==="create"&&T.length===0&&i.jsx("p",{className:"empty-items-message",children:"No items added."}),De==="view_pay"&&M&&M.items.length===0&&i.jsx("p",{className:"empty-items-message",children:"No items in bill."})]}),De==="create"&&!h&&i.jsxs("div",{className:"add-item-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Item"}),i.jsx("input",{type:"text",value:I,onChange:Le=>V(Le.target.value),placeholder:"Service/Item",className:"custom-text-input"})]}),i.jsxs("div",{className:"form-group",style:{flexGrow:.5,minWidth:"80px"},children:[i.jsx("label",{children:"Qty"}),i.jsx("input",{type:"number",min:"1",value:B,onChange:Le=>U(parseInt(Le.target.value)||1),placeholder:"1",className:"custom-text-input"})]}),i.jsxs("div",{className:"form-group",style:{flexGrow:.7,minWidth:"100px"},children:[i.jsx("label",{children:"Price ()"}),i.jsx("input",{type:"number",value:F,onChange:Le=>O(Le.target.value),placeholder:"0.00",className:"custom-text-input"})]}),i.jsx("button",{onClick:St,className:"add-item-button",children:"Add"})]})]})," ",i.jsxs("div",{className:"billing-footer",children:[i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Total Amount:"}),i.jsxs("span",{className:"total-amount-value",children:["",typeof Vt=="number"?Vt.toFixed(2):"0.00"]}),De==="create"&&!h&&i.jsxs("div",{className:"discount-section",children:[i.jsx("label",{htmlFor:"discountPercentage",className:"whitespace-nowrap",children:"Discount (%):"}),i.jsx("input",{id:"discountPercentage",type:"number",min:"0",max:"100",step:"0.01",value:z,onChange:Le=>$(parseFloat(Le.target.value)||0),className:"",disabled:h||q})]}),De==="view_pay"&&M&&(M.status==="pending"||M.status==="paid")&&i.jsxs("div",{className:"discount-section",children:[i.jsx("label",{className:"whitespace-nowrap",children:"Discount (%):"}),i.jsxs("span",{className:"discount-value",children:[z.toFixed(2),"%"]})]})]}),De==="view_pay"&&le&&i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Amount Paid:"}),i.jsxs("span",{className:"total-amount-value",children:["",oe.toFixed(2)]})]}),De==="view_pay"&&le&&i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Balance Due:"}),i.jsxs("span",{className:"total-amount-value",children:["",J.toFixed(2)]})]}),i.jsxs("div",{className:"footer-actions",children:[De==="create"&&!h&&i.jsxs("div",{className:"action-group",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Payment Mode"}),i.jsxs("select",{value:R,onChange:Le=>H(Le.target.value),className:"custom-select-input",disabled:h||q,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"online",children:"Pay Online (Razorpay)"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsx("button",{onClick:Fe,disabled:q||T.length===0||h,className:"finalize-button",children:q?"Processing...":"Finalize Bill"})]}),De==="view_pay"&&rt&&!h&&i.jsxs("div",{className:"action-group",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Record Payment Amount ()"}),i.jsx("input",{type:"number",value:ue,onChange:Le=>ze(Le.target.value),placeholder:`Max: ${J.toFixed(2)}`,className:"custom-text-input",disabled:Re})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Payment Mode"}),i.jsxs("select",{value:tt,onChange:Le=>ft(Le.target.value),className:"custom-select-input",disabled:Re,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),i.jsx("button",{onClick:be,disabled:Re||!ue||parseFloat(ue)<=0||parseFloat(ue)>J,className:"record-payment-button",children:Re?"Recording...":"Record Payment"})]}),De==="create"&&h&&T.length>0&&i.jsx("div",{className:"status-message read-only",children:"Read-only."}),De==="view_pay"&&st==="paid"&&i.jsx("div",{className:"status-message paid",children:"PAID."}),De==="view_pay"&&st==="cancelled"&&i.jsx("div",{className:"status-message cancelled",children:"CANCELLED."})]})]})]})},Oee=()=>{const e=wt(),n=gr(),{patientId:t,queueId:r,patientName:a,initialItems:l,billType:o,relatedId:f,initialStatus:u,initialDiscountPercentage:d,doctorId:h,billId:g,labOrderId:b}=n.state||{},[v,S]=w.useState(null),[k,T]=w.useState(null),[E,P]=w.useState(null),[I,V]=w.useState(null),[F,O]=w.useState(null),[B,U]=w.useState(null),[z,$]=w.useState(null),[R,H]=w.useState(null),[ee,Z]=w.useState(!0),[te,Q]=w.useState(null),[q,W]=w.useState(a||"");w.useEffect(()=>{if(!t){console.error("BillingPage loaded without required patientId in location state."),e("/");return}(async()=>{Z(!0),Q(null);try{let ce=t,ve=l||null,le=u||null,xe=o||null,ue=f||null,ze=d!==void 0?parseFloat(d):null,tt=a||null,ft=null;if(g){console.log(`Fetching details for Bill ID: ${g}`);const Re=await fe(`/api/bills/${g}`);if(!Re.ok){const he=await Re.json().catch(()=>({message:`Failed to fetch bill details for ID ${g}`}));throw new Error(he.message||`Failed to fetch bill details (Status: ${Re.status})`)}const je=await Re.json();if(console.log("Fetched Bill Data:",je),ve=je.bill.items||[],le=je.bill.status||"pending",xe=je.bill.type||null,ue=je.bill.related_id||null,ze=je.bill.discount_percentage!==void 0&&je.bill.discount_percentage!==null?parseFloat(je.bill.discount_percentage):0,ce=je.bill.patient_id,V(ve),O(le),U(xe),$(ue),H(ze),ce){const he=await fe(`/api/patients/${ce}`);if(he.ok){const Ae=await he.json();tt=Ae.name,ft=Ae.phone??null,P(Ae.insurance_type??null),W(tt),T(ft)}else console.warn(`Could not fetch patient details for ID ${ce} from bill.`),W("Patient (Not Found)")}else console.warn(`Bill ${g} does not have an associated patient_id.`),W("Patient (Unknown)")}else if(o==="consultation"&&h){console.log(`Creating consultation bill for doctor ID: ${h}`);const Re=await fe(`/api/staff/${h}`);if(!Re.ok){const Ae=await Re.json().catch(()=>({}));throw new Error(Ae.message||`Failed to fetch doctor details (status ${Re.status})`)}const je=await Re.json();console.log("Fetched Doctor Data:",je);const he=je.opd_fee?parseFloat(String(je.opd_fee)):0;if(he>0?ve=[{drug_id:h,name:`Consultation Fee - Dr. ${je.name}`,price:he,quantity:1,total:he}]:ve=[],le="pending",xe="consultation",ue=r,V(ve),O(le),U(xe),$(ue),ce){const Ae=await fe(`/api/patients/${ce}`);if(Ae.ok){const we=await Ae.json();T(we.phone??null),P(we.insurance_type??null)}else console.warn(`Could not fetch patient details for ID ${ce}.`)}}else if(b){console.log(`Fetching details for Lab Order ID: ${b}`);const Re=await fe(`/api/lab/${b}`);if(!Re.ok){let he=`Failed to fetch lab order details (Status: ${Re.status} ${Re.statusText})`;try{he=(await Re.json()).message||he}catch{console.error("Response was not valid JSON:",await Re.text())}throw new Error(he)}const je=await Re.json();if(console.log("Fetched Lab Order Data:",JSON.stringify(je,null,2)),ve=(je.tests||[]).filter(he=>he&&typeof he.name=="string"&&he.price!==void 0&&he.id!==void 0).map(he=>{const Ae=parseFloat(he.price||"0"),we=!isNaN(Ae)&&isFinite(Ae)?Ae:0;return{drug_id:he.id,name:he.name,price:we,quantity:1,total:we*1,type:"lab_test"}}),ve&&ve.length===0&&(je.tests||[]).length>0&&(console.warn("Warning: Some tests from the lab order were filtered out due to missing id, name, or price.",je.tests),Q(he=>`${he?he+"; ":""}Warning: Some lab items could not be added to the bill due to missing details.`)),le="pending",xe="lab",ue=b,ce=je.patient_id,V(ve),O(le),U(xe),$(ue),ce){const he=await fe(`/api/patients/${ce}`);if(he.ok){const Ae=await he.json();tt=Ae.name,ft=Ae.phone??null,P(Ae.insurance_type??null),W(tt),T(ft)}else console.warn(`Could not fetch patient details for ID ${ce} from lab order.`),W("Patient (Not Found)")}else console.warn(`Lab Order ${b} does not have an associated patient_id.`),W("Patient (Unknown)")}else if(V(l||null),O(u||null),U(o||null),$(f||null),H(d!==void 0?parseFloat(d):null),W(a||`ID ${t}`),ce){const Re=await fe(`/api/patients/${ce}`);if(Re.ok){const je=await Re.json();T(je.phone??null),P(je.insurance_type??null)}else console.warn(`Could not fetch patient details for ID ${ce}.`)}if(r){const Re=await fe(`/api/queue/${r}`);if(Re.ok){const je=await Re.json();S(je.token_number)}else console.warn(`Could not fetch queue details for ID ${r}.`)}}catch(ce){console.error("Error fetching billing page details:",ce),Q(`Failed to load details: ${ce.message}`),V(null),O(null),U(null),$(null),W(a||""),T(null),S(null)}finally{Z(!1)}})()},[t,g,b,r,e]);const ne=M=>{console.log(`Billing process completed for patient ID ${t}. New Bill ID: ${M}`),e(-1)},A=()=>{console.log(`Bill updated for patient ID ${t}.`),e(-1)};if(!t)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-gray-600",children:[i.jsx(Zx,{size:48,className:"mb-4 text-red-500"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Missing Patient Information"}),i.jsx("p",{className:"text-sm",children:"Cannot load the billing page without a patient ID."}),i.jsx("button",{onClick:()=>e("/"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Go to Dashboard"})]});if(ee)return i.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:i.jsx("p",{className:"text-teal-600 animate-pulse",children:"Loading Billing Details..."})});if(te)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-red-600 p-4",children:[i.jsx(Zx,{size:48,className:"mb-4"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Error Loading Billing Details"}),i.jsx("p",{className:"text-sm text-center mb-4",children:te}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"}),i.jsx("button",{onClick:()=>e(-1),className:"mt-2 text-sm text-gray-600 hover:text-teal-700",children:"Go Back"})]});const se=(F??u)==="paid";return i.jsxs("div",{className:"billing-page-container",children:[i.jsx("div",{className:"back-button-container",children:i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[i.jsx(Ht,{size:20,className:"lucide"})," Back"]})}),i.jsxs("div",{className:"billing-content-wrapper",children:[i.jsxs("h3",{className:"billing-page-title",children:[g?"Bill Details":b?"Create Lab Bill":"Create Bill"," for Patient: ",q||`ID ${t}`]}),i.jsxs("div",{className:"patient-info-bar",children:[v!==null&&i.jsxs("span",{children:[i.jsx(Fd,{size:14,className:"lucide"})," Token: ",v]}),k&&i.jsxs("span",{children:[i.jsx(II,{size:14,className:"lucide"})," Phone: ",k]}),b&&i.jsxs("span",{className:"lab-order-info",children:[i.jsx(Xx,{size:14,className:"lucide"})," Lab Order: ",b.substring(0,8),"..."]}),!k&&v===null&&!b&&i.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"}),E&&i.jsxs("span",{className:"insurance-info",children:[i.jsx(WI,{size:14,className:"lucide"})," Insurance: ",E.replace(/_/g," ").replace(/\b\w/g,M=>M.toUpperCase())]}),!k&&v===null&&!b&&!E&&i.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"})]}),i.jsx(Lee,{patientId:t,labOrderId:b,queueId:r,onBillCreated:ne,onBillUpdated:A,initialItems:I??l,billType:B??o,relatedId:z??f,initialStatus:F??u,initialDiscountPercentage:R??d,readOnlyMode:se,doctorId:h,patientInsuranceType:E??void 0})]})]})},Fee=({patientId:e,labOrderId:n,onBillingSuccess:t,initialItems:r,patientName:a})=>{const[l]=w.useState(r),[o,f]=w.useState(0),[u,d]=w.useState("cash"),[h,g]=w.useState(null),[b,v]=w.useState(!1),S=w.useMemo(()=>l.reduce((E,P)=>E+P.total,0)*(1-o/100),[l,o]),k=async()=>{if(l.length===0){g("Cannot finalize an empty bill.");return}v(!0),g(null);const T={patientId:e,items:l,amount:S,paymentMode:u,type:"lab",related_id:n,status:"paid",discountPercentage:o,labOrderId:n};try{const E=await fe("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)}),P=await E.json();if(!E.ok)throw new Error(P.message||"Failed to create bill.");alert("Bill created successfully!");const I=window.open("","_blank");if(I){const V=`
                    <html>
                        <head>
                            <title>Lab Bill</title>
                            <style>
                                body { font-family: sans-serif; }
                                .bill-container { max-width: 800px; margin: auto; padding: 20px; border: 1px solid #ccc; }
                                .bill-header { text-align: center; margin-bottom: 20px; }
                                .bill-item { display: flex; justify-content: space-between; padding: 5px 0; }
                                .bill-total { text-align: right; margin-top: 20px; font-weight: bold; }
                            </style>
                        </head>
                        <body>
                            <div class="bill-container">
                                <div class="bill-header">
                                    <h2>Lab Bill for ${a}</h2>
                                </div>
                                <div class="bill-items-list">
                                    ${l.map(F=>`
                                        <div class="bill-item">
                                            <span>${F.name}</span>
                                            <span>${F.total.toFixed(2)}</span>
                                        </div>
                                    `).join("")}
                                </div>
                                <div class="bill-total">
                                    Total: ${S.toFixed(2)}
                                </div>
                            </div>
                        </body>
                    </html>
                `;I.document.write(V),I.document.close(),I.print()}t()}catch(E){g(`Failed to process bill: ${E.message}`)}finally{v(!1)}};return i.jsxs("div",{className:"billing-layout",children:[i.jsx("main",{className:"order-content",children:i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Lab Tests"})}),l.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"PRICE"})]})}),i.jsx("tbody",{children:l.map((T,E)=>i.jsxs("tr",{children:[i.jsx("td",{children:E+1}),i.jsx("td",{children:T.name}),i.jsx("td",{children:T.total.toFixed(2)})]},E))})]}):i.jsx("p",{children:"No lab tests in this order."})]})}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",l.reduce((T,E)=>T+E.total,0).toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:o,onChange:T=>f(parseFloat(T.target.value)||0),min:"0",max:"100",className:"discount-input-total",disabled:b}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",S.toFixed(2)]})]}),h&&i.jsx("p",{className:"error-message",style:{color:"red",textAlign:"center"},children:h}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:u,onChange:T=>d(T.target.value),className:"payment-mode-select",disabled:b,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsx("div",{className:"bill-actions",children:i.jsx("button",{onClick:k,className:"primary-button",disabled:b||l.length===0,children:b?"Processing...":"Finalise and Bill"})})]})})]})},$ee=()=>{const e=wt(),n=gr(),{labOrderId:t}=n.state||{},[r,a]=w.useState(null),[l,o]=w.useState(""),[f,u]=w.useState(null),[d,h]=w.useState(null),[g,b]=w.useState(null),[v,S]=w.useState(!0),[k,T]=w.useState(null);w.useEffect(()=>{if(!t){console.error("LabBillingPage loaded without a labOrderId."),e("/");return}(async()=>{S(!0),T(null);try{const I=await fe(`/api/lab/${t}`);if(!I.ok){const O=await I.json().catch(()=>({}));throw new Error(O.message||`Failed to fetch lab order details (Status: ${I.status})`)}const V=await I.json(),F=(V.tests||[]).filter(O=>O&&typeof O.name=="string"&&O.price!==void 0&&O.id!==void 0).map(O=>{const B=parseFloat(O.price||"0"),U=!isNaN(B)&&isFinite(B)?B:0;return{drug_id:O.id,name:O.name,price:U,quantity:1,total:U,type:"lab_test"}});if(b(F),V.patient_id){a(V.patient_id);const O=await fe(`/api/patients/${V.patient_id}`);if(O.ok){const B=await O.json();o(B.name),u(B.phone??null),h(B.insurance_type??null)}else o("Patient (Not Found)")}else throw new Error("Lab order does not have an associated patient.")}catch(I){console.error("Error fetching lab billing details:",I),T(`Failed to load details: ${I.message}`)}finally{S(!1)}})()},[t,e]);const E=()=>{console.log(`Lab billing process completed for Lab Order ID: ${t}`),e(-1)};return t?v?i.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:i.jsx("p",{className:"text-teal-600 animate-pulse",children:"Loading Lab Bill..."})}):k?i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-red-600 p-4",children:[i.jsx(Zx,{size:48,className:"mb-4"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Error Loading Lab Bill"}),i.jsx("p",{className:"text-sm text-center mb-4",children:k}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"}),i.jsx("button",{onClick:()=>e(-1),className:"mt-2 text-sm text-gray-600 hover:text-teal-700",children:"Go Back"})]}):i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(Ht,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Lab Bill"})]}),i.jsx("div",{className:"billing-layout",children:i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Patient Name:"})," ",l]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Phone:"})," ",f||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Lab Order ID:"})," ",t]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Insurance:"})," ",d?d.replace(/_/g," "):"N/A"]})]})]}),r&&g&&i.jsx(Fee,{patientId:r,labOrderId:t,onBillingSuccess:E,initialItems:g,patientInsuranceType:d,patientName:l})]})})]})}):i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-gray-600",children:[i.jsx(Zx,{size:48,className:"mb-4 text-red-500"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Missing Lab Order Information"}),i.jsx("p",{className:"text-sm",children:"Cannot load the lab billing page without a lab order ID."}),i.jsx("button",{onClick:()=>e("/"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Go to Dashboard"})]})},zee=()=>{const{patientId:e}=Rr(),n=wt(),[t,r]=w.useState([]),[a,l]=w.useState(!1),[o,f]=w.useState(null),[u,d]=w.useState("");return w.useEffect(()=>{(async()=>{if(!e){f("Patient ID not provided in URL.");return}l(!0),f(null),r([]);try{try{const v=await fe(`/api/patients/${e}`);if(v.ok){const S=await v.json();d(S.name)}}catch(v){console.warn("Could not fetch patient name:",v)}console.log(`Fetching pharmacy orders for patient ID: ${e}`);const g=await fe(`/api/pharmacy-orders/patient/${e}`);if(!g.ok){const v=await g.json().catch(()=>({}));throw new Error(v.message||`HTTP error! status: ${g.status}`)}const b=await g.json();console.log("Fetched Pharmacy Orders:",b),r(b||[])}catch(g){console.error("Error fetching pharmacy orders:",g),f(`Failed to load pharmacy orders: ${g.message}`)}finally{l(!1)}})()},[e]),i.jsxs("div",{className:"p-4 md:p-6 max-w-4xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6 border-b pb-3",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-900",children:[i.jsx(Ht,{size:16,className:"mr-1"}),"Back"]}),i.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[i.jsx(Ud,{size:20,className:"mr-2 text-purple-600"}),"Pharmacy Order History ",u&&`for ${u}`]}),i.jsx("div",{})," "]}),a&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading pharmacy orders..."}),o&&i.jsx("p",{className:"text-center text-red-500 bg-red-100 p-3 rounded border border-red-300",children:o}),!a&&t.length===0&&!o&&i.jsx("p",{className:"text-center text-gray-500",children:"No pharmacy orders found for this patient."}),!a&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(h=>i.jsxs("div",{className:"p-4 border rounded bg-white shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Date:"})," ",new Date(h.date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm font-medium capitalize",children:[i.jsx("strong",{children:"Status:"})," ",h.status]})]}),i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Prescribed By:"})," ",h.prescribedBy||"N/A"]}),h.dispensedBy&&i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Dispensed By:"})," ",h.dispensedBy]}),i.jsx("h4",{className:"text-md font-semibold mt-3 mb-1",children:"Medications:"}),i.jsx("ul",{className:"list-disc list-inside ml-4 text-sm text-gray-700 space-y-1",children:h.medications.map((g,b)=>i.jsxs("li",{children:[g.name," - Qty: ",g.quantity,g.tabletsPerDay&&` (${g.tabletsPerDay} per day`,g.numberOfDays&&` for ${g.numberOfDays} days)`,!g.tabletsPerDay&&g.numberOfDays&&` (for ${g.numberOfDays} days)`,g.tabletsPerDay&&!g.numberOfDays&&")"]},b))})]},h.id))})]})},JC=()=>{const e=wt(),n=gr(),[t,r]=w.useState(null),[a,l]=w.useState([]),[o,f]=w.useState([]),[u,d]=w.useState(""),[h,g]=w.useState([]),[b,v]=w.useState(null),[S,k]=w.useState(!1),[T,E]=w.useState(null),[P,I]=w.useState(!0),[V,F]=w.useState(""),[O,B]=w.useState([]),[U,z]=w.useState(!1),[$,R]=w.useState(null),[H,ee]=w.useState(!1),[Z,te]=w.useState(!1),[Q,q]=w.useState([]),W=/^\+?[0-9\s\-().]{7,20}$/,ne=/^[a-zA-Z\s'-]{2,}$/,A=w.useCallback(async()=>{try{const we=await fe("/api/drugs");if(!we.ok)throw new Error("Failed to fetch drugs");const Me=await we.json();l(Me)}catch(we){console.error("Failed to fetch available drugs:",we),v("Could not load drug list. "+we.message)}},[]),ie=w.useCallback(async we=>{try{const Me=await fe(`/api/pharmacy-orders/patient/${we}`);if(!Me.ok){const Je=await Me.json().catch(()=>({}));throw new Error(Je.message||`HTTP error! status: ${Me.status}`)}const De=await Me.json();q(De||[])}catch(Me){console.error("Failed to fetch previous pharmacy orders:",Me)}finally{}},[]);w.useEffect(()=>{var we;A(),(we=n.state)!=null&&we.patient?ce(n.state.patient):I(!0)},[A,n.state]),w.useEffect(()=>{t!=null&&t.id?ie(t.id):q([])},[t,ie]),w.useEffect(()=>{if(!u){g([]);return}const we=u.toLowerCase();g(a.filter(Me=>{const De=Me.name&&Me.name.toLowerCase().includes(we),Je=Me.brand_name&&Me.brand_name.toLowerCase().includes(we);return De||Je}).slice(0,10))},[u,a]);const se=w.useMemo(()=>kb(async we=>{if(we.trim().length<2){B([]),z(!1),R(null);return}z(!0),R(null);try{const Me=new URLSearchParams({search:encodeURIComponent(we),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),De=await fe(`/api/patients?${Me.toString()}`);if(!De.ok)throw new Error("API Error");const Je=await De.json();B(Je.patients)}catch(Me){console.error("Error searching patients:",Me),R(Me.message||"Failed to search patients."),B([])}finally{z(!1)}},300),[W]),M=we=>{const Me=we.target.value;F(Me),ee(W.test(Me)),te(ne.test(Me)&&!W.test(Me)),z(!0),se(Me)},ce=w.useCallback(we=>{r(we),I(!1),F(""),B([]),R(null)},[]),ve=w.useCallback(async we=>{if(!V||we==="phone"&&!H||we==="name"&&!Z){R(`Invalid ${we} to create a new patient.`);return}z(!0),R(null);try{const Je=await(await fe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:we==="name"?V:"direct pharmacy",phone:we==="phone"?V:null,age:null,gender:null,token:null})})).json();ce(Je)}catch(Me){const De=Me.message||"";if(De.toLowerCase().includes("patient limit")){e("/start-clinic-subscription",{state:{errorMessage:De}});return}R(De||"Failed to create new patient.")}finally{z(!1)}},[V,H,Z,ce]),le=()=>{r(null),I(!0),f([]),v(null),q([])},xe=we=>{if(!we)return null;const Me=we.match(/(?:\d+x)?(\d+)/);return Me?parseInt(Me[1],10):null},ue=we=>{if(o.some(Me=>Me.drug_id===we.id)){v(`${we.name||we.brand_name} is already in the order.`),setTimeout(()=>v(null),3e3),d(""),g([]);return}f(Me=>[...Me,{drug_id:we.id,name:we.name||we.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,tabletsPerDay:1,numberOfDays:1,price:Number(we.price)||0,originalPrice:Number(we.price)||0,stock:we.quantity_in_stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(we.price)||0)/(xe(we.unit)||1),unit:we.unit}]),d(""),g([])},ze=()=>{const we=u.trim();we&&e("/dashboard/inventory/add",{state:{initialDrugName:we}})},tt=we=>{f(Me=>Me.filter(De=>(De.drug_id??De.name)!==we))},ft=(we,Me)=>{f(De=>De.map(Je=>{if((Je.drug_id??Je.name)===we&&Je.isLoose){const nt=xe(Je.unit),Ge=Math.max(0,Me),St=Ge*(nt??1)+(Je.looseUnits??0);return{...Je,loosePacks:Ge,looseQuantity:St}}return Je}))},Re=(we,Me)=>{f(De=>De.map(Je=>{if((Je.drug_id??Je.name)===we&&Je.isLoose){const nt=xe(Je.unit),Ge=Math.max(0,Me),St=(Je.loosePacks??0)*(nt??1)+Ge;return{...Je,looseUnits:Ge,looseQuantity:St}}return Je}))},je=we=>{const Me=[];we.medications.forEach(De=>{if(!o.find(nt=>nt.drug_id&&De.drug_id&&nt.drug_id===De.drug_id||nt.name.toLowerCase()===De.name.toLowerCase())){let nt=De.drug_id,Ge=De.drug_id?a.find(St=>St.id===De.drug_id):void 0;if(!Ge&&De.name){const St=a.find(It=>It.name&&It.name.toLowerCase()===De.name.toLowerCase());St?(nt=St.id,Ge=St):nt&&(nt=null)}Me.push({drug_id:nt,name:De.name,pack_quantity:De.pack_quantity??0,loose_quantity:De.loose_quantity??0,directions_to_use:De.directions_to_use,tabletsPerDay:De.tabletsPerDay??1,numberOfDays:De.numberOfDays??1,price:Ge?Ge.price:De.price,stock:Ge?Ge.quantity_in_stock:De.stock,isLoose:!0,loosePacks:0,looseUnits:(De.pack_quantity??0)*(xe((Ge==null?void 0:Ge.unit)||De.unit)??1)+(De.loose_quantity??0),looseQuantity:(De.pack_quantity??0)*(xe((Ge==null?void 0:Ge.unit)||De.unit)??1)+(De.loose_quantity??0),pricePerLooseUnit:(Ge?Number(Ge.price):Number(De.price)||0)/(xe((Ge==null?void 0:Ge.unit)||De.unit)||1),unit:(Ge==null?void 0:Ge.unit)||De.unit})}}),f(De=>[...De,...Me]),we.prescriptionForUnavailableDrugs&&(!T||!T.includes(we.prescriptionForUnavailableDrugs))&&E(De=>De?`${De}

-- From previous order --
${we.prescriptionForUnavailableDrugs}`:we.prescriptionForUnavailableDrugs),v("Medications from previous order added."),setTimeout(()=>v(null),3e3)},he=async we=>{if(we.preventDefault(),v(null),k(!0),!t){v("No patient selected."),k(!1);return}if(o.length===0&&!(T!=null&&T.trim())){v("Add medication or prescription notes."),k(!1);return}const Me={patient_id:t.id,items:o.map(De=>{const Je=Number(De.price??0),nt=Number(De.pricePerLooseUnit??0),Ge=Number((nt*(De.looseQuantity??0)).toFixed(2));return{drug_id:De.drug_id||null,name:De.name,pack_quantity:De.loosePacks??0,loose_quantity:De.looseUnits??0,pack_price:Je,loose_price:nt,total_price:Ge,price:Number(De.originalPrice??0),directions_to_use:De.directions_to_use??null,tabletsPerDay:Number(De.tabletsPerDay??1),numberOfDays:Number(De.numberOfDays??1)}}),order_total:Ae,prescription_for_unavailable_drugs:T};try{const De=await fe("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Me)});if(!De.ok)throw new Error("Order creation failed");await De.json(),alert(`Order created successfully for ${t.name}!`);let Je=t.queueId;if(!Je)try{const nt=await fe(`/api/queue/patient/${t.id}/latest`);if(nt.ok){const Ge=await nt.json();Ge!=null&&Ge._id&&(Je=Ge._id)}}catch(nt){console.error("Error checking queue:",nt)}if(!Je)try{const nt=await fe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:t.id})});if(nt.ok){const Ge=await nt.json();Ge!=null&&Ge.id&&(Je=Ge.id)}}catch(nt){console.error("Error creating queue:",nt)}Je?e(`/dashboard/edit-complaint/${Je}`,{state:{patientId:t.id}}):e(-1)}catch(De){v(De.message||"Failed to create order.")}finally{k(!1)}},Ae=w.useMemo(()=>o.reduce((we,Me)=>{const De=Me.isLoose?Me.pricePerLooseUnit??0:Me.price??0,Je=Me.isLoose?Me.looseQuantity??0:Me.quantity??0;return we+De*Je},0),[o]);return i.jsxs("div",{className:"add-pharmacy-order-page p-4 md:p-8 max-w-7xl mx-auto",children:[i.jsx("div",{className:"page-header",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:i.jsx(Ht,{size:20})}),i.jsx("h2",{children:"Create Pharmacy Order"})]})}),b&&i.jsxs("div",{className:"bg-red-900/20 border border-red-500/50 text-red-200 p-4 rounded-xl mb-6 flex items-start gap-3 animate-fade-in",children:[i.jsx(si,{className:"shrink-0 mt-0.5",size:18}),i.jsx("span",{children:b})]}),P&&i.jsx("div",{className:"max-w-2xl mx-auto mt-10",children:i.jsxs("div",{className:"content-panel",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(Ys,{size:20,className:"text-indigo-400"})," Select Patient"]}),i.jsxs("div",{className:"patient-search-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(vi,{className:"search-icon",size:20}),i.jsx("input",{type:"text",placeholder:"Search by Name, Token # or Phone...",value:V,onChange:M,className:"custom-text-input",autoFocus:!0}),U&&i.jsx("div",{className:"pr-4 text-xs text-indigo-400 animate-pulse",children:"Searching..."})]}),$&&i.jsx("p",{className:"text-red-400 text-sm mt-2 pl-1 animate-fadeIn",children:$}),O.length>0&&i.jsx("div",{className:"search-results-dropdown",children:O.map(we=>i.jsxs("div",{onClick:()=>ce(we),className:"search-result-item",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsxs("span",{className:"text-white font-medium flex items-center",children:[i.jsxs("span",{className:"token-badge",children:["#",we.token]}),we.name]}),i.jsxs("span",{className:"text-xs text-gray-400 mt-1 pl-1",children:[we.gender,"  ",we.age," yrs  ",we.phone||"No phone"]})]}),i.jsx(Kx,{size:16,className:"text-gray-600 -rotate-90"})]},we.id))}),!U&&V.length>2&&O.length===0&&i.jsxs("div",{className:"mt-4 p-4 bg-zinc-800/50 rounded-lg text-center border border-dashed border-zinc-700",children:[i.jsxs("p",{className:"text-gray-400 mb-3 text-sm",children:['No patient found matching "',V,'"']}),i.jsxs("div",{className:"flex justify-center gap-3",children:[H&&i.jsx("button",{onClick:()=>ve("phone"),className:"px-4 py-2 bg-green-600/20 text-green-400 border border-green-600/50 rounded-lg text-sm hover:bg-green-600/30 transition-colors",children:"Create with Phone"}),Z&&i.jsx("button",{onClick:()=>ve("name"),className:"px-4 py-2 bg-indigo-600/20 text-indigo-400 border border-indigo-600/50 rounded-lg text-sm hover:bg-indigo-600/30 transition-colors",children:"Create with Name"})]})]})]})]})}),!P&&t&&i.jsxs("form",{onSubmit:he,className:"pharmacy-order-grid animate-fade-in",children:[i.jsxs("div",{className:"order-main-column",children:[i.jsxs("div",{className:"content-panel mb-6",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(vi,{size:18,className:"text-indigo-400"})," Add Medication"]}),i.jsxs("div",{className:"relative drug-search-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(vi,{className:"search-icon",size:18}),i.jsx("input",{type:"text",placeholder:"Search for drugs...",value:u,onChange:we=>d(we.target.value),className:"custom-text-input"})]}),h.length>0&&i.jsx("div",{className:"search-results-dropdown",children:h.map(we=>i.jsx("div",{onClick:()=>ue(we),className:"search-result-item",children:i.jsxs("div",{className:"flex justify-between w-full",children:[i.jsxs("div",{children:[i.jsx("span",{className:"drug-name",children:we.name||we.brand_name}),i.jsxs("span",{className:"drug-meta text-xs",children:["Stock: ",we.quantity_in_stock]})]}),i.jsx("div",{className:"text-right",children:i.jsxs("span",{className:"text-indigo-300 font-mono",children:["",Number(we.price).toFixed(2)]})})]})},we.id))}),u&&h.length===0&&!a.find(we=>{var Me;return((Me=we.name)==null?void 0:Me.toLowerCase())===u.toLowerCase()})&&i.jsx("div",{className:"search-results-dropdown p-2",children:i.jsxs("button",{type:"button",onClick:ze,className:"w-full text-left px-4 py-2 text-indigo-400 hover:bg-zinc-800 rounded-lg text-sm transition-colors",children:['+ Add "',u,'" to Inventory']})})]})]}),i.jsxs("div",{className:"content-panel min-h-[400px]",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(Uo,{size:18,className:"text-indigo-400"})," Order Items (",o.length,")"]}),o.length===0?i.jsxs("div",{className:"empty-state",children:[i.jsx(Uo,{size:48,className:"empty-icon mx-auto",strokeWidth:1}),i.jsx("p",{className:"empty-text",children:"No medications added yet"}),i.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Search above to add items to the order"})]}):i.jsx("div",{className:"order-table-container",children:i.jsxs("table",{className:"order-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{width:"30%"},children:"Drug Name"}),i.jsx("th",{children:"Dosage / Directions"}),i.jsx("th",{children:"Qty (Packs/Loose)"}),i.jsx("th",{children:"Price"}),i.jsx("th",{})]})}),i.jsx("tbody",{children:o.map((we,Me)=>{const De=we.drug_id??we.name,Je=(we.pricePerLooseUnit??0)*(we.looseQuantity??0);return i.jsxs("tr",{className:"group",children:[i.jsxs("td",{children:[i.jsx("span",{className:"drug-name",children:we.name}),i.jsxs("span",{className:"drug-meta",children:["Stock: ",we.stock,"  Box of ",xe(we.unit)||1]})]}),i.jsx("td",{children:i.jsx("div",{className:"flex flex-col gap-2",children:i.jsx("input",{type:"text",placeholder:"Directions...",value:we.directions_to_use||"",onChange:nt=>{const Ge=nt.target.value;f(St=>St.map(It=>(It.drug_id??It.name)===De?{...It,directions_to_use:Ge}:It))},className:"table-input w-full"})})}),i.jsx("td",{children:i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("div",{className:"qty-input-group",children:[i.jsx("span",{className:"text-xs text-gray-500 w-8",children:"Pks:"}),i.jsx("input",{type:"number",min:"0",value:we.loosePacks,onChange:nt=>ft(De,parseInt(nt.target.value,10)),className:"table-input medium"})]}),i.jsxs("div",{className:"qty-input-group",children:[i.jsx("span",{className:"text-xs text-gray-500 w-8",children:"Unit:"}),i.jsx("input",{type:"number",min:"0",value:we.looseUnits,onChange:nt=>Re(De,parseInt(nt.target.value,10)),className:"table-input medium"})]})]})}),i.jsx("td",{children:i.jsxs("div",{className:"font-mono text-sm",children:["",Je.toFixed(2)]})}),i.jsx("td",{children:i.jsx("button",{type:"button",onClick:()=>tt(De),className:"delete-btn opacity-0 group-hover:opacity-100",title:"Remove Item",children:i.jsx(Oi,{size:16})})})]},`${De}-${Me}`)})})]})})]}),i.jsxs("div",{className:"content-panel",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(ps,{size:18,className:"text-indigo-400"})," Additional Notes / Prescription"]}),i.jsx("textarea",{value:T??"",onChange:we=>E(we.target.value||null),placeholder:"Enter notes for unavailable drugs or special instructions...",className:"custom-text-input bg-zinc-900/50 min-h-[100px] border border-zinc-800 rounded-lg resize-y"})]})]}),i.jsxs("div",{className:"order-sidebar",children:[i.jsxs("div",{className:"patient-card mb-6",children:[i.jsx("div",{className:"patient-avatar",children:t.name.charAt(0).toUpperCase()}),i.jsx("h3",{className:"patient-name",children:t.name}),i.jsx("div",{className:"patient-meta",children:i.jsxs("span",{children:["Token: #",t.token]})}),i.jsxs("div",{className:"patient-detail-grid",children:[i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Age / Gender"}),i.jsxs("p",{children:[t.age||"--"," / ",t.gender||"--"]})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Phone"}),i.jsx("p",{children:t.phone||"--"})]})]}),i.jsx("button",{type:"button",onClick:le,className:"change-patient-btn",children:"Change Patient"})]}),Q.length>0&&i.jsxs("div",{className:"content-panel mb-6 p-4",children:[i.jsxs("div",{className:"section-title text-sm mb-3",children:[i.jsx(WP,{size:16,className:"text-indigo-400"})," Recent Orders"]}),i.jsx("div",{className:"max-h-[200px] overflow-y-auto pr-1 custom-scrollbar",children:Q.map(we=>i.jsxs("div",{className:`prev-order-item status-${we.status}`,children:[i.jsxs("div",{className:"prev-order-header",children:[i.jsx("span",{className:"prev-order-date",children:new Date(we.date).toLocaleDateString()}),i.jsx("span",{className:`status-badge ${we.status}`,children:we.status})]}),i.jsx("div",{className:"text-xs text-gray-500 mb-2 truncate",children:we.medications.map(Me=>Me.name).join(", ")}),i.jsx("button",{type:"button",onClick:()=>je(we),className:"add-prev-btn",children:"+ Add items"})]},we.id))})]}),i.jsxs("div",{className:"content-panel order-summary-container",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(O_,{size:18,className:"text-indigo-400"})," Summary"]}),i.jsx("div",{className:"summary-details",children:i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Items"}),i.jsx("span",{children:o.length})]})}),i.jsxs("div",{className:"summary-total",children:[i.jsx("span",{className:"total-label",children:"Grand Total"}),i.jsxs("span",{className:"total-value",children:["",Ae.toFixed(2)]})]}),i.jsxs("button",{type:"submit",disabled:S||o.length===0&&!T,className:"create-order-btn",children:[S?i.jsx("div",{className:"spinner"}):i.jsx(Zm,{size:20}),S?"Processing...":"Create Order"]})]})]})]})]})},yT=()=>{var Q;const{orderId:e}=Rr(),n=wt(),[t,r]=w.useState(null),[a,l]=w.useState(null),[o,f]=w.useState([]),[u,d]=w.useState([]),[h,g]=w.useState(""),[b,v]=w.useState([]),[S,k]=w.useState(null),[T,E]=w.useState(!1),[P,I]=w.useState(null),[V,F]=w.useState(!0),O=q=>{if(!q)return null;const W=q.match(/(?:\d+x)?(\d+)/);return W?parseInt(W[1],10):null},B=w.useCallback(async()=>{F(!0);try{const q=await fe(`/api/pharmacy-orders/${e}`);if(!q.ok)throw new Error("Failed to fetch order details");const W=await q.json();r(W),l({id:W.patientId,name:W.patientName||"N/A",token:W.patientTokenNumber}),I(W.prescriptionForUnavailableDrugs);const ne=W.medications.map(A=>{const ie=O(A.unit),se=A.pack_quantity*(ie??1)+A.loose_quantity;return{...A,isLoose:!0,loosePacks:A.pack_quantity,looseUnits:A.loose_quantity,looseQuantity:se,pack_price:A.pack_price,loose_price:A.loose_price,total_price:A.total_price,pricePerLooseUnit:A.loose_price,originalPrice:A.pack_price,box_number:A.box_number,unit:A.unit,batch:A.batch,expiry_date:A.expiry_date,discount_percentage:A.discount_percentage}});d(ne)}catch(q){k("Could not load order details. "+q.message)}finally{F(!1)}},[e]),U=w.useCallback(async()=>{try{const q=await fe("/api/drugs");if(!q.ok)throw new Error("Failed to fetch drugs");const W=await q.json();f(W)}catch(q){k("Could not load drug list. "+q.message)}},[]);w.useEffect(()=>{B(),U()},[B,U]),w.useEffect(()=>{if(!h){v([]);return}const q=h.toLowerCase();v(o.filter(W=>{const ne=W.name&&W.name.toLowerCase().includes(q),A=W.brand_name&&W.brand_name.toLowerCase().includes(q);return ne||A}).slice(0,10))},[h,o]);const z=q=>{if(u.some(W=>W.drug_id===q.id)){k(`${q.name||q.brand_name} is already in the order.`),setTimeout(()=>k(null),3e3),g(""),v([]);return}d(W=>[...W,{drug_id:q.id,name:q.name||q.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,pack_price:Number(q.price)||0,loose_price:(Number(q.price)||0)/(O(q.unit)||1),total_price:(Number(q.price)||0)/(O(q.unit)||1),discount_percentage:0,directions_to_use:"",tabletsPerDay:1,numberOfDays:1,stock:q.quantity_in_stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(q.price)||0)/(O(q.unit)||1),originalPrice:Number(q.price)||0,unit:q.unit}]),g(""),v([])},$=q=>{d(W=>W.filter(ne=>(ne.drug_id??ne.name)!==q))},R=(q,W)=>{d(ne=>ne.map(A=>{if((A.drug_id??A.name)===q&&A.isLoose){const ie=O(A.unit),se=Math.max(0,W),M=se*(ie??1)+(A.looseUnits??0);return{...A,loosePacks:se,looseQuantity:M,pack_quantity:se}}return A}))},H=(q,W)=>{d(ne=>ne.map(A=>{if((A.drug_id??A.name)===q&&A.isLoose){const ie=O(A.unit),se=Math.max(0,W),M=(A.loosePacks??0)*(ie??1)+se;return{...A,looseUnits:se,looseQuantity:M,loose_quantity:se}}return A}))},ee=w.useMemo(()=>u.reduce((q,W)=>{const ne=W.loose_price??0,A=W.looseQuantity??0;return q+ne*A},0),[u]),Z=(Number(ee)||0).toFixed(2),te=async q=>{if(q.preventDefault(),k(null),E(!0),u.length===0&&!(P!=null&&P.trim())){k("Please add at least one medication or provide a prescription."),E(!1);return}const W={items:u.map(ne=>({drug_id:ne.drug_id??null,name:ne.name,pack_quantity:ne.loosePacks??0,loose_quantity:ne.looseUnits??0,pack_price:ne.pack_price??0,loose_price:ne.loose_price??0,total_price:(ne.loose_price??0)*(ne.looseQuantity??0),discount_percentage:ne.discount_percentage??0,directions_to_use:ne.directions_to_use??null,tabletsPerDay:ne.tabletsPerDay??1,numberOfDays:ne.numberOfDays??1})),prescription_for_unavailable_drugs:P,order_total:ee};try{if(!(await fe(`/api/pharmacy-orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(W)})).ok)throw new Error("Failed to update order");alert("Pharmacy order updated successfully!"),n(-1)}catch(ne){k(ne.message||"Failed to update order.")}finally{E(!1)}};return V?i.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading order details..."}):t?i.jsxs("div",{className:"add-pharmacy-order-page p-4 md:p-8 max-w-7xl mx-auto",children:[i.jsx("div",{className:"page-header",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"back-button",title:"Go Back",children:i.jsx(Ht,{size:20})}),i.jsxs("div",{children:[i.jsx("h2",{children:"Edit Order"}),i.jsxs("span",{className:"text-sm text-gray-500 font-mono",children:["#",t.id.substring(0,8)]})]})]})}),i.jsxs("form",{onSubmit:te,className:"pharmacy-order-grid animate-fade-in",children:[i.jsxs("div",{className:"order-main-column",children:[i.jsxs("div",{className:"content-panel mb-6",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(vi,{size:18,className:"text-indigo-400"})," Add Medication"]}),i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(vi,{className:"search-icon",size:18}),i.jsx("input",{type:"text",placeholder:"Search for drugs...",value:h,onChange:q=>g(q.target.value),className:"custom-text-input"})]}),b.length>0&&i.jsx("div",{className:"search-results-dropdown",children:b.map(q=>i.jsx("div",{onClick:()=>z(q),className:"search-result-item",children:i.jsxs("div",{className:"flex justify-between w-full",children:[i.jsxs("div",{children:[i.jsx("span",{className:"drug-name",children:q.name||q.brand_name}),i.jsxs("span",{className:"drug-meta text-xs",children:["Stock: ",q.quantity_in_stock]})]}),i.jsx("div",{className:"text-right",children:i.jsxs("span",{className:"text-indigo-300 font-mono",children:["",Number(q.price).toFixed(2)]})})]})},q.id))})]})]}),i.jsxs("div",{className:"content-panel min-h-[400px]",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(Uo,{size:18,className:"text-indigo-400"})," Order Items (",u.length,")"]}),u.length===0?i.jsxs("div",{className:"empty-state",children:[i.jsx(Uo,{size:48,className:"empty-icon mx-auto",strokeWidth:1}),i.jsx("p",{className:"empty-text",children:"No medications in order"})]}):i.jsx("div",{className:"order-table-container",children:i.jsxs("table",{className:"order-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{width:"30%"},children:"Drug Name"}),i.jsx("th",{children:"Directions"}),i.jsx("th",{children:"Qty (Packs/Loose)"}),i.jsx("th",{children:"Price"}),i.jsx("th",{})]})}),i.jsx("tbody",{children:u.map((q,W)=>{const ne=q.drug_id??q.name,A=(q.loose_price??0)*(q.looseQuantity??0);return i.jsxs("tr",{className:"group",children:[i.jsxs("td",{children:[i.jsx("span",{className:"drug-name",children:q.name}),i.jsxs("span",{className:"drug-meta",children:["Stock: ",q.stock,"  Box of ",O(q.unit)||1]})]}),i.jsx("td",{children:i.jsx("input",{type:"text",placeholder:"Directions...",value:q.directions_to_use||"",onChange:ie=>{const se=ie.target.value;d(M=>M.map(ce=>(ce.drug_id??ce.name)===ne?{...ce,directions_to_use:se}:ce))},className:"table-input w-full"})}),i.jsx("td",{children:i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("div",{className:"qty-input-group",children:[i.jsx("span",{className:"text-xs text-gray-500 w-8",children:"Pks:"}),i.jsx("input",{type:"number",min:"0",value:q.loosePacks,onChange:ie=>R(ne,parseInt(ie.target.value,10)),className:"table-input medium"})]}),i.jsxs("div",{className:"qty-input-group",children:[i.jsx("span",{className:"text-xs text-gray-500 w-8",children:"Unit:"}),i.jsx("input",{type:"number",min:"0",value:q.looseUnits,onChange:ie=>H(ne,parseInt(ie.target.value,10)),className:"table-input medium"})]})]})}),i.jsx("td",{children:i.jsxs("div",{className:"font-mono text-sm",children:["",A.toFixed(2)]})}),i.jsx("td",{children:i.jsx("button",{type:"button",onClick:()=>$(ne),className:"delete-btn opacity-0 group-hover:opacity-100",title:"Remove Item",children:i.jsx(Oi,{size:16})})})]},`${ne}-${W}`)})})]})})]}),i.jsxs("div",{className:"content-section mt-6",children:[i.jsx("label",{className:"text-sm font-medium text-gray-400 mb-2 block",children:"Prescription Notes"}),i.jsx("textarea",{rows:3,value:P??"",onChange:q=>I(q.target.value||null),placeholder:"Additional notes...",className:"custom-text-input bg-zinc-900/50 border border-zinc-800 rounded-lg w-full resize-none"})]})]}),i.jsxs("div",{className:"order-sidebar",children:[i.jsxs("div",{className:"patient-card mb-6",children:[i.jsx("div",{className:"patient-avatar",children:((Q=a==null?void 0:a.name)==null?void 0:Q.charAt(0).toUpperCase())||i.jsx(Ys,{})}),i.jsx("h3",{className:"patient-name",children:a==null?void 0:a.name}),i.jsx("div",{className:"patient-meta",children:i.jsxs("span",{children:["Token: #",(a==null?void 0:a.token)||"N/A"]})}),i.jsxs("div",{className:"flex justify-between border-t border-gray-700 pt-3 mt-3 px-2",children:[i.jsxs("span",{className:"text-sm text-gray-400 flex items-center gap-1",children:[i.jsx(Fh,{size:14})," Date"]}),i.jsx("span",{className:"text-sm text-white",children:new Date(t.date).toLocaleDateString()})]}),i.jsxs("div",{className:"flex justify-between pt-2 px-2",children:[i.jsx("span",{className:"text-sm text-gray-400",children:"Status"}),i.jsx("span",{className:`status-badge ${t.status}`,children:t.status})]})]}),i.jsxs("div",{className:"content-panel order-summary-container",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(O_,{size:18,className:"text-indigo-400"})," Summary"]}),i.jsx("div",{className:"summary-details",children:i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Item Count"}),i.jsx("span",{children:u.length})]})}),i.jsxs("div",{className:"summary-total",children:[i.jsx("span",{className:"total-label",children:"Grand Total"}),i.jsxs("span",{className:"total-value",children:["",Z]})]}),S&&i.jsxs("div",{className:"p-3 bg-red-900/20 border border-red-500/50 rounded-lg flex items-start gap-2 text-sm text-red-200",children:[i.jsx(si,{size:16,className:"shrink-0 mt-0.5"}),i.jsx("span",{children:S})]}),i.jsxs("button",{type:"submit",disabled:T,className:`floating-action-btn ${T?"disabled":""}`,children:[T?i.jsx("div",{className:"spinner"}):i.jsx(Zm,{size:20,className:"btn-icon"}),T?"Updating...":"Update Order"]})]})]})]})]}):i.jsx("div",{className:"p-8 text-center text-red-400",children:"Order not found."})},Bee=(e,n,t,r="non-black")=>{if(isNaN(e)||isNaN(n)||e<=0||n<=0)return null;let a;return t==="female"?e<=.7?a=141*Math.pow(e/.7,-.329)*Math.pow(.993,n):a=141*Math.pow(e/.7,-1.209)*Math.pow(.993,n):e<=.9?a=141*Math.pow(e/.9,-.411)*Math.pow(.993,n):a=141*Math.pow(e/.9,-1.209)*Math.pow(.993,n),r==="black"&&(a*=1.018),parseFloat(a.toFixed(2))},Uee=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0||t>=400)return null;const r=e-n-t/5;return parseFloat(r.toFixed(2))},qee=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},Vee=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},Hee=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=e-(n+t);return parseFloat(r.toFixed(2))},Gee=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=2*e+n/18+t/2.8;return parseFloat(r.toFixed(2))},KC=e=>["eGFR","LDL Cholesterol","Indirect Bilirubin","Globulin","Anion Gap","Osmolality"].includes(e),XC=()=>{var Z,te,Q;const{orderId:e}=Rr(),n=wt(),[t,r]=w.useState(null),[a,l]=w.useState({}),[o,f]=w.useState(!0),[u,d]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(null),[S,k]=w.useState(null),[T,E]=w.useState({}),[P,I]=w.useState(null),V=q=>{const W=document.querySelector(`[data-test-id='${q}']`);W&&(document.body.classList.add("printing-single-test"),W.classList.add("printing"),window.print())};w.useEffect(()=>{const q=()=>{document.body.classList.remove("printing-single-test");const W=document.querySelector(".printing");W&&W.classList.remove("printing")};return window.addEventListener("afterprint",q),()=>{window.removeEventListener("afterprint",q)}},[]);const F=()=>{t&&yw(t)},O=w.useCallback(async q=>{var W;try{const ne=await fe(`/api/patients/${q}`);if(!ne.ok)throw new Error(`Failed to fetch patient details: ${ne.status}`);const A=await ne.json();v(A.age),k(((W=A.sex)==null?void 0:W.toLowerCase())==="female"?"female":"male")}catch(ne){console.error("Error fetching patient details:",ne),v(null),k(null)}},[]),B=w.useCallback(async()=>{if(e){f(!0),g(null);try{const q=await fe(`/api/lab/${e}`);if(!q.ok){const A=await q.json().catch(()=>({message:`HTTP error! status: ${q.status}`}));throw new Error(A.message||`HTTP error! status: ${q.status}`)}const W=await q.json();r(W),W.patient_id&&O(W.patient_id);const ne={};if(W.tests&&W.tests.forEach(A=>{ne[A.id]={},A.default_parameters&&A.default_parameters.length>0?A.default_parameters.forEach(ie=>{ne[A.id][ie.name]=ie.defaultValue}):ne[A.id].report_content=""}),W.report_content)try{const A=JSON.parse(W.report_content);if(typeof A=="object"&&A!==null&&!Array.isArray(A)){const ie={...ne};Object.keys(A).forEach(se=>{ie[se]?ie[se]={...ie[se],...A[se]}:ie[se]=A[se]}),l(ie)}else console.warn("Legacy or unexpected report content format detected. Initializing with defaults."),l(ne)}catch{console.warn("Legacy report content detected (not JSON). Initializing with defaults."),l(ne)}else l(ne)}catch(q){console.error("Failed to fetch lab order details:",q),g(q instanceof Error?q.message:"An unknown error occurred while fetching order details.")}finally{f(!1)}}},[e,O]);w.useEffect(()=>{e?B():(g("No Order ID provided in the URL."),f(!1))},[e,B]);const U=(q,W,ne)=>{l(A=>{var Me,De,Je,nt,Ge,St,It,Vt,oe,J,de,Be,be,Fe,$e,st,rt,Le,Ve;const ie={...A,[q]:{...A[q],[W]:ne}},se=parseFloat((Me=ie[q])==null?void 0:Me.Creatinine),M=b,ce=S;if(W==="Creatinine"&&!isNaN(se)&&M!==null&&ce!==null){const qe=Bee(se,M,ce);qe!==null&&((De=t==null?void 0:t.tests.find(We=>We.id===q))!=null&&De.default_parameters.find(We=>We.name==="eGFR"))&&(ie[q].eGFR=qe)}const ve=parseFloat((Je=ie[q])==null?void 0:Je["Total Cholesterol"]),le=parseFloat((nt=ie[q])==null?void 0:nt["HDL Cholesterol"]),xe=parseFloat((Ge=ie[q])==null?void 0:Ge.Triglycerides);if((W==="Total Cholesterol"||W==="HDL Cholesterol"||W==="Triglycerides")&&!isNaN(ve)&&!isNaN(le)&&!isNaN(xe)){const qe=Uee(ve,le,xe);qe!==null&&((St=t==null?void 0:t.tests.find(We=>We.id===q))!=null&&St.default_parameters.find(We=>We.name==="LDL Cholesterol"))&&(ie[q]["LDL Cholesterol"]=qe)}const ue=parseFloat((It=ie[q])==null?void 0:It["Total Bilirubin"]),ze=parseFloat((Vt=ie[q])==null?void 0:Vt["Direct Bilirubin"]);if((W==="Total Bilirubin"||W==="Direct Bilirubin")&&!isNaN(ue)&&!isNaN(ze)){const qe=qee(ue,ze);qe!==null&&((oe=t==null?void 0:t.tests.find(We=>We.id===q))!=null&&oe.default_parameters.find(We=>We.name==="Indirect Bilirubin"))&&(ie[q]["Indirect Bilirubin"]=qe)}const tt=parseFloat((J=ie[q])==null?void 0:J["Total Protein"]),ft=parseFloat((de=ie[q])==null?void 0:de.Albumin);if((W==="Total Protein"||W==="Albumin")&&!isNaN(tt)&&!isNaN(ft)){const qe=Vee(tt,ft);qe!==null&&((Be=t==null?void 0:t.tests.find(We=>We.id===q))!=null&&Be.default_parameters.find(We=>We.name==="Globulin"))&&(ie[q].Globulin=qe)}const Re=parseFloat((be=ie[q])==null?void 0:be.Sodium),je=parseFloat((Fe=ie[q])==null?void 0:Fe.Chloride),he=parseFloat(($e=ie[q])==null?void 0:$e.Bicarbonate);if((W==="Sodium"||W==="Chloride"||W==="Bicarbonate")&&!isNaN(Re)&&!isNaN(je)&&!isNaN(he)){const qe=Hee(Re,je,he);qe!==null&&((st=t==null?void 0:t.tests.find(We=>We.id===q))!=null&&st.default_parameters.find(We=>We.name==="Anion Gap"))&&(ie[q]["Anion Gap"]=qe)}const Ae=parseFloat((rt=ie[q])==null?void 0:rt.Glucose),we=parseFloat((Le=ie[q])==null?void 0:Le.BUN);if((W==="Sodium"||W==="Glucose"||W==="BUN")&&!isNaN(Re)&&!isNaN(Ae)&&!isNaN(we)){const qe=Gee(Re,Ae,we);qe!==null&&((Ve=t==null?void 0:t.tests.find(We=>We.id===q))!=null&&Ve.default_parameters.find(We=>We.name==="Osmolality"))&&(ie[q].Osmolality=qe)}return ie})},z=async(q,W)=>{if(!e){alert("Cannot submit report without an Order ID.");return}if(!a[q]||Object.keys(a[q]).length===0){alert(`Please enter data for ${W} before saving.`);return}I(q),g(null);try{const A={...t!=null&&t.report_content?JSON.parse(t.report_content):{}};A[q]=a[q];const ie=await fe(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(A)})});if(!ie.ok){const se=await ie.json().catch(()=>({message:`Submission failed: ${ie.status}`}));throw new Error(se.message||`Submission failed: ${ie.status}`)}t&&r({...t,report_content:JSON.stringify(A)}),alert(`Report for ${W} saved successfully!`)}catch(ne){console.error(`Error submitting report for ${W}:`,ne),alert(`Failed to save report for ${W}: ${ne instanceof Error?ne.message:"Unknown error"}`)}finally{I(null)}},$=async()=>{if(Object.keys(a).length===0){alert("Report content cannot be empty.");return}if(!e){alert("Cannot submit report without an Order ID.");return}d(!0),g(null);try{const q=await fe(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(a)})});if(!q.ok){const W=await q.json().catch(()=>({message:`Submission failed: ${q.status}`}));throw new Error(W.message||`Submission failed: ${q.status}`)}alert("Report submitted successfully!"),n(-1)}catch(q){console.error("Error submitting report:",q),g(q instanceof Error?q.message:"An unknown error occurred during submission.")}finally{d(!1)}};if(o)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",style:{textAlign:"center",padding:"50px"},children:[" ",i.jsxs("div",{className:"loading-text",children:[i.jsx(Bd,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading details..."]})]})});if(h&&!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card error-message-container",style:{textAlign:"center",padding:"30px"},children:[i.jsx(si,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("h3",{className:"error-title",style:{borderBottom:"none"},children:"Error Loading Details"}),i.jsx("p",{className:"error-text",children:h}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"20px"},children:[i.jsx(Ht,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});if(!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(ql,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("p",{className:"no-data-message",style:{fontSize:"1.1em"},children:`Lab order not found for ID: ${e}.`}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"15px"},children:[i.jsx(Ht,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});const R=(Z=t==null?void 0:t.Patient)==null?void 0:Z.name,H=(te=t==null?void 0:t.Patient)==null?void 0:te.patient_token_number,ee=`Enter Report for Order #${(t==null?void 0:t.lab_token_number)??e}`;return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"none",paddingBottom:0,marginBottom:0},children:[" ",i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:ee})," ",i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs("button",{onClick:()=>window.print(),className:"lab-inventory-button",disabled:u,"aria-label":"Print report",children:[i.jsx(Vs,{size:16,style:{marginRight:"5px"}}),"Print"]}),i.jsxs("button",{onClick:F,className:"lab-inventory-button",disabled:u||!((Q=t==null?void 0:t.Patient)!=null&&Q.phone)||!(t!=null&&t.report_content),"aria-label":"Share report via WhatsApp",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},children:[i.jsx(I_,{size:16,style:{marginRight:"5px"}}),"WhatsApp"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",disabled:u,children:[i.jsx(Ht,{size:16,style:{marginRight:"5px"}}),"Back"]})]})]}),t&&i.jsxs("div",{className:"lab-inventory-card printable-section patient-info-section",style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:[i.jsx(ql,{size:18,className:"no-print",style:{marginRight:"8px",verticalAlign:"middle"}})," Order Summary"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"10px",fontSize:"0.95em"},children:[i.jsxs("div",{children:[i.jsx(Ys,{size:15,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Patient:"})," ",R??"N/A"," (Token: ",H??"N/A",")"]}),i.jsxs("div",{children:[i.jsx(ps,{size:15,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Order Token:"})," ",t.lab_token_number??"N/A"]}),i.jsxs("div",{children:[i.jsx(kP,{size:15,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Order Date:"})," ",Bh(new Date(t.createdAt),"PPpp")]}),i.jsxs("div",{style:{gridColumn:"1 / -1"},children:[i.jsx(uI,{size:15,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Tests:"})," ",(t.tests||[]).map(q=>q.name).join(", ")]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:Wee(t.status),children:Yee(t.status)})]})]})]}),i.jsxs("div",{className:"printable-section",style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:[i.jsx(ps,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}}),"Lab Report"]}),t==null?void 0:t.tests.map(q=>{var W;return i.jsxs("div",{"data-test-id":q.id,className:"lab-inventory-card test-report-container",style:{marginBottom:"15px"},children:[i.jsxs("div",{className:"lab-inventory-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[i.jsx("h4",{style:{fontSize:"1.1em",margin:0},children:q.name}),i.jsx("div",{className:"no-print",style:{display:"flex",gap:"10px"},children:i.jsx("button",{onClick:()=>V(q.id),className:"lab-inventory-button print-test-button","aria-label":`Print ${q.name}`,children:i.jsx(Vs,{size:16})})})]}),q.default_parameters&&q.default_parameters.length>0?i.jsx(i.Fragment,{children:i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Parameter"}),i.jsx("th",{children:"Value"}),i.jsx("th",{children:"Normal Range"})]})}),i.jsx("tbody",{children:q.default_parameters.map(ne=>{var ce,ve,le;const A=(ce=a[q.id])==null?void 0:ce[ne.name],ie=typeof A=="string"?parseFloat(A):typeof A=="number"?A:NaN,se=ne.type==="number"&&!isNaN(ie)&&A!==""&&A!==null&&A!==void 0&&(ne.lower_limit!=null&&ie<ne.lower_limit||ne.upper_limit!=null&&ie>ne.upper_limit),M=ne.type==="boolean"&&(A===!0||A==="true");return i.jsxs("tr",{children:[i.jsxs("td",{style:{fontWeight:"500"},children:[ne.name,ne.unit&&i.jsxs("span",{style:{color:"#6b7280",fontSize:"0.9em"},children:[" (",ne.unit,")"]})]}),i.jsxs("td",{className:`${se?"abnormal-result":""} ${M?"reactive-result":""}`,children:[i.jsxs("div",{className:"no-print",children:[ne.type==="boolean"?i.jsxs("select",{id:`${q.id}-${ne.name}`,value:(A==null?void 0:A.toString())??"false",onChange:xe=>U(q.id,ne.name,xe.target.value==="true"),className:"lab-inventory-input",style:{margin:0,width:"100%"},disabled:u,children:[i.jsx("option",{value:"false",children:"Non-Reactive"}),i.jsx("option",{value:"true",children:"Reactive"})]}):i.jsx("input",{id:`${q.id}-${ne.name}`,type:ne.type==="number"?"number":"text",value:A??"",onChange:xe=>{const ue=ne.type==="number"&&xe.target.value===""?0:xe.target.value;U(q.id,ne.name,ue)},className:"lab-inventory-input",style:{margin:0,width:"100%"},disabled:u||KC(ne.name)&&!((ve=T[q.id])!=null&&ve[ne.name]),placeholder:`Enter ${ne.name.toLowerCase()}`}),KC(ne.name)&&i.jsx("button",{type:"button",onClick:()=>E(xe=>{var ue;return{...xe,[q.id]:{...xe[q.id]||{},[ne.name]:!((ue=xe[q.id])!=null&&ue[ne.name])}}}),className:"lab-inventory-button lab-inventory-button-tertiary",style:{fontSize:"0.75em",padding:"3px 8px",marginTop:"5px"},disabled:u,children:(le=T[q.id])!=null&&le[ne.name]?"Lock":"Edit"})]}),i.jsx("span",{className:"print-only",children:ne.type==="boolean"?A===!0||A==="true"?"Reactive":"Non-Reactive":`${A??""} ${ne.unit??""}`})]}),i.jsx("td",{style:{color:"#6b7280",fontSize:"0.9em"},children:ne.type==="number"&&(ne.lower_limit!==null||ne.upper_limit!==null)?i.jsxs(i.Fragment,{children:[ne.lower_limit!=null&&`> ${ne.lower_limit}`,ne.lower_limit!=null&&ne.upper_limit!=null&&" - ",ne.upper_limit!=null&&`< ${ne.upper_limit}`,ne.unit&&` ${ne.unit}`]}):ne.type==="boolean"?"Non-Reactive":"N/A"})]},ne.name)})})]})}):i.jsxs("div",{className:"lab-inventory-form-group no-print",children:[i.jsx("label",{htmlFor:`${q.id}-report_content`,children:"Report Content"}),i.jsx("textarea",{id:`${q.id}-report_content`,value:((W=a[q.id])==null?void 0:W.report_content)??"",onChange:ne=>U(q.id,"report_content",ne.target.value),className:"lab-inventory-input",rows:5,placeholder:`Enter report for ${q.name}...`,disabled:u})]}),i.jsx("div",{className:"no-print",style:{marginTop:"15px",textAlign:"right"},children:i.jsx("button",{type:"button",onClick:()=>z(q.id,q.name),disabled:u||P===q.id,className:"lab-inventory-button",style:{fontSize:"0.9em",padding:"8px 16px"},children:P===q.id?i.jsxs(i.Fragment,{children:[i.jsx(Bd,{className:"animate-spin mr-2",size:14})," Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(eu,{size:14,style:{marginRight:"5px"}})," Save ",q.name]})})})]},q.id)}),h&&i.jsxs("p",{className:"error-text no-print",style:{marginTop:"10px"},children:[i.jsx(si,{size:15,className:"inline mr-1"}),h]})]}),i.jsxs("div",{className:"no-print",style:{marginTop:"20px",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[" ",i.jsx("button",{type:"button",onClick:()=>n(-1),disabled:u,className:"lab-inventory-button lab-inventory-button-secondary",children:"Cancel"}),i.jsx("button",{type:"button",onClick:$,disabled:u||Object.keys(a).length===0,className:"lab-inventory-button",children:u?i.jsxs(i.Fragment,{children:[i.jsx(Bd,{className:"animate-spin mr-2",size:16})," Submitting..."]}):i.jsxs(i.Fragment,{children:[i.jsx(eu,{size:16,style:{marginRight:"5px"}})," Submit All Reports"]})})]})]})})},Yee=e=>e?e.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()):"Unknown",Wee=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},Qee=()=>{const{orderId:e}=Rr(),n=wt(),[t,r]=w.useState(null),[a,l]=w.useState(!0),[o,f]=w.useState(null),u=w.useCallback(async g=>{if(!g){f("No Order ID specified in the URL."),l(!1),r(null);return}l(!0),f(null),r(null);try{console.log(`Fetching order details for ID: ${g}`);const b=await fe(`/api/lab/orders/${g}/report`);if(!b.ok){let S;try{S=await b.json()}catch{S={message:`Server returned status ${b.status}`}}throw console.error("Fetch order details error response:",S),new Error(S.message||`Failed to fetch order details: ${b.status}`)}const v=await b.json();if(console.log("Received order data:",v),!v)throw console.error("Invalid order data structure:",v),new Error("Invalid order data received from server.");r(v)}catch(b){console.error("Error fetching order details:",b),f(b instanceof Error?b.message:"An unknown error occurred while fetching the order details")}finally{l(!1)}},[fe]);w.useEffect(()=>{u(e)},[e,u]);const d=g=>{const b=document.querySelector(`[data-test-id='${g}']`);b&&(document.body.classList.add("printing-single-test"),b.classList.add("printing"),window.print())};w.useEffect(()=>{const g=()=>{document.body.classList.remove("printing-single-test");const b=document.querySelector(".printing");b&&b.classList.remove("printing")};return window.addEventListener("afterprint",g),()=>{window.removeEventListener("afterprint",g)}},[]);const h=()=>{t&&yw(t)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:0,paddingBottom:0,borderBottom:"none"},children:[i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:"Lab Report Viewer"})," ",i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs(hs,{to:"/lab/search-report",className:"lab-inventory-button","aria-label":"Search for other reports",children:[i.jsx(vi,{size:16,style:{marginRight:"5px"}}),"Search Reports"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(Ht,{size:16,style:{marginRight:"5px"}}),"Back"]}),i.jsxs("button",{onClick:()=>window.print(),className:"lab-inventory-button","aria-label":"Print report",children:[i.jsx(Vs,{size:16,style:{marginRight:"5px"}}),"Print"]}),i.jsxs("button",{onClick:h,className:"lab-inventory-button","aria-label":"Share report via WhatsApp",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},children:[i.jsx(I_,{size:16,style:{marginRight:"5px"}}),"WhatsApp"]})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:["Report Details (Order ID: ",e||"None Specified",")"]}),a&&i.jsx("div",{className:"loading-text",children:"Loading report..."}),o&&!a&&i.jsxs("div",{className:"error-message-container",style:{textAlign:"center"},children:[i.jsx(si,{size:48}),i.jsx("h3",{className:"error-title",children:"Error Loading Report"}),i.jsx("p",{children:o}),e&&i.jsx("button",{onClick:()=>u(e),className:"retry-button",children:"Retry"})]}),i.jsxs("div",{className:"printable-section",children:[!a&&!o&&(t==null?void 0:t.Patient)&&i.jsxs("div",{className:"lab-inventory-card",style:{marginBottom:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(Ys,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Patient Information"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"10px",fontSize:"0.9em"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Name:"})," ",t.Patient.name||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Age:"})," ",t.Patient.age??"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Gender:"})," ",t.Patient.gender||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Token No:"})," ",t.Patient.patient_token_number||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Patient ID:"})," ",t.Patient.id]}),t.Patient.phone&&i.jsxs("div",{children:[i.jsx("strong",{children:"Phone:"})," ",t.Patient.phone]})]})]}),!a&&!o&&(t==null?void 0:t.report_content)&&i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(ps,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Report Findings"]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6"},children:(()=>{try{const g=JSON.parse(t.report_content||"{}");return typeof g=="object"&&g!==null&&t.tests?t.tests.map(b=>i.jsxs("div",{"data-test-id":b.id,className:"test-report-container",style:{marginBottom:"20px"},children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h4",{style:{fontSize:"1.1em",margin:0},children:b.name}),i.jsx("button",{onClick:()=>d(b.id),className:"lab-inventory-button print-test-button","aria-label":`Print ${b.name}`,children:i.jsx(Vs,{size:16})})]}),g[b.id]?i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Parameter"}),i.jsx("th",{children:"Value"}),i.jsx("th",{children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(g[b.id]).map(([v,S])=>{var V;const k=(V=b.default_parameters)==null?void 0:V.find(F=>F.name===v),T=typeof S=="string"?parseFloat(S):typeof S=="number"?S:NaN,E=(k==null?void 0:k.type)==="number"&&!isNaN(T)&&(k.lower_limit!=null&&T<k.lower_limit||k.upper_limit!=null&&T>k.upper_limit),P=(k==null?void 0:k.type)==="boolean"?S===!0||S==="true"?"Reactive":"Non-Reactive":String(S),I=(k==null?void 0:k.type)==="boolean"&&(S===!0||S==="true");return i.jsxs("tr",{children:[i.jsx("td",{children:v}),i.jsxs("td",{className:`${E?"abnormal-result":""} ${I?"reactive-result":""}`,children:[P," ",k==null?void 0:k.unit]}),i.jsx("td",{children:k&&k.type==="number"&&(k.lower_limit!==null||k.upper_limit!==null)?i.jsxs(i.Fragment,{children:[k.lower_limit!=null&&` > ${k.lower_limit}`,k.lower_limit!=null&&k.upper_limit!=null&&" - ",k.upper_limit!=null&&` < ${k.upper_limit}`,k.unit&&` ${k.unit}`]}):((k==null?void 0:k.type)==="boolean","N/A")})]},v)})})]}):i.jsx("p",{children:"No parameters reported for this test."})]},b.id)):i.jsx(Kc,{remarkPlugins:[Oo],children:t.report_content})}catch{return i.jsx(Kc,{remarkPlugins:[Oo],children:t.report_content||"*No findings recorded.*"})}})()})]})]}),!a&&!o&&!(t!=null&&t.report_content)&&!(t!=null&&t.Patient)&&e&&i.jsxs("div",{className:"no-data-message",children:["No report content or patient details found for Order ID: ",e,". The order might be processing, does not exist, or the ID is incorrect."]}),!e&&!a&&!o&&i.jsxs("div",{className:"no-data-message",children:["No order ID specified in the URL.",i.jsx(hs,{to:"/lab/search-report",className:"lab-inventory-link",style:{display:"block",marginTop:"10px"},children:"Go to Search Page"})]})]})]})})},Jee=()=>{const e=wt(),[n,t]=w.useState(""),[r,a]=w.useState(!1),[l,o]=w.useState([]),[f,u]=w.useState(null),[d,h]=w.useState(n);w.useEffect(()=>{const k=setTimeout(()=>{h(n)},500);return()=>{clearTimeout(k)}},[n]),w.useEffect(()=>{g()},[d]);const g=async()=>{const k=n.trim();if(!k){o([]),u(null);return}a(!0),u(null),o([]),console.log(`Searching for: ${k}`);try{const T=await fe("/api/lab");if(!T.ok){let O;try{O=await T.json()}catch{O={message:`Server returned status ${T.status}`}}throw console.error("Search fetch error response:",O),new Error(O.message||`HTTP error! status: ${T.status}`)}const{orders:E}=await T.json();console.log("Received lab orders for search:",E);const I=E.filter(O=>!!O.report_content).map(O=>{var B,U;return{id:O.id,labTokenNumber:String(O.lab_token_number??"N/A"),patientName:((B=O.Patient)==null?void 0:B.name)||"N/A",patientId:O.patient_id,patientTokenNumber:String(((U=O.Patient)==null?void 0:U.patient_token_number)??"N/A"),tests:(O.tests||[]).map(z=>z.name||"Unknown Test"),date:Bh(new Date(O.createdAt),"yyyy-MM-dd"),status:O.status}}),V=n.toLowerCase(),F=I.filter(O=>{var z,$,R,H,ee;const B=String(O.labTokenNumber).toLowerCase(),U=String(O.patientTokenNumber).toLowerCase();return(((z=O.patientName)==null?void 0:z.toLowerCase())||"").includes(V)||B.includes(V)||U.includes(V)||(((R=($=O.tests)==null?void 0:$.join(" "))==null?void 0:R.toLowerCase())||"").includes(V)||(((H=O.id)==null?void 0:H.toLowerCase())||"").includes(V)||(((ee=O.patientId)==null?void 0:ee.toLowerCase())||"").includes(V)});console.log("Filtered search results:",F),o(F),F.length===0&&k?u(`No matching reports found for "${k}".`):u(null)}catch(T){console.error("Failed to search lab reports:",T),u(T instanceof Error?T.message:"An unknown error occurred during search")}finally{a(!1)}},b=k=>{console.log(`Result clicked, navigating to view report for order ID: ${k}`),e(`/lab/view-report/${k}`)},v=k=>{switch(k){case"pending":return{text:"Sample Pending",color:"text-red-600 bg-red-100"};case"collected":return{text:"Sample Collected",color:"text-yellow-600 bg-yellow-100"};case"processing":return{text:"Processing",color:"text-blue-600 bg-blue-100"};case"completed":return{text:"Completed",color:"text-green-600 bg-green-100"};case"cancelled":return{text:"Cancelled",color:"text-gray-600 bg-gray-100 line-through"};case"reported":return{text:"Reported",color:"text-purple-600 bg-purple-100"};default:return{text:k,color:"text-gray-600 bg-gray-100"}}},S=k=>{switch(k){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h2",{style:{margin:0},children:"Search Lab Reports"}),i.jsxs("button",{onClick:()=>e(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(Ht,{size:16,style:{marginRight:"5px"}}),"Back"]})]}),i.jsxs("div",{className:"lab-inventory-form-group",style:{marginTop:"20px",position:"relative"},children:[i.jsx("label",{htmlFor:"report-search",children:"Enter Search Term"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",position:"relative"},children:[i.jsx(vi,{size:20,style:{position:"absolute",left:"10px",color:"#777"}}),i.jsx("input",{id:"report-search",type:"text",placeholder:"Patient name, ID, token, report ID, test name...",value:n,onChange:k=>t(k.target.value),className:"lab-inventory-input",style:{paddingLeft:"40px",marginBottom:"0"}})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[r&&i.jsx("div",{className:"loading-text",children:"Searching..."}),f&&!r&&i.jsxs("div",{className:"error-text",children:[i.jsx(si,{size:20,className:"inline mr-2"})," ",f]}),l.length>0&&!r&&i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:l.map(k=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(k.id),style:{marginBottom:"15px",cursor:"pointer",padding:"15px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:[i.jsx(VP,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}}),k.patientName," (Token: ",k.patientTokenNumber,")"]}),i.jsx("span",{className:S(k.status),children:v(k.status).text})]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:[i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(ps,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Order ID: ",k.id]}),i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(iM,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Tests: ",k.tests.join(", ")]}),i.jsxs("div",{children:[i.jsx(TP,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Date: ",k.date]})]})]},k.id))}),!r&&l.length===0&&!f&&n.trim()&&i.jsxs("div",{className:"no-data-message",children:['No results found for "',n,'".']}),!r&&l.length===0&&!f&&!n.trim()&&i.jsx("div",{className:"no-data-message",style:{backgroundColor:"transparent",border:"none",textAlign:"left",padding:"5px 0"},children:"Enter a search term above to find lab reports."})]})]})})},Kee=()=>{const{patientId:e}=Rr(),n=wt(),[t,r]=w.useState([]),[a,l]=w.useState(!0),[o,f]=w.useState(null),[u,d]=w.useState(null),[h,g]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){f("Patient ID is missing from the URL."),l(!1);return}l(!0),f(null),r([]),g(null);try{const S=await fe(`/api/patients/${e}`);if(S.ok){const E=await S.json();g(E.name||`Patient ID: ${e}`)}else console.warn(`Failed to fetch patient name for ID ${e}`),g(`Patient ID: ${e}`);const k=await fe(`/api/lab/patient/${e}`);if(!k.ok){const E=await k.json().catch(()=>({}));throw new Error(E.message||`HTTP error! status: ${k.status}`)}const T=await k.json();r(T||[])}catch(S){console.error("Error fetching data:",S),f(`Failed to load data: ${S.message}`)}finally{l(!1)}})()},[e]);const b=v=>{v.report_content?n(`/lab/view-report/${v.id}`):n(`/lab/enter-report/${v.id}`)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("h2",{style:{margin:0},children:["Lab Reports ",h?`for ${h}`:`for Patient ID: ${e}`]}),i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs("button",{onClick:async()=>{if(!e){alert("Patient ID is missing. Cannot create a new report.");return}try{const v=await fe("/api/lab/create-empty-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:e})});if(!v.ok){const k=await v.json().catch(()=>({message:`Failed to create new lab order: ${v.status}`}));throw new Error(k.message||`Failed to create new lab order: ${v.status}`)}const S=await v.json();n(`/lab/enter-report/${S.newOrderId}`)}catch(v){console.error("Error creating new lab order:",v),alert(`Error creating new lab order: ${v.message}`)}},className:"lab-inventory-button",disabled:!e,title:e?"Enter a new lab report for this patient":"Patient ID missing",children:[i.jsx(Fo,{size:16,style:{marginRight:"5px"}}),"Enter New Report"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",children:[i.jsx(Ht,{size:16,style:{marginRight:"5px"}}),"Back"]})]})]}),i.jsx("div",{style:{marginTop:"20px"},children:a?i.jsxs("div",{className:"loading-text",children:[i.jsx(Bd,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading reports..."]}):o?i.jsxs("div",{className:"error-text",style:{textAlign:"center",padding:"20px"},children:[i.jsx(M_,{size:40,style:{marginBottom:"10px",color:"#721c24"}}),i.jsx("h3",{style:{fontSize:"1.2em",color:"#721c24",margin:"10px 0"},children:"Error Loading Reports"}),i.jsx("p",{children:o})]}):t.length===0?i.jsxs("div",{className:"no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(ps,{size:48,className:"mb-3",style:{margin:"0 auto 15px auto",display:"block"}}),i.jsx("p",{children:"No lab reports found for this patient."}),i.jsxs("p",{children:["You can ",i.jsx(hs,{to:`/lab/create-order/${e}`,className:"lab-inventory-link",children:"create a new lab order"}),"."]})]}):u?i.jsxs("div",{className:"lab-inventory-card",style:{backgroundColor:"#fdfdfd"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.3em",borderBottom:"none",margin:0},children:["Report from: ",u.report_date?Bh(new Date(u.report_date),"PPP p"):"N/A"]}),i.jsxs("button",{onClick:()=>d(null),className:"lab-inventory-button lab-inventory-button-secondary",style:{fontSize:"0.9em",padding:"8px 12px"},children:[i.jsx(Ht,{size:16,style:{marginRight:"5px"}})," Back to List"]})]}),i.jsxs("p",{style:{marginBottom:"15px",fontSize:"1em"},children:[i.jsx("strong",{children:"Tests Ordered:"})," ",(u.tests||[]).map(v=>v.name).join(", ")]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6",border:"1px solid #eee",padding:"15px",borderRadius:"4px",background:"#fff"},children:i.jsx(Kc,{remarkPlugins:[Oo],children:u.report_content||"*No findings recorded.*"})})]}):i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:t.map(v=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(v),tabIndex:0,onKeyPress:S=>S.key==="Enter"&&b(v),style:{marginBottom:"15px",cursor:"pointer",padding:"15px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx(ps,{size:24,style:{marginRight:"15px",color:"#007bff"}}),i.jsxs("div",{children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:["Order Date: ",Bh(new Date(v.createdAt),"PPP")]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:["Tests: ",v.tests&&v.tests.length>0?v.tests.map(S=>S.name).join(", "):"N/A"]})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[v.status&&i.jsx("span",{className:Zee(v.status),children:Xee(v.status)}),i.jsx(ug,{size:20,style:{color:"#6c757d"}})]})]},v.id))})})]})})},Xee=e=>{if(!e)return"Unknown";switch(e.toLowerCase()){case"pending":return"Pending Sample";case"collected":return"Sample Collected";case"processing":return"Processing";case"report_ready":return"Report Ready";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return e.charAt(0).toUpperCase()+e.slice(1)}},Zee=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},xT=()=>{const e=wt(),[n,t]=w.useState([]),[r,a]=w.useState([]),[l,o]=w.useState(!1),[f,u]=w.useState(null),[d,h]=w.useState(""),[g,b]=w.useState("all"),v=10,S=1;w.useEffect(()=>{(async()=>{o(!0),u(null);try{console.log("Fetching pharmacy inventory for view page...");const E=await fe("/api/drugs");if(!E.ok)throw new Error(`HTTP error! status: ${E.status}`);const P=await E.json();console.log("Fetched Pharmacy Inventory for view page:",P),t(P||[])}catch(E){console.error("Error fetching pharmacy inventory:",E),u("Failed to load pharmacy inventory.")}finally{}})()},[]),w.useEffect(()=>{(async()=>{try{console.log("Fetching lab inventory for view page...");const E=await fe("/api/lab-tests");if(!E.ok)throw new Error(`HTTP error! status: ${E.status}`);const P=await E.json();console.log("Fetched Lab Inventory for view page:",P),a(P||[])}catch(E){console.error("Error fetching lab inventory:",E),u(P=>P?`${P} & Failed to load lab inventory.`:"Failed to load lab inventory.")}finally{o(!1)}})()},[]);const k=w.useMemo(()=>{let T=n;return d&&(T=T.filter(E=>E.name.toLowerCase().includes(d.toLowerCase()))),g!=="all"&&(T=T.filter(E=>{const P=(E.quantity_in_stock??1/0)<=v;let I=!1,V=!1;if(E.expiry_date)try{const F=nb(E.expiry_date);if(tg(F)){const O=G0(new Date,S),B=new Date;B.setHours(0,0,0,0),V=$d(F,B),I=!V&&$d(F,O)}}catch(F){console.error("Error parsing expiry date for filter:",E.expiry_date,F),I=!0}else I=!0;switch(g){case"low-stock":return P;case"near-expiry":return I;case"expired":return V;default:return!0}})),T},[n,d,g]);return i.jsxs("div",{className:"lab-inventory-container",children:[i.jsxs("div",{className:"lab-inventory-header",children:[i.jsx("h1",{children:"Inventory Overview"}),i.jsxs("button",{onClick:()=>e(-1),className:"lab-inventory-button lab-inventory-button-secondary",title:"Go Back",children:[i.jsx(Ht,{size:18,style:{marginRight:"5px"}})," Back"]})]}),l&&i.jsx("p",{className:"loading-text",children:"Loading inventory..."}),f&&i.jsx("p",{className:"error-text",children:f}),!l&&!f&&i.jsxs("div",{className:"inventory-sections-container",children:[i.jsxs("div",{className:"lab-inventory-card",children:[" ",i.jsxs("div",{className:"inventory-section__header-bar",children:[i.jsxs("h2",{className:"lab-inventory-header",children:[i.jsx(Uo,{size:24,style:{marginRight:"10px",verticalAlign:"middle"}})," Pharmacy Inventory"]}),i.jsxs("div",{className:"inventory-section__controls",children:[" ",i.jsxs("div",{className:"inventory-section__search-area",children:[i.jsx("input",{type:"text",placeholder:"Search drugs...",value:d,onChange:T=>h(T.target.value),className:"lab-inventory-input",style:{marginRight:"5px",marginBottom:"0"}}),i.jsx(vi,{size:18,style:{color:"#777"}})]}),i.jsxs("div",{className:"inventory-section__filter-area",children:[" ",i.jsxs("select",{value:g,onChange:T=>b(T.target.value),className:"lab-inventory-select",children:[i.jsx("option",{value:"all",children:"All Drugs"}),i.jsx("option",{value:"low-stock",children:"Low Stock"}),i.jsx("option",{value:"near-expiry",children:"Near Expiry"}),i.jsx("option",{value:"expired",children:"Expired"})]})]})]})]}),k.length>0?i.jsxs("div",{className:"table-container",children:[" ",i.jsxs("div",{className:"table-scroll-wrapper",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Stock"}),i.jsx("th",{children:"Expiry Date"}),i.jsx("th",{children:"Buying Price"}),i.jsx("th",{children:"Selling Price"})]})}),i.jsx("tbody",{children:k.map(T=>{let E="N/A",P="";const I=(T.quantity_in_stock??1/0)<=v;if(T.expiry_date)try{const V=nb(T.expiry_date);if(tg(V)){E=Bh(V,"dd/MM/yyyy");const F=G0(new Date,1),O=new Date;O.setHours(0,0,0,0),$d(V,O)?P="highlight-expired":$d(V,F)&&(P="highlight-near-expiry")}else E="Invalid Date",P="highlight-near-expiry"}catch(V){console.error("Error parsing expiry date:",T.expiry_date,V),E="Error Parsing",P="highlight-near-expiry"}else P="highlight-near-expiry";return i.jsxs("tr",{children:[i.jsx("td",{children:T.name}),i.jsx("td",{children:i.jsx("span",{className:`highlight-box ${I?"highlight-low-stock":""}`,children:T.quantity_in_stock??"N/A"})}),i.jsx("td",{children:i.jsx("span",{className:`highlight-box ${P}`,children:E})}),i.jsx("td",{className:"price-text",children:T.buying_price?`${T.buying_price}`:"N/A"}),i.jsx("td",{className:"price-text",children:T.price?`${T.price}`:"N/A"})]},T.id)})})]})]})]}):i.jsx("p",{className:"no-data-message",children:d?`No drugs found matching "${d}".`:"No pharmacy inventory data available."})]}),i.jsxs("div",{className:"lab-inventory-card",children:[" ",i.jsxs("h2",{className:"lab-inventory-header inventory-section__lab-title",children:[i.jsx(ew,{size:24,style:{marginRight:"10px",verticalAlign:"middle"}})," Lab Test Inventory"]}),r.length>0?i.jsxs("div",{className:"table-container",children:[" ",i.jsxs("div",{className:"table-scroll-wrapper",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"})]})}),i.jsx("tbody",{children:r.map(T=>i.jsxs("tr",{children:[i.jsx("td",{children:T.name}),i.jsx("td",{className:"price-text",children:T.price?`${T.price}`:"N/A"})]},T.id))})]})]})]}):i.jsx("p",{className:"no-data-message",children:"No lab test inventory data available."})]})]})]})},ete=({fetchWithAuth:e})=>{const n=wt(),[t,r]=w.useState(!0),[a,l]=w.useState([]),[o,f]=w.useState(null),[u,d]=w.useState(null),h=w.useCallback(async()=>{r(!0),f(null);try{const S=await(await e("/staff")).json();l(S.map(k=>({...k,id:k._id||k.id})))}catch(v){f(`Failed to load staff data: ${v.message}`),l([])}finally{r(!1)}},[e]);w.useEffect(()=>{h()},[h]),w.useEffect(()=>{if(u){const v=setTimeout(()=>d(null),5e3);return()=>clearTimeout(v)}},[u]);const g=v=>{switch(v){case"doctor":return"admin-pill-info";case"receptionist":return"admin-pill-success";case"pharmacy":return"admin-pill-primary";case"lab":return"admin-pill-warning";case"admin":return"admin-pill-neutral";default:return"admin-pill-neutral"}},b=v=>{switch(v){case"doctor":return i.jsx(ZI,{size:16,className:"mr-2 text-blue-600"});case"receptionist":return i.jsx(R_,{size:16,className:"mr-2 text-green-600"});case"pharmacy":return i.jsx(Uo,{size:16,className:"mr-2 text-purple-600"});case"lab":return i.jsx(Xx,{size:16,className:"mr-2 text-yellow-600"});case"admin":return i.jsx(dg,{size:16,className:"mr-2 text-teal-600"});default:return i.jsx(zh,{size:16,className:"mr-2 text-gray-500"})}};return t?i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:[" ",i.jsx("div",{className:"breathing-ball",style:{width:"30px",height:"30px"}})," "]}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Staff..."})]})}):i.jsxs("div",{className:"staff-page-container",children:[u&&i.jsxs("div",{className:`mb-4 p-3 rounded-md flex items-center ${u.type==="success"?"bg-green-100 border border-green-400 text-green-700":"bg-red-100 border border-red-400 text-red-700"}`,role:"alert",children:[u.type==="success"?i.jsx(Ua,{size:18,className:"mr-2"}):i.jsx(si,{size:18,className:"mr-2"}),i.jsx("span",{children:u.message}),i.jsx("button",{onClick:()=>d(null),className:"ml-auto text-xl font-bold",children:""})]}),o&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",role:"alert",children:[i.jsx(si,{size:18,className:"mr-2 text-red-500"}),o,i.jsx("button",{onClick:()=>f(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"p-2 rounded-md hover:bg-gray-200",children:i.jsx(Ht,{size:20})}),i.jsx("h1",{className:"text-2xl font-bold",children:"Manage Staff"})]}),i.jsxs("button",{onClick:()=>n("/dashboard/staff/add"),className:"bg-teal-600 text-white px-4 py-2 rounded-md hover:bg-teal-700 flex items-center",children:[i.jsx(Gl,{size:16,className:"mr-2"})," Add New Staff"]})]}),i.jsx("div",{className:"staff-table-container",children:i.jsxs("table",{className:"staff-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{className:"hidden md:table-cell",children:"Email"}),i.jsx("th",{children:"Role"}),i.jsx("th",{className:"hidden md:table-cell",children:"OPD Fee ()"}),i.jsx("th",{className:"hidden md:table-cell",children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:a.length===0&&!t?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-4",children:"No staff members found."})}):a.map(v=>i.jsxs("tr",{children:[i.jsx("td",{children:v.name}),i.jsx("td",{className:"hidden md:table-cell",children:v.email}),i.jsx("td",{children:i.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g(v.role)}`,children:[b(v.role),v.role.charAt(0).toUpperCase()+v.role.slice(1)]})}),i.jsx("td",{className:"hidden md:table-cell",children:v.role==="doctor"?v.opd_fee?parseFloat(String(v.opd_fee)).toFixed(2):"Not Set":"N/A"}),i.jsx("td",{className:"hidden md:table-cell",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.status==="active"?"Active":"Inactive"})}),i.jsx("td",{className:"actions",children:i.jsxs("button",{onClick:()=>n(`/dashboard/staff/edit/${v.id}`),className:"edit-link",disabled:v.role==="admin",title:"Edit Staff",children:[i.jsx(tu,{size:16})," Edit"]})})]},v.id))})]})})]})},tte=()=>{var k,T,E,P,I,V,F,O,B,U,z,$,R,H;const{patientId:e,billId:n}=Rr(),t=wt(),[r,a]=w.useState(null),[l,o]=w.useState(!0),[f,u]=w.useState(null),[d,h]=w.useState(""),[g,b]=w.useState("cash"),v=((k=r==null?void 0:r.patient)==null?void 0:k.insurance_type)==="no_cash_insurance";w.useEffect(()=>{b(v?"no_cash_insurance":"cash")},[v]),w.useEffect(()=>{n?(async()=>{o(!0),u(null);try{const Z=await fe(`/api/bills/${n}`);if(!Z.ok)throw new Error(`HTTP error! status: ${Z.status}`);const te=await Z.json();if(!te||!te.bill||!te.calculated)throw new Error("Incomplete data structure received from backend (missing bill or calculated fields).");if(te.bill.type!=="admission")throw console.error("Fetched bill is not an admission bill. Bill Type:",te.bill.type),new Error(`Unexpected bill type received: ${te.bill.type}. Expected 'admission'.`);console.log("Raw API data received:",JSON.stringify(te,null,2));const Q=Array.isArray(te.admissionPayments)?te.admissionPayments:[];console.log("Processed admissionPaymentsData:",Q);const q={...te.bill,amount:te.bill.amount,AdmissionPayments:Q,calculated:te.calculated,patient:te.bill.Patient?{id:te.bill.Patient.id,name:te.bill.Patient.name,admission_date:te.bill.Patient.admission_date,discharge_date:te.bill.Patient.discharge_date}:void 0};console.log("Setting billDetails state to:",JSON.stringify(q,null,2)),a(q)}catch(Z){console.error("Failed to fetch admission bill details:",Z),u(Z instanceof Error?Z.message:"An unknown error occurred")}finally{o(!1)}})():(u("Bill ID is missing."),o(!1))},[n,e]);const S=async ee=>{var Z;if(ee.preventDefault(),!e||!d||isNaN(parseFloat(d))||parseFloat(d)<=0||parseFloat(d)>(((Z=r==null?void 0:r.calculated)==null?void 0:Z.balance)??0)){u("Please enter a valid payment amount within the balance due. Patient ID must be present.");return}u(null);try{const te=await fe(`/api/patients/${e}/admission-payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount_paid:parseFloat(d),payment_mode:g})});if(!te.ok){const W=await te.json();throw new Error(W.message||`HTTP error! status: ${te.status}`)}const q=await(await fe(`/api/bills/${n}`)).json();if(q&&q.bill&&q.calculated&&q.admissionPayments)a({...q.bill,amount:parseFloat(q.bill.amount),AdmissionPayments:q.admissionPayments,calculated:q.calculated,patient:q.bill.Patient?{id:q.bill.Patient.id,name:q.bill.Patient.name,admission_date:q.bill.Patient.admission_date,discharge_date:q.bill.Patient.discharge_date}:void 0});else throw new Error("Invalid data structure received after payment submission.");h("")}catch(te){console.error("Failed to submit payment:",te),u(te instanceof Error?te.message:"Failed to record payment")}};return l?i.jsx("div",{className:"p-4",children:"Loading admission bill details..."}):f?i.jsxs("div",{className:"p-4 text-red-600",children:["Error: ",f]}):!r||!r.calculated?i.jsx("div",{className:"p-4",children:"No bill details found or data is incomplete."}):i.jsx("div",{className:"admission-page-container",children:i.jsxs("div",{className:"admission-section",children:[" ",i.jsxs("div",{className:"p-4 border-b",children:[" ",i.jsxs("h2",{className:"admission-header",children:["Admission Billing Details (Bill #",r.id,")"]}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Patient: ",((T=r.patient)==null?void 0:T.name)??"N/A"," (ID: ",r.patient_id,")"]})," ",i.jsxs("p",{className:"text-sm text-gray-600",children:["Admission Date: ",(E=r.patient)!=null&&E.admission_date?new Date(r.patient.admission_date).toLocaleDateString():"N/A"]}),((P=r.patient)==null?void 0:P.discharge_date)&&i.jsxs("p",{className:"text-sm text-gray-600",children:["Discharge Date: ",new Date(r.patient.discharge_date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm",children:["Status: ",i.jsx("span",{className:`font-semibold ${r.status==="paid"?"text-green-600":"text-orange-600"}`,children:((I=r.status)==null?void 0:I.toUpperCase())??"UNKNOWN"})]})]}),i.jsxs("div",{className:"p-4",children:[" ",i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Initial Charges:"})," ",i.jsxs("span",{children:["",(parseFloat((r==null?void 0:r.amount)||"0")||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Days Stayed:"})," ",i.jsx("span",{children:((V=r==null?void 0:r.calculated)==null?void 0:V.daysStayed)??0})]}),i.jsxs("p",{className:"flex justify-between text-sm font-semibold mt-2 pt-2 border-t",children:[i.jsx("span",{children:"Total Due:"})," ",i.jsxs("span",{children:["",(Number((F=r==null?void 0:r.calculated)==null?void 0:F.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[i.jsx("span",{children:"Total Paid:"})," ",i.jsxs("span",{children:["",(Number((O=r==null?void 0:r.calculated)==null?void 0:O.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-lg font-bold mt-1 text-red-600",children:[i.jsx("span",{children:"Balance Due:"})," ",i.jsxs("span",{children:["",(Number((B=r==null?void 0:r.calculated)==null?void 0:B.balance)||0).toFixed(2)]})]})]})]}),(r==null?void 0:r.status)!=="paid"&&(Number((U=r==null?void 0:r.calculated)==null?void 0:U.balance)||0)>0&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title text-blue-800",children:"Record New Payment"}),i.jsxs("form",{onSubmit:S,className:"space-y-4",children:[i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentAmount",className:"admission-label",children:"Amount Paid ()"}),i.jsx("input",{id:"paymentAmount",type:"number",value:d,onChange:ee=>h(ee.target.value),placeholder:`Max ${(Number((z=r==null?void 0:r.calculated)==null?void 0:z.balance)||0).toFixed(2)}`,required:!0,min:"0.01",step:"0.01",max:Number(($=r==null?void 0:r.calculated)==null?void 0:$.balance)||0,className:"admission-input"})]}),i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentMode",className:"admission-label",children:"Payment Mode"}),i.jsxs("select",{id:"paymentMode",value:g,onChange:ee=>b(ee.target.value),className:"admission-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"upi",children:"UPI"}),v&&i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),i.jsx("button",{type:"submit",className:"admission-button",disabled:l||!d||parseFloat(d)<=0||parseFloat(d)>(Number((R=r==null?void 0:r.calculated)==null?void 0:R.balance)||0)||v&&g!=="no_cash_insurance",children:"Record Payment"})]})]})]}),i.jsx("h3",{className:"admission-section-title mt-6 border-t pt-4",children:"Admission Payment History"}),Array.isArray(r==null?void 0:r.AdmissionPayments)&&r.AdmissionPayments.length>0?i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"admission-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Payment ID"}),i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Mode"})]})}),i.jsx("tbody",{children:(H=r==null?void 0:r.AdmissionPayments)==null?void 0:H.map(ee=>{if(!ee||typeof ee!="object")return null;let Z="Invalid Date";try{ee.payment_date&&!isNaN(new Date(ee.payment_date).getTime())&&(Z=new Date(ee.payment_date).toLocaleString())}catch(te){console.error("Error formatting payment date:",ee.payment_date,te)}return i.jsxs("tr",{children:[" ",i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ee.id??"N/A"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Z}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["",(Number(ee.amount_paid)||0).toFixed(2)]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:ee.payment_mode??"N/A"})]},ee.id??Math.random())})})]})]}):i.jsx("p",{className:"text-gray-500 text-sm",children:"No payments recorded yet."})]}),i.jsxs("div",{className:"p-4 border-t bg-gray-50 text-right",children:[" ",i.jsx("button",{type:"button",onClick:()=>t(-1),className:"admission-button admission-button-secondary",children:"Back"})]})]})})};var nte=Object.defineProperty,vb=Object.getOwnPropertySymbols,bT=Object.prototype.hasOwnProperty,vT=Object.prototype.propertyIsEnumerable,ZC=(e,n,t)=>n in e?nte(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,O1=(e,n)=>{for(var t in n||(n={}))bT.call(n,t)&&ZC(e,t,n[t]);if(vb)for(var t of vb(n))vT.call(n,t)&&ZC(e,t,n[t]);return e},F1=(e,n)=>{var t={};for(var r in e)bT.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&vb)for(var r of vb(e))n.indexOf(r)<0&&vT.call(e,r)&&(t[r]=e[r]);return t};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Hd;(e=>{const n=class fn{constructor(u,d,h,g){if(this.version=u,this.errorCorrectionLevel=d,this.modules=[],this.isFunction=[],u<fn.MIN_VERSION||u>fn.MAX_VERSION)throw new RangeError("Version value out of range");if(g<-1||g>7)throw new RangeError("Mask value out of range");this.size=u*4+17;let b=[];for(let S=0;S<this.size;S++)b.push(!1);for(let S=0;S<this.size;S++)this.modules.push(b.slice()),this.isFunction.push(b.slice());this.drawFunctionPatterns();const v=this.addEccAndInterleave(h);if(this.drawCodewords(v),g==-1){let S=1e9;for(let k=0;k<8;k++){this.applyMask(k),this.drawFormatBits(k);const T=this.getPenaltyScore();T<S&&(g=k,S=T),this.applyMask(k)}}a(0<=g&&g<=7),this.mask=g,this.applyMask(g),this.drawFormatBits(g),this.isFunction=[]}static encodeText(u,d){const h=e.QrSegment.makeSegments(u);return fn.encodeSegments(h,d)}static encodeBinary(u,d){const h=e.QrSegment.makeBytes(u);return fn.encodeSegments([h],d)}static encodeSegments(u,d,h=1,g=40,b=-1,v=!0){if(!(fn.MIN_VERSION<=h&&h<=g&&g<=fn.MAX_VERSION)||b<-1||b>7)throw new RangeError("Invalid value");let S,k;for(S=h;;S++){const I=fn.getNumDataCodewords(S,d)*8,V=o.getTotalBits(u,S);if(V<=I){k=V;break}if(S>=g)throw new RangeError("Data too long")}for(const I of[fn.Ecc.MEDIUM,fn.Ecc.QUARTILE,fn.Ecc.HIGH])v&&k<=fn.getNumDataCodewords(S,I)*8&&(d=I);let T=[];for(const I of u){t(I.mode.modeBits,4,T),t(I.numChars,I.mode.numCharCountBits(S),T);for(const V of I.getData())T.push(V)}a(T.length==k);const E=fn.getNumDataCodewords(S,d)*8;a(T.length<=E),t(0,Math.min(4,E-T.length),T),t(0,(8-T.length%8)%8,T),a(T.length%8==0);for(let I=236;T.length<E;I^=253)t(I,8,T);let P=[];for(;P.length*8<T.length;)P.push(0);return T.forEach((I,V)=>P[V>>>3]|=I<<7-(V&7)),new fn(S,d,P,b)}getModule(u,d){return 0<=u&&u<this.size&&0<=d&&d<this.size&&this.modules[d][u]}getModules(){return this.modules}drawFunctionPatterns(){for(let h=0;h<this.size;h++)this.setFunctionModule(6,h,h%2==0),this.setFunctionModule(h,6,h%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const u=this.getAlignmentPatternPositions(),d=u.length;for(let h=0;h<d;h++)for(let g=0;g<d;g++)h==0&&g==0||h==0&&g==d-1||h==d-1&&g==0||this.drawAlignmentPattern(u[h],u[g]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(u){const d=this.errorCorrectionLevel.formatBits<<3|u;let h=d;for(let b=0;b<10;b++)h=h<<1^(h>>>9)*1335;const g=(d<<10|h)^21522;a(g>>>15==0);for(let b=0;b<=5;b++)this.setFunctionModule(8,b,r(g,b));this.setFunctionModule(8,7,r(g,6)),this.setFunctionModule(8,8,r(g,7)),this.setFunctionModule(7,8,r(g,8));for(let b=9;b<15;b++)this.setFunctionModule(14-b,8,r(g,b));for(let b=0;b<8;b++)this.setFunctionModule(this.size-1-b,8,r(g,b));for(let b=8;b<15;b++)this.setFunctionModule(8,this.size-15+b,r(g,b));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let u=this.version;for(let h=0;h<12;h++)u=u<<1^(u>>>11)*7973;const d=this.version<<12|u;a(d>>>18==0);for(let h=0;h<18;h++){const g=r(d,h),b=this.size-11+h%3,v=Math.floor(h/3);this.setFunctionModule(b,v,g),this.setFunctionModule(v,b,g)}}drawFinderPattern(u,d){for(let h=-4;h<=4;h++)for(let g=-4;g<=4;g++){const b=Math.max(Math.abs(g),Math.abs(h)),v=u+g,S=d+h;0<=v&&v<this.size&&0<=S&&S<this.size&&this.setFunctionModule(v,S,b!=2&&b!=4)}}drawAlignmentPattern(u,d){for(let h=-2;h<=2;h++)for(let g=-2;g<=2;g++)this.setFunctionModule(u+g,d+h,Math.max(Math.abs(g),Math.abs(h))!=1)}setFunctionModule(u,d,h){this.modules[d][u]=h,this.isFunction[d][u]=!0}addEccAndInterleave(u){const d=this.version,h=this.errorCorrectionLevel;if(u.length!=fn.getNumDataCodewords(d,h))throw new RangeError("Invalid argument");const g=fn.NUM_ERROR_CORRECTION_BLOCKS[h.ordinal][d],b=fn.ECC_CODEWORDS_PER_BLOCK[h.ordinal][d],v=Math.floor(fn.getNumRawDataModules(d)/8),S=g-v%g,k=Math.floor(v/g);let T=[];const E=fn.reedSolomonComputeDivisor(b);for(let I=0,V=0;I<g;I++){let F=u.slice(V,V+k-b+(I<S?0:1));V+=F.length;const O=fn.reedSolomonComputeRemainder(F,E);I<S&&F.push(0),T.push(F.concat(O))}let P=[];for(let I=0;I<T[0].length;I++)T.forEach((V,F)=>{(I!=k-b||F>=S)&&P.push(V[I])});return a(P.length==v),P}drawCodewords(u){if(u.length!=Math.floor(fn.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let d=0;for(let h=this.size-1;h>=1;h-=2){h==6&&(h=5);for(let g=0;g<this.size;g++)for(let b=0;b<2;b++){const v=h-b,k=(h+1&2)==0?this.size-1-g:g;!this.isFunction[k][v]&&d<u.length*8&&(this.modules[k][v]=r(u[d>>>3],7-(d&7)),d++)}}a(d==u.length*8)}applyMask(u){if(u<0||u>7)throw new RangeError("Mask value out of range");for(let d=0;d<this.size;d++)for(let h=0;h<this.size;h++){let g;switch(u){case 0:g=(h+d)%2==0;break;case 1:g=d%2==0;break;case 2:g=h%3==0;break;case 3:g=(h+d)%3==0;break;case 4:g=(Math.floor(h/3)+Math.floor(d/2))%2==0;break;case 5:g=h*d%2+h*d%3==0;break;case 6:g=(h*d%2+h*d%3)%2==0;break;case 7:g=((h+d)%2+h*d%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[d][h]&&g&&(this.modules[d][h]=!this.modules[d][h])}}getPenaltyScore(){let u=0;for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[b][T]==v?(S++,S==5?u+=fn.PENALTY_N1:S>5&&u++):(this.finderPenaltyAddHistory(S,k),v||(u+=this.finderPenaltyCountPatterns(k)*fn.PENALTY_N3),v=this.modules[b][T],S=1);u+=this.finderPenaltyTerminateAndCount(v,S,k)*fn.PENALTY_N3}for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[T][b]==v?(S++,S==5?u+=fn.PENALTY_N1:S>5&&u++):(this.finderPenaltyAddHistory(S,k),v||(u+=this.finderPenaltyCountPatterns(k)*fn.PENALTY_N3),v=this.modules[T][b],S=1);u+=this.finderPenaltyTerminateAndCount(v,S,k)*fn.PENALTY_N3}for(let b=0;b<this.size-1;b++)for(let v=0;v<this.size-1;v++){const S=this.modules[b][v];S==this.modules[b][v+1]&&S==this.modules[b+1][v]&&S==this.modules[b+1][v+1]&&(u+=fn.PENALTY_N2)}let d=0;for(const b of this.modules)d=b.reduce((v,S)=>v+(S?1:0),d);const h=this.size*this.size,g=Math.ceil(Math.abs(d*20-h*10)/h)-1;return a(0<=g&&g<=9),u+=g*fn.PENALTY_N4,a(0<=u&&u<=2568888),u}getAlignmentPatternPositions(){if(this.version==1)return[];{const u=Math.floor(this.version/7)+2,d=this.version==32?26:Math.ceil((this.version*4+4)/(u*2-2))*2;let h=[6];for(let g=this.size-7;h.length<u;g-=d)h.splice(1,0,g);return h}}static getNumRawDataModules(u){if(u<fn.MIN_VERSION||u>fn.MAX_VERSION)throw new RangeError("Version number out of range");let d=(16*u+128)*u+64;if(u>=2){const h=Math.floor(u/7)+2;d-=(25*h-10)*h-55,u>=7&&(d-=36)}return a(208<=d&&d<=29648),d}static getNumDataCodewords(u,d){return Math.floor(fn.getNumRawDataModules(u)/8)-fn.ECC_CODEWORDS_PER_BLOCK[d.ordinal][u]*fn.NUM_ERROR_CORRECTION_BLOCKS[d.ordinal][u]}static reedSolomonComputeDivisor(u){if(u<1||u>255)throw new RangeError("Degree out of range");let d=[];for(let g=0;g<u-1;g++)d.push(0);d.push(1);let h=1;for(let g=0;g<u;g++){for(let b=0;b<d.length;b++)d[b]=fn.reedSolomonMultiply(d[b],h),b+1<d.length&&(d[b]^=d[b+1]);h=fn.reedSolomonMultiply(h,2)}return d}static reedSolomonComputeRemainder(u,d){let h=d.map(g=>0);for(const g of u){const b=g^h.shift();h.push(0),d.forEach((v,S)=>h[S]^=fn.reedSolomonMultiply(v,b))}return h}static reedSolomonMultiply(u,d){if(u>>>8||d>>>8)throw new RangeError("Byte out of range");let h=0;for(let g=7;g>=0;g--)h=h<<1^(h>>>7)*285,h^=(d>>>g&1)*u;return a(h>>>8==0),h}finderPenaltyCountPatterns(u){const d=u[1];a(d<=this.size*3);const h=d>0&&u[2]==d&&u[3]==d*3&&u[4]==d&&u[5]==d;return(h&&u[0]>=d*4&&u[6]>=d?1:0)+(h&&u[6]>=d*4&&u[0]>=d?1:0)}finderPenaltyTerminateAndCount(u,d,h){return u&&(this.finderPenaltyAddHistory(d,h),d=0),d+=this.size,this.finderPenaltyAddHistory(d,h),this.finderPenaltyCountPatterns(h)}finderPenaltyAddHistory(u,d){d[0]==0&&(u+=this.size),d.pop(),d.unshift(u)}};n.MIN_VERSION=1,n.MAX_VERSION=40,n.PENALTY_N1=3,n.PENALTY_N2=3,n.PENALTY_N3=40,n.PENALTY_N4=10,n.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],n.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=n;function t(f,u,d){if(u<0||u>31||f>>>u)throw new RangeError("Value out of range");for(let h=u-1;h>=0;h--)d.push(f>>>h&1)}function r(f,u){return(f>>>u&1)!=0}function a(f){if(!f)throw new Error("Assertion error")}const l=class _i{constructor(u,d,h){if(this.mode=u,this.numChars=d,this.bitData=h,d<0)throw new RangeError("Invalid argument");this.bitData=h.slice()}static makeBytes(u){let d=[];for(const h of u)t(h,8,d);return new _i(_i.Mode.BYTE,u.length,d)}static makeNumeric(u){if(!_i.isNumeric(u))throw new RangeError("String contains non-numeric characters");let d=[];for(let h=0;h<u.length;){const g=Math.min(u.length-h,3);t(parseInt(u.substring(h,h+g),10),g*3+1,d),h+=g}return new _i(_i.Mode.NUMERIC,u.length,d)}static makeAlphanumeric(u){if(!_i.isAlphanumeric(u))throw new RangeError("String contains unencodable characters in alphanumeric mode");let d=[],h;for(h=0;h+2<=u.length;h+=2){let g=_i.ALPHANUMERIC_CHARSET.indexOf(u.charAt(h))*45;g+=_i.ALPHANUMERIC_CHARSET.indexOf(u.charAt(h+1)),t(g,11,d)}return h<u.length&&t(_i.ALPHANUMERIC_CHARSET.indexOf(u.charAt(h)),6,d),new _i(_i.Mode.ALPHANUMERIC,u.length,d)}static makeSegments(u){return u==""?[]:_i.isNumeric(u)?[_i.makeNumeric(u)]:_i.isAlphanumeric(u)?[_i.makeAlphanumeric(u)]:[_i.makeBytes(_i.toUtf8ByteArray(u))]}static makeEci(u){let d=[];if(u<0)throw new RangeError("ECI assignment value out of range");if(u<128)t(u,8,d);else if(u<16384)t(2,2,d),t(u,14,d);else if(u<1e6)t(6,3,d),t(u,21,d);else throw new RangeError("ECI assignment value out of range");return new _i(_i.Mode.ECI,0,d)}static isNumeric(u){return _i.NUMERIC_REGEX.test(u)}static isAlphanumeric(u){return _i.ALPHANUMERIC_REGEX.test(u)}getData(){return this.bitData.slice()}static getTotalBits(u,d){let h=0;for(const g of u){const b=g.mode.numCharCountBits(d);if(g.numChars>=1<<b)return 1/0;h+=4+b+g.bitData.length}return h}static toUtf8ByteArray(u){u=encodeURI(u);let d=[];for(let h=0;h<u.length;h++)u.charAt(h)!="%"?d.push(u.charCodeAt(h)):(d.push(parseInt(u.substring(h+1,h+3),16)),h+=2);return d}};l.NUMERIC_REGEX=/^[0-9]*$/,l.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,l.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let o=l;e.QrSegment=l})(Hd||(Hd={}));(e=>{(n=>{const t=class{constructor(a,l){this.ordinal=a,this.formatBits=l}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),n.Ecc=t})(e.QrCode||(e.QrCode={}))})(Hd||(Hd={}));(e=>{(n=>{const t=class{constructor(a,l){this.modeBits=a,this.numBitsCharCount=l}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),n.Mode=t})(e.QrSegment||(e.QrSegment={}))})(Hd||(Hd={}));var Ph=Hd;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var ite={L:Ph.QrCode.Ecc.LOW,M:Ph.QrCode.Ecc.MEDIUM,Q:Ph.QrCode.Ecc.QUARTILE,H:Ph.QrCode.Ecc.HIGH},wT=128,NT="L",ST="#FFFFFF",jT="#000000",CT=!1,_T=1,rte=4,ate=0,ste=.1;function kT(e,n=0){const t=[];return e.forEach(function(r,a){let l=null;r.forEach(function(o,f){if(!o&&l!==null){t.push(`M${l+n} ${a+n}h${f-l}v1H${l+n}z`),l=null;return}if(f===r.length-1){if(!o)return;l===null?t.push(`M${f+n},${a+n} h1v1H${f+n}z`):t.push(`M${l+n},${a+n} h${f+1-l}v1H${l+n}z`);return}o&&l===null&&(l=f)})}),t.join("")}function ET(e,n){return e.slice().map((t,r)=>r<n.y||r>=n.y+n.h?t:t.map((a,l)=>l<n.x||l>=n.x+n.w?a:!1))}function lte(e,n,t,r){if(r==null)return null;const a=e.length+t*2,l=Math.floor(n*ste),o=a/n,f=(r.width||l)*o,u=(r.height||l)*o,d=r.x==null?e.length/2-f/2:r.x*o,h=r.y==null?e.length/2-u/2:r.y*o,g=r.opacity==null?1:r.opacity;let b=null;if(r.excavate){let S=Math.floor(d),k=Math.floor(h),T=Math.ceil(f+d-S),E=Math.ceil(u+h-k);b={x:S,y:k,w:T,h:E}}const v=r.crossOrigin;return{x:d,y:h,h:u,w:f,excavation:b,opacity:g,crossOrigin:v}}function ote(e,n){return n!=null?Math.max(Math.floor(n),0):e?rte:ate}function TT({value:e,level:n,minVersion:t,includeMargin:r,marginSize:a,imageSettings:l,size:o,boostLevel:f}){let u=Rn.useMemo(()=>{const S=(Array.isArray(e)?e:[e]).reduce((k,T)=>(k.push(...Ph.QrSegment.makeSegments(T)),k),[]);return Ph.QrCode.encodeSegments(S,ite[n],t,void 0,void 0,f)},[e,n,t,f]);const{cells:d,margin:h,numCells:g,calculatedImageSettings:b}=Rn.useMemo(()=>{let v=u.getModules();const S=ote(r,a),k=v.length+S*2,T=lte(v,o,S,l);return{cells:v,margin:S,numCells:k,calculatedImageSettings:T}},[u,o,l,r,a]);return{qrcode:u,margin:h,cells:d,numCells:g,calculatedImageSettings:b}}var cte=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),Gh=Rn.forwardRef(function(n,t){const r=n,{value:a,size:l=wT,level:o=NT,bgColor:f=ST,fgColor:u=jT,includeMargin:d=CT,minVersion:h=_T,boostLevel:g,marginSize:b,imageSettings:v}=r,k=F1(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:T}=k,E=F1(k,["style"]),P=v==null?void 0:v.src,I=Rn.useRef(null),V=Rn.useRef(null),F=Rn.useCallback(Z=>{I.current=Z,typeof t=="function"?t(Z):t&&(t.current=Z)},[t]),[O,B]=Rn.useState(!1),{margin:U,cells:z,numCells:$,calculatedImageSettings:R}=TT({value:a,level:o,minVersion:h,boostLevel:g,includeMargin:d,marginSize:b,imageSettings:v,size:l});Rn.useEffect(()=>{if(I.current!=null){const Z=I.current,te=Z.getContext("2d");if(!te)return;let Q=z;const q=V.current,W=R!=null&&q!==null&&q.complete&&q.naturalHeight!==0&&q.naturalWidth!==0;W&&R.excavation!=null&&(Q=ET(z,R.excavation));const ne=window.devicePixelRatio||1;Z.height=Z.width=l*ne;const A=l/$*ne;te.scale(A,A),te.fillStyle=f,te.fillRect(0,0,$,$),te.fillStyle=u,cte?te.fill(new Path2D(kT(Q,U))):z.forEach(function(ie,se){ie.forEach(function(M,ce){M&&te.fillRect(ce+U,se+U,1,1)})}),R&&(te.globalAlpha=R.opacity),W&&te.drawImage(q,R.x+U,R.y+U,R.w,R.h)}}),Rn.useEffect(()=>{B(!1)},[P]);const H=O1({height:l,width:l},T);let ee=null;return P!=null&&(ee=Rn.createElement("img",{src:P,key:P,style:{display:"none"},onLoad:()=>{B(!0)},ref:V,crossOrigin:R==null?void 0:R.crossOrigin})),Rn.createElement(Rn.Fragment,null,Rn.createElement("canvas",O1({style:H,height:l,width:l,ref:F,role:"img"},E)),ee)});Gh.displayName="QRCodeCanvas";var ute=Rn.forwardRef(function(n,t){const r=n,{value:a,size:l=wT,level:o=NT,bgColor:f=ST,fgColor:u=jT,includeMargin:d=CT,minVersion:h=_T,boostLevel:g,title:b,marginSize:v,imageSettings:S}=r,k=F1(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:T,cells:E,numCells:P,calculatedImageSettings:I}=TT({value:a,level:o,minVersion:h,boostLevel:g,includeMargin:d,marginSize:v,imageSettings:S,size:l});let V=E,F=null;S!=null&&I!=null&&(I.excavation!=null&&(V=ET(E,I.excavation)),F=Rn.createElement("image",{href:S.src,height:I.h,width:I.w,x:I.x+T,y:I.y+T,preserveAspectRatio:"none",opacity:I.opacity,crossOrigin:I.crossOrigin}));const O=kT(V,T);return Rn.createElement("svg",O1({height:l,width:l,viewBox:`0 0 ${P} ${P}`,ref:t,role:"img"},k),!!b&&Rn.createElement("title",null,b),Rn.createElement("path",{fill:f,d:`M0,0 h${P}v${P}H0z`,shapeRendering:"crispEdges"}),Rn.createElement("path",{fill:u,d:O,shapeRendering:"crispEdges"}),F)});ute.displayName="QRCodeSVG";const dte=e=>{switch(e){case"pending":return{text:"text-orange-700",bg:"bg-orange-100"};case"billed":return{text:"text-blue-700",bg:"bg-blue-100"};case"dispensed":return{text:"text-green-700",bg:"bg-green-100"};case"cancelled":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},fte=()=>{const{orderId:e}=Rr(),n=wt(),[t,r]=w.useState(null),[a,l]=w.useState(!0),[o,f]=w.useState(null),[u,d]=w.useState(!1),[h,g]=w.useState({}),[b,v]=w.useState(""),[S,k]=w.useState(""),[T,E]=w.useState("cash"),P=w.useMemo(()=>(t==null?void 0:t.medications.reduce((R,H)=>{const ee=H.total_price??0,Z=ee*(H.discount_percentage??0)/100;return R+ee-Z},0))??0,[t==null?void 0:t.medications]),I=5,V=w.useMemo(()=>!t||!t.medications?0:t.medications.reduce((R,H,ee)=>{var ne,A;const Z=H.drug_id??`index-${ee}`,te=((ne=h[Z])==null?void 0:ne.pack)||0,Q=((A=h[Z])==null?void 0:A.loose)||0,q=H.pack_price??0,W=H.loose_price??0;return R+te*q+Q*W},0),[t,h]),F=w.useCallback(async()=>{if(!e){f("Order ID is missing."),l(!1);return}l(!0),f(null);try{const R=await fe(`/api/pharmacy-orders/${e}`);if(!R.ok)throw R.status===404?new Error(`Order with ID ${e} not found.`):new Error(`Failed to fetch order details: ${R.statusText} (${R.status})`);const H=await R.json();console.log("Fetched order data after return:",H);const Z=H.medications.map(Q=>Q.pack_price&&Q.loose_price&&Q.loose_price>0?{...Q,unitsPerPack:Math.round(Q.pack_price/Q.loose_price)}:{...Q,unitsPerPack:0}).map(Q=>({...Q,discount_percentage:Q.discount_percentage??0}));r({...H,medications:Z});const te={};Z.forEach((Q,q)=>{const W=Q.drug_id??`index-${q}`;te[W]={pack:0,loose:0}}),g(te)}catch(R){console.error("Failed to fetch order details:",R),f(R.message||"Failed to load order details.")}finally{l(!1)}},[e]);w.useEffect(()=>{F()},[F]),w.useEffect(()=>{(async()=>{try{const H=await fe("/api/clinics/settings");if(!H.ok)throw new Error("Failed to fetch clinic settings");const ee=await H.json();console.log("Fetched clinic settings:",ee),v(ee.upi_id||"")}catch(H){console.error("Error fetching clinic settings:",H)}})()},[]),w.useEffect(()=>{if((t==null?void 0:t.order_total)!==void 0&&t.order_total>0&&b){const R=`upi://pay?pa=${b}&pn=ClinicName&am=${t.order_total.toFixed(2)}&cu=INR`;k(R)}else k("")},[t==null?void 0:t.order_total,b]);const O=(R,H)=>{r(ee=>{if(!ee)return null;const Z=ee.medications.map((Q,q)=>(Q.drug_id??`index-${q}`)===R?{...Q,discount_percentage:isNaN(H)?0:H}:Q),te=Z.reduce((Q,q)=>{const W=q.total_price??0,ne=W*(q.discount_percentage??0)/100;return Q+W-ne},0);return{...ee,medications:Z,order_total:te}})},B=(R,H,ee)=>{g(Z=>{const te=ee.unitsPerPack||0,q=ee.pack_quantity*te+ee.loose_quantity,W=Math.max(0,Math.min(H,q));let ne=0,A=W;return te>0&&(ne=Math.floor(W/te),A=W%te),{...Z,[R]:{pack:ne,loose:A}}})},U=async()=>{const R=t==null?void 0:t.medications.map((H,ee)=>{var q,W;const Z=H.drug_id??`index-${ee}`,te=((q=h[Z])==null?void 0:q.pack)||0,Q=((W=h[Z])==null?void 0:W.loose)||0;return te>0||Q>0?{drug_id:H.drug_id,name:H.name,pack_quantity:H.pack_quantity,loose_quantity:H.loose_quantity,returnPackQuantity:te,returnLooseQuantity:Q}:null}).filter(H=>H!==null);if(!R||R.length===0){alert("Please select a quantity greater than 0 for at least one item to return.");return}if(!e){alert("Order ID is missing. Cannot process return.");return}if(!R){alert("Could not prepare items for return.");return}d(!0),f(null);try{const H=await fe(`/api/pharmacy-orders/${e}/return`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemsToReturn:R})}),ee=await H.json();if(!H.ok)throw new Error(ee.message||`Failed to process return: ${H.statusText}`);alert("Return processed successfully! Stock has been updated.");const Z={};t==null||t.medications.forEach((te,Q)=>{const q=te.drug_id??`index-${Q}`;Z[q]={pack:0,loose:0}}),g(Z),F()}catch(H){console.error("Failed to process return:",H),f(H.message||"An error occurred while processing the return."),alert(`Error processing return: ${H.message||"Unknown error"}`)}finally{d(!1)}};if(a)return i.jsx("div",{className:"text-center p-6 text-gray-500 animate-pulse",children:"Loading Order Details..."});if(o)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(Ht,{size:14,className:"mr-1.5"})," Back"]}),i.jsxs("div",{className:"bg-red-50 border border-red-300 text-red-700 rounded p-4",children:["Error: ",o]})]});if(!t)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(Ht,{size:14,className:"mr-1.5"})," Back"]}),i.jsx("div",{className:"text-center py-10 px-4 text-gray-500 bg-white rounded-lg shadow",children:"Order details could not be loaded."})]});const z=()=>{window.print()},$=dte(t.status);return i.jsx("div",{className:"pharmacy-order-details-page",children:i.jsxs("div",{className:"order-details-container printable-section",children:[i.jsxs("div",{className:"order-details-header no-print",children:[i.jsx("h1",{children:"Pharmacy Order Details"}),i.jsxs("div",{className:"actions",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:[i.jsx(Ht,{size:18})," Back to Queue"]}),i.jsxs("button",{onClick:z,className:"print-button",children:[i.jsx(Vs,{size:18})," Print Bill"]})]})]}),i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{children:"Mahajan Pharmacy"}),i.jsxs("div",{className:"clinic-details-print",children:[i.jsx("span",{className:"small-text clinic-address",children:"D.No: 3-1-289, Plot No. 101, Kabela Center, RR Nagar, Vijayawada  520012."}),i.jsx("span",{className:"small-text clinic-notes",children:"Phone: 93919 44733"}),i.jsx("span",{className:"small-text clinic-license",children:"Licence No:RLF20AP2025003328"})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Patient Name:"})," RESHMA"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Token:"})," 12"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Order Date:"})," 31/10/2025"]})]})]}),i.jsxs("div",{className:"order-info-section no-print",children:[i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Order ID:"})," ",t.id]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Patient:"})," ",t.patientName||"N/A"," (",t.patientTokenNumber||"N/A",")"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Date:"})," ",new Date(t.date).toLocaleString()]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Prescribed By:"})," ",t.prescribedBy||"N/A"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:`status-pill ${$.text} ${$.bg}`,children:t.status})]})]}),i.jsxs("div",{className:"medications-section",children:[i.jsx("h2",{children:"Medications Ordered"}),t.medications.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"PACK QTY"}),i.jsx("th",{children:"PACK PRICE"}),i.jsx("th",{children:"LOOSE QTY"}),i.jsx("th",{children:"LOOSE PRICE"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"no-print",children:"RETURN PACK QTY"}),i.jsx("th",{className:"no-print",children:"RETURN LOOSE QTY"})]})]})}),i.jsx("tbody",{children:t.medications.map((R,H)=>{var ne,A,ie,se,M,ce;const ee=R.drug_id??`index-${H}`,Z=R.total_price??0,te=Z*(R.discount_percentage??0)/100,Q=Z-te,q=((ne=h[ee])==null?void 0:ne.pack)||0,W=((A=h[ee])==null?void 0:A.loose)||0;return i.jsxs("tr",{children:[i.jsx("td",{children:R.name}),i.jsx("td",{children:R.pack_quantity??0}),i.jsx("td",{children:((ie=R.pack_price)==null?void 0:ie.toFixed(2))??"N/A"}),i.jsx("td",{children:R.loose_quantity??0}),i.jsx("td",{children:((se=R.loose_price)==null?void 0:se.toFixed(2))??"N/A"}),i.jsx("td",{children:((M=R.price)==null?void 0:M.toFixed(2))??"N/A"})," ",i.jsx("td",{children:((ce=R.price)==null?void 0:ce.toFixed(2))??"N/A"})," ",i.jsxs("td",{children:[i.jsx("input",{type:"number",value:R.discount_percentage??0,onChange:ve=>O(ee,parseFloat(ve.target.value)),min:"0",max:"100",className:"discount-input-table no-print"}),i.jsxs("span",{className:"print-only",children:[R.discount_percentage??0,"%"]})]}),i.jsxs("td",{children:[I.toFixed(1),"%"]}),i.jsx("td",{children:Q.toFixed(2)}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:R.pack_quantity,value:q,onChange:ve=>{const xe=(parseInt(ve.target.value,10)||0)*(R.unitsPerPack||0)+W;B(ee,xe,R)},className:"return-quantity-input"})}),i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:R.loose_quantity+R.pack_quantity*(R.unitsPerPack||0)-q*(R.unitsPerPack||0),value:W,onChange:ve=>{const le=parseInt(ve.target.value,10)||0,xe=q*(R.unitsPerPack||0)+le;B(ee,xe,R)},className:"return-quantity-input"})})]})]},ee)})})]}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No medications listed for this order."})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",P.toFixed(2)]})}),i.jsxs("div",{className:"order-total-section no-print",children:[i.jsx("span",{className:"total-label",children:"Order Total:"}),i.jsxs("span",{className:"total-amount",children:["",P.toFixed(2)]})]}),i.jsxs("div",{className:"payment-section no-print",children:[i.jsxs("div",{className:"payment-mode-group",children:[i.jsx("label",{htmlFor:"paymentMode",children:"Payment Mode:"}),i.jsxs("select",{id:"paymentMode",value:T,onChange:R=>E(R.target.value),className:"payment-mode-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),S&&i.jsxs("div",{className:"qr-code-container",children:[i.jsx(Gh,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]})]}),(t.status==="dispensed"||t.status==="billed")&&t.medications.length>0&&i.jsxs("div",{className:"return-action-section no-print",children:[V>0&&i.jsxs("div",{className:"total-refund-display",children:["Total Refund: ",V.toFixed(2)]}),i.jsx("button",{onClick:U,disabled:Object.values(h).every(R=>R.pack===0&&R.loose===0)||u,className:"process-return-button",children:u?i.jsxs(i.Fragment,{children:[i.jsx($h,{size:16,className:"mr-2 animate-spin"})," Processing..."]}):i.jsxs(i.Fragment,{children:[i.jsx($h,{size:16,className:"mr-2"})," Process Return"]})})]})]})})},hte=async()=>{const e=await fe("/subscriptions");if(!e.ok)throw new Error("Failed to fetch subscription plans");return await e.json()},pte=async e=>{const n=await fe(`/subscriptions/${e}`);if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to fetch subscription plan details"}));throw new Error(t.message||"Failed to fetch subscription plan details")}return await n.json()},mte=async e=>{const n=await fe("/subscriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to create subscription plan"}));throw new Error(t.message||"Failed to create subscription plan")}return await n.json()},gte=async(e,n)=>{const t=await fe(`/subscriptions/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to update subscription plan"}));throw new Error(r.message||"Failed to update subscription plan")}return await t.json()},yte=async e=>{const n=await fe(`/subscriptions/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to deactivate subscription plan"}));throw new Error(t.message||"Failed to deactivate subscription plan")}return await n.json()},xte=async(e,n)=>{const t=await fe("/api/payment/razorpay-subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:e,planId:n})});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to initiate Razorpay subscription"}));throw new Error(r.message||"Failed to initiate Razorpay subscription")}return await t.json()},bte=()=>{const e=wt(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[l,o]=w.useState(null),[f,u]=w.useState(null),d=w.useCallback(async()=>{a(!0),o(null);try{const g=await hte();t(g)}catch(g){o(g.message||"Failed to fetch subscription plans."),u({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{d()},[d]),w.useEffect(()=>{if(f){const g=setTimeout(()=>u(null),5e3);return()=>clearTimeout(g)}},[f]);const h=async g=>{if(u(null),o(null),window.confirm("Are you sure you want to deactivate this plan? This action cannot be undone directly.")){a(!0),o(null),u(null);try{await yte(g),u({type:"success",message:"Plan deactivated successfully!"}),d()}catch(b){o(b.message||"Failed to deactivate plan."),u({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[f&&i.jsxs("div",{className:`${f.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[f.type==="success"?i.jsx(Ua,{size:18,className:"mr-2 text-green-500"}):i.jsx(si,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:f.message})]}),i.jsx("button",{onClick:()=>u(null),className:`${f.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Kn,{size:16})})]}),i.jsxs("div",{children:[" ",i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(Ht,{size:16}),"Back"]}),i.jsx("h1",{children:"Manage Subscription Plans"}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions/add"),className:"subscription-btn",children:[i.jsx(Gl,{size:16,className:"mr-1 inline-block"})," Add New Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading plans..."})]})}),!r&&l&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:l}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx(tu,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>h(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(Oi,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!l&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No subscription plans found. Add one to get started!"})]})]})},vte=()=>{const e=wt(),[n,t]=w.useState({name:"",description:"",price:"",period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[l,o]=w.useState(null),[f,u]=w.useState(null);w.useEffect(()=>{if(f){const b=setTimeout(()=>u(null),5e3);return()=>clearTimeout(b)}},[f]);const d=b=>{const{name:v,value:S}=b.target;t(k=>({...k,[v]:S}))},h=async b=>{if(b.preventDefault(),a(!0),o(null),u(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){o("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await mte(n),u({type:"success",message:"Plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create plan.";o(S),u({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[f&&i.jsxs("div",{className:`${f.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[f.type==="success"?i.jsx(Ua,{size:18,className:"mr-2 text-green-500"}):i.jsx(si,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:f.message})]}),i.jsx("button",{onClick:()=>u(null),className:`${f.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Kn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Subscription Plan"}),l&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:l}),i.jsxs("form",{onSubmit:h,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:d,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:d})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:d,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:d,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:d,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:d})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},wte=()=>{const{id:e}=Rr(),n=wt(),[t,r]=w.useState(null),[a,l]=w.useState({}),[o,f]=w.useState(!1),[u,d]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),d(!1);return}d(!0),g(null);try{const P=await pte(e);r(P),l({name:P.name,description:P.description||"",price:P.price,period:P.period,interval:P.interval,razorpay_plan_id:P.razorpay_plan_id||"",status:P.status})}catch(P){g(P.message||"Failed to fetch plan details."),v({type:"error",message:P.message||"Failed to fetch plan details."})}finally{d(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const P=setTimeout(()=>v(null),5e3);return()=>clearTimeout(P)}},[b]);const k=P=>{const{name:I,value:V}=P.target;l(F=>({...F,[I]:V}))},T=async P=>{if(P.preventDefault(),!e){g("Plan ID is missing.");return}if(f(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),f(!1);return}try{await gte(e,a),v({type:"success",message:"Plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(I){const V=I.message||"Failed to update plan.";g(V),v({type:"error",message:V})}finally{f(!1)}},E=()=>{n(-1)};return u?i.jsx("div",{className:"p-6 text-center",children:"Loading plan details..."}):h&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:h}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx(Ua,{size:18,className:"mr-2"}):i.jsx(si,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(Kn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Subscription Plan"}),h&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:h}),i.jsxs("form",{onSubmit:T,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval||1,onChange:k,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:E,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:o,className:"subscription-btn",children:[o?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,o?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Plan not found."})},Nte=()=>{const{patientId:e}=Rr(),n=wt(),[t,r]=w.useState(null),[a,l]=w.useState([]),[o,f]=w.useState(""),[u,d]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState("manual"),[S,k]=w.useState(!1),[T,E]=w.useState(null),P=w.useCallback(async()=>{d(!0),g(null);try{const F=await fe(`/api/patients/${e}`);if(!F.ok){const z=await F.json();throw new Error(z.message||"Failed to fetch patient details")}const O=await F.json();r(O);const B=await fe("/api/subscriptions");if(!B.ok){const z=await B.json();throw new Error(z.message||"Failed to fetch subscription plans")}const U=await B.json();l(U.filter(z=>z.status==="active"))}catch(F){console.error("Error fetching data:",F),g(`Failed to load data: ${F.message}`)}finally{d(!1)}},[e]);w.useEffect(()=>{e?P():(g("Patient ID is missing."),d(!1))},[e,P]);const I=(F,O)=>{const B=new Date(F),U=O.interval||1;switch(O.period){case"daily":B.setDate(F.getDate()+U);break;case"weekly":B.setDate(F.getDate()+U*7);break;case"monthly":B.setMonth(F.getMonth()+U);break;case"yearly":B.setFullYear(F.getFullYear()+U);break;default:console.warn(`Unknown subscription period: ${O.period}. Defaulting to 1 month.`),B.setMonth(F.getMonth()+1)}return B},V=async()=>{if(!e||!o){E("Please select a subscription plan.");return}const F=a.find(O=>O.id===o);if(!F){E("Selected plan details not found.");return}k(!0),E(null);try{const O=new Date,B=I(O,F);if(b==="manual"){const U={subscription_plan_id:o,subscription_status:"active",subscription_start_date:O.toISOString(),subscription_end_date:B.toISOString(),subscription_payment_method:"manual"},z=await fe(`/api/patients/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(U)});if(!z.ok){const $=await z.json();throw new Error($.message||"Failed to start subscription manually")}alert(`Subscription started successfully for ${t==null?void 0:t.name} (Manual Payment)!`),n("/all-patients")}else if(b==="razorpay"){console.log("Initiating Razorpay subscription for plan:",F);const U=await xte(e,o);if(U&&U.short_url)window.location.href=U.short_url;else throw new Error("Failed to get Razorpay subscription link from backend.")}}catch(O){console.error("Error starting subscription:",O),E(`Failed to start subscription: ${O.message}`),k(!1)}};return u?i.jsx("div",{className:"loading-state-subscription",children:"Loading patient and plans..."}):h?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:h})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(Ht,{size:16})," ","Back"]})]}):t?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(Ht,{size:16})," ","Back"]}),i.jsxs("h1",{children:[i.jsx(Ys,{size:28})," ","Start Subscription for ",t.name]}),T&&i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[" ",i.jsx("span",{children:T})]}),i.jsxs("div",{className:"subscription-form",children:[" ",i.jsx("h2",{children:"Available Subscription Plans"}),a.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:a.map(F=>i.jsxs("div",{className:`subscription-plan-card ${o===F.id?"selected-plan":""}`,onClick:()=>f(F.id),children:[i.jsx("h3",{children:F.name}),i.jsxs("p",{className:"price",children:["",F.price]}),i.jsxs("p",{className:"duration",children:["Every ",F.interval," ",F.period,F.interval>1?"s":""]}),F.description&&i.jsx("p",{children:F.description})]},F.id))})]}),i.jsxs("div",{className:"subscription-form mb-6",children:[" ",i.jsx("h2",{children:"Select Payment Method"}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"manual",checked:b==="manual",onChange:()=>v("manual"),className:"mr-2"}),i.jsx("span",{children:"Cash (Manual)"})]})}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"razorpay",checked:b==="razorpay",onChange:()=>v("razorpay"),className:"mr-2"}),i.jsx("span",{children:"Razorpay"})]})})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:V,disabled:!o||S||a.length===0,className:"subscription-btn",children:[S&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),S?"Starting...":"Start Subscription"]})})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Warning: "}),i.jsx("span",{children:"Patient not found."})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(Ht,{size:16}),"Back"]})]})},Ste=()=>{const e=wt(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[l,o]=w.useState(null),[f,u]=w.useState(null),d=w.useCallback(async()=>{a(!0),o(null);try{const g=await nw();t(g)}catch(g){o(g.message||"Failed to fetch clinic subscription plans."),u({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{d()},[d]),w.useEffect(()=>{if(f){const g=setTimeout(()=>u(null),5e3);return()=>clearTimeout(g)}},[f]);const h=async g=>{if(u(null),o(null),window.confirm("Are you sure you want to deactivate this clinic plan? This action cannot be undone directly.")){a(!0),o(null),u(null);try{await WR(g),u({type:"success",message:"Clinic plan deactivated successfully!"}),d()}catch(b){o(b.message||"Failed to deactivate clinic plan."),u({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[f&&i.jsxs("div",{className:`${f.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[f.type==="success"?i.jsx(Ua,{size:18,className:"mr-2 text-green-500"}):i.jsx(si,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:f.message})]}),i.jsx("button",{onClick:()=>u(null),className:`${f.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Kn,{size:16})})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"p-2 rounded-md hover:bg-gray-200",children:i.jsx(Ht,{size:20})}),i.jsx("h1",{className:"text-2xl font-bold",children:"Manage Clinic Subscription Plans"})]}),i.jsxs("button",{onClick:()=>e("/dashboard/clinic-subscriptions/add"),className:"subscription-btn",children:[i.jsx(Gl,{size:16,className:"mr-1 inline-block"})," Add New Clinic Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading clinic plans..."})]})}),!r&&l&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:l}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/clinic-subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx(tu,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>h(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(Oi,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!l&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No clinic subscription plans found. Add one to get started!"})]})]})},jte=()=>{const e=wt(),[n,t]=w.useState({name:"",description:"",price:0,period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[l,o]=w.useState(null),[f,u]=w.useState(null);w.useEffect(()=>{if(f){const b=setTimeout(()=>u(null),5e3);return()=>clearTimeout(b)}},[f]);const d=b=>{const{name:v,value:S,type:k}=b.target;t(T=>({...T,[v]:k==="number"?parseFloat(S):S}))},h=async b=>{if(b.preventDefault(),a(!0),o(null),u(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){o("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await GR(n),u({type:"success",message:"Clinic plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/clinic-subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create clinic plan.";o(S),u({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[f&&i.jsxs("div",{className:`${f.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[f.type==="success"?i.jsx(Ua,{size:18,className:"mr-2 text-green-500"}):i.jsx(si,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:f.message})]}),i.jsx("button",{onClick:()=>u(null),className:`${f.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Kn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Clinic Subscription Plan"}),l&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:l}),i.jsxs("form",{onSubmit:h,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:d,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:d})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:d,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:d,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:d,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:d})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},Cte=()=>{const{id:e}=Rr(),n=wt(),[t,r]=w.useState(null),[a,l]=w.useState({}),[o,f]=w.useState(!1),[u,d]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),d(!1);return}d(!0),g(null);try{const P=await HR(e);r(P),l({name:P.name,description:P.description||"",price:Number(P.price),period:P.period,interval:Number(P.interval),razorpay_plan_id:P.razorpay_plan_id||"",status:P.status})}catch(P){g(P.message||"Failed to fetch clinic plan details."),v({type:"error",message:P.message||"Failed to fetch plan details."})}finally{d(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const P=setTimeout(()=>v(null),5e3);return()=>clearTimeout(P)}},[b]);const k=P=>{const{name:I,value:V,type:F}=P.target;l(O=>({...O,[I]:F==="number"?parseFloat(V):V}))},T=async P=>{if(P.preventDefault(),!e){g("Plan ID is missing.");return}if(f(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),f(!1);return}try{await YR(e,a),v({type:"success",message:"Clinic plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(I){const V=I.message||"Failed to update clinic plan.";g(V),v({type:"error",message:V})}finally{f(!1)}},E=()=>{n(-1)};return u?i.jsx("div",{className:"p-6 text-center",children:"Loading clinic plan details..."}):h&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:h}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx(Ua,{size:18,className:"mr-2"}):i.jsx(si,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(Kn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Clinic Subscription Plan"}),h&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:h}),i.jsxs("form",{onSubmit:T,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price!==void 0?a.price:"",onChange:k,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval!==void 0?a.interval:"",onChange:k,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:E,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:o,className:"subscription-btn",children:[o?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,o?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Clinic plan not found."})},_te=()=>{const e=wt(),[n,t]=w.useState([]),[r,a]=w.useState(""),[l,o]=w.useState(!0),[f,u]=w.useState(null),[d,h]=w.useState(!1),[g,b]=w.useState(null),v=w.useCallback(async()=>{u(null);try{const T=(await nw()).filter(E=>E.status==="active");t(T),T.length>0&&!r&&a(T[0].id)}catch(k){console.error("Error fetching plans:",k),u(`Failed to load subscription plans: ${k.message}`)}},[]);w.useEffect(()=>{(async()=>{o(!0);try{const T=await JR();if(T&&T.short_url){window.location.href=T.short_url,u("You have a pending subscription. Redirecting to payment...");return}await v()}catch(T){console.error("Error during initial page load:",T),u(`An unexpected error occurred: ${T.message}`)}finally{o(!1)}})()},[v]);const S=async()=>{if(!r){b("Please select a clinic subscription plan.");return}const k=n.find(T=>T.id===r);if(!k){b("Selected plan details not found.");return}h(!0),b(null);try{console.log("Initiating Razorpay clinic subscription for plan:",k);const T=await QR(r);if(T&&T.short_url)window.location.href=T.short_url;else throw new Error("Failed to get Razorpay clinic subscription link from backend.")}catch(T){console.error("Error starting clinic subscription:",T),b(`Failed to start clinic subscription: ${T.message}`),h(!1)}};return l?i.jsx("div",{className:"loading-state-subscription",children:"Loading clinic plans..."}):f?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:f})]}),i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(Ht,{size:16}),"Back"]})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(Ht,{size:16}),"Back"]}),i.jsxs("h1",{children:[i.jsx(CP,{size:28}),"Buy Pro Plan for Clinic"]}),g&&i.jsx("div",{className:"error-alert-subscription",role:"alert",children:i.jsx("span",{children:g})}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h2",{children:"Available Pro Plans"}),n.length===0?i.jsx("p",{className:"empty-state",children:"No active clinic subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:n.map(k=>i.jsxs("div",{className:`subscription-plan-card ${r===k.id?"selected-plan":""}`,onClick:()=>a(k.id),children:[i.jsx("h3",{children:k.name}),i.jsxs("p",{className:"price",children:["",Number(k.price).toFixed(2)]}),i.jsxs("p",{className:"duration",children:["Every ",k.interval," ",k.period,k.interval>1?"s":""]}),k.description&&i.jsx("p",{children:k.description})]},k.id))})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:S,disabled:!r||d||n.length===0,className:"subscription-btn",children:[d&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),d?"Initiating Payment...":"Buy Pro Plan"]})})]})},kte=()=>{const e=wt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[l,o]=w.useState(null),[f,u]=w.useState(!1),[d,h]=w.useState(!1),[g,b]=w.useState(null),[v,S]=w.useState({name:"",email:"",password:"",role:"user"}),[k,T]=w.useState({name:"",email:"",role:"",password:"",confirmPassword:""}),[E,P]=w.useState(""),[I,V]=w.useState(""),[F,O]=w.useState({}),[B,U]=w.useState(!1),[z,$]=w.useState(null),[R,H]=w.useState([]),[ee,Z]=w.useState(""),[te,Q]=w.useState(!1),[q,W]=w.useState(null);w.useEffect(()=>{const ue=setTimeout(()=>{V(E)},500);return()=>{clearTimeout(ue)}},[E]),w.useEffect(()=>{ne(I)},[I]);const ne=async(ue="")=>{a(!0);try{const ze=ue?`/api/users?search=${encodeURIComponent(ue)}`:"/api/users",ft=await(await fe(ze)).json();if(t(ft),ft.length>0){const Re=[...new Set(ft.map(he=>he.clinic_id).filter(he=>!!he))],je={};await Promise.all(Re.map(async he=>{try{const Ae=await VR(he);je[he]=Ae}catch(Ae){console.error(`Failed to fetch subscription status for clinic ${he}`,Ae),je[he]={hasProPlan:!1}}})),O(je)}o(null)}catch(ze){o("Failed to fetch users."),console.error(ze)}finally{a(!1)}},A=async ue=>{ue.preventDefault();try{await fe("/users",{method:"POST",body:JSON.stringify(v)}),u(!1),S({name:"",email:"",password:"",role:"user"}),ne()}catch(ze){o("Failed to add user."),console.error(ze)}},ie=async ue=>{if(ue.preventDefault(),!g)return;const{password:ze,confirmPassword:tt,...ft}=k,Re={...ft};if(ze){if(ze.length<6){o("Password must be at least 6 characters long.");return}if(ze!==tt){o("Passwords do not match.");return}Re.password=ze}try{await fe(`/users/${g.id}`,{method:"PUT",body:JSON.stringify(Re)}),h(!1),b(null),T({...k,password:"",confirmPassword:""}),ne()}catch(je){o("Failed to update user."),console.error(je)}},se=async ue=>{if(window.confirm("Are you sure you want to delete this user?"))try{await fe(`/users/${ue}`,{method:"DELETE"}),ne()}catch(ze){o("Failed to delete user."),console.error(ze)}},M=ue=>{b(ue),T({name:ue.name,email:ue.email,role:ue.role,password:"",confirmPassword:""}),h(!0)},ce=async()=>{Q(!0);try{const ue=await nw();H(ue),ue.length>0&&Z(ue[0].id),W(null)}catch(ue){W("Failed to fetch subscription plans."),console.error(ue)}finally{Q(!1)}},ve=ue=>{$(ue),U(!0),ce()},le=async ue=>{if(ue.preventDefault(),!z||!ee){o("Please select a clinic and a plan.");return}try{await fe("/clinic-subscriptions/manual-activate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicId:z,planId:ee})}),U(!1),$(null),Z(""),ne(),o(null)}catch(ze){o("Failed to manually activate clinic subscription."),console.error(ze)}},xe=async ue=>{if(window.confirm("Are you sure you want to cancel this clinic's subscription? This action cannot be undone."))try{await qR(ue),ne(),o(null)}catch(ze){o("Failed to cancel subscription."),console.error(ze)}};return r?i.jsx("div",{children:"Loading users..."}):l?i.jsx("div",{className:"error-message",children:l}):i.jsxs("div",{className:"user-management-page",children:[i.jsxs("div",{className:"user-management-header",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(Ht,{size:16}),"Back"]}),i.jsx("h1",{children:"User Management"})]}),i.jsxs("div",{className:"controls-container",children:[i.jsx("input",{type:"text",placeholder:"Search by name or email...",value:E,onChange:ue=>P(ue.target.value),className:"search-input"}),i.jsx("button",{onClick:()=>u(!0),className:"add-user-button",children:"Add New User"})]}),f&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>u(!1),children:""}),i.jsx("h2",{children:"Add New User"}),i.jsxs("form",{onSubmit:A,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:v.name,onChange:ue=>S({...v,name:ue.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:v.email,onChange:ue=>S({...v,email:ue.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Password:"}),i.jsx("input",{type:"password",value:v.password,onChange:ue=>S({...v,password:ue.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:v.role,onChange:ue=>S({...v,role:ue.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsx("button",{type:"submit",children:"Add User"})]})]})}),d&&g&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>h(!1),children:""}),i.jsx("h2",{children:"Edit User"}),i.jsxs("form",{onSubmit:ie,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:k.name,onChange:ue=>T({...k,name:ue.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:k.email,onChange:ue=>T({...k,email:ue.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:k.role,onChange:ue=>T({...k,role:ue.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"New Password (optional):"}),i.jsx("input",{type:"password",value:k.password,onChange:ue=>T({...k,password:ue.target.value})})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Confirm New Password:"}),i.jsx("input",{type:"password",value:k.confirmPassword,onChange:ue=>T({...k,confirmPassword:ue.target.value})})]}),i.jsx("button",{type:"submit",children:"Update User"})]})]})}),B&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>U(!1),children:""}),i.jsx("h2",{children:"Select Subscription Plan for Clinic"}),te&&i.jsx("div",{children:"Loading plans..."}),q&&i.jsx("div",{className:"error-message",children:q}),!te&&!q&&R.length===0&&i.jsx("div",{children:"No active subscription plans available."}),!te&&!q&&R.length>0&&i.jsxs("form",{onSubmit:le,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Select Plan:"}),i.jsx("select",{value:ee,onChange:ue=>Z(ue.target.value),required:!0,children:R.map(ue=>i.jsxs("option",{value:ue.id,children:[ue.name," - $",ue.price,"/",ue.interval," ",ue.period]},ue.id))})]}),i.jsx("button",{type:"submit",children:"Activate Selected Plan"})]})]})}),i.jsxs("table",{className:"user-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Role"}),i.jsx("th",{children:"Clinic ID"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:n.map(ue=>{const ze=ue.clinic_id||"N/A",tt=ze!=="N/A"?F[ze]:null,ft=(tt==null?void 0:tt.hasProPlan)??!1,Re=ft?"PRO":"Standard";return i.jsxs("tr",{children:[i.jsx("td",{children:ue.name}),i.jsx("td",{children:ue.email}),i.jsx("td",{children:ue.role}),i.jsx("td",{children:ze}),i.jsx("td",{children:ze!=="N/A"?i.jsx("span",{className:ft?"pro-badge":"standard-badge",children:Re}):"N/A"}),i.jsxs("td",{children:[i.jsx("button",{onClick:()=>M(ue),className:"edit-button",children:"Edit"}),i.jsx("button",{onClick:()=>se(ue.id),className:"delete-button",children:"Delete"}),ue.clinic_id&&!ft&&i.jsx("button",{onClick:()=>ve(ue.clinic_id),className:"start-subscription-button",children:"Start Subscription"}),ue.clinic_id&&ft&&i.jsx("button",{onClick:()=>xe(ue.clinic_id),className:"cancel-subscription-button",children:"Cancel Subscription"})]})]},ue.id)})})]})]})},Ete=()=>{const[e,n]=w.useState(""),[t,r]=w.useState(!0),[a,l]=w.useState(null);w.useEffect(()=>{(async()=>{try{const u=eb();if(!u)throw new Error("Authentication token not found.");const h=await(await fe("/api/super-admin-settings/gemini-api-key",{headers:{Authorization:`Bearer ${u}`}})).json();n(h.gemini_api_key||"")}catch(u){console.error("Error fetching Gemini API key:",u),l({type:"error",text:"Failed to fetch Gemini API key."})}finally{r(!1)}})()},[]);const o=async()=>{r(!0),l(null);try{const f=eb();if(!f)throw new Error("Authentication token not found.");await fe("/api/super-admin-settings/gemini-api-key",{method:"PUT",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"},body:JSON.stringify({gemini_api_key:e})}),l({type:"success",text:"Gemini API key updated successfully!"})}catch(f){console.error("Error updating Gemini API key:",f),l({type:"error",text:"Failed to update Gemini API key."})}finally{r(!1)}};return i.jsxs("div",{className:"admin-panel-container",children:[i.jsxs("h1",{className:"admin-panel-title",children:[i.jsx(dg,{size:32,className:"icon-margin"}),"Super Admin Dashboard"]}),i.jsxs("div",{className:"admin-panel-grid",children:[i.jsxs(hs,{to:"/dashboard/clinic-subscriptions",className:"admin-panel-card",children:[i.jsx(zd,{size:48,className:"card-icon"}),i.jsx("h2",{children:"Manage Clinic Subscription Plans"}),i.jsx("p",{children:"Add, edit, and view clinic subscription plans."})]}),i.jsxs(hs,{to:"/dashboard/users",className:"admin-panel-card",children:[i.jsx(zh,{size:48,className:"card-icon"}),i.jsx("h2",{children:"User Management"}),i.jsx("p",{children:"Add, edit, and delete users; manage user roles."})]}),i.jsxs("div",{className:"admin-panel-card",children:[i.jsx(oI,{size:48,className:"card-icon"}),i.jsx("h2",{children:"Global Gemini API Key"}),i.jsx("p",{children:"Set the global default Gemini API key."}),i.jsxs("div",{className:"flex flex-col mt-4",children:[i.jsx("input",{type:"password",value:e,onChange:f=>n(f.target.value),placeholder:"Enter Global Gemini API Key",className:"p-2 border border-gray-300 rounded mb-2",disabled:t}),i.jsx("button",{onClick:o,className:"bg-blue-500 text-white p-2 rounded hover:bg-blue-600 disabled:bg-blue-300",disabled:t,children:t?"Saving...":"Save Global API Key"}),a&&i.jsx("p",{className:`mt-2 text-sm ${a.type==="success"?"text-green-600":"text-red-600"}`,children:a.text})]})]})]})]})},Um="tutorialCurrentStep",AT=({onActionComplete:e,onStaffAdded:n,requiredRole:t})=>{const[r,a]=w.useState(""),[l,o]=w.useState(""),[f,u]=w.useState(""),[d,h]=w.useState(!1),g=t||"receptionist";w.useEffect(()=>{a(t==="lab"?"Lab":t==="pharmacy"?"Pharmacy":"")},[t]);const b=async()=>{if(!r||!l||!f){e(!1,"Please fill all fields.");return}h(!0);try{const v=await fe("/api/staff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,email:l,role:g,password:f})});if(v.ok)e(!0,`Successfully added "${r}" as a ${g}!`),a(""),o(""),u(""),n&&n(g);else{const S=await v.json();e(!1,`Failed to add staff: ${S.message||v.statusText}`)}}catch(v){console.error("Error adding staff:",v),e(!1,`Error adding staff: ${v instanceof Error?v.message:String(v)}`)}finally{h(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("h3",{children:"Add a New Staff Member"}),i.jsx("input",{type:"text",placeholder:"Staff Name",value:r,onChange:v=>a(v.target.value),className:"tutorial-input",disabled:d}),i.jsx("input",{type:"email",placeholder:"Email",value:l,onChange:v=>o(v.target.value),className:"tutorial-input",disabled:d}),i.jsx("input",{type:"password",placeholder:"Password",value:f,onChange:v=>u(v.target.value),className:"tutorial-input",disabled:d}),i.jsx("input",{type:"text",placeholder:"Role",value:g==="lab"?"Lab Technician":g==="pharmacy"?"Pharmacist":"Receptionist",className:"tutorial-input",disabled:!0}),i.jsx("button",{onClick:b,className:"tutorial-button primary",disabled:d,children:d?"Adding...":"Add Staff"})]})},Tte=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState([]),[l,o]=w.useState(!1),f=async()=>{t(!0);try{const u=await fe("/api/drugs/import-defaults",{method:"POST"});if(u.ok){const d=await u.json(),h=d.drugs?d.drugs.map(g=>g.name):[];a(h),o(!0),e(!0,`Default medications imported: Added ${d.details.added}, Updated ${d.details.updated}.`,"pharmacyImport")}else{const d=await u.json();e(!1,`Failed to import default medications: ${d.message||u.statusText}`)}}catch(u){console.error("Error importing default medications:",u),e(!1,`Error importing default medications: ${u instanceof Error?u.message:String(u)}`)}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("h3",{children:"Import Default Medications"}),i.jsx("p",{children:"Click the button below to populate your pharmacy inventory with a list of common medications."}),i.jsx("button",{onClick:f,className:"tutorial-button primary",disabled:n,children:n?"Importing...":i.jsxs(i.Fragment,{children:[" ",i.jsx("i",{className:"fas fa-pills"})," Import Default Drugs"]})}),l&&r.length>0&&i.jsxs("div",{className:"imported-drugs-list",children:[i.jsx("h4",{children:"Medications Imported:"}),i.jsx("ul",{children:r.map((u,d)=>i.jsx("li",{children:u},d))})]})]})},Ate=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState([]),[l,o]=w.useState(!1),f=async()=>{t(!0);try{const u=await fe("/api/lab-tests/import-defaults",{method:"POST"});if(u.ok){const d=await u.json(),h=d.tests?d.tests.map(g=>g.name):[];a(h),o(!0),e(!0,`Default lab tests imported: Added ${d.details.added}, Updated ${d.details.updated}.`,"labImport")}else{const d=await u.json();e(!1,`Failed to import default lab tests: ${d.message||u.statusText}`)}}catch(u){console.error("Error importing default lab tests:",u),e(!1,`Error importing default lab tests: ${u instanceof Error?u.message:String(u)}`)}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("h3",{children:"Import Default Lab Tests"}),i.jsx("p",{children:"Click the button below to populate your lab test inventory with a list of common tests."}),i.jsx("button",{onClick:f,className:"tutorial-button primary",disabled:n,children:n?"Importing...":i.jsxs(i.Fragment,{children:[" ",i.jsx("i",{className:"fas fa-flask"})," Import Default Lab Tests"]})}),l&&r.length>0&&i.jsxs("div",{className:"imported-drugs-list",children:[i.jsx("h4",{children:"Tests Imported:"}),i.jsx("ul",{children:r.map((u,d)=>i.jsx("li",{children:u},d))})]})]})},qm=[{title:"Welcome to Your Admin Dashboard!",description:"This quick tour will guide you through essential features to get your clinic set up.",actionText:"Let's Start!",actionPath:null,component:null},{title:"Step 1: Manage Pharmacy Inventory",description:"Set up your pharmacy by adding drugs, managing stock levels, and importing default drug lists. This ensures smooth prescription fulfillment. Import default medications now!",actionText:"Go to Pharmacy Inventory",actionPath:"/dashboard/inventory",component:Tte},{title:"Step 2: Manage Lab Test Inventory",description:"Configure your laboratory by adding available lab tests and importing default test lists. This is crucial for accurate diagnostics. Import default lab tests now!",actionText:"Go to Lab Test Inventory",actionPath:"/lab-inventory",component:Ate},{title:"Step 3: Add Staff Members (Optional)",description:"You can add your clinic's staff, including doctors, receptionists, lab technicians, and pharmacists. Each role has specific permissions. You can skip this step for now.",actionText:"Go to Staff Management",actionPath:null,component:AT},{title:"You're All Set!",description:"You've completed the basic setup tour. Now, try out the AI-powered complaint analysis feature!",actionText:"Try the AI!",actionPath:"/edit-complaints",component:null}],Dte=({onClose:e,onMarkAsSeen:n})=>{const[t,r]=w.useState(()=>{const F=localStorage.getItem(Um);return F?parseInt(F,10):0}),[a,l]=w.useState(null),[o,f]=w.useState(null),[u,d]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(4),S=wt();w.useEffect(()=>{if(localStorage.setItem(Um,t.toString()),l(null),f(null),t===0){v(4);const F=setTimeout(()=>{r(B=>B+1)},4e3),O=setInterval(()=>{v(B=>B-1)},1e3);return()=>{clearTimeout(F),clearInterval(O)}}},[t]);const k=(F,O,B)=>{f(F),l(O),F&&(B==="pharmacyImport"||B==="labImport")&&r(U=>U+1)},T=()=>{},E=()=>{n(),e(),localStorage.removeItem(Um)},P=async()=>{const F=qm[t];if(V&&F.actionPath==="/edit-complaints"){d(!0),g(null);try{const O=await fe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"New Patient - AI Entry",age:null,gender:null,phone:null,address:null})});if(!O.ok){const H=await O.text();throw new Error(`Failed to create patient: ${H||O.statusText} (${O.status})`)}const B=await O.json();if(!B||!B.id)throw new Error("Failed to create new patient or retrieve patient ID.");const U=B.id,z=await fe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:U,complaint:""})});if(!z.ok){const H=await z.text();throw new Error(`Failed to create queue entry: ${H||z.statusText} (${z.status})`)}const $=await z.json();if(!$||!$.id)throw new Error("Failed to create new complaint record or retrieve record ID.");const R=$.id;S(`/dashboard/edit-complaint/${R}`),e(),n(),localStorage.removeItem(Um)}catch(O){console.error("Error starting new AI complaint:",O);const B=`Error: ${O.message||"Failed to start new AI complaint process."}`;g(B)}finally{d(!1)}}else F.actionPath&&(S(F.actionPath),e(),t===qm.length-1&&(n(),localStorage.removeItem(Um)))},I=qm[t],V=t===qm.length-1;return i.jsx("div",{className:"tutorial-modal-overlay",children:i.jsxs("div",{className:"tutorial-modal-content",children:[i.jsx("h2",{children:I.title}),i.jsx("p",{children:I.description}),I.component&&i.jsxs("div",{className:"tutorial-interactive-area",children:[t===3?i.jsx(AT,{onActionComplete:k,onStaffAdded:T,requiredRole:null}):i.jsx(I.component,{onActionComplete:k}),a&&i.jsx("p",{className:`tutorial-message ${o?"success":"error"}`,children:a})]}),h&&i.jsx("p",{className:"tutorial-message error",children:h})," ",i.jsxs("div",{className:"tutorial-modal-actions",children:[I.actionPath&&i.jsx("button",{onClick:P,className:"tutorial-button action",disabled:u,children:u?"Creating AI Patient...":I.actionText}),t===3&&i.jsx("button",{onClick:()=>r(t+1),className:"tutorial-button secondary",children:"Next Step"}),i.jsx("button",{onClick:E,className:"tutorial-button secondary",disabled:u,children:"Skip Tutorial"})]}),t===0&&i.jsxs("div",{className:"tutorial-countdown-indicator",children:["Next step in ",b," seconds..."]}),i.jsxs("div",{className:"tutorial-step-indicator",children:["Step ",t+1," of ",qm.length]})]})})},Pte=(e,n,t)=>{const r=Math.abs(e.getTime()-n.getTime());return Math.ceil(r/(1e3*60*60*24))<=t},e_=e=>{if(e.match(/^\d{4}-\d{2}-\d{2}$/))return new Date(e);const n=e.split("/");if(n.length===3){const t=parseInt(n[0],10),r=parseInt(n[1],10)-1,a=parseInt(n[2],10),l=new Date(a,r,t),o=parseInt(n[0],10)-1,f=parseInt(n[1],10),u=parseInt(n[2],10),d=new Date(u,o,f),h=!isNaN(l.getTime()),g=!isNaN(d.getTime());if(h&&g)return l;if(h)return l;if(g)return d}return new Date(e)},DT=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,l]=w.useState(null),[o,f]=w.useState(""),[u,d]=w.useState(""),[h,g]=w.useState(1),[b]=w.useState(10),v=new Date,S=wt();w.useEffect(()=>{(async()=>{r(!0);try{const $=await fe("/api/pharmacy-orders/refill-reminders");if($.ok){const R=await $.json();n(R)}else l("Failed to fetch refill reminders.")}catch{l("An error occurred while fetching data.")}finally{r(!1)}})()},[]);const k=U=>{f(U.target.value),g(1)},T=U=>{d(U.target.value),g(1)},E=e.filter(U=>{const z=o?U.medicationRefillDates.some(R=>{const H=e_(R.refillDate);return!isNaN(H.getTime())&&H.toISOString().split("T")[0]===o}):!0,$=u?U.patientName.toLowerCase().includes(u.toLowerCase())||U.patientPhoneNumber.includes(u)||U.items.some(R=>R.name.toLowerCase().includes(u.toLowerCase())):!0;return z&&$}),P=h*b,I=P-b,V=E.slice(I,P),F=Math.ceil(E.length/b),O=U=>g(U),B=async U=>{try{const z=await fe(`/api/queue/patient/${U}/latest`);if(z.ok){const R=await z.json();if(R!=null&&R._id){S(`/dashboard/edit-complaint/${R._id}`,{state:{patientId:U}});return}}const $=await fe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:U})});if($.ok){const R=await $.json();R!=null&&R.id&&S(`/dashboard/edit-complaint/${R.id}`,{state:{patientId:U}})}}catch(z){console.error("Error handling row click:",z),l("Failed to navigate to patient complaint.")}};return t?i.jsx("div",{children:"Loading..."}):a?i.jsx("div",{children:a}):i.jsxs("div",{className:"refill-reminders-container",children:[i.jsx("h1",{children:"Refill Reminders"}),i.jsxs("div",{className:"controls-container",children:[i.jsxs("div",{className:"filter-container",children:[i.jsx("label",{htmlFor:"refillDate",children:"Filter by Refill Date: "}),i.jsx("input",{type:"date",id:"refillDate",value:o,onChange:k})]}),i.jsxs("div",{className:"search-container",children:[i.jsx("label",{htmlFor:"search",children:"Search: "}),i.jsx("input",{type:"text",id:"search",placeholder:"Search by patient name, phone, or medication",value:u,onChange:T})]})]}),i.jsxs("table",{children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient Name"}),i.jsx("th",{children:"Patient Phone Number"}),i.jsx("th",{children:"Medications"}),i.jsx("th",{children:"Refill Dates"})]})}),i.jsx("tbody",{children:V.length>0?V.map(U=>i.jsxs("tr",{onClick:()=>B(U.patientId),style:{cursor:"pointer"},children:[i.jsx("td",{children:U.patientName}),i.jsx("td",{children:U.patientPhoneNumber}),i.jsxs("td",{children:[i.jsx("ul",{children:U.items.map((z,$)=>i.jsxs("li",{children:[z.name," (Qty: ",z.quantity,")",z.tabletsPerDay&&i.jsxs("span",{children:[" - ",z.tabletsPerDay," / day"]}),z.numberOfDays&&i.jsxs("span",{children:[" for ",z.numberOfDays," days"]})]},$))}),i.jsxs("div",{children:["Last Updated: ",new Date(U.updatedAt).toLocaleDateString()]}),U.prescription_for_unavailable_drugs&&i.jsxs("div",{className:"unavailable-prescription",children:[i.jsx("strong",{children:"Unavailable:"})," ",U.prescription_for_unavailable_drugs]})]}),i.jsx("td",{children:i.jsx("ul",{children:U.medicationRefillDates.map((z,$)=>{const R=e_(z.refillDate),H=!isNaN(R.getTime())&&Pte(R,v,2);return i.jsxs("li",{className:H?"highlight-refill-date":"",children:[z.name,": ",isNaN(R.getTime())?"Invalid Date":R.toLocaleDateString()]},$)})})})]},U.id)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:"No refill reminders found."})})})]}),i.jsxs("div",{className:"pagination-container",children:[i.jsx("button",{onClick:()=>O(h-1),disabled:h===1,children:"Previous"}),Array.from({length:F},(U,z)=>i.jsx("button",{onClick:()=>O(z+1),className:h===z+1?"active":"",children:z+1},z+1)),i.jsx("button",{onClick:()=>O(h+1),disabled:h===F,children:"Next"})]})]})},Ite=()=>{const e=wt(),n=gr();return w.useEffect(()=>{const t=new URLSearchParams(n.search),r=t.get("token"),a=t.get("caseDetails");r?(async()=>{try{const o=await fe(`/api/patients?search=${r}&limit=1`);if(!o.ok)throw new Error("Failed to fetch patient by token");const u=(await o.json()).patients[0];if(!u)throw new Error("Patient with the given token not found");const d=await fe(`/api/queue/patient/${u.id}/latest`);if(d.ok){const b=await d.json();if(b!=null&&b._id){e(`/dashboard/edit-complaint/${b._id}`,{state:{initialComplaint:a,patientId:u.id}});return}}const h=await fe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:u.id,complaint:a})});if(!h.ok)throw new Error("Failed to create queue entry");const g=await h.json();if(g!=null&&g.id)e(`/dashboard/edit-complaint/${g.id}`,{state:{initialComplaint:a,patientId:u.id}});else throw new Error("Failed to get ID from new queue entry.")}catch(o){console.error("Error handling complaint URL:",o),e("/dashboard/search-patient")}})():e("/dashboard/search-patient")},[n,e]),i.jsx("div",{children:"Loading..."})},Mte=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,l]=w.useState(null),[o,f]=w.useState("all"),[u,d]=w.useState(""),h=w.useCallback(async()=>{r(!0),l(null);try{const k=await fe("/api/notifications?all=true");if(k.ok){const T=await k.json(),E=new Date,P=new Date(E.getFullYear(),E.getMonth()+1,0).getDate(),I=E.getDate()===P,F=T.filter(O=>O.type==="low_stock"||O.type==="near_expiry_drug"?!1:O.type==="expired_drug"?I:!0).sort((O,B)=>{const U={expired_drug:1,near_expiry_drug:2,low_stock:3},z=U[O.type]||99,$=U[B.type]||99;return z!==$?z-$:new Date(B.created_at).getTime()-new Date(O.created_at).getTime()});n(F)}else l("Failed to fetch notifications."),console.error("Failed to fetch notifications:",k.statusText)}catch(k){l("Error fetching notifications."),console.error("Error fetching notifications:",k)}finally{r(!1)}},[]);w.useEffect(()=>{h()},[h]);const g=async k=>{try{const T=await fe(`/api/notifications/${k}/read`,{method:"PUT"});T.ok?n(E=>E.map(P=>P.id===k?{...P,is_read:!0}:P)):console.error("Failed to mark notification as read:",T.statusText)}catch(T){console.error("Error marking notification as read:",T)}},b=async(k,T)=>{if(window.confirm("Are you sure you want to delete this expired drug from the inventory? This action cannot be undone."))try{const E=await fe(`/api/drugs/${k}`,{method:"DELETE"});if(E.ok)alert("Drug deleted successfully."),await g(T);else{const P=await E.json();alert(`Failed to delete drug: ${P.message||E.statusText}`)}}catch(E){console.error("Error deleting drug:",E),alert("An error occurred while trying to delete the drug.")}},v=async()=>{try{const k=e.filter(E=>!E.is_read).map(E=>E.id);if(k.length===0)return;const T=await fe("/api/notifications/mark-all-read",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationIds:k})});T.ok?n(E=>E.map(P=>({...P,is_read:!0}))):console.error("Failed to mark all notifications as read:",T.statusText)}catch(k){console.error("Error marking all notifications as read:",k)}},S=e.filter(k=>{const T=k.message.toLowerCase().includes(u.toLowerCase()),E=o==="all"||o==="unread"&&!k.is_read||o==="expired"&&k.type==="expired_drug";return T&&E});return t?i.jsx("div",{className:"notifications-page-container",children:"Loading notifications..."}):a?i.jsx("div",{className:"notifications-page-container error-message",children:a}):i.jsxs("div",{className:"notifications-page-container",children:[i.jsx("h2",{className:"notifications-page-title",children:"All Notifications"}),i.jsxs("div",{className:"notifications-controls",children:[i.jsxs("div",{className:"filters-group",children:[i.jsx("input",{type:"text",placeholder:"Search notifications...",value:u,onChange:k=>d(k.target.value),className:"search-input"}),i.jsxs("select",{value:o,onChange:k=>f(k.target.value),className:"type-filter",children:[i.jsx("option",{value:"all",children:"All Notifications"}),i.jsx("option",{value:"unread",children:"Unread Only"}),i.jsx("option",{value:"expired",children:"Expired Drugs"})]})]}),i.jsx("div",{className:"notifications-actions",children:i.jsx("button",{onClick:v,disabled:e.every(k=>k.is_read),className:"mark-all-read-button",children:"Mark All As Read"})})]}),S.length===0?i.jsx("p",{className:"no-notifications-message",children:"No notifications matching your criteria."}):i.jsx("ul",{className:"notifications-list",children:S.map(k=>i.jsxs("li",{className:`notification-item ${k.is_read?"read":"unread"}`,children:[i.jsxs("div",{className:"notification-main",children:[i.jsxs("div",{className:"notification-content",children:[i.jsx("span",{className:`notification-badge ${k.type}`,children:k.type.replace(/_/g," ")}),i.jsx("p",{className:"notification-message",children:k.message})]}),i.jsxs("div",{className:"notification-fix-actions",children:[k.type==="expired_drug"&&k.related_entity_id&&i.jsx("button",{onClick:()=>b(k.related_entity_id,k.id),className:"fix-button delete-drug",title:"Delete this expired drug from inventory",children:"Delete from Inventory"}),k.type==="low_stock"&&i.jsx("button",{className:"fix-button restock-drug",onClick:()=>window.location.href="/dashboard/inventory",children:"Restock"})]})]}),i.jsxs("div",{className:"notification-meta",children:[i.jsx("span",{className:"notification-timestamp",children:new Date(k.created_at).toLocaleString()}),!k.is_read&&i.jsx("button",{onClick:()=>g(k.id),className:"mark-read-button",children:"Mark as Read"})]})]},k.id))})]})},t_=()=>{const e=wt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[l,o]=w.useState(null),[f,u]=w.useState(!1),[d,h]=w.useState(!1),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[E,P]=w.useState(null),[I,V]=w.useState([]),[F,O]=w.useState(null),[B,U]=w.useState(""),[z,$]=w.useState(""),[R,H]=w.useState(""),[ee,Z]=w.useState(""),[te,Q]=w.useState(""),[q,W]=w.useState(""),[ne,A]=w.useState(""),[ie,se]=w.useState(""),[M,ce]=w.useState(""),[ve,le]=w.useState(""),[xe,ue]=w.useState(""),ze=w.useCallback(async()=>{a(!0),o(null);try{const oe=await fe("/api/distributors");if(!oe.ok)throw new Error(`Failed to fetch distributors: ${oe.statusText}`);const J=await oe.json();t(J)}catch(oe){console.error("Failed to fetch distributors:",oe),o(oe.message||"Failed to load distributors.")}finally{a(!1)}},[]);w.useEffect(()=>{ze()},[ze]);const tt=async oe=>{oe.preventDefault(),o(null);try{const J=await fe("/api/distributors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:B,contact_person:z,phone:R,email:ee,address:te,gst_number:q,drug_license_number:ne})});if(!J.ok){const de=await J.json();throw new Error(de.message||"Failed to add distributor.")}alert("Distributor added successfully!"),we(),ze()}catch(J){console.error("Error adding distributor:",J),o(J.message||"Failed to add distributor.")}},ft=async oe=>{if(oe.preventDefault(),o(null),!!E)try{const J=await fe(`/api/distributors/${E.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:B,contact_person:z,phone:R,email:ee,address:te,gst_number:q,drug_license_number:ne})});if(!J.ok){const de=await J.json();throw new Error(de.message||"Failed to update distributor.")}alert("Distributor updated successfully!"),De(),ze()}catch(J){console.error("Error updating distributor:",J),o(J.message||"Failed to update distributor.")}},Re=async()=>{if(o(null),!!E)try{const oe=await fe(`/api/distributors/${E.id}`,{method:"DELETE"});if(!oe.ok){const J=await oe.json();throw new Error(J.message||"Failed to delete distributor.")}alert("Distributor deleted successfully!"),nt(),ze()}catch(oe){console.error("Error deleting distributor:",oe),o(oe.message||"Failed to delete distributor.")}},je=w.useCallback(async oe=>{o(null);try{const J=await fe(`/api/distributors/${oe}/payments`);if(!J.ok)throw new Error(`Failed to fetch payments: ${J.statusText}`);const Be=(await J.json()).map($e=>({...$e,order_value:parseFloat($e.order_value),amount_paid:parseFloat($e.amount_paid),balance_remaining:parseFloat($e.balance_remaining)}));V(Be);const be=await fe(`/api/distributors/${oe}/balance`);if(!be.ok)throw new Error(`Failed to fetch balance: ${be.statusText}`);const Fe=await be.json();O({totalOrderValue:parseFloat(Fe.totalOrderValue),totalAmountPaid:parseFloat(Fe.totalAmountPaid),remainingBalance:parseFloat(Fe.remainingBalance)})}catch(J){console.error("Error fetching payments/balance:",J),o(J.message||"Failed to load payments or balance.")}},[]),he=async oe=>{if(oe.preventDefault(),o(null),!!E)try{const J=await fe(`/api/distributors/${E.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:ie,order_value:parseFloat(M||"0"),amount_paid:parseFloat(ve||"0"),notes:xe})});if(!J.ok){const de=await J.json();throw new Error(de.message||"Failed to add payment.")}alert("Payment added successfully!"),Vt(),je(E.id)}catch(J){console.error("Error adding payment:",J),o(J.message||"Failed to add payment.")}},Ae=()=>{U(""),$(""),H(""),Z(""),Q(""),W(""),A(""),o(null),u(!0)},we=()=>{u(!1)},Me=oe=>{P(oe),U(oe.name),$(oe.contact_person||""),H(oe.phone||""),Z(oe.email||""),Q(oe.address||""),W(oe.gst_number||""),A(oe.drug_license_number||""),o(null),h(!0)},De=()=>{h(!1),P(null)},Je=oe=>{P(oe),o(null),b(!0)},nt=()=>{b(!1),P(null)},Ge=oe=>{P(oe),je(oe.id),o(null),S(!0)},St=()=>{S(!1),P(null),V([]),O(null)},It=oe=>{P(oe),se(new Date().toISOString().split("T")[0]),ce("0"),le("0"),ue(""),o(null),T(!0)},Vt=()=>{T(!1),P(null)};return r?i.jsx("div",{className:"loading-indicator",children:"Loading Distributors..."}):l?i.jsxs("div",{className:"error-indicator",children:["Error: ",l]}):i.jsxs("div",{className:"distributor-management-page",children:[i.jsxs("div",{className:"distributor-management-header",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[i.jsx(Ht,{size:24})," Back"]}),i.jsx("h2",{children:"Distributor Management"})]}),(()=>{const oe=n.reduce((de,Be)=>de+parseFloat(Be.remainingBalance||"0"),0),J=oe>=0?"balance-positive":"balance-negative";return i.jsxs("div",{className:`total-balance-display ${J}`,children:[i.jsx("strong",{children:"Total Combined Balance:"})," ",oe.toFixed(2)]})})(),i.jsxs("button",{onClick:Ae,className:"add-distributor-button",children:[i.jsx(Fo,{size:18}),"Add New Distributor"]})]}),i.jsx("div",{className:"distributor-table-container",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Contact Person"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Address"}),i.jsx("th",{children:"GST Number"})," ",i.jsx("th",{children:"Drug License Number"})," ",i.jsx("th",{children:"Remaining Balance"})," ",i.jsx("th",{className:"actions-cell",children:"Actions"})]})}),i.jsx("tbody",{children:n.length===0?i.jsxs("tr",{children:[i.jsx("td",{colSpan:9,className:"no-results-message",children:"No distributors found."})," "]}):n.map(oe=>i.jsxs("tr",{children:[i.jsx("td",{children:oe.name}),i.jsx("td",{children:oe.contact_person||"-"}),i.jsx("td",{children:oe.phone||"-"}),i.jsx("td",{children:oe.email||"-"}),i.jsx("td",{children:oe.address||"-"}),i.jsx("td",{children:oe.gst_number||"-"})," ",i.jsx("td",{children:oe.drug_license_number||"-"})," ",i.jsxs("td",{className:parseFloat(oe.remainingBalance||"0")>0?"balance-positive":"balance-negative",children:["",oe.remainingBalance||"0.00"]})," ",i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsxs("button",{onClick:()=>Ge(oe),className:"action-text-button view-button",title:"View Payments & Balance",children:[i.jsx(T_,{size:16})," View Payments"]}),i.jsxs("button",{onClick:()=>It(oe),className:"action-text-button add-payment-button",title:"Add Payment",children:[i.jsx(Fo,{size:16})," Add Payment"]}),i.jsx("button",{onClick:()=>Me(oe),className:"action-icon-button edit-button",title:"Edit Distributor",children:i.jsx(tu,{size:16})}),i.jsx("button",{onClick:()=>Je(oe),className:"action-icon-button delete-button",title:"Delete Distributor",children:i.jsx(Oi,{size:16})})]})})]},oe.id))})]})}),f&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:we,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Add New Distributor"}),l&&i.jsx("div",{className:"modal-error-message",children:l}),i.jsxs("form",{onSubmit:tt,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Name:"}),i.jsx("input",{type:"text",id:"name",value:B,onChange:oe=>U(oe.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"contact_person",value:z,onChange:oe=>$(oe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"phone",value:R,onChange:oe=>H(oe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email:"}),i.jsx("input",{type:"email",id:"email",value:ee,onChange:oe=>Z(oe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"address",children:"Address:"}),i.jsx("textarea",{id:"address",value:te,onChange:oe=>Q(oe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"gst_number",value:q,onChange:oe=>W(oe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"drug_license_number",value:ne,onChange:oe=>A(oe.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:we,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Distributor"})]})]})]})}),d&&E&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:De,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Edit Distributor"}),l&&i.jsx("div",{className:"modal-error-message",children:l}),i.jsxs("form",{onSubmit:ft,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-name",children:"Name:"}),i.jsx("input",{type:"text",id:"edit-name",value:B,onChange:oe=>U(oe.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"edit-contact_person",value:z,onChange:oe=>$(oe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"edit-phone",value:R,onChange:oe=>H(oe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-email",children:"Email:"}),i.jsx("input",{type:"email",id:"edit-email",value:ee,onChange:oe=>Z(oe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-address",children:"Address:"}),i.jsx("textarea",{id:"edit-address",value:te,onChange:oe=>Q(oe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"edit-gst_number",value:q,onChange:oe=>W(oe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"edit-drug_license_number",value:ne,onChange:oe=>A(oe.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:De,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Save Changes"})]})]})]})}),g&&E&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:nt,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Confirm Delete"}),i.jsxs("p",{children:['Are you sure you want to delete distributor "',E.name,'"?']}),l&&i.jsx("div",{className:"modal-error-message",children:l}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:nt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Re,className:"button-delete",children:"Delete"})]})]})}),v&&E&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content large-modal",children:[i.jsx("button",{onClick:St,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Payments & Balance for ",E.name]}),l&&i.jsx("div",{className:"modal-error-message",children:l}),F&&i.jsxs("div",{className:"balance-summary",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Total Order Value:"})," ",F.totalOrderValue.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Total Amount Paid:"})," ",F.totalAmountPaid.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Remaining Balance:"})," ",F.remainingBalance.toFixed(2)]})]}),i.jsx("h4",{children:"Payment History"}),I.length===0?i.jsx("p",{children:"No payments recorded for this distributor."}):i.jsx("div",{className:"table-responsive",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Order Value"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Balance Remaining"}),i.jsx("th",{children:"Notes"})]})}),i.jsx("tbody",{children:I.map(oe=>i.jsxs("tr",{children:[i.jsx("td",{children:new Date(oe.payment_date).toLocaleDateString()}),i.jsxs("td",{children:["",oe.order_value.toFixed(2)]}),i.jsxs("td",{children:["",oe.amount_paid.toFixed(2)]}),i.jsxs("td",{children:["",oe.balance_remaining.toFixed(2)]}),i.jsx("td",{children:oe.notes||"-"})]},oe.id))})]})}),i.jsx("div",{className:"modal-actions",children:i.jsx("button",{type:"button",onClick:St,className:"button-cancel",children:"Close"})})]})}),k&&E&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Vt,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Add Payment for ",E.name]}),l&&i.jsx("div",{className:"modal-error-message",children:l}),i.jsxs("form",{onSubmit:he,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_date",children:"Payment Date:"}),i.jsx("input",{type:"date",id:"payment_date",value:ie,onChange:oe=>se(oe.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"order_value",children:"Order Value:"}),i.jsx("input",{type:"number",id:"order_value",value:M,onChange:oe=>ce(oe.target.value),step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"amount_paid",children:"Amount Paid:"}),i.jsx("input",{type:"number",id:"amount_paid",value:ve,onChange:oe=>le(oe.target.value),step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_notes",children:"Notes:"}),i.jsx("textarea",{id:"payment_notes",value:xe,onChange:oe=>ue(oe.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Vt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Payment"})]})]})]})})]})},Rte=({isOpen:e,onClose:n,excelHeaders:t,onConfirm:r,availableFields:a})=>{const[l,o]=w.useState({});if(w.useEffect(()=>{e&&u()},[e,t,a]),!e)return null;const f=(h,g)=>{o(b=>({...b,[h]:g}))},u=()=>{const h={};t.forEach(g=>{const b=a.map(S=>({name:S})),v=Ah(g,b);v&&(h[g]=v.name)}),o(h)},d=()=>{const h={};for(const g in l)l[g]&&l[g]!=="none"&&(h[g]=l[g]);r(h),n()};return i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:n,className:"modal-close-button",children:i.jsx(Kn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Match File Columns"}),i.jsx("p",{className:"modal-description",children:'Please match the columns from your uploaded file to the corresponding fields in the drug inventory. You can use the "Auto Match" button for suggestions.'}),i.jsx("div",{className:"modal-actions-top",children:i.jsx("button",{type:"button",onClick:u,className:"button-auto-match",children:"Auto Match"})}),i.jsxs("div",{className:"column-mapping-grid",children:[i.jsx("div",{className:"grid-header",children:"Excel Column"}),i.jsx("div",{className:"grid-header",children:"App Field"}),t.map((h,g)=>i.jsxs(Rn.Fragment,{children:[i.jsx("div",{className:"excel-header-cell",children:h}),i.jsx("div",{className:"app-field-cell",children:i.jsxs("select",{value:l[h]||"",onChange:b=>f(h,b.target.value),className:"app-field-select",children:[i.jsx("option",{value:"",children:"-- Select Field --"}),i.jsx("option",{value:"none",children:"None (Ignore Column)"}),a.map((b,v)=>i.jsxs("option",{value:b,children:[b==="name"?"Composition Name":b==="brand_name"?"Brand Name":b==="price"?"MRP":b==="buying_price"?"Rate":b==="unit"?"Pack":b==="batch"?"Batch":b==="hsn_code"?"HSN Code":b==="mfg"?"MFG":b==="loose_quantity"?"Loose":b.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase())," "]},v))]})})]},g))]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:n,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:d,className:"button-submit",children:"Confirm Mapping"})]})]})})},Lte=({isOpen:e,onClose:n,onDrugAddedToPurchase:t})=>{const[r,a]=w.useState({name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",expiry_date:"",buying_price:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),[l,o]=w.useState(null),[f,u]=w.useState(!1),[d,h]=w.useState(!1),g=w.useRef(null),b=w.useRef(null),v=w.useRef(null);w.useEffect(()=>{e&&(a({name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",expiry_date:"",buying_price:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),o(null),u(!1),h(!1))},[e]),w.useEffect(()=>{const T=P=>{P.key==="Tab"&&b.current===document.activeElement&&(d||(h(!0),setTimeout(()=>{var I;(I=v.current)==null||I.focus()},0),P.preventDefault()))},E=P=>{g.current&&!g.current.contains(P.target)&&h(!1)};return document.addEventListener("keydown",T),document.addEventListener("mousedown",E),()=>{document.removeEventListener("keydown",T),document.removeEventListener("mousedown",E)}},[d]);const S=T=>{const{name:E,value:P,type:I}=T.target;a(V=>({...V,[E]:I==="number"?parseFloat(P)||null:P}))},k=T=>{if(T.preventDefault(),o(null),u(!0),r.price===void 0||r.quantity_in_stock===void 0){o("MRP and Stock Quantity are required."),u(!1);return}const E={...r,name:r.name===""?null:r.name,composition:r.composition===""?null:r.composition,buying_price:r.buying_price===0?null:r.buying_price,expiry_date:r.expiry_date===""?null:r.expiry_date,gst:r.gst===0?null:r.gst,margin:r.margin===0?null:r.margin,discount:r.discount===0?null:r.discount,brand_name:r.brand_name===""?null:r.brand_name,batch:r.batch===""?null:r.batch,hsn_code:r.hsn_code===""?null:r.hsn_code,mfg:r.mfg===""?null:r.mfg,loose:r.loose===0?null:r.loose};t(E),u(!1),n()};return e?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content add-drug-form-container max-w-2xl mx-auto",children:[i.jsxs("div",{className:"add-drug-form-header",children:[i.jsx("h2",{children:"Add New Drug"}),i.jsx("button",{onClick:n,className:"cancel-button",title:"Close",children:i.jsx(Kn,{size:24})})]}),l&&i.jsx("div",{className:"error-message",children:l}),i.jsxs("form",{onSubmit:k,className:"add-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"name",className:"form-label",children:"Composition Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ql,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"name",value:r.name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Paracetamol",tabIndex:1})]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"brand_name",className:"form-label",children:"Brand Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ql,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"brand_name",value:r.brand_name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"price",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ql,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"price",id:"price",required:!0,step:"0.01",min:"0",value:r.price,onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"quantity_in_stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(ql,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"quantity_in_stock",id:"quantity_in_stock",required:!0,step:"1",min:"0",value:r.quantity_in_stock,onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"unit",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"unit",id:"unit",value:r.unit||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"expiry_date",value:r.expiry_date||"",onChange:S,className:"custom-text-input mt-1",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"box_number",value:r.box_number||"",onChange:S,className:"custom-text-input mt-1",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:g,children:[i.jsx("button",{type:"button",onClick:()=>h(!d),className:"form-button w-full text-left",tabIndex:8,ref:b,children:"Others"}),d&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"description",rows:3,value:r.description||"",onChange:S,className:"custom-text-input mt-1",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"buying_price",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"buying_price",id:"buying_price",step:"0.01",min:"0",value:r.buying_price??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:10,ref:v})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"gst",step:"0.01",min:"0",max:"100",value:r.gst??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:11})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"margin",step:"0.01",min:"0",max:"100",value:r.margin??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"discount",step:"0.01",min:"0",max:"100",value:r.discount??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"batch",value:r.batch||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"hsn_code",value:r.hsn_code||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"mfg",value:r.mfg||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"loose",className:"form-label",children:"Loose Quantity"}),i.jsx("input",{type:"number",name:"loose",id:"loose",step:"1",min:"0",value:r.loose??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:17})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:n,disabled:f,className:"form-button cancel-form-button",tabIndex:18,children:"Cancel"}),i.jsx("button",{type:"submit",disabled:f,className:"form-button submit-form-button inline-flex justify-center",tabIndex:19,children:f?"Adding...":"Add Drug"})]})]})]})}):null},Ote=e=>{if(!e)return null;const n=String(e).trim().toLowerCase();if(!n)return null;const t={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12",january:"01",february:"02",march:"03",april:"04",june:"06",july:"07",august:"08",september:"09",october:"10",november:"11",december:"12"};let r,a,l;const o=n.match(/^(\d{1,2})[\s\-./]*([a-z]{3})[a-z]*[\s\-./]*(\d{2,4})$/),f=n.match(/^([a-z]{3})[a-z]*[\s\-./]*(\d{1,2})[\s\-./]*(\d{2,4})$/),u=n.match(/^(\d{1,2})[\s\-./]+(\d{1,2})[\s\-./]+(\d{2,4})$/);if(o)r=o[1],a=t[o[2].substring(0,3)],l=o[3];else if(f)a=t[f[1].substring(0,3)],r=f[2],l=f[3];else if(u)r=u[1],a=u[2],l=u[3];else{const h=Date.parse(n);return isNaN(h)?null:new Date(h).toISOString().split("T")[0]}if(!r||!a||!l)return null;l.length===2&&(l=(parseInt(l)<50?"20":"19")+l),r=r.padStart(2,"0"),a=a.padStart(2,"0");const d=new Date(parseInt(l),parseInt(a)-1,parseInt(r));return d.getFullYear()===parseInt(l)&&d.getMonth()===parseInt(a)-1&&d.getDate()===parseInt(r)?`${l}-${a}-${r}`:null},Fte=({purchaseRows:e,onCellChange:n,onRemoveDrug:t,onAddEmptyRow:r,lastAddMethod:a})=>{const l=w.useRef(new Map),[o,f]=w.useState(e.length);w.useEffect(()=>{var d;if(e.length>o&&a==="manual"){const h=e.length-1;(d=l.current.get(`${h}-name`))==null||d.focus()}f(e.length)},[e.length,o,a]);const u=(d,h,g)=>{const b=h===e.length-1;b&&d.key==="Enter"&&(d.preventDefault(),r()),b&&d.key==="Tab"&&g==="box_number"&&!d.shiftKey&&(d.preventDefault(),r())};return i.jsxs("table",{className:"data-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{width:"40px"},children:"#"}),i.jsx("th",{style:{minWidth:"180px"},children:"Drug Name"}),i.jsx("th",{style:{minWidth:"120px"},children:"Brand"}),i.jsx("th",{style:{minWidth:"100px"},children:"Batch"}),i.jsx("th",{style:{minWidth:"130px"},children:"Expiry"}),i.jsx("th",{style:{minWidth:"70px"},children:"Qty"}),i.jsx("th",{style:{minWidth:"70px"},children:"Free"}),i.jsx("th",{style:{minWidth:"70px"},children:"Unit"}),i.jsx("th",{style:{minWidth:"90px"},children:"Buy "}),i.jsx("th",{style:{minWidth:"90px"},children:"MRP "}),i.jsx("th",{style:{minWidth:"60px"},children:"Disc%"}),i.jsx("th",{style:{minWidth:"60px"},children:"GST%"}),i.jsx("th",{style:{minWidth:"70px"},children:"Mrgn%"}),i.jsx("th",{style:{minWidth:"80px"},children:"HSN"}),i.jsx("th",{style:{minWidth:"80px"},children:"Mfg"}),i.jsx("th",{style:{minWidth:"80px"},children:"Rack"}),i.jsx("th",{className:"sticky-col-right",style:{width:"50px",textAlign:"center"},children:i.jsx(Oi,{size:16})})]})}),i.jsx("tbody",{children:e.map((d,h)=>i.jsxs("tr",{children:[i.jsx("td",{style:{textAlign:"center",color:"var(--text-tertiary)",fontWeight:600,fontSize:"0.85rem"},children:h+1}),i.jsx("td",{children:i.jsx("input",{ref:g=>{l.current.set(`${h}-name`,g)},className:"table-input",value:d.name||"",placeholder:"Name",onChange:g=>n(g,d.id||"","name"),onKeyDown:g=>u(g,h,"name"),autoComplete:"off"})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.brand_name||"",placeholder:"Brand",onChange:g=>n(g,d.id||"","brand_name"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.batch||"",placeholder:"Batch",onChange:g=>n(g,d.id||"","batch"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"date",className:"table-input",value:d.expiry_date||"",onChange:g=>n(g,d.id||"","expiry_date"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.quantity_in_stock||"",placeholder:"0",onChange:g=>n(g,d.id||"","quantity_in_stock"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.loose||"",placeholder:"0",onChange:g=>n(g,d.id||"","loose"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.unit||"",placeholder:"Tab/Strip",onChange:g=>n(g,d.id||"","unit"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.buying_price||"",placeholder:"0.00",onChange:g=>n(g,d.id||"","buying_price"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.price||"",placeholder:"0.00",onChange:g=>n(g,d.id||"","price"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.discount||"",placeholder:"0",onChange:g=>n(g,d.id||"","discount"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.gst||"",placeholder:"5",onChange:g=>n(g,d.id||"","gst"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:d.margin||"",placeholder:"0",onChange:g=>n(g,d.id||"","margin"),onKeyDown:g=>u(g,h),readOnly:!0,style:{color:"var(--secondary)",fontWeight:"bold",cursor:"default"}})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.hsn_code||"",placeholder:"HSN",onChange:g=>n(g,d.id||"","hsn_code"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.mfg||"",placeholder:"Mfg",onChange:g=>n(g,d.id||"","mfg"),onKeyDown:g=>u(g,h)})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:d.box_number||"",placeholder:"Rack",onChange:g=>n(g,d.id||"","box_number"),onKeyDown:g=>u(g,h,"box_number")})}),i.jsx("td",{className:"sticky-col-right",style:{textAlign:"center"},children:i.jsx("button",{onClick:()=>t(d.id||""),className:"delete-row-btn",tabIndex:-1,title:"Remove Row",children:i.jsx(Oi,{size:16})})})]},d.id))})]})},n_=()=>{const e=wt(),[n,t]=w.useState(()=>{const xe=localStorage.getItem("theme");return xe||(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});w.useEffect(()=>{document.documentElement.setAttribute("data-theme",n)},[n]),w.useEffect(()=>{const xe=window.matchMedia("(prefers-color-scheme: dark)"),ue=ze=>{localStorage.getItem("theme")||t(ze.matches?"dark":"light")};return xe.addEventListener("change",ue),()=>xe.removeEventListener("change",ue)},[]);const r=()=>t(xe=>{const ue=xe==="light"?"dark":"light";return localStorage.setItem("theme",ue),ue}),[,a]=w.useState(!1),l=w.useRef(null),[o,f]=w.useState(""),[u,d]=w.useState([]),[h,g]=w.useState(null),[b,v]=w.useState(!1),S=w.useRef(null),[k,T]=w.useState(!1),[E,P]=w.useState(!1),[I,V]=w.useState([]),[F,O]=w.useState(null),[B,U]=w.useState(null),[z,$]=w.useState(0),[R,H]=w.useState([]),[ee,Z]=w.useState("manual"),te=["name","description","price","quantity_in_stock","unit","supplier","expiry_date","buying_price","box_number","gst","margin","discount","brand_name","batch","hsn_code","mfg","loose"],Q=w.useCallback((xe,ue="manual")=>{const ze=xe||(h?h.name:"");Z(ue),H(tt=>[...tt,{id:Date.now().toString()+Math.random().toString(36).substring(2,9),name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",supplier:ze,expiry_date:"",buying_price:0,box_number:"",gst:5,margin:0,discount:0,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:0,last_updated:"",created_at:""}])},[h]),q=xe=>H(ue=>ue.filter(ze=>ze.id!==xe)),W=(xe,ue,ze)=>{const{value:tt}=xe.target;H(ft=>(ft.findIndex(je=>je.id===ue)===ft.length-1&&tt.trim()!==""&&setTimeout(()=>Q(void 0,"auto"),0),ft.map(je=>{if(je.id===ue){let he=tt;["price","quantity_in_stock","buying_price","gst","margin","discount","loose"].includes(ze)?(he=parseFloat(tt),isNaN(he)&&(he=null)):ze==="expiry_date"&&(he=tt.trim()===""?null:tt);const Ae={...je,[ze]:he};if(h&&(Ae.supplier=h.name),["buying_price","price","gst"].includes(ze)){const we=ze==="buying_price"?he:Ae.buying_price,Me=ze==="price"?he:Ae.price,De=ze==="gst"?he:Ae.gst;if(Me&&Me>0&&we!==void 0&&we!==null){const Je=we*(1+(De||0)/100);Ae.margin=parseFloat(((Me-Je)/Me*100).toFixed(2))}}return Ae}return je})))},ne=w.useCallback(()=>R.reduce((xe,ue)=>{const ze=ue.quantity_in_stock||0,tt=ue.buying_price||0,ft=ue.gst||0,Re=ue.discount||0;let je=tt*(1-Re/100),he=ze*je;return he+=he*(ft/100),xe+he},0),[R]),A=async()=>{if(!h){U("Select a distributor.");return}const xe=R.filter(ue=>ue.name&&ue.name.trim()!==""||ue.buying_price&&ue.buying_price>0);if(xe.length===0){U("No valid items.");return}a(!0),U(null),qs.addRequest();try{for(const tt of xe){const ft={...tt,supplier:h.name,expiry_date:tt.expiry_date||null,distributorId:h.id};if(!(await fe("/api/drugs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ft)})).ok)throw new Error(`Failed to add ${tt.name}`)}const ue=ne();if(!(await fe(`/api/distributors/${h.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:new Date().toISOString().split("T")[0],order_value:ue,amount_paid:z,notes:`Purchase - ${xe.length} items`})})).ok)throw new Error("Payment record failed.");H([]),g(null),f(""),$(0),alert("Success!"),e("/dashboard/inventory")}catch(ue){U(ue.message||"Failed.")}finally{a(!1),qs.removeRequest()}},ie=async xe=>{var tt,ft;const ue=(tt=xe.target.files)==null?void 0:tt[0];if(!ue)return;a(!0),qs.addRequest(),U(null),O(ue);const ze=(ft=ue.name.split(".").pop())==null?void 0:ft.toLowerCase();if(["xlsx","xls","csv"].includes(ze||"")){const Re=new FormData;Re.append("inventoryFile",ue);try{const je=await fe("/api/drugs/get-file-headers",{method:"POST",body:Re});if(!je.ok)throw new Error("Failed headers");const{headers:he}=await je.json();V(he),T(!0)}catch(je){U(je.message),O(null)}finally{a(!1),qs.removeRequest()}}else if(["pdf","png","jpg","jpeg"].includes(ze||"")){const Re=new FormData;Re.append("file",ue),Re.append("output_type","csv");const je="00841ac4-b279-11f0-ab55-0a3a41e3fad1";try{const he=await fetch("https://extraction-api.nanonets.com/extract",{method:"POST",headers:{Authorization:`Bearer ${je}`},body:Re});if(!he.ok)throw new Error("OCR Failed");const Ae=await he.json();if(!Ae.success||!Ae.content)throw new Error("No data from OCR");let we=Ae.content.split(`
`).filter(Ge=>!Ge.startsWith("#")&&Ge.trim()).join(`
`);const Me=new File([we],"ocr.csv",{type:"text/csv"}),De=new FormData;De.append("inventoryFile",Me);const Je=await fe("/api/drugs/get-file-headers",{method:"POST",body:De});if(!Je.ok)throw new Error("Failed parsing OCR CSV");const{headers:nt}=await Je.json();V(nt),O(Me),T(!0)}catch(he){U(he.message),O(null)}finally{a(!1),qs.removeRequest()}}else U("Unsupported file"),a(!1),qs.removeRequest()},se=async xe=>{if(!F)return;a(!0),qs.addRequest();const ue=new FormData;ue.append("inventoryFile",F),ue.append("columnMapping",JSON.stringify(xe));try{const ze=await fe("/api/drugs/parse-excel",{method:"POST",body:ue});if(!ze.ok)throw new Error("Parse Failed");const ft=(await ze.json()).map(Re=>({...Re,id:Date.now().toString()+Math.random(),supplier:(h==null?void 0:h.name)||Re.supplier,expiry_date:Ote(Re.expiry_date)}));H(Re=>[...Re,...ft])}catch(ze){U(ze.message)}finally{a(!1),qs.removeRequest(),T(!1),l.current&&(l.current.value="")}},M=w.useCallback(async xe=>{const ue=xe.trim()===""?"/api/distributors":`/api/distributors?search=${encodeURIComponent(xe)}`;try{const ze=await fe(ue);if(ze.ok){const tt=await ze.json();d(xe.trim()===""?tt.slice(0,4):tt)}}catch(ze){console.error(ze)}},[]),ce=xe=>{const ue=xe.target.value;f(ue),S.current&&clearTimeout(S.current),S.current=setTimeout(()=>{M(ue),v(!0)},300)},ve=()=>{o.trim()===""&&M(""),v(!0)},le=xe=>{g(xe),f(""),v(!1),d([]),H(ue=>ue.map(ze=>({...ze,supplier:xe.name}))),R.length===0&&Q(xe.name,"manual")};return i.jsxs("div",{className:"purchase-page",children:[i.jsxs("div",{className:"purchase-header",children:[i.jsxs("div",{className:"header-left",children:[i.jsx("button",{onClick:()=>e(-1),className:"icon-btn",children:i.jsx(Ht,{size:20})}),i.jsx("h2",{className:"purchase-page-title",children:"New Purchase"})]}),i.jsx("button",{onClick:r,className:"icon-btn",title:"Toggle Theme",children:n==="light"?i.jsx(SI,{size:20}):i.jsx(tM,{size:20})})]}),B&&i.jsxs("div",{className:"error-banner",style:{background:"var(--danger-bg)",color:"var(--danger)",padding:"12px",borderRadius:"8px",marginBottom:"20px",display:"flex",gap:"10px"},children:[i.jsx(si,{size:20}),i.jsx("span",{children:B})]}),i.jsxs("div",{className:"purchase-controls-grid",children:[i.jsxs("div",{className:"control-card",children:[i.jsxs("div",{className:"card-header",children:[i.jsxs("h3",{children:[i.jsx(lM,{size:20,className:"card-icon"})," Distributor"]}),i.jsxs("button",{onClick:()=>e("/dashboard/distributors"),className:"icon-btn",style:{width:"auto",borderRadius:"6px",fontSize:"0.8rem",padding:"6px 12px"},children:[i.jsx(zh,{size:16})," Manage"]})]}),h?i.jsxs("div",{className:"selected-distributor-card",children:[i.jsxs("div",{children:[i.jsx("strong",{children:h.name}),i.jsx("br",{}),i.jsx("span",{style:{opacity:.8},children:h.contact_person})]}),i.jsx("button",{onClick:()=>g(null),style:{background:"none",border:"none",color:"var(--primary)",fontWeight:"bold",cursor:"pointer"},children:"Change"})]}):i.jsxs("div",{className:"distributor-search-wrapper",children:[i.jsxs("div",{className:"search-input-group",children:[i.jsx(vi,{size:18,className:"search-input-icon"}),i.jsx("input",{className:"distributor-input",placeholder:"Search...",value:o,onChange:ce,onFocus:ve})]}),b&&u.length>0&&i.jsx("ul",{className:"search-dropdown",children:u.map(xe=>i.jsx("li",{onClick:()=>le(xe),children:xe.name},xe.id))})]})]}),i.jsxs("div",{className:"control-card",children:[i.jsx("div",{className:"card-header",children:i.jsxs("h3",{children:[i.jsx(cM,{size:20,className:"card-icon"})," Import & Actions"]})}),i.jsxs("div",{className:"action-buttons-row",children:[i.jsx("input",{ref:l,type:"file",hidden:!0,accept:".xlsx,.xls,.csv,.pdf,.png,.jpg",onChange:ie}),i.jsxs("button",{onClick:()=>{var xe;return(xe=l.current)==null?void 0:xe.click()},disabled:!h,className:"btn-base btn-primary",children:[i.jsx(ps,{size:18})," Import File"]}),i.jsxs("button",{onClick:()=>P(!0),disabled:!h,className:"btn-base btn-manual",children:[i.jsx(Gl,{size:18})," Manual"]})]}),i.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-tertiary)",marginTop:"8px",textAlign:"center"},children:"Supports Excel, CSV, PDF, Images"})]})]}),i.jsx(Rte,{isOpen:k,onClose:()=>T(!1),excelHeaders:I,onConfirm:se,availableFields:te}),E&&i.jsx(Lte,{isOpen:E,onClose:()=>P(!1),onDrugAddedToPurchase:xe=>{H(ue=>[...ue,{...xe,id:Date.now().toString(),supplier:(h==null?void 0:h.name)||""}]),P(!1)}}),i.jsxs("div",{className:"table-container",children:[i.jsx("div",{className:"table-header-title",children:i.jsxs("h3",{children:["Items (",R.length,")"]})}),i.jsx("div",{className:"table-scroll-wrapper",children:i.jsx(Fte,{purchaseRows:R,onCellChange:W,onRemoveDrug:q,onAddEmptyRow:()=>Q(void 0,"manual"),lastAddMethod:ee})}),R.length===0&&i.jsx("div",{style:{padding:"40px",textAlign:"center",color:"var(--text-tertiary)"},children:"Select distributor to start."})]}),i.jsxs("div",{className:"purchase-footer",children:[i.jsxs("button",{onClick:()=>Q(void 0,"manual"),className:"btn-base btn-secondary",style:{width:"auto",flex:0},children:[i.jsx(Gl,{size:16})," Add Row"]}),i.jsxs("div",{className:"footer-right",children:[i.jsxs("div",{className:"financial-input-group",children:[i.jsx("label",{children:"Paid:"}),i.jsx("input",{type:"number",value:z,onChange:xe=>$(parseFloat(xe.target.value)||0),className:"amount-paid-input"})]}),i.jsxs("div",{className:"total-display",children:[i.jsx("span",{children:"Total"}),i.jsxs("span",{className:"total-value",children:["",ne().toFixed(2)]})]}),i.jsxs("button",{onClick:A,className:"floating-action-btn success",disabled:R.length===0,children:[i.jsx(Zm,{size:20,className:"btn-icon"}),"Submit Purchase"]})]})]})]})},$te=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)/);return n&&n[1]?parseInt(n[1],10):1},zte=()=>{const e=wt(),n=gr(),[t,r]=w.useState(null),[a,l]=w.useState([]),[o,f]=w.useState(!0),[u,d]=w.useState(null),[h,g]=w.useState(!1),[b,v]=w.useState("cash"),[S,k]=w.useState(""),[T,E]=w.useState(""),[P,I]=w.useState(""),[V,F]=w.useState(""),[O,B]=w.useState(""),[U,z]=w.useState(0),$=w.useRef(!1),R=ne=>{const A=Math.max(0,Math.min(100,isNaN(ne)?0:ne));$.current=!0,z(A);const ie=a.map(se=>({...se,discount_percentage:A}));l(ie)},H=(ne,A)=>{const ie=[...a];ie[ne].discount_percentage=isNaN(A)?0:A,l(ie)};w.useEffect(()=>{if($.current){$.current=!1;return}const ne=a.reduce((se,M)=>se+(M.total_price??0),0);if(ne===0){z(0);return}const ie=a.reduce((se,M)=>{const ve=(M.total_price??0)*((M.discount_percentage??0)/100);return se+ve},0)/ne*100;z(se=>Math.abs(se-ie)>.01?ie:se)},[a]);const ee=async()=>{if(!t)return d("No order data available to bill."),null;if(a.length===0)return d("Cannot bill an empty order."),null;g(!0),d(null);try{const ne=a.map(ce=>{const ve=(ce.pricePerLooseUnit??0)*(ce.looseQuantity??0),le=ve*((ce.discount_percentage??0)/100),xe=ve-le;return{name:ce.name,pack_quantity:ce.loosePacks??0,loose_quantity:ce.looseUnits??0,price:ce.originalPrice??0,pack_price:ce.originalPrice??0,loose_price:ce.pricePerLooseUnit??0,total:xe,drug_id:ce.drug_id,discount_percentage:ce.discount_percentage??0,batch:ce.batch,expiry_date:ce.expiry_date}}),A={patientId:t.patientId,queueId:t.id,items:ne,amount:W,paymentMode:b,type:"pharmacy",related_id:t.id,status:"paid",discountPercentage:U},ie=await fe("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)}),se=await ie.json();if(!ie.ok||!se.id)throw new Error(se.message||"Failed to create bill.");const M=await fe(`/api/pharmacy-orders/${t.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"billed",bill_id:se.id,medications:a})});if(!M.ok){const ce=await M.text();throw new Error(`Failed to update pharmacy order status: ${M.statusText} - ${ce}`)}return r(ce=>ce?{...ce,status:"billed",bill_id:se.id}:null),alert(`Order ${t.patientName}'s bill created (ID: ${se.id}) and marked as billed.`),e(`/dashboard/pharmacy-billing/${t.id}`,{replace:!0,state:{order:{...t,status:"billed",bill_id:se.id},initialItems:a}}),se.id}catch(ne){return console.error("Billing process failed:",ne),d(ne.message||"Failed to mark order as billed. Please try again."),null}finally{g(!1)}},Z=()=>{window.print()},te=async()=>{await ee()&&(window.print(),e(-1))};w.useEffect(()=>{const ne=n.pathname.split("/"),A=ne[ne.length-1];A?(async()=>{try{const se=await fe(`/api/pharmacy-orders/${A}`);if(!se.ok)throw new Error("Failed to fetch pharmacy order details");const M=await se.json();r(M);const ce=M.medications.map(ve=>{const le=$te(ve.unit),xe=(ve.pack_quantity??0)*le+(ve.loose_quantity??0);return{...ve,isLoose:!0,loosePacks:ve.pack_quantity??0,looseUnits:ve.loose_quantity??0,looseQuantity:xe,pack_price:Number(ve.pack_price)||0,loose_price:Number(ve.loose_price)||0,total_price:Number(ve.total_price)||0,pricePerLooseUnit:Number(ve.loose_price)||0,originalPrice:Number(ve.pack_price)||0,discount_percentage:Number(ve.discount_percentage)??0,directions_to_use:ve.directions_to_use,tabletsPerDay:ve.tabletsPerDay,numberOfDays:ve.numberOfDays,batch:ve.batch,expiry_date:ve.expiry_date}});l(ce)}catch(se){console.error("Failed to fetch order:",se),d(se.message||"Failed to load order details.")}finally{f(!1)}})():(d("No pharmacy order ID provided."),f(!1))},[n.pathname]),w.useEffect(()=>{(async()=>{try{const A=await fe("/api/clinics/settings");if(!A.ok)throw new Error("Failed to fetch clinic settings");const ie=await A.json();E(ie.upi_id||""),I(ie.name||""),F(ie.address||""),B(ie.notes||"")}catch(A){console.error("Error fetching clinic settings:",A)}})()},[]);const Q=w.useMemo(()=>a.reduce((ne,A)=>ne+(A.total_price??0),0),[a]),q=w.useMemo(()=>a.reduce((ne,A)=>{const se=(A.total_price??0)*(A.discount_percentage??0)/100;return ne+se},0),[a]),W=w.useMemo(()=>Q-q,[Q,q]);return w.useEffect(()=>{if(W>0&&T){const ne=`upi://pay?pa=${T}&pn=ClinicName&am=${W.toFixed(2)}&cu=INR`;k(ne)}else k("")},[W,T]),o?i.jsx("div",{className:"loading-pulse",children:"Loading Bill..."}):u?i.jsxs("div",{className:"error-message-box",children:["Error: ",u]}):t?i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"TAX INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:P?`${P} Pharmacy`:"Pharmacy Bill"}),(V||O)&&i.jsxs("div",{className:"clinic-details-print",children:[V&&i.jsx("span",{className:"small-text clinic-address",children:V}),O&&i.jsx("span",{className:"small-text clinic-notes",children:O})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ys,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Fd,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Fh,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(Ht,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Pharmacy Bill"})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ys,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Fd,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item no-print",children:[i.jsxs("strong",{children:[i.jsx(Uo,{size:16})," Order ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Fh,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Medications"})}),a.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"BATCH"}),i.jsx("th",{children:"EXPIRY"}),i.jsx("th",{children:"QUANTITY"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:a.map((ne,A)=>{var ve,le;const ie=ne.total_price??0,se=ie*(ne.discount_percentage??0)/100,M=ie-se;return i.jsxs("tr",{children:[i.jsx("td",{children:A+1}),i.jsx("td",{children:ne.name}),i.jsx("td",{children:ne.batch||"N/A"}),i.jsx("td",{children:ne.expiry_date?new Date(ne.expiry_date).toLocaleDateString():"N/A"}),i.jsxs("td",{children:[i.jsxs("div",{children:["Packs: ",ne.loosePacks??0]}),i.jsxs("div",{children:["Loose: ",ne.looseUnits??0]})]}),i.jsx("td",{children:((ve=ne.originalPrice)==null?void 0:ve.toFixed(2))??"N/A"}),i.jsx("td",{children:((le=ne.pricePerLooseUnit)==null?void 0:le.toFixed(2))??"N/A"}),i.jsxs("td",{children:[i.jsx("input",{type:"number",value:ne.discount_percentage??0,onChange:xe=>H(A,parseFloat(xe.target.value)),min:"0",max:"100",className:"discount-input-table"}),"%"]}),i.jsxs("td",{children:[5 .toFixed(1),"%"]}),i.jsx("td",{children:M.toFixed(2)})]},A)})})]}):i.jsx("p",{children:"No medications in this order."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[S&&i.jsxs("div",{className:`qr-code-container qr-code-printable-section ${b!=="upi"?"hide-on-screen":""}`,children:[i.jsx(Gh,{value:S,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",Q.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsxs("span",{children:["Total Discount (",U.toFixed(2),"%)"]}),i.jsxs("span",{children:["- ",q.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"GST (Included)"}),i.jsxs("span",{children:["",(W*.05).toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",W.toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",Q.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",q.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount Percentage"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:U,onChange:ne=>R(parseFloat(ne.target.value)),min:"0",max:"100",className:"discount-input-total",disabled:h||t.status==="billed"}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",W.toFixed(2)]})]}),i.jsx("div",{className:"qr-code-container",children:S?i.jsxs(i.Fragment,{children:[i.jsx(Gh,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]}):i.jsx("p",{children:"UPI QR code not available. Please ensure UPI ID is configured."})}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:b,onChange:ne=>v(ne.target.value),className:"payment-mode-select",disabled:h||t.status==="billed",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsxs("div",{className:"bill-actions",children:[t.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:Z,className:"secondary-button print-preview-button no-print",disabled:h||a.length===0,children:"Print Preview"}),i.jsx("button",{onClick:te,className:"primary-button",disabled:h||a.length===0,children:h?"Processing...":"Finalise and Bill"})]}),t.status==="billed"&&i.jsx("button",{onClick:()=>e(`/dashboard/bills/${t.bill_id}`),className:"secondary-button",children:"View Bill"})]})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})}):i.jsx("div",{className:"error-message-box",children:"No order data available."})},Bte=()=>{var V,F,O,B,U;const{billId:e}=Rr(),n=wt(),[t,r]=w.useState(null),[a,l]=w.useState(!0),[o,f]=w.useState(null),[u,d]=w.useState(""),[h,g]=w.useState(""),[b,v]=w.useState(""),[S,k]=w.useState("");w.useEffect(()=>{(async()=>{try{if(!e)throw new Error("Bill ID is missing");const $=await fe(`/api/bills/${e}`);if(!$.ok)throw new Error("Failed to fetch bill details");const R=await $.json();r(R.bill);const H=await fe("/api/clinics/settings");if(H.ok){const ee=await H.json();if(d(ee.name||""),g(ee.address||""),v(ee.notes||""),ee.upi_id&&R.amount>0){const Z=`upi://pay?pa=${ee.upi_id}&pn=${encodeURIComponent(ee.name||"Clinic")}&am=${Number(R.amount).toFixed(2)}&cu=INR`;k(Z)}}}catch($){console.error("Error fetching data:",$),f($.message||"Failed to load bill details.")}finally{l(!1)}})()},[e]);const T=()=>{window.print()};if(a)return i.jsx("div",{className:"loading-pulse",children:"Loading Bill..."});if(o)return i.jsxs("div",{className:"error-message-box",children:["Error: ",o]});if(!t)return i.jsx("div",{className:"error-message-box",children:"No bill found."});const E=(t.items||[]).reduce((z,$)=>{const R=(Number($.pack_price)||0)*(Number($.pack_quantity)||0),H=(Number($.loose_price)||0)*(Number($.loose_quantity)||0);return z+R+H},0),P=E-Number(t.amount),I=Number(t.amount)*.05;return i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"TAX INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:u?`${u} Pharmacy`:"Pharmacy Bill"}),(h||b)&&i.jsxs("div",{className:"clinic-details-print",children:[h&&i.jsx("span",{className:"small-text clinic-address",children:h}),b&&i.jsx("span",{className:"small-text clinic-notes",children:b})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ys,{size:16})," Patient Name"]})," ",((V=t.Patient)==null?void 0:V.name)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Fd,{size:16})," Token"]})," ",((F=t.Patient)==null?void 0:F.token_no)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Fh,{size:16})," Bill Date"]})," ",new Date(t.createdAt).toLocaleDateString()]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Fd,{size:16})," Bill No"]})," ",((O=t.id)==null?void 0:O.slice(0,8).toUpperCase())||"N/A"]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:[i.jsx(Ht,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"View Bill"}),i.jsxs("button",{onClick:T,className:"primary-button",style:{marginLeft:"auto",width:"auto",padding:"0.5rem 1rem"},children:[i.jsx(Vs,{size:16,style:{marginRight:"8px"}})," Print"]})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Bill Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ys,{size:16})," Patient Name"]})," ",((B=t.Patient)==null?void 0:B.name)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Fd,{size:16})," Token"]})," ",((U=t.Patient)==null?void 0:U.token_no)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Fd,{size:16})," Bill ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Fh,{size:16})," Date"]})," ",new Date(t.createdAt).toLocaleString()]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Status"})," ",i.jsx("span",{className:"status-badge status-billed",children:t.status})]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Items"})}),t.items&&t.items.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"BATCH"}),i.jsx("th",{children:"EXPIRY"}),i.jsx("th",{children:"QUANTITY"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:t.items.map((z,$)=>{const R=Number(z.total)||0,H=5;let ee="N/A";if(z.expiry_date)try{ee=new Date(z.expiry_date).toLocaleDateString()}catch{}return i.jsxs("tr",{children:[i.jsx("td",{children:$+1}),i.jsx("td",{children:z.name}),i.jsx("td",{children:z.batch||"N/A"}),i.jsx("td",{children:ee}),i.jsxs("td",{children:[i.jsxs("div",{children:["Packs: ",z.pack_quantity??0]}),i.jsxs("div",{children:["Loose: ",z.loose_quantity??0]})]}),i.jsx("td",{children:Number(z.pack_price||0).toFixed(2)}),i.jsx("td",{children:Number(z.loose_price||0).toFixed(2)}),i.jsxs("td",{children:[Number(z.discount_percentage||0),"%"]}),i.jsxs("td",{children:[H.toFixed(1),"%"]}),i.jsx("td",{children:R.toFixed(2)})]},$)})})]}):i.jsx("p",{children:"No items in this bill."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[S&&i.jsxs("div",{className:"qr-code-container qr-code-printable-section",children:[i.jsx(Gh,{value:S,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",E.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Discount"}),i.jsxs("span",{children:["- ",P.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"GST (Included)"}),i.jsxs("span",{children:["",I.toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",Number(t.amount).toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Payment Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",E.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",P.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",Number(t.amount).toFixed(2)]})]}),i.jsxs("div",{className:"payment-mode-section",style:{marginTop:"1rem",padding:"1rem",background:"#f8f9fa",borderRadius:"8px"},children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Payment Mode:"})," ",(t.payment_mode||"N/A").toUpperCase()]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Payment Status:"})," ",(t.status||"N/A").toUpperCase()]})]}),i.jsx("div",{className:"qr-code-container",children:S&&i.jsxs(i.Fragment,{children:[i.jsx(Gh,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]})}),i.jsx("div",{className:"bill-actions",children:i.jsxs("button",{onClick:T,className:"primary-button",style:{width:"100%"},children:[i.jsx(Vs,{size:16,style:{marginRight:"8px"}})," Print Bill"]})})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})})};function Vo(e){return Array.isArray?Array.isArray(e):MT(e)==="[object Array]"}function Ute(e){if(typeof e=="string")return e;let n=e+"";return n=="0"&&1/e==-1/0?"-0":n}function qte(e){return e==null?"":Ute(e)}function Vl(e){return typeof e=="string"}function PT(e){return typeof e=="number"}function Vte(e){return e===!0||e===!1||Hte(e)&&MT(e)=="[object Boolean]"}function IT(e){return typeof e=="object"}function Hte(e){return IT(e)&&e!==null}function Fa(e){return e!=null}function z0(e){return!e.trim().length}function MT(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const Gte="Incorrect 'index' type",Yte=e=>`Invalid value for key ${e}`,Wte=e=>`Pattern length exceeds max of ${e}.`,Qte=e=>`Missing ${e} property in key`,Jte=e=>`Property 'weight' in key '${e}' must be a positive integer`,i_=Object.prototype.hasOwnProperty;class Kte{constructor(n){this._keys=[],this._keyMap={};let t=0;n.forEach(r=>{let a=RT(r);this._keys.push(a),this._keyMap[a.id]=a,t+=a.weight}),this._keys.forEach(r=>{r.weight/=t})}get(n){return this._keyMap[n]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function RT(e){let n=null,t=null,r=null,a=1,l=null;if(Vl(e)||Vo(e))r=e,n=r_(e),t=$1(e);else{if(!i_.call(e,"name"))throw new Error(Qte("name"));const o=e.name;if(r=o,i_.call(e,"weight")&&(a=e.weight,a<=0))throw new Error(Jte(o));n=r_(o),t=$1(o),l=e.getFn}return{path:n,id:t,weight:a,src:r,getFn:l}}function r_(e){return Vo(e)?e:e.split(".")}function $1(e){return Vo(e)?e.join("."):e}function Xte(e,n){let t=[],r=!1;const a=(l,o,f)=>{if(Fa(l))if(!o[f])t.push(l);else{let u=o[f];const d=l[u];if(!Fa(d))return;if(f===o.length-1&&(Vl(d)||PT(d)||Vte(d)))t.push(qte(d));else if(Vo(d)){r=!0;for(let h=0,g=d.length;h<g;h+=1)a(d[h],o,f+1)}else o.length&&a(d,o,f+1)}};return a(e,Vl(n)?n.split("."):n,0),r?t:t[0]}const Zte={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},ene={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,n)=>e.score===n.score?e.idx<n.idx?-1:1:e.score<n.score?-1:1},tne={location:0,threshold:.6,distance:100},nne={useExtendedSearch:!1,getFn:Xte,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var $t={...ene,...Zte,...tne,...nne};const ine=/[^ ]+/g;function rne(e=1,n=3){const t=new Map,r=Math.pow(10,n);return{get(a){const l=a.match(ine).length;if(t.has(l))return t.get(l);const o=1/Math.pow(l,.5*e),f=parseFloat(Math.round(o*r)/r);return t.set(l,f),f},clear(){t.clear()}}}class Jw{constructor({getFn:n=$t.getFn,fieldNormWeight:t=$t.fieldNormWeight}={}){this.norm=rne(t,3),this.getFn=n,this.isCreated=!1,this.setIndexRecords()}setSources(n=[]){this.docs=n}setIndexRecords(n=[]){this.records=n}setKeys(n=[]){this.keys=n,this._keysMap={},n.forEach((t,r)=>{this._keysMap[t.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,Vl(this.docs[0])?this.docs.forEach((n,t)=>{this._addString(n,t)}):this.docs.forEach((n,t)=>{this._addObject(n,t)}),this.norm.clear())}add(n){const t=this.size();Vl(n)?this._addString(n,t):this._addObject(n,t)}removeAt(n){this.records.splice(n,1);for(let t=n,r=this.size();t<r;t+=1)this.records[t].i-=1}getValueForItemAtKeyId(n,t){return n[this._keysMap[t]]}size(){return this.records.length}_addString(n,t){if(!Fa(n)||z0(n))return;let r={v:n,i:t,n:this.norm.get(n)};this.records.push(r)}_addObject(n,t){let r={i:t,$:{}};this.keys.forEach((a,l)=>{let o=a.getFn?a.getFn(n):this.getFn(n,a.path);if(Fa(o)){if(Vo(o)){let f=[];const u=[{nestedArrIndex:-1,value:o}];for(;u.length;){const{nestedArrIndex:d,value:h}=u.pop();if(Fa(h))if(Vl(h)&&!z0(h)){let g={v:h,i:d,n:this.norm.get(h)};f.push(g)}else Vo(h)&&h.forEach((g,b)=>{u.push({nestedArrIndex:b,value:g})})}r.$[l]=f}else if(Vl(o)&&!z0(o)){let f={v:o,n:this.norm.get(o)};r.$[l]=f}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}}function LT(e,n,{getFn:t=$t.getFn,fieldNormWeight:r=$t.fieldNormWeight}={}){const a=new Jw({getFn:t,fieldNormWeight:r});return a.setKeys(e.map(RT)),a.setSources(n),a.create(),a}function ane(e,{getFn:n=$t.getFn,fieldNormWeight:t=$t.fieldNormWeight}={}){const{keys:r,records:a}=e,l=new Jw({getFn:n,fieldNormWeight:t});return l.setKeys(r),l.setIndexRecords(a),l}function Ox(e,{errors:n=0,currentLocation:t=0,expectedLocation:r=0,distance:a=$t.distance,ignoreLocation:l=$t.ignoreLocation}={}){const o=n/e.length;if(l)return o;const f=Math.abs(r-t);return a?o+f/a:f?1:o}function sne(e=[],n=$t.minMatchCharLength){let t=[],r=-1,a=-1,l=0;for(let o=e.length;l<o;l+=1){let f=e[l];f&&r===-1?r=l:!f&&r!==-1&&(a=l-1,a-r+1>=n&&t.push([r,a]),r=-1)}return e[l-1]&&l-r>=n&&t.push([r,l-1]),t}const Od=32;function lne(e,n,t,{location:r=$t.location,distance:a=$t.distance,threshold:l=$t.threshold,findAllMatches:o=$t.findAllMatches,minMatchCharLength:f=$t.minMatchCharLength,includeMatches:u=$t.includeMatches,ignoreLocation:d=$t.ignoreLocation}={}){if(n.length>Od)throw new Error(Wte(Od));const h=n.length,g=e.length,b=Math.max(0,Math.min(r,g));let v=l,S=b;const k=f>1||u,T=k?Array(g):[];let E;for(;(E=e.indexOf(n,S))>-1;){let B=Ox(n,{currentLocation:E,expectedLocation:b,distance:a,ignoreLocation:d});if(v=Math.min(B,v),S=E+h,k){let U=0;for(;U<h;)T[E+U]=1,U+=1}}S=-1;let P=[],I=1,V=h+g;const F=1<<h-1;for(let B=0;B<h;B+=1){let U=0,z=V;for(;U<z;)Ox(n,{errors:B,currentLocation:b+z,expectedLocation:b,distance:a,ignoreLocation:d})<=v?U=z:V=z,z=Math.floor((V-U)/2+U);V=z;let $=Math.max(1,b-z+1),R=o?g:Math.min(b+z,g)+h,H=Array(R+2);H[R+1]=(1<<B)-1;for(let Z=R;Z>=$;Z-=1){let te=Z-1,Q=t[e.charAt(te)];if(k&&(T[te]=+!!Q),H[Z]=(H[Z+1]<<1|1)&Q,B&&(H[Z]|=(P[Z+1]|P[Z])<<1|1|P[Z+1]),H[Z]&F&&(I=Ox(n,{errors:B,currentLocation:te,expectedLocation:b,distance:a,ignoreLocation:d}),I<=v)){if(v=I,S=te,S<=b)break;$=Math.max(1,2*b-S)}}if(Ox(n,{errors:B+1,currentLocation:b,expectedLocation:b,distance:a,ignoreLocation:d})>v)break;P=H}const O={isMatch:S>=0,score:Math.max(.001,I)};if(k){const B=sne(T,f);B.length?u&&(O.indices=B):O.isMatch=!1}return O}function one(e){let n={};for(let t=0,r=e.length;t<r;t+=1){const a=e.charAt(t);n[a]=(n[a]||0)|1<<r-t-1}return n}const wb=String.prototype.normalize?e=>e.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):e=>e;class OT{constructor(n,{location:t=$t.location,threshold:r=$t.threshold,distance:a=$t.distance,includeMatches:l=$t.includeMatches,findAllMatches:o=$t.findAllMatches,minMatchCharLength:f=$t.minMatchCharLength,isCaseSensitive:u=$t.isCaseSensitive,ignoreDiacritics:d=$t.ignoreDiacritics,ignoreLocation:h=$t.ignoreLocation}={}){if(this.options={location:t,threshold:r,distance:a,includeMatches:l,findAllMatches:o,minMatchCharLength:f,isCaseSensitive:u,ignoreDiacritics:d,ignoreLocation:h},n=u?n:n.toLowerCase(),n=d?wb(n):n,this.pattern=n,this.chunks=[],!this.pattern.length)return;const g=(v,S)=>{this.chunks.push({pattern:v,alphabet:one(v),startIndex:S})},b=this.pattern.length;if(b>Od){let v=0;const S=b%Od,k=b-S;for(;v<k;)g(this.pattern.substr(v,Od),v),v+=Od;if(S){const T=b-Od;g(this.pattern.substr(T),T)}}else g(this.pattern,0)}searchIn(n){const{isCaseSensitive:t,ignoreDiacritics:r,includeMatches:a}=this.options;if(n=t?n:n.toLowerCase(),n=r?wb(n):n,this.pattern===n){let k={isMatch:!0,score:0};return a&&(k.indices=[[0,n.length-1]]),k}const{location:l,distance:o,threshold:f,findAllMatches:u,minMatchCharLength:d,ignoreLocation:h}=this.options;let g=[],b=0,v=!1;this.chunks.forEach(({pattern:k,alphabet:T,startIndex:E})=>{const{isMatch:P,score:I,indices:V}=lne(n,k,T,{location:l+E,distance:o,threshold:f,findAllMatches:u,minMatchCharLength:d,includeMatches:a,ignoreLocation:h});P&&(v=!0),b+=I,P&&V&&(g=[...g,...V])});let S={isMatch:v,score:v?b/this.chunks.length:1};return v&&a&&(S.indices=g),S}}class uu{constructor(n){this.pattern=n}static isMultiMatch(n){return a_(n,this.multiRegex)}static isSingleMatch(n){return a_(n,this.singleRegex)}search(){}}function a_(e,n){const t=e.match(n);return t?t[1]:null}class cne extends uu{constructor(n){super(n)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(n){const t=n===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class une extends uu{constructor(n){super(n)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(n){const r=n.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,n.length-1]}}}class dne extends uu{constructor(n){super(n)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(n){const t=n.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class fne extends uu{constructor(n){super(n)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(n){const t=!n.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,n.length-1]}}}class hne extends uu{constructor(n){super(n)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(n){const t=n.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[n.length-this.pattern.length,n.length-1]}}}class pne extends uu{constructor(n){super(n)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(n){const t=!n.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,n.length-1]}}}class FT extends uu{constructor(n,{location:t=$t.location,threshold:r=$t.threshold,distance:a=$t.distance,includeMatches:l=$t.includeMatches,findAllMatches:o=$t.findAllMatches,minMatchCharLength:f=$t.minMatchCharLength,isCaseSensitive:u=$t.isCaseSensitive,ignoreDiacritics:d=$t.ignoreDiacritics,ignoreLocation:h=$t.ignoreLocation}={}){super(n),this._bitapSearch=new OT(n,{location:t,threshold:r,distance:a,includeMatches:l,findAllMatches:o,minMatchCharLength:f,isCaseSensitive:u,ignoreDiacritics:d,ignoreLocation:h})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(n){return this._bitapSearch.searchIn(n)}}class $T extends uu{constructor(n){super(n)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(n){let t=0,r;const a=[],l=this.pattern.length;for(;(r=n.indexOf(this.pattern,t))>-1;)t=r+l,a.push([r,t-1]);const o=!!a.length;return{isMatch:o,score:o?0:1,indices:a}}}const z1=[cne,$T,dne,fne,pne,hne,une,FT],s_=z1.length,mne=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,gne="|";function yne(e,n={}){return e.split(gne).map(t=>{let r=t.trim().split(mne).filter(l=>l&&!!l.trim()),a=[];for(let l=0,o=r.length;l<o;l+=1){const f=r[l];let u=!1,d=-1;for(;!u&&++d<s_;){const h=z1[d];let g=h.isMultiMatch(f);g&&(a.push(new h(g,n)),u=!0)}if(!u)for(d=-1;++d<s_;){const h=z1[d];let g=h.isSingleMatch(f);if(g){a.push(new h(g,n));break}}}return a})}const xne=new Set([FT.type,$T.type]);class bne{constructor(n,{isCaseSensitive:t=$t.isCaseSensitive,ignoreDiacritics:r=$t.ignoreDiacritics,includeMatches:a=$t.includeMatches,minMatchCharLength:l=$t.minMatchCharLength,ignoreLocation:o=$t.ignoreLocation,findAllMatches:f=$t.findAllMatches,location:u=$t.location,threshold:d=$t.threshold,distance:h=$t.distance}={}){this.query=null,this.options={isCaseSensitive:t,ignoreDiacritics:r,includeMatches:a,minMatchCharLength:l,findAllMatches:f,ignoreLocation:o,location:u,threshold:d,distance:h},n=t?n:n.toLowerCase(),n=r?wb(n):n,this.pattern=n,this.query=yne(this.pattern,this.options)}static condition(n,t){return t.useExtendedSearch}searchIn(n){const t=this.query;if(!t)return{isMatch:!1,score:1};const{includeMatches:r,isCaseSensitive:a,ignoreDiacritics:l}=this.options;n=a?n:n.toLowerCase(),n=l?wb(n):n;let o=0,f=[],u=0;for(let d=0,h=t.length;d<h;d+=1){const g=t[d];f.length=0,o=0;for(let b=0,v=g.length;b<v;b+=1){const S=g[b],{isMatch:k,indices:T,score:E}=S.search(n);if(k){if(o+=1,u+=E,r){const P=S.constructor.type;xne.has(P)?f=[...f,...T]:f.push(T)}}else{u=0,o=0,f.length=0;break}}if(o){let b={isMatch:!0,score:u/o};return r&&(b.indices=f),b}}return{isMatch:!1,score:1}}}const B1=[];function vne(...e){B1.push(...e)}function U1(e,n){for(let t=0,r=B1.length;t<r;t+=1){let a=B1[t];if(a.condition(e,n))return new a(e,n)}return new OT(e,n)}const Nb={AND:"$and",OR:"$or"},q1={PATH:"$path",PATTERN:"$val"},V1=e=>!!(e[Nb.AND]||e[Nb.OR]),wne=e=>!!e[q1.PATH],Nne=e=>!Vo(e)&&IT(e)&&!V1(e),l_=e=>({[Nb.AND]:Object.keys(e).map(n=>({[n]:e[n]}))});function zT(e,n,{auto:t=!0}={}){const r=a=>{let l=Object.keys(a);const o=wne(a);if(!o&&l.length>1&&!V1(a))return r(l_(a));if(Nne(a)){const u=o?a[q1.PATH]:l[0],d=o?a[q1.PATTERN]:a[u];if(!Vl(d))throw new Error(Yte(u));const h={keyId:$1(u),pattern:d};return t&&(h.searcher=U1(d,n)),h}let f={children:[],operator:l[0]};return l.forEach(u=>{const d=a[u];Vo(d)&&d.forEach(h=>{f.children.push(r(h))})}),f};return V1(e)||(e=l_(e)),r(e)}function Sne(e,{ignoreFieldNorm:n=$t.ignoreFieldNorm}){e.forEach(t=>{let r=1;t.matches.forEach(({key:a,norm:l,score:o})=>{const f=a?a.weight:null;r*=Math.pow(o===0&&f?Number.EPSILON:o,(f||1)*(n?1:l))}),t.score=r})}function jne(e,n){const t=e.matches;n.matches=[],Fa(t)&&t.forEach(r=>{if(!Fa(r.indices)||!r.indices.length)return;const{indices:a,value:l}=r;let o={indices:a,value:l};r.key&&(o.key=r.key.src),r.idx>-1&&(o.refIndex=r.idx),n.matches.push(o)})}function Cne(e,n){n.score=e.score}function _ne(e,n,{includeMatches:t=$t.includeMatches,includeScore:r=$t.includeScore}={}){const a=[];return t&&a.push(jne),r&&a.push(Cne),e.map(l=>{const{idx:o}=l,f={item:n[o],refIndex:o};return a.length&&a.forEach(u=>{u(l,f)}),f})}class np{constructor(n,t={},r){this.options={...$t,...t},this.options.useExtendedSearch,this._keyStore=new Kte(this.options.keys),this.setCollection(n,r)}setCollection(n,t){if(this._docs=n,t&&!(t instanceof Jw))throw new Error(Gte);this._myIndex=t||LT(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(n){Fa(n)&&(this._docs.push(n),this._myIndex.add(n))}remove(n=()=>!1){const t=[];for(let r=0,a=this._docs.length;r<a;r+=1){const l=this._docs[r];n(l,r)&&(this.removeAt(r),r-=1,a-=1,t.push(l))}return t}removeAt(n){this._docs.splice(n,1),this._myIndex.removeAt(n)}getIndex(){return this._myIndex}search(n,{limit:t=-1}={}){const{includeMatches:r,includeScore:a,shouldSort:l,sortFn:o,ignoreFieldNorm:f}=this.options;let u=Vl(n)?Vl(this._docs[0])?this._searchStringList(n):this._searchObjectList(n):this._searchLogical(n);return Sne(u,{ignoreFieldNorm:f}),l&&u.sort(o),PT(t)&&t>-1&&(u=u.slice(0,t)),_ne(u,this._docs,{includeMatches:r,includeScore:a})}_searchStringList(n){const t=U1(n,this.options),{records:r}=this._myIndex,a=[];return r.forEach(({v:l,i:o,n:f})=>{if(!Fa(l))return;const{isMatch:u,score:d,indices:h}=t.searchIn(l);u&&a.push({item:l,idx:o,matches:[{score:d,value:l,norm:f,indices:h}]})}),a}_searchLogical(n){const t=zT(n,this.options),r=(f,u,d)=>{if(!f.children){const{keyId:g,searcher:b}=f,v=this._findMatches({key:this._keyStore.get(g),value:this._myIndex.getValueForItemAtKeyId(u,g),searcher:b});return v&&v.length?[{idx:d,item:u,matches:v}]:[]}const h=[];for(let g=0,b=f.children.length;g<b;g+=1){const v=f.children[g],S=r(v,u,d);if(S.length)h.push(...S);else if(f.operator===Nb.AND)return[]}return h},a=this._myIndex.records,l={},o=[];return a.forEach(({$:f,i:u})=>{if(Fa(f)){let d=r(t,f,u);d.length&&(l[u]||(l[u]={idx:u,item:f,matches:[]},o.push(l[u])),d.forEach(({matches:h})=>{l[u].matches.push(...h)}))}}),o}_searchObjectList(n){const t=U1(n,this.options),{keys:r,records:a}=this._myIndex,l=[];return a.forEach(({$:o,i:f})=>{if(!Fa(o))return;let u=[];r.forEach((d,h)=>{u.push(...this._findMatches({key:d,value:o[h],searcher:t}))}),u.length&&l.push({idx:f,item:o,matches:u})}),l}_findMatches({key:n,value:t,searcher:r}){if(!Fa(t))return[];let a=[];if(Vo(t))t.forEach(({v:l,i:o,n:f})=>{if(!Fa(l))return;const{isMatch:u,score:d,indices:h}=r.searchIn(l);u&&a.push({score:d,key:n,value:l,idx:o,norm:f,indices:h})});else{const{v:l,n:o}=t,{isMatch:f,score:u,indices:d}=r.searchIn(l);f&&a.push({score:u,key:n,value:l,norm:o,indices:d})}return a}}np.version="7.1.0";np.createIndex=LT;np.parseIndex=ane;np.config=$t;np.parseQuery=zT;vne(bne);const kne="_modalOverlay_3gtbq_1",Ene="_modalContent_3gtbq_45",Tne="_modalHeader_3gtbq_99",Ane="_modalTitle_3gtbq_117",Dne="_modalCloseButton_3gtbq_139",Pne="_modalBody_3gtbq_177",Ine="_itemCard_3gtbq_195",Mne="_highConfidence_3gtbq_219",Rne="_mediumConfidence_3gtbq_229",Lne="_lowConfidence_3gtbq_239",One="_itemLabel_3gtbq_249",Fne="_itemName_3gtbq_267",$ne="_itemQty_3gtbq_279",zne="_statusIcon_3gtbq_293",Bne="_searchContainer_3gtbq_313",Une="_searchWrapper_3gtbq_321",qne="_searchInput_3gtbq_351",Vne="_searchResults_3gtbq_371",Hne="_searchItem_3gtbq_399",Gne="_matchedItemInfo_3gtbq_421",Yne="_errorText_3gtbq_447",Wne="_modalFooter_3gtbq_459",Qne="_btn_3gtbq_477",Jne="_btnSecondary_3gtbq_501",Kne="_btnPrimary_3gtbq_521",Gn={modalOverlay:kne,modalContent:Ene,modalHeader:Tne,modalTitle:Ane,modalCloseButton:Dne,modalBody:Pne,itemCard:Ine,highConfidence:Mne,mediumConfidence:Rne,lowConfidence:Lne,itemLabel:One,itemName:Fne,itemQty:$ne,statusIcon:zne,searchContainer:Bne,searchWrapper:Une,searchInput:qne,searchResults:Vne,searchItem:Hne,matchedItemInfo:Gne,errorText:Yne,modalFooter:Wne,btn:Qne,btnSecondary:Jne,btnPrimary:Kne},Xne=({isOpen:e,onClose:n,recurringItems:t,inventory:r,onCreateOrder:a})=>{const[l,o]=w.useState([]),[f,u]=w.useState(""),[d,h]=w.useState(null),[g,b]=w.useState([]),v=w.useMemo(()=>new np(r,{keys:["name","composition"],threshold:.4,includeScore:!0}),[r]);w.useEffect(()=>{if(e&&t.length>0&&r.length>0){const E=t.map(P=>{const I=v.search(P.name);let V=null,F="none";if(I.length>0){V=I[0].item;const O=I[0].score||1;O<.1?F="high":O<.4?F="medium":F="low"}return{original:P,matchedDrug:V,confidence:F}});o(E)}},[e,t,r,v]),w.useEffect(()=>{if(f){const E=v.search(f).map(P=>P.item);b(E.slice(0,10))}else b([])},[f,v]);const S=(E,P)=>{o(I=>{const V=[...I];return V[E]={...V[E],matchedDrug:P,confidence:"high"},V}),h(null),u("")},k=()=>{const E=l.filter(P=>P.matchedDrug).map(P=>{const I=Number(P.matchedDrug.price),V=T(P.matchedDrug.unit),F=I/(V||1),O=P.original.pack_quantity||0,B=P.original.loose_quantity||0,U=O*I+B*F;return{drug_id:P.matchedDrug.id,name:P.matchedDrug.name,pack_quantity:O,loose_quantity:B,pack_price:I,loose_price:F,total_price:U,unit:P.matchedDrug.unit,tabletsPerDay:P.original.tabletsPerDay,numberOfDays:P.original.numberOfDays,directions_to_use:P.original.directions_to_use}});a(E)},T=E=>{if(!E)return 1;const P=E.match(/(?:\d+x)?(\d+)/);return P?parseInt(P[1],10):1};return e?i.jsx("div",{className:Gn.modalOverlay,children:i.jsxs("div",{className:Gn.modalContent,children:[i.jsxs("div",{className:Gn.modalHeader,children:[i.jsx("h2",{className:Gn.modalTitle,children:"Review Recurring Items"}),i.jsx("button",{onClick:n,className:Gn.modalCloseButton,title:"Close",children:i.jsx(Kn,{size:24})})]}),i.jsx("div",{className:Gn.modalBody,children:i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:l.map((E,P)=>i.jsxs("div",{className:`${Gn.itemCard} ${E.confidence==="high"?Gn.highConfidence:E.confidence==="medium"?Gn.mediumConfidence:Gn.lowConfidence}`,children:[i.jsxs("div",{children:[i.jsx("p",{className:Gn.itemLabel,children:"Recurring Item"}),i.jsx("p",{className:Gn.itemName,children:E.original.name}),i.jsxs("p",{className:Gn.itemQty,children:["Qty: ",E.original.pack_quantity?`${E.original.pack_quantity} packs`:"",E.original.loose_quantity?` ${E.original.loose_quantity} loose`:""]})]}),i.jsx("div",{className:Gn.statusIcon,children:E.confidence==="high"?i.jsx(Zm,{size:20,style:{color:"#22c55e"}}):i.jsx(M_,{size:20,style:{color:"#eab308"}})}),i.jsxs("div",{className:Gn.searchContainer,children:[i.jsx("p",{className:Gn.itemLabel,children:"Matched Inventory"}),d===P?i.jsxs("div",{className:Gn.searchContainer,children:[i.jsxs("div",{className:Gn.searchWrapper,children:[i.jsx(vi,{size:16,style:{color:"#9ca3af"}}),i.jsx("input",{type:"text",value:f,onChange:I=>u(I.target.value),placeholder:"Search inventory...",className:Gn.searchInput,autoFocus:!0}),i.jsx("button",{onClick:()=>h(null),style:{background:"none",border:"none",cursor:"pointer",color:"#9ca3af"},children:i.jsx(Kn,{size:16})})]}),g.length>0&&i.jsx("div",{className:Gn.searchResults,children:g.map(I=>i.jsxs("div",{onClick:()=>S(P,I),className:Gn.searchItem,children:[i.jsx("div",{style:{fontWeight:600,fontSize:"0.875rem"},children:I.name}),i.jsxs("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:["Stock: ",I.quantity_in_stock," | ",I.price]})]},I.id))})]}):i.jsx("div",{onClick:()=>{h(P),u("")},className:Gn.matchedItemInfo,children:E.matchedDrug?i.jsxs("div",{children:[i.jsx("p",{style:{fontWeight:700,color:"var(--heading-color)"},children:E.matchedDrug.name}),i.jsxs("p",{style:{fontSize:"0.75rem",color:"var(--secondary-text-color)"},children:["Stock: ",E.matchedDrug.quantity_in_stock," | ",E.matchedDrug.price]})]}):i.jsx("p",{className:Gn.errorText,children:"No match found. Click to search."})})]})]},P))})}),i.jsxs("div",{className:Gn.modalFooter,children:[i.jsx("button",{onClick:n,className:`${Gn.btn} ${Gn.btnSecondary}`,children:"Cancel"}),i.jsxs("button",{onClick:k,disabled:l.some(E=>!E.matchedDrug),className:`${Gn.btn} ${Gn.btnPrimary}`,children:[i.jsx(Zm,{size:18}),"Create Order"]})]})]})}):null},B0=15,Zne=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,l]=w.useState(null),[o,f]=w.useState(!1),[u,d]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState([]),[S,k]=w.useState(null),[T,E]=w.useState(30),P=wt(),[I,V]=w.useState(""),[F,O]=w.useState(""),[B,U]=w.useState(1),[z,$]=w.useState(1),[R,H]=w.useState(0),[ee,Z]=w.useState("next_delivery_date"),[te,Q]=w.useState("asc"),[q,W]=w.useState("");w.useEffect(()=>{const Re=setTimeout(()=>{O(I),U(1)},500);return()=>{clearTimeout(Re)}},[I]);const ne=w.useCallback(async(Re,je,he,Ae,we)=>{r(!0),l(null);try{const Me=new URLSearchParams({page:Re.toString(),limit:B0.toString(),sortBy:he,sortOrder:Ae});je&&Me.append("search",je),we&&Me.append("status",we);const De=await fe(`/api/recurring-medications?${Me.toString()}`);if(!De.ok){const nt=await De.json().catch(()=>({}));throw new Error(nt.message||"Failed to fetch recurring medications")}const Je=await De.json();n(Je.recurringMedications),H(Je.totalCount),U(Je.currentPage),$(Je.totalPages)}catch(Me){l(Me.message),n([]),H(0),U(1),$(1)}finally{r(!1)}},[]),A=async()=>{try{const Re=await fe("/api/drugs");if(Re.ok){const je=await Re.json();v(je)}}catch(Re){console.error("Failed to fetch inventory:",Re)}};w.useEffect(()=>{ne(B,F,ee,te,q),A()},[B,F,ee,te,q,ne]);const ie=Re=>{const je=ee===Re&&te==="asc"?"desc":"asc";Z(Re),Q(je),U(1)},se=async(Re,je)=>{try{if(!(await fe(`/api/recurring-medications/${Re}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:je})})).ok)throw new Error("Failed to update status");ne(B,F,ee,te,q)}catch(he){alert(`Error updating status: ${he.message}`)}},M=(Re,je)=>{k(Re),E(je)},ce=async Re=>{if(T<1||T>365){alert("Frequency must be between 1 and 365 days");return}try{const je=await fe(`/api/recurring-medications/${Re}/frequency`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({frequency_days:T})});if(!je.ok){const he=await je.json().catch(()=>({}));throw new Error(he.message||"Failed to update frequency")}k(null),ne(B,F,ee,te,q)}catch(je){alert(`Error updating frequency: ${je.message}`)}},ve=()=>{k(null)},le=Re=>{g(Re),f(!0),d(!1)},xe=Re=>{g(Re),d(!0),f(!1)},ue=Re=>{ne(B,F,ee,te,q)},ze=async Re=>{if(h)try{const je={patient_id:h.patient_id,items:Re,prescription_for_unavailable_drugs:"",status:"pending",date:new Date().toISOString(),order_total:Re.reduce((Ae,we)=>Ae+(we.total_price||we.pack_quantity*we.pack_price+we.loose_quantity*we.loose_price),0),recurring_medication_id:h.id},he=await fe("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(je)});if(!he.ok){const Ae=await he.json().catch(()=>({}));throw new Error(Ae.message||"Failed to create order")}alert("Order created successfully!"),f(!1),g(null),ne(B,F,ee,te,q)}catch(je){alert(`Failed to create order: ${je.message}`)}},tt=(Re,je)=>{const he=je.map(Ae=>({name:Ae.name,pack_quantity:Ae.pack_quantity,loose_quantity:Ae.loose_quantity,price:Ae.price,pack_price:Ae.pack_price,loose_price:Ae.loose_price,total_price:Number(Ae.total_price)||0,isLoose:Ae.isLoose,unit:Ae.unit,drug_id:Ae.drug_id?String(Ae.drug_id):null,tabletsPerDay:Ae.tabletsPerDay,numberOfDays:Ae.numberOfDays,directions_to_use:Ae.directions_to_use,discount_percentage:Ae.discount_percentage??0,batch:Ae.batch,expiry_date:Ae.expiry_date}));P(`/dashboard/pharmacy-billing/${Re}`,{state:{initialItems:he}})},ft=async(Re,je)=>{try{const he=await fe(`/api/pharmacy-orders/${Re}`);if(!he.ok)throw new Error("Failed to fetch order details");const Ae=await he.json(),we={status:je,medications:Ae.medications},Me=await fe(`/api/pharmacy-orders/${Re}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(we)});if(!Me.ok){const De=await Me.text();throw new Error(`Failed to update status: ${Me.statusText} (${Me.status}) - ${De}`)}ne(B,F,ee,te,q),alert(`Order marked as ${je} successfully!`)}catch(he){console.error("Failed to update order status:",he),alert(`Error updating status: ${he.message}`)}};return i.jsxs("div",{className:"recurring-medications-page-container",children:[i.jsxs("div",{className:"recurring-medications-header",children:[i.jsxs("div",{className:"recurring-medications-header-left",children:[i.jsxs("button",{onClick:()=>P(-1),className:"recurring-medications-button recurring-medications-button-back",children:[i.jsx(Ht,{size:20}),"Back"]}),i.jsx("h1",{className:"recurring-medications-page-title",children:"Recurring Medications"})]}),i.jsxs("button",{onClick:()=>ne(B,F,ee,te,q),className:"recurring-medications-button recurring-medications-button-primary",children:[i.jsx($h,{size:18}),"Refresh"]})]}),i.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",flexDirection:"column",gap:"1rem"},children:[i.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center",flexWrap:"wrap"},children:[i.jsxs("div",{style:{flex:"1 1 300px",position:"relative"},children:[i.jsx("input",{type:"text",placeholder:"Search by name, phone, or token...",value:I,onChange:Re=>V(Re.target.value),style:{width:"100%",padding:"0.75rem 3rem 0.75rem 1rem",border:"2px solid #e5e7eb",borderRadius:"0.5rem",fontSize:"0.95rem",transition:"all 0.2s ease",outline:"none"},onFocus:Re=>Re.target.style.borderColor="#6d28d9",onBlur:Re=>Re.target.style.borderColor="#e5e7eb"}),i.jsx(vi,{size:20,style:{position:"absolute",right:"1rem",top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",border:"2px solid #e5e7eb",borderRadius:"0.5rem",padding:"0.75rem 1rem",backgroundColor:"#ffffff"},children:[i.jsx(A_,{size:18,style:{color:"#6b7280"}}),i.jsxs("select",{id:"statusFilter",value:q,onChange:Re=>W(Re.target.value),style:{border:"none",outline:"none",fontSize:"0.95rem",backgroundColor:"transparent",cursor:"pointer",fontWeight:500,color:"#374151"},children:[i.jsx("option",{value:"",children:"All Status"}),i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"paused",children:"Paused"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})]}),!t&&R>0&&i.jsxs("div",{style:{fontSize:"0.875rem",color:"#6b7280",fontWeight:500},children:["Found ",i.jsx("span",{style:{color:"#6d28d9",fontWeight:700},children:R})," recurring medication",R!==1?"s":"",(F||q)&&" matching your criteria"]})]}),i.jsxs("div",{className:"recurring-medications-content-box",children:[a&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"1rem 1.25rem",backgroundColor:"#fee2e2",border:"2px solid #fca5a5",borderRadius:"0.75rem",color:"#991b1b",marginBottom:"1.5rem",boxShadow:"0 2px 4px rgba(239, 68, 68, 0.1)"},children:[i.jsx(si,{size:24,style:{flexShrink:0}}),i.jsxs("div",{children:[i.jsx("p",{style:{fontWeight:600,marginBottom:"0.25rem"},children:"Error Loading Data"}),i.jsx("p",{style:{fontSize:"0.875rem",margin:0},children:a})]})]}),t?i.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"20rem",gap:"1rem"},children:[i.jsx("div",{className:"spinner"}),i.jsx("p",{style:{color:"#6b7280",fontSize:"0.95rem",fontWeight:500},children:"Loading recurring medications..."})]}):e.length===0?i.jsxs("div",{style:{textAlign:"center",padding:"4rem 2rem",background:"linear-gradient(135deg, #f9fafb 0%, #ffffff 100%)",borderRadius:"1rem",border:"2px dashed #d1d5db",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[i.jsx("div",{style:{width:"4rem",height:"4rem",margin:"0 auto 1.5rem",borderRadius:"50%",background:"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx(si,{size:32,style:{color:"#3b82f6"}})}),i.jsx("p",{style:{color:"#1f2937",fontSize:"1.125rem",fontWeight:600,marginBottom:"0.5rem"},children:F||q?"No matches found":"No recurring medications"}),i.jsx("p",{style:{color:"#6b7280",fontSize:"0.95rem"},children:F||q?"Try adjusting your search or filter criteria":"Recurring medications will appear here once created"})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"recurring-medications-table-container",children:i.jsxs("table",{className:"recurring-medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[i.jsxs("div",{className:"sortable-header",onClick:()=>ie("patient_name"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"0.25rem"},children:[i.jsx("span",{children:"Name"}),ee==="patient_name"&&(te==="asc"?i.jsx(Lo,{size:12}):i.jsx(Wc,{size:12}))]}),i.jsxs("div",{style:{display:"flex",gap:"0.5rem",fontSize:"0.75rem",color:"#6b7280"},children:[i.jsxs("div",{className:"sortable-header",onClick:()=>ie("patient_phone"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"0.25rem"},children:[i.jsx("span",{children:"Phone"}),ee==="patient_phone"&&(te==="asc"?i.jsx(Lo,{size:10}):i.jsx(Wc,{size:10}))]}),i.jsx("span",{children:"|"}),i.jsxs("div",{className:"sortable-header",onClick:()=>ie("patient_token"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"0.25rem"},children:[i.jsx("span",{children:"Token"}),ee==="patient_token"&&(te==="asc"?i.jsx(Lo,{size:10}):i.jsx(Wc,{size:10}))]})]})]})}),i.jsx("th",{children:"Medications"}),i.jsxs("th",{className:"sortable-header",onClick:()=>ie("next_delivery_date"),style:{cursor:"pointer",userSelect:"none"},children:["Next Delivery",ee==="next_delivery_date"&&(te==="asc"?i.jsx(Lo,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}):i.jsx(Wc,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}))]}),i.jsxs("th",{className:"sortable-header",onClick:()=>ie("frequency_days"),style:{cursor:"pointer",userSelect:"none"},children:["Frequency",ee==="frequency_days"&&(te==="asc"?i.jsx(Lo,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}):i.jsx(Wc,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}))]}),i.jsxs("th",{className:"sortable-header",onClick:()=>ie("status"),style:{cursor:"pointer",userSelect:"none"},children:["Status",ee==="status"&&(te==="asc"?i.jsx(Lo,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}):i.jsx(Wc,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}))]}),i.jsx("th",{children:"Last Order"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map(Re=>i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{style:{fontWeight:500,color:"#1f2937"},children:Re.patient_name}),i.jsx("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:Re.patient_phone}),i.jsxs("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:["Token: ",Re.patient_token]})]}),i.jsx("td",{children:i.jsx("ul",{style:{listStyleType:"disc",paddingLeft:"1.25rem",fontSize:"0.875rem",color:"#4b5563"},children:Re.medications.map((je,he)=>i.jsxs("li",{style:{marginBottom:"0.25rem"},children:[i.jsxs("div",{children:[i.jsx("strong",{style:{color:"#1f2937"},children:je.name}),je.pack_quantity?` (${je.pack_quantity} packs)`:"",je.loose_quantity?` (${je.loose_quantity} loose)`:""]}),i.jsxs("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:[je.tabletsPerDay&&je.numberOfDays?`${je.tabletsPerDay} tab/day for ${je.numberOfDays} days`:"",je.directions_to_use&&` - ${je.directions_to_use}`]})]},he))})}),i.jsx("td",{children:i.jsx("div",{style:{fontSize:"0.875rem"},children:new Date(Re.next_delivery_date).toLocaleDateString()})}),i.jsx("td",{children:S===Re.id?i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.jsx("input",{type:"number",min:"1",max:"365",value:T,onChange:je=>E(parseInt(je.target.value,10)||1),style:{width:"4rem",padding:"0.25rem 0.5rem",border:"2px solid #6d28d9",borderRadius:"0.375rem",fontSize:"0.875rem",outline:"none"},autoFocus:!0,onKeyDown:je=>{je.key==="Enter"&&ce(Re.id),je.key==="Escape"&&ve()}}),i.jsx("span",{style:{fontSize:"0.875rem",color:"#4b5563"},children:"days"}),i.jsx("button",{onClick:()=>ce(Re.id),style:{padding:"0.25rem 0.5rem",backgroundColor:"#22c55e",color:"white",border:"none",borderRadius:"0.375rem",cursor:"pointer",fontSize:"0.75rem",fontWeight:600},title:"Save (Enter)",children:""}),i.jsx("button",{onClick:ve,style:{padding:"0.25rem 0.5rem",backgroundColor:"#ef4444",color:"white",border:"none",borderRadius:"0.375rem",cursor:"pointer",fontSize:"0.75rem",fontWeight:600},title:"Cancel (Esc)",children:""})]}):i.jsxs("div",{onClick:()=>M(Re.id,Re.frequency_days||30),style:{fontSize:"0.875rem",color:"#4b5563",cursor:"pointer",padding:"0.25rem 0.5rem",borderRadius:"0.375rem",transition:"all 0.2s ease",display:"inline-block"},onMouseEnter:je=>{je.currentTarget.style.backgroundColor="#f3f4f6",je.currentTarget.style.color="#6d28d9"},onMouseLeave:je=>{je.currentTarget.style.backgroundColor="transparent",je.currentTarget.style.color="#4b5563"},title:"Click to edit frequency",children:["Every ",Re.frequency_days||30," days "]})}),i.jsx("td",{children:i.jsx("span",{className:`status-badge ${Re.status}`,children:Re.status})}),i.jsx("td",{children:Re.last_order?i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[i.jsxs("div",{style:{fontSize:"0.875rem"},children:[i.jsx("span",{style:{fontWeight:500},children:"Status: "}),i.jsx("span",{className:`status-badge ${Re.last_order.status}`,children:Re.last_order.status})]}),i.jsx("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:new Date(Re.last_order.date).toLocaleDateString()}),i.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[Re.last_order.status==="pending"&&i.jsxs("button",{onClick:()=>tt(Re.last_order.id,Re.medications),className:"small-action-button bill",children:[i.jsx(E_,{size:12})," Bill"]}),Re.last_order.status==="billed"&&i.jsxs("button",{onClick:()=>ft(Re.last_order.id,"dispensed"),className:"small-action-button dispense",children:[i.jsx(Ud,{size:12})," Dispense"]}),Re.last_order.status==="dispensed"&&i.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem",color:"#16a34a"},children:[i.jsx(Ua,{size:12})," Complete"]})]})]}):i.jsx("span",{style:{fontSize:"0.875rem",color:"#9ca3af"},children:"No recent order"})}),i.jsx("td",{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.jsxs("select",{value:Re.status,onChange:je=>se(Re.id,je.target.value),style:{fontSize:"0.875rem",borderColor:"#d1d5db",borderRadius:"0.375rem",padding:"0.25rem 0.5rem"},children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"paused",children:"Paused"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]}),i.jsx("button",{onClick:()=>xe(Re),className:"action-button",title:"Edit Recurring Medication",style:{color:"#6d28d9"},children:i.jsx(tu,{size:18})}),i.jsx("button",{onClick:()=>le(Re),className:"action-button",title:"Create Order",children:i.jsx(JI,{size:18})})]})})]},Re.id))})]})}),z>1&&i.jsxs("div",{className:"pagination-controls",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"1.5rem",padding:"1rem",backgroundColor:"#f9fafb",borderRadius:"0.5rem"},children:[i.jsxs("div",{className:"pagination-info",style:{fontSize:"0.875rem",color:"#6b7280"},children:["Showing"," ",i.jsx("span",{style:{fontWeight:500,color:"#1f2937"},children:(B-1)*B0+1})," ","to"," ",i.jsx("span",{style:{fontWeight:500,color:"#1f2937"},children:Math.min(B*B0,R)})," ","of"," ",i.jsx("span",{style:{fontWeight:500,color:"#1f2937"},children:R})," results"]}),i.jsxs("div",{className:"pagination-buttons",style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[i.jsxs("button",{onClick:()=>U(Re=>Math.max(Re-1,1)),disabled:B===1||t,className:"pagination-button",style:{display:"flex",alignItems:"center",gap:"0.25rem",padding:"0.5rem 1rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",backgroundColor:B===1?"#f3f4f6":"#fff",cursor:B===1?"not-allowed":"pointer",fontSize:"0.875rem"},children:[i.jsx(Cb,{size:16}),"Previous"]}),i.jsxs("span",{style:{fontSize:"0.875rem",color:"#6b7280"},children:["Page ",i.jsx("span",{style:{fontWeight:500,color:"#1f2937"},children:B})," of ",i.jsx("span",{style:{fontWeight:500,color:"#1f2937"},children:z})]}),i.jsxs("button",{onClick:()=>U(Re=>Math.min(Re+1,z)),disabled:B===z||t,className:"pagination-button",style:{display:"flex",alignItems:"center",gap:"0.25rem",padding:"0.5rem 1rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",backgroundColor:B===z?"#f3f4f6":"#fff",cursor:B===z?"not-allowed":"pointer",fontSize:"0.875rem"},children:["Next",i.jsx(ug,{size:16})]})]})]})]})]}),h&&i.jsx(Xne,{isOpen:o,onClose:()=>{f(!1),g(null)},recurringItems:h.medications,inventory:b,onCreateOrder:ze}),h&&i.jsx(mE,{isOpen:u,onClose:()=>{d(!1),g(null)},recurringMedication:h,onUpdate:ue,inventory:b})]})},eie="_overlay_a5reh_1",tie="_content_a5reh_45",nie="_header_a5reh_99",iie="_input_a5reh_115",rie="_results_a5reh_145",aie="_list_a5reh_155",sie="_listItem_a5reh_167",lie="_noResults_a5reh_203",Yc={overlay:eie,content:tie,header:nie,input:iie,results:rie,list:aie,listItem:sie,noResults:lie},oie=({isOpen:e,onClose:n,userRole:t})=>{const[r,a]=w.useState(""),l=wt(),o=w.useMemo(()=>(Z1[t]||[]).flatMap(h=>h.links),[t]),f=w.useMemo(()=>r?o.filter(d=>d.name.toLowerCase().includes(r.toLowerCase())):[],[r,o]);w.useEffect(()=>{e&&a("")},[e]);const u=d=>{l(d),n()};return e?i.jsx("div",{className:Yc.overlay,onClick:n,children:i.jsxs("div",{className:Yc.content,onClick:d=>d.stopPropagation(),children:[i.jsxs("div",{className:Yc.header,children:[i.jsx(vi,{size:20,className:"text-gray-400 mr-2"}),i.jsx("input",{type:"text",placeholder:"Search for pages...",className:Yc.input,value:r,onChange:d=>a(d.target.value),autoFocus:!0})]}),i.jsx("div",{className:Yc.results,children:f.length>0?i.jsx("ul",{className:Yc.list,children:f.map(d=>i.jsxs("li",{onClick:()=>u(d.path),className:Yc.listItem,children:[i.jsx(pP,{size:14}),d.name]},d.path))}):r&&i.jsx("div",{className:Yc.noResults,children:i.jsxs("p",{children:['No pages found matching "',r,'"']})})})]})}):null};function cie(){const[e,n]=w.useState(!1),[t,r]=w.useState(null),[a,l]=w.useState(!0),[o,f]=w.useState(null),[u,d]=w.useState(!1),h=P=>{r(P),n(!0),P.role==="admin"&&!P.has_seen_tutorial&&d(!0)},g=()=>{n(!1),r(null),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")};w.useEffect(()=>{const P=localStorage.getItem("authToken"),I=localStorage.getItem("currentUser");if(P&&I)try{const V=JSON.parse(I);r(V),n(!0),V.role==="admin"&&!V.has_seen_tutorial&&d(!0)}catch(V){console.error("Error parsing stored user data:",V),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")}l(!1)},[]),w.useEffect(()=>{(async()=>{if(e&&t)try{const I=await G_();f(I)}catch(I){console.error("Error fetching clinic pro plan status:",I),f({hasProPlan:!1})}else f(null)})()},[e,t]);const[b,v]=w.useState(null),[S,k]=w.useState(!1);w.useEffect(()=>{const P=I=>{I.preventDefault(),v(I),k(!0),console.log("beforeinstallprompt event fired")};return window.addEventListener("beforeinstallprompt",P),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&(console.log("App is already installed (standalone)."),k(!1)),()=>{window.removeEventListener("beforeinstallprompt",P)}},[]),w.useEffect(()=>{const P=window.matchMedia("(prefers-color-scheme: dark)"),I=()=>{P.matches?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")};return I(),P.addEventListener("change",I),()=>{P.removeEventListener("change",I),document.body.classList.remove("dark-mode")}},[]);const T=w.useCallback(async()=>{if(!b){console.log("Install prompt event not available.");return}const P=b;P.prompt();const{outcome:I}=await P.userChoice;console.log(`User response to the install prompt: ${I}`),v(null),k(!1)},[b]),E=async()=>{if(t)try{(await fe(`/api/users/${t.id}/tutorial-seen`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({has_seen_tutorial:!0})})).ok?(r(I=>I?{...I,has_seen_tutorial:!0}:null),localStorage.setItem("currentUser",JSON.stringify({...t,has_seen_tutorial:!0})),d(!1)):console.error("Failed to update tutorial status on backend.")}catch(P){console.error("Error marking tutorial as seen:",P)}};return a?i.jsx("div",{className:"initial-app-loading-screen",children:i.jsx("img",{src:"/logo.png",alt:"Loading App",className:"initial-app-loader-logo"})}):i.jsxs(MD,{children:[i.jsx(HD,{children:i.jsxs(_h,{children:[i.jsx(ut,{path:"/login",element:e?i.jsx(Sn,{to:"/dashboard"}):i.jsx(QD,{onLoginSuccess:h})}),i.jsx(ut,{path:"/register",element:e?i.jsx(Sn,{to:"/dashboard"}):i.jsx(JD,{})}),i.jsx(ut,{path:"/handle-complaint-url",element:e?i.jsx(Ite,{}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/live-api",element:e?i.jsx(rU,{}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/create-lab-order",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(ok,{currentUser:t})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/manage-admission",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(sk,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/lab/report/:orderId",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(XC,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/lab/enter-report/:orderId",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(XC,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/add-patient",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(h1,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/billing",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(Oee,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/lab-billing",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx($ee,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/edit-complaint/:recordId",element:e&&t?i.jsx(Mee,{}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/edit-pharmacy-order/:orderId",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(yT,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/*",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:uie(t.role,t,fe)}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/lab/view-report/:orderId",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(Qee,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/lab/search-report",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(Jee,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/patient/:patientId/lab-reports",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(Kee,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/patient/:patientId/pharmacy-orders",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(zee,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/inventory",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(xT,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/lab-inventory",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(tw,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/patient/:patientId/complaints",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(Ree,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/patient/:patientId/admission-bill/:billId",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(tte,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/start-subscription/:patientId",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(Nte,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/start-clinic-subscription",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(_te,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/refill-reminders",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(DT,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/notifications",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(Mte,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/create-custom-bill",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(lk,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/pharmacy-billing/:orderId",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(zte,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/bills/:billId",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(Bte,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/recurring-medications",element:e&&t?i.jsx(fi,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:o,children:i.jsx(Zne,{})}):i.jsx(Sn,{to:"/login"})}),i.jsx(ut,{path:"*",element:i.jsx(Sn,{to:e?"/dashboard":"/login"})})]})}),u&&i.jsx(Dte,{onClose:()=>d(!1),onMarkAsSeen:E})]})}const uie=(e,n,t)=>{switch(e){case"superadmin":return i.jsxs(_h,{children:[i.jsx(ut,{index:!0,element:i.jsx(Ete,{})}),i.jsx(ut,{path:"clinic-subscriptions",element:i.jsx(Ste,{})}),i.jsx(ut,{path:"clinic-subscriptions/add",element:i.jsx(jte,{})}),i.jsx(ut,{path:"clinic-subscriptions/edit/:id",element:i.jsx(Cte,{})}),i.jsx(ut,{path:"users",element:i.jsx(kte,{})})," ",i.jsx(ut,{path:"*",element:i.jsx("div",{children:"Unknown Super Admin Section"})})]});case"admin":return i.jsxs(_h,{children:[i.jsx(ut,{index:!0,element:i.jsx(pU,{fetchWithAuth:t})}),i.jsx(ut,{path:"staff",element:i.jsx(ete,{fetchWithAuth:t})}),i.jsx(ut,{path:"staff/add",element:i.jsx(SU,{clinicId:n==null?void 0:n.clinic_id})}),i.jsx(ut,{path:"staff/edit/:id",element:i.jsx(jU,{})}),i.jsx(ut,{path:"patients/add",element:i.jsx(h1,{})}),i.jsx(ut,{path:"search-patient",element:i.jsx(Dh,{})}),i.jsx(ut,{path:"patients",element:i.jsx(f1,{})}),i.jsx(ut,{path:"analysis",element:i.jsx(Y0,{})}),i.jsx(ut,{path:"inventory",element:i.jsx(H_,{})}),i.jsx(ut,{path:"inventory/edit/:id",element:i.jsx(NU,{})}),i.jsx(ut,{path:"distributors",element:i.jsx(t_,{})}),i.jsx(ut,{path:"purchase",element:i.jsx(n_,{})})," ",i.jsx(ut,{path:"queue",element:i.jsx(a0,{})}),i.jsx(ut,{path:"subscriptions",element:i.jsx(bte,{})}),i.jsx(ut,{path:"subscriptions/add",element:i.jsx(vte,{})}),i.jsx(ut,{path:"subscriptions/edit/:id",element:i.jsx(wte,{})}),i.jsx(ut,{path:"add-pharmacy-order",element:i.jsx(JC,{})}),i.jsx(ut,{path:"*",element:i.jsx("div",{children:"Unknown Admin Section"})})," "]});case"doctor":return i.jsxs(_h,{children:[i.jsx(ut,{index:!0,element:i.jsx(Sn,{to:"search-patient",replace:!0})}),i.jsx(ut,{path:"search-patient",element:i.jsx(Dh,{})}),i.jsx(ut,{path:"queue",element:i.jsx(a0,{})}),i.jsx(ut,{path:":patientId",element:i.jsx(a0,{})}),i.jsx(ut,{path:"add-patient",element:i.jsx(h1,{})}),i.jsx(ut,{path:"*",element:i.jsx("div",{children:"Unknown Doctor Section"})})]});case"receptionist":return i.jsxs(_h,{children:[i.jsx(ut,{index:!0,element:i.jsx(gU,{currentUser:n})}),i.jsx(ut,{path:"all-patients",element:i.jsx(f1,{})}),i.jsx(ut,{path:"search-patient",element:i.jsx(Dh,{})}),i.jsx(ut,{path:"*",element:i.jsx("div",{children:"Unknown Reception Section"})})," "]});case"lab":return i.jsx(bU,{});case"pharmacy":return i.jsxs(_h,{children:[i.jsx(ut,{index:!0,element:i.jsx(vU,{})}),i.jsx(ut,{path:"inventory",element:i.jsx(xT,{})}),i.jsx(ut,{path:"settings",element:i.jsx(wU,{})}),i.jsx(ut,{path:"add-order",element:i.jsx(JC,{})}),i.jsx(ut,{path:"edit-pharmacy-order/:orderId",element:i.jsx(yT,{})}),i.jsx(ut,{path:"analysis",element:i.jsx(Y0,{})}),i.jsx(ut,{path:"orders/:orderId",element:i.jsx(fte,{})}),i.jsx(ut,{path:"search-patient-records",element:i.jsx(Dh,{})}),i.jsx(ut,{path:"distributors",element:i.jsx(t_,{})}),i.jsx(ut,{path:"purchase",element:i.jsx(n_,{})})," ",i.jsx(ut,{path:"refill-reminders",element:i.jsx(DT,{})})," ",i.jsx(ut,{path:"*",element:i.jsx(Sn,{to:"/dashboard",replace:!0})})]});default:return i.jsxs("div",{children:["Unknown role (",e,") or dashboard not implemented."]},e)}},fi=({user:e,onLogout:n,children:t,showInstallPrompt:r,onInstallClick:a,clinicProPlanStatus:l})=>{const o=wt(),[f,u]=w.useState(!1),[d,h]=w.useState(!1),[g,b]=w.useState(window.innerWidth<=768),[v,S]=w.useState(!1),[k,T]=w.useState([]),[E,P]=w.useState(0),[I,V]=w.useState(!1),[F,O]=w.useState("Newtons Ai"),[B,U]=w.useState(null),[z,$]=w.useState(!1),R=w.useRef(null);w.useEffect(()=>{const W=()=>{b(window.innerWidth<=768)};return window.addEventListener("resize",W),()=>window.removeEventListener("resize",W)},[]),w.useEffect(()=>qs.subscribe(ne=>{$(ne)}),[]);const H=w.useCallback(async()=>{try{const W=await fe("/api/notifications");if(W.ok){const ne=await W.json(),A=new Date,ie=new Date(A.getFullYear(),A.getMonth()+1,0).getDate(),se=A.getDate()===ie,ve=ne.filter(le=>le.type==="low_stock"||le.type==="near_expiry_drug"?!1:le.type==="expired_drug"?se:!0).reduce((le,xe)=>{const ue=le.find(ze=>ze.message===xe.message);return ue?new Date(xe.created_at)>new Date(ue.created_at)?le.map(ze=>ze.message===xe.message?xe:ze):le:[...le,xe]},[]).sort((le,xe)=>{const ue={expired_drug:1,near_expiry_drug:2,low_stock:3},ze=ue[le.type]||99,tt=ue[xe.type]||99;return ze!==tt?ze-tt:new Date(xe.created_at).getTime()-new Date(le.created_at).getTime()});T(ve),P(ve.filter(le=>!le.is_read).length)}else console.error("Failed to fetch notifications:",W.statusText)}catch(W){console.error("Error fetching notifications:",W)}},[]);w.useEffect(()=>{(async()=>{if(e!=null&&e.clinic_id)try{const ne=await fe("/api/clinics/settings");if(ne.ok){const A=await ne.json();A.name===""?O("Newtons Ai"):O(A.name),U(A.logoUrl)}else console.error("Failed to fetch clinic details for display:",ne.statusText),O("Newtons Ai"),U(null)}catch(ne){console.error("Error fetching clinic details for display:",ne),O("Newtons Ai"),U(null)}else O("Newtons Ai"),U(null)})()},[e==null?void 0:e.clinic_id]),w.useEffect(()=>{if(e!=null&&e.clinic_id){H();const W=setInterval(H,5*60*1e3);return()=>clearInterval(W)}},[e==null?void 0:e.clinic_id,H]);const ee=()=>{u(!f),f||(h(!1),S(!1))},Z=()=>{h(!d),d||(u(!1),S(!1))},te=()=>{S(!v),v||(u(!1),h(!1))};w.useEffect(()=>{const W=ne=>{R.current&&!R.current.contains(ne.target)&&v&&S(!1)};return v&&document.addEventListener("mousedown",W),()=>{document.removeEventListener("mousedown",W)}},[v]);const Q=async W=>{try{const ne=await fe(`/api/notifications/${W}/read`,{method:"PUT"});ne.ok?H():console.error("Failed to mark notification as read:",ne.statusText)}catch(ne){console.error("Error marking notification as read:",ne)}},q=async()=>{V(!0);try{const W=await fe("/api/notifications/trigger-all",{method:"POST"});W.ok?(console.log("Notification checks triggered successfully."),await H()):console.error("Failed to trigger notification checks:",W.statusText)}catch(W){console.error("Error triggering notification checks:",W)}finally{V(!1)}};return i.jsxs("div",{className:"dashboard-layout",children:[" ",i.jsxs("nav",{className:"app-header no-print",children:[i.jsxs("div",{className:"header-left",children:[g&&z?i.jsx("div",{className:"global-loading-indicator",title:"Loading...",children:i.jsx("div",{className:"spinner"})}):i.jsx("a",{href:"#",onClick:W=>{W.preventDefault(),o("/dashboard")},className:"logo-container",children:i.jsx("img",{src:B||"/logo.png",alt:"App Logo",className:"logo-image"})}),i.jsxs("div",{className:"title-section",children:[i.jsx("span",{className:"app-title-link",children:F}),i.jsxs("span",{className:"user-role-panel",children:["(",e.role.charAt(0).toUpperCase()+e.role.slice(1)," Panel)"]})]})]}),i.jsxs("div",{className:"header-right",children:[!g&&z&&i.jsx("div",{className:"global-loading-indicator",title:"Loading...",children:i.jsx("div",{className:"spinner"})}),r&&i.jsxs("button",{onClick:a,className:"install-button",title:"Install App",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),i.jsx("span",{children:"Install"})]}),l&&(l.hasProPlan?i.jsx("span",{className:"pro-badge",children:"PRO"}):i.jsx("button",{onClick:()=>o("/start-clinic-subscription"),className:"go-pro-button",children:"GoPro"})),!g&&i.jsx("button",{className:"header-search-button",onClick:Z,"aria-label":"Search pages",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),i.jsxs("div",{className:"notifications-section",ref:R,children:[" ",i.jsxs("button",{className:"notification-icon","aria-label":"Notifications",onClick:te,children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),E>0&&i.jsx("span",{className:"notification-count",children:E})]}),v&&i.jsxs("div",{className:"notifications-dropdown",children:[i.jsx("div",{className:"dropdown-header",children:"Notifications"}),i.jsx("ul",{className:"dropdown-list",children:k.length>0?k.map(W=>i.jsx("li",{className:`dropdown-item ${W.is_read?"read":"unread"}`,onClick:()=>Q(W.id),children:i.jsxs("div",{className:"notification-item-content",children:[i.jsxs("div",{className:"notification-icon-wrapper",children:[W.type==="expired_drug"&&i.jsx("svg",{className:"type-icon error",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),W.type==="near_expiry_drug"&&i.jsx("svg",{className:"type-icon warning",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),W.type==="low_stock"&&i.jsx("svg",{className:"type-icon info",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),!["expired_drug","near_expiry_drug","low_stock"].includes(W.type)&&i.jsx("svg",{className:"type-icon default",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),i.jsxs("div",{className:"notification-text-wrapper",children:[i.jsx("p",{className:"notification-message-text",children:W.message}),i.jsx("span",{className:"notification-timestamp",children:new Date(W.created_at).toLocaleString()})]})]})},W.id)):i.jsx("li",{className:"dropdown-item",children:"No new notifications"})}),i.jsxs("div",{className:"dropdown-footer",children:[i.jsx("button",{onClick:()=>o("/dashboard/notifications"),children:"View All"}),(e.role==="admin"||e.role==="superadmin")&&i.jsx("button",{onClick:q,className:"fetch-all-button",disabled:I,children:I?"Fetching...":"Fetch All"})]})]})]}),i.jsx("button",{className:"hamburger-icon",onClick:ee,"aria-label":"Open navigation",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})})]})]}),i.jsx("main",{className:"main-content",children:t}),g?i.jsx(sP,{user:e,onLogout:n,userRole:e.role,isOpen:f,onClose:ee,roleNavigation:Z1}):i.jsx(aP,{user:e,onLogout:n,userRole:e.role,isOpen:f,onClose:ee}),!g&&f&&i.jsx("div",{className:"side-panel-overlay",onClick:ee}),i.jsx(oie,{isOpen:d,onClose:()=>h(!1),userRole:e.role})]})};vA.createRoot(document.getElementById("root")).render(i.jsx(w.StrictMode,{children:i.jsx(cie,{})}));
