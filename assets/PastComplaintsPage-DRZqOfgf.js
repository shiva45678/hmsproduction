import{j as t,f as h}from"./index-DpOfI1um.js";import{j as w,u as N,r as s}from"./react-vendor-Cc0P4_ZX.js";import"./utils-vendor-azd6ta8e.js";import"./ai-vendor-CB5T-uN5.js";import"./ui-vendor-SmiJk_kJ.js";import"./chart-vendor-BcjzKorn.js";const I=()=>{const{patientId:n}=w(),u=N(),[r,l]=s.useState([]),[o,x]=s.useState(null),[c,g]=s.useState(!1),[p,d]=s.useState(null);s.useEffect(()=>{(async()=>{if(!n){d("Patient ID not provided.");return}g(!0),d(null);try{const e=await h(`/api/patients/${n}`);if(!e.ok)throw new Error(`Failed to fetch patient details: ${e.status}`);const m=await e.json();x({name:m.name,age:m.age,gender:m.gender});const i=await h(`/api/patients/${n}/complaints`);if(i.ok){const b=(await i.json()).sort((j,y)=>new Date(y.createdAt).getTime()-new Date(j.createdAt).getTime());l(b)}else if(i.status===404)l([]);else throw new Error(`Failed to fetch complaints: ${i.status}`)}catch(e){console.error("Error fetching past complaints or patient info:",e),d(`Failed to load data. ${e.message}`),l([]),x(null)}finally{g(!1)}})()},[n]);const f=a=>{navigator.clipboard.writeText(a).then(()=>console.log("Complaint copied to clipboard")).catch(e=>console.error("Failed to copy complaint: ",e))};return t.jsxs("div",{className:"container mx-auto p-4",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("button",{onClick:()=>u(-1),className:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-1 px-3 rounded text-sm",children:"< Back"}),t.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-center flex-grow",children:"Past Complaints"}),t.jsx("div",{className:"w-16"})," "]}),o&&t.jsxs("div",{className:"mb-4 p-2 bg-gray-100 rounded text-center text-sm sm:text-base",children:["Patient: ",t.jsx("strong",{children:o.name})," (",o.age??"N/A"," / ",o.gender??"N/A",")"]}),p&&t.jsxs("div",{className:"text-red-500 p-3 mb-4 border border-red-500 rounded bg-red-50 text-sm",children:["Error: ",p]}),c&&t.jsx("p",{className:"text-center text-gray-500",children:"Loading..."}),!c&&r.length===0&&!p&&t.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No past complaints found for this patient."}),!c&&r.length>0&&t.jsx("div",{className:"space-y-4",children:r.map(a=>t.jsxs("div",{className:"p-3 border rounded shadow-sm bg-white group relative",children:[t.jsx("p",{className:"text-xs text-gray-500 mb-1",children:new Date(a.createdAt).toLocaleString()}),t.jsx("p",{className:"text-sm whitespace-pre-wrap",children:a.complaint}),t.jsx("button",{onClick:()=>f(a.complaint),className:"absolute top-1 right-1 bg-gray-200 hover:bg-gray-300 text-gray-600 text-xs p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Copy complaint text",children:"ðŸ“‹"})]},a.id))})]})};export{I as default};
