import{C as S,j as e,D as F}from"./index-DCOSVs-d.js";import{j as z,u as _,r as a}from"./react-vendor-Cc0P4_ZX.js";/* empty css                           */import{z as I,E as D,X as k}from"./ui-vendor-SmiJk_kJ.js";import"./utils-vendor-azd6ta8e.js";import"./ai-vendor-CB5T-uN5.js";import"./chart-vendor-BcjzKorn.js";const A=()=>{const{id:c}=z(),x=_(),[j,f]=a.useState(null),[i,v]=a.useState({}),[p,u]=a.useState(!1),[b,m]=a.useState(!0),[d,r]=a.useState(null),[n,l]=a.useState(null),g=a.useCallback(async()=>{if(!c){r("Plan ID is missing."),m(!1);return}m(!0),r(null);try{const s=await S(c);f(s),v({name:s.name,description:s.description||"",price:Number(s.price),period:s.period,interval:Number(s.interval),razorpay_plan_id:s.razorpay_plan_id||"",status:s.status})}catch(s){r(s.message||"Failed to fetch clinic plan details."),l({type:"error",message:s.message||"Failed to fetch plan details."})}finally{m(!1)}},[c]);a.useEffect(()=>{g()},[g]),a.useEffect(()=>{if(n){const s=setTimeout(()=>l(null),5e3);return()=>clearTimeout(s)}},[n]);const t=s=>{const{name:h,value:o,type:C}=s.target;v(P=>({...P,[h]:C==="number"?parseFloat(o):o}))},y=async s=>{if(s.preventDefault(),!c){r("Plan ID is missing.");return}if(u(!0),r(null),l(null),!i.name||!i.price||!i.period||i.interval===void 0||i.interval<=0){r("Please fill in all required fields (Name, Price, Period, Interval > 0)."),u(!1);return}try{await F(c,i),l({type:"success",message:"Clinic plan updated successfully! Redirecting..."}),setTimeout(()=>{x(-1)},2e3)}catch(h){const o=h.message||"Failed to update clinic plan.";r(o),l({type:"error",message:o})}finally{u(!1)}},N=()=>{x(-1)};return b?e.jsx("div",{className:"p-6 text-center",children:"Loading clinic plan details..."}):d&&!j?e.jsx("div",{className:"p-6 text-center text-red-500",children:d}):j?e.jsxs("div",{className:"subscription-page-container",children:[n&&e.jsxs("div",{className:`${n.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[e.jsxs("div",{className:"flex items-center",children:[n.type==="success"?e.jsx(I,{size:18,className:"mr-2"}):e.jsx(D,{size:18,className:"mr-2"}),e.jsx("span",{children:n.message})]}),e.jsx("button",{onClick:()=>l(null),className:"ml-4",children:e.jsx(k,{size:16})})]}),e.jsxs("div",{className:"subscription-form",children:[e.jsx("h1",{children:"Edit Clinic Subscription Plan"}),d&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:d}),e.jsxs("form",{onSubmit:y,children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"name",children:["Plan Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"name",name:"name",value:i.name||"",onChange:t,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"description",children:"Description"}),e.jsx("textarea",{id:"description",name:"description",rows:3,value:i.description||"",onChange:t})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"price",children:["Price (INR) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:i.price!==void 0?i.price:"",onChange:t,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"period",children:["Billing Period ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:"period",name:"period",value:i.period||"monthly",onChange:t,required:!0,children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"interval",children:["Interval ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:i.interval!==void 0?i.interval:"",onChange:t,required:!0})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),e.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:i.razorpay_plan_id||"",onChange:t})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"status",children:"Status"}),e.jsxs("select",{id:"status",name:"status",value:i.status||"active",onChange:t,children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:N,className:"subscription-btn subscription-btn-secondary",children:"Back"}),e.jsxs("button",{type:"submit",disabled:p,className:"subscription-btn",children:[p?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,p?"Saving...":"Save Changes"]})]})]})]})]}):e.jsx("div",{className:"p-6 text-center text-gray-500",children:"Clinic plan not found."})};export{A as default};
