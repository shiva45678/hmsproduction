var me=a=>{throw TypeError(a)};var ie=(a,s,i)=>s.has(a)||me("Cannot "+i);var d=(a,s,i)=>(ie(a,s,"read from private field"),i?i.call(a):s.get(a)),W=(a,s,i)=>s.has(a)?me("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(a):s.set(a,i),G=(a,s,i,n)=>(ie(a,s,"write to private field"),n?n.call(a,i):s.set(a,i),i),X=(a,s,i)=>(ie(a,s,"access private method"),i);import{h as fe,s as be,i as pe,k as ve,n as ge,d as oe,l as Ne,m as ye,j as e,g as we,o as Se,f as F,q as I,e as je,u as Ce,S as v}from"./index-B0SGsixC.js";import{r as c,b as Pe,u as ke,f as Ae}from"./react-vendor-Cc0P4_ZX.js";/* empty css                   *//* empty css                   */import De from"./PatientSearchPage-D1yP4euP.js";import qe from"./ManageAdmissionPage-CyWvhc7s.js";import Ee from"./AllPatientsPage-CY2f82s9.js";import $e from"./CreateCustomBillPage-BZie7O4H.js";import Te from"./CreateLabOrderPage-DFUiLtWm.js";import{Y as ne,A as Fe,Z as Me,X as Oe,i as ee,U as Le,_ as _e,p as Re,$ as Qe,a0 as Ue,J as ze,a1 as Ke,u as Be,a2 as He}from"./ui-vendor-CZgqa0n4.js";import"./utils-vendor-azd6ta8e.js";import"./ai-vendor-CB5T-uN5.js";import"./chart-vendor-BcjzKorn.js";import"./useAutoFocusSingleInput-6a_v4dYJ.js";import"./ManageCustomColumnsModal-WzAjS72I.js";var R,B,w,Q,U,te,re,xe,Ie=(xe=class extends fe{constructor(s,i){super();W(this,U);W(this,R);W(this,B);W(this,w);W(this,Q);G(this,R,s),this.setOptions(i),this.bindMethods(),X(this,U,te).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(s){var n;const i=this.options;this.options=d(this,R).defaultMutationOptions(s),be(this.options,i)||d(this,R).getMutationCache().notify({type:"observerOptionsUpdated",mutation:d(this,w),observer:this}),i!=null&&i.mutationKey&&this.options.mutationKey&&pe(i.mutationKey)!==pe(this.options.mutationKey)?this.reset():((n=d(this,w))==null?void 0:n.state.status)==="pending"&&d(this,w).setOptions(this.options)}onUnsubscribe(){var s;this.hasListeners()||(s=d(this,w))==null||s.removeObserver(this)}onMutationUpdate(s){X(this,U,te).call(this),X(this,U,re).call(this,s)}getCurrentResult(){return d(this,B)}reset(){var s;(s=d(this,w))==null||s.removeObserver(this),G(this,w,void 0),X(this,U,te).call(this),X(this,U,re).call(this)}mutate(s,i){var n;return G(this,Q,i),(n=d(this,w))==null||n.removeObserver(this),G(this,w,d(this,R).getMutationCache().build(d(this,R),this.options)),d(this,w).addObserver(this),d(this,w).execute(s)}},R=new WeakMap,B=new WeakMap,w=new WeakMap,Q=new WeakMap,U=new WeakSet,te=function(){var i;const s=((i=d(this,w))==null?void 0:i.state)??ve();G(this,B,{...s,isPending:s.status==="pending",isSuccess:s.status==="success",isError:s.status==="error",isIdle:s.status==="idle",mutate:this.mutate,reset:this.reset})},re=function(s){ge.batch(()=>{var i,n,j,q,g,p,b,N;if(d(this,Q)&&this.hasListeners()){const x=d(this,B).variables,E=d(this,B).context,y={client:d(this,R),meta:this.options.meta,mutationKey:this.options.mutationKey};if((s==null?void 0:s.type)==="success"){try{(n=(i=d(this,Q)).onSuccess)==null||n.call(i,s.data,x,E,y)}catch(u){Promise.reject(u)}try{(q=(j=d(this,Q)).onSettled)==null||q.call(j,s.data,null,x,E,y)}catch(u){Promise.reject(u)}}else if((s==null?void 0:s.type)==="error"){try{(p=(g=d(this,Q)).onError)==null||p.call(g,s.error,x,E,y)}catch(u){Promise.reject(u)}try{(N=(b=d(this,Q)).onSettled)==null||N.call(b,void 0,s.error,x,E,y)}catch(u){Promise.reject(u)}}}this.listeners.forEach(x=>{x(d(this,B))})})},xe);function Je(a,s){const i=oe(),[n]=c.useState(()=>new Ie(i,a));c.useEffect(()=>{n.setOptions(a)},[n,a]);const j=c.useSyncExternalStore(c.useCallback(g=>n.subscribe(ge.batchCalls(g)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),q=c.useCallback((g,p)=>{n.mutate(g,p).catch(Ne)},[n]);if(j.error&&ye(n.options.throwOnError,[j.error]))throw j.error;return{...j,mutate:q,mutateAsync:j.mutate}}const We=()=>{const a=c.useRef(null),s=c.useRef(null),[i,n]=c.useState(!1),[j,q]=c.useState(0),[g,p]=c.useState(!1),[b,N]=c.useState(!1),[x,E]=c.useState(null),y=30,u=100,_=async()=>{try{const C=await navigator.mediaDevices.getUserMedia({video:!0});a.current&&(a.current.srcObject=C,N(!0),E(null))}catch(C){console.error("Error accessing camera:",C),E("Camera access denied. Please allow camera permissions to use motion detection."),N(!1)}},z=()=>{var P;const C=(P=a.current)==null?void 0:P.srcObject;C&&C.getTracks().forEach($=>$.stop()),N(!1)};c.useEffect(()=>(_(),()=>z()),[]),c.useEffect(()=>{if(!b)return;let C;const P=s.current,$=a.current;if(!P||!$)return;const k=P.getContext("2d",{willReadFrequently:!0});if(!k)return;const M=320,r=240;P.width=M,P.height=r;let h=null;const L=()=>{if($.readyState===$.HAVE_ENOUGH_DATA){k.drawImage($,0,0,M,r);const K=k.getImageData(0,0,M,r).data;if(h){let V=0;for(let A=0;A<K.length;A+=4*4){const se=Math.abs(K[A]-h[A]),Y=Math.abs(K[A+1]-h[A+1]),ae=Math.abs(K[A+2]-h[A+2]);se+Y+ae>y&&V++}if(V>u){const A=Date.now();q(A),n(!0),g||p(!0)}else n(!1)}h=K}C=requestAnimationFrame(L)};return L(),()=>{cancelAnimationFrame(C)}},[b,g]);const S=()=>{p(!1)};return e.jsxs("div",{className:"motion-detect-container",style:{padding:"20px",height:"100%",display:"flex",flexDirection:"column",gap:"20px"},children:[e.jsxs("div",{className:"status-header bg-white p-4 rounded-lg shadow-sm flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-full ${b?"bg-green-100 text-green-600":"bg-red-100 text-red-600"}`,children:e.jsx(ne,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Motion Detection Status"}),e.jsx("p",{className:"text-sm text-gray-500",children:b?"Camera Active - Monitoring":"Camera Inactive"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full border ${i?"bg-red-50 border-red-200 text-red-600 animate-pulse":"bg-gray-50 border-gray-200 text-gray-500"}`,children:[e.jsx(Fe,{size:16}),e.jsx("span",{className:"font-medium",children:i?"Motion Detected!":"No Motion"})]}),e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full border ${g?"bg-blue-50 border-blue-200 text-blue-600":"bg-gray-50 border-gray-200 text-gray-500"}`,children:[e.jsx(Me,{size:16}),e.jsx("span",{className:"font-medium",children:g?"AI Assistant Active":"AI Assistant Idle"})]})]})]}),x&&e.jsx("div",{className:"bg-red-50 text-red-600 p-4 rounded-lg border border-red-200",children:x}),e.jsxs("div",{className:"video-feed-container bg-black rounded-lg overflow-hidden relative shadow-lg",style:{maxWidth:"640px",margin:"0 auto"},children:[e.jsx("video",{ref:a,autoPlay:!0,muted:!0,playsInline:!0,style:{width:"100%",display:b?"block":"none"}}),e.jsx("canvas",{ref:s,style:{display:"none"}}),!b&&!x&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ne,{size:48,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Connecting to camera..."})]})})]}),g&&e.jsx(we,{onClose:S,patientData:null,tokenNumber:null,onAiSummaryChange:()=>{},lastMotionTimestamp:j,backgroundMode:!0})]})},Ge=({isOpen:a,onClose:s,onAppointmentBooked:i})=>{const[n,j]=c.useState(""),[q,g]=c.useState([]),[p,b]=c.useState(null),[N,x]=c.useState(""),[E,y]=c.useState(!1),[u,_]=c.useState(!1),[z,S]=c.useState(null);c.useEffect(()=>{a&&(j(""),g([]),b(null),x(""),S(null))},[a]);const C=Pe.useMemo(()=>Se(async r=>{if(r.length<2){g([]),_(!1);return}_(!0);try{const h=new URLSearchParams({search:encodeURIComponent(r),page:"1",limit:"10"}),L=await F(`/api/patients?${h.toString()}`);if(L.ok){const J=await L.json();g(J.patients||[])}}catch(h){console.error("Error searching patients:",h)}finally{_(!1)}},300),[]),P=r=>{const h=r.target.value;j(h),p&&b(null),h.length>=2?(_(!0),C(h)):g([])},$=r=>{b(r),j(r.name),g([])},k=async()=>{if(n.trim()){y(!0);try{const r=await F("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n.trim(),age:null,gender:null,phone:null})});if(!r.ok){const J=await r.json();throw new Error(J.message||"Failed to create patient")}const h=await r.json(),L={id:h.id,name:h.name,phone:h.phone,age:h.age,gender:h.gender,token:h.token};$(L)}catch(r){console.error("Failed to create patient:",r),S(r.message||"Failed to create patient")}finally{y(!1)}}},M=async()=>{if(!p){S("Please select a patient.");return}if(!N){S("Please select a date and time.");return}y(!0),S(null);try{if(!(await F("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:p.id,date:new Date(N).toISOString(),description:"Appointment"})})).ok)throw new Error("Failed to book appointment");i(),s()}catch(r){console.error("Error booking appointment:",r),S(r.message||"Failed to book appointment.")}finally{y(!1)}};return a?e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content appointment-modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"Book Appointment"}),e.jsx("button",{onClick:s,className:"close-button",children:e.jsx(Oe,{size:20})})]}),e.jsxs("div",{className:"modal-body",children:[z&&e.jsx("div",{className:"error-message",children:z}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Search Patient"}),e.jsxs("div",{className:"search-input-wrapper",children:[e.jsx(ee,{className:"search-icon-input",size:18}),e.jsx("input",{type:"text",placeholder:"Search by name, phone, or ID...",value:n,onChange:P,className:"modal-input"}),u&&e.jsx("div",{className:"spinner-sm"})]}),(q.length>0||n.length>0&&!u)&&!p&&e.jsxs("div",{className:"search-results-dropdown",children:[n.trim().length>0&&!u&&e.jsx("div",{className:"search-result-item create-patient-item",onClick:k,children:e.jsxs("div",{className:"patient-info",style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("div",{className:"create-icon-wrapper",children:e.jsx(Le,{size:16,color:"white"})}),e.jsxs("div",{children:[e.jsxs("span",{className:"name",style:{color:"#7c3aed"},children:['Create "',n,'"']}),e.jsx("span",{className:"details",style:{color:"#7c3aed"},children:"Add new patient"})]})]})}),q.map(r=>e.jsxs("div",{className:"search-result-item",onClick:()=>$(r),children:[e.jsxs("div",{className:"patient-info",children:[e.jsx("span",{className:"name",children:r.name}),e.jsxs("span",{className:"details",children:[r.age?`${r.age} yrs`:""," ",r.gender?`/ ${r.gender}`:""]})]}),r.phone&&e.jsx("span",{className:"phone",children:r.phone})]},r.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Appointment Date & Time"}),e.jsx("div",{className:"date-input-wrapper",children:e.jsx("input",{type:"datetime-local",className:"modal-input",value:N,onChange:r=>x(r.target.value)})})]}),p&&e.jsxs("div",{className:"selected-patient-preview",children:[e.jsx("div",{className:"preview-label",children:"Selected Patient:"}),e.jsxs("div",{className:"preview-card",children:[e.jsx(_e,{size:20}),e.jsxs("div",{children:[e.jsx("strong",{children:p.name}),e.jsxs("div",{children:[p.age?`${p.age} yrs`:"-"," / ",p.gender||"-"]})]})]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{onClick:s,className:"cancel-button",children:"Cancel"}),e.jsx("button",{onClick:M,className:"submit-button",disabled:E||!p||!N,children:E?"Booking...":"Book Appointment"})]})]})}):null};function Xe(){const a=oe();return Je({mutationFn:async({queueId:s,status:i,doctorId:n})=>{const j=await F(`/api/queue/${s}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:i,doctorId:n})});if(!j.ok)throw new Error("Failed to update queue status");return j.json()},onSuccess:(s,{queueId:i})=>{a.invalidateQueries({queryKey:I.queue.today}),a.invalidateQueries({queryKey:I.queue.entry(i)})}})}const Ve=async()=>{const a=await F("/api/staff");if(!a.ok)throw new Error("Failed to fetch staff");const s=await a.json();return s.staff||s||[]};function Ye(){return je({queryKey:[...I.staff.list,"doctors"],queryFn:Ve,staleTime:5*60*1e3,select:a=>a.filter(s=>s.role==="doctor")})}const xt=({currentUser:a})=>{const[s,i]=c.useState("queue"),[n,j]=c.useState(""),[q,g]=c.useState(new Date),p=q.toISOString().split("T")[0],[b,N]=c.useState(!1),{data:x=[],isLoading:E,refetch:y}=je({queryKey:["queue",p],queryFn:async()=>{const t=await F(`/api/queue?date=${p}`);if(!t.ok)throw new Error("Failed to fetch queue");return t.json()},staleTime:30*1e3,refetchInterval:60*1e3}),{data:u=[],isLoading:_}=Ye(),z=Xe(),S=oe(),[C,P]=c.useState(null),[$,k]=c.useState(null),M=ke(),r=Ae(),h=()=>{y()};c.useEffect(()=>{const o=new URLSearchParams(r.search).get("tab");o&&A.find(f=>f.id===o)&&i(o)},[r.search]);const L=c.useCallback(async(t,o)=>{if(console.log(`Attempting to assign doctor ${o} to queue ${t}`),k(null),P(null),!o){console.log("No doctor ID provided, skipping assignment.");return}const l=x.find(m=>m.id===t);if(!l){console.error(`Queue entry ${t} not found in local state.`),k("Queue entry not found.");return}if(l.doctor_id===o){console.log(`Queue ${t} already assigned to doctor ${o}. Skipping.`);return}const f=async m=>{if(!m||!m.id||!m.name){k("Cannot proceed: Patient ID or Name is missing."),console.error("assignAndNavigate called with invalid patientInfo",m);return}const H=async()=>{try{await z.mutateAsync({queueId:t,status:"waiting",doctorId:o});const O=u.find(Z=>Z.id===o);return console.log(`Successfully assigned doctor ${O==null?void 0:O.name} to queue ${t}.`),!0}catch(O){return console.error(`Error assigning doctor for queue ${t}:`,O),k(`Failed to assign doctor: ${O.message}`),!1}};m.subscription_status==="active"?(console.log(`Patient ${m.name} (ID: ${m.id}) has active subscription. Assigning doctor directly.`),await H()):(console.log(`Patient ${m.name} (ID: ${m.id}) does not have active subscription. Navigating to billing WITHOUT assigning doctor yet.`),M(`/dashboard/doctor-billing/${t}?doctorId=${o}`))},T=l.Patient;if(T&&T.id&&T.name)console.log("Patient details found in state. Proceeding with assignment."),await f(T);else{console.warn(`Patient details missing for queue entry ${t}. Fetching patient ${l.patient_id}...`);try{const m=await F(`/api/patients/${l.patient_id}`);if(!m.ok){const O=await m.json().catch(()=>({}));throw new Error(O.message||`Failed to fetch patient details (status ${m.status})`)}const H=await m.json();console.log("Successfully fetched patient details:",H),await f(H)}catch(m){console.error(`Failed to fetch patient details for patient ID ${l.patient_id}:`,m),k(`Failed to fetch required patient details: ${m.message}`)}}},[u,x,M,z]),J=t=>{t&&(S.prefetchQuery({queryKey:I.patients.context(t),queryFn:async()=>{const o=await F(`/api/patients/${t}/context`);if(!o.ok)throw new Error("Failed to fetch patient context");return o.json()},staleTime:5*60*1e3}),S.prefetchQuery({queryKey:I.patientDebts.balance(t),queryFn:async()=>{const o=await F(`/api/patient-debts/${t}/balance`);return o.ok?o.json():{netDebt:0}},staleTime:1*60*1e3}),S.prefetchQuery({queryKey:I.queue.latest(t),queryFn:async()=>{const o=await F(`/api/queue/patient/${t}/latest`);if(!o.ok)throw new Error("Failed to fetch latest queue status");const l=await o.json();return l!=null&&l._id&&S.prefetchQuery({queryKey:I.queue.entry(l._id),queryFn:async()=>{const f=await F(`/api/queue/doctor/complaint/${l._id}`);if(!f.ok)throw new Error("Failed to fetch complaint record");return f.json()},staleTime:1*60*1e3}),l},staleTime:5e3}))},K=async(t,o)=>{var f;k(null);const l=o==="consulting"?"start consultation":"complete visit";try{await z.mutateAsync({queueId:t,status:o,doctorId:o==="consulting"&&((f=x.find(T=>T.id===t))==null?void 0:f.doctor_id)||void 0})}catch(T){console.error(`Error trying to ${l}:`,T),k(`Failed to ${l}: ${T.message}`)}},V=async(t,o)=>{let l="red";o==="red"?l="green":o==="green"?l="blue":o==="blue"?l=null:l="red";try{if(!(await F(`/api/patients/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({color_code:l})})).ok)throw new Error("Failed to update patient color");y()}catch(f){console.error("Error updating patient color:",f)}},A=[{id:"queue",label:"Appointment Queue",icon:e.jsx(Re,{size:20})},{id:"newtons-ai",label:"Newtons AI",icon:e.jsx(ee,{size:20})},{id:"manage-admission",label:"Manage Admission",icon:e.jsx(Qe,{size:20})},{id:"all-patients",label:"All Patients",icon:e.jsx(Ue,{size:20})},{id:"lab",label:"Lab Tests",icon:e.jsx(ze,{size:20})},{id:"custom-bill",label:"Custom Bill",icon:e.jsx(Ke,{size:20})},{id:"motion-detect",label:"Motion Detect",icon:e.jsx(ne,{size:20})}],se=t=>{try{return new Date(t).toLocaleTimeString("en-IN",{hour:"numeric",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},Y=x.filter(t=>{var o,l;return(l=(o=t.Patient)==null?void 0:o.name)==null?void 0:l.toLowerCase().includes(n.toLowerCase())}),{openCommandBar:ae}=Ce();return e.jsxs("div",{className:"admin-panel-container",children:[$&&e.jsxs("div",{className:"error-message-reception",role:"alert",children:[e.jsx("strong",{children:"Error: "}),e.jsx("span",{children:$})]}),e.jsx("div",{className:"admin-nav-bar",children:A.map(t=>e.jsxs("button",{className:`admin-nav-button ${s===t.id?"active":""}`,onClick:()=>{t.id==="newtons-ai"?ae():i(t.id)},children:[e.jsx("span",{children:t.icon}),t.label]},t.id))}),e.jsx("div",{className:"admin-content-section",children:e.jsxs("main",{className:"flex-1 overflow-y-auto",style:{padding:"15px"},children:[s==="queue"&&e.jsxs("div",{className:"space-y-6",children:[" ",e.jsxs("div",{className:"queue-header",children:[" ",e.jsxs("div",{className:"queue-actions",children:[" ",e.jsxs("div",{className:"search-bar-container",children:[" ",e.jsx("input",{type:"text",placeholder:"Search patients in queue...",className:"search-input",value:n,onChange:t=>j(t.target.value)}),e.jsx(ee,{className:"search-icon",size:18})]}),e.jsxs("div",{className:"date-picker-container",children:[e.jsx(Be,{size:18,className:"text-gray-500"}),e.jsx("input",{type:"date",className:"date-input",value:q.toISOString().split("T")[0],onChange:t=>g(new Date(t.target.value))})]}),e.jsxs("button",{onClick:()=>N(!0),className:"appointment-button",children:[e.jsx(He,{size:16}),e.jsx("span",{children:"Book Appointment"})]})]}),e.jsxs("div",{className:"summary-cards-grid",children:[" ",e.jsxs("div",{className:"summary-card card-waiting",children:[" ",e.jsx("div",{className:"summary-card-title",children:"Waiting"})," ",e.jsx("div",{className:"summary-card-value",children:x.filter(t=>t.status==="waiting").length})," "]}),e.jsxs("div",{className:"summary-card card-consulting",children:[" ",e.jsx("div",{className:"summary-card-title",children:"Consulting"})," ",e.jsx("div",{className:"summary-card-value",children:x.filter(t=>t.status==="consulting").length})," "]}),e.jsxs("div",{className:"summary-card card-completed",children:[" ",e.jsx("div",{className:"summary-card-title",children:"Completed"})," ",e.jsx("div",{className:"summary-card-value",children:x.filter(t=>t.status==="seen").length})," "]})]})]}),e.jsx(Ge,{isOpen:b,onClose:()=>N(!1),onAppointmentBooked:h}),E?e.jsx("div",{className:"queue-table-wrapper",children:e.jsxs("table",{className:"queue-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx(v,{width:50,height:20})}),e.jsx("th",{children:e.jsx(v,{width:100,height:20})}),e.jsx("th",{children:e.jsx(v,{width:100,height:20})}),e.jsx("th",{children:e.jsx(v,{width:150,height:20})}),e.jsx("th",{children:e.jsx(v,{width:100,height:20})}),e.jsx("th",{className:"hidden md:table-cell",children:e.jsx(v,{width:80,height:20})}),e.jsx("th",{children:e.jsx(v,{width:120,height:20})})]})}),e.jsx("tbody",{children:[1,2,3,4,5].map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(v,{width:40,height:20})}),e.jsx("td",{children:e.jsx(v,{width:120,height:20})}),e.jsx("td",{children:e.jsx(v,{width:100,height:20})}),e.jsx("td",{children:e.jsx(v,{width:150,height:20})}),e.jsx("td",{children:e.jsx(v,{width:100,height:24,style:{borderRadius:"12px"}})}),e.jsx("td",{className:"hidden md:table-cell",children:e.jsx(v,{width:60,height:20})}),e.jsx("td",{children:e.jsx(v,{width:120,height:32})})]},t))})]})}):Y.length===0?e.jsx("div",{className:"empty-queue-message",children:n?"No patients found matching your search.":"Queue is empty."}):e.jsxs("div",{className:"queue-table-wrapper",children:[" ",e.jsxs("table",{className:"queue-table",children:[" ",e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Appointment Queue"}),e.jsx("th",{children:"Patient"}),e.jsx("th",{children:"Phone Number"}),e.jsx("th",{children:"Complaint"}),e.jsx("th",{children:"Subscription Status"}),e.jsx("th",{className:"hidden md:table-cell",children:"Time Added"})," ",e.jsx("th",{className:"text-center",children:"Action / Doctor"})," "]})}),e.jsx("tbody",{children:Y.map(t=>{var o,l,f,T,m,H,O,Z,ce,le,de,ue;return e.jsxs("tr",{onClick:()=>M(`/dashboard/edit-complaint/${t.id}`),onMouseEnter:()=>t.patient_id&&J(t.patient_id),className:"queue-row-clickable",children:[e.jsxs("td",{children:[" ",e.jsxs("span",{className:"queue-token",children:["#",t.token_no]})," "]}),e.jsxs("td",{children:[e.jsx("span",{className:`color-dot color-${((o=t.Patient)==null?void 0:o.color_code)||"none"}`,onClick:D=>{var he;D.stopPropagation(),(he=t.Patient)!=null&&he.id&&V(t.Patient.id,t.Patient.color_code)},title:"Click to change color"}),e.jsx("div",{className:"patient-name",style:{display:"inline-block",verticalAlign:"middle"},children:((l=t.Patient)==null?void 0:l.name)||"N/A"}),e.jsxs("div",{className:"patient-details",children:[(f=t.Patient)!=null&&f.age?`${t.Patient.age} yrs, `:"",((T=t.Patient)==null?void 0:T.gender)||""]})]}),e.jsxs("td",{children:[" ",e.jsx("div",{className:"patient-phone",children:((m=t.Patient)==null?void 0:m.phone)||"N/A"})," "]}),e.jsx("td",{className:"complaint-text",children:t.complaint||"-"}),e.jsxs("td",{children:[e.jsx("span",{className:`subscription-status-badge ${((H=t.Patient)==null?void 0:H.subscription_status)==="active"?"status-active":((O=t.Patient)==null?void 0:O.subscription_status)==="cancelled"||((Z=t.Patient)==null?void 0:Z.subscription_status)==="expired"?"status-inactive":"status-none"}`,children:((ce=t.Patient)==null?void 0:ce.subscription_status)??"None"}),t.Patient&&t.Patient.id&&t.Patient.subscription_status!=="active"&&e.jsx("button",{onClick:D=>{D.stopPropagation(),t.Patient&&M(`/start-subscription/${t.Patient.id}`)},className:"action-button btn-start-sub-queue mt-2",children:"Start Sub"})]}),e.jsx("td",{className:"hidden md:table-cell time-added",children:se(t.created_at)}),e.jsx("td",{className:"action-doctor-cell",children:C===t.id?e.jsx("div",{className:"relative inline-block text-left w-full",onClick:D=>D.stopPropagation(),children:e.jsxs("select",{value:"",onChange:D=>L(t.id,D.target.value),onBlur:()=>P(null),className:"doctor-select-dropdown",autoFocus:!0,children:[e.jsx("option",{value:"",disabled:!0,children:"Select Doctor..."}),_?e.jsx("option",{disabled:!0,children:"Loading..."}):u.length>0?u.map(D=>e.jsx("option",{value:D.id,children:D.name},D.id)):e.jsx("option",{disabled:!0,children:"No doctors available"})]})}):e.jsxs("div",{className:"action-doctor-content",onClick:D=>D.stopPropagation(),children:[" ",t.status==="waiting"&&e.jsx(e.Fragment,{children:(le=t.User)!=null&&le.name?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"doctor-name-display",children:t.User.name}),e.jsx("button",{onClick:()=>K(t.id,"consulting"),className:"action-button btn-start",children:"Start"})]}):_?e.jsx(v,{width:80,height:20}):u.length===0?e.jsx("span",{className:"status-text-red",children:"No doctors"}):u.length===1?e.jsxs("button",{onClick:()=>L(t.id,u[0].id),className:"action-button btn-assign",children:["Assign ",u[0].name]}):e.jsx("button",{onClick:()=>P(t.id),className:"action-button btn-assign",children:"Assign"})}),t.status==="consulting"&&e.jsxs(e.Fragment,{children:[((de=t.User)==null?void 0:de.name)&&e.jsx("span",{className:"doctor-name-display",children:t.User.name}),e.jsx("button",{onClick:()=>K(t.id,"seen"),className:"action-button btn-complete",children:"Complete"})]}),t.status==="seen"&&e.jsxs(e.Fragment,{children:[((ue=t.User)==null?void 0:ue.name)&&e.jsx("span",{className:"doctor-name-display",children:t.User.name}),e.jsx("span",{className:"status-text-italic",children:"Completed"})]}),t.status==="cancelled"&&e.jsx("span",{className:"status-text-red",children:"Cancelled"})]})})]},t.id)})})]})]})]}),s==="lab"&&e.jsxs("div",{className:"lab-tab-content",children:[" ",e.jsx(Te,{currentUser:a}),e.jsxs("button",{onClick:()=>M("/lab/search-report"),className:"lab-action-button btn-search-lab-reports",children:[e.jsx(ee,{size:16}),"Search Lab Reports"]})]}),s==="newtons-ai"&&e.jsx("div",{className:"newtons-ai-tab-content",children:e.jsx(De,{})}),s==="manage-admission"&&e.jsx("div",{className:"manage-admission-tab-content",children:e.jsx(qe,{})}),s==="all-patients"&&e.jsx("div",{className:"all-patients-tab-content",children:e.jsx(Ee,{})}),s==="custom-bill"&&e.jsx("div",{className:"custom-bill-tab-content",children:e.jsx($e,{})}),s==="motion-detect"&&e.jsx("div",{className:"motion-detect-tab-content",style:{height:"100%"},children:e.jsx(We,{})})]})})," "]})};export{xt as default};
