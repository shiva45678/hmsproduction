var QA=Object.defineProperty;var JA=(e,n,t)=>n in e?QA(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var Yn=(e,n,t)=>JA(e,typeof n!="symbol"?n+"":n,t);function KA(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const o=Object.getOwnPropertyDescriptor(r,a);o&&Object.defineProperty(e,a,o.get?o:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();var su=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ud(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ov={exports:{}},vm={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oS;function XA(){if(oS)return vm;oS=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function t(r,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var d in a)d!=="key"&&(o[d]=a[d])}else o=a;return a=o.ref,{$$typeof:e,type:r,key:l,ref:a!==void 0?a:null,props:o}}return vm.Fragment=n,vm.jsx=t,vm.jsxs=t,vm}var lS;function ZA(){return lS||(lS=1,Ov.exports=XA()),Ov.exports}var i=ZA(),Lv={exports:{}},Kt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cS;function eP(){if(cS)return Kt;cS=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.iterator;function b(E){return E===null||typeof E!="object"?null:(E=g&&E[g]||E["@@iterator"],typeof E=="function"?E:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,k={};function T(E,le,ue){this.props=E,this.context=le,this.refs=k,this.updater=ue||v}T.prototype.isReactComponent={},T.prototype.setState=function(E,le){if(typeof E!="object"&&typeof E!="function"&&E!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,E,le,"setState")},T.prototype.forceUpdate=function(E){this.updater.enqueueForceUpdate(this,E,"forceUpdate")};function P(){}P.prototype=T.prototype;function M(E,le,ue){this.props=E,this.context=le,this.refs=k,this.updater=ue||v}var I=M.prototype=new P;I.constructor=M,S(I,T.prototype),I.isPureReactComponent=!0;var U=Array.isArray,L={H:null,A:null,T:null,S:null,V:null},$=Object.prototype.hasOwnProperty;function z(E,le,ue,D,ce,ve){return ue=ve.ref,{$$typeof:e,type:E,key:le,ref:ue!==void 0?ue:null,props:ve}}function F(E,le){return z(E.type,le,void 0,void 0,void 0,E.props)}function Y(E){return typeof E=="object"&&E!==null&&E.$$typeof===e}function R(E){var le={"=":"=0",":":"=2"};return"$"+E.replace(/[=:]/g,function(ue){return le[ue]})}var B=/\/+/g;function G(E,le){return typeof E=="object"&&E!==null&&E.key!=null?R(""+E.key):le.toString(36)}function ie(){}function te(E){switch(E.status){case"fulfilled":return E.value;case"rejected":throw E.reason;default:switch(typeof E.status=="string"?E.then(ie,ie):(E.status="pending",E.then(function(le){E.status==="pending"&&(E.status="fulfilled",E.value=le)},function(le){E.status==="pending"&&(E.status="rejected",E.reason=le)})),E.status){case"fulfilled":return E.value;case"rejected":throw E.reason}}throw E}function W(E,le,ue,D,ce){var ve=typeof E;(ve==="undefined"||ve==="boolean")&&(E=null);var X=!1;if(E===null)X=!0;else switch(ve){case"bigint":case"string":case"number":X=!0;break;case"object":switch(E.$$typeof){case e:case n:X=!0;break;case p:return X=E._init,W(X(E._payload),le,ue,D,ce)}}if(X)return ce=ce(E),X=D===""?"."+G(E,0):D,U(ce)?(ue="",X!=null&&(ue=X.replace(B,"$&/")+"/"),W(ce,le,ue,"",function(Me){return Me})):ce!=null&&(Y(ce)&&(ce=F(ce,ue+(ce.key==null||E&&E.key===ce.key?"":(""+ce.key).replace(B,"$&/")+"/")+X)),le.push(ce)),1;X=0;var fe=D===""?".":D+":";if(U(E))for(var ae=0;ae<E.length;ae++)D=E[ae],ve=fe+G(D,ae),X+=W(D,le,ue,ve,ce);else if(ae=b(E),typeof ae=="function")for(E=ae.call(E),ae=0;!(D=E.next()).done;)D=D.value,ve=fe+G(D,ae++),X+=W(D,le,ue,ve,ce);else if(ve==="object"){if(typeof E.then=="function")return W(te(E),le,ue,D,ce);throw le=String(E),Error("Objects are not valid as a React child (found: "+(le==="[object Object]"?"object with keys {"+Object.keys(E).join(", ")+"}":le)+"). If you meant to render a collection of children, use an array instead.")}return X}function V(E,le,ue){if(E==null)return E;var D=[],ce=0;return W(E,D,"","",function(ve){return le.call(ue,ve,ce++)}),D}function se(E){if(E._status===-1){var le=E._result;le=le(),le.then(function(ue){(E._status===0||E._status===-1)&&(E._status=1,E._result=ue)},function(ue){(E._status===0||E._status===-1)&&(E._status=2,E._result=ue)}),E._status===-1&&(E._status=0,E._result=le)}if(E._status===1)return E._result.default;throw E._result}var re=typeof reportError=="function"?reportError:function(E){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var le=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof E=="object"&&E!==null&&typeof E.message=="string"?String(E.message):String(E),error:E});if(!window.dispatchEvent(le))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",E);return}console.error(E)};function oe(){}return Kt.Children={map:V,forEach:function(E,le,ue){V(E,function(){le.apply(this,arguments)},ue)},count:function(E){var le=0;return V(E,function(){le++}),le},toArray:function(E){return V(E,function(le){return le})||[]},only:function(E){if(!Y(E))throw Error("React.Children.only expected to receive a single React element child.");return E}},Kt.Component=T,Kt.Fragment=t,Kt.Profiler=a,Kt.PureComponent=M,Kt.StrictMode=r,Kt.Suspense=f,Kt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,Kt.__COMPILER_RUNTIME={__proto__:null,c:function(E){return L.H.useMemoCache(E)}},Kt.cache=function(E){return function(){return E.apply(null,arguments)}},Kt.cloneElement=function(E,le,ue){if(E==null)throw Error("The argument must be a React element, but you passed "+E+".");var D=S({},E.props),ce=E.key,ve=void 0;if(le!=null)for(X in le.ref!==void 0&&(ve=void 0),le.key!==void 0&&(ce=""+le.key),le)!$.call(le,X)||X==="key"||X==="__self"||X==="__source"||X==="ref"&&le.ref===void 0||(D[X]=le[X]);var X=arguments.length-2;if(X===1)D.children=ue;else if(1<X){for(var fe=Array(X),ae=0;ae<X;ae++)fe[ae]=arguments[ae+2];D.children=fe}return z(E.type,ce,void 0,void 0,ve,D)},Kt.createContext=function(E){return E={$$typeof:l,_currentValue:E,_currentValue2:E,_threadCount:0,Provider:null,Consumer:null},E.Provider=E,E.Consumer={$$typeof:o,_context:E},E},Kt.createElement=function(E,le,ue){var D,ce={},ve=null;if(le!=null)for(D in le.key!==void 0&&(ve=""+le.key),le)$.call(le,D)&&D!=="key"&&D!=="__self"&&D!=="__source"&&(ce[D]=le[D]);var X=arguments.length-2;if(X===1)ce.children=ue;else if(1<X){for(var fe=Array(X),ae=0;ae<X;ae++)fe[ae]=arguments[ae+2];ce.children=fe}if(E&&E.defaultProps)for(D in X=E.defaultProps,X)ce[D]===void 0&&(ce[D]=X[D]);return z(E,ve,void 0,void 0,null,ce)},Kt.createRef=function(){return{current:null}},Kt.forwardRef=function(E){return{$$typeof:d,render:E}},Kt.isValidElement=Y,Kt.lazy=function(E){return{$$typeof:p,_payload:{_status:-1,_result:E},_init:se}},Kt.memo=function(E,le){return{$$typeof:u,type:E,compare:le===void 0?null:le}},Kt.startTransition=function(E){var le=L.T,ue={};L.T=ue;try{var D=E(),ce=L.S;ce!==null&&ce(ue,D),typeof D=="object"&&D!==null&&typeof D.then=="function"&&D.then(oe,re)}catch(ve){re(ve)}finally{L.T=le}},Kt.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},Kt.use=function(E){return L.H.use(E)},Kt.useActionState=function(E,le,ue){return L.H.useActionState(E,le,ue)},Kt.useCallback=function(E,le){return L.H.useCallback(E,le)},Kt.useContext=function(E){return L.H.useContext(E)},Kt.useDebugValue=function(){},Kt.useDeferredValue=function(E,le){return L.H.useDeferredValue(E,le)},Kt.useEffect=function(E,le,ue){var D=L.H;if(typeof ue=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return D.useEffect(E,le)},Kt.useId=function(){return L.H.useId()},Kt.useImperativeHandle=function(E,le,ue){return L.H.useImperativeHandle(E,le,ue)},Kt.useInsertionEffect=function(E,le){return L.H.useInsertionEffect(E,le)},Kt.useLayoutEffect=function(E,le){return L.H.useLayoutEffect(E,le)},Kt.useMemo=function(E,le){return L.H.useMemo(E,le)},Kt.useOptimistic=function(E,le){return L.H.useOptimistic(E,le)},Kt.useReducer=function(E,le,ue){return L.H.useReducer(E,le,ue)},Kt.useRef=function(E){return L.H.useRef(E)},Kt.useState=function(E){return L.H.useState(E)},Kt.useSyncExternalStore=function(E,le,ue){return L.H.useSyncExternalStore(E,le,ue)},Kt.useTransition=function(){return L.H.useTransition()},Kt.version="19.1.0",Kt}var uS;function K1(){return uS||(uS=1,Lv.exports=eP()),Lv.exports}var w=K1();const jn=Ud(w),dS=KA({__proto__:null,default:jn},[w]);var Fv={exports:{}},wm={},$v={exports:{}},zv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fS;function tP(){return fS||(fS=1,function(e){function n(V,se){var re=V.length;V.push(se);e:for(;0<re;){var oe=re-1>>>1,E=V[oe];if(0<a(E,se))V[oe]=se,V[re]=E,re=oe;else break e}}function t(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var se=V[0],re=V.pop();if(re!==se){V[0]=re;e:for(var oe=0,E=V.length,le=E>>>1;oe<le;){var ue=2*(oe+1)-1,D=V[ue],ce=ue+1,ve=V[ce];if(0>a(D,re))ce<E&&0>a(ve,D)?(V[oe]=ve,V[ce]=re,oe=ce):(V[oe]=D,V[ue]=re,oe=ue);else if(ce<E&&0>a(ve,re))V[oe]=ve,V[ce]=re,oe=ce;else break e}}return se}function a(V,se){var re=V.sortIndex-se.sortIndex;return re!==0?re:V.id-se.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,d=l.now();e.unstable_now=function(){return l.now()-d}}var f=[],u=[],p=1,g=null,b=3,v=!1,S=!1,k=!1,T=!1,P=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function U(V){for(var se=t(u);se!==null;){if(se.callback===null)r(u);else if(se.startTime<=V)r(u),se.sortIndex=se.expirationTime,n(f,se);else break;se=t(u)}}function L(V){if(k=!1,U(V),!S)if(t(f)!==null)S=!0,$||($=!0,G());else{var se=t(u);se!==null&&W(L,se.startTime-V)}}var $=!1,z=-1,F=5,Y=-1;function R(){return T?!0:!(e.unstable_now()-Y<F)}function B(){if(T=!1,$){var V=e.unstable_now();Y=V;var se=!0;try{e:{S=!1,k&&(k=!1,M(z),z=-1),v=!0;var re=b;try{t:{for(U(V),g=t(f);g!==null&&!(g.expirationTime>V&&R());){var oe=g.callback;if(typeof oe=="function"){g.callback=null,b=g.priorityLevel;var E=oe(g.expirationTime<=V);if(V=e.unstable_now(),typeof E=="function"){g.callback=E,U(V),se=!0;break t}g===t(f)&&r(f),U(V)}else r(f);g=t(f)}if(g!==null)se=!0;else{var le=t(u);le!==null&&W(L,le.startTime-V),se=!1}}break e}finally{g=null,b=re,v=!1}se=void 0}}finally{se?G():$=!1}}}var G;if(typeof I=="function")G=function(){I(B)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,te=ie.port2;ie.port1.onmessage=B,G=function(){te.postMessage(null)}}else G=function(){P(B,0)};function W(V,se){z=P(function(){V(e.unstable_now())},se)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(V){switch(b){case 1:case 2:case 3:var se=3;break;default:se=b}var re=b;b=se;try{return V()}finally{b=re}},e.unstable_requestPaint=function(){T=!0},e.unstable_runWithPriority=function(V,se){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var re=b;b=V;try{return se()}finally{b=re}},e.unstable_scheduleCallback=function(V,se,re){var oe=e.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?oe+re:oe):re=oe,V){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=re+E,V={id:p++,callback:se,priorityLevel:V,startTime:re,expirationTime:E,sortIndex:-1},re>oe?(V.sortIndex=re,n(u,V),t(f)===null&&V===t(u)&&(k?(M(z),z=-1):k=!0,W(L,re-oe))):(V.sortIndex=E,n(f,V),S||v||(S=!0,$||($=!0,G()))),V},e.unstable_shouldYield=R,e.unstable_wrapCallback=function(V){var se=b;return function(){var re=b;b=se;try{return V.apply(this,arguments)}finally{b=re}}}}(zv)),zv}var hS;function nP(){return hS||(hS=1,$v.exports=tP()),$v.exports}var Uv={exports:{}},wi={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pS;function rP(){if(pS)return wi;pS=1;var e=K1();function n(f){var u="https://react.dev/errors/"+f;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+f+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(n(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(f,u,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:g==null?null:""+g,children:f,containerInfo:u,implementation:p}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,u){if(f==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return wi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,wi.createPortal=function(f,u){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(n(299));return o(f,u,null,p)},wi.flushSync=function(f){var u=l.T,p=r.p;try{if(l.T=null,r.p=2,f)return f()}finally{l.T=u,r.p=p,r.d.f()}},wi.preconnect=function(f,u){typeof f=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,r.d.C(f,u))},wi.prefetchDNS=function(f){typeof f=="string"&&r.d.D(f)},wi.preinit=function(f,u){if(typeof f=="string"&&u&&typeof u.as=="string"){var p=u.as,g=d(p,u.crossOrigin),b=typeof u.integrity=="string"?u.integrity:void 0,v=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;p==="style"?r.d.S(f,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:g,integrity:b,fetchPriority:v}):p==="script"&&r.d.X(f,{crossOrigin:g,integrity:b,fetchPriority:v,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},wi.preinitModule=function(f,u){if(typeof f=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var p=d(u.as,u.crossOrigin);r.d.M(f,{crossOrigin:p,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&r.d.M(f)},wi.preload=function(f,u){if(typeof f=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var p=u.as,g=d(p,u.crossOrigin);r.d.L(f,p,{crossOrigin:g,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},wi.preloadModule=function(f,u){if(typeof f=="string")if(u){var p=d(u.as,u.crossOrigin);r.d.m(f,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:p,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else r.d.m(f)},wi.requestFormReset=function(f){r.d.r(f)},wi.unstable_batchedUpdates=function(f,u){return f(u)},wi.useFormState=function(f,u,p){return l.H.useFormState(f,u,p)},wi.useFormStatus=function(){return l.H.useHostTransitionStatus()},wi.version="19.1.0",wi}var mS;function I_(){if(mS)return Uv.exports;mS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),Uv.exports=rP(),Uv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gS;function iP(){if(gS)return wm;gS=1;var e=nP(),n=K1(),t=I_();function r(s){var c="https://react.dev/errors/"+s;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+s+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var c=s,h=s;if(s.alternate)for(;c.return;)c=c.return;else{s=c;do c=s,(c.flags&4098)!==0&&(h=c.return),s=c.return;while(s)}return c.tag===3?h:null}function l(s){if(s.tag===13){var c=s.memoizedState;if(c===null&&(s=s.alternate,s!==null&&(c=s.memoizedState)),c!==null)return c.dehydrated}return null}function d(s){if(o(s)!==s)throw Error(r(188))}function f(s){var c=s.alternate;if(!c){if(c=o(s),c===null)throw Error(r(188));return c!==s?null:s}for(var h=s,x=c;;){var N=h.return;if(N===null)break;var A=N.alternate;if(A===null){if(x=N.return,x!==null){h=x;continue}break}if(N.child===A.child){for(A=N.child;A;){if(A===h)return d(N),s;if(A===x)return d(N),c;A=A.sibling}throw Error(r(188))}if(h.return!==x.return)h=N,x=A;else{for(var q=!1,K=N.child;K;){if(K===h){q=!0,h=N,x=A;break}if(K===x){q=!0,x=N,h=A;break}K=K.sibling}if(!q){for(K=A.child;K;){if(K===h){q=!0,h=A,x=N;break}if(K===x){q=!0,x=A,h=N;break}K=K.sibling}if(!q)throw Error(r(189))}}if(h.alternate!==x)throw Error(r(190))}if(h.tag!==3)throw Error(r(188));return h.stateNode.current===h?s:c}function u(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s;for(s=s.child;s!==null;){if(c=u(s),c!==null)return c;s=s.sibling}return null}var p=Object.assign,g=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),M=Symbol.for("react.consumer"),I=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),$=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),Y=Symbol.for("react.activity"),R=Symbol.for("react.memo_cache_sentinel"),B=Symbol.iterator;function G(s){return s===null||typeof s!="object"?null:(s=B&&s[B]||s["@@iterator"],typeof s=="function"?s:null)}var ie=Symbol.for("react.client.reference");function te(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===ie?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case S:return"Fragment";case T:return"Profiler";case k:return"StrictMode";case L:return"Suspense";case $:return"SuspenseList";case Y:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case v:return"Portal";case I:return(s.displayName||"Context")+".Provider";case M:return(s._context.displayName||"Context")+".Consumer";case U:var c=s.render;return s=s.displayName,s||(s=c.displayName||c.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case z:return c=s.displayName||null,c!==null?c:te(s.type)||"Memo";case F:c=s._payload,s=s._init;try{return te(s(c))}catch{}}return null}var W=Array.isArray,V=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re={pending:!1,data:null,method:null,action:null},oe=[],E=-1;function le(s){return{current:s}}function ue(s){0>E||(s.current=oe[E],oe[E]=null,E--)}function D(s,c){E++,oe[E]=s.current,s.current=c}var ce=le(null),ve=le(null),X=le(null),fe=le(null);function ae(s,c){switch(D(X,c),D(ve,s),D(ce,null),c.nodeType){case 9:case 11:s=(s=c.documentElement)&&(s=s.namespaceURI)?rr(s):0;break;default:if(s=c.tagName,c=c.namespaceURI)c=rr(c),s=or(c,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ue(ce),D(ce,s)}function Me(){ue(ce),ue(ve),ue(X)}function Ke(s){s.memoizedState!==null&&D(fe,s);var c=ce.current,h=or(c,s.type);c!==h&&(D(ve,s),D(ce,h))}function Z(s){ve.current===s&&(ue(ce),ue(ve)),fe.current===s&&(ue(fe),Zc._currentValue=re)}var Ee=Object.prototype.hasOwnProperty,Ie=e.unstable_scheduleCallback,Fe=e.unstable_cancelCallback,rt=e.unstable_shouldYield,lt=e.unstable_requestPaint,ct=e.unstable_now,st=e.unstable_getCurrentPriorityLevel,Ht=e.unstable_ImmediatePriority,rn=e.unstable_UserBlockingPriority,je=e.unstable_NormalPriority,qe=e.unstable_LowPriority,Be=e.unstable_IdlePriority,ke=e.log,we=e.unstable_setDisableYieldValue,Q=null,me=null;function Ve(s){if(typeof ke=="function"&&we(s),me&&typeof me.setStrictMode=="function")try{me.setStrictMode(Q,s)}catch{}}var Qe=Math.clz32?Math.clz32:qt,ot=Math.log,kt=Math.LN2;function qt(s){return s>>>=0,s===0?32:31-(ot(s)/kt|0)|0}var be=256,ge=4194304;function Te(s){var c=s&42;if(c!==0)return c;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function De(s,c,h){var x=s.pendingLanes;if(x===0)return 0;var N=0,A=s.suspendedLanes,q=s.pingedLanes;s=s.warmLanes;var K=x&134217727;return K!==0?(x=K&~A,x!==0?N=Te(x):(q&=K,q!==0?N=Te(q):h||(h=K&~s,h!==0&&(N=Te(h))))):(K=x&~A,K!==0?N=Te(K):q!==0?N=Te(q):h||(h=x&~s,h!==0&&(N=Te(h)))),N===0?0:c!==0&&c!==N&&(c&A)===0&&(A=N&-N,h=c&-c,A>=h||A===32&&(h&4194048)!==0)?c:N}function ze(s,c){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&c)===0}function nt(s,c){switch(s){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mt(){var s=be;return be<<=1,(be&4194048)===0&&(be=256),s}function Nt(){var s=ge;return ge<<=1,(ge&62914560)===0&&(ge=4194304),s}function cn(s){for(var c=[],h=0;31>h;h++)c.push(s);return c}function gn(s,c){s.pendingLanes|=c,c!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Cn(s,c,h,x,N,A){var q=s.pendingLanes;s.pendingLanes=h,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=h,s.entangledLanes&=h,s.errorRecoveryDisabledLanes&=h,s.shellSuspendCounter=0;var K=s.entanglements,xe=s.expirationTimes,Oe=s.hiddenUpdates;for(h=q&~h;0<h;){var We=31-Qe(h),Ze=1<<We;K[We]=0,xe[We]=-1;var $e=Oe[We];if($e!==null)for(Oe[We]=null,We=0;We<$e.length;We++){var Le=$e[We];Le!==null&&(Le.lane&=-536870913)}h&=~Ze}x!==0&&bt(s,x,0),A!==0&&N===0&&s.tag!==0&&(s.suspendedLanes|=A&~(q&~c))}function bt(s,c,h){s.pendingLanes|=c,s.suspendedLanes&=~c;var x=31-Qe(c);s.entangledLanes|=c,s.entanglements[x]=s.entanglements[x]|1073741824|h&4194090}function yt(s,c){var h=s.entangledLanes|=c;for(s=s.entanglements;h;){var x=31-Qe(h),N=1<<x;N&c|s[x]&c&&(s[x]|=c),h&=~N}}function Ot(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function vt(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Wn(){var s=se.p;return s!==0?s:(s=window.event,s===void 0?32:tx(s.type))}function Hi(s,c){var h=se.p;try{return se.p=s,c()}finally{se.p=h}}var br=Math.random().toString(36).slice(2),yn="__reactFiber$"+br,vr="__reactProps$"+br,Ti="__reactContainer$"+br,xu="__reactEvents$"+br,bu="__reactListeners$"+br,Qh="__reactHandles$"+br,el="__reactResources$"+br,Qs="__reactMarker$"+br;function Zl(s){delete s[yn],delete s[vr],delete s[xu],delete s[bu],delete s[Qh]}function hs(s){var c=s[yn];if(c)return c;for(var h=s.parentNode;h;){if(c=h[Ti]||h[yn]){if(h=c.alternate,c.child!==null||h!==null&&h.child!==null)for(s=qy(s);s!==null;){if(h=s[yn])return h;s=qy(s)}return c}s=h,h=s.parentNode}return null}function Js(s){if(s=s[yn]||s[Ti]){var c=s.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return s}return null}function Ks(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s.stateNode;throw Error(r(33))}function Xs(s){var c=s[el];return c||(c=s[el]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function mr(s){s[Qs]=!0}var Vd=new Set,Hd={};function ps(s,c){Zs(s,c),Zs(s+"Capture",c)}function Zs(s,c){for(Hd[s]=c,s=0;s<c.length;s++)Vd.add(c[s])}var ec=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Gd={},ms={};function Gi(s){return Ee.call(ms,s)?!0:Ee.call(Gd,s)?!1:ec.test(s)?ms[s]=!0:(Gd[s]=!0,!1)}function Fa(s,c,h){if(Gi(c))if(h===null)s.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":s.removeAttribute(c);return;case"boolean":var x=c.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){s.removeAttribute(c);return}}s.setAttribute(c,""+h)}}function tl(s,c,h){if(h===null)s.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttribute(c,""+h)}}function Ei(s,c,h,x){if(x===null)s.removeAttribute(h);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(h);return}s.setAttributeNS(c,h,""+x)}}var nl,rl;function $a(s){if(nl===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);nl=c&&c[1]||"",rl=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+nl+s+rl}var tc=!1;function nc(s,c){if(!s||tc)return"";tc=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(c){var Ze=function(){throw Error()};if(Object.defineProperty(Ze.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ze,[])}catch(Le){var $e=Le}Reflect.construct(s,[],Ze)}else{try{Ze.call()}catch(Le){$e=Le}s.call(Ze.prototype)}}else{try{throw Error()}catch(Le){$e=Le}(Ze=s())&&typeof Ze.catch=="function"&&Ze.catch(function(){})}}catch(Le){if(Le&&$e&&typeof Le.stack=="string")return[Le.stack,$e.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=x.DetermineComponentFrameRoot(),q=A[0],K=A[1];if(q&&K){var xe=q.split(`
`),Oe=K.split(`
`);for(N=x=0;x<xe.length&&!xe[x].includes("DetermineComponentFrameRoot");)x++;for(;N<Oe.length&&!Oe[N].includes("DetermineComponentFrameRoot");)N++;if(x===xe.length||N===Oe.length)for(x=xe.length-1,N=Oe.length-1;1<=x&&0<=N&&xe[x]!==Oe[N];)N--;for(;1<=x&&0<=N;x--,N--)if(xe[x]!==Oe[N]){if(x!==1||N!==1)do if(x--,N--,0>N||xe[x]!==Oe[N]){var We=`
`+xe[x].replace(" at new "," at ");return s.displayName&&We.includes("<anonymous>")&&(We=We.replace("<anonymous>",s.displayName)),We}while(1<=x&&0<=N);break}}}finally{tc=!1,Error.prepareStackTrace=h}return(h=s?s.displayName||s.name:"")?$a(h):""}function rc(s){switch(s.tag){case 26:case 27:case 5:return $a(s.type);case 16:return $a("Lazy");case 13:return $a("Suspense");case 19:return $a("SuspenseList");case 0:case 15:return nc(s.type,!1);case 11:return nc(s.type.render,!1);case 1:return nc(s.type,!0);case 31:return $a("Activity");default:return""}}function vu(s){try{var c="";do c+=rc(s),s=s.return;while(s);return c}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}function Wr(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function ic(s){var c=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function ac(s){var c=ic(s)?"checked":"value",h=Object.getOwnPropertyDescriptor(s.constructor.prototype,c),x=""+s[c];if(!s.hasOwnProperty(c)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var N=h.get,A=h.set;return Object.defineProperty(s,c,{configurable:!0,get:function(){return N.call(this)},set:function(q){x=""+q,A.call(this,q)}}),Object.defineProperty(s,c,{enumerable:h.enumerable}),{getValue:function(){return x},setValue:function(q){x=""+q},stopTracking:function(){s._valueTracker=null,delete s[c]}}}}function il(s){s._valueTracker||(s._valueTracker=ac(s))}function eo(s){if(!s)return!1;var c=s._valueTracker;if(!c)return!0;var h=c.getValue(),x="";return s&&(x=ic(s)?s.checked?"true":"false":s.value),s=x,s!==h?(c.setValue(s),!0):!1}function za(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var sc=/[\n"\\]/g;function Qr(s){return s.replace(sc,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function to(s,c,h,x,N,A,q,K){s.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?s.type=q:s.removeAttribute("type"),c!=null?q==="number"?(c===0&&s.value===""||s.value!=c)&&(s.value=""+Wr(c)):s.value!==""+Wr(c)&&(s.value=""+Wr(c)):q!=="submit"&&q!=="reset"||s.removeAttribute("value"),c!=null?gs(s,q,Wr(c)):h!=null?gs(s,q,Wr(h)):x!=null&&s.removeAttribute("value"),N==null&&A!=null&&(s.defaultChecked=!!A),N!=null&&(s.checked=N&&typeof N!="function"&&typeof N!="symbol"),K!=null&&typeof K!="function"&&typeof K!="symbol"&&typeof K!="boolean"?s.name=""+Wr(K):s.removeAttribute("name")}function oc(s,c,h,x,N,A,q,K){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(s.type=A),c!=null||h!=null){if(!(A!=="submit"&&A!=="reset"||c!=null))return;h=h!=null?""+Wr(h):"",c=c!=null?""+Wr(c):h,K||c===s.value||(s.value=c),s.defaultValue=c}x=x??N,x=typeof x!="function"&&typeof x!="symbol"&&!!x,s.checked=K?s.checked:!!x,s.defaultChecked=!!x,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(s.name=q)}function gs(s,c,h){c==="number"&&za(s.ownerDocument)===s||s.defaultValue===""+h||(s.defaultValue=""+h)}function ys(s,c,h,x){if(s=s.options,c){c={};for(var N=0;N<h.length;N++)c["$"+h[N]]=!0;for(h=0;h<s.length;h++)N=c.hasOwnProperty("$"+s[h].value),s[h].selected!==N&&(s[h].selected=N),N&&x&&(s[h].defaultSelected=!0)}else{for(h=""+Wr(h),c=null,N=0;N<s.length;N++){if(s[N].value===h){s[N].selected=!0,x&&(s[N].defaultSelected=!0);return}c!==null||s[N].disabled||(c=s[N])}c!==null&&(c.selected=!0)}}function al(s,c,h){if(c!=null&&(c=""+Wr(c),c!==s.value&&(s.value=c),h==null)){s.defaultValue!==c&&(s.defaultValue=c);return}s.defaultValue=h!=null?""+Wr(h):""}function sl(s,c,h,x){if(c==null){if(x!=null){if(h!=null)throw Error(r(92));if(W(x)){if(1<x.length)throw Error(r(93));x=x[0]}h=x}h==null&&(h=""),c=h}h=Wr(c),s.defaultValue=h,x=s.textContent,x===h&&x!==""&&x!==null&&(s.value=x)}function Ai(s,c){if(c){var h=s.firstChild;if(h&&h===s.lastChild&&h.nodeType===3){h.nodeValue=c;return}}s.textContent=c}var Yi=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function no(s,c,h){var x=c.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?x?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="":x?s.setProperty(c,h):typeof h!="number"||h===0||Yi.has(c)?c==="float"?s.cssFloat=h:s[c]=(""+h).trim():s[c]=h+"px"}function lc(s,c,h){if(c!=null&&typeof c!="object")throw Error(r(62));if(s=s.style,h!=null){for(var x in h)!h.hasOwnProperty(x)||c!=null&&c.hasOwnProperty(x)||(x.indexOf("--")===0?s.setProperty(x,""):x==="float"?s.cssFloat="":s[x]="");for(var N in c)x=c[N],c.hasOwnProperty(N)&&h[N]!==x&&no(s,N,x)}else for(var A in c)c.hasOwnProperty(A)&&no(s,A,c[A])}function ro(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),cc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function xs(s){return cc.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var io=null;function ol(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Ua=null,Ba=null;function ll(s){var c=Js(s);if(c&&(s=c.stateNode)){var h=s[vr]||null;e:switch(s=c.stateNode,c.type){case"input":if(to(s,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),c=h.name,h.type==="radio"&&c!=null){for(h=s;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+Qr(""+c)+'"][type="radio"]'),c=0;c<h.length;c++){var x=h[c];if(x!==s&&x.form===s.form){var N=x[vr]||null;if(!N)throw Error(r(90));to(x,N.value,N.defaultValue,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name)}}for(c=0;c<h.length;c++)x=h[c],x.form===s.form&&eo(x)}break e;case"textarea":al(s,h.value,h.defaultValue);break e;case"select":c=h.value,c!=null&&ys(s,!!h.multiple,c,!1)}}}var cl=!1;function uc(s,c,h){if(cl)return s(c,h);cl=!0;try{var x=s(c);return x}finally{if(cl=!1,(Ua!==null||Ba!==null)&&(Uf(),Ua&&(c=Ua,s=Ba,Ba=Ua=null,ll(c),s)))for(c=0;c<s.length;c++)ll(s[c])}}function Jr(s,c){var h=s.stateNode;if(h===null)return null;var x=h[vr]||null;if(x===null)return null;h=x[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(s=s.type,x=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!x;break e;default:s=!1}if(s)return null;if(h&&typeof h!="function")throw Error(r(231,c,typeof h));return h}var Pi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ao=!1;if(Pi)try{var Di={};Object.defineProperty(Di,"passive",{get:function(){ao=!0}}),window.addEventListener("test",Di,Di),window.removeEventListener("test",Di,Di)}catch{ao=!1}var qa=null,ul=null,dc=null;function fc(){if(dc)return dc;var s,c=ul,h=c.length,x,N="value"in qa?qa.value:qa.textContent,A=N.length;for(s=0;s<h&&c[s]===N[s];s++);var q=h-s;for(x=1;x<=q&&c[h-x]===N[A-x];x++);return dc=N.slice(s,1<x?1-x:void 0)}function xn(s){var c=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&c===13&&(s=13)):s=c,s===10&&(s=13),32<=s||s===13?s:0}function kn(){return!0}function dl(){return!1}function Fr(s){function c(h,x,N,A,q){this._reactName=h,this._targetInst=N,this.type=x,this.nativeEvent=A,this.target=q,this.currentTarget=null;for(var K in s)s.hasOwnProperty(K)&&(h=s[K],this[K]=h?h(A):A[K]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?kn:dl,this.isPropagationStopped=dl,this}return p(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=kn)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=kn)},persist:function(){},isPersistent:kn}),c}var ya={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fl=Fr(ya),so=p({},ya,{view:0,detail:0}),Wd=Fr(so),oo,hc,qn,xa=p({},so,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xr,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==qn&&(qn&&s.type==="mousemove"?(oo=s.screenX-qn.screenX,hc=s.screenY-qn.screenY):hc=oo=0,qn=s),oo)},movementY:function(s){return"movementY"in s?s.movementY:hc}}),Va=Fr(xa),pc=p({},xa,{dataTransfer:0}),hl=Fr(pc),Kr=p({},so,{relatedTarget:0}),wn=Fr(Kr),mc=p({},ya,{animationName:0,elapsedTime:0,pseudoElement:0}),pl=Fr(mc),gc=p({},ya,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),lo=Fr(gc),co=p({},ya,{data:0}),Ur=Fr(co),Qd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yc(s){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(s):(s=Jd[s])?!!c[s]:!1}function Xr(){return yc}var ba=p({},so,{key:function(s){if(s.key){var c=Qd[s.key]||s.key;if(c!=="Unidentified")return c}return s.type==="keypress"?(s=xn(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?wr[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xr,charCode:function(s){return s.type==="keypress"?xn(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?xn(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),xc=Fr(ba),Vn=p({},xa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wi=Fr(Vn),bs=p({},so,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xr}),Jh=Fr(bs),Ha=p({},ya,{propertyName:0,elapsedTime:0,pseudoElement:0}),Kh=Fr(Ha),Kd=p({},xa,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),uo=Fr(Kd),vs=p({},ya,{newState:0,oldState:0}),Ga=Fr(vs),fo=[9,13,27,32],ml=Pi&&"CompositionEvent"in window,ws=null;Pi&&"documentMode"in document&&(ws=document.documentMode);var gl=Pi&&"TextEvent"in window&&!ws,yl=Pi&&(!ml||ws&&8<ws&&11>=ws),bc=" ",wu=!1;function Xd(s,c){switch(s){case"keyup":return fo.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vc(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Ya=!1;function Xh(s,c){switch(s){case"compositionend":return vc(c);case"keypress":return c.which!==32?null:(wu=!0,bc);case"textInput":return s=c.data,s===bc&&wu?null:s;default:return null}}function Zd(s,c){if(Ya)return s==="compositionend"||!ml&&Xd(s,c)?(s=fc(),dc=ul=qa=null,Ya=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return yl&&c.locale!=="ko"?null:c.data;default:return null}}var Zr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xl(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c==="input"?!!Zr[s.type]:c==="textarea"}function ho(s,c,h,x){Ua?Ba?Ba.push(x):Ba=[x]:Ua=x,c=Wf(c,"onChange"),0<c.length&&(h=new fl("onChange","change",null,h,x),s.push({event:h,listeners:c}))}var va=null,po=null;function Wa(s){My(s,0)}function Ii(s){var c=Ks(s);if(eo(c))return s}function Qi(s,c){if(s==="change")return c}var Su=!1;if(Pi){var wc;if(Pi){var wa="oninput"in document;if(!wa){var Nu=document.createElement("div");Nu.setAttribute("oninput","return;"),wa=typeof Nu.oninput=="function"}wc=wa}else wc=!1;Su=wc&&(!document.documentMode||9<document.documentMode)}function mo(){va&&(va.detachEvent("onpropertychange",bl),po=va=null)}function bl(s){if(s.propertyName==="value"&&Ii(po)){var c=[];ho(c,po,s,ol(s)),uc(Wa,c)}}function Cu(s,c,h){s==="focusin"?(mo(),va=c,po=h,va.attachEvent("onpropertychange",bl)):s==="focusout"&&mo()}function Qa(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Ii(po)}function vl(s,c){if(s==="click")return Ii(c)}function Zh(s,c){if(s==="input"||s==="change")return Ii(c)}function ep(s,c){return s===c&&(s!==0||1/s===1/c)||s!==s&&c!==c}var ei=typeof Object.is=="function"?Object.is:ep;function Ji(s,c){if(ei(s,c))return!0;if(typeof s!="object"||s===null||typeof c!="object"||c===null)return!1;var h=Object.keys(s),x=Object.keys(c);if(h.length!==x.length)return!1;for(x=0;x<h.length;x++){var N=h[x];if(!Ee.call(c,N)||!ei(s[N],c[N]))return!1}return!0}function ci(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function ju(s,c){var h=ci(s);s=0;for(var x;h;){if(h.nodeType===3){if(x=s+h.textContent.length,s<=c&&x>=c)return{node:h,offset:c-s};s=x}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=ci(h)}}function Ss(s,c){return s&&c?s===c?!0:s&&s.nodeType===3?!1:c&&c.nodeType===3?Ss(s,c.parentNode):"contains"in s?s.contains(c):s.compareDocumentPosition?!!(s.compareDocumentPosition(c)&16):!1:!1}function ef(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var c=za(s.document);c instanceof s.HTMLIFrameElement;){try{var h=typeof c.contentWindow.location.href=="string"}catch{h=!1}if(h)s=c.contentWindow;else break;c=za(s.document)}return c}function wl(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c&&(c==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||c==="textarea"||s.contentEditable==="true")}var tp=Pi&&"documentMode"in document&&11>=document.documentMode,Ja=null,Ka=null,_e=null,Ge=!1;function Ue(s,c,h){var x=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Ge||Ja==null||Ja!==za(x)||(x=Ja,"selectionStart"in x&&wl(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),_e&&Ji(_e,x)||(_e=x,x=Wf(Ka,"onSelect"),0<x.length&&(c=new fl("onSelect","select",null,c,h),s.push({event:c,listeners:x}),c.target=Ja)))}function ft(s,c){var h={};return h[s.toLowerCase()]=c.toLowerCase(),h["Webkit"+s]="webkit"+c,h["Moz"+s]="moz"+c,h}var At={animationend:ft("Animation","AnimationEnd"),animationiteration:ft("Animation","AnimationIteration"),animationstart:ft("Animation","AnimationStart"),transitionrun:ft("Transition","TransitionRun"),transitionstart:ft("Transition","TransitionStart"),transitioncancel:ft("Transition","TransitionCancel"),transitionend:ft("Transition","TransitionEnd")},un={},lr={};Pi&&(lr=document.createElement("div").style,"AnimationEvent"in window||(delete At.animationend.animation,delete At.animationiteration.animation,delete At.animationstart.animation),"TransitionEvent"in window||delete At.transitionend.transition);function dn(s){if(un[s])return un[s];if(!At[s])return s;var c=At[s],h;for(h in c)if(c.hasOwnProperty(h)&&h in lr)return un[s]=c[h];return s}var Sc=dn("animationend"),tf=dn("animationiteration"),ti=dn("animationstart"),Nc=dn("transitionrun"),np=dn("transitionstart"),Ns=dn("transitioncancel"),go=dn("transitionend"),yo=new Map,ee="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ee.push("scrollEnd");function he(s,c){yo.set(s,c),ps(c,[s])}var de=new WeakMap;function Se(s,c){if(typeof s=="object"&&s!==null){var h=de.get(s);return h!==void 0?h:(c={value:s,source:c,stack:vu(c)},de.set(s,c),c)}return{value:s,source:c,stack:vu(c)}}var Ye=[],ut=0,Ct=0;function St(){for(var s=ut,c=Ct=ut=0;c<s;){var h=Ye[c];Ye[c++]=null;var x=Ye[c];Ye[c++]=null;var N=Ye[c];Ye[c++]=null;var A=Ye[c];if(Ye[c++]=null,x!==null&&N!==null){var q=x.pending;q===null?N.next=N:(N.next=q.next,q.next=N),x.pending=N}A!==0&&_u(h,N,A)}}function Hn(s,c,h,x){Ye[ut++]=s,Ye[ut++]=c,Ye[ut++]=h,Ye[ut++]=x,Ct|=x,s.lanes|=x,s=s.alternate,s!==null&&(s.lanes|=x)}function Br(s,c,h,x){return Hn(s,c,h,x),ku(s)}function Cs(s,c){return Hn(s,null,null,c),ku(s)}function _u(s,c,h){s.lanes|=h;var x=s.alternate;x!==null&&(x.lanes|=h);for(var N=!1,A=s.return;A!==null;)A.childLanes|=h,x=A.alternate,x!==null&&(x.childLanes|=h),A.tag===22&&(s=A.stateNode,s===null||s._visibility&1||(N=!0)),s=A,A=A.return;return s.tag===3?(A=s.stateNode,N&&c!==null&&(N=31-Qe(h),s=A.hiddenUpdates,x=s[N],x===null?s[N]=[c]:x.push(c),c.lane=h|536870912),A):null}function ku(s){if(50<Hc)throw Hc=0,Jp=null,Error(r(185));for(var c=s.return;c!==null;)s=c,c=s.return;return s.tag===3?s.stateNode:null}var Sl={};function nf(s,c,h,x){this.tag=s,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ui(s,c,h,x){return new nf(s,c,h,x)}function Nl(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ni(s,c){var h=s.alternate;return h===null?(h=ui(s.tag,c,s.key,s.mode),h.elementType=s.elementType,h.type=s.type,h.stateNode=s.stateNode,h.alternate=s,s.alternate=h):(h.pendingProps=c,h.type=s.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=s.flags&65011712,h.childLanes=s.childLanes,h.lanes=s.lanes,h.child=s.child,h.memoizedProps=s.memoizedProps,h.memoizedState=s.memoizedState,h.updateQueue=s.updateQueue,c=s.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=s.sibling,h.index=s.index,h.ref=s.ref,h.refCleanup=s.refCleanup,h}function Tu(s,c){s.flags&=65011714;var h=s.alternate;return h===null?(s.childLanes=0,s.lanes=c,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=h.childLanes,s.lanes=h.lanes,s.child=h.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=h.memoizedProps,s.memoizedState=h.memoizedState,s.updateQueue=h.updateQueue,s.type=h.type,c=h.dependencies,s.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),s}function rf(s,c,h,x,N,A){var q=0;if(x=s,typeof s=="function")Nl(s)&&(q=1);else if(typeof s=="string")q=Sv(s,h,ce.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case Y:return s=ui(31,h,c,N),s.elementType=Y,s.lanes=A,s;case S:return Cl(h.children,N,A,c);case k:q=8,N|=24;break;case T:return s=ui(12,h,c,N|2),s.elementType=T,s.lanes=A,s;case L:return s=ui(13,h,c,N),s.elementType=L,s.lanes=A,s;case $:return s=ui(19,h,c,N),s.elementType=$,s.lanes=A,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case P:case I:q=10;break e;case M:q=9;break e;case U:q=11;break e;case z:q=14;break e;case F:q=16,x=null;break e}q=29,h=Error(r(130,s===null?"null":typeof s,"")),x=null}return c=ui(q,h,c,N),c.elementType=s,c.type=x,c.lanes=A,c}function Cl(s,c,h,x){return s=ui(7,s,x,c),s.lanes=h,s}function rp(s,c,h){return s=ui(6,s,null,c),s.lanes=h,s}function Cc(s,c,h){return c=ui(4,s.children!==null?s.children:[],s.key,c),c.lanes=h,c.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},c}var js=[],xo=0,af=null,Eu=0,Ki=[],Xi=0,Qn=null,er=1,_s="";function jl(s,c){js[xo++]=Eu,js[xo++]=af,af=s,Eu=c}function ip(s,c,h){Ki[Xi++]=er,Ki[Xi++]=_s,Ki[Xi++]=Qn,Qn=s;var x=er;s=_s;var N=32-Qe(x)-1;x&=~(1<<N),h+=1;var A=32-Qe(c)+N;if(30<A){var q=N-N%5;A=(x&(1<<q)-1).toString(32),x>>=q,N-=q,er=1<<32-Qe(c)+N|h<<N|x,_s=A+s}else er=1<<A|h<<N|x,_s=s}function ap(s){s.return!==null&&(jl(s,1),ip(s,1,0))}function Au(s){for(;s===af;)af=js[--xo],js[xo]=null,Eu=js[--xo],js[xo]=null;for(;s===Qn;)Qn=Ki[--Xi],Ki[Xi]=null,_s=Ki[--Xi],Ki[Xi]=null,er=Ki[--Xi],Ki[Xi]=null}var Sr=null,tr=null,on=!1,Sa=null,di=!1,jc=Error(r(519));function Zi(s){var c=Error(r(418,""));throw bo(Se(c,s)),jc}function mg(s){var c=s.stateNode,h=s.type,x=s.memoizedProps;switch(c[yn]=s,c[vr]=x,h){case"dialog":sn("cancel",c),sn("close",c);break;case"iframe":case"object":case"embed":sn("load",c);break;case"video":case"audio":for(h=0;h<xd.length;h++)sn(xd[h],c);break;case"source":sn("error",c);break;case"img":case"image":case"link":sn("error",c),sn("load",c);break;case"details":sn("toggle",c);break;case"input":sn("invalid",c),oc(c,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),il(c);break;case"select":sn("invalid",c);break;case"textarea":sn("invalid",c),sl(c,x.value,x.defaultValue,x.children),il(c)}h=x.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||c.textContent===""+h||x.suppressHydrationWarning===!0||Fy(c.textContent,h)?(x.popover!=null&&(sn("beforetoggle",c),sn("toggle",c)),x.onScroll!=null&&sn("scroll",c),x.onScrollEnd!=null&&sn("scrollend",c),x.onClick!=null&&(c.onclick=Qf),c=!0):c=!1,c||Zi(s)}function gg(s){for(Sr=s.return;Sr;)switch(Sr.tag){case 5:case 13:di=!1;return;case 27:case 3:di=!0;return;default:Sr=Sr.return}}function Pu(s){if(s!==Sr)return!1;if(!on)return gg(s),on=!0,!1;var c=s.tag,h;if((h=c!==3&&c!==27)&&((h=c===5)&&(h=s.type,h=!(h!=="form"&&h!=="button")||Kf(s.type,s.memoizedProps)),h=!h),h&&tr&&Zi(s),gg(s),c===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,c=0;s;){if(s.nodeType===8)if(h=s.data,h==="/$"){if(c===0){tr=Ta(s.nextSibling);break e}c--}else h!=="$"&&h!=="$!"&&h!=="$?"||c++;s=s.nextSibling}tr=null}}else c===27?(c=tr,aa(s.type)?(s=um,um=null,tr=s):tr=c):tr=Sr?Ta(s.stateNode.nextSibling):null;return!0}function Du(){tr=Sr=null,on=!1}function yg(){var s=Sa;return s!==null&&(bi===null?bi=s:bi.push.apply(bi,s),Sa=null),s}function bo(s){Sa===null?Sa=[s]:Sa.push(s)}var _l=le(null),vo=null,J=null;function Ri(s,c,h){D(_l,c._currentValue),c._currentValue=h}function ea(s){s._currentValue=_l.current,ue(_l)}function fi(s,c,h){for(;s!==null;){var x=s.alternate;if((s.childLanes&c)!==c?(s.childLanes|=c,x!==null&&(x.childLanes|=c)):x!==null&&(x.childLanes&c)!==c&&(x.childLanes|=c),s===h)break;s=s.return}}function Zt(s,c,h,x){var N=s.child;for(N!==null&&(N.return=s);N!==null;){var A=N.dependencies;if(A!==null){var q=N.child;A=A.firstContext;e:for(;A!==null;){var K=A;A=N;for(var xe=0;xe<c.length;xe++)if(K.context===c[xe]){A.lanes|=h,K=A.alternate,K!==null&&(K.lanes|=h),fi(A.return,h,s),x||(q=null);break e}A=K.next}}else if(N.tag===18){if(q=N.return,q===null)throw Error(r(341));q.lanes|=h,A=q.alternate,A!==null&&(A.lanes|=h),fi(q,h,s),q=null}else q=N.child;if(q!==null)q.return=N;else for(q=N;q!==null;){if(q===s){q=null;break}if(N=q.sibling,N!==null){N.return=q.return,q=N;break}q=q.return}N=q}}function Iu(s,c,h,x){s=null;for(var N=c,A=!1;N!==null;){if(!A){if((N.flags&524288)!==0)A=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var q=N.alternate;if(q===null)throw Error(r(387));if(q=q.memoizedProps,q!==null){var K=N.type;ei(N.pendingProps.value,q.value)||(s!==null?s.push(K):s=[K])}}else if(N===fe.current){if(q=N.alternate,q===null)throw Error(r(387));q.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(s!==null?s.push(Zc):s=[Zc])}N=N.return}s!==null&&Zt(c,s,h,x),c.flags|=262144}function sf(s){for(s=s.firstContext;s!==null;){if(!ei(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function kl(s){vo=s,J=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function cr(s){return xg(vo,s)}function of(s,c){return vo===null&&kl(s),xg(s,c)}function xg(s,c){var h=c._currentValue;if(c={context:c,memoizedValue:h,next:null},J===null){if(s===null)throw Error(r(308));J=c,s.dependencies={lanes:0,firstContext:c},s.flags|=524288}else J=J.next=c;return h}var Gb=typeof AbortController<"u"?AbortController:function(){var s=[],c=this.signal={aborted:!1,addEventListener:function(h,x){s.push(x)}};this.abort=function(){c.aborted=!0,s.forEach(function(h){return h()})}},Yb=e.unstable_scheduleCallback,Wb=e.unstable_NormalPriority,$n={$$typeof:I,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function sp(){return{controller:new Gb,data:new Map,refCount:0}}function Ru(s){s.refCount--,s.refCount===0&&Yb(Wb,function(){s.controller.abort()})}var Mu=null,op=0,_c=0,hi=null;function Qb(s,c){if(Mu===null){var h=Mu=[];op=0,_c=Yf(),hi={status:"pending",value:void 0,then:function(x){h.push(x)}}}return op++,c.then(bg,bg),c}function bg(){if(--op===0&&Mu!==null){hi!==null&&(hi.status="fulfilled");var s=Mu;Mu=null,_c=0,hi=null;for(var c=0;c<s.length;c++)(0,s[c])()}}function Jb(s,c){var h=[],x={status:"pending",value:null,reason:null,then:function(N){h.push(N)}};return s.then(function(){x.status="fulfilled",x.value=c;for(var N=0;N<h.length;N++)(0,h[N])(c)},function(N){for(x.status="rejected",x.reason=N,N=0;N<h.length;N++)(0,h[N])(void 0)}),x}var vg=V.S;V.S=function(s,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&Qb(s,c),vg!==null&&vg(s,c)};var Tl=le(null);function ks(){var s=Tl.current;return s!==null?s:Gn.pooledCache}function lf(s,c){c===null?D(Tl,Tl.current):D(Tl,c.pool)}function wg(){var s=ks();return s===null?null:{parent:$n._currentValue,pool:s}}var ri=Error(r(460)),Sg=Error(r(474)),cf=Error(r(542)),lp={then:function(){}};function Ng(s){return s=s.status,s==="fulfilled"||s==="rejected"}function uf(){}function cp(s,c,h){switch(h=s[h],h===void 0?s.push(c):h!==c&&(c.then(uf,uf),c=h),c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,jg(s),s;default:if(typeof c.status=="string")c.then(uf,uf);else{if(s=Gn,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=c,s.status="pending",s.then(function(x){if(c.status==="pending"){var N=c;N.status="fulfilled",N.value=x}},function(x){if(c.status==="pending"){var N=c;N.status="rejected",N.reason=x}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,jg(s),s}throw kc=c,ri}}var kc=null;function Cg(){if(kc===null)throw Error(r(459));var s=kc;return kc=null,s}function jg(s){if(s===ri||s===cf)throw Error(r(483))}var Xa=!1;function El(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Tc(s,c){s=s.updateQueue,c.updateQueue===s&&(c.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function wo(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ts(s,c,h){var x=s.updateQueue;if(x===null)return null;if(x=x.shared,(Pn&2)!==0){var N=x.pending;return N===null?c.next=c:(c.next=N.next,N.next=c),x.pending=c,c=ku(s),_u(s,null,h),c}return Hn(s,x,c,h),ku(s)}function Ou(s,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194048)!==0)){var x=c.lanes;x&=s.pendingLanes,h|=x,c.lanes=h,yt(s,h)}}function Na(s,c){var h=s.updateQueue,x=s.alternate;if(x!==null&&(x=x.updateQueue,h===x)){var N=null,A=null;if(h=h.firstBaseUpdate,h!==null){do{var q={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};A===null?N=A=q:A=A.next=q,h=h.next}while(h!==null);A===null?N=A=c:A=A.next=c}else N=A=c;h={baseState:x.baseState,firstBaseUpdate:N,lastBaseUpdate:A,shared:x.shared,callbacks:x.callbacks},s.updateQueue=h;return}s=h.lastBaseUpdate,s===null?h.firstBaseUpdate=c:s.next=c,h.lastBaseUpdate=c}var Lu=!1;function Ca(){if(Lu){var s=hi;if(s!==null)throw s}}function qr(s,c,h,x){Lu=!1;var N=s.updateQueue;Xa=!1;var A=N.firstBaseUpdate,q=N.lastBaseUpdate,K=N.shared.pending;if(K!==null){N.shared.pending=null;var xe=K,Oe=xe.next;xe.next=null,q===null?A=Oe:q.next=Oe,q=xe;var We=s.alternate;We!==null&&(We=We.updateQueue,K=We.lastBaseUpdate,K!==q&&(K===null?We.firstBaseUpdate=Oe:K.next=Oe,We.lastBaseUpdate=xe))}if(A!==null){var Ze=N.baseState;q=0,We=Oe=xe=null,K=A;do{var $e=K.lane&-536870913,Le=$e!==K.lane;if(Le?(bn&$e)===$e:(x&$e)===$e){$e!==0&&$e===_c&&(Lu=!0),We!==null&&(We=We.next={lane:0,tag:K.tag,payload:K.payload,callback:null,next:null});e:{var Dt=s,Pt=K;$e=c;var Ln=h;switch(Pt.tag){case 1:if(Dt=Pt.payload,typeof Dt=="function"){Ze=Dt.call(Ln,Ze,$e);break e}Ze=Dt;break e;case 3:Dt.flags=Dt.flags&-65537|128;case 0:if(Dt=Pt.payload,$e=typeof Dt=="function"?Dt.call(Ln,Ze,$e):Dt,$e==null)break e;Ze=p({},Ze,$e);break e;case 2:Xa=!0}}$e=K.callback,$e!==null&&(s.flags|=64,Le&&(s.flags|=8192),Le=N.callbacks,Le===null?N.callbacks=[$e]:Le.push($e))}else Le={lane:$e,tag:K.tag,payload:K.payload,callback:K.callback,next:null},We===null?(Oe=We=Le,xe=Ze):We=We.next=Le,q|=$e;if(K=K.next,K===null){if(K=N.shared.pending,K===null)break;Le=K,K=Le.next,Le.next=null,N.lastBaseUpdate=Le,N.shared.pending=null}}while(!0);We===null&&(xe=Ze),N.baseState=xe,N.firstBaseUpdate=Oe,N.lastBaseUpdate=We,A===null&&(N.shared.lanes=0),Ao|=q,s.lanes=q,s.memoizedState=Ze}}function _g(s,c){if(typeof s!="function")throw Error(r(191,s));s.call(c)}function up(s,c){var h=s.callbacks;if(h!==null)for(s.callbacks=null,s=0;s<h.length;s++)_g(h[s],c)}var Al=le(null),So=le(0);function Es(s,c){s=Fs,D(So,s),D(Al,c),Fs=s|c.baseLanes}function df(){D(So,Fs),D(Al,Al.current)}function dp(){Fs=So.current,ue(Al),ue(So)}var ja=0,Jt=null,An=null,ln=null,Ec=!1,Pl=!1,Vr=!1,Ac=0,No=0,ta=null,kg=0;function fn(){throw Error(r(321))}function Fu(s,c){if(c===null)return!1;for(var h=0;h<c.length&&h<s.length;h++)if(!ei(s[h],c[h]))return!1;return!0}function fp(s,c,h,x,N,A){return ja=A,Jt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,V.H=s===null||s.memoizedState===null?zg:Ap,Vr=!1,A=h(x,N),Vr=!1,Pl&&(A=Eg(c,h,x,N)),Tg(s),A}function Tg(s){V.H=Qu;var c=An!==null&&An.next!==null;if(ja=0,ln=An=Jt=null,Ec=!1,No=0,ta=null,c)throw Error(r(300));s===null||Pr||(s=s.dependencies,s!==null&&sf(s)&&(Pr=!0))}function Eg(s,c,h,x){Jt=s;var N=0;do{if(Pl&&(ta=null),No=0,Pl=!1,25<=N)throw Error(r(301));if(N+=1,ln=An=null,s.updateQueue!=null){var A=s.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}V.H=Ug,A=c(h,x)}while(Pl);return A}function hp(){var s=V.H,c=s.useState()[0];return c=typeof c.then=="function"?$u(c):c,s=s.useState()[0],(An!==null?An.memoizedState:null)!==s&&(Jt.flags|=1024),c}function pp(){var s=Ac!==0;return Ac=0,s}function Dl(s,c,h){c.updateQueue=s.updateQueue,c.flags&=-2053,s.lanes&=~h}function ff(s){if(Ec){for(s=s.memoizedState;s!==null;){var c=s.queue;c!==null&&(c.pending=null),s=s.next}Ec=!1}ja=0,ln=An=Jt=null,Pl=!1,No=Ac=0,ta=null}function pi(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ln===null?Jt.memoizedState=ln=s:ln=ln.next=s,ln}function gr(){if(An===null){var s=Jt.alternate;s=s!==null?s.memoizedState:null}else s=An.next;var c=ln===null?Jt.memoizedState:ln.next;if(c!==null)ln=c,An=s;else{if(s===null)throw Jt.alternate===null?Error(r(467)):Error(r(310));An=s,s={memoizedState:An.memoizedState,baseState:An.baseState,baseQueue:An.baseQueue,queue:An.queue,next:null},ln===null?Jt.memoizedState=ln=s:ln=ln.next=s}return ln}function Il(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $u(s){var c=No;return No+=1,ta===null&&(ta=[]),s=cp(ta,s,c),c=Jt,(ln===null?c.memoizedState:ln.next)===null&&(c=c.alternate,V.H=c===null||c.memoizedState===null?zg:Ap),s}function hf(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return $u(s);if(s.$$typeof===I)return cr(s)}throw Error(r(438,String(s)))}function zu(s){var c=null,h=Jt.updateQueue;if(h!==null&&(c=h.memoCache),c==null){var x=Jt.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(c={data:x.data.map(function(N){return N.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),h===null&&(h=Il(),Jt.updateQueue=h),h.memoCache=c,h=c.data[c.index],h===void 0)for(h=c.data[c.index]=Array(s),x=0;x<s;x++)h[x]=R;return c.index++,h}function Za(s,c){return typeof c=="function"?c(s):c}function pf(s){var c=gr();return mp(c,An,s)}function mp(s,c,h){var x=s.queue;if(x===null)throw Error(r(311));x.lastRenderedReducer=h;var N=s.baseQueue,A=x.pending;if(A!==null){if(N!==null){var q=N.next;N.next=A.next,A.next=q}c.baseQueue=N=A,x.pending=null}if(A=s.baseState,N===null)s.memoizedState=A;else{c=N.next;var K=q=null,xe=null,Oe=c,We=!1;do{var Ze=Oe.lane&-536870913;if(Ze!==Oe.lane?(bn&Ze)===Ze:(ja&Ze)===Ze){var $e=Oe.revertLane;if($e===0)xe!==null&&(xe=xe.next={lane:0,revertLane:0,action:Oe.action,hasEagerState:Oe.hasEagerState,eagerState:Oe.eagerState,next:null}),Ze===_c&&(We=!0);else if((ja&$e)===$e){Oe=Oe.next,$e===_c&&(We=!0);continue}else Ze={lane:0,revertLane:Oe.revertLane,action:Oe.action,hasEagerState:Oe.hasEagerState,eagerState:Oe.eagerState,next:null},xe===null?(K=xe=Ze,q=A):xe=xe.next=Ze,Jt.lanes|=$e,Ao|=$e;Ze=Oe.action,Vr&&h(A,Ze),A=Oe.hasEagerState?Oe.eagerState:h(A,Ze)}else $e={lane:Ze,revertLane:Oe.revertLane,action:Oe.action,hasEagerState:Oe.hasEagerState,eagerState:Oe.eagerState,next:null},xe===null?(K=xe=$e,q=A):xe=xe.next=$e,Jt.lanes|=Ze,Ao|=Ze;Oe=Oe.next}while(Oe!==null&&Oe!==c);if(xe===null?q=A:xe.next=K,!ei(A,s.memoizedState)&&(Pr=!0,We&&(h=hi,h!==null)))throw h;s.memoizedState=A,s.baseState=q,s.baseQueue=xe,x.lastRenderedState=A}return N===null&&(x.lanes=0),[s.memoizedState,x.dispatch]}function gp(s){var c=gr(),h=c.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=s;var x=h.dispatch,N=h.pending,A=c.memoizedState;if(N!==null){h.pending=null;var q=N=N.next;do A=s(A,q.action),q=q.next;while(q!==N);ei(A,c.memoizedState)||(Pr=!0),c.memoizedState=A,c.baseQueue===null&&(c.baseState=A),h.lastRenderedState=A}return[A,x]}function yp(s,c,h){var x=Jt,N=gr(),A=on;if(A){if(h===void 0)throw Error(r(407));h=h()}else h=c();var q=!ei((An||N).memoizedState,h);q&&(N.memoizedState=h,Pr=!0),N=N.queue;var K=gf.bind(null,x,N,s);if(qu(2048,8,K,[s]),N.getSnapshot!==c||q||ln!==null&&ln.memoizedState.tag&1){if(x.flags|=2048,Pc(9,wf(),Ag.bind(null,x,N,h,c),null),Gn===null)throw Error(r(349));A||(ja&124)!==0||mf(x,c,h)}return h}function mf(s,c,h){s.flags|=16384,s={getSnapshot:c,value:h},c=Jt.updateQueue,c===null?(c=Il(),Jt.updateQueue=c,c.stores=[s]):(h=c.stores,h===null?c.stores=[s]:h.push(s))}function Ag(s,c,h,x){c.value=h,c.getSnapshot=x,xp(c)&&bp(s)}function gf(s,c,h){return h(function(){xp(c)&&bp(s)})}function xp(s){var c=s.getSnapshot;s=s.value;try{var h=c();return!ei(s,h)}catch{return!0}}function bp(s){var c=Cs(s,2);c!==null&&$i(c,s,2)}function yf(s){var c=pi();if(typeof s=="function"){var h=s;if(s=h(),Vr){Ve(!0);try{h()}finally{Ve(!1)}}}return c.memoizedState=c.baseState=s,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Za,lastRenderedState:s},c}function Uu(s,c,h,x){return s.baseState=h,mp(s,An,typeof x=="function"?x:Za)}function Kb(s,c,h,x,N){if(jf(s))throw Error(r(485));if(s=c.action,s!==null){var A={payload:N,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){A.listeners.push(q)}};V.T!==null?h(!0):A.isTransition=!1,x(A),h=c.pending,h===null?(A.next=c.pending=A,vp(c,A)):(A.next=h.next,c.pending=h.next=A)}}function vp(s,c){var h=c.action,x=c.payload,N=s.state;if(c.isTransition){var A=V.T,q={};V.T=q;try{var K=h(N,x),xe=V.S;xe!==null&&xe(q,K),wp(s,c,K)}catch(Oe){xf(s,c,Oe)}finally{V.T=A}}else try{A=h(N,x),wp(s,c,A)}catch(Oe){xf(s,c,Oe)}}function wp(s,c,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(x){Pg(s,c,x)},function(x){return xf(s,c,x)}):Pg(s,c,h)}function Pg(s,c,h){c.status="fulfilled",c.value=h,Dg(c),s.state=h,c=s.pending,c!==null&&(h=c.next,h===c?s.pending=null:(h=h.next,c.next=h,vp(s,h)))}function xf(s,c,h){var x=s.pending;if(s.pending=null,x!==null){x=x.next;do c.status="rejected",c.reason=h,Dg(c),c=c.next;while(c!==x)}s.action=null}function Dg(s){s=s.listeners;for(var c=0;c<s.length;c++)(0,s[c])()}function bf(s,c){return c}function Sp(s,c){if(on){var h=Gn.formState;if(h!==null){e:{var x=Jt;if(on){if(tr){t:{for(var N=tr,A=di;N.nodeType!==8;){if(!A){N=null;break t}if(N=Ta(N.nextSibling),N===null){N=null;break t}}A=N.data,N=A==="F!"||A==="F"?N:null}if(N){tr=Ta(N.nextSibling),x=N.data==="F!";break e}}Zi(x)}x=!1}x&&(c=h[0])}}return h=pi(),h.memoizedState=h.baseState=c,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:bf,lastRenderedState:c},h.queue=x,h=kp.bind(null,Jt,x),x.dispatch=h,x=yf(!1),A=Tp.bind(null,Jt,!1,x.queue),x=pi(),N={state:c,dispatch:null,action:s,pending:null},x.queue=N,h=Kb.bind(null,Jt,N,A,h),N.dispatch=h,x.memoizedState=s,[c,h,!1]}function vf(s){var c=gr();return Ig(c,An,s)}function Ig(s,c,h){if(c=mp(s,c,bf)[0],s=pf(Za)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var x=$u(c)}catch(q){throw q===ri?cf:q}else x=c;c=gr();var N=c.queue,A=N.dispatch;return h!==c.memoizedState&&(Jt.flags|=2048,Pc(9,wf(),Np.bind(null,N,h),null)),[x,A,s]}function Np(s,c){s.action=c}function Gt(s){var c=gr(),h=An;if(h!==null)return Ig(c,h,s);gr(),c=c.memoizedState,h=gr();var x=h.queue.dispatch;return h.memoizedState=s,[c,x,!1]}function Pc(s,c,h,x){return s={tag:s,create:h,deps:x,inst:c,next:null},c=Jt.updateQueue,c===null&&(c=Il(),Jt.updateQueue=c),h=c.lastEffect,h===null?c.lastEffect=s.next=s:(x=h.next,h.next=s,s.next=x,c.lastEffect=s),s}function wf(){return{destroy:void 0,resource:void 0}}function Dc(){return gr().memoizedState}function Bu(s,c,h,x){var N=pi();x=x===void 0?null:x,Jt.flags|=s,N.memoizedState=Pc(1|c,wf(),h,x)}function qu(s,c,h,x){var N=gr();x=x===void 0?null:x;var A=N.memoizedState.inst;An!==null&&x!==null&&Fu(x,An.memoizedState.deps)?N.memoizedState=Pc(c,A,h,x):(Jt.flags|=s,N.memoizedState=Pc(1|c,A,h,x))}function Rg(s,c){Bu(8390656,8,s,c)}function Mi(s,c){qu(2048,8,s,c)}function Mg(s,c){return qu(4,2,s,c)}function Vu(s,c){return qu(4,4,s,c)}function Sf(s,c){if(typeof c=="function"){s=s();var h=c(s);return function(){typeof h=="function"?h():c(null)}}if(c!=null)return s=s(),c.current=s,function(){c.current=null}}function Cp(s,c,h){h=h!=null?h.concat([s]):null,qu(4,4,Sf.bind(null,c,s),h)}function Nf(){}function mi(s,c){var h=gr();c=c===void 0?null:c;var x=h.memoizedState;return c!==null&&Fu(c,x[1])?x[0]:(h.memoizedState=[s,c],s)}function As(s,c){var h=gr();c=c===void 0?null:c;var x=h.memoizedState;if(c!==null&&Fu(c,x[1]))return x[0];if(x=s(),Vr){Ve(!0);try{s()}finally{Ve(!1)}}return h.memoizedState=[x,c],x}function Hu(s,c,h){return h===void 0||(ja&1073741824)!==0?s.memoizedState=c:(s.memoizedState=h,s=py(),Jt.lanes|=s,Ao|=s,h)}function jp(s,c,h,x){return ei(h,c)?h:Al.current!==null?(s=Hu(s,h,x),ei(s,c)||(Pr=!0),s):(ja&42)===0?(Pr=!0,s.memoizedState=h):(s=py(),Jt.lanes|=s,Ao|=s,c)}function Gu(s,c,h,x,N){var A=se.p;se.p=A!==0&&8>A?A:8;var q=V.T,K={};V.T=K,Tp(s,!1,c,h);try{var xe=N(),Oe=V.S;if(Oe!==null&&Oe(K,xe),xe!==null&&typeof xe=="object"&&typeof xe.then=="function"){var We=Jb(xe,x);Rl(s,c,We,Gr(s))}else Rl(s,c,x,Gr(s))}catch(Ze){Rl(s,c,{then:function(){},status:"rejected",reason:Ze},Gr())}finally{se.p=A,V.T=q}}function Og(){}function Yu(s,c,h,x){if(s.tag!==5)throw Error(r(476));var N=_p(s).queue;Gu(s,N,c,re,h===null?Og:function(){return Cf(s),h(x)})}function _p(s){var c=s.memoizedState;if(c!==null)return c;c={memoizedState:re,baseState:re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Za,lastRenderedState:re},next:null};var h={};return c.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Za,lastRenderedState:h},next:null},s.memoizedState=c,s=s.alternate,s!==null&&(s.memoizedState=c),c}function Cf(s){var c=_p(s).next.queue;Rl(s,c,{},Gr())}function Wu(){return cr(Zc)}function Ps(){return gr().memoizedState}function Lg(){return gr().memoizedState}function Co(s){for(var c=s.return;c!==null;){switch(c.tag){case 24:case 3:var h=Gr();s=wo(h);var x=Ts(c,s,h);x!==null&&($i(x,c,h),Ou(x,c,h)),c={cache:sp()},s.payload=c;return}c=c.return}}function Fg(s,c,h){var x=Gr();h={lane:x,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null},jf(s)?$g(c,h):(h=Br(s,c,h,x),h!==null&&($i(h,s,x),Ep(h,c,x)))}function kp(s,c,h){var x=Gr();Rl(s,c,h,x)}function Rl(s,c,h,x){var N={lane:x,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null};if(jf(s))$g(c,N);else{var A=s.alternate;if(s.lanes===0&&(A===null||A.lanes===0)&&(A=c.lastRenderedReducer,A!==null))try{var q=c.lastRenderedState,K=A(q,h);if(N.hasEagerState=!0,N.eagerState=K,ei(K,q))return Hn(s,c,N,0),Gn===null&&St(),!1}catch{}finally{}if(h=Br(s,c,N,x),h!==null)return $i(h,s,x),Ep(h,c,x),!0}return!1}function Tp(s,c,h,x){if(x={lane:2,revertLane:Yf(),action:x,hasEagerState:!1,eagerState:null,next:null},jf(s)){if(c)throw Error(r(479))}else c=Br(s,h,x,2),c!==null&&$i(c,s,2)}function jf(s){var c=s.alternate;return s===Jt||c!==null&&c===Jt}function $g(s,c){Pl=Ec=!0;var h=s.pending;h===null?c.next=c:(c.next=h.next,h.next=c),s.pending=c}function Ep(s,c,h){if((h&4194048)!==0){var x=c.lanes;x&=s.pendingLanes,h|=x,c.lanes=h,yt(s,h)}}var Qu={readContext:cr,use:hf,useCallback:fn,useContext:fn,useEffect:fn,useImperativeHandle:fn,useLayoutEffect:fn,useInsertionEffect:fn,useMemo:fn,useReducer:fn,useRef:fn,useState:fn,useDebugValue:fn,useDeferredValue:fn,useTransition:fn,useSyncExternalStore:fn,useId:fn,useHostTransitionStatus:fn,useFormState:fn,useActionState:fn,useOptimistic:fn,useMemoCache:fn,useCacheRefresh:fn},zg={readContext:cr,use:hf,useCallback:function(s,c){return pi().memoizedState=[s,c===void 0?null:c],s},useContext:cr,useEffect:Rg,useImperativeHandle:function(s,c,h){h=h!=null?h.concat([s]):null,Bu(4194308,4,Sf.bind(null,c,s),h)},useLayoutEffect:function(s,c){return Bu(4194308,4,s,c)},useInsertionEffect:function(s,c){Bu(4,2,s,c)},useMemo:function(s,c){var h=pi();c=c===void 0?null:c;var x=s();if(Vr){Ve(!0);try{s()}finally{Ve(!1)}}return h.memoizedState=[x,c],x},useReducer:function(s,c,h){var x=pi();if(h!==void 0){var N=h(c);if(Vr){Ve(!0);try{h(c)}finally{Ve(!1)}}}else N=c;return x.memoizedState=x.baseState=N,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:N},x.queue=s,s=s.dispatch=Fg.bind(null,Jt,s),[x.memoizedState,s]},useRef:function(s){var c=pi();return s={current:s},c.memoizedState=s},useState:function(s){s=yf(s);var c=s.queue,h=kp.bind(null,Jt,c);return c.dispatch=h,[s.memoizedState,h]},useDebugValue:Nf,useDeferredValue:function(s,c){var h=pi();return Hu(h,s,c)},useTransition:function(){var s=yf(!1);return s=Gu.bind(null,Jt,s.queue,!0,!1),pi().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,c,h){var x=Jt,N=pi();if(on){if(h===void 0)throw Error(r(407));h=h()}else{if(h=c(),Gn===null)throw Error(r(349));(bn&124)!==0||mf(x,c,h)}N.memoizedState=h;var A={value:h,getSnapshot:c};return N.queue=A,Rg(gf.bind(null,x,A,s),[s]),x.flags|=2048,Pc(9,wf(),Ag.bind(null,x,A,h,c),null),h},useId:function(){var s=pi(),c=Gn.identifierPrefix;if(on){var h=_s,x=er;h=(x&~(1<<32-Qe(x)-1)).toString(32)+h,c=""+c+"R"+h,h=Ac++,0<h&&(c+="H"+h.toString(32)),c+=""}else h=kg++,c=""+c+"r"+h.toString(32)+"";return s.memoizedState=c},useHostTransitionStatus:Wu,useFormState:Sp,useActionState:Sp,useOptimistic:function(s){var c=pi();c.memoizedState=c.baseState=s;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=h,c=Tp.bind(null,Jt,!0,h),h.dispatch=c,[s,c]},useMemoCache:zu,useCacheRefresh:function(){return pi().memoizedState=Co.bind(null,Jt)}},Ap={readContext:cr,use:hf,useCallback:mi,useContext:cr,useEffect:Mi,useImperativeHandle:Cp,useInsertionEffect:Mg,useLayoutEffect:Vu,useMemo:As,useReducer:pf,useRef:Dc,useState:function(){return pf(Za)},useDebugValue:Nf,useDeferredValue:function(s,c){var h=gr();return jp(h,An.memoizedState,s,c)},useTransition:function(){var s=pf(Za)[0],c=gr().memoizedState;return[typeof s=="boolean"?s:$u(s),c]},useSyncExternalStore:yp,useId:Ps,useHostTransitionStatus:Wu,useFormState:vf,useActionState:vf,useOptimistic:function(s,c){var h=gr();return Uu(h,An,s,c)},useMemoCache:zu,useCacheRefresh:Lg},Ug={readContext:cr,use:hf,useCallback:mi,useContext:cr,useEffect:Mi,useImperativeHandle:Cp,useInsertionEffect:Mg,useLayoutEffect:Vu,useMemo:As,useReducer:gp,useRef:Dc,useState:function(){return gp(Za)},useDebugValue:Nf,useDeferredValue:function(s,c){var h=gr();return An===null?Hu(h,s,c):jp(h,An.memoizedState,s,c)},useTransition:function(){var s=gp(Za)[0],c=gr().memoizedState;return[typeof s=="boolean"?s:$u(s),c]},useSyncExternalStore:yp,useId:Ps,useHostTransitionStatus:Wu,useFormState:Gt,useActionState:Gt,useOptimistic:function(s,c){var h=gr();return An!==null?Uu(h,An,s,c):(h.baseState=s,[s,h.queue.dispatch])},useMemoCache:zu,useCacheRefresh:Lg},Nr=null,gi=0;function _f(s){var c=gi;return gi+=1,Nr===null&&(Nr=[]),cp(Nr,s,c)}function Ju(s,c){c=c.props.ref,s.ref=c!==void 0?c:null}function Ml(s,c){throw c.$$typeof===g?Error(r(525)):(s=Object.prototype.toString.call(c),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":s)))}function Ol(s){var c=s._init;return c(s._payload)}function Pp(s){function c(Ae,Ce){if(s){var Re=Ae.deletions;Re===null?(Ae.deletions=[Ce],Ae.flags|=16):Re.push(Ce)}}function h(Ae,Ce){if(!s)return null;for(;Ce!==null;)c(Ae,Ce),Ce=Ce.sibling;return null}function x(Ae){for(var Ce=new Map;Ae!==null;)Ae.key!==null?Ce.set(Ae.key,Ae):Ce.set(Ae.index,Ae),Ae=Ae.sibling;return Ce}function N(Ae,Ce){return Ae=ni(Ae,Ce),Ae.index=0,Ae.sibling=null,Ae}function A(Ae,Ce,Re){return Ae.index=Re,s?(Re=Ae.alternate,Re!==null?(Re=Re.index,Re<Ce?(Ae.flags|=67108866,Ce):Re):(Ae.flags|=67108866,Ce)):(Ae.flags|=1048576,Ce)}function q(Ae){return s&&Ae.alternate===null&&(Ae.flags|=67108866),Ae}function K(Ae,Ce,Re,Je){return Ce===null||Ce.tag!==6?(Ce=rp(Re,Ae.mode,Je),Ce.return=Ae,Ce):(Ce=N(Ce,Re),Ce.return=Ae,Ce)}function xe(Ae,Ce,Re,Je){var gt=Re.type;return gt===S?We(Ae,Ce,Re.props.children,Je,Re.key):Ce!==null&&(Ce.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===F&&Ol(gt)===Ce.type)?(Ce=N(Ce,Re.props),Ju(Ce,Re),Ce.return=Ae,Ce):(Ce=rf(Re.type,Re.key,Re.props,null,Ae.mode,Je),Ju(Ce,Re),Ce.return=Ae,Ce)}function Oe(Ae,Ce,Re,Je){return Ce===null||Ce.tag!==4||Ce.stateNode.containerInfo!==Re.containerInfo||Ce.stateNode.implementation!==Re.implementation?(Ce=Cc(Re,Ae.mode,Je),Ce.return=Ae,Ce):(Ce=N(Ce,Re.children||[]),Ce.return=Ae,Ce)}function We(Ae,Ce,Re,Je,gt){return Ce===null||Ce.tag!==7?(Ce=Cl(Re,Ae.mode,Je,gt),Ce.return=Ae,Ce):(Ce=N(Ce,Re),Ce.return=Ae,Ce)}function Ze(Ae,Ce,Re){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return Ce=rp(""+Ce,Ae.mode,Re),Ce.return=Ae,Ce;if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case b:return Re=rf(Ce.type,Ce.key,Ce.props,null,Ae.mode,Re),Ju(Re,Ce),Re.return=Ae,Re;case v:return Ce=Cc(Ce,Ae.mode,Re),Ce.return=Ae,Ce;case F:var Je=Ce._init;return Ce=Je(Ce._payload),Ze(Ae,Ce,Re)}if(W(Ce)||G(Ce))return Ce=Cl(Ce,Ae.mode,Re,null),Ce.return=Ae,Ce;if(typeof Ce.then=="function")return Ze(Ae,_f(Ce),Re);if(Ce.$$typeof===I)return Ze(Ae,of(Ae,Ce),Re);Ml(Ae,Ce)}return null}function $e(Ae,Ce,Re,Je){var gt=Ce!==null?Ce.key:null;if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return gt!==null?null:K(Ae,Ce,""+Re,Je);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case b:return Re.key===gt?xe(Ae,Ce,Re,Je):null;case v:return Re.key===gt?Oe(Ae,Ce,Re,Je):null;case F:return gt=Re._init,Re=gt(Re._payload),$e(Ae,Ce,Re,Je)}if(W(Re)||G(Re))return gt!==null?null:We(Ae,Ce,Re,Je,null);if(typeof Re.then=="function")return $e(Ae,Ce,_f(Re),Je);if(Re.$$typeof===I)return $e(Ae,Ce,of(Ae,Re),Je);Ml(Ae,Re)}return null}function Le(Ae,Ce,Re,Je,gt){if(typeof Je=="string"&&Je!==""||typeof Je=="number"||typeof Je=="bigint")return Ae=Ae.get(Re)||null,K(Ce,Ae,""+Je,gt);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case b:return Ae=Ae.get(Je.key===null?Re:Je.key)||null,xe(Ce,Ae,Je,gt);case v:return Ae=Ae.get(Je.key===null?Re:Je.key)||null,Oe(Ce,Ae,Je,gt);case F:var en=Je._init;return Je=en(Je._payload),Le(Ae,Ce,Re,Je,gt)}if(W(Je)||G(Je))return Ae=Ae.get(Re)||null,We(Ce,Ae,Je,gt,null);if(typeof Je.then=="function")return Le(Ae,Ce,Re,_f(Je),gt);if(Je.$$typeof===I)return Le(Ae,Ce,Re,of(Ce,Je),gt);Ml(Ce,Je)}return null}function Dt(Ae,Ce,Re,Je){for(var gt=null,en=null,wt=Ce,It=Ce=0,Rr=null;wt!==null&&It<Re.length;It++){wt.index>It?(Rr=wt,wt=null):Rr=wt.sibling;var Sn=$e(Ae,wt,Re[It],Je);if(Sn===null){wt===null&&(wt=Rr);break}s&&wt&&Sn.alternate===null&&c(Ae,wt),Ce=A(Sn,Ce,It),en===null?gt=Sn:en.sibling=Sn,en=Sn,wt=Rr}if(It===Re.length)return h(Ae,wt),on&&jl(Ae,It),gt;if(wt===null){for(;It<Re.length;It++)wt=Ze(Ae,Re[It],Je),wt!==null&&(Ce=A(wt,Ce,It),en===null?gt=wt:en.sibling=wt,en=wt);return on&&jl(Ae,It),gt}for(wt=x(wt);It<Re.length;It++)Rr=Le(wt,Ae,It,Re[It],Je),Rr!==null&&(s&&Rr.alternate!==null&&wt.delete(Rr.key===null?It:Rr.key),Ce=A(Rr,Ce,It),en===null?gt=Rr:en.sibling=Rr,en=Rr);return s&&wt.forEach(function(zo){return c(Ae,zo)}),on&&jl(Ae,It),gt}function Pt(Ae,Ce,Re,Je){if(Re==null)throw Error(r(151));for(var gt=null,en=null,wt=Ce,It=Ce=0,Rr=null,Sn=Re.next();wt!==null&&!Sn.done;It++,Sn=Re.next()){wt.index>It?(Rr=wt,wt=null):Rr=wt.sibling;var zo=$e(Ae,wt,Sn.value,Je);if(zo===null){wt===null&&(wt=Rr);break}s&&wt&&zo.alternate===null&&c(Ae,wt),Ce=A(zo,Ce,It),en===null?gt=zo:en.sibling=zo,en=zo,wt=Rr}if(Sn.done)return h(Ae,wt),on&&jl(Ae,It),gt;if(wt===null){for(;!Sn.done;It++,Sn=Re.next())Sn=Ze(Ae,Sn.value,Je),Sn!==null&&(Ce=A(Sn,Ce,It),en===null?gt=Sn:en.sibling=Sn,en=Sn);return on&&jl(Ae,It),gt}for(wt=x(wt);!Sn.done;It++,Sn=Re.next())Sn=Le(wt,Ae,It,Sn.value,Je),Sn!==null&&(s&&Sn.alternate!==null&&wt.delete(Sn.key===null?It:Sn.key),Ce=A(Sn,Ce,It),en===null?gt=Sn:en.sibling=Sn,en=Sn);return s&&wt.forEach(function(Iv){return c(Ae,Iv)}),on&&jl(Ae,It),gt}function Ln(Ae,Ce,Re,Je){if(typeof Re=="object"&&Re!==null&&Re.type===S&&Re.key===null&&(Re=Re.props.children),typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case b:e:{for(var gt=Re.key;Ce!==null;){if(Ce.key===gt){if(gt=Re.type,gt===S){if(Ce.tag===7){h(Ae,Ce.sibling),Je=N(Ce,Re.props.children),Je.return=Ae,Ae=Je;break e}}else if(Ce.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===F&&Ol(gt)===Ce.type){h(Ae,Ce.sibling),Je=N(Ce,Re.props),Ju(Je,Re),Je.return=Ae,Ae=Je;break e}h(Ae,Ce);break}else c(Ae,Ce);Ce=Ce.sibling}Re.type===S?(Je=Cl(Re.props.children,Ae.mode,Je,Re.key),Je.return=Ae,Ae=Je):(Je=rf(Re.type,Re.key,Re.props,null,Ae.mode,Je),Ju(Je,Re),Je.return=Ae,Ae=Je)}return q(Ae);case v:e:{for(gt=Re.key;Ce!==null;){if(Ce.key===gt)if(Ce.tag===4&&Ce.stateNode.containerInfo===Re.containerInfo&&Ce.stateNode.implementation===Re.implementation){h(Ae,Ce.sibling),Je=N(Ce,Re.children||[]),Je.return=Ae,Ae=Je;break e}else{h(Ae,Ce);break}else c(Ae,Ce);Ce=Ce.sibling}Je=Cc(Re,Ae.mode,Je),Je.return=Ae,Ae=Je}return q(Ae);case F:return gt=Re._init,Re=gt(Re._payload),Ln(Ae,Ce,Re,Je)}if(W(Re))return Dt(Ae,Ce,Re,Je);if(G(Re)){if(gt=G(Re),typeof gt!="function")throw Error(r(150));return Re=gt.call(Re),Pt(Ae,Ce,Re,Je)}if(typeof Re.then=="function")return Ln(Ae,Ce,_f(Re),Je);if(Re.$$typeof===I)return Ln(Ae,Ce,of(Ae,Re),Je);Ml(Ae,Re)}return typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint"?(Re=""+Re,Ce!==null&&Ce.tag===6?(h(Ae,Ce.sibling),Je=N(Ce,Re),Je.return=Ae,Ae=Je):(h(Ae,Ce),Je=rp(Re,Ae.mode,Je),Je.return=Ae,Ae=Je),q(Ae)):h(Ae,Ce)}return function(Ae,Ce,Re,Je){try{gi=0;var gt=Ln(Ae,Ce,Re,Je);return Nr=null,gt}catch(wt){if(wt===ri||wt===cf)throw wt;var en=ui(29,wt,null,Ae.mode);return en.lanes=Je,en.return=Ae,en}finally{}}}var Ll=Pp(!0),Bg=Pp(!1),Oi=le(null),ii=null;function na(s){var c=s.alternate;D(ur,ur.current&1),D(Oi,s),ii===null&&(c===null||Al.current!==null||c.memoizedState!==null)&&(ii=s)}function qg(s){if(s.tag===22){if(D(ur,ur.current),D(Oi,s),ii===null){var c=s.alternate;c!==null&&c.memoizedState!==null&&(ii=s)}}else Ds()}function Ds(){D(ur,ur.current),D(Oi,Oi.current)}function es(s){ue(Oi),ii===s&&(ii=null),ue(ur)}var ur=le(0);function Ku(s){for(var c=s;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||si(h)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function Ic(s,c,h,x){c=s.memoizedState,h=h(x,c),h=h==null?c:p({},c,h),s.memoizedState=h,s.lanes===0&&(s.updateQueue.baseState=h)}var Xu={enqueueSetState:function(s,c,h){s=s._reactInternals;var x=Gr(),N=wo(x);N.payload=c,h!=null&&(N.callback=h),c=Ts(s,N,x),c!==null&&($i(c,s,x),Ou(c,s,x))},enqueueReplaceState:function(s,c,h){s=s._reactInternals;var x=Gr(),N=wo(x);N.tag=1,N.payload=c,h!=null&&(N.callback=h),c=Ts(s,N,x),c!==null&&($i(c,s,x),Ou(c,s,x))},enqueueForceUpdate:function(s,c){s=s._reactInternals;var h=Gr(),x=wo(h);x.tag=2,c!=null&&(x.callback=c),c=Ts(s,x,h),c!==null&&($i(c,s,h),Ou(c,s,h))}};function Zu(s,c,h,x,N,A,q){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(x,A,q):c.prototype&&c.prototype.isPureReactComponent?!Ji(h,x)||!Ji(N,A):!0}function Vg(s,c,h,x){s=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,x),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,x),c.state!==s&&Xu.enqueueReplaceState(c,c.state,null)}function jo(s,c){var h=c;if("ref"in c){h={};for(var x in c)x!=="ref"&&(h[x]=c[x])}if(s=s.defaultProps){h===c&&(h=p({},h));for(var N in s)h[N]===void 0&&(h[N]=s[N])}return h}var Fl=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Dp(s){Fl(s)}function kf(s){console.error(s)}function Hg(s){Fl(s)}function ed(s,c){try{var h=s.onUncaughtError;h(c.value,{componentStack:c.stack})}catch(x){setTimeout(function(){throw x})}}function ts(s,c,h){try{var x=s.onCaughtError;x(h.value,{componentStack:h.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function Tf(s,c,h){return h=wo(h),h.tag=3,h.payload={element:null},h.callback=function(){ed(s,c)},h}function Ip(s){return s=wo(s),s.tag=3,s}function Gg(s,c,h,x){var N=h.type.getDerivedStateFromError;if(typeof N=="function"){var A=x.value;s.payload=function(){return N(A)},s.callback=function(){ts(c,h,x)}}var q=h.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(s.callback=function(){ts(c,h,x),typeof N!="function"&&(Po===null?Po=new Set([this]):Po.add(this));var K=x.stack;this.componentDidCatch(x.value,{componentStack:K!==null?K:""})})}function Yg(s,c,h,x,N){if(h.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(c=h.alternate,c!==null&&Iu(c,h,N,!0),h=Oi.current,h!==null){switch(h.tag){case 13:return ii===null?Xp():h.alternate===null&&dr===0&&(dr=3),h.flags&=-257,h.flags|=65536,h.lanes=N,x===lp?h.flags|=16384:(c=h.updateQueue,c===null?h.updateQueue=new Set([x]):c.add(x),tm(s,x,N)),!1;case 22:return h.flags|=65536,x===lp?h.flags|=16384:(c=h.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([x])},h.updateQueue=c):(h=c.retryQueue,h===null?c.retryQueue=new Set([x]):h.add(x)),tm(s,x,N)),!1}throw Error(r(435,h.tag))}return tm(s,x,N),Xp(),!1}if(on)return c=Oi.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=N,x!==jc&&(s=Error(r(422),{cause:x}),bo(Se(s,h)))):(x!==jc&&(c=Error(r(423),{cause:x}),bo(Se(c,h))),s=s.current.alternate,s.flags|=65536,N&=-N,s.lanes|=N,x=Se(x,h),N=Tf(s.stateNode,x,N),Na(s,N),dr!==4&&(dr=2)),!1;var A=Error(r(520),{cause:x});if(A=Se(A,h),ud===null?ud=[A]:ud.push(A),dr!==4&&(dr=2),c===null)return!0;x=Se(x,h),h=c;do{switch(h.tag){case 3:return h.flags|=65536,s=N&-N,h.lanes|=s,s=Tf(h.stateNode,x,s),Na(h,s),!1;case 1:if(c=h.type,A=h.stateNode,(h.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Po===null||!Po.has(A))))return h.flags|=65536,N&=-N,h.lanes|=N,N=Ip(N),Gg(N,s,h,x),Na(h,N),!1}h=h.return}while(h!==null);return!1}var Wg=Error(r(461)),Pr=!1;function Jn(s,c,h,x){c.child=s===null?Bg(c,null,h,x):Ll(c,s.child,h,x)}function Ef(s,c,h,x,N){h=h.render;var A=c.ref;if("ref"in x){var q={};for(var K in x)K!=="ref"&&(q[K]=x[K])}else q=x;return kl(c),x=fp(s,c,h,q,A,N),K=pp(),s!==null&&!Pr?(Dl(s,c,N),Is(s,c,N)):(on&&K&&ap(c),c.flags|=1,Jn(s,c,x,N),c.child)}function Af(s,c,h,x,N){if(s===null){var A=h.type;return typeof A=="function"&&!Nl(A)&&A.defaultProps===void 0&&h.compare===null?(c.tag=15,c.type=A,Pf(s,c,A,x,N)):(s=rf(h.type,null,x,c,c.mode,N),s.ref=c.ref,s.return=c,c.child=s)}if(A=s.child,!_a(s,N)){var q=A.memoizedProps;if(h=h.compare,h=h!==null?h:Ji,h(q,x)&&s.ref===c.ref)return Is(s,c,N)}return c.flags|=1,s=ni(A,x),s.ref=c.ref,s.return=c,c.child=s}function Pf(s,c,h,x,N){if(s!==null){var A=s.memoizedProps;if(Ji(A,x)&&s.ref===c.ref)if(Pr=!1,c.pendingProps=x=A,_a(s,N))(s.flags&131072)!==0&&(Pr=!0);else return c.lanes=s.lanes,Is(s,c,N)}return Rc(s,c,h,x,N)}function td(s,c,h){var x=c.pendingProps,N=x.children,A=s!==null?s.memoizedState:null;if(x.mode==="hidden"){if((c.flags&128)!==0){if(x=A!==null?A.baseLanes|h:h,s!==null){for(N=c.child=s.child,A=0;N!==null;)A=A|N.lanes|N.childLanes,N=N.sibling;c.childLanes=A&~x}else c.childLanes=0,c.child=null;return $l(s,c,x,h)}if((h&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},s!==null&&lf(c,A!==null?A.cachePool:null),A!==null?Es(c,A):df(),qg(c);else return c.lanes=c.childLanes=536870912,$l(s,c,A!==null?A.baseLanes|h:h,h)}else A!==null?(lf(c,A.cachePool),Es(c,A),Ds(),c.memoizedState=null):(s!==null&&lf(c,null),df(),Ds());return Jn(s,c,N,h),c.child}function $l(s,c,h,x){var N=ks();return N=N===null?null:{parent:$n._currentValue,pool:N},c.memoizedState={baseLanes:h,cachePool:N},s!==null&&lf(c,null),df(),qg(c),s!==null&&Iu(s,c,x,!0),null}function jt(s,c){var h=c.ref;if(h===null)s!==null&&s.ref!==null&&(c.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(r(284));(s===null||s.ref!==h)&&(c.flags|=4194816)}}function Rc(s,c,h,x,N){return kl(c),h=fp(s,c,h,x,void 0,N),x=pp(),s!==null&&!Pr?(Dl(s,c,N),Is(s,c,N)):(on&&x&&ap(c),c.flags|=1,Jn(s,c,h,N),c.child)}function Df(s,c,h,x,N,A){return kl(c),c.updateQueue=null,h=Eg(c,x,h,N),Tg(s),x=pp(),s!==null&&!Pr?(Dl(s,c,A),Is(s,c,A)):(on&&x&&ap(c),c.flags|=1,Jn(s,c,h,A),c.child)}function _o(s,c,h,x,N){if(kl(c),c.stateNode===null){var A=Sl,q=h.contextType;typeof q=="object"&&q!==null&&(A=cr(q)),A=new h(x,A),c.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=Xu,c.stateNode=A,A._reactInternals=c,A=c.stateNode,A.props=x,A.state=c.memoizedState,A.refs={},El(c),q=h.contextType,A.context=typeof q=="object"&&q!==null?cr(q):Sl,A.state=c.memoizedState,q=h.getDerivedStateFromProps,typeof q=="function"&&(Ic(c,h,q,x),A.state=c.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(q=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),q!==A.state&&Xu.enqueueReplaceState(A,A.state,null),qr(c,x,A,N),Ca(),A.state=c.memoizedState),typeof A.componentDidMount=="function"&&(c.flags|=4194308),x=!0}else if(s===null){A=c.stateNode;var K=c.memoizedProps,xe=jo(h,K);A.props=xe;var Oe=A.context,We=h.contextType;q=Sl,typeof We=="object"&&We!==null&&(q=cr(We));var Ze=h.getDerivedStateFromProps;We=typeof Ze=="function"||typeof A.getSnapshotBeforeUpdate=="function",K=c.pendingProps!==K,We||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(K||Oe!==q)&&Vg(c,A,x,q),Xa=!1;var $e=c.memoizedState;A.state=$e,qr(c,x,A,N),Ca(),Oe=c.memoizedState,K||$e!==Oe||Xa?(typeof Ze=="function"&&(Ic(c,h,Ze,x),Oe=c.memoizedState),(xe=Xa||Zu(c,h,xe,x,$e,Oe,q))?(We||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(c.flags|=4194308)):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=x,c.memoizedState=Oe),A.props=x,A.state=Oe,A.context=q,x=xe):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),x=!1)}else{A=c.stateNode,Tc(s,c),q=c.memoizedProps,We=jo(h,q),A.props=We,Ze=c.pendingProps,$e=A.context,Oe=h.contextType,xe=Sl,typeof Oe=="object"&&Oe!==null&&(xe=cr(Oe)),K=h.getDerivedStateFromProps,(Oe=typeof K=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(q!==Ze||$e!==xe)&&Vg(c,A,x,xe),Xa=!1,$e=c.memoizedState,A.state=$e,qr(c,x,A,N),Ca();var Le=c.memoizedState;q!==Ze||$e!==Le||Xa||s!==null&&s.dependencies!==null&&sf(s.dependencies)?(typeof K=="function"&&(Ic(c,h,K,x),Le=c.memoizedState),(We=Xa||Zu(c,h,We,x,$e,Le,xe)||s!==null&&s.dependencies!==null&&sf(s.dependencies))?(Oe||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(x,Le,xe),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(x,Le,xe)),typeof A.componentDidUpdate=="function"&&(c.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof A.componentDidUpdate!="function"||q===s.memoizedProps&&$e===s.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||q===s.memoizedProps&&$e===s.memoizedState||(c.flags|=1024),c.memoizedProps=x,c.memoizedState=Le),A.props=x,A.state=Le,A.context=xe,x=We):(typeof A.componentDidUpdate!="function"||q===s.memoizedProps&&$e===s.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||q===s.memoizedProps&&$e===s.memoizedState||(c.flags|=1024),x=!1)}return A=x,jt(s,c),x=(c.flags&128)!==0,A||x?(A=c.stateNode,h=x&&typeof h.getDerivedStateFromError!="function"?null:A.render(),c.flags|=1,s!==null&&x?(c.child=Ll(c,s.child,null,N),c.child=Ll(c,null,h,N)):Jn(s,c,h,N),c.memoizedState=A.state,s=c.child):s=Is(s,c,N),s}function Qg(s,c,h,x){return Du(),c.flags|=256,Jn(s,c,h,x),c.child}var nd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function If(s){return{baseLanes:s,cachePool:wg()}}function Dr(s,c,h){return s=s!==null?s.childLanes&~h:0,c&&(s|=ia),s}function Jg(s,c,h){var x=c.pendingProps,N=!1,A=(c.flags&128)!==0,q;if((q=A)||(q=s!==null&&s.memoizedState===null?!1:(ur.current&2)!==0),q&&(N=!0,c.flags&=-129),q=(c.flags&32)!==0,c.flags&=-33,s===null){if(on){if(N?na(c):Ds(),on){var K=tr,xe;if(xe=K){e:{for(xe=K,K=di;xe.nodeType!==8;){if(!K){K=null;break e}if(xe=Ta(xe.nextSibling),xe===null){K=null;break e}}K=xe}K!==null?(c.memoizedState={dehydrated:K,treeContext:Qn!==null?{id:er,overflow:_s}:null,retryLane:536870912,hydrationErrors:null},xe=ui(18,null,null,0),xe.stateNode=K,xe.return=c,c.child=xe,Sr=c,tr=null,xe=!0):xe=!1}xe||Zi(c)}if(K=c.memoizedState,K!==null&&(K=K.dehydrated,K!==null))return si(K)?c.lanes=32:c.lanes=536870912,null;es(c)}return K=x.children,x=x.fallback,N?(Ds(),N=c.mode,K=rd({mode:"hidden",children:K},N),x=Cl(x,N,h,null),K.return=c,x.return=c,K.sibling=x,c.child=K,N=c.child,N.memoizedState=If(h),N.childLanes=Dr(s,q,h),c.memoizedState=nd,x):(na(c),Rp(c,K))}if(xe=s.memoizedState,xe!==null&&(K=xe.dehydrated,K!==null)){if(A)c.flags&256?(na(c),c.flags&=-257,c=Mp(s,c,h)):c.memoizedState!==null?(Ds(),c.child=s.child,c.flags|=128,c=null):(Ds(),N=x.fallback,K=c.mode,x=rd({mode:"visible",children:x.children},K),N=Cl(N,K,h,null),N.flags|=2,x.return=c,N.return=c,x.sibling=N,c.child=x,Ll(c,s.child,null,h),x=c.child,x.memoizedState=If(h),x.childLanes=Dr(s,q,h),c.memoizedState=nd,c=N);else if(na(c),si(K)){if(q=K.nextSibling&&K.nextSibling.dataset,q)var Oe=q.dgst;q=Oe,x=Error(r(419)),x.stack="",x.digest=q,bo({value:x,source:null,stack:null}),c=Mp(s,c,h)}else if(Pr||Iu(s,c,h,!1),q=(h&s.childLanes)!==0,Pr||q){if(q=Gn,q!==null&&(x=h&-h,x=(x&42)!==0?1:Ot(x),x=(x&(q.suspendedLanes|h))!==0?0:x,x!==0&&x!==xe.retryLane))throw xe.retryLane=x,Cs(s,x),$i(q,s,x),Wg;K.data==="$?"||Xp(),c=Mp(s,c,h)}else K.data==="$?"?(c.flags|=192,c.child=s.child,c=null):(s=xe.treeContext,tr=Ta(K.nextSibling),Sr=c,on=!0,Sa=null,di=!1,s!==null&&(Ki[Xi++]=er,Ki[Xi++]=_s,Ki[Xi++]=Qn,er=s.id,_s=s.overflow,Qn=c),c=Rp(c,x.children),c.flags|=4096);return c}return N?(Ds(),N=x.fallback,K=c.mode,xe=s.child,Oe=xe.sibling,x=ni(xe,{mode:"hidden",children:x.children}),x.subtreeFlags=xe.subtreeFlags&65011712,Oe!==null?N=ni(Oe,N):(N=Cl(N,K,h,null),N.flags|=2),N.return=c,x.return=c,x.sibling=N,c.child=x,x=N,N=c.child,K=s.child.memoizedState,K===null?K=If(h):(xe=K.cachePool,xe!==null?(Oe=$n._currentValue,xe=xe.parent!==Oe?{parent:Oe,pool:Oe}:xe):xe=wg(),K={baseLanes:K.baseLanes|h,cachePool:xe}),N.memoizedState=K,N.childLanes=Dr(s,q,h),c.memoizedState=nd,x):(na(c),h=s.child,s=h.sibling,h=ni(h,{mode:"visible",children:x.children}),h.return=c,h.sibling=null,s!==null&&(q=c.deletions,q===null?(c.deletions=[s],c.flags|=16):q.push(s)),c.child=h,c.memoizedState=null,h)}function Rp(s,c){return c=rd({mode:"visible",children:c},s.mode),c.return=s,s.child=c}function rd(s,c){return s=ui(22,s,null,c),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Mp(s,c,h){return Ll(c,s.child,null,h),s=Rp(c,c.pendingProps.children),s.flags|=2,c.memoizedState=null,s}function Op(s,c,h){s.lanes|=c;var x=s.alternate;x!==null&&(x.lanes|=c),fi(s.return,c,h)}function Lp(s,c,h,x,N){var A=s.memoizedState;A===null?s.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:x,tail:h,tailMode:N}:(A.isBackwards=c,A.rendering=null,A.renderingStartTime=0,A.last=x,A.tail=h,A.tailMode=N)}function Kg(s,c,h){var x=c.pendingProps,N=x.revealOrder,A=x.tail;if(Jn(s,c,x.children,h),x=ur.current,(x&2)!==0)x=x&1|2,c.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=c.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Op(s,h,c);else if(s.tag===19)Op(s,h,c);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===c)break e;for(;s.sibling===null;){if(s.return===null||s.return===c)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}x&=1}switch(D(ur,x),N){case"forwards":for(h=c.child,N=null;h!==null;)s=h.alternate,s!==null&&Ku(s)===null&&(N=h),h=h.sibling;h=N,h===null?(N=c.child,c.child=null):(N=h.sibling,h.sibling=null),Lp(c,!1,N,h,A);break;case"backwards":for(h=null,N=c.child,c.child=null;N!==null;){if(s=N.alternate,s!==null&&Ku(s)===null){c.child=N;break}s=N.sibling,N.sibling=h,h=N,N=s}Lp(c,!0,h,null,A);break;case"together":Lp(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Is(s,c,h){if(s!==null&&(c.dependencies=s.dependencies),Ao|=c.lanes,(h&c.childLanes)===0)if(s!==null){if(Iu(s,c,h,!1),(h&c.childLanes)===0)return null}else return null;if(s!==null&&c.child!==s.child)throw Error(r(153));if(c.child!==null){for(s=c.child,h=ni(s,s.pendingProps),c.child=h,h.return=c;s.sibling!==null;)s=s.sibling,h=h.sibling=ni(s,s.pendingProps),h.return=c;h.sibling=null}return c.child}function _a(s,c){return(s.lanes&c)!==0?!0:(s=s.dependencies,!!(s!==null&&sf(s)))}function ai(s,c,h){switch(c.tag){case 3:ae(c,c.stateNode.containerInfo),Ri(c,$n,s.memoizedState.cache),Du();break;case 27:case 5:Ke(c);break;case 4:ae(c,c.stateNode.containerInfo);break;case 10:Ri(c,c.type,c.memoizedProps.value);break;case 13:var x=c.memoizedState;if(x!==null)return x.dehydrated!==null?(na(c),c.flags|=128,null):(h&c.child.childLanes)!==0?Jg(s,c,h):(na(c),s=Is(s,c,h),s!==null?s.sibling:null);na(c);break;case 19:var N=(s.flags&128)!==0;if(x=(h&c.childLanes)!==0,x||(Iu(s,c,h,!1),x=(h&c.childLanes)!==0),N){if(x)return Kg(s,c,h);c.flags|=128}if(N=c.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),D(ur,ur.current),x)break;return null;case 22:case 23:return c.lanes=0,td(s,c,h);case 24:Ri(c,$n,s.memoizedState.cache)}return Is(s,c,h)}function Rf(s,c,h){if(s!==null)if(s.memoizedProps!==c.pendingProps)Pr=!0;else{if(!_a(s,h)&&(c.flags&128)===0)return Pr=!1,ai(s,c,h);Pr=(s.flags&131072)!==0}else Pr=!1,on&&(c.flags&1048576)!==0&&ip(c,Eu,c.index);switch(c.lanes=0,c.tag){case 16:e:{s=c.pendingProps;var x=c.elementType,N=x._init;if(x=N(x._payload),c.type=x,typeof x=="function")Nl(x)?(s=jo(x,s),c.tag=1,c=_o(null,c,x,s,h)):(c.tag=0,c=Rc(null,c,x,s,h));else{if(x!=null){if(N=x.$$typeof,N===U){c.tag=11,c=Ef(null,c,x,s,h);break e}else if(N===z){c.tag=14,c=Af(null,c,x,s,h);break e}}throw c=te(x)||x,Error(r(306,c,""))}}return c;case 0:return Rc(s,c,c.type,c.pendingProps,h);case 1:return x=c.type,N=jo(x,c.pendingProps),_o(s,c,x,N,h);case 3:e:{if(ae(c,c.stateNode.containerInfo),s===null)throw Error(r(387));x=c.pendingProps;var A=c.memoizedState;N=A.element,Tc(s,c),qr(c,x,null,h);var q=c.memoizedState;if(x=q.cache,Ri(c,$n,x),x!==A.cache&&Zt(c,[$n],h,!0),Ca(),x=q.element,A.isDehydrated)if(A={element:x,isDehydrated:!1,cache:q.cache},c.updateQueue.baseState=A,c.memoizedState=A,c.flags&256){c=Qg(s,c,x,h);break e}else if(x!==N){N=Se(Error(r(424)),c),bo(N),c=Qg(s,c,x,h);break e}else{switch(s=c.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(tr=Ta(s.firstChild),Sr=c,on=!0,Sa=null,di=!0,h=Bg(c,null,x,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(Du(),x===N){c=Is(s,c,h);break e}Jn(s,c,x,h)}c=c.child}return c;case 26:return jt(s,c),s===null?(h=Yy(c.type,null,c.pendingProps,null))?c.memoizedState=h:on||(h=c.type,s=c.pendingProps,x=Bl(X.current).createElement(h),x[yn]=c,x[vr]=s,_r(x,h,s),mr(x),c.stateNode=x):c.memoizedState=Yy(c.type,s.memoizedProps,c.pendingProps,s.memoizedState),null;case 27:return Ke(c),s===null&&on&&(x=c.stateNode=Vy(c.type,c.pendingProps,X.current),Sr=c,di=!0,N=tr,aa(c.type)?(um=N,tr=Ta(x.firstChild)):tr=N),Jn(s,c,c.pendingProps.children,h),jt(s,c),s===null&&(c.flags|=4194304),c.child;case 5:return s===null&&on&&((N=x=tr)&&(x=By(x,c.type,c.pendingProps,di),x!==null?(c.stateNode=x,Sr=c,tr=Ta(x.firstChild),di=!1,N=!0):N=!1),N||Zi(c)),Ke(c),N=c.type,A=c.pendingProps,q=s!==null?s.memoizedProps:null,x=A.children,Kf(N,A)?x=null:q!==null&&Kf(N,q)&&(c.flags|=32),c.memoizedState!==null&&(N=fp(s,c,hp,null,null,h),Zc._currentValue=N),jt(s,c),Jn(s,c,x,h),c.child;case 6:return s===null&&on&&((s=h=tr)&&(h=Zf(h,c.pendingProps,di),h!==null?(c.stateNode=h,Sr=c,tr=null,s=!0):s=!1),s||Zi(c)),null;case 13:return Jg(s,c,h);case 4:return ae(c,c.stateNode.containerInfo),x=c.pendingProps,s===null?c.child=Ll(c,null,x,h):Jn(s,c,x,h),c.child;case 11:return Ef(s,c,c.type,c.pendingProps,h);case 7:return Jn(s,c,c.pendingProps,h),c.child;case 8:return Jn(s,c,c.pendingProps.children,h),c.child;case 12:return Jn(s,c,c.pendingProps.children,h),c.child;case 10:return x=c.pendingProps,Ri(c,c.type,x.value),Jn(s,c,x.children,h),c.child;case 9:return N=c.type._context,x=c.pendingProps.children,kl(c),N=cr(N),x=x(N),c.flags|=1,Jn(s,c,x,h),c.child;case 14:return Af(s,c,c.type,c.pendingProps,h);case 15:return Pf(s,c,c.type,c.pendingProps,h);case 19:return Kg(s,c,h);case 31:return x=c.pendingProps,h=c.mode,x={mode:x.mode,children:x.children},s===null?(h=rd(x,h),h.ref=c.ref,c.child=h,h.return=c,c=h):(h=ni(s.child,x),h.ref=c.ref,c.child=h,h.return=c,c=h),c;case 22:return td(s,c,h);case 24:return kl(c),x=cr($n),s===null?(N=ks(),N===null&&(N=Gn,A=sp(),N.pooledCache=A,A.refCount++,A!==null&&(N.pooledCacheLanes|=h),N=A),c.memoizedState={parent:x,cache:N},El(c),Ri(c,$n,N)):((s.lanes&h)!==0&&(Tc(s,c),qr(c,null,null,h),Ca()),N=s.memoizedState,A=c.memoizedState,N.parent!==x?(N={parent:x,cache:x},c.memoizedState=N,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=N),Ri(c,$n,x)):(x=A.cache,Ri(c,$n,x),x!==N.cache&&Zt(c,[$n],h,!0))),Jn(s,c,c.pendingProps.children,h),c.child;case 29:throw c.pendingProps}throw Error(r(156,c.tag))}function Rs(s){s.flags|=4}function Mf(s,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!kr(c)){if(c=Oi.current,c!==null&&((bn&4194048)===bn?ii!==null:(bn&62914560)!==bn&&(bn&536870912)===0||c!==ii))throw kc=lp,Sg;s.flags|=8192}}function Of(s,c){c!==null&&(s.flags|=4),s.flags&16384&&(c=s.tag!==22?Nt():536870912,s.lanes|=c,Uc|=c)}function id(s,c){if(!on)switch(s.tailMode){case"hidden":c=s.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?s.tail=null:h.sibling=null;break;case"collapsed":h=s.tail;for(var x=null;h!==null;)h.alternate!==null&&(x=h),h=h.sibling;x===null?c||s.tail===null?s.tail=null:s.tail.sibling=null:x.sibling=null}}function zn(s){var c=s.alternate!==null&&s.alternate.child===s.child,h=0,x=0;if(c)for(var N=s.child;N!==null;)h|=N.lanes|N.childLanes,x|=N.subtreeFlags&65011712,x|=N.flags&65011712,N.return=s,N=N.sibling;else for(N=s.child;N!==null;)h|=N.lanes|N.childLanes,x|=N.subtreeFlags,x|=N.flags,N.return=s,N=N.sibling;return s.subtreeFlags|=x,s.childLanes=h,c}function Xg(s,c,h){var x=c.pendingProps;switch(Au(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zn(c),null;case 1:return zn(c),null;case 3:return h=c.stateNode,x=null,s!==null&&(x=s.memoizedState.cache),c.memoizedState.cache!==x&&(c.flags|=2048),ea($n),Me(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(s===null||s.child===null)&&(Pu(c)?Rs(c):s===null||s.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,yg())),zn(c),null;case 26:return h=c.memoizedState,s===null?(Rs(c),h!==null?(zn(c),Mf(c,h)):(zn(c),c.flags&=-16777217)):h?h!==s.memoizedState?(Rs(c),zn(c),Mf(c,h)):(zn(c),c.flags&=-16777217):(s.memoizedProps!==x&&Rs(c),zn(c),c.flags&=-16777217),null;case 27:Z(c),h=X.current;var N=c.type;if(s!==null&&c.stateNode!=null)s.memoizedProps!==x&&Rs(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return zn(c),null}s=ce.current,Pu(c)?mg(c):(s=Vy(N,x,h),c.stateNode=s,Rs(c))}return zn(c),null;case 5:if(Z(c),h=c.type,s!==null&&c.stateNode!=null)s.memoizedProps!==x&&Rs(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return zn(c),null}if(s=ce.current,Pu(c))mg(c);else{switch(N=Bl(X.current),s){case 1:s=N.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:s=N.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":s=N.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":s=N.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":s=N.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof x.is=="string"?N.createElement("select",{is:x.is}):N.createElement("select"),x.multiple?s.multiple=!0:x.size&&(s.size=x.size);break;default:s=typeof x.is=="string"?N.createElement(h,{is:x.is}):N.createElement(h)}}s[yn]=c,s[vr]=x;e:for(N=c.child;N!==null;){if(N.tag===5||N.tag===6)s.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===c)break e;for(;N.sibling===null;){if(N.return===null||N.return===c)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}c.stateNode=s;e:switch(_r(s,h,x),h){case"button":case"input":case"select":case"textarea":s=!!x.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Rs(c)}}return zn(c),c.flags&=-16777217,null;case 6:if(s&&c.stateNode!=null)s.memoizedProps!==x&&Rs(c);else{if(typeof x!="string"&&c.stateNode===null)throw Error(r(166));if(s=X.current,Pu(c)){if(s=c.stateNode,h=c.memoizedProps,x=null,N=Sr,N!==null)switch(N.tag){case 27:case 5:x=N.memoizedProps}s[yn]=c,s=!!(s.nodeValue===h||x!==null&&x.suppressHydrationWarning===!0||Fy(s.nodeValue,h)),s||Zi(c)}else s=Bl(s).createTextNode(x),s[yn]=c,c.stateNode=s}return zn(c),null;case 13:if(x=c.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(N=Pu(c),x!==null&&x.dehydrated!==null){if(s===null){if(!N)throw Error(r(318));if(N=c.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(r(317));N[yn]=c}else Du(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;zn(c),N=!1}else N=yg(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=N),N=!0;if(!N)return c.flags&256?(es(c),c):(es(c),null)}if(es(c),(c.flags&128)!==0)return c.lanes=h,c;if(h=x!==null,s=s!==null&&s.memoizedState!==null,h){x=c.child,N=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(N=x.alternate.memoizedState.cachePool.pool);var A=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(A=x.memoizedState.cachePool.pool),A!==N&&(x.flags|=2048)}return h!==s&&h&&(c.child.flags|=8192),Of(c,c.updateQueue),zn(c),null;case 4:return Me(),s===null&&sm(c.stateNode.containerInfo),zn(c),null;case 10:return ea(c.type),zn(c),null;case 19:if(ue(ur),N=c.memoizedState,N===null)return zn(c),null;if(x=(c.flags&128)!==0,A=N.rendering,A===null)if(x)id(N,!1);else{if(dr!==0||s!==null&&(s.flags&128)!==0)for(s=c.child;s!==null;){if(A=Ku(s),A!==null){for(c.flags|=128,id(N,!1),s=A.updateQueue,c.updateQueue=s,Of(c,s),c.subtreeFlags=0,s=h,h=c.child;h!==null;)Tu(h,s),h=h.sibling;return D(ur,ur.current&1|2),c.child}s=s.sibling}N.tail!==null&&ct()>Bc&&(c.flags|=128,x=!0,id(N,!1),c.lanes=4194304)}else{if(!x)if(s=Ku(A),s!==null){if(c.flags|=128,x=!0,s=s.updateQueue,c.updateQueue=s,Of(c,s),id(N,!0),N.tail===null&&N.tailMode==="hidden"&&!A.alternate&&!on)return zn(c),null}else 2*ct()-N.renderingStartTime>Bc&&h!==536870912&&(c.flags|=128,x=!0,id(N,!1),c.lanes=4194304);N.isBackwards?(A.sibling=c.child,c.child=A):(s=N.last,s!==null?s.sibling=A:c.child=A,N.last=A)}return N.tail!==null?(c=N.tail,N.rendering=c,N.tail=c.sibling,N.renderingStartTime=ct(),c.sibling=null,s=ur.current,D(ur,x?s&1|2:s&1),c):(zn(c),null);case 22:case 23:return es(c),dp(),x=c.memoizedState!==null,s!==null?s.memoizedState!==null!==x&&(c.flags|=8192):x&&(c.flags|=8192),x?(h&536870912)!==0&&(c.flags&128)===0&&(zn(c),c.subtreeFlags&6&&(c.flags|=8192)):zn(c),h=c.updateQueue,h!==null&&Of(c,h.retryQueue),h=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),x=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(x=c.memoizedState.cachePool.pool),x!==h&&(c.flags|=2048),s!==null&&ue(Tl),null;case 24:return h=null,s!==null&&(h=s.memoizedState.cache),c.memoizedState.cache!==h&&(c.flags|=2048),ea($n),zn(c),null;case 25:return null;case 30:return null}throw Error(r(156,c.tag))}function Zg(s,c){switch(Au(c),c.tag){case 1:return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 3:return ea($n),Me(),s=c.flags,(s&65536)!==0&&(s&128)===0?(c.flags=s&-65537|128,c):null;case 26:case 27:case 5:return Z(c),null;case 13:if(es(c),s=c.memoizedState,s!==null&&s.dehydrated!==null){if(c.alternate===null)throw Error(r(340));Du()}return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 19:return ue(ur),null;case 4:return Me(),null;case 10:return ea(c.type),null;case 22:case 23:return es(c),dp(),s!==null&&ue(Tl),s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 24:return ea($n),null;case 25:return null;default:return null}}function ey(s,c){switch(Au(c),c.tag){case 3:ea($n),Me();break;case 26:case 27:case 5:Z(c);break;case 4:Me();break;case 13:es(c);break;case 19:ue(ur);break;case 10:ea(c.type);break;case 22:case 23:es(c),dp(),s!==null&&ue(Tl);break;case 24:ea($n)}}function ad(s,c){try{var h=c.updateQueue,x=h!==null?h.lastEffect:null;if(x!==null){var N=x.next;h=N;do{if((h.tag&s)===s){x=void 0;var A=h.create,q=h.inst;x=A(),q.destroy=x}h=h.next}while(h!==N)}}catch(K){Un(c,c.return,K)}}function ko(s,c,h){try{var x=c.updateQueue,N=x!==null?x.lastEffect:null;if(N!==null){var A=N.next;x=A;do{if((x.tag&s)===s){var q=x.inst,K=q.destroy;if(K!==void 0){q.destroy=void 0,N=c;var xe=h,Oe=K;try{Oe()}catch(We){Un(N,xe,We)}}}x=x.next}while(x!==A)}}catch(We){Un(c,c.return,We)}}function ty(s){var c=s.updateQueue;if(c!==null){var h=s.stateNode;try{up(c,h)}catch(x){Un(s,s.return,x)}}}function Fp(s,c,h){h.props=jo(s.type,s.memoizedProps),h.state=s.memoizedState;try{h.componentWillUnmount()}catch(x){Un(s,c,x)}}function Mc(s,c){try{var h=s.ref;if(h!==null){switch(s.tag){case 26:case 27:case 5:var x=s.stateNode;break;case 30:x=s.stateNode;break;default:x=s.stateNode}typeof h=="function"?s.refCleanup=h(x):h.current=x}}catch(N){Un(s,c,N)}}function ns(s,c){var h=s.ref,x=s.refCleanup;if(h!==null)if(typeof x=="function")try{x()}catch(N){Un(s,c,N)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(N){Un(s,c,N)}else h.current=null}function Lf(s){var c=s.type,h=s.memoizedProps,x=s.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":h.autoFocus&&x.focus();break e;case"img":h.src?x.src=h.src:h.srcSet&&(x.srcset=h.srcSet)}}catch(N){Un(s,s.return,N)}}function Ff(s,c,h){try{var x=s.stateNode;fv(x,s.type,h,c),x[vr]=c}catch(N){Un(s,s.return,N)}}function Oc(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&aa(s.type)||s.tag===4}function sd(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Oc(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&aa(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function $f(s,c,h){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(s,c):(c=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,c.appendChild(s),h=h._reactRootContainer,h!=null||c.onclick!==null||(c.onclick=Qf));else if(x!==4&&(x===27&&aa(s.type)&&(h=s.stateNode,c=null),s=s.child,s!==null))for($f(s,c,h),s=s.sibling;s!==null;)$f(s,c,h),s=s.sibling}function od(s,c,h){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?h.insertBefore(s,c):h.appendChild(s);else if(x!==4&&(x===27&&aa(s.type)&&(h=s.stateNode),s=s.child,s!==null))for(od(s,c,h),s=s.sibling;s!==null;)od(s,c,h),s=s.sibling}function ld(s){var c=s.stateNode,h=s.memoizedProps;try{for(var x=s.type,N=c.attributes;N.length;)c.removeAttributeNode(N[0]);_r(c,x,h),c[yn]=s,c[vr]=h}catch(A){Un(s,s.return,A)}}var rs=!1,En=!1,Ms=!1,ny=typeof WeakSet=="function"?WeakSet:Set,Cr=null;function Xb(s,c){if(s=s.containerInfo,ka=rh,s=ef(s),wl(s)){if("selectionStart"in s)var h={start:s.selectionStart,end:s.selectionEnd};else e:{h=(h=s.ownerDocument)&&h.defaultView||window;var x=h.getSelection&&h.getSelection();if(x&&x.rangeCount!==0){h=x.anchorNode;var N=x.anchorOffset,A=x.focusNode;x=x.focusOffset;try{h.nodeType,A.nodeType}catch{h=null;break e}var q=0,K=-1,xe=-1,Oe=0,We=0,Ze=s,$e=null;t:for(;;){for(var Le;Ze!==h||N!==0&&Ze.nodeType!==3||(K=q+N),Ze!==A||x!==0&&Ze.nodeType!==3||(xe=q+x),Ze.nodeType===3&&(q+=Ze.nodeValue.length),(Le=Ze.firstChild)!==null;)$e=Ze,Ze=Le;for(;;){if(Ze===s)break t;if($e===h&&++Oe===N&&(K=q),$e===A&&++We===x&&(xe=q),(Le=Ze.nextSibling)!==null)break;Ze=$e,$e=Ze.parentNode}Ze=Le}h=K===-1||xe===-1?null:{start:K,end:xe}}else h=null}h=h||{start:0,end:0}}else h=null;for(Jf={focusedElem:s,selectionRange:h},rh=!1,Cr=c;Cr!==null;)if(c=Cr,s=c.child,(c.subtreeFlags&1024)!==0&&s!==null)s.return=c,Cr=s;else for(;Cr!==null;){switch(c=Cr,A=c.alternate,s=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&A!==null){s=void 0,h=c,N=A.memoizedProps,A=A.memoizedState,x=h.stateNode;try{var Dt=jo(h.type,N,h.elementType===h.type);s=x.getSnapshotBeforeUpdate(Dt,A),x.__reactInternalSnapshotBeforeUpdate=s}catch(Pt){Un(h,h.return,Pt)}}break;case 3:if((s&1024)!==0){if(s=c.stateNode.containerInfo,h=s.nodeType,h===9)cm(s);else if(h===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":cm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=c.sibling,s!==null){s.return=c.return,Cr=s;break}Cr=c.return}}function ry(s,c,h){var x=h.flags;switch(h.tag){case 0:case 11:case 15:To(s,h),x&4&&ad(5,h);break;case 1:if(To(s,h),x&4)if(s=h.stateNode,c===null)try{s.componentDidMount()}catch(q){Un(h,h.return,q)}else{var N=jo(h.type,c.memoizedProps);c=c.memoizedState;try{s.componentDidUpdate(N,c,s.__reactInternalSnapshotBeforeUpdate)}catch(q){Un(h,h.return,q)}}x&64&&ty(h),x&512&&Mc(h,h.return);break;case 3:if(To(s,h),x&64&&(s=h.updateQueue,s!==null)){if(c=null,h.child!==null)switch(h.child.tag){case 27:case 5:c=h.child.stateNode;break;case 1:c=h.child.stateNode}try{up(s,c)}catch(q){Un(h,h.return,q)}}break;case 27:c===null&&x&4&&ld(h);case 26:case 5:To(s,h),c===null&&x&4&&Lf(h),x&512&&Mc(h,h.return);break;case 12:To(s,h);break;case 13:To(s,h),x&4&&sy(s,h),x&64&&(s=h.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(h=Vf.bind(null,h),Wc(s,h))));break;case 22:if(x=h.memoizedState!==null||rs,!x){c=c!==null&&c.memoizedState!==null||En,N=rs;var A=En;rs=x,(En=c)&&!A?Ls(s,h,(h.subtreeFlags&8772)!==0):To(s,h),rs=N,En=A}break;case 30:break;default:To(s,h)}}function iy(s){var c=s.alternate;c!==null&&(s.alternate=null,iy(c)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(c=s.stateNode,c!==null&&Zl(c)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var nr=null,yi=!1;function Os(s,c,h){for(h=h.child;h!==null;)ay(s,c,h),h=h.sibling}function ay(s,c,h){if(me&&typeof me.onCommitFiberUnmount=="function")try{me.onCommitFiberUnmount(Q,h)}catch{}switch(h.tag){case 26:En||ns(h,c),Os(s,c,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:En||ns(h,c);var x=nr,N=yi;aa(h.type)&&(nr=h.stateNode,yi=!1),Os(s,c,h),bd(h.stateNode),nr=x,yi=N;break;case 5:En||ns(h,c);case 6:if(x=nr,N=yi,nr=null,Os(s,c,h),nr=x,yi=N,nr!==null)if(yi)try{(nr.nodeType===9?nr.body:nr.nodeName==="HTML"?nr.ownerDocument.body:nr).removeChild(h.stateNode)}catch(A){Un(h,c,A)}else try{nr.removeChild(h.stateNode)}catch(A){Un(h,c,A)}break;case 18:nr!==null&&(yi?(s=nr,Xf(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,h.stateNode),kd(s)):Xf(nr,h.stateNode));break;case 4:x=nr,N=yi,nr=h.stateNode.containerInfo,yi=!0,Os(s,c,h),nr=x,yi=N;break;case 0:case 11:case 14:case 15:En||ko(2,h,c),En||ko(4,h,c),Os(s,c,h);break;case 1:En||(ns(h,c),x=h.stateNode,typeof x.componentWillUnmount=="function"&&Fp(h,c,x)),Os(s,c,h);break;case 21:Os(s,c,h);break;case 22:En=(x=En)||h.memoizedState!==null,Os(s,c,h),En=x;break;default:Os(s,c,h)}}function sy(s,c){if(c.memoizedState===null&&(s=c.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{kd(s)}catch(h){Un(c,c.return,h)}}function Zb(s){switch(s.tag){case 13:case 19:var c=s.stateNode;return c===null&&(c=s.stateNode=new ny),c;case 22:return s=s.stateNode,c=s._retryCache,c===null&&(c=s._retryCache=new ny),c;default:throw Error(r(435,s.tag))}}function $p(s,c){var h=Zb(s);c.forEach(function(x){var N=av.bind(null,s,x);h.has(x)||(h.add(x),x.then(N,N))})}function Li(s,c){var h=c.deletions;if(h!==null)for(var x=0;x<h.length;x++){var N=h[x],A=s,q=c,K=q;e:for(;K!==null;){switch(K.tag){case 27:if(aa(K.type)){nr=K.stateNode,yi=!1;break e}break;case 5:nr=K.stateNode,yi=!1;break e;case 3:case 4:nr=K.stateNode.containerInfo,yi=!0;break e}K=K.return}if(nr===null)throw Error(r(160));ay(A,q,N),nr=null,yi=!1,A=N.alternate,A!==null&&(A.return=null),N.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)zp(c,s),c=c.sibling}var ra=null;function zp(s,c){var h=s.alternate,x=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Li(c,s),xi(s),x&4&&(ko(3,s,s.return),ad(3,s),ko(5,s,s.return));break;case 1:Li(c,s),xi(s),x&512&&(En||h===null||ns(h,h.return)),x&64&&rs&&(s=s.updateQueue,s!==null&&(x=s.callbacks,x!==null&&(h=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=h===null?x:h.concat(x))));break;case 26:var N=ra;if(Li(c,s),xi(s),x&512&&(En||h===null||ns(h,h.return)),x&4){var A=h!==null?h.memoizedState:null;if(x=s.memoizedState,h===null)if(x===null)if(s.stateNode===null){e:{x=s.type,h=s.memoizedProps,N=N.ownerDocument||N;t:switch(x){case"title":A=N.getElementsByTagName("title")[0],(!A||A[Qs]||A[yn]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=N.createElement(x),N.head.insertBefore(A,N.querySelector("head > title"))),_r(A,x,h),A[yn]=s,mr(A),x=A;break e;case"link":var q=Jy("link","href",N).get(x+(h.href||""));if(q){for(var K=0;K<q.length;K++)if(A=q[K],A.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&A.getAttribute("rel")===(h.rel==null?null:h.rel)&&A.getAttribute("title")===(h.title==null?null:h.title)&&A.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){q.splice(K,1);break t}}A=N.createElement(x),_r(A,x,h),N.head.appendChild(A);break;case"meta":if(q=Jy("meta","content",N).get(x+(h.content||""))){for(K=0;K<q.length;K++)if(A=q[K],A.getAttribute("content")===(h.content==null?null:""+h.content)&&A.getAttribute("name")===(h.name==null?null:h.name)&&A.getAttribute("property")===(h.property==null?null:h.property)&&A.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&A.getAttribute("charset")===(h.charSet==null?null:h.charSet)){q.splice(K,1);break t}}A=N.createElement(x),_r(A,x,h),N.head.appendChild(A);break;default:throw Error(r(468,x))}A[yn]=s,mr(A),x=A}s.stateNode=x}else Ky(N,s.type,s.stateNode);else s.stateNode=Qy(N,x,s.memoizedProps);else A!==x?(A===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):A.count--,x===null?Ky(N,s.type,s.stateNode):Qy(N,x,s.memoizedProps)):x===null&&s.stateNode!==null&&Ff(s,s.memoizedProps,h.memoizedProps)}break;case 27:Li(c,s),xi(s),x&512&&(En||h===null||ns(h,h.return)),h!==null&&x&4&&Ff(s,s.memoizedProps,h.memoizedProps);break;case 5:if(Li(c,s),xi(s),x&512&&(En||h===null||ns(h,h.return)),s.flags&32){N=s.stateNode;try{Ai(N,"")}catch(Le){Un(s,s.return,Le)}}x&4&&s.stateNode!=null&&(N=s.memoizedProps,Ff(s,N,h!==null?h.memoizedProps:N)),x&1024&&(Ms=!0);break;case 6:if(Li(c,s),xi(s),x&4){if(s.stateNode===null)throw Error(r(162));x=s.memoizedProps,h=s.stateNode;try{h.nodeValue=x}catch(Le){Un(s,s.return,Le)}}break;case 3:if(Xc=null,N=ra,ra=Vt(c.containerInfo),Li(c,s),ra=N,xi(s),x&4&&h!==null&&h.memoizedState.isDehydrated)try{kd(c.containerInfo)}catch(Le){Un(s,s.return,Le)}Ms&&(Ms=!1,oy(s));break;case 4:x=ra,ra=Vt(s.stateNode.containerInfo),Li(c,s),xi(s),ra=x;break;case 12:Li(c,s),xi(s);break;case 13:Li(c,s),xi(s),s.child.flags&8192&&s.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(Yp=ct()),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,$p(s,x)));break;case 22:N=s.memoizedState!==null;var xe=h!==null&&h.memoizedState!==null,Oe=rs,We=En;if(rs=Oe||N,En=We||xe,Li(c,s),En=We,rs=Oe,xi(s),x&8192)e:for(c=s.stateNode,c._visibility=N?c._visibility&-2:c._visibility|1,N&&(h===null||xe||rs||En||zl(s)),h=null,c=s;;){if(c.tag===5||c.tag===26){if(h===null){xe=h=c;try{if(A=xe.stateNode,N)q=A.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{K=xe.stateNode;var Ze=xe.memoizedProps.style,$e=Ze!=null&&Ze.hasOwnProperty("display")?Ze.display:null;K.style.display=$e==null||typeof $e=="boolean"?"":(""+$e).trim()}}catch(Le){Un(xe,xe.return,Le)}}}else if(c.tag===6){if(h===null){xe=c;try{xe.stateNode.nodeValue=N?"":xe.memoizedProps}catch(Le){Un(xe,xe.return,Le)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===s)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break e;for(;c.sibling===null;){if(c.return===null||c.return===s)break e;h===c&&(h=null),c=c.return}h===c&&(h=null),c.sibling.return=c.return,c=c.sibling}x&4&&(x=s.updateQueue,x!==null&&(h=x.retryQueue,h!==null&&(x.retryQueue=null,$p(s,h))));break;case 19:Li(c,s),xi(s),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,$p(s,x)));break;case 30:break;case 21:break;default:Li(c,s),xi(s)}}function xi(s){var c=s.flags;if(c&2){try{for(var h,x=s.return;x!==null;){if(Oc(x)){h=x;break}x=x.return}if(h==null)throw Error(r(160));switch(h.tag){case 27:var N=h.stateNode,A=sd(s);od(s,A,N);break;case 5:var q=h.stateNode;h.flags&32&&(Ai(q,""),h.flags&=-33);var K=sd(s);od(s,K,q);break;case 3:case 4:var xe=h.stateNode.containerInfo,Oe=sd(s);$f(s,Oe,xe);break;default:throw Error(r(161))}}catch(We){Un(s,s.return,We)}s.flags&=-3}c&4096&&(s.flags&=-4097)}function oy(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var c=s;oy(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),s=s.sibling}}function To(s,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)ry(s,c.alternate,c),c=c.sibling}function zl(s){for(s=s.child;s!==null;){var c=s;switch(c.tag){case 0:case 11:case 14:case 15:ko(4,c,c.return),zl(c);break;case 1:ns(c,c.return);var h=c.stateNode;typeof h.componentWillUnmount=="function"&&Fp(c,c.return,h),zl(c);break;case 27:bd(c.stateNode);case 26:case 5:ns(c,c.return),zl(c);break;case 22:c.memoizedState===null&&zl(c);break;case 30:zl(c);break;default:zl(c)}s=s.sibling}}function Ls(s,c,h){for(h=h&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var x=c.alternate,N=s,A=c,q=A.flags;switch(A.tag){case 0:case 11:case 15:Ls(N,A,h),ad(4,A);break;case 1:if(Ls(N,A,h),x=A,N=x.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(Oe){Un(x,x.return,Oe)}if(x=A,N=x.updateQueue,N!==null){var K=x.stateNode;try{var xe=N.shared.hiddenCallbacks;if(xe!==null)for(N.shared.hiddenCallbacks=null,N=0;N<xe.length;N++)_g(xe[N],K)}catch(Oe){Un(x,x.return,Oe)}}h&&q&64&&ty(A),Mc(A,A.return);break;case 27:ld(A);case 26:case 5:Ls(N,A,h),h&&x===null&&q&4&&Lf(A),Mc(A,A.return);break;case 12:Ls(N,A,h);break;case 13:Ls(N,A,h),h&&q&4&&sy(N,A);break;case 22:A.memoizedState===null&&Ls(N,A,h),Mc(A,A.return);break;case 30:break;default:Ls(N,A,h)}c=c.sibling}}function Up(s,c){var h=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),s=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(s=c.memoizedState.cachePool.pool),s!==h&&(s!=null&&s.refCount++,h!=null&&Ru(h))}function Bp(s,c){s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&Ru(s))}function is(s,c,h,x){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)ly(s,c,h,x),c=c.sibling}function ly(s,c,h,x){var N=c.flags;switch(c.tag){case 0:case 11:case 15:is(s,c,h,x),N&2048&&ad(9,c);break;case 1:is(s,c,h,x);break;case 3:is(s,c,h,x),N&2048&&(s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&Ru(s)));break;case 12:if(N&2048){is(s,c,h,x),s=c.stateNode;try{var A=c.memoizedProps,q=A.id,K=A.onPostCommit;typeof K=="function"&&K(q,c.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(xe){Un(c,c.return,xe)}}else is(s,c,h,x);break;case 13:is(s,c,h,x);break;case 23:break;case 22:A=c.stateNode,q=c.alternate,c.memoizedState!==null?A._visibility&2?is(s,c,h,x):cd(s,c):A._visibility&2?is(s,c,h,x):(A._visibility|=2,Lc(s,c,h,x,(c.subtreeFlags&10256)!==0)),N&2048&&Up(q,c);break;case 24:is(s,c,h,x),N&2048&&Bp(c.alternate,c);break;default:is(s,c,h,x)}}function Lc(s,c,h,x,N){for(N=N&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var A=s,q=c,K=h,xe=x,Oe=q.flags;switch(q.tag){case 0:case 11:case 15:Lc(A,q,K,xe,N),ad(8,q);break;case 23:break;case 22:var We=q.stateNode;q.memoizedState!==null?We._visibility&2?Lc(A,q,K,xe,N):cd(A,q):(We._visibility|=2,Lc(A,q,K,xe,N)),N&&Oe&2048&&Up(q.alternate,q);break;case 24:Lc(A,q,K,xe,N),N&&Oe&2048&&Bp(q.alternate,q);break;default:Lc(A,q,K,xe,N)}c=c.sibling}}function cd(s,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var h=s,x=c,N=x.flags;switch(x.tag){case 22:cd(h,x),N&2048&&Up(x.alternate,x);break;case 24:cd(h,x),N&2048&&Bp(x.alternate,x);break;default:cd(h,x)}c=c.sibling}}var Hr=8192;function Fc(s){if(s.subtreeFlags&Hr)for(s=s.child;s!==null;)cy(s),s=s.sibling}function cy(s){switch(s.tag){case 26:Fc(s),s.flags&Hr&&s.memoizedState!==null&&Cv(ra,s.memoizedState,s.memoizedProps);break;case 5:Fc(s);break;case 3:case 4:var c=ra;ra=Vt(s.stateNode.containerInfo),Fc(s),ra=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Hr,Hr=16777216,Fc(s),Hr=c):Fc(s));break;default:Fc(s)}}function uy(s){var c=s.alternate;if(c!==null&&(s=c.child,s!==null)){c.child=null;do c=s.sibling,s.sibling=null,s=c;while(s!==null)}}function $c(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var h=0;h<c.length;h++){var x=c[h];Cr=x,fy(x,s)}uy(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)dy(s),s=s.sibling}function dy(s){switch(s.tag){case 0:case 11:case 15:$c(s),s.flags&2048&&ko(9,s,s.return);break;case 3:$c(s);break;case 12:$c(s);break;case 22:var c=s.stateNode;s.memoizedState!==null&&c._visibility&2&&(s.return===null||s.return.tag!==13)?(c._visibility&=-3,zf(s)):$c(s);break;default:$c(s)}}function zf(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var h=0;h<c.length;h++){var x=c[h];Cr=x,fy(x,s)}uy(s)}for(s=s.child;s!==null;){switch(c=s,c.tag){case 0:case 11:case 15:ko(8,c,c.return),zf(c);break;case 22:h=c.stateNode,h._visibility&2&&(h._visibility&=-3,zf(c));break;default:zf(c)}s=s.sibling}}function fy(s,c){for(;Cr!==null;){var h=Cr;switch(h.tag){case 0:case 11:case 15:ko(8,h,c);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var x=h.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Ru(h.memoizedState.cache)}if(x=h.child,x!==null)x.return=h,Cr=x;else e:for(h=s;Cr!==null;){x=Cr;var N=x.sibling,A=x.return;if(iy(x),x===h){Cr=null;break e}if(N!==null){N.return=A,Cr=N;break e}Cr=A}}}var ev={getCacheForType:function(s){var c=cr($n),h=c.data.get(s);return h===void 0&&(h=s(),c.data.set(s,h)),h}},qp=typeof WeakMap=="function"?WeakMap:Map,Pn=0,Gn=null,an=null,bn=0,Dn=0,Fi=null,Eo=!1,zc=!1,Vp=!1,Fs=0,dr=0,Ao=0,Ul=0,Hp=0,ia=0,Uc=0,ud=null,bi=null,Gp=!1,Yp=0,Bc=1/0,dd=null,Po=null,$r=0,Do=null,qc=null,Vc=0,Wp=0,Qp=null,hy=null,Hc=0,Jp=null;function Gr(){if((Pn&2)!==0&&bn!==0)return bn&-bn;if(V.T!==null){var s=_c;return s!==0?s:Yf()}return Wn()}function py(){ia===0&&(ia=(bn&536870912)===0||on?mt():536870912);var s=Oi.current;return s!==null&&(s.flags|=32),ia}function $i(s,c,h){(s===Gn&&(Dn===2||Dn===9)||s.cancelPendingCommit!==null)&&(Gc(s,0),Io(s,bn,ia,!1)),gn(s,h),((Pn&2)===0||s!==Gn)&&(s===Gn&&((Pn&2)===0&&(Ul|=h),dr===4&&Io(s,bn,ia,!1)),as(s))}function my(s,c,h){if((Pn&6)!==0)throw Error(r(327));var x=!h&&(c&124)===0&&(c&s.expiredLanes)===0||ze(s,c),N=x?rv(s,c):Zp(s,c,!0),A=x;do{if(N===0){zc&&!x&&Io(s,c,0,!1);break}else{if(h=s.current.alternate,A&&!tv(h)){N=Zp(s,c,!1),A=!1;continue}if(N===2){if(A=c,s.errorRecoveryDisabledLanes&A)var q=0;else q=s.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){c=q;e:{var K=s;N=ud;var xe=K.current.memoizedState.isDehydrated;if(xe&&(Gc(K,q).flags|=256),q=Zp(K,q,!1),q!==2){if(Vp&&!xe){K.errorRecoveryDisabledLanes|=A,Ul|=A,N=4;break e}A=bi,bi=N,A!==null&&(bi===null?bi=A:bi.push.apply(bi,A))}N=q}if(A=!1,N!==2)continue}}if(N===1){Gc(s,0),Io(s,c,0,!0);break}e:{switch(x=s,A=N,A){case 0:case 1:throw Error(r(345));case 4:if((c&4194048)!==c)break;case 6:Io(x,c,ia,!Eo);break e;case 2:bi=null;break;case 3:case 5:break;default:throw Error(r(329))}if((c&62914560)===c&&(N=Yp+300-ct(),10<N)){if(Io(x,c,ia,!Eo),De(x,0,!0)!==0)break e;x.timeoutHandle=$y(gy.bind(null,x,h,bi,dd,Gp,c,ia,Ul,Uc,Eo,A,2,-0,0),N);break e}gy(x,h,bi,dd,Gp,c,ia,Ul,Uc,Eo,A,0,-0,0)}}break}while(!0);as(s)}function gy(s,c,h,x,N,A,q,K,xe,Oe,We,Ze,$e,Le){if(s.timeoutHandle=-1,Ze=c.subtreeFlags,(Ze&8192||(Ze&16785408)===16785408)&&(Ir={stylesheets:null,count:0,unsuspend:Nv},cy(c),Ze=jv(),Ze!==null)){s.cancelPendingCommit=Ze(fd.bind(null,s,c,A,h,x,N,q,K,xe,We,1,$e,Le)),Io(s,A,q,!Oe);return}fd(s,c,A,h,x,N,q,K,xe)}function tv(s){for(var c=s;;){var h=c.tag;if((h===0||h===11||h===15)&&c.flags&16384&&(h=c.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var x=0;x<h.length;x++){var N=h[x],A=N.getSnapshot;N=N.value;try{if(!ei(A(),N))return!1}catch{return!1}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Io(s,c,h,x){c&=~Hp,c&=~Ul,s.suspendedLanes|=c,s.pingedLanes&=~c,x&&(s.warmLanes|=c),x=s.expirationTimes;for(var N=c;0<N;){var A=31-Qe(N),q=1<<A;x[A]=-1,N&=~q}h!==0&&bt(s,h,c)}function Uf(){return(Pn&6)===0?(md(0),!1):!0}function Kp(){if(an!==null){if(Dn===0)var s=an.return;else s=an,J=vo=null,ff(s),Nr=null,gi=0,s=an;for(;s!==null;)ey(s.alternate,s),s=s.return;an=null}}function Gc(s,c){var h=s.timeoutHandle;h!==-1&&(s.timeoutHandle=-1,pv(h)),h=s.cancelPendingCommit,h!==null&&(s.cancelPendingCommit=null,h()),Kp(),Gn=s,an=h=ni(s.current,null),bn=c,Dn=0,Fi=null,Eo=!1,zc=ze(s,c),Vp=!1,Uc=ia=Hp=Ul=Ao=dr=0,bi=ud=null,Gp=!1,(c&8)!==0&&(c|=c&32);var x=s.entangledLanes;if(x!==0)for(s=s.entanglements,x&=c;0<x;){var N=31-Qe(x),A=1<<N;c|=s[N],x&=~A}return Fs=c,St(),h}function yy(s,c){Jt=null,V.H=Qu,c===ri||c===cf?(c=Cg(),Dn=3):c===Sg?(c=Cg(),Dn=4):Dn=c===Wg?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,Fi=c,an===null&&(dr=1,ed(s,Se(c,s.current)))}function xy(){var s=V.H;return V.H=Qu,s===null?Qu:s}function by(){var s=V.A;return V.A=ev,s}function Xp(){dr=4,Eo||(bn&4194048)!==bn&&Oi.current!==null||(zc=!0),(Ao&134217727)===0&&(Ul&134217727)===0||Gn===null||Io(Gn,bn,ia,!1)}function Zp(s,c,h){var x=Pn;Pn|=2;var N=xy(),A=by();(Gn!==s||bn!==c)&&(dd=null,Gc(s,c)),c=!1;var q=dr;e:do try{if(Dn!==0&&an!==null){var K=an,xe=Fi;switch(Dn){case 8:Kp(),q=6;break e;case 3:case 2:case 9:case 6:Oi.current===null&&(c=!0);var Oe=Dn;if(Dn=0,Fi=null,Yc(s,K,xe,Oe),h&&zc){q=0;break e}break;default:Oe=Dn,Dn=0,Fi=null,Yc(s,K,xe,Oe)}}nv(),q=dr;break}catch(We){yy(s,We)}while(!0);return c&&s.shellSuspendCounter++,J=vo=null,Pn=x,V.H=N,V.A=A,an===null&&(Gn=null,bn=0,St()),q}function nv(){for(;an!==null;)em(an)}function rv(s,c){var h=Pn;Pn|=2;var x=xy(),N=by();Gn!==s||bn!==c?(dd=null,Bc=ct()+500,Gc(s,c)):zc=ze(s,c);e:do try{if(Dn!==0&&an!==null){c=an;var A=Fi;t:switch(Dn){case 1:Dn=0,Fi=null,Yc(s,c,A,1);break;case 2:case 9:if(Ng(A)){Dn=0,Fi=null,wy(c);break}c=function(){Dn!==2&&Dn!==9||Gn!==s||(Dn=7),as(s)},A.then(c,c);break e;case 3:Dn=7;break e;case 4:Dn=5;break e;case 7:Ng(A)?(Dn=0,Fi=null,wy(c)):(Dn=0,Fi=null,Yc(s,c,A,7));break;case 5:var q=null;switch(an.tag){case 26:q=an.memoizedState;case 5:case 27:var K=an;if(!q||kr(q)){Dn=0,Fi=null;var xe=K.sibling;if(xe!==null)an=xe;else{var Oe=K.return;Oe!==null?(an=Oe,Bf(Oe)):an=null}break t}}Dn=0,Fi=null,Yc(s,c,A,5);break;case 6:Dn=0,Fi=null,Yc(s,c,A,6);break;case 8:Kp(),dr=6;break e;default:throw Error(r(462))}}vy();break}catch(We){yy(s,We)}while(!0);return J=vo=null,V.H=x,V.A=N,Pn=h,an!==null?0:(Gn=null,bn=0,St(),dr)}function vy(){for(;an!==null&&!rt();)em(an)}function em(s){var c=Rf(s.alternate,s,Fs);s.memoizedProps=s.pendingProps,c===null?Bf(s):an=c}function wy(s){var c=s,h=c.alternate;switch(c.tag){case 15:case 0:c=Df(h,c,c.pendingProps,c.type,void 0,bn);break;case 11:c=Df(h,c,c.pendingProps,c.type.render,c.ref,bn);break;case 5:ff(c);default:ey(h,c),c=an=Tu(c,Fs),c=Rf(h,c,Fs)}s.memoizedProps=s.pendingProps,c===null?Bf(s):an=c}function Yc(s,c,h,x){J=vo=null,ff(c),Nr=null,gi=0;var N=c.return;try{if(Yg(s,N,c,h,bn)){dr=1,ed(s,Se(h,s.current)),an=null;return}}catch(A){if(N!==null)throw an=N,A;dr=1,ed(s,Se(h,s.current)),an=null;return}c.flags&32768?(on||x===1?s=!0:zc||(bn&536870912)!==0?s=!1:(Eo=s=!0,(x===2||x===9||x===3||x===6)&&(x=Oi.current,x!==null&&x.tag===13&&(x.flags|=16384))),Sy(c,s)):Bf(c)}function Bf(s){var c=s;do{if((c.flags&32768)!==0){Sy(c,Eo);return}s=c.return;var h=Xg(c.alternate,c,Fs);if(h!==null){an=h;return}if(c=c.sibling,c!==null){an=c;return}an=c=s}while(c!==null);dr===0&&(dr=5)}function Sy(s,c){do{var h=Zg(s.alternate,s);if(h!==null){h.flags&=32767,an=h;return}if(h=s.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!c&&(s=s.sibling,s!==null)){an=s;return}an=s=h}while(s!==null);dr=6,an=null}function fd(s,c,h,x,N,A,q,K,xe){s.cancelPendingCommit=null;do qf();while($r!==0);if((Pn&6)!==0)throw Error(r(327));if(c!==null){if(c===s.current)throw Error(r(177));if(A=c.lanes|c.childLanes,A|=Ct,Cn(s,h,A,q,K,xe),s===Gn&&(an=Gn=null,bn=0),qc=c,Do=s,Vc=h,Wp=A,Qp=N,hy=x,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Ay(je,function(){return ky(),null})):(s.callbackNode=null,s.callbackPriority=0),x=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||x){x=V.T,V.T=null,N=se.p,se.p=2,q=Pn,Pn|=4;try{Xb(s,c,h)}finally{Pn=q,se.p=N,V.T=x}}$r=1,Ny(),Cy(),jy()}}function Ny(){if($r===1){$r=0;var s=Do,c=qc,h=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||h){h=V.T,V.T=null;var x=se.p;se.p=2;var N=Pn;Pn|=4;try{zp(c,s);var A=Jf,q=ef(s.containerInfo),K=A.focusedElem,xe=A.selectionRange;if(q!==K&&K&&K.ownerDocument&&Ss(K.ownerDocument.documentElement,K)){if(xe!==null&&wl(K)){var Oe=xe.start,We=xe.end;if(We===void 0&&(We=Oe),"selectionStart"in K)K.selectionStart=Oe,K.selectionEnd=Math.min(We,K.value.length);else{var Ze=K.ownerDocument||document,$e=Ze&&Ze.defaultView||window;if($e.getSelection){var Le=$e.getSelection(),Dt=K.textContent.length,Pt=Math.min(xe.start,Dt),Ln=xe.end===void 0?Pt:Math.min(xe.end,Dt);!Le.extend&&Pt>Ln&&(q=Ln,Ln=Pt,Pt=q);var Ae=ju(K,Pt),Ce=ju(K,Ln);if(Ae&&Ce&&(Le.rangeCount!==1||Le.anchorNode!==Ae.node||Le.anchorOffset!==Ae.offset||Le.focusNode!==Ce.node||Le.focusOffset!==Ce.offset)){var Re=Ze.createRange();Re.setStart(Ae.node,Ae.offset),Le.removeAllRanges(),Pt>Ln?(Le.addRange(Re),Le.extend(Ce.node,Ce.offset)):(Re.setEnd(Ce.node,Ce.offset),Le.addRange(Re))}}}}for(Ze=[],Le=K;Le=Le.parentNode;)Le.nodeType===1&&Ze.push({element:Le,left:Le.scrollLeft,top:Le.scrollTop});for(typeof K.focus=="function"&&K.focus(),K=0;K<Ze.length;K++){var Je=Ze[K];Je.element.scrollLeft=Je.left,Je.element.scrollTop=Je.top}}rh=!!ka,Jf=ka=null}finally{Pn=N,se.p=x,V.T=h}}s.current=c,$r=2}}function Cy(){if($r===2){$r=0;var s=Do,c=qc,h=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||h){h=V.T,V.T=null;var x=se.p;se.p=2;var N=Pn;Pn|=4;try{ry(s,c.alternate,c)}finally{Pn=N,se.p=x,V.T=h}}$r=3}}function jy(){if($r===4||$r===3){$r=0,lt();var s=Do,c=qc,h=Vc,x=hy;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?$r=5:($r=0,qc=Do=null,_y(s,s.pendingLanes));var N=s.pendingLanes;if(N===0&&(Po=null),vt(h),c=c.stateNode,me&&typeof me.onCommitFiberRoot=="function")try{me.onCommitFiberRoot(Q,c,void 0,(c.current.flags&128)===128)}catch{}if(x!==null){c=V.T,N=se.p,se.p=2,V.T=null;try{for(var A=s.onRecoverableError,q=0;q<x.length;q++){var K=x[q];A(K.value,{componentStack:K.stack})}}finally{V.T=c,se.p=N}}(Vc&3)!==0&&qf(),as(s),N=s.pendingLanes,(h&4194090)!==0&&(N&42)!==0?s===Jp?Hc++:(Hc=0,Jp=s):Hc=0,md(0)}}function _y(s,c){(s.pooledCacheLanes&=c)===0&&(c=s.pooledCache,c!=null&&(s.pooledCache=null,Ru(c)))}function qf(s){return Ny(),Cy(),jy(),ky()}function ky(){if($r!==5)return!1;var s=Do,c=Wp;Wp=0;var h=vt(Vc),x=V.T,N=se.p;try{se.p=32>h?32:h,V.T=null,h=Qp,Qp=null;var A=Do,q=Vc;if($r=0,qc=Do=null,Vc=0,(Pn&6)!==0)throw Error(r(331));var K=Pn;if(Pn|=4,dy(A.current),ly(A,A.current,q,h),Pn=K,md(0,!1),me&&typeof me.onPostCommitFiberRoot=="function")try{me.onPostCommitFiberRoot(Q,A)}catch{}return!0}finally{se.p=N,V.T=x,_y(s,c)}}function Ty(s,c,h){c=Se(h,c),c=Tf(s.stateNode,c,2),s=Ts(s,c,2),s!==null&&(gn(s,2),as(s))}function Un(s,c,h){if(s.tag===3)Ty(s,s,h);else for(;c!==null;){if(c.tag===3){Ty(c,s,h);break}else if(c.tag===1){var x=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Po===null||!Po.has(x))){s=Se(h,s),h=Ip(2),x=Ts(c,h,2),x!==null&&(Gg(h,x,c,s),gn(x,2),as(x));break}}c=c.return}}function tm(s,c,h){var x=s.pingCache;if(x===null){x=s.pingCache=new qp;var N=new Set;x.set(c,N)}else N=x.get(c),N===void 0&&(N=new Set,x.set(c,N));N.has(h)||(Vp=!0,N.add(h),s=iv.bind(null,s,c,h),c.then(s,s))}function iv(s,c,h){var x=s.pingCache;x!==null&&x.delete(c),s.pingedLanes|=s.suspendedLanes&h,s.warmLanes&=~h,Gn===s&&(bn&h)===h&&(dr===4||dr===3&&(bn&62914560)===bn&&300>ct()-Yp?(Pn&2)===0&&Gc(s,0):Hp|=h,Uc===bn&&(Uc=0)),as(s)}function Ey(s,c){c===0&&(c=Nt()),s=Cs(s,c),s!==null&&(gn(s,c),as(s))}function Vf(s){var c=s.memoizedState,h=0;c!==null&&(h=c.retryLane),Ey(s,h)}function av(s,c){var h=0;switch(s.tag){case 13:var x=s.stateNode,N=s.memoizedState;N!==null&&(h=N.retryLane);break;case 19:x=s.stateNode;break;case 22:x=s.stateNode._retryCache;break;default:throw Error(r(314))}x!==null&&x.delete(c),Ey(s,h)}function Ay(s,c){return Ie(s,c)}var hd=null,Ro=null,Hf=!1,pd=!1,Gf=!1,Mo=0;function as(s){s!==Ro&&s.next===null&&(Ro===null?hd=Ro=s:Ro=Ro.next=s),pd=!0,Hf||(Hf=!0,nm())}function md(s,c){if(!Gf&&pd){Gf=!0;do for(var h=!1,x=hd;x!==null;){if(s!==0){var N=x.pendingLanes;if(N===0)var A=0;else{var q=x.suspendedLanes,K=x.pingedLanes;A=(1<<31-Qe(42|s)+1)-1,A&=N&~(q&~K),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(h=!0,Dy(x,A))}else A=bn,A=De(x,x===Gn?A:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(A&3)===0||ze(x,A)||(h=!0,Dy(x,A));x=x.next}while(h);Gf=!1}}function sv(){gd()}function gd(){pd=Hf=!1;var s=0;Mo!==0&&(hv()&&(s=Mo),Mo=0);for(var c=ct(),h=null,x=hd;x!==null;){var N=x.next,A=yd(x,c);A===0?(x.next=null,h===null?hd=N:h.next=N,N===null&&(Ro=h)):(h=x,(s!==0||(A&3)!==0)&&(pd=!0)),x=N}md(s)}function yd(s,c){for(var h=s.suspendedLanes,x=s.pingedLanes,N=s.expirationTimes,A=s.pendingLanes&-62914561;0<A;){var q=31-Qe(A),K=1<<q,xe=N[q];xe===-1?((K&h)===0||(K&x)!==0)&&(N[q]=nt(K,c)):xe<=c&&(s.expiredLanes|=K),A&=~K}if(c=Gn,h=bn,h=De(s,s===c?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x=s.callbackNode,h===0||s===c&&(Dn===2||Dn===9)||s.cancelPendingCommit!==null)return x!==null&&x!==null&&Fe(x),s.callbackNode=null,s.callbackPriority=0;if((h&3)===0||ze(s,h)){if(c=h&-h,c===s.callbackPriority)return c;switch(x!==null&&Fe(x),vt(h)){case 2:case 8:h=rn;break;case 32:h=je;break;case 268435456:h=Be;break;default:h=je}return x=Py.bind(null,s),h=Ie(h,x),s.callbackPriority=c,s.callbackNode=h,c}return x!==null&&x!==null&&Fe(x),s.callbackPriority=2,s.callbackNode=null,2}function Py(s,c){if($r!==0&&$r!==5)return s.callbackNode=null,s.callbackPriority=0,null;var h=s.callbackNode;if(qf()&&s.callbackNode!==h)return null;var x=bn;return x=De(s,s===Gn?x:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x===0?null:(my(s,x,c),yd(s,ct()),s.callbackNode!=null&&s.callbackNode===h?Py.bind(null,s):null)}function Dy(s,c){if(qf())return null;my(s,c,!0)}function nm(){mv(function(){(Pn&6)!==0?Ie(Ht,sv):gd()})}function Yf(){return Mo===0&&(Mo=mt()),Mo}function Iy(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:xs(""+s)}function Ry(s,c){var h=c.ownerDocument.createElement("input");return h.name=c.name,h.value=c.value,s.id&&h.setAttribute("form",s.id),c.parentNode.insertBefore(h,c),s=new FormData(s),h.parentNode.removeChild(h),s}function ov(s,c,h,x,N){if(c==="submit"&&h&&h.stateNode===N){var A=Iy((N[vr]||null).action),q=x.submitter;q&&(c=(c=q[vr]||null)?Iy(c.formAction):q.getAttribute("formAction"),c!==null&&(A=c,q=null));var K=new fl("action","action",null,x,N);s.push({event:K,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Mo!==0){var xe=q?Ry(N,q):new FormData(N);Yu(h,{pending:!0,data:xe,method:N.method,action:A},null,xe)}}else typeof A=="function"&&(K.preventDefault(),xe=q?Ry(N,q):new FormData(N),Yu(h,{pending:!0,data:xe,method:N.method,action:A},A,xe))},currentTarget:N}]})}}for(var rm=0;rm<ee.length;rm++){var im=ee[rm],lv=im.toLowerCase(),cv=im[0].toUpperCase()+im.slice(1);he(lv,"on"+cv)}he(Sc,"onAnimationEnd"),he(tf,"onAnimationIteration"),he(ti,"onAnimationStart"),he("dblclick","onDoubleClick"),he("focusin","onFocus"),he("focusout","onBlur"),he(Nc,"onTransitionRun"),he(np,"onTransitionStart"),he(Ns,"onTransitionCancel"),he(go,"onTransitionEnd"),Zs("onMouseEnter",["mouseout","mouseover"]),Zs("onMouseLeave",["mouseout","mouseover"]),Zs("onPointerEnter",["pointerout","pointerover"]),Zs("onPointerLeave",["pointerout","pointerover"]),ps("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ps("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ps("onBeforeInput",["compositionend","keypress","textInput","paste"]),ps("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ps("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ps("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(xd));function My(s,c){c=(c&4)!==0;for(var h=0;h<s.length;h++){var x=s[h],N=x.event;x=x.listeners;e:{var A=void 0;if(c)for(var q=x.length-1;0<=q;q--){var K=x[q],xe=K.instance,Oe=K.currentTarget;if(K=K.listener,xe!==A&&N.isPropagationStopped())break e;A=K,N.currentTarget=Oe;try{A(N)}catch(We){Fl(We)}N.currentTarget=null,A=xe}else for(q=0;q<x.length;q++){if(K=x[q],xe=K.instance,Oe=K.currentTarget,K=K.listener,xe!==A&&N.isPropagationStopped())break e;A=K,N.currentTarget=Oe;try{A(N)}catch(We){Fl(We)}N.currentTarget=null,A=xe}}}}function sn(s,c){var h=c[xu];h===void 0&&(h=c[xu]=new Set);var x=s+"__bubble";h.has(x)||(Oy(c,s,2,!1),h.add(x))}function am(s,c,h){var x=0;c&&(x|=4),Oy(h,s,x,c)}var vi="_reactListening"+Math.random().toString(36).slice(2);function sm(s){if(!s[vi]){s[vi]=!0,Vd.forEach(function(h){h!=="selectionchange"&&(uv.has(h)||am(h,!1,s),am(h,!0,s))});var c=s.nodeType===9?s:s.ownerDocument;c===null||c[vi]||(c[vi]=!0,am("selectionchange",!1,c))}}function Oy(s,c,h,x){switch(tx(c)){case 2:var N=Tv;break;case 8:N=eu;break;default:N=gm}h=N.bind(null,c,h,s),N=void 0,!ao||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(N=!0),x?N!==void 0?s.addEventListener(c,h,{capture:!0,passive:N}):s.addEventListener(c,h,!0):N!==void 0?s.addEventListener(c,h,{passive:N}):s.addEventListener(c,h,!1)}function $s(s,c,h,x,N){var A=x;if((c&1)===0&&(c&2)===0&&x!==null)e:for(;;){if(x===null)return;var q=x.tag;if(q===3||q===4){var K=x.stateNode.containerInfo;if(K===N)break;if(q===4)for(q=x.return;q!==null;){var xe=q.tag;if((xe===3||xe===4)&&q.stateNode.containerInfo===N)return;q=q.return}for(;K!==null;){if(q=hs(K),q===null)return;if(xe=q.tag,xe===5||xe===6||xe===26||xe===27){x=A=q;continue e}K=K.parentNode}}x=x.return}uc(function(){var Oe=A,We=ol(h),Ze=[];e:{var $e=yo.get(s);if($e!==void 0){var Le=fl,Dt=s;switch(s){case"keypress":if(xn(h)===0)break e;case"keydown":case"keyup":Le=xc;break;case"focusin":Dt="focus",Le=wn;break;case"focusout":Dt="blur",Le=wn;break;case"beforeblur":case"afterblur":Le=wn;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Le=Va;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Le=hl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Le=Jh;break;case Sc:case tf:case ti:Le=pl;break;case go:Le=Kh;break;case"scroll":case"scrollend":Le=Wd;break;case"wheel":Le=uo;break;case"copy":case"cut":case"paste":Le=lo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Le=Wi;break;case"toggle":case"beforetoggle":Le=Ga}var Pt=(c&4)!==0,Ln=!Pt&&(s==="scroll"||s==="scrollend"),Ae=Pt?$e!==null?$e+"Capture":null:$e;Pt=[];for(var Ce=Oe,Re;Ce!==null;){var Je=Ce;if(Re=Je.stateNode,Je=Je.tag,Je!==5&&Je!==26&&Je!==27||Re===null||Ae===null||(Je=Jr(Ce,Ae),Je!=null&&Pt.push(zt(Ce,Je,Re))),Ln)break;Ce=Ce.return}0<Pt.length&&($e=new Le($e,Dt,null,h,We),Ze.push({event:$e,listeners:Pt}))}}if((c&7)===0){e:{if($e=s==="mouseover"||s==="pointerover",Le=s==="mouseout"||s==="pointerout",$e&&h!==io&&(Dt=h.relatedTarget||h.fromElement)&&(hs(Dt)||Dt[Ti]))break e;if((Le||$e)&&($e=We.window===We?We:($e=We.ownerDocument)?$e.defaultView||$e.parentWindow:window,Le?(Dt=h.relatedTarget||h.toElement,Le=Oe,Dt=Dt?hs(Dt):null,Dt!==null&&(Ln=o(Dt),Pt=Dt.tag,Dt!==Ln||Pt!==5&&Pt!==27&&Pt!==6)&&(Dt=null)):(Le=null,Dt=Oe),Le!==Dt)){if(Pt=Va,Je="onMouseLeave",Ae="onMouseEnter",Ce="mouse",(s==="pointerout"||s==="pointerover")&&(Pt=Wi,Je="onPointerLeave",Ae="onPointerEnter",Ce="pointer"),Ln=Le==null?$e:Ks(Le),Re=Dt==null?$e:Ks(Dt),$e=new Pt(Je,Ce+"leave",Le,h,We),$e.target=Ln,$e.relatedTarget=Re,Je=null,hs(We)===Oe&&(Pt=new Pt(Ae,Ce+"enter",Dt,h,We),Pt.target=Re,Pt.relatedTarget=Ln,Je=Pt),Ln=Je,Le&&Dt)t:{for(Pt=Le,Ae=Dt,Ce=0,Re=Pt;Re;Re=jr(Re))Ce++;for(Re=0,Je=Ae;Je;Je=jr(Je))Re++;for(;0<Ce-Re;)Pt=jr(Pt),Ce--;for(;0<Re-Ce;)Ae=jr(Ae),Re--;for(;Ce--;){if(Pt===Ae||Ae!==null&&Pt===Ae.alternate)break t;Pt=jr(Pt),Ae=jr(Ae)}Pt=null}else Pt=null;Le!==null&&fr(Ze,$e,Le,Pt,!1),Dt!==null&&Ln!==null&&fr(Ze,Ln,Dt,Pt,!0)}}e:{if($e=Oe?Ks(Oe):window,Le=$e.nodeName&&$e.nodeName.toLowerCase(),Le==="select"||Le==="input"&&$e.type==="file")var gt=Qi;else if(xl($e))if(Su)gt=Zh;else{gt=Qa;var en=Cu}else Le=$e.nodeName,!Le||Le.toLowerCase()!=="input"||$e.type!=="checkbox"&&$e.type!=="radio"?Oe&&ro(Oe.elementType)&&(gt=Qi):gt=vl;if(gt&&(gt=gt(s,Oe))){ho(Ze,gt,h,We);break e}en&&en(s,$e,Oe),s==="focusout"&&Oe&&$e.type==="number"&&Oe.memoizedProps.value!=null&&gs($e,"number",$e.value)}switch(en=Oe?Ks(Oe):window,s){case"focusin":(xl(en)||en.contentEditable==="true")&&(Ja=en,Ka=Oe,_e=null);break;case"focusout":_e=Ka=Ja=null;break;case"mousedown":Ge=!0;break;case"contextmenu":case"mouseup":case"dragend":Ge=!1,Ue(Ze,h,We);break;case"selectionchange":if(tp)break;case"keydown":case"keyup":Ue(Ze,h,We)}var wt;if(ml)e:{switch(s){case"compositionstart":var It="onCompositionStart";break e;case"compositionend":It="onCompositionEnd";break e;case"compositionupdate":It="onCompositionUpdate";break e}It=void 0}else Ya?Xd(s,h)&&(It="onCompositionEnd"):s==="keydown"&&h.keyCode===229&&(It="onCompositionStart");It&&(yl&&h.locale!=="ko"&&(Ya||It!=="onCompositionStart"?It==="onCompositionEnd"&&Ya&&(wt=fc()):(qa=We,ul="value"in qa?qa.value:qa.textContent,Ya=!0)),en=Wf(Oe,It),0<en.length&&(It=new Ur(It,s,null,h,We),Ze.push({event:It,listeners:en}),wt?It.data=wt:(wt=vc(h),wt!==null&&(It.data=wt)))),(wt=gl?Xh(s,h):Zd(s,h))&&(It=Wf(Oe,"onBeforeInput"),0<It.length&&(en=new Ur("onBeforeInput","beforeinput",null,h,We),Ze.push({event:en,listeners:It}),en.data=wt)),ov(Ze,s,Oe,h,We)}My(Ze,c)})}function zt(s,c,h){return{instance:s,listener:c,currentTarget:h}}function Wf(s,c){for(var h=c+"Capture",x=[];s!==null;){var N=s,A=N.stateNode;if(N=N.tag,N!==5&&N!==26&&N!==27||A===null||(N=Jr(s,h),N!=null&&x.unshift(zt(s,N,A)),N=Jr(s,c),N!=null&&x.push(zt(s,N,A))),s.tag===3)return x;s=s.return}return[]}function jr(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function fr(s,c,h,x,N){for(var A=c._reactName,q=[];h!==null&&h!==x;){var K=h,xe=K.alternate,Oe=K.stateNode;if(K=K.tag,xe!==null&&xe===x)break;K!==5&&K!==26&&K!==27||Oe===null||(xe=Oe,N?(Oe=Jr(h,A),Oe!=null&&q.unshift(zt(h,Oe,xe))):N||(Oe=Jr(h,A),Oe!=null&&q.push(zt(h,Oe,xe)))),h=h.return}q.length!==0&&s.push({event:c,listeners:q})}var dv=/\r\n?/g,Oo=/\u0000|\uFFFD/g;function Ly(s){return(typeof s=="string"?s:""+s).replace(dv,`
`).replace(Oo,"")}function Fy(s,c){return c=Ly(c),Ly(s)===c}function Qf(){}function On(s,c,h,x,N,A){switch(h){case"children":typeof x=="string"?c==="body"||c==="textarea"&&x===""||Ai(s,x):(typeof x=="number"||typeof x=="bigint")&&c!=="body"&&Ai(s,""+x);break;case"className":tl(s,"class",x);break;case"tabIndex":tl(s,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":tl(s,h,x);break;case"style":lc(s,x,A);break;case"data":if(c!=="object"){tl(s,"data",x);break}case"src":case"href":if(x===""&&(c!=="a"||h!=="href")){s.removeAttribute(h);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(h);break}x=xs(""+x),s.setAttribute(h,x);break;case"action":case"formAction":if(typeof x=="function"){s.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(h==="formAction"?(c!=="input"&&On(s,c,"name",N.name,N,null),On(s,c,"formEncType",N.formEncType,N,null),On(s,c,"formMethod",N.formMethod,N,null),On(s,c,"formTarget",N.formTarget,N,null)):(On(s,c,"encType",N.encType,N,null),On(s,c,"method",N.method,N,null),On(s,c,"target",N.target,N,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(h);break}x=xs(""+x),s.setAttribute(h,x);break;case"onClick":x!=null&&(s.onclick=Qf);break;case"onScroll":x!=null&&sn("scroll",s);break;case"onScrollEnd":x!=null&&sn("scrollend",s);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(h=x.__html,h!=null){if(N.children!=null)throw Error(r(60));s.innerHTML=h}}break;case"multiple":s.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":s.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){s.removeAttribute("xlink:href");break}h=xs(""+x),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(h,""+x):s.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(h,""):s.removeAttribute(h);break;case"capture":case"download":x===!0?s.setAttribute(h,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(h,x):s.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?s.setAttribute(h,x):s.removeAttribute(h);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?s.removeAttribute(h):s.setAttribute(h,x);break;case"popover":sn("beforetoggle",s),sn("toggle",s),Fa(s,"popover",x);break;case"xlinkActuate":Ei(s,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":Ei(s,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":Ei(s,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":Ei(s,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":Ei(s,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":Ei(s,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":Ei(s,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":Ei(s,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":Ei(s,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":Fa(s,"is",x);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=Yd.get(h)||h,Fa(s,h,x))}}function om(s,c,h,x,N,A){switch(h){case"style":lc(s,x,A);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(h=x.__html,h!=null){if(N.children!=null)throw Error(r(60));s.innerHTML=h}}break;case"children":typeof x=="string"?Ai(s,x):(typeof x=="number"||typeof x=="bigint")&&Ai(s,""+x);break;case"onScroll":x!=null&&sn("scroll",s);break;case"onScrollEnd":x!=null&&sn("scrollend",s);break;case"onClick":x!=null&&(s.onclick=Qf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Hd.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(N=h.endsWith("Capture"),c=h.slice(2,N?h.length-7:void 0),A=s[vr]||null,A=A!=null?A[h]:null,typeof A=="function"&&s.removeEventListener(c,A,N),typeof x=="function")){typeof A!="function"&&A!==null&&(h in s?s[h]=null:s.hasAttribute(h)&&s.removeAttribute(h)),s.addEventListener(c,x,N);break e}h in s?s[h]=x:x===!0?s.setAttribute(h,""):Fa(s,h,x)}}}function _r(s,c,h){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":sn("error",s),sn("load",s);var x=!1,N=!1,A;for(A in h)if(h.hasOwnProperty(A)){var q=h[A];if(q!=null)switch(A){case"src":x=!0;break;case"srcSet":N=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:On(s,c,A,q,h,null)}}N&&On(s,c,"srcSet",h.srcSet,h,null),x&&On(s,c,"src",h.src,h,null);return;case"input":sn("invalid",s);var K=A=q=N=null,xe=null,Oe=null;for(x in h)if(h.hasOwnProperty(x)){var We=h[x];if(We!=null)switch(x){case"name":N=We;break;case"type":q=We;break;case"checked":xe=We;break;case"defaultChecked":Oe=We;break;case"value":A=We;break;case"defaultValue":K=We;break;case"children":case"dangerouslySetInnerHTML":if(We!=null)throw Error(r(137,c));break;default:On(s,c,x,We,h,null)}}oc(s,A,K,xe,Oe,q,N,!1),il(s);return;case"select":sn("invalid",s),x=q=A=null;for(N in h)if(h.hasOwnProperty(N)&&(K=h[N],K!=null))switch(N){case"value":A=K;break;case"defaultValue":q=K;break;case"multiple":x=K;default:On(s,c,N,K,h,null)}c=A,h=q,s.multiple=!!x,c!=null?ys(s,!!x,c,!1):h!=null&&ys(s,!!x,h,!0);return;case"textarea":sn("invalid",s),A=N=x=null;for(q in h)if(h.hasOwnProperty(q)&&(K=h[q],K!=null))switch(q){case"value":x=K;break;case"defaultValue":N=K;break;case"children":A=K;break;case"dangerouslySetInnerHTML":if(K!=null)throw Error(r(91));break;default:On(s,c,q,K,h,null)}sl(s,x,N,A),il(s);return;case"option":for(xe in h)if(h.hasOwnProperty(xe)&&(x=h[xe],x!=null))switch(xe){case"selected":s.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:On(s,c,xe,x,h,null)}return;case"dialog":sn("beforetoggle",s),sn("toggle",s),sn("cancel",s),sn("close",s);break;case"iframe":case"object":sn("load",s);break;case"video":case"audio":for(x=0;x<xd.length;x++)sn(xd[x],s);break;case"image":sn("error",s),sn("load",s);break;case"details":sn("toggle",s);break;case"embed":case"source":case"link":sn("error",s),sn("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Oe in h)if(h.hasOwnProperty(Oe)&&(x=h[Oe],x!=null))switch(Oe){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:On(s,c,Oe,x,h,null)}return;default:if(ro(c)){for(We in h)h.hasOwnProperty(We)&&(x=h[We],x!==void 0&&om(s,c,We,x,h,void 0));return}}for(K in h)h.hasOwnProperty(K)&&(x=h[K],x!=null&&On(s,c,K,x,h,null))}function fv(s,c,h,x){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var N=null,A=null,q=null,K=null,xe=null,Oe=null,We=null;for(Le in h){var Ze=h[Le];if(h.hasOwnProperty(Le)&&Ze!=null)switch(Le){case"checked":break;case"value":break;case"defaultValue":xe=Ze;default:x.hasOwnProperty(Le)||On(s,c,Le,null,x,Ze)}}for(var $e in x){var Le=x[$e];if(Ze=h[$e],x.hasOwnProperty($e)&&(Le!=null||Ze!=null))switch($e){case"type":A=Le;break;case"name":N=Le;break;case"checked":Oe=Le;break;case"defaultChecked":We=Le;break;case"value":q=Le;break;case"defaultValue":K=Le;break;case"children":case"dangerouslySetInnerHTML":if(Le!=null)throw Error(r(137,c));break;default:Le!==Ze&&On(s,c,$e,Le,x,Ze)}}to(s,q,K,xe,Oe,We,A,N);return;case"select":Le=q=K=$e=null;for(A in h)if(xe=h[A],h.hasOwnProperty(A)&&xe!=null)switch(A){case"value":break;case"multiple":Le=xe;default:x.hasOwnProperty(A)||On(s,c,A,null,x,xe)}for(N in x)if(A=x[N],xe=h[N],x.hasOwnProperty(N)&&(A!=null||xe!=null))switch(N){case"value":$e=A;break;case"defaultValue":K=A;break;case"multiple":q=A;default:A!==xe&&On(s,c,N,A,x,xe)}c=K,h=q,x=Le,$e!=null?ys(s,!!h,$e,!1):!!x!=!!h&&(c!=null?ys(s,!!h,c,!0):ys(s,!!h,h?[]:"",!1));return;case"textarea":Le=$e=null;for(K in h)if(N=h[K],h.hasOwnProperty(K)&&N!=null&&!x.hasOwnProperty(K))switch(K){case"value":break;case"children":break;default:On(s,c,K,null,x,N)}for(q in x)if(N=x[q],A=h[q],x.hasOwnProperty(q)&&(N!=null||A!=null))switch(q){case"value":$e=N;break;case"defaultValue":Le=N;break;case"children":break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(r(91));break;default:N!==A&&On(s,c,q,N,x,A)}al(s,$e,Le);return;case"option":for(var Dt in h)if($e=h[Dt],h.hasOwnProperty(Dt)&&$e!=null&&!x.hasOwnProperty(Dt))switch(Dt){case"selected":s.selected=!1;break;default:On(s,c,Dt,null,x,$e)}for(xe in x)if($e=x[xe],Le=h[xe],x.hasOwnProperty(xe)&&$e!==Le&&($e!=null||Le!=null))switch(xe){case"selected":s.selected=$e&&typeof $e!="function"&&typeof $e!="symbol";break;default:On(s,c,xe,$e,x,Le)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Pt in h)$e=h[Pt],h.hasOwnProperty(Pt)&&$e!=null&&!x.hasOwnProperty(Pt)&&On(s,c,Pt,null,x,$e);for(Oe in x)if($e=x[Oe],Le=h[Oe],x.hasOwnProperty(Oe)&&$e!==Le&&($e!=null||Le!=null))switch(Oe){case"children":case"dangerouslySetInnerHTML":if($e!=null)throw Error(r(137,c));break;default:On(s,c,Oe,$e,x,Le)}return;default:if(ro(c)){for(var Ln in h)$e=h[Ln],h.hasOwnProperty(Ln)&&$e!==void 0&&!x.hasOwnProperty(Ln)&&om(s,c,Ln,void 0,x,$e);for(We in x)$e=x[We],Le=h[We],!x.hasOwnProperty(We)||$e===Le||$e===void 0&&Le===void 0||om(s,c,We,$e,x,Le);return}}for(var Ae in h)$e=h[Ae],h.hasOwnProperty(Ae)&&$e!=null&&!x.hasOwnProperty(Ae)&&On(s,c,Ae,null,x,$e);for(Ze in x)$e=x[Ze],Le=h[Ze],!x.hasOwnProperty(Ze)||$e===Le||$e==null&&Le==null||On(s,c,Ze,$e,x,Le)}var ka=null,Jf=null;function Bl(s){return s.nodeType===9?s:s.ownerDocument}function rr(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function or(s,c){if(s===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&c==="foreignObject"?0:s}function Kf(s,c){return s==="textarea"||s==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var lm=null;function hv(){var s=window.event;return s&&s.type==="popstate"?s===lm?!1:(lm=s,!0):(lm=null,!1)}var $y=typeof setTimeout=="function"?setTimeout:void 0,pv=typeof clearTimeout=="function"?clearTimeout:void 0,zy=typeof Promise=="function"?Promise:void 0,mv=typeof queueMicrotask=="function"?queueMicrotask:typeof zy<"u"?function(s){return zy.resolve(null).then(s).catch(Uy)}:$y;function Uy(s){setTimeout(function(){throw s})}function aa(s){return s==="head"}function Xf(s,c){var h=c,x=0,N=0;do{var A=h.nextSibling;if(s.removeChild(h),A&&A.nodeType===8)if(h=A.data,h==="/$"){if(0<x&&8>x){h=x;var q=s.ownerDocument;if(h&1&&bd(q.documentElement),h&2&&bd(q.body),h&4)for(h=q.head,bd(h),q=h.firstChild;q;){var K=q.nextSibling,xe=q.nodeName;q[Qs]||xe==="SCRIPT"||xe==="STYLE"||xe==="LINK"&&q.rel.toLowerCase()==="stylesheet"||h.removeChild(q),q=K}}if(N===0){s.removeChild(A),kd(c);return}N--}else h==="$"||h==="$?"||h==="$!"?N++:x=h.charCodeAt(0)-48;else x=0;h=A}while(h);kd(c)}function cm(s){var c=s.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var h=c;switch(c=c.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":cm(h),Zl(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}s.removeChild(h)}}function By(s,c,h,x){for(;s.nodeType===1;){var N=h;if(s.nodeName.toLowerCase()!==c.toLowerCase()){if(!x&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(x){if(!s[Qs])switch(c){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(A=s.getAttribute("rel"),A==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(A!==N.rel||s.getAttribute("href")!==(N.href==null||N.href===""?null:N.href)||s.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin)||s.getAttribute("title")!==(N.title==null?null:N.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(A=s.getAttribute("src"),(A!==(N.src==null?null:N.src)||s.getAttribute("type")!==(N.type==null?null:N.type)||s.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin))&&A&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(c==="input"&&s.type==="hidden"){var A=N.name==null?null:""+N.name;if(N.type==="hidden"&&s.getAttribute("name")===A)return s}else return s;if(s=Ta(s.nextSibling),s===null)break}return null}function Zf(s,c,h){if(c==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!h||(s=Ta(s.nextSibling),s===null))return null;return s}function si(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function Wc(s,c){var h=s.ownerDocument;if(s.data!=="$?"||h.readyState==="complete")c();else{var x=function(){c(),h.removeEventListener("DOMContentLoaded",x)};h.addEventListener("DOMContentLoaded",x),s._reactRetry=x}}function Ta(s){for(;s!=null;s=s.nextSibling){var c=s.nodeType;if(c===1||c===3)break;if(c===8){if(c=s.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return s}var um=null;function qy(s){s=s.previousSibling;for(var c=0;s;){if(s.nodeType===8){var h=s.data;if(h==="$"||h==="$!"||h==="$?"){if(c===0)return s;c--}else h==="/$"&&c++}s=s.previousSibling}return null}function Vy(s,c,h){switch(c=Bl(h),s){case"html":if(s=c.documentElement,!s)throw Error(r(452));return s;case"head":if(s=c.head,!s)throw Error(r(453));return s;case"body":if(s=c.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function bd(s){for(var c=s.attributes;c.length;)s.removeAttributeNode(c[0]);Zl(s)}var zi=new Map,ss=new Set;function Vt(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var os=se.d;se.d={f:sa,r:Hy,D:gv,C:Gy,L:eh,m:yv,X:bv,S:xv,M:vv};function sa(){var s=os.f(),c=Uf();return s||c}function Hy(s){var c=Js(s);c!==null&&c.tag===5&&c.type==="form"?Cf(c):os.r(s)}var Qc=typeof document>"u"?null:document;function Tn(s,c,h){var x=Qc;if(x&&typeof c=="string"&&c){var N=Qr(c);N='link[rel="'+s+'"][href="'+N+'"]',typeof h=="string"&&(N+='[crossorigin="'+h+'"]'),ss.has(N)||(ss.add(N),s={rel:s,crossOrigin:h,href:c},x.querySelector(N)===null&&(c=x.createElement("link"),_r(c,"link",s),mr(c),x.head.appendChild(c)))}}function gv(s){os.D(s),Tn("dns-prefetch",s,null)}function Gy(s,c){os.C(s,c),Tn("preconnect",s,c)}function eh(s,c,h){os.L(s,c,h);var x=Qc;if(x&&s&&c){var N='link[rel="preload"][as="'+Qr(c)+'"]';c==="image"&&h&&h.imageSrcSet?(N+='[imagesrcset="'+Qr(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(N+='[imagesizes="'+Qr(h.imageSizes)+'"]')):N+='[href="'+Qr(s)+'"]';var A=N;switch(c){case"style":A=Jc(s);break;case"script":A=Kc(s)}zi.has(A)||(s=p({rel:"preload",href:c==="image"&&h&&h.imageSrcSet?void 0:s,as:c},h),zi.set(A,s),x.querySelector(N)!==null||c==="style"&&x.querySelector(vd(A))||c==="script"&&x.querySelector(wd(A))||(c=x.createElement("link"),_r(c,"link",s),mr(c),x.head.appendChild(c)))}}function yv(s,c){os.m(s,c);var h=Qc;if(h&&s){var x=c&&typeof c.as=="string"?c.as:"script",N='link[rel="modulepreload"][as="'+Qr(x)+'"][href="'+Qr(s)+'"]',A=N;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=Kc(s)}if(!zi.has(A)&&(s=p({rel:"modulepreload",href:s},c),zi.set(A,s),h.querySelector(N)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(wd(A)))return}x=h.createElement("link"),_r(x,"link",s),mr(x),h.head.appendChild(x)}}}function xv(s,c,h){os.S(s,c,h);var x=Qc;if(x&&s){var N=Xs(x).hoistableStyles,A=Jc(s);c=c||"default";var q=N.get(A);if(!q){var K={loading:0,preload:null};if(q=x.querySelector(vd(A)))K.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":c},h),(h=zi.get(A))&&Sd(s,h);var xe=q=x.createElement("link");mr(xe),_r(xe,"link",s),xe._p=new Promise(function(Oe,We){xe.onload=Oe,xe.onerror=We}),xe.addEventListener("load",function(){K.loading|=1}),xe.addEventListener("error",function(){K.loading|=2}),K.loading|=4,th(q,c,x)}q={type:"stylesheet",instance:q,count:1,state:K},N.set(A,q)}}}function bv(s,c){os.X(s,c);var h=Qc;if(h&&s){var x=Xs(h).hoistableScripts,N=Kc(s),A=x.get(N);A||(A=h.querySelector(wd(N)),A||(s=p({src:s,async:!0},c),(c=zi.get(N))&&dm(s,c),A=h.createElement("script"),mr(A),_r(A,"link",s),h.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},x.set(N,A))}}function vv(s,c){os.M(s,c);var h=Qc;if(h&&s){var x=Xs(h).hoistableScripts,N=Kc(s),A=x.get(N);A||(A=h.querySelector(wd(N)),A||(s=p({src:s,async:!0,type:"module"},c),(c=zi.get(N))&&dm(s,c),A=h.createElement("script"),mr(A),_r(A,"link",s),h.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},x.set(N,A))}}function Yy(s,c,h,x){var N=(N=X.current)?Vt(N):null;if(!N)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(c=Jc(h.href),h=Xs(N).hoistableStyles,x=h.get(c),x||(x={type:"style",instance:null,count:0,state:null},h.set(c,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){s=Jc(h.href);var A=Xs(N).hoistableStyles,q=A.get(s);if(q||(N=N.ownerDocument||N,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(s,q),(A=N.querySelector(vd(s)))&&!A._p&&(q.instance=A,q.state.loading=5),zi.has(s)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},zi.set(s,h),A||wv(N,s,h,q.state))),c&&x===null)throw Error(r(528,""));return q}if(c&&x!==null)throw Error(r(529,""));return null;case"script":return c=h.async,h=h.src,typeof h=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Kc(h),h=Xs(N).hoistableScripts,x=h.get(c),x||(x={type:"script",instance:null,count:0,state:null},h.set(c,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Jc(s){return'href="'+Qr(s)+'"'}function vd(s){return'link[rel="stylesheet"]['+s+"]"}function Wy(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function wv(s,c,h,x){s.querySelector('link[rel="preload"][as="style"]['+c+"]")?x.loading=1:(c=s.createElement("link"),x.preload=c,c.addEventListener("load",function(){return x.loading|=1}),c.addEventListener("error",function(){return x.loading|=2}),_r(c,"link",h),mr(c),s.head.appendChild(c))}function Kc(s){return'[src="'+Qr(s)+'"]'}function wd(s){return"script[async]"+s}function Qy(s,c,h){if(c.count++,c.instance===null)switch(c.type){case"style":var x=s.querySelector('style[data-href~="'+Qr(h.href)+'"]');if(x)return c.instance=x,mr(x),x;var N=p({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return x=(s.ownerDocument||s).createElement("style"),mr(x),_r(x,"style",N),th(x,h.precedence,s),c.instance=x;case"stylesheet":N=Jc(h.href);var A=s.querySelector(vd(N));if(A)return c.state.loading|=4,c.instance=A,mr(A),A;x=Wy(h),(N=zi.get(N))&&Sd(x,N),A=(s.ownerDocument||s).createElement("link"),mr(A);var q=A;return q._p=new Promise(function(K,xe){q.onload=K,q.onerror=xe}),_r(A,"link",x),c.state.loading|=4,th(A,h.precedence,s),c.instance=A;case"script":return A=Kc(h.src),(N=s.querySelector(wd(A)))?(c.instance=N,mr(N),N):(x=h,(N=zi.get(A))&&(x=p({},h),dm(x,N)),s=s.ownerDocument||s,N=s.createElement("script"),mr(N),_r(N,"link",x),s.head.appendChild(N),c.instance=N);case"void":return null;default:throw Error(r(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(x=c.instance,c.state.loading|=4,th(x,h.precedence,s));return c.instance}function th(s,c,h){for(var x=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),N=x.length?x[x.length-1]:null,A=N,q=0;q<x.length;q++){var K=x[q];if(K.dataset.precedence===c)A=K;else if(A!==N)break}A?A.parentNode.insertBefore(s,A.nextSibling):(c=h.nodeType===9?h.head:h,c.insertBefore(s,c.firstChild))}function Sd(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.title==null&&(s.title=c.title)}function dm(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.integrity==null&&(s.integrity=c.integrity)}var Xc=null;function Jy(s,c,h){if(Xc===null){var x=new Map,N=Xc=new Map;N.set(h,x)}else N=Xc,x=N.get(h),x||(x=new Map,N.set(h,x));if(x.has(s))return x;for(x.set(s,null),h=h.getElementsByTagName(s),N=0;N<h.length;N++){var A=h[N];if(!(A[Qs]||A[yn]||s==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var q=A.getAttribute(c)||"";q=s+q;var K=x.get(q);K?K.push(A):x.set(q,[A])}}return x}function Ky(s,c,h){s=s.ownerDocument||s,s.head.insertBefore(h,c==="title"?s.querySelector("head > title"):null)}function Sv(s,c,h){if(h===1||c.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return s=c.disabled,typeof c.precedence=="string"&&s==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function kr(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var Ir=null;function Nv(){}function Cv(s,c,h){if(Ir===null)throw Error(r(475));var x=Ir;if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var N=Jc(h.href),A=s.querySelector(vd(N));if(A){s=A._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(x.count++,x=Nd.bind(x),s.then(x,x)),c.state.loading|=4,c.instance=A,mr(A);return}A=s.ownerDocument||s,h=Wy(h),(N=zi.get(N))&&Sd(h,N),A=A.createElement("link"),mr(A);var q=A;q._p=new Promise(function(K,xe){q.onload=K,q.onerror=xe}),_r(A,"link",h),c.instance=A}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(x.count++,c=Nd.bind(x),s.addEventListener("load",c),s.addEventListener("error",c))}}function jv(){if(Ir===null)throw Error(r(475));var s=Ir;return s.stylesheets&&s.count===0&&fm(s,s.stylesheets),0<s.count?function(c){var h=setTimeout(function(){if(s.stylesheets&&fm(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(h)}}:null}function Nd(){if(this.count--,this.count===0){if(this.stylesheets)fm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var nh=null;function fm(s,c){s.stylesheets=null,s.unsuspend!==null&&(s.count++,nh=new Map,c.forEach(_v,s),nh=null,Nd.call(s))}function _v(s,c){if(!(c.state.loading&4)){var h=nh.get(s);if(h)var x=h.get(null);else{h=new Map,nh.set(s,h);for(var N=s.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<N.length;A++){var q=N[A];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(h.set(q.dataset.precedence,q),x=q)}x&&h.set(null,x)}N=c.instance,q=N.getAttribute("data-precedence"),A=h.get(q)||x,A===x&&h.set(null,N),h.set(q,N),this.count++,x=Nd.bind(this),N.addEventListener("load",x),N.addEventListener("error",x),A?A.parentNode.insertBefore(N,A.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(N,s.firstChild)),c.state.loading|=4}}var Zc={$$typeof:I,Provider:null,Consumer:null,_currentValue:re,_currentValue2:re,_threadCount:0};function kv(s,c,h,x,N,A,q,K){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=cn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cn(0),this.hiddenUpdates=cn(null),this.identifierPrefix=x,this.onUncaughtError=N,this.onCaughtError=A,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=K,this.incompleteTransitions=new Map}function Xy(s,c,h,x,N,A,q,K,xe,Oe,We,Ze){return s=new kv(s,c,h,q,K,xe,Oe,Ze),c=1,A===!0&&(c|=24),A=ui(3,null,null,c),s.current=A,A.stateNode=s,c=sp(),c.refCount++,s.pooledCache=c,c.refCount++,A.memoizedState={element:x,isDehydrated:h,cache:c},El(A),s}function Zy(s){return s?(s=Sl,s):Sl}function hm(s,c,h,x,N,A){N=Zy(N),x.context===null?x.context=N:x.pendingContext=N,x=wo(c),x.payload={element:h},A=A===void 0?null:A,A!==null&&(x.callback=A),h=Ts(s,x,c),h!==null&&($i(h,s,c),Ou(h,s,c))}function pm(s,c){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var h=s.retryLane;s.retryLane=h!==0&&h<c?h:c}}function mm(s,c){pm(s,c),(s=s.alternate)&&pm(s,c)}function ex(s){if(s.tag===13){var c=Cs(s,67108864);c!==null&&$i(c,s,67108864),mm(s,67108864)}}var rh=!0;function Tv(s,c,h,x){var N=V.T;V.T=null;var A=se.p;try{se.p=2,gm(s,c,h,x)}finally{se.p=A,V.T=N}}function eu(s,c,h,x){var N=V.T;V.T=null;var A=se.p;try{se.p=8,gm(s,c,h,x)}finally{se.p=A,V.T=N}}function gm(s,c,h,x){if(rh){var N=ym(x);if(N===null)$s(s,c,x,ih,h),nx(s,x);else if(Av(N,s,c,h,x))x.stopPropagation();else if(nx(s,x),c&4&&-1<Ev.indexOf(s)){for(;N!==null;){var A=Js(N);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var q=Te(A.pendingLanes);if(q!==0){var K=A;for(K.pendingLanes|=2,K.entangledLanes|=2;q;){var xe=1<<31-Qe(q);K.entanglements[1]|=xe,q&=~xe}as(A),(Pn&6)===0&&(Bc=ct()+500,md(0))}}break;case 13:K=Cs(A,2),K!==null&&$i(K,A,2),Uf(),mm(A,2)}if(A=ym(x),A===null&&$s(s,c,x,ih,h),A===N)break;N=A}N!==null&&x.stopPropagation()}else $s(s,c,x,null,h)}}function ym(s){return s=ol(s),xm(s)}var ih=null;function xm(s){if(ih=null,s=hs(s),s!==null){var c=o(s);if(c===null)s=null;else{var h=c.tag;if(h===13){if(s=l(c),s!==null)return s;s=null}else if(h===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;s=null}else c!==s&&(s=null)}}return ih=s,null}function tx(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(st()){case Ht:return 2;case rn:return 8;case je:case qe:return 32;case Be:return 268435456;default:return 32}default:return 32}}var ah=!1,zs=null,Lo=null,Fo=null,Cd=new Map,jd=new Map,$o=[],Ev="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function nx(s,c){switch(s){case"focusin":case"focusout":zs=null;break;case"dragenter":case"dragleave":Lo=null;break;case"mouseover":case"mouseout":Fo=null;break;case"pointerover":case"pointerout":Cd.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":jd.delete(c.pointerId)}}function _d(s,c,h,x,N,A){return s===null||s.nativeEvent!==A?(s={blockedOn:c,domEventName:h,eventSystemFlags:x,nativeEvent:A,targetContainers:[N]},c!==null&&(c=Js(c),c!==null&&ex(c)),s):(s.eventSystemFlags|=x,c=s.targetContainers,N!==null&&c.indexOf(N)===-1&&c.push(N),s)}function Av(s,c,h,x,N){switch(c){case"focusin":return zs=_d(zs,s,c,h,x,N),!0;case"dragenter":return Lo=_d(Lo,s,c,h,x,N),!0;case"mouseover":return Fo=_d(Fo,s,c,h,x,N),!0;case"pointerover":var A=N.pointerId;return Cd.set(A,_d(Cd.get(A)||null,s,c,h,x,N)),!0;case"gotpointercapture":return A=N.pointerId,jd.set(A,_d(jd.get(A)||null,s,c,h,x,N)),!0}return!1}function rx(s){var c=hs(s.target);if(c!==null){var h=o(c);if(h!==null){if(c=h.tag,c===13){if(c=l(h),c!==null){s.blockedOn=c,Hi(s.priority,function(){if(h.tag===13){var x=Gr();x=Ot(x);var N=Cs(h,x);N!==null&&$i(N,h,x),mm(h,x)}});return}}else if(c===3&&h.stateNode.current.memoizedState.isDehydrated){s.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}s.blockedOn=null}function sh(s){if(s.blockedOn!==null)return!1;for(var c=s.targetContainers;0<c.length;){var h=ym(s.nativeEvent);if(h===null){h=s.nativeEvent;var x=new h.constructor(h.type,h);io=x,h.target.dispatchEvent(x),io=null}else return c=Js(h),c!==null&&ex(c),s.blockedOn=h,!1;c.shift()}return!0}function ix(s,c,h){sh(s)&&h.delete(c)}function Pv(){ah=!1,zs!==null&&sh(zs)&&(zs=null),Lo!==null&&sh(Lo)&&(Lo=null),Fo!==null&&sh(Fo)&&(Fo=null),Cd.forEach(ix),jd.forEach(ix)}function oh(s,c){s.blockedOn===c&&(s.blockedOn=null,ah||(ah=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Pv)))}var lh=null;function ax(s){lh!==s&&(lh=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){lh===s&&(lh=null);for(var c=0;c<s.length;c+=3){var h=s[c],x=s[c+1],N=s[c+2];if(typeof x!="function"){if(xm(x||h)===null)continue;break}var A=Js(h);A!==null&&(s.splice(c,3),c-=3,Yu(A,{pending:!0,data:N,method:h.method,action:x},x,N))}}))}function kd(s){function c(xe){return oh(xe,s)}zs!==null&&oh(zs,s),Lo!==null&&oh(Lo,s),Fo!==null&&oh(Fo,s),Cd.forEach(c),jd.forEach(c);for(var h=0;h<$o.length;h++){var x=$o[h];x.blockedOn===s&&(x.blockedOn=null)}for(;0<$o.length&&(h=$o[0],h.blockedOn===null);)rx(h),h.blockedOn===null&&$o.shift();if(h=(s.ownerDocument||s).$$reactFormReplay,h!=null)for(x=0;x<h.length;x+=3){var N=h[x],A=h[x+1],q=N[vr]||null;if(typeof A=="function")q||ax(h);else if(q){var K=null;if(A&&A.hasAttribute("formAction")){if(N=A,q=A[vr]||null)K=q.formAction;else if(xm(N)!==null)continue}else K=q.action;typeof K=="function"?h[x+1]=K:(h.splice(x,3),x-=3),ax(h)}}}function bm(s){this._internalRoot=s}ch.prototype.render=bm.prototype.render=function(s){var c=this._internalRoot;if(c===null)throw Error(r(409));var h=c.current,x=Gr();hm(h,x,s,c,null,null)},ch.prototype.unmount=bm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var c=s.containerInfo;hm(s.current,2,null,s,null,null),Uf(),c[Ti]=null}};function ch(s){this._internalRoot=s}ch.prototype.unstable_scheduleHydration=function(s){if(s){var c=Wn();s={blockedOn:null,target:s,priority:c};for(var h=0;h<$o.length&&c!==0&&c<$o[h].priority;h++);$o.splice(h,0,s),h===0&&rx(s)}};var sx=n.version;if(sx!=="19.1.0")throw Error(r(527,sx,"19.1.0"));se.findDOMNode=function(s){var c=s._reactInternals;if(c===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=f(c),s=s!==null?u(s):null,s=s===null?null:s.stateNode,s};var Dv={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var uh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!uh.isDisabled&&uh.supportsFiber)try{Q=uh.inject(Dv),me=uh}catch{}}return wm.createRoot=function(s,c){if(!a(s))throw Error(r(299));var h=!1,x="",N=Dp,A=kf,q=Hg,K=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(N=c.onUncaughtError),c.onCaughtError!==void 0&&(A=c.onCaughtError),c.onRecoverableError!==void 0&&(q=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(K=c.unstable_transitionCallbacks)),c=Xy(s,1,!1,null,null,h,x,N,A,q,K,null),s[Ti]=c.current,sm(s),new bm(c)},wm.hydrateRoot=function(s,c,h){if(!a(s))throw Error(r(299));var x=!1,N="",A=Dp,q=kf,K=Hg,xe=null,Oe=null;return h!=null&&(h.unstable_strictMode===!0&&(x=!0),h.identifierPrefix!==void 0&&(N=h.identifierPrefix),h.onUncaughtError!==void 0&&(A=h.onUncaughtError),h.onCaughtError!==void 0&&(q=h.onCaughtError),h.onRecoverableError!==void 0&&(K=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(xe=h.unstable_transitionCallbacks),h.formState!==void 0&&(Oe=h.formState)),c=Xy(s,1,!0,c,h??null,x,N,A,q,K,xe,Oe),c.context=Zy(null),h=c.current,x=Gr(),x=Ot(x),N=wo(x),N.callback=null,Ts(h,N,x),h=x,c.current.lanes=h,gn(c,h),as(c),s[Ti]=c.current,sm(s),new ch(c)},wm.version="19.1.0",wm}var yS;function aP(){if(yS)return Fv.exports;yS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),Fv.exports=iP(),Fv.exports}var sP=aP();const oP=({message:e="Newtons Ai HMS"})=>i.jsx("div",{className:"loading-container",children:i.jsxs("div",{className:"loading-content",children:[i.jsxs("div",{className:"spinner-ring",children:[i.jsx("div",{}),i.jsx("div",{}),i.jsx("div",{}),i.jsx("div",{})]}),i.jsx("div",{className:"loading-title",children:e}),i.jsx("div",{className:"loading-subtitle",children:"Loading your workspace..."})]})});function lP(e={}){const{nonce:n,locale:t,onScriptLoadSuccess:r,onScriptLoadError:a}=e,[o,l]=w.useState(!1),d=w.useRef(r);d.current=r;const f=w.useRef(a);return f.current=a,w.useEffect(()=>{const u=document.createElement("script");return u.src="https://accounts.google.com/gsi/client",t&&(u.src+=`?hl=${t}`),u.async=!0,u.defer=!0,u.nonce=n,u.onload=()=>{var p;l(!0),(p=d.current)===null||p===void 0||p.call(d)},u.onerror=()=>{var p;l(!1),(p=f.current)===null||p===void 0||p.call(f)},document.body.appendChild(u),()=>{document.body.removeChild(u)}},[n]),o}const R_=w.createContext(null);function cP({clientId:e,nonce:n,locale:t,onScriptLoadSuccess:r,onScriptLoadError:a,children:o}){const l=lP({nonce:n,onScriptLoadSuccess:r,onScriptLoadError:a,locale:t}),d=w.useMemo(()=>({locale:t,clientId:e,scriptLoadedSuccessfully:l}),[e,l]);return jn.createElement(R_.Provider,{value:d},o)}function uP(){const e=w.useContext(R_);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function dP(e){var n;return(n=e==null?void 0:e.clientId)!==null&&n!==void 0?n:e==null?void 0:e.client_id}const fP={large:40,medium:32,small:20};function hP({onSuccess:e,onError:n,useOneTap:t,promptMomentNotification:r,type:a="standard",theme:o="outline",size:l="large",text:d,shape:f,logo_alignment:u,width:p,click_listener:g,state:b,containerProps:v,...S}){const k=w.useRef(null),{clientId:T,locale:P,scriptLoadedSuccessfully:M}=uP(),I=w.useRef(e);I.current=e;const U=w.useRef(n);U.current=n;const L=w.useRef(r);return L.current=r,w.useEffect(()=>{var $,z,F,Y,R,B,G,ie,te;if(M)return(F=(z=($=window==null?void 0:window.google)===null||$===void 0?void 0:$.accounts)===null||z===void 0?void 0:z.id)===null||F===void 0||F.initialize({client_id:T,callback:W=>{var V;if(!(W!=null&&W.credential))return(V=U.current)===null||V===void 0?void 0:V.call(U);const{credential:se,select_by:re}=W;I.current({credential:se,clientId:dP(W),select_by:re})},...S}),(B=(R=(Y=window==null?void 0:window.google)===null||Y===void 0?void 0:Y.accounts)===null||R===void 0?void 0:R.id)===null||B===void 0||B.renderButton(k.current,{type:a,theme:o,size:l,text:d,shape:f,logo_alignment:u,width:p,locale:P,click_listener:g,state:b}),t&&((te=(ie=(G=window==null?void 0:window.google)===null||G===void 0?void 0:G.accounts)===null||ie===void 0?void 0:ie.id)===null||te===void 0||te.prompt(L.current)),()=>{var W,V,se;t&&((se=(V=(W=window==null?void 0:window.google)===null||W===void 0?void 0:W.accounts)===null||V===void 0?void 0:V.id)===null||se===void 0||se.cancel())}},[T,M,t,a,o,l,d,f,u,p,P]),jn.createElement("div",{...v,ref:k,style:{height:fP[l],...v==null?void 0:v.style}})}var Sm={},xS;function pP(){if(xS)return Sm;xS=1,Object.defineProperty(Sm,"__esModule",{value:!0}),Sm.parse=l,Sm.serialize=u;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,n=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const b=function(){};return b.prototype=Object.create(null),b})();function l(b,v){const S=new o,k=b.length;if(k<2)return S;const T=(v==null?void 0:v.decode)||p;let P=0;do{const M=b.indexOf("=",P);if(M===-1)break;const I=b.indexOf(";",P),U=I===-1?k:I;if(M>U){P=b.lastIndexOf(";",M-1)+1;continue}const L=d(b,P,M),$=f(b,M,L),z=b.slice(L,$);if(S[z]===void 0){let F=d(b,M+1,U),Y=f(b,U,F);const R=T(b.slice(F,Y));S[z]=R}P=U+1}while(P<k);return S}function d(b,v,S){do{const k=b.charCodeAt(v);if(k!==32&&k!==9)return v}while(++v<S);return S}function f(b,v,S){for(;v>S;){const k=b.charCodeAt(--v);if(k!==32&&k!==9)return v+1}return S}function u(b,v,S){const k=(S==null?void 0:S.encode)||encodeURIComponent;if(!e.test(b))throw new TypeError(`argument name is invalid: ${b}`);const T=k(v);if(!n.test(T))throw new TypeError(`argument val is invalid: ${v}`);let P=b+"="+T;if(!S)return P;if(S.maxAge!==void 0){if(!Number.isInteger(S.maxAge))throw new TypeError(`option maxAge is invalid: ${S.maxAge}`);P+="; Max-Age="+S.maxAge}if(S.domain){if(!t.test(S.domain))throw new TypeError(`option domain is invalid: ${S.domain}`);P+="; Domain="+S.domain}if(S.path){if(!r.test(S.path))throw new TypeError(`option path is invalid: ${S.path}`);P+="; Path="+S.path}if(S.expires){if(!g(S.expires)||!Number.isFinite(S.expires.valueOf()))throw new TypeError(`option expires is invalid: ${S.expires}`);P+="; Expires="+S.expires.toUTCString()}if(S.httpOnly&&(P+="; HttpOnly"),S.secure&&(P+="; Secure"),S.partitioned&&(P+="; Partitioned"),S.priority)switch(typeof S.priority=="string"?S.priority.toLowerCase():void 0){case"low":P+="; Priority=Low";break;case"medium":P+="; Priority=Medium";break;case"high":P+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${S.priority}`)}if(S.sameSite)switch(typeof S.sameSite=="string"?S.sameSite.toLowerCase():S.sameSite){case!0:case"strict":P+="; SameSite=Strict";break;case"lax":P+="; SameSite=Lax";break;case"none":P+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${S.sameSite}`)}return P}function p(b){if(b.indexOf("%")===-1)return b;try{return decodeURIComponent(b)}catch{return b}}function g(b){return a.call(b)==="[object Date]"}return Sm}pP();var bS="popstate";function mP(e={}){function n(r,a){let{pathname:o,search:l,hash:d}=r.location;return W0("",{pathname:o,search:l,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(r,a){return typeof a=="string"?a:Gm(a)}return yP(n,t,null,e)}function hr(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function Vs(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function gP(){return Math.random().toString(36).substring(2,10)}function vS(e,n){return{usr:e.state,key:e.key,idx:n}}function W0(e,n,t=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof n=="string"?Oh(n):n,state:t,key:n&&n.key||r||gP()}}function Gm({pathname:e="/",search:n="",hash:t=""}){return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function Oh(e){let n={};if(e){let t=e.indexOf("#");t>=0&&(n.hash=e.substring(t),e=e.substring(0,t));let r=e.indexOf("?");r>=0&&(n.search=e.substring(r),e=e.substring(0,r)),e&&(n.pathname=e)}return n}function yP(e,n,t,r={}){let{window:a=document.defaultView,v5Compat:o=!1}=r,l=a.history,d="POP",f=null,u=p();u==null&&(u=0,l.replaceState({...l.state,idx:u},""));function p(){return(l.state||{idx:null}).idx}function g(){d="POP";let T=p(),P=T==null?null:T-u;u=T,f&&f({action:d,location:k.location,delta:P})}function b(T,P){d="PUSH";let M=W0(k.location,T,P);u=p()+1;let I=vS(M,u),U=k.createHref(M);try{l.pushState(I,"",U)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;a.location.assign(U)}o&&f&&f({action:d,location:k.location,delta:1})}function v(T,P){d="REPLACE";let M=W0(k.location,T,P);u=p();let I=vS(M,u),U=k.createHref(M);l.replaceState(I,"",U),o&&f&&f({action:d,location:k.location,delta:0})}function S(T){return xP(T)}let k={get action(){return d},get location(){return e(a,l)},listen(T){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(bS,g),f=T,()=>{a.removeEventListener(bS,g),f=null}},createHref(T){return n(a,T)},createURL:S,encodeLocation(T){let P=S(T);return{pathname:P.pathname,search:P.search,hash:P.hash}},push:b,replace:v,go(T){return l.go(T)}};return k}function xP(e,n=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),hr(t,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:Gm(e);return r=r.replace(/ $/,"%20"),!n&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function M_(e,n,t="/"){return bP(e,n,t,!1)}function bP(e,n,t,r){let a=typeof n=="string"?Oh(n):n,o=Yl(a.pathname||"/",t);if(o==null)return null;let l=O_(e);vP(l);let d=null;for(let f=0;d==null&&f<l.length;++f){let u=PP(o);d=EP(l[f],u,r)}return d}function O_(e,n=[],t=[],r=""){let a=(o,l,d)=>{let f={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};f.relativePath.startsWith("/")&&(hr(f.relativePath.startsWith(r),`Absolute route path "${f.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(r.length));let u=Hl([r,f.relativePath]),p=t.concat(f);o.children&&o.children.length>0&&(hr(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),O_(o.children,n,p,u)),!(o.path==null&&!o.index)&&n.push({path:u,score:kP(u,o.index),routesMeta:p})};return e.forEach((o,l)=>{var d;if(o.path===""||!((d=o.path)!=null&&d.includes("?")))a(o,l);else for(let f of L_(o.path))a(o,l,f)}),n}function L_(e){let n=e.split("/");if(n.length===0)return[];let[t,...r]=n,a=t.endsWith("?"),o=t.replace(/\?$/,"");if(r.length===0)return a?[o,""]:[o];let l=L_(r.join("/")),d=[];return d.push(...l.map(f=>f===""?o:[o,f].join("/"))),a&&d.push(...l),d.map(f=>e.startsWith("/")&&f===""?"/":f)}function vP(e){e.sort((n,t)=>n.score!==t.score?t.score-n.score:TP(n.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var wP=/^:[\w-]+$/,SP=3,NP=2,CP=1,jP=10,_P=-2,wS=e=>e==="*";function kP(e,n){let t=e.split("/"),r=t.length;return t.some(wS)&&(r+=_P),n&&(r+=NP),t.filter(a=>!wS(a)).reduce((a,o)=>a+(wP.test(o)?SP:o===""?CP:jP),r)}function TP(e,n){return e.length===n.length&&e.slice(0,-1).every((r,a)=>r===n[a])?e[e.length-1]-n[n.length-1]:0}function EP(e,n,t=!1){let{routesMeta:r}=e,a={},o="/",l=[];for(let d=0;d<r.length;++d){let f=r[d],u=d===r.length-1,p=o==="/"?n:n.slice(o.length)||"/",g=Hx({path:f.relativePath,caseSensitive:f.caseSensitive,end:u},p),b=f.route;if(!g&&u&&t&&!r[r.length-1].route.index&&(g=Hx({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},p)),!g)return null;Object.assign(a,g.params),l.push({params:a,pathname:Hl([o,g.pathname]),pathnameBase:MP(Hl([o,g.pathnameBase])),route:b}),g.pathnameBase!=="/"&&(o=Hl([o,g.pathnameBase]))}return l}function Hx(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,r]=AP(e.path,e.caseSensitive,e.end),a=n.match(t);if(!a)return null;let o=a[0],l=o.replace(/(.)\/+$/,"$1"),d=a.slice(1);return{params:r.reduce((u,{paramName:p,isOptional:g},b)=>{if(p==="*"){let S=d[b]||"";l=o.slice(0,o.length-S.length).replace(/(.)\/+$/,"$1")}const v=d[b];return g&&!v?u[p]=void 0:u[p]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:l,pattern:e}}function AP(e,n=!1,t=!0){Vs(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,d,f)=>(r.push({paramName:d,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,n?void 0:"i"),r]}function PP(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return Vs(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),e}}function Yl(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let t=n.endsWith("/")?n.length-1:n.length,r=e.charAt(t);return r&&r!=="/"?null:e.slice(t)||"/"}function DP(e,n="/"){let{pathname:t,search:r="",hash:a=""}=typeof e=="string"?Oh(e):e;return{pathname:t?t.startsWith("/")?t:IP(t,n):n,search:OP(r),hash:LP(a)}}function IP(e,n){let t=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function Bv(e,n,t,r){return`Cannot include a '${e}' character in a manually specified \`to.${n}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function RP(e){return e.filter((n,t)=>t===0||n.route.path&&n.route.path.length>0)}function X1(e){let n=RP(e);return n.map((t,r)=>r===n.length-1?t.pathname:t.pathnameBase)}function Z1(e,n,t,r=!1){let a;typeof e=="string"?a=Oh(e):(a={...e},hr(!a.pathname||!a.pathname.includes("?"),Bv("?","pathname","search",a)),hr(!a.pathname||!a.pathname.includes("#"),Bv("#","pathname","hash",a)),hr(!a.search||!a.search.includes("#"),Bv("#","search","hash",a)));let o=e===""||a.pathname==="",l=o?"/":a.pathname,d;if(l==null)d=t;else{let g=n.length-1;if(!r&&l.startsWith("..")){let b=l.split("/");for(;b[0]==="..";)b.shift(),g-=1;a.pathname=b.join("/")}d=g>=0?n[g]:"/"}let f=DP(a,d),u=l&&l!=="/"&&l.endsWith("/"),p=(o||l===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(u||p)&&(f.pathname+="/"),f}var Hl=e=>e.join("/").replace(/\/\/+/g,"/"),MP=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),OP=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,LP=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function FP(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var F_=["POST","PUT","PATCH","DELETE"];new Set(F_);var $P=["GET",...F_];new Set($P);var Lh=w.createContext(null);Lh.displayName="DataRouter";var xb=w.createContext(null);xb.displayName="DataRouterState";var $_=w.createContext({isTransitioning:!1});$_.displayName="ViewTransition";var zP=w.createContext(new Map);zP.displayName="Fetchers";var UP=w.createContext(null);UP.displayName="Await";var Gs=w.createContext(null);Gs.displayName="Navigation";var ng=w.createContext(null);ng.displayName="Location";var Ys=w.createContext({outlet:null,matches:[],isDataRoute:!1});Ys.displayName="Route";var ew=w.createContext(null);ew.displayName="RouteError";function BP(e,{relative:n}={}){hr(Fh(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=w.useContext(Gs),{hash:a,pathname:o,search:l}=rg(e,{relative:n}),d=o;return t!=="/"&&(d=o==="/"?t:Hl([t,o])),r.createHref({pathname:d,search:l,hash:a})}function Fh(){return w.useContext(ng)!=null}function Yr(){return hr(Fh(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(ng).location}var z_="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function U_(e){w.useContext(Gs).static||w.useLayoutEffect(e)}function Et(){let{isDataRoute:e}=w.useContext(Ys);return e?tD():qP()}function qP(){hr(Fh(),"useNavigate() may be used only in the context of a <Router> component.");let e=w.useContext(Lh),{basename:n,navigator:t}=w.useContext(Gs),{matches:r}=w.useContext(Ys),{pathname:a}=Yr(),o=JSON.stringify(X1(r)),l=w.useRef(!1);return U_(()=>{l.current=!0}),w.useCallback((f,u={})=>{if(Vs(l.current,z_),!l.current)return;if(typeof f=="number"){t.go(f);return}let p=Z1(f,JSON.parse(o),a,u.relative==="path");e==null&&n!=="/"&&(p.pathname=p.pathname==="/"?n:Hl([n,p.pathname])),(u.replace?t.replace:t.push)(p,u.state,u)},[n,t,o,a,e])}w.createContext(null);function Vi(){let{matches:e}=w.useContext(Ys),n=e[e.length-1];return n?n.params:{}}function rg(e,{relative:n}={}){let{matches:t}=w.useContext(Ys),{pathname:r}=Yr(),a=JSON.stringify(X1(t));return w.useMemo(()=>Z1(e,JSON.parse(a),r,n==="path"),[e,a,r,n])}function VP(e,n){return B_(e,n)}function B_(e,n,t,r){var M;hr(Fh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:o}=w.useContext(Gs),{matches:l}=w.useContext(Ys),d=l[l.length-1],f=d?d.params:{},u=d?d.pathname:"/",p=d?d.pathnameBase:"/",g=d&&d.route;{let I=g&&g.path||"";q_(u,!g||I.endsWith("*")||I.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${I}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${I}"> to <Route path="${I==="/"?"*":`${I}/*`}">.`)}let b=Yr(),v;if(n){let I=typeof n=="string"?Oh(n):n;hr(p==="/"||((M=I.pathname)==null?void 0:M.startsWith(p)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${I.pathname}" was given in the \`location\` prop.`),v=I}else v=b;let S=v.pathname||"/",k=S;if(p!=="/"){let I=p.replace(/^\//,"").split("/");k="/"+S.replace(/^\//,"").split("/").slice(I.length).join("/")}let T=!o&&t&&t.matches&&t.matches.length>0?t.matches:M_(e,{pathname:k});Vs(g||T!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Vs(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let P=QP(T&&T.map(I=>Object.assign({},I,{params:Object.assign({},f,I.params),pathname:Hl([p,a.encodeLocation?a.encodeLocation(I.pathname).pathname:I.pathname]),pathnameBase:I.pathnameBase==="/"?p:Hl([p,a.encodeLocation?a.encodeLocation(I.pathnameBase).pathname:I.pathnameBase])})),l,t,r);return n&&P?w.createElement(ng.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},P):P}function HP(){let e=eD(),n=FP(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:o},"ErrorBoundary")," or"," ",w.createElement("code",{style:o},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},n),t?w.createElement("pre",{style:a},t):null,l)}var GP=w.createElement(HP,null),YP=class extends w.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?w.createElement(Ys.Provider,{value:this.props.routeContext},w.createElement(ew.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function WP({routeContext:e,match:n,children:t}){let r=w.useContext(Lh);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),w.createElement(Ys.Provider,{value:e},t)}function QP(e,n=[],t=null,r=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(n.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let a=e,o=t==null?void 0:t.errors;if(o!=null){let f=a.findIndex(u=>u.route.id&&(o==null?void 0:o[u.route.id])!==void 0);hr(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,f+1))}let l=!1,d=-1;if(t)for(let f=0;f<a.length;f++){let u=a[f];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(d=f),u.route.id){let{loaderData:p,errors:g}=t,b=u.route.loader&&!p.hasOwnProperty(u.route.id)&&(!g||g[u.route.id]===void 0);if(u.route.lazy||b){l=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((f,u,p)=>{let g,b=!1,v=null,S=null;t&&(g=o&&u.route.id?o[u.route.id]:void 0,v=u.route.errorElement||GP,l&&(d<0&&p===0?(q_("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,S=null):d===p&&(b=!0,S=u.route.hydrateFallbackElement||null)));let k=n.concat(a.slice(0,p+1)),T=()=>{let P;return g?P=v:b?P=S:u.route.Component?P=w.createElement(u.route.Component,null):u.route.element?P=u.route.element:P=f,w.createElement(WP,{match:u,routeContext:{outlet:f,matches:k,isDataRoute:t!=null},children:P})};return t&&(u.route.ErrorBoundary||u.route.errorElement||p===0)?w.createElement(YP,{location:t.location,revalidation:t.revalidation,component:v,error:g,children:T(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):T()},null)}function tw(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function JP(e){let n=w.useContext(Lh);return hr(n,tw(e)),n}function KP(e){let n=w.useContext(xb);return hr(n,tw(e)),n}function XP(e){let n=w.useContext(Ys);return hr(n,tw(e)),n}function nw(e){let n=XP(e),t=n.matches[n.matches.length-1];return hr(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function ZP(){return nw("useRouteId")}function eD(){var r;let e=w.useContext(ew),n=KP("useRouteError"),t=nw("useRouteError");return e!==void 0?e:(r=n.errors)==null?void 0:r[t]}function tD(){let{router:e}=JP("useNavigate"),n=nw("useNavigate"),t=w.useRef(!1);return U_(()=>{t.current=!0}),w.useCallback(async(a,o={})=>{Vs(t.current,z_),t.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:n,...o}))},[e,n])}var SS={};function q_(e,n,t){!n&&!SS[e]&&(SS[e]=!0,Vs(!1,t))}w.memo(nD);function nD({routes:e,future:n,state:t}){return B_(e,void 0,t,n)}function vn({to:e,replace:n,state:t,relative:r}){hr(Fh(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=w.useContext(Gs);Vs(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=w.useContext(Ys),{pathname:l}=Yr(),d=Et(),f=Z1(e,X1(o),l,r==="path"),u=JSON.stringify(f);return w.useEffect(()=>{d(JSON.parse(u),{replace:n,state:t,relative:r})},[d,u,r,n,t]),null}function ht(e){hr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function rD({basename:e="/",children:n=null,location:t,navigationType:r="POP",navigator:a,static:o=!1}){hr(!Fh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=e.replace(/^\/*/,"/"),d=w.useMemo(()=>({basename:l,navigator:a,static:o,future:{}}),[l,a,o]);typeof t=="string"&&(t=Oh(t));let{pathname:f="/",search:u="",hash:p="",state:g=null,key:b="default"}=t,v=w.useMemo(()=>{let S=Yl(f,l);return S==null?null:{location:{pathname:S,search:u,hash:p,state:g,key:b},navigationType:r}},[l,f,u,p,g,b,r]);return Vs(v!=null,`<Router basename="${l}"> is not able to match the URL "${f}${u}${p}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:w.createElement(Gs.Provider,{value:d},w.createElement(ng.Provider,{children:n,value:v}))}function xh({children:e,location:n}){return VP(Q0(e),n)}function Q0(e,n=[]){let t=[];return w.Children.forEach(e,(r,a)=>{if(!w.isValidElement(r))return;let o=[...n,a];if(r.type===w.Fragment){t.push.apply(t,Q0(r.props.children,o));return}hr(r.type===ht,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),hr(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=Q0(r.props.children,o)),t.push(l)}),t}var Dx="get",Ix="application/x-www-form-urlencoded";function bb(e){return e!=null&&typeof e.tagName=="string"}function iD(e){return bb(e)&&e.tagName.toLowerCase()==="button"}function aD(e){return bb(e)&&e.tagName.toLowerCase()==="form"}function sD(e){return bb(e)&&e.tagName.toLowerCase()==="input"}function oD(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function lD(e,n){return e.button===0&&(!n||n==="_self")&&!oD(e)}var ox=null;function cD(){if(ox===null)try{new FormData(document.createElement("form"),0),ox=!1}catch{ox=!0}return ox}var uD=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function qv(e){return e!=null&&!uD.has(e)?(Vs(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ix}"`),null):e}function dD(e,n){let t,r,a,o,l;if(aD(e)){let d=e.getAttribute("action");r=d?Yl(d,n):null,t=e.getAttribute("method")||Dx,a=qv(e.getAttribute("enctype"))||Ix,o=new FormData(e)}else if(iD(e)||sD(e)&&(e.type==="submit"||e.type==="image")){let d=e.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=e.getAttribute("formaction")||d.getAttribute("action");if(r=f?Yl(f,n):null,t=e.getAttribute("formmethod")||d.getAttribute("method")||Dx,a=qv(e.getAttribute("formenctype"))||qv(d.getAttribute("enctype"))||Ix,o=new FormData(d,e),!cD()){let{name:u,type:p,value:g}=e;if(p==="image"){let b=u?`${u}.`:"";o.append(`${b}x`,"0"),o.append(`${b}y`,"0")}else u&&o.append(u,g)}}else{if(bb(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Dx,r=null,a=Ix,l=e}return o&&a==="text/plain"&&(l=o,o=void 0),{action:r,method:t.toLowerCase(),encType:a,formData:o,body:l}}function rw(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}async function fD(e,n){if(e.id in n)return n[e.id];try{let t=await import(e.module);return n[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function hD(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function pD(e,n,t){let r=await Promise.all(e.map(async a=>{let o=n.routes[a.route.id];if(o){let l=await fD(o,t);return l.links?l.links():[]}return[]}));return xD(r.flat(1).filter(hD).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function NS(e,n,t,r,a,o){let l=(f,u)=>t[u]?f.route.id!==t[u].route.id:!0,d=(f,u)=>{var p;return t[u].pathname!==f.pathname||((p=t[u].route.path)==null?void 0:p.endsWith("*"))&&t[u].params["*"]!==f.params["*"]};return o==="assets"?n.filter((f,u)=>l(f,u)||d(f,u)):o==="data"?n.filter((f,u)=>{var g;let p=r.routes[f.route.id];if(!p||!p.hasLoader)return!1;if(l(f,u)||d(f,u))return!0;if(f.route.shouldRevalidate){let b=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((g=t[0])==null?void 0:g.params)||{},nextUrl:new URL(e,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function mD(e,n,{includeHydrateFallback:t}={}){return gD(e.map(r=>{let a=n.routes[r.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function gD(e){return[...new Set(e)]}function yD(e){let n={},t=Object.keys(e).sort();for(let r of t)n[r]=e[r];return n}function xD(e,n){let t=new Set;return new Set(n),e.reduce((r,a)=>{let o=JSON.stringify(yD(a));return t.has(o)||(t.add(o),r.push({key:o,link:a})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var bD=new Set([100,101,204,205]);function vD(e,n){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":n&&Yl(t.pathname,n)==="/"?t.pathname=`${n.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function V_(){let e=w.useContext(Lh);return rw(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function wD(){let e=w.useContext(xb);return rw(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var iw=w.createContext(void 0);iw.displayName="FrameworkContext";function H_(){let e=w.useContext(iw);return rw(e,"You must render this element inside a <HydratedRouter> element"),e}function SD(e,n){let t=w.useContext(iw),[r,a]=w.useState(!1),[o,l]=w.useState(!1),{onFocus:d,onBlur:f,onMouseEnter:u,onMouseLeave:p,onTouchStart:g}=n,b=w.useRef(null);w.useEffect(()=>{if(e==="render"&&l(!0),e==="viewport"){let k=P=>{P.forEach(M=>{l(M.isIntersecting)})},T=new IntersectionObserver(k,{threshold:.5});return b.current&&T.observe(b.current),()=>{T.disconnect()}}},[e]),w.useEffect(()=>{if(r){let k=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(k)}}},[r]);let v=()=>{a(!0)},S=()=>{a(!1),l(!1)};return t?e!=="intent"?[o,b,{}]:[o,b,{onFocus:Nm(d,v),onBlur:Nm(f,S),onMouseEnter:Nm(u,v),onMouseLeave:Nm(p,S),onTouchStart:Nm(g,v)}]:[!1,b,{}]}function Nm(e,n){return t=>{e&&e(t),t.defaultPrevented||n(t)}}function ND({page:e,...n}){let{router:t}=V_(),r=w.useMemo(()=>M_(t.routes,e,t.basename),[t.routes,e,t.basename]);return r?w.createElement(jD,{page:e,matches:r,...n}):null}function CD(e){let{manifest:n,routeModules:t}=H_(),[r,a]=w.useState([]);return w.useEffect(()=>{let o=!1;return pD(e,n,t).then(l=>{o||a(l)}),()=>{o=!0}},[e,n,t]),r}function jD({page:e,matches:n,...t}){let r=Yr(),{manifest:a,routeModules:o}=H_(),{basename:l}=V_(),{loaderData:d,matches:f}=wD(),u=w.useMemo(()=>NS(e,n,f,a,r,"data"),[e,n,f,a,r]),p=w.useMemo(()=>NS(e,n,f,a,r,"assets"),[e,n,f,a,r]),g=w.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let S=new Set,k=!1;if(n.forEach(P=>{var I;let M=a.routes[P.route.id];!M||!M.hasLoader||(!u.some(U=>U.route.id===P.route.id)&&P.route.id in d&&((I=o[P.route.id])!=null&&I.shouldRevalidate)||M.hasClientLoader?k=!0:S.add(P.route.id))}),S.size===0)return[];let T=vD(e,l);return k&&S.size>0&&T.searchParams.set("_routes",n.filter(P=>S.has(P.route.id)).map(P=>P.route.id).join(",")),[T.pathname+T.search]},[l,d,r,a,u,n,e,o]),b=w.useMemo(()=>mD(p,a),[p,a]),v=CD(p);return w.createElement(w.Fragment,null,g.map(S=>w.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...t})),b.map(S=>w.createElement("link",{key:S,rel:"modulepreload",href:S,...t})),v.map(({key:S,link:k})=>w.createElement("link",{key:S,...k})))}function _D(...e){return n=>{e.forEach(t=>{typeof t=="function"?t(n):t!=null&&(t.current=n)})}}var G_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{G_&&(window.__reactRouterVersion="7.6.0")}catch{}function kD({basename:e,children:n,window:t}){let r=w.useRef();r.current==null&&(r.current=mP({window:t,v5Compat:!0}));let a=r.current,[o,l]=w.useState({action:a.action,location:a.location}),d=w.useCallback(f=>{w.startTransition(()=>l(f))},[l]);return w.useLayoutEffect(()=>a.listen(d),[a,d]),w.createElement(rD,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:a})}var Y_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ds=w.forwardRef(function({onClick:n,discover:t="render",prefetch:r="none",relative:a,reloadDocument:o,replace:l,state:d,target:f,to:u,preventScrollReset:p,viewTransition:g,...b},v){let{basename:S}=w.useContext(Gs),k=typeof u=="string"&&Y_.test(u),T,P=!1;if(typeof u=="string"&&k&&(T=u,G_))try{let Y=new URL(window.location.href),R=u.startsWith("//")?new URL(Y.protocol+u):new URL(u),B=Yl(R.pathname,S);R.origin===Y.origin&&B!=null?u=B+R.search+R.hash:P=!0}catch{Vs(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let M=BP(u,{relative:a}),[I,U,L]=SD(r,b),$=PD(u,{replace:l,state:d,target:f,preventScrollReset:p,relative:a,viewTransition:g});function z(Y){n&&n(Y),Y.defaultPrevented||$(Y)}let F=w.createElement("a",{...b,...L,href:T||M,onClick:P||o?n:z,ref:_D(v,U),target:f,"data-discover":!k&&t==="render"?"true":void 0});return I&&!k?w.createElement(w.Fragment,null,F,w.createElement(ND,{page:M})):F});ds.displayName="Link";var TD=w.forwardRef(function({"aria-current":n="page",caseSensitive:t=!1,className:r="",end:a=!1,style:o,to:l,viewTransition:d,children:f,...u},p){let g=rg(l,{relative:u.relative}),b=Yr(),v=w.useContext(xb),{navigator:S,basename:k}=w.useContext(Gs),T=v!=null&&OD(g)&&d===!0,P=S.encodeLocation?S.encodeLocation(g).pathname:g.pathname,M=b.pathname,I=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(M=M.toLowerCase(),I=I?I.toLowerCase():null,P=P.toLowerCase()),I&&k&&(I=Yl(I,k)||I);const U=P!=="/"&&P.endsWith("/")?P.length-1:P.length;let L=M===P||!a&&M.startsWith(P)&&M.charAt(U)==="/",$=I!=null&&(I===P||!a&&I.startsWith(P)&&I.charAt(P.length)==="/"),z={isActive:L,isPending:$,isTransitioning:T},F=L?n:void 0,Y;typeof r=="function"?Y=r(z):Y=[r,L?"active":null,$?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let R=typeof o=="function"?o(z):o;return w.createElement(ds,{...u,"aria-current":F,className:Y,ref:p,style:R,to:l,viewTransition:d},typeof f=="function"?f(z):f)});TD.displayName="NavLink";var ED=w.forwardRef(({discover:e="render",fetcherKey:n,navigate:t,reloadDocument:r,replace:a,state:o,method:l=Dx,action:d,onSubmit:f,relative:u,preventScrollReset:p,viewTransition:g,...b},v)=>{let S=RD(),k=MD(d,{relative:u}),T=l.toLowerCase()==="get"?"get":"post",P=typeof d=="string"&&Y_.test(d),M=I=>{if(f&&f(I),I.defaultPrevented)return;I.preventDefault();let U=I.nativeEvent.submitter,L=(U==null?void 0:U.getAttribute("formmethod"))||l;S(U||I.currentTarget,{fetcherKey:n,method:L,navigate:t,replace:a,state:o,relative:u,preventScrollReset:p,viewTransition:g})};return w.createElement("form",{ref:v,method:T,action:k,onSubmit:r?f:M,...b,"data-discover":!P&&e==="render"?"true":void 0})});ED.displayName="Form";function AD(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function W_(e){let n=w.useContext(Lh);return hr(n,AD(e)),n}function PD(e,{target:n,replace:t,state:r,preventScrollReset:a,relative:o,viewTransition:l}={}){let d=Et(),f=Yr(),u=rg(e,{relative:o});return w.useCallback(p=>{if(lD(p,n)){p.preventDefault();let g=t!==void 0?t:Gm(f)===Gm(u);d(e,{replace:g,state:r,preventScrollReset:a,relative:o,viewTransition:l})}},[f,d,u,t,r,n,e,a,o,l])}var DD=0,ID=()=>`__${String(++DD)}__`;function RD(){let{router:e}=W_("useSubmit"),{basename:n}=w.useContext(Gs),t=ZP();return w.useCallback(async(r,a={})=>{let{action:o,method:l,encType:d,formData:f,body:u}=dD(r,n);if(a.navigate===!1){let p=a.fetcherKey||ID();await e.fetch(p,t,a.action||o,{preventScrollReset:a.preventScrollReset,formData:f,body:u,formMethod:a.method||l,formEncType:a.encType||d,flushSync:a.flushSync})}else await e.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:f,body:u,formMethod:a.method||l,formEncType:a.encType||d,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,n,t])}function MD(e,{relative:n}={}){let{basename:t}=w.useContext(Gs),r=w.useContext(Ys);hr(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),o={...rg(e||".",{relative:n})},l=Yr();if(e==null){o.search=l.search;let d=new URLSearchParams(o.search),f=d.getAll("index");if(f.some(p=>p==="")){d.delete("index"),f.filter(g=>g).forEach(g=>d.append("index",g));let p=d.toString();o.search=p?`?${p}`:""}}return(!e||e===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:Hl([t,o.pathname])),Gm(o)}function OD(e,n={}){let t=w.useContext($_);hr(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=W_("useViewTransitionState"),a=rg(e,{relative:n.relative});if(!t.isTransitioning)return!1;let o=Yl(t.currentLocation.pathname,r)||t.currentLocation.pathname,l=Yl(t.nextLocation.pathname,r)||t.nextLocation.pathname;return Hx(a.pathname,l)!=null||Hx(a.pathname,o)!=null}[...bD];var LD=I_();class FD extends w.Component{constructor(){super(...arguments);Yn(this,"state",{hasError:!1})}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){console.error("Uncaught error:",t,r)}render(){return this.state.hasError?i.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"red",border:"1px solid red",borderRadius:"5px"},children:[i.jsx("h1",{children:"Something went wrong."}),i.jsx("p",{children:"We are sorry for the inconvenience. Please try again later."})]}):this.props.children}}class $D{constructor(){Yn(this,"listeners",[]);Yn(this,"activeRequests",0)}subscribe(n){return this.listeners.push(n),n(this.activeRequests>0),()=>this.unsubscribe(n)}unsubscribe(n){this.listeners=this.listeners.filter(t=>t!==n)}notify(n){n?this.activeRequests++:this.activeRequests=Math.max(0,this.activeRequests-1);const t=this.activeRequests>0;this.listeners.forEach(r=>r(t))}}const J0=new $D,zD="https://backend.newtons.in",UD=()=>localStorage.getItem("authToken"),pe=async(e,n={})=>{const t=UD(),r={...n.headers};t&&(r.Authorization=`Bearer ${t}`),!(n.body instanceof FormData)&&!r["Content-Type"]&&(r["Content-Type"]="application/json");const a=r;let o=e.startsWith("/")?e:`/${e}`;o.startsWith("/api/")||(o=`/api${o}`);const l=`${zD}${o}`;J0.notify(!0);try{console.log(`Making API call to: ${l}`);const d=await fetch(l,{...n,headers:a});if(d.status===401)throw console.error("Unauthorized access - Token might be invalid or expired. Logging out."),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser"),window.location.href="/login",new Error("Unauthorized");if(!d.ok){let f=`HTTP error! status: ${d.status}`;try{const u=await d.json();f=(u==null?void 0:u.message)||(u==null?void 0:u.error)||f}catch{}throw console.error(`API Error: ${d.status} ${d.statusText} - ${f}`),new Error(f)}return d}catch(d){throw d instanceof TypeError&&d.message==="Failed to fetch"?console.error("API Fetch Error: Network error or CORS issue. Check backend CORS configuration.",d):console.error("API Fetch Error:",d),d}finally{J0.notify(!1)}},BD=({onLoginSuccess:e})=>{const[n,t]=w.useState(""),[r,a]=w.useState(""),[o,l]=w.useState(null),[d,f]=w.useState(!1),u=Et(),p=async v=>{v.preventDefault(),f(!0),l(null);try{const S=await pe("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});if(!S.ok){let T=`Login failed with status: ${S.status}`;try{T=(await S.json()).message||T}catch{try{const M=await S.text();M&&(T=`${T} - ${M}`)}catch{}}throw new Error(T)}const k=await S.json();console.log("Login successful:",k),localStorage.setItem("authToken",k.token),localStorage.setItem("currentUser",JSON.stringify(k.user)),k.user.clinic_id&&localStorage.setItem("currentClinicId",k.user.clinic_id),e(k.user),k.user.role==="doctor"?u("/dashboard/queue"):u("/dashboard")}catch(S){console.error("Login failed:",S),l(S.message||"Login failed. Please check your credentials.")}finally{f(!1)}},g=async v=>{f(!0),l(null);try{const S=await pe("/api/auth/google",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:v.credential})});if(!S.ok)throw new Error("Google Sign-In failed");const k=await S.json();localStorage.setItem("authToken",k.token),localStorage.setItem("currentUser",JSON.stringify(k.user)),k.user.clinic_id&&localStorage.setItem("currentClinicId",k.user.clinic_id),e(k.user),k.user.role==="doctor"?u("/dashboard/queue"):u("/dashboard")}catch(S){console.error("Google Login Error:",S),l("Google Sign-In failed. Please try again.")}finally{f(!1)}},b=()=>{console.error("Google Login Failed"),l("Google Sign-In was unsuccessful. Please try again.")};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Newtons AI HMS"}),i.jsx("p",{className:"auth-subtitle",children:"Sign in to continue"}),i.jsxs("form",{onSubmit:p,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:n,onChange:v=>t(v.target.value),className:"auth-text-input",placeholder:" "}),i.jsx("label",{htmlFor:"email",children:"Email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:r,onChange:v=>a(v.target.value),className:"auth-text-input",placeholder:" "}),i.jsx("label",{htmlFor:"password",children:"Password"})]}),o&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:o})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:d,className:"auth-submit-button",children:d?"Signing in...":"Sign In"})})]}),i.jsx("div",{className:"google-login-container",children:i.jsx(hP,{onSuccess:g,onError:b,useOneTap:!0})}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Don't have an account?"," ",i.jsx(ds,{to:"/register",className:"auth-navigation-link",children:"Create account"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})},qD=()=>{const[e,n]=w.useState(""),[t,r]=w.useState(""),[a,o]=w.useState(""),[l,d]=w.useState(""),[f,u]=w.useState(null),[p,g]=w.useState(!1),b=Et(),v=async S=>{S.preventDefault(),g(!0),u(null);try{const k=await pe("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicName:e,userName:t,userEmail:a,userPassword:l})}),T=await k.json();if(!k.ok)throw new Error(T.message||`HTTP error! status: ${k.status}`);console.log("Registration successful:",T),alert("Registration successful! Please log in."),b("/login")}catch(k){console.error("Registration failed:",k),u(k.message||"Registration failed. Please try again.")}finally{g(!1)}};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Register Clinic & Admin"}),i.jsxs("form",{onSubmit:v,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"clinicName",children:"Clinic Name"}),i.jsx("input",{id:"clinicName",name:"clinicName",type:"text",required:!0,value:e,onChange:S=>n(S.target.value),className:"auth-text-input",placeholder:"Your Clinic's Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userName",children:"Your Name (Admin)"}),i.jsx("input",{id:"userName",name:"userName",type:"text",required:!0,value:t,onChange:S=>r(S.target.value),className:"auth-text-input",placeholder:"Your Full Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userEmail",children:"Your Email (Admin Login)"}),i.jsx("input",{id:"userEmail",name:"userEmail",type:"email",autoComplete:"email",required:!0,value:a,onChange:S=>o(S.target.value),className:"auth-text-input",placeholder:"you@example.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userPassword",children:"Password"}),i.jsx("input",{id:"userPassword",name:"userPassword",type:"password",required:!0,minLength:6,value:l,onChange:S=>d(S.target.value),className:"auth-text-input",placeholder:"Min. 6 characters"})]}),f&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:f})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:p,className:"auth-submit-button",children:p?"Registering...":"Register Clinic & Admin"})})]}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Already have an account?"," ",i.jsx(ds,{to:"/login",className:"auth-navigation-link",children:"Sign in"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})};var Q_={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},CS=jn.createContext&&jn.createContext(Q_),VD=["attr","size","title"];function HD(e,n){if(e==null)return{};var t=GD(e,n),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}function GD(e,n){if(e==null)return{};var t={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(n.indexOf(r)>=0)continue;t[r]=e[r]}return t}function Gx(){return Gx=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Gx.apply(this,arguments)}function jS(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function Yx(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?jS(Object(t),!0).forEach(function(r){YD(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):jS(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function YD(e,n,t){return n=WD(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function WD(e){var n=QD(e,"string");return typeof n=="symbol"?n:n+""}function QD(e,n){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function J_(e){return e&&e.map((n,t)=>jn.createElement(n.tag,Yx({key:t},n.attr),J_(n.child)))}function La(e){return n=>jn.createElement(JD,Gx({attr:Yx({},e.attr)},n),J_(e.child))}function JD(e){var n=t=>{var{attr:r,size:a,title:o}=e,l=HD(e,VD),d=a||t.size||"1em",f;return t.className&&(f=t.className),e.className&&(f=(f?f+" ":"")+e.className),jn.createElement("svg",Gx({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,l,{className:f,style:Yx(Yx({color:e.color||t.color},t.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),o&&jn.createElement("title",null,o),e.children)};return CS!==void 0?jn.createElement(CS.Consumer,null,t=>n(t)):n(Q_)}function Vv(e){return La({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(e)}function _S(e){return La({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function kS(e){return La({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M437.2 403.5L320 215V64h8c13.3 0 24-10.7 24-24V24c0-13.3-10.7-24-24-24H120c-13.3 0-24 10.7-24 24v16c0 13.3 10.7 24 24 24h8v151L10.8 403.5C-18.5 450.6 15.3 512 70.9 512h306.2c55.7 0 89.4-61.5 60.1-108.5zM137.9 320l48.2-77.6c3.7-5.2 5.8-11.6 5.8-18.4V64h64v160c0 6.9 2.2 13.2 5.8 18.4l48.2 77.6h-172z"},child:[]}]})(e)}function bh(e){return La({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function lx(e){return La({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M480 320a96 96 0 1 0-96-96 96 96 0 0 0 96 96zm48 32a22.88 22.88 0 0 0-7.06 1.09 124.76 124.76 0 0 1-81.89 0A22.82 22.82 0 0 0 432 352a112 112 0 0 0-112 112.62c.14 26.26 21.73 47.38 48 47.38h224c26.27 0 47.86-21.12 48-47.38A112 112 0 0 0 528 352zm-198.09 10.45A145.19 145.19 0 0 1 352 344.62V128a32 32 0 0 0-32-32h-32V32a32 32 0 0 0-32-32H96a32 32 0 0 0-32 32v64H32a32 32 0 0 0-32 32v368a16 16 0 0 0 16 16h288.31A78.62 78.62 0 0 1 288 464.79a143.06 143.06 0 0 1 41.91-102.34zM144 404a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm48-122a6 6 0 0 1-6 6h-20a6 6 0 0 1-6-6v-26h-26a6 6 0 0 1-6-6v-20a6 6 0 0 1 6-6h26V70a6 6 0 0 1 6-6h20a6 6 0 0 1 6 6v26h26a6 6 0 0 1 6 6v20a6 6 0 0 1-6 6h-26zm80 250a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12z"},child:[]}]})(e)}function cx(e){return La({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M352 288h-16v-88c0-4.42-3.58-8-8-8h-13.58c-4.74 0-9.37 1.4-13.31 4.03l-15.33 10.22a7.994 7.994 0 0 0-2.22 11.09l8.88 13.31a7.994 7.994 0 0 0 11.09 2.22l.47-.31V288h-16c-4.42 0-8 3.58-8 8v16c0 4.42 3.58 8 8 8h64c4.42 0 8-3.58 8-8v-16c0-4.42-3.58-8-8-8zM608 64H32C14.33 64 0 78.33 0 96v320c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V96c0-17.67-14.33-32-32-32zM48 400v-64c35.35 0 64 28.65 64 64H48zm0-224v-64h64c0 35.35-28.65 64-64 64zm272 192c-53.02 0-96-50.15-96-112 0-61.86 42.98-112 96-112s96 50.14 96 112c0 61.87-43 112-96 112zm272 32h-64c0-35.35 28.65-64 64-64v64zm0-224c-35.35 0-64-28.65-64-64h64v64z"},child:[]}]})(e)}function ux(e){return La({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M112 32C50.1 32 0 82.1 0 144v224c0 61.9 50.1 112 112 112s112-50.1 112-112V144c0-61.9-50.1-112-112-112zm48 224H64V144c0-26.5 21.5-48 48-48s48 21.5 48 48v112zm139.7-29.7c-3.5-3.5-9.4-3.1-12.3.8-45.3 62.5-40.4 150.1 15.9 206.4 56.3 56.3 143.9 61.2 206.4 15.9 4-2.9 4.3-8.8.8-12.3L299.7 226.3zm229.8-19c-56.3-56.3-143.9-61.2-206.4-15.9-4 2.9-4.3 8.8-.8 12.3l210.8 210.8c3.5 3.5 9.4 3.1 12.3-.8 45.3-62.6 40.5-150.1-15.9-206.4z"},child:[]}]})(e)}function vh(e){return La({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function K_(e){return La({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(e)}function TS(e){return La({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M447.1 112c-34.2.5-62.3 28.4-63 62.6-.5 24.3 12.5 45.6 32 56.8V344c0 57.3-50.2 104-112 104-60 0-109.2-44.1-111.9-99.2C265 333.8 320 269.2 320 192V36.6c0-11.4-8.1-21.3-19.3-23.5L237.8.5c-13-2.6-25.6 5.8-28.2 18.8L206.4 35c-2.6 13 5.8 25.6 18.8 28.2l30.7 6.1v121.4c0 52.9-42.2 96.7-95.1 97.2-53.4.5-96.9-42.7-96.9-96V69.4l30.7-6.1c13-2.6 21.4-15.2 18.8-28.2l-3.1-15.7C107.7 6.4 95.1-2 82.1.6L19.3 13C8.1 15.3 0 25.1 0 36.6V192c0 77.3 55.1 142 128.1 156.8C130.7 439.2 208.6 512 304 512c97 0 176-75.4 176-168V231.4c19.1-11.1 32-31.7 32-55.4 0-35.7-29.2-64.5-64.9-64zm.9 80c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16z"},child:[]}]})(e)}function KD(e){return La({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(e)}function ES(e){return La({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zM104 424c0 13.3 10.7 24 24 24s24-10.7 24-24-10.7-24-24-24-24 10.7-24 24zm216-135.4v49c36.5 7.4 64 39.8 64 78.4v41.7c0 7.6-5.4 14.2-12.9 15.7l-32.2 6.4c-4.3.9-8.5-1.9-9.4-6.3l-3.1-15.7c-.9-4.3 1.9-8.6 6.3-9.4l19.3-3.9V416c0-62.8-96-65.1-96 1.9v26.7l19.3 3.9c4.3.9 7.1 5.1 6.3 9.4l-3.1 15.7c-.9 4.3-5.1 7.1-9.4 6.3l-31.2-4.2c-7.9-1.1-13.8-7.8-13.8-15.9V416c0-38.6 27.5-70.9 64-78.4v-45.2c-2.2.7-4.4 1.1-6.6 1.9-18 6.3-37.3 9.8-57.4 9.8s-39.4-3.5-57.4-9.8c-7.4-2.6-14.9-4.2-22.6-5.2v81.6c23.1 6.9 40 28.1 40 53.4 0 30.9-25.1 56-56 56s-56-25.1-56-56c0-25.3 16.9-46.5 40-53.4v-80.4C48.5 301 0 355.8 0 422.4v44.8C0 491.9 20.1 512 44.8 512h358.4c24.7 0 44.8-20.1 44.8-44.8v-44.8c0-72-56.8-130.3-128-133.8z"},child:[]}]})(e)}function Cm(e){return La({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(e)}const X_={superadmin:[{title:"Admin Pages",links:[{path:"/dashboard",name:"Super Admin Dashboard",icon:bh},{path:"/dashboard/clinic-subscriptions",name:"Clinic Subscriptions",icon:lx},{path:"/dashboard/users",name:"User Management",icon:Cm}]}],admin:[{title:"Dashboard",links:[{path:"/dashboard",name:"Admin Dashboard",icon:bh}]},{title:"Clinic Management",links:[{path:"/dashboard/clinic-hub",name:"Clinic Hub",icon:_S}]},{title:"Patient Management",links:[{path:"/dashboard/patients/add",name:"Add Patient",icon:lx},{path:"/dashboard/patients",name:"All Patients",icon:Cm},{path:"/dashboard/patients/search",name:"Search Patient",icon:vh}]},{title:"Inventory & Pharmacy",links:[{path:"/dashboard/analysis",name:"Analysis Dashboard",icon:Vv},{path:"/dashboard/inventory",name:"Inventory Management",icon:ux},{path:"/dashboard/inventory/add",name:"Add Drug",icon:ux},{path:"/dashboard/distributors",name:"Distributor Management",icon:Cm}]},{title:"Queue & Subscriptions",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:TS},{path:"/dashboard/subscriptions",name:"Manage Subscriptions",icon:cx},{path:"/dashboard/subscriptions/add",name:"Add Subscription Plan",icon:cx}]}],doctor:[{title:"Patient & Admissions",links:[{path:"/dashboard/search",name:"Patient Search",icon:vh},{path:"/dashboard/add-patient",name:"Add Patient",icon:lx},{path:"/manage-admission",name:"Manage Admission",icon:ES}]},{title:"Lab & Billing",links:[{path:"/create-lab-order",name:"Create Lab Order",icon:kS},{path:"/billing",name:"Billing",icon:cx}]},{title:"Queue",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:TS}]}],receptionist:[{title:"Reception",links:[{path:"/dashboard",name:"Reception Dashboard",icon:bh}]},{title:"Patient Management",links:[{path:"/dashboard/all-patients",name:"All Patients",icon:Cm},{path:"/dashboard/patients/add",name:"Add Patient",icon:lx},{path:"/dashboard/patients/search",name:"Search Patient",icon:vh}]},{title:"Billing & Admissions",links:[{path:"/billing",name:"Billing",icon:cx},{path:"/manage-admission",name:"Manage Admission",icon:ES}]}],lab:[{title:"Lab Operations",links:[{path:"/dashboard",name:"Lab Dashboard",icon:bh},{path:"/lab-inventory",name:"Lab Test Inventory",icon:kS},{path:"/lab/search-report",name:"Search Lab Report",icon:vh}]}],pharmacy:[{title:"Pharmacy Operations",links:[{path:"/dashboard",name:"Pharmacy Queue",icon:bh},{path:"/dashboard/inventory",name:"Pharmacy Inventory",icon:ux},{path:"/dashboard/inventory/add",name:"Add Drug",icon:ux},{path:"/dashboard/add-order",name:"Add Pharmacy Order",icon:Vv},{path:"/dashboard/distributors",name:"Distributor Management",icon:Cm}]},{title:"Analysis & Settings",links:[{path:"/dashboard/analysis",name:"Analysis Dashboard",icon:Vv},{path:"/dashboard/settings",name:"Pharmacy Settings",icon:_S},{path:"/dashboard/search-patient-records",name:"Search Patient Records",icon:vh}]}]},XD=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a})=>{const o=Yr(),[l,d]=w.useState(""),f=X_[t]||[],[u,p]=w.useState(500),g=w.useRef(!1),b=w.useCallback(T=>{g.current=!0,T.preventDefault()},[]),v=w.useCallback(()=>{g.current=!1},[]),S=w.useCallback(T=>{if(g.current){const P=window.innerWidth-T.clientX;P>250&&P<window.innerWidth*.8&&p(P)}},[]);w.useEffect(()=>(window.addEventListener("mousemove",S),window.addEventListener("mouseup",v),()=>{window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",v)}),[S,v]);const k=f.map(T=>({...T,links:T.links.filter(P=>P.name.toLowerCase().includes(l.toLowerCase()))})).filter(T=>T.links.length>0);return i.jsxs("div",{className:`side-panel ${r?"open":""}`,style:{width:`${u}px`,right:r?"0":`-${u}px`},children:[i.jsx("div",{className:"resizer",onMouseDown:b}),i.jsxs("div",{className:"side-panel-header",children:[i.jsx(ds,{to:"/dashboard",className:"home-button",onClick:a,children:i.jsx(bh,{})}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx(vh,{style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",color:"#94a3b8"}}),i.jsx("input",{type:"text",placeholder:"Search pages...",className:"search-bar",value:l,onChange:T=>d(T.target.value)})]}),i.jsx("button",{className:"close-button",onClick:a,children:""})]}),i.jsx("nav",{children:k.map((T,P)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:T.title}),i.jsx("ul",{className:"sub-page-list",children:T.links.map(M=>{const I=M.icon;return i.jsx("li",{children:i.jsxs(ds,{to:M.path,className:o.pathname===M.path?"active":"",onClick:a,children:[I&&i.jsx(I,{})," ",M.name]})},M.path)})})]},P))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx(K_,{})," Logout"]})]})]})},ZD=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a,roleNavigation:o})=>{const l=Yr(),d=o[t]||[];return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:`mobile-side-panel-overlay ${r?"open":""}`,onClick:a}),i.jsxs("div",{className:`mobile-side-panel ${r?"open":""}`,children:[i.jsxs("div",{className:"mobile-side-panel-header",children:[i.jsx("h3",{children:"Menu"}),i.jsx("button",{className:"close-button",onClick:a,children:i.jsx(KD,{})})]}),i.jsx("nav",{children:d.map((f,u)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:f.title}),i.jsx("ul",{className:"sub-page-list",children:f.links.map(p=>{const g=p.icon;return i.jsx("li",{children:i.jsxs(ds,{to:p.path,className:l.pathname===p.path?"active":"",onClick:a,children:[g&&i.jsx(g,{})," ",p.name]})},p.path)})})]},u))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx(K_,{})," Logout"]})]})]})]})};var Hv,AS;function eI(){if(AS)return Hv;AS=1;var e="Expected a function",n=NaN,t="[object Symbol]",r=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,l=/^0o[0-7]+$/i,d=parseInt,f=typeof su=="object"&&su&&su.Object===Object&&su,u=typeof self=="object"&&self&&self.Object===Object&&self,p=f||u||Function("return this")(),g=Object.prototype,b=g.toString,v=Math.max,S=Math.min,k=function(){return p.Date.now()};function T(L,$,z){var F,Y,R,B,G,ie,te=0,W=!1,V=!1,se=!0;if(typeof L!="function")throw new TypeError(e);$=U($)||0,P(z)&&(W=!!z.leading,V="maxWait"in z,R=V?v(U(z.maxWait)||0,$):R,se="trailing"in z?!!z.trailing:se);function re(fe){var ae=F,Me=Y;return F=Y=void 0,te=fe,B=L.apply(Me,ae),B}function oe(fe){return te=fe,G=setTimeout(ue,$),W?re(fe):B}function E(fe){var ae=fe-ie,Me=fe-te,Ke=$-ae;return V?S(Ke,R-Me):Ke}function le(fe){var ae=fe-ie,Me=fe-te;return ie===void 0||ae>=$||ae<0||V&&Me>=R}function ue(){var fe=k();if(le(fe))return D(fe);G=setTimeout(ue,E(fe))}function D(fe){return G=void 0,se&&F?re(fe):(F=Y=void 0,B)}function ce(){G!==void 0&&clearTimeout(G),te=0,F=ie=Y=G=void 0}function ve(){return G===void 0?B:D(k())}function X(){var fe=k(),ae=le(fe);if(F=arguments,Y=this,ie=fe,ae){if(G===void 0)return oe(ie);if(V)return G=setTimeout(ue,$),re(ie)}return G===void 0&&(G=setTimeout(ue,$)),B}return X.cancel=ce,X.flush=ve,X}function P(L){var $=typeof L;return!!L&&($=="object"||$=="function")}function M(L){return!!L&&typeof L=="object"}function I(L){return typeof L=="symbol"||M(L)&&b.call(L)==t}function U(L){if(typeof L=="number")return L;if(I(L))return n;if(P(L)){var $=typeof L.valueOf=="function"?L.valueOf():L;L=P($)?$+"":$}if(typeof L!="string")return L===0?L:+L;L=L.replace(r,"");var z=o.test(L);return z||l.test(L)?d(L.slice(2),z?2:8):a.test(L)?n:+L}return Hv=T,Hv}var tI=eI();const vb=Ud(tI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),rI=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,t,r)=>r?r.toUpperCase():t.toLowerCase()),PS=e=>{const n=rI(e);return n.charAt(0).toUpperCase()+n.slice(1)},Z_=(...e)=>e.filter((n,t,r)=>!!n&&n.trim()!==""&&r.indexOf(n)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var iI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=w.forwardRef(({color:e="currentColor",size:n=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:a="",children:o,iconNode:l,...d},f)=>w.createElement("svg",{ref:f,...iI,width:n,height:n,stroke:e,strokeWidth:r?Number(t)*24/Number(n):t,className:Z_("lucide",a),...d},[...l.map(([u,p])=>w.createElement(u,p)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=(e,n)=>{const t=w.forwardRef(({className:r,...a},o)=>w.createElement(aI,{ref:o,iconNode:n,className:Z_(`lucide-${nI(PS(e))}`,`lucide-${e}`,r),...a}));return t.displayName=PS(e),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sI=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],DS=dt("arrow-down",sI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oI=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],nn=dt("arrow-left",oI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lI=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],K0=dt("arrow-up",lI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cI=[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]],uI=dt("beaker",cI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dI=[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]],fI=dt("bed-double",dI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hI=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],pI=dt("brain-circuit",hI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mI=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],e2=dt("brain",mI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gI=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],yI=dt("building",gI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]],IS=dt("calendar-check-2",xI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],vI=dt("calendar-days",bI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Wx=dt("calendar",wI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SI=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Qx=dt("check",SI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NI=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],RS=dt("chevron-down",NI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CI=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],aw=dt("chevron-left",CI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jI=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],$h=dt("chevron-right",jI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _I=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],MS=dt("chevron-up",_I);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Er=dt("circle-alert",kI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TI=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],fs=dt("circle-check-big",TI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]],AI=dt("circle-minus",EI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],us=dt("circle-plus",PI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],II=dt("circle-user",DI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RI=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],sw=dt("clipboard-list",RI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MI=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],X0=dt("clipboard",MI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OI=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],LI=dt("copy",OI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FI=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],$I=dt("credit-card",FI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zI=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Eh=dt("dollar-sign",zI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UI=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],BI=dt("eye",UI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qI=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],VI=dt("file-check",qI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HI=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],lu=dt("file-text",HI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GI=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],Wl=dt("flask-conical",GI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YI=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],WI=dt("funnel",YI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QI=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Ym=dt("hash",QI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JI=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],t2=dt("house",JI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Qo=dt("info",KI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XI=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],n2=dt("key",XI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZI=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],r2=dt("layout-grid",ZI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]],tR=dt("list-ordered",eR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nR=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],rR=dt("list",nR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iR=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Ah=dt("loader-circle",iR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aR=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],OS=dt("lock",aR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sR=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],i2=dt("map-pin",sR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oR=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],lR=dt("mic-off",oR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cR=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],a2=dt("mic",cR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uR=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],dR=dt("monitor",uR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fR=[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]],hR=dt("package-open",fR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pR=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Md=dt("package",pR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mR=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],gR=dt("paperclip",mR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yR=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],xR=dt("pause",yR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bR=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Gv=dt("pen",bR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vR=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Vl=dt("pencil",vR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wR=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],s2=dt("phone",wR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SR=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],ig=dt("pill",SR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NR=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],CR=dt("play",NR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jR=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ql=dt("plus",jR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _R=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Go=dt("printer",_R);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kR=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Jx=dt("refresh-cw",kR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TR=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Od=dt("save",TR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ER=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],ua=dt("search",ER);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AR=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],PR=dt("send",AR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DR=[["path",{d:"M6 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-2",key:"4b9dqc"}],["path",{d:"M6 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-2",key:"22nnkd"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m13 6-4 6h6l-4 6",key:"14hqih"}]],LS=dt("server-crash",DR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IR=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],wb=dt("settings",IR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RR=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],o2=dt("share-2",RR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MR=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],OR=dt("shield-check",MR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LR=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],FR=dt("shopping-cart",LR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $R=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],zR=dt("sparkles",$R);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UR=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],cu=dt("square-pen",UR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BR=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],l2=dt("stethoscope",BR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qR=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],VR=dt("table",qR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HR=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],GR=dt("tag",HR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YR=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],li=dt("trash-2",YR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WR=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],QR=dt("triangle-alert",WR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JR=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],KR=dt("truck",JR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XR=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],FS=dt("upload",XR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],ow=dt("user-check",ZR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e4=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],c2=dt("user-plus",e4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t4=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Ko=dt("user",t4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n4=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],zh=dt("users",n4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r4=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],i4=dt("video",r4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a4=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Xn=dt("x",a4);var Yv={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var $S;function s4(){return $S||($S=1,function(e){(function(){var n={}.hasOwnProperty;function t(){for(var o="",l=0;l<arguments.length;l++){var d=arguments[l];d&&(o=a(o,r(d)))}return o}function r(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return t.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var l="";for(var d in o)n.call(o,d)&&o[d]&&(l=a(l,d));return l}function a(o,l){return l?o?o+" "+l:o+l:o}e.exports?(t.default=t,e.exports=t):window.classNames=t})()}(Yv)),Yv.exports}var o4=s4();const ou=Ud(o4);function Ld(e){"@babel/helpers - typeof";return Ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Ld(e)}function l4(e,n){if(Ld(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(Ld(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function u2(e){var n=l4(e,"string");return Ld(n)=="symbol"?n:n+""}function Lm(e,n,t){return(n=u2(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function zS(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function Rt(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?zS(Object(t),!0).forEach(function(r){Lm(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):zS(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function c4(e){if(Array.isArray(e))return e}function u4(e,n){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var r,a,o,l,d=[],f=!0,u=!1;try{if(o=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;f=!1}else for(;!(f=(r=o.call(t)).done)&&(d.push(r.value),d.length!==n);f=!0);}catch(p){u=!0,a=p}finally{try{if(!f&&t.return!=null&&(l=t.return(),Object(l)!==l))return}finally{if(u)throw a}}return d}}function Z0(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function d2(e,n){if(e){if(typeof e=="string")return Z0(e,n);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Z0(e,n):void 0}}function d4(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gl(e,n){return c4(e)||u4(e,n)||d2(e,n)||d4()}function f4(e,n){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(n.indexOf(r)!==-1)continue;t[r]=e[r]}return t}function Kl(e,n){if(e==null)return{};var t,r,a=f4(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var h4=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function p4(e){var n=e.defaultInputValue,t=n===void 0?"":n,r=e.defaultMenuIsOpen,a=r===void 0?!1:r,o=e.defaultValue,l=o===void 0?null:o,d=e.inputValue,f=e.menuIsOpen,u=e.onChange,p=e.onInputChange,g=e.onMenuClose,b=e.onMenuOpen,v=e.value,S=Kl(e,h4),k=w.useState(d!==void 0?d:t),T=Gl(k,2),P=T[0],M=T[1],I=w.useState(f!==void 0?f:a),U=Gl(I,2),L=U[0],$=U[1],z=w.useState(v!==void 0?v:l),F=Gl(z,2),Y=F[0],R=F[1],B=w.useCallback(function(re,oe){typeof u=="function"&&u(re,oe),R(re)},[u]),G=w.useCallback(function(re,oe){var E;typeof p=="function"&&(E=p(re,oe)),M(E!==void 0?E:re)},[p]),ie=w.useCallback(function(){typeof b=="function"&&b(),$(!0)},[b]),te=w.useCallback(function(){typeof g=="function"&&g(),$(!1)},[g]),W=d!==void 0?d:P,V=f!==void 0?f:L,se=v!==void 0?v:Y;return Rt(Rt({},S),{},{inputValue:W,menuIsOpen:V,onChange:B,onInputChange:G,onMenuClose:te,onMenuOpen:ie,value:se})}function $t(){return $t=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},$t.apply(null,arguments)}function m4(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function US(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u2(r.key),r)}}function g4(e,n,t){return n&&US(e.prototype,n),t&&US(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function e1(e,n){return e1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},e1(e,n)}function y4(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&e1(e,n)}function Kx(e){return Kx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Kx(e)}function f2(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(f2=function(){return!!e})()}function x4(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b4(e,n){if(n&&(Ld(n)=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return x4(e)}function v4(e){var n=f2();return function(){var t,r=Kx(e);if(n){var a=Kx(this).constructor;t=Reflect.construct(r,arguments,a)}else t=r.apply(this,arguments);return b4(this,t)}}function w4(e){if(Array.isArray(e))return Z0(e)}function S4(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function N4(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lw(e){return w4(e)||S4(e)||d2(e)||N4()}function C4(e){if(e.sheet)return e.sheet;for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].ownerNode===e)return document.styleSheets[n]}function j4(e){var n=document.createElement("style");return n.setAttribute("data-emotion",e.key),e.nonce!==void 0&&n.setAttribute("nonce",e.nonce),n.appendChild(document.createTextNode("")),n.setAttribute("data-s",""),n}var _4=function(){function e(t){var r=this;this._insertTag=function(a){var o;r.tags.length===0?r.insertionPoint?o=r.insertionPoint.nextSibling:r.prepend?o=r.container.firstChild:o=r.before:o=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(a,o),r.tags.push(a)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var n=e.prototype;return n.hydrate=function(r){r.forEach(this._insertTag)},n.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(j4(this));var a=this.tags[this.tags.length-1];if(this.isSpeedy){var o=C4(a);try{o.insertRule(r,o.cssRules.length)}catch{}}else a.appendChild(document.createTextNode(r));this.ctr++},n.flush=function(){this.tags.forEach(function(r){var a;return(a=r.parentNode)==null?void 0:a.removeChild(r)}),this.tags=[],this.ctr=0},e}(),Si="-ms-",Xx="-moz-",In="-webkit-",h2="comm",cw="rule",uw="decl",k4="@import",p2="@keyframes",T4="@layer",E4=Math.abs,Sb=String.fromCharCode,A4=Object.assign;function P4(e,n){return oi(e,0)^45?(((n<<2^oi(e,0))<<2^oi(e,1))<<2^oi(e,2))<<2^oi(e,3):0}function m2(e){return e.trim()}function D4(e,n){return(e=n.exec(e))?e[0]:e}function Rn(e,n,t){return e.replace(n,t)}function t1(e,n){return e.indexOf(n)}function oi(e,n){return e.charCodeAt(n)|0}function Wm(e,n,t){return e.slice(n,t)}function Vo(e){return e.length}function dw(e){return e.length}function dx(e,n){return n.push(e),e}function I4(e,n){return e.map(n).join("")}var Nb=1,Ph=1,g2=0,ha=0,Lr=0,Uh="";function Cb(e,n,t,r,a,o,l){return{value:e,root:n,parent:t,type:r,props:a,children:o,line:Nb,column:Ph,length:l,return:""}}function jm(e,n){return A4(Cb("",null,null,"",null,null,0),e,{length:-e.length},n)}function R4(){return Lr}function M4(){return Lr=ha>0?oi(Uh,--ha):0,Ph--,Lr===10&&(Ph=1,Nb--),Lr}function Ra(){return Lr=ha<g2?oi(Uh,ha++):0,Ph++,Lr===10&&(Ph=1,Nb++),Lr}function Jo(){return oi(Uh,ha)}function Rx(){return ha}function ag(e,n){return Wm(Uh,e,n)}function Qm(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function y2(e){return Nb=Ph=1,g2=Vo(Uh=e),ha=0,[]}function x2(e){return Uh="",e}function Mx(e){return m2(ag(ha-1,n1(e===91?e+2:e===40?e+1:e)))}function O4(e){for(;(Lr=Jo())&&Lr<33;)Ra();return Qm(e)>2||Qm(Lr)>3?"":" "}function L4(e,n){for(;--n&&Ra()&&!(Lr<48||Lr>102||Lr>57&&Lr<65||Lr>70&&Lr<97););return ag(e,Rx()+(n<6&&Jo()==32&&Ra()==32))}function n1(e){for(;Ra();)switch(Lr){case e:return ha;case 34:case 39:e!==34&&e!==39&&n1(Lr);break;case 40:e===41&&n1(e);break;case 92:Ra();break}return ha}function F4(e,n){for(;Ra()&&e+Lr!==57;)if(e+Lr===84&&Jo()===47)break;return"/*"+ag(n,ha-1)+"*"+Sb(e===47?e:Ra())}function $4(e){for(;!Qm(Jo());)Ra();return ag(e,ha)}function z4(e){return x2(Ox("",null,null,null,[""],e=y2(e),0,[0],e))}function Ox(e,n,t,r,a,o,l,d,f){for(var u=0,p=0,g=l,b=0,v=0,S=0,k=1,T=1,P=1,M=0,I="",U=a,L=o,$=r,z=I;T;)switch(S=M,M=Ra()){case 40:if(S!=108&&oi(z,g-1)==58){t1(z+=Rn(Mx(M),"&","&\f"),"&\f")!=-1&&(P=-1);break}case 34:case 39:case 91:z+=Mx(M);break;case 9:case 10:case 13:case 32:z+=O4(S);break;case 92:z+=L4(Rx()-1,7);continue;case 47:switch(Jo()){case 42:case 47:dx(U4(F4(Ra(),Rx()),n,t),f);break;default:z+="/"}break;case 123*k:d[u++]=Vo(z)*P;case 125*k:case 59:case 0:switch(M){case 0:case 125:T=0;case 59+p:P==-1&&(z=Rn(z,/\f/g,"")),v>0&&Vo(z)-g&&dx(v>32?qS(z+";",r,t,g-1):qS(Rn(z," ","")+";",r,t,g-2),f);break;case 59:z+=";";default:if(dx($=BS(z,n,t,u,p,a,d,I,U=[],L=[],g),o),M===123)if(p===0)Ox(z,n,$,$,U,o,g,d,L);else switch(b===99&&oi(z,3)===110?100:b){case 100:case 108:case 109:case 115:Ox(e,$,$,r&&dx(BS(e,$,$,0,0,a,d,I,a,U=[],g),L),a,L,g,d,r?U:L);break;default:Ox(z,$,$,$,[""],L,0,d,L)}}u=p=v=0,k=P=1,I=z="",g=l;break;case 58:g=1+Vo(z),v=S;default:if(k<1){if(M==123)--k;else if(M==125&&k++==0&&M4()==125)continue}switch(z+=Sb(M),M*k){case 38:P=p>0?1:(z+="\f",-1);break;case 44:d[u++]=(Vo(z)-1)*P,P=1;break;case 64:Jo()===45&&(z+=Mx(Ra())),b=Jo(),p=g=Vo(I=z+=$4(Rx())),M++;break;case 45:S===45&&Vo(z)==2&&(k=0)}}return o}function BS(e,n,t,r,a,o,l,d,f,u,p){for(var g=a-1,b=a===0?o:[""],v=dw(b),S=0,k=0,T=0;S<r;++S)for(var P=0,M=Wm(e,g+1,g=E4(k=l[S])),I=e;P<v;++P)(I=m2(k>0?b[P]+" "+M:Rn(M,/&\f/g,b[P])))&&(f[T++]=I);return Cb(e,n,t,a===0?cw:d,f,u,p)}function U4(e,n,t){return Cb(e,n,t,h2,Sb(R4()),Wm(e,2,-2),0)}function qS(e,n,t,r){return Cb(e,n,t,uw,Wm(e,0,r),Wm(e,r+1,-1),r)}function Ch(e,n){for(var t="",r=dw(e),a=0;a<r;a++)t+=n(e[a],a,e,n)||"";return t}function B4(e,n,t,r){switch(e.type){case T4:if(e.children.length)break;case k4:case uw:return e.return=e.return||e.value;case h2:return"";case p2:return e.return=e.value+"{"+Ch(e.children,r)+"}";case cw:e.value=e.props.join(",")}return Vo(t=Ch(e.children,r))?e.return=e.value+"{"+t+"}":""}function q4(e){var n=dw(e);return function(t,r,a,o){for(var l="",d=0;d<n;d++)l+=e[d](t,r,a,o)||"";return l}}function V4(e){return function(n){n.root||(n=n.return)&&e(n)}}function H4(e){var n=Object.create(null);return function(t){return n[t]===void 0&&(n[t]=e(t)),n[t]}}var G4=function(n,t,r){for(var a=0,o=0;a=o,o=Jo(),a===38&&o===12&&(t[r]=1),!Qm(o);)Ra();return ag(n,ha)},Y4=function(n,t){var r=-1,a=44;do switch(Qm(a)){case 0:a===38&&Jo()===12&&(t[r]=1),n[r]+=G4(ha-1,t,r);break;case 2:n[r]+=Mx(a);break;case 4:if(a===44){n[++r]=Jo()===58?"&\f":"",t[r]=n[r].length;break}default:n[r]+=Sb(a)}while(a=Ra());return n},W4=function(n,t){return x2(Y4(y2(n),t))},VS=new WeakMap,Q4=function(n){if(!(n.type!=="rule"||!n.parent||n.length<1)){for(var t=n.value,r=n.parent,a=n.column===r.column&&n.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(n.props.length===1&&t.charCodeAt(0)!==58&&!VS.get(r))&&!a){VS.set(n,!0);for(var o=[],l=W4(t,o),d=r.props,f=0,u=0;f<l.length;f++)for(var p=0;p<d.length;p++,u++)n.props[u]=o[f]?l[f].replace(/&\f/g,d[p]):d[p]+" "+l[f]}}},J4=function(n){if(n.type==="decl"){var t=n.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(n.return="",n.value="")}};function b2(e,n){switch(P4(e,n)){case 5103:return In+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return In+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return In+e+Xx+e+Si+e+e;case 6828:case 4268:return In+e+Si+e+e;case 6165:return In+e+Si+"flex-"+e+e;case 5187:return In+e+Rn(e,/(\w+).+(:[^]+)/,In+"box-$1$2"+Si+"flex-$1$2")+e;case 5443:return In+e+Si+"flex-item-"+Rn(e,/flex-|-self/,"")+e;case 4675:return In+e+Si+"flex-line-pack"+Rn(e,/align-content|flex-|-self/,"")+e;case 5548:return In+e+Si+Rn(e,"shrink","negative")+e;case 5292:return In+e+Si+Rn(e,"basis","preferred-size")+e;case 6060:return In+"box-"+Rn(e,"-grow","")+In+e+Si+Rn(e,"grow","positive")+e;case 4554:return In+Rn(e,/([^-])(transform)/g,"$1"+In+"$2")+e;case 6187:return Rn(Rn(Rn(e,/(zoom-|grab)/,In+"$1"),/(image-set)/,In+"$1"),e,"")+e;case 5495:case 3959:return Rn(e,/(image-set\([^]*)/,In+"$1$`$1");case 4968:return Rn(Rn(e,/(.+:)(flex-)?(.*)/,In+"box-pack:$3"+Si+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+In+e+e;case 4095:case 3583:case 4068:case 2532:return Rn(e,/(.+)-inline(.+)/,In+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Vo(e)-1-n>6)switch(oi(e,n+1)){case 109:if(oi(e,n+4)!==45)break;case 102:return Rn(e,/(.+:)(.+)-([^]+)/,"$1"+In+"$2-$3$1"+Xx+(oi(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~t1(e,"stretch")?b2(Rn(e,"stretch","fill-available"),n)+e:e}break;case 4949:if(oi(e,n+1)!==115)break;case 6444:switch(oi(e,Vo(e)-3-(~t1(e,"!important")&&10))){case 107:return Rn(e,":",":"+In)+e;case 101:return Rn(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+In+(oi(e,14)===45?"inline-":"")+"box$3$1"+In+"$2$3$1"+Si+"$2box$3")+e}break;case 5936:switch(oi(e,n+11)){case 114:return In+e+Si+Rn(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return In+e+Si+Rn(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return In+e+Si+Rn(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return In+e+Si+e+e}return e}var K4=function(n,t,r,a){if(n.length>-1&&!n.return)switch(n.type){case uw:n.return=b2(n.value,n.length);break;case p2:return Ch([jm(n,{value:Rn(n.value,"@","@"+In)})],a);case cw:if(n.length)return I4(n.props,function(o){switch(D4(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Ch([jm(n,{props:[Rn(o,/:(read-\w+)/,":"+Xx+"$1")]})],a);case"::placeholder":return Ch([jm(n,{props:[Rn(o,/:(plac\w+)/,":"+In+"input-$1")]}),jm(n,{props:[Rn(o,/:(plac\w+)/,":"+Xx+"$1")]}),jm(n,{props:[Rn(o,/:(plac\w+)/,Si+"input-$1")]})],a)}return""})}},X4=[K4],Z4=function(n){var t=n.key;if(t==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(k){var T=k.getAttribute("data-emotion");T.indexOf(" ")!==-1&&(document.head.appendChild(k),k.setAttribute("data-s",""))})}var a=n.stylisPlugins||X4,o={},l,d=[];l=n.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(k){for(var T=k.getAttribute("data-emotion").split(" "),P=1;P<T.length;P++)o[T[P]]=!0;d.push(k)});var f,u=[Q4,J4];{var p,g=[B4,V4(function(k){p.insert(k)})],b=q4(u.concat(a,g)),v=function(T){return Ch(z4(T),b)};f=function(T,P,M,I){p=M,v(T?T+"{"+P.styles+"}":P.styles),I&&(S.inserted[P.name]=!0)}}var S={key:t,sheet:new _4({key:t,container:l,nonce:n.nonce,speedy:n.speedy,prepend:n.prepend,insertionPoint:n.insertionPoint}),nonce:n.nonce,inserted:o,registered:{},insert:f};return S.sheet.hydrate(d),S},Wv={exports:{}},Fn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HS;function eM(){if(HS)return Fn;HS=1;var e=typeof Symbol=="function"&&Symbol.for,n=e?Symbol.for("react.element"):60103,t=e?Symbol.for("react.portal"):60106,r=e?Symbol.for("react.fragment"):60107,a=e?Symbol.for("react.strict_mode"):60108,o=e?Symbol.for("react.profiler"):60114,l=e?Symbol.for("react.provider"):60109,d=e?Symbol.for("react.context"):60110,f=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,p=e?Symbol.for("react.forward_ref"):60112,g=e?Symbol.for("react.suspense"):60113,b=e?Symbol.for("react.suspense_list"):60120,v=e?Symbol.for("react.memo"):60115,S=e?Symbol.for("react.lazy"):60116,k=e?Symbol.for("react.block"):60121,T=e?Symbol.for("react.fundamental"):60117,P=e?Symbol.for("react.responder"):60118,M=e?Symbol.for("react.scope"):60119;function I(L){if(typeof L=="object"&&L!==null){var $=L.$$typeof;switch($){case n:switch(L=L.type,L){case f:case u:case r:case o:case a:case g:return L;default:switch(L=L&&L.$$typeof,L){case d:case p:case S:case v:case l:return L;default:return $}}case t:return $}}}function U(L){return I(L)===u}return Fn.AsyncMode=f,Fn.ConcurrentMode=u,Fn.ContextConsumer=d,Fn.ContextProvider=l,Fn.Element=n,Fn.ForwardRef=p,Fn.Fragment=r,Fn.Lazy=S,Fn.Memo=v,Fn.Portal=t,Fn.Profiler=o,Fn.StrictMode=a,Fn.Suspense=g,Fn.isAsyncMode=function(L){return U(L)||I(L)===f},Fn.isConcurrentMode=U,Fn.isContextConsumer=function(L){return I(L)===d},Fn.isContextProvider=function(L){return I(L)===l},Fn.isElement=function(L){return typeof L=="object"&&L!==null&&L.$$typeof===n},Fn.isForwardRef=function(L){return I(L)===p},Fn.isFragment=function(L){return I(L)===r},Fn.isLazy=function(L){return I(L)===S},Fn.isMemo=function(L){return I(L)===v},Fn.isPortal=function(L){return I(L)===t},Fn.isProfiler=function(L){return I(L)===o},Fn.isStrictMode=function(L){return I(L)===a},Fn.isSuspense=function(L){return I(L)===g},Fn.isValidElementType=function(L){return typeof L=="string"||typeof L=="function"||L===r||L===u||L===o||L===a||L===g||L===b||typeof L=="object"&&L!==null&&(L.$$typeof===S||L.$$typeof===v||L.$$typeof===l||L.$$typeof===d||L.$$typeof===p||L.$$typeof===T||L.$$typeof===P||L.$$typeof===M||L.$$typeof===k)},Fn.typeOf=I,Fn}var GS;function tM(){return GS||(GS=1,Wv.exports=eM()),Wv.exports}var Qv,YS;function nM(){if(YS)return Qv;YS=1;var e=tM(),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},t={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};o[e.ForwardRef]=r,o[e.Memo]=a;function l(S){return e.isMemo(S)?a:o[S.$$typeof]||n}var d=Object.defineProperty,f=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,g=Object.getPrototypeOf,b=Object.prototype;function v(S,k,T){if(typeof k!="string"){if(b){var P=g(k);P&&P!==b&&v(S,P,T)}var M=f(k);u&&(M=M.concat(u(k)));for(var I=l(S),U=l(k),L=0;L<M.length;++L){var $=M[L];if(!t[$]&&!(T&&T[$])&&!(U&&U[$])&&!(I&&I[$])){var z=p(k,$);try{d(S,$,z)}catch{}}}}return S}return Qv=v,Qv}nM();var rM=!0;function iM(e,n,t){var r="";return t.split(" ").forEach(function(a){e[a]!==void 0?n.push(e[a]+";"):a&&(r+=a+" ")}),r}var v2=function(n,t,r){var a=n.key+"-"+t.name;(r===!1||rM===!1)&&n.registered[a]===void 0&&(n.registered[a]=t.styles)},aM=function(n,t,r){v2(n,t,r);var a=n.key+"-"+t.name;if(n.inserted[t.name]===void 0){var o=t;do n.insert(t===o?"."+a:"",o,n.sheet,!0),o=o.next;while(o!==void 0)}};function sM(e){for(var n=0,t,r=0,a=e.length;a>=4;++r,a-=4)t=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,n=(t&65535)*1540483477+((t>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(a){case 3:n^=(e.charCodeAt(r+2)&255)<<16;case 2:n^=(e.charCodeAt(r+1)&255)<<8;case 1:n^=e.charCodeAt(r)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}var oM={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},lM=/[A-Z]|^ms/g,cM=/_EMO_([^_]+?)_([^]*?)_EMO_/g,w2=function(n){return n.charCodeAt(1)===45},WS=function(n){return n!=null&&typeof n!="boolean"},Jv=H4(function(e){return w2(e)?e:e.replace(lM,"-$&").toLowerCase()}),QS=function(n,t){switch(n){case"animation":case"animationName":if(typeof t=="string")return t.replace(cM,function(r,a,o){return Ho={name:a,styles:o,next:Ho},a})}return oM[n]!==1&&!w2(n)&&typeof t=="number"&&t!==0?t+"px":t};function Jm(e,n,t){if(t==null)return"";var r=t;if(r.__emotion_styles!==void 0)return r;switch(typeof t){case"boolean":return"";case"object":{var a=t;if(a.anim===1)return Ho={name:a.name,styles:a.styles,next:Ho},a.name;var o=t;if(o.styles!==void 0){var l=o.next;if(l!==void 0)for(;l!==void 0;)Ho={name:l.name,styles:l.styles,next:Ho},l=l.next;var d=o.styles+";";return d}return uM(e,n,t)}case"function":{if(e!==void 0){var f=Ho,u=t(e);return Ho=f,Jm(e,n,u)}break}}var p=t;return p}function uM(e,n,t){var r="";if(Array.isArray(t))for(var a=0;a<t.length;a++)r+=Jm(e,n,t[a])+";";else for(var o in t){var l=t[o];if(typeof l!="object"){var d=l;WS(d)&&(r+=Jv(o)+":"+QS(o,d)+";")}else if(Array.isArray(l)&&typeof l[0]=="string"&&n==null)for(var f=0;f<l.length;f++)WS(l[f])&&(r+=Jv(o)+":"+QS(o,l[f])+";");else{var u=Jm(e,n,l);switch(o){case"animation":case"animationName":{r+=Jv(o)+":"+u+";";break}default:r+=o+"{"+u+"}"}}}return r}var JS=/label:\s*([^\s;{]+)\s*(;|$)/g,Ho;function S2(e,n,t){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var r=!0,a="";Ho=void 0;var o=e[0];if(o==null||o.raw===void 0)r=!1,a+=Jm(t,n,o);else{var l=o;a+=l[0]}for(var d=1;d<e.length;d++)if(a+=Jm(t,n,e[d]),r){var f=o;a+=f[d]}JS.lastIndex=0;for(var u="",p;(p=JS.exec(a))!==null;)u+="-"+p[1];var g=sM(a)+u;return{name:g,styles:a,next:Ho}}var dM=function(n){return n()},fM=dS.useInsertionEffect?dS.useInsertionEffect:!1,hM=fM||dM,N2=w.createContext(typeof HTMLElement<"u"?Z4({key:"css"}):null);N2.Provider;var pM=function(n){return w.forwardRef(function(t,r){var a=w.useContext(N2);return n(t,a,r)})},mM=w.createContext({}),fw={}.hasOwnProperty,r1="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",gM=function(n,t){var r={};for(var a in t)fw.call(t,a)&&(r[a]=t[a]);return r[r1]=n,r},yM=function(n){var t=n.cache,r=n.serialized,a=n.isStringTag;return v2(t,r,a),hM(function(){return aM(t,r,a)}),null},xM=pM(function(e,n,t){var r=e.css;typeof r=="string"&&n.registered[r]!==void 0&&(r=n.registered[r]);var a=e[r1],o=[r],l="";typeof e.className=="string"?l=iM(n.registered,o,e.className):e.className!=null&&(l=e.className+" ");var d=S2(o,void 0,w.useContext(mM));l+=n.key+"-"+d.name;var f={};for(var u in e)fw.call(e,u)&&u!=="css"&&u!==r1&&(f[u]=e[u]);return f.className=l,t&&(f.ref=t),w.createElement(w.Fragment,null,w.createElement(yM,{cache:n,serialized:d,isStringTag:typeof a=="string"}),w.createElement(a,f))}),bM=xM,Tt=function(n,t){var r=arguments;if(t==null||!fw.call(t,"css"))return w.createElement.apply(void 0,r);var a=r.length,o=new Array(a);o[0]=bM,o[1]=gM(n,t);for(var l=2;l<a;l++)o[l]=r[l];return w.createElement.apply(null,o)};(function(e){var n;n||(n=e.JSX||(e.JSX={}))})(Tt||(Tt={}));function hw(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return S2(n)}function vM(){var e=hw.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function wM(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}const SM=Math.min,NM=Math.max,Zx=Math.round,fx=Math.floor,eb=e=>({x:e,y:e});function CM(e){const{x:n,y:t,width:r,height:a}=e;return{width:r,height:a,top:t,left:n,right:n+r,bottom:t+a,x:n,y:t}}function jb(){return typeof window<"u"}function C2(e){return _2(e)?(e.nodeName||"").toLowerCase():"#document"}function Jl(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function j2(e){var n;return(n=(_2(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function _2(e){return jb()?e instanceof Node||e instanceof Jl(e).Node:!1}function jM(e){return jb()?e instanceof Element||e instanceof Jl(e).Element:!1}function pw(e){return jb()?e instanceof HTMLElement||e instanceof Jl(e).HTMLElement:!1}function KS(e){return!jb()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Jl(e).ShadowRoot}const _M=new Set(["inline","contents"]);function k2(e){const{overflow:n,overflowX:t,overflowY:r,display:a}=mw(e);return/auto|scroll|overlay|hidden|clip/.test(n+r+t)&&!_M.has(a)}function kM(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const TM=new Set(["html","body","#document"]);function EM(e){return TM.has(C2(e))}function mw(e){return Jl(e).getComputedStyle(e)}function AM(e){if(C2(e)==="html")return e;const n=e.assignedSlot||e.parentNode||KS(e)&&e.host||j2(e);return KS(n)?n.host:n}function T2(e){const n=AM(e);return EM(n)?e.ownerDocument?e.ownerDocument.body:e.body:pw(n)&&k2(n)?n:T2(n)}function tb(e,n,t){var r;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=T2(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),l=Jl(a);if(o){const d=i1(l);return n.concat(l,l.visualViewport||[],k2(a)?a:[],d&&t?tb(d):[])}return n.concat(a,tb(a,[],t))}function i1(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function PM(e){const n=mw(e);let t=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const a=pw(e),o=a?e.offsetWidth:t,l=a?e.offsetHeight:r,d=Zx(t)!==o||Zx(r)!==l;return d&&(t=o,r=l),{width:t,height:r,$:d}}function gw(e){return jM(e)?e:e.contextElement}function XS(e){const n=gw(e);if(!pw(n))return eb(1);const t=n.getBoundingClientRect(),{width:r,height:a,$:o}=PM(n);let l=(o?Zx(t.width):t.width)/r,d=(o?Zx(t.height):t.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!d||!Number.isFinite(d))&&(d=1),{x:l,y:d}}const DM=eb(0);function IM(e){const n=Jl(e);return!kM()||!n.visualViewport?DM:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function RM(e,n,t){return!1}function ZS(e,n,t,r){n===void 0&&(n=!1);const a=e.getBoundingClientRect(),o=gw(e);let l=eb(1);n&&(l=XS(e));const d=RM()?IM(o):eb(0);let f=(a.left+d.x)/l.x,u=(a.top+d.y)/l.y,p=a.width/l.x,g=a.height/l.y;if(o){const b=Jl(o),v=r;let S=b,k=i1(S);for(;k&&r&&v!==S;){const T=XS(k),P=k.getBoundingClientRect(),M=mw(k),I=P.left+(k.clientLeft+parseFloat(M.paddingLeft))*T.x,U=P.top+(k.clientTop+parseFloat(M.paddingTop))*T.y;f*=T.x,u*=T.y,p*=T.x,g*=T.y,f+=I,u+=U,S=Jl(k),k=i1(S)}}return CM({width:p,height:g,x:f,y:u})}function E2(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function MM(e,n){let t=null,r;const a=j2(e);function o(){var d;clearTimeout(r),(d=t)==null||d.disconnect(),t=null}function l(d,f){d===void 0&&(d=!1),f===void 0&&(f=1),o();const u=e.getBoundingClientRect(),{left:p,top:g,width:b,height:v}=u;if(d||n(),!b||!v)return;const S=fx(g),k=fx(a.clientWidth-(p+b)),T=fx(a.clientHeight-(g+v)),P=fx(p),I={rootMargin:-S+"px "+-k+"px "+-T+"px "+-P+"px",threshold:NM(0,SM(1,f))||1};let U=!0;function L($){const z=$[0].intersectionRatio;if(z!==f){if(!U)return l();z?l(!1,z):r=setTimeout(()=>{l(!1,1e-7)},1e3)}z===1&&!E2(u,e.getBoundingClientRect())&&l(),U=!1}try{t=new IntersectionObserver(L,{...I,root:a.ownerDocument})}catch{t=new IntersectionObserver(L,I)}t.observe(e)}return l(!0),o}function OM(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:d=typeof IntersectionObserver=="function",animationFrame:f=!1}=r,u=gw(e),p=a||o?[...u?tb(u):[],...tb(n)]:[];p.forEach(P=>{a&&P.addEventListener("scroll",t,{passive:!0}),o&&P.addEventListener("resize",t)});const g=u&&d?MM(u,t):null;let b=-1,v=null;l&&(v=new ResizeObserver(P=>{let[M]=P;M&&M.target===u&&v&&(v.unobserve(n),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var I;(I=v)==null||I.observe(n)})),t()}),u&&!f&&v.observe(u),v.observe(n));let S,k=f?ZS(e):null;f&&T();function T(){const P=ZS(e);k&&!E2(k,P)&&t(),k=P,S=requestAnimationFrame(T)}return t(),()=>{var P;p.forEach(M=>{a&&M.removeEventListener("scroll",t),o&&M.removeEventListener("resize",t)}),g==null||g(),(P=v)==null||P.disconnect(),v=null,f&&cancelAnimationFrame(S)}}var a1=w.useLayoutEffect,LM=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],nb=function(){};function FM(e,n){return n?n[0]==="-"?e+n:e+"__"+n:e}function $M(e,n){for(var t=arguments.length,r=new Array(t>2?t-2:0),a=2;a<t;a++)r[a-2]=arguments[a];var o=[].concat(r);if(n&&e)for(var l in n)n.hasOwnProperty(l)&&n[l]&&o.push("".concat(FM(e,l)));return o.filter(function(d){return d}).map(function(d){return String(d).trim()}).join(" ")}var eN=function(n){return WM(n)?n.filter(Boolean):Ld(n)==="object"&&n!==null?[n]:[]},A2=function(n){n.className,n.clearValue,n.cx,n.getStyles,n.getClassNames,n.getValue,n.hasValue,n.isMulti,n.isRtl,n.options,n.selectOption,n.selectProps,n.setValue,n.theme;var t=Kl(n,LM);return Rt({},t)},xr=function(n,t,r){var a=n.cx,o=n.getStyles,l=n.getClassNames,d=n.className;return{css:o(t,n),className:a(r??{},l(t,n),d)}};function _b(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function zM(e){return _b(e)?window.innerHeight:e.clientHeight}function P2(e){return _b(e)?window.pageYOffset:e.scrollTop}function rb(e,n){if(_b(e)){window.scrollTo(0,n);return}e.scrollTop=n}function UM(e){var n=getComputedStyle(e),t=n.position==="absolute",r=/(auto|scroll)/;if(n.position==="fixed")return document.documentElement;for(var a=e;a=a.parentElement;)if(n=getComputedStyle(a),!(t&&n.position==="static")&&r.test(n.overflow+n.overflowY+n.overflowX))return a;return document.documentElement}function BM(e,n,t,r){return t*((e=e/r-1)*e*e+1)+n}function hx(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:nb,a=P2(e),o=n-a,l=10,d=0;function f(){d+=l;var u=BM(d,a,o,t);rb(e,u),d<t?window.requestAnimationFrame(f):r(e)}f()}function tN(e,n){var t=e.getBoundingClientRect(),r=n.getBoundingClientRect(),a=n.offsetHeight/3;r.bottom+a>t.bottom?rb(e,Math.min(n.offsetTop+n.clientHeight-e.offsetHeight+a,e.scrollHeight)):r.top-a<t.top&&rb(e,Math.max(n.offsetTop-a,0))}function qM(e){var n=e.getBoundingClientRect();return{bottom:n.bottom,height:n.height,left:n.left,right:n.right,top:n.top,width:n.width}}function nN(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function VM(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var D2=!1,HM={get passive(){return D2=!0}},px=typeof window<"u"?window:{};px.addEventListener&&px.removeEventListener&&(px.addEventListener("p",nb,HM),px.removeEventListener("p",nb,!1));var GM=D2;function YM(e){return e!=null}function WM(e){return Array.isArray(e)}function mx(e,n,t){return e?n:t}var QM=function(n){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];var o=Object.entries(n).filter(function(l){var d=Gl(l,1),f=d[0];return!r.includes(f)});return o.reduce(function(l,d){var f=Gl(d,2),u=f[0],p=f[1];return l[u]=p,l},{})},JM=["children","innerProps"],KM=["children","innerProps"];function XM(e){var n=e.maxHeight,t=e.menuEl,r=e.minHeight,a=e.placement,o=e.shouldScroll,l=e.isFixedPosition,d=e.controlHeight,f=UM(t),u={placement:"bottom",maxHeight:n};if(!t||!t.offsetParent)return u;var p=f.getBoundingClientRect(),g=p.height,b=t.getBoundingClientRect(),v=b.bottom,S=b.height,k=b.top,T=t.offsetParent.getBoundingClientRect(),P=T.top,M=l?window.innerHeight:zM(f),I=P2(f),U=parseInt(getComputedStyle(t).marginBottom,10),L=parseInt(getComputedStyle(t).marginTop,10),$=P-L,z=M-k,F=$+I,Y=g-I-k,R=v-M+I+U,B=I+k-L,G=160;switch(a){case"auto":case"bottom":if(z>=S)return{placement:"bottom",maxHeight:n};if(Y>=S&&!l)return o&&hx(f,R,G),{placement:"bottom",maxHeight:n};if(!l&&Y>=r||l&&z>=r){o&&hx(f,R,G);var ie=l?z-U:Y-U;return{placement:"bottom",maxHeight:ie}}if(a==="auto"||l){var te=n,W=l?$:F;return W>=r&&(te=Math.min(W-U-d,n)),{placement:"top",maxHeight:te}}if(a==="bottom")return o&&rb(f,R),{placement:"bottom",maxHeight:n};break;case"top":if($>=S)return{placement:"top",maxHeight:n};if(F>=S&&!l)return o&&hx(f,B,G),{placement:"top",maxHeight:n};if(!l&&F>=r||l&&$>=r){var V=n;return(!l&&F>=r||l&&$>=r)&&(V=l?$-L:F-L),o&&hx(f,B,G),{placement:"top",maxHeight:V}}return{placement:"bottom",maxHeight:n};default:throw new Error('Invalid placement provided "'.concat(a,'".'))}return u}function ZM(e){var n={bottom:"top",top:"bottom"};return e?n[e]:"bottom"}var I2=function(n){return n==="auto"?"bottom":n},eO=function(n,t){var r,a=n.placement,o=n.theme,l=o.borderRadius,d=o.spacing,f=o.colors;return Rt((r={label:"menu"},Lm(r,ZM(a),"100%"),Lm(r,"position","absolute"),Lm(r,"width","100%"),Lm(r,"zIndex",1),r),t?{}:{backgroundColor:f.neutral0,borderRadius:l,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:d.menuGutter,marginTop:d.menuGutter})},R2=w.createContext(null),tO=function(n){var t=n.children,r=n.minMenuHeight,a=n.maxMenuHeight,o=n.menuPlacement,l=n.menuPosition,d=n.menuShouldScrollIntoView,f=n.theme,u=w.useContext(R2)||{},p=u.setPortalPlacement,g=w.useRef(null),b=w.useState(a),v=Gl(b,2),S=v[0],k=v[1],T=w.useState(null),P=Gl(T,2),M=P[0],I=P[1],U=f.spacing.controlHeight;return a1(function(){var L=g.current;if(L){var $=l==="fixed",z=d&&!$,F=XM({maxHeight:a,menuEl:L,minHeight:r,placement:o,shouldScroll:z,isFixedPosition:$,controlHeight:U});k(F.maxHeight),I(F.placement),p==null||p(F.placement)}},[a,o,l,d,r,p,U]),t({ref:g,placerProps:Rt(Rt({},n),{},{placement:M||I2(o),maxHeight:S})})},nO=function(n){var t=n.children,r=n.innerRef,a=n.innerProps;return Tt("div",$t({},xr(n,"menu",{menu:!0}),{ref:r},a),t)},rO=nO,iO=function(n,t){var r=n.maxHeight,a=n.theme.spacing.baseUnit;return Rt({maxHeight:r,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},t?{}:{paddingBottom:a,paddingTop:a})},aO=function(n){var t=n.children,r=n.innerProps,a=n.innerRef,o=n.isMulti;return Tt("div",$t({},xr(n,"menuList",{"menu-list":!0,"menu-list--is-multi":o}),{ref:a},r),t)},M2=function(n,t){var r=n.theme,a=r.spacing.baseUnit,o=r.colors;return Rt({textAlign:"center"},t?{}:{color:o.neutral40,padding:"".concat(a*2,"px ").concat(a*3,"px")})},sO=M2,oO=M2,lO=function(n){var t=n.children,r=t===void 0?"No options":t,a=n.innerProps,o=Kl(n,JM);return Tt("div",$t({},xr(Rt(Rt({},o),{},{children:r,innerProps:a}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),a),r)},cO=function(n){var t=n.children,r=t===void 0?"Loading...":t,a=n.innerProps,o=Kl(n,KM);return Tt("div",$t({},xr(Rt(Rt({},o),{},{children:r,innerProps:a}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),a),r)},uO=function(n){var t=n.rect,r=n.offset,a=n.position;return{left:t.left,position:a,top:r,width:t.width,zIndex:1}},dO=function(n){var t=n.appendTo,r=n.children,a=n.controlElement,o=n.innerProps,l=n.menuPlacement,d=n.menuPosition,f=w.useRef(null),u=w.useRef(null),p=w.useState(I2(l)),g=Gl(p,2),b=g[0],v=g[1],S=w.useMemo(function(){return{setPortalPlacement:v}},[]),k=w.useState(null),T=Gl(k,2),P=T[0],M=T[1],I=w.useCallback(function(){if(a){var z=qM(a),F=d==="fixed"?0:window.pageYOffset,Y=z[b]+F;(Y!==(P==null?void 0:P.offset)||z.left!==(P==null?void 0:P.rect.left)||z.width!==(P==null?void 0:P.rect.width))&&M({offset:Y,rect:z})}},[a,d,b,P==null?void 0:P.offset,P==null?void 0:P.rect.left,P==null?void 0:P.rect.width]);a1(function(){I()},[I]);var U=w.useCallback(function(){typeof u.current=="function"&&(u.current(),u.current=null),a&&f.current&&(u.current=OM(a,f.current,I,{elementResize:"ResizeObserver"in window}))},[a,I]);a1(function(){U()},[U]);var L=w.useCallback(function(z){f.current=z,U()},[U]);if(!t&&d!=="fixed"||!P)return null;var $=Tt("div",$t({ref:L},xr(Rt(Rt({},n),{},{offset:P.offset,position:d,rect:P.rect}),"menuPortal",{"menu-portal":!0}),o),r);return Tt(R2.Provider,{value:S},t?LD.createPortal($,t):$)},fO=function(n){var t=n.isDisabled,r=n.isRtl;return{label:"container",direction:r?"rtl":void 0,pointerEvents:t?"none":void 0,position:"relative"}},hO=function(n){var t=n.children,r=n.innerProps,a=n.isDisabled,o=n.isRtl;return Tt("div",$t({},xr(n,"container",{"--is-disabled":a,"--is-rtl":o}),r),t)},pO=function(n,t){var r=n.theme.spacing,a=n.isMulti,o=n.hasValue,l=n.selectProps.controlShouldRenderValue;return Rt({alignItems:"center",display:a&&o&&l?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},t?{}:{padding:"".concat(r.baseUnit/2,"px ").concat(r.baseUnit*2,"px")})},mO=function(n){var t=n.children,r=n.innerProps,a=n.isMulti,o=n.hasValue;return Tt("div",$t({},xr(n,"valueContainer",{"value-container":!0,"value-container--is-multi":a,"value-container--has-value":o}),r),t)},gO=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},yO=function(n){var t=n.children,r=n.innerProps;return Tt("div",$t({},xr(n,"indicatorsContainer",{indicators:!0}),r),t)},rN,xO=["size"],bO=["innerProps","isRtl","size"],vO={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},O2=function(n){var t=n.size,r=Kl(n,xO);return Tt("svg",$t({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:vO},r))},yw=function(n){return Tt(O2,$t({size:20},n),Tt("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},L2=function(n){return Tt(O2,$t({size:20},n),Tt("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},F2=function(n,t){var r=n.isFocused,a=n.theme,o=a.spacing.baseUnit,l=a.colors;return Rt({label:"indicatorContainer",display:"flex",transition:"color 150ms"},t?{}:{color:r?l.neutral60:l.neutral20,padding:o*2,":hover":{color:r?l.neutral80:l.neutral40}})},wO=F2,SO=function(n){var t=n.children,r=n.innerProps;return Tt("div",$t({},xr(n,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),r),t||Tt(L2,null))},NO=F2,CO=function(n){var t=n.children,r=n.innerProps;return Tt("div",$t({},xr(n,"clearIndicator",{indicator:!0,"clear-indicator":!0}),r),t||Tt(yw,null))},jO=function(n,t){var r=n.isDisabled,a=n.theme,o=a.spacing.baseUnit,l=a.colors;return Rt({label:"indicatorSeparator",alignSelf:"stretch",width:1},t?{}:{backgroundColor:r?l.neutral10:l.neutral20,marginBottom:o*2,marginTop:o*2})},_O=function(n){var t=n.innerProps;return Tt("span",$t({},t,xr(n,"indicatorSeparator",{"indicator-separator":!0})))},kO=vM(rN||(rN=wM([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),TO=function(n,t){var r=n.isFocused,a=n.size,o=n.theme,l=o.colors,d=o.spacing.baseUnit;return Rt({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:a,lineHeight:1,marginRight:a,textAlign:"center",verticalAlign:"middle"},t?{}:{color:r?l.neutral60:l.neutral20,padding:d*2})},Kv=function(n){var t=n.delay,r=n.offset;return Tt("span",{css:hw({animation:"".concat(kO," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:r?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},EO=function(n){var t=n.innerProps,r=n.isRtl,a=n.size,o=a===void 0?4:a,l=Kl(n,bO);return Tt("div",$t({},xr(Rt(Rt({},l),{},{innerProps:t,isRtl:r,size:o}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),t),Tt(Kv,{delay:0,offset:r}),Tt(Kv,{delay:160,offset:!0}),Tt(Kv,{delay:320,offset:!r}))},AO=function(n,t){var r=n.isDisabled,a=n.isFocused,o=n.theme,l=o.colors,d=o.borderRadius,f=o.spacing;return Rt({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:f.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},t?{}:{backgroundColor:r?l.neutral5:l.neutral0,borderColor:r?l.neutral10:a?l.primary:l.neutral20,borderRadius:d,borderStyle:"solid",borderWidth:1,boxShadow:a?"0 0 0 1px ".concat(l.primary):void 0,"&:hover":{borderColor:a?l.primary:l.neutral30}})},PO=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,o=n.innerRef,l=n.innerProps,d=n.menuIsOpen;return Tt("div",$t({ref:o},xr(n,"control",{control:!0,"control--is-disabled":r,"control--is-focused":a,"control--menu-is-open":d}),l,{"aria-disabled":r||void 0}),t)},DO=PO,IO=["data"],RO=function(n,t){var r=n.theme.spacing;return t?{}:{paddingBottom:r.baseUnit*2,paddingTop:r.baseUnit*2}},MO=function(n){var t=n.children,r=n.cx,a=n.getStyles,o=n.getClassNames,l=n.Heading,d=n.headingProps,f=n.innerProps,u=n.label,p=n.theme,g=n.selectProps;return Tt("div",$t({},xr(n,"group",{group:!0}),f),Tt(l,$t({},d,{selectProps:g,theme:p,getStyles:a,getClassNames:o,cx:r}),u),Tt("div",null,t))},OO=function(n,t){var r=n.theme,a=r.colors,o=r.spacing;return Rt({label:"group",cursor:"default",display:"block"},t?{}:{color:a.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:o.baseUnit*3,paddingRight:o.baseUnit*3,textTransform:"uppercase"})},LO=function(n){var t=A2(n);t.data;var r=Kl(t,IO);return Tt("div",$t({},xr(n,"groupHeading",{"group-heading":!0}),r))},FO=MO,$O=["innerRef","isDisabled","isHidden","inputClassName"],zO=function(n,t){var r=n.isDisabled,a=n.value,o=n.theme,l=o.spacing,d=o.colors;return Rt(Rt({visibility:r?"hidden":"visible",transform:a?"translateZ(0)":""},UO),t?{}:{margin:l.baseUnit/2,paddingBottom:l.baseUnit/2,paddingTop:l.baseUnit/2,color:d.neutral80})},$2={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},UO={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Rt({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},$2)},BO=function(n){return Rt({label:"input",color:"inherit",background:0,opacity:n?0:1,width:"100%"},$2)},qO=function(n){var t=n.cx,r=n.value,a=A2(n),o=a.innerRef,l=a.isDisabled,d=a.isHidden,f=a.inputClassName,u=Kl(a,$O);return Tt("div",$t({},xr(n,"input",{"input-container":!0}),{"data-value":r||""}),Tt("input",$t({className:t({input:!0},f),ref:o,style:BO(d),disabled:l},u)))},VO=qO,HO=function(n,t){var r=n.theme,a=r.spacing,o=r.borderRadius,l=r.colors;return Rt({label:"multiValue",display:"flex",minWidth:0},t?{}:{backgroundColor:l.neutral10,borderRadius:o/2,margin:a.baseUnit/2})},GO=function(n,t){var r=n.theme,a=r.borderRadius,o=r.colors,l=n.cropWithEllipsis;return Rt({overflow:"hidden",textOverflow:l||l===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},t?{}:{borderRadius:a/2,color:o.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},YO=function(n,t){var r=n.theme,a=r.spacing,o=r.borderRadius,l=r.colors,d=n.isFocused;return Rt({alignItems:"center",display:"flex"},t?{}:{borderRadius:o/2,backgroundColor:d?l.dangerLight:void 0,paddingLeft:a.baseUnit,paddingRight:a.baseUnit,":hover":{backgroundColor:l.dangerLight,color:l.danger}})},z2=function(n){var t=n.children,r=n.innerProps;return Tt("div",r,t)},WO=z2,QO=z2;function JO(e){var n=e.children,t=e.innerProps;return Tt("div",$t({role:"button"},t),n||Tt(yw,{size:14}))}var KO=function(n){var t=n.children,r=n.components,a=n.data,o=n.innerProps,l=n.isDisabled,d=n.removeProps,f=n.selectProps,u=r.Container,p=r.Label,g=r.Remove;return Tt(u,{data:a,innerProps:Rt(Rt({},xr(n,"multiValue",{"multi-value":!0,"multi-value--is-disabled":l})),o),selectProps:f},Tt(p,{data:a,innerProps:Rt({},xr(n,"multiValueLabel",{"multi-value__label":!0})),selectProps:f},t),Tt(g,{data:a,innerProps:Rt(Rt({},xr(n,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(t||"option")},d),selectProps:f}))},XO=KO,ZO=function(n,t){var r=n.isDisabled,a=n.isFocused,o=n.isSelected,l=n.theme,d=l.spacing,f=l.colors;return Rt({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},t?{}:{backgroundColor:o?f.primary:a?f.primary25:"transparent",color:r?f.neutral20:o?f.neutral0:"inherit",padding:"".concat(d.baseUnit*2,"px ").concat(d.baseUnit*3,"px"),":active":{backgroundColor:r?void 0:o?f.primary:f.primary50}})},eL=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,o=n.isSelected,l=n.innerRef,d=n.innerProps;return Tt("div",$t({},xr(n,"option",{option:!0,"option--is-disabled":r,"option--is-focused":a,"option--is-selected":o}),{ref:l,"aria-disabled":r},d),t)},tL=eL,nL=function(n,t){var r=n.theme,a=r.spacing,o=r.colors;return Rt({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},t?{}:{color:o.neutral50,marginLeft:a.baseUnit/2,marginRight:a.baseUnit/2})},rL=function(n){var t=n.children,r=n.innerProps;return Tt("div",$t({},xr(n,"placeholder",{placeholder:!0}),r),t)},iL=rL,aL=function(n,t){var r=n.isDisabled,a=n.theme,o=a.spacing,l=a.colors;return Rt({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t?{}:{color:r?l.neutral40:l.neutral80,marginLeft:o.baseUnit/2,marginRight:o.baseUnit/2})},sL=function(n){var t=n.children,r=n.isDisabled,a=n.innerProps;return Tt("div",$t({},xr(n,"singleValue",{"single-value":!0,"single-value--is-disabled":r}),a),t)},oL=sL,lL={ClearIndicator:CO,Control:DO,DropdownIndicator:SO,DownChevron:L2,CrossIcon:yw,Group:FO,GroupHeading:LO,IndicatorsContainer:yO,IndicatorSeparator:_O,Input:VO,LoadingIndicator:EO,Menu:rO,MenuList:aO,MenuPortal:dO,LoadingMessage:cO,NoOptionsMessage:lO,MultiValue:XO,MultiValueContainer:WO,MultiValueLabel:QO,MultiValueRemove:JO,Option:tL,Placeholder:iL,SelectContainer:hO,SingleValue:oL,ValueContainer:mO},cL=function(n){return Rt(Rt({},lL),n.components)},iN=Number.isNaN||function(n){return typeof n=="number"&&n!==n};function uL(e,n){return!!(e===n||iN(e)&&iN(n))}function dL(e,n){if(e.length!==n.length)return!1;for(var t=0;t<e.length;t++)if(!uL(e[t],n[t]))return!1;return!0}function fL(e,n){n===void 0&&(n=dL);var t=null;function r(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];if(t&&t.lastThis===this&&n(a,t.lastArgs))return t.lastResult;var l=e.apply(this,a);return t={lastResult:l,lastArgs:a,lastThis:this},l}return r.clear=function(){t=null},r}var hL={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},pL=function(n){return Tt("span",$t({css:hL},n))},aN=pL,mL={guidance:function(n){var t=n.isSearchable,r=n.isMulti,a=n.tabSelectsValue,o=n.context,l=n.isInitialFocus;switch(o){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(a?", press Tab to select the option and exit the menu":"",".");case"input":return l?"".concat(n["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(r?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(n){var t=n.action,r=n.label,a=r===void 0?"":r,o=n.labels,l=n.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(a,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(o.length>1?"s":""," ").concat(o.join(","),", selected.");case"select-option":return l?"option ".concat(a," is disabled. Select another option."):"option ".concat(a,", selected.");default:return""}},onFocus:function(n){var t=n.context,r=n.focused,a=n.options,o=n.label,l=o===void 0?"":o,d=n.selectValue,f=n.isDisabled,u=n.isSelected,p=n.isAppleDevice,g=function(k,T){return k&&k.length?"".concat(k.indexOf(T)+1," of ").concat(k.length):""};if(t==="value"&&d)return"value ".concat(l," focused, ").concat(g(d,r),".");if(t==="menu"&&p){var b=f?" disabled":"",v="".concat(u?" selected":"").concat(b);return"".concat(l).concat(v,", ").concat(g(a,r),".")}return""},onFilter:function(n){var t=n.inputValue,r=n.resultsMessage;return"".concat(r).concat(t?" for search term "+t:"",".")}},gL=function(n){var t=n.ariaSelection,r=n.focusedOption,a=n.focusedValue,o=n.focusableOptions,l=n.isFocused,d=n.selectValue,f=n.selectProps,u=n.id,p=n.isAppleDevice,g=f.ariaLiveMessages,b=f.getOptionLabel,v=f.inputValue,S=f.isMulti,k=f.isOptionDisabled,T=f.isSearchable,P=f.menuIsOpen,M=f.options,I=f.screenReaderStatus,U=f.tabSelectsValue,L=f.isLoading,$=f["aria-label"],z=f["aria-live"],F=w.useMemo(function(){return Rt(Rt({},mL),g||{})},[g]),Y=w.useMemo(function(){var W="";if(t&&F.onChange){var V=t.option,se=t.options,re=t.removedValue,oe=t.removedValues,E=t.value,le=function(ae){return Array.isArray(ae)?null:ae},ue=re||V||le(E),D=ue?b(ue):"",ce=se||oe||void 0,ve=ce?ce.map(b):[],X=Rt({isDisabled:ue&&k(ue,d),label:D,labels:ve},t);W=F.onChange(X)}return W},[t,F,k,d,b]),R=w.useMemo(function(){var W="",V=r||a,se=!!(r&&d&&d.includes(r));if(V&&F.onFocus){var re={focused:V,label:b(V),isDisabled:k(V,d),isSelected:se,options:o,context:V===r?"menu":"value",selectValue:d,isAppleDevice:p};W=F.onFocus(re)}return W},[r,a,b,k,F,o,d,p]),B=w.useMemo(function(){var W="";if(P&&M.length&&!L&&F.onFilter){var V=I({count:o.length});W=F.onFilter({inputValue:v,resultsMessage:V})}return W},[o,v,P,F,M,I,L]),G=(t==null?void 0:t.action)==="initial-input-focus",ie=w.useMemo(function(){var W="";if(F.guidance){var V=a?"value":P?"menu":"input";W=F.guidance({"aria-label":$,context:V,isDisabled:r&&k(r,d),isMulti:S,isSearchable:T,tabSelectsValue:U,isInitialFocus:G})}return W},[$,r,a,S,k,T,P,F,d,U,G]),te=Tt(w.Fragment,null,Tt("span",{id:"aria-selection"},Y),Tt("span",{id:"aria-focused"},R),Tt("span",{id:"aria-results"},B),Tt("span",{id:"aria-guidance"},ie));return Tt(w.Fragment,null,Tt(aN,{id:u},G&&te),Tt(aN,{"aria-live":z,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},l&&!G&&te))},yL=gL,s1=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],xL=new RegExp("["+s1.map(function(e){return e.letters}).join("")+"]","g"),U2={};for(var Xv=0;Xv<s1.length;Xv++)for(var Zv=s1[Xv],e0=0;e0<Zv.letters.length;e0++)U2[Zv.letters[e0]]=Zv.base;var B2=function(n){return n.replace(xL,function(t){return U2[t]})},bL=fL(B2),sN=function(n){return n.replace(/^\s+|\s+$/g,"")},vL=function(n){return"".concat(n.label," ").concat(n.value)},wL=function(n){return function(t,r){if(t.data.__isNew__)return!0;var a=Rt({ignoreCase:!0,ignoreAccents:!0,stringify:vL,trim:!0,matchFrom:"any"},n),o=a.ignoreCase,l=a.ignoreAccents,d=a.stringify,f=a.trim,u=a.matchFrom,p=f?sN(r):r,g=f?sN(d(t)):d(t);return o&&(p=p.toLowerCase(),g=g.toLowerCase()),l&&(p=bL(p),g=B2(g)),u==="start"?g.substr(0,p.length)===p:g.indexOf(p)>-1}},SL=["innerRef"];function NL(e){var n=e.innerRef,t=Kl(e,SL),r=QM(t,"onExited","in","enter","exit","appear");return Tt("input",$t({ref:n},r,{css:hw({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var CL=function(n){n.cancelable&&n.preventDefault(),n.stopPropagation()};function jL(e){var n=e.isEnabled,t=e.onBottomArrive,r=e.onBottomLeave,a=e.onTopArrive,o=e.onTopLeave,l=w.useRef(!1),d=w.useRef(!1),f=w.useRef(0),u=w.useRef(null),p=w.useCallback(function(T,P){if(u.current!==null){var M=u.current,I=M.scrollTop,U=M.scrollHeight,L=M.clientHeight,$=u.current,z=P>0,F=U-L-I,Y=!1;F>P&&l.current&&(r&&r(T),l.current=!1),z&&d.current&&(o&&o(T),d.current=!1),z&&P>F?(t&&!l.current&&t(T),$.scrollTop=U,Y=!0,l.current=!0):!z&&-P>I&&(a&&!d.current&&a(T),$.scrollTop=0,Y=!0,d.current=!0),Y&&CL(T)}},[t,r,a,o]),g=w.useCallback(function(T){p(T,T.deltaY)},[p]),b=w.useCallback(function(T){f.current=T.changedTouches[0].clientY},[]),v=w.useCallback(function(T){var P=f.current-T.changedTouches[0].clientY;p(T,P)},[p]),S=w.useCallback(function(T){if(T){var P=GM?{passive:!1}:!1;T.addEventListener("wheel",g,P),T.addEventListener("touchstart",b,P),T.addEventListener("touchmove",v,P)}},[v,b,g]),k=w.useCallback(function(T){T&&(T.removeEventListener("wheel",g,!1),T.removeEventListener("touchstart",b,!1),T.removeEventListener("touchmove",v,!1))},[v,b,g]);return w.useEffect(function(){if(n){var T=u.current;return S(T),function(){k(T)}}},[n,S,k]),function(T){u.current=T}}var oN=["boxSizing","height","overflow","paddingRight","position"],lN={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function cN(e){e.cancelable&&e.preventDefault()}function uN(e){e.stopPropagation()}function dN(){var e=this.scrollTop,n=this.scrollHeight,t=e+this.offsetHeight;e===0?this.scrollTop=1:t===n&&(this.scrollTop=e-1)}function fN(){return"ontouchstart"in window||navigator.maxTouchPoints}var hN=!!(typeof window<"u"&&window.document&&window.document.createElement),_m=0,dh={capture:!1,passive:!1};function _L(e){var n=e.isEnabled,t=e.accountForScrollbars,r=t===void 0?!0:t,a=w.useRef({}),o=w.useRef(null),l=w.useCallback(function(f){if(hN){var u=document.body,p=u&&u.style;if(r&&oN.forEach(function(S){var k=p&&p[S];a.current[S]=k}),r&&_m<1){var g=parseInt(a.current.paddingRight,10)||0,b=document.body?document.body.clientWidth:0,v=window.innerWidth-b+g||0;Object.keys(lN).forEach(function(S){var k=lN[S];p&&(p[S]=k)}),p&&(p.paddingRight="".concat(v,"px"))}u&&fN()&&(u.addEventListener("touchmove",cN,dh),f&&(f.addEventListener("touchstart",dN,dh),f.addEventListener("touchmove",uN,dh))),_m+=1}},[r]),d=w.useCallback(function(f){if(hN){var u=document.body,p=u&&u.style;_m=Math.max(_m-1,0),r&&_m<1&&oN.forEach(function(g){var b=a.current[g];p&&(p[g]=b)}),u&&fN()&&(u.removeEventListener("touchmove",cN,dh),f&&(f.removeEventListener("touchstart",dN,dh),f.removeEventListener("touchmove",uN,dh)))}},[r]);return w.useEffect(function(){if(n){var f=o.current;return l(f),function(){d(f)}}},[n,l,d]),function(f){o.current=f}}var kL=function(n){var t=n.target;return t.ownerDocument.activeElement&&t.ownerDocument.activeElement.blur()},TL={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function EL(e){var n=e.children,t=e.lockEnabled,r=e.captureEnabled,a=r===void 0?!0:r,o=e.onBottomArrive,l=e.onBottomLeave,d=e.onTopArrive,f=e.onTopLeave,u=jL({isEnabled:a,onBottomArrive:o,onBottomLeave:l,onTopArrive:d,onTopLeave:f}),p=_L({isEnabled:t}),g=function(v){u(v),p(v)};return Tt(w.Fragment,null,t&&Tt("div",{onClick:kL,css:TL}),n(g))}var AL={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},PL=function(n){var t=n.name,r=n.onFocus;return Tt("input",{required:!0,name:t,tabIndex:-1,"aria-hidden":"true",onFocus:r,css:AL,value:"",onChange:function(){}})},DL=PL;function xw(e){var n;return typeof window<"u"&&window.navigator!=null?e.test(((n=window.navigator.userAgentData)===null||n===void 0?void 0:n.platform)||window.navigator.platform):!1}function IL(){return xw(/^iPhone/i)}function q2(){return xw(/^Mac/i)}function RL(){return xw(/^iPad/i)||q2()&&navigator.maxTouchPoints>1}function ML(){return IL()||RL()}function OL(){return q2()||ML()}var LL=function(n){return n.label},FL=function(n){return n.label},$L=function(n){return n.value},zL=function(n){return!!n.isDisabled},UL={clearIndicator:NO,container:fO,control:AO,dropdownIndicator:wO,group:RO,groupHeading:OO,indicatorsContainer:gO,indicatorSeparator:jO,input:zO,loadingIndicator:TO,loadingMessage:oO,menu:eO,menuList:iO,menuPortal:uO,multiValue:HO,multiValueLabel:GO,multiValueRemove:YO,noOptionsMessage:sO,option:ZO,placeholder:nL,singleValue:aL,valueContainer:pO},BL={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},qL=4,V2=4,VL=38,HL=V2*2,GL={baseUnit:V2,controlHeight:VL,menuGutter:HL},t0={borderRadius:qL,colors:BL,spacing:GL},YL={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:nN(),captureMenuScroll:!nN(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:wL(),formatGroupLabel:LL,getOptionLabel:FL,getOptionValue:$L,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:zL,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!VM(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(n){var t=n.count;return"".concat(t," result").concat(t!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function pN(e,n,t,r){var a=Y2(e,n,t),o=W2(e,n,t),l=G2(e,n),d=ib(e,n);return{type:"option",data:n,isDisabled:a,isSelected:o,label:l,value:d,index:r}}function Lx(e,n){return e.options.map(function(t,r){if("options"in t){var a=t.options.map(function(l,d){return pN(e,l,n,d)}).filter(function(l){return gN(e,l)});return a.length>0?{type:"group",data:t,options:a,index:r}:void 0}var o=pN(e,t,n,r);return gN(e,o)?o:void 0}).filter(YM)}function H2(e){return e.reduce(function(n,t){return t.type==="group"?n.push.apply(n,lw(t.options.map(function(r){return r.data}))):n.push(t.data),n},[])}function mN(e,n){return e.reduce(function(t,r){return r.type==="group"?t.push.apply(t,lw(r.options.map(function(a){return{data:a.data,id:"".concat(n,"-").concat(r.index,"-").concat(a.index)}}))):t.push({data:r.data,id:"".concat(n,"-").concat(r.index)}),t},[])}function WL(e,n){return H2(Lx(e,n))}function gN(e,n){var t=e.inputValue,r=t===void 0?"":t,a=n.data,o=n.isSelected,l=n.label,d=n.value;return(!J2(e)||!o)&&Q2(e,{label:l,value:d,data:a},r)}function QL(e,n){var t=e.focusedValue,r=e.selectValue,a=r.indexOf(t);if(a>-1){var o=n.indexOf(t);if(o>-1)return t;if(a<n.length)return n[a]}return null}function JL(e,n){var t=e.focusedOption;return t&&n.indexOf(t)>-1?t:n[0]}var n0=function(n,t){var r,a=(r=n.find(function(o){return o.data===t}))===null||r===void 0?void 0:r.id;return a||null},G2=function(n,t){return n.getOptionLabel(t)},ib=function(n,t){return n.getOptionValue(t)};function Y2(e,n,t){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(n,t):!1}function W2(e,n,t){if(t.indexOf(n)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(n,t);var r=ib(e,n);return t.some(function(a){return ib(e,a)===r})}function Q2(e,n,t){return e.filterOption?e.filterOption(n,t):!0}var J2=function(n){var t=n.hideSelectedOptions,r=n.isMulti;return t===void 0?r:t},KL=1,K2=function(e){y4(t,e);var n=v4(t);function t(r){var a;if(m4(this,t),a=n.call(this,r),a.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},a.blockOptionHover=!1,a.isComposing=!1,a.commonProps=void 0,a.initialTouchX=0,a.initialTouchY=0,a.openAfterFocus=!1,a.scrollToFocusedOptionOnUpdate=!1,a.userIsDragging=void 0,a.controlRef=null,a.getControlRef=function(f){a.controlRef=f},a.focusedOptionRef=null,a.getFocusedOptionRef=function(f){a.focusedOptionRef=f},a.menuListRef=null,a.getMenuListRef=function(f){a.menuListRef=f},a.inputRef=null,a.getInputRef=function(f){a.inputRef=f},a.focus=a.focusInput,a.blur=a.blurInput,a.onChange=function(f,u){var p=a.props,g=p.onChange,b=p.name;u.name=b,a.ariaOnChange(f,u),g(f,u)},a.setValue=function(f,u,p){var g=a.props,b=g.closeMenuOnSelect,v=g.isMulti,S=g.inputValue;a.onInputChange("",{action:"set-value",prevInputValue:S}),b&&(a.setState({inputIsHiddenAfterUpdate:!v}),a.onMenuClose()),a.setState({clearFocusValueOnUpdate:!0}),a.onChange(f,{action:u,option:p})},a.selectOption=function(f){var u=a.props,p=u.blurInputOnSelect,g=u.isMulti,b=u.name,v=a.state.selectValue,S=g&&a.isOptionSelected(f,v),k=a.isOptionDisabled(f,v);if(S){var T=a.getOptionValue(f);a.setValue(v.filter(function(P){return a.getOptionValue(P)!==T}),"deselect-option",f)}else if(!k)g?a.setValue([].concat(lw(v),[f]),"select-option",f):a.setValue(f,"select-option");else{a.ariaOnChange(f,{action:"select-option",option:f,name:b});return}p&&a.blurInput()},a.removeValue=function(f){var u=a.props.isMulti,p=a.state.selectValue,g=a.getOptionValue(f),b=p.filter(function(S){return a.getOptionValue(S)!==g}),v=mx(u,b,b[0]||null);a.onChange(v,{action:"remove-value",removedValue:f}),a.focusInput()},a.clearValue=function(){var f=a.state.selectValue;a.onChange(mx(a.props.isMulti,[],null),{action:"clear",removedValues:f})},a.popValue=function(){var f=a.props.isMulti,u=a.state.selectValue,p=u[u.length-1],g=u.slice(0,u.length-1),b=mx(f,g,g[0]||null);p&&a.onChange(b,{action:"pop-value",removedValue:p})},a.getFocusedOptionId=function(f){return n0(a.state.focusableOptionsWithIds,f)},a.getFocusableOptionsWithIds=function(){return mN(Lx(a.props,a.state.selectValue),a.getElementId("option"))},a.getValue=function(){return a.state.selectValue},a.cx=function(){for(var f=arguments.length,u=new Array(f),p=0;p<f;p++)u[p]=arguments[p];return $M.apply(void 0,[a.props.classNamePrefix].concat(u))},a.getOptionLabel=function(f){return G2(a.props,f)},a.getOptionValue=function(f){return ib(a.props,f)},a.getStyles=function(f,u){var p=a.props.unstyled,g=UL[f](u,p);g.boxSizing="border-box";var b=a.props.styles[f];return b?b(g,u):g},a.getClassNames=function(f,u){var p,g;return(p=(g=a.props.classNames)[f])===null||p===void 0?void 0:p.call(g,u)},a.getElementId=function(f){return"".concat(a.state.instancePrefix,"-").concat(f)},a.getComponents=function(){return cL(a.props)},a.buildCategorizedOptions=function(){return Lx(a.props,a.state.selectValue)},a.getCategorizedOptions=function(){return a.props.menuIsOpen?a.buildCategorizedOptions():[]},a.buildFocusableOptions=function(){return H2(a.buildCategorizedOptions())},a.getFocusableOptions=function(){return a.props.menuIsOpen?a.buildFocusableOptions():[]},a.ariaOnChange=function(f,u){a.setState({ariaSelection:Rt({value:f},u)})},a.onMenuMouseDown=function(f){f.button===0&&(f.stopPropagation(),f.preventDefault(),a.focusInput())},a.onMenuMouseMove=function(f){a.blockOptionHover=!1},a.onControlMouseDown=function(f){if(!f.defaultPrevented){var u=a.props.openMenuOnClick;a.state.isFocused?a.props.menuIsOpen?f.target.tagName!=="INPUT"&&f.target.tagName!=="TEXTAREA"&&a.onMenuClose():u&&a.openMenu("first"):(u&&(a.openAfterFocus=!0),a.focusInput()),f.target.tagName!=="INPUT"&&f.target.tagName!=="TEXTAREA"&&f.preventDefault()}},a.onDropdownIndicatorMouseDown=function(f){if(!(f&&f.type==="mousedown"&&f.button!==0)&&!a.props.isDisabled){var u=a.props,p=u.isMulti,g=u.menuIsOpen;a.focusInput(),g?(a.setState({inputIsHiddenAfterUpdate:!p}),a.onMenuClose()):a.openMenu("first"),f.preventDefault()}},a.onClearIndicatorMouseDown=function(f){f&&f.type==="mousedown"&&f.button!==0||(a.clearValue(),f.preventDefault(),a.openAfterFocus=!1,f.type==="touchend"?a.focusInput():setTimeout(function(){return a.focusInput()}))},a.onScroll=function(f){typeof a.props.closeMenuOnScroll=="boolean"?f.target instanceof HTMLElement&&_b(f.target)&&a.props.onMenuClose():typeof a.props.closeMenuOnScroll=="function"&&a.props.closeMenuOnScroll(f)&&a.props.onMenuClose()},a.onCompositionStart=function(){a.isComposing=!0},a.onCompositionEnd=function(){a.isComposing=!1},a.onTouchStart=function(f){var u=f.touches,p=u&&u.item(0);p&&(a.initialTouchX=p.clientX,a.initialTouchY=p.clientY,a.userIsDragging=!1)},a.onTouchMove=function(f){var u=f.touches,p=u&&u.item(0);if(p){var g=Math.abs(p.clientX-a.initialTouchX),b=Math.abs(p.clientY-a.initialTouchY),v=5;a.userIsDragging=g>v||b>v}},a.onTouchEnd=function(f){a.userIsDragging||(a.controlRef&&!a.controlRef.contains(f.target)&&a.menuListRef&&!a.menuListRef.contains(f.target)&&a.blurInput(),a.initialTouchX=0,a.initialTouchY=0)},a.onControlTouchEnd=function(f){a.userIsDragging||a.onControlMouseDown(f)},a.onClearIndicatorTouchEnd=function(f){a.userIsDragging||a.onClearIndicatorMouseDown(f)},a.onDropdownIndicatorTouchEnd=function(f){a.userIsDragging||a.onDropdownIndicatorMouseDown(f)},a.handleInputChange=function(f){var u=a.props.inputValue,p=f.currentTarget.value;a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange(p,{action:"input-change",prevInputValue:u}),a.props.menuIsOpen||a.onMenuOpen()},a.onInputFocus=function(f){a.props.onFocus&&a.props.onFocus(f),a.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(a.openAfterFocus||a.props.openMenuOnFocus)&&a.openMenu("first"),a.openAfterFocus=!1},a.onInputBlur=function(f){var u=a.props.inputValue;if(a.menuListRef&&a.menuListRef.contains(document.activeElement)){a.inputRef.focus();return}a.props.onBlur&&a.props.onBlur(f),a.onInputChange("",{action:"input-blur",prevInputValue:u}),a.onMenuClose(),a.setState({focusedValue:null,isFocused:!1})},a.onOptionHover=function(f){if(!(a.blockOptionHover||a.state.focusedOption===f)){var u=a.getFocusableOptions(),p=u.indexOf(f);a.setState({focusedOption:f,focusedOptionId:p>-1?a.getFocusedOptionId(f):null})}},a.shouldHideSelectedOptions=function(){return J2(a.props)},a.onValueInputFocus=function(f){f.preventDefault(),f.stopPropagation(),a.focus()},a.onKeyDown=function(f){var u=a.props,p=u.isMulti,g=u.backspaceRemovesValue,b=u.escapeClearsValue,v=u.inputValue,S=u.isClearable,k=u.isDisabled,T=u.menuIsOpen,P=u.onKeyDown,M=u.tabSelectsValue,I=u.openMenuOnFocus,U=a.state,L=U.focusedOption,$=U.focusedValue,z=U.selectValue;if(!k&&!(typeof P=="function"&&(P(f),f.defaultPrevented))){switch(a.blockOptionHover=!0,f.key){case"ArrowLeft":if(!p||v)return;a.focusValue("previous");break;case"ArrowRight":if(!p||v)return;a.focusValue("next");break;case"Delete":case"Backspace":if(v)return;if($)a.removeValue($);else{if(!g)return;p?a.popValue():S&&a.clearValue()}break;case"Tab":if(a.isComposing||f.shiftKey||!T||!M||!L||I&&a.isOptionSelected(L,z))return;a.selectOption(L);break;case"Enter":if(f.keyCode===229)break;if(T){if(!L||a.isComposing)return;a.selectOption(L);break}return;case"Escape":T?(a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange("",{action:"menu-close",prevInputValue:v}),a.onMenuClose()):S&&b&&a.clearValue();break;case" ":if(v)return;if(!T){a.openMenu("first");break}if(!L)return;a.selectOption(L);break;case"ArrowUp":T?a.focusOption("up"):a.openMenu("last");break;case"ArrowDown":T?a.focusOption("down"):a.openMenu("first");break;case"PageUp":if(!T)return;a.focusOption("pageup");break;case"PageDown":if(!T)return;a.focusOption("pagedown");break;case"Home":if(!T)return;a.focusOption("first");break;case"End":if(!T)return;a.focusOption("last");break;default:return}f.preventDefault()}},a.state.instancePrefix="react-select-"+(a.props.instanceId||++KL),a.state.selectValue=eN(r.value),r.menuIsOpen&&a.state.selectValue.length){var o=a.getFocusableOptionsWithIds(),l=a.buildFocusableOptions(),d=l.indexOf(a.state.selectValue[0]);a.state.focusableOptionsWithIds=o,a.state.focusedOption=l[d],a.state.focusedOptionId=n0(o,l[d])}return a}return g4(t,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&tN(this.menuListRef,this.focusedOptionRef),OL()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(a){var o=this.props,l=o.isDisabled,d=o.menuIsOpen,f=this.state.isFocused;(f&&!l&&a.isDisabled||f&&d&&!a.menuIsOpen)&&this.focusInput(),f&&l&&!a.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!f&&!l&&a.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(tN(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(a,o){this.props.onInputChange(a,o)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(a){var o=this,l=this.state,d=l.selectValue,f=l.isFocused,u=this.buildFocusableOptions(),p=a==="first"?0:u.length-1;if(!this.props.isMulti){var g=u.indexOf(d[0]);g>-1&&(p=g)}this.scrollToFocusedOptionOnUpdate=!(f&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:u[p],focusedOptionId:this.getFocusedOptionId(u[p])},function(){return o.onMenuOpen()})}},{key:"focusValue",value:function(a){var o=this.state,l=o.selectValue,d=o.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var f=l.indexOf(d);d||(f=-1);var u=l.length-1,p=-1;if(l.length){switch(a){case"previous":f===0?p=0:f===-1?p=u:p=f-1;break;case"next":f>-1&&f<u&&(p=f+1);break}this.setState({inputIsHidden:p!==-1,focusedValue:l[p]})}}}},{key:"focusOption",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",o=this.props.pageSize,l=this.state.focusedOption,d=this.getFocusableOptions();if(d.length){var f=0,u=d.indexOf(l);l||(u=-1),a==="up"?f=u>0?u-1:d.length-1:a==="down"?f=(u+1)%d.length:a==="pageup"?(f=u-o,f<0&&(f=0)):a==="pagedown"?(f=u+o,f>d.length-1&&(f=d.length-1)):a==="last"&&(f=d.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:d[f],focusedValue:null,focusedOptionId:this.getFocusedOptionId(d[f])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(t0):Rt(Rt({},t0),this.props.theme):t0}},{key:"getCommonProps",value:function(){var a=this.clearValue,o=this.cx,l=this.getStyles,d=this.getClassNames,f=this.getValue,u=this.selectOption,p=this.setValue,g=this.props,b=g.isMulti,v=g.isRtl,S=g.options,k=this.hasValue();return{clearValue:a,cx:o,getStyles:l,getClassNames:d,getValue:f,hasValue:k,isMulti:b,isRtl:v,options:S,selectOption:u,selectProps:g,setValue:p,theme:this.getTheme()}}},{key:"hasValue",value:function(){var a=this.state.selectValue;return a.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var a=this.props,o=a.isClearable,l=a.isMulti;return o===void 0?l:o}},{key:"isOptionDisabled",value:function(a,o){return Y2(this.props,a,o)}},{key:"isOptionSelected",value:function(a,o){return W2(this.props,a,o)}},{key:"filterOption",value:function(a,o){return Q2(this.props,a,o)}},{key:"formatOptionLabel",value:function(a,o){if(typeof this.props.formatOptionLabel=="function"){var l=this.props.inputValue,d=this.state.selectValue;return this.props.formatOptionLabel(a,{context:o,inputValue:l,selectValue:d})}else return this.getOptionLabel(a)}},{key:"formatGroupLabel",value:function(a){return this.props.formatGroupLabel(a)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var a=this.props,o=a.isDisabled,l=a.isSearchable,d=a.inputId,f=a.inputValue,u=a.tabIndex,p=a.form,g=a.menuIsOpen,b=a.required,v=this.getComponents(),S=v.Input,k=this.state,T=k.inputIsHidden,P=k.ariaSelection,M=this.commonProps,I=d||this.getElementId("input"),U=Rt(Rt(Rt({"aria-autocomplete":"list","aria-expanded":g,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":b,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},g&&{"aria-controls":this.getElementId("listbox")}),!l&&{"aria-readonly":!0}),this.hasValue()?(P==null?void 0:P.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return l?w.createElement(S,$t({},M,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:I,innerRef:this.getInputRef,isDisabled:o,isHidden:T,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:u,form:p,type:"text",value:f},U)):w.createElement(NL,$t({id:I,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:nb,onFocus:this.onInputFocus,disabled:o,tabIndex:u,inputMode:"none",form:p,value:""},U))}},{key:"renderPlaceholderOrValue",value:function(){var a=this,o=this.getComponents(),l=o.MultiValue,d=o.MultiValueContainer,f=o.MultiValueLabel,u=o.MultiValueRemove,p=o.SingleValue,g=o.Placeholder,b=this.commonProps,v=this.props,S=v.controlShouldRenderValue,k=v.isDisabled,T=v.isMulti,P=v.inputValue,M=v.placeholder,I=this.state,U=I.selectValue,L=I.focusedValue,$=I.isFocused;if(!this.hasValue()||!S)return P?null:w.createElement(g,$t({},b,{key:"placeholder",isDisabled:k,isFocused:$,innerProps:{id:this.getElementId("placeholder")}}),M);if(T)return U.map(function(F,Y){var R=F===L,B="".concat(a.getOptionLabel(F),"-").concat(a.getOptionValue(F));return w.createElement(l,$t({},b,{components:{Container:d,Label:f,Remove:u},isFocused:R,isDisabled:k,key:B,index:Y,removeProps:{onClick:function(){return a.removeValue(F)},onTouchEnd:function(){return a.removeValue(F)},onMouseDown:function(ie){ie.preventDefault()}},data:F}),a.formatOptionLabel(F,"value"))});if(P)return null;var z=U[0];return w.createElement(p,$t({},b,{data:z,isDisabled:k}),this.formatOptionLabel(z,"value"))}},{key:"renderClearIndicator",value:function(){var a=this.getComponents(),o=a.ClearIndicator,l=this.commonProps,d=this.props,f=d.isDisabled,u=d.isLoading,p=this.state.isFocused;if(!this.isClearable()||!o||f||!this.hasValue()||u)return null;var g={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(o,$t({},l,{innerProps:g,isFocused:p}))}},{key:"renderLoadingIndicator",value:function(){var a=this.getComponents(),o=a.LoadingIndicator,l=this.commonProps,d=this.props,f=d.isDisabled,u=d.isLoading,p=this.state.isFocused;if(!o||!u)return null;var g={"aria-hidden":"true"};return w.createElement(o,$t({},l,{innerProps:g,isDisabled:f,isFocused:p}))}},{key:"renderIndicatorSeparator",value:function(){var a=this.getComponents(),o=a.DropdownIndicator,l=a.IndicatorSeparator;if(!o||!l)return null;var d=this.commonProps,f=this.props.isDisabled,u=this.state.isFocused;return w.createElement(l,$t({},d,{isDisabled:f,isFocused:u}))}},{key:"renderDropdownIndicator",value:function(){var a=this.getComponents(),o=a.DropdownIndicator;if(!o)return null;var l=this.commonProps,d=this.props.isDisabled,f=this.state.isFocused,u={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(o,$t({},l,{innerProps:u,isDisabled:d,isFocused:f}))}},{key:"renderMenu",value:function(){var a=this,o=this.getComponents(),l=o.Group,d=o.GroupHeading,f=o.Menu,u=o.MenuList,p=o.MenuPortal,g=o.LoadingMessage,b=o.NoOptionsMessage,v=o.Option,S=this.commonProps,k=this.state.focusedOption,T=this.props,P=T.captureMenuScroll,M=T.inputValue,I=T.isLoading,U=T.loadingMessage,L=T.minMenuHeight,$=T.maxMenuHeight,z=T.menuIsOpen,F=T.menuPlacement,Y=T.menuPosition,R=T.menuPortalTarget,B=T.menuShouldBlockScroll,G=T.menuShouldScrollIntoView,ie=T.noOptionsMessage,te=T.onMenuScrollToTop,W=T.onMenuScrollToBottom;if(!z)return null;var V=function(D,ce){var ve=D.type,X=D.data,fe=D.isDisabled,ae=D.isSelected,Me=D.label,Ke=D.value,Z=k===X,Ee=fe?void 0:function(){return a.onOptionHover(X)},Ie=fe?void 0:function(){return a.selectOption(X)},Fe="".concat(a.getElementId("option"),"-").concat(ce),rt={id:Fe,onClick:Ie,onMouseMove:Ee,onMouseOver:Ee,tabIndex:-1,role:"option","aria-selected":a.state.isAppleDevice?void 0:ae};return w.createElement(v,$t({},S,{innerProps:rt,data:X,isDisabled:fe,isSelected:ae,key:Fe,label:Me,type:ve,value:Ke,isFocused:Z,innerRef:Z?a.getFocusedOptionRef:void 0}),a.formatOptionLabel(D.data,"menu"))},se;if(this.hasOptions())se=this.getCategorizedOptions().map(function(ue){if(ue.type==="group"){var D=ue.data,ce=ue.options,ve=ue.index,X="".concat(a.getElementId("group"),"-").concat(ve),fe="".concat(X,"-heading");return w.createElement(l,$t({},S,{key:X,data:D,options:ce,Heading:d,headingProps:{id:fe,data:ue.data},label:a.formatGroupLabel(ue.data)}),ue.options.map(function(ae){return V(ae,"".concat(ve,"-").concat(ae.index))}))}else if(ue.type==="option")return V(ue,"".concat(ue.index))});else if(I){var re=U({inputValue:M});if(re===null)return null;se=w.createElement(g,S,re)}else{var oe=ie({inputValue:M});if(oe===null)return null;se=w.createElement(b,S,oe)}var E={minMenuHeight:L,maxMenuHeight:$,menuPlacement:F,menuPosition:Y,menuShouldScrollIntoView:G},le=w.createElement(tO,$t({},S,E),function(ue){var D=ue.ref,ce=ue.placerProps,ve=ce.placement,X=ce.maxHeight;return w.createElement(f,$t({},S,E,{innerRef:D,innerProps:{onMouseDown:a.onMenuMouseDown,onMouseMove:a.onMenuMouseMove},isLoading:I,placement:ve}),w.createElement(EL,{captureEnabled:P,onTopArrive:te,onBottomArrive:W,lockEnabled:B},function(fe){return w.createElement(u,$t({},S,{innerRef:function(Me){a.getMenuListRef(Me),fe(Me)},innerProps:{role:"listbox","aria-multiselectable":S.isMulti,id:a.getElementId("listbox")},isLoading:I,maxHeight:X,focusedOption:k}),se)}))});return R||Y==="fixed"?w.createElement(p,$t({},S,{appendTo:R,controlElement:this.controlRef,menuPlacement:F,menuPosition:Y}),le):le}},{key:"renderFormField",value:function(){var a=this,o=this.props,l=o.delimiter,d=o.isDisabled,f=o.isMulti,u=o.name,p=o.required,g=this.state.selectValue;if(p&&!this.hasValue()&&!d)return w.createElement(DL,{name:u,onFocus:this.onValueInputFocus});if(!(!u||d))if(f)if(l){var b=g.map(function(k){return a.getOptionValue(k)}).join(l);return w.createElement("input",{name:u,type:"hidden",value:b})}else{var v=g.length>0?g.map(function(k,T){return w.createElement("input",{key:"i-".concat(T),name:u,type:"hidden",value:a.getOptionValue(k)})}):w.createElement("input",{name:u,type:"hidden",value:""});return w.createElement("div",null,v)}else{var S=g[0]?this.getOptionValue(g[0]):"";return w.createElement("input",{name:u,type:"hidden",value:S})}}},{key:"renderLiveRegion",value:function(){var a=this.commonProps,o=this.state,l=o.ariaSelection,d=o.focusedOption,f=o.focusedValue,u=o.isFocused,p=o.selectValue,g=this.getFocusableOptions();return w.createElement(yL,$t({},a,{id:this.getElementId("live-region"),ariaSelection:l,focusedOption:d,focusedValue:f,isFocused:u,selectValue:p,focusableOptions:g,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var a=this.getComponents(),o=a.Control,l=a.IndicatorsContainer,d=a.SelectContainer,f=a.ValueContainer,u=this.props,p=u.className,g=u.id,b=u.isDisabled,v=u.menuIsOpen,S=this.state.isFocused,k=this.commonProps=this.getCommonProps();return w.createElement(d,$t({},k,{className:p,innerProps:{id:g,onKeyDown:this.onKeyDown},isDisabled:b,isFocused:S}),this.renderLiveRegion(),w.createElement(o,$t({},k,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:b,isFocused:S,menuIsOpen:v}),w.createElement(f,$t({},k,{isDisabled:b}),this.renderPlaceholderOrValue(),this.renderInput()),w.createElement(l,$t({},k,{isDisabled:b}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(a,o){var l=o.prevProps,d=o.clearFocusValueOnUpdate,f=o.inputIsHiddenAfterUpdate,u=o.ariaSelection,p=o.isFocused,g=o.prevWasFocused,b=o.instancePrefix,v=a.options,S=a.value,k=a.menuIsOpen,T=a.inputValue,P=a.isMulti,M=eN(S),I={};if(l&&(S!==l.value||v!==l.options||k!==l.menuIsOpen||T!==l.inputValue)){var U=k?WL(a,M):[],L=k?mN(Lx(a,M),"".concat(b,"-option")):[],$=d?QL(o,M):null,z=JL(o,U),F=n0(L,z);I={selectValue:M,focusedOption:z,focusedOptionId:F,focusableOptionsWithIds:L,focusedValue:$,clearFocusValueOnUpdate:!1}}var Y=f!=null&&a!==l?{inputIsHidden:f,inputIsHiddenAfterUpdate:void 0}:{},R=u,B=p&&g;return p&&!B&&(R={value:mx(P,M,M[0]||null),options:M,action:"initial-input-focus"},B=!g),(u==null?void 0:u.action)==="initial-input-focus"&&(R=null),Rt(Rt(Rt({},I),Y),{},{prevProps:a,ariaSelection:R,prevWasFocused:B})}}]),t}(w.Component);K2.defaultProps=YL;var XL=w.forwardRef(function(e,n){var t=p4(e);return w.createElement(K2,$t({ref:n},t))}),X2=XL;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let ZL,e3;function t3(){return{geminiUrl:ZL,vertexUrl:e3}}function n3(e,n,t){var r,a,o;if(!(!((r=e.httpOptions)===null||r===void 0)&&r.baseUrl)){const l=t3();return e.vertexai?(a=l.vertexUrl)!==null&&a!==void 0?a:n:(o=l.geminiUrl)!==null&&o!==void 0?o:t}return e.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sg{}function Ut(e,n){const t=/\{([^}]+)\}/g;return e.replace(t,(r,a)=>{if(Object.prototype.hasOwnProperty.call(n,a)){const o=n[a];return o!=null?String(o):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function j(e,n,t){for(let o=0;o<n.length-1;o++){const l=n[o];if(l.endsWith("[]")){const d=l.slice(0,-2);if(!(d in e))if(Array.isArray(t))e[d]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(e[d])){const f=e[d];if(Array.isArray(t))for(let u=0;u<f.length;u++){const p=f[u];j(p,n.slice(o+1),t[u])}else for(const u of f)j(u,n.slice(o+1),t)}return}else if(l.endsWith("[0]")){const d=l.slice(0,-3);d in e||(e[d]=[{}]);const f=e[d];j(f[0],n.slice(o+1),t);return}(!e[l]||typeof e[l]!="object")&&(e[l]={}),e=e[l]}const r=n[n.length-1],a=e[r];if(a!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===a)return;if(typeof a=="object"&&typeof t=="object"&&a!==null&&t!==null)Object.assign(a,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else e[r]=t}function C(e,n){try{if(n.length===1&&n[0]==="_self")return e;for(let t=0;t<n.length;t++){if(typeof e!="object"||e===null)return;const r=n[t];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in e){const o=e[a];return Array.isArray(o)?o.map(l=>C(l,n.slice(t+1))):void 0}else return}else e=e[r]}return e}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pr(e,n){if(!n||typeof n!="string")throw new Error("model is required and must be a string");if(e.isVertexAI()){if(n.startsWith("publishers/")||n.startsWith("projects/")||n.startsWith("models/"))return n;if(n.indexOf("/")>=0){const t=n.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${n}`}else return n.startsWith("models/")||n.startsWith("tunedModels/")?n:`models/${n}`}function Z2(e,n){const t=pr(e,n);return t?t.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:t.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${t}`:t:""}function ek(e,n){return Array.isArray(n)?n.map(t=>ab(e,t)):[ab(e,n)]}function ab(e,n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function r3(e,n){const t=ab(e,n);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function i3(e,n){const t=ab(e,n);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function yN(e,n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function tk(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(t=>yN(e,t)):[yN(e,n)]}function o1(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function xN(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function bN(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function ca(e,n){if(n==null)throw new Error("ContentUnion is required");return o1(n)?n:{role:"user",parts:tk(e,n)}}function nk(e,n){if(!n)return[];if(e.isVertexAI()&&Array.isArray(n))return n.flatMap(t=>{const r=ca(e,t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const t=ca(e,n);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(n)?n.map(t=>ca(e,t)):[ca(e,n)]}function fu(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(xN(n)||bN(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ca(e,n)]}const t=[],r=[],a=o1(n[0]);for(const o of n){const l=o1(o);if(l!=a)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)t.push(o);else{if(xN(o)||bN(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(o)}}return a||t.push({role:"user",parts:tk(e,r)}),t}function rk(e,n){return n}function ik(e,n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function kb(e,n){return n}function Tb(e,n){if(!Array.isArray(n))throw new Error("tool is required and must be an array of Tools");return n}function a3(e,n,t,r=1){const a=!n.startsWith(`${t}/`)&&n.split("/").length===r;return e.isVertexAI()?n.startsWith("projects/")?n:n.startsWith("locations/")?`projects/${e.getProject()}/${n}`:n.startsWith(`${t}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:a?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}/${n}`:n:a?`${t}/${n}`:n}function hu(e,n){if(typeof n!="string")throw new Error("name must be a string");return a3(e,n,"cachedContents")}function ak(e,n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function pu(e,n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function s3(e){return e!=null&&typeof e=="object"&&"name"in e}function o3(e){return e!=null&&typeof e=="object"&&"video"in e}function l3(e){return e!=null&&typeof e=="object"&&"uri"in e}function sk(e,n){var t;let r;if(s3(n)&&(r=n.name),!(l3(n)&&(r=n.uri,r===void 0))&&!(o3(n)&&(r=(t=n.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof n=="string"&&(r=n),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const o=r.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${r}`);r=o[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function ok(e,n){let t;return e.isVertexAI()?t=n?"publishers/google/models":"models":t=n?"models":"tunedModels",t}function lk(e,n){for(const t of["models","tunedModels","publisherModels"])if(c3(n,t))return n[t];return[]}function c3(e,n){return e!==null&&typeof e=="object"&&n in e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function u3(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&j(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function d3(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&j(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],u3(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&j(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&j(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&j(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&j(t,["functionResponse"],u);const p=C(n,["text"]);return p!=null&&j(t,["text"],p),t}function vN(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>d3(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function f3(){return{}}function h3(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function p3(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],h3(e,r)),t}function m3(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&j(t,["googleSearch"],f3());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&j(t,["googleSearchRetrieval"],p3(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&j(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&j(t,["functionDeclarations"],l),t}function g3(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function y3(e,n){const t={},r=C(n,["functionCallingConfig"]);if(r!=null&&j(t,["functionCallingConfig"],g3(e,r)),C(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function x3(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const o=C(n,["expireTime"]);t!==void 0&&o!=null&&j(t,["expireTime"],o);const l=C(n,["displayName"]);t!==void 0&&l!=null&&j(t,["displayName"],l);const d=C(n,["contents"]);if(t!==void 0&&d!=null){let g=fu(e,d);Array.isArray(g)&&(g=g.map(b=>vN(e,b))),j(t,["contents"],g)}const f=C(n,["systemInstruction"]);t!==void 0&&f!=null&&j(t,["systemInstruction"],vN(e,ca(e,f)));const u=C(n,["tools"]);if(t!==void 0&&u!=null){let g=u;Array.isArray(g)&&(g=g.map(b=>m3(e,b))),j(t,["tools"],g)}const p=C(n,["toolConfig"]);return t!==void 0&&p!=null&&j(t,["toolConfig"],y3(e,p)),r}function b3(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["model"],Z2(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],x3(e,a,t)),t}function v3(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],hu(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function w3(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],hu(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function S3(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const o=C(n,["expireTime"]);return t!==void 0&&o!=null&&j(t,["expireTime"],o),r}function N3(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],hu(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],S3(e,a,t)),t}function C3(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&j(t,["_query","pageToken"],o),r}function j3(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],C3(e,r,t)),t}function _3(e,n){const t={},r=C(n,["displayName"]);r!=null&&j(t,["displayName"],r);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function k3(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&j(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&j(t,["inlineData"],_3(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&j(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const p=C(n,["functionResponse"]);p!=null&&j(t,["functionResponse"],p);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function wN(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>k3(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function T3(){return{}}function E3(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function A3(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],E3(e,r)),t}function P3(){return{}}function D3(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&j(t,["apiKeyString"],r),t}function I3(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&j(t,["apiKeyConfig"],D3(e,r));const a=C(n,["authType"]);a!=null&&j(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&j(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&j(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&j(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&j(t,["oidcConfig"],f),t}function R3(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&j(t,["authConfig"],I3(e,r)),t}function M3(e,n){const t={},r=C(n,["retrieval"]);r!=null&&j(t,["retrieval"],r),C(n,["googleSearch"])!=null&&j(t,["googleSearch"],T3());const o=C(n,["googleSearchRetrieval"]);o!=null&&j(t,["googleSearchRetrieval"],A3(e,o)),C(n,["enterpriseWebSearch"])!=null&&j(t,["enterpriseWebSearch"],P3());const d=C(n,["googleMaps"]);d!=null&&j(t,["googleMaps"],R3(e,d));const f=C(n,["codeExecution"]);f!=null&&j(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&j(t,["functionDeclarations"],u),t}function O3(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function L3(e,n){const t={},r=C(n,["latitude"]);r!=null&&j(t,["latitude"],r);const a=C(n,["longitude"]);return a!=null&&j(t,["longitude"],a),t}function F3(e,n){const t={},r=C(n,["latLng"]);return r!=null&&j(t,["latLng"],L3(e,r)),t}function $3(e,n){const t={},r=C(n,["functionCallingConfig"]);r!=null&&j(t,["functionCallingConfig"],O3(e,r));const a=C(n,["retrievalConfig"]);return a!=null&&j(t,["retrievalConfig"],F3(e,a)),t}function z3(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const o=C(n,["expireTime"]);t!==void 0&&o!=null&&j(t,["expireTime"],o);const l=C(n,["displayName"]);t!==void 0&&l!=null&&j(t,["displayName"],l);const d=C(n,["contents"]);if(t!==void 0&&d!=null){let g=fu(e,d);Array.isArray(g)&&(g=g.map(b=>wN(e,b))),j(t,["contents"],g)}const f=C(n,["systemInstruction"]);t!==void 0&&f!=null&&j(t,["systemInstruction"],wN(e,ca(e,f)));const u=C(n,["tools"]);if(t!==void 0&&u!=null){let g=u;Array.isArray(g)&&(g=g.map(b=>M3(e,b))),j(t,["tools"],g)}const p=C(n,["toolConfig"]);return t!==void 0&&p!=null&&j(t,["toolConfig"],$3(e,p)),r}function U3(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["model"],Z2(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],z3(e,a,t)),t}function B3(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],hu(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function q3(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],hu(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function V3(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const o=C(n,["expireTime"]);return t!==void 0&&o!=null&&j(t,["expireTime"],o),r}function H3(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],hu(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],V3(e,a,t)),t}function G3(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&j(t,["_query","pageToken"],o),r}function Y3(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],G3(e,r,t)),t}function Fx(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const o=C(n,["model"]);o!=null&&j(t,["model"],o);const l=C(n,["createTime"]);l!=null&&j(t,["createTime"],l);const d=C(n,["updateTime"]);d!=null&&j(t,["updateTime"],d);const f=C(n,["expireTime"]);f!=null&&j(t,["expireTime"],f);const u=C(n,["usageMetadata"]);return u!=null&&j(t,["usageMetadata"],u),t}function W3(){return{}}function Q3(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["cachedContents"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>Fx(e,l))),j(t,["cachedContents"],o)}return t}function $x(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const o=C(n,["model"]);o!=null&&j(t,["model"],o);const l=C(n,["createTime"]);l!=null&&j(t,["createTime"],l);const d=C(n,["updateTime"]);d!=null&&j(t,["updateTime"],d);const f=C(n,["expireTime"]);f!=null&&j(t,["expireTime"],f);const u=C(n,["usageMetadata"]);return u!=null&&j(t,["usageMetadata"],u),t}function J3(){return{}}function K3(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["cachedContents"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>$x(e,l))),j(t,["cachedContents"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Dh;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Dh||(Dh={}));class Eb{constructor(n,t,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(n,r,a)}init(n,t,r){var a,o;this.nameInternal=n,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};r?typeof r=="object"?l=Object.assign({},r):l=r:l={config:{}},l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(o=(a=l.config)===null||a===void 0?void 0:a.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(n){this.init(this.nameInternal,n,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(n){return this.pageInternal[n]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const n=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:n,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const n=await this.requestInternal(this.params);return this.initNextPage(n),this.page}hasNextPage(){var n;return((n=this.params.config)===null||n===void 0?void 0:n.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var SN;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(SN||(SN={}));var NN;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(NN||(NN={}));var CN;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(CN||(CN={}));var jN;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(jN||(jN={}));var _N;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(_N||(_N={}));var kN;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(kN||(kN={}));var TN;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(TN||(TN={}));var Ih;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT"})(Ih||(Ih={}));var EN;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY"})(EN||(EN={}));var AN;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(AN||(AN={}));var PN;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(PN||(PN={}));var DN;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(DN||(DN={}));var IN;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(IN||(IN={}));var uu;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(uu||(uu={}));var RN;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(RN||(RN={}));var l1;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(l1||(l1={}));var MN;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(MN||(MN={}));var ON;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(ON||(ON={}));var LN;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(LN||(LN={}));var FN;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(FN||(FN={}));var $N;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})($N||($N={}));var zN;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(zN||(zN={}));var UN;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi"})(UN||(UN={}));var BN;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(BN||(BN={}));var qN;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(qN||(qN={}));var VN;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(VN||(VN={}));var HN;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(HN||(HN={}));var GN;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(GN||(GN={}));var YN;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(YN||(YN={}));var WN;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(WN||(WN={}));var QN;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(QN||(QN={}));var JN;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(JN||(JN={}));var KN;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(KN||(KN={}));var XN;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(XN||(XN={}));class gx{get text(){var n,t,r,a,o,l,d,f;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",p=!1;const g=[];for(const b of(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[v,S]of Object.entries(b))v!=="text"&&v!=="thought"&&(S!==null||S!==void 0)&&g.push(v);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;p=!0,u+=b.text}}return g.length>0&&console.warn(`there are non-text parts ${g} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),p?u:void 0}get data(){var n,t,r,a,o,l,d,f;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const p=[];for(const g of(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[b,v]of Object.entries(g))b!=="inlineData"&&(v!==null||v!==void 0)&&p.push(b);g.inlineData&&typeof g.inlineData.data=="string"&&(u+=atob(g.inlineData.data))}return p.length>0&&console.warn(`there are non-data parts ${p} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var n,t,r,a,o,l,d,f;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(p=>p.functionCall).map(p=>p.functionCall).filter(p=>p!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var n,t,r,a,o,l,d,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const p=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(g=>g.executableCode).map(g=>g.executableCode).filter(g=>g!==void 0);if((p==null?void 0:p.length)!==0)return(u=p==null?void 0:p[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var n,t,r,a,o,l,d,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const p=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(g=>g.codeExecutionResult).map(g=>g.codeExecutionResult).filter(g=>g!==void 0);if((p==null?void 0:p.length)!==0)return(u=p==null?void 0:p[0])===null||u===void 0?void 0:u.output}}class ZN{}class eC{}class X3{}class Z3{}class tC{}class nC{}class rC{}class e6{}class iC{}class aC{}class sC{}class t6{}class c1{constructor(n){const t={};for(const r of n.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=n}json(){return this.responseInternal.json()}}class n6{}class r6{}class i6{get text(){var n,t,r;let a="",o=!1;const l=[];for(const d of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[f,u]of Object.entries(d))f!=="text"&&f!=="thought"&&u!==null&&l.push(f);if(typeof d.text=="string"){if(typeof d.thought=="boolean"&&d.thought)continue;o=!0,a+=d.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?a:void 0}get data(){var n,t,r;let a="";const o=[];for(const l of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[d,f]of Object.entries(l))d!=="inlineData"&&f!==null&&o.push(d);l.inlineData&&typeof l.inlineData.data=="string"&&(a+=atob(l.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class a6 extends sg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Eb(Dh.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=U3(this.apiClient,n);return d=Ut("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>$x(this.apiClient,p))}else{const u=b3(this.apiClient,n);return d=Ut("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>Fx(this.apiClient,p))}}async get(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=B3(this.apiClient,n);return d=Ut("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>$x(this.apiClient,p))}else{const u=v3(this.apiClient,n);return d=Ut("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>Fx(this.apiClient,p))}}async delete(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=q3(this.apiClient,n);return d=Ut("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(()=>{const p=J3(),g=new aC;return Object.assign(g,p),g})}else{const u=w3(this.apiClient,n);return d=Ut("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(()=>{const p=W3(),g=new aC;return Object.assign(g,p),g})}}async update(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=H3(this.apiClient,n);return d=Ut("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>$x(this.apiClient,p))}else{const u=N3(this.apiClient,n);return d=Ut("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>Fx(this.apiClient,p))}}async listInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=Y3(this.apiClient,n);return d=Ut("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=K3(this.apiClient,p),b=new sC;return Object.assign(b,g),b})}else{const u=j3(this.apiClient,n);return d=Ut("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=Q3(this.apiClient,p),b=new sC;return Object.assign(b,g),b})}}}function oC(e){var n=typeof Symbol=="function"&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ni(e){return this instanceof Ni?(this.v=e,this):new Ni(e)}function sb(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(e,n||[]),a,o=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",l),a[Symbol.asyncIterator]=function(){return this},a;function l(v){return function(S){return Promise.resolve(S).then(v,g)}}function d(v,S){r[v]&&(a[v]=function(k){return new Promise(function(T,P){o.push([v,k,T,P])>1||f(v,k)})},S&&(a[v]=S(a[v])))}function f(v,S){try{u(r[v](S))}catch(k){b(o[0][3],k)}}function u(v){v.value instanceof Ni?Promise.resolve(v.value.v).then(p,g):b(o[0][2],v)}function p(v){f("next",v)}function g(v){f("throw",v)}function b(v,S){v(S),o.shift(),o.length&&f(o[0][0],o[0][1])}}function u1(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e[Symbol.asyncIterator],t;return n?n.call(e):(e=typeof oC=="function"?oC(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=e[o]&&function(l){return new Promise(function(d,f){l=e[o](l),a(d,f,l.done,l.value)})}}function a(o,l,d,f){Promise.resolve(f).then(function(u){o({value:u,done:d})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function s6(e){var n;if(e.candidates==null||e.candidates.length===0)return!1;const t=(n=e.candidates[0])===null||n===void 0?void 0:n.content;return t===void 0?!1:ck(t)}function ck(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const n of e.parts)if(n===void 0||Object.keys(n).length===0||n.text!==void 0&&n.text==="")return!1;return!0}function o6(e){if(e.length!==0){if(e[0].role!=="user")throw new Error("History must start with a user turn.");for(const n of e)if(n.role!=="user"&&n.role!=="model")throw new Error(`Role must be user or model, but got ${n.role}.`)}}function l6(e){if(e===void 0||e.length===0)return[];const n=[],t=e.length;let r=0,a=e[0];for(;r<t;)if(e[r].role==="user")a=e[r],r++;else{const o=[];let l=!0;for(;r<t&&e[r].role==="model";)o.push(e[r]),l&&!ck(e[r])&&(l=!1),r++;l&&(n.push(a),n.push(...o))}return n}class c6{constructor(n,t){this.modelsModule=n,this.apiClient=t}create(n){return new u6(this.apiClient,this.modelsModule,n.model,n.config,n.history)}}class u6{constructor(n,t,r,a={},o=[]){this.apiClient=n,this.modelsModule=t,this.model=r,this.config=a,this.history=o,this.sendPromise=Promise.resolve(),o6(o)}async sendMessage(n){var t;await this.sendPromise;const r=ca(this.apiClient,n.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,l;const f=(l=(o=(await a).candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content,u=f?[f]:[];this.recordHistory(r,u)})(),await this.sendPromise,a}async sendMessageStream(n){var t;await this.sendPromise;const r=ca(this.apiClient,n.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const o=await a;return this.processStreamResponse(o,r)}getHistory(n=!1){return n?l6(this.history):this.history}processStreamResponse(n,t){var r,a;return sb(this,arguments,function*(){var l,d,f,u;const p=[];try{for(var g=!0,b=u1(n),v;v=yield Ni(b.next()),l=v.done,!l;g=!0){u=v.value,g=!1;const S=u;if(s6(S)){const k=(a=(r=S.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;k!==void 0&&p.push(k)}yield yield Ni(S)}}catch(S){d={error:S}}finally{try{!g&&!l&&(f=b.return)&&(yield Ni(f.call(b)))}finally{if(d)throw d.error}}this.recordHistory(t,p)})}recordHistory(n,t){let r=[];t.length>0&&t.every(a=>a.role==="model")?r=t:r.push({role:"model",parts:[]}),this.history.push(n),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function d6(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&j(t,["_query","pageToken"],o),r}function f6(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],d6(e,r,t)),t}function h6(e,n){const t={},r=C(n,["details"]);r!=null&&j(t,["details"],r);const a=C(n,["message"]);a!=null&&j(t,["message"],a);const o=C(n,["code"]);return o!=null&&j(t,["code"],o),t}function p6(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const o=C(n,["mimeType"]);o!=null&&j(t,["mimeType"],o);const l=C(n,["sizeBytes"]);l!=null&&j(t,["sizeBytes"],l);const d=C(n,["createTime"]);d!=null&&j(t,["createTime"],d);const f=C(n,["expirationTime"]);f!=null&&j(t,["expirationTime"],f);const u=C(n,["updateTime"]);u!=null&&j(t,["updateTime"],u);const p=C(n,["sha256Hash"]);p!=null&&j(t,["sha256Hash"],p);const g=C(n,["uri"]);g!=null&&j(t,["uri"],g);const b=C(n,["downloadUri"]);b!=null&&j(t,["downloadUri"],b);const v=C(n,["state"]);v!=null&&j(t,["state"],v);const S=C(n,["source"]);S!=null&&j(t,["source"],S);const k=C(n,["videoMetadata"]);k!=null&&j(t,["videoMetadata"],k);const T=C(n,["error"]);return T!=null&&j(t,["error"],h6(e,T)),t}function m6(e,n){const t={},r=C(n,["file"]);r!=null&&j(t,["file"],p6(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function g6(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","file"],sk(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function y6(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","file"],sk(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function x6(e,n){const t={},r=C(n,["details"]);r!=null&&j(t,["details"],r);const a=C(n,["message"]);a!=null&&j(t,["message"],a);const o=C(n,["code"]);return o!=null&&j(t,["code"],o),t}function d1(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const o=C(n,["mimeType"]);o!=null&&j(t,["mimeType"],o);const l=C(n,["sizeBytes"]);l!=null&&j(t,["sizeBytes"],l);const d=C(n,["createTime"]);d!=null&&j(t,["createTime"],d);const f=C(n,["expirationTime"]);f!=null&&j(t,["expirationTime"],f);const u=C(n,["updateTime"]);u!=null&&j(t,["updateTime"],u);const p=C(n,["sha256Hash"]);p!=null&&j(t,["sha256Hash"],p);const g=C(n,["uri"]);g!=null&&j(t,["uri"],g);const b=C(n,["downloadUri"]);b!=null&&j(t,["downloadUri"],b);const v=C(n,["state"]);v!=null&&j(t,["state"],v);const S=C(n,["source"]);S!=null&&j(t,["source"],S);const k=C(n,["videoMetadata"]);k!=null&&j(t,["videoMetadata"],k);const T=C(n,["error"]);return T!=null&&j(t,["error"],x6(e,T)),t}function b6(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["files"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>d1(e,l))),j(t,["files"],o)}return t}function v6(){return{}}function w6(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class S6 extends sg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Eb(Dh.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(n){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(n.file,n.config).then(t=>d1(this.apiClient,t))}async download(n){await this.apiClient.downloadFile(n)}async listInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=f6(this.apiClient,n);return o=Ut("files",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const u=b6(this.apiClient,f),p=new t6;return Object.assign(p,u),p})}}async createInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=m6(this.apiClient,n);return o=Ut("upload/v1beta/files",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(()=>{const f=v6(),u=new n6;return Object.assign(u,f),u})}}async get(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=g6(this.apiClient,n);return o=Ut("files/{file}",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>d1(this.apiClient,f))}}async delete(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=y6(this.apiClient,n);return o=Ut("files/{file}",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(()=>{const f=w6(),u=new r6;return Object.assign(u,f),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function N6(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&j(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function C6(e,n){const t={},r=C(n,["displayName"]);r!=null&&j(t,["displayName"],r);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function j6(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&j(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],N6(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&j(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&j(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&j(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&j(t,["functionResponse"],u);const p=C(n,["text"]);return p!=null&&j(t,["text"],p),t}function _6(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&j(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&j(t,["inlineData"],C6(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&j(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const p=C(n,["functionResponse"]);p!=null&&j(t,["functionResponse"],p);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function k6(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>j6(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function T6(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>_6(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function E6(){return{}}function A6(){return{}}function P6(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function D6(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function I6(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],P6(e,r)),t}function R6(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],D6(e,r)),t}function M6(){return{}}function O6(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&j(t,["apiKeyString"],r),t}function L6(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&j(t,["apiKeyConfig"],O6(e,r));const a=C(n,["authType"]);a!=null&&j(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&j(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&j(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&j(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&j(t,["oidcConfig"],f),t}function F6(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&j(t,["authConfig"],L6(e,r)),t}function $6(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&j(t,["googleSearch"],E6());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&j(t,["googleSearchRetrieval"],I6(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&j(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&j(t,["functionDeclarations"],l),t}function z6(e,n){const t={},r=C(n,["retrieval"]);r!=null&&j(t,["retrieval"],r),C(n,["googleSearch"])!=null&&j(t,["googleSearch"],A6());const o=C(n,["googleSearchRetrieval"]);o!=null&&j(t,["googleSearchRetrieval"],R6(e,o)),C(n,["enterpriseWebSearch"])!=null&&j(t,["enterpriseWebSearch"],M6());const d=C(n,["googleMaps"]);d!=null&&j(t,["googleMaps"],F6(e,d));const f=C(n,["codeExecution"]);f!=null&&j(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&j(t,["functionDeclarations"],u),t}function U6(e,n){const t={},r=C(n,["handle"]);if(r!=null&&j(t,["handle"],r),C(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function B6(e,n){const t={},r=C(n,["handle"]);r!=null&&j(t,["handle"],r);const a=C(n,["transparent"]);return a!=null&&j(t,["transparent"],a),t}function lC(){return{}}function cC(){return{}}function q6(e,n){const t={},r=C(n,["disabled"]);r!=null&&j(t,["disabled"],r);const a=C(n,["startOfSpeechSensitivity"]);a!=null&&j(t,["startOfSpeechSensitivity"],a);const o=C(n,["endOfSpeechSensitivity"]);o!=null&&j(t,["endOfSpeechSensitivity"],o);const l=C(n,["prefixPaddingMs"]);l!=null&&j(t,["prefixPaddingMs"],l);const d=C(n,["silenceDurationMs"]);return d!=null&&j(t,["silenceDurationMs"],d),t}function V6(e,n){const t={},r=C(n,["disabled"]);r!=null&&j(t,["disabled"],r);const a=C(n,["startOfSpeechSensitivity"]);a!=null&&j(t,["startOfSpeechSensitivity"],a);const o=C(n,["endOfSpeechSensitivity"]);o!=null&&j(t,["endOfSpeechSensitivity"],o);const l=C(n,["prefixPaddingMs"]);l!=null&&j(t,["prefixPaddingMs"],l);const d=C(n,["silenceDurationMs"]);return d!=null&&j(t,["silenceDurationMs"],d),t}function H6(e,n){const t={},r=C(n,["automaticActivityDetection"]);r!=null&&j(t,["automaticActivityDetection"],q6(e,r));const a=C(n,["activityHandling"]);a!=null&&j(t,["activityHandling"],a);const o=C(n,["turnCoverage"]);return o!=null&&j(t,["turnCoverage"],o),t}function G6(e,n){const t={},r=C(n,["automaticActivityDetection"]);r!=null&&j(t,["automaticActivityDetection"],V6(e,r));const a=C(n,["activityHandling"]);a!=null&&j(t,["activityHandling"],a);const o=C(n,["turnCoverage"]);return o!=null&&j(t,["turnCoverage"],o),t}function Y6(e,n){const t={},r=C(n,["targetTokens"]);return r!=null&&j(t,["targetTokens"],r),t}function W6(e,n){const t={},r=C(n,["targetTokens"]);return r!=null&&j(t,["targetTokens"],r),t}function Q6(e,n){const t={},r=C(n,["triggerTokens"]);r!=null&&j(t,["triggerTokens"],r);const a=C(n,["slidingWindow"]);return a!=null&&j(t,["slidingWindow"],Y6(e,a)),t}function J6(e,n){const t={},r=C(n,["triggerTokens"]);r!=null&&j(t,["triggerTokens"],r);const a=C(n,["slidingWindow"]);return a!=null&&j(t,["slidingWindow"],W6(e,a)),t}function K6(e,n,t){const r={},a=C(n,["generationConfig"]);t!==void 0&&a!=null&&j(t,["setup","generationConfig"],a);const o=C(n,["responseModalities"]);t!==void 0&&o!=null&&j(t,["setup","generationConfig","responseModalities"],o);const l=C(n,["temperature"]);t!==void 0&&l!=null&&j(t,["setup","generationConfig","temperature"],l);const d=C(n,["topP"]);t!==void 0&&d!=null&&j(t,["setup","generationConfig","topP"],d);const f=C(n,["topK"]);t!==void 0&&f!=null&&j(t,["setup","generationConfig","topK"],f);const u=C(n,["maxOutputTokens"]);t!==void 0&&u!=null&&j(t,["setup","generationConfig","maxOutputTokens"],u);const p=C(n,["mediaResolution"]);t!==void 0&&p!=null&&j(t,["setup","generationConfig","mediaResolution"],p);const g=C(n,["seed"]);t!==void 0&&g!=null&&j(t,["setup","generationConfig","seed"],g);const b=C(n,["speechConfig"]);t!==void 0&&b!=null&&j(t,["setup","generationConfig","speechConfig"],b);const v=C(n,["systemInstruction"]);t!==void 0&&v!=null&&j(t,["setup","systemInstruction"],k6(e,ca(e,v)));const S=C(n,["tools"]);if(t!==void 0&&S!=null){let U=Tb(e,S);Array.isArray(U)&&(U=U.map(L=>$6(e,kb(e,L)))),j(t,["setup","tools"],U)}const k=C(n,["sessionResumption"]);t!==void 0&&k!=null&&j(t,["setup","sessionResumption"],U6(e,k));const T=C(n,["inputAudioTranscription"]);t!==void 0&&T!=null&&j(t,["setup","inputAudioTranscription"],lC());const P=C(n,["outputAudioTranscription"]);t!==void 0&&P!=null&&j(t,["setup","outputAudioTranscription"],lC());const M=C(n,["realtimeInputConfig"]);t!==void 0&&M!=null&&j(t,["setup","realtimeInputConfig"],H6(e,M));const I=C(n,["contextWindowCompression"]);return t!==void 0&&I!=null&&j(t,["setup","contextWindowCompression"],Q6(e,I)),r}function X6(e,n,t){const r={},a=C(n,["generationConfig"]);t!==void 0&&a!=null&&j(t,["setup","generationConfig"],a);const o=C(n,["responseModalities"]);t!==void 0&&o!=null&&j(t,["setup","generationConfig","responseModalities"],o);const l=C(n,["temperature"]);t!==void 0&&l!=null&&j(t,["setup","generationConfig","temperature"],l);const d=C(n,["topP"]);t!==void 0&&d!=null&&j(t,["setup","generationConfig","topP"],d);const f=C(n,["topK"]);t!==void 0&&f!=null&&j(t,["setup","generationConfig","topK"],f);const u=C(n,["maxOutputTokens"]);t!==void 0&&u!=null&&j(t,["setup","generationConfig","maxOutputTokens"],u);const p=C(n,["mediaResolution"]);t!==void 0&&p!=null&&j(t,["setup","generationConfig","mediaResolution"],p);const g=C(n,["seed"]);t!==void 0&&g!=null&&j(t,["setup","generationConfig","seed"],g);const b=C(n,["speechConfig"]);t!==void 0&&b!=null&&j(t,["setup","generationConfig","speechConfig"],b);const v=C(n,["systemInstruction"]);t!==void 0&&v!=null&&j(t,["setup","systemInstruction"],T6(e,ca(e,v)));const S=C(n,["tools"]);if(t!==void 0&&S!=null){let U=Tb(e,S);Array.isArray(U)&&(U=U.map(L=>z6(e,kb(e,L)))),j(t,["setup","tools"],U)}const k=C(n,["sessionResumption"]);t!==void 0&&k!=null&&j(t,["setup","sessionResumption"],B6(e,k));const T=C(n,["inputAudioTranscription"]);t!==void 0&&T!=null&&j(t,["setup","inputAudioTranscription"],cC());const P=C(n,["outputAudioTranscription"]);t!==void 0&&P!=null&&j(t,["setup","outputAudioTranscription"],cC());const M=C(n,["realtimeInputConfig"]);t!==void 0&&M!=null&&j(t,["setup","realtimeInputConfig"],G6(e,M));const I=C(n,["contextWindowCompression"]);return t!==void 0&&I!=null&&j(t,["setup","contextWindowCompression"],J6(e,I)),r}function Z6(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["setup","model"],pr(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],K6(e,a,t)),t}function eF(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["setup","model"],pr(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],X6(e,a,t)),t}function tF(){return{}}function nF(){return{}}function rF(){return{}}function iF(){return{}}function aF(e,n){const t={},r=C(n,["media"]);r!=null&&j(t,["mediaChunks"],ek(e,r));const a=C(n,["audio"]);a!=null&&j(t,["audio"],i3(e,a));const o=C(n,["audioStreamEnd"]);o!=null&&j(t,["audioStreamEnd"],o);const l=C(n,["video"]);l!=null&&j(t,["video"],r3(e,l));const d=C(n,["text"]);return d!=null&&j(t,["text"],d),C(n,["activityStart"])!=null&&j(t,["activityStart"],tF()),C(n,["activityEnd"])!=null&&j(t,["activityEnd"],rF()),t}function sF(e,n){const t={},r=C(n,["media"]);if(r!=null&&j(t,["mediaChunks"],ek(e,r)),C(n,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const a=C(n,["audioStreamEnd"]);if(a!=null&&j(t,["audioStreamEnd"],a),C(n,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(C(n,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return C(n,["activityStart"])!=null&&j(t,["activityStart"],nF()),C(n,["activityEnd"])!=null&&j(t,["activityEnd"],iF()),t}function oF(){return{}}function lF(){return{}}function cF(e,n){const t={},r=C(n,["data"]);r!=null&&j(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function uF(e,n){const t={},r=C(n,["displayName"]);r!=null&&j(t,["displayName"],r);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function dF(e,n){const t={},r=C(n,["thought"]);r!=null&&j(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],cF(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&j(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&j(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&j(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&j(t,["functionResponse"],u);const p=C(n,["text"]);return p!=null&&j(t,["text"],p),t}function fF(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&j(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&j(t,["inlineData"],uF(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&j(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const p=C(n,["functionResponse"]);p!=null&&j(t,["functionResponse"],p);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function hF(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>dF(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function pF(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>fF(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function uC(e,n){const t={},r=C(n,["text"]);r!=null&&j(t,["text"],r);const a=C(n,["finished"]);return a!=null&&j(t,["finished"],a),t}function dC(e,n){const t={},r=C(n,["text"]);r!=null&&j(t,["text"],r);const a=C(n,["finished"]);return a!=null&&j(t,["finished"],a),t}function mF(e,n){const t={},r=C(n,["modelTurn"]);r!=null&&j(t,["modelTurn"],hF(e,r));const a=C(n,["turnComplete"]);a!=null&&j(t,["turnComplete"],a);const o=C(n,["interrupted"]);o!=null&&j(t,["interrupted"],o);const l=C(n,["groundingMetadata"]);l!=null&&j(t,["groundingMetadata"],l);const d=C(n,["generationComplete"]);d!=null&&j(t,["generationComplete"],d);const f=C(n,["inputTranscription"]);f!=null&&j(t,["inputTranscription"],uC(e,f));const u=C(n,["outputTranscription"]);return u!=null&&j(t,["outputTranscription"],uC(e,u)),t}function gF(e,n){const t={},r=C(n,["modelTurn"]);r!=null&&j(t,["modelTurn"],pF(e,r));const a=C(n,["turnComplete"]);a!=null&&j(t,["turnComplete"],a);const o=C(n,["interrupted"]);o!=null&&j(t,["interrupted"],o);const l=C(n,["groundingMetadata"]);l!=null&&j(t,["groundingMetadata"],l);const d=C(n,["generationComplete"]);d!=null&&j(t,["generationComplete"],d);const f=C(n,["inputTranscription"]);f!=null&&j(t,["inputTranscription"],dC(e,f));const u=C(n,["outputTranscription"]);return u!=null&&j(t,["outputTranscription"],dC(e,u)),t}function yF(e,n){const t={},r=C(n,["id"]);r!=null&&j(t,["id"],r);const a=C(n,["args"]);a!=null&&j(t,["args"],a);const o=C(n,["name"]);return o!=null&&j(t,["name"],o),t}function xF(e,n){const t={},r=C(n,["args"]);r!=null&&j(t,["args"],r);const a=C(n,["name"]);return a!=null&&j(t,["name"],a),t}function bF(e,n){const t={},r=C(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>yF(e,o))),j(t,["functionCalls"],a)}return t}function vF(e,n){const t={},r=C(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>xF(e,o))),j(t,["functionCalls"],a)}return t}function wF(e,n){const t={},r=C(n,["ids"]);return r!=null&&j(t,["ids"],r),t}function SF(e,n){const t={},r=C(n,["ids"]);return r!=null&&j(t,["ids"],r),t}function yx(e,n){const t={},r=C(n,["modality"]);r!=null&&j(t,["modality"],r);const a=C(n,["tokenCount"]);return a!=null&&j(t,["tokenCount"],a),t}function xx(e,n){const t={},r=C(n,["modality"]);r!=null&&j(t,["modality"],r);const a=C(n,["tokenCount"]);return a!=null&&j(t,["tokenCount"],a),t}function NF(e,n){const t={},r=C(n,["promptTokenCount"]);r!=null&&j(t,["promptTokenCount"],r);const a=C(n,["cachedContentTokenCount"]);a!=null&&j(t,["cachedContentTokenCount"],a);const o=C(n,["responseTokenCount"]);o!=null&&j(t,["responseTokenCount"],o);const l=C(n,["toolUsePromptTokenCount"]);l!=null&&j(t,["toolUsePromptTokenCount"],l);const d=C(n,["thoughtsTokenCount"]);d!=null&&j(t,["thoughtsTokenCount"],d);const f=C(n,["totalTokenCount"]);f!=null&&j(t,["totalTokenCount"],f);const u=C(n,["promptTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(S=>yx(e,S))),j(t,["promptTokensDetails"],v)}const p=C(n,["cacheTokensDetails"]);if(p!=null){let v=p;Array.isArray(v)&&(v=v.map(S=>yx(e,S))),j(t,["cacheTokensDetails"],v)}const g=C(n,["responseTokensDetails"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(S=>yx(e,S))),j(t,["responseTokensDetails"],v)}const b=C(n,["toolUsePromptTokensDetails"]);if(b!=null){let v=b;Array.isArray(v)&&(v=v.map(S=>yx(e,S))),j(t,["toolUsePromptTokensDetails"],v)}return t}function CF(e,n){const t={},r=C(n,["promptTokenCount"]);r!=null&&j(t,["promptTokenCount"],r);const a=C(n,["cachedContentTokenCount"]);a!=null&&j(t,["cachedContentTokenCount"],a);const o=C(n,["candidatesTokenCount"]);o!=null&&j(t,["responseTokenCount"],o);const l=C(n,["toolUsePromptTokenCount"]);l!=null&&j(t,["toolUsePromptTokenCount"],l);const d=C(n,["thoughtsTokenCount"]);d!=null&&j(t,["thoughtsTokenCount"],d);const f=C(n,["totalTokenCount"]);f!=null&&j(t,["totalTokenCount"],f);const u=C(n,["promptTokensDetails"]);if(u!=null){let S=u;Array.isArray(S)&&(S=S.map(k=>xx(e,k))),j(t,["promptTokensDetails"],S)}const p=C(n,["cacheTokensDetails"]);if(p!=null){let S=p;Array.isArray(S)&&(S=S.map(k=>xx(e,k))),j(t,["cacheTokensDetails"],S)}const g=C(n,["candidatesTokensDetails"]);if(g!=null){let S=g;Array.isArray(S)&&(S=S.map(k=>xx(e,k))),j(t,["responseTokensDetails"],S)}const b=C(n,["toolUsePromptTokensDetails"]);if(b!=null){let S=b;Array.isArray(S)&&(S=S.map(k=>xx(e,k))),j(t,["toolUsePromptTokensDetails"],S)}const v=C(n,["trafficType"]);return v!=null&&j(t,["trafficType"],v),t}function jF(e,n){const t={},r=C(n,["timeLeft"]);return r!=null&&j(t,["timeLeft"],r),t}function _F(e,n){const t={},r=C(n,["timeLeft"]);return r!=null&&j(t,["timeLeft"],r),t}function kF(e,n){const t={},r=C(n,["newHandle"]);r!=null&&j(t,["newHandle"],r);const a=C(n,["resumable"]);a!=null&&j(t,["resumable"],a);const o=C(n,["lastConsumedClientMessageIndex"]);return o!=null&&j(t,["lastConsumedClientMessageIndex"],o),t}function TF(e,n){const t={},r=C(n,["newHandle"]);r!=null&&j(t,["newHandle"],r);const a=C(n,["resumable"]);a!=null&&j(t,["resumable"],a);const o=C(n,["lastConsumedClientMessageIndex"]);return o!=null&&j(t,["lastConsumedClientMessageIndex"],o),t}function EF(e,n){const t={};C(n,["setupComplete"])!=null&&j(t,["setupComplete"],oF());const a=C(n,["serverContent"]);a!=null&&j(t,["serverContent"],mF(e,a));const o=C(n,["toolCall"]);o!=null&&j(t,["toolCall"],bF(e,o));const l=C(n,["toolCallCancellation"]);l!=null&&j(t,["toolCallCancellation"],wF(e,l));const d=C(n,["usageMetadata"]);d!=null&&j(t,["usageMetadata"],NF(e,d));const f=C(n,["goAway"]);f!=null&&j(t,["goAway"],jF(e,f));const u=C(n,["sessionResumptionUpdate"]);return u!=null&&j(t,["sessionResumptionUpdate"],kF(e,u)),t}function AF(e,n){const t={};C(n,["setupComplete"])!=null&&j(t,["setupComplete"],lF());const a=C(n,["serverContent"]);a!=null&&j(t,["serverContent"],gF(e,a));const o=C(n,["toolCall"]);o!=null&&j(t,["toolCall"],vF(e,o));const l=C(n,["toolCallCancellation"]);l!=null&&j(t,["toolCallCancellation"],SF(e,l));const d=C(n,["usageMetadata"]);d!=null&&j(t,["usageMetadata"],CF(e,d));const f=C(n,["goAway"]);f!=null&&j(t,["goAway"],_F(e,f));const u=C(n,["sessionResumptionUpdate"]);return u!=null&&j(t,["sessionResumptionUpdate"],TF(e,u)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function PF(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&j(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function DF(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&j(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],PF(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&j(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&j(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&j(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&j(t,["functionResponse"],u);const p=C(n,["text"]);return p!=null&&j(t,["text"],p),t}function Ab(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>DF(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function IF(e,n){const t={};if(C(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=C(n,["category"]);r!=null&&j(t,["category"],r);const a=C(n,["threshold"]);return a!=null&&j(t,["threshold"],a),t}function RF(){return{}}function MF(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function OF(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],MF(e,r)),t}function LF(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&j(t,["googleSearch"],RF());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&j(t,["googleSearchRetrieval"],OF(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&j(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&j(t,["functionDeclarations"],l),t}function FF(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function $F(e,n){const t={},r=C(n,["functionCallingConfig"]);if(r!=null&&j(t,["functionCallingConfig"],FF(e,r)),C(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function zF(e,n){const t={},r=C(n,["voiceName"]);return r!=null&&j(t,["voiceName"],r),t}function UF(e,n){const t={},r=C(n,["prebuiltVoiceConfig"]);return r!=null&&j(t,["prebuiltVoiceConfig"],zF(e,r)),t}function BF(e,n){const t={},r=C(n,["voiceConfig"]);r!=null&&j(t,["voiceConfig"],UF(e,r));const a=C(n,["languageCode"]);return a!=null&&j(t,["languageCode"],a),t}function qF(e,n){const t={},r=C(n,["includeThoughts"]);r!=null&&j(t,["includeThoughts"],r);const a=C(n,["thinkingBudget"]);return a!=null&&j(t,["thinkingBudget"],a),t}function VF(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&j(t,["systemInstruction"],Ab(e,ca(e,a)));const o=C(n,["temperature"]);o!=null&&j(r,["temperature"],o);const l=C(n,["topP"]);l!=null&&j(r,["topP"],l);const d=C(n,["topK"]);d!=null&&j(r,["topK"],d);const f=C(n,["candidateCount"]);f!=null&&j(r,["candidateCount"],f);const u=C(n,["maxOutputTokens"]);u!=null&&j(r,["maxOutputTokens"],u);const p=C(n,["stopSequences"]);p!=null&&j(r,["stopSequences"],p);const g=C(n,["responseLogprobs"]);g!=null&&j(r,["responseLogprobs"],g);const b=C(n,["logprobs"]);b!=null&&j(r,["logprobs"],b);const v=C(n,["presencePenalty"]);v!=null&&j(r,["presencePenalty"],v);const S=C(n,["frequencyPenalty"]);S!=null&&j(r,["frequencyPenalty"],S);const k=C(n,["seed"]);k!=null&&j(r,["seed"],k);const T=C(n,["responseMimeType"]);T!=null&&j(r,["responseMimeType"],T);const P=C(n,["responseSchema"]);if(P!=null&&j(r,["responseSchema"],rk(e,P)),C(n,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(C(n,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const M=C(n,["safetySettings"]);if(t!==void 0&&M!=null){let R=M;Array.isArray(R)&&(R=R.map(B=>IF(e,B))),j(t,["safetySettings"],R)}const I=C(n,["tools"]);if(t!==void 0&&I!=null){let R=Tb(e,I);Array.isArray(R)&&(R=R.map(B=>LF(e,kb(e,B)))),j(t,["tools"],R)}const U=C(n,["toolConfig"]);if(t!==void 0&&U!=null&&j(t,["toolConfig"],$F(e,U)),C(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const L=C(n,["cachedContent"]);t!==void 0&&L!=null&&j(t,["cachedContent"],hu(e,L));const $=C(n,["responseModalities"]);$!=null&&j(r,["responseModalities"],$);const z=C(n,["mediaResolution"]);z!=null&&j(r,["mediaResolution"],z);const F=C(n,["speechConfig"]);if(F!=null&&j(r,["speechConfig"],BF(e,ik(e,F))),C(n,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Y=C(n,["thinkingConfig"]);return Y!=null&&j(r,["thinkingConfig"],qF(e,Y)),r}function fC(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],pr(e,r));const a=C(n,["contents"]);if(a!=null){let l=fu(e,a);Array.isArray(l)&&(l=l.map(d=>Ab(e,d))),j(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&j(t,["generationConfig"],VF(e,o,t)),t}function HF(e,n,t){const r={},a=C(n,["taskType"]);t!==void 0&&a!=null&&j(t,["requests[]","taskType"],a);const o=C(n,["title"]);t!==void 0&&o!=null&&j(t,["requests[]","title"],o);const l=C(n,["outputDimensionality"]);if(t!==void 0&&l!=null&&j(t,["requests[]","outputDimensionality"],l),C(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(C(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function GF(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],pr(e,r));const a=C(n,["contents"]);a!=null&&j(t,["requests[]","content"],nk(e,a));const o=C(n,["config"]);o!=null&&j(t,["config"],HF(e,o,t));const l=C(n,["model"]);return l!==void 0&&j(t,["requests[]","model"],pr(e,l)),t}function YF(e,n,t){const r={};if(C(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(C(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const a=C(n,["numberOfImages"]);t!==void 0&&a!=null&&j(t,["parameters","sampleCount"],a);const o=C(n,["aspectRatio"]);t!==void 0&&o!=null&&j(t,["parameters","aspectRatio"],o);const l=C(n,["guidanceScale"]);if(t!==void 0&&l!=null&&j(t,["parameters","guidanceScale"],l),C(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const d=C(n,["safetyFilterLevel"]);t!==void 0&&d!=null&&j(t,["parameters","safetySetting"],d);const f=C(n,["personGeneration"]);t!==void 0&&f!=null&&j(t,["parameters","personGeneration"],f);const u=C(n,["includeSafetyAttributes"]);t!==void 0&&u!=null&&j(t,["parameters","includeSafetyAttributes"],u);const p=C(n,["includeRaiReason"]);t!==void 0&&p!=null&&j(t,["parameters","includeRaiReason"],p);const g=C(n,["language"]);t!==void 0&&g!=null&&j(t,["parameters","language"],g);const b=C(n,["outputMimeType"]);t!==void 0&&b!=null&&j(t,["parameters","outputOptions","mimeType"],b);const v=C(n,["outputCompressionQuality"]);if(t!==void 0&&v!=null&&j(t,["parameters","outputOptions","compressionQuality"],v),C(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(C(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function WF(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],pr(e,r));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const o=C(n,["config"]);return o!=null&&j(t,["config"],YF(e,o,t)),t}function QF(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","name"],pr(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function JF(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&j(t,["_query","pageToken"],o);const l=C(n,["filter"]);t!==void 0&&l!=null&&j(t,["_query","filter"],l);const d=C(n,["queryBase"]);return t!==void 0&&d!=null&&j(t,["_url","models_url"],ok(e,d)),r}function KF(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],JF(e,r,t)),t}function XF(e,n,t){const r={},a=C(n,["displayName"]);t!==void 0&&a!=null&&j(t,["displayName"],a);const o=C(n,["description"]);t!==void 0&&o!=null&&j(t,["description"],o);const l=C(n,["defaultCheckpointId"]);return t!==void 0&&l!=null&&j(t,["defaultCheckpointId"],l),r}function ZF(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","name"],pr(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],XF(e,a,t)),t}function e5(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","name"],pr(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function t5(e,n){const t={};if(C(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(C(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(C(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function n5(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],pr(e,r));const a=C(n,["contents"]);if(a!=null){let l=fu(e,a);Array.isArray(l)&&(l=l.map(d=>Ab(e,d))),j(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&j(t,["config"],t5(e,o)),t}function r5(e,n){const t={};if(C(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=C(n,["imageBytes"]);r!=null&&j(t,["bytesBase64Encoded"],pu(e,r));const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function i5(e,n,t){const r={},a=C(n,["numberOfVideos"]);if(t!==void 0&&a!=null&&j(t,["parameters","sampleCount"],a),C(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(C(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=C(n,["durationSeconds"]);if(t!==void 0&&o!=null&&j(t,["parameters","durationSeconds"],o),C(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=C(n,["aspectRatio"]);if(t!==void 0&&l!=null&&j(t,["parameters","aspectRatio"],l),C(n,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const d=C(n,["personGeneration"]);if(t!==void 0&&d!=null&&j(t,["parameters","personGeneration"],d),C(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const f=C(n,["negativePrompt"]);if(t!==void 0&&f!=null&&j(t,["parameters","negativePrompt"],f),C(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function a5(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],pr(e,r));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const o=C(n,["image"]);o!=null&&j(t,["instances[0]","image"],r5(e,o));const l=C(n,["config"]);return l!=null&&j(t,["config"],i5(e,l,t)),t}function s5(e,n){const t={},r=C(n,["displayName"]);r!=null&&j(t,["displayName"],r);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function o5(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&j(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&j(t,["inlineData"],s5(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&j(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const p=C(n,["functionResponse"]);p!=null&&j(t,["functionResponse"],p);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function Bh(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>o5(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function l5(e,n){const t={},r=C(n,["featureSelectionPreference"]);return r!=null&&j(t,["featureSelectionPreference"],r),t}function c5(e,n){const t={},r=C(n,["method"]);r!=null&&j(t,["method"],r);const a=C(n,["category"]);a!=null&&j(t,["category"],a);const o=C(n,["threshold"]);return o!=null&&j(t,["threshold"],o),t}function u5(){return{}}function d5(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function f5(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],d5(e,r)),t}function h5(){return{}}function p5(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&j(t,["apiKeyString"],r),t}function m5(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&j(t,["apiKeyConfig"],p5(e,r));const a=C(n,["authType"]);a!=null&&j(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&j(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&j(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&j(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&j(t,["oidcConfig"],f),t}function g5(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&j(t,["authConfig"],m5(e,r)),t}function uk(e,n){const t={},r=C(n,["retrieval"]);r!=null&&j(t,["retrieval"],r),C(n,["googleSearch"])!=null&&j(t,["googleSearch"],u5());const o=C(n,["googleSearchRetrieval"]);o!=null&&j(t,["googleSearchRetrieval"],f5(e,o)),C(n,["enterpriseWebSearch"])!=null&&j(t,["enterpriseWebSearch"],h5());const d=C(n,["googleMaps"]);d!=null&&j(t,["googleMaps"],g5(e,d));const f=C(n,["codeExecution"]);f!=null&&j(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&j(t,["functionDeclarations"],u),t}function y5(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function x5(e,n){const t={},r=C(n,["latitude"]);r!=null&&j(t,["latitude"],r);const a=C(n,["longitude"]);return a!=null&&j(t,["longitude"],a),t}function b5(e,n){const t={},r=C(n,["latLng"]);return r!=null&&j(t,["latLng"],x5(e,r)),t}function v5(e,n){const t={},r=C(n,["functionCallingConfig"]);r!=null&&j(t,["functionCallingConfig"],y5(e,r));const a=C(n,["retrievalConfig"]);return a!=null&&j(t,["retrievalConfig"],b5(e,a)),t}function w5(e,n){const t={},r=C(n,["voiceName"]);return r!=null&&j(t,["voiceName"],r),t}function S5(e,n){const t={},r=C(n,["prebuiltVoiceConfig"]);return r!=null&&j(t,["prebuiltVoiceConfig"],w5(e,r)),t}function N5(e,n){const t={},r=C(n,["voiceConfig"]);r!=null&&j(t,["voiceConfig"],S5(e,r));const a=C(n,["languageCode"]);return a!=null&&j(t,["languageCode"],a),t}function C5(e,n){const t={},r=C(n,["includeThoughts"]);r!=null&&j(t,["includeThoughts"],r);const a=C(n,["thinkingBudget"]);return a!=null&&j(t,["thinkingBudget"],a),t}function j5(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&j(t,["systemInstruction"],Bh(e,ca(e,a)));const o=C(n,["temperature"]);o!=null&&j(r,["temperature"],o);const l=C(n,["topP"]);l!=null&&j(r,["topP"],l);const d=C(n,["topK"]);d!=null&&j(r,["topK"],d);const f=C(n,["candidateCount"]);f!=null&&j(r,["candidateCount"],f);const u=C(n,["maxOutputTokens"]);u!=null&&j(r,["maxOutputTokens"],u);const p=C(n,["stopSequences"]);p!=null&&j(r,["stopSequences"],p);const g=C(n,["responseLogprobs"]);g!=null&&j(r,["responseLogprobs"],g);const b=C(n,["logprobs"]);b!=null&&j(r,["logprobs"],b);const v=C(n,["presencePenalty"]);v!=null&&j(r,["presencePenalty"],v);const S=C(n,["frequencyPenalty"]);S!=null&&j(r,["frequencyPenalty"],S);const k=C(n,["seed"]);k!=null&&j(r,["seed"],k);const T=C(n,["responseMimeType"]);T!=null&&j(r,["responseMimeType"],T);const P=C(n,["responseSchema"]);P!=null&&j(r,["responseSchema"],rk(e,P));const M=C(n,["routingConfig"]);M!=null&&j(r,["routingConfig"],M);const I=C(n,["modelSelectionConfig"]);I!=null&&j(r,["modelConfig"],l5(e,I));const U=C(n,["safetySettings"]);if(t!==void 0&&U!=null){let te=U;Array.isArray(te)&&(te=te.map(W=>c5(e,W))),j(t,["safetySettings"],te)}const L=C(n,["tools"]);if(t!==void 0&&L!=null){let te=Tb(e,L);Array.isArray(te)&&(te=te.map(W=>uk(e,kb(e,W)))),j(t,["tools"],te)}const $=C(n,["toolConfig"]);t!==void 0&&$!=null&&j(t,["toolConfig"],v5(e,$));const z=C(n,["labels"]);t!==void 0&&z!=null&&j(t,["labels"],z);const F=C(n,["cachedContent"]);t!==void 0&&F!=null&&j(t,["cachedContent"],hu(e,F));const Y=C(n,["responseModalities"]);Y!=null&&j(r,["responseModalities"],Y);const R=C(n,["mediaResolution"]);R!=null&&j(r,["mediaResolution"],R);const B=C(n,["speechConfig"]);B!=null&&j(r,["speechConfig"],N5(e,ik(e,B)));const G=C(n,["audioTimestamp"]);G!=null&&j(r,["audioTimestamp"],G);const ie=C(n,["thinkingConfig"]);return ie!=null&&j(r,["thinkingConfig"],C5(e,ie)),r}function hC(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],pr(e,r));const a=C(n,["contents"]);if(a!=null){let l=fu(e,a);Array.isArray(l)&&(l=l.map(d=>Bh(e,d))),j(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&j(t,["generationConfig"],j5(e,o,t)),t}function _5(e,n,t){const r={},a=C(n,["taskType"]);t!==void 0&&a!=null&&j(t,["instances[]","task_type"],a);const o=C(n,["title"]);t!==void 0&&o!=null&&j(t,["instances[]","title"],o);const l=C(n,["outputDimensionality"]);t!==void 0&&l!=null&&j(t,["parameters","outputDimensionality"],l);const d=C(n,["mimeType"]);t!==void 0&&d!=null&&j(t,["instances[]","mimeType"],d);const f=C(n,["autoTruncate"]);return t!==void 0&&f!=null&&j(t,["parameters","autoTruncate"],f),r}function k5(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],pr(e,r));const a=C(n,["contents"]);a!=null&&j(t,["instances[]","content"],nk(e,a));const o=C(n,["config"]);return o!=null&&j(t,["config"],_5(e,o,t)),t}function T5(e,n,t){const r={},a=C(n,["outputGcsUri"]);t!==void 0&&a!=null&&j(t,["parameters","storageUri"],a);const o=C(n,["negativePrompt"]);t!==void 0&&o!=null&&j(t,["parameters","negativePrompt"],o);const l=C(n,["numberOfImages"]);t!==void 0&&l!=null&&j(t,["parameters","sampleCount"],l);const d=C(n,["aspectRatio"]);t!==void 0&&d!=null&&j(t,["parameters","aspectRatio"],d);const f=C(n,["guidanceScale"]);t!==void 0&&f!=null&&j(t,["parameters","guidanceScale"],f);const u=C(n,["seed"]);t!==void 0&&u!=null&&j(t,["parameters","seed"],u);const p=C(n,["safetyFilterLevel"]);t!==void 0&&p!=null&&j(t,["parameters","safetySetting"],p);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&j(t,["parameters","personGeneration"],g);const b=C(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&j(t,["parameters","includeSafetyAttributes"],b);const v=C(n,["includeRaiReason"]);t!==void 0&&v!=null&&j(t,["parameters","includeRaiReason"],v);const S=C(n,["language"]);t!==void 0&&S!=null&&j(t,["parameters","language"],S);const k=C(n,["outputMimeType"]);t!==void 0&&k!=null&&j(t,["parameters","outputOptions","mimeType"],k);const T=C(n,["outputCompressionQuality"]);t!==void 0&&T!=null&&j(t,["parameters","outputOptions","compressionQuality"],T);const P=C(n,["addWatermark"]);t!==void 0&&P!=null&&j(t,["parameters","addWatermark"],P);const M=C(n,["enhancePrompt"]);return t!==void 0&&M!=null&&j(t,["parameters","enhancePrompt"],M),r}function E5(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],pr(e,r));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const o=C(n,["config"]);return o!=null&&j(t,["config"],T5(e,o,t)),t}function bw(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&j(t,["gcsUri"],r);const a=C(n,["imageBytes"]);a!=null&&j(t,["bytesBase64Encoded"],pu(e,a));const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function A5(e,n){const t={},r=C(n,["maskMode"]);r!=null&&j(t,["maskMode"],r);const a=C(n,["segmentationClasses"]);a!=null&&j(t,["maskClasses"],a);const o=C(n,["maskDilation"]);return o!=null&&j(t,["dilation"],o),t}function P5(e,n){const t={},r=C(n,["controlType"]);r!=null&&j(t,["controlType"],r);const a=C(n,["enableControlImageComputation"]);return a!=null&&j(t,["computeControl"],a),t}function D5(e,n){const t={},r=C(n,["styleDescription"]);return r!=null&&j(t,["styleDescription"],r),t}function I5(e,n){const t={},r=C(n,["subjectType"]);r!=null&&j(t,["subjectType"],r);const a=C(n,["subjectDescription"]);return a!=null&&j(t,["subjectDescription"],a),t}function R5(e,n){const t={},r=C(n,["referenceImage"]);r!=null&&j(t,["referenceImage"],bw(e,r));const a=C(n,["referenceId"]);a!=null&&j(t,["referenceId"],a);const o=C(n,["referenceType"]);o!=null&&j(t,["referenceType"],o);const l=C(n,["maskImageConfig"]);l!=null&&j(t,["maskImageConfig"],A5(e,l));const d=C(n,["controlImageConfig"]);d!=null&&j(t,["controlImageConfig"],P5(e,d));const f=C(n,["styleImageConfig"]);f!=null&&j(t,["styleImageConfig"],D5(e,f));const u=C(n,["subjectImageConfig"]);return u!=null&&j(t,["subjectImageConfig"],I5(e,u)),t}function M5(e,n,t){const r={},a=C(n,["outputGcsUri"]);t!==void 0&&a!=null&&j(t,["parameters","storageUri"],a);const o=C(n,["negativePrompt"]);t!==void 0&&o!=null&&j(t,["parameters","negativePrompt"],o);const l=C(n,["numberOfImages"]);t!==void 0&&l!=null&&j(t,["parameters","sampleCount"],l);const d=C(n,["aspectRatio"]);t!==void 0&&d!=null&&j(t,["parameters","aspectRatio"],d);const f=C(n,["guidanceScale"]);t!==void 0&&f!=null&&j(t,["parameters","guidanceScale"],f);const u=C(n,["seed"]);t!==void 0&&u!=null&&j(t,["parameters","seed"],u);const p=C(n,["safetyFilterLevel"]);t!==void 0&&p!=null&&j(t,["parameters","safetySetting"],p);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&j(t,["parameters","personGeneration"],g);const b=C(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&j(t,["parameters","includeSafetyAttributes"],b);const v=C(n,["includeRaiReason"]);t!==void 0&&v!=null&&j(t,["parameters","includeRaiReason"],v);const S=C(n,["language"]);t!==void 0&&S!=null&&j(t,["parameters","language"],S);const k=C(n,["outputMimeType"]);t!==void 0&&k!=null&&j(t,["parameters","outputOptions","mimeType"],k);const T=C(n,["outputCompressionQuality"]);t!==void 0&&T!=null&&j(t,["parameters","outputOptions","compressionQuality"],T);const P=C(n,["editMode"]);t!==void 0&&P!=null&&j(t,["parameters","editMode"],P);const M=C(n,["baseSteps"]);return t!==void 0&&M!=null&&j(t,["parameters","editConfig","baseSteps"],M),r}function O5(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],pr(e,r));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const o=C(n,["referenceImages"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>R5(e,f))),j(t,["instances[0]","referenceImages"],d)}const l=C(n,["config"]);return l!=null&&j(t,["config"],M5(e,l,t)),t}function L5(e,n,t){const r={},a=C(n,["includeRaiReason"]);t!==void 0&&a!=null&&j(t,["parameters","includeRaiReason"],a);const o=C(n,["outputMimeType"]);t!==void 0&&o!=null&&j(t,["parameters","outputOptions","mimeType"],o);const l=C(n,["outputCompressionQuality"]);t!==void 0&&l!=null&&j(t,["parameters","outputOptions","compressionQuality"],l);const d=C(n,["numberOfImages"]);t!==void 0&&d!=null&&j(t,["parameters","sampleCount"],d);const f=C(n,["mode"]);return t!==void 0&&f!=null&&j(t,["parameters","mode"],f),r}function F5(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],pr(e,r));const a=C(n,["image"]);a!=null&&j(t,["instances[0]","image"],bw(e,a));const o=C(n,["upscaleFactor"]);o!=null&&j(t,["parameters","upscaleConfig","upscaleFactor"],o);const l=C(n,["config"]);return l!=null&&j(t,["config"],L5(e,l,t)),t}function $5(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","name"],pr(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function z5(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&j(t,["_query","pageToken"],o);const l=C(n,["filter"]);t!==void 0&&l!=null&&j(t,["_query","filter"],l);const d=C(n,["queryBase"]);return t!==void 0&&d!=null&&j(t,["_url","models_url"],ok(e,d)),r}function U5(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],z5(e,r,t)),t}function B5(e,n,t){const r={},a=C(n,["displayName"]);t!==void 0&&a!=null&&j(t,["displayName"],a);const o=C(n,["description"]);t!==void 0&&o!=null&&j(t,["description"],o);const l=C(n,["defaultCheckpointId"]);return t!==void 0&&l!=null&&j(t,["defaultCheckpointId"],l),r}function q5(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],pr(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],B5(e,a,t)),t}function V5(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","name"],pr(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function H5(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&j(t,["systemInstruction"],Bh(e,ca(e,a)));const o=C(n,["tools"]);if(t!==void 0&&o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>uk(e,f))),j(t,["tools"],d)}const l=C(n,["generationConfig"]);return t!==void 0&&l!=null&&j(t,["generationConfig"],l),r}function G5(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],pr(e,r));const a=C(n,["contents"]);if(a!=null){let l=fu(e,a);Array.isArray(l)&&(l=l.map(d=>Bh(e,d))),j(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&j(t,["config"],H5(e,o,t)),t}function Y5(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],pr(e,r));const a=C(n,["contents"]);if(a!=null){let l=fu(e,a);Array.isArray(l)&&(l=l.map(d=>Bh(e,d))),j(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&j(t,["config"],o),t}function W5(e,n,t){const r={},a=C(n,["numberOfVideos"]);t!==void 0&&a!=null&&j(t,["parameters","sampleCount"],a);const o=C(n,["outputGcsUri"]);t!==void 0&&o!=null&&j(t,["parameters","storageUri"],o);const l=C(n,["fps"]);t!==void 0&&l!=null&&j(t,["parameters","fps"],l);const d=C(n,["durationSeconds"]);t!==void 0&&d!=null&&j(t,["parameters","durationSeconds"],d);const f=C(n,["seed"]);t!==void 0&&f!=null&&j(t,["parameters","seed"],f);const u=C(n,["aspectRatio"]);t!==void 0&&u!=null&&j(t,["parameters","aspectRatio"],u);const p=C(n,["resolution"]);t!==void 0&&p!=null&&j(t,["parameters","resolution"],p);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&j(t,["parameters","personGeneration"],g);const b=C(n,["pubsubTopic"]);t!==void 0&&b!=null&&j(t,["parameters","pubsubTopic"],b);const v=C(n,["negativePrompt"]);t!==void 0&&v!=null&&j(t,["parameters","negativePrompt"],v);const S=C(n,["enhancePrompt"]);return t!==void 0&&S!=null&&j(t,["parameters","enhancePrompt"],S),r}function Q5(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],pr(e,r));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const o=C(n,["image"]);o!=null&&j(t,["instances[0]","image"],bw(e,o));const l=C(n,["config"]);return l!=null&&j(t,["config"],W5(e,l,t)),t}function J5(e,n){const t={},r=C(n,["data"]);r!=null&&j(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function K5(e,n){const t={},r=C(n,["thought"]);r!=null&&j(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],J5(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&j(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&j(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&j(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&j(t,["functionResponse"],u);const p=C(n,["text"]);return p!=null&&j(t,["text"],p),t}function X5(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>K5(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function Z5(e,n){const t={},r=C(n,["citationSources"]);return r!=null&&j(t,["citations"],r),t}function e$(e,n){const t={},r=C(n,["content"]);r!=null&&j(t,["content"],X5(e,r));const a=C(n,["citationMetadata"]);a!=null&&j(t,["citationMetadata"],Z5(e,a));const o=C(n,["tokenCount"]);o!=null&&j(t,["tokenCount"],o);const l=C(n,["finishReason"]);l!=null&&j(t,["finishReason"],l);const d=C(n,["avgLogprobs"]);d!=null&&j(t,["avgLogprobs"],d);const f=C(n,["groundingMetadata"]);f!=null&&j(t,["groundingMetadata"],f);const u=C(n,["index"]);u!=null&&j(t,["index"],u);const p=C(n,["logprobsResult"]);p!=null&&j(t,["logprobsResult"],p);const g=C(n,["safetyRatings"]);return g!=null&&j(t,["safetyRatings"],g),t}function pC(e,n){const t={},r=C(n,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(f=>e$(e,f))),j(t,["candidates"],d)}const a=C(n,["modelVersion"]);a!=null&&j(t,["modelVersion"],a);const o=C(n,["promptFeedback"]);o!=null&&j(t,["promptFeedback"],o);const l=C(n,["usageMetadata"]);return l!=null&&j(t,["usageMetadata"],l),t}function t$(e,n){const t={},r=C(n,["values"]);return r!=null&&j(t,["values"],r),t}function n$(){return{}}function r$(e,n){const t={},r=C(n,["embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>t$(e,l))),j(t,["embeddings"],o)}return C(n,["metadata"])!=null&&j(t,["metadata"],n$()),t}function i$(e,n){const t={},r=C(n,["bytesBase64Encoded"]);r!=null&&j(t,["imageBytes"],pu(e,r));const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function dk(e,n){const t={},r=C(n,["safetyAttributes","categories"]);r!=null&&j(t,["categories"],r);const a=C(n,["safetyAttributes","scores"]);a!=null&&j(t,["scores"],a);const o=C(n,["contentType"]);return o!=null&&j(t,["contentType"],o),t}function a$(e,n){const t={},r=C(n,["_self"]);r!=null&&j(t,["image"],i$(e,r));const a=C(n,["raiFilteredReason"]);a!=null&&j(t,["raiFilteredReason"],a);const o=C(n,["_self"]);return o!=null&&j(t,["safetyAttributes"],dk(e,o)),t}function s$(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>a$(e,l))),j(t,["generatedImages"],o)}const a=C(n,["positivePromptSafetyAttributes"]);return a!=null&&j(t,["positivePromptSafetyAttributes"],dk(e,a)),t}function o$(e,n){const t={},r=C(n,["baseModel"]);r!=null&&j(t,["baseModel"],r);const a=C(n,["createTime"]);a!=null&&j(t,["createTime"],a);const o=C(n,["updateTime"]);return o!=null&&j(t,["updateTime"],o),t}function f1(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const o=C(n,["description"]);o!=null&&j(t,["description"],o);const l=C(n,["version"]);l!=null&&j(t,["version"],l);const d=C(n,["_self"]);d!=null&&j(t,["tunedModelInfo"],o$(e,d));const f=C(n,["inputTokenLimit"]);f!=null&&j(t,["inputTokenLimit"],f);const u=C(n,["outputTokenLimit"]);u!=null&&j(t,["outputTokenLimit"],u);const p=C(n,["supportedGenerationMethods"]);return p!=null&&j(t,["supportedActions"],p),t}function l$(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["_self"]);if(a!=null){let o=lk(e,a);Array.isArray(o)&&(o=o.map(l=>f1(e,l))),j(t,["models"],o)}return t}function c$(){return{}}function u$(e,n){const t={},r=C(n,["totalTokens"]);r!=null&&j(t,["totalTokens"],r);const a=C(n,["cachedContentTokenCount"]);return a!=null&&j(t,["cachedContentTokenCount"],a),t}function d$(e,n){const t={},r=C(n,["video","uri"]);r!=null&&j(t,["uri"],r);const a=C(n,["video","encodedVideo"]);a!=null&&j(t,["videoBytes"],pu(e,a));const o=C(n,["encoding"]);return o!=null&&j(t,["mimeType"],o),t}function f$(e,n){const t={},r=C(n,["_self"]);return r!=null&&j(t,["video"],d$(e,r)),t}function h$(e,n){const t={},r=C(n,["generatedSamples"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(d=>f$(e,d))),j(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&j(t,["raiMediaFilteredReasons"],o),t}function p$(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const o=C(n,["done"]);o!=null&&j(t,["done"],o);const l=C(n,["error"]);l!=null&&j(t,["error"],l);const d=C(n,["response","generateVideoResponse"]);return d!=null&&j(t,["response"],h$(e,d)),t}function m$(e,n){const t={},r=C(n,["displayName"]);r!=null&&j(t,["displayName"],r);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function g$(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&j(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&j(t,["inlineData"],m$(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&j(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const p=C(n,["functionResponse"]);p!=null&&j(t,["functionResponse"],p);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function y$(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>g$(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function x$(e,n){const t={},r=C(n,["citations"]);return r!=null&&j(t,["citations"],r),t}function b$(e,n){const t={},r=C(n,["content"]);r!=null&&j(t,["content"],y$(e,r));const a=C(n,["citationMetadata"]);a!=null&&j(t,["citationMetadata"],x$(e,a));const o=C(n,["finishMessage"]);o!=null&&j(t,["finishMessage"],o);const l=C(n,["finishReason"]);l!=null&&j(t,["finishReason"],l);const d=C(n,["avgLogprobs"]);d!=null&&j(t,["avgLogprobs"],d);const f=C(n,["groundingMetadata"]);f!=null&&j(t,["groundingMetadata"],f);const u=C(n,["index"]);u!=null&&j(t,["index"],u);const p=C(n,["logprobsResult"]);p!=null&&j(t,["logprobsResult"],p);const g=C(n,["safetyRatings"]);return g!=null&&j(t,["safetyRatings"],g),t}function mC(e,n){const t={},r=C(n,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(p=>b$(e,p))),j(t,["candidates"],u)}const a=C(n,["createTime"]);a!=null&&j(t,["createTime"],a);const o=C(n,["responseId"]);o!=null&&j(t,["responseId"],o);const l=C(n,["modelVersion"]);l!=null&&j(t,["modelVersion"],l);const d=C(n,["promptFeedback"]);d!=null&&j(t,["promptFeedback"],d);const f=C(n,["usageMetadata"]);return f!=null&&j(t,["usageMetadata"],f),t}function v$(e,n){const t={},r=C(n,["truncated"]);r!=null&&j(t,["truncated"],r);const a=C(n,["token_count"]);return a!=null&&j(t,["tokenCount"],a),t}function w$(e,n){const t={},r=C(n,["values"]);r!=null&&j(t,["values"],r);const a=C(n,["statistics"]);return a!=null&&j(t,["statistics"],v$(e,a)),t}function S$(e,n){const t={},r=C(n,["billableCharacterCount"]);return r!=null&&j(t,["billableCharacterCount"],r),t}function N$(e,n){const t={},r=C(n,["predictions[]","embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>w$(e,l))),j(t,["embeddings"],o)}const a=C(n,["metadata"]);return a!=null&&j(t,["metadata"],S$(e,a)),t}function C$(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&j(t,["gcsUri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&j(t,["imageBytes"],pu(e,a));const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function fk(e,n){const t={},r=C(n,["safetyAttributes","categories"]);r!=null&&j(t,["categories"],r);const a=C(n,["safetyAttributes","scores"]);a!=null&&j(t,["scores"],a);const o=C(n,["contentType"]);return o!=null&&j(t,["contentType"],o),t}function vw(e,n){const t={},r=C(n,["_self"]);r!=null&&j(t,["image"],C$(e,r));const a=C(n,["raiFilteredReason"]);a!=null&&j(t,["raiFilteredReason"],a);const o=C(n,["_self"]);o!=null&&j(t,["safetyAttributes"],fk(e,o));const l=C(n,["prompt"]);return l!=null&&j(t,["enhancedPrompt"],l),t}function j$(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>vw(e,l))),j(t,["generatedImages"],o)}const a=C(n,["positivePromptSafetyAttributes"]);return a!=null&&j(t,["positivePromptSafetyAttributes"],fk(e,a)),t}function _$(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>vw(e,o))),j(t,["generatedImages"],a)}return t}function k$(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>vw(e,o))),j(t,["generatedImages"],a)}return t}function T$(e,n){const t={},r=C(n,["endpoint"]);r!=null&&j(t,["name"],r);const a=C(n,["deployedModelId"]);return a!=null&&j(t,["deployedModelId"],a),t}function E$(e,n){const t={},r=C(n,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&j(t,["baseModel"],r);const a=C(n,["createTime"]);a!=null&&j(t,["createTime"],a);const o=C(n,["updateTime"]);return o!=null&&j(t,["updateTime"],o),t}function A$(e,n){const t={},r=C(n,["checkpointId"]);r!=null&&j(t,["checkpointId"],r);const a=C(n,["epoch"]);a!=null&&j(t,["epoch"],a);const o=C(n,["step"]);return o!=null&&j(t,["step"],o),t}function h1(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const o=C(n,["description"]);o!=null&&j(t,["description"],o);const l=C(n,["versionId"]);l!=null&&j(t,["version"],l);const d=C(n,["deployedModels"]);if(d!=null){let b=d;Array.isArray(b)&&(b=b.map(v=>T$(e,v))),j(t,["endpoints"],b)}const f=C(n,["labels"]);f!=null&&j(t,["labels"],f);const u=C(n,["_self"]);u!=null&&j(t,["tunedModelInfo"],E$(e,u));const p=C(n,["defaultCheckpointId"]);p!=null&&j(t,["defaultCheckpointId"],p);const g=C(n,["checkpoints"]);if(g!=null){let b=g;Array.isArray(b)&&(b=b.map(v=>A$(e,v))),j(t,["checkpoints"],b)}return t}function P$(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["_self"]);if(a!=null){let o=lk(e,a);Array.isArray(o)&&(o=o.map(l=>h1(e,l))),j(t,["models"],o)}return t}function D$(){return{}}function I$(e,n){const t={},r=C(n,["totalTokens"]);return r!=null&&j(t,["totalTokens"],r),t}function R$(e,n){const t={},r=C(n,["tokensInfo"]);return r!=null&&j(t,["tokensInfo"],r),t}function M$(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&j(t,["uri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&j(t,["videoBytes"],pu(e,a));const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function O$(e,n){const t={},r=C(n,["_self"]);return r!=null&&j(t,["video"],M$(e,r)),t}function L$(e,n){const t={},r=C(n,["videos"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(d=>O$(e,d))),j(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&j(t,["raiMediaFilteredReasons"],o),t}function F$(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const o=C(n,["done"]);o!=null&&j(t,["done"],o);const l=C(n,["error"]);l!=null&&j(t,["error"],l);const d=C(n,["response"]);return d!=null&&j(t,["response"],L$(e,d)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $$="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function z$(e,n,t){const r=new i6;let a;if(t.data instanceof Blob?a=JSON.parse(await t.data.text()):a=JSON.parse(t.data),e.isVertexAI()){const o=AF(e,a);Object.assign(r,o)}else{const o=EF(e,a);Object.assign(r,o)}n(r)}class U${constructor(n,t,r){this.apiClient=n,this.auth=t,this.webSocketFactory=r}async connect(n){var t,r,a,o;const l=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let f;const u=H$(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())f=`${l}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(u);else{const U=this.apiClient.getApiKey();f=`${l}/ws/google.ai.generativelanguage.${d}.GenerativeService.BidiGenerateContent?key=${U}`}let p=()=>{};const g=new Promise(U=>{p=U}),b=n.callbacks,v=function(){var U;(U=b==null?void 0:b.onopen)===null||U===void 0||U.call(b),p({})},S=this.apiClient,k={onopen:v,onmessage:U=>{z$(S,b.onmessage,U)},onerror:(t=b==null?void 0:b.onerror)!==null&&t!==void 0?t:function(U){},onclose:(r=b==null?void 0:b.onclose)!==null&&r!==void 0?r:function(U){}},T=this.webSocketFactory.create(f,V$(u),k);T.connect(),await g;let P=pr(this.apiClient,n.model);if(this.apiClient.isVertexAI()&&P.startsWith("publishers/")){const U=this.apiClient.getProject(),L=this.apiClient.getLocation();P=`projects/${U}/locations/${L}/`+P}let M={};this.apiClient.isVertexAI()&&((a=n.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(n.config===void 0?n.config={responseModalities:[uu.AUDIO]}:n.config.responseModalities=[uu.AUDIO]),!((o=n.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const I={model:P,config:n.config,callbacks:n.callbacks};return this.apiClient.isVertexAI()?M=eF(this.apiClient,I):M=Z6(this.apiClient,I),delete M.config,T.send(JSON.stringify(M)),new q$(T,this.apiClient)}}const B$={turnComplete:!0};class q${constructor(n,t){this.conn=n,this.apiClient=t}tLiveClientContent(n,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=fu(n,t.turns),n.isVertexAI()?r=r.map(a=>Bh(n,a)):r=r.map(a=>Ab(n,a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(n,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const o of r){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!n.isVertexAI()&&!("id"in o))throw new Error($$)}return{toolResponse:{functionResponses:r}}}sendClientContent(n){n=Object.assign(Object.assign({},B$),n);const t=this.tLiveClientContent(this.apiClient,n);this.conn.send(JSON.stringify(t))}sendRealtimeInput(n){let t={};this.apiClient.isVertexAI()?t={realtimeInput:sF(this.apiClient,n)}:t={realtimeInput:aF(this.apiClient,n)},this.conn.send(JSON.stringify(t))}sendToolResponse(n){if(n.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,n);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function V$(e){const n={};return e.forEach((t,r)=>{n[r]=t}),n}function H$(e){const n=new Headers;for(const[t,r]of Object.entries(e))n.append(t,r);return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class G$ extends sg{constructor(n){super(),this.apiClient=n,this.generateContent=async t=>await this.generateContentInternal(t),this.generateContentStream=async t=>await this.generateContentStreamInternal(t),this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var a;let o;const l=[];if(r!=null&&r.generatedImages)for(const f of r.generatedImages)f&&(f!=null&&f.safetyAttributes)&&((a=f==null?void 0:f.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?o=f==null?void 0:f.safetyAttributes:l.push(f);let d;return o?d={generatedImages:l,positivePromptSafetyAttributes:o}:d={generatedImages:l},d}),this.list=async t=>{var r;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((r=l.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Eb(Dh.PAGED_ITEM_MODELS,d=>this.listInternal(d),await this.listInternal(l),l)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const a={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(a)}}async generateContentInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=hC(this.apiClient,n);return d=Ut("{model}:generateContent",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=mC(this.apiClient,p),b=new gx;return Object.assign(b,g),b})}else{const u=fC(this.apiClient,n);return d=Ut("{model}:generateContent",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=pC(this.apiClient,p),b=new gx;return Object.assign(b,g),b})}}async generateContentStreamInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=hC(this.apiClient,n);d=Ut("{model}:streamGenerateContent?alt=sse",u._url),f=u._query,delete u.config,delete u._url,delete u._query;const p=this.apiClient;return l=p.requestStream({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}),l.then(function(g){return sb(this,arguments,function*(){var b,v,S,k;try{for(var T=!0,P=u1(g),M;M=yield Ni(P.next()),b=M.done,!b;T=!0){k=M.value,T=!1;const U=mC(p,yield Ni(k.json())),L=new gx;Object.assign(L,U),yield yield Ni(L)}}catch(I){v={error:I}}finally{try{!T&&!b&&(S=P.return)&&(yield Ni(S.call(P)))}finally{if(v)throw v.error}}})})}else{const u=fC(this.apiClient,n);d=Ut("{model}:streamGenerateContent?alt=sse",u._url),f=u._query,delete u.config,delete u._url,delete u._query;const p=this.apiClient;return l=p.requestStream({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}),l.then(function(g){return sb(this,arguments,function*(){var b,v,S,k;try{for(var T=!0,P=u1(g),M;M=yield Ni(P.next()),b=M.done,!b;T=!0){k=M.value,T=!1;const U=pC(p,yield Ni(k.json())),L=new gx;Object.assign(L,U),yield yield Ni(L)}}catch(I){v={error:I}}finally{try{!T&&!b&&(S=P.return)&&(yield Ni(S.call(P)))}finally{if(v)throw v.error}}})})}}async embedContent(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=k5(this.apiClient,n);return d=Ut("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=N$(this.apiClient,p),b=new ZN;return Object.assign(b,g),b})}else{const u=GF(this.apiClient,n);return d=Ut("{model}:batchEmbedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=r$(this.apiClient,p),b=new ZN;return Object.assign(b,g),b})}}async generateImagesInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=E5(this.apiClient,n);return d=Ut("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=j$(this.apiClient,p),b=new eC;return Object.assign(b,g),b})}else{const u=WF(this.apiClient,n);return d=Ut("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=s$(this.apiClient,p),b=new eC;return Object.assign(b,g),b})}}async editImageInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=O5(this.apiClient,n);return o=Ut("{model}:predict",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const u=_$(this.apiClient,f),p=new X3;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=F5(this.apiClient,n);return o=Ut("{model}:predict",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const u=k$(this.apiClient,f),p=new Z3;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async get(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=$5(this.apiClient,n);return d=Ut("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>h1(this.apiClient,p))}else{const u=QF(this.apiClient,n);return d=Ut("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>f1(this.apiClient,p))}}async listInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=U5(this.apiClient,n);return d=Ut("{models_url}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=P$(this.apiClient,p),b=new tC;return Object.assign(b,g),b})}else{const u=KF(this.apiClient,n);return d=Ut("{models_url}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=l$(this.apiClient,p),b=new tC;return Object.assign(b,g),b})}}async update(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=q5(this.apiClient,n);return d=Ut("{model}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>h1(this.apiClient,p))}else{const u=ZF(this.apiClient,n);return d=Ut("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>f1(this.apiClient,p))}}async delete(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=V5(this.apiClient,n);return d=Ut("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(()=>{const p=D$(),g=new nC;return Object.assign(g,p),g})}else{const u=e5(this.apiClient,n);return d=Ut("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(()=>{const p=c$(),g=new nC;return Object.assign(g,p),g})}}async countTokens(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=G5(this.apiClient,n);return d=Ut("{model}:countTokens",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=I$(this.apiClient,p),b=new rC;return Object.assign(b,g),b})}else{const u=n5(this.apiClient,n);return d=Ut("{model}:countTokens",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=u$(this.apiClient,p),b=new rC;return Object.assign(b,g),b})}}async computeTokens(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=Y5(this.apiClient,n);return o=Ut("{model}:computeTokens",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const u=R$(this.apiClient,f),p=new e6;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=Q5(this.apiClient,n);return d=Ut("{model}:predictLongRunning",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>F$(this.apiClient,p))}else{const u=a5(this.apiClient,n);return d=Ut("{model}:predictLongRunning",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>p$(this.apiClient,p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Y$(e,n){const t={},r=C(n,["operationName"]);r!=null&&j(t,["_url","operationName"],r);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function W$(e,n){const t={},r=C(n,["operationName"]);r!=null&&j(t,["_url","operationName"],r);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function Q$(e,n){const t={},r=C(n,["operationName"]);r!=null&&j(t,["operationName"],r);const a=C(n,["resourceName"]);a!=null&&j(t,["_url","resourceName"],a);const o=C(n,["config"]);return o!=null&&j(t,["config"],o),t}function J$(e,n){const t={},r=C(n,["video","uri"]);r!=null&&j(t,["uri"],r);const a=C(n,["video","encodedVideo"]);a!=null&&j(t,["videoBytes"],pu(e,a));const o=C(n,["encoding"]);return o!=null&&j(t,["mimeType"],o),t}function K$(e,n){const t={},r=C(n,["_self"]);return r!=null&&j(t,["video"],J$(e,r)),t}function X$(e,n){const t={},r=C(n,["generatedSamples"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(d=>K$(e,d))),j(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&j(t,["raiMediaFilteredReasons"],o),t}function Z$(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const o=C(n,["done"]);o!=null&&j(t,["done"],o);const l=C(n,["error"]);l!=null&&j(t,["error"],l);const d=C(n,["response","generateVideoResponse"]);return d!=null&&j(t,["response"],X$(e,d)),t}function ez(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&j(t,["uri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&j(t,["videoBytes"],pu(e,a));const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function tz(e,n){const t={},r=C(n,["_self"]);return r!=null&&j(t,["video"],ez(e,r)),t}function nz(e,n){const t={},r=C(n,["videos"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(d=>tz(e,d))),j(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&j(t,["raiMediaFilteredReasons"],o),t}function gC(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const o=C(n,["done"]);o!=null&&j(t,["done"],o);const l=C(n,["error"]);l!=null&&j(t,["error"],l);const d=C(n,["response"]);return d!=null&&j(t,["response"],nz(e,d)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rz extends sg{constructor(n){super(),this.apiClient=n}async getVideosOperation(n){const t=n.operation,r=n.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=t.name.split("/operations/")[0];let o;return r&&"httpOptions"in r&&(o=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:a,config:{httpOptions:o}})}else return this.getVideosOperationInternal({operationName:t.name,config:r})}async getVideosOperationInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=W$(this.apiClient,n);return d=Ut("{operationName}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>gC(this.apiClient,p))}else{const u=Y$(this.apiClient,n);return d=Ut("{operationName}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>Z$(this.apiClient,p))}}async fetchPredictVideosOperationInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=Q$(this.apiClient,n);return o=Ut("{resourceName}:fetchPredictOperation",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>gC(this.apiClient,f))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const iz="Content-Type",az="X-Server-Timeout",sz="User-Agent",oz="x-goog-api-client",lz="0.14.1",cz=`google-genai-sdk/${lz}`,uz="v1beta1",dz="v1beta",yC=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class hk extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ClientError"}}class p1 extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ServerError"}}class fz{constructor(n){var t,r;this.clientOptions=Object.assign(Object.assign({},n),{project:n.project,location:n.location,apiKey:n.apiKey,vertexai:n.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:uz,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:dz,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,n.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,n.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var n;return(n=this.clientOptions.vertexai)!==null&&n!==void 0?n:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(n){if(!n||n.baseUrl===void 0||n.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[n.baseUrl.endsWith("/")?n.baseUrl.slice(0,-1):n.baseUrl];return n.apiVersion&&n.apiVersion!==""&&r.push(n.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const n=this.getBaseUrl(),t=new URL(n);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(n){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=n;else throw new Error("HTTP options are not correctly set.")}constructUrl(n,t,r){const a=[this.getRequestUrlInternal(t)];return r&&a.push(this.getBaseResourcePath()),n!==""&&a.push(n),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(n){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||n.path.startsWith("projects/")||n.httpMethod==="GET"&&n.path.startsWith("publishers/google/models"))}async request(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);if(n.queryParams)for(const[l,d]of Object.entries(n.queryParams))a.searchParams.append(l,String(d));let o={};if(n.httpMethod==="GET"){if(n.body&&n.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=n.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,n.abortSignal),this.unaryApiCall(a,o,n.httpMethod)}patchHttpOptions(n,t){const r=JSON.parse(JSON.stringify(n));for(const[a,o]of Object.entries(t))typeof o=="object"?r[a]=Object.assign(Object.assign({},r[a]),o):o!==void 0&&(r[a]=o);return r}async requestStream(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let o={};return o.body=n.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,n.abortSignal),this.streamApiCall(a,o,n.httpMethod)}async includeExtraHttpOptionsToRequestInit(n,t,r){if(t&&t.timeout||r){const a=new AbortController,o=a.signal;t.timeout&&(t==null?void 0:t.timeout)>0&&setTimeout(()=>a.abort(),t.timeout),r&&r.addEventListener("abort",()=>{a.abort()}),n.signal=o}return n.headers=await this.getHeadersInternal(t),n}async unaryApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await xC(a),new c1(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await xC(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(n){var t;return sb(this,arguments,function*(){const a=(t=n==null?void 0:n.body)===null||t===void 0?void 0:t.getReader(),o=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let l="";for(;;){const{done:d,value:f}=yield Ni(a.read());if(d){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=o.decode(f);try{const g=JSON.parse(u);if("error"in g){const b=JSON.parse(JSON.stringify(g.error)),v=b.status,S=b.code,k=`got status: ${v}. ${JSON.stringify(g)}`;if(S>=400&&S<500)throw new hk(k);if(S>=500&&S<600)throw new p1(k)}}catch(g){const b=g;if(b.name==="ClientError"||b.name==="ServerError")throw g}l+=u;let p=l.match(yC);for(;p;){const g=p[1];try{const b=new Response(g,{headers:n==null?void 0:n.headers,status:n==null?void 0:n.status,statusText:n==null?void 0:n.statusText});yield yield Ni(new c1(b)),l=l.slice(p[0].length),p=l.match(yC)}catch(b){throw new Error(`exception parsing stream chunk ${g}. ${b}`)}}}}finally{a.releaseLock()}})}async apiCall(n,t){return fetch(n,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const n={},t=cz+" "+this.clientOptions.userAgentExtra;return n[sz]=t,n[oz]=t,n[iz]="application/json",n}async getHeadersInternal(n){const t=new Headers;if(n&&n.headers){for(const[r,a]of Object.entries(n.headers))t.append(r,a);n.timeout&&n.timeout>0&&t.append(az,String(Math.ceil(n.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(n,t){var r;const a={};t!=null&&(a.mimeType=t.mimeType,a.name=t.name,a.displayName=t.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const o=this.clientOptions.uploader,l=await o.stat(n);a.sizeBytes=String(l.size);const d=(r=t==null?void 0:t.mimeType)!==null&&r!==void 0?r:l.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=d;const f=await this.fetchUploadUrl(a,t);return o.upload(n,f,this)}async downloadFile(n){await this.clientOptions.downloader.download(n,this)}async fetchUploadUrl(n,t){var r;let a={};t!=null&&t.httpOptions?a=t.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${n.mimeType}`}};const o={file:n},l=await this.request({path:Ut("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:a});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(r=l==null?void 0:l.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function xC(e){var n;if(e===void 0)throw new p1("response is undefined");if(!e.ok){const t=e.status,r=e.statusText;let a;!((n=e.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?a=await e.json():a={error:{message:await e.text(),code:e.status,status:e.statusText}};const o=`got status: ${t} ${r}. ${JSON.stringify(a)}`;throw t>=400&&t<500?new hk(o):t>=500&&t<600?new p1(o):new Error(o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hz(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],r);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function pz(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&j(t,["_query","pageToken"],o);const l=C(n,["filter"]);return t!==void 0&&l!=null&&j(t,["_query","filter"],l),r}function mz(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],pz(e,r,t)),t}function gz(e,n){const t={},r=C(n,["textInput"]);r!=null&&j(t,["textInput"],r);const a=C(n,["output"]);return a!=null&&j(t,["output"],a),t}function yz(e,n){const t={};if(C(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=C(n,["examples"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>gz(e,o))),j(t,["examples","examples"],a)}return t}function xz(e,n,t){const r={};if(C(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const a=C(n,["tunedModelDisplayName"]);if(t!==void 0&&a!=null&&j(t,["displayName"],a),C(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=C(n,["epochCount"]);t!==void 0&&o!=null&&j(t,["tuningTask","hyperparameters","epochCount"],o);const l=C(n,["learningRateMultiplier"]);if(l!=null&&j(r,["tuningTask","hyperparameters","learningRateMultiplier"],l),C(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(C(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const d=C(n,["batchSize"]);t!==void 0&&d!=null&&j(t,["tuningTask","hyperparameters","batchSize"],d);const f=C(n,["learningRate"]);return t!==void 0&&f!=null&&j(t,["tuningTask","hyperparameters","learningRate"],f),r}function bz(e,n){const t={},r=C(n,["baseModel"]);r!=null&&j(t,["baseModel"],r);const a=C(n,["trainingDataset"]);a!=null&&j(t,["tuningTask","trainingData"],yz(e,a));const o=C(n,["config"]);return o!=null&&j(t,["config"],xz(e,o,t)),t}function vz(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],r);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function wz(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&j(t,["_query","pageToken"],o);const l=C(n,["filter"]);return t!==void 0&&l!=null&&j(t,["_query","filter"],l),r}function Sz(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],wz(e,r,t)),t}function Nz(e,n,t){const r={},a=C(n,["gcsUri"]);if(t!==void 0&&a!=null&&j(t,["supervisedTuningSpec","trainingDatasetUri"],a),C(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function Cz(e,n){const t={},r=C(n,["gcsUri"]);return r!=null&&j(t,["validationDatasetUri"],r),t}function jz(e,n,t){const r={},a=C(n,["validationDataset"]);t!==void 0&&a!=null&&j(t,["supervisedTuningSpec"],Cz(e,a));const o=C(n,["tunedModelDisplayName"]);t!==void 0&&o!=null&&j(t,["tunedModelDisplayName"],o);const l=C(n,["description"]);t!==void 0&&l!=null&&j(t,["description"],l);const d=C(n,["epochCount"]);t!==void 0&&d!=null&&j(t,["supervisedTuningSpec","hyperParameters","epochCount"],d);const f=C(n,["learningRateMultiplier"]);t!==void 0&&f!=null&&j(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],f);const u=C(n,["exportLastCheckpointOnly"]);t!==void 0&&u!=null&&j(t,["supervisedTuningSpec","exportLastCheckpointOnly"],u);const p=C(n,["adapterSize"]);if(t!==void 0&&p!=null&&j(t,["supervisedTuningSpec","hyperParameters","adapterSize"],p),C(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(C(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function _z(e,n){const t={},r=C(n,["baseModel"]);r!=null&&j(t,["baseModel"],r);const a=C(n,["trainingDataset"]);a!=null&&j(t,["supervisedTuningSpec","trainingDatasetUri"],Nz(e,a,t));const o=C(n,["config"]);return o!=null&&j(t,["config"],jz(e,o,t)),t}function kz(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["model"],r);const a=C(n,["name"]);return a!=null&&j(t,["endpoint"],a),t}function pk(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["state"]);a!=null&&j(t,["state"],ak(e,a));const o=C(n,["createTime"]);o!=null&&j(t,["createTime"],o);const l=C(n,["tuningTask","startTime"]);l!=null&&j(t,["startTime"],l);const d=C(n,["tuningTask","completeTime"]);d!=null&&j(t,["endTime"],d);const f=C(n,["updateTime"]);f!=null&&j(t,["updateTime"],f);const u=C(n,["description"]);u!=null&&j(t,["description"],u);const p=C(n,["baseModel"]);p!=null&&j(t,["baseModel"],p);const g=C(n,["_self"]);g!=null&&j(t,["tunedModel"],kz(e,g));const b=C(n,["distillationSpec"]);b!=null&&j(t,["distillationSpec"],b);const v=C(n,["experiment"]);v!=null&&j(t,["experiment"],v);const S=C(n,["labels"]);S!=null&&j(t,["labels"],S);const k=C(n,["pipelineJob"]);k!=null&&j(t,["pipelineJob"],k);const T=C(n,["tunedModelDisplayName"]);return T!=null&&j(t,["tunedModelDisplayName"],T),t}function Tz(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["tunedModels"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>pk(e,l))),j(t,["tuningJobs"],o)}return t}function Ez(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const o=C(n,["done"]);o!=null&&j(t,["done"],o);const l=C(n,["error"]);return l!=null&&j(t,["error"],l),t}function Az(e,n){const t={},r=C(n,["checkpointId"]);r!=null&&j(t,["checkpointId"],r);const a=C(n,["epoch"]);a!=null&&j(t,["epoch"],a);const o=C(n,["step"]);o!=null&&j(t,["step"],o);const l=C(n,["endpoint"]);return l!=null&&j(t,["endpoint"],l),t}function Pz(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["model"],r);const a=C(n,["endpoint"]);a!=null&&j(t,["endpoint"],a);const o=C(n,["checkpoints"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(d=>Az(e,d))),j(t,["checkpoints"],l)}return t}function m1(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["state"]);a!=null&&j(t,["state"],ak(e,a));const o=C(n,["createTime"]);o!=null&&j(t,["createTime"],o);const l=C(n,["startTime"]);l!=null&&j(t,["startTime"],l);const d=C(n,["endTime"]);d!=null&&j(t,["endTime"],d);const f=C(n,["updateTime"]);f!=null&&j(t,["updateTime"],f);const u=C(n,["error"]);u!=null&&j(t,["error"],u);const p=C(n,["description"]);p!=null&&j(t,["description"],p);const g=C(n,["baseModel"]);g!=null&&j(t,["baseModel"],g);const b=C(n,["tunedModel"]);b!=null&&j(t,["tunedModel"],Pz(e,b));const v=C(n,["supervisedTuningSpec"]);v!=null&&j(t,["supervisedTuningSpec"],v);const S=C(n,["tuningDataStats"]);S!=null&&j(t,["tuningDataStats"],S);const k=C(n,["encryptionSpec"]);k!=null&&j(t,["encryptionSpec"],k);const T=C(n,["partnerModelTuningSpec"]);T!=null&&j(t,["partnerModelTuningSpec"],T);const P=C(n,["distillationSpec"]);P!=null&&j(t,["distillationSpec"],P);const M=C(n,["experiment"]);M!=null&&j(t,["experiment"],M);const I=C(n,["labels"]);I!=null&&j(t,["labels"],I);const U=C(n,["pipelineJob"]);U!=null&&j(t,["pipelineJob"],U);const L=C(n,["tunedModelDisplayName"]);return L!=null&&j(t,["tunedModelDisplayName"],L),t}function Dz(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["tuningJobs"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>m1(e,l))),j(t,["tuningJobs"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Iz extends sg{constructor(n){super(),this.apiClient=n,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Eb(Dh.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const r=await this.tuneMldevInternal(t);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:l1.JOB_STATE_QUEUED}}}}async getInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=vz(this.apiClient,n);return d=Ut("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>m1(this.apiClient,p))}else{const u=hz(this.apiClient,n);return d=Ut("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>pk(this.apiClient,p))}}async listInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=Sz(this.apiClient,n);return d=Ut("tuningJobs",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=Dz(this.apiClient,p),b=new iC;return Object.assign(b,g),b})}else{const u=mz(this.apiClient,n);return d=Ut("tunedModels",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=Tz(this.apiClient,p),b=new iC;return Object.assign(b,g),b})}}async tuneInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=_z(this.apiClient,n);return o=Ut("tuningJobs",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>m1(this.apiClient,f))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=bz(this.apiClient,n);return o=Ut("tunedModels",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>Ez(this.apiClient,f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Rz{async download(n,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Mz=1024*1024*8,Oz=3,Lz=1e3,Fz=2,r0="x-goog-upload-status";async function $z(e,n,t){var r,a,o;let l=0,d=0,f=new c1(new Response),u="upload";for(l=e.size;d<l;){const g=Math.min(Mz,l-d),b=e.slice(d,d+g);d+g>=l&&(u+=", finalize");let v=0,S=Lz;for(;v<Oz&&(f=await t.request({path:"",body:b,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:n,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(d),"Content-Length":String(g)}}}),!(!((r=f==null?void 0:f.headers)===null||r===void 0)&&r[r0]));)v++,await Uz(S),S=S*Fz;if(d+=g,((a=f==null?void 0:f.headers)===null||a===void 0?void 0:a[r0])!=="active")break;if(l<=d)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const p=await(f==null?void 0:f.json());if(((o=f==null?void 0:f.headers)===null||o===void 0?void 0:o[r0])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return p.file}async function zz(e){return{size:e.size,type:e.type}}function Uz(e){return new Promise(n=>setTimeout(n,e))}class Bz{async upload(n,t,r){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await $z(n,t,r)}async stat(n){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await zz(n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qz{create(n,t,r){return new Vz(n,t,r)}}class Vz{constructor(n,t,r){this.url=n,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(n){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(n)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const bC="x-goog-api-key";class Hz{constructor(n){this.apiKey=n}async addAuthHeaders(n){n.get(bC)===null&&n.append(bC,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Gz="gl-node/";class mk{constructor(n){var t;if(n.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(n.project||n.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=n.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=n.apiKey;const r=n3(n,void 0,void 0);r&&(n.httpOptions?n.httpOptions.baseUrl=r:n.httpOptions={baseUrl:r}),this.apiVersion=n.apiVersion;const a=new Hz(this.apiKey);this.apiClient=new fz({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:n.httpOptions,userAgentExtra:Gz+"web",uploader:new Bz,downloader:new Rz}),this.models=new G$(this.apiClient),this.live=new U$(this.apiClient,a,new qz),this.chats=new c6(this.models,this.apiClient),this.caches=new a6(this.apiClient),this.files=new S6(this.apiClient),this.operations=new rz(this.apiClient),this.tunings=new Iz(this.apiClient)}}const fh=new Map,gk=(()=>{const e=new Promise(n=>{window.addEventListener("pointerdown",n,{once:!0}),window.addEventListener("keydown",n,{once:!0})});return async n=>{try{const t=new Audio;if(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",await t.play(),n!=null&&n.id&&fh.has(n.id)){const a=fh.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&fh.set(n.id,r),r}catch{if(await e,n!=null&&n.id&&fh.has(n.id)){const a=fh.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&fh.set(n.id,r),r}}})();function Yz(e){var n=atob(e),t=new Uint8Array(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t.buffer}const Wz=`
class AudioProcessingWorklet extends AudioWorkletProcessor {

  // send and clear buffer every 2048 samples, 
  // which at 16khz is about 8 times a second
  buffer = new Int16Array(2048);

  // current write index
  bufferWriteIndex = 0;

  constructor() {
    super();
    this.hasAudio = false;
  }

  /**
   * @param inputs Float32Array[][] [input#][channel#][sample#] so to access first inputs 1st channel inputs[0][0]
   * @param outputs Float32Array[][]
   */
  process(inputs) {
    if (inputs[0].length) {
      const channel0 = inputs[0][0];
      this.processChunk(channel0);
    }
    return true;
  }

  sendAndClearBuffer(){
    this.port.postMessage({
      event: "chunk",
      data: {
        int16arrayBuffer: this.buffer.slice(0, this.bufferWriteIndex).buffer,
      },
    });
    this.bufferWriteIndex = 0;
  }

  processChunk(float32Array) {
    const l = float32Array.length;
    
    for (let i = 0; i < l; i++) {
      // convert float32 -1 to 1 to int16 -32768 to 32767
      const int16Value = float32Array[i] * 32768;
      this.buffer[this.bufferWriteIndex++] = int16Value;
      if(this.bufferWriteIndex >= this.buffer.length) {
        this.sendAndClearBuffer();
      }
    }

    if(this.bufferWriteIndex >= this.buffer.length) {
      this.sendAndClearBuffer();
    }
  }
}
`,yk=`
  class VolMeter extends AudioWorkletProcessor {
    volume
    updateIntervalInMS
    nextUpdateFrame

    constructor() {
      super()
      this.volume = 0
      this.updateIntervalInMS = 25
      this.nextUpdateFrame = this.updateIntervalInMS
      this.port.onmessage = event => {
        if (event.data.updateIntervalInMS) {
          this.updateIntervalInMS = event.data.updateIntervalInMS
        }
      }
    }

    get intervalInFrames() {
      return (this.updateIntervalInMS / 1000) * sampleRate
    }

    process(inputs) {
      const input = inputs[0]

      if (input.length > 0) {
        const samples = input[0]
        let sum = 0
        let rms = 0

        for (let i = 0; i < samples.length; ++i) {
          sum += samples[i] * samples[i]
        }

        rms = Math.sqrt(sum / samples.length)
        this.volume = Math.max(rms, this.volume * 0.7)

        this.nextUpdateFrame -= samples.length
        if (this.nextUpdateFrame < 0) {
          this.nextUpdateFrame += this.intervalInFrames
          this.port.postMessage({volume: this.volume})
        }
      }

      return true
    }
  }`,bx=new Map,g1=(e,n)=>{const t=new Blob([`registerProcessor("${e}", ${n})`],{type:"application/javascript"});return URL.createObjectURL(t)};var i0={exports:{}},vC;function Qz(){return vC||(vC=1,function(e){var n=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function a(f,u,p){this.fn=f,this.context=u,this.once=p||!1}function o(f,u,p,g,b){if(typeof p!="function")throw new TypeError("The listener must be a function");var v=new a(p,g||f,b),S=t?t+u:u;return f._events[S]?f._events[S].fn?f._events[S]=[f._events[S],v]:f._events[S].push(v):(f._events[S]=v,f._eventsCount++),f}function l(f,u){--f._eventsCount===0?f._events=new r:delete f._events[u]}function d(){this._events=new r,this._eventsCount=0}d.prototype.eventNames=function(){var u=[],p,g;if(this._eventsCount===0)return u;for(g in p=this._events)n.call(p,g)&&u.push(t?g.slice(1):g);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(p)):u},d.prototype.listeners=function(u){var p=t?t+u:u,g=this._events[p];if(!g)return[];if(g.fn)return[g.fn];for(var b=0,v=g.length,S=new Array(v);b<v;b++)S[b]=g[b].fn;return S},d.prototype.listenerCount=function(u){var p=t?t+u:u,g=this._events[p];return g?g.fn?1:g.length:0},d.prototype.emit=function(u,p,g,b,v,S){var k=t?t+u:u;if(!this._events[k])return!1;var T=this._events[k],P=arguments.length,M,I;if(T.fn){switch(T.once&&this.removeListener(u,T.fn,void 0,!0),P){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,p),!0;case 3:return T.fn.call(T.context,p,g),!0;case 4:return T.fn.call(T.context,p,g,b),!0;case 5:return T.fn.call(T.context,p,g,b,v),!0;case 6:return T.fn.call(T.context,p,g,b,v,S),!0}for(I=1,M=new Array(P-1);I<P;I++)M[I-1]=arguments[I];T.fn.apply(T.context,M)}else{var U=T.length,L;for(I=0;I<U;I++)switch(T[I].once&&this.removeListener(u,T[I].fn,void 0,!0),P){case 1:T[I].fn.call(T[I].context);break;case 2:T[I].fn.call(T[I].context,p);break;case 3:T[I].fn.call(T[I].context,p,g);break;case 4:T[I].fn.call(T[I].context,p,g,b);break;default:if(!M)for(L=1,M=new Array(P-1);L<P;L++)M[L-1]=arguments[L];T[I].fn.apply(T[I].context,M)}}return!0},d.prototype.on=function(u,p,g){return o(this,u,p,g,!1)},d.prototype.once=function(u,p,g){return o(this,u,p,g,!0)},d.prototype.removeListener=function(u,p,g,b){var v=t?t+u:u;if(!this._events[v])return this;if(!p)return l(this,v),this;var S=this._events[v];if(S.fn)S.fn===p&&(!b||S.once)&&(!g||S.context===g)&&l(this,v);else{for(var k=0,T=[],P=S.length;k<P;k++)(S[k].fn!==p||b&&!S[k].once||g&&S[k].context!==g)&&T.push(S[k]);T.length?this._events[v]=T.length===1?T[0]:T:l(this,v)}return this},d.prototype.removeAllListeners=function(u){var p;return u?(p=t?t+u:u,this._events[p]&&l(this,p)):(this._events=new r,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=t,d.EventEmitter=d,e.exports=d}(i0)),i0.exports}var Jz=Qz();const xk=Ud(Jz);function Kz(e){for(var n="",t=new Uint8Array(e),r=t.byteLength,a=0;a<r;a++)n+=String.fromCharCode(t[a]);return window.btoa(n)}class bk extends xk{constructor(t=16e3){super();Yn(this,"stream");Yn(this,"audioContext");Yn(this,"source");Yn(this,"recording",!1);Yn(this,"recordingWorklet");Yn(this,"vuWorklet");Yn(this,"starting",null);this.sampleRate=t}async start(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Could not request user media");this.starting=new Promise(async t=>{this.stream=await navigator.mediaDevices.getUserMedia({audio:!0}),this.audioContext=await gk({sampleRate:this.sampleRate}),this.source=this.audioContext.createMediaStreamSource(this.stream);const r="audio-recorder-worklet",a=g1(r,Wz);await this.audioContext.audioWorklet.addModule(a),this.recordingWorklet=new AudioWorkletNode(this.audioContext,r),this.recordingWorklet.port.onmessage=async l=>{const d=l.data.data.int16arrayBuffer;if(d){const f=Kz(d);this.emit("data",f)}},this.source.connect(this.recordingWorklet);const o="vu-meter";await this.audioContext.audioWorklet.addModule(g1(o,yk)),this.vuWorklet=new AudioWorkletNode(this.audioContext,o),this.vuWorklet.port.onmessage=l=>{this.emit("volume",l.data.volume)},this.source.connect(this.vuWorklet),this.recording=!0,t(),this.starting=null})}stop(){const t=()=>{var r,a;(r=this.source)==null||r.disconnect(),(a=this.stream)==null||a.getTracks().forEach(o=>o.stop()),this.stream=void 0,this.recordingWorklet=void 0,this.vuWorklet=void 0,this.audioContext&&(this.audioContext.close(),this.audioContext=void 0)};if(this.starting){this.starting.then(t);return}t()}}const Xz=3,Zz=({active:e,volume:n,hover:t})=>{const r=w.useRef([]);return w.useEffect(()=>{let a=null;const o=()=>{r.current.forEach((l,d)=>{l&&(l.style.height=`${Math.min(24,4+n*(d===1?400:60))}px`)}),a=window.setTimeout(o,100)};return o(),()=>clearTimeout(a)},[n]),i.jsx("div",{className:ou("audioPulse",{active:e,hover:t}),children:Array(Xz).fill(null).map((a,o)=>i.jsx("div",{ref:l=>{r.current[o]=l},style:{animationDelay:`${o*133}ms`}},o))})};var Fm={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var e8=Fm.exports,wC;function t8(){return wC||(wC=1,function(e,n){(function(){var t,r="4.17.21",a=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",d="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",u=500,p="__lodash_placeholder__",g=1,b=2,v=4,S=1,k=2,T=1,P=2,M=4,I=8,U=16,L=32,$=64,z=128,F=256,Y=512,R=30,B="...",G=800,ie=16,te=1,W=2,V=3,se=1/0,re=9007199254740991,oe=17976931348623157e292,E=NaN,le=4294967295,ue=le-1,D=le>>>1,ce=[["ary",z],["bind",T],["bindKey",P],["curry",I],["curryRight",U],["flip",Y],["partial",L],["partialRight",$],["rearg",F]],ve="[object Arguments]",X="[object Array]",fe="[object AsyncFunction]",ae="[object Boolean]",Me="[object Date]",Ke="[object DOMException]",Z="[object Error]",Ee="[object Function]",Ie="[object GeneratorFunction]",Fe="[object Map]",rt="[object Number]",lt="[object Null]",ct="[object Object]",st="[object Promise]",Ht="[object Proxy]",rn="[object RegExp]",je="[object Set]",qe="[object String]",Be="[object Symbol]",ke="[object Undefined]",we="[object WeakMap]",Q="[object WeakSet]",me="[object ArrayBuffer]",Ve="[object DataView]",Qe="[object Float32Array]",ot="[object Float64Array]",kt="[object Int8Array]",qt="[object Int16Array]",be="[object Int32Array]",ge="[object Uint8Array]",Te="[object Uint8ClampedArray]",De="[object Uint16Array]",ze="[object Uint32Array]",nt=/\b__p \+= '';/g,mt=/\b(__p \+=) '' \+/g,Nt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,cn=/&(?:amp|lt|gt|quot|#39);/g,gn=/[&<>"']/g,Cn=RegExp(cn.source),bt=RegExp(gn.source),yt=/<%-([\s\S]+?)%>/g,Ot=/<%([\s\S]+?)%>/g,vt=/<%=([\s\S]+?)%>/g,Wn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Hi=/^\w*$/,br=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,yn=/[\\^$.*+?()[\]{}|]/g,vr=RegExp(yn.source),Ti=/^\s+/,xu=/\s/,bu=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qh=/\{\n\/\* \[wrapped with (.+)\] \*/,el=/,? & /,Qs=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Zl=/[()=,{}\[\]\/\s]/,hs=/\\(\\)?/g,Js=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ks=/\w*$/,Xs=/^[-+]0x[0-9a-f]+$/i,mr=/^0b[01]+$/i,Vd=/^\[object .+?Constructor\]$/,Hd=/^0o[0-7]+$/i,ps=/^(?:0|[1-9]\d*)$/,Zs=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ec=/($^)/,Gd=/['\n\r\u2028\u2029\\]/g,ms="\\ud800-\\udfff",Gi="\\u0300-\\u036f",Fa="\\ufe20-\\ufe2f",tl="\\u20d0-\\u20ff",Ei=Gi+Fa+tl,nl="\\u2700-\\u27bf",rl="a-z\\xdf-\\xf6\\xf8-\\xff",$a="\\xac\\xb1\\xd7\\xf7",tc="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",nc="\\u2000-\\u206f",rc=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",vu="A-Z\\xc0-\\xd6\\xd8-\\xde",Wr="\\ufe0e\\ufe0f",ic=$a+tc+nc+rc,ac="[']",il="["+ms+"]",eo="["+ic+"]",za="["+Ei+"]",sc="\\d+",Qr="["+nl+"]",to="["+rl+"]",oc="[^"+ms+ic+sc+nl+rl+vu+"]",gs="\\ud83c[\\udffb-\\udfff]",ys="(?:"+za+"|"+gs+")",al="[^"+ms+"]",sl="(?:\\ud83c[\\udde6-\\uddff]){2}",Ai="[\\ud800-\\udbff][\\udc00-\\udfff]",Yi="["+vu+"]",no="\\u200d",lc="(?:"+to+"|"+oc+")",ro="(?:"+Yi+"|"+oc+")",Yd="(?:"+ac+"(?:d|ll|m|re|s|t|ve))?",cc="(?:"+ac+"(?:D|LL|M|RE|S|T|VE))?",xs=ys+"?",io="["+Wr+"]?",ol="(?:"+no+"(?:"+[al,sl,Ai].join("|")+")"+io+xs+")*",Ua="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ba="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ll=io+xs+ol,cl="(?:"+[Qr,sl,Ai].join("|")+")"+ll,uc="(?:"+[al+za+"?",za,sl,Ai,il].join("|")+")",Jr=RegExp(ac,"g"),Pi=RegExp(za,"g"),ao=RegExp(gs+"(?="+gs+")|"+uc+ll,"g"),Di=RegExp([Yi+"?"+to+"+"+Yd+"(?="+[eo,Yi,"$"].join("|")+")",ro+"+"+cc+"(?="+[eo,Yi+lc,"$"].join("|")+")",Yi+"?"+lc+"+"+Yd,Yi+"+"+cc,Ba,Ua,sc,cl].join("|"),"g"),qa=RegExp("["+no+ms+Ei+Wr+"]"),ul=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,dc=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],fc=-1,xn={};xn[Qe]=xn[ot]=xn[kt]=xn[qt]=xn[be]=xn[ge]=xn[Te]=xn[De]=xn[ze]=!0,xn[ve]=xn[X]=xn[me]=xn[ae]=xn[Ve]=xn[Me]=xn[Z]=xn[Ee]=xn[Fe]=xn[rt]=xn[ct]=xn[rn]=xn[je]=xn[qe]=xn[we]=!1;var kn={};kn[ve]=kn[X]=kn[me]=kn[Ve]=kn[ae]=kn[Me]=kn[Qe]=kn[ot]=kn[kt]=kn[qt]=kn[be]=kn[Fe]=kn[rt]=kn[ct]=kn[rn]=kn[je]=kn[qe]=kn[Be]=kn[ge]=kn[Te]=kn[De]=kn[ze]=!0,kn[Z]=kn[Ee]=kn[we]=!1;var dl={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Fr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ya={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},fl={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},so=parseFloat,Wd=parseInt,oo=typeof su=="object"&&su&&su.Object===Object&&su,hc=typeof self=="object"&&self&&self.Object===Object&&self,qn=oo||hc||Function("return this")(),xa=n&&!n.nodeType&&n,Va=xa&&!0&&e&&!e.nodeType&&e,pc=Va&&Va.exports===xa,hl=pc&&oo.process,Kr=function(){try{var _e=Va&&Va.require&&Va.require("util").types;return _e||hl&&hl.binding&&hl.binding("util")}catch{}}(),wn=Kr&&Kr.isArrayBuffer,mc=Kr&&Kr.isDate,pl=Kr&&Kr.isMap,gc=Kr&&Kr.isRegExp,lo=Kr&&Kr.isSet,co=Kr&&Kr.isTypedArray;function Ur(_e,Ge,Ue){switch(Ue.length){case 0:return _e.call(Ge);case 1:return _e.call(Ge,Ue[0]);case 2:return _e.call(Ge,Ue[0],Ue[1]);case 3:return _e.call(Ge,Ue[0],Ue[1],Ue[2])}return _e.apply(Ge,Ue)}function Qd(_e,Ge,Ue,ft){for(var At=-1,un=_e==null?0:_e.length;++At<un;){var lr=_e[At];Ge(ft,lr,Ue(lr),_e)}return ft}function wr(_e,Ge){for(var Ue=-1,ft=_e==null?0:_e.length;++Ue<ft&&Ge(_e[Ue],Ue,_e)!==!1;);return _e}function Jd(_e,Ge){for(var Ue=_e==null?0:_e.length;Ue--&&Ge(_e[Ue],Ue,_e)!==!1;);return _e}function yc(_e,Ge){for(var Ue=-1,ft=_e==null?0:_e.length;++Ue<ft;)if(!Ge(_e[Ue],Ue,_e))return!1;return!0}function Xr(_e,Ge){for(var Ue=-1,ft=_e==null?0:_e.length,At=0,un=[];++Ue<ft;){var lr=_e[Ue];Ge(lr,Ue,_e)&&(un[At++]=lr)}return un}function ba(_e,Ge){var Ue=_e==null?0:_e.length;return!!Ue&&fo(_e,Ge,0)>-1}function xc(_e,Ge,Ue){for(var ft=-1,At=_e==null?0:_e.length;++ft<At;)if(Ue(Ge,_e[ft]))return!0;return!1}function Vn(_e,Ge){for(var Ue=-1,ft=_e==null?0:_e.length,At=Array(ft);++Ue<ft;)At[Ue]=Ge(_e[Ue],Ue,_e);return At}function Wi(_e,Ge){for(var Ue=-1,ft=Ge.length,At=_e.length;++Ue<ft;)_e[At+Ue]=Ge[Ue];return _e}function bs(_e,Ge,Ue,ft){var At=-1,un=_e==null?0:_e.length;for(ft&&un&&(Ue=_e[++At]);++At<un;)Ue=Ge(Ue,_e[At],At,_e);return Ue}function Jh(_e,Ge,Ue,ft){var At=_e==null?0:_e.length;for(ft&&At&&(Ue=_e[--At]);At--;)Ue=Ge(Ue,_e[At],At,_e);return Ue}function Ha(_e,Ge){for(var Ue=-1,ft=_e==null?0:_e.length;++Ue<ft;)if(Ge(_e[Ue],Ue,_e))return!0;return!1}var Kh=yl("length");function Kd(_e){return _e.split("")}function uo(_e){return _e.match(Qs)||[]}function vs(_e,Ge,Ue){var ft;return Ue(_e,function(At,un,lr){if(Ge(At,un,lr))return ft=un,!1}),ft}function Ga(_e,Ge,Ue,ft){for(var At=_e.length,un=Ue+(ft?1:-1);ft?un--:++un<At;)if(Ge(_e[un],un,_e))return un;return-1}function fo(_e,Ge,Ue){return Ge===Ge?ep(_e,Ge,Ue):Ga(_e,ws,Ue)}function ml(_e,Ge,Ue,ft){for(var At=Ue-1,un=_e.length;++At<un;)if(ft(_e[At],Ge))return At;return-1}function ws(_e){return _e!==_e}function gl(_e,Ge){var Ue=_e==null?0:_e.length;return Ue?vc(_e,Ge)/Ue:E}function yl(_e){return function(Ge){return Ge==null?t:Ge[_e]}}function bc(_e){return function(Ge){return _e==null?t:_e[Ge]}}function wu(_e,Ge,Ue,ft,At){return At(_e,function(un,lr,dn){Ue=ft?(ft=!1,un):Ge(Ue,un,lr,dn)}),Ue}function Xd(_e,Ge){var Ue=_e.length;for(_e.sort(Ge);Ue--;)_e[Ue]=_e[Ue].value;return _e}function vc(_e,Ge){for(var Ue,ft=-1,At=_e.length;++ft<At;){var un=Ge(_e[ft]);un!==t&&(Ue=Ue===t?un:Ue+un)}return Ue}function Ya(_e,Ge){for(var Ue=-1,ft=Array(_e);++Ue<_e;)ft[Ue]=Ge(Ue);return ft}function Xh(_e,Ge){return Vn(Ge,function(Ue){return[Ue,_e[Ue]]})}function Zd(_e){return _e&&_e.slice(0,ju(_e)+1).replace(Ti,"")}function Zr(_e){return function(Ge){return _e(Ge)}}function xl(_e,Ge){return Vn(Ge,function(Ue){return _e[Ue]})}function ho(_e,Ge){return _e.has(Ge)}function va(_e,Ge){for(var Ue=-1,ft=_e.length;++Ue<ft&&fo(Ge,_e[Ue],0)>-1;);return Ue}function po(_e,Ge){for(var Ue=_e.length;Ue--&&fo(Ge,_e[Ue],0)>-1;);return Ue}function Wa(_e,Ge){for(var Ue=_e.length,ft=0;Ue--;)_e[Ue]===Ge&&++ft;return ft}var Ii=bc(dl),Qi=bc(Fr);function Su(_e){return"\\"+fl[_e]}function wc(_e,Ge){return _e==null?t:_e[Ge]}function wa(_e){return qa.test(_e)}function Nu(_e){return ul.test(_e)}function mo(_e){for(var Ge,Ue=[];!(Ge=_e.next()).done;)Ue.push(Ge.value);return Ue}function bl(_e){var Ge=-1,Ue=Array(_e.size);return _e.forEach(function(ft,At){Ue[++Ge]=[At,ft]}),Ue}function Cu(_e,Ge){return function(Ue){return _e(Ge(Ue))}}function Qa(_e,Ge){for(var Ue=-1,ft=_e.length,At=0,un=[];++Ue<ft;){var lr=_e[Ue];(lr===Ge||lr===p)&&(_e[Ue]=p,un[At++]=Ue)}return un}function vl(_e){var Ge=-1,Ue=Array(_e.size);return _e.forEach(function(ft){Ue[++Ge]=ft}),Ue}function Zh(_e){var Ge=-1,Ue=Array(_e.size);return _e.forEach(function(ft){Ue[++Ge]=[ft,ft]}),Ue}function ep(_e,Ge,Ue){for(var ft=Ue-1,At=_e.length;++ft<At;)if(_e[ft]===Ge)return ft;return-1}function ei(_e,Ge,Ue){for(var ft=Ue+1;ft--;)if(_e[ft]===Ge)return ft;return ft}function Ji(_e){return wa(_e)?ef(_e):Kh(_e)}function ci(_e){return wa(_e)?wl(_e):Kd(_e)}function ju(_e){for(var Ge=_e.length;Ge--&&xu.test(_e.charAt(Ge)););return Ge}var Ss=bc(ya);function ef(_e){for(var Ge=ao.lastIndex=0;ao.test(_e);)++Ge;return Ge}function wl(_e){return _e.match(ao)||[]}function tp(_e){return _e.match(Di)||[]}var Ja=function _e(Ge){Ge=Ge==null?qn:Ka.defaults(qn.Object(),Ge,Ka.pick(qn,dc));var Ue=Ge.Array,ft=Ge.Date,At=Ge.Error,un=Ge.Function,lr=Ge.Math,dn=Ge.Object,Sc=Ge.RegExp,tf=Ge.String,ti=Ge.TypeError,Nc=Ue.prototype,np=un.prototype,Ns=dn.prototype,go=Ge["__core-js_shared__"],yo=np.toString,ee=Ns.hasOwnProperty,he=0,de=function(){var m=/[^.]+$/.exec(go&&go.keys&&go.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),Se=Ns.toString,Ye=yo.call(dn),ut=qn._,Ct=Sc("^"+yo.call(ee).replace(yn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),St=pc?Ge.Buffer:t,Hn=Ge.Symbol,Br=Ge.Uint8Array,Cs=St?St.allocUnsafe:t,_u=Cu(dn.getPrototypeOf,dn),ku=dn.create,Sl=Ns.propertyIsEnumerable,nf=Nc.splice,ui=Hn?Hn.isConcatSpreadable:t,Nl=Hn?Hn.iterator:t,ni=Hn?Hn.toStringTag:t,Tu=function(){try{var m=_o(dn,"defineProperty");return m({},"",{}),m}catch{}}(),rf=Ge.clearTimeout!==qn.clearTimeout&&Ge.clearTimeout,Cl=ft&&ft.now!==qn.Date.now&&ft.now,rp=Ge.setTimeout!==qn.setTimeout&&Ge.setTimeout,Cc=lr.ceil,js=lr.floor,xo=dn.getOwnPropertySymbols,af=St?St.isBuffer:t,Eu=Ge.isFinite,Ki=Nc.join,Xi=Cu(dn.keys,dn),Qn=lr.max,er=lr.min,_s=ft.now,jl=Ge.parseInt,ip=lr.random,ap=Nc.reverse,Au=_o(Ge,"DataView"),Sr=_o(Ge,"Map"),tr=_o(Ge,"Promise"),on=_o(Ge,"Set"),Sa=_o(Ge,"WeakMap"),di=_o(dn,"create"),jc=Sa&&new Sa,Zi={},mg=Ms(Au),gg=Ms(Sr),Pu=Ms(tr),Du=Ms(on),yg=Ms(Sa),bo=Hn?Hn.prototype:t,_l=bo?bo.valueOf:t,vo=bo?bo.toString:t;function J(m){if(or(m)&&!zt(m)&&!(m instanceof Zt)){if(m instanceof fi)return m;if(ee.call(m,"__wrapped__"))return Cr(m)}return new fi(m)}var Ri=function(){function m(){}return function(y){if(!rr(y))return{};if(ku)return ku(y);m.prototype=y;var _=new m;return m.prototype=t,_}}();function ea(){}function fi(m,y){this.__wrapped__=m,this.__actions__=[],this.__chain__=!!y,this.__index__=0,this.__values__=t}J.templateSettings={escape:yt,evaluate:Ot,interpolate:vt,variable:"",imports:{_:J}},J.prototype=ea.prototype,J.prototype.constructor=J,fi.prototype=Ri(ea.prototype),fi.prototype.constructor=fi;function Zt(m){this.__wrapped__=m,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=le,this.__views__=[]}function Iu(){var m=new Zt(this.__wrapped__);return m.__actions__=Nr(this.__actions__),m.__dir__=this.__dir__,m.__filtered__=this.__filtered__,m.__iteratees__=Nr(this.__iteratees__),m.__takeCount__=this.__takeCount__,m.__views__=Nr(this.__views__),m}function sf(){if(this.__filtered__){var m=new Zt(this);m.__dir__=-1,m.__filtered__=!0}else m=this.clone(),m.__dir__*=-1;return m}function kl(){var m=this.__wrapped__.value(),y=this.__dir__,_=zt(m),O=y<0,H=_?m.length:0,ne=Jg(0,H,this.__views__),ye=ne.start,Ne=ne.end,Pe=Ne-ye,Xe=O?Ne:ye-1,et=this.__iteratees__,tt=et.length,pt=0,xt=er(Pe,this.__takeCount__);if(!_||!O&&H==Pe&&xt==Pe)return Og(m,this.__actions__);var Lt=[];e:for(;Pe--&&pt<xt;){Xe+=y;for(var tn=-1,Ft=m[Xe];++tn<tt;){var hn=et[tn],Nn=hn.iteratee,Ea=hn.type,Ui=Nn(Ft);if(Ea==W)Ft=Ui;else if(!Ui){if(Ea==te)continue e;break e}}Lt[pt++]=Ft}return Lt}Zt.prototype=Ri(ea.prototype),Zt.prototype.constructor=Zt;function cr(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var O=m[y];this.set(O[0],O[1])}}function of(){this.__data__=di?di(null):{},this.size=0}function xg(m){var y=this.has(m)&&delete this.__data__[m];return this.size-=y?1:0,y}function Gb(m){var y=this.__data__;if(di){var _=y[m];return _===f?t:_}return ee.call(y,m)?y[m]:t}function Yb(m){var y=this.__data__;return di?y[m]!==t:ee.call(y,m)}function Wb(m,y){var _=this.__data__;return this.size+=this.has(m)?0:1,_[m]=di&&y===t?f:y,this}cr.prototype.clear=of,cr.prototype.delete=xg,cr.prototype.get=Gb,cr.prototype.has=Yb,cr.prototype.set=Wb;function $n(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var O=m[y];this.set(O[0],O[1])}}function sp(){this.__data__=[],this.size=0}function Ru(m){var y=this.__data__,_=Tc(y,m);if(_<0)return!1;var O=y.length-1;return _==O?y.pop():nf.call(y,_,1),--this.size,!0}function Mu(m){var y=this.__data__,_=Tc(y,m);return _<0?t:y[_][1]}function op(m){return Tc(this.__data__,m)>-1}function _c(m,y){var _=this.__data__,O=Tc(_,m);return O<0?(++this.size,_.push([m,y])):_[O][1]=y,this}$n.prototype.clear=sp,$n.prototype.delete=Ru,$n.prototype.get=Mu,$n.prototype.has=op,$n.prototype.set=_c;function hi(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var O=m[y];this.set(O[0],O[1])}}function Qb(){this.size=0,this.__data__={hash:new cr,map:new(Sr||$n),string:new cr}}function bg(m){var y=Rc(this,m).delete(m);return this.size-=y?1:0,y}function Jb(m){return Rc(this,m).get(m)}function vg(m){return Rc(this,m).has(m)}function Tl(m,y){var _=Rc(this,m),O=_.size;return _.set(m,y),this.size+=_.size==O?0:1,this}hi.prototype.clear=Qb,hi.prototype.delete=bg,hi.prototype.get=Jb,hi.prototype.has=vg,hi.prototype.set=Tl;function ks(m){var y=-1,_=m==null?0:m.length;for(this.__data__=new hi;++y<_;)this.add(m[y])}function lf(m){return this.__data__.set(m,f),this}function wg(m){return this.__data__.has(m)}ks.prototype.add=ks.prototype.push=lf,ks.prototype.has=wg;function ri(m){var y=this.__data__=new $n(m);this.size=y.size}function Sg(){this.__data__=new $n,this.size=0}function cf(m){var y=this.__data__,_=y.delete(m);return this.size=y.size,_}function lp(m){return this.__data__.get(m)}function Ng(m){return this.__data__.has(m)}function uf(m,y){var _=this.__data__;if(_ instanceof $n){var O=_.__data__;if(!Sr||O.length<a-1)return O.push([m,y]),this.size=++_.size,this;_=this.__data__=new hi(O)}return _.set(m,y),this.size=_.size,this}ri.prototype.clear=Sg,ri.prototype.delete=cf,ri.prototype.get=lp,ri.prototype.has=Ng,ri.prototype.set=uf;function cp(m,y){var _=zt(m),O=!_&&$s(m),H=!_&&!O&&Oo(m),ne=!_&&!O&&!H&&Wc(m),ye=_||O||H||ne,Ne=ye?Ya(m.length,tf):[],Pe=Ne.length;for(var Xe in m)(y||ee.call(m,Xe))&&!(ye&&(Xe=="length"||H&&(Xe=="offset"||Xe=="parent")||ne&&(Xe=="buffer"||Xe=="byteLength"||Xe=="byteOffset")||_a(Xe,Pe)))&&Ne.push(Xe);return Ne}function kc(m){var y=m.length;return y?m[vf(0,y-1)]:t}function Cg(m,y){return ld(Nr(m),Ca(y,0,m.length))}function jg(m){return ld(Nr(m))}function Xa(m,y,_){(_!==t&&!vi(m[y],_)||_===t&&!(y in m))&&Na(m,y,_)}function El(m,y,_){var O=m[y];(!(ee.call(m,y)&&vi(O,_))||_===t&&!(y in m))&&Na(m,y,_)}function Tc(m,y){for(var _=m.length;_--;)if(vi(m[_][0],y))return _;return-1}function wo(m,y,_,O){return Es(m,function(H,ne,ye){y(O,H,_(H),ye)}),O}function Ts(m,y){return m&&gi(y,kr(y),m)}function Ou(m,y){return m&&gi(y,Ir(y),m)}function Na(m,y,_){y=="__proto__"&&Tu?Tu(m,y,{configurable:!0,enumerable:!0,value:_,writable:!0}):m[y]=_}function Lu(m,y){for(var _=-1,O=y.length,H=Ue(O),ne=m==null;++_<O;)H[_]=ne?t:Sd(m,y[_]);return H}function Ca(m,y,_){return m===m&&(_!==t&&(m=m<=_?m:_),y!==t&&(m=m>=y?m:y)),m}function qr(m,y,_,O,H,ne){var ye,Ne=y&g,Pe=y&b,Xe=y&v;if(_&&(ye=H?_(m,O,H,ne):_(m)),ye!==t)return ye;if(!rr(m))return m;var et=zt(m);if(et){if(ye=Mp(m),!Ne)return Nr(m,ye)}else{var tt=Dr(m),pt=tt==Ee||tt==Ie;if(Oo(m))return kp(m,Ne);if(tt==ct||tt==ve||pt&&!H){if(ye=Pe||pt?{}:Op(m),!Ne)return Pe?Ju(m,Ou(ye,m)):_f(m,Ts(ye,m))}else{if(!kn[tt])return H?m:{};ye=Lp(m,tt,Ne)}}ne||(ne=new ri);var xt=ne.get(m);if(xt)return xt;ne.set(m,ye),By(m)?m.forEach(function(Ft){ye.add(qr(Ft,y,_,Ft,m,ne))}):Kf(m)&&m.forEach(function(Ft,hn){ye.set(hn,qr(Ft,y,_,hn,m,ne))});var Lt=Xe?Pe?Af:Ef:Pe?Ir:kr,tn=et?t:Lt(m);return wr(tn||m,function(Ft,hn){tn&&(hn=Ft,Ft=m[hn]),El(ye,hn,qr(Ft,y,_,hn,m,ne))}),ye}function _g(m){var y=kr(m);return function(_){return up(_,m,y)}}function up(m,y,_){var O=_.length;if(m==null)return!O;for(m=dn(m);O--;){var H=_[O],ne=y[H],ye=m[H];if(ye===t&&!(H in m)||!ne(ye))return!1}return!0}function Al(m,y,_){if(typeof m!="function")throw new ti(l);return Oc(function(){m.apply(t,_)},y)}function So(m,y,_,O){var H=-1,ne=ba,ye=!0,Ne=m.length,Pe=[],Xe=y.length;if(!Ne)return Pe;_&&(y=Vn(y,Zr(_))),O?(ne=xc,ye=!1):y.length>=a&&(ne=ho,ye=!1,y=new ks(y));e:for(;++H<Ne;){var et=m[H],tt=_==null?et:_(et);if(et=O||et!==0?et:0,ye&&tt===tt){for(var pt=Xe;pt--;)if(y[pt]===tt)continue e;Pe.push(et)}else ne(y,tt,O)||Pe.push(et)}return Pe}var Es=Pp(Vr),df=Pp(Ac,!0);function dp(m,y){var _=!0;return Es(m,function(O,H,ne){return _=!!y(O,H,ne),_}),_}function ja(m,y,_){for(var O=-1,H=m.length;++O<H;){var ne=m[O],ye=y(ne);if(ye!=null&&(Ne===t?ye===ye&&!si(ye):_(ye,Ne)))var Ne=ye,Pe=ne}return Pe}function Jt(m,y,_,O){var H=m.length;for(_=Vt(_),_<0&&(_=-_>H?0:H+_),O=O===t||O>H?H:Vt(O),O<0&&(O+=H),O=_>O?0:os(O);_<O;)m[_++]=y;return m}function An(m,y){var _=[];return Es(m,function(O,H,ne){y(O,H,ne)&&_.push(O)}),_}function ln(m,y,_,O,H){var ne=-1,ye=m.length;for(_||(_=Is),H||(H=[]);++ne<ye;){var Ne=m[ne];y>0&&_(Ne)?y>1?ln(Ne,y-1,_,O,H):Wi(H,Ne):O||(H[H.length]=Ne)}return H}var Ec=Ll(),Pl=Ll(!0);function Vr(m,y){return m&&Ec(m,y,kr)}function Ac(m,y){return m&&Pl(m,y,kr)}function No(m,y){return Xr(y,function(_){return ka(m[_])})}function ta(m,y){y=Ps(y,m);for(var _=0,O=y.length;m!=null&&_<O;)m=m[En(y[_++])];return _&&_==O?m:t}function kg(m,y,_){var O=y(m);return zt(m)?O:Wi(O,_(m))}function fn(m){return m==null?m===t?ke:lt:ni&&ni in dn(m)?Qg(m):ty(m)}function Fu(m,y){return m>y}function fp(m,y){return m!=null&&ee.call(m,y)}function Tg(m,y){return m!=null&&y in dn(m)}function Eg(m,y,_){return m>=er(y,_)&&m<Qn(y,_)}function hp(m,y,_){for(var O=_?xc:ba,H=m[0].length,ne=m.length,ye=ne,Ne=Ue(ne),Pe=1/0,Xe=[];ye--;){var et=m[ye];ye&&y&&(et=Vn(et,Zr(y))),Pe=er(et.length,Pe),Ne[ye]=!_&&(y||H>=120&&et.length>=120)?new ks(ye&&et):t}et=m[0];var tt=-1,pt=Ne[0];e:for(;++tt<H&&Xe.length<Pe;){var xt=et[tt],Lt=y?y(xt):xt;if(xt=_||xt!==0?xt:0,!(pt?ho(pt,Lt):O(Xe,Lt,_))){for(ye=ne;--ye;){var tn=Ne[ye];if(!(tn?ho(tn,Lt):O(m[ye],Lt,_)))continue e}pt&&pt.push(Lt),Xe.push(xt)}}return Xe}function pp(m,y,_,O){return Vr(m,function(H,ne,ye){y(O,_(H),ne,ye)}),O}function Dl(m,y,_){y=Ps(y,m),m=Mc(m,y);var O=m==null?m:m[En(Hr(y))];return O==null?t:Ur(O,m,_)}function ff(m){return or(m)&&fn(m)==ve}function pi(m){return or(m)&&fn(m)==me}function gr(m){return or(m)&&fn(m)==Me}function Il(m,y,_,O,H){return m===y?!0:m==null||y==null||!or(m)&&!or(y)?m!==m&&y!==y:$u(m,y,_,O,Il,H)}function $u(m,y,_,O,H,ne){var ye=zt(m),Ne=zt(y),Pe=ye?X:Dr(m),Xe=Ne?X:Dr(y);Pe=Pe==ve?ct:Pe,Xe=Xe==ve?ct:Xe;var et=Pe==ct,tt=Xe==ct,pt=Pe==Xe;if(pt&&Oo(m)){if(!Oo(y))return!1;ye=!0,et=!1}if(pt&&!et)return ne||(ne=new ri),ye||Wc(m)?Yg(m,y,_,O,H,ne):Wg(m,y,Pe,_,O,H,ne);if(!(_&S)){var xt=et&&ee.call(m,"__wrapped__"),Lt=tt&&ee.call(y,"__wrapped__");if(xt||Lt){var tn=xt?m.value():m,Ft=Lt?y.value():y;return ne||(ne=new ri),H(tn,Ft,_,O,ne)}}return pt?(ne||(ne=new ri),Pr(m,y,_,O,H,ne)):!1}function hf(m){return or(m)&&Dr(m)==Fe}function zu(m,y,_,O){var H=_.length,ne=H,ye=!O;if(m==null)return!ne;for(m=dn(m);H--;){var Ne=_[H];if(ye&&Ne[2]?Ne[1]!==m[Ne[0]]:!(Ne[0]in m))return!1}for(;++H<ne;){Ne=_[H];var Pe=Ne[0],Xe=m[Pe],et=Ne[1];if(ye&&Ne[2]){if(Xe===t&&!(Pe in m))return!1}else{var tt=new ri;if(O)var pt=O(Xe,et,Pe,m,y,tt);if(!(pt===t?Il(et,Xe,S|k,O,tt):pt))return!1}}return!0}function Za(m){if(!rr(m)||Of(m))return!1;var y=ka(m)?Ct:Vd;return y.test(Ms(m))}function pf(m){return or(m)&&fn(m)==rn}function mp(m){return or(m)&&Dr(m)==je}function gp(m){return or(m)&&Bl(m.length)&&!!xn[fn(m)]}function yp(m){return typeof m=="function"?m:m==null?Le:typeof m=="object"?zt(m)?yf(m[0],m[1]):bp(m):Sn(m)}function mf(m){if(!zn(m))return Xi(m);var y=[];for(var _ in dn(m))ee.call(m,_)&&_!="constructor"&&y.push(_);return y}function Ag(m){if(!rr(m))return ko(m);var y=zn(m),_=[];for(var O in m)O=="constructor"&&(y||!ee.call(m,O))||_.push(O);return _}function gf(m,y){return m<y}function xp(m,y){var _=-1,O=jr(m)?Ue(m.length):[];return Es(m,function(H,ne,ye){O[++_]=y(H,ne,ye)}),O}function bp(m){var y=Df(m);return y.length==1&&y[0][2]?Zg(y[0][0],y[0][1]):function(_){return _===m||zu(_,m,y)}}function yf(m,y){return Rf(m)&&Xg(y)?Zg(En(m),y):function(_){var O=Sd(_,m);return O===t&&O===y?Xc(_,m):Il(y,O,S|k)}}function Uu(m,y,_,O,H){m!==y&&Ec(y,function(ne,ye){if(H||(H=new ri),rr(ne))Kb(m,y,ye,_,Uu,O,H);else{var Ne=O?O(Lf(m,ye),ne,ye+"",m,y,H):t;Ne===t&&(Ne=ne),Xa(m,ye,Ne)}},Ir)}function Kb(m,y,_,O,H,ne,ye){var Ne=Lf(m,_),Pe=Lf(y,_),Xe=ye.get(Pe);if(Xe){Xa(m,_,Xe);return}var et=ne?ne(Ne,Pe,_+"",m,y,ye):t,tt=et===t;if(tt){var pt=zt(Pe),xt=!pt&&Oo(Pe),Lt=!pt&&!xt&&Wc(Pe);et=Pe,pt||xt||Lt?zt(Ne)?et=Ne:fr(Ne)?et=Nr(Ne):xt?(tt=!1,et=kp(Pe,!0)):Lt?(tt=!1,et=Ep(Pe,!0)):et=[]:aa(Pe)||$s(Pe)?(et=Ne,$s(Ne)?et=Hy(Ne):(!rr(Ne)||ka(Ne))&&(et=Op(Pe))):tt=!1}tt&&(ye.set(Pe,et),H(et,Pe,O,ne,ye),ye.delete(Pe)),Xa(m,_,et)}function vp(m,y){var _=m.length;if(_)return y+=y<0?_:0,_a(y,_)?m[y]:t}function wp(m,y,_){y.length?y=Vn(y,function(ne){return zt(ne)?function(ye){return ta(ye,ne.length===1?ne[0]:ne)}:ne}):y=[Le];var O=-1;y=Vn(y,Zr(jt()));var H=xp(m,function(ne,ye,Ne){var Pe=Vn(y,function(Xe){return Xe(ne)});return{criteria:Pe,index:++O,value:ne}});return Xd(H,function(ne,ye){return zg(ne,ye,_)})}function Pg(m,y){return xf(m,y,function(_,O){return Xc(m,O)})}function xf(m,y,_){for(var O=-1,H=y.length,ne={};++O<H;){var ye=y[O],Ne=ta(m,ye);_(Ne,ye)&&Dc(ne,Ps(ye,m),Ne)}return ne}function Dg(m){return function(y){return ta(y,m)}}function bf(m,y,_,O){var H=O?ml:fo,ne=-1,ye=y.length,Ne=m;for(m===y&&(y=Nr(y)),_&&(Ne=Vn(m,Zr(_)));++ne<ye;)for(var Pe=0,Xe=y[ne],et=_?_(Xe):Xe;(Pe=H(Ne,et,Pe,O))>-1;)Ne!==m&&nf.call(Ne,Pe,1),nf.call(m,Pe,1);return m}function Sp(m,y){for(var _=m?y.length:0,O=_-1;_--;){var H=y[_];if(_==O||H!==ne){var ne=H;_a(H)?nf.call(m,H,1):Hu(m,H)}}return m}function vf(m,y){return m+js(ip()*(y-m+1))}function Ig(m,y,_,O){for(var H=-1,ne=Qn(Cc((y-m)/(_||1)),0),ye=Ue(ne);ne--;)ye[O?ne:++H]=m,m+=_;return ye}function Np(m,y){var _="";if(!m||y<1||y>re)return _;do y%2&&(_+=m),y=js(y/2),y&&(m+=m);while(y);return _}function Gt(m,y){return sd(Fp(m,y,Le),m+"")}function Pc(m){return kc(eu(m))}function wf(m,y){var _=eu(m);return ld(_,Ca(y,0,_.length))}function Dc(m,y,_,O){if(!rr(m))return m;y=Ps(y,m);for(var H=-1,ne=y.length,ye=ne-1,Ne=m;Ne!=null&&++H<ne;){var Pe=En(y[H]),Xe=_;if(Pe==="__proto__"||Pe==="constructor"||Pe==="prototype")return m;if(H!=ye){var et=Ne[Pe];Xe=O?O(et,Pe,Ne):t,Xe===t&&(Xe=rr(et)?et:_a(y[H+1])?[]:{})}El(Ne,Pe,Xe),Ne=Ne[Pe]}return m}var Bu=jc?function(m,y){return jc.set(m,y),m}:Le,qu=Tu?function(m,y){return Tu(m,"toString",{configurable:!0,enumerable:!1,value:Oe(y),writable:!0})}:Le;function Rg(m){return ld(eu(m))}function Mi(m,y,_){var O=-1,H=m.length;y<0&&(y=-y>H?0:H+y),_=_>H?H:_,_<0&&(_+=H),H=y>_?0:_-y>>>0,y>>>=0;for(var ne=Ue(H);++O<H;)ne[O]=m[O+y];return ne}function Mg(m,y){var _;return Es(m,function(O,H,ne){return _=y(O,H,ne),!_}),!!_}function Vu(m,y,_){var O=0,H=m==null?O:m.length;if(typeof y=="number"&&y===y&&H<=D){for(;O<H;){var ne=O+H>>>1,ye=m[ne];ye!==null&&!si(ye)&&(_?ye<=y:ye<y)?O=ne+1:H=ne}return H}return Sf(m,y,Le,_)}function Sf(m,y,_,O){var H=0,ne=m==null?0:m.length;if(ne===0)return 0;y=_(y);for(var ye=y!==y,Ne=y===null,Pe=si(y),Xe=y===t;H<ne;){var et=js((H+ne)/2),tt=_(m[et]),pt=tt!==t,xt=tt===null,Lt=tt===tt,tn=si(tt);if(ye)var Ft=O||Lt;else Xe?Ft=Lt&&(O||pt):Ne?Ft=Lt&&pt&&(O||!xt):Pe?Ft=Lt&&pt&&!xt&&(O||!tn):xt||tn?Ft=!1:Ft=O?tt<=y:tt<y;Ft?H=et+1:ne=et}return er(ne,ue)}function Cp(m,y){for(var _=-1,O=m.length,H=0,ne=[];++_<O;){var ye=m[_],Ne=y?y(ye):ye;if(!_||!vi(Ne,Pe)){var Pe=Ne;ne[H++]=ye===0?0:ye}}return ne}function Nf(m){return typeof m=="number"?m:si(m)?E:+m}function mi(m){if(typeof m=="string")return m;if(zt(m))return Vn(m,mi)+"";if(si(m))return vo?vo.call(m):"";var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function As(m,y,_){var O=-1,H=ba,ne=m.length,ye=!0,Ne=[],Pe=Ne;if(_)ye=!1,H=xc;else if(ne>=a){var Xe=y?null:Hg(m);if(Xe)return vl(Xe);ye=!1,H=ho,Pe=new ks}else Pe=y?[]:Ne;e:for(;++O<ne;){var et=m[O],tt=y?y(et):et;if(et=_||et!==0?et:0,ye&&tt===tt){for(var pt=Pe.length;pt--;)if(Pe[pt]===tt)continue e;y&&Pe.push(tt),Ne.push(et)}else H(Pe,tt,_)||(Pe!==Ne&&Pe.push(tt),Ne.push(et))}return Ne}function Hu(m,y){return y=Ps(y,m),m=Mc(m,y),m==null||delete m[En(Hr(y))]}function jp(m,y,_,O){return Dc(m,y,_(ta(m,y)),O)}function Gu(m,y,_,O){for(var H=m.length,ne=O?H:-1;(O?ne--:++ne<H)&&y(m[ne],ne,m););return _?Mi(m,O?0:ne,O?ne+1:H):Mi(m,O?ne+1:0,O?H:ne)}function Og(m,y){var _=m;return _ instanceof Zt&&(_=_.value()),bs(y,function(O,H){return H.func.apply(H.thisArg,Wi([O],H.args))},_)}function Yu(m,y,_){var O=m.length;if(O<2)return O?As(m[0]):[];for(var H=-1,ne=Ue(O);++H<O;)for(var ye=m[H],Ne=-1;++Ne<O;)Ne!=H&&(ne[H]=So(ne[H]||ye,m[Ne],y,_));return As(ln(ne,1),y,_)}function _p(m,y,_){for(var O=-1,H=m.length,ne=y.length,ye={};++O<H;){var Ne=O<ne?y[O]:t;_(ye,m[O],Ne)}return ye}function Cf(m){return fr(m)?m:[]}function Wu(m){return typeof m=="function"?m:Le}function Ps(m,y){return zt(m)?m:Rf(m,y)?[m]:rs(Tn(m))}var Lg=Gt;function Co(m,y,_){var O=m.length;return _=_===t?O:_,!y&&_>=O?m:Mi(m,y,_)}var Fg=rf||function(m){return qn.clearTimeout(m)};function kp(m,y){if(y)return m.slice();var _=m.length,O=Cs?Cs(_):new m.constructor(_);return m.copy(O),O}function Rl(m){var y=new m.constructor(m.byteLength);return new Br(y).set(new Br(m)),y}function Tp(m,y){var _=y?Rl(m.buffer):m.buffer;return new m.constructor(_,m.byteOffset,m.byteLength)}function jf(m){var y=new m.constructor(m.source,Ks.exec(m));return y.lastIndex=m.lastIndex,y}function $g(m){return _l?dn(_l.call(m)):{}}function Ep(m,y){var _=y?Rl(m.buffer):m.buffer;return new m.constructor(_,m.byteOffset,m.length)}function Qu(m,y){if(m!==y){var _=m!==t,O=m===null,H=m===m,ne=si(m),ye=y!==t,Ne=y===null,Pe=y===y,Xe=si(y);if(!Ne&&!Xe&&!ne&&m>y||ne&&ye&&Pe&&!Ne&&!Xe||O&&ye&&Pe||!_&&Pe||!H)return 1;if(!O&&!ne&&!Xe&&m<y||Xe&&_&&H&&!O&&!ne||Ne&&_&&H||!ye&&H||!Pe)return-1}return 0}function zg(m,y,_){for(var O=-1,H=m.criteria,ne=y.criteria,ye=H.length,Ne=_.length;++O<ye;){var Pe=Qu(H[O],ne[O]);if(Pe){if(O>=Ne)return Pe;var Xe=_[O];return Pe*(Xe=="desc"?-1:1)}}return m.index-y.index}function Ap(m,y,_,O){for(var H=-1,ne=m.length,ye=_.length,Ne=-1,Pe=y.length,Xe=Qn(ne-ye,0),et=Ue(Pe+Xe),tt=!O;++Ne<Pe;)et[Ne]=y[Ne];for(;++H<ye;)(tt||H<ne)&&(et[_[H]]=m[H]);for(;Xe--;)et[Ne++]=m[H++];return et}function Ug(m,y,_,O){for(var H=-1,ne=m.length,ye=-1,Ne=_.length,Pe=-1,Xe=y.length,et=Qn(ne-Ne,0),tt=Ue(et+Xe),pt=!O;++H<et;)tt[H]=m[H];for(var xt=H;++Pe<Xe;)tt[xt+Pe]=y[Pe];for(;++ye<Ne;)(pt||H<ne)&&(tt[xt+_[ye]]=m[H++]);return tt}function Nr(m,y){var _=-1,O=m.length;for(y||(y=Ue(O));++_<O;)y[_]=m[_];return y}function gi(m,y,_,O){var H=!_;_||(_={});for(var ne=-1,ye=y.length;++ne<ye;){var Ne=y[ne],Pe=O?O(_[Ne],m[Ne],Ne,_,m):t;Pe===t&&(Pe=m[Ne]),H?Na(_,Ne,Pe):El(_,Ne,Pe)}return _}function _f(m,y){return gi(m,nd(m),y)}function Ju(m,y){return gi(m,If(m),y)}function Ml(m,y){return function(_,O){var H=zt(_)?Qd:wo,ne=y?y():{};return H(_,m,jt(O,2),ne)}}function Ol(m){return Gt(function(y,_){var O=-1,H=_.length,ne=H>1?_[H-1]:t,ye=H>2?_[2]:t;for(ne=m.length>3&&typeof ne=="function"?(H--,ne):t,ye&&ai(_[0],_[1],ye)&&(ne=H<3?t:ne,H=1),y=dn(y);++O<H;){var Ne=_[O];Ne&&m(y,Ne,O,ne)}return y})}function Pp(m,y){return function(_,O){if(_==null)return _;if(!jr(_))return m(_,O);for(var H=_.length,ne=y?H:-1,ye=dn(_);(y?ne--:++ne<H)&&O(ye[ne],ne,ye)!==!1;);return _}}function Ll(m){return function(y,_,O){for(var H=-1,ne=dn(y),ye=O(y),Ne=ye.length;Ne--;){var Pe=ye[m?Ne:++H];if(_(ne[Pe],Pe,ne)===!1)break}return y}}function Bg(m,y,_){var O=y&T,H=na(m);function ne(){var ye=this&&this!==qn&&this instanceof ne?H:m;return ye.apply(O?_:this,arguments)}return ne}function Oi(m){return function(y){y=Tn(y);var _=wa(y)?ci(y):t,O=_?_[0]:y.charAt(0),H=_?Co(_,1).join(""):y.slice(1);return O[m]()+H}}function ii(m){return function(y){return bs(N(zs(y).replace(Jr,"")),m,"")}}function na(m){return function(){var y=arguments;switch(y.length){case 0:return new m;case 1:return new m(y[0]);case 2:return new m(y[0],y[1]);case 3:return new m(y[0],y[1],y[2]);case 4:return new m(y[0],y[1],y[2],y[3]);case 5:return new m(y[0],y[1],y[2],y[3],y[4]);case 6:return new m(y[0],y[1],y[2],y[3],y[4],y[5]);case 7:return new m(y[0],y[1],y[2],y[3],y[4],y[5],y[6])}var _=Ri(m.prototype),O=m.apply(_,y);return rr(O)?O:_}}function qg(m,y,_){var O=na(m);function H(){for(var ne=arguments.length,ye=Ue(ne),Ne=ne,Pe=$l(H);Ne--;)ye[Ne]=arguments[Ne];var Xe=ne<3&&ye[0]!==Pe&&ye[ne-1]!==Pe?[]:Qa(ye,Pe);if(ne-=Xe.length,ne<_)return Dp(m,y,ur,H.placeholder,t,ye,Xe,t,t,_-ne);var et=this&&this!==qn&&this instanceof H?O:m;return Ur(et,this,ye)}return H}function Ds(m){return function(y,_,O){var H=dn(y);if(!jr(y)){var ne=jt(_,3);y=kr(y),_=function(Ne){return ne(H[Ne],Ne,H)}}var ye=m(y,_,O);return ye>-1?H[ne?y[ye]:ye]:t}}function es(m){return Jn(function(y){var _=y.length,O=_,H=fi.prototype.thru;for(m&&y.reverse();O--;){var ne=y[O];if(typeof ne!="function")throw new ti(l);if(H&&!ye&&td(ne)=="wrapper")var ye=new fi([],!0)}for(O=ye?O:_;++O<_;){ne=y[O];var Ne=td(ne),Pe=Ne=="wrapper"?Pf(ne):t;Pe&&Mf(Pe[0])&&Pe[1]==(z|I|L|F)&&!Pe[4].length&&Pe[9]==1?ye=ye[td(Pe[0])].apply(ye,Pe[3]):ye=ne.length==1&&Mf(ne)?ye[Ne]():ye.thru(ne)}return function(){var Xe=arguments,et=Xe[0];if(ye&&Xe.length==1&&zt(et))return ye.plant(et).value();for(var tt=0,pt=_?y[tt].apply(this,Xe):et;++tt<_;)pt=y[tt].call(this,pt);return pt}})}function ur(m,y,_,O,H,ne,ye,Ne,Pe,Xe){var et=y&z,tt=y&T,pt=y&P,xt=y&(I|U),Lt=y&Y,tn=pt?t:na(m);function Ft(){for(var hn=arguments.length,Nn=Ue(hn),Ea=hn;Ea--;)Nn[Ea]=arguments[Ea];if(xt)var Ui=$l(Ft),Aa=Wa(Nn,Ui);if(O&&(Nn=Ap(Nn,O,H,xt)),ne&&(Nn=Ug(Nn,ne,ye,xt)),hn-=Aa,xt&&hn<Xe){var Tr=Qa(Nn,Ui);return Dp(m,y,ur,Ft.placeholder,_,Nn,Tr,Ne,Pe,Xe-hn)}var Us=tt?_:this,ql=pt?Us[m]:m;return hn=Nn.length,Ne?Nn=ns(Nn,Ne):Lt&&hn>1&&Nn.reverse(),et&&Pe<hn&&(Nn.length=Pe),this&&this!==qn&&this instanceof Ft&&(ql=tn||na(ql)),ql.apply(Us,Nn)}return Ft}function Ku(m,y){return function(_,O){return pp(_,m,y(O),{})}}function Ic(m,y){return function(_,O){var H;if(_===t&&O===t)return y;if(_!==t&&(H=_),O!==t){if(H===t)return O;typeof _=="string"||typeof O=="string"?(_=mi(_),O=mi(O)):(_=Nf(_),O=Nf(O)),H=m(_,O)}return H}}function Xu(m){return Jn(function(y){return y=Vn(y,Zr(jt())),Gt(function(_){var O=this;return m(y,function(H){return Ur(H,O,_)})})})}function Zu(m,y){y=y===t?" ":mi(y);var _=y.length;if(_<2)return _?Np(y,m):y;var O=Np(y,Cc(m/Ji(y)));return wa(y)?Co(ci(O),0,m).join(""):O.slice(0,m)}function Vg(m,y,_,O){var H=y&T,ne=na(m);function ye(){for(var Ne=-1,Pe=arguments.length,Xe=-1,et=O.length,tt=Ue(et+Pe),pt=this&&this!==qn&&this instanceof ye?ne:m;++Xe<et;)tt[Xe]=O[Xe];for(;Pe--;)tt[Xe++]=arguments[++Ne];return Ur(pt,H?_:this,tt)}return ye}function jo(m){return function(y,_,O){return O&&typeof O!="number"&&ai(y,_,O)&&(_=O=t),y=ss(y),_===t?(_=y,y=0):_=ss(_),O=O===t?y<_?1:-1:ss(O),Ig(y,_,O,m)}}function Fl(m){return function(y,_){return typeof y=="string"&&typeof _=="string"||(y=sa(y),_=sa(_)),m(y,_)}}function Dp(m,y,_,O,H,ne,ye,Ne,Pe,Xe){var et=y&I,tt=et?ye:t,pt=et?t:ye,xt=et?ne:t,Lt=et?t:ne;y|=et?L:$,y&=~(et?$:L),y&M||(y&=-4);var tn=[m,y,H,xt,tt,Lt,pt,Ne,Pe,Xe],Ft=_.apply(t,tn);return Mf(m)&&Ff(Ft,tn),Ft.placeholder=O,$f(Ft,m,y)}function kf(m){var y=lr[m];return function(_,O){if(_=sa(_),O=O==null?0:er(Vt(O),292),O&&Eu(_)){var H=(Tn(_)+"e").split("e"),ne=y(H[0]+"e"+(+H[1]+O));return H=(Tn(ne)+"e").split("e"),+(H[0]+"e"+(+H[1]-O))}return y(_)}}var Hg=on&&1/vl(new on([,-0]))[1]==se?function(m){return new on(m)}:gt;function ed(m){return function(y){var _=Dr(y);return _==Fe?bl(y):_==je?Zh(y):Xh(y,m(y))}}function ts(m,y,_,O,H,ne,ye,Ne){var Pe=y&P;if(!Pe&&typeof m!="function")throw new ti(l);var Xe=O?O.length:0;if(Xe||(y&=-97,O=H=t),ye=ye===t?ye:Qn(Vt(ye),0),Ne=Ne===t?Ne:Vt(Ne),Xe-=H?H.length:0,y&$){var et=O,tt=H;O=H=t}var pt=Pe?t:Pf(m),xt=[m,y,_,O,H,et,tt,ne,ye,Ne];if(pt&&ad(xt,pt),m=xt[0],y=xt[1],_=xt[2],O=xt[3],H=xt[4],Ne=xt[9]=xt[9]===t?Pe?0:m.length:Qn(xt[9]-Xe,0),!Ne&&y&(I|U)&&(y&=-25),!y||y==T)var Lt=Bg(m,y,_);else y==I||y==U?Lt=qg(m,y,Ne):(y==L||y==(T|L))&&!H.length?Lt=Vg(m,y,_,O):Lt=ur.apply(t,xt);var tn=pt?Bu:Ff;return $f(tn(Lt,xt),m,y)}function Tf(m,y,_,O){return m===t||vi(m,Ns[_])&&!ee.call(O,_)?y:m}function Ip(m,y,_,O,H,ne){return rr(m)&&rr(y)&&(ne.set(y,m),Uu(m,y,t,Ip,ne),ne.delete(y)),m}function Gg(m){return aa(m)?t:m}function Yg(m,y,_,O,H,ne){var ye=_&S,Ne=m.length,Pe=y.length;if(Ne!=Pe&&!(ye&&Pe>Ne))return!1;var Xe=ne.get(m),et=ne.get(y);if(Xe&&et)return Xe==y&&et==m;var tt=-1,pt=!0,xt=_&k?new ks:t;for(ne.set(m,y),ne.set(y,m);++tt<Ne;){var Lt=m[tt],tn=y[tt];if(O)var Ft=ye?O(tn,Lt,tt,y,m,ne):O(Lt,tn,tt,m,y,ne);if(Ft!==t){if(Ft)continue;pt=!1;break}if(xt){if(!Ha(y,function(hn,Nn){if(!ho(xt,Nn)&&(Lt===hn||H(Lt,hn,_,O,ne)))return xt.push(Nn)})){pt=!1;break}}else if(!(Lt===tn||H(Lt,tn,_,O,ne))){pt=!1;break}}return ne.delete(m),ne.delete(y),pt}function Wg(m,y,_,O,H,ne,ye){switch(_){case Ve:if(m.byteLength!=y.byteLength||m.byteOffset!=y.byteOffset)return!1;m=m.buffer,y=y.buffer;case me:return!(m.byteLength!=y.byteLength||!ne(new Br(m),new Br(y)));case ae:case Me:case rt:return vi(+m,+y);case Z:return m.name==y.name&&m.message==y.message;case rn:case qe:return m==y+"";case Fe:var Ne=bl;case je:var Pe=O&S;if(Ne||(Ne=vl),m.size!=y.size&&!Pe)return!1;var Xe=ye.get(m);if(Xe)return Xe==y;O|=k,ye.set(m,y);var et=Yg(Ne(m),Ne(y),O,H,ne,ye);return ye.delete(m),et;case Be:if(_l)return _l.call(m)==_l.call(y)}return!1}function Pr(m,y,_,O,H,ne){var ye=_&S,Ne=Ef(m),Pe=Ne.length,Xe=Ef(y),et=Xe.length;if(Pe!=et&&!ye)return!1;for(var tt=Pe;tt--;){var pt=Ne[tt];if(!(ye?pt in y:ee.call(y,pt)))return!1}var xt=ne.get(m),Lt=ne.get(y);if(xt&&Lt)return xt==y&&Lt==m;var tn=!0;ne.set(m,y),ne.set(y,m);for(var Ft=ye;++tt<Pe;){pt=Ne[tt];var hn=m[pt],Nn=y[pt];if(O)var Ea=ye?O(Nn,hn,pt,y,m,ne):O(hn,Nn,pt,m,y,ne);if(!(Ea===t?hn===Nn||H(hn,Nn,_,O,ne):Ea)){tn=!1;break}Ft||(Ft=pt=="constructor")}if(tn&&!Ft){var Ui=m.constructor,Aa=y.constructor;Ui!=Aa&&"constructor"in m&&"constructor"in y&&!(typeof Ui=="function"&&Ui instanceof Ui&&typeof Aa=="function"&&Aa instanceof Aa)&&(tn=!1)}return ne.delete(m),ne.delete(y),tn}function Jn(m){return sd(Fp(m,t,xi),m+"")}function Ef(m){return kg(m,kr,nd)}function Af(m){return kg(m,Ir,If)}var Pf=jc?function(m){return jc.get(m)}:gt;function td(m){for(var y=m.name+"",_=Zi[y],O=ee.call(Zi,y)?_.length:0;O--;){var H=_[O],ne=H.func;if(ne==null||ne==m)return H.name}return y}function $l(m){var y=ee.call(J,"placeholder")?J:m;return y.placeholder}function jt(){var m=J.iteratee||Dt;return m=m===Dt?yp:m,arguments.length?m(arguments[0],arguments[1]):m}function Rc(m,y){var _=m.__data__;return Rs(y)?_[typeof y=="string"?"string":"hash"]:_.map}function Df(m){for(var y=kr(m),_=y.length;_--;){var O=y[_],H=m[O];y[_]=[O,H,Xg(H)]}return y}function _o(m,y){var _=wc(m,y);return Za(_)?_:t}function Qg(m){var y=ee.call(m,ni),_=m[ni];try{m[ni]=t;var O=!0}catch{}var H=Se.call(m);return O&&(y?m[ni]=_:delete m[ni]),H}var nd=xo?function(m){return m==null?[]:(m=dn(m),Xr(xo(m),function(y){return Sl.call(m,y)}))}:Rv,If=xo?function(m){for(var y=[];m;)Wi(y,nd(m)),m=_u(m);return y}:Rv,Dr=fn;(Au&&Dr(new Au(new ArrayBuffer(1)))!=Ve||Sr&&Dr(new Sr)!=Fe||tr&&Dr(tr.resolve())!=st||on&&Dr(new on)!=je||Sa&&Dr(new Sa)!=we)&&(Dr=function(m){var y=fn(m),_=y==ct?m.constructor:t,O=_?Ms(_):"";if(O)switch(O){case mg:return Ve;case gg:return Fe;case Pu:return st;case Du:return je;case yg:return we}return y});function Jg(m,y,_){for(var O=-1,H=_.length;++O<H;){var ne=_[O],ye=ne.size;switch(ne.type){case"drop":m+=ye;break;case"dropRight":y-=ye;break;case"take":y=er(y,m+ye);break;case"takeRight":m=Qn(m,y-ye);break}}return{start:m,end:y}}function Rp(m){var y=m.match(Qh);return y?y[1].split(el):[]}function rd(m,y,_){y=Ps(y,m);for(var O=-1,H=y.length,ne=!1;++O<H;){var ye=En(y[O]);if(!(ne=m!=null&&_(m,ye)))break;m=m[ye]}return ne||++O!=H?ne:(H=m==null?0:m.length,!!H&&Bl(H)&&_a(ye,H)&&(zt(m)||$s(m)))}function Mp(m){var y=m.length,_=new m.constructor(y);return y&&typeof m[0]=="string"&&ee.call(m,"index")&&(_.index=m.index,_.input=m.input),_}function Op(m){return typeof m.constructor=="function"&&!zn(m)?Ri(_u(m)):{}}function Lp(m,y,_){var O=m.constructor;switch(y){case me:return Rl(m);case ae:case Me:return new O(+m);case Ve:return Tp(m,_);case Qe:case ot:case kt:case qt:case be:case ge:case Te:case De:case ze:return Ep(m,_);case Fe:return new O;case rt:case qe:return new O(m);case rn:return jf(m);case je:return new O;case Be:return $g(m)}}function Kg(m,y){var _=y.length;if(!_)return m;var O=_-1;return y[O]=(_>1?"& ":"")+y[O],y=y.join(_>2?", ":" "),m.replace(bu,`{
/* [wrapped with `+y+`] */
`)}function Is(m){return zt(m)||$s(m)||!!(ui&&m&&m[ui])}function _a(m,y){var _=typeof m;return y=y??re,!!y&&(_=="number"||_!="symbol"&&ps.test(m))&&m>-1&&m%1==0&&m<y}function ai(m,y,_){if(!rr(_))return!1;var O=typeof y;return(O=="number"?jr(_)&&_a(y,_.length):O=="string"&&y in _)?vi(_[y],m):!1}function Rf(m,y){if(zt(m))return!1;var _=typeof m;return _=="number"||_=="symbol"||_=="boolean"||m==null||si(m)?!0:Hi.test(m)||!Wn.test(m)||y!=null&&m in dn(y)}function Rs(m){var y=typeof m;return y=="string"||y=="number"||y=="symbol"||y=="boolean"?m!=="__proto__":m===null}function Mf(m){var y=td(m),_=J[y];if(typeof _!="function"||!(y in Zt.prototype))return!1;if(m===_)return!0;var O=Pf(_);return!!O&&m===O[0]}function Of(m){return!!de&&de in m}var id=go?ka:Mv;function zn(m){var y=m&&m.constructor,_=typeof y=="function"&&y.prototype||Ns;return m===_}function Xg(m){return m===m&&!rr(m)}function Zg(m,y){return function(_){return _==null?!1:_[m]===y&&(y!==t||m in dn(_))}}function ey(m){var y=gd(m,function(O){return _.size===u&&_.clear(),O}),_=y.cache;return y}function ad(m,y){var _=m[1],O=y[1],H=_|O,ne=H<(T|P|z),ye=O==z&&_==I||O==z&&_==F&&m[7].length<=y[8]||O==(z|F)&&y[7].length<=y[8]&&_==I;if(!(ne||ye))return m;O&T&&(m[2]=y[2],H|=_&T?0:M);var Ne=y[3];if(Ne){var Pe=m[3];m[3]=Pe?Ap(Pe,Ne,y[4]):Ne,m[4]=Pe?Qa(m[3],p):y[4]}return Ne=y[5],Ne&&(Pe=m[5],m[5]=Pe?Ug(Pe,Ne,y[6]):Ne,m[6]=Pe?Qa(m[5],p):y[6]),Ne=y[7],Ne&&(m[7]=Ne),O&z&&(m[8]=m[8]==null?y[8]:er(m[8],y[8])),m[9]==null&&(m[9]=y[9]),m[0]=y[0],m[1]=H,m}function ko(m){var y=[];if(m!=null)for(var _ in dn(m))y.push(_);return y}function ty(m){return Se.call(m)}function Fp(m,y,_){return y=Qn(y===t?m.length-1:y,0),function(){for(var O=arguments,H=-1,ne=Qn(O.length-y,0),ye=Ue(ne);++H<ne;)ye[H]=O[y+H];H=-1;for(var Ne=Ue(y+1);++H<y;)Ne[H]=O[H];return Ne[y]=_(ye),Ur(m,this,Ne)}}function Mc(m,y){return y.length<2?m:ta(m,Mi(y,0,-1))}function ns(m,y){for(var _=m.length,O=er(y.length,_),H=Nr(m);O--;){var ne=y[O];m[O]=_a(ne,_)?H[ne]:t}return m}function Lf(m,y){if(!(y==="constructor"&&typeof m[y]=="function")&&y!="__proto__")return m[y]}var Ff=od(Bu),Oc=rp||function(m,y){return qn.setTimeout(m,y)},sd=od(qu);function $f(m,y,_){var O=y+"";return sd(m,Kg(O,ny(Rp(O),_)))}function od(m){var y=0,_=0;return function(){var O=_s(),H=ie-(O-_);if(_=O,H>0){if(++y>=G)return arguments[0]}else y=0;return m.apply(t,arguments)}}function ld(m,y){var _=-1,O=m.length,H=O-1;for(y=y===t?O:y;++_<y;){var ne=vf(_,H),ye=m[ne];m[ne]=m[_],m[_]=ye}return m.length=y,m}var rs=ey(function(m){var y=[];return m.charCodeAt(0)===46&&y.push(""),m.replace(br,function(_,O,H,ne){y.push(H?ne.replace(hs,"$1"):O||_)}),y});function En(m){if(typeof m=="string"||si(m))return m;var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function Ms(m){if(m!=null){try{return yo.call(m)}catch{}try{return m+""}catch{}}return""}function ny(m,y){return wr(ce,function(_){var O="_."+_[0];y&_[1]&&!ba(m,O)&&m.push(O)}),m.sort()}function Cr(m){if(m instanceof Zt)return m.clone();var y=new fi(m.__wrapped__,m.__chain__);return y.__actions__=Nr(m.__actions__),y.__index__=m.__index__,y.__values__=m.__values__,y}function Xb(m,y,_){(_?ai(m,y,_):y===t)?y=1:y=Qn(Vt(y),0);var O=m==null?0:m.length;if(!O||y<1)return[];for(var H=0,ne=0,ye=Ue(Cc(O/y));H<O;)ye[ne++]=Mi(m,H,H+=y);return ye}function ry(m){for(var y=-1,_=m==null?0:m.length,O=0,H=[];++y<_;){var ne=m[y];ne&&(H[O++]=ne)}return H}function iy(){var m=arguments.length;if(!m)return[];for(var y=Ue(m-1),_=arguments[0],O=m;O--;)y[O-1]=arguments[O];return Wi(zt(_)?Nr(_):[_],ln(y,1))}var nr=Gt(function(m,y){return fr(m)?So(m,ln(y,1,fr,!0)):[]}),yi=Gt(function(m,y){var _=Hr(y);return fr(_)&&(_=t),fr(m)?So(m,ln(y,1,fr,!0),jt(_,2)):[]}),Os=Gt(function(m,y){var _=Hr(y);return fr(_)&&(_=t),fr(m)?So(m,ln(y,1,fr,!0),t,_):[]});function ay(m,y,_){var O=m==null?0:m.length;return O?(y=_||y===t?1:Vt(y),Mi(m,y<0?0:y,O)):[]}function sy(m,y,_){var O=m==null?0:m.length;return O?(y=_||y===t?1:Vt(y),y=O-y,Mi(m,0,y<0?0:y)):[]}function Zb(m,y){return m&&m.length?Gu(m,jt(y,3),!0,!0):[]}function $p(m,y){return m&&m.length?Gu(m,jt(y,3),!0):[]}function Li(m,y,_,O){var H=m==null?0:m.length;return H?(_&&typeof _!="number"&&ai(m,y,_)&&(_=0,O=H),Jt(m,y,_,O)):[]}function ra(m,y,_){var O=m==null?0:m.length;if(!O)return-1;var H=_==null?0:Vt(_);return H<0&&(H=Qn(O+H,0)),Ga(m,jt(y,3),H)}function zp(m,y,_){var O=m==null?0:m.length;if(!O)return-1;var H=O-1;return _!==t&&(H=Vt(_),H=_<0?Qn(O+H,0):er(H,O-1)),Ga(m,jt(y,3),H,!0)}function xi(m){var y=m==null?0:m.length;return y?ln(m,1):[]}function oy(m){var y=m==null?0:m.length;return y?ln(m,se):[]}function To(m,y){var _=m==null?0:m.length;return _?(y=y===t?1:Vt(y),ln(m,y)):[]}function zl(m){for(var y=-1,_=m==null?0:m.length,O={};++y<_;){var H=m[y];O[H[0]]=H[1]}return O}function Ls(m){return m&&m.length?m[0]:t}function Up(m,y,_){var O=m==null?0:m.length;if(!O)return-1;var H=_==null?0:Vt(_);return H<0&&(H=Qn(O+H,0)),fo(m,y,H)}function Bp(m){var y=m==null?0:m.length;return y?Mi(m,0,-1):[]}var is=Gt(function(m){var y=Vn(m,Cf);return y.length&&y[0]===m[0]?hp(y):[]}),ly=Gt(function(m){var y=Hr(m),_=Vn(m,Cf);return y===Hr(_)?y=t:_.pop(),_.length&&_[0]===m[0]?hp(_,jt(y,2)):[]}),Lc=Gt(function(m){var y=Hr(m),_=Vn(m,Cf);return y=typeof y=="function"?y:t,y&&_.pop(),_.length&&_[0]===m[0]?hp(_,t,y):[]});function cd(m,y){return m==null?"":Ki.call(m,y)}function Hr(m){var y=m==null?0:m.length;return y?m[y-1]:t}function Fc(m,y,_){var O=m==null?0:m.length;if(!O)return-1;var H=O;return _!==t&&(H=Vt(_),H=H<0?Qn(O+H,0):er(H,O-1)),y===y?ei(m,y,H):Ga(m,ws,H,!0)}function cy(m,y){return m&&m.length?vp(m,Vt(y)):t}var uy=Gt($c);function $c(m,y){return m&&m.length&&y&&y.length?bf(m,y):m}function dy(m,y,_){return m&&m.length&&y&&y.length?bf(m,y,jt(_,2)):m}function zf(m,y,_){return m&&m.length&&y&&y.length?bf(m,y,t,_):m}var fy=Jn(function(m,y){var _=m==null?0:m.length,O=Lu(m,y);return Sp(m,Vn(y,function(H){return _a(H,_)?+H:H}).sort(Qu)),O});function ev(m,y){var _=[];if(!(m&&m.length))return _;var O=-1,H=[],ne=m.length;for(y=jt(y,3);++O<ne;){var ye=m[O];y(ye,O,m)&&(_.push(ye),H.push(O))}return Sp(m,H),_}function qp(m){return m==null?m:ap.call(m)}function Pn(m,y,_){var O=m==null?0:m.length;return O?(_&&typeof _!="number"&&ai(m,y,_)?(y=0,_=O):(y=y==null?0:Vt(y),_=_===t?O:Vt(_)),Mi(m,y,_)):[]}function Gn(m,y){return Vu(m,y)}function an(m,y,_){return Sf(m,y,jt(_,2))}function bn(m,y){var _=m==null?0:m.length;if(_){var O=Vu(m,y);if(O<_&&vi(m[O],y))return O}return-1}function Dn(m,y){return Vu(m,y,!0)}function Fi(m,y,_){return Sf(m,y,jt(_,2),!0)}function Eo(m,y){var _=m==null?0:m.length;if(_){var O=Vu(m,y,!0)-1;if(vi(m[O],y))return O}return-1}function zc(m){return m&&m.length?Cp(m):[]}function Vp(m,y){return m&&m.length?Cp(m,jt(y,2)):[]}function Fs(m){var y=m==null?0:m.length;return y?Mi(m,1,y):[]}function dr(m,y,_){return m&&m.length?(y=_||y===t?1:Vt(y),Mi(m,0,y<0?0:y)):[]}function Ao(m,y,_){var O=m==null?0:m.length;return O?(y=_||y===t?1:Vt(y),y=O-y,Mi(m,y<0?0:y,O)):[]}function Ul(m,y){return m&&m.length?Gu(m,jt(y,3),!1,!0):[]}function Hp(m,y){return m&&m.length?Gu(m,jt(y,3)):[]}var ia=Gt(function(m){return As(ln(m,1,fr,!0))}),Uc=Gt(function(m){var y=Hr(m);return fr(y)&&(y=t),As(ln(m,1,fr,!0),jt(y,2))}),ud=Gt(function(m){var y=Hr(m);return y=typeof y=="function"?y:t,As(ln(m,1,fr,!0),t,y)});function bi(m){return m&&m.length?As(m):[]}function Gp(m,y){return m&&m.length?As(m,jt(y,2)):[]}function Yp(m,y){return y=typeof y=="function"?y:t,m&&m.length?As(m,t,y):[]}function Bc(m){if(!(m&&m.length))return[];var y=0;return m=Xr(m,function(_){if(fr(_))return y=Qn(_.length,y),!0}),Ya(y,function(_){return Vn(m,yl(_))})}function dd(m,y){if(!(m&&m.length))return[];var _=Bc(m);return y==null?_:Vn(_,function(O){return Ur(y,t,O)})}var Po=Gt(function(m,y){return fr(m)?So(m,y):[]}),$r=Gt(function(m){return Yu(Xr(m,fr))}),Do=Gt(function(m){var y=Hr(m);return fr(y)&&(y=t),Yu(Xr(m,fr),jt(y,2))}),qc=Gt(function(m){var y=Hr(m);return y=typeof y=="function"?y:t,Yu(Xr(m,fr),t,y)}),Vc=Gt(Bc);function Wp(m,y){return _p(m||[],y||[],El)}function Qp(m,y){return _p(m||[],y||[],Dc)}var hy=Gt(function(m){var y=m.length,_=y>1?m[y-1]:t;return _=typeof _=="function"?(m.pop(),_):t,dd(m,_)});function Hc(m){var y=J(m);return y.__chain__=!0,y}function Jp(m,y){return y(m),m}function Gr(m,y){return y(m)}var py=Jn(function(m){var y=m.length,_=y?m[0]:0,O=this.__wrapped__,H=function(ne){return Lu(ne,m)};return y>1||this.__actions__.length||!(O instanceof Zt)||!_a(_)?this.thru(H):(O=O.slice(_,+_+(y?1:0)),O.__actions__.push({func:Gr,args:[H],thisArg:t}),new fi(O,this.__chain__).thru(function(ne){return y&&!ne.length&&ne.push(t),ne}))});function $i(){return Hc(this)}function my(){return new fi(this.value(),this.__chain__)}function gy(){this.__values__===t&&(this.__values__=zi(this.value()));var m=this.__index__>=this.__values__.length,y=m?t:this.__values__[this.__index__++];return{done:m,value:y}}function tv(){return this}function Io(m){for(var y,_=this;_ instanceof ea;){var O=Cr(_);O.__index__=0,O.__values__=t,y?H.__wrapped__=O:y=O;var H=O;_=_.__wrapped__}return H.__wrapped__=m,y}function Uf(){var m=this.__wrapped__;if(m instanceof Zt){var y=m;return this.__actions__.length&&(y=new Zt(this)),y=y.reverse(),y.__actions__.push({func:Gr,args:[qp],thisArg:t}),new fi(y,this.__chain__)}return this.thru(qp)}function Kp(){return Og(this.__wrapped__,this.__actions__)}var Gc=Ml(function(m,y,_){ee.call(m,_)?++m[_]:Na(m,_,1)});function yy(m,y,_){var O=zt(m)?yc:dp;return _&&ai(m,y,_)&&(y=t),O(m,jt(y,3))}function xy(m,y){var _=zt(m)?Xr:An;return _(m,jt(y,3))}var by=Ds(ra),Xp=Ds(zp);function Zp(m,y){return ln(fd(m,y),1)}function nv(m,y){return ln(fd(m,y),se)}function rv(m,y,_){return _=_===t?1:Vt(_),ln(fd(m,y),_)}function vy(m,y){var _=zt(m)?wr:Es;return _(m,jt(y,3))}function em(m,y){var _=zt(m)?Jd:df;return _(m,jt(y,3))}var wy=Ml(function(m,y,_){ee.call(m,_)?m[_].push(y):Na(m,_,[y])});function Yc(m,y,_,O){m=jr(m)?m:eu(m),_=_&&!O?Vt(_):0;var H=m.length;return _<0&&(_=Qn(H+_,0)),Zf(m)?_<=H&&m.indexOf(y,_)>-1:!!H&&fo(m,y,_)>-1}var Bf=Gt(function(m,y,_){var O=-1,H=typeof y=="function",ne=jr(m)?Ue(m.length):[];return Es(m,function(ye){ne[++O]=H?Ur(y,ye,_):Dl(ye,y,_)}),ne}),Sy=Ml(function(m,y,_){Na(m,_,y)});function fd(m,y){var _=zt(m)?Vn:xp;return _(m,jt(y,3))}function Ny(m,y,_,O){return m==null?[]:(zt(y)||(y=y==null?[]:[y]),_=O?t:_,zt(_)||(_=_==null?[]:[_]),wp(m,y,_))}var Cy=Ml(function(m,y,_){m[_?0:1].push(y)},function(){return[[],[]]});function jy(m,y,_){var O=zt(m)?bs:wu,H=arguments.length<3;return O(m,jt(y,4),_,H,Es)}function _y(m,y,_){var O=zt(m)?Jh:wu,H=arguments.length<3;return O(m,jt(y,4),_,H,df)}function qf(m,y){var _=zt(m)?Xr:An;return _(m,yd(jt(y,3)))}function ky(m){var y=zt(m)?kc:Pc;return y(m)}function Ty(m,y,_){(_?ai(m,y,_):y===t)?y=1:y=Vt(y);var O=zt(m)?Cg:wf;return O(m,y)}function Un(m){var y=zt(m)?jg:Rg;return y(m)}function tm(m){if(m==null)return 0;if(jr(m))return Zf(m)?Ji(m):m.length;var y=Dr(m);return y==Fe||y==je?m.size:mf(m).length}function iv(m,y,_){var O=zt(m)?Ha:Mg;return _&&ai(m,y,_)&&(y=t),O(m,jt(y,3))}var Ey=Gt(function(m,y){if(m==null)return[];var _=y.length;return _>1&&ai(m,y[0],y[1])?y=[]:_>2&&ai(y[0],y[1],y[2])&&(y=[y[0]]),wp(m,ln(y,1),[])}),Vf=Cl||function(){return qn.Date.now()};function av(m,y){if(typeof y!="function")throw new ti(l);return m=Vt(m),function(){if(--m<1)return y.apply(this,arguments)}}function Ay(m,y,_){return y=_?t:y,y=m&&y==null?m.length:y,ts(m,z,t,t,t,t,y)}function hd(m,y){var _;if(typeof y!="function")throw new ti(l);return m=Vt(m),function(){return--m>0&&(_=y.apply(this,arguments)),m<=1&&(y=t),_}}var Ro=Gt(function(m,y,_){var O=T;if(_.length){var H=Qa(_,$l(Ro));O|=L}return ts(m,O,y,_,H)}),Hf=Gt(function(m,y,_){var O=T|P;if(_.length){var H=Qa(_,$l(Hf));O|=L}return ts(y,O,m,_,H)});function pd(m,y,_){y=_?t:y;var O=ts(m,I,t,t,t,t,t,y);return O.placeholder=pd.placeholder,O}function Gf(m,y,_){y=_?t:y;var O=ts(m,U,t,t,t,t,t,y);return O.placeholder=Gf.placeholder,O}function Mo(m,y,_){var O,H,ne,ye,Ne,Pe,Xe=0,et=!1,tt=!1,pt=!0;if(typeof m!="function")throw new ti(l);y=sa(y)||0,rr(_)&&(et=!!_.leading,tt="maxWait"in _,ne=tt?Qn(sa(_.maxWait)||0,y):ne,pt="trailing"in _?!!_.trailing:pt);function xt(Tr){var Us=O,ql=H;return O=H=t,Xe=Tr,ye=m.apply(ql,Us),ye}function Lt(Tr){return Xe=Tr,Ne=Oc(hn,y),et?xt(Tr):ye}function tn(Tr){var Us=Tr-Pe,ql=Tr-Xe,sS=y-Us;return tt?er(sS,ne-ql):sS}function Ft(Tr){var Us=Tr-Pe,ql=Tr-Xe;return Pe===t||Us>=y||Us<0||tt&&ql>=ne}function hn(){var Tr=Vf();if(Ft(Tr))return Nn(Tr);Ne=Oc(hn,tn(Tr))}function Nn(Tr){return Ne=t,pt&&O?xt(Tr):(O=H=t,ye)}function Ea(){Ne!==t&&Fg(Ne),Xe=0,O=Pe=H=Ne=t}function Ui(){return Ne===t?ye:Nn(Vf())}function Aa(){var Tr=Vf(),Us=Ft(Tr);if(O=arguments,H=this,Pe=Tr,Us){if(Ne===t)return Lt(Pe);if(tt)return Fg(Ne),Ne=Oc(hn,y),xt(Pe)}return Ne===t&&(Ne=Oc(hn,y)),ye}return Aa.cancel=Ea,Aa.flush=Ui,Aa}var as=Gt(function(m,y){return Al(m,1,y)}),md=Gt(function(m,y,_){return Al(m,sa(y)||0,_)});function sv(m){return ts(m,Y)}function gd(m,y){if(typeof m!="function"||y!=null&&typeof y!="function")throw new ti(l);var _=function(){var O=arguments,H=y?y.apply(this,O):O[0],ne=_.cache;if(ne.has(H))return ne.get(H);var ye=m.apply(this,O);return _.cache=ne.set(H,ye)||ne,ye};return _.cache=new(gd.Cache||hi),_}gd.Cache=hi;function yd(m){if(typeof m!="function")throw new ti(l);return function(){var y=arguments;switch(y.length){case 0:return!m.call(this);case 1:return!m.call(this,y[0]);case 2:return!m.call(this,y[0],y[1]);case 3:return!m.call(this,y[0],y[1],y[2])}return!m.apply(this,y)}}function Py(m){return hd(2,m)}var Dy=Lg(function(m,y){y=y.length==1&&zt(y[0])?Vn(y[0],Zr(jt())):Vn(ln(y,1),Zr(jt()));var _=y.length;return Gt(function(O){for(var H=-1,ne=er(O.length,_);++H<ne;)O[H]=y[H].call(this,O[H]);return Ur(m,this,O)})}),nm=Gt(function(m,y){var _=Qa(y,$l(nm));return ts(m,L,t,y,_)}),Yf=Gt(function(m,y){var _=Qa(y,$l(Yf));return ts(m,$,t,y,_)}),Iy=Jn(function(m,y){return ts(m,F,t,t,t,y)});function Ry(m,y){if(typeof m!="function")throw new ti(l);return y=y===t?y:Vt(y),Gt(m,y)}function ov(m,y){if(typeof m!="function")throw new ti(l);return y=y==null?0:Qn(Vt(y),0),Gt(function(_){var O=_[y],H=Co(_,0,y);return O&&Wi(H,O),Ur(m,this,H)})}function rm(m,y,_){var O=!0,H=!0;if(typeof m!="function")throw new ti(l);return rr(_)&&(O="leading"in _?!!_.leading:O,H="trailing"in _?!!_.trailing:H),Mo(m,y,{leading:O,maxWait:y,trailing:H})}function im(m){return Ay(m,1)}function lv(m,y){return nm(Wu(y),m)}function cv(){if(!arguments.length)return[];var m=arguments[0];return zt(m)?m:[m]}function xd(m){return qr(m,v)}function uv(m,y){return y=typeof y=="function"?y:t,qr(m,v,y)}function My(m){return qr(m,g|v)}function sn(m,y){return y=typeof y=="function"?y:t,qr(m,g|v,y)}function am(m,y){return y==null||up(m,y,kr(y))}function vi(m,y){return m===y||m!==m&&y!==y}var sm=Fl(Fu),Oy=Fl(function(m,y){return m>=y}),$s=ff(function(){return arguments}())?ff:function(m){return or(m)&&ee.call(m,"callee")&&!Sl.call(m,"callee")},zt=Ue.isArray,Wf=wn?Zr(wn):pi;function jr(m){return m!=null&&Bl(m.length)&&!ka(m)}function fr(m){return or(m)&&jr(m)}function dv(m){return m===!0||m===!1||or(m)&&fn(m)==ae}var Oo=af||Mv,Ly=mc?Zr(mc):gr;function Fy(m){return or(m)&&m.nodeType===1&&!aa(m)}function Qf(m){if(m==null)return!0;if(jr(m)&&(zt(m)||typeof m=="string"||typeof m.splice=="function"||Oo(m)||Wc(m)||$s(m)))return!m.length;var y=Dr(m);if(y==Fe||y==je)return!m.size;if(zn(m))return!mf(m).length;for(var _ in m)if(ee.call(m,_))return!1;return!0}function On(m,y){return Il(m,y)}function om(m,y,_){_=typeof _=="function"?_:t;var O=_?_(m,y):t;return O===t?Il(m,y,t,_):!!O}function _r(m){if(!or(m))return!1;var y=fn(m);return y==Z||y==Ke||typeof m.message=="string"&&typeof m.name=="string"&&!aa(m)}function fv(m){return typeof m=="number"&&Eu(m)}function ka(m){if(!rr(m))return!1;var y=fn(m);return y==Ee||y==Ie||y==fe||y==Ht}function Jf(m){return typeof m=="number"&&m==Vt(m)}function Bl(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=re}function rr(m){var y=typeof m;return m!=null&&(y=="object"||y=="function")}function or(m){return m!=null&&typeof m=="object"}var Kf=pl?Zr(pl):hf;function lm(m,y){return m===y||zu(m,y,Df(y))}function hv(m,y,_){return _=typeof _=="function"?_:t,zu(m,y,Df(y),_)}function $y(m){return Uy(m)&&m!=+m}function pv(m){if(id(m))throw new At(o);return Za(m)}function zy(m){return m===null}function mv(m){return m==null}function Uy(m){return typeof m=="number"||or(m)&&fn(m)==rt}function aa(m){if(!or(m)||fn(m)!=ct)return!1;var y=_u(m);if(y===null)return!0;var _=ee.call(y,"constructor")&&y.constructor;return typeof _=="function"&&_ instanceof _&&yo.call(_)==Ye}var Xf=gc?Zr(gc):pf;function cm(m){return Jf(m)&&m>=-9007199254740991&&m<=re}var By=lo?Zr(lo):mp;function Zf(m){return typeof m=="string"||!zt(m)&&or(m)&&fn(m)==qe}function si(m){return typeof m=="symbol"||or(m)&&fn(m)==Be}var Wc=co?Zr(co):gp;function Ta(m){return m===t}function um(m){return or(m)&&Dr(m)==we}function qy(m){return or(m)&&fn(m)==Q}var Vy=Fl(gf),bd=Fl(function(m,y){return m<=y});function zi(m){if(!m)return[];if(jr(m))return Zf(m)?ci(m):Nr(m);if(Nl&&m[Nl])return mo(m[Nl]());var y=Dr(m),_=y==Fe?bl:y==je?vl:eu;return _(m)}function ss(m){if(!m)return m===0?m:0;if(m=sa(m),m===se||m===-1/0){var y=m<0?-1:1;return y*oe}return m===m?m:0}function Vt(m){var y=ss(m),_=y%1;return y===y?_?y-_:y:0}function os(m){return m?Ca(Vt(m),0,le):0}function sa(m){if(typeof m=="number")return m;if(si(m))return E;if(rr(m)){var y=typeof m.valueOf=="function"?m.valueOf():m;m=rr(y)?y+"":y}if(typeof m!="string")return m===0?m:+m;m=Zd(m);var _=mr.test(m);return _||Hd.test(m)?Wd(m.slice(2),_?2:8):Xs.test(m)?E:+m}function Hy(m){return gi(m,Ir(m))}function Qc(m){return m?Ca(Vt(m),-9007199254740991,re):m===0?m:0}function Tn(m){return m==null?"":mi(m)}var gv=Ol(function(m,y){if(zn(y)||jr(y)){gi(y,kr(y),m);return}for(var _ in y)ee.call(y,_)&&El(m,_,y[_])}),Gy=Ol(function(m,y){gi(y,Ir(y),m)}),eh=Ol(function(m,y,_,O){gi(y,Ir(y),m,O)}),yv=Ol(function(m,y,_,O){gi(y,kr(y),m,O)}),xv=Jn(Lu);function bv(m,y){var _=Ri(m);return y==null?_:Ts(_,y)}var vv=Gt(function(m,y){m=dn(m);var _=-1,O=y.length,H=O>2?y[2]:t;for(H&&ai(y[0],y[1],H)&&(O=1);++_<O;)for(var ne=y[_],ye=Ir(ne),Ne=-1,Pe=ye.length;++Ne<Pe;){var Xe=ye[Ne],et=m[Xe];(et===t||vi(et,Ns[Xe])&&!ee.call(m,Xe))&&(m[Xe]=ne[Xe])}return m}),Yy=Gt(function(m){return m.push(t,Ip),Ur(Nd,t,m)});function Jc(m,y){return vs(m,jt(y,3),Vr)}function vd(m,y){return vs(m,jt(y,3),Ac)}function Wy(m,y){return m==null?m:Ec(m,jt(y,3),Ir)}function wv(m,y){return m==null?m:Pl(m,jt(y,3),Ir)}function Kc(m,y){return m&&Vr(m,jt(y,3))}function wd(m,y){return m&&Ac(m,jt(y,3))}function Qy(m){return m==null?[]:No(m,kr(m))}function th(m){return m==null?[]:No(m,Ir(m))}function Sd(m,y,_){var O=m==null?t:ta(m,y);return O===t?_:O}function dm(m,y){return m!=null&&rd(m,y,fp)}function Xc(m,y){return m!=null&&rd(m,y,Tg)}var Jy=Ku(function(m,y,_){y!=null&&typeof y.toString!="function"&&(y=Se.call(y)),m[y]=_},Oe(Le)),Ky=Ku(function(m,y,_){y!=null&&typeof y.toString!="function"&&(y=Se.call(y)),ee.call(m,y)?m[y].push(_):m[y]=[_]},jt),Sv=Gt(Dl);function kr(m){return jr(m)?cp(m):mf(m)}function Ir(m){return jr(m)?cp(m,!0):Ag(m)}function Nv(m,y){var _={};return y=jt(y,3),Vr(m,function(O,H,ne){Na(_,y(O,H,ne),O)}),_}function Cv(m,y){var _={};return y=jt(y,3),Vr(m,function(O,H,ne){Na(_,H,y(O,H,ne))}),_}var jv=Ol(function(m,y,_){Uu(m,y,_)}),Nd=Ol(function(m,y,_,O){Uu(m,y,_,O)}),nh=Jn(function(m,y){var _={};if(m==null)return _;var O=!1;y=Vn(y,function(ne){return ne=Ps(ne,m),O||(O=ne.length>1),ne}),gi(m,Af(m),_),O&&(_=qr(_,g|b|v,Gg));for(var H=y.length;H--;)Hu(_,y[H]);return _});function fm(m,y){return Zc(m,yd(jt(y)))}var _v=Jn(function(m,y){return m==null?{}:Pg(m,y)});function Zc(m,y){if(m==null)return{};var _=Vn(Af(m),function(O){return[O]});return y=jt(y),xf(m,_,function(O,H){return y(O,H[0])})}function kv(m,y,_){y=Ps(y,m);var O=-1,H=y.length;for(H||(H=1,m=t);++O<H;){var ne=m==null?t:m[En(y[O])];ne===t&&(O=H,ne=_),m=ka(ne)?ne.call(m):ne}return m}function Xy(m,y,_){return m==null?m:Dc(m,y,_)}function Zy(m,y,_,O){return O=typeof O=="function"?O:t,m==null?m:Dc(m,y,_,O)}var hm=ed(kr),pm=ed(Ir);function mm(m,y,_){var O=zt(m),H=O||Oo(m)||Wc(m);if(y=jt(y,4),_==null){var ne=m&&m.constructor;H?_=O?new ne:[]:rr(m)?_=ka(ne)?Ri(_u(m)):{}:_={}}return(H?wr:Vr)(m,function(ye,Ne,Pe){return y(_,ye,Ne,Pe)}),_}function ex(m,y){return m==null?!0:Hu(m,y)}function rh(m,y,_){return m==null?m:jp(m,y,Wu(_))}function Tv(m,y,_,O){return O=typeof O=="function"?O:t,m==null?m:jp(m,y,Wu(_),O)}function eu(m){return m==null?[]:xl(m,kr(m))}function gm(m){return m==null?[]:xl(m,Ir(m))}function ym(m,y,_){return _===t&&(_=y,y=t),_!==t&&(_=sa(_),_=_===_?_:0),y!==t&&(y=sa(y),y=y===y?y:0),Ca(sa(m),y,_)}function ih(m,y,_){return y=ss(y),_===t?(_=y,y=0):_=ss(_),m=sa(m),Eg(m,y,_)}function xm(m,y,_){if(_&&typeof _!="boolean"&&ai(m,y,_)&&(y=_=t),_===t&&(typeof y=="boolean"?(_=y,y=t):typeof m=="boolean"&&(_=m,m=t)),m===t&&y===t?(m=0,y=1):(m=ss(m),y===t?(y=m,m=0):y=ss(y)),m>y){var O=m;m=y,y=O}if(_||m%1||y%1){var H=ip();return er(m+H*(y-m+so("1e-"+((H+"").length-1))),y)}return vf(m,y)}var tx=ii(function(m,y,_){return y=y.toLowerCase(),m+(_?ah(y):y)});function ah(m){return x(Tn(m).toLowerCase())}function zs(m){return m=Tn(m),m&&m.replace(Zs,Ii).replace(Pi,"")}function Lo(m,y,_){m=Tn(m),y=mi(y);var O=m.length;_=_===t?O:Ca(Vt(_),0,O);var H=_;return _-=y.length,_>=0&&m.slice(_,H)==y}function Fo(m){return m=Tn(m),m&&bt.test(m)?m.replace(gn,Qi):m}function Cd(m){return m=Tn(m),m&&vr.test(m)?m.replace(yn,"\\$&"):m}var jd=ii(function(m,y,_){return m+(_?"-":"")+y.toLowerCase()}),$o=ii(function(m,y,_){return m+(_?" ":"")+y.toLowerCase()}),Ev=Oi("toLowerCase");function nx(m,y,_){m=Tn(m),y=Vt(y);var O=y?Ji(m):0;if(!y||O>=y)return m;var H=(y-O)/2;return Zu(js(H),_)+m+Zu(Cc(H),_)}function _d(m,y,_){m=Tn(m),y=Vt(y);var O=y?Ji(m):0;return y&&O<y?m+Zu(y-O,_):m}function Av(m,y,_){m=Tn(m),y=Vt(y);var O=y?Ji(m):0;return y&&O<y?Zu(y-O,_)+m:m}function rx(m,y,_){return _||y==null?y=0:y&&(y=+y),jl(Tn(m).replace(Ti,""),y||0)}function sh(m,y,_){return(_?ai(m,y,_):y===t)?y=1:y=Vt(y),Np(Tn(m),y)}function ix(){var m=arguments,y=Tn(m[0]);return m.length<3?y:y.replace(m[1],m[2])}var Pv=ii(function(m,y,_){return m+(_?"_":"")+y.toLowerCase()});function oh(m,y,_){return _&&typeof _!="number"&&ai(m,y,_)&&(y=_=t),_=_===t?le:_>>>0,_?(m=Tn(m),m&&(typeof y=="string"||y!=null&&!Xf(y))&&(y=mi(y),!y&&wa(m))?Co(ci(m),0,_):m.split(y,_)):[]}var lh=ii(function(m,y,_){return m+(_?" ":"")+x(y)});function ax(m,y,_){return m=Tn(m),_=_==null?0:Ca(Vt(_),0,m.length),y=mi(y),m.slice(_,_+y.length)==y}function kd(m,y,_){var O=J.templateSettings;_&&ai(m,y,_)&&(y=t),m=Tn(m),y=eh({},y,O,Tf);var H=eh({},y.imports,O.imports,Tf),ne=kr(H),ye=xl(H,ne),Ne,Pe,Xe=0,et=y.interpolate||ec,tt="__p += '",pt=Sc((y.escape||ec).source+"|"+et.source+"|"+(et===vt?Js:ec).source+"|"+(y.evaluate||ec).source+"|$","g"),xt="//# sourceURL="+(ee.call(y,"sourceURL")?(y.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++fc+"]")+`
`;m.replace(pt,function(Ft,hn,Nn,Ea,Ui,Aa){return Nn||(Nn=Ea),tt+=m.slice(Xe,Aa).replace(Gd,Su),hn&&(Ne=!0,tt+=`' +
__e(`+hn+`) +
'`),Ui&&(Pe=!0,tt+=`';
`+Ui+`;
__p += '`),Nn&&(tt+=`' +
((__t = (`+Nn+`)) == null ? '' : __t) +
'`),Xe=Aa+Ft.length,Ft}),tt+=`';
`;var Lt=ee.call(y,"variable")&&y.variable;if(!Lt)tt=`with (obj) {
`+tt+`
}
`;else if(Zl.test(Lt))throw new At(d);tt=(Pe?tt.replace(nt,""):tt).replace(mt,"$1").replace(Nt,"$1;"),tt="function("+(Lt||"obj")+`) {
`+(Lt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Ne?", __e = _.escape":"")+(Pe?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+tt+`return __p
}`;var tn=A(function(){return un(ne,xt+"return "+tt).apply(t,ye)});if(tn.source=tt,_r(tn))throw tn;return tn}function bm(m){return Tn(m).toLowerCase()}function ch(m){return Tn(m).toUpperCase()}function sx(m,y,_){if(m=Tn(m),m&&(_||y===t))return Zd(m);if(!m||!(y=mi(y)))return m;var O=ci(m),H=ci(y),ne=va(O,H),ye=po(O,H)+1;return Co(O,ne,ye).join("")}function Dv(m,y,_){if(m=Tn(m),m&&(_||y===t))return m.slice(0,ju(m)+1);if(!m||!(y=mi(y)))return m;var O=ci(m),H=po(O,ci(y))+1;return Co(O,0,H).join("")}function uh(m,y,_){if(m=Tn(m),m&&(_||y===t))return m.replace(Ti,"");if(!m||!(y=mi(y)))return m;var O=ci(m),H=va(O,ci(y));return Co(O,H).join("")}function s(m,y){var _=R,O=B;if(rr(y)){var H="separator"in y?y.separator:H;_="length"in y?Vt(y.length):_,O="omission"in y?mi(y.omission):O}m=Tn(m);var ne=m.length;if(wa(m)){var ye=ci(m);ne=ye.length}if(_>=ne)return m;var Ne=_-Ji(O);if(Ne<1)return O;var Pe=ye?Co(ye,0,Ne).join(""):m.slice(0,Ne);if(H===t)return Pe+O;if(ye&&(Ne+=Pe.length-Ne),Xf(H)){if(m.slice(Ne).search(H)){var Xe,et=Pe;for(H.global||(H=Sc(H.source,Tn(Ks.exec(H))+"g")),H.lastIndex=0;Xe=H.exec(et);)var tt=Xe.index;Pe=Pe.slice(0,tt===t?Ne:tt)}}else if(m.indexOf(mi(H),Ne)!=Ne){var pt=Pe.lastIndexOf(H);pt>-1&&(Pe=Pe.slice(0,pt))}return Pe+O}function c(m){return m=Tn(m),m&&Cn.test(m)?m.replace(cn,Ss):m}var h=ii(function(m,y,_){return m+(_?" ":"")+y.toUpperCase()}),x=Oi("toUpperCase");function N(m,y,_){return m=Tn(m),y=_?t:y,y===t?Nu(m)?tp(m):uo(m):m.match(y)||[]}var A=Gt(function(m,y){try{return Ur(m,t,y)}catch(_){return _r(_)?_:new At(_)}}),q=Jn(function(m,y){return wr(y,function(_){_=En(_),Na(m,_,Ro(m[_],m))}),m});function K(m){var y=m==null?0:m.length,_=jt();return m=y?Vn(m,function(O){if(typeof O[1]!="function")throw new ti(l);return[_(O[0]),O[1]]}):[],Gt(function(O){for(var H=-1;++H<y;){var ne=m[H];if(Ur(ne[0],this,O))return Ur(ne[1],this,O)}})}function xe(m){return _g(qr(m,g))}function Oe(m){return function(){return m}}function We(m,y){return m==null||m!==m?y:m}var Ze=es(),$e=es(!0);function Le(m){return m}function Dt(m){return yp(typeof m=="function"?m:qr(m,g))}function Pt(m){return bp(qr(m,g))}function Ln(m,y){return yf(m,qr(y,g))}var Ae=Gt(function(m,y){return function(_){return Dl(_,m,y)}}),Ce=Gt(function(m,y){return function(_){return Dl(m,_,y)}});function Re(m,y,_){var O=kr(y),H=No(y,O);_==null&&!(rr(y)&&(H.length||!O.length))&&(_=y,y=m,m=this,H=No(y,kr(y)));var ne=!(rr(_)&&"chain"in _)||!!_.chain,ye=ka(m);return wr(H,function(Ne){var Pe=y[Ne];m[Ne]=Pe,ye&&(m.prototype[Ne]=function(){var Xe=this.__chain__;if(ne||Xe){var et=m(this.__wrapped__),tt=et.__actions__=Nr(this.__actions__);return tt.push({func:Pe,args:arguments,thisArg:m}),et.__chain__=Xe,et}return Pe.apply(m,Wi([this.value()],arguments))})}),m}function Je(){return qn._===this&&(qn._=ut),this}function gt(){}function en(m){return m=Vt(m),Gt(function(y){return vp(y,m)})}var wt=Xu(Vn),It=Xu(yc),Rr=Xu(Ha);function Sn(m){return Rf(m)?yl(En(m)):Dg(m)}function zo(m){return function(y){return m==null?t:ta(m,y)}}var Iv=jo(),kA=jo(!0);function Rv(){return[]}function Mv(){return!1}function TA(){return{}}function EA(){return""}function AA(){return!0}function PA(m,y){if(m=Vt(m),m<1||m>re)return[];var _=le,O=er(m,le);y=jt(y),m-=le;for(var H=Ya(O,y);++_<m;)y(_);return H}function DA(m){return zt(m)?Vn(m,En):si(m)?[m]:Nr(rs(Tn(m)))}function IA(m){var y=++he;return Tn(m)+y}var RA=Ic(function(m,y){return m+y},0),MA=kf("ceil"),OA=Ic(function(m,y){return m/y},1),LA=kf("floor");function FA(m){return m&&m.length?ja(m,Le,Fu):t}function $A(m,y){return m&&m.length?ja(m,jt(y,2),Fu):t}function zA(m){return gl(m,Le)}function UA(m,y){return gl(m,jt(y,2))}function BA(m){return m&&m.length?ja(m,Le,gf):t}function qA(m,y){return m&&m.length?ja(m,jt(y,2),gf):t}var VA=Ic(function(m,y){return m*y},1),HA=kf("round"),GA=Ic(function(m,y){return m-y},0);function YA(m){return m&&m.length?vc(m,Le):0}function WA(m,y){return m&&m.length?vc(m,jt(y,2)):0}return J.after=av,J.ary=Ay,J.assign=gv,J.assignIn=Gy,J.assignInWith=eh,J.assignWith=yv,J.at=xv,J.before=hd,J.bind=Ro,J.bindAll=q,J.bindKey=Hf,J.castArray=cv,J.chain=Hc,J.chunk=Xb,J.compact=ry,J.concat=iy,J.cond=K,J.conforms=xe,J.constant=Oe,J.countBy=Gc,J.create=bv,J.curry=pd,J.curryRight=Gf,J.debounce=Mo,J.defaults=vv,J.defaultsDeep=Yy,J.defer=as,J.delay=md,J.difference=nr,J.differenceBy=yi,J.differenceWith=Os,J.drop=ay,J.dropRight=sy,J.dropRightWhile=Zb,J.dropWhile=$p,J.fill=Li,J.filter=xy,J.flatMap=Zp,J.flatMapDeep=nv,J.flatMapDepth=rv,J.flatten=xi,J.flattenDeep=oy,J.flattenDepth=To,J.flip=sv,J.flow=Ze,J.flowRight=$e,J.fromPairs=zl,J.functions=Qy,J.functionsIn=th,J.groupBy=wy,J.initial=Bp,J.intersection=is,J.intersectionBy=ly,J.intersectionWith=Lc,J.invert=Jy,J.invertBy=Ky,J.invokeMap=Bf,J.iteratee=Dt,J.keyBy=Sy,J.keys=kr,J.keysIn=Ir,J.map=fd,J.mapKeys=Nv,J.mapValues=Cv,J.matches=Pt,J.matchesProperty=Ln,J.memoize=gd,J.merge=jv,J.mergeWith=Nd,J.method=Ae,J.methodOf=Ce,J.mixin=Re,J.negate=yd,J.nthArg=en,J.omit=nh,J.omitBy=fm,J.once=Py,J.orderBy=Ny,J.over=wt,J.overArgs=Dy,J.overEvery=It,J.overSome=Rr,J.partial=nm,J.partialRight=Yf,J.partition=Cy,J.pick=_v,J.pickBy=Zc,J.property=Sn,J.propertyOf=zo,J.pull=uy,J.pullAll=$c,J.pullAllBy=dy,J.pullAllWith=zf,J.pullAt=fy,J.range=Iv,J.rangeRight=kA,J.rearg=Iy,J.reject=qf,J.remove=ev,J.rest=Ry,J.reverse=qp,J.sampleSize=Ty,J.set=Xy,J.setWith=Zy,J.shuffle=Un,J.slice=Pn,J.sortBy=Ey,J.sortedUniq=zc,J.sortedUniqBy=Vp,J.split=oh,J.spread=ov,J.tail=Fs,J.take=dr,J.takeRight=Ao,J.takeRightWhile=Ul,J.takeWhile=Hp,J.tap=Jp,J.throttle=rm,J.thru=Gr,J.toArray=zi,J.toPairs=hm,J.toPairsIn=pm,J.toPath=DA,J.toPlainObject=Hy,J.transform=mm,J.unary=im,J.union=ia,J.unionBy=Uc,J.unionWith=ud,J.uniq=bi,J.uniqBy=Gp,J.uniqWith=Yp,J.unset=ex,J.unzip=Bc,J.unzipWith=dd,J.update=rh,J.updateWith=Tv,J.values=eu,J.valuesIn=gm,J.without=Po,J.words=N,J.wrap=lv,J.xor=$r,J.xorBy=Do,J.xorWith=qc,J.zip=Vc,J.zipObject=Wp,J.zipObjectDeep=Qp,J.zipWith=hy,J.entries=hm,J.entriesIn=pm,J.extend=Gy,J.extendWith=eh,Re(J,J),J.add=RA,J.attempt=A,J.camelCase=tx,J.capitalize=ah,J.ceil=MA,J.clamp=ym,J.clone=xd,J.cloneDeep=My,J.cloneDeepWith=sn,J.cloneWith=uv,J.conformsTo=am,J.deburr=zs,J.defaultTo=We,J.divide=OA,J.endsWith=Lo,J.eq=vi,J.escape=Fo,J.escapeRegExp=Cd,J.every=yy,J.find=by,J.findIndex=ra,J.findKey=Jc,J.findLast=Xp,J.findLastIndex=zp,J.findLastKey=vd,J.floor=LA,J.forEach=vy,J.forEachRight=em,J.forIn=Wy,J.forInRight=wv,J.forOwn=Kc,J.forOwnRight=wd,J.get=Sd,J.gt=sm,J.gte=Oy,J.has=dm,J.hasIn=Xc,J.head=Ls,J.identity=Le,J.includes=Yc,J.indexOf=Up,J.inRange=ih,J.invoke=Sv,J.isArguments=$s,J.isArray=zt,J.isArrayBuffer=Wf,J.isArrayLike=jr,J.isArrayLikeObject=fr,J.isBoolean=dv,J.isBuffer=Oo,J.isDate=Ly,J.isElement=Fy,J.isEmpty=Qf,J.isEqual=On,J.isEqualWith=om,J.isError=_r,J.isFinite=fv,J.isFunction=ka,J.isInteger=Jf,J.isLength=Bl,J.isMap=Kf,J.isMatch=lm,J.isMatchWith=hv,J.isNaN=$y,J.isNative=pv,J.isNil=mv,J.isNull=zy,J.isNumber=Uy,J.isObject=rr,J.isObjectLike=or,J.isPlainObject=aa,J.isRegExp=Xf,J.isSafeInteger=cm,J.isSet=By,J.isString=Zf,J.isSymbol=si,J.isTypedArray=Wc,J.isUndefined=Ta,J.isWeakMap=um,J.isWeakSet=qy,J.join=cd,J.kebabCase=jd,J.last=Hr,J.lastIndexOf=Fc,J.lowerCase=$o,J.lowerFirst=Ev,J.lt=Vy,J.lte=bd,J.max=FA,J.maxBy=$A,J.mean=zA,J.meanBy=UA,J.min=BA,J.minBy=qA,J.stubArray=Rv,J.stubFalse=Mv,J.stubObject=TA,J.stubString=EA,J.stubTrue=AA,J.multiply=VA,J.nth=cy,J.noConflict=Je,J.noop=gt,J.now=Vf,J.pad=nx,J.padEnd=_d,J.padStart=Av,J.parseInt=rx,J.random=xm,J.reduce=jy,J.reduceRight=_y,J.repeat=sh,J.replace=ix,J.result=kv,J.round=HA,J.runInContext=_e,J.sample=ky,J.size=tm,J.snakeCase=Pv,J.some=iv,J.sortedIndex=Gn,J.sortedIndexBy=an,J.sortedIndexOf=bn,J.sortedLastIndex=Dn,J.sortedLastIndexBy=Fi,J.sortedLastIndexOf=Eo,J.startCase=lh,J.startsWith=ax,J.subtract=GA,J.sum=YA,J.sumBy=WA,J.template=kd,J.times=PA,J.toFinite=ss,J.toInteger=Vt,J.toLength=os,J.toLower=bm,J.toNumber=sa,J.toSafeInteger=Qc,J.toString=Tn,J.toUpper=ch,J.trim=sx,J.trimEnd=Dv,J.trimStart=uh,J.truncate=s,J.unescape=c,J.uniqueId=IA,J.upperCase=h,J.upperFirst=x,J.each=vy,J.eachRight=em,J.first=Ls,Re(J,function(){var m={};return Vr(J,function(y,_){ee.call(J.prototype,_)||(m[_]=y)}),m}(),{chain:!1}),J.VERSION=r,wr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(m){J[m].placeholder=J}),wr(["drop","take"],function(m,y){Zt.prototype[m]=function(_){_=_===t?1:Qn(Vt(_),0);var O=this.__filtered__&&!y?new Zt(this):this.clone();return O.__filtered__?O.__takeCount__=er(_,O.__takeCount__):O.__views__.push({size:er(_,le),type:m+(O.__dir__<0?"Right":"")}),O},Zt.prototype[m+"Right"]=function(_){return this.reverse()[m](_).reverse()}}),wr(["filter","map","takeWhile"],function(m,y){var _=y+1,O=_==te||_==V;Zt.prototype[m]=function(H){var ne=this.clone();return ne.__iteratees__.push({iteratee:jt(H,3),type:_}),ne.__filtered__=ne.__filtered__||O,ne}}),wr(["head","last"],function(m,y){var _="take"+(y?"Right":"");Zt.prototype[m]=function(){return this[_](1).value()[0]}}),wr(["initial","tail"],function(m,y){var _="drop"+(y?"":"Right");Zt.prototype[m]=function(){return this.__filtered__?new Zt(this):this[_](1)}}),Zt.prototype.compact=function(){return this.filter(Le)},Zt.prototype.find=function(m){return this.filter(m).head()},Zt.prototype.findLast=function(m){return this.reverse().find(m)},Zt.prototype.invokeMap=Gt(function(m,y){return typeof m=="function"?new Zt(this):this.map(function(_){return Dl(_,m,y)})}),Zt.prototype.reject=function(m){return this.filter(yd(jt(m)))},Zt.prototype.slice=function(m,y){m=Vt(m);var _=this;return _.__filtered__&&(m>0||y<0)?new Zt(_):(m<0?_=_.takeRight(-m):m&&(_=_.drop(m)),y!==t&&(y=Vt(y),_=y<0?_.dropRight(-y):_.take(y-m)),_)},Zt.prototype.takeRightWhile=function(m){return this.reverse().takeWhile(m).reverse()},Zt.prototype.toArray=function(){return this.take(le)},Vr(Zt.prototype,function(m,y){var _=/^(?:filter|find|map|reject)|While$/.test(y),O=/^(?:head|last)$/.test(y),H=J[O?"take"+(y=="last"?"Right":""):y],ne=O||/^find/.test(y);H&&(J.prototype[y]=function(){var ye=this.__wrapped__,Ne=O?[1]:arguments,Pe=ye instanceof Zt,Xe=Ne[0],et=Pe||zt(ye),tt=function(hn){var Nn=H.apply(J,Wi([hn],Ne));return O&&pt?Nn[0]:Nn};et&&_&&typeof Xe=="function"&&Xe.length!=1&&(Pe=et=!1);var pt=this.__chain__,xt=!!this.__actions__.length,Lt=ne&&!pt,tn=Pe&&!xt;if(!ne&&et){ye=tn?ye:new Zt(this);var Ft=m.apply(ye,Ne);return Ft.__actions__.push({func:Gr,args:[tt],thisArg:t}),new fi(Ft,pt)}return Lt&&tn?m.apply(this,Ne):(Ft=this.thru(tt),Lt?O?Ft.value()[0]:Ft.value():Ft)})}),wr(["pop","push","shift","sort","splice","unshift"],function(m){var y=Nc[m],_=/^(?:push|sort|unshift)$/.test(m)?"tap":"thru",O=/^(?:pop|shift)$/.test(m);J.prototype[m]=function(){var H=arguments;if(O&&!this.__chain__){var ne=this.value();return y.apply(zt(ne)?ne:[],H)}return this[_](function(ye){return y.apply(zt(ye)?ye:[],H)})}}),Vr(Zt.prototype,function(m,y){var _=J[y];if(_){var O=_.name+"";ee.call(Zi,O)||(Zi[O]=[]),Zi[O].push({name:y,func:_})}}),Zi[ur(t,P).name]=[{name:"wrapper",func:t}],Zt.prototype.clone=Iu,Zt.prototype.reverse=sf,Zt.prototype.value=kl,J.prototype.at=py,J.prototype.chain=$i,J.prototype.commit=my,J.prototype.next=gy,J.prototype.plant=Io,J.prototype.reverse=Uf,J.prototype.toJSON=J.prototype.valueOf=J.prototype.value=Kp,J.prototype.first=J.prototype.head,Nl&&(J.prototype[Nl]=tv),J},Ka=Ja();Va?((Va.exports=Ka)._=Ka,xa._=Ka):qn._=Ka}).call(e8)}(Fm,Fm.exports)),Fm.exports}var vk=t8();class n8{constructor(n){Yn(this,"sampleRate",24e3);Yn(this,"bufferSize",7680);Yn(this,"audioQueue",[]);Yn(this,"isPlaying",!1);Yn(this,"isStreamComplete",!1);Yn(this,"checkInterval",null);Yn(this,"scheduledTime",0);Yn(this,"initialBufferTime",.1);Yn(this,"gainNode");Yn(this,"source");Yn(this,"endOfQueueAudioSource",null);Yn(this,"onComplete",()=>{});this.context=n,this.gainNode=this.context.createGain(),this.source=this.context.createBufferSource(),this.gainNode.connect(this.context.destination),this.addPCM16=this.addPCM16.bind(this)}async addWorklet(n,t,r){let a=bx.get(this.context);if(a&&a[n])return a[n].handlers.push(r),Promise.resolve(this);a||(bx.set(this.context,{}),a=bx.get(this.context)),a[n]={handlers:[r]};const o=g1(n,t);await this.context.audioWorklet.addModule(o);const l=new AudioWorkletNode(this.context,n);return a[n].node=l,this}_processPCM16Chunk(n){const t=new Float32Array(n.length/2),r=new DataView(n.buffer);for(let a=0;a<n.length/2;a++)try{const o=r.getInt16(a*2,!0);t[a]=o/32768}catch(o){console.error(o)}return t}addPCM16(n){this.isStreamComplete=!1;let t=this._processPCM16Chunk(n);for(;t.length>=this.bufferSize;){const r=t.slice(0,this.bufferSize);this.audioQueue.push(r),t=t.slice(this.bufferSize)}t.length>0&&this.audioQueue.push(t),this.isPlaying||(this.isPlaying=!0,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.scheduleNextBuffer())}createAudioBuffer(n){const t=this.context.createBuffer(1,n.length,this.sampleRate);return t.getChannelData(0).set(n),t}scheduleNextBuffer(){for(;this.audioQueue.length>0&&this.scheduledTime<this.context.currentTime+.2;){const t=this.audioQueue.shift(),r=this.createAudioBuffer(t),a=this.context.createBufferSource();this.audioQueue.length===0&&(this.endOfQueueAudioSource&&(this.endOfQueueAudioSource.onended=null),this.endOfQueueAudioSource=a,a.onended=()=>{!this.audioQueue.length&&this.endOfQueueAudioSource===a&&(this.endOfQueueAudioSource=null,this.onComplete())}),a.buffer=r,a.connect(this.gainNode);const o=bx.get(this.context);o&&Object.entries(o).forEach(([,d])=>{const{node:f,handlers:u}=d;f&&(a.connect(f),f.port.onmessage=function(p){u.forEach(g=>{g.call(f.port,p)})},f.connect(this.context.destination))});const l=Math.max(this.scheduledTime,this.context.currentTime);a.start(l),this.scheduledTime=l+r.duration}if(this.audioQueue.length===0)this.isStreamComplete?(this.isPlaying=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)):this.checkInterval||(this.checkInterval=window.setInterval(()=>{this.audioQueue.length>0&&this.scheduleNextBuffer()},100));else{const t=(this.scheduledTime-this.context.currentTime)*1e3;setTimeout(()=>this.scheduleNextBuffer(),Math.max(0,t-50))}}stop(){this.isPlaying=!1,this.isStreamComplete=!0,this.audioQueue=[],this.scheduledTime=this.context.currentTime,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.gainNode.gain.linearRampToValueAtTime(0,this.context.currentTime+.1),setTimeout(()=>{this.gainNode.disconnect(),this.gainNode=this.context.createGain(),this.gainNode.connect(this.context.destination)},200)}async resume(){this.context.state==="suspended"&&await this.context.resume(),this.isStreamComplete=!1,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.gainNode.gain.setValueAtTime(1,this.context.currentTime)}complete(){this.isStreamComplete=!0,this.onComplete()}}function wk(e,n){return function(){return e.apply(n,arguments)}}const{toString:r8}=Object.prototype,{getPrototypeOf:ww}=Object,Pb=(e=>n=>{const t=r8.call(n);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Ws=e=>(e=e.toLowerCase(),n=>Pb(n)===e),Db=e=>n=>typeof n===e,{isArray:qh}=Array,Km=Db("undefined");function i8(e){return e!==null&&!Km(e)&&e.constructor!==null&&!Km(e.constructor)&&Ma(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Sk=Ws("ArrayBuffer");function a8(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&Sk(e.buffer),n}const s8=Db("string"),Ma=Db("function"),Nk=Db("number"),Ib=e=>e!==null&&typeof e=="object",o8=e=>e===!0||e===!1,zx=e=>{if(Pb(e)!=="object")return!1;const n=ww(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},l8=Ws("Date"),c8=Ws("File"),u8=Ws("Blob"),d8=Ws("FileList"),f8=e=>Ib(e)&&Ma(e.pipe),h8=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||Ma(e.append)&&((n=Pb(e))==="formdata"||n==="object"&&Ma(e.toString)&&e.toString()==="[object FormData]"))},p8=Ws("URLSearchParams"),[m8,g8,y8,x8]=["ReadableStream","Request","Response","Headers"].map(Ws),b8=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function og(e,n,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let r,a;if(typeof e!="object"&&(e=[e]),qh(e))for(r=0,a=e.length;r<a;r++)n.call(null,e[r],r,e);else{const o=t?Object.getOwnPropertyNames(e):Object.keys(e),l=o.length;let d;for(r=0;r<l;r++)d=o[r],n.call(null,e[d],d,e)}}function Ck(e,n){n=n.toLowerCase();const t=Object.keys(e);let r=t.length,a;for(;r-- >0;)if(a=t[r],n===a.toLowerCase())return a;return null}const Dd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,jk=e=>!Km(e)&&e!==Dd;function y1(){const{caseless:e}=jk(this)&&this||{},n={},t=(r,a)=>{const o=e&&Ck(n,a)||a;zx(n[o])&&zx(r)?n[o]=y1(n[o],r):zx(r)?n[o]=y1({},r):qh(r)?n[o]=r.slice():n[o]=r};for(let r=0,a=arguments.length;r<a;r++)arguments[r]&&og(arguments[r],t);return n}const v8=(e,n,t,{allOwnKeys:r}={})=>(og(n,(a,o)=>{t&&Ma(a)?e[o]=wk(a,t):e[o]=a},{allOwnKeys:r}),e),w8=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),S8=(e,n,t,r)=>{e.prototype=Object.create(n.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),t&&Object.assign(e.prototype,t)},N8=(e,n,t,r)=>{let a,o,l;const d={};if(n=n||{},e==null)return n;do{for(a=Object.getOwnPropertyNames(e),o=a.length;o-- >0;)l=a[o],(!r||r(l,e,n))&&!d[l]&&(n[l]=e[l],d[l]=!0);e=t!==!1&&ww(e)}while(e&&(!t||t(e,n))&&e!==Object.prototype);return n},C8=(e,n,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=n.length;const r=e.indexOf(n,t);return r!==-1&&r===t},j8=e=>{if(!e)return null;if(qh(e))return e;let n=e.length;if(!Nk(n))return null;const t=new Array(n);for(;n-- >0;)t[n]=e[n];return t},_8=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&ww(Uint8Array)),k8=(e,n)=>{const r=(e&&e[Symbol.iterator]).call(e);let a;for(;(a=r.next())&&!a.done;){const o=a.value;n.call(e,o[0],o[1])}},T8=(e,n)=>{let t;const r=[];for(;(t=e.exec(n))!==null;)r.push(t);return r},E8=Ws("HTMLFormElement"),A8=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,a){return r.toUpperCase()+a}),SC=(({hasOwnProperty:e})=>(n,t)=>e.call(n,t))(Object.prototype),P8=Ws("RegExp"),_k=(e,n)=>{const t=Object.getOwnPropertyDescriptors(e),r={};og(t,(a,o)=>{let l;(l=n(a,o,e))!==!1&&(r[o]=l||a)}),Object.defineProperties(e,r)},D8=e=>{_k(e,(n,t)=>{if(Ma(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=e[t];if(Ma(r)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},I8=(e,n)=>{const t={},r=a=>{a.forEach(o=>{t[o]=!0})};return qh(e)?r(e):r(String(e).split(n)),t},R8=()=>{},M8=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n;function O8(e){return!!(e&&Ma(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const L8=e=>{const n=new Array(10),t=(r,a)=>{if(Ib(r)){if(n.indexOf(r)>=0)return;if(!("toJSON"in r)){n[a]=r;const o=qh(r)?[]:{};return og(r,(l,d)=>{const f=t(l,a+1);!Km(f)&&(o[d]=f)}),n[a]=void 0,o}}return r};return t(e,0)},F8=Ws("AsyncFunction"),$8=e=>e&&(Ib(e)||Ma(e))&&Ma(e.then)&&Ma(e.catch),kk=((e,n)=>e?setImmediate:n?((t,r)=>(Dd.addEventListener("message",({source:a,data:o})=>{a===Dd&&o===t&&r.length&&r.shift()()},!1),a=>{r.push(a),Dd.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Ma(Dd.postMessage)),z8=typeof queueMicrotask<"u"?queueMicrotask.bind(Dd):typeof process<"u"&&process.nextTick||kk,He={isArray:qh,isArrayBuffer:Sk,isBuffer:i8,isFormData:h8,isArrayBufferView:a8,isString:s8,isNumber:Nk,isBoolean:o8,isObject:Ib,isPlainObject:zx,isReadableStream:m8,isRequest:g8,isResponse:y8,isHeaders:x8,isUndefined:Km,isDate:l8,isFile:c8,isBlob:u8,isRegExp:P8,isFunction:Ma,isStream:f8,isURLSearchParams:p8,isTypedArray:_8,isFileList:d8,forEach:og,merge:y1,extend:v8,trim:b8,stripBOM:w8,inherits:S8,toFlatObject:N8,kindOf:Pb,kindOfTest:Ws,endsWith:C8,toArray:j8,forEachEntry:k8,matchAll:T8,isHTMLForm:E8,hasOwnProperty:SC,hasOwnProp:SC,reduceDescriptors:_k,freezeMethods:D8,toObjectSet:I8,toCamelCase:A8,noop:R8,toFiniteNumber:M8,findKey:Ck,global:Dd,isContextDefined:jk,isSpecCompliantForm:O8,toJSONObject:L8,isAsyncFn:F8,isThenable:$8,setImmediate:kk,asap:z8};function Qt(e,n,t,r,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),t&&(this.config=t),r&&(this.request=r),a&&(this.response=a,this.status=a.status?a.status:null)}He.inherits(Qt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:He.toJSONObject(this.config),code:this.code,status:this.status}}});const Tk=Qt.prototype,Ek={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Ek[e]={value:e}});Object.defineProperties(Qt,Ek);Object.defineProperty(Tk,"isAxiosError",{value:!0});Qt.from=(e,n,t,r,a,o)=>{const l=Object.create(Tk);return He.toFlatObject(e,l,function(f){return f!==Error.prototype},d=>d!=="isAxiosError"),Qt.call(l,e.message,n,t,r,a),l.cause=e,l.name=e.name,o&&Object.assign(l,o),l};const U8=null;function x1(e){return He.isPlainObject(e)||He.isArray(e)}function Ak(e){return He.endsWith(e,"[]")?e.slice(0,-2):e}function NC(e,n,t){return e?e.concat(n).map(function(a,o){return a=Ak(a),!t&&o?"["+a+"]":a}).join(t?".":""):n}function B8(e){return He.isArray(e)&&!e.some(x1)}const q8=He.toFlatObject(He,{},null,function(n){return/^is[A-Z]/.test(n)});function Rb(e,n,t){if(!He.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,t=He.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(k,T){return!He.isUndefined(T[k])});const r=t.metaTokens,a=t.visitor||p,o=t.dots,l=t.indexes,f=(t.Blob||typeof Blob<"u"&&Blob)&&He.isSpecCompliantForm(n);if(!He.isFunction(a))throw new TypeError("visitor must be a function");function u(S){if(S===null)return"";if(He.isDate(S))return S.toISOString();if(!f&&He.isBlob(S))throw new Qt("Blob is not supported. Use a Buffer instead.");return He.isArrayBuffer(S)||He.isTypedArray(S)?f&&typeof Blob=="function"?new Blob([S]):Buffer.from(S):S}function p(S,k,T){let P=S;if(S&&!T&&typeof S=="object"){if(He.endsWith(k,"{}"))k=r?k:k.slice(0,-2),S=JSON.stringify(S);else if(He.isArray(S)&&B8(S)||(He.isFileList(S)||He.endsWith(k,"[]"))&&(P=He.toArray(S)))return k=Ak(k),P.forEach(function(I,U){!(He.isUndefined(I)||I===null)&&n.append(l===!0?NC([k],U,o):l===null?k:k+"[]",u(I))}),!1}return x1(S)?!0:(n.append(NC(T,k,o),u(S)),!1)}const g=[],b=Object.assign(q8,{defaultVisitor:p,convertValue:u,isVisitable:x1});function v(S,k){if(!He.isUndefined(S)){if(g.indexOf(S)!==-1)throw Error("Circular reference detected in "+k.join("."));g.push(S),He.forEach(S,function(P,M){(!(He.isUndefined(P)||P===null)&&a.call(n,P,He.isString(M)?M.trim():M,k,b))===!0&&v(P,k?k.concat(M):[M])}),g.pop()}}if(!He.isObject(e))throw new TypeError("data must be an object");return v(e),n}function CC(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return n[r]})}function Sw(e,n){this._pairs=[],e&&Rb(e,this,n)}const Pk=Sw.prototype;Pk.append=function(n,t){this._pairs.push([n,t])};Pk.toString=function(n){const t=n?function(r){return n.call(this,r,CC)}:CC;return this._pairs.map(function(a){return t(a[0])+"="+t(a[1])},"").join("&")};function V8(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Dk(e,n,t){if(!n)return e;const r=t&&t.encode||V8;He.isFunction(t)&&(t={serialize:t});const a=t&&t.serialize;let o;if(a?o=a(n,t):o=He.isURLSearchParams(n)?n.toString():new Sw(n,t).toString(r),o){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class jC{constructor(){this.handlers=[]}use(n,t,r){return this.handlers.push({fulfilled:n,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){He.forEach(this.handlers,function(r){r!==null&&n(r)})}}const Ik={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},H8=typeof URLSearchParams<"u"?URLSearchParams:Sw,G8=typeof FormData<"u"?FormData:null,Y8=typeof Blob<"u"?Blob:null,W8={isBrowser:!0,classes:{URLSearchParams:H8,FormData:G8,Blob:Y8},protocols:["http","https","file","blob","url","data"]},Nw=typeof window<"u"&&typeof document<"u",b1=typeof navigator=="object"&&navigator||void 0,Q8=Nw&&(!b1||["ReactNative","NativeScript","NS"].indexOf(b1.product)<0),J8=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",K8=Nw&&window.location.href||"http://localhost",X8=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Nw,hasStandardBrowserEnv:Q8,hasStandardBrowserWebWorkerEnv:J8,navigator:b1,origin:K8},Symbol.toStringTag,{value:"Module"})),Ci={...X8,...W8};function Z8(e,n){return Rb(e,new Ci.classes.URLSearchParams,Object.assign({visitor:function(t,r,a,o){return Ci.isNode&&He.isBuffer(t)?(this.append(r,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},n))}function eU(e){return He.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function tU(e){const n={},t=Object.keys(e);let r;const a=t.length;let o;for(r=0;r<a;r++)o=t[r],n[o]=e[o];return n}function Rk(e){function n(t,r,a,o){let l=t[o++];if(l==="__proto__")return!0;const d=Number.isFinite(+l),f=o>=t.length;return l=!l&&He.isArray(a)?a.length:l,f?(He.hasOwnProp(a,l)?a[l]=[a[l],r]:a[l]=r,!d):((!a[l]||!He.isObject(a[l]))&&(a[l]=[]),n(t,r,a[l],o)&&He.isArray(a[l])&&(a[l]=tU(a[l])),!d)}if(He.isFormData(e)&&He.isFunction(e.entries)){const t={};return He.forEachEntry(e,(r,a)=>{n(eU(r),a,t,0)}),t}return null}function nU(e,n,t){if(He.isString(e))try{return(n||JSON.parse)(e),He.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(e)}const lg={transitional:Ik,adapter:["xhr","http","fetch"],transformRequest:[function(n,t){const r=t.getContentType()||"",a=r.indexOf("application/json")>-1,o=He.isObject(n);if(o&&He.isHTMLForm(n)&&(n=new FormData(n)),He.isFormData(n))return a?JSON.stringify(Rk(n)):n;if(He.isArrayBuffer(n)||He.isBuffer(n)||He.isStream(n)||He.isFile(n)||He.isBlob(n)||He.isReadableStream(n))return n;if(He.isArrayBufferView(n))return n.buffer;if(He.isURLSearchParams(n))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let d;if(o){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Z8(n,this.formSerializer).toString();if((d=He.isFileList(n))||r.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return Rb(d?{"files[]":n}:n,f&&new f,this.formSerializer)}}return o||a?(t.setContentType("application/json",!1),nU(n)):n}],transformResponse:[function(n){const t=this.transitional||lg.transitional,r=t&&t.forcedJSONParsing,a=this.responseType==="json";if(He.isResponse(n)||He.isReadableStream(n))return n;if(n&&He.isString(n)&&(r&&!this.responseType||a)){const l=!(t&&t.silentJSONParsing)&&a;try{return JSON.parse(n)}catch(d){if(l)throw d.name==="SyntaxError"?Qt.from(d,Qt.ERR_BAD_RESPONSE,this,null,this.response):d}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ci.classes.FormData,Blob:Ci.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};He.forEach(["delete","get","head","post","put","patch"],e=>{lg.headers[e]={}});const rU=He.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),iU=e=>{const n={};let t,r,a;return e&&e.split(`
`).forEach(function(l){a=l.indexOf(":"),t=l.substring(0,a).trim().toLowerCase(),r=l.substring(a+1).trim(),!(!t||n[t]&&rU[t])&&(t==="set-cookie"?n[t]?n[t].push(r):n[t]=[r]:n[t]=n[t]?n[t]+", "+r:r)}),n},_C=Symbol("internals");function km(e){return e&&String(e).trim().toLowerCase()}function Ux(e){return e===!1||e==null?e:He.isArray(e)?e.map(Ux):String(e)}function aU(e){const n=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(e);)n[r[1]]=r[2];return n}const sU=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function a0(e,n,t,r,a){if(He.isFunction(r))return r.call(this,n,t);if(a&&(n=t),!!He.isString(n)){if(He.isString(r))return n.indexOf(r)!==-1;if(He.isRegExp(r))return r.test(n)}}function oU(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,t,r)=>t.toUpperCase()+r)}function lU(e,n){const t=He.toCamelCase(" "+n);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+t,{value:function(a,o,l){return this[r].call(this,n,a,o,l)},configurable:!0})})}let da=class{constructor(n){n&&this.set(n)}set(n,t,r){const a=this;function o(d,f,u){const p=km(f);if(!p)throw new Error("header name must be a non-empty string");const g=He.findKey(a,p);(!g||a[g]===void 0||u===!0||u===void 0&&a[g]!==!1)&&(a[g||f]=Ux(d))}const l=(d,f)=>He.forEach(d,(u,p)=>o(u,p,f));if(He.isPlainObject(n)||n instanceof this.constructor)l(n,t);else if(He.isString(n)&&(n=n.trim())&&!sU(n))l(iU(n),t);else if(He.isHeaders(n))for(const[d,f]of n.entries())o(f,d,r);else n!=null&&o(t,n,r);return this}get(n,t){if(n=km(n),n){const r=He.findKey(this,n);if(r){const a=this[r];if(!t)return a;if(t===!0)return aU(a);if(He.isFunction(t))return t.call(this,a,r);if(He.isRegExp(t))return t.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,t){if(n=km(n),n){const r=He.findKey(this,n);return!!(r&&this[r]!==void 0&&(!t||a0(this,this[r],r,t)))}return!1}delete(n,t){const r=this;let a=!1;function o(l){if(l=km(l),l){const d=He.findKey(r,l);d&&(!t||a0(r,r[d],d,t))&&(delete r[d],a=!0)}}return He.isArray(n)?n.forEach(o):o(n),a}clear(n){const t=Object.keys(this);let r=t.length,a=!1;for(;r--;){const o=t[r];(!n||a0(this,this[o],o,n,!0))&&(delete this[o],a=!0)}return a}normalize(n){const t=this,r={};return He.forEach(this,(a,o)=>{const l=He.findKey(r,o);if(l){t[l]=Ux(a),delete t[o];return}const d=n?oU(o):String(o).trim();d!==o&&delete t[o],t[d]=Ux(a),r[d]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const t=Object.create(null);return He.forEach(this,(r,a)=>{r!=null&&r!==!1&&(t[a]=n&&He.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,t])=>n+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...t){const r=new this(n);return t.forEach(a=>r.set(a)),r}static accessor(n){const r=(this[_C]=this[_C]={accessors:{}}).accessors,a=this.prototype;function o(l){const d=km(l);r[d]||(lU(a,l),r[d]=!0)}return He.isArray(n)?n.forEach(o):o(n),this}};da.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);He.reduceDescriptors(da.prototype,({value:e},n)=>{let t=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(r){this[t]=r}}});He.freezeMethods(da);function s0(e,n){const t=this||lg,r=n||t,a=da.from(r.headers);let o=r.data;return He.forEach(e,function(d){o=d.call(t,o,a.normalize(),n?n.status:void 0)}),a.normalize(),o}function Mk(e){return!!(e&&e.__CANCEL__)}function Vh(e,n,t){Qt.call(this,e??"canceled",Qt.ERR_CANCELED,n,t),this.name="CanceledError"}He.inherits(Vh,Qt,{__CANCEL__:!0});function Ok(e,n,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?e(t):n(new Qt("Request failed with status code "+t.status,[Qt.ERR_BAD_REQUEST,Qt.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function cU(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function uU(e,n){e=e||10;const t=new Array(e),r=new Array(e);let a=0,o=0,l;return n=n!==void 0?n:1e3,function(f){const u=Date.now(),p=r[o];l||(l=u),t[a]=f,r[a]=u;let g=o,b=0;for(;g!==a;)b+=t[g++],g=g%e;if(a=(a+1)%e,a===o&&(o=(o+1)%e),u-l<n)return;const v=p&&u-p;return v?Math.round(b*1e3/v):void 0}}function dU(e,n){let t=0,r=1e3/n,a,o;const l=(u,p=Date.now())=>{t=p,a=null,o&&(clearTimeout(o),o=null),e.apply(null,u)};return[(...u)=>{const p=Date.now(),g=p-t;g>=r?l(u,p):(a=u,o||(o=setTimeout(()=>{o=null,l(a)},r-g)))},()=>a&&l(a)]}const ob=(e,n,t=3)=>{let r=0;const a=uU(50,250);return dU(o=>{const l=o.loaded,d=o.lengthComputable?o.total:void 0,f=l-r,u=a(f),p=l<=d;r=l;const g={loaded:l,total:d,progress:d?l/d:void 0,bytes:f,rate:u||void 0,estimated:u&&d&&p?(d-l)/u:void 0,event:o,lengthComputable:d!=null,[n?"download":"upload"]:!0};e(g)},t)},kC=(e,n)=>{const t=e!=null;return[r=>n[0]({lengthComputable:t,total:e,loaded:r}),n[1]]},TC=e=>(...n)=>He.asap(()=>e(...n)),fU=Ci.hasStandardBrowserEnv?((e,n)=>t=>(t=new URL(t,Ci.origin),e.protocol===t.protocol&&e.host===t.host&&(n||e.port===t.port)))(new URL(Ci.origin),Ci.navigator&&/(msie|trident)/i.test(Ci.navigator.userAgent)):()=>!0,hU=Ci.hasStandardBrowserEnv?{write(e,n,t,r,a,o){const l=[e+"="+encodeURIComponent(n)];He.isNumber(t)&&l.push("expires="+new Date(t).toGMTString()),He.isString(r)&&l.push("path="+r),He.isString(a)&&l.push("domain="+a),o===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function pU(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function mU(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function Lk(e,n,t){let r=!pU(n);return e&&(r||t==!1)?mU(e,n):n}const EC=e=>e instanceof da?{...e}:e;function Fd(e,n){n=n||{};const t={};function r(u,p,g,b){return He.isPlainObject(u)&&He.isPlainObject(p)?He.merge.call({caseless:b},u,p):He.isPlainObject(p)?He.merge({},p):He.isArray(p)?p.slice():p}function a(u,p,g,b){if(He.isUndefined(p)){if(!He.isUndefined(u))return r(void 0,u,g,b)}else return r(u,p,g,b)}function o(u,p){if(!He.isUndefined(p))return r(void 0,p)}function l(u,p){if(He.isUndefined(p)){if(!He.isUndefined(u))return r(void 0,u)}else return r(void 0,p)}function d(u,p,g){if(g in n)return r(u,p);if(g in e)return r(void 0,u)}const f={url:o,method:o,data:o,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:d,headers:(u,p,g)=>a(EC(u),EC(p),g,!0)};return He.forEach(Object.keys(Object.assign({},e,n)),function(p){const g=f[p]||a,b=g(e[p],n[p],p);He.isUndefined(b)&&g!==d||(t[p]=b)}),t}const Fk=e=>{const n=Fd({},e);let{data:t,withXSRFToken:r,xsrfHeaderName:a,xsrfCookieName:o,headers:l,auth:d}=n;n.headers=l=da.from(l),n.url=Dk(Lk(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),d&&l.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):"")));let f;if(He.isFormData(t)){if(Ci.hasStandardBrowserEnv||Ci.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((f=l.getContentType())!==!1){const[u,...p]=f?f.split(";").map(g=>g.trim()).filter(Boolean):[];l.setContentType([u||"multipart/form-data",...p].join("; "))}}if(Ci.hasStandardBrowserEnv&&(r&&He.isFunction(r)&&(r=r(n)),r||r!==!1&&fU(n.url))){const u=a&&o&&hU.read(o);u&&l.set(a,u)}return n},gU=typeof XMLHttpRequest<"u",yU=gU&&function(e){return new Promise(function(t,r){const a=Fk(e);let o=a.data;const l=da.from(a.headers).normalize();let{responseType:d,onUploadProgress:f,onDownloadProgress:u}=a,p,g,b,v,S;function k(){v&&v(),S&&S(),a.cancelToken&&a.cancelToken.unsubscribe(p),a.signal&&a.signal.removeEventListener("abort",p)}let T=new XMLHttpRequest;T.open(a.method.toUpperCase(),a.url,!0),T.timeout=a.timeout;function P(){if(!T)return;const I=da.from("getAllResponseHeaders"in T&&T.getAllResponseHeaders()),L={data:!d||d==="text"||d==="json"?T.responseText:T.response,status:T.status,statusText:T.statusText,headers:I,config:e,request:T};Ok(function(z){t(z),k()},function(z){r(z),k()},L),T=null}"onloadend"in T?T.onloadend=P:T.onreadystatechange=function(){!T||T.readyState!==4||T.status===0&&!(T.responseURL&&T.responseURL.indexOf("file:")===0)||setTimeout(P)},T.onabort=function(){T&&(r(new Qt("Request aborted",Qt.ECONNABORTED,e,T)),T=null)},T.onerror=function(){r(new Qt("Network Error",Qt.ERR_NETWORK,e,T)),T=null},T.ontimeout=function(){let U=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const L=a.transitional||Ik;a.timeoutErrorMessage&&(U=a.timeoutErrorMessage),r(new Qt(U,L.clarifyTimeoutError?Qt.ETIMEDOUT:Qt.ECONNABORTED,e,T)),T=null},o===void 0&&l.setContentType(null),"setRequestHeader"in T&&He.forEach(l.toJSON(),function(U,L){T.setRequestHeader(L,U)}),He.isUndefined(a.withCredentials)||(T.withCredentials=!!a.withCredentials),d&&d!=="json"&&(T.responseType=a.responseType),u&&([b,S]=ob(u,!0),T.addEventListener("progress",b)),f&&T.upload&&([g,v]=ob(f),T.upload.addEventListener("progress",g),T.upload.addEventListener("loadend",v)),(a.cancelToken||a.signal)&&(p=I=>{T&&(r(!I||I.type?new Vh(null,e,T):I),T.abort(),T=null)},a.cancelToken&&a.cancelToken.subscribe(p),a.signal&&(a.signal.aborted?p():a.signal.addEventListener("abort",p)));const M=cU(a.url);if(M&&Ci.protocols.indexOf(M)===-1){r(new Qt("Unsupported protocol "+M+":",Qt.ERR_BAD_REQUEST,e));return}T.send(o||null)})},xU=(e,n)=>{const{length:t}=e=e?e.filter(Boolean):[];if(n||t){let r=new AbortController,a;const o=function(u){if(!a){a=!0,d();const p=u instanceof Error?u:this.reason;r.abort(p instanceof Qt?p:new Vh(p instanceof Error?p.message:p))}};let l=n&&setTimeout(()=>{l=null,o(new Qt(`timeout ${n} of ms exceeded`,Qt.ETIMEDOUT))},n);const d=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(o):u.removeEventListener("abort",o)}),e=null)};e.forEach(u=>u.addEventListener("abort",o));const{signal:f}=r;return f.unsubscribe=()=>He.asap(d),f}},bU=function*(e,n){let t=e.byteLength;if(t<n){yield e;return}let r=0,a;for(;r<t;)a=r+n,yield e.slice(r,a),r=a},vU=async function*(e,n){for await(const t of wU(e))yield*bU(t,n)},wU=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const n=e.getReader();try{for(;;){const{done:t,value:r}=await n.read();if(t)break;yield r}}finally{await n.cancel()}},AC=(e,n,t,r)=>{const a=vU(e,n);let o=0,l,d=f=>{l||(l=!0,r&&r(f))};return new ReadableStream({async pull(f){try{const{done:u,value:p}=await a.next();if(u){d(),f.close();return}let g=p.byteLength;if(t){let b=o+=g;t(b)}f.enqueue(new Uint8Array(p))}catch(u){throw d(u),u}},cancel(f){return d(f),a.return()}},{highWaterMark:2})},Mb=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",$k=Mb&&typeof ReadableStream=="function",SU=Mb&&(typeof TextEncoder=="function"?(e=>n=>e.encode(n))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),zk=(e,...n)=>{try{return!!e(...n)}catch{return!1}},NU=$k&&zk(()=>{let e=!1;const n=new Request(Ci.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!n}),PC=64*1024,v1=$k&&zk(()=>He.isReadableStream(new Response("").body)),lb={stream:v1&&(e=>e.body)};Mb&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!lb[n]&&(lb[n]=He.isFunction(e[n])?t=>t[n]():(t,r)=>{throw new Qt(`Response type '${n}' is not supported`,Qt.ERR_NOT_SUPPORT,r)})})})(new Response);const CU=async e=>{if(e==null)return 0;if(He.isBlob(e))return e.size;if(He.isSpecCompliantForm(e))return(await new Request(Ci.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(He.isArrayBufferView(e)||He.isArrayBuffer(e))return e.byteLength;if(He.isURLSearchParams(e)&&(e=e+""),He.isString(e))return(await SU(e)).byteLength},jU=async(e,n)=>{const t=He.toFiniteNumber(e.getContentLength());return t??CU(n)},_U=Mb&&(async e=>{let{url:n,method:t,data:r,signal:a,cancelToken:o,timeout:l,onDownloadProgress:d,onUploadProgress:f,responseType:u,headers:p,withCredentials:g="same-origin",fetchOptions:b}=Fk(e);u=u?(u+"").toLowerCase():"text";let v=xU([a,o&&o.toAbortSignal()],l),S;const k=v&&v.unsubscribe&&(()=>{v.unsubscribe()});let T;try{if(f&&NU&&t!=="get"&&t!=="head"&&(T=await jU(p,r))!==0){let L=new Request(n,{method:"POST",body:r,duplex:"half"}),$;if(He.isFormData(r)&&($=L.headers.get("content-type"))&&p.setContentType($),L.body){const[z,F]=kC(T,ob(TC(f)));r=AC(L.body,PC,z,F)}}He.isString(g)||(g=g?"include":"omit");const P="credentials"in Request.prototype;S=new Request(n,{...b,signal:v,method:t.toUpperCase(),headers:p.normalize().toJSON(),body:r,duplex:"half",credentials:P?g:void 0});let M=await fetch(S);const I=v1&&(u==="stream"||u==="response");if(v1&&(d||I&&k)){const L={};["status","statusText","headers"].forEach(Y=>{L[Y]=M[Y]});const $=He.toFiniteNumber(M.headers.get("content-length")),[z,F]=d&&kC($,ob(TC(d),!0))||[];M=new Response(AC(M.body,PC,z,()=>{F&&F(),k&&k()}),L)}u=u||"text";let U=await lb[He.findKey(lb,u)||"text"](M,e);return!I&&k&&k(),await new Promise((L,$)=>{Ok(L,$,{data:U,headers:da.from(M.headers),status:M.status,statusText:M.statusText,config:e,request:S})})}catch(P){throw k&&k(),P&&P.name==="TypeError"&&/fetch/i.test(P.message)?Object.assign(new Qt("Network Error",Qt.ERR_NETWORK,e,S),{cause:P.cause||P}):Qt.from(P,P&&P.code,e,S)}}),w1={http:U8,xhr:yU,fetch:_U};He.forEach(w1,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const DC=e=>`- ${e}`,kU=e=>He.isFunction(e)||e===null||e===!1,Uk={getAdapter:e=>{e=He.isArray(e)?e:[e];const{length:n}=e;let t,r;const a={};for(let o=0;o<n;o++){t=e[o];let l;if(r=t,!kU(t)&&(r=w1[(l=String(t)).toLowerCase()],r===void 0))throw new Qt(`Unknown adapter '${l}'`);if(r)break;a[l||"#"+o]=r}if(!r){const o=Object.entries(a).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let l=n?o.length>1?`since :
`+o.map(DC).join(`
`):" "+DC(o[0]):"as no adapter specified";throw new Qt("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return r},adapters:w1};function o0(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Vh(null,e)}function IC(e){return o0(e),e.headers=da.from(e.headers),e.data=s0.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Uk.getAdapter(e.adapter||lg.adapter)(e).then(function(r){return o0(e),r.data=s0.call(e,e.transformResponse,r),r.headers=da.from(r.headers),r},function(r){return Mk(r)||(o0(e),r&&r.response&&(r.response.data=s0.call(e,e.transformResponse,r.response),r.response.headers=da.from(r.response.headers))),Promise.reject(r)})}const Bk="1.8.4",Ob={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{Ob[e]=function(r){return typeof r===e||"a"+(n<1?"n ":" ")+e}});const RC={};Ob.transitional=function(n,t,r){function a(o,l){return"[Axios v"+Bk+"] Transitional option '"+o+"'"+l+(r?". "+r:"")}return(o,l,d)=>{if(n===!1)throw new Qt(a(l," has been removed"+(t?" in "+t:"")),Qt.ERR_DEPRECATED);return t&&!RC[l]&&(RC[l]=!0,console.warn(a(l," has been deprecated since v"+t+" and will be removed in the near future"))),n?n(o,l,d):!0}};Ob.spelling=function(n){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${n}`),!0)};function TU(e,n,t){if(typeof e!="object")throw new Qt("options must be an object",Qt.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let a=r.length;for(;a-- >0;){const o=r[a],l=n[o];if(l){const d=e[o],f=d===void 0||l(d,o,e);if(f!==!0)throw new Qt("option "+o+" must be "+f,Qt.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Qt("Unknown option "+o,Qt.ERR_BAD_OPTION)}}const Bx={assertOptions:TU,validators:Ob},Uo=Bx.validators;let Id=class{constructor(n){this.defaults=n,this.interceptors={request:new jC,response:new jC}}async request(n,t){try{return await this._request(n,t)}catch(r){if(r instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const o=a.stack?a.stack.replace(/^.+\n/,""):"";try{r.stack?o&&!String(r.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+o):r.stack=o}catch{}}throw r}}_request(n,t){typeof n=="string"?(t=t||{},t.url=n):t=n||{},t=Fd(this.defaults,t);const{transitional:r,paramsSerializer:a,headers:o}=t;r!==void 0&&Bx.assertOptions(r,{silentJSONParsing:Uo.transitional(Uo.boolean),forcedJSONParsing:Uo.transitional(Uo.boolean),clarifyTimeoutError:Uo.transitional(Uo.boolean)},!1),a!=null&&(He.isFunction(a)?t.paramsSerializer={serialize:a}:Bx.assertOptions(a,{encode:Uo.function,serialize:Uo.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Bx.assertOptions(t,{baseUrl:Uo.spelling("baseURL"),withXsrfToken:Uo.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let l=o&&He.merge(o.common,o[t.method]);o&&He.forEach(["delete","get","head","post","put","patch","common"],S=>{delete o[S]}),t.headers=da.concat(l,o);const d=[];let f=!0;this.interceptors.request.forEach(function(k){typeof k.runWhen=="function"&&k.runWhen(t)===!1||(f=f&&k.synchronous,d.unshift(k.fulfilled,k.rejected))});const u=[];this.interceptors.response.forEach(function(k){u.push(k.fulfilled,k.rejected)});let p,g=0,b;if(!f){const S=[IC.bind(this),void 0];for(S.unshift.apply(S,d),S.push.apply(S,u),b=S.length,p=Promise.resolve(t);g<b;)p=p.then(S[g++],S[g++]);return p}b=d.length;let v=t;for(g=0;g<b;){const S=d[g++],k=d[g++];try{v=S(v)}catch(T){k.call(this,T);break}}try{p=IC.call(this,v)}catch(S){return Promise.reject(S)}for(g=0,b=u.length;g<b;)p=p.then(u[g++],u[g++]);return p}getUri(n){n=Fd(this.defaults,n);const t=Lk(n.baseURL,n.url,n.allowAbsoluteUrls);return Dk(t,n.params,n.paramsSerializer)}};He.forEach(["delete","get","head","options"],function(n){Id.prototype[n]=function(t,r){return this.request(Fd(r||{},{method:n,url:t,data:(r||{}).data}))}});He.forEach(["post","put","patch"],function(n){function t(r){return function(o,l,d){return this.request(Fd(d||{},{method:n,headers:r?{"Content-Type":"multipart/form-data"}:{},url:o,data:l}))}}Id.prototype[n]=t(),Id.prototype[n+"Form"]=t(!0)});let EU=class qk{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});const r=this;this.promise.then(a=>{if(!r._listeners)return;let o=r._listeners.length;for(;o-- >0;)r._listeners[o](a);r._listeners=null}),this.promise.then=a=>{let o;const l=new Promise(d=>{r.subscribe(d),o=d}).then(a);return l.cancel=function(){r.unsubscribe(o)},l},n(function(o,l,d){r.reason||(r.reason=new Vh(o,l,d),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const t=this._listeners.indexOf(n);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const n=new AbortController,t=r=>{n.abort(r)};return this.subscribe(t),n.signal.unsubscribe=()=>this.unsubscribe(t),n.signal}static source(){let n;return{token:new qk(function(a){n=a}),cancel:n}}};function AU(e){return function(t){return e.apply(null,t)}}function PU(e){return He.isObject(e)&&e.isAxiosError===!0}const S1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(S1).forEach(([e,n])=>{S1[n]=e});function Vk(e){const n=new Id(e),t=wk(Id.prototype.request,n);return He.extend(t,Id.prototype,n,{allOwnKeys:!0}),He.extend(t,n,null,{allOwnKeys:!0}),t.create=function(a){return Vk(Fd(e,a))},t}const Ar=Vk(lg);Ar.Axios=Id;Ar.CanceledError=Vh;Ar.CancelToken=EU;Ar.isCancel=Mk;Ar.VERSION=Bk;Ar.toFormData=Rb;Ar.AxiosError=Qt;Ar.Cancel=Ar.CanceledError;Ar.all=function(n){return Promise.all(n)};Ar.spread=AU;Ar.isAxiosError=PU;Ar.mergeConfig=Fd;Ar.AxiosHeaders=da;Ar.formToJSON=e=>Rk(He.isHTMLForm(e)?new FormData(e):e);Ar.getAdapter=Uk.getAdapter;Ar.HttpStatusCode=S1;Ar.default=Ar;const{Axios:qne,AxiosError:Vne,CanceledError:Hne,isCancel:Gne,CancelToken:Yne,VERSION:Wne,all:Qne,Cancel:Jne,isAxiosError:Kne,spread:Xne,toFormData:Zne,AxiosHeaders:ere,HttpStatusCode:tre,formToJSON:nre,getAdapter:rre,mergeConfig:ire}=Ar,DU=()=>{const e=localStorage.getItem("currentClinicId");return e||(console.warn("getCurrentClinicId: Clinic ID not found. Returning null. Ensure this is implemented correctly."),null)},Hk=()=>localStorage.getItem("authToken");function IU(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const d=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(f=>f.addEventListener("ended",d)),()=>{e.getTracks().forEach(f=>f.removeEventListener("ended",d))}},[e]),{type:"screen",start:async()=>{const d=await navigator.mediaDevices.getDisplayMedia({video:!0});return n(d),r(!0),d},stop:()=>{e&&(e.getTracks().forEach(d=>d.stop()),n(null),r(!1))},isStreaming:t,stream:e}}function RU(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const d=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(f=>f.addEventListener("ended",d)),()=>{e.getTracks().forEach(f=>f.removeEventListener("ended",d))}},[e]),{type:"webcam",start:async()=>{const d=await navigator.mediaDevices.getUserMedia({video:!0});return n(d),r(!0),d},stop:()=>{e&&(e.getTracks().forEach(d=>d.stop()),n(null),r(!1))},isStreaming:t,stream:e}}class MU extends xk{constructor(t){super();Yn(this,"client");Yn(this,"_status","disconnected");Yn(this,"_session",null);Yn(this,"_model",null);Yn(this,"config",null);this.client=new mk(t),this.send=this.send.bind(this),this.onopen=this.onopen.bind(this),this.onerror=this.onerror.bind(this),this.onclose=this.onclose.bind(this),this.onmessage=this.onmessage.bind(this)}get status(){return this._status}get session(){return this._session}get model(){return this._model}getConfig(){return{...this.config}}log(t,r){const a={date:new Date,type:t,message:r};this.emit("log",a)}async connect(t,r){if(this._status==="connected"||this._status==="connecting")return!1;this._status="connecting",this.config=r,this._model=t;const a={onopen:this.onopen,onmessage:this.onmessage,onerror:this.onerror,onclose:this.onclose};try{this._session=await this.client.live.connect({model:t,config:r,callbacks:a})}catch(o){return console.error("Error connecting to GenAI Live:",o),this._status="disconnected",!1}return this._status="connected",!0}disconnect(){var t;return this.session?((t=this.session)==null||t.close(),this._session=null,this._status="disconnected",this.log("client.close","Disconnected"),!0):!1}onopen(){this.log("client.open","Connected"),this.emit("open")}onerror(t){this.log("server.error",t.message),this.emit("error",t)}onclose(t){this.log("server.close",`disconnected ${t.reason?`with reason: ${t.reason}`:""}`),this.emit("close",t)}async onmessage(t){var r;if(t.setupComplete){this.log("server.send","setupComplete"),this.emit("setupcomplete");return}if(t.toolCall){this.log("server.toolCall",t),this.emit("toolcall",t.toolCall);return}if(t.toolCallCancellation){this.log("server.toolCallCancellation",t),this.emit("toolcallcancellation",t.toolCallCancellation);return}if(t.serverContent){const{serverContent:a}=t;if("interrupted"in a){this.log("server.content","interrupted"),this.emit("interrupted");return}if("turnComplete"in a&&(this.log("server.content","turnComplete"),this.emit("turncomplete")),"modelTurn"in a){let o=((r=a.modelTurn)==null?void 0:r.parts)||[];const l=o.filter(p=>{var g;return p.inlineData&&((g=p.inlineData.mimeType)==null?void 0:g.startsWith("audio/pcm"))}),d=l.map(p=>{var g;return(g=p.inlineData)==null?void 0:g.data}),f=vk.difference(o,l);if(d.forEach(p=>{if(p){const g=Yz(p);this.emit("audio",g),this.log("server.audio",`buffer (${g.byteLength})`)}}),!f.length)return;o=f;const u={modelTurn:{parts:o}};this.emit("content",u),this.log("server.content",t)}}else console.log("received unmatched message",t)}sendRealtimeInput(t){var l;let r=!1,a=!1;for(const d of t)if((l=this.session)==null||l.sendRealtimeInput({media:d}),d.mimeType.includes("audio")&&(r=!0),d.mimeType.includes("image")&&(a=!0),r&&a)break;const o=r&&a?"audio + video":r?"audio":a?"video":"unknown";this.log("client.realtimeInput",o)}sendToolResponse(t){var r;t.functionResponses&&t.functionResponses.length&&((r=this.session)==null||r.sendToolResponse({functionResponses:t.functionResponses}),this.log("client.toolResponse",t))}send(t,r=!0){var a;(a=this.session)==null||a.sendClientContent({turns:t,turnComplete:r}),this.log("client.send",{turns:Array.isArray(t)?t:[t],turnComplete:r})}}function OU(e){const n=w.useMemo(()=>new MU(e),[e]),t=w.useRef(null),[r,a]=w.useState("models/gemini-2.5-flash-live-preview"),[o,l]=w.useState({}),[d,f]=w.useState(!1),[u,p]=w.useState(0),[g,b]=w.useState(null);w.useEffect(()=>{t.current||gk({id:"audio-out"}).then(k=>{t.current=new n8(k),t.current.addWorklet("vumeter-out",yk,T=>{p(T.data.volume)}).then(()=>{})})},[t]),w.useEffect(()=>{const k=()=>{f(!0)},T=()=>{f(!1)},P=L=>{console.error("error",L)},M=()=>{var L;return(L=t.current)==null?void 0:L.stop()},I=L=>{var $;return($=t.current)==null?void 0:$.addPCM16(new Uint8Array(L))},U=L=>{if(console.log("Received content event:",L),L.modelTurn&&L.modelTurn.parts){const $=L.modelTurn.parts.filter(z=>"text"in z&&z.text);if($.length>0){const z=$.map(F=>F.text).join(" ");b(z),console.log("AI Summary received:",z)}}};return n.on("error",P).on("open",k).on("close",T).on("interrupted",M).on("audio",I).on("content",U),()=>{n.off("error",P).off("open",k).off("close",T).off("interrupted",M).off("audio",I).off("content",U).disconnect()}},[n]);const v=w.useCallback(async()=>{if(!o)throw new Error("config has not been set");n.disconnect(),await n.connect(r,o)},[n,o,r]),S=w.useCallback(async()=>{n.disconnect(),f(!1)},[f,n]);return{client:n,config:o,setConfig:l,model:r,setModel:a,connected:d,connect:v,disconnect:S,volume:u,aiSummary:g}}const Gk=w.createContext(void 0),Cw=({options:e,children:n})=>{const t=OU(e);return i.jsx(Gk.Provider,{value:t,children:n})},mu=()=>{const e=w.useContext(Gk);if(!e)throw new Error("useLiveAPIContext must be used wihin a LiveAPIProvider");return e};function LU(){const{config:e,setConfig:n}=mu(),[t,r]=w.useState({value:"audio",label:"audio"}),a=w.useCallback(o=>{n({...e,responseModalities:[o==="audio"?uu.AUDIO:uu.TEXT]})},[e,n]);return i.jsxs("div",{className:"select-group",children:[i.jsx("label",{htmlFor:"response-modality-selector",children:"Response modality"}),i.jsx(X2,{id:"response-modality-selector",className:"react-select",classNamePrefix:"react-select",styles:{},defaultValue:t,options:[{value:"audio",label:"audio"},{value:"text",label:"text"}],onChange:o=>{r(o),o&&(o.value==="audio"||o.value==="text")&&a(o.value)}})]})}const MC=[{value:"Puck",label:"Puck"},{value:"Charon",label:"Charon"},{value:"Kore",label:"Kore"},{value:"Fenrir",label:"Fenrir"},{value:"Aoede",label:"Aoede"}];function FU(){const{config:e,setConfig:n}=mu();w.useEffect(()=>{var d,f,u;const o=((u=(f=(d=e.speechConfig)==null?void 0:d.voiceConfig)==null?void 0:f.prebuiltVoiceConfig)==null?void 0:u.voiceName)||"Atari02";r({value:o,label:o})},[e]);const[t,r]=w.useState(MC[5]),a=w.useCallback(o=>{n({...e,speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:o}}}})},[e,n]);return i.jsxs("div",{className:"select-group",children:[i.jsx("label",{htmlFor:"voice-selector",children:"Voice"}),i.jsx(X2,{id:"voice-selector",className:"react-select",classNamePrefix:"react-select",styles:{},value:t,defaultValue:t,options:MC,onChange:o=>{r(o),o&&a(o.value)}})]})}function $U(){const[e,n]=w.useState(!1),{config:t,setConfig:r,connected:a}=mu(),o=w.useMemo(()=>Array.isArray(t.tools)?t.tools.filter(u=>Array.isArray(u.functionDeclarations)).map(u=>u.functionDeclarations).filter(u=>!!u).flat():[],[t]),l=w.useMemo(()=>{var u;return t.systemInstruction?typeof t.systemInstruction=="string"?t.systemInstruction:Array.isArray(t.systemInstruction)?t.systemInstruction.map(p=>typeof p=="string"?p:p.text).join(`
`):typeof t.systemInstruction=="object"&&"parts"in t.systemInstruction&&((u=t.systemInstruction.parts)==null?void 0:u.map(p=>p.text).join(`
`))||"":""},[t]),d=w.useCallback(u=>{const p={...t,systemInstruction:u.target.value};r(p)},[t,r]),f=w.useCallback((u,p)=>{var b;const g={...t,tools:((b=t.tools)==null?void 0:b.map(v=>{const S=v;return Array.isArray(S.functionDeclarations)?{...v,functionDeclarations:S.functionDeclarations.map(k=>k.name===u?{...k,description:p}:k)}:v}))||[]};r(g)},[t,r]);return i.jsxs("div",{className:"settings-dialog",children:[i.jsx("button",{className:"action-button material-symbols-outlined",onClick:()=>n(!e),children:"settings"}),i.jsx("dialog",{className:"dialog",style:{display:e?"block":"none"},children:i.jsxs("div",{className:`dialog-container ${a?"disabled":""}`,children:[a&&i.jsx("div",{className:"connected-indicator",children:i.jsx("p",{children:"These settings can only be applied before connecting and will override other settings."})}),i.jsxs("div",{className:"mode-selectors",children:[i.jsx(LU,{}),i.jsx(FU,{})]}),i.jsx("h3",{children:"System Instructions"}),i.jsx("textarea",{className:"system",onChange:d,value:l}),i.jsx("h4",{children:"Function declarations"}),i.jsx("div",{className:"function-declarations",children:i.jsx("div",{className:"fd-rows",children:o.map((u,p)=>{var g;return i.jsxs("div",{className:"fd-row",children:[i.jsx("span",{className:"fd-row-name",children:u.name}),i.jsx("span",{className:"fd-row-args",children:Object.keys(((g=u.parameters)==null?void 0:g.properties)||{}).map((b,v)=>i.jsx("span",{children:b},v))}),i.jsx("input",{className:"fd-row-description",type:"text",defaultValue:u.description,onBlur:b=>f(u.name,b.target.value)},`fd-${u.description}`)]},`function-${p}`)})})})]})})]})}const OC=w.memo(({isStreaming:e,onIcon:n,offIcon:t,start:r,stop:a})=>e?i.jsx("button",{className:"action-button",onClick:a,children:i.jsx("span",{className:"material-symbols-outlined",children:n})}):i.jsx("button",{className:"action-button",onClick:r,children:i.jsx("span",{className:"material-symbols-outlined",children:t})}));function zU({videoRef:e,children:n,onVideoStreamChange:t=()=>{},supportsVideo:r,enableEditingSettings:a}){const o=[RU(),IU()],[l,d]=w.useState(null),[f,u]=o,[p,g]=w.useState(0),[b]=w.useState(()=>new bk),[v,S]=w.useState(!1),k=w.useRef(null),T=w.useRef(null),{client:P,connected:M,connect:I,disconnect:U,volume:L}=mu();w.useEffect(()=>{!M&&T.current&&T.current.focus()},[M]),w.useEffect(()=>{document.documentElement.style.setProperty("--volume",`${Math.max(5,Math.min(p*200,8))}px`)},[p]),w.useEffect(()=>{const z=F=>{P.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:F}])};return M&&!v&&b?b.on("data",z).on("volume",g).start():b.stop(),()=>{b.off("data",z).off("volume",g)}},[M,P,v,b]),w.useEffect(()=>{e.current&&(e.current.srcObject=l);let z=-1;function F(){const Y=e.current,R=k.current;if(!Y||!R)return;const B=R.getContext("2d");if(R.width=Y.videoWidth*.25,R.height=Y.videoHeight*.25,R.width+R.height>0){B.drawImage(Y,0,0,R.width,R.height);const G=R.toDataURL("image/jpeg",1),ie=G.slice(G.indexOf(",")+1,1/0);P.sendRealtimeInput([{mimeType:"image/jpeg",data:ie}])}M&&(z=window.setTimeout(F,1e3/.5))}return M&&l!==null&&requestAnimationFrame(F),()=>{clearTimeout(z)}},[M,l,P,e]);const $=z=>async()=>{if(z){const F=await z.start();d(F),t(F)}else d(null),t(null);o.filter(F=>F!==z).forEach(F=>F.stop())};return i.jsxs("section",{className:"control-tray",children:[i.jsx("canvas",{style:{display:"none"},ref:k}),i.jsxs("nav",{className:ou("actions-nav",{disabled:!M}),children:[i.jsx("button",{className:ou("action-button mic-button",{recording:!v&&M}),onClick:()=>S(!v),children:v?i.jsx("span",{className:"material-symbols-outlined filled",children:"mic_off"}):i.jsx("span",{className:"material-symbols-outlined filled",children:"mic"})}),i.jsx("div",{className:"action-button no-action outlined",children:i.jsx(Zz,{volume:L,active:M,hover:!1})}),r&&i.jsxs(i.Fragment,{children:[i.jsx(OC,{isStreaming:u.isStreaming,start:$(u),stop:$(),onIcon:"cancel_presentation",offIcon:"present_to_all"}),i.jsx(OC,{isStreaming:f.isStreaming,start:$(f),stop:$(),onIcon:"videocam_off",offIcon:"videocam"})]}),n]}),i.jsxs("div",{className:ou("connection-container",{connected:M}),children:[i.jsx("div",{className:"connection-button-container",children:i.jsx("button",{ref:T,className:ou("action-button connect-toggle",{connected:M}),onClick:M?U:I,children:i.jsx("span",{className:"material-symbols-outlined filled",children:M?"pause":"play_arrow"})})}),i.jsx("span",{className:"text-indicator",children:"Streaming"})]}),a?i.jsx($U,{}):""]})}const LC={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Ih.OBJECT,properties:{summary:{type:Ih.STRING,description:"The summary of the patient's case."}},required:["summary"]}},UU=({patientData:e,tokenNumber:n})=>{const[t,r]=w.useState(""),{client:a,setConfig:o,setModel:l}=mu();return w.useEffect(()=>{l("models/gemini-2.5-flash-live-preview"),o({responseModalities:[uu.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:`Your job is to:

If patient details like name, age, sex, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details (e.g., phone number) are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's name, age, sex, and phone number.

When pronouncing a phone number, always state each digit individually (e.g., "six three" instead of "sixty-three" or "six billion three").

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in Telugu.dont write the telugu words in english`}]},tools:[{functionDeclarations:[LC]}]})},[o,l]),w.useEffect(()=>{const d=f=>{if(!f.functionCalls)return;const u=f.functionCalls.find(p=>p.name===LC.name);if(u){const p=u.args.summary;r(p)}f.functionCalls.length&&setTimeout(()=>{var p;return a.sendToolResponse({functionResponses:(p=f.functionCalls)==null?void 0:p.map(g=>({response:{output:{success:!0}},id:g.id,name:g.name}))})},200)};return a.on("toolcall",d),()=>{a.off("toolcall",d)}},[a]),w.useEffect(()=>{if(t){const d=encodeURIComponent(t);n?window.location.href=`https://hms.newtons.in/handle-complaint-url?token=${n}&caseDetails=${d}`:window.location.href=`https://hms.newtons.in/dashboard/search-patient?caseDetails=${d}`}},[t,n]),i.jsxs("div",{className:"hospital-reception",children:[i.jsx("h1",{children:"Newtons Ai"}),i.jsx("p",{children:"Newtons Ai"}),n&&i.jsxs("h2",{children:["Token Number: ",n]}),e&&i.jsxs("div",{children:[i.jsx("h2",{children:"Patient Details"}),i.jsx("pre",{children:JSON.stringify(e,null,2)})]}),t&&i.jsxs("div",{children:[i.jsx("h2",{children:"Case Summary (from Tool Call)"}),i.jsx("p",{children:t})]})]})},FC="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes";async function BU(){const e=Hk();if(!e)return console.warn("No auth token found, using default Live API key."),FC;try{const t=(await Ar.get("/api/clinics/gemini-api-key",{headers:{Authorization:`Bearer ${e}`}})).data.geminiApiKey;if(t)return t}catch(n){console.error("Failed to fetch clinic-specific Live API key:",n)}return console.warn("Clinic-specific Live API key not found or failed to fetch, using default."),FC}function qU(){const e=w.useRef(null),[n,t]=w.useState(null),[r,a]=w.useState(null);return w.useEffect(()=>{(async()=>{try{const l=await BU();a({apiKey:l})}catch(l){console.error("Error setting Live API options:",l)}})()},[]),r?i.jsx("div",{className:"App",children:i.jsx(Cw,{options:r,children:i.jsx(VU,{videoRef:e,setVideoStream:t,videoStream:n})})}):i.jsx("div",{children:"Loading Live API settings..."})}const VU=({videoRef:e,setVideoStream:n,videoStream:t})=>{const[r,a]=w.useState(null),[o,l]=w.useState(null),{connected:d,client:f,connect:u,config:p,model:g}=mu(),[b,v]=w.useState(""),S=w.useRef(null),[k,T]=w.useState(!1);w.useEffect(()=>{const M=window.matchMedia("(prefers-color-scheme: dark)"),I=U=>{document.documentElement.setAttribute("data-theme",U.matches?"dark":"light")};return I(M),M.addEventListener("change",I),()=>M.removeEventListener("change",I)},[]),w.useEffect(()=>{const M=new URLSearchParams(window.location.search),I={};for(const[U,L]of M.entries())U==="token_number"?l(L):I[U]=L;a(I)},[]),w.useEffect(()=>{Object.keys(p).length>0&&g&&u()},[u,p,g]),w.useEffect(()=>{if(d&&r&&!k){const M=JSON.stringify(r,null,2);f.send([{text:M}]),v(""),T(!0)}},[d,r,f,k]),w.useEffect(()=>{r&&v(JSON.stringify(r,null,2))},[r]);const P=()=>{f.send([{text:b}]),v(""),S.current&&(S.current.innerText="")};return i.jsx("div",{className:"streaming-console",children:i.jsxs("main",{children:[i.jsxs("div",{className:"main-app-area",children:[i.jsx(UU,{patientData:r,tokenNumber:o}),i.jsx("video",{className:ou("stream",{hidden:!e.current||!t}),ref:e,autoPlay:!0,playsInline:!0})]}),i.jsx("div",{className:ou("input-container",{disabled:!d}),children:i.jsxs("div",{className:"input-content",children:[i.jsx("textarea",{className:"input-area",ref:S,onKeyDown:M=>{M.key==="Enter"&&!M.shiftKey&&(M.preventDefault(),M.stopPropagation(),P())},onChange:M=>v(M.target.value),value:b}),i.jsx("span",{className:ou("input-content-placeholder",{hidden:b.length}),children:"Typesomething..."}),i.jsx("button",{className:"send-button material-symbols-outlined filled",onClick:P,children:"send"})]})}),i.jsx(zU,{videoRef:e,supportsVideo:!0,onVideoStreamChange:n,enableEditingSettings:!0})]})})},$C="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",HU=({volume:e,active:n})=>{const t=Array.from({length:5},(r,a)=>i.jsx("div",{className:`audio-bar ${n?"active":""}`,style:{height:n?`${Math.min(24,20+e*40*(1+Math.sin(a)*.3))}px`:"8px",animationDelay:`${a*.1}s`}},a));return i.jsx("div",{className:"audio-pulse",children:t})},GU=w.forwardRef(({videoRef:e,supportsVideo:n,onVideoStreamChange:t,textInput:r,onSubmitTextInput:a},o)=>{var $;const{connected:l,connect:d,disconnect:f,client:u,volume:p}=mu(),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[P]=w.useState(()=>new bk),M=async()=>{l?await f():(await d(),r.trim()&&a())};w.useEffect(()=>{const z=F=>{u.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:F}])};return l&&!g?P.on("data",z).start():P.stop(),()=>{P.off("data",z),P.stop()}},[l,u,g,P]);const I=w.useCallback(async()=>{if(v)L==null||L.getTracks().forEach(z=>z.stop()),t(null),S(!1);else try{const z=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=z),t(z),S(!0)}catch(z){console.error("Error accessing webcam:",z),S(!1)}},[v,t,e]),U=w.useCallback(async()=>{if(k)L==null||L.getTracks().forEach(z=>z.stop()),t(null),T(!1);else try{const z=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=z),t(z),T(!0)}catch(z){console.error("Error accessing screen share:",z),T(!1)}},[k,t,e]),L=($=e.current)==null?void 0:$.srcObject;return w.useEffect(()=>()=>{L&&L.getTracks().forEach(z=>z.stop())},[L]),w.useImperativeHandle(o,()=>({handleConnect:M})),i.jsx("div",{className:"live-api-control-tray",children:i.jsxs("div",{className:"live-api-control-tray-inner",children:[i.jsxs("div",{className:"live-api-control-group",children:[i.jsx("button",{onClick:()=>b(!g),disabled:!l,className:`live-api-control-button ${l&&!g?"mic-active":"mic-inactive"}`,"aria-label":g?"Unmute microphone":"Mute microphone",children:g?i.jsx(lR,{className:"w-5 h-5"}):i.jsx(a2,{className:"w-5 h-5"})}),i.jsx("div",{className:"live-api-audio-pulse-container",children:i.jsx(HU,{volume:p,active:l})}),n&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:U,disabled:!l,className:`live-api-control-button ${k?"video-active":"video-inactive"}`,"aria-label":k?"Stop screen share":"Start screen share",children:i.jsx(dR,{className:"w-5 h-5"})}),i.jsx("button",{onClick:I,disabled:!l,className:`live-api-control-button ${v?"video-active":"video-inactive"}`,"aria-label":v?"Turn off webcam":"Turn on webcam",children:i.jsx(i4,{className:"w-5 h-5"})})]})]}),i.jsxs("div",{className:"live-api-control-group",children:[i.jsxs("div",{className:"live-api-status-indicator",children:[i.jsx("div",{className:`live-api-status-dot ${l?"connected":"disconnected"}`}),i.jsx("span",{className:"live-api-status-text",children:l?"Streaming":"Disconnected"})]}),i.jsx("button",{onClick:M,className:`live-api-connect-button ${l?"connected":"disconnected"}`,children:l?i.jsxs(i.Fragment,{children:[i.jsx(xR,{className:"w-5 h-5"}),i.jsx("span",{children:"Pause"})]}):i.jsxs(i.Fragment,{children:[i.jsx(CR,{className:"w-5 h-5"}),i.jsx("span",{children:"Start"})]})})]})]})})}),YU=({patientData:e,tokenNumber:n,aiSummary:t,clinicName:r})=>i.jsxs("div",{className:"hospital-reception-container",children:[i.jsxs("div",{className:"hospital-reception-logo-section",children:[i.jsx("div",{className:"hospital-reception-logo",children:i.jsx("span",{children:r.charAt(0)})}),i.jsxs("h1",{className:"hospital-reception-title",children:[r," AI"]}),i.jsxs("p",{className:"hospital-reception-subtitle",children:["Intelligent ",r," Reception Assistant"]})]}),n&&i.jsxs("div",{className:"hospital-reception-token-card",children:[i.jsx("h2",{className:"hospital-reception-token-title",children:"Token Number"}),i.jsx("p",{className:"hospital-reception-token-number",children:n})]}),e?i.jsxs("div",{className:"hospital-reception-patient-info-card",children:[i.jsx("h3",{className:"hospital-reception-patient-info-title",children:"Patient Information"}),i.jsx("div",{className:"hospital-reception-patient-info-content",children:i.jsx("pre",{className:"hospital-reception-patient-info-pre",children:JSON.stringify(e,null,2)})})]}):i.jsxs("div",{className:"hospital-reception-patient-info-card",children:[i.jsx("h3",{className:"hospital-reception-patient-info-title",children:"New Case"}),i.jsx("p",{className:"hospital-reception-patient-info-pre",children:"No patient data provided. This is a new case."})]}),t&&i.jsxs("div",{className:"hospital-reception-summary-card",children:[i.jsx("h3",{className:"hospital-reception-summary-title",children:"Case Summary"}),i.jsx("p",{className:"hospital-reception-summary-text",children:t})]})]}),zC={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Ih.OBJECT,properties:{summary:{type:Ih.STRING,description:"The summary of the patient's case."}},required:["summary"]}},WU=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:a})=>{const o=w.useRef(null),l=w.useRef(null),[d,f]=w.useState(null),[u,p]=w.useState("hi"),{client:g,connected:b,setConfig:v,setModel:S,disconnect:k}=mu(),T=w.useMemo(()=>{let L=`Your job is to:

If patient details like name, age, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details (Name, Age) are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's Name and Age only. Do not ask for their phone number.

    You should guess the patient's sex based on their voice or appearance.

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in Telugu. Dont write the telugu words in english.`;return n&&(L+=`

Patient Data: ${JSON.stringify(n,null,2)}`),{responseModalities:[uu.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:L}]},tools:[{functionDeclarations:[zC]}]}},[n]);w.useEffect(()=>{S("models/gemini-2.5-flash-native-audio-preview-12-2025"),v(T);const L=setTimeout(()=>{l.current&&!b&&l.current.handleConnect()},2e3);return()=>clearTimeout(L)},[v,S,T,b]),w.useEffect(()=>()=>{b&&k()},[b,k]);const[P,M]=w.useState(null);w.useEffect(()=>{const L=$=>{if(!$.functionCalls)return;const z=$.functionCalls.find(F=>F.name===zC.name);if(z){const F=z.args.summary;M(F),r(F)}$.functionCalls.length&&setTimeout(()=>{var F;return g.sendToolResponse({functionResponses:(F=$.functionCalls)==null?void 0:F.map(Y=>({response:{output:{success:!0}},id:Y.id,name:Y.name}))})},200)};return g.on("toolcall",L),()=>{g.off("toolcall",L)}},[g,r]);const I=()=>{u.trim()&&(g.send([{text:u}]),p(""))},U=L=>{L.key==="Enter"&&!L.shiftKey&&(L.preventDefault(),I())};return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsxs("div",{className:"live-api-modal-content",children:[i.jsxs("div",{className:"live-api-modal-header",children:[i.jsxs("div",{className:"live-api-modal-header-left",children:[i.jsx("div",{className:"live-api-modal-logo",children:i.jsx("span",{children:a.charAt(0)})}),i.jsxs("div",{children:[i.jsx("h1",{className:"live-api-modal-title",children:a}),i.jsxs("p",{className:"live-api-modal-subtitle",children:[a," Hospital Assistant"]})]})]}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("button",{onClick:e,className:"live-api-modal-close-button","aria-label":"Close modal",children:i.jsx(Xn,{className:"w-6 h-6"})})})]}),i.jsx("div",{className:"live-api-modal-main-content",children:i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsxs("div",{className:"live-api-reception-area",children:[i.jsx(YU,{patientData:n,tokenNumber:t,aiSummary:P,clinicName:a}),d&&i.jsx("video",{ref:o,autoPlay:!0,playsInline:!0,className:"live-api-video-stream"})]}),i.jsx("div",{className:"live-api-input-area",children:i.jsxs("div",{className:"live-api-input-container",children:[i.jsx("textarea",{value:u,onChange:L=>p(L.target.value),onKeyDown:U,placeholder:"Type your message here...",disabled:!b,rows:1,className:"live-api-textarea"}),i.jsx("button",{onClick:I,disabled:!b||!u.trim(),className:"live-api-send-button","aria-label":"Send message",children:i.jsx(PR,{className:"w-5 h-5"})})]})}),i.jsx(GU,{ref:l,videoRef:o,supportsVideo:!0,onVideoStreamChange:f,textInput:u,onSubmitTextInput:I})]})})]})})},Yk=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r})=>{const[a,o]=w.useState(null),[l,d]=w.useState("Newtons Ai"),[f,u]=w.useState(!0);if(w.useEffect(()=>{(async()=>{try{let b=null,v="Newtons Ai";try{const S=await pe("/api/clinics/settings");if(S.ok){const k=await S.json();k.name&&k.name!==""&&(v=k.name),k.gemini_api_key&&k.gemini_api_key.trim()!==""&&(b=k.gemini_api_key.trim())}}catch(S){console.warn("Failed to fetch clinic settings",S)}if(d(v),b)o(b);else{try{const S=await pe("/api/global-settings/app_gemini_api_key");if(S.ok){const k=await S.json();if(k.value&&k.value.trim()!==""){o(k.value.trim());return}}}catch(S){console.warn("Failed to fetch global key fallback",S)}o($C)}}catch(b){console.error("Unexpected error in getSettings:",b),o($C)}finally{u(!1)}})()},[]),f)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsx("div",{className:"live-api-modal-content",style:{maxHeight:"200px",maxWidth:"400px",borderRadius:"1rem",justifyContent:"center"},children:i.jsxs("div",{className:"live-api-loading-container",children:[i.jsx("div",{className:"live-api-loading-spinner"}),i.jsx("div",{className:"live-api-loading-text",children:"Initializing AI Assistant..."})]})})});if(!a)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsx("div",{className:"live-api-modal-content",children:i.jsx("div",{children:"Error: API Key not available."})})});const p={apiKey:a};return i.jsx(Cw,{options:p,children:i.jsx(WU,{onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:l})})},QU="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",JU={apiKey:QU},Sh=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,o]=w.useState(!1),[l,d]=w.useState(null),[f,u]=w.useState(!1),[p,g]=w.useState(null),b=w.useRef(null),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[P,M]=w.useState(null),[I,U]=w.useState(null),[L,$]=w.useState([]),z=Et(),F=Yr();w.useEffect(()=>{(async()=>{try{const se=new URLSearchParams({page:"1",limit:"5",sortBy:"createdAt",sortOrder:"desc"}),re=await pe(`/api/patients?${se.toString()}`);if(re.ok){const oe=await re.json();$(oe.patients||[])}}catch(se){console.error("Error fetching recent patients:",se)}})()},[]);const Y=w.useCallback(async V=>{const se=V||e;if(!se.trim()){g("Please enter complaint details.");return}u(!0),g(null);try{const re=await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"New Patient - Direct Entry",age:null,gender:null,phone:null,address:null})});if(!re.ok){const ue=await re.json().catch(()=>({message:"Failed to create patient"}));if(re.status===403&&ue.message.includes("Patient limit")){z("/start-clinic-subscription",{state:{errorMessage:ue.message}});return}throw new Error(ue.message||`Failed to create patient: ${re.statusText}`)}const oe=await re.json();if(!oe||!oe.id)throw new Error("Failed to create new patient or retrieve patient ID.");const E=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:oe.id,complaint:se})});if(!E.ok){const ue=await E.text();throw new Error(`Failed to create queue entry: ${ue||E.statusText}`)}const le=await E.json();if(!le||!le.id)throw new Error("Failed to create new complaint record or retrieve record ID.");z(`/dashboard/edit-complaint/${le.id}`,{state:{initialComplaint:se}})}catch(re){console.error("Error starting new complaint:",re),re.message.includes("Patient limit")?(g(`Error: ${re.message}. Please upgrade your plan.`),z("/start-clinic-subscription")):g(`Error: ${re.message||"Failed to start new complaint process."}`)}finally{u(!1)}},[e,z]);w.useEffect(()=>{const V=b.current;V&&(V.style.height="auto",V.style.height=`${V.scrollHeight}px`);const re=new URLSearchParams(F.search).get("caseDetails");if(re){const oe=decodeURIComponent(re);oe!==e&&(n(oe),S(!0))}},[F.search,e]),w.useEffect(()=>{v&&e.trim()&&(z(F.pathname,{replace:!0}),Y(e),S(!1))},[v,e,Y,z,F.pathname]),w.useEffect(()=>{const V=b.current;V&&(V.style.height="auto",V.style.height=`${V.scrollHeight}px`)},[e]),w.useEffect(()=>{P&&(n(P),T(!1),Y(P),M(null))},[P,Y]);const R=()=>{U({id:null,token:null,name:"New Case",age:null,gender:null}),T(!0)},B=w.useMemo(()=>vb(async V=>{const se=V.trim(),re=/^\d+$/.test(se),oe=se.split(/\s+/).length;if(se.length<2||re&&se.length>10||!re&&oe>2){r([]),o(!1),d(null);return}o(!0),d(null);try{const E=new URLSearchParams({search:encodeURIComponent(V),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),le=await pe(`/api/patients?${E.toString()}`);if(!le.ok){const D=await le.text();throw new Error(`API Error (${le.status}): ${D||le.statusText}`)}const ue=await le.json();r(ue.patients)}catch(E){console.error("Error searching patients:",E),d(E.message||"Failed to search patients."),r([])}finally{o(!1)}},300),[]),G=V=>{const se=V.target.value;n(se);const re=se.trim(),oe=/^\d+$/.test(re),E=re.split(/\s+/).length;re.length>=2&&!(oe&&re.length>10||!oe&&E>2)?o(!0):(o(!1),r([])),B(se)},ie=V=>{V.key==="Enter"&&!V.shiftKey&&(V.preventDefault(),t.length>0&&!a?te(t[0]):e.trim()&&!a&&Y(e))},te=async V=>{V&&V.id&&z(`/dashboard/edit-complaint/patient/${V.id}`)},W=[{icon:"",title:"Example: Fever & Cold",description:"Rajesh Kumar, 35 year old male, fever since 2 days, cold, body pain, no cough",text:"Rajesh Kumar, 35 year old male, fever since 2 days, cold, body pain, no cough"},{icon:"",title:"Example: Stomach Ache",description:"Priya Sharma, 28 year old female, stomach pain after eating, acidity, bloating since 3 days",text:"Priya Sharma, 28 year old female, stomach pain after eating, acidity, bloating since 3 days"}];return i.jsxs("div",{className:"patient-search-page-container",children:[i.jsxs("div",{className:"patient-search-header",children:[i.jsx("button",{onClick:()=>z("/dashboard/queue"),className:"patient-search-button patient-search-button-primary",children:"OPD Queue"}),i.jsx("button",{onClick:()=>z(-1),className:"patient-search-button patient-search-button-back",children:i.jsx(nn,{size:16})})]}),i.jsxs("div",{className:"patient-search-content-box",children:[l&&i.jsx("p",{className:"patient-search-error",children:l}),p&&i.jsx("p",{className:"patient-search-error",children:p}),L.length>0&&i.jsxs("div",{className:"newly-registered-section",children:[i.jsx("div",{className:"recent-list",children:L.map(V=>i.jsxs("div",{className:"recent-patient-pill",onClick:()=>te(V),children:[i.jsxs("div",{className:"recent-name-container",children:[i.jsx("span",{className:"recent-name",children:V.name||"New Patient"}),i.jsxs("span",{className:"recent-token",children:["#",V.token]})]}),i.jsxs("div",{className:"recent-info",children:[V.age," yrs / ",V.gender]})]},V.id))}),i.jsx("div",{className:"newly-registered-label",children:"NEWLY REGISTERED"})]}),i.jsxs("div",{className:"example-cases-section",children:[i.jsxs("div",{className:"example-cases-header",children:[i.jsx("span",{className:"sparkles-icon",children:""}),i.jsx("h3",{children:"Try AI with Example Cases"})]}),i.jsx("div",{className:"example-cards-container",children:W.map((V,se)=>i.jsxs("div",{className:"example-case-card",onClick:()=>n(V.text),children:[i.jsx("div",{className:"example-icon",children:V.icon}),i.jsxs("div",{className:"example-content",children:[i.jsx("div",{className:"example-title",children:V.title}),i.jsx("div",{className:"example-description",children:V.description})]})]},se))})]})]}),i.jsxs("div",{className:"sticky-chat-input-box",children:[t.length>0&&!f&&i.jsx("ul",{className:"patient-search-results-list",children:t.map(V=>i.jsxs("li",{onClick:()=>te(V),className:"patient-search-result-item",children:[i.jsxs("div",{className:"patient-search-result-item-name-container",children:[i.jsxs("span",{className:"patient-search-result-item-token",children:["[#",V.token,"]"]}),i.jsx("span",{className:"patient-search-result-item-name",children:V.name})]}),i.jsxs("div",{className:"patient-search-result-item-details",children:[V.age?`${V.age} yrs`:"",V.age&&V.gender?" / ":"",V.gender||"N/A"]})]},V.id))}),e.length>=2&&!a&&t.length===0&&!l&&i.jsxs("p",{className:"patient-search-no-results",children:['No patients found matching, taking new case: "',e,'".']}),i.jsxs("div",{className:"chat-input-controls",children:[i.jsx("textarea",{ref:b,placeholder:"Search by Name/Phone/Token or Enter New Case: Name, Age, Sex, Complaint...",value:e,onChange:G,onKeyDown:ie,className:"chat-input",autoFocus:!0,disabled:f,rows:1}),i.jsx("button",{onClick:e.trim()?()=>Y(e):R,className:`chat-submit-button ${f||a?"opacity-50":""}`,disabled:f||a||!!e.trim()&&!e.trim(),"aria-label":e.trim()?"Create New Case":"Use Microphone",children:f||a?i.jsx("div",{className:"spinner"}):e.trim()?i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24",children:i.jsx("path",{d:"M12 4l1.41 1.41L7.83 11H20v2H7.83l5.58 5.59L12 20l-8-8 8-8z",transform:"rotate(90 12 12)"})}):i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24",children:i.jsx("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm-1.2-9.1c0-.66.54-1.2 1.2-1.2s1.2.54 1.2 1.2V9c0 .66-.54 1.2-1.2 1.2s-1.2-.54-1.2-1.2V4.9zM17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"})})})]})]}),k&&i.jsx(Cw,{options:JU,children:i.jsx(Yk,{onClose:()=>T(!1),patientData:I,tokenNumber:null,onAiSummaryChange:M})})]})},KU=({})=>{const e=Et(),[n]=w.useState("patientSearch"),[t]=w.useState(!1),[r,a]=w.useState(null),[o,l]=w.useState(null);return w.useEffect(()=>{if(o){const d=setTimeout(()=>l(null),5e3);return()=>clearTimeout(d)}},[o]),t?i.jsxs("div",{className:"loading-animation-container",children:[" ",i.jsx("div",{className:"breathing-ball"}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Admin Panel..."})]}):i.jsxs("div",{className:"admin-panel-container",children:[" ",o&&i.jsxs("div",{className:`alert-box ${o.type==="success"?"alert-box-success":"alert-box-error"} fixed top-4 right-4 z-[100]`,role:"alert",children:[i.jsx("div",{className:"alert-box-icon",children:o.type==="success"?i.jsx(fs,{size:18}):i.jsx(Er,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{children:o.message})}),i.jsx("button",{onClick:()=>l(null),className:"alert-box-close",children:i.jsx(Xn,{size:16})})]}),r&&i.jsxs("div",{className:"alert-box alert-box-error mb-4",role:"alert",children:[" ",i.jsx("div",{className:"alert-box-icon",children:i.jsx(Er,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{className:"block sm:inline flex-1",children:r})}),i.jsx("button",{onClick:()=>a(null),className:"alert-box-close",children:i.jsx(Xn,{size:16})})]}),i.jsxs("div",{className:"admin-nav-bar",children:[" ",i.jsxs("button",{onClick:()=>window.location.reload(),className:"admin-nav-button",title:"Refresh Page",children:[i.jsx(t2,{})," "]}),i.jsxs("button",{onClick:()=>e("/dashboard/clinic-hub"),className:"admin-nav-button",children:[i.jsx(r2,{})," Clinic"]}),i.jsxs("button",{onClick:()=>e("/dashboard/inventory"),className:"admin-nav-button",children:[i.jsx(ig,{})," Inventory"]}),i.jsxs("button",{onClick:()=>e("/dashboard/analysis"),className:"admin-nav-button",children:[i.jsx(X0,{})," Analysis"]}),i.jsx("button",{onClick:()=>e("/lab-inventory"),className:"admin-nav-button hidden-button",children:"Lab Inventory"}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions"),className:"admin-nav-button hidden-button",children:[i.jsx($I,{})," Subscriptions"]}),i.jsx("button",{onClick:()=>e("/refill-reminders"),className:"admin-nav-button",children:"Refills"}),i.jsxs("button",{onClick:()=>e("/create-lab-order"),className:"admin-nav-button",children:[i.jsx(X0,{})," Labs"]}),i.jsxs("button",{onClick:()=>e("/dashboard/patients"),className:"admin-nav-button",children:[i.jsx(zh,{})," Patients"]})]}),i.jsxs("div",{className:"space-y-6",children:[" ",n==="patientSearch"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(Sh,{})})]})]})},tu=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},XU=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},hh=({title:e,icon:n,items:t,renderItemContent:r,isLoading:a,loadingText:o,noDataText:l})=>{const d=w.useMemo(()=>{const f={};t.forEach(p=>{if(isNaN(p.date.getTime())){f["Unknown Date"]||(f["Unknown Date"]=[]),f["Unknown Date"].push(p);return}const g=XU(p.originalDateString);f[g]||(f[g]=[]),f[g].push(p)});const u=Object.keys(f);return u.sort((p,g)=>{if(p==="Unknown Date")return 1;if(g==="Unknown Date")return-1;try{const b=k=>{const T=k.split(" ");if(T.length===3){const M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(T[1]);if(M!==-1)return new Date(parseInt(T[2]),M,parseInt(T[0]))}return new Date(k)},v=b(p),S=b(g);if(!isNaN(v.getTime())&&!isNaN(S.getTime()))return S.getTime()-v.getTime()}catch(b){console.error("Error parsing date for sorting:",b)}return g.localeCompare(p)}),u.map(p=>({date:p,items:f[p]}))},[t]);return i.jsxs("div",{className:"mb-2 bg-slate-50 rounded-lg border border-slate-200 overflow-hidden",children:[i.jsxs("h4",{className:"text-xs font-semibold text-slate-700 bg-slate-100 px-3 py-2 border-b border-slate-200 flex items-center",children:[n&&i.jsx(n,{size:14,className:"mr-2 text-indigo-600"}),e]}),i.jsxs("div",{className:"p-2",children:[a&&i.jsx("p",{className:"text-slate-500 italic text-xs px-1",children:o}),!a&&t.length===0&&i.jsx("p",{className:"text-slate-500 italic text-xs px-1",children:l}),!a&&t.length>0&&i.jsx("div",{className:"space-y-3",children:d.map(({date:f,items:u})=>i.jsxs("div",{children:[i.jsx("h5",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-1.5 px-1",children:f}),i.jsx("div",{className:"space-y-2 pl-2 border-l-2 border-slate-200 ml-1",children:u.map((p,g)=>i.jsx("div",{className:"flex items-start",children:i.jsx("div",{className:"flex-grow",children:r(p)})},`${p.type}-${p.originalDateString}-${g}`))})]},f))})]})]})},l0=()=>{var se,re;const[e,n]=w.useState({currentPatient:null,nextPatient:null,waitingCount:0}),[t,r]=w.useState(!0),[a,o]=w.useState(null),[l,d]=w.useState(null),[f,u]=w.useState(null),[p,g]=w.useState(null),[b,v]=w.useState({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),[S,k]=w.useState(!1),[T,P]=w.useState(null),{patientId:M}=Vi(),I=Et(),U=w.useCallback(async oe=>{g(null),d(null),u(null),k(!0),P(null),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]});try{const E=await pe(`/api/patients/${oe}`);if(!E.ok)throw new Error(`Patient details fetch failed (${E.status})`);const le=await E.json();d(le);const ue=await pe(`/api/queue/patient/${oe}/latest`);if(!ue.ok&&ue.status!==404)throw new Error(`Queue entry fetch failed (${ue.status})`);if(ue.ok){const D=await ue.json();u(D)}await L(oe)}catch(E){console.error("Error fetching specific patient data:",E),g(E.message||"Failed to load patient data."),P(E.message||"Failed to load patient history.")}finally{k(!1)}},[]),L=w.useCallback(async oe=>{k(!0),P(null);try{const[E,le,ue,D]=await Promise.all([pe(`/api/queue/patient/${oe}/complaints`),pe(`/api/lab/patient/${oe}`),pe(`/api/lab/orders/patient/${oe}?status=pending`),pe(`/api/pharmacy-orders/patient/${oe}`)]),ce=E.ok?await E.json():[],ve=le.ok?await le.json():[],X=ue.ok?await ue.json():[],fe=D.ok?await D.json():[];v({pastComplaints:ce||[],labReports:ve||[],pendingLabOrders:X||[],pharmacyOrders:fe||[]})}catch(E){console.error("Error fetching patient history:",E),P(E.message||"Failed to load patient history."),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]})}finally{k(!1)}},[]),$=w.useCallback(async()=>{r(!0),o(null);try{const oe=await pe("/api/queue/doctor");if(!oe.ok){const le=await oe.text();throw new Error(`API Error (${oe.status}): ${le||oe.statusText}`)}const E=await oe.json();if(E===null||typeof E!="object"||typeof E.waitingCount!="number")throw console.error("Invalid queue data format:",E),new Error("Invalid queue data format received");n({currentPatient:E.currentPatient||null,nextPatient:E.nextPatient||null,waitingCount:E.waitingCount})}catch(oe){console.error("Error fetching queue data:",oe),o(oe.message||"Failed to fetch queue data.")}finally{r(!1)}},[]);w.useEffect(()=>{let oe=null;return M?(U(M),n({currentPatient:null,nextPatient:null,waitingCount:0})):($(),oe=setInterval($,1e4),d(null),u(null)),()=>{oe&&clearInterval(oe)}},[M,U,$]),w.useEffect(()=>{var oe;!M&&((oe=e.currentPatient)!=null&&oe.patientId)?L(e.currentPatient.patientId):!M&&!e.currentPatient&&(v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),P(null))},[M,(se=e.currentPatient)==null?void 0:se.patientId,L]);const z=((re=e.currentPatient)==null?void 0:re.patientId)||(M?parseInt(M,10):null),F=w.useMemo(()=>{if(!z||!b.pastComplaints)return[];const oe=b.pastComplaints.map(E=>({date:new Date(E.createdAt),type:"Complaint",data:E,originalDateString:E.createdAt})).filter(E=>!isNaN(E.date.getTime()));return oe.sort((E,le)=>le.date.getTime()-E.date.getTime()),oe},[z,b.pastComplaints]),Y=w.useMemo(()=>{if(!z)return[];const oe=[];return(b.pendingLabOrders??[]).forEach(E=>{const le=new Date(E.createdAt);isNaN(le.getTime())||oe.push({date:le,type:"Lab Order (Pending)",data:E,originalDateString:E.createdAt})}),(b.labReports??[]).forEach(E=>{const le=E.reportCreatedAt?new Date(E.reportCreatedAt):null;le&&!isNaN(le.getTime())&&oe.push({date:le,type:"Lab Report",data:E,originalDateString:E.reportCreatedAt})}),oe.sort((E,le)=>le.date.getTime()-E.date.getTime()),oe},[z,b.pendingLabOrders,b.labReports]),R=w.useMemo(()=>{if(!z||!b.pharmacyOrders)return[];const oe=b.pharmacyOrders.map(E=>({date:new Date(E.date),type:"Pharmacy Order",data:E,originalDateString:E.date})).filter(E=>!isNaN(E.date.getTime()));return oe.sort((E,le)=>le.date.getTime()-E.date.getTime()),oe},[z,b.pharmacyOrders]),B=async()=>{r(!0),o(null);try{await pe("/api/queue/doctor/next",{method:"POST"}),await $()}catch(oe){console.error("Error calling next patient:",oe),o(oe.message||"Failed to call next patient.")}finally{r(!1)}},G=async()=>{if(!(!e.currentPatient||M)){r(!0),o(null);try{await pe(`/api/queue/doctor/complete/${e.currentPatient._id}`,{method:"POST"}),await $(),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),P(null)}catch(oe){console.error("Error completing consultation:",oe),o(oe.message||"Failed to complete consultation.")}finally{r(!1)}}},ie=oe=>{switch(oe){case"waiting":return"Waiting";case"consulting":return"Consulting";case"seen":return"Seen";case"cancelled":return"Cancelled";default:return oe}},[te,W]=w.useState("info");let V=null;return e.currentPatient&&(V=i.jsxs("div",{className:"patient-info-section bg-white rounded-lg shadow-md md:p-6 border-l-4 md:border-l-8 border-teal-500 overflow-hidden",children:[i.jsxs("div",{className:"mobile-tabs md:hidden flex mb-4",children:[i.jsx("button",{className:`mobile-tab-btn ${te==="info"?"active":""}`,onClick:()=>W("info"),children:"Patient Details"}),i.jsx("button",{className:`mobile-tab-btn ${te==="history"?"active":""}`,onClick:()=>W("history"),children:"History & Context"})]}),i.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[i.jsxs("div",{className:`flex-grow md:w-1/2 ${te==="info"?"block":"hidden md:block"}`,children:[i.jsxs("h2",{className:"text-xl text-teal-700 font-semibold mb-3 flex items-center",children:["NOW SEEING",i.jsx("span",{className:"ml-2 text-xs font-normal text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:"Live Consultation"})]}),i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsxs("div",{className:"flex-grow mr-4",children:[i.jsx("div",{className:"text-3xl md:text-3xl font-bold text-gray-800 mb-1 leading-tight",children:e.currentPatient.name}),i.jsxs("div",{className:"text-lg text-gray-600 flex items-center mt-1",children:[i.jsxs("span",{className:"font-semibold bg-gray-100 px-2 py-0.5 rounded text-sm mr-2",children:[e.currentPatient.age," Yrs"]}),i.jsx("span",{className:"font-semibold bg-gray-100 px-2 py-0.5 rounded text-sm",children:e.currentPatient.gender})]})]}),i.jsxs("div",{className:"text-right flex-shrink-0 flex flex-col items-end",children:[i.jsxs("div",{className:"text-2xl font-bold text-gray-700 mb-1",children:["#",e.currentPatient.token]}),i.jsx("span",{className:`inline-block px-2 py-0.5 rounded text-xs font-medium uppercase tracking-wide ${e.currentPatient.status==="consulting"?"bg-teal-100 text-teal-800":"bg-gray-100 text-gray-800"}`,children:ie(e.currentPatient.status)})]})]}),e.currentPatient.case_summary&&i.jsxs("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-100 rounded-md",children:[i.jsx("h4",{className:"text-xs font-bold text-amber-800 uppercase mb-1",children:"AI Brief"}),i.jsx("p",{className:"text-sm text-amber-900 leading-snug",children:e.currentPatient.case_summary})]}),i.jsxs("div",{className:"actions-section mt-4 md:mt-6 flex flex-col sm:flex-row justify-end gap-3 border-t pt-4",children:[i.jsxs("button",{onClick:()=>{var E;const oe=(E=e.currentPatient)==null?void 0:E._id;oe&&I(`/dashboard/edit-complaint/${oe}`)},disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-primary w-full sm:w-auto",children:[i.jsx(sw,{size:16})," Open Consultation"]}),i.jsxs("button",{onClick:G,disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-success w-full sm:w-auto",children:[i.jsx(VI,{size:16})," Complete"]})]})]})," ",i.jsxs("div",{className:`complaint-section md:w-1/2 mt-4 md:mt-0 pt-4 md:pt-0 ${te==="history"?"block":"hidden md:block"} border-t md:border-t-0 md:border-l md:pl-6`,children:[i.jsxs("h3",{className:"text-base font-semibold text-gray-800 mb-2 flex items-center justify-between",children:[i.jsx("span",{children:"History & Context"}),S&&i.jsx("span",{className:"text-xs font-normal text-indigo-600 animate-pulse",children:"Updating..."})]}),T&&i.jsx("p",{className:"text-red-500 text-xs mb-2 bg-red-50 p-2 rounded",children:T}),i.jsxs("div",{className:"space-y-3 pr-1 md:max-h-[500px] md:overflow-y-auto custom-scrollbar",children:[i.jsx(hh,{title:"Past Complaints",icon:lu,items:F,isLoading:S,loadingText:"Fetching...",noDataText:"No past complaints.",renderItemContent:oe=>i.jsxs("span",{className:"block text-xs",children:[oe.data.complaint,i.jsx("div",{className:"text-gray-400 mt-0.5 text-[10px]",children:tu(oe.originalDateString)})]})}),i.jsx(hh,{title:"Lab Reports & Orders",icon:Wl,items:Y,isLoading:S,loadingText:"Fetching...",noDataText:"No lab history.",renderItemContent:oe=>oe.type==="Lab Order (Pending)"?i.jsxs("div",{className:"text-xs",children:[i.jsx("div",{className:"font-medium text-blue-700 mb-0.5",children:"Pending Order"}),oe.data.tests.map(E=>E.name).join(", "),i.jsx("div",{className:"text-gray-400 mt-0.5 text-[10px]",children:tu(oe.originalDateString)})]}):i.jsxs("div",{className:"text-xs",children:[i.jsxs("div",{className:"font-medium text-green-700 mb-0.5",children:["Report: ",oe.data.testName]}),i.jsxs("div",{className:"text-gray-600 italic",children:['"',oe.data.reportFindings.substring(0,60),oe.data.reportFindings.length>60?"...":"",'"']}),i.jsx("div",{className:"text-gray-400 mt-0.5 text-[10px]",children:tu(oe.originalDateString)})]})}),i.jsx(hh,{title:"Medications",icon:Md,items:R,isLoading:S,loadingText:"Fetching...",noDataText:"No medication history.",renderItemContent:oe=>i.jsxs("div",{className:"text-xs",children:[i.jsx("div",{className:"text-gray-800",children:oe.data.medications.map(E=>`${E.name} (${E.quantity})`).join(", ")}),i.jsxs("div",{className:"text-gray-400 mt-0.5 text-[10px]",children:[tu(oe.originalDateString),"  ",i.jsx("span",{className:"capitalize",children:oe.data.status})]})]})}),F.length===0&&Y.length===0&&R.length===0&&!S&&i.jsx("div",{className:"text-gray-400 text-center py-4 text-xs italic bg-gray-50 rounded border border-dashed border-gray-200",children:"No history records found for this patient."})]})," "]})," "]})," "]})),i.jsx(i.Fragment,{children:i.jsxs("div",{className:"doctor-screen-container flex-grow flex flex-col space-y-6 md:space-y-8",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("button",{onClick:()=>I(-1),className:"back-button mr-4",children:i.jsx(nn,{size:24})}),i.jsx("h1",{className:"doctor-screen-header",children:"Doctor Consultation Panel"})]}),M?i.jsxs(i.Fragment,{children:[p&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:p}),l&&i.jsxs("div",{className:"bg-white rounded-lg shadow-md md:p-6 border-l-4 md:border-l-8 border-purple-500 overflow-hidden",children:[i.jsxs("div",{className:"mobile-tabs md:hidden flex mb-4",children:[i.jsx("button",{className:`mobile-tab-btn ${te==="info"?"active":""}`,onClick:()=>W("info"),children:"Patient Record"}),i.jsx("button",{className:`mobile-tab-btn ${te==="history"?"active":""}`,onClick:()=>W("history"),children:"History"})]}),i.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[i.jsxs("div",{className:`flex-grow md:w-1/2 ${te==="info"?"block":"hidden md:block"}`,children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"text-xl text-purple-700 font-semibold flex items-center gap-2",children:"Patient Record"}),i.jsxs("button",{onClick:()=>I("/dashboard/doctor"),className:"text-xs font-medium text-slate-500 hover:text-slate-800 flex items-center gap-1 transition-colors px-2 py-1 bg-slate-100 rounded",children:[i.jsx(nn,{size:12})," Back to Queue"]})]}),i.jsx("div",{className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-700 to-indigo-600 mb-1 leading-tight",children:l.name}),i.jsxs("div",{className:"text-lg text-slate-600 mb-4 flex items-center gap-2",children:[i.jsxs("span",{className:"bg-slate-100 px-2 py-0.5 rounded text-sm font-semibold",children:[l.age||"N/A"," Yrs"]}),i.jsx("span",{className:"bg-slate-100 px-2 py-0.5 rounded text-sm font-semibold",children:l.gender||"N/A"})]}),i.jsxs("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-sm",children:[i.jsx("label",{className:"font-semibold block mb-2 text-xs uppercase tracking-wider text-slate-500",children:"Latest Activity"}),f?i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("span",{className:"text-sm flex-1 break-words text-slate-700",children:[i.jsx("span",{className:"font-medium text-slate-900",children:"Complaint:"})," ",f.complaint||i.jsx("span",{className:"text-slate-400 italic",children:"None"}),i.jsx("div",{className:"mt-1",children:i.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium uppercase tracking-wide ${f.status==="consulting"?"bg-teal-100 text-teal-800":f.status==="seen"?"bg-emerald-100 text-emerald-800":f.status==="waiting"?"bg-blue-100 text-blue-800":"bg-slate-100 text-slate-800"}`,children:ie(f.status)})})]}),f.status==="consulting"&&f._id&&i.jsx("button",{onClick:()=>I(`/dashboard/edit-complaint/${f._id}`),className:"ml-4 px-3 py-1.5 text-xs bg-indigo-50 hover:bg-indigo-100 text-indigo-700 rounded-md font-medium border border-indigo-200 transition-colors",children:"Resume"})]}),f.case_summary&&i.jsxs("div",{className:"text-xs text-slate-700 bg-amber-50 p-2.5 rounded border border-amber-100",children:[i.jsx("span",{className:"font-bold text-amber-800 uppercase text-[10px] block mb-1",children:"AI Summary"}),f.case_summary]})]}):i.jsx("p",{className:"text-slate-400 italic text-sm",children:"No queue entry found for this patient today."})]})]}),i.jsxs("div",{className:`md:w-1/2 mt-4 md:mt-0 pt-4 md:pt-0 ${te==="history"?"block":"hidden md:block"} border-t md:border-t-0 md:border-l md:pl-6`,children:[i.jsxs("h3",{className:"text-base font-semibold text-slate-800 mb-3 flex items-center justify-between",children:[i.jsx("span",{children:"Patient History"}),S&&i.jsx("span",{className:"text-xs font-normal text-indigo-600 animate-pulse",children:"Loading..."})]}),T&&i.jsx("p",{className:"text-red-500 text-xs mb-2 bg-red-50 p-2 rounded",children:T}),i.jsxs("div",{className:"space-y-3 pr-1 md:max-h-[500px] md:overflow-y-auto custom-scrollbar",children:[i.jsx(hh,{title:"Past Complaints",icon:lu,items:F,isLoading:S,loadingText:"Loading...",noDataText:"No past complaints.",renderItemContent:oe=>i.jsxs("div",{className:"text-xs",children:[oe.data.complaint,i.jsx("div",{className:"text-slate-400 mt-0.5 text-[10px]",children:tu(oe.originalDateString)})]})}),i.jsx(hh,{title:"Lab Reports",icon:Wl,items:Y,isLoading:S,loadingText:"Loading...",noDataText:"No lab history.",renderItemContent:oe=>oe.type==="Lab Order (Pending)"?i.jsxs("div",{className:"text-xs",children:[i.jsx("div",{className:"font-medium text-blue-700 mb-0.5",children:"Pending Order"}),i.jsx("div",{children:oe.data.tests.map(E=>E.name).join(", ")}),i.jsx("div",{className:"text-slate-400 mt-0.5 text-[10px]",children:tu(oe.originalDateString)})]}):i.jsxs("div",{className:"text-xs",children:[i.jsxs("div",{className:"font-medium text-emerald-700 mb-0.5",children:["Report: ",oe.data.testName]}),i.jsxs("div",{className:"text-slate-600 italic",children:['"',oe.data.reportFindings.substring(0,50),oe.data.reportFindings.length>50?"...":"",'"']}),i.jsx("div",{className:"text-slate-400 mt-0.5 text-[10px]",children:tu(oe.originalDateString)})]})}),i.jsx(hh,{title:"Medications",icon:Md,items:R,isLoading:S,loadingText:"Loading...",noDataText:"No pharmacy history.",renderItemContent:oe=>i.jsxs("div",{className:"text-xs",children:[i.jsx("div",{className:"text-slate-800",children:oe.data.medications.map(E=>`${E.name} (${E.quantity})`).join(", ")}),i.jsxs("div",{className:"text-slate-400 mt-0.5 text-[10px]",children:[tu(oe.originalDateString),"  ",i.jsx("span",{className:"capitalize",children:oe.data.status})]})]})}),F.length===0&&Y.length===0&&R.length===0&&!S&&i.jsx("div",{className:"text-slate-400 text-center py-4 text-xs italic bg-slate-50 rounded border border-dashed border-slate-200",children:"No history records found."})]})]})]})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex justify-end space-x-3 mb-4",children:[i.jsxs("button",{onClick:()=>I("/dashboard/add-patient"),className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded shadow flex items-center",children:[i.jsx(c2,{size:18,className:"mr-2"})," Add Patient"]}),i.jsx("button",{onClick:()=>I("/search-patient"),className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded shadow",children:"Search Patient"})]}),a&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:a}),t&&!e.currentPatient&&i.jsx("p",{className:"text-gray-500 p-4 text-center",children:"Loading queue..."}),i.jsx("div",{className:"mb-6 md:mb-8",children:V||i.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 text-center text-gray-500",children:"No patient currently being seen. Use 'Call Next' or search for a patient record."})}),i.jsxs("div",{className:"current-queue-section mb-6 md:mb-8",children:[i.jsx("h2",{className:"text-xl text-blue-700 font-semibold mb-3 md:mb-4",children:"NEXT IN QUEUE:"}),e.nextPatient?i.jsxs("div",{className:"patient-info-section bg-blue-50 rounded-lg shadow-md p-5 md:p-6 border-l-8 border-blue-500",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 md:mb-4",children:[i.jsxs("span",{className:"text-2xl md:text-3xl font-bold text-blue-800 mb-2 sm:mb-0",children:["Token #",e.nextPatient.token]}),i.jsx("span",{className:`px-3 py-1 rounded-full text-sm md:text-base font-medium ${e.nextPatient.status==="waiting"?"bg-blue-200 text-blue-900":"bg-gray-200 text-gray-800"}`,children:ie(e.nextPatient.status)})]}),i.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-2 md:mb-3",children:e.nextPatient.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-700 mb-3 md:mb-4",children:["Age: ",e.nextPatient.age," | ",e.nextPatient.gender]}),(e.nextPatient.complaint||e.nextPatient.case_summary)&&i.jsxs("div",{className:"mt-3 md:mt-4 pt-3 border-t border-blue-200 space-y-2",children:[e.nextPatient.complaint&&i.jsxs("p",{className:"text-base md:text-lg text-gray-800",children:[i.jsx("span",{className:"font-semibold text-gray-900",children:"Complaint:"})," ",e.nextPatient.complaint]}),e.nextPatient.case_summary&&i.jsxs("p",{className:"text-sm text-gray-700 bg-yellow-50 p-2 rounded border border-yellow-200",children:[i.jsx("span",{className:"font-semibold text-gray-800",children:"AI Summary:"})," ",e.nextPatient.case_summary]})]})]}):i.jsx("div",{className:"bg-gray-50 rounded-lg shadow-inner p-6 text-center text-gray-600 border border-gray-200",children:"No patient waiting next in the queue."})]}),i.jsxs("div",{className:"actions-section mt-auto pt-4 md:pt-6 flex flex-col sm:flex-row justify-between items-center gap-4",children:[i.jsx("button",{onClick:B,disabled:t||!e.nextPatient||!!e.currentPatient,className:"btn btn-primary w-full sm:w-auto disabled:opacity-50 disabled:cursor-not-allowed order-1 sm:order-none",children:"Call Next Patient"}),i.jsx("div",{className:"bg-gray-200 inline-block px-4 py-2 rounded-full order-2 sm:order-none",children:i.jsxs("span",{className:"text-base md:text-lg font-medium",children:[e.waitingCount," patients waiting"]})})]})]})]})})},Wk=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,o]=w.useState(null),[l,d]=w.useState(null),[f,u]=w.useState(null),[p,g]=w.useState(null),[b,v]=w.useState(!1),[S,k]=w.useState(!1),[T,P]=w.useState(null),M=Et(),I=w.useCallback(vk.debounce(async R=>{if(R.trim().length<2){r([]),k(!1);return}k(!0),P(null);try{const B=new URLSearchParams({search:encodeURIComponent(R),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),G=await pe(`/api/patients?${B.toString()}`);if(!G.ok){const te=await G.text();throw new Error(`API Error (${G.status}): ${te||G.statusText||"Failed to fetch patients"}`)}const ie=await G.json();r(ie.patients)}catch(B){P(B instanceof Error?B.message:"An unknown error occurred while searching patients"),r([])}finally{k(!1)}},500),[]);w.useEffect(()=>(e?(k(!0),I(e)):(r([]),I.cancel()),()=>{I.cancel()}),[e,I]);const U=R=>{o(R),n(""),r([]),P(null),d(null),u(null),g(null),v(!1)},L=async()=>{if(!a){P("No patient selected.");return}P(null),k(!0);try{const R=await pe(`/api/patients/${a.id}/admit`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!R.ok){const G=await R.json().catch(()=>({message:"Failed to admit patient"}));throw new Error(G.message||"Failed to admit patient")}const B=await R.json();alert(B.message||"Patient admitted successfully!"),B.bill&&B.bill.id?M(`/patient/${a.id}/admission-bill/${B.bill.id}`):(console.error("Admission successful, but bill ID missing in response."),P("Admission successful, but couldn't navigate to billing."),o(B.patient))}catch(R){P(R instanceof Error?R.message:"Failed to admit patient")}finally{k(!1)}};w.useEffect(()=>{(async()=>{if(!a||!a.admission_date||a.discharge_date){d(null),g(null);return}v(!0),u(null),d(null),g(null);try{const B=await pe(`/api/patients/${a.id}/active-bill?type=admission`);if(!B.ok)throw B.status===404?new Error("No active admission bill found."):new Error("Failed to fetch active bill ID.");const G=await B.json(),ie=G==null?void 0:G.id;if(!ie)throw new Error("Active admission bill ID not found in response.");d(ie);const te=await pe(`/api/bills/${ie}`);if(!te.ok)throw new Error(`Failed to fetch bill details (ID: ${ie}). Status: ${te.status}`);const W=await te.json();if(W&&W.calculated)g(W.calculated);else throw console.error("Fetched bill details missing 'calculated' object:",W),new Error("Fetched bill details are incomplete (missing calculated data).")}catch(B){u(B instanceof Error?B.message:"An unknown error occurred while fetching bill details."),d(null),g(null)}finally{v(!1)}})()},[a]);const $=async()=>{if(!a){P("No patient selected.");return}if(!a.admission_date||a.discharge_date){P("Patient is not currently admitted.");return}P(null),k(!0);try{const R=await pe(`/api/patients/${a.id}/discharge`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!R.ok){const G=await R.json().catch(()=>({message:"Failed to discharge patient"}));throw new Error(G.message||"Failed to discharge patient")}const B=await R.json();alert(B.message||"Patient discharged successfully!"),B.patient?o(B.patient):(console.error("Discharge successful, but updated patient info missing in response."),o(null),P("Discharge successful, but couldn't update patient details locally."))}catch(R){P(R instanceof Error?R.message:"Failed to discharge patient")}finally{k(!1)}},z=()=>{if(!a||!l){P("Cannot navigate to billing: Patient or Bill ID missing.");return}M(`/patient/${a.id}/admission-bill/${l}`)};let F="",Y=null;if(a){const R=a.admission_date?new Date(a.admission_date).toLocaleDateString():null,B=a.discharge_date?new Date(a.discharge_date).toLocaleDateString():null;a.admission_date?a.admission_date&&!a.discharge_date?(F=`Patient admitted on: ${R}`,Y=i.jsxs("div",{className:"space-y-4",children:[" ",b&&i.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Loading billing details..."})," ",f&&i.jsx("p",{className:"text-sm text-red-500 text-center",children:f})," ",!b&&p&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Total Due:"}),i.jsxs("span",{children:["",(Number(p.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[" ",i.jsx("span",{children:"Total Paid:"}),i.jsxs("span",{children:["",(Number(p.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm font-bold mt-1 text-red-600",children:[" ",i.jsx("span",{children:"Balance Due:"}),i.jsxs("span",{children:["",(Number(p.balance)||0).toFixed(2)]})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("button",{onClick:z,disabled:S||b||!l,className:`admission-button admission-button-secondary ${S||b||!l?"opacity-50 cursor-not-allowed":""}`,children:b?"Loading Bill...":!l&&!f?"Finding Bill...":"Pay Bill / View Details"}),i.jsx("button",{onClick:$,disabled:S||b,className:`admission-button admission-button-danger ${S||b?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Discharge Patient"})]})]})):(F=`Patient admitted on ${R} and discharged on ${B}.`,Y=i.jsx("p",{className:"text-center text-gray-600 italic",children:"Patient has been discharged."})):(F="Patient is not admitted.",Y=i.jsx("button",{onClick:L,disabled:S,className:`admission-button ${S?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Admit Patient"}))}return i.jsxs("div",{className:"admission-page-container",children:[i.jsxs("div",{className:"admission-header-container",children:[i.jsxs("button",{onClick:()=>M(-1),className:"back-button",children:[i.jsx(nn,{size:16}),"Back"]}),i.jsx("h1",{className:"admission-header",children:"Manage Admission/Discharge"})]}),i.jsxs("div",{className:"admission-section mb-6 relative",children:[i.jsx("label",{htmlFor:"patientSearch",className:"admission-label",children:"Search Patient (Name, Phone, or Token)"}),i.jsx("input",{type:"text",id:"patientSearch",value:e,onChange:R=>n(R.target.value),placeholder:"Start typing to search...",className:"admission-input"}),S&&!a&&i.jsx("div",{className:"absolute right-3 top-9 text-sm text-gray-500",children:"Loading..."})," ",t.length>0&&!a&&i.jsxs("ul",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[" ",t.map(R=>i.jsxs("li",{onClick:()=>U(R),className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",children:[" ",R.name," (Token: ",R.token,")",i.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[R.admission_date?`Admitted: ${new Date(R.admission_date).toLocaleDateString()}`:"Not Admitted",R.discharge_date?`, Discharged: ${new Date(R.discharge_date).toLocaleDateString()}`:""]})]},R.id))]}),t.length===0&&e&&!S&&!a&&i.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg p-4 text-gray-500",children:['No patients found matching "',e,'".']})]}),a&&i.jsxs("div",{className:"admission-section",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"admission-section-title",children:"Selected Patient"}),i.jsx("button",{onClick:()=>o(null),className:"admission-link",children:"Clear Selection"})]}),i.jsxs("div",{className:"admission-card-content mb-4 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",a.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Token:"})," ",a.token]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Age:"})," ",a.age??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Gender:"})," ",a.gender??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Phone:"})," ",a.phone??"N/A"]}),i.jsxs("p",{className:"col-span-2",children:[i.jsx("strong",{children:"Address:"})," ",a.address??"N/A"]})]}),i.jsx("hr",{className:"my-4"}),i.jsx("p",{className:"text-sm text-gray-600 mb-3",children:F})," ",T&&i.jsx("p",{className:"text-red-500 text-sm mb-3",children:T})," ",Y]})]})},c0=15,N1=()=>{const e=Et(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(""),[u,p]=w.useState(1),[g,b]=w.useState(1),[v,S]=w.useState(0),[k,T]=w.useState("created_at"),[P,M]=w.useState("desc"),[I,U]=w.useState(""),[L,$]=w.useState(!1),[z,F]=w.useState(null),[Y,R]=w.useState([]),[B,G]=w.useState(""),[ie,te]=w.useState(!1),[W,V]=w.useState(null),[se,re]=w.useState(!0),[oe,E]=w.useState(null),[le,ue]=w.useState(d);w.useEffect(()=>{const Z=setTimeout(()=>{ue(d),p(1)},500);return()=>{clearTimeout(Z)}},[d]);const D=w.useCallback(async()=>{re(!0),E(null);try{const Z=await pe("/api/subscriptions");if(!Z.ok){let Ie=`Failed to fetch subscription plans (${Z.status})`;try{Ie=(await Z.json()).message||Ie}catch{}throw new Error(Ie)}const Ee=await Z.json();R(Ee)}catch(Z){console.error("Error fetching subscription plans:",Z),E(Z.message||"An unknown error occurred while fetching plans."),R([])}finally{re(!1)}},[]),ce=w.useCallback(async(Z,Ee,Ie,Fe,rt)=>{a(!0),l(null);try{const lt=new URLSearchParams({page:Z.toString(),limit:c0.toString(),sortBy:Ie,sortOrder:Fe});Ee&&lt.append("search",Ee),rt&&lt.append("gender",rt);const ct=await pe(`/api/patients?${lt.toString()}`);if(!ct.ok){const Ht=await ct.json();throw new Error(Ht.message||"Failed to fetch patients")}const st=await ct.json();t(st.patients),S(st.totalCount),p(st.currentPage),b(st.totalPages)}catch(lt){console.error("Error fetching patients:",lt),l(`Failed to load patients: ${lt.message}`),t([]),S(0),p(1),b(1)}finally{a(!1)}},[]);w.useEffect(()=>{ce(u,le,k,P,I),D()},[u,le,k,P,I,ce,D]);const ve=Z=>{const Ee=k===Z&&P==="asc"?"desc":"asc";T(Z),M(Ee),p(1)},X=Z=>{try{return new Date(Z).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},fe=()=>{$(!1),F(null),G(""),V(null),te(!1)},ae=async(Z,Ee)=>{t(Ie=>Ie.map(Fe=>Fe.id===Z?{...Fe,insurance_type:Ee}:Fe));try{const Ie=await pe(`/api/patients/${Z}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:Ee})});if(!Ie.ok){const Fe=await Ie.json();throw new Error(Fe.message||"Failed to update insurance type")}}catch(Ie){console.error("Error updating insurance type:",Ie),ce(u,le,k,P,I)}},Me=(Z,Ee)=>{const Ie=new Date(Z),Fe=Ee.interval||1;switch(Ee.period){case"daily":Ie.setDate(Z.getDate()+Fe);break;case"weekly":Ie.setDate(Z.getDate()+Fe*7);break;case"monthly":Ie.setMonth(Z.getMonth()+Fe);break;case"yearly":Ie.setFullYear(Z.getFullYear()+Fe);break;default:console.warn(`Unknown subscription period: ${Ee.period}. Defaulting to 1 month.`),Ie.setMonth(Z.getMonth()+1)}return Ie},Ke=async()=>{if(!z||!B){V("Please select a subscription plan.");return}const Z=Y.find(Ee=>Ee.id===B);if(!Z){V("Selected plan details not found.");return}te(!0),V(null);try{const Ee=new Date,Ie=Me(Ee,Z),Fe={subscription_plan_id:B,subscription_status:"active",subscription_start_date:Ee.toISOString(),subscription_end_date:Ie.toISOString(),subscription_payment_method:"manual"},rt=await pe(`/api/patients/${z.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Fe)});if(!rt.ok){const lt=await rt.json();throw new Error(lt.message||"Failed to update patient subscription")}fe(),ce(u,le,k,P,I)}catch(Ee){console.error("Error starting subscription:",Ee),V(`Failed to start subscription: ${Ee.message}`)}finally{te(!1)}};return i.jsxs("div",{className:"all-patients-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(nn,{size:16}),"Back"]}),i.jsxs("h1",{className:"all-patients-title",children:[i.jsx(Ko,{size:28}),"All Registered Patients"]}),o&&i.jsxs("div",{className:"error-alert",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:o})]}),i.jsxs("div",{className:"subscription-plans-card",children:[i.jsx("h2",{className:"subscription-plans-title",children:"Available Subscription Plans"}),i.jsx("div",{children:se?i.jsx("p",{className:"loading-state",children:"Loading plans..."}):oe?i.jsxs("p",{className:"error-message",children:["Error loading plans: ",oe]}):Y.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("ul",{className:"subscription-plans-list",children:Y.map(Z=>i.jsxs("li",{children:[i.jsx("strong",{children:Z.name}),": ",Z.price," / ",Z.interval," ",Z.period,Z.interval>1?"s":"",Z.description&&i.jsx("span",{className:"plan-description",children:Z.description})]},Z.id))})})]}),i.jsxs("div",{className:"controls-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by name or phone...",className:"search-input",value:d,onChange:Z=>f(Z.target.value)}),i.jsx(ua,{className:"search-input-icon",size:20})]}),i.jsxs("div",{className:"filter-dropdown-wrapper",children:[i.jsx("label",{htmlFor:"genderFilter",className:"sr-only",children:"Filter by Gender"}),i.jsxs("div",{className:"filter-select-container",children:[i.jsx(WI,{size:16,className:"filter-select-icon"}),i.jsxs("select",{id:"genderFilter",value:I,onChange:Z=>U(Z.target.value),className:"filter-select",children:[i.jsx("option",{value:"",children:"All Genders"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]})]})]}),r?i.jsx("div",{className:"loading-state",children:"Loading patients..."}):n.length===0?i.jsx("div",{className:"empty-state",children:le?"No patients found matching your search.":"No patients registered yet."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"patients-table-wrapper",children:i.jsxs("table",{className:"patients-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Token"}),i.jsxs("th",{className:"sortable-header",onClick:()=>ve("name"),children:["Name",k==="name"&&(P==="asc"?i.jsx(K0,{size:14,className:"sort-icon"}):i.jsx(DS,{size:14,className:"sort-icon"}))]}),i.jsx("th",{children:"Age"}),i.jsx("th",{children:"Gender"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Address"}),i.jsxs("th",{className:"sortable-header",onClick:()=>ve("created_at"),children:["Registered On",k==="created_at"&&(P==="asc"?i.jsx(K0,{size:14,className:"sort-icon"}):i.jsx(DS,{size:14,className:"sort-icon"}))]}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Insurance Type"})," ",i.jsx("th",{children:"Action"})," "]})}),i.jsx("tbody",{children:n.map(Z=>i.jsxs("tr",{children:[i.jsx("td",{children:Z.token??"-"}),i.jsx("td",{className:"patient-name",children:Z.name}),i.jsx("td",{children:Z.age??"-"}),i.jsx("td",{children:Z.gender??"-"}),i.jsx("td",{children:Z.phone??"-"}),i.jsx("td",{children:Z.address??"-"}),i.jsx("td",{children:X(Z.created_at)}),i.jsx("td",{children:i.jsx("span",{className:`status-badge ${Z.subscription_status==="active"?"active":Z.subscription_status==="cancelled"||Z.subscription_status==="expired"?"inactive":"none"}`,children:Z.subscription_status??"None"})}),i.jsx("td",{children:i.jsxs("select",{value:Z.insurance_type,onChange:Ee=>ae(Z.id,Ee.target.value),className:"form-select insurance-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"insurance",children:"Insurance"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})}),i.jsx("td",{children:i.jsx("button",{onClick:()=>e(`/start-subscription/${Z.id}`),className:"action-button",children:"Start Sub"})})]},Z.id))})]})}),g>1&&i.jsxs("div",{className:"pagination-controls",children:[i.jsxs("div",{className:"pagination-info",children:["Showing"," ",i.jsx("span",{className:"font-medium",children:(u-1)*c0+1})," ","to"," ",i.jsx("span",{className:"font-medium",children:Math.min(u*c0,v)})," ","of"," ",i.jsx("span",{className:"font-medium",children:v})," results"]}),i.jsxs("div",{className:"pagination-buttons",children:[i.jsxs("button",{onClick:()=>p(Z=>Math.max(Z-1,1)),disabled:u===1||r,className:"pagination-button",children:[i.jsx(aw,{size:16,className:"prev-icon"}),"Previous"]}),i.jsxs("span",{className:"pagination-current-page",children:["Page ",i.jsx("span",{className:"font-medium",children:u})," of ",i.jsx("span",{className:"font-medium",children:g})]}),i.jsxs("button",{onClick:()=>p(Z=>Math.min(Z+1,g)),disabled:u===g||r,className:"pagination-button",children:["Next",i.jsx($h,{size:16,className:"next-icon"})]})]})]})]}),L&&z&&i.jsx("div",{className:"subscription-modal-overlay",children:i.jsxs("div",{className:"subscription-modal-content",children:[i.jsxs("div",{className:"subscription-modal-header",children:[i.jsxs("h2",{className:"subscription-modal-title",children:["Start Subscription for ",z.name]}),i.jsx("button",{onClick:fe,className:"subscription-modal-close-button",children:i.jsx(Xn,{size:24})})]}),W&&i.jsx("div",{className:"error-alert",role:"alert",children:i.jsx("span",{children:W})}),i.jsxs("div",{className:"subscription-modal-body",children:[i.jsx("label",{htmlFor:"subscriptionPlan",className:"form-label",children:"Select Plan:"}),i.jsxs("select",{id:"subscriptionPlan",value:B,onChange:Z=>G(Z.target.value),className:"form-select",disabled:ie||se||oe!==null||Y.length===0,children:[i.jsx("option",{value:"",disabled:!0,children:"-- Select a Plan --"}),se?i.jsx("option",{value:"",disabled:!0,children:"Loading plans..."}):oe?i.jsx("option",{value:"",disabled:!0,children:"Error loading plans"}):Y.length>0?Y.map(Z=>i.jsxs("option",{value:Z.id,children:[Z.name," - ",Z.price," (",Z.interval," ",Z.period,Z.interval>1?"s":"",")"]},Z.id)):i.jsx("option",{value:"",disabled:!0,children:"No active plans found"})]}),oe&&i.jsx("p",{className:"error-message",children:oe}),Y.length===0&&!se&&!oe&&i.jsx("p",{className:"empty-state",children:"No active subscription plans available."})]}),i.jsxs("div",{className:"subscription-modal-footer",children:[i.jsx("button",{onClick:fe,disabled:ie,className:"subscription-modal-button cancel",children:"Cancel"}),i.jsx("button",{onClick:Ke,disabled:!B||ie,className:"subscription-modal-button submit",children:ie?"Starting...":"Start Subscription"})]})]})})]})},Qk=()=>{const e=Et(),[n]=w.useState(!0),[t,r]=w.useState(""),[a,o]=w.useState([]),[l,d]=w.useState(!1),[f,u]=w.useState(null),[p,g]=w.useState(!1),b=/^\+?[0-9\s\-().]{7,20}$/,v=w.useMemo(()=>vb(async P=>{if(P.trim().length<2){o([]),d(!1),u(null);return}d(!0),u(null);try{const M=new URLSearchParams({search:encodeURIComponent(P),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),I=await pe(`/api/patients?${M.toString()}`);if(!I.ok){const L=await I.text();throw new Error(`API Error (${I.status}): ${L||I.statusText}`)}const U=await I.json();o(U.patients)}catch(M){console.error("Error searching patients:",M),u(M.message||"Failed to search patients."),o([])}finally{d(!1)}},300),[]),S=P=>{const M=P.target.value;r(M),g(b.test(M)),d(!0),v(M)},k=w.useCallback(P=>{e("/billing",{state:{patientId:P.id,patientName:P.name}})},[e]),T=w.useCallback(async()=>{if(!t||!p){u("Invalid phone number to create a new patient.");return}d(!0),u(null);try{const M=await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"direct pharmacy",phone:t,age:null,gender:null,token:null})});if(!M.ok){const U=await M.json();throw new Error(U.message||`Failed to create patient: ${M.statusText}`)}const I=await M.json();alert(`New patient "direct pharmacy" created with phone ${I.phone}.`),k(I)}catch(P){console.error("Error creating new patient:",P),u(P.message||"Failed to create new patient.")}finally{d(!1)}},[t,p,k]);return i.jsxs("div",{className:"create-custom-bill-page p-4 md:p-6 max-w-5xl mx-auto",children:[i.jsx("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:i.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:i.jsx(nn,{size:20})}),i.jsx("h2",{className:"text-2xl",children:"Create Custom Bill"})]})}),n&&i.jsxs("div",{className:"content-section",children:[i.jsx("h3",{className:"section-title",children:"Select Patient"}),i.jsxs("div",{className:"mb-3 relative",children:[i.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"}),i.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:t,onChange:S,className:"custom-text-input mt-1",autoFocus:!0}),l&&i.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),f&&i.jsx("div",{className:"ai-function-status error mb-3 p-3",children:f}),a.length>0&&i.jsx("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:i.jsx("ul",{children:a.map(P=>i.jsxs("li",{onClick:()=>k({id:P.id,name:P.name,token:P.token,age:P.age,gender:P.gender,phone:P.phone}),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[i.jsxs("div",{className:"font-medium",children:[i.jsxs("span",{className:"patient-token mr-2",children:["#",P.token]}),P.name]}),i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[P.age?`${P.age} yrs`:"Age N/A",P.gender?` / ${P.gender}`:" / Gender N/A",P.phone&&i.jsxs("span",{className:"hidden sm:inline",children:[" / ",P.phone]})]})]}),P.phone&&i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",P.phone]})]},P.id))})}),t.length>=2&&!l&&a.length===0&&!f&&i.jsxs(i.Fragment,{children:[i.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',t,'".']}),p&&i.jsx("button",{type:"button",onClick:T,className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:l,children:'Create "direct pharmacy" Patient with this Phone'})]}),t.length<2&&!l&&i.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]})]})},Jk=({currentUser:e})=>{const n=Et(),[t,r]=w.useState("select_patient"),[a,o]=w.useState({name:"",age:void 0,gender:null,phone:"",address:""}),[l,d]=w.useState(null),[f,u]=w.useState([]),[p,g]=w.useState([]),[b,v]=w.useState(""),[S,k]=w.useState([]),[T,P]=w.useState(""),[M,I]=w.useState([]),[U,L]=w.useState(!1),[$,z]=w.useState(null),[F,Y]=w.useState(null),[R,B]=w.useState(null),[G,ie]=w.useState(!1),[te,W]=w.useState(!1),[V,se]=w.useState(!1),re=/^\+?[0-9\s\-().]{7,20}$/,oe=/^[a-zA-Z\s'-]{2,}$/,E=w.useCallback(async()=>{if(!(f.length>0)){ie(!0),B(null);try{const Z=await pe("/api/lab-tests");if(!Z.ok)throw new Error("Failed to fetch lab tests");const Ee=await Z.json();u(Ee)}catch(Z){console.error("Failed to fetch available lab tests:",Z),B("Could not load lab test list: "+Z.message),u([])}finally{ie(!1)}}},[f.length]);w.useEffect(()=>{if(!b){k([]);return}const Z=b.toLowerCase();k(f.filter(Ee=>Ee.name.toLowerCase().includes(Z)||Ee.description&&Ee.description.toLowerCase().includes(Z)).slice(0,10))},[b,f]);const le=w.useCallback(Z=>{const Ee={id:Z.id,name:Z.name,token:Z.token,age:Z.age,gender:Z.gender,phone:Z.phone};d(Ee),r("create_order"),g([]),v(""),k([]),B(null),E()},[E]),ue=w.useMemo(()=>vb(async Z=>{if(Z.trim().length<2){I([]),L(!1),z(null);return}L(!0),z(null);try{const Ee=new URLSearchParams({search:encodeURIComponent(Z),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Ie=await pe(`/api/patients?${Ee.toString()}`);if(!Ie.ok){const rt=await Ie.text();throw new Error(`API Error (${Ie.status}): ${rt||Ie.statusText}`)}const Fe=await Ie.json();I(Fe.patients)}catch(Ee){console.error("Error searching lab patients:",Ee),z(Ee.message||"Failed to search lab patients."),I([])}finally{L(!1)}},300),[re,oe]),D=Z=>{const Ee=Z.target.value;P(Ee),W(re.test(Ee)),se(oe.test(Ee)&&!re.test(Ee)),L(!0),ue(Ee)},ce=w.useCallback(async Z=>{if(!T||Z==="phone"&&!te||Z==="name"&&!V){z(`Invalid ${Z} to create a new patient.`);return}L(!0),z(null);try{const Ie=await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Z==="name"?T:"direct lab",phone:Z==="phone"?T:null,age:null,gender:null,token:null})});if(!Ie.ok){const rt=await Ie.json();throw new Error(rt.message||`Failed to create patient: ${Ie.statusText}`)}const Fe=await Ie.json();alert(`New patient "${Fe.name}" created with ${Z==="phone"?`phone ${Fe.phone}`:`name ${Fe.name}`}.`),le({id:Fe.id,name:Fe.name,token:Fe.token??null,age:Fe.age??null,gender:Fe.gender??null,phone:Fe.phone})}catch(Ee){console.error("Error creating new patient:",Ee),z(Ee.message||"Failed to create new patient.")}finally{L(!1)}},[T,te,V,le]),ve=()=>{r("select_patient"),d(null),P(""),I([]),z(null)},X=Z=>{const{name:Ee,value:Ie}=Z.target;o(Fe=>({...Fe,[Ee]:Ee==="age"?Ie?parseInt(Ie,10):void 0:Ie}))},fe=async Z=>{if(Z.preventDefault(),Y(null),!a.name){Y("Patient Name is required.");return}const Ee={name:a.name,age:a.age,gender:a.gender,phone:a.phone,address:a.address};try{const Ie=await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ee)});if(!Ie.ok){const rt=await Ie.json();throw new Error(rt.message||`Failed to create patient: ${Ie.statusText}`)}const Fe=await Ie.json();alert(`Patient "${Fe.name}" created successfully!`),le({id:Fe.id,name:Fe.name,token:Fe.token??null,age:Fe.age??null,gender:Fe.gender??null,phone:Fe.phone})}catch(Ie){console.error("Failed to create patient:",Ie),Y(Ie.message||"Failed to create patient. Please try again.")}},ae=Z=>{if(p.some(Ee=>Ee.id===Z.id)){B(`${Z.name} is already in the order.`),setTimeout(()=>B(null),3e3),v(""),k([]);return}g(Ee=>[...Ee,{...Z}]),v(""),k([])},Me=Z=>{g(Ee=>Ee.filter(Ie=>Ie.id!==Z))},Ke=async Z=>{if(Z.preventDefault(),B(null),!l){B("No patient selected.");return}if(p.length===0){B("No lab tests selected.");return}const Ee={patient_id:l.id,tests:p.map(Ie=>({id:Ie.id,name:Ie.name,price:Ie.price}))};console.log("Submitting Lab Order:",Ee);try{const Ie=await pe("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ee)});if(!Ie.ok){const lt=await Ie.json();throw console.error("API Error Data:",lt),new Error(lt.message||`Failed to create lab order: ${Ie.statusText}`)}const Fe=await Ie.json();console.log("Lab Order Creation Result:",Fe);let rt=l.queueId;if(!rt){const lt=await pe(`/api/queue/patient/${l.id}/latest`);if(lt.ok){const ct=await lt.json();ct!=null&&ct._id&&(rt=ct._id)}}if(!rt){const lt=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:l.id})});if(!lt.ok){const st=await lt.text();throw new Error(`Failed to create queue entry for redirection: ${st||lt.statusText}`)}const ct=await lt.json();if(ct!=null&&ct.id)rt=ct.id;else throw new Error("Failed to get ID from new queue entry for redirection.")}alert(`Lab order created successfully for ${l.name}!`),(e==null?void 0:e.role)==="lab"?n("/dashboard"):n(`/dashboard/edit-complaint/${rt}`)}catch(Ie){console.error("Failed to create lab order:",Ie),B(Ie.message||"Failed to create lab order.")}};return w.useEffect(()=>{E()},[E]),i.jsxs("div",{className:"create-lab-order-container",children:[i.jsxs("div",{className:"create-lab-order-header",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button","aria-label":"Go back",children:[i.jsx(nn,{size:20,style:{marginRight:"8px"}}),"Back"]}),i.jsx("h1",{className:"create-lab-order-title",children:"Create New Lab Order"}),i.jsx("div",{style:{width:"64px"}})," "]}),(t==="select_patient"||t==="create_patient")&&i.jsxs("div",{className:"glass-card",children:[t==="select_patient"&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"header-with-action",children:i.jsx("h2",{className:"card-title",style:{borderBottom:"none",marginBottom:0},children:"Select Patient"})}),i.jsxs("div",{className:"search-container",children:[i.jsx(ua,{className:"search-icon",size:20}),i.jsx("input",{type:"text",id:"lab-patient-search",placeholder:"Search by Name, Token No, or Phone No...",value:T,onChange:D,className:"modern-input",autoFocus:!0,autoComplete:"off"}),U&&i.jsx("span",{className:"loading-text",style:{position:"absolute",right:"15px",top:"50%",transform:"translateY(-50%)",fontSize:"0.8rem"},children:"Searching..."})]}),$&&i.jsxs("div",{className:"error-message",children:[i.jsx(Er,{size:18}),$]}),M.length>0&&i.jsx("ul",{className:"patient-list",children:M.map(Z=>i.jsxs("li",{onClick:()=>le(Z),className:"patient-list-item",children:[i.jsxs("div",{className:"patient-info",children:[i.jsx("strong",{children:Z.name}),i.jsxs("span",{className:"token-badge",children:["#",Z.token||"N/A"]})]}),i.jsxs("div",{className:"patient-details",children:[Z.age?`${Z.age} yrs`:"",Z.gender?` / ${Z.gender}`:"",Z.phone?`  ${Z.phone}`:""]})]},Z.id))}),T.length>=2&&!U&&M.length===0&&!$&&i.jsxs("div",{style:{textAlign:"center",marginTop:"20px"},children:[i.jsxs("p",{className:"no-data-message",style:{background:"none",border:"none",padding:0},children:['No patients found matching "',T,'".']}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"15px",marginTop:"15px"},children:[te&&i.jsxs("button",{type:"button",onClick:()=>ce("phone"),className:"secondary-button",children:['Create "Direct Lab" Patient (Phone: ',T,")"]}),V&&i.jsxs("button",{type:"button",onClick:()=>ce("name"),className:"secondary-button",children:["Create Patient (Name: ",T,")"]})]})]}),T.length<2&&!U&&i.jsx("div",{className:"info-message",children:"Start typing to search for a patient..."})]}),t==="create_patient"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"header-with-action",children:[i.jsx("h2",{className:"card-title",style:{borderBottom:"none",marginBottom:0},children:"New Patient Registration"}),i.jsx("button",{onClick:ve,className:"text-button",children:" Back to Search "})]}),F&&i.jsxs("div",{className:"error-message",children:[i.jsx(Er,{size:18}),F]}),i.jsxs("form",{onSubmit:fe,children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{htmlFor:"lab-patient-name",className:"form-label",children:"Patient Name *"}),i.jsxs("div",{className:"search-container",style:{margin:0},children:[i.jsx(Ko,{className:"search-icon",size:18}),i.jsx("input",{type:"text",name:"name",id:"lab-patient-name",required:!0,value:a.name,onChange:X,className:"modern-input",placeholder:"Enter full name"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lab-patient-age",className:"form-label",children:"Age"}),i.jsx("input",{type:"number",name:"age",id:"lab-patient-age",value:a.age??"",onChange:X,className:"modern-input",style:{paddingLeft:"16px"},placeholder:"e.g. 30"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lab-patient-gender",className:"form-label",children:"Gender"}),i.jsxs("select",{name:"gender",id:"lab-patient-gender",value:a.gender??"",onChange:X,className:"modern-input",style:{paddingLeft:"16px"},children:[i.jsx("option",{value:"",children:"Select Gender..."}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{htmlFor:"lab-patient-phone",className:"form-label",children:"Phone Number"}),i.jsxs("div",{className:"search-container",style:{margin:0},children:[i.jsx(s2,{className:"search-icon",size:18}),i.jsx("input",{type:"tel",name:"phone",id:"lab-patient-phone",value:a.phone||"",onChange:X,className:"modern-input",placeholder:"e.g. 9876543210"})]})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{htmlFor:"lab-patient-address",className:"form-label",children:"Address"}),i.jsxs("div",{className:"search-container",style:{margin:0},children:[i.jsx(i2,{className:"search-icon",size:18,style:{top:"20px"}}),i.jsx("textarea",{name:"address",id:"lab-patient-address",rows:2,value:a.address||"",onChange:X,className:"modern-input",style:{resize:"none"},placeholder:"Enter address (optional)"})]})]})]}),i.jsxs("div",{className:"flex-end",children:[i.jsx("button",{type:"button",onClick:ve,className:"secondary-button",children:" Cancel "}),i.jsxs("button",{type:"submit",className:"primary-button",children:[i.jsx(Ql,{size:18}),"Create & Proceed"]})]})]})]})]}),t==="create_order"&&l&&i.jsxs("div",{className:"glass-card",children:[i.jsxs("div",{className:"header-with-action",children:[i.jsx("h2",{className:"card-title",style:{borderBottom:"none",marginBottom:0},children:"Create Lab Order"}),i.jsx("button",{onClick:ve,className:"text-button",children:" Change Patient "})]}),i.jsxs("div",{className:"patient-summary",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx(Ko,{size:20,className:"highlight-primary"}),i.jsx("span",{style:{fontSize:"1.1rem",fontWeight:"600"},children:l.name})]}),i.jsxs("div",{className:"patient-details",style:{marginLeft:"30px",marginTop:"4px"},children:[l.age?`${l.age} yrs`:"Age N/A",l.gender&&`  ${l.gender}`,l.phone&&`  ${l.phone}`]})]}),R&&i.jsxs("div",{className:"error-message",children:[i.jsx(Er,{size:18}),R]}),i.jsxs("form",{onSubmit:Ke,children:[i.jsxs("div",{className:"form-group",style:{position:"relative"},children:[i.jsx("label",{htmlFor:"lab-test-search",className:"form-label",children:"Add Lab Test"}),i.jsxs("div",{className:"search-container",style:{margin:0},children:[i.jsx(ua,{className:"search-icon",size:18}),i.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search tests (e.g. CBC, Lipid Profile)...",value:b,onChange:Z=>v(Z.target.value),className:"modern-input",disabled:G,autoComplete:"off"}),G&&i.jsx("div",{className:"loading-spinner-small",style:{position:"absolute",right:"15px",top:"50%",transform:"translateY(-50%)"}})]}),b&&S.length>0&&i.jsx("div",{className:"search-results-dropdown",children:S.map(Z=>i.jsxs("div",{onClick:()=>ae(Z),className:"search-result-item",children:[i.jsx("span",{style:{fontWeight:500},children:Z.name}),i.jsxs("span",{className:"highlight-primary",style:{fontWeight:600},children:["",parseFloat(Z.price).toFixed(2)]})]},Z.id))}),b&&S.length===0&&!G&&i.jsxs("div",{className:"no-data-message",style:{marginTop:"5px",padding:"10px",fontSize:"0.9rem"},children:['No tests found matching "',b,'".']})]}),i.jsxs("div",{style:{marginTop:"30px"},children:[i.jsxs("h4",{className:"card-title",style:{fontSize:"1.1rem"},children:["Selected Tests (",p.length,")"]}),p.length===0?i.jsx("div",{className:"info-message",children:"No tests added yet. Search above to add tests."}):i.jsx("div",{className:"selected-tests-list",children:p.map(Z=>i.jsxs("div",{className:"selected-test-item",children:[i.jsx("div",{style:{flex:1},children:i.jsx("div",{style:{fontWeight:500},children:Z.name})}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"20px"},children:[i.jsxs("span",{className:"highlight-primary",style:{fontWeight:600},children:["",parseFloat(Z.price).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>Me(Z.id),className:"remove-button",title:"Remove Test",children:i.jsx(li,{size:18})})]})]},Z.id))})]}),p.length>0&&i.jsxs("div",{className:"total-price",children:["Total: ",p.reduce((Z,Ee)=>Z+parseFloat(Ee.price),0).toFixed(2)]}),i.jsxs("div",{className:"flex-end",children:[i.jsx("button",{type:"button",onClick:ve,className:"secondary-button",children:" Cancel Order "}),i.jsxs("button",{type:"submit",disabled:p.length===0,className:"primary-button",children:[i.jsx(FR,{size:18}),"Create Lab Order"]})]})]})]})]})},ZU=({currentUser:e})=>{const[n,t]=w.useState("newtons-ai"),[r,a]=w.useState(""),[o,l]=w.useState([]),[d,f]=w.useState(!0),[u,p]=w.useState([]),[g,b]=w.useState(!1),[v,S]=w.useState(null),[k,T]=w.useState(null),P=Et(),M=Yr(),I=async()=>{f(!0),T(null);let R=[];try{const B=await pe("/api/queue");if(!B.ok){const te=await B.json();throw new Error(te.message||"Failed to fetch queue")}R=await B.json(),console.log("Fetched Initial Queue Data:",JSON.stringify(R,null,2));const G=R.map(async te=>{if(!te.patient_id)return console.warn(`Queue entry ${te.id} has no patient_id.`),te;try{const W=await pe(`/api/patients/${te.patient_id}`);if(!W.ok)return console.error(`Failed to fetch patient details for ${te.patient_id}: ${W.status}`),te;const V=await W.json();return{...te,Patient:{...te.Patient??{},...V}}}catch(W){return console.error(`Error fetching patient details for ${te.patient_id}:`,W),te}}),ie=await Promise.all(G);console.log("Enriched Queue Data (Before Sort):",JSON.stringify(ie,null,2)),ie.sort((te,W)=>{var E,le;const V=((E=te.Patient)==null?void 0:E.subscription_status)==="active",se=((le=W.Patient)==null?void 0:le.subscription_status)==="active";if(V&&!se)return-1;if(!V&&se)return 1;const re=te.created_at?new Date(te.created_at).getTime():0,oe=W.created_at?new Date(W.created_at).getTime():0;return re-oe}),console.log("Sorted Queue Data:",JSON.stringify(ie,null,2)),l(ie)}catch(B){console.error("Error in fetchQueue process:",B),T(`Failed to load queue: ${B.message}`),l(R)}finally{f(!1)}},U=async()=>{b(!0),T(null);try{const R=await pe("/api/staff?role=doctor");if(!R.ok){const G=await R.json();throw new Error(G.message||"Failed to fetch doctors")}const B=await R.json();p(B.filter(G=>G.active))}catch(R){console.error("Error fetching doctors:",R),T(`Failed to fetch doctors: ${R.message}`)}finally{b(!1)}};w.useEffect(()=>{const B=new URLSearchParams(M.search).get("tab");B&&z.find(ie=>ie.id===B)&&t(B)},[M.search]),w.useEffect(()=>{n==="queue"&&(I(),U()),S(null)},[n]);const L=w.useCallback(async(R,B)=>{if(console.log(`Attempting to assign doctor ${B} to queue ${R}`),T(null),S(null),!B){console.log("No doctor ID provided, skipping assignment.");return}const G=o.find(W=>W.id===R);if(!G){console.error(`Queue entry ${R} not found in local state.`),T("Queue entry not found.");return}if(G.doctor_id===B){console.log(`Queue ${R} already assigned to doctor ${B}. Skipping.`);return}const ie=async W=>{if(!W||!W.id||!W.name){T("Cannot proceed: Patient ID or Name is missing."),console.error("assignAndNavigate called with invalid patientInfo",W);return}const V=async()=>{try{const se={status:"waiting",doctorId:B},re=await pe(`/api/queue/${R}/status`,{method:"PATCH",body:JSON.stringify(se)}),oe=await re.json();if(!re.ok)throw new Error(oe.message||`HTTP error! status: ${re.status}`);const E=u.find(le=>le.id===B);return console.log(`Successfully assigned doctor ${E==null?void 0:E.name} to queue ${R}.`),l(le=>le.map(ue=>ue.id===R?{...ue,doctor_id:B,status:oe.status||ue.status,User:E?{name:E.name}:null,Patient:W}:ue)),!0}catch(se){return console.error(`Error assigning doctor for queue ${R}:`,se),T(`Failed to assign doctor: ${se.message}`),!1}};W.subscription_status==="active"?(console.log(`Patient ${W.name} (ID: ${W.id}) has active subscription. Assigning doctor directly.`),await V()):(console.log(`Patient ${W.name} (ID: ${W.id}) does not have active subscription (Status: ${W.subscription_status}). Assigning doctor and proceeding to billing.`),await V()?(console.log(`Navigating to billing for patient ${W.name} (ID: ${W.id}), queue ID: ${R}, doctor ID: ${B}`),P("/billing",{state:{patientId:W.id,queueId:R,patientName:W.name,doctorId:B,billType:"consultation"}})):console.log(`Assignment failed for patient ${W.name}, skipping navigation.`))},te=G.Patient;if(te&&te.id&&te.name)console.log("Patient details found in state. Proceeding with assignment."),await ie(te);else{console.warn(`Patient details missing for queue entry ${R}. Fetching patient ${G.patient_id}...`);try{const W=await pe(`/api/patients/${G.patient_id}`);if(!W.ok){const se=await W.json().catch(()=>({}));throw new Error(se.message||`Failed to fetch patient details (status ${W.status})`)}const V=await W.json();console.log("Successfully fetched patient details:",V),await ie(V)}catch(W){console.error(`Failed to fetch patient details for patient ID ${G.patient_id}:`,W),T(`Failed to fetch required patient details: ${W.message}`)}}},[u,o,P]),$=async(R,B)=>{T(null);const G=B==="consulting"?"start consultation":"complete visit";try{const ie=o.find(se=>se.id===R);if(!ie&&B==="consulting")throw new Error("Queue entry not found to start consultation.");let te={status:B};if(B==="consulting"){if(!(ie!=null&&ie.doctor_id))throw new Error("Cannot start consultation without an assigned doctor.");te.doctorId=ie.doctor_id}const W=await pe(`/api/queue/${R}/status`,{method:"PATCH",body:JSON.stringify(te)}),V=await W.json();if(!W.ok)throw new Error(V.message||`HTTP error! status: ${W.status}`);l(se=>se.map(re=>re.id===R?{...re,status:B}:re))}catch(ie){console.error(`Error trying to ${G}:`,ie),T(`Failed to ${G}: ${ie.message}`)}},z=[{id:"queue",label:"Queue",icon:i.jsx(zh,{size:20})},{id:"newtons-ai",label:"Newtons AI",icon:i.jsx(ua,{size:20})},{id:"manage-admission",label:"Manage Admission",icon:i.jsx(fI,{size:20})},{id:"all-patients",label:"All Patients",icon:i.jsx(rR,{size:20})},{id:"lab",label:"Lab Tests",icon:i.jsx(X0,{size:20})},{id:"custom-bill",label:"Custom Bill",icon:i.jsx(us,{size:20})}],F=R=>{try{return new Date(R).toLocaleTimeString("en-IN",{hour:"numeric",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},Y=o.filter(R=>{var B,G;return(G=(B=R.Patient)==null?void 0:B.name)==null?void 0:G.toLowerCase().includes(r.toLowerCase())});return i.jsx("div",{className:"reception-dashboard-container",children:i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[k&&i.jsxs("div",{className:"error-message-reception",role:"alert",children:[" ",i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:k})]}),i.jsxs("div",{className:"reception-tab-nav",children:[" ",z.map(R=>i.jsxs("button",{className:`reception-tab-button ${n===R.id?"active":""}`,onClick:()=>t(R.id),children:[i.jsx("span",{children:R.icon}),R.label]},R.id))]}),n==="queue"&&i.jsxs("div",{className:"space-y-6",children:[" ",i.jsxs("div",{className:"queue-header",children:[" ",i.jsxs("div",{className:"queue-actions",children:[" ",i.jsxs("div",{className:"search-bar-container",children:[" ",i.jsx("input",{type:"text",placeholder:"Search patients in queue...",className:"search-input",value:r,onChange:R=>a(R.target.value)}),i.jsx(ua,{className:"search-icon",size:18})]})]}),i.jsxs("div",{className:"summary-cards-grid",children:[" ",i.jsxs("div",{className:"summary-card card-waiting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Waiting"})," ",i.jsx("div",{className:"summary-card-value",children:o.filter(R=>R.status==="waiting").length})," "]}),i.jsxs("div",{className:"summary-card card-consulting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Consulting"})," ",i.jsx("div",{className:"summary-card-value",children:o.filter(R=>R.status==="consulting").length})," "]}),i.jsxs("div",{className:"summary-card card-completed",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Completed"})," ",i.jsx("div",{className:"summary-card-value",children:o.filter(R=>R.status==="seen").length})," "]})]})]}),d?i.jsxs("div",{className:"loading-container",children:[" ",i.jsx("div",{className:"breathing-ball"})," ",i.jsx("span",{children:"Loading queue..."})]}):Y.length===0?i.jsx("div",{className:"empty-queue-message",children:r?"No patients found matching your search.":"Queue is empty."}):i.jsxs("div",{className:"queue-table-wrapper",children:[" ",i.jsxs("table",{className:"queue-table",children:[" ",i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Queue"}),i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Phone Number"}),i.jsx("th",{children:"Complaint"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{className:"hidden md:table-cell",children:"Time Added"})," ",i.jsx("th",{className:"text-center",children:"Action / Doctor"})," "]})}),i.jsx("tbody",{children:Y.map(R=>{var B,G,ie,te,W,V,se,re,oe,E,le;return i.jsxs("tr",{onClick:()=>P(`/dashboard/edit-complaint/${R.id}`),className:"queue-row-clickable",children:[i.jsxs("td",{children:[" ",i.jsxs("span",{className:"queue-token",children:["#",R.token_no]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-name",children:((B=R.Patient)==null?void 0:B.name)||"N/A"})," ",i.jsxs("div",{className:"patient-details",children:[(G=R.Patient)!=null&&G.age?`${R.Patient.age} yrs, `:"",((ie=R.Patient)==null?void 0:ie.gender)||""]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-phone",children:((te=R.Patient)==null?void 0:te.phone)||"N/A"})," "]}),i.jsx("td",{className:"complaint-text",children:R.complaint||"-"}),i.jsxs("td",{children:[i.jsx("span",{className:`subscription-status-badge ${((W=R.Patient)==null?void 0:W.subscription_status)==="active"?"status-active":((V=R.Patient)==null?void 0:V.subscription_status)==="cancelled"||((se=R.Patient)==null?void 0:se.subscription_status)==="expired"?"status-inactive":"status-none"}`,children:((re=R.Patient)==null?void 0:re.subscription_status)??"None"}),R.Patient&&R.Patient.id&&R.Patient.subscription_status!=="active"&&i.jsx("button",{onClick:ue=>{ue.stopPropagation(),R.Patient&&P(`/start-subscription/${R.Patient.id}`)},className:"action-button btn-start-sub-queue mt-2",children:"Start Sub"})]}),i.jsx("td",{className:"hidden md:table-cell time-added",children:F(R.created_at)}),i.jsx("td",{className:"action-doctor-cell",children:v===R.id?i.jsx("div",{className:"relative inline-block text-left w-full",onClick:ue=>ue.stopPropagation(),children:i.jsxs("select",{value:"",onChange:ue=>L(R.id,ue.target.value),onBlur:()=>S(null),className:"doctor-select-dropdown",autoFocus:!0,children:[i.jsx("option",{value:"",disabled:!0,children:"Select Doctor..."}),g?i.jsx("option",{disabled:!0,children:"Loading..."}):u.length>0?u.map(ue=>i.jsx("option",{value:ue.id,children:ue.name},ue.id)):i.jsx("option",{disabled:!0,children:"No doctors available"})]})}):i.jsxs("div",{className:"action-doctor-content",onClick:ue=>ue.stopPropagation(),children:[" ",R.status==="waiting"&&i.jsx(i.Fragment,{children:(oe=R.User)!=null&&oe.name?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"doctor-name-display",children:R.User.name}),i.jsx("button",{onClick:()=>$(R.id,"consulting"),className:"action-button btn-start",children:"Start"})]}):g?i.jsx("span",{className:"status-text-italic",children:"Loading..."}):u.length===0?i.jsx("span",{className:"status-text-red",children:"No doctors"}):u.length===1?i.jsxs("button",{onClick:()=>L(R.id,u[0].id),className:"action-button btn-assign",children:["Assign ",u[0].name]}):i.jsx("button",{onClick:()=>S(R.id),className:"action-button btn-assign",children:"Assign"})}),R.status==="consulting"&&i.jsxs(i.Fragment,{children:[((E=R.User)==null?void 0:E.name)&&i.jsx("span",{className:"doctor-name-display",children:R.User.name}),i.jsx("button",{onClick:()=>$(R.id,"seen"),className:"action-button btn-complete",children:"Complete"})]}),R.status==="seen"&&i.jsxs(i.Fragment,{children:[((le=R.User)==null?void 0:le.name)&&i.jsx("span",{className:"doctor-name-display",children:R.User.name}),i.jsx("span",{className:"status-text-italic",children:"Completed"})]}),R.status==="cancelled"&&i.jsx("span",{className:"status-text-red",children:"Cancelled"})]})})]},R.id)})})]})]})]}),n==="lab"&&i.jsxs("div",{className:"lab-tab-content",children:[" ",i.jsx(Jk,{currentUser:e}),i.jsxs("button",{onClick:()=>P("/lab/search-report"),className:"lab-action-button btn-search-lab-reports",children:[i.jsx(ua,{size:16}),"Search Lab Reports"]})]}),n==="newtons-ai"&&i.jsx("div",{className:"newtons-ai-tab-content",children:i.jsx(Sh,{})}),n==="manage-admission"&&i.jsx("div",{className:"manage-admission-tab-content",children:i.jsx(Wk,{})}),n==="all-patients"&&i.jsx("div",{className:"all-patients-tab-content",children:i.jsx(N1,{})}),n==="custom-bill"&&i.jsx("div",{className:"custom-bill-tab-content",children:i.jsx(Qk,{})})]})})},Kk=6048e5,eB=864e5,Xk=6e4,Zk=36e5,UC=Symbol.for("constructDateFrom");function Hs(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&UC in e?e[UC](n):e instanceof Date?new e.constructor(n):new Date(n)}function _i(e,n){return Hs(n||e,e)}function tB(e,n,t){const r=_i(e,t==null?void 0:t.in);if(isNaN(n))return Hs(e,NaN);const a=r.getDate(),o=Hs(e,r.getTime());o.setMonth(r.getMonth()+n+1,0);const l=o.getDate();return a>=l?o:(r.setFullYear(o.getFullYear(),o.getMonth(),a),r)}let nB={};function Lb(){return nB}function Xm(e,n){var d,f,u,p;const t=Lb(),r=(n==null?void 0:n.weekStartsOn)??((f=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:f.weekStartsOn)??t.weekStartsOn??((p=(u=t.locale)==null?void 0:u.options)==null?void 0:p.weekStartsOn)??0,a=_i(e,n==null?void 0:n.in),o=a.getDay(),l=(o<r?7:0)+o-r;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function cb(e,n){return Xm(e,{...n,weekStartsOn:1})}function eT(e,n){const t=_i(e,n==null?void 0:n.in),r=t.getFullYear(),a=Hs(t,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const o=cb(a),l=Hs(t,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const d=cb(l);return t.getTime()>=o.getTime()?r+1:t.getTime()>=d.getTime()?r:r-1}function BC(e){const n=_i(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function rB(e,...n){const t=Hs.bind(null,n.find(r=>typeof r=="object"));return n.map(t)}function qC(e,n){const t=_i(e,n==null?void 0:n.in);return t.setHours(0,0,0,0),t}function iB(e,n,t){const[r,a]=rB(t==null?void 0:t.in,e,n),o=qC(r),l=qC(a),d=+o-BC(o),f=+l-BC(l);return Math.round((d-f)/eB)}function aB(e,n){const t=eT(e,n),r=Hs(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),cb(r)}function sB(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function C1(e){return!(!sB(e)&&typeof e!="number"||isNaN(+_i(e)))}function oB(e,n){const t=_i(e,n==null?void 0:n.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}const lB={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},cB=(e,n,t)=>{let r;const a=lB[e];return typeof a=="string"?r=a:n===1?r=a.one:r=a.other.replace("{{count}}",n.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function u0(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const uB={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},dB={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},fB={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},hB={date:u0({formats:uB,defaultWidth:"full"}),time:u0({formats:dB,defaultWidth:"full"}),dateTime:u0({formats:fB,defaultWidth:"full"})},pB={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},mB=(e,n,t,r)=>pB[e];function Tm(e){return(n,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,d=t!=null&&t.width?String(t.width):l;a=e.formattingValues[d]||e.formattingValues[l]}else{const l=e.defaultWidth,d=t!=null&&t.width?String(t.width):e.defaultWidth;a=e.values[d]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(n):n;return a[o]}}const gB={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},yB={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},xB={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},bB={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},vB={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},wB={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},SB=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},NB={ordinalNumber:SB,era:Tm({values:gB,defaultWidth:"wide"}),quarter:Tm({values:yB,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Tm({values:xB,defaultWidth:"wide"}),day:Tm({values:bB,defaultWidth:"wide"}),dayPeriod:Tm({values:vB,defaultWidth:"wide",formattingValues:wB,defaultFormattingWidth:"wide"})};function Em(e){return(n,t={})=>{const r=t.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],o=n.match(a);if(!o)return null;const l=o[0],d=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(d)?jB(d,g=>g.test(l)):CB(d,g=>g.test(l));let u;u=e.valueCallback?e.valueCallback(f):f,u=t.valueCallback?t.valueCallback(u):u;const p=n.slice(l.length);return{value:u,rest:p}}}function CB(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function jB(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function _B(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const a=r[0],o=n.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=t.valueCallback?t.valueCallback(l):l;const d=n.slice(a.length);return{value:l,rest:d}}}const kB=/^(\d+)(th|st|nd|rd)?/i,TB=/\d+/i,EB={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},AB={any:[/^b/i,/^(a|c)/i]},PB={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},DB={any:[/1/i,/2/i,/3/i,/4/i]},IB={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},RB={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},MB={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},OB={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},LB={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},FB={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},$B={ordinalNumber:_B({matchPattern:kB,parsePattern:TB,valueCallback:e=>parseInt(e,10)}),era:Em({matchPatterns:EB,defaultMatchWidth:"wide",parsePatterns:AB,defaultParseWidth:"any"}),quarter:Em({matchPatterns:PB,defaultMatchWidth:"wide",parsePatterns:DB,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Em({matchPatterns:IB,defaultMatchWidth:"wide",parsePatterns:RB,defaultParseWidth:"any"}),day:Em({matchPatterns:MB,defaultMatchWidth:"wide",parsePatterns:OB,defaultParseWidth:"any"}),dayPeriod:Em({matchPatterns:LB,defaultMatchWidth:"any",parsePatterns:FB,defaultParseWidth:"any"})},zB={code:"en-US",formatDistance:cB,formatLong:hB,formatRelative:mB,localize:NB,match:$B,options:{weekStartsOn:0,firstWeekContainsDate:1}};function UB(e,n){const t=_i(e,n==null?void 0:n.in);return iB(t,oB(t))+1}function BB(e,n){const t=_i(e,n==null?void 0:n.in),r=+cb(t)-+aB(t);return Math.round(r/Kk)+1}function tT(e,n){var p,g,b,v;const t=_i(e,n==null?void 0:n.in),r=t.getFullYear(),a=Lb(),o=(n==null?void 0:n.firstWeekContainsDate)??((g=(p=n==null?void 0:n.locale)==null?void 0:p.options)==null?void 0:g.firstWeekContainsDate)??a.firstWeekContainsDate??((v=(b=a.locale)==null?void 0:b.options)==null?void 0:v.firstWeekContainsDate)??1,l=Hs((n==null?void 0:n.in)||e,0);l.setFullYear(r+1,0,o),l.setHours(0,0,0,0);const d=Xm(l,n),f=Hs((n==null?void 0:n.in)||e,0);f.setFullYear(r,0,o),f.setHours(0,0,0,0);const u=Xm(f,n);return+t>=+d?r+1:+t>=+u?r:r-1}function qB(e,n){var d,f,u,p;const t=Lb(),r=(n==null?void 0:n.firstWeekContainsDate)??((f=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??t.firstWeekContainsDate??((p=(u=t.locale)==null?void 0:u.options)==null?void 0:p.firstWeekContainsDate)??1,a=tT(e,n),o=Hs((n==null?void 0:n.in)||e,0);return o.setFullYear(a,0,r),o.setHours(0,0,0,0),Xm(o,n)}function VB(e,n){const t=_i(e,n==null?void 0:n.in),r=+Xm(t,n)-+qB(t,n);return Math.round(r/Kk)+1}function Bn(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const nu={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return Bn(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):Bn(t+1,2)},d(e,n){return Bn(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return Bn(e.getHours()%12||12,n.length)},H(e,n){return Bn(e.getHours(),n.length)},m(e,n){return Bn(e.getMinutes(),n.length)},s(e,n){return Bn(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,t-3));return Bn(a,n.length)}},ph={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},VC={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return t.ordinalNumber(a,{unit:"year"})}return nu.y(e,n)},Y:function(e,n,t,r){const a=tT(e,r),o=a>0?a:1-a;if(n==="YY"){const l=o%100;return Bn(l,2)}return n==="Yo"?t.ordinalNumber(o,{unit:"year"}):Bn(o,n.length)},R:function(e,n){const t=eT(e);return Bn(t,n.length)},u:function(e,n){const t=e.getFullYear();return Bn(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return Bn(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return Bn(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return nu.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return Bn(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const a=VB(e,r);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):Bn(a,n.length)},I:function(e,n,t){const r=BB(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):Bn(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):nu.d(e,n)},D:function(e,n,t){const r=UB(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):Bn(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(o);case"ee":return Bn(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(o);case"cc":return Bn(o,n.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),a=r===0?7:r;switch(n){case"i":return String(a);case"ii":return Bn(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let a;switch(r===12?a=ph.noon:r===0?a=ph.midnight:a=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let a;switch(r>=17?a=ph.evening:r>=12?a=ph.afternoon:r>=4?a=ph.morning:a=ph.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return nu.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):nu.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):Bn(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):Bn(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):nu.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):nu.s(e,n)},S:function(e,n){return nu.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return GC(r);case"XXXX":case"XX":return Pd(r);case"XXXXX":case"XXX":default:return Pd(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return GC(r);case"xxxx":case"xx":return Pd(r);case"xxxxx":case"xxx":default:return Pd(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+HC(r,":");case"OOOO":default:return"GMT"+Pd(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+HC(r,":");case"zzzz":default:return"GMT"+Pd(r,":")}},t:function(e,n,t){const r=Math.trunc(+e/1e3);return Bn(r,n.length)},T:function(e,n,t){return Bn(+e,n.length)}};function HC(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),o=r%60;return o===0?t+String(a):t+String(a)+n+Bn(o,2)}function GC(e,n){return e%60===0?(e>0?"-":"+")+Bn(Math.abs(e)/60,2):Pd(e,n)}function Pd(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Bn(Math.trunc(r/60),2),o=Bn(r%60,2);return t+a+n+o}const YC=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},nT=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},HB=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],a=t[2];if(!a)return YC(e,n);let o;switch(r){case"P":o=n.dateTime({width:"short"});break;case"PP":o=n.dateTime({width:"medium"});break;case"PPP":o=n.dateTime({width:"long"});break;case"PPPP":default:o=n.dateTime({width:"full"});break}return o.replace("{{date}}",YC(r,n)).replace("{{time}}",nT(a,n))},GB={p:nT,P:HB},YB=/^D+$/,WB=/^Y+$/,QB=["D","DD","YY","YYYY"];function JB(e){return YB.test(e)}function KB(e){return WB.test(e)}function XB(e,n,t){const r=ZB(e,n,t);if(console.warn(r),QB.includes(e))throw new RangeError(r)}function ZB(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const e9=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,t9=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,n9=/^'([^]*?)'?$/,r9=/''/g,i9=/[a-zA-Z]/;function Rd(e,n,t){var p,g,b,v;const r=Lb(),a=r.locale??zB,o=r.firstWeekContainsDate??((g=(p=r.locale)==null?void 0:p.options)==null?void 0:g.firstWeekContainsDate)??1,l=r.weekStartsOn??((v=(b=r.locale)==null?void 0:b.options)==null?void 0:v.weekStartsOn)??0,d=_i(e,t==null?void 0:t.in);if(!C1(d))throw new RangeError("Invalid time value");let f=n.match(t9).map(S=>{const k=S[0];if(k==="p"||k==="P"){const T=GB[k];return T(S,a.formatLong)}return S}).join("").match(e9).map(S=>{if(S==="''")return{isToken:!1,value:"'"};const k=S[0];if(k==="'")return{isToken:!1,value:a9(S)};if(VC[k])return{isToken:!0,value:S};if(k.match(i9))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");return{isToken:!1,value:S}});a.localize.preprocessor&&(f=a.localize.preprocessor(d,f));const u={firstWeekContainsDate:o,weekStartsOn:l,locale:a};return f.map(S=>{if(!S.isToken)return S.value;const k=S.value;(KB(k)||JB(k))&&XB(k,n,String(e));const T=VC[k[0]];return T(d,k,a.localize,u)}).join("")}function a9(e){const n=e.match(n9);return n?n[1].replace(r9,"'"):e}function d0(e,n){return+_i(e)<+_i(n)}function WC(e,n){const t=()=>Hs(n==null?void 0:n.in,NaN),a=c9(e);let o;if(a.date){const u=u9(a.date,2);o=d9(u.restDateString,u.year)}if(!o||isNaN(+o))return t();const l=+o;let d=0,f;if(a.time&&(d=f9(a.time),isNaN(d)))return t();if(a.timezone){if(f=h9(a.timezone),isNaN(f))return t()}else{const u=new Date(l+d),p=_i(0,n==null?void 0:n.in);return p.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),p.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),p}return _i(l+d+f,n==null?void 0:n.in)}const vx={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},s9=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,o9=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,l9=/^([+-])(\d{2})(?::?(\d{2}))?$/;function c9(e){const n={},t=e.split(vx.dateTimeDelimiter);let r;if(t.length>2)return n;if(/:/.test(t[0])?r=t[0]:(n.date=t[0],r=t[1],vx.timeZoneDelimiter.test(n.date)&&(n.date=e.split(vx.timeZoneDelimiter)[0],r=e.substr(n.date.length,e.length))),r){const a=vx.timezone.exec(r);a?(n.time=r.replace(a[1],""),n.timezone=a[1]):n.time=r}return n}function u9(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),r=e.match(t);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:o===null?a:o*100,restDateString:e.slice((r[1]||r[2]).length)}}function d9(e,n){if(n===null)return new Date(NaN);const t=e.match(s9);if(!t)return new Date(NaN);const r=!!t[4],a=Am(t[1]),o=Am(t[2])-1,l=Am(t[3]),d=Am(t[4]),f=Am(t[5])-1;if(r)return x9(n,d,f)?p9(n,d,f):new Date(NaN);{const u=new Date(0);return!g9(n,o,l)||!y9(n,a)?new Date(NaN):(u.setUTCFullYear(n,o,Math.max(a,l)),u)}}function Am(e){return e?parseInt(e):1}function f9(e){const n=e.match(o9);if(!n)return NaN;const t=f0(n[1]),r=f0(n[2]),a=f0(n[3]);return b9(t,r,a)?t*Zk+r*Xk+a*1e3:NaN}function f0(e){return e&&parseFloat(e.replace(",","."))||0}function h9(e){if(e==="Z")return 0;const n=e.match(l9);if(!n)return 0;const t=n[1]==="+"?-1:1,r=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return v9(r,a)?t*(r*Zk+a*Xk):NaN}function p9(e,n,t){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,o=(n-1)*7+t+1-a;return r.setUTCDate(r.getUTCDate()+o),r}const m9=[31,null,31,30,31,30,31,31,30,31,30,31];function rT(e){return e%400===0||e%4===0&&e%100!==0}function g9(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(m9[n]||(rT(e)?29:28))}function y9(e,n){return n>=1&&n<=(rT(e)?366:365)}function x9(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function b9(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function v9(e,n){return n>=0&&n<=59}const jw=({isEmbedded:e=!1})=>{const[n,t]=w.useState([]),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,p]=w.useState(null),g=w.useRef(null),[b,v]=w.useState(!1),[S,k]=w.useState(null),[T,P]=w.useState(!1),[M,I]=w.useState(!1),[U,L]=w.useState(null),[$,z]=w.useState({name:"",description:"",price:"",default_parameters:[]}),F=w.useCallback(async()=>{a(!0),l(null),p(null),k(null);try{const D=await pe("/api/lab-tests");if(!D.ok)throw new Error(`HTTP error! status: ${D.status}`);const ce=await D.json();t(ce)}catch(D){console.error("Error fetching lab tests:",D),l(D.message||"Failed to fetch lab tests.")}finally{a(!1)}},[]);w.useEffect(()=>{F()},[F]);const Y=D=>{const{name:ce,value:ve}=D.target;z(X=>({...X,[ce]:ve}))},R=(D,ce,ve)=>{const X=[...$.default_parameters],fe=X[D];if(ce==="type")switch(fe.type=ve,ve){case"number":fe.defaultValue=0,fe.lower_limit=null,fe.upper_limit=null,fe.unit="";break;case"boolean":fe.defaultValue=!1,fe.lower_limit=void 0,fe.upper_limit=void 0,fe.unit=void 0;break;case"string":default:fe.defaultValue="",fe.lower_limit=void 0,fe.upper_limit=void 0,fe.unit=void 0;break}else ce==="defaultValue"?fe.type==="number"?fe.defaultValue=parseFloat(ve)||0:(fe.type,fe.defaultValue=ve):ce==="lower_limit"||ce==="upper_limit"?fe[ce]=ve===""?null:parseFloat(ve):fe[ce]=ve;z(ae=>({...ae,default_parameters:X}))},B=()=>{z(D=>({...D,default_parameters:[...D.default_parameters,{name:"",type:"string",defaultValue:"",unit:"",lower_limit:null,upper_limit:null}]}))},G=D=>{z(ce=>({...ce,default_parameters:ce.default_parameters.filter((ve,X)=>X!==D)}))},ie=async D=>{D.preventDefault(),a(!0),l(null);const ce=U!==null,ve=ce?`/api/lab-tests/${U}`:"/api/lab-tests",X=ce?"PUT":"POST";try{const fe=await pe(ve,{method:X,headers:{"Content-Type":"application/json"},body:JSON.stringify({name:$.name,description:$.description,price:parseFloat($.price),default_parameters:$.default_parameters})});if(!fe.ok){const ae=await fe.json();throw new Error(ae.message||`HTTP error! status: ${fe.status}`)}I(!1),L(null),z({name:"",description:"",price:"",default_parameters:[]}),F()}catch(fe){console.error(`Error ${ce?"updating":"adding"} lab test:`,fe),l(fe.message||`Failed to ${ce?"update":"add"} lab test.`)}finally{a(!1)}},te=()=>{L(null),z({name:"",description:"",price:"",default_parameters:[]}),I(!0)},W=D=>{if(U===D.id)L(null);else{L(D.id);const ce=(D.default_parameters||[]).map(ve=>({...ve,unit:ve.unit||"",lower_limit:ve.lower_limit===void 0?null:ve.lower_limit,upper_limit:ve.upper_limit===void 0?null:ve.upper_limit}));z({name:D.name,description:D.description||"",price:D.price,default_parameters:ce}),I(!1)}},V=async D=>{if(window.confirm("Are you sure you want to delete this lab test?")){a(!0),l(null);try{const ce=await pe(`/api/lab-tests/${D}`,{method:"DELETE"});if(!ce.ok){const ve=await ce.json();throw new Error(ve.message||`HTTP error! status: ${ce.status}`)}F()}catch(ce){console.error("Error deleting lab test:",ce),l(ce.message||"Failed to delete lab test.")}finally{a(!1)}}},se=()=>{I(!1),L(null),l(null),z({name:"",description:"",price:"",default_parameters:[]})},re=async D=>{if(!D){p("No file selected.");return}f(!0),p(null),l(null);const ce=new FormData;ce.append("file",D);try{const ve=await pe("/api/lab-tests/import",{method:"POST",body:ce});if(!ve.ok){const X=await ve.json();throw new Error(X.message||`Import failed: ${ve.statusText}`)}F()}catch(ve){console.error("Error importing lab tests from Excel:",ve),p(ve.message||"Failed to import lab tests from Excel.")}finally{f(!1)}},oe=async D=>{if(D.target.files&&D.target.files[0]){const ce=D.target.files[0];await re(ce),D.target&&(D.target.value="")}},E=async()=>{if(window.confirm("Are you sure you want to import default biochemistry and pathology tests? This will add new tests and may duplicate existing ones if names match.")){v(!0),k(null),l(null);try{const D=await pe("/api/lab-tests/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"}});if(!D.ok){const ce=await D.json();throw new Error(ce.message||`Default import failed: ${D.statusText}`)}F()}catch(D){console.error("Error importing default lab tests:",D),k(D.message||"Failed to import default lab tests.")}finally{v(!1)}}},le=async()=>{if(window.confirm("Are you sure you want to delete ALL lab tests? This action cannot be undone.")){P(!0),l(null),p(null),k(null);try{const D=await pe("/api/lab-tests/all",{method:"DELETE"});if(!D.ok){const ce=await D.json();throw new Error(ce.message||`Delete all failed: ${D.statusText}`)}F()}catch(D){console.error("Error deleting all lab tests:",D),l(D.message||"Failed to delete all lab tests.")}finally{P(!1)}}},ue=r||d||b||T;return i.jsxs("div",{className:`lab-inventory-card ${e?"embedded":""}`,style:e?{border:"none",boxShadow:"none",padding:0}:{},children:[!e&&i.jsx("h2",{className:"lab-inventory-header",children:"Available Lab Tests"}),i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px"},children:[i.jsx("button",{onClick:te,className:"lab-inventory-button",disabled:ue,children:"Add New Test"}),i.jsx("button",{onClick:()=>{var D;return(D=g.current)==null?void 0:D.click()},className:"lab-inventory-button lab-inventory-button-secondary",disabled:ue,children:d?"Importing...":"Import from Excel"}),i.jsx("input",{type:"file",ref:g,onChange:oe,accept:".xlsx, .xls",style:{display:"none"},disabled:d}),i.jsx("button",{onClick:E,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ue,children:b?"Importing Defaults...":"Import Default Tests"}),i.jsx("button",{onClick:le,className:"lab-inventory-button lab-inventory-button-danger",disabled:ue,style:{backgroundColor:"#dc3545",borderColor:"#dc3545",color:"white"},children:T?"Deleting All...":"Delete All Tests"})]}),o&&i.jsx("div",{className:"error-text mb-4",children:o}),u&&i.jsxs("div",{className:"error-text mb-4",children:["Import Excel Error: ",u]}),S&&i.jsxs("div",{className:"error-text mb-4",children:["Import Default Error: ",S]}),M&&i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"20px",marginBottom:"20px"},children:[" ",i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"1px solid #eee",marginBottom:"15px"},children:"Add New Lab Test"}),i.jsxs("form",{onSubmit:ie,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:$.name,onChange:Y,className:"lab-inventory-input",required:!0,disabled:ue})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:$.description,onChange:Y,rows:3,className:"lab-inventory-input",disabled:ue})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:$.price,onChange:Y,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:ue})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginTop:"20px",marginBottom:"10px"},children:"Default Parameters"}),$.default_parameters.map((D,ce)=>{var ve,X;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:D.name,onChange:fe=>R(ce,"name",fe.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:D.type,onChange:fe=>R(ce,"type",fe.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),D.type==="boolean"?i.jsxs("select",{value:D.defaultValue.toString(),onChange:fe=>R(ce,"defaultValue",fe.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:D.type==="number"?"number":"text",placeholder:"Default Value",value:D.defaultValue.toString(),onChange:fe=>R(ce,"defaultValue",fe.target.value),className:"lab-inventory-input"}),D.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:D.lower_limit===null?"":((ve=D.lower_limit)==null?void 0:ve.toString())??"",onChange:fe=>R(ce,"lower_limit",fe.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:D.upper_limit===null?"":((X=D.upper_limit)==null?void 0:X.toString())??"",onChange:fe=>R(ce,"upper_limit",fe.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:D.unit||"",onChange:fe=>R(ce,"unit",fe.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>G(ce),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},ce)}),i.jsx("button",{type:"button",onClick:B,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:se,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ue,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:ue,children:r?"Saving...":"Add Test"})]})]})]}),ue&&!M&&i.jsxs("p",{className:"loading-text",children:[" ",d?"Importing Excel data...":b?"Importing default data...":"Loading tests..."]}),!ue&&n.length===0&&!o&&!u&&!S&&i.jsx("p",{className:"no-data-message",children:"No lab tests found. Add one or import from Excel to get started."}),!ue&&n.length>0&&i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{className:"hidden md:table-cell",children:"Description"})," ",i.jsx("th",{children:"Price"}),i.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),i.jsx("tbody",{children:n.map(D=>{const ce=U===D.id,ve=D.price&&typeof D.price=="string"?parseFloat(D.price):NaN,X=isNaN(ve)?"0.00":ve.toFixed(2);return i.jsxs(jn.Fragment,{children:[i.jsxs("tr",{onClick:()=>W(D),style:{cursor:"pointer"},children:[i.jsx("td",{children:D.name}),i.jsx("td",{className:"hidden md:table-cell",style:{whiteSpace:"pre-wrap"},children:D.description||"-"}),i.jsxs("td",{children:["",X]}),i.jsx("td",{style:{textAlign:"right"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[i.jsx("button",{onClick:fe=>{fe.stopPropagation(),W(D)},className:"lab-inventory-link",disabled:ue,style:{background:"none",border:"none",padding:"0",cursor:"pointer"},children:"Edit"}),i.jsx("button",{onClick:fe=>{fe.stopPropagation(),V(D.id)},className:"lab-inventory-link",disabled:ue,style:{background:"none",border:"none",padding:"0",cursor:"pointer",color:"#dc3545"},children:"Delete"})]})})]}),ce&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"10px",marginBottom:"10px",border:"1px solid #ddd",padding:"15px"},children:[i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em"},children:"Edit Lab Test"}),i.jsxs("form",{onSubmit:ie,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:$.name,onChange:Y,className:"lab-inventory-input",required:!0,disabled:ue})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:$.description,onChange:Y,rows:3,className:"lab-inventory-input",disabled:ue})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:$.price,onChange:Y,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:ue})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",marginTop:"15px"},children:"Default Parameters"}),$.default_parameters.map((fe,ae)=>{var Me,Ke;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:fe.name,onChange:Z=>R(ae,"name",Z.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:fe.type,onChange:Z=>R(ae,"type",Z.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),fe.type==="boolean"?i.jsxs("select",{value:fe.defaultValue.toString(),onChange:Z=>R(ae,"defaultValue",Z.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:fe.type==="number"?"number":"text",placeholder:"Default Value",value:fe.defaultValue.toString(),onChange:Z=>R(ae,"defaultValue",Z.target.value),className:"lab-inventory-input"}),fe.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:fe.lower_limit===null?"":((Me=fe.lower_limit)==null?void 0:Me.toString())??"",onChange:Z=>R(ae,"lower_limit",Z.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:fe.upper_limit===null?"":((Ke=fe.upper_limit)==null?void 0:Ke.toString())??"",onChange:Z=>R(ae,"upper_limit",Z.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:fe.unit||"",onChange:Z=>R(ae,"unit",Z.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>G(ae),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},ae)}),i.jsx("button",{type:"button",onClick:B,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:se,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ue,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:ue,children:r?"Saving...":"Update Test"})]})]})]})})})]},D.id)})})]})]})]})},w9=e=>{let n="";if(!e.report_content)return"No report content available.";n+=`*Report Date:* ${e.report_date?new Date(e.report_date).toLocaleDateString():"N/A"}

`;try{const t=JSON.parse(e.report_content);typeof t=="object"&&t!==null&&e.tests?e.tests.forEach((r,a)=>{n+=`*Test: ${r.name}*
`,t[r.id]?Object.entries(t[r.id]).forEach(([o,l])=>{var p;const d=(p=r.default_parameters)==null?void 0:p.find(g=>g.name===o);let f=String(l),u="";if(d){const g=d.unit?` _${d.unit}_`:"";if(d.type==="boolean"){const b=l===!0||l==="true";f=b?"*Reactive*":"Non-Reactive",b||(u="`Normal: Non-Reactive`")}else if(d.type==="number"){const b=typeof l=="string"?parseFloat(l):typeof l=="number"?l:NaN;if(d.lower_limit!=null||d.upper_limit!=null){let v=[];d.lower_limit!=null&&v.push(`${d.lower_limit}`),d.upper_limit!=null&&v.push(`${d.upper_limit}`),u=`\`Normal: ${v.join(" - ")}\`${g}`,!isNaN(b)&&(d.lower_limit!=null&&b<d.lower_limit||d.upper_limit!=null&&b>d.upper_limit)&&(f=`*${f}*`)}}d.unit&&(f+=g)}n+=`${o}: ${f}
`,u&&((d==null?void 0:d.type)==="boolean"&&(l===!0||l==="true")||(n+=`${u}
`))}):n+=`_No parameters reported for this test._
`,a<e.tests.length-1&&(n+=`
`)}):n+=e.report_content}catch{n+=e.report_content}return n},_w=e=>{var l;if(!((l=e==null?void 0:e.Patient)!=null&&l.phone)){alert("Cannot share report via WhatsApp: Patient phone number is not available.");return}if(!(e!=null&&e.report_content)){alert("Cannot share report: No report content is available to share.");return}const n=e.Patient.name||"Patient",t=w9(e),r=`Hello ${n},

Your lab report is ready.

${t}`,o=`https://wa.me/${S9(e.Patient.phone)}?text=${encodeURIComponent(r)}`;window.open(o,"_blank")},S9=e=>{let n=e.replace(/\D/g,"");const t=/^(?:\\+?91)?[\\s-]*?(\\d{10})$/,r=n.match(t);return r?n="91"+r[1]:n.startsWith("91")||(n="91"+n),n},N9=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState("orders"),[p,g]=w.useState(1),[b]=w.useState(20),[v,S]=w.useState(0),k=w.useMemo(()=>Math.ceil(v/b),[v,b]),T=w.useCallback(async(F=1,Y="")=>{o(!0),d(null);try{const R=new URLSearchParams({page:String(F),limit:String(b)});Y&&R.append("search",Y);const B=await pe(`/api/lab?${R.toString()}`);if(!B.ok)throw new Error(`HTTP error! status: ${B.status}`);const G=await B.json(),ie=G.orders.map(te=>{var W,V;return{id:te.id,labTokenNumber:String(te.lab_token_number??"N/A"),patientName:((W=te.Patient)==null?void 0:W.name)||"N/A",patientId:te.patient_id,patientTokenNumber:String(((V=te.Patient)==null?void 0:V.patient_token_number)??"N/A"),tests:(te.tests||[]).map(se=>se.name||"Unknown Test"),date:Rd(new Date(te.createdAt),"yyyy-MM-dd"),status:te.status,reportId:te.reportId,billId:te.billId}});n(ie),S(G.totalCount),g(F)}catch(R){console.error("Failed to fetch lab orders:",R),d(R instanceof Error?R.message:"An unknown error occurred"),n([]),S(0)}finally{o(!1)}},[b]);w.useEffect(()=>{console.log(`Fetch effect triggered. Current page: ${p}, Search term: "${t}"`),t.length===0||t.length>=2?(console.log(`Condition met (length ${t.length}). Fetching orders...`),T(p,t)):console.log(`Condition not met (length ${t.length}). Not fetching.`)},[T,p,t]),w.useEffect(()=>{const F=setTimeout(()=>{t.length>=2?p!==1&&g(1):t.length<2&&p!==1&&g(1)},1e3);return()=>{clearTimeout(F)}},[t]);const P=async(F,Y)=>{console.log(`Updating order ${F} to status ${Y}`);try{const R=await pe(`/api/lab/${F}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:Y})});if(!R.ok){const B=await R.json();throw new Error(B.message||`Failed to update status: ${R.status}`)}if(Y==="completed"){const B=await pe(`/api/lab/orders/${F}/report`);if(B.ok){const G=await B.json();_w(G)}}await T(p,t),console.log(`Order ${F} status updated to ${Y}, refetching page ${p}`)}catch(R){console.error("Error updating status:",R),alert(`Failed to update status: ${R instanceof Error?R.message:"Unknown error"}`)}},M=Et(),I=F=>{if(!F){console.error("Cannot navigate to billing: Order data is missing."),alert("Could not open billing page: Order information is missing.");return}F.billId?(console.log(`Navigating to existing bill for Bill ID: ${F.billId}, Patient: ${F.patientName}`),M("/billing",{state:{billId:F.billId,patientId:F.patientId,patientName:F.patientName,billType:"lab"}})):(console.log(`Navigating to LabBillingPage for Order ID: ${F.id}`),M(`/dashboard/lab-billing/${F.id}`))},U=F=>{F&&F.id?M(`/lab/report/${F.id}`):(console.error("Cannot navigate: Order or Order ID is missing."),alert("Could not open the report entry page: Order information is missing."))},L=F=>{switch(F){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:F,className:"status-badge"}}};if(a)return i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsx("div",{className:"text-teal-600 text-xl animate-pulse",children:"Loading Lab Panel..."})});if(l)return i.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-red-50 text-red-700",children:[i.jsx(Er,{size:48,className:"mb-4"}),i.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Error Loading Lab Data"}),i.jsx("p",{className:"mb-4",children:l}),i.jsx("button",{onClick:()=>T(1,""),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry Fetch"})]});const $=()=>{p>1&&g(F=>F-1)},z=()=>{p<k&&g(F=>F+1)};return i.jsxs("div",{className:"lab-inventory-container",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("button",{onClick:()=>M(-1),className:"back-button mr-4",children:i.jsx(nn,{size:24})}),i.jsx("h2",{className:"text-2xl font-semibold",children:"Lab Panel"})]}),i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px",borderBottom:"1px solid #ddd",paddingBottom:"10px"},children:[i.jsxs("button",{onClick:()=>u("orders"),className:`lab-inventory-button ${f==="orders"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[i.jsx(t2,{size:16,style:{marginRight:"8px"}}),"Orders"]}),i.jsx("button",{onClick:()=>M("/create-lab-order"),className:"lab-inventory-button",style:{display:"flex",alignItems:"center"},children:"Create New Lab Order"}),i.jsxs("button",{onClick:()=>u("inventory"),className:`lab-inventory-button ${f==="inventory"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[i.jsx(uI,{size:16,style:{marginRight:"8px"}}),"Inventory"]})]}),f==="orders"&&i.jsxs("div",{className:"lab-orders-view",children:[" ",i.jsxs("div",{className:"lab-orders-header-controls",children:[i.jsx("h3",{className:"lab-orders-title",children:"Current Lab Orders"}),i.jsxs("div",{className:"lab-orders-search-container",children:[i.jsx("input",{type:"text",placeholder:"Search name, token, tests...",value:t,onChange:F=>r(F.target.value),className:"lab-inventory-input lab-orders-search-input"}),i.jsx(ua,{size:18,className:"lab-orders-search-icon"})]})]}),i.jsx("div",{className:"lab-orders-table-container",children:i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient (Token)"}),i.jsx("th",{children:"Tests"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"lab-table-actions-header",children:"Actions"})]})}),i.jsxs("tbody",{children:[a&&!l&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:"Loading orders..."})}),!a&&!l&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."})}),!a&&!l&&e.map(F=>{const Y=L(F.status);return i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{children:F.patientName}),i.jsxs("div",{className:"lab-table-patient-token",children:["Token: ",F.patientTokenNumber]})]}),i.jsx("td",{children:F.tests.map((R,B)=>i.jsx("div",{children:R},B))}),i.jsx("td",{className:"hidden md:table-cell",children:F.date}),i.jsx("td",{children:i.jsx("span",{className:Y.className,children:Y.text})}),i.jsx("td",{children:i.jsxs("div",{className:"lab-table-actions",children:[F.status==="pending"&&i.jsx("button",{onClick:()=>I(F),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),F.status==="billed"&&i.jsx("button",{onClick:()=>P(F.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),F.status==="collected"&&i.jsx("button",{onClick:()=>P(F.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(F.status==="processing"||F.status==="report_ready"||F.status==="reported")&&i.jsx("button",{onClick:()=>U(F),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(F.status==="report_ready"||F.status==="reported")&&i.jsx("button",{onClick:()=>P(F.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(F.status==="completed"||F.status==="report_ready"||F.status==="reported")&&i.jsx("button",{onClick:()=>{F.id?M(`/lab/view-report/${F.id}`):(console.error("Attempted to view report for an order with no ID:",F),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})})]},F.id)})]})]})}),i.jsxs("div",{className:"lab-orders-card-container",children:[a&&!l&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:"Loading orders..."}),!a&&!l&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."}),!a&&!l&&e.map(F=>{const Y=L(F.status);return i.jsxs("div",{className:"lab-order-card",children:[i.jsxs("div",{className:"lab-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"lab-card-patient-name",children:F.patientName}),i.jsxs("div",{className:"lab-card-patient-token",children:["Token: ",F.patientTokenNumber]}),i.jsx("div",{className:"lab-card-date",children:F.date})]}),i.jsx("span",{className:`${Y.className} lab-card-status-pill`,children:Y.text})]}),i.jsxs("div",{className:"lab-card-section",children:[i.jsx("p",{className:"lab-card-section-title",children:"Tests:"}),F.tests.map((R,B)=>i.jsx("div",{className:"lab-card-test-item",children:R},B)),F.tests.length===0&&i.jsx("div",{className:"lab-card-no-tests",children:"No tests listed."})]}),i.jsxs("div",{className:"lab-card-actions",children:[F.status==="pending"&&i.jsx("button",{onClick:()=>I(F),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),F.status==="billed"&&i.jsx("button",{onClick:()=>P(F.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),F.status==="collected"&&i.jsx("button",{onClick:()=>P(F.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(F.status==="processing"||F.status==="report_ready"||F.status==="reported")&&i.jsx("button",{onClick:()=>U(F),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(F.status==="report_ready"||F.status==="reported")&&i.jsx("button",{onClick:()=>P(F.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(F.status==="completed"||F.status==="report_ready"||F.status==="reported")&&i.jsx("button",{onClick:()=>{F.id?M(`/lab/view-report/${F.id}`):(console.error("Attempted to view report for an order with no ID:",F),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})]},F.id)})]}),!a&&v>0&&i.jsxs("div",{className:"lab-pagination-controls",children:[i.jsxs("div",{className:"lab-pagination-info",children:["Showing"," ",i.jsx("strong",{children:(p-1)*b+1})," ","to"," ",i.jsx("strong",{children:Math.min(p*b,v)})," ","of"," ",i.jsx("strong",{children:v})," ","results"]}),i.jsxs("div",{className:"lab-pagination-buttons",children:[i.jsx("button",{onClick:$,disabled:p===1,className:"lab-pagination-button","aria-label":"Previous page",children:i.jsx(aw,{size:18})}),i.jsxs("span",{children:["Page ",p," of ",k]}),i.jsx("button",{onClick:z,disabled:p===k,className:"lab-pagination-button","aria-label":"Next page",children:i.jsx($h,{size:18})})]})]})]}),f==="inventory"&&i.jsxs("div",{className:"lab-inventory-content-wrapper",children:[" ",i.jsx(jw,{})]})]})]})},C9=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,o]=w.useState(!0),[l,d]=w.useState(null),f=Et(),u=w.useRef(null),[p,g]=w.useState(1),[b,v]=w.useState(1),[S,k]=w.useState(0),T=10,P=w.useCallback(async(z,F,Y)=>{o(!0),d(null);try{let R=`/api/pharmacy-orders?page=${z}&limit=${F}`;Y&&Y.trim()!==""&&(R+=`&search=${encodeURIComponent(Y.trim())}`);const B=await pe(R);if(!B.ok)throw new Error(`Failed to fetch orders: ${B.statusText} (${B.status})`);const G=await B.json();if(G&&Array.isArray(G.orders)&&typeof G.totalOrders=="number"&&typeof G.totalPages=="number")console.log("Fetched pharmacy orders data:",G.orders),n(G.orders),k(G.totalOrders),v(G.totalPages),g(G.currentPage||z);else throw console.error("Received data does not match expected paginated structure:",G),new Error("Invalid data format received from API")}catch(R){console.error("Failed to fetch pharmacy orders:",R),d(R.message||"Failed to fetch orders. Please try again."),n([]),v(1),k(0)}finally{o(!1)}},[]);w.useEffect(()=>(u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{const z=t===""?p:1;t!==""&&p!==1&&g(1),P(z,T,t)},500),()=>{u.current&&clearTimeout(u.current)}),[t,p,P,T]);const M=z=>{f(`/dashboard/edit-pharmacy-order/${z}`)},I=z=>{d(null),console.log(`Preparing billing navigation for order: ${z}`);const F=e.find(Y=>Y.id===z);if(F){const Y=F.medications.map(R=>{const B=R.price??0;return(R.price===void 0||R.price===null)&&console.warn(`Medication "${R.name}" in order ${z} is missing a price. Defaulting to 0.`),{name:R.name,pack_quantity:R.pack_quantity,loose_quantity:R.loose_quantity,price:B,pack_price:R.pack_price,loose_price:R.loose_price,total_price:R.total_price,isLoose:R.isLoose,unit:R.unit,drug_id:R.drug_id?String(R.drug_id):null,tabletsPerDay:R.tabletsPerDay,numberOfDays:R.numberOfDays,directions_to_use:R.directions_to_use,discount_percentage:0,batch:R.batch,expiry_date:R.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:Y}),f(`/dashboard/pharmacy-billing/${z}`,{state:{initialItems:Y}})}else console.error(`Order with ID ${z} not found.`),d(`Order with ID ${z} not found.`),alert(`Error: Could not find order ${z} to bill.`)},U=async(z,F)=>{d(null);const Y=e.find(B=>B.id===z);if(!Y){d(`Order with ID ${z} not found.`);return}const R={status:F,medications:Y.medications};try{const B=await pe(`/api/pharmacy-orders/${z}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)});if(!B.ok){const ie=await B.text();throw new Error(`Failed to update status: ${B.statusText} (${B.status}) - ${ie}`)}const G=await B.json();n(ie=>ie.map(te=>te.id===G.id?{...te,status:G.status}:te))}catch(B){console.error("Failed to update order status:",B),d(B.message||`Failed to update status for order ${z}.`),alert(`Error updating status for order ${z}: ${B.message||"Please try again."}`)}},L=z=>{switch(z){case"pending":return"status-pill status-pill-pending";case"billed":return"status-pill status-pill-billed";case"dispensed":return"status-pill status-pill-dispensed";case"cancelled":return"status-pill status-pill-cancelled";default:return"status-pill status-pill-default"}},$=z=>{f(`/dashboard/orders/${z.id}`)};return a&&e.length===0&&!l?i.jsx("div",{className:"loading-pulse",children:"Loading Orders..."}):l&&e.length===0?i.jsxs("div",{className:"error-message-box",children:["Error loading orders: ",l]}):i.jsxs("div",{className:"pharmacy-queue-container",children:[i.jsxs("div",{className:"pharmacy-queue-header",children:[i.jsx("h3",{className:"pharmacy-queue-title",children:"Pharmacy Queue"}),i.jsxs("div",{className:"pharmacy-actions-container",children:[i.jsxs("div",{className:"pharmacy-buttons-group",children:[i.jsxs("button",{onClick:()=>f("/dashboard/add-order"),className:"pharmacy-action-button btn-add-order",children:[i.jsx(us,{size:16}),"Add Order"]}),i.jsxs("button",{onClick:()=>f("/dashboard/inventory"),className:"pharmacy-action-button btn-inventory",title:"View Pharmacy Inventory",children:[i.jsx(Md,{size:16}),"Inventory"]}),i.jsxs("button",{onClick:()=>f("/dashboard/search-patient-records"),className:"pharmacy-action-button btn-ai-search",title:"Search Patient Records with Newton's AI",children:[i.jsx(e2,{size:16}),"Newton's AI"]}),i.jsxs("button",{onClick:()=>f("/dashboard/distributors"),className:"pharmacy-action-button btn-distributors",title:"Manage Distributors",children:[i.jsx(Md,{size:16}),"Distributors"]})]}),i.jsxs("div",{className:"pharmacy-search-input-container",children:[i.jsx("input",{type:"text",placeholder:"Search orders by patient name, token, or medication...",value:t,onChange:z=>r(z.target.value),className:"pharmacy-search-input"}),i.jsx(ua,{size:18,className:"pharmacy-search-icon"})]})]})]}),i.jsxs("div",{className:"pharmacy-orders-scroll-container",children:[l&&e.length>0&&i.jsxs("div",{className:"error-message-box",children:["Error: ",l]}),a&&e.length>0&&i.jsx("div",{className:"loading-pulse",children:"Updating Orders..."}),!a&&e.length===0&&!l&&i.jsx("div",{className:"empty-state-message",children:t?`No pharmacy orders found matching "${t}".`:"There are currently no pharmacy orders."}),e.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"pharmacy-table-container",children:i.jsxs("table",{className:"pharmacy-queue-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Medications"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Order Total"})," ",i.jsx("th",{children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map(z=>i.jsxs("tr",{onClick:()=>$(z),style:{cursor:"pointer"},children:[i.jsxs("td",{children:[i.jsx("div",{className:"patient-name",children:z.patientName}),i.jsx("div",{className:"patient-token",title:`Patient Token: ${z.patientTokenNumber}`,children:z.patientTokenNumber})]}),i.jsxs("td",{className:"medication-info",children:[z.medications.map((F,Y)=>i.jsxs("div",{className:"medication-item",children:[i.jsxs("span",{children:[F.name," (Packs: ",F.pack_quantity,", Loose: ",F.loose_quantity,", ",F.tabletsPerDay??"N/A","x",F.numberOfDays??"N/A","d)",F.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",F.box_number,")"]})]}),F.directions_to_use&&i.jsxs("span",{className:"medication-directions",children:["Directions: ",F.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[F.pack_price!==void 0&&`Pack Price: ${Number(F.pack_price).toFixed(2)}`,F.loose_price!==void 0&&` | Loose Price: ${Number(F.loose_price).toFixed(2)}`,F.total_price!==void 0&&` | Item Total: ${Number(F.total_price).toFixed(2)}`]})]},Y)),z.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",z.prescriptionForUnavailableDrugs]})]}),i.jsx("td",{className:"hidden md:table-cell date-info",children:new Date(z.date).toLocaleDateString()}),i.jsxs("td",{className:"order-total-cell font-semibold",children:["",Number(z.order_total??0).toFixed(2)]}),i.jsx("td",{children:i.jsx("span",{className:L(z.status),children:z.status})}),i.jsx("td",{children:i.jsxs("div",{className:"pharmacy-table-actions",children:[z.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:F=>{F.stopPropagation(),M(z.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx(cu,{size:14})," Edit"]}),i.jsxs("button",{onClick:F=>{F.stopPropagation(),I(z.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx(Eh,{size:14})," Bill"]})]}),z.status==="billed"&&i.jsxs("button",{onClick:F=>{F.stopPropagation(),U(z.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx(fs,{size:14})," Dispense"]}),(z.status==="pending"||z.status==="billed")&&i.jsx("button",{onClick:F=>{F.stopPropagation(),U(z.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:F=>{F.stopPropagation(),$(z)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})})]},z.id))})]})}),i.jsx("div",{className:"pharmacy-card-view-container",children:e.map(z=>{const F=L(z.status);return i.jsxs("div",{className:"pharmacy-order-card",onClick:()=>$(z),children:[i.jsxs("div",{className:"pharmacy-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"pharmacy-card-patient-name",children:z.patientName||"N/A"}),i.jsxs("div",{className:"pharmacy-card-patient-token",title:`Patient Token: ${z.patientTokenNumber}`,children:["Token: ",z.patientTokenNumber||"N/A"]}),i.jsx("div",{className:"pharmacy-card-date",children:new Date(z.date).toLocaleDateString()})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:F,children:z.status}),z.order_total!==void 0&&i.jsxs("span",{className:"pharmacy-card-order-total font-semibold",children:["",Number(z.order_total).toFixed(2)]})]})]}),i.jsxs("div",{className:"pharmacy-card-medications",children:[i.jsx("p",{className:"pharmacy-card-medications-title",children:"Medications:"}),i.jsxs("div",{className:"space-y-0_5",children:[z.medications.slice(0,2).map((Y,R)=>i.jsxs("div",{className:"pharmacy-card-medication-item",children:[i.jsxs("span",{title:`${Y.name} (Packs: ${Y.pack_quantity}, Loose: ${Y.loose_quantity}, ${Y.tabletsPerDay??"N/A"}x${Y.numberOfDays??"N/A"}d)`,children:[Y.name," (Packs: ",Y.pack_quantity,", Loose: ",Y.loose_quantity,", ",Y.tabletsPerDay??"N/A","x",Y.numberOfDays??"N/A","d)",Y.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",Y.box_number,")"]})]}),Y.directions_to_use&&i.jsxs("span",{className:"medication-directions",title:`Directions: ${Y.directions_to_use}`,children:["Directions: ",Y.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[Y.pack_price!==void 0&&`Pack Price: ${Number(Y.pack_price).toFixed(2)}`,Y.loose_price!==void 0&&` | Loose Price: ${Number(Y.loose_price).toFixed(2)}`,Y.total_price!==void 0&&` | Item Total: ${Number(Y.total_price).toFixed(2)}`]})]},R)),z.medications.length>2&&i.jsxs("div",{className:"pharmacy-card-medications-more",children:["...and ",z.medications.length-2," more"]}),z.medications.length===0&&i.jsx("div",{className:"pharmacy-card-no-medications",children:"No medications listed."})]}),z.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",z.prescriptionForUnavailableDrugs]})]}),i.jsxs("div",{className:"pharmacy-card-actions",children:[z.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:Y=>{Y.stopPropagation(),M(z.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx(cu,{size:14})," Edit"]}),i.jsxs("button",{onClick:Y=>{Y.stopPropagation(),I(z.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx(Eh,{size:14})," Bill"]})]}),z.status==="billed"&&i.jsxs("button",{onClick:Y=>{Y.stopPropagation(),U(z.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx(fs,{size:14})," Dispense"]}),(z.status==="pending"||z.status==="billed")&&i.jsx("button",{onClick:Y=>{Y.stopPropagation(),U(z.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:Y=>{Y.stopPropagation(),$(z)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})]},z.id)})})]}),!a&&b>1&&i.jsxs("div",{className:"pharmacy-pagination-container",children:[i.jsxs("div",{className:"pagination-mobile-controls",children:[i.jsx("button",{onClick:()=>g(z=>Math.max(z-1,1)),disabled:p===1,className:"pagination-button prev",children:"Previous"}),i.jsx("button",{onClick:()=>g(z=>Math.min(z+1,b)),disabled:p===b,className:"pagination-button next",children:"Next"})]}),i.jsxs("div",{className:"pagination-desktop-controls",children:[i.jsx("div",{className:"pagination-info",children:i.jsxs("p",{children:["Showing ",i.jsx("span",{className:"font-medium",children:(p-1)*T+1})," ","to ",i.jsx("span",{className:"font-medium",children:Math.min(p*T,S)})," ","of ",i.jsx("span",{className:"font-medium",children:S})," results"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"pagination-nav","aria-label":"Pagination",children:[i.jsxs("button",{onClick:()=>g(z=>Math.max(z-1,1)),disabled:p===1,className:"pagination-nav-button prev",children:[i.jsx("span",{className:"sr-only",children:"Previous"}),i.jsx(aw,{"aria-hidden":"true"})]}),i.jsxs("span",{"aria-current":"page",className:"pagination-current-page",children:["Page ",p," of ",b]}),i.jsxs("button",{onClick:()=>g(z=>Math.min(z+1,b)),disabled:p===b,className:"pagination-nav-button next",children:[i.jsx("span",{className:"sr-only",children:"Next"}),i.jsx($h,{"aria-hidden":"true"})]})]})})]})]})]})," "]})},QC=10,j9=3,iT=({isEmbedded:e=!1})=>{const n=Et(),[t,r]=w.useState([]),[a,o]=w.useState([]),[l,d]=w.useState(""),[f,u]=w.useState(!0),[p,g]=w.useState(null),[b,v]=w.useState(new Set),[S,k]=w.useState("all"),T=async()=>{try{const be=await pe("/api/inventory/download-csv");if(!be.ok)throw new Error(`Failed to download CSV: ${be.statusText}`);const ge=await be.blob(),Te=window.URL.createObjectURL(ge),De=document.createElement("a");De.href=Te,De.download="pharmacy_inventory.csv",document.body.appendChild(De),De.click(),De.remove(),window.URL.revokeObjectURL(Te)}catch(be){console.error("Failed to download CSV:",be),g(be.message||"Failed to download inventory CSV. Please try again.")}},[P,M]=w.useState(!1),[I,U]=w.useState(!1),[L,$]=w.useState(null),[z,F]=w.useState(!1),[Y,R]=w.useState(new Set),[B,G]=w.useState(1),ie=8,[te,W]=w.useState(null),[V,se]=w.useState(0),[re,oe]=w.useState(!1),[E,le]=w.useState(null),[ue,D]=w.useState(1),[ce,ve]=w.useState(!1),X=B*ie,fe=X-ie,ae=a.slice(fe,X),Me=Math.ceil(a.length/ie);w.useEffect(()=>{G(1)},[l,S]);const Ke=w.useCallback(async()=>{u(!0),g(null);try{const be=await pe("/api/drugs");if(!be.ok)throw new Error(`Failed to fetch drugs: ${be.statusText} (${be.status})`);let ge=await be.json();ge=ge.map(Te=>({...Te,price:parseFloat(String(Te.price))||0,buying_price:Te.buying_price!==null&&Te.buying_price!==void 0?parseFloat(String(Te.buying_price)):null,quantity_in_stock:parseInt(String(Te.quantity_in_stock),10)||0,gst:Te.gst!==null&&Te.gst!==void 0?parseFloat(String(Te.gst)):null,margin:Te.margin!==null&&Te.margin!==void 0?parseFloat(String(Te.margin)):null,discount:Te.discount!==null&&Te.discount!==void 0?parseFloat(String(Te.discount)):null})),r(ge),o(ge)}catch(be){console.error("Failed to fetch drugs:",be),g(be.message||"Failed to load inventory. Please try again.")}finally{u(!1)}},[]);w.useEffect(()=>{Ke()},[Ke]),w.useEffect(()=>{const be=l.toLowerCase();let ge=t.filter(ze=>{var Cn,bt,yt,Ot,vt;const nt=((Cn=ze.name)==null?void 0:Cn.toLowerCase())||"",mt=((bt=ze.description)==null?void 0:bt.toLowerCase())||"",Nt=((yt=ze.supplier)==null?void 0:yt.toLowerCase())||"",cn=((Ot=ze.box_number)==null?void 0:Ot.toLowerCase())||"",gn=((vt=ze.brand_name)==null?void 0:vt.toLowerCase())||"";return nt.includes(be)||mt.includes(be)||Nt.includes(be)||cn.includes(be)||gn.includes(be)});const Te=new Date,De=tB(Te,j9);S==="low-stock"?ge=ge.filter(ze=>ze.quantity_in_stock<=QC):S==="near-expiry"?ge=ge.filter(ze=>{if(!ze.expiry_date)return!1;const nt=WC(ze.expiry_date);return C1(nt)&&d0(nt,De)&&!d0(nt,Te)}):S==="expired"&&(ge=ge.filter(ze=>{if(!ze.expiry_date)return!1;const nt=WC(ze.expiry_date);return C1(nt)&&d0(nt,Te)})),o(ge)},[l,t,S]);const Z=()=>{M(!1),W(null)},Ee=be=>{se(parseInt(be.target.value,10)||0)},Ie=async be=>{if(be.preventDefault(),g(null),!te||!te.id||V===0){g("No drug selected or adjustment amount is zero.");return}try{const ge=await pe(`/api/drugs/${te.id}/adjust-stock`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantityChange:V})});if(!ge.ok){const De=await ge.json();throw new Error(De.message||`Failed to adjust stock: ${ge.statusText}`)}const Te=await ge.json();r(De=>De.map(ze=>ze.id===Te.id?Te:ze)),Z(),alert(`Stock for "${Te.name}" adjusted successfully. New stock: ${Te.quantity_in_stock}`)}catch(ge){console.error("Failed to adjust stock:",ge),g(ge.message||"Failed to adjust stock. Please try again.")}},Fe=be=>{$(be),U(!0)},rt=()=>{U(!1),$(null)},lt=async()=>{if(!L||!L.id){g("No drug selected for deletion.");return}u(!0),g(null);try{const be=await pe(`/api/drugs/${L.id}`,{method:"DELETE"});if(!be.ok){const ge=await be.json();throw new Error(ge.message||`Failed to delete drug: ${be.statusText}`)}alert(`Drug "${L.name}" deleted successfully.`),Ke(),rt()}catch(be){console.error("Failed to delete drug:",be),g(be.message||"Failed to delete drug. Please try again.")}finally{u(!1)}},ct=()=>{F(!0)},st=()=>{F(!1)},[Ht,rn]=w.useState(!1),je=()=>{Y.size>0&&rn(!0)},qe=()=>{rn(!1)},Be=async()=>{if(Y.size===0){g("No drugs selected for deletion.");return}u(!0),g(null);try{const be=await pe("/api/drugs/batch-delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({drugIds:Array.from(Y)})});if(!be.ok){const ge=await be.json();throw new Error(ge.message||`Failed to delete selected drugs: ${be.statusText}`)}alert(`${Y.size} drug(s) deleted successfully.`),Ke(),R(new Set),qe()}catch(be){console.error("Failed to delete selected drugs:",be),g(be.message||"Failed to delete selected drugs. Please try again.")}finally{u(!1)}},ke=async()=>{u(!0),g(null);try{const be=await pe("/api/drugs/all",{method:"DELETE"});if(!be.ok){const ge=await be.json();throw new Error(ge.message||`Failed to delete all drugs: ${be.statusText}`)}alert("All drugs deleted successfully."),Ke(),st()}catch(be){console.error("Failed to delete all drugs:",be),g(be.message||"Failed to delete all drugs. Please try again.")}finally{u(!1)}},we=be=>{if(!be)return null;const ge=be.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return ge?parseInt(ge[1],10):null},Q=be=>{le(be),D(1),oe(!0)},me=()=>{oe(!1),le(null),D(1)},Ve=be=>{D(parseInt(be.target.value,10)||0)},Qe=async be=>{if(be.preventDefault(),g(null),!E||!E.id||ue<=0){g("No drug selected or invalid number of packs to convert.");return}const ge=we(E.unit);if(!ge||ge<=0){g(`Cannot convert "${E.name}" to loose. Invalid pack unit: ${E.unit||"N/A"}.`);return}if(ue>(E.quantity_in_stock??0)){g(`Cannot convert ${ue} packs. Only ${E.quantity_in_stock??0} packs are in stock.`);return}try{const Te=await pe(`/api/drugs/${E.id}/convert-to-loose`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({packsToConvert:ue,packSize:ge})});if(!Te.ok){const ze=await Te.json();throw new Error(ze.message||`Failed to convert to loose: ${Te.statusText}`)}const De=await Te.json();r(ze=>ze.map(nt=>nt.id===De.id?De:nt)),me(),alert(`Converted ${ue} pack(s) of "${De.name}" to loose. New stock: ${De.quantity_in_stock} packs, ${De.loose??0} loose units.`)}catch(Te){console.error("Failed to convert to loose:",Te),g(Te.message||"Failed to convert to loose. Please try again.")}finally{u(!1)}},ot=()=>{ve(!0)},kt=()=>{ve(!1)},qt=async()=>{u(!0),g(null);try{const be=await pe("/api/drugs/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!be.ok){const ge=await be.json();throw new Error(ge.message||`Failed to add default medications: ${be.statusText}`)}alert("Default medications added successfully."),Ke(),kt()}catch(be){console.error("Failed to add default medications:",be),g(be.message||"Failed to add default medications. Please try again.")}finally{u(!1)}};return f?i.jsx("div",{className:"loading-indicator",children:"Loading Inventory..."}):p?i.jsxs("div",{className:"error-indicator",children:["Error: ",p]}):i.jsxs("div",{className:`pharmacy-inventory-page ${e?"embedded":""}`,style:e?{minHeight:"auto",padding:"0",background:"transparent"}:{},children:[i.jsx("div",{className:"inventory-header-controls",style:{padding:"20px 20px 0 20px"},children:i.jsxs("div",{className:"inventory-actions-group",children:[i.jsxs("div",{className:"action-group-left",style:{display:"flex",gap:"12px"},children:[i.jsxs("button",{onClick:()=>n("/dashboard/inventory/add"),className:"action-button-outline add-drug-button",children:[i.jsx(us,{size:18}),"Add New Drug"]}),i.jsxs("button",{onClick:()=>n("/dashboard/purchase"),className:"action-button-outline",children:[i.jsx(us,{size:18}),"Purchase Page"]}),i.jsxs("button",{onClick:()=>n("/dashboard/distributors"),className:"action-button-outline",children:[i.jsx(us,{size:18}),"Distributors"]})]}),i.jsxs("div",{className:"action-group-right",style:{display:"flex",gap:"12px"},children:[i.jsx("button",{onClick:T,className:"action-button-outline",children:"Download CSV"}),i.jsxs("button",{onClick:ot,className:"action-button-outline",children:[i.jsx(us,{size:18}),"Import Defaults"]}),i.jsxs("button",{onClick:je,className:"action-button-outline delete-button-outline",disabled:Y.size===0,children:[i.jsx(li,{size:18}),"Delete (",Y.size,")"]}),i.jsxs("button",{onClick:ct,className:"action-button-outline delete-all-button-outline",children:[i.jsx(li,{size:18}),"Delete All"]})]})]})}),i.jsxs("div",{className:"search-bar-container",style:{padding:"0 20px 20px 20px",borderBottom:"1px solid var(--border-color)",marginBottom:"0"},children:[i.jsxs("div",{className:"search-input-wrapper",style:{maxWidth:"600px"},children:[i.jsx(ua,{size:20,className:"search-input-icon"}),i.jsx("input",{type:"text",placeholder:"Search drugs...",value:l,onChange:be=>d(be.target.value),className:"inventory-search-input"})]}),i.jsx("div",{className:"filter-dropdown-wrapper",children:i.jsxs("select",{value:S,onChange:be=>k(be.target.value),className:"inventory-filter-select",children:[i.jsx("option",{value:"all",children:"All Drugs"}),i.jsx("option",{value:"low-stock",children:"Low Stock"}),i.jsx("option",{value:"near-expiry",children:"Near Expiry"}),i.jsx("option",{value:"expired",children:"Expired"})]})})]}),i.jsx("div",{className:"inventory-table-container",children:i.jsxs("table",{className:"inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"checkbox-header",children:i.jsx("input",{type:"checkbox",onChange:be=>{if(be.target.checked){const ge=new Set(a.map(Te=>Te.id));R(ge)}else R(new Set)},checked:Y.size===a.length&&a.length>0,disabled:a.length===0})}),i.jsx("th",{className:"drug-name-header",children:"DRUG NAME"}),i.jsx("th",{className:"brand-name-header",children:"BRAND"}),i.jsx("th",{className:"pack-header",children:"PACK"}),i.jsx("th",{className:"expiry-header",children:"EXPIRY"}),i.jsx("th",{className:"text-stock qty-header",children:"STOCK"}),i.jsx("th",{className:"text-price mrp-header",children:"MRP"}),i.jsx("th",{className:"text-cost rate-header",children:"RATE"}),i.jsx("th",{className:"box-number-header",children:"BOX"}),i.jsx("th",{className:"discount-header",children:"DISC %"}),i.jsx("th",{className:"margin-header",children:"MARGIN"}),i.jsx("th",{className:"actions-cell",children:"ACTIONS"})]})}),i.jsxs("tbody",{children:[a.length===0&&i.jsx("tr",{className:"no-results-message",children:i.jsx("td",{colSpan:12,children:"No drugs found matching your search."})}),ae.map(be=>i.jsxs(jn.Fragment,{children:[i.jsxs("tr",{className:"drug-row",onClick:()=>{const ge=new Set(b);ge.has(be.id)&&be.id!==void 0?ge.delete(be.id):be.id!==void 0&&ge.add(be.id),v(ge)},children:[i.jsx("td",{className:"checkbox-cell",children:i.jsx("input",{type:"checkbox",onClick:ge=>ge.stopPropagation(),checked:Y.has(be.id),onChange:()=>{const ge=new Set(Y);ge.has(be.id)?ge.delete(be.id):ge.add(be.id),R(ge)}})}),i.jsx("td",{className:"drug-name-cell",children:be.name||"-"}),i.jsx("td",{className:"brand-name-cell",children:be.brand_name||"-"}),i.jsx("td",{className:"text-muted pack-cell",children:be.unit||"-"}),i.jsx("td",{className:"text-muted",children:be.expiry_date?new Date(be.expiry_date).toLocaleDateString("en-GB"):"-"}),i.jsxs("td",{className:`text-stock ${be.quantity_in_stock<=QC?"low-stock":""}`,children:[i.jsx("div",{style:{fontWeight:"bold"},children:be.quantity_in_stock}),i.jsx("div",{className:"loose-quantity",children:be.loose!==null&&be.loose!==void 0?`${be.loose} loose`:"0 loose"})]}),i.jsxs("td",{className:"text-muted text-price",children:["",typeof be.price=="number"?be.price.toFixed(2):"N/A"]}),i.jsx("td",{className:"text-muted text-cost",children:be.buying_price!==null&&be.buying_price!==void 0?`${be.buying_price.toFixed(2)}`:"-"}),i.jsx("td",{className:"text-muted",children:be.box_number||"-"}),i.jsx("td",{className:"text-muted",children:be.discount!==null&&be.discount!==void 0?`${be.discount.toFixed(2)}%`:"0.00%"}),i.jsx("td",{className:"text-muted",children:(()=>{const ge=be.price||0,Te=be.buying_price||0,De=be.discount||0,ze=be.gst||0,mt=Te*(1-De/100)*(1+ze/100),Nt=ge-mt;return`${(ge>0?Nt/ge*100:0).toFixed(2)}%`})()}),i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsx("button",{onClick:ge=>{ge.stopPropagation(),n(`/dashboard/inventory/edit/${be.id}`)},className:"action-icon-button",title:"Edit Drug",children:i.jsx(cu,{size:16})}),i.jsx("button",{onClick:ge=>{ge.stopPropagation(),Fe(be)},className:"action-icon-button delete-button",title:"Delete Drug",children:i.jsx(li,{size:16})}),i.jsx("button",{onClick:ge=>{ge.stopPropagation(),W(be),M(!0)},className:"action-icon-button adjust-stock-button",title:"Adjust Stock",children:i.jsx(AI,{size:16})}),i.jsx("button",{onClick:ge=>{ge.stopPropagation(),Q(be)},className:"action-icon-button convert-to-loose-button",title:"Convert to Loose",disabled:!be.unit||we(be.unit)===null,children:i.jsx(hR,{size:16})})]})})]}),b.has(be.id)&&i.jsx("tr",{className:"collapsible-row",children:i.jsx("td",{colSpan:12,children:i.jsxs("div",{className:"collapsible-content",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Description:"})," ",be.description||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Supplier:"})," ",be.supplier||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Batch:"})," ",be.batch||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"HSN Code:"})," ",be.hsn_code||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"MFG:"})," ",be.mfg||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Loose Price:"}),(()=>{const ge=we(be.unit);return ge&&ge>0&&typeof be.price=="number"?`${(be.price/ge).toFixed(2)}`:"N/A"})()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"GST:"})," ",be.gst!==null&&be.gst!==void 0?`${be.gst.toFixed(2)}%`:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Last Updated:"})," ",new Date(be.last_updated).toLocaleString()]})]})})})]},be.id))]})]})}),Me>1&&i.jsxs("div",{className:"pagination-controls",style:{padding:"20px",display:"flex",justifyContent:"center",alignItems:"center",gap:"20px",backgroundColor:"var(--card-bg, #fff)",borderTop:"1px solid var(--border-color)"},children:[i.jsx("button",{onClick:()=>G(be=>Math.max(be-1,1)),disabled:B===1,className:"pagination-button",children:"Previous"}),i.jsxs("span",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:["Page ",B," of ",Me]}),i.jsx("button",{onClick:()=>G(be=>Math.min(be+1,Me)),disabled:B===Me,className:"pagination-button",children:"Next"})]}),I&&L&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:rt,className:"modal-close-button",children:i.jsx(Xn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion"}),i.jsxs("p",{className:"modal-description",children:['Are you sure you want to delete "',i.jsx("span",{className:"drug-name",children:L.name||"Unnamed Drug"}),'"? This action cannot be undone.']}),p&&i.jsx("div",{className:"modal-error-message",children:p}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:rt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:lt,className:"button-delete",children:"Delete"})]})]})}),P&&te&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Z,className:"modal-close-button",children:i.jsx(Xn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Adjust Stock"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:te.name||"Unnamed Drug"}),i.jsx("br",{}),"Current Stock: ",te.quantity_in_stock]}),p&&i.jsx("div",{className:"modal-error-message",children:p}),i.jsxs("form",{onSubmit:Ie,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"adjustment",className:"form-label",children:"Adjustment Amount"}),i.jsx("input",{type:"number",name:"adjustment",id:"adjustment",required:!0,step:"1",value:V,onChange:Ee,placeholder:"e.g., 10 or -5",className:"form-input"}),i.jsx("p",{className:"form-help-text",children:"Enter a positive number to add stock, negative to remove."})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Z,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Adjust Stock"})]})]})]})}),z&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:st,className:"modal-close-button",children:i.jsx(Xn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of All Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:"ALL"})," drugs from the inventory? This action cannot be undone."]}),p&&i.jsx("div",{className:"modal-error-message",children:p}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:st,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:ke,className:"button-delete",children:"Delete All"})]})]})}),Ht&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:qe,className:"modal-close-button",children:i.jsx(Xn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of Selected Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:Y.size})," selected drug(s)? This action cannot be undone."]}),p&&i.jsx("div",{className:"modal-error-message",children:p}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:qe,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Be,className:"button-delete",children:"Delete Selected"})]})]})}),re&&E&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:me,className:"modal-close-button",children:i.jsx(Xn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Convert Pack to Loose"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:E.name||"Unnamed Drug"}),i.jsx("br",{}),"Current Packs in Stock: ",E.quantity_in_stock??0,i.jsx("br",{}),"Current Loose Units: ",E.loose??0,i.jsx("br",{}),"Pack Size: ",we(E.unit)||"N/A"," units per pack"]}),p&&i.jsx("div",{className:"modal-error-message",children:p}),i.jsxs("form",{onSubmit:Qe,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"packs-to-convert",className:"form-label",children:"Number of Packs to Convert"}),i.jsx("input",{type:"number",name:"packs-to-convert",id:"packs-to-convert",required:!0,min:"1",step:"1",value:ue,onChange:Ve,placeholder:"e.g., 1",className:"form-input"}),i.jsxs("p",{className:"form-help-text",children:["This will reduce pack quantity by ",ue," and add ",ue*(we(E.unit)||0)," to loose quantity."]})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:me,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Convert to Loose"})]})]})]})}),ce&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:kt,className:"modal-close-button",children:i.jsx(Xn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Add Default Medications"}),i.jsx("p",{className:"modal-description",children:"Are you sure you want to add default medications to the inventory? This will add a predefined set of common medications."}),p&&i.jsx("div",{className:"modal-error-message",children:p}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:kt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:qt,className:"button-submit",children:"Add Defaults"})]})]})})]})},_9=()=>{const e=Et();return i.jsxs("div",{className:"bg-white p-3 md:p-6 rounded-lg shadow",children:[i.jsx("button",{onClick:()=>e(-1),className:"mb-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Back"}),i.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Settings"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Pharmacy settings will be configured here."})]})},aT=()=>{const{id:e}=Vi(),n=Et(),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),[p,g]=w.useState(!1),b=w.useRef(null),v=w.useRef(null),S=w.useRef(null),k=w.useCallback(async()=>{if(!e){d("Drug ID is missing."),o(!1);return}o(!0),d(null);try{const I=await pe(`/api/drugs/${e}`);if(!I.ok){const L=await I.json();throw new Error(L.message||`Failed to fetch drug: ${I.statusText}`)}let U=await I.json();U={...U,name:U.name||"",brand_name:U.brand_name||"",price:parseFloat(String(U.price))||0,buying_price:U.buying_price!==null&&U.buying_price!==void 0?parseFloat(String(U.buying_price)):null,quantity_in_stock:parseInt(String(U.quantity_in_stock),10)||0,gst:U.gst!==null&&U.gst!==void 0?parseFloat(String(U.gst)):null,margin:U.margin!==null&&U.margin!==void 0?parseFloat(String(U.margin)):null,discount:U.discount!==null&&U.discount!==void 0?parseFloat(String(U.discount)):null,batch:U.batch||"",hsn_code:U.hsn_code||"",mfg:U.mfg||"",loose:U.loose!==null&&U.loose!==void 0?parseInt(String(U.loose),10):null},r(U)}catch(I){console.error("Failed to fetch drug:",I),d(I.message||"Failed to load drug data. Please try again.")}finally{o(!1)}},[e]);w.useEffect(()=>{k()},[k]),w.useEffect(()=>{const I=L=>{L.key==="Tab"&&v.current===document.activeElement&&(p||(g(!0),setTimeout(()=>{var $;($=S.current)==null||$.focus()},0),L.preventDefault()))},U=L=>{b.current&&!b.current.contains(L.target)&&g(!1)};return document.addEventListener("keydown",I),document.addEventListener("mousedown",U),()=>{document.removeEventListener("keydown",I),document.removeEventListener("mousedown",U)}},[p]);const T=I=>{const{name:U,value:L,type:$}=I.target;r(z=>z?{...z,[U]:$==="number"?parseFloat(L)||null:L}:null)},P=()=>{n(-1)},M=async I=>{if(I.preventDefault(),d(null),u(!0),!t||!t.id){d("Cannot edit drug: No drug data available."),u(!1);return}if(t.price===void 0||t.quantity_in_stock===void 0){d("Price and Stock Quantity are required."),u(!1);return}const U={...t,name:t.name===""?null:t.name,brand_name:t.brand_name===""?null:t.brand_name,buying_price:t.buying_price===0?null:t.buying_price,expiry_date:t.expiry_date===""?null:t.expiry_date,gst:t.gst===0?null:t.gst,margin:t.margin===0?null:t.margin,discount:t.discount===0?null:t.discount,batch:t.batch===""?null:t.batch,hsn_code:t.hsn_code===""?null:t.hsn_code,mfg:t.mfg===""?null:t.mfg,loose:t.loose===0?null:t.loose};try{const L=await pe(`/api/drugs/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(U)});if(!L.ok){const z=await L.json();throw new Error(z.message||`Failed to update drug: ${L.statusText}`)}const $=await L.json();alert(`Drug "${$.name}" updated successfully!`),n(-1)}catch(L){console.error("Failed to update drug:",L),d(L.message||"Failed to update drug. Please try again.")}finally{u(!1)}};return a?i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"loading-message",children:"Loading drug data..."})}):l&&!t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"error-message-load",children:["Error: ",l]})}):t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"edit-drug-form-container",children:[i.jsxs("div",{className:"edit-drug-form-header",children:[i.jsxs("h2",{children:["Edit Drug: ",t.name]}),i.jsx("button",{onClick:P,className:"cancel-button",title:"Go Back",children:i.jsx(Xn,{size:24})})]}),l&&i.jsx("div",{className:"error-message-submit",children:l}),i.jsxs("form",{onSubmit:M,className:"edit-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-name",className:"form-label",children:"Composition Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Qo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"edit-name",value:t.name||"",onChange:T,className:"custom-text-input",placeholder:"e.g., Paracetamol",tabIndex:1})," "]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-brand_name",className:"form-label",children:"Brand Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Qo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"edit-brand_name",value:t.brand_name||"",onChange:T,className:"custom-text-input",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-price",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Qo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"price",id:"edit-price",required:!0,step:"0.01",min:"0",value:t.price,onChange:T,className:"custom-text-input",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-quantity_in_stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Qo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"quantity_in_stock",id:"edit-quantity_in_stock",required:!0,step:"1",min:"0",value:t.quantity_in_stock,onChange:T,className:"custom-text-input",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-unit",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"unit",id:"edit-unit",value:t.unit||"",onChange:T,className:"custom-text-input",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"edit-expiry_date",value:t.expiry_date||"",onChange:T,className:"custom-text-input",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"edit-box_number",value:t.box_number||"",onChange:T,className:"custom-text-input",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:b,children:[i.jsx("button",{type:"button",onClick:()=>g(!p),className:"form-button w-full text-left",tabIndex:8,ref:v,children:"Others"}),p&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"edit-description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"edit-description",rows:3,value:t.description||"",onChange:T,className:"custom-text-input",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-supplier",className:"form-label",children:"Supplier"}),i.jsx("input",{type:"text",name:"supplier",id:"edit-supplier",value:t.supplier||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:10})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-buying_price",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"buying_price",id:"edit-buying_price",step:"0.01",min:"0",value:t.buying_price??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:11,ref:S})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"edit-gst",step:"0.01",min:"0",max:"100",value:t.gst??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"edit-margin",step:"0.01",min:"0",max:"100",value:t.margin??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"edit-discount",step:"0.01",min:"0",max:"100",value:t.discount??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"edit-batch",value:t.batch||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"edit-hsn_code",value:t.hsn_code||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"edit-mfg",value:t.mfg||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:17})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-loose",className:"form-label",children:"Loose"}),i.jsx("input",{type:"number",name:"loose",id:"edit-loose",step:"1",min:"0",value:t.loose??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:18})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:P,disabled:f,className:"form-button cancel-form-button",tabIndex:19,children:"Back"}),i.jsx("button",{type:"submit",disabled:f,className:"form-button submit-form-button",tabIndex:20,children:f?"Saving...":"Save Changes"})]})]})]})}):i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"not-found-message",children:"Drug not found."})})},sT=({isOpen:e,onClose:n,onDrugAddedToPurchase:t})=>{const[r,a]=w.useState({name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",expiry_date:"",buying_price:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,p]=w.useState(!1),g=w.useRef(null),b=w.useRef(null),v=w.useRef(null);w.useEffect(()=>{e&&(a({name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",expiry_date:"",buying_price:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),l(null),f(!1),p(!1))},[e]),w.useEffect(()=>{const T=M=>{M.key==="Tab"&&b.current===document.activeElement&&(u||(p(!0),setTimeout(()=>{var I;(I=v.current)==null||I.focus()},0),M.preventDefault()))},P=M=>{g.current&&!g.current.contains(M.target)&&p(!1)};return document.addEventListener("keydown",T),document.addEventListener("mousedown",P),()=>{document.removeEventListener("keydown",T),document.removeEventListener("mousedown",P)}},[u]);const S=T=>{const{name:P,value:M,type:I}=T.target;a(U=>({...U,[P]:I==="number"?parseFloat(M)||null:M}))},k=T=>{if(T.preventDefault(),l(null),f(!0),r.price===void 0||r.quantity_in_stock===void 0){l("MRP and Stock Quantity are required."),f(!1);return}const P={...r,name:r.name===""?null:r.name,composition:r.composition===""?null:r.composition,buying_price:r.buying_price===0?null:r.buying_price,expiry_date:r.expiry_date===""?null:r.expiry_date,gst:r.gst===0?null:r.gst,margin:r.margin===0?null:r.margin,discount:r.discount===0?null:r.discount,brand_name:r.brand_name===""?null:r.brand_name,batch:r.batch===""?null:r.batch,hsn_code:r.hsn_code===""?null:r.hsn_code,mfg:r.mfg===""?null:r.mfg,loose:r.loose===0?null:r.loose};t(P),f(!1),n()};return e?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content add-drug-form-container max-w-2xl mx-auto",children:[i.jsxs("div",{className:"add-drug-form-header",children:[i.jsx("h2",{children:"Add New Drug"}),i.jsx("button",{onClick:n,className:"cancel-button",title:"Close",children:i.jsx(Xn,{size:24})})]}),o&&i.jsx("div",{className:"error-message",children:o}),i.jsxs("form",{onSubmit:k,className:"add-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"name",className:"form-label",children:"Composition Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Qo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"name",value:r.name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Paracetamol",tabIndex:1})]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"brand_name",className:"form-label",children:"Brand Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Qo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"brand_name",value:r.brand_name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"price",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Qo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"price",id:"price",required:!0,step:"0.01",min:"0",value:r.price,onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"quantity_in_stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Qo,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"quantity_in_stock",id:"quantity_in_stock",required:!0,step:"1",min:"0",value:r.quantity_in_stock,onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"unit",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"unit",id:"unit",value:r.unit||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"expiry_date",value:r.expiry_date||"",onChange:S,className:"custom-text-input mt-1",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"box_number",value:r.box_number||"",onChange:S,className:"custom-text-input mt-1",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:g,children:[i.jsx("button",{type:"button",onClick:()=>p(!u),className:"form-button w-full text-left",tabIndex:8,ref:b,children:"Others"}),u&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"description",rows:3,value:r.description||"",onChange:S,className:"custom-text-input mt-1",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"buying_price",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"buying_price",id:"buying_price",step:"0.01",min:"0",value:r.buying_price??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:10,ref:v})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"gst",step:"0.01",min:"0",max:"100",value:r.gst??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:11})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"margin",step:"0.01",min:"0",max:"100",value:r.margin??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"discount",step:"0.01",min:"0",max:"100",value:r.discount??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"batch",value:r.batch||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"hsn_code",value:r.hsn_code||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"mfg",value:r.mfg||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"loose",className:"form-label",children:"Loose Quantity"}),i.jsx("input",{type:"number",name:"loose",id:"loose",step:"1",min:"0",value:r.loose??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:17})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:n,disabled:d,className:"form-button cancel-form-button",tabIndex:18,children:"Cancel"}),i.jsx("button",{type:"submit",disabled:d,className:"form-button submit-form-button inline-flex justify-center",tabIndex:19,children:d?"Adding...":"Add Drug"})]})]})]})}):null},k9=()=>{const e=Et(),n=async t=>{try{const r=await pe("/api/drugs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok){const a=await r.json();throw new Error(a.message||"Failed to add drug")}e(-1)}catch(r){console.error("Error adding drug:",r),alert(`Failed to add drug: ${r.message}`)}};return i.jsx("div",{className:"add-drug-page-wrapper",style:{paddingTop:"2rem"},children:i.jsx(sT,{isOpen:!0,onClose:()=>e(-1),onDrugAddedToPurchase:n})})},j1=()=>{const e=Et(),[n,t]=w.useState({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),[u,p]=w.useState(""),[g,b]=w.useState([]),[v,S]=w.useState(null),[k,T]=w.useState(!1),[P,M]=w.useState([]),[I,U]=w.useState(!0);w.useEffect(()=>{(async()=>{U(!0);try{const B=await pe("/api/staff?role=doctor");if(!B.ok)throw new Error("Failed to fetch doctors");const G=await B.json();M(G),G.length>0&&t(ie=>({...ie,doctorId:""}))}catch(B){console.error("Error fetching doctors:",B),l(`Failed to load doctors: ${B.message}`)}finally{U(!1)}})()},[]);const L=w.useCallback(async()=>{if(u.trim()){T(!0),l(null),b([]);try{const R=encodeURIComponent(u.trim()),B=await pe(`/api/patients?search=${R}&limit=10`);if(!B.ok){const ie=await B.json().catch(()=>({message:"Failed to search patients"}));throw new Error(ie.message||"Failed to search patients")}const G=await B.json();G&&Array.isArray(G.patients)?b(G.patients):(console.error("Unexpected response format from patient search:",G),b([]))}catch(R){console.error("Error searching patients:",R),l(`Search failed: ${R.message}`)}finally{T(!1)}}},[u]);w.useEffect(()=>{if(u.trim().length<2){b([]),l(null);return}const R=setTimeout(()=>{L()},300);return()=>clearTimeout(R)},[u,L]);const $=R=>{S(R),p(""),b([]),l(null),t(B=>({...B,name:"",age:"",gender:"",phone:""}))},z=()=>{S(null),p(""),b([]),l(null),t(R=>({...R,name:"",age:"",gender:"",phone:""}))},F=R=>{const{name:B,value:G}=R.target;t(ie=>({...ie,[B]:G}))},Y=async R=>{var B;R.preventDefault(),l(null),f(null),a(!0);try{let G,ie;if(v)G=v.id,ie=v.name,console.log(`Adding existing patient ${G} to queue.`);else{console.log("Registering new patient...");const se=await pe("/api/patients",{method:"POST",body:JSON.stringify({name:n.name,age:n.age?parseInt(n.age,10):null,gender:n.gender||null,phone:n.phone||null})});if(!se.ok){const oe=await se.json();if(se.status===403&&oe.message.includes("Patient limit")){e("/start-clinic-subscription",{state:{errorMessage:oe.message}});return}throw new Error(oe.message||"Failed to register patient")}const re=await se.json();G=re.id,ie=re.name,console.log(`New patient ${G} registered.`)}const te=n.doctorId||null;console.log(`Adding patient ${G} to queue for doctor ${te||"Unassigned"}`);const W=await pe("/api/queue",{method:"POST",body:JSON.stringify({patientId:G,complaint:n.complaint||null,doctorId:te})});if(!W.ok){const se=await W.json();throw new Error(se.message||"Failed to add patient to queue")}const V=await W.json();if(console.log(`Patient added to queue, entry ID: ${V.id}`),S(null),p(""),b([]),t({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),te){const se=((B=P.find(oe=>oe.id===te))==null?void 0:B.name)||"Selected Doctor",re=v?`Existing patient "${ie}" added to queue for Dr. ${se}. Redirecting to billing...`:`Patient "${ie}" registered and added to queue for Dr. ${se}. Redirecting to billing...`;f(re),e("/billing",{state:{patientId:G,queueId:V.id,patientName:ie,doctorId:te,billType:"consultation"}})}else{const se=v?`Existing patient "${ie}" added to the general queue.`:`Patient "${ie}" registered and added to the general queue.`;f(se)}}catch(G){console.error("Error in add/queue process:",G),G.message.includes("Patient limit")?(l(`Operation failed: ${G.message}. Please upgrade your plan.`),e("/start-clinic-subscription")):l(`Operation failed: ${G.message}`)}finally{a(!1)}};return i.jsxs("div",{className:"add-patient-page-container flex flex-col items-center justify-start",children:[i.jsxs("div",{className:"w-full max-w-3xl mb-2 flex justify-start",children:[" ",i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Back to Previous Page",children:[i.jsx(nn,{size:20,className:"btn-icon"})," Back"]})]}),i.jsxs("div",{className:"add-patient-card",children:[i.jsxs("h3",{className:"add-patient-title",children:[i.jsx(c2,{size:28})," ",v?"Add Existing Patient to Queue":"Register New Patient & Add to Queue"]}),i.jsxs("div",{className:"search-section",children:[i.jsx("legend",{className:"form-fieldset legend",children:"Find Existing Patient"})," ",i.jsxs("div",{className:"flex items-center space-x-2",children:[" ",i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by Name or Phone...",value:u,onChange:R=>p(R.target.value),className:"form-input",disabled:r||!!v}),i.jsx(ua,{size:18,className:`${k?"text-primary animate-pulse":""}`})," "]}),v&&i.jsxs("button",{type:"button",onClick:z,className:"btn btn-danger",title:"Clear Selection",children:[i.jsx(Xn,{size:16,className:"btn-icon"})," Clear"]})]}),g.length>0&&!v&&i.jsx("ul",{className:"search-results-list",children:g.map(R=>i.jsxs("li",{onClick:()=>$(R),children:[R.name," (ID: ",R.id,", Phone: ",R.phone||"N/A",")"]},R.id))}),u.length>=2&&g.length===0&&!k&&!v&&i.jsxs("p",{className:"search-info-text",children:['No patients found matching "',u,'". You can register them below.']}),k&&u.length>=2&&i.jsx("p",{className:"search-info-text searching",children:"Searching..."})]}),o&&i.jsxs("div",{className:"alert alert-danger",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:o})]}),d&&i.jsxs("div",{className:"alert alert-success",role:"alert",children:[i.jsx("strong",{children:"Success: "}),i.jsx("span",{children:d})]}),i.jsxs("form",{onSubmit:Y,className:"space-y-5",children:[" ",i.jsxs("fieldset",{className:`form-fieldset ${v?"fieldset-disabled":""}`,children:[i.jsx("legend",{children:v?`Selected Patient: ${v.name}`:"New Patient Details"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Full Name *"}),i.jsx("input",{type:"text",name:"name",value:v?v.name:n.name,onChange:F,className:"form-input",required:!v,disabled:r||!!v})]}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Age"}),i.jsx("input",{type:"number",name:"age",value:v?v.age??"":n.age,onChange:F,className:"form-input",min:"0",disabled:r||!!v})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Gender"}),i.jsxs("select",{name:"gender",value:v?v.gender??"":n.gender,onChange:F,className:"form-select",disabled:r||!!v,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Phone"}),i.jsx("input",{type:"tel",name:"phone",value:v?v.phone??"":n.phone,onChange:F,className:"form-input",disabled:r||!!v})]})]})]}),i.jsxs("fieldset",{className:"form-fieldset",children:[i.jsx("legend",{children:"Visit Details"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Assign Doctor (Optional)"}),i.jsxs("select",{name:"doctorId",value:n.doctorId,onChange:F,className:`form-select ${I?"opacity-50":""}`,disabled:r||I,children:[i.jsx("option",{value:"",children:I?"Loading doctors...":P.length===0?"No doctors available":"-- No Doctor (Add to General Queue) --"}),P.map(R=>i.jsx("option",{value:R.id,children:R.name},R.id))]}),P.length===0&&!I&&i.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Please add doctors via the Admin Panel."})]}),i.jsxs("div",{className:"form-grid-col-span-2",children:[" ",i.jsx("label",{className:"form-label",children:"Patient Data / Reason"}),i.jsx("textarea",{name:"complaint",value:n.complaint,onChange:F,rows:2,className:"form-textarea",disabled:r})]})]})]}),i.jsxs("div",{className:"flex justify-end pt-2",children:[" ",i.jsxs("button",{type:"submit",className:`btn btn-primary ${r||I?"disabled":""}`,disabled:r||I,children:[i.jsx(ow,{size:18,className:"btn-icon"}),r?"Processing...":v?"Add Existing to Queue":"Register & Add to Queue"]})]})]})]})]})},T9=({clinicId:e})=>{const n=Et(),[t,r]=w.useState({name:"",email:"",role:"receptionist",password:"",opd_fee:""}),[a,o]=w.useState(null),[l,d]=w.useState(!1);w.useEffect(()=>{o(e?null:"Clinic information is missing. Cannot add staff. Please ensure you are logged in correctly.")},[e]);const f=g=>{const{name:b,value:v}=g.target;r(S=>{const k={...S,[b]:v};return b==="role"&&v!=="doctor"&&(k.opd_fee=""),k})},u=async g=>{if(g.preventDefault(),o(null),!t.name||!t.email||!t.role||!t.password){o("Name, Email, Role, and Password are required.");return}if(!e){o("Clinic information is missing. Cannot add staff.");return}const b={...t,clinic_id:e,opd_fee:t.role==="doctor"&&t.opd_fee?parseFloat(String(t.opd_fee)):null};if(b.role==="doctor"&&t.opd_fee&&isNaN(b.opd_fee)){o("Invalid OPD Fee format. Please enter a number.");return}d(!0);try{const v=await pe("/api/staff",{method:"POST",body:JSON.stringify(b)});if(!v.ok){const S=await v.json();throw new Error(S.message||"Server responded with an error")}n(-1)}catch(v){o(`Failed to add staff: ${v.message}`)}finally{d(!1)}},p=()=>{n(-1)};return i.jsxs("div",{className:"staff-page-container",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("button",{onClick:p,className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[i.jsx(nn,{size:18,className:"mr-2"}),"Back"]}),i.jsx("h1",{children:"Add New Staff Member"}),i.jsx("div",{className:"w-16"})," "]}),a&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[i.jsx(Er,{size:18,className:"mr-2 text-red-500"}),a]}),i.jsxs("form",{onSubmit:u,className:`staff-form ${e?"":"opacity-50 pointer-events-none"}`,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Full Name"}),i.jsx("input",{id:"name",type:"text",name:"name",value:t.name||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Enter full name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email Address"}),i.jsx("input",{id:"email",type:"email",name:"email",value:t.email||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Enter email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"role",children:"Assign Role"}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:f,required:!0,disabled:l||!e,children:[i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"}),i.jsx("option",{value:"lab",children:"Lab Technician"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"Set Initial Password"}),i.jsx("input",{id:"password",type:"password",name:"password",value:t.password||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Create a password"})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"opd_fee",children:"OPD Consultation Fee () (Optional)"}),i.jsx("input",{id:"opd_fee",type:"number",name:"opd_fee",value:t.opd_fee||"",onChange:f,step:"0.01",min:"0",placeholder:"e.g., 150.00",disabled:l||!e}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank if no specific fee is set for this doctor."})]}),i.jsxs("button",{type:"submit",disabled:l||!e,children:[l?i.jsx(Ah,{size:18,className:"animate-spin mr-2"}):i.jsx(Ql,{size:18,className:"mr-2"}),l?"Adding...":"Add Staff Member"]})]})]})},E9=()=>{const{id:e}=Vi(),n=Et(),[t,r]=w.useState({name:"",email:"",role:"receptionist",opd_fee:"",active:!0}),[a,o]=w.useState(""),[l,d]=w.useState(!0),[f,u]=w.useState(!1),[p,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Staff ID is missing."),d(!1);return}d(!0),g(null),v(null);try{const M=await pe(`/staff/${e}`);if(!M.ok){const U=await M.json();throw new Error(U.message||`HTTP error! status: ${M.status}`)}const I=await M.json();r({name:I.name,email:I.email,role:I.role,opd_fee:I.opd_fee??"",active:I.active})}catch(M){g(`Failed to load staff details: ${M.message}`)}finally{d(!1)}},[e]);w.useEffect(()=>{S()},[S]);const k=M=>{const{name:I,value:U,type:L}=M.target;if(L==="checkbox"){const{checked:$}=M.target;r(z=>({...z,[I]:$}))}else r($=>({...$,[I]:U}))},T=M=>{o(M.target.value)},P=async M=>{if(M.preventDefault(),!e){g("Staff ID is missing.");return}u(!0),g(null),v(null);const I={name:t.name,email:t.email,role:t.role,active:t.active};if(t.role==="doctor"){const U=t.opd_fee?parseFloat(String(t.opd_fee)):null;if(U!==null&&isNaN(U)){g("OPD Fee must be a valid number."),u(!1);return}I.opd_fee=U}else I.opd_fee=null;a.trim()!==""&&(I.password=a.trim());try{const U=await pe(`/staff/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)});if(!U.ok){const L=await U.json();throw new Error(L.message||`HTTP error! status: ${U.status}`)}v("Staff details updated successfully!"),o(""),setTimeout(()=>n(-1),1500)}catch(U){g(`Failed to update staff: ${U.message}`)}finally{u(!1)}};return l?i.jsxs("div",{className:"flex justify-center items-center h-screen",children:[i.jsx(Ah,{className:"h-12 w-12 animate-spin text-teal-600"}),i.jsx("span",{className:"ml-4 text-xl text-gray-700",children:"Loading Staff Details..."})]}):i.jsxs("div",{className:"staff-page-container",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[i.jsx(nn,{size:18,className:"mr-2"}),"Back"]}),i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Edit Staff Member"}),i.jsx("div",{className:"w-16"})," "]}),p&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[i.jsx(Er,{size:18,className:"mr-2 text-red-500"}),p,i.jsx("button",{onClick:()=>g(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),b&&i.jsxs("div",{className:"success-message mb-4 p-3 bg-green-100 border border-green-400 rounded-md flex items-center",children:[i.jsx(fs,{size:18,className:"mr-2 text-green-500"}),b,i.jsx("button",{onClick:()=>v(null),className:"ml-auto text-green-600 hover:text-green-800 text-xl font-bold",children:""})]}),i.jsxs("form",{onSubmit:P,className:"staff-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Full Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:t.name||"",onChange:k,required:!0,placeholder:"Enter full name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"email",children:["Email Address ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"email",id:"email",name:"email",value:t.email||"",onChange:k,required:!0,placeholder:"Enter email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"role",children:["Role ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:k,required:!0,children:[i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"lab",children:"Lab Technician"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"})]})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"opd_fee",children:"OPD Fee ()"}),i.jsx("input",{type:"number",id:"opd_fee",name:"opd_fee",value:t.opd_fee||"",onChange:k,min:"0",step:"0.01",placeholder:"Enter OPD consultation fee (optional)"})]}),i.jsxs("div",{className:"form-group checkbox-group",children:[i.jsx("input",{id:"active",name:"active",type:"checkbox",checked:t.active??!0,onChange:k}),i.jsxs("label",{htmlFor:"active",className:"mb-0",children:[" ","Account Active"]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"New Password (optional)"}),i.jsx("input",{type:"password",id:"password",name:"password",value:a,onChange:T,placeholder:"Leave blank to keep current password",autoComplete:"new-password"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter a new password only if you want to change it. Minimum 6 characters."})]}),i.jsx("button",{type:"submit",disabled:f,children:f?i.jsxs(i.Fragment,{children:[i.jsx(Ah,{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Od,{size:16,className:"mr-2"}),"Save Changes"]})})]})]})};function A9(e,n){const t={};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const P9=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,D9=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,I9={};function JC(e,n){return(I9.jsx?D9:P9).test(e)}const R9=/[ \t\n\f\r]/g;function M9(e){return typeof e=="object"?e.type==="text"?KC(e.value):!1:KC(e)}function KC(e){return e.replace(R9,"")===""}let cg=class{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}};cg.prototype.normal={};cg.prototype.property={};cg.prototype.space=void 0;function oT(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new cg(t,r,n)}function _1(e){return e.toLowerCase()}let pa=class{constructor(n,t){this.attribute=t,this.property=n}};pa.prototype.attribute="";pa.prototype.booleanish=!1;pa.prototype.boolean=!1;pa.prototype.commaOrSpaceSeparated=!1;pa.prototype.commaSeparated=!1;pa.prototype.defined=!1;pa.prototype.mustUseProperty=!1;pa.prototype.number=!1;pa.prototype.overloadedBoolean=!1;pa.prototype.property="";pa.prototype.spaceSeparated=!1;pa.prototype.space=void 0;let O9=0;const Wt=Bd(),Mr=Bd(),lT=Bd(),it=Bd(),ir=Bd(),jh=Bd(),Pa=Bd();function Bd(){return 2**++O9}const k1=Object.freeze(Object.defineProperty({__proto__:null,boolean:Wt,booleanish:Mr,commaOrSpaceSeparated:Pa,commaSeparated:jh,number:it,overloadedBoolean:lT,spaceSeparated:ir},Symbol.toStringTag,{value:"Module"})),h0=Object.keys(k1);let kw=class extends pa{constructor(n,t,r,a){let o=-1;if(super(n,t),XC(this,"space",a),typeof r=="number")for(;++o<h0.length;){const l=h0[o];XC(this,h0[o],(r&k1[l])===k1[l])}}};kw.prototype.defined=!0;function XC(e,n,t){t&&(e[n]=t)}function Hh(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const o=new kw(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(o.mustUseProperty=!0),n[r]=o,t[_1(r)]=r,t[_1(o.attribute)]=r}return new cg(n,t,e.space)}const cT=Hh({properties:{ariaActiveDescendant:null,ariaAtomic:Mr,ariaAutoComplete:null,ariaBusy:Mr,ariaChecked:Mr,ariaColCount:it,ariaColIndex:it,ariaColSpan:it,ariaControls:ir,ariaCurrent:null,ariaDescribedBy:ir,ariaDetails:null,ariaDisabled:Mr,ariaDropEffect:ir,ariaErrorMessage:null,ariaExpanded:Mr,ariaFlowTo:ir,ariaGrabbed:Mr,ariaHasPopup:null,ariaHidden:Mr,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:ir,ariaLevel:it,ariaLive:null,ariaModal:Mr,ariaMultiLine:Mr,ariaMultiSelectable:Mr,ariaOrientation:null,ariaOwns:ir,ariaPlaceholder:null,ariaPosInSet:it,ariaPressed:Mr,ariaReadOnly:Mr,ariaRelevant:null,ariaRequired:Mr,ariaRoleDescription:ir,ariaRowCount:it,ariaRowIndex:it,ariaRowSpan:it,ariaSelected:Mr,ariaSetSize:it,ariaSort:null,ariaValueMax:it,ariaValueMin:it,ariaValueNow:it,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function uT(e,n){return n in e?e[n]:n}function dT(e,n){return uT(e,n.toLowerCase())}const L9=Hh({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:jh,acceptCharset:ir,accessKey:ir,action:null,allow:null,allowFullScreen:Wt,allowPaymentRequest:Wt,allowUserMedia:Wt,alt:null,as:null,async:Wt,autoCapitalize:null,autoComplete:ir,autoFocus:Wt,autoPlay:Wt,blocking:ir,capture:null,charSet:null,checked:Wt,cite:null,className:ir,cols:it,colSpan:null,content:null,contentEditable:Mr,controls:Wt,controlsList:ir,coords:it|jh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Wt,defer:Wt,dir:null,dirName:null,disabled:Wt,download:lT,draggable:Mr,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Wt,formTarget:null,headers:ir,height:it,hidden:Wt,high:it,href:null,hrefLang:null,htmlFor:ir,httpEquiv:ir,id:null,imageSizes:null,imageSrcSet:null,inert:Wt,inputMode:null,integrity:null,is:null,isMap:Wt,itemId:null,itemProp:ir,itemRef:ir,itemScope:Wt,itemType:ir,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Wt,low:it,manifest:null,max:null,maxLength:it,media:null,method:null,min:null,minLength:it,multiple:Wt,muted:Wt,name:null,nonce:null,noModule:Wt,noValidate:Wt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Wt,optimum:it,pattern:null,ping:ir,placeholder:null,playsInline:Wt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Wt,referrerPolicy:null,rel:ir,required:Wt,reversed:Wt,rows:it,rowSpan:it,sandbox:ir,scope:null,scoped:Wt,seamless:Wt,selected:Wt,shadowRootClonable:Wt,shadowRootDelegatesFocus:Wt,shadowRootMode:null,shape:null,size:it,sizes:null,slot:null,span:it,spellCheck:Mr,src:null,srcDoc:null,srcLang:null,srcSet:null,start:it,step:null,style:null,tabIndex:it,target:null,title:null,translate:null,type:null,typeMustMatch:Wt,useMap:null,value:Mr,width:it,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:ir,axis:null,background:null,bgColor:null,border:it,borderColor:null,bottomMargin:it,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Wt,declare:Wt,event:null,face:null,frame:null,frameBorder:null,hSpace:it,leftMargin:it,link:null,longDesc:null,lowSrc:null,marginHeight:it,marginWidth:it,noResize:Wt,noHref:Wt,noShade:Wt,noWrap:Wt,object:null,profile:null,prompt:null,rev:null,rightMargin:it,rules:null,scheme:null,scrolling:Mr,standby:null,summary:null,text:null,topMargin:it,valueType:null,version:null,vAlign:null,vLink:null,vSpace:it,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Wt,disableRemotePlayback:Wt,prefix:null,property:null,results:it,security:null,unselectable:null},space:"html",transform:dT}),F9=Hh({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Pa,accentHeight:it,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:it,amplitude:it,arabicForm:null,ascent:it,attributeName:null,attributeType:null,azimuth:it,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:it,by:null,calcMode:null,capHeight:it,className:ir,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:it,diffuseConstant:it,direction:null,display:null,dur:null,divisor:it,dominantBaseline:null,download:Wt,dx:null,dy:null,edgeMode:null,editable:null,elevation:it,enableBackground:null,end:null,event:null,exponent:it,externalResourcesRequired:null,fill:null,fillOpacity:it,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:jh,g2:jh,glyphName:jh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:it,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:it,horizOriginX:it,horizOriginY:it,id:null,ideographic:it,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:it,k:it,k1:it,k2:it,k3:it,k4:it,kernelMatrix:Pa,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:it,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:it,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:it,overlineThickness:it,paintOrder:null,panose1:null,path:null,pathLength:it,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:ir,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:it,pointsAtY:it,pointsAtZ:it,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Pa,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Pa,rev:Pa,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Pa,requiredFeatures:Pa,requiredFonts:Pa,requiredFormats:Pa,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:it,specularExponent:it,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:it,strikethroughThickness:it,string:null,stroke:null,strokeDashArray:Pa,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:it,strokeOpacity:it,strokeWidth:null,style:null,surfaceScale:it,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Pa,tabIndex:it,tableValues:null,target:null,targetX:it,targetY:it,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Pa,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:it,underlineThickness:it,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:it,values:null,vAlphabetic:it,vMathematical:it,vectorEffect:null,vHanging:it,vIdeographic:it,version:null,vertAdvY:it,vertOriginX:it,vertOriginY:it,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:it,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:uT}),fT=Hh({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),hT=Hh({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:dT}),pT=Hh({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),$9={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},z9=/[A-Z]/g,ZC=/-[a-z]/g,U9=/^data[-\w.:]+$/i;function B9(e,n){const t=_1(n);let r=n,a=pa;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&U9.test(n)){if(n.charAt(4)==="-"){const o=n.slice(5).replace(ZC,V9);r="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=n.slice(4);if(!ZC.test(o)){let l=o.replace(z9,q9);l.charAt(0)!=="-"&&(l="-"+l),n="data"+l}}a=kw}return new a(r,n)}function q9(e){return"-"+e.toLowerCase()}function V9(e){return e.charAt(1).toUpperCase()}const H9=oT([cT,L9,fT,hT,pT],"html"),Tw=oT([cT,F9,fT,hT,pT],"svg");function G9(e){return e.join(" ").trim()}var mh={},p0,ej;function Y9(){if(ej)return p0;ej=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=/\n/g,t=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,a=/^:\s*/,o=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,l=/^[;\s]*/,d=/^\s+|\s+$/g,f=`
`,u="/",p="*",g="",b="comment",v="declaration";p0=function(k,T){if(typeof k!="string")throw new TypeError("First argument must be a string");if(!k)return[];T=T||{};var P=1,M=1;function I(ie){var te=ie.match(n);te&&(P+=te.length);var W=ie.lastIndexOf(f);M=~W?ie.length-W:M+ie.length}function U(){var ie={line:P,column:M};return function(te){return te.position=new L(ie),F(),te}}function L(ie){this.start=ie,this.end={line:P,column:M},this.source=T.source}L.prototype.content=k;function $(ie){var te=new Error(T.source+":"+P+":"+M+": "+ie);if(te.reason=ie,te.filename=T.source,te.line=P,te.column=M,te.source=k,!T.silent)throw te}function z(ie){var te=ie.exec(k);if(te){var W=te[0];return I(W),k=k.slice(W.length),te}}function F(){z(t)}function Y(ie){var te;for(ie=ie||[];te=R();)te!==!1&&ie.push(te);return ie}function R(){var ie=U();if(!(u!=k.charAt(0)||p!=k.charAt(1))){for(var te=2;g!=k.charAt(te)&&(p!=k.charAt(te)||u!=k.charAt(te+1));)++te;if(te+=2,g===k.charAt(te-1))return $("End of comment missing");var W=k.slice(2,te-2);return M+=2,I(W),k=k.slice(te),M+=2,ie({type:b,comment:W})}}function B(){var ie=U(),te=z(r);if(te){if(R(),!z(a))return $("property missing ':'");var W=z(o),V=ie({type:v,property:S(te[0].replace(e,g)),value:W?S(W[0].replace(e,g)):g});return z(l),V}}function G(){var ie=[];Y(ie);for(var te;te=B();)te!==!1&&(ie.push(te),Y(ie));return ie}return F(),G()};function S(k){return k?k.replace(d,g):g}return p0}var tj;function W9(){if(tj)return mh;tj=1;var e=mh&&mh.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(mh,"__esModule",{value:!0}),mh.default=t;var n=e(Y9());function t(r,a){var o=null;if(!r||typeof r!="string")return o;var l=(0,n.default)(r),d=typeof a=="function";return l.forEach(function(f){if(f.type==="declaration"){var u=f.property,p=f.value;d?a(u,p,f):p&&(o=o||{},o[u]=p)}}),o}return mh}var Pm={},nj;function Q9(){if(nj)return Pm;nj=1,Object.defineProperty(Pm,"__esModule",{value:!0}),Pm.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,n=/-([a-z])/g,t=/^[^-]+$/,r=/^-(webkit|moz|ms|o|khtml)-/,a=/^-(ms)-/,o=function(u){return!u||t.test(u)||e.test(u)},l=function(u,p){return p.toUpperCase()},d=function(u,p){return"".concat(p,"-")},f=function(u,p){return p===void 0&&(p={}),o(u)?u:(u=u.toLowerCase(),p.reactCompat?u=u.replace(a,d):u=u.replace(r,d),u.replace(n,l))};return Pm.camelCase=f,Pm}var Dm,rj;function J9(){if(rj)return Dm;rj=1;var e=Dm&&Dm.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},n=e(W9()),t=Q9();function r(a,o){var l={};return!a||typeof a!="string"||(0,n.default)(a,function(d,f){d&&f&&(l[(0,t.camelCase)(d,o)]=f)}),l}return r.default=r,Dm=r,Dm}var K9=J9();const X9=Ud(K9),mT=gT("end"),Ew=gT("start");function gT(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function Z9(e){const n=Ew(e),t=mT(e);if(n&&t)return{start:n,end:t}}function zm(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?ij(e.position):"start"in e||"end"in e?ij(e):"line"in e||"column"in e?T1(e):""}function T1(e){return aj(e&&e.line)+":"+aj(e&&e.column)}function ij(e){return T1(e&&e.start)+"-"+T1(e&&e.end)}function aj(e){return e&&typeof e=="number"?e:1}let ki=class extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",o={},l=!1;if(t&&("line"in t&&"column"in t?o={place:t}:"start"in t&&"end"in t?o={place:t}:"type"in t?o={ancestors:[t],place:t.position}:o={...t}),typeof n=="string"?a=n:!o.cause&&n&&(l=!0,a=n.message,o.cause=n),!o.ruleId&&!o.source&&typeof r=="string"){const f=r.indexOf(":");f===-1?o.ruleId=r:(o.source=r.slice(0,f),o.ruleId=r.slice(f+1))}if(!o.place&&o.ancestors&&o.ancestors){const f=o.ancestors[o.ancestors.length-1];f&&(o.place=f.position)}const d=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=d?d.column:void 0,this.fatal=void 0,this.file,this.message=a,this.line=d?d.line:void 0,this.name=zm(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=l&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual,this.expected,this.note,this.url}};ki.prototype.file="";ki.prototype.name="";ki.prototype.reason="";ki.prototype.message="";ki.prototype.stack="";ki.prototype.column=void 0;ki.prototype.line=void 0;ki.prototype.ancestors=void 0;ki.prototype.cause=void 0;ki.prototype.fatal=void 0;ki.prototype.place=void 0;ki.prototype.ruleId=void 0;ki.prototype.source=void 0;const Aw={}.hasOwnProperty,eq=new Map,tq=/[A-Z]/g,nq=new Set(["table","tbody","thead","tfoot","tr"]),rq=new Set(["td","th"]),yT="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function iq(e,n){if(!n||n.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=n.filePath||void 0;let r;if(n.development){if(typeof n.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=fq(t,n.jsxDEV)}else{if(typeof n.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof n.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=dq(t,n.jsx,n.jsxs)}const a={Fragment:n.Fragment,ancestors:[],components:n.components||{},create:r,elementAttributeNameCase:n.elementAttributeNameCase||"react",evaluater:n.createEvaluater?n.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:n.ignoreInvalidStyle||!1,passKeys:n.passKeys!==!1,passNode:n.passNode||!1,schema:n.space==="svg"?Tw:H9,stylePropertyNameCase:n.stylePropertyNameCase||"dom",tableCellAlignToStyle:n.tableCellAlignToStyle!==!1},o=xT(a,e,void 0);return o&&typeof o!="string"?o:a.create(e,a.Fragment,{children:o||void 0},void 0)}function xT(e,n,t){if(n.type==="element")return aq(e,n,t);if(n.type==="mdxFlowExpression"||n.type==="mdxTextExpression")return sq(e,n);if(n.type==="mdxJsxFlowElement"||n.type==="mdxJsxTextElement")return lq(e,n,t);if(n.type==="mdxjsEsm")return oq(e,n);if(n.type==="root")return cq(e,n,t);if(n.type==="text")return uq(e,n)}function aq(e,n,t){const r=e.schema;let a=r;n.tagName.toLowerCase()==="svg"&&r.space==="html"&&(a=Tw,e.schema=a),e.ancestors.push(n);const o=vT(e,n.tagName,!1),l=hq(e,n);let d=Dw(e,n);return nq.has(n.tagName)&&(d=d.filter(function(f){return typeof f=="string"?!M9(f):!0})),bT(e,l,o,n),Pw(l,d),e.ancestors.pop(),e.schema=r,e.create(n,o,l,t)}function sq(e,n){if(n.data&&n.data.estree&&e.evaluater){const r=n.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}Zm(e,n.position)}function oq(e,n){if(n.data&&n.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(n.data.estree);Zm(e,n.position)}function lq(e,n,t){const r=e.schema;let a=r;n.name==="svg"&&r.space==="html"&&(a=Tw,e.schema=a),e.ancestors.push(n);const o=n.name===null?e.Fragment:vT(e,n.name,!0),l=pq(e,n),d=Dw(e,n);return bT(e,l,o,n),Pw(l,d),e.ancestors.pop(),e.schema=r,e.create(n,o,l,t)}function cq(e,n,t){const r={};return Pw(r,Dw(e,n)),e.create(n,e.Fragment,r,t)}function uq(e,n){return n.value}function bT(e,n,t,r){typeof t!="string"&&t!==e.Fragment&&e.passNode&&(n.node=r)}function Pw(e,n){if(n.length>0){const t=n.length>1?n:n[0];t&&(e.children=t)}}function dq(e,n,t){return r;function r(a,o,l,d){const u=Array.isArray(l.children)?t:n;return d?u(o,l,d):u(o,l)}}function fq(e,n){return t;function t(r,a,o,l){const d=Array.isArray(o.children),f=Ew(r);return n(a,o,l,d,{columnNumber:f?f.column-1:void 0,fileName:e,lineNumber:f?f.line:void 0},void 0)}}function hq(e,n){const t={};let r,a;for(a in n.properties)if(a!=="children"&&Aw.call(n.properties,a)){const o=mq(e,a,n.properties[a]);if(o){const[l,d]=o;e.tableCellAlignToStyle&&l==="align"&&typeof d=="string"&&rq.has(n.tagName)?r=d:t[l]=d}}if(r){const o=t.style||(t.style={});o[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return t}function pq(e,n){const t={};for(const r of n.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const o=r.data.estree.body[0];o.type;const l=o.expression;l.type;const d=l.properties[0];d.type,Object.assign(t,e.evaluater.evaluateExpression(d.argument))}else Zm(e,n.position);else{const a=r.name;let o;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const d=r.value.data.estree.body[0];d.type,o=e.evaluater.evaluateExpression(d.expression)}else Zm(e,n.position);else o=r.value===null?!0:r.value;t[a]=o}return t}function Dw(e,n){const t=[];let r=-1;const a=e.passKeys?new Map:eq;for(;++r<n.children.length;){const o=n.children[r];let l;if(e.passKeys){const f=o.type==="element"?o.tagName:o.type==="mdxJsxFlowElement"||o.type==="mdxJsxTextElement"?o.name:void 0;if(f){const u=a.get(f)||0;l=f+"-"+u,a.set(f,u+1)}}const d=xT(e,o,l);d!==void 0&&t.push(d)}return t}function mq(e,n,t){const r=B9(e.schema,n);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=r.commaSeparated?A9(t):G9(t)),r.property==="style"){let a=typeof t=="object"?t:gq(e,String(t));return e.stylePropertyNameCase==="css"&&(a=yq(a)),["style",a]}return[e.elementAttributeNameCase==="react"&&r.space?$9[r.property]||r.property:r.attribute,t]}}function gq(e,n){try{return X9(n,{reactCompat:!0})}catch(t){if(e.ignoreInvalidStyle)return{};const r=t,a=new ki("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=e.filePath||void 0,a.url=yT+"#cannot-parse-style-attribute",a}}function vT(e,n,t){let r;if(!t)r={type:"Literal",value:n};else if(n.includes(".")){const a=n.split(".");let o=-1,l;for(;++o<a.length;){const d=JC(a[o])?{type:"Identifier",name:a[o]}:{type:"Literal",value:a[o]};l=l?{type:"MemberExpression",object:l,property:d,computed:!!(o&&d.type==="Literal"),optional:!1}:d}r=l}else r=JC(n)&&!/^[a-z]/.test(n)?{type:"Identifier",name:n}:{type:"Literal",value:n};if(r.type==="Literal"){const a=r.value;return Aw.call(e.components,a)?e.components[a]:a}if(e.evaluater)return e.evaluater.evaluateExpression(r);Zm(e)}function Zm(e,n){const t=new ki("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:n,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=e.filePath||void 0,t.url=yT+"#cannot-handle-mdx-estrees-without-createevaluater",t}function yq(e){const n={};let t;for(t in e)Aw.call(e,t)&&(n[xq(t)]=e[t]);return n}function xq(e){let n=e.replace(tq,bq);return n.slice(0,3)==="ms-"&&(n="-"+n),n}function bq(e){return"-"+e.toLowerCase()}const m0={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},vq={};function Iw(e,n){const t=vq,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return wT(e,r,a)}function wT(e,n,t){if(wq(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return sj(e.children,n,t)}return Array.isArray(e)?sj(e,n,t):""}function sj(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=wT(e[a],n,t);return r.join("")}function wq(e){return!!(e&&typeof e=="object")}const oj=document.createElement("i");function Rw(e){const n="&"+e+";";oj.innerHTML=n;const t=oj.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function Oa(e,n,t,r){const a=e.length;let o=0,l;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)l=Array.from(r),l.unshift(n,t),e.splice(...l);else for(t&&e.splice(n,t);o<r.length;)l=r.slice(o,o+1e4),l.unshift(n,0),e.splice(...l),o+=1e4,n+=1e4}function ls(e,n){return e.length>0?(Oa(e,e.length,0,n),e):n}const lj={}.hasOwnProperty;function ST(e){const n={};let t=-1;for(;++t<e.length;)Sq(n,e[t]);return n}function Sq(e,n){let t;for(t in n){const a=(lj.call(e,t)?e[t]:void 0)||(e[t]={}),o=n[t];let l;if(o)for(l in o){lj.call(a,l)||(a[l]=[]);const d=o[l];Nq(a[l],Array.isArray(d)?d:d?[d]:[])}}}function Nq(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);Oa(e,0,0,r)}function NT(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function qs(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const qi=gu(/[A-Za-z]/),ji=gu(/[\dA-Za-z]/),Cq=gu(/[#-'*+\--9=?A-Z^-~]/);function ub(e){return e!==null&&(e<32||e===127)}const E1=gu(/\d/),jq=gu(/[\dA-Fa-f]/),_q=gu(/[!-/:-@[-`{-~]/);function Mt(e){return e!==null&&e<-2}function Zn(e){return e!==null&&(e<0||e===32)}function mn(e){return e===-2||e===-1||e===32}const Fb=gu(new RegExp("\\p{P}|\\p{S}","u")),$d=gu(/\s/);function gu(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function Gh(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const o=e.charCodeAt(t);let l="";if(o===37&&ji(e.charCodeAt(t+1))&&ji(e.charCodeAt(t+2)))a=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(l=String.fromCharCode(o));else if(o>55295&&o<57344){const d=e.charCodeAt(t+1);o<56320&&d>56319&&d<57344?(l=String.fromCharCode(o,d),a=1):l=""}else l=String.fromCharCode(o);l&&(n.push(e.slice(r,t),encodeURIComponent(l)),r=t+a+1,l=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function _n(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let o=0;return l;function l(f){return mn(f)?(e.enter(t),d(f)):n(f)}function d(f){return mn(f)&&o++<a?(e.consume(f),d):(e.exit(t),n(f))}}const kq={tokenize:Tq};function Tq(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(d){if(d===null){e.consume(d);return}return e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),_n(e,n,"linePrefix")}function a(d){return e.enter("paragraph"),o(d)}function o(d){const f=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=f),t=f,l(d)}function l(d){if(d===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(d);return}return Mt(d)?(e.consume(d),e.exit("chunkText"),o):(e.consume(d),l)}}const Eq={tokenize:Aq},cj={tokenize:Pq};function Aq(e){const n=this,t=[];let r=0,a,o,l;return d;function d(I){if(r<t.length){const U=t[r];return n.containerState=U[1],e.attempt(U[0].continuation,f,u)(I)}return u(I)}function f(I){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&M();const U=n.events.length;let L=U,$;for(;L--;)if(n.events[L][0]==="exit"&&n.events[L][1].type==="chunkFlow"){$=n.events[L][1].end;break}P(r);let z=U;for(;z<n.events.length;)n.events[z][1].end={...$},z++;return Oa(n.events,L+1,0,n.events.slice(U)),n.events.length=z,u(I)}return d(I)}function u(I){if(r===t.length){if(!a)return b(I);if(a.currentConstruct&&a.currentConstruct.concrete)return S(I);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(cj,p,g)(I)}function p(I){return a&&M(),P(r),b(I)}function g(I){return n.parser.lazy[n.now().line]=r!==t.length,l=n.now().offset,S(I)}function b(I){return n.containerState={},e.attempt(cj,v,S)(I)}function v(I){return r++,t.push([n.currentConstruct,n.containerState]),b(I)}function S(I){if(I===null){a&&M(),P(0),e.consume(I);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:o}),k(I)}function k(I){if(I===null){T(e.exit("chunkFlow"),!0),P(0),e.consume(I);return}return Mt(I)?(e.consume(I),T(e.exit("chunkFlow")),r=0,n.interrupt=void 0,d):(e.consume(I),k)}function T(I,U){const L=n.sliceStream(I);if(U&&L.push(null),I.previous=o,o&&(o.next=I),o=I,a.defineSkip(I.start),a.write(L),n.parser.lazy[I.start.line]){let $=a.events.length;for(;$--;)if(a.events[$][1].start.offset<l&&(!a.events[$][1].end||a.events[$][1].end.offset>l))return;const z=n.events.length;let F=z,Y,R;for(;F--;)if(n.events[F][0]==="exit"&&n.events[F][1].type==="chunkFlow"){if(Y){R=n.events[F][1].end;break}Y=!0}for(P(r),$=z;$<n.events.length;)n.events[$][1].end={...R},$++;Oa(n.events,F+1,0,n.events.slice(z)),n.events.length=$}}function P(I){let U=t.length;for(;U-- >I;){const L=t[U];n.containerState=L[1],L[0].exit.call(n,e)}t.length=I}function M(){a.write([null]),o=void 0,a=void 0,n.containerState._closeFlow=void 0}}function Pq(e,n,t){return _n(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Rh(e){if(e===null||Zn(e)||$d(e))return 1;if(Fb(e))return 2}function $b(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const o=e[a].resolveAll;o&&!r.includes(o)&&(n=o(n,t),r.push(o))}return n}const A1={name:"attention",resolveAll:Dq,tokenize:Iq};function Dq(e,n){let t=-1,r,a,o,l,d,f,u,p;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;f=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};uj(g,-f),uj(b,f),l={type:f>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},d={type:f>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},o={type:f>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:f>1?"strong":"emphasis",start:{...l.start},end:{...d.end}},e[r][1].end={...l.start},e[t][1].start={...d.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=ls(u,[["enter",e[r][1],n],["exit",e[r][1],n]])),u=ls(u,[["enter",a,n],["enter",l,n],["exit",l,n],["enter",o,n]]),u=ls(u,$b(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),u=ls(u,[["exit",o,n],["enter",d,n],["exit",d,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(p=2,u=ls(u,[["enter",e[t][1],n],["exit",e[t][1],n]])):p=0,Oa(e,r-1,t-r+3,u),t=r+u.length-p-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function Iq(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=Rh(r);let o;return l;function l(f){return o=f,e.enter("attentionSequence"),d(f)}function d(f){if(f===o)return e.consume(f),d;const u=e.exit("attentionSequence"),p=Rh(f),g=!p||p===2&&a||t.includes(f),b=!a||a===2&&p||t.includes(r);return u._open=!!(o===42?g:g&&(a||!b)),u._close=!!(o===42?b:b&&(p||!g)),n(f)}}function uj(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const Rq={name:"autolink",tokenize:Mq};function Mq(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o}function o(v){return qi(v)?(e.consume(v),l):v===64?t(v):u(v)}function l(v){return v===43||v===45||v===46||ji(v)?(r=1,d(v)):u(v)}function d(v){return v===58?(e.consume(v),r=0,f):(v===43||v===45||v===46||ji(v))&&r++<32?(e.consume(v),d):(r=0,u(v))}function f(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||ub(v)?t(v):(e.consume(v),f)}function u(v){return v===64?(e.consume(v),p):Cq(v)?(e.consume(v),u):t(v)}function p(v){return ji(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,p):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||ji(v))&&r++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const ug={partial:!0,tokenize:Oq};function Oq(e,n,t){return r;function r(o){return mn(o)?_n(e,a,"linePrefix")(o):a(o)}function a(o){return o===null||Mt(o)?n(o):t(o)}}const CT={continuation:{tokenize:Fq},exit:$q,name:"blockQuote",tokenize:Lq};function Lq(e,n,t){const r=this;return a;function a(l){if(l===62){const d=r.containerState;return d.open||(e.enter("blockQuote",{_container:!0}),d.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),o}return t(l)}function o(l){return mn(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(l))}}function Fq(e,n,t){const r=this;return a;function a(l){return mn(l)?_n(e,o,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):o(l)}function o(l){return e.attempt(CT,n,t)(l)}}function $q(e){e.exit("blockQuote")}const jT={name:"characterEscape",tokenize:zq};function zq(e,n,t){return r;function r(o){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(o),e.exit("escapeMarker"),a}function a(o){return _q(o)?(e.enter("characterEscapeValue"),e.consume(o),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(o)}}const _T={name:"characterReference",tokenize:Uq};function Uq(e,n,t){const r=this;let a=0,o,l;return d;function d(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),f}function f(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),o=31,l=ji,p(g))}function u(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,l=jq,p):(e.enter("characterReferenceValue"),o=7,l=E1,p(g))}function p(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return l===ji&&!Rw(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return l(g)&&a++<o?(e.consume(g),p):t(g)}}const dj={partial:!0,tokenize:qq},fj={concrete:!0,name:"codeFenced",tokenize:Bq};function Bq(e,n,t){const r=this,a={partial:!0,tokenize:L};let o=0,l=0,d;return f;function f($){return u($)}function u($){const z=r.events[r.events.length-1];return o=z&&z[1].type==="linePrefix"?z[2].sliceSerialize(z[1],!0).length:0,d=$,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),p($)}function p($){return $===d?(l++,e.consume($),p):l<3?t($):(e.exit("codeFencedFenceSequence"),mn($)?_n(e,g,"whitespace")($):g($))}function g($){return $===null||Mt($)?(e.exit("codeFencedFence"),r.interrupt?n($):e.check(dj,k,U)($)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b($))}function b($){return $===null||Mt($)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g($)):mn($)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),_n(e,v,"whitespace")($)):$===96&&$===d?t($):(e.consume($),b)}function v($){return $===null||Mt($)?g($):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S($))}function S($){return $===null||Mt($)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g($)):$===96&&$===d?t($):(e.consume($),S)}function k($){return e.attempt(a,U,T)($)}function T($){return e.enter("lineEnding"),e.consume($),e.exit("lineEnding"),P}function P($){return o>0&&mn($)?_n(e,M,"linePrefix",o+1)($):M($)}function M($){return $===null||Mt($)?e.check(dj,k,U)($):(e.enter("codeFlowValue"),I($))}function I($){return $===null||Mt($)?(e.exit("codeFlowValue"),M($)):(e.consume($),I)}function U($){return e.exit("codeFenced"),n($)}function L($,z,F){let Y=0;return R;function R(W){return $.enter("lineEnding"),$.consume(W),$.exit("lineEnding"),B}function B(W){return $.enter("codeFencedFence"),mn(W)?_n($,G,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(W):G(W)}function G(W){return W===d?($.enter("codeFencedFenceSequence"),ie(W)):F(W)}function ie(W){return W===d?(Y++,$.consume(W),ie):Y>=l?($.exit("codeFencedFenceSequence"),mn(W)?_n($,te,"whitespace")(W):te(W)):F(W)}function te(W){return W===null||Mt(W)?($.exit("codeFencedFence"),z(W)):F(W)}}}function qq(e,n,t){const r=this;return a;function a(l){return l===null?t(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}const g0={name:"codeIndented",tokenize:Hq},Vq={partial:!0,tokenize:Gq};function Hq(e,n,t){const r=this;return a;function a(u){return e.enter("codeIndented"),_n(e,o,"linePrefix",5)(u)}function o(u){const p=r.events[r.events.length-1];return p&&p[1].type==="linePrefix"&&p[2].sliceSerialize(p[1],!0).length>=4?l(u):t(u)}function l(u){return u===null?f(u):Mt(u)?e.attempt(Vq,l,f)(u):(e.enter("codeFlowValue"),d(u))}function d(u){return u===null||Mt(u)?(e.exit("codeFlowValue"),l(u)):(e.consume(u),d)}function f(u){return e.exit("codeIndented"),n(u)}}function Gq(e,n,t){const r=this;return a;function a(l){return r.parser.lazy[r.now().line]?t(l):Mt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):_n(e,o,"linePrefix",5)(l)}function o(l){const d=r.events[r.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):Mt(l)?a(l):t(l)}}const Yq={name:"codeText",previous:Qq,resolve:Wq,tokenize:Jq};function Wq(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function Qq(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function Jq(e,n,t){let r=0,a,o;return l;function l(g){return e.enter("codeText"),e.enter("codeTextSequence"),d(g)}function d(g){return g===96?(e.consume(g),r++,d):(e.exit("codeTextSequence"),f(g))}function f(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),f):g===96?(o=e.enter("codeTextSequence"),a=0,p(g)):Mt(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),f):(e.enter("codeTextData"),u(g))}function u(g){return g===null||g===32||g===96||Mt(g)?(e.exit("codeTextData"),f(g)):(e.consume(g),u)}function p(g){return g===96?(e.consume(g),a++,p):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(o.type="codeTextData",u(g))}}let Kq=class{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const o=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&Im(this.left,r),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Im(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Im(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Im(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Im(this.left,t.reverse())}}};function Im(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function kT(e){const n={};let t=-1,r,a,o,l,d,f,u;const p=new Kq(e);for(;++t<p.length;){for(;t in n;)t=n[t];if(r=p.get(t),t&&r[1].type==="chunkFlow"&&p.get(t-1)[1].type==="listItemPrefix"&&(f=r[1]._tokenizer.events,o=0,o<f.length&&f[o][1].type==="lineEndingBlank"&&(o+=2),o<f.length&&f[o][1].type==="content"))for(;++o<f.length&&f[o][1].type!=="content";)f[o][1].type==="chunkText"&&(f[o][1]._isInFirstContentOfListItem=!0,o++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,Xq(p,t)),t=n[t],u=!0);else if(r[1]._container){for(o=t,a=void 0;o--;)if(l=p.get(o),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(p.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=o);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(r[1].end={...p.get(a)[1].start},d=p.slice(a,t),d.unshift(r),p.splice(a,t-a+1,d))}}return Oa(e,0,Number.POSITIVE_INFINITY,p.slice(0)),!u}function Xq(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const o=[];let l=t._tokenizer;l||(l=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const d=l.events,f=[],u={};let p,g,b=-1,v=t,S=0,k=0;const T=[k];for(;v;){for(;e.get(++a)[1]!==v;);o.push(a),v._tokenizer||(p=r.sliceStream(v),v.next||p.push(null),g&&l.defineSkip(v.start),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(p),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<d.length;)d[b][0]==="exit"&&d[b-1][0]==="enter"&&d[b][1].type===d[b-1][1].type&&d[b][1].start.line!==d[b][1].end.line&&(k=b+1,T.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(l.events=[],v?(v._tokenizer=void 0,v.previous=void 0):T.pop(),b=T.length;b--;){const P=d.slice(T[b],T[b+1]),M=o.pop();f.push([M,M+P.length-1]),e.splice(M,2,P)}for(f.reverse(),b=-1;++b<f.length;)u[S+f[b][0]]=S+f[b][1],S+=f[b][1]-f[b][0]-1;return u}const Zq={resolve:t7,tokenize:n7},e7={partial:!0,tokenize:r7};function t7(e){return kT(e),e}function n7(e,n){let t;return r;function r(d){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(d)}function a(d){return d===null?o(d):Mt(d)?e.check(e7,l,o)(d):(e.consume(d),a)}function o(d){return e.exit("chunkContent"),e.exit("content"),n(d)}function l(d){return e.consume(d),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function r7(e,n,t){const r=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),_n(e,o,"linePrefix")}function o(l){if(l===null||Mt(l))return t(l);const d=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):e.interrupt(r.parser.constructs.flow,t,n)(l)}}function TT(e,n,t,r,a,o,l,d,f){const u=f||Number.POSITIVE_INFINITY;let p=0;return g;function g(P){return P===60?(e.enter(r),e.enter(a),e.enter(o),e.consume(P),e.exit(o),b):P===null||P===32||P===41||ub(P)?t(P):(e.enter(r),e.enter(l),e.enter(d),e.enter("chunkString",{contentType:"string"}),k(P))}function b(P){return P===62?(e.enter(o),e.consume(P),e.exit(o),e.exit(a),e.exit(r),n):(e.enter(d),e.enter("chunkString",{contentType:"string"}),v(P))}function v(P){return P===62?(e.exit("chunkString"),e.exit(d),b(P)):P===null||P===60||Mt(P)?t(P):(e.consume(P),P===92?S:v)}function S(P){return P===60||P===62||P===92?(e.consume(P),v):v(P)}function k(P){return!p&&(P===null||P===41||Zn(P))?(e.exit("chunkString"),e.exit(d),e.exit(l),e.exit(r),n(P)):p<u&&P===40?(e.consume(P),p++,k):P===41?(e.consume(P),p--,k):P===null||P===32||P===40||ub(P)?t(P):(e.consume(P),P===92?T:k)}function T(P){return P===40||P===41||P===92?(e.consume(P),k):k(P)}}function ET(e,n,t,r,a,o){const l=this;let d=0,f;return u;function u(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(o),p}function p(v){return d>999||v===null||v===91||v===93&&!f||v===94&&!d&&"_hiddenFootnoteSupport"in l.parser.constructs?t(v):v===93?(e.exit(o),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):Mt(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),p):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||Mt(v)||d++>999?(e.exit("chunkString"),p(v)):(e.consume(v),f||(f=!mn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),d++,g):g(v)}}function AT(e,n,t,r,a,o){let l;return d;function d(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),l=b===40?41:b,f):t(b)}function f(b){return b===l?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(o),u(b))}function u(b){return b===l?(e.exit(o),f(l)):b===null?t(b):Mt(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),_n(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),p(b))}function p(b){return b===l||b===null||Mt(b)?(e.exit("chunkString"),u(b)):(e.consume(b),b===92?g:p)}function g(b){return b===l||b===92?(e.consume(b),p):p(b)}}function Um(e,n){let t;return r;function r(a){return Mt(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):mn(a)?_n(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const i7={name:"definition",tokenize:s7},a7={partial:!0,tokenize:o7};function s7(e,n,t){const r=this;let a;return o;function o(v){return e.enter("definition"),l(v)}function l(v){return ET.call(r,e,d,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function d(v){return a=qs(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),f):t(v)}function f(v){return Zn(v)?Um(e,u)(v):u(v)}function u(v){return TT(e,p,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function p(v){return e.attempt(a7,g,g)(v)}function g(v){return mn(v)?_n(e,b,"whitespace")(v):b(v)}function b(v){return v===null||Mt(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function o7(e,n,t){return r;function r(d){return Zn(d)?Um(e,a)(d):t(d)}function a(d){return AT(e,o,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(d)}function o(d){return mn(d)?_n(e,l,"whitespace")(d):l(d)}function l(d){return d===null||Mt(d)?n(d):t(d)}}const l7={name:"hardBreakEscape",tokenize:c7};function c7(e,n,t){return r;function r(o){return e.enter("hardBreakEscape"),e.consume(o),a}function a(o){return Mt(o)?(e.exit("hardBreakEscape"),n(o)):t(o)}}const u7={name:"headingAtx",resolve:d7,tokenize:f7};function d7(e,n){let t=e.length-2,r=3,a,o;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},o={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},Oa(e,r,t-r+1,[["enter",a,n],["enter",o,n],["exit",o,n],["exit",a,n]])),e}function f7(e,n,t){let r=0;return a;function a(p){return e.enter("atxHeading"),o(p)}function o(p){return e.enter("atxHeadingSequence"),l(p)}function l(p){return p===35&&r++<6?(e.consume(p),l):p===null||Zn(p)?(e.exit("atxHeadingSequence"),d(p)):t(p)}function d(p){return p===35?(e.enter("atxHeadingSequence"),f(p)):p===null||Mt(p)?(e.exit("atxHeading"),n(p)):mn(p)?_n(e,d,"whitespace")(p):(e.enter("atxHeadingText"),u(p))}function f(p){return p===35?(e.consume(p),f):(e.exit("atxHeadingSequence"),d(p))}function u(p){return p===null||p===35||Zn(p)?(e.exit("atxHeadingText"),d(p)):(e.consume(p),u)}}const h7=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],hj=["pre","script","style","textarea"],p7={concrete:!0,name:"htmlFlow",resolveTo:y7,tokenize:x7},m7={partial:!0,tokenize:v7},g7={partial:!0,tokenize:b7};function y7(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function x7(e,n,t){const r=this;let a,o,l,d,f;return u;function u(D){return p(D)}function p(D){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(D),g}function g(D){return D===33?(e.consume(D),b):D===47?(e.consume(D),o=!0,k):D===63?(e.consume(D),a=3,r.interrupt?n:E):qi(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function b(D){return D===45?(e.consume(D),a=2,v):D===91?(e.consume(D),a=5,d=0,S):qi(D)?(e.consume(D),a=4,r.interrupt?n:E):t(D)}function v(D){return D===45?(e.consume(D),r.interrupt?n:E):t(D)}function S(D){const ce="CDATA[";return D===ce.charCodeAt(d++)?(e.consume(D),d===ce.length?r.interrupt?n:G:S):t(D)}function k(D){return qi(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function T(D){if(D===null||D===47||D===62||Zn(D)){const ce=D===47,ve=l.toLowerCase();return!ce&&!o&&hj.includes(ve)?(a=1,r.interrupt?n(D):G(D)):h7.includes(l.toLowerCase())?(a=6,ce?(e.consume(D),P):r.interrupt?n(D):G(D)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(D):o?M(D):I(D))}return D===45||ji(D)?(e.consume(D),l+=String.fromCharCode(D),T):t(D)}function P(D){return D===62?(e.consume(D),r.interrupt?n:G):t(D)}function M(D){return mn(D)?(e.consume(D),M):R(D)}function I(D){return D===47?(e.consume(D),R):D===58||D===95||qi(D)?(e.consume(D),U):mn(D)?(e.consume(D),I):R(D)}function U(D){return D===45||D===46||D===58||D===95||ji(D)?(e.consume(D),U):L(D)}function L(D){return D===61?(e.consume(D),$):mn(D)?(e.consume(D),L):I(D)}function $(D){return D===null||D===60||D===61||D===62||D===96?t(D):D===34||D===39?(e.consume(D),f=D,z):mn(D)?(e.consume(D),$):F(D)}function z(D){return D===f?(e.consume(D),f=null,Y):D===null||Mt(D)?t(D):(e.consume(D),z)}function F(D){return D===null||D===34||D===39||D===47||D===60||D===61||D===62||D===96||Zn(D)?L(D):(e.consume(D),F)}function Y(D){return D===47||D===62||mn(D)?I(D):t(D)}function R(D){return D===62?(e.consume(D),B):t(D)}function B(D){return D===null||Mt(D)?G(D):mn(D)?(e.consume(D),B):t(D)}function G(D){return D===45&&a===2?(e.consume(D),V):D===60&&a===1?(e.consume(D),se):D===62&&a===4?(e.consume(D),le):D===63&&a===3?(e.consume(D),E):D===93&&a===5?(e.consume(D),oe):Mt(D)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(m7,ue,ie)(D)):D===null||Mt(D)?(e.exit("htmlFlowData"),ie(D)):(e.consume(D),G)}function ie(D){return e.check(g7,te,ue)(D)}function te(D){return e.enter("lineEnding"),e.consume(D),e.exit("lineEnding"),W}function W(D){return D===null||Mt(D)?ie(D):(e.enter("htmlFlowData"),G(D))}function V(D){return D===45?(e.consume(D),E):G(D)}function se(D){return D===47?(e.consume(D),l="",re):G(D)}function re(D){if(D===62){const ce=l.toLowerCase();return hj.includes(ce)?(e.consume(D),le):G(D)}return qi(D)&&l.length<8?(e.consume(D),l+=String.fromCharCode(D),re):G(D)}function oe(D){return D===93?(e.consume(D),E):G(D)}function E(D){return D===62?(e.consume(D),le):D===45&&a===2?(e.consume(D),E):G(D)}function le(D){return D===null||Mt(D)?(e.exit("htmlFlowData"),ue(D)):(e.consume(D),le)}function ue(D){return e.exit("htmlFlow"),n(D)}}function b7(e,n,t){const r=this;return a;function a(l){return Mt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o):t(l)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}function v7(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(ug,n,t)}}const w7={name:"htmlText",tokenize:S7};function S7(e,n,t){const r=this;let a,o,l;return d;function d(E){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(E),f}function f(E){return E===33?(e.consume(E),u):E===47?(e.consume(E),L):E===63?(e.consume(E),I):qi(E)?(e.consume(E),F):t(E)}function u(E){return E===45?(e.consume(E),p):E===91?(e.consume(E),o=0,S):qi(E)?(e.consume(E),M):t(E)}function p(E){return E===45?(e.consume(E),v):t(E)}function g(E){return E===null?t(E):E===45?(e.consume(E),b):Mt(E)?(l=g,se(E)):(e.consume(E),g)}function b(E){return E===45?(e.consume(E),v):g(E)}function v(E){return E===62?V(E):E===45?b(E):g(E)}function S(E){const le="CDATA[";return E===le.charCodeAt(o++)?(e.consume(E),o===le.length?k:S):t(E)}function k(E){return E===null?t(E):E===93?(e.consume(E),T):Mt(E)?(l=k,se(E)):(e.consume(E),k)}function T(E){return E===93?(e.consume(E),P):k(E)}function P(E){return E===62?V(E):E===93?(e.consume(E),P):k(E)}function M(E){return E===null||E===62?V(E):Mt(E)?(l=M,se(E)):(e.consume(E),M)}function I(E){return E===null?t(E):E===63?(e.consume(E),U):Mt(E)?(l=I,se(E)):(e.consume(E),I)}function U(E){return E===62?V(E):I(E)}function L(E){return qi(E)?(e.consume(E),$):t(E)}function $(E){return E===45||ji(E)?(e.consume(E),$):z(E)}function z(E){return Mt(E)?(l=z,se(E)):mn(E)?(e.consume(E),z):V(E)}function F(E){return E===45||ji(E)?(e.consume(E),F):E===47||E===62||Zn(E)?Y(E):t(E)}function Y(E){return E===47?(e.consume(E),V):E===58||E===95||qi(E)?(e.consume(E),R):Mt(E)?(l=Y,se(E)):mn(E)?(e.consume(E),Y):V(E)}function R(E){return E===45||E===46||E===58||E===95||ji(E)?(e.consume(E),R):B(E)}function B(E){return E===61?(e.consume(E),G):Mt(E)?(l=B,se(E)):mn(E)?(e.consume(E),B):Y(E)}function G(E){return E===null||E===60||E===61||E===62||E===96?t(E):E===34||E===39?(e.consume(E),a=E,ie):Mt(E)?(l=G,se(E)):mn(E)?(e.consume(E),G):(e.consume(E),te)}function ie(E){return E===a?(e.consume(E),a=void 0,W):E===null?t(E):Mt(E)?(l=ie,se(E)):(e.consume(E),ie)}function te(E){return E===null||E===34||E===39||E===60||E===61||E===96?t(E):E===47||E===62||Zn(E)?Y(E):(e.consume(E),te)}function W(E){return E===47||E===62||Zn(E)?Y(E):t(E)}function V(E){return E===62?(e.consume(E),e.exit("htmlTextData"),e.exit("htmlText"),n):t(E)}function se(E){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(E),e.exit("lineEnding"),re}function re(E){return mn(E)?_n(e,oe,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(E):oe(E)}function oe(E){return e.enter("htmlTextData"),l(E)}}const Mw={name:"labelEnd",resolveAll:_7,resolveTo:k7,tokenize:T7},N7={tokenize:E7},C7={tokenize:A7},j7={tokenize:P7};function _7(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&Oa(e,0,e.length,t),e}function k7(e,n){let t=e.length,r=0,a,o,l,d;for(;t--;)if(a=e[t][1],o){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(o=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(l=t);const f={type:e[o][1].type==="labelLink"?"link":"image",start:{...e[o][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[o][1].start},end:{...e[l][1].end}},p={type:"labelText",start:{...e[o+r+2][1].end},end:{...e[l-2][1].start}};return d=[["enter",f,n],["enter",u,n]],d=ls(d,e.slice(o+1,o+r+3)),d=ls(d,[["enter",p,n]]),d=ls(d,$b(n.parser.constructs.insideSpan.null,e.slice(o+r+4,l-3),n)),d=ls(d,[["exit",p,n],e[l-2],e[l-1],["exit",u,n]]),d=ls(d,e.slice(l+1)),d=ls(d,[["exit",f,n]]),Oa(e,o,e.length,d),e}function T7(e,n,t){const r=this;let a=r.events.length,o,l;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){o=r.events[a][1];break}return d;function d(b){return o?o._inactive?g(b):(l=r.parser.defined.includes(qs(r.sliceSerialize({start:o.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),f):t(b)}function f(b){return b===40?e.attempt(N7,p,l?p:g)(b):b===91?e.attempt(C7,p,l?u:g)(b):l?p(b):g(b)}function u(b){return e.attempt(j7,p,g)(b)}function p(b){return n(b)}function g(b){return o._balanced=!0,t(b)}}function E7(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return Zn(g)?Um(e,o)(g):o(g)}function o(g){return g===41?p(g):TT(e,l,d,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function l(g){return Zn(g)?Um(e,f)(g):p(g)}function d(g){return t(g)}function f(g){return g===34||g===39||g===40?AT(e,u,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):p(g)}function u(g){return Zn(g)?Um(e,p)(g):p(g)}function p(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function A7(e,n,t){const r=this;return a;function a(d){return ET.call(r,e,o,l,"reference","referenceMarker","referenceString")(d)}function o(d){return r.parser.defined.includes(qs(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(d):t(d)}function l(d){return t(d)}}function P7(e,n,t){return r;function r(o){return e.enter("reference"),e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),a}function a(o){return o===93?(e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),e.exit("reference"),n):t(o)}}const D7={name:"labelStartImage",resolveAll:Mw.resolveAll,tokenize:I7};function I7(e,n,t){const r=this;return a;function a(d){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(d),e.exit("labelImageMarker"),o}function o(d){return d===91?(e.enter("labelMarker"),e.consume(d),e.exit("labelMarker"),e.exit("labelImage"),l):t(d)}function l(d){return d===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(d):n(d)}}const R7={name:"labelStartLink",resolveAll:Mw.resolveAll,tokenize:M7};function M7(e,n,t){const r=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),o}function o(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(l):n(l)}}const y0={name:"lineEnding",tokenize:O7};function O7(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),_n(e,n,"linePrefix")}}const qx={name:"thematicBreak",tokenize:L7};function L7(e,n,t){let r=0,a;return o;function o(u){return e.enter("thematicBreak"),l(u)}function l(u){return a=u,d(u)}function d(u){return u===a?(e.enter("thematicBreakSequence"),f(u)):r>=3&&(u===null||Mt(u))?(e.exit("thematicBreak"),n(u)):t(u)}function f(u){return u===a?(e.consume(u),r++,f):(e.exit("thematicBreakSequence"),mn(u)?_n(e,d,"whitespace")(u):d(u))}}const oa={continuation:{tokenize:U7},exit:q7,name:"list",tokenize:z7},F7={partial:!0,tokenize:V7},$7={partial:!0,tokenize:B7};function z7(e,n,t){const r=this,a=r.events[r.events.length-1];let o=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return d;function d(v){const S=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:E1(v)){if(r.containerState.type||(r.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(qx,t,u)(v):u(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),f(v)}return t(v)}function f(v){return E1(v)&&++l<10?(e.consume(v),f):(!r.interrupt||l<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),u(v)):t(v)}function u(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(ug,r.interrupt?t:p,e.attempt(F7,b,g))}function p(v){return r.containerState.initialBlankLine=!0,o++,b(v)}function g(v){return mn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=o+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function U7(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(ug,a,o);function a(d){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,_n(e,n,"listItemIndent",r.containerState.size+1)(d)}function o(d){return r.containerState.furtherBlankLines||!mn(d)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,l(d)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt($7,n,l)(d))}function l(d){return r.containerState._closeFlow=!0,r.interrupt=void 0,_n(e,e.attempt(oa,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(d)}}function B7(e,n,t){const r=this;return _n(e,a,"listItemIndent",r.containerState.size+1);function a(o){const l=r.events[r.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===r.containerState.size?n(o):t(o)}}function q7(e){e.exit(this.containerState.type)}function V7(e,n,t){const r=this;return _n(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(o){const l=r.events[r.events.length-1];return!mn(o)&&l&&l[1].type==="listItemPrefixWhitespace"?n(o):t(o)}}const pj={name:"setextUnderline",resolveTo:H7,tokenize:G7};function H7(e,n){let t=e.length,r,a,o;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!o&&e[t][1].type==="definition"&&(o=t);const l={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",o?(e.splice(a,0,["enter",l,n]),e.splice(o+1,0,["exit",e[r][1],n]),e[r][1].end={...e[o][1].end}):e[r][1]=l,e.push(["exit",l,n]),e}function G7(e,n,t){const r=this;let a;return o;function o(u){let p=r.events.length,g;for(;p--;)if(r.events[p][1].type!=="lineEnding"&&r.events[p][1].type!=="linePrefix"&&r.events[p][1].type!=="content"){g=r.events[p][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=u,l(u)):t(u)}function l(u){return e.enter("setextHeadingLineSequence"),d(u)}function d(u){return u===a?(e.consume(u),d):(e.exit("setextHeadingLineSequence"),mn(u)?_n(e,f,"lineSuffix")(u):f(u))}function f(u){return u===null||Mt(u)?(e.exit("setextHeadingLine"),n(u)):t(u)}}const Y7={tokenize:W7};function W7(e){const n=this,t=e.attempt(ug,r,e.attempt(this.parser.constructs.flowInitial,a,_n(e,e.attempt(this.parser.constructs.flow,a,e.attempt(Zq,a)),"linePrefix")));return t;function r(o){if(o===null){e.consume(o);return}return e.enter("lineEndingBlank"),e.consume(o),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const Q7={resolveAll:DT()},J7=PT("string"),K7=PT("text");function PT(e){return{resolveAll:DT(e==="text"?X7:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],o=t.attempt(a,l,d);return l;function l(p){return u(p)?o(p):d(p)}function d(p){if(p===null){t.consume(p);return}return t.enter("data"),t.consume(p),f}function f(p){return u(p)?(t.exit("data"),o(p)):(t.consume(p),f)}function u(p){if(p===null)return!0;const g=a[p];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function DT(e){return n;function n(t,r){let a=-1,o;for(;++a<=t.length;)o===void 0?t[a]&&t[a][1].type==="data"&&(o=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==o+2&&(t[o][1].end=t[a-1][1].end,t.splice(o+2,a-o-2),a=o+2),o=void 0);return e?e(t,r):t}}function X7(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let o=a.length,l=-1,d=0,f;for(;o--;){const u=a[o];if(typeof u=="string"){for(l=u.length;u.charCodeAt(l-1)===32;)d++,l--;if(l)break;l=-1}else if(u===-2)f=!0,d++;else if(u!==-1){o++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(d=0),d){const u={type:t===e.length||f||d<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?l:r.start._bufferIndex+l,_index:r.start._index+o,line:r.end.line,column:r.end.column-d,offset:r.end.offset-d},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(t,0,["enter",u,n],["exit",u,n]),t+=2)}t++}return e}const Z7={42:oa,43:oa,45:oa,48:oa,49:oa,50:oa,51:oa,52:oa,53:oa,54:oa,55:oa,56:oa,57:oa,62:CT},eV={91:i7},tV={[-2]:g0,[-1]:g0,32:g0},nV={35:u7,42:qx,45:[pj,qx],60:p7,61:pj,95:qx,96:fj,126:fj},rV={38:_T,92:jT},iV={[-5]:y0,[-4]:y0,[-3]:y0,33:D7,38:_T,42:A1,60:[Rq,w7],91:R7,92:[l7,jT],93:Mw,95:A1,96:Yq},aV={null:[A1,Q7]},sV={null:[42,95]},oV={null:[]},lV=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:sV,contentInitial:eV,disable:oV,document:Z7,flow:nV,flowInitial:tV,insideSpan:aV,string:rV,text:iV},Symbol.toStringTag,{value:"Module"}));function cV(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},o=[];let l=[],d=[];const f={attempt:z(L),check:z($),consume:M,enter:I,exit:U,interrupt:z($,{interrupt:!0})},u={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let p=n.tokenize.call(u,f);return n.resolveAll&&o.push(n),u;function g(B){return l=ls(l,B),T(),l[l.length-1]!==null?[]:(F(n,0),u.events=$b(o,u.events,u),u.events)}function b(B,G){return dV(v(B),G)}function v(B){return uV(l,B)}function S(){const{_bufferIndex:B,_index:G,line:ie,column:te,offset:W}=r;return{_bufferIndex:B,_index:G,line:ie,column:te,offset:W}}function k(B){a[B.line]=B.column,R()}function T(){let B;for(;r._index<l.length;){const G=l[r._index];if(typeof G=="string")for(B=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===B&&r._bufferIndex<G.length;)P(G.charCodeAt(r._bufferIndex));else P(G)}}function P(B){p=p(B)}function M(B){Mt(B)?(r.line++,r.column=1,r.offset+=B===-3?2:1,R()):B!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===l[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=B}function I(B,G){const ie=G||{};return ie.type=B,ie.start=S(),u.events.push(["enter",ie,u]),d.push(ie),ie}function U(B){const G=d.pop();return G.end=S(),u.events.push(["exit",G,u]),G}function L(B,G){F(B,G.from)}function $(B,G){G.restore()}function z(B,G){return ie;function ie(te,W,V){let se,re,oe,E;return Array.isArray(te)?ue(te):"tokenize"in te?ue([te]):le(te);function le(X){return fe;function fe(ae){const Me=ae!==null&&X[ae],Ke=ae!==null&&X.null,Z=[...Array.isArray(Me)?Me:Me?[Me]:[],...Array.isArray(Ke)?Ke:Ke?[Ke]:[]];return ue(Z)(ae)}}function ue(X){return se=X,re=0,X.length===0?V:D(X[re])}function D(X){return fe;function fe(ae){return E=Y(),oe=X,X.partial||(u.currentConstruct=X),X.name&&u.parser.constructs.disable.null.includes(X.name)?ve():X.tokenize.call(G?Object.assign(Object.create(u),G):u,f,ce,ve)(ae)}}function ce(X){return B(oe,E),W}function ve(X){return E.restore(),++re<se.length?D(se[re]):V}}}function F(B,G){B.resolveAll&&!o.includes(B)&&o.push(B),B.resolve&&Oa(u.events,G,u.events.length-G,B.resolve(u.events.slice(G),u)),B.resolveTo&&(u.events=B.resolveTo(u.events,u))}function Y(){const B=S(),G=u.previous,ie=u.currentConstruct,te=u.events.length,W=Array.from(d);return{from:te,restore:V};function V(){r=B,u.previous=G,u.currentConstruct=ie,u.events.length=te,d=W,R()}}function R(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function uV(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,o=n.end._bufferIndex;let l;if(t===a)l=[e[t].slice(r,o)];else{if(l=e.slice(t,a),r>-1){const d=l[0];typeof d=="string"?l[0]=d.slice(r):l.shift()}o>0&&l.push(e[a].slice(0,o))}return l}function dV(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const o=e[t];let l;if(typeof o=="string")l=o;else switch(o){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=n?" ":"	";break}case-1:{if(!n&&a)continue;l=" ";break}default:l=String.fromCharCode(o)}a=o===-2,r.push(l)}return r.join("")}function fV(e){const r={constructs:ST([lV,...(e||{}).extensions||[]]),content:a(kq),defined:[],document:a(Eq),flow:a(Y7),lazy:{},string:a(J7),text:a(K7)};return r;function a(o){return l;function l(d){return cV(r,o,d)}}}function hV(e){for(;!kT(e););return e}const mj=/[\0\t\n\r]/g;function pV(){let e=1,n="",t=!0,r;return a;function a(o,l,d){const f=[];let u,p,g,b,v;for(o=n+(typeof o=="string"?o.toString():new TextDecoder(l||void 0).decode(o)),g=0,n="",t&&(o.charCodeAt(0)===65279&&g++,t=void 0);g<o.length;){if(mj.lastIndex=g,u=mj.exec(o),b=u&&u.index!==void 0?u.index:o.length,v=o.charCodeAt(b),!u){n=o.slice(g);break}if(v===10&&g===b&&r)f.push(-3),r=void 0;else switch(r&&(f.push(-5),r=void 0),g<b&&(f.push(o.slice(g,b)),e+=b-g),v){case 0:{f.push(65533),e++;break}case 9:{for(p=Math.ceil(e/4)*4,f.push(-2);e++<p;)f.push(-1);break}case 10:{f.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return d&&(r&&f.push(-5),n&&f.push(n),f.push(null)),f}}const mV=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function gV(e){return e.replace(mV,yV)}function yV(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),o=a===120||a===88;return NT(t.slice(o?2:1),o?16:10)}return Rw(t)||e}const IT={}.hasOwnProperty;function xV(e,n,t){return typeof n!="string"&&(t=n,n=void 0),bV(t)(hV(fV(t).document().write(pV()(e,n,!0))))}function bV(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(Ht),autolinkProtocol:Y,autolinkEmail:Y,atxHeading:o(rt),blockQuote:o(Ke),characterEscape:Y,characterReference:Y,codeFenced:o(Z),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:o(Z,l),codeText:o(Ee,l),codeTextData:Y,data:Y,codeFlowValue:Y,definition:o(Ie),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:o(Fe),hardBreakEscape:o(lt),hardBreakTrailing:o(lt),htmlFlow:o(ct,l),htmlFlowData:Y,htmlText:o(ct,l),htmlTextData:Y,image:o(st),label:l,link:o(Ht),listItem:o(je),listItemValue:b,listOrdered:o(rn,g),listUnordered:o(rn),paragraph:o(qe),reference:D,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:o(rt),strong:o(Be),thematicBreak:o(we)},exit:{atxHeading:f(),atxHeadingSequence:L,autolink:f(),autolinkEmail:Me,autolinkProtocol:ae,blockQuote:f(),characterEscapeValue:R,characterReferenceMarkerHexadecimal:ve,characterReferenceMarkerNumeric:ve,characterReferenceValue:X,characterReference:fe,codeFenced:f(T),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:R,codeIndented:f(P),codeText:f(W),codeTextData:R,data:R,definition:f(),definitionDestinationString:U,definitionLabelString:M,definitionTitleString:I,emphasis:f(),hardBreakEscape:f(G),hardBreakTrailing:f(G),htmlFlow:f(ie),htmlFlowData:R,htmlText:f(te),htmlTextData:R,image:f(se),label:oe,labelText:re,lineEnding:B,link:f(V),listItem:f(),listOrdered:f(),listUnordered:f(),paragraph:f(),referenceString:ce,resourceDestinationString:E,resourceTitleString:le,resource:ue,setextHeading:f(F),setextHeadingLineSequence:z,setextHeadingText:$,strong:f(),thematicBreak:f()}};RT(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(Q){let me={type:"root",children:[]};const Ve={stack:[me],tokenStack:[],config:n,enter:d,exit:u,buffer:l,resume:p,data:t},Qe=[];let ot=-1;for(;++ot<Q.length;)if(Q[ot][1].type==="listOrdered"||Q[ot][1].type==="listUnordered")if(Q[ot][0]==="enter")Qe.push(ot);else{const kt=Qe.pop();ot=a(Q,kt,ot)}for(ot=-1;++ot<Q.length;){const kt=n[Q[ot][0]];IT.call(kt,Q[ot][1].type)&&kt[Q[ot][1].type].call(Object.assign({sliceSerialize:Q[ot][2].sliceSerialize},Ve),Q[ot][1])}if(Ve.tokenStack.length>0){const kt=Ve.tokenStack[Ve.tokenStack.length-1];(kt[1]||gj).call(Ve,void 0,kt[0])}for(me.position={start:ru(Q.length>0?Q[0][1].start:{line:1,column:1,offset:0}),end:ru(Q.length>0?Q[Q.length-2][1].end:{line:1,column:1,offset:0})},ot=-1;++ot<n.transforms.length;)me=n.transforms[ot](me)||me;return me}function a(Q,me,Ve){let Qe=me-1,ot=-1,kt=!1,qt,be,ge,Te;for(;++Qe<=Ve;){const De=Q[Qe];switch(De[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{De[0]==="enter"?ot++:ot--,Te=void 0;break}case"lineEndingBlank":{De[0]==="enter"&&(qt&&!Te&&!ot&&!ge&&(ge=Qe),Te=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Te=void 0}if(!ot&&De[0]==="enter"&&De[1].type==="listItemPrefix"||ot===-1&&De[0]==="exit"&&(De[1].type==="listUnordered"||De[1].type==="listOrdered")){if(qt){let ze=Qe;for(be=void 0;ze--;){const nt=Q[ze];if(nt[1].type==="lineEnding"||nt[1].type==="lineEndingBlank"){if(nt[0]==="exit")continue;be&&(Q[be][1].type="lineEndingBlank",kt=!0),nt[1].type="lineEnding",be=ze}else if(!(nt[1].type==="linePrefix"||nt[1].type==="blockQuotePrefix"||nt[1].type==="blockQuotePrefixWhitespace"||nt[1].type==="blockQuoteMarker"||nt[1].type==="listItemIndent"))break}ge&&(!be||ge<be)&&(qt._spread=!0),qt.end=Object.assign({},be?Q[be][1].start:De[1].end),Q.splice(be||Qe,0,["exit",qt,De[2]]),Qe++,Ve++}if(De[1].type==="listItemPrefix"){const ze={type:"listItem",_spread:!1,start:Object.assign({},De[1].start),end:void 0};qt=ze,Q.splice(Qe,0,["enter",ze,De[2]]),Qe++,Ve++,ge=void 0,Te=!0}}}return Q[me][1]._spread=kt,Ve}function o(Q,me){return Ve;function Ve(Qe){d.call(this,Q(Qe),Qe),me&&me.call(this,Qe)}}function l(){this.stack.push({type:"fragment",children:[]})}function d(Q,me,Ve){this.stack[this.stack.length-1].children.push(Q),this.stack.push(Q),this.tokenStack.push([me,Ve||void 0]),Q.position={start:ru(me.start),end:void 0}}function f(Q){return me;function me(Ve){Q&&Q.call(this,Ve),u.call(this,Ve)}}function u(Q,me){const Ve=this.stack.pop(),Qe=this.tokenStack.pop();if(Qe)Qe[0].type!==Q.type&&(me?me.call(this,Q,Qe[0]):(Qe[1]||gj).call(this,Q,Qe[0]));else throw new Error("Cannot close `"+Q.type+"` ("+zm({start:Q.start,end:Q.end})+"): its not open");Ve.position.end=ru(Q.end)}function p(){return Iw(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(Q){if(this.data.expectingFirstListItemValue){const me=this.stack[this.stack.length-2];me.start=Number.parseInt(this.sliceSerialize(Q),10),this.data.expectingFirstListItemValue=void 0}}function v(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.lang=Q}function S(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.meta=Q}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.value=Q.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function P(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.value=Q.replace(/(\r?\n|\r)$/g,"")}function M(Q){const me=this.resume(),Ve=this.stack[this.stack.length-1];Ve.label=me,Ve.identifier=qs(this.sliceSerialize(Q)).toLowerCase()}function I(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.title=Q}function U(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.url=Q}function L(Q){const me=this.stack[this.stack.length-1];if(!me.depth){const Ve=this.sliceSerialize(Q).length;me.depth=Ve}}function $(){this.data.setextHeadingSlurpLineEnding=!0}function z(Q){const me=this.stack[this.stack.length-1];me.depth=this.sliceSerialize(Q).codePointAt(0)===61?1:2}function F(){this.data.setextHeadingSlurpLineEnding=void 0}function Y(Q){const Ve=this.stack[this.stack.length-1].children;let Qe=Ve[Ve.length-1];(!Qe||Qe.type!=="text")&&(Qe=ke(),Qe.position={start:ru(Q.start),end:void 0},Ve.push(Qe)),this.stack.push(Qe)}function R(Q){const me=this.stack.pop();me.value+=this.sliceSerialize(Q),me.position.end=ru(Q.end)}function B(Q){const me=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Ve=me.children[me.children.length-1];Ve.position.end=ru(Q.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(me.type)&&(Y.call(this,Q),R.call(this,Q))}function G(){this.data.atHardBreak=!0}function ie(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.value=Q}function te(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.value=Q}function W(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.value=Q}function V(){const Q=this.stack[this.stack.length-1];if(this.data.inReference){const me=this.data.referenceType||"shortcut";Q.type+="Reference",Q.referenceType=me,delete Q.url,delete Q.title}else delete Q.identifier,delete Q.label;this.data.referenceType=void 0}function se(){const Q=this.stack[this.stack.length-1];if(this.data.inReference){const me=this.data.referenceType||"shortcut";Q.type+="Reference",Q.referenceType=me,delete Q.url,delete Q.title}else delete Q.identifier,delete Q.label;this.data.referenceType=void 0}function re(Q){const me=this.sliceSerialize(Q),Ve=this.stack[this.stack.length-2];Ve.label=gV(me),Ve.identifier=qs(me).toLowerCase()}function oe(){const Q=this.stack[this.stack.length-1],me=this.resume(),Ve=this.stack[this.stack.length-1];if(this.data.inReference=!0,Ve.type==="link"){const Qe=Q.children;Ve.children=Qe}else Ve.alt=me}function E(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.url=Q}function le(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.title=Q}function ue(){this.data.inReference=void 0}function D(){this.data.referenceType="collapsed"}function ce(Q){const me=this.resume(),Ve=this.stack[this.stack.length-1];Ve.label=me,Ve.identifier=qs(this.sliceSerialize(Q)).toLowerCase(),this.data.referenceType="full"}function ve(Q){this.data.characterReferenceType=Q.type}function X(Q){const me=this.sliceSerialize(Q),Ve=this.data.characterReferenceType;let Qe;Ve?(Qe=NT(me,Ve==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Qe=Rw(me);const ot=this.stack[this.stack.length-1];ot.value+=Qe}function fe(Q){const me=this.stack.pop();me.position.end=ru(Q.end)}function ae(Q){R.call(this,Q);const me=this.stack[this.stack.length-1];me.url=this.sliceSerialize(Q)}function Me(Q){R.call(this,Q);const me=this.stack[this.stack.length-1];me.url="mailto:"+this.sliceSerialize(Q)}function Ke(){return{type:"blockquote",children:[]}}function Z(){return{type:"code",lang:null,meta:null,value:""}}function Ee(){return{type:"inlineCode",value:""}}function Ie(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Fe(){return{type:"emphasis",children:[]}}function rt(){return{type:"heading",depth:0,children:[]}}function lt(){return{type:"break"}}function ct(){return{type:"html",value:""}}function st(){return{type:"image",title:null,url:"",alt:null}}function Ht(){return{type:"link",title:null,url:"",children:[]}}function rn(Q){return{type:"list",ordered:Q.type==="listOrdered",start:null,spread:Q._spread,children:[]}}function je(Q){return{type:"listItem",spread:Q._spread,checked:null,children:[]}}function qe(){return{type:"paragraph",children:[]}}function Be(){return{type:"strong",children:[]}}function ke(){return{type:"text",value:""}}function we(){return{type:"thematicBreak"}}}function ru(e){return{line:e.line,column:e.column,offset:e.offset}}function RT(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?RT(e,r):vV(e,r)}}function vV(e,n){let t;for(t in n)if(IT.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function gj(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+zm({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+zm({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+zm({start:n.start,end:n.end})+") is still open")}function wV(e){const n=this;n.parser=t;function t(r){return xV(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}function SV(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function NV(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function CV(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function jV(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function _V(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function kV(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=Gh(r.toLowerCase()),o=e.footnoteOrder.indexOf(r);let l,d=e.footnoteCounts.get(r);d===void 0?(d=0,e.footnoteOrder.push(r),l=e.footnoteOrder.length):l=o+1,d+=1,e.footnoteCounts.set(r,d);const f={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(d>1?"-"+d:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(n,f);const u={type:"element",tagName:"sup",properties:{},children:[f]};return e.patch(n,u),e.applyData(n,u)}function TV(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function EV(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function MT(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),o=a[0];o&&o.type==="text"?o.value="["+o.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=r:a.push({type:"text",value:r}),a}function AV(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return MT(e,n);const a={src:Gh(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,o),e.applyData(n,o)}function PV(e,n){const t={src:Gh(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function DV(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function IV(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return MT(e,n);const a={href:Gh(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,o),e.applyData(n,o)}function RV(e,n){const t={href:Gh(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function MV(e,n,t){const r=e.all(n),a=t?OV(t):OT(n),o={},l=[];if(typeof n.checked=="boolean"){const p=r[0];let g;p&&p.type==="element"&&p.tagName==="p"?g=p:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let d=-1;for(;++d<r.length;){const p=r[d];(a||d!==0||p.type!=="element"||p.tagName!=="p")&&l.push({type:"text",value:`
`}),p.type==="element"&&p.tagName==="p"&&!a?l.push(...p.children):l.push(p)}const f=r[r.length-1];f&&(a||f.type!=="element"||f.tagName!=="p")&&l.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:o,children:l};return e.patch(n,u),e.applyData(n,u)}function OV(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=OT(t[r])}return n}function OT(e){const n=e.spread;return n??e.children.length>1}function LV(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const l=r[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const o={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,o),e.applyData(n,o)}function FV(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function $V(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function zV(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function UV(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],l),a.push(l)}if(t.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},d=Ew(n.children[1]),f=mT(n.children[n.children.length-1]);d&&f&&(l.position={start:d,end:f}),a.push(l)}const o={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,o),e.applyData(n,o)}function BV(e,n,t){const r=t?t.children:void 0,o=(r?r.indexOf(n):1)===0?"th":"td",l=t&&t.type==="table"?t.align:void 0,d=l?l.length:n.children.length;let f=-1;const u=[];for(;++f<d;){const g=n.children[f],b={},v=l?l[f]:void 0;v&&(b.align=v);let S={type:"element",tagName:o,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),u.push(S)}const p={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(n,p),e.applyData(n,p)}function qV(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const yj=9,xj=32;function VV(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const o=[];for(;r;)o.push(bj(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return o.push(bj(n.slice(a),a>0,!1)),o.join("")}function bj(e,n,t){let r=0,a=e.length;if(n){let o=e.codePointAt(r);for(;o===yj||o===xj;)r++,o=e.codePointAt(r)}if(t){let o=e.codePointAt(a-1);for(;o===yj||o===xj;)a--,o=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function HV(e,n){const t={type:"text",value:VV(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function GV(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const YV={blockquote:SV,break:NV,code:CV,delete:jV,emphasis:_V,footnoteReference:kV,heading:TV,html:EV,imageReference:AV,image:PV,inlineCode:DV,linkReference:IV,link:RV,listItem:MV,list:LV,paragraph:FV,root:$V,strong:zV,table:UV,tableCell:qV,tableRow:BV,text:HV,thematicBreak:GV,toml:wx,yaml:wx,definition:wx,footnoteDefinition:wx};function wx(){}const LT=-1,zb=0,Bm=1,db=2,Ow=3,Lw=4,Fw=5,$w=6,FT=7,$T=8,vj=typeof self=="object"?self:globalThis,WV=(e,n)=>{const t=(a,o)=>(e.set(o,a),a),r=a=>{if(e.has(a))return e.get(a);const[o,l]=n[a];switch(o){case zb:case LT:return t(l,a);case Bm:{const d=t([],a);for(const f of l)d.push(r(f));return d}case db:{const d=t({},a);for(const[f,u]of l)d[r(f)]=r(u);return d}case Ow:return t(new Date(l),a);case Lw:{const{source:d,flags:f}=l;return t(new RegExp(d,f),a)}case Fw:{const d=t(new Map,a);for(const[f,u]of l)d.set(r(f),r(u));return d}case $w:{const d=t(new Set,a);for(const f of l)d.add(r(f));return d}case FT:{const{name:d,message:f}=l;return t(new vj[d](f),a)}case $T:return t(BigInt(l),a);case"BigInt":return t(Object(BigInt(l)),a);case"ArrayBuffer":return t(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:d}=new Uint8Array(l);return t(new DataView(d),l)}}return t(new vj[o](l),a)};return r},wj=e=>WV(new Map,e)(0),gh="",{toString:QV}={},{keys:JV}=Object,Rm=e=>{const n=typeof e;if(n!=="object"||!e)return[zb,n];const t=QV.call(e).slice(8,-1);switch(t){case"Array":return[Bm,gh];case"Object":return[db,gh];case"Date":return[Ow,gh];case"RegExp":return[Lw,gh];case"Map":return[Fw,gh];case"Set":return[$w,gh];case"DataView":return[Bm,t]}return t.includes("Array")?[Bm,t]:t.includes("Error")?[FT,t]:[db,t]},Sx=([e,n])=>e===zb&&(n==="function"||n==="symbol"),KV=(e,n,t,r)=>{const a=(l,d)=>{const f=r.push(l)-1;return t.set(d,f),f},o=l=>{if(t.has(l))return t.get(l);let[d,f]=Rm(l);switch(d){case zb:{let p=l;switch(f){case"bigint":d=$T,p=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+f);p=null;break;case"undefined":return a([LT],l)}return a([d,p],l)}case Bm:{if(f){let b=l;return f==="DataView"?b=new Uint8Array(l.buffer):f==="ArrayBuffer"&&(b=new Uint8Array(l)),a([f,[...b]],l)}const p=[],g=a([d,p],l);for(const b of l)p.push(o(b));return g}case db:{if(f)switch(f){case"BigInt":return a([f,l.toString()],l);case"Boolean":case"Number":case"String":return a([f,l.valueOf()],l)}if(n&&"toJSON"in l)return o(l.toJSON());const p=[],g=a([d,p],l);for(const b of JV(l))(e||!Sx(Rm(l[b])))&&p.push([o(b),o(l[b])]);return g}case Ow:return a([d,l.toISOString()],l);case Lw:{const{source:p,flags:g}=l;return a([d,{source:p,flags:g}],l)}case Fw:{const p=[],g=a([d,p],l);for(const[b,v]of l)(e||!(Sx(Rm(b))||Sx(Rm(v))))&&p.push([o(b),o(v)]);return g}case $w:{const p=[],g=a([d,p],l);for(const b of l)(e||!Sx(Rm(b)))&&p.push(o(b));return g}}const{message:u}=l;return a([d,{name:f,message:u}],l)};return o},Sj=(e,{json:n,lossy:t}={})=>{const r=[];return KV(!(n||t),!!n,new Map,r)(e),r},fb=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?wj(Sj(e,n)):structuredClone(e):(e,n)=>wj(Sj(e,n));function XV(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function ZV(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function eH(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||XV,r=e.options.footnoteBackLabel||ZV,a=e.options.footnoteLabel||"Footnotes",o=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},d=[];let f=-1;for(;++f<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[f]);if(!u)continue;const p=e.all(u),g=String(u.identifier).toUpperCase(),b=Gh(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let M=typeof t=="string"?t:t(f,v);typeof M=="string"&&(M={type:"text",value:M}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(f,v),className:["data-footnote-backref"]},children:Array.isArray(M)?M:[M]})}const T=p[p.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const M=T.children[T.children.length-1];M&&M.type==="text"?M.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...S)}else p.push(...S);const P={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(p,!0)};e.patch(u,P),d.push(P)}if(d.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...fb(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(d,!0)},{type:"text",value:`
`}]}}const Ub=function(e){if(e==null)return iH;if(typeof e=="function")return Bb(e);if(typeof e=="object")return Array.isArray(e)?tH(e):nH(e);if(typeof e=="string")return rH(e);throw new Error("Expected function, string, or object as test")};function tH(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=Ub(e[t]);return Bb(r);function r(...a){let o=-1;for(;++o<n.length;)if(n[o].apply(this,a))return!0;return!1}}function nH(e){const n=e;return Bb(t);function t(r){const a=r;let o;for(o in e)if(a[o]!==n[o])return!1;return!0}}function rH(e){return Bb(n);function n(t){return t&&t.type===e}}function Bb(e){return n;function n(t,r,a){return!!(aH(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function iH(){return!0}function aH(e){return e!==null&&typeof e=="object"&&"type"in e}const zT=[],sH=!0,P1=!1,oH="skip";function UT(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const o=Ub(a),l=r?-1:1;d(e,void 0,[])();function d(f,u,p){const g=f&&typeof f=="object"?f:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(f.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=zT,S,k,T;if((!n||o(f,u,p[p.length-1]||void 0))&&(v=lH(t(f,p)),v[0]===P1))return v;if("children"in f&&f.children){const P=f;if(P.children&&v[0]!==oH)for(k=(r?P.children.length:-1)+l,T=p.concat(P);k>-1&&k<P.children.length;){const M=P.children[k];if(S=d(M,k,T)(),S[0]===P1)return S;k=typeof S[1]=="number"?S[1]:k+l}}return v}}}function lH(e){return Array.isArray(e)?e:typeof e=="number"?[sH,e]:e==null?zT:[e]}function zw(e,n,t,r){let a,o,l;typeof n=="function"?(o=void 0,l=n,a=t):(o=n,l=t,a=r),UT(e,o,d,a);function d(f,u){const p=u[u.length-1],g=p?p.children.indexOf(f):void 0;return l(f,g,p)}}const D1={}.hasOwnProperty,cH={};function uH(e,n){const t=n||cH,r=new Map,a=new Map,o=new Map,l={...YV,...t.handlers},d={all:u,applyData:fH,definitionById:r,footnoteById:a,footnoteCounts:o,footnoteOrder:[],handlers:l,one:f,options:t,patch:dH,wrap:pH};return zw(e,function(p){if(p.type==="definition"||p.type==="footnoteDefinition"){const g=p.type==="definition"?r:a,b=String(p.identifier).toUpperCase();g.has(b)||g.set(b,p)}}),d;function f(p,g){const b=p.type,v=d.handlers[b];if(D1.call(d.handlers,b)&&v)return v(d,p,g);if(d.options.passThrough&&d.options.passThrough.includes(b)){if("children"in p){const{children:k,...T}=p,P=fb(T);return P.children=d.all(p),P}return fb(p)}return(d.options.unknownHandler||hH)(d,p,g)}function u(p){const g=[];if("children"in p){const b=p.children;let v=-1;for(;++v<b.length;){const S=d.one(b[v],p);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=Nj(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=Nj(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function dH(e,n){e.position&&(n.position=Z9(e))}function fH(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,o=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const l="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:l}}t.type==="element"&&o&&Object.assign(t.properties,fb(o)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function hH(e,n){const t=n.data||{},r="value"in n&&!(D1.call(t,"hProperties")||D1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function pH(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function Nj(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function Cj(e,n){const t=uH(e,n),r=t.one(e,void 0),a=eH(t),o=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&o.children.push({type:"text",value:`
`},a),o}function mH(e,n){return e&&"run"in e?async function(t,r){const a=Cj(t,{file:r,...n});await e.run(a,r)}:function(t,r){return Cj(t,{file:r,...e||n})}}function jj(e){if(e)throw e}var x0,_j;function gH(){if(_j)return x0;_j=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(u){return typeof Array.isArray=="function"?Array.isArray(u):n.call(u)==="[object Array]"},o=function(u){if(!u||n.call(u)!=="[object Object]")return!1;var p=e.call(u,"constructor"),g=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!p&&!g)return!1;var b;for(b in u);return typeof b>"u"||e.call(u,b)},l=function(u,p){t&&p.name==="__proto__"?t(u,p.name,{enumerable:!0,configurable:!0,value:p.newValue,writable:!0}):u[p.name]=p.newValue},d=function(u,p){if(p==="__proto__")if(e.call(u,p)){if(r)return r(u,p).value}else return;return u[p]};return x0=function f(){var u,p,g,b,v,S,k=arguments[0],T=1,P=arguments.length,M=!1;for(typeof k=="boolean"&&(M=k,k=arguments[1]||{},T=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});T<P;++T)if(u=arguments[T],u!=null)for(p in u)g=d(k,p),b=d(u,p),k!==b&&(M&&b&&(o(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&o(g)?g:{},l(k,{name:p,newValue:f(M,S,b)})):typeof b<"u"&&l(k,{name:p,newValue:b}));return k},x0}var yH=gH();const b0=Ud(yH);function I1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function xH(){const e=[],n={run:t,use:r};return n;function t(...a){let o=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);d(null,...a);function d(f,...u){const p=e[++o];let g=-1;if(f){l(f);return}for(;++g<a.length;)(u[g]===null||u[g]===void 0)&&(u[g]=a[g]);a=u,p?bH(p,d)(...u):l(null,...u)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function bH(e,n){let t;return r;function r(...l){const d=e.length>l.length;let f;d&&l.push(a);try{f=e.apply(this,l)}catch(u){const p=u;if(d&&t)throw p;return a(p)}d||(f&&f.then&&typeof f.then=="function"?f.then(o,a):f instanceof Error?a(f):o(f))}function a(l,...d){t||(t=!0,n(l,...d))}function o(l){a(null,l)}}const Bo={basename:vH,dirname:wH,extname:SH,join:NH,sep:"/"};function vH(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');dg(e);let t=0,r=-1,a=e.length,o;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else r<0&&(o=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let l=-1,d=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else l<0&&(o=!0,l=a+1),d>-1&&(e.codePointAt(a)===n.codePointAt(d--)?d<0&&(r=a):(d=-1,r=l));return t===r?r=l:r<0&&(r=e.length),e.slice(t,r)}function wH(e){if(dg(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function SH(e){dg(e);let n=e.length,t=-1,r=0,a=-1,o=0,l;for(;n--;){const d=e.codePointAt(n);if(d===47){if(l){r=n+1;break}continue}t<0&&(l=!0,t=n+1),d===46?a<0?a=n:o!==1&&(o=1):a>-1&&(o=-1)}return a<0||t<0||o===0||o===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function NH(...e){let n=-1,t;for(;++n<e.length;)dg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":CH(t)}function CH(e){dg(e);const n=e.codePointAt(0)===47;let t=jH(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function jH(e,n){let t="",r=0,a=-1,o=0,l=-1,d,f;for(;++l<=e.length;){if(l<e.length)d=e.codePointAt(l);else{if(d===47)break;d=47}if(d===47){if(!(a===l-1||o===1))if(a!==l-1&&o===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(f=t.lastIndexOf("/"),f!==t.length-1){f<0?(t="",r=0):(t=t.slice(0,f),r=t.length-1-t.lastIndexOf("/")),a=l,o=0;continue}}else if(t.length>0){t="",r=0,a=l,o=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,l):t=e.slice(a+1,l),r=l-a-1;a=l,o=0}else d===46&&o>-1?o++:o=-1}return t}function dg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const _H={cwd:kH};function kH(){return"/"}function R1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function TH(e){if(typeof e=="string")e=new URL(e);else if(!R1(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return EH(e)}function EH(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const v0=["history","path","basename","stem","extname","dirname"];let BT=class{constructor(n){let t;n?R1(n)?t={path:n}:typeof n=="string"||AH(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":_H.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<v0.length;){const o=v0[r];o in t&&t[o]!==void 0&&t[o]!==null&&(this[o]=o==="history"?[...t[o]]:t[o])}let a;for(a in t)v0.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?Bo.basename(this.path):void 0}set basename(n){S0(n,"basename"),w0(n,"basename"),this.path=Bo.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?Bo.dirname(this.path):void 0}set dirname(n){kj(this.basename,"dirname"),this.path=Bo.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?Bo.extname(this.path):void 0}set extname(n){if(w0(n,"extname"),kj(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Bo.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){R1(n)&&(n=TH(n)),S0(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?Bo.basename(this.path,this.extname):void 0}set stem(n){S0(n,"stem"),w0(n,"stem"),this.path=Bo.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new ki(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}};function w0(e,n){if(e&&e.includes(Bo.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+Bo.sep+"`")}function S0(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function kj(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function AH(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const PH=function(e){const r=this.constructor.prototype,a=r[e],o=function(){return a.apply(o,arguments)};return Object.setPrototypeOf(o,r),o},DH={}.hasOwnProperty;let IH=class qT extends PH{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=xH()}copy(){const n=new qT;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data(b0(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(j0("data",this.frozen),this.namespace[n]=t,this):DH.call(this.namespace,n)&&this.namespace[n]||void 0:n?(j0("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=Nx(n),r=this.parser||this.Parser;return N0("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),N0("process",this.parser||this.Parser),C0("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(o,l){const d=Nx(n),f=r.parse(d);r.run(f,d,function(p,g,b){if(p||!g||!b)return u(p);const v=g,S=r.stringify(v,b);OH(S)?b.value=S:b.result=S,u(p,b)});function u(p,g){p||!g?l(p):o?o(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),N0("processSync",this.parser||this.Parser),C0("processSync",this.compiler||this.Compiler),this.process(n,a),Ej("processSync","process",t),r;function a(o,l){t=!0,jj(o),r=l}}run(n,t,r){Tj(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?o(void 0,r):new Promise(o);function o(l,d){const f=Nx(t);a.run(n,f,u);function u(p,g,b){const v=g||n;p?d(p):l?l(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,o),Ej("runSync","run",r),a;function o(l,d){jj(l),a=d,r=!0}}stringify(n,t){this.freeze();const r=Nx(t),a=this.compiler||this.Compiler;return C0("stringify",a),Tj(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(j0("use",this.frozen),n!=null)if(typeof n=="function")f(n,t);else if(typeof n=="object")Array.isArray(n)?d(n):l(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function o(u){if(typeof u=="function")f(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[p,...g]=u;f(p,g)}else l(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function l(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");d(u.plugins),u.settings&&(a.settings=b0(!0,a.settings,u.settings))}function d(u){let p=-1;if(u!=null)if(Array.isArray(u))for(;++p<u.length;){const g=u[p];o(g)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function f(u,p){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===u){b=g;break}if(b===-1)r.push([u,...p]);else if(p.length>0){let[v,...S]=p;const k=r[b][1];I1(k)&&I1(v)&&(v=b0(!0,k,v)),r[b]=[u,v,...S]}}}};const RH=new IH().freeze();function N0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function C0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function j0(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function Tj(e){if(!I1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function Ej(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function Nx(e){return MH(e)?e:new BT(e)}function MH(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function OH(e){return typeof e=="string"||LH(e)}function LH(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const FH="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",Aj=[],Pj={allowDangerousHtml:!0},$H=/^(https?|ircs?|mailto|xmpp)$/i,zH=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Yo(e){const n=UH(e),t=BH(e);return qH(n.runSync(n.parse(t),t),e)}function UH(e){const n=e.rehypePlugins||Aj,t=e.remarkPlugins||Aj,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...Pj}:Pj;return RH().use(wV).use(t).use(mH,r).use(n)}function BH(e){const n=e.children||"",t=new BT;return typeof n=="string"&&(t.value=n),t}function qH(e,n){const t=n.allowedElements,r=n.allowElement,a=n.components,o=n.disallowedElements,l=n.skipHtml,d=n.unwrapDisallowed,f=n.urlTransform||VH;for(const p of zH)Object.hasOwn(n,p.from)&&(""+p.from+(p.to?"use `"+p.to+"` instead":"remove it")+FH+p.id,void 0);return zw(e,u),iq(e,{Fragment:i.Fragment,components:a,ignoreInvalidStyle:!0,jsx:i.jsx,jsxs:i.jsxs,passKeys:!0,passNode:!0});function u(p,g,b){if(p.type==="raw"&&b&&typeof g=="number")return l?b.children.splice(g,1):b.children[g]={type:"text",value:p.value},g;if(p.type==="element"){let v;for(v in m0)if(Object.hasOwn(m0,v)&&Object.hasOwn(p.properties,v)){const S=p.properties[v],k=m0[v];(k===null||k.includes(p.tagName))&&(p.properties[v]=f(String(S||""),v,p))}}if(p.type==="element"){let v=t?!t.includes(p.tagName):o?o.includes(p.tagName):!1;if(!v&&r&&typeof g=="number"&&(v=!r(p,g,b)),v&&b&&typeof g=="number")return d&&p.children?b.children.splice(g,1,...p.children):b.children.splice(g,1),g}}}function VH(e){const n=e.indexOf(":"),t=e.indexOf("?"),r=e.indexOf("#"),a=e.indexOf("/");return n===-1||a!==-1&&n>a||t!==-1&&n>t||r!==-1&&n>r||$H.test(e.slice(0,n))?e:""}function Dj(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function HH(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function GH(e,n,t){const a=Ub((t||{}).ignore||[]),o=YH(n);let l=-1;for(;++l<o.length;)UT(e,"text",d);function d(u,p){let g=-1,b;for(;++g<p.length;){const v=p[g],S=b?b.children:void 0;if(a(v,S?S.indexOf(v):void 0,b))return;b=v}if(b)return f(u,p)}function f(u,p){const g=p[p.length-1],b=o[l][0],v=o[l][1];let S=0;const T=g.children.indexOf(u);let P=!1,M=[];b.lastIndex=0;let I=b.exec(u.value);for(;I;){const U=I.index,L={index:I.index,input:I.input,stack:[...p,u]};let $=v(...I,L);if(typeof $=="string"&&($=$.length>0?{type:"text",value:$}:void 0),$===!1?b.lastIndex=U+1:(S!==U&&M.push({type:"text",value:u.value.slice(S,U)}),Array.isArray($)?M.push(...$):$&&M.push($),S=U+I[0].length,P=!0),!b.global)break;I=b.exec(u.value)}return P?(S<u.value.length&&M.push({type:"text",value:u.value.slice(S)}),g.children.splice(T,1,...M)):M=[u],T+M.length}}function YH(e){const n=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const t=!e[0]||Array.isArray(e[0])?e:[e];let r=-1;for(;++r<t.length;){const a=t[r];n.push([WH(a[0]),QH(a[1])])}return n}function WH(e){return typeof e=="string"?new RegExp(HH(e),"g"):e}function QH(e){return typeof e=="function"?e:function(){return e}}const _0="phrasing",k0=["autolink","link","image","label"];function JH(){return{transforms:[rG],enter:{literalAutolink:XH,literalAutolinkEmail:T0,literalAutolinkHttp:T0,literalAutolinkWww:T0},exit:{literalAutolink:nG,literalAutolinkEmail:tG,literalAutolinkHttp:ZH,literalAutolinkWww:eG}}}function KH(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:_0,notInConstruct:k0},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:_0,notInConstruct:k0},{character:":",before:"[ps]",after:"\\/",inConstruct:_0,notInConstruct:k0}]}}function XH(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function T0(e){this.config.enter.autolinkProtocol.call(this,e)}function ZH(e){this.config.exit.autolinkProtocol.call(this,e)}function eG(e){this.config.exit.data.call(this,e);const n=this.stack[this.stack.length-1];n.type,n.url="http://"+this.sliceSerialize(e)}function tG(e){this.config.exit.autolinkEmail.call(this,e)}function nG(e){this.exit(e)}function rG(e){GH(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,iG],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),aG]],{ignore:["link","linkReference"]})}function iG(e,n,t,r,a){let o="";if(!VT(a)||(/^w/i.test(n)&&(t=n+t,n="",o="http://"),!sG(t)))return!1;const l=oG(t+r);if(!l[0])return!1;const d={type:"link",title:null,url:o+n+l[0],children:[{type:"text",value:n+l[0]}]};return l[1]?[d,{type:"text",value:l[1]}]:d}function aG(e,n,t,r){return!VT(r,!0)||/[-\d_]$/.test(t)?!1:{type:"link",title:null,url:"mailto:"+n+"@"+t,children:[{type:"text",value:n+"@"+t}]}}function sG(e){const n=e.split(".");return!(n.length<2||n[n.length-1]&&(/_/.test(n[n.length-1])||!/[a-zA-Z\d]/.test(n[n.length-1]))||n[n.length-2]&&(/_/.test(n[n.length-2])||!/[a-zA-Z\d]/.test(n[n.length-2])))}function oG(e){const n=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!n)return[e,void 0];e=e.slice(0,n.index);let t=n[0],r=t.indexOf(")");const a=Dj(e,"(");let o=Dj(e,")");for(;r!==-1&&a>o;)e+=t.slice(0,r+1),t=t.slice(r+1),r=t.indexOf(")"),o++;return[e,t]}function VT(e,n){const t=e.input.charCodeAt(e.index-1);return(e.index===0||$d(t)||Fb(t))&&(!n||t!==47)}HT.peek=gG;function lG(){this.buffer()}function cG(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function uG(){this.buffer()}function dG(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function fG(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=qs(this.sliceSerialize(e)).toLowerCase(),t.label=n}function hG(e){this.exit(e)}function pG(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=qs(this.sliceSerialize(e)).toLowerCase(),t.label=n}function mG(e){this.exit(e)}function gG(){return"["}function HT(e,n,t,r){const a=t.createTracker(r);let o=a.move("[^");const l=t.enter("footnoteReference"),d=t.enter("reference");return o+=a.move(t.safe(t.associationId(e),{after:"]",before:o})),d(),l(),o+=a.move("]"),o}function yG(){return{enter:{gfmFootnoteCallString:lG,gfmFootnoteCall:cG,gfmFootnoteDefinitionLabelString:uG,gfmFootnoteDefinition:dG},exit:{gfmFootnoteCallString:fG,gfmFootnoteCall:hG,gfmFootnoteDefinitionLabelString:pG,gfmFootnoteDefinition:mG}}}function xG(e){let n=!1;return e&&e.firstLineBlank&&(n=!0),{handlers:{footnoteDefinition:t,footnoteReference:HT},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function t(r,a,o,l){const d=o.createTracker(l);let f=d.move("[^");const u=o.enter("footnoteDefinition"),p=o.enter("label");return f+=d.move(o.safe(o.associationId(r),{before:f,after:"]"})),p(),f+=d.move("]:"),r.children&&r.children.length>0&&(d.shift(4),f+=d.move((n?`
`:" ")+o.indentLines(o.containerFlow(r,d.current()),n?GT:bG))),u(),f}}function bG(e,n,t){return n===0?e:GT(e,n,t)}function GT(e,n,t){return(t?"":"    ")+e}const vG=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];YT.peek=jG;function wG(){return{canContainEols:["delete"],enter:{strikethrough:NG},exit:{strikethrough:CG}}}function SG(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:vG}],handlers:{delete:YT}}}function NG(e){this.enter({type:"delete",children:[]},e)}function CG(e){this.exit(e)}function YT(e,n,t,r){const a=t.createTracker(r),o=t.enter("strikethrough");let l=a.move("~~");return l+=t.containerPhrasing(e,{...a.current(),before:l,after:"~"}),l+=a.move("~~"),o(),l}function jG(){return"~"}function _G(e){return e.length}function kG(e,n){const t=n||{},r=(t.align||[]).concat(),a=t.stringLength||_G,o=[],l=[],d=[],f=[];let u=0,p=-1;for(;++p<e.length;){const k=[],T=[];let P=-1;for(e[p].length>u&&(u=e[p].length);++P<e[p].length;){const M=TG(e[p][P]);if(t.alignDelimiters!==!1){const I=a(M);T[P]=I,(f[P]===void 0||I>f[P])&&(f[P]=I)}k.push(M)}l[p]=k,d[p]=T}let g=-1;if(typeof r=="object"&&"length"in r)for(;++g<u;)o[g]=Ij(r[g]);else{const k=Ij(r);for(;++g<u;)o[g]=k}g=-1;const b=[],v=[];for(;++g<u;){const k=o[g];let T="",P="";k===99?(T=":",P=":"):k===108?T=":":k===114&&(P=":");let M=t.alignDelimiters===!1?1:Math.max(1,f[g]-T.length-P.length);const I=T+"-".repeat(M)+P;t.alignDelimiters!==!1&&(M=T.length+M+P.length,M>f[g]&&(f[g]=M),v[g]=M),b[g]=I}l.splice(1,0,b),d.splice(1,0,v),p=-1;const S=[];for(;++p<l.length;){const k=l[p],T=d[p];g=-1;const P=[];for(;++g<u;){const M=k[g]||"";let I="",U="";if(t.alignDelimiters!==!1){const L=f[g]-(T[g]||0),$=o[g];$===114?I=" ".repeat(L):$===99?L%2?(I=" ".repeat(L/2+.5),U=" ".repeat(L/2-.5)):(I=" ".repeat(L/2),U=I):U=" ".repeat(L)}t.delimiterStart!==!1&&!g&&P.push("|"),t.padding!==!1&&!(t.alignDelimiters===!1&&M==="")&&(t.delimiterStart!==!1||g)&&P.push(" "),t.alignDelimiters!==!1&&P.push(I),P.push(M),t.alignDelimiters!==!1&&P.push(U),t.padding!==!1&&P.push(" "),(t.delimiterEnd!==!1||g!==u-1)&&P.push("|")}S.push(t.delimiterEnd===!1?P.join("").replace(/ +$/,""):P.join(""))}return S.join(`
`)}function TG(e){return e==null?"":String(e)}function Ij(e){const n=typeof e=="string"?e.codePointAt(0):0;return n===67||n===99?99:n===76||n===108?108:n===82||n===114?114:0}function EG(e,n,t,r){const a=t.enter("blockquote"),o=t.createTracker(r);o.move("> "),o.shift(2);const l=t.indentLines(t.containerFlow(e,o.current()),AG);return a(),l}function AG(e,n,t){return">"+(t?"":" ")+e}function PG(e,n){return Rj(e,n.inConstruct,!0)&&!Rj(e,n.notInConstruct,!1)}function Rj(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function Mj(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&PG(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function DG(e,n){const t=String(e);let r=t.indexOf(n),a=r,o=0,l=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++o>l&&(l=o):o=1,a=r+n.length,r=t.indexOf(n,a);return l}function IG(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function RG(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function MG(e,n,t,r){const a=RG(t),o=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if(IG(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(o,OG);return g(),b}const d=t.createTracker(r),f=a.repeat(Math.max(DG(o,a)+1,3)),u=t.enter("codeFenced");let p=d.move(f);if(e.lang){const g=t.enter(`codeFencedLang${l}`);p+=d.move(t.safe(e.lang,{before:p,after:" ",encode:["`"],...d.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${l}`);p+=d.move(" "),p+=d.move(t.safe(e.meta,{before:p,after:`
`,encode:["`"],...d.current()})),g()}return p+=d.move(`
`),o&&(p+=d.move(o+`
`)),p+=d.move(f),u(),p}function OG(e,n,t){return(t?"":"    ")+e}function Uw(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function LG(e,n,t,r){const a=Uw(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("definition");let d=t.enter("label");const f=t.createTracker(r);let u=f.move("[");return u+=f.move(t.safe(t.associationId(e),{before:u,after:"]",...f.current()})),u+=f.move("]: "),d(),!e.url||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":`
`,...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),l(),u}function FG(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function eg(e){return"&#x"+e.toString(16).toUpperCase()+";"}function hb(e,n,t){const r=Rh(e),a=Rh(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}WT.peek=$G;function WT(e,n,t,r){const a=FG(t),o=t.enter("emphasis"),l=t.createTracker(r),d=l.move(a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),p=hb(r.before.charCodeAt(r.before.length-1),u,a);p.inside&&(f=eg(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=hb(r.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+eg(g));const v=l.move(a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:p.outside},d+f+v}function $G(e,n,t){return t.options.emphasis||"*"}function zG(e,n){let t=!1;return zw(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,P1}),!!((!e.depth||e.depth<3)&&Iw(e)&&(n.options.setext||t))}function UG(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),o=t.createTracker(r);if(zG(e,t)){const p=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...o.current(),before:`
`,after:`
`});return g(),p(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const l="#".repeat(a),d=t.enter("headingAtx"),f=t.enter("phrasing");o.move(l+" ");let u=t.containerPhrasing(e,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(u)&&(u=eg(u.charCodeAt(0))+u.slice(1)),u=u?l+" "+u:l,t.options.closeAtx&&(u+=" "+l),f(),d(),u}QT.peek=BG;function QT(e){return e.value||""}function BG(){return"<"}JT.peek=qG;function JT(e,n,t,r){const a=Uw(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("image");let d=t.enter("label");const f=t.createTracker(r);let u=f.move("![");return u+=f.move(t.safe(e.alt,{before:u,after:"]",...f.current()})),u+=f.move("]("),d(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":")",...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),u+=f.move(")"),l(),u}function qG(){return"!"}KT.peek=VG;function KT(e,n,t,r){const a=e.referenceType,o=t.enter("imageReference");let l=t.enter("label");const d=t.createTracker(r);let f=d.move("![");const u=t.safe(e.alt,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const p=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=p,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function VG(){return"!"}XT.peek=HG;function XT(e,n,t){let r=e.value||"",a="`",o=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++o<t.unsafe.length;){const l=t.unsafe[o],d=t.compilePattern(l);let f;if(l.atBreak)for(;f=d.exec(r);){let u=f.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(f.index+1)}}return a+r+a}function HG(){return"`"}function ZT(e,n){const t=Iw(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}eE.peek=GG;function eE(e,n,t,r){const a=Uw(t),o=a==='"'?"Quote":"Apostrophe",l=t.createTracker(r);let d,f;if(ZT(e,t)){const p=t.stack;t.stack=[],d=t.enter("autolink");let g=l.move("<");return g+=l.move(t.containerPhrasing(e,{before:g,after:">",...l.current()})),g+=l.move(">"),d(),t.stack=p,g}d=t.enter("link"),f=t.enter("label");let u=l.move("[");return u+=l.move(t.containerPhrasing(e,{before:u,after:"](",...l.current()})),u+=l.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(t.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(f=t.enter("destinationRaw"),u+=l.move(t.safe(e.url,{before:u,after:e.title?" ":")",...l.current()}))),f(),e.title&&(f=t.enter(`title${o}`),u+=l.move(" "+a),u+=l.move(t.safe(e.title,{before:u,after:a,...l.current()})),u+=l.move(a),f()),u+=l.move(")"),d(),u}function GG(e,n,t){return ZT(e,t)?"<":"["}tE.peek=YG;function tE(e,n,t,r){const a=e.referenceType,o=t.enter("linkReference");let l=t.enter("label");const d=t.createTracker(r);let f=d.move("[");const u=t.containerPhrasing(e,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const p=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=p,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function YG(){return"["}function Bw(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function WG(e){const n=Bw(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function QG(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function nE(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function JG(e,n,t,r){const a=t.enter("list"),o=t.bulletCurrent;let l=e.ordered?QG(t):Bw(t);const d=e.ordered?l==="."?")":".":WG(t);let f=n&&t.bulletLastUsed?l===t.bulletLastUsed:!1;if(!e.ordered){const p=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&p&&(!p.children||!p.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(f=!0),nE(t)===l&&p){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){f=!0;break}}}}f&&(l=d),t.bulletCurrent=l;const u=t.containerFlow(e,r);return t.bulletLastUsed=l,t.bulletCurrent=o,a(),u}function KG(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function XG(e,n,t,r){const a=KG(t);let o=t.bulletCurrent||Bw(t);n&&n.type==="list"&&n.ordered&&(o=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+o);let l=o.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(l=Math.ceil(l/4)*4);const d=t.createTracker(r);d.move(o+" ".repeat(l-o.length)),d.shift(l);const f=t.enter("listItem"),u=t.indentLines(t.containerFlow(e,d.current()),p);return f(),u;function p(g,b,v){return b?(v?"":" ".repeat(l))+g:(v?o:o+" ".repeat(l-o.length))+g}}function ZG(e,n,t,r){const a=t.enter("paragraph"),o=t.enter("phrasing"),l=t.containerPhrasing(e,r);return o(),a(),l}const eY=Ub(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function tY(e,n,t,r){return(e.children.some(function(l){return eY(l)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function nY(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}rE.peek=rY;function rE(e,n,t,r){const a=nY(t),o=t.enter("strong"),l=t.createTracker(r),d=l.move(a+a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),p=hb(r.before.charCodeAt(r.before.length-1),u,a);p.inside&&(f=eg(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=hb(r.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+eg(g));const v=l.move(a+a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:p.outside},d+f+v}function rY(e,n,t){return t.options.strong||"*"}function iY(e,n,t,r){return t.safe(e.value,r)}function aY(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function sY(e,n,t){const r=(nE(t)+(t.options.ruleSpaces?" ":"")).repeat(aY(t));return t.options.ruleSpaces?r.slice(0,-1):r}const iE={blockquote:EG,break:Mj,code:MG,definition:LG,emphasis:WT,hardBreak:Mj,heading:UG,html:QT,image:JT,imageReference:KT,inlineCode:XT,link:eE,linkReference:tE,list:JG,listItem:XG,paragraph:ZG,root:tY,strong:rE,text:iY,thematicBreak:sY};function oY(){return{enter:{table:lY,tableData:Oj,tableHeader:Oj,tableRow:uY},exit:{codeText:dY,table:cY,tableData:E0,tableHeader:E0,tableRow:E0}}}function lY(e){const n=e._align;this.enter({type:"table",align:n.map(function(t){return t==="none"?null:t}),children:[]},e),this.data.inTable=!0}function cY(e){this.exit(e),this.data.inTable=void 0}function uY(e){this.enter({type:"tableRow",children:[]},e)}function E0(e){this.exit(e)}function Oj(e){this.enter({type:"tableCell",children:[]},e)}function dY(e){let n=this.resume();this.data.inTable&&(n=n.replace(/\\([\\|])/g,fY));const t=this.stack[this.stack.length-1];t.type,t.value=n,this.exit(e)}function fY(e,n){return n==="|"?n:e}function hY(e){const n=e||{},t=n.tableCellPadding,r=n.tablePipeAlign,a=n.stringLength,o=t?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:b,table:l,tableCell:f,tableRow:d}};function l(v,S,k,T){return u(p(v,k,T),v.align)}function d(v,S,k,T){const P=g(v,k,T),M=u([P]);return M.slice(0,M.indexOf(`
`))}function f(v,S,k,T){const P=k.enter("tableCell"),M=k.enter("phrasing"),I=k.containerPhrasing(v,{...T,before:o,after:o});return M(),P(),I}function u(v,S){return kG(v,{align:S,alignDelimiters:r,padding:t,stringLength:a})}function p(v,S,k){const T=v.children;let P=-1;const M=[],I=S.enter("table");for(;++P<T.length;)M[P]=g(T[P],S,k);return I(),M}function g(v,S,k){const T=v.children;let P=-1;const M=[],I=S.enter("tableRow");for(;++P<T.length;)M[P]=f(T[P],v,S,k);return I(),M}function b(v,S,k){let T=iE.inlineCode(v,S,k);return k.stack.includes("tableCell")&&(T=T.replace(/\|/g,"\\$&")),T}}function pY(){return{exit:{taskListCheckValueChecked:Lj,taskListCheckValueUnchecked:Lj,paragraph:gY}}}function mY(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:yY}}}function Lj(e){const n=this.stack[this.stack.length-2];n.type,n.checked=e.type==="taskListCheckValueChecked"}function gY(e){const n=this.stack[this.stack.length-2];if(n&&n.type==="listItem"&&typeof n.checked=="boolean"){const t=this.stack[this.stack.length-1];t.type;const r=t.children[0];if(r&&r.type==="text"){const a=n.children;let o=-1,l;for(;++o<a.length;){const d=a[o];if(d.type==="paragraph"){l=d;break}}l===t&&(r.value=r.value.slice(1),r.value.length===0?t.children.shift():t.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,t.position.start=Object.assign({},r.position.start)))}}this.exit(e)}function yY(e,n,t,r){const a=e.children[0],o=typeof e.checked=="boolean"&&a&&a.type==="paragraph",l="["+(e.checked?"x":" ")+"] ",d=t.createTracker(r);o&&d.move(l);let f=iE.listItem(e,n,t,{...r,...d.current()});return o&&(f=f.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,u)),f;function u(p){return p+l}}function xY(){return[JH(),yG(),wG(),oY(),pY()]}function bY(e){return{extensions:[KH(),xG(e),SG(),hY(e),mY()]}}const vY={tokenize:_Y,partial:!0},aE={tokenize:kY,partial:!0},sE={tokenize:TY,partial:!0},oE={tokenize:EY,partial:!0},wY={tokenize:AY,partial:!0},lE={name:"wwwAutolink",tokenize:CY,previous:uE},cE={name:"protocolAutolink",tokenize:jY,previous:dE},Xl={name:"emailAutolink",tokenize:NY,previous:fE},Zo={};function SY(){return{text:Zo}}let Td=48;for(;Td<123;)Zo[Td]=Xl,Td++,Td===58?Td=65:Td===91&&(Td=97);Zo[43]=Xl;Zo[45]=Xl;Zo[46]=Xl;Zo[95]=Xl;Zo[72]=[Xl,cE];Zo[104]=[Xl,cE];Zo[87]=[Xl,lE];Zo[119]=[Xl,lE];function NY(e,n,t){const r=this;let a,o;return l;function l(g){return!M1(g)||!fE.call(r,r.previous)||qw(r.events)?t(g):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),d(g))}function d(g){return M1(g)?(e.consume(g),d):g===64?(e.consume(g),f):t(g)}function f(g){return g===46?e.check(wY,p,u)(g):g===45||g===95||ji(g)?(o=!0,e.consume(g),f):p(g)}function u(g){return e.consume(g),a=!0,f}function p(g){return o&&a&&qi(r.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),n(g)):t(g)}}function CY(e,n,t){const r=this;return a;function a(l){return l!==87&&l!==119||!uE.call(r,r.previous)||qw(r.events)?t(l):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(vY,e.attempt(aE,e.attempt(sE,o),t),t)(l))}function o(l){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),n(l)}}function jY(e,n,t){const r=this;let a="",o=!1;return l;function l(g){return(g===72||g===104)&&dE.call(r,r.previous)&&!qw(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),a+=String.fromCodePoint(g),e.consume(g),d):t(g)}function d(g){if(qi(g)&&a.length<5)return a+=String.fromCodePoint(g),e.consume(g),d;if(g===58){const b=a.toLowerCase();if(b==="http"||b==="https")return e.consume(g),f}return t(g)}function f(g){return g===47?(e.consume(g),o?u:(o=!0,f)):t(g)}function u(g){return g===null||ub(g)||Zn(g)||$d(g)||Fb(g)?t(g):e.attempt(aE,e.attempt(sE,p),t)(g)}function p(g){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),n(g)}}function _Y(e,n,t){let r=0;return a;function a(l){return(l===87||l===119)&&r<3?(r++,e.consume(l),a):l===46&&r===3?(e.consume(l),o):t(l)}function o(l){return l===null?t(l):n(l)}}function kY(e,n,t){let r,a,o;return l;function l(u){return u===46||u===95?e.check(oE,f,d)(u):u===null||Zn(u)||$d(u)||u!==45&&Fb(u)?f(u):(o=!0,e.consume(u),l)}function d(u){return u===95?r=!0:(a=r,r=void 0),e.consume(u),l}function f(u){return a||r||!o?t(u):n(u)}}function TY(e,n){let t=0,r=0;return a;function a(l){return l===40?(t++,e.consume(l),a):l===41&&r<t?o(l):l===33||l===34||l===38||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===60||l===63||l===93||l===95||l===126?e.check(oE,n,o)(l):l===null||Zn(l)||$d(l)?n(l):(e.consume(l),a)}function o(l){return l===41&&r++,e.consume(l),a}}function EY(e,n,t){return r;function r(d){return d===33||d===34||d===39||d===41||d===42||d===44||d===46||d===58||d===59||d===63||d===95||d===126?(e.consume(d),r):d===38?(e.consume(d),o):d===93?(e.consume(d),a):d===60||d===null||Zn(d)||$d(d)?n(d):t(d)}function a(d){return d===null||d===40||d===91||Zn(d)||$d(d)?n(d):r(d)}function o(d){return qi(d)?l(d):t(d)}function l(d){return d===59?(e.consume(d),r):qi(d)?(e.consume(d),l):t(d)}}function AY(e,n,t){return r;function r(o){return e.consume(o),a}function a(o){return ji(o)?t(o):n(o)}}function uE(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||Zn(e)}function dE(e){return!qi(e)}function fE(e){return!(e===47||M1(e))}function M1(e){return e===43||e===45||e===46||e===95||ji(e)}function qw(e){let n=e.length,t=!1;for(;n--;){const r=e[n][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){t=!0;break}if(r._gfmAutolinkLiteralWalkedInto){t=!1;break}}return e.length>0&&!t&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),t}const PY={tokenize:$Y,partial:!0};function DY(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:OY,continuation:{tokenize:LY},exit:FY}},text:{91:{name:"gfmFootnoteCall",tokenize:MY},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:IY,resolveTo:RY}}}}function IY(e,n,t){const r=this;let a=r.events.length;const o=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let l;for(;a--;){const f=r.events[a][1];if(f.type==="labelImage"){l=f;break}if(f.type==="gfmFootnoteCall"||f.type==="labelLink"||f.type==="label"||f.type==="image"||f.type==="link")break}return d;function d(f){if(!l||!l._balanced)return t(f);const u=qs(r.sliceSerialize({start:l.end,end:r.now()}));return u.codePointAt(0)!==94||!o.includes(u.slice(1))?t(f):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(f),e.exit("gfmFootnoteCallLabelMarker"),n(f))}}function RY(e,n){let t=e.length;for(;t--;)if(e[t][1].type==="labelImage"&&e[t][0]==="enter"){e[t][1];break}e[t+1][1].type="data",e[t+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[t+3][1].start),end:Object.assign({},e[e.length-1][1].end)},a={type:"gfmFootnoteCallMarker",start:Object.assign({},e[t+3][1].end),end:Object.assign({},e[t+3][1].end)};a.end.column++,a.end.offset++,a.end._bufferIndex++;const o={type:"gfmFootnoteCallString",start:Object.assign({},a.end),end:Object.assign({},e[e.length-1][1].start)},l={type:"chunkString",contentType:"string",start:Object.assign({},o.start),end:Object.assign({},o.end)},d=[e[t+1],e[t+2],["enter",r,n],e[t+3],e[t+4],["enter",a,n],["exit",a,n],["enter",o,n],["enter",l,n],["exit",l,n],["exit",o,n],e[e.length-2],e[e.length-1],["exit",r,n]];return e.splice(t,e.length-t+1,...d),e}function MY(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o=0,l;return d;function d(g){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),f}function f(g){return g!==94?t(g):(e.enter("gfmFootnoteCallMarker"),e.consume(g),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",u)}function u(g){if(o>999||g===93&&!l||g===null||g===91||Zn(g))return t(g);if(g===93){e.exit("chunkString");const b=e.exit("gfmFootnoteCallString");return a.includes(qs(r.sliceSerialize(b)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),n):t(g)}return Zn(g)||(l=!0),o++,e.consume(g),g===92?p:u}function p(g){return g===91||g===92||g===93?(e.consume(g),o++,u):u(g)}}function OY(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o,l=0,d;return f;function f(S){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),u}function u(S){return S===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",p):t(S)}function p(S){if(l>999||S===93&&!d||S===null||S===91||Zn(S))return t(S);if(S===93){e.exit("chunkString");const k=e.exit("gfmFootnoteDefinitionLabelString");return o=qs(r.sliceSerialize(k)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),b}return Zn(S)||(d=!0),l++,e.consume(S),S===92?g:p}function g(S){return S===91||S===92||S===93?(e.consume(S),l++,p):p(S)}function b(S){return S===58?(e.enter("definitionMarker"),e.consume(S),e.exit("definitionMarker"),a.includes(o)||a.push(o),_n(e,v,"gfmFootnoteDefinitionWhitespace")):t(S)}function v(S){return n(S)}}function LY(e,n,t){return e.check(ug,n,e.attempt(PY,n,t))}function FY(e){e.exit("gfmFootnoteDefinition")}function $Y(e,n,t){const r=this;return _n(e,a,"gfmFootnoteDefinitionIndent",5);function a(o){const l=r.events[r.events.length-1];return l&&l[1].type==="gfmFootnoteDefinitionIndent"&&l[2].sliceSerialize(l[1],!0).length===4?n(o):t(o)}}function zY(e){let t=(e||{}).singleTilde;const r={name:"strikethrough",tokenize:o,resolveAll:a};return t==null&&(t=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function a(l,d){let f=-1;for(;++f<l.length;)if(l[f][0]==="enter"&&l[f][1].type==="strikethroughSequenceTemporary"&&l[f][1]._close){let u=f;for(;u--;)if(l[u][0]==="exit"&&l[u][1].type==="strikethroughSequenceTemporary"&&l[u][1]._open&&l[f][1].end.offset-l[f][1].start.offset===l[u][1].end.offset-l[u][1].start.offset){l[f][1].type="strikethroughSequence",l[u][1].type="strikethroughSequence";const p={type:"strikethrough",start:Object.assign({},l[u][1].start),end:Object.assign({},l[f][1].end)},g={type:"strikethroughText",start:Object.assign({},l[u][1].end),end:Object.assign({},l[f][1].start)},b=[["enter",p,d],["enter",l[u][1],d],["exit",l[u][1],d],["enter",g,d]],v=d.parser.constructs.insideSpan.null;v&&Oa(b,b.length,0,$b(v,l.slice(u+1,f),d)),Oa(b,b.length,0,[["exit",g,d],["enter",l[f][1],d],["exit",l[f][1],d],["exit",p,d]]),Oa(l,u-1,f-u+3,b),f=u+b.length-2;break}}for(f=-1;++f<l.length;)l[f][1].type==="strikethroughSequenceTemporary"&&(l[f][1].type="data");return l}function o(l,d,f){const u=this.previous,p=this.events;let g=0;return b;function b(S){return u===126&&p[p.length-1][1].type!=="characterEscape"?f(S):(l.enter("strikethroughSequenceTemporary"),v(S))}function v(S){const k=Rh(u);if(S===126)return g>1?f(S):(l.consume(S),g++,v);if(g<2&&!t)return f(S);const T=l.exit("strikethroughSequenceTemporary"),P=Rh(S);return T._open=!P||P===2&&!!k,T._close=!k||k===2&&!!P,d(S)}}}class UY{constructor(){this.map=[]}add(n,t,r){BY(this,n,t,r)}consume(n){if(this.map.sort(function(o,l){return o[0]-l[0]}),this.map.length===0)return;let t=this.map.length;const r=[];for(;t>0;)t-=1,r.push(n.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),n.length=this.map[t][0];r.push(n.slice()),n.length=0;let a=r.pop();for(;a;){for(const o of a)n.push(o);a=r.pop()}this.map.length=0}}function BY(e,n,t,r){let a=0;if(!(t===0&&r.length===0)){for(;a<e.map.length;){if(e.map[a][0]===n){e.map[a][1]+=t,e.map[a][2].push(...r);return}a+=1}e.map.push([n,t,r])}}function qY(e,n){let t=!1;const r=[];for(;n<e.length;){const a=e[n];if(t){if(a[0]==="enter")a[1].type==="tableContent"&&r.push(e[n+1][1].type==="tableDelimiterMarker"?"left":"none");else if(a[1].type==="tableContent"){if(e[n-1][1].type==="tableDelimiterMarker"){const o=r.length-1;r[o]=r[o]==="left"?"center":"right"}}else if(a[1].type==="tableDelimiterRow")break}else a[0]==="enter"&&a[1].type==="tableDelimiterRow"&&(t=!0);n+=1}return r}function VY(){return{flow:{null:{name:"table",tokenize:HY,resolveAll:GY}}}}function HY(e,n,t){const r=this;let a=0,o=0,l;return d;function d(R){let B=r.events.length-1;for(;B>-1;){const te=r.events[B][1].type;if(te==="lineEnding"||te==="linePrefix")B--;else break}const G=B>-1?r.events[B][1].type:null,ie=G==="tableHead"||G==="tableRow"?$:f;return ie===$&&r.parser.lazy[r.now().line]?t(R):ie(R)}function f(R){return e.enter("tableHead"),e.enter("tableRow"),u(R)}function u(R){return R===124||(l=!0,o+=1),p(R)}function p(R){return R===null?t(R):Mt(R)?o>1?(o=0,r.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(R),e.exit("lineEnding"),v):t(R):mn(R)?_n(e,p,"whitespace")(R):(o+=1,l&&(l=!1,a+=1),R===124?(e.enter("tableCellDivider"),e.consume(R),e.exit("tableCellDivider"),l=!0,p):(e.enter("data"),g(R)))}function g(R){return R===null||R===124||Zn(R)?(e.exit("data"),p(R)):(e.consume(R),R===92?b:g)}function b(R){return R===92||R===124?(e.consume(R),g):g(R)}function v(R){return r.interrupt=!1,r.parser.lazy[r.now().line]?t(R):(e.enter("tableDelimiterRow"),l=!1,mn(R)?_n(e,S,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(R):S(R))}function S(R){return R===45||R===58?T(R):R===124?(l=!0,e.enter("tableCellDivider"),e.consume(R),e.exit("tableCellDivider"),k):L(R)}function k(R){return mn(R)?_n(e,T,"whitespace")(R):T(R)}function T(R){return R===58?(o+=1,l=!0,e.enter("tableDelimiterMarker"),e.consume(R),e.exit("tableDelimiterMarker"),P):R===45?(o+=1,P(R)):R===null||Mt(R)?U(R):L(R)}function P(R){return R===45?(e.enter("tableDelimiterFiller"),M(R)):L(R)}function M(R){return R===45?(e.consume(R),M):R===58?(l=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(R),e.exit("tableDelimiterMarker"),I):(e.exit("tableDelimiterFiller"),I(R))}function I(R){return mn(R)?_n(e,U,"whitespace")(R):U(R)}function U(R){return R===124?S(R):R===null||Mt(R)?!l||a!==o?L(R):(e.exit("tableDelimiterRow"),e.exit("tableHead"),n(R)):L(R)}function L(R){return t(R)}function $(R){return e.enter("tableRow"),z(R)}function z(R){return R===124?(e.enter("tableCellDivider"),e.consume(R),e.exit("tableCellDivider"),z):R===null||Mt(R)?(e.exit("tableRow"),n(R)):mn(R)?_n(e,z,"whitespace")(R):(e.enter("data"),F(R))}function F(R){return R===null||R===124||Zn(R)?(e.exit("data"),z(R)):(e.consume(R),R===92?Y:F)}function Y(R){return R===92||R===124?(e.consume(R),F):F(R)}}function GY(e,n){let t=-1,r=!0,a=0,o=[0,0,0,0],l=[0,0,0,0],d=!1,f=0,u,p,g;const b=new UY;for(;++t<e.length;){const v=e[t],S=v[1];v[0]==="enter"?S.type==="tableHead"?(d=!1,f!==0&&(Fj(b,n,f,u,p),p=void 0,f=0),u={type:"table",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",u,n]])):S.type==="tableRow"||S.type==="tableDelimiterRow"?(r=!0,g=void 0,o=[0,0,0,0],l=[0,t+1,0,0],d&&(d=!1,p={type:"tableBody",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",p,n]])),a=S.type==="tableDelimiterRow"?2:p?3:1):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")?(r=!1,l[2]===0&&(o[1]!==0&&(l[0]=l[1],g=Cx(b,n,o,a,void 0,g),o=[0,0,0,0]),l[2]=t)):S.type==="tableCellDivider"&&(r?r=!1:(o[1]!==0&&(l[0]=l[1],g=Cx(b,n,o,a,void 0,g)),o=l,l=[o[1],t,0,0])):S.type==="tableHead"?(d=!0,f=t):S.type==="tableRow"||S.type==="tableDelimiterRow"?(f=t,o[1]!==0?(l[0]=l[1],g=Cx(b,n,o,a,t,g)):l[1]!==0&&(g=Cx(b,n,l,a,t,g)),a=0):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")&&(l[3]=t)}for(f!==0&&Fj(b,n,f,u,p),b.consume(n.events),t=-1;++t<n.events.length;){const v=n.events[t];v[0]==="enter"&&v[1].type==="table"&&(v[1]._align=qY(n.events,t))}return e}function Cx(e,n,t,r,a,o){const l=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",d="tableContent";t[0]!==0&&(o.end=Object.assign({},wh(n.events,t[0])),e.add(t[0],0,[["exit",o,n]]));const f=wh(n.events,t[1]);if(o={type:l,start:Object.assign({},f),end:Object.assign({},f)},e.add(t[1],0,[["enter",o,n]]),t[2]!==0){const u=wh(n.events,t[2]),p=wh(n.events,t[3]),g={type:d,start:Object.assign({},u),end:Object.assign({},p)};if(e.add(t[2],0,[["enter",g,n]]),r!==2){const b=n.events[t[2]],v=n.events[t[3]];if(b[1].end=Object.assign({},v[1].end),b[1].type="chunkText",b[1].contentType="text",t[3]>t[2]+1){const S=t[2]+1,k=t[3]-t[2]-1;e.add(S,k,[])}}e.add(t[3]+1,0,[["exit",g,n]])}return a!==void 0&&(o.end=Object.assign({},wh(n.events,a)),e.add(a,0,[["exit",o,n]]),o=void 0),o}function Fj(e,n,t,r,a){const o=[],l=wh(n.events,t);a&&(a.end=Object.assign({},l),o.push(["exit",a,n])),r.end=Object.assign({},l),o.push(["exit",r,n]),e.add(t+1,0,o)}function wh(e,n){const t=e[n],r=t[0]==="enter"?"start":"end";return t[1][r]}const YY={name:"tasklistCheck",tokenize:QY};function WY(){return{text:{91:YY}}}function QY(e,n,t){const r=this;return a;function a(f){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?t(f):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(f),e.exit("taskListCheckMarker"),o)}function o(f){return Zn(f)?(e.enter("taskListCheckValueUnchecked"),e.consume(f),e.exit("taskListCheckValueUnchecked"),l):f===88||f===120?(e.enter("taskListCheckValueChecked"),e.consume(f),e.exit("taskListCheckValueChecked"),l):t(f)}function l(f){return f===93?(e.enter("taskListCheckMarker"),e.consume(f),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),d):t(f)}function d(f){return Mt(f)?n(f):mn(f)?e.check({tokenize:JY},n,t)(f):t(f)}}function JY(e,n,t){return _n(e,r,"whitespace");function r(a){return a===null?t(a):n(a)}}function KY(e){return ST([SY(),DY(),zY(e),VY(),WY()])}const XY={};function Bs(e){const n=this,t=e||XY,r=n.data(),a=r.micromarkExtensions||(r.micromarkExtensions=[]),o=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),l=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);a.push(KY(t)),o.push(xY()),l.push(bY(t))}const ZY=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},eW=e=>{switch(e){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:e,className:"status-badge"}}},A0=({title:e,items:n,renderItemContent:t,headerAction:r,isLoading:a,loadingText:o,noDataText:l,onDeleteItem:d,onEditLabOrder:f,onSaveLabOrder:u,onCancelEditLabOrder:p,onLabOrderTestChange:g,onLabOrderStatusChange:b,onEditPharmacyOrder:v,onPrintUnavailablePrescription:S,onBillLabOrder:k,onUpdateLabOrderStatus:T,onEnterLabReport:P,labInventory:M=[],isSavingLabOrder:I=!1,expandedLabReports:U={},toggleLabReport:L=()=>{}})=>{const $=w.useMemo(()=>{const F={};n.forEach(R=>{if(isNaN(R.date.getTime())){F["Unknown Date"]||(F["Unknown Date"]=[]),F["Unknown Date"].push(R);return}const B=ZY(R.originalDateString);F[B]||(F[B]=[]),F[B].push(R)});const Y=Object.keys(F);return Y.sort((R,B)=>{if(R==="Unknown Date")return 1;if(B==="Unknown Date")return-1;try{const G=new Date(R.split(" ").reverse().join(" ")),ie=new Date(B.split(" ").reverse().join(" "));if(!isNaN(G.getTime())&&!isNaN(ie.getTime()))return ie.getTime()-G.getTime()}catch{}return B.localeCompare(R)}),Y.map(R=>({date:R,items:F[R]}))},[n]),z=["pending","billed","collected","processing","report_ready","completed","cancelled","reported"];return i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title mb-2 pb-1",children:e}),r]}),a&&i.jsx("p",{className:"ai-context-text italic",children:o}),!a&&n.length===0&&i.jsx("p",{className:"ai-context-text italic",children:l}),!a&&n.length>0&&i.jsx("div",{className:"space-y-3",children:$.map(({date:F,items:Y})=>i.jsxs("div",{children:[i.jsx("h5",{className:"grouped-history-date",children:F}),i.jsx("div",{className:"space-y-1 grouped-history-item-container",children:Y.map((R,B)=>i.jsxs("div",{className:"grouped-history-item ai-context-item flex flex-col",children:[i.jsxs("div",{className:"flex justify-between items-center w-full",children:[i.jsx("div",{className:"flex-grow mr-2 ai-context-text",children:t(R,B,U,L)}),i.jsxs("div",{className:"flex items-center space-x-1",children:[R.type==="Lab Order"&&!R.data.isEditing&&f&&i.jsx("button",{onClick:()=>f(R.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this lab order",disabled:I,children:i.jsx(Vl,{size:14})}),R.type==="Lab Order"&&R.data.isEditing&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>u&&u(R.data.id,R.data.editedTests,R.data.editedStatus),className:"text-green-600 hover:text-green-800 p-1 rounded hover:bg-green-100 focus:outline-none focus:ring-1 focus:ring-green-400",title:"Save lab order changes",disabled:I,children:i.jsx(Od,{size:14})}),i.jsx("button",{onClick:()=>p&&p(R.data.id),className:"text-gray-600 hover:text-gray-800 p-1 rounded hover:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-gray-400",title:"Cancel editing",disabled:I,children:i.jsx(li,{size:14})})]}),R.type==="Lab Order"&&i.jsxs("div",{className:"lab-table-actions",children:[R.data.status==="pending"&&k&&(()=>{const G=R.data.tests.reduce((ie,te)=>ie+(Number(te.price)||0),0).toFixed(2);return i.jsxs("button",{onClick:()=>k(R.data),className:"lab-action-button btn-bill",title:`Pay total of ${G}`,children:["Pay (",G,")"]})})(),R.data.status==="billed"&&T&&i.jsx("button",{onClick:()=>T(R.data.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),R.data.status==="collected"&&T&&i.jsx("button",{onClick:()=>T(R.data.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),["pending","billed","collected","processing","report_ready","reported","completed"].includes(R.data.status)&&P&&i.jsx("button",{onClick:()=>P(R.data),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(R.data.status==="report_ready"||R.data.status==="reported")&&T&&i.jsx("button",{onClick:()=>T(R.data.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"})]}),R.type==="Pharmacy Order"&&R.data.status==="pending"&&v&&i.jsx("button",{onClick:()=>v(R.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this pharmacy order",disabled:I,children:i.jsx(Vl,{size:14})}),R.type==="Pharmacy Order"&&R.data.prescriptionForUnavailableDrugs&&S&&i.jsx("button",{onClick:()=>S(R.data.prescriptionForUnavailableDrugs,`Prescription for Order ${R.data.id}`),className:"text-purple-600 hover:text-purple-800 p-1 rounded hover:bg-purple-100 focus:outline-none focus:ring-1 focus:ring-purple-400",title:"Print Prescription for Unavailable Drugs",disabled:I,children:i.jsx(Go,{size:14})}),R.type==="Pharmacy Order"&&R.data.status==="pending"&&d&&i.jsx("button",{onClick:()=>d({type:R.type,data:R.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Delete this pending pharmacy order",disabled:I,children:i.jsx(li,{size:14})}),d&&["Complaint","Lab Order","Lab Report"].includes(R.type)&&i.jsx("button",{onClick:()=>d({type:R.type,data:R.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:`Delete this ${R.type.toLowerCase()}`,disabled:I,children:i.jsx(li,{size:14})})]})]}),R.type==="Lab Order"&&R.data.isEditing&&i.jsxs("div",{className:"lab-order-edit-form mt-2 w-full",children:[i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status:"}),i.jsx("select",{value:R.data.editedStatus||R.data.status,onChange:G=>b&&b(R.data.id,G.target.value),className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:I,children:z.map(G=>i.jsx("option",{value:G,children:G.replace(/_/g," ")},G))})]}),i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tests:"}),R.data.editedTests.map((G,ie)=>i.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[i.jsxs("select",{value:G.id,onChange:te=>{const W=M.find(V=>String(V.id)===te.target.value);W&&(g&&g(R.data.id,ie,"id",W.id),g&&g(R.data.id,ie,"name",W.name),g&&g(R.data.id,ie,"price",W.price))},className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:I,children:[i.jsx("option",{value:"",children:"Select Test"}),M.map(te=>i.jsxs("option",{value:te.id,children:[te.name," (",te.price,")"]},te.id))]}),i.jsx("button",{onClick:()=>{const te=R.data.editedTests.filter((W,V)=>V!==ie);g&&g(R.data.id,-1,"remove",te)},className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Remove test",disabled:I,children:i.jsx(li,{size:14})})]},ie)),i.jsx("button",{onClick:()=>{g&&g(R.data.id,-1,"add",{id:"",name:"",price:0})},className:"button-secondary mt-2 text-xs",disabled:I,children:"Add Test"})]})]},`${R.type}-${R.originalDateString}-${B}`))})]},F))})]})},tW="_modalOverlay_1yna4_3",nW="_modalContent_1yna4_29",rW="_modalHeader_1yna4_57",iW="_modalTitle_1yna4_75",aW="_modalCloseButton_1yna4_87",sW="_modalBody_1yna4_115",oW="_errorText_1yna4_129",lW="_formGroup_1yna4_147",cW="_inputField_1yna4_171",uW="_searchResultsCard_1yna4_213",dW="_searchResultsList_1yna4_241",fW="_searchResultItem_1yna4_253",hW="_searchResultPrice_1yna4_289",pW="_selectedTestsCard_1yna4_299",mW="_selectedTestsHeader_1yna4_319",gW="_noTestsMessage_1yna4_335",yW="_selectedTestsList_1yna4_351",xW="_selectedTestItem_1yna4_363",bW="_selectedTestName_1yna4_387",vW="_selectedTestPrice_1yna4_399",wW="_removeTestButton_1yna4_411",SW="_totalAmount_1yna4_437",NW="_modalFooter_1yna4_455",CW="_button_1yna4_473",jW="_buttonPrimary_1yna4_491",_W="_buttonSecondary_1yna4_513",_t={modalOverlay:tW,modalContent:nW,modalHeader:rW,modalTitle:iW,modalCloseButton:aW,modalBody:sW,errorText:oW,formGroup:lW,inputField:cW,searchResultsCard:uW,searchResultsList:dW,searchResultItem:fW,searchResultPrice:hW,selectedTestsCard:pW,selectedTestsHeader:mW,noTestsMessage:gW,selectedTestsList:yW,selectedTestItem:xW,selectedTestName:bW,selectedTestPrice:vW,removeTestButton:wW,totalAmount:SW,modalFooter:NW,button:CW,buttonPrimary:jW,buttonSecondary:_W},kW=({isOpen:e,onClose:n,patientId:t,labInventory:r,fetchPendingLabOrdersData:a})=>{const[o,l]=w.useState([]),[d,f]=w.useState(""),[u,p]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>{if(!d){p([]);return}const M=d.toLowerCase();p(r.filter(I=>I.name.toLowerCase().includes(M)||I.description&&I.description.toLowerCase().includes(M)).slice(0,10))},[d,r]);const k=async()=>{if(!t){b("Patient ID is missing.");return}if(o.length===0){b("Please select at least one lab test.");return}S(!0),b(null);try{const M={patient_id:t,tests:o.map(U=>({id:U.id,name:U.name,price:U.price}))},I=await pe("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)});if(!I.ok){const U=await I.json().catch(()=>({}));throw new Error(U.message||`Failed to create lab order: ${I.statusText}`)}await I.json(),a(t),n(),l([]),f("")}catch(M){b(`Lab Order Creation Error: ${M.message}`)}finally{S(!1)}},T=M=>{if(o.some(I=>I.id===M.id)){b(`${M.name} is already in the order.`),setTimeout(()=>b(null),3e3),f(""),p([]);return}l(I=>[...I,{...M}]),f(""),p([])},P=M=>{l(I=>I.filter(U=>U.id!==M))};return e?i.jsx("div",{className:_t.modalOverlay,children:i.jsxs("div",{className:_t.modalContent,children:[i.jsxs("div",{className:_t.modalHeader,children:[i.jsx("h3",{className:_t.modalTitle,children:"Create New Lab Order"}),i.jsx("button",{onClick:n,className:_t.modalCloseButton,children:i.jsx(Xn,{size:20})})]}),i.jsxs("div",{className:_t.modalBody,children:[g&&i.jsx("div",{className:_t.errorText,children:g}),i.jsxs("div",{className:_t.formGroup,style:{position:"relative"},children:[i.jsx("label",{htmlFor:"lab-test-search",children:"Add Lab Test"}),i.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search available lab tests...",value:d,onChange:M=>f(M.target.value),className:_t.inputField}),d&&u.length>0&&i.jsx("div",{className:_t.searchResultsCard,children:i.jsx("ul",{className:_t.searchResultsList,children:u.map(M=>i.jsxs("li",{onClick:()=>T(M),className:_t.searchResultItem,children:[i.jsx("span",{children:M.name}),i.jsxs("span",{className:_t.searchResultPrice,children:["(",parseFloat(String(M.price)).toFixed(2),")"]})]},M.id))})})]}),i.jsxs("div",{className:_t.selectedTestsCard,children:[i.jsx("h4",{className:_t.selectedTestsHeader,children:"Selected Tests"}),o.length===0?i.jsx("p",{className:_t.noTestsMessage,children:"No tests added yet."}):i.jsx("ul",{className:_t.selectedTestsList,children:o.map(M=>i.jsxs("li",{className:_t.selectedTestItem,children:[i.jsx("span",{className:_t.selectedTestName,children:M.name}),i.jsxs("span",{className:_t.selectedTestPrice,children:["",parseFloat(String(M.price)).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>P(String(M.id)),className:_t.removeTestButton,title:"Remove Test",children:i.jsx(li,{size:16})})]},M.id))})]}),o.length>0&&i.jsxs("div",{className:_t.totalAmount,children:["Total: ",o.reduce((M,I)=>M+parseFloat(String(I.price)),0).toFixed(2)]})]}),i.jsxs("div",{className:_t.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${_t.button} ${_t.buttonSecondary}`,children:" Cancel "}),i.jsxs("button",{type:"button",onClick:k,disabled:o.length===0||v,className:`${_t.button} ${_t.buttonPrimary} ${o.length===0||v?_t.buttonDisabled:""}`,children:[" ",v?"Saving...":"Create Lab Order"," "]})]})]})}):null},jx=e=>{if(!e)return"";let n=e.toLowerCase();return n=n.replace(/\b(mg|g|ml|iu|unit|tabs|tablet|tablets|capsule|capsules|injection|injections|syrup|solution|cream|ointment|lotion|spray|drops|patch|suppository|vial|ampoule|bottle|pack|kit)\b/g,""),n=n.replace(/\b(test|panel|profile|assay|screen|analysis|level|count|culture)\b/g,""),n=n.replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim(),n},$m=(e,n)=>{if(!e||!n||n.length===0)return;const t=jx(e);let r=n.find(l=>jx(l.name)===t);if(r)return r;let a=n.find(l=>jx(l.name).includes(t));if(a)return a;let o=n.find(l=>t.includes(jx(l.name)));if(o)return o},TW=`You are an expert OPD (Outpatient Department) medical assistant for a Doctor in a clinic in India. You will receive all the medical data of the patient including complaints (history), labs, pharmacy orders, etc., along with their date and time. Your primary goal is to assist the doctor and analyze patient chief complaints (Co), provide a structured clinical assessment including lab test suggestions (Lx), differential diagnoses (Dx), and a treatment plan (Tx). You have access to tools (actions) to order lab tests and pharmacy items, and update patient details.



**1. Definitions:**
   - Co: Chief complaints
   - Pt: Patient (assume living in India)
   - Lx: Laboratory tests
   - Dx: Differential Diagnosis
   - Tx: Treatment Plan

**2. Workflow:**
   - Analyze Co, generate Lx, Dx, and Tx sections as described below.
   - **Prioritization for Orders:** Always prioritize using \`edit_pharmacy_order\` or \`edit_lab_order\` if there are existing pending orders for the patient, before considering \`create_pharmacy_order\` or \`create_lab_order\`.
   - using edit_lab_order edits the lab order with the given serial numnber use to add new tests to the existing order or remove the tests from existing order, marking the status affects all tests in the order not only the test,always use this tool if there are pending lab orders instead of creating new orders.
   - using edit_pharmacy_order edits the pharmacy order with the given serial numnber to add new items to the existing order, update existing items, or remove items (either by \`items_to_remove\` or by setting \`quantity\` to 0). Always use this tool if there are pending pharmacy orders instead of creating new orders.
   - If your Lx section suggests tests from the inventory, use the \`create_lab_order\` action, but only for tests that are both clinically required and have not already been ordered or are still pending. Skip tests that are already ordered and in pending.
   - If your Tx section prescribes medications, use the \`create_pharmacy_order\` action  but only for medications that are clinically required and have not already been prescribed or are still pending. Skip medications that are already dispensed or already ordered.
   - If your Tx section prescribes medications that are *not* available in the inventory, use the \`prescription_for_unavailable_drugs\` parameter within the \`create_pharmacy_order\` action to specify the prescription details for these unavailable drugs.
   - When ordering pharmacy items, specify both \`pack_quantity\` (number of full packs) and \`loose_quantity\` (number of individual units). The system will handle the conversion based on the drug's unit/pack size.
   - **Patient Details Management:** Always store or update patient name, age, sex, and phone number using the \`update_patient_details\` action. If patient name, age, or sex is received as 'New Patient - Direct Entry', 'N/A', or blank, treat it as missing data; if the user input provides anything resembling a name, age, or sex (e.g., shiva 25m, robin 50m, priya 19f), update them using the \`update_patient_details\` action. If details are missing, you can ask the user for the missing details using the \`ask_followup_question\` action.
   - Always update new complaints of the patient using the \`add_complaint_history\` action.
   - If you generate a concise summary of the patient's current situation based on the interaction and history, use the \`update_case_summary\` action to save it.
   - Remember, when you use \`update_case_summary\`, the previous case summary will be replaced by the new one, so you can use it like a short-term memory to store other stuff that **keeps changing**, like the current treatment plan, plan of action, active problems, or current vitals, etc.
   - When you use \`add_complaint_history\`, it will add the complaint to the previous ones. You will be given all the previous complaints back in every query, so you can use it to store other long-term facts that do **not change**, like the history of a chronic illness, surgical history, allergies, or social history, etc.
   - while placing or editing a pharmacy order make sure to set the \`pack_quantity\` and \`loose_quantity\` right.
   - Use the \`update_clinic_ai_memory\` action to store or update **various types of clinic-wide persistent information in a concise way**. This can include 'summaries of common patient encounters'+'summeries of previous **Clinic-wide AI Memory**'(e.g., 'Patient X, 50m, chronic gastritis, last visit YYYY-MM-DD, prescribed Z, follow-up in N days'+'**Clinic-wide AI Memory** summary'), notes on local health trends, common diagnostic patterns observed in the clinic, specific operational protocols. This memory is shared across all interactions for the clinic and helps tailor responses to its specific context over time.
**3.**Multiple Actions:** You can perform multiple actions (like ordering labs AND meds, adding complaints, updating patient information, and asking a follow-up question) in a single response by including multiple action objects within the main JSON array.


**4. Chief Complaints (Co):**
   - Analyze the provided chief complaints.
   - Present them in a table with two columns: 'Relevant Complaint (Score 8-10)' and 'Irrelevant Complaint (Score 0-7)', based on clinical relevance.

**5. Lab Tests (Lx):**
   - Suggest the most probable basic lab tests based on the clinical picture, ordered by likelihood.
   - If a basic test is positive/abnormal, suggest relevant advanced tests.
   - **Inventory Check:** Compare suggested tests against the provided inventory list.
   - **Table 1: Available Lab Tests:** Present tests *available* in the inventory in a table with columns: '**Clinical Importance (High/Medium/Low)**', 'Lab Test'. If suggesting tests from this table, prepare to use the \`create_lab_order\` tool in your response.
   - **Table 2: Unavailable Lab Tests:** Present tests *not available* in the inventory in a separate table with columns: '**Clinical Importance (High/Medium/Low)**', 'Unavailable Basic Test'. Clearly state these are not orderable via the tool (generate Table 2 only when required tests are unavailable).

**6. Differential Diagnosis (Dx):**
   - List potential differential diagnoses.
   - Provide a confidence score (0-10) for each.
   - Present in a table with columns: 'Differential Diagnosis' and 'Confidence Score (0-10)'.

**7. Treatment Plan (Tx):**
   - Create a structured treatment plan including ideal medications based on the diagnosis.
   - **Inventory Check:** Compare prescribed medications against the provided inventory list.
   - **Table 1: Available Medications:** Present medications *available* in the inventory in a table with columns: 'Time Frame' (from and to dates), 'Treatment Goal', 'Intervention', 'Medication Type', 'Drug Form', 'Drug Name', 'Regimen (Dose, Freq)', 'Duration'. Before using the \`create_pharmacy_order\` tool, check if an order for the same drug has already been placed for this patient today. If an order already exists for today, do *not* create a duplicate order. If no order exists for today, prepare to use the \`create_pharmacy_order\` tool in your response.
   - **Table 2: Unavailable Medications:** Present medications *not available* in the inventory in a separate table with columns: 'Unavailable Drug Name', 'Ideal Regimen', 'Reasoning/Indication', '**Clinical Importance (High/Medium/Low)**', 'Suggested Available Substitute (from inventory, if possible)'. Clearly state these are not orderable via the tool (generate Table 2 only when required medications are unavailable in the inventory).

**8. Tools / Actions:**
   When you need to perform actions like ordering tests/meds, updating patient info, or adding history, use the following JSON array format. The response should ONLY contain this JSON array, nothing else.

   ****STRICT JSON****>>>>>>\`\`\`json
[
  { "action": "create_pharmacy_order", "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "prescription_for_unavailable_drugs": "string | null" },
  { "action": "edit_pharmacy_order", "serialNumber": number, "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "items_to_remove": [ { "drug_id": number | null, "name": "Drug Name" } ], "status": "pending" | "billed" | "dispensed" | "cancelled", "prescription_for_unavailable_drugs": "string | null" },
  { "action": "create_lab_order", "tests": [ { "name": "Test Name" } ] },
  { "action": "edit_lab_order", "serialNumber": number, "tests": [ { "name": "Test Name" } ], "items_to_remove": [ { "id": number | string | null, "name": "Test Name" } ], "status": "pending" | "billed" | "collected" | "processing" | "report_ready" | "completed" | "cancelled" | "reported" },
  { "action": "create_lab_report", "tests": [ { "name": "Test Name", "parameters": [{ "name": "Parameter Name", "value": "Value" }] } ] },
  { "action": "edit_lab_report", "serialNumber": number, "tests": [ { "name": "Test Name", "parameters": [{ "name": "Parameter Name", "value": "Value" }] } ] },
  { "action": "add_complaint_history", "complaint": "Specific past complaint text..." },
  { "action": "update_patient_details", "name": "New Name (optional)", "age": number (optional), "gender": "M" | "F" | "O" | null (optional), "phone_number": "string (optional)" },
  { "action": "update_case_summary", "summary": "Concise summary text..." },
  { "action": "update_clinic_ai_memory", "memory_content": "New clinic-wide AI memory content..." }
]
\`\`\`

   - **Multiple Actions in One Response:** You can include multiple action objects within this single JSON array if several actions are required based on your analysis (e.g., adding history AND ordering labs).
   - **Prioritization Within the Array:** If including multiple actions, order them within the array according to this priority:
     1. \`add_complaint_history\`
     2. \`update_patient_details\`
     3. \`update_case_summary\`
     4. \`update_clinic_ai_memory\`
     5. \`create_lab_order\`
     6. \`edit_lab_order\`
     7. \`create_pharmacy_order\`
     8. \`edit_pharmacy_order\`
   - **Structure:**
     The AI response can be a flat array of actions OR a list of "function call" objects containing grouped actions.
     **Option 1: Flat Array (Simple)**
     \`\`\`json
     [
       { "action": "add_complaint_history", ... },
       { "action": "create_lab_order", ... }
     ]
     \`\`\`
     **Option 2: Grouped Function Calls (Complex)**
     You can group actions under logical "function calls" if needed.
     \`\`\`json
     [
       {
         "function_call": "assess_patient",
         "actions": [
           { "action": "ask_followup_question", "question": "..." }
         ]
       },
       {
         "function_call": "prescribe_treatment",
         "actions": [
            { "action": "create_pharmacy_order", "items": [...] },
            { "action": "create_lab_order", "tests": [...] }
         ]
       }
     ]
     \`\`\`

   - **Example (Multiple Actions):**
     \`\`\`json
     [
       { "action": "add_complaint_history", "complaint": "Patient also reports mild fever since yesterday." },
       { "action": "create_lab_order", "tests": [ { "name": "CBC" } ] }
     ]
     \`\`\`

   - **\`ask_followup_question\`**: Use this action (either standalone or inside a group) only when you need clarification.
     \`\`\`json
     {
       "action": "ask_followup_question",
       "question": "Your clear, specific question here.",
       "options": ["Optional Answer 1", "Optional Answer 2"]
     }
     \`\`\`
     *Description:* Ask the user a question to gather additional information needed to complete the task. This tool should be used when you encounter ambiguities, need clarification, or require more details to proceed effectively. It allows for interactive problem-solving by enabling direct communication with the user. Use this tool judiciously to maintain a balance between gathering necessary information and avoiding excessive back-and-forth.
     *Parameters:*
       - question: (required) The question to ask the user. This should be a clear, specific question that addresses the information you need.
       - options: (optional) An array of 2-5 options for the user to choose from. Each option should be a string describing a possible answer. You may not always need to provide options, but it may be helpful in many cases where it can save the user from having to type out a response manually.


**Important:**
- Ensure all tables are clearly formatted using Markdown.
- Strictly adhere to the inventory constraints for labs and medications when deciding whether to use \`create_lab_order\` or \`create_pharmacy_order\`.
- When using actions, provide ONLY the JSON array (or the single JSON object for \`ask_followup_question\`) as the *very last* part of your response, after all other content including tables. Do not include any other text after the JSON.

**Plan Mode:**
When the user asks a question about a patient's condition or general medical topics (not entering new medical data), respond in PLAN MODE. In this mode, focus on answering the user's inquiry, clarifying their request, brainstorming ideas, or architecting a solution (like exploring treatment options). Ask clarifying questions if needed. Present detailed plans or explanations **using clear table formats and markdown (like bolding) for easy readability**. Engage in back-and-back discussion to finalize details. Do not use action tools (\`create_lab_order\`, \`create_pharmacy_order\`, \`add_complaint_history\`, \`update_patient_details\`) while in PLAN MODE).`,$j="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",EW="models/gemini-3-flash-preview";async function AW(){if(!Hk())return console.warn("No auth token found, using default Gemini API key."),$j;let n=null;try{const t=await pe("/api/clinics/settings");if(t.ok){const r=await t.json();r.gemini_api_key&&r.gemini_api_key.trim()!==""&&(n=r.gemini_api_key.trim())}}catch(t){console.warn("Could not fetch clinic settings (or key missing), proceeding to global fallback.",t)}if(n)return n;try{const t=await pe("/api/global-settings/app_gemini_api_key");if(t.ok){const a=(await t.json()).value;if(a&&a.trim()!=="")return a.trim()}}catch(t){console.warn("Could not fetch global API key.",t)}return console.warn("Clinic-specific and global Gemini API keys not found, using default env var."),$j}let P0=null;async function PW(){if(!P0){const e=await AW();P0=new mk({apiKey:e})}return P0}async function DW(e,n){const{query:t,currentDateTime:r,patientName:a,patientAge:o,patientGender:l,case_summary:d,case_summary_last_updated:f,clinic_ai_memory:u,clinic_ai_memory_last_updated:p,clinic_wide_system_prompt:g,labHistory:b,pharmacyOrders:v,pastComplaints:S,pharmacyInventory:k,labInventory:T}=e;let P=`Patient Complaint: ${t}`;if(d&&(P+=`

--- Case Summary (Provided by Doctor) ---
${d}`,f))try{const R=new Date(f).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});P+=`
(Last Updated: ${R})`}catch{console.warn(`Could not format case_summary_last_updated: ${f}`),P+=`
(Last Updated: ${f})`}if(a&&(P+=`

Patient Name: ${a}`),o!=null&&(P+=`
Patient Age: ${o}`),l&&(P+=`
Patient Gender: ${l}`),r)try{const R=new Date(r).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});P+=`

Current Interaction Time: ${R}`}catch{console.warn(`Could not format currentDateTime: ${r}`),P+=`

Current Interaction Time: ${r}`}if(u&&(P+=`

--- Clinic-wide AI Memory/Context ---
${u}`,p))try{const R=new Date(p).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});P+=`
(Last Updated: ${R})`}catch{console.warn(`Could not format clinic_ai_memory_last_updated: ${p}`),P+=`
(Last Updated: ${p})`}let M="";b&&Array.isArray(b)&&b.length>0&&(M=`

--- Lab History (Orders & Reports) ---
`,b.forEach(R=>{let B="Unknown Date";try{B=new Date(R.orderDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab order: ${R.orderDate}`)}if(M+=`
Order #${R.serialNumber} Date: ${B} (Status: ${R.status})
`,M+=`Tests: ${R.tests.map(G=>G.name).join(", ")}
`,R.report){let G="Unknown Date";try{G=new Date(R.report.reportDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab report: ${R.report.reportDate}`)}M+=`  -> Report Date: ${G}
`,R.report.tests&&Array.isArray(R.report.tests)?(M+=`     Findings:
`,R.report.tests.forEach(ie=>{M+=`       - Test: ${ie.testName}
`,ie.parameters&&Array.isArray(ie.parameters)&&ie.parameters.forEach(te=>{M+=`         - ${te.name}: ${te.value} (Normal: ${te.normal_range})
`})})):(M+=`     Findings: ${R.report.reportContent||"N/A"}
`,R.report.error&&(M+=`     Note: ${R.report.error}
`))}M+=`---
`}),P+=M);let I="";v&&Array.isArray(v)&&v.length>0&&(I=`

--- Recent Pharmacy Orders ---
`,v.forEach(R=>{let B="Unknown Date/Time";try{B=new Date(R.date).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for pharmacy order: ${R.date}`)}I+=`
Order #${R.serialNumber} Date/Time: ${B} (Status: ${R.status})
`,I+=`Prescribed By: ${R.prescribedBy||"N/A"}
`,R.dispensedBy&&(I+=`Dispensed By: ${R.dispensedBy}
`),I+=`Medications:
`,R.medications.forEach(G=>{I+=`  - ${G.name} (Qty: ${G.quantity}`,G.tabletsPerDay&&(I+=`, ${G.tabletsPerDay}/day`),G.numberOfDays&&(I+=` for ${G.numberOfDays} days`),I+=`)
`}),R.prescriptionForUnavailableDrugs&&(I+=`  Prescription for Unavailable Drugs: ${R.prescriptionForUnavailableDrugs}
`),I+=`---
`}),P+=I);let U="";S&&Array.isArray(S)&&S.length>0&&(U=`

--- Past Complaints History ---
`,S.forEach(R=>{let B="Unknown Date/Time";try{B=new Date(R.createdAt).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for past complaint: ${R.createdAt}`)}U+=`
Date/Time: ${B}
Complaint: ${R.complaint||"N/A"}
---
`}),P+=U);let L="";k&&Array.isArray(k)&&k.length>0&&(L=`

--- Current Pharmacy Inventory (Stock Levels) ---
`,k.forEach(R=>{L+=`- ${R.name} (Pack: ${R.unit??"N/A"}): ${R.quantity_in_stock??"N/A"}
`}),P+=L);let $="";T&&Array.isArray(T)&&T.length>0&&($=`

--- Available Lab Tests (with Parameters) ---
`,T.forEach(R=>{$+=`- ${R.name} (Price: ${R.price??"N/A"})
`,R.default_parameters&&Array.isArray(R.default_parameters)&&R.default_parameters.length>0&&R.default_parameters.forEach(B=>{let G=`    * ${B.name}`;B.unit&&(G+=` (${B.unit})`),B.normal_range?G+=` [Normal: ${B.normal_range}]`:B.lower_limit!==void 0&&B.upper_limit!==void 0&&B.lower_limit!==null&&B.upper_limit!==null&&(G+=` [Normal: ${B.lower_limit} - ${B.upper_limit}]`),$+=`${G}
`})}),P+=$);const z=[{text:TW}];g&&g.trim()!==""&&z.push({text:`--- Additional Clinic-Specific Instructions ---
${g}`});const F=[{text:P}];if(n){const R=new FileReader,B=await new Promise((G,ie)=>{R.onloadend=()=>{typeof R.result=="string"?G(R.result.split(",")[1]):ie(new Error("Failed to read image file as base64."))},R.onerror=ie,R.readAsDataURL(n)});F.push({inlineData:{mimeType:n.type,data:B}})}const Y=[];z.length>0&&Y.push({role:"user",parts:z}),Y.push({role:"user",parts:F});try{const R={model:EW,contents:Y,generationConfig:{temperature:.7,maxOutputTokens:1024,responseMimeType:"text/plain"}},G=await(await PW()).models.generateContentStream(R);let ie="";for await(const te of G)if(te&&typeof te.text=="function"){const W=te.text;W&&(ie+=W)}else te&&te.candidates&&te.candidates[0]&&te.candidates[0].content&&te.candidates[0].content.parts&&te.candidates[0].content.parts[0]&&te.candidates[0].content.parts[0].text&&(ie+=te.candidates[0].content.parts[0].text);if(ie&&ie.trim()!=="")return ie.trim();throw console.error("Empty or invalid response received from Gemini API stream."),new Error("Failed to get suggestion from AI (Gemini). Empty or invalid stream response.")}catch(R){console.error("Error calling Gemini API:",R);let B="Failed to get suggestion from Gemini.";throw R.message&&(B=`Error processing Gemini request: ${R.message}`),new Error(B)}}const IW=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return n?parseInt(n[1],10):1},RW=w.forwardRef(({recordId:e,patientId:n,patientDetails:t,caseSummary:r,caseSummaryUpdatedAt:a,clinicSettings:o,userMessages:l,selectedImageFile:d,pendingLabOrders:f,labReports:u,pastComplaints:p,pharmacyOrders:g,pharmacyInventory:b,labInventory:v,currentComplaint:S,setCurrentComplaint:k,setAiResponse:T,setAiResponseText:P,setAiResponseJsonString:M,setShowAiJsonDetails:I,setIsLoadingAi:U,setAiError:L,setIsSubmittingAiOrder:$,setAiOrderSubmissionStatus:z,setIsSubmittingAiLabOrder:F,setAiLabOrderSubmissionStatus:Y,setIsSubmittingAiComplaint:R,setAiComplaintSubmissionStatus:B,setIsUpdatingCaseSummary:G,setAiCaseSummaryUpdateStatus:ie,setCaseSummary:te,setIsUpdatingAiMemoryByAI:W,setAiMemoryUpdateByAIStatus:V,setFollowUpQuestion:se,setFollowUpOptions:re,setError:oe,setIsSavingAiResponse:E,setSaveAiResponseError:le,fetchPharmacyOrdersData:ue,fetchPendingLabOrdersData:D,fetchLabReportsData:ce,fetchPastComplaintsData:ve,fetchPatientDetails:X,setClinicSettings:fe,setEditedAiMemory:ae,setCanUndo:Me,onAiActionSuccess:Ke,addMessage:Z},Ee)=>{const[Ie,Fe]=jn.useState(null);jn.useEffect(()=>{Me(!!Ie)},[Ie,Me]);let rt;const lt=async(je,qe,Be,ke=0)=>{let we;const me=["AI response did not contain a recognized function call","AI response did not result in a recognized or performed function call"].some(Ve=>{var Qe;return(Qe=qe.message)==null?void 0:Qe.includes(Ve)});Be&&me?we=`AI Error: ${qe.message}

${Be}`:(we=`I encountered a frontend error while trying to execute the '${je}' function. The error message is: "${qe.message}". Based on this error, please analyze what went wrong and either correct the function call and try again, or explain the problem.`,(je==="create_pharmacy_order"||je==="edit_pharmacy_order")&&(we+=`

IMPORTANT: When ordering medication, please first check if the medication ordered matches the exact name given in the inventory. If the name itself is not given in the inventory, you can also use 'prescription_for_unavailable_drugs' to write a prescription for unavailable drugs.`),Be&&(we+=`

The original AI response that caused the error was:
\`\`\`
${Be}
\`\`\``)),Z==null||Z({role:"system",type:"error",content:`AI Error: ${qe.message}. Retrying...`}),await rt(we,ke+1)},ct=async je=>{console.log("Executing Rollback for actions:",je);for(const qe of je){const{actionType:Be,undoData:ke}=qe;if(console.log(`Attempting to rollback ${Be}`,ke),!ke){console.warn(`No undoData found for action ${Be}, skipping.`);continue}try{if(Be==="create_pharmacy_order")ke!=null&&ke.orderId?(console.log(`Deleting pharmacy order ${ke.orderId}`),await pe(`/api/pharmacy-orders/${ke.orderId}`,{method:"DELETE"}),ue(n)):console.error("Missing orderId for create_pharmacy_order rollback");else if(Be==="create_lab_order")ke!=null&&ke.orderId?(console.log(`Deleting lab order ${ke.orderId}`),await pe(`/api/lab/orders/${ke.orderId}`,{method:"DELETE"}),D(n)):console.error("Missing orderId for create_lab_order rollback");else if(Be==="update_patient_details")if(ke!=null&&ke.patientId&&(ke!=null&&ke.originalDetails)){console.log(`Reverting patient details for ${ke.patientId}`);const we=ke.originalDetails,Q={name:we.name,age:we.age,gender:we.gender,phone:we.phone,ai_response:we.ai_response};await pe(`/api/patients/${ke.patientId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Q)}),X(ke.patientId)}else console.error("Missing patientId or originalDetails for update_patient_details rollback");else if(Be==="add_complaint_history")ke!=null&&ke.recordId?(console.log(`Reverting complaint history for ${ke.recordId}`),await pe(`/api/queue/doctor/complaint/${ke.recordId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({complaint:ke.originalComplaint||""})}),k(ke.originalComplaint||"")):console.error("Missing recordId for add_complaint_history rollback");else if(Be==="update_case_summary")ke!=null&&ke.recordId?(console.log(`Reverting case summary for ${ke.recordId}`),await pe(`/api/queue/doctor/complaint/${ke.recordId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:ke.originalSummary||""})}),te(ke.originalSummary||"")):console.error("Missing recordId for update_case_summary rollback");else if(Be==="update_clinic_ai_memory")(ke==null?void 0:ke.originalMemory)!==void 0?(console.log("Reverting AI memory"),await pe("/api/clinics/settings",{method:"PUT",body:JSON.stringify({...o,aiMemory:ke.originalMemory})}),ae(ke.originalMemory)):console.error("Missing originalMemory for update_clinic_ai_memory rollback");else if(Be==="edit_pharmacy_order")if(ke!=null&&ke.orderId&&(ke!=null&&ke.originalState)){console.log(`Reverting pharmacy order ${ke.orderId}`);const we={items:ke.originalState.medications||[],status:ke.originalState.status,prescription_for_unavailable_drugs:ke.originalState.prescription_for_unavailable_drugs,order_total:ke.originalState.order_total};await pe(`/api/pharmacy-orders/${ke.orderId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(we)}),ue(n)}else console.error("Missing orderId or originalState for edit_pharmacy_order rollback");else if(Be==="edit_lab_order")if(ke!=null&&ke.orderId&&(ke!=null&&ke.originalState)){console.log(`Reverting lab order ${ke.orderId}`);const we={tests:ke.originalState.tests,status:ke.originalState.status};await pe(`/api/lab/orders/${ke.orderId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(we)}),D(n)}else console.error("Missing orderId or originalState for edit_lab_order rollback");else console.warn(`Unknown action type for rollback: ${Be}`)}catch(we){console.error(`Failed to rollback ${Be}:`,we)}}},st=async()=>{!Ie||!window.confirm("Are you sure you want to undo the last AI actions?")||(U(!0),await ct([...Ie].reverse()),Fe(null),U(!1),L("Last actions undone successfully."))},Ht=async(je,qe)=>{Fe(null),z(null),Y(null),B(null),ie(null),V(null),se(null),re([]),oe(null);let Be=null;const ke=/```json\s*([\s\S]*?)\s*```/,we=je.match(ke);if(we&&we[1])Be=we[1];else{const Q=je.trim();if(Q.startsWith("{")&&Q.endsWith("}"))Be=Q;else if(Q.startsWith("[")&&Q.endsWith("]"))Be=Q;else throw new Error("AI response did not contain a recognized function call.")}if(Be)try{const Q=JSON.parse(Be),me=ge=>{const Te=[],De=Array.isArray(ge)?ge:[ge];for(const ze of De)ze&&(ze.actions&&Array.isArray(ze.actions)?Te.push(...me(ze.actions)):ze.sub_actions&&Array.isArray(ze.sub_actions)?Te.push(...me(ze.sub_actions)):ze.function_calls&&Array.isArray(ze.function_calls)?Te.push(...me(ze.function_calls)):typeof ze.action=="string"&&Te.push(ze));return Te},Ve=me(Q),Qe=[];let ot=null,kt=!1;for(const ge of Ve){if(ge.action==="ask_followup_question"){ot=ge,kt=!0;continue}kt=!0;const Te=ge.action;Te==="update_clinic_ai_memory"&&typeof ge.memory_content=="string"?Qe.push((async()=>{W(!0),V("Processing AI mem..."),Z==null||Z({role:"system",type:"loading",content:"Processing AI memory..."});const De=(o==null?void 0:o.aiMemory)||"";try{if(!o)throw new Error("Clinic settings not loaded.");const ze={...o,aiMemory:ge.memory_content.trim(),admissionCharge:o.admissionCharge,perDayCharge:o.perDayCharge,otherCharges:o.otherCharges,clinicWideSystemPrompt:o.clinicWideSystemPrompt},nt=await pe("/api/clinics/settings",{method:"PUT",body:JSON.stringify(ze)});if(!nt.ok){const Nt=await nt.json().catch(()=>({}));throw new Error(Nt.message||`AI-triggered clinic memory update failed: ${nt.statusText}`)}const mt=await nt.json();return fe(Nt=>Nt?{...Nt,aiMemory:mt.settings.aiMemory}:null),ae(mt.settings.aiMemory||""),V("AI mem updated!"),Z==null||Z({role:"system",type:"success",content:"AI memory updated successfully."}),{success:!0,actionType:Te,undoData:{originalMemory:De}}}catch(ze){return V("Failed"),{success:!1,actionType:Te,error:ze,originalActionPayload:ge}}finally{W(!1)}})()):Te==="create_pharmacy_order"?Qe.push((async()=>{var De,ze;$(!0),z("Processing order..."),Z==null||Z({role:"system",type:"loading",content:"Processing pharmacy order..."});try{if(!n)throw new Error("Missing patient ID.");const nt=[];let mt=null;if(Array.isArray(ge.items))for(const bt of ge.items){let yt;if(bt.drug_id?yt=b.find(Ti=>Ti.id===bt.drug_id):bt.name&&(yt=$m(bt.name,b)),!yt){mt=`Drug "${bt.name||bt.drug_id}" not found.`;break}const Ot=IW(yt.unit),vt=Number(yt.price),Wn=vt,Hi=Ot>0?vt/Ot:0,br=Number(bt.pack_quantity)||0,yn=Number(bt.loose_quantity)||0,vr=br*Wn+yn*Hi;nt.push({drug_id:String(yt.id),name:yt.name,pack_quantity:br,loose_quantity:yn,tabletsPerDay:bt.tabletsPerDay,numberOfDays:bt.numberOfDays,directions_to_use:bt.directions_to_use,group_id:bt.group_id,pack_price:Wn,loose_price:Hi,total_price:vr,price:vt,isLoose:bt.isLoose,unit:yt.unit})}if(mt)throw new Error(mt);const Nt=nt.reduce((bt,yt)=>bt+yt.total_price,0),cn={patient_id:n,items:nt,prescription_for_unavailable_drugs:ge.prescription_for_unavailable_drugs,order_total:parseFloat(Nt.toFixed(2))},gn=await pe("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(cn)});if(!gn.ok){const bt=await gn.json().catch(()=>({}));throw new Error(bt.message||"Order creation failed.")}const Cn=await gn.json();return z("Order created!"),ue(n),Z==null||Z({role:"system",type:"success",content:"Pharmacy order created successfully."}),{success:!0,actionType:Te,data:Cn,undoData:{orderId:((ze=(De=Cn.orders)==null?void 0:De[0])==null?void 0:ze.id)||Cn.id}}}catch(nt){return Z==null||Z({role:"system",type:"error",content:`Pharmacy order failed: ${nt.message}`}),{success:!1,actionType:Te,error:nt,originalActionPayload:ge}}finally{$(!1)}})()):Te==="update_patient_details"?Qe.push((async()=>{U(!0),Z==null||Z({role:"system",type:"loading",content:"Updating patient details..."});const De={...t};try{if(!n)throw new Error("Missing patient ID.");const ze={};if(ge.name&&(ze.name=ge.name),ge.age&&(ze.age=ge.age),ge.gender&&(ze.gender=ge.gender),ge.phone_number!==void 0&&(ze.phone_number=ge.phone_number),!(await pe(`/api/patients/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ze)})).ok)throw new Error("Patient update failed.");return X(n),Z==null||Z({role:"system",type:"success",content:"Patient details updated."}),{success:!0,actionType:Te,undoData:{patientId:n,originalDetails:De}}}catch(ze){return{success:!1,actionType:Te,error:ze,originalActionPayload:ge}}finally{U(!1)}})()):Te==="create_lab_order"?Qe.push((async()=>{F(!0),Y("Processing lab..."),Z==null||Z({role:"system",type:"loading",content:"Processing lab order..."});try{if(!n)throw new Error("Missing patient ID.");const De=[];for(const mt of ge.tests||[]){let Nt;if(mt.id?Nt=v.find(cn=>String(cn.id)===String(mt.id)):mt.name&&(Nt=$m(mt.name,v)),!Nt)throw new Error(`Lab test "${mt.name}" not found.`);De.push({id:Nt.id,name:Nt.name,price:Number(Nt.price)})}const ze=await pe("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:n,tests:De})});if(!ze.ok)throw new Error("Lab order creation failed.");const nt=await ze.json();return Y("Success!"),D(n),Z==null||Z({role:"system",type:"success",content:"Lab order created."}),{success:!0,actionType:Te,data:nt.labOrder,undoData:{orderId:nt.labOrder.id}}}catch(De){return Z==null||Z({role:"system",type:"error",content:`Lab order failed: ${De.message}`}),{success:!1,actionType:Te,error:De,originalActionPayload:ge}}finally{F(!1)}})()):Te==="create_lab_report"?Qe.push((async()=>{F(!0),Y("Creating Report..."),Z==null||Z({role:"system",type:"loading",content:"Creating lab report..."});try{if(!n)throw new Error("Missing patient ID.");const De=[],ze=ge.tests||[];for(const Cn of ze){let bt;if(Cn.id?bt=v.find(yt=>String(yt.id)===String(Cn.id)):Cn.name&&(bt=$m(Cn.name,v)),!bt)throw new Error(`Lab test "${Cn.name}" not found.`);Cn._matchedTest=bt,De.push({id:bt.id,name:bt.name,price:Number(bt.price)})}const nt=await pe("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:n,tests:De,status:"reported"})});if(!nt.ok)throw new Error("Lab order creation failed during report generation.");const mt=await nt.json(),Nt=mt.labOrder.id,cn={};if(ze.forEach(Cn=>{const bt=Cn._matchedTest,yt=bt.id,Ot=Cn.parameters||[],vt={};bt.default_parameters&&bt.default_parameters.forEach(Wn=>{Wn.defaultValue!==void 0&&Wn.defaultValue!==null&&(vt[Wn.name]=Wn.defaultValue)}),Ot.forEach(Wn=>{Wn.name&&Wn.value!==void 0&&(vt[Wn.name]=Wn.value)}),cn[yt]=vt}),!(await pe(`/api/lab/${Nt}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(cn)})})).ok)throw new Error("Report submission failed.");return Y("Report Created!"),D(n),ce(n),Z==null||Z({role:"system",type:"success",content:"Lab report created successfully."}),{success:!0,actionType:Te,data:mt.labOrder,undoData:{orderId:Nt}}}catch(De){return Z==null||Z({role:"system",type:"error",content:`Lab report failed: ${De.message}`}),{success:!1,actionType:Te,error:De,originalActionPayload:ge}}finally{F(!1)}})()):Te==="edit_lab_report"?Qe.push((async()=>{F(!0),Y("Updating Report...");try{const De=ge.serialNumber;if(!De)throw new Error("Missing serial number for lab report edit.");const ze=new Map;(f??[]).forEach(Ot=>ze.set(Ot.id,{...Ot})),(u??[]).forEach(Ot=>{if(ze.has(Ot.id)){const vt=ze.get(Ot.id);vt.report=Ot,vt.status=Ot.status}else ze.set(Ot.id,{...Ot,createdAt:Ot.createdAt})});const nt=Array.from(ze.values());nt.sort((Ot,vt)=>new Date(vt.createdAt).getTime()-new Date(Ot.createdAt).getTime());const mt=nt.length-De,Nt=nt[mt];if(!Nt)throw new Error(`Lab report #${De} not found.`);const cn=Nt.id;let gn={};if(Nt.report&&Nt.report.report_content)try{gn=typeof Nt.report.report_content=="string"?JSON.parse(Nt.report.report_content):Nt.report.report_content}catch{}const Cn={...gn};if((ge.tests||[]).forEach(Ot=>{let Wn=(Nt.tests||[]).find(yn=>yn.name.toLowerCase()===Ot.name.toLowerCase());if(!Wn)return;const Hi=Wn.id,br=Ot.parameters||[];Cn[Hi]||(Cn[Hi]={}),br.forEach(yn=>{yn.name&&yn.value!==void 0&&(Cn[Hi][yn.name]=yn.value)})}),!(await pe(`/api/lab/${cn}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(Cn)})})).ok)throw new Error("Report update failed.");return Y("Report Updated!"),D(n),ce(n),Z==null||Z({role:"system",type:"success",content:"Lab report updated successfully."}),{success:!0,actionType:Te,data:{orderId:cn},undoData:{orderId:cn}}}catch(De){return Z==null||Z({role:"system",type:"error",content:`Update report failed: ${De.message}`}),{success:!1,actionType:Te,error:De,originalActionPayload:ge}}finally{F(!1)}})()):Te==="edit_pharmacy_order"?Qe.push((async()=>{$(!0);try{const De=ge.serialNumber;let ze;if(De?ze=[...g].sort((yt,Ot)=>new Date(yt.date).getTime()-new Date(Ot.date).getTime())[De-1]:ze=g.find(bt=>bt.status==="pending"),!ze)throw new Error("Order to edit not found.");const nt=JSON.parse(JSON.stringify(ze));let mt=[...ze.medications];const Nt=ge.items_to_remove,cn=ge.items;if(Array.isArray(Nt)&&(mt=mt.filter(bt=>!Nt.some(yt=>yt.drug_id&&String(bt.drug_id)===String(yt.drug_id)||yt.name&&bt.name.toLowerCase()===yt.name.toLowerCase()))),Array.isArray(cn))for(const bt of cn){let yt;if(bt.drug_id?yt=b.find(Wn=>String(Wn.id)===String(bt.drug_id)):bt.name&&(yt=$m(bt.name,b)),!yt)throw new Error(`Drug ${bt.name} not found.`);const Ot=mt.findIndex(Wn=>Wn.drug_id===String(yt==null?void 0:yt.id)),vt={drug_id:String(yt.id),name:yt.name,pack_quantity:bt.pack_quantity||0,loose_quantity:bt.loose_quantity||0,pack_price:Number(yt.price),loose_price:0,total_price:0,price:Number(yt.price)};Ot>=0?mt[Ot]={...mt[Ot],...vt}:mt.push(vt)}const gn={items:mt,status:ge.status,prescription_for_unavailable_drugs:ge.prescription_for_unavailable_drugs,order_total:0};if(!(await pe(`/api/pharmacy-orders/${ze.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(gn)})).ok)throw new Error("Order edit failed.");return ue(n),{success:!0,actionType:Te,undoData:{orderId:ze.id,originalState:nt}}}catch(De){return{success:!1,actionType:Te,error:De,originalActionPayload:ge}}finally{$(!1)}})()):Te==="edit_lab_order"?Qe.push((async()=>{F(!0);try{const De=f.sort((Nt,cn)=>new Date(cn.createdAt).getTime()-new Date(Nt.createdAt).getTime()).find(Nt=>Nt.status==="pending");if(!De)throw new Error("No pending lab order to edit.");const ze=JSON.parse(JSON.stringify(De)),nt={tests:[],status:ge.status};if(!(await pe(`/api/lab/orders/${De.id}`,{method:"PUT",body:JSON.stringify(nt),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Lab edit failed.");return D(n),{success:!0,actionType:Te,undoData:{orderId:De.id,originalState:ze}}}catch(De){return{success:!1,actionType:Te,error:De,originalActionPayload:ge}}finally{F(!1)}})()):Te==="add_complaint_history"?Qe.push((async()=>{R(!0),Z==null||Z({role:"system",type:"loading",content:"Updating complaint history..."});const De=S;try{if(!e)throw new Error("No record ID.");if(!(await pe(`/api/queue/doctor/complaint/${e}`,{method:"PUT",body:JSON.stringify({complaint:ge.complaint}),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Complaint update failed.");return k(ge.complaint),n&&ve(n),Z==null||Z({role:"system",type:"success",content:"Complaint history updated."}),{success:!0,actionType:Te,undoData:{recordId:e,originalComplaint:De}}}catch(ze){return Z==null||Z({role:"system",type:"error",content:`Complaint history update failed: ${ze.message}`}),{success:!1,actionType:Te,error:ze,originalActionPayload:ge}}finally{R(!1)}})()):Te==="update_case_summary"?Qe.push((async()=>{G(!0),Z==null||Z({role:"system",type:"loading",content:"Updating case summary..."});const De=r;try{if(!e)throw new Error("No record ID.");const ze=await pe(`/api/queue/doctor/complaint/${e}`,{method:"PUT",body:JSON.stringify({case_summary:ge.summary}),headers:{"Content-Type":"application/json"}});if(!ze.ok)throw new Error("Summary update failed.");const nt=await ze.json();return te(nt.case_summary),Z==null||Z({role:"system",type:"success",content:"Case summary updated."}),{success:!0,actionType:Te,undoData:{recordId:e,originalSummary:De}}}catch(ze){return Z==null||Z({role:"system",type:"error",content:`Case summary update failed: ${ze.message}`}),{success:!1,actionType:Te,error:ze,originalActionPayload:ge}}finally{G(!1)}})()):(console.warn(`Unknown action ${Te}`),Qe.push(Promise.resolve({success:!1,actionType:Te,error:new Error(`Unknown action: ${Te}`),originalActionPayload:ge})))}const qt=await Promise.all(Qe),be=qt.filter(ge=>!ge.success);if(be.length>0){console.log("AI Actions Failed. Initiating Rollback...",be);const ge=qt.filter(mt=>mt.success),Te=[...ge].reverse();await ct(Te);const De=be.map(mt=>{var Nt;return`${mt.actionType}: ${(Nt=mt.error)==null?void 0:Nt.message}`}).join("; "),ze=ge.length>0?` I successfully rolled back ${ge.length} other actions that succeeded.`:"",nt=`One or more actions failed: [${De}].${ze} Please analyze the failure and try again.`;await lt("multiple_actions",{message:nt},je,qe)}else{const ge=qt.filter(Te=>Te.success);if(ge.length>0&&(Fe(ge),Ke&&ge.forEach(Te=>Ke(Te.actionType))),ot&&typeof ot.question=="string")se(ot.question),re(Array.isArray(ot.options)?ot.options:[]);else if(!kt)throw new Error("AI response did not result in a recognized or performed function call.")}}catch(Q){await lt("parse_json_actions",Q,je,qe)}else throw new Error("AI response did not contain a recognized function call.")};rt=async(je,qe=0)=>{if(qe>1){L("AI call failed after multiple retries. Please try a different prompt."),U(!1);return}U(!0),L(null);let Be;const we=[...l,je].join(`

`);try{const Q=new Map;(f??[]).forEach(be=>{Q.set(be.id,{...be})}),(u??[]).forEach(be=>{if(!Q.has(be.id))Q.set(be.id,{id:be.id,patient_id:be.patient_id,tests:be.tests,status:be.status,createdAt:be.createdAt,report:be});else{const ge=Q.get(be.id);ge&&(ge.report=be,ge.status=be.status)}});const me=Array.from(Q.values());me.sort((be,ge)=>new Date(ge.createdAt).getTime()-new Date(be.createdAt).getTime());const Ve=me.map((be,ge)=>{let Te=null;if(be.report)try{const De=typeof be.report.report_content=="string"?be.report.report_content:JSON.stringify(be.report.report_content||{}),ze=JSON.parse(De||"{}"),nt=(be.report.tests||[]).map(mt=>{const Nt=ze[mt.id]||{},cn=gn=>({name:gn.name,value:Nt[gn.name]!==void 0?String(Nt[gn.name]):String(gn.defaultValue),normal_range:gn.normal_range||"N/A"});return{testId:mt.id,testName:mt.name,parameters:(mt.default_parameters||[]).map(cn)}});Te={reportId:be.report.reportId,reportDate:be.report.report_date,tests:nt}}catch{Te={reportId:be.report.reportId,reportDate:be.report.report_date,reportContent:typeof be.report.report_content=="string"?be.report.report_content:JSON.stringify(be.report.report_content),error:"Failed to parse report content JSON."}}return{serialNumber:me.length-ge,orderId:be.id,orderDate:isNaN(new Date(be.createdAt).getTime())?be.createdAt:new Date(be.createdAt).toISOString(),tests:be.tests.map(De=>({id:De.id,name:De.name,price:De.price})),status:be.status,report:Te}}),Qe=p.map(be=>{try{return{...be,createdAt:isNaN(new Date(be.createdAt).getTime())?be.createdAt:new Date(be.createdAt).toISOString()}}catch{return be}}),kt=[...g].sort((be,ge)=>{const Te=new Date(be.date).getTime(),De=new Date(ge.date).getTime();return Te-De}).map((be,ge)=>{try{return{serialNumber:ge+1,...be,date:be.date&&!isNaN(new Date(be.date).getTime())?new Date(be.date).toISOString():be.date}}catch{return{serialNumber:ge+1,...be}}}),qt={query:we,currentDateTime:new Date().toISOString(),patientName:(t==null?void 0:t.name)||"",patientAge:(t==null?void 0:t.age)||void 0,patientGender:(t==null?void 0:t.gender)||void 0,case_summary:r||"",case_summary_last_updated:a?new Date(a).toISOString():void 0,clinic_ai_memory:(o==null?void 0:o.aiMemory)||"",clinic_ai_memory_last_updated:o!=null&&o.aiMemoryUpdatedAt?new Date(o.aiMemoryUpdatedAt).toISOString():void 0,clinic_wide_system_prompt:(o==null?void 0:o.clinicWideSystemPrompt)||"",labHistory:Ve,pharmacyOrders:kt,pastComplaints:Qe,pharmacyInventory:b,labInventory:v};if(console.log("DEBUG: Payload before sending to Gemini API:",JSON.stringify(qt,null,2)),Be=await DW(qt,d),Be){T(Be),Z==null||Z({role:"ai",content:Be});const be=/```json\s*([\s\S]*?)\s*```/,ge=Be.match(be);if(ge&&ge[1])P(Be.replace(be,"").trim()),M(ge[1].trim());else{const Te=Be.trim();if(Te.startsWith("{")&&Te.endsWith("}"))try{JSON.parse(Te),P(""),M(Te)}catch{P(Te),M(null)}else if(Te.startsWith("[")&&Te.endsWith("]"))try{JSON.parse(Te),P(""),M(Te)}catch{P(Te),M(null)}else P(Te),M(null)}I(!1),n&&Be&&await rn(n,Be),await Ht(Be,qe),k("")}else throw new Error("Invalid AI response format.")}catch(Q){await lt("call_generative_api",Q,Be,qe)}finally{U(!1)}};const rn=async(je,qe)=>{E(!0),le(null);try{const Be={ai_response:qe},ke=await pe(`/api/patients/${je}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Be)});if(!ke.ok){const we=await ke.json().catch(()=>({}));throw new Error(we.message||`Failed to save AI response to patient: ${ke.statusText}`)}}catch(Be){le(`AI Response Save Error: ${Be.message}`),Z==null||Z({role:"system",type:"error",content:`AI Response Save Error: ${Be.message}`})}finally{E(!1)}};return w.useImperativeHandle(Ee,()=>({callGenerativeApi:rt,undoLastAction:st})),null}),MW={};function Vw(e,n){const t=MW,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return hE(e,r,a)}function hE(e,n,t){if(OW(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return zj(e.children,n,t)}return Array.isArray(e)?zj(e,n,t):""}function zj(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=hE(e[a],n,t);return r.join("")}function OW(e){return!!(e&&typeof e=="object")}const Uj=document.createElement("i");function Hw(e){const n="&"+e+";";Uj.innerHTML=n;const t=Uj.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function Xo(e,n,t,r){const a=e.length;let o=0,l;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)l=Array.from(r),l.unshift(n,t),e.splice(...l);else for(t&&e.splice(n,t);o<r.length;)l=r.slice(o,o+1e4),l.unshift(n,0),e.splice(...l),o+=1e4,n+=1e4}function cs(e,n){return e.length>0?(Xo(e,e.length,0,n),e):n}const Bj={}.hasOwnProperty;function LW(e){const n={};let t=-1;for(;++t<e.length;)FW(n,e[t]);return n}function FW(e,n){let t;for(t in n){const a=(Bj.call(e,t)?e[t]:void 0)||(e[t]={}),o=n[t];let l;if(o)for(l in o){Bj.call(a,l)||(a[l]=[]);const d=o[l];$W(a[l],Array.isArray(d)?d:d?[d]:[])}}}function $W(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);Xo(e,0,0,r)}function pE(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function _h(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Wo=yu(/[A-Za-z]/),Ia=yu(/[\dA-Za-z]/),zW=yu(/[#-'*+\--9=?A-Z^-~]/);function O1(e){return e!==null&&(e<32||e===127)}const L1=yu(/\d/),UW=yu(/[\dA-Fa-f]/),BW=yu(/[!-/:-@[-`{-~]/);function Bt(e){return e!==null&&e<-2}function fa(e){return e!==null&&(e<0||e===32)}function Mn(e){return e===-2||e===-1||e===32}const qW=yu(new RegExp("\\p{P}|\\p{S}","u")),VW=yu(/\s/);function yu(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function Yh(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const o=e.charCodeAt(t);let l="";if(o===37&&Ia(e.charCodeAt(t+1))&&Ia(e.charCodeAt(t+2)))a=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(l=String.fromCharCode(o));else if(o>55295&&o<57344){const d=e.charCodeAt(t+1);o<56320&&d>56319&&d<57344?(l=String.fromCharCode(o,d),a=1):l=""}else l=String.fromCharCode(o);l&&(n.push(e.slice(r,t),encodeURIComponent(l)),r=t+a+1,l=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function sr(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let o=0;return l;function l(f){return Mn(f)?(e.enter(t),d(f)):n(f)}function d(f){return Mn(f)&&o++<a?(e.consume(f),d):(e.exit(t),n(f))}}const HW={tokenize:GW};function GW(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(d){if(d===null){e.consume(d);return}return e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),sr(e,n,"linePrefix")}function a(d){return e.enter("paragraph"),o(d)}function o(d){const f=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=f),t=f,l(d)}function l(d){if(d===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(d);return}return Bt(d)?(e.consume(d),e.exit("chunkText"),o):(e.consume(d),l)}}const YW={tokenize:WW},qj={tokenize:QW};function WW(e){const n=this,t=[];let r=0,a,o,l;return d;function d(I){if(r<t.length){const U=t[r];return n.containerState=U[1],e.attempt(U[0].continuation,f,u)(I)}return u(I)}function f(I){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&M();const U=n.events.length;let L=U,$;for(;L--;)if(n.events[L][0]==="exit"&&n.events[L][1].type==="chunkFlow"){$=n.events[L][1].end;break}P(r);let z=U;for(;z<n.events.length;)n.events[z][1].end={...$},z++;return Xo(n.events,L+1,0,n.events.slice(U)),n.events.length=z,u(I)}return d(I)}function u(I){if(r===t.length){if(!a)return b(I);if(a.currentConstruct&&a.currentConstruct.concrete)return S(I);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(qj,p,g)(I)}function p(I){return a&&M(),P(r),b(I)}function g(I){return n.parser.lazy[n.now().line]=r!==t.length,l=n.now().offset,S(I)}function b(I){return n.containerState={},e.attempt(qj,v,S)(I)}function v(I){return r++,t.push([n.currentConstruct,n.containerState]),b(I)}function S(I){if(I===null){a&&M(),P(0),e.consume(I);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:o}),k(I)}function k(I){if(I===null){T(e.exit("chunkFlow"),!0),P(0),e.consume(I);return}return Bt(I)?(e.consume(I),T(e.exit("chunkFlow")),r=0,n.interrupt=void 0,d):(e.consume(I),k)}function T(I,U){const L=n.sliceStream(I);if(U&&L.push(null),I.previous=o,o&&(o.next=I),o=I,a.defineSkip(I.start),a.write(L),n.parser.lazy[I.start.line]){let $=a.events.length;for(;$--;)if(a.events[$][1].start.offset<l&&(!a.events[$][1].end||a.events[$][1].end.offset>l))return;const z=n.events.length;let F=z,Y,R;for(;F--;)if(n.events[F][0]==="exit"&&n.events[F][1].type==="chunkFlow"){if(Y){R=n.events[F][1].end;break}Y=!0}for(P(r),$=z;$<n.events.length;)n.events[$][1].end={...R},$++;Xo(n.events,F+1,0,n.events.slice(z)),n.events.length=$}}function P(I){let U=t.length;for(;U-- >I;){const L=t[U];n.containerState=L[1],L[0].exit.call(n,e)}t.length=I}function M(){a.write([null]),o=void 0,a=void 0,n.containerState._closeFlow=void 0}}function QW(e,n,t){return sr(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function pb(e){if(e===null||fa(e)||VW(e))return 1;if(qW(e))return 2}function Gw(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const o=e[a].resolveAll;o&&!r.includes(o)&&(n=o(n,t),r.push(o))}return n}const F1={name:"attention",resolveAll:JW,tokenize:KW};function JW(e,n){let t=-1,r,a,o,l,d,f,u,p;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;f=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};Vj(g,-f),Vj(b,f),l={type:f>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},d={type:f>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},o={type:f>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:f>1?"strong":"emphasis",start:{...l.start},end:{...d.end}},e[r][1].end={...l.start},e[t][1].start={...d.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=cs(u,[["enter",e[r][1],n],["exit",e[r][1],n]])),u=cs(u,[["enter",a,n],["enter",l,n],["exit",l,n],["enter",o,n]]),u=cs(u,Gw(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),u=cs(u,[["exit",o,n],["enter",d,n],["exit",d,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(p=2,u=cs(u,[["enter",e[t][1],n],["exit",e[t][1],n]])):p=0,Xo(e,r-1,t-r+3,u),t=r+u.length-p-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function KW(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=pb(r);let o;return l;function l(f){return o=f,e.enter("attentionSequence"),d(f)}function d(f){if(f===o)return e.consume(f),d;const u=e.exit("attentionSequence"),p=pb(f),g=!p||p===2&&a||t.includes(f),b=!a||a===2&&p||t.includes(r);return u._open=!!(o===42?g:g&&(a||!b)),u._close=!!(o===42?b:b&&(p||!g)),n(f)}}function Vj(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const XW={name:"autolink",tokenize:ZW};function ZW(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o}function o(v){return Wo(v)?(e.consume(v),l):v===64?t(v):u(v)}function l(v){return v===43||v===45||v===46||Ia(v)?(r=1,d(v)):u(v)}function d(v){return v===58?(e.consume(v),r=0,f):(v===43||v===45||v===46||Ia(v))&&r++<32?(e.consume(v),d):(r=0,u(v))}function f(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||O1(v)?t(v):(e.consume(v),f)}function u(v){return v===64?(e.consume(v),p):zW(v)?(e.consume(v),u):t(v)}function p(v){return Ia(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,p):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||Ia(v))&&r++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const qb={partial:!0,tokenize:eQ};function eQ(e,n,t){return r;function r(o){return Mn(o)?sr(e,a,"linePrefix")(o):a(o)}function a(o){return o===null||Bt(o)?n(o):t(o)}}const mE={continuation:{tokenize:nQ},exit:rQ,name:"blockQuote",tokenize:tQ};function tQ(e,n,t){const r=this;return a;function a(l){if(l===62){const d=r.containerState;return d.open||(e.enter("blockQuote",{_container:!0}),d.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),o}return t(l)}function o(l){return Mn(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(l))}}function nQ(e,n,t){const r=this;return a;function a(l){return Mn(l)?sr(e,o,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):o(l)}function o(l){return e.attempt(mE,n,t)(l)}}function rQ(e){e.exit("blockQuote")}const gE={name:"characterEscape",tokenize:iQ};function iQ(e,n,t){return r;function r(o){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(o),e.exit("escapeMarker"),a}function a(o){return BW(o)?(e.enter("characterEscapeValue"),e.consume(o),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(o)}}const yE={name:"characterReference",tokenize:aQ};function aQ(e,n,t){const r=this;let a=0,o,l;return d;function d(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),f}function f(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),o=31,l=Ia,p(g))}function u(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,l=UW,p):(e.enter("characterReferenceValue"),o=7,l=L1,p(g))}function p(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return l===Ia&&!Hw(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return l(g)&&a++<o?(e.consume(g),p):t(g)}}const Hj={partial:!0,tokenize:oQ},Gj={concrete:!0,name:"codeFenced",tokenize:sQ};function sQ(e,n,t){const r=this,a={partial:!0,tokenize:L};let o=0,l=0,d;return f;function f($){return u($)}function u($){const z=r.events[r.events.length-1];return o=z&&z[1].type==="linePrefix"?z[2].sliceSerialize(z[1],!0).length:0,d=$,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),p($)}function p($){return $===d?(l++,e.consume($),p):l<3?t($):(e.exit("codeFencedFenceSequence"),Mn($)?sr(e,g,"whitespace")($):g($))}function g($){return $===null||Bt($)?(e.exit("codeFencedFence"),r.interrupt?n($):e.check(Hj,k,U)($)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b($))}function b($){return $===null||Bt($)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g($)):Mn($)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),sr(e,v,"whitespace")($)):$===96&&$===d?t($):(e.consume($),b)}function v($){return $===null||Bt($)?g($):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S($))}function S($){return $===null||Bt($)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g($)):$===96&&$===d?t($):(e.consume($),S)}function k($){return e.attempt(a,U,T)($)}function T($){return e.enter("lineEnding"),e.consume($),e.exit("lineEnding"),P}function P($){return o>0&&Mn($)?sr(e,M,"linePrefix",o+1)($):M($)}function M($){return $===null||Bt($)?e.check(Hj,k,U)($):(e.enter("codeFlowValue"),I($))}function I($){return $===null||Bt($)?(e.exit("codeFlowValue"),M($)):(e.consume($),I)}function U($){return e.exit("codeFenced"),n($)}function L($,z,F){let Y=0;return R;function R(W){return $.enter("lineEnding"),$.consume(W),$.exit("lineEnding"),B}function B(W){return $.enter("codeFencedFence"),Mn(W)?sr($,G,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(W):G(W)}function G(W){return W===d?($.enter("codeFencedFenceSequence"),ie(W)):F(W)}function ie(W){return W===d?(Y++,$.consume(W),ie):Y>=l?($.exit("codeFencedFenceSequence"),Mn(W)?sr($,te,"whitespace")(W):te(W)):F(W)}function te(W){return W===null||Bt(W)?($.exit("codeFencedFence"),z(W)):F(W)}}}function oQ(e,n,t){const r=this;return a;function a(l){return l===null?t(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}const D0={name:"codeIndented",tokenize:cQ},lQ={partial:!0,tokenize:uQ};function cQ(e,n,t){const r=this;return a;function a(u){return e.enter("codeIndented"),sr(e,o,"linePrefix",5)(u)}function o(u){const p=r.events[r.events.length-1];return p&&p[1].type==="linePrefix"&&p[2].sliceSerialize(p[1],!0).length>=4?l(u):t(u)}function l(u){return u===null?f(u):Bt(u)?e.attempt(lQ,l,f)(u):(e.enter("codeFlowValue"),d(u))}function d(u){return u===null||Bt(u)?(e.exit("codeFlowValue"),l(u)):(e.consume(u),d)}function f(u){return e.exit("codeIndented"),n(u)}}function uQ(e,n,t){const r=this;return a;function a(l){return r.parser.lazy[r.now().line]?t(l):Bt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):sr(e,o,"linePrefix",5)(l)}function o(l){const d=r.events[r.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):Bt(l)?a(l):t(l)}}const dQ={name:"codeText",previous:hQ,resolve:fQ,tokenize:pQ};function fQ(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function hQ(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function pQ(e,n,t){let r=0,a,o;return l;function l(g){return e.enter("codeText"),e.enter("codeTextSequence"),d(g)}function d(g){return g===96?(e.consume(g),r++,d):(e.exit("codeTextSequence"),f(g))}function f(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),f):g===96?(o=e.enter("codeTextSequence"),a=0,p(g)):Bt(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),f):(e.enter("codeTextData"),u(g))}function u(g){return g===null||g===32||g===96||Bt(g)?(e.exit("codeTextData"),f(g)):(e.consume(g),u)}function p(g){return g===96?(e.consume(g),a++,p):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(o.type="codeTextData",u(g))}}class mQ{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const o=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&Mm(this.left,r),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Mm(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Mm(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Mm(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Mm(this.left,t.reverse())}}}function Mm(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function xE(e){const n={};let t=-1,r,a,o,l,d,f,u;const p=new mQ(e);for(;++t<p.length;){for(;t in n;)t=n[t];if(r=p.get(t),t&&r[1].type==="chunkFlow"&&p.get(t-1)[1].type==="listItemPrefix"&&(f=r[1]._tokenizer.events,o=0,o<f.length&&f[o][1].type==="lineEndingBlank"&&(o+=2),o<f.length&&f[o][1].type==="content"))for(;++o<f.length&&f[o][1].type!=="content";)f[o][1].type==="chunkText"&&(f[o][1]._isInFirstContentOfListItem=!0,o++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,gQ(p,t)),t=n[t],u=!0);else if(r[1]._container){for(o=t,a=void 0;o--;)if(l=p.get(o),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(p.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=o);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(r[1].end={...p.get(a)[1].start},d=p.slice(a,t),d.unshift(r),p.splice(a,t-a+1,d))}}return Xo(e,0,Number.POSITIVE_INFINITY,p.slice(0)),!u}function gQ(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const o=[];let l=t._tokenizer;l||(l=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const d=l.events,f=[],u={};let p,g,b=-1,v=t,S=0,k=0;const T=[k];for(;v;){for(;e.get(++a)[1]!==v;);o.push(a),v._tokenizer||(p=r.sliceStream(v),v.next||p.push(null),g&&l.defineSkip(v.start),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(p),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<d.length;)d[b][0]==="exit"&&d[b-1][0]==="enter"&&d[b][1].type===d[b-1][1].type&&d[b][1].start.line!==d[b][1].end.line&&(k=b+1,T.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(l.events=[],v?(v._tokenizer=void 0,v.previous=void 0):T.pop(),b=T.length;b--;){const P=d.slice(T[b],T[b+1]),M=o.pop();f.push([M,M+P.length-1]),e.splice(M,2,P)}for(f.reverse(),b=-1;++b<f.length;)u[S+f[b][0]]=S+f[b][1],S+=f[b][1]-f[b][0]-1;return u}const yQ={resolve:bQ,tokenize:vQ},xQ={partial:!0,tokenize:wQ};function bQ(e){return xE(e),e}function vQ(e,n){let t;return r;function r(d){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(d)}function a(d){return d===null?o(d):Bt(d)?e.check(xQ,l,o)(d):(e.consume(d),a)}function o(d){return e.exit("chunkContent"),e.exit("content"),n(d)}function l(d){return e.consume(d),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function wQ(e,n,t){const r=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),sr(e,o,"linePrefix")}function o(l){if(l===null||Bt(l))return t(l);const d=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):e.interrupt(r.parser.constructs.flow,t,n)(l)}}function bE(e,n,t,r,a,o,l,d,f){const u=f||Number.POSITIVE_INFINITY;let p=0;return g;function g(P){return P===60?(e.enter(r),e.enter(a),e.enter(o),e.consume(P),e.exit(o),b):P===null||P===32||P===41||O1(P)?t(P):(e.enter(r),e.enter(l),e.enter(d),e.enter("chunkString",{contentType:"string"}),k(P))}function b(P){return P===62?(e.enter(o),e.consume(P),e.exit(o),e.exit(a),e.exit(r),n):(e.enter(d),e.enter("chunkString",{contentType:"string"}),v(P))}function v(P){return P===62?(e.exit("chunkString"),e.exit(d),b(P)):P===null||P===60||Bt(P)?t(P):(e.consume(P),P===92?S:v)}function S(P){return P===60||P===62||P===92?(e.consume(P),v):v(P)}function k(P){return!p&&(P===null||P===41||fa(P))?(e.exit("chunkString"),e.exit(d),e.exit(l),e.exit(r),n(P)):p<u&&P===40?(e.consume(P),p++,k):P===41?(e.consume(P),p--,k):P===null||P===32||P===40||O1(P)?t(P):(e.consume(P),P===92?T:k)}function T(P){return P===40||P===41||P===92?(e.consume(P),k):k(P)}}function vE(e,n,t,r,a,o){const l=this;let d=0,f;return u;function u(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(o),p}function p(v){return d>999||v===null||v===91||v===93&&!f||v===94&&!d&&"_hiddenFootnoteSupport"in l.parser.constructs?t(v):v===93?(e.exit(o),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):Bt(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),p):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||Bt(v)||d++>999?(e.exit("chunkString"),p(v)):(e.consume(v),f||(f=!Mn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),d++,g):g(v)}}function wE(e,n,t,r,a,o){let l;return d;function d(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),l=b===40?41:b,f):t(b)}function f(b){return b===l?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(o),u(b))}function u(b){return b===l?(e.exit(o),f(l)):b===null?t(b):Bt(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),sr(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),p(b))}function p(b){return b===l||b===null||Bt(b)?(e.exit("chunkString"),u(b)):(e.consume(b),b===92?g:p)}function g(b){return b===l||b===92?(e.consume(b),p):p(b)}}function qm(e,n){let t;return r;function r(a){return Bt(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):Mn(a)?sr(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const SQ={name:"definition",tokenize:CQ},NQ={partial:!0,tokenize:jQ};function CQ(e,n,t){const r=this;let a;return o;function o(v){return e.enter("definition"),l(v)}function l(v){return vE.call(r,e,d,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function d(v){return a=_h(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),f):t(v)}function f(v){return fa(v)?qm(e,u)(v):u(v)}function u(v){return bE(e,p,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function p(v){return e.attempt(NQ,g,g)(v)}function g(v){return Mn(v)?sr(e,b,"whitespace")(v):b(v)}function b(v){return v===null||Bt(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function jQ(e,n,t){return r;function r(d){return fa(d)?qm(e,a)(d):t(d)}function a(d){return wE(e,o,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(d)}function o(d){return Mn(d)?sr(e,l,"whitespace")(d):l(d)}function l(d){return d===null||Bt(d)?n(d):t(d)}}const _Q={name:"hardBreakEscape",tokenize:kQ};function kQ(e,n,t){return r;function r(o){return e.enter("hardBreakEscape"),e.consume(o),a}function a(o){return Bt(o)?(e.exit("hardBreakEscape"),n(o)):t(o)}}const TQ={name:"headingAtx",resolve:EQ,tokenize:AQ};function EQ(e,n){let t=e.length-2,r=3,a,o;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},o={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},Xo(e,r,t-r+1,[["enter",a,n],["enter",o,n],["exit",o,n],["exit",a,n]])),e}function AQ(e,n,t){let r=0;return a;function a(p){return e.enter("atxHeading"),o(p)}function o(p){return e.enter("atxHeadingSequence"),l(p)}function l(p){return p===35&&r++<6?(e.consume(p),l):p===null||fa(p)?(e.exit("atxHeadingSequence"),d(p)):t(p)}function d(p){return p===35?(e.enter("atxHeadingSequence"),f(p)):p===null||Bt(p)?(e.exit("atxHeading"),n(p)):Mn(p)?sr(e,d,"whitespace")(p):(e.enter("atxHeadingText"),u(p))}function f(p){return p===35?(e.consume(p),f):(e.exit("atxHeadingSequence"),d(p))}function u(p){return p===null||p===35||fa(p)?(e.exit("atxHeadingText"),d(p)):(e.consume(p),u)}}const PQ=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Yj=["pre","script","style","textarea"],DQ={concrete:!0,name:"htmlFlow",resolveTo:MQ,tokenize:OQ},IQ={partial:!0,tokenize:FQ},RQ={partial:!0,tokenize:LQ};function MQ(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function OQ(e,n,t){const r=this;let a,o,l,d,f;return u;function u(D){return p(D)}function p(D){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(D),g}function g(D){return D===33?(e.consume(D),b):D===47?(e.consume(D),o=!0,k):D===63?(e.consume(D),a=3,r.interrupt?n:E):Wo(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function b(D){return D===45?(e.consume(D),a=2,v):D===91?(e.consume(D),a=5,d=0,S):Wo(D)?(e.consume(D),a=4,r.interrupt?n:E):t(D)}function v(D){return D===45?(e.consume(D),r.interrupt?n:E):t(D)}function S(D){const ce="CDATA[";return D===ce.charCodeAt(d++)?(e.consume(D),d===ce.length?r.interrupt?n:G:S):t(D)}function k(D){return Wo(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function T(D){if(D===null||D===47||D===62||fa(D)){const ce=D===47,ve=l.toLowerCase();return!ce&&!o&&Yj.includes(ve)?(a=1,r.interrupt?n(D):G(D)):PQ.includes(l.toLowerCase())?(a=6,ce?(e.consume(D),P):r.interrupt?n(D):G(D)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(D):o?M(D):I(D))}return D===45||Ia(D)?(e.consume(D),l+=String.fromCharCode(D),T):t(D)}function P(D){return D===62?(e.consume(D),r.interrupt?n:G):t(D)}function M(D){return Mn(D)?(e.consume(D),M):R(D)}function I(D){return D===47?(e.consume(D),R):D===58||D===95||Wo(D)?(e.consume(D),U):Mn(D)?(e.consume(D),I):R(D)}function U(D){return D===45||D===46||D===58||D===95||Ia(D)?(e.consume(D),U):L(D)}function L(D){return D===61?(e.consume(D),$):Mn(D)?(e.consume(D),L):I(D)}function $(D){return D===null||D===60||D===61||D===62||D===96?t(D):D===34||D===39?(e.consume(D),f=D,z):Mn(D)?(e.consume(D),$):F(D)}function z(D){return D===f?(e.consume(D),f=null,Y):D===null||Bt(D)?t(D):(e.consume(D),z)}function F(D){return D===null||D===34||D===39||D===47||D===60||D===61||D===62||D===96||fa(D)?L(D):(e.consume(D),F)}function Y(D){return D===47||D===62||Mn(D)?I(D):t(D)}function R(D){return D===62?(e.consume(D),B):t(D)}function B(D){return D===null||Bt(D)?G(D):Mn(D)?(e.consume(D),B):t(D)}function G(D){return D===45&&a===2?(e.consume(D),V):D===60&&a===1?(e.consume(D),se):D===62&&a===4?(e.consume(D),le):D===63&&a===3?(e.consume(D),E):D===93&&a===5?(e.consume(D),oe):Bt(D)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(IQ,ue,ie)(D)):D===null||Bt(D)?(e.exit("htmlFlowData"),ie(D)):(e.consume(D),G)}function ie(D){return e.check(RQ,te,ue)(D)}function te(D){return e.enter("lineEnding"),e.consume(D),e.exit("lineEnding"),W}function W(D){return D===null||Bt(D)?ie(D):(e.enter("htmlFlowData"),G(D))}function V(D){return D===45?(e.consume(D),E):G(D)}function se(D){return D===47?(e.consume(D),l="",re):G(D)}function re(D){if(D===62){const ce=l.toLowerCase();return Yj.includes(ce)?(e.consume(D),le):G(D)}return Wo(D)&&l.length<8?(e.consume(D),l+=String.fromCharCode(D),re):G(D)}function oe(D){return D===93?(e.consume(D),E):G(D)}function E(D){return D===62?(e.consume(D),le):D===45&&a===2?(e.consume(D),E):G(D)}function le(D){return D===null||Bt(D)?(e.exit("htmlFlowData"),ue(D)):(e.consume(D),le)}function ue(D){return e.exit("htmlFlow"),n(D)}}function LQ(e,n,t){const r=this;return a;function a(l){return Bt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o):t(l)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}function FQ(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(qb,n,t)}}const $Q={name:"htmlText",tokenize:zQ};function zQ(e,n,t){const r=this;let a,o,l;return d;function d(E){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(E),f}function f(E){return E===33?(e.consume(E),u):E===47?(e.consume(E),L):E===63?(e.consume(E),I):Wo(E)?(e.consume(E),F):t(E)}function u(E){return E===45?(e.consume(E),p):E===91?(e.consume(E),o=0,S):Wo(E)?(e.consume(E),M):t(E)}function p(E){return E===45?(e.consume(E),v):t(E)}function g(E){return E===null?t(E):E===45?(e.consume(E),b):Bt(E)?(l=g,se(E)):(e.consume(E),g)}function b(E){return E===45?(e.consume(E),v):g(E)}function v(E){return E===62?V(E):E===45?b(E):g(E)}function S(E){const le="CDATA[";return E===le.charCodeAt(o++)?(e.consume(E),o===le.length?k:S):t(E)}function k(E){return E===null?t(E):E===93?(e.consume(E),T):Bt(E)?(l=k,se(E)):(e.consume(E),k)}function T(E){return E===93?(e.consume(E),P):k(E)}function P(E){return E===62?V(E):E===93?(e.consume(E),P):k(E)}function M(E){return E===null||E===62?V(E):Bt(E)?(l=M,se(E)):(e.consume(E),M)}function I(E){return E===null?t(E):E===63?(e.consume(E),U):Bt(E)?(l=I,se(E)):(e.consume(E),I)}function U(E){return E===62?V(E):I(E)}function L(E){return Wo(E)?(e.consume(E),$):t(E)}function $(E){return E===45||Ia(E)?(e.consume(E),$):z(E)}function z(E){return Bt(E)?(l=z,se(E)):Mn(E)?(e.consume(E),z):V(E)}function F(E){return E===45||Ia(E)?(e.consume(E),F):E===47||E===62||fa(E)?Y(E):t(E)}function Y(E){return E===47?(e.consume(E),V):E===58||E===95||Wo(E)?(e.consume(E),R):Bt(E)?(l=Y,se(E)):Mn(E)?(e.consume(E),Y):V(E)}function R(E){return E===45||E===46||E===58||E===95||Ia(E)?(e.consume(E),R):B(E)}function B(E){return E===61?(e.consume(E),G):Bt(E)?(l=B,se(E)):Mn(E)?(e.consume(E),B):Y(E)}function G(E){return E===null||E===60||E===61||E===62||E===96?t(E):E===34||E===39?(e.consume(E),a=E,ie):Bt(E)?(l=G,se(E)):Mn(E)?(e.consume(E),G):(e.consume(E),te)}function ie(E){return E===a?(e.consume(E),a=void 0,W):E===null?t(E):Bt(E)?(l=ie,se(E)):(e.consume(E),ie)}function te(E){return E===null||E===34||E===39||E===60||E===61||E===96?t(E):E===47||E===62||fa(E)?Y(E):(e.consume(E),te)}function W(E){return E===47||E===62||fa(E)?Y(E):t(E)}function V(E){return E===62?(e.consume(E),e.exit("htmlTextData"),e.exit("htmlText"),n):t(E)}function se(E){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(E),e.exit("lineEnding"),re}function re(E){return Mn(E)?sr(e,oe,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(E):oe(E)}function oe(E){return e.enter("htmlTextData"),l(E)}}const Yw={name:"labelEnd",resolveAll:VQ,resolveTo:HQ,tokenize:GQ},UQ={tokenize:YQ},BQ={tokenize:WQ},qQ={tokenize:QQ};function VQ(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&Xo(e,0,e.length,t),e}function HQ(e,n){let t=e.length,r=0,a,o,l,d;for(;t--;)if(a=e[t][1],o){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(o=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(l=t);const f={type:e[o][1].type==="labelLink"?"link":"image",start:{...e[o][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[o][1].start},end:{...e[l][1].end}},p={type:"labelText",start:{...e[o+r+2][1].end},end:{...e[l-2][1].start}};return d=[["enter",f,n],["enter",u,n]],d=cs(d,e.slice(o+1,o+r+3)),d=cs(d,[["enter",p,n]]),d=cs(d,Gw(n.parser.constructs.insideSpan.null,e.slice(o+r+4,l-3),n)),d=cs(d,[["exit",p,n],e[l-2],e[l-1],["exit",u,n]]),d=cs(d,e.slice(l+1)),d=cs(d,[["exit",f,n]]),Xo(e,o,e.length,d),e}function GQ(e,n,t){const r=this;let a=r.events.length,o,l;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){o=r.events[a][1];break}return d;function d(b){return o?o._inactive?g(b):(l=r.parser.defined.includes(_h(r.sliceSerialize({start:o.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),f):t(b)}function f(b){return b===40?e.attempt(UQ,p,l?p:g)(b):b===91?e.attempt(BQ,p,l?u:g)(b):l?p(b):g(b)}function u(b){return e.attempt(qQ,p,g)(b)}function p(b){return n(b)}function g(b){return o._balanced=!0,t(b)}}function YQ(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return fa(g)?qm(e,o)(g):o(g)}function o(g){return g===41?p(g):bE(e,l,d,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function l(g){return fa(g)?qm(e,f)(g):p(g)}function d(g){return t(g)}function f(g){return g===34||g===39||g===40?wE(e,u,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):p(g)}function u(g){return fa(g)?qm(e,p)(g):p(g)}function p(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function WQ(e,n,t){const r=this;return a;function a(d){return vE.call(r,e,o,l,"reference","referenceMarker","referenceString")(d)}function o(d){return r.parser.defined.includes(_h(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(d):t(d)}function l(d){return t(d)}}function QQ(e,n,t){return r;function r(o){return e.enter("reference"),e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),a}function a(o){return o===93?(e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),e.exit("reference"),n):t(o)}}const JQ={name:"labelStartImage",resolveAll:Yw.resolveAll,tokenize:KQ};function KQ(e,n,t){const r=this;return a;function a(d){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(d),e.exit("labelImageMarker"),o}function o(d){return d===91?(e.enter("labelMarker"),e.consume(d),e.exit("labelMarker"),e.exit("labelImage"),l):t(d)}function l(d){return d===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(d):n(d)}}const XQ={name:"labelStartLink",resolveAll:Yw.resolveAll,tokenize:ZQ};function ZQ(e,n,t){const r=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),o}function o(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(l):n(l)}}const I0={name:"lineEnding",tokenize:eJ};function eJ(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),sr(e,n,"linePrefix")}}const Vx={name:"thematicBreak",tokenize:tJ};function tJ(e,n,t){let r=0,a;return o;function o(u){return e.enter("thematicBreak"),l(u)}function l(u){return a=u,d(u)}function d(u){return u===a?(e.enter("thematicBreakSequence"),f(u)):r>=3&&(u===null||Bt(u))?(e.exit("thematicBreak"),n(u)):t(u)}function f(u){return u===a?(e.consume(u),r++,f):(e.exit("thematicBreakSequence"),Mn(u)?sr(e,d,"whitespace")(u):d(u))}}const la={continuation:{tokenize:aJ},exit:oJ,name:"list",tokenize:iJ},nJ={partial:!0,tokenize:lJ},rJ={partial:!0,tokenize:sJ};function iJ(e,n,t){const r=this,a=r.events[r.events.length-1];let o=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return d;function d(v){const S=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:L1(v)){if(r.containerState.type||(r.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(Vx,t,u)(v):u(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),f(v)}return t(v)}function f(v){return L1(v)&&++l<10?(e.consume(v),f):(!r.interrupt||l<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),u(v)):t(v)}function u(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(qb,r.interrupt?t:p,e.attempt(nJ,b,g))}function p(v){return r.containerState.initialBlankLine=!0,o++,b(v)}function g(v){return Mn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=o+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function aJ(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(qb,a,o);function a(d){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,sr(e,n,"listItemIndent",r.containerState.size+1)(d)}function o(d){return r.containerState.furtherBlankLines||!Mn(d)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,l(d)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(rJ,n,l)(d))}function l(d){return r.containerState._closeFlow=!0,r.interrupt=void 0,sr(e,e.attempt(la,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(d)}}function sJ(e,n,t){const r=this;return sr(e,a,"listItemIndent",r.containerState.size+1);function a(o){const l=r.events[r.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===r.containerState.size?n(o):t(o)}}function oJ(e){e.exit(this.containerState.type)}function lJ(e,n,t){const r=this;return sr(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(o){const l=r.events[r.events.length-1];return!Mn(o)&&l&&l[1].type==="listItemPrefixWhitespace"?n(o):t(o)}}const Wj={name:"setextUnderline",resolveTo:cJ,tokenize:uJ};function cJ(e,n){let t=e.length,r,a,o;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!o&&e[t][1].type==="definition"&&(o=t);const l={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",o?(e.splice(a,0,["enter",l,n]),e.splice(o+1,0,["exit",e[r][1],n]),e[r][1].end={...e[o][1].end}):e[r][1]=l,e.push(["exit",l,n]),e}function uJ(e,n,t){const r=this;let a;return o;function o(u){let p=r.events.length,g;for(;p--;)if(r.events[p][1].type!=="lineEnding"&&r.events[p][1].type!=="linePrefix"&&r.events[p][1].type!=="content"){g=r.events[p][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=u,l(u)):t(u)}function l(u){return e.enter("setextHeadingLineSequence"),d(u)}function d(u){return u===a?(e.consume(u),d):(e.exit("setextHeadingLineSequence"),Mn(u)?sr(e,f,"lineSuffix")(u):f(u))}function f(u){return u===null||Bt(u)?(e.exit("setextHeadingLine"),n(u)):t(u)}}const dJ={tokenize:fJ};function fJ(e){const n=this,t=e.attempt(qb,r,e.attempt(this.parser.constructs.flowInitial,a,sr(e,e.attempt(this.parser.constructs.flow,a,e.attempt(yQ,a)),"linePrefix")));return t;function r(o){if(o===null){e.consume(o);return}return e.enter("lineEndingBlank"),e.consume(o),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const hJ={resolveAll:NE()},pJ=SE("string"),mJ=SE("text");function SE(e){return{resolveAll:NE(e==="text"?gJ:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],o=t.attempt(a,l,d);return l;function l(p){return u(p)?o(p):d(p)}function d(p){if(p===null){t.consume(p);return}return t.enter("data"),t.consume(p),f}function f(p){return u(p)?(t.exit("data"),o(p)):(t.consume(p),f)}function u(p){if(p===null)return!0;const g=a[p];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function NE(e){return n;function n(t,r){let a=-1,o;for(;++a<=t.length;)o===void 0?t[a]&&t[a][1].type==="data"&&(o=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==o+2&&(t[o][1].end=t[a-1][1].end,t.splice(o+2,a-o-2),a=o+2),o=void 0);return e?e(t,r):t}}function gJ(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let o=a.length,l=-1,d=0,f;for(;o--;){const u=a[o];if(typeof u=="string"){for(l=u.length;u.charCodeAt(l-1)===32;)d++,l--;if(l)break;l=-1}else if(u===-2)f=!0,d++;else if(u!==-1){o++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(d=0),d){const u={type:t===e.length||f||d<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?l:r.start._bufferIndex+l,_index:r.start._index+o,line:r.end.line,column:r.end.column-d,offset:r.end.offset-d},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(t,0,["enter",u,n],["exit",u,n]),t+=2)}t++}return e}const yJ={42:la,43:la,45:la,48:la,49:la,50:la,51:la,52:la,53:la,54:la,55:la,56:la,57:la,62:mE},xJ={91:SQ},bJ={[-2]:D0,[-1]:D0,32:D0},vJ={35:TQ,42:Vx,45:[Wj,Vx],60:DQ,61:Wj,95:Vx,96:Gj,126:Gj},wJ={38:yE,92:gE},SJ={[-5]:I0,[-4]:I0,[-3]:I0,33:JQ,38:yE,42:F1,60:[XW,$Q],91:XQ,92:[_Q,gE],93:Yw,95:F1,96:dQ},NJ={null:[F1,hJ]},CJ={null:[42,95]},jJ={null:[]},_J=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:CJ,contentInitial:xJ,disable:jJ,document:yJ,flow:vJ,flowInitial:bJ,insideSpan:NJ,string:wJ,text:SJ},Symbol.toStringTag,{value:"Module"}));function kJ(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},o=[];let l=[],d=[];const f={attempt:z(L),check:z($),consume:M,enter:I,exit:U,interrupt:z($,{interrupt:!0})},u={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let p=n.tokenize.call(u,f);return n.resolveAll&&o.push(n),u;function g(B){return l=cs(l,B),T(),l[l.length-1]!==null?[]:(F(n,0),u.events=Gw(o,u.events,u),u.events)}function b(B,G){return EJ(v(B),G)}function v(B){return TJ(l,B)}function S(){const{_bufferIndex:B,_index:G,line:ie,column:te,offset:W}=r;return{_bufferIndex:B,_index:G,line:ie,column:te,offset:W}}function k(B){a[B.line]=B.column,R()}function T(){let B;for(;r._index<l.length;){const G=l[r._index];if(typeof G=="string")for(B=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===B&&r._bufferIndex<G.length;)P(G.charCodeAt(r._bufferIndex));else P(G)}}function P(B){p=p(B)}function M(B){Bt(B)?(r.line++,r.column=1,r.offset+=B===-3?2:1,R()):B!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===l[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=B}function I(B,G){const ie=G||{};return ie.type=B,ie.start=S(),u.events.push(["enter",ie,u]),d.push(ie),ie}function U(B){const G=d.pop();return G.end=S(),u.events.push(["exit",G,u]),G}function L(B,G){F(B,G.from)}function $(B,G){G.restore()}function z(B,G){return ie;function ie(te,W,V){let se,re,oe,E;return Array.isArray(te)?ue(te):"tokenize"in te?ue([te]):le(te);function le(X){return fe;function fe(ae){const Me=ae!==null&&X[ae],Ke=ae!==null&&X.null,Z=[...Array.isArray(Me)?Me:Me?[Me]:[],...Array.isArray(Ke)?Ke:Ke?[Ke]:[]];return ue(Z)(ae)}}function ue(X){return se=X,re=0,X.length===0?V:D(X[re])}function D(X){return fe;function fe(ae){return E=Y(),oe=X,X.partial||(u.currentConstruct=X),X.name&&u.parser.constructs.disable.null.includes(X.name)?ve():X.tokenize.call(G?Object.assign(Object.create(u),G):u,f,ce,ve)(ae)}}function ce(X){return B(oe,E),W}function ve(X){return E.restore(),++re<se.length?D(se[re]):V}}}function F(B,G){B.resolveAll&&!o.includes(B)&&o.push(B),B.resolve&&Xo(u.events,G,u.events.length-G,B.resolve(u.events.slice(G),u)),B.resolveTo&&(u.events=B.resolveTo(u.events,u))}function Y(){const B=S(),G=u.previous,ie=u.currentConstruct,te=u.events.length,W=Array.from(d);return{from:te,restore:V};function V(){r=B,u.previous=G,u.currentConstruct=ie,u.events.length=te,d=W,R()}}function R(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function TJ(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,o=n.end._bufferIndex;let l;if(t===a)l=[e[t].slice(r,o)];else{if(l=e.slice(t,a),r>-1){const d=l[0];typeof d=="string"?l[0]=d.slice(r):l.shift()}o>0&&l.push(e[a].slice(0,o))}return l}function EJ(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const o=e[t];let l;if(typeof o=="string")l=o;else switch(o){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=n?" ":"	";break}case-1:{if(!n&&a)continue;l=" ";break}default:l=String.fromCharCode(o)}a=o===-2,r.push(l)}return r.join("")}function AJ(e){const r={constructs:LW([_J,...(e||{}).extensions||[]]),content:a(HW),defined:[],document:a(YW),flow:a(dJ),lazy:{},string:a(pJ),text:a(mJ)};return r;function a(o){return l;function l(d){return kJ(r,o,d)}}}function PJ(e){for(;!xE(e););return e}const Qj=/[\0\t\n\r]/g;function DJ(){let e=1,n="",t=!0,r;return a;function a(o,l,d){const f=[];let u,p,g,b,v;for(o=n+(typeof o=="string"?o.toString():new TextDecoder(l||void 0).decode(o)),g=0,n="",t&&(o.charCodeAt(0)===65279&&g++,t=void 0);g<o.length;){if(Qj.lastIndex=g,u=Qj.exec(o),b=u&&u.index!==void 0?u.index:o.length,v=o.charCodeAt(b),!u){n=o.slice(g);break}if(v===10&&g===b&&r)f.push(-3),r=void 0;else switch(r&&(f.push(-5),r=void 0),g<b&&(f.push(o.slice(g,b)),e+=b-g),v){case 0:{f.push(65533),e++;break}case 9:{for(p=Math.ceil(e/4)*4,f.push(-2);e++<p;)f.push(-1);break}case 10:{f.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return d&&(r&&f.push(-5),n&&f.push(n),f.push(null)),f}}const IJ=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function CE(e){return e.replace(IJ,RJ)}function RJ(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),o=a===120||a===88;return pE(t.slice(o?2:1),o?16:10)}return Hw(t)||e}function Vm(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?Jj(e.position):"start"in e||"end"in e?Jj(e):"line"in e||"column"in e?$1(e):""}function $1(e){return Kj(e&&e.line)+":"+Kj(e&&e.column)}function Jj(e){return $1(e&&e.start)+"-"+$1(e&&e.end)}function Kj(e){return e&&typeof e=="number"?e:1}const jE={}.hasOwnProperty;function MJ(e,n,t){return typeof n!="string"&&(t=n,n=void 0),OJ(t)(PJ(AJ(t).document().write(DJ()(e,n,!0))))}function OJ(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(Ht),autolinkProtocol:Y,autolinkEmail:Y,atxHeading:o(rt),blockQuote:o(Ke),characterEscape:Y,characterReference:Y,codeFenced:o(Z),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:o(Z,l),codeText:o(Ee,l),codeTextData:Y,data:Y,codeFlowValue:Y,definition:o(Ie),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:o(Fe),hardBreakEscape:o(lt),hardBreakTrailing:o(lt),htmlFlow:o(ct,l),htmlFlowData:Y,htmlText:o(ct,l),htmlTextData:Y,image:o(st),label:l,link:o(Ht),listItem:o(je),listItemValue:b,listOrdered:o(rn,g),listUnordered:o(rn),paragraph:o(qe),reference:D,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:o(rt),strong:o(Be),thematicBreak:o(we)},exit:{atxHeading:f(),atxHeadingSequence:L,autolink:f(),autolinkEmail:Me,autolinkProtocol:ae,blockQuote:f(),characterEscapeValue:R,characterReferenceMarkerHexadecimal:ve,characterReferenceMarkerNumeric:ve,characterReferenceValue:X,characterReference:fe,codeFenced:f(T),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:R,codeIndented:f(P),codeText:f(W),codeTextData:R,data:R,definition:f(),definitionDestinationString:U,definitionLabelString:M,definitionTitleString:I,emphasis:f(),hardBreakEscape:f(G),hardBreakTrailing:f(G),htmlFlow:f(ie),htmlFlowData:R,htmlText:f(te),htmlTextData:R,image:f(se),label:oe,labelText:re,lineEnding:B,link:f(V),listItem:f(),listOrdered:f(),listUnordered:f(),paragraph:f(),referenceString:ce,resourceDestinationString:E,resourceTitleString:le,resource:ue,setextHeading:f(F),setextHeadingLineSequence:z,setextHeadingText:$,strong:f(),thematicBreak:f()}};_E(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(Q){let me={type:"root",children:[]};const Ve={stack:[me],tokenStack:[],config:n,enter:d,exit:u,buffer:l,resume:p,data:t},Qe=[];let ot=-1;for(;++ot<Q.length;)if(Q[ot][1].type==="listOrdered"||Q[ot][1].type==="listUnordered")if(Q[ot][0]==="enter")Qe.push(ot);else{const kt=Qe.pop();ot=a(Q,kt,ot)}for(ot=-1;++ot<Q.length;){const kt=n[Q[ot][0]];jE.call(kt,Q[ot][1].type)&&kt[Q[ot][1].type].call(Object.assign({sliceSerialize:Q[ot][2].sliceSerialize},Ve),Q[ot][1])}if(Ve.tokenStack.length>0){const kt=Ve.tokenStack[Ve.tokenStack.length-1];(kt[1]||Xj).call(Ve,void 0,kt[0])}for(me.position={start:iu(Q.length>0?Q[0][1].start:{line:1,column:1,offset:0}),end:iu(Q.length>0?Q[Q.length-2][1].end:{line:1,column:1,offset:0})},ot=-1;++ot<n.transforms.length;)me=n.transforms[ot](me)||me;return me}function a(Q,me,Ve){let Qe=me-1,ot=-1,kt=!1,qt,be,ge,Te;for(;++Qe<=Ve;){const De=Q[Qe];switch(De[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{De[0]==="enter"?ot++:ot--,Te=void 0;break}case"lineEndingBlank":{De[0]==="enter"&&(qt&&!Te&&!ot&&!ge&&(ge=Qe),Te=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Te=void 0}if(!ot&&De[0]==="enter"&&De[1].type==="listItemPrefix"||ot===-1&&De[0]==="exit"&&(De[1].type==="listUnordered"||De[1].type==="listOrdered")){if(qt){let ze=Qe;for(be=void 0;ze--;){const nt=Q[ze];if(nt[1].type==="lineEnding"||nt[1].type==="lineEndingBlank"){if(nt[0]==="exit")continue;be&&(Q[be][1].type="lineEndingBlank",kt=!0),nt[1].type="lineEnding",be=ze}else if(!(nt[1].type==="linePrefix"||nt[1].type==="blockQuotePrefix"||nt[1].type==="blockQuotePrefixWhitespace"||nt[1].type==="blockQuoteMarker"||nt[1].type==="listItemIndent"))break}ge&&(!be||ge<be)&&(qt._spread=!0),qt.end=Object.assign({},be?Q[be][1].start:De[1].end),Q.splice(be||Qe,0,["exit",qt,De[2]]),Qe++,Ve++}if(De[1].type==="listItemPrefix"){const ze={type:"listItem",_spread:!1,start:Object.assign({},De[1].start),end:void 0};qt=ze,Q.splice(Qe,0,["enter",ze,De[2]]),Qe++,Ve++,ge=void 0,Te=!0}}}return Q[me][1]._spread=kt,Ve}function o(Q,me){return Ve;function Ve(Qe){d.call(this,Q(Qe),Qe),me&&me.call(this,Qe)}}function l(){this.stack.push({type:"fragment",children:[]})}function d(Q,me,Ve){this.stack[this.stack.length-1].children.push(Q),this.stack.push(Q),this.tokenStack.push([me,Ve||void 0]),Q.position={start:iu(me.start),end:void 0}}function f(Q){return me;function me(Ve){Q&&Q.call(this,Ve),u.call(this,Ve)}}function u(Q,me){const Ve=this.stack.pop(),Qe=this.tokenStack.pop();if(Qe)Qe[0].type!==Q.type&&(me?me.call(this,Q,Qe[0]):(Qe[1]||Xj).call(this,Q,Qe[0]));else throw new Error("Cannot close `"+Q.type+"` ("+Vm({start:Q.start,end:Q.end})+"): its not open");Ve.position.end=iu(Q.end)}function p(){return Vw(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(Q){if(this.data.expectingFirstListItemValue){const me=this.stack[this.stack.length-2];me.start=Number.parseInt(this.sliceSerialize(Q),10),this.data.expectingFirstListItemValue=void 0}}function v(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.lang=Q}function S(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.meta=Q}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.value=Q.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function P(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.value=Q.replace(/(\r?\n|\r)$/g,"")}function M(Q){const me=this.resume(),Ve=this.stack[this.stack.length-1];Ve.label=me,Ve.identifier=_h(this.sliceSerialize(Q)).toLowerCase()}function I(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.title=Q}function U(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.url=Q}function L(Q){const me=this.stack[this.stack.length-1];if(!me.depth){const Ve=this.sliceSerialize(Q).length;me.depth=Ve}}function $(){this.data.setextHeadingSlurpLineEnding=!0}function z(Q){const me=this.stack[this.stack.length-1];me.depth=this.sliceSerialize(Q).codePointAt(0)===61?1:2}function F(){this.data.setextHeadingSlurpLineEnding=void 0}function Y(Q){const Ve=this.stack[this.stack.length-1].children;let Qe=Ve[Ve.length-1];(!Qe||Qe.type!=="text")&&(Qe=ke(),Qe.position={start:iu(Q.start),end:void 0},Ve.push(Qe)),this.stack.push(Qe)}function R(Q){const me=this.stack.pop();me.value+=this.sliceSerialize(Q),me.position.end=iu(Q.end)}function B(Q){const me=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Ve=me.children[me.children.length-1];Ve.position.end=iu(Q.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(me.type)&&(Y.call(this,Q),R.call(this,Q))}function G(){this.data.atHardBreak=!0}function ie(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.value=Q}function te(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.value=Q}function W(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.value=Q}function V(){const Q=this.stack[this.stack.length-1];if(this.data.inReference){const me=this.data.referenceType||"shortcut";Q.type+="Reference",Q.referenceType=me,delete Q.url,delete Q.title}else delete Q.identifier,delete Q.label;this.data.referenceType=void 0}function se(){const Q=this.stack[this.stack.length-1];if(this.data.inReference){const me=this.data.referenceType||"shortcut";Q.type+="Reference",Q.referenceType=me,delete Q.url,delete Q.title}else delete Q.identifier,delete Q.label;this.data.referenceType=void 0}function re(Q){const me=this.sliceSerialize(Q),Ve=this.stack[this.stack.length-2];Ve.label=CE(me),Ve.identifier=_h(me).toLowerCase()}function oe(){const Q=this.stack[this.stack.length-1],me=this.resume(),Ve=this.stack[this.stack.length-1];if(this.data.inReference=!0,Ve.type==="link"){const Qe=Q.children;Ve.children=Qe}else Ve.alt=me}function E(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.url=Q}function le(){const Q=this.resume(),me=this.stack[this.stack.length-1];me.title=Q}function ue(){this.data.inReference=void 0}function D(){this.data.referenceType="collapsed"}function ce(Q){const me=this.resume(),Ve=this.stack[this.stack.length-1];Ve.label=me,Ve.identifier=_h(this.sliceSerialize(Q)).toLowerCase(),this.data.referenceType="full"}function ve(Q){this.data.characterReferenceType=Q.type}function X(Q){const me=this.sliceSerialize(Q),Ve=this.data.characterReferenceType;let Qe;Ve?(Qe=pE(me,Ve==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Qe=Hw(me);const ot=this.stack[this.stack.length-1];ot.value+=Qe}function fe(Q){const me=this.stack.pop();me.position.end=iu(Q.end)}function ae(Q){R.call(this,Q);const me=this.stack[this.stack.length-1];me.url=this.sliceSerialize(Q)}function Me(Q){R.call(this,Q);const me=this.stack[this.stack.length-1];me.url="mailto:"+this.sliceSerialize(Q)}function Ke(){return{type:"blockquote",children:[]}}function Z(){return{type:"code",lang:null,meta:null,value:""}}function Ee(){return{type:"inlineCode",value:""}}function Ie(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Fe(){return{type:"emphasis",children:[]}}function rt(){return{type:"heading",depth:0,children:[]}}function lt(){return{type:"break"}}function ct(){return{type:"html",value:""}}function st(){return{type:"image",title:null,url:"",alt:null}}function Ht(){return{type:"link",title:null,url:"",children:[]}}function rn(Q){return{type:"list",ordered:Q.type==="listOrdered",start:null,spread:Q._spread,children:[]}}function je(Q){return{type:"listItem",spread:Q._spread,checked:null,children:[]}}function qe(){return{type:"paragraph",children:[]}}function Be(){return{type:"strong",children:[]}}function ke(){return{type:"text",value:""}}function we(){return{type:"thematicBreak"}}}function iu(e){return{line:e.line,column:e.column,offset:e.offset}}function _E(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?_E(e,r):LJ(e,r)}}function LJ(e,n){let t;for(t in n)if(jE.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function Xj(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+Vm({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+Vm({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+Vm({start:n.start,end:n.end})+") is still open")}function FJ(e){const n=this;n.parser=t;function t(r){return MJ(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}const Zj={}.hasOwnProperty;function kE(e,n){const t=n||{};function r(a,...o){let l=r.invalid;const d=r.handlers;if(a&&Zj.call(a,e)){const f=String(a[e]);l=Zj.call(d,f)?d[f]:r.unknown}if(l)return l.call(this,a,...o)}return r.handlers=t.handlers||{},r.invalid=t.invalid,r.unknown=t.unknown,r}const $J={}.hasOwnProperty;function TE(e,n){let t=-1,r;if(n.extensions)for(;++t<n.extensions.length;)TE(e,n.extensions[t]);for(r in n)if($J.call(n,r))switch(r){case"extensions":break;case"unsafe":{e_(e[r],n[r]);break}case"join":{e_(e[r],n[r]);break}case"handlers":{zJ(e[r],n[r]);break}default:e.options[r]=n[r]}return e}function e_(e,n){n&&e.push(...n)}function zJ(e,n){n&&Object.assign(e,n)}function UJ(e,n,t,r){const a=t.enter("blockquote"),o=t.createTracker(r);o.move("> "),o.shift(2);const l=t.indentLines(t.containerFlow(e,o.current()),BJ);return a(),l}function BJ(e,n,t){return">"+(t?"":" ")+e}function EE(e,n){return t_(e,n.inConstruct,!0)&&!t_(e,n.notInConstruct,!1)}function t_(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function n_(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&EE(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function qJ(e,n){const t=String(e);let r=t.indexOf(n),a=r,o=0,l=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++o>l&&(l=o):o=1,a=r+n.length,r=t.indexOf(n,a);return l}function z1(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function VJ(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function HJ(e,n,t,r){const a=VJ(t),o=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if(z1(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(o,GJ);return g(),b}const d=t.createTracker(r),f=a.repeat(Math.max(qJ(o,a)+1,3)),u=t.enter("codeFenced");let p=d.move(f);if(e.lang){const g=t.enter(`codeFencedLang${l}`);p+=d.move(t.safe(e.lang,{before:p,after:" ",encode:["`"],...d.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${l}`);p+=d.move(" "),p+=d.move(t.safe(e.meta,{before:p,after:`
`,encode:["`"],...d.current()})),g()}return p+=d.move(`
`),o&&(p+=d.move(o+`
`)),p+=d.move(f),u(),p}function GJ(e,n,t){return(t?"":"    ")+e}function Ww(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function YJ(e,n,t,r){const a=Ww(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("definition");let d=t.enter("label");const f=t.createTracker(r);let u=f.move("[");return u+=f.move(t.safe(t.associationId(e),{before:u,after:"]",...f.current()})),u+=f.move("]: "),d(),!e.url||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":`
`,...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),l(),u}function WJ(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function du(e){return"&#x"+e.toString(16).toUpperCase()+";"}function mb(e,n,t){const r=pb(e),a=pb(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}AE.peek=QJ;function AE(e,n,t,r){const a=WJ(t),o=t.enter("emphasis"),l=t.createTracker(r),d=l.move(a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),p=mb(r.before.charCodeAt(r.before.length-1),u,a);p.inside&&(f=du(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=mb(r.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+du(g));const v=l.move(a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:p.outside},d+f+v}function QJ(e,n,t){return t.options.emphasis||"*"}const Qw=function(e){if(e==null)return ZJ;if(typeof e=="function")return Vb(e);if(typeof e=="object")return Array.isArray(e)?JJ(e):KJ(e);if(typeof e=="string")return XJ(e);throw new Error("Expected function, string, or object as test")};function JJ(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=Qw(e[t]);return Vb(r);function r(...a){let o=-1;for(;++o<n.length;)if(n[o].apply(this,a))return!0;return!1}}function KJ(e){const n=e;return Vb(t);function t(r){const a=r;let o;for(o in e)if(a[o]!==n[o])return!1;return!0}}function XJ(e){return Vb(n);function n(t){return t&&t.type===e}}function Vb(e){return n;function n(t,r,a){return!!(eK(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function ZJ(){return!0}function eK(e){return e!==null&&typeof e=="object"&&"type"in e}const PE=[],tK=!0,U1=!1,nK="skip";function rK(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const o=Qw(a),l=r?-1:1;d(e,void 0,[])();function d(f,u,p){const g=f&&typeof f=="object"?f:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(f.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=PE,S,k,T;if((!n||o(f,u,p[p.length-1]||void 0))&&(v=iK(t(f,p)),v[0]===U1))return v;if("children"in f&&f.children){const P=f;if(P.children&&v[0]!==nK)for(k=(r?P.children.length:-1)+l,T=p.concat(P);k>-1&&k<P.children.length;){const M=P.children[k];if(S=d(M,k,T)(),S[0]===U1)return S;k=typeof S[1]=="number"?S[1]:k+l}}return v}}}function iK(e){return Array.isArray(e)?e:typeof e=="number"?[tK,e]:e==null?PE:[e]}function DE(e,n,t,r){let a,o,l;typeof n=="function"?(o=void 0,l=n,a=t):(o=n,l=t,a=r),rK(e,o,d,a);function d(f,u){const p=u[u.length-1],g=p?p.children.indexOf(f):void 0;return l(f,g,p)}}function IE(e,n){let t=!1;return DE(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,U1}),!!((!e.depth||e.depth<3)&&Vw(e)&&(n.options.setext||t))}function aK(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),o=t.createTracker(r);if(IE(e,t)){const p=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...o.current(),before:`
`,after:`
`});return g(),p(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const l="#".repeat(a),d=t.enter("headingAtx"),f=t.enter("phrasing");o.move(l+" ");let u=t.containerPhrasing(e,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(u)&&(u=du(u.charCodeAt(0))+u.slice(1)),u=u?l+" "+u:l,t.options.closeAtx&&(u+=" "+l),f(),d(),u}RE.peek=sK;function RE(e){return e.value||""}function sK(){return"<"}ME.peek=oK;function ME(e,n,t,r){const a=Ww(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("image");let d=t.enter("label");const f=t.createTracker(r);let u=f.move("![");return u+=f.move(t.safe(e.alt,{before:u,after:"]",...f.current()})),u+=f.move("]("),d(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":")",...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),u+=f.move(")"),l(),u}function oK(){return"!"}OE.peek=lK;function OE(e,n,t,r){const a=e.referenceType,o=t.enter("imageReference");let l=t.enter("label");const d=t.createTracker(r);let f=d.move("![");const u=t.safe(e.alt,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const p=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=p,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function lK(){return"!"}LE.peek=cK;function LE(e,n,t){let r=e.value||"",a="`",o=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++o<t.unsafe.length;){const l=t.unsafe[o],d=t.compilePattern(l);let f;if(l.atBreak)for(;f=d.exec(r);){let u=f.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(f.index+1)}}return a+r+a}function cK(){return"`"}function FE(e,n){const t=Vw(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}$E.peek=uK;function $E(e,n,t,r){const a=Ww(t),o=a==='"'?"Quote":"Apostrophe",l=t.createTracker(r);let d,f;if(FE(e,t)){const p=t.stack;t.stack=[],d=t.enter("autolink");let g=l.move("<");return g+=l.move(t.containerPhrasing(e,{before:g,after:">",...l.current()})),g+=l.move(">"),d(),t.stack=p,g}d=t.enter("link"),f=t.enter("label");let u=l.move("[");return u+=l.move(t.containerPhrasing(e,{before:u,after:"](",...l.current()})),u+=l.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(t.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(f=t.enter("destinationRaw"),u+=l.move(t.safe(e.url,{before:u,after:e.title?" ":")",...l.current()}))),f(),e.title&&(f=t.enter(`title${o}`),u+=l.move(" "+a),u+=l.move(t.safe(e.title,{before:u,after:a,...l.current()})),u+=l.move(a),f()),u+=l.move(")"),d(),u}function uK(e,n,t){return FE(e,t)?"<":"["}zE.peek=dK;function zE(e,n,t,r){const a=e.referenceType,o=t.enter("linkReference");let l=t.enter("label");const d=t.createTracker(r);let f=d.move("[");const u=t.containerPhrasing(e,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const p=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=p,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function dK(){return"["}function Jw(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function fK(e){const n=Jw(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function hK(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function UE(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function pK(e,n,t,r){const a=t.enter("list"),o=t.bulletCurrent;let l=e.ordered?hK(t):Jw(t);const d=e.ordered?l==="."?")":".":fK(t);let f=n&&t.bulletLastUsed?l===t.bulletLastUsed:!1;if(!e.ordered){const p=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&p&&(!p.children||!p.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(f=!0),UE(t)===l&&p){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){f=!0;break}}}}f&&(l=d),t.bulletCurrent=l;const u=t.containerFlow(e,r);return t.bulletLastUsed=l,t.bulletCurrent=o,a(),u}function mK(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function gK(e,n,t,r){const a=mK(t);let o=t.bulletCurrent||Jw(t);n&&n.type==="list"&&n.ordered&&(o=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+o);let l=o.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(l=Math.ceil(l/4)*4);const d=t.createTracker(r);d.move(o+" ".repeat(l-o.length)),d.shift(l);const f=t.enter("listItem"),u=t.indentLines(t.containerFlow(e,d.current()),p);return f(),u;function p(g,b,v){return b?(v?"":" ".repeat(l))+g:(v?o:o+" ".repeat(l-o.length))+g}}function yK(e,n,t,r){const a=t.enter("paragraph"),o=t.enter("phrasing"),l=t.containerPhrasing(e,r);return o(),a(),l}const xK=Qw(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function bK(e,n,t,r){return(e.children.some(function(l){return xK(l)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function vK(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}BE.peek=wK;function BE(e,n,t,r){const a=vK(t),o=t.enter("strong"),l=t.createTracker(r),d=l.move(a+a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),p=mb(r.before.charCodeAt(r.before.length-1),u,a);p.inside&&(f=du(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=mb(r.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+du(g));const v=l.move(a+a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:p.outside},d+f+v}function wK(e,n,t){return t.options.strong||"*"}function SK(e,n,t,r){return t.safe(e.value,r)}function NK(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function CK(e,n,t){const r=(UE(t)+(t.options.ruleSpaces?" ":"")).repeat(NK(t));return t.options.ruleSpaces?r.slice(0,-1):r}const jK={blockquote:UJ,break:n_,code:HJ,definition:YJ,emphasis:AE,hardBreak:n_,heading:aK,html:RE,image:ME,imageReference:OE,inlineCode:LE,link:$E,linkReference:zE,list:pK,listItem:gK,paragraph:yK,root:bK,strong:BE,text:SK,thematicBreak:CK},_K=[kK];function kK(e,n,t,r){if(n.type==="code"&&z1(n,r)&&(e.type==="list"||e.type===n.type&&z1(e,r)))return!1;if("spread"in t&&typeof t.spread=="boolean")return e.type==="paragraph"&&(e.type===n.type||n.type==="definition"||n.type==="heading"&&IE(n,r))?void 0:t.spread?1:0}const Ed=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],TK=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:Ed},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:Ed},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:Ed},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:Ed},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:Ed},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:Ed},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:Ed},{atBreak:!0,character:"~"}];function EK(e){return e.label||!e.identifier?e.label||"":CE(e.identifier)}function AK(e){if(!e._compiled){const n=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((n?"("+n+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function PK(e,n,t){const r=n.indexStack,a=e.children||[],o=[];let l=-1,d=t.before,f;r.push(-1);let u=n.createTracker(t);for(;++l<a.length;){const p=a[l];let g;if(r[r.length-1]=l,l+1<a.length){let S=n.handle.handlers[a[l+1].type];S&&S.peek&&(S=S.peek),g=S?S(a[l+1],e,n,{before:"",after:"",...u.current()}).charAt(0):""}else g=t.after;o.length>0&&(d==="\r"||d===`
`)&&p.type==="html"&&(o[o.length-1]=o[o.length-1].replace(/(\r?\n|\r)$/," "),d=" ",u=n.createTracker(t),u.move(o.join("")));let b=n.handle(p,e,n,{...u.current(),after:g,before:d});f&&f===b.slice(0,1)&&(b=du(f.charCodeAt(0))+b.slice(1));const v=n.attentionEncodeSurroundingInfo;n.attentionEncodeSurroundingInfo=void 0,f=void 0,v&&(o.length>0&&v.before&&d===o[o.length-1].slice(-1)&&(o[o.length-1]=o[o.length-1].slice(0,-1)+du(d.charCodeAt(0))),v.after&&(f=g)),u.move(b),o.push(b),d=b.slice(-1)}return r.pop(),o.join("")}function DK(e,n,t){const r=n.indexStack,a=e.children||[],o=n.createTracker(t),l=[];let d=-1;for(r.push(-1);++d<a.length;){const f=a[d];r[r.length-1]=d,l.push(o.move(n.handle(f,e,n,{before:`
`,after:`
`,...o.current()}))),f.type!=="list"&&(n.bulletLastUsed=void 0),d<a.length-1&&l.push(o.move(IK(f,a[d+1],e,n)))}return r.pop(),l.join("")}function IK(e,n,t,r){let a=r.join.length;for(;a--;){const o=r.join[a](e,n,t,r);if(o===!0||o===1)break;if(typeof o=="number")return`
`.repeat(1+o);if(o===!1)return`

<!---->

`}return`

`}const RK=/\r?\n|\r/g;function MK(e,n){const t=[];let r=0,a=0,o;for(;o=RK.exec(e);)l(e.slice(r,o.index)),t.push(o[0]),r=o.index+o[0].length,a++;return l(e.slice(r)),t.join("");function l(d){t.push(n(d,a,!d))}}function OK(e,n,t){const r=(t.before||"")+(n||"")+(t.after||""),a=[],o=[],l={};let d=-1;for(;++d<e.unsafe.length;){const p=e.unsafe[d];if(!EE(e.stack,p))continue;const g=e.compilePattern(p);let b;for(;b=g.exec(r);){const v="before"in p||!!p.atBreak,S="after"in p,k=b.index+(v?b[1].length:0);a.includes(k)?(l[k].before&&!v&&(l[k].before=!1),l[k].after&&!S&&(l[k].after=!1)):(a.push(k),l[k]={before:v,after:S})}}a.sort(LK);let f=t.before?t.before.length:0;const u=r.length-(t.after?t.after.length:0);for(d=-1;++d<a.length;){const p=a[d];p<f||p>=u||p+1<u&&a[d+1]===p+1&&l[p].after&&!l[p+1].before&&!l[p+1].after||a[d-1]===p-1&&l[p].before&&!l[p-1].before&&!l[p-1].after||(f!==p&&o.push(r_(r.slice(f,p),"\\")),f=p,/[!-/:-@[-`{-~]/.test(r.charAt(p))&&(!t.encode||!t.encode.includes(r.charAt(p)))?o.push("\\"):(o.push(du(r.charCodeAt(p))),f++))}return o.push(r_(r.slice(f,u),t.after)),o.join("")}function LK(e,n){return e-n}function r_(e,n){const t=/\\(?=[!-/:-@[-`{-~])/g,r=[],a=[],o=e+n;let l=-1,d=0,f;for(;f=t.exec(o);)r.push(f.index);for(;++l<r.length;)d!==r[l]&&a.push(e.slice(d,r[l])),a.push("\\"),d=r[l];return a.push(e.slice(d)),a.join("")}function FK(e){const n=e||{},t=n.now||{};let r=n.lineShift||0,a=t.line||1,o=t.column||1;return{move:f,current:l,shift:d};function l(){return{now:{line:a,column:o},lineShift:r}}function d(u){r+=u}function f(u){const p=u||"",g=p.split(/\r?\n|\r/g),b=g[g.length-1];return a+=g.length-1,o=g.length===1?o+b.length:1+b.length+r,p}}function $K(e,n){const t=n||{},r={associationId:EK,containerPhrasing:qK,containerFlow:VK,createTracker:FK,compilePattern:AK,enter:o,handlers:{...jK},handle:void 0,indentLines:MK,indexStack:[],join:[..._K],options:{},safe:HK,stack:[],unsafe:[...TK]};TE(r,t),r.options.tightDefinitions&&r.join.push(BK),r.handle=kE("type",{invalid:zK,unknown:UK,handlers:r.handlers});let a=r.handle(e,void 0,r,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return a&&a.charCodeAt(a.length-1)!==10&&a.charCodeAt(a.length-1)!==13&&(a+=`
`),a;function o(l){return r.stack.push(l),d;function d(){r.stack.pop()}}}function zK(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function UK(e){const n=e;throw new Error("Cannot handle unknown node `"+n.type+"`")}function BK(e,n){if(e.type==="definition"&&e.type===n.type)return 0}function qK(e,n){return PK(e,this,n)}function VK(e,n){return DK(e,this,n)}function HK(e,n){return OK(this,e,n)}function GK(e){const n=this;n.compiler=t;function t(r){return $K(r,{...n.data("settings"),...e,extensions:n.data("toMarkdownExtensions")||[]})}}function i_(e){if(e)throw e}var R0,a_;function YK(){if(a_)return R0;a_=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(u){return typeof Array.isArray=="function"?Array.isArray(u):n.call(u)==="[object Array]"},o=function(u){if(!u||n.call(u)!=="[object Object]")return!1;var p=e.call(u,"constructor"),g=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!p&&!g)return!1;var b;for(b in u);return typeof b>"u"||e.call(u,b)},l=function(u,p){t&&p.name==="__proto__"?t(u,p.name,{enumerable:!0,configurable:!0,value:p.newValue,writable:!0}):u[p.name]=p.newValue},d=function(u,p){if(p==="__proto__")if(e.call(u,p)){if(r)return r(u,p).value}else return;return u[p]};return R0=function f(){var u,p,g,b,v,S,k=arguments[0],T=1,P=arguments.length,M=!1;for(typeof k=="boolean"&&(M=k,k=arguments[1]||{},T=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});T<P;++T)if(u=arguments[T],u!=null)for(p in u)g=d(k,p),b=d(u,p),k!==b&&(M&&b&&(o(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&o(g)?g:{},l(k,{name:p,newValue:f(M,S,b)})):typeof b<"u"&&l(k,{name:p,newValue:b}));return k},R0}var WK=YK();const M0=Ud(WK);function B1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function QK(){const e=[],n={run:t,use:r};return n;function t(...a){let o=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);d(null,...a);function d(f,...u){const p=e[++o];let g=-1;if(f){l(f);return}for(;++g<a.length;)(u[g]===null||u[g]===void 0)&&(u[g]=a[g]);a=u,p?JK(p,d)(...u):l(null,...u)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function JK(e,n){let t;return r;function r(...l){const d=e.length>l.length;let f;d&&l.push(a);try{f=e.apply(this,l)}catch(u){const p=u;if(d&&t)throw p;return a(p)}d||(f&&f.then&&typeof f.then=="function"?f.then(o,a):f instanceof Error?a(f):o(f))}function a(l,...d){t||(t=!0,n(l,...d))}function o(l){a(null,l)}}class ma extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",o={},l=!1;if(t&&("line"in t&&"column"in t?o={place:t}:"start"in t&&"end"in t?o={place:t}:"type"in t?o={ancestors:[t],place:t.position}:o={...t}),typeof n=="string"?a=n:!o.cause&&n&&(l=!0,a=n.message,o.cause=n),!o.ruleId&&!o.source&&typeof r=="string"){const f=r.indexOf(":");f===-1?o.ruleId=r:(o.source=r.slice(0,f),o.ruleId=r.slice(f+1))}if(!o.place&&o.ancestors&&o.ancestors){const f=o.ancestors[o.ancestors.length-1];f&&(o.place=f.position)}const d=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=d?d.column:void 0,this.fatal=void 0,this.file="",this.message=a,this.line=d?d.line:void 0,this.name=Vm(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=l&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}ma.prototype.file="";ma.prototype.name="";ma.prototype.reason="";ma.prototype.message="";ma.prototype.stack="";ma.prototype.column=void 0;ma.prototype.line=void 0;ma.prototype.ancestors=void 0;ma.prototype.cause=void 0;ma.prototype.fatal=void 0;ma.prototype.place=void 0;ma.prototype.ruleId=void 0;ma.prototype.source=void 0;const qo={basename:KK,dirname:XK,extname:ZK,join:eX,sep:"/"};function KK(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');fg(e);let t=0,r=-1,a=e.length,o;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else r<0&&(o=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let l=-1,d=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else l<0&&(o=!0,l=a+1),d>-1&&(e.codePointAt(a)===n.codePointAt(d--)?d<0&&(r=a):(d=-1,r=l));return t===r?r=l:r<0&&(r=e.length),e.slice(t,r)}function XK(e){if(fg(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function ZK(e){fg(e);let n=e.length,t=-1,r=0,a=-1,o=0,l;for(;n--;){const d=e.codePointAt(n);if(d===47){if(l){r=n+1;break}continue}t<0&&(l=!0,t=n+1),d===46?a<0?a=n:o!==1&&(o=1):a>-1&&(o=-1)}return a<0||t<0||o===0||o===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function eX(...e){let n=-1,t;for(;++n<e.length;)fg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":tX(t)}function tX(e){fg(e);const n=e.codePointAt(0)===47;let t=nX(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function nX(e,n){let t="",r=0,a=-1,o=0,l=-1,d,f;for(;++l<=e.length;){if(l<e.length)d=e.codePointAt(l);else{if(d===47)break;d=47}if(d===47){if(!(a===l-1||o===1))if(a!==l-1&&o===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(f=t.lastIndexOf("/"),f!==t.length-1){f<0?(t="",r=0):(t=t.slice(0,f),r=t.length-1-t.lastIndexOf("/")),a=l,o=0;continue}}else if(t.length>0){t="",r=0,a=l,o=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,l):t=e.slice(a+1,l),r=l-a-1;a=l,o=0}else d===46&&o>-1?o++:o=-1}return t}function fg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const rX={cwd:iX};function iX(){return"/"}function q1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function aX(e){if(typeof e=="string")e=new URL(e);else if(!q1(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return sX(e)}function sX(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const O0=["history","path","basename","stem","extname","dirname"];class oX{constructor(n){let t;n?q1(n)?t={path:n}:typeof n=="string"||lX(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":rX.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<O0.length;){const o=O0[r];o in t&&t[o]!==void 0&&t[o]!==null&&(this[o]=o==="history"?[...t[o]]:t[o])}let a;for(a in t)O0.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?qo.basename(this.path):void 0}set basename(n){F0(n,"basename"),L0(n,"basename"),this.path=qo.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?qo.dirname(this.path):void 0}set dirname(n){s_(this.basename,"dirname"),this.path=qo.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?qo.extname(this.path):void 0}set extname(n){if(L0(n,"extname"),s_(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=qo.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){q1(n)&&(n=aX(n)),F0(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?qo.basename(this.path,this.extname):void 0}set stem(n){F0(n,"stem"),L0(n,"stem"),this.path=qo.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new ma(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}}function L0(e,n){if(e&&e.includes(qo.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+qo.sep+"`")}function F0(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function s_(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function lX(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const cX=function(e){const r=this.constructor.prototype,a=r[e],o=function(){return a.apply(o,arguments)};return Object.setPrototypeOf(o,r),o},uX={}.hasOwnProperty;class Kw extends cX{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=QK()}copy(){const n=new Kw;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data(M0(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(U0("data",this.frozen),this.namespace[n]=t,this):uX.call(this.namespace,n)&&this.namespace[n]||void 0:n?(U0("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=_x(n),r=this.parser||this.Parser;return $0("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),$0("process",this.parser||this.Parser),z0("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(o,l){const d=_x(n),f=r.parse(d);r.run(f,d,function(p,g,b){if(p||!g||!b)return u(p);const v=g,S=r.stringify(v,b);hX(S)?b.value=S:b.result=S,u(p,b)});function u(p,g){p||!g?l(p):o?o(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),$0("processSync",this.parser||this.Parser),z0("processSync",this.compiler||this.Compiler),this.process(n,a),l_("processSync","process",t),r;function a(o,l){t=!0,i_(o),r=l}}run(n,t,r){o_(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?o(void 0,r):new Promise(o);function o(l,d){const f=_x(t);a.run(n,f,u);function u(p,g,b){const v=g||n;p?d(p):l?l(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,o),l_("runSync","run",r),a;function o(l,d){i_(l),a=d,r=!0}}stringify(n,t){this.freeze();const r=_x(t),a=this.compiler||this.Compiler;return z0("stringify",a),o_(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(U0("use",this.frozen),n!=null)if(typeof n=="function")f(n,t);else if(typeof n=="object")Array.isArray(n)?d(n):l(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function o(u){if(typeof u=="function")f(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[p,...g]=u;f(p,g)}else l(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function l(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");d(u.plugins),u.settings&&(a.settings=M0(!0,a.settings,u.settings))}function d(u){let p=-1;if(u!=null)if(Array.isArray(u))for(;++p<u.length;){const g=u[p];o(g)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function f(u,p){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===u){b=g;break}if(b===-1)r.push([u,...p]);else if(p.length>0){let[v,...S]=p;const k=r[b][1];B1(k)&&B1(v)&&(v=M0(!0,k,v)),r[b]=[u,v,...S]}}}}const dX=new Kw().freeze();function $0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function z0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function U0(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function o_(e){if(!B1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function l_(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function _x(e){return fX(e)?e:new oX(e)}function fX(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function hX(e){return typeof e=="string"||pX(e)}function pX(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const mX=dX().use(FJ).use(GK).freeze(),qE=-1,Hb=0,Hm=1,gb=2,Xw=3,Zw=4,eS=5,tS=6,VE=7,HE=8,c_=typeof self=="object"?self:globalThis,gX=(e,n)=>{const t=(a,o)=>(e.set(o,a),a),r=a=>{if(e.has(a))return e.get(a);const[o,l]=n[a];switch(o){case Hb:case qE:return t(l,a);case Hm:{const d=t([],a);for(const f of l)d.push(r(f));return d}case gb:{const d=t({},a);for(const[f,u]of l)d[r(f)]=r(u);return d}case Xw:return t(new Date(l),a);case Zw:{const{source:d,flags:f}=l;return t(new RegExp(d,f),a)}case eS:{const d=t(new Map,a);for(const[f,u]of l)d.set(r(f),r(u));return d}case tS:{const d=t(new Set,a);for(const f of l)d.add(r(f));return d}case VE:{const{name:d,message:f}=l;return t(new c_[d](f),a)}case HE:return t(BigInt(l),a);case"BigInt":return t(Object(BigInt(l)),a);case"ArrayBuffer":return t(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:d}=new Uint8Array(l);return t(new DataView(d),l)}}return t(new c_[o](l),a)};return r},u_=e=>gX(new Map,e)(0),yh="",{toString:yX}={},{keys:xX}=Object,Om=e=>{const n=typeof e;if(n!=="object"||!e)return[Hb,n];const t=yX.call(e).slice(8,-1);switch(t){case"Array":return[Hm,yh];case"Object":return[gb,yh];case"Date":return[Xw,yh];case"RegExp":return[Zw,yh];case"Map":return[eS,yh];case"Set":return[tS,yh];case"DataView":return[Hm,t]}return t.includes("Array")?[Hm,t]:t.includes("Error")?[VE,t]:[gb,t]},kx=([e,n])=>e===Hb&&(n==="function"||n==="symbol"),bX=(e,n,t,r)=>{const a=(l,d)=>{const f=r.push(l)-1;return t.set(d,f),f},o=l=>{if(t.has(l))return t.get(l);let[d,f]=Om(l);switch(d){case Hb:{let p=l;switch(f){case"bigint":d=HE,p=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+f);p=null;break;case"undefined":return a([qE],l)}return a([d,p],l)}case Hm:{if(f){let b=l;return f==="DataView"?b=new Uint8Array(l.buffer):f==="ArrayBuffer"&&(b=new Uint8Array(l)),a([f,[...b]],l)}const p=[],g=a([d,p],l);for(const b of l)p.push(o(b));return g}case gb:{if(f)switch(f){case"BigInt":return a([f,l.toString()],l);case"Boolean":case"Number":case"String":return a([f,l.valueOf()],l)}if(n&&"toJSON"in l)return o(l.toJSON());const p=[],g=a([d,p],l);for(const b of xX(l))(e||!kx(Om(l[b])))&&p.push([o(b),o(l[b])]);return g}case Xw:return a([d,l.toISOString()],l);case Zw:{const{source:p,flags:g}=l;return a([d,{source:p,flags:g}],l)}case eS:{const p=[],g=a([d,p],l);for(const[b,v]of l)(e||!(kx(Om(b))||kx(Om(v))))&&p.push([o(b),o(v)]);return g}case tS:{const p=[],g=a([d,p],l);for(const b of l)(e||!kx(Om(b)))&&p.push(o(b));return g}}const{message:u}=l;return a([d,{name:f,message:u}],l)};return o},d_=(e,{json:n,lossy:t}={})=>{const r=[];return bX(!(n||t),!!n,new Map,r)(e),r},tg=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?u_(d_(e,n)):structuredClone(e):(e,n)=>u_(d_(e,n)),GE=WE("end"),YE=WE("start");function WE(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function QE(e){const n=YE(e),t=GE(e);if(n&&t)return{start:n,end:t}}const Ad=["ariaDescribedBy","ariaLabel","ariaLabelledBy"],f_={ancestors:{tbody:["table"],td:["table"],th:["table"],thead:["table"],tfoot:["table"],tr:["table"]},attributes:{a:[...Ad,"dataFootnoteBackref","dataFootnoteRef",["className","data-footnote-backref"],"href"],blockquote:["cite"],code:[["className",/^language-./]],del:["cite"],div:["itemScope","itemType"],dl:[...Ad],h2:[["className","sr-only"]],img:[...Ad,"longDesc","src"],input:[["disabled",!0],["type","checkbox"]],ins:["cite"],li:[["className","task-list-item"]],ol:[...Ad,["className","contains-task-list"]],q:["cite"],section:["dataFootnotes",["className","footnotes"]],source:["srcSet"],summary:[...Ad],table:[...Ad],ul:[...Ad,["className","contains-task-list"]],"*":["abbr","accept","acceptCharset","accessKey","action","align","alt","axis","border","cellPadding","cellSpacing","char","charOff","charSet","checked","clear","colSpan","color","cols","compact","coords","dateTime","dir","encType","frame","hSpace","headers","height","hrefLang","htmlFor","id","isMap","itemProp","label","lang","maxLength","media","method","multiple","name","noHref","noShade","noWrap","open","prompt","readOnly","rev","rowSpan","rows","rules","scope","selected","shape","size","span","start","summary","tabIndex","title","useMap","vAlign","value","width"]},clobber:["ariaDescribedBy","ariaLabelledBy","id","name"],clobberPrefix:"user-content-",protocols:{cite:["http","https"],href:["http","https","irc","ircs","mailto","xmpp"],longDesc:["http","https"],src:["http","https"]},required:{input:{disabled:!0,type:"checkbox"}},strip:["script"],tagNames:["a","b","blockquote","br","code","dd","del","details","div","dl","dt","em","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","li","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","tr","tt","ul","var"]},au={}.hasOwnProperty;function vX(e,n){let t={type:"root",children:[]};const r={schema:n?{...f_,...n}:f_,stack:[]},a=JE(r,e);return a&&(Array.isArray(a)?a.length===1?t=a[0]:t.children=a:t=a),t}function JE(e,n){if(n&&typeof n=="object"){const t=n;switch(typeof t.type=="string"?t.type:""){case"comment":return wX(e,t);case"doctype":return SX(e,t);case"element":return NX(e,t);case"root":return CX(e,t);case"text":return jX(e,t)}}}function wX(e,n){if(e.schema.allowComments){const t=typeof n.value=="string"?n.value:"",r=t.indexOf("-->"),o={type:"comment",value:r<0?t:t.slice(0,r)};return hg(o,n),o}}function SX(e,n){if(e.schema.allowDoctypes){const t={type:"doctype"};return hg(t,n),t}}function NX(e,n){const t=typeof n.tagName=="string"?n.tagName:"";e.stack.push(t);const r=KE(e,n.children),a=_X(e,n.properties);e.stack.pop();let o=!1;if(t&&t!=="*"&&(!e.schema.tagNames||e.schema.tagNames.includes(t))&&(o=!0,e.schema.ancestors&&au.call(e.schema.ancestors,t))){const d=e.schema.ancestors[t];let f=-1;for(o=!1;++f<d.length;)e.stack.includes(d[f])&&(o=!0)}if(!o)return e.schema.strip&&!e.schema.strip.includes(t)?r:void 0;const l={type:"element",tagName:t,properties:a,children:r};return hg(l,n),l}function CX(e,n){const r={type:"root",children:KE(e,n.children)};return hg(r,n),r}function jX(e,n){const r={type:"text",value:typeof n.value=="string"?n.value:""};return hg(r,n),r}function KE(e,n){const t=[];if(Array.isArray(n)){const r=n;let a=-1;for(;++a<r.length;){const o=JE(e,r[a]);o&&(Array.isArray(o)?t.push(...o):t.push(o))}}return t}function _X(e,n){const t=e.stack[e.stack.length-1],r=e.schema.attributes,a=e.schema.required,o=r&&au.call(r,t)?r[t]:void 0,l=r&&au.call(r,"*")?r["*"]:void 0,d=n&&typeof n=="object"?n:{},f={};let u;for(u in d)if(au.call(d,u)){const p=d[u];let g=h_(e,p_(o,u),u,p);g==null&&(g=h_(e,p_(l,u),u,p)),g!=null&&(f[u]=g)}if(a&&au.call(a,t)){const p=a[t];for(u in p)au.call(p,u)&&!au.call(f,u)&&(f[u]=p[u])}return f}function h_(e,n,t,r){return n?Array.isArray(r)?kX(e,n,t,r):XE(e,n,t,r):void 0}function kX(e,n,t,r){let a=-1;const o=[];for(;++a<r.length;){const l=XE(e,n,t,r[a]);(typeof l=="number"||typeof l=="string")&&o.push(l)}return o}function XE(e,n,t,r){if(!(typeof r!="boolean"&&typeof r!="number"&&typeof r!="string")&&TX(e,t,r)){if(typeof n=="object"&&n.length>1){let a=!1,o=0;for(;++o<n.length;){const l=n[o];if(l&&typeof l=="object"&&"flags"in l){if(l.test(String(r))){a=!0;break}}else if(l===r){a=!0;break}}if(!a)return}return e.schema.clobber&&e.schema.clobberPrefix&&e.schema.clobber.includes(t)?e.schema.clobberPrefix+r:r}}function TX(e,n,t){const r=e.schema.protocols&&au.call(e.schema.protocols,n)?e.schema.protocols[n]:void 0;if(!r||r.length===0)return!0;const a=String(t),o=a.indexOf(":"),l=a.indexOf("?"),d=a.indexOf("#"),f=a.indexOf("/");if(o<0||f>-1&&o>f||l>-1&&o>l||d>-1&&o>d)return!0;let u=-1;for(;++u<r.length;){const p=r[u];if(o===p.length&&a.slice(0,p.length)===p)return!0}return!1}function hg(e,n){const t=QE(n);n.data&&(e.data=tg(n.data)),t&&(e.position=t)}function p_(e,n){let t,r=-1;if(e)for(;++r<e.length;){const a=e[r],o=typeof a=="string"?a:a[0];if(o===n)return a;o==="data*"&&(t=a)}if(n.length>4&&n.slice(0,4).toLowerCase()==="data")return t}function EX(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function AX(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function PX(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function DX(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function IX(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function RX(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=Yh(r.toLowerCase()),o=e.footnoteOrder.indexOf(r);let l,d=e.footnoteCounts.get(r);d===void 0?(d=0,e.footnoteOrder.push(r),l=e.footnoteOrder.length):l=o+1,d+=1,e.footnoteCounts.set(r,d);const f={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(d>1?"-"+d:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(n,f);const u={type:"element",tagName:"sup",properties:{},children:[f]};return e.patch(n,u),e.applyData(n,u)}function MX(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function OX(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function ZE(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),o=a[0];o&&o.type==="text"?o.value="["+o.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=r:a.push({type:"text",value:r}),a}function LX(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return ZE(e,n);const a={src:Yh(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,o),e.applyData(n,o)}function FX(e,n){const t={src:Yh(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function $X(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function zX(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return ZE(e,n);const a={href:Yh(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,o),e.applyData(n,o)}function UX(e,n){const t={href:Yh(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function BX(e,n,t){const r=e.all(n),a=t?qX(t):eA(n),o={},l=[];if(typeof n.checked=="boolean"){const p=r[0];let g;p&&p.type==="element"&&p.tagName==="p"?g=p:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let d=-1;for(;++d<r.length;){const p=r[d];(a||d!==0||p.type!=="element"||p.tagName!=="p")&&l.push({type:"text",value:`
`}),p.type==="element"&&p.tagName==="p"&&!a?l.push(...p.children):l.push(p)}const f=r[r.length-1];f&&(a||f.type!=="element"||f.tagName!=="p")&&l.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:o,children:l};return e.patch(n,u),e.applyData(n,u)}function qX(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=eA(t[r])}return n}function eA(e){const n=e.spread;return n??e.children.length>1}function VX(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const l=r[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const o={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,o),e.applyData(n,o)}function HX(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function GX(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function YX(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function WX(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],l),a.push(l)}if(t.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},d=YE(n.children[1]),f=GE(n.children[n.children.length-1]);d&&f&&(l.position={start:d,end:f}),a.push(l)}const o={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,o),e.applyData(n,o)}function QX(e,n,t){const r=t?t.children:void 0,o=(r?r.indexOf(n):1)===0?"th":"td",l=t&&t.type==="table"?t.align:void 0,d=l?l.length:n.children.length;let f=-1;const u=[];for(;++f<d;){const g=n.children[f],b={},v=l?l[f]:void 0;v&&(b.align=v);let S={type:"element",tagName:o,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),u.push(S)}const p={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(n,p),e.applyData(n,p)}function JX(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const m_=9,g_=32;function KX(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const o=[];for(;r;)o.push(y_(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return o.push(y_(n.slice(a),a>0,!1)),o.join("")}function y_(e,n,t){let r=0,a=e.length;if(n){let o=e.codePointAt(r);for(;o===m_||o===g_;)r++,o=e.codePointAt(r)}if(t){let o=e.codePointAt(a-1);for(;o===m_||o===g_;)a--,o=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function XX(e,n){const t={type:"text",value:KX(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function ZX(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const eZ={blockquote:EX,break:AX,code:PX,delete:DX,emphasis:IX,footnoteReference:RX,heading:MX,html:OX,imageReference:LX,image:FX,inlineCode:$X,linkReference:zX,link:UX,listItem:BX,list:VX,paragraph:HX,root:GX,strong:YX,table:WX,tableCell:JX,tableRow:QX,text:XX,thematicBreak:ZX,toml:Tx,yaml:Tx,definition:Tx,footnoteDefinition:Tx};function Tx(){}function tZ(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function nZ(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function rZ(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||tZ,r=e.options.footnoteBackLabel||nZ,a=e.options.footnoteLabel||"Footnotes",o=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},d=[];let f=-1;for(;++f<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[f]);if(!u)continue;const p=e.all(u),g=String(u.identifier).toUpperCase(),b=Yh(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let M=typeof t=="string"?t:t(f,v);typeof M=="string"&&(M={type:"text",value:M}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(f,v),className:["data-footnote-backref"]},children:Array.isArray(M)?M:[M]})}const T=p[p.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const M=T.children[T.children.length-1];M&&M.type==="text"?M.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...S)}else p.push(...S);const P={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(p,!0)};e.patch(u,P),d.push(P)}if(d.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...tg(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(d,!0)},{type:"text",value:`
`}]}}const V1={}.hasOwnProperty,iZ={};function aZ(e,n){const t=n||iZ,r=new Map,a=new Map,o=new Map,l={...eZ,...t.handlers},d={all:u,applyData:oZ,definitionById:r,footnoteById:a,footnoteCounts:o,footnoteOrder:[],handlers:l,one:f,options:t,patch:sZ,wrap:cZ};return DE(e,function(p){if(p.type==="definition"||p.type==="footnoteDefinition"){const g=p.type==="definition"?r:a,b=String(p.identifier).toUpperCase();g.has(b)||g.set(b,p)}}),d;function f(p,g){const b=p.type,v=d.handlers[b];if(V1.call(d.handlers,b)&&v)return v(d,p,g);if(d.options.passThrough&&d.options.passThrough.includes(b)){if("children"in p){const{children:k,...T}=p,P=tg(T);return P.children=d.all(p),P}return tg(p)}return(d.options.unknownHandler||lZ)(d,p,g)}function u(p){const g=[];if("children"in p){const b=p.children;let v=-1;for(;++v<b.length;){const S=d.one(b[v],p);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=x_(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=x_(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function sZ(e,n){e.position&&(n.position=QE(e))}function oZ(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,o=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const l="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:l}}t.type==="element"&&o&&Object.assign(t.properties,tg(o)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function lZ(e,n){const t=n.data||{},r="value"in n&&!(V1.call(t,"hProperties")||V1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function cZ(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function x_(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function uZ(e,n){const t=aZ(e,n),r=t.one(e,void 0),a=rZ(t),o=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&o.children.push({type:"text",value:`
`},a),o}const dZ=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"];class pg{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}}pg.prototype.normal={};pg.prototype.property={};pg.prototype.space=void 0;function tA(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new pg(t,r,n)}function H1(e){return e.toLowerCase()}class ga{constructor(n,t){this.attribute=t,this.property=n}}ga.prototype.attribute="";ga.prototype.booleanish=!1;ga.prototype.boolean=!1;ga.prototype.commaOrSpaceSeparated=!1;ga.prototype.commaSeparated=!1;ga.prototype.defined=!1;ga.prototype.mustUseProperty=!1;ga.prototype.number=!1;ga.prototype.overloadedBoolean=!1;ga.prototype.property="";ga.prototype.spaceSeparated=!1;ga.prototype.space=void 0;let fZ=0;const Xt=qd(),Or=qd(),G1=qd(),at=qd(),ar=qd(),kh=qd(),Da=qd();function qd(){return 2**++fZ}const Y1=Object.freeze(Object.defineProperty({__proto__:null,boolean:Xt,booleanish:Or,commaOrSpaceSeparated:Da,commaSeparated:kh,number:at,overloadedBoolean:G1,spaceSeparated:ar},Symbol.toStringTag,{value:"Module"})),B0=Object.keys(Y1);class nS extends ga{constructor(n,t,r,a){let o=-1;if(super(n,t),b_(this,"space",a),typeof r=="number")for(;++o<B0.length;){const l=B0[o];b_(this,B0[o],(r&Y1[l])===Y1[l])}}}nS.prototype.defined=!0;function b_(e,n,t){t&&(e[n]=t)}function Wh(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const o=new nS(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(o.mustUseProperty=!0),n[r]=o,t[H1(r)]=r,t[H1(o.attribute)]=r}return new pg(n,t,e.space)}const nA=Wh({properties:{ariaActiveDescendant:null,ariaAtomic:Or,ariaAutoComplete:null,ariaBusy:Or,ariaChecked:Or,ariaColCount:at,ariaColIndex:at,ariaColSpan:at,ariaControls:ar,ariaCurrent:null,ariaDescribedBy:ar,ariaDetails:null,ariaDisabled:Or,ariaDropEffect:ar,ariaErrorMessage:null,ariaExpanded:Or,ariaFlowTo:ar,ariaGrabbed:Or,ariaHasPopup:null,ariaHidden:Or,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:ar,ariaLevel:at,ariaLive:null,ariaModal:Or,ariaMultiLine:Or,ariaMultiSelectable:Or,ariaOrientation:null,ariaOwns:ar,ariaPlaceholder:null,ariaPosInSet:at,ariaPressed:Or,ariaReadOnly:Or,ariaRelevant:null,ariaRequired:Or,ariaRoleDescription:ar,ariaRowCount:at,ariaRowIndex:at,ariaRowSpan:at,ariaSelected:Or,ariaSetSize:at,ariaSort:null,ariaValueMax:at,ariaValueMin:at,ariaValueNow:at,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function rA(e,n){return n in e?e[n]:n}function iA(e,n){return rA(e,n.toLowerCase())}const hZ=Wh({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:kh,acceptCharset:ar,accessKey:ar,action:null,allow:null,allowFullScreen:Xt,allowPaymentRequest:Xt,allowUserMedia:Xt,alt:null,as:null,async:Xt,autoCapitalize:null,autoComplete:ar,autoFocus:Xt,autoPlay:Xt,blocking:ar,capture:null,charSet:null,checked:Xt,cite:null,className:ar,cols:at,colSpan:null,content:null,contentEditable:Or,controls:Xt,controlsList:ar,coords:at|kh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Xt,defer:Xt,dir:null,dirName:null,disabled:Xt,download:G1,draggable:Or,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Xt,formTarget:null,headers:ar,height:at,hidden:G1,high:at,href:null,hrefLang:null,htmlFor:ar,httpEquiv:ar,id:null,imageSizes:null,imageSrcSet:null,inert:Xt,inputMode:null,integrity:null,is:null,isMap:Xt,itemId:null,itemProp:ar,itemRef:ar,itemScope:Xt,itemType:ar,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Xt,low:at,manifest:null,max:null,maxLength:at,media:null,method:null,min:null,minLength:at,multiple:Xt,muted:Xt,name:null,nonce:null,noModule:Xt,noValidate:Xt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Xt,optimum:at,pattern:null,ping:ar,placeholder:null,playsInline:Xt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Xt,referrerPolicy:null,rel:ar,required:Xt,reversed:Xt,rows:at,rowSpan:at,sandbox:ar,scope:null,scoped:Xt,seamless:Xt,selected:Xt,shadowRootClonable:Xt,shadowRootDelegatesFocus:Xt,shadowRootMode:null,shape:null,size:at,sizes:null,slot:null,span:at,spellCheck:Or,src:null,srcDoc:null,srcLang:null,srcSet:null,start:at,step:null,style:null,tabIndex:at,target:null,title:null,translate:null,type:null,typeMustMatch:Xt,useMap:null,value:Or,width:at,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:ar,axis:null,background:null,bgColor:null,border:at,borderColor:null,bottomMargin:at,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Xt,declare:Xt,event:null,face:null,frame:null,frameBorder:null,hSpace:at,leftMargin:at,link:null,longDesc:null,lowSrc:null,marginHeight:at,marginWidth:at,noResize:Xt,noHref:Xt,noShade:Xt,noWrap:Xt,object:null,profile:null,prompt:null,rev:null,rightMargin:at,rules:null,scheme:null,scrolling:Or,standby:null,summary:null,text:null,topMargin:at,valueType:null,version:null,vAlign:null,vLink:null,vSpace:at,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Xt,disableRemotePlayback:Xt,prefix:null,property:null,results:at,security:null,unselectable:null},space:"html",transform:iA}),pZ=Wh({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Da,accentHeight:at,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:at,amplitude:at,arabicForm:null,ascent:at,attributeName:null,attributeType:null,azimuth:at,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:at,by:null,calcMode:null,capHeight:at,className:ar,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:at,diffuseConstant:at,direction:null,display:null,dur:null,divisor:at,dominantBaseline:null,download:Xt,dx:null,dy:null,edgeMode:null,editable:null,elevation:at,enableBackground:null,end:null,event:null,exponent:at,externalResourcesRequired:null,fill:null,fillOpacity:at,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:kh,g2:kh,glyphName:kh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:at,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:at,horizOriginX:at,horizOriginY:at,id:null,ideographic:at,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:at,k:at,k1:at,k2:at,k3:at,k4:at,kernelMatrix:Da,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:at,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:at,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:at,overlineThickness:at,paintOrder:null,panose1:null,path:null,pathLength:at,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:ar,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:at,pointsAtY:at,pointsAtZ:at,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Da,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Da,rev:Da,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Da,requiredFeatures:Da,requiredFonts:Da,requiredFormats:Da,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:at,specularExponent:at,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:at,strikethroughThickness:at,string:null,stroke:null,strokeDashArray:Da,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:at,strokeOpacity:at,strokeWidth:null,style:null,surfaceScale:at,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Da,tabIndex:at,tableValues:null,target:null,targetX:at,targetY:at,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Da,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:at,underlineThickness:at,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:at,values:null,vAlphabetic:at,vMathematical:at,vectorEffect:null,vHanging:at,vIdeographic:at,version:null,vertAdvY:at,vertOriginX:at,vertOriginY:at,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:at,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:rA}),aA=Wh({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),sA=Wh({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:iA}),oA=Wh({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),mZ=/[A-Z]/g,v_=/-[a-z]/g,gZ=/^data[-\w.:]+$/i;function yZ(e,n){const t=H1(n);let r=n,a=ga;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&gZ.test(n)){if(n.charAt(4)==="-"){const o=n.slice(5).replace(v_,bZ);r="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=n.slice(4);if(!v_.test(o)){let l=o.replace(mZ,xZ);l.charAt(0)!=="-"&&(l="-"+l),n="data"+l}}a=nS}return new a(r,n)}function xZ(e){return"-"+e.toLowerCase()}function bZ(e){return e.charAt(1).toUpperCase()}const vZ=tA([nA,hZ,aA,sA,oA],"html"),lA=tA([nA,pZ,aA,sA,oA],"svg"),wZ=/["&'<>`]/g,SZ=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,NZ=/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,CZ=/[|\\{}()[\]^$+*?.]/g,w_=new WeakMap;function jZ(e,n){if(e=e.replace(n.subset?_Z(n.subset):wZ,r),n.subset||n.escapeOnly)return e;return e.replace(SZ,t).replace(NZ,r);function t(a,o,l){return n.format((a.charCodeAt(0)-55296)*1024+a.charCodeAt(1)-56320+65536,l.charCodeAt(o+2),n)}function r(a,o,l){return n.format(a.charCodeAt(0),l.charCodeAt(o+1),n)}}function _Z(e){let n=w_.get(e);return n||(n=kZ(e),w_.set(e,n)),n}function kZ(e){const n=[];let t=-1;for(;++t<e.length;)n.push(e[t].replace(CZ,"\\$&"));return new RegExp("(?:"+n.join("|")+")","g")}const TZ=/[\dA-Fa-f]/;function EZ(e,n,t){const r="&#x"+e.toString(16).toUpperCase();return t&&n&&!TZ.test(String.fromCharCode(n))?r:r+";"}const AZ=/\d/;function PZ(e,n,t){const r="&#"+String(e);return t&&n&&!AZ.test(String.fromCharCode(n))?r:r+";"}const DZ=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],q0={nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",fnof:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",bull:"",hellip:"",prime:"",Prime:"",oline:"",frasl:"",weierp:"",image:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",quot:'"',amp:"&",lt:"<",gt:">",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",permil:"",lsaquo:"",rsaquo:"",euro:""},IZ=["cent","copy","divide","gt","lt","not","para","times"],cA={}.hasOwnProperty,W1={};let Ex;for(Ex in q0)cA.call(q0,Ex)&&(W1[q0[Ex]]=Ex);const RZ=/[^\dA-Za-z]/;function MZ(e,n,t,r){const a=String.fromCharCode(e);if(cA.call(W1,a)){const o=W1[a],l="&"+o;return t&&DZ.includes(o)&&!IZ.includes(o)&&(!r||n&&n!==61&&RZ.test(String.fromCharCode(n)))?l:l+";"}return""}function OZ(e,n,t){let r=EZ(e,n,t.omitOptionalSemicolons),a;if((t.useNamedReferences||t.useShortestReferences)&&(a=MZ(e,n,t.omitOptionalSemicolons,t.attribute)),(t.useShortestReferences||!a)&&t.useShortestReferences){const o=PZ(e,n,t.omitOptionalSemicolons);o.length<r.length&&(r=o)}return a&&(!t.useShortestReferences||a.length<r.length)?a:r}function Th(e,n){return jZ(e,Object.assign({format:OZ},n))}const LZ=/^>|^->|<!--|-->|--!>|<!-$/g,FZ=[">"],$Z=["<",">"];function zZ(e,n,t,r){return r.settings.bogusComments?"<?"+Th(e.value,Object.assign({},r.settings.characterReferences,{subset:FZ}))+">":"<!--"+e.value.replace(LZ,a)+"-->";function a(o){return Th(o,Object.assign({},r.settings.characterReferences,{subset:$Z}))}}function UZ(e,n,t,r){return"<!"+(r.settings.upperDoctype?"DOCTYPE":"doctype")+(r.settings.tightDoctype?"":" ")+"html>"}function S_(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function BZ(e,n){const t=n||{};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}function qZ(e){return e.join(" ").trim()}const VZ=/[ \t\n\f\r]/g;function rS(e){return typeof e=="object"?e.type==="text"?N_(e.value):!1:N_(e)}function N_(e){return e.replace(VZ,"")===""}const zr=dA(1),uA=dA(-1),HZ=[];function dA(e){return n;function n(t,r,a){const o=t?t.children:HZ;let l=(r||0)+e,d=o[l];if(!a)for(;d&&rS(d);)l+=e,d=o[l];return d}}const GZ={}.hasOwnProperty;function fA(e){return n;function n(t,r,a){return GZ.call(e,t.tagName)&&e[t.tagName](t,r,a)}}const iS=fA({body:WZ,caption:V0,colgroup:V0,dd:XZ,dt:KZ,head:V0,html:YZ,li:JZ,optgroup:ZZ,option:eee,p:QZ,rp:C_,rt:C_,tbody:nee,td:j_,tfoot:ree,th:j_,thead:tee,tr:iee});function V0(e,n,t){const r=zr(t,n,!0);return!r||r.type!=="comment"&&!(r.type==="text"&&rS(r.value.charAt(0)))}function YZ(e,n,t){const r=zr(t,n);return!r||r.type!=="comment"}function WZ(e,n,t){const r=zr(t,n);return!r||r.type!=="comment"}function QZ(e,n,t){const r=zr(t,n);return r?r.type==="element"&&(r.tagName==="address"||r.tagName==="article"||r.tagName==="aside"||r.tagName==="blockquote"||r.tagName==="details"||r.tagName==="div"||r.tagName==="dl"||r.tagName==="fieldset"||r.tagName==="figcaption"||r.tagName==="figure"||r.tagName==="footer"||r.tagName==="form"||r.tagName==="h1"||r.tagName==="h2"||r.tagName==="h3"||r.tagName==="h4"||r.tagName==="h5"||r.tagName==="h6"||r.tagName==="header"||r.tagName==="hgroup"||r.tagName==="hr"||r.tagName==="main"||r.tagName==="menu"||r.tagName==="nav"||r.tagName==="ol"||r.tagName==="p"||r.tagName==="pre"||r.tagName==="section"||r.tagName==="table"||r.tagName==="ul"):!t||!(t.type==="element"&&(t.tagName==="a"||t.tagName==="audio"||t.tagName==="del"||t.tagName==="ins"||t.tagName==="map"||t.tagName==="noscript"||t.tagName==="video"))}function JZ(e,n,t){const r=zr(t,n);return!r||r.type==="element"&&r.tagName==="li"}function KZ(e,n,t){const r=zr(t,n);return!!(r&&r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd"))}function XZ(e,n,t){const r=zr(t,n);return!r||r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd")}function C_(e,n,t){const r=zr(t,n);return!r||r.type==="element"&&(r.tagName==="rp"||r.tagName==="rt")}function ZZ(e,n,t){const r=zr(t,n);return!r||r.type==="element"&&r.tagName==="optgroup"}function eee(e,n,t){const r=zr(t,n);return!r||r.type==="element"&&(r.tagName==="option"||r.tagName==="optgroup")}function tee(e,n,t){const r=zr(t,n);return!!(r&&r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot"))}function nee(e,n,t){const r=zr(t,n);return!r||r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot")}function ree(e,n,t){return!zr(t,n)}function iee(e,n,t){const r=zr(t,n);return!r||r.type==="element"&&r.tagName==="tr"}function j_(e,n,t){const r=zr(t,n);return!r||r.type==="element"&&(r.tagName==="td"||r.tagName==="th")}const aee=fA({body:lee,colgroup:cee,head:oee,html:see,tbody:uee});function see(e){const n=zr(e,-1);return!n||n.type!=="comment"}function oee(e){const n=new Set;for(const r of e.children)if(r.type==="element"&&(r.tagName==="base"||r.tagName==="title")){if(n.has(r.tagName))return!1;n.add(r.tagName)}const t=e.children[0];return!t||t.type==="element"}function lee(e){const n=zr(e,-1,!0);return!n||n.type!=="comment"&&!(n.type==="text"&&rS(n.value.charAt(0)))&&!(n.type==="element"&&(n.tagName==="meta"||n.tagName==="link"||n.tagName==="script"||n.tagName==="style"||n.tagName==="template"))}function cee(e,n,t){const r=uA(t,n),a=zr(e,-1,!0);return t&&r&&r.type==="element"&&r.tagName==="colgroup"&&iS(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="col")}function uee(e,n,t){const r=uA(t,n),a=zr(e,-1);return t&&r&&r.type==="element"&&(r.tagName==="thead"||r.tagName==="tbody")&&iS(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="tr")}const Ax={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function dee(e,n,t,r){const a=r.schema,o=a.space==="svg"?!1:r.settings.omitOptionalTags;let l=a.space==="svg"?r.settings.closeEmptyElements:r.settings.voids.includes(e.tagName.toLowerCase());const d=[];let f;a.space==="html"&&e.tagName==="svg"&&(r.schema=lA);const u=fee(r,e.properties),p=r.all(a.space==="html"&&e.tagName==="template"?e.content:e);return r.schema=a,p&&(l=!1),(u||!o||!aee(e,n,t))&&(d.push("<",e.tagName,u?" "+u:""),l&&(a.space==="svg"||r.settings.closeSelfClosing)&&(f=u.charAt(u.length-1),(!r.settings.tightSelfClosing||f==="/"||f&&f!=='"'&&f!=="'")&&d.push(" "),d.push("/")),d.push(">")),d.push(p),!l&&(!o||!iS(e,n,t))&&d.push("</"+e.tagName+">"),d.join("")}function fee(e,n){const t=[];let r=-1,a;if(n){for(a in n)if(n[a]!==null&&n[a]!==void 0){const o=hee(e,a,n[a]);o&&t.push(o)}}for(;++r<t.length;){const o=e.settings.tightAttributes?t[r].charAt(t[r].length-1):void 0;r!==t.length-1&&o!=='"'&&o!=="'"&&(t[r]+=" ")}return t.join("")}function hee(e,n,t){const r=yZ(e.schema,n),a=e.settings.allowParseErrors&&e.schema.space==="html"?0:1,o=e.settings.allowDangerousCharacters?0:1;let l=e.quote,d;if(r.overloadedBoolean&&(t===r.attribute||t==="")?t=!0:(r.boolean||r.overloadedBoolean)&&(typeof t!="string"||t===r.attribute||t==="")&&(t=!!t),t==null||t===!1||typeof t=="number"&&Number.isNaN(t))return"";const f=Th(r.attribute,Object.assign({},e.settings.characterReferences,{subset:Ax.name[a][o]}));return t===!0||(t=Array.isArray(t)?(r.commaSeparated?BZ:qZ)(t,{padLeft:!e.settings.tightCommaSeparatedLists}):String(t),e.settings.collapseEmptyAttributes&&!t)?f:(e.settings.preferUnquoted&&(d=Th(t,Object.assign({},e.settings.characterReferences,{attribute:!0,subset:Ax.unquoted[a][o]}))),d!==t&&(e.settings.quoteSmart&&S_(t,l)>S_(t,e.alternative)&&(l=e.alternative),d=l+Th(t,Object.assign({},e.settings.characterReferences,{subset:(l==="'"?Ax.single:Ax.double)[a][o],attribute:!0}))+l),f+(d&&"="+d))}const pee=["<","&"];function hA(e,n,t,r){return t&&t.type==="element"&&(t.tagName==="script"||t.tagName==="style")?e.value:Th(e.value,Object.assign({},r.settings.characterReferences,{subset:pee}))}function mee(e,n,t,r){return r.settings.allowDangerousHtml?e.value:hA(e,n,t,r)}function gee(e,n,t,r){return r.all(e)}const yee=kE("type",{invalid:xee,unknown:bee,handlers:{comment:zZ,doctype:UZ,element:dee,raw:mee,root:gee,text:hA}});function xee(e){throw new Error("Expected node, not `"+e+"`")}function bee(e){const n=e;throw new Error("Cannot compile unknown node `"+n.type+"`")}const vee={},wee={},See=[];function Nee(e,n){const t=n||vee,r=t.quote||'"',a=r==='"'?"'":'"';if(r!=='"'&&r!=="'")throw new Error("Invalid quote `"+r+"`, expected `'` or `\"`");return{one:Cee,all:jee,settings:{omitOptionalTags:t.omitOptionalTags||!1,allowParseErrors:t.allowParseErrors||!1,allowDangerousCharacters:t.allowDangerousCharacters||!1,quoteSmart:t.quoteSmart||!1,preferUnquoted:t.preferUnquoted||!1,tightAttributes:t.tightAttributes||!1,upperDoctype:t.upperDoctype||!1,tightDoctype:t.tightDoctype||!1,bogusComments:t.bogusComments||!1,tightCommaSeparatedLists:t.tightCommaSeparatedLists||!1,tightSelfClosing:t.tightSelfClosing||!1,collapseEmptyAttributes:t.collapseEmptyAttributes||!1,allowDangerousHtml:t.allowDangerousHtml||!1,voids:t.voids||dZ,characterReferences:t.characterReferences||wee,closeSelfClosing:t.closeSelfClosing||!1,closeEmptyElements:t.closeEmptyElements||!1},schema:t.space==="svg"?lA:vZ,quote:r,alternative:a}.one(Array.isArray(e)?{type:"root",children:e}:e,void 0,void 0)}function Cee(e,n,t){return yee(e,n,t,this)}function jee(e){const n=[],t=e&&e.children||See;let r=-1;for(;++r<t.length;)n[r]=this.one(t[r],r,e);return n.join("")}const _ee={};function kee(e){const n=this,{handlers:t,sanitize:r,...a}=e||_ee;let o=!1,l;typeof r=="boolean"?o=!r:r&&(l=r),n.compiler=d;function d(f,u){const p=uZ(f,{handlers:t,allowDangerousHtml:o}),g=o?p:vX(p,l),b=Nee(g,{...a,allowDangerousHtml:o});return u.extname&&(u.extname=".html"),f&&f.type==="root"&&b&&/[^\r\n]/.test(b.charAt(b.length-1))?b+`
`:b}}const Tee=({isOpen:e,onClose:n,patientId:t,pharmacyInventory:r,fetchPharmacyOrdersData:a})=>{const[o,l]=w.useState([]),[d,f]=w.useState(""),[u,p]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>{if(!d){p([]);return}const I=d.toLowerCase();p(r.filter(U=>U.name.toLowerCase().includes(I)).slice(0,10))},[d,r]);const k=async()=>{if(!t){b("Patient ID is missing.");return}if(o.length===0){b("Please select at least one drug.");return}for(const I of o)if(I.selected_pack_quantity===0&&I.selected_loose_quantity===0){b(`Please specify a quantity for ${I.name}.`);return}S(!0),b(null);try{const I={patient_id:t,items:o.map(L=>({drug_id:L.id,name:L.name,pack_quantity:L.selected_pack_quantity,loose_quantity:L.selected_loose_quantity,pack_price:0,loose_price:0,total_price:0,tabletsPerDay:1,numberOfDays:1,directions_to_use:"As directed"})),order_total:0,prescription_for_unavailable_drugs:""},U=await pe("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)});if(!U.ok){const L=await U.json().catch(()=>({}));throw new Error(L.message||`Failed to create pharmacy order: ${U.statusText}`)}await U.json(),a(t),n(),l([]),f("")}catch(I){b(`Order Creation Error: ${I.message}`)}finally{S(!1)}},T=I=>{if(o.some(U=>U.id===I.id)){b(`${I.name} is already in the order.`),setTimeout(()=>b(null),3e3),f(""),p([]);return}l(U=>[...U,{...I,selected_pack_quantity:0,selected_loose_quantity:0}]),f(""),p([])},P=I=>{l(U=>U.filter(L=>L.id!==I))},M=(I,U,L)=>{const $=parseInt(L)||0;l(z=>z.map(F=>F.id===I?{...F,[U==="pack"?"selected_pack_quantity":"selected_loose_quantity"]:$}:F))};return e?i.jsx("div",{className:_t.modalOverlay,children:i.jsxs("div",{className:_t.modalContent,children:[i.jsxs("div",{className:_t.modalHeader,children:[i.jsx("h3",{className:_t.modalTitle,children:"Create Pharmacy Order"}),i.jsx("button",{onClick:n,className:_t.modalCloseButton,children:i.jsx(Xn,{size:20})})]}),i.jsxs("div",{className:_t.modalBody,children:[g&&i.jsx("div",{className:_t.errorText,children:g}),i.jsxs("div",{className:_t.formGroup,style:{position:"relative"},children:[i.jsx("label",{htmlFor:"drug-search",children:"Add Drug"}),i.jsx("input",{type:"text",id:"drug-search",placeholder:"Search available drugs...",value:d,onChange:I=>f(I.target.value),className:_t.inputField,autoComplete:"off"}),d&&u.length>0&&i.jsx("div",{className:_t.searchResultsCard,children:i.jsx("ul",{className:_t.searchResultsList,children:u.map(I=>i.jsx("li",{onClick:()=>T(I),className:_t.searchResultItem,children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[i.jsx("span",{children:I.name}),i.jsxs("span",{className:_t.searchResultPrice,children:["Stock: ",I.quantity_in_stock," (Box) / ",I.loose||0," (Loose)"]})]})},I.id))})})]}),i.jsxs("div",{className:_t.selectedTestsCard,children:[" ",i.jsx("h4",{className:_t.selectedTestsHeader,children:"Selected Drugs"}),o.length===0?i.jsx("p",{className:_t.noTestsMessage,children:"No drugs added yet."}):i.jsx("ul",{className:_t.selectedTestsList,children:o.map(I=>i.jsxs("li",{className:_t.selectedTestItem,style:{flexDirection:"column",alignItems:"flex-start",gap:"8px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",alignItems:"center"},children:[i.jsx("span",{className:_t.selectedTestName,style:{fontWeight:"bold"},children:I.name}),i.jsx("button",{type:"button",onClick:()=>P(String(I.id)),className:_t.removeTestButton,title:"Remove Drug",children:i.jsx(li,{size:16})})]}),i.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",width:"100%"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsx("label",{style:{fontSize:"0.75rem",color:"#666"},children:"Packs"}),i.jsx("input",{type:"number",min:"0",className:_t.inputField,style:{padding:"4px 8px"},value:I.selected_pack_quantity||"",onChange:U=>M(I.id,"pack",U.target.value),placeholder:"0"})]}),i.jsxs("div",{style:{flex:1},children:[i.jsx("label",{style:{fontSize:"0.75rem",color:"#666"},children:"Loose"}),i.jsx("input",{type:"number",min:"0",className:_t.inputField,style:{padding:"4px 8px"},value:I.selected_loose_quantity||"",onChange:U=>M(I.id,"loose",U.target.value),placeholder:"0"})]})]})]},I.id))})]})]}),i.jsxs("div",{className:_t.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${_t.button} ${_t.buttonSecondary}`,children:" Cancel "}),i.jsxs("button",{type:"button",onClick:k,disabled:o.length===0||v,className:`${_t.button} ${_t.buttonPrimary} ${o.length===0||v?_t.buttonDisabled:""}`,children:[" ",v?"Creating...":"Create Order"," "]})]})]})}):null},Eee=({messages:e})=>{const n=w.useRef(null);return w.useEffect(()=>{n.current&&(n.current.scrollTop=n.current.scrollHeight)},[e]),i.jsxs("div",{className:"conversation-panel",children:[i.jsxs("div",{className:"conversation-header",children:[i.jsx("div",{className:"conversation-title",children:i.jsx("h3",{children:"Conversation"})}),i.jsxs("span",{className:"conversation-count",children:[e.length," messages"]})]}),i.jsxs("div",{ref:n,className:"message-list custom-scrollbar",children:[e.length===0&&i.jsx("div",{className:"empty-state",children:"Start talking to the AI..."}),e.map(t=>i.jsxs("div",{className:`message-wrapper ${t.role}`,children:[i.jsx("div",{className:`message-bubble ${t.role} ${t.role==="system"?t.type||"info":""}`,children:t.role==="ai"||t.role==="system"&&t.type==="loading"?i.jsx("div",{className:"prose prose-sm max-w-none",children:t.role==="system"&&t.type==="loading"?i.jsxs("span",{className:"flex items-center justify-center gap-2",children:[i.jsx("span",{className:"loading-spinner"}),t.content]}):i.jsx(Yo,{remarkPlugins:[Bs],children:t.content})}):i.jsx("div",{className:"whitespace-pre-wrap",children:t.content})}),t.role!=="system"&&i.jsx("span",{className:"message-timestamp",children:t.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},t.id))]})]})},H0=e=>{if(!e)return"";const n=new Date(e);if(isNaN(n.getTime()))return"";const t=n.getTimezoneOffset()*6e4;return new Date(n.getTime()-t).toISOString().slice(0,16)},__=()=>{var go,yo;const{recordId:e,patientId:n}=Vi(),[t,r]=w.useState(e||void 0),a=Et(),o=Yr(),[l,d]=w.useState(""),[f]=w.useState([]),[u,p]=w.useState(null),[g,b]=w.useState(null),[v,S]=w.useState(void 0),[k,T]=w.useState(void 0),[P,M]=w.useState(null),[I,U]=w.useState(!1),[L,$]=w.useState(""),[z,F]=w.useState(!1),[Y,R]=w.useState(null),[B,G]=w.useState(null),[ie,te]=w.useState(!1),[W,V]=w.useState(!1),[se,re]=w.useState(null),[oe,E]=w.useState(""),[le,ue]=w.useState(""),[D,ce]=w.useState(null),[ve,X]=w.useState(!1),[fe,ae]=w.useState(!1),[Me,Ke]=w.useState(!1),[Z,Ee]=w.useState(window.innerHeight),[Ie,Fe]=w.useState([]),[rt,lt]=w.useState(!1),[ct,st]=w.useState(null),[Ht,rn]=w.useState([]),[je,qe]=w.useState([]),[Be,ke]=w.useState(!1),[we,Q]=w.useState(null),me=w.useRef(null),Ve=w.useRef(null),Qe=w.useRef(!1),ot=w.useRef(null),kt=w.useRef(null),qt=w.useRef(null),be=w.useRef(null),ge=w.useRef(null),Te=w.useRef(null),De=w.useRef(null),[ze,nt]=w.useState([]),[mt,Nt]=w.useState(!1);w.useEffect(()=>{(async()=>{if(ze.length>0&&!mt){Nt(!0);const he=ze[0];he.current&&(he.current.scrollIntoView({behavior:"smooth",block:"center"}),he.current.classList.add("ai-glow"),await new Promise(de=>setTimeout(de,2e3)),he.current&&he.current.classList.remove("ai-glow")),nt(de=>de.slice(1)),Nt(!1)}})()},[ze,mt]);const cn=ee=>{let he=null;switch(ee){case"update_patient_details":he=qt;break;case"create_pharmacy_order":case"edit_pharmacy_order":he=be;break;case"create_lab_order":case"edit_lab_order":he=ge;break;case"add_complaint_history":he=Te;break;case"update_case_summary":he=De;break}he&&nt(de=>[...de,he])},[gn,Cn]=w.useState(33.33),[bt,yt]=w.useState(!1),Ot=w.useRef(null),vt=w.useRef(null),[Wn,Hi]=w.useState("response"),br=w.useRef(null),yn=w.useRef(null),vr=150,[Ti,xu]=w.useState([]),[bu,Qh]=w.useState([]),[el,Qs]=w.useState(!1),[Zl,hs]=w.useState(null),[Js,Ks]=w.useState(!1),[Xs,mr]=w.useState(!1),[Vd,Hd]=w.useState(!1),[ps,Zs]=w.useState(!1),[ec,Gd]=w.useState(!1),[ms,Gi]=w.useState([]),[Fa,tl]=w.useState(!1),[Ei,nl]=w.useState(null),[rl,$a]=w.useState(!1),[tc,nc]=w.useState(null),[rc,vu]=w.useState({}),[Wr,ic]=w.useState(!1),[ac,il]=w.useState(!1),[eo,za]=w.useState(!1),[sc,Qr]=w.useState(!1),[to,oc]=w.useState(!1),[gs,ys]=w.useState(!1),[al,sl]=w.useState(!1),[Ai,Yi]=w.useState(!1),no=w.useMemo(()=>(g==null?void 0:g.admission_date)&&!(g!=null&&g.discharge_date),[g]),[lc,ro]=w.useState(!1),[Yd,cc]=w.useState(null),[xs,io]=w.useState(""),[ol,Ua]=w.useState(void 0),[Ba,ll]=w.useState(void 0),[cl,uc]=w.useState(void 0),[Jr,Pi]=w.useState(!1),[ao,Di]=w.useState(null),[qa,ul]=w.useState(null),[dc,fc]=w.useState(null),[xn,kn]=w.useState(!1),dl=w.useRef(null),[Fr,ya]=w.useState(null),[fl,so]=w.useState([]),Wd=w.useCallback(ee=>{so(he=>[...he,{id:Math.random().toString(36).substr(2,9),timestamp:new Date,role:"system",content:"",...ee}])},[]),[oo,hc]=w.useState(null),qn=w.useRef(null),xa=w.useRef(null),[Va,pc]=w.useState(!1),[hl,Kr]=w.useState(!1),[wn,mc]=w.useState(null),[pl,gc]=w.useState(""),[lo,co]=w.useState(""),[Ur,Qd]=w.useState(!0),[wr,Jd]=w.useState(!1),[yc,Xr]=w.useState(!1),[ba,xc]=w.useState(!1),[Vn,Wi]=w.useState(!1),bs=w.useRef(null),Jh=async()=>{bs.current&&(await bs.current.undoLastAction(),Wi(!1))},Ha=async ee=>{try{const he=await pe(`/api/patients/${ee}`);if(!he.ok){const Se=await he.json().catch(()=>({}));throw new Error(Se.message||`Failed to fetch patient details: ${he.status}`)}const de=await he.json();if(b(de),S(de.age),T(de.gender),E(de.ai_response||""),b(Se=>Se?{...Se,current_status:de.current_status,admission_date:de.admission_date,discharge_date:de.discharge_date}:{...de,current_status:de.current_status,admission_date:de.admission_date,discharge_date:de.discharge_date}),de.insurance_type&&b(Se=>Se?{...Se,insurance_type:de.insurance_type}:{...de}),ml(ee),de.ai_response){const Se=/```json\s*([\s\S]*?)\s*```/,Ye=de.ai_response.match(Se);if(Ye&&Ye[1])ue(de.ai_response.replace(Se,"").trim()),ce(Ye[1].trim());else{const ut=de.ai_response.trim();if(ut.startsWith("{")&&ut.endsWith("}"))try{JSON.parse(ut),ue(""),ce(ut)}catch{ue(ut),ce(null)}else if(ut.startsWith("[")&&ut.endsWith("]"))try{JSON.parse(ut),ue(""),ce(ut)}catch{ue(ut),ce(null)}else ue(ut),ce(null)}}else ue(""),ce(null)}catch{b(null),E(""),ue(""),ce(null)}},Kh=async(ee,he)=>{b(de=>de?{...de,insurance_type:he}:null);try{const de=await pe(`/api/patients/${ee}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:he})});if(!de.ok){const Se=await de.json();throw new Error(Se.message||"Failed to update insurance type")}}catch(de){console.error("Error updating insurance type:",de),ee&&Ha(ee)}},Kd=async ee=>{ke(!0),Q(null),qe([]);try{const he=await pe(`/api/queue/patient/${ee}/complaints`);if(!he.ok){const Se=await he.json().catch(()=>({}));throw new Error(Se.message||`HTTP error! status: ${he.status}`)}const de=await he.json();qe(de||[])}catch(he){Q(`Past complaints error: ${he.message}`)}finally{ke(!1)}},uo=async ee=>{rn([]);try{const he=await pe(`/api/pharmacy-orders/patient/${ee}`);if(!he.ok){const Se=await he.json().catch(()=>({}));throw new Error(Se.message||`HTTP error! status: ${he.status}`)}const de=await he.json();rn(de||[])}catch{}},vs=async ee=>{tl(!0),nl(null),Gi([]);try{const he=await pe(`/api/lab/orders/patient/${ee}`);if(!he.ok){const Se=await he.json().catch(()=>({}));throw new Error(Se.message||`HTTP error! status: ${he.status}`)}const de=await he.json();Gi(de||[])}catch(he){nl(`Pending labs error: ${he.message}`)}finally{tl(!1)}},Ga=async ee=>{lt(!0),st(null),Fe([]);try{const he=await pe(`/api/lab/patient/${ee}`);if(!he.ok){const Se=await he.json().catch(()=>({}));throw new Error(Se.message||`HTTP error! status: ${he.status}`)}const de=await he.json();Fe(de||[])}catch(he){st(`Lab reports error: ${he.message}`)}finally{lt(!1)}},fo=async ee=>{try{const he=await pe(`/api/patients/${ee}/context`);if(!he.ok){console.error("Failed to fetch patient context");return}const de=await he.json();if(b(de.patient),S(de.patient.age),T(de.patient.gender),E(de.patient.ai_response||""),de.patient.ai_response){const Se=/```json\s*([\s\S]*?)\s*```/,Ye=de.patient.ai_response.match(Se);if(Ye&&Ye[1])ue(de.patient.ai_response.replace(Se,"").trim()),ce(Ye[1].trim());else{const ut=de.patient.ai_response.trim();if(ut.startsWith("{")&&ut.endsWith("}"))try{JSON.parse(ut),ue(""),ce(ut)}catch{ue(ut),ce(null)}else if(ut.startsWith("[")&&ut.endsWith("]"))try{JSON.parse(ut),ue(""),ce(ut)}catch{ue(ut),ce(null)}else ue(ut),ce(null)}}else ue(""),ce(null);if(Yi(de.patient.current_status==="In Doctor Queue"||de.patient.current_status==="In Consultation"),qe(Array.isArray(de.history)?de.history:[]),rn(Array.isArray(de.pharmacyOrders)?de.pharmacyOrders:[]),Array.isArray(de.labOrders)){const Se=de.labOrders,Ye=Se.filter(Ct=>!Ct.report);Gi(Ye);const ut=Se.filter(Ct=>Ct.report).map(Ct=>({...Ct.report,id:Ct.id,patient_id:Ct.patient_id,createdAt:Ct.createdAt}));Fe(ut)}else Gi([]),Fe([])}catch(he){console.error("Error fetching patient context:",he)}},ml=async ee=>{try{const he=await pe(`/api/queue/patient/${ee}/latest`);if(!he.ok){const Se=await he.json().catch(()=>({}));throw new Error(Se.message||`Failed to fetch queue status: ${he.status}`)}const de=await he.json();if(de){const Se=new Date(de.createdAt),Ye=new Date,ut=Se.getDate()===Ye.getDate()&&Se.getMonth()===Ye.getMonth()&&Se.getFullYear()===Ye.getFullYear(),Ct=["waiting","consulting"].includes(de.status);Yi(ut&&Ct)}else Yi(!1)}catch(he){console.error("Error checking patient queue status:",he),Yi(!1)}},ws=async(ee,he)=>{try{if(!(await pe(`/api/pharmacy-orders/${ee}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:he})})).ok)throw new Error("Failed to update pharmacy order date");u&&uo(u)}catch(de){console.error("Error updating pharmacy order date:",de),re("Failed to update pharmacy order date")}},gl=async(ee,he,de)=>{try{const Se={};if(he==="order"?Se.date=de:he==="report"&&(Se.reportDate=de),!(await pe(`/api/lab/orders/${ee}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Se)})).ok)throw new Error("Failed to update lab date");u&&(vs(u),Ga(u))}catch(Se){console.error("Error updating lab order date:",Se),re("Failed to update lab order date")}},yl=ee=>{a(`/dashboard/edit-pharmacy-order/${ee}`)},bc=ee=>{re(null),console.log(`Preparing billing navigation for order: ${ee}`);const he=Ht.find(de=>de.id===ee);if(he){const de=he.medications.map(Se=>{const Ye=Se.price??0;return(Se.price===void 0||Se.price===null)&&console.warn(`Medication "${Se.name}" in order ${ee} is missing a price. Defaulting to 0.`),{name:Se.name,pack_quantity:Se.pack_quantity,loose_quantity:Se.loose_quantity,price:Ye,pack_price:Se.pack_price,loose_price:Se.loose_price,total_price:Number(Se.total_price)||0,isLoose:Se.isLoose,unit:Se.unit,drug_id:Se.drug_id?String(Se.drug_id):null,tabletsPerDay:Se.tabletsPerDay,numberOfDays:Se.numberOfDays,directions_to_use:Se.directions_to_use,discount_percentage:Se.discount_percentage??0,batch:Se.batch,expiry_date:Se.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:de}),a(`/dashboard/pharmacy-billing/${ee}`,{state:{initialItems:de}})}else console.error(`Order with ID ${ee} not found.`),re(`Order with ID ${ee} not found.`),alert(`Error: Could not find order ${ee} to bill.`)},wu=async(ee,he)=>{re(null);const de=Ht.find(Ye=>Ye.id===ee);if(!de){re(`Order with ID ${ee} not found.`);return}const Se={status:he,medications:de.medications};try{const Ye=await pe(`/api/pharmacy-orders/${ee}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Se)});if(!Ye.ok){const Ct=await Ye.text();throw new Error(`Failed to update status: ${Ye.statusText} (${Ye.status}) - ${Ct}`)}const ut=await Ye.json();rn(Ct=>Ct.map(St=>St.id===ut.id?{...St,status:ut.status}:St)),u&&uo(u)}catch(Ye){console.error("Failed to update order status:",Ye),re(Ye.message||`Failed to update status for order ${ee}.`),alert(`Error updating status for order ${ee}: ${Ye.message||"Please try again."}`)}},Xd=ee=>{Gi(he=>he.map(de=>de.id===ee?{...de,isEditing:!0,editedTests:[...de.tests],editedStatus:de.status}:{...de,isEditing:!1}))},vc=ee=>{Gi(he=>he.map(de=>de.id===ee?{...de,isEditing:!1,editedTests:void 0,editedStatus:void 0}:de))},Ya=(ee,he,de,Se)=>{Gi(Ye=>Ye.map(ut=>{if(ut.id===ee){const Ct=ut.editedTests?[...ut.editedTests]:[...ut.tests];if(de==="add")return{...ut,editedTests:[...Ct,{id:"",name:"",price:0}]};if(de==="remove")return{...ut,editedTests:Se};if(he!==-1){const St={...Ct[he],[de]:Se};return Ct[he]=St,{...ut,editedTests:Ct}}}return ut}))},Xh=(ee,he)=>{Gi(de=>de.map(Se=>Se.id===ee?{...Se,editedStatus:he}:Se))},Zd=async ee=>{if(!ee){console.error("Cannot navigate to billing: Lab Order data is missing."),alert("Could not open billing page: Lab Order information is missing.");return}a(`/dashboard/lab-billing/${ee.id}`)},Zr=async(ee,he)=>{console.log(`Updating lab order ${ee} to status ${he}`);try{const de=await pe(`/api/lab/${ee}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:he})});if(!de.ok){const Se=await de.json();throw new Error(Se.message||`Failed to update lab order status: ${de.status}`)}u&&(vs(u),Ga(u)),console.log(`Lab Order ${ee} status updated to ${he}, refetching data.`)}catch(de){console.error("Error updating lab order status:",de),alert(`Failed to update lab order status: ${de instanceof Error?de.message:"Unknown error"}`)}},xl=ee=>{ee&&ee.id?a(`/lab/report/${ee.id}`):(console.error("Cannot navigate: Lab Order or Lab Order ID is missing."),alert("Could not open the report entry page: Lab Order information is missing."))},ho=async(ee,he,de)=>{za(!0),re(null);try{if(!he||he.length===0)throw new Error("Lab order must have at least one test.");for(const ut of he)if(!ut.id||!ut.name||isNaN(ut.price)||ut.price<0)throw new Error(`Invalid test data: ${JSON.stringify(ut)}. Each test must have id, name, and a valid price.`);const Se={tests:he,status:de},Ye=await pe(`/api/lab/orders/${ee}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Se)});if(!Ye.ok){const ut=await Ye.json().catch(()=>({}));throw new Error(ut.message||`Failed to update lab order: ${Ye.statusText}`)}u&&vs(u),Gi(ut=>ut.map(Ct=>Ct.id===ee?{...Ct,isEditing:!1,editedTests:void 0,editedStatus:void 0}:Ct))}catch(Se){re(`Lab Order Save Error: ${Se.message}`)}finally{za(!1)}},va=async ee=>{if(!window.confirm(`Are you sure you want to delete this ${ee.type.toLowerCase()} record? This action cannot be undone.`))return;$a(!0),nc(null);let de=null,Se;const Ye=ee.type;try{switch(Ye){case"Complaint":if(Se=ee.data.id,!Se)throw new Error("Complaint ID is missing.");de=`/api/patients/complaints/${Se}`;break;case"Lab Order":if(Se=ee.data.id,!Se)throw new Error("Lab Order ID is missing.");de=`/api/lab/orders/${Se}`;break;case"Lab Report":if(Se=ee.data.reportId,!Se)throw new Error("Lab Report ID is missing.");de=`/api/lab/reports/${Se}`;break;case"Pharmacy Order":if(Se=ee.data.id,!Se)throw new Error("Pharmacy Order ID is missing.");de=`/api/pharmacy-orders/${Se}`;break;default:throw new Error(`Deletion not supported for item type: ${Ye}`)}if(!de)throw new Error(`Could not determine delete URL for type: ${Ye}`);const ut=await pe(de,{method:"DELETE"});if(!ut.ok){const Ct=await ut.json().catch(()=>({}));throw new Error(Ct.message||`Failed to delete ${Ye}: ${ut.statusText}`)}u&&(Ye==="Complaint"?Kd(u):Ye==="Lab Order"?(vs(u),Ga(u)):Ye==="Lab Report"?Ga(u):Ye==="Pharmacy Order"&&uo(u))}catch(ut){nc(`Delete Error (${Ye}): ${ut.message}`),rl&&$a(!1)}finally{$a(!1)}},po=async()=>{if(!u)return;if(Ht.filter(he=>he.status==="pending").length<2){alert("You need at least two pending orders to merge.");return}Kr(!0);try{const he=await pe(`/api/pharmacy-orders/patient/${u}/merge-pending`,{method:"POST"});if(!he.ok){const de=await he.json().catch(()=>({}));throw new Error(de.message||"Failed to merge orders")}uo(u)}catch(he){re(`Merge Error: ${he.message}`)}finally{Kr(!1)}},Wa=w.useMemo(()=>{if(!u||!je)return[];const ee=je.map(he=>({date:new Date(he.createdAt),type:"Complaint",data:he,originalDateString:he.createdAt})).filter(he=>!isNaN(he.date.getTime()));return ee.sort((he,de)=>de.date.getTime()-he.date.getTime()),ee},[u,je]),Ii=w.useMemo(()=>{if(!u)return[];const ee=new Map;(ms??[]).forEach(de=>{ee.set(de.id,{...de})}),(Ie??[]).forEach(de=>{if(!ee.has(de.id))ee.set(de.id,{id:de.id,patient_id:de.patient_id,tests:de.tests,status:de.status,createdAt:de.createdAt,report:de});else{const Se=ee.get(de.id);Se&&(Se.report=de,Se.status=de.status)}});let he=Array.from(ee.values());return he.sort((de,Se)=>new Date(de.createdAt).getTime()-new Date(Se.createdAt).getTime()),he=he.map((de,Se)=>({...de,serialNumber:Se+1})),he.map(de=>({date:new Date(de.createdAt),type:"Lab Order",data:de,originalDateString:de.createdAt}))},[u,ms,Ie]),Qi=w.useMemo(()=>{if(!u||!Ht)return[];const ee=Ht.map(he=>({date:new Date(he.date),type:"Pharmacy Order",data:he,originalDateString:he.date})).filter(he=>!isNaN(he.date.getTime()));return ee.sort((he,de)=>de.date.getTime()-he.date.getTime()),ee},[u,Ht]),[Su,wc]=w.useState(null),[wa,Nu]=w.useState([]),[mo,bl]=w.useState(""),Cu=(ee,he)=>{if(!ee||!ee.report_content||!he)return"";try{const de=JSON.parse(ee.report_content||"{}");if(typeof de!="object"||de===null)return`<p class="italic text-gray-500 text-xs">Report content is not structured data.</p><pre>${ee.report_content}</pre>`;let Se="";return he.forEach(Ye=>{de[Ye.id]?(Se+=`<h5 class="font-semibold text-sm mt-2 mb-1">${Ye.name}</h5>`,Se+='<table class="lab-report-print-table"><thead><tr><th>Parameter</th><th>Value</th><th>Normal Range</th></tr></thead><tbody>',Object.entries(de[Ye.id]).map(([ut,Ct])=>{var Br;const St=(Br=Ye.default_parameters)==null?void 0:Br.find(Cs=>Cs.name===ut);let Hn="N/A";St&&St.type==="number"&&(St.lower_limit!=null||St.upper_limit!=null)?(Hn="",St.lower_limit!=null&&(Hn+=` > ${St.lower_limit}`),St.lower_limit!=null&&St.upper_limit!=null&&(Hn+=" - "),St.upper_limit!=null&&(Hn+=` < ${St.upper_limit}`),Hn=Hn.trim()||"N/A"):(St==null?void 0:St.type)==="boolean"?Hn="N/A":St!=null&&St.normal_range&&(Hn=St.normal_range),Se+=`<tr><td>${ut}</td><td>${String(Ct)} ${(St==null?void 0:St.unit)||""}</td><td>${Hn}</td></tr>`}),Se+="</tbody></table>"):Se+=`<p class="italic text-gray-500 text-xs">No parameters reported for ${Ye.name}.</p>`}),Se}catch{return`<p class="italic text-gray-500 text-xs">Error parsing report content.</p><pre>${ee.report_content}</pre>`}};w.useEffect(()=>{const ee=()=>{Ee(window.innerHeight)};return window.addEventListener("resize",ee),ee(),()=>window.removeEventListener("resize",ee)},[]),w.useEffect(()=>{const ee=de=>{if(!bt||!yn.current||!br.current)return;const Se=br.current.getBoundingClientRect(),ut=de.clientX-yn.current.x;let Ct=yn.current.initialWidth+ut;const St=Se.width-vr-10;Ct=Math.max(vr,Ct),Ct=Math.min(Ct,St);const Hn=Ct/Se.width*100;Cn(Hn)},he=()=>{yt(!1),yn.current=null,document.body.style.cursor="",document.body.style.userSelect=""};return bt&&(window.addEventListener("mousemove",ee),window.addEventListener("mouseup",he),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{window.removeEventListener("mousemove",ee),window.removeEventListener("mouseup",he),document.body.style.cursor="",document.body.style.userSelect=""}},[bt]);const Qa=ee=>{if(!br.current)return;ee.preventDefault();const he=br.current.querySelector(".edit-complaint-context-column");he&&(yn.current={x:ee.clientX,initialWidth:he.offsetWidth},yt(!0))},vl=w.useCallback(async()=>{V(!0),re(null);try{const ee=await pe("/api/queue/doctor/new",{method:"POST"});if(!ee.ok){const de=await ee.json().catch(()=>({}));throw new Error(de.message||`Failed to create record: ${ee.statusText}`)}const he=await ee.json();if(!he.recordId)throw new Error("New record ID not received from server.");a(`/edit-complaint/${he.recordId}`,{replace:!0})}catch(ee){re(`Failed to create new complaint record: ${ee.message}`)}finally{V(!1)}},[a]);w.useEffect(()=>{(async()=>{Qd(!0);try{const he=await pe("/api/clinics/settings");if(!he.ok){const Se=await he.json().catch(()=>({}));throw new Error(Se.message||"Failed to fetch clinic settings.")}const de=await he.json();mc({admissionCharge:parseFloat(de.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(de.perDayCharge||0).toFixed(2),otherCharges:parseFloat(de.otherCharges||0).toFixed(2),aiMemory:de.aiMemory||"",aiMemoryUpdatedAt:de.aiMemoryUpdatedAt||null,clinicWideSystemPrompt:de.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:de.clinicWideSystemPromptUpdatedAt||null,gemini_api_key:de.gemini_api_key||""}),gc(de.aiMemory||""),co(de.clinicWideSystemPrompt||"")}catch{}finally{Qd(!1)}})()},[]),w.useEffect(()=>{var he;(he=o.state)!=null&&he.initialComplaint&&d(o.state.initialComplaint);const ee=async de=>{te(!0),re(null);try{const Se=await pe(`/api/queue/doctor/complaint/${de}`);if(!Se.ok){const ut=await Se.json().catch(()=>({}));throw new Error(ut.message||`HTTP error! status: ${Se.status}`)}const Ye=await Se.json();p(Ye.patientId),S(Ye.age),T(Ye.gender),M(Ye.case_summary||null),G(Ye.updatedAt||null)}catch{re("Failed to load current complaint details."),p(null),S(void 0),T(void 0),M(null),G(null)}finally{te(!1)}};if(t)ee(t);else if(n){const de=n;de&&(p(de),(async()=>{try{const Ye=await pe(`/api/queue/patient/${de}/latest`);if(Ye.ok){const Ct=await Ye.json();if(Ct!=null&&Ct._id){r(Ct._id),ee(Ct._id);return}}const ut=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:de,complaint:"Visit Initiated"})});if(ut.ok){const Ct=await ut.json();if(Ct!=null&&Ct.id){r(Ct.id),ee(Ct.id);return}}}catch(Ye){console.error("Background queue resolution failed",Ye),re("Failed to initialize visit record.")}})())}else vl()},[t,vl,(go=o.state)==null?void 0:go.initialComplaint,n]),w.useEffect(()=>{u?fo(u):(b(null),qe([]),rn([]),Gi([]),Fe([]),G(null),Yi(!1))},[u]),w.useEffect(()=>{var de;const ee=(de=o.state)==null?void 0:de.initialComplaint;ee&&t&&(!ie&&!Be&&!Fa&&!rt&&!el)&&!Qe.current&&l===ee&&(Qe.current=!0,Ss(),a(o.pathname,{replace:!0,state:{}}))},[(yo=o.state)==null?void 0:yo.initialComplaint,t,l,ie,Be,Fa,rt,el,a]);const Zh=()=>{$(P||""),U(!0),R(null)},ep=()=>{U(!1),$(""),R(null)},ei=async()=>{if(!t){R("Missing Record ID.");return}F(!0),R(null);try{const ee=await pe(`/api/queue/doctor/complaint/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:L.trim()})});if(!ee.ok){const de=await ee.json().catch(()=>({}));throw new Error(de.message||`Failed to save case summary: ${ee.statusText}`)}const he=await ee.json();M(he.case_summary||L.trim()),G(he.updatedAt||null),U(!1)}catch(ee){R(`Save Error: ${ee.message}`)}finally{F(!1)}};w.useEffect(()=>{(async()=>{Qs(!0),hs(null);try{const[he,de]=await Promise.all([pe("/api/drugs"),pe("/api/lab-tests")]);if(!he.ok)throw new Error(`Pharmacy inventory error! status: ${he.status}`);const Se=await he.json();if(xu(Se||[]),!de.ok)throw new Error(`Lab inventory error! status: ${de.status}`);const Ye=await de.json();Qh(Ye||[])}catch(he){hs(he.message)}finally{Qs(!1)}})()},[]);const Ji=async()=>{if(!wn)return;if(pl===wn.aiMemory&&lo===wn.clinicWideSystemPrompt){Xr(!1);return}const ee=pl!==wn.aiMemory,he=lo!==wn.clinicWideSystemPrompt;ee&&Jd(!0),he&&xc(!0);try{const de={...wn};ee&&(de.aiMemory=pl),he&&(de.clinicWideSystemPrompt=lo);const Se=await pe("/api/clinics/settings",{method:"PUT",body:JSON.stringify(de)});if(!Se.ok){const ut=await Se.json().catch(()=>({}));throw new Error(ut.message||"Failed to update clinic settings.")}const Ye=await Se.json();mc({admissionCharge:parseFloat(Ye.settings.admissionCharge).toFixed(2),perDayCharge:parseFloat(Ye.settings.perDayCharge).toFixed(2),otherCharges:parseFloat(Ye.settings.otherCharges).toFixed(2),aiMemory:Ye.settings.aiMemory||"",aiMemoryUpdatedAt:Ye.settings.aiMemoryUpdatedAt||(wn==null?void 0:wn.aiMemoryUpdatedAt)||null,clinicWideSystemPrompt:Ye.settings.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:Ye.settings.clinicWideSystemPromptUpdatedAt||(wn==null?void 0:wn.clinicWideSystemPromptUpdatedAt)||null}),ee&&gc(Ye.settings.aiMemory||""),he&&(co(Ye.settings.clinicWideSystemPrompt||""),Xr(!1))}catch{}finally{ee&&Jd(!1),he&&xc(!1)}},ci=()=>{wn&&(co(wn.clinicWideSystemPrompt||""),Xr(!0))},ju=()=>{Xr(!1),wn&&co(wn.clinicWideSystemPrompt||"")},Ss=async ee=>{const he=ee??l;he.trim()&&(xa.current&&(clearTimeout(xa.current),xa.current=null),Wd({role:"user",content:he}),bs.current&&(await bs.current.callGenerativeApi(he),xa.current=setTimeout(()=>{so([])},1e4)))},ef=ee=>{navigator.clipboard.writeText(ee).then(()=>{}).catch(he=>{console.error("Failed to copy text: ",he)})},wl=(ee,he)=>{const de=window.open("","_blank");de&&(de.document.write(`
        <html>
          <head>
            <title>${he}</title>
            <style>
              body { font-family: sans-serif; margin: 20px; }
              h2 { text-align: center; margin-bottom: 20px; }
              table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
              th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
              th { background-color: #f2f2f2; }
              pre { white-space: pre-wrap; word-wrap: break-word; }
              .ai-context-section { margin-bottom: 20px; border: 1px solid #eee; padding: 15px; border-radius: 5px; }
              .ai-context-section-title { font-size: 1.1em; font-weight: bold; margin-bottom: 10px; color: #333; }
              .ai-context-text { margin-bottom: 5px; }
              .text-gray-400 { color: #999; }
              .font-semibold { font-weight: 600; }
              .italic { font-style: italic; }
              .mt-2 { margin-top: 8px; }
              .ml-1 { margin-left: 4px; }
              .ml-2 { margin-left: 8px; }
              .flex { display: flex; }
              .flex-col { flex-direction: column; }
              .w-full { width: 100%; }
              .text-xs { font-size: 0.75rem; }
              .text-sm { font-size: 0.875rem; }
              .prose { max-width: 65ch; }
              .prose table { display: table; } /* Ensure tables in markdown render correctly */
            </style>
          </head>
          <body>
            <h2>${he}</h2>
            <div id="print-content">${ee}</div>
          </body>
        </html>
      `),de.document.close(),de.print())},tp=()=>{if(oe){const ee=mX().use(Bs).use(kee).processSync(le).toString();wl(`<div class="prose">${ee}</div>`,"AI Response")}};w.useEffect(()=>{if(g){let ee=`
        <div class="print-section">
          <h3>Patient Details</h3>
          <p><strong>Name:</strong> ${g.name||"N/A"}</p>
          <p><strong>Token:</strong> ${g.patient_token_number||"N/A"}</p>
          <p><strong>Age:</strong> ${g.age||"N/A"}</p>
          <p><strong>Gender:</strong> ${g.gender||"N/A"}</p>
          <p><strong>Phone:</strong> ${g.phone||"N/A"}</p>
          <p><strong>Insurance:</strong> ${g.insurance_type||"N/A"}</p>
          <p><strong>Status:</strong> ${g.current_status||"N/A"}</p>
          <p><strong>Admitted:</strong> ${g.admission_date?new Date(g.admission_date).toLocaleDateString():"N/A"}</p>
          <p><strong>Discharged:</strong> ${g.discharge_date?new Date(g.discharge_date).toLocaleDateString():"N/A"}</p>
        </div>
        <div class="print-section">
          <h3>Case Summary</h3>
          <p>${P||"No summary available."}</p>
        </div>
        <div class="print-section">
          <h3>Complaints History</h3>
          ${Wa.length>0?`
            <ul>
              ${Wa.map(he=>`<li>${new Date(he.originalDateString).toLocaleDateString()}: ${he.data.complaint}</li>`).join("")}
            </ul>
          `:"<p>No past complaints.</p>"}
        </div>
        <div class="print-section">
          <h3>Pharmacy Orders</h3>
          ${Qi.length>0?`
            <table class="print-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Status</th>
                  <th>Drug Name</th>
                  <th>Quantity</th>
                  <th>Dosage</th>
                  <th>Directions</th>
                </tr>
              </thead>
              <tbody>
                ${Qi.map(he=>he.data.medications.map((de,Se)=>`
                    <tr>
                      ${Se===0?`<td rowspan="${he.data.medications.length}">${new Date(he.originalDateString).toLocaleDateString()}</td>`:""}
                      ${Se===0?`<td rowspan="${he.data.medications.length}">${he.data.status}</td>`:""}
                      <td><strong>${de.name}</strong></td>
                      <td>
                        ${de.pack_quantity!==void 0&&de.pack_quantity>0?`Packs: ${de.pack_quantity}`:""}
                        ${de.pack_quantity!==void 0&&de.pack_quantity>0&&de.loose_quantity!==void 0&&de.loose_quantity>0?", ":""}
                        ${de.loose_quantity!==void 0&&de.loose_quantity>0?`Loose: ${de.loose_quantity}`:""}
                      </td>
                      <td>${de.tabletsPerDay&&de.numberOfDays?`${de.tabletsPerDay} tab/day for ${de.numberOfDays} days`:"N/A"}</td>
                      <td>${de.directions_to_use||"N/A"}</td>
                    </tr>
                  `).join("")).join("")}
              </tbody>
            </table>
          `:"<p>No pharmacy orders.</p>"}
        </div>
        <div class="print-section">
          <h3>Lab History (Orders & Reports)</h3>
          ${Ii.length>0?`
            ${Ii.map(he=>{const de=he.data.tests.map(Ye=>Ye.name).join(", ");let Se="";return he.data.report&&(Se=`
                  <div class="lab-report-print-container">
                    <h4>Lab Report (${new Date(he.data.report.report_date).toLocaleDateString()})</h4>
                    ${Cu(he.data.report,he.data.report.tests)}
                  </div>
                `),`
                <div class="lab-history-item">
                  <p><strong>Order Date:</strong> ${new Date(he.originalDateString).toLocaleDateString()}</p>
                  <p><strong>Status:</strong> ${he.data.status}</p>
                  <p><strong>Tests:</strong> ${de}</p>
                  ${Se}
                </div>
              `}).join("")}
          `:"<p>No lab history.</p>"}
        </div>
      `;bl(ee)}else bl("")},[g,P,Wa,Qi,Ii,Cu]);const Ja=()=>{mo&&wl(mo,`Patient Details - ${g==null?void 0:g.name}`)},Ka=ee=>{d(ee),wc(null),Nu([]),setTimeout(()=>{Ss(ee)},0)},_e=ie||fe||Me||rt||Be||el||Fa||W||Js||Xs||Vd||ps||ec||eo||Jr||wr||ba||hl||rl||sc||to||gs||al||z,Ge=_e,Ue=()=>{d("reports came,please anaylse"),setTimeout(()=>{Ss()},0)},ft=ee=>{vu(he=>({...he,[ee]:!he[ee]}))},At=ee=>{ee.key==="Enter"&&!ee.shiftKey&&(ee.preventDefault(),!_e&&l.trim()&&t&&Ss())};w.useEffect(()=>{const ee=window.SpeechRecognition||window.webkitSpeechRecognition;if(!ee){ya("Speech recognition not supported in this browser.");return}const he=new ee;return he.continuous=!0,he.interimResults=!0,he.lang="en-US",he.onresult=de=>{let Se="";for(let Ye=de.resultIndex;Ye<de.results.length;++Ye)de.results[Ye].isFinal&&(Se+=de.results[Ye][0].transcript);Se&&d(Ye=>Ye+(Ye.endsWith(" ")||Ye===""?"":" ")+Se)},he.onerror=de=>{ya(`Speech error: ${de.error}`),kn(!1)},he.onend=()=>{},dl.current=he,()=>{dl.current&&dl.current.stop()}},[]);const un=async()=>{if(u)if(no){oc(!0);try{const ee=await pe(`/api/patients/${u}/discharge`,{method:"POST"});if(!ee.ok){const he=await ee.json().catch(()=>({}));throw new Error(he.message||`Failed to discharge patient: ${ee.status}`)}Ha(u)}catch(ee){re(`Discharge Error: ${ee.message}`)}finally{oc(!1)}}else{Qr(!0);try{const ee=await pe(`/api/patients/${u}/admit`,{method:"POST"});if(!ee.ok){const he=await ee.json().catch(()=>({}));throw new Error(he.message||`Failed to admit patient: ${ee.status}`)}Ha(u)}catch(ee){re(`Admit Error: ${ee.message}`)}finally{Qr(!1)}}},lr=async ee=>{if(u){ys(!0);try{const de=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:u})});if(!de.ok){const Se=await de.json().catch(()=>({}));throw new Error(Se.message||`Failed to add patient to ${ee} queue: ${de.status}`)}alert(`Patient added to ${ee} queue successfully!`),u&&(Ha(u),ml(u))}catch(he){re(`Add to Queue Error: ${he.message}`)}finally{ys(!1)}}},dn=async()=>{if(t){sl(!0),re(null);try{const ee=await pe(`/api/queue/${t}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"seen"})});if(!ee.ok){const he=await ee.json().catch(()=>({}));throw new Error(he.message||"Failed to complete consultation")}alert("Consultation completed successfully!"),u&&(Ha(u),ml(u))}catch(ee){re(`Error completing consultation: ${ee.message}`)}finally{sl(!1)}}},Sc=async()=>{if(!u){Di("Missing Patient ID.");return}if(!g){Di("Patient details not loaded.");return}Pi(!0),Di(null);try{const ee={};let he=!1;if(xs!==g.name&&(ee.name=xs,he=!0),ol!==g.age&&(ee.age=ol,he=!0),Ba!==g.gender&&(ee.gender=Ba,he=!0),cl!==g.phone&&(ee.phone=cl,he=!0),!he){Di("No changes detected."),Pi(!1),ro(!1);return}const de=await pe(`/api/patients/${u}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ee)});if(!de.ok){const Ye=await de.json().catch(()=>({}));throw new Error(Ye.message||`Failed to update patient details: ${de.statusText}`)}const Se=await de.json();b(Se),S(Se.age),T(Se.gender),io(Se.name),Ua(Se.age),ll(Se.gender),uc(Se.phone),ro(!1)}catch(ee){Di(`Save Error: ${ee.message}`)}finally{Pi(!1)}},tf=w.useCallback(()=>{if(!g)return null;const ee={token_number:g.patient_token_number||"N/A",name:g.name||"N/A",age:g.age||"N/A",gender:g.gender||"N/A",phone:g.phone||"N/A"};return Wa.length>0?ee.complaints_history=Wa.map(he=>`${he.data.complaint} (${new Date(he.originalDateString).toLocaleDateString()})`).join("; "):ee.complaints_history="No past complaints.",Qi.length>0?ee.pharmacy_orders_history=Qi.map(he=>`Order: ${he.data.medications.map(Se=>{let Ye=`${Se.name}`;return Se.pack_quantity!==void 0&&Se.pack_quantity>0&&(Ye+=` Packs: ${Se.pack_quantity}`),Se.loose_quantity!==void 0&&Se.loose_quantity>0&&(Ye+=` Loose: ${Se.loose_quantity}`),Ye}).join(", ")} (${he.data.status}, ${new Date(he.originalDateString).toLocaleDateString()})`).join("; "):ee.pharmacy_orders_history="No pharmacy orders.",Ii.length>0?ee.lab_orders_history=Ii.map(he=>{let Se=`Lab Order: ${he.data.tests.map(Ye=>Ye.name).join(", ")} (${he.data.status}, ${new Date(he.originalDateString).toLocaleDateString()})`;return he.data.report&&(Se+=` - Report: ${he.data.report.report_content} (${new Date(he.data.report.report_date).toLocaleDateString()})`),Se}).join("; "):ee.lab_orders_history="No lab history.",ee},[g,Wa,Qi,Ii]),ti=()=>{if(!g){ya("Patient details are required to use the Live API.");return}pc(!0)},Nc=()=>{var ee;(ee=qn.current)==null||ee.click()},np=ee=>{var de;const he=(de=ee.target.files)==null?void 0:de[0];he&&hc(he)},Ns=ee=>{Hi(ee),ee==="context"&&Ot.current?Ot.current.scrollIntoView({behavior:"smooth",block:"start"}):ee==="response"&&vt.current&&vt.current.scrollIntoView({behavior:"smooth",block:"start"})};return w.useEffect(()=>{const ee=new IntersectionObserver(he=>{he.forEach(de=>{de.isIntersecting&&(de.target===vt.current?Hi("response"):de.target===Ot.current&&Hi("context"))})},{root:null,threshold:.5});return vt.current&&ee.observe(vt.current),Ot.current&&ee.observe(Ot.current),()=>{vt.current&&ee.unobserve(vt.current),Ot.current&&ee.unobserve(Ot.current)}},[]),i.jsxs("div",{className:"edit-complaint-page",style:{height:`${Z}px`},children:[i.jsx(RW,{ref:bs,recordId:t,patientId:u,patientDetails:g,caseSummary:P,caseSummaryUpdatedAt:B,clinicSettings:wn,userMessages:f,selectedImageFile:oo,pendingLabOrders:ms,labReports:Ie,pastComplaints:je,pharmacyOrders:Ht,pharmacyInventory:Ti,labInventory:bu,currentComplaint:l,setCurrentComplaint:d,setAiResponse:E,setAiResponseText:ue,setAiResponseJsonString:ce,setShowAiJsonDetails:X,setIsLoadingAi:ae,setAiError:()=>{},setIsSubmittingAiOrder:Ks,setAiOrderSubmissionStatus:()=>{},setIsSubmittingAiLabOrder:mr,setAiLabOrderSubmissionStatus:()=>{},setIsSubmittingAiComplaint:Hd,setAiComplaintSubmissionStatus:()=>{},setIsUpdatingCaseSummary:Zs,setAiCaseSummaryUpdateStatus:()=>{},setCaseSummary:M,setCaseSummaryUpdatedAt:G,setIsUpdatingAiMemoryByAI:Gd,setAiMemoryUpdateByAIStatus:()=>{},setFollowUpQuestion:wc,setFollowUpOptions:Nu,setError:re,setIsSavingAiResponse:Ke,setSaveAiResponseError:()=>{},fetchPharmacyOrdersData:uo,fetchPendingLabOrdersData:vs,fetchLabReportsData:Ga,fetchPastComplaintsData:Kd,fetchPatientDetails:Ha,setClinicSettings:mc,setEditedAiMemory:gc,handleDeleteItem:va,setCanUndo:Wi,onAiActionSuccess:cn,addMessage:Wd}),Va&&g&&i.jsx(Yk,{onClose:()=>pc(!1),patientData:tf(),tokenNumber:g.patient_token_number?String(g.patient_token_number):null,onAiSummaryChange:ee=>{ee&&(d(ee),Ss(ee),pc(!1))}}),i.jsxs("div",{className:"edit-complaint-header",children:[i.jsx("button",{onClick:()=>a(-1),disabled:_e,className:"back-button",title:"Go Back",children:"< Back"}),i.jsx("span",{ref:kt,style:{position:"absolute",visibility:"hidden",height:"auto",width:"auto",whiteSpace:"nowrap"}}),g&&i.jsx("div",{className:"edit-complaint-patient-details",children:g&&!lc?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>{ro(!0),io(g.name||""),Ua(g.age),ll(g.gender),uc(g.phone),Di(null)},className:"edit-button mr-2",title:"Edit Patient Details",disabled:Jr,children:i.jsx(Vl,{size:14})}),g.name??"N/A",g.patient_token_number!==null&&g.patient_token_number!==void 0&&` (${g.patient_token_number})`," - ",g.age??"N/A"," / ",g.gender??"N/A",g.phone&&` / ${g.phone}`,i.jsx("button",{onClick:ee=>{ee.stopPropagation(),Ja()},disabled:!mo,title:"Print Patient Details",className:"icon-button small ml-2 text-gray-600 hover:text-gray-900",children:i.jsx(Go,{size:14})})]}):g&&lc?i.jsxs("div",{className:"patient-details-edit-form",children:[i.jsx("input",{type:"text",value:xs,onChange:ee=>io(ee.target.value),placeholder:"Name",className:"edit-input",disabled:Jr}),i.jsx("input",{type:"number",value:ol??"",onChange:ee=>Ua(ee.target.value?parseInt(ee.target.value):null),placeholder:"Age",className:"edit-input",disabled:Jr}),i.jsxs("select",{value:Ba??"",onChange:ee=>ll(ee.target.value||null),className:"edit-input",disabled:Jr,children:[i.jsx("option",{value:"",children:"Select Gender"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]}),i.jsx("input",{type:"text",value:cl??"",onChange:ee=>uc(ee.target.value||null),placeholder:"Phone Number",className:"edit-input",disabled:Jr}),i.jsxs("div",{className:"edit-actions",children:[i.jsx("button",{onClick:()=>{ro(!1),Di(null)},className:"button-secondary",disabled:Jr,children:"Cancel"}),i.jsx("button",{onClick:Sc,className:"button-primary blue",disabled:Jr,children:Jr?"Saving...":"Save"})]}),ao&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:ao})]}):i.jsxs("div",{className:"edit-complaint-patient-details",children:[v??"N/A"," / ",k??"N/A",i.jsx("button",{onClick:ee=>{ee.stopPropagation(),Ja()},disabled:!mo,title:"Print Patient Details",className:"icon-button small ml-2 text-gray-600 hover:text-gray-900",children:i.jsx(Go,{size:14})})]})}),!g&&v!==void 0&&k!==void 0&&i.jsxs("div",{className:"edit-complaint-patient-details",children:[v??"N/A"," / ",k??"N/A",i.jsx("button",{onClick:ee=>{ee.stopPropagation(),Ja()},disabled:!mo,title:"Print Patient Details",className:"icon-button small ml-2 text-gray-600 hover:text-gray-900",children:i.jsx(Go,{size:14})})]}),i.jsx("div",{style:{width:"64px"}})]}),i.jsxs("div",{className:"edit-complaint-content-area",ref:br,children:[fl.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"edit-complaint-chat-column",style:{width:"30%",minWidth:"320px",maxWidth:"40%",flexShrink:0},children:i.jsx(Eee,{messages:fl})}),i.jsx("div",{className:"draggable-divider",onMouseDown:()=>{}})]}),i.jsxs("div",{ref:vt,className:"edit-complaint-main-column",style:{flex:1,minWidth:0},children:[se&&i.jsxs("div",{className:"general-error-message",children:["Error: ",se]}),(le||D)&&i.jsxs("div",{ref:me,className:`${D?"ai-function-call-block":"ai-response-container"} group`,children:[le&&i.jsx(Yo,{remarkPlugins:[Bs],children:le}),D&&i.jsxs("div",{className:"ai-json-details-container",children:[i.jsxs("button",{onClick:()=>X(!ve),className:"ai-json-toggle-button",children:[ve?i.jsx(MS,{size:14,className:"mr-1"}):i.jsx(RS,{size:14,className:"mr-1"}),ve?"Hide":"Show"," AI Function Call Details"]}),ve&&i.jsx("pre",{className:"ai-json-pre",children:i.jsx("code",{children:JSON.stringify(JSON.parse(D),null,2)})})]}),i.jsxs("div",{className:"ai-response-actions",children:[i.jsx("button",{onClick:()=>ef(oe),disabled:!oe,title:"Copy Full AI Response",children:i.jsx(LI,{size:12})}),i.jsx("button",{onClick:tp,disabled:!oe,title:"Print AI Response",children:i.jsx(Go,{size:12})})]})]})]}),i.jsx("div",{className:"draggable-divider",onMouseDown:Qa}),i.jsx("div",{ref:Ot,className:"edit-complaint-context-column",style:{flexBasis:`calc(${100-gn}% - 5px)`},children:i.jsxs("div",{className:"ai-context-container",children:[i.jsxs("h3",{className:"ai-context-header",children:[i.jsx("span",{children:"AI Context:"}),(g==null?void 0:g.insurance_type)&&i.jsx("div",{className:"insurance-type-container mt-2",children:i.jsxs("select",{ref:ot,value:g.insurance_type,onChange:ee=>Kh(g.id,ee.target.value),className:"insurance-type-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"insurance",children:"Insurance"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})})]}),i.jsxs("div",{ref:qt,className:"ai-context-section",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Admission Status"}),(g==null?void 0:g.admission_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Admitted:"})," ",new Date(g.admission_date).toLocaleDateString()]}),(g==null?void 0:g.discharge_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Discharged:"})," ",new Date(g.discharge_date).toLocaleDateString()]}),(g==null?void 0:g.current_status)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Current Status:"})," ",i.jsx("span",{className:"font-semibold",children:g.current_status})]}),i.jsxs("div",{className:"flex space-x-2 mt-2",children:[i.jsx("button",{onClick:un,className:`admit-discharge-button ${no?"discharge":"admit"}`,title:no?"Discharge Patient":"Admit Patient",disabled:!u||sc||to,children:sc?"Admitting...":to?"Discharging...":no?"Discharge":"Admit"}),i.jsx("button",{onClick:()=>lr("doctor"),className:`queue-status-button ${Ai?"in-queue":"add-to-queue"}`,title:Ai?"Patient is in Doctor Queue":"Add Patient to Doctor Queue",disabled:!u||gs||Ai,children:gs?"Adding...":Ai?"In Queue":"Add to Queue"}),i.jsx("button",{onClick:dn,className:"complete-consultation-button",title:"Mark Consultation as Complete",disabled:al,children:al?"Completing...":"Complete Consultation"})]})]}),i.jsx("div",{ref:be,children:i.jsx(A0,{title:"Pharmacy Order History",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:po,className:"button-primary blue text-xs px-2 py-1",disabled:hl||Ht.filter(ee=>ee.status==="pending").length<2,title:"Merge all pending orders into one",children:hl?"Merging...":"Merge Orders"}),i.jsxs("button",{onClick:()=>il(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new pharmacy order",disabled:!u,children:[i.jsx(Ql,{size:12,className:"mr-1"})," Create Order"]})]}),items:Qi,isLoading:!1,loadingText:"Loading...",noDataText:"No orders.",renderItemContent:(ee,he)=>i.jsxs("div",{className:"flex flex-col w-full",children:[i.jsxs("span",{className:"ai-context-text flex items-center",children:[" ",Qi.length-he,". Order Status: (",ee.data.status,")",i.jsx("span",{className:"text-gray-400 ml-1 flex items-center",children:Yd===ee.data.id?i.jsx("div",{className:"flex items-center space-x-1 ml-1",children:i.jsx("input",{type:"datetime-local",defaultValue:H0(ee.originalDateString),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:de=>{de.target.value&&ws(ee.data.id,de.target.value),cc(null)},onKeyDown:de=>{if(de.key==="Enter"){const Se=de.target;Se.value&&ws(ee.data.id,Se.value),cc(null)}},autoFocus:!0})}):i.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/date ml-1",onClick:()=>cc(ee.data.id),title:"Click to edit date",children:["(",new Date(ee.originalDateString).toLocaleDateString(),")",i.jsx(Vl,{size:14,className:"ml-1 text-gray-500 hover:text-gray-700"})]})}),i.jsxs("div",{className:"inline-flex space-x-2 ml-2",children:[" ",i.jsx("button",{onClick:()=>yl(ee.data.id),className:"icon-button small",title:"Edit Pharmacy Order",children:i.jsx(Vl,{size:12})}),ee.data.prescriptionForUnavailableDrugs&&i.jsx("button",{onClick:()=>wl(ee.data.prescriptionForUnavailableDrugs,"Unavailable Drugs Prescription"),className:"icon-button small",title:"Print Unavailable Drugs Prescription",children:i.jsx(Go,{size:12})}),i.jsx("button",{onClick:()=>va({type:"Pharmacy Order",data:ee.data}),className:"icon-button small text-red-500",title:"Delete Pharmacy Order",children:i.jsx(li,{size:12})}),ee.data.status==="pending"&&i.jsx("button",{onClick:()=>bc(ee.data.id),className:"icon-button small",title:"Bill this pharmacy order",disabled:eo,children:i.jsx(Eh,{size:12})}),ee.data.status==="billed"&&i.jsx("button",{onClick:()=>wu(ee.data.id,"dispensed"),className:"icon-button small",title:"Dispense this pharmacy order",disabled:eo,children:i.jsx(fs,{size:12})})]})]}),i.jsx("div",{className:"pharmacy-order-drugs-table-container mt-2 cursor-pointer hover:bg-gray-50 transition-colors rounded p-1",onClick:()=>yl(ee.data.id),title:"Click to edit order",children:i.jsxs("table",{className:"pharmacy-order-drugs-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2 text-left",children:"Drug Name"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Quantity"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Dosage"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Directions"})]})}),i.jsx("tbody",{children:ee.data.medications.map((de,Se)=>i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:i.jsx("strong",{children:de.name})}),i.jsxs("td",{className:"py-1 px-2",children:[de.pack_quantity!==void 0&&de.pack_quantity>0&&`Packs: ${de.pack_quantity}`,de.pack_quantity!==void 0&&de.pack_quantity>0&&de.loose_quantity!==void 0&&de.loose_quantity>0&&", ",de.loose_quantity!==void 0&&de.loose_quantity>0&&`Loose: ${de.loose_quantity}`]}),i.jsx("td",{className:"py-1 px-2",children:de.tabletsPerDay&&de.numberOfDays?`${de.tabletsPerDay} tab/day for ${de.numberOfDays} days`:"N/A"}),i.jsx("td",{className:"py-1 px-2",children:de.directions_to_use||"N/A"})]},de.drug_id||de.name||Se))})]})}),ee.data.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[i.jsx("span",{className:"font-semibold",children:"Prescription:"})," ",ee.data.prescriptionForUnavailableDrugs]})]})})}),ac&&i.jsx(Tee,{isOpen:ac,onClose:()=>il(!1),patientId:u,pharmacyInventory:Ti,fetchPharmacyOrdersData:uo}),i.jsxs("div",{ref:ge,children:[i.jsx(A0,{title:"Lab History (Orders & Reports)",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:Ue,className:"button-primary blue text-xs px-2 py-1",title:"Tell AI to analyse the reports",disabled:Ge,children:"Analyse Reports"}),i.jsxs("button",{onClick:()=>ic(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new lab order",disabled:!u,children:[i.jsx(Ql,{size:12,className:"mr-1"})," Create Lab Order"]})]}),items:Ii,onDeleteItem:va,onEditLabOrder:Xd,onSaveLabOrder:ho,onCancelEditLabOrder:vc,onLabOrderTestChange:Ya,onLabOrderStatusChange:Xh,onBillLabOrder:Zd,onUpdateLabOrderStatus:Zr,onEnterLabReport:xl,labInventory:bu,isSavingLabOrder:eo,isLoading:Fa||rt,loadingText:"Loading...",noDataText:"No lab Hx.",expandedLabReports:rc,toggleLabReport:ft,renderItemContent:(ee,he)=>{const de=eW(ee.data.report?ee.data.report.status:ee.data.status);return i.jsxs("div",{className:"ai-context-text",children:[i.jsxs("div",{onClick:()=>xl(ee.data),className:"cursor-pointer hover:bg-gray-100 rounded p-1 inline-block -ml-1",title:"Click to enter report",children:[ee.data.serialNumber,". ",i.jsx("span",{className:"font-medium",children:"[Order]"})," ",ee.data.tests&&ee.data.tests.length>0?ee.data.tests.map(Se=>i.jsxs("strong",{children:[Se.name," (",Se.price,")"]},Se.id||Se.name)).reduce((Se,Ye)=>[Se,", ",Ye]):i.jsx("span",{className:"italic text-gray-500",children:"No tests specified"})," ",ee.data.tests&&ee.data.tests.length>0&&i.jsxs("span",{className:"font-bold ml-2",children:["Total: ",ee.data.tests.reduce((Se,Ye)=>Se+(Number(Ye.price)||0),0).toFixed(2)]}),"(",i.jsx("span",{className:de.className,children:de.text}),")"]}),i.jsx("span",{className:"text-gray-400 ml-1 inline-flex items-center",children:qa===ee.data.id?i.jsx("div",{className:"flex items-center space-x-1 ml-1",onClick:Se=>Se.stopPropagation(),children:i.jsx("input",{type:"datetime-local",defaultValue:H0(ee.originalDateString),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:Se=>{Se.target.value&&gl(ee.data.id,"order",Se.target.value),ul(null)},onKeyDown:Se=>{if(Se.key==="Enter"){const Ye=Se.target;Ye.value&&gl(ee.data.id,"order",Ye.value),ul(null)}},autoFocus:!0})}):i.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/date ml-1",onClick:Se=>{Se.stopPropagation(),ul(ee.data.id)},title:"Click to edit order date",children:["(",new Date(ee.originalDateString).toLocaleDateString(),")",i.jsx(Vl,{size:14,className:"ml-1 text-gray-500 hover:text-gray-700"})]})}),ee.data.report&&i.jsxs("div",{className:"ml-4 mt-1 p-2 border-l-2 border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-medium",children:"[Report]"}),i.jsx("span",{className:"text-gray-400 ml-1 flex items-center",children:dc===ee.data.id?i.jsx("div",{className:"flex items-center space-x-1 ml-1",onClick:Se=>Se.stopPropagation(),children:i.jsx("input",{type:"datetime-local",defaultValue:H0(ee.data.report.report_date),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:Se=>{Se.target.value&&gl(ee.data.id,"report",Se.target.value),fc(null)},onKeyDown:Se=>{if(Se.key==="Enter"){const Ye=Se.target;Ye.value&&gl(ee.data.id,"report",Ye.value),fc(null)}},autoFocus:!0})}):i.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/reportDate ml-1",onClick:Se=>{Se.stopPropagation(),fc(ee.data.id)},title:"Click to edit report date",children:["(",new Date(ee.data.report.report_date).toLocaleDateString(),")",i.jsx(Vl,{size:14,className:"ml-1 text-gray-500 hover:text-gray-700"})]})}),i.jsx("button",{onClick:()=>ft(ee.data.report.reportId),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:rc[ee.data.report.reportId]?"Collapse Report":"Expand Report",children:rc[ee.data.report.reportId]?i.jsx(MS,{size:14}):i.jsx(RS,{size:14})})]}),rc[ee.data.report.reportId]&&(()=>{try{const Se=JSON.parse(ee.data.report.report_content||"{}");return typeof Se=="object"&&Se!==null&&ee.data.report.tests?ee.data.report.tests.map(Ye=>i.jsxs("div",{style:{marginBottom:"10px"},children:[i.jsx("h5",{className:"font-semibold text-sm mt-2 mb-1",children:Ye.name}),Se[Ye.id]?i.jsxs("table",{className:"lab-inventory-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2",children:"Parameter"}),i.jsx("th",{className:"py-1 px-2",children:"Value"}),i.jsx("th",{className:"py-1 px-2",children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(Se[Ye.id]).map(([ut,Ct])=>{var Hn;const St=(Hn=Ye.default_parameters)==null?void 0:Hn.find(Br=>Br.name===ut);return i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:ut}),i.jsxs("td",{className:"py-1 px-2",children:[String(Ct)," ",(St==null?void 0:St.unit)||""]}),i.jsx("td",{className:"py-1 px-2",children:(()=>{if(St&&St.type==="number"&&(St.lower_limit!=null||St.upper_limit!=null)){let Br="";return St.lower_limit!=null&&(Br+=` > ${St.lower_limit}`),St.lower_limit!=null&&St.upper_limit!=null&&(Br+=" - "),St.upper_limit!=null&&(Br+=` < ${St.upper_limit}`),Br.trim()||"N/A"}else if((St==null?void 0:St.type)==="boolean")return"N/A";return(St==null?void 0:St.normal_range)||"N/A"})()})]},ut)})})]}):i.jsx("p",{className:"italic text-gray-500 text-xs",children:"No parameters reported for this test."})]},Ye.id)):i.jsx(Yo,{remarkPlugins:[Bs],children:ee.data.report.report_content})}catch{return i.jsx(Yo,{remarkPlugins:[Bs],children:ee.data.report.report_content||"*No findings recorded.*"})}})()]})]})}}),i.jsx(kW,{isOpen:Wr,onClose:()=>ic(!1),patientId:u,labInventory:bu,fetchPendingLabOrdersData:vs}),i.jsx("div",{ref:Te,children:i.jsx(A0,{title:"Complaints History",items:Wa,isLoading:Be,loadingText:"Loading...",noDataText:"No past Hx.",renderItemContent:(ee,he)=>i.jsxs("span",{className:"ai-context-text",children:[ee.data.complaint,i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(ee.originalDateString).toLocaleDateString(),")"]})]}),onDeleteItem:va})}),i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("h4",{className:"ai-context-section-title",children:[i.jsx(wb,{size:16,className:"text-purple-600"})," Clinic-wide System Prompt"]}),!yc&&i.jsx("button",{onClick:ci,className:"edit-button",title:"Edit System Prompt",disabled:Ur||wr||ba,children:i.jsx(Vl,{size:14})})]}),yc&&wn?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:lo,onChange:ee=>co(ee.target.value),className:"context-edit-textarea",placeholder:"Enter clinic system prompt...",disabled:wr||ba}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:ju,disabled:wr||ba,className:"button-secondary",children:"Cancel"}),i.jsxs("button",{onClick:Ji,disabled:wr||ba||pl===wn.aiMemory&&lo===wn.clinicWideSystemPrompt,className:"button-primary purple",children:[i.jsx(Od,{size:14,className:"mr-1"}),ba||wr?"Saving...":"Save Settings"]})]})]}):i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:wn!=null&&wn.clinicWideSystemPrompt?i.jsx(Yo,{remarkPlugins:[Bs],children:wn.clinicWideSystemPrompt}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),!yc&&(wn==null?void 0:wn.clinicWideSystemPromptUpdatedAt)&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Prompt Last Updated: ",new Date(wn.clinicWideSystemPromptUpdatedAt).toLocaleDateString()]})]}),i.jsxs("div",{ref:De,className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Case Summary"}),!I&&i.jsx("button",{onClick:Zh,className:"edit-button",title:"Edit Case Summary",disabled:ie||z,children:i.jsx(Vl,{size:14})})]}),I?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:L,onChange:ee=>$(ee.target.value),className:"context-edit-textarea",rows:4,placeholder:"Enter case summary...",disabled:z}),Y&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:Y}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:ep,disabled:z,className:"button-secondary",children:"Cancel"}),i.jsx("button",{onClick:ei,disabled:z||L===P,className:"button-primary blue",children:z?"Saving...":"Save"})]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:P?i.jsx(Yo,{remarkPlugins:[Bs],components:{},children:P}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),B&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Last Edited: ",new Date(B).toLocaleDateString()]})]})]}),Wa.length===0&&Ii.length===0&&Qi.length===0&&!(Be||Fa||rt)&&i.jsx("p",{className:"ai-context-text italic mt-4",children:"No recent history for this patient."}),rl&&i.jsx("p",{className:"text-yellow-600 text-xs mt-2 ai-context-text",children:"Deleting..."}),tc&&i.jsx("p",{className:"text-red-600 text-xs mt-2 ai-context-text",children:tc})]})]})})]}),i.jsxs("div",{className:"edit-complaint-input-area",children:[i.jsx("div",{className:"mobile-section-selector",children:i.jsxs("div",{className:"selector-container",children:[i.jsx("button",{onClick:()=>Ns("response"),className:`selector-button ${Wn==="response"?"active":""}`,children:"AI Response"}),i.jsx("button",{onClick:()=>Ns("context"),className:`selector-button ${Wn==="context"?"active":""}`,children:"AI Context"})]})}),i.jsxs("div",{className:"status-messages-container",children:[ct&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:ct}),we&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:we}),Ei&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Ei}),Zl&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Zl})]}),t&&!W&&i.jsxs(w.Fragment,{children:[Su&&i.jsxs("div",{className:"follow-up-question-container",children:[i.jsx("p",{className:"question-text",children:Su}),wa.length>0&&i.jsx("div",{className:"options-grid",children:wa.map((ee,he)=>i.jsx("button",{onClick:()=>Ka(ee),className:"option-button",children:ee},he))})]}),Fr&&i.jsx("div",{className:"speech-error-display",children:Fr}),oo&&i.jsxs("div",{className:"selected-file-display",children:[i.jsxs("span",{children:["Selected: ",oo.name]}),i.jsx("button",{onClick:()=>{hc(null),qn.current&&(qn.current.value="")},className:"remove-file-button",title:"Remove image",children:""})]}),i.jsx("div",{className:"input-wrapper",children:i.jsxs("div",{className:"main-input-container",children:[i.jsx("input",{type:"file",ref:qn,onChange:np,accept:"image/*",className:"hidden"}),i.jsx("textarea",{ref:Ve,className:"complaint-textarea",value:l,onChange:ee=>d(ee.target.value),onKeyDown:At,placeholder:"name,age,sex,phone,complaints,reports,history",disabled:_e||!t||xn}),i.jsxs("div",{className:"chat-input-actions-container",children:[u&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>a(`/patient/${u}/lab-reports`),disabled:rt||!u,className:"icon-button",title:"View Lab Reports",children:i.jsx(lu,{size:14})}),i.jsx("button",{onClick:()=>a("/inventory"),disabled:el,className:"icon-button",title:"View Inventory",children:i.jsx(Md,{size:14})})]}),i.jsx("button",{type:"button",onClick:Nc,disabled:_e||!t||xn,className:"icon-button",title:"Attach Image",children:i.jsx(gR,{size:14})}),i.jsx("button",{type:"button",onClick:ti,disabled:_e||!t||!dl.current,className:`mic-button ${xn?"listening":""}`,title:xn?"Stop":"Mic",children:i.jsx(a2,{size:14})}),i.jsx("button",{onClick:()=>Ss(),disabled:_e||!l.trim()||!t||xn,className:"send-button",title:_e?"Processing...":"Save & Ask AI",children:_e?i.jsx("div",{className:"custom-loader-circle",role:"status","aria-label":"loading"}):i.jsx(K0,{size:14})}),Vn&&i.jsx("button",{type:"button",onClick:Jh,disabled:_e,className:"icon-button text-red-500",title:"Undo Last AI Actions",children:i.jsx(li,{size:14})})]})]})})]})]})]})},Aee=()=>{const{patientId:e}=Vi(),n=Et(),[t,r]=w.useState([]),[a,o]=w.useState(null),[l,d]=w.useState(!1),[f,u]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){u("Patient ID not provided.");return}d(!0),u(null);try{const b=await pe(`/api/patients/${e}`);if(!b.ok)throw new Error(`Failed to fetch patient details: ${b.status}`);const v=await b.json();o({name:v.name,age:v.age,gender:v.gender});const S=await pe(`/api/patients/${e}/complaints`);if(S.ok){const T=(await S.json()).sort((P,M)=>new Date(M.createdAt).getTime()-new Date(P.createdAt).getTime());r(T)}else if(S.status===404)r([]);else throw new Error(`Failed to fetch complaints: ${S.status}`)}catch(b){console.error("Error fetching past complaints or patient info:",b),u(`Failed to load data. ${b.message}`),r([]),o(null)}finally{d(!1)}})()},[e]);const p=g=>{navigator.clipboard.writeText(g).then(()=>console.log("Complaint copied to clipboard")).catch(b=>console.error("Failed to copy complaint: ",b))};return i.jsxs("div",{className:"container mx-auto p-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-1 px-3 rounded text-sm",children:"< Back"}),i.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-center flex-grow",children:"Past Complaints"}),i.jsx("div",{className:"w-16"})," "]}),a&&i.jsxs("div",{className:"mb-4 p-2 bg-gray-100 rounded text-center text-sm sm:text-base",children:["Patient: ",i.jsx("strong",{children:a.name})," (",a.age??"N/A"," / ",a.gender??"N/A",")"]}),f&&i.jsxs("div",{className:"text-red-500 p-3 mb-4 border border-red-500 rounded bg-red-50 text-sm",children:["Error: ",f]}),l&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading..."}),!l&&t.length===0&&!f&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No past complaints found for this patient."}),!l&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(g=>i.jsxs("div",{className:"p-3 border rounded shadow-sm bg-white group relative",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:new Date(g.createdAt).toLocaleString()}),i.jsx("p",{className:"text-sm whitespace-pre-wrap",children:g.complaint}),i.jsx("button",{onClick:()=>p(g.complaint),className:"absolute top-1 right-1 bg-gray-200 hover:bg-gray-300 text-gray-600 text-xs p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Copy complaint text",children:""})]},g.id))})]})},Px=500,k_="defaultConsultationFee",Pee=({patientId:e,billId:n,queueId:t,onBillCreated:r,onBillUpdated:a,initialItems:o=[],billType:l="other",relatedId:d,initialStatus:f="pending",initialDiscountPercentage:u=0,readOnlyMode:p=!1,doctorId:g,labOrderId:b,patientInsuranceType:v})=>{const[S,k]=w.useState(null),[T,P]=w.useState([]),M=w.useRef([]),[I,U]=w.useState(""),[L,$]=w.useState(""),[z,F]=w.useState(1),[Y,R]=w.useState(u),[B,G]=w.useState("cash"),[ie,te]=w.useState(!1),[W,V]=w.useState(null),[se,re]=w.useState(!1),[oe,E]=w.useState(!1),[le,ue]=w.useState(!1),[D,ce]=w.useState(null),[,ve]=w.useState([]),[X,fe]=w.useState(null),[ae,Me]=w.useState(""),[Ke,Z]=w.useState("cash"),[Ee,Ie]=w.useState(!1),[Fe,rt]=w.useState(Px),[lt,ct]=w.useState(Px.toString()),st=n?"view_pay":"create";w.useEffect(()=>{const ge=localStorage.getItem(k_),Te=ge?parseFloat(ge):Px;isNaN(Te)||(rt(Te),ct(Te.toString()))},[]);const Ht=o.length===0;w.useEffect(()=>{e?(async()=>{te(!0),V(null);try{const Te=await pe(`/api/patients/${e}`);if(!Te.ok){const ze=await Te.json().catch(()=>({}));throw new Error(ze.message||"Failed to fetch patient details")}const De=await Te.json();k(De)}catch(Te){V(`Failed to load patient details: ${Te.message}`),k(null)}finally{te(!1)}})():k(null)},[e]),w.useEffect(()=>{n?(async()=>{ue(!0),V(null),ce(null),ve([]),fe(null);try{const Te=await pe(`/api/bills/${n}`);if(!Te.ok){const ze=await Te.json().catch(()=>({}));throw new Error(ze.message||"Failed to fetch bill details")}const De=await Te.json();if(!De.bill||!De.payments||!De.calculated)throw new Error("Invalid bill details structure.");ce(De.bill),ve(De.payments),fe(De.calculated),R(De.bill.discount_percentage!==void 0&&De.bill.discount_percentage!==null?parseFloat(De.bill.discount_percentage.toString()):0),!S&&De.bill.patient_id&&rn(De.bill.patient_id.toString())}catch(Te){V(`Failed to load bill details: ${Te.message}`),ce(null),ve([]),fe(null)}finally{ue(!1)}})():(ce(null),ve([]),fe(null))},[n]);const rn=async ge=>{te(!0);try{const Te=await pe(`/api/patients/${ge}`);if(!Te.ok)throw new Error("Failed to fetch patient");const De=await Te.json();k(De)}catch(Te){console.error("Error fetching patient details:",Te),k(null)}finally{te(!1)}},je=w.useCallback(async ge=>{E(!0),V(null);const Te=ge.filter(De=>De.drug_id!=null).map(async De=>{try{const ze=await pe(`/api/drugs/${De.drug_id}`);if(!ze.ok)throw new Error(`Drug ${De.drug_id} not found.`);const nt=await ze.json();return{...De,price:nt.price,total:nt.price*De.quantity}}catch{return V(nt=>`${nt?nt+"; ":""}Failed to fetch price for ${De.name}`),De}});try{const De=await Promise.all(Te);P(ze=>{const nt=new Map(De.map(mt=>[mt.id,mt]));return ze.map(mt=>nt.get(mt.id)||mt)})}catch{}finally{E(!1)}},[pe]);w.useEffect(()=>{if(n){P([]),M.current=[];return}JSON.stringify(o)===JSON.stringify(M.current)||(async()=>{let De=[];if(o&&o.length>0)De=o.map((ze,nt)=>({...ze,id:`initial-${nt}-${Date.now()}`})),G(f==="paid"?"cash":v==="no_cash_insurance"?"no_cash_insurance":"cash"),R(u),l==="pharmacy"&&!p&&await je(De);else if(e&&Ht&&l==="consultation"){let ze=Fe;if(g)try{const nt=await pe(`/api/staff/${g}`);if(!nt.ok){const Nt=await nt.json().catch(()=>({}));throw new Error(Nt.message||"Doctor not found or error fetching fee")}const mt=await nt.json();mt.opd_fee!=null&&!isNaN(parseFloat(String(mt.opd_fee)))&&parseFloat(String(mt.opd_fee))>=0&&(ze=parseFloat(String(mt.opd_fee)))}catch(nt){V(mt=>`${mt?mt+"; ":""}Could not fetch doctor's fee, using default. (${nt.message})`)}De=[{id:Date.now(),name:"Consultation Fee",price:ze,quantity:1,total:ze*1,drug_id:null}],G(v==="no_cash_insurance"?"no_cash_insurance":"cash")}else De=[],G(v==="no_cash_insurance"?"no_cash_insurance":"cash");P(De),M.current=o})()},[n,e,g,o,l,Fe,Ht,f,p,je,u,v]);const qe=()=>{const ge=parseFloat(L);if(!p)if(I&&!isNaN(ge)&&ge>=0&&z>0){if(I.trim().toLowerCase()==="consultation fee"&&T.some(De=>De.name.toLowerCase()==="consultation fee")){alert("Consultation Fee already added.");return}const Te={id:Date.now(),name:I.trim(),price:ge,quantity:z,total:ge*z,drug_id:null};P([...T,Te]),U(""),$(""),F(1)}else alert("Invalid item details.")},Be=ge=>{p||P(T.filter(Te=>Te.id!==ge))},ke=w.useMemo(()=>{let ge=T.reduce((Te,De)=>Te+De.total,0);return st==="create"&&Y>0&&(ge=ge*(1-Y/100)),(X==null?void 0:X.totalDue)!==void 0&&(X==null?void 0:X.totalDue)!==null?X.totalDue:ge},[T,X,Y,st]),we=w.useMemo(()=>(X==null?void 0:X.totalPaid)??0,[X]),Q=w.useMemo(()=>(X==null?void 0:X.balance)!==void 0&&(X==null?void 0:X.balance)!==null?X.balance:ke-we,[X,ke,we]),me=()=>{const ge=parseFloat(lt);!isNaN(ge)&&ge>=0?(rt(ge),localStorage.setItem(k_,ge.toString()),alert(`Default Fee set to ${ge.toFixed(2)}`)):alert("Invalid fee amount.")},Ve=async(ge,Te)=>{re(!0),V(null);try{const De=await pe("/api/payment/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Te,billId:ge})}),ze=await De.json();if(!De.ok||!ze.order)throw new Error(ze.message||"Failed to create Razorpay order.");const{key_id:nt,order:mt}=ze,Nt={key:nt,amount:mt.amount,currency:mt.currency,name:"Newtons Ai HMS Clinic",description:`Bill Payment for Patient ID: ${e}`,order_id:mt.id,handler:async function(cn){try{const gn=await pe("/api/payment/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({razorpay_payment_id:cn.razorpay_payment_id,razorpay_order_id:cn.razorpay_order_id,razorpay_signature:cn.razorpay_signature,billId:ge})}),Cn=await gn.json();if(gn.ok&&Cn.success)alert("Payment Successful!"),r&&r(ge),a&&a(),setTimeout(()=>window.print(),200);else throw new Error(Cn.message||"Payment verification failed.")}catch(gn){V(`Payment verification failed: ${gn.message}. Contact support.`)}finally{re(!1)}},prefill:{name:(S==null?void 0:S.name)||""},notes:{bill_id:ge,patient_id:e},theme:{color:"#3399cc"},modal:{ondismiss:function(){V("Payment cancelled."),re(!1)}}};if(window.Razorpay)new window.Razorpay(Nt).open();else throw new Error("Razorpay SDK not loaded.")}catch(De){V(`Failed to initiate online payment: ${De.message}`),re(!1)}},Qe=async()=>{if(!n){V("Bill ID is missing.");return}if(!ae||isNaN(parseFloat(ae))||parseFloat(ae)<=0){V("Please enter a valid positive payment amount.");return}Ie(!0),V(null);const ge={amount_paid:parseFloat(ae),payment_mode:Ke};try{const Te=await pe(`/api/bills/${n}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ge)}),De=await Te.json();if(!Te.ok)throw new Error(De.message||`Failed to record payment (Status: ${Te.status})`);alert(`Payment of ${ge.amount_paid.toFixed(2)} recorded.`),Me(""),a?a():console.log("Payment recorded.")}catch(Te){V(`Failed to record payment: ${Te.message}`)}finally{Ie(!1)}},ot=async()=>{if(st==="view_pay")return;if(!e){V("Patient ID is missing for creating a bill.");return}if(T.length===0){V("Cannot finalize an empty bill.");return}re(!0),V(null);const ge=ke,Te=T.map(({id:De,...ze})=>ze);if(B==="online"){const De={patientId:e,queueId:t||null,items:Te,amount:ge,paymentMode:"online",type:l,related_id:d||b||null,status:"pending",discountPercentage:Y,labOrderId:b||null};try{const ze=await pe("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(De)}),nt=await ze.json();if(!ze.ok)throw new Error(nt.message||"Failed to create pending bill.");Ve(nt.id,Math.round(ge*100))}catch(ze){V(`Failed to create pending bill: ${ze.message}`),re(!1)}}else{const De="paid";if(!B){V("Payment mode required."),re(!1);return}const ze={patientId:e,queueId:t||null,items:Te,amount:ge,paymentMode:B,type:l,related_id:d||b||null,status:De,discountPercentage:Y,labOrderId:b||null};setTimeout(()=>window.print(),200);try{const nt=await pe("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ze)}),mt=await nt.json();if(!nt.ok)throw new Error(mt.message||"Failed to create bill.");alert("Bill marked as paid!"),r&&r(mt.id),re(!1)}catch(nt){V(`Failed to process bill: ${nt.message}`),re(!1)}}},kt=(D==null?void 0:D.type)??l,qt=(D==null?void 0:D.status)??f,be=st==="view_pay"&&D&&qt==="pending";return!e&&!n?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow text-gray-500",children:"Select patient or provide Bill ID."}):ie||st==="view_pay"&&le?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow",children:"Loading..."}):st==="view_pay"&&!D&&!le&&W?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading bill: ",W]}):st==="create"&&!S&&!ie&&W?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading patient: ",W]}):i.jsxs("div",{className:"billing-component-container printable-section",children:[i.jsxs("div",{className:"billing-header",children:[i.jsx("h2",{children:st==="create"?"Create Bill":"Bill Details"}),st==="create"&&l==="consultation"&&!p&&i.jsxs("div",{className:"default-fee-section",children:[i.jsx("label",{htmlFor:"defaultFee",className:"whitespace-nowrap",children:"Default Fee:"}),i.jsx("input",{id:"defaultFee",type:"number",value:lt,onChange:ge=>ct(ge.target.value),className:"",placeholder:Px.toString(),disabled:p}),i.jsx("button",{onClick:me,title:"Set Default Fee",className:"",disabled:p,children:i.jsx(Od,{size:16})})]})]}),W&&!le&&!Ee&&i.jsxs("div",{className:"error-message",role:"alert",children:[i.jsx("strong",{children:"Error: "}),W]}),S&&i.jsxs("div",{className:"patient-details-section",children:[i.jsx("h3",{children:"Patient Details"}),i.jsxs("p",{children:[i.jsx("strong",{children:"ID:"})," ",S.id]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",S.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Age:"})," ",S.age||"N/A",", ",i.jsx("strong",{children:"Gender:"})," ",S.gender||"N/A"]})]}),i.jsxs("div",{className:"bill-items-summary-section",children:[i.jsxs("div",{className:"bill-items-header",children:[i.jsx("h3",{children:st==="create"?"Bill Items":"Billing Summary"}),st==="create"&&l==="pharmacy"&&!p&&T.some(ge=>ge.drug_id!=null)&&i.jsxs("button",{onClick:()=>je(T),disabled:oe,className:"refresh-prices-button",title:"Refresh item prices from inventory",children:[i.jsx(Jx,{size:14,className:`lucide ${oe?"animate-spin":""}`}),oe?"Refreshing...":"Refresh"]})]}),st==="view_pay"&&D&&i.jsxs("div",{className:"bill-info-bar",children:[i.jsxs("span",{children:["Bill ID: ",i.jsx("strong",{children:D.id})]}),i.jsxs("span",{children:["Type: ",i.jsx("strong",{className:"capitalize",children:kt})]}),i.jsxs("span",{children:["Status: ",i.jsx("strong",{className:`capitalize ${qt==="paid"?"status-paid":"status-pending"}`,children:qt})]})]}),(st==="create"||st==="view_pay"&&D)&&i.jsxs("div",{className:"bill-items-list",children:[st==="create"&&oe&&T.length>0&&i.jsx("div",{className:"loading-placeholder",children:"Updating prices..."}),st==="create"&&!oe&&T.map((ge,Te)=>i.jsxs("div",{className:"bill-item",children:[i.jsxs("div",{className:"bill-item-details",children:[i.jsxs("span",{children:[Te+1,". ",ge.name]}),ge.quantity>1&&i.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",ge.quantity,")"]})]}),i.jsxs("div",{className:"bill-item-price-actions",children:[i.jsxs("span",{className:"bill-item-price",children:["",ge.total.toFixed(2)]}),st==="create"&&typeof ge.id=="number"&&!p&&i.jsxs("button",{onClick:()=>Be(ge.id),className:"remove-item-button",title:"Remove",children:[" ",i.jsx(Xn,{size:16})," "]}),(typeof ge.id!="number"||p||ge.name==="Consultation Fee")&&i.jsxs("span",{className:"lock-icon",title:"Cannot remove",children:[" ",i.jsx(OS,{size:14})," "]})]})]},ge.id)),st==="view_pay"&&D&&D.items.map((ge,Te)=>i.jsxs("div",{className:"bill-item",children:[i.jsxs("div",{className:"bill-item-details",children:[i.jsxs("span",{children:[Te+1,". ",ge.name]}),ge.quantity>1&&i.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",ge.quantity,")"]})]}),i.jsxs("div",{className:"bill-item-price-actions",children:[i.jsxs("span",{className:"bill-item-price",children:["",(ge.total??ge.price*ge.quantity).toFixed(2)]}),i.jsxs("span",{className:"lock-icon",title:"Cannot remove from existing bill",children:[" ",i.jsx(OS,{size:14})," "]})]})]},Te)),st==="create"&&T.length===0&&i.jsx("p",{className:"empty-items-message",children:"No items added."}),st==="view_pay"&&D&&D.items.length===0&&i.jsx("p",{className:"empty-items-message",children:"No items in bill."})]}),st==="create"&&!p&&i.jsxs("div",{className:"add-item-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Item"}),i.jsx("input",{type:"text",value:I,onChange:ge=>U(ge.target.value),placeholder:"Service/Item",className:"custom-text-input"})]}),i.jsxs("div",{className:"form-group",style:{flexGrow:.5,minWidth:"80px"},children:[i.jsx("label",{children:"Qty"}),i.jsx("input",{type:"number",min:"1",value:z,onChange:ge=>F(parseInt(ge.target.value)||1),placeholder:"1",className:"custom-text-input"})]}),i.jsxs("div",{className:"form-group",style:{flexGrow:.7,minWidth:"100px"},children:[i.jsx("label",{children:"Price ()"}),i.jsx("input",{type:"number",value:L,onChange:ge=>$(ge.target.value),placeholder:"0.00",className:"custom-text-input"})]}),i.jsx("button",{onClick:qe,className:"add-item-button",children:"Add"})]})]})," ",i.jsxs("div",{className:"billing-footer",children:[i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Total Amount:"}),i.jsxs("span",{className:"total-amount-value",children:["",typeof ke=="number"?ke.toFixed(2):"0.00"]}),st==="create"&&!p&&i.jsxs("div",{className:"discount-section",children:[i.jsx("label",{htmlFor:"discountPercentage",className:"whitespace-nowrap",children:"Discount (%):"}),i.jsx("input",{id:"discountPercentage",type:"number",min:"0",max:"100",step:"0.01",value:Y,onChange:ge=>R(parseFloat(ge.target.value)||0),className:"",disabled:p||se})]}),st==="view_pay"&&D&&(D.status==="pending"||D.status==="paid")&&i.jsxs("div",{className:"discount-section",children:[i.jsx("label",{className:"whitespace-nowrap",children:"Discount (%):"}),i.jsxs("span",{className:"discount-value",children:[Y.toFixed(2),"%"]})]})]}),st==="view_pay"&&X&&i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Amount Paid:"}),i.jsxs("span",{className:"total-amount-value",children:["",we.toFixed(2)]})]}),st==="view_pay"&&X&&i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Balance Due:"}),i.jsxs("span",{className:"total-amount-value",children:["",Q.toFixed(2)]})]}),i.jsxs("div",{className:"footer-actions",children:[st==="create"&&!p&&i.jsxs("div",{className:"action-group",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Payment Mode"}),i.jsxs("select",{value:B,onChange:ge=>G(ge.target.value),className:"custom-select-input",disabled:p||se,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"online",children:"Pay Online (Razorpay)"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsx("button",{onClick:ot,disabled:se||T.length===0||p,className:"finalize-button",children:se?"Processing...":"Finalize Bill"})]}),st==="view_pay"&&be&&!p&&i.jsxs("div",{className:"action-group",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Record Payment Amount ()"}),i.jsx("input",{type:"number",value:ae,onChange:ge=>Me(ge.target.value),placeholder:`Max: ${Q.toFixed(2)}`,className:"custom-text-input",disabled:Ee})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Payment Mode"}),i.jsxs("select",{value:Ke,onChange:ge=>Z(ge.target.value),className:"custom-select-input",disabled:Ee,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),i.jsx("button",{onClick:Qe,disabled:Ee||!ae||parseFloat(ae)<=0||parseFloat(ae)>Q,className:"record-payment-button",children:Ee?"Recording...":"Record Payment"})]}),st==="create"&&p&&T.length>0&&i.jsx("div",{className:"status-message read-only",children:"Read-only."}),st==="view_pay"&&qt==="paid"&&i.jsx("div",{className:"status-message paid",children:"PAID."}),st==="view_pay"&&qt==="cancelled"&&i.jsx("div",{className:"status-message cancelled",children:"CANCELLED."})]})]})]})},Dee=()=>{const e=Et(),n=Yr(),{patientId:t,queueId:r,patientName:a,initialItems:o,billType:l,relatedId:d,initialStatus:f,initialDiscountPercentage:u,doctorId:p,billId:g,labOrderId:b}=n.state||{},[v,S]=w.useState(null),[k,T]=w.useState(null),[P,M]=w.useState(null),[I,U]=w.useState(null),[L,$]=w.useState(null),[z,F]=w.useState(null),[Y,R]=w.useState(null),[B,G]=w.useState(null),[ie,te]=w.useState(!0),[W,V]=w.useState(null),[se,re]=w.useState(a||"");w.useEffect(()=>{if(!t){console.error("BillingPage loaded without required patientId in location state."),e("/");return}(async()=>{te(!0),V(null);try{let ce=t,ve=o||null,X=f||null,fe=l||null,ae=d||null,Me=u!==void 0?parseFloat(u):null,Ke=a||null,Z=null;if(g){console.log(`Fetching details for Bill ID: ${g}`);const Ee=await pe(`/api/bills/${g}`);if(!Ee.ok){const Fe=await Ee.json().catch(()=>({message:`Failed to fetch bill details for ID ${g}`}));throw new Error(Fe.message||`Failed to fetch bill details (Status: ${Ee.status})`)}const Ie=await Ee.json();if(console.log("Fetched Bill Data:",Ie),ve=Ie.bill.items||[],X=Ie.bill.status||"pending",fe=Ie.bill.type||null,ae=Ie.bill.related_id||null,Me=Ie.bill.discount_percentage!==void 0&&Ie.bill.discount_percentage!==null?parseFloat(Ie.bill.discount_percentage):0,ce=Ie.bill.patient_id,U(ve),$(X),F(fe),R(ae),G(Me),ce){const Fe=await pe(`/api/patients/${ce}`);if(Fe.ok){const rt=await Fe.json();Ke=rt.name,Z=rt.phone??null,M(rt.insurance_type??null),re(Ke),T(Z)}else console.warn(`Could not fetch patient details for ID ${ce} from bill.`),re("Patient (Not Found)")}else console.warn(`Bill ${g} does not have an associated patient_id.`),re("Patient (Unknown)")}else if(b){console.log(`Fetching details for Lab Order ID: ${b}`);const Ee=await pe(`/api/lab/${b}`);if(!Ee.ok){let Fe=`Failed to fetch lab order details (Status: ${Ee.status} ${Ee.statusText})`;try{Fe=(await Ee.json()).message||Fe}catch{console.error("Response was not valid JSON:",await Ee.text())}throw new Error(Fe)}const Ie=await Ee.json();if(console.log("Fetched Lab Order Data:",JSON.stringify(Ie,null,2)),ve=(Ie.tests||[]).filter(Fe=>Fe&&typeof Fe.name=="string"&&Fe.price!==void 0&&Fe.id!==void 0).map(Fe=>{const rt=parseFloat(Fe.price||"0"),lt=!isNaN(rt)&&isFinite(rt)?rt:0;return{item_id:Fe.id,name:Fe.name,price:lt,quantity:1,total:lt*1,type:"lab_test"}}),ve&&ve.length===0&&(Ie.tests||[]).length>0&&(console.warn("Warning: Some tests from the lab order were filtered out due to missing id, name, or price.",Ie.tests),V(Fe=>`${Fe?Fe+"; ":""}Warning: Some lab items could not be added to the bill due to missing details.`)),X="pending",fe="lab",ae=b,ce=Ie.patient_id,U(ve),$(X),F(fe),R(ae),ce){const Fe=await pe(`/api/patients/${ce}`);if(Fe.ok){const rt=await Fe.json();Ke=rt.name,Z=rt.phone??null,M(rt.insurance_type??null),re(Ke),T(Z)}else console.warn(`Could not fetch patient details for ID ${ce} from lab order.`),re("Patient (Not Found)")}else console.warn(`Lab Order ${b} does not have an associated patient_id.`),re("Patient (Unknown)")}else if(U(o||null),$(f||null),F(l||null),R(d||null),G(u!==void 0?parseFloat(u):null),re(a||`ID ${t}`),ce){const Ee=await pe(`/api/patients/${ce}`);if(Ee.ok){const Ie=await Ee.json();T(Ie.phone??null),M(Ie.insurance_type??null)}else console.warn(`Could not fetch patient details for ID ${ce}.`)}if(r){const Ee=await pe(`/api/queue/${r}`);if(Ee.ok){const Ie=await Ee.json();S(Ie.token_number)}else console.warn(`Could not fetch queue details for ID ${r}.`)}}catch(ce){console.error("Error fetching billing page details:",ce),V(`Failed to load details: ${ce.message}`),U(null),$(null),F(null),R(null),re(a||""),T(null),S(null)}finally{te(!1)}})()},[t,g,b,r,e]);const oe=D=>{console.log(`Billing process completed for patient ID ${t}. New Bill ID: ${D}`),e(-1)},E=()=>{console.log(`Bill updated for patient ID ${t}.`),e(-1)};if(!t)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-gray-600",children:[i.jsx(LS,{size:48,className:"mb-4 text-red-500"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Missing Patient Information"}),i.jsx("p",{className:"text-sm",children:"Cannot load the billing page without a patient ID."}),i.jsx("button",{onClick:()=>e("/"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Go to Dashboard"})]});if(ie)return i.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:i.jsx("p",{className:"text-teal-600 animate-pulse",children:"Loading Billing Details..."})});if(W)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-red-600 p-4",children:[i.jsx(LS,{size:48,className:"mb-4"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Error Loading Billing Details"}),i.jsx("p",{className:"text-sm text-center mb-4",children:W}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"}),i.jsx("button",{onClick:()=>e(-1),className:"mt-2 text-sm text-gray-600 hover:text-teal-700",children:"Go Back"})]});const ue=(L??f)==="paid";return i.jsxs("div",{className:"billing-page-container",children:[i.jsx("div",{className:"back-button-container",children:i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[i.jsx(nn,{size:20,className:"lucide"})," Back"]})}),i.jsxs("div",{className:"billing-content-wrapper",children:[i.jsxs("h3",{className:"billing-page-title",children:[g?"Bill Details":b?"Create Lab Bill":"Create Bill"," for Patient: ",se||`ID ${t}`]}),i.jsxs("div",{className:"patient-info-bar",children:[v!==null&&i.jsxs("span",{children:[i.jsx(Ym,{size:14,className:"lucide"})," Token: ",v]}),k&&i.jsxs("span",{children:[i.jsx(s2,{size:14,className:"lucide"})," Phone: ",k]}),b&&i.jsxs("span",{className:"lab-order-info",children:[i.jsx(Wl,{size:14,className:"lucide"})," Lab Order: ",b.substring(0,8),"..."]}),!k&&v===null&&!b&&i.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"}),P&&i.jsxs("span",{className:"insurance-info",children:[i.jsx(OR,{size:14,className:"lucide"})," Insurance: ",P.replace(/_/g," ").replace(/\b\w/g,D=>D.toUpperCase())]}),!k&&v===null&&!b&&!P&&i.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"})]}),i.jsx(Pee,{patientId:t,labOrderId:b,queueId:r,onBillCreated:oe,onBillUpdated:E,initialItems:I??o,billType:z??l,relatedId:Y??d,initialStatus:L??f,initialDiscountPercentage:B??u,readOnlyMode:ue,doctorId:p,patientInsuranceType:P??void 0})]})]})},Iee=()=>{const{patientId:e}=Vi(),n=Et(),[t,r]=w.useState([]),[a,o]=w.useState(!1),[l,d]=w.useState(null),[f,u]=w.useState("");return w.useEffect(()=>{(async()=>{if(!e){d("Patient ID not provided in URL.");return}o(!0),d(null),r([]);try{try{const v=await pe(`/api/patients/${e}`);if(v.ok){const S=await v.json();u(S.name)}}catch(v){console.warn("Could not fetch patient name:",v)}console.log(`Fetching pharmacy orders for patient ID: ${e}`);const g=await pe(`/api/pharmacy-orders/patient/${e}`);if(!g.ok){const v=await g.json().catch(()=>({}));throw new Error(v.message||`HTTP error! status: ${g.status}`)}const b=await g.json();console.log("Fetched Pharmacy Orders:",b),r(b||[])}catch(g){console.error("Error fetching pharmacy orders:",g),d(`Failed to load pharmacy orders: ${g.message}`)}finally{o(!1)}})()},[e]),i.jsxs("div",{className:"p-4 md:p-6 max-w-4xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6 border-b pb-3",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-900",children:[i.jsx(nn,{size:16,className:"mr-1"}),"Back"]}),i.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[i.jsx(Md,{size:20,className:"mr-2 text-purple-600"}),"Pharmacy Order History ",f&&`for ${f}`]}),i.jsx("div",{})," "]}),a&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading pharmacy orders..."}),l&&i.jsx("p",{className:"text-center text-red-500 bg-red-100 p-3 rounded border border-red-300",children:l}),!a&&t.length===0&&!l&&i.jsx("p",{className:"text-center text-gray-500",children:"No pharmacy orders found for this patient."}),!a&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(p=>i.jsxs("div",{className:"p-4 border rounded bg-white shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Date:"})," ",new Date(p.date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm font-medium capitalize",children:[i.jsx("strong",{children:"Status:"})," ",p.status]})]}),i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Prescribed By:"})," ",p.prescribedBy||"N/A"]}),p.dispensedBy&&i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Dispensed By:"})," ",p.dispensedBy]}),i.jsx("h4",{className:"text-md font-semibold mt-3 mb-1",children:"Medications:"}),i.jsx("ul",{className:"list-disc list-inside ml-4 text-sm text-gray-700 space-y-1",children:p.medications.map((g,b)=>i.jsxs("li",{children:[g.name," - Qty: ",g.quantity,g.tabletsPerDay&&` (${g.tabletsPerDay} per day`,g.numberOfDays&&` for ${g.numberOfDays} days)`,!g.tabletsPerDay&&g.numberOfDays&&` (for ${g.numberOfDays} days)`,g.tabletsPerDay&&!g.numberOfDays&&")"]},b))})]},p.id))})]})},Ree=()=>{const e=Et(),n=Yr(),[t,r]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState([]),[f,u]=w.useState(""),[p,g]=w.useState([]),[b,v]=w.useState(null),[S,k]=w.useState(!1),[T,P]=w.useState(null),[M,I]=w.useState(!0),[U,L]=w.useState(""),[$,z]=w.useState([]),[F,Y]=w.useState(!1),[R,B]=w.useState(null),[G,ie]=w.useState(!1),[te,W]=w.useState(!1),[V,se]=w.useState([]),[re,oe]=w.useState(!1),[E,le]=w.useState(null),ue=/^\+?[0-9\s\-().]{7,20}$/,D=/^[a-zA-Z\s'-]{2,}$/,ce=w.useCallback(async()=>{try{const je=await pe("/api/drugs");if(!je.ok)throw new Error("Failed to fetch drugs");const qe=await je.json();o(qe)}catch(je){console.error("Failed to fetch available drugs:",je),v("Could not load drug list. "+je.message)}},[]),ve=w.useCallback(async je=>{oe(!0),le(null);try{const qe=await pe(`/api/pharmacy-orders/patient/${je}`);if(!qe.ok){const ke=await qe.json().catch(()=>({}));throw new Error(ke.message||`HTTP error! status: ${qe.status}`)}const Be=await qe.json();se(Be||[])}catch(qe){console.error("Failed to fetch previous pharmacy orders:",qe),le(`Could not load previous orders: ${qe.message}`)}finally{oe(!1)}},[]);w.useEffect(()=>{var je;ce(),(je=n.state)!=null&&je.patient?ae(n.state.patient):I(!0)},[ce,n.state]),w.useEffect(()=>{t!=null&&t.id?ve(t.id):se([])},[t,ve]),w.useEffect(()=>{if(!f){g([]);return}const je=f.toLowerCase();g(a.filter(qe=>{const Be=qe.name&&qe.name.toLowerCase().includes(je),ke=qe.brand_name&&qe.brand_name.toLowerCase().includes(je);return Be||ke}).slice(0,10))},[f,a]);const X=w.useMemo(()=>vb(async je=>{if(je.trim().length<2){z([]),Y(!1),B(null);return}Y(!0),B(null);try{const qe=new URLSearchParams({search:encodeURIComponent(je),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Be=await pe(`/api/patients?${qe.toString()}`);if(!Be.ok){const we=await Be.text();throw new Error(`API Error (${Be.status}): ${we||Be.statusText}`)}const ke=await Be.json();z(ke.patients)}catch(qe){console.error("Error searching patients:",qe),B(qe.message||"Failed to search patients."),z([])}finally{Y(!1)}},300),[ue]),fe=je=>{const qe=je.target.value;L(qe),ie(ue.test(qe)),W(D.test(qe)&&!ue.test(qe)),Y(!0),X(qe)},ae=w.useCallback(je=>{r(je),I(!1),L(""),z([]),B(null)},[]),Me=w.useCallback(async je=>{if(!U||je==="phone"&&!G||je==="name"&&!te){B(`Invalid ${je} to create a new patient.`);return}Y(!0),B(null);try{const Be=await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:je==="name"?U:"direct pharmacy",phone:je==="phone"?U:null,age:null,gender:null,token:null})});if(!Be.ok){const we=await Be.json();throw new Error(we.message||`Failed to create patient: ${Be.statusText}`)}const ke=await Be.json();alert(`New patient "${ke.name}" created with ${je==="phone"?`phone ${ke.phone}`:`name ${ke.name}`}.`),ae(ke)}catch(qe){console.error("Error creating new patient:",qe),B(qe.message||"Failed to create new patient.")}finally{Y(!1)}},[U,G,te,ae]),Ke=()=>{r(null),I(!0),d([]),v(null),se([])},Z=je=>{if(l.some(qe=>qe.drug_id===je.id)){const qe=je.name||je.brand_name||"This drug";v(`${qe} is already in the order.`),setTimeout(()=>v(null),3e3),u(""),g([]);return}d(qe=>[...qe,{drug_id:je.id,name:je.name||je.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,tabletsPerDay:1,numberOfDays:1,price:Number(je.price)||0,originalPrice:Number(je.price)||0,stock:je.quantity_in_stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(je.price)||0)/(Ie(je.unit)||1),unit:je.unit}]),u(""),g([])},Ee=()=>{const je=f.trim();if(!je){v("Please enter a drug name to navigate to the add drug page."),setTimeout(()=>v(null),3e3);return}e("/dashboard/inventory/add",{state:{initialDrugName:je}}),u(""),g([])},Ie=je=>{if(!je)return null;const qe=je.match(/(?:\d+x)?(\d+)/);return qe?parseInt(qe[1],10):null},Fe=je=>{d(qe=>qe.filter(Be=>(Be.drug_id??Be.name)!==je))},rt=(je,qe)=>{d(Be=>Be.map(ke=>{if((ke.drug_id??ke.name)===je&&ke.isLoose){const Q=Ie(ke.unit),me=Math.max(0,qe),Ve=me*(Q??1)+(ke.looseUnits??0);return{...ke,loosePacks:me,looseQuantity:Ve}}return ke}))},lt=(je,qe)=>{d(Be=>Be.map(ke=>{if((ke.drug_id??ke.name)===je&&ke.isLoose){const Q=Ie(ke.unit),me=Math.max(0,qe),Ve=(ke.loosePacks??0)*(Q??1)+me;return{...ke,looseUnits:me,looseQuantity:Ve}}return ke}))},ct=je=>{const qe=[];je.medications.forEach(Be=>{if(l.find(we=>we.drug_id&&Be.drug_id&&we.drug_id===Be.drug_id||we.name.toLowerCase()===Be.name.toLowerCase()))d(we=>we.map(Q=>{if(Q.drug_id&&Be.drug_id&&Q.drug_id===Be.drug_id||Q.name.toLowerCase()===Be.name.toLowerCase()){const me=(Q.pack_quantity??0)+(Be.pack_quantity??0),Ve=(Q.loose_quantity??0)+(Be.loose_quantity??0),Qe=Be.tabletsPerDay??Q.tabletsPerDay,ot=Be.numberOfDays??Q.numberOfDays,kt=Ie(Q.unit),qt=me*(kt??1)+Ve;return{...Q,pack_quantity:me,loose_quantity:Ve,directions_to_use:Be.directions_to_use??Q.directions_to_use,tabletsPerDay:Qe,numberOfDays:ot,looseQuantity:qt,loosePacks:Math.floor(qt/(kt??1)),looseUnits:qt%(kt??1)}}return Q}));else{let we=Be.drug_id,Q=Be.drug_id?a.find(me=>me.id===Be.drug_id):void 0;if(!we&&Be.name){const me=a.find(Ve=>Ve.name&&Ve.name.toLowerCase()===Be.name.toLowerCase());me&&(we=me.id,Q=me)}qe.push({drug_id:we,name:Be.name,pack_quantity:Be.pack_quantity??0,loose_quantity:Be.loose_quantity??0,directions_to_use:Be.directions_to_use,tabletsPerDay:Be.tabletsPerDay??1,numberOfDays:Be.numberOfDays??1,price:Q?Q.price:Be.price,stock:Q?Q.quantity_in_stock:Be.stock,isLoose:!0,loosePacks:0,looseUnits:(Be.pack_quantity??0)*(Ie((Q==null?void 0:Q.unit)||Be.unit)??1)+(Be.loose_quantity??0),looseQuantity:(Be.pack_quantity??0)*(Ie((Q==null?void 0:Q.unit)||Be.unit)??1)+(Be.loose_quantity??0),pricePerLooseUnit:(Q?Number(Q.price):Number(Be.price)||0)/(Ie((Q==null?void 0:Q.unit)||Be.unit)||1),unit:(Q==null?void 0:Q.unit)||Be.unit})}}),d(Be=>[...Be,...qe]),je.prescriptionForUnavailableDrugs&&(!T||!T.includes(je.prescriptionForUnavailableDrugs))&&P(Be=>Be?`${Be}

-- From Order ${je.id.substring(0,8)} --
${je.prescriptionForUnavailableDrugs}`:je.prescriptionForUnavailableDrugs),v("Medications from previous order added to current order."),setTimeout(()=>v(null),3e3)},st=async je=>{if(je.preventDefault(),v(null),k(!0),!t){v("No patient selected for the order."),k(!1);return}if(l.length===0&&!(T!=null&&T.trim())){v("Please add at least one medication or provide a prescription for unavailable drugs."),k(!1);return}const qe=l.filter(ke=>{const we=ke.looseQuantity??0;return we<=0||ke.stock!==void 0&&we>ke.stock});if(qe.length>0){v(`Invalid quantity or insufficient stock for: ${qe.map(ke=>ke.name).join(", ")}`),k(!1);return}const Be={patient_id:t.id,items:l.map(ke=>{const we=ke.price??0,Q=ke.pricePerLooseUnit??0,me=Q*(ke.looseQuantity??0);return{drug_id:ke.drug_id===void 0?null:ke.drug_id,name:ke.name,pack_quantity:ke.loosePacks??0,loose_quantity:ke.looseUnits??0,pack_price:we,loose_price:Q,total_price:me,price:ke.originalPrice??0,directions_to_use:ke.directions_to_use===void 0?null:ke.directions_to_use,tabletsPerDay:ke.tabletsPerDay??1,numberOfDays:ke.numberOfDays??1}}),order_total:Ht,prescription_for_unavailable_drugs:T};try{const ke=await pe("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Be)});if(!ke.ok){const we=await ke.json();throw new Error(we.message||`Failed to create order: ${ke.statusText}`)}alert(`Pharmacy order created successfully for ${t.name}!`),e(-1)}catch(ke){console.error("Failed to create pharmacy order:",ke),v(ke.message||"Failed to create order. Please try again.")}finally{k(!1)}},Ht=w.useMemo(()=>l.reduce((je,qe)=>{const Be=qe.isLoose?qe.pricePerLooseUnit??0:qe.price??0,ke=qe.isLoose?qe.looseQuantity??0:qe.quantity??0;return je+Be*ke},0),[l]),rn=(Number(Ht)||0).toFixed(2);return i.jsxs("div",{className:"add-pharmacy-order-page p-4 md:p-6 max-w-5xl mx-auto",children:[" ",i.jsxs("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:[" ",i.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:[i.jsx(nn,{size:20})," "]}),i.jsx("h2",{className:"text-2xl",children:"Create New Pharmacy Order"})," "]})]}),M&&i.jsxs("div",{className:"content-section",children:[" ",i.jsx("h3",{className:"section-title",children:"Select Patient"})," ",i.jsxs("div",{className:"mb-3 relative",children:[i.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"})," ",i.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:U,onChange:fe,className:"custom-text-input mt-1",autoFocus:!0}),F&&i.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),R&&i.jsx("div",{className:"ai-function-status error mb-3 p-3",children:R})," ",$.length>0&&i.jsxs("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:[" ",i.jsxs("ul",{children:[" ",$.map(je=>i.jsxs("li",{onClick:()=>ae({id:je.id,name:je.name,token:je.token,age:je.age,gender:je.gender,phone:je.phone}),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[i.jsxs("div",{className:"font-medium",children:[i.jsxs("span",{className:"patient-token mr-2",children:["#",je.token]}),je.name]}),i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[je.age?`${je.age} yrs`:"Age N/A",je.gender?` / ${je.gender}`:" / Gender N/A",je.phone&&i.jsxs("span",{className:"hidden sm:inline",children:[" / ",je.phone]})]})]}),je.phone&&i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",je.phone]})]},je.id))]})]}),U.length>=2&&!F&&$.length===0&&!R&&i.jsxs(i.Fragment,{children:[i.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',U,'".']}),G&&i.jsx("button",{type:"button",onClick:()=>Me("phone"),className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:F,children:'Create "direct pharmacy" Patient with this Phone'}),te&&i.jsx("button",{type:"button",onClick:()=>Me("name"),className:"create-patient-button mt-3 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ml-2",disabled:F,children:"Create Patient with this Name"})]}),U.length<2&&!F&&i.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]}),t&&!M&&i.jsxs("form",{onSubmit:st,children:[i.jsxs("div",{className:"selected-patient-info content-section flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[" ",i.jsxs("div",{children:[i.jsxs("h3",{className:"section-title",children:[" ","Patient: ",i.jsx("span",{className:"font-normal",children:t.name})]}),i.jsxs("p",{className:"text-sm mt-1",children:["Token: ",i.jsx("span",{className:"font-medium",children:t.token??"N/A"}),t.age&&`    Age: ${t.age}`,t.gender&&`    Gender: ${t.gender}`,t.phone&&`    Phone: ${t.phone}`]}),i.jsxs("p",{className:"text-xs mt-1",title:`Patient UUID: ${t.id}`,children:["ID: ",t.id.substring(0,12),"..."]})]}),i.jsx("button",{type:"button",onClick:Ke,className:"change-patient-button mt-2 sm:mt-0 px-3 py-1.5 border rounded-md text-sm font-medium focus:outline-none focus:ring-2",children:"Change Patient"})]}),b&&i.jsx("div",{className:"ai-function-status error mb-4 p-3",children:b})," ",re&&i.jsx("div",{className:"content-section text-center py-4",children:i.jsx("p",{className:"text-gray-500",children:"Loading previous orders..."})}),E&&i.jsx("div",{className:"ai-function-status error mb-4 p-3",children:E}),!re&&V.length>0&&i.jsxs("div",{className:"content-section mt-4",children:[i.jsx("h3",{className:"section-title",children:"Previous Orders"}),i.jsx("div",{className:"space-y-4",children:V.map(je=>i.jsxs("div",{className:"previous-order-card p-4 border rounded-lg shadow-sm bg-gray-50",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("p",{className:"font-semibold text-gray-800",children:["Order Date: ",new Date(je.date).toLocaleDateString()]}),i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${je.status==="dispensed"?"bg-green-100 text-green-800":je.status==="pending"?"bg-yellow-100 text-yellow-800":je.status==="cancelled"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:je.status.charAt(0).toUpperCase()+je.status.slice(1)})]}),i.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mb-3",children:je.medications.map((qe,Be)=>i.jsxs("li",{children:[i.jsx("strong",{children:qe.name}),": ",qe.quantity," Qty",qe.directions_to_use&&` - Directions: ${qe.directions_to_use}`]},Be))}),je.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:[i.jsx("span",{className:"font-semibold",children:"Prescription for Unavailable:"}),i.jsxs("div",{className:"prose prose-sm max-w-none",children:[" ",i.jsx(Yo,{remarkPlugins:[Bs],children:je.prescriptionForUnavailableDrugs})]})]}),i.jsxs("button",{type:"button",onClick:()=>ct(je),className:"add-previous-meds-button mt-3 px-3 py-1.5 text-sm font-medium rounded-md flex items-center justify-center",children:[i.jsx(Ql,{size:16,className:"mr-1"})," Add Medications to Current Order"]})]},je.id))})]}),!re&&V.length===0&&t&&i.jsx("div",{className:"content-section text-center py-4 mt-4",children:i.jsx("p",{className:"text-gray-500",children:"No previous orders found for this patient."})}),i.jsxs("div",{className:"mb-4 content-section",children:[i.jsx("label",{htmlFor:"prescription-unavailable",className:"form-label",children:"Prescription for Unavailable Drugs (Optional)"}),i.jsx("textarea",{id:"prescription-unavailable",rows:3,value:T??"",onChange:je=>P(je.target.value||null),placeholder:"Enter prescription details for any drugs that are currently unavailable...",className:"custom-text-input mt-1 w-full"})]}),i.jsxs("div",{className:"mb-4 relative content-section",children:[" ",i.jsx("label",{htmlFor:"drug-search",className:"form-label",children:"Add Medication"})," ",i.jsx("input",{type:"text",id:"drug-search",placeholder:"Search for drug name or type to add custom...",value:f,onChange:je=>u(je.target.value),className:"custom-text-input mt-1"}),f&&i.jsxs("div",{className:"drug-search-dropdown mt-1 w-full max-h-60 rounded-md border shadow-lg overflow-auto focus:outline-none sm:text-sm z-20",children:[" ",p.length>0&&i.jsxs("ul",{children:[" ",p.map(je=>i.jsxs("li",{onClick:()=>Z(je),className:"cursor-pointer select-none relative",children:[i.jsx("span",{className:"font-medium block truncate",children:je.name||je.brand_name}),i.jsxs("span",{className:"drug-stock-price text-xs",children:[" ","(Stock: ",je.quantity_in_stock??"N/A",", Price: ",Number(je.price||0).toFixed(2),")"]})]},je.id))]}),f.trim()&&!a.some(je=>je.name&&je.name.toLowerCase()===f.trim().toLowerCase()||je.brand_name&&je.brand_name.toLowerCase()===f.trim().toLowerCase())&&i.jsxs("div",{onClick:Ee,className:"add-custom-drug-button cursor-pointer text-sm font-medium",role:"button",children:['Add "',f.trim(),'" as new item']}),f.trim()&&p.length===0&&a.some(je=>je.name&&je.name.toLowerCase()===f.trim().toLowerCase()||je.brand_name&&je.brand_name.toLowerCase()===f.trim().toLowerCase())&&i.jsx("p",{className:"text-gray-400 py-2.5 px-4 text-sm",children:"Drug already selected or no new matches."})]})]}),i.jsxs("div",{className:"order-items-section content-section max-h-96 overflow-y-auto",children:[" ",i.jsx("h4",{className:"section-title",children:"Order Items"})," ",l.length===0&&i.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:"No medications added yet."}),l.length>0&&i.jsx("ul",{className:"space-y-4",children:l.map(je=>{const qe=je.drug_id??je.name,Be=!je.drug_id;return i.jsxs("li",{className:"order-item-card text-sm",children:[" ",i.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-3",children:[i.jsxs("div",{className:"flex-grow mb-2 md:mb-0",children:[i.jsxs("span",{className:`item-name block text-base ${Be?"custom":""}`,children:[" ",je.name,Be?" (custom)":""]}),!Be&&je.pricePerLooseUnit!==void 0&&i.jsxs("span",{className:"item-details text-xs",children:[" ","@ ",(Number(je.pricePerLooseUnit)||0).toFixed(2)," per loose unit"]}),je.stock!==void 0&&i.jsxs("span",{className:`item-details text-xs ml-2 ${je.stock<=10?"item-stock low":""}`,children:[" ","(Stock: ",je.stock,")"]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-x-4 gap-y-2",children:[i.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[i.jsx("label",{htmlFor:`loose-packs-${qe}`,className:"dosage-label",children:"Packs:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>rt(qe,(je.loosePacks??0)-1),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`loose-packs-${qe}`,min:"0",value:je.loosePacks??0,onChange:ke=>{const we=parseInt(ke.target.value,10);rt(qe,isNaN(we)?0:we)},onFocus:ke=>ke.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>rt(qe,(je.loosePacks??0)+1),className:"quantity-btn",children:"+"})]})]}),i.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[i.jsx("label",{htmlFor:`loose-units-${qe}`,className:"dosage-label",children:"Loose:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>lt(qe,(je.looseUnits??0)-1),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`loose-units-${qe}`,min:"0",value:je.looseUnits??0,onChange:ke=>{const we=parseInt(ke.target.value,10);lt(qe,isNaN(we)?0:we)},onFocus:ke=>ke.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>lt(qe,(je.looseUnits??0)+1),className:"quantity-btn",children:"+"})]}),je.unit&&i.jsxs("span",{className:"ml-2 text-sm text-gray-400",children:["(",je.unit.split("x")[1]||je.unit," per pack)"]})]})]}),i.jsxs("div",{className:"flex items-center justify-between md:justify-end gap-3 mt-2 md:mt-0 md:flex-col md:items-end",children:[i.jsxs("div",{className:"w-28 text-right font-semibold",children:[" ","",(Number((je.pricePerLooseUnit??0)*(je.looseQuantity??0))||0).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>Fe(qe),className:"remove-item-button p-1.5 -m-1.5 rounded-full",title:"Remove Item",children:i.jsx(li,{size:18})})]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-x-4 gap-y-2 mt-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:`tablets-per-day-${qe}`,className:"dosage-label",children:"Per Day:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>d(ke=>ke.map(we=>we.drug_id===qe?{...we,tabletsPerDay:Math.max(1,(we.tabletsPerDay??1)-1)}:we)),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`tablets-per-day-${qe}`,min:"1",value:je.tabletsPerDay??1,onChange:ke=>{const we=parseInt(ke.target.value,10);d(Q=>Q.map(me=>me.drug_id===qe?{...me,tabletsPerDay:isNaN(we)?1:Math.max(1,we)}:me))},onFocus:ke=>ke.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>d(ke=>ke.map(we=>we.drug_id===qe?{...we,tabletsPerDay:(we.tabletsPerDay??1)+1}:we)),className:"quantity-btn",children:"+"})]})]}),i.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[i.jsx("label",{htmlFor:`number-of-days-${qe}`,className:"dosage-label",children:"No. Days:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>d(ke=>ke.map(we=>we.drug_id===qe?{...we,numberOfDays:Math.max(1,(we.numberOfDays??1)-1)}:we)),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`number-of-days-${qe}`,min:"1",value:je.numberOfDays??1,onChange:ke=>{const we=parseInt(ke.target.value,10);d(Q=>Q.map(me=>me.drug_id===qe?{...me,numberOfDays:isNaN(we)?1:Math.max(1,we)}:me))},onFocus:ke=>ke.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>d(ke=>ke.map(we=>we.drug_id===qe?{...we,numberOfDays:(we.numberOfDays??1)+1}:we)),className:"quantity-btn",children:"+"})]})]})]}),i.jsx("div",{className:"flex items-center mt-2",children:je.unit&&Ie(je.unit)&&i.jsx("span",{className:"ml-4 text-sm text-gray-400",children:(()=>{const ke=Ie(je.unit),we=je.looseQuantity??0;if(ke&&ke>0){const Q=Math.floor(we/ke),me=we%ke;return`(Subtract: ${Q} packs, ${me} loose)`}return""})()})}),i.jsxs("div",{className:"mt-2",children:[i.jsx("label",{htmlFor:`directions-${qe}`,className:"dosage-label",children:"Directions:"}),i.jsx("input",{type:"text",id:`directions-${qe}`,placeholder:"e.g., 'After food', 'Twice a day'",value:je.directions_to_use??"",onChange:ke=>{const we=ke.target.value;d(Q=>Q.map(me=>(me.drug_id??me.name)===qe?{...me,directions_to_use:we}:me))},className:"dosage-input text-sm w-full mt-1"})]})]},qe)})})]}),l.length>0&&i.jsx("div",{className:"mt-6 text-right pr-4",children:i.jsxs("span",{className:"grand-total font-bold",children:[" ","Grand Total: ",rn]})}),i.jsx("div",{className:"mt-8 flex justify-end",children:i.jsx("button",{type:"submit",disabled:S||l.length===0&&!(T!=null&&T.trim()),className:`submit-order-button inline-flex items-center justify-center text-base shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 ${S||l.length===0&&!(T!=null&&T.trim())?"":"hover:opacity-90"}`,children:S?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"spinner animate-spin rounded-full h-5 w-5 border-2 mr-3"})," ","Creating Order..."]}):"Create Order"})})]})]})},pA=()=>{const{orderId:e}=Vi(),n=Et(),[t,r]=w.useState(null),[a,o]=w.useState(null),[l,d]=w.useState([]),[f,u]=w.useState([]),[p,g]=w.useState(""),[b,v]=w.useState([]),[S,k]=w.useState(null),[T,P]=w.useState(!1),[M,I]=w.useState(null),[U,L]=w.useState(!0),$=w.useCallback(async()=>{L(!0);try{const W=await pe(`/api/pharmacy-orders/${e}`);if(!W.ok)throw new Error("Failed to fetch order details");const V=await W.json();r(V),o({id:V.patientId,name:V.patientName||"N/A",token:V.patientTokenNumber}),I(V.prescriptionForUnavailableDrugs);const se=V.medications.map(re=>{const oe=F(re.unit),E=re.pack_quantity*(oe??1)+re.loose_quantity;return{...re,isLoose:!0,loosePacks:re.pack_quantity,looseUnits:re.loose_quantity,looseQuantity:E,pack_price:re.pack_price,loose_price:re.loose_price,total_price:re.total_price,pricePerLooseUnit:re.loose_price,originalPrice:re.pack_price,box_number:re.box_number,unit:re.unit,batch:re.batch,expiry_date:re.expiry_date,discount_percentage:re.discount_percentage}});u(se)}catch(W){k("Could not load order details. "+W.message)}finally{L(!1)}},[e]),z=w.useCallback(async()=>{try{const W=await pe("/api/drugs");if(!W.ok)throw new Error("Failed to fetch drugs");const V=await W.json();d(V)}catch(W){k("Could not load drug list. "+W.message)}},[]);w.useEffect(()=>{$(),z()},[$,z]),w.useEffect(()=>{if(!p){v([]);return}const W=p.toLowerCase();v(l.filter(V=>{const se=V.name&&V.name.toLowerCase().includes(W),re=V.brand_name&&V.brand_name.toLowerCase().includes(W);return se||re}).slice(0,10))},[p,l]);const F=W=>{if(!W)return null;const V=W.match(/(?:\d+x)?(\d+)/);return V?parseInt(V[1],10):null},Y=W=>{if(f.some(V=>V.drug_id===W.id)){k(`${W.name||W.brand_name} is already in the order.`),setTimeout(()=>k(null),3e3),g(""),v([]);return}u(V=>[...V,{drug_id:W.id,name:W.name||W.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,pack_price:Number(W.price)||0,loose_price:(Number(W.price)||0)/(F(W.unit)||1),total_price:(Number(W.price)||0)/(F(W.unit)||1),discount_percentage:0,directions_to_use:"",tabletsPerDay:1,numberOfDays:1,stock:W.quantity_in_stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(W.price)||0)/(F(W.unit)||1),originalPrice:Number(W.price)||0,unit:W.unit}]),g(""),v([])},R=W=>{u(V=>V.filter(se=>(se.drug_id??se.name)!==W))},B=(W,V)=>{u(se=>se.map(re=>{if((re.drug_id??re.name)===W&&re.isLoose){const oe=F(re.unit),E=Math.max(0,V),le=E*(oe??1)+(re.looseUnits??0);return{...re,loosePacks:E,looseQuantity:le,pack_quantity:E}}return re}))},G=(W,V)=>{u(se=>se.map(re=>{if((re.drug_id??re.name)===W&&re.isLoose){const oe=F(re.unit),E=Math.max(0,V),le=(re.loosePacks??0)*(oe??1)+E;return{...re,looseUnits:E,looseQuantity:le,loose_quantity:E}}return re}))},ie=async W=>{if(W.preventDefault(),k(null),P(!0),f.length===0&&!(M!=null&&M.trim())){k("Please add at least one medication or provide a prescription."),P(!1);return}const V=f.filter(re=>{const oe=re.looseQuantity??0;return oe<=0||re.stock!==void 0&&oe>re.stock});if(V.length>0){k(`Invalid quantity or insufficient stock for: ${V.map(re=>re.name).join(", ")}`),P(!1);return}const se={items:f.map(re=>({drug_id:re.drug_id??null,name:re.name,pack_quantity:re.loosePacks??0,loose_quantity:re.looseUnits??0,pack_price:re.pack_price??0,loose_price:re.loose_price??0,total_price:(re.loose_price??0)*(re.looseQuantity??0),discount_percentage:re.discount_percentage??0,directions_to_use:re.directions_to_use??null,tabletsPerDay:re.tabletsPerDay??1,numberOfDays:re.numberOfDays??1})),prescription_for_unavailable_drugs:M,order_total:te};try{const re=await pe(`/api/pharmacy-orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(se)});if(!re.ok){const oe=await re.json();throw new Error(oe.message||"Failed to update order")}alert("Pharmacy order updated successfully!"),n(-1)}catch(re){k(re.message||"Failed to update order. Please try again.")}finally{P(!1)}},te=w.useMemo(()=>f.reduce((W,V)=>{const se=V.loose_price??0,re=V.looseQuantity??0;return W+se*re},0),[f]);return U?i.jsx("div",{className:"p-6 flex justify-center items-center h-screen text-gray-500",children:"Loading order details..."}):t?i.jsxs("div",{className:"edit-pharmacy-order-container",children:[i.jsxs("div",{className:"page-header",children:[i.jsxs("div",{className:"header-left",children:[i.jsx("button",{onClick:()=>n(-1),className:"back-button",title:"Go Back",children:i.jsx(nn,{size:20})}),i.jsxs("h2",{className:"page-title",children:["EDIT ORDER ",i.jsxs("span",{className:"text-gray-500 text-lg font-normal ml-2",children:[a==null?void 0:a.name," #",t.id.substring(0,4)]})]})]}),i.jsx("div",{className:"header-right",children:i.jsx("span",{className:"status-badge",children:t.status.toUpperCase()})})]}),i.jsx("div",{className:"order-meta",children:i.jsxs("span",{className:"order-date",children:[" Order Date: ",new Date(t.date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})]})}),i.jsxs("form",{onSubmit:ie,className:"main-layout",children:[i.jsxs("div",{className:"left-column",children:[i.jsxs("div",{className:"card search-section",children:[i.jsx("div",{className:"card-header",children:i.jsx("h3",{children:" Find & Add Medication"})}),i.jsxs("div",{className:"search-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by name or brand...",value:p,onChange:W=>g(W.target.value),className:"search-input"}),p&&i.jsx("div",{className:"dropdown-results",children:b.length>0?i.jsx("ul",{children:b.map(W=>i.jsxs("li",{onClick:()=>Y(W),className:"dropdown-item",children:[i.jsx("span",{className:"drug-name",children:W.name||W.brand_name}),i.jsxs("span",{className:"drug-meta",children:["(Stock: ",W.quantity_in_stock??"N/A",", Price: ",Number(W.price||0).toFixed(2),")"]})]},W.id))}):i.jsxs("div",{className:"p-3 text-gray-500 text-sm",children:['No drugs found matching "',p,'"']})})]})]}),i.jsxs("div",{className:"card medications-list-section",children:[i.jsx("div",{className:"card-header",children:i.jsxs("h3",{children:[" Medications in Order ",i.jsxs("span",{className:"item-count",children:[f.length," items"]})]})}),f.length>0?i.jsxs("div",{className:"table-container",children:[i.jsxs("div",{className:"table-header-row",children:[i.jsx("div",{className:"col-medication",children:"MEDICATION"}),i.jsx("div",{className:"col-directions",children:"DIRECTIONS"}),i.jsx("div",{className:"col-quantity",children:"QUANTITY"}),i.jsx("div",{className:"col-subtotal",children:"SUBTOTAL"}),i.jsx("div",{className:"col-action"})]}),i.jsx("div",{className:"table-body",children:f.map(W=>{const V=W.drug_id??W.name;return i.jsxs("div",{className:"table-row",children:[i.jsxs("div",{className:"col-medication",children:[i.jsx("span",{className:"med-name",children:W.name}),W.unit&&i.jsx("span",{className:"med-unit text-xs text-gray-500 block",children:W.unit}),i.jsxs("div",{className:"stock-info",children:[" Stock: ",i.jsxs("span",{className:"stock-value",children:[" ",W.stock!==void 0?W.unit?`BOX OF ${F(W.unit)}`:W.stock:"N/A"]})]})]}),i.jsx("div",{className:"col-directions",children:i.jsx("input",{type:"text",placeholder:"1 tablet twice daily...",value:W.directions_to_use??"",onChange:se=>{const re=se.target.value;u(oe=>oe.map(E=>(E.drug_id??E.name)===V?{...E,directions_to_use:re}:E))},className:"directions-input"})}),i.jsx("div",{className:"col-quantity",children:i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsx("label",{style:{fontSize:"10px",fontWeight:"bold",color:"#9ca3af",display:"block",marginBottom:"2px"},children:"PACKS"}),i.jsx("input",{type:"number",min:"0",value:W.loosePacks??0,onChange:se=>B(V,parseInt(se.target.value)||0),className:"qty-input",style:{width:"100%",textAlign:"center"}})]}),i.jsxs("div",{style:{flex:1},children:[i.jsx("label",{style:{fontSize:"10px",fontWeight:"bold",color:"#9ca3af",display:"block",marginBottom:"2px"},children:"LOOSE"}),i.jsx("input",{type:"number",min:"0",value:W.looseUnits??0,onChange:se=>G(V,parseInt(se.target.value)||0),className:"qty-input",style:{width:"100%",textAlign:"center"}})]})]})}),i.jsxs("div",{className:"col-subtotal",children:["",(Number((W.pricePerLooseUnit??0)*(W.looseQuantity??0))||0).toFixed(2)]}),i.jsx("div",{className:"col-action",children:i.jsx("button",{type:"button",onClick:()=>R(V),className:"delete-btn",children:i.jsx(li,{size:16})})})]},V)})})]}):i.jsx("div",{className:"empty-state",children:"No medications added. Search above to add."})]})]}),i.jsxs("div",{className:"right-column",children:[i.jsxs("div",{className:"card notes-card",children:[i.jsx("div",{className:"card-header border-b-0 pb-2",children:i.jsx("h3",{children:" Prescription Notes"})}),i.jsx("textarea",{rows:3,value:M??"",onChange:W=>I(W.target.value||null),placeholder:"Add notes about unavailable drugs...",className:"notes-input"})]}),i.jsxs("button",{type:"submit",disabled:T,className:"confirm-btn",style:{width:"100%",margin:"20px 0 0 0"},children:[i.jsx("span",{className:"check-icon",children:""})," ",T?"Updating...":"Confirm Changes"]}),S&&i.jsx("div",{className:"error-alert mt-4",children:S})]})]})]}):i.jsx("div",{className:"p-6 text-red-500 flex justify-center items-center h-screen",children:"Order not found or failed to load."})},Mee=(e,n,t,r="non-black")=>{if(isNaN(e)||isNaN(n)||e<=0||n<=0)return null;let a;return t==="female"?e<=.7?a=141*Math.pow(e/.7,-.329)*Math.pow(.993,n):a=141*Math.pow(e/.7,-1.209)*Math.pow(.993,n):e<=.9?a=141*Math.pow(e/.9,-.411)*Math.pow(.993,n):a=141*Math.pow(e/.9,-1.209)*Math.pow(.993,n),r==="black"&&(a*=1.018),parseFloat(a.toFixed(2))},Oee=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0||t>=400)return null;const r=e-n-t/5;return parseFloat(r.toFixed(2))},Lee=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},Fee=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},$ee=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=e-(n+t);return parseFloat(r.toFixed(2))},zee=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=2*e+n/18+t/2.8;return parseFloat(r.toFixed(2))},T_=e=>["eGFR","LDL Cholesterol","Indirect Bilirubin","Globulin","Anion Gap","Osmolality"].includes(e),E_=()=>{var ce,ve;const{orderId:e}=Vi(),n=Et(),[t,r]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!0),[f,u]=w.useState(!1),[p,g]=w.useState(null),[b,v]=w.useState(null),[S,k]=w.useState(null),[T,P]=w.useState({}),[M,I]=w.useState(null),[U,L]=w.useState(!1),[$,z]=w.useState(""),[F,Y]=w.useState(!1),[R,B]=w.useState(""),G=w.useCallback(async X=>{var fe;try{const ae=await pe(`/api/patients/${X}`);if(!ae.ok)throw new Error(`Failed to fetch patient details: ${ae.status}`);const Me=await ae.json();v(Me.age),k(((fe=Me.sex)==null?void 0:fe.toLowerCase())==="female"?"female":"male"),Me.phone&&r(Ke=>Ke?{...Ke,Patient:{...Ke.Patient,phone:Me.phone}}:null)}catch(ae){console.error("Error fetching patient details:",ae),v(null),k(null)}},[]),ie=w.useCallback(async()=>{if(e){d(!0),g(null);try{const X=await pe(`/api/lab/${e}`);if(!X.ok){const Me=await X.json().catch(()=>({message:`HTTP error! status: ${X.status}`}));throw new Error(Me.message||`HTTP error! status: ${X.status}`)}const fe=await X.json();if(r(fe),fe.createdAt)try{const Me=new Date(fe.createdAt),Ke=new Date(Me.getTime()-Me.getTimezoneOffset()*6e4).toISOString().slice(0,16);z(Ke)}catch(Me){console.error("Error formatting date for edit:",Me)}if(fe.report_date)try{const Me=new Date(fe.report_date),Ke=new Date(Me.getTime()-Me.getTimezoneOffset()*6e4).toISOString().slice(0,16);B(Ke)}catch(Me){console.error("Error formatting report date for edit:",Me)}else{const Me=new Date,Ke=new Date(Me.getTime()-Me.getTimezoneOffset()*6e4).toISOString().slice(0,16);B(Ke)}fe.patient_id&&G(fe.patient_id);const ae={};if(fe.tests&&fe.tests.forEach(Me=>{ae[Me.id]={},Me.default_parameters&&Me.default_parameters.length>0?Me.default_parameters.forEach(Ke=>{ae[Me.id][Ke.name]=Ke.defaultValue}):ae[Me.id].report_content=""}),fe.report_content)try{const Me=JSON.parse(fe.report_content);typeof Me=="object"&&Me!==null&&!Array.isArray(Me)?o(Me):(console.warn("Legacy or unexpected report content format detected. Initializing with defaults."),o(ae))}catch{console.warn("Legacy report content detected (not JSON). Initializing with defaults."),o(ae)}else o({})}catch(X){console.error("Failed to fetch lab order details:",X),g(X instanceof Error?X.message:"An unknown error occurred while fetching order details.")}finally{d(!1)}}},[e,G]);w.useEffect(()=>{e?ie():(g("No Order ID provided in the URL."),d(!1))},[e,ie]);const te=(X,fe,ae)=>{o(Me=>{var Q,me,Ve,Qe,ot,kt,qt,be,ge,Te,De,ze,nt,mt,Nt,cn,gn,Cn,bt;const Ke={...Me,[X]:{...Me[X],[fe]:ae}},Z=parseFloat((Q=Ke[X])==null?void 0:Q.Creatinine),Ee=b,Ie=S;if(fe==="Creatinine"&&!isNaN(Z)&&Ee!==null&&Ie!==null){const yt=Mee(Z,Ee,Ie);yt!==null&&((me=t==null?void 0:t.tests.find(vt=>vt.id===X))!=null&&me.default_parameters.find(vt=>vt.name==="eGFR"))&&(Ke[X].eGFR=yt)}const Fe=parseFloat((Ve=Ke[X])==null?void 0:Ve["Total Cholesterol"]),rt=parseFloat((Qe=Ke[X])==null?void 0:Qe["HDL Cholesterol"]),lt=parseFloat((ot=Ke[X])==null?void 0:ot.Triglycerides);if((fe==="Total Cholesterol"||fe==="HDL Cholesterol"||fe==="Triglycerides")&&!isNaN(Fe)&&!isNaN(rt)&&!isNaN(lt)){const yt=Oee(Fe,rt,lt);yt!==null&&((kt=t==null?void 0:t.tests.find(vt=>vt.id===X))!=null&&kt.default_parameters.find(vt=>vt.name==="LDL Cholesterol"))&&(Ke[X]["LDL Cholesterol"]=yt)}const ct=parseFloat((qt=Ke[X])==null?void 0:qt["Total Bilirubin"]),st=parseFloat((be=Ke[X])==null?void 0:be["Direct Bilirubin"]);if((fe==="Total Bilirubin"||fe==="Direct Bilirubin")&&!isNaN(ct)&&!isNaN(st)){const yt=Lee(ct,st);yt!==null&&((ge=t==null?void 0:t.tests.find(vt=>vt.id===X))!=null&&ge.default_parameters.find(vt=>vt.name==="Indirect Bilirubin"))&&(Ke[X]["Indirect Bilirubin"]=yt)}const Ht=parseFloat((Te=Ke[X])==null?void 0:Te["Total Protein"]),rn=parseFloat((De=Ke[X])==null?void 0:De.Albumin);if((fe==="Total Protein"||fe==="Albumin")&&!isNaN(Ht)&&!isNaN(rn)){const yt=Fee(Ht,rn);yt!==null&&((ze=t==null?void 0:t.tests.find(vt=>vt.id===X))!=null&&ze.default_parameters.find(vt=>vt.name==="Globulin"))&&(Ke[X].Globulin=yt)}const je=parseFloat((nt=Ke[X])==null?void 0:nt.Sodium),qe=parseFloat((mt=Ke[X])==null?void 0:mt.Chloride),Be=parseFloat((Nt=Ke[X])==null?void 0:Nt.Bicarbonate);if((fe==="Sodium"||fe==="Chloride"||fe==="Bicarbonate")&&!isNaN(je)&&!isNaN(qe)&&!isNaN(Be)){const yt=$ee(je,qe,Be);yt!==null&&((cn=t==null?void 0:t.tests.find(vt=>vt.id===X))!=null&&cn.default_parameters.find(vt=>vt.name==="Anion Gap"))&&(Ke[X]["Anion Gap"]=yt)}const ke=parseFloat((gn=Ke[X])==null?void 0:gn.Glucose),we=parseFloat((Cn=Ke[X])==null?void 0:Cn.BUN);if((fe==="Sodium"||fe==="Glucose"||fe==="BUN")&&!isNaN(je)&&!isNaN(ke)&&!isNaN(we)){const yt=zee(je,ke,we);yt!==null&&((bt=t==null?void 0:t.tests.find(vt=>vt.id===X))!=null&&bt.default_parameters.find(vt=>vt.name==="Osmolality"))&&(Ke[X].Osmolality=yt)}return Ke})},W=async X=>{const fe=a[X]||{},ae=t==null?void 0:t.tests.find(Ee=>Ee.id===X);if(!ae)return;const Me={};ae.default_parameters&&ae.default_parameters.forEach(Ee=>{Me[Ee.name]=Ee.defaultValue});const Ke={...Me,...fe},Z={...a,[X]:Ke};o(Z),u(!0),g(null);try{const Ee=await pe(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(Z),isPartial:!0})});if(!Ee.ok)throw new Error(`Save failed: ${Ee.status}`);alert(`Report for ${ae.name} saved successfully!`)}catch(Ee){console.error("Error saving test report:",Ee),alert("Failed to save test report.")}finally{u(!1)}},V=(X=null)=>{I(X),setTimeout(()=>{window.print()},100)},se=()=>{t&&_w(t)},re=async()=>{if(!t||!t.tests){alert("Order details not loaded.");return}if(!e){alert("Cannot submit report without an Order ID.");return}const X={};if(t.tests.forEach(fe=>{const ae=a[fe.id]||{},Me={};fe.default_parameters&&fe.default_parameters.forEach(Ke=>{Ke.defaultValue!==void 0&&Ke.defaultValue!==null&&(Me[Ke.name]=Ke.defaultValue)}),X[fe.id]={...Me,...ae},(!fe.default_parameters||fe.default_parameters.length===0)&&!X[fe.id].report_content&&(X[fe.id].report_content="")}),Object.keys(X).length===0){alert("Report content cannot be empty.");return}o(X),u(!0),g(null);try{const fe=await pe(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(X)})});if(!fe.ok){const ae=await fe.json().catch(()=>({message:`Submission failed: ${fe.status}`}));throw new Error(ae.message||`Submission failed: ${fe.status}`)}alert("Report submitted successfully!"),n(-1)}catch(fe){console.error("Error submitting report:",fe),g(fe instanceof Error?fe.message:"An unknown error occurred during submission.")}finally{u(!1)}},oe=async()=>{if(!(!e||!$))try{const X=await pe(`/api/lab/orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:new Date($).toISOString()})});if(!X.ok)throw new Error("Failed to update date");const fe=await X.json();fe.order&&r(ae=>ae?{...ae,createdAt:fe.order.createdAt}:null),L(!1)}catch(X){console.error("Failed to update date:",X),alert("Failed to update date")}},E=async()=>{if(!(!e||!R))try{const X=await pe(`/api/lab/orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({reportDate:new Date(R).toISOString()})});if(!X.ok)throw new Error("Failed to update report date");const fe=await X.json();fe.order&&r(ae=>ae?{...ae,report_date:fe.order.report_date}:null),Y(!1)}catch(X){console.error("Failed to update report date:",X),alert("Failed to update report date")}};if(l)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",style:{textAlign:"center",padding:"50px"},children:[" ",i.jsxs("div",{className:"loading-text",children:[i.jsx(Ah,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading details..."]})]})});if(p&&!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card error-message-container",style:{textAlign:"center",padding:"30px"},children:[i.jsx(Er,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("h3",{className:"error-title",style:{borderBottom:"none"},children:"Error Loading Details"}),i.jsx("p",{className:"error-text",children:p}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"20px"},children:[i.jsx(nn,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});if(!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(Qo,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("p",{className:"no-data-message",style:{fontSize:"1.1em"},children:`Lab order not found for ID: ${e}.`}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"15px"},children:[i.jsx(nn,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});const le=(ce=t==null?void 0:t.Patient)==null?void 0:ce.name,ue=(ve=t==null?void 0:t.Patient)==null?void 0:ve.patient_token_number;return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"none",paddingBottom:0,marginBottom:0},children:[" ",i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:"Enter Lab Report"})," ",i.jsxs("button",{onClick:()=>n(e?"/lab":-1),className:"lab-inventory-button lab-inventory-button-secondary",disabled:f,children:[i.jsx(nn,{size:16,style:{marginRight:"5px"}}),e?"Back to Lab Panel":"Back"]}),i.jsxs("div",{style:{display:"flex",gap:"8px",marginLeft:"10px"},children:[i.jsxs("button",{onClick:()=>V(null),className:"lab-inventory-button",title:"Print Full Report",children:[i.jsx(Go,{size:16,style:{marginRight:"5px"}})," Print All"]}),i.jsxs("button",{onClick:se,className:"lab-inventory-button",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},title:"Share via WhatsApp",children:[i.jsx(o2,{size:16,style:{marginRight:"5px"}})," WhatsApp"]})]})]}),t&&i.jsxs("div",{className:"lab-inventory-card no-print",style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:[i.jsx(Qo,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}})," Order Summary"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"10px",fontSize:"0.95em"},children:[i.jsxs("div",{children:[i.jsx(Ko,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Patient:"})," ",le??"N/A"," (Token: ",ue??"N/A",")"]}),i.jsxs("div",{children:[i.jsx(IS,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Order Date:"})," ",U?i.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"5px"},children:[i.jsx("input",{type:"datetime-local",value:$,onChange:X=>z(X.target.value),className:"lab-inventory-input",style:{padding:"2px 5px",fontSize:"0.9em",width:"auto"}}),i.jsx("button",{onClick:oe,className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Save Date",children:i.jsx(Qx,{size:16,color:"green"})}),i.jsx("button",{onClick:()=>{if(L(!1),t.createdAt){const X=new Date(t.createdAt),fe=new Date(X.getTime()-X.getTimezoneOffset()*6e4).toISOString().slice(0,16);z(fe)}},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Cancel",children:i.jsx(Xn,{size:16,color:"red"})})]}):i.jsxs(i.Fragment,{children:[Rd(new Date(t.createdAt),"PPpp"),i.jsx("button",{onClick:()=>L(!0),className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"0 4px",minWidth:"auto",marginLeft:"8px",verticalAlign:"middle",border:"none"},title:"Edit Date",children:i.jsx(Gv,{size:14})})]})]}),i.jsxs("div",{children:[i.jsx(IS,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Report Date:"})," ",F?i.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"5px"},children:[i.jsx("input",{type:"datetime-local",value:R,onChange:X=>B(X.target.value),className:"lab-inventory-input",style:{padding:"2px 5px",fontSize:"0.9em",width:"auto"}}),i.jsx("button",{onClick:E,className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Save Report Date",children:i.jsx(Qx,{size:16,color:"green"})}),i.jsx("button",{onClick:()=>{if(Y(!1),t.report_date){const X=new Date(t.report_date),fe=new Date(X.getTime()-X.getTimezoneOffset()*6e4).toISOString().slice(0,16);B(fe)}else{const X=new Date,fe=new Date(X.getTime()-X.getTimezoneOffset()*6e4).toISOString().slice(0,16);B(fe)}},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Cancel",children:i.jsx(Xn,{size:16,color:"red"})})]}):i.jsxs(i.Fragment,{children:[t.report_date?Rd(new Date(t.report_date),"PPpp"):"Not Reported",i.jsx("button",{onClick:()=>Y(!0),className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"0 4px",minWidth:"auto",marginLeft:"8px",verticalAlign:"middle",border:"none"},title:"Edit Report Date",children:i.jsx(Gv,{size:14})})]})]}),i.jsxs("div",{style:{gridColumn:"1 / -1"},children:[i.jsx(tR,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Tests:"})," ",(t.tests||[]).map(X=>X.name).join(", ")]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:Bee(t.status),children:Uee(t.status)})]})]})]}),i.jsxs("div",{className:"lab-inventory-form-group no-print",style:{marginTop:"20px"},children:[i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:"Report Parameters"}),t==null?void 0:t.tests.map(X=>{var fe;return i.jsxs("div",{className:"lab-inventory-card",style:{marginBottom:"15px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"10px"},children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",margin:0},children:X.name}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[i.jsxs("button",{type:"button",onClick:ae=>{ae.stopPropagation(),W(X.id)},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"4px 8px",fontSize:"0.8em"},disabled:f,children:[i.jsx(Od,{size:14,style:{marginRight:"4px"}})," Save"]}),i.jsx("button",{type:"button",onClick:ae=>{ae.stopPropagation(),V(X.id)},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"4px 8px",fontSize:"0.8em",marginLeft:"5px"},title:"Print This Test Only",children:i.jsx(Go,{size:14})})]})]}),i.jsx("div",{className:"test-parameters-body",style:{display:"block"},children:X.default_parameters&&X.default_parameters.length>0?i.jsx(i.Fragment,{children:i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{className:"lab-inventory-table",style:{marginTop:"10px",width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{backgroundColor:"#f9fafb"},children:[i.jsx("th",{style:{width:"25%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Parameter"}),i.jsx("th",{style:{width:"35%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Result"}),i.jsx("th",{style:{width:"15%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Units"}),i.jsx("th",{style:{width:"25%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Normal Range"})]})}),i.jsx("tbody",{children:X.default_parameters.map(ae=>{var Me,Ke,Z,Ee,Ie,Fe,rt,lt,ct;return i.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[i.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#374151",fontWeight:"500"},children:i.jsx("label",{htmlFor:`${X.id}-${ae.name}`,style:{cursor:"pointer"},children:ae.name})}),i.jsx("td",{style:{padding:"10px",verticalAlign:"middle"},children:ae.type==="boolean"?i.jsxs("select",{id:`${X.id}-${ae.name}`,value:((Ke=(Me=a[X.id])==null?void 0:Me[ae.name])==null?void 0:Ke.toString())??"false",onChange:st=>te(X.id,ae.name,st.target.value==="true"),className:"lab-inventory-input",disabled:f,style:{margin:0,width:"100%"},children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-Reactive"})]}):i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[i.jsx("input",{id:`${X.id}-${ae.name}`,type:ae.type==="number"?"number":"text",value:((Z=a[X.id])==null?void 0:Z[ae.name])!==void 0?(Ee=a[X.id])==null?void 0:Ee[ae.name]:ae.defaultValue??"",onChange:st=>{const Ht=ae.type==="number"&&st.target.value===""?"":st.target.value;te(X.id,ae.name,Ht)},className:`lab-inventory-input ${ae.type==="number"&&((Ie=a[X.id])==null?void 0:Ie[ae.name])!==""&&(ae.lower_limit!=null&&parseFloat((Fe=a[X.id])==null?void 0:Fe[ae.name])<ae.lower_limit||ae.upper_limit!=null&&parseFloat((rt=a[X.id])==null?void 0:rt[ae.name])>ae.upper_limit)?"abnormal-result":""}`,disabled:f||T_(ae.name)&&!((lt=T[X.id])!=null&&lt[ae.name]),style:{margin:0,width:"100%"}}),T_(ae.name)&&i.jsx("button",{type:"button",onClick:()=>P(st=>{var Ht;return{...st,[X.id]:{...st[X.id]||{},[ae.name]:!((Ht=st[X.id])!=null&&Ht[ae.name])}}}),className:"lab-inventory-button lab-inventory-button-tertiary",style:{fontSize:"0.7em",padding:"4px 6px",height:"fit-content",whiteSpace:"nowrap"},disabled:f,title:(ct=T[X.id])!=null&&ct[ae.name]?"Disable Manual Edit":"Edit Calculated Field",children:i.jsx(Gv,{size:12})})]})}),i.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#6b7280"},children:ae.unit||"-"}),i.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#6b7280",fontSize:"0.9em"},children:ae.type==="number"&&(ae.lower_limit!==null||ae.upper_limit!==null)?i.jsxs(i.Fragment,{children:[ae.lower_limit!==null&&ae.lower_limit!==void 0&&`> ${ae.lower_limit}`,ae.lower_limit!==null&&ae.lower_limit!==void 0&&ae.upper_limit!==null&&ae.upper_limit!==void 0&&" - ",ae.upper_limit!==null&&ae.upper_limit!==void 0&&`< ${ae.upper_limit}`]}):"-"})]},ae.name)})})]})})}):i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:`${X.id}-report_content`,children:"Report Content"}),i.jsx("textarea",{id:`${X.id}-report_content`,value:((fe=a[X.id])==null?void 0:fe.report_content)??"",onChange:ae=>te(X.id,"report_content",ae.target.value),className:"lab-inventory-input",rows:5,placeholder:`Enter report for ${X.name}...`,disabled:f})]})})]},X.id)}),p&&i.jsxs("p",{className:"error-text",style:{marginTop:"10px"},children:[i.jsx(Er,{size:15,className:"inline mr-1"}),p]})]}),i.jsxs("div",{className:"no-print",style:{marginTop:"20px",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[" ",i.jsx("button",{type:"button",onClick:()=>n(-1),disabled:f,className:"lab-inventory-button lab-inventory-button-secondary",children:"Cancel"}),i.jsx("button",{type:"button",onClick:re,disabled:f,className:"lab-inventory-button",children:f?i.jsxs(i.Fragment,{children:[i.jsx(Ah,{className:"animate-spin mr-2",size:16})," Submitting..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Od,{size:16,style:{marginRight:"5px"}})," Submit Full Report"]})})]}),i.jsxs("div",{className:"printable-only",children:[t&&t.Patient&&i.jsxs("div",{style:{marginBottom:"20px",borderBottom:"1px solid #ccc",paddingBottom:"10px"},children:[i.jsx("h2",{style:{textAlign:"center",marginBottom:"15px"},children:"Lab Report"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",fontSize:"12px"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Patient Name:"})," ",t.Patient.name]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Age/Sex:"})," ",b??"N/A"," / ",S??"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Ref. Doctor:"})," ",t.uploaded_by||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Date:"})," ",Rd(new Date,"PPpp")]})]})]}),t==null?void 0:t.tests.filter(X=>M===null||X.id===M).map(X=>{var fe;return i.jsxs("div",{style:{marginBottom:"20px",pageBreakInside:"avoid"},children:[i.jsx("h3",{style:{borderBottom:"1px solid #eee",paddingBottom:"5px"},children:X.name}),X.default_parameters&&X.default_parameters.length>0?i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{backgroundColor:"#f9f9f9"},children:[i.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Parameter"}),i.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Result"}),i.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Units"}),i.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Normal Range"})]})}),i.jsx("tbody",{children:X.default_parameters.map(ae=>{var Fe;const Me=(Fe=a[X.id])==null?void 0:Fe[ae.name],Ke=typeof Me=="string"?parseFloat(Me):typeof Me=="number"?Me:NaN,Z=ae.type==="number"&&!isNaN(Ke)&&Me!==""&&(ae.lower_limit!=null&&Ke<ae.lower_limit||ae.upper_limit!=null&&Ke>ae.upper_limit),Ee=ae.type==="boolean"&&(Me===!0||Me==="true"),Ie=ae.type==="boolean"?Me===!0||Me==="true"?"Reactive":"Non-Reactive":Me??"";return i.jsxs("tr",{children:[i.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:ae.name}),i.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee",fontWeight:Z||Ee?"bold":"normal",color:Z?"red":Ee?"green":"inherit"},children:Ie}),i.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:ae.unit??""}),i.jsxs("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:[ae.lower_limit!==null&&ae.lower_limit!==void 0&&`> ${ae.lower_limit}`,ae.lower_limit!==null&&ae.lower_limit!==void 0&&ae.upper_limit!==null&&ae.upper_limit!==void 0&&" - ",ae.upper_limit!==null&&ae.upper_limit!==void 0&&`< ${ae.upper_limit}`]})]},ae.name)})})]}):i.jsx("div",{style:{whiteSpace:"pre-wrap",fontSize:"12px",padding:"10px"},children:((fe=a[X.id])==null?void 0:fe.report_content)||"No report content entered."})]},X.id)})]})]})})},Uee=e=>e?e.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()):"Unknown",Bee=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},qee=()=>{const{orderId:e}=Vi(),n=Et(),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),f=w.useCallback(async p=>{if(!p){d("No Order ID specified in the URL."),o(!1),r(null);return}o(!0),d(null),r(null);try{console.log(`Fetching order details for ID: ${p}`);const g=await pe(`/api/lab/orders/${p}/report`);if(!g.ok){let v;try{v=await g.json()}catch{v={message:`Server returned status ${g.status}`}}throw console.error("Fetch order details error response:",v),new Error(v.message||`Failed to fetch order details: ${g.status}`)}const b=await g.json();if(console.log("Received order data:",b),!b)throw console.error("Invalid order data structure:",b),new Error("Invalid order data received from server.");r(b)}catch(g){console.error("Error fetching order details:",g),d(g instanceof Error?g.message:"An unknown error occurred while fetching the order details")}finally{o(!1)}},[pe]);w.useEffect(()=>{f(e)},[e,f]);const u=()=>{t&&_w(t)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:0,paddingBottom:0,borderBottom:"none"},children:[i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:"Lab Report Viewer"})," ",i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs(ds,{to:"/lab/search-report",className:"lab-inventory-button","aria-label":"Search for other reports",children:[i.jsx(ua,{size:16,style:{marginRight:"5px"}}),"Search Reports"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(nn,{size:16,style:{marginRight:"5px"}}),"Back"]}),i.jsxs("button",{onClick:()=>window.print(),className:"lab-inventory-button","aria-label":"Print report",children:[i.jsx(Go,{size:16,style:{marginRight:"5px"}}),"Print"]}),i.jsxs("button",{onClick:u,className:"lab-inventory-button","aria-label":"Share report via WhatsApp",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},children:[i.jsx(o2,{size:16,style:{marginRight:"5px"}}),"WhatsApp"]})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:["Report Details (Order ID: ",e||"None Specified",")"]}),a&&i.jsx("div",{className:"loading-text",children:"Loading report..."}),l&&!a&&i.jsxs("div",{className:"error-message-container",style:{textAlign:"center"},children:[i.jsx(Er,{size:48}),i.jsx("h3",{className:"error-title",children:"Error Loading Report"}),i.jsx("p",{children:l}),e&&i.jsx("button",{onClick:()=>f(e),className:"retry-button",children:"Retry"})]}),i.jsxs("div",{className:"printable-section",children:[!a&&!l&&(t==null?void 0:t.Patient)&&i.jsxs("div",{className:"lab-inventory-card",style:{marginBottom:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(Ko,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Patient Information"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"10px",fontSize:"0.9em"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Name:"})," ",t.Patient.name||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Age:"})," ",t.Patient.age??"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Gender:"})," ",t.Patient.gender||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Token No:"})," ",t.Patient.patient_token_number||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Patient ID:"})," ",t.Patient.id]}),t.Patient.phone&&i.jsxs("div",{children:[i.jsx("strong",{children:"Phone:"})," ",t.Patient.phone]})]})]}),!a&&!l&&(t==null?void 0:t.report_content)&&i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(lu,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Report Findings"]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6"},children:(()=>{try{const p=JSON.parse(t.report_content||"{}");return typeof p=="object"&&p!==null&&t.tests?t.tests.map(g=>i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em"},children:g.name}),p[g.id]?i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Parameter"}),i.jsx("th",{children:"Value"}),i.jsx("th",{children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(p[g.id]).map(([b,v])=>{var I;const S=(I=g.default_parameters)==null?void 0:I.find(U=>U.name===b),k=typeof v=="string"?parseFloat(v):typeof v=="number"?v:NaN,T=(S==null?void 0:S.type)==="number"&&!isNaN(k)&&(S.lower_limit!=null&&k<S.lower_limit||S.upper_limit!=null&&k>S.upper_limit),P=(S==null?void 0:S.type)==="boolean"?v===!0||v==="true"?"Reactive":"Non-Reactive":String(v),M=(S==null?void 0:S.type)==="boolean"&&(v===!0||v==="true");return i.jsxs("tr",{children:[i.jsx("td",{children:b}),i.jsxs("td",{className:`${T?"abnormal-result":""} ${M?"reactive-result":""}`,children:[P," ",S==null?void 0:S.unit]}),i.jsx("td",{children:S&&S.type==="number"&&(S.lower_limit!==null||S.upper_limit!==null)?i.jsxs(i.Fragment,{children:[S.lower_limit!=null&&` > ${S.lower_limit}`,S.lower_limit!=null&&S.upper_limit!=null&&" - ",S.upper_limit!=null&&` < ${S.upper_limit}`,S.unit&&` ${S.unit}`]}):((S==null?void 0:S.type)==="boolean","N/A")})]},b)})})]}):i.jsx("p",{children:"No parameters reported for this test."})]},g.id)):i.jsx(Yo,{remarkPlugins:[Bs],children:t.report_content})}catch{return i.jsx(Yo,{remarkPlugins:[Bs],children:t.report_content||"*No findings recorded.*"})}})()})]})]}),!a&&!l&&!(t!=null&&t.report_content)&&!(t!=null&&t.Patient)&&e&&i.jsxs("div",{className:"no-data-message",children:["No report content or patient details found for Order ID: ",e,". The order might be processing, does not exist, or the ID is incorrect."]}),!e&&!a&&!l&&i.jsxs("div",{className:"no-data-message",children:["No order ID specified in the URL.",i.jsx(ds,{to:"/lab/search-report",className:"lab-inventory-link",style:{display:"block",marginTop:"10px"},children:"Go to Search Page"})]})]})]})})},Vee=()=>{const e=Et(),[n,t]=w.useState(""),[r,a]=w.useState(!1),[o,l]=w.useState([]),[d,f]=w.useState(null),[u,p]=w.useState(n);w.useEffect(()=>{const k=setTimeout(()=>{p(n)},500);return()=>{clearTimeout(k)}},[n]),w.useEffect(()=>{g()},[u]);const g=async()=>{const k=n.trim();if(!k){l([]),f(null);return}a(!0),f(null),l([]),console.log(`Searching for: ${k}`);try{const T=await pe("/api/lab");if(!T.ok){let $;try{$=await T.json()}catch{$={message:`Server returned status ${T.status}`}}throw console.error("Search fetch error response:",$),new Error($.message||`HTTP error! status: ${T.status}`)}const{orders:P}=await T.json();console.log("Received lab orders for search:",P);const I=P.filter($=>!!$.report_content).map($=>{var z,F;return{id:$.id,labTokenNumber:String($.lab_token_number??"N/A"),patientName:((z=$.Patient)==null?void 0:z.name)||"N/A",patientId:$.patient_id,patientTokenNumber:String(((F=$.Patient)==null?void 0:F.patient_token_number)??"N/A"),tests:($.tests||[]).map(Y=>Y.name||"Unknown Test"),date:Rd(new Date($.createdAt),"yyyy-MM-dd"),status:$.status}}),U=n.toLowerCase(),L=I.filter($=>{var Y,R,B,G,ie;const z=String($.labTokenNumber).toLowerCase(),F=String($.patientTokenNumber).toLowerCase();return(((Y=$.patientName)==null?void 0:Y.toLowerCase())||"").includes(U)||z.includes(U)||F.includes(U)||(((B=(R=$.tests)==null?void 0:R.join(" "))==null?void 0:B.toLowerCase())||"").includes(U)||(((G=$.id)==null?void 0:G.toLowerCase())||"").includes(U)||(((ie=$.patientId)==null?void 0:ie.toLowerCase())||"").includes(U)});console.log("Filtered search results:",L),l(L),L.length===0&&k?f(`No matching reports found for "${k}".`):f(null)}catch(T){console.error("Failed to search lab reports:",T),f(T instanceof Error?T.message:"An unknown error occurred during search")}finally{a(!1)}},b=k=>{console.log(`Result clicked, navigating to view report for order ID: ${k}`),e(`/lab/view-report/${k}`)},v=k=>{switch(k){case"pending":return{text:"Sample Pending",color:"text-red-600 bg-red-100"};case"collected":return{text:"Sample Collected",color:"text-yellow-600 bg-yellow-100"};case"processing":return{text:"Processing",color:"text-blue-600 bg-blue-100"};case"completed":return{text:"Completed",color:"text-green-600 bg-green-100"};case"cancelled":return{text:"Cancelled",color:"text-gray-600 bg-gray-100 line-through"};case"reported":return{text:"Reported",color:"text-purple-600 bg-purple-100"};default:return{text:k,color:"text-gray-600 bg-gray-100"}}},S=k=>{switch(k){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h2",{style:{margin:0},children:"Search Lab Reports"}),i.jsxs("button",{onClick:()=>e(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(nn,{size:16,style:{marginRight:"5px"}}),"Back"]})]}),i.jsxs("div",{className:"lab-inventory-form-group",style:{marginTop:"20px",position:"relative"},children:[i.jsx("label",{htmlFor:"report-search",children:"Enter Search Term"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",position:"relative"},children:[i.jsx(ua,{size:20,style:{position:"absolute",left:"10px",color:"#777"}}),i.jsx("input",{id:"report-search",type:"text",placeholder:"Patient name, ID, token, report ID, test name...",value:n,onChange:k=>t(k.target.value),className:"lab-inventory-input",style:{paddingLeft:"40px",marginBottom:"0"}})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[r&&i.jsx("div",{className:"loading-text",children:"Searching..."}),d&&!r&&i.jsxs("div",{className:"error-text",children:[i.jsx(Er,{size:20,className:"inline mr-2"})," ",d]}),o.length>0&&!r&&i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:o.map(k=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(k.id),style:{marginBottom:"15px",cursor:"pointer",padding:"15px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:[i.jsx(II,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}}),k.patientName," (Token: ",k.patientTokenNumber,")"]}),i.jsx("span",{className:S(k.status),children:v(k.status).text})]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:[i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(lu,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Order ID: ",k.id]}),i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(GR,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Tests: ",k.tests.join(", ")]}),i.jsxs("div",{children:[i.jsx(vI,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Date: ",k.date]})]})]},k.id))}),!r&&o.length===0&&!d&&n.trim()&&i.jsxs("div",{className:"no-data-message",children:['No results found for "',n,'".']}),!r&&o.length===0&&!d&&!n.trim()&&i.jsx("div",{className:"no-data-message",style:{backgroundColor:"transparent",border:"none",textAlign:"left",padding:"5px 0"},children:"Enter a search term above to find lab reports."})]})]})})},Hee=()=>{const{patientId:e}=Vi(),n=Et(),[t,r]=w.useState([]),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(null),[p,g]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){d("Patient ID is missing from the URL."),o(!1);return}o(!0),d(null),r([]),g(null);try{const S=await pe(`/api/patients/${e}`);if(S.ok){const P=await S.json();g(P.name||`Patient ID: ${e}`)}else console.warn(`Failed to fetch patient name for ID ${e}`),g(`Patient ID: ${e}`);const k=await pe(`/api/lab/patient/${e}`);if(!k.ok){const P=await k.json().catch(()=>({}));throw new Error(P.message||`HTTP error! status: ${k.status}`)}const T=await k.json();r(T||[])}catch(S){console.error("Error fetching data:",S),d(`Failed to load data: ${S.message}`)}finally{o(!1)}})()},[e]);const b=v=>{v.report_content?n(`/lab/view-report/${v.id}`):n(`/lab/enter-report/${v.id}`)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("h2",{style:{margin:0},children:["Lab Reports ",p?`for ${p}`:`for Patient ID: ${e}`]}),i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs("button",{onClick:async()=>{if(!e){alert("Patient ID is missing. Cannot create a new report.");return}try{const v=await pe("/api/lab/create-empty-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:e})});if(!v.ok){const k=await v.json().catch(()=>({message:`Failed to create new lab order: ${v.status}`}));throw new Error(k.message||`Failed to create new lab order: ${v.status}`)}const S=await v.json();n(`/lab/enter-report/${S.newOrderId}`)}catch(v){console.error("Error creating new lab order:",v),alert(`Error creating new lab order: ${v.message}`)}},className:"lab-inventory-button",disabled:!e,title:e?"Enter a new lab report for this patient":"Patient ID missing",children:[i.jsx(us,{size:16,style:{marginRight:"5px"}}),"Enter New Report"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",children:[i.jsx(nn,{size:16,style:{marginRight:"5px"}}),"Back"]})]})]}),i.jsx("div",{style:{marginTop:"20px"},children:a?i.jsxs("div",{className:"loading-text",children:[i.jsx(Ah,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading reports..."]}):l?i.jsxs("div",{className:"error-text",style:{textAlign:"center",padding:"20px"},children:[i.jsx(QR,{size:40,style:{marginBottom:"10px",color:"#721c24"}}),i.jsx("h3",{style:{fontSize:"1.2em",color:"#721c24",margin:"10px 0"},children:"Error Loading Reports"}),i.jsx("p",{children:l})]}):t.length===0?i.jsxs("div",{className:"no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(lu,{size:48,className:"mb-3",style:{margin:"0 auto 15px auto",display:"block"}}),i.jsx("p",{children:"No lab reports found for this patient."}),i.jsxs("p",{children:["You can ",i.jsx(ds,{to:`/lab/create-order/${e}`,className:"lab-inventory-link",children:"create a new lab order"}),"."]})]}):f?i.jsxs("div",{className:"lab-inventory-card",style:{backgroundColor:"#fdfdfd"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.3em",borderBottom:"none",margin:0},children:["Report from: ",f.report_date?Rd(new Date(f.report_date),"PPP p"):"N/A"]}),i.jsxs("button",{onClick:()=>u(null),className:"lab-inventory-button lab-inventory-button-secondary",style:{fontSize:"0.9em",padding:"8px 12px"},children:[i.jsx(nn,{size:16,style:{marginRight:"5px"}})," Back to List"]})]}),i.jsxs("p",{style:{marginBottom:"15px",fontSize:"1em"},children:[i.jsx("strong",{children:"Tests Ordered:"})," ",(f.tests||[]).map(v=>v.name).join(", ")]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6",border:"1px solid #eee",padding:"15px",borderRadius:"4px",background:"#fff"},children:i.jsx(Yo,{remarkPlugins:[Bs],children:f.report_content||"*No findings recorded.*"})})]}):i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:t.map(v=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(v),tabIndex:0,onKeyPress:S=>S.key==="Enter"&&b(v),style:{marginBottom:"15px",cursor:"pointer",padding:"15px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx(lu,{size:24,style:{marginRight:"15px",color:"#007bff"}}),i.jsxs("div",{children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:["Order Date: ",Rd(new Date(v.createdAt),"PPP")]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:["Tests: ",v.tests&&v.tests.length>0?v.tests.map(S=>S.name).join(", "):"N/A"]})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[v.status&&i.jsx("span",{className:Yee(v.status),children:Gee(v.status)}),i.jsx($h,{size:20,style:{color:"#6c757d"}})]})]},v.id))})})]})})},Gee=e=>{if(!e)return"Unknown";switch(e.toLowerCase()){case"pending":return"Pending Sample";case"collected":return"Sample Collected";case"processing":return"Processing";case"report_ready":return"Report Ready";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return e.charAt(0).toUpperCase()+e.slice(1)}},Yee=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},mA=()=>{const e=Et(),[n,t]=w.useState("pharmacy");return i.jsxs("div",{className:"inventory-management-container",style:{padding:"20px",backgroundColor:"var(--background-color)",minHeight:"100vh"},children:[i.jsxs("div",{className:"inventory-header",style:{marginBottom:"20px",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"15px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsx("button",{onClick:()=>e(-1),className:"action-icon-button",title:"Go Back",style:{background:"none",border:"none",cursor:"pointer",color:"var(--text-primary)"},children:i.jsx(nn,{size:24})}),i.jsx("h1",{style:{margin:0,fontSize:"1.8rem",fontWeight:"700",color:"var(--text-primary)"},children:"Inventory Management"})]}),i.jsxs("div",{className:"inventory-tabs",style:{display:"flex",gap:"5px",backgroundColor:"var(--card-bg, #f3f4f6)",padding:"5px",borderRadius:"12px",border:"1px solid var(--border-color, #e5e7eb)"},children:[i.jsxs("button",{onClick:()=>t("pharmacy"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 24px",border:"1px solid",borderColor:n==="pharmacy"?"var(--primary-color-20, #e0e7ff)":"transparent",borderRadius:"8px",backgroundColor:n==="pharmacy"?"var(--card-bg-active, #fff)":"transparent",boxShadow:n==="pharmacy"?"0 2px 4px rgba(0,0,0,0.05)":"none",color:n==="pharmacy"?"var(--primary-color)":"var(--text-secondary, #6b7280)",fontWeight:n==="pharmacy"?"600":"500",cursor:"pointer",transition:"all 0.2s ease",fontSize:"0.95rem"},children:[i.jsx(ig,{size:18}),"Pharmacy Stock"]}),i.jsxs("button",{onClick:()=>t("lab"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 24px",border:"1px solid",borderColor:n==="lab"?"var(--primary-color-20, #e0e7ff)":"transparent",borderRadius:"8px",backgroundColor:n==="lab"?"var(--card-bg-active, #fff)":"transparent",boxShadow:n==="lab"?"0 2px 4px rgba(0,0,0,0.05)":"none",color:n==="lab"?"var(--primary-color)":"var(--text-secondary, #6b7280)",fontWeight:n==="lab"?"600":"500",cursor:"pointer",transition:"all 0.2s ease",fontSize:"0.95rem"},children:[i.jsx(Wl,{size:18}),"Lab Stock"]})]})]}),i.jsx("div",{className:"inventory-content",style:{backgroundColor:"var(--card-bg, #fff)",borderRadius:"16px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",overflow:"hidden"},children:n==="pharmacy"?i.jsx(iT,{isEmbedded:!0}):i.jsx(jw,{isEmbedded:!0})})]})},Wee=({fetchWithAuth:e})=>{const n=Et(),[t,r]=w.useState(!0),[a,o]=w.useState([]),[l,d]=w.useState(null),[f,u]=w.useState(null),p=w.useCallback(async()=>{r(!0),d(null);try{const S=await(await e("/staff")).json();o(S.map(k=>({...k,id:k._id||k.id})))}catch(v){d(`Failed to load staff data: ${v.message}`),o([])}finally{r(!1)}},[e]);w.useEffect(()=>{p()},[p]),w.useEffect(()=>{if(f){const v=setTimeout(()=>u(null),5e3);return()=>clearTimeout(v)}},[f]);const g=v=>{switch(v){case"doctor":return"admin-pill-info";case"receptionist":return"admin-pill-success";case"pharmacy":return"admin-pill-primary";case"lab":return"admin-pill-warning";case"admin":return"admin-pill-neutral";default:return"admin-pill-neutral"}},b=v=>{switch(v){case"doctor":return i.jsx(l2,{size:16,className:"mr-2 text-blue-600"});case"receptionist":return i.jsx(ow,{size:16,className:"mr-2 text-green-600"});case"pharmacy":return i.jsx(ig,{size:16,className:"mr-2 text-purple-600"});case"lab":return i.jsx(Wl,{size:16,className:"mr-2 text-yellow-600"});case"admin":return i.jsx(wb,{size:16,className:"mr-2 text-teal-600"});default:return i.jsx(zh,{size:16,className:"mr-2 text-gray-500"})}};return t?i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:[" ",i.jsx("div",{className:"breathing-ball",style:{width:"30px",height:"30px"}})," "]}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Staff..."})]})}):i.jsxs("div",{className:"staff-page-container",children:[f&&i.jsxs("div",{className:`mb-4 p-3 rounded-md flex items-center ${f.type==="success"?"bg-green-100 border border-green-400 text-green-700":"bg-red-100 border border-red-400 text-red-700"}`,role:"alert",children:[f.type==="success"?i.jsx(fs,{size:18,className:"mr-2"}):i.jsx(Er,{size:18,className:"mr-2"}),i.jsx("span",{children:f.message}),i.jsx("button",{onClick:()=>u(null),className:"ml-auto text-xl font-bold",children:""})]}),l&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",role:"alert",children:[i.jsx(Er,{size:18,className:"mr-2 text-red-500"}),l,i.jsx("button",{onClick:()=>d(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"p-2 rounded-md hover:bg-gray-200",children:i.jsx(nn,{size:20})}),i.jsx("h1",{className:"text-2xl font-bold",children:"Manage Staff"})]}),i.jsxs("button",{onClick:()=>n("/dashboard/staff/add"),className:"bg-teal-600 text-white px-4 py-2 rounded-md hover:bg-teal-700 flex items-center",children:[i.jsx(Ql,{size:16,className:"mr-2"})," Add New Staff"]})]}),i.jsx("div",{className:"staff-table-container",children:i.jsxs("table",{className:"staff-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{className:"hidden md:table-cell",children:"Email"}),i.jsx("th",{children:"Role"}),i.jsx("th",{className:"hidden md:table-cell",children:"OPD Fee ()"}),i.jsx("th",{className:"hidden md:table-cell",children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:a.length===0&&!t?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-4",children:"No staff members found."})}):a.map(v=>i.jsxs("tr",{children:[i.jsx("td",{children:v.name}),i.jsx("td",{className:"hidden md:table-cell",children:v.email}),i.jsx("td",{children:i.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g(v.role)}`,children:[b(v.role),v.role.charAt(0).toUpperCase()+v.role.slice(1)]})}),i.jsx("td",{className:"hidden md:table-cell",children:v.role==="doctor"?v.opd_fee?parseFloat(String(v.opd_fee)).toFixed(2):"Not Set":"N/A"}),i.jsx("td",{className:"hidden md:table-cell",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.status==="active"?"Active":"Inactive"})}),i.jsx("td",{className:"actions",children:i.jsxs("button",{onClick:()=>n(`/dashboard/staff/edit/${v.id}`),className:"edit-link",disabled:v.role==="admin",title:"Edit Staff",children:[i.jsx(cu,{size:16})," Edit"]})})]},v.id))})]})})]})},Qee=()=>{var k,T,P,M,I,U,L,$,z,F,Y,R,B,G;const{patientId:e,billId:n}=Vi(),t=Et(),[r,a]=w.useState(null),[o,l]=w.useState(!0),[d,f]=w.useState(null),[u,p]=w.useState(""),[g,b]=w.useState("cash"),v=((k=r==null?void 0:r.patient)==null?void 0:k.insurance_type)==="no_cash_insurance";w.useEffect(()=>{b(v?"no_cash_insurance":"cash")},[v]),w.useEffect(()=>{n?(async()=>{l(!0),f(null);try{const te=await pe(`/api/bills/${n}`);if(!te.ok)throw new Error(`HTTP error! status: ${te.status}`);const W=await te.json();if(!W||!W.bill||!W.calculated)throw new Error("Incomplete data structure received from backend (missing bill or calculated fields).");if(W.bill.type!=="admission")throw console.error("Fetched bill is not an admission bill. Bill Type:",W.bill.type),new Error(`Unexpected bill type received: ${W.bill.type}. Expected 'admission'.`);console.log("Raw API data received:",JSON.stringify(W,null,2));const V=Array.isArray(W.admissionPayments)?W.admissionPayments:[];console.log("Processed admissionPaymentsData:",V);const se={...W.bill,amount:W.bill.amount,AdmissionPayments:V,calculated:W.calculated,patient:W.bill.Patient?{id:W.bill.Patient.id,name:W.bill.Patient.name,admission_date:W.bill.Patient.admission_date,discharge_date:W.bill.Patient.discharge_date}:void 0};console.log("Setting billDetails state to:",JSON.stringify(se,null,2)),a(se)}catch(te){console.error("Failed to fetch admission bill details:",te),f(te instanceof Error?te.message:"An unknown error occurred")}finally{l(!1)}})():(f("Bill ID is missing."),l(!1))},[n,e]);const S=async ie=>{var te;if(ie.preventDefault(),!e||!u||isNaN(parseFloat(u))||parseFloat(u)<=0||parseFloat(u)>(((te=r==null?void 0:r.calculated)==null?void 0:te.balance)??0)){f("Please enter a valid payment amount within the balance due. Patient ID must be present.");return}f(null);try{const W=await pe(`/api/patients/${e}/admission-payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount_paid:parseFloat(u),payment_mode:g})});if(!W.ok){const re=await W.json();throw new Error(re.message||`HTTP error! status: ${W.status}`)}const se=await(await pe(`/api/bills/${n}`)).json();if(se&&se.bill&&se.calculated&&se.admissionPayments)a({...se.bill,amount:parseFloat(se.bill.amount),AdmissionPayments:se.admissionPayments,calculated:se.calculated,patient:se.bill.Patient?{id:se.bill.Patient.id,name:se.bill.Patient.name,admission_date:se.bill.Patient.admission_date,discharge_date:se.bill.Patient.discharge_date}:void 0});else throw new Error("Invalid data structure received after payment submission.");p("")}catch(W){console.error("Failed to submit payment:",W),f(W instanceof Error?W.message:"Failed to record payment")}};return o?i.jsx("div",{className:"p-4",children:"Loading admission bill details..."}):d?i.jsxs("div",{className:"p-4 text-red-600",children:["Error: ",d]}):!r||!r.calculated?i.jsx("div",{className:"p-4",children:"No bill details found or data is incomplete."}):i.jsx("div",{className:"admission-page-container",children:i.jsxs("div",{className:"admission-section",children:[" ",i.jsxs("div",{className:"p-4 border-b",children:[" ",i.jsxs("h2",{className:"admission-header",children:["Admission Billing Details (Bill #",r.id,")"]}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Patient: ",((T=r.patient)==null?void 0:T.name)??"N/A"," (ID: ",r.patient_id,")"]})," ",i.jsxs("p",{className:"text-sm text-gray-600",children:["Admission Date: ",(P=r.patient)!=null&&P.admission_date?new Date(r.patient.admission_date).toLocaleDateString():"N/A"]}),((M=r.patient)==null?void 0:M.discharge_date)&&i.jsxs("p",{className:"text-sm text-gray-600",children:["Discharge Date: ",new Date(r.patient.discharge_date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm",children:["Status: ",i.jsx("span",{className:`font-semibold ${r.status==="paid"?"text-green-600":"text-orange-600"}`,children:((I=r.status)==null?void 0:I.toUpperCase())??"UNKNOWN"})]})]}),i.jsxs("div",{className:"p-4",children:[" ",i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Initial Charges:"})," ",i.jsxs("span",{children:["",(parseFloat((r==null?void 0:r.amount)||"0")||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Days Stayed:"})," ",i.jsx("span",{children:((U=r==null?void 0:r.calculated)==null?void 0:U.daysStayed)??0})]}),i.jsxs("p",{className:"flex justify-between text-sm font-semibold mt-2 pt-2 border-t",children:[i.jsx("span",{children:"Total Due:"})," ",i.jsxs("span",{children:["",(Number((L=r==null?void 0:r.calculated)==null?void 0:L.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[i.jsx("span",{children:"Total Paid:"})," ",i.jsxs("span",{children:["",(Number(($=r==null?void 0:r.calculated)==null?void 0:$.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-lg font-bold mt-1 text-red-600",children:[i.jsx("span",{children:"Balance Due:"})," ",i.jsxs("span",{children:["",(Number((z=r==null?void 0:r.calculated)==null?void 0:z.balance)||0).toFixed(2)]})]})]})]}),(r==null?void 0:r.status)!=="paid"&&(Number((F=r==null?void 0:r.calculated)==null?void 0:F.balance)||0)>0&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title text-blue-800",children:"Record New Payment"}),i.jsxs("form",{onSubmit:S,className:"space-y-4",children:[i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentAmount",className:"admission-label",children:"Amount Paid ()"}),i.jsx("input",{id:"paymentAmount",type:"number",value:u,onChange:ie=>p(ie.target.value),placeholder:`Max ${(Number((Y=r==null?void 0:r.calculated)==null?void 0:Y.balance)||0).toFixed(2)}`,required:!0,min:"0.01",step:"0.01",max:Number((R=r==null?void 0:r.calculated)==null?void 0:R.balance)||0,className:"admission-input"})]}),i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentMode",className:"admission-label",children:"Payment Mode"}),i.jsxs("select",{id:"paymentMode",value:g,onChange:ie=>b(ie.target.value),className:"admission-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"upi",children:"UPI"}),v&&i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),i.jsx("button",{type:"submit",className:"admission-button",disabled:o||!u||parseFloat(u)<=0||parseFloat(u)>(Number((B=r==null?void 0:r.calculated)==null?void 0:B.balance)||0)||v&&g!=="no_cash_insurance",children:"Record Payment"})]})]})]}),i.jsx("h3",{className:"admission-section-title mt-6 border-t pt-4",children:"Admission Payment History"}),Array.isArray(r==null?void 0:r.AdmissionPayments)&&r.AdmissionPayments.length>0?i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"admission-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Payment ID"}),i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Mode"})]})}),i.jsx("tbody",{children:(G=r==null?void 0:r.AdmissionPayments)==null?void 0:G.map(ie=>{if(!ie||typeof ie!="object")return null;let te="Invalid Date";try{ie.payment_date&&!isNaN(new Date(ie.payment_date).getTime())&&(te=new Date(ie.payment_date).toLocaleString())}catch(W){console.error("Error formatting payment date:",ie.payment_date,W)}return i.jsxs("tr",{children:[" ",i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ie.id??"N/A"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:te}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["",(Number(ie.amount_paid)||0).toFixed(2)]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:ie.payment_mode??"N/A"})]},ie.id??Math.random())})})]})]}):i.jsx("p",{className:"text-gray-500 text-sm",children:"No payments recorded yet."})]}),i.jsxs("div",{className:"p-4 border-t bg-gray-50 text-right",children:[" ",i.jsx("button",{type:"button",onClick:()=>t(-1),className:"admission-button admission-button-secondary",children:"Back"})]})]})})};var Jee=Object.defineProperty,yb=Object.getOwnPropertySymbols,gA=Object.prototype.hasOwnProperty,yA=Object.prototype.propertyIsEnumerable,A_=(e,n,t)=>n in e?Jee(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,Q1=(e,n)=>{for(var t in n||(n={}))gA.call(n,t)&&A_(e,t,n[t]);if(yb)for(var t of yb(n))yA.call(n,t)&&A_(e,t,n[t]);return e},J1=(e,n)=>{var t={};for(var r in e)gA.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&yb)for(var r of yb(e))n.indexOf(r)<0&&yA.call(e,r)&&(t[r]=e[r]);return t};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var zd;(e=>{const n=class pn{constructor(f,u,p,g){if(this.version=f,this.errorCorrectionLevel=u,this.modules=[],this.isFunction=[],f<pn.MIN_VERSION||f>pn.MAX_VERSION)throw new RangeError("Version value out of range");if(g<-1||g>7)throw new RangeError("Mask value out of range");this.size=f*4+17;let b=[];for(let S=0;S<this.size;S++)b.push(!1);for(let S=0;S<this.size;S++)this.modules.push(b.slice()),this.isFunction.push(b.slice());this.drawFunctionPatterns();const v=this.addEccAndInterleave(p);if(this.drawCodewords(v),g==-1){let S=1e9;for(let k=0;k<8;k++){this.applyMask(k),this.drawFormatBits(k);const T=this.getPenaltyScore();T<S&&(g=k,S=T),this.applyMask(k)}}a(0<=g&&g<=7),this.mask=g,this.applyMask(g),this.drawFormatBits(g),this.isFunction=[]}static encodeText(f,u){const p=e.QrSegment.makeSegments(f);return pn.encodeSegments(p,u)}static encodeBinary(f,u){const p=e.QrSegment.makeBytes(f);return pn.encodeSegments([p],u)}static encodeSegments(f,u,p=1,g=40,b=-1,v=!0){if(!(pn.MIN_VERSION<=p&&p<=g&&g<=pn.MAX_VERSION)||b<-1||b>7)throw new RangeError("Invalid value");let S,k;for(S=p;;S++){const I=pn.getNumDataCodewords(S,u)*8,U=l.getTotalBits(f,S);if(U<=I){k=U;break}if(S>=g)throw new RangeError("Data too long")}for(const I of[pn.Ecc.MEDIUM,pn.Ecc.QUARTILE,pn.Ecc.HIGH])v&&k<=pn.getNumDataCodewords(S,I)*8&&(u=I);let T=[];for(const I of f){t(I.mode.modeBits,4,T),t(I.numChars,I.mode.numCharCountBits(S),T);for(const U of I.getData())T.push(U)}a(T.length==k);const P=pn.getNumDataCodewords(S,u)*8;a(T.length<=P),t(0,Math.min(4,P-T.length),T),t(0,(8-T.length%8)%8,T),a(T.length%8==0);for(let I=236;T.length<P;I^=253)t(I,8,T);let M=[];for(;M.length*8<T.length;)M.push(0);return T.forEach((I,U)=>M[U>>>3]|=I<<7-(U&7)),new pn(S,u,M,b)}getModule(f,u){return 0<=f&&f<this.size&&0<=u&&u<this.size&&this.modules[u][f]}getModules(){return this.modules}drawFunctionPatterns(){for(let p=0;p<this.size;p++)this.setFunctionModule(6,p,p%2==0),this.setFunctionModule(p,6,p%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const f=this.getAlignmentPatternPositions(),u=f.length;for(let p=0;p<u;p++)for(let g=0;g<u;g++)p==0&&g==0||p==0&&g==u-1||p==u-1&&g==0||this.drawAlignmentPattern(f[p],f[g]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(f){const u=this.errorCorrectionLevel.formatBits<<3|f;let p=u;for(let b=0;b<10;b++)p=p<<1^(p>>>9)*1335;const g=(u<<10|p)^21522;a(g>>>15==0);for(let b=0;b<=5;b++)this.setFunctionModule(8,b,r(g,b));this.setFunctionModule(8,7,r(g,6)),this.setFunctionModule(8,8,r(g,7)),this.setFunctionModule(7,8,r(g,8));for(let b=9;b<15;b++)this.setFunctionModule(14-b,8,r(g,b));for(let b=0;b<8;b++)this.setFunctionModule(this.size-1-b,8,r(g,b));for(let b=8;b<15;b++)this.setFunctionModule(8,this.size-15+b,r(g,b));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let f=this.version;for(let p=0;p<12;p++)f=f<<1^(f>>>11)*7973;const u=this.version<<12|f;a(u>>>18==0);for(let p=0;p<18;p++){const g=r(u,p),b=this.size-11+p%3,v=Math.floor(p/3);this.setFunctionModule(b,v,g),this.setFunctionModule(v,b,g)}}drawFinderPattern(f,u){for(let p=-4;p<=4;p++)for(let g=-4;g<=4;g++){const b=Math.max(Math.abs(g),Math.abs(p)),v=f+g,S=u+p;0<=v&&v<this.size&&0<=S&&S<this.size&&this.setFunctionModule(v,S,b!=2&&b!=4)}}drawAlignmentPattern(f,u){for(let p=-2;p<=2;p++)for(let g=-2;g<=2;g++)this.setFunctionModule(f+g,u+p,Math.max(Math.abs(g),Math.abs(p))!=1)}setFunctionModule(f,u,p){this.modules[u][f]=p,this.isFunction[u][f]=!0}addEccAndInterleave(f){const u=this.version,p=this.errorCorrectionLevel;if(f.length!=pn.getNumDataCodewords(u,p))throw new RangeError("Invalid argument");const g=pn.NUM_ERROR_CORRECTION_BLOCKS[p.ordinal][u],b=pn.ECC_CODEWORDS_PER_BLOCK[p.ordinal][u],v=Math.floor(pn.getNumRawDataModules(u)/8),S=g-v%g,k=Math.floor(v/g);let T=[];const P=pn.reedSolomonComputeDivisor(b);for(let I=0,U=0;I<g;I++){let L=f.slice(U,U+k-b+(I<S?0:1));U+=L.length;const $=pn.reedSolomonComputeRemainder(L,P);I<S&&L.push(0),T.push(L.concat($))}let M=[];for(let I=0;I<T[0].length;I++)T.forEach((U,L)=>{(I!=k-b||L>=S)&&M.push(U[I])});return a(M.length==v),M}drawCodewords(f){if(f.length!=Math.floor(pn.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let u=0;for(let p=this.size-1;p>=1;p-=2){p==6&&(p=5);for(let g=0;g<this.size;g++)for(let b=0;b<2;b++){const v=p-b,k=(p+1&2)==0?this.size-1-g:g;!this.isFunction[k][v]&&u<f.length*8&&(this.modules[k][v]=r(f[u>>>3],7-(u&7)),u++)}}a(u==f.length*8)}applyMask(f){if(f<0||f>7)throw new RangeError("Mask value out of range");for(let u=0;u<this.size;u++)for(let p=0;p<this.size;p++){let g;switch(f){case 0:g=(p+u)%2==0;break;case 1:g=u%2==0;break;case 2:g=p%3==0;break;case 3:g=(p+u)%3==0;break;case 4:g=(Math.floor(p/3)+Math.floor(u/2))%2==0;break;case 5:g=p*u%2+p*u%3==0;break;case 6:g=(p*u%2+p*u%3)%2==0;break;case 7:g=((p+u)%2+p*u%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[u][p]&&g&&(this.modules[u][p]=!this.modules[u][p])}}getPenaltyScore(){let f=0;for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[b][T]==v?(S++,S==5?f+=pn.PENALTY_N1:S>5&&f++):(this.finderPenaltyAddHistory(S,k),v||(f+=this.finderPenaltyCountPatterns(k)*pn.PENALTY_N3),v=this.modules[b][T],S=1);f+=this.finderPenaltyTerminateAndCount(v,S,k)*pn.PENALTY_N3}for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[T][b]==v?(S++,S==5?f+=pn.PENALTY_N1:S>5&&f++):(this.finderPenaltyAddHistory(S,k),v||(f+=this.finderPenaltyCountPatterns(k)*pn.PENALTY_N3),v=this.modules[T][b],S=1);f+=this.finderPenaltyTerminateAndCount(v,S,k)*pn.PENALTY_N3}for(let b=0;b<this.size-1;b++)for(let v=0;v<this.size-1;v++){const S=this.modules[b][v];S==this.modules[b][v+1]&&S==this.modules[b+1][v]&&S==this.modules[b+1][v+1]&&(f+=pn.PENALTY_N2)}let u=0;for(const b of this.modules)u=b.reduce((v,S)=>v+(S?1:0),u);const p=this.size*this.size,g=Math.ceil(Math.abs(u*20-p*10)/p)-1;return a(0<=g&&g<=9),f+=g*pn.PENALTY_N4,a(0<=f&&f<=2568888),f}getAlignmentPatternPositions(){if(this.version==1)return[];{const f=Math.floor(this.version/7)+2,u=this.version==32?26:Math.ceil((this.version*4+4)/(f*2-2))*2;let p=[6];for(let g=this.size-7;p.length<f;g-=u)p.splice(1,0,g);return p}}static getNumRawDataModules(f){if(f<pn.MIN_VERSION||f>pn.MAX_VERSION)throw new RangeError("Version number out of range");let u=(16*f+128)*f+64;if(f>=2){const p=Math.floor(f/7)+2;u-=(25*p-10)*p-55,f>=7&&(u-=36)}return a(208<=u&&u<=29648),u}static getNumDataCodewords(f,u){return Math.floor(pn.getNumRawDataModules(f)/8)-pn.ECC_CODEWORDS_PER_BLOCK[u.ordinal][f]*pn.NUM_ERROR_CORRECTION_BLOCKS[u.ordinal][f]}static reedSolomonComputeDivisor(f){if(f<1||f>255)throw new RangeError("Degree out of range");let u=[];for(let g=0;g<f-1;g++)u.push(0);u.push(1);let p=1;for(let g=0;g<f;g++){for(let b=0;b<u.length;b++)u[b]=pn.reedSolomonMultiply(u[b],p),b+1<u.length&&(u[b]^=u[b+1]);p=pn.reedSolomonMultiply(p,2)}return u}static reedSolomonComputeRemainder(f,u){let p=u.map(g=>0);for(const g of f){const b=g^p.shift();p.push(0),u.forEach((v,S)=>p[S]^=pn.reedSolomonMultiply(v,b))}return p}static reedSolomonMultiply(f,u){if(f>>>8||u>>>8)throw new RangeError("Byte out of range");let p=0;for(let g=7;g>=0;g--)p=p<<1^(p>>>7)*285,p^=(u>>>g&1)*f;return a(p>>>8==0),p}finderPenaltyCountPatterns(f){const u=f[1];a(u<=this.size*3);const p=u>0&&f[2]==u&&f[3]==u*3&&f[4]==u&&f[5]==u;return(p&&f[0]>=u*4&&f[6]>=u?1:0)+(p&&f[6]>=u*4&&f[0]>=u?1:0)}finderPenaltyTerminateAndCount(f,u,p){return f&&(this.finderPenaltyAddHistory(u,p),u=0),u+=this.size,this.finderPenaltyAddHistory(u,p),this.finderPenaltyCountPatterns(p)}finderPenaltyAddHistory(f,u){u[0]==0&&(f+=this.size),u.pop(),u.unshift(f)}};n.MIN_VERSION=1,n.MAX_VERSION=40,n.PENALTY_N1=3,n.PENALTY_N2=3,n.PENALTY_N3=40,n.PENALTY_N4=10,n.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],n.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=n;function t(d,f,u){if(f<0||f>31||d>>>f)throw new RangeError("Value out of range");for(let p=f-1;p>=0;p--)u.push(d>>>p&1)}function r(d,f){return(d>>>f&1)!=0}function a(d){if(!d)throw new Error("Assertion error")}const o=class yr{constructor(f,u,p){if(this.mode=f,this.numChars=u,this.bitData=p,u<0)throw new RangeError("Invalid argument");this.bitData=p.slice()}static makeBytes(f){let u=[];for(const p of f)t(p,8,u);return new yr(yr.Mode.BYTE,f.length,u)}static makeNumeric(f){if(!yr.isNumeric(f))throw new RangeError("String contains non-numeric characters");let u=[];for(let p=0;p<f.length;){const g=Math.min(f.length-p,3);t(parseInt(f.substring(p,p+g),10),g*3+1,u),p+=g}return new yr(yr.Mode.NUMERIC,f.length,u)}static makeAlphanumeric(f){if(!yr.isAlphanumeric(f))throw new RangeError("String contains unencodable characters in alphanumeric mode");let u=[],p;for(p=0;p+2<=f.length;p+=2){let g=yr.ALPHANUMERIC_CHARSET.indexOf(f.charAt(p))*45;g+=yr.ALPHANUMERIC_CHARSET.indexOf(f.charAt(p+1)),t(g,11,u)}return p<f.length&&t(yr.ALPHANUMERIC_CHARSET.indexOf(f.charAt(p)),6,u),new yr(yr.Mode.ALPHANUMERIC,f.length,u)}static makeSegments(f){return f==""?[]:yr.isNumeric(f)?[yr.makeNumeric(f)]:yr.isAlphanumeric(f)?[yr.makeAlphanumeric(f)]:[yr.makeBytes(yr.toUtf8ByteArray(f))]}static makeEci(f){let u=[];if(f<0)throw new RangeError("ECI assignment value out of range");if(f<128)t(f,8,u);else if(f<16384)t(2,2,u),t(f,14,u);else if(f<1e6)t(6,3,u),t(f,21,u);else throw new RangeError("ECI assignment value out of range");return new yr(yr.Mode.ECI,0,u)}static isNumeric(f){return yr.NUMERIC_REGEX.test(f)}static isAlphanumeric(f){return yr.ALPHANUMERIC_REGEX.test(f)}getData(){return this.bitData.slice()}static getTotalBits(f,u){let p=0;for(const g of f){const b=g.mode.numCharCountBits(u);if(g.numChars>=1<<b)return 1/0;p+=4+b+g.bitData.length}return p}static toUtf8ByteArray(f){f=encodeURI(f);let u=[];for(let p=0;p<f.length;p++)f.charAt(p)!="%"?u.push(f.charCodeAt(p)):(u.push(parseInt(f.substring(p+1,p+3),16)),p+=2);return u}};o.NUMERIC_REGEX=/^[0-9]*$/,o.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,o.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let l=o;e.QrSegment=o})(zd||(zd={}));(e=>{(n=>{const t=class{constructor(a,o){this.ordinal=a,this.formatBits=o}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),n.Ecc=t})(e.QrCode||(e.QrCode={}))})(zd||(zd={}));(e=>{(n=>{const t=class{constructor(a,o){this.modeBits=a,this.numBitsCharCount=o}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),n.Mode=t})(e.QrSegment||(e.QrSegment={}))})(zd||(zd={}));var Nh=zd;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Kee={L:Nh.QrCode.Ecc.LOW,M:Nh.QrCode.Ecc.MEDIUM,Q:Nh.QrCode.Ecc.QUARTILE,H:Nh.QrCode.Ecc.HIGH},xA=128,bA="L",vA="#FFFFFF",wA="#000000",SA=!1,NA=1,Xee=4,Zee=0,ete=.1;function CA(e,n=0){const t=[];return e.forEach(function(r,a){let o=null;r.forEach(function(l,d){if(!l&&o!==null){t.push(`M${o+n} ${a+n}h${d-o}v1H${o+n}z`),o=null;return}if(d===r.length-1){if(!l)return;o===null?t.push(`M${d+n},${a+n} h1v1H${d+n}z`):t.push(`M${o+n},${a+n} h${d+1-o}v1H${o+n}z`);return}l&&o===null&&(o=d)})}),t.join("")}function jA(e,n){return e.slice().map((t,r)=>r<n.y||r>=n.y+n.h?t:t.map((a,o)=>o<n.x||o>=n.x+n.w?a:!1))}function tte(e,n,t,r){if(r==null)return null;const a=e.length+t*2,o=Math.floor(n*ete),l=a/n,d=(r.width||o)*l,f=(r.height||o)*l,u=r.x==null?e.length/2-d/2:r.x*l,p=r.y==null?e.length/2-f/2:r.y*l,g=r.opacity==null?1:r.opacity;let b=null;if(r.excavate){let S=Math.floor(u),k=Math.floor(p),T=Math.ceil(d+u-S),P=Math.ceil(f+p-k);b={x:S,y:k,w:T,h:P}}const v=r.crossOrigin;return{x:u,y:p,h:f,w:d,excavation:b,opacity:g,crossOrigin:v}}function nte(e,n){return n!=null?Math.max(Math.floor(n),0):e?Xee:Zee}function _A({value:e,level:n,minVersion:t,includeMargin:r,marginSize:a,imageSettings:o,size:l,boostLevel:d}){let f=jn.useMemo(()=>{const S=(Array.isArray(e)?e:[e]).reduce((k,T)=>(k.push(...Nh.QrSegment.makeSegments(T)),k),[]);return Nh.QrCode.encodeSegments(S,Kee[n],t,void 0,void 0,d)},[e,n,t,d]);const{cells:u,margin:p,numCells:g,calculatedImageSettings:b}=jn.useMemo(()=>{let v=f.getModules();const S=nte(r,a),k=v.length+S*2,T=tte(v,l,S,o);return{cells:v,margin:S,numCells:k,calculatedImageSettings:T}},[f,l,o,r,a]);return{qrcode:f,margin:p,cells:u,numCells:g,calculatedImageSettings:b}}var rte=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),Mh=jn.forwardRef(function(n,t){const r=n,{value:a,size:o=xA,level:l=bA,bgColor:d=vA,fgColor:f=wA,includeMargin:u=SA,minVersion:p=NA,boostLevel:g,marginSize:b,imageSettings:v}=r,k=J1(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:T}=k,P=J1(k,["style"]),M=v==null?void 0:v.src,I=jn.useRef(null),U=jn.useRef(null),L=jn.useCallback(te=>{I.current=te,typeof t=="function"?t(te):t&&(t.current=te)},[t]),[$,z]=jn.useState(!1),{margin:F,cells:Y,numCells:R,calculatedImageSettings:B}=_A({value:a,level:l,minVersion:p,boostLevel:g,includeMargin:u,marginSize:b,imageSettings:v,size:o});jn.useEffect(()=>{if(I.current!=null){const te=I.current,W=te.getContext("2d");if(!W)return;let V=Y;const se=U.current,re=B!=null&&se!==null&&se.complete&&se.naturalHeight!==0&&se.naturalWidth!==0;re&&B.excavation!=null&&(V=jA(Y,B.excavation));const oe=window.devicePixelRatio||1;te.height=te.width=o*oe;const E=o/R*oe;W.scale(E,E),W.fillStyle=d,W.fillRect(0,0,R,R),W.fillStyle=f,rte?W.fill(new Path2D(CA(V,F))):Y.forEach(function(le,ue){le.forEach(function(D,ce){D&&W.fillRect(ce+F,ue+F,1,1)})}),B&&(W.globalAlpha=B.opacity),re&&W.drawImage(se,B.x+F,B.y+F,B.w,B.h)}}),jn.useEffect(()=>{z(!1)},[M]);const G=Q1({height:o,width:o},T);let ie=null;return M!=null&&(ie=jn.createElement("img",{src:M,key:M,style:{display:"none"},onLoad:()=>{z(!0)},ref:U,crossOrigin:B==null?void 0:B.crossOrigin})),jn.createElement(jn.Fragment,null,jn.createElement("canvas",Q1({style:G,height:o,width:o,ref:L,role:"img"},P)),ie)});Mh.displayName="QRCodeCanvas";var ite=jn.forwardRef(function(n,t){const r=n,{value:a,size:o=xA,level:l=bA,bgColor:d=vA,fgColor:f=wA,includeMargin:u=SA,minVersion:p=NA,boostLevel:g,title:b,marginSize:v,imageSettings:S}=r,k=J1(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:T,cells:P,numCells:M,calculatedImageSettings:I}=_A({value:a,level:l,minVersion:p,boostLevel:g,includeMargin:u,marginSize:v,imageSettings:S,size:o});let U=P,L=null;S!=null&&I!=null&&(I.excavation!=null&&(U=jA(P,I.excavation)),L=jn.createElement("image",{href:S.src,height:I.h,width:I.w,x:I.x+T,y:I.y+T,preserveAspectRatio:"none",opacity:I.opacity,crossOrigin:I.crossOrigin}));const $=CA(U,T);return jn.createElement("svg",Q1({height:o,width:o,viewBox:`0 0 ${M} ${M}`,ref:t,role:"img"},k),!!b&&jn.createElement("title",null,b),jn.createElement("path",{fill:d,d:`M0,0 h${M}v${M}H0z`,shapeRendering:"crispEdges"}),jn.createElement("path",{fill:f,d:$,shapeRendering:"crispEdges"}),L)});ite.displayName="QRCodeSVG";const ate=e=>{switch(e){case"pending":return{text:"text-orange-700",bg:"bg-orange-100"};case"billed":return{text:"text-blue-700",bg:"bg-blue-100"};case"dispensed":return{text:"text-green-700",bg:"bg-green-100"};case"cancelled":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},ste=()=>{const{orderId:e}=Vi(),n=Et(),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),[p,g]=w.useState({}),[b,v]=w.useState(""),[S,k]=w.useState(""),[T,P]=w.useState("cash"),M=w.useMemo(()=>(t==null?void 0:t.medications.reduce((B,G)=>{const ie=G.total_price??0,te=ie*(G.discount_percentage??0)/100;return B+ie-te},0))??0,[t==null?void 0:t.medications]),I=5,U=w.useMemo(()=>!t||!t.medications?0:t.medications.reduce((B,G,ie)=>{var oe,E;const te=G.drug_id??`index-${ie}`,W=((oe=p[te])==null?void 0:oe.pack)||0,V=((E=p[te])==null?void 0:E.loose)||0,se=G.pack_price??0,re=G.loose_price??0;return B+W*se+V*re},0),[t,p]),L=w.useCallback(async()=>{if(!e){d("Order ID is missing."),o(!1);return}o(!0),d(null);try{const B=await pe(`/api/pharmacy-orders/${e}`);if(!B.ok)throw B.status===404?new Error(`Order with ID ${e} not found.`):new Error(`Failed to fetch order details: ${B.statusText} (${B.status})`);const G=await B.json();console.log("Fetched order data after return:",G);const te=G.medications.map(V=>V.pack_price&&V.loose_price&&V.loose_price>0?{...V,unitsPerPack:Math.round(V.pack_price/V.loose_price)}:{...V,unitsPerPack:0}).map(V=>({...V,discount_percentage:V.discount_percentage??0}));r({...G,medications:te});const W={};te.forEach((V,se)=>{const re=V.drug_id??`index-${se}`;W[re]={pack:0,loose:0}}),g(W)}catch(B){console.error("Failed to fetch order details:",B),d(B.message||"Failed to load order details.")}finally{o(!1)}},[e]);w.useEffect(()=>{L()},[L]),w.useEffect(()=>{(async()=>{try{const G=await pe("/api/clinics/settings");if(!G.ok)throw new Error("Failed to fetch clinic settings");const ie=await G.json();console.log("Fetched clinic settings:",ie),v(ie.upi_id||"")}catch(G){console.error("Error fetching clinic settings:",G)}})()},[]),w.useEffect(()=>{if((t==null?void 0:t.order_total)!==void 0&&t.order_total>0&&b){const B=`upi://pay?pa=${b}&pn=ClinicName&am=${t.order_total.toFixed(2)}&cu=INR`;k(B)}else k("")},[t==null?void 0:t.order_total,b]);const $=(B,G)=>{r(ie=>{if(!ie)return null;const te=ie.medications.map((V,se)=>(V.drug_id??`index-${se}`)===B?{...V,discount_percentage:isNaN(G)?0:G}:V),W=te.reduce((V,se)=>{const re=se.total_price??0,oe=re*(se.discount_percentage??0)/100;return V+re-oe},0);return{...ie,medications:te,order_total:W}})},z=(B,G,ie)=>{g(te=>{const W=ie.unitsPerPack||0,se=ie.pack_quantity*W+ie.loose_quantity,re=Math.max(0,Math.min(G,se));let oe=0,E=re;return W>0&&(oe=Math.floor(re/W),E=re%W),{...te,[B]:{pack:oe,loose:E}}})},F=async()=>{const B=t==null?void 0:t.medications.map((G,ie)=>{var se,re;const te=G.drug_id??`index-${ie}`,W=((se=p[te])==null?void 0:se.pack)||0,V=((re=p[te])==null?void 0:re.loose)||0;return W>0||V>0?{drug_id:G.drug_id,name:G.name,pack_quantity:G.pack_quantity,loose_quantity:G.loose_quantity,returnPackQuantity:W,returnLooseQuantity:V}:null}).filter(G=>G!==null);if(!B||B.length===0){alert("Please select a quantity greater than 0 for at least one item to return.");return}if(!e){alert("Order ID is missing. Cannot process return.");return}if(!B){alert("Could not prepare items for return.");return}u(!0),d(null);try{const G=await pe(`/api/pharmacy-orders/${e}/return`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemsToReturn:B})}),ie=await G.json();if(!G.ok)throw new Error(ie.message||`Failed to process return: ${G.statusText}`);alert("Return processed successfully! Stock has been updated.");const te={};t==null||t.medications.forEach((W,V)=>{const se=W.drug_id??`index-${V}`;te[se]={pack:0,loose:0}}),g(te),L()}catch(G){console.error("Failed to process return:",G),d(G.message||"An error occurred while processing the return."),alert(`Error processing return: ${G.message||"Unknown error"}`)}finally{u(!1)}};if(a)return i.jsx("div",{className:"text-center p-6 text-gray-500 animate-pulse",children:"Loading Order Details..."});if(l)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(nn,{size:14,className:"mr-1.5"})," Back"]}),i.jsxs("div",{className:"bg-red-50 border border-red-300 text-red-700 rounded p-4",children:["Error: ",l]})]});if(!t)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(nn,{size:14,className:"mr-1.5"})," Back"]}),i.jsx("div",{className:"text-center py-10 px-4 text-gray-500 bg-white rounded-lg shadow",children:"Order details could not be loaded."})]});const Y=()=>{window.print()},R=ate(t.status);return i.jsx("div",{className:"pharmacy-order-details-page",children:i.jsxs("div",{className:"order-details-container printable-section",children:[i.jsxs("div",{className:"order-details-header no-print",children:[i.jsx("h1",{children:"Pharmacy Order Details"}),i.jsxs("div",{className:"actions",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:[i.jsx(nn,{size:18})," Back to Queue"]}),i.jsxs("button",{onClick:Y,className:"print-button",children:[i.jsx(Go,{size:18})," Print Bill"]})]})]}),i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{children:"Mahajan Pharmacy"}),i.jsxs("div",{className:"clinic-details-print",children:[i.jsx("span",{className:"small-text clinic-address",children:"D.No: 3-1-289, Plot No. 101, Kabela Center, RR Nagar, Vijayawada  520012."}),i.jsx("span",{className:"small-text clinic-notes",children:"Phone: 93919 44733"}),i.jsx("span",{className:"small-text clinic-license",children:"Licence No:RLF20AP2025003328"})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Patient Name:"})," RESHMA"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Token:"})," 12"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Order Date:"})," 31/10/2025"]})]})]}),i.jsxs("div",{className:"order-info-section no-print",children:[i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Order ID:"})," ",t.id]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Patient:"})," ",t.patientName||"N/A"," (",t.patientTokenNumber||"N/A",")"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Date:"})," ",new Date(t.date).toLocaleString()]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Prescribed By:"})," ",t.prescribedBy||"N/A"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:`status-pill ${R.text} ${R.bg}`,children:t.status})]})]}),i.jsxs("div",{className:"medications-section",children:[i.jsx("h2",{children:"Medications Ordered"}),t.medications.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"PACK QTY"}),i.jsx("th",{children:"PACK PRICE"}),i.jsx("th",{children:"LOOSE QTY"}),i.jsx("th",{children:"LOOSE PRICE"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"no-print",children:"RETURN PACK QTY"}),i.jsx("th",{className:"no-print",children:"RETURN LOOSE QTY"})]})]})}),i.jsx("tbody",{children:t.medications.map((B,G)=>{var oe,E,le,ue,D,ce;const ie=B.drug_id??`index-${G}`,te=B.total_price??0,W=te*(B.discount_percentage??0)/100,V=te-W,se=((oe=p[ie])==null?void 0:oe.pack)||0,re=((E=p[ie])==null?void 0:E.loose)||0;return i.jsxs("tr",{children:[i.jsx("td",{children:B.name}),i.jsx("td",{children:B.pack_quantity??0}),i.jsx("td",{children:((le=B.pack_price)==null?void 0:le.toFixed(2))??"N/A"}),i.jsx("td",{children:B.loose_quantity??0}),i.jsx("td",{children:((ue=B.loose_price)==null?void 0:ue.toFixed(2))??"N/A"}),i.jsx("td",{children:((D=B.price)==null?void 0:D.toFixed(2))??"N/A"})," ",i.jsx("td",{children:((ce=B.price)==null?void 0:ce.toFixed(2))??"N/A"})," ",i.jsxs("td",{children:[i.jsx("input",{type:"number",value:B.discount_percentage??0,onChange:ve=>$(ie,parseFloat(ve.target.value)),min:"0",max:"100",className:"discount-input-table no-print"}),i.jsxs("span",{className:"print-only",children:[B.discount_percentage??0,"%"]})]}),i.jsxs("td",{children:[I.toFixed(1),"%"]}),i.jsx("td",{children:V.toFixed(2)}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:B.pack_quantity,value:se,onChange:ve=>{const fe=(parseInt(ve.target.value,10)||0)*(B.unitsPerPack||0)+re;z(ie,fe,B)},className:"return-quantity-input"})}),i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:B.loose_quantity+B.pack_quantity*(B.unitsPerPack||0)-se*(B.unitsPerPack||0),value:re,onChange:ve=>{const X=parseInt(ve.target.value,10)||0,fe=se*(B.unitsPerPack||0)+X;z(ie,fe,B)},className:"return-quantity-input"})})]})]},ie)})})]}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No medications listed for this order."})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",M.toFixed(2)]})}),i.jsxs("div",{className:"order-total-section no-print",children:[i.jsx("span",{className:"total-label",children:"Order Total:"}),i.jsxs("span",{className:"total-amount",children:["",M.toFixed(2)]})]}),i.jsxs("div",{className:"payment-section no-print",children:[i.jsxs("div",{className:"payment-mode-group",children:[i.jsx("label",{htmlFor:"paymentMode",children:"Payment Mode:"}),i.jsxs("select",{id:"paymentMode",value:T,onChange:B=>P(B.target.value),className:"payment-mode-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),S&&i.jsxs("div",{className:"qr-code-container",children:[i.jsx(Mh,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]})]}),(t.status==="dispensed"||t.status==="billed")&&t.medications.length>0&&i.jsxs("div",{className:"return-action-section no-print",children:[U>0&&i.jsxs("div",{className:"total-refund-display",children:["Total Refund: ",U.toFixed(2)]}),i.jsx("button",{onClick:F,disabled:Object.values(p).every(B=>B.pack===0&&B.loose===0)||f,className:"process-return-button",children:f?i.jsxs(i.Fragment,{children:[i.jsx(Jx,{size:16,className:"mr-2 animate-spin"})," Processing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Jx,{size:16,className:"mr-2"})," Process Return"]})})]})]})})},ote=async()=>{const e=await pe("/subscriptions");if(!e.ok)throw new Error("Failed to fetch subscription plans");return await e.json()},lte=async e=>{const n=await pe(`/subscriptions/${e}`);if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to fetch subscription plan details"}));throw new Error(t.message||"Failed to fetch subscription plan details")}return await n.json()},cte=async e=>{const n=await pe("/subscriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to create subscription plan"}));throw new Error(t.message||"Failed to create subscription plan")}return await n.json()},ute=async(e,n)=>{const t=await pe(`/subscriptions/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to update subscription plan"}));throw new Error(r.message||"Failed to update subscription plan")}return await t.json()},dte=async e=>{const n=await pe(`/subscriptions/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to deactivate subscription plan"}));throw new Error(t.message||"Failed to deactivate subscription plan")}return await n.json()},fte=async(e,n)=>{const t=await pe("/api/payment/razorpay-subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:e,planId:n})});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to initiate Razorpay subscription"}));throw new Error(r.message||"Failed to initiate Razorpay subscription")}return await t.json()},hte=()=>{const e=Et(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),u=w.useCallback(async()=>{a(!0),l(null);try{const g=await ote();t(g)}catch(g){l(g.message||"Failed to fetch subscription plans."),f({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{u()},[u]),w.useEffect(()=>{if(d){const g=setTimeout(()=>f(null),5e3);return()=>clearTimeout(g)}},[d]);const p=async g=>{if(f(null),l(null),window.confirm("Are you sure you want to deactivate this plan? This action cannot be undone directly.")){a(!0),l(null),f(null);try{await dte(g),f({type:"success",message:"Plan deactivated successfully!"}),u()}catch(b){l(b.message||"Failed to deactivate plan."),f({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[d&&i.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[d.type==="success"?i.jsx(fs,{size:18,className:"mr-2 text-green-500"}):i.jsx(Er,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:d.message})]}),i.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Xn,{size:16})})]}),i.jsxs("div",{children:[" ",i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(nn,{size:16}),"Back"]}),i.jsx("h1",{children:"Manage Subscription Plans"}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions/add"),className:"subscription-btn",children:[i.jsx(Ql,{size:16,className:"mr-1 inline-block"})," Add New Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading plans..."})]})}),!r&&o&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:o}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx(cu,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>p(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(li,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!o&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No subscription plans found. Add one to get started!"})]})]})},pte=()=>{const e=Et(),[n,t]=w.useState({name:"",description:"",price:"",period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null);w.useEffect(()=>{if(d){const b=setTimeout(()=>f(null),5e3);return()=>clearTimeout(b)}},[d]);const u=b=>{const{name:v,value:S}=b.target;t(k=>({...k,[v]:S}))},p=async b=>{if(b.preventDefault(),a(!0),l(null),f(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){l("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await cte(n),f({type:"success",message:"Plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create plan.";l(S),f({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[d&&i.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[d.type==="success"?i.jsx(fs,{size:18,className:"mr-2 text-green-500"}):i.jsx(Er,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:d.message})]}),i.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Xn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Subscription Plan"}),o&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:o}),i.jsxs("form",{onSubmit:p,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:u})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:u,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:u,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:u})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},mte=()=>{const{id:e}=Vi(),n=Et(),[t,r]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!1),[f,u]=w.useState(!0),[p,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),u(!1);return}u(!0),g(null);try{const M=await lte(e);r(M),o({name:M.name,description:M.description||"",price:M.price,period:M.period,interval:M.interval,razorpay_plan_id:M.razorpay_plan_id||"",status:M.status})}catch(M){g(M.message||"Failed to fetch plan details."),v({type:"error",message:M.message||"Failed to fetch plan details."})}finally{u(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const M=setTimeout(()=>v(null),5e3);return()=>clearTimeout(M)}},[b]);const k=M=>{const{name:I,value:U}=M.target;o(L=>({...L,[I]:U}))},T=async M=>{if(M.preventDefault(),!e){g("Plan ID is missing.");return}if(d(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),d(!1);return}try{await ute(e,a),v({type:"success",message:"Plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(I){const U=I.message||"Failed to update plan.";g(U),v({type:"error",message:U})}finally{d(!1)}},P=()=>{n(-1)};return f?i.jsx("div",{className:"p-6 text-center",children:"Loading plan details..."}):p&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:p}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx(fs,{size:18,className:"mr-2"}):i.jsx(Er,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(Xn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Subscription Plan"}),p&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:p}),i.jsxs("form",{onSubmit:T,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval||1,onChange:k,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:P,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:l,className:"subscription-btn",children:[l?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,l?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Plan not found."})},gte=()=>{const{patientId:e}=Vi(),n=Et(),[t,r]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState(""),[f,u]=w.useState(!0),[p,g]=w.useState(null),[b,v]=w.useState("manual"),[S,k]=w.useState(!1),[T,P]=w.useState(null),M=w.useCallback(async()=>{u(!0),g(null);try{const L=await pe(`/api/patients/${e}`);if(!L.ok){const Y=await L.json();throw new Error(Y.message||"Failed to fetch patient details")}const $=await L.json();r($);const z=await pe("/api/subscriptions");if(!z.ok){const Y=await z.json();throw new Error(Y.message||"Failed to fetch subscription plans")}const F=await z.json();o(F.filter(Y=>Y.status==="active"))}catch(L){console.error("Error fetching data:",L),g(`Failed to load data: ${L.message}`)}finally{u(!1)}},[e]);w.useEffect(()=>{e?M():(g("Patient ID is missing."),u(!1))},[e,M]);const I=(L,$)=>{const z=new Date(L),F=$.interval||1;switch($.period){case"daily":z.setDate(L.getDate()+F);break;case"weekly":z.setDate(L.getDate()+F*7);break;case"monthly":z.setMonth(L.getMonth()+F);break;case"yearly":z.setFullYear(L.getFullYear()+F);break;default:console.warn(`Unknown subscription period: ${$.period}. Defaulting to 1 month.`),z.setMonth(L.getMonth()+1)}return z},U=async()=>{if(!e||!l){P("Please select a subscription plan.");return}const L=a.find($=>$.id===l);if(!L){P("Selected plan details not found.");return}k(!0),P(null);try{const $=new Date,z=I($,L);if(b==="manual"){const F={subscription_plan_id:l,subscription_status:"active",subscription_start_date:$.toISOString(),subscription_end_date:z.toISOString(),subscription_payment_method:"manual"},Y=await pe(`/api/patients/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(F)});if(!Y.ok){const R=await Y.json();throw new Error(R.message||"Failed to start subscription manually")}alert(`Subscription started successfully for ${t==null?void 0:t.name} (Manual Payment)!`),n("/all-patients")}else if(b==="razorpay"){console.log("Initiating Razorpay subscription for plan:",L);const F=await fte(e,l);if(F&&F.short_url)window.location.href=F.short_url;else throw new Error("Failed to get Razorpay subscription link from backend.")}}catch($){console.error("Error starting subscription:",$),P(`Failed to start subscription: ${$.message}`),k(!1)}};return f?i.jsx("div",{className:"loading-state-subscription",children:"Loading patient and plans..."}):p?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:p})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(nn,{size:16})," ","Back"]})]}):t?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(nn,{size:16})," ","Back"]}),i.jsxs("h1",{children:[i.jsx(Ko,{size:28})," ","Start Subscription for ",t.name]}),T&&i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[" ",i.jsx("span",{children:T})]}),i.jsxs("div",{className:"subscription-form",children:[" ",i.jsx("h2",{children:"Available Subscription Plans"}),a.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:a.map(L=>i.jsxs("div",{className:`subscription-plan-card ${l===L.id?"selected-plan":""}`,onClick:()=>d(L.id),children:[i.jsx("h3",{children:L.name}),i.jsxs("p",{className:"price",children:["",L.price]}),i.jsxs("p",{className:"duration",children:["Every ",L.interval," ",L.period,L.interval>1?"s":""]}),L.description&&i.jsx("p",{children:L.description})]},L.id))})]}),i.jsxs("div",{className:"subscription-form mb-6",children:[" ",i.jsx("h2",{children:"Select Payment Method"}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"manual",checked:b==="manual",onChange:()=>v("manual"),className:"mr-2"}),i.jsx("span",{children:"Cash (Manual)"})]})}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"razorpay",checked:b==="razorpay",onChange:()=>v("razorpay"),className:"mr-2"}),i.jsx("span",{children:"Razorpay"})]})})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:U,disabled:!l||S||a.length===0,className:"subscription-btn",children:[S&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),S?"Starting...":"Start Subscription"]})})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Warning: "}),i.jsx("span",{children:"Patient not found."})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(nn,{size:16}),"Back"]})]})},aS=async()=>{const e=await pe("/api/clinic-subscriptions/plans",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription plans")}return e.json()},yte=async e=>{const n=await pe(`/api/clinic-subscriptions/cancel/${e}`,{method:"PUT"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to cancel clinic subscription")}return n.json()},xte=async e=>{const n=await pe(`/api/clinics/${e}/subscription-status`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||`Failed to fetch subscription status for clinic ${e}`)}return n.json()},bte=async e=>{const n=await pe(`/api/clinic-subscriptions/plans/${e}`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to fetch clinic subscription plan")}return n.json()},vte=async e=>{const n=await pe("/api/clinic-subscriptions/plans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to create clinic subscription plan")}return n.json()},wte=async(e,n)=>{const t=await pe(`/api/clinic-subscriptions/plans/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Failed to update clinic subscription plan")}return t.json()},Ste=async e=>{const n=await pe(`/api/clinic-subscriptions/plans/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to deactivate clinic subscription plan")}return n.json()},Nte=async e=>{const n=await pe("/api/clinic-subscriptions/initiate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:e})});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to initiate clinic subscription")}return n.json()},Cte=async()=>{try{const e=await pe("/api/clinic-subscriptions/pending",{method:"GET"});return e.ok?e.json():null}catch(e){return console.error("Error checking for pending subscription:",e),null}},jte=async()=>{const e=await pe("/api/clinics/subscription-status",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription status")}return e.json()},_te=()=>{const e=Et(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),u=w.useCallback(async()=>{a(!0),l(null);try{const g=await aS();t(g)}catch(g){l(g.message||"Failed to fetch clinic subscription plans."),f({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{u()},[u]),w.useEffect(()=>{if(d){const g=setTimeout(()=>f(null),5e3);return()=>clearTimeout(g)}},[d]);const p=async g=>{if(f(null),l(null),window.confirm("Are you sure you want to deactivate this clinic plan? This action cannot be undone directly.")){a(!0),l(null),f(null);try{await Ste(g),f({type:"success",message:"Clinic plan deactivated successfully!"}),u()}catch(b){l(b.message||"Failed to deactivate clinic plan."),f({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[d&&i.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[d.type==="success"?i.jsx(fs,{size:18,className:"mr-2 text-green-500"}):i.jsx(Er,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:d.message})]}),i.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Xn,{size:16})})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"p-2 rounded-md hover:bg-gray-200",children:i.jsx(nn,{size:20})}),i.jsx("h1",{className:"text-2xl font-bold",children:"Manage Clinic Subscription Plans"})]}),i.jsxs("button",{onClick:()=>e("/dashboard/clinic-subscriptions/add"),className:"subscription-btn",children:[i.jsx(Ql,{size:16,className:"mr-1 inline-block"})," Add New Clinic Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading clinic plans..."})]})}),!r&&o&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:o}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/clinic-subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx(cu,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>p(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(li,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!o&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No clinic subscription plans found. Add one to get started!"})]})]})},kte=()=>{const e=Et(),[n,t]=w.useState({name:"",description:"",price:0,period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null);w.useEffect(()=>{if(d){const b=setTimeout(()=>f(null),5e3);return()=>clearTimeout(b)}},[d]);const u=b=>{const{name:v,value:S,type:k}=b.target;t(T=>({...T,[v]:k==="number"?parseFloat(S):S}))},p=async b=>{if(b.preventDefault(),a(!0),l(null),f(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){l("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await vte(n),f({type:"success",message:"Clinic plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/clinic-subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create clinic plan.";l(S),f({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[d&&i.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[d.type==="success"?i.jsx(fs,{size:18,className:"mr-2 text-green-500"}):i.jsx(Er,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:d.message})]}),i.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Xn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Clinic Subscription Plan"}),o&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:o}),i.jsxs("form",{onSubmit:p,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:u})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:u,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:u,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:u})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},Tte=()=>{const{id:e}=Vi(),n=Et(),[t,r]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!1),[f,u]=w.useState(!0),[p,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),u(!1);return}u(!0),g(null);try{const M=await bte(e);r(M),o({name:M.name,description:M.description||"",price:Number(M.price),period:M.period,interval:Number(M.interval),razorpay_plan_id:M.razorpay_plan_id||"",status:M.status})}catch(M){g(M.message||"Failed to fetch clinic plan details."),v({type:"error",message:M.message||"Failed to fetch plan details."})}finally{u(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const M=setTimeout(()=>v(null),5e3);return()=>clearTimeout(M)}},[b]);const k=M=>{const{name:I,value:U,type:L}=M.target;o($=>({...$,[I]:L==="number"?parseFloat(U):U}))},T=async M=>{if(M.preventDefault(),!e){g("Plan ID is missing.");return}if(d(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),d(!1);return}try{await wte(e,a),v({type:"success",message:"Clinic plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(I){const U=I.message||"Failed to update clinic plan.";g(U),v({type:"error",message:U})}finally{d(!1)}},P=()=>{n(-1)};return f?i.jsx("div",{className:"p-6 text-center",children:"Loading clinic plan details..."}):p&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:p}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx(fs,{size:18,className:"mr-2"}):i.jsx(Er,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(Xn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Clinic Subscription Plan"}),p&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:p}),i.jsxs("form",{onSubmit:T,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price!==void 0?a.price:"",onChange:k,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval!==void 0?a.interval:"",onChange:k,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:P,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:l,className:"subscription-btn",children:[l?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,l?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Clinic plan not found."})},Ete=()=>{const e=Et(),[n,t]=w.useState([]),[r,a]=w.useState(""),[o,l]=w.useState(!0),[d,f]=w.useState(null),[u,p]=w.useState(!1),[g,b]=w.useState(null),v=w.useCallback(async()=>{f(null);try{const T=(await aS()).filter(P=>P.status==="active");t(T),T.length>0&&!r&&a(T[0].id)}catch(k){console.error("Error fetching plans:",k),f(`Failed to load subscription plans: ${k.message}`)}},[]);w.useEffect(()=>{(async()=>{l(!0);try{const T=await Cte();if(T&&T.short_url){window.location.href=T.short_url,f("You have a pending subscription. Redirecting to payment...");return}await v()}catch(T){console.error("Error during initial page load:",T),f(`An unexpected error occurred: ${T.message}`)}finally{l(!1)}})()},[v]);const S=async()=>{if(!r){b("Please select a clinic subscription plan.");return}const k=n.find(T=>T.id===r);if(!k){b("Selected plan details not found.");return}p(!0),b(null);try{console.log("Initiating Razorpay clinic subscription for plan:",k);const T=await Nte(r);if(T&&T.short_url)window.location.href=T.short_url;else throw new Error("Failed to get Razorpay clinic subscription link from backend.")}catch(T){console.error("Error starting clinic subscription:",T),b(`Failed to start clinic subscription: ${T.message}`),p(!1)}};return o?i.jsx("div",{className:"loading-state-subscription",children:"Loading clinic plans..."}):d?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:d})]}),i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(nn,{size:16}),"Back"]})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(nn,{size:16}),"Back"]}),i.jsxs("h1",{children:[i.jsx(yI,{size:28}),"Buy Pro Plan for Clinic"]}),g&&i.jsx("div",{className:"error-alert-subscription",role:"alert",children:i.jsx("span",{children:g})}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h2",{children:"Available Pro Plans"}),n.length===0?i.jsx("p",{className:"empty-state",children:"No active clinic subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:n.map(k=>i.jsxs("div",{className:`subscription-plan-card ${r===k.id?"selected-plan":""}`,onClick:()=>a(k.id),children:[i.jsx("h3",{children:k.name}),i.jsxs("p",{className:"price",children:["",Number(k.price).toFixed(2)]}),i.jsxs("p",{className:"duration",children:["Every ",k.interval," ",k.period,k.interval>1?"s":""]}),k.description&&i.jsx("p",{children:k.description})]},k.id))})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:S,disabled:!r||u||n.length===0,className:"subscription-btn",children:[u&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),u?"Initiating Payment...":"Buy Pro Plan"]})})]})},Ate=()=>{const e=Et(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,p]=w.useState(!1),[g,b]=w.useState(null),[v,S]=w.useState({name:"",email:"",password:"",role:"user"}),[k,T]=w.useState({name:"",email:"",role:"",password:"",confirmPassword:""}),[P,M]=w.useState(""),[I,U]=w.useState(""),[L,$]=w.useState({}),[z,F]=w.useState(!1),[Y,R]=w.useState(null),[B,G]=w.useState([]),[ie,te]=w.useState(""),[W,V]=w.useState(!1),[se,re]=w.useState(null);w.useEffect(()=>{const ae=setTimeout(()=>{U(P)},500);return()=>{clearTimeout(ae)}},[P]),w.useEffect(()=>{oe(I)},[I]);const oe=async(ae="")=>{a(!0);try{const Me=ae?`/api/users?search=${encodeURIComponent(ae)}`:"/api/users",Z=await(await pe(Me)).json();if(t(Z),Z.length>0){const Ee=[...new Set(Z.map(Fe=>Fe.clinic_id).filter(Fe=>!!Fe))],Ie={};await Promise.all(Ee.map(async Fe=>{try{const rt=await xte(Fe);Ie[Fe]=rt}catch(rt){console.error(`Failed to fetch subscription status for clinic ${Fe}`,rt),Ie[Fe]={hasProPlan:!1}}})),$(Ie)}l(null)}catch(Me){l("Failed to fetch users."),console.error(Me)}finally{a(!1)}},E=async ae=>{ae.preventDefault();try{await pe("/users",{method:"POST",body:JSON.stringify(v)}),f(!1),S({name:"",email:"",password:"",role:"user"}),oe()}catch(Me){l("Failed to add user."),console.error(Me)}},le=async ae=>{if(ae.preventDefault(),!g)return;const{password:Me,confirmPassword:Ke,...Z}=k,Ee={...Z};if(Me){if(Me.length<6){l("Password must be at least 6 characters long.");return}if(Me!==Ke){l("Passwords do not match.");return}Ee.password=Me}try{await pe(`/users/${g.id}`,{method:"PUT",body:JSON.stringify(Ee)}),p(!1),b(null),T({...k,password:"",confirmPassword:""}),oe()}catch(Ie){l("Failed to update user."),console.error(Ie)}},ue=async ae=>{if(window.confirm("Are you sure you want to delete this user?"))try{await pe(`/users/${ae}`,{method:"DELETE"}),oe()}catch(Me){l("Failed to delete user."),console.error(Me)}},D=ae=>{b(ae),T({name:ae.name,email:ae.email,role:ae.role,password:"",confirmPassword:""}),p(!0)},ce=async()=>{V(!0);try{const ae=await aS();G(ae),ae.length>0&&te(ae[0].id),re(null)}catch(ae){re("Failed to fetch subscription plans."),console.error(ae)}finally{V(!1)}},ve=ae=>{R(ae),F(!0),ce()},X=async ae=>{if(ae.preventDefault(),!Y||!ie){l("Please select a clinic and a plan.");return}try{await pe("/clinic-subscriptions/manual-activate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicId:Y,planId:ie})}),F(!1),R(null),te(""),oe(),l(null)}catch(Me){l("Failed to manually activate clinic subscription."),console.error(Me)}},fe=async ae=>{if(window.confirm("Are you sure you want to cancel this clinic's subscription? This action cannot be undone."))try{await yte(ae),oe(),l(null)}catch(Me){l("Failed to cancel subscription."),console.error(Me)}};return r?i.jsx("div",{children:"Loading users..."}):o?i.jsx("div",{className:"error-message",children:o}):i.jsxs("div",{className:"user-management-page",children:[i.jsxs("div",{className:"user-management-header",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(nn,{size:16}),"Back"]}),i.jsx("h1",{children:"User Management"})]}),i.jsxs("div",{className:"controls-container",children:[i.jsx("input",{type:"text",placeholder:"Search by name or email...",value:P,onChange:ae=>M(ae.target.value),className:"search-input"}),i.jsx("button",{onClick:()=>f(!0),className:"add-user-button",children:"Add New User"})]}),d&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>f(!1),children:""}),i.jsx("h2",{children:"Add New User"}),i.jsxs("form",{onSubmit:E,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:v.name,onChange:ae=>S({...v,name:ae.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:v.email,onChange:ae=>S({...v,email:ae.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Password:"}),i.jsx("input",{type:"password",value:v.password,onChange:ae=>S({...v,password:ae.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:v.role,onChange:ae=>S({...v,role:ae.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsx("button",{type:"submit",children:"Add User"})]})]})}),u&&g&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>p(!1),children:""}),i.jsx("h2",{children:"Edit User"}),i.jsxs("form",{onSubmit:le,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:k.name,onChange:ae=>T({...k,name:ae.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:k.email,onChange:ae=>T({...k,email:ae.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:k.role,onChange:ae=>T({...k,role:ae.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"New Password (optional):"}),i.jsx("input",{type:"password",value:k.password,onChange:ae=>T({...k,password:ae.target.value})})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Confirm New Password:"}),i.jsx("input",{type:"password",value:k.confirmPassword,onChange:ae=>T({...k,confirmPassword:ae.target.value})})]}),i.jsx("button",{type:"submit",children:"Update User"})]})]})}),z&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>F(!1),children:""}),i.jsx("h2",{children:"Select Subscription Plan for Clinic"}),W&&i.jsx("div",{children:"Loading plans..."}),se&&i.jsx("div",{className:"error-message",children:se}),!W&&!se&&B.length===0&&i.jsx("div",{children:"No active subscription plans available."}),!W&&!se&&B.length>0&&i.jsxs("form",{onSubmit:X,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Select Plan:"}),i.jsx("select",{value:ie,onChange:ae=>te(ae.target.value),required:!0,children:B.map(ae=>i.jsxs("option",{value:ae.id,children:[ae.name," - $",ae.price,"/",ae.interval," ",ae.period]},ae.id))})]}),i.jsx("button",{type:"submit",children:"Activate Selected Plan"})]})]})}),i.jsxs("table",{className:"user-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Role"}),i.jsx("th",{children:"Clinic ID"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:n.map(ae=>{const Me=ae.clinic_id||"N/A",Ke=Me!=="N/A"?L[Me]:null,Z=(Ke==null?void 0:Ke.hasProPlan)??!1,Ee=Z?"PRO":"Standard";return i.jsxs("tr",{children:[i.jsx("td",{children:ae.name}),i.jsx("td",{children:ae.email}),i.jsx("td",{children:ae.role}),i.jsx("td",{children:Me}),i.jsx("td",{children:Me!=="N/A"?i.jsx("span",{className:Z?"pro-badge":"standard-badge",children:Ee}):"N/A"}),i.jsxs("td",{children:[i.jsx("button",{onClick:()=>D(ae),className:"edit-button",children:"Edit"}),i.jsx("button",{onClick:()=>ue(ae.id),className:"delete-button",children:"Delete"}),ae.clinic_id&&!Z&&i.jsx("button",{onClick:()=>ve(ae.clinic_id),className:"start-subscription-button",children:"Start Subscription"}),ae.clinic_id&&Z&&i.jsx("button",{onClick:()=>fe(ae.clinic_id),className:"cancel-subscription-button",children:"Cancel Subscription"})]})]},ae.id)})})]})]})},Pte="_modalOverlay_1spz3_3",Dte="_modalContent_1spz3_29",Ite="_modalHeader_1spz3_53",Rte="_modalTitle_1spz3_71",Mte="_modalCloseButton_1spz3_83",Ote="_modalBody_1spz3_111",Lte="_formGroup_1spz3_119",Fte="_inputField_1spz3_141",$te="_errorText_1spz3_175",zte="_successText_1spz3_193",Ute="_modalFooter_1spz3_211",Bte="_button_1spz3_227",qte="_buttonPrimary_1spz3_247",Vte="_buttonSecondary_1spz3_265",Bi={modalOverlay:Pte,modalContent:Dte,modalHeader:Ite,modalTitle:Rte,modalCloseButton:Mte,modalBody:Ote,formGroup:Lte,inputField:Fte,errorText:$te,successText:zte,modalFooter:Ute,button:Bte,buttonPrimary:qte,buttonSecondary:Vte},Hte=({isOpen:e,onClose:n})=>{const[t,r]=w.useState(""),[a,o]=w.useState(!1),[l,d]=w.useState(!1),[f,u]=w.useState(null),[p,g]=w.useState(null);w.useEffect(()=>{e&&b()},[e]);const b=async()=>{o(!0),u(null);try{const S=await pe("/api/global-settings/app_gemini_api_key");if(S.ok){const k=await S.json();r(k.value||"")}else S.status}catch(S){console.warn("Could not fetch existing key:",S)}finally{o(!1)}},v=async()=>{d(!0),u(null),g(null);try{if(!(await pe("/api/global-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:"app_gemini_api_key",value:t})})).ok)throw new Error("Failed to save API Key");g("API Key updated successfully!"),setTimeout(()=>{n(),g(null)},1500)}catch(S){u(S.message||"Error saving key")}finally{d(!1)}};return e?i.jsx("div",{className:Bi.modalOverlay,children:i.jsxs("div",{className:Bi.modalContent,children:[i.jsxs("div",{className:Bi.modalHeader,children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx(n2,{size:24}),i.jsx("h3",{className:Bi.modalTitle,children:"App Gemini API Key"})]}),i.jsx("button",{onClick:n,className:Bi.modalCloseButton,children:i.jsx(Xn,{size:20})})]}),i.jsxs("div",{className:Bi.modalBody,children:[f&&i.jsx("div",{className:Bi.errorText,children:f}),p&&i.jsx("div",{className:Bi.successText,children:p}),i.jsxs("div",{className:Bi.formGroup,children:[i.jsx("label",{htmlFor:"gemini-key",children:"Gemini API Key"}),i.jsx("input",{type:"text",id:"gemini-key",value:t,onChange:S=>r(S.target.value),className:Bi.inputField,placeholder:"Enter Gemini API Key (AIza...)",disabled:a||l})]}),i.jsx("p",{style:{fontSize:"0.9em",color:"var(--secondary-text-color, #666)"},children:"This key will be used as a fallback for all clinics if their specific Gemini API key is not configured."})]}),i.jsxs("div",{className:Bi.modalFooter,children:[i.jsx("button",{onClick:n,className:`${Bi.button} ${Bi.buttonSecondary}`,disabled:l,children:"Cancel"}),i.jsx("button",{onClick:v,className:`${Bi.button} ${Bi.buttonPrimary}`,disabled:l,children:l?"Saving...":"Save Key"})]})]})}):null},Gte=()=>{const[e,n]=w.useState(!1);return i.jsxs("div",{className:"admin-panel-container",children:[i.jsxs("h1",{className:"admin-panel-title",children:[i.jsx(wb,{size:32,className:"icon-margin"}),"Super Admin Dashboard"]}),i.jsxs("div",{className:"admin-panel-grid",children:[i.jsxs(ds,{to:"/dashboard/clinic-subscriptions",className:"admin-panel-card",children:[i.jsx(Eh,{size:48,className:"card-icon"}),i.jsx("h2",{children:"Manage Clinic Subscription Plans"}),i.jsx("p",{children:"Add, edit, and view clinic subscription plans."})]}),i.jsxs(ds,{to:"/dashboard/users",className:"admin-panel-card",children:[i.jsx(zh,{size:48,className:"card-icon"}),i.jsx("h2",{children:"User Management"}),i.jsx("p",{children:"Add, edit, and delete users; manage user roles."})]}),i.jsxs("div",{className:"admin-panel-card",onClick:()=>n(!0),style:{cursor:"pointer"},children:[i.jsx(n2,{size:48,className:"card-icon"}),i.jsx("h2",{children:"Manage App Gemini API Key"}),i.jsx("p",{children:"Update the fallback Gemini API key used by the application."})]})]}),i.jsx(Hte,{isOpen:e,onClose:()=>n(!1)})]})},G0="tutorialCurrentStep",Yte=({onActionComplete:e,onStaffAdded:n,requiredRole:t})=>{const[r,a]=w.useState(""),[o,l]=w.useState(""),[d,f]=w.useState(""),[u,p]=w.useState(!1),g=t||"receptionist";w.useEffect(()=>{a(t==="lab"?"Lab":t==="pharmacy"?"Pharmacy":"")},[t]);const b=async()=>{if(!r||!o||!d){e(!1,"Please fill all fields.");return}p(!0);try{const v=await pe("/api/staff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,email:o,role:g,password:d})});if(v.ok)e(!0,`Successfully added "${r}" as a ${g}!`),a(""),l(""),f(""),n&&n(g);else{const S=await v.json();e(!1,`Failed: ${S.message||v.statusText}`)}}catch(v){e(!1,`Error: ${v instanceof Error?v.message:String(v)}`)}finally{p(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"text",placeholder:"Name",value:r,onChange:v=>a(v.target.value),disabled:u,className:"tutorial-input"}),i.jsx("input",{type:"email",placeholder:"Email",value:o,onChange:v=>l(v.target.value),disabled:u,className:"tutorial-input"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"password",placeholder:"Password",value:d,onChange:v=>f(v.target.value),disabled:u,className:"tutorial-input"}),i.jsx("div",{className:"role-badge",children:g==="lab"?"Lab Tech":g==="pharmacy"?"Pharmacist":"Receptionist"})]}),i.jsx("button",{onClick:b,className:"tutorial-button primary small",disabled:u,children:u?"Adding...":"Add Staff"})]})},Wte=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState(!1),o=async()=>{t(!0);try{(await pe("/api/drugs/import-defaults",{method:"POST"})).ok?(a(!0),e(!0,"Default medications imported successfully!","pharmacyImport")):e(!1,"Failed to import medications.")}catch{e(!1,"Error importing medications.")}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component center-content",children:[i.jsx("p",{className:"action-hint",children:"One click to populate your inventory."}),r?i.jsxs("div",{className:"success-badge",children:[i.jsx(Qx,{size:16})," Imported"]}):i.jsx("button",{onClick:o,className:"tutorial-button primary",disabled:n,children:n?"Importing...":i.jsxs(i.Fragment,{children:[i.jsx(sw,{size:18})," Import Drugs"]})})]})},Qte=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState(!1),o=async()=>{t(!0);try{(await pe("/api/lab-tests/import-defaults",{method:"POST"})).ok?(a(!0),e(!0,"Default lab tests imported successfully!","labImport")):e(!1,"Failed to import lab tests.")}catch{e(!1,"Error importing lab tests.")}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component center-content",children:[i.jsx("p",{className:"action-hint",children:"Setup your lab with common tests."}),r?i.jsxs("div",{className:"success-badge",children:[i.jsx(Qx,{size:16})," Imported"]}):i.jsx("button",{onClick:o,className:"tutorial-button primary",disabled:n,children:n?"Importing...":i.jsxs(i.Fragment,{children:[i.jsx(Wl,{size:18})," Import Tests"]})})]})},Jte=[{icon:"",title:"Fever & Cold",description:"Rajesh Kumar, 35M, fever 2 days, body pain.",text:"Rajesh Kumar, 35 year old male, fever since 2 days, cold, body pain, no cough"},{icon:"",title:"Stomach Ache",description:"Priya Sharma, 28F, acidity, bloating 3 days.",text:"Priya Sharma, 28 year old female, stomach pain after eating, acidity, bloating since 3 days"}],Kte=({onSelectExample:e})=>i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("p",{className:"action-hint",children:"Click an example to try the AI:"}),i.jsx("div",{className:"example-cards-grid",children:Jte.map((n,t)=>i.jsxs("div",{className:"tutorial-example-card",onClick:()=>e(n.text),children:[i.jsx("div",{className:"example-icon",children:n.icon}),i.jsxs("div",{className:"example-info",children:[i.jsx("h4",{children:n.title}),i.jsx("p",{children:n.description})]}),i.jsx($h,{size:16,className:"arrow-icon"})]},t))})]}),Y0=[{title:"Welcome to Newtons Ai HMS",description:"Your all-in-one clinic management solution. Let's get your clinic ready in less than 2 minutes.",icon:i.jsx(zR,{size:48,className:"step-icon welcome"}),component:null,actionText:"Get Started"},{title:"Pharmacy Setup",description:"Start by populating your pharmacy. We can import a standard list of medicines for you.",icon:i.jsx(sw,{size:48,className:"step-icon pharmacy"}),component:Wte,actionText:"Next",showSkip:!0},{title:"Lab Configuration",description:"Next, let's set up your lab. Import common lab tests to start generating reports immediately.",icon:i.jsx(Wl,{size:48,className:"step-icon lab"}),component:Qte,actionText:"Next",showSkip:!0},{title:"Add Your Team",description:"Invite your staff. Create accounts for receptionists, pharmacists, and lab technicians.",icon:i.jsx(zh,{size:48,className:"step-icon staff"}),component:Yte,actionText:"Next",showSkip:!0},{title:"Experience the AI",description:"The magic happens here. Select an example case below to see how our AI creates patient records instantly.",icon:i.jsx(pI,{size:48,className:"step-icon ai"}),component:Kte,actionText:null,isLast:!0}],Xte=({onClose:e,onMarkAsSeen:n})=>{const[t,r]=w.useState(()=>{const T=localStorage.getItem(G0);return T?parseInt(T,10):0}),[a,o]=w.useState(!1),[l,d]=w.useState(null),[f,u]=w.useState(null),p=Et();w.useEffect(()=>{localStorage.setItem(G0,t.toString()),d(null)},[t]);const g=()=>{o(!0),setTimeout(()=>{r(T=>Math.min(T+1,Y0.length-1)),o(!1)},300)},b=(T,P,M)=>{u(T),d(P),T&&(M==="pharmacyImport"||M==="labImport")&&setTimeout(g,1e3)},v=()=>{n(),e(),localStorage.removeItem(G0)},S=T=>{const P=encodeURIComponent(T);p(`/dashboard?tab=newtons-ai&caseDetails=${P}`),v()},k=Y0[t];return i.jsx("div",{className:"tutorial-overlay",children:i.jsxs("div",{className:`tutorial-card ${a?"fade-out":"fade-in"}`,children:[i.jsxs("div",{className:"tutorial-visual",children:[i.jsx("div",{className:"icon-circle",children:k.icon}),i.jsx("div",{className:"step-indicators",children:Y0.map((T,P)=>i.jsx("div",{className:`step-dot ${P===t?"active":""} ${P<t?"completed":""}`},P))})]}),i.jsxs("div",{className:"tutorial-content",children:[i.jsx("button",{className:"close-button",onClick:v,title:"Close Tutorial",children:i.jsx(Xn,{size:20})}),i.jsxs("div",{className:"text-content",children:[i.jsx("h2",{children:k.title}),i.jsx("p",{className:"description",children:k.description})]}),i.jsxs("div",{className:"interactive-area",children:[k.component?i.jsx(k.component,{onActionComplete:b,onSelectExample:S}):null,l&&i.jsx("div",{className:`status-message ${f?"success":"error"}`,children:l})]}),i.jsxs("div",{className:"action-footer",children:[k.showSkip&&i.jsx("button",{onClick:g,className:"tutorial-button text-only",children:"Skip for now"}),k.actionText&&i.jsxs("button",{onClick:g,className:"tutorial-button primary",children:[k.actionText," ",i.jsx($h,{size:16})]})]})]})]})})},Zte=(e,n,t)=>{const r=Math.abs(e.getTime()-n.getTime());return Math.ceil(r/(1e3*60*60*24))<=t},ene=e=>{const n=new Date(e),r=Math.floor((new Date().getTime()-n.getTime())/1e3);let a=r/31536e3;return a>1?Math.floor(a)+" years ago":(a=r/2592e3,a>1?Math.floor(a)+" months ago":(a=r/86400,a>1?Math.floor(a)+" days ago":(a=r/3600,a>1?Math.floor(a)+" hours ago":(a=r/60,a>1?Math.floor(a)+" mins ago":Math.floor(r)+" seconds ago"))))},tne=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,o]=w.useState(null),[l,d]=w.useState(""),[f,u]=w.useState(""),[p,g]=w.useState(1),[b]=w.useState(10),v=new Date,S=Et();w.useEffect(()=>{(async()=>{r(!0);try{const R=await pe("/api/pharmacy-orders/refill-reminders");if(R.ok){const B=await R.json();n(B)}else o("Failed to fetch refill reminders.")}catch{o("An error occurred while fetching data.")}finally{r(!1)}})()},[]);const k=F=>{d(F.target.value),g(1)},T=F=>{u(F.target.value),g(1)},P=e.filter(F=>{const Y=l?F.medicationRefillDates.some(B=>new Date(B.refillDate).toLocaleDateString()===new Date(l).toLocaleDateString()):!0,R=f?F.patientName.toLowerCase().includes(f.toLowerCase())||F.patientPhoneNumber.includes(f)||F.items.some(B=>B.name.toLowerCase().includes(f.toLowerCase())):!0;return Y&&R}),M=p*b,I=M-b,U=P.slice(I,M),L=Math.ceil(P.length/b),$=F=>g(F),z=async F=>{try{const Y=await pe(`/api/queue/patient/${F}/latest`);if(Y.ok){const R=await Y.json();if(R!=null&&R._id)S(`/dashboard/edit-complaint/${R._id}`);else{const B=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:F})});if(B.ok){const G=await B.json();G!=null&&G.id&&S(`/dashboard/edit-complaint/${G.id}`)}}}}catch(Y){console.error("Error handling row click:",Y),o("Failed to navigate to patient complaint.")}};return t?i.jsx("div",{children:"Loading..."}):a?i.jsx("div",{children:a}):i.jsxs("div",{className:"refill-reminders-container",children:[i.jsx("h1",{children:"Refill Reminders"}),i.jsxs("div",{className:"controls-container",children:[i.jsxs("div",{className:"filter-container",children:[i.jsx("label",{htmlFor:"refillDate",children:"Filter by Refill Date: "}),i.jsx("input",{type:"date",id:"refillDate",value:l,onChange:k})]}),i.jsxs("div",{className:"search-container",children:[i.jsx("label",{htmlFor:"search",children:"Search: "}),i.jsx("input",{type:"text",id:"search",placeholder:"Search by patient name, phone, or medication",value:f,onChange:T})]})]}),i.jsxs("table",{children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient Name"}),i.jsx("th",{children:"Patient Phone Number"}),i.jsx("th",{children:"Medications"}),i.jsx("th",{children:"Refill Dates"})]})}),i.jsx("tbody",{children:U.length>0?U.map(F=>i.jsxs("tr",{onClick:()=>z(F.patientId),style:{cursor:"pointer"},children:[i.jsx("td",{children:F.patientName}),i.jsx("td",{children:F.patientPhoneNumber}),i.jsxs("td",{children:[i.jsx("ul",{children:F.items.map((Y,R)=>i.jsxs("li",{children:[Y.name," (Qty: ",Y.quantity,")",Y.tabletsPerDay&&i.jsxs("span",{children:[" - ",Y.tabletsPerDay," / day"]}),Y.numberOfDays&&i.jsxs("span",{children:[" for ",Y.numberOfDays," days"]})]},R))}),i.jsxs("div",{children:["Last Updated: ",new Date(F.updatedAt).toLocaleDateString()]}),F.prescription_for_unavailable_drugs&&i.jsxs("div",{className:"unavailable-prescription",children:[i.jsx("strong",{children:"Unavailable:"})," ",F.prescription_for_unavailable_drugs]}),F.billStatus&&i.jsxs("div",{className:`bill-status ${F.billStatus}`,children:["Bill Status: ",F.billStatus]})]}),i.jsx("td",{children:i.jsx("ul",{children:F.medicationRefillDates.map((Y,R)=>{const B=new Date(Y.refillDate),G=Zte(B,v,2);return i.jsxs("li",{className:G?"highlight-refill-date":"",children:[Y.name,": ",B.toLocaleDateString()]},R)})})})]},F.id)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:"No refill reminders found."})})})]}),i.jsxs("div",{className:"pagination-container",children:[i.jsx("button",{onClick:()=>$(p-1),disabled:p===1,children:"Previous"}),Array.from({length:L},(F,Y)=>i.jsx("button",{onClick:()=>$(Y+1),className:p===Y+1?"active":"",children:Y+1},Y+1)),i.jsx("button",{onClick:()=>$(p+1),disabled:p===L,children:"Next"})]})]})},nne=()=>{const e=Et(),n=Yr();return w.useEffect(()=>{const t=new URLSearchParams(n.search),r=t.get("token"),a=t.get("caseDetails");r?(async()=>{try{const l=await pe(`/api/patients?search=${r}&limit=1`);if(!l.ok)throw new Error("Failed to fetch patient by token");const f=(await l.json()).patients[0];if(!f)throw new Error("Patient with the given token not found");const u=await pe(`/api/queue/patient/${f.id}/latest`);if(u.ok){const b=await u.json();if(b!=null&&b._id){e(`/dashboard/edit-complaint/${b._id}`,{state:{initialComplaint:a}});return}}const p=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:f.id,complaint:a})});if(!p.ok)throw new Error("Failed to create queue entry");const g=await p.json();if(g!=null&&g.id)e(`/dashboard/edit-complaint/${g.id}`,{state:{initialComplaint:a}});else throw new Error("Failed to get ID from new queue entry.")}catch(l){console.error("Error handling complaint URL:",l),e("/dashboard/search-patient")}})():e("/dashboard/search-patient")},[n,e]),i.jsx("div",{children:"Loading..."})},rne=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,o]=w.useState(null),l=w.useCallback(async()=>{r(!0),o(null);try{const u=await pe("/api/notifications?all=true");if(u.ok){const g=(await u.json()).sort((b,v)=>{const S={expired_drug:1,near_expiry_drug:2,low_stock:3},k=S[b.type]||99,T=S[v.type]||99;return k!==T?k-T:new Date(v.created_at).getTime()-new Date(b.created_at).getTime()});n(g)}else o("Failed to fetch notifications."),console.error("Failed to fetch notifications:",u.statusText)}catch(u){o("Error fetching notifications."),console.error("Error fetching notifications:",u)}finally{r(!1)}},[]);w.useEffect(()=>{l()},[l]);const d=async u=>{try{const p=await pe(`/api/notifications/${u}/read`,{method:"PUT"});p.ok?n(g=>g.map(b=>b.id===u?{...b,is_read:!0}:b)):console.error("Failed to mark notification as read:",p.statusText)}catch(p){console.error("Error marking notification as read:",p)}},f=async()=>{try{const u=e.filter(g=>!g.is_read).map(g=>g.id);if(u.length===0)return;const p=await pe("/api/notifications/mark-all-read",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationIds:u})});p.ok?n(g=>g.map(b=>({...b,is_read:!0}))):console.error("Failed to mark all notifications as read:",p.statusText)}catch(u){console.error("Error marking all notifications as read:",u)}};return t?i.jsx("div",{className:"notifications-page-container",children:"Loading notifications..."}):a?i.jsx("div",{className:"notifications-page-container error-message",children:a}):i.jsxs("div",{className:"notifications-page-container",children:[i.jsx("h2",{className:"notifications-page-title",children:"All Notifications"}),i.jsx("div",{className:"notifications-actions",children:i.jsx("button",{onClick:f,disabled:e.every(u=>u.is_read),className:"mark-all-read-button",children:"Mark All As Read"})}),e.length===0?i.jsx("p",{className:"no-notifications-message",children:"No notifications to display."}):i.jsx("ul",{className:"notifications-list",children:e.map(u=>i.jsxs("li",{className:`notification-item ${u.is_read?"read":"unread"}`,children:[i.jsxs("div",{className:"notification-content",children:[i.jsxs("span",{className:"notification-type",children:[u.type.replace(/_/g," "),": "]}),u.message]}),i.jsxs("div",{className:"notification-meta",children:[i.jsx("span",{className:"notification-timestamp",children:new Date(u.created_at).toLocaleString()}),!u.is_read&&i.jsx("button",{onClick:()=>d(u.id),className:"mark-read-button",children:"Mark as Read"})]})]},u.id))})]})},P_=()=>{const e=Et(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,p]=w.useState(!1),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[P,M]=w.useState(null),[I,U]=w.useState([]),[L,$]=w.useState(null),[z,F]=w.useState(""),[Y,R]=w.useState(""),[B,G]=w.useState(""),[ie,te]=w.useState(""),[W,V]=w.useState(""),[se,re]=w.useState(""),[oe,E]=w.useState(""),[le,ue]=w.useState(""),[D,ce]=w.useState(""),[ve,X]=w.useState(""),[fe,ae]=w.useState(""),Me=w.useCallback(async()=>{a(!0),l(null);try{const we=await pe("/api/distributors");if(!we.ok)throw new Error(`Failed to fetch distributors: ${we.statusText}`);const Q=await we.json();t(Q)}catch(we){console.error("Failed to fetch distributors:",we),l(we.message||"Failed to load distributors.")}finally{a(!1)}},[]);w.useEffect(()=>{Me()},[Me]);const Ke=async we=>{we.preventDefault(),l(null);try{const Q=await pe("/api/distributors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:z,contact_person:Y,phone:B,email:ie,address:W,gst_number:se,drug_license_number:oe})});if(!Q.ok){const me=await Q.json();throw new Error(me.message||"Failed to add distributor.")}alert("Distributor added successfully!"),lt(),Me()}catch(Q){console.error("Error adding distributor:",Q),l(Q.message||"Failed to add distributor.")}},Z=async we=>{if(we.preventDefault(),l(null),!!P)try{const Q=await pe(`/api/distributors/${P.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:z,contact_person:Y,phone:B,email:ie,address:W,gst_number:se,drug_license_number:oe})});if(!Q.ok){const me=await Q.json();throw new Error(me.message||"Failed to update distributor.")}alert("Distributor updated successfully!"),st(),Me()}catch(Q){console.error("Error updating distributor:",Q),l(Q.message||"Failed to update distributor.")}},Ee=async()=>{if(l(null),!!P)try{const we=await pe(`/api/distributors/${P.id}`,{method:"DELETE"});if(!we.ok){const Q=await we.json();throw new Error(Q.message||"Failed to delete distributor.")}alert("Distributor deleted successfully!"),rn(),Me()}catch(we){console.error("Error deleting distributor:",we),l(we.message||"Failed to delete distributor.")}},Ie=w.useCallback(async we=>{l(null);try{const Q=await pe(`/api/distributors/${we}/payments`);if(!Q.ok)throw new Error(`Failed to fetch payments: ${Q.statusText}`);const Ve=(await Q.json()).map(kt=>({...kt,order_value:parseFloat(kt.order_value),amount_paid:parseFloat(kt.amount_paid),balance_remaining:parseFloat(kt.balance_remaining)}));U(Ve);const Qe=await pe(`/api/distributors/${we}/balance`);if(!Qe.ok)throw new Error(`Failed to fetch balance: ${Qe.statusText}`);const ot=await Qe.json();$({totalOrderValue:parseFloat(ot.totalOrderValue),totalAmountPaid:parseFloat(ot.totalAmountPaid),remainingBalance:parseFloat(ot.remainingBalance)})}catch(Q){console.error("Error fetching payments/balance:",Q),l(Q.message||"Failed to load payments or balance.")}},[]),Fe=async we=>{if(we.preventDefault(),l(null),!!P)try{const Q=await pe(`/api/distributors/${P.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:le,order_value:parseFloat(D||"0"),amount_paid:parseFloat(ve||"0"),notes:fe})});if(!Q.ok){const me=await Q.json();throw new Error(me.message||"Failed to add payment.")}alert("Payment added successfully!"),ke(),Ie(P.id)}catch(Q){console.error("Error adding payment:",Q),l(Q.message||"Failed to add payment.")}},rt=()=>{F(""),R(""),G(""),te(""),V(""),re(""),E(""),l(null),f(!0)},lt=()=>{f(!1)},ct=we=>{M(we),F(we.name),R(we.contact_person||""),G(we.phone||""),te(we.email||""),V(we.address||""),re(we.gst_number||""),E(we.drug_license_number||""),l(null),p(!0)},st=()=>{p(!1),M(null)},Ht=we=>{M(we),l(null),b(!0)},rn=()=>{b(!1),M(null)},je=we=>{M(we),Ie(we.id),l(null),S(!0)},qe=()=>{S(!1),M(null),U([]),$(null)},Be=we=>{M(we),ue(new Date().toISOString().split("T")[0]),ce("0"),X("0"),ae(""),l(null),T(!0)},ke=()=>{T(!1),M(null)};return r?i.jsx("div",{className:"loading-indicator",children:"Loading Distributors..."}):o?i.jsxs("div",{className:"error-indicator",children:["Error: ",o]}):i.jsxs("div",{className:"distributor-management-page",children:[i.jsxs("div",{className:"distributor-management-header",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[i.jsx(nn,{size:24})," Back"]}),i.jsx("h2",{children:"Distributor Management"})]}),(()=>{const we=n.reduce((me,Ve)=>me+parseFloat(Ve.remainingBalance||"0"),0),Q=we>=0?"balance-positive":"balance-negative";return i.jsxs("div",{className:`total-balance-display ${Q}`,children:[i.jsx("strong",{children:"Total Combined Balance:"})," ",we.toFixed(2)]})})(),i.jsxs("button",{onClick:rt,className:"add-distributor-button",children:[i.jsx(us,{size:18}),"Add New Distributor"]})]}),i.jsx("div",{className:"distributor-table-container",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Contact Person"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Address"}),i.jsx("th",{children:"GST Number"})," ",i.jsx("th",{children:"Drug License Number"})," ",i.jsx("th",{children:"Remaining Balance"})," ",i.jsx("th",{className:"actions-cell",children:"Actions"})]})}),i.jsx("tbody",{children:n.length===0?i.jsxs("tr",{children:[i.jsx("td",{colSpan:9,className:"no-results-message",children:"No distributors found."})," "]}):n.map(we=>i.jsxs("tr",{children:[i.jsx("td",{children:we.name}),i.jsx("td",{children:we.contact_person||"-"}),i.jsx("td",{children:we.phone||"-"}),i.jsx("td",{children:we.email||"-"}),i.jsx("td",{children:we.address||"-"}),i.jsx("td",{children:we.gst_number||"-"})," ",i.jsx("td",{children:we.drug_license_number||"-"})," ",i.jsxs("td",{className:parseFloat(we.remainingBalance||"0")>0?"balance-positive":"balance-negative",children:["",we.remainingBalance||"0.00"]})," ",i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsxs("button",{onClick:()=>je(we),className:"action-text-button view-button",title:"View Payments & Balance",children:[i.jsx(BI,{size:16})," View Payments"]}),i.jsxs("button",{onClick:()=>Be(we),className:"action-text-button add-payment-button",title:"Add Payment",children:[i.jsx(us,{size:16})," Add Payment"]}),i.jsx("button",{onClick:()=>ct(we),className:"action-icon-button edit-button",title:"Edit Distributor",children:i.jsx(cu,{size:16})}),i.jsx("button",{onClick:()=>Ht(we),className:"action-icon-button delete-button",title:"Delete Distributor",children:i.jsx(li,{size:16})})]})})]},we.id))})]})}),d&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:lt,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Add New Distributor"}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("form",{onSubmit:Ke,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Name:"}),i.jsx("input",{type:"text",id:"name",value:z,onChange:we=>F(we.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"contact_person",value:Y,onChange:we=>R(we.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"phone",value:B,onChange:we=>G(we.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email:"}),i.jsx("input",{type:"email",id:"email",value:ie,onChange:we=>te(we.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"address",children:"Address:"}),i.jsx("textarea",{id:"address",value:W,onChange:we=>V(we.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"gst_number",value:se,onChange:we=>re(we.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"drug_license_number",value:oe,onChange:we=>E(we.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:lt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Distributor"})]})]})]})}),u&&P&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:st,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Edit Distributor"}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("form",{onSubmit:Z,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-name",children:"Name:"}),i.jsx("input",{type:"text",id:"edit-name",value:z,onChange:we=>F(we.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"edit-contact_person",value:Y,onChange:we=>R(we.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"edit-phone",value:B,onChange:we=>G(we.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-email",children:"Email:"}),i.jsx("input",{type:"email",id:"edit-email",value:ie,onChange:we=>te(we.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-address",children:"Address:"}),i.jsx("textarea",{id:"edit-address",value:W,onChange:we=>V(we.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"edit-gst_number",value:se,onChange:we=>re(we.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"edit-drug_license_number",value:oe,onChange:we=>E(we.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:st,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Save Changes"})]})]})]})}),g&&P&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:rn,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Confirm Delete"}),i.jsxs("p",{children:['Are you sure you want to delete distributor "',P.name,'"?']}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:rn,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Ee,className:"button-delete",children:"Delete"})]})]})}),v&&P&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content large-modal",children:[i.jsx("button",{onClick:qe,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Payments & Balance for ",P.name]}),o&&i.jsx("div",{className:"modal-error-message",children:o}),L&&i.jsxs("div",{className:"balance-summary",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Total Order Value:"})," ",L.totalOrderValue.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Total Amount Paid:"})," ",L.totalAmountPaid.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Remaining Balance:"})," ",L.remainingBalance.toFixed(2)]})]}),i.jsx("h4",{children:"Payment History"}),I.length===0?i.jsx("p",{children:"No payments recorded for this distributor."}):i.jsx("div",{className:"table-responsive",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Order Value"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Balance Remaining"}),i.jsx("th",{children:"Notes"})]})}),i.jsx("tbody",{children:I.map(we=>i.jsxs("tr",{children:[i.jsx("td",{children:new Date(we.payment_date).toLocaleDateString()}),i.jsxs("td",{children:["",we.order_value.toFixed(2)]}),i.jsxs("td",{children:["",we.amount_paid.toFixed(2)]}),i.jsxs("td",{children:["",we.balance_remaining.toFixed(2)]}),i.jsx("td",{children:we.notes||"-"})]},we.id))})]})}),i.jsx("div",{className:"modal-actions",children:i.jsx("button",{type:"button",onClick:qe,className:"button-cancel",children:"Close"})})]})}),k&&P&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:ke,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Add Payment for ",P.name]}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("form",{onSubmit:Fe,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_date",children:"Payment Date:"}),i.jsx("input",{type:"date",id:"payment_date",value:le,onChange:we=>ue(we.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"order_value",children:"Order Value:"}),i.jsx("input",{type:"number",id:"order_value",value:D,onChange:we=>ce(we.target.value),step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"amount_paid",children:"Amount Paid:"}),i.jsx("input",{type:"number",id:"amount_paid",value:ve,onChange:we=>X(we.target.value),step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_notes",children:"Notes:"}),i.jsx("textarea",{id:"payment_notes",value:fe,onChange:we=>ae(we.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:ke,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Payment"})]})]})]})})]})},ine=({isOpen:e,onClose:n,excelHeaders:t,onConfirm:r,availableFields:a})=>{const[o,l]=w.useState({});if(w.useEffect(()=>{e&&f()},[e,t,a]),!e)return null;const d=(p,g)=>{l(b=>({...b,[p]:g}))},f=()=>{const p={};t.forEach(g=>{const b=a.map(S=>({name:S})),v=$m(g,b);v&&(p[g]=v.name)}),l(p)},u=()=>{const p={};for(const g in o)o[g]&&o[g]!=="none"&&(p[g]=o[g]);r(p),n()};return i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:n,className:"modal-close-button",children:i.jsx(Xn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Match File Columns"}),i.jsx("p",{className:"modal-description",children:'Please match the columns from your uploaded file to the corresponding fields in the drug inventory. You can use the "Auto Match" button for suggestions.'}),i.jsx("div",{className:"modal-actions-top",children:i.jsx("button",{type:"button",onClick:f,className:"button-auto-match",children:"Auto Match"})}),i.jsxs("div",{className:"column-mapping-grid",children:[i.jsx("div",{className:"grid-header",children:"Excel Column"}),i.jsx("div",{className:"grid-header",children:"App Field"}),t.map((p,g)=>i.jsxs(jn.Fragment,{children:[i.jsx("div",{className:"excel-header-cell",children:p}),i.jsx("div",{className:"app-field-cell",children:i.jsxs("select",{value:o[p]||"",onChange:b=>d(p,b.target.value),className:"app-field-select",children:[i.jsx("option",{value:"",children:"-- Select Field --"}),i.jsx("option",{value:"none",children:"None (Ignore Column)"}),a.map((b,v)=>i.jsxs("option",{value:b,children:[b==="name"?"Composition Name":b==="brand_name"?"Brand Name":b==="price"?"MRP":b==="buying_price"?"Rate":b==="unit"?"Pack":b==="batch"?"Batch":b==="hsn_code"?"HSN Code":b==="mfg"?"MFG":b==="loose_quantity"?"Loose":b.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase())," "]},v))]})})]},g))]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:n,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:u,className:"button-submit",children:"Confirm Mapping"})]})]})})},ane=({purchaseRows:e,onCellChange:n,onRemoveDrug:t,onAddEmptyRow:r})=>{const a=w.useRef(new Map),o=["name","price","quantity_in_stock","unit","expiry_date","buying_price","brand_name","box_number","gst","discount","batch","hsn_code","mfg","loose"],l=(d,f,u)=>{if(d.key==="Tab"){d.preventDefault();const p=o.indexOf(u);if(p!==-1){const g=(p+1)%o.length,b=o[g],v=a.current.get(`${f}-${b}`);v==null||v.focus()}}};return e.length===0?i.jsxs("div",{className:"no-drugs-message",children:[i.jsx("p",{children:"No drugs added to the purchase list yet."}),i.jsxs("button",{onClick:r,className:"action-button add-drug-to-table-button",children:[i.jsx(us,{size:18,className:"button-icon"}),"Add the first drug"]})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"purchase-drugs-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Composition Name"}),i.jsx("th",{children:"MRP ()"}),i.jsx("th",{children:"Qty"}),i.jsx("th",{children:"Pack"}),i.jsx("th",{children:"Supplier"}),i.jsx("th",{children:"Expiry Date"}),i.jsx("th",{children:"Rate ()"}),i.jsx("th",{children:"Brand Name"}),i.jsx("th",{children:"Box Number"}),i.jsx("th",{children:"GST (%)"}),i.jsx("th",{children:"Discount (%)"}),i.jsx("th",{children:"Margin (%)"}),i.jsx("th",{children:"Batch"}),i.jsx("th",{children:"HSN Code"}),i.jsx("th",{children:"MFG"}),i.jsx("th",{children:"Loose"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map((d,f)=>i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("input",{type:"text",value:d.name||"",onChange:u=>n(u,d.id,"name"),onKeyDown:u=>l(u,d.id,"name"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-name`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.price,onChange:u=>n(u,d.id,"price"),onKeyDown:u=>l(u,d.id,"price"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-price`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.quantity_in_stock,onChange:u=>n(u,d.id,"quantity_in_stock"),onKeyDown:u=>l(u,d.id,"quantity_in_stock"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-quantity_in_stock`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.unit||"",onChange:u=>n(u,d.id,"unit"),onKeyDown:u=>l(u,d.id,"unit"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-unit`,u)}})}),i.jsx("td",{children:d.supplier||"N/A"}),i.jsx("td",{children:i.jsx("input",{type:"date",value:d.expiry_date||"",onChange:u=>n(u,d.id,"expiry_date"),onKeyDown:u=>l(u,d.id,"expiry_date"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-expiry_date`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.buying_price||"",onChange:u=>n(u,d.id,"buying_price"),onKeyDown:u=>l(u,d.id,"buying_price"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-buying_price`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.brand_name||"",onChange:u=>n(u,d.id,"brand_name"),onKeyDown:u=>l(u,d.id,"brand_name"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-brand_name`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.box_number||"",onChange:u=>n(u,d.id,"box_number"),onKeyDown:u=>l(u,d.id,"box_number"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-box_number`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.gst||"",onChange:u=>n(u,d.id,"gst"),onKeyDown:u=>l(u,d.id,"gst"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-gst`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.discount||"",onChange:u=>n(u,d.id,"discount"),onKeyDown:u=>l(u,d.id,"discount"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-discount`,u)}})}),i.jsx("td",{children:(()=>{const u=d.price||0,p=d.buying_price||0,g=d.gst!==null&&d.gst!==void 0?d.gst/100*p:0,b=d.discount!==null&&d.discount!==void 0?d.discount/100*u:0,v=u-(p+g)-b;return`${(u>0?v/u*100:0).toFixed(2)}%`})()}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.batch||"",onChange:u=>n(u,d.id,"batch"),onKeyDown:u=>l(u,d.id,"batch"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-batch`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.hsn_code||"",onChange:u=>n(u,d.id,"hsn_code"),onKeyDown:u=>l(u,d.id,"hsn_code"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-hsn_code`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.mfg||"",onChange:u=>n(u,d.id,"mfg"),onKeyDown:u=>l(u,d.id,"mfg"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-mfg`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.loose||"",onChange:u=>n(u,d.id,"loose"),onKeyDown:u=>l(u,d.id,"loose"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-loose`,u)}})}),i.jsx("td",{children:i.jsx("button",{onClick:()=>t(d.id),className:"text-red-600 hover:text-red-800 text-sm",children:"Remove"})})]},d.id||f))})]})})},D_=()=>{const e=Et(),[n,t]=w.useState(!1),r=w.useRef(null),a=w.useRef(null),[o,l]=w.useState(""),[d,f]=w.useState([]),[u,p]=w.useState(null),[g,b]=w.useState(!1),v=w.useRef(null),[S,k]=w.useState(!1),[T,P]=w.useState([]),[M,I]=w.useState(null),[U,L]=w.useState(null),[$,z]=w.useState(0),[F,Y]=w.useState(!1),[R,B]=w.useState([]),G=["name","description","price","quantity_in_stock","unit","supplier","expiry_date","buying_price","box_number","gst","margin","discount","brand_name","batch","hsn_code","mfg","loose"],ie=()=>{const Ee={id:Date.now().toString()+Math.random().toString(36).substring(2,9),name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",supplier:u?u.name:"",expiry_date:"",buying_price:0,box_number:"",gst:0,margin:0,discount:0,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:0,last_updated:"",created_at:""};B(Ie=>[...Ie,Ee])},te=async(Z,Ee)=>{if(!Z){L("No file provided for import.");return}if(!u){L("Please select a distributor before importing.");return}t(!0),L(null);const Ie=new FormData;Ie.append("inventoryFile",Z),Ie.append("columnMapping",JSON.stringify(Ee));try{const Fe=await pe("/api/drugs/parse-excel",{method:"POST",body:Ie});if(!Fe.ok){const lt=await Fe.json();throw new Error(lt.message||`Failed to parse Excel file: ${Fe.statusText}`)}const rt=await Fe.json();B(lt=>[...lt,...rt.map(ct=>({...ct,id:Date.now().toString()+Math.random().toString(36).substring(2,9),supplier:u?u.name:ct.supplier}))]),alert(`Successfully parsed ${rt.length} drugs from Excel. They have been added to the purchase list.`)}catch(Fe){console.error("Failed to parse Excel file:",Fe),L(Fe.message||"Failed to parse Excel file. Please check the file format and try again."),alert(`Excel parsing failed: ${Fe.message||"Please check the file format and try again."}`)}finally{r.current&&(r.current.value=""),t(!1),I(null)}},W=async Z=>{if(Z.target.files&&Z.target.files[0]){const Ee=Z.target.files[0];I(Ee),L(null),t(!0);const Ie=new FormData;Ie.append("inventoryFile",Ee);try{const Fe=await pe("/api/drugs/get-file-headers",{method:"POST",body:Ie});if(!Fe.ok){const lt=await Fe.json();throw new Error(lt.message||`Failed to get file headers: ${Fe.statusText}`)}const{headers:rt}=await Fe.json();P(rt),k(!0)}catch(Fe){console.error("Failed to get file headers:",Fe),L(Fe.message||"Failed to read file headers. Please check the file format and try again."),alert(`Error reading file headers: ${Fe.message||"Please check the file format and try again."}`),I(null)}finally{t(!1)}}else I(null)},V=Z=>{M?te(M,Z):L("No file selected for import after mapping."),k(!1)},se=()=>{k(!1),P([]),I(null),r.current&&(r.current.value="")},re=()=>{var Z;(Z=r.current)==null||Z.click()},oe=async Z=>{if(Z.target.files&&Z.target.files[0]){const Ee=Z.target.files[0];L(null),t(!0);const Ie=new FormData;Ie.append("file",Ee),Ie.append("output_type","csv");const rt={Authorization:"Bearer 00841ac4-b279-11f0-ab55-0a3a41e3fad1"};try{const lt=await fetch("https://extraction-api.nanonets.com/extract",{method:"POST",headers:rt,body:Ie});if(!lt.ok){const ke=await lt.json();throw new Error(ke.message||`Failed to extract data from image/PDF: ${lt.statusText}`)}const ct=await lt.json();if(!ct.success||!ct.content)throw new Error(ct.detail||"Nanonets API did not return expected content.");let st=ct.content;st=st.split(`
`).filter(ke=>!ke.startsWith("#")&&ke.trim()!=="").join(`
`);const rn=new File([st],"extracted_data.csv",{type:"text/csv"}),je=new FormData;je.append("inventoryFile",rn);const qe=await pe("/api/drugs/get-file-headers",{method:"POST",body:je});if(!qe.ok){const ke=await qe.json();throw new Error(ke.message||`Failed to get headers from extracted CSV: ${qe.statusText}`)}const{headers:Be}=await qe.json();P(Be),I(rn),k(!0),alert("Successfully extracted data from image/PDF as CSV. Please map the columns.")}catch(lt){console.error("Failed to extract data from image/PDF:",lt),L(lt.message||"Failed to extract data from image/PDF. Please check the file and try again."),alert(`Image/PDF extraction failed: ${lt.message||"Please check the file and try again."}`)}finally{a.current&&(a.current.value=""),t(!1)}}},E=()=>{var Z;(Z=a.current)==null||Z.click()},le=()=>{if(!u){L("Please select a distributor before adding a drug manually.");return}Y(!0)},ue=()=>{Y(!1),L(null)},D=Z=>{B(Ee=>[...Ee,{...Z,id:Date.now().toString(),supplier:u?u.name:Z.supplier}]),ue()},ce=Z=>{B(Ee=>Ee.filter(Ie=>Ie.id!==Z))},ve=(Z,Ee,Ie)=>{const{value:Fe}=Z.target;B(rt=>rt.map(lt=>{if(lt.id===Ee){let ct=Fe;Ie==="expiry_date"?ct=Fe.trim()===""?null:Fe:["price","quantity_in_stock","buying_price","gst","margin","discount","loose"].includes(Ie)&&(ct=parseFloat(Fe),isNaN(ct)&&(ct=null));const st={...lt,[Ie]:ct};return Ie==="name"&&u&&!st.supplier&&(st.supplier=u.name),st}return lt}))},X=w.useCallback(()=>R.reduce((Z,Ee)=>{const Ie=Ee.quantity_in_stock||0,Fe=Ee.buying_price||0,rt=Ee.gst||0,lt=Ee.discount||0;let ct=Fe*(1-lt/100),st=Ie*ct;return st+=st*(rt/100),Z+st},0),[R]),fe=async()=>{if(!u){L("Please select a distributor before submitting the purchase.");return}const Z=R.filter(Ee=>Object.values(Ee).some(Ie=>typeof Ie=="string"&&Ie.trim()!==""||typeof Ie=="number"&&Ie!==0||Ie!=null&&typeof Ie!="string"&&typeof Ie!="number"));if(Z.length===0){L("No valid drugs to submit. Please fill in at least one field for a row, or remove empty rows."),t(!1);return}t(!0),L(null);try{for(const rt of Z){const lt={...rt,expiry_date:rt.expiry_date===""?null:rt.expiry_date,distributorId:u.id},ct=await pe("/api/drugs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(lt)});if(!ct.ok){const st=await ct.json();throw new Error(st.message||`Failed to add drug ${rt.name}: ${ct.statusText}`)}}const Ee=X(),Ie=new Date().toISOString().split("T")[0],Fe=await pe(`/api/distributors/${u.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:Ie,order_value:Ee,amount_paid:$,notes:"Payment from purchase page."})});if(!Fe.ok){const rt=await Fe.json();throw new Error(rt.message||`Failed to record distributor payment: ${Fe.statusText}`)}alert("All valid drugs added to inventory and distributor payment recorded successfully!"),B([]),p(null),l(""),z(0),e("/dashboard/inventory")}catch(Ee){console.error("Failed to submit purchase:",Ee),L(Ee.message||"Failed to submit purchase. Please try again."),alert(`Purchase submission failed: ${Ee.message||"Please try again."}`)}finally{t(!1)}},ae=w.useCallback(async Z=>{if(Z.trim()===""){f([]);return}try{const Ee=await pe(`/api/distributors?search=${encodeURIComponent(Z)}`);if(!Ee.ok)throw new Error(`Failed to fetch distributors: ${Ee.statusText}`);const Ie=await Ee.json();f(Ie)}catch(Ee){console.error("Failed to fetch distributors:",Ee),L(Ee.message||"Failed to load distributors.")}},[]),Me=Z=>{const Ee=Z.target.value;l(Ee),p(null),v.current&&clearTimeout(v.current),Ee.trim()!==""?v.current=setTimeout(()=>{ae(Ee),b(!0)},300):(f([]),b(!1))},Ke=Z=>{p(Z),l(Z.name),b(!1),f([])};return w.useEffect(()=>{const Z=Ee=>{Ee.target instanceof HTMLElement&&!Ee.target.closest(".distributor-search-container")&&b(!1)};return document.addEventListener("mousedown",Z),()=>{document.removeEventListener("mousedown",Z),v.current&&clearTimeout(v.current)}},[]),i.jsxs("div",{className:"purchase-page",children:[i.jsxs("div",{className:"purchase-header",children:[i.jsx("button",{onClick:()=>e(-1),className:"action-icon-button",title:"Go Back",children:i.jsx(nn,{size:24})}),i.jsx("h2",{className:"purchase-page-title",children:"Purchase Inventory"})]}),U&&i.jsx("div",{className:"error-message",children:U}),i.jsxs("div",{className:"purchase-controls-header",children:[i.jsxs("div",{className:"distributor-selection-section",children:[i.jsxs("h3",{children:[i.jsx(KR,{size:24,className:"icon-left"})," Select Distributor"]}),i.jsxs("div",{className:"distributor-search-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(ua,{size:20,className:"search-icon"}),i.jsx("input",{type:"text",placeholder:"Search distributor by name...",value:o,onChange:Me,onFocus:()=>o.trim()!==""&&b(!0),className:"distributor-search-input"})]}),g&&d.length>0&&i.jsx("ul",{className:"distributor-search-results",children:d.map(Z=>i.jsx("li",{onClick:()=>Ke(Z),children:Z.name},Z.id))}),u&&i.jsxs("div",{className:"selected-distributor-info",children:["Selected: ",i.jsx("strong",{children:u.name}),u.contact_person&&i.jsxs("span",{children:[" (",u.contact_person,")"]})]})]})]}),i.jsxs("div",{className:"import-section",children:[i.jsxs("h3",{children:[i.jsx(FS,{size:24,className:"icon-left"})," Import Drugs"]}),i.jsx("p",{children:"Upload an Excel (.xlsx, .xls), CSV, PDF, or Image file to import drug data."}),i.jsxs("div",{className:"import-controls",children:[i.jsx("input",{ref:r,id:"excel-file-upload",name:"excel-file-upload",type:"file",className:"sr-only",accept:".xlsx, .xls, .csv",onChange:W}),i.jsxs("button",{onClick:re,disabled:n||!u,className:`action-button import-button ${n?"importing":""}`,title:u?"":"Please select a distributor",children:[i.jsx(FS,{size:18,className:"button-icon"}),n?"Reading Headers...":"Import XL or CSV"]}),i.jsx("input",{ref:a,id:"image-pdf-file-upload",name:"image-pdf-file-upload",type:"file",className:"sr-only",accept:".pdf, .png, .jpg, .jpeg",onChange:oe}),i.jsxs("button",{onClick:E,disabled:n||!u,className:"action-button import-button",title:u?"":"Please select a distributor",children:[i.jsx(lu,{size:18,className:"button-icon"}),"Import from PDF/Image"]}),i.jsxs("button",{onClick:le,className:"action-button add-drug-manual-button",disabled:!u,title:u?"":"Select a distributor to add drugs manually",children:[i.jsx(us,{size:18,className:"button-icon"}),"Add Drug"]})]})]})]}),i.jsx(ine,{isOpen:S,onClose:se,excelHeaders:T,onConfirm:V,availableFields:G}),F&&i.jsx(sT,{isOpen:F,onClose:ue,onDrugAddedToPurchase:D}),i.jsxs("div",{className:"purchase-summary-section",children:[i.jsxs("h3",{children:[i.jsx(VR,{size:24,className:"icon-left"})," Drugs to be Purchased (",R.length,")"]}),i.jsx(ane,{purchaseRows:R,onCellChange:ve,onRemoveDrug:ce,onAddEmptyRow:ie}),i.jsxs("div",{className:"purchase-summary-actions",children:[i.jsxs("button",{onClick:ie,className:"action-button add-drug-to-table-button",children:[i.jsx(us,{size:18,className:"button-icon"}),"Add Row"]}),i.jsxs("div",{className:"summary-details",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"amount-paid-to-distributor",children:"Amount Paid ():"}),i.jsx("input",{type:"number",id:"amount-paid-to-distributor",value:$,onChange:Z=>z(parseFloat(Z.target.value)||0),placeholder:"0.00",className:"amount-paid-input",step:"0.01",disabled:!u,title:u?"":"Please select a distributor first"})]}),i.jsxs("div",{className:"total-purchase-value",children:[i.jsx("strong",{children:"Total Purchase Value:"})," ",X().toFixed(2)]})]}),i.jsx("button",{onClick:fe,disabled:n||R.length===0||!u,className:"action-button submit-purchase-button",children:n?"Submitting...":"Submit Purchase"})]})]})]})},sne=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)/);return n&&n[1]?parseInt(n[1],10):1},one=()=>{const e=Et(),n=Yr(),[t,r]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState(!0),[f,u]=w.useState(null),[p,g]=w.useState(!1),[b,v]=w.useState("cash"),[S,k]=w.useState(""),[T,P]=w.useState(""),[M,I]=w.useState(""),[U,L]=w.useState(""),[$,z]=w.useState(""),[F,Y]=w.useState(0),R=w.useRef(!1),B=oe=>{const E=Math.max(0,Math.min(100,isNaN(oe)?0:oe));R.current=!0,Y(E);const le=a.map(ue=>({...ue,discount_percentage:E}));o(le)},G=(oe,E)=>{const le=[...a];le[oe].discount_percentage=isNaN(E)?0:E,o(le)};w.useEffect(()=>{if(R.current){R.current=!1;return}const oe=a.reduce((ue,D)=>ue+(D.total_price??0),0);if(oe===0){Y(0);return}const le=a.reduce((ue,D)=>{const ve=(D.total_price??0)*((D.discount_percentage??0)/100);return ue+ve},0)/oe*100;Y(ue=>Math.abs(ue-le)>.01?le:ue)},[a]);const ie=async()=>{if(!t)return u("No order data available to bill."),null;if(a.length===0)return u("Cannot bill an empty order."),null;g(!0),u(null);try{const oe=a.map(ce=>{const ve=(ce.pricePerLooseUnit??0)*(ce.looseQuantity??0),X=ve*((ce.discount_percentage??0)/100),fe=ve-X;return{name:ce.name,pack_quantity:ce.loosePacks??0,loose_quantity:ce.looseUnits??0,price:ce.originalPrice??0,pack_price:ce.originalPrice??0,loose_price:ce.pricePerLooseUnit??0,total:fe,drug_id:ce.drug_id,discount_percentage:ce.discount_percentage??0,batch:ce.batch,expiry_date:ce.expiry_date}}),E={patientId:t.patientId,queueId:t.id,items:oe,amount:re,paymentMode:b,type:"pharmacy",related_id:t.id,status:"paid",discountPercentage:F},le=await pe("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)}),ue=await le.json();if(!le.ok||!ue.id)throw new Error(ue.message||"Failed to create bill.");const D=await pe(`/api/pharmacy-orders/${t.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"billed",bill_id:ue.id,medications:a})});if(!D.ok){const ce=await D.text();throw new Error(`Failed to update pharmacy order status: ${D.statusText} - ${ce}`)}return r(ce=>ce?{...ce,status:"billed",bill_id:ue.id}:null),alert(`Order ${t.patientName}'s bill created (ID: ${ue.id}) and marked as billed.`),e(`/dashboard/pharmacy-billing/${t.id}`,{replace:!0,state:{order:{...t,status:"billed",bill_id:ue.id},initialItems:a}}),ue.id}catch(oe){return console.error("Billing process failed:",oe),u(oe.message||"Failed to mark order as billed. Please try again."),null}finally{g(!1)}},te=()=>{window.print()},W=async()=>{await ie()&&(window.print(),e(-1))};w.useEffect(()=>{const oe=n.pathname.split("/"),E=oe[oe.length-1];E?(async()=>{try{const ue=await pe(`/api/pharmacy-orders/${E}`);if(!ue.ok)throw new Error("Failed to fetch pharmacy order details");const D=await ue.json();r(D);const ce=D.medications.map(ve=>{const X=sne(ve.unit),fe=(ve.pack_quantity??0)*X+(ve.loose_quantity??0);return{...ve,isLoose:!0,loosePacks:ve.pack_quantity??0,looseUnits:ve.loose_quantity??0,looseQuantity:fe,pack_price:Number(ve.pack_price)||0,loose_price:Number(ve.loose_price)||0,total_price:Number(ve.total_price)||0,pricePerLooseUnit:Number(ve.loose_price)||0,originalPrice:Number(ve.pack_price)||0,discount_percentage:Number(ve.discount_percentage)??0,directions_to_use:ve.directions_to_use,tabletsPerDay:ve.tabletsPerDay,numberOfDays:ve.numberOfDays,batch:ve.batch,expiry_date:ve.expiry_date}});o(ce)}catch(ue){console.error("Failed to fetch order:",ue),u(ue.message||"Failed to load order details.")}finally{d(!1)}})():(u("No pharmacy order ID provided."),d(!1))},[n.pathname]),w.useEffect(()=>{(async()=>{try{const E=await pe("/api/clinics/settings");if(!E.ok)throw new Error("Failed to fetch clinic settings");const le=await E.json();P(le.upi_id||""),I(le.name||""),L(le.address||""),z(le.notes||"")}catch(E){console.error("Error fetching clinic settings:",E)}})()},[]);const V=w.useMemo(()=>a.reduce((oe,E)=>oe+(E.total_price??0),0),[a]),se=w.useMemo(()=>a.reduce((oe,E)=>{const ue=(E.total_price??0)*(E.discount_percentage??0)/100;return oe+ue},0),[a]),re=w.useMemo(()=>V-se,[V,se]);return w.useEffect(()=>{if(re>0&&T){const oe=`upi://pay?pa=${T}&pn=ClinicName&am=${re.toFixed(2)}&cu=INR`;k(oe)}else k("")},[re,T]),l?i.jsx("div",{className:"loading-pulse",children:"Loading Bill..."}):f?i.jsxs("div",{className:"error-message-box",children:["Error: ",f]}):t?i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"TAX INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:M?`${M} Pharmacy`:"Pharmacy Bill"}),(U||$)&&i.jsxs("div",{className:"clinic-details-print",children:[U&&i.jsx("span",{className:"small-text clinic-address",children:U}),$&&i.jsx("span",{className:"small-text clinic-notes",children:$})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ko,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ym,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Wx,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(nn,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Pharmacy Bill"})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ko,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ym,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item no-print",children:[i.jsxs("strong",{children:[i.jsx(ig,{size:16})," Order ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Wx,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Medications"})}),a.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"BATCH"}),i.jsx("th",{children:"EXPIRY"}),i.jsx("th",{children:"QUANTITY"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:a.map((oe,E)=>{var ve,X;const le=oe.total_price??0,ue=le*(oe.discount_percentage??0)/100,D=le-ue;return i.jsxs("tr",{children:[i.jsx("td",{children:E+1}),i.jsx("td",{children:oe.name}),i.jsx("td",{children:oe.batch||"N/A"}),i.jsx("td",{children:oe.expiry_date?new Date(oe.expiry_date).toLocaleDateString():"N/A"}),i.jsxs("td",{children:[i.jsxs("div",{children:["Packs: ",oe.loosePacks??0]}),i.jsxs("div",{children:["Loose: ",oe.looseUnits??0]})]}),i.jsx("td",{children:((ve=oe.originalPrice)==null?void 0:ve.toFixed(2))??"N/A"}),i.jsx("td",{children:((X=oe.pricePerLooseUnit)==null?void 0:X.toFixed(2))??"N/A"}),i.jsxs("td",{children:[i.jsx("input",{type:"number",value:oe.discount_percentage??0,onChange:fe=>G(E,parseFloat(fe.target.value)),min:"0",max:"100",className:"discount-input-table"}),"%"]}),i.jsxs("td",{children:[5 .toFixed(1),"%"]}),i.jsx("td",{children:D.toFixed(2)})]},E)})})]}):i.jsx("p",{children:"No medications in this order."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[S&&i.jsxs("div",{className:`qr-code-container qr-code-printable-section ${b!=="upi"?"hide-on-screen":""}`,children:[i.jsx(Mh,{value:S,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",V.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsxs("span",{children:["Total Discount (",F.toFixed(2),"%)"]}),i.jsxs("span",{children:["- ",se.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"GST (Included)"}),i.jsxs("span",{children:["",(re*.05).toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",re.toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",V.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",se.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount Percentage"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:F,onChange:oe=>B(parseFloat(oe.target.value)),min:"0",max:"100",className:"discount-input-total",disabled:p||t.status==="billed"}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",re.toFixed(2)]})]}),i.jsx("div",{className:"qr-code-container",children:S?i.jsxs(i.Fragment,{children:[i.jsx(Mh,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]}):i.jsx("p",{children:"UPI QR code not available. Please ensure UPI ID is configured."})}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:b,onChange:oe=>v(oe.target.value),className:"payment-mode-select",disabled:p||t.status==="billed",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsxs("div",{className:"bill-actions",children:[t.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:te,className:"secondary-button print-preview-button no-print",disabled:p||a.length===0,children:"Print Preview"}),i.jsx("button",{onClick:W,className:"primary-button",disabled:p||a.length===0,children:p?"Processing...":"Finalise and Bill"})]}),t.status==="billed"&&i.jsx("button",{onClick:()=>e(`/dashboard/bills/${t.bill_id}`),className:"secondary-button",children:"View Bill"})]})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})}):i.jsx("div",{className:"error-message-box",children:"No order data available."})},lne=()=>{const e=Et(),n=Yr(),[t,r]=w.useState(null),[a,o]=w.useState(""),[l,d]=w.useState(""),[f,u]=w.useState([]),[p,g]=w.useState(!0),[b,v]=w.useState(null),[S,k]=w.useState(!1),[T,P]=w.useState("cash"),[M,I]=w.useState(""),[U,L]=w.useState(""),[$,z]=w.useState(""),[F,Y]=w.useState(""),[R,B]=w.useState(""),[G,ie]=w.useState(0),te=w.useRef(!1),W=D=>{const ce=Math.max(0,Math.min(100,isNaN(D)?0:D));te.current=!0,ie(ce);const ve=f.map(X=>({...X,discount_percentage:ce}));u(ve)},V=(D,ce)=>{const ve=[...f];ve[D].discount_percentage=isNaN(ce)?0:ce,u(ve)};w.useEffect(()=>{if(te.current){te.current=!1;return}const D=f.reduce((X,fe)=>X+(fe.price??0),0);if(D===0){ie(0);return}const ve=f.reduce((X,fe)=>{const Me=(fe.price??0)*((fe.discount_percentage??0)/100);return X+Me},0)/D*100;ie(X=>Math.abs(X-ve)>.01?ve:X)},[f]);const se=async()=>{if(!t)return v("No order data available to bill."),null;if(f.length===0)return v("Cannot bill an empty order."),null;k(!0),v(null);try{const D=f.map(ae=>{const Me=ae.price,Ke=Me*((ae.discount_percentage??0)/100),Z=Me-Ke;return{name:ae.name,price:ae.price,quantity:1,total:Z,item_id:ae.id,type:"lab_test",discount_percentage:ae.discount_percentage??0}}),ce={patientId:t.patient_id,items:D,amount:ue,paymentMode:T,type:"lab",related_id:t.id,status:"paid",discountPercentage:G},ve=await pe("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ce)}),X=await ve.json();if(!ve.ok||!X.id)throw new Error(X.message||"Failed to create bill.");const fe=await pe(`/api/lab/${t.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"billed",bill_id:X.id})});if(!fe.ok){const ae=await fe.text();throw new Error(`Failed to update lab order status: ${fe.statusText} - ${ae}`)}return r(ae=>ae?{...ae,status:"billed",bill_id:X.id}:null),alert(`Lab Order bill created (ID: ${X.id}) and marked as billed.`),e(`/dashboard/lab-billing/${t.id}`,{replace:!0,state:{...n.state,order:{...t,status:"billed",bill_id:X.id}}}),X.id}catch(D){return console.error("Billing process failed:",D),v(D.message||"Failed to mark order as billed. Please try again."),null}finally{k(!1)}},re=()=>{window.print()},oe=async()=>{await se()&&(window.print(),e(-1))};w.useEffect(()=>{const D=n.pathname.split("/"),ce=D[D.length-1];ce?(async()=>{try{const X=await pe(`/api/lab/${ce}`);if(!X.ok)throw new Error("Failed to fetch lab order details");const fe=await X.json();if(r(fe),fe.patient_id){const Me=await pe(`/api/patients/${fe.patient_id}`);if(Me.ok){const Ke=await Me.json();o(Ke.name),d(Ke.patient_token_number)}}const ae=fe.tests.map(Me=>({...Me,price:typeof Me.price=="string"?parseFloat(Me.price):Number(Me.price)||0,discount_percentage:0,total_price:typeof Me.price=="string"?parseFloat(Me.price):Number(Me.price)||0}));u(ae)}catch(X){console.error("Failed to fetch order:",X),v(X.message||"Failed to load order details.")}finally{g(!1)}})():(v("No lab order ID provided."),g(!1))},[n.pathname]),w.useEffect(()=>{(async()=>{try{const ce=await pe("/api/clinics/settings");if(!ce.ok)throw new Error("Failed to fetch clinic settings");const ve=await ce.json();L(ve.upi_id||""),z(ve.name||""),Y(ve.address||""),B(ve.notes||"")}catch(ce){console.error("Error fetching clinic settings:",ce)}})()},[]);const E=w.useMemo(()=>f.reduce((D,ce)=>D+(ce.price??0),0),[f]),le=w.useMemo(()=>f.reduce((D,ce)=>{const X=(ce.price??0)*(ce.discount_percentage??0)/100;return D+X},0),[f]),ue=w.useMemo(()=>E-le,[E,le]);return w.useEffect(()=>{if(ue>0&&U){const D=`upi://pay?pa=${U}&pn=ClinicName&am=${ue.toFixed(2)}&cu=INR`;I(D)}else I("")},[ue,U]),p?i.jsx("div",{className:"loading-pulse",children:"Loading Lab Bill..."}):b?i.jsxs("div",{className:"error-message-box",children:["Error: ",b]}):t?i.jsxs("div",{className:"pharmacy-billing-page",children:[" ",i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"LAB INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:$?`${$} Lab`:"Lab Bill"}),(F||R)&&i.jsxs("div",{className:"clinic-details-print",children:[F&&i.jsx("span",{className:"small-text clinic-address",children:F}),R&&i.jsx("span",{className:"small-text clinic-notes",children:R})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ko,{size:16})," Patient Name"]})," ",a]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ym,{size:16})," Token"]})," ",l??"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Wx,{size:16})," Order Date"]})," ",new Date(t.createdAt).toLocaleDateString()]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(nn,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Lab Bill"})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ko,{size:16})," Patient Name"]})," ",a]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ym,{size:16})," Token"]})," ",l??"N/A"]}),i.jsxs("div",{className:"info-item no-print",children:[i.jsxs("strong",{children:[i.jsx(Wl,{size:16})," Order ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Wx,{size:16})," Order Date"]})," ",new Date(t.createdAt).toLocaleDateString()]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Lab Tests"})}),f.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"TEST DESCRIPTION"}),i.jsx("th",{children:"PRICE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:f.map((D,ce)=>{const ve=D.price??0,X=ve*(D.discount_percentage??0)/100,fe=ve-X;return i.jsxs("tr",{children:[i.jsx("td",{children:ce+1}),i.jsx("td",{children:D.name}),i.jsx("td",{children:typeof D.price=="number"?D.price.toFixed(2):Number(D.price||0).toFixed(2)}),i.jsxs("td",{children:[i.jsx("input",{type:"number",value:D.discount_percentage??0,onChange:ae=>V(ce,parseFloat(ae.target.value)),min:"0",max:"100",className:"discount-input-table"}),"%"]}),i.jsx("td",{children:fe.toFixed(2)})]},ce)})})]}):i.jsx("p",{children:"No tests in this order."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[M&&i.jsxs("div",{className:`qr-code-container qr-code-printable-section ${T!=="upi"?"hide-on-screen":""}`,children:[i.jsx(Mh,{value:M,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",E.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsxs("span",{children:["Total Discount (",G.toFixed(2),"%)"]}),i.jsxs("span",{children:["- ",le.toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",ue.toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",E.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",le.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount Percentage"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:G,onChange:D=>W(parseFloat(D.target.value)),min:"0",max:"100",className:"discount-input-total",disabled:S||t.status==="billed"}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",ue.toFixed(2)]})]}),i.jsx("div",{className:"qr-code-container",children:M?i.jsxs(i.Fragment,{children:[i.jsx(Mh,{value:M,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]}):i.jsx("p",{children:"UPI QR code not available. Please ensure UPI ID is configured."})}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:T,onChange:D=>P(D.target.value),className:"payment-mode-select",disabled:S||t.status==="billed",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsxs("div",{className:"bill-actions",children:[t.status!=="billed"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:re,className:"secondary-button print-preview-button no-print",disabled:S||f.length===0,children:"Print Preview"}),i.jsx("button",{onClick:oe,className:"primary-button",disabled:S||f.length===0,children:S?"Processing...":"Finalise and Bill"})]}),t.status==="billed"&&i.jsx("button",{onClick:()=>e("/billing",{state:{billId:t.bill_id}}),className:"secondary-button",children:"View Bill"})]})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})]}):i.jsx("div",{className:"error-message-box",children:"No order data available."})},cne=()=>{const e=Et(),[n,t]=w.useState(!0),[r,a]=w.useState([]),[o,l]=w.useState(""),[d,f]=w.useState(!0),[u,p]=w.useState(!1),[g,b]=w.useState({admissionCharge:"0.00",perDayCharge:"0.00",otherCharges:"0.00",aiMemory:"",clinicWideSystemPrompt:"",gemini_api_key:"",low_stock_threshold:"10",name:"",logoUrl:"",upi_id:"",address:"",notes:""}),[v,S]=w.useState(null),k=(z,F)=>{S({type:z,message:F}),setTimeout(()=>S(null),3e3)},T=z=>{switch(z){case"doctor":return i.jsx(l2,{size:14,className:"text-blue-600"});case"receptionist":return i.jsx(ow,{size:14,className:"text-green-600"});case"pharmacy":return i.jsx(ig,{size:14,className:"text-purple-600"});case"lab":return i.jsx(Wl,{size:14,className:"text-yellow-600"});default:return i.jsx(wb,{size:14,className:"text-gray-500"})}},P=z=>{switch(z){case"doctor":return"avatar-blue";case"receptionist":return"avatar-green";case"pharmacy":return"avatar-purple";case"lab":return"avatar-yellow";default:return"avatar-gray"}},M=w.useCallback(async()=>{t(!0);try{const z=await pe("/staff");if(z.ok){const F=await z.json();a(F.map(Y=>({...Y,id:Y._id||Y.id})))}}catch(z){console.error("Error fetching staff:",z),k("error","Failed to load staff list")}finally{t(!1)}},[]),I=w.useCallback(async()=>{f(!0);try{const z=await pe("/api/clinics/settings");if(z.ok){const F=await z.json();b({admissionCharge:parseFloat(F.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(F.perDayCharge||0).toFixed(2),otherCharges:parseFloat(F.otherCharges||0).toFixed(2),aiMemory:F.aiMemory||"",clinicWideSystemPrompt:F.clinicWideSystemPrompt||"",gemini_api_key:F.gemini_api_key||"",low_stock_threshold:F.low_stock_threshold!==void 0&&F.low_stock_threshold!==null?String(F.low_stock_threshold):"10",name:F.name||"",logoUrl:F.logoUrl||"",upi_id:F.upi_id||"",address:F.address||"",notes:F.notes||""})}}catch(z){console.error("Error fetching settings:",z),k("error","Failed to load settings")}finally{f(!1)}},[]);w.useEffect(()=>{M(),I()},[M,I]);const U=z=>{const{name:F,value:Y}=z.target;b(R=>({...R,[F]:Y}))},L=async()=>{p(!0);try{const z=parseFloat(g.admissionCharge),F=parseFloat(g.perDayCharge),Y=parseFloat(g.otherCharges),R=parseInt(g.low_stock_threshold);if((await pe("/api/clinics/settings",{method:"PUT",body:JSON.stringify({name:g.name,admissionCharge:z,perDayCharge:F,otherCharges:Y,aiMemory:g.aiMemory,clinicWideSystemPrompt:g.clinicWideSystemPrompt,gemini_api_key:g.gemini_api_key,low_stock_threshold:R,logoUrl:g.logoUrl,upi_id:g.upi_id,address:g.address,notes:g.notes})})).ok)k("success","Changes saved successfully");else throw new Error("Failed to save")}catch(z){console.error("Error saving settings:",z),k("error","Failed to save settings")}finally{p(!1)}},$=r.filter(z=>z.name.toLowerCase().includes(o.toLowerCase())||z.role.toLowerCase().includes(o.toLowerCase()));return i.jsxs("div",{className:"clinic-hub-container",children:[i.jsxs("header",{className:"clinic-hub-header",children:[i.jsxs("div",{className:"clinic-hub-title",children:[i.jsx("h1",{children:"Clinic Hub"}),i.jsx("p",{className:"clinic-hub-subtitle",children:"Manage your ecosystem"})]}),i.jsxs("div",{className:"clinic-hub-actions",children:[v&&i.jsx("div",{className:`px-4 py-2 rounded-md text-sm font-medium ${v.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.message}),i.jsxs("button",{className:"btn-add-staff",onClick:()=>e("/dashboard/staff/add"),children:[i.jsx(Ql,{size:16})," Add Staff"]}),i.jsxs("button",{className:"btn-save-changes",onClick:L,disabled:u,children:[i.jsx(Od,{size:16})," ",u?"Saving...":"Save Changes"]})]})]}),i.jsxs("main",{className:"clinic-hub-content",children:[i.jsxs("div",{className:"team-directory-panel",children:[i.jsxs("div",{className:"panel-header",children:[i.jsx(zh,{size:18,className:"text-gray-500"}),i.jsxs("span",{className:"panel-title",children:["Team Directory (",r.length,")"]})]}),i.jsx("div",{className:"search-container",children:i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(ua,{size:16,className:"search-icon"}),i.jsx("input",{type:"text",placeholder:"Find member...",className:"search-input",value:o,onChange:z=>l(z.target.value)})]})}),i.jsx("div",{className:"team-list",children:n?i.jsx("div",{className:"p-4 text-center text-gray-500",children:"Loading staff..."}):$.length===0?i.jsx("div",{className:"empty-state",children:"No staff found."}):$.map(z=>i.jsxs("div",{className:"team-member-item",children:[i.jsx("div",{className:`member-avatar ${P(z.role)}`,children:z.name.charAt(0).toUpperCase()}),i.jsxs("div",{className:"member-info",children:[i.jsx("div",{className:"member-name",children:z.name}),i.jsxs("div",{className:"member-role",children:[T(z.role),z.role]})]}),i.jsx("span",{className:`member-status ${z.active?"status-active":"status-inactive"}`,children:z.active?"Active":"Inactive"}),i.jsx("button",{className:"btn-edit-member",onClick:()=>e(`/dashboard/staff/edit/${z.id}`),children:i.jsx(cu,{size:16})})]},z.id))})]}),i.jsxs("div",{className:"config-console-panel",children:[i.jsxs("div",{className:"panel-header",children:[i.jsx(r2,{size:18,className:"text-gray-500"}),i.jsx("span",{className:"panel-title",children:"Configuration Console"})]}),d?i.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading settings..."}):i.jsxs("div",{className:"config-content",children:[i.jsxs("div",{className:"config-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx(i2,{size:16})," CLINIC IDENTITY & LOCATION"]}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Clinic Name"}),i.jsx("input",{type:"text",className:"form-input",name:"name",value:g.name,onChange:U})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Logo URL"}),i.jsx("input",{type:"url",className:"form-input",placeholder:"https://",name:"logoUrl",value:g.logoUrl,onChange:U})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{className:"form-label",children:"Address"}),i.jsx("textarea",{className:"form-textarea",placeholder:"Full physical address",name:"address",value:g.address,onChange:U})]})]})]}),i.jsxs("div",{className:"config-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx(Eh,{size:16})," FINANCIAL OPERATIONS"]}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Admission Charge ()"}),i.jsx("input",{type:"number",className:"form-input",name:"admissionCharge",value:g.admissionCharge,onChange:U})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Per Day Charge ()"}),i.jsx("input",{type:"number",className:"form-input",name:"perDayCharge",value:g.perDayCharge,onChange:U})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Other Charges ()"}),i.jsx("input",{type:"number",className:"form-input",name:"otherCharges",value:g.otherCharges,onChange:U})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"UPI ID"}),i.jsx("input",{type:"text",className:"form-input",name:"upi_id",value:g.upi_id,onChange:U})]})]})]}),i.jsxs("div",{className:"config-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx(e2,{size:16})," INVENTORY & AI"]}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Low Stock Threshold"}),i.jsx("input",{type:"number",className:"form-input",name:"low_stock_threshold",value:g.low_stock_threshold,onChange:U})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Gemini API Key"}),i.jsx("input",{type:"password",className:"form-input",name:"gemini_api_key",value:g.gemini_api_key,onChange:U,placeholder:"******************"})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{className:"form-label",children:"Clinic-Wide System Prompt"}),i.jsx("textarea",{className:"form-textarea",name:"clinicWideSystemPrompt",value:g.clinicWideSystemPrompt,onChange:U,placeholder:"Instructions for the AI..."})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{className:"form-label",children:"AI Memory (Context)"}),i.jsx("textarea",{className:"form-textarea",name:"aiMemory",value:g.aiMemory,onChange:U,placeholder:"Shared context for the AI..."})]})]})]})]})]})]})]})},une="_container_nftcg_1",dne="_header_nftcg_15",fne="_title_nftcg_37",hne="_controls_nftcg_51",pne="_dateInputGroup_nftcg_63",mne="_dateInputLabel_nftcg_75",gne="_dateInput_nftcg_63",yne="_fetchButton_nftcg_117",xne="_section_nftcg_159",bne="_sectionTitle_nftcg_175",vne="_statsGrid_nftcg_195",wne="_statCard_nftcg_209",Sne="_statTitle_nftcg_235",Nne="_statValue_nftcg_251",Cne="_statSubtitle_nftcg_263",jne="_revenueGrid_nftcg_277",_ne="_revenueCard_nftcg_291",kne="_revenueCardTitle_nftcg_305",Tne="_revenueCardList_nftcg_319",Ene="_revenueCardListItem_nftcg_331",Ane="_tableContainer_nftcg_359",Pne="_table_nftcg_359",Dne="_textGreen_nftcg_433",Ine="_textRed_nftcg_441",Rne="_loadingContainer_nftcg_459",Mne="_errorAlert_nftcg_477",Yt={container:une,header:dne,title:fne,controls:hne,dateInputGroup:pne,dateInputLabel:mne,dateInput:gne,fetchButton:yne,section:xne,sectionTitle:bne,statsGrid:vne,statCard:wne,statTitle:Sne,statValue:Nne,statSubtitle:Cne,revenueGrid:jne,revenueCard:_ne,revenueCardTitle:kne,revenueCardList:Tne,revenueCardListItem:Ene,tableContainer:Ane,table:Pne,textGreen:Dne,textRed:Ine,loadingContainer:Rne,errorAlert:Mne},One=()=>{const e=Et(),n=new Date().toISOString().split("T")[0],[t,r]=w.useState(n),[a,o]=w.useState(n),[l,d]=w.useState(!1),[f,u]=w.useState(null),[p,g]=w.useState(0),[b,v]=w.useState(0),[S,k]=w.useState(null),[T,P]=w.useState(null),[M,I]=w.useState({reception:{},pharmacy:{},lab:{}}),[U,L]=w.useState(null),$=async()=>{if(d(!0),u(null),g(0),v(0),k(null),P(null),I({reception:{},pharmacy:{},lab:{}}),L(null),!t||!a){u("Please select both start and end dates."),d(!1);return}try{const F=DU(),[Y,R,B,G]=await Promise.all([pe(`/api/bills?startDate=${t}&endDate=${a}`),pe(`/api/payment/admission?startDate=${t}&endDate=${a}`),pe(`/api/subscriptions/transactions/manual?startDate=${t}&endDate=${a}`),F?pe(`/api/inventory/comprehensive-analysis?startDate=${t}&endDate=${a}&clinicId=${F}`):Promise.resolve(null)]);if(Y.ok&&R.ok&&B.ok){const ie=await Y.json(),te=await R.json(),W=await B.json(),V=ie.bills||[],se=te.admissionPayments||[],re=W||[];let oe=0,E=0;const le={},ue={consultation:0,pharmacy:0,lab:0,other:0},D={reception:{},pharmacy:{},lab:{}};V.forEach(ce=>{if(ce.status==="paid"||ce.type==="pharmacy_return"){const ve=parseFloat(ce.amount.toString()),X=ce.payment_mode||"Unknown";let fe=ce.type||"other";fe==="pharmacy_return"&&(E+=ve,fe="pharmacy"),oe+=ve,le[X]=(le[X]||0)+ve,ue.hasOwnProperty(fe)?ue[fe]=(ue[fe]||0)+ve:ue.other=(ue.other||0)+ve,fe==="pharmacy"?D.pharmacy[X]=(D.pharmacy[X]||0)+ve:fe==="lab"?D.lab[X]=(D.lab[X]||0)+ve:D.reception[X]=(D.reception[X]||0)+ve}}),se.forEach(ce=>{const ve=parseFloat(ce.amount_paid.toString()),X=ce.payment_mode||"Unknown";oe+=ve,le[X]=(le[X]||0)+ve,D.reception[X]=(D.reception[X]||0)+ve}),re.forEach(ce=>{var fe,ae;const ve=parseFloat(((ae=(fe=ce.subscriptionPlan)==null?void 0:fe.price)==null?void 0:ae.toString())??"0"),X=ce.subscription_payment_method||"manual";oe+=ve,le[X]=(le[X]||0)+ve,D.reception[X]=(D.reception[X]||0)+ve}),g(oe),v(E),k(le),P(ue),I(D)}if(G&&G.ok){const ie=await G.json();L(ie)}}catch(F){console.error("Analysis Fetch Error:",F),u("Failed to fetch analysis data. Please try again.")}finally{d(!1)}},z=F=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(F);return i.jsxs("div",{className:Yt.container,children:[i.jsxs("div",{className:Yt.header,children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"p-2 hover:bg-gray-100 rounded-full",children:i.jsx(nn,{size:20,className:"text-gray-600"})}),i.jsx("h1",{className:Yt.title,children:"Analysis Dashboard"})]}),i.jsxs("div",{className:Yt.controls,children:[i.jsxs("div",{className:Yt.dateInputGroup,children:[i.jsx("label",{className:Yt.dateInputLabel,children:"From:"}),i.jsx("input",{type:"date",className:Yt.dateInput,value:t,onChange:F=>r(F.target.value)})]}),i.jsxs("div",{className:Yt.dateInputGroup,children:[i.jsx("label",{className:Yt.dateInputLabel,children:"To:"}),i.jsx("input",{type:"date",className:Yt.dateInput,value:a,onChange:F=>o(F.target.value)})]}),i.jsx("button",{className:Yt.fetchButton,onClick:$,disabled:l,children:l?"Refreshing...":i.jsxs(i.Fragment,{children:[i.jsx(Jx,{size:16,className:"inline mr-2"})," Refresh Analysis"]})})]})]}),f&&i.jsxs("div",{className:Yt.errorAlert,children:[i.jsx(Er,{size:20}),i.jsx("span",{children:f})]}),!l&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("section",{className:Yt.section,children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(Eh,{className:"text-blue-600"}),i.jsx("h2",{className:Yt.sectionTitle,children:"Financial Performance"})]}),i.jsxs("div",{className:Yt.statsGrid,children:[i.jsxs("div",{className:Yt.statCard,children:[i.jsx("div",{className:Yt.statTitle,children:"Total Revenue Collected"}),i.jsx("div",{className:`${Yt.statValue} text-blue-600`,children:z(p)}),i.jsx("div",{className:Yt.statSubtitle,children:"All payment modes"})]}),S&&Object.entries(S).map(([F,Y])=>i.jsxs("div",{className:Yt.statCard,children:[i.jsxs("div",{className:Yt.statTitle,children:[F," Collections"]}),i.jsx("div",{className:Yt.statValue,children:z(Y)})]},F))]}),M&&i.jsxs("div",{className:Yt.revenueGrid,children:[i.jsxs("div",{className:Yt.revenueCard,children:[i.jsx("h3",{className:Yt.revenueCardTitle,children:"Reception / Clinic"}),i.jsx("div",{className:"text-2xl font-bold mb-2",children:z(((T==null?void 0:T.consultation)||0)+((T==null?void 0:T.other)||0))}),i.jsx("ul",{className:Yt.revenueCardList,children:Object.entries(M.reception).map(([F,Y])=>i.jsxs("li",{className:Yt.revenueCardListItem,children:[i.jsx("span",{children:F}),i.jsx("span",{className:"font-medium text-gray-900",children:z(Y)})]},F))})]}),i.jsxs("div",{className:Yt.revenueCard,children:[i.jsx("h3",{className:Yt.revenueCardTitle,children:"Pharmacy"}),i.jsx("div",{className:"text-2xl font-bold mb-2",children:z((T==null?void 0:T.pharmacy)||0)}),b<0&&i.jsxs("div",{className:"text-sm text-red-500 mb-2",children:["Returns: ",z(b)]}),i.jsx("ul",{className:Yt.revenueCardList,children:Object.entries(M.pharmacy).map(([F,Y])=>i.jsxs("li",{className:Yt.revenueCardListItem,children:[i.jsx("span",{children:F}),i.jsx("span",{className:"font-medium text-gray-900",children:z(Y)})]},F))})]}),i.jsxs("div",{className:Yt.revenueCard,children:[i.jsx("h3",{className:Yt.revenueCardTitle,children:"Laboratory"}),i.jsx("div",{className:"text-2xl font-bold mb-2",children:z((T==null?void 0:T.lab)||0)}),i.jsx("ul",{className:Yt.revenueCardList,children:Object.entries(M.lab).map(([F,Y])=>i.jsxs("li",{className:Yt.revenueCardListItem,children:[i.jsx("span",{children:F}),i.jsx("span",{className:"font-medium text-gray-900",children:z(Y)})]},F))})]})]})]}),i.jsxs("section",{className:Yt.section,children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(Md,{className:"text-emerald-600"}),i.jsx("h2",{className:Yt.sectionTitle,children:"Inventory Movement"})]}),U&&U.pharmacyAnalysis.length>0?i.jsx("div",{className:Yt.tableContainer,children:i.jsxs("table",{className:Yt.table,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Item Name"}),i.jsx("th",{children:"Stock In"}),i.jsx("th",{children:"Stock Out"}),i.jsx("th",{children:"Net Change"}),i.jsx("th",{className:"text-right",children:"Est. Revenue"}),i.jsx("th",{className:"text-right",children:"Est. Profit"})]})}),i.jsx("tbody",{children:U.pharmacyAnalysis.map(F=>i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:F.name}),i.jsx("div",{className:"text-xs text-gray-500",children:F.supplier})]}),i.jsxs("td",{className:Yt.textGreen,children:["+",F.quantity_in,Object.entries(F.quantity_in_by_reason).map(([Y,R])=>i.jsxs("div",{className:"text-xs opacity-75",children:[Y,": ",R]},Y))]}),i.jsxs("td",{className:Yt.textRed,children:["-",F.quantity_out,Object.entries(F.quantity_out_by_reason).map(([Y,R])=>i.jsxs("div",{className:"text-xs opacity-75",children:[Y,": ",R]},Y))]}),i.jsx("td",{children:i.jsxs("span",{className:`font-semibold ${F.net_change>=0?"text-green-600":"text-red-600"}`,children:[F.net_change>0?"+":"",F.net_change]})}),i.jsx("td",{className:"text-right font-medium",children:z(F.revenue)}),i.jsx("td",{className:`text-right font-medium ${F.profit>=0?"text-green-600":"text-red-600"}`,children:z(F.profit)})]},F.drug_id))})]})}):i.jsx("div",{className:"text-center py-8 text-gray-500 mb-4 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:"No inventory movement recorded for this period."})]})]}),l&&i.jsxs("div",{className:Yt.loadingContainer,children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mb-4"}),i.jsx("div",{children:"Analyzing Financial & Inventory Data..."})]})]})},Lne=({user:e})=>{const n=Et(),[t,r]=w.useState(!1),[a,o]=w.useState([]),[l,d]=w.useState(0),[f,u]=w.useState(!1),p=w.useRef(null),g=w.useCallback(async()=>{if(e!=null&&e.clinic_id)try{const P=await pe("/api/notifications");if(P.ok){const U=(await P.json()).reduce((L,$)=>{const z=L.find(F=>F.message===$.message);return z?new Date($.created_at)>new Date(z.created_at)?L.map(F=>F.message===$.message?$:F):L:[...L,$]},[]).sort((L,$)=>{const z={expired_drug:1,near_expiry_drug:2,low_stock:3},F=z[L.type]||99,Y=z[$.type]||99;return F!==Y?F-Y:new Date($.created_at).getTime()-new Date(L.created_at).getTime()});o(U),d(U.filter(L=>!L.is_read).length)}}catch(P){console.error("Error fetching notifications:",P)}},[e==null?void 0:e.clinic_id]);w.useEffect(()=>{g();const P=setInterval(g,5*60*1e3);return()=>clearInterval(P)},[g]),w.useEffect(()=>{const P=M=>{p.current&&!p.current.contains(M.target)&&r(!1)};return t&&document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[t]);const b=()=>r(!t),v=async(P,M)=>{M.stopPropagation();try{(await pe(`/api/notifications/${P}/read`,{method:"PUT"})).ok&&(o(U=>U.map(L=>L.id===P?{...L,is_read:!0}:L)),d(U=>Math.max(0,U-1)))}catch(I){console.error("Error marking as read:",I)}},S=async()=>{const P=a.filter(M=>!M.is_read).map(M=>M.id);if(P.length!==0)try{(await pe("/api/notifications/mark-all-read",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationIds:P})})).ok&&(o(I=>I.map(U=>({...U,is_read:!0}))),d(0))}catch(M){console.error("Error marking all read",M)}},k=async()=>{u(!0);try{await pe("/api/notifications/trigger-all",{method:"POST"}),await g()}catch(P){console.error("Error triggering notifications",P)}finally{u(!1)}},T=P=>{switch(P){case"expired_drug":return i.jsx("div",{className:"notif-icon-bg expired",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})})});case"near_expiry_drug":return i.jsx("div",{className:"notif-icon-bg near-expiry",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})})});case"low_stock":return i.jsx("div",{className:"notif-icon-bg low-stock",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5m8.25 3.251l4.135 4.006a.956.956 0 01-1.352 1.354l-1.92-1.859V20.47a.862.862 0 11-1.725 0v-6.218l-1.92 1.86a.956.956 0 01-1.352-1.355l4.134-4.006zm0-5.836V7.5"})})});default:return i.jsx("div",{className:"notif-icon-bg default",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0"})})})}};return i.jsxs("div",{className:"notifications-section",ref:p,children:[i.jsxs("button",{className:`notification-icon ${t?"active":""}`,"aria-label":"Notifications",onClick:b,children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),l>0&&i.jsx("span",{className:"notification-count",children:l})]}),t&&i.jsxs("div",{className:"notifications-dropdown glass-effect",children:[i.jsxs("div",{className:"dropdown-header",children:[i.jsx("h3",{children:"Notifications"}),i.jsx("div",{className:"header-actions",children:l>0&&i.jsx("button",{className:"mark-all-btn",onClick:S,children:"Mark all read"})})]}),i.jsx("div",{className:"dropdown-list custom-scrollbar",children:a.filter(P=>!P.is_read).length>0?a.filter(P=>!P.is_read).map(P=>i.jsxs("div",{className:`dropdown-item ${P.is_read?"read":"unread"}`,onClick:M=>v(P.id,M),children:[i.jsx("div",{className:"item-icon",children:T(P.type)}),i.jsxs("div",{className:"item-content",children:[i.jsx("p",{className:"item-message",children:P.message}),i.jsx("span",{className:"item-time",children:ene(P.created_at)})]}),!P.is_read&&i.jsx("div",{className:"unread-dot"})]},P.id)):i.jsx("div",{className:"empty-state",children:i.jsx("p",{children:"No new notifications"})})}),i.jsxs("div",{className:"dropdown-footer",children:[i.jsx("button",{onClick:()=>{r(!1),n("/dashboard/notifications")},children:"View All History"}),(e.role==="admin"||e.role==="superadmin")&&i.jsx("button",{onClick:k,className:"refresh-btn",disabled:f,title:"Refresh Inventory Checks",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:f?"spin":"",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"})})})]})]})]})};function Fne(){const[e,n]=w.useState(!1),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),p=I=>{r(I),n(!0),I.role==="admin"&&!I.has_seen_tutorial&&u(!0)},g=()=>{n(!1),r(null),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")};w.useEffect(()=>{const I=localStorage.getItem("authToken"),U=localStorage.getItem("currentUser");if(I&&U)try{const L=JSON.parse(U);r(L),n(!0),L.role==="admin"&&!L.has_seen_tutorial&&u(!0)}catch(L){console.error("Error parsing stored user data:",L),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")}o(!1)},[]),w.useEffect(()=>{(async()=>{if(e&&t)try{const U=await jte();d(U)}catch(U){console.error("Error fetching clinic pro plan status:",U),d({hasProPlan:!1})}else d(null)})()},[e,t]);const[b,v]=w.useState(null),[S,k]=w.useState(!1);w.useEffect(()=>{const I=U=>{U.preventDefault(),v(U),k(!0),console.log("beforeinstallprompt event fired")};return window.addEventListener("beforeinstallprompt",I),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&(console.log("App is already installed (standalone)."),k(!1)),()=>{window.removeEventListener("beforeinstallprompt",I)}},[]),w.useEffect(()=>{const I=window.matchMedia("(prefers-color-scheme: dark)"),U=()=>{I.matches?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")};return U(),I.addEventListener("change",U),()=>{I.removeEventListener("change",U),document.body.classList.remove("dark-mode")}},[]);const T=w.useCallback(async()=>{if(!b){console.log("Install prompt event not available.");return}const I=b;I.prompt();const{outcome:U}=await I.userChoice;console.log(`User response to the install prompt: ${U}`),v(null),k(!1)},[b]),P=async()=>{if(t)try{(await pe(`/api/users/${t.id}/tutorial-seen`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({has_seen_tutorial:!0})})).ok?(r(U=>U?{...U,has_seen_tutorial:!0}:null),localStorage.setItem("currentUser",JSON.stringify({...t,has_seen_tutorial:!0})),u(!1)):console.error("Failed to update tutorial status on backend.")}catch(I){console.error("Error marking tutorial as seen:",I)}};return a?i.jsx(oP,{}):i.jsx(cP,{clientId:"277898779560-33obduhn8r758rini4qagetdrupvisri.apps.googleusercontent.com",children:i.jsxs(kD,{children:[i.jsx(FD,{children:i.jsxs(xh,{children:[i.jsx(ht,{path:"/login",element:e?i.jsx(vn,{to:"/dashboard"}):i.jsx(BD,{onLoginSuccess:p})}),i.jsx(ht,{path:"/register",element:e?i.jsx(vn,{to:"/dashboard"}):i.jsx(qD,{})}),i.jsx(ht,{path:"/handle-complaint-url",element:e?i.jsx(nne,{}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/live-api",element:e?i.jsx(qU,{}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/create-lab-order",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Jk,{currentUser:t})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/manage-admission",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Wk,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/lab/report/:orderId",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(E_,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/lab/enter-report/:orderId",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(E_,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/add-patient",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(j1,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/billing",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Dee,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/edit-complaint/:recordId",element:e&&t?i.jsx(__,{}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/edit-complaint/patient/:patientId",element:e&&t?i.jsx(__,{}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/edit-pharmacy-order/:orderId",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(pA,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/*",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:$ne(t.role,t,pe)}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/lab/view-report/:orderId",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(qee,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/lab/search-report",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Vee,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/patient/:patientId/lab-reports",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Hee,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/patient/:patientId/pharmacy-orders",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Iee,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/inventory",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(mA,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/inventory/add",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(k9,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/inventory/edit/:id",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(aT,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/lab-inventory",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(jw,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/patient/:patientId/complaints",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Aee,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/patient/:patientId/admission-bill/:billId",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Qee,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/start-subscription/:patientId",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(gte,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/start-clinic-subscription",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Ete,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/refill-reminders",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(tne,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/notifications",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(rne,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/create-custom-bill",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Qk,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/pharmacy-billing/:orderId",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(one,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/lab-billing/:orderId",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(lne,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/analysis",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(One,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"/dashboard/clinic-hub",element:e&&t?i.jsx(Kn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(cne,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(ht,{path:"*",element:i.jsx(vn,{to:e?"/dashboard":"/login"})})]})}),f&&i.jsx(Xte,{onClose:()=>u(!1),onMarkAsSeen:P})]})})}const $ne=(e,n,t)=>{switch(e){case"superadmin":return i.jsxs(xh,{children:[i.jsx(ht,{index:!0,element:i.jsx(Gte,{})}),i.jsx(ht,{path:"clinic-subscriptions",element:i.jsx(_te,{})}),i.jsx(ht,{path:"clinic-subscriptions/add",element:i.jsx(kte,{})}),i.jsx(ht,{path:"clinic-subscriptions/edit/:id",element:i.jsx(Tte,{})}),i.jsx(ht,{path:"users",element:i.jsx(Ate,{})})," ",i.jsx(ht,{path:"*",element:i.jsx("div",{children:"Unknown Super Admin Section"})})]});case"admin":return i.jsxs(xh,{children:[i.jsx(ht,{index:!0,element:i.jsx(KU,{fetchWithAuth:t})}),i.jsx(ht,{path:"staff",element:i.jsx(Wee,{fetchWithAuth:t})}),i.jsx(ht,{path:"staff/add",element:i.jsx(T9,{clinicId:n==null?void 0:n.clinic_id})}),i.jsx(ht,{path:"staff/edit/:id",element:i.jsx(E9,{})}),i.jsx(ht,{path:"patients/add",element:i.jsx(j1,{})}),i.jsx(ht,{path:"search-patient",element:i.jsx(Sh,{})}),i.jsx(ht,{path:"patients",element:i.jsx(N1,{})}),i.jsx(ht,{path:"inventory",element:i.jsx(iT,{})}),i.jsx(ht,{path:"inventory/edit/:id",element:i.jsx(aT,{})}),i.jsx(ht,{path:"distributors",element:i.jsx(P_,{})}),i.jsx(ht,{path:"purchase",element:i.jsx(D_,{})})," ",i.jsx(ht,{path:"queue",element:i.jsx(l0,{})}),i.jsx(ht,{path:"subscriptions",element:i.jsx(hte,{})}),i.jsx(ht,{path:"subscriptions/add",element:i.jsx(pte,{})}),i.jsx(ht,{path:"subscriptions/edit/:id",element:i.jsx(mte,{})}),i.jsx(ht,{path:"*",element:i.jsx("div",{children:"Unknown Admin Section"})})," "]});case"doctor":return i.jsxs(xh,{children:[i.jsx(ht,{index:!0,element:i.jsx(vn,{to:"search-patient",replace:!0})}),i.jsx(ht,{path:"search-patient",element:i.jsx(Sh,{})}),i.jsx(ht,{path:"queue",element:i.jsx(l0,{})}),i.jsx(ht,{path:":patientId",element:i.jsx(l0,{})}),i.jsx(ht,{path:"add-patient",element:i.jsx(j1,{})}),i.jsx(ht,{path:"*",element:i.jsx("div",{children:"Unknown Doctor Section"})})]});case"receptionist":return i.jsxs(xh,{children:[i.jsx(ht,{index:!0,element:i.jsx(ZU,{currentUser:n})}),i.jsx(ht,{path:"all-patients",element:i.jsx(N1,{})}),i.jsx(ht,{path:"search-patient",element:i.jsx(Sh,{})}),i.jsx(ht,{path:"*",element:i.jsx("div",{children:"Unknown Reception Section"})})," "]});case"lab":return i.jsx(N9,{});case"pharmacy":return i.jsxs(xh,{children:[i.jsx(ht,{index:!0,element:i.jsx(C9,{})}),i.jsx(ht,{path:"inventory",element:i.jsx(mA,{})}),i.jsx(ht,{path:"settings",element:i.jsx(_9,{})}),i.jsx(ht,{path:"add-order",element:i.jsx(Ree,{})}),i.jsx(ht,{path:"edit-pharmacy-order/:orderId",element:i.jsx(pA,{})}),i.jsx(ht,{path:"orders/:orderId",element:i.jsx(ste,{})}),i.jsx(ht,{path:"search-patient-records",element:i.jsx(Sh,{})}),i.jsx(ht,{path:"distributors",element:i.jsx(P_,{})}),i.jsx(ht,{path:"purchase",element:i.jsx(D_,{})})," ",i.jsx(ht,{path:"*",element:i.jsx(vn,{to:"/dashboard",replace:!0})})]});default:return i.jsxs("div",{children:["Unknown role (",e,") or dashboard not implemented."]},e)}},Kn=({user:e,onLogout:n,children:t,showInstallPrompt:r,onInstallClick:a,clinicProPlanStatus:o})=>{const l=Et(),[d,f]=w.useState(!1),[u,p]=w.useState(window.innerWidth<=768),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>J0.subscribe(T=>{S(T)}),[]),w.useEffect(()=>{const T=()=>{p(window.innerWidth<=768)};return window.addEventListener("resize",T),()=>window.removeEventListener("resize",T)},[]),w.useEffect(()=>{(async()=>{if(e!=null&&e.clinic_id)try{const P=await pe("/api/clinics/settings");if(P.ok){const M=await P.json();b(M.logoUrl)}else console.error("Failed to fetch clinic details for display:",P.statusText),b(null)}catch(P){console.error("Error fetching clinic details for display:",P),b(null)}else b(null)})()},[e==null?void 0:e.clinic_id]);const k=()=>{f(!d)};return i.jsxs("div",{className:"dashboard-layout",children:[" ",i.jsxs("nav",{className:"app-header no-print",children:[i.jsxs("div",{className:"header-left",children:[i.jsx("a",{href:"#",onClick:T=>{T.preventDefault(),l("/dashboard")},className:"logo-container",children:i.jsx("img",{src:g||"/logo.png",alt:"App Logo",className:"logo-image"})}),i.jsxs("div",{className:"title-section",children:[i.jsx("span",{className:"app-title-link",children:"Newtons Ai"}),i.jsxs("span",{className:"user-role-panel",children:["(",e.role.charAt(0).toUpperCase()+e.role.slice(1)," Panel)"]})]})]}),i.jsxs("div",{className:"header-right",children:[r&&i.jsxs("button",{onClick:a,className:"install-button",title:"Install App",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),i.jsx("span",{children:"Install"})]}),o&&(o.hasProPlan?i.jsx("span",{className:"pro-badge",children:"PRO"}):i.jsx("button",{onClick:()=>l("/start-clinic-subscription"),className:"go-pro-button",children:"GoPro"})),i.jsx(Lne,{user:e}),i.jsx("button",{className:"hamburger-icon",onClick:k,"aria-label":"Open navigation",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})})]}),v&&i.jsx("div",{className:"global-loading-bar"})]}),i.jsx("main",{className:"main-content",children:t}),u?i.jsx(ZD,{user:e,onLogout:n,userRole:e.role,isOpen:d,onClose:k,roleNavigation:X_}):i.jsx(XD,{user:e,onLogout:n,userRole:e.role,isOpen:d,onClose:k}),!u&&d&&i.jsx("div",{className:"side-panel-overlay",onClick:k})]})};sP.createRoot(document.getElementById("root")).render(i.jsx(w.StrictMode,{children:i.jsx(Fne,{})}));
