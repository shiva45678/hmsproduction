var oP=Object.defineProperty;var lP=(e,n,t)=>n in e?oP(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var Qn=(e,n,t)=>lP(e,typeof n!="symbol"?n+"":n,t);function cP(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const o=Object.getOwnPropertyDescriptor(r,a);o&&Object.defineProperty(e,a,o.get?o:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();var lu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Fv={exports:{}},wm={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pS;function uP(){if(pS)return wm;pS=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function t(r,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var d in a)d!=="key"&&(o[d]=a[d])}else o=a;return a=o.ref,{$$typeof:e,type:r,key:l,ref:a!==void 0?a:null,props:o}}return wm.Fragment=n,wm.jsx=t,wm.jsxs=t,wm}var mS;function dP(){return mS||(mS=1,Fv.exports=uP()),Fv.exports}var i=dP(),$v={exports:{}},Kt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gS;function fP(){if(gS)return Kt;gS=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.iterator;function b(E){return E===null||typeof E!="object"?null:(E=g&&E[g]||E["@@iterator"],typeof E=="function"?E:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,k={};function T(E,ce,ue){this.props=E,this.context=ce,this.refs=k,this.updater=ue||v}T.prototype.isReactComponent={},T.prototype.setState=function(E,ce){if(typeof E!="object"&&typeof E!="function"&&E!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,E,ce,"setState")},T.prototype.forceUpdate=function(E){this.updater.enqueueForceUpdate(this,E,"forceUpdate")};function A(){}A.prototype=T.prototype;function M(E,ce,ue){this.props=E,this.context=ce,this.refs=k,this.updater=ue||v}var R=M.prototype=new A;R.constructor=M,S(R,T.prototype),R.isPureReactComponent=!0;var z=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},L=Object.prototype.hasOwnProperty;function U(E,ce,ue,I,de,fe){return ue=fe.ref,{$$typeof:e,type:E,key:ce,ref:ue!==void 0?ue:null,props:fe}}function B(E,ce){return U(E.type,ce,void 0,void 0,void 0,E.props)}function J(E){return typeof E=="object"&&E!==null&&E.$$typeof===e}function D(E){var ce={"=":"=0",":":"=2"};return"$"+E.replace(/[=:]/g,function(ue){return ce[ue]})}var $=/\/+/g;function H(E,ce){return typeof E=="object"&&E!==null&&E.key!=null?D(""+E.key):ce.toString(36)}function te(){}function Q(E){switch(E.status){case"fulfilled":return E.value;case"rejected":throw E.reason;default:switch(typeof E.status=="string"?E.then(te,te):(E.status="pending",E.then(function(ce){E.status==="pending"&&(E.status="fulfilled",E.value=ce)},function(ce){E.status==="pending"&&(E.status="rejected",E.reason=ce)})),E.status){case"fulfilled":return E.value;case"rejected":throw E.reason}}throw E}function Y(E,ce,ue,I,de){var fe=typeof E;(fe==="undefined"||fe==="boolean")&&(E=null);var W=!1;if(E===null)W=!0;else switch(fe){case"bigint":case"string":case"number":W=!0;break;case"object":switch(E.$$typeof){case e:case n:W=!0;break;case p:return W=E._init,Y(W(E._payload),ce,ue,I,de)}}if(W)return de=de(E),W=I===""?"."+H(E,0):I,z(de)?(ue="",W!=null&&(ue=W.replace($,"$&/")+"/"),Y(de,ce,ue,"",function(je){return je})):de!=null&&(J(de)&&(de=B(de,ue+(de.key==null||E&&E.key===de.key?"":(""+de.key).replace($,"$&/")+"/")+W)),ce.push(de)),1;W=0;var oe=I===""?".":I+":";if(z(E))for(var se=0;se<E.length;se++)I=E[se],fe=oe+H(I,se),W+=Y(I,ce,ue,fe,de);else if(se=b(E),typeof se=="function")for(E=se.call(E),se=0;!(I=E.next()).done;)I=I.value,fe=oe+H(I,se++),W+=Y(I,ce,ue,fe,de);else if(fe==="object"){if(typeof E.then=="function")return Y(Q(E),ce,ue,I,de);throw ce=String(E),Error("Objects are not valid as a React child (found: "+(ce==="[object Object]"?"object with keys {"+Object.keys(E).join(", ")+"}":ce)+"). If you meant to render a collection of children, use an array instead.")}return W}function V(E,ce,ue){if(E==null)return E;var I=[],de=0;return Y(E,I,"","",function(fe){return ce.call(ue,fe,de++)}),I}function ae(E){if(E._status===-1){var ce=E._result;ce=ce(),ce.then(function(ue){(E._status===0||E._status===-1)&&(E._status=1,E._result=ue)},function(ue){(E._status===0||E._status===-1)&&(E._status=2,E._result=ue)}),E._status===-1&&(E._status=0,E._result=ce)}if(E._status===1)return E._result.default;throw E._result}var re=typeof reportError=="function"?reportError:function(E){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ce=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof E=="object"&&E!==null&&typeof E.message=="string"?String(E.message):String(E),error:E});if(!window.dispatchEvent(ce))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",E);return}console.error(E)};function le(){}return Kt.Children={map:V,forEach:function(E,ce,ue){V(E,function(){ce.apply(this,arguments)},ue)},count:function(E){var ce=0;return V(E,function(){ce++}),ce},toArray:function(E){return V(E,function(ce){return ce})||[]},only:function(E){if(!J(E))throw Error("React.Children.only expected to receive a single React element child.");return E}},Kt.Component=T,Kt.Fragment=t,Kt.Profiler=a,Kt.PureComponent=M,Kt.StrictMode=r,Kt.Suspense=f,Kt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,Kt.__COMPILER_RUNTIME={__proto__:null,c:function(E){return F.H.useMemoCache(E)}},Kt.cache=function(E){return function(){return E.apply(null,arguments)}},Kt.cloneElement=function(E,ce,ue){if(E==null)throw Error("The argument must be a React element, but you passed "+E+".");var I=S({},E.props),de=E.key,fe=void 0;if(ce!=null)for(W in ce.ref!==void 0&&(fe=void 0),ce.key!==void 0&&(de=""+ce.key),ce)!L.call(ce,W)||W==="key"||W==="__self"||W==="__source"||W==="ref"&&ce.ref===void 0||(I[W]=ce[W]);var W=arguments.length-2;if(W===1)I.children=ue;else if(1<W){for(var oe=Array(W),se=0;se<W;se++)oe[se]=arguments[se+2];I.children=oe}return U(E.type,de,void 0,void 0,fe,I)},Kt.createContext=function(E){return E={$$typeof:l,_currentValue:E,_currentValue2:E,_threadCount:0,Provider:null,Consumer:null},E.Provider=E,E.Consumer={$$typeof:o,_context:E},E},Kt.createElement=function(E,ce,ue){var I,de={},fe=null;if(ce!=null)for(I in ce.key!==void 0&&(fe=""+ce.key),ce)L.call(ce,I)&&I!=="key"&&I!=="__self"&&I!=="__source"&&(de[I]=ce[I]);var W=arguments.length-2;if(W===1)de.children=ue;else if(1<W){for(var oe=Array(W),se=0;se<W;se++)oe[se]=arguments[se+2];de.children=oe}if(E&&E.defaultProps)for(I in W=E.defaultProps,W)de[I]===void 0&&(de[I]=W[I]);return U(E,fe,void 0,void 0,null,de)},Kt.createRef=function(){return{current:null}},Kt.forwardRef=function(E){return{$$typeof:d,render:E}},Kt.isValidElement=J,Kt.lazy=function(E){return{$$typeof:p,_payload:{_status:-1,_result:E},_init:ae}},Kt.memo=function(E,ce){return{$$typeof:u,type:E,compare:ce===void 0?null:ce}},Kt.startTransition=function(E){var ce=F.T,ue={};F.T=ue;try{var I=E(),de=F.S;de!==null&&de(ue,I),typeof I=="object"&&I!==null&&typeof I.then=="function"&&I.then(le,re)}catch(fe){re(fe)}finally{F.T=ce}},Kt.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},Kt.use=function(E){return F.H.use(E)},Kt.useActionState=function(E,ce,ue){return F.H.useActionState(E,ce,ue)},Kt.useCallback=function(E,ce){return F.H.useCallback(E,ce)},Kt.useContext=function(E){return F.H.useContext(E)},Kt.useDebugValue=function(){},Kt.useDeferredValue=function(E,ce){return F.H.useDeferredValue(E,ce)},Kt.useEffect=function(E,ce,ue){var I=F.H;if(typeof ue=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return I.useEffect(E,ce)},Kt.useId=function(){return F.H.useId()},Kt.useImperativeHandle=function(E,ce,ue){return F.H.useImperativeHandle(E,ce,ue)},Kt.useInsertionEffect=function(E,ce){return F.H.useInsertionEffect(E,ce)},Kt.useLayoutEffect=function(E,ce){return F.H.useLayoutEffect(E,ce)},Kt.useMemo=function(E,ce){return F.H.useMemo(E,ce)},Kt.useOptimistic=function(E,ce){return F.H.useOptimistic(E,ce)},Kt.useReducer=function(E,ce,ue){return F.H.useReducer(E,ce,ue)},Kt.useRef=function(E){return F.H.useRef(E)},Kt.useState=function(E){return F.H.useState(E)},Kt.useSyncExternalStore=function(E,ce,ue){return F.H.useSyncExternalStore(E,ce,ue)},Kt.useTransition=function(){return F.H.useTransition()},Kt.version="19.1.0",Kt}var yS;function rw(){return yS||(yS=1,$v.exports=fP()),$v.exports}var w=rw();const _n=qd(w),xS=cP({__proto__:null,default:_n},[w]);var zv={exports:{}},Sm={},Uv={exports:{}},Bv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bS;function hP(){return bS||(bS=1,function(e){function n(V,ae){var re=V.length;V.push(ae);e:for(;0<re;){var le=re-1>>>1,E=V[le];if(0<a(E,ae))V[le]=ae,V[re]=E,re=le;else break e}}function t(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var ae=V[0],re=V.pop();if(re!==ae){V[0]=re;e:for(var le=0,E=V.length,ce=E>>>1;le<ce;){var ue=2*(le+1)-1,I=V[ue],de=ue+1,fe=V[de];if(0>a(I,re))de<E&&0>a(fe,I)?(V[le]=fe,V[de]=re,le=de):(V[le]=I,V[ue]=re,le=ue);else if(de<E&&0>a(fe,re))V[le]=fe,V[de]=re,le=de;else break e}}return ae}function a(V,ae){var re=V.sortIndex-ae.sortIndex;return re!==0?re:V.id-ae.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,d=l.now();e.unstable_now=function(){return l.now()-d}}var f=[],u=[],p=1,g=null,b=3,v=!1,S=!1,k=!1,T=!1,A=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function z(V){for(var ae=t(u);ae!==null;){if(ae.callback===null)r(u);else if(ae.startTime<=V)r(u),ae.sortIndex=ae.expirationTime,n(f,ae);else break;ae=t(u)}}function F(V){if(k=!1,z(V),!S)if(t(f)!==null)S=!0,L||(L=!0,H());else{var ae=t(u);ae!==null&&Y(F,ae.startTime-V)}}var L=!1,U=-1,B=5,J=-1;function D(){return T?!0:!(e.unstable_now()-J<B)}function $(){if(T=!1,L){var V=e.unstable_now();J=V;var ae=!0;try{e:{S=!1,k&&(k=!1,M(U),U=-1),v=!0;var re=b;try{t:{for(z(V),g=t(f);g!==null&&!(g.expirationTime>V&&D());){var le=g.callback;if(typeof le=="function"){g.callback=null,b=g.priorityLevel;var E=le(g.expirationTime<=V);if(V=e.unstable_now(),typeof E=="function"){g.callback=E,z(V),ae=!0;break t}g===t(f)&&r(f),z(V)}else r(f);g=t(f)}if(g!==null)ae=!0;else{var ce=t(u);ce!==null&&Y(F,ce.startTime-V),ae=!1}}break e}finally{g=null,b=re,v=!1}ae=void 0}}finally{ae?H():L=!1}}}var H;if(typeof R=="function")H=function(){R($)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,Q=te.port2;te.port1.onmessage=$,H=function(){Q.postMessage(null)}}else H=function(){A($,0)};function Y(V,ae){U=A(function(){V(e.unstable_now())},ae)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(V){switch(b){case 1:case 2:case 3:var ae=3;break;default:ae=b}var re=b;b=ae;try{return V()}finally{b=re}},e.unstable_requestPaint=function(){T=!0},e.unstable_runWithPriority=function(V,ae){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var re=b;b=V;try{return ae()}finally{b=re}},e.unstable_scheduleCallback=function(V,ae,re){var le=e.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?le+re:le):re=le,V){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=re+E,V={id:p++,callback:ae,priorityLevel:V,startTime:re,expirationTime:E,sortIndex:-1},re>le?(V.sortIndex=re,n(u,V),t(f)===null&&V===t(u)&&(k?(M(U),U=-1):k=!0,Y(F,re-le))):(V.sortIndex=E,n(f,V),S||v||(S=!0,L||(L=!0,H()))),V},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(V){var ae=b;return function(){var re=b;b=ae;try{return V.apply(this,arguments)}finally{b=re}}}}(Bv)),Bv}var vS;function pP(){return vS||(vS=1,Uv.exports=hP()),Uv.exports}var qv={exports:{}},Si={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wS;function mP(){if(wS)return Si;wS=1;var e=rw();function n(f){var u="https://react.dev/errors/"+f;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+f+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(n(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(f,u,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:g==null?null:""+g,children:f,containerInfo:u,implementation:p}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,u){if(f==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return Si.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Si.createPortal=function(f,u){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(n(299));return o(f,u,null,p)},Si.flushSync=function(f){var u=l.T,p=r.p;try{if(l.T=null,r.p=2,f)return f()}finally{l.T=u,r.p=p,r.d.f()}},Si.preconnect=function(f,u){typeof f=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,r.d.C(f,u))},Si.prefetchDNS=function(f){typeof f=="string"&&r.d.D(f)},Si.preinit=function(f,u){if(typeof f=="string"&&u&&typeof u.as=="string"){var p=u.as,g=d(p,u.crossOrigin),b=typeof u.integrity=="string"?u.integrity:void 0,v=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;p==="style"?r.d.S(f,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:g,integrity:b,fetchPriority:v}):p==="script"&&r.d.X(f,{crossOrigin:g,integrity:b,fetchPriority:v,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},Si.preinitModule=function(f,u){if(typeof f=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var p=d(u.as,u.crossOrigin);r.d.M(f,{crossOrigin:p,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&r.d.M(f)},Si.preload=function(f,u){if(typeof f=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var p=u.as,g=d(p,u.crossOrigin);r.d.L(f,p,{crossOrigin:g,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},Si.preloadModule=function(f,u){if(typeof f=="string")if(u){var p=d(u.as,u.crossOrigin);r.d.m(f,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:p,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else r.d.m(f)},Si.requestFormReset=function(f){r.d.r(f)},Si.unstable_batchedUpdates=function(f,u){return f(u)},Si.useFormState=function(f,u,p){return l.H.useFormState(f,u,p)},Si.useFormStatus=function(){return l.H.useHostTransitionStatus()},Si.version="19.1.0",Si}var SS;function zj(){if(SS)return qv.exports;SS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),qv.exports=mP(),qv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NS;function gP(){if(NS)return Sm;NS=1;var e=pP(),n=rw(),t=zj();function r(s){var c="https://react.dev/errors/"+s;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+s+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var c=s,h=s;if(s.alternate)for(;c.return;)c=c.return;else{s=c;do c=s,(c.flags&4098)!==0&&(h=c.return),s=c.return;while(s)}return c.tag===3?h:null}function l(s){if(s.tag===13){var c=s.memoizedState;if(c===null&&(s=s.alternate,s!==null&&(c=s.memoizedState)),c!==null)return c.dehydrated}return null}function d(s){if(o(s)!==s)throw Error(r(188))}function f(s){var c=s.alternate;if(!c){if(c=o(s),c===null)throw Error(r(188));return c!==s?null:s}for(var h=s,x=c;;){var N=h.return;if(N===null)break;var P=N.alternate;if(P===null){if(x=N.return,x!==null){h=x;continue}break}if(N.child===P.child){for(P=N.child;P;){if(P===h)return d(N),s;if(P===x)return d(N),c;P=P.sibling}throw Error(r(188))}if(h.return!==x.return)h=N,x=P;else{for(var q=!1,ee=N.child;ee;){if(ee===h){q=!0,h=N,x=P;break}if(ee===x){q=!0,x=N,h=P;break}ee=ee.sibling}if(!q){for(ee=P.child;ee;){if(ee===h){q=!0,h=P,x=N;break}if(ee===x){q=!0,x=P,h=N;break}ee=ee.sibling}if(!q)throw Error(r(189))}}if(h.alternate!==x)throw Error(r(190))}if(h.tag!==3)throw Error(r(188));return h.stateNode.current===h?s:c}function u(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s;for(s=s.child;s!==null;){if(c=u(s),c!==null)return c;s=s.sibling}return null}var p=Object.assign,g=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),M=Symbol.for("react.consumer"),R=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),J=Symbol.for("react.activity"),D=Symbol.for("react.memo_cache_sentinel"),$=Symbol.iterator;function H(s){return s===null||typeof s!="object"?null:(s=$&&s[$]||s["@@iterator"],typeof s=="function"?s:null)}var te=Symbol.for("react.client.reference");function Q(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===te?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case S:return"Fragment";case T:return"Profiler";case k:return"StrictMode";case F:return"Suspense";case L:return"SuspenseList";case J:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case v:return"Portal";case R:return(s.displayName||"Context")+".Provider";case M:return(s._context.displayName||"Context")+".Consumer";case z:var c=s.render;return s=s.displayName,s||(s=c.displayName||c.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case U:return c=s.displayName||null,c!==null?c:Q(s.type)||"Memo";case B:c=s._payload,s=s._init;try{return Q(s(c))}catch{}}return null}var Y=Array.isArray,V=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re={pending:!1,data:null,method:null,action:null},le=[],E=-1;function ce(s){return{current:s}}function ue(s){0>E||(s.current=le[E],le[E]=null,E--)}function I(s,c){E++,le[E]=s.current,s.current=c}var de=ce(null),fe=ce(null),W=ce(null),oe=ce(null);function se(s,c){switch(I(W,c),I(fe,s),I(de,null),c.nodeType){case 9:case 11:s=(s=c.documentElement)&&(s=s.namespaceURI)?ir(s):0;break;default:if(s=c.tagName,c=c.namespaceURI)c=ir(c),s=lr(c,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ue(de),I(de,s)}function je(){ue(de),ue(fe),ue(W)}function We(s){s.memoizedState!==null&&I(oe,s);var c=de.current,h=lr(c,s.type);c!==h&&(I(fe,s),I(de,h))}function X(s){fe.current===s&&(ue(de),ue(fe)),oe.current===s&&(ue(oe),tu._currentValue=re)}var Se=Object.prototype.hasOwnProperty,Ae=e.unstable_scheduleCallback,Pe=e.unstable_cancelCallback,Ze=e.unstable_shouldYield,rt=e.unstable_requestPaint,lt=e.unstable_now,ze=e.unstable_getCurrentPriorityLevel,ot=e.unstable_ImmediatePriority,at=e.unstable_UserBlockingPriority,be=e.unstable_NormalPriority,$e=e.unstable_LowPriority,Be=e.unstable_IdlePriority,ke=e.log,Ne=e.unstable_setDisableYieldValue,K=null,ge=null;function He(s){if(typeof ke=="function"&&Ne(s),ge&&typeof ge.setStrictMode=="function")try{ge.setStrictMode(K,s)}catch{}}var Qe=Math.clz32?Math.clz32:Ht,dt=Math.log,At=Math.LN2;function Ht(s){return s>>>=0,s===0?32:31-(dt(s)/At|0)|0}var we=256,xe=4194304;function Me(s){var c=s&42;if(c!==0)return c;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function De(s,c,h){var x=s.pendingLanes;if(x===0)return 0;var N=0,P=s.suspendedLanes,q=s.pingedLanes;s=s.warmLanes;var ee=x&134217727;return ee!==0?(x=ee&~P,x!==0?N=Me(x):(q&=ee,q!==0?N=Me(q):h||(h=ee&~s,h!==0&&(N=Me(h))))):(ee=x&~P,ee!==0?N=Me(ee):q!==0?N=Me(q):h||(h=x&~s,h!==0&&(N=Me(h)))),N===0?0:c!==0&&c!==N&&(c&P)===0&&(P=N&-N,h=c&-c,P>=h||P===32&&(h&4194048)!==0)?c:N}function qe(s,c){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&c)===0}function st(s,c){switch(s){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yt(){var s=we;return we<<=1,(we&4194048)===0&&(we=256),s}function _t(){var s=xe;return xe<<=1,(xe&62914560)===0&&(xe=4194304),s}function cn(s){for(var c=[],h=0;31>h;h++)c.push(s);return c}function gn(s,c){s.pendingLanes|=c,c!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Cn(s,c,h,x,N,P){var q=s.pendingLanes;s.pendingLanes=h,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=h,s.entangledLanes&=h,s.errorRecoveryDisabledLanes&=h,s.shellSuspendCounter=0;var ee=s.entanglements,ve=s.expirationTimes,Le=s.hiddenUpdates;for(h=q&~h;0<h;){var Ke=31-Qe(h),tt=1<<Ke;ee[Ke]=0,ve[Ke]=-1;var Ue=Le[Ke];if(Ue!==null)for(Le[Ke]=null,Ke=0;Ke<Ue.length;Ke++){var Fe=Ue[Ke];Fe!==null&&(Fe.lane&=-536870913)}h&=~tt}x!==0&&wt(s,x,0),P!==0&&N===0&&s.tag!==0&&(s.suspendedLanes|=P&~(q&~c))}function wt(s,c,h){s.pendingLanes|=c,s.suspendedLanes&=~c;var x=31-Qe(c);s.entangledLanes|=c,s.entanglements[x]=s.entanglements[x]|1073741824|h&4194090}function bt(s,c){var h=s.entangledLanes|=c;for(s=s.entanglements;h;){var x=31-Qe(h),N=1<<x;N&c|s[x]&c&&(s[x]|=c),h&=~N}}function Ft(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function St(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Jn(){var s=ae.p;return s!==0?s:(s=window.event,s===void 0?32:rx(s.type))}function Yi(s,c){var h=ae.p;try{return ae.p=s,c()}finally{ae.p=h}}var vr=Math.random().toString(36).slice(2),yn="__reactFiber$"+vr,wr="__reactProps$"+vr,Ei="__reactContainer$"+vr,bu="__reactEvents$"+vr,vu="__reactListeners$"+vr,Jh="__reactHandles$"+vr,nl="__reactResources$"+vr,Xs="__reactMarker$"+vr;function tc(s){delete s[yn],delete s[wr],delete s[bu],delete s[vu],delete s[Jh]}function ms(s){var c=s[yn];if(c)return c;for(var h=s.parentNode;h;){if(c=h[Ei]||h[yn]){if(h=c.alternate,c.child!==null||h!==null&&h.child!==null)for(s=Hy(s);s!==null;){if(h=s[yn])return h;s=Hy(s)}return c}s=h,h=s.parentNode}return null}function Zs(s){if(s=s[yn]||s[Ei]){var c=s.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return s}return null}function eo(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s.stateNode;throw Error(r(33))}function to(s){var c=s[nl];return c||(c=s[nl]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function gr(s){s[Xs]=!0}var Yd=new Set,Wd={};function gs(s,c){no(s,c),no(s+"Capture",c)}function no(s,c){for(Wd[s]=c,s=0;s<c.length;s++)Yd.add(c[s])}var nc=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Qd={},ys={};function Wi(s){return Se.call(ys,s)?!0:Se.call(Qd,s)?!1:nc.test(s)?ys[s]=!0:(Qd[s]=!0,!1)}function za(s,c,h){if(Wi(c))if(h===null)s.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":s.removeAttribute(c);return;case"boolean":var x=c.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){s.removeAttribute(c);return}}s.setAttribute(c,""+h)}}function rl(s,c,h){if(h===null)s.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttribute(c,""+h)}}function Ai(s,c,h,x){if(x===null)s.removeAttribute(h);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(h);return}s.setAttributeNS(c,h,""+x)}}var il,al;function Ua(s){if(il===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);il=c&&c[1]||"",al=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+il+s+al}var rc=!1;function ic(s,c){if(!s||rc)return"";rc=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(c){var tt=function(){throw Error()};if(Object.defineProperty(tt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(tt,[])}catch(Fe){var Ue=Fe}Reflect.construct(s,[],tt)}else{try{tt.call()}catch(Fe){Ue=Fe}s.call(tt.prototype)}}else{try{throw Error()}catch(Fe){Ue=Fe}(tt=s())&&typeof tt.catch=="function"&&tt.catch(function(){})}}catch(Fe){if(Fe&&Ue&&typeof Fe.stack=="string")return[Fe.stack,Ue.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var P=x.DetermineComponentFrameRoot(),q=P[0],ee=P[1];if(q&&ee){var ve=q.split(`
`),Le=ee.split(`
`);for(N=x=0;x<ve.length&&!ve[x].includes("DetermineComponentFrameRoot");)x++;for(;N<Le.length&&!Le[N].includes("DetermineComponentFrameRoot");)N++;if(x===ve.length||N===Le.length)for(x=ve.length-1,N=Le.length-1;1<=x&&0<=N&&ve[x]!==Le[N];)N--;for(;1<=x&&0<=N;x--,N--)if(ve[x]!==Le[N]){if(x!==1||N!==1)do if(x--,N--,0>N||ve[x]!==Le[N]){var Ke=`
`+ve[x].replace(" at new "," at ");return s.displayName&&Ke.includes("<anonymous>")&&(Ke=Ke.replace("<anonymous>",s.displayName)),Ke}while(1<=x&&0<=N);break}}}finally{rc=!1,Error.prepareStackTrace=h}return(h=s?s.displayName||s.name:"")?Ua(h):""}function ac(s){switch(s.tag){case 26:case 27:case 5:return Ua(s.type);case 16:return Ua("Lazy");case 13:return Ua("Suspense");case 19:return Ua("SuspenseList");case 0:case 15:return ic(s.type,!1);case 11:return ic(s.type.render,!1);case 1:return ic(s.type,!0);case 31:return Ua("Activity");default:return""}}function wu(s){try{var c="";do c+=ac(s),s=s.return;while(s);return c}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}function Jr(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function sc(s){var c=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function oc(s){var c=sc(s)?"checked":"value",h=Object.getOwnPropertyDescriptor(s.constructor.prototype,c),x=""+s[c];if(!s.hasOwnProperty(c)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var N=h.get,P=h.set;return Object.defineProperty(s,c,{configurable:!0,get:function(){return N.call(this)},set:function(q){x=""+q,P.call(this,q)}}),Object.defineProperty(s,c,{enumerable:h.enumerable}),{getValue:function(){return x},setValue:function(q){x=""+q},stopTracking:function(){s._valueTracker=null,delete s[c]}}}}function sl(s){s._valueTracker||(s._valueTracker=oc(s))}function ro(s){if(!s)return!1;var c=s._valueTracker;if(!c)return!0;var h=c.getValue(),x="";return s&&(x=sc(s)?s.checked?"true":"false":s.value),s=x,s!==h?(c.setValue(s),!0):!1}function Ba(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var lc=/[\n"\\]/g;function Kr(s){return s.replace(lc,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function io(s,c,h,x,N,P,q,ee){s.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?s.type=q:s.removeAttribute("type"),c!=null?q==="number"?(c===0&&s.value===""||s.value!=c)&&(s.value=""+Jr(c)):s.value!==""+Jr(c)&&(s.value=""+Jr(c)):q!=="submit"&&q!=="reset"||s.removeAttribute("value"),c!=null?xs(s,q,Jr(c)):h!=null?xs(s,q,Jr(h)):x!=null&&s.removeAttribute("value"),N==null&&P!=null&&(s.defaultChecked=!!P),N!=null&&(s.checked=N&&typeof N!="function"&&typeof N!="symbol"),ee!=null&&typeof ee!="function"&&typeof ee!="symbol"&&typeof ee!="boolean"?s.name=""+Jr(ee):s.removeAttribute("name")}function cc(s,c,h,x,N,P,q,ee){if(P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"&&(s.type=P),c!=null||h!=null){if(!(P!=="submit"&&P!=="reset"||c!=null))return;h=h!=null?""+Jr(h):"",c=c!=null?""+Jr(c):h,ee||c===s.value||(s.value=c),s.defaultValue=c}x=x??N,x=typeof x!="function"&&typeof x!="symbol"&&!!x,s.checked=ee?s.checked:!!x,s.defaultChecked=!!x,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(s.name=q)}function xs(s,c,h){c==="number"&&Ba(s.ownerDocument)===s||s.defaultValue===""+h||(s.defaultValue=""+h)}function bs(s,c,h,x){if(s=s.options,c){c={};for(var N=0;N<h.length;N++)c["$"+h[N]]=!0;for(h=0;h<s.length;h++)N=c.hasOwnProperty("$"+s[h].value),s[h].selected!==N&&(s[h].selected=N),N&&x&&(s[h].defaultSelected=!0)}else{for(h=""+Jr(h),c=null,N=0;N<s.length;N++){if(s[N].value===h){s[N].selected=!0,x&&(s[N].defaultSelected=!0);return}c!==null||s[N].disabled||(c=s[N])}c!==null&&(c.selected=!0)}}function ol(s,c,h){if(c!=null&&(c=""+Jr(c),c!==s.value&&(s.value=c),h==null)){s.defaultValue!==c&&(s.defaultValue=c);return}s.defaultValue=h!=null?""+Jr(h):""}function ll(s,c,h,x){if(c==null){if(x!=null){if(h!=null)throw Error(r(92));if(Y(x)){if(1<x.length)throw Error(r(93));x=x[0]}h=x}h==null&&(h=""),c=h}h=Jr(c),s.defaultValue=h,x=s.textContent,x===h&&x!==""&&x!==null&&(s.value=x)}function Pi(s,c){if(c){var h=s.firstChild;if(h&&h===s.lastChild&&h.nodeType===3){h.nodeValue=c;return}}s.textContent=c}var Qi=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ao(s,c,h){var x=c.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?x?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="":x?s.setProperty(c,h):typeof h!="number"||h===0||Qi.has(c)?c==="float"?s.cssFloat=h:s[c]=(""+h).trim():s[c]=h+"px"}function uc(s,c,h){if(c!=null&&typeof c!="object")throw Error(r(62));if(s=s.style,h!=null){for(var x in h)!h.hasOwnProperty(x)||c!=null&&c.hasOwnProperty(x)||(x.indexOf("--")===0?s.setProperty(x,""):x==="float"?s.cssFloat="":s[x]="");for(var N in c)x=c[N],c.hasOwnProperty(N)&&h[N]!==x&&ao(s,N,x)}else for(var P in c)c.hasOwnProperty(P)&&ao(s,P,c[P])}function so(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Jd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),dc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function vs(s){return dc.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var oo=null;function cl(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var qa=null,Va=null;function ul(s){var c=Zs(s);if(c&&(s=c.stateNode)){var h=s[wr]||null;e:switch(s=c.stateNode,c.type){case"input":if(io(s,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),c=h.name,h.type==="radio"&&c!=null){for(h=s;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+Kr(""+c)+'"][type="radio"]'),c=0;c<h.length;c++){var x=h[c];if(x!==s&&x.form===s.form){var N=x[wr]||null;if(!N)throw Error(r(90));io(x,N.value,N.defaultValue,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name)}}for(c=0;c<h.length;c++)x=h[c],x.form===s.form&&ro(x)}break e;case"textarea":ol(s,h.value,h.defaultValue);break e;case"select":c=h.value,c!=null&&bs(s,!!h.multiple,c,!1)}}}var dl=!1;function fc(s,c,h){if(dl)return s(c,h);dl=!0;try{var x=s(c);return x}finally{if(dl=!1,(qa!==null||Va!==null)&&(Vf(),qa&&(c=qa,s=Va,Va=qa=null,ul(c),s)))for(c=0;c<s.length;c++)ul(s[c])}}function Xr(s,c){var h=s.stateNode;if(h===null)return null;var x=h[wr]||null;if(x===null)return null;h=x[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(s=s.type,x=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!x;break e;default:s=!1}if(s)return null;if(h&&typeof h!="function")throw Error(r(231,c,typeof h));return h}var Di=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),lo=!1;if(Di)try{var Ii={};Object.defineProperty(Ii,"passive",{get:function(){lo=!0}}),window.addEventListener("test",Ii,Ii),window.removeEventListener("test",Ii,Ii)}catch{lo=!1}var Ha=null,fl=null,hc=null;function pc(){if(hc)return hc;var s,c=fl,h=c.length,x,N="value"in Ha?Ha.value:Ha.textContent,P=N.length;for(s=0;s<h&&c[s]===N[s];s++);var q=h-s;for(x=1;x<=q&&c[h-x]===N[P-x];x++);return hc=N.slice(s,1<x?1-x:void 0)}function xn(s){var c=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&c===13&&(s=13)):s=c,s===10&&(s=13),32<=s||s===13?s:0}function kn(){return!0}function hl(){return!1}function $r(s){function c(h,x,N,P,q){this._reactName=h,this._targetInst=N,this.type=x,this.nativeEvent=P,this.target=q,this.currentTarget=null;for(var ee in s)s.hasOwnProperty(ee)&&(h=s[ee],this[ee]=h?h(P):P[ee]);return this.isDefaultPrevented=(P.defaultPrevented!=null?P.defaultPrevented:P.returnValue===!1)?kn:hl,this.isPropagationStopped=hl,this}return p(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=kn)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=kn)},persist:function(){},isPersistent:kn}),c}var xa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pl=$r(xa),co=p({},xa,{view:0,detail:0}),Kd=$r(co),uo,mc,Hn,ba=p({},co,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ei,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Hn&&(Hn&&s.type==="mousemove"?(uo=s.screenX-Hn.screenX,mc=s.screenY-Hn.screenY):mc=uo=0,Hn=s),uo)},movementY:function(s){return"movementY"in s?s.movementY:mc}}),Ga=$r(ba),gc=p({},ba,{dataTransfer:0}),ml=$r(gc),Zr=p({},co,{relatedTarget:0}),wn=$r(Zr),yc=p({},xa,{animationName:0,elapsedTime:0,pseudoElement:0}),gl=$r(yc),xc=p({},xa,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),fo=$r(xc),ho=p({},xa,{data:0}),Vr=$r(ho),Xd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Zd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bc(s){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(s):(s=Zd[s])?!!c[s]:!1}function ei(){return bc}var va=p({},co,{key:function(s){if(s.key){var c=Xd[s.key]||s.key;if(c!=="Unidentified")return c}return s.type==="keypress"?(s=xn(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Sr[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ei,charCode:function(s){return s.type==="keypress"?xn(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?xn(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),vc=$r(va),Gn=p({},ba,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ji=$r(Gn),ws=p({},co,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ei}),Kh=$r(ws),Ya=p({},xa,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xh=$r(Ya),ef=p({},ba,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),po=$r(ef),Ss=p({},xa,{newState:0,oldState:0}),Wa=$r(Ss),mo=[9,13,27,32],yl=Di&&"CompositionEvent"in window,Ns=null;Di&&"documentMode"in document&&(Ns=document.documentMode);var xl=Di&&"TextEvent"in window&&!Ns,bl=Di&&(!yl||Ns&&8<Ns&&11>=Ns),wc=" ",Su=!1;function tf(s,c){switch(s){case"keyup":return mo.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Sc(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Qa=!1;function Zh(s,c){switch(s){case"compositionend":return Sc(c);case"keypress":return c.which!==32?null:(Su=!0,wc);case"textInput":return s=c.data,s===wc&&Su?null:s;default:return null}}function nf(s,c){if(Qa)return s==="compositionend"||!yl&&tf(s,c)?(s=pc(),hc=fl=Ha=null,Qa=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return bl&&c.locale!=="ko"?null:c.data;default:return null}}var ti={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vl(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c==="input"?!!ti[s.type]:c==="textarea"}function go(s,c,h,x){qa?Va?Va.push(x):Va=[x]:qa=x,c=Kf(c,"onChange"),0<c.length&&(h=new pl("onChange","change",null,h,x),s.push({event:h,listeners:c}))}var wa=null,yo=null;function Ja(s){Ly(s,0)}function Ri(s){var c=eo(s);if(ro(c))return s}function Ki(s,c){if(s==="change")return c}var Nu=!1;if(Di){var Nc;if(Di){var Sa="oninput"in document;if(!Sa){var Cu=document.createElement("div");Cu.setAttribute("oninput","return;"),Sa=typeof Cu.oninput=="function"}Nc=Sa}else Nc=!1;Nu=Nc&&(!document.documentMode||9<document.documentMode)}function xo(){wa&&(wa.detachEvent("onpropertychange",wl),yo=wa=null)}function wl(s){if(s.propertyName==="value"&&Ri(yo)){var c=[];go(c,yo,s,cl(s)),fc(Ja,c)}}function _u(s,c,h){s==="focusin"?(xo(),wa=c,yo=h,wa.attachEvent("onpropertychange",wl)):s==="focusout"&&xo()}function Ka(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Ri(yo)}function Sl(s,c){if(s==="click")return Ri(c)}function ep(s,c){if(s==="input"||s==="change")return Ri(c)}function tp(s,c){return s===c&&(s!==0||1/s===1/c)||s!==s&&c!==c}var ni=typeof Object.is=="function"?Object.is:tp;function Xi(s,c){if(ni(s,c))return!0;if(typeof s!="object"||s===null||typeof c!="object"||c===null)return!1;var h=Object.keys(s),x=Object.keys(c);if(h.length!==x.length)return!1;for(x=0;x<h.length;x++){var N=h[x];if(!Se.call(c,N)||!ni(s[N],c[N]))return!1}return!0}function ui(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function ju(s,c){var h=ui(s);s=0;for(var x;h;){if(h.nodeType===3){if(x=s+h.textContent.length,s<=c&&x>=c)return{node:h,offset:c-s};s=x}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=ui(h)}}function Cs(s,c){return s&&c?s===c?!0:s&&s.nodeType===3?!1:c&&c.nodeType===3?Cs(s,c.parentNode):"contains"in s?s.contains(c):s.compareDocumentPosition?!!(s.compareDocumentPosition(c)&16):!1:!1}function rf(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var c=Ba(s.document);c instanceof s.HTMLIFrameElement;){try{var h=typeof c.contentWindow.location.href=="string"}catch{h=!1}if(h)s=c.contentWindow;else break;c=Ba(s.document)}return c}function Nl(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c&&(c==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||c==="textarea"||s.contentEditable==="true")}var np=Di&&"documentMode"in document&&11>=document.documentMode,Xa=null,Za=null,Ee=null,Ye=!1;function Ve(s,c,h){var x=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Ye||Xa==null||Xa!==Ba(x)||(x=Xa,"selectionStart"in x&&Nl(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Ee&&Xi(Ee,x)||(Ee=x,x=Kf(Za,"onSelect"),0<x.length&&(c=new pl("onSelect","select",null,c,h),s.push({event:c,listeners:x}),c.target=Xa)))}function pt(s,c){var h={};return h[s.toLowerCase()]=c.toLowerCase(),h["Webkit"+s]="webkit"+c,h["Moz"+s]="moz"+c,h}var Dt={animationend:pt("Animation","AnimationEnd"),animationiteration:pt("Animation","AnimationIteration"),animationstart:pt("Animation","AnimationStart"),transitionrun:pt("Transition","TransitionRun"),transitionstart:pt("Transition","TransitionStart"),transitioncancel:pt("Transition","TransitionCancel"),transitionend:pt("Transition","TransitionEnd")},un={},cr={};Di&&(cr=document.createElement("div").style,"AnimationEvent"in window||(delete Dt.animationend.animation,delete Dt.animationiteration.animation,delete Dt.animationstart.animation),"TransitionEvent"in window||delete Dt.transitionend.transition);function dn(s){if(un[s])return un[s];if(!Dt[s])return s;var c=Dt[s],h;for(h in c)if(c.hasOwnProperty(h)&&h in cr)return un[s]=c[h];return s}var Cc=dn("animationend"),af=dn("animationiteration"),ri=dn("animationstart"),_c=dn("transitionrun"),rp=dn("transitionstart"),_s=dn("transitioncancel"),bo=dn("transitionend"),vo=new Map,ne="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ne.push("scrollEnd");function me(s,c){vo.set(s,c),gs(c,[s])}var he=new WeakMap;function Ce(s,c){if(typeof s=="object"&&s!==null){var h=he.get(s);return h!==void 0?h:(c={value:s,source:c,stack:wu(c)},he.set(s,c),c)}return{value:s,source:c,stack:wu(c)}}var Je=[],ht=0,jt=0;function Ct(){for(var s=ht,c=jt=ht=0;c<s;){var h=Je[c];Je[c++]=null;var x=Je[c];Je[c++]=null;var N=Je[c];Je[c++]=null;var P=Je[c];if(Je[c++]=null,x!==null&&N!==null){var q=x.pending;q===null?N.next=N:(N.next=q.next,q.next=N),x.pending=N}P!==0&&ku(h,N,P)}}function Yn(s,c,h,x){Je[ht++]=s,Je[ht++]=c,Je[ht++]=h,Je[ht++]=x,jt|=x,s.lanes|=x,s=s.alternate,s!==null&&(s.lanes|=x)}function Hr(s,c,h,x){return Yn(s,c,h,x),Tu(s)}function js(s,c){return Yn(s,null,null,c),Tu(s)}function ku(s,c,h){s.lanes|=h;var x=s.alternate;x!==null&&(x.lanes|=h);for(var N=!1,P=s.return;P!==null;)P.childLanes|=h,x=P.alternate,x!==null&&(x.childLanes|=h),P.tag===22&&(s=P.stateNode,s===null||s._visibility&1||(N=!0)),s=P,P=P.return;return s.tag===3?(P=s.stateNode,N&&c!==null&&(N=31-Qe(h),s=P.hiddenUpdates,x=s[N],x===null?s[N]=[c]:x.push(c),c.lane=h|536870912),P):null}function Tu(s){if(50<Yc)throw Yc=0,Kp=null,Error(r(185));for(var c=s.return;c!==null;)s=c,c=s.return;return s.tag===3?s.stateNode:null}var Cl={};function sf(s,c,h,x){this.tag=s,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function di(s,c,h,x){return new sf(s,c,h,x)}function _l(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ii(s,c){var h=s.alternate;return h===null?(h=di(s.tag,c,s.key,s.mode),h.elementType=s.elementType,h.type=s.type,h.stateNode=s.stateNode,h.alternate=s,s.alternate=h):(h.pendingProps=c,h.type=s.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=s.flags&65011712,h.childLanes=s.childLanes,h.lanes=s.lanes,h.child=s.child,h.memoizedProps=s.memoizedProps,h.memoizedState=s.memoizedState,h.updateQueue=s.updateQueue,c=s.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=s.sibling,h.index=s.index,h.ref=s.ref,h.refCleanup=s.refCleanup,h}function Eu(s,c){s.flags&=65011714;var h=s.alternate;return h===null?(s.childLanes=0,s.lanes=c,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=h.childLanes,s.lanes=h.lanes,s.child=h.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=h.memoizedProps,s.memoizedState=h.memoizedState,s.updateQueue=h.updateQueue,s.type=h.type,c=h.dependencies,s.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),s}function of(s,c,h,x,N,P){var q=0;if(x=s,typeof s=="function")_l(s)&&(q=1);else if(typeof s=="string")q=Cv(s,h,de.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case J:return s=di(31,h,c,N),s.elementType=J,s.lanes=P,s;case S:return jl(h.children,N,P,c);case k:q=8,N|=24;break;case T:return s=di(12,h,c,N|2),s.elementType=T,s.lanes=P,s;case F:return s=di(13,h,c,N),s.elementType=F,s.lanes=P,s;case L:return s=di(19,h,c,N),s.elementType=L,s.lanes=P,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case A:case R:q=10;break e;case M:q=9;break e;case z:q=11;break e;case U:q=14;break e;case B:q=16,x=null;break e}q=29,h=Error(r(130,s===null?"null":typeof s,"")),x=null}return c=di(q,h,c,N),c.elementType=s,c.type=x,c.lanes=P,c}function jl(s,c,h,x){return s=di(7,s,x,c),s.lanes=h,s}function ip(s,c,h){return s=di(6,s,null,c),s.lanes=h,s}function jc(s,c,h){return c=di(4,s.children!==null?s.children:[],s.key,c),c.lanes=h,c.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},c}var ks=[],wo=0,lf=null,Au=0,Zi=[],ea=0,Kn=null,tr=1,Ts="";function kl(s,c){ks[wo++]=Au,ks[wo++]=lf,lf=s,Au=c}function ap(s,c,h){Zi[ea++]=tr,Zi[ea++]=Ts,Zi[ea++]=Kn,Kn=s;var x=tr;s=Ts;var N=32-Qe(x)-1;x&=~(1<<N),h+=1;var P=32-Qe(c)+N;if(30<P){var q=N-N%5;P=(x&(1<<q)-1).toString(32),x>>=q,N-=q,tr=1<<32-Qe(c)+N|h<<N|x,Ts=P+s}else tr=1<<P|h<<N|x,Ts=s}function sp(s){s.return!==null&&(kl(s,1),ap(s,1,0))}function Pu(s){for(;s===lf;)lf=ks[--wo],ks[wo]=null,Au=ks[--wo],ks[wo]=null;for(;s===Kn;)Kn=Zi[--ea],Zi[ea]=null,Ts=Zi[--ea],Zi[ea]=null,tr=Zi[--ea],Zi[ea]=null}var Nr=null,nr=null,on=!1,Na=null,fi=!1,kc=Error(r(519));function ta(s){var c=Error(r(418,""));throw So(Ce(c,s)),kc}function yg(s){var c=s.stateNode,h=s.type,x=s.memoizedProps;switch(c[yn]=s,c[wr]=x,h){case"dialog":sn("cancel",c),sn("close",c);break;case"iframe":case"object":case"embed":sn("load",c);break;case"video":case"audio":for(h=0;h<bd.length;h++)sn(bd[h],c);break;case"source":sn("error",c);break;case"img":case"image":case"link":sn("error",c),sn("load",c);break;case"details":sn("toggle",c);break;case"input":sn("invalid",c),cc(c,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),sl(c);break;case"select":sn("invalid",c);break;case"textarea":sn("invalid",c),ll(c,x.value,x.defaultValue,x.children),sl(c)}h=x.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||c.textContent===""+h||x.suppressHydrationWarning===!0||zy(c.textContent,h)?(x.popover!=null&&(sn("beforetoggle",c),sn("toggle",c)),x.onScroll!=null&&sn("scroll",c),x.onScrollEnd!=null&&sn("scrollend",c),x.onClick!=null&&(c.onclick=Xf),c=!0):c=!1,c||ta(s)}function xg(s){for(Nr=s.return;Nr;)switch(Nr.tag){case 5:case 13:fi=!1;return;case 27:case 3:fi=!0;return;default:Nr=Nr.return}}function Du(s){if(s!==Nr)return!1;if(!on)return xg(s),on=!0,!1;var c=s.tag,h;if((h=c!==3&&c!==27)&&((h=c===5)&&(h=s.type,h=!(h!=="form"&&h!=="button")||eh(s.type,s.memoizedProps)),h=!h),h&&nr&&ta(s),xg(s),c===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,c=0;s;){if(s.nodeType===8)if(h=s.data,h==="/$"){if(c===0){nr=Ea(s.nextSibling);break e}c--}else h!=="$"&&h!=="$!"&&h!=="$?"||c++;s=s.nextSibling}nr=null}}else c===27?(c=nr,oa(s.type)?(s=dm,dm=null,nr=s):nr=c):nr=Nr?Ea(s.stateNode.nextSibling):null;return!0}function Iu(){nr=Nr=null,on=!1}function bg(){var s=Na;return s!==null&&(vi===null?vi=s:vi.push.apply(vi,s),Na=null),s}function So(s){Na===null?Na=[s]:Na.push(s)}var Tl=ce(null),No=null,Z=null;function Mi(s,c,h){I(Tl,c._currentValue),c._currentValue=h}function na(s){s._currentValue=Tl.current,ue(Tl)}function hi(s,c,h){for(;s!==null;){var x=s.alternate;if((s.childLanes&c)!==c?(s.childLanes|=c,x!==null&&(x.childLanes|=c)):x!==null&&(x.childLanes&c)!==c&&(x.childLanes|=c),s===h)break;s=s.return}}function en(s,c,h,x){var N=s.child;for(N!==null&&(N.return=s);N!==null;){var P=N.dependencies;if(P!==null){var q=N.child;P=P.firstContext;e:for(;P!==null;){var ee=P;P=N;for(var ve=0;ve<c.length;ve++)if(ee.context===c[ve]){P.lanes|=h,ee=P.alternate,ee!==null&&(ee.lanes|=h),hi(P.return,h,s),x||(q=null);break e}P=ee.next}}else if(N.tag===18){if(q=N.return,q===null)throw Error(r(341));q.lanes|=h,P=q.alternate,P!==null&&(P.lanes|=h),hi(q,h,s),q=null}else q=N.child;if(q!==null)q.return=N;else for(q=N;q!==null;){if(q===s){q=null;break}if(N=q.sibling,N!==null){N.return=q.return,q=N;break}q=q.return}N=q}}function Ru(s,c,h,x){s=null;for(var N=c,P=!1;N!==null;){if(!P){if((N.flags&524288)!==0)P=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var q=N.alternate;if(q===null)throw Error(r(387));if(q=q.memoizedProps,q!==null){var ee=N.type;ni(N.pendingProps.value,q.value)||(s!==null?s.push(ee):s=[ee])}}else if(N===oe.current){if(q=N.alternate,q===null)throw Error(r(387));q.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(s!==null?s.push(tu):s=[tu])}N=N.return}s!==null&&en(c,s,h,x),c.flags|=262144}function cf(s){for(s=s.firstContext;s!==null;){if(!ni(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function El(s){No=s,Z=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function ur(s){return vg(No,s)}function uf(s,c){return No===null&&El(s),vg(s,c)}function vg(s,c){var h=c._currentValue;if(c={context:c,memoizedValue:h,next:null},Z===null){if(s===null)throw Error(r(308));Z=c,s.dependencies={lanes:0,firstContext:c},s.flags|=524288}else Z=Z.next=c;return h}var Wb=typeof AbortController<"u"?AbortController:function(){var s=[],c=this.signal={aborted:!1,addEventListener:function(h,x){s.push(x)}};this.abort=function(){c.aborted=!0,s.forEach(function(h){return h()})}},Qb=e.unstable_scheduleCallback,Jb=e.unstable_NormalPriority,Un={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function op(){return{controller:new Wb,data:new Map,refCount:0}}function Mu(s){s.refCount--,s.refCount===0&&Qb(Jb,function(){s.controller.abort()})}var Ou=null,lp=0,Tc=0,pi=null;function Kb(s,c){if(Ou===null){var h=Ou=[];lp=0,Tc=Jf(),pi={status:"pending",value:void 0,then:function(x){h.push(x)}}}return lp++,c.then(wg,wg),c}function wg(){if(--lp===0&&Ou!==null){pi!==null&&(pi.status="fulfilled");var s=Ou;Ou=null,Tc=0,pi=null;for(var c=0;c<s.length;c++)(0,s[c])()}}function Xb(s,c){var h=[],x={status:"pending",value:null,reason:null,then:function(N){h.push(N)}};return s.then(function(){x.status="fulfilled",x.value=c;for(var N=0;N<h.length;N++)(0,h[N])(c)},function(N){for(x.status="rejected",x.reason=N,N=0;N<h.length;N++)(0,h[N])(void 0)}),x}var Sg=V.S;V.S=function(s,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&Kb(s,c),Sg!==null&&Sg(s,c)};var Al=ce(null);function Es(){var s=Al.current;return s!==null?s:Wn.pooledCache}function df(s,c){c===null?I(Al,Al.current):I(Al,c.pool)}function Ng(){var s=Es();return s===null?null:{parent:Un._currentValue,pool:s}}var ai=Error(r(460)),Cg=Error(r(474)),ff=Error(r(542)),cp={then:function(){}};function _g(s){return s=s.status,s==="fulfilled"||s==="rejected"}function hf(){}function up(s,c,h){switch(h=s[h],h===void 0?s.push(c):h!==c&&(c.then(hf,hf),c=h),c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,kg(s),s;default:if(typeof c.status=="string")c.then(hf,hf);else{if(s=Wn,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=c,s.status="pending",s.then(function(x){if(c.status==="pending"){var N=c;N.status="fulfilled",N.value=x}},function(x){if(c.status==="pending"){var N=c;N.status="rejected",N.reason=x}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,kg(s),s}throw Ec=c,ai}}var Ec=null;function jg(){if(Ec===null)throw Error(r(459));var s=Ec;return Ec=null,s}function kg(s){if(s===ai||s===ff)throw Error(r(483))}var es=!1;function Pl(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ac(s,c){s=s.updateQueue,c.updateQueue===s&&(c.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Co(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function As(s,c,h){var x=s.updateQueue;if(x===null)return null;if(x=x.shared,(Pn&2)!==0){var N=x.pending;return N===null?c.next=c:(c.next=N.next,N.next=c),x.pending=c,c=Tu(s),ku(s,null,h),c}return Yn(s,x,c,h),Tu(s)}function Lu(s,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194048)!==0)){var x=c.lanes;x&=s.pendingLanes,h|=x,c.lanes=h,bt(s,h)}}function Ca(s,c){var h=s.updateQueue,x=s.alternate;if(x!==null&&(x=x.updateQueue,h===x)){var N=null,P=null;if(h=h.firstBaseUpdate,h!==null){do{var q={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};P===null?N=P=q:P=P.next=q,h=h.next}while(h!==null);P===null?N=P=c:P=P.next=c}else N=P=c;h={baseState:x.baseState,firstBaseUpdate:N,lastBaseUpdate:P,shared:x.shared,callbacks:x.callbacks},s.updateQueue=h;return}s=h.lastBaseUpdate,s===null?h.firstBaseUpdate=c:s.next=c,h.lastBaseUpdate=c}var Fu=!1;function _a(){if(Fu){var s=pi;if(s!==null)throw s}}function Gr(s,c,h,x){Fu=!1;var N=s.updateQueue;es=!1;var P=N.firstBaseUpdate,q=N.lastBaseUpdate,ee=N.shared.pending;if(ee!==null){N.shared.pending=null;var ve=ee,Le=ve.next;ve.next=null,q===null?P=Le:q.next=Le,q=ve;var Ke=s.alternate;Ke!==null&&(Ke=Ke.updateQueue,ee=Ke.lastBaseUpdate,ee!==q&&(ee===null?Ke.firstBaseUpdate=Le:ee.next=Le,Ke.lastBaseUpdate=ve))}if(P!==null){var tt=N.baseState;q=0,Ke=Le=ve=null,ee=P;do{var Ue=ee.lane&-536870913,Fe=Ue!==ee.lane;if(Fe?(bn&Ue)===Ue:(x&Ue)===Ue){Ue!==0&&Ue===Tc&&(Fu=!0),Ke!==null&&(Ke=Ke.next={lane:0,tag:ee.tag,payload:ee.payload,callback:null,next:null});e:{var Rt=s,It=ee;Ue=c;var Ln=h;switch(It.tag){case 1:if(Rt=It.payload,typeof Rt=="function"){tt=Rt.call(Ln,tt,Ue);break e}tt=Rt;break e;case 3:Rt.flags=Rt.flags&-65537|128;case 0:if(Rt=It.payload,Ue=typeof Rt=="function"?Rt.call(Ln,tt,Ue):Rt,Ue==null)break e;tt=p({},tt,Ue);break e;case 2:es=!0}}Ue=ee.callback,Ue!==null&&(s.flags|=64,Fe&&(s.flags|=8192),Fe=N.callbacks,Fe===null?N.callbacks=[Ue]:Fe.push(Ue))}else Fe={lane:Ue,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null},Ke===null?(Le=Ke=Fe,ve=tt):Ke=Ke.next=Fe,q|=Ue;if(ee=ee.next,ee===null){if(ee=N.shared.pending,ee===null)break;Fe=ee,ee=Fe.next,Fe.next=null,N.lastBaseUpdate=Fe,N.shared.pending=null}}while(!0);Ke===null&&(ve=tt),N.baseState=ve,N.firstBaseUpdate=Le,N.lastBaseUpdate=Ke,P===null&&(N.shared.lanes=0),Io|=q,s.lanes=q,s.memoizedState=tt}}function Tg(s,c){if(typeof s!="function")throw Error(r(191,s));s.call(c)}function dp(s,c){var h=s.callbacks;if(h!==null)for(s.callbacks=null,s=0;s<h.length;s++)Tg(h[s],c)}var Dl=ce(null),_o=ce(0);function Ps(s,c){s=zs,I(_o,s),I(Dl,c),zs=s|c.baseLanes}function pf(){I(_o,zs),I(Dl,Dl.current)}function fp(){zs=_o.current,ue(Dl),ue(_o)}var ja=0,Jt=null,An=null,ln=null,Pc=!1,Il=!1,Yr=!1,Dc=0,jo=0,ra=null,Eg=0;function fn(){throw Error(r(321))}function $u(s,c){if(c===null)return!1;for(var h=0;h<c.length&&h<s.length;h++)if(!ni(s[h],c[h]))return!1;return!0}function hp(s,c,h,x,N,P){return ja=P,Jt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,V.H=s===null||s.memoizedState===null?Bg:Pp,Yr=!1,P=h(x,N),Yr=!1,Il&&(P=Pg(c,h,x,N)),Ag(s),P}function Ag(s){V.H=Ju;var c=An!==null&&An.next!==null;if(ja=0,ln=An=Jt=null,Pc=!1,jo=0,ra=null,c)throw Error(r(300));s===null||Dr||(s=s.dependencies,s!==null&&cf(s)&&(Dr=!0))}function Pg(s,c,h,x){Jt=s;var N=0;do{if(Il&&(ra=null),jo=0,Il=!1,25<=N)throw Error(r(301));if(N+=1,ln=An=null,s.updateQueue!=null){var P=s.updateQueue;P.lastEffect=null,P.events=null,P.stores=null,P.memoCache!=null&&(P.memoCache.index=0)}V.H=qg,P=c(h,x)}while(Il);return P}function pp(){var s=V.H,c=s.useState()[0];return c=typeof c.then=="function"?zu(c):c,s=s.useState()[0],(An!==null?An.memoizedState:null)!==s&&(Jt.flags|=1024),c}function mp(){var s=Dc!==0;return Dc=0,s}function Rl(s,c,h){c.updateQueue=s.updateQueue,c.flags&=-2053,s.lanes&=~h}function mf(s){if(Pc){for(s=s.memoizedState;s!==null;){var c=s.queue;c!==null&&(c.pending=null),s=s.next}Pc=!1}ja=0,ln=An=Jt=null,Il=!1,jo=Dc=0,ra=null}function mi(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ln===null?Jt.memoizedState=ln=s:ln=ln.next=s,ln}function yr(){if(An===null){var s=Jt.alternate;s=s!==null?s.memoizedState:null}else s=An.next;var c=ln===null?Jt.memoizedState:ln.next;if(c!==null)ln=c,An=s;else{if(s===null)throw Jt.alternate===null?Error(r(467)):Error(r(310));An=s,s={memoizedState:An.memoizedState,baseState:An.baseState,baseQueue:An.baseQueue,queue:An.queue,next:null},ln===null?Jt.memoizedState=ln=s:ln=ln.next=s}return ln}function Ml(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function zu(s){var c=jo;return jo+=1,ra===null&&(ra=[]),s=up(ra,s,c),c=Jt,(ln===null?c.memoizedState:ln.next)===null&&(c=c.alternate,V.H=c===null||c.memoizedState===null?Bg:Pp),s}function gf(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return zu(s);if(s.$$typeof===R)return ur(s)}throw Error(r(438,String(s)))}function Uu(s){var c=null,h=Jt.updateQueue;if(h!==null&&(c=h.memoCache),c==null){var x=Jt.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(c={data:x.data.map(function(N){return N.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),h===null&&(h=Ml(),Jt.updateQueue=h),h.memoCache=c,h=c.data[c.index],h===void 0)for(h=c.data[c.index]=Array(s),x=0;x<s;x++)h[x]=D;return c.index++,h}function ts(s,c){return typeof c=="function"?c(s):c}function yf(s){var c=yr();return gp(c,An,s)}function gp(s,c,h){var x=s.queue;if(x===null)throw Error(r(311));x.lastRenderedReducer=h;var N=s.baseQueue,P=x.pending;if(P!==null){if(N!==null){var q=N.next;N.next=P.next,P.next=q}c.baseQueue=N=P,x.pending=null}if(P=s.baseState,N===null)s.memoizedState=P;else{c=N.next;var ee=q=null,ve=null,Le=c,Ke=!1;do{var tt=Le.lane&-536870913;if(tt!==Le.lane?(bn&tt)===tt:(ja&tt)===tt){var Ue=Le.revertLane;if(Ue===0)ve!==null&&(ve=ve.next={lane:0,revertLane:0,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null}),tt===Tc&&(Ke=!0);else if((ja&Ue)===Ue){Le=Le.next,Ue===Tc&&(Ke=!0);continue}else tt={lane:0,revertLane:Le.revertLane,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null},ve===null?(ee=ve=tt,q=P):ve=ve.next=tt,Jt.lanes|=Ue,Io|=Ue;tt=Le.action,Yr&&h(P,tt),P=Le.hasEagerState?Le.eagerState:h(P,tt)}else Ue={lane:tt,revertLane:Le.revertLane,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null},ve===null?(ee=ve=Ue,q=P):ve=ve.next=Ue,Jt.lanes|=tt,Io|=tt;Le=Le.next}while(Le!==null&&Le!==c);if(ve===null?q=P:ve.next=ee,!ni(P,s.memoizedState)&&(Dr=!0,Ke&&(h=pi,h!==null)))throw h;s.memoizedState=P,s.baseState=q,s.baseQueue=ve,x.lastRenderedState=P}return N===null&&(x.lanes=0),[s.memoizedState,x.dispatch]}function yp(s){var c=yr(),h=c.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=s;var x=h.dispatch,N=h.pending,P=c.memoizedState;if(N!==null){h.pending=null;var q=N=N.next;do P=s(P,q.action),q=q.next;while(q!==N);ni(P,c.memoizedState)||(Dr=!0),c.memoizedState=P,c.baseQueue===null&&(c.baseState=P),h.lastRenderedState=P}return[P,x]}function xp(s,c,h){var x=Jt,N=yr(),P=on;if(P){if(h===void 0)throw Error(r(407));h=h()}else h=c();var q=!ni((An||N).memoizedState,h);q&&(N.memoizedState=h,Dr=!0),N=N.queue;var ee=bf.bind(null,x,N,s);if(Vu(2048,8,ee,[s]),N.getSnapshot!==c||q||ln!==null&&ln.memoizedState.tag&1){if(x.flags|=2048,Ic(9,Cf(),Dg.bind(null,x,N,h,c),null),Wn===null)throw Error(r(349));P||(ja&124)!==0||xf(x,c,h)}return h}function xf(s,c,h){s.flags|=16384,s={getSnapshot:c,value:h},c=Jt.updateQueue,c===null?(c=Ml(),Jt.updateQueue=c,c.stores=[s]):(h=c.stores,h===null?c.stores=[s]:h.push(s))}function Dg(s,c,h,x){c.value=h,c.getSnapshot=x,bp(c)&&vp(s)}function bf(s,c,h){return h(function(){bp(c)&&vp(s)})}function bp(s){var c=s.getSnapshot;s=s.value;try{var h=c();return!ni(s,h)}catch{return!0}}function vp(s){var c=js(s,2);c!==null&&zi(c,s,2)}function vf(s){var c=mi();if(typeof s=="function"){var h=s;if(s=h(),Yr){He(!0);try{h()}finally{He(!1)}}}return c.memoizedState=c.baseState=s,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ts,lastRenderedState:s},c}function Bu(s,c,h,x){return s.baseState=h,gp(s,An,typeof x=="function"?x:ts)}function Zb(s,c,h,x,N){if(Tf(s))throw Error(r(485));if(s=c.action,s!==null){var P={payload:N,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){P.listeners.push(q)}};V.T!==null?h(!0):P.isTransition=!1,x(P),h=c.pending,h===null?(P.next=c.pending=P,wp(c,P)):(P.next=h.next,c.pending=h.next=P)}}function wp(s,c){var h=c.action,x=c.payload,N=s.state;if(c.isTransition){var P=V.T,q={};V.T=q;try{var ee=h(N,x),ve=V.S;ve!==null&&ve(q,ee),Sp(s,c,ee)}catch(Le){wf(s,c,Le)}finally{V.T=P}}else try{P=h(N,x),Sp(s,c,P)}catch(Le){wf(s,c,Le)}}function Sp(s,c,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(x){Ig(s,c,x)},function(x){return wf(s,c,x)}):Ig(s,c,h)}function Ig(s,c,h){c.status="fulfilled",c.value=h,Rg(c),s.state=h,c=s.pending,c!==null&&(h=c.next,h===c?s.pending=null:(h=h.next,c.next=h,wp(s,h)))}function wf(s,c,h){var x=s.pending;if(s.pending=null,x!==null){x=x.next;do c.status="rejected",c.reason=h,Rg(c),c=c.next;while(c!==x)}s.action=null}function Rg(s){s=s.listeners;for(var c=0;c<s.length;c++)(0,s[c])()}function Sf(s,c){return c}function Np(s,c){if(on){var h=Wn.formState;if(h!==null){e:{var x=Jt;if(on){if(nr){t:{for(var N=nr,P=fi;N.nodeType!==8;){if(!P){N=null;break t}if(N=Ea(N.nextSibling),N===null){N=null;break t}}P=N.data,N=P==="F!"||P==="F"?N:null}if(N){nr=Ea(N.nextSibling),x=N.data==="F!";break e}}ta(x)}x=!1}x&&(c=h[0])}}return h=mi(),h.memoizedState=h.baseState=c,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Sf,lastRenderedState:c},h.queue=x,h=Tp.bind(null,Jt,x),x.dispatch=h,x=vf(!1),P=Ep.bind(null,Jt,!1,x.queue),x=mi(),N={state:c,dispatch:null,action:s,pending:null},x.queue=N,h=Zb.bind(null,Jt,N,P,h),N.dispatch=h,x.memoizedState=s,[c,h,!1]}function Nf(s){var c=yr();return Mg(c,An,s)}function Mg(s,c,h){if(c=gp(s,c,Sf)[0],s=yf(ts)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var x=zu(c)}catch(q){throw q===ai?ff:q}else x=c;c=yr();var N=c.queue,P=N.dispatch;return h!==c.memoizedState&&(Jt.flags|=2048,Ic(9,Cf(),Cp.bind(null,N,h),null)),[x,P,s]}function Cp(s,c){s.action=c}function Yt(s){var c=yr(),h=An;if(h!==null)return Mg(c,h,s);yr(),c=c.memoizedState,h=yr();var x=h.queue.dispatch;return h.memoizedState=s,[c,x,!1]}function Ic(s,c,h,x){return s={tag:s,create:h,deps:x,inst:c,next:null},c=Jt.updateQueue,c===null&&(c=Ml(),Jt.updateQueue=c),h=c.lastEffect,h===null?c.lastEffect=s.next=s:(x=h.next,h.next=s,s.next=x,c.lastEffect=s),s}function Cf(){return{destroy:void 0,resource:void 0}}function Rc(){return yr().memoizedState}function qu(s,c,h,x){var N=mi();x=x===void 0?null:x,Jt.flags|=s,N.memoizedState=Ic(1|c,Cf(),h,x)}function Vu(s,c,h,x){var N=yr();x=x===void 0?null:x;var P=N.memoizedState.inst;An!==null&&x!==null&&$u(x,An.memoizedState.deps)?N.memoizedState=Ic(c,P,h,x):(Jt.flags|=s,N.memoizedState=Ic(1|c,P,h,x))}function Og(s,c){qu(8390656,8,s,c)}function Oi(s,c){Vu(2048,8,s,c)}function Lg(s,c){return Vu(4,2,s,c)}function Hu(s,c){return Vu(4,4,s,c)}function _f(s,c){if(typeof c=="function"){s=s();var h=c(s);return function(){typeof h=="function"?h():c(null)}}if(c!=null)return s=s(),c.current=s,function(){c.current=null}}function _p(s,c,h){h=h!=null?h.concat([s]):null,Vu(4,4,_f.bind(null,c,s),h)}function jf(){}function gi(s,c){var h=yr();c=c===void 0?null:c;var x=h.memoizedState;return c!==null&&$u(c,x[1])?x[0]:(h.memoizedState=[s,c],s)}function Ds(s,c){var h=yr();c=c===void 0?null:c;var x=h.memoizedState;if(c!==null&&$u(c,x[1]))return x[0];if(x=s(),Yr){He(!0);try{s()}finally{He(!1)}}return h.memoizedState=[x,c],x}function Gu(s,c,h){return h===void 0||(ja&1073741824)!==0?s.memoizedState=c:(s.memoizedState=h,s=gy(),Jt.lanes|=s,Io|=s,h)}function jp(s,c,h,x){return ni(h,c)?h:Dl.current!==null?(s=Gu(s,h,x),ni(s,c)||(Dr=!0),s):(ja&42)===0?(Dr=!0,s.memoizedState=h):(s=gy(),Jt.lanes|=s,Io|=s,c)}function Yu(s,c,h,x,N){var P=ae.p;ae.p=P!==0&&8>P?P:8;var q=V.T,ee={};V.T=ee,Ep(s,!1,c,h);try{var ve=N(),Le=V.S;if(Le!==null&&Le(ee,ve),ve!==null&&typeof ve=="object"&&typeof ve.then=="function"){var Ke=Xb(ve,x);Ol(s,c,Ke,Qr(s))}else Ol(s,c,x,Qr(s))}catch(tt){Ol(s,c,{then:function(){},status:"rejected",reason:tt},Qr())}finally{ae.p=P,V.T=q}}function Fg(){}function Wu(s,c,h,x){if(s.tag!==5)throw Error(r(476));var N=kp(s).queue;Yu(s,N,c,re,h===null?Fg:function(){return kf(s),h(x)})}function kp(s){var c=s.memoizedState;if(c!==null)return c;c={memoizedState:re,baseState:re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ts,lastRenderedState:re},next:null};var h={};return c.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ts,lastRenderedState:h},next:null},s.memoizedState=c,s=s.alternate,s!==null&&(s.memoizedState=c),c}function kf(s){var c=kp(s).next.queue;Ol(s,c,{},Qr())}function Qu(){return ur(tu)}function Is(){return yr().memoizedState}function $g(){return yr().memoizedState}function ko(s){for(var c=s.return;c!==null;){switch(c.tag){case 24:case 3:var h=Qr();s=Co(h);var x=As(c,s,h);x!==null&&(zi(x,c,h),Lu(x,c,h)),c={cache:op()},s.payload=c;return}c=c.return}}function zg(s,c,h){var x=Qr();h={lane:x,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null},Tf(s)?Ug(c,h):(h=Hr(s,c,h,x),h!==null&&(zi(h,s,x),Ap(h,c,x)))}function Tp(s,c,h){var x=Qr();Ol(s,c,h,x)}function Ol(s,c,h,x){var N={lane:x,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null};if(Tf(s))Ug(c,N);else{var P=s.alternate;if(s.lanes===0&&(P===null||P.lanes===0)&&(P=c.lastRenderedReducer,P!==null))try{var q=c.lastRenderedState,ee=P(q,h);if(N.hasEagerState=!0,N.eagerState=ee,ni(ee,q))return Yn(s,c,N,0),Wn===null&&Ct(),!1}catch{}finally{}if(h=Hr(s,c,N,x),h!==null)return zi(h,s,x),Ap(h,c,x),!0}return!1}function Ep(s,c,h,x){if(x={lane:2,revertLane:Jf(),action:x,hasEagerState:!1,eagerState:null,next:null},Tf(s)){if(c)throw Error(r(479))}else c=Hr(s,h,x,2),c!==null&&zi(c,s,2)}function Tf(s){var c=s.alternate;return s===Jt||c!==null&&c===Jt}function Ug(s,c){Il=Pc=!0;var h=s.pending;h===null?c.next=c:(c.next=h.next,h.next=c),s.pending=c}function Ap(s,c,h){if((h&4194048)!==0){var x=c.lanes;x&=s.pendingLanes,h|=x,c.lanes=h,bt(s,h)}}var Ju={readContext:ur,use:gf,useCallback:fn,useContext:fn,useEffect:fn,useImperativeHandle:fn,useLayoutEffect:fn,useInsertionEffect:fn,useMemo:fn,useReducer:fn,useRef:fn,useState:fn,useDebugValue:fn,useDeferredValue:fn,useTransition:fn,useSyncExternalStore:fn,useId:fn,useHostTransitionStatus:fn,useFormState:fn,useActionState:fn,useOptimistic:fn,useMemoCache:fn,useCacheRefresh:fn},Bg={readContext:ur,use:gf,useCallback:function(s,c){return mi().memoizedState=[s,c===void 0?null:c],s},useContext:ur,useEffect:Og,useImperativeHandle:function(s,c,h){h=h!=null?h.concat([s]):null,qu(4194308,4,_f.bind(null,c,s),h)},useLayoutEffect:function(s,c){return qu(4194308,4,s,c)},useInsertionEffect:function(s,c){qu(4,2,s,c)},useMemo:function(s,c){var h=mi();c=c===void 0?null:c;var x=s();if(Yr){He(!0);try{s()}finally{He(!1)}}return h.memoizedState=[x,c],x},useReducer:function(s,c,h){var x=mi();if(h!==void 0){var N=h(c);if(Yr){He(!0);try{h(c)}finally{He(!1)}}}else N=c;return x.memoizedState=x.baseState=N,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:N},x.queue=s,s=s.dispatch=zg.bind(null,Jt,s),[x.memoizedState,s]},useRef:function(s){var c=mi();return s={current:s},c.memoizedState=s},useState:function(s){s=vf(s);var c=s.queue,h=Tp.bind(null,Jt,c);return c.dispatch=h,[s.memoizedState,h]},useDebugValue:jf,useDeferredValue:function(s,c){var h=mi();return Gu(h,s,c)},useTransition:function(){var s=vf(!1);return s=Yu.bind(null,Jt,s.queue,!0,!1),mi().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,c,h){var x=Jt,N=mi();if(on){if(h===void 0)throw Error(r(407));h=h()}else{if(h=c(),Wn===null)throw Error(r(349));(bn&124)!==0||xf(x,c,h)}N.memoizedState=h;var P={value:h,getSnapshot:c};return N.queue=P,Og(bf.bind(null,x,P,s),[s]),x.flags|=2048,Ic(9,Cf(),Dg.bind(null,x,P,h,c),null),h},useId:function(){var s=mi(),c=Wn.identifierPrefix;if(on){var h=Ts,x=tr;h=(x&~(1<<32-Qe(x)-1)).toString(32)+h,c=""+c+"R"+h,h=Dc++,0<h&&(c+="H"+h.toString(32)),c+=""}else h=Eg++,c=""+c+"r"+h.toString(32)+"";return s.memoizedState=c},useHostTransitionStatus:Qu,useFormState:Np,useActionState:Np,useOptimistic:function(s){var c=mi();c.memoizedState=c.baseState=s;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=h,c=Ep.bind(null,Jt,!0,h),h.dispatch=c,[s,c]},useMemoCache:Uu,useCacheRefresh:function(){return mi().memoizedState=ko.bind(null,Jt)}},Pp={readContext:ur,use:gf,useCallback:gi,useContext:ur,useEffect:Oi,useImperativeHandle:_p,useInsertionEffect:Lg,useLayoutEffect:Hu,useMemo:Ds,useReducer:yf,useRef:Rc,useState:function(){return yf(ts)},useDebugValue:jf,useDeferredValue:function(s,c){var h=yr();return jp(h,An.memoizedState,s,c)},useTransition:function(){var s=yf(ts)[0],c=yr().memoizedState;return[typeof s=="boolean"?s:zu(s),c]},useSyncExternalStore:xp,useId:Is,useHostTransitionStatus:Qu,useFormState:Nf,useActionState:Nf,useOptimistic:function(s,c){var h=yr();return Bu(h,An,s,c)},useMemoCache:Uu,useCacheRefresh:$g},qg={readContext:ur,use:gf,useCallback:gi,useContext:ur,useEffect:Oi,useImperativeHandle:_p,useInsertionEffect:Lg,useLayoutEffect:Hu,useMemo:Ds,useReducer:yp,useRef:Rc,useState:function(){return yp(ts)},useDebugValue:jf,useDeferredValue:function(s,c){var h=yr();return An===null?Gu(h,s,c):jp(h,An.memoizedState,s,c)},useTransition:function(){var s=yp(ts)[0],c=yr().memoizedState;return[typeof s=="boolean"?s:zu(s),c]},useSyncExternalStore:xp,useId:Is,useHostTransitionStatus:Qu,useFormState:Yt,useActionState:Yt,useOptimistic:function(s,c){var h=yr();return An!==null?Bu(h,An,s,c):(h.baseState=s,[s,h.queue.dispatch])},useMemoCache:Uu,useCacheRefresh:$g},Cr=null,yi=0;function Ef(s){var c=yi;return yi+=1,Cr===null&&(Cr=[]),up(Cr,s,c)}function Ku(s,c){c=c.props.ref,s.ref=c!==void 0?c:null}function Ll(s,c){throw c.$$typeof===g?Error(r(525)):(s=Object.prototype.toString.call(c),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":s)))}function Fl(s){var c=s._init;return c(s._payload)}function Dp(s){function c(Ie,Te){if(s){var Oe=Ie.deletions;Oe===null?(Ie.deletions=[Te],Ie.flags|=16):Oe.push(Te)}}function h(Ie,Te){if(!s)return null;for(;Te!==null;)c(Ie,Te),Te=Te.sibling;return null}function x(Ie){for(var Te=new Map;Ie!==null;)Ie.key!==null?Te.set(Ie.key,Ie):Te.set(Ie.index,Ie),Ie=Ie.sibling;return Te}function N(Ie,Te){return Ie=ii(Ie,Te),Ie.index=0,Ie.sibling=null,Ie}function P(Ie,Te,Oe){return Ie.index=Oe,s?(Oe=Ie.alternate,Oe!==null?(Oe=Oe.index,Oe<Te?(Ie.flags|=67108866,Te):Oe):(Ie.flags|=67108866,Te)):(Ie.flags|=1048576,Te)}function q(Ie){return s&&Ie.alternate===null&&(Ie.flags|=67108866),Ie}function ee(Ie,Te,Oe,Xe){return Te===null||Te.tag!==6?(Te=ip(Oe,Ie.mode,Xe),Te.return=Ie,Te):(Te=N(Te,Oe),Te.return=Ie,Te)}function ve(Ie,Te,Oe,Xe){var xt=Oe.type;return xt===S?Ke(Ie,Te,Oe.props.children,Xe,Oe.key):Te!==null&&(Te.elementType===xt||typeof xt=="object"&&xt!==null&&xt.$$typeof===B&&Fl(xt)===Te.type)?(Te=N(Te,Oe.props),Ku(Te,Oe),Te.return=Ie,Te):(Te=of(Oe.type,Oe.key,Oe.props,null,Ie.mode,Xe),Ku(Te,Oe),Te.return=Ie,Te)}function Le(Ie,Te,Oe,Xe){return Te===null||Te.tag!==4||Te.stateNode.containerInfo!==Oe.containerInfo||Te.stateNode.implementation!==Oe.implementation?(Te=jc(Oe,Ie.mode,Xe),Te.return=Ie,Te):(Te=N(Te,Oe.children||[]),Te.return=Ie,Te)}function Ke(Ie,Te,Oe,Xe,xt){return Te===null||Te.tag!==7?(Te=jl(Oe,Ie.mode,Xe,xt),Te.return=Ie,Te):(Te=N(Te,Oe),Te.return=Ie,Te)}function tt(Ie,Te,Oe){if(typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint")return Te=ip(""+Te,Ie.mode,Oe),Te.return=Ie,Te;if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case b:return Oe=of(Te.type,Te.key,Te.props,null,Ie.mode,Oe),Ku(Oe,Te),Oe.return=Ie,Oe;case v:return Te=jc(Te,Ie.mode,Oe),Te.return=Ie,Te;case B:var Xe=Te._init;return Te=Xe(Te._payload),tt(Ie,Te,Oe)}if(Y(Te)||H(Te))return Te=jl(Te,Ie.mode,Oe,null),Te.return=Ie,Te;if(typeof Te.then=="function")return tt(Ie,Ef(Te),Oe);if(Te.$$typeof===R)return tt(Ie,uf(Ie,Te),Oe);Ll(Ie,Te)}return null}function Ue(Ie,Te,Oe,Xe){var xt=Te!==null?Te.key:null;if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint")return xt!==null?null:ee(Ie,Te,""+Oe,Xe);if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case b:return Oe.key===xt?ve(Ie,Te,Oe,Xe):null;case v:return Oe.key===xt?Le(Ie,Te,Oe,Xe):null;case B:return xt=Oe._init,Oe=xt(Oe._payload),Ue(Ie,Te,Oe,Xe)}if(Y(Oe)||H(Oe))return xt!==null?null:Ke(Ie,Te,Oe,Xe,null);if(typeof Oe.then=="function")return Ue(Ie,Te,Ef(Oe),Xe);if(Oe.$$typeof===R)return Ue(Ie,Te,uf(Ie,Oe),Xe);Ll(Ie,Oe)}return null}function Fe(Ie,Te,Oe,Xe,xt){if(typeof Xe=="string"&&Xe!==""||typeof Xe=="number"||typeof Xe=="bigint")return Ie=Ie.get(Oe)||null,ee(Te,Ie,""+Xe,xt);if(typeof Xe=="object"&&Xe!==null){switch(Xe.$$typeof){case b:return Ie=Ie.get(Xe.key===null?Oe:Xe.key)||null,ve(Te,Ie,Xe,xt);case v:return Ie=Ie.get(Xe.key===null?Oe:Xe.key)||null,Le(Te,Ie,Xe,xt);case B:var tn=Xe._init;return Xe=tn(Xe._payload),Fe(Ie,Te,Oe,Xe,xt)}if(Y(Xe)||H(Xe))return Ie=Ie.get(Oe)||null,Ke(Te,Ie,Xe,xt,null);if(typeof Xe.then=="function")return Fe(Ie,Te,Oe,Ef(Xe),xt);if(Xe.$$typeof===R)return Fe(Ie,Te,Oe,uf(Te,Xe),xt);Ll(Te,Xe)}return null}function Rt(Ie,Te,Oe,Xe){for(var xt=null,tn=null,Nt=Te,Mt=Te=0,Mr=null;Nt!==null&&Mt<Oe.length;Mt++){Nt.index>Mt?(Mr=Nt,Nt=null):Mr=Nt.sibling;var Sn=Ue(Ie,Nt,Oe[Mt],Xe);if(Sn===null){Nt===null&&(Nt=Mr);break}s&&Nt&&Sn.alternate===null&&c(Ie,Nt),Te=P(Sn,Te,Mt),tn===null?xt=Sn:tn.sibling=Sn,tn=Sn,Nt=Mr}if(Mt===Oe.length)return h(Ie,Nt),on&&kl(Ie,Mt),xt;if(Nt===null){for(;Mt<Oe.length;Mt++)Nt=tt(Ie,Oe[Mt],Xe),Nt!==null&&(Te=P(Nt,Te,Mt),tn===null?xt=Nt:tn.sibling=Nt,tn=Nt);return on&&kl(Ie,Mt),xt}for(Nt=x(Nt);Mt<Oe.length;Mt++)Mr=Fe(Nt,Ie,Mt,Oe[Mt],Xe),Mr!==null&&(s&&Mr.alternate!==null&&Nt.delete(Mr.key===null?Mt:Mr.key),Te=P(Mr,Te,Mt),tn===null?xt=Mr:tn.sibling=Mr,tn=Mr);return s&&Nt.forEach(function(qo){return c(Ie,qo)}),on&&kl(Ie,Mt),xt}function It(Ie,Te,Oe,Xe){if(Oe==null)throw Error(r(151));for(var xt=null,tn=null,Nt=Te,Mt=Te=0,Mr=null,Sn=Oe.next();Nt!==null&&!Sn.done;Mt++,Sn=Oe.next()){Nt.index>Mt?(Mr=Nt,Nt=null):Mr=Nt.sibling;var qo=Ue(Ie,Nt,Sn.value,Xe);if(qo===null){Nt===null&&(Nt=Mr);break}s&&Nt&&qo.alternate===null&&c(Ie,Nt),Te=P(qo,Te,Mt),tn===null?xt=qo:tn.sibling=qo,tn=qo,Nt=Mr}if(Sn.done)return h(Ie,Nt),on&&kl(Ie,Mt),xt;if(Nt===null){for(;!Sn.done;Mt++,Sn=Oe.next())Sn=tt(Ie,Sn.value,Xe),Sn!==null&&(Te=P(Sn,Te,Mt),tn===null?xt=Sn:tn.sibling=Sn,tn=Sn);return on&&kl(Ie,Mt),xt}for(Nt=x(Nt);!Sn.done;Mt++,Sn=Oe.next())Sn=Fe(Nt,Ie,Mt,Sn.value,Xe),Sn!==null&&(s&&Sn.alternate!==null&&Nt.delete(Sn.key===null?Mt:Sn.key),Te=P(Sn,Te,Mt),tn===null?xt=Sn:tn.sibling=Sn,tn=Sn);return s&&Nt.forEach(function(Mv){return c(Ie,Mv)}),on&&kl(Ie,Mt),xt}function Ln(Ie,Te,Oe,Xe){if(typeof Oe=="object"&&Oe!==null&&Oe.type===S&&Oe.key===null&&(Oe=Oe.props.children),typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case b:e:{for(var xt=Oe.key;Te!==null;){if(Te.key===xt){if(xt=Oe.type,xt===S){if(Te.tag===7){h(Ie,Te.sibling),Xe=N(Te,Oe.props.children),Xe.return=Ie,Ie=Xe;break e}}else if(Te.elementType===xt||typeof xt=="object"&&xt!==null&&xt.$$typeof===B&&Fl(xt)===Te.type){h(Ie,Te.sibling),Xe=N(Te,Oe.props),Ku(Xe,Oe),Xe.return=Ie,Ie=Xe;break e}h(Ie,Te);break}else c(Ie,Te);Te=Te.sibling}Oe.type===S?(Xe=jl(Oe.props.children,Ie.mode,Xe,Oe.key),Xe.return=Ie,Ie=Xe):(Xe=of(Oe.type,Oe.key,Oe.props,null,Ie.mode,Xe),Ku(Xe,Oe),Xe.return=Ie,Ie=Xe)}return q(Ie);case v:e:{for(xt=Oe.key;Te!==null;){if(Te.key===xt)if(Te.tag===4&&Te.stateNode.containerInfo===Oe.containerInfo&&Te.stateNode.implementation===Oe.implementation){h(Ie,Te.sibling),Xe=N(Te,Oe.children||[]),Xe.return=Ie,Ie=Xe;break e}else{h(Ie,Te);break}else c(Ie,Te);Te=Te.sibling}Xe=jc(Oe,Ie.mode,Xe),Xe.return=Ie,Ie=Xe}return q(Ie);case B:return xt=Oe._init,Oe=xt(Oe._payload),Ln(Ie,Te,Oe,Xe)}if(Y(Oe))return Rt(Ie,Te,Oe,Xe);if(H(Oe)){if(xt=H(Oe),typeof xt!="function")throw Error(r(150));return Oe=xt.call(Oe),It(Ie,Te,Oe,Xe)}if(typeof Oe.then=="function")return Ln(Ie,Te,Ef(Oe),Xe);if(Oe.$$typeof===R)return Ln(Ie,Te,uf(Ie,Oe),Xe);Ll(Ie,Oe)}return typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint"?(Oe=""+Oe,Te!==null&&Te.tag===6?(h(Ie,Te.sibling),Xe=N(Te,Oe),Xe.return=Ie,Ie=Xe):(h(Ie,Te),Xe=ip(Oe,Ie.mode,Xe),Xe.return=Ie,Ie=Xe),q(Ie)):h(Ie,Te)}return function(Ie,Te,Oe,Xe){try{yi=0;var xt=Ln(Ie,Te,Oe,Xe);return Cr=null,xt}catch(Nt){if(Nt===ai||Nt===ff)throw Nt;var tn=di(29,Nt,null,Ie.mode);return tn.lanes=Xe,tn.return=Ie,tn}finally{}}}var $l=Dp(!0),Vg=Dp(!1),Li=ce(null),si=null;function ia(s){var c=s.alternate;I(dr,dr.current&1),I(Li,s),si===null&&(c===null||Dl.current!==null||c.memoizedState!==null)&&(si=s)}function Hg(s){if(s.tag===22){if(I(dr,dr.current),I(Li,s),si===null){var c=s.alternate;c!==null&&c.memoizedState!==null&&(si=s)}}else Rs()}function Rs(){I(dr,dr.current),I(Li,Li.current)}function ns(s){ue(Li),si===s&&(si=null),ue(dr)}var dr=ce(0);function Xu(s){for(var c=s;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||li(h)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function Mc(s,c,h,x){c=s.memoizedState,h=h(x,c),h=h==null?c:p({},c,h),s.memoizedState=h,s.lanes===0&&(s.updateQueue.baseState=h)}var Zu={enqueueSetState:function(s,c,h){s=s._reactInternals;var x=Qr(),N=Co(x);N.payload=c,h!=null&&(N.callback=h),c=As(s,N,x),c!==null&&(zi(c,s,x),Lu(c,s,x))},enqueueReplaceState:function(s,c,h){s=s._reactInternals;var x=Qr(),N=Co(x);N.tag=1,N.payload=c,h!=null&&(N.callback=h),c=As(s,N,x),c!==null&&(zi(c,s,x),Lu(c,s,x))},enqueueForceUpdate:function(s,c){s=s._reactInternals;var h=Qr(),x=Co(h);x.tag=2,c!=null&&(x.callback=c),c=As(s,x,h),c!==null&&(zi(c,s,h),Lu(c,s,h))}};function ed(s,c,h,x,N,P,q){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(x,P,q):c.prototype&&c.prototype.isPureReactComponent?!Xi(h,x)||!Xi(N,P):!0}function Gg(s,c,h,x){s=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,x),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,x),c.state!==s&&Zu.enqueueReplaceState(c,c.state,null)}function To(s,c){var h=c;if("ref"in c){h={};for(var x in c)x!=="ref"&&(h[x]=c[x])}if(s=s.defaultProps){h===c&&(h=p({},h));for(var N in s)h[N]===void 0&&(h[N]=s[N])}return h}var zl=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Ip(s){zl(s)}function Af(s){console.error(s)}function Yg(s){zl(s)}function td(s,c){try{var h=s.onUncaughtError;h(c.value,{componentStack:c.stack})}catch(x){setTimeout(function(){throw x})}}function rs(s,c,h){try{var x=s.onCaughtError;x(h.value,{componentStack:h.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function Pf(s,c,h){return h=Co(h),h.tag=3,h.payload={element:null},h.callback=function(){td(s,c)},h}function Rp(s){return s=Co(s),s.tag=3,s}function Wg(s,c,h,x){var N=h.type.getDerivedStateFromError;if(typeof N=="function"){var P=x.value;s.payload=function(){return N(P)},s.callback=function(){rs(c,h,x)}}var q=h.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(s.callback=function(){rs(c,h,x),typeof N!="function"&&(Ro===null?Ro=new Set([this]):Ro.add(this));var ee=x.stack;this.componentDidCatch(x.value,{componentStack:ee!==null?ee:""})})}function Qg(s,c,h,x,N){if(h.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(c=h.alternate,c!==null&&Ru(c,h,N,!0),h=Li.current,h!==null){switch(h.tag){case 13:return si===null?Zp():h.alternate===null&&fr===0&&(fr=3),h.flags&=-257,h.flags|=65536,h.lanes=N,x===cp?h.flags|=16384:(c=h.updateQueue,c===null?h.updateQueue=new Set([x]):c.add(x),nm(s,x,N)),!1;case 22:return h.flags|=65536,x===cp?h.flags|=16384:(c=h.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([x])},h.updateQueue=c):(h=c.retryQueue,h===null?c.retryQueue=new Set([x]):h.add(x)),nm(s,x,N)),!1}throw Error(r(435,h.tag))}return nm(s,x,N),Zp(),!1}if(on)return c=Li.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=N,x!==kc&&(s=Error(r(422),{cause:x}),So(Ce(s,h)))):(x!==kc&&(c=Error(r(423),{cause:x}),So(Ce(c,h))),s=s.current.alternate,s.flags|=65536,N&=-N,s.lanes|=N,x=Ce(x,h),N=Pf(s.stateNode,x,N),Ca(s,N),fr!==4&&(fr=2)),!1;var P=Error(r(520),{cause:x});if(P=Ce(P,h),dd===null?dd=[P]:dd.push(P),fr!==4&&(fr=2),c===null)return!0;x=Ce(x,h),h=c;do{switch(h.tag){case 3:return h.flags|=65536,s=N&-N,h.lanes|=s,s=Pf(h.stateNode,x,s),Ca(h,s),!1;case 1:if(c=h.type,P=h.stateNode,(h.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(Ro===null||!Ro.has(P))))return h.flags|=65536,N&=-N,h.lanes|=N,N=Rp(N),Wg(N,s,h,x),Ca(h,N),!1}h=h.return}while(h!==null);return!1}var Jg=Error(r(461)),Dr=!1;function Xn(s,c,h,x){c.child=s===null?Vg(c,null,h,x):$l(c,s.child,h,x)}function Df(s,c,h,x,N){h=h.render;var P=c.ref;if("ref"in x){var q={};for(var ee in x)ee!=="ref"&&(q[ee]=x[ee])}else q=x;return El(c),x=hp(s,c,h,q,P,N),ee=mp(),s!==null&&!Dr?(Rl(s,c,N),Ms(s,c,N)):(on&&ee&&sp(c),c.flags|=1,Xn(s,c,x,N),c.child)}function If(s,c,h,x,N){if(s===null){var P=h.type;return typeof P=="function"&&!_l(P)&&P.defaultProps===void 0&&h.compare===null?(c.tag=15,c.type=P,Rf(s,c,P,x,N)):(s=of(h.type,null,x,c,c.mode,N),s.ref=c.ref,s.return=c,c.child=s)}if(P=s.child,!ka(s,N)){var q=P.memoizedProps;if(h=h.compare,h=h!==null?h:Xi,h(q,x)&&s.ref===c.ref)return Ms(s,c,N)}return c.flags|=1,s=ii(P,x),s.ref=c.ref,s.return=c,c.child=s}function Rf(s,c,h,x,N){if(s!==null){var P=s.memoizedProps;if(Xi(P,x)&&s.ref===c.ref)if(Dr=!1,c.pendingProps=x=P,ka(s,N))(s.flags&131072)!==0&&(Dr=!0);else return c.lanes=s.lanes,Ms(s,c,N)}return Oc(s,c,h,x,N)}function nd(s,c,h){var x=c.pendingProps,N=x.children,P=s!==null?s.memoizedState:null;if(x.mode==="hidden"){if((c.flags&128)!==0){if(x=P!==null?P.baseLanes|h:h,s!==null){for(N=c.child=s.child,P=0;N!==null;)P=P|N.lanes|N.childLanes,N=N.sibling;c.childLanes=P&~x}else c.childLanes=0,c.child=null;return Ul(s,c,x,h)}if((h&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},s!==null&&df(c,P!==null?P.cachePool:null),P!==null?Ps(c,P):pf(),Hg(c);else return c.lanes=c.childLanes=536870912,Ul(s,c,P!==null?P.baseLanes|h:h,h)}else P!==null?(df(c,P.cachePool),Ps(c,P),Rs(),c.memoizedState=null):(s!==null&&df(c,null),pf(),Rs());return Xn(s,c,N,h),c.child}function Ul(s,c,h,x){var N=Es();return N=N===null?null:{parent:Un._currentValue,pool:N},c.memoizedState={baseLanes:h,cachePool:N},s!==null&&df(c,null),pf(),Hg(c),s!==null&&Ru(s,c,x,!0),null}function kt(s,c){var h=c.ref;if(h===null)s!==null&&s.ref!==null&&(c.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(r(284));(s===null||s.ref!==h)&&(c.flags|=4194816)}}function Oc(s,c,h,x,N){return El(c),h=hp(s,c,h,x,void 0,N),x=mp(),s!==null&&!Dr?(Rl(s,c,N),Ms(s,c,N)):(on&&x&&sp(c),c.flags|=1,Xn(s,c,h,N),c.child)}function Mf(s,c,h,x,N,P){return El(c),c.updateQueue=null,h=Pg(c,x,h,N),Ag(s),x=mp(),s!==null&&!Dr?(Rl(s,c,P),Ms(s,c,P)):(on&&x&&sp(c),c.flags|=1,Xn(s,c,h,P),c.child)}function Eo(s,c,h,x,N){if(El(c),c.stateNode===null){var P=Cl,q=h.contextType;typeof q=="object"&&q!==null&&(P=ur(q)),P=new h(x,P),c.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,P.updater=Zu,c.stateNode=P,P._reactInternals=c,P=c.stateNode,P.props=x,P.state=c.memoizedState,P.refs={},Pl(c),q=h.contextType,P.context=typeof q=="object"&&q!==null?ur(q):Cl,P.state=c.memoizedState,q=h.getDerivedStateFromProps,typeof q=="function"&&(Mc(c,h,q,x),P.state=c.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(q=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),q!==P.state&&Zu.enqueueReplaceState(P,P.state,null),Gr(c,x,P,N),_a(),P.state=c.memoizedState),typeof P.componentDidMount=="function"&&(c.flags|=4194308),x=!0}else if(s===null){P=c.stateNode;var ee=c.memoizedProps,ve=To(h,ee);P.props=ve;var Le=P.context,Ke=h.contextType;q=Cl,typeof Ke=="object"&&Ke!==null&&(q=ur(Ke));var tt=h.getDerivedStateFromProps;Ke=typeof tt=="function"||typeof P.getSnapshotBeforeUpdate=="function",ee=c.pendingProps!==ee,Ke||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(ee||Le!==q)&&Gg(c,P,x,q),es=!1;var Ue=c.memoizedState;P.state=Ue,Gr(c,x,P,N),_a(),Le=c.memoizedState,ee||Ue!==Le||es?(typeof tt=="function"&&(Mc(c,h,tt,x),Le=c.memoizedState),(ve=es||ed(c,h,ve,x,Ue,Le,q))?(Ke||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(c.flags|=4194308)):(typeof P.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=x,c.memoizedState=Le),P.props=x,P.state=Le,P.context=q,x=ve):(typeof P.componentDidMount=="function"&&(c.flags|=4194308),x=!1)}else{P=c.stateNode,Ac(s,c),q=c.memoizedProps,Ke=To(h,q),P.props=Ke,tt=c.pendingProps,Ue=P.context,Le=h.contextType,ve=Cl,typeof Le=="object"&&Le!==null&&(ve=ur(Le)),ee=h.getDerivedStateFromProps,(Le=typeof ee=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(q!==tt||Ue!==ve)&&Gg(c,P,x,ve),es=!1,Ue=c.memoizedState,P.state=Ue,Gr(c,x,P,N),_a();var Fe=c.memoizedState;q!==tt||Ue!==Fe||es||s!==null&&s.dependencies!==null&&cf(s.dependencies)?(typeof ee=="function"&&(Mc(c,h,ee,x),Fe=c.memoizedState),(Ke=es||ed(c,h,Ke,x,Ue,Fe,ve)||s!==null&&s.dependencies!==null&&cf(s.dependencies))?(Le||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(x,Fe,ve),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(x,Fe,ve)),typeof P.componentDidUpdate=="function"&&(c.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof P.componentDidUpdate!="function"||q===s.memoizedProps&&Ue===s.memoizedState||(c.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||q===s.memoizedProps&&Ue===s.memoizedState||(c.flags|=1024),c.memoizedProps=x,c.memoizedState=Fe),P.props=x,P.state=Fe,P.context=ve,x=Ke):(typeof P.componentDidUpdate!="function"||q===s.memoizedProps&&Ue===s.memoizedState||(c.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||q===s.memoizedProps&&Ue===s.memoizedState||(c.flags|=1024),x=!1)}return P=x,kt(s,c),x=(c.flags&128)!==0,P||x?(P=c.stateNode,h=x&&typeof h.getDerivedStateFromError!="function"?null:P.render(),c.flags|=1,s!==null&&x?(c.child=$l(c,s.child,null,N),c.child=$l(c,null,h,N)):Xn(s,c,h,N),c.memoizedState=P.state,s=c.child):s=Ms(s,c,N),s}function Kg(s,c,h,x){return Iu(),c.flags|=256,Xn(s,c,h,x),c.child}var rd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Of(s){return{baseLanes:s,cachePool:Ng()}}function Ir(s,c,h){return s=s!==null?s.childLanes&~h:0,c&&(s|=sa),s}function Xg(s,c,h){var x=c.pendingProps,N=!1,P=(c.flags&128)!==0,q;if((q=P)||(q=s!==null&&s.memoizedState===null?!1:(dr.current&2)!==0),q&&(N=!0,c.flags&=-129),q=(c.flags&32)!==0,c.flags&=-33,s===null){if(on){if(N?ia(c):Rs(),on){var ee=nr,ve;if(ve=ee){e:{for(ve=ee,ee=fi;ve.nodeType!==8;){if(!ee){ee=null;break e}if(ve=Ea(ve.nextSibling),ve===null){ee=null;break e}}ee=ve}ee!==null?(c.memoizedState={dehydrated:ee,treeContext:Kn!==null?{id:tr,overflow:Ts}:null,retryLane:536870912,hydrationErrors:null},ve=di(18,null,null,0),ve.stateNode=ee,ve.return=c,c.child=ve,Nr=c,nr=null,ve=!0):ve=!1}ve||ta(c)}if(ee=c.memoizedState,ee!==null&&(ee=ee.dehydrated,ee!==null))return li(ee)?c.lanes=32:c.lanes=536870912,null;ns(c)}return ee=x.children,x=x.fallback,N?(Rs(),N=c.mode,ee=id({mode:"hidden",children:ee},N),x=jl(x,N,h,null),ee.return=c,x.return=c,ee.sibling=x,c.child=ee,N=c.child,N.memoizedState=Of(h),N.childLanes=Ir(s,q,h),c.memoizedState=rd,x):(ia(c),Mp(c,ee))}if(ve=s.memoizedState,ve!==null&&(ee=ve.dehydrated,ee!==null)){if(P)c.flags&256?(ia(c),c.flags&=-257,c=Op(s,c,h)):c.memoizedState!==null?(Rs(),c.child=s.child,c.flags|=128,c=null):(Rs(),N=x.fallback,ee=c.mode,x=id({mode:"visible",children:x.children},ee),N=jl(N,ee,h,null),N.flags|=2,x.return=c,N.return=c,x.sibling=N,c.child=x,$l(c,s.child,null,h),x=c.child,x.memoizedState=Of(h),x.childLanes=Ir(s,q,h),c.memoizedState=rd,c=N);else if(ia(c),li(ee)){if(q=ee.nextSibling&&ee.nextSibling.dataset,q)var Le=q.dgst;q=Le,x=Error(r(419)),x.stack="",x.digest=q,So({value:x,source:null,stack:null}),c=Op(s,c,h)}else if(Dr||Ru(s,c,h,!1),q=(h&s.childLanes)!==0,Dr||q){if(q=Wn,q!==null&&(x=h&-h,x=(x&42)!==0?1:Ft(x),x=(x&(q.suspendedLanes|h))!==0?0:x,x!==0&&x!==ve.retryLane))throw ve.retryLane=x,js(s,x),zi(q,s,x),Jg;ee.data==="$?"||Zp(),c=Op(s,c,h)}else ee.data==="$?"?(c.flags|=192,c.child=s.child,c=null):(s=ve.treeContext,nr=Ea(ee.nextSibling),Nr=c,on=!0,Na=null,fi=!1,s!==null&&(Zi[ea++]=tr,Zi[ea++]=Ts,Zi[ea++]=Kn,tr=s.id,Ts=s.overflow,Kn=c),c=Mp(c,x.children),c.flags|=4096);return c}return N?(Rs(),N=x.fallback,ee=c.mode,ve=s.child,Le=ve.sibling,x=ii(ve,{mode:"hidden",children:x.children}),x.subtreeFlags=ve.subtreeFlags&65011712,Le!==null?N=ii(Le,N):(N=jl(N,ee,h,null),N.flags|=2),N.return=c,x.return=c,x.sibling=N,c.child=x,x=N,N=c.child,ee=s.child.memoizedState,ee===null?ee=Of(h):(ve=ee.cachePool,ve!==null?(Le=Un._currentValue,ve=ve.parent!==Le?{parent:Le,pool:Le}:ve):ve=Ng(),ee={baseLanes:ee.baseLanes|h,cachePool:ve}),N.memoizedState=ee,N.childLanes=Ir(s,q,h),c.memoizedState=rd,x):(ia(c),h=s.child,s=h.sibling,h=ii(h,{mode:"visible",children:x.children}),h.return=c,h.sibling=null,s!==null&&(q=c.deletions,q===null?(c.deletions=[s],c.flags|=16):q.push(s)),c.child=h,c.memoizedState=null,h)}function Mp(s,c){return c=id({mode:"visible",children:c},s.mode),c.return=s,s.child=c}function id(s,c){return s=di(22,s,null,c),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Op(s,c,h){return $l(c,s.child,null,h),s=Mp(c,c.pendingProps.children),s.flags|=2,c.memoizedState=null,s}function Lp(s,c,h){s.lanes|=c;var x=s.alternate;x!==null&&(x.lanes|=c),hi(s.return,c,h)}function Fp(s,c,h,x,N){var P=s.memoizedState;P===null?s.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:x,tail:h,tailMode:N}:(P.isBackwards=c,P.rendering=null,P.renderingStartTime=0,P.last=x,P.tail=h,P.tailMode=N)}function Zg(s,c,h){var x=c.pendingProps,N=x.revealOrder,P=x.tail;if(Xn(s,c,x.children,h),x=dr.current,(x&2)!==0)x=x&1|2,c.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=c.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Lp(s,h,c);else if(s.tag===19)Lp(s,h,c);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===c)break e;for(;s.sibling===null;){if(s.return===null||s.return===c)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}x&=1}switch(I(dr,x),N){case"forwards":for(h=c.child,N=null;h!==null;)s=h.alternate,s!==null&&Xu(s)===null&&(N=h),h=h.sibling;h=N,h===null?(N=c.child,c.child=null):(N=h.sibling,h.sibling=null),Fp(c,!1,N,h,P);break;case"backwards":for(h=null,N=c.child,c.child=null;N!==null;){if(s=N.alternate,s!==null&&Xu(s)===null){c.child=N;break}s=N.sibling,N.sibling=h,h=N,N=s}Fp(c,!0,h,null,P);break;case"together":Fp(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Ms(s,c,h){if(s!==null&&(c.dependencies=s.dependencies),Io|=c.lanes,(h&c.childLanes)===0)if(s!==null){if(Ru(s,c,h,!1),(h&c.childLanes)===0)return null}else return null;if(s!==null&&c.child!==s.child)throw Error(r(153));if(c.child!==null){for(s=c.child,h=ii(s,s.pendingProps),c.child=h,h.return=c;s.sibling!==null;)s=s.sibling,h=h.sibling=ii(s,s.pendingProps),h.return=c;h.sibling=null}return c.child}function ka(s,c){return(s.lanes&c)!==0?!0:(s=s.dependencies,!!(s!==null&&cf(s)))}function oi(s,c,h){switch(c.tag){case 3:se(c,c.stateNode.containerInfo),Mi(c,Un,s.memoizedState.cache),Iu();break;case 27:case 5:We(c);break;case 4:se(c,c.stateNode.containerInfo);break;case 10:Mi(c,c.type,c.memoizedProps.value);break;case 13:var x=c.memoizedState;if(x!==null)return x.dehydrated!==null?(ia(c),c.flags|=128,null):(h&c.child.childLanes)!==0?Xg(s,c,h):(ia(c),s=Ms(s,c,h),s!==null?s.sibling:null);ia(c);break;case 19:var N=(s.flags&128)!==0;if(x=(h&c.childLanes)!==0,x||(Ru(s,c,h,!1),x=(h&c.childLanes)!==0),N){if(x)return Zg(s,c,h);c.flags|=128}if(N=c.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),I(dr,dr.current),x)break;return null;case 22:case 23:return c.lanes=0,nd(s,c,h);case 24:Mi(c,Un,s.memoizedState.cache)}return Ms(s,c,h)}function Lf(s,c,h){if(s!==null)if(s.memoizedProps!==c.pendingProps)Dr=!0;else{if(!ka(s,h)&&(c.flags&128)===0)return Dr=!1,oi(s,c,h);Dr=(s.flags&131072)!==0}else Dr=!1,on&&(c.flags&1048576)!==0&&ap(c,Au,c.index);switch(c.lanes=0,c.tag){case 16:e:{s=c.pendingProps;var x=c.elementType,N=x._init;if(x=N(x._payload),c.type=x,typeof x=="function")_l(x)?(s=To(x,s),c.tag=1,c=Eo(null,c,x,s,h)):(c.tag=0,c=Oc(null,c,x,s,h));else{if(x!=null){if(N=x.$$typeof,N===z){c.tag=11,c=Df(null,c,x,s,h);break e}else if(N===U){c.tag=14,c=If(null,c,x,s,h);break e}}throw c=Q(x)||x,Error(r(306,c,""))}}return c;case 0:return Oc(s,c,c.type,c.pendingProps,h);case 1:return x=c.type,N=To(x,c.pendingProps),Eo(s,c,x,N,h);case 3:e:{if(se(c,c.stateNode.containerInfo),s===null)throw Error(r(387));x=c.pendingProps;var P=c.memoizedState;N=P.element,Ac(s,c),Gr(c,x,null,h);var q=c.memoizedState;if(x=q.cache,Mi(c,Un,x),x!==P.cache&&en(c,[Un],h,!0),_a(),x=q.element,P.isDehydrated)if(P={element:x,isDehydrated:!1,cache:q.cache},c.updateQueue.baseState=P,c.memoizedState=P,c.flags&256){c=Kg(s,c,x,h);break e}else if(x!==N){N=Ce(Error(r(424)),c),So(N),c=Kg(s,c,x,h);break e}else{switch(s=c.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(nr=Ea(s.firstChild),Nr=c,on=!0,Na=null,fi=!0,h=Vg(c,null,x,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(Iu(),x===N){c=Ms(s,c,h);break e}Xn(s,c,x,h)}c=c.child}return c;case 26:return kt(s,c),s===null?(h=Qy(c.type,null,c.pendingProps,null))?c.memoizedState=h:on||(h=c.type,s=c.pendingProps,x=Vl(W.current).createElement(h),x[yn]=c,x[wr]=s,kr(x,h,s),gr(x),c.stateNode=x):c.memoizedState=Qy(c.type,s.memoizedProps,c.pendingProps,s.memoizedState),null;case 27:return We(c),s===null&&on&&(x=c.stateNode=Gy(c.type,c.pendingProps,W.current),Nr=c,fi=!0,N=nr,oa(c.type)?(dm=N,nr=Ea(x.firstChild)):nr=N),Xn(s,c,c.pendingProps.children,h),kt(s,c),s===null&&(c.flags|=4194304),c.child;case 5:return s===null&&on&&((N=x=nr)&&(x=Vy(x,c.type,c.pendingProps,fi),x!==null?(c.stateNode=x,Nr=c,nr=Ea(x.firstChild),fi=!1,N=!0):N=!1),N||ta(c)),We(c),N=c.type,P=c.pendingProps,q=s!==null?s.memoizedProps:null,x=P.children,eh(N,P)?x=null:q!==null&&eh(N,q)&&(c.flags|=32),c.memoizedState!==null&&(N=hp(s,c,pp,null,null,h),tu._currentValue=N),kt(s,c),Xn(s,c,x,h),c.child;case 6:return s===null&&on&&((s=h=nr)&&(h=nh(h,c.pendingProps,fi),h!==null?(c.stateNode=h,Nr=c,nr=null,s=!0):s=!1),s||ta(c)),null;case 13:return Xg(s,c,h);case 4:return se(c,c.stateNode.containerInfo),x=c.pendingProps,s===null?c.child=$l(c,null,x,h):Xn(s,c,x,h),c.child;case 11:return Df(s,c,c.type,c.pendingProps,h);case 7:return Xn(s,c,c.pendingProps,h),c.child;case 8:return Xn(s,c,c.pendingProps.children,h),c.child;case 12:return Xn(s,c,c.pendingProps.children,h),c.child;case 10:return x=c.pendingProps,Mi(c,c.type,x.value),Xn(s,c,x.children,h),c.child;case 9:return N=c.type._context,x=c.pendingProps.children,El(c),N=ur(N),x=x(N),c.flags|=1,Xn(s,c,x,h),c.child;case 14:return If(s,c,c.type,c.pendingProps,h);case 15:return Rf(s,c,c.type,c.pendingProps,h);case 19:return Zg(s,c,h);case 31:return x=c.pendingProps,h=c.mode,x={mode:x.mode,children:x.children},s===null?(h=id(x,h),h.ref=c.ref,c.child=h,h.return=c,c=h):(h=ii(s.child,x),h.ref=c.ref,c.child=h,h.return=c,c=h),c;case 22:return nd(s,c,h);case 24:return El(c),x=ur(Un),s===null?(N=Es(),N===null&&(N=Wn,P=op(),N.pooledCache=P,P.refCount++,P!==null&&(N.pooledCacheLanes|=h),N=P),c.memoizedState={parent:x,cache:N},Pl(c),Mi(c,Un,N)):((s.lanes&h)!==0&&(Ac(s,c),Gr(c,null,null,h),_a()),N=s.memoizedState,P=c.memoizedState,N.parent!==x?(N={parent:x,cache:x},c.memoizedState=N,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=N),Mi(c,Un,x)):(x=P.cache,Mi(c,Un,x),x!==N.cache&&en(c,[Un],h,!0))),Xn(s,c,c.pendingProps.children,h),c.child;case 29:throw c.pendingProps}throw Error(r(156,c.tag))}function Os(s){s.flags|=4}function Ff(s,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Tr(c)){if(c=Li.current,c!==null&&((bn&4194048)===bn?si!==null:(bn&62914560)!==bn&&(bn&536870912)===0||c!==si))throw Ec=cp,Cg;s.flags|=8192}}function $f(s,c){c!==null&&(s.flags|=4),s.flags&16384&&(c=s.tag!==22?_t():536870912,s.lanes|=c,qc|=c)}function ad(s,c){if(!on)switch(s.tailMode){case"hidden":c=s.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?s.tail=null:h.sibling=null;break;case"collapsed":h=s.tail;for(var x=null;h!==null;)h.alternate!==null&&(x=h),h=h.sibling;x===null?c||s.tail===null?s.tail=null:s.tail.sibling=null:x.sibling=null}}function Bn(s){var c=s.alternate!==null&&s.alternate.child===s.child,h=0,x=0;if(c)for(var N=s.child;N!==null;)h|=N.lanes|N.childLanes,x|=N.subtreeFlags&65011712,x|=N.flags&65011712,N.return=s,N=N.sibling;else for(N=s.child;N!==null;)h|=N.lanes|N.childLanes,x|=N.subtreeFlags,x|=N.flags,N.return=s,N=N.sibling;return s.subtreeFlags|=x,s.childLanes=h,c}function ey(s,c,h){var x=c.pendingProps;switch(Pu(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bn(c),null;case 1:return Bn(c),null;case 3:return h=c.stateNode,x=null,s!==null&&(x=s.memoizedState.cache),c.memoizedState.cache!==x&&(c.flags|=2048),na(Un),je(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(s===null||s.child===null)&&(Du(c)?Os(c):s===null||s.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,bg())),Bn(c),null;case 26:return h=c.memoizedState,s===null?(Os(c),h!==null?(Bn(c),Ff(c,h)):(Bn(c),c.flags&=-16777217)):h?h!==s.memoizedState?(Os(c),Bn(c),Ff(c,h)):(Bn(c),c.flags&=-16777217):(s.memoizedProps!==x&&Os(c),Bn(c),c.flags&=-16777217),null;case 27:X(c),h=W.current;var N=c.type;if(s!==null&&c.stateNode!=null)s.memoizedProps!==x&&Os(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Bn(c),null}s=de.current,Du(c)?yg(c):(s=Gy(N,x,h),c.stateNode=s,Os(c))}return Bn(c),null;case 5:if(X(c),h=c.type,s!==null&&c.stateNode!=null)s.memoizedProps!==x&&Os(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Bn(c),null}if(s=de.current,Du(c))yg(c);else{switch(N=Vl(W.current),s){case 1:s=N.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:s=N.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":s=N.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":s=N.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":s=N.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof x.is=="string"?N.createElement("select",{is:x.is}):N.createElement("select"),x.multiple?s.multiple=!0:x.size&&(s.size=x.size);break;default:s=typeof x.is=="string"?N.createElement(h,{is:x.is}):N.createElement(h)}}s[yn]=c,s[wr]=x;e:for(N=c.child;N!==null;){if(N.tag===5||N.tag===6)s.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===c)break e;for(;N.sibling===null;){if(N.return===null||N.return===c)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}c.stateNode=s;e:switch(kr(s,h,x),h){case"button":case"input":case"select":case"textarea":s=!!x.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Os(c)}}return Bn(c),c.flags&=-16777217,null;case 6:if(s&&c.stateNode!=null)s.memoizedProps!==x&&Os(c);else{if(typeof x!="string"&&c.stateNode===null)throw Error(r(166));if(s=W.current,Du(c)){if(s=c.stateNode,h=c.memoizedProps,x=null,N=Nr,N!==null)switch(N.tag){case 27:case 5:x=N.memoizedProps}s[yn]=c,s=!!(s.nodeValue===h||x!==null&&x.suppressHydrationWarning===!0||zy(s.nodeValue,h)),s||ta(c)}else s=Vl(s).createTextNode(x),s[yn]=c,c.stateNode=s}return Bn(c),null;case 13:if(x=c.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(N=Du(c),x!==null&&x.dehydrated!==null){if(s===null){if(!N)throw Error(r(318));if(N=c.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(r(317));N[yn]=c}else Iu(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Bn(c),N=!1}else N=bg(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=N),N=!0;if(!N)return c.flags&256?(ns(c),c):(ns(c),null)}if(ns(c),(c.flags&128)!==0)return c.lanes=h,c;if(h=x!==null,s=s!==null&&s.memoizedState!==null,h){x=c.child,N=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(N=x.alternate.memoizedState.cachePool.pool);var P=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(P=x.memoizedState.cachePool.pool),P!==N&&(x.flags|=2048)}return h!==s&&h&&(c.child.flags|=8192),$f(c,c.updateQueue),Bn(c),null;case 4:return je(),s===null&&om(c.stateNode.containerInfo),Bn(c),null;case 10:return na(c.type),Bn(c),null;case 19:if(ue(dr),N=c.memoizedState,N===null)return Bn(c),null;if(x=(c.flags&128)!==0,P=N.rendering,P===null)if(x)ad(N,!1);else{if(fr!==0||s!==null&&(s.flags&128)!==0)for(s=c.child;s!==null;){if(P=Xu(s),P!==null){for(c.flags|=128,ad(N,!1),s=P.updateQueue,c.updateQueue=s,$f(c,s),c.subtreeFlags=0,s=h,h=c.child;h!==null;)Eu(h,s),h=h.sibling;return I(dr,dr.current&1|2),c.child}s=s.sibling}N.tail!==null&&lt()>Vc&&(c.flags|=128,x=!0,ad(N,!1),c.lanes=4194304)}else{if(!x)if(s=Xu(P),s!==null){if(c.flags|=128,x=!0,s=s.updateQueue,c.updateQueue=s,$f(c,s),ad(N,!0),N.tail===null&&N.tailMode==="hidden"&&!P.alternate&&!on)return Bn(c),null}else 2*lt()-N.renderingStartTime>Vc&&h!==536870912&&(c.flags|=128,x=!0,ad(N,!1),c.lanes=4194304);N.isBackwards?(P.sibling=c.child,c.child=P):(s=N.last,s!==null?s.sibling=P:c.child=P,N.last=P)}return N.tail!==null?(c=N.tail,N.rendering=c,N.tail=c.sibling,N.renderingStartTime=lt(),c.sibling=null,s=dr.current,I(dr,x?s&1|2:s&1),c):(Bn(c),null);case 22:case 23:return ns(c),fp(),x=c.memoizedState!==null,s!==null?s.memoizedState!==null!==x&&(c.flags|=8192):x&&(c.flags|=8192),x?(h&536870912)!==0&&(c.flags&128)===0&&(Bn(c),c.subtreeFlags&6&&(c.flags|=8192)):Bn(c),h=c.updateQueue,h!==null&&$f(c,h.retryQueue),h=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),x=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(x=c.memoizedState.cachePool.pool),x!==h&&(c.flags|=2048),s!==null&&ue(Al),null;case 24:return h=null,s!==null&&(h=s.memoizedState.cache),c.memoizedState.cache!==h&&(c.flags|=2048),na(Un),Bn(c),null;case 25:return null;case 30:return null}throw Error(r(156,c.tag))}function ty(s,c){switch(Pu(c),c.tag){case 1:return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 3:return na(Un),je(),s=c.flags,(s&65536)!==0&&(s&128)===0?(c.flags=s&-65537|128,c):null;case 26:case 27:case 5:return X(c),null;case 13:if(ns(c),s=c.memoizedState,s!==null&&s.dehydrated!==null){if(c.alternate===null)throw Error(r(340));Iu()}return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 19:return ue(dr),null;case 4:return je(),null;case 10:return na(c.type),null;case 22:case 23:return ns(c),fp(),s!==null&&ue(Al),s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 24:return na(Un),null;case 25:return null;default:return null}}function ny(s,c){switch(Pu(c),c.tag){case 3:na(Un),je();break;case 26:case 27:case 5:X(c);break;case 4:je();break;case 13:ns(c);break;case 19:ue(dr);break;case 10:na(c.type);break;case 22:case 23:ns(c),fp(),s!==null&&ue(Al);break;case 24:na(Un)}}function sd(s,c){try{var h=c.updateQueue,x=h!==null?h.lastEffect:null;if(x!==null){var N=x.next;h=N;do{if((h.tag&s)===s){x=void 0;var P=h.create,q=h.inst;x=P(),q.destroy=x}h=h.next}while(h!==N)}}catch(ee){qn(c,c.return,ee)}}function Ao(s,c,h){try{var x=c.updateQueue,N=x!==null?x.lastEffect:null;if(N!==null){var P=N.next;x=P;do{if((x.tag&s)===s){var q=x.inst,ee=q.destroy;if(ee!==void 0){q.destroy=void 0,N=c;var ve=h,Le=ee;try{Le()}catch(Ke){qn(N,ve,Ke)}}}x=x.next}while(x!==P)}}catch(Ke){qn(c,c.return,Ke)}}function ry(s){var c=s.updateQueue;if(c!==null){var h=s.stateNode;try{dp(c,h)}catch(x){qn(s,s.return,x)}}}function $p(s,c,h){h.props=To(s.type,s.memoizedProps),h.state=s.memoizedState;try{h.componentWillUnmount()}catch(x){qn(s,c,x)}}function Lc(s,c){try{var h=s.ref;if(h!==null){switch(s.tag){case 26:case 27:case 5:var x=s.stateNode;break;case 30:x=s.stateNode;break;default:x=s.stateNode}typeof h=="function"?s.refCleanup=h(x):h.current=x}}catch(N){qn(s,c,N)}}function is(s,c){var h=s.ref,x=s.refCleanup;if(h!==null)if(typeof x=="function")try{x()}catch(N){qn(s,c,N)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(N){qn(s,c,N)}else h.current=null}function zf(s){var c=s.type,h=s.memoizedProps,x=s.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":h.autoFocus&&x.focus();break e;case"img":h.src?x.src=h.src:h.srcSet&&(x.srcset=h.srcSet)}}catch(N){qn(s,s.return,N)}}function Uf(s,c,h){try{var x=s.stateNode;pv(x,s.type,h,c),x[wr]=c}catch(N){qn(s,s.return,N)}}function Fc(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&oa(s.type)||s.tag===4}function od(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Fc(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&oa(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Bf(s,c,h){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(s,c):(c=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,c.appendChild(s),h=h._reactRootContainer,h!=null||c.onclick!==null||(c.onclick=Xf));else if(x!==4&&(x===27&&oa(s.type)&&(h=s.stateNode,c=null),s=s.child,s!==null))for(Bf(s,c,h),s=s.sibling;s!==null;)Bf(s,c,h),s=s.sibling}function ld(s,c,h){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?h.insertBefore(s,c):h.appendChild(s);else if(x!==4&&(x===27&&oa(s.type)&&(h=s.stateNode),s=s.child,s!==null))for(ld(s,c,h),s=s.sibling;s!==null;)ld(s,c,h),s=s.sibling}function cd(s){var c=s.stateNode,h=s.memoizedProps;try{for(var x=s.type,N=c.attributes;N.length;)c.removeAttributeNode(N[0]);kr(c,x,h),c[yn]=s,c[wr]=h}catch(P){qn(s,s.return,P)}}var as=!1,En=!1,Ls=!1,iy=typeof WeakSet=="function"?WeakSet:Set,_r=null;function ev(s,c){if(s=s.containerInfo,Ta=sh,s=rf(s),Nl(s)){if("selectionStart"in s)var h={start:s.selectionStart,end:s.selectionEnd};else e:{h=(h=s.ownerDocument)&&h.defaultView||window;var x=h.getSelection&&h.getSelection();if(x&&x.rangeCount!==0){h=x.anchorNode;var N=x.anchorOffset,P=x.focusNode;x=x.focusOffset;try{h.nodeType,P.nodeType}catch{h=null;break e}var q=0,ee=-1,ve=-1,Le=0,Ke=0,tt=s,Ue=null;t:for(;;){for(var Fe;tt!==h||N!==0&&tt.nodeType!==3||(ee=q+N),tt!==P||x!==0&&tt.nodeType!==3||(ve=q+x),tt.nodeType===3&&(q+=tt.nodeValue.length),(Fe=tt.firstChild)!==null;)Ue=tt,tt=Fe;for(;;){if(tt===s)break t;if(Ue===h&&++Le===N&&(ee=q),Ue===P&&++Ke===x&&(ve=q),(Fe=tt.nextSibling)!==null)break;tt=Ue,Ue=tt.parentNode}tt=Fe}h=ee===-1||ve===-1?null:{start:ee,end:ve}}else h=null}h=h||{start:0,end:0}}else h=null;for(Zf={focusedElem:s,selectionRange:h},sh=!1,_r=c;_r!==null;)if(c=_r,s=c.child,(c.subtreeFlags&1024)!==0&&s!==null)s.return=c,_r=s;else for(;_r!==null;){switch(c=_r,P=c.alternate,s=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&P!==null){s=void 0,h=c,N=P.memoizedProps,P=P.memoizedState,x=h.stateNode;try{var Rt=To(h.type,N,h.elementType===h.type);s=x.getSnapshotBeforeUpdate(Rt,P),x.__reactInternalSnapshotBeforeUpdate=s}catch(It){qn(h,h.return,It)}}break;case 3:if((s&1024)!==0){if(s=c.stateNode.containerInfo,h=s.nodeType,h===9)um(s);else if(h===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":um(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=c.sibling,s!==null){s.return=c.return,_r=s;break}_r=c.return}}function ay(s,c,h){var x=h.flags;switch(h.tag){case 0:case 11:case 15:Po(s,h),x&4&&sd(5,h);break;case 1:if(Po(s,h),x&4)if(s=h.stateNode,c===null)try{s.componentDidMount()}catch(q){qn(h,h.return,q)}else{var N=To(h.type,c.memoizedProps);c=c.memoizedState;try{s.componentDidUpdate(N,c,s.__reactInternalSnapshotBeforeUpdate)}catch(q){qn(h,h.return,q)}}x&64&&ry(h),x&512&&Lc(h,h.return);break;case 3:if(Po(s,h),x&64&&(s=h.updateQueue,s!==null)){if(c=null,h.child!==null)switch(h.child.tag){case 27:case 5:c=h.child.stateNode;break;case 1:c=h.child.stateNode}try{dp(s,c)}catch(q){qn(h,h.return,q)}}break;case 27:c===null&&x&4&&cd(h);case 26:case 5:Po(s,h),c===null&&x&4&&zf(h),x&512&&Lc(h,h.return);break;case 12:Po(s,h);break;case 13:Po(s,h),x&4&&ly(s,h),x&64&&(s=h.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(h=Yf.bind(null,h),Jc(s,h))));break;case 22:if(x=h.memoizedState!==null||as,!x){c=c!==null&&c.memoizedState!==null||En,N=as;var P=En;as=x,(En=c)&&!P?$s(s,h,(h.subtreeFlags&8772)!==0):Po(s,h),as=N,En=P}break;case 30:break;default:Po(s,h)}}function sy(s){var c=s.alternate;c!==null&&(s.alternate=null,sy(c)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(c=s.stateNode,c!==null&&tc(c)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var rr=null,xi=!1;function Fs(s,c,h){for(h=h.child;h!==null;)oy(s,c,h),h=h.sibling}function oy(s,c,h){if(ge&&typeof ge.onCommitFiberUnmount=="function")try{ge.onCommitFiberUnmount(K,h)}catch{}switch(h.tag){case 26:En||is(h,c),Fs(s,c,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:En||is(h,c);var x=rr,N=xi;oa(h.type)&&(rr=h.stateNode,xi=!1),Fs(s,c,h),vd(h.stateNode),rr=x,xi=N;break;case 5:En||is(h,c);case 6:if(x=rr,N=xi,rr=null,Fs(s,c,h),rr=x,xi=N,rr!==null)if(xi)try{(rr.nodeType===9?rr.body:rr.nodeName==="HTML"?rr.ownerDocument.body:rr).removeChild(h.stateNode)}catch(P){qn(h,c,P)}else try{rr.removeChild(h.stateNode)}catch(P){qn(h,c,P)}break;case 18:rr!==null&&(xi?(s=rr,th(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,h.stateNode),Td(s)):th(rr,h.stateNode));break;case 4:x=rr,N=xi,rr=h.stateNode.containerInfo,xi=!0,Fs(s,c,h),rr=x,xi=N;break;case 0:case 11:case 14:case 15:En||Ao(2,h,c),En||Ao(4,h,c),Fs(s,c,h);break;case 1:En||(is(h,c),x=h.stateNode,typeof x.componentWillUnmount=="function"&&$p(h,c,x)),Fs(s,c,h);break;case 21:Fs(s,c,h);break;case 22:En=(x=En)||h.memoizedState!==null,Fs(s,c,h),En=x;break;default:Fs(s,c,h)}}function ly(s,c){if(c.memoizedState===null&&(s=c.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Td(s)}catch(h){qn(c,c.return,h)}}function tv(s){switch(s.tag){case 13:case 19:var c=s.stateNode;return c===null&&(c=s.stateNode=new iy),c;case 22:return s=s.stateNode,c=s._retryCache,c===null&&(c=s._retryCache=new iy),c;default:throw Error(r(435,s.tag))}}function zp(s,c){var h=tv(s);c.forEach(function(x){var N=ov.bind(null,s,x);h.has(x)||(h.add(x),x.then(N,N))})}function Fi(s,c){var h=c.deletions;if(h!==null)for(var x=0;x<h.length;x++){var N=h[x],P=s,q=c,ee=q;e:for(;ee!==null;){switch(ee.tag){case 27:if(oa(ee.type)){rr=ee.stateNode,xi=!1;break e}break;case 5:rr=ee.stateNode,xi=!1;break e;case 3:case 4:rr=ee.stateNode.containerInfo,xi=!0;break e}ee=ee.return}if(rr===null)throw Error(r(160));oy(P,q,N),rr=null,xi=!1,P=N.alternate,P!==null&&(P.return=null),N.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)Up(c,s),c=c.sibling}var aa=null;function Up(s,c){var h=s.alternate,x=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Fi(c,s),bi(s),x&4&&(Ao(3,s,s.return),sd(3,s),Ao(5,s,s.return));break;case 1:Fi(c,s),bi(s),x&512&&(En||h===null||is(h,h.return)),x&64&&as&&(s=s.updateQueue,s!==null&&(x=s.callbacks,x!==null&&(h=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=h===null?x:h.concat(x))));break;case 26:var N=aa;if(Fi(c,s),bi(s),x&512&&(En||h===null||is(h,h.return)),x&4){var P=h!==null?h.memoizedState:null;if(x=s.memoizedState,h===null)if(x===null)if(s.stateNode===null){e:{x=s.type,h=s.memoizedProps,N=N.ownerDocument||N;t:switch(x){case"title":P=N.getElementsByTagName("title")[0],(!P||P[Xs]||P[yn]||P.namespaceURI==="http://www.w3.org/2000/svg"||P.hasAttribute("itemprop"))&&(P=N.createElement(x),N.head.insertBefore(P,N.querySelector("head > title"))),kr(P,x,h),P[yn]=s,gr(P),x=P;break e;case"link":var q=Xy("link","href",N).get(x+(h.href||""));if(q){for(var ee=0;ee<q.length;ee++)if(P=q[ee],P.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&P.getAttribute("rel")===(h.rel==null?null:h.rel)&&P.getAttribute("title")===(h.title==null?null:h.title)&&P.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){q.splice(ee,1);break t}}P=N.createElement(x),kr(P,x,h),N.head.appendChild(P);break;case"meta":if(q=Xy("meta","content",N).get(x+(h.content||""))){for(ee=0;ee<q.length;ee++)if(P=q[ee],P.getAttribute("content")===(h.content==null?null:""+h.content)&&P.getAttribute("name")===(h.name==null?null:h.name)&&P.getAttribute("property")===(h.property==null?null:h.property)&&P.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&P.getAttribute("charset")===(h.charSet==null?null:h.charSet)){q.splice(ee,1);break t}}P=N.createElement(x),kr(P,x,h),N.head.appendChild(P);break;default:throw Error(r(468,x))}P[yn]=s,gr(P),x=P}s.stateNode=x}else Zy(N,s.type,s.stateNode);else s.stateNode=Ky(N,x,s.memoizedProps);else P!==x?(P===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):P.count--,x===null?Zy(N,s.type,s.stateNode):Ky(N,x,s.memoizedProps)):x===null&&s.stateNode!==null&&Uf(s,s.memoizedProps,h.memoizedProps)}break;case 27:Fi(c,s),bi(s),x&512&&(En||h===null||is(h,h.return)),h!==null&&x&4&&Uf(s,s.memoizedProps,h.memoizedProps);break;case 5:if(Fi(c,s),bi(s),x&512&&(En||h===null||is(h,h.return)),s.flags&32){N=s.stateNode;try{Pi(N,"")}catch(Fe){qn(s,s.return,Fe)}}x&4&&s.stateNode!=null&&(N=s.memoizedProps,Uf(s,N,h!==null?h.memoizedProps:N)),x&1024&&(Ls=!0);break;case 6:if(Fi(c,s),bi(s),x&4){if(s.stateNode===null)throw Error(r(162));x=s.memoizedProps,h=s.stateNode;try{h.nodeValue=x}catch(Fe){qn(s,s.return,Fe)}}break;case 3:if(eu=null,N=aa,aa=Gt(c.containerInfo),Fi(c,s),aa=N,bi(s),x&4&&h!==null&&h.memoizedState.isDehydrated)try{Td(c.containerInfo)}catch(Fe){qn(s,s.return,Fe)}Ls&&(Ls=!1,cy(s));break;case 4:x=aa,aa=Gt(s.stateNode.containerInfo),Fi(c,s),bi(s),aa=x;break;case 12:Fi(c,s),bi(s);break;case 13:Fi(c,s),bi(s),s.child.flags&8192&&s.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(Wp=lt()),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,zp(s,x)));break;case 22:N=s.memoizedState!==null;var ve=h!==null&&h.memoizedState!==null,Le=as,Ke=En;if(as=Le||N,En=Ke||ve,Fi(c,s),En=Ke,as=Le,bi(s),x&8192)e:for(c=s.stateNode,c._visibility=N?c._visibility&-2:c._visibility|1,N&&(h===null||ve||as||En||Bl(s)),h=null,c=s;;){if(c.tag===5||c.tag===26){if(h===null){ve=h=c;try{if(P=ve.stateNode,N)q=P.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{ee=ve.stateNode;var tt=ve.memoizedProps.style,Ue=tt!=null&&tt.hasOwnProperty("display")?tt.display:null;ee.style.display=Ue==null||typeof Ue=="boolean"?"":(""+Ue).trim()}}catch(Fe){qn(ve,ve.return,Fe)}}}else if(c.tag===6){if(h===null){ve=c;try{ve.stateNode.nodeValue=N?"":ve.memoizedProps}catch(Fe){qn(ve,ve.return,Fe)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===s)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break e;for(;c.sibling===null;){if(c.return===null||c.return===s)break e;h===c&&(h=null),c=c.return}h===c&&(h=null),c.sibling.return=c.return,c=c.sibling}x&4&&(x=s.updateQueue,x!==null&&(h=x.retryQueue,h!==null&&(x.retryQueue=null,zp(s,h))));break;case 19:Fi(c,s),bi(s),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,zp(s,x)));break;case 30:break;case 21:break;default:Fi(c,s),bi(s)}}function bi(s){var c=s.flags;if(c&2){try{for(var h,x=s.return;x!==null;){if(Fc(x)){h=x;break}x=x.return}if(h==null)throw Error(r(160));switch(h.tag){case 27:var N=h.stateNode,P=od(s);ld(s,P,N);break;case 5:var q=h.stateNode;h.flags&32&&(Pi(q,""),h.flags&=-33);var ee=od(s);ld(s,ee,q);break;case 3:case 4:var ve=h.stateNode.containerInfo,Le=od(s);Bf(s,Le,ve);break;default:throw Error(r(161))}}catch(Ke){qn(s,s.return,Ke)}s.flags&=-3}c&4096&&(s.flags&=-4097)}function cy(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var c=s;cy(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),s=s.sibling}}function Po(s,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)ay(s,c.alternate,c),c=c.sibling}function Bl(s){for(s=s.child;s!==null;){var c=s;switch(c.tag){case 0:case 11:case 14:case 15:Ao(4,c,c.return),Bl(c);break;case 1:is(c,c.return);var h=c.stateNode;typeof h.componentWillUnmount=="function"&&$p(c,c.return,h),Bl(c);break;case 27:vd(c.stateNode);case 26:case 5:is(c,c.return),Bl(c);break;case 22:c.memoizedState===null&&Bl(c);break;case 30:Bl(c);break;default:Bl(c)}s=s.sibling}}function $s(s,c,h){for(h=h&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var x=c.alternate,N=s,P=c,q=P.flags;switch(P.tag){case 0:case 11:case 15:$s(N,P,h),sd(4,P);break;case 1:if($s(N,P,h),x=P,N=x.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(Le){qn(x,x.return,Le)}if(x=P,N=x.updateQueue,N!==null){var ee=x.stateNode;try{var ve=N.shared.hiddenCallbacks;if(ve!==null)for(N.shared.hiddenCallbacks=null,N=0;N<ve.length;N++)Tg(ve[N],ee)}catch(Le){qn(x,x.return,Le)}}h&&q&64&&ry(P),Lc(P,P.return);break;case 27:cd(P);case 26:case 5:$s(N,P,h),h&&x===null&&q&4&&zf(P),Lc(P,P.return);break;case 12:$s(N,P,h);break;case 13:$s(N,P,h),h&&q&4&&ly(N,P);break;case 22:P.memoizedState===null&&$s(N,P,h),Lc(P,P.return);break;case 30:break;default:$s(N,P,h)}c=c.sibling}}function Bp(s,c){var h=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),s=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(s=c.memoizedState.cachePool.pool),s!==h&&(s!=null&&s.refCount++,h!=null&&Mu(h))}function qp(s,c){s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&Mu(s))}function ss(s,c,h,x){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)uy(s,c,h,x),c=c.sibling}function uy(s,c,h,x){var N=c.flags;switch(c.tag){case 0:case 11:case 15:ss(s,c,h,x),N&2048&&sd(9,c);break;case 1:ss(s,c,h,x);break;case 3:ss(s,c,h,x),N&2048&&(s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&Mu(s)));break;case 12:if(N&2048){ss(s,c,h,x),s=c.stateNode;try{var P=c.memoizedProps,q=P.id,ee=P.onPostCommit;typeof ee=="function"&&ee(q,c.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(ve){qn(c,c.return,ve)}}else ss(s,c,h,x);break;case 13:ss(s,c,h,x);break;case 23:break;case 22:P=c.stateNode,q=c.alternate,c.memoizedState!==null?P._visibility&2?ss(s,c,h,x):ud(s,c):P._visibility&2?ss(s,c,h,x):(P._visibility|=2,$c(s,c,h,x,(c.subtreeFlags&10256)!==0)),N&2048&&Bp(q,c);break;case 24:ss(s,c,h,x),N&2048&&qp(c.alternate,c);break;default:ss(s,c,h,x)}}function $c(s,c,h,x,N){for(N=N&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var P=s,q=c,ee=h,ve=x,Le=q.flags;switch(q.tag){case 0:case 11:case 15:$c(P,q,ee,ve,N),sd(8,q);break;case 23:break;case 22:var Ke=q.stateNode;q.memoizedState!==null?Ke._visibility&2?$c(P,q,ee,ve,N):ud(P,q):(Ke._visibility|=2,$c(P,q,ee,ve,N)),N&&Le&2048&&Bp(q.alternate,q);break;case 24:$c(P,q,ee,ve,N),N&&Le&2048&&qp(q.alternate,q);break;default:$c(P,q,ee,ve,N)}c=c.sibling}}function ud(s,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var h=s,x=c,N=x.flags;switch(x.tag){case 22:ud(h,x),N&2048&&Bp(x.alternate,x);break;case 24:ud(h,x),N&2048&&qp(x.alternate,x);break;default:ud(h,x)}c=c.sibling}}var Wr=8192;function zc(s){if(s.subtreeFlags&Wr)for(s=s.child;s!==null;)dy(s),s=s.sibling}function dy(s){switch(s.tag){case 26:zc(s),s.flags&Wr&&s.memoizedState!==null&&jv(aa,s.memoizedState,s.memoizedProps);break;case 5:zc(s);break;case 3:case 4:var c=aa;aa=Gt(s.stateNode.containerInfo),zc(s),aa=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Wr,Wr=16777216,zc(s),Wr=c):zc(s));break;default:zc(s)}}function fy(s){var c=s.alternate;if(c!==null&&(s=c.child,s!==null)){c.child=null;do c=s.sibling,s.sibling=null,s=c;while(s!==null)}}function Uc(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var h=0;h<c.length;h++){var x=c[h];_r=x,py(x,s)}fy(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)hy(s),s=s.sibling}function hy(s){switch(s.tag){case 0:case 11:case 15:Uc(s),s.flags&2048&&Ao(9,s,s.return);break;case 3:Uc(s);break;case 12:Uc(s);break;case 22:var c=s.stateNode;s.memoizedState!==null&&c._visibility&2&&(s.return===null||s.return.tag!==13)?(c._visibility&=-3,qf(s)):Uc(s);break;default:Uc(s)}}function qf(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var h=0;h<c.length;h++){var x=c[h];_r=x,py(x,s)}fy(s)}for(s=s.child;s!==null;){switch(c=s,c.tag){case 0:case 11:case 15:Ao(8,c,c.return),qf(c);break;case 22:h=c.stateNode,h._visibility&2&&(h._visibility&=-3,qf(c));break;default:qf(c)}s=s.sibling}}function py(s,c){for(;_r!==null;){var h=_r;switch(h.tag){case 0:case 11:case 15:Ao(8,h,c);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var x=h.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Mu(h.memoizedState.cache)}if(x=h.child,x!==null)x.return=h,_r=x;else e:for(h=s;_r!==null;){x=_r;var N=x.sibling,P=x.return;if(sy(x),x===h){_r=null;break e}if(N!==null){N.return=P,_r=N;break e}_r=P}}}var nv={getCacheForType:function(s){var c=ur(Un),h=c.data.get(s);return h===void 0&&(h=s(),c.data.set(s,h)),h}},Vp=typeof WeakMap=="function"?WeakMap:Map,Pn=0,Wn=null,an=null,bn=0,Dn=0,$i=null,Do=!1,Bc=!1,Hp=!1,zs=0,fr=0,Io=0,ql=0,Gp=0,sa=0,qc=0,dd=null,vi=null,Yp=!1,Wp=0,Vc=1/0,fd=null,Ro=null,zr=0,Mo=null,Hc=null,Gc=0,Qp=0,Jp=null,my=null,Yc=0,Kp=null;function Qr(){if((Pn&2)!==0&&bn!==0)return bn&-bn;if(V.T!==null){var s=Tc;return s!==0?s:Jf()}return Jn()}function gy(){sa===0&&(sa=(bn&536870912)===0||on?yt():536870912);var s=Li.current;return s!==null&&(s.flags|=32),sa}function zi(s,c,h){(s===Wn&&(Dn===2||Dn===9)||s.cancelPendingCommit!==null)&&(Wc(s,0),Oo(s,bn,sa,!1)),gn(s,h),((Pn&2)===0||s!==Wn)&&(s===Wn&&((Pn&2)===0&&(ql|=h),fr===4&&Oo(s,bn,sa,!1)),os(s))}function yy(s,c,h){if((Pn&6)!==0)throw Error(r(327));var x=!h&&(c&124)===0&&(c&s.expiredLanes)===0||qe(s,c),N=x?av(s,c):em(s,c,!0),P=x;do{if(N===0){Bc&&!x&&Oo(s,c,0,!1);break}else{if(h=s.current.alternate,P&&!rv(h)){N=em(s,c,!1),P=!1;continue}if(N===2){if(P=c,s.errorRecoveryDisabledLanes&P)var q=0;else q=s.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){c=q;e:{var ee=s;N=dd;var ve=ee.current.memoizedState.isDehydrated;if(ve&&(Wc(ee,q).flags|=256),q=em(ee,q,!1),q!==2){if(Hp&&!ve){ee.errorRecoveryDisabledLanes|=P,ql|=P,N=4;break e}P=vi,vi=N,P!==null&&(vi===null?vi=P:vi.push.apply(vi,P))}N=q}if(P=!1,N!==2)continue}}if(N===1){Wc(s,0),Oo(s,c,0,!0);break}e:{switch(x=s,P=N,P){case 0:case 1:throw Error(r(345));case 4:if((c&4194048)!==c)break;case 6:Oo(x,c,sa,!Do);break e;case 2:vi=null;break;case 3:case 5:break;default:throw Error(r(329))}if((c&62914560)===c&&(N=Wp+300-lt(),10<N)){if(Oo(x,c,sa,!Do),De(x,0,!0)!==0)break e;x.timeoutHandle=Uy(xy.bind(null,x,h,vi,fd,Yp,c,sa,ql,qc,Do,P,2,-0,0),N);break e}xy(x,h,vi,fd,Yp,c,sa,ql,qc,Do,P,0,-0,0)}}break}while(!0);os(s)}function xy(s,c,h,x,N,P,q,ee,ve,Le,Ke,tt,Ue,Fe){if(s.timeoutHandle=-1,tt=c.subtreeFlags,(tt&8192||(tt&16785408)===16785408)&&(Rr={stylesheets:null,count:0,unsuspend:_v},dy(c),tt=kv(),tt!==null)){s.cancelPendingCommit=tt(hd.bind(null,s,c,P,h,x,N,q,ee,ve,Ke,1,Ue,Fe)),Oo(s,P,q,!Le);return}hd(s,c,P,h,x,N,q,ee,ve)}function rv(s){for(var c=s;;){var h=c.tag;if((h===0||h===11||h===15)&&c.flags&16384&&(h=c.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var x=0;x<h.length;x++){var N=h[x],P=N.getSnapshot;N=N.value;try{if(!ni(P(),N))return!1}catch{return!1}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Oo(s,c,h,x){c&=~Gp,c&=~ql,s.suspendedLanes|=c,s.pingedLanes&=~c,x&&(s.warmLanes|=c),x=s.expirationTimes;for(var N=c;0<N;){var P=31-Qe(N),q=1<<P;x[P]=-1,N&=~q}h!==0&&wt(s,h,c)}function Vf(){return(Pn&6)===0?(gd(0),!1):!0}function Xp(){if(an!==null){if(Dn===0)var s=an.return;else s=an,Z=No=null,mf(s),Cr=null,yi=0,s=an;for(;s!==null;)ny(s.alternate,s),s=s.return;an=null}}function Wc(s,c){var h=s.timeoutHandle;h!==-1&&(s.timeoutHandle=-1,gv(h)),h=s.cancelPendingCommit,h!==null&&(s.cancelPendingCommit=null,h()),Xp(),Wn=s,an=h=ii(s.current,null),bn=c,Dn=0,$i=null,Do=!1,Bc=qe(s,c),Hp=!1,qc=sa=Gp=ql=Io=fr=0,vi=dd=null,Yp=!1,(c&8)!==0&&(c|=c&32);var x=s.entangledLanes;if(x!==0)for(s=s.entanglements,x&=c;0<x;){var N=31-Qe(x),P=1<<N;c|=s[N],x&=~P}return zs=c,Ct(),h}function by(s,c){Jt=null,V.H=Ju,c===ai||c===ff?(c=jg(),Dn=3):c===Cg?(c=jg(),Dn=4):Dn=c===Jg?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,$i=c,an===null&&(fr=1,td(s,Ce(c,s.current)))}function vy(){var s=V.H;return V.H=Ju,s===null?Ju:s}function wy(){var s=V.A;return V.A=nv,s}function Zp(){fr=4,Do||(bn&4194048)!==bn&&Li.current!==null||(Bc=!0),(Io&134217727)===0&&(ql&134217727)===0||Wn===null||Oo(Wn,bn,sa,!1)}function em(s,c,h){var x=Pn;Pn|=2;var N=vy(),P=wy();(Wn!==s||bn!==c)&&(fd=null,Wc(s,c)),c=!1;var q=fr;e:do try{if(Dn!==0&&an!==null){var ee=an,ve=$i;switch(Dn){case 8:Xp(),q=6;break e;case 3:case 2:case 9:case 6:Li.current===null&&(c=!0);var Le=Dn;if(Dn=0,$i=null,Qc(s,ee,ve,Le),h&&Bc){q=0;break e}break;default:Le=Dn,Dn=0,$i=null,Qc(s,ee,ve,Le)}}iv(),q=fr;break}catch(Ke){by(s,Ke)}while(!0);return c&&s.shellSuspendCounter++,Z=No=null,Pn=x,V.H=N,V.A=P,an===null&&(Wn=null,bn=0,Ct()),q}function iv(){for(;an!==null;)tm(an)}function av(s,c){var h=Pn;Pn|=2;var x=vy(),N=wy();Wn!==s||bn!==c?(fd=null,Vc=lt()+500,Wc(s,c)):Bc=qe(s,c);e:do try{if(Dn!==0&&an!==null){c=an;var P=$i;t:switch(Dn){case 1:Dn=0,$i=null,Qc(s,c,P,1);break;case 2:case 9:if(_g(P)){Dn=0,$i=null,Ny(c);break}c=function(){Dn!==2&&Dn!==9||Wn!==s||(Dn=7),os(s)},P.then(c,c);break e;case 3:Dn=7;break e;case 4:Dn=5;break e;case 7:_g(P)?(Dn=0,$i=null,Ny(c)):(Dn=0,$i=null,Qc(s,c,P,7));break;case 5:var q=null;switch(an.tag){case 26:q=an.memoizedState;case 5:case 27:var ee=an;if(!q||Tr(q)){Dn=0,$i=null;var ve=ee.sibling;if(ve!==null)an=ve;else{var Le=ee.return;Le!==null?(an=Le,Hf(Le)):an=null}break t}}Dn=0,$i=null,Qc(s,c,P,5);break;case 6:Dn=0,$i=null,Qc(s,c,P,6);break;case 8:Xp(),fr=6;break e;default:throw Error(r(462))}}Sy();break}catch(Ke){by(s,Ke)}while(!0);return Z=No=null,V.H=x,V.A=N,Pn=h,an!==null?0:(Wn=null,bn=0,Ct(),fr)}function Sy(){for(;an!==null&&!Ze();)tm(an)}function tm(s){var c=Lf(s.alternate,s,zs);s.memoizedProps=s.pendingProps,c===null?Hf(s):an=c}function Ny(s){var c=s,h=c.alternate;switch(c.tag){case 15:case 0:c=Mf(h,c,c.pendingProps,c.type,void 0,bn);break;case 11:c=Mf(h,c,c.pendingProps,c.type.render,c.ref,bn);break;case 5:mf(c);default:ny(h,c),c=an=Eu(c,zs),c=Lf(h,c,zs)}s.memoizedProps=s.pendingProps,c===null?Hf(s):an=c}function Qc(s,c,h,x){Z=No=null,mf(c),Cr=null,yi=0;var N=c.return;try{if(Qg(s,N,c,h,bn)){fr=1,td(s,Ce(h,s.current)),an=null;return}}catch(P){if(N!==null)throw an=N,P;fr=1,td(s,Ce(h,s.current)),an=null;return}c.flags&32768?(on||x===1?s=!0:Bc||(bn&536870912)!==0?s=!1:(Do=s=!0,(x===2||x===9||x===3||x===6)&&(x=Li.current,x!==null&&x.tag===13&&(x.flags|=16384))),Cy(c,s)):Hf(c)}function Hf(s){var c=s;do{if((c.flags&32768)!==0){Cy(c,Do);return}s=c.return;var h=ey(c.alternate,c,zs);if(h!==null){an=h;return}if(c=c.sibling,c!==null){an=c;return}an=c=s}while(c!==null);fr===0&&(fr=5)}function Cy(s,c){do{var h=ty(s.alternate,s);if(h!==null){h.flags&=32767,an=h;return}if(h=s.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!c&&(s=s.sibling,s!==null)){an=s;return}an=s=h}while(s!==null);fr=6,an=null}function hd(s,c,h,x,N,P,q,ee,ve){s.cancelPendingCommit=null;do Gf();while(zr!==0);if((Pn&6)!==0)throw Error(r(327));if(c!==null){if(c===s.current)throw Error(r(177));if(P=c.lanes|c.childLanes,P|=jt,Cn(s,h,P,q,ee,ve),s===Wn&&(an=Wn=null,bn=0),Hc=c,Mo=s,Gc=h,Qp=P,Jp=N,my=x,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Dy(be,function(){return Ey(),null})):(s.callbackNode=null,s.callbackPriority=0),x=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||x){x=V.T,V.T=null,N=ae.p,ae.p=2,q=Pn,Pn|=4;try{ev(s,c,h)}finally{Pn=q,ae.p=N,V.T=x}}zr=1,_y(),jy(),ky()}}function _y(){if(zr===1){zr=0;var s=Mo,c=Hc,h=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||h){h=V.T,V.T=null;var x=ae.p;ae.p=2;var N=Pn;Pn|=4;try{Up(c,s);var P=Zf,q=rf(s.containerInfo),ee=P.focusedElem,ve=P.selectionRange;if(q!==ee&&ee&&ee.ownerDocument&&Cs(ee.ownerDocument.documentElement,ee)){if(ve!==null&&Nl(ee)){var Le=ve.start,Ke=ve.end;if(Ke===void 0&&(Ke=Le),"selectionStart"in ee)ee.selectionStart=Le,ee.selectionEnd=Math.min(Ke,ee.value.length);else{var tt=ee.ownerDocument||document,Ue=tt&&tt.defaultView||window;if(Ue.getSelection){var Fe=Ue.getSelection(),Rt=ee.textContent.length,It=Math.min(ve.start,Rt),Ln=ve.end===void 0?It:Math.min(ve.end,Rt);!Fe.extend&&It>Ln&&(q=Ln,Ln=It,It=q);var Ie=ju(ee,It),Te=ju(ee,Ln);if(Ie&&Te&&(Fe.rangeCount!==1||Fe.anchorNode!==Ie.node||Fe.anchorOffset!==Ie.offset||Fe.focusNode!==Te.node||Fe.focusOffset!==Te.offset)){var Oe=tt.createRange();Oe.setStart(Ie.node,Ie.offset),Fe.removeAllRanges(),It>Ln?(Fe.addRange(Oe),Fe.extend(Te.node,Te.offset)):(Oe.setEnd(Te.node,Te.offset),Fe.addRange(Oe))}}}}for(tt=[],Fe=ee;Fe=Fe.parentNode;)Fe.nodeType===1&&tt.push({element:Fe,left:Fe.scrollLeft,top:Fe.scrollTop});for(typeof ee.focus=="function"&&ee.focus(),ee=0;ee<tt.length;ee++){var Xe=tt[ee];Xe.element.scrollLeft=Xe.left,Xe.element.scrollTop=Xe.top}}sh=!!Ta,Zf=Ta=null}finally{Pn=N,ae.p=x,V.T=h}}s.current=c,zr=2}}function jy(){if(zr===2){zr=0;var s=Mo,c=Hc,h=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||h){h=V.T,V.T=null;var x=ae.p;ae.p=2;var N=Pn;Pn|=4;try{ay(s,c.alternate,c)}finally{Pn=N,ae.p=x,V.T=h}}zr=3}}function ky(){if(zr===4||zr===3){zr=0,rt();var s=Mo,c=Hc,h=Gc,x=my;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?zr=5:(zr=0,Hc=Mo=null,Ty(s,s.pendingLanes));var N=s.pendingLanes;if(N===0&&(Ro=null),St(h),c=c.stateNode,ge&&typeof ge.onCommitFiberRoot=="function")try{ge.onCommitFiberRoot(K,c,void 0,(c.current.flags&128)===128)}catch{}if(x!==null){c=V.T,N=ae.p,ae.p=2,V.T=null;try{for(var P=s.onRecoverableError,q=0;q<x.length;q++){var ee=x[q];P(ee.value,{componentStack:ee.stack})}}finally{V.T=c,ae.p=N}}(Gc&3)!==0&&Gf(),os(s),N=s.pendingLanes,(h&4194090)!==0&&(N&42)!==0?s===Kp?Yc++:(Yc=0,Kp=s):Yc=0,gd(0)}}function Ty(s,c){(s.pooledCacheLanes&=c)===0&&(c=s.pooledCache,c!=null&&(s.pooledCache=null,Mu(c)))}function Gf(s){return _y(),jy(),ky(),Ey()}function Ey(){if(zr!==5)return!1;var s=Mo,c=Qp;Qp=0;var h=St(Gc),x=V.T,N=ae.p;try{ae.p=32>h?32:h,V.T=null,h=Jp,Jp=null;var P=Mo,q=Gc;if(zr=0,Hc=Mo=null,Gc=0,(Pn&6)!==0)throw Error(r(331));var ee=Pn;if(Pn|=4,hy(P.current),uy(P,P.current,q,h),Pn=ee,gd(0,!1),ge&&typeof ge.onPostCommitFiberRoot=="function")try{ge.onPostCommitFiberRoot(K,P)}catch{}return!0}finally{ae.p=N,V.T=x,Ty(s,c)}}function Ay(s,c,h){c=Ce(h,c),c=Pf(s.stateNode,c,2),s=As(s,c,2),s!==null&&(gn(s,2),os(s))}function qn(s,c,h){if(s.tag===3)Ay(s,s,h);else for(;c!==null;){if(c.tag===3){Ay(c,s,h);break}else if(c.tag===1){var x=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Ro===null||!Ro.has(x))){s=Ce(h,s),h=Rp(2),x=As(c,h,2),x!==null&&(Wg(h,x,c,s),gn(x,2),os(x));break}}c=c.return}}function nm(s,c,h){var x=s.pingCache;if(x===null){x=s.pingCache=new Vp;var N=new Set;x.set(c,N)}else N=x.get(c),N===void 0&&(N=new Set,x.set(c,N));N.has(h)||(Hp=!0,N.add(h),s=sv.bind(null,s,c,h),c.then(s,s))}function sv(s,c,h){var x=s.pingCache;x!==null&&x.delete(c),s.pingedLanes|=s.suspendedLanes&h,s.warmLanes&=~h,Wn===s&&(bn&h)===h&&(fr===4||fr===3&&(bn&62914560)===bn&&300>lt()-Wp?(Pn&2)===0&&Wc(s,0):Gp|=h,qc===bn&&(qc=0)),os(s)}function Py(s,c){c===0&&(c=_t()),s=js(s,c),s!==null&&(gn(s,c),os(s))}function Yf(s){var c=s.memoizedState,h=0;c!==null&&(h=c.retryLane),Py(s,h)}function ov(s,c){var h=0;switch(s.tag){case 13:var x=s.stateNode,N=s.memoizedState;N!==null&&(h=N.retryLane);break;case 19:x=s.stateNode;break;case 22:x=s.stateNode._retryCache;break;default:throw Error(r(314))}x!==null&&x.delete(c),Py(s,h)}function Dy(s,c){return Ae(s,c)}var pd=null,Lo=null,Wf=!1,md=!1,Qf=!1,Fo=0;function os(s){s!==Lo&&s.next===null&&(Lo===null?pd=Lo=s:Lo=Lo.next=s),md=!0,Wf||(Wf=!0,rm())}function gd(s,c){if(!Qf&&md){Qf=!0;do for(var h=!1,x=pd;x!==null;){if(s!==0){var N=x.pendingLanes;if(N===0)var P=0;else{var q=x.suspendedLanes,ee=x.pingedLanes;P=(1<<31-Qe(42|s)+1)-1,P&=N&~(q&~ee),P=P&201326741?P&201326741|1:P?P|2:0}P!==0&&(h=!0,Ry(x,P))}else P=bn,P=De(x,x===Wn?P:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(P&3)===0||qe(x,P)||(h=!0,Ry(x,P));x=x.next}while(h);Qf=!1}}function lv(){yd()}function yd(){md=Wf=!1;var s=0;Fo!==0&&(mv()&&(s=Fo),Fo=0);for(var c=lt(),h=null,x=pd;x!==null;){var N=x.next,P=xd(x,c);P===0?(x.next=null,h===null?pd=N:h.next=N,N===null&&(Lo=h)):(h=x,(s!==0||(P&3)!==0)&&(md=!0)),x=N}gd(s)}function xd(s,c){for(var h=s.suspendedLanes,x=s.pingedLanes,N=s.expirationTimes,P=s.pendingLanes&-62914561;0<P;){var q=31-Qe(P),ee=1<<q,ve=N[q];ve===-1?((ee&h)===0||(ee&x)!==0)&&(N[q]=st(ee,c)):ve<=c&&(s.expiredLanes|=ee),P&=~ee}if(c=Wn,h=bn,h=De(s,s===c?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x=s.callbackNode,h===0||s===c&&(Dn===2||Dn===9)||s.cancelPendingCommit!==null)return x!==null&&x!==null&&Pe(x),s.callbackNode=null,s.callbackPriority=0;if((h&3)===0||qe(s,h)){if(c=h&-h,c===s.callbackPriority)return c;switch(x!==null&&Pe(x),St(h)){case 2:case 8:h=at;break;case 32:h=be;break;case 268435456:h=Be;break;default:h=be}return x=Iy.bind(null,s),h=Ae(h,x),s.callbackPriority=c,s.callbackNode=h,c}return x!==null&&x!==null&&Pe(x),s.callbackPriority=2,s.callbackNode=null,2}function Iy(s,c){if(zr!==0&&zr!==5)return s.callbackNode=null,s.callbackPriority=0,null;var h=s.callbackNode;if(Gf()&&s.callbackNode!==h)return null;var x=bn;return x=De(s,s===Wn?x:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x===0?null:(yy(s,x,c),xd(s,lt()),s.callbackNode!=null&&s.callbackNode===h?Iy.bind(null,s):null)}function Ry(s,c){if(Gf())return null;yy(s,c,!0)}function rm(){yv(function(){(Pn&6)!==0?Ae(ot,lv):yd()})}function Jf(){return Fo===0&&(Fo=yt()),Fo}function My(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:vs(""+s)}function Oy(s,c){var h=c.ownerDocument.createElement("input");return h.name=c.name,h.value=c.value,s.id&&h.setAttribute("form",s.id),c.parentNode.insertBefore(h,c),s=new FormData(s),h.parentNode.removeChild(h),s}function cv(s,c,h,x,N){if(c==="submit"&&h&&h.stateNode===N){var P=My((N[wr]||null).action),q=x.submitter;q&&(c=(c=q[wr]||null)?My(c.formAction):q.getAttribute("formAction"),c!==null&&(P=c,q=null));var ee=new pl("action","action",null,x,N);s.push({event:ee,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Fo!==0){var ve=q?Oy(N,q):new FormData(N);Wu(h,{pending:!0,data:ve,method:N.method,action:P},null,ve)}}else typeof P=="function"&&(ee.preventDefault(),ve=q?Oy(N,q):new FormData(N),Wu(h,{pending:!0,data:ve,method:N.method,action:P},P,ve))},currentTarget:N}]})}}for(var im=0;im<ne.length;im++){var am=ne[im],uv=am.toLowerCase(),dv=am[0].toUpperCase()+am.slice(1);me(uv,"on"+dv)}me(Cc,"onAnimationEnd"),me(af,"onAnimationIteration"),me(ri,"onAnimationStart"),me("dblclick","onDoubleClick"),me("focusin","onFocus"),me("focusout","onBlur"),me(_c,"onTransitionRun"),me(rp,"onTransitionStart"),me(_s,"onTransitionCancel"),me(bo,"onTransitionEnd"),no("onMouseEnter",["mouseout","mouseover"]),no("onMouseLeave",["mouseout","mouseover"]),no("onPointerEnter",["pointerout","pointerover"]),no("onPointerLeave",["pointerout","pointerover"]),gs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),gs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),gs("onBeforeInput",["compositionend","keypress","textInput","paste"]),gs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),gs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),gs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(bd));function Ly(s,c){c=(c&4)!==0;for(var h=0;h<s.length;h++){var x=s[h],N=x.event;x=x.listeners;e:{var P=void 0;if(c)for(var q=x.length-1;0<=q;q--){var ee=x[q],ve=ee.instance,Le=ee.currentTarget;if(ee=ee.listener,ve!==P&&N.isPropagationStopped())break e;P=ee,N.currentTarget=Le;try{P(N)}catch(Ke){zl(Ke)}N.currentTarget=null,P=ve}else for(q=0;q<x.length;q++){if(ee=x[q],ve=ee.instance,Le=ee.currentTarget,ee=ee.listener,ve!==P&&N.isPropagationStopped())break e;P=ee,N.currentTarget=Le;try{P(N)}catch(Ke){zl(Ke)}N.currentTarget=null,P=ve}}}}function sn(s,c){var h=c[bu];h===void 0&&(h=c[bu]=new Set);var x=s+"__bubble";h.has(x)||(Fy(c,s,2,!1),h.add(x))}function sm(s,c,h){var x=0;c&&(x|=4),Fy(h,s,x,c)}var wi="_reactListening"+Math.random().toString(36).slice(2);function om(s){if(!s[wi]){s[wi]=!0,Yd.forEach(function(h){h!=="selectionchange"&&(fv.has(h)||sm(h,!1,s),sm(h,!0,s))});var c=s.nodeType===9?s:s.ownerDocument;c===null||c[wi]||(c[wi]=!0,sm("selectionchange",!1,c))}}function Fy(s,c,h,x){switch(rx(c)){case 2:var N=Av;break;case 8:N=nu;break;default:N=ym}h=N.bind(null,c,h,s),N=void 0,!lo||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(N=!0),x?N!==void 0?s.addEventListener(c,h,{capture:!0,passive:N}):s.addEventListener(c,h,!0):N!==void 0?s.addEventListener(c,h,{passive:N}):s.addEventListener(c,h,!1)}function Us(s,c,h,x,N){var P=x;if((c&1)===0&&(c&2)===0&&x!==null)e:for(;;){if(x===null)return;var q=x.tag;if(q===3||q===4){var ee=x.stateNode.containerInfo;if(ee===N)break;if(q===4)for(q=x.return;q!==null;){var ve=q.tag;if((ve===3||ve===4)&&q.stateNode.containerInfo===N)return;q=q.return}for(;ee!==null;){if(q=ms(ee),q===null)return;if(ve=q.tag,ve===5||ve===6||ve===26||ve===27){x=P=q;continue e}ee=ee.parentNode}}x=x.return}fc(function(){var Le=P,Ke=cl(h),tt=[];e:{var Ue=vo.get(s);if(Ue!==void 0){var Fe=pl,Rt=s;switch(s){case"keypress":if(xn(h)===0)break e;case"keydown":case"keyup":Fe=vc;break;case"focusin":Rt="focus",Fe=wn;break;case"focusout":Rt="blur",Fe=wn;break;case"beforeblur":case"afterblur":Fe=wn;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Fe=Ga;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Fe=ml;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Fe=Kh;break;case Cc:case af:case ri:Fe=gl;break;case bo:Fe=Xh;break;case"scroll":case"scrollend":Fe=Kd;break;case"wheel":Fe=po;break;case"copy":case"cut":case"paste":Fe=fo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Fe=Ji;break;case"toggle":case"beforetoggle":Fe=Wa}var It=(c&4)!==0,Ln=!It&&(s==="scroll"||s==="scrollend"),Ie=It?Ue!==null?Ue+"Capture":null:Ue;It=[];for(var Te=Le,Oe;Te!==null;){var Xe=Te;if(Oe=Xe.stateNode,Xe=Xe.tag,Xe!==5&&Xe!==26&&Xe!==27||Oe===null||Ie===null||(Xe=Xr(Te,Ie),Xe!=null&&It.push(Bt(Te,Xe,Oe))),Ln)break;Te=Te.return}0<It.length&&(Ue=new Fe(Ue,Rt,null,h,Ke),tt.push({event:Ue,listeners:It}))}}if((c&7)===0){e:{if(Ue=s==="mouseover"||s==="pointerover",Fe=s==="mouseout"||s==="pointerout",Ue&&h!==oo&&(Rt=h.relatedTarget||h.fromElement)&&(ms(Rt)||Rt[Ei]))break e;if((Fe||Ue)&&(Ue=Ke.window===Ke?Ke:(Ue=Ke.ownerDocument)?Ue.defaultView||Ue.parentWindow:window,Fe?(Rt=h.relatedTarget||h.toElement,Fe=Le,Rt=Rt?ms(Rt):null,Rt!==null&&(Ln=o(Rt),It=Rt.tag,Rt!==Ln||It!==5&&It!==27&&It!==6)&&(Rt=null)):(Fe=null,Rt=Le),Fe!==Rt)){if(It=Ga,Xe="onMouseLeave",Ie="onMouseEnter",Te="mouse",(s==="pointerout"||s==="pointerover")&&(It=Ji,Xe="onPointerLeave",Ie="onPointerEnter",Te="pointer"),Ln=Fe==null?Ue:eo(Fe),Oe=Rt==null?Ue:eo(Rt),Ue=new It(Xe,Te+"leave",Fe,h,Ke),Ue.target=Ln,Ue.relatedTarget=Oe,Xe=null,ms(Ke)===Le&&(It=new It(Ie,Te+"enter",Rt,h,Ke),It.target=Oe,It.relatedTarget=Ln,Xe=It),Ln=Xe,Fe&&Rt)t:{for(It=Fe,Ie=Rt,Te=0,Oe=It;Oe;Oe=jr(Oe))Te++;for(Oe=0,Xe=Ie;Xe;Xe=jr(Xe))Oe++;for(;0<Te-Oe;)It=jr(It),Te--;for(;0<Oe-Te;)Ie=jr(Ie),Oe--;for(;Te--;){if(It===Ie||Ie!==null&&It===Ie.alternate)break t;It=jr(It),Ie=jr(Ie)}It=null}else It=null;Fe!==null&&hr(tt,Ue,Fe,It,!1),Rt!==null&&Ln!==null&&hr(tt,Ln,Rt,It,!0)}}e:{if(Ue=Le?eo(Le):window,Fe=Ue.nodeName&&Ue.nodeName.toLowerCase(),Fe==="select"||Fe==="input"&&Ue.type==="file")var xt=Ki;else if(vl(Ue))if(Nu)xt=ep;else{xt=Ka;var tn=_u}else Fe=Ue.nodeName,!Fe||Fe.toLowerCase()!=="input"||Ue.type!=="checkbox"&&Ue.type!=="radio"?Le&&so(Le.elementType)&&(xt=Ki):xt=Sl;if(xt&&(xt=xt(s,Le))){go(tt,xt,h,Ke);break e}tn&&tn(s,Ue,Le),s==="focusout"&&Le&&Ue.type==="number"&&Le.memoizedProps.value!=null&&xs(Ue,"number",Ue.value)}switch(tn=Le?eo(Le):window,s){case"focusin":(vl(tn)||tn.contentEditable==="true")&&(Xa=tn,Za=Le,Ee=null);break;case"focusout":Ee=Za=Xa=null;break;case"mousedown":Ye=!0;break;case"contextmenu":case"mouseup":case"dragend":Ye=!1,Ve(tt,h,Ke);break;case"selectionchange":if(np)break;case"keydown":case"keyup":Ve(tt,h,Ke)}var Nt;if(yl)e:{switch(s){case"compositionstart":var Mt="onCompositionStart";break e;case"compositionend":Mt="onCompositionEnd";break e;case"compositionupdate":Mt="onCompositionUpdate";break e}Mt=void 0}else Qa?tf(s,h)&&(Mt="onCompositionEnd"):s==="keydown"&&h.keyCode===229&&(Mt="onCompositionStart");Mt&&(bl&&h.locale!=="ko"&&(Qa||Mt!=="onCompositionStart"?Mt==="onCompositionEnd"&&Qa&&(Nt=pc()):(Ha=Ke,fl="value"in Ha?Ha.value:Ha.textContent,Qa=!0)),tn=Kf(Le,Mt),0<tn.length&&(Mt=new Vr(Mt,s,null,h,Ke),tt.push({event:Mt,listeners:tn}),Nt?Mt.data=Nt:(Nt=Sc(h),Nt!==null&&(Mt.data=Nt)))),(Nt=xl?Zh(s,h):nf(s,h))&&(Mt=Kf(Le,"onBeforeInput"),0<Mt.length&&(tn=new Vr("onBeforeInput","beforeinput",null,h,Ke),tt.push({event:tn,listeners:Mt}),tn.data=Nt)),cv(tt,s,Le,h,Ke)}Ly(tt,c)})}function Bt(s,c,h){return{instance:s,listener:c,currentTarget:h}}function Kf(s,c){for(var h=c+"Capture",x=[];s!==null;){var N=s,P=N.stateNode;if(N=N.tag,N!==5&&N!==26&&N!==27||P===null||(N=Xr(s,h),N!=null&&x.unshift(Bt(s,N,P)),N=Xr(s,c),N!=null&&x.push(Bt(s,N,P))),s.tag===3)return x;s=s.return}return[]}function jr(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function hr(s,c,h,x,N){for(var P=c._reactName,q=[];h!==null&&h!==x;){var ee=h,ve=ee.alternate,Le=ee.stateNode;if(ee=ee.tag,ve!==null&&ve===x)break;ee!==5&&ee!==26&&ee!==27||Le===null||(ve=Le,N?(Le=Xr(h,P),Le!=null&&q.unshift(Bt(h,Le,ve))):N||(Le=Xr(h,P),Le!=null&&q.push(Bt(h,Le,ve)))),h=h.return}q.length!==0&&s.push({event:c,listeners:q})}var hv=/\r\n?/g,$o=/\u0000|\uFFFD/g;function $y(s){return(typeof s=="string"?s:""+s).replace(hv,`
`).replace($o,"")}function zy(s,c){return c=$y(c),$y(s)===c}function Xf(){}function On(s,c,h,x,N,P){switch(h){case"children":typeof x=="string"?c==="body"||c==="textarea"&&x===""||Pi(s,x):(typeof x=="number"||typeof x=="bigint")&&c!=="body"&&Pi(s,""+x);break;case"className":rl(s,"class",x);break;case"tabIndex":rl(s,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":rl(s,h,x);break;case"style":uc(s,x,P);break;case"data":if(c!=="object"){rl(s,"data",x);break}case"src":case"href":if(x===""&&(c!=="a"||h!=="href")){s.removeAttribute(h);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(h);break}x=vs(""+x),s.setAttribute(h,x);break;case"action":case"formAction":if(typeof x=="function"){s.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof P=="function"&&(h==="formAction"?(c!=="input"&&On(s,c,"name",N.name,N,null),On(s,c,"formEncType",N.formEncType,N,null),On(s,c,"formMethod",N.formMethod,N,null),On(s,c,"formTarget",N.formTarget,N,null)):(On(s,c,"encType",N.encType,N,null),On(s,c,"method",N.method,N,null),On(s,c,"target",N.target,N,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(h);break}x=vs(""+x),s.setAttribute(h,x);break;case"onClick":x!=null&&(s.onclick=Xf);break;case"onScroll":x!=null&&sn("scroll",s);break;case"onScrollEnd":x!=null&&sn("scrollend",s);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(h=x.__html,h!=null){if(N.children!=null)throw Error(r(60));s.innerHTML=h}}break;case"multiple":s.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":s.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){s.removeAttribute("xlink:href");break}h=vs(""+x),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(h,""+x):s.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(h,""):s.removeAttribute(h);break;case"capture":case"download":x===!0?s.setAttribute(h,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(h,x):s.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?s.setAttribute(h,x):s.removeAttribute(h);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?s.removeAttribute(h):s.setAttribute(h,x);break;case"popover":sn("beforetoggle",s),sn("toggle",s),za(s,"popover",x);break;case"xlinkActuate":Ai(s,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":Ai(s,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":Ai(s,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":Ai(s,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":Ai(s,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":Ai(s,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":Ai(s,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":Ai(s,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":Ai(s,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":za(s,"is",x);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=Jd.get(h)||h,za(s,h,x))}}function lm(s,c,h,x,N,P){switch(h){case"style":uc(s,x,P);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(h=x.__html,h!=null){if(N.children!=null)throw Error(r(60));s.innerHTML=h}}break;case"children":typeof x=="string"?Pi(s,x):(typeof x=="number"||typeof x=="bigint")&&Pi(s,""+x);break;case"onScroll":x!=null&&sn("scroll",s);break;case"onScrollEnd":x!=null&&sn("scrollend",s);break;case"onClick":x!=null&&(s.onclick=Xf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Wd.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(N=h.endsWith("Capture"),c=h.slice(2,N?h.length-7:void 0),P=s[wr]||null,P=P!=null?P[h]:null,typeof P=="function"&&s.removeEventListener(c,P,N),typeof x=="function")){typeof P!="function"&&P!==null&&(h in s?s[h]=null:s.hasAttribute(h)&&s.removeAttribute(h)),s.addEventListener(c,x,N);break e}h in s?s[h]=x:x===!0?s.setAttribute(h,""):za(s,h,x)}}}function kr(s,c,h){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":sn("error",s),sn("load",s);var x=!1,N=!1,P;for(P in h)if(h.hasOwnProperty(P)){var q=h[P];if(q!=null)switch(P){case"src":x=!0;break;case"srcSet":N=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:On(s,c,P,q,h,null)}}N&&On(s,c,"srcSet",h.srcSet,h,null),x&&On(s,c,"src",h.src,h,null);return;case"input":sn("invalid",s);var ee=P=q=N=null,ve=null,Le=null;for(x in h)if(h.hasOwnProperty(x)){var Ke=h[x];if(Ke!=null)switch(x){case"name":N=Ke;break;case"type":q=Ke;break;case"checked":ve=Ke;break;case"defaultChecked":Le=Ke;break;case"value":P=Ke;break;case"defaultValue":ee=Ke;break;case"children":case"dangerouslySetInnerHTML":if(Ke!=null)throw Error(r(137,c));break;default:On(s,c,x,Ke,h,null)}}cc(s,P,ee,ve,Le,q,N,!1),sl(s);return;case"select":sn("invalid",s),x=q=P=null;for(N in h)if(h.hasOwnProperty(N)&&(ee=h[N],ee!=null))switch(N){case"value":P=ee;break;case"defaultValue":q=ee;break;case"multiple":x=ee;default:On(s,c,N,ee,h,null)}c=P,h=q,s.multiple=!!x,c!=null?bs(s,!!x,c,!1):h!=null&&bs(s,!!x,h,!0);return;case"textarea":sn("invalid",s),P=N=x=null;for(q in h)if(h.hasOwnProperty(q)&&(ee=h[q],ee!=null))switch(q){case"value":x=ee;break;case"defaultValue":N=ee;break;case"children":P=ee;break;case"dangerouslySetInnerHTML":if(ee!=null)throw Error(r(91));break;default:On(s,c,q,ee,h,null)}ll(s,x,N,P),sl(s);return;case"option":for(ve in h)if(h.hasOwnProperty(ve)&&(x=h[ve],x!=null))switch(ve){case"selected":s.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:On(s,c,ve,x,h,null)}return;case"dialog":sn("beforetoggle",s),sn("toggle",s),sn("cancel",s),sn("close",s);break;case"iframe":case"object":sn("load",s);break;case"video":case"audio":for(x=0;x<bd.length;x++)sn(bd[x],s);break;case"image":sn("error",s),sn("load",s);break;case"details":sn("toggle",s);break;case"embed":case"source":case"link":sn("error",s),sn("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Le in h)if(h.hasOwnProperty(Le)&&(x=h[Le],x!=null))switch(Le){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:On(s,c,Le,x,h,null)}return;default:if(so(c)){for(Ke in h)h.hasOwnProperty(Ke)&&(x=h[Ke],x!==void 0&&lm(s,c,Ke,x,h,void 0));return}}for(ee in h)h.hasOwnProperty(ee)&&(x=h[ee],x!=null&&On(s,c,ee,x,h,null))}function pv(s,c,h,x){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var N=null,P=null,q=null,ee=null,ve=null,Le=null,Ke=null;for(Fe in h){var tt=h[Fe];if(h.hasOwnProperty(Fe)&&tt!=null)switch(Fe){case"checked":break;case"value":break;case"defaultValue":ve=tt;default:x.hasOwnProperty(Fe)||On(s,c,Fe,null,x,tt)}}for(var Ue in x){var Fe=x[Ue];if(tt=h[Ue],x.hasOwnProperty(Ue)&&(Fe!=null||tt!=null))switch(Ue){case"type":P=Fe;break;case"name":N=Fe;break;case"checked":Le=Fe;break;case"defaultChecked":Ke=Fe;break;case"value":q=Fe;break;case"defaultValue":ee=Fe;break;case"children":case"dangerouslySetInnerHTML":if(Fe!=null)throw Error(r(137,c));break;default:Fe!==tt&&On(s,c,Ue,Fe,x,tt)}}io(s,q,ee,ve,Le,Ke,P,N);return;case"select":Fe=q=ee=Ue=null;for(P in h)if(ve=h[P],h.hasOwnProperty(P)&&ve!=null)switch(P){case"value":break;case"multiple":Fe=ve;default:x.hasOwnProperty(P)||On(s,c,P,null,x,ve)}for(N in x)if(P=x[N],ve=h[N],x.hasOwnProperty(N)&&(P!=null||ve!=null))switch(N){case"value":Ue=P;break;case"defaultValue":ee=P;break;case"multiple":q=P;default:P!==ve&&On(s,c,N,P,x,ve)}c=ee,h=q,x=Fe,Ue!=null?bs(s,!!h,Ue,!1):!!x!=!!h&&(c!=null?bs(s,!!h,c,!0):bs(s,!!h,h?[]:"",!1));return;case"textarea":Fe=Ue=null;for(ee in h)if(N=h[ee],h.hasOwnProperty(ee)&&N!=null&&!x.hasOwnProperty(ee))switch(ee){case"value":break;case"children":break;default:On(s,c,ee,null,x,N)}for(q in x)if(N=x[q],P=h[q],x.hasOwnProperty(q)&&(N!=null||P!=null))switch(q){case"value":Ue=N;break;case"defaultValue":Fe=N;break;case"children":break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(r(91));break;default:N!==P&&On(s,c,q,N,x,P)}ol(s,Ue,Fe);return;case"option":for(var Rt in h)if(Ue=h[Rt],h.hasOwnProperty(Rt)&&Ue!=null&&!x.hasOwnProperty(Rt))switch(Rt){case"selected":s.selected=!1;break;default:On(s,c,Rt,null,x,Ue)}for(ve in x)if(Ue=x[ve],Fe=h[ve],x.hasOwnProperty(ve)&&Ue!==Fe&&(Ue!=null||Fe!=null))switch(ve){case"selected":s.selected=Ue&&typeof Ue!="function"&&typeof Ue!="symbol";break;default:On(s,c,ve,Ue,x,Fe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var It in h)Ue=h[It],h.hasOwnProperty(It)&&Ue!=null&&!x.hasOwnProperty(It)&&On(s,c,It,null,x,Ue);for(Le in x)if(Ue=x[Le],Fe=h[Le],x.hasOwnProperty(Le)&&Ue!==Fe&&(Ue!=null||Fe!=null))switch(Le){case"children":case"dangerouslySetInnerHTML":if(Ue!=null)throw Error(r(137,c));break;default:On(s,c,Le,Ue,x,Fe)}return;default:if(so(c)){for(var Ln in h)Ue=h[Ln],h.hasOwnProperty(Ln)&&Ue!==void 0&&!x.hasOwnProperty(Ln)&&lm(s,c,Ln,void 0,x,Ue);for(Ke in x)Ue=x[Ke],Fe=h[Ke],!x.hasOwnProperty(Ke)||Ue===Fe||Ue===void 0&&Fe===void 0||lm(s,c,Ke,Ue,x,Fe);return}}for(var Ie in h)Ue=h[Ie],h.hasOwnProperty(Ie)&&Ue!=null&&!x.hasOwnProperty(Ie)&&On(s,c,Ie,null,x,Ue);for(tt in x)Ue=x[tt],Fe=h[tt],!x.hasOwnProperty(tt)||Ue===Fe||Ue==null&&Fe==null||On(s,c,tt,Ue,x,Fe)}var Ta=null,Zf=null;function Vl(s){return s.nodeType===9?s:s.ownerDocument}function ir(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function lr(s,c){if(s===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&c==="foreignObject"?0:s}function eh(s,c){return s==="textarea"||s==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var cm=null;function mv(){var s=window.event;return s&&s.type==="popstate"?s===cm?!1:(cm=s,!0):(cm=null,!1)}var Uy=typeof setTimeout=="function"?setTimeout:void 0,gv=typeof clearTimeout=="function"?clearTimeout:void 0,By=typeof Promise=="function"?Promise:void 0,yv=typeof queueMicrotask=="function"?queueMicrotask:typeof By<"u"?function(s){return By.resolve(null).then(s).catch(qy)}:Uy;function qy(s){setTimeout(function(){throw s})}function oa(s){return s==="head"}function th(s,c){var h=c,x=0,N=0;do{var P=h.nextSibling;if(s.removeChild(h),P&&P.nodeType===8)if(h=P.data,h==="/$"){if(0<x&&8>x){h=x;var q=s.ownerDocument;if(h&1&&vd(q.documentElement),h&2&&vd(q.body),h&4)for(h=q.head,vd(h),q=h.firstChild;q;){var ee=q.nextSibling,ve=q.nodeName;q[Xs]||ve==="SCRIPT"||ve==="STYLE"||ve==="LINK"&&q.rel.toLowerCase()==="stylesheet"||h.removeChild(q),q=ee}}if(N===0){s.removeChild(P),Td(c);return}N--}else h==="$"||h==="$?"||h==="$!"?N++:x=h.charCodeAt(0)-48;else x=0;h=P}while(h);Td(c)}function um(s){var c=s.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var h=c;switch(c=c.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":um(h),tc(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}s.removeChild(h)}}function Vy(s,c,h,x){for(;s.nodeType===1;){var N=h;if(s.nodeName.toLowerCase()!==c.toLowerCase()){if(!x&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(x){if(!s[Xs])switch(c){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(P=s.getAttribute("rel"),P==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(P!==N.rel||s.getAttribute("href")!==(N.href==null||N.href===""?null:N.href)||s.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin)||s.getAttribute("title")!==(N.title==null?null:N.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(P=s.getAttribute("src"),(P!==(N.src==null?null:N.src)||s.getAttribute("type")!==(N.type==null?null:N.type)||s.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin))&&P&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(c==="input"&&s.type==="hidden"){var P=N.name==null?null:""+N.name;if(N.type==="hidden"&&s.getAttribute("name")===P)return s}else return s;if(s=Ea(s.nextSibling),s===null)break}return null}function nh(s,c,h){if(c==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!h||(s=Ea(s.nextSibling),s===null))return null;return s}function li(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function Jc(s,c){var h=s.ownerDocument;if(s.data!=="$?"||h.readyState==="complete")c();else{var x=function(){c(),h.removeEventListener("DOMContentLoaded",x)};h.addEventListener("DOMContentLoaded",x),s._reactRetry=x}}function Ea(s){for(;s!=null;s=s.nextSibling){var c=s.nodeType;if(c===1||c===3)break;if(c===8){if(c=s.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return s}var dm=null;function Hy(s){s=s.previousSibling;for(var c=0;s;){if(s.nodeType===8){var h=s.data;if(h==="$"||h==="$!"||h==="$?"){if(c===0)return s;c--}else h==="/$"&&c++}s=s.previousSibling}return null}function Gy(s,c,h){switch(c=Vl(h),s){case"html":if(s=c.documentElement,!s)throw Error(r(452));return s;case"head":if(s=c.head,!s)throw Error(r(453));return s;case"body":if(s=c.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function vd(s){for(var c=s.attributes;c.length;)s.removeAttributeNode(c[0]);tc(s)}var Ui=new Map,ls=new Set;function Gt(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var cs=ae.d;ae.d={f:la,r:Yy,D:xv,C:Wy,L:rh,m:bv,X:wv,S:vv,M:Sv};function la(){var s=cs.f(),c=Vf();return s||c}function Yy(s){var c=Zs(s);c!==null&&c.tag===5&&c.type==="form"?kf(c):cs.r(s)}var Kc=typeof document>"u"?null:document;function Tn(s,c,h){var x=Kc;if(x&&typeof c=="string"&&c){var N=Kr(c);N='link[rel="'+s+'"][href="'+N+'"]',typeof h=="string"&&(N+='[crossorigin="'+h+'"]'),ls.has(N)||(ls.add(N),s={rel:s,crossOrigin:h,href:c},x.querySelector(N)===null&&(c=x.createElement("link"),kr(c,"link",s),gr(c),x.head.appendChild(c)))}}function xv(s){cs.D(s),Tn("dns-prefetch",s,null)}function Wy(s,c){cs.C(s,c),Tn("preconnect",s,c)}function rh(s,c,h){cs.L(s,c,h);var x=Kc;if(x&&s&&c){var N='link[rel="preload"][as="'+Kr(c)+'"]';c==="image"&&h&&h.imageSrcSet?(N+='[imagesrcset="'+Kr(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(N+='[imagesizes="'+Kr(h.imageSizes)+'"]')):N+='[href="'+Kr(s)+'"]';var P=N;switch(c){case"style":P=Xc(s);break;case"script":P=Zc(s)}Ui.has(P)||(s=p({rel:"preload",href:c==="image"&&h&&h.imageSrcSet?void 0:s,as:c},h),Ui.set(P,s),x.querySelector(N)!==null||c==="style"&&x.querySelector(wd(P))||c==="script"&&x.querySelector(Sd(P))||(c=x.createElement("link"),kr(c,"link",s),gr(c),x.head.appendChild(c)))}}function bv(s,c){cs.m(s,c);var h=Kc;if(h&&s){var x=c&&typeof c.as=="string"?c.as:"script",N='link[rel="modulepreload"][as="'+Kr(x)+'"][href="'+Kr(s)+'"]',P=N;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":P=Zc(s)}if(!Ui.has(P)&&(s=p({rel:"modulepreload",href:s},c),Ui.set(P,s),h.querySelector(N)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Sd(P)))return}x=h.createElement("link"),kr(x,"link",s),gr(x),h.head.appendChild(x)}}}function vv(s,c,h){cs.S(s,c,h);var x=Kc;if(x&&s){var N=to(x).hoistableStyles,P=Xc(s);c=c||"default";var q=N.get(P);if(!q){var ee={loading:0,preload:null};if(q=x.querySelector(wd(P)))ee.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":c},h),(h=Ui.get(P))&&Nd(s,h);var ve=q=x.createElement("link");gr(ve),kr(ve,"link",s),ve._p=new Promise(function(Le,Ke){ve.onload=Le,ve.onerror=Ke}),ve.addEventListener("load",function(){ee.loading|=1}),ve.addEventListener("error",function(){ee.loading|=2}),ee.loading|=4,ih(q,c,x)}q={type:"stylesheet",instance:q,count:1,state:ee},N.set(P,q)}}}function wv(s,c){cs.X(s,c);var h=Kc;if(h&&s){var x=to(h).hoistableScripts,N=Zc(s),P=x.get(N);P||(P=h.querySelector(Sd(N)),P||(s=p({src:s,async:!0},c),(c=Ui.get(N))&&fm(s,c),P=h.createElement("script"),gr(P),kr(P,"link",s),h.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},x.set(N,P))}}function Sv(s,c){cs.M(s,c);var h=Kc;if(h&&s){var x=to(h).hoistableScripts,N=Zc(s),P=x.get(N);P||(P=h.querySelector(Sd(N)),P||(s=p({src:s,async:!0,type:"module"},c),(c=Ui.get(N))&&fm(s,c),P=h.createElement("script"),gr(P),kr(P,"link",s),h.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},x.set(N,P))}}function Qy(s,c,h,x){var N=(N=W.current)?Gt(N):null;if(!N)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(c=Xc(h.href),h=to(N).hoistableStyles,x=h.get(c),x||(x={type:"style",instance:null,count:0,state:null},h.set(c,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){s=Xc(h.href);var P=to(N).hoistableStyles,q=P.get(s);if(q||(N=N.ownerDocument||N,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},P.set(s,q),(P=N.querySelector(wd(s)))&&!P._p&&(q.instance=P,q.state.loading=5),Ui.has(s)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Ui.set(s,h),P||Nv(N,s,h,q.state))),c&&x===null)throw Error(r(528,""));return q}if(c&&x!==null)throw Error(r(529,""));return null;case"script":return c=h.async,h=h.src,typeof h=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Zc(h),h=to(N).hoistableScripts,x=h.get(c),x||(x={type:"script",instance:null,count:0,state:null},h.set(c,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Xc(s){return'href="'+Kr(s)+'"'}function wd(s){return'link[rel="stylesheet"]['+s+"]"}function Jy(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function Nv(s,c,h,x){s.querySelector('link[rel="preload"][as="style"]['+c+"]")?x.loading=1:(c=s.createElement("link"),x.preload=c,c.addEventListener("load",function(){return x.loading|=1}),c.addEventListener("error",function(){return x.loading|=2}),kr(c,"link",h),gr(c),s.head.appendChild(c))}function Zc(s){return'[src="'+Kr(s)+'"]'}function Sd(s){return"script[async]"+s}function Ky(s,c,h){if(c.count++,c.instance===null)switch(c.type){case"style":var x=s.querySelector('style[data-href~="'+Kr(h.href)+'"]');if(x)return c.instance=x,gr(x),x;var N=p({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return x=(s.ownerDocument||s).createElement("style"),gr(x),kr(x,"style",N),ih(x,h.precedence,s),c.instance=x;case"stylesheet":N=Xc(h.href);var P=s.querySelector(wd(N));if(P)return c.state.loading|=4,c.instance=P,gr(P),P;x=Jy(h),(N=Ui.get(N))&&Nd(x,N),P=(s.ownerDocument||s).createElement("link"),gr(P);var q=P;return q._p=new Promise(function(ee,ve){q.onload=ee,q.onerror=ve}),kr(P,"link",x),c.state.loading|=4,ih(P,h.precedence,s),c.instance=P;case"script":return P=Zc(h.src),(N=s.querySelector(Sd(P)))?(c.instance=N,gr(N),N):(x=h,(N=Ui.get(P))&&(x=p({},h),fm(x,N)),s=s.ownerDocument||s,N=s.createElement("script"),gr(N),kr(N,"link",x),s.head.appendChild(N),c.instance=N);case"void":return null;default:throw Error(r(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(x=c.instance,c.state.loading|=4,ih(x,h.precedence,s));return c.instance}function ih(s,c,h){for(var x=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),N=x.length?x[x.length-1]:null,P=N,q=0;q<x.length;q++){var ee=x[q];if(ee.dataset.precedence===c)P=ee;else if(P!==N)break}P?P.parentNode.insertBefore(s,P.nextSibling):(c=h.nodeType===9?h.head:h,c.insertBefore(s,c.firstChild))}function Nd(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.title==null&&(s.title=c.title)}function fm(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.integrity==null&&(s.integrity=c.integrity)}var eu=null;function Xy(s,c,h){if(eu===null){var x=new Map,N=eu=new Map;N.set(h,x)}else N=eu,x=N.get(h),x||(x=new Map,N.set(h,x));if(x.has(s))return x;for(x.set(s,null),h=h.getElementsByTagName(s),N=0;N<h.length;N++){var P=h[N];if(!(P[Xs]||P[yn]||s==="link"&&P.getAttribute("rel")==="stylesheet")&&P.namespaceURI!=="http://www.w3.org/2000/svg"){var q=P.getAttribute(c)||"";q=s+q;var ee=x.get(q);ee?ee.push(P):x.set(q,[P])}}return x}function Zy(s,c,h){s=s.ownerDocument||s,s.head.insertBefore(h,c==="title"?s.querySelector("head > title"):null)}function Cv(s,c,h){if(h===1||c.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return s=c.disabled,typeof c.precedence=="string"&&s==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function Tr(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var Rr=null;function _v(){}function jv(s,c,h){if(Rr===null)throw Error(r(475));var x=Rr;if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var N=Xc(h.href),P=s.querySelector(wd(N));if(P){s=P._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(x.count++,x=Cd.bind(x),s.then(x,x)),c.state.loading|=4,c.instance=P,gr(P);return}P=s.ownerDocument||s,h=Jy(h),(N=Ui.get(N))&&Nd(h,N),P=P.createElement("link"),gr(P);var q=P;q._p=new Promise(function(ee,ve){q.onload=ee,q.onerror=ve}),kr(P,"link",h),c.instance=P}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(x.count++,c=Cd.bind(x),s.addEventListener("load",c),s.addEventListener("error",c))}}function kv(){if(Rr===null)throw Error(r(475));var s=Rr;return s.stylesheets&&s.count===0&&hm(s,s.stylesheets),0<s.count?function(c){var h=setTimeout(function(){if(s.stylesheets&&hm(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(h)}}:null}function Cd(){if(this.count--,this.count===0){if(this.stylesheets)hm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var ah=null;function hm(s,c){s.stylesheets=null,s.unsuspend!==null&&(s.count++,ah=new Map,c.forEach(Tv,s),ah=null,Cd.call(s))}function Tv(s,c){if(!(c.state.loading&4)){var h=ah.get(s);if(h)var x=h.get(null);else{h=new Map,ah.set(s,h);for(var N=s.querySelectorAll("link[data-precedence],style[data-precedence]"),P=0;P<N.length;P++){var q=N[P];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(h.set(q.dataset.precedence,q),x=q)}x&&h.set(null,x)}N=c.instance,q=N.getAttribute("data-precedence"),P=h.get(q)||x,P===x&&h.set(null,N),h.set(q,N),this.count++,x=Cd.bind(this),N.addEventListener("load",x),N.addEventListener("error",x),P?P.parentNode.insertBefore(N,P.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(N,s.firstChild)),c.state.loading|=4}}var tu={$$typeof:R,Provider:null,Consumer:null,_currentValue:re,_currentValue2:re,_threadCount:0};function Ev(s,c,h,x,N,P,q,ee){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=cn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cn(0),this.hiddenUpdates=cn(null),this.identifierPrefix=x,this.onUncaughtError=N,this.onCaughtError=P,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ee,this.incompleteTransitions=new Map}function ex(s,c,h,x,N,P,q,ee,ve,Le,Ke,tt){return s=new Ev(s,c,h,q,ee,ve,Le,tt),c=1,P===!0&&(c|=24),P=di(3,null,null,c),s.current=P,P.stateNode=s,c=op(),c.refCount++,s.pooledCache=c,c.refCount++,P.memoizedState={element:x,isDehydrated:h,cache:c},Pl(P),s}function tx(s){return s?(s=Cl,s):Cl}function pm(s,c,h,x,N,P){N=tx(N),x.context===null?x.context=N:x.pendingContext=N,x=Co(c),x.payload={element:h},P=P===void 0?null:P,P!==null&&(x.callback=P),h=As(s,x,c),h!==null&&(zi(h,s,c),Lu(h,s,c))}function mm(s,c){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var h=s.retryLane;s.retryLane=h!==0&&h<c?h:c}}function gm(s,c){mm(s,c),(s=s.alternate)&&mm(s,c)}function nx(s){if(s.tag===13){var c=js(s,67108864);c!==null&&zi(c,s,67108864),gm(s,67108864)}}var sh=!0;function Av(s,c,h,x){var N=V.T;V.T=null;var P=ae.p;try{ae.p=2,ym(s,c,h,x)}finally{ae.p=P,V.T=N}}function nu(s,c,h,x){var N=V.T;V.T=null;var P=ae.p;try{ae.p=8,ym(s,c,h,x)}finally{ae.p=P,V.T=N}}function ym(s,c,h,x){if(sh){var N=xm(x);if(N===null)Us(s,c,x,oh,h),ix(s,x);else if(Dv(N,s,c,h,x))x.stopPropagation();else if(ix(s,x),c&4&&-1<Pv.indexOf(s)){for(;N!==null;){var P=Zs(N);if(P!==null)switch(P.tag){case 3:if(P=P.stateNode,P.current.memoizedState.isDehydrated){var q=Me(P.pendingLanes);if(q!==0){var ee=P;for(ee.pendingLanes|=2,ee.entangledLanes|=2;q;){var ve=1<<31-Qe(q);ee.entanglements[1]|=ve,q&=~ve}os(P),(Pn&6)===0&&(Vc=lt()+500,gd(0))}}break;case 13:ee=js(P,2),ee!==null&&zi(ee,P,2),Vf(),gm(P,2)}if(P=xm(x),P===null&&Us(s,c,x,oh,h),P===N)break;N=P}N!==null&&x.stopPropagation()}else Us(s,c,x,null,h)}}function xm(s){return s=cl(s),bm(s)}var oh=null;function bm(s){if(oh=null,s=ms(s),s!==null){var c=o(s);if(c===null)s=null;else{var h=c.tag;if(h===13){if(s=l(c),s!==null)return s;s=null}else if(h===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;s=null}else c!==s&&(s=null)}}return oh=s,null}function rx(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ze()){case ot:return 2;case at:return 8;case be:case $e:return 32;case Be:return 268435456;default:return 32}default:return 32}}var lh=!1,Bs=null,zo=null,Uo=null,_d=new Map,jd=new Map,Bo=[],Pv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ix(s,c){switch(s){case"focusin":case"focusout":Bs=null;break;case"dragenter":case"dragleave":zo=null;break;case"mouseover":case"mouseout":Uo=null;break;case"pointerover":case"pointerout":_d.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":jd.delete(c.pointerId)}}function kd(s,c,h,x,N,P){return s===null||s.nativeEvent!==P?(s={blockedOn:c,domEventName:h,eventSystemFlags:x,nativeEvent:P,targetContainers:[N]},c!==null&&(c=Zs(c),c!==null&&nx(c)),s):(s.eventSystemFlags|=x,c=s.targetContainers,N!==null&&c.indexOf(N)===-1&&c.push(N),s)}function Dv(s,c,h,x,N){switch(c){case"focusin":return Bs=kd(Bs,s,c,h,x,N),!0;case"dragenter":return zo=kd(zo,s,c,h,x,N),!0;case"mouseover":return Uo=kd(Uo,s,c,h,x,N),!0;case"pointerover":var P=N.pointerId;return _d.set(P,kd(_d.get(P)||null,s,c,h,x,N)),!0;case"gotpointercapture":return P=N.pointerId,jd.set(P,kd(jd.get(P)||null,s,c,h,x,N)),!0}return!1}function ax(s){var c=ms(s.target);if(c!==null){var h=o(c);if(h!==null){if(c=h.tag,c===13){if(c=l(h),c!==null){s.blockedOn=c,Yi(s.priority,function(){if(h.tag===13){var x=Qr();x=Ft(x);var N=js(h,x);N!==null&&zi(N,h,x),gm(h,x)}});return}}else if(c===3&&h.stateNode.current.memoizedState.isDehydrated){s.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ch(s){if(s.blockedOn!==null)return!1;for(var c=s.targetContainers;0<c.length;){var h=xm(s.nativeEvent);if(h===null){h=s.nativeEvent;var x=new h.constructor(h.type,h);oo=x,h.target.dispatchEvent(x),oo=null}else return c=Zs(h),c!==null&&nx(c),s.blockedOn=h,!1;c.shift()}return!0}function sx(s,c,h){ch(s)&&h.delete(c)}function Iv(){lh=!1,Bs!==null&&ch(Bs)&&(Bs=null),zo!==null&&ch(zo)&&(zo=null),Uo!==null&&ch(Uo)&&(Uo=null),_d.forEach(sx),jd.forEach(sx)}function uh(s,c){s.blockedOn===c&&(s.blockedOn=null,lh||(lh=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Iv)))}var dh=null;function ox(s){dh!==s&&(dh=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){dh===s&&(dh=null);for(var c=0;c<s.length;c+=3){var h=s[c],x=s[c+1],N=s[c+2];if(typeof x!="function"){if(bm(x||h)===null)continue;break}var P=Zs(h);P!==null&&(s.splice(c,3),c-=3,Wu(P,{pending:!0,data:N,method:h.method,action:x},x,N))}}))}function Td(s){function c(ve){return uh(ve,s)}Bs!==null&&uh(Bs,s),zo!==null&&uh(zo,s),Uo!==null&&uh(Uo,s),_d.forEach(c),jd.forEach(c);for(var h=0;h<Bo.length;h++){var x=Bo[h];x.blockedOn===s&&(x.blockedOn=null)}for(;0<Bo.length&&(h=Bo[0],h.blockedOn===null);)ax(h),h.blockedOn===null&&Bo.shift();if(h=(s.ownerDocument||s).$$reactFormReplay,h!=null)for(x=0;x<h.length;x+=3){var N=h[x],P=h[x+1],q=N[wr]||null;if(typeof P=="function")q||ox(h);else if(q){var ee=null;if(P&&P.hasAttribute("formAction")){if(N=P,q=P[wr]||null)ee=q.formAction;else if(bm(N)!==null)continue}else ee=q.action;typeof ee=="function"?h[x+1]=ee:(h.splice(x,3),x-=3),ox(h)}}}function vm(s){this._internalRoot=s}fh.prototype.render=vm.prototype.render=function(s){var c=this._internalRoot;if(c===null)throw Error(r(409));var h=c.current,x=Qr();pm(h,x,s,c,null,null)},fh.prototype.unmount=vm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var c=s.containerInfo;pm(s.current,2,null,s,null,null),Vf(),c[Ei]=null}};function fh(s){this._internalRoot=s}fh.prototype.unstable_scheduleHydration=function(s){if(s){var c=Jn();s={blockedOn:null,target:s,priority:c};for(var h=0;h<Bo.length&&c!==0&&c<Bo[h].priority;h++);Bo.splice(h,0,s),h===0&&ax(s)}};var lx=n.version;if(lx!=="19.1.0")throw Error(r(527,lx,"19.1.0"));ae.findDOMNode=function(s){var c=s._reactInternals;if(c===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=f(c),s=s!==null?u(s):null,s=s===null?null:s.stateNode,s};var Rv={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hh.isDisabled&&hh.supportsFiber)try{K=hh.inject(Rv),ge=hh}catch{}}return Sm.createRoot=function(s,c){if(!a(s))throw Error(r(299));var h=!1,x="",N=Ip,P=Af,q=Yg,ee=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(N=c.onUncaughtError),c.onCaughtError!==void 0&&(P=c.onCaughtError),c.onRecoverableError!==void 0&&(q=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(ee=c.unstable_transitionCallbacks)),c=ex(s,1,!1,null,null,h,x,N,P,q,ee,null),s[Ei]=c.current,om(s),new vm(c)},Sm.hydrateRoot=function(s,c,h){if(!a(s))throw Error(r(299));var x=!1,N="",P=Ip,q=Af,ee=Yg,ve=null,Le=null;return h!=null&&(h.unstable_strictMode===!0&&(x=!0),h.identifierPrefix!==void 0&&(N=h.identifierPrefix),h.onUncaughtError!==void 0&&(P=h.onUncaughtError),h.onCaughtError!==void 0&&(q=h.onCaughtError),h.onRecoverableError!==void 0&&(ee=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(ve=h.unstable_transitionCallbacks),h.formState!==void 0&&(Le=h.formState)),c=ex(s,1,!0,c,h??null,x,N,P,q,ee,ve,Le),c.context=tx(null),h=c.current,x=Qr(),x=Ft(x),N=Co(x),N.callback=null,As(h,N,x),h=x,c.current.lanes=h,gn(c,h),os(c),s[Ei]=c.current,om(s),new fh(c)},Sm.version="19.1.0",Sm}var CS;function yP(){if(CS)return zv.exports;CS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),zv.exports=gP(),zv.exports}var xP=yP();const bP=({message:e="Newtons Ai HMS"})=>i.jsx("div",{className:"loading-container",children:i.jsxs("div",{className:"loading-content",children:[i.jsxs("div",{className:"spinner-ring",children:[i.jsx("div",{}),i.jsx("div",{}),i.jsx("div",{}),i.jsx("div",{})]}),i.jsx("div",{className:"loading-title",children:e}),i.jsx("div",{className:"loading-subtitle",children:"Loading your workspace..."})]})});function vP(e={}){const{nonce:n,locale:t,onScriptLoadSuccess:r,onScriptLoadError:a}=e,[o,l]=w.useState(!1),d=w.useRef(r);d.current=r;const f=w.useRef(a);return f.current=a,w.useEffect(()=>{const u=document.createElement("script");return u.src="https://accounts.google.com/gsi/client",t&&(u.src+=`?hl=${t}`),u.async=!0,u.defer=!0,u.nonce=n,u.onload=()=>{var p;l(!0),(p=d.current)===null||p===void 0||p.call(d)},u.onerror=()=>{var p;l(!1),(p=f.current)===null||p===void 0||p.call(f)},document.body.appendChild(u),()=>{document.body.removeChild(u)}},[n]),o}const Uj=w.createContext(null);function wP({clientId:e,nonce:n,locale:t,onScriptLoadSuccess:r,onScriptLoadError:a,children:o}){const l=vP({nonce:n,onScriptLoadSuccess:r,onScriptLoadError:a,locale:t}),d=w.useMemo(()=>({locale:t,clientId:e,scriptLoadedSuccessfully:l}),[e,l]);return _n.createElement(Uj.Provider,{value:d},o)}function SP(){const e=w.useContext(Uj);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function NP(e){var n;return(n=e==null?void 0:e.clientId)!==null&&n!==void 0?n:e==null?void 0:e.client_id}const CP={large:40,medium:32,small:20};function _P({onSuccess:e,onError:n,useOneTap:t,promptMomentNotification:r,type:a="standard",theme:o="outline",size:l="large",text:d,shape:f,logo_alignment:u,width:p,click_listener:g,state:b,containerProps:v,...S}){const k=w.useRef(null),{clientId:T,locale:A,scriptLoadedSuccessfully:M}=SP(),R=w.useRef(e);R.current=e;const z=w.useRef(n);z.current=n;const F=w.useRef(r);return F.current=r,w.useEffect(()=>{var L,U,B,J,D,$,H,te,Q;if(M)return(B=(U=(L=window==null?void 0:window.google)===null||L===void 0?void 0:L.accounts)===null||U===void 0?void 0:U.id)===null||B===void 0||B.initialize({client_id:T,callback:Y=>{var V;if(!(Y!=null&&Y.credential))return(V=z.current)===null||V===void 0?void 0:V.call(z);const{credential:ae,select_by:re}=Y;R.current({credential:ae,clientId:NP(Y),select_by:re})},...S}),($=(D=(J=window==null?void 0:window.google)===null||J===void 0?void 0:J.accounts)===null||D===void 0?void 0:D.id)===null||$===void 0||$.renderButton(k.current,{type:a,theme:o,size:l,text:d,shape:f,logo_alignment:u,width:p,locale:A,click_listener:g,state:b}),t&&((Q=(te=(H=window==null?void 0:window.google)===null||H===void 0?void 0:H.accounts)===null||te===void 0?void 0:te.id)===null||Q===void 0||Q.prompt(F.current)),()=>{var Y,V,ae;t&&((ae=(V=(Y=window==null?void 0:window.google)===null||Y===void 0?void 0:Y.accounts)===null||V===void 0?void 0:V.id)===null||ae===void 0||ae.cancel())}},[T,M,t,a,o,l,d,f,u,p,A]),_n.createElement("div",{...v,ref:k,style:{height:CP[l],...v==null?void 0:v.style}})}var Nm={},_S;function jP(){if(_S)return Nm;_S=1,Object.defineProperty(Nm,"__esModule",{value:!0}),Nm.parse=l,Nm.serialize=u;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,n=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const b=function(){};return b.prototype=Object.create(null),b})();function l(b,v){const S=new o,k=b.length;if(k<2)return S;const T=(v==null?void 0:v.decode)||p;let A=0;do{const M=b.indexOf("=",A);if(M===-1)break;const R=b.indexOf(";",A),z=R===-1?k:R;if(M>z){A=b.lastIndexOf(";",M-1)+1;continue}const F=d(b,A,M),L=f(b,M,F),U=b.slice(F,L);if(S[U]===void 0){let B=d(b,M+1,z),J=f(b,z,B);const D=T(b.slice(B,J));S[U]=D}A=z+1}while(A<k);return S}function d(b,v,S){do{const k=b.charCodeAt(v);if(k!==32&&k!==9)return v}while(++v<S);return S}function f(b,v,S){for(;v>S;){const k=b.charCodeAt(--v);if(k!==32&&k!==9)return v+1}return S}function u(b,v,S){const k=(S==null?void 0:S.encode)||encodeURIComponent;if(!e.test(b))throw new TypeError(`argument name is invalid: ${b}`);const T=k(v);if(!n.test(T))throw new TypeError(`argument val is invalid: ${v}`);let A=b+"="+T;if(!S)return A;if(S.maxAge!==void 0){if(!Number.isInteger(S.maxAge))throw new TypeError(`option maxAge is invalid: ${S.maxAge}`);A+="; Max-Age="+S.maxAge}if(S.domain){if(!t.test(S.domain))throw new TypeError(`option domain is invalid: ${S.domain}`);A+="; Domain="+S.domain}if(S.path){if(!r.test(S.path))throw new TypeError(`option path is invalid: ${S.path}`);A+="; Path="+S.path}if(S.expires){if(!g(S.expires)||!Number.isFinite(S.expires.valueOf()))throw new TypeError(`option expires is invalid: ${S.expires}`);A+="; Expires="+S.expires.toUTCString()}if(S.httpOnly&&(A+="; HttpOnly"),S.secure&&(A+="; Secure"),S.partitioned&&(A+="; Partitioned"),S.priority)switch(typeof S.priority=="string"?S.priority.toLowerCase():void 0){case"low":A+="; Priority=Low";break;case"medium":A+="; Priority=Medium";break;case"high":A+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${S.priority}`)}if(S.sameSite)switch(typeof S.sameSite=="string"?S.sameSite.toLowerCase():S.sameSite){case!0:case"strict":A+="; SameSite=Strict";break;case"lax":A+="; SameSite=Lax";break;case"none":A+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${S.sameSite}`)}return A}function p(b){if(b.indexOf("%")===-1)return b;try{return decodeURIComponent(b)}catch{return b}}function g(b){return a.call(b)==="[object Date]"}return Nm}jP();var jS="popstate";function kP(e={}){function n(r,a){let{pathname:o,search:l,hash:d}=r.location;return X0("",{pathname:o,search:l,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(r,a){return typeof a=="string"?a:Ym(a)}return EP(n,t,null,e)}function pr(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function Gs(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function TP(){return Math.random().toString(36).substring(2,10)}function kS(e,n){return{usr:e.state,key:e.key,idx:n}}function X0(e,n,t=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof n=="string"?Fh(n):n,state:t,key:n&&n.key||r||TP()}}function Ym({pathname:e="/",search:n="",hash:t=""}){return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function Fh(e){let n={};if(e){let t=e.indexOf("#");t>=0&&(n.hash=e.substring(t),e=e.substring(0,t));let r=e.indexOf("?");r>=0&&(n.search=e.substring(r),e=e.substring(0,r)),e&&(n.pathname=e)}return n}function EP(e,n,t,r={}){let{window:a=document.defaultView,v5Compat:o=!1}=r,l=a.history,d="POP",f=null,u=p();u==null&&(u=0,l.replaceState({...l.state,idx:u},""));function p(){return(l.state||{idx:null}).idx}function g(){d="POP";let T=p(),A=T==null?null:T-u;u=T,f&&f({action:d,location:k.location,delta:A})}function b(T,A){d="PUSH";let M=X0(k.location,T,A);u=p()+1;let R=kS(M,u),z=k.createHref(M);try{l.pushState(R,"",z)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;a.location.assign(z)}o&&f&&f({action:d,location:k.location,delta:1})}function v(T,A){d="REPLACE";let M=X0(k.location,T,A);u=p();let R=kS(M,u),z=k.createHref(M);l.replaceState(R,"",z),o&&f&&f({action:d,location:k.location,delta:0})}function S(T){return AP(T)}let k={get action(){return d},get location(){return e(a,l)},listen(T){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(jS,g),f=T,()=>{a.removeEventListener(jS,g),f=null}},createHref(T){return n(a,T)},createURL:S,encodeLocation(T){let A=S(T);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:b,replace:v,go(T){return l.go(T)}};return k}function AP(e,n=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),pr(t,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:Ym(e);return r=r.replace(/ $/,"%20"),!n&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function Bj(e,n,t="/"){return PP(e,n,t,!1)}function PP(e,n,t,r){let a=typeof n=="string"?Fh(n):n,o=Ql(a.pathname||"/",t);if(o==null)return null;let l=qj(e);DP(l);let d=null;for(let f=0;d==null&&f<l.length;++f){let u=qP(o);d=UP(l[f],u,r)}return d}function qj(e,n=[],t=[],r=""){let a=(o,l,d)=>{let f={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};f.relativePath.startsWith("/")&&(pr(f.relativePath.startsWith(r),`Absolute route path "${f.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(r.length));let u=Yl([r,f.relativePath]),p=t.concat(f);o.children&&o.children.length>0&&(pr(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),qj(o.children,n,p,u)),!(o.path==null&&!o.index)&&n.push({path:u,score:$P(u,o.index),routesMeta:p})};return e.forEach((o,l)=>{var d;if(o.path===""||!((d=o.path)!=null&&d.includes("?")))a(o,l);else for(let f of Vj(o.path))a(o,l,f)}),n}function Vj(e){let n=e.split("/");if(n.length===0)return[];let[t,...r]=n,a=t.endsWith("?"),o=t.replace(/\?$/,"");if(r.length===0)return a?[o,""]:[o];let l=Vj(r.join("/")),d=[];return d.push(...l.map(f=>f===""?o:[o,f].join("/"))),a&&d.push(...l),d.map(f=>e.startsWith("/")&&f===""?"/":f)}function DP(e){e.sort((n,t)=>n.score!==t.score?t.score-n.score:zP(n.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var IP=/^:[\w-]+$/,RP=3,MP=2,OP=1,LP=10,FP=-2,TS=e=>e==="*";function $P(e,n){let t=e.split("/"),r=t.length;return t.some(TS)&&(r+=FP),n&&(r+=MP),t.filter(a=>!TS(a)).reduce((a,o)=>a+(IP.test(o)?RP:o===""?OP:LP),r)}function zP(e,n){return e.length===n.length&&e.slice(0,-1).every((r,a)=>r===n[a])?e[e.length-1]-n[n.length-1]:0}function UP(e,n,t=!1){let{routesMeta:r}=e,a={},o="/",l=[];for(let d=0;d<r.length;++d){let f=r[d],u=d===r.length-1,p=o==="/"?n:n.slice(o.length)||"/",g=Yx({path:f.relativePath,caseSensitive:f.caseSensitive,end:u},p),b=f.route;if(!g&&u&&t&&!r[r.length-1].route.index&&(g=Yx({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},p)),!g)return null;Object.assign(a,g.params),l.push({params:a,pathname:Yl([o,g.pathname]),pathnameBase:YP(Yl([o,g.pathnameBase])),route:b}),g.pathnameBase!=="/"&&(o=Yl([o,g.pathnameBase]))}return l}function Yx(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,r]=BP(e.path,e.caseSensitive,e.end),a=n.match(t);if(!a)return null;let o=a[0],l=o.replace(/(.)\/+$/,"$1"),d=a.slice(1);return{params:r.reduce((u,{paramName:p,isOptional:g},b)=>{if(p==="*"){let S=d[b]||"";l=o.slice(0,o.length-S.length).replace(/(.)\/+$/,"$1")}const v=d[b];return g&&!v?u[p]=void 0:u[p]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:l,pattern:e}}function BP(e,n=!1,t=!0){Gs(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,d,f)=>(r.push({paramName:d,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,n?void 0:"i"),r]}function qP(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return Gs(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),e}}function Ql(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let t=n.endsWith("/")?n.length-1:n.length,r=e.charAt(t);return r&&r!=="/"?null:e.slice(t)||"/"}function VP(e,n="/"){let{pathname:t,search:r="",hash:a=""}=typeof e=="string"?Fh(e):e;return{pathname:t?t.startsWith("/")?t:HP(t,n):n,search:WP(r),hash:QP(a)}}function HP(e,n){let t=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function Vv(e,n,t,r){return`Cannot include a '${e}' character in a manually specified \`to.${n}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function GP(e){return e.filter((n,t)=>t===0||n.route.path&&n.route.path.length>0)}function iw(e){let n=GP(e);return n.map((t,r)=>r===n.length-1?t.pathname:t.pathnameBase)}function aw(e,n,t,r=!1){let a;typeof e=="string"?a=Fh(e):(a={...e},pr(!a.pathname||!a.pathname.includes("?"),Vv("?","pathname","search",a)),pr(!a.pathname||!a.pathname.includes("#"),Vv("#","pathname","hash",a)),pr(!a.search||!a.search.includes("#"),Vv("#","search","hash",a)));let o=e===""||a.pathname==="",l=o?"/":a.pathname,d;if(l==null)d=t;else{let g=n.length-1;if(!r&&l.startsWith("..")){let b=l.split("/");for(;b[0]==="..";)b.shift(),g-=1;a.pathname=b.join("/")}d=g>=0?n[g]:"/"}let f=VP(a,d),u=l&&l!=="/"&&l.endsWith("/"),p=(o||l===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(u||p)&&(f.pathname+="/"),f}var Yl=e=>e.join("/").replace(/\/\/+/g,"/"),YP=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),WP=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,QP=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function JP(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var Hj=["POST","PUT","PATCH","DELETE"];new Set(Hj);var KP=["GET",...Hj];new Set(KP);var $h=w.createContext(null);$h.displayName="DataRouter";var xb=w.createContext(null);xb.displayName="DataRouterState";var Gj=w.createContext({isTransitioning:!1});Gj.displayName="ViewTransition";var XP=w.createContext(new Map);XP.displayName="Fetchers";var ZP=w.createContext(null);ZP.displayName="Await";var Qs=w.createContext(null);Qs.displayName="Navigation";var ig=w.createContext(null);ig.displayName="Location";var Js=w.createContext({outlet:null,matches:[],isDataRoute:!1});Js.displayName="Route";var sw=w.createContext(null);sw.displayName="RouteError";function eD(e,{relative:n}={}){pr(zh(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=w.useContext(Qs),{hash:a,pathname:o,search:l}=ag(e,{relative:n}),d=o;return t!=="/"&&(d=o==="/"?t:Yl([t,o])),r.createHref({pathname:d,search:l,hash:a})}function zh(){return w.useContext(ig)!=null}function Br(){return pr(zh(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(ig).location}var Yj="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Wj(e){w.useContext(Qs).static||w.useLayoutEffect(e)}function Et(){let{isDataRoute:e}=w.useContext(Js);return e?hD():tD()}function tD(){pr(zh(),"useNavigate() may be used only in the context of a <Router> component.");let e=w.useContext($h),{basename:n,navigator:t}=w.useContext(Qs),{matches:r}=w.useContext(Js),{pathname:a}=Br(),o=JSON.stringify(iw(r)),l=w.useRef(!1);return Wj(()=>{l.current=!0}),w.useCallback((f,u={})=>{if(Gs(l.current,Yj),!l.current)return;if(typeof f=="number"){t.go(f);return}let p=aw(f,JSON.parse(o),a,u.relative==="path");e==null&&n!=="/"&&(p.pathname=p.pathname==="/"?n:Yl([n,p.pathname])),(u.replace?t.replace:t.push)(p,u.state,u)},[n,t,o,a,e])}w.createContext(null);function Gi(){let{matches:e}=w.useContext(Js),n=e[e.length-1];return n?n.params:{}}function ag(e,{relative:n}={}){let{matches:t}=w.useContext(Js),{pathname:r}=Br(),a=JSON.stringify(iw(t));return w.useMemo(()=>aw(e,JSON.parse(a),r,n==="path"),[e,a,r,n])}function nD(e,n){return Qj(e,n)}function Qj(e,n,t,r){var M;pr(zh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:o}=w.useContext(Qs),{matches:l}=w.useContext(Js),d=l[l.length-1],f=d?d.params:{},u=d?d.pathname:"/",p=d?d.pathnameBase:"/",g=d&&d.route;{let R=g&&g.path||"";Jj(u,!g||R.endsWith("*")||R.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${R}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${R}"> to <Route path="${R==="/"?"*":`${R}/*`}">.`)}let b=Br(),v;if(n){let R=typeof n=="string"?Fh(n):n;pr(p==="/"||((M=R.pathname)==null?void 0:M.startsWith(p)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${R.pathname}" was given in the \`location\` prop.`),v=R}else v=b;let S=v.pathname||"/",k=S;if(p!=="/"){let R=p.replace(/^\//,"").split("/");k="/"+S.replace(/^\//,"").split("/").slice(R.length).join("/")}let T=!o&&t&&t.matches&&t.matches.length>0?t.matches:Bj(e,{pathname:k});Gs(g||T!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Gs(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let A=oD(T&&T.map(R=>Object.assign({},R,{params:Object.assign({},f,R.params),pathname:Yl([p,a.encodeLocation?a.encodeLocation(R.pathname).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?p:Yl([p,a.encodeLocation?a.encodeLocation(R.pathnameBase).pathname:R.pathnameBase])})),l,t,r);return n&&A?w.createElement(ig.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},A):A}function rD(){let e=fD(),n=JP(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:o},"ErrorBoundary")," or"," ",w.createElement("code",{style:o},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},n),t?w.createElement("pre",{style:a},t):null,l)}var iD=w.createElement(rD,null),aD=class extends w.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?w.createElement(Js.Provider,{value:this.props.routeContext},w.createElement(sw.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function sD({routeContext:e,match:n,children:t}){let r=w.useContext($h);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),w.createElement(Js.Provider,{value:e},t)}function oD(e,n=[],t=null,r=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(n.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let a=e,o=t==null?void 0:t.errors;if(o!=null){let f=a.findIndex(u=>u.route.id&&(o==null?void 0:o[u.route.id])!==void 0);pr(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,f+1))}let l=!1,d=-1;if(t)for(let f=0;f<a.length;f++){let u=a[f];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(d=f),u.route.id){let{loaderData:p,errors:g}=t,b=u.route.loader&&!p.hasOwnProperty(u.route.id)&&(!g||g[u.route.id]===void 0);if(u.route.lazy||b){l=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((f,u,p)=>{let g,b=!1,v=null,S=null;t&&(g=o&&u.route.id?o[u.route.id]:void 0,v=u.route.errorElement||iD,l&&(d<0&&p===0?(Jj("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,S=null):d===p&&(b=!0,S=u.route.hydrateFallbackElement||null)));let k=n.concat(a.slice(0,p+1)),T=()=>{let A;return g?A=v:b?A=S:u.route.Component?A=w.createElement(u.route.Component,null):u.route.element?A=u.route.element:A=f,w.createElement(sD,{match:u,routeContext:{outlet:f,matches:k,isDataRoute:t!=null},children:A})};return t&&(u.route.ErrorBoundary||u.route.errorElement||p===0)?w.createElement(aD,{location:t.location,revalidation:t.revalidation,component:v,error:g,children:T(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):T()},null)}function ow(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function lD(e){let n=w.useContext($h);return pr(n,ow(e)),n}function cD(e){let n=w.useContext(xb);return pr(n,ow(e)),n}function uD(e){let n=w.useContext(Js);return pr(n,ow(e)),n}function lw(e){let n=uD(e),t=n.matches[n.matches.length-1];return pr(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function dD(){return lw("useRouteId")}function fD(){var r;let e=w.useContext(sw),n=cD("useRouteError"),t=lw("useRouteError");return e!==void 0?e:(r=n.errors)==null?void 0:r[t]}function hD(){let{router:e}=lD("useNavigate"),n=lw("useNavigate"),t=w.useRef(!1);return Wj(()=>{t.current=!0}),w.useCallback(async(a,o={})=>{Gs(t.current,Yj),t.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:n,...o}))},[e,n])}var ES={};function Jj(e,n,t){!n&&!ES[e]&&(ES[e]=!0,Gs(!1,t))}w.memo(pD);function pD({routes:e,future:n,state:t}){return Qj(e,void 0,t,n)}function vn({to:e,replace:n,state:t,relative:r}){pr(zh(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=w.useContext(Qs);Gs(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=w.useContext(Js),{pathname:l}=Br(),d=Et(),f=aw(e,iw(o),l,r==="path"),u=JSON.stringify(f);return w.useEffect(()=>{d(JSON.parse(u),{replace:n,state:t,relative:r})},[d,u,r,n,t]),null}function mt(e){pr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function mD({basename:e="/",children:n=null,location:t,navigationType:r="POP",navigator:a,static:o=!1}){pr(!zh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=e.replace(/^\/*/,"/"),d=w.useMemo(()=>({basename:l,navigator:a,static:o,future:{}}),[l,a,o]);typeof t=="string"&&(t=Fh(t));let{pathname:f="/",search:u="",hash:p="",state:g=null,key:b="default"}=t,v=w.useMemo(()=>{let S=Ql(f,l);return S==null?null:{location:{pathname:S,search:u,hash:p,state:g,key:b},navigationType:r}},[l,f,u,p,g,b,r]);return Gs(v!=null,`<Router basename="${l}"> is not able to match the URL "${f}${u}${p}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:w.createElement(Qs.Provider,{value:d},w.createElement(ig.Provider,{children:n,value:v}))}function wh({children:e,location:n}){return nD(Z0(e),n)}function Z0(e,n=[]){let t=[];return w.Children.forEach(e,(r,a)=>{if(!w.isValidElement(r))return;let o=[...n,a];if(r.type===w.Fragment){t.push.apply(t,Z0(r.props.children,o));return}pr(r.type===mt,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),pr(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=Z0(r.props.children,o)),t.push(l)}),t}var Rx="get",Mx="application/x-www-form-urlencoded";function bb(e){return e!=null&&typeof e.tagName=="string"}function gD(e){return bb(e)&&e.tagName.toLowerCase()==="button"}function yD(e){return bb(e)&&e.tagName.toLowerCase()==="form"}function xD(e){return bb(e)&&e.tagName.toLowerCase()==="input"}function bD(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function vD(e,n){return e.button===0&&(!n||n==="_self")&&!bD(e)}var cx=null;function wD(){if(cx===null)try{new FormData(document.createElement("form"),0),cx=!1}catch{cx=!0}return cx}var SD=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Hv(e){return e!=null&&!SD.has(e)?(Gs(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Mx}"`),null):e}function ND(e,n){let t,r,a,o,l;if(yD(e)){let d=e.getAttribute("action");r=d?Ql(d,n):null,t=e.getAttribute("method")||Rx,a=Hv(e.getAttribute("enctype"))||Mx,o=new FormData(e)}else if(gD(e)||xD(e)&&(e.type==="submit"||e.type==="image")){let d=e.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=e.getAttribute("formaction")||d.getAttribute("action");if(r=f?Ql(f,n):null,t=e.getAttribute("formmethod")||d.getAttribute("method")||Rx,a=Hv(e.getAttribute("formenctype"))||Hv(d.getAttribute("enctype"))||Mx,o=new FormData(d,e),!wD()){let{name:u,type:p,value:g}=e;if(p==="image"){let b=u?`${u}.`:"";o.append(`${b}x`,"0"),o.append(`${b}y`,"0")}else u&&o.append(u,g)}}else{if(bb(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Rx,r=null,a=Mx,l=e}return o&&a==="text/plain"&&(l=o,o=void 0),{action:r,method:t.toLowerCase(),encType:a,formData:o,body:l}}function cw(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}async function CD(e,n){if(e.id in n)return n[e.id];try{let t=await import(e.module);return n[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function _D(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function jD(e,n,t){let r=await Promise.all(e.map(async a=>{let o=n.routes[a.route.id];if(o){let l=await CD(o,t);return l.links?l.links():[]}return[]}));return AD(r.flat(1).filter(_D).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function AS(e,n,t,r,a,o){let l=(f,u)=>t[u]?f.route.id!==t[u].route.id:!0,d=(f,u)=>{var p;return t[u].pathname!==f.pathname||((p=t[u].route.path)==null?void 0:p.endsWith("*"))&&t[u].params["*"]!==f.params["*"]};return o==="assets"?n.filter((f,u)=>l(f,u)||d(f,u)):o==="data"?n.filter((f,u)=>{var g;let p=r.routes[f.route.id];if(!p||!p.hasLoader)return!1;if(l(f,u)||d(f,u))return!0;if(f.route.shouldRevalidate){let b=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((g=t[0])==null?void 0:g.params)||{},nextUrl:new URL(e,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function kD(e,n,{includeHydrateFallback:t}={}){return TD(e.map(r=>{let a=n.routes[r.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function TD(e){return[...new Set(e)]}function ED(e){let n={},t=Object.keys(e).sort();for(let r of t)n[r]=e[r];return n}function AD(e,n){let t=new Set;return new Set(n),e.reduce((r,a)=>{let o=JSON.stringify(ED(a));return t.has(o)||(t.add(o),r.push({key:o,link:a})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var PD=new Set([100,101,204,205]);function DD(e,n){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":n&&Ql(t.pathname,n)==="/"?t.pathname=`${n.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function Kj(){let e=w.useContext($h);return cw(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function ID(){let e=w.useContext(xb);return cw(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var uw=w.createContext(void 0);uw.displayName="FrameworkContext";function Xj(){let e=w.useContext(uw);return cw(e,"You must render this element inside a <HydratedRouter> element"),e}function RD(e,n){let t=w.useContext(uw),[r,a]=w.useState(!1),[o,l]=w.useState(!1),{onFocus:d,onBlur:f,onMouseEnter:u,onMouseLeave:p,onTouchStart:g}=n,b=w.useRef(null);w.useEffect(()=>{if(e==="render"&&l(!0),e==="viewport"){let k=A=>{A.forEach(M=>{l(M.isIntersecting)})},T=new IntersectionObserver(k,{threshold:.5});return b.current&&T.observe(b.current),()=>{T.disconnect()}}},[e]),w.useEffect(()=>{if(r){let k=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(k)}}},[r]);let v=()=>{a(!0)},S=()=>{a(!1),l(!1)};return t?e!=="intent"?[o,b,{}]:[o,b,{onFocus:Cm(d,v),onBlur:Cm(f,S),onMouseEnter:Cm(u,v),onMouseLeave:Cm(p,S),onTouchStart:Cm(g,v)}]:[!1,b,{}]}function Cm(e,n){return t=>{e&&e(t),t.defaultPrevented||n(t)}}function MD({page:e,...n}){let{router:t}=Kj(),r=w.useMemo(()=>Bj(t.routes,e,t.basename),[t.routes,e,t.basename]);return r?w.createElement(LD,{page:e,matches:r,...n}):null}function OD(e){let{manifest:n,routeModules:t}=Xj(),[r,a]=w.useState([]);return w.useEffect(()=>{let o=!1;return jD(e,n,t).then(l=>{o||a(l)}),()=>{o=!0}},[e,n,t]),r}function LD({page:e,matches:n,...t}){let r=Br(),{manifest:a,routeModules:o}=Xj(),{basename:l}=Kj(),{loaderData:d,matches:f}=ID(),u=w.useMemo(()=>AS(e,n,f,a,r,"data"),[e,n,f,a,r]),p=w.useMemo(()=>AS(e,n,f,a,r,"assets"),[e,n,f,a,r]),g=w.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let S=new Set,k=!1;if(n.forEach(A=>{var R;let M=a.routes[A.route.id];!M||!M.hasLoader||(!u.some(z=>z.route.id===A.route.id)&&A.route.id in d&&((R=o[A.route.id])!=null&&R.shouldRevalidate)||M.hasClientLoader?k=!0:S.add(A.route.id))}),S.size===0)return[];let T=DD(e,l);return k&&S.size>0&&T.searchParams.set("_routes",n.filter(A=>S.has(A.route.id)).map(A=>A.route.id).join(",")),[T.pathname+T.search]},[l,d,r,a,u,n,e,o]),b=w.useMemo(()=>kD(p,a),[p,a]),v=OD(p);return w.createElement(w.Fragment,null,g.map(S=>w.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...t})),b.map(S=>w.createElement("link",{key:S,rel:"modulepreload",href:S,...t})),v.map(({key:S,link:k})=>w.createElement("link",{key:S,...k})))}function FD(...e){return n=>{e.forEach(t=>{typeof t=="function"?t(n):t!=null&&(t.current=n)})}}var Zj=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Zj&&(window.__reactRouterVersion="7.6.0")}catch{}function $D({basename:e,children:n,window:t}){let r=w.useRef();r.current==null&&(r.current=kP({window:t,v5Compat:!0}));let a=r.current,[o,l]=w.useState({action:a.action,location:a.location}),d=w.useCallback(f=>{w.startTransition(()=>l(f))},[l]);return w.useLayoutEffect(()=>a.listen(d),[a,d]),w.createElement(mD,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:a})}var ek=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,hs=w.forwardRef(function({onClick:n,discover:t="render",prefetch:r="none",relative:a,reloadDocument:o,replace:l,state:d,target:f,to:u,preventScrollReset:p,viewTransition:g,...b},v){let{basename:S}=w.useContext(Qs),k=typeof u=="string"&&ek.test(u),T,A=!1;if(typeof u=="string"&&k&&(T=u,Zj))try{let J=new URL(window.location.href),D=u.startsWith("//")?new URL(J.protocol+u):new URL(u),$=Ql(D.pathname,S);D.origin===J.origin&&$!=null?u=$+D.search+D.hash:A=!0}catch{Gs(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let M=eD(u,{relative:a}),[R,z,F]=RD(r,b),L=qD(u,{replace:l,state:d,target:f,preventScrollReset:p,relative:a,viewTransition:g});function U(J){n&&n(J),J.defaultPrevented||L(J)}let B=w.createElement("a",{...b,...F,href:T||M,onClick:A||o?n:U,ref:FD(v,z),target:f,"data-discover":!k&&t==="render"?"true":void 0});return R&&!k?w.createElement(w.Fragment,null,B,w.createElement(MD,{page:M})):B});hs.displayName="Link";var zD=w.forwardRef(function({"aria-current":n="page",caseSensitive:t=!1,className:r="",end:a=!1,style:o,to:l,viewTransition:d,children:f,...u},p){let g=ag(l,{relative:u.relative}),b=Br(),v=w.useContext(xb),{navigator:S,basename:k}=w.useContext(Qs),T=v!=null&&WD(g)&&d===!0,A=S.encodeLocation?S.encodeLocation(g).pathname:g.pathname,M=b.pathname,R=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(M=M.toLowerCase(),R=R?R.toLowerCase():null,A=A.toLowerCase()),R&&k&&(R=Ql(R,k)||R);const z=A!=="/"&&A.endsWith("/")?A.length-1:A.length;let F=M===A||!a&&M.startsWith(A)&&M.charAt(z)==="/",L=R!=null&&(R===A||!a&&R.startsWith(A)&&R.charAt(A.length)==="/"),U={isActive:F,isPending:L,isTransitioning:T},B=F?n:void 0,J;typeof r=="function"?J=r(U):J=[r,F?"active":null,L?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let D=typeof o=="function"?o(U):o;return w.createElement(hs,{...u,"aria-current":B,className:J,ref:p,style:D,to:l,viewTransition:d},typeof f=="function"?f(U):f)});zD.displayName="NavLink";var UD=w.forwardRef(({discover:e="render",fetcherKey:n,navigate:t,reloadDocument:r,replace:a,state:o,method:l=Rx,action:d,onSubmit:f,relative:u,preventScrollReset:p,viewTransition:g,...b},v)=>{let S=GD(),k=YD(d,{relative:u}),T=l.toLowerCase()==="get"?"get":"post",A=typeof d=="string"&&ek.test(d),M=R=>{if(f&&f(R),R.defaultPrevented)return;R.preventDefault();let z=R.nativeEvent.submitter,F=(z==null?void 0:z.getAttribute("formmethod"))||l;S(z||R.currentTarget,{fetcherKey:n,method:F,navigate:t,replace:a,state:o,relative:u,preventScrollReset:p,viewTransition:g})};return w.createElement("form",{ref:v,method:T,action:k,onSubmit:r?f:M,...b,"data-discover":!A&&e==="render"?"true":void 0})});UD.displayName="Form";function BD(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function tk(e){let n=w.useContext($h);return pr(n,BD(e)),n}function qD(e,{target:n,replace:t,state:r,preventScrollReset:a,relative:o,viewTransition:l}={}){let d=Et(),f=Br(),u=ag(e,{relative:o});return w.useCallback(p=>{if(vD(p,n)){p.preventDefault();let g=t!==void 0?t:Ym(f)===Ym(u);d(e,{replace:g,state:r,preventScrollReset:a,relative:o,viewTransition:l})}},[f,d,u,t,r,n,e,a,o,l])}var VD=0,HD=()=>`__${String(++VD)}__`;function GD(){let{router:e}=tk("useSubmit"),{basename:n}=w.useContext(Qs),t=dD();return w.useCallback(async(r,a={})=>{let{action:o,method:l,encType:d,formData:f,body:u}=ND(r,n);if(a.navigate===!1){let p=a.fetcherKey||HD();await e.fetch(p,t,a.action||o,{preventScrollReset:a.preventScrollReset,formData:f,body:u,formMethod:a.method||l,formEncType:a.encType||d,flushSync:a.flushSync})}else await e.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:f,body:u,formMethod:a.method||l,formEncType:a.encType||d,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,n,t])}function YD(e,{relative:n}={}){let{basename:t}=w.useContext(Qs),r=w.useContext(Js);pr(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),o={...ag(e||".",{relative:n})},l=Br();if(e==null){o.search=l.search;let d=new URLSearchParams(o.search),f=d.getAll("index");if(f.some(p=>p==="")){d.delete("index"),f.filter(g=>g).forEach(g=>d.append("index",g));let p=d.toString();o.search=p?`?${p}`:""}}return(!e||e===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:Yl([t,o.pathname])),Ym(o)}function WD(e,n={}){let t=w.useContext(Gj);pr(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=tk("useViewTransitionState"),a=ag(e,{relative:n.relative});if(!t.isTransitioning)return!1;let o=Ql(t.currentLocation.pathname,r)||t.currentLocation.pathname,l=Ql(t.nextLocation.pathname,r)||t.nextLocation.pathname;return Yx(a.pathname,l)!=null||Yx(a.pathname,o)!=null}[...PD];var QD=zj();class JD extends w.Component{constructor(){super(...arguments);Qn(this,"state",{hasError:!1})}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){console.error("Uncaught error:",t,r)}render(){return this.state.hasError?i.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"red",border:"1px solid red",borderRadius:"5px"},children:[i.jsx("h1",{children:"Something went wrong."}),i.jsx("p",{children:"We are sorry for the inconvenience. Please try again later."})]}):this.props.children}}const nk=w.createContext(void 0),KD=({children:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState({startDate:null,endDate:null}),[o,l]=w.useState(null),[d,f]=w.useState(null),u=w.useCallback(()=>t(!0),[]),p=w.useCallback(()=>t(!1),[]),g=w.useCallback(()=>t(M=>!M),[]),b=w.useCallback(M=>{f(()=>M)},[]),v=w.useCallback(M=>{d?d(M):console.warn("Analysis navigator not registered")},[d]),[S,k]=w.useState(null),T=w.useCallback(M=>{k(()=>M)},[]),A=w.useCallback(async()=>S?await S():(console.warn("Analysis refresher not registered"),null),[S]);return i.jsx(nk.Provider,{value:{isOpen:n,openAssistant:u,closeAssistant:p,toggleAssistant:g,analysisDateRange:r,setAnalysisDateRange:a,analysisData:o,setAnalysisData:l,analysisNavigate:v,registerAnalysisNavigator:b,refreshAnalysis:A,registerAnalysisRefresher:T},children:e})},vb=()=>{const e=w.useContext(nk);if(e===void 0)throw new Error("useClinicAssistantContext must be used within a ClinicAssistantProvider");return e},rk=w.createContext(void 0),XD=({children:e})=>{const[n,t]=w.useState([]),[r,a]=w.useState(null),[o,l]=w.useState(""),[d,f]=w.useState(0),[u,p]=w.useState([]),g=w.useCallback(k=>{t(T=>[...T,k])},[]),b=w.useCallback((k,T)=>{t(A=>A.map(M=>M.id===k?{...M,...T}:M))},[]),v=w.useCallback(k=>{t(T=>T.filter(A=>A.id!==k))},[]),S=w.useCallback(()=>{t([]),a(null),l(""),f(0),p([])},[]);return i.jsx(rk.Provider,{value:{purchaseRows:n,setPurchaseRows:t,selectedDistributor:r,setSelectedDistributor:a,searchTerm:o,setSearchTerm:l,amountPaidToDistributor:d,setAmountPaidToDistributor:f,distributors:u,setDistributors:p,addPurchaseRow:g,updatePurchaseRow:b,removePurchaseRow:v,resetPurchase:S},children:e})},ik=()=>{const e=w.useContext(rk);if(!e)throw new Error("usePurchaseContext must be used within a PurchaseProvider");return e};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let ZD,eI;function tI(){return{geminiUrl:ZD,vertexUrl:eI}}function nI(e,n,t){var r,a,o;if(!(!((r=e.httpOptions)===null||r===void 0)&&r.baseUrl)){const l=tI();return e.vertexai?(a=l.vertexUrl)!==null&&a!==void 0?a:n:(o=l.geminiUrl)!==null&&o!==void 0?o:t}return e.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sg{}function qt(e,n){const t=/\{([^}]+)\}/g;return e.replace(t,(r,a)=>{if(Object.prototype.hasOwnProperty.call(n,a)){const o=n[a];return o!=null?String(o):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function _(e,n,t){for(let o=0;o<n.length-1;o++){const l=n[o];if(l.endsWith("[]")){const d=l.slice(0,-2);if(!(d in e))if(Array.isArray(t))e[d]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(e[d])){const f=e[d];if(Array.isArray(t))for(let u=0;u<f.length;u++){const p=f[u];_(p,n.slice(o+1),t[u])}else for(const u of f)_(u,n.slice(o+1),t)}return}else if(l.endsWith("[0]")){const d=l.slice(0,-3);d in e||(e[d]=[{}]);const f=e[d];_(f[0],n.slice(o+1),t);return}(!e[l]||typeof e[l]!="object")&&(e[l]={}),e=e[l]}const r=n[n.length-1],a=e[r];if(a!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===a)return;if(typeof a=="object"&&typeof t=="object"&&a!==null&&t!==null)Object.assign(a,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else e[r]=t}function C(e,n){try{if(n.length===1&&n[0]==="_self")return e;for(let t=0;t<n.length;t++){if(typeof e!="object"||e===null)return;const r=n[t];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in e){const o=e[a];return Array.isArray(o)?o.map(l=>C(l,n.slice(t+1))):void 0}else return}else e=e[r]}return e}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mr(e,n){if(!n||typeof n!="string")throw new Error("model is required and must be a string");if(e.isVertexAI()){if(n.startsWith("publishers/")||n.startsWith("projects/")||n.startsWith("models/"))return n;if(n.indexOf("/")>=0){const t=n.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${n}`}else return n.startsWith("models/")||n.startsWith("tunedModels/")?n:`models/${n}`}function ak(e,n){const t=mr(e,n);return t?t.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:t.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${t}`:t:""}function sk(e,n){return Array.isArray(n)?n.map(t=>Wx(e,t)):[Wx(e,n)]}function Wx(e,n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function rI(e,n){const t=Wx(e,n);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function iI(e,n){const t=Wx(e,n);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function PS(e,n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function ok(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(t=>PS(e,t)):[PS(e,n)]}function e1(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function DS(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function IS(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function da(e,n){if(n==null)throw new Error("ContentUnion is required");return e1(n)?n:{role:"user",parts:ok(e,n)}}function lk(e,n){if(!n)return[];if(e.isVertexAI()&&Array.isArray(n))return n.flatMap(t=>{const r=da(e,t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const t=da(e,n);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(n)?n.map(t=>da(e,t)):[da(e,n)]}function hu(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(DS(n)||IS(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[da(e,n)]}const t=[],r=[],a=e1(n[0]);for(const o of n){const l=e1(o);if(l!=a)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)t.push(o);else{if(DS(o)||IS(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(o)}}return a||t.push({role:"user",parts:ok(e,r)}),t}function ck(e,n){return n}function uk(e,n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function wb(e,n){return n}function Sb(e,n){if(!Array.isArray(n))throw new Error("tool is required and must be an array of Tools");return n}function aI(e,n,t,r=1){const a=!n.startsWith(`${t}/`)&&n.split("/").length===r;return e.isVertexAI()?n.startsWith("projects/")?n:n.startsWith("locations/")?`projects/${e.getProject()}/${n}`:n.startsWith(`${t}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:a?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}/${n}`:n:a?`${t}/${n}`:n}function pu(e,n){if(typeof n!="string")throw new Error("name must be a string");return aI(e,n,"cachedContents")}function dk(e,n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function mu(e,n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function sI(e){return e!=null&&typeof e=="object"&&"name"in e}function oI(e){return e!=null&&typeof e=="object"&&"video"in e}function lI(e){return e!=null&&typeof e=="object"&&"uri"in e}function fk(e,n){var t;let r;if(sI(n)&&(r=n.name),!(lI(n)&&(r=n.uri,r===void 0))&&!(oI(n)&&(r=(t=n.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof n=="string"&&(r=n),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const o=r.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${r}`);r=o[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function hk(e,n){let t;return e.isVertexAI()?t=n?"publishers/google/models":"models":t=n?"models":"tunedModels",t}function pk(e,n){for(const t of["models","tunedModels","publisherModels"])if(cI(n,t))return n[t];return[]}function cI(e,n){return e!==null&&typeof e=="object"&&n in e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function uI(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&_(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function dI(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&_(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&_(t,["inlineData"],uI(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&_(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&_(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const p=C(n,["text"]);return p!=null&&_(t,["text"],p),t}function RS(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>dI(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function fI(){return{}}function hI(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function pI(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],hI(e,r)),t}function mI(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&_(t,["googleSearch"],fI());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&_(t,["googleSearchRetrieval"],pI(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&_(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&_(t,["functionDeclarations"],l),t}function gI(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function yI(e,n){const t={},r=C(n,["functionCallingConfig"]);if(r!=null&&_(t,["functionCallingConfig"],gI(e,r)),C(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function xI(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const o=C(n,["expireTime"]);t!==void 0&&o!=null&&_(t,["expireTime"],o);const l=C(n,["displayName"]);t!==void 0&&l!=null&&_(t,["displayName"],l);const d=C(n,["contents"]);if(t!==void 0&&d!=null){let g=hu(e,d);Array.isArray(g)&&(g=g.map(b=>RS(e,b))),_(t,["contents"],g)}const f=C(n,["systemInstruction"]);t!==void 0&&f!=null&&_(t,["systemInstruction"],RS(e,da(e,f)));const u=C(n,["tools"]);if(t!==void 0&&u!=null){let g=u;Array.isArray(g)&&(g=g.map(b=>mI(e,b))),_(t,["tools"],g)}const p=C(n,["toolConfig"]);return t!==void 0&&p!=null&&_(t,["toolConfig"],yI(e,p)),r}function bI(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["model"],ak(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],xI(e,a,t)),t}function vI(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],pu(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function wI(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],pu(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function SI(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const o=C(n,["expireTime"]);return t!==void 0&&o!=null&&_(t,["expireTime"],o),r}function NI(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],pu(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],SI(e,a,t)),t}function CI(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&_(t,["_query","pageToken"],o),r}function _I(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],CI(e,r,t)),t}function jI(e,n){const t={},r=C(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=C(n,["data"]);a!=null&&_(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function kI(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&_(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&_(t,["inlineData"],jI(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&_(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const p=C(n,["functionResponse"]);p!=null&&_(t,["functionResponse"],p);const g=C(n,["text"]);return g!=null&&_(t,["text"],g),t}function MS(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>kI(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function TI(){return{}}function EI(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function AI(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],EI(e,r)),t}function PI(){return{}}function DI(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&_(t,["apiKeyString"],r),t}function II(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&_(t,["apiKeyConfig"],DI(e,r));const a=C(n,["authType"]);a!=null&&_(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&_(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&_(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&_(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&_(t,["oidcConfig"],f),t}function RI(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&_(t,["authConfig"],II(e,r)),t}function MI(e,n){const t={},r=C(n,["retrieval"]);r!=null&&_(t,["retrieval"],r),C(n,["googleSearch"])!=null&&_(t,["googleSearch"],TI());const o=C(n,["googleSearchRetrieval"]);o!=null&&_(t,["googleSearchRetrieval"],AI(e,o)),C(n,["enterpriseWebSearch"])!=null&&_(t,["enterpriseWebSearch"],PI());const d=C(n,["googleMaps"]);d!=null&&_(t,["googleMaps"],RI(e,d));const f=C(n,["codeExecution"]);f!=null&&_(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&_(t,["functionDeclarations"],u),t}function OI(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function LI(e,n){const t={},r=C(n,["latitude"]);r!=null&&_(t,["latitude"],r);const a=C(n,["longitude"]);return a!=null&&_(t,["longitude"],a),t}function FI(e,n){const t={},r=C(n,["latLng"]);return r!=null&&_(t,["latLng"],LI(e,r)),t}function $I(e,n){const t={},r=C(n,["functionCallingConfig"]);r!=null&&_(t,["functionCallingConfig"],OI(e,r));const a=C(n,["retrievalConfig"]);return a!=null&&_(t,["retrievalConfig"],FI(e,a)),t}function zI(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const o=C(n,["expireTime"]);t!==void 0&&o!=null&&_(t,["expireTime"],o);const l=C(n,["displayName"]);t!==void 0&&l!=null&&_(t,["displayName"],l);const d=C(n,["contents"]);if(t!==void 0&&d!=null){let g=hu(e,d);Array.isArray(g)&&(g=g.map(b=>MS(e,b))),_(t,["contents"],g)}const f=C(n,["systemInstruction"]);t!==void 0&&f!=null&&_(t,["systemInstruction"],MS(e,da(e,f)));const u=C(n,["tools"]);if(t!==void 0&&u!=null){let g=u;Array.isArray(g)&&(g=g.map(b=>MI(e,b))),_(t,["tools"],g)}const p=C(n,["toolConfig"]);return t!==void 0&&p!=null&&_(t,["toolConfig"],$I(e,p)),r}function UI(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["model"],ak(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],zI(e,a,t)),t}function BI(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],pu(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function qI(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],pu(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function VI(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const o=C(n,["expireTime"]);return t!==void 0&&o!=null&&_(t,["expireTime"],o),r}function HI(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],pu(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],VI(e,a,t)),t}function GI(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&_(t,["_query","pageToken"],o),r}function YI(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],GI(e,r,t)),t}function Ox(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["model"]);o!=null&&_(t,["model"],o);const l=C(n,["createTime"]);l!=null&&_(t,["createTime"],l);const d=C(n,["updateTime"]);d!=null&&_(t,["updateTime"],d);const f=C(n,["expireTime"]);f!=null&&_(t,["expireTime"],f);const u=C(n,["usageMetadata"]);return u!=null&&_(t,["usageMetadata"],u),t}function WI(){return{}}function QI(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["cachedContents"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>Ox(e,l))),_(t,["cachedContents"],o)}return t}function Lx(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["model"]);o!=null&&_(t,["model"],o);const l=C(n,["createTime"]);l!=null&&_(t,["createTime"],l);const d=C(n,["updateTime"]);d!=null&&_(t,["updateTime"],d);const f=C(n,["expireTime"]);f!=null&&_(t,["expireTime"],f);const u=C(n,["usageMetadata"]);return u!=null&&_(t,["usageMetadata"],u),t}function JI(){return{}}function KI(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["cachedContents"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>Lx(e,l))),_(t,["cachedContents"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Dh;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Dh||(Dh={}));class Nb{constructor(n,t,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(n,r,a)}init(n,t,r){var a,o;this.nameInternal=n,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};r?typeof r=="object"?l=Object.assign({},r):l=r:l={config:{}},l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(o=(a=l.config)===null||a===void 0?void 0:a.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(n){this.init(this.nameInternal,n,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(n){return this.pageInternal[n]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const n=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:n,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const n=await this.requestInternal(this.params);return this.initNextPage(n),this.page}hasNextPage(){var n;return((n=this.params.config)===null||n===void 0?void 0:n.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var OS;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(OS||(OS={}));var LS;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(LS||(LS={}));var FS;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(FS||(FS={}));var $S;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})($S||($S={}));var zS;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(zS||(zS={}));var US;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(US||(US={}));var BS;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(BS||(BS={}));var Ih;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT"})(Ih||(Ih={}));var qS;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY"})(qS||(qS={}));var VS;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(VS||(VS={}));var HS;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(HS||(HS={}));var GS;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(GS||(GS={}));var YS;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(YS||(YS={}));var uu;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(uu||(uu={}));var WS;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(WS||(WS={}));var t1;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(t1||(t1={}));var QS;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(QS||(QS={}));var JS;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(JS||(JS={}));var KS;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(KS||(KS={}));var XS;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(XS||(XS={}));var ZS;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(ZS||(ZS={}));var eN;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(eN||(eN={}));var tN;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi"})(tN||(tN={}));var nN;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(nN||(nN={}));var rN;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(rN||(rN={}));var iN;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(iN||(iN={}));var aN;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(aN||(aN={}));var sN;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(sN||(sN={}));var oN;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(oN||(oN={}));var lN;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(lN||(lN={}));var cN;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(cN||(cN={}));var uN;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(uN||(uN={}));var dN;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(dN||(dN={}));var fN;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(fN||(fN={}));class ux{get text(){var n,t,r,a,o,l,d,f;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",p=!1;const g=[];for(const b of(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[v,S]of Object.entries(b))v!=="text"&&v!=="thought"&&(S!==null||S!==void 0)&&g.push(v);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;p=!0,u+=b.text}}return g.length>0&&console.warn(`there are non-text parts ${g} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),p?u:void 0}get data(){var n,t,r,a,o,l,d,f;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const p=[];for(const g of(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[b,v]of Object.entries(g))b!=="inlineData"&&(v!==null||v!==void 0)&&p.push(b);g.inlineData&&typeof g.inlineData.data=="string"&&(u+=atob(g.inlineData.data))}return p.length>0&&console.warn(`there are non-data parts ${p} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var n,t,r,a,o,l,d,f;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(p=>p.functionCall).map(p=>p.functionCall).filter(p=>p!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var n,t,r,a,o,l,d,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const p=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(g=>g.executableCode).map(g=>g.executableCode).filter(g=>g!==void 0);if((p==null?void 0:p.length)!==0)return(u=p==null?void 0:p[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var n,t,r,a,o,l,d,f,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const p=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(g=>g.codeExecutionResult).map(g=>g.codeExecutionResult).filter(g=>g!==void 0);if((p==null?void 0:p.length)!==0)return(u=p==null?void 0:p[0])===null||u===void 0?void 0:u.output}}class hN{}class pN{}class XI{}class ZI{}class mN{}class gN{}class yN{}class eR{}class xN{}class bN{}class vN{}class tR{}class n1{constructor(n){const t={};for(const r of n.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=n}json(){return this.responseInternal.json()}}class nR{}class rR{}class iR{get text(){var n,t,r;let a="",o=!1;const l=[];for(const d of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[f,u]of Object.entries(d))f!=="text"&&f!=="thought"&&u!==null&&l.push(f);if(typeof d.text=="string"){if(typeof d.thought=="boolean"&&d.thought)continue;o=!0,a+=d.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?a:void 0}get data(){var n,t,r;let a="";const o=[];for(const l of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[d,f]of Object.entries(l))d!=="inlineData"&&f!==null&&o.push(d);l.inlineData&&typeof l.inlineData.data=="string"&&(a+=atob(l.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class aR extends sg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Nb(Dh.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=UI(this.apiClient,n);return d=qt("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>Lx(this.apiClient,p))}else{const u=bI(this.apiClient,n);return d=qt("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>Ox(this.apiClient,p))}}async get(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=BI(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>Lx(this.apiClient,p))}else{const u=vI(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>Ox(this.apiClient,p))}}async delete(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=qI(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(()=>{const p=JI(),g=new bN;return Object.assign(g,p),g})}else{const u=wI(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(()=>{const p=WI(),g=new bN;return Object.assign(g,p),g})}}async update(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=HI(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>Lx(this.apiClient,p))}else{const u=NI(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>Ox(this.apiClient,p))}}async listInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=YI(this.apiClient,n);return d=qt("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=KI(this.apiClient,p),b=new vN;return Object.assign(b,g),b})}else{const u=_I(this.apiClient,n);return d=qt("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=QI(this.apiClient,p),b=new vN;return Object.assign(b,g),b})}}}function wN(e){var n=typeof Symbol=="function"&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ci(e){return this instanceof Ci?(this.v=e,this):new Ci(e)}function Qx(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(e,n||[]),a,o=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",l),a[Symbol.asyncIterator]=function(){return this},a;function l(v){return function(S){return Promise.resolve(S).then(v,g)}}function d(v,S){r[v]&&(a[v]=function(k){return new Promise(function(T,A){o.push([v,k,T,A])>1||f(v,k)})},S&&(a[v]=S(a[v])))}function f(v,S){try{u(r[v](S))}catch(k){b(o[0][3],k)}}function u(v){v.value instanceof Ci?Promise.resolve(v.value.v).then(p,g):b(o[0][2],v)}function p(v){f("next",v)}function g(v){f("throw",v)}function b(v,S){v(S),o.shift(),o.length&&f(o[0][0],o[0][1])}}function r1(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e[Symbol.asyncIterator],t;return n?n.call(e):(e=typeof wN=="function"?wN(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=e[o]&&function(l){return new Promise(function(d,f){l=e[o](l),a(d,f,l.done,l.value)})}}function a(o,l,d,f){Promise.resolve(f).then(function(u){o({value:u,done:d})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sR(e){var n;if(e.candidates==null||e.candidates.length===0)return!1;const t=(n=e.candidates[0])===null||n===void 0?void 0:n.content;return t===void 0?!1:mk(t)}function mk(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const n of e.parts)if(n===void 0||Object.keys(n).length===0||n.text!==void 0&&n.text==="")return!1;return!0}function oR(e){if(e.length!==0){if(e[0].role!=="user")throw new Error("History must start with a user turn.");for(const n of e)if(n.role!=="user"&&n.role!=="model")throw new Error(`Role must be user or model, but got ${n.role}.`)}}function lR(e){if(e===void 0||e.length===0)return[];const n=[],t=e.length;let r=0,a=e[0];for(;r<t;)if(e[r].role==="user")a=e[r],r++;else{const o=[];let l=!0;for(;r<t&&e[r].role==="model";)o.push(e[r]),l&&!mk(e[r])&&(l=!1),r++;l&&(n.push(a),n.push(...o))}return n}class cR{constructor(n,t){this.modelsModule=n,this.apiClient=t}create(n){return new uR(this.apiClient,this.modelsModule,n.model,n.config,n.history)}}class uR{constructor(n,t,r,a={},o=[]){this.apiClient=n,this.modelsModule=t,this.model=r,this.config=a,this.history=o,this.sendPromise=Promise.resolve(),oR(o)}async sendMessage(n){var t;await this.sendPromise;const r=da(this.apiClient,n.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,l;const f=(l=(o=(await a).candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content,u=f?[f]:[];this.recordHistory(r,u)})(),await this.sendPromise,a}async sendMessageStream(n){var t;await this.sendPromise;const r=da(this.apiClient,n.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const o=await a;return this.processStreamResponse(o,r)}getHistory(n=!1){return n?lR(this.history):this.history}processStreamResponse(n,t){var r,a;return Qx(this,arguments,function*(){var l,d,f,u;const p=[];try{for(var g=!0,b=r1(n),v;v=yield Ci(b.next()),l=v.done,!l;g=!0){u=v.value,g=!1;const S=u;if(sR(S)){const k=(a=(r=S.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;k!==void 0&&p.push(k)}yield yield Ci(S)}}catch(S){d={error:S}}finally{try{!g&&!l&&(f=b.return)&&(yield Ci(f.call(b)))}finally{if(d)throw d.error}}this.recordHistory(t,p)})}recordHistory(n,t){let r=[];t.length>0&&t.every(a=>a.role==="model")?r=t:r.push({role:"model",parts:[]}),this.history.push(n),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dR(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&_(t,["_query","pageToken"],o),r}function fR(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],dR(e,r,t)),t}function hR(e,n){const t={},r=C(n,["details"]);r!=null&&_(t,["details"],r);const a=C(n,["message"]);a!=null&&_(t,["message"],a);const o=C(n,["code"]);return o!=null&&_(t,["code"],o),t}function pR(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["mimeType"]);o!=null&&_(t,["mimeType"],o);const l=C(n,["sizeBytes"]);l!=null&&_(t,["sizeBytes"],l);const d=C(n,["createTime"]);d!=null&&_(t,["createTime"],d);const f=C(n,["expirationTime"]);f!=null&&_(t,["expirationTime"],f);const u=C(n,["updateTime"]);u!=null&&_(t,["updateTime"],u);const p=C(n,["sha256Hash"]);p!=null&&_(t,["sha256Hash"],p);const g=C(n,["uri"]);g!=null&&_(t,["uri"],g);const b=C(n,["downloadUri"]);b!=null&&_(t,["downloadUri"],b);const v=C(n,["state"]);v!=null&&_(t,["state"],v);const S=C(n,["source"]);S!=null&&_(t,["source"],S);const k=C(n,["videoMetadata"]);k!=null&&_(t,["videoMetadata"],k);const T=C(n,["error"]);return T!=null&&_(t,["error"],hR(e,T)),t}function mR(e,n){const t={},r=C(n,["file"]);r!=null&&_(t,["file"],pR(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function gR(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","file"],fk(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function yR(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","file"],fk(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function xR(e,n){const t={},r=C(n,["details"]);r!=null&&_(t,["details"],r);const a=C(n,["message"]);a!=null&&_(t,["message"],a);const o=C(n,["code"]);return o!=null&&_(t,["code"],o),t}function i1(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["mimeType"]);o!=null&&_(t,["mimeType"],o);const l=C(n,["sizeBytes"]);l!=null&&_(t,["sizeBytes"],l);const d=C(n,["createTime"]);d!=null&&_(t,["createTime"],d);const f=C(n,["expirationTime"]);f!=null&&_(t,["expirationTime"],f);const u=C(n,["updateTime"]);u!=null&&_(t,["updateTime"],u);const p=C(n,["sha256Hash"]);p!=null&&_(t,["sha256Hash"],p);const g=C(n,["uri"]);g!=null&&_(t,["uri"],g);const b=C(n,["downloadUri"]);b!=null&&_(t,["downloadUri"],b);const v=C(n,["state"]);v!=null&&_(t,["state"],v);const S=C(n,["source"]);S!=null&&_(t,["source"],S);const k=C(n,["videoMetadata"]);k!=null&&_(t,["videoMetadata"],k);const T=C(n,["error"]);return T!=null&&_(t,["error"],xR(e,T)),t}function bR(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["files"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>i1(e,l))),_(t,["files"],o)}return t}function vR(){return{}}function wR(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class SR extends sg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Nb(Dh.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(n){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(n.file,n.config).then(t=>i1(this.apiClient,t))}async download(n){await this.apiClient.downloadFile(n)}async listInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=fR(this.apiClient,n);return o=qt("files",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const u=bR(this.apiClient,f),p=new tR;return Object.assign(p,u),p})}}async createInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=mR(this.apiClient,n);return o=qt("upload/v1beta/files",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(()=>{const f=vR(),u=new nR;return Object.assign(u,f),u})}}async get(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=gR(this.apiClient,n);return o=qt("files/{file}",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>i1(this.apiClient,f))}}async delete(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=yR(this.apiClient,n);return o=qt("files/{file}",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(()=>{const f=wR(),u=new rR;return Object.assign(u,f),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function NR(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&_(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function CR(e,n){const t={},r=C(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=C(n,["data"]);a!=null&&_(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function _R(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&_(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&_(t,["inlineData"],NR(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&_(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&_(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const p=C(n,["text"]);return p!=null&&_(t,["text"],p),t}function jR(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&_(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&_(t,["inlineData"],CR(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&_(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const p=C(n,["functionResponse"]);p!=null&&_(t,["functionResponse"],p);const g=C(n,["text"]);return g!=null&&_(t,["text"],g),t}function kR(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>_R(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function TR(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>jR(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function ER(){return{}}function AR(){return{}}function PR(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function DR(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function IR(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],PR(e,r)),t}function RR(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],DR(e,r)),t}function MR(){return{}}function OR(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&_(t,["apiKeyString"],r),t}function LR(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&_(t,["apiKeyConfig"],OR(e,r));const a=C(n,["authType"]);a!=null&&_(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&_(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&_(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&_(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&_(t,["oidcConfig"],f),t}function FR(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&_(t,["authConfig"],LR(e,r)),t}function $R(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&_(t,["googleSearch"],ER());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&_(t,["googleSearchRetrieval"],IR(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&_(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&_(t,["functionDeclarations"],l),t}function zR(e,n){const t={},r=C(n,["retrieval"]);r!=null&&_(t,["retrieval"],r),C(n,["googleSearch"])!=null&&_(t,["googleSearch"],AR());const o=C(n,["googleSearchRetrieval"]);o!=null&&_(t,["googleSearchRetrieval"],RR(e,o)),C(n,["enterpriseWebSearch"])!=null&&_(t,["enterpriseWebSearch"],MR());const d=C(n,["googleMaps"]);d!=null&&_(t,["googleMaps"],FR(e,d));const f=C(n,["codeExecution"]);f!=null&&_(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&_(t,["functionDeclarations"],u),t}function UR(e,n){const t={},r=C(n,["handle"]);if(r!=null&&_(t,["handle"],r),C(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function BR(e,n){const t={},r=C(n,["handle"]);r!=null&&_(t,["handle"],r);const a=C(n,["transparent"]);return a!=null&&_(t,["transparent"],a),t}function SN(){return{}}function NN(){return{}}function qR(e,n){const t={},r=C(n,["disabled"]);r!=null&&_(t,["disabled"],r);const a=C(n,["startOfSpeechSensitivity"]);a!=null&&_(t,["startOfSpeechSensitivity"],a);const o=C(n,["endOfSpeechSensitivity"]);o!=null&&_(t,["endOfSpeechSensitivity"],o);const l=C(n,["prefixPaddingMs"]);l!=null&&_(t,["prefixPaddingMs"],l);const d=C(n,["silenceDurationMs"]);return d!=null&&_(t,["silenceDurationMs"],d),t}function VR(e,n){const t={},r=C(n,["disabled"]);r!=null&&_(t,["disabled"],r);const a=C(n,["startOfSpeechSensitivity"]);a!=null&&_(t,["startOfSpeechSensitivity"],a);const o=C(n,["endOfSpeechSensitivity"]);o!=null&&_(t,["endOfSpeechSensitivity"],o);const l=C(n,["prefixPaddingMs"]);l!=null&&_(t,["prefixPaddingMs"],l);const d=C(n,["silenceDurationMs"]);return d!=null&&_(t,["silenceDurationMs"],d),t}function HR(e,n){const t={},r=C(n,["automaticActivityDetection"]);r!=null&&_(t,["automaticActivityDetection"],qR(e,r));const a=C(n,["activityHandling"]);a!=null&&_(t,["activityHandling"],a);const o=C(n,["turnCoverage"]);return o!=null&&_(t,["turnCoverage"],o),t}function GR(e,n){const t={},r=C(n,["automaticActivityDetection"]);r!=null&&_(t,["automaticActivityDetection"],VR(e,r));const a=C(n,["activityHandling"]);a!=null&&_(t,["activityHandling"],a);const o=C(n,["turnCoverage"]);return o!=null&&_(t,["turnCoverage"],o),t}function YR(e,n){const t={},r=C(n,["targetTokens"]);return r!=null&&_(t,["targetTokens"],r),t}function WR(e,n){const t={},r=C(n,["targetTokens"]);return r!=null&&_(t,["targetTokens"],r),t}function QR(e,n){const t={},r=C(n,["triggerTokens"]);r!=null&&_(t,["triggerTokens"],r);const a=C(n,["slidingWindow"]);return a!=null&&_(t,["slidingWindow"],YR(e,a)),t}function JR(e,n){const t={},r=C(n,["triggerTokens"]);r!=null&&_(t,["triggerTokens"],r);const a=C(n,["slidingWindow"]);return a!=null&&_(t,["slidingWindow"],WR(e,a)),t}function KR(e,n,t){const r={},a=C(n,["generationConfig"]);t!==void 0&&a!=null&&_(t,["setup","generationConfig"],a);const o=C(n,["responseModalities"]);t!==void 0&&o!=null&&_(t,["setup","generationConfig","responseModalities"],o);const l=C(n,["temperature"]);t!==void 0&&l!=null&&_(t,["setup","generationConfig","temperature"],l);const d=C(n,["topP"]);t!==void 0&&d!=null&&_(t,["setup","generationConfig","topP"],d);const f=C(n,["topK"]);t!==void 0&&f!=null&&_(t,["setup","generationConfig","topK"],f);const u=C(n,["maxOutputTokens"]);t!==void 0&&u!=null&&_(t,["setup","generationConfig","maxOutputTokens"],u);const p=C(n,["mediaResolution"]);t!==void 0&&p!=null&&_(t,["setup","generationConfig","mediaResolution"],p);const g=C(n,["seed"]);t!==void 0&&g!=null&&_(t,["setup","generationConfig","seed"],g);const b=C(n,["speechConfig"]);t!==void 0&&b!=null&&_(t,["setup","generationConfig","speechConfig"],b);const v=C(n,["systemInstruction"]);t!==void 0&&v!=null&&_(t,["setup","systemInstruction"],kR(e,da(e,v)));const S=C(n,["tools"]);if(t!==void 0&&S!=null){let z=Sb(e,S);Array.isArray(z)&&(z=z.map(F=>$R(e,wb(e,F)))),_(t,["setup","tools"],z)}const k=C(n,["sessionResumption"]);t!==void 0&&k!=null&&_(t,["setup","sessionResumption"],UR(e,k));const T=C(n,["inputAudioTranscription"]);t!==void 0&&T!=null&&_(t,["setup","inputAudioTranscription"],SN());const A=C(n,["outputAudioTranscription"]);t!==void 0&&A!=null&&_(t,["setup","outputAudioTranscription"],SN());const M=C(n,["realtimeInputConfig"]);t!==void 0&&M!=null&&_(t,["setup","realtimeInputConfig"],HR(e,M));const R=C(n,["contextWindowCompression"]);return t!==void 0&&R!=null&&_(t,["setup","contextWindowCompression"],QR(e,R)),r}function XR(e,n,t){const r={},a=C(n,["generationConfig"]);t!==void 0&&a!=null&&_(t,["setup","generationConfig"],a);const o=C(n,["responseModalities"]);t!==void 0&&o!=null&&_(t,["setup","generationConfig","responseModalities"],o);const l=C(n,["temperature"]);t!==void 0&&l!=null&&_(t,["setup","generationConfig","temperature"],l);const d=C(n,["topP"]);t!==void 0&&d!=null&&_(t,["setup","generationConfig","topP"],d);const f=C(n,["topK"]);t!==void 0&&f!=null&&_(t,["setup","generationConfig","topK"],f);const u=C(n,["maxOutputTokens"]);t!==void 0&&u!=null&&_(t,["setup","generationConfig","maxOutputTokens"],u);const p=C(n,["mediaResolution"]);t!==void 0&&p!=null&&_(t,["setup","generationConfig","mediaResolution"],p);const g=C(n,["seed"]);t!==void 0&&g!=null&&_(t,["setup","generationConfig","seed"],g);const b=C(n,["speechConfig"]);t!==void 0&&b!=null&&_(t,["setup","generationConfig","speechConfig"],b);const v=C(n,["systemInstruction"]);t!==void 0&&v!=null&&_(t,["setup","systemInstruction"],TR(e,da(e,v)));const S=C(n,["tools"]);if(t!==void 0&&S!=null){let z=Sb(e,S);Array.isArray(z)&&(z=z.map(F=>zR(e,wb(e,F)))),_(t,["setup","tools"],z)}const k=C(n,["sessionResumption"]);t!==void 0&&k!=null&&_(t,["setup","sessionResumption"],BR(e,k));const T=C(n,["inputAudioTranscription"]);t!==void 0&&T!=null&&_(t,["setup","inputAudioTranscription"],NN());const A=C(n,["outputAudioTranscription"]);t!==void 0&&A!=null&&_(t,["setup","outputAudioTranscription"],NN());const M=C(n,["realtimeInputConfig"]);t!==void 0&&M!=null&&_(t,["setup","realtimeInputConfig"],GR(e,M));const R=C(n,["contextWindowCompression"]);return t!==void 0&&R!=null&&_(t,["setup","contextWindowCompression"],JR(e,R)),r}function ZR(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["setup","model"],mr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],KR(e,a,t)),t}function e4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["setup","model"],mr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],XR(e,a,t)),t}function t4(){return{}}function n4(){return{}}function r4(){return{}}function i4(){return{}}function a4(e,n){const t={},r=C(n,["media"]);r!=null&&_(t,["mediaChunks"],sk(e,r));const a=C(n,["audio"]);a!=null&&_(t,["audio"],iI(e,a));const o=C(n,["audioStreamEnd"]);o!=null&&_(t,["audioStreamEnd"],o);const l=C(n,["video"]);l!=null&&_(t,["video"],rI(e,l));const d=C(n,["text"]);return d!=null&&_(t,["text"],d),C(n,["activityStart"])!=null&&_(t,["activityStart"],t4()),C(n,["activityEnd"])!=null&&_(t,["activityEnd"],r4()),t}function s4(e,n){const t={},r=C(n,["media"]);if(r!=null&&_(t,["mediaChunks"],sk(e,r)),C(n,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const a=C(n,["audioStreamEnd"]);if(a!=null&&_(t,["audioStreamEnd"],a),C(n,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(C(n,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return C(n,["activityStart"])!=null&&_(t,["activityStart"],n4()),C(n,["activityEnd"])!=null&&_(t,["activityEnd"],i4()),t}function o4(){return{}}function l4(){return{}}function c4(e,n){const t={},r=C(n,["data"]);r!=null&&_(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function u4(e,n){const t={},r=C(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=C(n,["data"]);a!=null&&_(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function d4(e,n){const t={},r=C(n,["thought"]);r!=null&&_(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&_(t,["inlineData"],c4(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&_(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&_(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const p=C(n,["text"]);return p!=null&&_(t,["text"],p),t}function f4(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&_(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&_(t,["inlineData"],u4(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&_(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const p=C(n,["functionResponse"]);p!=null&&_(t,["functionResponse"],p);const g=C(n,["text"]);return g!=null&&_(t,["text"],g),t}function h4(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>d4(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function p4(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>f4(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function CN(e,n){const t={},r=C(n,["text"]);r!=null&&_(t,["text"],r);const a=C(n,["finished"]);return a!=null&&_(t,["finished"],a),t}function _N(e,n){const t={},r=C(n,["text"]);r!=null&&_(t,["text"],r);const a=C(n,["finished"]);return a!=null&&_(t,["finished"],a),t}function m4(e,n){const t={},r=C(n,["modelTurn"]);r!=null&&_(t,["modelTurn"],h4(e,r));const a=C(n,["turnComplete"]);a!=null&&_(t,["turnComplete"],a);const o=C(n,["interrupted"]);o!=null&&_(t,["interrupted"],o);const l=C(n,["groundingMetadata"]);l!=null&&_(t,["groundingMetadata"],l);const d=C(n,["generationComplete"]);d!=null&&_(t,["generationComplete"],d);const f=C(n,["inputTranscription"]);f!=null&&_(t,["inputTranscription"],CN(e,f));const u=C(n,["outputTranscription"]);return u!=null&&_(t,["outputTranscription"],CN(e,u)),t}function g4(e,n){const t={},r=C(n,["modelTurn"]);r!=null&&_(t,["modelTurn"],p4(e,r));const a=C(n,["turnComplete"]);a!=null&&_(t,["turnComplete"],a);const o=C(n,["interrupted"]);o!=null&&_(t,["interrupted"],o);const l=C(n,["groundingMetadata"]);l!=null&&_(t,["groundingMetadata"],l);const d=C(n,["generationComplete"]);d!=null&&_(t,["generationComplete"],d);const f=C(n,["inputTranscription"]);f!=null&&_(t,["inputTranscription"],_N(e,f));const u=C(n,["outputTranscription"]);return u!=null&&_(t,["outputTranscription"],_N(e,u)),t}function y4(e,n){const t={},r=C(n,["id"]);r!=null&&_(t,["id"],r);const a=C(n,["args"]);a!=null&&_(t,["args"],a);const o=C(n,["name"]);return o!=null&&_(t,["name"],o),t}function x4(e,n){const t={},r=C(n,["args"]);r!=null&&_(t,["args"],r);const a=C(n,["name"]);return a!=null&&_(t,["name"],a),t}function b4(e,n){const t={},r=C(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>y4(e,o))),_(t,["functionCalls"],a)}return t}function v4(e,n){const t={},r=C(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>x4(e,o))),_(t,["functionCalls"],a)}return t}function w4(e,n){const t={},r=C(n,["ids"]);return r!=null&&_(t,["ids"],r),t}function S4(e,n){const t={},r=C(n,["ids"]);return r!=null&&_(t,["ids"],r),t}function dx(e,n){const t={},r=C(n,["modality"]);r!=null&&_(t,["modality"],r);const a=C(n,["tokenCount"]);return a!=null&&_(t,["tokenCount"],a),t}function fx(e,n){const t={},r=C(n,["modality"]);r!=null&&_(t,["modality"],r);const a=C(n,["tokenCount"]);return a!=null&&_(t,["tokenCount"],a),t}function N4(e,n){const t={},r=C(n,["promptTokenCount"]);r!=null&&_(t,["promptTokenCount"],r);const a=C(n,["cachedContentTokenCount"]);a!=null&&_(t,["cachedContentTokenCount"],a);const o=C(n,["responseTokenCount"]);o!=null&&_(t,["responseTokenCount"],o);const l=C(n,["toolUsePromptTokenCount"]);l!=null&&_(t,["toolUsePromptTokenCount"],l);const d=C(n,["thoughtsTokenCount"]);d!=null&&_(t,["thoughtsTokenCount"],d);const f=C(n,["totalTokenCount"]);f!=null&&_(t,["totalTokenCount"],f);const u=C(n,["promptTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(S=>dx(e,S))),_(t,["promptTokensDetails"],v)}const p=C(n,["cacheTokensDetails"]);if(p!=null){let v=p;Array.isArray(v)&&(v=v.map(S=>dx(e,S))),_(t,["cacheTokensDetails"],v)}const g=C(n,["responseTokensDetails"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(S=>dx(e,S))),_(t,["responseTokensDetails"],v)}const b=C(n,["toolUsePromptTokensDetails"]);if(b!=null){let v=b;Array.isArray(v)&&(v=v.map(S=>dx(e,S))),_(t,["toolUsePromptTokensDetails"],v)}return t}function C4(e,n){const t={},r=C(n,["promptTokenCount"]);r!=null&&_(t,["promptTokenCount"],r);const a=C(n,["cachedContentTokenCount"]);a!=null&&_(t,["cachedContentTokenCount"],a);const o=C(n,["candidatesTokenCount"]);o!=null&&_(t,["responseTokenCount"],o);const l=C(n,["toolUsePromptTokenCount"]);l!=null&&_(t,["toolUsePromptTokenCount"],l);const d=C(n,["thoughtsTokenCount"]);d!=null&&_(t,["thoughtsTokenCount"],d);const f=C(n,["totalTokenCount"]);f!=null&&_(t,["totalTokenCount"],f);const u=C(n,["promptTokensDetails"]);if(u!=null){let S=u;Array.isArray(S)&&(S=S.map(k=>fx(e,k))),_(t,["promptTokensDetails"],S)}const p=C(n,["cacheTokensDetails"]);if(p!=null){let S=p;Array.isArray(S)&&(S=S.map(k=>fx(e,k))),_(t,["cacheTokensDetails"],S)}const g=C(n,["candidatesTokensDetails"]);if(g!=null){let S=g;Array.isArray(S)&&(S=S.map(k=>fx(e,k))),_(t,["responseTokensDetails"],S)}const b=C(n,["toolUsePromptTokensDetails"]);if(b!=null){let S=b;Array.isArray(S)&&(S=S.map(k=>fx(e,k))),_(t,["toolUsePromptTokensDetails"],S)}const v=C(n,["trafficType"]);return v!=null&&_(t,["trafficType"],v),t}function _4(e,n){const t={},r=C(n,["timeLeft"]);return r!=null&&_(t,["timeLeft"],r),t}function j4(e,n){const t={},r=C(n,["timeLeft"]);return r!=null&&_(t,["timeLeft"],r),t}function k4(e,n){const t={},r=C(n,["newHandle"]);r!=null&&_(t,["newHandle"],r);const a=C(n,["resumable"]);a!=null&&_(t,["resumable"],a);const o=C(n,["lastConsumedClientMessageIndex"]);return o!=null&&_(t,["lastConsumedClientMessageIndex"],o),t}function T4(e,n){const t={},r=C(n,["newHandle"]);r!=null&&_(t,["newHandle"],r);const a=C(n,["resumable"]);a!=null&&_(t,["resumable"],a);const o=C(n,["lastConsumedClientMessageIndex"]);return o!=null&&_(t,["lastConsumedClientMessageIndex"],o),t}function E4(e,n){const t={};C(n,["setupComplete"])!=null&&_(t,["setupComplete"],o4());const a=C(n,["serverContent"]);a!=null&&_(t,["serverContent"],m4(e,a));const o=C(n,["toolCall"]);o!=null&&_(t,["toolCall"],b4(e,o));const l=C(n,["toolCallCancellation"]);l!=null&&_(t,["toolCallCancellation"],w4(e,l));const d=C(n,["usageMetadata"]);d!=null&&_(t,["usageMetadata"],N4(e,d));const f=C(n,["goAway"]);f!=null&&_(t,["goAway"],_4(e,f));const u=C(n,["sessionResumptionUpdate"]);return u!=null&&_(t,["sessionResumptionUpdate"],k4(e,u)),t}function A4(e,n){const t={};C(n,["setupComplete"])!=null&&_(t,["setupComplete"],l4());const a=C(n,["serverContent"]);a!=null&&_(t,["serverContent"],g4(e,a));const o=C(n,["toolCall"]);o!=null&&_(t,["toolCall"],v4(e,o));const l=C(n,["toolCallCancellation"]);l!=null&&_(t,["toolCallCancellation"],S4(e,l));const d=C(n,["usageMetadata"]);d!=null&&_(t,["usageMetadata"],C4(e,d));const f=C(n,["goAway"]);f!=null&&_(t,["goAway"],j4(e,f));const u=C(n,["sessionResumptionUpdate"]);return u!=null&&_(t,["sessionResumptionUpdate"],T4(e,u)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function P4(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&_(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function D4(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&_(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&_(t,["inlineData"],P4(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&_(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&_(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const p=C(n,["text"]);return p!=null&&_(t,["text"],p),t}function Cb(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>D4(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function I4(e,n){const t={};if(C(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=C(n,["category"]);r!=null&&_(t,["category"],r);const a=C(n,["threshold"]);return a!=null&&_(t,["threshold"],a),t}function R4(){return{}}function M4(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function O4(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],M4(e,r)),t}function L4(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&_(t,["googleSearch"],R4());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&_(t,["googleSearchRetrieval"],O4(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&_(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&_(t,["functionDeclarations"],l),t}function F4(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function $4(e,n){const t={},r=C(n,["functionCallingConfig"]);if(r!=null&&_(t,["functionCallingConfig"],F4(e,r)),C(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function z4(e,n){const t={},r=C(n,["voiceName"]);return r!=null&&_(t,["voiceName"],r),t}function U4(e,n){const t={},r=C(n,["prebuiltVoiceConfig"]);return r!=null&&_(t,["prebuiltVoiceConfig"],z4(e,r)),t}function B4(e,n){const t={},r=C(n,["voiceConfig"]);r!=null&&_(t,["voiceConfig"],U4(e,r));const a=C(n,["languageCode"]);return a!=null&&_(t,["languageCode"],a),t}function q4(e,n){const t={},r=C(n,["includeThoughts"]);r!=null&&_(t,["includeThoughts"],r);const a=C(n,["thinkingBudget"]);return a!=null&&_(t,["thinkingBudget"],a),t}function V4(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&_(t,["systemInstruction"],Cb(e,da(e,a)));const o=C(n,["temperature"]);o!=null&&_(r,["temperature"],o);const l=C(n,["topP"]);l!=null&&_(r,["topP"],l);const d=C(n,["topK"]);d!=null&&_(r,["topK"],d);const f=C(n,["candidateCount"]);f!=null&&_(r,["candidateCount"],f);const u=C(n,["maxOutputTokens"]);u!=null&&_(r,["maxOutputTokens"],u);const p=C(n,["stopSequences"]);p!=null&&_(r,["stopSequences"],p);const g=C(n,["responseLogprobs"]);g!=null&&_(r,["responseLogprobs"],g);const b=C(n,["logprobs"]);b!=null&&_(r,["logprobs"],b);const v=C(n,["presencePenalty"]);v!=null&&_(r,["presencePenalty"],v);const S=C(n,["frequencyPenalty"]);S!=null&&_(r,["frequencyPenalty"],S);const k=C(n,["seed"]);k!=null&&_(r,["seed"],k);const T=C(n,["responseMimeType"]);T!=null&&_(r,["responseMimeType"],T);const A=C(n,["responseSchema"]);if(A!=null&&_(r,["responseSchema"],ck(e,A)),C(n,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(C(n,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const M=C(n,["safetySettings"]);if(t!==void 0&&M!=null){let D=M;Array.isArray(D)&&(D=D.map($=>I4(e,$))),_(t,["safetySettings"],D)}const R=C(n,["tools"]);if(t!==void 0&&R!=null){let D=Sb(e,R);Array.isArray(D)&&(D=D.map($=>L4(e,wb(e,$)))),_(t,["tools"],D)}const z=C(n,["toolConfig"]);if(t!==void 0&&z!=null&&_(t,["toolConfig"],$4(e,z)),C(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const F=C(n,["cachedContent"]);t!==void 0&&F!=null&&_(t,["cachedContent"],pu(e,F));const L=C(n,["responseModalities"]);L!=null&&_(r,["responseModalities"],L);const U=C(n,["mediaResolution"]);U!=null&&_(r,["mediaResolution"],U);const B=C(n,["speechConfig"]);if(B!=null&&_(r,["speechConfig"],B4(e,uk(e,B))),C(n,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const J=C(n,["thinkingConfig"]);return J!=null&&_(r,["thinkingConfig"],q4(e,J)),r}function jN(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],mr(e,r));const a=C(n,["contents"]);if(a!=null){let l=hu(e,a);Array.isArray(l)&&(l=l.map(d=>Cb(e,d))),_(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&_(t,["generationConfig"],V4(e,o,t)),t}function H4(e,n,t){const r={},a=C(n,["taskType"]);t!==void 0&&a!=null&&_(t,["requests[]","taskType"],a);const o=C(n,["title"]);t!==void 0&&o!=null&&_(t,["requests[]","title"],o);const l=C(n,["outputDimensionality"]);if(t!==void 0&&l!=null&&_(t,["requests[]","outputDimensionality"],l),C(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(C(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function G4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],mr(e,r));const a=C(n,["contents"]);a!=null&&_(t,["requests[]","content"],lk(e,a));const o=C(n,["config"]);o!=null&&_(t,["config"],H4(e,o,t));const l=C(n,["model"]);return l!==void 0&&_(t,["requests[]","model"],mr(e,l)),t}function Y4(e,n,t){const r={};if(C(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(C(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const a=C(n,["numberOfImages"]);t!==void 0&&a!=null&&_(t,["parameters","sampleCount"],a);const o=C(n,["aspectRatio"]);t!==void 0&&o!=null&&_(t,["parameters","aspectRatio"],o);const l=C(n,["guidanceScale"]);if(t!==void 0&&l!=null&&_(t,["parameters","guidanceScale"],l),C(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const d=C(n,["safetyFilterLevel"]);t!==void 0&&d!=null&&_(t,["parameters","safetySetting"],d);const f=C(n,["personGeneration"]);t!==void 0&&f!=null&&_(t,["parameters","personGeneration"],f);const u=C(n,["includeSafetyAttributes"]);t!==void 0&&u!=null&&_(t,["parameters","includeSafetyAttributes"],u);const p=C(n,["includeRaiReason"]);t!==void 0&&p!=null&&_(t,["parameters","includeRaiReason"],p);const g=C(n,["language"]);t!==void 0&&g!=null&&_(t,["parameters","language"],g);const b=C(n,["outputMimeType"]);t!==void 0&&b!=null&&_(t,["parameters","outputOptions","mimeType"],b);const v=C(n,["outputCompressionQuality"]);if(t!==void 0&&v!=null&&_(t,["parameters","outputOptions","compressionQuality"],v),C(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(C(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function W4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],mr(e,r));const a=C(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=C(n,["config"]);return o!=null&&_(t,["config"],Y4(e,o,t)),t}function Q4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","name"],mr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function J4(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&_(t,["_query","pageToken"],o);const l=C(n,["filter"]);t!==void 0&&l!=null&&_(t,["_query","filter"],l);const d=C(n,["queryBase"]);return t!==void 0&&d!=null&&_(t,["_url","models_url"],hk(e,d)),r}function K4(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],J4(e,r,t)),t}function X4(e,n,t){const r={},a=C(n,["displayName"]);t!==void 0&&a!=null&&_(t,["displayName"],a);const o=C(n,["description"]);t!==void 0&&o!=null&&_(t,["description"],o);const l=C(n,["defaultCheckpointId"]);return t!==void 0&&l!=null&&_(t,["defaultCheckpointId"],l),r}function Z4(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","name"],mr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],X4(e,a,t)),t}function eM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","name"],mr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function tM(e,n){const t={};if(C(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(C(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(C(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function nM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],mr(e,r));const a=C(n,["contents"]);if(a!=null){let l=hu(e,a);Array.isArray(l)&&(l=l.map(d=>Cb(e,d))),_(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&_(t,["config"],tM(e,o)),t}function rM(e,n){const t={};if(C(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=C(n,["imageBytes"]);r!=null&&_(t,["bytesBase64Encoded"],mu(e,r));const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function iM(e,n,t){const r={},a=C(n,["numberOfVideos"]);if(t!==void 0&&a!=null&&_(t,["parameters","sampleCount"],a),C(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(C(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=C(n,["durationSeconds"]);if(t!==void 0&&o!=null&&_(t,["parameters","durationSeconds"],o),C(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=C(n,["aspectRatio"]);if(t!==void 0&&l!=null&&_(t,["parameters","aspectRatio"],l),C(n,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const d=C(n,["personGeneration"]);if(t!==void 0&&d!=null&&_(t,["parameters","personGeneration"],d),C(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const f=C(n,["negativePrompt"]);if(t!==void 0&&f!=null&&_(t,["parameters","negativePrompt"],f),C(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function aM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],mr(e,r));const a=C(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=C(n,["image"]);o!=null&&_(t,["instances[0]","image"],rM(e,o));const l=C(n,["config"]);return l!=null&&_(t,["config"],iM(e,l,t)),t}function sM(e,n){const t={},r=C(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=C(n,["data"]);a!=null&&_(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function oM(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&_(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&_(t,["inlineData"],sM(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&_(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const p=C(n,["functionResponse"]);p!=null&&_(t,["functionResponse"],p);const g=C(n,["text"]);return g!=null&&_(t,["text"],g),t}function Uh(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>oM(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function lM(e,n){const t={},r=C(n,["featureSelectionPreference"]);return r!=null&&_(t,["featureSelectionPreference"],r),t}function cM(e,n){const t={},r=C(n,["method"]);r!=null&&_(t,["method"],r);const a=C(n,["category"]);a!=null&&_(t,["category"],a);const o=C(n,["threshold"]);return o!=null&&_(t,["threshold"],o),t}function uM(){return{}}function dM(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function fM(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],dM(e,r)),t}function hM(){return{}}function pM(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&_(t,["apiKeyString"],r),t}function mM(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&_(t,["apiKeyConfig"],pM(e,r));const a=C(n,["authType"]);a!=null&&_(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&_(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&_(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&_(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&_(t,["oidcConfig"],f),t}function gM(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&_(t,["authConfig"],mM(e,r)),t}function gk(e,n){const t={},r=C(n,["retrieval"]);r!=null&&_(t,["retrieval"],r),C(n,["googleSearch"])!=null&&_(t,["googleSearch"],uM());const o=C(n,["googleSearchRetrieval"]);o!=null&&_(t,["googleSearchRetrieval"],fM(e,o)),C(n,["enterpriseWebSearch"])!=null&&_(t,["enterpriseWebSearch"],hM());const d=C(n,["googleMaps"]);d!=null&&_(t,["googleMaps"],gM(e,d));const f=C(n,["codeExecution"]);f!=null&&_(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&_(t,["functionDeclarations"],u),t}function yM(e,n){const t={},r=C(n,["mode"]);r!=null&&_(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function xM(e,n){const t={},r=C(n,["latitude"]);r!=null&&_(t,["latitude"],r);const a=C(n,["longitude"]);return a!=null&&_(t,["longitude"],a),t}function bM(e,n){const t={},r=C(n,["latLng"]);return r!=null&&_(t,["latLng"],xM(e,r)),t}function vM(e,n){const t={},r=C(n,["functionCallingConfig"]);r!=null&&_(t,["functionCallingConfig"],yM(e,r));const a=C(n,["retrievalConfig"]);return a!=null&&_(t,["retrievalConfig"],bM(e,a)),t}function wM(e,n){const t={},r=C(n,["voiceName"]);return r!=null&&_(t,["voiceName"],r),t}function SM(e,n){const t={},r=C(n,["prebuiltVoiceConfig"]);return r!=null&&_(t,["prebuiltVoiceConfig"],wM(e,r)),t}function NM(e,n){const t={},r=C(n,["voiceConfig"]);r!=null&&_(t,["voiceConfig"],SM(e,r));const a=C(n,["languageCode"]);return a!=null&&_(t,["languageCode"],a),t}function CM(e,n){const t={},r=C(n,["includeThoughts"]);r!=null&&_(t,["includeThoughts"],r);const a=C(n,["thinkingBudget"]);return a!=null&&_(t,["thinkingBudget"],a),t}function _M(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&_(t,["systemInstruction"],Uh(e,da(e,a)));const o=C(n,["temperature"]);o!=null&&_(r,["temperature"],o);const l=C(n,["topP"]);l!=null&&_(r,["topP"],l);const d=C(n,["topK"]);d!=null&&_(r,["topK"],d);const f=C(n,["candidateCount"]);f!=null&&_(r,["candidateCount"],f);const u=C(n,["maxOutputTokens"]);u!=null&&_(r,["maxOutputTokens"],u);const p=C(n,["stopSequences"]);p!=null&&_(r,["stopSequences"],p);const g=C(n,["responseLogprobs"]);g!=null&&_(r,["responseLogprobs"],g);const b=C(n,["logprobs"]);b!=null&&_(r,["logprobs"],b);const v=C(n,["presencePenalty"]);v!=null&&_(r,["presencePenalty"],v);const S=C(n,["frequencyPenalty"]);S!=null&&_(r,["frequencyPenalty"],S);const k=C(n,["seed"]);k!=null&&_(r,["seed"],k);const T=C(n,["responseMimeType"]);T!=null&&_(r,["responseMimeType"],T);const A=C(n,["responseSchema"]);A!=null&&_(r,["responseSchema"],ck(e,A));const M=C(n,["routingConfig"]);M!=null&&_(r,["routingConfig"],M);const R=C(n,["modelSelectionConfig"]);R!=null&&_(r,["modelConfig"],lM(e,R));const z=C(n,["safetySettings"]);if(t!==void 0&&z!=null){let Q=z;Array.isArray(Q)&&(Q=Q.map(Y=>cM(e,Y))),_(t,["safetySettings"],Q)}const F=C(n,["tools"]);if(t!==void 0&&F!=null){let Q=Sb(e,F);Array.isArray(Q)&&(Q=Q.map(Y=>gk(e,wb(e,Y)))),_(t,["tools"],Q)}const L=C(n,["toolConfig"]);t!==void 0&&L!=null&&_(t,["toolConfig"],vM(e,L));const U=C(n,["labels"]);t!==void 0&&U!=null&&_(t,["labels"],U);const B=C(n,["cachedContent"]);t!==void 0&&B!=null&&_(t,["cachedContent"],pu(e,B));const J=C(n,["responseModalities"]);J!=null&&_(r,["responseModalities"],J);const D=C(n,["mediaResolution"]);D!=null&&_(r,["mediaResolution"],D);const $=C(n,["speechConfig"]);$!=null&&_(r,["speechConfig"],NM(e,uk(e,$)));const H=C(n,["audioTimestamp"]);H!=null&&_(r,["audioTimestamp"],H);const te=C(n,["thinkingConfig"]);return te!=null&&_(r,["thinkingConfig"],CM(e,te)),r}function kN(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],mr(e,r));const a=C(n,["contents"]);if(a!=null){let l=hu(e,a);Array.isArray(l)&&(l=l.map(d=>Uh(e,d))),_(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&_(t,["generationConfig"],_M(e,o,t)),t}function jM(e,n,t){const r={},a=C(n,["taskType"]);t!==void 0&&a!=null&&_(t,["instances[]","task_type"],a);const o=C(n,["title"]);t!==void 0&&o!=null&&_(t,["instances[]","title"],o);const l=C(n,["outputDimensionality"]);t!==void 0&&l!=null&&_(t,["parameters","outputDimensionality"],l);const d=C(n,["mimeType"]);t!==void 0&&d!=null&&_(t,["instances[]","mimeType"],d);const f=C(n,["autoTruncate"]);return t!==void 0&&f!=null&&_(t,["parameters","autoTruncate"],f),r}function kM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],mr(e,r));const a=C(n,["contents"]);a!=null&&_(t,["instances[]","content"],lk(e,a));const o=C(n,["config"]);return o!=null&&_(t,["config"],jM(e,o,t)),t}function TM(e,n,t){const r={},a=C(n,["outputGcsUri"]);t!==void 0&&a!=null&&_(t,["parameters","storageUri"],a);const o=C(n,["negativePrompt"]);t!==void 0&&o!=null&&_(t,["parameters","negativePrompt"],o);const l=C(n,["numberOfImages"]);t!==void 0&&l!=null&&_(t,["parameters","sampleCount"],l);const d=C(n,["aspectRatio"]);t!==void 0&&d!=null&&_(t,["parameters","aspectRatio"],d);const f=C(n,["guidanceScale"]);t!==void 0&&f!=null&&_(t,["parameters","guidanceScale"],f);const u=C(n,["seed"]);t!==void 0&&u!=null&&_(t,["parameters","seed"],u);const p=C(n,["safetyFilterLevel"]);t!==void 0&&p!=null&&_(t,["parameters","safetySetting"],p);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&_(t,["parameters","personGeneration"],g);const b=C(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&_(t,["parameters","includeSafetyAttributes"],b);const v=C(n,["includeRaiReason"]);t!==void 0&&v!=null&&_(t,["parameters","includeRaiReason"],v);const S=C(n,["language"]);t!==void 0&&S!=null&&_(t,["parameters","language"],S);const k=C(n,["outputMimeType"]);t!==void 0&&k!=null&&_(t,["parameters","outputOptions","mimeType"],k);const T=C(n,["outputCompressionQuality"]);t!==void 0&&T!=null&&_(t,["parameters","outputOptions","compressionQuality"],T);const A=C(n,["addWatermark"]);t!==void 0&&A!=null&&_(t,["parameters","addWatermark"],A);const M=C(n,["enhancePrompt"]);return t!==void 0&&M!=null&&_(t,["parameters","enhancePrompt"],M),r}function EM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],mr(e,r));const a=C(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=C(n,["config"]);return o!=null&&_(t,["config"],TM(e,o,t)),t}function dw(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&_(t,["gcsUri"],r);const a=C(n,["imageBytes"]);a!=null&&_(t,["bytesBase64Encoded"],mu(e,a));const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function AM(e,n){const t={},r=C(n,["maskMode"]);r!=null&&_(t,["maskMode"],r);const a=C(n,["segmentationClasses"]);a!=null&&_(t,["maskClasses"],a);const o=C(n,["maskDilation"]);return o!=null&&_(t,["dilation"],o),t}function PM(e,n){const t={},r=C(n,["controlType"]);r!=null&&_(t,["controlType"],r);const a=C(n,["enableControlImageComputation"]);return a!=null&&_(t,["computeControl"],a),t}function DM(e,n){const t={},r=C(n,["styleDescription"]);return r!=null&&_(t,["styleDescription"],r),t}function IM(e,n){const t={},r=C(n,["subjectType"]);r!=null&&_(t,["subjectType"],r);const a=C(n,["subjectDescription"]);return a!=null&&_(t,["subjectDescription"],a),t}function RM(e,n){const t={},r=C(n,["referenceImage"]);r!=null&&_(t,["referenceImage"],dw(e,r));const a=C(n,["referenceId"]);a!=null&&_(t,["referenceId"],a);const o=C(n,["referenceType"]);o!=null&&_(t,["referenceType"],o);const l=C(n,["maskImageConfig"]);l!=null&&_(t,["maskImageConfig"],AM(e,l));const d=C(n,["controlImageConfig"]);d!=null&&_(t,["controlImageConfig"],PM(e,d));const f=C(n,["styleImageConfig"]);f!=null&&_(t,["styleImageConfig"],DM(e,f));const u=C(n,["subjectImageConfig"]);return u!=null&&_(t,["subjectImageConfig"],IM(e,u)),t}function MM(e,n,t){const r={},a=C(n,["outputGcsUri"]);t!==void 0&&a!=null&&_(t,["parameters","storageUri"],a);const o=C(n,["negativePrompt"]);t!==void 0&&o!=null&&_(t,["parameters","negativePrompt"],o);const l=C(n,["numberOfImages"]);t!==void 0&&l!=null&&_(t,["parameters","sampleCount"],l);const d=C(n,["aspectRatio"]);t!==void 0&&d!=null&&_(t,["parameters","aspectRatio"],d);const f=C(n,["guidanceScale"]);t!==void 0&&f!=null&&_(t,["parameters","guidanceScale"],f);const u=C(n,["seed"]);t!==void 0&&u!=null&&_(t,["parameters","seed"],u);const p=C(n,["safetyFilterLevel"]);t!==void 0&&p!=null&&_(t,["parameters","safetySetting"],p);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&_(t,["parameters","personGeneration"],g);const b=C(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&_(t,["parameters","includeSafetyAttributes"],b);const v=C(n,["includeRaiReason"]);t!==void 0&&v!=null&&_(t,["parameters","includeRaiReason"],v);const S=C(n,["language"]);t!==void 0&&S!=null&&_(t,["parameters","language"],S);const k=C(n,["outputMimeType"]);t!==void 0&&k!=null&&_(t,["parameters","outputOptions","mimeType"],k);const T=C(n,["outputCompressionQuality"]);t!==void 0&&T!=null&&_(t,["parameters","outputOptions","compressionQuality"],T);const A=C(n,["editMode"]);t!==void 0&&A!=null&&_(t,["parameters","editMode"],A);const M=C(n,["baseSteps"]);return t!==void 0&&M!=null&&_(t,["parameters","editConfig","baseSteps"],M),r}function OM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],mr(e,r));const a=C(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=C(n,["referenceImages"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>RM(e,f))),_(t,["instances[0]","referenceImages"],d)}const l=C(n,["config"]);return l!=null&&_(t,["config"],MM(e,l,t)),t}function LM(e,n,t){const r={},a=C(n,["includeRaiReason"]);t!==void 0&&a!=null&&_(t,["parameters","includeRaiReason"],a);const o=C(n,["outputMimeType"]);t!==void 0&&o!=null&&_(t,["parameters","outputOptions","mimeType"],o);const l=C(n,["outputCompressionQuality"]);t!==void 0&&l!=null&&_(t,["parameters","outputOptions","compressionQuality"],l);const d=C(n,["numberOfImages"]);t!==void 0&&d!=null&&_(t,["parameters","sampleCount"],d);const f=C(n,["mode"]);return t!==void 0&&f!=null&&_(t,["parameters","mode"],f),r}function FM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],mr(e,r));const a=C(n,["image"]);a!=null&&_(t,["instances[0]","image"],dw(e,a));const o=C(n,["upscaleFactor"]);o!=null&&_(t,["parameters","upscaleConfig","upscaleFactor"],o);const l=C(n,["config"]);return l!=null&&_(t,["config"],LM(e,l,t)),t}function $M(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","name"],mr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function zM(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&_(t,["_query","pageToken"],o);const l=C(n,["filter"]);t!==void 0&&l!=null&&_(t,["_query","filter"],l);const d=C(n,["queryBase"]);return t!==void 0&&d!=null&&_(t,["_url","models_url"],hk(e,d)),r}function UM(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],zM(e,r,t)),t}function BM(e,n,t){const r={},a=C(n,["displayName"]);t!==void 0&&a!=null&&_(t,["displayName"],a);const o=C(n,["description"]);t!==void 0&&o!=null&&_(t,["description"],o);const l=C(n,["defaultCheckpointId"]);return t!==void 0&&l!=null&&_(t,["defaultCheckpointId"],l),r}function qM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],mr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],BM(e,a,t)),t}function VM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","name"],mr(e,r));const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function HM(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&_(t,["systemInstruction"],Uh(e,da(e,a)));const o=C(n,["tools"]);if(t!==void 0&&o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>gk(e,f))),_(t,["tools"],d)}const l=C(n,["generationConfig"]);return t!==void 0&&l!=null&&_(t,["generationConfig"],l),r}function GM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],mr(e,r));const a=C(n,["contents"]);if(a!=null){let l=hu(e,a);Array.isArray(l)&&(l=l.map(d=>Uh(e,d))),_(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&_(t,["config"],HM(e,o,t)),t}function YM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],mr(e,r));const a=C(n,["contents"]);if(a!=null){let l=hu(e,a);Array.isArray(l)&&(l=l.map(d=>Uh(e,d))),_(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&_(t,["config"],o),t}function WM(e,n,t){const r={},a=C(n,["numberOfVideos"]);t!==void 0&&a!=null&&_(t,["parameters","sampleCount"],a);const o=C(n,["outputGcsUri"]);t!==void 0&&o!=null&&_(t,["parameters","storageUri"],o);const l=C(n,["fps"]);t!==void 0&&l!=null&&_(t,["parameters","fps"],l);const d=C(n,["durationSeconds"]);t!==void 0&&d!=null&&_(t,["parameters","durationSeconds"],d);const f=C(n,["seed"]);t!==void 0&&f!=null&&_(t,["parameters","seed"],f);const u=C(n,["aspectRatio"]);t!==void 0&&u!=null&&_(t,["parameters","aspectRatio"],u);const p=C(n,["resolution"]);t!==void 0&&p!=null&&_(t,["parameters","resolution"],p);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&_(t,["parameters","personGeneration"],g);const b=C(n,["pubsubTopic"]);t!==void 0&&b!=null&&_(t,["parameters","pubsubTopic"],b);const v=C(n,["negativePrompt"]);t!==void 0&&v!=null&&_(t,["parameters","negativePrompt"],v);const S=C(n,["enhancePrompt"]);return t!==void 0&&S!=null&&_(t,["parameters","enhancePrompt"],S),r}function QM(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["_url","model"],mr(e,r));const a=C(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=C(n,["image"]);o!=null&&_(t,["instances[0]","image"],dw(e,o));const l=C(n,["config"]);return l!=null&&_(t,["config"],WM(e,l,t)),t}function JM(e,n){const t={},r=C(n,["data"]);r!=null&&_(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function KM(e,n){const t={},r=C(n,["thought"]);r!=null&&_(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&_(t,["inlineData"],JM(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&_(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&_(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const p=C(n,["text"]);return p!=null&&_(t,["text"],p),t}function XM(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>KM(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function ZM(e,n){const t={},r=C(n,["citationSources"]);return r!=null&&_(t,["citations"],r),t}function eO(e,n){const t={},r=C(n,["content"]);r!=null&&_(t,["content"],XM(e,r));const a=C(n,["citationMetadata"]);a!=null&&_(t,["citationMetadata"],ZM(e,a));const o=C(n,["tokenCount"]);o!=null&&_(t,["tokenCount"],o);const l=C(n,["finishReason"]);l!=null&&_(t,["finishReason"],l);const d=C(n,["avgLogprobs"]);d!=null&&_(t,["avgLogprobs"],d);const f=C(n,["groundingMetadata"]);f!=null&&_(t,["groundingMetadata"],f);const u=C(n,["index"]);u!=null&&_(t,["index"],u);const p=C(n,["logprobsResult"]);p!=null&&_(t,["logprobsResult"],p);const g=C(n,["safetyRatings"]);return g!=null&&_(t,["safetyRatings"],g),t}function TN(e,n){const t={},r=C(n,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(f=>eO(e,f))),_(t,["candidates"],d)}const a=C(n,["modelVersion"]);a!=null&&_(t,["modelVersion"],a);const o=C(n,["promptFeedback"]);o!=null&&_(t,["promptFeedback"],o);const l=C(n,["usageMetadata"]);return l!=null&&_(t,["usageMetadata"],l),t}function tO(e,n){const t={},r=C(n,["values"]);return r!=null&&_(t,["values"],r),t}function nO(){return{}}function rO(e,n){const t={},r=C(n,["embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>tO(e,l))),_(t,["embeddings"],o)}return C(n,["metadata"])!=null&&_(t,["metadata"],nO()),t}function iO(e,n){const t={},r=C(n,["bytesBase64Encoded"]);r!=null&&_(t,["imageBytes"],mu(e,r));const a=C(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function yk(e,n){const t={},r=C(n,["safetyAttributes","categories"]);r!=null&&_(t,["categories"],r);const a=C(n,["safetyAttributes","scores"]);a!=null&&_(t,["scores"],a);const o=C(n,["contentType"]);return o!=null&&_(t,["contentType"],o),t}function aO(e,n){const t={},r=C(n,["_self"]);r!=null&&_(t,["image"],iO(e,r));const a=C(n,["raiFilteredReason"]);a!=null&&_(t,["raiFilteredReason"],a);const o=C(n,["_self"]);return o!=null&&_(t,["safetyAttributes"],yk(e,o)),t}function sO(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>aO(e,l))),_(t,["generatedImages"],o)}const a=C(n,["positivePromptSafetyAttributes"]);return a!=null&&_(t,["positivePromptSafetyAttributes"],yk(e,a)),t}function oO(e,n){const t={},r=C(n,["baseModel"]);r!=null&&_(t,["baseModel"],r);const a=C(n,["createTime"]);a!=null&&_(t,["createTime"],a);const o=C(n,["updateTime"]);return o!=null&&_(t,["updateTime"],o),t}function a1(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["description"]);o!=null&&_(t,["description"],o);const l=C(n,["version"]);l!=null&&_(t,["version"],l);const d=C(n,["_self"]);d!=null&&_(t,["tunedModelInfo"],oO(e,d));const f=C(n,["inputTokenLimit"]);f!=null&&_(t,["inputTokenLimit"],f);const u=C(n,["outputTokenLimit"]);u!=null&&_(t,["outputTokenLimit"],u);const p=C(n,["supportedGenerationMethods"]);return p!=null&&_(t,["supportedActions"],p),t}function lO(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["_self"]);if(a!=null){let o=pk(e,a);Array.isArray(o)&&(o=o.map(l=>a1(e,l))),_(t,["models"],o)}return t}function cO(){return{}}function uO(e,n){const t={},r=C(n,["totalTokens"]);r!=null&&_(t,["totalTokens"],r);const a=C(n,["cachedContentTokenCount"]);return a!=null&&_(t,["cachedContentTokenCount"],a),t}function dO(e,n){const t={},r=C(n,["video","uri"]);r!=null&&_(t,["uri"],r);const a=C(n,["video","encodedVideo"]);a!=null&&_(t,["videoBytes"],mu(e,a));const o=C(n,["encoding"]);return o!=null&&_(t,["mimeType"],o),t}function fO(e,n){const t={},r=C(n,["_self"]);return r!=null&&_(t,["video"],dO(e,r)),t}function hO(e,n){const t={},r=C(n,["generatedSamples"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(d=>fO(e,d))),_(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&_(t,["raiMediaFilteredReasons"],o),t}function pO(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=C(n,["done"]);o!=null&&_(t,["done"],o);const l=C(n,["error"]);l!=null&&_(t,["error"],l);const d=C(n,["response","generateVideoResponse"]);return d!=null&&_(t,["response"],hO(e,d)),t}function mO(e,n){const t={},r=C(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=C(n,["data"]);a!=null&&_(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function gO(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&_(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&_(t,["inlineData"],mO(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&_(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&_(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const p=C(n,["functionResponse"]);p!=null&&_(t,["functionResponse"],p);const g=C(n,["text"]);return g!=null&&_(t,["text"],g),t}function yO(e,n){const t={},r=C(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>gO(e,l))),_(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&_(t,["role"],a),t}function xO(e,n){const t={},r=C(n,["citations"]);return r!=null&&_(t,["citations"],r),t}function bO(e,n){const t={},r=C(n,["content"]);r!=null&&_(t,["content"],yO(e,r));const a=C(n,["citationMetadata"]);a!=null&&_(t,["citationMetadata"],xO(e,a));const o=C(n,["finishMessage"]);o!=null&&_(t,["finishMessage"],o);const l=C(n,["finishReason"]);l!=null&&_(t,["finishReason"],l);const d=C(n,["avgLogprobs"]);d!=null&&_(t,["avgLogprobs"],d);const f=C(n,["groundingMetadata"]);f!=null&&_(t,["groundingMetadata"],f);const u=C(n,["index"]);u!=null&&_(t,["index"],u);const p=C(n,["logprobsResult"]);p!=null&&_(t,["logprobsResult"],p);const g=C(n,["safetyRatings"]);return g!=null&&_(t,["safetyRatings"],g),t}function EN(e,n){const t={},r=C(n,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(p=>bO(e,p))),_(t,["candidates"],u)}const a=C(n,["createTime"]);a!=null&&_(t,["createTime"],a);const o=C(n,["responseId"]);o!=null&&_(t,["responseId"],o);const l=C(n,["modelVersion"]);l!=null&&_(t,["modelVersion"],l);const d=C(n,["promptFeedback"]);d!=null&&_(t,["promptFeedback"],d);const f=C(n,["usageMetadata"]);return f!=null&&_(t,["usageMetadata"],f),t}function vO(e,n){const t={},r=C(n,["truncated"]);r!=null&&_(t,["truncated"],r);const a=C(n,["token_count"]);return a!=null&&_(t,["tokenCount"],a),t}function wO(e,n){const t={},r=C(n,["values"]);r!=null&&_(t,["values"],r);const a=C(n,["statistics"]);return a!=null&&_(t,["statistics"],vO(e,a)),t}function SO(e,n){const t={},r=C(n,["billableCharacterCount"]);return r!=null&&_(t,["billableCharacterCount"],r),t}function NO(e,n){const t={},r=C(n,["predictions[]","embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>wO(e,l))),_(t,["embeddings"],o)}const a=C(n,["metadata"]);return a!=null&&_(t,["metadata"],SO(e,a)),t}function CO(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&_(t,["gcsUri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&_(t,["imageBytes"],mu(e,a));const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function xk(e,n){const t={},r=C(n,["safetyAttributes","categories"]);r!=null&&_(t,["categories"],r);const a=C(n,["safetyAttributes","scores"]);a!=null&&_(t,["scores"],a);const o=C(n,["contentType"]);return o!=null&&_(t,["contentType"],o),t}function fw(e,n){const t={},r=C(n,["_self"]);r!=null&&_(t,["image"],CO(e,r));const a=C(n,["raiFilteredReason"]);a!=null&&_(t,["raiFilteredReason"],a);const o=C(n,["_self"]);o!=null&&_(t,["safetyAttributes"],xk(e,o));const l=C(n,["prompt"]);return l!=null&&_(t,["enhancedPrompt"],l),t}function _O(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>fw(e,l))),_(t,["generatedImages"],o)}const a=C(n,["positivePromptSafetyAttributes"]);return a!=null&&_(t,["positivePromptSafetyAttributes"],xk(e,a)),t}function jO(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>fw(e,o))),_(t,["generatedImages"],a)}return t}function kO(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>fw(e,o))),_(t,["generatedImages"],a)}return t}function TO(e,n){const t={},r=C(n,["endpoint"]);r!=null&&_(t,["name"],r);const a=C(n,["deployedModelId"]);return a!=null&&_(t,["deployedModelId"],a),t}function EO(e,n){const t={},r=C(n,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&_(t,["baseModel"],r);const a=C(n,["createTime"]);a!=null&&_(t,["createTime"],a);const o=C(n,["updateTime"]);return o!=null&&_(t,["updateTime"],o),t}function AO(e,n){const t={},r=C(n,["checkpointId"]);r!=null&&_(t,["checkpointId"],r);const a=C(n,["epoch"]);a!=null&&_(t,["epoch"],a);const o=C(n,["step"]);return o!=null&&_(t,["step"],o),t}function s1(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=C(n,["description"]);o!=null&&_(t,["description"],o);const l=C(n,["versionId"]);l!=null&&_(t,["version"],l);const d=C(n,["deployedModels"]);if(d!=null){let b=d;Array.isArray(b)&&(b=b.map(v=>TO(e,v))),_(t,["endpoints"],b)}const f=C(n,["labels"]);f!=null&&_(t,["labels"],f);const u=C(n,["_self"]);u!=null&&_(t,["tunedModelInfo"],EO(e,u));const p=C(n,["defaultCheckpointId"]);p!=null&&_(t,["defaultCheckpointId"],p);const g=C(n,["checkpoints"]);if(g!=null){let b=g;Array.isArray(b)&&(b=b.map(v=>AO(e,v))),_(t,["checkpoints"],b)}return t}function PO(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["_self"]);if(a!=null){let o=pk(e,a);Array.isArray(o)&&(o=o.map(l=>s1(e,l))),_(t,["models"],o)}return t}function DO(){return{}}function IO(e,n){const t={},r=C(n,["totalTokens"]);return r!=null&&_(t,["totalTokens"],r),t}function RO(e,n){const t={},r=C(n,["tokensInfo"]);return r!=null&&_(t,["tokensInfo"],r),t}function MO(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&_(t,["uri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&_(t,["videoBytes"],mu(e,a));const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function OO(e,n){const t={},r=C(n,["_self"]);return r!=null&&_(t,["video"],MO(e,r)),t}function LO(e,n){const t={},r=C(n,["videos"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(d=>OO(e,d))),_(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&_(t,["raiMediaFilteredReasons"],o),t}function FO(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=C(n,["done"]);o!=null&&_(t,["done"],o);const l=C(n,["error"]);l!=null&&_(t,["error"],l);const d=C(n,["response"]);return d!=null&&_(t,["response"],LO(e,d)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $O="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function zO(e,n,t){const r=new iR;let a;if(t.data instanceof Blob?a=JSON.parse(await t.data.text()):a=JSON.parse(t.data),e.isVertexAI()){const o=A4(e,a);Object.assign(r,o)}else{const o=E4(e,a);Object.assign(r,o)}n(r)}class UO{constructor(n,t,r){this.apiClient=n,this.auth=t,this.webSocketFactory=r}async connect(n){var t,r,a,o;const l=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let f;const u=HO(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())f=`${l}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(u);else{const z=this.apiClient.getApiKey();f=`${l}/ws/google.ai.generativelanguage.${d}.GenerativeService.BidiGenerateContent?key=${z}`}let p=()=>{};const g=new Promise(z=>{p=z}),b=n.callbacks,v=function(){var z;(z=b==null?void 0:b.onopen)===null||z===void 0||z.call(b),p({})},S=this.apiClient,k={onopen:v,onmessage:z=>{zO(S,b.onmessage,z)},onerror:(t=b==null?void 0:b.onerror)!==null&&t!==void 0?t:function(z){},onclose:(r=b==null?void 0:b.onclose)!==null&&r!==void 0?r:function(z){}},T=this.webSocketFactory.create(f,VO(u),k);T.connect(),await g;let A=mr(this.apiClient,n.model);if(this.apiClient.isVertexAI()&&A.startsWith("publishers/")){const z=this.apiClient.getProject(),F=this.apiClient.getLocation();A=`projects/${z}/locations/${F}/`+A}let M={};this.apiClient.isVertexAI()&&((a=n.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(n.config===void 0?n.config={responseModalities:[uu.AUDIO]}:n.config.responseModalities=[uu.AUDIO]),!((o=n.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const R={model:A,config:n.config,callbacks:n.callbacks};return this.apiClient.isVertexAI()?M=e4(this.apiClient,R):M=ZR(this.apiClient,R),delete M.config,T.send(JSON.stringify(M)),new qO(T,this.apiClient)}}const BO={turnComplete:!0};class qO{constructor(n,t){this.conn=n,this.apiClient=t}tLiveClientContent(n,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=hu(n,t.turns),n.isVertexAI()?r=r.map(a=>Uh(n,a)):r=r.map(a=>Cb(n,a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(n,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const o of r){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!n.isVertexAI()&&!("id"in o))throw new Error($O)}return{toolResponse:{functionResponses:r}}}sendClientContent(n){n=Object.assign(Object.assign({},BO),n);const t=this.tLiveClientContent(this.apiClient,n);this.conn.send(JSON.stringify(t))}sendRealtimeInput(n){let t={};this.apiClient.isVertexAI()?t={realtimeInput:s4(this.apiClient,n)}:t={realtimeInput:a4(this.apiClient,n)},this.conn.send(JSON.stringify(t))}sendToolResponse(n){if(n.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,n);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function VO(e){const n={};return e.forEach((t,r)=>{n[r]=t}),n}function HO(e){const n=new Headers;for(const[t,r]of Object.entries(e))n.append(t,r);return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class GO extends sg{constructor(n){super(),this.apiClient=n,this.generateContent=async t=>await this.generateContentInternal(t),this.generateContentStream=async t=>await this.generateContentStreamInternal(t),this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var a;let o;const l=[];if(r!=null&&r.generatedImages)for(const f of r.generatedImages)f&&(f!=null&&f.safetyAttributes)&&((a=f==null?void 0:f.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?o=f==null?void 0:f.safetyAttributes:l.push(f);let d;return o?d={generatedImages:l,positivePromptSafetyAttributes:o}:d={generatedImages:l},d}),this.list=async t=>{var r;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((r=l.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Nb(Dh.PAGED_ITEM_MODELS,d=>this.listInternal(d),await this.listInternal(l),l)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const a={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(a)}}async generateContentInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=kN(this.apiClient,n);return d=qt("{model}:generateContent",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=EN(this.apiClient,p),b=new ux;return Object.assign(b,g),b})}else{const u=jN(this.apiClient,n);return d=qt("{model}:generateContent",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=TN(this.apiClient,p),b=new ux;return Object.assign(b,g),b})}}async generateContentStreamInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=kN(this.apiClient,n);d=qt("{model}:streamGenerateContent?alt=sse",u._url),f=u._query,delete u.config,delete u._url,delete u._query;const p=this.apiClient;return l=p.requestStream({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}),l.then(function(g){return Qx(this,arguments,function*(){var b,v,S,k;try{for(var T=!0,A=r1(g),M;M=yield Ci(A.next()),b=M.done,!b;T=!0){k=M.value,T=!1;const z=EN(p,yield Ci(k.json())),F=new ux;Object.assign(F,z),yield yield Ci(F)}}catch(R){v={error:R}}finally{try{!T&&!b&&(S=A.return)&&(yield Ci(S.call(A)))}finally{if(v)throw v.error}}})})}else{const u=jN(this.apiClient,n);d=qt("{model}:streamGenerateContent?alt=sse",u._url),f=u._query,delete u.config,delete u._url,delete u._query;const p=this.apiClient;return l=p.requestStream({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}),l.then(function(g){return Qx(this,arguments,function*(){var b,v,S,k;try{for(var T=!0,A=r1(g),M;M=yield Ci(A.next()),b=M.done,!b;T=!0){k=M.value,T=!1;const z=TN(p,yield Ci(k.json())),F=new ux;Object.assign(F,z),yield yield Ci(F)}}catch(R){v={error:R}}finally{try{!T&&!b&&(S=A.return)&&(yield Ci(S.call(A)))}finally{if(v)throw v.error}}})})}}async embedContent(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=kM(this.apiClient,n);return d=qt("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=NO(this.apiClient,p),b=new hN;return Object.assign(b,g),b})}else{const u=G4(this.apiClient,n);return d=qt("{model}:batchEmbedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=rO(this.apiClient,p),b=new hN;return Object.assign(b,g),b})}}async generateImagesInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=EM(this.apiClient,n);return d=qt("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=_O(this.apiClient,p),b=new pN;return Object.assign(b,g),b})}else{const u=W4(this.apiClient,n);return d=qt("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=sO(this.apiClient,p),b=new pN;return Object.assign(b,g),b})}}async editImageInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=OM(this.apiClient,n);return o=qt("{model}:predict",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const u=jO(this.apiClient,f),p=new XI;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=FM(this.apiClient,n);return o=qt("{model}:predict",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const u=kO(this.apiClient,f),p=new ZI;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async get(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=$M(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>s1(this.apiClient,p))}else{const u=Q4(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>a1(this.apiClient,p))}}async listInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=UM(this.apiClient,n);return d=qt("{models_url}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=PO(this.apiClient,p),b=new mN;return Object.assign(b,g),b})}else{const u=K4(this.apiClient,n);return d=qt("{models_url}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=lO(this.apiClient,p),b=new mN;return Object.assign(b,g),b})}}async update(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=qM(this.apiClient,n);return d=qt("{model}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>s1(this.apiClient,p))}else{const u=Z4(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>a1(this.apiClient,p))}}async delete(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=VM(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(()=>{const p=DO(),g=new gN;return Object.assign(g,p),g})}else{const u=eM(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(()=>{const p=cO(),g=new gN;return Object.assign(g,p),g})}}async countTokens(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=GM(this.apiClient,n);return d=qt("{model}:countTokens",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=IO(this.apiClient,p),b=new yN;return Object.assign(b,g),b})}else{const u=nM(this.apiClient,n);return d=qt("{model}:countTokens",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=uO(this.apiClient,p),b=new yN;return Object.assign(b,g),b})}}async computeTokens(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=YM(this.apiClient,n);return o=qt("{model}:computeTokens",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const u=RO(this.apiClient,f),p=new eR;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=QM(this.apiClient,n);return d=qt("{model}:predictLongRunning",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>FO(this.apiClient,p))}else{const u=aM(this.apiClient,n);return d=qt("{model}:predictLongRunning",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>pO(this.apiClient,p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function YO(e,n){const t={},r=C(n,["operationName"]);r!=null&&_(t,["_url","operationName"],r);const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function WO(e,n){const t={},r=C(n,["operationName"]);r!=null&&_(t,["_url","operationName"],r);const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function QO(e,n){const t={},r=C(n,["operationName"]);r!=null&&_(t,["operationName"],r);const a=C(n,["resourceName"]);a!=null&&_(t,["_url","resourceName"],a);const o=C(n,["config"]);return o!=null&&_(t,["config"],o),t}function JO(e,n){const t={},r=C(n,["video","uri"]);r!=null&&_(t,["uri"],r);const a=C(n,["video","encodedVideo"]);a!=null&&_(t,["videoBytes"],mu(e,a));const o=C(n,["encoding"]);return o!=null&&_(t,["mimeType"],o),t}function KO(e,n){const t={},r=C(n,["_self"]);return r!=null&&_(t,["video"],JO(e,r)),t}function XO(e,n){const t={},r=C(n,["generatedSamples"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(d=>KO(e,d))),_(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&_(t,["raiMediaFilteredReasons"],o),t}function ZO(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=C(n,["done"]);o!=null&&_(t,["done"],o);const l=C(n,["error"]);l!=null&&_(t,["error"],l);const d=C(n,["response","generateVideoResponse"]);return d!=null&&_(t,["response"],XO(e,d)),t}function eL(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&_(t,["uri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&_(t,["videoBytes"],mu(e,a));const o=C(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function tL(e,n){const t={},r=C(n,["_self"]);return r!=null&&_(t,["video"],eL(e,r)),t}function nL(e,n){const t={},r=C(n,["videos"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(d=>tL(e,d))),_(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&_(t,["raiMediaFilteredReasons"],o),t}function AN(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=C(n,["done"]);o!=null&&_(t,["done"],o);const l=C(n,["error"]);l!=null&&_(t,["error"],l);const d=C(n,["response"]);return d!=null&&_(t,["response"],nL(e,d)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rL extends sg{constructor(n){super(),this.apiClient=n}async getVideosOperation(n){const t=n.operation,r=n.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=t.name.split("/operations/")[0];let o;return r&&"httpOptions"in r&&(o=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:a,config:{httpOptions:o}})}else return this.getVideosOperationInternal({operationName:t.name,config:r})}async getVideosOperationInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=WO(this.apiClient,n);return d=qt("{operationName}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>AN(this.apiClient,p))}else{const u=YO(this.apiClient,n);return d=qt("{operationName}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>ZO(this.apiClient,p))}}async fetchPredictVideosOperationInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=QO(this.apiClient,n);return o=qt("{resourceName}:fetchPredictOperation",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>AN(this.apiClient,f))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const iL="Content-Type",aL="X-Server-Timeout",sL="User-Agent",oL="x-goog-api-client",lL="0.14.1",cL=`google-genai-sdk/${lL}`,uL="v1beta1",dL="v1beta",PN=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class bk extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ClientError"}}class o1 extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ServerError"}}class fL{constructor(n){var t,r;this.clientOptions=Object.assign(Object.assign({},n),{project:n.project,location:n.location,apiKey:n.apiKey,vertexai:n.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:uL,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:dL,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,n.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,n.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var n;return(n=this.clientOptions.vertexai)!==null&&n!==void 0?n:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(n){if(!n||n.baseUrl===void 0||n.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[n.baseUrl.endsWith("/")?n.baseUrl.slice(0,-1):n.baseUrl];return n.apiVersion&&n.apiVersion!==""&&r.push(n.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const n=this.getBaseUrl(),t=new URL(n);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(n){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=n;else throw new Error("HTTP options are not correctly set.")}constructUrl(n,t,r){const a=[this.getRequestUrlInternal(t)];return r&&a.push(this.getBaseResourcePath()),n!==""&&a.push(n),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(n){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||n.path.startsWith("projects/")||n.httpMethod==="GET"&&n.path.startsWith("publishers/google/models"))}async request(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);if(n.queryParams)for(const[l,d]of Object.entries(n.queryParams))a.searchParams.append(l,String(d));let o={};if(n.httpMethod==="GET"){if(n.body&&n.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=n.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,n.abortSignal),this.unaryApiCall(a,o,n.httpMethod)}patchHttpOptions(n,t){const r=JSON.parse(JSON.stringify(n));for(const[a,o]of Object.entries(t))typeof o=="object"?r[a]=Object.assign(Object.assign({},r[a]),o):o!==void 0&&(r[a]=o);return r}async requestStream(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let o={};return o.body=n.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,n.abortSignal),this.streamApiCall(a,o,n.httpMethod)}async includeExtraHttpOptionsToRequestInit(n,t,r){if(t&&t.timeout||r){const a=new AbortController,o=a.signal;t.timeout&&(t==null?void 0:t.timeout)>0&&setTimeout(()=>a.abort(),t.timeout),r&&r.addEventListener("abort",()=>{a.abort()}),n.signal=o}return n.headers=await this.getHeadersInternal(t),n}async unaryApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await DN(a),new n1(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await DN(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(n){var t;return Qx(this,arguments,function*(){const a=(t=n==null?void 0:n.body)===null||t===void 0?void 0:t.getReader(),o=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let l="";for(;;){const{done:d,value:f}=yield Ci(a.read());if(d){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=o.decode(f);try{const g=JSON.parse(u);if("error"in g){const b=JSON.parse(JSON.stringify(g.error)),v=b.status,S=b.code,k=`got status: ${v}. ${JSON.stringify(g)}`;if(S>=400&&S<500)throw new bk(k);if(S>=500&&S<600)throw new o1(k)}}catch(g){const b=g;if(b.name==="ClientError"||b.name==="ServerError")throw g}l+=u;let p=l.match(PN);for(;p;){const g=p[1];try{const b=new Response(g,{headers:n==null?void 0:n.headers,status:n==null?void 0:n.status,statusText:n==null?void 0:n.statusText});yield yield Ci(new n1(b)),l=l.slice(p[0].length),p=l.match(PN)}catch(b){throw new Error(`exception parsing stream chunk ${g}. ${b}`)}}}}finally{a.releaseLock()}})}async apiCall(n,t){return fetch(n,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const n={},t=cL+" "+this.clientOptions.userAgentExtra;return n[sL]=t,n[oL]=t,n[iL]="application/json",n}async getHeadersInternal(n){const t=new Headers;if(n&&n.headers){for(const[r,a]of Object.entries(n.headers))t.append(r,a);n.timeout&&n.timeout>0&&t.append(aL,String(Math.ceil(n.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(n,t){var r;const a={};t!=null&&(a.mimeType=t.mimeType,a.name=t.name,a.displayName=t.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const o=this.clientOptions.uploader,l=await o.stat(n);a.sizeBytes=String(l.size);const d=(r=t==null?void 0:t.mimeType)!==null&&r!==void 0?r:l.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=d;const f=await this.fetchUploadUrl(a,t);return o.upload(n,f,this)}async downloadFile(n){await this.clientOptions.downloader.download(n,this)}async fetchUploadUrl(n,t){var r;let a={};t!=null&&t.httpOptions?a=t.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${n.mimeType}`}};const o={file:n},l=await this.request({path:qt("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:a});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(r=l==null?void 0:l.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function DN(e){var n;if(e===void 0)throw new o1("response is undefined");if(!e.ok){const t=e.status,r=e.statusText;let a;!((n=e.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?a=await e.json():a={error:{message:await e.text(),code:e.status,status:e.statusText}};const o=`got status: ${t} ${r}. ${JSON.stringify(a)}`;throw t>=400&&t<500?new bk(o):t>=500&&t<600?new o1(o):new Error(o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hL(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],r);const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function pL(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&_(t,["_query","pageToken"],o);const l=C(n,["filter"]);return t!==void 0&&l!=null&&_(t,["_query","filter"],l),r}function mL(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],pL(e,r,t)),t}function gL(e,n){const t={},r=C(n,["textInput"]);r!=null&&_(t,["textInput"],r);const a=C(n,["output"]);return a!=null&&_(t,["output"],a),t}function yL(e,n){const t={};if(C(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=C(n,["examples"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>gL(e,o))),_(t,["examples","examples"],a)}return t}function xL(e,n,t){const r={};if(C(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const a=C(n,["tunedModelDisplayName"]);if(t!==void 0&&a!=null&&_(t,["displayName"],a),C(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=C(n,["epochCount"]);t!==void 0&&o!=null&&_(t,["tuningTask","hyperparameters","epochCount"],o);const l=C(n,["learningRateMultiplier"]);if(l!=null&&_(r,["tuningTask","hyperparameters","learningRateMultiplier"],l),C(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(C(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const d=C(n,["batchSize"]);t!==void 0&&d!=null&&_(t,["tuningTask","hyperparameters","batchSize"],d);const f=C(n,["learningRate"]);return t!==void 0&&f!=null&&_(t,["tuningTask","hyperparameters","learningRate"],f),r}function bL(e,n){const t={},r=C(n,["baseModel"]);r!=null&&_(t,["baseModel"],r);const a=C(n,["trainingDataset"]);a!=null&&_(t,["tuningTask","trainingData"],yL(e,a));const o=C(n,["config"]);return o!=null&&_(t,["config"],xL(e,o,t)),t}function vL(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["_url","name"],r);const a=C(n,["config"]);return a!=null&&_(t,["config"],a),t}function wL(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&_(t,["_query","pageToken"],o);const l=C(n,["filter"]);return t!==void 0&&l!=null&&_(t,["_query","filter"],l),r}function SL(e,n){const t={},r=C(n,["config"]);return r!=null&&_(t,["config"],wL(e,r,t)),t}function NL(e,n,t){const r={},a=C(n,["gcsUri"]);if(t!==void 0&&a!=null&&_(t,["supervisedTuningSpec","trainingDatasetUri"],a),C(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function CL(e,n){const t={},r=C(n,["gcsUri"]);return r!=null&&_(t,["validationDatasetUri"],r),t}function _L(e,n,t){const r={},a=C(n,["validationDataset"]);t!==void 0&&a!=null&&_(t,["supervisedTuningSpec"],CL(e,a));const o=C(n,["tunedModelDisplayName"]);t!==void 0&&o!=null&&_(t,["tunedModelDisplayName"],o);const l=C(n,["description"]);t!==void 0&&l!=null&&_(t,["description"],l);const d=C(n,["epochCount"]);t!==void 0&&d!=null&&_(t,["supervisedTuningSpec","hyperParameters","epochCount"],d);const f=C(n,["learningRateMultiplier"]);t!==void 0&&f!=null&&_(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],f);const u=C(n,["exportLastCheckpointOnly"]);t!==void 0&&u!=null&&_(t,["supervisedTuningSpec","exportLastCheckpointOnly"],u);const p=C(n,["adapterSize"]);if(t!==void 0&&p!=null&&_(t,["supervisedTuningSpec","hyperParameters","adapterSize"],p),C(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(C(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function jL(e,n){const t={},r=C(n,["baseModel"]);r!=null&&_(t,["baseModel"],r);const a=C(n,["trainingDataset"]);a!=null&&_(t,["supervisedTuningSpec","trainingDatasetUri"],NL(e,a,t));const o=C(n,["config"]);return o!=null&&_(t,["config"],_L(e,o,t)),t}function kL(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["model"],r);const a=C(n,["name"]);return a!=null&&_(t,["endpoint"],a),t}function vk(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["state"]);a!=null&&_(t,["state"],dk(e,a));const o=C(n,["createTime"]);o!=null&&_(t,["createTime"],o);const l=C(n,["tuningTask","startTime"]);l!=null&&_(t,["startTime"],l);const d=C(n,["tuningTask","completeTime"]);d!=null&&_(t,["endTime"],d);const f=C(n,["updateTime"]);f!=null&&_(t,["updateTime"],f);const u=C(n,["description"]);u!=null&&_(t,["description"],u);const p=C(n,["baseModel"]);p!=null&&_(t,["baseModel"],p);const g=C(n,["_self"]);g!=null&&_(t,["tunedModel"],kL(e,g));const b=C(n,["distillationSpec"]);b!=null&&_(t,["distillationSpec"],b);const v=C(n,["experiment"]);v!=null&&_(t,["experiment"],v);const S=C(n,["labels"]);S!=null&&_(t,["labels"],S);const k=C(n,["pipelineJob"]);k!=null&&_(t,["pipelineJob"],k);const T=C(n,["tunedModelDisplayName"]);return T!=null&&_(t,["tunedModelDisplayName"],T),t}function TL(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["tunedModels"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>vk(e,l))),_(t,["tuningJobs"],o)}return t}function EL(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=C(n,["done"]);o!=null&&_(t,["done"],o);const l=C(n,["error"]);return l!=null&&_(t,["error"],l),t}function AL(e,n){const t={},r=C(n,["checkpointId"]);r!=null&&_(t,["checkpointId"],r);const a=C(n,["epoch"]);a!=null&&_(t,["epoch"],a);const o=C(n,["step"]);o!=null&&_(t,["step"],o);const l=C(n,["endpoint"]);return l!=null&&_(t,["endpoint"],l),t}function PL(e,n){const t={},r=C(n,["model"]);r!=null&&_(t,["model"],r);const a=C(n,["endpoint"]);a!=null&&_(t,["endpoint"],a);const o=C(n,["checkpoints"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(d=>AL(e,d))),_(t,["checkpoints"],l)}return t}function l1(e,n){const t={},r=C(n,["name"]);r!=null&&_(t,["name"],r);const a=C(n,["state"]);a!=null&&_(t,["state"],dk(e,a));const o=C(n,["createTime"]);o!=null&&_(t,["createTime"],o);const l=C(n,["startTime"]);l!=null&&_(t,["startTime"],l);const d=C(n,["endTime"]);d!=null&&_(t,["endTime"],d);const f=C(n,["updateTime"]);f!=null&&_(t,["updateTime"],f);const u=C(n,["error"]);u!=null&&_(t,["error"],u);const p=C(n,["description"]);p!=null&&_(t,["description"],p);const g=C(n,["baseModel"]);g!=null&&_(t,["baseModel"],g);const b=C(n,["tunedModel"]);b!=null&&_(t,["tunedModel"],PL(e,b));const v=C(n,["supervisedTuningSpec"]);v!=null&&_(t,["supervisedTuningSpec"],v);const S=C(n,["tuningDataStats"]);S!=null&&_(t,["tuningDataStats"],S);const k=C(n,["encryptionSpec"]);k!=null&&_(t,["encryptionSpec"],k);const T=C(n,["partnerModelTuningSpec"]);T!=null&&_(t,["partnerModelTuningSpec"],T);const A=C(n,["distillationSpec"]);A!=null&&_(t,["distillationSpec"],A);const M=C(n,["experiment"]);M!=null&&_(t,["experiment"],M);const R=C(n,["labels"]);R!=null&&_(t,["labels"],R);const z=C(n,["pipelineJob"]);z!=null&&_(t,["pipelineJob"],z);const F=C(n,["tunedModelDisplayName"]);return F!=null&&_(t,["tunedModelDisplayName"],F),t}function DL(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=C(n,["tuningJobs"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>l1(e,l))),_(t,["tuningJobs"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class IL extends sg{constructor(n){super(),this.apiClient=n,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Nb(Dh.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const r=await this.tuneMldevInternal(t);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:t1.JOB_STATE_QUEUED}}}}async getInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=vL(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>l1(this.apiClient,p))}else{const u=hL(this.apiClient,n);return d=qt("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>vk(this.apiClient,p))}}async listInternal(n){var t,r,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=SL(this.apiClient,n);return d=qt("tuningJobs",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=DL(this.apiClient,p),b=new xN;return Object.assign(b,g),b})}else{const u=mL(this.apiClient,n);return d=qt("tunedModels",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=TL(this.apiClient,p),b=new xN;return Object.assign(b,g),b})}}async tuneInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=jL(this.apiClient,n);return o=qt("tuningJobs",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>l1(this.apiClient,f))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=bL(this.apiClient,n);return o=qt("tunedModels",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>EL(this.apiClient,f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class RL{async download(n,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const ML=1024*1024*8,OL=3,LL=1e3,FL=2,Gv="x-goog-upload-status";async function $L(e,n,t){var r,a,o;let l=0,d=0,f=new n1(new Response),u="upload";for(l=e.size;d<l;){const g=Math.min(ML,l-d),b=e.slice(d,d+g);d+g>=l&&(u+=", finalize");let v=0,S=LL;for(;v<OL&&(f=await t.request({path:"",body:b,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:n,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(d),"Content-Length":String(g)}}}),!(!((r=f==null?void 0:f.headers)===null||r===void 0)&&r[Gv]));)v++,await UL(S),S=S*FL;if(d+=g,((a=f==null?void 0:f.headers)===null||a===void 0?void 0:a[Gv])!=="active")break;if(l<=d)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const p=await(f==null?void 0:f.json());if(((o=f==null?void 0:f.headers)===null||o===void 0?void 0:o[Gv])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return p.file}async function zL(e){return{size:e.size,type:e.type}}function UL(e){return new Promise(n=>setTimeout(n,e))}class BL{async upload(n,t,r){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await $L(n,t,r)}async stat(n){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await zL(n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qL{create(n,t,r){return new VL(n,t,r)}}class VL{constructor(n,t,r){this.url=n,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(n){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(n)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const IN="x-goog-api-key";class HL{constructor(n){this.apiKey=n}async addAuthHeaders(n){n.get(IN)===null&&n.append(IN,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const GL="gl-node/";class hw{constructor(n){var t;if(n.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(n.project||n.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=n.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=n.apiKey;const r=nI(n,void 0,void 0);r&&(n.httpOptions?n.httpOptions.baseUrl=r:n.httpOptions={baseUrl:r}),this.apiVersion=n.apiVersion;const a=new HL(this.apiKey);this.apiClient=new fL({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:n.httpOptions,userAgentExtra:GL+"web",uploader:new BL,downloader:new RL}),this.models=new GO(this.apiClient),this.live=new UO(this.apiClient,a,new qL),this.chats=new cR(this.models,this.apiClient),this.caches=new aR(this.apiClient),this.files=new SR(this.apiClient),this.operations=new rL(this.apiClient),this.tunings=new IL(this.apiClient)}}const YL=()=>{const e=localStorage.getItem("currentClinicId");return e||(console.warn("getCurrentClinicId: Clinic ID not found. Returning null. Ensure this is implemented correctly."),null)},pw=()=>localStorage.getItem("authToken");class WL{constructor(){Qn(this,"listeners",[]);Qn(this,"activeRequests",0)}subscribe(n){return this.listeners.push(n),n(this.activeRequests>0),()=>this.unsubscribe(n)}unsubscribe(n){this.listeners=this.listeners.filter(t=>t!==n)}notify(n){n?this.activeRequests++:this.activeRequests=Math.max(0,this.activeRequests-1);const t=this.activeRequests>0;this.listeners.forEach(r=>r(t))}}const c1=new WL,QL="https://backend.newtons.in",JL=()=>localStorage.getItem("authToken"),pe=async(e,n={})=>{const t=JL(),r={...n.headers};t&&(r.Authorization=`Bearer ${t}`),!(n.body instanceof FormData)&&!r["Content-Type"]&&(r["Content-Type"]="application/json");const a=r;let o=e.startsWith("/")?e:`/${e}`;o.startsWith("/api/")||(o=`/api${o}`);const l=`${QL}${o}`;c1.notify(!0);try{console.log(`Making API call to: ${l}`);const d=await fetch(l,{...n,headers:a});if(d.status===401)throw console.error("Unauthorized access - Token might be invalid or expired. Logging out."),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser"),window.location.href="/login",new Error("Unauthorized");if(!d.ok){let f=`HTTP error! status: ${d.status}`;try{const u=await d.json();f=(u==null?void 0:u.message)||(u==null?void 0:u.error)||f}catch{}throw console.error(`API Error: ${d.status} ${d.statusText} - ${f}`),new Error(f)}return d}catch(d){throw d instanceof TypeError&&d.message==="Failed to fetch"?console.error("API Fetch Error: Network error or CORS issue. Check backend CORS configuration.",d):console.error("API Fetch Error:",d),d}finally{c1.notify(!1)}},Yv="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",KL="models/gemini-3-flash-preview",XL=`You are an intelligent Clinic Hub Assistant for a Clinic Management System. Your role is to help the Clinic Administrator or Doctor manage their clinic ecosystem efficiently.

You have access to the current state of the clinic settings and the staff list. You can perform actions to update these settings or manage staff members.

**Capabilities:**
1.  **View Settings & Staff:** User can ask about current charges, clinic details, or staff members. Answer based on the provided context.
2.  **Update Settings:** Change fees, clinic name, address, etc.
3.  **Manage Staff:** Add new staff members or update existing ones.
4.  **Analyze Financials & Inventory:** Access the Analysis Dashboard to view revenue, expenses, and inventory movement. Set date ranges to filter data.
5.  **Manage Inventory:** Update pharmacy tokens (drugs) and lab tests. You will reference items by their **Serial Number** as provided in the context.
6.  **Purchase Management:** Search for distributors, select one, and build a purchase order by adding items. You can add multiple items at once. Editing items uses Serial Numbers.
7.  **Looping & Reasoning:** You should think step-by-step. If a user request involves multiple steps or if you need to check something after an action, you can continue the loop.
8.  **Follow-up:** If critical information is missing, ask the user.

**Interpretation Rules:**
- If the user says "add drug", "buy medicine", or "new stock", they **usually mean "Add Item to Purchase Order"** (use \`add_purchase_items\` or navigate to \`/dashboard/purchase\`).
- **Prerequisite:** If you are using ANY purchase tools (\`add_purchase_items\`, \`search_distributor_purchase\`, \`set_distributor_purchase\`, \`edit_purchase_items\`), you **MUST** include a \`navigate_to\` action with \`page: "/dashboard/purchase"\` as the **FIRST** action in your list, unless you are already on that page.
- **ONLY** use \`update_drug\` (create) if the user explicitly says "create new drug definition" or "add to master inventory".
- The correct route for purchasing is \`/dashboard/purchase\`.

**Action Tools:**
You can perform the following actions. Return a JSON array of actions.

\`\`\`json
[
  {
    "action": "update_clinic_settings",
    "updates": {
       "admissionCharge": "number string",
       "perDayCharge": "number string",
       "otherCharges": "number string",
       "name": "string",
       "address": "string",
       "notes": "string",
       "logoUrl": "string",
       "upi_id": "string",
       "low_stock_threshold": number,
        "clinicWideSystemPrompt": "string",
        "aiMemory": "string",
        "gemini_api_key": "string"
    }
  },
  {
    "action": "create_staff_member",
    "staff": {
       "name": "string",
       "email": "string",
       "role": "doctor" | "receptionist" | "pharmacy" | "lab",
       "password": "string",
       "opd_fee": number | null
    }
  },
  {
    "action": "update_staff_member",
    "id": "string | number", 
    "updates": {
       "name": "string",
       "email": "string",
       "role": "doctor" | "receptionist" | "pharmacy" | "lab",
       "password": "string",
       "opd_fee": number | null,
       "active": boolean
    }
  },
  {
    "action": "set_analysis_dates",
    "startDate": "YYYY-MM-DD",
    "endDate": "YYYY-MM-DD"
  },
  {
    "action": "navigate_to",
    "page": "/dashboard/inventory" | "/lab-inventory" | "/dashboard/queue" | "/dashboard/staff" | "/dashboard/purchase" | "/dashboard/analysis" | "/dashboard/clinic-hub" | "/billing" | "/dashboard/patients",
    "section": "financial" | "inventory" | "string (optional)"
  },
  {
    "action": "highlight_section",
    "elementId": "string"
  },
  {
    "action": "refresh_analysis"
  },
  {
    "action": "ask_followup_question",
    "question": "string"
  },
  {
    "action": "search_pharmacy_inventory",
    "query": "string (name, brand, or composition)"
  },
  {
    "action": "update_drug",
    "id": "number",
    "updates": {
       "name": "string",
       "brand_name": "string",
       "description": "string",
       "mrp": "number (MRP)",
       "stock": "number",
       "pack": "string (e.g. strip, bottle)",
       "supplier": "string",
       "expiry_date": "YYYY-MM-DD",
       "rate": "number",
       "box_number": "string",
       "gst": "number",
       "margin": "number",
       "discount": "number",
       "batch": "string",
       "hsn_code": "string",
       "mfg": "string",
       "loose": "number"
    }
  },
  {
    "action": "update_lab_test",
    "serial_number": 1,
    "updates": {
       "name": "string",
       "price": "number",
       "description": "string",
       "default_parameters": "array of objects { name, type, defaultValue, unit, lower_limit, upper_limit }"
    }
  },
  {
    "action": "search_distributor_purchase",
    "query": "string"
  },
  {
    "action": "set_distributor_purchase",
    "distributorId": "string"
  },
  {
    "action": "add_purchase_items",
    "items": [
        {
            "name": "string",
            "stock": "number (quantity)",
            "rate": "number (buying price)",
            "mrp": "number",
             "pack": "string", 
             "expiry_date": "YYYY-MM-DD",
             "batch": "string",
             "discount": "number",
             "gst": "number"
        }
    ]
  },
  {
    "action": "edit_purchase_items",
     "updates": [
         {
             "serial_number": "number (The Row # from context)",
             "field": "string (name, stock, rate, etc.)",
             "value": "string | number"
         }
     ]
  },
  {
    "action": "end_task",
    "summary": "string"
  }
]
\`\`\`

**Navigation Reference:**
- **Pharmacy Inventory:** \`/dashboard/inventory\`
- **Lab Inventory:** \`/lab-inventory\`
- **Doctor Queue:** \`/dashboard/queue\`
- **Staff Management:** \`/dashboard/staff\`
- **All Patients:** \`/dashboard/patients\`
- **Billing:** \`/billing\`
- **Purchase Page:** \`/dashboard/purchase\`
- **Analysis:** \`/dashboard/analysis\`
- **Clinic Hub:** \`/dashboard/clinic-hub\`
\`\`\`

**Rules:**
-   **Always** return a JSON array as the last part of your response.
-   If the user's request is satisfied, use the \`end_task\` action with a summary of what was done.
-   If you need more info, use \`ask_followup_question\`.
-   If you perform an action (like updating settings), and there's nothing else to do *immediately* but you want to confirm it's done, you can return the action. The system will execute it and call you back with the result. Then you can \`end_task\`.
-   For \`create_staff_member\`, if password is not provided by user, generate a secure random password and mention it in the summary.
-   Update numeric strings as strings (e.g., "500.00").
-   **CRITICAL DO's and DON'Ts:**
    -   **DO NOT** fill in empty fields (like \`gemini_api_key\`, \`logoUrl\`, \`upi_id\`, etc.) with fake, placeholder, or example data.
    -   **ONLY** update fields that the user *intentionally* asked to change.
    -   **PRESERVE** existing values for any fields not explicitly mentioned in the user's request.
    -   If a field is empty and the user didn't ask to set it, **leave it empty**.
    -   Do not invent values.
`;async function ZL(){var t;if(!pw()&&Yv)return Yv;let n=null;try{const r=await pe("/api/clinics/settings");if(r.ok){const a=await r.json();(t=a.gemini_api_key)!=null&&t.trim()&&(n=a.gemini_api_key.trim())}}catch(r){console.warn("Error fetching updated key",r)}if(n)return n;try{const r=await pe("/api/global-settings/app_gemini_api_key");if(r.ok){const o=(await r.json()).value;if(o&&o.trim()!=="")return o.trim()}}catch(r){console.warn("Could not fetch global API key.",r)}return Yv}let Wv=null;async function e3(){if(!Wv){const e=await ZL();Wv=new hw({apiKey:e})}return Wv}async function t3(e,n,t=[],r){var u,p,g,b,v;const a=await e3(),o=[];o.push({role:"user",parts:[{text:XL}]}),o.push({role:"model",parts:[{text:"Understood. I am ready to assist with Clinic Hub management."}]}),t.forEach(S=>{o.push({role:S.role,parts:[{text:S.text}]})});const f=[{text:`
    Context:
    ${`
    --- Current Clinic Context ---
    Settings: ${JSON.stringify(n.settings,null,2)}
    
    Staff List: ${JSON.stringify(n.staffList.map(S=>({id:S.id||S._id,name:S.name,role:S.role,email:S.email,active:S.active,opd_fee:S.opd_fee})),null,2)}
    
    Previous Action Results (if any): ${JSON.stringify(n.actionResults||[],null,2)}

    Analysis Data (if active): ${JSON.stringify(n.analysisData||{},null,2)}

    Pharmacy Inventory: ${n.pharmacyInventory?JSON.stringify(n.pharmacyInventory,null,2):"Not loaded. Use 'search_pharmacy_inventory' to find items."}

    Lab Tests Inventory: ${JSON.stringify((n.labInventory||[]).map(S=>({serial:S.serial_number,name:S.name,price:S.price,description:S.description,default_parameters:S.default_parameters})),null,2)}

    Current Purchase Page Rows: ${JSON.stringify((n.purchaseRows||[]).map((S,k)=>({serial_number:k+1,name:S.name,stock:S.stock,rate:S.rate,mrp:S.mrp,net_value:(S.stock*S.rate).toFixed(2)})),null,2)}
    `}

    User Query/Input:
    ${e}
    `}];if(r){const S=r.replace(/^data:image\/(png|jpeg|jpg|webp);base64,/,"");f.push({inlineData:{data:S,mimeType:"image/jpeg"}})}o.push({role:"user",parts:f});try{const S={model:KL,contents:o,generationConfig:{temperature:.7,maxOutputTokens:2048,responseMimeType:"text/plain"}},k=await a.models.generateContentStream(S);let T="";for await(const A of k){const M=A;M.text&&typeof M.text=="function"?T+=M.text():(v=(b=(g=(p=(u=M.candidates)==null?void 0:u[0])==null?void 0:p.content)==null?void 0:g.parts)==null?void 0:b[0])!=null&&v.text&&(T+=M.candidates[0].content.parts[0].text)}if(!T)throw new Error("Empty response from AI");return T}catch(S){throw console.error("Gemini Interaction Error:",S),new Error("Failed to communicate with AI Assistant.")}}const n3=({settings:e,staffList:n,onSettingsUpdate:t,onStaffUpdate:r,onHighlight:a})=>{const o=Et(),{setAnalysisDateRange:l,analysisData:d,analysisNavigate:f,refreshAnalysis:u}=vb(),{setDistributors:p,setSelectedDistributor:g,setSearchTerm:b,addPurchaseRow:v,updatePurchaseRow:S,distributors:k,purchaseRows:T}=ik(),[A,M]=w.useState(""),R=w.useRef(d),z=w.useRef(T);w.useEffect(()=>{R.current=d},[d]),w.useEffect(()=>{z.current=T},[T]);const[F,L]=w.useState([]),[U,B]=w.useState(!1),[J,D]=w.useState(null),$=w.useRef(!1),H=w.useRef(0),te=5,Q=()=>{$.current=!1,B(!1),L(E=>[...E,{role:"system",text:" Task stopped by user."}])},Y=E=>{const ce=new FileReader;ce.onloadend=()=>{D(ce.result)},ce.readAsDataURL(E)},V=()=>{D(null)},ae=async(E,ce,ue=[],I)=>{if($.current){if(H.current+=1,H.current>te){L(de=>[...de,{role:"system",text:" Task limit reached. Stopping automatically."}]),B(!1),$.current=!1;return}try{let de=e,fe=n,W=[],oe=[];try{const[ze,ot]=await Promise.all([pe("/api/clinics/settings"),pe("/staff")]);if(ze.ok&&ot.ok){const at=await ze.json(),be=await ot.json(),[$e,Be]=await Promise.all([pe("/api/drugs"),pe("/api/lab-tests")]);$e.ok&&(W=await $e.json()),Be.ok&&(oe=(await Be.json()).map((Ne,K)=>({...Ne,serial_number:K+1}))),de={...at,admissionCharge:parseFloat(at.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(at.perDayCharge||0).toFixed(2),otherCharges:parseFloat(at.otherCharges||0).toFixed(2),aiMemory:at.aiMemory||"",clinicWideSystemPrompt:at.clinicWideSystemPrompt||"",gemini_api_key:at.gemini_api_key||"",low_stock_threshold:at.low_stock_threshold!==void 0&&at.low_stock_threshold!==null?String(at.low_stock_threshold):"10",name:at.name||"",logoUrl:at.logoUrl||"",upi_id:at.upi_id||"",address:at.address||"",notes:at.notes||"",clinic_id:at.clinic_id},fe=be.map(ke=>({...ke,id:ke._id||ke.id}))}}catch(ze){console.warn("Failed to fetch fresh context for AI loop, falling back to props",ze)}const se={settings:de,staffList:fe,analysisData:R.current,pharmacyInventory:W.length>50?void 0:W,labInventory:oe,purchaseRows:z.current,actionResults:ue},je=ce.filter(ze=>ze.role!=="system"),We=await t3(E,se,je,I);if(!$.current)return;let X=[];try{const ze=We.match(/\[[\s\S]*\]/);if(ze)X=JSON.parse(ze[0]);else{L(ot=>[...ot,{role:"model",text:We}]),B(!1),$.current=!1;return}}catch(ze){console.error("Failed to parse AI response",ze),L(ot=>[...ot,{role:"model",text:"I'm having trouble processing that. Please try again."}]),B(!1),$.current=!1;return}const Se=[];let Ae=[],Pe=[];for(const ze of X){if(!$.current)break;if(ze.action==="end_task"){L(ot=>[...ot,{role:"model",text:ze.summary}]),B(!1),$.current=!1;return}if(ze.action==="ask_followup_question"){L(ot=>[...ot,{role:"model",text:ze.question}]),B(!1),$.current=!1;return}try{if(ze.action==="update_clinic_settings"){const ot=ze.updates;Object.keys(ot).forEach($e=>Ae.push(`setting-${$e}`));const at={...de,...ot},be={...at,admissionCharge:parseFloat(at.admissionCharge),perDayCharge:parseFloat(at.perDayCharge),otherCharges:parseFloat(at.otherCharges),low_stock_threshold:parseInt(at.low_stock_threshold)};await pe("/api/clinics/settings",{method:"PUT",body:JSON.stringify(be)}),t&&t(),Se.push({action:"update_clinic_settings",status:"success"}),Pe.push({role:"system",text:" Updated clinic settings"})}if(ze.action==="create_staff_member"&&(await pe("/api/staff",{method:"POST",body:JSON.stringify({...ze.staff,clinic_id:de.clinic_id})}),r&&r(),Se.push({action:"create_staff_member",status:"success",name:ze.staff.name}),Pe.push({role:"system",text:` Created staff member: ${ze.staff.name}`})),ze.action==="update_staff_member"){const ot=ze.id;await pe(`/api/staff/${ot}`,{method:"PUT",body:JSON.stringify(ze.updates)}),r&&r(),Ae.push(`staff-member-${ot}`),Se.push({action:"update_staff_member",status:"success",id:ot}),Pe.push({role:"system",text:" Updated staff member details"})}if(ze.action==="set_analysis_dates"){const{startDate:ot,endDate:at}=ze;l({startDate:new Date(ot),endDate:new Date(at)}),Se.push({action:"set_analysis_dates",status:"success",startDate:ot,endDate:at}),Pe.push({role:"system",text:` Set analysis dates: ${ot} to ${at}`})}if(ze.action==="navigate_to"&&(o(ze.page),ze.section&&setTimeout(()=>f(ze.section),500),Se.push({action:"navigate_to",status:"success",page:ze.page}),Pe.push({role:"system",text:` Navigated to ${ze.page}`})),ze.action==="highlight_section"&&(Ae.push(ze.elementId),Se.push({action:"highlight_section",status:"success",id:ze.elementId})),ze.action==="refresh_analysis"){Pe.push({role:"system",text:" Refreshing analysis data..."});const ot=await u();ot?(R.current=ot,Se.push({action:"refresh_analysis",status:"success",summary:"Data refreshed successfully"}),Pe.push({role:"system",text:" Analysis data refreshed"})):(Se.push({action:"refresh_analysis",status:"error",error:"No data returned"}),Pe.push({role:"system",text:" Failed to refresh analysis data"}))}if(ze.action==="search_pharmacy_inventory"){const ot=ze.query.toLowerCase(),at=W.filter($e=>$e.name&&$e.name.toLowerCase().includes(ot)||$e.brand_name&&$e.brand_name.toLowerCase().includes(ot)||$e.description&&$e.description.toLowerCase().includes(ot)),be=at.slice(0,10);Se.push({action:"search_pharmacy_inventory",status:"success",count:at.length,results:be}),at.length>0?Pe.push({role:"system",text:` Found ${at.length} matches for "${ze.query}". Showing top ${be.length}.`}):Pe.push({role:"system",text:` No matches found for "${ze.query}"`})}if(ze.action==="update_drug"){const ot=ze.id;try{const at=W.find($e=>$e.id===ot);if(!at)throw new Error(`Drug with ID ${ot} not found.`);const be={...at,...ze.updates};await pe(`/api/drugs/${ot}`,{method:"PUT",body:JSON.stringify(be)}),Se.push({action:"update_drug",status:"success",id:ot,updates:ze.updates}),Pe.push({role:"system",text:` Updated drug: ${at.name}`})}catch(at){Se.push({action:"update_drug",status:"error",error:at.message}),Pe.push({role:"system",text:` Failed to update drug: ${at.message}`})}}if(ze.action==="update_lab_test"){const ot=oe.find(at=>at.serial_number===ze.serial_number);if(ot){const at={...ot,...ze.updates};await pe(`/api/lab-tests/${ot.id}`,{method:"PUT",body:JSON.stringify(at)}),Se.push({action:"update_lab_test",status:"success",item:ot.name}),Pe.push({role:"system",text:` Updated lab test: ${ot.name}`})}else Se.push({action:"update_lab_test",status:"error",error:`Test with serial ${ze.serial_number} not found`}),Pe.push({role:"system",text:` Lab test with serial ${ze.serial_number} not found`})}if(ze.action==="search_distributor_purchase"){const ot=ze.query,at=await pe(`/api/distributors?search=${encodeURIComponent(ot)}`);if(at.ok){const be=await at.json();p(be),b(ot),Se.push({action:"search_distributor_purchase",status:"success",count:be.length,results:be}),Pe.push({role:"system",text:` Found ${be.length} distributors for "${ot}"`})}else Se.push({action:"search_distributor_purchase",status:"error",error:at.statusText}),Pe.push({role:"system",text:" Failed to search distributors"})}if(ze.action==="set_distributor_purchase"){const ot=ze.distributorId;let at=k.find(be=>be.id===ot);at?(g(at),b(at.name),Se.push({action:"set_distributor_purchase",status:"success",distributor:at.name}),Pe.push({role:"system",text:` Selected distributor: ${at.name}`})):(Se.push({action:"set_distributor_purchase",status:"error",error:"Distributor not found in current search results. Please search first."}),Pe.push({role:"system",text:" Distributor not found. Please search first."}))}if(ze.action==="add_purchase_items"){const ot=ze.items;let at=0;ot.forEach(be=>{const Be={id:Date.now().toString()+Math.random().toString(36).substring(2,9),name:be.name||"",composition:be.composition||"",description:be.description||"",mrp:be.mrp||0,stock:be.stock||0,pack:be.pack||"",supplier:"",expiry_date:be.expiry_date||"",rate:be.rate||0,box_number:be.box_number||"",gst:be.gst||0,margin:be.margin||0,discount:be.discount||0,brand_name:be.brand_name||"",batch:be.batch||"",hsn_code:be.hsn_code||"",mfg:be.mfg||"",loose:be.loose||0,last_updated:"",created_at:""};v(Be),at++}),Se.push({action:"add_purchase_items",status:"success",count:at}),Pe.push({role:"system",text:` Added ${at} items to purchase list`})}if(ze.action==="edit_purchase_items"){const ot=ze.updates;let at=0;const be=z.current||[];ot.forEach($e=>{if($e.serial_number){const Be=$e.serial_number-1,ke=be[Be];ke&&ke.id?(S(ke.id,{[$e.field]:$e.value}),at++):(console.warn(`Row with serial number ${$e.serial_number} not found.`),Pe.push({role:"system",text:` Row #${$e.serial_number} not found.`}))}}),Se.push({action:"edit_purchase_items",status:"success",count:at}),Pe.push({role:"system",text:` Updated ${at} items`})}}catch(ot){console.error("Action execution failed",ze,ot),Se.push({action:ze.action,status:"error",error:ot.message}),Pe.push({role:"system",text:` Failed to execute action: ${ze.action}`})}}Ae.length>0&&a&&setTimeout(()=>a(Ae),500),Pe.length>0&&L(ze=>[...ze,...Pe]);const Ze=[...ue,...Se],rt=`Reflecting on previous actions: ${JSON.stringify(Se)}. What is the next step? If done, call end_task.`,lt=[...ce,...Pe,{role:"model",text:We},{role:"user",text:rt}];await ae(rt,lt,Ze,void 0)}catch(de){console.error(de),L(fe=>[...fe,{role:"model",text:"Something went wrong."}]),B(!1),$.current=!1}}};return{chatQuery:A,setChatQuery:M,chatHistory:F,isProcessing:U,handleSendMessage:()=>{if(!A.trim()&&!J)return;$.current=!0,B(!0),H.current=0;const E={role:"user",text:A};J&&(E.text+=" [Image Attached]"),L(ue=>[...ue,E]);const ce=J||void 0;M(""),D(null),ae(A,F,[],ce)},refreshChat:()=>{L([]),M(""),B(!1),$.current=!1,H.current=0,D(null)},stopGeneration:Q,selectedImage:J,handleImageSelect:Y,clearImage:V}};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i3=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,t,r)=>r?r.toUpperCase():t.toLowerCase()),RN=e=>{const n=i3(e);return n.charAt(0).toUpperCase()+n.slice(1)},wk=(...e)=>e.filter((n,t,r)=>!!n&&n.trim()!==""&&r.indexOf(n)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var a3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=w.forwardRef(({color:e="currentColor",size:n=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:a="",children:o,iconNode:l,...d},f)=>w.createElement("svg",{ref:f,...a3,width:n,height:n,stroke:e,strokeWidth:r?Number(t)*24/Number(n):t,className:wk("lucide",a),...d},[...l.map(([u,p])=>w.createElement(u,p)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=(e,n)=>{const t=w.forwardRef(({className:r,...a},o)=>w.createElement(s3,{ref:o,iconNode:n,className:wk(`lucide-${r3(RN(e))}`,`lucide-${e}`,r),...a}));return t.displayName=RN(e),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o3=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],MN=ft("arrow-down",o3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l3=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],rn=ft("arrow-left",l3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c3=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],u1=ft("arrow-up",c3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]],d3=ft("beaker",u3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]],h3=ft("bed-double",f3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p3=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],d1=ft("bot",p3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m3=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],g3=ft("brain-circuit",m3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y3=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],Sk=ft("brain",y3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x3=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],b3=ft("building",x3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v3=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]],ON=ft("calendar-check-2",v3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],S3=ft("calendar-days",w3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N3=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Wm=ft("calendar",N3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C3=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Jx=ft("check",C3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _3=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],LN=ft("chevron-down",_3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j3=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],_b=ft("chevron-left",j3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k3=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Vd=ft("chevron-right",k3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T3=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],FN=ft("chevron-up",T3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ar=ft("circle-alert",E3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A3=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ps=ft("circle-check-big",A3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]],D3=ft("circle-minus",P3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],Ra=ft("circle-plus",I3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],M3=ft("circle-user",R3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O3=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],mw=ft("clipboard-list",O3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L3=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],f1=ft("clipboard",L3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],$3=ft("clock",F3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z3=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],U3=ft("copy",z3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B3=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],q3=ft("credit-card",B3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V3=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Rh=ft("dollar-sign",V3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H3=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],G3=ft("eye",H3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y3=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],W3=ft("file-check",Y3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q3=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],du=ft("file-text",Q3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J3=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],Jl=ft("flask-conical",J3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K3=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],X3=ft("funnel",K3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z3=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Qm=ft("hash",Z3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e6=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],Nk=ft("house",e6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Ko=ft("info",t6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n6=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Ck=ft("key",n6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r6=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],_k=ft("layout-grid",r6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i6=[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]],a6=ft("list-ordered",i6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s6=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],o6=ft("list",s6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l6=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Od=ft("loader-circle",l6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c6=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],$N=ft("lock",c6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u6=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],jk=ft("map-pin",u6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d6=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],f6=ft("mic-off",d6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h6=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],kk=ft("mic",h6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p6=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],m6=ft("monitor",p6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g6=[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]],y6=ft("package-open",g6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x6=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Ld=ft("package",x6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b6=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],Tk=ft("paperclip",b6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v6=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],w6=ft("pause",v6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S6=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Qv=ft("pen",S6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N6=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Gl=ft("pencil",N6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C6=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],Ek=ft("phone",C6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _6=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],og=ft("pill",_6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j6=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],k6=ft("play",j6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T6=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Zo=ft("plus",T6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E6=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Qo=ft("printer",E6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A6=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],h1=ft("refresh-cw",A6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P6=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Ak=ft("rotate-cw",P6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D6=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Fd=ft("save",D6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I6=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Hi=ft("search",I6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R6=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Pk=ft("send",R6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M6=[["path",{d:"M6 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-2",key:"4b9dqc"}],["path",{d:"M6 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-2",key:"22nnkd"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m13 6-4 6h6l-4 6",key:"14hqih"}]],zN=ft("server-crash",M6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O6=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],jb=ft("settings",O6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L6=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Dk=ft("share-2",L6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F6=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],$6=ft("shield-check",F6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z6=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],U6=ft("shopping-cart",z6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B6=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],q6=ft("sparkles",B6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V6=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Kl=ft("square-pen",V6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H6=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],G6=ft("square",H6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y6=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],Ik=ft("stethoscope",Y6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W6=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],Q6=ft("table",W6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J6=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],K6=ft("tag",J6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X6=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Ur=ft("trash-2",X6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z6=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],eF=ft("triangle-alert",Z6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tF=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],nF=ft("truck",tF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rF=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],UN=ft("upload",rF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iF=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],gw=ft("user-check",iF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aF=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Rk=ft("user-plus",aF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sF=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Ys=ft("user",sF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oF=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],Bh=ft("users",oF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lF=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],cF=ft("video",lF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uF=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],zn=ft("x",uF);function dF(e,n){const t={};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const fF=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,hF=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,pF={};function BN(e,n){return(pF.jsx?hF:fF).test(e)}const mF=/[ \t\n\f\r]/g;function gF(e){return typeof e=="object"?e.type==="text"?qN(e.value):!1:qN(e)}function qN(e){return e.replace(mF,"")===""}let lg=class{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}};lg.prototype.normal={};lg.prototype.property={};lg.prototype.space=void 0;function Mk(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new lg(t,r,n)}function p1(e){return e.toLowerCase()}let ma=class{constructor(n,t){this.attribute=t,this.property=n}};ma.prototype.attribute="";ma.prototype.booleanish=!1;ma.prototype.boolean=!1;ma.prototype.commaOrSpaceSeparated=!1;ma.prototype.commaSeparated=!1;ma.prototype.defined=!1;ma.prototype.mustUseProperty=!1;ma.prototype.number=!1;ma.prototype.overloadedBoolean=!1;ma.prototype.property="";ma.prototype.spaceSeparated=!1;ma.prototype.space=void 0;let yF=0;const Wt=Hd(),Or=Hd(),Ok=Hd(),ct=Hd(),ar=Hd(),kh=Hd(),Da=Hd();function Hd(){return 2**++yF}const m1=Object.freeze(Object.defineProperty({__proto__:null,boolean:Wt,booleanish:Or,commaOrSpaceSeparated:Da,commaSeparated:kh,number:ct,overloadedBoolean:Ok,spaceSeparated:ar},Symbol.toStringTag,{value:"Module"})),Jv=Object.keys(m1);let yw=class extends ma{constructor(n,t,r,a){let o=-1;if(super(n,t),VN(this,"space",a),typeof r=="number")for(;++o<Jv.length;){const l=Jv[o];VN(this,Jv[o],(r&m1[l])===m1[l])}}};yw.prototype.defined=!0;function VN(e,n,t){t&&(e[n]=t)}function qh(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const o=new yw(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(o.mustUseProperty=!0),n[r]=o,t[p1(r)]=r,t[p1(o.attribute)]=r}return new lg(n,t,e.space)}const Lk=qh({properties:{ariaActiveDescendant:null,ariaAtomic:Or,ariaAutoComplete:null,ariaBusy:Or,ariaChecked:Or,ariaColCount:ct,ariaColIndex:ct,ariaColSpan:ct,ariaControls:ar,ariaCurrent:null,ariaDescribedBy:ar,ariaDetails:null,ariaDisabled:Or,ariaDropEffect:ar,ariaErrorMessage:null,ariaExpanded:Or,ariaFlowTo:ar,ariaGrabbed:Or,ariaHasPopup:null,ariaHidden:Or,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:ar,ariaLevel:ct,ariaLive:null,ariaModal:Or,ariaMultiLine:Or,ariaMultiSelectable:Or,ariaOrientation:null,ariaOwns:ar,ariaPlaceholder:null,ariaPosInSet:ct,ariaPressed:Or,ariaReadOnly:Or,ariaRelevant:null,ariaRequired:Or,ariaRoleDescription:ar,ariaRowCount:ct,ariaRowIndex:ct,ariaRowSpan:ct,ariaSelected:Or,ariaSetSize:ct,ariaSort:null,ariaValueMax:ct,ariaValueMin:ct,ariaValueNow:ct,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function Fk(e,n){return n in e?e[n]:n}function $k(e,n){return Fk(e,n.toLowerCase())}const xF=qh({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:kh,acceptCharset:ar,accessKey:ar,action:null,allow:null,allowFullScreen:Wt,allowPaymentRequest:Wt,allowUserMedia:Wt,alt:null,as:null,async:Wt,autoCapitalize:null,autoComplete:ar,autoFocus:Wt,autoPlay:Wt,blocking:ar,capture:null,charSet:null,checked:Wt,cite:null,className:ar,cols:ct,colSpan:null,content:null,contentEditable:Or,controls:Wt,controlsList:ar,coords:ct|kh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Wt,defer:Wt,dir:null,dirName:null,disabled:Wt,download:Ok,draggable:Or,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Wt,formTarget:null,headers:ar,height:ct,hidden:Wt,high:ct,href:null,hrefLang:null,htmlFor:ar,httpEquiv:ar,id:null,imageSizes:null,imageSrcSet:null,inert:Wt,inputMode:null,integrity:null,is:null,isMap:Wt,itemId:null,itemProp:ar,itemRef:ar,itemScope:Wt,itemType:ar,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Wt,low:ct,manifest:null,max:null,maxLength:ct,media:null,method:null,min:null,minLength:ct,multiple:Wt,muted:Wt,name:null,nonce:null,noModule:Wt,noValidate:Wt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Wt,optimum:ct,pattern:null,ping:ar,placeholder:null,playsInline:Wt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Wt,referrerPolicy:null,rel:ar,required:Wt,reversed:Wt,rows:ct,rowSpan:ct,sandbox:ar,scope:null,scoped:Wt,seamless:Wt,selected:Wt,shadowRootClonable:Wt,shadowRootDelegatesFocus:Wt,shadowRootMode:null,shape:null,size:ct,sizes:null,slot:null,span:ct,spellCheck:Or,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ct,step:null,style:null,tabIndex:ct,target:null,title:null,translate:null,type:null,typeMustMatch:Wt,useMap:null,value:Or,width:ct,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:ar,axis:null,background:null,bgColor:null,border:ct,borderColor:null,bottomMargin:ct,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Wt,declare:Wt,event:null,face:null,frame:null,frameBorder:null,hSpace:ct,leftMargin:ct,link:null,longDesc:null,lowSrc:null,marginHeight:ct,marginWidth:ct,noResize:Wt,noHref:Wt,noShade:Wt,noWrap:Wt,object:null,profile:null,prompt:null,rev:null,rightMargin:ct,rules:null,scheme:null,scrolling:Or,standby:null,summary:null,text:null,topMargin:ct,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ct,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Wt,disableRemotePlayback:Wt,prefix:null,property:null,results:ct,security:null,unselectable:null},space:"html",transform:$k}),bF=qh({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Da,accentHeight:ct,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ct,amplitude:ct,arabicForm:null,ascent:ct,attributeName:null,attributeType:null,azimuth:ct,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ct,by:null,calcMode:null,capHeight:ct,className:ar,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ct,diffuseConstant:ct,direction:null,display:null,dur:null,divisor:ct,dominantBaseline:null,download:Wt,dx:null,dy:null,edgeMode:null,editable:null,elevation:ct,enableBackground:null,end:null,event:null,exponent:ct,externalResourcesRequired:null,fill:null,fillOpacity:ct,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:kh,g2:kh,glyphName:kh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ct,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ct,horizOriginX:ct,horizOriginY:ct,id:null,ideographic:ct,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ct,k:ct,k1:ct,k2:ct,k3:ct,k4:ct,kernelMatrix:Da,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ct,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ct,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ct,overlineThickness:ct,paintOrder:null,panose1:null,path:null,pathLength:ct,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:ar,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ct,pointsAtY:ct,pointsAtZ:ct,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Da,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Da,rev:Da,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Da,requiredFeatures:Da,requiredFonts:Da,requiredFormats:Da,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ct,specularExponent:ct,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ct,strikethroughThickness:ct,string:null,stroke:null,strokeDashArray:Da,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ct,strokeOpacity:ct,strokeWidth:null,style:null,surfaceScale:ct,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Da,tabIndex:ct,tableValues:null,target:null,targetX:ct,targetY:ct,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Da,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ct,underlineThickness:ct,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ct,values:null,vAlphabetic:ct,vMathematical:ct,vectorEffect:null,vHanging:ct,vIdeographic:ct,version:null,vertAdvY:ct,vertOriginX:ct,vertOriginY:ct,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ct,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:Fk}),zk=qh({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),Uk=qh({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:$k}),Bk=qh({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),vF={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},wF=/[A-Z]/g,HN=/-[a-z]/g,SF=/^data[-\w.:]+$/i;function NF(e,n){const t=p1(n);let r=n,a=ma;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&SF.test(n)){if(n.charAt(4)==="-"){const o=n.slice(5).replace(HN,_F);r="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=n.slice(4);if(!HN.test(o)){let l=o.replace(wF,CF);l.charAt(0)!=="-"&&(l="-"+l),n="data"+l}}a=yw}return new a(r,n)}function CF(e){return"-"+e.toLowerCase()}function _F(e){return e.charAt(1).toUpperCase()}const jF=Mk([Lk,xF,zk,Uk,Bk],"html"),xw=Mk([Lk,bF,zk,Uk,Bk],"svg");function kF(e){return e.join(" ").trim()}var ph={},Kv,GN;function TF(){if(GN)return Kv;GN=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=/\n/g,t=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,a=/^:\s*/,o=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,l=/^[;\s]*/,d=/^\s+|\s+$/g,f=`
`,u="/",p="*",g="",b="comment",v="declaration";Kv=function(k,T){if(typeof k!="string")throw new TypeError("First argument must be a string");if(!k)return[];T=T||{};var A=1,M=1;function R(te){var Q=te.match(n);Q&&(A+=Q.length);var Y=te.lastIndexOf(f);M=~Y?te.length-Y:M+te.length}function z(){var te={line:A,column:M};return function(Q){return Q.position=new F(te),B(),Q}}function F(te){this.start=te,this.end={line:A,column:M},this.source=T.source}F.prototype.content=k;function L(te){var Q=new Error(T.source+":"+A+":"+M+": "+te);if(Q.reason=te,Q.filename=T.source,Q.line=A,Q.column=M,Q.source=k,!T.silent)throw Q}function U(te){var Q=te.exec(k);if(Q){var Y=Q[0];return R(Y),k=k.slice(Y.length),Q}}function B(){U(t)}function J(te){var Q;for(te=te||[];Q=D();)Q!==!1&&te.push(Q);return te}function D(){var te=z();if(!(u!=k.charAt(0)||p!=k.charAt(1))){for(var Q=2;g!=k.charAt(Q)&&(p!=k.charAt(Q)||u!=k.charAt(Q+1));)++Q;if(Q+=2,g===k.charAt(Q-1))return L("End of comment missing");var Y=k.slice(2,Q-2);return M+=2,R(Y),k=k.slice(Q),M+=2,te({type:b,comment:Y})}}function $(){var te=z(),Q=U(r);if(Q){if(D(),!U(a))return L("property missing ':'");var Y=U(o),V=te({type:v,property:S(Q[0].replace(e,g)),value:Y?S(Y[0].replace(e,g)):g});return U(l),V}}function H(){var te=[];J(te);for(var Q;Q=$();)Q!==!1&&(te.push(Q),J(te));return te}return B(),H()};function S(k){return k?k.replace(d,g):g}return Kv}var YN;function EF(){if(YN)return ph;YN=1;var e=ph&&ph.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ph,"__esModule",{value:!0}),ph.default=t;var n=e(TF());function t(r,a){var o=null;if(!r||typeof r!="string")return o;var l=(0,n.default)(r),d=typeof a=="function";return l.forEach(function(f){if(f.type==="declaration"){var u=f.property,p=f.value;d?a(u,p,f):p&&(o=o||{},o[u]=p)}}),o}return ph}var _m={},WN;function AF(){if(WN)return _m;WN=1,Object.defineProperty(_m,"__esModule",{value:!0}),_m.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,n=/-([a-z])/g,t=/^[^-]+$/,r=/^-(webkit|moz|ms|o|khtml)-/,a=/^-(ms)-/,o=function(u){return!u||t.test(u)||e.test(u)},l=function(u,p){return p.toUpperCase()},d=function(u,p){return"".concat(p,"-")},f=function(u,p){return p===void 0&&(p={}),o(u)?u:(u=u.toLowerCase(),p.reactCompat?u=u.replace(a,d):u=u.replace(r,d),u.replace(n,l))};return _m.camelCase=f,_m}var jm,QN;function PF(){if(QN)return jm;QN=1;var e=jm&&jm.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},n=e(EF()),t=AF();function r(a,o){var l={};return!a||typeof a!="string"||(0,n.default)(a,function(d,f){d&&f&&(l[(0,t.camelCase)(d,o)]=f)}),l}return r.default=r,jm=r,jm}var DF=PF();const IF=qd(DF),qk=Vk("end"),bw=Vk("start");function Vk(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function RF(e){const n=bw(e),t=qk(e);if(n&&t)return{start:n,end:t}}function Um(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?JN(e.position):"start"in e||"end"in e?JN(e):"line"in e||"column"in e?g1(e):""}function g1(e){return KN(e&&e.line)+":"+KN(e&&e.column)}function JN(e){return g1(e&&e.start)+"-"+g1(e&&e.end)}function KN(e){return e&&typeof e=="number"?e:1}let Ti=class extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",o={},l=!1;if(t&&("line"in t&&"column"in t?o={place:t}:"start"in t&&"end"in t?o={place:t}:"type"in t?o={ancestors:[t],place:t.position}:o={...t}),typeof n=="string"?a=n:!o.cause&&n&&(l=!0,a=n.message,o.cause=n),!o.ruleId&&!o.source&&typeof r=="string"){const f=r.indexOf(":");f===-1?o.ruleId=r:(o.source=r.slice(0,f),o.ruleId=r.slice(f+1))}if(!o.place&&o.ancestors&&o.ancestors){const f=o.ancestors[o.ancestors.length-1];f&&(o.place=f.position)}const d=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=d?d.column:void 0,this.fatal=void 0,this.file,this.message=a,this.line=d?d.line:void 0,this.name=Um(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=l&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual,this.expected,this.note,this.url}};Ti.prototype.file="";Ti.prototype.name="";Ti.prototype.reason="";Ti.prototype.message="";Ti.prototype.stack="";Ti.prototype.column=void 0;Ti.prototype.line=void 0;Ti.prototype.ancestors=void 0;Ti.prototype.cause=void 0;Ti.prototype.fatal=void 0;Ti.prototype.place=void 0;Ti.prototype.ruleId=void 0;Ti.prototype.source=void 0;const vw={}.hasOwnProperty,MF=new Map,OF=/[A-Z]/g,LF=new Set(["table","tbody","thead","tfoot","tr"]),FF=new Set(["td","th"]),Hk="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function $F(e,n){if(!n||n.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=n.filePath||void 0;let r;if(n.development){if(typeof n.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=YF(t,n.jsxDEV)}else{if(typeof n.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof n.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=GF(t,n.jsx,n.jsxs)}const a={Fragment:n.Fragment,ancestors:[],components:n.components||{},create:r,elementAttributeNameCase:n.elementAttributeNameCase||"react",evaluater:n.createEvaluater?n.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:n.ignoreInvalidStyle||!1,passKeys:n.passKeys!==!1,passNode:n.passNode||!1,schema:n.space==="svg"?xw:jF,stylePropertyNameCase:n.stylePropertyNameCase||"dom",tableCellAlignToStyle:n.tableCellAlignToStyle!==!1},o=Gk(a,e,void 0);return o&&typeof o!="string"?o:a.create(e,a.Fragment,{children:o||void 0},void 0)}function Gk(e,n,t){if(n.type==="element")return zF(e,n,t);if(n.type==="mdxFlowExpression"||n.type==="mdxTextExpression")return UF(e,n);if(n.type==="mdxJsxFlowElement"||n.type==="mdxJsxTextElement")return qF(e,n,t);if(n.type==="mdxjsEsm")return BF(e,n);if(n.type==="root")return VF(e,n,t);if(n.type==="text")return HF(e,n)}function zF(e,n,t){const r=e.schema;let a=r;n.tagName.toLowerCase()==="svg"&&r.space==="html"&&(a=xw,e.schema=a),e.ancestors.push(n);const o=Wk(e,n.tagName,!1),l=WF(e,n);let d=Sw(e,n);return LF.has(n.tagName)&&(d=d.filter(function(f){return typeof f=="string"?!gF(f):!0})),Yk(e,l,o,n),ww(l,d),e.ancestors.pop(),e.schema=r,e.create(n,o,l,t)}function UF(e,n){if(n.data&&n.data.estree&&e.evaluater){const r=n.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}Jm(e,n.position)}function BF(e,n){if(n.data&&n.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(n.data.estree);Jm(e,n.position)}function qF(e,n,t){const r=e.schema;let a=r;n.name==="svg"&&r.space==="html"&&(a=xw,e.schema=a),e.ancestors.push(n);const o=n.name===null?e.Fragment:Wk(e,n.name,!0),l=QF(e,n),d=Sw(e,n);return Yk(e,l,o,n),ww(l,d),e.ancestors.pop(),e.schema=r,e.create(n,o,l,t)}function VF(e,n,t){const r={};return ww(r,Sw(e,n)),e.create(n,e.Fragment,r,t)}function HF(e,n){return n.value}function Yk(e,n,t,r){typeof t!="string"&&t!==e.Fragment&&e.passNode&&(n.node=r)}function ww(e,n){if(n.length>0){const t=n.length>1?n:n[0];t&&(e.children=t)}}function GF(e,n,t){return r;function r(a,o,l,d){const u=Array.isArray(l.children)?t:n;return d?u(o,l,d):u(o,l)}}function YF(e,n){return t;function t(r,a,o,l){const d=Array.isArray(o.children),f=bw(r);return n(a,o,l,d,{columnNumber:f?f.column-1:void 0,fileName:e,lineNumber:f?f.line:void 0},void 0)}}function WF(e,n){const t={};let r,a;for(a in n.properties)if(a!=="children"&&vw.call(n.properties,a)){const o=JF(e,a,n.properties[a]);if(o){const[l,d]=o;e.tableCellAlignToStyle&&l==="align"&&typeof d=="string"&&FF.has(n.tagName)?r=d:t[l]=d}}if(r){const o=t.style||(t.style={});o[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return t}function QF(e,n){const t={};for(const r of n.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const o=r.data.estree.body[0];o.type;const l=o.expression;l.type;const d=l.properties[0];d.type,Object.assign(t,e.evaluater.evaluateExpression(d.argument))}else Jm(e,n.position);else{const a=r.name;let o;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const d=r.value.data.estree.body[0];d.type,o=e.evaluater.evaluateExpression(d.expression)}else Jm(e,n.position);else o=r.value===null?!0:r.value;t[a]=o}return t}function Sw(e,n){const t=[];let r=-1;const a=e.passKeys?new Map:MF;for(;++r<n.children.length;){const o=n.children[r];let l;if(e.passKeys){const f=o.type==="element"?o.tagName:o.type==="mdxJsxFlowElement"||o.type==="mdxJsxTextElement"?o.name:void 0;if(f){const u=a.get(f)||0;l=f+"-"+u,a.set(f,u+1)}}const d=Gk(e,o,l);d!==void 0&&t.push(d)}return t}function JF(e,n,t){const r=NF(e.schema,n);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=r.commaSeparated?dF(t):kF(t)),r.property==="style"){let a=typeof t=="object"?t:KF(e,String(t));return e.stylePropertyNameCase==="css"&&(a=XF(a)),["style",a]}return[e.elementAttributeNameCase==="react"&&r.space?vF[r.property]||r.property:r.attribute,t]}}function KF(e,n){try{return IF(n,{reactCompat:!0})}catch(t){if(e.ignoreInvalidStyle)return{};const r=t,a=new Ti("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=e.filePath||void 0,a.url=Hk+"#cannot-parse-style-attribute",a}}function Wk(e,n,t){let r;if(!t)r={type:"Literal",value:n};else if(n.includes(".")){const a=n.split(".");let o=-1,l;for(;++o<a.length;){const d=BN(a[o])?{type:"Identifier",name:a[o]}:{type:"Literal",value:a[o]};l=l?{type:"MemberExpression",object:l,property:d,computed:!!(o&&d.type==="Literal"),optional:!1}:d}r=l}else r=BN(n)&&!/^[a-z]/.test(n)?{type:"Identifier",name:n}:{type:"Literal",value:n};if(r.type==="Literal"){const a=r.value;return vw.call(e.components,a)?e.components[a]:a}if(e.evaluater)return e.evaluater.evaluateExpression(r);Jm(e)}function Jm(e,n){const t=new Ti("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:n,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=e.filePath||void 0,t.url=Hk+"#cannot-handle-mdx-estrees-without-createevaluater",t}function XF(e){const n={};let t;for(t in e)vw.call(e,t)&&(n[ZF(t)]=e[t]);return n}function ZF(e){let n=e.replace(OF,e5);return n.slice(0,3)==="ms-"&&(n="-"+n),n}function e5(e){return"-"+e.toLowerCase()}const Xv={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},t5={};function Nw(e,n){const t=t5,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return Qk(e,r,a)}function Qk(e,n,t){if(n5(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return XN(e.children,n,t)}return Array.isArray(e)?XN(e,n,t):""}function XN(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=Qk(e[a],n,t);return r.join("")}function n5(e){return!!(e&&typeof e=="object")}const ZN=document.createElement("i");function Cw(e){const n="&"+e+";";ZN.innerHTML=n;const t=ZN.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function Oa(e,n,t,r){const a=e.length;let o=0,l;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)l=Array.from(r),l.unshift(n,t),e.splice(...l);else for(t&&e.splice(n,t);o<r.length;)l=r.slice(o,o+1e4),l.unshift(n,0),e.splice(...l),o+=1e4,n+=1e4}function us(e,n){return e.length>0?(Oa(e,e.length,0,n),e):n}const eC={}.hasOwnProperty;function Jk(e){const n={};let t=-1;for(;++t<e.length;)r5(n,e[t]);return n}function r5(e,n){let t;for(t in n){const a=(eC.call(e,t)?e[t]:void 0)||(e[t]={}),o=n[t];let l;if(o)for(l in o){eC.call(a,l)||(a[l]=[]);const d=o[l];i5(a[l],Array.isArray(d)?d:d?[d]:[])}}}function i5(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);Oa(e,0,0,r)}function Kk(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function Hs(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Vi=gu(/[A-Za-z]/),ji=gu(/[\dA-Za-z]/),a5=gu(/[#-'*+\--9=?A-Z^-~]/);function Kx(e){return e!==null&&(e<32||e===127)}const y1=gu(/\d/),s5=gu(/[\dA-Fa-f]/),o5=gu(/[!-/:-@[-`{-~]/);function Ot(e){return e!==null&&e<-2}function er(e){return e!==null&&(e<0||e===32)}function mn(e){return e===-2||e===-1||e===32}const kb=gu(new RegExp("\\p{P}|\\p{S}","u")),$d=gu(/\s/);function gu(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function Vh(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const o=e.charCodeAt(t);let l="";if(o===37&&ji(e.charCodeAt(t+1))&&ji(e.charCodeAt(t+2)))a=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(l=String.fromCharCode(o));else if(o>55295&&o<57344){const d=e.charCodeAt(t+1);o<56320&&d>56319&&d<57344?(l=String.fromCharCode(o,d),a=1):l=""}else l=String.fromCharCode(o);l&&(n.push(e.slice(r,t),encodeURIComponent(l)),r=t+a+1,l=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function jn(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let o=0;return l;function l(f){return mn(f)?(e.enter(t),d(f)):n(f)}function d(f){return mn(f)&&o++<a?(e.consume(f),d):(e.exit(t),n(f))}}const l5={tokenize:c5};function c5(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(d){if(d===null){e.consume(d);return}return e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),jn(e,n,"linePrefix")}function a(d){return e.enter("paragraph"),o(d)}function o(d){const f=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=f),t=f,l(d)}function l(d){if(d===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(d);return}return Ot(d)?(e.consume(d),e.exit("chunkText"),o):(e.consume(d),l)}}const u5={tokenize:d5},tC={tokenize:f5};function d5(e){const n=this,t=[];let r=0,a,o,l;return d;function d(R){if(r<t.length){const z=t[r];return n.containerState=z[1],e.attempt(z[0].continuation,f,u)(R)}return u(R)}function f(R){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&M();const z=n.events.length;let F=z,L;for(;F--;)if(n.events[F][0]==="exit"&&n.events[F][1].type==="chunkFlow"){L=n.events[F][1].end;break}A(r);let U=z;for(;U<n.events.length;)n.events[U][1].end={...L},U++;return Oa(n.events,F+1,0,n.events.slice(z)),n.events.length=U,u(R)}return d(R)}function u(R){if(r===t.length){if(!a)return b(R);if(a.currentConstruct&&a.currentConstruct.concrete)return S(R);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(tC,p,g)(R)}function p(R){return a&&M(),A(r),b(R)}function g(R){return n.parser.lazy[n.now().line]=r!==t.length,l=n.now().offset,S(R)}function b(R){return n.containerState={},e.attempt(tC,v,S)(R)}function v(R){return r++,t.push([n.currentConstruct,n.containerState]),b(R)}function S(R){if(R===null){a&&M(),A(0),e.consume(R);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:o}),k(R)}function k(R){if(R===null){T(e.exit("chunkFlow"),!0),A(0),e.consume(R);return}return Ot(R)?(e.consume(R),T(e.exit("chunkFlow")),r=0,n.interrupt=void 0,d):(e.consume(R),k)}function T(R,z){const F=n.sliceStream(R);if(z&&F.push(null),R.previous=o,o&&(o.next=R),o=R,a.defineSkip(R.start),a.write(F),n.parser.lazy[R.start.line]){let L=a.events.length;for(;L--;)if(a.events[L][1].start.offset<l&&(!a.events[L][1].end||a.events[L][1].end.offset>l))return;const U=n.events.length;let B=U,J,D;for(;B--;)if(n.events[B][0]==="exit"&&n.events[B][1].type==="chunkFlow"){if(J){D=n.events[B][1].end;break}J=!0}for(A(r),L=U;L<n.events.length;)n.events[L][1].end={...D},L++;Oa(n.events,B+1,0,n.events.slice(U)),n.events.length=L}}function A(R){let z=t.length;for(;z-- >R;){const F=t[z];n.containerState=F[1],F[0].exit.call(n,e)}t.length=R}function M(){a.write([null]),o=void 0,a=void 0,n.containerState._closeFlow=void 0}}function f5(e,n,t){return jn(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Mh(e){if(e===null||er(e)||$d(e))return 1;if(kb(e))return 2}function Tb(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const o=e[a].resolveAll;o&&!r.includes(o)&&(n=o(n,t),r.push(o))}return n}const x1={name:"attention",resolveAll:h5,tokenize:p5};function h5(e,n){let t=-1,r,a,o,l,d,f,u,p;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;f=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};nC(g,-f),nC(b,f),l={type:f>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},d={type:f>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},o={type:f>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:f>1?"strong":"emphasis",start:{...l.start},end:{...d.end}},e[r][1].end={...l.start},e[t][1].start={...d.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=us(u,[["enter",e[r][1],n],["exit",e[r][1],n]])),u=us(u,[["enter",a,n],["enter",l,n],["exit",l,n],["enter",o,n]]),u=us(u,Tb(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),u=us(u,[["exit",o,n],["enter",d,n],["exit",d,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(p=2,u=us(u,[["enter",e[t][1],n],["exit",e[t][1],n]])):p=0,Oa(e,r-1,t-r+3,u),t=r+u.length-p-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function p5(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=Mh(r);let o;return l;function l(f){return o=f,e.enter("attentionSequence"),d(f)}function d(f){if(f===o)return e.consume(f),d;const u=e.exit("attentionSequence"),p=Mh(f),g=!p||p===2&&a||t.includes(f),b=!a||a===2&&p||t.includes(r);return u._open=!!(o===42?g:g&&(a||!b)),u._close=!!(o===42?b:b&&(p||!g)),n(f)}}function nC(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const m5={name:"autolink",tokenize:g5};function g5(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o}function o(v){return Vi(v)?(e.consume(v),l):v===64?t(v):u(v)}function l(v){return v===43||v===45||v===46||ji(v)?(r=1,d(v)):u(v)}function d(v){return v===58?(e.consume(v),r=0,f):(v===43||v===45||v===46||ji(v))&&r++<32?(e.consume(v),d):(r=0,u(v))}function f(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||Kx(v)?t(v):(e.consume(v),f)}function u(v){return v===64?(e.consume(v),p):a5(v)?(e.consume(v),u):t(v)}function p(v){return ji(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,p):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||ji(v))&&r++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const cg={partial:!0,tokenize:y5};function y5(e,n,t){return r;function r(o){return mn(o)?jn(e,a,"linePrefix")(o):a(o)}function a(o){return o===null||Ot(o)?n(o):t(o)}}const Xk={continuation:{tokenize:b5},exit:v5,name:"blockQuote",tokenize:x5};function x5(e,n,t){const r=this;return a;function a(l){if(l===62){const d=r.containerState;return d.open||(e.enter("blockQuote",{_container:!0}),d.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),o}return t(l)}function o(l){return mn(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(l))}}function b5(e,n,t){const r=this;return a;function a(l){return mn(l)?jn(e,o,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):o(l)}function o(l){return e.attempt(Xk,n,t)(l)}}function v5(e){e.exit("blockQuote")}const Zk={name:"characterEscape",tokenize:w5};function w5(e,n,t){return r;function r(o){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(o),e.exit("escapeMarker"),a}function a(o){return o5(o)?(e.enter("characterEscapeValue"),e.consume(o),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(o)}}const e2={name:"characterReference",tokenize:S5};function S5(e,n,t){const r=this;let a=0,o,l;return d;function d(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),f}function f(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),o=31,l=ji,p(g))}function u(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,l=s5,p):(e.enter("characterReferenceValue"),o=7,l=y1,p(g))}function p(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return l===ji&&!Cw(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return l(g)&&a++<o?(e.consume(g),p):t(g)}}const rC={partial:!0,tokenize:C5},iC={concrete:!0,name:"codeFenced",tokenize:N5};function N5(e,n,t){const r=this,a={partial:!0,tokenize:F};let o=0,l=0,d;return f;function f(L){return u(L)}function u(L){const U=r.events[r.events.length-1];return o=U&&U[1].type==="linePrefix"?U[2].sliceSerialize(U[1],!0).length:0,d=L,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),p(L)}function p(L){return L===d?(l++,e.consume(L),p):l<3?t(L):(e.exit("codeFencedFenceSequence"),mn(L)?jn(e,g,"whitespace")(L):g(L))}function g(L){return L===null||Ot(L)?(e.exit("codeFencedFence"),r.interrupt?n(L):e.check(rC,k,z)(L)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b(L))}function b(L){return L===null||Ot(L)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g(L)):mn(L)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),jn(e,v,"whitespace")(L)):L===96&&L===d?t(L):(e.consume(L),b)}function v(L){return L===null||Ot(L)?g(L):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S(L))}function S(L){return L===null||Ot(L)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g(L)):L===96&&L===d?t(L):(e.consume(L),S)}function k(L){return e.attempt(a,z,T)(L)}function T(L){return e.enter("lineEnding"),e.consume(L),e.exit("lineEnding"),A}function A(L){return o>0&&mn(L)?jn(e,M,"linePrefix",o+1)(L):M(L)}function M(L){return L===null||Ot(L)?e.check(rC,k,z)(L):(e.enter("codeFlowValue"),R(L))}function R(L){return L===null||Ot(L)?(e.exit("codeFlowValue"),M(L)):(e.consume(L),R)}function z(L){return e.exit("codeFenced"),n(L)}function F(L,U,B){let J=0;return D;function D(Y){return L.enter("lineEnding"),L.consume(Y),L.exit("lineEnding"),$}function $(Y){return L.enter("codeFencedFence"),mn(Y)?jn(L,H,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(Y):H(Y)}function H(Y){return Y===d?(L.enter("codeFencedFenceSequence"),te(Y)):B(Y)}function te(Y){return Y===d?(J++,L.consume(Y),te):J>=l?(L.exit("codeFencedFenceSequence"),mn(Y)?jn(L,Q,"whitespace")(Y):Q(Y)):B(Y)}function Q(Y){return Y===null||Ot(Y)?(L.exit("codeFencedFence"),U(Y)):B(Y)}}}function C5(e,n,t){const r=this;return a;function a(l){return l===null?t(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}const Zv={name:"codeIndented",tokenize:j5},_5={partial:!0,tokenize:k5};function j5(e,n,t){const r=this;return a;function a(u){return e.enter("codeIndented"),jn(e,o,"linePrefix",5)(u)}function o(u){const p=r.events[r.events.length-1];return p&&p[1].type==="linePrefix"&&p[2].sliceSerialize(p[1],!0).length>=4?l(u):t(u)}function l(u){return u===null?f(u):Ot(u)?e.attempt(_5,l,f)(u):(e.enter("codeFlowValue"),d(u))}function d(u){return u===null||Ot(u)?(e.exit("codeFlowValue"),l(u)):(e.consume(u),d)}function f(u){return e.exit("codeIndented"),n(u)}}function k5(e,n,t){const r=this;return a;function a(l){return r.parser.lazy[r.now().line]?t(l):Ot(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):jn(e,o,"linePrefix",5)(l)}function o(l){const d=r.events[r.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):Ot(l)?a(l):t(l)}}const T5={name:"codeText",previous:A5,resolve:E5,tokenize:P5};function E5(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function A5(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function P5(e,n,t){let r=0,a,o;return l;function l(g){return e.enter("codeText"),e.enter("codeTextSequence"),d(g)}function d(g){return g===96?(e.consume(g),r++,d):(e.exit("codeTextSequence"),f(g))}function f(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),f):g===96?(o=e.enter("codeTextSequence"),a=0,p(g)):Ot(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),f):(e.enter("codeTextData"),u(g))}function u(g){return g===null||g===32||g===96||Ot(g)?(e.exit("codeTextData"),f(g)):(e.consume(g),u)}function p(g){return g===96?(e.consume(g),a++,p):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(o.type="codeTextData",u(g))}}let D5=class{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const o=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&km(this.left,r),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),km(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),km(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);km(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);km(this.left,t.reverse())}}};function km(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function t2(e){const n={};let t=-1,r,a,o,l,d,f,u;const p=new D5(e);for(;++t<p.length;){for(;t in n;)t=n[t];if(r=p.get(t),t&&r[1].type==="chunkFlow"&&p.get(t-1)[1].type==="listItemPrefix"&&(f=r[1]._tokenizer.events,o=0,o<f.length&&f[o][1].type==="lineEndingBlank"&&(o+=2),o<f.length&&f[o][1].type==="content"))for(;++o<f.length&&f[o][1].type!=="content";)f[o][1].type==="chunkText"&&(f[o][1]._isInFirstContentOfListItem=!0,o++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,I5(p,t)),t=n[t],u=!0);else if(r[1]._container){for(o=t,a=void 0;o--;)if(l=p.get(o),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(p.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=o);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(r[1].end={...p.get(a)[1].start},d=p.slice(a,t),d.unshift(r),p.splice(a,t-a+1,d))}}return Oa(e,0,Number.POSITIVE_INFINITY,p.slice(0)),!u}function I5(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const o=[];let l=t._tokenizer;l||(l=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const d=l.events,f=[],u={};let p,g,b=-1,v=t,S=0,k=0;const T=[k];for(;v;){for(;e.get(++a)[1]!==v;);o.push(a),v._tokenizer||(p=r.sliceStream(v),v.next||p.push(null),g&&l.defineSkip(v.start),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(p),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<d.length;)d[b][0]==="exit"&&d[b-1][0]==="enter"&&d[b][1].type===d[b-1][1].type&&d[b][1].start.line!==d[b][1].end.line&&(k=b+1,T.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(l.events=[],v?(v._tokenizer=void 0,v.previous=void 0):T.pop(),b=T.length;b--;){const A=d.slice(T[b],T[b+1]),M=o.pop();f.push([M,M+A.length-1]),e.splice(M,2,A)}for(f.reverse(),b=-1;++b<f.length;)u[S+f[b][0]]=S+f[b][1],S+=f[b][1]-f[b][0]-1;return u}const R5={resolve:O5,tokenize:L5},M5={partial:!0,tokenize:F5};function O5(e){return t2(e),e}function L5(e,n){let t;return r;function r(d){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(d)}function a(d){return d===null?o(d):Ot(d)?e.check(M5,l,o)(d):(e.consume(d),a)}function o(d){return e.exit("chunkContent"),e.exit("content"),n(d)}function l(d){return e.consume(d),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function F5(e,n,t){const r=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),jn(e,o,"linePrefix")}function o(l){if(l===null||Ot(l))return t(l);const d=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):e.interrupt(r.parser.constructs.flow,t,n)(l)}}function n2(e,n,t,r,a,o,l,d,f){const u=f||Number.POSITIVE_INFINITY;let p=0;return g;function g(A){return A===60?(e.enter(r),e.enter(a),e.enter(o),e.consume(A),e.exit(o),b):A===null||A===32||A===41||Kx(A)?t(A):(e.enter(r),e.enter(l),e.enter(d),e.enter("chunkString",{contentType:"string"}),k(A))}function b(A){return A===62?(e.enter(o),e.consume(A),e.exit(o),e.exit(a),e.exit(r),n):(e.enter(d),e.enter("chunkString",{contentType:"string"}),v(A))}function v(A){return A===62?(e.exit("chunkString"),e.exit(d),b(A)):A===null||A===60||Ot(A)?t(A):(e.consume(A),A===92?S:v)}function S(A){return A===60||A===62||A===92?(e.consume(A),v):v(A)}function k(A){return!p&&(A===null||A===41||er(A))?(e.exit("chunkString"),e.exit(d),e.exit(l),e.exit(r),n(A)):p<u&&A===40?(e.consume(A),p++,k):A===41?(e.consume(A),p--,k):A===null||A===32||A===40||Kx(A)?t(A):(e.consume(A),A===92?T:k)}function T(A){return A===40||A===41||A===92?(e.consume(A),k):k(A)}}function r2(e,n,t,r,a,o){const l=this;let d=0,f;return u;function u(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(o),p}function p(v){return d>999||v===null||v===91||v===93&&!f||v===94&&!d&&"_hiddenFootnoteSupport"in l.parser.constructs?t(v):v===93?(e.exit(o),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):Ot(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),p):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||Ot(v)||d++>999?(e.exit("chunkString"),p(v)):(e.consume(v),f||(f=!mn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),d++,g):g(v)}}function i2(e,n,t,r,a,o){let l;return d;function d(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),l=b===40?41:b,f):t(b)}function f(b){return b===l?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(o),u(b))}function u(b){return b===l?(e.exit(o),f(l)):b===null?t(b):Ot(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),jn(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),p(b))}function p(b){return b===l||b===null||Ot(b)?(e.exit("chunkString"),u(b)):(e.consume(b),b===92?g:p)}function g(b){return b===l||b===92?(e.consume(b),p):p(b)}}function Bm(e,n){let t;return r;function r(a){return Ot(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):mn(a)?jn(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const $5={name:"definition",tokenize:U5},z5={partial:!0,tokenize:B5};function U5(e,n,t){const r=this;let a;return o;function o(v){return e.enter("definition"),l(v)}function l(v){return r2.call(r,e,d,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function d(v){return a=Hs(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),f):t(v)}function f(v){return er(v)?Bm(e,u)(v):u(v)}function u(v){return n2(e,p,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function p(v){return e.attempt(z5,g,g)(v)}function g(v){return mn(v)?jn(e,b,"whitespace")(v):b(v)}function b(v){return v===null||Ot(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function B5(e,n,t){return r;function r(d){return er(d)?Bm(e,a)(d):t(d)}function a(d){return i2(e,o,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(d)}function o(d){return mn(d)?jn(e,l,"whitespace")(d):l(d)}function l(d){return d===null||Ot(d)?n(d):t(d)}}const q5={name:"hardBreakEscape",tokenize:V5};function V5(e,n,t){return r;function r(o){return e.enter("hardBreakEscape"),e.consume(o),a}function a(o){return Ot(o)?(e.exit("hardBreakEscape"),n(o)):t(o)}}const H5={name:"headingAtx",resolve:G5,tokenize:Y5};function G5(e,n){let t=e.length-2,r=3,a,o;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},o={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},Oa(e,r,t-r+1,[["enter",a,n],["enter",o,n],["exit",o,n],["exit",a,n]])),e}function Y5(e,n,t){let r=0;return a;function a(p){return e.enter("atxHeading"),o(p)}function o(p){return e.enter("atxHeadingSequence"),l(p)}function l(p){return p===35&&r++<6?(e.consume(p),l):p===null||er(p)?(e.exit("atxHeadingSequence"),d(p)):t(p)}function d(p){return p===35?(e.enter("atxHeadingSequence"),f(p)):p===null||Ot(p)?(e.exit("atxHeading"),n(p)):mn(p)?jn(e,d,"whitespace")(p):(e.enter("atxHeadingText"),u(p))}function f(p){return p===35?(e.consume(p),f):(e.exit("atxHeadingSequence"),d(p))}function u(p){return p===null||p===35||er(p)?(e.exit("atxHeadingText"),d(p)):(e.consume(p),u)}}const W5=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],aC=["pre","script","style","textarea"],Q5={concrete:!0,name:"htmlFlow",resolveTo:X5,tokenize:Z5},J5={partial:!0,tokenize:t$},K5={partial:!0,tokenize:e$};function X5(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function Z5(e,n,t){const r=this;let a,o,l,d,f;return u;function u(I){return p(I)}function p(I){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(I),g}function g(I){return I===33?(e.consume(I),b):I===47?(e.consume(I),o=!0,k):I===63?(e.consume(I),a=3,r.interrupt?n:E):Vi(I)?(e.consume(I),l=String.fromCharCode(I),T):t(I)}function b(I){return I===45?(e.consume(I),a=2,v):I===91?(e.consume(I),a=5,d=0,S):Vi(I)?(e.consume(I),a=4,r.interrupt?n:E):t(I)}function v(I){return I===45?(e.consume(I),r.interrupt?n:E):t(I)}function S(I){const de="CDATA[";return I===de.charCodeAt(d++)?(e.consume(I),d===de.length?r.interrupt?n:H:S):t(I)}function k(I){return Vi(I)?(e.consume(I),l=String.fromCharCode(I),T):t(I)}function T(I){if(I===null||I===47||I===62||er(I)){const de=I===47,fe=l.toLowerCase();return!de&&!o&&aC.includes(fe)?(a=1,r.interrupt?n(I):H(I)):W5.includes(l.toLowerCase())?(a=6,de?(e.consume(I),A):r.interrupt?n(I):H(I)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(I):o?M(I):R(I))}return I===45||ji(I)?(e.consume(I),l+=String.fromCharCode(I),T):t(I)}function A(I){return I===62?(e.consume(I),r.interrupt?n:H):t(I)}function M(I){return mn(I)?(e.consume(I),M):D(I)}function R(I){return I===47?(e.consume(I),D):I===58||I===95||Vi(I)?(e.consume(I),z):mn(I)?(e.consume(I),R):D(I)}function z(I){return I===45||I===46||I===58||I===95||ji(I)?(e.consume(I),z):F(I)}function F(I){return I===61?(e.consume(I),L):mn(I)?(e.consume(I),F):R(I)}function L(I){return I===null||I===60||I===61||I===62||I===96?t(I):I===34||I===39?(e.consume(I),f=I,U):mn(I)?(e.consume(I),L):B(I)}function U(I){return I===f?(e.consume(I),f=null,J):I===null||Ot(I)?t(I):(e.consume(I),U)}function B(I){return I===null||I===34||I===39||I===47||I===60||I===61||I===62||I===96||er(I)?F(I):(e.consume(I),B)}function J(I){return I===47||I===62||mn(I)?R(I):t(I)}function D(I){return I===62?(e.consume(I),$):t(I)}function $(I){return I===null||Ot(I)?H(I):mn(I)?(e.consume(I),$):t(I)}function H(I){return I===45&&a===2?(e.consume(I),V):I===60&&a===1?(e.consume(I),ae):I===62&&a===4?(e.consume(I),ce):I===63&&a===3?(e.consume(I),E):I===93&&a===5?(e.consume(I),le):Ot(I)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(J5,ue,te)(I)):I===null||Ot(I)?(e.exit("htmlFlowData"),te(I)):(e.consume(I),H)}function te(I){return e.check(K5,Q,ue)(I)}function Q(I){return e.enter("lineEnding"),e.consume(I),e.exit("lineEnding"),Y}function Y(I){return I===null||Ot(I)?te(I):(e.enter("htmlFlowData"),H(I))}function V(I){return I===45?(e.consume(I),E):H(I)}function ae(I){return I===47?(e.consume(I),l="",re):H(I)}function re(I){if(I===62){const de=l.toLowerCase();return aC.includes(de)?(e.consume(I),ce):H(I)}return Vi(I)&&l.length<8?(e.consume(I),l+=String.fromCharCode(I),re):H(I)}function le(I){return I===93?(e.consume(I),E):H(I)}function E(I){return I===62?(e.consume(I),ce):I===45&&a===2?(e.consume(I),E):H(I)}function ce(I){return I===null||Ot(I)?(e.exit("htmlFlowData"),ue(I)):(e.consume(I),ce)}function ue(I){return e.exit("htmlFlow"),n(I)}}function e$(e,n,t){const r=this;return a;function a(l){return Ot(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o):t(l)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}function t$(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(cg,n,t)}}const n$={name:"htmlText",tokenize:r$};function r$(e,n,t){const r=this;let a,o,l;return d;function d(E){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(E),f}function f(E){return E===33?(e.consume(E),u):E===47?(e.consume(E),F):E===63?(e.consume(E),R):Vi(E)?(e.consume(E),B):t(E)}function u(E){return E===45?(e.consume(E),p):E===91?(e.consume(E),o=0,S):Vi(E)?(e.consume(E),M):t(E)}function p(E){return E===45?(e.consume(E),v):t(E)}function g(E){return E===null?t(E):E===45?(e.consume(E),b):Ot(E)?(l=g,ae(E)):(e.consume(E),g)}function b(E){return E===45?(e.consume(E),v):g(E)}function v(E){return E===62?V(E):E===45?b(E):g(E)}function S(E){const ce="CDATA[";return E===ce.charCodeAt(o++)?(e.consume(E),o===ce.length?k:S):t(E)}function k(E){return E===null?t(E):E===93?(e.consume(E),T):Ot(E)?(l=k,ae(E)):(e.consume(E),k)}function T(E){return E===93?(e.consume(E),A):k(E)}function A(E){return E===62?V(E):E===93?(e.consume(E),A):k(E)}function M(E){return E===null||E===62?V(E):Ot(E)?(l=M,ae(E)):(e.consume(E),M)}function R(E){return E===null?t(E):E===63?(e.consume(E),z):Ot(E)?(l=R,ae(E)):(e.consume(E),R)}function z(E){return E===62?V(E):R(E)}function F(E){return Vi(E)?(e.consume(E),L):t(E)}function L(E){return E===45||ji(E)?(e.consume(E),L):U(E)}function U(E){return Ot(E)?(l=U,ae(E)):mn(E)?(e.consume(E),U):V(E)}function B(E){return E===45||ji(E)?(e.consume(E),B):E===47||E===62||er(E)?J(E):t(E)}function J(E){return E===47?(e.consume(E),V):E===58||E===95||Vi(E)?(e.consume(E),D):Ot(E)?(l=J,ae(E)):mn(E)?(e.consume(E),J):V(E)}function D(E){return E===45||E===46||E===58||E===95||ji(E)?(e.consume(E),D):$(E)}function $(E){return E===61?(e.consume(E),H):Ot(E)?(l=$,ae(E)):mn(E)?(e.consume(E),$):J(E)}function H(E){return E===null||E===60||E===61||E===62||E===96?t(E):E===34||E===39?(e.consume(E),a=E,te):Ot(E)?(l=H,ae(E)):mn(E)?(e.consume(E),H):(e.consume(E),Q)}function te(E){return E===a?(e.consume(E),a=void 0,Y):E===null?t(E):Ot(E)?(l=te,ae(E)):(e.consume(E),te)}function Q(E){return E===null||E===34||E===39||E===60||E===61||E===96?t(E):E===47||E===62||er(E)?J(E):(e.consume(E),Q)}function Y(E){return E===47||E===62||er(E)?J(E):t(E)}function V(E){return E===62?(e.consume(E),e.exit("htmlTextData"),e.exit("htmlText"),n):t(E)}function ae(E){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(E),e.exit("lineEnding"),re}function re(E){return mn(E)?jn(e,le,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(E):le(E)}function le(E){return e.enter("htmlTextData"),l(E)}}const _w={name:"labelEnd",resolveAll:o$,resolveTo:l$,tokenize:c$},i$={tokenize:u$},a$={tokenize:d$},s$={tokenize:f$};function o$(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&Oa(e,0,e.length,t),e}function l$(e,n){let t=e.length,r=0,a,o,l,d;for(;t--;)if(a=e[t][1],o){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(o=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(l=t);const f={type:e[o][1].type==="labelLink"?"link":"image",start:{...e[o][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[o][1].start},end:{...e[l][1].end}},p={type:"labelText",start:{...e[o+r+2][1].end},end:{...e[l-2][1].start}};return d=[["enter",f,n],["enter",u,n]],d=us(d,e.slice(o+1,o+r+3)),d=us(d,[["enter",p,n]]),d=us(d,Tb(n.parser.constructs.insideSpan.null,e.slice(o+r+4,l-3),n)),d=us(d,[["exit",p,n],e[l-2],e[l-1],["exit",u,n]]),d=us(d,e.slice(l+1)),d=us(d,[["exit",f,n]]),Oa(e,o,e.length,d),e}function c$(e,n,t){const r=this;let a=r.events.length,o,l;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){o=r.events[a][1];break}return d;function d(b){return o?o._inactive?g(b):(l=r.parser.defined.includes(Hs(r.sliceSerialize({start:o.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),f):t(b)}function f(b){return b===40?e.attempt(i$,p,l?p:g)(b):b===91?e.attempt(a$,p,l?u:g)(b):l?p(b):g(b)}function u(b){return e.attempt(s$,p,g)(b)}function p(b){return n(b)}function g(b){return o._balanced=!0,t(b)}}function u$(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return er(g)?Bm(e,o)(g):o(g)}function o(g){return g===41?p(g):n2(e,l,d,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function l(g){return er(g)?Bm(e,f)(g):p(g)}function d(g){return t(g)}function f(g){return g===34||g===39||g===40?i2(e,u,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):p(g)}function u(g){return er(g)?Bm(e,p)(g):p(g)}function p(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function d$(e,n,t){const r=this;return a;function a(d){return r2.call(r,e,o,l,"reference","referenceMarker","referenceString")(d)}function o(d){return r.parser.defined.includes(Hs(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(d):t(d)}function l(d){return t(d)}}function f$(e,n,t){return r;function r(o){return e.enter("reference"),e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),a}function a(o){return o===93?(e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),e.exit("reference"),n):t(o)}}const h$={name:"labelStartImage",resolveAll:_w.resolveAll,tokenize:p$};function p$(e,n,t){const r=this;return a;function a(d){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(d),e.exit("labelImageMarker"),o}function o(d){return d===91?(e.enter("labelMarker"),e.consume(d),e.exit("labelMarker"),e.exit("labelImage"),l):t(d)}function l(d){return d===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(d):n(d)}}const m$={name:"labelStartLink",resolveAll:_w.resolveAll,tokenize:g$};function g$(e,n,t){const r=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),o}function o(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(l):n(l)}}const e0={name:"lineEnding",tokenize:y$};function y$(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),jn(e,n,"linePrefix")}}const Fx={name:"thematicBreak",tokenize:x$};function x$(e,n,t){let r=0,a;return o;function o(u){return e.enter("thematicBreak"),l(u)}function l(u){return a=u,d(u)}function d(u){return u===a?(e.enter("thematicBreakSequence"),f(u)):r>=3&&(u===null||Ot(u))?(e.exit("thematicBreak"),n(u)):t(u)}function f(u){return u===a?(e.consume(u),r++,f):(e.exit("thematicBreakSequence"),mn(u)?jn(e,d,"whitespace")(u):d(u))}}const ca={continuation:{tokenize:S$},exit:C$,name:"list",tokenize:w$},b$={partial:!0,tokenize:_$},v$={partial:!0,tokenize:N$};function w$(e,n,t){const r=this,a=r.events[r.events.length-1];let o=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return d;function d(v){const S=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:y1(v)){if(r.containerState.type||(r.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(Fx,t,u)(v):u(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),f(v)}return t(v)}function f(v){return y1(v)&&++l<10?(e.consume(v),f):(!r.interrupt||l<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),u(v)):t(v)}function u(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(cg,r.interrupt?t:p,e.attempt(b$,b,g))}function p(v){return r.containerState.initialBlankLine=!0,o++,b(v)}function g(v){return mn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=o+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function S$(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(cg,a,o);function a(d){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,jn(e,n,"listItemIndent",r.containerState.size+1)(d)}function o(d){return r.containerState.furtherBlankLines||!mn(d)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,l(d)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(v$,n,l)(d))}function l(d){return r.containerState._closeFlow=!0,r.interrupt=void 0,jn(e,e.attempt(ca,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(d)}}function N$(e,n,t){const r=this;return jn(e,a,"listItemIndent",r.containerState.size+1);function a(o){const l=r.events[r.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===r.containerState.size?n(o):t(o)}}function C$(e){e.exit(this.containerState.type)}function _$(e,n,t){const r=this;return jn(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(o){const l=r.events[r.events.length-1];return!mn(o)&&l&&l[1].type==="listItemPrefixWhitespace"?n(o):t(o)}}const sC={name:"setextUnderline",resolveTo:j$,tokenize:k$};function j$(e,n){let t=e.length,r,a,o;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!o&&e[t][1].type==="definition"&&(o=t);const l={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",o?(e.splice(a,0,["enter",l,n]),e.splice(o+1,0,["exit",e[r][1],n]),e[r][1].end={...e[o][1].end}):e[r][1]=l,e.push(["exit",l,n]),e}function k$(e,n,t){const r=this;let a;return o;function o(u){let p=r.events.length,g;for(;p--;)if(r.events[p][1].type!=="lineEnding"&&r.events[p][1].type!=="linePrefix"&&r.events[p][1].type!=="content"){g=r.events[p][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=u,l(u)):t(u)}function l(u){return e.enter("setextHeadingLineSequence"),d(u)}function d(u){return u===a?(e.consume(u),d):(e.exit("setextHeadingLineSequence"),mn(u)?jn(e,f,"lineSuffix")(u):f(u))}function f(u){return u===null||Ot(u)?(e.exit("setextHeadingLine"),n(u)):t(u)}}const T$={tokenize:E$};function E$(e){const n=this,t=e.attempt(cg,r,e.attempt(this.parser.constructs.flowInitial,a,jn(e,e.attempt(this.parser.constructs.flow,a,e.attempt(R5,a)),"linePrefix")));return t;function r(o){if(o===null){e.consume(o);return}return e.enter("lineEndingBlank"),e.consume(o),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const A$={resolveAll:s2()},P$=a2("string"),D$=a2("text");function a2(e){return{resolveAll:s2(e==="text"?I$:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],o=t.attempt(a,l,d);return l;function l(p){return u(p)?o(p):d(p)}function d(p){if(p===null){t.consume(p);return}return t.enter("data"),t.consume(p),f}function f(p){return u(p)?(t.exit("data"),o(p)):(t.consume(p),f)}function u(p){if(p===null)return!0;const g=a[p];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function s2(e){return n;function n(t,r){let a=-1,o;for(;++a<=t.length;)o===void 0?t[a]&&t[a][1].type==="data"&&(o=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==o+2&&(t[o][1].end=t[a-1][1].end,t.splice(o+2,a-o-2),a=o+2),o=void 0);return e?e(t,r):t}}function I$(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let o=a.length,l=-1,d=0,f;for(;o--;){const u=a[o];if(typeof u=="string"){for(l=u.length;u.charCodeAt(l-1)===32;)d++,l--;if(l)break;l=-1}else if(u===-2)f=!0,d++;else if(u!==-1){o++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(d=0),d){const u={type:t===e.length||f||d<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?l:r.start._bufferIndex+l,_index:r.start._index+o,line:r.end.line,column:r.end.column-d,offset:r.end.offset-d},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(t,0,["enter",u,n],["exit",u,n]),t+=2)}t++}return e}const R$={42:ca,43:ca,45:ca,48:ca,49:ca,50:ca,51:ca,52:ca,53:ca,54:ca,55:ca,56:ca,57:ca,62:Xk},M$={91:$5},O$={[-2]:Zv,[-1]:Zv,32:Zv},L$={35:H5,42:Fx,45:[sC,Fx],60:Q5,61:sC,95:Fx,96:iC,126:iC},F$={38:e2,92:Zk},$$={[-5]:e0,[-4]:e0,[-3]:e0,33:h$,38:e2,42:x1,60:[m5,n$],91:m$,92:[q5,Zk],93:_w,95:x1,96:T5},z$={null:[x1,A$]},U$={null:[42,95]},B$={null:[]},q$=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:U$,contentInitial:M$,disable:B$,document:R$,flow:L$,flowInitial:O$,insideSpan:z$,string:F$,text:$$},Symbol.toStringTag,{value:"Module"}));function V$(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},o=[];let l=[],d=[];const f={attempt:U(F),check:U(L),consume:M,enter:R,exit:z,interrupt:U(L,{interrupt:!0})},u={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let p=n.tokenize.call(u,f);return n.resolveAll&&o.push(n),u;function g($){return l=us(l,$),T(),l[l.length-1]!==null?[]:(B(n,0),u.events=Tb(o,u.events,u),u.events)}function b($,H){return G$(v($),H)}function v($){return H$(l,$)}function S(){const{_bufferIndex:$,_index:H,line:te,column:Q,offset:Y}=r;return{_bufferIndex:$,_index:H,line:te,column:Q,offset:Y}}function k($){a[$.line]=$.column,D()}function T(){let $;for(;r._index<l.length;){const H=l[r._index];if(typeof H=="string")for($=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===$&&r._bufferIndex<H.length;)A(H.charCodeAt(r._bufferIndex));else A(H)}}function A($){p=p($)}function M($){Ot($)?(r.line++,r.column=1,r.offset+=$===-3?2:1,D()):$!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===l[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=$}function R($,H){const te=H||{};return te.type=$,te.start=S(),u.events.push(["enter",te,u]),d.push(te),te}function z($){const H=d.pop();return H.end=S(),u.events.push(["exit",H,u]),H}function F($,H){B($,H.from)}function L($,H){H.restore()}function U($,H){return te;function te(Q,Y,V){let ae,re,le,E;return Array.isArray(Q)?ue(Q):"tokenize"in Q?ue([Q]):ce(Q);function ce(W){return oe;function oe(se){const je=se!==null&&W[se],We=se!==null&&W.null,X=[...Array.isArray(je)?je:je?[je]:[],...Array.isArray(We)?We:We?[We]:[]];return ue(X)(se)}}function ue(W){return ae=W,re=0,W.length===0?V:I(W[re])}function I(W){return oe;function oe(se){return E=J(),le=W,W.partial||(u.currentConstruct=W),W.name&&u.parser.constructs.disable.null.includes(W.name)?fe():W.tokenize.call(H?Object.assign(Object.create(u),H):u,f,de,fe)(se)}}function de(W){return $(le,E),Y}function fe(W){return E.restore(),++re<ae.length?I(ae[re]):V}}}function B($,H){$.resolveAll&&!o.includes($)&&o.push($),$.resolve&&Oa(u.events,H,u.events.length-H,$.resolve(u.events.slice(H),u)),$.resolveTo&&(u.events=$.resolveTo(u.events,u))}function J(){const $=S(),H=u.previous,te=u.currentConstruct,Q=u.events.length,Y=Array.from(d);return{from:Q,restore:V};function V(){r=$,u.previous=H,u.currentConstruct=te,u.events.length=Q,d=Y,D()}}function D(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function H$(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,o=n.end._bufferIndex;let l;if(t===a)l=[e[t].slice(r,o)];else{if(l=e.slice(t,a),r>-1){const d=l[0];typeof d=="string"?l[0]=d.slice(r):l.shift()}o>0&&l.push(e[a].slice(0,o))}return l}function G$(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const o=e[t];let l;if(typeof o=="string")l=o;else switch(o){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=n?" ":"	";break}case-1:{if(!n&&a)continue;l=" ";break}default:l=String.fromCharCode(o)}a=o===-2,r.push(l)}return r.join("")}function Y$(e){const r={constructs:Jk([q$,...(e||{}).extensions||[]]),content:a(l5),defined:[],document:a(u5),flow:a(T$),lazy:{},string:a(P$),text:a(D$)};return r;function a(o){return l;function l(d){return V$(r,o,d)}}}function W$(e){for(;!t2(e););return e}const oC=/[\0\t\n\r]/g;function Q$(){let e=1,n="",t=!0,r;return a;function a(o,l,d){const f=[];let u,p,g,b,v;for(o=n+(typeof o=="string"?o.toString():new TextDecoder(l||void 0).decode(o)),g=0,n="",t&&(o.charCodeAt(0)===65279&&g++,t=void 0);g<o.length;){if(oC.lastIndex=g,u=oC.exec(o),b=u&&u.index!==void 0?u.index:o.length,v=o.charCodeAt(b),!u){n=o.slice(g);break}if(v===10&&g===b&&r)f.push(-3),r=void 0;else switch(r&&(f.push(-5),r=void 0),g<b&&(f.push(o.slice(g,b)),e+=b-g),v){case 0:{f.push(65533),e++;break}case 9:{for(p=Math.ceil(e/4)*4,f.push(-2);e++<p;)f.push(-1);break}case 10:{f.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return d&&(r&&f.push(-5),n&&f.push(n),f.push(null)),f}}const J$=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function K$(e){return e.replace(J$,X$)}function X$(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),o=a===120||a===88;return Kk(t.slice(o?2:1),o?16:10)}return Cw(t)||e}const o2={}.hasOwnProperty;function Z$(e,n,t){return typeof n!="string"&&(t=n,n=void 0),ez(t)(W$(Y$(t).document().write(Q$()(e,n,!0))))}function ez(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(ot),autolinkProtocol:J,autolinkEmail:J,atxHeading:o(Ze),blockQuote:o(We),characterEscape:J,characterReference:J,codeFenced:o(X),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:o(X,l),codeText:o(Se,l),codeTextData:J,data:J,codeFlowValue:J,definition:o(Ae),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:o(Pe),hardBreakEscape:o(rt),hardBreakTrailing:o(rt),htmlFlow:o(lt,l),htmlFlowData:J,htmlText:o(lt,l),htmlTextData:J,image:o(ze),label:l,link:o(ot),listItem:o(be),listItemValue:b,listOrdered:o(at,g),listUnordered:o(at),paragraph:o($e),reference:I,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:o(Ze),strong:o(Be),thematicBreak:o(Ne)},exit:{atxHeading:f(),atxHeadingSequence:F,autolink:f(),autolinkEmail:je,autolinkProtocol:se,blockQuote:f(),characterEscapeValue:D,characterReferenceMarkerHexadecimal:fe,characterReferenceMarkerNumeric:fe,characterReferenceValue:W,characterReference:oe,codeFenced:f(T),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:D,codeIndented:f(A),codeText:f(Y),codeTextData:D,data:D,definition:f(),definitionDestinationString:z,definitionLabelString:M,definitionTitleString:R,emphasis:f(),hardBreakEscape:f(H),hardBreakTrailing:f(H),htmlFlow:f(te),htmlFlowData:D,htmlText:f(Q),htmlTextData:D,image:f(ae),label:le,labelText:re,lineEnding:$,link:f(V),listItem:f(),listOrdered:f(),listUnordered:f(),paragraph:f(),referenceString:de,resourceDestinationString:E,resourceTitleString:ce,resource:ue,setextHeading:f(B),setextHeadingLineSequence:U,setextHeadingText:L,strong:f(),thematicBreak:f()}};l2(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(K){let ge={type:"root",children:[]};const He={stack:[ge],tokenStack:[],config:n,enter:d,exit:u,buffer:l,resume:p,data:t},Qe=[];let dt=-1;for(;++dt<K.length;)if(K[dt][1].type==="listOrdered"||K[dt][1].type==="listUnordered")if(K[dt][0]==="enter")Qe.push(dt);else{const At=Qe.pop();dt=a(K,At,dt)}for(dt=-1;++dt<K.length;){const At=n[K[dt][0]];o2.call(At,K[dt][1].type)&&At[K[dt][1].type].call(Object.assign({sliceSerialize:K[dt][2].sliceSerialize},He),K[dt][1])}if(He.tokenStack.length>0){const At=He.tokenStack[He.tokenStack.length-1];(At[1]||lC).call(He,void 0,At[0])}for(ge.position={start:ru(K.length>0?K[0][1].start:{line:1,column:1,offset:0}),end:ru(K.length>0?K[K.length-2][1].end:{line:1,column:1,offset:0})},dt=-1;++dt<n.transforms.length;)ge=n.transforms[dt](ge)||ge;return ge}function a(K,ge,He){let Qe=ge-1,dt=-1,At=!1,Ht,we,xe,Me;for(;++Qe<=He;){const De=K[Qe];switch(De[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{De[0]==="enter"?dt++:dt--,Me=void 0;break}case"lineEndingBlank":{De[0]==="enter"&&(Ht&&!Me&&!dt&&!xe&&(xe=Qe),Me=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Me=void 0}if(!dt&&De[0]==="enter"&&De[1].type==="listItemPrefix"||dt===-1&&De[0]==="exit"&&(De[1].type==="listUnordered"||De[1].type==="listOrdered")){if(Ht){let qe=Qe;for(we=void 0;qe--;){const st=K[qe];if(st[1].type==="lineEnding"||st[1].type==="lineEndingBlank"){if(st[0]==="exit")continue;we&&(K[we][1].type="lineEndingBlank",At=!0),st[1].type="lineEnding",we=qe}else if(!(st[1].type==="linePrefix"||st[1].type==="blockQuotePrefix"||st[1].type==="blockQuotePrefixWhitespace"||st[1].type==="blockQuoteMarker"||st[1].type==="listItemIndent"))break}xe&&(!we||xe<we)&&(Ht._spread=!0),Ht.end=Object.assign({},we?K[we][1].start:De[1].end),K.splice(we||Qe,0,["exit",Ht,De[2]]),Qe++,He++}if(De[1].type==="listItemPrefix"){const qe={type:"listItem",_spread:!1,start:Object.assign({},De[1].start),end:void 0};Ht=qe,K.splice(Qe,0,["enter",qe,De[2]]),Qe++,He++,xe=void 0,Me=!0}}}return K[ge][1]._spread=At,He}function o(K,ge){return He;function He(Qe){d.call(this,K(Qe),Qe),ge&&ge.call(this,Qe)}}function l(){this.stack.push({type:"fragment",children:[]})}function d(K,ge,He){this.stack[this.stack.length-1].children.push(K),this.stack.push(K),this.tokenStack.push([ge,He||void 0]),K.position={start:ru(ge.start),end:void 0}}function f(K){return ge;function ge(He){K&&K.call(this,He),u.call(this,He)}}function u(K,ge){const He=this.stack.pop(),Qe=this.tokenStack.pop();if(Qe)Qe[0].type!==K.type&&(ge?ge.call(this,K,Qe[0]):(Qe[1]||lC).call(this,K,Qe[0]));else throw new Error("Cannot close `"+K.type+"` ("+Um({start:K.start,end:K.end})+"): its not open");He.position.end=ru(K.end)}function p(){return Nw(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(K){if(this.data.expectingFirstListItemValue){const ge=this.stack[this.stack.length-2];ge.start=Number.parseInt(this.sliceSerialize(K),10),this.data.expectingFirstListItemValue=void 0}}function v(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.lang=K}function S(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.meta=K}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.value=K.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function A(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.value=K.replace(/(\r?\n|\r)$/g,"")}function M(K){const ge=this.resume(),He=this.stack[this.stack.length-1];He.label=ge,He.identifier=Hs(this.sliceSerialize(K)).toLowerCase()}function R(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.title=K}function z(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.url=K}function F(K){const ge=this.stack[this.stack.length-1];if(!ge.depth){const He=this.sliceSerialize(K).length;ge.depth=He}}function L(){this.data.setextHeadingSlurpLineEnding=!0}function U(K){const ge=this.stack[this.stack.length-1];ge.depth=this.sliceSerialize(K).codePointAt(0)===61?1:2}function B(){this.data.setextHeadingSlurpLineEnding=void 0}function J(K){const He=this.stack[this.stack.length-1].children;let Qe=He[He.length-1];(!Qe||Qe.type!=="text")&&(Qe=ke(),Qe.position={start:ru(K.start),end:void 0},He.push(Qe)),this.stack.push(Qe)}function D(K){const ge=this.stack.pop();ge.value+=this.sliceSerialize(K),ge.position.end=ru(K.end)}function $(K){const ge=this.stack[this.stack.length-1];if(this.data.atHardBreak){const He=ge.children[ge.children.length-1];He.position.end=ru(K.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(ge.type)&&(J.call(this,K),D.call(this,K))}function H(){this.data.atHardBreak=!0}function te(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.value=K}function Q(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.value=K}function Y(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.value=K}function V(){const K=this.stack[this.stack.length-1];if(this.data.inReference){const ge=this.data.referenceType||"shortcut";K.type+="Reference",K.referenceType=ge,delete K.url,delete K.title}else delete K.identifier,delete K.label;this.data.referenceType=void 0}function ae(){const K=this.stack[this.stack.length-1];if(this.data.inReference){const ge=this.data.referenceType||"shortcut";K.type+="Reference",K.referenceType=ge,delete K.url,delete K.title}else delete K.identifier,delete K.label;this.data.referenceType=void 0}function re(K){const ge=this.sliceSerialize(K),He=this.stack[this.stack.length-2];He.label=K$(ge),He.identifier=Hs(ge).toLowerCase()}function le(){const K=this.stack[this.stack.length-1],ge=this.resume(),He=this.stack[this.stack.length-1];if(this.data.inReference=!0,He.type==="link"){const Qe=K.children;He.children=Qe}else He.alt=ge}function E(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.url=K}function ce(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.title=K}function ue(){this.data.inReference=void 0}function I(){this.data.referenceType="collapsed"}function de(K){const ge=this.resume(),He=this.stack[this.stack.length-1];He.label=ge,He.identifier=Hs(this.sliceSerialize(K)).toLowerCase(),this.data.referenceType="full"}function fe(K){this.data.characterReferenceType=K.type}function W(K){const ge=this.sliceSerialize(K),He=this.data.characterReferenceType;let Qe;He?(Qe=Kk(ge,He==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Qe=Cw(ge);const dt=this.stack[this.stack.length-1];dt.value+=Qe}function oe(K){const ge=this.stack.pop();ge.position.end=ru(K.end)}function se(K){D.call(this,K);const ge=this.stack[this.stack.length-1];ge.url=this.sliceSerialize(K)}function je(K){D.call(this,K);const ge=this.stack[this.stack.length-1];ge.url="mailto:"+this.sliceSerialize(K)}function We(){return{type:"blockquote",children:[]}}function X(){return{type:"code",lang:null,meta:null,value:""}}function Se(){return{type:"inlineCode",value:""}}function Ae(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Pe(){return{type:"emphasis",children:[]}}function Ze(){return{type:"heading",depth:0,children:[]}}function rt(){return{type:"break"}}function lt(){return{type:"html",value:""}}function ze(){return{type:"image",title:null,url:"",alt:null}}function ot(){return{type:"link",title:null,url:"",children:[]}}function at(K){return{type:"list",ordered:K.type==="listOrdered",start:null,spread:K._spread,children:[]}}function be(K){return{type:"listItem",spread:K._spread,checked:null,children:[]}}function $e(){return{type:"paragraph",children:[]}}function Be(){return{type:"strong",children:[]}}function ke(){return{type:"text",value:""}}function Ne(){return{type:"thematicBreak"}}}function ru(e){return{line:e.line,column:e.column,offset:e.offset}}function l2(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?l2(e,r):tz(e,r)}}function tz(e,n){let t;for(t in n)if(o2.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function lC(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+Um({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+Um({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+Um({start:n.start,end:n.end})+") is still open")}function nz(e){const n=this;n.parser=t;function t(r){return Z$(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}function rz(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function iz(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function az(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function sz(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function oz(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function lz(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=Vh(r.toLowerCase()),o=e.footnoteOrder.indexOf(r);let l,d=e.footnoteCounts.get(r);d===void 0?(d=0,e.footnoteOrder.push(r),l=e.footnoteOrder.length):l=o+1,d+=1,e.footnoteCounts.set(r,d);const f={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(d>1?"-"+d:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(n,f);const u={type:"element",tagName:"sup",properties:{},children:[f]};return e.patch(n,u),e.applyData(n,u)}function cz(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function uz(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function c2(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),o=a[0];o&&o.type==="text"?o.value="["+o.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=r:a.push({type:"text",value:r}),a}function dz(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return c2(e,n);const a={src:Vh(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,o),e.applyData(n,o)}function fz(e,n){const t={src:Vh(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function hz(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function pz(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return c2(e,n);const a={href:Vh(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,o),e.applyData(n,o)}function mz(e,n){const t={href:Vh(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function gz(e,n,t){const r=e.all(n),a=t?yz(t):u2(n),o={},l=[];if(typeof n.checked=="boolean"){const p=r[0];let g;p&&p.type==="element"&&p.tagName==="p"?g=p:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let d=-1;for(;++d<r.length;){const p=r[d];(a||d!==0||p.type!=="element"||p.tagName!=="p")&&l.push({type:"text",value:`
`}),p.type==="element"&&p.tagName==="p"&&!a?l.push(...p.children):l.push(p)}const f=r[r.length-1];f&&(a||f.type!=="element"||f.tagName!=="p")&&l.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:o,children:l};return e.patch(n,u),e.applyData(n,u)}function yz(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=u2(t[r])}return n}function u2(e){const n=e.spread;return n??e.children.length>1}function xz(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const l=r[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const o={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,o),e.applyData(n,o)}function bz(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function vz(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function wz(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Sz(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],l),a.push(l)}if(t.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},d=bw(n.children[1]),f=qk(n.children[n.children.length-1]);d&&f&&(l.position={start:d,end:f}),a.push(l)}const o={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,o),e.applyData(n,o)}function Nz(e,n,t){const r=t?t.children:void 0,o=(r?r.indexOf(n):1)===0?"th":"td",l=t&&t.type==="table"?t.align:void 0,d=l?l.length:n.children.length;let f=-1;const u=[];for(;++f<d;){const g=n.children[f],b={},v=l?l[f]:void 0;v&&(b.align=v);let S={type:"element",tagName:o,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),u.push(S)}const p={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(n,p),e.applyData(n,p)}function Cz(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const cC=9,uC=32;function _z(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const o=[];for(;r;)o.push(dC(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return o.push(dC(n.slice(a),a>0,!1)),o.join("")}function dC(e,n,t){let r=0,a=e.length;if(n){let o=e.codePointAt(r);for(;o===cC||o===uC;)r++,o=e.codePointAt(r)}if(t){let o=e.codePointAt(a-1);for(;o===cC||o===uC;)a--,o=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function jz(e,n){const t={type:"text",value:_z(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function kz(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const Tz={blockquote:rz,break:iz,code:az,delete:sz,emphasis:oz,footnoteReference:lz,heading:cz,html:uz,imageReference:dz,image:fz,inlineCode:hz,linkReference:pz,link:mz,listItem:gz,list:xz,paragraph:bz,root:vz,strong:wz,table:Sz,tableCell:Cz,tableRow:Nz,text:jz,thematicBreak:kz,toml:hx,yaml:hx,definition:hx,footnoteDefinition:hx};function hx(){}const d2=-1,Eb=0,qm=1,Xx=2,jw=3,kw=4,Tw=5,Ew=6,f2=7,h2=8,fC=typeof self=="object"?self:globalThis,Ez=(e,n)=>{const t=(a,o)=>(e.set(o,a),a),r=a=>{if(e.has(a))return e.get(a);const[o,l]=n[a];switch(o){case Eb:case d2:return t(l,a);case qm:{const d=t([],a);for(const f of l)d.push(r(f));return d}case Xx:{const d=t({},a);for(const[f,u]of l)d[r(f)]=r(u);return d}case jw:return t(new Date(l),a);case kw:{const{source:d,flags:f}=l;return t(new RegExp(d,f),a)}case Tw:{const d=t(new Map,a);for(const[f,u]of l)d.set(r(f),r(u));return d}case Ew:{const d=t(new Set,a);for(const f of l)d.add(r(f));return d}case f2:{const{name:d,message:f}=l;return t(new fC[d](f),a)}case h2:return t(BigInt(l),a);case"BigInt":return t(Object(BigInt(l)),a);case"ArrayBuffer":return t(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:d}=new Uint8Array(l);return t(new DataView(d),l)}}return t(new fC[o](l),a)};return r},hC=e=>Ez(new Map,e)(0),mh="",{toString:Az}={},{keys:Pz}=Object,Tm=e=>{const n=typeof e;if(n!=="object"||!e)return[Eb,n];const t=Az.call(e).slice(8,-1);switch(t){case"Array":return[qm,mh];case"Object":return[Xx,mh];case"Date":return[jw,mh];case"RegExp":return[kw,mh];case"Map":return[Tw,mh];case"Set":return[Ew,mh];case"DataView":return[qm,t]}return t.includes("Array")?[qm,t]:t.includes("Error")?[f2,t]:[Xx,t]},px=([e,n])=>e===Eb&&(n==="function"||n==="symbol"),Dz=(e,n,t,r)=>{const a=(l,d)=>{const f=r.push(l)-1;return t.set(d,f),f},o=l=>{if(t.has(l))return t.get(l);let[d,f]=Tm(l);switch(d){case Eb:{let p=l;switch(f){case"bigint":d=h2,p=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+f);p=null;break;case"undefined":return a([d2],l)}return a([d,p],l)}case qm:{if(f){let b=l;return f==="DataView"?b=new Uint8Array(l.buffer):f==="ArrayBuffer"&&(b=new Uint8Array(l)),a([f,[...b]],l)}const p=[],g=a([d,p],l);for(const b of l)p.push(o(b));return g}case Xx:{if(f)switch(f){case"BigInt":return a([f,l.toString()],l);case"Boolean":case"Number":case"String":return a([f,l.valueOf()],l)}if(n&&"toJSON"in l)return o(l.toJSON());const p=[],g=a([d,p],l);for(const b of Pz(l))(e||!px(Tm(l[b])))&&p.push([o(b),o(l[b])]);return g}case jw:return a([d,l.toISOString()],l);case kw:{const{source:p,flags:g}=l;return a([d,{source:p,flags:g}],l)}case Tw:{const p=[],g=a([d,p],l);for(const[b,v]of l)(e||!(px(Tm(b))||px(Tm(v))))&&p.push([o(b),o(v)]);return g}case Ew:{const p=[],g=a([d,p],l);for(const b of l)(e||!px(Tm(b)))&&p.push(o(b));return g}}const{message:u}=l;return a([d,{name:f,message:u}],l)};return o},pC=(e,{json:n,lossy:t}={})=>{const r=[];return Dz(!(n||t),!!n,new Map,r)(e),r},Zx=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?hC(pC(e,n)):structuredClone(e):(e,n)=>hC(pC(e,n));function Iz(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function Rz(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function Mz(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||Iz,r=e.options.footnoteBackLabel||Rz,a=e.options.footnoteLabel||"Footnotes",o=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},d=[];let f=-1;for(;++f<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[f]);if(!u)continue;const p=e.all(u),g=String(u.identifier).toUpperCase(),b=Vh(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let M=typeof t=="string"?t:t(f,v);typeof M=="string"&&(M={type:"text",value:M}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(f,v),className:["data-footnote-backref"]},children:Array.isArray(M)?M:[M]})}const T=p[p.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const M=T.children[T.children.length-1];M&&M.type==="text"?M.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...S)}else p.push(...S);const A={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(p,!0)};e.patch(u,A),d.push(A)}if(d.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...Zx(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(d,!0)},{type:"text",value:`
`}]}}const Ab=function(e){if(e==null)return $z;if(typeof e=="function")return Pb(e);if(typeof e=="object")return Array.isArray(e)?Oz(e):Lz(e);if(typeof e=="string")return Fz(e);throw new Error("Expected function, string, or object as test")};function Oz(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=Ab(e[t]);return Pb(r);function r(...a){let o=-1;for(;++o<n.length;)if(n[o].apply(this,a))return!0;return!1}}function Lz(e){const n=e;return Pb(t);function t(r){const a=r;let o;for(o in e)if(a[o]!==n[o])return!1;return!0}}function Fz(e){return Pb(n);function n(t){return t&&t.type===e}}function Pb(e){return n;function n(t,r,a){return!!(zz(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function $z(){return!0}function zz(e){return e!==null&&typeof e=="object"&&"type"in e}const p2=[],Uz=!0,b1=!1,Bz="skip";function m2(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const o=Ab(a),l=r?-1:1;d(e,void 0,[])();function d(f,u,p){const g=f&&typeof f=="object"?f:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(f.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=p2,S,k,T;if((!n||o(f,u,p[p.length-1]||void 0))&&(v=qz(t(f,p)),v[0]===b1))return v;if("children"in f&&f.children){const A=f;if(A.children&&v[0]!==Bz)for(k=(r?A.children.length:-1)+l,T=p.concat(A);k>-1&&k<A.children.length;){const M=A.children[k];if(S=d(M,k,T)(),S[0]===b1)return S;k=typeof S[1]=="number"?S[1]:k+l}}return v}}}function qz(e){return Array.isArray(e)?e:typeof e=="number"?[Uz,e]:e==null?p2:[e]}function Aw(e,n,t,r){let a,o,l;typeof n=="function"?(o=void 0,l=n,a=t):(o=n,l=t,a=r),m2(e,o,d,a);function d(f,u){const p=u[u.length-1],g=p?p.children.indexOf(f):void 0;return l(f,g,p)}}const v1={}.hasOwnProperty,Vz={};function Hz(e,n){const t=n||Vz,r=new Map,a=new Map,o=new Map,l={...Tz,...t.handlers},d={all:u,applyData:Yz,definitionById:r,footnoteById:a,footnoteCounts:o,footnoteOrder:[],handlers:l,one:f,options:t,patch:Gz,wrap:Qz};return Aw(e,function(p){if(p.type==="definition"||p.type==="footnoteDefinition"){const g=p.type==="definition"?r:a,b=String(p.identifier).toUpperCase();g.has(b)||g.set(b,p)}}),d;function f(p,g){const b=p.type,v=d.handlers[b];if(v1.call(d.handlers,b)&&v)return v(d,p,g);if(d.options.passThrough&&d.options.passThrough.includes(b)){if("children"in p){const{children:k,...T}=p,A=Zx(T);return A.children=d.all(p),A}return Zx(p)}return(d.options.unknownHandler||Wz)(d,p,g)}function u(p){const g=[];if("children"in p){const b=p.children;let v=-1;for(;++v<b.length;){const S=d.one(b[v],p);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=mC(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=mC(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function Gz(e,n){e.position&&(n.position=RF(e))}function Yz(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,o=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const l="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:l}}t.type==="element"&&o&&Object.assign(t.properties,Zx(o)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function Wz(e,n){const t=n.data||{},r="value"in n&&!(v1.call(t,"hProperties")||v1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function Qz(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function mC(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function gC(e,n){const t=Hz(e,n),r=t.one(e,void 0),a=Mz(t),o=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&o.children.push({type:"text",value:`
`},a),o}function Jz(e,n){return e&&"run"in e?async function(t,r){const a=gC(t,{file:r,...n});await e.run(a,r)}:function(t,r){return gC(t,{file:r,...e||n})}}function yC(e){if(e)throw e}var t0,xC;function Kz(){if(xC)return t0;xC=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(u){return typeof Array.isArray=="function"?Array.isArray(u):n.call(u)==="[object Array]"},o=function(u){if(!u||n.call(u)!=="[object Object]")return!1;var p=e.call(u,"constructor"),g=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!p&&!g)return!1;var b;for(b in u);return typeof b>"u"||e.call(u,b)},l=function(u,p){t&&p.name==="__proto__"?t(u,p.name,{enumerable:!0,configurable:!0,value:p.newValue,writable:!0}):u[p.name]=p.newValue},d=function(u,p){if(p==="__proto__")if(e.call(u,p)){if(r)return r(u,p).value}else return;return u[p]};return t0=function f(){var u,p,g,b,v,S,k=arguments[0],T=1,A=arguments.length,M=!1;for(typeof k=="boolean"&&(M=k,k=arguments[1]||{},T=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});T<A;++T)if(u=arguments[T],u!=null)for(p in u)g=d(k,p),b=d(u,p),k!==b&&(M&&b&&(o(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&o(g)?g:{},l(k,{name:p,newValue:f(M,S,b)})):typeof b<"u"&&l(k,{name:p,newValue:b}));return k},t0}var Xz=Kz();const n0=qd(Xz);function w1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function Zz(){const e=[],n={run:t,use:r};return n;function t(...a){let o=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);d(null,...a);function d(f,...u){const p=e[++o];let g=-1;if(f){l(f);return}for(;++g<a.length;)(u[g]===null||u[g]===void 0)&&(u[g]=a[g]);a=u,p?e8(p,d)(...u):l(null,...u)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function e8(e,n){let t;return r;function r(...l){const d=e.length>l.length;let f;d&&l.push(a);try{f=e.apply(this,l)}catch(u){const p=u;if(d&&t)throw p;return a(p)}d||(f&&f.then&&typeof f.then=="function"?f.then(o,a):f instanceof Error?a(f):o(f))}function a(l,...d){t||(t=!0,n(l,...d))}function o(l){a(null,l)}}const Ho={basename:t8,dirname:n8,extname:r8,join:i8,sep:"/"};function t8(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');ug(e);let t=0,r=-1,a=e.length,o;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else r<0&&(o=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let l=-1,d=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else l<0&&(o=!0,l=a+1),d>-1&&(e.codePointAt(a)===n.codePointAt(d--)?d<0&&(r=a):(d=-1,r=l));return t===r?r=l:r<0&&(r=e.length),e.slice(t,r)}function n8(e){if(ug(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function r8(e){ug(e);let n=e.length,t=-1,r=0,a=-1,o=0,l;for(;n--;){const d=e.codePointAt(n);if(d===47){if(l){r=n+1;break}continue}t<0&&(l=!0,t=n+1),d===46?a<0?a=n:o!==1&&(o=1):a>-1&&(o=-1)}return a<0||t<0||o===0||o===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function i8(...e){let n=-1,t;for(;++n<e.length;)ug(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":a8(t)}function a8(e){ug(e);const n=e.codePointAt(0)===47;let t=s8(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function s8(e,n){let t="",r=0,a=-1,o=0,l=-1,d,f;for(;++l<=e.length;){if(l<e.length)d=e.codePointAt(l);else{if(d===47)break;d=47}if(d===47){if(!(a===l-1||o===1))if(a!==l-1&&o===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(f=t.lastIndexOf("/"),f!==t.length-1){f<0?(t="",r=0):(t=t.slice(0,f),r=t.length-1-t.lastIndexOf("/")),a=l,o=0;continue}}else if(t.length>0){t="",r=0,a=l,o=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,l):t=e.slice(a+1,l),r=l-a-1;a=l,o=0}else d===46&&o>-1?o++:o=-1}return t}function ug(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const o8={cwd:l8};function l8(){return"/"}function S1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function c8(e){if(typeof e=="string")e=new URL(e);else if(!S1(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return u8(e)}function u8(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const r0=["history","path","basename","stem","extname","dirname"];let g2=class{constructor(n){let t;n?S1(n)?t={path:n}:typeof n=="string"||d8(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":o8.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<r0.length;){const o=r0[r];o in t&&t[o]!==void 0&&t[o]!==null&&(this[o]=o==="history"?[...t[o]]:t[o])}let a;for(a in t)r0.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?Ho.basename(this.path):void 0}set basename(n){a0(n,"basename"),i0(n,"basename"),this.path=Ho.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?Ho.dirname(this.path):void 0}set dirname(n){bC(this.basename,"dirname"),this.path=Ho.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?Ho.extname(this.path):void 0}set extname(n){if(i0(n,"extname"),bC(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Ho.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){S1(n)&&(n=c8(n)),a0(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?Ho.basename(this.path,this.extname):void 0}set stem(n){a0(n,"stem"),i0(n,"stem"),this.path=Ho.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new Ti(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}};function i0(e,n){if(e&&e.includes(Ho.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+Ho.sep+"`")}function a0(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function bC(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function d8(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const f8=function(e){const r=this.constructor.prototype,a=r[e],o=function(){return a.apply(o,arguments)};return Object.setPrototypeOf(o,r),o},h8={}.hasOwnProperty;let p8=class y2 extends f8{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=Zz()}copy(){const n=new y2;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data(n0(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(l0("data",this.frozen),this.namespace[n]=t,this):h8.call(this.namespace,n)&&this.namespace[n]||void 0:n?(l0("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=mx(n),r=this.parser||this.Parser;return s0("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),s0("process",this.parser||this.Parser),o0("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(o,l){const d=mx(n),f=r.parse(d);r.run(f,d,function(p,g,b){if(p||!g||!b)return u(p);const v=g,S=r.stringify(v,b);y8(S)?b.value=S:b.result=S,u(p,b)});function u(p,g){p||!g?l(p):o?o(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),s0("processSync",this.parser||this.Parser),o0("processSync",this.compiler||this.Compiler),this.process(n,a),wC("processSync","process",t),r;function a(o,l){t=!0,yC(o),r=l}}run(n,t,r){vC(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?o(void 0,r):new Promise(o);function o(l,d){const f=mx(t);a.run(n,f,u);function u(p,g,b){const v=g||n;p?d(p):l?l(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,o),wC("runSync","run",r),a;function o(l,d){yC(l),a=d,r=!0}}stringify(n,t){this.freeze();const r=mx(t),a=this.compiler||this.Compiler;return o0("stringify",a),vC(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(l0("use",this.frozen),n!=null)if(typeof n=="function")f(n,t);else if(typeof n=="object")Array.isArray(n)?d(n):l(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function o(u){if(typeof u=="function")f(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[p,...g]=u;f(p,g)}else l(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function l(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");d(u.plugins),u.settings&&(a.settings=n0(!0,a.settings,u.settings))}function d(u){let p=-1;if(u!=null)if(Array.isArray(u))for(;++p<u.length;){const g=u[p];o(g)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function f(u,p){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===u){b=g;break}if(b===-1)r.push([u,...p]);else if(p.length>0){let[v,...S]=p;const k=r[b][1];w1(k)&&w1(v)&&(v=n0(!0,k,v)),r[b]=[u,v,...S]}}}};const m8=new p8().freeze();function s0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function o0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function l0(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function vC(e){if(!w1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function wC(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function mx(e){return g8(e)?e:new g2(e)}function g8(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function y8(e){return typeof e=="string"||x8(e)}function x8(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const b8="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",SC=[],NC={allowDangerousHtml:!0},v8=/^(https?|ircs?|mailto|xmpp)$/i,w8=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Vs(e){const n=S8(e),t=N8(e);return C8(n.runSync(n.parse(t),t),e)}function S8(e){const n=e.rehypePlugins||SC,t=e.remarkPlugins||SC,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...NC}:NC;return m8().use(nz).use(t).use(Jz,r).use(n)}function N8(e){const n=e.children||"",t=new g2;return typeof n=="string"&&(t.value=n),t}function C8(e,n){const t=n.allowedElements,r=n.allowElement,a=n.components,o=n.disallowedElements,l=n.skipHtml,d=n.unwrapDisallowed,f=n.urlTransform||_8;for(const p of w8)Object.hasOwn(n,p.from)&&(""+p.from+(p.to?"use `"+p.to+"` instead":"remove it")+b8+p.id,void 0);return Aw(e,u),$F(e,{Fragment:i.Fragment,components:a,ignoreInvalidStyle:!0,jsx:i.jsx,jsxs:i.jsxs,passKeys:!0,passNode:!0});function u(p,g,b){if(p.type==="raw"&&b&&typeof g=="number")return l?b.children.splice(g,1):b.children[g]={type:"text",value:p.value},g;if(p.type==="element"){let v;for(v in Xv)if(Object.hasOwn(Xv,v)&&Object.hasOwn(p.properties,v)){const S=p.properties[v],k=Xv[v];(k===null||k.includes(p.tagName))&&(p.properties[v]=f(String(S||""),v,p))}}if(p.type==="element"){let v=t?!t.includes(p.tagName):o?o.includes(p.tagName):!1;if(!v&&r&&typeof g=="number"&&(v=!r(p,g,b)),v&&b&&typeof g=="number")return d&&p.children?b.children.splice(g,1,...p.children):b.children.splice(g,1),g}}}function _8(e){const n=e.indexOf(":"),t=e.indexOf("?"),r=e.indexOf("#"),a=e.indexOf("/");return n===-1||a!==-1&&n>a||t!==-1&&n>t||r!==-1&&n>r||v8.test(e.slice(0,n))?e:""}function CC(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function j8(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function k8(e,n,t){const a=Ab((t||{}).ignore||[]),o=T8(n);let l=-1;for(;++l<o.length;)m2(e,"text",d);function d(u,p){let g=-1,b;for(;++g<p.length;){const v=p[g],S=b?b.children:void 0;if(a(v,S?S.indexOf(v):void 0,b))return;b=v}if(b)return f(u,p)}function f(u,p){const g=p[p.length-1],b=o[l][0],v=o[l][1];let S=0;const T=g.children.indexOf(u);let A=!1,M=[];b.lastIndex=0;let R=b.exec(u.value);for(;R;){const z=R.index,F={index:R.index,input:R.input,stack:[...p,u]};let L=v(...R,F);if(typeof L=="string"&&(L=L.length>0?{type:"text",value:L}:void 0),L===!1?b.lastIndex=z+1:(S!==z&&M.push({type:"text",value:u.value.slice(S,z)}),Array.isArray(L)?M.push(...L):L&&M.push(L),S=z+R[0].length,A=!0),!b.global)break;R=b.exec(u.value)}return A?(S<u.value.length&&M.push({type:"text",value:u.value.slice(S)}),g.children.splice(T,1,...M)):M=[u],T+M.length}}function T8(e){const n=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const t=!e[0]||Array.isArray(e[0])?e:[e];let r=-1;for(;++r<t.length;){const a=t[r];n.push([E8(a[0]),A8(a[1])])}return n}function E8(e){return typeof e=="string"?new RegExp(j8(e),"g"):e}function A8(e){return typeof e=="function"?e:function(){return e}}const c0="phrasing",u0=["autolink","link","image","label"];function P8(){return{transforms:[F8],enter:{literalAutolink:I8,literalAutolinkEmail:d0,literalAutolinkHttp:d0,literalAutolinkWww:d0},exit:{literalAutolink:L8,literalAutolinkEmail:O8,literalAutolinkHttp:R8,literalAutolinkWww:M8}}}function D8(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:c0,notInConstruct:u0},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:c0,notInConstruct:u0},{character:":",before:"[ps]",after:"\\/",inConstruct:c0,notInConstruct:u0}]}}function I8(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function d0(e){this.config.enter.autolinkProtocol.call(this,e)}function R8(e){this.config.exit.autolinkProtocol.call(this,e)}function M8(e){this.config.exit.data.call(this,e);const n=this.stack[this.stack.length-1];n.type,n.url="http://"+this.sliceSerialize(e)}function O8(e){this.config.exit.autolinkEmail.call(this,e)}function L8(e){this.exit(e)}function F8(e){k8(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,$8],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),z8]],{ignore:["link","linkReference"]})}function $8(e,n,t,r,a){let o="";if(!x2(a)||(/^w/i.test(n)&&(t=n+t,n="",o="http://"),!U8(t)))return!1;const l=B8(t+r);if(!l[0])return!1;const d={type:"link",title:null,url:o+n+l[0],children:[{type:"text",value:n+l[0]}]};return l[1]?[d,{type:"text",value:l[1]}]:d}function z8(e,n,t,r){return!x2(r,!0)||/[-\d_]$/.test(t)?!1:{type:"link",title:null,url:"mailto:"+n+"@"+t,children:[{type:"text",value:n+"@"+t}]}}function U8(e){const n=e.split(".");return!(n.length<2||n[n.length-1]&&(/_/.test(n[n.length-1])||!/[a-zA-Z\d]/.test(n[n.length-1]))||n[n.length-2]&&(/_/.test(n[n.length-2])||!/[a-zA-Z\d]/.test(n[n.length-2])))}function B8(e){const n=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!n)return[e,void 0];e=e.slice(0,n.index);let t=n[0],r=t.indexOf(")");const a=CC(e,"(");let o=CC(e,")");for(;r!==-1&&a>o;)e+=t.slice(0,r+1),t=t.slice(r+1),r=t.indexOf(")"),o++;return[e,t]}function x2(e,n){const t=e.input.charCodeAt(e.index-1);return(e.index===0||$d(t)||kb(t))&&(!n||t!==47)}b2.peek=K8;function q8(){this.buffer()}function V8(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function H8(){this.buffer()}function G8(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function Y8(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=Hs(this.sliceSerialize(e)).toLowerCase(),t.label=n}function W8(e){this.exit(e)}function Q8(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=Hs(this.sliceSerialize(e)).toLowerCase(),t.label=n}function J8(e){this.exit(e)}function K8(){return"["}function b2(e,n,t,r){const a=t.createTracker(r);let o=a.move("[^");const l=t.enter("footnoteReference"),d=t.enter("reference");return o+=a.move(t.safe(t.associationId(e),{after:"]",before:o})),d(),l(),o+=a.move("]"),o}function X8(){return{enter:{gfmFootnoteCallString:q8,gfmFootnoteCall:V8,gfmFootnoteDefinitionLabelString:H8,gfmFootnoteDefinition:G8},exit:{gfmFootnoteCallString:Y8,gfmFootnoteCall:W8,gfmFootnoteDefinitionLabelString:Q8,gfmFootnoteDefinition:J8}}}function Z8(e){let n=!1;return e&&e.firstLineBlank&&(n=!0),{handlers:{footnoteDefinition:t,footnoteReference:b2},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function t(r,a,o,l){const d=o.createTracker(l);let f=d.move("[^");const u=o.enter("footnoteDefinition"),p=o.enter("label");return f+=d.move(o.safe(o.associationId(r),{before:f,after:"]"})),p(),f+=d.move("]:"),r.children&&r.children.length>0&&(d.shift(4),f+=d.move((n?`
`:" ")+o.indentLines(o.containerFlow(r,d.current()),n?v2:eU))),u(),f}}function eU(e,n,t){return n===0?e:v2(e,n,t)}function v2(e,n,t){return(t?"":"    ")+e}const tU=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];w2.peek=sU;function nU(){return{canContainEols:["delete"],enter:{strikethrough:iU},exit:{strikethrough:aU}}}function rU(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:tU}],handlers:{delete:w2}}}function iU(e){this.enter({type:"delete",children:[]},e)}function aU(e){this.exit(e)}function w2(e,n,t,r){const a=t.createTracker(r),o=t.enter("strikethrough");let l=a.move("~~");return l+=t.containerPhrasing(e,{...a.current(),before:l,after:"~"}),l+=a.move("~~"),o(),l}function sU(){return"~"}function oU(e){return e.length}function lU(e,n){const t=n||{},r=(t.align||[]).concat(),a=t.stringLength||oU,o=[],l=[],d=[],f=[];let u=0,p=-1;for(;++p<e.length;){const k=[],T=[];let A=-1;for(e[p].length>u&&(u=e[p].length);++A<e[p].length;){const M=cU(e[p][A]);if(t.alignDelimiters!==!1){const R=a(M);T[A]=R,(f[A]===void 0||R>f[A])&&(f[A]=R)}k.push(M)}l[p]=k,d[p]=T}let g=-1;if(typeof r=="object"&&"length"in r)for(;++g<u;)o[g]=_C(r[g]);else{const k=_C(r);for(;++g<u;)o[g]=k}g=-1;const b=[],v=[];for(;++g<u;){const k=o[g];let T="",A="";k===99?(T=":",A=":"):k===108?T=":":k===114&&(A=":");let M=t.alignDelimiters===!1?1:Math.max(1,f[g]-T.length-A.length);const R=T+"-".repeat(M)+A;t.alignDelimiters!==!1&&(M=T.length+M+A.length,M>f[g]&&(f[g]=M),v[g]=M),b[g]=R}l.splice(1,0,b),d.splice(1,0,v),p=-1;const S=[];for(;++p<l.length;){const k=l[p],T=d[p];g=-1;const A=[];for(;++g<u;){const M=k[g]||"";let R="",z="";if(t.alignDelimiters!==!1){const F=f[g]-(T[g]||0),L=o[g];L===114?R=" ".repeat(F):L===99?F%2?(R=" ".repeat(F/2+.5),z=" ".repeat(F/2-.5)):(R=" ".repeat(F/2),z=R):z=" ".repeat(F)}t.delimiterStart!==!1&&!g&&A.push("|"),t.padding!==!1&&!(t.alignDelimiters===!1&&M==="")&&(t.delimiterStart!==!1||g)&&A.push(" "),t.alignDelimiters!==!1&&A.push(R),A.push(M),t.alignDelimiters!==!1&&A.push(z),t.padding!==!1&&A.push(" "),(t.delimiterEnd!==!1||g!==u-1)&&A.push("|")}S.push(t.delimiterEnd===!1?A.join("").replace(/ +$/,""):A.join(""))}return S.join(`
`)}function cU(e){return e==null?"":String(e)}function _C(e){const n=typeof e=="string"?e.codePointAt(0):0;return n===67||n===99?99:n===76||n===108?108:n===82||n===114?114:0}function uU(e,n,t,r){const a=t.enter("blockquote"),o=t.createTracker(r);o.move("> "),o.shift(2);const l=t.indentLines(t.containerFlow(e,o.current()),dU);return a(),l}function dU(e,n,t){return">"+(t?"":" ")+e}function fU(e,n){return jC(e,n.inConstruct,!0)&&!jC(e,n.notInConstruct,!1)}function jC(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function kC(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&fU(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function hU(e,n){const t=String(e);let r=t.indexOf(n),a=r,o=0,l=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++o>l&&(l=o):o=1,a=r+n.length,r=t.indexOf(n,a);return l}function pU(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function mU(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function gU(e,n,t,r){const a=mU(t),o=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if(pU(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(o,yU);return g(),b}const d=t.createTracker(r),f=a.repeat(Math.max(hU(o,a)+1,3)),u=t.enter("codeFenced");let p=d.move(f);if(e.lang){const g=t.enter(`codeFencedLang${l}`);p+=d.move(t.safe(e.lang,{before:p,after:" ",encode:["`"],...d.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${l}`);p+=d.move(" "),p+=d.move(t.safe(e.meta,{before:p,after:`
`,encode:["`"],...d.current()})),g()}return p+=d.move(`
`),o&&(p+=d.move(o+`
`)),p+=d.move(f),u(),p}function yU(e,n,t){return(t?"":"    ")+e}function Pw(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function xU(e,n,t,r){const a=Pw(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("definition");let d=t.enter("label");const f=t.createTracker(r);let u=f.move("[");return u+=f.move(t.safe(t.associationId(e),{before:u,after:"]",...f.current()})),u+=f.move("]: "),d(),!e.url||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":`
`,...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),l(),u}function bU(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function Km(e){return"&#x"+e.toString(16).toUpperCase()+";"}function eb(e,n,t){const r=Mh(e),a=Mh(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}S2.peek=vU;function S2(e,n,t,r){const a=bU(t),o=t.enter("emphasis"),l=t.createTracker(r),d=l.move(a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),p=eb(r.before.charCodeAt(r.before.length-1),u,a);p.inside&&(f=Km(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=eb(r.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+Km(g));const v=l.move(a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:p.outside},d+f+v}function vU(e,n,t){return t.options.emphasis||"*"}function wU(e,n){let t=!1;return Aw(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,b1}),!!((!e.depth||e.depth<3)&&Nw(e)&&(n.options.setext||t))}function SU(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),o=t.createTracker(r);if(wU(e,t)){const p=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...o.current(),before:`
`,after:`
`});return g(),p(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const l="#".repeat(a),d=t.enter("headingAtx"),f=t.enter("phrasing");o.move(l+" ");let u=t.containerPhrasing(e,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(u)&&(u=Km(u.charCodeAt(0))+u.slice(1)),u=u?l+" "+u:l,t.options.closeAtx&&(u+=" "+l),f(),d(),u}N2.peek=NU;function N2(e){return e.value||""}function NU(){return"<"}C2.peek=CU;function C2(e,n,t,r){const a=Pw(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("image");let d=t.enter("label");const f=t.createTracker(r);let u=f.move("![");return u+=f.move(t.safe(e.alt,{before:u,after:"]",...f.current()})),u+=f.move("]("),d(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":")",...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),u+=f.move(")"),l(),u}function CU(){return"!"}_2.peek=_U;function _2(e,n,t,r){const a=e.referenceType,o=t.enter("imageReference");let l=t.enter("label");const d=t.createTracker(r);let f=d.move("![");const u=t.safe(e.alt,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const p=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=p,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function _U(){return"!"}j2.peek=jU;function j2(e,n,t){let r=e.value||"",a="`",o=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++o<t.unsafe.length;){const l=t.unsafe[o],d=t.compilePattern(l);let f;if(l.atBreak)for(;f=d.exec(r);){let u=f.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(f.index+1)}}return a+r+a}function jU(){return"`"}function k2(e,n){const t=Nw(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}T2.peek=kU;function T2(e,n,t,r){const a=Pw(t),o=a==='"'?"Quote":"Apostrophe",l=t.createTracker(r);let d,f;if(k2(e,t)){const p=t.stack;t.stack=[],d=t.enter("autolink");let g=l.move("<");return g+=l.move(t.containerPhrasing(e,{before:g,after:">",...l.current()})),g+=l.move(">"),d(),t.stack=p,g}d=t.enter("link"),f=t.enter("label");let u=l.move("[");return u+=l.move(t.containerPhrasing(e,{before:u,after:"](",...l.current()})),u+=l.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(t.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(f=t.enter("destinationRaw"),u+=l.move(t.safe(e.url,{before:u,after:e.title?" ":")",...l.current()}))),f(),e.title&&(f=t.enter(`title${o}`),u+=l.move(" "+a),u+=l.move(t.safe(e.title,{before:u,after:a,...l.current()})),u+=l.move(a),f()),u+=l.move(")"),d(),u}function kU(e,n,t){return k2(e,t)?"<":"["}E2.peek=TU;function E2(e,n,t,r){const a=e.referenceType,o=t.enter("linkReference");let l=t.enter("label");const d=t.createTracker(r);let f=d.move("[");const u=t.containerPhrasing(e,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const p=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=p,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function TU(){return"["}function Dw(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function EU(e){const n=Dw(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function AU(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function A2(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function PU(e,n,t,r){const a=t.enter("list"),o=t.bulletCurrent;let l=e.ordered?AU(t):Dw(t);const d=e.ordered?l==="."?")":".":EU(t);let f=n&&t.bulletLastUsed?l===t.bulletLastUsed:!1;if(!e.ordered){const p=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&p&&(!p.children||!p.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(f=!0),A2(t)===l&&p){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){f=!0;break}}}}f&&(l=d),t.bulletCurrent=l;const u=t.containerFlow(e,r);return t.bulletLastUsed=l,t.bulletCurrent=o,a(),u}function DU(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function IU(e,n,t,r){const a=DU(t);let o=t.bulletCurrent||Dw(t);n&&n.type==="list"&&n.ordered&&(o=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+o);let l=o.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(l=Math.ceil(l/4)*4);const d=t.createTracker(r);d.move(o+" ".repeat(l-o.length)),d.shift(l);const f=t.enter("listItem"),u=t.indentLines(t.containerFlow(e,d.current()),p);return f(),u;function p(g,b,v){return b?(v?"":" ".repeat(l))+g:(v?o:o+" ".repeat(l-o.length))+g}}function RU(e,n,t,r){const a=t.enter("paragraph"),o=t.enter("phrasing"),l=t.containerPhrasing(e,r);return o(),a(),l}const MU=Ab(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function OU(e,n,t,r){return(e.children.some(function(l){return MU(l)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function LU(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}P2.peek=FU;function P2(e,n,t,r){const a=LU(t),o=t.enter("strong"),l=t.createTracker(r),d=l.move(a+a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),p=eb(r.before.charCodeAt(r.before.length-1),u,a);p.inside&&(f=Km(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=eb(r.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+Km(g));const v=l.move(a+a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:p.outside},d+f+v}function FU(e,n,t){return t.options.strong||"*"}function $U(e,n,t,r){return t.safe(e.value,r)}function zU(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function UU(e,n,t){const r=(A2(t)+(t.options.ruleSpaces?" ":"")).repeat(zU(t));return t.options.ruleSpaces?r.slice(0,-1):r}const D2={blockquote:uU,break:kC,code:gU,definition:xU,emphasis:S2,hardBreak:kC,heading:SU,html:N2,image:C2,imageReference:_2,inlineCode:j2,link:T2,linkReference:E2,list:PU,listItem:IU,paragraph:RU,root:OU,strong:P2,text:$U,thematicBreak:UU};function BU(){return{enter:{table:qU,tableData:TC,tableHeader:TC,tableRow:HU},exit:{codeText:GU,table:VU,tableData:f0,tableHeader:f0,tableRow:f0}}}function qU(e){const n=e._align;this.enter({type:"table",align:n.map(function(t){return t==="none"?null:t}),children:[]},e),this.data.inTable=!0}function VU(e){this.exit(e),this.data.inTable=void 0}function HU(e){this.enter({type:"tableRow",children:[]},e)}function f0(e){this.exit(e)}function TC(e){this.enter({type:"tableCell",children:[]},e)}function GU(e){let n=this.resume();this.data.inTable&&(n=n.replace(/\\([\\|])/g,YU));const t=this.stack[this.stack.length-1];t.type,t.value=n,this.exit(e)}function YU(e,n){return n==="|"?n:e}function WU(e){const n=e||{},t=n.tableCellPadding,r=n.tablePipeAlign,a=n.stringLength,o=t?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:b,table:l,tableCell:f,tableRow:d}};function l(v,S,k,T){return u(p(v,k,T),v.align)}function d(v,S,k,T){const A=g(v,k,T),M=u([A]);return M.slice(0,M.indexOf(`
`))}function f(v,S,k,T){const A=k.enter("tableCell"),M=k.enter("phrasing"),R=k.containerPhrasing(v,{...T,before:o,after:o});return M(),A(),R}function u(v,S){return lU(v,{align:S,alignDelimiters:r,padding:t,stringLength:a})}function p(v,S,k){const T=v.children;let A=-1;const M=[],R=S.enter("table");for(;++A<T.length;)M[A]=g(T[A],S,k);return R(),M}function g(v,S,k){const T=v.children;let A=-1;const M=[],R=S.enter("tableRow");for(;++A<T.length;)M[A]=f(T[A],v,S,k);return R(),M}function b(v,S,k){let T=D2.inlineCode(v,S,k);return k.stack.includes("tableCell")&&(T=T.replace(/\|/g,"\\$&")),T}}function QU(){return{exit:{taskListCheckValueChecked:EC,taskListCheckValueUnchecked:EC,paragraph:KU}}}function JU(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:XU}}}function EC(e){const n=this.stack[this.stack.length-2];n.type,n.checked=e.type==="taskListCheckValueChecked"}function KU(e){const n=this.stack[this.stack.length-2];if(n&&n.type==="listItem"&&typeof n.checked=="boolean"){const t=this.stack[this.stack.length-1];t.type;const r=t.children[0];if(r&&r.type==="text"){const a=n.children;let o=-1,l;for(;++o<a.length;){const d=a[o];if(d.type==="paragraph"){l=d;break}}l===t&&(r.value=r.value.slice(1),r.value.length===0?t.children.shift():t.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,t.position.start=Object.assign({},r.position.start)))}}this.exit(e)}function XU(e,n,t,r){const a=e.children[0],o=typeof e.checked=="boolean"&&a&&a.type==="paragraph",l="["+(e.checked?"x":" ")+"] ",d=t.createTracker(r);o&&d.move(l);let f=D2.listItem(e,n,t,{...r,...d.current()});return o&&(f=f.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,u)),f;function u(p){return p+l}}function ZU(){return[P8(),X8(),nU(),BU(),QU()]}function eB(e){return{extensions:[D8(),Z8(e),rU(),WU(e),JU()]}}const tB={tokenize:oB,partial:!0},I2={tokenize:lB,partial:!0},R2={tokenize:cB,partial:!0},M2={tokenize:uB,partial:!0},nB={tokenize:dB,partial:!0},O2={name:"wwwAutolink",tokenize:aB,previous:F2},L2={name:"protocolAutolink",tokenize:sB,previous:$2},Zl={name:"emailAutolink",tokenize:iB,previous:z2},tl={};function rB(){return{text:tl}}let Ed=48;for(;Ed<123;)tl[Ed]=Zl,Ed++,Ed===58?Ed=65:Ed===91&&(Ed=97);tl[43]=Zl;tl[45]=Zl;tl[46]=Zl;tl[95]=Zl;tl[72]=[Zl,L2];tl[104]=[Zl,L2];tl[87]=[Zl,O2];tl[119]=[Zl,O2];function iB(e,n,t){const r=this;let a,o;return l;function l(g){return!N1(g)||!z2.call(r,r.previous)||Iw(r.events)?t(g):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),d(g))}function d(g){return N1(g)?(e.consume(g),d):g===64?(e.consume(g),f):t(g)}function f(g){return g===46?e.check(nB,p,u)(g):g===45||g===95||ji(g)?(o=!0,e.consume(g),f):p(g)}function u(g){return e.consume(g),a=!0,f}function p(g){return o&&a&&Vi(r.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),n(g)):t(g)}}function aB(e,n,t){const r=this;return a;function a(l){return l!==87&&l!==119||!F2.call(r,r.previous)||Iw(r.events)?t(l):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(tB,e.attempt(I2,e.attempt(R2,o),t),t)(l))}function o(l){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),n(l)}}function sB(e,n,t){const r=this;let a="",o=!1;return l;function l(g){return(g===72||g===104)&&$2.call(r,r.previous)&&!Iw(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),a+=String.fromCodePoint(g),e.consume(g),d):t(g)}function d(g){if(Vi(g)&&a.length<5)return a+=String.fromCodePoint(g),e.consume(g),d;if(g===58){const b=a.toLowerCase();if(b==="http"||b==="https")return e.consume(g),f}return t(g)}function f(g){return g===47?(e.consume(g),o?u:(o=!0,f)):t(g)}function u(g){return g===null||Kx(g)||er(g)||$d(g)||kb(g)?t(g):e.attempt(I2,e.attempt(R2,p),t)(g)}function p(g){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),n(g)}}function oB(e,n,t){let r=0;return a;function a(l){return(l===87||l===119)&&r<3?(r++,e.consume(l),a):l===46&&r===3?(e.consume(l),o):t(l)}function o(l){return l===null?t(l):n(l)}}function lB(e,n,t){let r,a,o;return l;function l(u){return u===46||u===95?e.check(M2,f,d)(u):u===null||er(u)||$d(u)||u!==45&&kb(u)?f(u):(o=!0,e.consume(u),l)}function d(u){return u===95?r=!0:(a=r,r=void 0),e.consume(u),l}function f(u){return a||r||!o?t(u):n(u)}}function cB(e,n){let t=0,r=0;return a;function a(l){return l===40?(t++,e.consume(l),a):l===41&&r<t?o(l):l===33||l===34||l===38||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===60||l===63||l===93||l===95||l===126?e.check(M2,n,o)(l):l===null||er(l)||$d(l)?n(l):(e.consume(l),a)}function o(l){return l===41&&r++,e.consume(l),a}}function uB(e,n,t){return r;function r(d){return d===33||d===34||d===39||d===41||d===42||d===44||d===46||d===58||d===59||d===63||d===95||d===126?(e.consume(d),r):d===38?(e.consume(d),o):d===93?(e.consume(d),a):d===60||d===null||er(d)||$d(d)?n(d):t(d)}function a(d){return d===null||d===40||d===91||er(d)||$d(d)?n(d):r(d)}function o(d){return Vi(d)?l(d):t(d)}function l(d){return d===59?(e.consume(d),r):Vi(d)?(e.consume(d),l):t(d)}}function dB(e,n,t){return r;function r(o){return e.consume(o),a}function a(o){return ji(o)?t(o):n(o)}}function F2(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||er(e)}function $2(e){return!Vi(e)}function z2(e){return!(e===47||N1(e))}function N1(e){return e===43||e===45||e===46||e===95||ji(e)}function Iw(e){let n=e.length,t=!1;for(;n--;){const r=e[n][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){t=!0;break}if(r._gfmAutolinkLiteralWalkedInto){t=!1;break}}return e.length>0&&!t&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),t}const fB={tokenize:vB,partial:!0};function hB(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:yB,continuation:{tokenize:xB},exit:bB}},text:{91:{name:"gfmFootnoteCall",tokenize:gB},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:pB,resolveTo:mB}}}}function pB(e,n,t){const r=this;let a=r.events.length;const o=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let l;for(;a--;){const f=r.events[a][1];if(f.type==="labelImage"){l=f;break}if(f.type==="gfmFootnoteCall"||f.type==="labelLink"||f.type==="label"||f.type==="image"||f.type==="link")break}return d;function d(f){if(!l||!l._balanced)return t(f);const u=Hs(r.sliceSerialize({start:l.end,end:r.now()}));return u.codePointAt(0)!==94||!o.includes(u.slice(1))?t(f):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(f),e.exit("gfmFootnoteCallLabelMarker"),n(f))}}function mB(e,n){let t=e.length;for(;t--;)if(e[t][1].type==="labelImage"&&e[t][0]==="enter"){e[t][1];break}e[t+1][1].type="data",e[t+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[t+3][1].start),end:Object.assign({},e[e.length-1][1].end)},a={type:"gfmFootnoteCallMarker",start:Object.assign({},e[t+3][1].end),end:Object.assign({},e[t+3][1].end)};a.end.column++,a.end.offset++,a.end._bufferIndex++;const o={type:"gfmFootnoteCallString",start:Object.assign({},a.end),end:Object.assign({},e[e.length-1][1].start)},l={type:"chunkString",contentType:"string",start:Object.assign({},o.start),end:Object.assign({},o.end)},d=[e[t+1],e[t+2],["enter",r,n],e[t+3],e[t+4],["enter",a,n],["exit",a,n],["enter",o,n],["enter",l,n],["exit",l,n],["exit",o,n],e[e.length-2],e[e.length-1],["exit",r,n]];return e.splice(t,e.length-t+1,...d),e}function gB(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o=0,l;return d;function d(g){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),f}function f(g){return g!==94?t(g):(e.enter("gfmFootnoteCallMarker"),e.consume(g),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",u)}function u(g){if(o>999||g===93&&!l||g===null||g===91||er(g))return t(g);if(g===93){e.exit("chunkString");const b=e.exit("gfmFootnoteCallString");return a.includes(Hs(r.sliceSerialize(b)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),n):t(g)}return er(g)||(l=!0),o++,e.consume(g),g===92?p:u}function p(g){return g===91||g===92||g===93?(e.consume(g),o++,u):u(g)}}function yB(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o,l=0,d;return f;function f(S){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),u}function u(S){return S===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",p):t(S)}function p(S){if(l>999||S===93&&!d||S===null||S===91||er(S))return t(S);if(S===93){e.exit("chunkString");const k=e.exit("gfmFootnoteDefinitionLabelString");return o=Hs(r.sliceSerialize(k)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),b}return er(S)||(d=!0),l++,e.consume(S),S===92?g:p}function g(S){return S===91||S===92||S===93?(e.consume(S),l++,p):p(S)}function b(S){return S===58?(e.enter("definitionMarker"),e.consume(S),e.exit("definitionMarker"),a.includes(o)||a.push(o),jn(e,v,"gfmFootnoteDefinitionWhitespace")):t(S)}function v(S){return n(S)}}function xB(e,n,t){return e.check(cg,n,e.attempt(fB,n,t))}function bB(e){e.exit("gfmFootnoteDefinition")}function vB(e,n,t){const r=this;return jn(e,a,"gfmFootnoteDefinitionIndent",5);function a(o){const l=r.events[r.events.length-1];return l&&l[1].type==="gfmFootnoteDefinitionIndent"&&l[2].sliceSerialize(l[1],!0).length===4?n(o):t(o)}}function wB(e){let t=(e||{}).singleTilde;const r={name:"strikethrough",tokenize:o,resolveAll:a};return t==null&&(t=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function a(l,d){let f=-1;for(;++f<l.length;)if(l[f][0]==="enter"&&l[f][1].type==="strikethroughSequenceTemporary"&&l[f][1]._close){let u=f;for(;u--;)if(l[u][0]==="exit"&&l[u][1].type==="strikethroughSequenceTemporary"&&l[u][1]._open&&l[f][1].end.offset-l[f][1].start.offset===l[u][1].end.offset-l[u][1].start.offset){l[f][1].type="strikethroughSequence",l[u][1].type="strikethroughSequence";const p={type:"strikethrough",start:Object.assign({},l[u][1].start),end:Object.assign({},l[f][1].end)},g={type:"strikethroughText",start:Object.assign({},l[u][1].end),end:Object.assign({},l[f][1].start)},b=[["enter",p,d],["enter",l[u][1],d],["exit",l[u][1],d],["enter",g,d]],v=d.parser.constructs.insideSpan.null;v&&Oa(b,b.length,0,Tb(v,l.slice(u+1,f),d)),Oa(b,b.length,0,[["exit",g,d],["enter",l[f][1],d],["exit",l[f][1],d],["exit",p,d]]),Oa(l,u-1,f-u+3,b),f=u+b.length-2;break}}for(f=-1;++f<l.length;)l[f][1].type==="strikethroughSequenceTemporary"&&(l[f][1].type="data");return l}function o(l,d,f){const u=this.previous,p=this.events;let g=0;return b;function b(S){return u===126&&p[p.length-1][1].type!=="characterEscape"?f(S):(l.enter("strikethroughSequenceTemporary"),v(S))}function v(S){const k=Mh(u);if(S===126)return g>1?f(S):(l.consume(S),g++,v);if(g<2&&!t)return f(S);const T=l.exit("strikethroughSequenceTemporary"),A=Mh(S);return T._open=!A||A===2&&!!k,T._close=!k||k===2&&!!A,d(S)}}}class SB{constructor(){this.map=[]}add(n,t,r){NB(this,n,t,r)}consume(n){if(this.map.sort(function(o,l){return o[0]-l[0]}),this.map.length===0)return;let t=this.map.length;const r=[];for(;t>0;)t-=1,r.push(n.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),n.length=this.map[t][0];r.push(n.slice()),n.length=0;let a=r.pop();for(;a;){for(const o of a)n.push(o);a=r.pop()}this.map.length=0}}function NB(e,n,t,r){let a=0;if(!(t===0&&r.length===0)){for(;a<e.map.length;){if(e.map[a][0]===n){e.map[a][1]+=t,e.map[a][2].push(...r);return}a+=1}e.map.push([n,t,r])}}function CB(e,n){let t=!1;const r=[];for(;n<e.length;){const a=e[n];if(t){if(a[0]==="enter")a[1].type==="tableContent"&&r.push(e[n+1][1].type==="tableDelimiterMarker"?"left":"none");else if(a[1].type==="tableContent"){if(e[n-1][1].type==="tableDelimiterMarker"){const o=r.length-1;r[o]=r[o]==="left"?"center":"right"}}else if(a[1].type==="tableDelimiterRow")break}else a[0]==="enter"&&a[1].type==="tableDelimiterRow"&&(t=!0);n+=1}return r}function _B(){return{flow:{null:{name:"table",tokenize:jB,resolveAll:kB}}}}function jB(e,n,t){const r=this;let a=0,o=0,l;return d;function d(D){let $=r.events.length-1;for(;$>-1;){const Q=r.events[$][1].type;if(Q==="lineEnding"||Q==="linePrefix")$--;else break}const H=$>-1?r.events[$][1].type:null,te=H==="tableHead"||H==="tableRow"?L:f;return te===L&&r.parser.lazy[r.now().line]?t(D):te(D)}function f(D){return e.enter("tableHead"),e.enter("tableRow"),u(D)}function u(D){return D===124||(l=!0,o+=1),p(D)}function p(D){return D===null?t(D):Ot(D)?o>1?(o=0,r.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(D),e.exit("lineEnding"),v):t(D):mn(D)?jn(e,p,"whitespace")(D):(o+=1,l&&(l=!1,a+=1),D===124?(e.enter("tableCellDivider"),e.consume(D),e.exit("tableCellDivider"),l=!0,p):(e.enter("data"),g(D)))}function g(D){return D===null||D===124||er(D)?(e.exit("data"),p(D)):(e.consume(D),D===92?b:g)}function b(D){return D===92||D===124?(e.consume(D),g):g(D)}function v(D){return r.interrupt=!1,r.parser.lazy[r.now().line]?t(D):(e.enter("tableDelimiterRow"),l=!1,mn(D)?jn(e,S,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(D):S(D))}function S(D){return D===45||D===58?T(D):D===124?(l=!0,e.enter("tableCellDivider"),e.consume(D),e.exit("tableCellDivider"),k):F(D)}function k(D){return mn(D)?jn(e,T,"whitespace")(D):T(D)}function T(D){return D===58?(o+=1,l=!0,e.enter("tableDelimiterMarker"),e.consume(D),e.exit("tableDelimiterMarker"),A):D===45?(o+=1,A(D)):D===null||Ot(D)?z(D):F(D)}function A(D){return D===45?(e.enter("tableDelimiterFiller"),M(D)):F(D)}function M(D){return D===45?(e.consume(D),M):D===58?(l=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(D),e.exit("tableDelimiterMarker"),R):(e.exit("tableDelimiterFiller"),R(D))}function R(D){return mn(D)?jn(e,z,"whitespace")(D):z(D)}function z(D){return D===124?S(D):D===null||Ot(D)?!l||a!==o?F(D):(e.exit("tableDelimiterRow"),e.exit("tableHead"),n(D)):F(D)}function F(D){return t(D)}function L(D){return e.enter("tableRow"),U(D)}function U(D){return D===124?(e.enter("tableCellDivider"),e.consume(D),e.exit("tableCellDivider"),U):D===null||Ot(D)?(e.exit("tableRow"),n(D)):mn(D)?jn(e,U,"whitespace")(D):(e.enter("data"),B(D))}function B(D){return D===null||D===124||er(D)?(e.exit("data"),U(D)):(e.consume(D),D===92?J:B)}function J(D){return D===92||D===124?(e.consume(D),B):B(D)}}function kB(e,n){let t=-1,r=!0,a=0,o=[0,0,0,0],l=[0,0,0,0],d=!1,f=0,u,p,g;const b=new SB;for(;++t<e.length;){const v=e[t],S=v[1];v[0]==="enter"?S.type==="tableHead"?(d=!1,f!==0&&(AC(b,n,f,u,p),p=void 0,f=0),u={type:"table",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",u,n]])):S.type==="tableRow"||S.type==="tableDelimiterRow"?(r=!0,g=void 0,o=[0,0,0,0],l=[0,t+1,0,0],d&&(d=!1,p={type:"tableBody",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",p,n]])),a=S.type==="tableDelimiterRow"?2:p?3:1):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")?(r=!1,l[2]===0&&(o[1]!==0&&(l[0]=l[1],g=gx(b,n,o,a,void 0,g),o=[0,0,0,0]),l[2]=t)):S.type==="tableCellDivider"&&(r?r=!1:(o[1]!==0&&(l[0]=l[1],g=gx(b,n,o,a,void 0,g)),o=l,l=[o[1],t,0,0])):S.type==="tableHead"?(d=!0,f=t):S.type==="tableRow"||S.type==="tableDelimiterRow"?(f=t,o[1]!==0?(l[0]=l[1],g=gx(b,n,o,a,t,g)):l[1]!==0&&(g=gx(b,n,l,a,t,g)),a=0):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")&&(l[3]=t)}for(f!==0&&AC(b,n,f,u,p),b.consume(n.events),t=-1;++t<n.events.length;){const v=n.events[t];v[0]==="enter"&&v[1].type==="table"&&(v[1]._align=CB(n.events,t))}return e}function gx(e,n,t,r,a,o){const l=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",d="tableContent";t[0]!==0&&(o.end=Object.assign({},Sh(n.events,t[0])),e.add(t[0],0,[["exit",o,n]]));const f=Sh(n.events,t[1]);if(o={type:l,start:Object.assign({},f),end:Object.assign({},f)},e.add(t[1],0,[["enter",o,n]]),t[2]!==0){const u=Sh(n.events,t[2]),p=Sh(n.events,t[3]),g={type:d,start:Object.assign({},u),end:Object.assign({},p)};if(e.add(t[2],0,[["enter",g,n]]),r!==2){const b=n.events[t[2]],v=n.events[t[3]];if(b[1].end=Object.assign({},v[1].end),b[1].type="chunkText",b[1].contentType="text",t[3]>t[2]+1){const S=t[2]+1,k=t[3]-t[2]-1;e.add(S,k,[])}}e.add(t[3]+1,0,[["exit",g,n]])}return a!==void 0&&(o.end=Object.assign({},Sh(n.events,a)),e.add(a,0,[["exit",o,n]]),o=void 0),o}function AC(e,n,t,r,a){const o=[],l=Sh(n.events,t);a&&(a.end=Object.assign({},l),o.push(["exit",a,n])),r.end=Object.assign({},l),o.push(["exit",r,n]),e.add(t+1,0,o)}function Sh(e,n){const t=e[n],r=t[0]==="enter"?"start":"end";return t[1][r]}const TB={name:"tasklistCheck",tokenize:AB};function EB(){return{text:{91:TB}}}function AB(e,n,t){const r=this;return a;function a(f){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?t(f):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(f),e.exit("taskListCheckMarker"),o)}function o(f){return er(f)?(e.enter("taskListCheckValueUnchecked"),e.consume(f),e.exit("taskListCheckValueUnchecked"),l):f===88||f===120?(e.enter("taskListCheckValueChecked"),e.consume(f),e.exit("taskListCheckValueChecked"),l):t(f)}function l(f){return f===93?(e.enter("taskListCheckMarker"),e.consume(f),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),d):t(f)}function d(f){return Ot(f)?n(f):mn(f)?e.check({tokenize:PB},n,t)(f):t(f)}}function PB(e,n,t){return jn(e,r,"whitespace");function r(a){return a===null?t(a):n(a)}}function DB(e){return Jk([rB(),hB(),wB(e),_B(),EB()])}const IB={};function ds(e){const n=this,t=e||IB,r=n.data(),a=r.micromarkExtensions||(r.micromarkExtensions=[]),o=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),l=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);a.push(DB(t)),o.push(ZU()),l.push(eB(t))}const RB="_container_1giw4_1",MB="_header_1giw4_19",OB="_titleGroup_1giw4_28",LB="_title_1giw4_28",FB="_closeButton_1giw4_41",$B="_messageList_1giw4_54",zB="_emptyState_1giw4_63",UB="_emptyStateIcon_1giw4_73",BB="_exampleContainer_1giw4_78",qB="_exampleChip_1giw4_87",VB="_messageRow_1giw4_107",HB="_messageRowUser_1giw4_112",GB="_messageRowModel_1giw4_116",YB="_messageRowSystem_1giw4_120",WB="_bubble_1giw4_125",QB="_bubbleUser_1giw4_136",JB="_bubbleModel_1giw4_143",KB="_bubbleSystem_1giw4_152",XB="_processingIndicator_1giw4_227",ZB="_spin_1giw4_236",e9="_inputArea_1giw4_251",t9="_inputContainer_1giw4_257",n9="_inputField_1giw4_267",r9="_sendButton_1giw4_280",Fn={container:RB,header:MB,titleGroup:OB,title:LB,closeButton:FB,messageList:$B,emptyState:zB,emptyStateIcon:UB,exampleContainer:BB,exampleChip:qB,messageRow:VB,messageRowUser:HB,messageRowModel:GB,messageRowSystem:YB,bubble:WB,bubbleUser:QB,bubbleModel:JB,bubbleSystem:KB,processingIndicator:XB,spin:ZB,inputArea:e9,inputContainer:t9,inputField:n9,sendButton:r9},U2=({onClose:e,settings:n,staffList:t,onSettingsUpdate:r,onStaffUpdate:a,onHighlight:o})=>{const{chatQuery:l,setChatQuery:d,chatHistory:f,isProcessing:u,handleSendMessage:p,refreshChat:g,stopGeneration:b,selectedImage:v,handleImageSelect:S,clearImage:k}=n3({settings:n,staffList:t,onSettingsUpdate:r,onStaffUpdate:a,onHighlight:o}),T=w.useRef(null),A=w.useRef(null),M=()=>{var L;(L=T.current)==null||L.scrollIntoView({behavior:"smooth"})};w.useEffect(()=>{M()},[f,u]);const R=L=>{var B;const U=(B=L.target.files)==null?void 0:B[0];U&&S(U)},z=["Check Paracetamol stock","Go to Pharmacy","Analysis for last month","Add nurse Sarah"],F=L=>{d(L)};return i.jsxs("div",{className:Fn.container,children:[i.jsxs("header",{className:Fn.header,children:[i.jsxs("div",{className:Fn.titleGroup,children:[i.jsx(d1,{size:20,className:"text-violet-600"}),i.jsx("h3",{className:Fn.title,children:"Clinic Assistant"})]}),i.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[i.jsx("button",{onClick:g,className:Fn.closeButton,title:"Refresh Chat",children:i.jsx(Ak,{size:18})}),i.jsx("button",{onClick:e,className:Fn.closeButton,title:"Close",children:i.jsx(zn,{size:20})})]})]}),i.jsxs("div",{className:Fn.messageList,children:[f.length===0&&i.jsxs("div",{className:Fn.emptyState,children:[i.jsx(d1,{size:48,className:Fn.emptyStateIcon}),i.jsx("p",{children:"How can I help you manage the clinic today?"}),i.jsx("div",{className:Fn.exampleContainer,children:z.map((L,U)=>i.jsx("button",{className:Fn.exampleChip,onClick:()=>F(L),children:L},U))})]}),f.map((L,U)=>i.jsx("div",{className:`${Fn.messageRow} ${L.role==="user"?Fn.messageRowUser:L.role==="model"?Fn.messageRowModel:Fn.messageRowSystem}`,children:i.jsx("div",{className:`${Fn.bubble} ${L.role==="user"?Fn.bubbleUser:L.role==="model"?Fn.bubbleModel:Fn.bubbleSystem}`,children:L.role==="user"||L.role==="system"?L.text:i.jsx(Vs,{remarkPlugins:[ds],children:L.text})})},U)),u&&i.jsx("div",{className:`${Fn.messageRow} ${Fn.messageRowModel}`,children:i.jsxs("div",{className:Fn.processingIndicator,children:[i.jsx(Od,{size:14,className:Fn.spin}),"Thinking..."]})}),i.jsx("div",{ref:T})]}),i.jsxs("div",{className:Fn.inputArea,children:[v&&i.jsxs("div",{className:Fn.imagePreviewContainer,style:{marginBottom:"0.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.jsxs("div",{style:{position:"relative",width:"60px",height:"60px",border:"1px solid #e5e7eb",borderRadius:"4px",overflow:"hidden"},children:[i.jsx("img",{src:v,alt:"Selected",style:{width:"100%",height:"100%",objectFit:"cover"}}),i.jsx("button",{onClick:k,style:{position:"absolute",top:0,right:0,background:"rgba(0,0,0,0.5)",color:"white",border:"none",cursor:"pointer",padding:"1px"},children:i.jsx(zn,{size:12})})]}),i.jsx("span",{style:{fontSize:"0.8rem",color:"#6b7280"},children:"Image attached"})]}),i.jsxs("div",{className:Fn.inputContainer,children:[i.jsx("input",{type:"file",ref:A,onChange:R,accept:"image/*",style:{display:"none"}}),i.jsx("button",{className:Fn.sendButton,onClick:()=>{var L;return(L=A.current)==null?void 0:L.click()},disabled:u,title:"Attach Image",style:{marginRight:"0.5rem",color:"#6b7280"},children:i.jsx(Tk,{size:18})}),i.jsx("input",{type:"text",className:Fn.inputField,placeholder:"Type your request...",value:l,onChange:L=>d(L.target.value),onKeyDown:L=>L.key==="Enter"&&!u&&p(),disabled:u,autoFocus:!0}),u?i.jsx("button",{className:Fn.sendButton,onClick:b,title:"Stop Generating",style:{color:"#ef4444"},children:i.jsx(G6,{size:18,fill:"currentColor"})}):i.jsx("button",{className:Fn.sendButton,onClick:p,disabled:!l.trim()&&!v,children:i.jsx(Pk,{size:18})})]})]})]})},i9=({onLoginSuccess:e})=>{const[n,t]=w.useState(""),[r,a]=w.useState(""),[o,l]=w.useState(null),[d,f]=w.useState(!1),u=Et(),p=async v=>{v.preventDefault(),f(!0),l(null);try{const S=await pe("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});if(!S.ok){let T=`Login failed with status: ${S.status}`;try{T=(await S.json()).message||T}catch{try{const M=await S.text();M&&(T=`${T} - ${M}`)}catch{}}throw new Error(T)}const k=await S.json();console.log("Login successful:",k),localStorage.setItem("authToken",k.token),localStorage.setItem("currentUser",JSON.stringify(k.user)),k.user.clinic_id&&localStorage.setItem("currentClinicId",k.user.clinic_id),e(k.user),k.user.role==="doctor"?u("/dashboard/queue"):u("/dashboard")}catch(S){console.error("Login failed:",S),l(S.message||"Login failed. Please check your credentials.")}finally{f(!1)}},g=async v=>{f(!0),l(null);try{const S=await pe("/api/auth/google",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:v.credential})});if(!S.ok)throw new Error("Google Sign-In failed");const k=await S.json();localStorage.setItem("authToken",k.token),localStorage.setItem("currentUser",JSON.stringify(k.user)),k.user.clinic_id&&localStorage.setItem("currentClinicId",k.user.clinic_id),e(k.user),k.user.role==="doctor"?u("/dashboard/queue"):u("/dashboard")}catch(S){console.error("Google Login Error:",S),l("Google Sign-In failed. Please try again.")}finally{f(!1)}},b=()=>{console.error("Google Login Failed"),l("Google Sign-In was unsuccessful. Please try again.")};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Newtons AI HMS"}),i.jsx("p",{className:"auth-subtitle",children:"Sign in to continue"}),i.jsxs("form",{onSubmit:p,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:n,onChange:v=>t(v.target.value),className:"auth-text-input",placeholder:" "}),i.jsx("label",{htmlFor:"email",children:"Email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:r,onChange:v=>a(v.target.value),className:"auth-text-input",placeholder:" "}),i.jsx("label",{htmlFor:"password",children:"Password"})]}),o&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:o})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:d,className:"auth-submit-button",children:d?"Signing in...":"Sign In"})})]}),i.jsx("div",{className:"google-login-container",children:i.jsx(_P,{onSuccess:g,onError:b,useOneTap:!0})}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Don't have an account?"," ",i.jsx(hs,{to:"/register",className:"auth-navigation-link",children:"Create account"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})},a9=()=>{const[e,n]=w.useState(""),[t,r]=w.useState(""),[a,o]=w.useState(""),[l,d]=w.useState(""),[f,u]=w.useState(null),[p,g]=w.useState(!1),b=Et(),v=async S=>{S.preventDefault(),g(!0),u(null);try{const k=await pe("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicName:e,userName:t,userEmail:a,userPassword:l})}),T=await k.json();if(!k.ok)throw new Error(T.message||`HTTP error! status: ${k.status}`);console.log("Registration successful:",T),alert("Registration successful! Please log in."),b("/login")}catch(k){console.error("Registration failed:",k),u(k.message||"Registration failed. Please try again.")}finally{g(!1)}};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Register Clinic & Admin"}),i.jsxs("form",{onSubmit:v,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"clinicName",children:"Clinic Name"}),i.jsx("input",{id:"clinicName",name:"clinicName",type:"text",required:!0,value:e,onChange:S=>n(S.target.value),className:"auth-text-input",placeholder:"Your Clinic's Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userName",children:"Your Name (Admin)"}),i.jsx("input",{id:"userName",name:"userName",type:"text",required:!0,value:t,onChange:S=>r(S.target.value),className:"auth-text-input",placeholder:"Your Full Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userEmail",children:"Your Email (Admin Login)"}),i.jsx("input",{id:"userEmail",name:"userEmail",type:"email",autoComplete:"email",required:!0,value:a,onChange:S=>o(S.target.value),className:"auth-text-input",placeholder:"you@example.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userPassword",children:"Password"}),i.jsx("input",{id:"userPassword",name:"userPassword",type:"password",required:!0,minLength:6,value:l,onChange:S=>d(S.target.value),className:"auth-text-input",placeholder:"Min. 6 characters"})]}),f&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:f})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:p,className:"auth-submit-button",children:p?"Registering...":"Register Clinic & Admin"})})]}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Already have an account?"," ",i.jsx(hs,{to:"/login",className:"auth-navigation-link",children:"Sign in"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})};var B2={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},PC=_n.createContext&&_n.createContext(B2),s9=["attr","size","title"];function o9(e,n){if(e==null)return{};var t=l9(e,n),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}function l9(e,n){if(e==null)return{};var t={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(n.indexOf(r)>=0)continue;t[r]=e[r]}return t}function tb(){return tb=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},tb.apply(this,arguments)}function DC(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function nb(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?DC(Object(t),!0).forEach(function(r){c9(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):DC(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function c9(e,n,t){return n=u9(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function u9(e){var n=d9(e,"string");return typeof n=="symbol"?n:n+""}function d9(e,n){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function q2(e){return e&&e.map((n,t)=>_n.createElement(n.tag,nb({key:t},n.attr),q2(n.child)))}function $a(e){return n=>_n.createElement(f9,tb({attr:nb({},e.attr)},n),q2(e.child))}function f9(e){var n=t=>{var{attr:r,size:a,title:o}=e,l=o9(e,s9),d=a||t.size||"1em",f;return t.className&&(f=t.className),e.className&&(f=(f?f+" ":"")+e.className),_n.createElement("svg",tb({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,l,{className:f,style:nb(nb({color:e.color||t.color},t.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),o&&_n.createElement("title",null,o),e.children)};return PC!==void 0?_n.createElement(PC.Consumer,null,t=>n(t)):n(B2)}function h0(e){return $a({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(e)}function IC(e){return $a({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function RC(e){return $a({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M437.2 403.5L320 215V64h8c13.3 0 24-10.7 24-24V24c0-13.3-10.7-24-24-24H120c-13.3 0-24 10.7-24 24v16c0 13.3 10.7 24 24 24h8v151L10.8 403.5C-18.5 450.6 15.3 512 70.9 512h306.2c55.7 0 89.4-61.5 60.1-108.5zM137.9 320l48.2-77.6c3.7-5.2 5.8-11.6 5.8-18.4V64h64v160c0 6.9 2.2 13.2 5.8 18.4l48.2 77.6h-172z"},child:[]}]})(e)}function Nh(e){return $a({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function yx(e){return $a({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M480 320a96 96 0 1 0-96-96 96 96 0 0 0 96 96zm48 32a22.88 22.88 0 0 0-7.06 1.09 124.76 124.76 0 0 1-81.89 0A22.82 22.82 0 0 0 432 352a112 112 0 0 0-112 112.62c.14 26.26 21.73 47.38 48 47.38h224c26.27 0 47.86-21.12 48-47.38A112 112 0 0 0 528 352zm-198.09 10.45A145.19 145.19 0 0 1 352 344.62V128a32 32 0 0 0-32-32h-32V32a32 32 0 0 0-32-32H96a32 32 0 0 0-32 32v64H32a32 32 0 0 0-32 32v368a16 16 0 0 0 16 16h288.31A78.62 78.62 0 0 1 288 464.79a143.06 143.06 0 0 1 41.91-102.34zM144 404a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm48-122a6 6 0 0 1-6 6h-20a6 6 0 0 1-6-6v-26h-26a6 6 0 0 1-6-6v-20a6 6 0 0 1 6-6h26V70a6 6 0 0 1 6-6h20a6 6 0 0 1 6 6v26h26a6 6 0 0 1 6 6v20a6 6 0 0 1-6 6h-26zm80 250a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12z"},child:[]}]})(e)}function xx(e){return $a({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M352 288h-16v-88c0-4.42-3.58-8-8-8h-13.58c-4.74 0-9.37 1.4-13.31 4.03l-15.33 10.22a7.994 7.994 0 0 0-2.22 11.09l8.88 13.31a7.994 7.994 0 0 0 11.09 2.22l.47-.31V288h-16c-4.42 0-8 3.58-8 8v16c0 4.42 3.58 8 8 8h64c4.42 0 8-3.58 8-8v-16c0-4.42-3.58-8-8-8zM608 64H32C14.33 64 0 78.33 0 96v320c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V96c0-17.67-14.33-32-32-32zM48 400v-64c35.35 0 64 28.65 64 64H48zm0-224v-64h64c0 35.35-28.65 64-64 64zm272 192c-53.02 0-96-50.15-96-112 0-61.86 42.98-112 96-112s96 50.14 96 112c0 61.87-43 112-96 112zm272 32h-64c0-35.35 28.65-64 64-64v64zm0-224c-35.35 0-64-28.65-64-64h64v64z"},child:[]}]})(e)}function bx(e){return $a({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M112 32C50.1 32 0 82.1 0 144v224c0 61.9 50.1 112 112 112s112-50.1 112-112V144c0-61.9-50.1-112-112-112zm48 224H64V144c0-26.5 21.5-48 48-48s48 21.5 48 48v112zm139.7-29.7c-3.5-3.5-9.4-3.1-12.3.8-45.3 62.5-40.4 150.1 15.9 206.4 56.3 56.3 143.9 61.2 206.4 15.9 4-2.9 4.3-8.8.8-12.3L299.7 226.3zm229.8-19c-56.3-56.3-143.9-61.2-206.4-15.9-4 2.9-4.3 8.8-.8 12.3l210.8 210.8c3.5 3.5 9.4 3.1 12.3-.8 45.3-62.6 40.5-150.1-15.9-206.4z"},child:[]}]})(e)}function Ch(e){return $a({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function V2(e){return $a({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(e)}function MC(e){return $a({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M447.1 112c-34.2.5-62.3 28.4-63 62.6-.5 24.3 12.5 45.6 32 56.8V344c0 57.3-50.2 104-112 104-60 0-109.2-44.1-111.9-99.2C265 333.8 320 269.2 320 192V36.6c0-11.4-8.1-21.3-19.3-23.5L237.8.5c-13-2.6-25.6 5.8-28.2 18.8L206.4 35c-2.6 13 5.8 25.6 18.8 28.2l30.7 6.1v121.4c0 52.9-42.2 96.7-95.1 97.2-53.4.5-96.9-42.7-96.9-96V69.4l30.7-6.1c13-2.6 21.4-15.2 18.8-28.2l-3.1-15.7C107.7 6.4 95.1-2 82.1.6L19.3 13C8.1 15.3 0 25.1 0 36.6V192c0 77.3 55.1 142 128.1 156.8C130.7 439.2 208.6 512 304 512c97 0 176-75.4 176-168V231.4c19.1-11.1 32-31.7 32-55.4 0-35.7-29.2-64.5-64.9-64zm.9 80c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16z"},child:[]}]})(e)}function h9(e){return $a({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(e)}function OC(e){return $a({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zM104 424c0 13.3 10.7 24 24 24s24-10.7 24-24-10.7-24-24-24-24 10.7-24 24zm216-135.4v49c36.5 7.4 64 39.8 64 78.4v41.7c0 7.6-5.4 14.2-12.9 15.7l-32.2 6.4c-4.3.9-8.5-1.9-9.4-6.3l-3.1-15.7c-.9-4.3 1.9-8.6 6.3-9.4l19.3-3.9V416c0-62.8-96-65.1-96 1.9v26.7l19.3 3.9c4.3.9 7.1 5.1 6.3 9.4l-3.1 15.7c-.9 4.3-5.1 7.1-9.4 6.3l-31.2-4.2c-7.9-1.1-13.8-7.8-13.8-15.9V416c0-38.6 27.5-70.9 64-78.4v-45.2c-2.2.7-4.4 1.1-6.6 1.9-18 6.3-37.3 9.8-57.4 9.8s-39.4-3.5-57.4-9.8c-7.4-2.6-14.9-4.2-22.6-5.2v81.6c23.1 6.9 40 28.1 40 53.4 0 30.9-25.1 56-56 56s-56-25.1-56-56c0-25.3 16.9-46.5 40-53.4v-80.4C48.5 301 0 355.8 0 422.4v44.8C0 491.9 20.1 512 44.8 512h358.4c24.7 0 44.8-20.1 44.8-44.8v-44.8c0-72-56.8-130.3-128-133.8z"},child:[]}]})(e)}function Em(e){return $a({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(e)}const H2={superadmin:[{title:"Admin Pages",links:[{path:"/dashboard",name:"Super Admin Dashboard",icon:Nh},{path:"/dashboard/clinic-subscriptions",name:"Clinic Subscriptions",icon:yx},{path:"/dashboard/users",name:"User Management",icon:Em}]}],admin:[{title:"Dashboard",links:[{path:"/dashboard",name:"Admin Dashboard",icon:Nh}]},{title:"Clinic Management",links:[{path:"/dashboard/clinic-hub",name:"Clinic Hub",icon:IC}]},{title:"Patient Management",links:[{path:"/dashboard/patients/add",name:"Add Patient",icon:yx},{path:"/dashboard/patients",name:"All Patients",icon:Em},{path:"/dashboard/patients/search",name:"Search Patient",icon:Ch}]},{title:"Inventory & Pharmacy",links:[{path:"/dashboard/analysis",name:"Analysis Dashboard",icon:h0},{path:"/dashboard/inventory",name:"Inventory Management",icon:bx},{path:"/dashboard/inventory/add",name:"Add Drug",icon:bx},{path:"/dashboard/distributors",name:"Distributor Management",icon:Em}]},{title:"Queue & Subscriptions",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:MC},{path:"/dashboard/subscriptions",name:"Manage Subscriptions",icon:xx},{path:"/dashboard/subscriptions/add",name:"Add Subscription Plan",icon:xx}]}],doctor:[{title:"Patient & Admissions",links:[{path:"/dashboard/search",name:"Patient Search",icon:Ch},{path:"/dashboard/add-patient",name:"Add Patient",icon:yx},{path:"/manage-admission",name:"Manage Admission",icon:OC}]},{title:"Lab & Billing",links:[{path:"/create-lab-order",name:"Create Lab Order",icon:RC},{path:"/billing",name:"Billing",icon:xx}]},{title:"Queue",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:MC}]}],receptionist:[{title:"Reception",links:[{path:"/dashboard",name:"Reception Dashboard",icon:Nh}]},{title:"Patient Management",links:[{path:"/dashboard/all-patients",name:"All Patients",icon:Em},{path:"/dashboard/patients/add",name:"Add Patient",icon:yx},{path:"/dashboard/patients/search",name:"Search Patient",icon:Ch}]},{title:"Billing & Admissions",links:[{path:"/billing",name:"Billing",icon:xx},{path:"/manage-admission",name:"Manage Admission",icon:OC}]}],lab:[{title:"Lab Operations",links:[{path:"/dashboard",name:"Lab Dashboard",icon:Nh},{path:"/lab-inventory",name:"Lab Test Inventory",icon:RC},{path:"/lab/search-report",name:"Search Lab Report",icon:Ch}]}],pharmacy:[{title:"Pharmacy Operations",links:[{path:"/dashboard",name:"Pharmacy Queue",icon:Nh},{path:"/dashboard/inventory",name:"Pharmacy Inventory",icon:bx},{path:"/dashboard/inventory/add",name:"Add Drug",icon:bx},{path:"/dashboard/add-order",name:"Add Pharmacy Order",icon:h0},{path:"/dashboard/distributors",name:"Distributor Management",icon:Em}]},{title:"Analysis & Settings",links:[{path:"/dashboard/analysis",name:"Analysis Dashboard",icon:h0},{path:"/dashboard/settings",name:"Pharmacy Settings",icon:IC},{path:"/dashboard/search-patient-records",name:"Search Patient Records",icon:Ch}]}]},p9=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a})=>{const o=Br(),[l,d]=w.useState(""),f=H2[t]||[],[u,p]=w.useState(500),g=w.useRef(!1),b=w.useCallback(T=>{g.current=!0,T.preventDefault()},[]),v=w.useCallback(()=>{g.current=!1},[]),S=w.useCallback(T=>{if(g.current){const A=window.innerWidth-T.clientX;A>250&&A<window.innerWidth*.8&&p(A)}},[]);w.useEffect(()=>(window.addEventListener("mousemove",S),window.addEventListener("mouseup",v),()=>{window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",v)}),[S,v]);const k=f.map(T=>({...T,links:T.links.filter(A=>A.name.toLowerCase().includes(l.toLowerCase()))})).filter(T=>T.links.length>0);return i.jsxs("div",{className:`side-panel ${r?"open":""}`,style:{width:`${u}px`,right:r?"0":`-${u}px`},children:[i.jsx("div",{className:"resizer",onMouseDown:b}),i.jsxs("div",{className:"side-panel-header",children:[i.jsx(hs,{to:"/dashboard",className:"home-button",onClick:a,children:i.jsx(Nh,{})}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx(Ch,{style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",color:"#94a3b8"}}),i.jsx("input",{type:"text",placeholder:"Search pages...",className:"search-bar",value:l,onChange:T=>d(T.target.value)})]}),i.jsx("button",{className:"close-button",onClick:a,children:""})]}),i.jsx("nav",{children:k.map((T,A)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:T.title}),i.jsx("ul",{className:"sub-page-list",children:T.links.map(M=>{const R=M.icon;return i.jsx("li",{children:i.jsxs(hs,{to:M.path,className:o.pathname===M.path?"active":"",onClick:a,children:[R&&i.jsx(R,{})," ",M.name]})},M.path)})})]},A))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx(V2,{})," Logout"]})]})]})},m9=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a,roleNavigation:o})=>{const l=Br(),d=o[t]||[];return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:`mobile-side-panel-overlay ${r?"open":""}`,onClick:a}),i.jsxs("div",{className:`mobile-side-panel ${r?"open":""}`,children:[i.jsxs("div",{className:"mobile-side-panel-header",children:[i.jsx("h3",{children:"Menu"}),i.jsx("button",{className:"close-button",onClick:a,children:i.jsx(h9,{})})]}),i.jsx("nav",{children:d.map((f,u)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:f.title}),i.jsx("ul",{className:"sub-page-list",children:f.links.map(p=>{const g=p.icon;return i.jsx("li",{children:i.jsxs(hs,{to:p.path,className:l.pathname===p.path?"active":"",onClick:a,children:[g&&i.jsx(g,{})," ",p.name]})},p.path)})})]},u))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx(V2,{})," Logout"]})]})]})]})};var p0,LC;function g9(){if(LC)return p0;LC=1;var e="Expected a function",n=NaN,t="[object Symbol]",r=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,l=/^0o[0-7]+$/i,d=parseInt,f=typeof lu=="object"&&lu&&lu.Object===Object&&lu,u=typeof self=="object"&&self&&self.Object===Object&&self,p=f||u||Function("return this")(),g=Object.prototype,b=g.toString,v=Math.max,S=Math.min,k=function(){return p.Date.now()};function T(F,L,U){var B,J,D,$,H,te,Q=0,Y=!1,V=!1,ae=!0;if(typeof F!="function")throw new TypeError(e);L=z(L)||0,A(U)&&(Y=!!U.leading,V="maxWait"in U,D=V?v(z(U.maxWait)||0,L):D,ae="trailing"in U?!!U.trailing:ae);function re(oe){var se=B,je=J;return B=J=void 0,Q=oe,$=F.apply(je,se),$}function le(oe){return Q=oe,H=setTimeout(ue,L),Y?re(oe):$}function E(oe){var se=oe-te,je=oe-Q,We=L-se;return V?S(We,D-je):We}function ce(oe){var se=oe-te,je=oe-Q;return te===void 0||se>=L||se<0||V&&je>=D}function ue(){var oe=k();if(ce(oe))return I(oe);H=setTimeout(ue,E(oe))}function I(oe){return H=void 0,ae&&B?re(oe):(B=J=void 0,$)}function de(){H!==void 0&&clearTimeout(H),Q=0,B=te=J=H=void 0}function fe(){return H===void 0?$:I(k())}function W(){var oe=k(),se=ce(oe);if(B=arguments,J=this,te=oe,se){if(H===void 0)return le(te);if(V)return H=setTimeout(ue,L),re(te)}return H===void 0&&(H=setTimeout(ue,L)),$}return W.cancel=de,W.flush=fe,W}function A(F){var L=typeof F;return!!F&&(L=="object"||L=="function")}function M(F){return!!F&&typeof F=="object"}function R(F){return typeof F=="symbol"||M(F)&&b.call(F)==t}function z(F){if(typeof F=="number")return F;if(R(F))return n;if(A(F)){var L=typeof F.valueOf=="function"?F.valueOf():F;F=A(L)?L+"":L}if(typeof F!="string")return F===0?F:+F;F=F.replace(r,"");var U=o.test(F);return U||l.test(F)?d(F.slice(2),U?2:8):a.test(F)?n:+F}return p0=T,p0}var y9=g9();const Db=qd(y9);var m0={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var FC;function x9(){return FC||(FC=1,function(e){(function(){var n={}.hasOwnProperty;function t(){for(var o="",l=0;l<arguments.length;l++){var d=arguments[l];d&&(o=a(o,r(d)))}return o}function r(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return t.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var l="";for(var d in o)n.call(o,d)&&o[d]&&(l=a(l,d));return l}function a(o,l){return l?o?o+" "+l:o+l:o}e.exports?(t.default=t,e.exports=t):window.classNames=t})()}(m0)),m0.exports}var b9=x9();const cu=qd(b9);function zd(e){"@babel/helpers - typeof";return zd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},zd(e)}function v9(e,n){if(zd(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(zd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function G2(e){var n=v9(e,"string");return zd(n)=="symbol"?n:n+""}function Fm(e,n,t){return(n=G2(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function $C(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function Lt(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?$C(Object(t),!0).forEach(function(r){Fm(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):$C(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function w9(e){if(Array.isArray(e))return e}function S9(e,n){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var r,a,o,l,d=[],f=!0,u=!1;try{if(o=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;f=!1}else for(;!(f=(r=o.call(t)).done)&&(d.push(r.value),d.length!==n);f=!0);}catch(p){u=!0,a=p}finally{try{if(!f&&t.return!=null&&(l=t.return(),Object(l)!==l))return}finally{if(u)throw a}}return d}}function C1(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function Y2(e,n){if(e){if(typeof e=="string")return C1(e,n);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?C1(e,n):void 0}}function N9(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wl(e,n){return w9(e)||S9(e,n)||Y2(e,n)||N9()}function C9(e,n){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(n.indexOf(r)!==-1)continue;t[r]=e[r]}return t}function ec(e,n){if(e==null)return{};var t,r,a=C9(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var _9=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function j9(e){var n=e.defaultInputValue,t=n===void 0?"":n,r=e.defaultMenuIsOpen,a=r===void 0?!1:r,o=e.defaultValue,l=o===void 0?null:o,d=e.inputValue,f=e.menuIsOpen,u=e.onChange,p=e.onInputChange,g=e.onMenuClose,b=e.onMenuOpen,v=e.value,S=ec(e,_9),k=w.useState(d!==void 0?d:t),T=Wl(k,2),A=T[0],M=T[1],R=w.useState(f!==void 0?f:a),z=Wl(R,2),F=z[0],L=z[1],U=w.useState(v!==void 0?v:l),B=Wl(U,2),J=B[0],D=B[1],$=w.useCallback(function(re,le){typeof u=="function"&&u(re,le),D(re)},[u]),H=w.useCallback(function(re,le){var E;typeof p=="function"&&(E=p(re,le)),M(E!==void 0?E:re)},[p]),te=w.useCallback(function(){typeof b=="function"&&b(),L(!0)},[b]),Q=w.useCallback(function(){typeof g=="function"&&g(),L(!1)},[g]),Y=d!==void 0?d:A,V=f!==void 0?f:F,ae=v!==void 0?v:J;return Lt(Lt({},S),{},{inputValue:Y,menuIsOpen:V,onChange:$,onInputChange:H,onMenuClose:Q,onMenuOpen:te,value:ae})}function Ut(){return Ut=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Ut.apply(null,arguments)}function k9(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function zC(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,G2(r.key),r)}}function T9(e,n,t){return n&&zC(e.prototype,n),t&&zC(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _1(e,n){return _1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},_1(e,n)}function E9(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&_1(e,n)}function rb(e){return rb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},rb(e)}function W2(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(W2=function(){return!!e})()}function A9(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P9(e,n){if(n&&(zd(n)=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return A9(e)}function D9(e){var n=W2();return function(){var t,r=rb(e);if(n){var a=rb(this).constructor;t=Reflect.construct(r,arguments,a)}else t=r.apply(this,arguments);return P9(this,t)}}function I9(e){if(Array.isArray(e))return C1(e)}function R9(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function M9(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rw(e){return I9(e)||R9(e)||Y2(e)||M9()}function O9(e){if(e.sheet)return e.sheet;for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].ownerNode===e)return document.styleSheets[n]}function L9(e){var n=document.createElement("style");return n.setAttribute("data-emotion",e.key),e.nonce!==void 0&&n.setAttribute("nonce",e.nonce),n.appendChild(document.createTextNode("")),n.setAttribute("data-s",""),n}var F9=function(){function e(t){var r=this;this._insertTag=function(a){var o;r.tags.length===0?r.insertionPoint?o=r.insertionPoint.nextSibling:r.prepend?o=r.container.firstChild:o=r.before:o=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(a,o),r.tags.push(a)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var n=e.prototype;return n.hydrate=function(r){r.forEach(this._insertTag)},n.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(L9(this));var a=this.tags[this.tags.length-1];if(this.isSpeedy){var o=O9(a);try{o.insertRule(r,o.cssRules.length)}catch{}}else a.appendChild(document.createTextNode(r));this.ctr++},n.flush=function(){this.tags.forEach(function(r){var a;return(a=r.parentNode)==null?void 0:a.removeChild(r)}),this.tags=[],this.ctr=0},e}(),Ni="-ms-",ib="-moz-",In="-webkit-",Q2="comm",Mw="rule",Ow="decl",$9="@import",J2="@keyframes",z9="@layer",U9=Math.abs,Ib=String.fromCharCode,B9=Object.assign;function q9(e,n){return ci(e,0)^45?(((n<<2^ci(e,0))<<2^ci(e,1))<<2^ci(e,2))<<2^ci(e,3):0}function K2(e){return e.trim()}function V9(e,n){return(e=n.exec(e))?e[0]:e}function Rn(e,n,t){return e.replace(n,t)}function j1(e,n){return e.indexOf(n)}function ci(e,n){return e.charCodeAt(n)|0}function Xm(e,n,t){return e.slice(n,t)}function Yo(e){return e.length}function Lw(e){return e.length}function vx(e,n){return n.push(e),e}function H9(e,n){return e.map(n).join("")}var Rb=1,Oh=1,X2=0,pa=0,Fr=0,Hh="";function Mb(e,n,t,r,a,o,l){return{value:e,root:n,parent:t,type:r,props:a,children:o,line:Rb,column:Oh,length:l,return:""}}function Am(e,n){return B9(Mb("",null,null,"",null,null,0),e,{length:-e.length},n)}function G9(){return Fr}function Y9(){return Fr=pa>0?ci(Hh,--pa):0,Oh--,Fr===10&&(Oh=1,Rb--),Fr}function La(){return Fr=pa<X2?ci(Hh,pa++):0,Oh++,Fr===10&&(Oh=1,Rb++),Fr}function Xo(){return ci(Hh,pa)}function $x(){return pa}function dg(e,n){return Xm(Hh,e,n)}function Zm(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Z2(e){return Rb=Oh=1,X2=Yo(Hh=e),pa=0,[]}function eT(e){return Hh="",e}function zx(e){return K2(dg(pa-1,k1(e===91?e+2:e===40?e+1:e)))}function W9(e){for(;(Fr=Xo())&&Fr<33;)La();return Zm(e)>2||Zm(Fr)>3?"":" "}function Q9(e,n){for(;--n&&La()&&!(Fr<48||Fr>102||Fr>57&&Fr<65||Fr>70&&Fr<97););return dg(e,$x()+(n<6&&Xo()==32&&La()==32))}function k1(e){for(;La();)switch(Fr){case e:return pa;case 34:case 39:e!==34&&e!==39&&k1(Fr);break;case 40:e===41&&k1(e);break;case 92:La();break}return pa}function J9(e,n){for(;La()&&e+Fr!==57;)if(e+Fr===84&&Xo()===47)break;return"/*"+dg(n,pa-1)+"*"+Ib(e===47?e:La())}function K9(e){for(;!Zm(Xo());)La();return dg(e,pa)}function X9(e){return eT(Ux("",null,null,null,[""],e=Z2(e),0,[0],e))}function Ux(e,n,t,r,a,o,l,d,f){for(var u=0,p=0,g=l,b=0,v=0,S=0,k=1,T=1,A=1,M=0,R="",z=a,F=o,L=r,U=R;T;)switch(S=M,M=La()){case 40:if(S!=108&&ci(U,g-1)==58){j1(U+=Rn(zx(M),"&","&\f"),"&\f")!=-1&&(A=-1);break}case 34:case 39:case 91:U+=zx(M);break;case 9:case 10:case 13:case 32:U+=W9(S);break;case 92:U+=Q9($x()-1,7);continue;case 47:switch(Xo()){case 42:case 47:vx(Z9(J9(La(),$x()),n,t),f);break;default:U+="/"}break;case 123*k:d[u++]=Yo(U)*A;case 125*k:case 59:case 0:switch(M){case 0:case 125:T=0;case 59+p:A==-1&&(U=Rn(U,/\f/g,"")),v>0&&Yo(U)-g&&vx(v>32?BC(U+";",r,t,g-1):BC(Rn(U," ","")+";",r,t,g-2),f);break;case 59:U+=";";default:if(vx(L=UC(U,n,t,u,p,a,d,R,z=[],F=[],g),o),M===123)if(p===0)Ux(U,n,L,L,z,o,g,d,F);else switch(b===99&&ci(U,3)===110?100:b){case 100:case 108:case 109:case 115:Ux(e,L,L,r&&vx(UC(e,L,L,0,0,a,d,R,a,z=[],g),F),a,F,g,d,r?z:F);break;default:Ux(U,L,L,L,[""],F,0,d,F)}}u=p=v=0,k=A=1,R=U="",g=l;break;case 58:g=1+Yo(U),v=S;default:if(k<1){if(M==123)--k;else if(M==125&&k++==0&&Y9()==125)continue}switch(U+=Ib(M),M*k){case 38:A=p>0?1:(U+="\f",-1);break;case 44:d[u++]=(Yo(U)-1)*A,A=1;break;case 64:Xo()===45&&(U+=zx(La())),b=Xo(),p=g=Yo(R=U+=K9($x())),M++;break;case 45:S===45&&Yo(U)==2&&(k=0)}}return o}function UC(e,n,t,r,a,o,l,d,f,u,p){for(var g=a-1,b=a===0?o:[""],v=Lw(b),S=0,k=0,T=0;S<r;++S)for(var A=0,M=Xm(e,g+1,g=U9(k=l[S])),R=e;A<v;++A)(R=K2(k>0?b[A]+" "+M:Rn(M,/&\f/g,b[A])))&&(f[T++]=R);return Mb(e,n,t,a===0?Mw:d,f,u,p)}function Z9(e,n,t){return Mb(e,n,t,Q2,Ib(G9()),Xm(e,2,-2),0)}function BC(e,n,t,r){return Mb(e,n,t,Ow,Xm(e,0,r),Xm(e,r+1,-1),r)}function Th(e,n){for(var t="",r=Lw(e),a=0;a<r;a++)t+=n(e[a],a,e,n)||"";return t}function eq(e,n,t,r){switch(e.type){case z9:if(e.children.length)break;case $9:case Ow:return e.return=e.return||e.value;case Q2:return"";case J2:return e.return=e.value+"{"+Th(e.children,r)+"}";case Mw:e.value=e.props.join(",")}return Yo(t=Th(e.children,r))?e.return=e.value+"{"+t+"}":""}function tq(e){var n=Lw(e);return function(t,r,a,o){for(var l="",d=0;d<n;d++)l+=e[d](t,r,a,o)||"";return l}}function nq(e){return function(n){n.root||(n=n.return)&&e(n)}}function rq(e){var n=Object.create(null);return function(t){return n[t]===void 0&&(n[t]=e(t)),n[t]}}var iq=function(n,t,r){for(var a=0,o=0;a=o,o=Xo(),a===38&&o===12&&(t[r]=1),!Zm(o);)La();return dg(n,pa)},aq=function(n,t){var r=-1,a=44;do switch(Zm(a)){case 0:a===38&&Xo()===12&&(t[r]=1),n[r]+=iq(pa-1,t,r);break;case 2:n[r]+=zx(a);break;case 4:if(a===44){n[++r]=Xo()===58?"&\f":"",t[r]=n[r].length;break}default:n[r]+=Ib(a)}while(a=La());return n},sq=function(n,t){return eT(aq(Z2(n),t))},qC=new WeakMap,oq=function(n){if(!(n.type!=="rule"||!n.parent||n.length<1)){for(var t=n.value,r=n.parent,a=n.column===r.column&&n.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(n.props.length===1&&t.charCodeAt(0)!==58&&!qC.get(r))&&!a){qC.set(n,!0);for(var o=[],l=sq(t,o),d=r.props,f=0,u=0;f<l.length;f++)for(var p=0;p<d.length;p++,u++)n.props[u]=o[f]?l[f].replace(/&\f/g,d[p]):d[p]+" "+l[f]}}},lq=function(n){if(n.type==="decl"){var t=n.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(n.return="",n.value="")}};function tT(e,n){switch(q9(e,n)){case 5103:return In+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return In+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return In+e+ib+e+Ni+e+e;case 6828:case 4268:return In+e+Ni+e+e;case 6165:return In+e+Ni+"flex-"+e+e;case 5187:return In+e+Rn(e,/(\w+).+(:[^]+)/,In+"box-$1$2"+Ni+"flex-$1$2")+e;case 5443:return In+e+Ni+"flex-item-"+Rn(e,/flex-|-self/,"")+e;case 4675:return In+e+Ni+"flex-line-pack"+Rn(e,/align-content|flex-|-self/,"")+e;case 5548:return In+e+Ni+Rn(e,"shrink","negative")+e;case 5292:return In+e+Ni+Rn(e,"basis","preferred-size")+e;case 6060:return In+"box-"+Rn(e,"-grow","")+In+e+Ni+Rn(e,"grow","positive")+e;case 4554:return In+Rn(e,/([^-])(transform)/g,"$1"+In+"$2")+e;case 6187:return Rn(Rn(Rn(e,/(zoom-|grab)/,In+"$1"),/(image-set)/,In+"$1"),e,"")+e;case 5495:case 3959:return Rn(e,/(image-set\([^]*)/,In+"$1$`$1");case 4968:return Rn(Rn(e,/(.+:)(flex-)?(.*)/,In+"box-pack:$3"+Ni+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+In+e+e;case 4095:case 3583:case 4068:case 2532:return Rn(e,/(.+)-inline(.+)/,In+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Yo(e)-1-n>6)switch(ci(e,n+1)){case 109:if(ci(e,n+4)!==45)break;case 102:return Rn(e,/(.+:)(.+)-([^]+)/,"$1"+In+"$2-$3$1"+ib+(ci(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~j1(e,"stretch")?tT(Rn(e,"stretch","fill-available"),n)+e:e}break;case 4949:if(ci(e,n+1)!==115)break;case 6444:switch(ci(e,Yo(e)-3-(~j1(e,"!important")&&10))){case 107:return Rn(e,":",":"+In)+e;case 101:return Rn(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+In+(ci(e,14)===45?"inline-":"")+"box$3$1"+In+"$2$3$1"+Ni+"$2box$3")+e}break;case 5936:switch(ci(e,n+11)){case 114:return In+e+Ni+Rn(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return In+e+Ni+Rn(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return In+e+Ni+Rn(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return In+e+Ni+e+e}return e}var cq=function(n,t,r,a){if(n.length>-1&&!n.return)switch(n.type){case Ow:n.return=tT(n.value,n.length);break;case J2:return Th([Am(n,{value:Rn(n.value,"@","@"+In)})],a);case Mw:if(n.length)return H9(n.props,function(o){switch(V9(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Th([Am(n,{props:[Rn(o,/:(read-\w+)/,":"+ib+"$1")]})],a);case"::placeholder":return Th([Am(n,{props:[Rn(o,/:(plac\w+)/,":"+In+"input-$1")]}),Am(n,{props:[Rn(o,/:(plac\w+)/,":"+ib+"$1")]}),Am(n,{props:[Rn(o,/:(plac\w+)/,Ni+"input-$1")]})],a)}return""})}},uq=[cq],dq=function(n){var t=n.key;if(t==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(k){var T=k.getAttribute("data-emotion");T.indexOf(" ")!==-1&&(document.head.appendChild(k),k.setAttribute("data-s",""))})}var a=n.stylisPlugins||uq,o={},l,d=[];l=n.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(k){for(var T=k.getAttribute("data-emotion").split(" "),A=1;A<T.length;A++)o[T[A]]=!0;d.push(k)});var f,u=[oq,lq];{var p,g=[eq,nq(function(k){p.insert(k)})],b=tq(u.concat(a,g)),v=function(T){return Th(X9(T),b)};f=function(T,A,M,R){p=M,v(T?T+"{"+A.styles+"}":A.styles),R&&(S.inserted[A.name]=!0)}}var S={key:t,sheet:new F9({key:t,container:l,nonce:n.nonce,speedy:n.speedy,prepend:n.prepend,insertionPoint:n.insertionPoint}),nonce:n.nonce,inserted:o,registered:{},insert:f};return S.sheet.hydrate(d),S},g0={exports:{}},$n={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VC;function fq(){if(VC)return $n;VC=1;var e=typeof Symbol=="function"&&Symbol.for,n=e?Symbol.for("react.element"):60103,t=e?Symbol.for("react.portal"):60106,r=e?Symbol.for("react.fragment"):60107,a=e?Symbol.for("react.strict_mode"):60108,o=e?Symbol.for("react.profiler"):60114,l=e?Symbol.for("react.provider"):60109,d=e?Symbol.for("react.context"):60110,f=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,p=e?Symbol.for("react.forward_ref"):60112,g=e?Symbol.for("react.suspense"):60113,b=e?Symbol.for("react.suspense_list"):60120,v=e?Symbol.for("react.memo"):60115,S=e?Symbol.for("react.lazy"):60116,k=e?Symbol.for("react.block"):60121,T=e?Symbol.for("react.fundamental"):60117,A=e?Symbol.for("react.responder"):60118,M=e?Symbol.for("react.scope"):60119;function R(F){if(typeof F=="object"&&F!==null){var L=F.$$typeof;switch(L){case n:switch(F=F.type,F){case f:case u:case r:case o:case a:case g:return F;default:switch(F=F&&F.$$typeof,F){case d:case p:case S:case v:case l:return F;default:return L}}case t:return L}}}function z(F){return R(F)===u}return $n.AsyncMode=f,$n.ConcurrentMode=u,$n.ContextConsumer=d,$n.ContextProvider=l,$n.Element=n,$n.ForwardRef=p,$n.Fragment=r,$n.Lazy=S,$n.Memo=v,$n.Portal=t,$n.Profiler=o,$n.StrictMode=a,$n.Suspense=g,$n.isAsyncMode=function(F){return z(F)||R(F)===f},$n.isConcurrentMode=z,$n.isContextConsumer=function(F){return R(F)===d},$n.isContextProvider=function(F){return R(F)===l},$n.isElement=function(F){return typeof F=="object"&&F!==null&&F.$$typeof===n},$n.isForwardRef=function(F){return R(F)===p},$n.isFragment=function(F){return R(F)===r},$n.isLazy=function(F){return R(F)===S},$n.isMemo=function(F){return R(F)===v},$n.isPortal=function(F){return R(F)===t},$n.isProfiler=function(F){return R(F)===o},$n.isStrictMode=function(F){return R(F)===a},$n.isSuspense=function(F){return R(F)===g},$n.isValidElementType=function(F){return typeof F=="string"||typeof F=="function"||F===r||F===u||F===o||F===a||F===g||F===b||typeof F=="object"&&F!==null&&(F.$$typeof===S||F.$$typeof===v||F.$$typeof===l||F.$$typeof===d||F.$$typeof===p||F.$$typeof===T||F.$$typeof===A||F.$$typeof===M||F.$$typeof===k)},$n.typeOf=R,$n}var HC;function hq(){return HC||(HC=1,g0.exports=fq()),g0.exports}var y0,GC;function pq(){if(GC)return y0;GC=1;var e=hq(),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},t={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};o[e.ForwardRef]=r,o[e.Memo]=a;function l(S){return e.isMemo(S)?a:o[S.$$typeof]||n}var d=Object.defineProperty,f=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,g=Object.getPrototypeOf,b=Object.prototype;function v(S,k,T){if(typeof k!="string"){if(b){var A=g(k);A&&A!==b&&v(S,A,T)}var M=f(k);u&&(M=M.concat(u(k)));for(var R=l(S),z=l(k),F=0;F<M.length;++F){var L=M[F];if(!t[L]&&!(T&&T[L])&&!(z&&z[L])&&!(R&&R[L])){var U=p(k,L);try{d(S,L,U)}catch{}}}}return S}return y0=v,y0}pq();var mq=!0;function gq(e,n,t){var r="";return t.split(" ").forEach(function(a){e[a]!==void 0?n.push(e[a]+";"):a&&(r+=a+" ")}),r}var nT=function(n,t,r){var a=n.key+"-"+t.name;(r===!1||mq===!1)&&n.registered[a]===void 0&&(n.registered[a]=t.styles)},yq=function(n,t,r){nT(n,t,r);var a=n.key+"-"+t.name;if(n.inserted[t.name]===void 0){var o=t;do n.insert(t===o?"."+a:"",o,n.sheet,!0),o=o.next;while(o!==void 0)}};function xq(e){for(var n=0,t,r=0,a=e.length;a>=4;++r,a-=4)t=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,n=(t&65535)*1540483477+((t>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(a){case 3:n^=(e.charCodeAt(r+2)&255)<<16;case 2:n^=(e.charCodeAt(r+1)&255)<<8;case 1:n^=e.charCodeAt(r)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}var bq={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},vq=/[A-Z]|^ms/g,wq=/_EMO_([^_]+?)_([^]*?)_EMO_/g,rT=function(n){return n.charCodeAt(1)===45},YC=function(n){return n!=null&&typeof n!="boolean"},x0=rq(function(e){return rT(e)?e:e.replace(vq,"-$&").toLowerCase()}),WC=function(n,t){switch(n){case"animation":case"animationName":if(typeof t=="string")return t.replace(wq,function(r,a,o){return Wo={name:a,styles:o,next:Wo},a})}return bq[n]!==1&&!rT(n)&&typeof t=="number"&&t!==0?t+"px":t};function eg(e,n,t){if(t==null)return"";var r=t;if(r.__emotion_styles!==void 0)return r;switch(typeof t){case"boolean":return"";case"object":{var a=t;if(a.anim===1)return Wo={name:a.name,styles:a.styles,next:Wo},a.name;var o=t;if(o.styles!==void 0){var l=o.next;if(l!==void 0)for(;l!==void 0;)Wo={name:l.name,styles:l.styles,next:Wo},l=l.next;var d=o.styles+";";return d}return Sq(e,n,t)}case"function":{if(e!==void 0){var f=Wo,u=t(e);return Wo=f,eg(e,n,u)}break}}var p=t;return p}function Sq(e,n,t){var r="";if(Array.isArray(t))for(var a=0;a<t.length;a++)r+=eg(e,n,t[a])+";";else for(var o in t){var l=t[o];if(typeof l!="object"){var d=l;YC(d)&&(r+=x0(o)+":"+WC(o,d)+";")}else if(Array.isArray(l)&&typeof l[0]=="string"&&n==null)for(var f=0;f<l.length;f++)YC(l[f])&&(r+=x0(o)+":"+WC(o,l[f])+";");else{var u=eg(e,n,l);switch(o){case"animation":case"animationName":{r+=x0(o)+":"+u+";";break}default:r+=o+"{"+u+"}"}}}return r}var QC=/label:\s*([^\s;{]+)\s*(;|$)/g,Wo;function iT(e,n,t){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var r=!0,a="";Wo=void 0;var o=e[0];if(o==null||o.raw===void 0)r=!1,a+=eg(t,n,o);else{var l=o;a+=l[0]}for(var d=1;d<e.length;d++)if(a+=eg(t,n,e[d]),r){var f=o;a+=f[d]}QC.lastIndex=0;for(var u="",p;(p=QC.exec(a))!==null;)u+="-"+p[1];var g=xq(a)+u;return{name:g,styles:a,next:Wo}}var Nq=function(n){return n()},Cq=xS.useInsertionEffect?xS.useInsertionEffect:!1,_q=Cq||Nq,aT=w.createContext(typeof HTMLElement<"u"?dq({key:"css"}):null);aT.Provider;var jq=function(n){return w.forwardRef(function(t,r){var a=w.useContext(aT);return n(t,a,r)})},kq=w.createContext({}),Fw={}.hasOwnProperty,T1="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",Tq=function(n,t){var r={};for(var a in t)Fw.call(t,a)&&(r[a]=t[a]);return r[T1]=n,r},Eq=function(n){var t=n.cache,r=n.serialized,a=n.isStringTag;return nT(t,r,a),_q(function(){return yq(t,r,a)}),null},Aq=jq(function(e,n,t){var r=e.css;typeof r=="string"&&n.registered[r]!==void 0&&(r=n.registered[r]);var a=e[T1],o=[r],l="";typeof e.className=="string"?l=gq(n.registered,o,e.className):e.className!=null&&(l=e.className+" ");var d=iT(o,void 0,w.useContext(kq));l+=n.key+"-"+d.name;var f={};for(var u in e)Fw.call(e,u)&&u!=="css"&&u!==T1&&(f[u]=e[u]);return f.className=l,t&&(f.ref=t),w.createElement(w.Fragment,null,w.createElement(Eq,{cache:n,serialized:d,isStringTag:typeof a=="string"}),w.createElement(a,f))}),Pq=Aq,Pt=function(n,t){var r=arguments;if(t==null||!Fw.call(t,"css"))return w.createElement.apply(void 0,r);var a=r.length,o=new Array(a);o[0]=Pq,o[1]=Tq(n,t);for(var l=2;l<a;l++)o[l]=r[l];return w.createElement.apply(null,o)};(function(e){var n;n||(n=e.JSX||(e.JSX={}))})(Pt||(Pt={}));function $w(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return iT(n)}function Dq(){var e=$w.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function Iq(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}const Rq=Math.min,Mq=Math.max,ab=Math.round,wx=Math.floor,sb=e=>({x:e,y:e});function Oq(e){const{x:n,y:t,width:r,height:a}=e;return{width:r,height:a,top:t,left:n,right:n+r,bottom:t+a,x:n,y:t}}function Ob(){return typeof window<"u"}function sT(e){return lT(e)?(e.nodeName||"").toLowerCase():"#document"}function Xl(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function oT(e){var n;return(n=(lT(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function lT(e){return Ob()?e instanceof Node||e instanceof Xl(e).Node:!1}function Lq(e){return Ob()?e instanceof Element||e instanceof Xl(e).Element:!1}function zw(e){return Ob()?e instanceof HTMLElement||e instanceof Xl(e).HTMLElement:!1}function JC(e){return!Ob()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Xl(e).ShadowRoot}const Fq=new Set(["inline","contents"]);function cT(e){const{overflow:n,overflowX:t,overflowY:r,display:a}=Uw(e);return/auto|scroll|overlay|hidden|clip/.test(n+r+t)&&!Fq.has(a)}function $q(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const zq=new Set(["html","body","#document"]);function Uq(e){return zq.has(sT(e))}function Uw(e){return Xl(e).getComputedStyle(e)}function Bq(e){if(sT(e)==="html")return e;const n=e.assignedSlot||e.parentNode||JC(e)&&e.host||oT(e);return JC(n)?n.host:n}function uT(e){const n=Bq(e);return Uq(n)?e.ownerDocument?e.ownerDocument.body:e.body:zw(n)&&cT(n)?n:uT(n)}function ob(e,n,t){var r;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=uT(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),l=Xl(a);if(o){const d=E1(l);return n.concat(l,l.visualViewport||[],cT(a)?a:[],d&&t?ob(d):[])}return n.concat(a,ob(a,[],t))}function E1(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function qq(e){const n=Uw(e);let t=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const a=zw(e),o=a?e.offsetWidth:t,l=a?e.offsetHeight:r,d=ab(t)!==o||ab(r)!==l;return d&&(t=o,r=l),{width:t,height:r,$:d}}function Bw(e){return Lq(e)?e:e.contextElement}function KC(e){const n=Bw(e);if(!zw(n))return sb(1);const t=n.getBoundingClientRect(),{width:r,height:a,$:o}=qq(n);let l=(o?ab(t.width):t.width)/r,d=(o?ab(t.height):t.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!d||!Number.isFinite(d))&&(d=1),{x:l,y:d}}const Vq=sb(0);function Hq(e){const n=Xl(e);return!$q()||!n.visualViewport?Vq:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function Gq(e,n,t){return!1}function XC(e,n,t,r){n===void 0&&(n=!1);const a=e.getBoundingClientRect(),o=Bw(e);let l=sb(1);n&&(l=KC(e));const d=Gq()?Hq(o):sb(0);let f=(a.left+d.x)/l.x,u=(a.top+d.y)/l.y,p=a.width/l.x,g=a.height/l.y;if(o){const b=Xl(o),v=r;let S=b,k=E1(S);for(;k&&r&&v!==S;){const T=KC(k),A=k.getBoundingClientRect(),M=Uw(k),R=A.left+(k.clientLeft+parseFloat(M.paddingLeft))*T.x,z=A.top+(k.clientTop+parseFloat(M.paddingTop))*T.y;f*=T.x,u*=T.y,p*=T.x,g*=T.y,f+=R,u+=z,S=Xl(k),k=E1(S)}}return Oq({width:p,height:g,x:f,y:u})}function dT(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function Yq(e,n){let t=null,r;const a=oT(e);function o(){var d;clearTimeout(r),(d=t)==null||d.disconnect(),t=null}function l(d,f){d===void 0&&(d=!1),f===void 0&&(f=1),o();const u=e.getBoundingClientRect(),{left:p,top:g,width:b,height:v}=u;if(d||n(),!b||!v)return;const S=wx(g),k=wx(a.clientWidth-(p+b)),T=wx(a.clientHeight-(g+v)),A=wx(p),R={rootMargin:-S+"px "+-k+"px "+-T+"px "+-A+"px",threshold:Mq(0,Rq(1,f))||1};let z=!0;function F(L){const U=L[0].intersectionRatio;if(U!==f){if(!z)return l();U?l(!1,U):r=setTimeout(()=>{l(!1,1e-7)},1e3)}U===1&&!dT(u,e.getBoundingClientRect())&&l(),z=!1}try{t=new IntersectionObserver(F,{...R,root:a.ownerDocument})}catch{t=new IntersectionObserver(F,R)}t.observe(e)}return l(!0),o}function Wq(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:d=typeof IntersectionObserver=="function",animationFrame:f=!1}=r,u=Bw(e),p=a||o?[...u?ob(u):[],...ob(n)]:[];p.forEach(A=>{a&&A.addEventListener("scroll",t,{passive:!0}),o&&A.addEventListener("resize",t)});const g=u&&d?Yq(u,t):null;let b=-1,v=null;l&&(v=new ResizeObserver(A=>{let[M]=A;M&&M.target===u&&v&&(v.unobserve(n),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var R;(R=v)==null||R.observe(n)})),t()}),u&&!f&&v.observe(u),v.observe(n));let S,k=f?XC(e):null;f&&T();function T(){const A=XC(e);k&&!dT(k,A)&&t(),k=A,S=requestAnimationFrame(T)}return t(),()=>{var A;p.forEach(M=>{a&&M.removeEventListener("scroll",t),o&&M.removeEventListener("resize",t)}),g==null||g(),(A=v)==null||A.disconnect(),v=null,f&&cancelAnimationFrame(S)}}var A1=w.useLayoutEffect,Qq=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],lb=function(){};function Jq(e,n){return n?n[0]==="-"?e+n:e+"__"+n:e}function Kq(e,n){for(var t=arguments.length,r=new Array(t>2?t-2:0),a=2;a<t;a++)r[a-2]=arguments[a];var o=[].concat(r);if(n&&e)for(var l in n)n.hasOwnProperty(l)&&n[l]&&o.push("".concat(Jq(e,l)));return o.filter(function(d){return d}).map(function(d){return String(d).trim()}).join(" ")}var ZC=function(n){return s7(n)?n.filter(Boolean):zd(n)==="object"&&n!==null?[n]:[]},fT=function(n){n.className,n.clearValue,n.cx,n.getStyles,n.getClassNames,n.getValue,n.hasValue,n.isMulti,n.isRtl,n.options,n.selectOption,n.selectProps,n.setValue,n.theme;var t=ec(n,Qq);return Lt({},t)},br=function(n,t,r){var a=n.cx,o=n.getStyles,l=n.getClassNames,d=n.className;return{css:o(t,n),className:a(r??{},l(t,n),d)}};function Lb(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function Xq(e){return Lb(e)?window.innerHeight:e.clientHeight}function hT(e){return Lb(e)?window.pageYOffset:e.scrollTop}function cb(e,n){if(Lb(e)){window.scrollTo(0,n);return}e.scrollTop=n}function Zq(e){var n=getComputedStyle(e),t=n.position==="absolute",r=/(auto|scroll)/;if(n.position==="fixed")return document.documentElement;for(var a=e;a=a.parentElement;)if(n=getComputedStyle(a),!(t&&n.position==="static")&&r.test(n.overflow+n.overflowY+n.overflowX))return a;return document.documentElement}function e7(e,n,t,r){return t*((e=e/r-1)*e*e+1)+n}function Sx(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:lb,a=hT(e),o=n-a,l=10,d=0;function f(){d+=l;var u=e7(d,a,o,t);cb(e,u),d<t?window.requestAnimationFrame(f):r(e)}f()}function e_(e,n){var t=e.getBoundingClientRect(),r=n.getBoundingClientRect(),a=n.offsetHeight/3;r.bottom+a>t.bottom?cb(e,Math.min(n.offsetTop+n.clientHeight-e.offsetHeight+a,e.scrollHeight)):r.top-a<t.top&&cb(e,Math.max(n.offsetTop-a,0))}function t7(e){var n=e.getBoundingClientRect();return{bottom:n.bottom,height:n.height,left:n.left,right:n.right,top:n.top,width:n.width}}function t_(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function n7(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var pT=!1,r7={get passive(){return pT=!0}},Nx=typeof window<"u"?window:{};Nx.addEventListener&&Nx.removeEventListener&&(Nx.addEventListener("p",lb,r7),Nx.removeEventListener("p",lb,!1));var i7=pT;function a7(e){return e!=null}function s7(e){return Array.isArray(e)}function Cx(e,n,t){return e?n:t}var o7=function(n){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];var o=Object.entries(n).filter(function(l){var d=Wl(l,1),f=d[0];return!r.includes(f)});return o.reduce(function(l,d){var f=Wl(d,2),u=f[0],p=f[1];return l[u]=p,l},{})},l7=["children","innerProps"],c7=["children","innerProps"];function u7(e){var n=e.maxHeight,t=e.menuEl,r=e.minHeight,a=e.placement,o=e.shouldScroll,l=e.isFixedPosition,d=e.controlHeight,f=Zq(t),u={placement:"bottom",maxHeight:n};if(!t||!t.offsetParent)return u;var p=f.getBoundingClientRect(),g=p.height,b=t.getBoundingClientRect(),v=b.bottom,S=b.height,k=b.top,T=t.offsetParent.getBoundingClientRect(),A=T.top,M=l?window.innerHeight:Xq(f),R=hT(f),z=parseInt(getComputedStyle(t).marginBottom,10),F=parseInt(getComputedStyle(t).marginTop,10),L=A-F,U=M-k,B=L+R,J=g-R-k,D=v-M+R+z,$=R+k-F,H=160;switch(a){case"auto":case"bottom":if(U>=S)return{placement:"bottom",maxHeight:n};if(J>=S&&!l)return o&&Sx(f,D,H),{placement:"bottom",maxHeight:n};if(!l&&J>=r||l&&U>=r){o&&Sx(f,D,H);var te=l?U-z:J-z;return{placement:"bottom",maxHeight:te}}if(a==="auto"||l){var Q=n,Y=l?L:B;return Y>=r&&(Q=Math.min(Y-z-d,n)),{placement:"top",maxHeight:Q}}if(a==="bottom")return o&&cb(f,D),{placement:"bottom",maxHeight:n};break;case"top":if(L>=S)return{placement:"top",maxHeight:n};if(B>=S&&!l)return o&&Sx(f,$,H),{placement:"top",maxHeight:n};if(!l&&B>=r||l&&L>=r){var V=n;return(!l&&B>=r||l&&L>=r)&&(V=l?L-F:B-F),o&&Sx(f,$,H),{placement:"top",maxHeight:V}}return{placement:"bottom",maxHeight:n};default:throw new Error('Invalid placement provided "'.concat(a,'".'))}return u}function d7(e){var n={bottom:"top",top:"bottom"};return e?n[e]:"bottom"}var mT=function(n){return n==="auto"?"bottom":n},f7=function(n,t){var r,a=n.placement,o=n.theme,l=o.borderRadius,d=o.spacing,f=o.colors;return Lt((r={label:"menu"},Fm(r,d7(a),"100%"),Fm(r,"position","absolute"),Fm(r,"width","100%"),Fm(r,"zIndex",1),r),t?{}:{backgroundColor:f.neutral0,borderRadius:l,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:d.menuGutter,marginTop:d.menuGutter})},gT=w.createContext(null),h7=function(n){var t=n.children,r=n.minMenuHeight,a=n.maxMenuHeight,o=n.menuPlacement,l=n.menuPosition,d=n.menuShouldScrollIntoView,f=n.theme,u=w.useContext(gT)||{},p=u.setPortalPlacement,g=w.useRef(null),b=w.useState(a),v=Wl(b,2),S=v[0],k=v[1],T=w.useState(null),A=Wl(T,2),M=A[0],R=A[1],z=f.spacing.controlHeight;return A1(function(){var F=g.current;if(F){var L=l==="fixed",U=d&&!L,B=u7({maxHeight:a,menuEl:F,minHeight:r,placement:o,shouldScroll:U,isFixedPosition:L,controlHeight:z});k(B.maxHeight),R(B.placement),p==null||p(B.placement)}},[a,o,l,d,r,p,z]),t({ref:g,placerProps:Lt(Lt({},n),{},{placement:M||mT(o),maxHeight:S})})},p7=function(n){var t=n.children,r=n.innerRef,a=n.innerProps;return Pt("div",Ut({},br(n,"menu",{menu:!0}),{ref:r},a),t)},m7=p7,g7=function(n,t){var r=n.maxHeight,a=n.theme.spacing.baseUnit;return Lt({maxHeight:r,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},t?{}:{paddingBottom:a,paddingTop:a})},y7=function(n){var t=n.children,r=n.innerProps,a=n.innerRef,o=n.isMulti;return Pt("div",Ut({},br(n,"menuList",{"menu-list":!0,"menu-list--is-multi":o}),{ref:a},r),t)},yT=function(n,t){var r=n.theme,a=r.spacing.baseUnit,o=r.colors;return Lt({textAlign:"center"},t?{}:{color:o.neutral40,padding:"".concat(a*2,"px ").concat(a*3,"px")})},x7=yT,b7=yT,v7=function(n){var t=n.children,r=t===void 0?"No options":t,a=n.innerProps,o=ec(n,l7);return Pt("div",Ut({},br(Lt(Lt({},o),{},{children:r,innerProps:a}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),a),r)},w7=function(n){var t=n.children,r=t===void 0?"Loading...":t,a=n.innerProps,o=ec(n,c7);return Pt("div",Ut({},br(Lt(Lt({},o),{},{children:r,innerProps:a}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),a),r)},S7=function(n){var t=n.rect,r=n.offset,a=n.position;return{left:t.left,position:a,top:r,width:t.width,zIndex:1}},N7=function(n){var t=n.appendTo,r=n.children,a=n.controlElement,o=n.innerProps,l=n.menuPlacement,d=n.menuPosition,f=w.useRef(null),u=w.useRef(null),p=w.useState(mT(l)),g=Wl(p,2),b=g[0],v=g[1],S=w.useMemo(function(){return{setPortalPlacement:v}},[]),k=w.useState(null),T=Wl(k,2),A=T[0],M=T[1],R=w.useCallback(function(){if(a){var U=t7(a),B=d==="fixed"?0:window.pageYOffset,J=U[b]+B;(J!==(A==null?void 0:A.offset)||U.left!==(A==null?void 0:A.rect.left)||U.width!==(A==null?void 0:A.rect.width))&&M({offset:J,rect:U})}},[a,d,b,A==null?void 0:A.offset,A==null?void 0:A.rect.left,A==null?void 0:A.rect.width]);A1(function(){R()},[R]);var z=w.useCallback(function(){typeof u.current=="function"&&(u.current(),u.current=null),a&&f.current&&(u.current=Wq(a,f.current,R,{elementResize:"ResizeObserver"in window}))},[a,R]);A1(function(){z()},[z]);var F=w.useCallback(function(U){f.current=U,z()},[z]);if(!t&&d!=="fixed"||!A)return null;var L=Pt("div",Ut({ref:F},br(Lt(Lt({},n),{},{offset:A.offset,position:d,rect:A.rect}),"menuPortal",{"menu-portal":!0}),o),r);return Pt(gT.Provider,{value:S},t?QD.createPortal(L,t):L)},C7=function(n){var t=n.isDisabled,r=n.isRtl;return{label:"container",direction:r?"rtl":void 0,pointerEvents:t?"none":void 0,position:"relative"}},_7=function(n){var t=n.children,r=n.innerProps,a=n.isDisabled,o=n.isRtl;return Pt("div",Ut({},br(n,"container",{"--is-disabled":a,"--is-rtl":o}),r),t)},j7=function(n,t){var r=n.theme.spacing,a=n.isMulti,o=n.hasValue,l=n.selectProps.controlShouldRenderValue;return Lt({alignItems:"center",display:a&&o&&l?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},t?{}:{padding:"".concat(r.baseUnit/2,"px ").concat(r.baseUnit*2,"px")})},k7=function(n){var t=n.children,r=n.innerProps,a=n.isMulti,o=n.hasValue;return Pt("div",Ut({},br(n,"valueContainer",{"value-container":!0,"value-container--is-multi":a,"value-container--has-value":o}),r),t)},T7=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},E7=function(n){var t=n.children,r=n.innerProps;return Pt("div",Ut({},br(n,"indicatorsContainer",{indicators:!0}),r),t)},n_,A7=["size"],P7=["innerProps","isRtl","size"],D7={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},xT=function(n){var t=n.size,r=ec(n,A7);return Pt("svg",Ut({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:D7},r))},qw=function(n){return Pt(xT,Ut({size:20},n),Pt("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},bT=function(n){return Pt(xT,Ut({size:20},n),Pt("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},vT=function(n,t){var r=n.isFocused,a=n.theme,o=a.spacing.baseUnit,l=a.colors;return Lt({label:"indicatorContainer",display:"flex",transition:"color 150ms"},t?{}:{color:r?l.neutral60:l.neutral20,padding:o*2,":hover":{color:r?l.neutral80:l.neutral40}})},I7=vT,R7=function(n){var t=n.children,r=n.innerProps;return Pt("div",Ut({},br(n,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),r),t||Pt(bT,null))},M7=vT,O7=function(n){var t=n.children,r=n.innerProps;return Pt("div",Ut({},br(n,"clearIndicator",{indicator:!0,"clear-indicator":!0}),r),t||Pt(qw,null))},L7=function(n,t){var r=n.isDisabled,a=n.theme,o=a.spacing.baseUnit,l=a.colors;return Lt({label:"indicatorSeparator",alignSelf:"stretch",width:1},t?{}:{backgroundColor:r?l.neutral10:l.neutral20,marginBottom:o*2,marginTop:o*2})},F7=function(n){var t=n.innerProps;return Pt("span",Ut({},t,br(n,"indicatorSeparator",{"indicator-separator":!0})))},$7=Dq(n_||(n_=Iq([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),z7=function(n,t){var r=n.isFocused,a=n.size,o=n.theme,l=o.colors,d=o.spacing.baseUnit;return Lt({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:a,lineHeight:1,marginRight:a,textAlign:"center",verticalAlign:"middle"},t?{}:{color:r?l.neutral60:l.neutral20,padding:d*2})},b0=function(n){var t=n.delay,r=n.offset;return Pt("span",{css:$w({animation:"".concat($7," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:r?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},U7=function(n){var t=n.innerProps,r=n.isRtl,a=n.size,o=a===void 0?4:a,l=ec(n,P7);return Pt("div",Ut({},br(Lt(Lt({},l),{},{innerProps:t,isRtl:r,size:o}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),t),Pt(b0,{delay:0,offset:r}),Pt(b0,{delay:160,offset:!0}),Pt(b0,{delay:320,offset:!r}))},B7=function(n,t){var r=n.isDisabled,a=n.isFocused,o=n.theme,l=o.colors,d=o.borderRadius,f=o.spacing;return Lt({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:f.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},t?{}:{backgroundColor:r?l.neutral5:l.neutral0,borderColor:r?l.neutral10:a?l.primary:l.neutral20,borderRadius:d,borderStyle:"solid",borderWidth:1,boxShadow:a?"0 0 0 1px ".concat(l.primary):void 0,"&:hover":{borderColor:a?l.primary:l.neutral30}})},q7=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,o=n.innerRef,l=n.innerProps,d=n.menuIsOpen;return Pt("div",Ut({ref:o},br(n,"control",{control:!0,"control--is-disabled":r,"control--is-focused":a,"control--menu-is-open":d}),l,{"aria-disabled":r||void 0}),t)},V7=q7,H7=["data"],G7=function(n,t){var r=n.theme.spacing;return t?{}:{paddingBottom:r.baseUnit*2,paddingTop:r.baseUnit*2}},Y7=function(n){var t=n.children,r=n.cx,a=n.getStyles,o=n.getClassNames,l=n.Heading,d=n.headingProps,f=n.innerProps,u=n.label,p=n.theme,g=n.selectProps;return Pt("div",Ut({},br(n,"group",{group:!0}),f),Pt(l,Ut({},d,{selectProps:g,theme:p,getStyles:a,getClassNames:o,cx:r}),u),Pt("div",null,t))},W7=function(n,t){var r=n.theme,a=r.colors,o=r.spacing;return Lt({label:"group",cursor:"default",display:"block"},t?{}:{color:a.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:o.baseUnit*3,paddingRight:o.baseUnit*3,textTransform:"uppercase"})},Q7=function(n){var t=fT(n);t.data;var r=ec(t,H7);return Pt("div",Ut({},br(n,"groupHeading",{"group-heading":!0}),r))},J7=Y7,K7=["innerRef","isDisabled","isHidden","inputClassName"],X7=function(n,t){var r=n.isDisabled,a=n.value,o=n.theme,l=o.spacing,d=o.colors;return Lt(Lt({visibility:r?"hidden":"visible",transform:a?"translateZ(0)":""},Z7),t?{}:{margin:l.baseUnit/2,paddingBottom:l.baseUnit/2,paddingTop:l.baseUnit/2,color:d.neutral80})},wT={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},Z7={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Lt({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},wT)},eV=function(n){return Lt({label:"input",color:"inherit",background:0,opacity:n?0:1,width:"100%"},wT)},tV=function(n){var t=n.cx,r=n.value,a=fT(n),o=a.innerRef,l=a.isDisabled,d=a.isHidden,f=a.inputClassName,u=ec(a,K7);return Pt("div",Ut({},br(n,"input",{"input-container":!0}),{"data-value":r||""}),Pt("input",Ut({className:t({input:!0},f),ref:o,style:eV(d),disabled:l},u)))},nV=tV,rV=function(n,t){var r=n.theme,a=r.spacing,o=r.borderRadius,l=r.colors;return Lt({label:"multiValue",display:"flex",minWidth:0},t?{}:{backgroundColor:l.neutral10,borderRadius:o/2,margin:a.baseUnit/2})},iV=function(n,t){var r=n.theme,a=r.borderRadius,o=r.colors,l=n.cropWithEllipsis;return Lt({overflow:"hidden",textOverflow:l||l===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},t?{}:{borderRadius:a/2,color:o.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},aV=function(n,t){var r=n.theme,a=r.spacing,o=r.borderRadius,l=r.colors,d=n.isFocused;return Lt({alignItems:"center",display:"flex"},t?{}:{borderRadius:o/2,backgroundColor:d?l.dangerLight:void 0,paddingLeft:a.baseUnit,paddingRight:a.baseUnit,":hover":{backgroundColor:l.dangerLight,color:l.danger}})},ST=function(n){var t=n.children,r=n.innerProps;return Pt("div",r,t)},sV=ST,oV=ST;function lV(e){var n=e.children,t=e.innerProps;return Pt("div",Ut({role:"button"},t),n||Pt(qw,{size:14}))}var cV=function(n){var t=n.children,r=n.components,a=n.data,o=n.innerProps,l=n.isDisabled,d=n.removeProps,f=n.selectProps,u=r.Container,p=r.Label,g=r.Remove;return Pt(u,{data:a,innerProps:Lt(Lt({},br(n,"multiValue",{"multi-value":!0,"multi-value--is-disabled":l})),o),selectProps:f},Pt(p,{data:a,innerProps:Lt({},br(n,"multiValueLabel",{"multi-value__label":!0})),selectProps:f},t),Pt(g,{data:a,innerProps:Lt(Lt({},br(n,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(t||"option")},d),selectProps:f}))},uV=cV,dV=function(n,t){var r=n.isDisabled,a=n.isFocused,o=n.isSelected,l=n.theme,d=l.spacing,f=l.colors;return Lt({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},t?{}:{backgroundColor:o?f.primary:a?f.primary25:"transparent",color:r?f.neutral20:o?f.neutral0:"inherit",padding:"".concat(d.baseUnit*2,"px ").concat(d.baseUnit*3,"px"),":active":{backgroundColor:r?void 0:o?f.primary:f.primary50}})},fV=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,o=n.isSelected,l=n.innerRef,d=n.innerProps;return Pt("div",Ut({},br(n,"option",{option:!0,"option--is-disabled":r,"option--is-focused":a,"option--is-selected":o}),{ref:l,"aria-disabled":r},d),t)},hV=fV,pV=function(n,t){var r=n.theme,a=r.spacing,o=r.colors;return Lt({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},t?{}:{color:o.neutral50,marginLeft:a.baseUnit/2,marginRight:a.baseUnit/2})},mV=function(n){var t=n.children,r=n.innerProps;return Pt("div",Ut({},br(n,"placeholder",{placeholder:!0}),r),t)},gV=mV,yV=function(n,t){var r=n.isDisabled,a=n.theme,o=a.spacing,l=a.colors;return Lt({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t?{}:{color:r?l.neutral40:l.neutral80,marginLeft:o.baseUnit/2,marginRight:o.baseUnit/2})},xV=function(n){var t=n.children,r=n.isDisabled,a=n.innerProps;return Pt("div",Ut({},br(n,"singleValue",{"single-value":!0,"single-value--is-disabled":r}),a),t)},bV=xV,vV={ClearIndicator:O7,Control:V7,DropdownIndicator:R7,DownChevron:bT,CrossIcon:qw,Group:J7,GroupHeading:Q7,IndicatorsContainer:E7,IndicatorSeparator:F7,Input:nV,LoadingIndicator:U7,Menu:m7,MenuList:y7,MenuPortal:N7,LoadingMessage:w7,NoOptionsMessage:v7,MultiValue:uV,MultiValueContainer:sV,MultiValueLabel:oV,MultiValueRemove:lV,Option:hV,Placeholder:gV,SelectContainer:_7,SingleValue:bV,ValueContainer:k7},wV=function(n){return Lt(Lt({},vV),n.components)},r_=Number.isNaN||function(n){return typeof n=="number"&&n!==n};function SV(e,n){return!!(e===n||r_(e)&&r_(n))}function NV(e,n){if(e.length!==n.length)return!1;for(var t=0;t<e.length;t++)if(!SV(e[t],n[t]))return!1;return!0}function CV(e,n){n===void 0&&(n=NV);var t=null;function r(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];if(t&&t.lastThis===this&&n(a,t.lastArgs))return t.lastResult;var l=e.apply(this,a);return t={lastResult:l,lastArgs:a,lastThis:this},l}return r.clear=function(){t=null},r}var _V={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},jV=function(n){return Pt("span",Ut({css:_V},n))},i_=jV,kV={guidance:function(n){var t=n.isSearchable,r=n.isMulti,a=n.tabSelectsValue,o=n.context,l=n.isInitialFocus;switch(o){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(a?", press Tab to select the option and exit the menu":"",".");case"input":return l?"".concat(n["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(r?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(n){var t=n.action,r=n.label,a=r===void 0?"":r,o=n.labels,l=n.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(a,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(o.length>1?"s":""," ").concat(o.join(","),", selected.");case"select-option":return l?"option ".concat(a," is disabled. Select another option."):"option ".concat(a,", selected.");default:return""}},onFocus:function(n){var t=n.context,r=n.focused,a=n.options,o=n.label,l=o===void 0?"":o,d=n.selectValue,f=n.isDisabled,u=n.isSelected,p=n.isAppleDevice,g=function(k,T){return k&&k.length?"".concat(k.indexOf(T)+1," of ").concat(k.length):""};if(t==="value"&&d)return"value ".concat(l," focused, ").concat(g(d,r),".");if(t==="menu"&&p){var b=f?" disabled":"",v="".concat(u?" selected":"").concat(b);return"".concat(l).concat(v,", ").concat(g(a,r),".")}return""},onFilter:function(n){var t=n.inputValue,r=n.resultsMessage;return"".concat(r).concat(t?" for search term "+t:"",".")}},TV=function(n){var t=n.ariaSelection,r=n.focusedOption,a=n.focusedValue,o=n.focusableOptions,l=n.isFocused,d=n.selectValue,f=n.selectProps,u=n.id,p=n.isAppleDevice,g=f.ariaLiveMessages,b=f.getOptionLabel,v=f.inputValue,S=f.isMulti,k=f.isOptionDisabled,T=f.isSearchable,A=f.menuIsOpen,M=f.options,R=f.screenReaderStatus,z=f.tabSelectsValue,F=f.isLoading,L=f["aria-label"],U=f["aria-live"],B=w.useMemo(function(){return Lt(Lt({},kV),g||{})},[g]),J=w.useMemo(function(){var Y="";if(t&&B.onChange){var V=t.option,ae=t.options,re=t.removedValue,le=t.removedValues,E=t.value,ce=function(se){return Array.isArray(se)?null:se},ue=re||V||ce(E),I=ue?b(ue):"",de=ae||le||void 0,fe=de?de.map(b):[],W=Lt({isDisabled:ue&&k(ue,d),label:I,labels:fe},t);Y=B.onChange(W)}return Y},[t,B,k,d,b]),D=w.useMemo(function(){var Y="",V=r||a,ae=!!(r&&d&&d.includes(r));if(V&&B.onFocus){var re={focused:V,label:b(V),isDisabled:k(V,d),isSelected:ae,options:o,context:V===r?"menu":"value",selectValue:d,isAppleDevice:p};Y=B.onFocus(re)}return Y},[r,a,b,k,B,o,d,p]),$=w.useMemo(function(){var Y="";if(A&&M.length&&!F&&B.onFilter){var V=R({count:o.length});Y=B.onFilter({inputValue:v,resultsMessage:V})}return Y},[o,v,A,B,M,R,F]),H=(t==null?void 0:t.action)==="initial-input-focus",te=w.useMemo(function(){var Y="";if(B.guidance){var V=a?"value":A?"menu":"input";Y=B.guidance({"aria-label":L,context:V,isDisabled:r&&k(r,d),isMulti:S,isSearchable:T,tabSelectsValue:z,isInitialFocus:H})}return Y},[L,r,a,S,k,T,A,B,d,z,H]),Q=Pt(w.Fragment,null,Pt("span",{id:"aria-selection"},J),Pt("span",{id:"aria-focused"},D),Pt("span",{id:"aria-results"},$),Pt("span",{id:"aria-guidance"},te));return Pt(w.Fragment,null,Pt(i_,{id:u},H&&Q),Pt(i_,{"aria-live":U,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},l&&!H&&Q))},EV=TV,P1=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],AV=new RegExp("["+P1.map(function(e){return e.letters}).join("")+"]","g"),NT={};for(var v0=0;v0<P1.length;v0++)for(var w0=P1[v0],S0=0;S0<w0.letters.length;S0++)NT[w0.letters[S0]]=w0.base;var CT=function(n){return n.replace(AV,function(t){return NT[t]})},PV=CV(CT),a_=function(n){return n.replace(/^\s+|\s+$/g,"")},DV=function(n){return"".concat(n.label," ").concat(n.value)},IV=function(n){return function(t,r){if(t.data.__isNew__)return!0;var a=Lt({ignoreCase:!0,ignoreAccents:!0,stringify:DV,trim:!0,matchFrom:"any"},n),o=a.ignoreCase,l=a.ignoreAccents,d=a.stringify,f=a.trim,u=a.matchFrom,p=f?a_(r):r,g=f?a_(d(t)):d(t);return o&&(p=p.toLowerCase(),g=g.toLowerCase()),l&&(p=PV(p),g=CT(g)),u==="start"?g.substr(0,p.length)===p:g.indexOf(p)>-1}},RV=["innerRef"];function MV(e){var n=e.innerRef,t=ec(e,RV),r=o7(t,"onExited","in","enter","exit","appear");return Pt("input",Ut({ref:n},r,{css:$w({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var OV=function(n){n.cancelable&&n.preventDefault(),n.stopPropagation()};function LV(e){var n=e.isEnabled,t=e.onBottomArrive,r=e.onBottomLeave,a=e.onTopArrive,o=e.onTopLeave,l=w.useRef(!1),d=w.useRef(!1),f=w.useRef(0),u=w.useRef(null),p=w.useCallback(function(T,A){if(u.current!==null){var M=u.current,R=M.scrollTop,z=M.scrollHeight,F=M.clientHeight,L=u.current,U=A>0,B=z-F-R,J=!1;B>A&&l.current&&(r&&r(T),l.current=!1),U&&d.current&&(o&&o(T),d.current=!1),U&&A>B?(t&&!l.current&&t(T),L.scrollTop=z,J=!0,l.current=!0):!U&&-A>R&&(a&&!d.current&&a(T),L.scrollTop=0,J=!0,d.current=!0),J&&OV(T)}},[t,r,a,o]),g=w.useCallback(function(T){p(T,T.deltaY)},[p]),b=w.useCallback(function(T){f.current=T.changedTouches[0].clientY},[]),v=w.useCallback(function(T){var A=f.current-T.changedTouches[0].clientY;p(T,A)},[p]),S=w.useCallback(function(T){if(T){var A=i7?{passive:!1}:!1;T.addEventListener("wheel",g,A),T.addEventListener("touchstart",b,A),T.addEventListener("touchmove",v,A)}},[v,b,g]),k=w.useCallback(function(T){T&&(T.removeEventListener("wheel",g,!1),T.removeEventListener("touchstart",b,!1),T.removeEventListener("touchmove",v,!1))},[v,b,g]);return w.useEffect(function(){if(n){var T=u.current;return S(T),function(){k(T)}}},[n,S,k]),function(T){u.current=T}}var s_=["boxSizing","height","overflow","paddingRight","position"],o_={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function l_(e){e.cancelable&&e.preventDefault()}function c_(e){e.stopPropagation()}function u_(){var e=this.scrollTop,n=this.scrollHeight,t=e+this.offsetHeight;e===0?this.scrollTop=1:t===n&&(this.scrollTop=e-1)}function d_(){return"ontouchstart"in window||navigator.maxTouchPoints}var f_=!!(typeof window<"u"&&window.document&&window.document.createElement),Pm=0,gh={capture:!1,passive:!1};function FV(e){var n=e.isEnabled,t=e.accountForScrollbars,r=t===void 0?!0:t,a=w.useRef({}),o=w.useRef(null),l=w.useCallback(function(f){if(f_){var u=document.body,p=u&&u.style;if(r&&s_.forEach(function(S){var k=p&&p[S];a.current[S]=k}),r&&Pm<1){var g=parseInt(a.current.paddingRight,10)||0,b=document.body?document.body.clientWidth:0,v=window.innerWidth-b+g||0;Object.keys(o_).forEach(function(S){var k=o_[S];p&&(p[S]=k)}),p&&(p.paddingRight="".concat(v,"px"))}u&&d_()&&(u.addEventListener("touchmove",l_,gh),f&&(f.addEventListener("touchstart",u_,gh),f.addEventListener("touchmove",c_,gh))),Pm+=1}},[r]),d=w.useCallback(function(f){if(f_){var u=document.body,p=u&&u.style;Pm=Math.max(Pm-1,0),r&&Pm<1&&s_.forEach(function(g){var b=a.current[g];p&&(p[g]=b)}),u&&d_()&&(u.removeEventListener("touchmove",l_,gh),f&&(f.removeEventListener("touchstart",u_,gh),f.removeEventListener("touchmove",c_,gh)))}},[r]);return w.useEffect(function(){if(n){var f=o.current;return l(f),function(){d(f)}}},[n,l,d]),function(f){o.current=f}}var $V=function(n){var t=n.target;return t.ownerDocument.activeElement&&t.ownerDocument.activeElement.blur()},zV={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function UV(e){var n=e.children,t=e.lockEnabled,r=e.captureEnabled,a=r===void 0?!0:r,o=e.onBottomArrive,l=e.onBottomLeave,d=e.onTopArrive,f=e.onTopLeave,u=LV({isEnabled:a,onBottomArrive:o,onBottomLeave:l,onTopArrive:d,onTopLeave:f}),p=FV({isEnabled:t}),g=function(v){u(v),p(v)};return Pt(w.Fragment,null,t&&Pt("div",{onClick:$V,css:zV}),n(g))}var BV={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},qV=function(n){var t=n.name,r=n.onFocus;return Pt("input",{required:!0,name:t,tabIndex:-1,"aria-hidden":"true",onFocus:r,css:BV,value:"",onChange:function(){}})},VV=qV;function Vw(e){var n;return typeof window<"u"&&window.navigator!=null?e.test(((n=window.navigator.userAgentData)===null||n===void 0?void 0:n.platform)||window.navigator.platform):!1}function HV(){return Vw(/^iPhone/i)}function _T(){return Vw(/^Mac/i)}function GV(){return Vw(/^iPad/i)||_T()&&navigator.maxTouchPoints>1}function YV(){return HV()||GV()}function WV(){return _T()||YV()}var QV=function(n){return n.label},JV=function(n){return n.label},KV=function(n){return n.value},XV=function(n){return!!n.isDisabled},ZV={clearIndicator:M7,container:C7,control:B7,dropdownIndicator:I7,group:G7,groupHeading:W7,indicatorsContainer:T7,indicatorSeparator:L7,input:X7,loadingIndicator:z7,loadingMessage:b7,menu:f7,menuList:g7,menuPortal:S7,multiValue:rV,multiValueLabel:iV,multiValueRemove:aV,noOptionsMessage:x7,option:dV,placeholder:pV,singleValue:yV,valueContainer:j7},eH={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},tH=4,jT=4,nH=38,rH=jT*2,iH={baseUnit:jT,controlHeight:nH,menuGutter:rH},N0={borderRadius:tH,colors:eH,spacing:iH},aH={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:t_(),captureMenuScroll:!t_(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:IV(),formatGroupLabel:QV,getOptionLabel:JV,getOptionValue:KV,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:XV,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!n7(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(n){var t=n.count;return"".concat(t," result").concat(t!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function h_(e,n,t,r){var a=ET(e,n,t),o=AT(e,n,t),l=TT(e,n),d=ub(e,n);return{type:"option",data:n,isDisabled:a,isSelected:o,label:l,value:d,index:r}}function Bx(e,n){return e.options.map(function(t,r){if("options"in t){var a=t.options.map(function(l,d){return h_(e,l,n,d)}).filter(function(l){return m_(e,l)});return a.length>0?{type:"group",data:t,options:a,index:r}:void 0}var o=h_(e,t,n,r);return m_(e,o)?o:void 0}).filter(a7)}function kT(e){return e.reduce(function(n,t){return t.type==="group"?n.push.apply(n,Rw(t.options.map(function(r){return r.data}))):n.push(t.data),n},[])}function p_(e,n){return e.reduce(function(t,r){return r.type==="group"?t.push.apply(t,Rw(r.options.map(function(a){return{data:a.data,id:"".concat(n,"-").concat(r.index,"-").concat(a.index)}}))):t.push({data:r.data,id:"".concat(n,"-").concat(r.index)}),t},[])}function sH(e,n){return kT(Bx(e,n))}function m_(e,n){var t=e.inputValue,r=t===void 0?"":t,a=n.data,o=n.isSelected,l=n.label,d=n.value;return(!DT(e)||!o)&&PT(e,{label:l,value:d,data:a},r)}function oH(e,n){var t=e.focusedValue,r=e.selectValue,a=r.indexOf(t);if(a>-1){var o=n.indexOf(t);if(o>-1)return t;if(a<n.length)return n[a]}return null}function lH(e,n){var t=e.focusedOption;return t&&n.indexOf(t)>-1?t:n[0]}var C0=function(n,t){var r,a=(r=n.find(function(o){return o.data===t}))===null||r===void 0?void 0:r.id;return a||null},TT=function(n,t){return n.getOptionLabel(t)},ub=function(n,t){return n.getOptionValue(t)};function ET(e,n,t){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(n,t):!1}function AT(e,n,t){if(t.indexOf(n)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(n,t);var r=ub(e,n);return t.some(function(a){return ub(e,a)===r})}function PT(e,n,t){return e.filterOption?e.filterOption(n,t):!0}var DT=function(n){var t=n.hideSelectedOptions,r=n.isMulti;return t===void 0?r:t},cH=1,IT=function(e){E9(t,e);var n=D9(t);function t(r){var a;if(k9(this,t),a=n.call(this,r),a.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},a.blockOptionHover=!1,a.isComposing=!1,a.commonProps=void 0,a.initialTouchX=0,a.initialTouchY=0,a.openAfterFocus=!1,a.scrollToFocusedOptionOnUpdate=!1,a.userIsDragging=void 0,a.controlRef=null,a.getControlRef=function(f){a.controlRef=f},a.focusedOptionRef=null,a.getFocusedOptionRef=function(f){a.focusedOptionRef=f},a.menuListRef=null,a.getMenuListRef=function(f){a.menuListRef=f},a.inputRef=null,a.getInputRef=function(f){a.inputRef=f},a.focus=a.focusInput,a.blur=a.blurInput,a.onChange=function(f,u){var p=a.props,g=p.onChange,b=p.name;u.name=b,a.ariaOnChange(f,u),g(f,u)},a.setValue=function(f,u,p){var g=a.props,b=g.closeMenuOnSelect,v=g.isMulti,S=g.inputValue;a.onInputChange("",{action:"set-value",prevInputValue:S}),b&&(a.setState({inputIsHiddenAfterUpdate:!v}),a.onMenuClose()),a.setState({clearFocusValueOnUpdate:!0}),a.onChange(f,{action:u,option:p})},a.selectOption=function(f){var u=a.props,p=u.blurInputOnSelect,g=u.isMulti,b=u.name,v=a.state.selectValue,S=g&&a.isOptionSelected(f,v),k=a.isOptionDisabled(f,v);if(S){var T=a.getOptionValue(f);a.setValue(v.filter(function(A){return a.getOptionValue(A)!==T}),"deselect-option",f)}else if(!k)g?a.setValue([].concat(Rw(v),[f]),"select-option",f):a.setValue(f,"select-option");else{a.ariaOnChange(f,{action:"select-option",option:f,name:b});return}p&&a.blurInput()},a.removeValue=function(f){var u=a.props.isMulti,p=a.state.selectValue,g=a.getOptionValue(f),b=p.filter(function(S){return a.getOptionValue(S)!==g}),v=Cx(u,b,b[0]||null);a.onChange(v,{action:"remove-value",removedValue:f}),a.focusInput()},a.clearValue=function(){var f=a.state.selectValue;a.onChange(Cx(a.props.isMulti,[],null),{action:"clear",removedValues:f})},a.popValue=function(){var f=a.props.isMulti,u=a.state.selectValue,p=u[u.length-1],g=u.slice(0,u.length-1),b=Cx(f,g,g[0]||null);p&&a.onChange(b,{action:"pop-value",removedValue:p})},a.getFocusedOptionId=function(f){return C0(a.state.focusableOptionsWithIds,f)},a.getFocusableOptionsWithIds=function(){return p_(Bx(a.props,a.state.selectValue),a.getElementId("option"))},a.getValue=function(){return a.state.selectValue},a.cx=function(){for(var f=arguments.length,u=new Array(f),p=0;p<f;p++)u[p]=arguments[p];return Kq.apply(void 0,[a.props.classNamePrefix].concat(u))},a.getOptionLabel=function(f){return TT(a.props,f)},a.getOptionValue=function(f){return ub(a.props,f)},a.getStyles=function(f,u){var p=a.props.unstyled,g=ZV[f](u,p);g.boxSizing="border-box";var b=a.props.styles[f];return b?b(g,u):g},a.getClassNames=function(f,u){var p,g;return(p=(g=a.props.classNames)[f])===null||p===void 0?void 0:p.call(g,u)},a.getElementId=function(f){return"".concat(a.state.instancePrefix,"-").concat(f)},a.getComponents=function(){return wV(a.props)},a.buildCategorizedOptions=function(){return Bx(a.props,a.state.selectValue)},a.getCategorizedOptions=function(){return a.props.menuIsOpen?a.buildCategorizedOptions():[]},a.buildFocusableOptions=function(){return kT(a.buildCategorizedOptions())},a.getFocusableOptions=function(){return a.props.menuIsOpen?a.buildFocusableOptions():[]},a.ariaOnChange=function(f,u){a.setState({ariaSelection:Lt({value:f},u)})},a.onMenuMouseDown=function(f){f.button===0&&(f.stopPropagation(),f.preventDefault(),a.focusInput())},a.onMenuMouseMove=function(f){a.blockOptionHover=!1},a.onControlMouseDown=function(f){if(!f.defaultPrevented){var u=a.props.openMenuOnClick;a.state.isFocused?a.props.menuIsOpen?f.target.tagName!=="INPUT"&&f.target.tagName!=="TEXTAREA"&&a.onMenuClose():u&&a.openMenu("first"):(u&&(a.openAfterFocus=!0),a.focusInput()),f.target.tagName!=="INPUT"&&f.target.tagName!=="TEXTAREA"&&f.preventDefault()}},a.onDropdownIndicatorMouseDown=function(f){if(!(f&&f.type==="mousedown"&&f.button!==0)&&!a.props.isDisabled){var u=a.props,p=u.isMulti,g=u.menuIsOpen;a.focusInput(),g?(a.setState({inputIsHiddenAfterUpdate:!p}),a.onMenuClose()):a.openMenu("first"),f.preventDefault()}},a.onClearIndicatorMouseDown=function(f){f&&f.type==="mousedown"&&f.button!==0||(a.clearValue(),f.preventDefault(),a.openAfterFocus=!1,f.type==="touchend"?a.focusInput():setTimeout(function(){return a.focusInput()}))},a.onScroll=function(f){typeof a.props.closeMenuOnScroll=="boolean"?f.target instanceof HTMLElement&&Lb(f.target)&&a.props.onMenuClose():typeof a.props.closeMenuOnScroll=="function"&&a.props.closeMenuOnScroll(f)&&a.props.onMenuClose()},a.onCompositionStart=function(){a.isComposing=!0},a.onCompositionEnd=function(){a.isComposing=!1},a.onTouchStart=function(f){var u=f.touches,p=u&&u.item(0);p&&(a.initialTouchX=p.clientX,a.initialTouchY=p.clientY,a.userIsDragging=!1)},a.onTouchMove=function(f){var u=f.touches,p=u&&u.item(0);if(p){var g=Math.abs(p.clientX-a.initialTouchX),b=Math.abs(p.clientY-a.initialTouchY),v=5;a.userIsDragging=g>v||b>v}},a.onTouchEnd=function(f){a.userIsDragging||(a.controlRef&&!a.controlRef.contains(f.target)&&a.menuListRef&&!a.menuListRef.contains(f.target)&&a.blurInput(),a.initialTouchX=0,a.initialTouchY=0)},a.onControlTouchEnd=function(f){a.userIsDragging||a.onControlMouseDown(f)},a.onClearIndicatorTouchEnd=function(f){a.userIsDragging||a.onClearIndicatorMouseDown(f)},a.onDropdownIndicatorTouchEnd=function(f){a.userIsDragging||a.onDropdownIndicatorMouseDown(f)},a.handleInputChange=function(f){var u=a.props.inputValue,p=f.currentTarget.value;a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange(p,{action:"input-change",prevInputValue:u}),a.props.menuIsOpen||a.onMenuOpen()},a.onInputFocus=function(f){a.props.onFocus&&a.props.onFocus(f),a.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(a.openAfterFocus||a.props.openMenuOnFocus)&&a.openMenu("first"),a.openAfterFocus=!1},a.onInputBlur=function(f){var u=a.props.inputValue;if(a.menuListRef&&a.menuListRef.contains(document.activeElement)){a.inputRef.focus();return}a.props.onBlur&&a.props.onBlur(f),a.onInputChange("",{action:"input-blur",prevInputValue:u}),a.onMenuClose(),a.setState({focusedValue:null,isFocused:!1})},a.onOptionHover=function(f){if(!(a.blockOptionHover||a.state.focusedOption===f)){var u=a.getFocusableOptions(),p=u.indexOf(f);a.setState({focusedOption:f,focusedOptionId:p>-1?a.getFocusedOptionId(f):null})}},a.shouldHideSelectedOptions=function(){return DT(a.props)},a.onValueInputFocus=function(f){f.preventDefault(),f.stopPropagation(),a.focus()},a.onKeyDown=function(f){var u=a.props,p=u.isMulti,g=u.backspaceRemovesValue,b=u.escapeClearsValue,v=u.inputValue,S=u.isClearable,k=u.isDisabled,T=u.menuIsOpen,A=u.onKeyDown,M=u.tabSelectsValue,R=u.openMenuOnFocus,z=a.state,F=z.focusedOption,L=z.focusedValue,U=z.selectValue;if(!k&&!(typeof A=="function"&&(A(f),f.defaultPrevented))){switch(a.blockOptionHover=!0,f.key){case"ArrowLeft":if(!p||v)return;a.focusValue("previous");break;case"ArrowRight":if(!p||v)return;a.focusValue("next");break;case"Delete":case"Backspace":if(v)return;if(L)a.removeValue(L);else{if(!g)return;p?a.popValue():S&&a.clearValue()}break;case"Tab":if(a.isComposing||f.shiftKey||!T||!M||!F||R&&a.isOptionSelected(F,U))return;a.selectOption(F);break;case"Enter":if(f.keyCode===229)break;if(T){if(!F||a.isComposing)return;a.selectOption(F);break}return;case"Escape":T?(a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange("",{action:"menu-close",prevInputValue:v}),a.onMenuClose()):S&&b&&a.clearValue();break;case" ":if(v)return;if(!T){a.openMenu("first");break}if(!F)return;a.selectOption(F);break;case"ArrowUp":T?a.focusOption("up"):a.openMenu("last");break;case"ArrowDown":T?a.focusOption("down"):a.openMenu("first");break;case"PageUp":if(!T)return;a.focusOption("pageup");break;case"PageDown":if(!T)return;a.focusOption("pagedown");break;case"Home":if(!T)return;a.focusOption("first");break;case"End":if(!T)return;a.focusOption("last");break;default:return}f.preventDefault()}},a.state.instancePrefix="react-select-"+(a.props.instanceId||++cH),a.state.selectValue=ZC(r.value),r.menuIsOpen&&a.state.selectValue.length){var o=a.getFocusableOptionsWithIds(),l=a.buildFocusableOptions(),d=l.indexOf(a.state.selectValue[0]);a.state.focusableOptionsWithIds=o,a.state.focusedOption=l[d],a.state.focusedOptionId=C0(o,l[d])}return a}return T9(t,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&e_(this.menuListRef,this.focusedOptionRef),WV()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(a){var o=this.props,l=o.isDisabled,d=o.menuIsOpen,f=this.state.isFocused;(f&&!l&&a.isDisabled||f&&d&&!a.menuIsOpen)&&this.focusInput(),f&&l&&!a.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!f&&!l&&a.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(e_(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(a,o){this.props.onInputChange(a,o)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(a){var o=this,l=this.state,d=l.selectValue,f=l.isFocused,u=this.buildFocusableOptions(),p=a==="first"?0:u.length-1;if(!this.props.isMulti){var g=u.indexOf(d[0]);g>-1&&(p=g)}this.scrollToFocusedOptionOnUpdate=!(f&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:u[p],focusedOptionId:this.getFocusedOptionId(u[p])},function(){return o.onMenuOpen()})}},{key:"focusValue",value:function(a){var o=this.state,l=o.selectValue,d=o.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var f=l.indexOf(d);d||(f=-1);var u=l.length-1,p=-1;if(l.length){switch(a){case"previous":f===0?p=0:f===-1?p=u:p=f-1;break;case"next":f>-1&&f<u&&(p=f+1);break}this.setState({inputIsHidden:p!==-1,focusedValue:l[p]})}}}},{key:"focusOption",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",o=this.props.pageSize,l=this.state.focusedOption,d=this.getFocusableOptions();if(d.length){var f=0,u=d.indexOf(l);l||(u=-1),a==="up"?f=u>0?u-1:d.length-1:a==="down"?f=(u+1)%d.length:a==="pageup"?(f=u-o,f<0&&(f=0)):a==="pagedown"?(f=u+o,f>d.length-1&&(f=d.length-1)):a==="last"&&(f=d.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:d[f],focusedValue:null,focusedOptionId:this.getFocusedOptionId(d[f])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(N0):Lt(Lt({},N0),this.props.theme):N0}},{key:"getCommonProps",value:function(){var a=this.clearValue,o=this.cx,l=this.getStyles,d=this.getClassNames,f=this.getValue,u=this.selectOption,p=this.setValue,g=this.props,b=g.isMulti,v=g.isRtl,S=g.options,k=this.hasValue();return{clearValue:a,cx:o,getStyles:l,getClassNames:d,getValue:f,hasValue:k,isMulti:b,isRtl:v,options:S,selectOption:u,selectProps:g,setValue:p,theme:this.getTheme()}}},{key:"hasValue",value:function(){var a=this.state.selectValue;return a.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var a=this.props,o=a.isClearable,l=a.isMulti;return o===void 0?l:o}},{key:"isOptionDisabled",value:function(a,o){return ET(this.props,a,o)}},{key:"isOptionSelected",value:function(a,o){return AT(this.props,a,o)}},{key:"filterOption",value:function(a,o){return PT(this.props,a,o)}},{key:"formatOptionLabel",value:function(a,o){if(typeof this.props.formatOptionLabel=="function"){var l=this.props.inputValue,d=this.state.selectValue;return this.props.formatOptionLabel(a,{context:o,inputValue:l,selectValue:d})}else return this.getOptionLabel(a)}},{key:"formatGroupLabel",value:function(a){return this.props.formatGroupLabel(a)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var a=this.props,o=a.isDisabled,l=a.isSearchable,d=a.inputId,f=a.inputValue,u=a.tabIndex,p=a.form,g=a.menuIsOpen,b=a.required,v=this.getComponents(),S=v.Input,k=this.state,T=k.inputIsHidden,A=k.ariaSelection,M=this.commonProps,R=d||this.getElementId("input"),z=Lt(Lt(Lt({"aria-autocomplete":"list","aria-expanded":g,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":b,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},g&&{"aria-controls":this.getElementId("listbox")}),!l&&{"aria-readonly":!0}),this.hasValue()?(A==null?void 0:A.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return l?w.createElement(S,Ut({},M,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:R,innerRef:this.getInputRef,isDisabled:o,isHidden:T,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:u,form:p,type:"text",value:f},z)):w.createElement(MV,Ut({id:R,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:lb,onFocus:this.onInputFocus,disabled:o,tabIndex:u,inputMode:"none",form:p,value:""},z))}},{key:"renderPlaceholderOrValue",value:function(){var a=this,o=this.getComponents(),l=o.MultiValue,d=o.MultiValueContainer,f=o.MultiValueLabel,u=o.MultiValueRemove,p=o.SingleValue,g=o.Placeholder,b=this.commonProps,v=this.props,S=v.controlShouldRenderValue,k=v.isDisabled,T=v.isMulti,A=v.inputValue,M=v.placeholder,R=this.state,z=R.selectValue,F=R.focusedValue,L=R.isFocused;if(!this.hasValue()||!S)return A?null:w.createElement(g,Ut({},b,{key:"placeholder",isDisabled:k,isFocused:L,innerProps:{id:this.getElementId("placeholder")}}),M);if(T)return z.map(function(B,J){var D=B===F,$="".concat(a.getOptionLabel(B),"-").concat(a.getOptionValue(B));return w.createElement(l,Ut({},b,{components:{Container:d,Label:f,Remove:u},isFocused:D,isDisabled:k,key:$,index:J,removeProps:{onClick:function(){return a.removeValue(B)},onTouchEnd:function(){return a.removeValue(B)},onMouseDown:function(te){te.preventDefault()}},data:B}),a.formatOptionLabel(B,"value"))});if(A)return null;var U=z[0];return w.createElement(p,Ut({},b,{data:U,isDisabled:k}),this.formatOptionLabel(U,"value"))}},{key:"renderClearIndicator",value:function(){var a=this.getComponents(),o=a.ClearIndicator,l=this.commonProps,d=this.props,f=d.isDisabled,u=d.isLoading,p=this.state.isFocused;if(!this.isClearable()||!o||f||!this.hasValue()||u)return null;var g={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(o,Ut({},l,{innerProps:g,isFocused:p}))}},{key:"renderLoadingIndicator",value:function(){var a=this.getComponents(),o=a.LoadingIndicator,l=this.commonProps,d=this.props,f=d.isDisabled,u=d.isLoading,p=this.state.isFocused;if(!o||!u)return null;var g={"aria-hidden":"true"};return w.createElement(o,Ut({},l,{innerProps:g,isDisabled:f,isFocused:p}))}},{key:"renderIndicatorSeparator",value:function(){var a=this.getComponents(),o=a.DropdownIndicator,l=a.IndicatorSeparator;if(!o||!l)return null;var d=this.commonProps,f=this.props.isDisabled,u=this.state.isFocused;return w.createElement(l,Ut({},d,{isDisabled:f,isFocused:u}))}},{key:"renderDropdownIndicator",value:function(){var a=this.getComponents(),o=a.DropdownIndicator;if(!o)return null;var l=this.commonProps,d=this.props.isDisabled,f=this.state.isFocused,u={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(o,Ut({},l,{innerProps:u,isDisabled:d,isFocused:f}))}},{key:"renderMenu",value:function(){var a=this,o=this.getComponents(),l=o.Group,d=o.GroupHeading,f=o.Menu,u=o.MenuList,p=o.MenuPortal,g=o.LoadingMessage,b=o.NoOptionsMessage,v=o.Option,S=this.commonProps,k=this.state.focusedOption,T=this.props,A=T.captureMenuScroll,M=T.inputValue,R=T.isLoading,z=T.loadingMessage,F=T.minMenuHeight,L=T.maxMenuHeight,U=T.menuIsOpen,B=T.menuPlacement,J=T.menuPosition,D=T.menuPortalTarget,$=T.menuShouldBlockScroll,H=T.menuShouldScrollIntoView,te=T.noOptionsMessage,Q=T.onMenuScrollToTop,Y=T.onMenuScrollToBottom;if(!U)return null;var V=function(I,de){var fe=I.type,W=I.data,oe=I.isDisabled,se=I.isSelected,je=I.label,We=I.value,X=k===W,Se=oe?void 0:function(){return a.onOptionHover(W)},Ae=oe?void 0:function(){return a.selectOption(W)},Pe="".concat(a.getElementId("option"),"-").concat(de),Ze={id:Pe,onClick:Ae,onMouseMove:Se,onMouseOver:Se,tabIndex:-1,role:"option","aria-selected":a.state.isAppleDevice?void 0:se};return w.createElement(v,Ut({},S,{innerProps:Ze,data:W,isDisabled:oe,isSelected:se,key:Pe,label:je,type:fe,value:We,isFocused:X,innerRef:X?a.getFocusedOptionRef:void 0}),a.formatOptionLabel(I.data,"menu"))},ae;if(this.hasOptions())ae=this.getCategorizedOptions().map(function(ue){if(ue.type==="group"){var I=ue.data,de=ue.options,fe=ue.index,W="".concat(a.getElementId("group"),"-").concat(fe),oe="".concat(W,"-heading");return w.createElement(l,Ut({},S,{key:W,data:I,options:de,Heading:d,headingProps:{id:oe,data:ue.data},label:a.formatGroupLabel(ue.data)}),ue.options.map(function(se){return V(se,"".concat(fe,"-").concat(se.index))}))}else if(ue.type==="option")return V(ue,"".concat(ue.index))});else if(R){var re=z({inputValue:M});if(re===null)return null;ae=w.createElement(g,S,re)}else{var le=te({inputValue:M});if(le===null)return null;ae=w.createElement(b,S,le)}var E={minMenuHeight:F,maxMenuHeight:L,menuPlacement:B,menuPosition:J,menuShouldScrollIntoView:H},ce=w.createElement(h7,Ut({},S,E),function(ue){var I=ue.ref,de=ue.placerProps,fe=de.placement,W=de.maxHeight;return w.createElement(f,Ut({},S,E,{innerRef:I,innerProps:{onMouseDown:a.onMenuMouseDown,onMouseMove:a.onMenuMouseMove},isLoading:R,placement:fe}),w.createElement(UV,{captureEnabled:A,onTopArrive:Q,onBottomArrive:Y,lockEnabled:$},function(oe){return w.createElement(u,Ut({},S,{innerRef:function(je){a.getMenuListRef(je),oe(je)},innerProps:{role:"listbox","aria-multiselectable":S.isMulti,id:a.getElementId("listbox")},isLoading:R,maxHeight:W,focusedOption:k}),ae)}))});return D||J==="fixed"?w.createElement(p,Ut({},S,{appendTo:D,controlElement:this.controlRef,menuPlacement:B,menuPosition:J}),ce):ce}},{key:"renderFormField",value:function(){var a=this,o=this.props,l=o.delimiter,d=o.isDisabled,f=o.isMulti,u=o.name,p=o.required,g=this.state.selectValue;if(p&&!this.hasValue()&&!d)return w.createElement(VV,{name:u,onFocus:this.onValueInputFocus});if(!(!u||d))if(f)if(l){var b=g.map(function(k){return a.getOptionValue(k)}).join(l);return w.createElement("input",{name:u,type:"hidden",value:b})}else{var v=g.length>0?g.map(function(k,T){return w.createElement("input",{key:"i-".concat(T),name:u,type:"hidden",value:a.getOptionValue(k)})}):w.createElement("input",{name:u,type:"hidden",value:""});return w.createElement("div",null,v)}else{var S=g[0]?this.getOptionValue(g[0]):"";return w.createElement("input",{name:u,type:"hidden",value:S})}}},{key:"renderLiveRegion",value:function(){var a=this.commonProps,o=this.state,l=o.ariaSelection,d=o.focusedOption,f=o.focusedValue,u=o.isFocused,p=o.selectValue,g=this.getFocusableOptions();return w.createElement(EV,Ut({},a,{id:this.getElementId("live-region"),ariaSelection:l,focusedOption:d,focusedValue:f,isFocused:u,selectValue:p,focusableOptions:g,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var a=this.getComponents(),o=a.Control,l=a.IndicatorsContainer,d=a.SelectContainer,f=a.ValueContainer,u=this.props,p=u.className,g=u.id,b=u.isDisabled,v=u.menuIsOpen,S=this.state.isFocused,k=this.commonProps=this.getCommonProps();return w.createElement(d,Ut({},k,{className:p,innerProps:{id:g,onKeyDown:this.onKeyDown},isDisabled:b,isFocused:S}),this.renderLiveRegion(),w.createElement(o,Ut({},k,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:b,isFocused:S,menuIsOpen:v}),w.createElement(f,Ut({},k,{isDisabled:b}),this.renderPlaceholderOrValue(),this.renderInput()),w.createElement(l,Ut({},k,{isDisabled:b}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(a,o){var l=o.prevProps,d=o.clearFocusValueOnUpdate,f=o.inputIsHiddenAfterUpdate,u=o.ariaSelection,p=o.isFocused,g=o.prevWasFocused,b=o.instancePrefix,v=a.options,S=a.value,k=a.menuIsOpen,T=a.inputValue,A=a.isMulti,M=ZC(S),R={};if(l&&(S!==l.value||v!==l.options||k!==l.menuIsOpen||T!==l.inputValue)){var z=k?sH(a,M):[],F=k?p_(Bx(a,M),"".concat(b,"-option")):[],L=d?oH(o,M):null,U=lH(o,z),B=C0(F,U);R={selectValue:M,focusedOption:U,focusedOptionId:B,focusableOptionsWithIds:F,focusedValue:L,clearFocusValueOnUpdate:!1}}var J=f!=null&&a!==l?{inputIsHidden:f,inputIsHiddenAfterUpdate:void 0}:{},D=u,$=p&&g;return p&&!$&&(D={value:Cx(A,M,M[0]||null),options:M,action:"initial-input-focus"},$=!g),(u==null?void 0:u.action)==="initial-input-focus"&&(D=null),Lt(Lt(Lt({},R),J),{},{prevProps:a,ariaSelection:D,prevWasFocused:$})}}]),t}(w.Component);IT.defaultProps=aH;var uH=w.forwardRef(function(e,n){var t=j9(e);return w.createElement(IT,Ut({ref:n},t))}),RT=uH;const yh=new Map,MT=(()=>{const e=new Promise(n=>{window.addEventListener("pointerdown",n,{once:!0}),window.addEventListener("keydown",n,{once:!0})});return async n=>{try{const t=new Audio;if(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",await t.play(),n!=null&&n.id&&yh.has(n.id)){const a=yh.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&yh.set(n.id,r),r}catch{if(await e,n!=null&&n.id&&yh.has(n.id)){const a=yh.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&yh.set(n.id,r),r}}})();function dH(e){var n=atob(e),t=new Uint8Array(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t.buffer}const fH=`
class AudioProcessingWorklet extends AudioWorkletProcessor {

  // send and clear buffer every 2048 samples, 
  // which at 16khz is about 8 times a second
  buffer = new Int16Array(2048);

  // current write index
  bufferWriteIndex = 0;

  constructor() {
    super();
    this.hasAudio = false;
  }

  /**
   * @param inputs Float32Array[][] [input#][channel#][sample#] so to access first inputs 1st channel inputs[0][0]
   * @param outputs Float32Array[][]
   */
  process(inputs) {
    if (inputs[0].length) {
      const channel0 = inputs[0][0];
      this.processChunk(channel0);
    }
    return true;
  }

  sendAndClearBuffer(){
    this.port.postMessage({
      event: "chunk",
      data: {
        int16arrayBuffer: this.buffer.slice(0, this.bufferWriteIndex).buffer,
      },
    });
    this.bufferWriteIndex = 0;
  }

  processChunk(float32Array) {
    const l = float32Array.length;
    
    for (let i = 0; i < l; i++) {
      // convert float32 -1 to 1 to int16 -32768 to 32767
      const int16Value = float32Array[i] * 32768;
      this.buffer[this.bufferWriteIndex++] = int16Value;
      if(this.bufferWriteIndex >= this.buffer.length) {
        this.sendAndClearBuffer();
      }
    }

    if(this.bufferWriteIndex >= this.buffer.length) {
      this.sendAndClearBuffer();
    }
  }
}
`,OT=`
  class VolMeter extends AudioWorkletProcessor {
    volume
    updateIntervalInMS
    nextUpdateFrame

    constructor() {
      super()
      this.volume = 0
      this.updateIntervalInMS = 25
      this.nextUpdateFrame = this.updateIntervalInMS
      this.port.onmessage = event => {
        if (event.data.updateIntervalInMS) {
          this.updateIntervalInMS = event.data.updateIntervalInMS
        }
      }
    }

    get intervalInFrames() {
      return (this.updateIntervalInMS / 1000) * sampleRate
    }

    process(inputs) {
      const input = inputs[0]

      if (input.length > 0) {
        const samples = input[0]
        let sum = 0
        let rms = 0

        for (let i = 0; i < samples.length; ++i) {
          sum += samples[i] * samples[i]
        }

        rms = Math.sqrt(sum / samples.length)
        this.volume = Math.max(rms, this.volume * 0.7)

        this.nextUpdateFrame -= samples.length
        if (this.nextUpdateFrame < 0) {
          this.nextUpdateFrame += this.intervalInFrames
          this.port.postMessage({volume: this.volume})
        }
      }

      return true
    }
  }`,_x=new Map,D1=(e,n)=>{const t=new Blob([`registerProcessor("${e}", ${n})`],{type:"application/javascript"});return URL.createObjectURL(t)};var _0={exports:{}},g_;function hH(){return g_||(g_=1,function(e){var n=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function a(f,u,p){this.fn=f,this.context=u,this.once=p||!1}function o(f,u,p,g,b){if(typeof p!="function")throw new TypeError("The listener must be a function");var v=new a(p,g||f,b),S=t?t+u:u;return f._events[S]?f._events[S].fn?f._events[S]=[f._events[S],v]:f._events[S].push(v):(f._events[S]=v,f._eventsCount++),f}function l(f,u){--f._eventsCount===0?f._events=new r:delete f._events[u]}function d(){this._events=new r,this._eventsCount=0}d.prototype.eventNames=function(){var u=[],p,g;if(this._eventsCount===0)return u;for(g in p=this._events)n.call(p,g)&&u.push(t?g.slice(1):g);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(p)):u},d.prototype.listeners=function(u){var p=t?t+u:u,g=this._events[p];if(!g)return[];if(g.fn)return[g.fn];for(var b=0,v=g.length,S=new Array(v);b<v;b++)S[b]=g[b].fn;return S},d.prototype.listenerCount=function(u){var p=t?t+u:u,g=this._events[p];return g?g.fn?1:g.length:0},d.prototype.emit=function(u,p,g,b,v,S){var k=t?t+u:u;if(!this._events[k])return!1;var T=this._events[k],A=arguments.length,M,R;if(T.fn){switch(T.once&&this.removeListener(u,T.fn,void 0,!0),A){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,p),!0;case 3:return T.fn.call(T.context,p,g),!0;case 4:return T.fn.call(T.context,p,g,b),!0;case 5:return T.fn.call(T.context,p,g,b,v),!0;case 6:return T.fn.call(T.context,p,g,b,v,S),!0}for(R=1,M=new Array(A-1);R<A;R++)M[R-1]=arguments[R];T.fn.apply(T.context,M)}else{var z=T.length,F;for(R=0;R<z;R++)switch(T[R].once&&this.removeListener(u,T[R].fn,void 0,!0),A){case 1:T[R].fn.call(T[R].context);break;case 2:T[R].fn.call(T[R].context,p);break;case 3:T[R].fn.call(T[R].context,p,g);break;case 4:T[R].fn.call(T[R].context,p,g,b);break;default:if(!M)for(F=1,M=new Array(A-1);F<A;F++)M[F-1]=arguments[F];T[R].fn.apply(T[R].context,M)}}return!0},d.prototype.on=function(u,p,g){return o(this,u,p,g,!1)},d.prototype.once=function(u,p,g){return o(this,u,p,g,!0)},d.prototype.removeListener=function(u,p,g,b){var v=t?t+u:u;if(!this._events[v])return this;if(!p)return l(this,v),this;var S=this._events[v];if(S.fn)S.fn===p&&(!b||S.once)&&(!g||S.context===g)&&l(this,v);else{for(var k=0,T=[],A=S.length;k<A;k++)(S[k].fn!==p||b&&!S[k].once||g&&S[k].context!==g)&&T.push(S[k]);T.length?this._events[v]=T.length===1?T[0]:T:l(this,v)}return this},d.prototype.removeAllListeners=function(u){var p;return u?(p=t?t+u:u,this._events[p]&&l(this,p)):(this._events=new r,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=t,d.EventEmitter=d,e.exports=d}(_0)),_0.exports}var pH=hH();const LT=qd(pH);function mH(e){for(var n="",t=new Uint8Array(e),r=t.byteLength,a=0;a<r;a++)n+=String.fromCharCode(t[a]);return window.btoa(n)}class FT extends LT{constructor(t=16e3){super();Qn(this,"stream");Qn(this,"audioContext");Qn(this,"source");Qn(this,"recording",!1);Qn(this,"recordingWorklet");Qn(this,"vuWorklet");Qn(this,"starting",null);this.sampleRate=t}async start(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Could not request user media");this.starting=new Promise(async t=>{this.stream=await navigator.mediaDevices.getUserMedia({audio:!0}),this.audioContext=await MT({sampleRate:this.sampleRate}),this.source=this.audioContext.createMediaStreamSource(this.stream);const r="audio-recorder-worklet",a=D1(r,fH);await this.audioContext.audioWorklet.addModule(a),this.recordingWorklet=new AudioWorkletNode(this.audioContext,r),this.recordingWorklet.port.onmessage=async l=>{const d=l.data.data.int16arrayBuffer;if(d){const f=mH(d);this.emit("data",f)}},this.source.connect(this.recordingWorklet);const o="vu-meter";await this.audioContext.audioWorklet.addModule(D1(o,OT)),this.vuWorklet=new AudioWorkletNode(this.audioContext,o),this.vuWorklet.port.onmessage=l=>{this.emit("volume",l.data.volume)},this.source.connect(this.vuWorklet),this.recording=!0,t(),this.starting=null})}stop(){const t=()=>{var r,a;(r=this.source)==null||r.disconnect(),(a=this.stream)==null||a.getTracks().forEach(o=>o.stop()),this.stream=void 0,this.recordingWorklet=void 0,this.vuWorklet=void 0,this.audioContext&&(this.audioContext.close(),this.audioContext=void 0)};if(this.starting){this.starting.then(t);return}t()}}const gH=3,yH=({active:e,volume:n,hover:t})=>{const r=w.useRef([]);return w.useEffect(()=>{let a=null;const o=()=>{r.current.forEach((l,d)=>{l&&(l.style.height=`${Math.min(24,4+n*(d===1?400:60))}px`)}),a=window.setTimeout(o,100)};return o(),()=>clearTimeout(a)},[n]),i.jsx("div",{className:cu("audioPulse",{active:e,hover:t}),children:Array(gH).fill(null).map((a,o)=>i.jsx("div",{ref:l=>{r.current[o]=l},style:{animationDelay:`${o*133}ms`}},o))})};var $m={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var xH=$m.exports,y_;function bH(){return y_||(y_=1,function(e,n){(function(){var t,r="4.17.21",a=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",d="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",u=500,p="__lodash_placeholder__",g=1,b=2,v=4,S=1,k=2,T=1,A=2,M=4,R=8,z=16,F=32,L=64,U=128,B=256,J=512,D=30,$="...",H=800,te=16,Q=1,Y=2,V=3,ae=1/0,re=9007199254740991,le=17976931348623157e292,E=NaN,ce=4294967295,ue=ce-1,I=ce>>>1,de=[["ary",U],["bind",T],["bindKey",A],["curry",R],["curryRight",z],["flip",J],["partial",F],["partialRight",L],["rearg",B]],fe="[object Arguments]",W="[object Array]",oe="[object AsyncFunction]",se="[object Boolean]",je="[object Date]",We="[object DOMException]",X="[object Error]",Se="[object Function]",Ae="[object GeneratorFunction]",Pe="[object Map]",Ze="[object Number]",rt="[object Null]",lt="[object Object]",ze="[object Promise]",ot="[object Proxy]",at="[object RegExp]",be="[object Set]",$e="[object String]",Be="[object Symbol]",ke="[object Undefined]",Ne="[object WeakMap]",K="[object WeakSet]",ge="[object ArrayBuffer]",He="[object DataView]",Qe="[object Float32Array]",dt="[object Float64Array]",At="[object Int8Array]",Ht="[object Int16Array]",we="[object Int32Array]",xe="[object Uint8Array]",Me="[object Uint8ClampedArray]",De="[object Uint16Array]",qe="[object Uint32Array]",st=/\b__p \+= '';/g,yt=/\b(__p \+=) '' \+/g,_t=/(__e\(.*?\)|\b__t\)) \+\n'';/g,cn=/&(?:amp|lt|gt|quot|#39);/g,gn=/[&<>"']/g,Cn=RegExp(cn.source),wt=RegExp(gn.source),bt=/<%-([\s\S]+?)%>/g,Ft=/<%([\s\S]+?)%>/g,St=/<%=([\s\S]+?)%>/g,Jn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Yi=/^\w*$/,vr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,yn=/[\\^$.*+?()[\]{}|]/g,wr=RegExp(yn.source),Ei=/^\s+/,bu=/\s/,vu=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Jh=/\{\n\/\* \[wrapped with (.+)\] \*/,nl=/,? & /,Xs=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,tc=/[()=,{}\[\]\/\s]/,ms=/\\(\\)?/g,Zs=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,eo=/\w*$/,to=/^[-+]0x[0-9a-f]+$/i,gr=/^0b[01]+$/i,Yd=/^\[object .+?Constructor\]$/,Wd=/^0o[0-7]+$/i,gs=/^(?:0|[1-9]\d*)$/,no=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,nc=/($^)/,Qd=/['\n\r\u2028\u2029\\]/g,ys="\\ud800-\\udfff",Wi="\\u0300-\\u036f",za="\\ufe20-\\ufe2f",rl="\\u20d0-\\u20ff",Ai=Wi+za+rl,il="\\u2700-\\u27bf",al="a-z\\xdf-\\xf6\\xf8-\\xff",Ua="\\xac\\xb1\\xd7\\xf7",rc="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ic="\\u2000-\\u206f",ac=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",wu="A-Z\\xc0-\\xd6\\xd8-\\xde",Jr="\\ufe0e\\ufe0f",sc=Ua+rc+ic+ac,oc="[']",sl="["+ys+"]",ro="["+sc+"]",Ba="["+Ai+"]",lc="\\d+",Kr="["+il+"]",io="["+al+"]",cc="[^"+ys+sc+lc+il+al+wu+"]",xs="\\ud83c[\\udffb-\\udfff]",bs="(?:"+Ba+"|"+xs+")",ol="[^"+ys+"]",ll="(?:\\ud83c[\\udde6-\\uddff]){2}",Pi="[\\ud800-\\udbff][\\udc00-\\udfff]",Qi="["+wu+"]",ao="\\u200d",uc="(?:"+io+"|"+cc+")",so="(?:"+Qi+"|"+cc+")",Jd="(?:"+oc+"(?:d|ll|m|re|s|t|ve))?",dc="(?:"+oc+"(?:D|LL|M|RE|S|T|VE))?",vs=bs+"?",oo="["+Jr+"]?",cl="(?:"+ao+"(?:"+[ol,ll,Pi].join("|")+")"+oo+vs+")*",qa="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Va="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ul=oo+vs+cl,dl="(?:"+[Kr,ll,Pi].join("|")+")"+ul,fc="(?:"+[ol+Ba+"?",Ba,ll,Pi,sl].join("|")+")",Xr=RegExp(oc,"g"),Di=RegExp(Ba,"g"),lo=RegExp(xs+"(?="+xs+")|"+fc+ul,"g"),Ii=RegExp([Qi+"?"+io+"+"+Jd+"(?="+[ro,Qi,"$"].join("|")+")",so+"+"+dc+"(?="+[ro,Qi+uc,"$"].join("|")+")",Qi+"?"+uc+"+"+Jd,Qi+"+"+dc,Va,qa,lc,dl].join("|"),"g"),Ha=RegExp("["+ao+ys+Ai+Jr+"]"),fl=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,hc=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],pc=-1,xn={};xn[Qe]=xn[dt]=xn[At]=xn[Ht]=xn[we]=xn[xe]=xn[Me]=xn[De]=xn[qe]=!0,xn[fe]=xn[W]=xn[ge]=xn[se]=xn[He]=xn[je]=xn[X]=xn[Se]=xn[Pe]=xn[Ze]=xn[lt]=xn[at]=xn[be]=xn[$e]=xn[Ne]=!1;var kn={};kn[fe]=kn[W]=kn[ge]=kn[He]=kn[se]=kn[je]=kn[Qe]=kn[dt]=kn[At]=kn[Ht]=kn[we]=kn[Pe]=kn[Ze]=kn[lt]=kn[at]=kn[be]=kn[$e]=kn[Be]=kn[xe]=kn[Me]=kn[De]=kn[qe]=!0,kn[X]=kn[Se]=kn[Ne]=!1;var hl={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},$r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},xa={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pl={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},co=parseFloat,Kd=parseInt,uo=typeof lu=="object"&&lu&&lu.Object===Object&&lu,mc=typeof self=="object"&&self&&self.Object===Object&&self,Hn=uo||mc||Function("return this")(),ba=n&&!n.nodeType&&n,Ga=ba&&!0&&e&&!e.nodeType&&e,gc=Ga&&Ga.exports===ba,ml=gc&&uo.process,Zr=function(){try{var Ee=Ga&&Ga.require&&Ga.require("util").types;return Ee||ml&&ml.binding&&ml.binding("util")}catch{}}(),wn=Zr&&Zr.isArrayBuffer,yc=Zr&&Zr.isDate,gl=Zr&&Zr.isMap,xc=Zr&&Zr.isRegExp,fo=Zr&&Zr.isSet,ho=Zr&&Zr.isTypedArray;function Vr(Ee,Ye,Ve){switch(Ve.length){case 0:return Ee.call(Ye);case 1:return Ee.call(Ye,Ve[0]);case 2:return Ee.call(Ye,Ve[0],Ve[1]);case 3:return Ee.call(Ye,Ve[0],Ve[1],Ve[2])}return Ee.apply(Ye,Ve)}function Xd(Ee,Ye,Ve,pt){for(var Dt=-1,un=Ee==null?0:Ee.length;++Dt<un;){var cr=Ee[Dt];Ye(pt,cr,Ve(cr),Ee)}return pt}function Sr(Ee,Ye){for(var Ve=-1,pt=Ee==null?0:Ee.length;++Ve<pt&&Ye(Ee[Ve],Ve,Ee)!==!1;);return Ee}function Zd(Ee,Ye){for(var Ve=Ee==null?0:Ee.length;Ve--&&Ye(Ee[Ve],Ve,Ee)!==!1;);return Ee}function bc(Ee,Ye){for(var Ve=-1,pt=Ee==null?0:Ee.length;++Ve<pt;)if(!Ye(Ee[Ve],Ve,Ee))return!1;return!0}function ei(Ee,Ye){for(var Ve=-1,pt=Ee==null?0:Ee.length,Dt=0,un=[];++Ve<pt;){var cr=Ee[Ve];Ye(cr,Ve,Ee)&&(un[Dt++]=cr)}return un}function va(Ee,Ye){var Ve=Ee==null?0:Ee.length;return!!Ve&&mo(Ee,Ye,0)>-1}function vc(Ee,Ye,Ve){for(var pt=-1,Dt=Ee==null?0:Ee.length;++pt<Dt;)if(Ve(Ye,Ee[pt]))return!0;return!1}function Gn(Ee,Ye){for(var Ve=-1,pt=Ee==null?0:Ee.length,Dt=Array(pt);++Ve<pt;)Dt[Ve]=Ye(Ee[Ve],Ve,Ee);return Dt}function Ji(Ee,Ye){for(var Ve=-1,pt=Ye.length,Dt=Ee.length;++Ve<pt;)Ee[Dt+Ve]=Ye[Ve];return Ee}function ws(Ee,Ye,Ve,pt){var Dt=-1,un=Ee==null?0:Ee.length;for(pt&&un&&(Ve=Ee[++Dt]);++Dt<un;)Ve=Ye(Ve,Ee[Dt],Dt,Ee);return Ve}function Kh(Ee,Ye,Ve,pt){var Dt=Ee==null?0:Ee.length;for(pt&&Dt&&(Ve=Ee[--Dt]);Dt--;)Ve=Ye(Ve,Ee[Dt],Dt,Ee);return Ve}function Ya(Ee,Ye){for(var Ve=-1,pt=Ee==null?0:Ee.length;++Ve<pt;)if(Ye(Ee[Ve],Ve,Ee))return!0;return!1}var Xh=bl("length");function ef(Ee){return Ee.split("")}function po(Ee){return Ee.match(Xs)||[]}function Ss(Ee,Ye,Ve){var pt;return Ve(Ee,function(Dt,un,cr){if(Ye(Dt,un,cr))return pt=un,!1}),pt}function Wa(Ee,Ye,Ve,pt){for(var Dt=Ee.length,un=Ve+(pt?1:-1);pt?un--:++un<Dt;)if(Ye(Ee[un],un,Ee))return un;return-1}function mo(Ee,Ye,Ve){return Ye===Ye?tp(Ee,Ye,Ve):Wa(Ee,Ns,Ve)}function yl(Ee,Ye,Ve,pt){for(var Dt=Ve-1,un=Ee.length;++Dt<un;)if(pt(Ee[Dt],Ye))return Dt;return-1}function Ns(Ee){return Ee!==Ee}function xl(Ee,Ye){var Ve=Ee==null?0:Ee.length;return Ve?Sc(Ee,Ye)/Ve:E}function bl(Ee){return function(Ye){return Ye==null?t:Ye[Ee]}}function wc(Ee){return function(Ye){return Ee==null?t:Ee[Ye]}}function Su(Ee,Ye,Ve,pt,Dt){return Dt(Ee,function(un,cr,dn){Ve=pt?(pt=!1,un):Ye(Ve,un,cr,dn)}),Ve}function tf(Ee,Ye){var Ve=Ee.length;for(Ee.sort(Ye);Ve--;)Ee[Ve]=Ee[Ve].value;return Ee}function Sc(Ee,Ye){for(var Ve,pt=-1,Dt=Ee.length;++pt<Dt;){var un=Ye(Ee[pt]);un!==t&&(Ve=Ve===t?un:Ve+un)}return Ve}function Qa(Ee,Ye){for(var Ve=-1,pt=Array(Ee);++Ve<Ee;)pt[Ve]=Ye(Ve);return pt}function Zh(Ee,Ye){return Gn(Ye,function(Ve){return[Ve,Ee[Ve]]})}function nf(Ee){return Ee&&Ee.slice(0,ju(Ee)+1).replace(Ei,"")}function ti(Ee){return function(Ye){return Ee(Ye)}}function vl(Ee,Ye){return Gn(Ye,function(Ve){return Ee[Ve]})}function go(Ee,Ye){return Ee.has(Ye)}function wa(Ee,Ye){for(var Ve=-1,pt=Ee.length;++Ve<pt&&mo(Ye,Ee[Ve],0)>-1;);return Ve}function yo(Ee,Ye){for(var Ve=Ee.length;Ve--&&mo(Ye,Ee[Ve],0)>-1;);return Ve}function Ja(Ee,Ye){for(var Ve=Ee.length,pt=0;Ve--;)Ee[Ve]===Ye&&++pt;return pt}var Ri=wc(hl),Ki=wc($r);function Nu(Ee){return"\\"+pl[Ee]}function Nc(Ee,Ye){return Ee==null?t:Ee[Ye]}function Sa(Ee){return Ha.test(Ee)}function Cu(Ee){return fl.test(Ee)}function xo(Ee){for(var Ye,Ve=[];!(Ye=Ee.next()).done;)Ve.push(Ye.value);return Ve}function wl(Ee){var Ye=-1,Ve=Array(Ee.size);return Ee.forEach(function(pt,Dt){Ve[++Ye]=[Dt,pt]}),Ve}function _u(Ee,Ye){return function(Ve){return Ee(Ye(Ve))}}function Ka(Ee,Ye){for(var Ve=-1,pt=Ee.length,Dt=0,un=[];++Ve<pt;){var cr=Ee[Ve];(cr===Ye||cr===p)&&(Ee[Ve]=p,un[Dt++]=Ve)}return un}function Sl(Ee){var Ye=-1,Ve=Array(Ee.size);return Ee.forEach(function(pt){Ve[++Ye]=pt}),Ve}function ep(Ee){var Ye=-1,Ve=Array(Ee.size);return Ee.forEach(function(pt){Ve[++Ye]=[pt,pt]}),Ve}function tp(Ee,Ye,Ve){for(var pt=Ve-1,Dt=Ee.length;++pt<Dt;)if(Ee[pt]===Ye)return pt;return-1}function ni(Ee,Ye,Ve){for(var pt=Ve+1;pt--;)if(Ee[pt]===Ye)return pt;return pt}function Xi(Ee){return Sa(Ee)?rf(Ee):Xh(Ee)}function ui(Ee){return Sa(Ee)?Nl(Ee):ef(Ee)}function ju(Ee){for(var Ye=Ee.length;Ye--&&bu.test(Ee.charAt(Ye)););return Ye}var Cs=wc(xa);function rf(Ee){for(var Ye=lo.lastIndex=0;lo.test(Ee);)++Ye;return Ye}function Nl(Ee){return Ee.match(lo)||[]}function np(Ee){return Ee.match(Ii)||[]}var Xa=function Ee(Ye){Ye=Ye==null?Hn:Za.defaults(Hn.Object(),Ye,Za.pick(Hn,hc));var Ve=Ye.Array,pt=Ye.Date,Dt=Ye.Error,un=Ye.Function,cr=Ye.Math,dn=Ye.Object,Cc=Ye.RegExp,af=Ye.String,ri=Ye.TypeError,_c=Ve.prototype,rp=un.prototype,_s=dn.prototype,bo=Ye["__core-js_shared__"],vo=rp.toString,ne=_s.hasOwnProperty,me=0,he=function(){var m=/[^.]+$/.exec(bo&&bo.keys&&bo.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),Ce=_s.toString,Je=vo.call(dn),ht=Hn._,jt=Cc("^"+vo.call(ne).replace(yn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ct=gc?Ye.Buffer:t,Yn=Ye.Symbol,Hr=Ye.Uint8Array,js=Ct?Ct.allocUnsafe:t,ku=_u(dn.getPrototypeOf,dn),Tu=dn.create,Cl=_s.propertyIsEnumerable,sf=_c.splice,di=Yn?Yn.isConcatSpreadable:t,_l=Yn?Yn.iterator:t,ii=Yn?Yn.toStringTag:t,Eu=function(){try{var m=Eo(dn,"defineProperty");return m({},"",{}),m}catch{}}(),of=Ye.clearTimeout!==Hn.clearTimeout&&Ye.clearTimeout,jl=pt&&pt.now!==Hn.Date.now&&pt.now,ip=Ye.setTimeout!==Hn.setTimeout&&Ye.setTimeout,jc=cr.ceil,ks=cr.floor,wo=dn.getOwnPropertySymbols,lf=Ct?Ct.isBuffer:t,Au=Ye.isFinite,Zi=_c.join,ea=_u(dn.keys,dn),Kn=cr.max,tr=cr.min,Ts=pt.now,kl=Ye.parseInt,ap=cr.random,sp=_c.reverse,Pu=Eo(Ye,"DataView"),Nr=Eo(Ye,"Map"),nr=Eo(Ye,"Promise"),on=Eo(Ye,"Set"),Na=Eo(Ye,"WeakMap"),fi=Eo(dn,"create"),kc=Na&&new Na,ta={},yg=Ls(Pu),xg=Ls(Nr),Du=Ls(nr),Iu=Ls(on),bg=Ls(Na),So=Yn?Yn.prototype:t,Tl=So?So.valueOf:t,No=So?So.toString:t;function Z(m){if(lr(m)&&!Bt(m)&&!(m instanceof en)){if(m instanceof hi)return m;if(ne.call(m,"__wrapped__"))return _r(m)}return new hi(m)}var Mi=function(){function m(){}return function(y){if(!ir(y))return{};if(Tu)return Tu(y);m.prototype=y;var j=new m;return m.prototype=t,j}}();function na(){}function hi(m,y){this.__wrapped__=m,this.__actions__=[],this.__chain__=!!y,this.__index__=0,this.__values__=t}Z.templateSettings={escape:bt,evaluate:Ft,interpolate:St,variable:"",imports:{_:Z}},Z.prototype=na.prototype,Z.prototype.constructor=Z,hi.prototype=Mi(na.prototype),hi.prototype.constructor=hi;function en(m){this.__wrapped__=m,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ce,this.__views__=[]}function Ru(){var m=new en(this.__wrapped__);return m.__actions__=Cr(this.__actions__),m.__dir__=this.__dir__,m.__filtered__=this.__filtered__,m.__iteratees__=Cr(this.__iteratees__),m.__takeCount__=this.__takeCount__,m.__views__=Cr(this.__views__),m}function cf(){if(this.__filtered__){var m=new en(this);m.__dir__=-1,m.__filtered__=!0}else m=this.clone(),m.__dir__*=-1;return m}function El(){var m=this.__wrapped__.value(),y=this.__dir__,j=Bt(m),O=y<0,G=j?m.length:0,ie=Xg(0,G,this.__views__),ye=ie.start,_e=ie.end,Re=_e-ye,et=O?_e:ye-1,nt=this.__iteratees__,it=nt.length,gt=0,vt=tr(Re,this.__takeCount__);if(!j||!O&&G==Re&&vt==Re)return Fg(m,this.__actions__);var $t=[];e:for(;Re--&&gt<vt;){et+=y;for(var nn=-1,zt=m[et];++nn<it;){var hn=nt[nn],Nn=hn.iteratee,Aa=hn.type,Bi=Nn(zt);if(Aa==Y)zt=Bi;else if(!Bi){if(Aa==Q)continue e;break e}}$t[gt++]=zt}return $t}en.prototype=Mi(na.prototype),en.prototype.constructor=en;function ur(m){var y=-1,j=m==null?0:m.length;for(this.clear();++y<j;){var O=m[y];this.set(O[0],O[1])}}function uf(){this.__data__=fi?fi(null):{},this.size=0}function vg(m){var y=this.has(m)&&delete this.__data__[m];return this.size-=y?1:0,y}function Wb(m){var y=this.__data__;if(fi){var j=y[m];return j===f?t:j}return ne.call(y,m)?y[m]:t}function Qb(m){var y=this.__data__;return fi?y[m]!==t:ne.call(y,m)}function Jb(m,y){var j=this.__data__;return this.size+=this.has(m)?0:1,j[m]=fi&&y===t?f:y,this}ur.prototype.clear=uf,ur.prototype.delete=vg,ur.prototype.get=Wb,ur.prototype.has=Qb,ur.prototype.set=Jb;function Un(m){var y=-1,j=m==null?0:m.length;for(this.clear();++y<j;){var O=m[y];this.set(O[0],O[1])}}function op(){this.__data__=[],this.size=0}function Mu(m){var y=this.__data__,j=Ac(y,m);if(j<0)return!1;var O=y.length-1;return j==O?y.pop():sf.call(y,j,1),--this.size,!0}function Ou(m){var y=this.__data__,j=Ac(y,m);return j<0?t:y[j][1]}function lp(m){return Ac(this.__data__,m)>-1}function Tc(m,y){var j=this.__data__,O=Ac(j,m);return O<0?(++this.size,j.push([m,y])):j[O][1]=y,this}Un.prototype.clear=op,Un.prototype.delete=Mu,Un.prototype.get=Ou,Un.prototype.has=lp,Un.prototype.set=Tc;function pi(m){var y=-1,j=m==null?0:m.length;for(this.clear();++y<j;){var O=m[y];this.set(O[0],O[1])}}function Kb(){this.size=0,this.__data__={hash:new ur,map:new(Nr||Un),string:new ur}}function wg(m){var y=Oc(this,m).delete(m);return this.size-=y?1:0,y}function Xb(m){return Oc(this,m).get(m)}function Sg(m){return Oc(this,m).has(m)}function Al(m,y){var j=Oc(this,m),O=j.size;return j.set(m,y),this.size+=j.size==O?0:1,this}pi.prototype.clear=Kb,pi.prototype.delete=wg,pi.prototype.get=Xb,pi.prototype.has=Sg,pi.prototype.set=Al;function Es(m){var y=-1,j=m==null?0:m.length;for(this.__data__=new pi;++y<j;)this.add(m[y])}function df(m){return this.__data__.set(m,f),this}function Ng(m){return this.__data__.has(m)}Es.prototype.add=Es.prototype.push=df,Es.prototype.has=Ng;function ai(m){var y=this.__data__=new Un(m);this.size=y.size}function Cg(){this.__data__=new Un,this.size=0}function ff(m){var y=this.__data__,j=y.delete(m);return this.size=y.size,j}function cp(m){return this.__data__.get(m)}function _g(m){return this.__data__.has(m)}function hf(m,y){var j=this.__data__;if(j instanceof Un){var O=j.__data__;if(!Nr||O.length<a-1)return O.push([m,y]),this.size=++j.size,this;j=this.__data__=new pi(O)}return j.set(m,y),this.size=j.size,this}ai.prototype.clear=Cg,ai.prototype.delete=ff,ai.prototype.get=cp,ai.prototype.has=_g,ai.prototype.set=hf;function up(m,y){var j=Bt(m),O=!j&&Us(m),G=!j&&!O&&$o(m),ie=!j&&!O&&!G&&Jc(m),ye=j||O||G||ie,_e=ye?Qa(m.length,af):[],Re=_e.length;for(var et in m)(y||ne.call(m,et))&&!(ye&&(et=="length"||G&&(et=="offset"||et=="parent")||ie&&(et=="buffer"||et=="byteLength"||et=="byteOffset")||ka(et,Re)))&&_e.push(et);return _e}function Ec(m){var y=m.length;return y?m[Nf(0,y-1)]:t}function jg(m,y){return cd(Cr(m),_a(y,0,m.length))}function kg(m){return cd(Cr(m))}function es(m,y,j){(j!==t&&!wi(m[y],j)||j===t&&!(y in m))&&Ca(m,y,j)}function Pl(m,y,j){var O=m[y];(!(ne.call(m,y)&&wi(O,j))||j===t&&!(y in m))&&Ca(m,y,j)}function Ac(m,y){for(var j=m.length;j--;)if(wi(m[j][0],y))return j;return-1}function Co(m,y,j,O){return Ps(m,function(G,ie,ye){y(O,G,j(G),ye)}),O}function As(m,y){return m&&yi(y,Tr(y),m)}function Lu(m,y){return m&&yi(y,Rr(y),m)}function Ca(m,y,j){y=="__proto__"&&Eu?Eu(m,y,{configurable:!0,enumerable:!0,value:j,writable:!0}):m[y]=j}function Fu(m,y){for(var j=-1,O=y.length,G=Ve(O),ie=m==null;++j<O;)G[j]=ie?t:Nd(m,y[j]);return G}function _a(m,y,j){return m===m&&(j!==t&&(m=m<=j?m:j),y!==t&&(m=m>=y?m:y)),m}function Gr(m,y,j,O,G,ie){var ye,_e=y&g,Re=y&b,et=y&v;if(j&&(ye=G?j(m,O,G,ie):j(m)),ye!==t)return ye;if(!ir(m))return m;var nt=Bt(m);if(nt){if(ye=Op(m),!_e)return Cr(m,ye)}else{var it=Ir(m),gt=it==Se||it==Ae;if($o(m))return Tp(m,_e);if(it==lt||it==fe||gt&&!G){if(ye=Re||gt?{}:Lp(m),!_e)return Re?Ku(m,Lu(ye,m)):Ef(m,As(ye,m))}else{if(!kn[it])return G?m:{};ye=Fp(m,it,_e)}}ie||(ie=new ai);var vt=ie.get(m);if(vt)return vt;ie.set(m,ye),Vy(m)?m.forEach(function(zt){ye.add(Gr(zt,y,j,zt,m,ie))}):eh(m)&&m.forEach(function(zt,hn){ye.set(hn,Gr(zt,y,j,hn,m,ie))});var $t=et?Re?If:Df:Re?Rr:Tr,nn=nt?t:$t(m);return Sr(nn||m,function(zt,hn){nn&&(hn=zt,zt=m[hn]),Pl(ye,hn,Gr(zt,y,j,hn,m,ie))}),ye}function Tg(m){var y=Tr(m);return function(j){return dp(j,m,y)}}function dp(m,y,j){var O=j.length;if(m==null)return!O;for(m=dn(m);O--;){var G=j[O],ie=y[G],ye=m[G];if(ye===t&&!(G in m)||!ie(ye))return!1}return!0}function Dl(m,y,j){if(typeof m!="function")throw new ri(l);return Fc(function(){m.apply(t,j)},y)}function _o(m,y,j,O){var G=-1,ie=va,ye=!0,_e=m.length,Re=[],et=y.length;if(!_e)return Re;j&&(y=Gn(y,ti(j))),O?(ie=vc,ye=!1):y.length>=a&&(ie=go,ye=!1,y=new Es(y));e:for(;++G<_e;){var nt=m[G],it=j==null?nt:j(nt);if(nt=O||nt!==0?nt:0,ye&&it===it){for(var gt=et;gt--;)if(y[gt]===it)continue e;Re.push(nt)}else ie(y,it,O)||Re.push(nt)}return Re}var Ps=Dp(Yr),pf=Dp(Dc,!0);function fp(m,y){var j=!0;return Ps(m,function(O,G,ie){return j=!!y(O,G,ie),j}),j}function ja(m,y,j){for(var O=-1,G=m.length;++O<G;){var ie=m[O],ye=y(ie);if(ye!=null&&(_e===t?ye===ye&&!li(ye):j(ye,_e)))var _e=ye,Re=ie}return Re}function Jt(m,y,j,O){var G=m.length;for(j=Gt(j),j<0&&(j=-j>G?0:G+j),O=O===t||O>G?G:Gt(O),O<0&&(O+=G),O=j>O?0:cs(O);j<O;)m[j++]=y;return m}function An(m,y){var j=[];return Ps(m,function(O,G,ie){y(O,G,ie)&&j.push(O)}),j}function ln(m,y,j,O,G){var ie=-1,ye=m.length;for(j||(j=Ms),G||(G=[]);++ie<ye;){var _e=m[ie];y>0&&j(_e)?y>1?ln(_e,y-1,j,O,G):Ji(G,_e):O||(G[G.length]=_e)}return G}var Pc=$l(),Il=$l(!0);function Yr(m,y){return m&&Pc(m,y,Tr)}function Dc(m,y){return m&&Il(m,y,Tr)}function jo(m,y){return ei(y,function(j){return Ta(m[j])})}function ra(m,y){y=Is(y,m);for(var j=0,O=y.length;m!=null&&j<O;)m=m[En(y[j++])];return j&&j==O?m:t}function Eg(m,y,j){var O=y(m);return Bt(m)?O:Ji(O,j(m))}function fn(m){return m==null?m===t?ke:rt:ii&&ii in dn(m)?Kg(m):ry(m)}function $u(m,y){return m>y}function hp(m,y){return m!=null&&ne.call(m,y)}function Ag(m,y){return m!=null&&y in dn(m)}function Pg(m,y,j){return m>=tr(y,j)&&m<Kn(y,j)}function pp(m,y,j){for(var O=j?vc:va,G=m[0].length,ie=m.length,ye=ie,_e=Ve(ie),Re=1/0,et=[];ye--;){var nt=m[ye];ye&&y&&(nt=Gn(nt,ti(y))),Re=tr(nt.length,Re),_e[ye]=!j&&(y||G>=120&&nt.length>=120)?new Es(ye&&nt):t}nt=m[0];var it=-1,gt=_e[0];e:for(;++it<G&&et.length<Re;){var vt=nt[it],$t=y?y(vt):vt;if(vt=j||vt!==0?vt:0,!(gt?go(gt,$t):O(et,$t,j))){for(ye=ie;--ye;){var nn=_e[ye];if(!(nn?go(nn,$t):O(m[ye],$t,j)))continue e}gt&&gt.push($t),et.push(vt)}}return et}function mp(m,y,j,O){return Yr(m,function(G,ie,ye){y(O,j(G),ie,ye)}),O}function Rl(m,y,j){y=Is(y,m),m=Lc(m,y);var O=m==null?m:m[En(Wr(y))];return O==null?t:Vr(O,m,j)}function mf(m){return lr(m)&&fn(m)==fe}function mi(m){return lr(m)&&fn(m)==ge}function yr(m){return lr(m)&&fn(m)==je}function Ml(m,y,j,O,G){return m===y?!0:m==null||y==null||!lr(m)&&!lr(y)?m!==m&&y!==y:zu(m,y,j,O,Ml,G)}function zu(m,y,j,O,G,ie){var ye=Bt(m),_e=Bt(y),Re=ye?W:Ir(m),et=_e?W:Ir(y);Re=Re==fe?lt:Re,et=et==fe?lt:et;var nt=Re==lt,it=et==lt,gt=Re==et;if(gt&&$o(m)){if(!$o(y))return!1;ye=!0,nt=!1}if(gt&&!nt)return ie||(ie=new ai),ye||Jc(m)?Qg(m,y,j,O,G,ie):Jg(m,y,Re,j,O,G,ie);if(!(j&S)){var vt=nt&&ne.call(m,"__wrapped__"),$t=it&&ne.call(y,"__wrapped__");if(vt||$t){var nn=vt?m.value():m,zt=$t?y.value():y;return ie||(ie=new ai),G(nn,zt,j,O,ie)}}return gt?(ie||(ie=new ai),Dr(m,y,j,O,G,ie)):!1}function gf(m){return lr(m)&&Ir(m)==Pe}function Uu(m,y,j,O){var G=j.length,ie=G,ye=!O;if(m==null)return!ie;for(m=dn(m);G--;){var _e=j[G];if(ye&&_e[2]?_e[1]!==m[_e[0]]:!(_e[0]in m))return!1}for(;++G<ie;){_e=j[G];var Re=_e[0],et=m[Re],nt=_e[1];if(ye&&_e[2]){if(et===t&&!(Re in m))return!1}else{var it=new ai;if(O)var gt=O(et,nt,Re,m,y,it);if(!(gt===t?Ml(nt,et,S|k,O,it):gt))return!1}}return!0}function ts(m){if(!ir(m)||$f(m))return!1;var y=Ta(m)?jt:Yd;return y.test(Ls(m))}function yf(m){return lr(m)&&fn(m)==at}function gp(m){return lr(m)&&Ir(m)==be}function yp(m){return lr(m)&&Vl(m.length)&&!!xn[fn(m)]}function xp(m){return typeof m=="function"?m:m==null?Fe:typeof m=="object"?Bt(m)?vf(m[0],m[1]):vp(m):Sn(m)}function xf(m){if(!Bn(m))return ea(m);var y=[];for(var j in dn(m))ne.call(m,j)&&j!="constructor"&&y.push(j);return y}function Dg(m){if(!ir(m))return Ao(m);var y=Bn(m),j=[];for(var O in m)O=="constructor"&&(y||!ne.call(m,O))||j.push(O);return j}function bf(m,y){return m<y}function bp(m,y){var j=-1,O=jr(m)?Ve(m.length):[];return Ps(m,function(G,ie,ye){O[++j]=y(G,ie,ye)}),O}function vp(m){var y=Mf(m);return y.length==1&&y[0][2]?ty(y[0][0],y[0][1]):function(j){return j===m||Uu(j,m,y)}}function vf(m,y){return Lf(m)&&ey(y)?ty(En(m),y):function(j){var O=Nd(j,m);return O===t&&O===y?eu(j,m):Ml(y,O,S|k)}}function Bu(m,y,j,O,G){m!==y&&Pc(y,function(ie,ye){if(G||(G=new ai),ir(ie))Zb(m,y,ye,j,Bu,O,G);else{var _e=O?O(zf(m,ye),ie,ye+"",m,y,G):t;_e===t&&(_e=ie),es(m,ye,_e)}},Rr)}function Zb(m,y,j,O,G,ie,ye){var _e=zf(m,j),Re=zf(y,j),et=ye.get(Re);if(et){es(m,j,et);return}var nt=ie?ie(_e,Re,j+"",m,y,ye):t,it=nt===t;if(it){var gt=Bt(Re),vt=!gt&&$o(Re),$t=!gt&&!vt&&Jc(Re);nt=Re,gt||vt||$t?Bt(_e)?nt=_e:hr(_e)?nt=Cr(_e):vt?(it=!1,nt=Tp(Re,!0)):$t?(it=!1,nt=Ap(Re,!0)):nt=[]:oa(Re)||Us(Re)?(nt=_e,Us(_e)?nt=Yy(_e):(!ir(_e)||Ta(_e))&&(nt=Lp(Re))):it=!1}it&&(ye.set(Re,nt),G(nt,Re,O,ie,ye),ye.delete(Re)),es(m,j,nt)}function wp(m,y){var j=m.length;if(j)return y+=y<0?j:0,ka(y,j)?m[y]:t}function Sp(m,y,j){y.length?y=Gn(y,function(ie){return Bt(ie)?function(ye){return ra(ye,ie.length===1?ie[0]:ie)}:ie}):y=[Fe];var O=-1;y=Gn(y,ti(kt()));var G=bp(m,function(ie,ye,_e){var Re=Gn(y,function(et){return et(ie)});return{criteria:Re,index:++O,value:ie}});return tf(G,function(ie,ye){return Bg(ie,ye,j)})}function Ig(m,y){return wf(m,y,function(j,O){return eu(m,O)})}function wf(m,y,j){for(var O=-1,G=y.length,ie={};++O<G;){var ye=y[O],_e=ra(m,ye);j(_e,ye)&&Rc(ie,Is(ye,m),_e)}return ie}function Rg(m){return function(y){return ra(y,m)}}function Sf(m,y,j,O){var G=O?yl:mo,ie=-1,ye=y.length,_e=m;for(m===y&&(y=Cr(y)),j&&(_e=Gn(m,ti(j)));++ie<ye;)for(var Re=0,et=y[ie],nt=j?j(et):et;(Re=G(_e,nt,Re,O))>-1;)_e!==m&&sf.call(_e,Re,1),sf.call(m,Re,1);return m}function Np(m,y){for(var j=m?y.length:0,O=j-1;j--;){var G=y[j];if(j==O||G!==ie){var ie=G;ka(G)?sf.call(m,G,1):Gu(m,G)}}return m}function Nf(m,y){return m+ks(ap()*(y-m+1))}function Mg(m,y,j,O){for(var G=-1,ie=Kn(jc((y-m)/(j||1)),0),ye=Ve(ie);ie--;)ye[O?ie:++G]=m,m+=j;return ye}function Cp(m,y){var j="";if(!m||y<1||y>re)return j;do y%2&&(j+=m),y=ks(y/2),y&&(m+=m);while(y);return j}function Yt(m,y){return od($p(m,y,Fe),m+"")}function Ic(m){return Ec(nu(m))}function Cf(m,y){var j=nu(m);return cd(j,_a(y,0,j.length))}function Rc(m,y,j,O){if(!ir(m))return m;y=Is(y,m);for(var G=-1,ie=y.length,ye=ie-1,_e=m;_e!=null&&++G<ie;){var Re=En(y[G]),et=j;if(Re==="__proto__"||Re==="constructor"||Re==="prototype")return m;if(G!=ye){var nt=_e[Re];et=O?O(nt,Re,_e):t,et===t&&(et=ir(nt)?nt:ka(y[G+1])?[]:{})}Pl(_e,Re,et),_e=_e[Re]}return m}var qu=kc?function(m,y){return kc.set(m,y),m}:Fe,Vu=Eu?function(m,y){return Eu(m,"toString",{configurable:!0,enumerable:!1,value:Le(y),writable:!0})}:Fe;function Og(m){return cd(nu(m))}function Oi(m,y,j){var O=-1,G=m.length;y<0&&(y=-y>G?0:G+y),j=j>G?G:j,j<0&&(j+=G),G=y>j?0:j-y>>>0,y>>>=0;for(var ie=Ve(G);++O<G;)ie[O]=m[O+y];return ie}function Lg(m,y){var j;return Ps(m,function(O,G,ie){return j=y(O,G,ie),!j}),!!j}function Hu(m,y,j){var O=0,G=m==null?O:m.length;if(typeof y=="number"&&y===y&&G<=I){for(;O<G;){var ie=O+G>>>1,ye=m[ie];ye!==null&&!li(ye)&&(j?ye<=y:ye<y)?O=ie+1:G=ie}return G}return _f(m,y,Fe,j)}function _f(m,y,j,O){var G=0,ie=m==null?0:m.length;if(ie===0)return 0;y=j(y);for(var ye=y!==y,_e=y===null,Re=li(y),et=y===t;G<ie;){var nt=ks((G+ie)/2),it=j(m[nt]),gt=it!==t,vt=it===null,$t=it===it,nn=li(it);if(ye)var zt=O||$t;else et?zt=$t&&(O||gt):_e?zt=$t&&gt&&(O||!vt):Re?zt=$t&&gt&&!vt&&(O||!nn):vt||nn?zt=!1:zt=O?it<=y:it<y;zt?G=nt+1:ie=nt}return tr(ie,ue)}function _p(m,y){for(var j=-1,O=m.length,G=0,ie=[];++j<O;){var ye=m[j],_e=y?y(ye):ye;if(!j||!wi(_e,Re)){var Re=_e;ie[G++]=ye===0?0:ye}}return ie}function jf(m){return typeof m=="number"?m:li(m)?E:+m}function gi(m){if(typeof m=="string")return m;if(Bt(m))return Gn(m,gi)+"";if(li(m))return No?No.call(m):"";var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function Ds(m,y,j){var O=-1,G=va,ie=m.length,ye=!0,_e=[],Re=_e;if(j)ye=!1,G=vc;else if(ie>=a){var et=y?null:Yg(m);if(et)return Sl(et);ye=!1,G=go,Re=new Es}else Re=y?[]:_e;e:for(;++O<ie;){var nt=m[O],it=y?y(nt):nt;if(nt=j||nt!==0?nt:0,ye&&it===it){for(var gt=Re.length;gt--;)if(Re[gt]===it)continue e;y&&Re.push(it),_e.push(nt)}else G(Re,it,j)||(Re!==_e&&Re.push(it),_e.push(nt))}return _e}function Gu(m,y){return y=Is(y,m),m=Lc(m,y),m==null||delete m[En(Wr(y))]}function jp(m,y,j,O){return Rc(m,y,j(ra(m,y)),O)}function Yu(m,y,j,O){for(var G=m.length,ie=O?G:-1;(O?ie--:++ie<G)&&y(m[ie],ie,m););return j?Oi(m,O?0:ie,O?ie+1:G):Oi(m,O?ie+1:0,O?G:ie)}function Fg(m,y){var j=m;return j instanceof en&&(j=j.value()),ws(y,function(O,G){return G.func.apply(G.thisArg,Ji([O],G.args))},j)}function Wu(m,y,j){var O=m.length;if(O<2)return O?Ds(m[0]):[];for(var G=-1,ie=Ve(O);++G<O;)for(var ye=m[G],_e=-1;++_e<O;)_e!=G&&(ie[G]=_o(ie[G]||ye,m[_e],y,j));return Ds(ln(ie,1),y,j)}function kp(m,y,j){for(var O=-1,G=m.length,ie=y.length,ye={};++O<G;){var _e=O<ie?y[O]:t;j(ye,m[O],_e)}return ye}function kf(m){return hr(m)?m:[]}function Qu(m){return typeof m=="function"?m:Fe}function Is(m,y){return Bt(m)?m:Lf(m,y)?[m]:as(Tn(m))}var $g=Yt;function ko(m,y,j){var O=m.length;return j=j===t?O:j,!y&&j>=O?m:Oi(m,y,j)}var zg=of||function(m){return Hn.clearTimeout(m)};function Tp(m,y){if(y)return m.slice();var j=m.length,O=js?js(j):new m.constructor(j);return m.copy(O),O}function Ol(m){var y=new m.constructor(m.byteLength);return new Hr(y).set(new Hr(m)),y}function Ep(m,y){var j=y?Ol(m.buffer):m.buffer;return new m.constructor(j,m.byteOffset,m.byteLength)}function Tf(m){var y=new m.constructor(m.source,eo.exec(m));return y.lastIndex=m.lastIndex,y}function Ug(m){return Tl?dn(Tl.call(m)):{}}function Ap(m,y){var j=y?Ol(m.buffer):m.buffer;return new m.constructor(j,m.byteOffset,m.length)}function Ju(m,y){if(m!==y){var j=m!==t,O=m===null,G=m===m,ie=li(m),ye=y!==t,_e=y===null,Re=y===y,et=li(y);if(!_e&&!et&&!ie&&m>y||ie&&ye&&Re&&!_e&&!et||O&&ye&&Re||!j&&Re||!G)return 1;if(!O&&!ie&&!et&&m<y||et&&j&&G&&!O&&!ie||_e&&j&&G||!ye&&G||!Re)return-1}return 0}function Bg(m,y,j){for(var O=-1,G=m.criteria,ie=y.criteria,ye=G.length,_e=j.length;++O<ye;){var Re=Ju(G[O],ie[O]);if(Re){if(O>=_e)return Re;var et=j[O];return Re*(et=="desc"?-1:1)}}return m.index-y.index}function Pp(m,y,j,O){for(var G=-1,ie=m.length,ye=j.length,_e=-1,Re=y.length,et=Kn(ie-ye,0),nt=Ve(Re+et),it=!O;++_e<Re;)nt[_e]=y[_e];for(;++G<ye;)(it||G<ie)&&(nt[j[G]]=m[G]);for(;et--;)nt[_e++]=m[G++];return nt}function qg(m,y,j,O){for(var G=-1,ie=m.length,ye=-1,_e=j.length,Re=-1,et=y.length,nt=Kn(ie-_e,0),it=Ve(nt+et),gt=!O;++G<nt;)it[G]=m[G];for(var vt=G;++Re<et;)it[vt+Re]=y[Re];for(;++ye<_e;)(gt||G<ie)&&(it[vt+j[ye]]=m[G++]);return it}function Cr(m,y){var j=-1,O=m.length;for(y||(y=Ve(O));++j<O;)y[j]=m[j];return y}function yi(m,y,j,O){var G=!j;j||(j={});for(var ie=-1,ye=y.length;++ie<ye;){var _e=y[ie],Re=O?O(j[_e],m[_e],_e,j,m):t;Re===t&&(Re=m[_e]),G?Ca(j,_e,Re):Pl(j,_e,Re)}return j}function Ef(m,y){return yi(m,rd(m),y)}function Ku(m,y){return yi(m,Of(m),y)}function Ll(m,y){return function(j,O){var G=Bt(j)?Xd:Co,ie=y?y():{};return G(j,m,kt(O,2),ie)}}function Fl(m){return Yt(function(y,j){var O=-1,G=j.length,ie=G>1?j[G-1]:t,ye=G>2?j[2]:t;for(ie=m.length>3&&typeof ie=="function"?(G--,ie):t,ye&&oi(j[0],j[1],ye)&&(ie=G<3?t:ie,G=1),y=dn(y);++O<G;){var _e=j[O];_e&&m(y,_e,O,ie)}return y})}function Dp(m,y){return function(j,O){if(j==null)return j;if(!jr(j))return m(j,O);for(var G=j.length,ie=y?G:-1,ye=dn(j);(y?ie--:++ie<G)&&O(ye[ie],ie,ye)!==!1;);return j}}function $l(m){return function(y,j,O){for(var G=-1,ie=dn(y),ye=O(y),_e=ye.length;_e--;){var Re=ye[m?_e:++G];if(j(ie[Re],Re,ie)===!1)break}return y}}function Vg(m,y,j){var O=y&T,G=ia(m);function ie(){var ye=this&&this!==Hn&&this instanceof ie?G:m;return ye.apply(O?j:this,arguments)}return ie}function Li(m){return function(y){y=Tn(y);var j=Sa(y)?ui(y):t,O=j?j[0]:y.charAt(0),G=j?ko(j,1).join(""):y.slice(1);return O[m]()+G}}function si(m){return function(y){return ws(N(Bs(y).replace(Xr,"")),m,"")}}function ia(m){return function(){var y=arguments;switch(y.length){case 0:return new m;case 1:return new m(y[0]);case 2:return new m(y[0],y[1]);case 3:return new m(y[0],y[1],y[2]);case 4:return new m(y[0],y[1],y[2],y[3]);case 5:return new m(y[0],y[1],y[2],y[3],y[4]);case 6:return new m(y[0],y[1],y[2],y[3],y[4],y[5]);case 7:return new m(y[0],y[1],y[2],y[3],y[4],y[5],y[6])}var j=Mi(m.prototype),O=m.apply(j,y);return ir(O)?O:j}}function Hg(m,y,j){var O=ia(m);function G(){for(var ie=arguments.length,ye=Ve(ie),_e=ie,Re=Ul(G);_e--;)ye[_e]=arguments[_e];var et=ie<3&&ye[0]!==Re&&ye[ie-1]!==Re?[]:Ka(ye,Re);if(ie-=et.length,ie<j)return Ip(m,y,dr,G.placeholder,t,ye,et,t,t,j-ie);var nt=this&&this!==Hn&&this instanceof G?O:m;return Vr(nt,this,ye)}return G}function Rs(m){return function(y,j,O){var G=dn(y);if(!jr(y)){var ie=kt(j,3);y=Tr(y),j=function(_e){return ie(G[_e],_e,G)}}var ye=m(y,j,O);return ye>-1?G[ie?y[ye]:ye]:t}}function ns(m){return Xn(function(y){var j=y.length,O=j,G=hi.prototype.thru;for(m&&y.reverse();O--;){var ie=y[O];if(typeof ie!="function")throw new ri(l);if(G&&!ye&&nd(ie)=="wrapper")var ye=new hi([],!0)}for(O=ye?O:j;++O<j;){ie=y[O];var _e=nd(ie),Re=_e=="wrapper"?Rf(ie):t;Re&&Ff(Re[0])&&Re[1]==(U|R|F|B)&&!Re[4].length&&Re[9]==1?ye=ye[nd(Re[0])].apply(ye,Re[3]):ye=ie.length==1&&Ff(ie)?ye[_e]():ye.thru(ie)}return function(){var et=arguments,nt=et[0];if(ye&&et.length==1&&Bt(nt))return ye.plant(nt).value();for(var it=0,gt=j?y[it].apply(this,et):nt;++it<j;)gt=y[it].call(this,gt);return gt}})}function dr(m,y,j,O,G,ie,ye,_e,Re,et){var nt=y&U,it=y&T,gt=y&A,vt=y&(R|z),$t=y&J,nn=gt?t:ia(m);function zt(){for(var hn=arguments.length,Nn=Ve(hn),Aa=hn;Aa--;)Nn[Aa]=arguments[Aa];if(vt)var Bi=Ul(zt),Pa=Ja(Nn,Bi);if(O&&(Nn=Pp(Nn,O,G,vt)),ie&&(Nn=qg(Nn,ie,ye,vt)),hn-=Pa,vt&&hn<et){var Er=Ka(Nn,Bi);return Ip(m,y,dr,zt.placeholder,j,Nn,Er,_e,Re,et-hn)}var qs=it?j:this,Hl=gt?qs[m]:m;return hn=Nn.length,_e?Nn=is(Nn,_e):$t&&hn>1&&Nn.reverse(),nt&&Re<hn&&(Nn.length=Re),this&&this!==Hn&&this instanceof zt&&(Hl=nn||ia(Hl)),Hl.apply(qs,Nn)}return zt}function Xu(m,y){return function(j,O){return mp(j,m,y(O),{})}}function Mc(m,y){return function(j,O){var G;if(j===t&&O===t)return y;if(j!==t&&(G=j),O!==t){if(G===t)return O;typeof j=="string"||typeof O=="string"?(j=gi(j),O=gi(O)):(j=jf(j),O=jf(O)),G=m(j,O)}return G}}function Zu(m){return Xn(function(y){return y=Gn(y,ti(kt())),Yt(function(j){var O=this;return m(y,function(G){return Vr(G,O,j)})})})}function ed(m,y){y=y===t?" ":gi(y);var j=y.length;if(j<2)return j?Cp(y,m):y;var O=Cp(y,jc(m/Xi(y)));return Sa(y)?ko(ui(O),0,m).join(""):O.slice(0,m)}function Gg(m,y,j,O){var G=y&T,ie=ia(m);function ye(){for(var _e=-1,Re=arguments.length,et=-1,nt=O.length,it=Ve(nt+Re),gt=this&&this!==Hn&&this instanceof ye?ie:m;++et<nt;)it[et]=O[et];for(;Re--;)it[et++]=arguments[++_e];return Vr(gt,G?j:this,it)}return ye}function To(m){return function(y,j,O){return O&&typeof O!="number"&&oi(y,j,O)&&(j=O=t),y=ls(y),j===t?(j=y,y=0):j=ls(j),O=O===t?y<j?1:-1:ls(O),Mg(y,j,O,m)}}function zl(m){return function(y,j){return typeof y=="string"&&typeof j=="string"||(y=la(y),j=la(j)),m(y,j)}}function Ip(m,y,j,O,G,ie,ye,_e,Re,et){var nt=y&R,it=nt?ye:t,gt=nt?t:ye,vt=nt?ie:t,$t=nt?t:ie;y|=nt?F:L,y&=~(nt?L:F),y&M||(y&=-4);var nn=[m,y,G,vt,it,$t,gt,_e,Re,et],zt=j.apply(t,nn);return Ff(m)&&Uf(zt,nn),zt.placeholder=O,Bf(zt,m,y)}function Af(m){var y=cr[m];return function(j,O){if(j=la(j),O=O==null?0:tr(Gt(O),292),O&&Au(j)){var G=(Tn(j)+"e").split("e"),ie=y(G[0]+"e"+(+G[1]+O));return G=(Tn(ie)+"e").split("e"),+(G[0]+"e"+(+G[1]-O))}return y(j)}}var Yg=on&&1/Sl(new on([,-0]))[1]==ae?function(m){return new on(m)}:xt;function td(m){return function(y){var j=Ir(y);return j==Pe?wl(y):j==be?ep(y):Zh(y,m(y))}}function rs(m,y,j,O,G,ie,ye,_e){var Re=y&A;if(!Re&&typeof m!="function")throw new ri(l);var et=O?O.length:0;if(et||(y&=-97,O=G=t),ye=ye===t?ye:Kn(Gt(ye),0),_e=_e===t?_e:Gt(_e),et-=G?G.length:0,y&L){var nt=O,it=G;O=G=t}var gt=Re?t:Rf(m),vt=[m,y,j,O,G,nt,it,ie,ye,_e];if(gt&&sd(vt,gt),m=vt[0],y=vt[1],j=vt[2],O=vt[3],G=vt[4],_e=vt[9]=vt[9]===t?Re?0:m.length:Kn(vt[9]-et,0),!_e&&y&(R|z)&&(y&=-25),!y||y==T)var $t=Vg(m,y,j);else y==R||y==z?$t=Hg(m,y,_e):(y==F||y==(T|F))&&!G.length?$t=Gg(m,y,j,O):$t=dr.apply(t,vt);var nn=gt?qu:Uf;return Bf(nn($t,vt),m,y)}function Pf(m,y,j,O){return m===t||wi(m,_s[j])&&!ne.call(O,j)?y:m}function Rp(m,y,j,O,G,ie){return ir(m)&&ir(y)&&(ie.set(y,m),Bu(m,y,t,Rp,ie),ie.delete(y)),m}function Wg(m){return oa(m)?t:m}function Qg(m,y,j,O,G,ie){var ye=j&S,_e=m.length,Re=y.length;if(_e!=Re&&!(ye&&Re>_e))return!1;var et=ie.get(m),nt=ie.get(y);if(et&&nt)return et==y&&nt==m;var it=-1,gt=!0,vt=j&k?new Es:t;for(ie.set(m,y),ie.set(y,m);++it<_e;){var $t=m[it],nn=y[it];if(O)var zt=ye?O(nn,$t,it,y,m,ie):O($t,nn,it,m,y,ie);if(zt!==t){if(zt)continue;gt=!1;break}if(vt){if(!Ya(y,function(hn,Nn){if(!go(vt,Nn)&&($t===hn||G($t,hn,j,O,ie)))return vt.push(Nn)})){gt=!1;break}}else if(!($t===nn||G($t,nn,j,O,ie))){gt=!1;break}}return ie.delete(m),ie.delete(y),gt}function Jg(m,y,j,O,G,ie,ye){switch(j){case He:if(m.byteLength!=y.byteLength||m.byteOffset!=y.byteOffset)return!1;m=m.buffer,y=y.buffer;case ge:return!(m.byteLength!=y.byteLength||!ie(new Hr(m),new Hr(y)));case se:case je:case Ze:return wi(+m,+y);case X:return m.name==y.name&&m.message==y.message;case at:case $e:return m==y+"";case Pe:var _e=wl;case be:var Re=O&S;if(_e||(_e=Sl),m.size!=y.size&&!Re)return!1;var et=ye.get(m);if(et)return et==y;O|=k,ye.set(m,y);var nt=Qg(_e(m),_e(y),O,G,ie,ye);return ye.delete(m),nt;case Be:if(Tl)return Tl.call(m)==Tl.call(y)}return!1}function Dr(m,y,j,O,G,ie){var ye=j&S,_e=Df(m),Re=_e.length,et=Df(y),nt=et.length;if(Re!=nt&&!ye)return!1;for(var it=Re;it--;){var gt=_e[it];if(!(ye?gt in y:ne.call(y,gt)))return!1}var vt=ie.get(m),$t=ie.get(y);if(vt&&$t)return vt==y&&$t==m;var nn=!0;ie.set(m,y),ie.set(y,m);for(var zt=ye;++it<Re;){gt=_e[it];var hn=m[gt],Nn=y[gt];if(O)var Aa=ye?O(Nn,hn,gt,y,m,ie):O(hn,Nn,gt,m,y,ie);if(!(Aa===t?hn===Nn||G(hn,Nn,j,O,ie):Aa)){nn=!1;break}zt||(zt=gt=="constructor")}if(nn&&!zt){var Bi=m.constructor,Pa=y.constructor;Bi!=Pa&&"constructor"in m&&"constructor"in y&&!(typeof Bi=="function"&&Bi instanceof Bi&&typeof Pa=="function"&&Pa instanceof Pa)&&(nn=!1)}return ie.delete(m),ie.delete(y),nn}function Xn(m){return od($p(m,t,bi),m+"")}function Df(m){return Eg(m,Tr,rd)}function If(m){return Eg(m,Rr,Of)}var Rf=kc?function(m){return kc.get(m)}:xt;function nd(m){for(var y=m.name+"",j=ta[y],O=ne.call(ta,y)?j.length:0;O--;){var G=j[O],ie=G.func;if(ie==null||ie==m)return G.name}return y}function Ul(m){var y=ne.call(Z,"placeholder")?Z:m;return y.placeholder}function kt(){var m=Z.iteratee||Rt;return m=m===Rt?xp:m,arguments.length?m(arguments[0],arguments[1]):m}function Oc(m,y){var j=m.__data__;return Os(y)?j[typeof y=="string"?"string":"hash"]:j.map}function Mf(m){for(var y=Tr(m),j=y.length;j--;){var O=y[j],G=m[O];y[j]=[O,G,ey(G)]}return y}function Eo(m,y){var j=Nc(m,y);return ts(j)?j:t}function Kg(m){var y=ne.call(m,ii),j=m[ii];try{m[ii]=t;var O=!0}catch{}var G=Ce.call(m);return O&&(y?m[ii]=j:delete m[ii]),G}var rd=wo?function(m){return m==null?[]:(m=dn(m),ei(wo(m),function(y){return Cl.call(m,y)}))}:Ov,Of=wo?function(m){for(var y=[];m;)Ji(y,rd(m)),m=ku(m);return y}:Ov,Ir=fn;(Pu&&Ir(new Pu(new ArrayBuffer(1)))!=He||Nr&&Ir(new Nr)!=Pe||nr&&Ir(nr.resolve())!=ze||on&&Ir(new on)!=be||Na&&Ir(new Na)!=Ne)&&(Ir=function(m){var y=fn(m),j=y==lt?m.constructor:t,O=j?Ls(j):"";if(O)switch(O){case yg:return He;case xg:return Pe;case Du:return ze;case Iu:return be;case bg:return Ne}return y});function Xg(m,y,j){for(var O=-1,G=j.length;++O<G;){var ie=j[O],ye=ie.size;switch(ie.type){case"drop":m+=ye;break;case"dropRight":y-=ye;break;case"take":y=tr(y,m+ye);break;case"takeRight":m=Kn(m,y-ye);break}}return{start:m,end:y}}function Mp(m){var y=m.match(Jh);return y?y[1].split(nl):[]}function id(m,y,j){y=Is(y,m);for(var O=-1,G=y.length,ie=!1;++O<G;){var ye=En(y[O]);if(!(ie=m!=null&&j(m,ye)))break;m=m[ye]}return ie||++O!=G?ie:(G=m==null?0:m.length,!!G&&Vl(G)&&ka(ye,G)&&(Bt(m)||Us(m)))}function Op(m){var y=m.length,j=new m.constructor(y);return y&&typeof m[0]=="string"&&ne.call(m,"index")&&(j.index=m.index,j.input=m.input),j}function Lp(m){return typeof m.constructor=="function"&&!Bn(m)?Mi(ku(m)):{}}function Fp(m,y,j){var O=m.constructor;switch(y){case ge:return Ol(m);case se:case je:return new O(+m);case He:return Ep(m,j);case Qe:case dt:case At:case Ht:case we:case xe:case Me:case De:case qe:return Ap(m,j);case Pe:return new O;case Ze:case $e:return new O(m);case at:return Tf(m);case be:return new O;case Be:return Ug(m)}}function Zg(m,y){var j=y.length;if(!j)return m;var O=j-1;return y[O]=(j>1?"& ":"")+y[O],y=y.join(j>2?", ":" "),m.replace(vu,`{
/* [wrapped with `+y+`] */
`)}function Ms(m){return Bt(m)||Us(m)||!!(di&&m&&m[di])}function ka(m,y){var j=typeof m;return y=y??re,!!y&&(j=="number"||j!="symbol"&&gs.test(m))&&m>-1&&m%1==0&&m<y}function oi(m,y,j){if(!ir(j))return!1;var O=typeof y;return(O=="number"?jr(j)&&ka(y,j.length):O=="string"&&y in j)?wi(j[y],m):!1}function Lf(m,y){if(Bt(m))return!1;var j=typeof m;return j=="number"||j=="symbol"||j=="boolean"||m==null||li(m)?!0:Yi.test(m)||!Jn.test(m)||y!=null&&m in dn(y)}function Os(m){var y=typeof m;return y=="string"||y=="number"||y=="symbol"||y=="boolean"?m!=="__proto__":m===null}function Ff(m){var y=nd(m),j=Z[y];if(typeof j!="function"||!(y in en.prototype))return!1;if(m===j)return!0;var O=Rf(j);return!!O&&m===O[0]}function $f(m){return!!he&&he in m}var ad=bo?Ta:Lv;function Bn(m){var y=m&&m.constructor,j=typeof y=="function"&&y.prototype||_s;return m===j}function ey(m){return m===m&&!ir(m)}function ty(m,y){return function(j){return j==null?!1:j[m]===y&&(y!==t||m in dn(j))}}function ny(m){var y=yd(m,function(O){return j.size===u&&j.clear(),O}),j=y.cache;return y}function sd(m,y){var j=m[1],O=y[1],G=j|O,ie=G<(T|A|U),ye=O==U&&j==R||O==U&&j==B&&m[7].length<=y[8]||O==(U|B)&&y[7].length<=y[8]&&j==R;if(!(ie||ye))return m;O&T&&(m[2]=y[2],G|=j&T?0:M);var _e=y[3];if(_e){var Re=m[3];m[3]=Re?Pp(Re,_e,y[4]):_e,m[4]=Re?Ka(m[3],p):y[4]}return _e=y[5],_e&&(Re=m[5],m[5]=Re?qg(Re,_e,y[6]):_e,m[6]=Re?Ka(m[5],p):y[6]),_e=y[7],_e&&(m[7]=_e),O&U&&(m[8]=m[8]==null?y[8]:tr(m[8],y[8])),m[9]==null&&(m[9]=y[9]),m[0]=y[0],m[1]=G,m}function Ao(m){var y=[];if(m!=null)for(var j in dn(m))y.push(j);return y}function ry(m){return Ce.call(m)}function $p(m,y,j){return y=Kn(y===t?m.length-1:y,0),function(){for(var O=arguments,G=-1,ie=Kn(O.length-y,0),ye=Ve(ie);++G<ie;)ye[G]=O[y+G];G=-1;for(var _e=Ve(y+1);++G<y;)_e[G]=O[G];return _e[y]=j(ye),Vr(m,this,_e)}}function Lc(m,y){return y.length<2?m:ra(m,Oi(y,0,-1))}function is(m,y){for(var j=m.length,O=tr(y.length,j),G=Cr(m);O--;){var ie=y[O];m[O]=ka(ie,j)?G[ie]:t}return m}function zf(m,y){if(!(y==="constructor"&&typeof m[y]=="function")&&y!="__proto__")return m[y]}var Uf=ld(qu),Fc=ip||function(m,y){return Hn.setTimeout(m,y)},od=ld(Vu);function Bf(m,y,j){var O=y+"";return od(m,Zg(O,iy(Mp(O),j)))}function ld(m){var y=0,j=0;return function(){var O=Ts(),G=te-(O-j);if(j=O,G>0){if(++y>=H)return arguments[0]}else y=0;return m.apply(t,arguments)}}function cd(m,y){var j=-1,O=m.length,G=O-1;for(y=y===t?O:y;++j<y;){var ie=Nf(j,G),ye=m[ie];m[ie]=m[j],m[j]=ye}return m.length=y,m}var as=ny(function(m){var y=[];return m.charCodeAt(0)===46&&y.push(""),m.replace(vr,function(j,O,G,ie){y.push(G?ie.replace(ms,"$1"):O||j)}),y});function En(m){if(typeof m=="string"||li(m))return m;var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function Ls(m){if(m!=null){try{return vo.call(m)}catch{}try{return m+""}catch{}}return""}function iy(m,y){return Sr(de,function(j){var O="_."+j[0];y&j[1]&&!va(m,O)&&m.push(O)}),m.sort()}function _r(m){if(m instanceof en)return m.clone();var y=new hi(m.__wrapped__,m.__chain__);return y.__actions__=Cr(m.__actions__),y.__index__=m.__index__,y.__values__=m.__values__,y}function ev(m,y,j){(j?oi(m,y,j):y===t)?y=1:y=Kn(Gt(y),0);var O=m==null?0:m.length;if(!O||y<1)return[];for(var G=0,ie=0,ye=Ve(jc(O/y));G<O;)ye[ie++]=Oi(m,G,G+=y);return ye}function ay(m){for(var y=-1,j=m==null?0:m.length,O=0,G=[];++y<j;){var ie=m[y];ie&&(G[O++]=ie)}return G}function sy(){var m=arguments.length;if(!m)return[];for(var y=Ve(m-1),j=arguments[0],O=m;O--;)y[O-1]=arguments[O];return Ji(Bt(j)?Cr(j):[j],ln(y,1))}var rr=Yt(function(m,y){return hr(m)?_o(m,ln(y,1,hr,!0)):[]}),xi=Yt(function(m,y){var j=Wr(y);return hr(j)&&(j=t),hr(m)?_o(m,ln(y,1,hr,!0),kt(j,2)):[]}),Fs=Yt(function(m,y){var j=Wr(y);return hr(j)&&(j=t),hr(m)?_o(m,ln(y,1,hr,!0),t,j):[]});function oy(m,y,j){var O=m==null?0:m.length;return O?(y=j||y===t?1:Gt(y),Oi(m,y<0?0:y,O)):[]}function ly(m,y,j){var O=m==null?0:m.length;return O?(y=j||y===t?1:Gt(y),y=O-y,Oi(m,0,y<0?0:y)):[]}function tv(m,y){return m&&m.length?Yu(m,kt(y,3),!0,!0):[]}function zp(m,y){return m&&m.length?Yu(m,kt(y,3),!0):[]}function Fi(m,y,j,O){var G=m==null?0:m.length;return G?(j&&typeof j!="number"&&oi(m,y,j)&&(j=0,O=G),Jt(m,y,j,O)):[]}function aa(m,y,j){var O=m==null?0:m.length;if(!O)return-1;var G=j==null?0:Gt(j);return G<0&&(G=Kn(O+G,0)),Wa(m,kt(y,3),G)}function Up(m,y,j){var O=m==null?0:m.length;if(!O)return-1;var G=O-1;return j!==t&&(G=Gt(j),G=j<0?Kn(O+G,0):tr(G,O-1)),Wa(m,kt(y,3),G,!0)}function bi(m){var y=m==null?0:m.length;return y?ln(m,1):[]}function cy(m){var y=m==null?0:m.length;return y?ln(m,ae):[]}function Po(m,y){var j=m==null?0:m.length;return j?(y=y===t?1:Gt(y),ln(m,y)):[]}function Bl(m){for(var y=-1,j=m==null?0:m.length,O={};++y<j;){var G=m[y];O[G[0]]=G[1]}return O}function $s(m){return m&&m.length?m[0]:t}function Bp(m,y,j){var O=m==null?0:m.length;if(!O)return-1;var G=j==null?0:Gt(j);return G<0&&(G=Kn(O+G,0)),mo(m,y,G)}function qp(m){var y=m==null?0:m.length;return y?Oi(m,0,-1):[]}var ss=Yt(function(m){var y=Gn(m,kf);return y.length&&y[0]===m[0]?pp(y):[]}),uy=Yt(function(m){var y=Wr(m),j=Gn(m,kf);return y===Wr(j)?y=t:j.pop(),j.length&&j[0]===m[0]?pp(j,kt(y,2)):[]}),$c=Yt(function(m){var y=Wr(m),j=Gn(m,kf);return y=typeof y=="function"?y:t,y&&j.pop(),j.length&&j[0]===m[0]?pp(j,t,y):[]});function ud(m,y){return m==null?"":Zi.call(m,y)}function Wr(m){var y=m==null?0:m.length;return y?m[y-1]:t}function zc(m,y,j){var O=m==null?0:m.length;if(!O)return-1;var G=O;return j!==t&&(G=Gt(j),G=G<0?Kn(O+G,0):tr(G,O-1)),y===y?ni(m,y,G):Wa(m,Ns,G,!0)}function dy(m,y){return m&&m.length?wp(m,Gt(y)):t}var fy=Yt(Uc);function Uc(m,y){return m&&m.length&&y&&y.length?Sf(m,y):m}function hy(m,y,j){return m&&m.length&&y&&y.length?Sf(m,y,kt(j,2)):m}function qf(m,y,j){return m&&m.length&&y&&y.length?Sf(m,y,t,j):m}var py=Xn(function(m,y){var j=m==null?0:m.length,O=Fu(m,y);return Np(m,Gn(y,function(G){return ka(G,j)?+G:G}).sort(Ju)),O});function nv(m,y){var j=[];if(!(m&&m.length))return j;var O=-1,G=[],ie=m.length;for(y=kt(y,3);++O<ie;){var ye=m[O];y(ye,O,m)&&(j.push(ye),G.push(O))}return Np(m,G),j}function Vp(m){return m==null?m:sp.call(m)}function Pn(m,y,j){var O=m==null?0:m.length;return O?(j&&typeof j!="number"&&oi(m,y,j)?(y=0,j=O):(y=y==null?0:Gt(y),j=j===t?O:Gt(j)),Oi(m,y,j)):[]}function Wn(m,y){return Hu(m,y)}function an(m,y,j){return _f(m,y,kt(j,2))}function bn(m,y){var j=m==null?0:m.length;if(j){var O=Hu(m,y);if(O<j&&wi(m[O],y))return O}return-1}function Dn(m,y){return Hu(m,y,!0)}function $i(m,y,j){return _f(m,y,kt(j,2),!0)}function Do(m,y){var j=m==null?0:m.length;if(j){var O=Hu(m,y,!0)-1;if(wi(m[O],y))return O}return-1}function Bc(m){return m&&m.length?_p(m):[]}function Hp(m,y){return m&&m.length?_p(m,kt(y,2)):[]}function zs(m){var y=m==null?0:m.length;return y?Oi(m,1,y):[]}function fr(m,y,j){return m&&m.length?(y=j||y===t?1:Gt(y),Oi(m,0,y<0?0:y)):[]}function Io(m,y,j){var O=m==null?0:m.length;return O?(y=j||y===t?1:Gt(y),y=O-y,Oi(m,y<0?0:y,O)):[]}function ql(m,y){return m&&m.length?Yu(m,kt(y,3),!1,!0):[]}function Gp(m,y){return m&&m.length?Yu(m,kt(y,3)):[]}var sa=Yt(function(m){return Ds(ln(m,1,hr,!0))}),qc=Yt(function(m){var y=Wr(m);return hr(y)&&(y=t),Ds(ln(m,1,hr,!0),kt(y,2))}),dd=Yt(function(m){var y=Wr(m);return y=typeof y=="function"?y:t,Ds(ln(m,1,hr,!0),t,y)});function vi(m){return m&&m.length?Ds(m):[]}function Yp(m,y){return m&&m.length?Ds(m,kt(y,2)):[]}function Wp(m,y){return y=typeof y=="function"?y:t,m&&m.length?Ds(m,t,y):[]}function Vc(m){if(!(m&&m.length))return[];var y=0;return m=ei(m,function(j){if(hr(j))return y=Kn(j.length,y),!0}),Qa(y,function(j){return Gn(m,bl(j))})}function fd(m,y){if(!(m&&m.length))return[];var j=Vc(m);return y==null?j:Gn(j,function(O){return Vr(y,t,O)})}var Ro=Yt(function(m,y){return hr(m)?_o(m,y):[]}),zr=Yt(function(m){return Wu(ei(m,hr))}),Mo=Yt(function(m){var y=Wr(m);return hr(y)&&(y=t),Wu(ei(m,hr),kt(y,2))}),Hc=Yt(function(m){var y=Wr(m);return y=typeof y=="function"?y:t,Wu(ei(m,hr),t,y)}),Gc=Yt(Vc);function Qp(m,y){return kp(m||[],y||[],Pl)}function Jp(m,y){return kp(m||[],y||[],Rc)}var my=Yt(function(m){var y=m.length,j=y>1?m[y-1]:t;return j=typeof j=="function"?(m.pop(),j):t,fd(m,j)});function Yc(m){var y=Z(m);return y.__chain__=!0,y}function Kp(m,y){return y(m),m}function Qr(m,y){return y(m)}var gy=Xn(function(m){var y=m.length,j=y?m[0]:0,O=this.__wrapped__,G=function(ie){return Fu(ie,m)};return y>1||this.__actions__.length||!(O instanceof en)||!ka(j)?this.thru(G):(O=O.slice(j,+j+(y?1:0)),O.__actions__.push({func:Qr,args:[G],thisArg:t}),new hi(O,this.__chain__).thru(function(ie){return y&&!ie.length&&ie.push(t),ie}))});function zi(){return Yc(this)}function yy(){return new hi(this.value(),this.__chain__)}function xy(){this.__values__===t&&(this.__values__=Ui(this.value()));var m=this.__index__>=this.__values__.length,y=m?t:this.__values__[this.__index__++];return{done:m,value:y}}function rv(){return this}function Oo(m){for(var y,j=this;j instanceof na;){var O=_r(j);O.__index__=0,O.__values__=t,y?G.__wrapped__=O:y=O;var G=O;j=j.__wrapped__}return G.__wrapped__=m,y}function Vf(){var m=this.__wrapped__;if(m instanceof en){var y=m;return this.__actions__.length&&(y=new en(this)),y=y.reverse(),y.__actions__.push({func:Qr,args:[Vp],thisArg:t}),new hi(y,this.__chain__)}return this.thru(Vp)}function Xp(){return Fg(this.__wrapped__,this.__actions__)}var Wc=Ll(function(m,y,j){ne.call(m,j)?++m[j]:Ca(m,j,1)});function by(m,y,j){var O=Bt(m)?bc:fp;return j&&oi(m,y,j)&&(y=t),O(m,kt(y,3))}function vy(m,y){var j=Bt(m)?ei:An;return j(m,kt(y,3))}var wy=Rs(aa),Zp=Rs(Up);function em(m,y){return ln(hd(m,y),1)}function iv(m,y){return ln(hd(m,y),ae)}function av(m,y,j){return j=j===t?1:Gt(j),ln(hd(m,y),j)}function Sy(m,y){var j=Bt(m)?Sr:Ps;return j(m,kt(y,3))}function tm(m,y){var j=Bt(m)?Zd:pf;return j(m,kt(y,3))}var Ny=Ll(function(m,y,j){ne.call(m,j)?m[j].push(y):Ca(m,j,[y])});function Qc(m,y,j,O){m=jr(m)?m:nu(m),j=j&&!O?Gt(j):0;var G=m.length;return j<0&&(j=Kn(G+j,0)),nh(m)?j<=G&&m.indexOf(y,j)>-1:!!G&&mo(m,y,j)>-1}var Hf=Yt(function(m,y,j){var O=-1,G=typeof y=="function",ie=jr(m)?Ve(m.length):[];return Ps(m,function(ye){ie[++O]=G?Vr(y,ye,j):Rl(ye,y,j)}),ie}),Cy=Ll(function(m,y,j){Ca(m,j,y)});function hd(m,y){var j=Bt(m)?Gn:bp;return j(m,kt(y,3))}function _y(m,y,j,O){return m==null?[]:(Bt(y)||(y=y==null?[]:[y]),j=O?t:j,Bt(j)||(j=j==null?[]:[j]),Sp(m,y,j))}var jy=Ll(function(m,y,j){m[j?0:1].push(y)},function(){return[[],[]]});function ky(m,y,j){var O=Bt(m)?ws:Su,G=arguments.length<3;return O(m,kt(y,4),j,G,Ps)}function Ty(m,y,j){var O=Bt(m)?Kh:Su,G=arguments.length<3;return O(m,kt(y,4),j,G,pf)}function Gf(m,y){var j=Bt(m)?ei:An;return j(m,xd(kt(y,3)))}function Ey(m){var y=Bt(m)?Ec:Ic;return y(m)}function Ay(m,y,j){(j?oi(m,y,j):y===t)?y=1:y=Gt(y);var O=Bt(m)?jg:Cf;return O(m,y)}function qn(m){var y=Bt(m)?kg:Og;return y(m)}function nm(m){if(m==null)return 0;if(jr(m))return nh(m)?Xi(m):m.length;var y=Ir(m);return y==Pe||y==be?m.size:xf(m).length}function sv(m,y,j){var O=Bt(m)?Ya:Lg;return j&&oi(m,y,j)&&(y=t),O(m,kt(y,3))}var Py=Yt(function(m,y){if(m==null)return[];var j=y.length;return j>1&&oi(m,y[0],y[1])?y=[]:j>2&&oi(y[0],y[1],y[2])&&(y=[y[0]]),Sp(m,ln(y,1),[])}),Yf=jl||function(){return Hn.Date.now()};function ov(m,y){if(typeof y!="function")throw new ri(l);return m=Gt(m),function(){if(--m<1)return y.apply(this,arguments)}}function Dy(m,y,j){return y=j?t:y,y=m&&y==null?m.length:y,rs(m,U,t,t,t,t,y)}function pd(m,y){var j;if(typeof y!="function")throw new ri(l);return m=Gt(m),function(){return--m>0&&(j=y.apply(this,arguments)),m<=1&&(y=t),j}}var Lo=Yt(function(m,y,j){var O=T;if(j.length){var G=Ka(j,Ul(Lo));O|=F}return rs(m,O,y,j,G)}),Wf=Yt(function(m,y,j){var O=T|A;if(j.length){var G=Ka(j,Ul(Wf));O|=F}return rs(y,O,m,j,G)});function md(m,y,j){y=j?t:y;var O=rs(m,R,t,t,t,t,t,y);return O.placeholder=md.placeholder,O}function Qf(m,y,j){y=j?t:y;var O=rs(m,z,t,t,t,t,t,y);return O.placeholder=Qf.placeholder,O}function Fo(m,y,j){var O,G,ie,ye,_e,Re,et=0,nt=!1,it=!1,gt=!0;if(typeof m!="function")throw new ri(l);y=la(y)||0,ir(j)&&(nt=!!j.leading,it="maxWait"in j,ie=it?Kn(la(j.maxWait)||0,y):ie,gt="trailing"in j?!!j.trailing:gt);function vt(Er){var qs=O,Hl=G;return O=G=t,et=Er,ye=m.apply(Hl,qs),ye}function $t(Er){return et=Er,_e=Fc(hn,y),nt?vt(Er):ye}function nn(Er){var qs=Er-Re,Hl=Er-et,hS=y-qs;return it?tr(hS,ie-Hl):hS}function zt(Er){var qs=Er-Re,Hl=Er-et;return Re===t||qs>=y||qs<0||it&&Hl>=ie}function hn(){var Er=Yf();if(zt(Er))return Nn(Er);_e=Fc(hn,nn(Er))}function Nn(Er){return _e=t,gt&&O?vt(Er):(O=G=t,ye)}function Aa(){_e!==t&&zg(_e),et=0,O=Re=G=_e=t}function Bi(){return _e===t?ye:Nn(Yf())}function Pa(){var Er=Yf(),qs=zt(Er);if(O=arguments,G=this,Re=Er,qs){if(_e===t)return $t(Re);if(it)return zg(_e),_e=Fc(hn,y),vt(Re)}return _e===t&&(_e=Fc(hn,y)),ye}return Pa.cancel=Aa,Pa.flush=Bi,Pa}var os=Yt(function(m,y){return Dl(m,1,y)}),gd=Yt(function(m,y,j){return Dl(m,la(y)||0,j)});function lv(m){return rs(m,J)}function yd(m,y){if(typeof m!="function"||y!=null&&typeof y!="function")throw new ri(l);var j=function(){var O=arguments,G=y?y.apply(this,O):O[0],ie=j.cache;if(ie.has(G))return ie.get(G);var ye=m.apply(this,O);return j.cache=ie.set(G,ye)||ie,ye};return j.cache=new(yd.Cache||pi),j}yd.Cache=pi;function xd(m){if(typeof m!="function")throw new ri(l);return function(){var y=arguments;switch(y.length){case 0:return!m.call(this);case 1:return!m.call(this,y[0]);case 2:return!m.call(this,y[0],y[1]);case 3:return!m.call(this,y[0],y[1],y[2])}return!m.apply(this,y)}}function Iy(m){return pd(2,m)}var Ry=$g(function(m,y){y=y.length==1&&Bt(y[0])?Gn(y[0],ti(kt())):Gn(ln(y,1),ti(kt()));var j=y.length;return Yt(function(O){for(var G=-1,ie=tr(O.length,j);++G<ie;)O[G]=y[G].call(this,O[G]);return Vr(m,this,O)})}),rm=Yt(function(m,y){var j=Ka(y,Ul(rm));return rs(m,F,t,y,j)}),Jf=Yt(function(m,y){var j=Ka(y,Ul(Jf));return rs(m,L,t,y,j)}),My=Xn(function(m,y){return rs(m,B,t,t,t,y)});function Oy(m,y){if(typeof m!="function")throw new ri(l);return y=y===t?y:Gt(y),Yt(m,y)}function cv(m,y){if(typeof m!="function")throw new ri(l);return y=y==null?0:Kn(Gt(y),0),Yt(function(j){var O=j[y],G=ko(j,0,y);return O&&Ji(G,O),Vr(m,this,G)})}function im(m,y,j){var O=!0,G=!0;if(typeof m!="function")throw new ri(l);return ir(j)&&(O="leading"in j?!!j.leading:O,G="trailing"in j?!!j.trailing:G),Fo(m,y,{leading:O,maxWait:y,trailing:G})}function am(m){return Dy(m,1)}function uv(m,y){return rm(Qu(y),m)}function dv(){if(!arguments.length)return[];var m=arguments[0];return Bt(m)?m:[m]}function bd(m){return Gr(m,v)}function fv(m,y){return y=typeof y=="function"?y:t,Gr(m,v,y)}function Ly(m){return Gr(m,g|v)}function sn(m,y){return y=typeof y=="function"?y:t,Gr(m,g|v,y)}function sm(m,y){return y==null||dp(m,y,Tr(y))}function wi(m,y){return m===y||m!==m&&y!==y}var om=zl($u),Fy=zl(function(m,y){return m>=y}),Us=mf(function(){return arguments}())?mf:function(m){return lr(m)&&ne.call(m,"callee")&&!Cl.call(m,"callee")},Bt=Ve.isArray,Kf=wn?ti(wn):mi;function jr(m){return m!=null&&Vl(m.length)&&!Ta(m)}function hr(m){return lr(m)&&jr(m)}function hv(m){return m===!0||m===!1||lr(m)&&fn(m)==se}var $o=lf||Lv,$y=yc?ti(yc):yr;function zy(m){return lr(m)&&m.nodeType===1&&!oa(m)}function Xf(m){if(m==null)return!0;if(jr(m)&&(Bt(m)||typeof m=="string"||typeof m.splice=="function"||$o(m)||Jc(m)||Us(m)))return!m.length;var y=Ir(m);if(y==Pe||y==be)return!m.size;if(Bn(m))return!xf(m).length;for(var j in m)if(ne.call(m,j))return!1;return!0}function On(m,y){return Ml(m,y)}function lm(m,y,j){j=typeof j=="function"?j:t;var O=j?j(m,y):t;return O===t?Ml(m,y,t,j):!!O}function kr(m){if(!lr(m))return!1;var y=fn(m);return y==X||y==We||typeof m.message=="string"&&typeof m.name=="string"&&!oa(m)}function pv(m){return typeof m=="number"&&Au(m)}function Ta(m){if(!ir(m))return!1;var y=fn(m);return y==Se||y==Ae||y==oe||y==ot}function Zf(m){return typeof m=="number"&&m==Gt(m)}function Vl(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=re}function ir(m){var y=typeof m;return m!=null&&(y=="object"||y=="function")}function lr(m){return m!=null&&typeof m=="object"}var eh=gl?ti(gl):gf;function cm(m,y){return m===y||Uu(m,y,Mf(y))}function mv(m,y,j){return j=typeof j=="function"?j:t,Uu(m,y,Mf(y),j)}function Uy(m){return qy(m)&&m!=+m}function gv(m){if(ad(m))throw new Dt(o);return ts(m)}function By(m){return m===null}function yv(m){return m==null}function qy(m){return typeof m=="number"||lr(m)&&fn(m)==Ze}function oa(m){if(!lr(m)||fn(m)!=lt)return!1;var y=ku(m);if(y===null)return!0;var j=ne.call(y,"constructor")&&y.constructor;return typeof j=="function"&&j instanceof j&&vo.call(j)==Je}var th=xc?ti(xc):yf;function um(m){return Zf(m)&&m>=-9007199254740991&&m<=re}var Vy=fo?ti(fo):gp;function nh(m){return typeof m=="string"||!Bt(m)&&lr(m)&&fn(m)==$e}function li(m){return typeof m=="symbol"||lr(m)&&fn(m)==Be}var Jc=ho?ti(ho):yp;function Ea(m){return m===t}function dm(m){return lr(m)&&Ir(m)==Ne}function Hy(m){return lr(m)&&fn(m)==K}var Gy=zl(bf),vd=zl(function(m,y){return m<=y});function Ui(m){if(!m)return[];if(jr(m))return nh(m)?ui(m):Cr(m);if(_l&&m[_l])return xo(m[_l]());var y=Ir(m),j=y==Pe?wl:y==be?Sl:nu;return j(m)}function ls(m){if(!m)return m===0?m:0;if(m=la(m),m===ae||m===-1/0){var y=m<0?-1:1;return y*le}return m===m?m:0}function Gt(m){var y=ls(m),j=y%1;return y===y?j?y-j:y:0}function cs(m){return m?_a(Gt(m),0,ce):0}function la(m){if(typeof m=="number")return m;if(li(m))return E;if(ir(m)){var y=typeof m.valueOf=="function"?m.valueOf():m;m=ir(y)?y+"":y}if(typeof m!="string")return m===0?m:+m;m=nf(m);var j=gr.test(m);return j||Wd.test(m)?Kd(m.slice(2),j?2:8):to.test(m)?E:+m}function Yy(m){return yi(m,Rr(m))}function Kc(m){return m?_a(Gt(m),-9007199254740991,re):m===0?m:0}function Tn(m){return m==null?"":gi(m)}var xv=Fl(function(m,y){if(Bn(y)||jr(y)){yi(y,Tr(y),m);return}for(var j in y)ne.call(y,j)&&Pl(m,j,y[j])}),Wy=Fl(function(m,y){yi(y,Rr(y),m)}),rh=Fl(function(m,y,j,O){yi(y,Rr(y),m,O)}),bv=Fl(function(m,y,j,O){yi(y,Tr(y),m,O)}),vv=Xn(Fu);function wv(m,y){var j=Mi(m);return y==null?j:As(j,y)}var Sv=Yt(function(m,y){m=dn(m);var j=-1,O=y.length,G=O>2?y[2]:t;for(G&&oi(y[0],y[1],G)&&(O=1);++j<O;)for(var ie=y[j],ye=Rr(ie),_e=-1,Re=ye.length;++_e<Re;){var et=ye[_e],nt=m[et];(nt===t||wi(nt,_s[et])&&!ne.call(m,et))&&(m[et]=ie[et])}return m}),Qy=Yt(function(m){return m.push(t,Rp),Vr(Cd,t,m)});function Xc(m,y){return Ss(m,kt(y,3),Yr)}function wd(m,y){return Ss(m,kt(y,3),Dc)}function Jy(m,y){return m==null?m:Pc(m,kt(y,3),Rr)}function Nv(m,y){return m==null?m:Il(m,kt(y,3),Rr)}function Zc(m,y){return m&&Yr(m,kt(y,3))}function Sd(m,y){return m&&Dc(m,kt(y,3))}function Ky(m){return m==null?[]:jo(m,Tr(m))}function ih(m){return m==null?[]:jo(m,Rr(m))}function Nd(m,y,j){var O=m==null?t:ra(m,y);return O===t?j:O}function fm(m,y){return m!=null&&id(m,y,hp)}function eu(m,y){return m!=null&&id(m,y,Ag)}var Xy=Xu(function(m,y,j){y!=null&&typeof y.toString!="function"&&(y=Ce.call(y)),m[y]=j},Le(Fe)),Zy=Xu(function(m,y,j){y!=null&&typeof y.toString!="function"&&(y=Ce.call(y)),ne.call(m,y)?m[y].push(j):m[y]=[j]},kt),Cv=Yt(Rl);function Tr(m){return jr(m)?up(m):xf(m)}function Rr(m){return jr(m)?up(m,!0):Dg(m)}function _v(m,y){var j={};return y=kt(y,3),Yr(m,function(O,G,ie){Ca(j,y(O,G,ie),O)}),j}function jv(m,y){var j={};return y=kt(y,3),Yr(m,function(O,G,ie){Ca(j,G,y(O,G,ie))}),j}var kv=Fl(function(m,y,j){Bu(m,y,j)}),Cd=Fl(function(m,y,j,O){Bu(m,y,j,O)}),ah=Xn(function(m,y){var j={};if(m==null)return j;var O=!1;y=Gn(y,function(ie){return ie=Is(ie,m),O||(O=ie.length>1),ie}),yi(m,If(m),j),O&&(j=Gr(j,g|b|v,Wg));for(var G=y.length;G--;)Gu(j,y[G]);return j});function hm(m,y){return tu(m,xd(kt(y)))}var Tv=Xn(function(m,y){return m==null?{}:Ig(m,y)});function tu(m,y){if(m==null)return{};var j=Gn(If(m),function(O){return[O]});return y=kt(y),wf(m,j,function(O,G){return y(O,G[0])})}function Ev(m,y,j){y=Is(y,m);var O=-1,G=y.length;for(G||(G=1,m=t);++O<G;){var ie=m==null?t:m[En(y[O])];ie===t&&(O=G,ie=j),m=Ta(ie)?ie.call(m):ie}return m}function ex(m,y,j){return m==null?m:Rc(m,y,j)}function tx(m,y,j,O){return O=typeof O=="function"?O:t,m==null?m:Rc(m,y,j,O)}var pm=td(Tr),mm=td(Rr);function gm(m,y,j){var O=Bt(m),G=O||$o(m)||Jc(m);if(y=kt(y,4),j==null){var ie=m&&m.constructor;G?j=O?new ie:[]:ir(m)?j=Ta(ie)?Mi(ku(m)):{}:j={}}return(G?Sr:Yr)(m,function(ye,_e,Re){return y(j,ye,_e,Re)}),j}function nx(m,y){return m==null?!0:Gu(m,y)}function sh(m,y,j){return m==null?m:jp(m,y,Qu(j))}function Av(m,y,j,O){return O=typeof O=="function"?O:t,m==null?m:jp(m,y,Qu(j),O)}function nu(m){return m==null?[]:vl(m,Tr(m))}function ym(m){return m==null?[]:vl(m,Rr(m))}function xm(m,y,j){return j===t&&(j=y,y=t),j!==t&&(j=la(j),j=j===j?j:0),y!==t&&(y=la(y),y=y===y?y:0),_a(la(m),y,j)}function oh(m,y,j){return y=ls(y),j===t?(j=y,y=0):j=ls(j),m=la(m),Pg(m,y,j)}function bm(m,y,j){if(j&&typeof j!="boolean"&&oi(m,y,j)&&(y=j=t),j===t&&(typeof y=="boolean"?(j=y,y=t):typeof m=="boolean"&&(j=m,m=t)),m===t&&y===t?(m=0,y=1):(m=ls(m),y===t?(y=m,m=0):y=ls(y)),m>y){var O=m;m=y,y=O}if(j||m%1||y%1){var G=ap();return tr(m+G*(y-m+co("1e-"+((G+"").length-1))),y)}return Nf(m,y)}var rx=si(function(m,y,j){return y=y.toLowerCase(),m+(j?lh(y):y)});function lh(m){return x(Tn(m).toLowerCase())}function Bs(m){return m=Tn(m),m&&m.replace(no,Ri).replace(Di,"")}function zo(m,y,j){m=Tn(m),y=gi(y);var O=m.length;j=j===t?O:_a(Gt(j),0,O);var G=j;return j-=y.length,j>=0&&m.slice(j,G)==y}function Uo(m){return m=Tn(m),m&&wt.test(m)?m.replace(gn,Ki):m}function _d(m){return m=Tn(m),m&&wr.test(m)?m.replace(yn,"\\$&"):m}var jd=si(function(m,y,j){return m+(j?"-":"")+y.toLowerCase()}),Bo=si(function(m,y,j){return m+(j?" ":"")+y.toLowerCase()}),Pv=Li("toLowerCase");function ix(m,y,j){m=Tn(m),y=Gt(y);var O=y?Xi(m):0;if(!y||O>=y)return m;var G=(y-O)/2;return ed(ks(G),j)+m+ed(jc(G),j)}function kd(m,y,j){m=Tn(m),y=Gt(y);var O=y?Xi(m):0;return y&&O<y?m+ed(y-O,j):m}function Dv(m,y,j){m=Tn(m),y=Gt(y);var O=y?Xi(m):0;return y&&O<y?ed(y-O,j)+m:m}function ax(m,y,j){return j||y==null?y=0:y&&(y=+y),kl(Tn(m).replace(Ei,""),y||0)}function ch(m,y,j){return(j?oi(m,y,j):y===t)?y=1:y=Gt(y),Cp(Tn(m),y)}function sx(){var m=arguments,y=Tn(m[0]);return m.length<3?y:y.replace(m[1],m[2])}var Iv=si(function(m,y,j){return m+(j?"_":"")+y.toLowerCase()});function uh(m,y,j){return j&&typeof j!="number"&&oi(m,y,j)&&(y=j=t),j=j===t?ce:j>>>0,j?(m=Tn(m),m&&(typeof y=="string"||y!=null&&!th(y))&&(y=gi(y),!y&&Sa(m))?ko(ui(m),0,j):m.split(y,j)):[]}var dh=si(function(m,y,j){return m+(j?" ":"")+x(y)});function ox(m,y,j){return m=Tn(m),j=j==null?0:_a(Gt(j),0,m.length),y=gi(y),m.slice(j,j+y.length)==y}function Td(m,y,j){var O=Z.templateSettings;j&&oi(m,y,j)&&(y=t),m=Tn(m),y=rh({},y,O,Pf);var G=rh({},y.imports,O.imports,Pf),ie=Tr(G),ye=vl(G,ie),_e,Re,et=0,nt=y.interpolate||nc,it="__p += '",gt=Cc((y.escape||nc).source+"|"+nt.source+"|"+(nt===St?Zs:nc).source+"|"+(y.evaluate||nc).source+"|$","g"),vt="//# sourceURL="+(ne.call(y,"sourceURL")?(y.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++pc+"]")+`
`;m.replace(gt,function(zt,hn,Nn,Aa,Bi,Pa){return Nn||(Nn=Aa),it+=m.slice(et,Pa).replace(Qd,Nu),hn&&(_e=!0,it+=`' +
__e(`+hn+`) +
'`),Bi&&(Re=!0,it+=`';
`+Bi+`;
__p += '`),Nn&&(it+=`' +
((__t = (`+Nn+`)) == null ? '' : __t) +
'`),et=Pa+zt.length,zt}),it+=`';
`;var $t=ne.call(y,"variable")&&y.variable;if(!$t)it=`with (obj) {
`+it+`
}
`;else if(tc.test($t))throw new Dt(d);it=(Re?it.replace(st,""):it).replace(yt,"$1").replace(_t,"$1;"),it="function("+($t||"obj")+`) {
`+($t?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(_e?", __e = _.escape":"")+(Re?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+it+`return __p
}`;var nn=P(function(){return un(ie,vt+"return "+it).apply(t,ye)});if(nn.source=it,kr(nn))throw nn;return nn}function vm(m){return Tn(m).toLowerCase()}function fh(m){return Tn(m).toUpperCase()}function lx(m,y,j){if(m=Tn(m),m&&(j||y===t))return nf(m);if(!m||!(y=gi(y)))return m;var O=ui(m),G=ui(y),ie=wa(O,G),ye=yo(O,G)+1;return ko(O,ie,ye).join("")}function Rv(m,y,j){if(m=Tn(m),m&&(j||y===t))return m.slice(0,ju(m)+1);if(!m||!(y=gi(y)))return m;var O=ui(m),G=yo(O,ui(y))+1;return ko(O,0,G).join("")}function hh(m,y,j){if(m=Tn(m),m&&(j||y===t))return m.replace(Ei,"");if(!m||!(y=gi(y)))return m;var O=ui(m),G=wa(O,ui(y));return ko(O,G).join("")}function s(m,y){var j=D,O=$;if(ir(y)){var G="separator"in y?y.separator:G;j="length"in y?Gt(y.length):j,O="omission"in y?gi(y.omission):O}m=Tn(m);var ie=m.length;if(Sa(m)){var ye=ui(m);ie=ye.length}if(j>=ie)return m;var _e=j-Xi(O);if(_e<1)return O;var Re=ye?ko(ye,0,_e).join(""):m.slice(0,_e);if(G===t)return Re+O;if(ye&&(_e+=Re.length-_e),th(G)){if(m.slice(_e).search(G)){var et,nt=Re;for(G.global||(G=Cc(G.source,Tn(eo.exec(G))+"g")),G.lastIndex=0;et=G.exec(nt);)var it=et.index;Re=Re.slice(0,it===t?_e:it)}}else if(m.indexOf(gi(G),_e)!=_e){var gt=Re.lastIndexOf(G);gt>-1&&(Re=Re.slice(0,gt))}return Re+O}function c(m){return m=Tn(m),m&&Cn.test(m)?m.replace(cn,Cs):m}var h=si(function(m,y,j){return m+(j?" ":"")+y.toUpperCase()}),x=Li("toUpperCase");function N(m,y,j){return m=Tn(m),y=j?t:y,y===t?Cu(m)?np(m):po(m):m.match(y)||[]}var P=Yt(function(m,y){try{return Vr(m,t,y)}catch(j){return kr(j)?j:new Dt(j)}}),q=Xn(function(m,y){return Sr(y,function(j){j=En(j),Ca(m,j,Lo(m[j],m))}),m});function ee(m){var y=m==null?0:m.length,j=kt();return m=y?Gn(m,function(O){if(typeof O[1]!="function")throw new ri(l);return[j(O[0]),O[1]]}):[],Yt(function(O){for(var G=-1;++G<y;){var ie=m[G];if(Vr(ie[0],this,O))return Vr(ie[1],this,O)}})}function ve(m){return Tg(Gr(m,g))}function Le(m){return function(){return m}}function Ke(m,y){return m==null||m!==m?y:m}var tt=ns(),Ue=ns(!0);function Fe(m){return m}function Rt(m){return xp(typeof m=="function"?m:Gr(m,g))}function It(m){return vp(Gr(m,g))}function Ln(m,y){return vf(m,Gr(y,g))}var Ie=Yt(function(m,y){return function(j){return Rl(j,m,y)}}),Te=Yt(function(m,y){return function(j){return Rl(m,j,y)}});function Oe(m,y,j){var O=Tr(y),G=jo(y,O);j==null&&!(ir(y)&&(G.length||!O.length))&&(j=y,y=m,m=this,G=jo(y,Tr(y)));var ie=!(ir(j)&&"chain"in j)||!!j.chain,ye=Ta(m);return Sr(G,function(_e){var Re=y[_e];m[_e]=Re,ye&&(m.prototype[_e]=function(){var et=this.__chain__;if(ie||et){var nt=m(this.__wrapped__),it=nt.__actions__=Cr(this.__actions__);return it.push({func:Re,args:arguments,thisArg:m}),nt.__chain__=et,nt}return Re.apply(m,Ji([this.value()],arguments))})}),m}function Xe(){return Hn._===this&&(Hn._=ht),this}function xt(){}function tn(m){return m=Gt(m),Yt(function(y){return wp(y,m)})}var Nt=Zu(Gn),Mt=Zu(bc),Mr=Zu(Ya);function Sn(m){return Lf(m)?bl(En(m)):Rg(m)}function qo(m){return function(y){return m==null?t:ra(m,y)}}var Mv=To(),$A=To(!0);function Ov(){return[]}function Lv(){return!1}function zA(){return{}}function UA(){return""}function BA(){return!0}function qA(m,y){if(m=Gt(m),m<1||m>re)return[];var j=ce,O=tr(m,ce);y=kt(y),m-=ce;for(var G=Qa(O,y);++j<m;)y(j);return G}function VA(m){return Bt(m)?Gn(m,En):li(m)?[m]:Cr(as(Tn(m)))}function HA(m){var y=++me;return Tn(m)+y}var GA=Mc(function(m,y){return m+y},0),YA=Af("ceil"),WA=Mc(function(m,y){return m/y},1),QA=Af("floor");function JA(m){return m&&m.length?ja(m,Fe,$u):t}function KA(m,y){return m&&m.length?ja(m,kt(y,2),$u):t}function XA(m){return xl(m,Fe)}function ZA(m,y){return xl(m,kt(y,2))}function eP(m){return m&&m.length?ja(m,Fe,bf):t}function tP(m,y){return m&&m.length?ja(m,kt(y,2),bf):t}var nP=Mc(function(m,y){return m*y},1),rP=Af("round"),iP=Mc(function(m,y){return m-y},0);function aP(m){return m&&m.length?Sc(m,Fe):0}function sP(m,y){return m&&m.length?Sc(m,kt(y,2)):0}return Z.after=ov,Z.ary=Dy,Z.assign=xv,Z.assignIn=Wy,Z.assignInWith=rh,Z.assignWith=bv,Z.at=vv,Z.before=pd,Z.bind=Lo,Z.bindAll=q,Z.bindKey=Wf,Z.castArray=dv,Z.chain=Yc,Z.chunk=ev,Z.compact=ay,Z.concat=sy,Z.cond=ee,Z.conforms=ve,Z.constant=Le,Z.countBy=Wc,Z.create=wv,Z.curry=md,Z.curryRight=Qf,Z.debounce=Fo,Z.defaults=Sv,Z.defaultsDeep=Qy,Z.defer=os,Z.delay=gd,Z.difference=rr,Z.differenceBy=xi,Z.differenceWith=Fs,Z.drop=oy,Z.dropRight=ly,Z.dropRightWhile=tv,Z.dropWhile=zp,Z.fill=Fi,Z.filter=vy,Z.flatMap=em,Z.flatMapDeep=iv,Z.flatMapDepth=av,Z.flatten=bi,Z.flattenDeep=cy,Z.flattenDepth=Po,Z.flip=lv,Z.flow=tt,Z.flowRight=Ue,Z.fromPairs=Bl,Z.functions=Ky,Z.functionsIn=ih,Z.groupBy=Ny,Z.initial=qp,Z.intersection=ss,Z.intersectionBy=uy,Z.intersectionWith=$c,Z.invert=Xy,Z.invertBy=Zy,Z.invokeMap=Hf,Z.iteratee=Rt,Z.keyBy=Cy,Z.keys=Tr,Z.keysIn=Rr,Z.map=hd,Z.mapKeys=_v,Z.mapValues=jv,Z.matches=It,Z.matchesProperty=Ln,Z.memoize=yd,Z.merge=kv,Z.mergeWith=Cd,Z.method=Ie,Z.methodOf=Te,Z.mixin=Oe,Z.negate=xd,Z.nthArg=tn,Z.omit=ah,Z.omitBy=hm,Z.once=Iy,Z.orderBy=_y,Z.over=Nt,Z.overArgs=Ry,Z.overEvery=Mt,Z.overSome=Mr,Z.partial=rm,Z.partialRight=Jf,Z.partition=jy,Z.pick=Tv,Z.pickBy=tu,Z.property=Sn,Z.propertyOf=qo,Z.pull=fy,Z.pullAll=Uc,Z.pullAllBy=hy,Z.pullAllWith=qf,Z.pullAt=py,Z.range=Mv,Z.rangeRight=$A,Z.rearg=My,Z.reject=Gf,Z.remove=nv,Z.rest=Oy,Z.reverse=Vp,Z.sampleSize=Ay,Z.set=ex,Z.setWith=tx,Z.shuffle=qn,Z.slice=Pn,Z.sortBy=Py,Z.sortedUniq=Bc,Z.sortedUniqBy=Hp,Z.split=uh,Z.spread=cv,Z.tail=zs,Z.take=fr,Z.takeRight=Io,Z.takeRightWhile=ql,Z.takeWhile=Gp,Z.tap=Kp,Z.throttle=im,Z.thru=Qr,Z.toArray=Ui,Z.toPairs=pm,Z.toPairsIn=mm,Z.toPath=VA,Z.toPlainObject=Yy,Z.transform=gm,Z.unary=am,Z.union=sa,Z.unionBy=qc,Z.unionWith=dd,Z.uniq=vi,Z.uniqBy=Yp,Z.uniqWith=Wp,Z.unset=nx,Z.unzip=Vc,Z.unzipWith=fd,Z.update=sh,Z.updateWith=Av,Z.values=nu,Z.valuesIn=ym,Z.without=Ro,Z.words=N,Z.wrap=uv,Z.xor=zr,Z.xorBy=Mo,Z.xorWith=Hc,Z.zip=Gc,Z.zipObject=Qp,Z.zipObjectDeep=Jp,Z.zipWith=my,Z.entries=pm,Z.entriesIn=mm,Z.extend=Wy,Z.extendWith=rh,Oe(Z,Z),Z.add=GA,Z.attempt=P,Z.camelCase=rx,Z.capitalize=lh,Z.ceil=YA,Z.clamp=xm,Z.clone=bd,Z.cloneDeep=Ly,Z.cloneDeepWith=sn,Z.cloneWith=fv,Z.conformsTo=sm,Z.deburr=Bs,Z.defaultTo=Ke,Z.divide=WA,Z.endsWith=zo,Z.eq=wi,Z.escape=Uo,Z.escapeRegExp=_d,Z.every=by,Z.find=wy,Z.findIndex=aa,Z.findKey=Xc,Z.findLast=Zp,Z.findLastIndex=Up,Z.findLastKey=wd,Z.floor=QA,Z.forEach=Sy,Z.forEachRight=tm,Z.forIn=Jy,Z.forInRight=Nv,Z.forOwn=Zc,Z.forOwnRight=Sd,Z.get=Nd,Z.gt=om,Z.gte=Fy,Z.has=fm,Z.hasIn=eu,Z.head=$s,Z.identity=Fe,Z.includes=Qc,Z.indexOf=Bp,Z.inRange=oh,Z.invoke=Cv,Z.isArguments=Us,Z.isArray=Bt,Z.isArrayBuffer=Kf,Z.isArrayLike=jr,Z.isArrayLikeObject=hr,Z.isBoolean=hv,Z.isBuffer=$o,Z.isDate=$y,Z.isElement=zy,Z.isEmpty=Xf,Z.isEqual=On,Z.isEqualWith=lm,Z.isError=kr,Z.isFinite=pv,Z.isFunction=Ta,Z.isInteger=Zf,Z.isLength=Vl,Z.isMap=eh,Z.isMatch=cm,Z.isMatchWith=mv,Z.isNaN=Uy,Z.isNative=gv,Z.isNil=yv,Z.isNull=By,Z.isNumber=qy,Z.isObject=ir,Z.isObjectLike=lr,Z.isPlainObject=oa,Z.isRegExp=th,Z.isSafeInteger=um,Z.isSet=Vy,Z.isString=nh,Z.isSymbol=li,Z.isTypedArray=Jc,Z.isUndefined=Ea,Z.isWeakMap=dm,Z.isWeakSet=Hy,Z.join=ud,Z.kebabCase=jd,Z.last=Wr,Z.lastIndexOf=zc,Z.lowerCase=Bo,Z.lowerFirst=Pv,Z.lt=Gy,Z.lte=vd,Z.max=JA,Z.maxBy=KA,Z.mean=XA,Z.meanBy=ZA,Z.min=eP,Z.minBy=tP,Z.stubArray=Ov,Z.stubFalse=Lv,Z.stubObject=zA,Z.stubString=UA,Z.stubTrue=BA,Z.multiply=nP,Z.nth=dy,Z.noConflict=Xe,Z.noop=xt,Z.now=Yf,Z.pad=ix,Z.padEnd=kd,Z.padStart=Dv,Z.parseInt=ax,Z.random=bm,Z.reduce=ky,Z.reduceRight=Ty,Z.repeat=ch,Z.replace=sx,Z.result=Ev,Z.round=rP,Z.runInContext=Ee,Z.sample=Ey,Z.size=nm,Z.snakeCase=Iv,Z.some=sv,Z.sortedIndex=Wn,Z.sortedIndexBy=an,Z.sortedIndexOf=bn,Z.sortedLastIndex=Dn,Z.sortedLastIndexBy=$i,Z.sortedLastIndexOf=Do,Z.startCase=dh,Z.startsWith=ox,Z.subtract=iP,Z.sum=aP,Z.sumBy=sP,Z.template=Td,Z.times=qA,Z.toFinite=ls,Z.toInteger=Gt,Z.toLength=cs,Z.toLower=vm,Z.toNumber=la,Z.toSafeInteger=Kc,Z.toString=Tn,Z.toUpper=fh,Z.trim=lx,Z.trimEnd=Rv,Z.trimStart=hh,Z.truncate=s,Z.unescape=c,Z.uniqueId=HA,Z.upperCase=h,Z.upperFirst=x,Z.each=Sy,Z.eachRight=tm,Z.first=$s,Oe(Z,function(){var m={};return Yr(Z,function(y,j){ne.call(Z.prototype,j)||(m[j]=y)}),m}(),{chain:!1}),Z.VERSION=r,Sr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(m){Z[m].placeholder=Z}),Sr(["drop","take"],function(m,y){en.prototype[m]=function(j){j=j===t?1:Kn(Gt(j),0);var O=this.__filtered__&&!y?new en(this):this.clone();return O.__filtered__?O.__takeCount__=tr(j,O.__takeCount__):O.__views__.push({size:tr(j,ce),type:m+(O.__dir__<0?"Right":"")}),O},en.prototype[m+"Right"]=function(j){return this.reverse()[m](j).reverse()}}),Sr(["filter","map","takeWhile"],function(m,y){var j=y+1,O=j==Q||j==V;en.prototype[m]=function(G){var ie=this.clone();return ie.__iteratees__.push({iteratee:kt(G,3),type:j}),ie.__filtered__=ie.__filtered__||O,ie}}),Sr(["head","last"],function(m,y){var j="take"+(y?"Right":"");en.prototype[m]=function(){return this[j](1).value()[0]}}),Sr(["initial","tail"],function(m,y){var j="drop"+(y?"":"Right");en.prototype[m]=function(){return this.__filtered__?new en(this):this[j](1)}}),en.prototype.compact=function(){return this.filter(Fe)},en.prototype.find=function(m){return this.filter(m).head()},en.prototype.findLast=function(m){return this.reverse().find(m)},en.prototype.invokeMap=Yt(function(m,y){return typeof m=="function"?new en(this):this.map(function(j){return Rl(j,m,y)})}),en.prototype.reject=function(m){return this.filter(xd(kt(m)))},en.prototype.slice=function(m,y){m=Gt(m);var j=this;return j.__filtered__&&(m>0||y<0)?new en(j):(m<0?j=j.takeRight(-m):m&&(j=j.drop(m)),y!==t&&(y=Gt(y),j=y<0?j.dropRight(-y):j.take(y-m)),j)},en.prototype.takeRightWhile=function(m){return this.reverse().takeWhile(m).reverse()},en.prototype.toArray=function(){return this.take(ce)},Yr(en.prototype,function(m,y){var j=/^(?:filter|find|map|reject)|While$/.test(y),O=/^(?:head|last)$/.test(y),G=Z[O?"take"+(y=="last"?"Right":""):y],ie=O||/^find/.test(y);G&&(Z.prototype[y]=function(){var ye=this.__wrapped__,_e=O?[1]:arguments,Re=ye instanceof en,et=_e[0],nt=Re||Bt(ye),it=function(hn){var Nn=G.apply(Z,Ji([hn],_e));return O&&gt?Nn[0]:Nn};nt&&j&&typeof et=="function"&&et.length!=1&&(Re=nt=!1);var gt=this.__chain__,vt=!!this.__actions__.length,$t=ie&&!gt,nn=Re&&!vt;if(!ie&&nt){ye=nn?ye:new en(this);var zt=m.apply(ye,_e);return zt.__actions__.push({func:Qr,args:[it],thisArg:t}),new hi(zt,gt)}return $t&&nn?m.apply(this,_e):(zt=this.thru(it),$t?O?zt.value()[0]:zt.value():zt)})}),Sr(["pop","push","shift","sort","splice","unshift"],function(m){var y=_c[m],j=/^(?:push|sort|unshift)$/.test(m)?"tap":"thru",O=/^(?:pop|shift)$/.test(m);Z.prototype[m]=function(){var G=arguments;if(O&&!this.__chain__){var ie=this.value();return y.apply(Bt(ie)?ie:[],G)}return this[j](function(ye){return y.apply(Bt(ye)?ye:[],G)})}}),Yr(en.prototype,function(m,y){var j=Z[y];if(j){var O=j.name+"";ne.call(ta,O)||(ta[O]=[]),ta[O].push({name:y,func:j})}}),ta[dr(t,A).name]=[{name:"wrapper",func:t}],en.prototype.clone=Ru,en.prototype.reverse=cf,en.prototype.value=El,Z.prototype.at=gy,Z.prototype.chain=zi,Z.prototype.commit=yy,Z.prototype.next=xy,Z.prototype.plant=Oo,Z.prototype.reverse=Vf,Z.prototype.toJSON=Z.prototype.valueOf=Z.prototype.value=Xp,Z.prototype.first=Z.prototype.head,_l&&(Z.prototype[_l]=rv),Z},Za=Xa();Ga?((Ga.exports=Za)._=Za,ba._=Za):Hn._=Za}).call(xH)}($m,$m.exports)),$m.exports}var $T=bH();class vH{constructor(n){Qn(this,"sampleRate",24e3);Qn(this,"bufferSize",7680);Qn(this,"audioQueue",[]);Qn(this,"isPlaying",!1);Qn(this,"isStreamComplete",!1);Qn(this,"checkInterval",null);Qn(this,"scheduledTime",0);Qn(this,"initialBufferTime",.1);Qn(this,"gainNode");Qn(this,"source");Qn(this,"endOfQueueAudioSource",null);Qn(this,"onComplete",()=>{});this.context=n,this.gainNode=this.context.createGain(),this.source=this.context.createBufferSource(),this.gainNode.connect(this.context.destination),this.addPCM16=this.addPCM16.bind(this)}async addWorklet(n,t,r){let a=_x.get(this.context);if(a&&a[n])return a[n].handlers.push(r),Promise.resolve(this);a||(_x.set(this.context,{}),a=_x.get(this.context)),a[n]={handlers:[r]};const o=D1(n,t);await this.context.audioWorklet.addModule(o);const l=new AudioWorkletNode(this.context,n);return a[n].node=l,this}_processPCM16Chunk(n){const t=new Float32Array(n.length/2),r=new DataView(n.buffer);for(let a=0;a<n.length/2;a++)try{const o=r.getInt16(a*2,!0);t[a]=o/32768}catch(o){console.error(o)}return t}addPCM16(n){this.isStreamComplete=!1;let t=this._processPCM16Chunk(n);for(;t.length>=this.bufferSize;){const r=t.slice(0,this.bufferSize);this.audioQueue.push(r),t=t.slice(this.bufferSize)}t.length>0&&this.audioQueue.push(t),this.isPlaying||(this.isPlaying=!0,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.scheduleNextBuffer())}createAudioBuffer(n){const t=this.context.createBuffer(1,n.length,this.sampleRate);return t.getChannelData(0).set(n),t}scheduleNextBuffer(){for(;this.audioQueue.length>0&&this.scheduledTime<this.context.currentTime+.2;){const t=this.audioQueue.shift(),r=this.createAudioBuffer(t),a=this.context.createBufferSource();this.audioQueue.length===0&&(this.endOfQueueAudioSource&&(this.endOfQueueAudioSource.onended=null),this.endOfQueueAudioSource=a,a.onended=()=>{!this.audioQueue.length&&this.endOfQueueAudioSource===a&&(this.endOfQueueAudioSource=null,this.onComplete())}),a.buffer=r,a.connect(this.gainNode);const o=_x.get(this.context);o&&Object.entries(o).forEach(([,d])=>{const{node:f,handlers:u}=d;f&&(a.connect(f),f.port.onmessage=function(p){u.forEach(g=>{g.call(f.port,p)})},f.connect(this.context.destination))});const l=Math.max(this.scheduledTime,this.context.currentTime);a.start(l),this.scheduledTime=l+r.duration}if(this.audioQueue.length===0)this.isStreamComplete?(this.isPlaying=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)):this.checkInterval||(this.checkInterval=window.setInterval(()=>{this.audioQueue.length>0&&this.scheduleNextBuffer()},100));else{const t=(this.scheduledTime-this.context.currentTime)*1e3;setTimeout(()=>this.scheduleNextBuffer(),Math.max(0,t-50))}}stop(){this.isPlaying=!1,this.isStreamComplete=!0,this.audioQueue=[],this.scheduledTime=this.context.currentTime,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.gainNode.gain.linearRampToValueAtTime(0,this.context.currentTime+.1),setTimeout(()=>{this.gainNode.disconnect(),this.gainNode=this.context.createGain(),this.gainNode.connect(this.context.destination)},200)}async resume(){this.context.state==="suspended"&&await this.context.resume(),this.isStreamComplete=!1,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.gainNode.gain.setValueAtTime(1,this.context.currentTime)}complete(){this.isStreamComplete=!0,this.onComplete()}}function zT(e,n){return function(){return e.apply(n,arguments)}}const{toString:wH}=Object.prototype,{getPrototypeOf:Hw}=Object,Fb=(e=>n=>{const t=wH.call(n);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Ks=e=>(e=e.toLowerCase(),n=>Fb(n)===e),$b=e=>n=>typeof n===e,{isArray:Gh}=Array,tg=$b("undefined");function SH(e){return e!==null&&!tg(e)&&e.constructor!==null&&!tg(e.constructor)&&Fa(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const UT=Ks("ArrayBuffer");function NH(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&UT(e.buffer),n}const CH=$b("string"),Fa=$b("function"),BT=$b("number"),zb=e=>e!==null&&typeof e=="object",_H=e=>e===!0||e===!1,qx=e=>{if(Fb(e)!=="object")return!1;const n=Hw(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},jH=Ks("Date"),kH=Ks("File"),TH=Ks("Blob"),EH=Ks("FileList"),AH=e=>zb(e)&&Fa(e.pipe),PH=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||Fa(e.append)&&((n=Fb(e))==="formdata"||n==="object"&&Fa(e.toString)&&e.toString()==="[object FormData]"))},DH=Ks("URLSearchParams"),[IH,RH,MH,OH]=["ReadableStream","Request","Response","Headers"].map(Ks),LH=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function fg(e,n,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let r,a;if(typeof e!="object"&&(e=[e]),Gh(e))for(r=0,a=e.length;r<a;r++)n.call(null,e[r],r,e);else{const o=t?Object.getOwnPropertyNames(e):Object.keys(e),l=o.length;let d;for(r=0;r<l;r++)d=o[r],n.call(null,e[d],d,e)}}function qT(e,n){n=n.toLowerCase();const t=Object.keys(e);let r=t.length,a;for(;r-- >0;)if(a=t[r],n===a.toLowerCase())return a;return null}const Id=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,VT=e=>!tg(e)&&e!==Id;function I1(){const{caseless:e}=VT(this)&&this||{},n={},t=(r,a)=>{const o=e&&qT(n,a)||a;qx(n[o])&&qx(r)?n[o]=I1(n[o],r):qx(r)?n[o]=I1({},r):Gh(r)?n[o]=r.slice():n[o]=r};for(let r=0,a=arguments.length;r<a;r++)arguments[r]&&fg(arguments[r],t);return n}const FH=(e,n,t,{allOwnKeys:r}={})=>(fg(n,(a,o)=>{t&&Fa(a)?e[o]=zT(a,t):e[o]=a},{allOwnKeys:r}),e),$H=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),zH=(e,n,t,r)=>{e.prototype=Object.create(n.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),t&&Object.assign(e.prototype,t)},UH=(e,n,t,r)=>{let a,o,l;const d={};if(n=n||{},e==null)return n;do{for(a=Object.getOwnPropertyNames(e),o=a.length;o-- >0;)l=a[o],(!r||r(l,e,n))&&!d[l]&&(n[l]=e[l],d[l]=!0);e=t!==!1&&Hw(e)}while(e&&(!t||t(e,n))&&e!==Object.prototype);return n},BH=(e,n,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=n.length;const r=e.indexOf(n,t);return r!==-1&&r===t},qH=e=>{if(!e)return null;if(Gh(e))return e;let n=e.length;if(!BT(n))return null;const t=new Array(n);for(;n-- >0;)t[n]=e[n];return t},VH=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&Hw(Uint8Array)),HH=(e,n)=>{const r=(e&&e[Symbol.iterator]).call(e);let a;for(;(a=r.next())&&!a.done;){const o=a.value;n.call(e,o[0],o[1])}},GH=(e,n)=>{let t;const r=[];for(;(t=e.exec(n))!==null;)r.push(t);return r},YH=Ks("HTMLFormElement"),WH=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,a){return r.toUpperCase()+a}),x_=(({hasOwnProperty:e})=>(n,t)=>e.call(n,t))(Object.prototype),QH=Ks("RegExp"),HT=(e,n)=>{const t=Object.getOwnPropertyDescriptors(e),r={};fg(t,(a,o)=>{let l;(l=n(a,o,e))!==!1&&(r[o]=l||a)}),Object.defineProperties(e,r)},JH=e=>{HT(e,(n,t)=>{if(Fa(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=e[t];if(Fa(r)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},KH=(e,n)=>{const t={},r=a=>{a.forEach(o=>{t[o]=!0})};return Gh(e)?r(e):r(String(e).split(n)),t},XH=()=>{},ZH=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n;function eG(e){return!!(e&&Fa(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const tG=e=>{const n=new Array(10),t=(r,a)=>{if(zb(r)){if(n.indexOf(r)>=0)return;if(!("toJSON"in r)){n[a]=r;const o=Gh(r)?[]:{};return fg(r,(l,d)=>{const f=t(l,a+1);!tg(f)&&(o[d]=f)}),n[a]=void 0,o}}return r};return t(e,0)},nG=Ks("AsyncFunction"),rG=e=>e&&(zb(e)||Fa(e))&&Fa(e.then)&&Fa(e.catch),GT=((e,n)=>e?setImmediate:n?((t,r)=>(Id.addEventListener("message",({source:a,data:o})=>{a===Id&&o===t&&r.length&&r.shift()()},!1),a=>{r.push(a),Id.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Fa(Id.postMessage)),iG=typeof queueMicrotask<"u"?queueMicrotask.bind(Id):typeof process<"u"&&process.nextTick||GT,Ge={isArray:Gh,isArrayBuffer:UT,isBuffer:SH,isFormData:PH,isArrayBufferView:NH,isString:CH,isNumber:BT,isBoolean:_H,isObject:zb,isPlainObject:qx,isReadableStream:IH,isRequest:RH,isResponse:MH,isHeaders:OH,isUndefined:tg,isDate:jH,isFile:kH,isBlob:TH,isRegExp:QH,isFunction:Fa,isStream:AH,isURLSearchParams:DH,isTypedArray:VH,isFileList:EH,forEach:fg,merge:I1,extend:FH,trim:LH,stripBOM:$H,inherits:zH,toFlatObject:UH,kindOf:Fb,kindOfTest:Ks,endsWith:BH,toArray:qH,forEachEntry:HH,matchAll:GH,isHTMLForm:YH,hasOwnProperty:x_,hasOwnProp:x_,reduceDescriptors:HT,freezeMethods:JH,toObjectSet:KH,toCamelCase:WH,noop:XH,toFiniteNumber:ZH,findKey:qT,global:Id,isContextDefined:VT,isSpecCompliantForm:eG,toJSONObject:tG,isAsyncFn:nG,isThenable:rG,setImmediate:GT,asap:iG};function Qt(e,n,t,r,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),t&&(this.config=t),r&&(this.request=r),a&&(this.response=a,this.status=a.status?a.status:null)}Ge.inherits(Qt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ge.toJSONObject(this.config),code:this.code,status:this.status}}});const YT=Qt.prototype,WT={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{WT[e]={value:e}});Object.defineProperties(Qt,WT);Object.defineProperty(YT,"isAxiosError",{value:!0});Qt.from=(e,n,t,r,a,o)=>{const l=Object.create(YT);return Ge.toFlatObject(e,l,function(f){return f!==Error.prototype},d=>d!=="isAxiosError"),Qt.call(l,e.message,n,t,r,a),l.cause=e,l.name=e.name,o&&Object.assign(l,o),l};const aG=null;function R1(e){return Ge.isPlainObject(e)||Ge.isArray(e)}function QT(e){return Ge.endsWith(e,"[]")?e.slice(0,-2):e}function b_(e,n,t){return e?e.concat(n).map(function(a,o){return a=QT(a),!t&&o?"["+a+"]":a}).join(t?".":""):n}function sG(e){return Ge.isArray(e)&&!e.some(R1)}const oG=Ge.toFlatObject(Ge,{},null,function(n){return/^is[A-Z]/.test(n)});function Ub(e,n,t){if(!Ge.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,t=Ge.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(k,T){return!Ge.isUndefined(T[k])});const r=t.metaTokens,a=t.visitor||p,o=t.dots,l=t.indexes,f=(t.Blob||typeof Blob<"u"&&Blob)&&Ge.isSpecCompliantForm(n);if(!Ge.isFunction(a))throw new TypeError("visitor must be a function");function u(S){if(S===null)return"";if(Ge.isDate(S))return S.toISOString();if(!f&&Ge.isBlob(S))throw new Qt("Blob is not supported. Use a Buffer instead.");return Ge.isArrayBuffer(S)||Ge.isTypedArray(S)?f&&typeof Blob=="function"?new Blob([S]):Buffer.from(S):S}function p(S,k,T){let A=S;if(S&&!T&&typeof S=="object"){if(Ge.endsWith(k,"{}"))k=r?k:k.slice(0,-2),S=JSON.stringify(S);else if(Ge.isArray(S)&&sG(S)||(Ge.isFileList(S)||Ge.endsWith(k,"[]"))&&(A=Ge.toArray(S)))return k=QT(k),A.forEach(function(R,z){!(Ge.isUndefined(R)||R===null)&&n.append(l===!0?b_([k],z,o):l===null?k:k+"[]",u(R))}),!1}return R1(S)?!0:(n.append(b_(T,k,o),u(S)),!1)}const g=[],b=Object.assign(oG,{defaultVisitor:p,convertValue:u,isVisitable:R1});function v(S,k){if(!Ge.isUndefined(S)){if(g.indexOf(S)!==-1)throw Error("Circular reference detected in "+k.join("."));g.push(S),Ge.forEach(S,function(A,M){(!(Ge.isUndefined(A)||A===null)&&a.call(n,A,Ge.isString(M)?M.trim():M,k,b))===!0&&v(A,k?k.concat(M):[M])}),g.pop()}}if(!Ge.isObject(e))throw new TypeError("data must be an object");return v(e),n}function v_(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return n[r]})}function Gw(e,n){this._pairs=[],e&&Ub(e,this,n)}const JT=Gw.prototype;JT.append=function(n,t){this._pairs.push([n,t])};JT.toString=function(n){const t=n?function(r){return n.call(this,r,v_)}:v_;return this._pairs.map(function(a){return t(a[0])+"="+t(a[1])},"").join("&")};function lG(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function KT(e,n,t){if(!n)return e;const r=t&&t.encode||lG;Ge.isFunction(t)&&(t={serialize:t});const a=t&&t.serialize;let o;if(a?o=a(n,t):o=Ge.isURLSearchParams(n)?n.toString():new Gw(n,t).toString(r),o){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class w_{constructor(){this.handlers=[]}use(n,t,r){return this.handlers.push({fulfilled:n,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){Ge.forEach(this.handlers,function(r){r!==null&&n(r)})}}const XT={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},cG=typeof URLSearchParams<"u"?URLSearchParams:Gw,uG=typeof FormData<"u"?FormData:null,dG=typeof Blob<"u"?Blob:null,fG={isBrowser:!0,classes:{URLSearchParams:cG,FormData:uG,Blob:dG},protocols:["http","https","file","blob","url","data"]},Yw=typeof window<"u"&&typeof document<"u",M1=typeof navigator=="object"&&navigator||void 0,hG=Yw&&(!M1||["ReactNative","NativeScript","NS"].indexOf(M1.product)<0),pG=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",mG=Yw&&window.location.href||"http://localhost",gG=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Yw,hasStandardBrowserEnv:hG,hasStandardBrowserWebWorkerEnv:pG,navigator:M1,origin:mG},Symbol.toStringTag,{value:"Module"})),_i={...gG,...fG};function yG(e,n){return Ub(e,new _i.classes.URLSearchParams,Object.assign({visitor:function(t,r,a,o){return _i.isNode&&Ge.isBuffer(t)?(this.append(r,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},n))}function xG(e){return Ge.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function bG(e){const n={},t=Object.keys(e);let r;const a=t.length;let o;for(r=0;r<a;r++)o=t[r],n[o]=e[o];return n}function ZT(e){function n(t,r,a,o){let l=t[o++];if(l==="__proto__")return!0;const d=Number.isFinite(+l),f=o>=t.length;return l=!l&&Ge.isArray(a)?a.length:l,f?(Ge.hasOwnProp(a,l)?a[l]=[a[l],r]:a[l]=r,!d):((!a[l]||!Ge.isObject(a[l]))&&(a[l]=[]),n(t,r,a[l],o)&&Ge.isArray(a[l])&&(a[l]=bG(a[l])),!d)}if(Ge.isFormData(e)&&Ge.isFunction(e.entries)){const t={};return Ge.forEachEntry(e,(r,a)=>{n(xG(r),a,t,0)}),t}return null}function vG(e,n,t){if(Ge.isString(e))try{return(n||JSON.parse)(e),Ge.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(e)}const hg={transitional:XT,adapter:["xhr","http","fetch"],transformRequest:[function(n,t){const r=t.getContentType()||"",a=r.indexOf("application/json")>-1,o=Ge.isObject(n);if(o&&Ge.isHTMLForm(n)&&(n=new FormData(n)),Ge.isFormData(n))return a?JSON.stringify(ZT(n)):n;if(Ge.isArrayBuffer(n)||Ge.isBuffer(n)||Ge.isStream(n)||Ge.isFile(n)||Ge.isBlob(n)||Ge.isReadableStream(n))return n;if(Ge.isArrayBufferView(n))return n.buffer;if(Ge.isURLSearchParams(n))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let d;if(o){if(r.indexOf("application/x-www-form-urlencoded")>-1)return yG(n,this.formSerializer).toString();if((d=Ge.isFileList(n))||r.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return Ub(d?{"files[]":n}:n,f&&new f,this.formSerializer)}}return o||a?(t.setContentType("application/json",!1),vG(n)):n}],transformResponse:[function(n){const t=this.transitional||hg.transitional,r=t&&t.forcedJSONParsing,a=this.responseType==="json";if(Ge.isResponse(n)||Ge.isReadableStream(n))return n;if(n&&Ge.isString(n)&&(r&&!this.responseType||a)){const l=!(t&&t.silentJSONParsing)&&a;try{return JSON.parse(n)}catch(d){if(l)throw d.name==="SyntaxError"?Qt.from(d,Qt.ERR_BAD_RESPONSE,this,null,this.response):d}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:_i.classes.FormData,Blob:_i.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ge.forEach(["delete","get","head","post","put","patch"],e=>{hg.headers[e]={}});const wG=Ge.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),SG=e=>{const n={};let t,r,a;return e&&e.split(`
`).forEach(function(l){a=l.indexOf(":"),t=l.substring(0,a).trim().toLowerCase(),r=l.substring(a+1).trim(),!(!t||n[t]&&wG[t])&&(t==="set-cookie"?n[t]?n[t].push(r):n[t]=[r]:n[t]=n[t]?n[t]+", "+r:r)}),n},S_=Symbol("internals");function Dm(e){return e&&String(e).trim().toLowerCase()}function Vx(e){return e===!1||e==null?e:Ge.isArray(e)?e.map(Vx):String(e)}function NG(e){const n=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(e);)n[r[1]]=r[2];return n}const CG=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function j0(e,n,t,r,a){if(Ge.isFunction(r))return r.call(this,n,t);if(a&&(n=t),!!Ge.isString(n)){if(Ge.isString(r))return n.indexOf(r)!==-1;if(Ge.isRegExp(r))return r.test(n)}}function _G(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,t,r)=>t.toUpperCase()+r)}function jG(e,n){const t=Ge.toCamelCase(" "+n);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+t,{value:function(a,o,l){return this[r].call(this,n,a,o,l)},configurable:!0})})}let fa=class{constructor(n){n&&this.set(n)}set(n,t,r){const a=this;function o(d,f,u){const p=Dm(f);if(!p)throw new Error("header name must be a non-empty string");const g=Ge.findKey(a,p);(!g||a[g]===void 0||u===!0||u===void 0&&a[g]!==!1)&&(a[g||f]=Vx(d))}const l=(d,f)=>Ge.forEach(d,(u,p)=>o(u,p,f));if(Ge.isPlainObject(n)||n instanceof this.constructor)l(n,t);else if(Ge.isString(n)&&(n=n.trim())&&!CG(n))l(SG(n),t);else if(Ge.isHeaders(n))for(const[d,f]of n.entries())o(f,d,r);else n!=null&&o(t,n,r);return this}get(n,t){if(n=Dm(n),n){const r=Ge.findKey(this,n);if(r){const a=this[r];if(!t)return a;if(t===!0)return NG(a);if(Ge.isFunction(t))return t.call(this,a,r);if(Ge.isRegExp(t))return t.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,t){if(n=Dm(n),n){const r=Ge.findKey(this,n);return!!(r&&this[r]!==void 0&&(!t||j0(this,this[r],r,t)))}return!1}delete(n,t){const r=this;let a=!1;function o(l){if(l=Dm(l),l){const d=Ge.findKey(r,l);d&&(!t||j0(r,r[d],d,t))&&(delete r[d],a=!0)}}return Ge.isArray(n)?n.forEach(o):o(n),a}clear(n){const t=Object.keys(this);let r=t.length,a=!1;for(;r--;){const o=t[r];(!n||j0(this,this[o],o,n,!0))&&(delete this[o],a=!0)}return a}normalize(n){const t=this,r={};return Ge.forEach(this,(a,o)=>{const l=Ge.findKey(r,o);if(l){t[l]=Vx(a),delete t[o];return}const d=n?_G(o):String(o).trim();d!==o&&delete t[o],t[d]=Vx(a),r[d]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const t=Object.create(null);return Ge.forEach(this,(r,a)=>{r!=null&&r!==!1&&(t[a]=n&&Ge.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,t])=>n+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...t){const r=new this(n);return t.forEach(a=>r.set(a)),r}static accessor(n){const r=(this[S_]=this[S_]={accessors:{}}).accessors,a=this.prototype;function o(l){const d=Dm(l);r[d]||(jG(a,l),r[d]=!0)}return Ge.isArray(n)?n.forEach(o):o(n),this}};fa.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ge.reduceDescriptors(fa.prototype,({value:e},n)=>{let t=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(r){this[t]=r}}});Ge.freezeMethods(fa);function k0(e,n){const t=this||hg,r=n||t,a=fa.from(r.headers);let o=r.data;return Ge.forEach(e,function(d){o=d.call(t,o,a.normalize(),n?n.status:void 0)}),a.normalize(),o}function eE(e){return!!(e&&e.__CANCEL__)}function Yh(e,n,t){Qt.call(this,e??"canceled",Qt.ERR_CANCELED,n,t),this.name="CanceledError"}Ge.inherits(Yh,Qt,{__CANCEL__:!0});function tE(e,n,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?e(t):n(new Qt("Request failed with status code "+t.status,[Qt.ERR_BAD_REQUEST,Qt.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function kG(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function TG(e,n){e=e||10;const t=new Array(e),r=new Array(e);let a=0,o=0,l;return n=n!==void 0?n:1e3,function(f){const u=Date.now(),p=r[o];l||(l=u),t[a]=f,r[a]=u;let g=o,b=0;for(;g!==a;)b+=t[g++],g=g%e;if(a=(a+1)%e,a===o&&(o=(o+1)%e),u-l<n)return;const v=p&&u-p;return v?Math.round(b*1e3/v):void 0}}function EG(e,n){let t=0,r=1e3/n,a,o;const l=(u,p=Date.now())=>{t=p,a=null,o&&(clearTimeout(o),o=null),e.apply(null,u)};return[(...u)=>{const p=Date.now(),g=p-t;g>=r?l(u,p):(a=u,o||(o=setTimeout(()=>{o=null,l(a)},r-g)))},()=>a&&l(a)]}const db=(e,n,t=3)=>{let r=0;const a=TG(50,250);return EG(o=>{const l=o.loaded,d=o.lengthComputable?o.total:void 0,f=l-r,u=a(f),p=l<=d;r=l;const g={loaded:l,total:d,progress:d?l/d:void 0,bytes:f,rate:u||void 0,estimated:u&&d&&p?(d-l)/u:void 0,event:o,lengthComputable:d!=null,[n?"download":"upload"]:!0};e(g)},t)},N_=(e,n)=>{const t=e!=null;return[r=>n[0]({lengthComputable:t,total:e,loaded:r}),n[1]]},C_=e=>(...n)=>Ge.asap(()=>e(...n)),AG=_i.hasStandardBrowserEnv?((e,n)=>t=>(t=new URL(t,_i.origin),e.protocol===t.protocol&&e.host===t.host&&(n||e.port===t.port)))(new URL(_i.origin),_i.navigator&&/(msie|trident)/i.test(_i.navigator.userAgent)):()=>!0,PG=_i.hasStandardBrowserEnv?{write(e,n,t,r,a,o){const l=[e+"="+encodeURIComponent(n)];Ge.isNumber(t)&&l.push("expires="+new Date(t).toGMTString()),Ge.isString(r)&&l.push("path="+r),Ge.isString(a)&&l.push("domain="+a),o===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function DG(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function IG(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function nE(e,n,t){let r=!DG(n);return e&&(r||t==!1)?IG(e,n):n}const __=e=>e instanceof fa?{...e}:e;function Ud(e,n){n=n||{};const t={};function r(u,p,g,b){return Ge.isPlainObject(u)&&Ge.isPlainObject(p)?Ge.merge.call({caseless:b},u,p):Ge.isPlainObject(p)?Ge.merge({},p):Ge.isArray(p)?p.slice():p}function a(u,p,g,b){if(Ge.isUndefined(p)){if(!Ge.isUndefined(u))return r(void 0,u,g,b)}else return r(u,p,g,b)}function o(u,p){if(!Ge.isUndefined(p))return r(void 0,p)}function l(u,p){if(Ge.isUndefined(p)){if(!Ge.isUndefined(u))return r(void 0,u)}else return r(void 0,p)}function d(u,p,g){if(g in n)return r(u,p);if(g in e)return r(void 0,u)}const f={url:o,method:o,data:o,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:d,headers:(u,p,g)=>a(__(u),__(p),g,!0)};return Ge.forEach(Object.keys(Object.assign({},e,n)),function(p){const g=f[p]||a,b=g(e[p],n[p],p);Ge.isUndefined(b)&&g!==d||(t[p]=b)}),t}const rE=e=>{const n=Ud({},e);let{data:t,withXSRFToken:r,xsrfHeaderName:a,xsrfCookieName:o,headers:l,auth:d}=n;n.headers=l=fa.from(l),n.url=KT(nE(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),d&&l.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):"")));let f;if(Ge.isFormData(t)){if(_i.hasStandardBrowserEnv||_i.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((f=l.getContentType())!==!1){const[u,...p]=f?f.split(";").map(g=>g.trim()).filter(Boolean):[];l.setContentType([u||"multipart/form-data",...p].join("; "))}}if(_i.hasStandardBrowserEnv&&(r&&Ge.isFunction(r)&&(r=r(n)),r||r!==!1&&AG(n.url))){const u=a&&o&&PG.read(o);u&&l.set(a,u)}return n},RG=typeof XMLHttpRequest<"u",MG=RG&&function(e){return new Promise(function(t,r){const a=rE(e);let o=a.data;const l=fa.from(a.headers).normalize();let{responseType:d,onUploadProgress:f,onDownloadProgress:u}=a,p,g,b,v,S;function k(){v&&v(),S&&S(),a.cancelToken&&a.cancelToken.unsubscribe(p),a.signal&&a.signal.removeEventListener("abort",p)}let T=new XMLHttpRequest;T.open(a.method.toUpperCase(),a.url,!0),T.timeout=a.timeout;function A(){if(!T)return;const R=fa.from("getAllResponseHeaders"in T&&T.getAllResponseHeaders()),F={data:!d||d==="text"||d==="json"?T.responseText:T.response,status:T.status,statusText:T.statusText,headers:R,config:e,request:T};tE(function(U){t(U),k()},function(U){r(U),k()},F),T=null}"onloadend"in T?T.onloadend=A:T.onreadystatechange=function(){!T||T.readyState!==4||T.status===0&&!(T.responseURL&&T.responseURL.indexOf("file:")===0)||setTimeout(A)},T.onabort=function(){T&&(r(new Qt("Request aborted",Qt.ECONNABORTED,e,T)),T=null)},T.onerror=function(){r(new Qt("Network Error",Qt.ERR_NETWORK,e,T)),T=null},T.ontimeout=function(){let z=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const F=a.transitional||XT;a.timeoutErrorMessage&&(z=a.timeoutErrorMessage),r(new Qt(z,F.clarifyTimeoutError?Qt.ETIMEDOUT:Qt.ECONNABORTED,e,T)),T=null},o===void 0&&l.setContentType(null),"setRequestHeader"in T&&Ge.forEach(l.toJSON(),function(z,F){T.setRequestHeader(F,z)}),Ge.isUndefined(a.withCredentials)||(T.withCredentials=!!a.withCredentials),d&&d!=="json"&&(T.responseType=a.responseType),u&&([b,S]=db(u,!0),T.addEventListener("progress",b)),f&&T.upload&&([g,v]=db(f),T.upload.addEventListener("progress",g),T.upload.addEventListener("loadend",v)),(a.cancelToken||a.signal)&&(p=R=>{T&&(r(!R||R.type?new Yh(null,e,T):R),T.abort(),T=null)},a.cancelToken&&a.cancelToken.subscribe(p),a.signal&&(a.signal.aborted?p():a.signal.addEventListener("abort",p)));const M=kG(a.url);if(M&&_i.protocols.indexOf(M)===-1){r(new Qt("Unsupported protocol "+M+":",Qt.ERR_BAD_REQUEST,e));return}T.send(o||null)})},OG=(e,n)=>{const{length:t}=e=e?e.filter(Boolean):[];if(n||t){let r=new AbortController,a;const o=function(u){if(!a){a=!0,d();const p=u instanceof Error?u:this.reason;r.abort(p instanceof Qt?p:new Yh(p instanceof Error?p.message:p))}};let l=n&&setTimeout(()=>{l=null,o(new Qt(`timeout ${n} of ms exceeded`,Qt.ETIMEDOUT))},n);const d=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(o):u.removeEventListener("abort",o)}),e=null)};e.forEach(u=>u.addEventListener("abort",o));const{signal:f}=r;return f.unsubscribe=()=>Ge.asap(d),f}},LG=function*(e,n){let t=e.byteLength;if(t<n){yield e;return}let r=0,a;for(;r<t;)a=r+n,yield e.slice(r,a),r=a},FG=async function*(e,n){for await(const t of $G(e))yield*LG(t,n)},$G=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const n=e.getReader();try{for(;;){const{done:t,value:r}=await n.read();if(t)break;yield r}}finally{await n.cancel()}},j_=(e,n,t,r)=>{const a=FG(e,n);let o=0,l,d=f=>{l||(l=!0,r&&r(f))};return new ReadableStream({async pull(f){try{const{done:u,value:p}=await a.next();if(u){d(),f.close();return}let g=p.byteLength;if(t){let b=o+=g;t(b)}f.enqueue(new Uint8Array(p))}catch(u){throw d(u),u}},cancel(f){return d(f),a.return()}},{highWaterMark:2})},Bb=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",iE=Bb&&typeof ReadableStream=="function",zG=Bb&&(typeof TextEncoder=="function"?(e=>n=>e.encode(n))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),aE=(e,...n)=>{try{return!!e(...n)}catch{return!1}},UG=iE&&aE(()=>{let e=!1;const n=new Request(_i.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!n}),k_=64*1024,O1=iE&&aE(()=>Ge.isReadableStream(new Response("").body)),fb={stream:O1&&(e=>e.body)};Bb&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!fb[n]&&(fb[n]=Ge.isFunction(e[n])?t=>t[n]():(t,r)=>{throw new Qt(`Response type '${n}' is not supported`,Qt.ERR_NOT_SUPPORT,r)})})})(new Response);const BG=async e=>{if(e==null)return 0;if(Ge.isBlob(e))return e.size;if(Ge.isSpecCompliantForm(e))return(await new Request(_i.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Ge.isArrayBufferView(e)||Ge.isArrayBuffer(e))return e.byteLength;if(Ge.isURLSearchParams(e)&&(e=e+""),Ge.isString(e))return(await zG(e)).byteLength},qG=async(e,n)=>{const t=Ge.toFiniteNumber(e.getContentLength());return t??BG(n)},VG=Bb&&(async e=>{let{url:n,method:t,data:r,signal:a,cancelToken:o,timeout:l,onDownloadProgress:d,onUploadProgress:f,responseType:u,headers:p,withCredentials:g="same-origin",fetchOptions:b}=rE(e);u=u?(u+"").toLowerCase():"text";let v=OG([a,o&&o.toAbortSignal()],l),S;const k=v&&v.unsubscribe&&(()=>{v.unsubscribe()});let T;try{if(f&&UG&&t!=="get"&&t!=="head"&&(T=await qG(p,r))!==0){let F=new Request(n,{method:"POST",body:r,duplex:"half"}),L;if(Ge.isFormData(r)&&(L=F.headers.get("content-type"))&&p.setContentType(L),F.body){const[U,B]=N_(T,db(C_(f)));r=j_(F.body,k_,U,B)}}Ge.isString(g)||(g=g?"include":"omit");const A="credentials"in Request.prototype;S=new Request(n,{...b,signal:v,method:t.toUpperCase(),headers:p.normalize().toJSON(),body:r,duplex:"half",credentials:A?g:void 0});let M=await fetch(S);const R=O1&&(u==="stream"||u==="response");if(O1&&(d||R&&k)){const F={};["status","statusText","headers"].forEach(J=>{F[J]=M[J]});const L=Ge.toFiniteNumber(M.headers.get("content-length")),[U,B]=d&&N_(L,db(C_(d),!0))||[];M=new Response(j_(M.body,k_,U,()=>{B&&B(),k&&k()}),F)}u=u||"text";let z=await fb[Ge.findKey(fb,u)||"text"](M,e);return!R&&k&&k(),await new Promise((F,L)=>{tE(F,L,{data:z,headers:fa.from(M.headers),status:M.status,statusText:M.statusText,config:e,request:S})})}catch(A){throw k&&k(),A&&A.name==="TypeError"&&/fetch/i.test(A.message)?Object.assign(new Qt("Network Error",Qt.ERR_NETWORK,e,S),{cause:A.cause||A}):Qt.from(A,A&&A.code,e,S)}}),L1={http:aG,xhr:MG,fetch:VG};Ge.forEach(L1,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const T_=e=>`- ${e}`,HG=e=>Ge.isFunction(e)||e===null||e===!1,sE={getAdapter:e=>{e=Ge.isArray(e)?e:[e];const{length:n}=e;let t,r;const a={};for(let o=0;o<n;o++){t=e[o];let l;if(r=t,!HG(t)&&(r=L1[(l=String(t)).toLowerCase()],r===void 0))throw new Qt(`Unknown adapter '${l}'`);if(r)break;a[l||"#"+o]=r}if(!r){const o=Object.entries(a).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let l=n?o.length>1?`since :
`+o.map(T_).join(`
`):" "+T_(o[0]):"as no adapter specified";throw new Qt("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return r},adapters:L1};function T0(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Yh(null,e)}function E_(e){return T0(e),e.headers=fa.from(e.headers),e.data=k0.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),sE.getAdapter(e.adapter||hg.adapter)(e).then(function(r){return T0(e),r.data=k0.call(e,e.transformResponse,r),r.headers=fa.from(r.headers),r},function(r){return eE(r)||(T0(e),r&&r.response&&(r.response.data=k0.call(e,e.transformResponse,r.response),r.response.headers=fa.from(r.response.headers))),Promise.reject(r)})}const oE="1.8.4",qb={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{qb[e]=function(r){return typeof r===e||"a"+(n<1?"n ":" ")+e}});const A_={};qb.transitional=function(n,t,r){function a(o,l){return"[Axios v"+oE+"] Transitional option '"+o+"'"+l+(r?". "+r:"")}return(o,l,d)=>{if(n===!1)throw new Qt(a(l," has been removed"+(t?" in "+t:"")),Qt.ERR_DEPRECATED);return t&&!A_[l]&&(A_[l]=!0,console.warn(a(l," has been deprecated since v"+t+" and will be removed in the near future"))),n?n(o,l,d):!0}};qb.spelling=function(n){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${n}`),!0)};function GG(e,n,t){if(typeof e!="object")throw new Qt("options must be an object",Qt.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let a=r.length;for(;a-- >0;){const o=r[a],l=n[o];if(l){const d=e[o],f=d===void 0||l(d,o,e);if(f!==!0)throw new Qt("option "+o+" must be "+f,Qt.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Qt("Unknown option "+o,Qt.ERR_BAD_OPTION)}}const Hx={assertOptions:GG,validators:qb},Vo=Hx.validators;let Rd=class{constructor(n){this.defaults=n,this.interceptors={request:new w_,response:new w_}}async request(n,t){try{return await this._request(n,t)}catch(r){if(r instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const o=a.stack?a.stack.replace(/^.+\n/,""):"";try{r.stack?o&&!String(r.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+o):r.stack=o}catch{}}throw r}}_request(n,t){typeof n=="string"?(t=t||{},t.url=n):t=n||{},t=Ud(this.defaults,t);const{transitional:r,paramsSerializer:a,headers:o}=t;r!==void 0&&Hx.assertOptions(r,{silentJSONParsing:Vo.transitional(Vo.boolean),forcedJSONParsing:Vo.transitional(Vo.boolean),clarifyTimeoutError:Vo.transitional(Vo.boolean)},!1),a!=null&&(Ge.isFunction(a)?t.paramsSerializer={serialize:a}:Hx.assertOptions(a,{encode:Vo.function,serialize:Vo.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Hx.assertOptions(t,{baseUrl:Vo.spelling("baseURL"),withXsrfToken:Vo.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let l=o&&Ge.merge(o.common,o[t.method]);o&&Ge.forEach(["delete","get","head","post","put","patch","common"],S=>{delete o[S]}),t.headers=fa.concat(l,o);const d=[];let f=!0;this.interceptors.request.forEach(function(k){typeof k.runWhen=="function"&&k.runWhen(t)===!1||(f=f&&k.synchronous,d.unshift(k.fulfilled,k.rejected))});const u=[];this.interceptors.response.forEach(function(k){u.push(k.fulfilled,k.rejected)});let p,g=0,b;if(!f){const S=[E_.bind(this),void 0];for(S.unshift.apply(S,d),S.push.apply(S,u),b=S.length,p=Promise.resolve(t);g<b;)p=p.then(S[g++],S[g++]);return p}b=d.length;let v=t;for(g=0;g<b;){const S=d[g++],k=d[g++];try{v=S(v)}catch(T){k.call(this,T);break}}try{p=E_.call(this,v)}catch(S){return Promise.reject(S)}for(g=0,b=u.length;g<b;)p=p.then(u[g++],u[g++]);return p}getUri(n){n=Ud(this.defaults,n);const t=nE(n.baseURL,n.url,n.allowAbsoluteUrls);return KT(t,n.params,n.paramsSerializer)}};Ge.forEach(["delete","get","head","options"],function(n){Rd.prototype[n]=function(t,r){return this.request(Ud(r||{},{method:n,url:t,data:(r||{}).data}))}});Ge.forEach(["post","put","patch"],function(n){function t(r){return function(o,l,d){return this.request(Ud(d||{},{method:n,headers:r?{"Content-Type":"multipart/form-data"}:{},url:o,data:l}))}}Rd.prototype[n]=t(),Rd.prototype[n+"Form"]=t(!0)});let YG=class lE{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});const r=this;this.promise.then(a=>{if(!r._listeners)return;let o=r._listeners.length;for(;o-- >0;)r._listeners[o](a);r._listeners=null}),this.promise.then=a=>{let o;const l=new Promise(d=>{r.subscribe(d),o=d}).then(a);return l.cancel=function(){r.unsubscribe(o)},l},n(function(o,l,d){r.reason||(r.reason=new Yh(o,l,d),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const t=this._listeners.indexOf(n);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const n=new AbortController,t=r=>{n.abort(r)};return this.subscribe(t),n.signal.unsubscribe=()=>this.unsubscribe(t),n.signal}static source(){let n;return{token:new lE(function(a){n=a}),cancel:n}}};function WG(e){return function(t){return e.apply(null,t)}}function QG(e){return Ge.isObject(e)&&e.isAxiosError===!0}const F1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(F1).forEach(([e,n])=>{F1[n]=e});function cE(e){const n=new Rd(e),t=zT(Rd.prototype.request,n);return Ge.extend(t,Rd.prototype,n,{allOwnKeys:!0}),Ge.extend(t,n,null,{allOwnKeys:!0}),t.create=function(a){return cE(Ud(e,a))},t}const Pr=cE(hg);Pr.Axios=Rd;Pr.CanceledError=Yh;Pr.CancelToken=YG;Pr.isCancel=eE;Pr.VERSION=oE;Pr.toFormData=Ub;Pr.AxiosError=Qt;Pr.Cancel=Pr.CanceledError;Pr.all=function(n){return Promise.all(n)};Pr.spread=WG;Pr.isAxiosError=QG;Pr.mergeConfig=Ud;Pr.AxiosHeaders=fa;Pr.formToJSON=e=>ZT(Ge.isHTMLForm(e)?new FormData(e):e);Pr.getAdapter=sE.getAdapter;Pr.HttpStatusCode=F1;Pr.default=Pr;const{Axios:qre,AxiosError:Vre,CanceledError:Hre,isCancel:Gre,CancelToken:Yre,VERSION:Wre,all:Qre,Cancel:Jre,isAxiosError:Kre,spread:Xre,toFormData:Zre,AxiosHeaders:eie,HttpStatusCode:tie,formToJSON:nie,getAdapter:rie,mergeConfig:iie}=Pr;function JG(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const d=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(f=>f.addEventListener("ended",d)),()=>{e.getTracks().forEach(f=>f.removeEventListener("ended",d))}},[e]),{type:"screen",start:async()=>{const d=await navigator.mediaDevices.getDisplayMedia({video:!0});return n(d),r(!0),d},stop:()=>{e&&(e.getTracks().forEach(d=>d.stop()),n(null),r(!1))},isStreaming:t,stream:e}}function KG(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const d=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(f=>f.addEventListener("ended",d)),()=>{e.getTracks().forEach(f=>f.removeEventListener("ended",d))}},[e]),{type:"webcam",start:async()=>{const d=await navigator.mediaDevices.getUserMedia({video:!0});return n(d),r(!0),d},stop:()=>{e&&(e.getTracks().forEach(d=>d.stop()),n(null),r(!1))},isStreaming:t,stream:e}}class XG extends LT{constructor(t){super();Qn(this,"client");Qn(this,"_status","disconnected");Qn(this,"_session",null);Qn(this,"_model",null);Qn(this,"config",null);this.client=new hw(t),this.send=this.send.bind(this),this.onopen=this.onopen.bind(this),this.onerror=this.onerror.bind(this),this.onclose=this.onclose.bind(this),this.onmessage=this.onmessage.bind(this)}get status(){return this._status}get session(){return this._session}get model(){return this._model}getConfig(){return{...this.config}}log(t,r){const a={date:new Date,type:t,message:r};this.emit("log",a)}async connect(t,r){if(this._status==="connected"||this._status==="connecting")return!1;this._status="connecting",this.config=r,this._model=t;const a={onopen:this.onopen,onmessage:this.onmessage,onerror:this.onerror,onclose:this.onclose};try{this._session=await this.client.live.connect({model:t,config:r,callbacks:a})}catch(o){return console.error("Error connecting to GenAI Live:",o),this._status="disconnected",!1}return this._status="connected",!0}disconnect(){var t;return this.session?((t=this.session)==null||t.close(),this._session=null,this._status="disconnected",this.log("client.close","Disconnected"),!0):!1}onopen(){this.log("client.open","Connected"),this.emit("open")}onerror(t){this.log("server.error",t.message),this.emit("error",t)}onclose(t){this.log("server.close",`disconnected ${t.reason?`with reason: ${t.reason}`:""}`),this.emit("close",t)}async onmessage(t){var r;if(t.setupComplete){this.log("server.send","setupComplete"),this.emit("setupcomplete");return}if(t.toolCall){this.log("server.toolCall",t),this.emit("toolcall",t.toolCall);return}if(t.toolCallCancellation){this.log("server.toolCallCancellation",t),this.emit("toolcallcancellation",t.toolCallCancellation);return}if(t.serverContent){const{serverContent:a}=t;if("interrupted"in a){this.log("server.content","interrupted"),this.emit("interrupted");return}if("turnComplete"in a&&(this.log("server.content","turnComplete"),this.emit("turncomplete")),"modelTurn"in a){let o=((r=a.modelTurn)==null?void 0:r.parts)||[];const l=o.filter(p=>{var g;return p.inlineData&&((g=p.inlineData.mimeType)==null?void 0:g.startsWith("audio/pcm"))}),d=l.map(p=>{var g;return(g=p.inlineData)==null?void 0:g.data}),f=$T.difference(o,l);if(d.forEach(p=>{if(p){const g=dH(p);this.emit("audio",g),this.log("server.audio",`buffer (${g.byteLength})`)}}),!f.length)return;o=f;const u={modelTurn:{parts:o}};this.emit("content",u),this.log("server.content",t)}}else console.log("received unmatched message",t)}sendRealtimeInput(t){var l;let r=!1,a=!1;for(const d of t)if((l=this.session)==null||l.sendRealtimeInput({media:d}),d.mimeType.includes("audio")&&(r=!0),d.mimeType.includes("image")&&(a=!0),r&&a)break;const o=r&&a?"audio + video":r?"audio":a?"video":"unknown";this.log("client.realtimeInput",o)}sendToolResponse(t){var r;t.functionResponses&&t.functionResponses.length&&((r=this.session)==null||r.sendToolResponse({functionResponses:t.functionResponses}),this.log("client.toolResponse",t))}send(t,r=!0){var a;(a=this.session)==null||a.sendClientContent({turns:t,turnComplete:r}),this.log("client.send",{turns:Array.isArray(t)?t:[t],turnComplete:r})}}function ZG(e){const n=w.useMemo(()=>new XG(e),[e]),t=w.useRef(null),[r,a]=w.useState("models/gemini-2.5-flash-live-preview"),[o,l]=w.useState({}),[d,f]=w.useState(!1),[u,p]=w.useState(0),[g,b]=w.useState(null);w.useEffect(()=>{t.current||MT({id:"audio-out"}).then(k=>{t.current=new vH(k),t.current.addWorklet("vumeter-out",OT,T=>{p(T.data.volume)}).then(()=>{})})},[t]),w.useEffect(()=>{const k=()=>{f(!0)},T=()=>{f(!1)},A=F=>{console.error("error",F)},M=()=>{var F;return(F=t.current)==null?void 0:F.stop()},R=F=>{var L;return(L=t.current)==null?void 0:L.addPCM16(new Uint8Array(F))},z=F=>{if(console.log("Received content event:",F),F.modelTurn&&F.modelTurn.parts){const L=F.modelTurn.parts.filter(U=>"text"in U&&U.text);if(L.length>0){const U=L.map(B=>B.text).join(" ");b(U),console.log("AI Summary received:",U)}}};return n.on("error",A).on("open",k).on("close",T).on("interrupted",M).on("audio",R).on("content",z),()=>{n.off("error",A).off("open",k).off("close",T).off("interrupted",M).off("audio",R).off("content",z).disconnect()}},[n]);const v=w.useCallback(async()=>{if(!o)throw new Error("config has not been set");n.disconnect(),await n.connect(r,o)},[n,o,r]),S=w.useCallback(async()=>{n.disconnect(),f(!1)},[f,n]);return{client:n,config:o,setConfig:l,model:r,setModel:a,connected:d,connect:v,disconnect:S,volume:u,aiSummary:g}}const uE=w.createContext(void 0),Ww=({options:e,children:n})=>{const t=ZG(e);return i.jsx(uE.Provider,{value:t,children:n})},yu=()=>{const e=w.useContext(uE);if(!e)throw new Error("useLiveAPIContext must be used wihin a LiveAPIProvider");return e};function eY(){const{config:e,setConfig:n}=yu(),[t,r]=w.useState({value:"audio",label:"audio"}),a=w.useCallback(o=>{n({...e,responseModalities:[o==="audio"?uu.AUDIO:uu.TEXT]})},[e,n]);return i.jsxs("div",{className:"select-group",children:[i.jsx("label",{htmlFor:"response-modality-selector",children:"Response modality"}),i.jsx(RT,{id:"response-modality-selector",className:"react-select",classNamePrefix:"react-select",styles:{},defaultValue:t,options:[{value:"audio",label:"audio"},{value:"text",label:"text"}],onChange:o=>{r(o),o&&(o.value==="audio"||o.value==="text")&&a(o.value)}})]})}const P_=[{value:"Puck",label:"Puck"},{value:"Charon",label:"Charon"},{value:"Kore",label:"Kore"},{value:"Fenrir",label:"Fenrir"},{value:"Aoede",label:"Aoede"}];function tY(){const{config:e,setConfig:n}=yu();w.useEffect(()=>{var d,f,u;const o=((u=(f=(d=e.speechConfig)==null?void 0:d.voiceConfig)==null?void 0:f.prebuiltVoiceConfig)==null?void 0:u.voiceName)||"Atari02";r({value:o,label:o})},[e]);const[t,r]=w.useState(P_[5]),a=w.useCallback(o=>{n({...e,speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:o}}}})},[e,n]);return i.jsxs("div",{className:"select-group",children:[i.jsx("label",{htmlFor:"voice-selector",children:"Voice"}),i.jsx(RT,{id:"voice-selector",className:"react-select",classNamePrefix:"react-select",styles:{},value:t,defaultValue:t,options:P_,onChange:o=>{r(o),o&&a(o.value)}})]})}function nY(){const[e,n]=w.useState(!1),{config:t,setConfig:r,connected:a}=yu(),o=w.useMemo(()=>Array.isArray(t.tools)?t.tools.filter(u=>Array.isArray(u.functionDeclarations)).map(u=>u.functionDeclarations).filter(u=>!!u).flat():[],[t]),l=w.useMemo(()=>{var u;return t.systemInstruction?typeof t.systemInstruction=="string"?t.systemInstruction:Array.isArray(t.systemInstruction)?t.systemInstruction.map(p=>typeof p=="string"?p:p.text).join(`
`):typeof t.systemInstruction=="object"&&"parts"in t.systemInstruction&&((u=t.systemInstruction.parts)==null?void 0:u.map(p=>p.text).join(`
`))||"":""},[t]),d=w.useCallback(u=>{const p={...t,systemInstruction:u.target.value};r(p)},[t,r]),f=w.useCallback((u,p)=>{var b;const g={...t,tools:((b=t.tools)==null?void 0:b.map(v=>{const S=v;return Array.isArray(S.functionDeclarations)?{...v,functionDeclarations:S.functionDeclarations.map(k=>k.name===u?{...k,description:p}:k)}:v}))||[]};r(g)},[t,r]);return i.jsxs("div",{className:"settings-dialog",children:[i.jsx("button",{className:"action-button material-symbols-outlined",onClick:()=>n(!e),children:"settings"}),i.jsx("dialog",{className:"dialog",style:{display:e?"block":"none"},children:i.jsxs("div",{className:`dialog-container ${a?"disabled":""}`,children:[a&&i.jsx("div",{className:"connected-indicator",children:i.jsx("p",{children:"These settings can only be applied before connecting and will override other settings."})}),i.jsxs("div",{className:"mode-selectors",children:[i.jsx(eY,{}),i.jsx(tY,{})]}),i.jsx("h3",{children:"System Instructions"}),i.jsx("textarea",{className:"system",onChange:d,value:l}),i.jsx("h4",{children:"Function declarations"}),i.jsx("div",{className:"function-declarations",children:i.jsx("div",{className:"fd-rows",children:o.map((u,p)=>{var g;return i.jsxs("div",{className:"fd-row",children:[i.jsx("span",{className:"fd-row-name",children:u.name}),i.jsx("span",{className:"fd-row-args",children:Object.keys(((g=u.parameters)==null?void 0:g.properties)||{}).map((b,v)=>i.jsx("span",{children:b},v))}),i.jsx("input",{className:"fd-row-description",type:"text",defaultValue:u.description,onBlur:b=>f(u.name,b.target.value)},`fd-${u.description}`)]},`function-${p}`)})})})]})})]})}const D_=w.memo(({isStreaming:e,onIcon:n,offIcon:t,start:r,stop:a})=>e?i.jsx("button",{className:"action-button",onClick:a,children:i.jsx("span",{className:"material-symbols-outlined",children:n})}):i.jsx("button",{className:"action-button",onClick:r,children:i.jsx("span",{className:"material-symbols-outlined",children:t})}));function rY({videoRef:e,children:n,onVideoStreamChange:t=()=>{},supportsVideo:r,enableEditingSettings:a}){const o=[KG(),JG()],[l,d]=w.useState(null),[f,u]=o,[p,g]=w.useState(0),[b]=w.useState(()=>new FT),[v,S]=w.useState(!1),k=w.useRef(null),T=w.useRef(null),{client:A,connected:M,connect:R,disconnect:z,volume:F}=yu();w.useEffect(()=>{!M&&T.current&&T.current.focus()},[M]),w.useEffect(()=>{document.documentElement.style.setProperty("--volume",`${Math.max(5,Math.min(p*200,8))}px`)},[p]),w.useEffect(()=>{const U=B=>{A.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:B}])};return M&&!v&&b?b.on("data",U).on("volume",g).start():b.stop(),()=>{b.off("data",U).off("volume",g)}},[M,A,v,b]),w.useEffect(()=>{e.current&&(e.current.srcObject=l);let U=-1;function B(){const J=e.current,D=k.current;if(!J||!D)return;const $=D.getContext("2d");if(D.width=J.videoWidth*.25,D.height=J.videoHeight*.25,D.width+D.height>0){$.drawImage(J,0,0,D.width,D.height);const H=D.toDataURL("image/jpeg",1),te=H.slice(H.indexOf(",")+1,1/0);A.sendRealtimeInput([{mimeType:"image/jpeg",data:te}])}M&&(U=window.setTimeout(B,1e3/.5))}return M&&l!==null&&requestAnimationFrame(B),()=>{clearTimeout(U)}},[M,l,A,e]);const L=U=>async()=>{if(U){const B=await U.start();d(B),t(B)}else d(null),t(null);o.filter(B=>B!==U).forEach(B=>B.stop())};return i.jsxs("section",{className:"control-tray",children:[i.jsx("canvas",{style:{display:"none"},ref:k}),i.jsxs("nav",{className:cu("actions-nav",{disabled:!M}),children:[i.jsx("button",{className:cu("action-button mic-button",{recording:!v&&M}),onClick:()=>S(!v),children:v?i.jsx("span",{className:"material-symbols-outlined filled",children:"mic_off"}):i.jsx("span",{className:"material-symbols-outlined filled",children:"mic"})}),i.jsx("div",{className:"action-button no-action outlined",children:i.jsx(yH,{volume:F,active:M,hover:!1})}),r&&i.jsxs(i.Fragment,{children:[i.jsx(D_,{isStreaming:u.isStreaming,start:L(u),stop:L(),onIcon:"cancel_presentation",offIcon:"present_to_all"}),i.jsx(D_,{isStreaming:f.isStreaming,start:L(f),stop:L(),onIcon:"videocam_off",offIcon:"videocam"})]}),n]}),i.jsxs("div",{className:cu("connection-container",{connected:M}),children:[i.jsx("div",{className:"connection-button-container",children:i.jsx("button",{ref:T,className:cu("action-button connect-toggle",{connected:M}),onClick:M?z:R,children:i.jsx("span",{className:"material-symbols-outlined filled",children:M?"pause":"play_arrow"})})}),i.jsx("span",{className:"text-indicator",children:"Streaming"})]}),a?i.jsx(nY,{}):""]})}const I_={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Ih.OBJECT,properties:{summary:{type:Ih.STRING,description:"The summary of the patient's case."}},required:["summary"]}},iY=({patientData:e,tokenNumber:n})=>{const[t,r]=w.useState(""),{client:a,setConfig:o,setModel:l}=yu();return w.useEffect(()=>{l("models/gemini-2.5-flash-live-preview"),o({responseModalities:[uu.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:`Your job is to:

If patient details like name, age, sex, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details (e.g., phone number) are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's name, age, sex, and phone number.

When pronouncing a phone number, always state each digit individually (e.g., "six three" instead of "sixty-three" or "six billion three").

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in Telugu.dont write the telugu words in english`}]},tools:[{functionDeclarations:[I_]}]})},[o,l]),w.useEffect(()=>{const d=f=>{if(!f.functionCalls)return;const u=f.functionCalls.find(p=>p.name===I_.name);if(u){const p=u.args.summary;r(p)}f.functionCalls.length&&setTimeout(()=>{var p;return a.sendToolResponse({functionResponses:(p=f.functionCalls)==null?void 0:p.map(g=>({response:{output:{success:!0}},id:g.id,name:g.name}))})},200)};return a.on("toolcall",d),()=>{a.off("toolcall",d)}},[a]),w.useEffect(()=>{if(t){const d=encodeURIComponent(t);n?window.location.href=`https://hms.newtons.in/handle-complaint-url?token=${n}&caseDetails=${d}`:window.location.href=`https://hms.newtons.in/dashboard/search-patient?caseDetails=${d}`}},[t,n]),i.jsxs("div",{className:"hospital-reception",children:[i.jsx("h1",{children:"Newtons Ai"}),i.jsx("p",{children:"Newtons Ai"}),n&&i.jsxs("h2",{children:["Token Number: ",n]}),e&&i.jsxs("div",{children:[i.jsx("h2",{children:"Patient Details"}),i.jsx("pre",{children:JSON.stringify(e,null,2)})]}),t&&i.jsxs("div",{children:[i.jsx("h2",{children:"Case Summary (from Tool Call)"}),i.jsx("p",{children:t})]})]})},R_="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes";async function aY(){const e=pw();if(!e)return console.warn("No auth token found, using default Live API key."),R_;try{const t=(await Pr.get("/api/clinics/gemini-api-key",{headers:{Authorization:`Bearer ${e}`}})).data.geminiApiKey;if(t)return t}catch(n){console.error("Failed to fetch clinic-specific Live API key:",n)}return console.warn("Clinic-specific Live API key not found or failed to fetch, using default."),R_}function sY(){const e=w.useRef(null),[n,t]=w.useState(null),[r,a]=w.useState(null);return w.useEffect(()=>{(async()=>{try{const l=await aY();a({apiKey:l})}catch(l){console.error("Error setting Live API options:",l)}})()},[]),r?i.jsx("div",{className:"App",children:i.jsx(Ww,{options:r,children:i.jsx(oY,{videoRef:e,setVideoStream:t,videoStream:n})})}):i.jsx("div",{children:"Loading Live API settings..."})}const oY=({videoRef:e,setVideoStream:n,videoStream:t})=>{const[r,a]=w.useState(null),[o,l]=w.useState(null),{connected:d,client:f,connect:u,config:p,model:g}=yu(),[b,v]=w.useState(""),S=w.useRef(null),[k,T]=w.useState(!1);w.useEffect(()=>{const M=window.matchMedia("(prefers-color-scheme: dark)"),R=z=>{document.documentElement.setAttribute("data-theme",z.matches?"dark":"light")};return R(M),M.addEventListener("change",R),()=>M.removeEventListener("change",R)},[]),w.useEffect(()=>{const M=new URLSearchParams(window.location.search),R={};for(const[z,F]of M.entries())z==="token_number"?l(F):R[z]=F;a(R)},[]),w.useEffect(()=>{Object.keys(p).length>0&&g&&u()},[u,p,g]),w.useEffect(()=>{if(d&&r&&!k){const M=JSON.stringify(r,null,2);f.send([{text:M}]),v(""),T(!0)}},[d,r,f,k]),w.useEffect(()=>{r&&v(JSON.stringify(r,null,2))},[r]);const A=()=>{f.send([{text:b}]),v(""),S.current&&(S.current.innerText="")};return i.jsx("div",{className:"streaming-console",children:i.jsxs("main",{children:[i.jsxs("div",{className:"main-app-area",children:[i.jsx(iY,{patientData:r,tokenNumber:o}),i.jsx("video",{className:cu("stream",{hidden:!e.current||!t}),ref:e,autoPlay:!0,playsInline:!0})]}),i.jsx("div",{className:cu("input-container",{disabled:!d}),children:i.jsxs("div",{className:"input-content",children:[i.jsx("textarea",{className:"input-area",ref:S,onKeyDown:M=>{M.key==="Enter"&&!M.shiftKey&&(M.preventDefault(),M.stopPropagation(),A())},onChange:M=>v(M.target.value),value:b}),i.jsx("span",{className:cu("input-content-placeholder",{hidden:b.length}),children:"Typesomething..."}),i.jsx("button",{className:"send-button material-symbols-outlined filled",onClick:A,children:"send"})]})}),i.jsx(rY,{videoRef:e,supportsVideo:!0,onVideoStreamChange:n,enableEditingSettings:!0})]})})},M_="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",lY=({volume:e,active:n})=>{const t=Array.from({length:5},(r,a)=>i.jsx("div",{className:`audio-bar ${n?"active":""}`,style:{height:n?`${Math.min(24,20+e*40*(1+Math.sin(a)*.3))}px`:"8px",animationDelay:`${a*.1}s`}},a));return i.jsx("div",{className:"audio-pulse",children:t})},cY=w.forwardRef(({videoRef:e,supportsVideo:n,onVideoStreamChange:t,textInput:r,onSubmitTextInput:a},o)=>{var L;const{connected:l,connect:d,disconnect:f,client:u,volume:p}=yu(),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[A]=w.useState(()=>new FT),M=async()=>{l?await f():(await d(),r.trim()&&a())};w.useEffect(()=>{const U=B=>{u.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:B}])};return l&&!g?A.on("data",U).start():A.stop(),()=>{A.off("data",U),A.stop()}},[l,u,g,A]);const R=w.useCallback(async()=>{if(v)F==null||F.getTracks().forEach(U=>U.stop()),t(null),S(!1);else try{const U=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=U),t(U),S(!0)}catch(U){console.error("Error accessing webcam:",U),S(!1)}},[v,t,e]),z=w.useCallback(async()=>{if(k)F==null||F.getTracks().forEach(U=>U.stop()),t(null),T(!1);else try{const U=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=U),t(U),T(!0)}catch(U){console.error("Error accessing screen share:",U),T(!1)}},[k,t,e]),F=(L=e.current)==null?void 0:L.srcObject;return w.useEffect(()=>()=>{F&&F.getTracks().forEach(U=>U.stop())},[F]),w.useImperativeHandle(o,()=>({handleConnect:M})),i.jsx("div",{className:"live-api-control-tray",children:i.jsxs("div",{className:"live-api-control-tray-inner",children:[i.jsxs("div",{className:"live-api-control-group",children:[i.jsx("button",{onClick:()=>b(!g),disabled:!l,className:`live-api-control-button ${l&&!g?"mic-active":"mic-inactive"}`,"aria-label":g?"Unmute microphone":"Mute microphone",children:g?i.jsx(f6,{className:"w-5 h-5"}):i.jsx(kk,{className:"w-5 h-5"})}),i.jsx("div",{className:"live-api-audio-pulse-container",children:i.jsx(lY,{volume:p,active:l})}),n&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:z,disabled:!l,className:`live-api-control-button ${k?"video-active":"video-inactive"}`,"aria-label":k?"Stop screen share":"Start screen share",children:i.jsx(m6,{className:"w-5 h-5"})}),i.jsx("button",{onClick:R,disabled:!l,className:`live-api-control-button ${v?"video-active":"video-inactive"}`,"aria-label":v?"Turn off webcam":"Turn on webcam",children:i.jsx(cF,{className:"w-5 h-5"})})]})]}),i.jsxs("div",{className:"live-api-control-group",children:[i.jsxs("div",{className:"live-api-status-indicator",children:[i.jsx("div",{className:`live-api-status-dot ${l?"connected":"disconnected"}`}),i.jsx("span",{className:"live-api-status-text",children:l?"Streaming":"Disconnected"})]}),i.jsx("button",{onClick:M,className:`live-api-connect-button ${l?"connected":"disconnected"}`,children:l?i.jsxs(i.Fragment,{children:[i.jsx(w6,{className:"w-5 h-5"}),i.jsx("span",{children:"Pause"})]}):i.jsxs(i.Fragment,{children:[i.jsx(k6,{className:"w-5 h-5"}),i.jsx("span",{children:"Start"})]})})]})]})})}),uY=({patientData:e,tokenNumber:n,aiSummary:t,clinicName:r})=>i.jsxs("div",{className:"hospital-reception-container",children:[i.jsxs("div",{className:"hospital-reception-logo-section",children:[i.jsx("div",{className:"hospital-reception-logo",children:i.jsx("span",{children:r.charAt(0)})}),i.jsxs("h1",{className:"hospital-reception-title",children:[r," AI"]}),i.jsxs("p",{className:"hospital-reception-subtitle",children:["Intelligent ",r," Reception Assistant"]})]}),n&&i.jsxs("div",{className:"hospital-reception-token-card",children:[i.jsx("h2",{className:"hospital-reception-token-title",children:"Token Number"}),i.jsx("p",{className:"hospital-reception-token-number",children:n})]}),e?i.jsxs("div",{className:"hospital-reception-patient-info-card",children:[i.jsx("h3",{className:"hospital-reception-patient-info-title",children:"Patient Information"}),i.jsx("div",{className:"hospital-reception-patient-info-content",children:i.jsx("pre",{className:"hospital-reception-patient-info-pre",children:JSON.stringify(e,null,2)})})]}):i.jsxs("div",{className:"hospital-reception-patient-info-card",children:[i.jsx("h3",{className:"hospital-reception-patient-info-title",children:"New Case"}),i.jsx("p",{className:"hospital-reception-patient-info-pre",children:"No patient data provided. This is a new case."})]}),t&&i.jsxs("div",{className:"hospital-reception-summary-card",children:[i.jsx("h3",{className:"hospital-reception-summary-title",children:"Case Summary"}),i.jsx("p",{className:"hospital-reception-summary-text",children:t})]})]}),O_={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Ih.OBJECT,properties:{summary:{type:Ih.STRING,description:"The summary of the patient's case."}},required:["summary"]}},dY=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:a})=>{const o=w.useRef(null),l=w.useRef(null),[d,f]=w.useState(null),[u,p]=w.useState("hi"),{client:g,connected:b,setConfig:v,setModel:S,disconnect:k,connect:T}=yu(),A=w.useMemo(()=>{let U=`Your job is to:

If patient details like name, age, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details (Name, Age) are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's Name and Age only. Do not ask for their phone number.

    You should guess the patient's sex based on their voice or appearance.

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in Telugu. Dont write the telugu words in english.`;return n&&(U+=`

Patient Data: ${JSON.stringify(n,null,2)}`),{responseModalities:[uu.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:U}]},tools:[{functionDeclarations:[O_]}]}},[n]);w.useEffect(()=>{S("models/gemini-2.5-flash-native-audio-preview-12-2025"),v(A);const U=setTimeout(()=>{l.current&&!b&&l.current.handleConnect()},2e3);return()=>clearTimeout(U)},[v,S,A,b]),w.useEffect(()=>()=>{b&&k()},[b,k]);const[M,R]=w.useState(null);w.useEffect(()=>{const U=B=>{if(!B.functionCalls)return;const J=B.functionCalls.find(D=>D.name===O_.name);if(J){const D=J.args.summary;R(D),r(D)}B.functionCalls.length&&setTimeout(()=>{var D;return g.sendToolResponse({functionResponses:(D=B.functionCalls)==null?void 0:D.map($=>({response:{output:{success:!0}},id:$.id,name:$.name}))})},200)};return g.on("toolcall",U),()=>{g.off("toolcall",U)}},[g,r]);const z=()=>{u.trim()&&(g.send([{text:u}]),p(""))},F=U=>{U.key==="Enter"&&!U.shiftKey&&(U.preventDefault(),z())},L=async()=>{R(null),r(null),p("hi"),b?(k(),setTimeout(()=>{T()},500)):T()};return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsxs("div",{className:"live-api-modal-content",children:[i.jsxs("div",{className:"live-api-modal-header",children:[i.jsxs("div",{className:"live-api-modal-header-left",children:[i.jsx("div",{className:"live-api-modal-logo",children:i.jsx("span",{children:a.charAt(0)})}),i.jsxs("div",{children:[i.jsx("h1",{className:"live-api-modal-title",children:a}),i.jsxs("p",{className:"live-api-modal-subtitle",children:[a," Hospital Assistant"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:L,className:"live-api-modal-close-button",title:"Refresh Session","aria-label":"Refresh session",children:i.jsx(Ak,{className:"w-6 h-6"})}),i.jsx("button",{onClick:e,className:"live-api-modal-close-button","aria-label":"Close modal",children:i.jsx(zn,{className:"w-6 h-6"})})]})]}),i.jsx("div",{className:"live-api-modal-main-content",children:i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsxs("div",{className:"live-api-reception-area",children:[i.jsx(uY,{patientData:n,tokenNumber:t,aiSummary:M,clinicName:a}),d&&i.jsx("video",{ref:o,autoPlay:!0,playsInline:!0,className:"live-api-video-stream"})]}),i.jsx("div",{className:"live-api-input-area",children:i.jsxs("div",{className:"live-api-input-container",children:[i.jsx("textarea",{value:u,onChange:U=>p(U.target.value),onKeyDown:F,placeholder:"Type your message here...",disabled:!b,rows:1,className:"live-api-textarea"}),i.jsx("button",{onClick:z,disabled:!b||!u.trim(),className:"live-api-send-button","aria-label":"Send message",children:i.jsx(Pk,{className:"w-5 h-5"})})]})}),i.jsx(cY,{ref:l,videoRef:o,supportsVideo:!0,onVideoStreamChange:f,textInput:u,onSubmitTextInput:z})]})})]})})},dE=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r})=>{const[a,o]=w.useState(null),[l,d]=w.useState("Newtons Ai"),[f,u]=w.useState(!0);if(w.useEffect(()=>{(async()=>{try{let b=null,v="Newtons Ai";try{const S=await pe("/api/clinics/settings");if(S.ok){const k=await S.json();k.name&&k.name!==""&&(v=k.name),k.gemini_api_key&&k.gemini_api_key.trim()!==""&&(b=k.gemini_api_key.trim())}}catch(S){console.warn("Failed to fetch clinic settings",S)}if(d(v),b)o(b);else{try{const S=await pe("/api/global-settings/app_gemini_api_key");if(S.ok){const k=await S.json();if(k.value&&k.value.trim()!==""){o(k.value.trim());return}}}catch(S){console.warn("Failed to fetch global key fallback",S)}o(M_)}}catch(b){console.error("Unexpected error in getSettings:",b),o(M_)}finally{u(!1)}})()},[]),f)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsx("div",{className:"live-api-modal-content",style:{maxHeight:"200px",maxWidth:"400px",borderRadius:"1rem",justifyContent:"center"},children:i.jsxs("div",{className:"live-api-loading-container",children:[i.jsx("div",{className:"live-api-loading-spinner"}),i.jsx("div",{className:"live-api-loading-text",children:"Initializing AI Assistant..."})]})})});if(!a)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsx("div",{className:"live-api-modal-content",children:i.jsx("div",{children:"Error: API Key not available."})})});const p={apiKey:a};return i.jsx(Ww,{options:p,children:i.jsx(dY,{onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:l})})},fY="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",hY={apiKey:fY},_h=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,o]=w.useState(!1),[l,d]=w.useState(null),[f,u]=w.useState(!1),[p,g]=w.useState(null),b=w.useRef(null),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[A,M]=w.useState(null),[R,z]=w.useState(null),[F,L]=w.useState([]),U=Et(),B=Br();w.useEffect(()=>{(async()=>{try{const ae=new URLSearchParams({page:"1",limit:"5",sortBy:"createdAt",sortOrder:"desc"}),re=await pe(`/api/patients?${ae.toString()}`);if(re.ok){const le=await re.json();L(le.patients||[])}}catch(ae){console.error("Error fetching recent patients:",ae)}})()},[]);const J=w.useCallback(async V=>{const ae=V||e;if(!ae.trim()){g("Please enter complaint details.");return}u(!0),g(null);try{const re=await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"New Patient - Direct Entry",age:null,gender:null,phone:null,address:null})});if(!re.ok){const ue=await re.json().catch(()=>({message:"Failed to create patient"}));if(re.status===403&&ue.message.includes("Patient limit")){U("/start-clinic-subscription",{state:{errorMessage:ue.message}});return}throw new Error(ue.message||`Failed to create patient: ${re.statusText}`)}const le=await re.json();if(!le||!le.id)throw new Error("Failed to create new patient or retrieve patient ID.");const E=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:le.id,complaint:ae})});if(!E.ok){const ue=await E.text();throw new Error(`Failed to create queue entry: ${ue||E.statusText}`)}const ce=await E.json();if(!ce||!ce.id)throw new Error("Failed to create new complaint record or retrieve record ID.");U(`/dashboard/edit-complaint/${ce.id}`,{state:{initialComplaint:ae}})}catch(re){console.error("Error starting new complaint:",re),re.message.includes("Patient limit")?(g(`Error: ${re.message}. Please upgrade your plan.`),U("/start-clinic-subscription")):g(`Error: ${re.message||"Failed to start new complaint process."}`)}finally{u(!1)}},[e,U]);w.useEffect(()=>{const V=b.current;V&&(V.style.height="auto",V.style.height=`${V.scrollHeight}px`);const re=new URLSearchParams(B.search).get("caseDetails");if(re){const le=decodeURIComponent(re);le!==e&&(n(le),S(!0))}},[B.search,e]),w.useEffect(()=>{v&&e.trim()&&(U(B.pathname,{replace:!0}),J(e),S(!1))},[v,e,J,U,B.pathname]),w.useEffect(()=>{const V=b.current;V&&(V.style.height="auto",V.style.height=`${V.scrollHeight}px`)},[e]),w.useEffect(()=>{A&&(n(A),T(!1),J(A),M(null))},[A,J]);const D=()=>{z({id:null,token:null,name:"New Case",age:null,gender:null}),T(!0)},$=w.useMemo(()=>Db(async V=>{const ae=V.trim(),re=/^\d+$/.test(ae),le=ae.split(/\s+/).length;if(ae.length<2||re&&ae.length>10||!re&&le>2){r([]),o(!1),d(null);return}o(!0),d(null);try{const E=new URLSearchParams({search:encodeURIComponent(V),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),ce=await pe(`/api/patients?${E.toString()}`);if(!ce.ok){const I=await ce.text();throw new Error(`API Error (${ce.status}): ${I||ce.statusText}`)}const ue=await ce.json();r(ue.patients)}catch(E){console.error("Error searching patients:",E),d(E.message||"Failed to search patients."),r([])}finally{o(!1)}},300),[]),H=V=>{const ae=V.target.value;n(ae);const re=ae.trim(),le=/^\d+$/.test(re),E=re.split(/\s+/).length;re.length>=2&&!(le&&re.length>10||!le&&E>2)?o(!0):(o(!1),r([])),$(ae)},te=V=>{V.key==="Enter"&&!V.shiftKey&&(V.preventDefault(),t.length>0&&!a?Q(t[0]):e.trim()&&!a&&J(e))},Q=async V=>{V&&V.id&&U(`/dashboard/edit-complaint/patient/${V.id}`)},Y=[{icon:"",title:"Example: Fever & Cold",description:"Rajesh Kumar, 35 year old male, fever since 2 days, cold, body pain, no cough",text:"Rajesh Kumar, 35 year old male, fever since 2 days, cold, body pain, no cough"},{icon:"",title:"Example: Stomach Ache",description:"Priya Sharma, 28 year old female, stomach pain after eating, acidity, bloating since 3 days",text:"Priya Sharma, 28 year old female, stomach pain after eating, acidity, bloating since 3 days"}];return i.jsxs("div",{className:"patient-search-page-container",children:[i.jsxs("div",{className:"patient-search-header",children:[i.jsx("button",{onClick:()=>U("/dashboard/queue"),className:"patient-search-button patient-search-button-primary",children:"OPD Queue"}),i.jsx("button",{onClick:()=>U(-1),className:"patient-search-button patient-search-button-back",children:i.jsx(rn,{size:16})})]}),i.jsxs("div",{className:"patient-search-content-box",children:[l&&i.jsx("p",{className:"patient-search-error",children:l}),p&&i.jsx("p",{className:"patient-search-error",children:p}),F.length>0&&i.jsxs("div",{className:"newly-registered-section",children:[i.jsx("div",{className:"recent-list",children:F.map(V=>i.jsxs("div",{className:"recent-patient-pill",onClick:()=>Q(V),children:[i.jsxs("div",{className:"recent-name-container",children:[i.jsx("span",{className:"recent-name",children:V.name||"New Patient"}),i.jsxs("span",{className:"recent-token",children:["#",V.token]})]}),i.jsxs("div",{className:"recent-info",children:[V.age," yrs / ",V.gender]})]},V.id))}),i.jsx("div",{className:"newly-registered-label",children:"NEWLY REGISTERED"})]}),i.jsxs("div",{className:"example-cases-section",children:[i.jsxs("div",{className:"example-cases-header",children:[i.jsx("span",{className:"sparkles-icon",children:""}),i.jsx("h3",{children:"Try AI with Example Cases"})]}),i.jsx("div",{className:"example-cards-container",children:Y.map((V,ae)=>i.jsxs("div",{className:"example-case-card",onClick:()=>n(V.text),children:[i.jsx("div",{className:"example-icon",children:V.icon}),i.jsxs("div",{className:"example-content",children:[i.jsx("div",{className:"example-title",children:V.title}),i.jsx("div",{className:"example-description",children:V.description})]})]},ae))})]})]}),i.jsxs("div",{className:"sticky-chat-input-box",children:[t.length>0&&!f&&i.jsx("ul",{className:"patient-search-results-list",children:t.map(V=>i.jsxs("li",{onClick:()=>Q(V),className:"patient-search-result-item",children:[i.jsxs("div",{className:"patient-search-result-item-name-container",children:[i.jsxs("span",{className:"patient-search-result-item-token",children:["[#",V.token,"]"]}),i.jsx("span",{className:"patient-search-result-item-name",children:V.name})]}),i.jsxs("div",{className:"patient-search-result-item-details",children:[V.age?`${V.age} yrs`:"",V.age&&V.gender?" / ":"",V.gender||"N/A"]})]},V.id))}),e.length>=2&&!a&&t.length===0&&!l&&i.jsxs("p",{className:"patient-search-no-results",children:['No patients found matching, taking new case: "',e,'".']}),i.jsxs("div",{className:"chat-input-controls",children:[i.jsx("textarea",{ref:b,placeholder:"Search by Name/Phone/Token or Enter New Case: Name, Age, Sex, Complaint...",value:e,onChange:H,onKeyDown:te,className:"chat-input",autoFocus:!0,disabled:f,rows:1}),i.jsx("button",{onClick:e.trim()?()=>J(e):D,className:`chat-submit-button ${f||a?"opacity-50":""}`,disabled:f||a||!!e.trim()&&!e.trim(),"aria-label":e.trim()?"Create New Case":"Use Microphone",children:f||a?i.jsx("div",{className:"spinner"}):e.trim()?i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24",children:i.jsx("path",{d:"M12 4l1.41 1.41L7.83 11H20v2H7.83l5.58 5.59L12 20l-8-8 8-8z",transform:"rotate(90 12 12)"})}):i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24",children:i.jsx("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm-1.2-9.1c0-.66.54-1.2 1.2-1.2s1.2.54 1.2 1.2V9c0 .66-.54 1.2-1.2 1.2s-1.2-.54-1.2-1.2V4.9zM17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"})})})]})]}),k&&i.jsx(Ww,{options:hY,children:i.jsx(dE,{onClose:()=>T(!1),patientData:R,tokenNumber:null,onAiSummaryChange:M})})]})},pY=({})=>{const e=Et(),[n]=w.useState("patientSearch"),[t]=w.useState(!1),[r,a]=w.useState(null),[o,l]=w.useState(null);return w.useEffect(()=>{if(o){const d=setTimeout(()=>l(null),5e3);return()=>clearTimeout(d)}},[o]),t?i.jsxs("div",{className:"loading-animation-container",children:[" ",i.jsx("div",{className:"breathing-ball"}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Admin Panel..."})]}):i.jsxs("div",{className:"admin-panel-container",children:[" ",o&&i.jsxs("div",{className:`alert-box ${o.type==="success"?"alert-box-success":"alert-box-error"} fixed top-4 right-4 z-[100]`,role:"alert",children:[i.jsx("div",{className:"alert-box-icon",children:o.type==="success"?i.jsx(ps,{size:18}):i.jsx(Ar,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{children:o.message})}),i.jsx("button",{onClick:()=>l(null),className:"alert-box-close",children:i.jsx(zn,{size:16})})]}),r&&i.jsxs("div",{className:"alert-box alert-box-error mb-4",role:"alert",children:[" ",i.jsx("div",{className:"alert-box-icon",children:i.jsx(Ar,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{className:"block sm:inline flex-1",children:r})}),i.jsx("button",{onClick:()=>a(null),className:"alert-box-close",children:i.jsx(zn,{size:16})})]}),i.jsxs("div",{className:"admin-nav-bar",children:[" ",i.jsxs("button",{onClick:()=>window.location.reload(),className:"admin-nav-button",title:"Refresh Page",children:[i.jsx(Nk,{})," "]}),i.jsxs("button",{onClick:()=>e("/dashboard/clinic-hub"),className:"admin-nav-button",children:[i.jsx(_k,{})," Clinic"]}),i.jsxs("button",{onClick:()=>e("/dashboard/inventory"),className:"admin-nav-button",children:[i.jsx(og,{})," Inventory"]}),i.jsxs("button",{onClick:()=>e("/dashboard/analysis"),className:"admin-nav-button",children:[i.jsx(f1,{})," Analysis"]}),i.jsx("button",{onClick:()=>e("/lab-inventory"),className:"admin-nav-button hidden-button",children:"Lab Inventory"}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions"),className:"admin-nav-button hidden-button",children:[i.jsx(q3,{})," Subscriptions"]}),i.jsx("button",{onClick:()=>e("/refill-reminders"),className:"admin-nav-button",children:"Refills"}),i.jsxs("button",{onClick:()=>e("/create-lab-order"),className:"admin-nav-button",children:[i.jsx(f1,{})," Labs"]}),i.jsxs("button",{onClick:()=>e("/dashboard/patients"),className:"admin-nav-button",children:[i.jsx(Bh,{})," Patients"]})]}),i.jsxs("div",{className:"space-y-6",children:[" ",n==="patientSearch"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(_h,{})})]})]})},iu=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},mY=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},xh=({title:e,icon:n,items:t,renderItemContent:r,isLoading:a,loadingText:o,noDataText:l})=>{const d=w.useMemo(()=>{const f={};t.forEach(p=>{if(isNaN(p.date.getTime())){f["Unknown Date"]||(f["Unknown Date"]=[]),f["Unknown Date"].push(p);return}const g=mY(p.originalDateString);f[g]||(f[g]=[]),f[g].push(p)});const u=Object.keys(f);return u.sort((p,g)=>{if(p==="Unknown Date")return 1;if(g==="Unknown Date")return-1;try{const b=k=>{const T=k.split(" ");if(T.length===3){const M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(T[1]);if(M!==-1)return new Date(parseInt(T[2]),M,parseInt(T[0]))}return new Date(k)},v=b(p),S=b(g);if(!isNaN(v.getTime())&&!isNaN(S.getTime()))return S.getTime()-v.getTime()}catch(b){console.error("Error parsing date for sorting:",b)}return g.localeCompare(p)}),u.map(p=>({date:p,items:f[p]}))},[t]);return i.jsxs("div",{className:"mb-2 bg-slate-50 rounded-lg border border-slate-200 overflow-hidden",children:[i.jsxs("h4",{className:"text-xs font-semibold text-slate-700 bg-slate-100 px-3 py-2 border-b border-slate-200 flex items-center",children:[n&&i.jsx(n,{size:14,className:"mr-2 text-indigo-600"}),e]}),i.jsxs("div",{className:"p-2",children:[a&&i.jsx("p",{className:"text-slate-500 italic text-xs px-1",children:o}),!a&&t.length===0&&i.jsx("p",{className:"text-slate-500 italic text-xs px-1",children:l}),!a&&t.length>0&&i.jsx("div",{className:"space-y-3",children:d.map(({date:f,items:u})=>i.jsxs("div",{children:[i.jsx("h5",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-1.5 px-1",children:f}),i.jsx("div",{className:"space-y-2 pl-2 border-l-2 border-slate-200 ml-1",children:u.map((p,g)=>i.jsx("div",{className:"flex items-start",children:i.jsx("div",{className:"flex-grow",children:r(p)})},`${p.type}-${p.originalDateString}-${g}`))})]},f))})]})]})},E0=()=>{var ae,re;const[e,n]=w.useState({currentPatient:null,nextPatient:null,waitingCount:0}),[t,r]=w.useState(!0),[a,o]=w.useState(null),[l,d]=w.useState(null),[f,u]=w.useState(null),[p,g]=w.useState(null),[b,v]=w.useState({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),[S,k]=w.useState(!1),[T,A]=w.useState(null),{patientId:M}=Gi(),R=Et(),z=w.useCallback(async le=>{g(null),d(null),u(null),k(!0),A(null),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]});try{const E=await pe(`/api/patients/${le}`);if(!E.ok)throw new Error(`Patient details fetch failed (${E.status})`);const ce=await E.json();d(ce);const ue=await pe(`/api/queue/patient/${le}/latest`);if(!ue.ok&&ue.status!==404)throw new Error(`Queue entry fetch failed (${ue.status})`);if(ue.ok){const I=await ue.json();u(I)}await F(le)}catch(E){console.error("Error fetching specific patient data:",E),g(E.message||"Failed to load patient data."),A(E.message||"Failed to load patient history.")}finally{k(!1)}},[]),F=w.useCallback(async le=>{k(!0),A(null);try{const[E,ce,ue,I]=await Promise.all([pe(`/api/queue/patient/${le}/complaints`),pe(`/api/lab/patient/${le}`),pe(`/api/lab/orders/patient/${le}?status=pending`),pe(`/api/pharmacy-orders/patient/${le}`)]),de=E.ok?await E.json():[],fe=ce.ok?await ce.json():[],W=ue.ok?await ue.json():[],oe=I.ok?await I.json():[];v({pastComplaints:de||[],labReports:fe||[],pendingLabOrders:W||[],pharmacyOrders:oe||[]})}catch(E){console.error("Error fetching patient history:",E),A(E.message||"Failed to load patient history."),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]})}finally{k(!1)}},[]),L=w.useCallback(async()=>{r(!0),o(null);try{const le=await pe("/api/queue/doctor");if(!le.ok){const ce=await le.text();throw new Error(`API Error (${le.status}): ${ce||le.statusText}`)}const E=await le.json();if(E===null||typeof E!="object"||typeof E.waitingCount!="number")throw console.error("Invalid queue data format:",E),new Error("Invalid queue data format received");n({currentPatient:E.currentPatient||null,nextPatient:E.nextPatient||null,waitingCount:E.waitingCount})}catch(le){console.error("Error fetching queue data:",le),o(le.message||"Failed to fetch queue data.")}finally{r(!1)}},[]);w.useEffect(()=>{let le=null;return M?(z(M),n({currentPatient:null,nextPatient:null,waitingCount:0})):(L(),le=setInterval(L,1e4),d(null),u(null)),()=>{le&&clearInterval(le)}},[M,z,L]),w.useEffect(()=>{var le;!M&&((le=e.currentPatient)!=null&&le.patientId)?F(e.currentPatient.patientId):!M&&!e.currentPatient&&(v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),A(null))},[M,(ae=e.currentPatient)==null?void 0:ae.patientId,F]);const U=((re=e.currentPatient)==null?void 0:re.patientId)||(M?parseInt(M,10):null),B=w.useMemo(()=>{if(!U||!b.pastComplaints)return[];const le=b.pastComplaints.map(E=>({date:new Date(E.createdAt),type:"Complaint",data:E,originalDateString:E.createdAt})).filter(E=>!isNaN(E.date.getTime()));return le.sort((E,ce)=>ce.date.getTime()-E.date.getTime()),le},[U,b.pastComplaints]),J=w.useMemo(()=>{if(!U)return[];const le=[];return(b.pendingLabOrders??[]).forEach(E=>{const ce=new Date(E.createdAt);isNaN(ce.getTime())||le.push({date:ce,type:"Lab Order (Pending)",data:E,originalDateString:E.createdAt})}),(b.labReports??[]).forEach(E=>{const ce=E.reportCreatedAt?new Date(E.reportCreatedAt):null;ce&&!isNaN(ce.getTime())&&le.push({date:ce,type:"Lab Report",data:E,originalDateString:E.reportCreatedAt})}),le.sort((E,ce)=>ce.date.getTime()-E.date.getTime()),le},[U,b.pendingLabOrders,b.labReports]),D=w.useMemo(()=>{if(!U||!b.pharmacyOrders)return[];const le=b.pharmacyOrders.map(E=>({date:new Date(E.date),type:"Pharmacy Order",data:E,originalDateString:E.date})).filter(E=>!isNaN(E.date.getTime()));return le.sort((E,ce)=>ce.date.getTime()-E.date.getTime()),le},[U,b.pharmacyOrders]),$=async()=>{r(!0),o(null);try{await pe("/api/queue/doctor/next",{method:"POST"}),await L()}catch(le){console.error("Error calling next patient:",le),o(le.message||"Failed to call next patient.")}finally{r(!1)}},H=async()=>{if(!(!e.currentPatient||M)){r(!0),o(null);try{await pe(`/api/queue/doctor/complete/${e.currentPatient._id}`,{method:"POST"}),await L(),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),A(null)}catch(le){console.error("Error completing consultation:",le),o(le.message||"Failed to complete consultation.")}finally{r(!1)}}},te=le=>{switch(le){case"waiting":return"Waiting";case"consulting":return"Consulting";case"seen":return"Seen";case"cancelled":return"Cancelled";default:return le}},[Q,Y]=w.useState("info");let V=null;return e.currentPatient&&(V=i.jsxs("div",{className:"patient-info-section bg-white rounded-lg shadow-md md:p-6 border-l-4 md:border-l-8 border-teal-500 overflow-hidden",children:[i.jsxs("div",{className:"mobile-tabs md:hidden flex mb-4",children:[i.jsx("button",{className:`mobile-tab-btn ${Q==="info"?"active":""}`,onClick:()=>Y("info"),children:"Patient Details"}),i.jsx("button",{className:`mobile-tab-btn ${Q==="history"?"active":""}`,onClick:()=>Y("history"),children:"History & Context"})]}),i.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[i.jsxs("div",{className:`flex-grow md:w-1/2 ${Q==="info"?"block":"hidden md:block"}`,children:[i.jsxs("h2",{className:"text-xl text-teal-700 font-semibold mb-3 flex items-center",children:["NOW SEEING",i.jsx("span",{className:"ml-2 text-xs font-normal text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:"Live Consultation"})]}),i.jsxs("div",{className:"flex justify-between items-start mb-4",children:[i.jsxs("div",{className:"flex-grow mr-4",children:[i.jsx("div",{className:"text-3xl md:text-3xl font-bold text-gray-800 mb-1 leading-tight",children:e.currentPatient.name}),i.jsxs("div",{className:"text-lg text-gray-600 flex items-center mt-1",children:[i.jsxs("span",{className:"font-semibold bg-gray-100 px-2 py-0.5 rounded text-sm mr-2",children:[e.currentPatient.age," Yrs"]}),i.jsx("span",{className:"font-semibold bg-gray-100 px-2 py-0.5 rounded text-sm",children:e.currentPatient.gender})]})]}),i.jsxs("div",{className:"text-right flex-shrink-0 flex flex-col items-end",children:[i.jsxs("div",{className:"text-2xl font-bold text-gray-700 mb-1",children:["#",e.currentPatient.token]}),i.jsx("span",{className:`inline-block px-2 py-0.5 rounded text-xs font-medium uppercase tracking-wide ${e.currentPatient.status==="consulting"?"bg-teal-100 text-teal-800":"bg-gray-100 text-gray-800"}`,children:te(e.currentPatient.status)})]})]}),e.currentPatient.case_summary&&i.jsxs("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-100 rounded-md",children:[i.jsx("h4",{className:"text-xs font-bold text-amber-800 uppercase mb-1",children:"AI Brief"}),i.jsx("p",{className:"text-sm text-amber-900 leading-snug",children:e.currentPatient.case_summary})]}),i.jsxs("div",{className:"actions-section mt-4 md:mt-6 flex flex-col sm:flex-row justify-end gap-3 border-t pt-4",children:[i.jsxs("button",{onClick:()=>{var E;const le=(E=e.currentPatient)==null?void 0:E._id;le&&R(`/dashboard/edit-complaint/${le}`)},disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-primary w-full sm:w-auto",children:[i.jsx(mw,{size:16})," Open Consultation"]}),i.jsxs("button",{onClick:H,disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-success w-full sm:w-auto",children:[i.jsx(W3,{size:16})," Complete"]})]})]})," ",i.jsxs("div",{className:`complaint-section md:w-1/2 mt-4 md:mt-0 pt-4 md:pt-0 ${Q==="history"?"block":"hidden md:block"} border-t md:border-t-0 md:border-l md:pl-6`,children:[i.jsxs("h3",{className:"text-base font-semibold text-gray-800 mb-2 flex items-center justify-between",children:[i.jsx("span",{children:"History & Context"}),S&&i.jsx("span",{className:"text-xs font-normal text-indigo-600 animate-pulse",children:"Updating..."})]}),T&&i.jsx("p",{className:"text-red-500 text-xs mb-2 bg-red-50 p-2 rounded",children:T}),i.jsxs("div",{className:"space-y-3 pr-1 md:max-h-[500px] md:overflow-y-auto custom-scrollbar",children:[i.jsx(xh,{title:"Past Complaints",icon:du,items:B,isLoading:S,loadingText:"Fetching...",noDataText:"No past complaints.",renderItemContent:le=>i.jsxs("span",{className:"block text-xs",children:[le.data.complaint,i.jsx("div",{className:"text-gray-400 mt-0.5 text-[10px]",children:iu(le.originalDateString)})]})}),i.jsx(xh,{title:"Lab Reports & Orders",icon:Jl,items:J,isLoading:S,loadingText:"Fetching...",noDataText:"No lab history.",renderItemContent:le=>le.type==="Lab Order (Pending)"?i.jsxs("div",{className:"text-xs",children:[i.jsx("div",{className:"font-medium text-blue-700 mb-0.5",children:"Pending Order"}),le.data.tests.map(E=>E.name).join(", "),i.jsx("div",{className:"text-gray-400 mt-0.5 text-[10px]",children:iu(le.originalDateString)})]}):i.jsxs("div",{className:"text-xs",children:[i.jsxs("div",{className:"font-medium text-green-700 mb-0.5",children:["Report: ",le.data.testName]}),i.jsxs("div",{className:"text-gray-600 italic",children:['"',le.data.reportFindings.substring(0,60),le.data.reportFindings.length>60?"...":"",'"']}),i.jsx("div",{className:"text-gray-400 mt-0.5 text-[10px]",children:iu(le.originalDateString)})]})}),i.jsx(xh,{title:"Medications",icon:Ld,items:D,isLoading:S,loadingText:"Fetching...",noDataText:"No medication history.",renderItemContent:le=>i.jsxs("div",{className:"text-xs",children:[i.jsx("div",{className:"text-gray-800",children:le.data.medications.map(E=>`${E.name} (${E.quantity})`).join(", ")}),i.jsxs("div",{className:"text-gray-400 mt-0.5 text-[10px]",children:[iu(le.originalDateString),"  ",i.jsx("span",{className:"capitalize",children:le.data.status})]})]})}),B.length===0&&J.length===0&&D.length===0&&!S&&i.jsx("div",{className:"text-gray-400 text-center py-4 text-xs italic bg-gray-50 rounded border border-dashed border-gray-200",children:"No history records found for this patient."})]})," "]})," "]})," "]})),i.jsx(i.Fragment,{children:i.jsxs("div",{className:"doctor-screen-container flex-grow flex flex-col space-y-6 md:space-y-8",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("button",{onClick:()=>R(-1),className:"back-button mr-4",children:i.jsx(rn,{size:24})}),i.jsx("h1",{className:"doctor-screen-header",children:"Doctor Consultation Panel"})]}),M?i.jsxs(i.Fragment,{children:[p&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:p}),l&&i.jsxs("div",{className:"bg-white rounded-lg shadow-md md:p-6 border-l-4 md:border-l-8 border-purple-500 overflow-hidden",children:[i.jsxs("div",{className:"mobile-tabs md:hidden flex mb-4",children:[i.jsx("button",{className:`mobile-tab-btn ${Q==="info"?"active":""}`,onClick:()=>Y("info"),children:"Patient Record"}),i.jsx("button",{className:`mobile-tab-btn ${Q==="history"?"active":""}`,onClick:()=>Y("history"),children:"History"})]}),i.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[i.jsxs("div",{className:`flex-grow md:w-1/2 ${Q==="info"?"block":"hidden md:block"}`,children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"text-xl text-purple-700 font-semibold flex items-center gap-2",children:"Patient Record"}),i.jsxs("button",{onClick:()=>R("/dashboard/doctor"),className:"text-xs font-medium text-slate-500 hover:text-slate-800 flex items-center gap-1 transition-colors px-2 py-1 bg-slate-100 rounded",children:[i.jsx(rn,{size:12})," Back to Queue"]})]}),i.jsx("div",{className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-700 to-indigo-600 mb-1 leading-tight",children:l.name}),i.jsxs("div",{className:"text-lg text-slate-600 mb-4 flex items-center gap-2",children:[i.jsxs("span",{className:"bg-slate-100 px-2 py-0.5 rounded text-sm font-semibold",children:[l.age||"N/A"," Yrs"]}),i.jsx("span",{className:"bg-slate-100 px-2 py-0.5 rounded text-sm font-semibold",children:l.gender||"N/A"})]}),i.jsxs("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-sm",children:[i.jsx("label",{className:"font-semibold block mb-2 text-xs uppercase tracking-wider text-slate-500",children:"Latest Activity"}),f?i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("span",{className:"text-sm flex-1 break-words text-slate-700",children:[i.jsx("span",{className:"font-medium text-slate-900",children:"Complaint:"})," ",f.complaint||i.jsx("span",{className:"text-slate-400 italic",children:"None"}),i.jsx("div",{className:"mt-1",children:i.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium uppercase tracking-wide ${f.status==="consulting"?"bg-teal-100 text-teal-800":f.status==="seen"?"bg-emerald-100 text-emerald-800":f.status==="waiting"?"bg-blue-100 text-blue-800":"bg-slate-100 text-slate-800"}`,children:te(f.status)})})]}),f.status==="consulting"&&f._id&&i.jsx("button",{onClick:()=>R(`/dashboard/edit-complaint/${f._id}`),className:"ml-4 px-3 py-1.5 text-xs bg-indigo-50 hover:bg-indigo-100 text-indigo-700 rounded-md font-medium border border-indigo-200 transition-colors",children:"Resume"})]}),f.case_summary&&i.jsxs("div",{className:"text-xs text-slate-700 bg-amber-50 p-2.5 rounded border border-amber-100",children:[i.jsx("span",{className:"font-bold text-amber-800 uppercase text-[10px] block mb-1",children:"AI Summary"}),f.case_summary]})]}):i.jsx("p",{className:"text-slate-400 italic text-sm",children:"No queue entry found for this patient today."})]})]}),i.jsxs("div",{className:`md:w-1/2 mt-4 md:mt-0 pt-4 md:pt-0 ${Q==="history"?"block":"hidden md:block"} border-t md:border-t-0 md:border-l md:pl-6`,children:[i.jsxs("h3",{className:"text-base font-semibold text-slate-800 mb-3 flex items-center justify-between",children:[i.jsx("span",{children:"Patient History"}),S&&i.jsx("span",{className:"text-xs font-normal text-indigo-600 animate-pulse",children:"Loading..."})]}),T&&i.jsx("p",{className:"text-red-500 text-xs mb-2 bg-red-50 p-2 rounded",children:T}),i.jsxs("div",{className:"space-y-3 pr-1 md:max-h-[500px] md:overflow-y-auto custom-scrollbar",children:[i.jsx(xh,{title:"Past Complaints",icon:du,items:B,isLoading:S,loadingText:"Loading...",noDataText:"No past complaints.",renderItemContent:le=>i.jsxs("div",{className:"text-xs",children:[le.data.complaint,i.jsx("div",{className:"text-slate-400 mt-0.5 text-[10px]",children:iu(le.originalDateString)})]})}),i.jsx(xh,{title:"Lab Reports",icon:Jl,items:J,isLoading:S,loadingText:"Loading...",noDataText:"No lab history.",renderItemContent:le=>le.type==="Lab Order (Pending)"?i.jsxs("div",{className:"text-xs",children:[i.jsx("div",{className:"font-medium text-blue-700 mb-0.5",children:"Pending Order"}),i.jsx("div",{children:le.data.tests.map(E=>E.name).join(", ")}),i.jsx("div",{className:"text-slate-400 mt-0.5 text-[10px]",children:iu(le.originalDateString)})]}):i.jsxs("div",{className:"text-xs",children:[i.jsxs("div",{className:"font-medium text-emerald-700 mb-0.5",children:["Report: ",le.data.testName]}),i.jsxs("div",{className:"text-slate-600 italic",children:['"',le.data.reportFindings.substring(0,50),le.data.reportFindings.length>50?"...":"",'"']}),i.jsx("div",{className:"text-slate-400 mt-0.5 text-[10px]",children:iu(le.originalDateString)})]})}),i.jsx(xh,{title:"Medications",icon:Ld,items:D,isLoading:S,loadingText:"Loading...",noDataText:"No pharmacy history.",renderItemContent:le=>i.jsxs("div",{className:"text-xs",children:[i.jsx("div",{className:"text-slate-800",children:le.data.medications.map(E=>`${E.name} (${E.quantity})`).join(", ")}),i.jsxs("div",{className:"text-slate-400 mt-0.5 text-[10px]",children:[iu(le.originalDateString),"  ",i.jsx("span",{className:"capitalize",children:le.data.status})]})]})}),B.length===0&&J.length===0&&D.length===0&&!S&&i.jsx("div",{className:"text-slate-400 text-center py-4 text-xs italic bg-slate-50 rounded border border-dashed border-slate-200",children:"No history records found."})]})]})]})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex justify-end space-x-3 mb-4",children:[i.jsxs("button",{onClick:()=>R("/dashboard/add-patient"),className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded shadow flex items-center",children:[i.jsx(Rk,{size:18,className:"mr-2"})," Add Patient"]}),i.jsx("button",{onClick:()=>R("/search-patient"),className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded shadow",children:"Search Patient"})]}),a&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:a}),t&&!e.currentPatient&&i.jsx("p",{className:"text-gray-500 p-4 text-center",children:"Loading queue..."}),i.jsx("div",{className:"mb-6 md:mb-8",children:V||i.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 text-center text-gray-500",children:"No patient currently being seen. Use 'Call Next' or search for a patient record."})}),i.jsxs("div",{className:"current-queue-section mb-6 md:mb-8",children:[i.jsx("h2",{className:"text-xl text-blue-700 font-semibold mb-3 md:mb-4",children:"NEXT IN QUEUE:"}),e.nextPatient?i.jsxs("div",{className:"patient-info-section bg-blue-50 rounded-lg shadow-md p-5 md:p-6 border-l-8 border-blue-500",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 md:mb-4",children:[i.jsxs("span",{className:"text-2xl md:text-3xl font-bold text-blue-800 mb-2 sm:mb-0",children:["Token #",e.nextPatient.token]}),i.jsx("span",{className:`px-3 py-1 rounded-full text-sm md:text-base font-medium ${e.nextPatient.status==="waiting"?"bg-blue-200 text-blue-900":"bg-gray-200 text-gray-800"}`,children:te(e.nextPatient.status)})]}),i.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-2 md:mb-3",children:e.nextPatient.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-700 mb-3 md:mb-4",children:["Age: ",e.nextPatient.age," | ",e.nextPatient.gender]}),(e.nextPatient.complaint||e.nextPatient.case_summary)&&i.jsxs("div",{className:"mt-3 md:mt-4 pt-3 border-t border-blue-200 space-y-2",children:[e.nextPatient.complaint&&i.jsxs("p",{className:"text-base md:text-lg text-gray-800",children:[i.jsx("span",{className:"font-semibold text-gray-900",children:"Complaint:"})," ",e.nextPatient.complaint]}),e.nextPatient.case_summary&&i.jsxs("p",{className:"text-sm text-gray-700 bg-yellow-50 p-2 rounded border border-yellow-200",children:[i.jsx("span",{className:"font-semibold text-gray-800",children:"AI Summary:"})," ",e.nextPatient.case_summary]})]})]}):i.jsx("div",{className:"bg-gray-50 rounded-lg shadow-inner p-6 text-center text-gray-600 border border-gray-200",children:"No patient waiting next in the queue."})]}),i.jsxs("div",{className:"actions-section mt-auto pt-4 md:pt-6 flex flex-col sm:flex-row justify-between items-center gap-4",children:[i.jsx("button",{onClick:$,disabled:t||!e.nextPatient||!!e.currentPatient,className:"btn btn-primary w-full sm:w-auto disabled:opacity-50 disabled:cursor-not-allowed order-1 sm:order-none",children:"Call Next Patient"}),i.jsx("div",{className:"bg-gray-200 inline-block px-4 py-2 rounded-full order-2 sm:order-none",children:i.jsxs("span",{className:"text-base md:text-lg font-medium",children:[e.waitingCount," patients waiting"]})})]})]})]})})},fE=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,o]=w.useState(null),[l,d]=w.useState(null),[f,u]=w.useState(null),[p,g]=w.useState(null),[b,v]=w.useState(!1),[S,k]=w.useState(!1),[T,A]=w.useState(null),M=Et(),R=w.useCallback($T.debounce(async D=>{if(D.trim().length<2){r([]),k(!1);return}k(!0),A(null);try{const $=new URLSearchParams({search:encodeURIComponent(D),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),H=await pe(`/api/patients?${$.toString()}`);if(!H.ok){const Q=await H.text();throw new Error(`API Error (${H.status}): ${Q||H.statusText||"Failed to fetch patients"}`)}const te=await H.json();r(te.patients)}catch($){A($ instanceof Error?$.message:"An unknown error occurred while searching patients"),r([])}finally{k(!1)}},500),[]);w.useEffect(()=>(e?(k(!0),R(e)):(r([]),R.cancel()),()=>{R.cancel()}),[e,R]);const z=D=>{o(D),n(""),r([]),A(null),d(null),u(null),g(null),v(!1)},F=async()=>{if(!a){A("No patient selected.");return}A(null),k(!0);try{const D=await pe(`/api/patients/${a.id}/admit`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!D.ok){const H=await D.json().catch(()=>({message:"Failed to admit patient"}));throw new Error(H.message||"Failed to admit patient")}const $=await D.json();alert($.message||"Patient admitted successfully!"),$.bill&&$.bill.id?M(`/patient/${a.id}/admission-bill/${$.bill.id}`):(console.error("Admission successful, but bill ID missing in response."),A("Admission successful, but couldn't navigate to billing."),o($.patient))}catch(D){A(D instanceof Error?D.message:"Failed to admit patient")}finally{k(!1)}};w.useEffect(()=>{(async()=>{if(!a||!a.admission_date||a.discharge_date){d(null),g(null);return}v(!0),u(null),d(null),g(null);try{const $=await pe(`/api/patients/${a.id}/active-bill?type=admission`);if(!$.ok)throw $.status===404?new Error("No active admission bill found."):new Error("Failed to fetch active bill ID.");const H=await $.json(),te=H==null?void 0:H.id;if(!te)throw new Error("Active admission bill ID not found in response.");d(te);const Q=await pe(`/api/bills/${te}`);if(!Q.ok)throw new Error(`Failed to fetch bill details (ID: ${te}). Status: ${Q.status}`);const Y=await Q.json();if(Y&&Y.calculated)g(Y.calculated);else throw console.error("Fetched bill details missing 'calculated' object:",Y),new Error("Fetched bill details are incomplete (missing calculated data).")}catch($){u($ instanceof Error?$.message:"An unknown error occurred while fetching bill details."),d(null),g(null)}finally{v(!1)}})()},[a]);const L=async()=>{if(!a){A("No patient selected.");return}if(!a.admission_date||a.discharge_date){A("Patient is not currently admitted.");return}A(null),k(!0);try{const D=await pe(`/api/patients/${a.id}/discharge`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!D.ok){const H=await D.json().catch(()=>({message:"Failed to discharge patient"}));throw new Error(H.message||"Failed to discharge patient")}const $=await D.json();alert($.message||"Patient discharged successfully!"),$.patient?o($.patient):(console.error("Discharge successful, but updated patient info missing in response."),o(null),A("Discharge successful, but couldn't update patient details locally."))}catch(D){A(D instanceof Error?D.message:"Failed to discharge patient")}finally{k(!1)}},U=()=>{if(!a||!l){A("Cannot navigate to billing: Patient or Bill ID missing.");return}M(`/patient/${a.id}/admission-bill/${l}`)};let B="",J=null;if(a){const D=a.admission_date?new Date(a.admission_date).toLocaleDateString():null,$=a.discharge_date?new Date(a.discharge_date).toLocaleDateString():null;a.admission_date?a.admission_date&&!a.discharge_date?(B=`Patient admitted on: ${D}`,J=i.jsxs("div",{className:"space-y-4",children:[" ",b&&i.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Loading billing details..."})," ",f&&i.jsx("p",{className:"text-sm text-red-500 text-center",children:f})," ",!b&&p&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Total Due:"}),i.jsxs("span",{children:["",(Number(p.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[" ",i.jsx("span",{children:"Total Paid:"}),i.jsxs("span",{children:["",(Number(p.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm font-bold mt-1 text-red-600",children:[" ",i.jsx("span",{children:"Balance Due:"}),i.jsxs("span",{children:["",(Number(p.balance)||0).toFixed(2)]})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("button",{onClick:U,disabled:S||b||!l,className:`admission-button admission-button-secondary ${S||b||!l?"opacity-50 cursor-not-allowed":""}`,children:b?"Loading Bill...":!l&&!f?"Finding Bill...":"Pay Bill / View Details"}),i.jsx("button",{onClick:L,disabled:S||b,className:`admission-button admission-button-danger ${S||b?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Discharge Patient"})]})]})):(B=`Patient admitted on ${D} and discharged on ${$}.`,J=i.jsx("p",{className:"text-center text-gray-600 italic",children:"Patient has been discharged."})):(B="Patient is not admitted.",J=i.jsx("button",{onClick:F,disabled:S,className:`admission-button ${S?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Admit Patient"}))}return i.jsxs("div",{className:"admission-page-container",children:[i.jsxs("div",{className:"admission-header-container",children:[i.jsxs("button",{onClick:()=>M(-1),className:"back-button",children:[i.jsx(rn,{size:16}),"Back"]}),i.jsx("h1",{className:"admission-header",children:"Manage Admission/Discharge"})]}),i.jsxs("div",{className:"admission-section mb-6 relative",children:[i.jsx("label",{htmlFor:"patientSearch",className:"admission-label",children:"Search Patient (Name, Phone, or Token)"}),i.jsx("input",{type:"text",id:"patientSearch",value:e,onChange:D=>n(D.target.value),placeholder:"Start typing to search...",className:"admission-input"}),S&&!a&&i.jsx("div",{className:"absolute right-3 top-9 text-sm text-gray-500",children:"Loading..."})," ",t.length>0&&!a&&i.jsxs("ul",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[" ",t.map(D=>i.jsxs("li",{onClick:()=>z(D),className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",children:[" ",D.name," (Token: ",D.token,")",i.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[D.admission_date?`Admitted: ${new Date(D.admission_date).toLocaleDateString()}`:"Not Admitted",D.discharge_date?`, Discharged: ${new Date(D.discharge_date).toLocaleDateString()}`:""]})]},D.id))]}),t.length===0&&e&&!S&&!a&&i.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg p-4 text-gray-500",children:['No patients found matching "',e,'".']})]}),a&&i.jsxs("div",{className:"admission-section",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"admission-section-title",children:"Selected Patient"}),i.jsx("button",{onClick:()=>o(null),className:"admission-link",children:"Clear Selection"})]}),i.jsxs("div",{className:"admission-card-content mb-4 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",a.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Token:"})," ",a.token]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Age:"})," ",a.age??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Gender:"})," ",a.gender??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Phone:"})," ",a.phone??"N/A"]}),i.jsxs("p",{className:"col-span-2",children:[i.jsx("strong",{children:"Address:"})," ",a.address??"N/A"]})]}),i.jsx("hr",{className:"my-4"}),i.jsx("p",{className:"text-sm text-gray-600 mb-3",children:B})," ",T&&i.jsx("p",{className:"text-red-500 text-sm mb-3",children:T})," ",J]})]})},A0=15,$1=()=>{const e=Et(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(""),[u,p]=w.useState(1),[g,b]=w.useState(1),[v,S]=w.useState(0),[k,T]=w.useState("created_at"),[A,M]=w.useState("desc"),[R,z]=w.useState(""),[F,L]=w.useState(!1),[U,B]=w.useState(null),[J,D]=w.useState([]),[$,H]=w.useState(""),[te,Q]=w.useState(!1),[Y,V]=w.useState(null),[ae,re]=w.useState(!0),[le,E]=w.useState(null),[ce,ue]=w.useState(d);w.useEffect(()=>{const X=setTimeout(()=>{ue(d),p(1)},500);return()=>{clearTimeout(X)}},[d]);const I=w.useCallback(async()=>{re(!0),E(null);try{const X=await pe("/api/subscriptions");if(!X.ok){let Ae=`Failed to fetch subscription plans (${X.status})`;try{Ae=(await X.json()).message||Ae}catch{}throw new Error(Ae)}const Se=await X.json();D(Se)}catch(X){console.error("Error fetching subscription plans:",X),E(X.message||"An unknown error occurred while fetching plans."),D([])}finally{re(!1)}},[]),de=w.useCallback(async(X,Se,Ae,Pe,Ze)=>{a(!0),l(null);try{const rt=new URLSearchParams({page:X.toString(),limit:A0.toString(),sortBy:Ae,sortOrder:Pe});Se&&rt.append("search",Se),Ze&&rt.append("gender",Ze);const lt=await pe(`/api/patients?${rt.toString()}`);if(!lt.ok){const ot=await lt.json();throw new Error(ot.message||"Failed to fetch patients")}const ze=await lt.json();t(ze.patients),S(ze.totalCount),p(ze.currentPage),b(ze.totalPages)}catch(rt){console.error("Error fetching patients:",rt),l(`Failed to load patients: ${rt.message}`),t([]),S(0),p(1),b(1)}finally{a(!1)}},[]);w.useEffect(()=>{de(u,ce,k,A,R),I()},[u,ce,k,A,R,de,I]);const fe=X=>{const Se=k===X&&A==="asc"?"desc":"asc";T(X),M(Se),p(1)},W=X=>{try{return new Date(X).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},oe=()=>{L(!1),B(null),H(""),V(null),Q(!1)},se=async(X,Se)=>{t(Ae=>Ae.map(Pe=>Pe.id===X?{...Pe,insurance_type:Se}:Pe));try{const Ae=await pe(`/api/patients/${X}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:Se})});if(!Ae.ok){const Pe=await Ae.json();throw new Error(Pe.message||"Failed to update insurance type")}}catch(Ae){console.error("Error updating insurance type:",Ae),de(u,ce,k,A,R)}},je=(X,Se)=>{const Ae=new Date(X),Pe=Se.interval||1;switch(Se.period){case"daily":Ae.setDate(X.getDate()+Pe);break;case"weekly":Ae.setDate(X.getDate()+Pe*7);break;case"monthly":Ae.setMonth(X.getMonth()+Pe);break;case"yearly":Ae.setFullYear(X.getFullYear()+Pe);break;default:console.warn(`Unknown subscription period: ${Se.period}. Defaulting to 1 month.`),Ae.setMonth(X.getMonth()+1)}return Ae},We=async()=>{if(!U||!$){V("Please select a subscription plan.");return}const X=J.find(Se=>Se.id===$);if(!X){V("Selected plan details not found.");return}Q(!0),V(null);try{const Se=new Date,Ae=je(Se,X),Pe={subscription_plan_id:$,subscription_status:"active",subscription_start_date:Se.toISOString(),subscription_end_date:Ae.toISOString(),subscription_payment_method:"manual"},Ze=await pe(`/api/patients/${U.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Pe)});if(!Ze.ok){const rt=await Ze.json();throw new Error(rt.message||"Failed to update patient subscription")}oe(),de(u,ce,k,A,R)}catch(Se){console.error("Error starting subscription:",Se),V(`Failed to start subscription: ${Se.message}`)}finally{Q(!1)}};return i.jsxs("div",{className:"all-patients-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(rn,{size:16}),"Back"]}),i.jsxs("h1",{className:"all-patients-title",children:[i.jsx(Ys,{size:28}),"All Registered Patients"]}),o&&i.jsxs("div",{className:"error-alert",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:o})]}),i.jsxs("div",{className:"subscription-plans-card",children:[i.jsx("h2",{className:"subscription-plans-title",children:"Available Subscription Plans"}),i.jsx("div",{children:ae?i.jsx("p",{className:"loading-state",children:"Loading plans..."}):le?i.jsxs("p",{className:"error-message",children:["Error loading plans: ",le]}):J.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("ul",{className:"subscription-plans-list",children:J.map(X=>i.jsxs("li",{children:[i.jsx("strong",{children:X.name}),": ",X.price," / ",X.interval," ",X.period,X.interval>1?"s":"",X.description&&i.jsx("span",{className:"plan-description",children:X.description})]},X.id))})})]}),i.jsxs("div",{className:"controls-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by name or phone...",className:"search-input",value:d,onChange:X=>f(X.target.value)}),i.jsx(Hi,{className:"search-input-icon",size:20})]}),i.jsxs("div",{className:"filter-dropdown-wrapper",children:[i.jsx("label",{htmlFor:"genderFilter",className:"sr-only",children:"Filter by Gender"}),i.jsxs("div",{className:"filter-select-container",children:[i.jsx(X3,{size:16,className:"filter-select-icon"}),i.jsxs("select",{id:"genderFilter",value:R,onChange:X=>z(X.target.value),className:"filter-select",children:[i.jsx("option",{value:"",children:"All Genders"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]})]})]}),r?i.jsx("div",{className:"loading-state",children:"Loading patients..."}):n.length===0?i.jsx("div",{className:"empty-state",children:ce?"No patients found matching your search.":"No patients registered yet."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"patients-table-wrapper",children:i.jsxs("table",{className:"patients-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Token"}),i.jsxs("th",{className:"sortable-header",onClick:()=>fe("name"),children:["Name",k==="name"&&(A==="asc"?i.jsx(u1,{size:14,className:"sort-icon"}):i.jsx(MN,{size:14,className:"sort-icon"}))]}),i.jsx("th",{children:"Age"}),i.jsx("th",{children:"Gender"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Address"}),i.jsxs("th",{className:"sortable-header",onClick:()=>fe("created_at"),children:["Registered On",k==="created_at"&&(A==="asc"?i.jsx(u1,{size:14,className:"sort-icon"}):i.jsx(MN,{size:14,className:"sort-icon"}))]}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Insurance Type"})," ",i.jsx("th",{children:"Action"})," "]})}),i.jsx("tbody",{children:n.map(X=>i.jsxs("tr",{children:[i.jsx("td",{children:X.token??"-"}),i.jsx("td",{className:"patient-name",children:X.name}),i.jsx("td",{children:X.age??"-"}),i.jsx("td",{children:X.gender??"-"}),i.jsx("td",{children:X.phone??"-"}),i.jsx("td",{children:X.address??"-"}),i.jsx("td",{children:W(X.created_at)}),i.jsx("td",{children:i.jsx("span",{className:`status-badge ${X.subscription_status==="active"?"active":X.subscription_status==="cancelled"||X.subscription_status==="expired"?"inactive":"none"}`,children:X.subscription_status??"None"})}),i.jsx("td",{children:i.jsxs("select",{value:X.insurance_type,onChange:Se=>se(X.id,Se.target.value),className:"form-select insurance-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"insurance",children:"Insurance"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})}),i.jsx("td",{children:i.jsx("button",{onClick:()=>e(`/start-subscription/${X.id}`),className:"action-button",children:"Start Sub"})})]},X.id))})]})}),g>1&&i.jsxs("div",{className:"pagination-controls",children:[i.jsxs("div",{className:"pagination-info",children:["Showing"," ",i.jsx("span",{className:"font-medium",children:(u-1)*A0+1})," ","to"," ",i.jsx("span",{className:"font-medium",children:Math.min(u*A0,v)})," ","of"," ",i.jsx("span",{className:"font-medium",children:v})," results"]}),i.jsxs("div",{className:"pagination-buttons",children:[i.jsxs("button",{onClick:()=>p(X=>Math.max(X-1,1)),disabled:u===1||r,className:"pagination-button",children:[i.jsx(_b,{size:16,className:"prev-icon"}),"Previous"]}),i.jsxs("span",{className:"pagination-current-page",children:["Page ",i.jsx("span",{className:"font-medium",children:u})," of ",i.jsx("span",{className:"font-medium",children:g})]}),i.jsxs("button",{onClick:()=>p(X=>Math.min(X+1,g)),disabled:u===g||r,className:"pagination-button",children:["Next",i.jsx(Vd,{size:16,className:"next-icon"})]})]})]})]}),F&&U&&i.jsx("div",{className:"subscription-modal-overlay",children:i.jsxs("div",{className:"subscription-modal-content",children:[i.jsxs("div",{className:"subscription-modal-header",children:[i.jsxs("h2",{className:"subscription-modal-title",children:["Start Subscription for ",U.name]}),i.jsx("button",{onClick:oe,className:"subscription-modal-close-button",children:i.jsx(zn,{size:24})})]}),Y&&i.jsx("div",{className:"error-alert",role:"alert",children:i.jsx("span",{children:Y})}),i.jsxs("div",{className:"subscription-modal-body",children:[i.jsx("label",{htmlFor:"subscriptionPlan",className:"form-label",children:"Select Plan:"}),i.jsxs("select",{id:"subscriptionPlan",value:$,onChange:X=>H(X.target.value),className:"form-select",disabled:te||ae||le!==null||J.length===0,children:[i.jsx("option",{value:"",disabled:!0,children:"-- Select a Plan --"}),ae?i.jsx("option",{value:"",disabled:!0,children:"Loading plans..."}):le?i.jsx("option",{value:"",disabled:!0,children:"Error loading plans"}):J.length>0?J.map(X=>i.jsxs("option",{value:X.id,children:[X.name," - ",X.price," (",X.interval," ",X.period,X.interval>1?"s":"",")"]},X.id)):i.jsx("option",{value:"",disabled:!0,children:"No active plans found"})]}),le&&i.jsx("p",{className:"error-message",children:le}),J.length===0&&!ae&&!le&&i.jsx("p",{className:"empty-state",children:"No active subscription plans available."})]}),i.jsxs("div",{className:"subscription-modal-footer",children:[i.jsx("button",{onClick:oe,disabled:te,className:"subscription-modal-button cancel",children:"Cancel"}),i.jsx("button",{onClick:We,disabled:!$||te,className:"subscription-modal-button submit",children:te?"Starting...":"Start Subscription"})]})]})})]})},hE=()=>{const e=Et(),[n]=w.useState(!0),[t,r]=w.useState(""),[a,o]=w.useState([]),[l,d]=w.useState(!1),[f,u]=w.useState(null),[p,g]=w.useState(!1),b=/^\+?[0-9\s\-().]{7,20}$/,v=w.useMemo(()=>Db(async A=>{if(A.trim().length<2){o([]),d(!1),u(null);return}d(!0),u(null);try{const M=new URLSearchParams({search:encodeURIComponent(A),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),R=await pe(`/api/patients?${M.toString()}`);if(!R.ok){const F=await R.text();throw new Error(`API Error (${R.status}): ${F||R.statusText}`)}const z=await R.json();o(z.patients)}catch(M){console.error("Error searching patients:",M),u(M.message||"Failed to search patients."),o([])}finally{d(!1)}},300),[]),S=A=>{const M=A.target.value;r(M),g(b.test(M)),d(!0),v(M)},k=w.useCallback(A=>{e("/billing",{state:{patientId:A.id,patientName:A.name}})},[e]),T=w.useCallback(async()=>{if(!t||!p){u("Invalid phone number to create a new patient.");return}d(!0),u(null);try{const M=await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"direct pharmacy",phone:t,age:null,gender:null,token:null})});if(!M.ok){const z=await M.json();throw new Error(z.message||`Failed to create patient: ${M.statusText}`)}const R=await M.json();alert(`New patient "direct pharmacy" created with phone ${R.phone}.`),k(R)}catch(A){console.error("Error creating new patient:",A),u(A.message||"Failed to create new patient.")}finally{d(!1)}},[t,p,k]);return i.jsxs("div",{className:"create-custom-bill-page p-4 md:p-6 max-w-5xl mx-auto",children:[i.jsx("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:i.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:i.jsx(rn,{size:20})}),i.jsx("h2",{className:"text-2xl",children:"Create Custom Bill"})]})}),n&&i.jsxs("div",{className:"content-section",children:[i.jsx("h3",{className:"section-title",children:"Select Patient"}),i.jsxs("div",{className:"mb-3 relative",children:[i.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"}),i.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:t,onChange:S,className:"custom-text-input mt-1",autoFocus:!0}),l&&i.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),f&&i.jsx("div",{className:"ai-function-status error mb-3 p-3",children:f}),a.length>0&&i.jsx("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:i.jsx("ul",{children:a.map(A=>i.jsxs("li",{onClick:()=>k({id:A.id,name:A.name,token:A.token,age:A.age,gender:A.gender,phone:A.phone}),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[i.jsxs("div",{className:"font-medium",children:[i.jsxs("span",{className:"patient-token mr-2",children:["#",A.token]}),A.name]}),i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[A.age?`${A.age} yrs`:"Age N/A",A.gender?` / ${A.gender}`:" / Gender N/A",A.phone&&i.jsxs("span",{className:"hidden sm:inline",children:[" / ",A.phone]})]})]}),A.phone&&i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",A.phone]})]},A.id))})}),t.length>=2&&!l&&a.length===0&&!f&&i.jsxs(i.Fragment,{children:[i.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',t,'".']}),p&&i.jsx("button",{type:"button",onClick:T,className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:l,children:'Create "direct pharmacy" Patient with this Phone'})]}),t.length<2&&!l&&i.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]})]})},pE=({currentUser:e})=>{const n=Et(),[t,r]=w.useState("select_patient"),[a,o]=w.useState({name:"",age:void 0,gender:null,phone:"",address:""}),[l,d]=w.useState(null),[f,u]=w.useState([]),[p,g]=w.useState([]),[b,v]=w.useState(""),[S,k]=w.useState([]),[T,A]=w.useState(""),[M,R]=w.useState([]),[z,F]=w.useState(!1),[L,U]=w.useState(null),[B,J]=w.useState(null),[D,$]=w.useState(null),[H,te]=w.useState(!1),[Q,Y]=w.useState(!1),[V,ae]=w.useState(!1),re=/^\+?[0-9\s\-().]{7,20}$/,le=/^[a-zA-Z\s'-]{2,}$/,E=w.useCallback(async()=>{if(!(f.length>0)){te(!0),$(null);try{const X=await pe("/api/lab-tests");if(!X.ok)throw new Error("Failed to fetch lab tests");const Se=await X.json();u(Se)}catch(X){console.error("Failed to fetch available lab tests:",X),$("Could not load lab test list: "+X.message),u([])}finally{te(!1)}}},[f.length]);w.useEffect(()=>{if(!b){k([]);return}const X=b.toLowerCase();k(f.filter(Se=>Se.name.toLowerCase().includes(X)||Se.description&&Se.description.toLowerCase().includes(X)).slice(0,10))},[b,f]);const ce=w.useCallback(X=>{const Se={id:X.id,name:X.name,token:X.token,age:X.age,gender:X.gender,phone:X.phone};d(Se),r("create_order"),g([]),v(""),k([]),$(null),E()},[E]),ue=w.useMemo(()=>Db(async X=>{if(X.trim().length<2){R([]),F(!1),U(null);return}F(!0),U(null);try{const Se=new URLSearchParams({search:encodeURIComponent(X),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Ae=await pe(`/api/patients?${Se.toString()}`);if(!Ae.ok){const Ze=await Ae.text();throw new Error(`API Error (${Ae.status}): ${Ze||Ae.statusText}`)}const Pe=await Ae.json();R(Pe.patients)}catch(Se){console.error("Error searching lab patients:",Se),U(Se.message||"Failed to search lab patients."),R([])}finally{F(!1)}},300),[re,le]),I=X=>{const Se=X.target.value;A(Se),Y(re.test(Se)),ae(le.test(Se)&&!re.test(Se)),F(!0),ue(Se)},de=w.useCallback(async X=>{if(!T||X==="phone"&&!Q||X==="name"&&!V){U(`Invalid ${X} to create a new patient.`);return}F(!0),U(null);try{const Ae=await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:X==="name"?T:"direct lab",phone:X==="phone"?T:null,age:null,gender:null,token:null})});if(!Ae.ok){const Ze=await Ae.json();throw new Error(Ze.message||`Failed to create patient: ${Ae.statusText}`)}const Pe=await Ae.json();alert(`New patient "${Pe.name}" created with ${X==="phone"?`phone ${Pe.phone}`:`name ${Pe.name}`}.`),ce({id:Pe.id,name:Pe.name,token:Pe.token??null,age:Pe.age??null,gender:Pe.gender??null,phone:Pe.phone})}catch(Se){console.error("Error creating new patient:",Se),U(Se.message||"Failed to create new patient.")}finally{F(!1)}},[T,Q,V,ce]),fe=()=>{r("select_patient"),d(null),A(""),R([]),U(null)},W=X=>{const{name:Se,value:Ae}=X.target;o(Pe=>({...Pe,[Se]:Se==="age"?Ae?parseInt(Ae,10):void 0:Ae}))},oe=async X=>{if(X.preventDefault(),J(null),!a.name){J("Patient Name is required.");return}const Se={name:a.name,age:a.age,gender:a.gender,phone:a.phone,address:a.address};try{const Ae=await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Se)});if(!Ae.ok){const Ze=await Ae.json();throw new Error(Ze.message||`Failed to create patient: ${Ae.statusText}`)}const Pe=await Ae.json();alert(`Patient "${Pe.name}" created successfully!`),ce({id:Pe.id,name:Pe.name,token:Pe.token??null,age:Pe.age??null,gender:Pe.gender??null,phone:Pe.phone})}catch(Ae){console.error("Failed to create patient:",Ae),J(Ae.message||"Failed to create patient. Please try again.")}},se=X=>{if(p.some(Se=>Se.id===X.id)){$(`${X.name} is already in the order.`),setTimeout(()=>$(null),3e3),v(""),k([]);return}g(Se=>[...Se,{...X}]),v(""),k([])},je=X=>{g(Se=>Se.filter(Ae=>Ae.id!==X))},We=async X=>{if(X.preventDefault(),$(null),!l){$("No patient selected.");return}if(p.length===0){$("No lab tests selected.");return}const Se={patient_id:l.id,tests:p.map(Ae=>({id:Ae.id,name:Ae.name,price:Ae.price}))};console.log("Submitting Lab Order:",Se);try{const Ae=await pe("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Se)});if(!Ae.ok){const rt=await Ae.json();throw console.error("API Error Data:",rt),new Error(rt.message||`Failed to create lab order: ${Ae.statusText}`)}const Pe=await Ae.json();console.log("Lab Order Creation Result:",Pe);let Ze=l.queueId;if(!Ze){const rt=await pe(`/api/queue/patient/${l.id}/latest`);if(rt.ok){const lt=await rt.json();lt!=null&&lt._id&&(Ze=lt._id)}}if(!Ze){const rt=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:l.id})});if(!rt.ok){const ze=await rt.text();throw new Error(`Failed to create queue entry for redirection: ${ze||rt.statusText}`)}const lt=await rt.json();if(lt!=null&&lt.id)Ze=lt.id;else throw new Error("Failed to get ID from new queue entry for redirection.")}alert(`Lab order created successfully for ${l.name}!`),(e==null?void 0:e.role)==="lab"?n("/dashboard"):n(`/dashboard/edit-complaint/${Ze}`)}catch(Ae){console.error("Failed to create lab order:",Ae),$(Ae.message||"Failed to create lab order.")}};return w.useEffect(()=>{E()},[E]),i.jsxs("div",{className:"create-lab-order-container",children:[i.jsxs("div",{className:"create-lab-order-header",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button","aria-label":"Go back",children:[i.jsx(rn,{size:20,style:{marginRight:"8px"}}),"Back"]}),i.jsx("h1",{className:"create-lab-order-title",children:"Create New Lab Order"}),i.jsx("div",{style:{width:"64px"}})," "]}),(t==="select_patient"||t==="create_patient")&&i.jsxs("div",{className:"glass-card",children:[t==="select_patient"&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"header-with-action",children:i.jsx("h2",{className:"card-title",style:{borderBottom:"none",marginBottom:0},children:"Select Patient"})}),i.jsxs("div",{className:"search-container",children:[i.jsx(Hi,{className:"search-icon",size:20}),i.jsx("input",{type:"text",id:"lab-patient-search",placeholder:"Search by Name, Token No, or Phone No...",value:T,onChange:I,className:"modern-input",autoFocus:!0,autoComplete:"off"}),z&&i.jsx("span",{className:"loading-text",style:{position:"absolute",right:"15px",top:"50%",transform:"translateY(-50%)",fontSize:"0.8rem"},children:"Searching..."})]}),L&&i.jsxs("div",{className:"error-message",children:[i.jsx(Ar,{size:18}),L]}),M.length>0&&i.jsx("ul",{className:"patient-list",children:M.map(X=>i.jsxs("li",{onClick:()=>ce(X),className:"patient-list-item",children:[i.jsxs("div",{className:"patient-info",children:[i.jsx("strong",{children:X.name}),i.jsxs("span",{className:"token-badge",children:["#",X.token||"N/A"]})]}),i.jsxs("div",{className:"patient-details",children:[X.age?`${X.age} yrs`:"",X.gender?` / ${X.gender}`:"",X.phone?`  ${X.phone}`:""]})]},X.id))}),T.length>=2&&!z&&M.length===0&&!L&&i.jsxs("div",{style:{textAlign:"center",marginTop:"20px"},children:[i.jsxs("p",{className:"no-data-message",style:{background:"none",border:"none",padding:0},children:['No patients found matching "',T,'".']}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"15px",marginTop:"15px"},children:[Q&&i.jsxs("button",{type:"button",onClick:()=>de("phone"),className:"secondary-button",children:['Create "Direct Lab" Patient (Phone: ',T,")"]}),V&&i.jsxs("button",{type:"button",onClick:()=>de("name"),className:"secondary-button",children:["Create Patient (Name: ",T,")"]})]})]}),T.length<2&&!z&&i.jsx("div",{className:"info-message",children:"Start typing to search for a patient..."})]}),t==="create_patient"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"header-with-action",children:[i.jsx("h2",{className:"card-title",style:{borderBottom:"none",marginBottom:0},children:"New Patient Registration"}),i.jsx("button",{onClick:fe,className:"text-button",children:" Back to Search "})]}),B&&i.jsxs("div",{className:"error-message",children:[i.jsx(Ar,{size:18}),B]}),i.jsxs("form",{onSubmit:oe,children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{htmlFor:"lab-patient-name",className:"form-label",children:"Patient Name *"}),i.jsxs("div",{className:"search-container",style:{margin:0},children:[i.jsx(Ys,{className:"search-icon",size:18}),i.jsx("input",{type:"text",name:"name",id:"lab-patient-name",required:!0,value:a.name,onChange:W,className:"modern-input",placeholder:"Enter full name"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lab-patient-age",className:"form-label",children:"Age"}),i.jsx("input",{type:"number",name:"age",id:"lab-patient-age",value:a.age??"",onChange:W,className:"modern-input",style:{paddingLeft:"16px"},placeholder:"e.g. 30"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lab-patient-gender",className:"form-label",children:"Gender"}),i.jsxs("select",{name:"gender",id:"lab-patient-gender",value:a.gender??"",onChange:W,className:"modern-input",style:{paddingLeft:"16px"},children:[i.jsx("option",{value:"",children:"Select Gender..."}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{htmlFor:"lab-patient-phone",className:"form-label",children:"Phone Number"}),i.jsxs("div",{className:"search-container",style:{margin:0},children:[i.jsx(Ek,{className:"search-icon",size:18}),i.jsx("input",{type:"tel",name:"phone",id:"lab-patient-phone",value:a.phone||"",onChange:W,className:"modern-input",placeholder:"e.g. 9876543210"})]})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{htmlFor:"lab-patient-address",className:"form-label",children:"Address"}),i.jsxs("div",{className:"search-container",style:{margin:0},children:[i.jsx(jk,{className:"search-icon",size:18,style:{top:"20px"}}),i.jsx("textarea",{name:"address",id:"lab-patient-address",rows:2,value:a.address||"",onChange:W,className:"modern-input",style:{resize:"none"},placeholder:"Enter address (optional)"})]})]})]}),i.jsxs("div",{className:"flex-end",children:[i.jsx("button",{type:"button",onClick:fe,className:"secondary-button",children:" Cancel "}),i.jsxs("button",{type:"submit",className:"primary-button",children:[i.jsx(Zo,{size:18}),"Create & Proceed"]})]})]})]})]}),t==="create_order"&&l&&i.jsxs("div",{className:"glass-card",children:[i.jsxs("div",{className:"header-with-action",children:[i.jsx("h2",{className:"card-title",style:{borderBottom:"none",marginBottom:0},children:"Create Lab Order"}),i.jsx("button",{onClick:fe,className:"text-button",children:" Change Patient "})]}),i.jsxs("div",{className:"patient-summary",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx(Ys,{size:20,className:"highlight-primary"}),i.jsx("span",{style:{fontSize:"1.1rem",fontWeight:"600"},children:l.name})]}),i.jsxs("div",{className:"patient-details",style:{marginLeft:"30px",marginTop:"4px"},children:[l.age?`${l.age} yrs`:"Age N/A",l.gender&&`  ${l.gender}`,l.phone&&`  ${l.phone}`]})]}),D&&i.jsxs("div",{className:"error-message",children:[i.jsx(Ar,{size:18}),D]}),i.jsxs("form",{onSubmit:We,children:[i.jsxs("div",{className:"form-group",style:{position:"relative"},children:[i.jsx("label",{htmlFor:"lab-test-search",className:"form-label",children:"Add Lab Test"}),i.jsxs("div",{className:"search-container",style:{margin:0},children:[i.jsx(Hi,{className:"search-icon",size:18}),i.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search tests (e.g. CBC, Lipid Profile)...",value:b,onChange:X=>v(X.target.value),className:"modern-input",disabled:H,autoComplete:"off"}),H&&i.jsx("div",{className:"loading-spinner-small",style:{position:"absolute",right:"15px",top:"50%",transform:"translateY(-50%)"}})]}),b&&S.length>0&&i.jsx("div",{className:"search-results-dropdown",children:S.map(X=>i.jsxs("div",{onClick:()=>se(X),className:"search-result-item",children:[i.jsx("span",{style:{fontWeight:500},children:X.name}),i.jsxs("span",{className:"highlight-primary",style:{fontWeight:600},children:["",parseFloat(X.price).toFixed(2)]})]},X.id))}),b&&S.length===0&&!H&&i.jsxs("div",{className:"no-data-message",style:{marginTop:"5px",padding:"10px",fontSize:"0.9rem"},children:['No tests found matching "',b,'".']})]}),i.jsxs("div",{style:{marginTop:"30px"},children:[i.jsxs("h4",{className:"card-title",style:{fontSize:"1.1rem"},children:["Selected Tests (",p.length,")"]}),p.length===0?i.jsx("div",{className:"info-message",children:"No tests added yet. Search above to add tests."}):i.jsx("div",{className:"selected-tests-list",children:p.map(X=>i.jsxs("div",{className:"selected-test-item",children:[i.jsx("div",{style:{flex:1},children:i.jsx("div",{style:{fontWeight:500},children:X.name})}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"20px"},children:[i.jsxs("span",{className:"highlight-primary",style:{fontWeight:600},children:["",parseFloat(X.price).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>je(X.id),className:"remove-button",title:"Remove Test",children:i.jsx(Ur,{size:18})})]})]},X.id))})]}),p.length>0&&i.jsxs("div",{className:"total-price",children:["Total: ",p.reduce((X,Se)=>X+parseFloat(Se.price),0).toFixed(2)]}),i.jsxs("div",{className:"flex-end",children:[i.jsx("button",{type:"button",onClick:fe,className:"secondary-button",children:" Cancel Order "}),i.jsxs("button",{type:"submit",disabled:p.length===0,className:"primary-button",children:[i.jsx(U6,{size:18}),"Create Lab Order"]})]})]})]})]})},gY=({currentUser:e})=>{const[n,t]=w.useState("newtons-ai"),[r,a]=w.useState(""),[o,l]=w.useState([]),[d,f]=w.useState(!0),[u,p]=w.useState([]),[g,b]=w.useState(!1),[v,S]=w.useState(null),[k,T]=w.useState(null),A=Et(),M=Br(),R=async()=>{f(!0),T(null);let D=[];try{const $=await pe("/api/queue");if(!$.ok){const Q=await $.json();throw new Error(Q.message||"Failed to fetch queue")}D=await $.json(),console.log("Fetched Initial Queue Data:",JSON.stringify(D,null,2));const H=D.map(async Q=>{if(!Q.patient_id)return console.warn(`Queue entry ${Q.id} has no patient_id.`),Q;try{const Y=await pe(`/api/patients/${Q.patient_id}`);if(!Y.ok)return console.error(`Failed to fetch patient details for ${Q.patient_id}: ${Y.status}`),Q;const V=await Y.json();return{...Q,Patient:{...Q.Patient??{},...V}}}catch(Y){return console.error(`Error fetching patient details for ${Q.patient_id}:`,Y),Q}}),te=await Promise.all(H);console.log("Enriched Queue Data (Before Sort):",JSON.stringify(te,null,2)),te.sort((Q,Y)=>{var E,ce;const V=((E=Q.Patient)==null?void 0:E.subscription_status)==="active",ae=((ce=Y.Patient)==null?void 0:ce.subscription_status)==="active";if(V&&!ae)return-1;if(!V&&ae)return 1;const re=Q.created_at?new Date(Q.created_at).getTime():0,le=Y.created_at?new Date(Y.created_at).getTime():0;return re-le}),console.log("Sorted Queue Data:",JSON.stringify(te,null,2)),l(te)}catch($){console.error("Error in fetchQueue process:",$),T(`Failed to load queue: ${$.message}`),l(D)}finally{f(!1)}},z=async()=>{b(!0),T(null);try{const D=await pe("/api/staff?role=doctor");if(!D.ok){const H=await D.json();throw new Error(H.message||"Failed to fetch doctors")}const $=await D.json();p($.filter(H=>H.active))}catch(D){console.error("Error fetching doctors:",D),T(`Failed to fetch doctors: ${D.message}`)}finally{b(!1)}};w.useEffect(()=>{const $=new URLSearchParams(M.search).get("tab");$&&U.find(te=>te.id===$)&&t($)},[M.search]),w.useEffect(()=>{n==="queue"&&(R(),z()),S(null)},[n]);const F=w.useCallback(async(D,$)=>{if(console.log(`Attempting to assign doctor ${$} to queue ${D}`),T(null),S(null),!$){console.log("No doctor ID provided, skipping assignment.");return}const H=o.find(Y=>Y.id===D);if(!H){console.error(`Queue entry ${D} not found in local state.`),T("Queue entry not found.");return}if(H.doctor_id===$){console.log(`Queue ${D} already assigned to doctor ${$}. Skipping.`);return}const te=async Y=>{if(!Y||!Y.id||!Y.name){T("Cannot proceed: Patient ID or Name is missing."),console.error("assignAndNavigate called with invalid patientInfo",Y);return}const V=async()=>{try{const ae={status:"waiting",doctorId:$},re=await pe(`/api/queue/${D}/status`,{method:"PATCH",body:JSON.stringify(ae)}),le=await re.json();if(!re.ok)throw new Error(le.message||`HTTP error! status: ${re.status}`);const E=u.find(ce=>ce.id===$);return console.log(`Successfully assigned doctor ${E==null?void 0:E.name} to queue ${D}.`),l(ce=>ce.map(ue=>ue.id===D?{...ue,doctor_id:$,status:le.status||ue.status,User:E?{name:E.name}:null,Patient:Y}:ue)),!0}catch(ae){return console.error(`Error assigning doctor for queue ${D}:`,ae),T(`Failed to assign doctor: ${ae.message}`),!1}};Y.subscription_status==="active"?(console.log(`Patient ${Y.name} (ID: ${Y.id}) has active subscription. Assigning doctor directly.`),await V()):(console.log(`Patient ${Y.name} (ID: ${Y.id}) does not have active subscription (Status: ${Y.subscription_status}). Assigning doctor and proceeding to billing.`),await V()?(console.log(`Navigating to billing for patient ${Y.name} (ID: ${Y.id}), queue ID: ${D}, doctor ID: ${$}`),A("/billing",{state:{patientId:Y.id,queueId:D,patientName:Y.name,doctorId:$,billType:"consultation"}})):console.log(`Assignment failed for patient ${Y.name}, skipping navigation.`))},Q=H.Patient;if(Q&&Q.id&&Q.name)console.log("Patient details found in state. Proceeding with assignment."),await te(Q);else{console.warn(`Patient details missing for queue entry ${D}. Fetching patient ${H.patient_id}...`);try{const Y=await pe(`/api/patients/${H.patient_id}`);if(!Y.ok){const ae=await Y.json().catch(()=>({}));throw new Error(ae.message||`Failed to fetch patient details (status ${Y.status})`)}const V=await Y.json();console.log("Successfully fetched patient details:",V),await te(V)}catch(Y){console.error(`Failed to fetch patient details for patient ID ${H.patient_id}:`,Y),T(`Failed to fetch required patient details: ${Y.message}`)}}},[u,o,A]),L=async(D,$)=>{T(null);const H=$==="consulting"?"start consultation":"complete visit";try{const te=o.find(ae=>ae.id===D);if(!te&&$==="consulting")throw new Error("Queue entry not found to start consultation.");let Q={status:$};if($==="consulting"){if(!(te!=null&&te.doctor_id))throw new Error("Cannot start consultation without an assigned doctor.");Q.doctorId=te.doctor_id}const Y=await pe(`/api/queue/${D}/status`,{method:"PATCH",body:JSON.stringify(Q)}),V=await Y.json();if(!Y.ok)throw new Error(V.message||`HTTP error! status: ${Y.status}`);l(ae=>ae.map(re=>re.id===D?{...re,status:$}:re))}catch(te){console.error(`Error trying to ${H}:`,te),T(`Failed to ${H}: ${te.message}`)}},U=[{id:"queue",label:"Queue",icon:i.jsx(Bh,{size:20})},{id:"newtons-ai",label:"Newtons AI",icon:i.jsx(Hi,{size:20})},{id:"manage-admission",label:"Manage Admission",icon:i.jsx(h3,{size:20})},{id:"all-patients",label:"All Patients",icon:i.jsx(o6,{size:20})},{id:"lab",label:"Lab Tests",icon:i.jsx(f1,{size:20})},{id:"custom-bill",label:"Custom Bill",icon:i.jsx(Ra,{size:20})}],B=D=>{try{return new Date(D).toLocaleTimeString("en-IN",{hour:"numeric",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},J=o.filter(D=>{var $,H;return(H=($=D.Patient)==null?void 0:$.name)==null?void 0:H.toLowerCase().includes(r.toLowerCase())});return i.jsx("div",{className:"reception-dashboard-container",children:i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[k&&i.jsxs("div",{className:"error-message-reception",role:"alert",children:[" ",i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:k})]}),i.jsxs("div",{className:"reception-tab-nav",children:[" ",U.map(D=>i.jsxs("button",{className:`reception-tab-button ${n===D.id?"active":""}`,onClick:()=>t(D.id),children:[i.jsx("span",{children:D.icon}),D.label]},D.id))]}),n==="queue"&&i.jsxs("div",{className:"space-y-6",children:[" ",i.jsxs("div",{className:"queue-header",children:[" ",i.jsxs("div",{className:"queue-actions",children:[" ",i.jsxs("div",{className:"search-bar-container",children:[" ",i.jsx("input",{type:"text",placeholder:"Search patients in queue...",className:"search-input",value:r,onChange:D=>a(D.target.value)}),i.jsx(Hi,{className:"search-icon",size:18})]})]}),i.jsxs("div",{className:"summary-cards-grid",children:[" ",i.jsxs("div",{className:"summary-card card-waiting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Waiting"})," ",i.jsx("div",{className:"summary-card-value",children:o.filter(D=>D.status==="waiting").length})," "]}),i.jsxs("div",{className:"summary-card card-consulting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Consulting"})," ",i.jsx("div",{className:"summary-card-value",children:o.filter(D=>D.status==="consulting").length})," "]}),i.jsxs("div",{className:"summary-card card-completed",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Completed"})," ",i.jsx("div",{className:"summary-card-value",children:o.filter(D=>D.status==="seen").length})," "]})]})]}),d?i.jsxs("div",{className:"loading-container",children:[" ",i.jsx("div",{className:"breathing-ball"})," ",i.jsx("span",{children:"Loading queue..."})]}):J.length===0?i.jsx("div",{className:"empty-queue-message",children:r?"No patients found matching your search.":"Queue is empty."}):i.jsxs("div",{className:"queue-table-wrapper",children:[" ",i.jsxs("table",{className:"queue-table",children:[" ",i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Queue"}),i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Phone Number"}),i.jsx("th",{children:"Complaint"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{className:"hidden md:table-cell",children:"Time Added"})," ",i.jsx("th",{className:"text-center",children:"Action / Doctor"})," "]})}),i.jsx("tbody",{children:J.map(D=>{var $,H,te,Q,Y,V,ae,re,le,E,ce;return i.jsxs("tr",{onClick:()=>A(`/dashboard/edit-complaint/${D.id}`),className:"queue-row-clickable",children:[i.jsxs("td",{children:[" ",i.jsxs("span",{className:"queue-token",children:["#",D.token_no]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-name",children:(($=D.Patient)==null?void 0:$.name)||"N/A"})," ",i.jsxs("div",{className:"patient-details",children:[(H=D.Patient)!=null&&H.age?`${D.Patient.age} yrs, `:"",((te=D.Patient)==null?void 0:te.gender)||""]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-phone",children:((Q=D.Patient)==null?void 0:Q.phone)||"N/A"})," "]}),i.jsx("td",{className:"complaint-text",children:D.complaint||"-"}),i.jsxs("td",{children:[i.jsx("span",{className:`subscription-status-badge ${((Y=D.Patient)==null?void 0:Y.subscription_status)==="active"?"status-active":((V=D.Patient)==null?void 0:V.subscription_status)==="cancelled"||((ae=D.Patient)==null?void 0:ae.subscription_status)==="expired"?"status-inactive":"status-none"}`,children:((re=D.Patient)==null?void 0:re.subscription_status)??"None"}),D.Patient&&D.Patient.id&&D.Patient.subscription_status!=="active"&&i.jsx("button",{onClick:ue=>{ue.stopPropagation(),D.Patient&&A(`/start-subscription/${D.Patient.id}`)},className:"action-button btn-start-sub-queue mt-2",children:"Start Sub"})]}),i.jsx("td",{className:"hidden md:table-cell time-added",children:B(D.created_at)}),i.jsx("td",{className:"action-doctor-cell",children:v===D.id?i.jsx("div",{className:"relative inline-block text-left w-full",onClick:ue=>ue.stopPropagation(),children:i.jsxs("select",{value:"",onChange:ue=>F(D.id,ue.target.value),onBlur:()=>S(null),className:"doctor-select-dropdown",autoFocus:!0,children:[i.jsx("option",{value:"",disabled:!0,children:"Select Doctor..."}),g?i.jsx("option",{disabled:!0,children:"Loading..."}):u.length>0?u.map(ue=>i.jsx("option",{value:ue.id,children:ue.name},ue.id)):i.jsx("option",{disabled:!0,children:"No doctors available"})]})}):i.jsxs("div",{className:"action-doctor-content",onClick:ue=>ue.stopPropagation(),children:[" ",D.status==="waiting"&&i.jsx(i.Fragment,{children:(le=D.User)!=null&&le.name?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"doctor-name-display",children:D.User.name}),i.jsx("button",{onClick:()=>L(D.id,"consulting"),className:"action-button btn-start",children:"Start"})]}):g?i.jsx("span",{className:"status-text-italic",children:"Loading..."}):u.length===0?i.jsx("span",{className:"status-text-red",children:"No doctors"}):u.length===1?i.jsxs("button",{onClick:()=>F(D.id,u[0].id),className:"action-button btn-assign",children:["Assign ",u[0].name]}):i.jsx("button",{onClick:()=>S(D.id),className:"action-button btn-assign",children:"Assign"})}),D.status==="consulting"&&i.jsxs(i.Fragment,{children:[((E=D.User)==null?void 0:E.name)&&i.jsx("span",{className:"doctor-name-display",children:D.User.name}),i.jsx("button",{onClick:()=>L(D.id,"seen"),className:"action-button btn-complete",children:"Complete"})]}),D.status==="seen"&&i.jsxs(i.Fragment,{children:[((ce=D.User)==null?void 0:ce.name)&&i.jsx("span",{className:"doctor-name-display",children:D.User.name}),i.jsx("span",{className:"status-text-italic",children:"Completed"})]}),D.status==="cancelled"&&i.jsx("span",{className:"status-text-red",children:"Cancelled"})]})})]},D.id)})})]})]})]}),n==="lab"&&i.jsxs("div",{className:"lab-tab-content",children:[" ",i.jsx(pE,{currentUser:e}),i.jsxs("button",{onClick:()=>A("/lab/search-report"),className:"lab-action-button btn-search-lab-reports",children:[i.jsx(Hi,{size:16}),"Search Lab Reports"]})]}),n==="newtons-ai"&&i.jsx("div",{className:"newtons-ai-tab-content",children:i.jsx(_h,{})}),n==="manage-admission"&&i.jsx("div",{className:"manage-admission-tab-content",children:i.jsx(fE,{})}),n==="all-patients"&&i.jsx("div",{className:"all-patients-tab-content",children:i.jsx($1,{})}),n==="custom-bill"&&i.jsx("div",{className:"custom-bill-tab-content",children:i.jsx(hE,{})})]})})},mE=6048e5,yY=864e5,gE=6e4,yE=36e5,L_=Symbol.for("constructDateFrom");function Ws(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&L_ in e?e[L_](n):e instanceof Date?new e.constructor(n):new Date(n)}function ki(e,n){return Ws(n||e,e)}function xY(e,n,t){const r=ki(e,t==null?void 0:t.in);if(isNaN(n))return Ws(e,NaN);const a=r.getDate(),o=Ws(e,r.getTime());o.setMonth(r.getMonth()+n+1,0);const l=o.getDate();return a>=l?o:(r.setFullYear(o.getFullYear(),o.getMonth(),a),r)}let bY={};function Vb(){return bY}function ng(e,n){var d,f,u,p;const t=Vb(),r=(n==null?void 0:n.weekStartsOn)??((f=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:f.weekStartsOn)??t.weekStartsOn??((p=(u=t.locale)==null?void 0:u.options)==null?void 0:p.weekStartsOn)??0,a=ki(e,n==null?void 0:n.in),o=a.getDay(),l=(o<r?7:0)+o-r;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function hb(e,n){return ng(e,{...n,weekStartsOn:1})}function xE(e,n){const t=ki(e,n==null?void 0:n.in),r=t.getFullYear(),a=Ws(t,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const o=hb(a),l=Ws(t,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const d=hb(l);return t.getTime()>=o.getTime()?r+1:t.getTime()>=d.getTime()?r:r-1}function F_(e){const n=ki(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function vY(e,...n){const t=Ws.bind(null,n.find(r=>typeof r=="object"));return n.map(t)}function $_(e,n){const t=ki(e,n==null?void 0:n.in);return t.setHours(0,0,0,0),t}function wY(e,n,t){const[r,a]=vY(t==null?void 0:t.in,e,n),o=$_(r),l=$_(a),d=+o-F_(o),f=+l-F_(l);return Math.round((d-f)/yY)}function SY(e,n){const t=xE(e,n),r=Ws(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),hb(r)}function NY(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function z1(e){return!(!NY(e)&&typeof e!="number"||isNaN(+ki(e)))}function CY(e,n){const t=ki(e,n==null?void 0:n.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}const _Y={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},jY=(e,n,t)=>{let r;const a=_Y[e];return typeof a=="string"?r=a:n===1?r=a.one:r=a.other.replace("{{count}}",n.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function P0(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const kY={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},TY={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},EY={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},AY={date:P0({formats:kY,defaultWidth:"full"}),time:P0({formats:TY,defaultWidth:"full"}),dateTime:P0({formats:EY,defaultWidth:"full"})},PY={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},DY=(e,n,t,r)=>PY[e];function Im(e){return(n,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,d=t!=null&&t.width?String(t.width):l;a=e.formattingValues[d]||e.formattingValues[l]}else{const l=e.defaultWidth,d=t!=null&&t.width?String(t.width):e.defaultWidth;a=e.values[d]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(n):n;return a[o]}}const IY={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},RY={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},MY={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},OY={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},LY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},FY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},$Y=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},zY={ordinalNumber:$Y,era:Im({values:IY,defaultWidth:"wide"}),quarter:Im({values:RY,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Im({values:MY,defaultWidth:"wide"}),day:Im({values:OY,defaultWidth:"wide"}),dayPeriod:Im({values:LY,defaultWidth:"wide",formattingValues:FY,defaultFormattingWidth:"wide"})};function Rm(e){return(n,t={})=>{const r=t.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],o=n.match(a);if(!o)return null;const l=o[0],d=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(d)?BY(d,g=>g.test(l)):UY(d,g=>g.test(l));let u;u=e.valueCallback?e.valueCallback(f):f,u=t.valueCallback?t.valueCallback(u):u;const p=n.slice(l.length);return{value:u,rest:p}}}function UY(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function BY(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function qY(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const a=r[0],o=n.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=t.valueCallback?t.valueCallback(l):l;const d=n.slice(a.length);return{value:l,rest:d}}}const VY=/^(\d+)(th|st|nd|rd)?/i,HY=/\d+/i,GY={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},YY={any:[/^b/i,/^(a|c)/i]},WY={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},QY={any:[/1/i,/2/i,/3/i,/4/i]},JY={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},KY={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},XY={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},ZY={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},eW={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},tW={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},nW={ordinalNumber:qY({matchPattern:VY,parsePattern:HY,valueCallback:e=>parseInt(e,10)}),era:Rm({matchPatterns:GY,defaultMatchWidth:"wide",parsePatterns:YY,defaultParseWidth:"any"}),quarter:Rm({matchPatterns:WY,defaultMatchWidth:"wide",parsePatterns:QY,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Rm({matchPatterns:JY,defaultMatchWidth:"wide",parsePatterns:KY,defaultParseWidth:"any"}),day:Rm({matchPatterns:XY,defaultMatchWidth:"wide",parsePatterns:ZY,defaultParseWidth:"any"}),dayPeriod:Rm({matchPatterns:eW,defaultMatchWidth:"any",parsePatterns:tW,defaultParseWidth:"any"})},rW={code:"en-US",formatDistance:jY,formatLong:AY,formatRelative:DY,localize:zY,match:nW,options:{weekStartsOn:0,firstWeekContainsDate:1}};function iW(e,n){const t=ki(e,n==null?void 0:n.in);return wY(t,CY(t))+1}function aW(e,n){const t=ki(e,n==null?void 0:n.in),r=+hb(t)-+SY(t);return Math.round(r/mE)+1}function bE(e,n){var p,g,b,v;const t=ki(e,n==null?void 0:n.in),r=t.getFullYear(),a=Vb(),o=(n==null?void 0:n.firstWeekContainsDate)??((g=(p=n==null?void 0:n.locale)==null?void 0:p.options)==null?void 0:g.firstWeekContainsDate)??a.firstWeekContainsDate??((v=(b=a.locale)==null?void 0:b.options)==null?void 0:v.firstWeekContainsDate)??1,l=Ws((n==null?void 0:n.in)||e,0);l.setFullYear(r+1,0,o),l.setHours(0,0,0,0);const d=ng(l,n),f=Ws((n==null?void 0:n.in)||e,0);f.setFullYear(r,0,o),f.setHours(0,0,0,0);const u=ng(f,n);return+t>=+d?r+1:+t>=+u?r:r-1}function sW(e,n){var d,f,u,p;const t=Vb(),r=(n==null?void 0:n.firstWeekContainsDate)??((f=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??t.firstWeekContainsDate??((p=(u=t.locale)==null?void 0:u.options)==null?void 0:p.firstWeekContainsDate)??1,a=bE(e,n),o=Ws((n==null?void 0:n.in)||e,0);return o.setFullYear(a,0,r),o.setHours(0,0,0,0),ng(o,n)}function oW(e,n){const t=ki(e,n==null?void 0:n.in),r=+ng(t,n)-+sW(t,n);return Math.round(r/mE)+1}function Vn(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const au={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return Vn(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):Vn(t+1,2)},d(e,n){return Vn(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return Vn(e.getHours()%12||12,n.length)},H(e,n){return Vn(e.getHours(),n.length)},m(e,n){return Vn(e.getMinutes(),n.length)},s(e,n){return Vn(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,t-3));return Vn(a,n.length)}},bh={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},z_={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return t.ordinalNumber(a,{unit:"year"})}return au.y(e,n)},Y:function(e,n,t,r){const a=bE(e,r),o=a>0?a:1-a;if(n==="YY"){const l=o%100;return Vn(l,2)}return n==="Yo"?t.ordinalNumber(o,{unit:"year"}):Vn(o,n.length)},R:function(e,n){const t=xE(e);return Vn(t,n.length)},u:function(e,n){const t=e.getFullYear();return Vn(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return Vn(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return Vn(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return au.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return Vn(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const a=oW(e,r);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):Vn(a,n.length)},I:function(e,n,t){const r=aW(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):Vn(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):au.d(e,n)},D:function(e,n,t){const r=iW(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):Vn(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(o);case"ee":return Vn(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(o);case"cc":return Vn(o,n.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),a=r===0?7:r;switch(n){case"i":return String(a);case"ii":return Vn(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let a;switch(r===12?a=bh.noon:r===0?a=bh.midnight:a=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let a;switch(r>=17?a=bh.evening:r>=12?a=bh.afternoon:r>=4?a=bh.morning:a=bh.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return au.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):au.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):Vn(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):Vn(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):au.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):au.s(e,n)},S:function(e,n){return au.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return B_(r);case"XXXX":case"XX":return Dd(r);case"XXXXX":case"XXX":default:return Dd(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return B_(r);case"xxxx":case"xx":return Dd(r);case"xxxxx":case"xxx":default:return Dd(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+U_(r,":");case"OOOO":default:return"GMT"+Dd(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+U_(r,":");case"zzzz":default:return"GMT"+Dd(r,":")}},t:function(e,n,t){const r=Math.trunc(+e/1e3);return Vn(r,n.length)},T:function(e,n,t){return Vn(+e,n.length)}};function U_(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),o=r%60;return o===0?t+String(a):t+String(a)+n+Vn(o,2)}function B_(e,n){return e%60===0?(e>0?"-":"+")+Vn(Math.abs(e)/60,2):Dd(e,n)}function Dd(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Vn(Math.trunc(r/60),2),o=Vn(r%60,2);return t+a+n+o}const q_=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},vE=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},lW=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],a=t[2];if(!a)return q_(e,n);let o;switch(r){case"P":o=n.dateTime({width:"short"});break;case"PP":o=n.dateTime({width:"medium"});break;case"PPP":o=n.dateTime({width:"long"});break;case"PPPP":default:o=n.dateTime({width:"full"});break}return o.replace("{{date}}",q_(r,n)).replace("{{time}}",vE(a,n))},cW={p:vE,P:lW},uW=/^D+$/,dW=/^Y+$/,fW=["D","DD","YY","YYYY"];function hW(e){return uW.test(e)}function pW(e){return dW.test(e)}function mW(e,n,t){const r=gW(e,n,t);if(console.warn(r),fW.includes(e))throw new RangeError(r)}function gW(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const yW=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,xW=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,bW=/^'([^]*?)'?$/,vW=/''/g,wW=/[a-zA-Z]/;function Md(e,n,t){var p,g,b,v;const r=Vb(),a=r.locale??rW,o=r.firstWeekContainsDate??((g=(p=r.locale)==null?void 0:p.options)==null?void 0:g.firstWeekContainsDate)??1,l=r.weekStartsOn??((v=(b=r.locale)==null?void 0:b.options)==null?void 0:v.weekStartsOn)??0,d=ki(e,t==null?void 0:t.in);if(!z1(d))throw new RangeError("Invalid time value");let f=n.match(xW).map(S=>{const k=S[0];if(k==="p"||k==="P"){const T=cW[k];return T(S,a.formatLong)}return S}).join("").match(yW).map(S=>{if(S==="''")return{isToken:!1,value:"'"};const k=S[0];if(k==="'")return{isToken:!1,value:SW(S)};if(z_[k])return{isToken:!0,value:S};if(k.match(wW))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");return{isToken:!1,value:S}});a.localize.preprocessor&&(f=a.localize.preprocessor(d,f));const u={firstWeekContainsDate:o,weekStartsOn:l,locale:a};return f.map(S=>{if(!S.isToken)return S.value;const k=S.value;(pW(k)||hW(k))&&mW(k,n,String(e));const T=z_[k[0]];return T(d,k,a.localize,u)}).join("")}function SW(e){const n=e.match(bW);return n?n[1].replace(vW,"'"):e}function D0(e,n){return+ki(e)<+ki(n)}function V_(e,n){const t=()=>Ws(n==null?void 0:n.in,NaN),a=jW(e);let o;if(a.date){const u=kW(a.date,2);o=TW(u.restDateString,u.year)}if(!o||isNaN(+o))return t();const l=+o;let d=0,f;if(a.time&&(d=EW(a.time),isNaN(d)))return t();if(a.timezone){if(f=AW(a.timezone),isNaN(f))return t()}else{const u=new Date(l+d),p=ki(0,n==null?void 0:n.in);return p.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),p.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),p}return ki(l+d+f,n==null?void 0:n.in)}const jx={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},NW=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,CW=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,_W=/^([+-])(\d{2})(?::?(\d{2}))?$/;function jW(e){const n={},t=e.split(jx.dateTimeDelimiter);let r;if(t.length>2)return n;if(/:/.test(t[0])?r=t[0]:(n.date=t[0],r=t[1],jx.timeZoneDelimiter.test(n.date)&&(n.date=e.split(jx.timeZoneDelimiter)[0],r=e.substr(n.date.length,e.length))),r){const a=jx.timezone.exec(r);a?(n.time=r.replace(a[1],""),n.timezone=a[1]):n.time=r}return n}function kW(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),r=e.match(t);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:o===null?a:o*100,restDateString:e.slice((r[1]||r[2]).length)}}function TW(e,n){if(n===null)return new Date(NaN);const t=e.match(NW);if(!t)return new Date(NaN);const r=!!t[4],a=Mm(t[1]),o=Mm(t[2])-1,l=Mm(t[3]),d=Mm(t[4]),f=Mm(t[5])-1;if(r)return MW(n,d,f)?PW(n,d,f):new Date(NaN);{const u=new Date(0);return!IW(n,o,l)||!RW(n,a)?new Date(NaN):(u.setUTCFullYear(n,o,Math.max(a,l)),u)}}function Mm(e){return e?parseInt(e):1}function EW(e){const n=e.match(CW);if(!n)return NaN;const t=I0(n[1]),r=I0(n[2]),a=I0(n[3]);return OW(t,r,a)?t*yE+r*gE+a*1e3:NaN}function I0(e){return e&&parseFloat(e.replace(",","."))||0}function AW(e){if(e==="Z")return 0;const n=e.match(_W);if(!n)return 0;const t=n[1]==="+"?-1:1,r=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return LW(r,a)?t*(r*yE+a*gE):NaN}function PW(e,n,t){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,o=(n-1)*7+t+1-a;return r.setUTCDate(r.getUTCDate()+o),r}const DW=[31,null,31,30,31,30,31,31,30,31,30,31];function wE(e){return e%400===0||e%4===0&&e%100!==0}function IW(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(DW[n]||(wE(e)?29:28))}function RW(e,n){return n>=1&&n<=(wE(e)?366:365)}function MW(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function OW(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function LW(e,n){return n>=0&&n<=59}const Qw=({isEmbedded:e=!1})=>{const[n,t]=w.useState([]),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,p]=w.useState(null),g=w.useRef(null),[b,v]=w.useState(!1),[S,k]=w.useState(null),[T,A]=w.useState(!1),[M,R]=w.useState(!1),[z,F]=w.useState(null),[L,U]=w.useState({name:"",description:"",price:"",default_parameters:[]}),B=w.useCallback(async()=>{a(!0),l(null),p(null),k(null);try{const I=await pe("/api/lab-tests");if(!I.ok)throw new Error(`HTTP error! status: ${I.status}`);const de=await I.json();t(de)}catch(I){console.error("Error fetching lab tests:",I),l(I.message||"Failed to fetch lab tests.")}finally{a(!1)}},[]);w.useEffect(()=>{B()},[B]);const J=I=>{const{name:de,value:fe}=I.target;U(W=>({...W,[de]:fe}))},D=(I,de,fe)=>{const W=[...L.default_parameters],oe=W[I];if(de==="type")switch(oe.type=fe,fe){case"number":oe.defaultValue=0,oe.lower_limit=null,oe.upper_limit=null,oe.unit="";break;case"boolean":oe.defaultValue=!1,oe.lower_limit=void 0,oe.upper_limit=void 0,oe.unit=void 0;break;case"string":default:oe.defaultValue="",oe.lower_limit=void 0,oe.upper_limit=void 0,oe.unit=void 0;break}else de==="defaultValue"?oe.type==="number"?oe.defaultValue=parseFloat(fe)||0:(oe.type,oe.defaultValue=fe):de==="lower_limit"||de==="upper_limit"?oe[de]=fe===""?null:parseFloat(fe):oe[de]=fe;U(se=>({...se,default_parameters:W}))},$=()=>{U(I=>({...I,default_parameters:[...I.default_parameters,{name:"",type:"string",defaultValue:"",unit:"",lower_limit:null,upper_limit:null}]}))},H=I=>{U(de=>({...de,default_parameters:de.default_parameters.filter((fe,W)=>W!==I)}))},te=async I=>{I.preventDefault(),a(!0),l(null);const de=z!==null,fe=de?`/api/lab-tests/${z}`:"/api/lab-tests",W=de?"PUT":"POST";try{const oe=await pe(fe,{method:W,headers:{"Content-Type":"application/json"},body:JSON.stringify({name:L.name,description:L.description,price:parseFloat(L.price),default_parameters:L.default_parameters})});if(!oe.ok){const se=await oe.json();throw new Error(se.message||`HTTP error! status: ${oe.status}`)}R(!1),F(null),U({name:"",description:"",price:"",default_parameters:[]}),B()}catch(oe){console.error(`Error ${de?"updating":"adding"} lab test:`,oe),l(oe.message||`Failed to ${de?"update":"add"} lab test.`)}finally{a(!1)}},Q=()=>{F(null),U({name:"",description:"",price:"",default_parameters:[]}),R(!0)},Y=I=>{if(z===I.id)F(null);else{F(I.id);const de=(I.default_parameters||[]).map(fe=>({...fe,unit:fe.unit||"",lower_limit:fe.lower_limit===void 0?null:fe.lower_limit,upper_limit:fe.upper_limit===void 0?null:fe.upper_limit}));U({name:I.name,description:I.description||"",price:I.price,default_parameters:de}),R(!1)}},V=async I=>{if(window.confirm("Are you sure you want to delete this lab test?")){a(!0),l(null);try{const de=await pe(`/api/lab-tests/${I}`,{method:"DELETE"});if(!de.ok){const fe=await de.json();throw new Error(fe.message||`HTTP error! status: ${de.status}`)}B()}catch(de){console.error("Error deleting lab test:",de),l(de.message||"Failed to delete lab test.")}finally{a(!1)}}},ae=()=>{R(!1),F(null),l(null),U({name:"",description:"",price:"",default_parameters:[]})},re=async I=>{if(!I){p("No file selected.");return}f(!0),p(null),l(null);const de=new FormData;de.append("file",I);try{const fe=await pe("/api/lab-tests/import",{method:"POST",body:de});if(!fe.ok){const W=await fe.json();throw new Error(W.message||`Import failed: ${fe.statusText}`)}B()}catch(fe){console.error("Error importing lab tests from Excel:",fe),p(fe.message||"Failed to import lab tests from Excel.")}finally{f(!1)}},le=async I=>{if(I.target.files&&I.target.files[0]){const de=I.target.files[0];await re(de),I.target&&(I.target.value="")}},E=async()=>{if(window.confirm("Are you sure you want to import default biochemistry and pathology tests? This will add new tests and may duplicate existing ones if names match.")){v(!0),k(null),l(null);try{const I=await pe("/api/lab-tests/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"}});if(!I.ok){const de=await I.json();throw new Error(de.message||`Default import failed: ${I.statusText}`)}B()}catch(I){console.error("Error importing default lab tests:",I),k(I.message||"Failed to import default lab tests.")}finally{v(!1)}}},ce=async()=>{if(window.confirm("Are you sure you want to delete ALL lab tests? This action cannot be undone.")){A(!0),l(null),p(null),k(null);try{const I=await pe("/api/lab-tests/all",{method:"DELETE"});if(!I.ok){const de=await I.json();throw new Error(de.message||`Delete all failed: ${I.statusText}`)}B()}catch(I){console.error("Error deleting all lab tests:",I),l(I.message||"Failed to delete all lab tests.")}finally{A(!1)}}},ue=r||d||b||T;return i.jsxs("div",{className:`lab-inventory-card ${e?"embedded":""}`,style:e?{border:"none",boxShadow:"none",padding:0}:{},children:[!e&&i.jsx("h2",{className:"lab-inventory-header",children:"Available Lab Tests"}),i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px"},children:[i.jsx("button",{onClick:Q,className:"lab-inventory-button",disabled:ue,children:"Add New Test"}),i.jsx("button",{onClick:()=>{var I;return(I=g.current)==null?void 0:I.click()},className:"lab-inventory-button lab-inventory-button-secondary",disabled:ue,children:d?"Importing...":"Import from Excel"}),i.jsx("input",{type:"file",ref:g,onChange:le,accept:".xlsx, .xls",style:{display:"none"},disabled:d}),i.jsx("button",{onClick:E,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ue,children:b?"Importing Defaults...":"Import Default Tests"}),i.jsx("button",{onClick:ce,className:"lab-inventory-button lab-inventory-button-danger",disabled:ue,style:{backgroundColor:"#dc3545",borderColor:"#dc3545",color:"white"},children:T?"Deleting All...":"Delete All Tests"})]}),o&&i.jsx("div",{className:"error-text mb-4",children:o}),u&&i.jsxs("div",{className:"error-text mb-4",children:["Import Excel Error: ",u]}),S&&i.jsxs("div",{className:"error-text mb-4",children:["Import Default Error: ",S]}),M&&i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"20px",marginBottom:"20px"},children:[" ",i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"1px solid #eee",marginBottom:"15px"},children:"Add New Lab Test"}),i.jsxs("form",{onSubmit:te,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:L.name,onChange:J,className:"lab-inventory-input",required:!0,disabled:ue})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:L.description,onChange:J,rows:3,className:"lab-inventory-input",disabled:ue})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:L.price,onChange:J,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:ue})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginTop:"20px",marginBottom:"10px"},children:"Default Parameters"}),L.default_parameters.map((I,de)=>{var fe,W;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:I.name,onChange:oe=>D(de,"name",oe.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:I.type,onChange:oe=>D(de,"type",oe.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),I.type==="boolean"?i.jsxs("select",{value:I.defaultValue.toString(),onChange:oe=>D(de,"defaultValue",oe.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:I.type==="number"?"number":"text",placeholder:"Default Value",value:I.defaultValue.toString(),onChange:oe=>D(de,"defaultValue",oe.target.value),className:"lab-inventory-input"}),I.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:I.lower_limit===null?"":((fe=I.lower_limit)==null?void 0:fe.toString())??"",onChange:oe=>D(de,"lower_limit",oe.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:I.upper_limit===null?"":((W=I.upper_limit)==null?void 0:W.toString())??"",onChange:oe=>D(de,"upper_limit",oe.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:I.unit||"",onChange:oe=>D(de,"unit",oe.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>H(de),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},de)}),i.jsx("button",{type:"button",onClick:$,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:ae,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ue,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:ue,children:r?"Saving...":"Add Test"})]})]})]}),ue&&!M&&i.jsxs("p",{className:"loading-text",children:[" ",d?"Importing Excel data...":b?"Importing default data...":"Loading tests..."]}),!ue&&n.length===0&&!o&&!u&&!S&&i.jsx("p",{className:"no-data-message",children:"No lab tests found. Add one or import from Excel to get started."}),!ue&&n.length>0&&i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{className:"hidden md:table-cell",children:"Description"})," ",i.jsx("th",{children:"Price"}),i.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),i.jsx("tbody",{children:n.map(I=>{const de=z===I.id,fe=I.price&&typeof I.price=="string"?parseFloat(I.price):NaN,W=isNaN(fe)?"0.00":fe.toFixed(2);return i.jsxs(_n.Fragment,{children:[i.jsxs("tr",{onClick:()=>Y(I),style:{cursor:"pointer"},children:[i.jsx("td",{children:I.name}),i.jsx("td",{className:"hidden md:table-cell",style:{whiteSpace:"pre-wrap"},children:I.description||"-"}),i.jsxs("td",{children:["",W]}),i.jsx("td",{style:{textAlign:"right"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[i.jsx("button",{onClick:oe=>{oe.stopPropagation(),Y(I)},className:"lab-inventory-link",disabled:ue,style:{background:"none",border:"none",padding:"0",cursor:"pointer"},children:"Edit"}),i.jsx("button",{onClick:oe=>{oe.stopPropagation(),V(I.id)},className:"lab-inventory-link",disabled:ue,style:{background:"none",border:"none",padding:"0",cursor:"pointer",color:"#dc3545"},children:"Delete"})]})})]}),de&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"10px",marginBottom:"10px",border:"1px solid #ddd",padding:"15px"},children:[i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em"},children:"Edit Lab Test"}),i.jsxs("form",{onSubmit:te,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:L.name,onChange:J,className:"lab-inventory-input",required:!0,disabled:ue})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:L.description,onChange:J,rows:3,className:"lab-inventory-input",disabled:ue})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:L.price,onChange:J,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:ue})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",marginTop:"15px"},children:"Default Parameters"}),L.default_parameters.map((oe,se)=>{var je,We;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:oe.name,onChange:X=>D(se,"name",X.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:oe.type,onChange:X=>D(se,"type",X.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),oe.type==="boolean"?i.jsxs("select",{value:oe.defaultValue.toString(),onChange:X=>D(se,"defaultValue",X.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:oe.type==="number"?"number":"text",placeholder:"Default Value",value:oe.defaultValue.toString(),onChange:X=>D(se,"defaultValue",X.target.value),className:"lab-inventory-input"}),oe.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:oe.lower_limit===null?"":((je=oe.lower_limit)==null?void 0:je.toString())??"",onChange:X=>D(se,"lower_limit",X.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:oe.upper_limit===null?"":((We=oe.upper_limit)==null?void 0:We.toString())??"",onChange:X=>D(se,"upper_limit",X.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:oe.unit||"",onChange:X=>D(se,"unit",X.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>H(se),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},se)}),i.jsx("button",{type:"button",onClick:$,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:ae,className:"lab-inventory-button lab-inventory-button-secondary",disabled:ue,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:ue,children:r?"Saving...":"Update Test"})]})]})]})})})]},I.id)})})]})]})]})},FW=e=>{let n="";if(!e.report_content)return"No report content available.";n+=`*Report Date:* ${e.report_date?new Date(e.report_date).toLocaleDateString():"N/A"}

`;try{const t=JSON.parse(e.report_content);typeof t=="object"&&t!==null&&e.tests?e.tests.forEach((r,a)=>{n+=`*Test: ${r.name}*
`,t[r.id]?Object.entries(t[r.id]).forEach(([o,l])=>{var p;const d=(p=r.default_parameters)==null?void 0:p.find(g=>g.name===o);let f=String(l),u="";if(d){const g=d.unit?` _${d.unit}_`:"";if(d.type==="boolean"){const b=l===!0||l==="true";f=b?"*Reactive*":"Non-Reactive",b||(u="`Normal: Non-Reactive`")}else if(d.type==="number"){const b=typeof l=="string"?parseFloat(l):typeof l=="number"?l:NaN;if(d.lower_limit!=null||d.upper_limit!=null){let v=[];d.lower_limit!=null&&v.push(`${d.lower_limit}`),d.upper_limit!=null&&v.push(`${d.upper_limit}`),u=`\`Normal: ${v.join(" - ")}\`${g}`,!isNaN(b)&&(d.lower_limit!=null&&b<d.lower_limit||d.upper_limit!=null&&b>d.upper_limit)&&(f=`*${f}*`)}}d.unit&&(f+=g)}n+=`${o}: ${f}
`,u&&((d==null?void 0:d.type)==="boolean"&&(l===!0||l==="true")||(n+=`${u}
`))}):n+=`_No parameters reported for this test._
`,a<e.tests.length-1&&(n+=`
`)}):n+=e.report_content}catch{n+=e.report_content}return n},Jw=e=>{var l;if(!((l=e==null?void 0:e.Patient)!=null&&l.phone)){alert("Cannot share report via WhatsApp: Patient phone number is not available.");return}if(!(e!=null&&e.report_content)){alert("Cannot share report: No report content is available to share.");return}const n=e.Patient.name||"Patient",t=FW(e),r=`Hello ${n},

Your lab report is ready.

${t}`,o=`https://wa.me/${$W(e.Patient.phone)}?text=${encodeURIComponent(r)}`;window.open(o,"_blank")},$W=e=>{let n=e.replace(/\D/g,"");const t=/^(?:\\+?91)?[\\s-]*?(\\d{10})$/,r=n.match(t);return r?n="91"+r[1]:n.startsWith("91")||(n="91"+n),n},zW=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState("orders"),[p,g]=w.useState(1),[b]=w.useState(20),[v,S]=w.useState(0),k=w.useMemo(()=>Math.ceil(v/b),[v,b]),T=w.useCallback(async(B=1,J="")=>{o(!0),d(null);try{const D=new URLSearchParams({page:String(B),limit:String(b)});J&&D.append("search",J);const $=await pe(`/api/lab?${D.toString()}`);if(!$.ok)throw new Error(`HTTP error! status: ${$.status}`);const H=await $.json(),te=H.orders.map(Q=>{var Y,V;return{id:Q.id,labTokenNumber:String(Q.lab_token_number??"N/A"),patientName:((Y=Q.Patient)==null?void 0:Y.name)||"N/A",patientId:Q.patient_id,patientTokenNumber:String(((V=Q.Patient)==null?void 0:V.patient_token_number)??"N/A"),tests:(Q.tests||[]).map(ae=>ae.name||"Unknown Test"),date:Md(new Date(Q.createdAt),"yyyy-MM-dd"),status:Q.status,reportId:Q.reportId,billId:Q.billId}});n(te),S(H.totalCount),g(B)}catch(D){console.error("Failed to fetch lab orders:",D),d(D instanceof Error?D.message:"An unknown error occurred"),n([]),S(0)}finally{o(!1)}},[b]);w.useEffect(()=>{console.log(`Fetch effect triggered. Current page: ${p}, Search term: "${t}"`),t.length===0||t.length>=2?(console.log(`Condition met (length ${t.length}). Fetching orders...`),T(p,t)):console.log(`Condition not met (length ${t.length}). Not fetching.`)},[T,p,t]),w.useEffect(()=>{const B=setTimeout(()=>{t.length>=2?p!==1&&g(1):t.length<2&&p!==1&&g(1)},1e3);return()=>{clearTimeout(B)}},[t]);const A=async(B,J)=>{console.log(`Updating order ${B} to status ${J}`);try{const D=await pe(`/api/lab/${B}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:J})});if(!D.ok){const $=await D.json();throw new Error($.message||`Failed to update status: ${D.status}`)}if(J==="completed"){const $=await pe(`/api/lab/orders/${B}/report`);if($.ok){const H=await $.json();Jw(H)}}await T(p,t),console.log(`Order ${B} status updated to ${J}, refetching page ${p}`)}catch(D){console.error("Error updating status:",D),alert(`Failed to update status: ${D instanceof Error?D.message:"Unknown error"}`)}},M=Et(),R=B=>{if(!B){console.error("Cannot navigate to billing: Order data is missing."),alert("Could not open billing page: Order information is missing.");return}B.billId?(console.log(`Navigating to existing bill for Bill ID: ${B.billId}, Patient: ${B.patientName}`),M("/billing",{state:{billId:B.billId,patientId:B.patientId,patientName:B.patientName,billType:"lab"}})):(console.log(`Navigating to LabBillingPage for Order ID: ${B.id}`),M(`/dashboard/lab-billing/${B.id}`))},z=B=>{B&&B.id?M(`/lab/report/${B.id}`):(console.error("Cannot navigate: Order or Order ID is missing."),alert("Could not open the report entry page: Order information is missing."))},F=B=>{switch(B){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:B,className:"status-badge"}}};if(a)return i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsx("div",{className:"text-teal-600 text-xl animate-pulse",children:"Loading Lab Panel..."})});if(l)return i.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-red-50 text-red-700",children:[i.jsx(Ar,{size:48,className:"mb-4"}),i.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Error Loading Lab Data"}),i.jsx("p",{className:"mb-4",children:l}),i.jsx("button",{onClick:()=>T(1,""),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry Fetch"})]});const L=()=>{p>1&&g(B=>B-1)},U=()=>{p<k&&g(B=>B+1)};return i.jsxs("div",{className:"lab-inventory-container",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("button",{onClick:()=>M(-1),className:"back-button mr-4",children:i.jsx(rn,{size:24})}),i.jsx("h2",{className:"text-2xl font-semibold",children:"Lab Panel"})]}),i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px",borderBottom:"1px solid #ddd",paddingBottom:"10px"},children:[i.jsxs("button",{onClick:()=>u("orders"),className:`lab-inventory-button ${f==="orders"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[i.jsx(Nk,{size:16,style:{marginRight:"8px"}}),"Orders"]}),i.jsx("button",{onClick:()=>M("/create-lab-order"),className:"lab-inventory-button",style:{display:"flex",alignItems:"center"},children:"Create New Lab Order"}),i.jsxs("button",{onClick:()=>u("inventory"),className:`lab-inventory-button ${f==="inventory"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[i.jsx(d3,{size:16,style:{marginRight:"8px"}}),"Inventory"]})]}),f==="orders"&&i.jsxs("div",{className:"lab-orders-view",children:[" ",i.jsxs("div",{className:"lab-orders-header-controls",children:[i.jsx("h3",{className:"lab-orders-title",children:"Current Lab Orders"}),i.jsxs("div",{className:"lab-orders-search-container",children:[i.jsx("input",{type:"text",placeholder:"Search name, token, tests...",value:t,onChange:B=>r(B.target.value),className:"lab-inventory-input lab-orders-search-input"}),i.jsx(Hi,{size:18,className:"lab-orders-search-icon"})]})]}),i.jsx("div",{className:"lab-orders-table-container",children:i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient (Token)"}),i.jsx("th",{children:"Tests"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"lab-table-actions-header",children:"Actions"})]})}),i.jsxs("tbody",{children:[a&&!l&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:"Loading orders..."})}),!a&&!l&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."})}),!a&&!l&&e.map(B=>{const J=F(B.status);return i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{children:B.patientName}),i.jsxs("div",{className:"lab-table-patient-token",children:["Token: ",B.patientTokenNumber]})]}),i.jsx("td",{children:B.tests.map((D,$)=>i.jsx("div",{children:D},$))}),i.jsx("td",{className:"hidden md:table-cell",children:B.date}),i.jsx("td",{children:i.jsx("span",{className:J.className,children:J.text})}),i.jsx("td",{children:i.jsxs("div",{className:"lab-table-actions",children:[B.status==="pending"&&i.jsx("button",{onClick:()=>R(B),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),B.status==="billed"&&i.jsx("button",{onClick:()=>A(B.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),B.status==="collected"&&i.jsx("button",{onClick:()=>A(B.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(B.status==="processing"||B.status==="report_ready"||B.status==="reported")&&i.jsx("button",{onClick:()=>z(B),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(B.status==="report_ready"||B.status==="reported")&&i.jsx("button",{onClick:()=>A(B.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(B.status==="completed"||B.status==="report_ready"||B.status==="reported")&&i.jsx("button",{onClick:()=>{B.id?M(`/lab/view-report/${B.id}`):(console.error("Attempted to view report for an order with no ID:",B),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})})]},B.id)})]})]})}),i.jsxs("div",{className:"lab-orders-card-container",children:[a&&!l&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:"Loading orders..."}),!a&&!l&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."}),!a&&!l&&e.map(B=>{const J=F(B.status);return i.jsxs("div",{className:"lab-order-card",children:[i.jsxs("div",{className:"lab-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"lab-card-patient-name",children:B.patientName}),i.jsxs("div",{className:"lab-card-patient-token",children:["Token: ",B.patientTokenNumber]}),i.jsx("div",{className:"lab-card-date",children:B.date})]}),i.jsx("span",{className:`${J.className} lab-card-status-pill`,children:J.text})]}),i.jsxs("div",{className:"lab-card-section",children:[i.jsx("p",{className:"lab-card-section-title",children:"Tests:"}),B.tests.map((D,$)=>i.jsx("div",{className:"lab-card-test-item",children:D},$)),B.tests.length===0&&i.jsx("div",{className:"lab-card-no-tests",children:"No tests listed."})]}),i.jsxs("div",{className:"lab-card-actions",children:[B.status==="pending"&&i.jsx("button",{onClick:()=>R(B),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),B.status==="billed"&&i.jsx("button",{onClick:()=>A(B.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),B.status==="collected"&&i.jsx("button",{onClick:()=>A(B.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(B.status==="processing"||B.status==="report_ready"||B.status==="reported")&&i.jsx("button",{onClick:()=>z(B),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(B.status==="report_ready"||B.status==="reported")&&i.jsx("button",{onClick:()=>A(B.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(B.status==="completed"||B.status==="report_ready"||B.status==="reported")&&i.jsx("button",{onClick:()=>{B.id?M(`/lab/view-report/${B.id}`):(console.error("Attempted to view report for an order with no ID:",B),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})]},B.id)})]}),!a&&v>0&&i.jsxs("div",{className:"lab-pagination-controls",children:[i.jsxs("div",{className:"lab-pagination-info",children:["Showing"," ",i.jsx("strong",{children:(p-1)*b+1})," ","to"," ",i.jsx("strong",{children:Math.min(p*b,v)})," ","of"," ",i.jsx("strong",{children:v})," ","results"]}),i.jsxs("div",{className:"lab-pagination-buttons",children:[i.jsx("button",{onClick:L,disabled:p===1,className:"lab-pagination-button","aria-label":"Previous page",children:i.jsx(_b,{size:18})}),i.jsxs("span",{children:["Page ",p," of ",k]}),i.jsx("button",{onClick:U,disabled:p===k,className:"lab-pagination-button","aria-label":"Next page",children:i.jsx(Vd,{size:18})})]})]})]}),f==="inventory"&&i.jsxs("div",{className:"lab-inventory-content-wrapper",children:[" ",i.jsx(Qw,{})]})]})]})},UW=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,o]=w.useState(!0),[l,d]=w.useState(null),f=Et(),u=w.useRef(null),[p,g]=w.useState(1),[b,v]=w.useState(1),[S,k]=w.useState(0),T=10,A=w.useCallback(async(U,B,J)=>{o(!0),d(null);try{let D=`/api/pharmacy-orders?page=${U}&limit=${B}`;J&&J.trim()!==""&&(D+=`&search=${encodeURIComponent(J.trim())}`);const $=await pe(D);if(!$.ok)throw new Error(`Failed to fetch orders: ${$.statusText} (${$.status})`);const H=await $.json();if(H&&Array.isArray(H.orders)&&typeof H.totalOrders=="number"&&typeof H.totalPages=="number")console.log("Fetched pharmacy orders data:",H.orders),n(H.orders),k(H.totalOrders),v(H.totalPages),g(H.currentPage||U);else throw console.error("Received data does not match expected paginated structure:",H),new Error("Invalid data format received from API")}catch(D){console.error("Failed to fetch pharmacy orders:",D),d(D.message||"Failed to fetch orders. Please try again."),n([]),v(1),k(0)}finally{o(!1)}},[]);w.useEffect(()=>(u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{const U=t===""?p:1;t!==""&&p!==1&&g(1),A(U,T,t)},500),()=>{u.current&&clearTimeout(u.current)}),[t,p,A,T]);const M=U=>{f(`/dashboard/edit-pharmacy-order/${U}`)},R=U=>{d(null),console.log(`Preparing billing navigation for order: ${U}`);const B=e.find(J=>J.id===U);if(B){const J=B.medications.map(D=>{const $=D.price??0;return(D.price===void 0||D.price===null)&&console.warn(`Medication "${D.name}" in order ${U} is missing a price. Defaulting to 0.`),{name:D.name,pack_quantity:D.pack_quantity,loose_quantity:D.loose_quantity,price:$,pack_price:D.pack_price,loose_price:D.loose_price,total_price:D.total_price,isLoose:D.isLoose,unit:D.unit,drug_id:D.drug_id?String(D.drug_id):null,tabletsPerDay:D.tabletsPerDay,numberOfDays:D.numberOfDays,directions_to_use:D.directions_to_use,discount_percentage:0,batch:D.batch,expiry_date:D.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:J}),f(`/dashboard/pharmacy-billing/${U}`,{state:{initialItems:J}})}else console.error(`Order with ID ${U} not found.`),d(`Order with ID ${U} not found.`),alert(`Error: Could not find order ${U} to bill.`)},z=async(U,B)=>{d(null);const J=e.find($=>$.id===U);if(!J){d(`Order with ID ${U} not found.`);return}const D={status:B,medications:J.medications};try{const $=await pe(`/api/pharmacy-orders/${U}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(D)});if(!$.ok){const te=await $.text();throw new Error(`Failed to update status: ${$.statusText} (${$.status}) - ${te}`)}const H=await $.json();n(te=>te.map(Q=>Q.id===H.id?{...Q,status:H.status}:Q))}catch($){console.error("Failed to update order status:",$),d($.message||`Failed to update status for order ${U}.`),alert(`Error updating status for order ${U}: ${$.message||"Please try again."}`)}},F=U=>{switch(U){case"pending":return"status-pill status-pill-pending";case"billed":return"status-pill status-pill-billed";case"dispensed":return"status-pill status-pill-dispensed";case"cancelled":return"status-pill status-pill-cancelled";default:return"status-pill status-pill-default"}},L=U=>{f(`/dashboard/orders/${U.id}`)};return a&&e.length===0&&!l?i.jsx("div",{className:"loading-pulse",children:"Loading Orders..."}):l&&e.length===0?i.jsxs("div",{className:"error-message-box",children:["Error loading orders: ",l]}):i.jsxs("div",{className:"pharmacy-queue-container",children:[i.jsxs("div",{className:"pharmacy-queue-header",children:[i.jsx("h3",{className:"pharmacy-queue-title",children:"Pharmacy Queue"}),i.jsxs("div",{className:"pharmacy-actions-container",children:[i.jsxs("div",{className:"pharmacy-buttons-group",children:[i.jsxs("button",{onClick:()=>f("/dashboard/add-order"),className:"pharmacy-action-button btn-add-order",children:[i.jsx(Ra,{size:16}),"Add Order"]}),i.jsxs("button",{onClick:()=>f("/dashboard/inventory"),className:"pharmacy-action-button btn-inventory",title:"View Pharmacy Inventory",children:[i.jsx(Ld,{size:16}),"Inventory"]}),i.jsxs("button",{onClick:()=>f("/dashboard/search-patient-records"),className:"pharmacy-action-button btn-ai-search",title:"Search Patient Records with Newton's AI",children:[i.jsx(Sk,{size:16}),"Newton's AI"]}),i.jsxs("button",{onClick:()=>f("/dashboard/distributors"),className:"pharmacy-action-button btn-distributors",title:"Manage Distributors",children:[i.jsx(Ld,{size:16}),"Distributors"]})]}),i.jsxs("div",{className:"pharmacy-search-input-container",children:[i.jsx("input",{type:"text",placeholder:"Search orders by patient name, token, or medication...",value:t,onChange:U=>r(U.target.value),className:"pharmacy-search-input"}),i.jsx(Hi,{size:18,className:"pharmacy-search-icon"})]})]})]}),i.jsxs("div",{className:"pharmacy-orders-scroll-container",children:[l&&e.length>0&&i.jsxs("div",{className:"error-message-box",children:["Error: ",l]}),a&&e.length>0&&i.jsx("div",{className:"loading-pulse",children:"Updating Orders..."}),!a&&e.length===0&&!l&&i.jsx("div",{className:"empty-state-message",children:t?`No pharmacy orders found matching "${t}".`:"There are currently no pharmacy orders."}),e.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"pharmacy-table-container",children:i.jsxs("table",{className:"pharmacy-queue-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Medications"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Order Total"})," ",i.jsx("th",{children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map(U=>i.jsxs("tr",{onClick:()=>L(U),style:{cursor:"pointer"},children:[i.jsxs("td",{children:[i.jsx("div",{className:"patient-name",children:U.patientName}),i.jsx("div",{className:"patient-token",title:`Patient Token: ${U.patientTokenNumber}`,children:U.patientTokenNumber})]}),i.jsxs("td",{className:"medication-info",children:[U.medications.map((B,J)=>i.jsxs("div",{className:"medication-item",children:[i.jsxs("span",{children:[B.name," (Packs: ",B.pack_quantity,", Loose: ",B.loose_quantity,", ",B.tabletsPerDay??"N/A","x",B.numberOfDays??"N/A","d)",B.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",B.box_number,")"]})]}),B.directions_to_use&&i.jsxs("span",{className:"medication-directions",children:["Directions: ",B.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[B.pack_price!==void 0&&`Pack Price: ${Number(B.pack_price).toFixed(2)}`,B.loose_price!==void 0&&` | Loose Price: ${Number(B.loose_price).toFixed(2)}`,B.total_price!==void 0&&` | Item Total: ${Number(B.total_price).toFixed(2)}`]})]},J)),U.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",U.prescriptionForUnavailableDrugs]})]}),i.jsx("td",{className:"hidden md:table-cell date-info",children:new Date(U.date).toLocaleDateString()}),i.jsxs("td",{className:"order-total-cell font-semibold",children:["",Number(U.order_total??0).toFixed(2)]}),i.jsx("td",{children:i.jsx("span",{className:F(U.status),children:U.status})}),i.jsx("td",{children:i.jsxs("div",{className:"pharmacy-table-actions",children:[U.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:B=>{B.stopPropagation(),M(U.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx(Kl,{size:14})," Edit"]}),i.jsxs("button",{onClick:B=>{B.stopPropagation(),R(U.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx(Rh,{size:14})," Bill"]})]}),U.status==="billed"&&i.jsxs("button",{onClick:B=>{B.stopPropagation(),z(U.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx(ps,{size:14})," Dispense"]}),(U.status==="pending"||U.status==="billed")&&i.jsx("button",{onClick:B=>{B.stopPropagation(),z(U.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:B=>{B.stopPropagation(),L(U)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})})]},U.id))})]})}),i.jsx("div",{className:"pharmacy-card-view-container",children:e.map(U=>{const B=F(U.status);return i.jsxs("div",{className:"pharmacy-order-card",onClick:()=>L(U),children:[i.jsxs("div",{className:"pharmacy-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"pharmacy-card-patient-name",children:U.patientName||"N/A"}),i.jsxs("div",{className:"pharmacy-card-patient-token",title:`Patient Token: ${U.patientTokenNumber}`,children:["Token: ",U.patientTokenNumber||"N/A"]}),i.jsx("div",{className:"pharmacy-card-date",children:new Date(U.date).toLocaleDateString()})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:B,children:U.status}),U.order_total!==void 0&&i.jsxs("span",{className:"pharmacy-card-order-total font-semibold",children:["",Number(U.order_total).toFixed(2)]})]})]}),i.jsxs("div",{className:"pharmacy-card-medications",children:[i.jsx("p",{className:"pharmacy-card-medications-title",children:"Medications:"}),i.jsxs("div",{className:"space-y-0_5",children:[U.medications.slice(0,2).map((J,D)=>i.jsxs("div",{className:"pharmacy-card-medication-item",children:[i.jsxs("span",{title:`${J.name} (Packs: ${J.pack_quantity}, Loose: ${J.loose_quantity}, ${J.tabletsPerDay??"N/A"}x${J.numberOfDays??"N/A"}d)`,children:[J.name," (Packs: ",J.pack_quantity,", Loose: ",J.loose_quantity,", ",J.tabletsPerDay??"N/A","x",J.numberOfDays??"N/A","d)",J.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",J.box_number,")"]})]}),J.directions_to_use&&i.jsxs("span",{className:"medication-directions",title:`Directions: ${J.directions_to_use}`,children:["Directions: ",J.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[J.pack_price!==void 0&&`Pack Price: ${Number(J.pack_price).toFixed(2)}`,J.loose_price!==void 0&&` | Loose Price: ${Number(J.loose_price).toFixed(2)}`,J.total_price!==void 0&&` | Item Total: ${Number(J.total_price).toFixed(2)}`]})]},D)),U.medications.length>2&&i.jsxs("div",{className:"pharmacy-card-medications-more",children:["...and ",U.medications.length-2," more"]}),U.medications.length===0&&i.jsx("div",{className:"pharmacy-card-no-medications",children:"No medications listed."})]}),U.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",U.prescriptionForUnavailableDrugs]})]}),i.jsxs("div",{className:"pharmacy-card-actions",children:[U.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:J=>{J.stopPropagation(),M(U.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx(Kl,{size:14})," Edit"]}),i.jsxs("button",{onClick:J=>{J.stopPropagation(),R(U.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx(Rh,{size:14})," Bill"]})]}),U.status==="billed"&&i.jsxs("button",{onClick:J=>{J.stopPropagation(),z(U.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx(ps,{size:14})," Dispense"]}),(U.status==="pending"||U.status==="billed")&&i.jsx("button",{onClick:J=>{J.stopPropagation(),z(U.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:J=>{J.stopPropagation(),L(U)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})]},U.id)})})]}),!a&&b>1&&i.jsxs("div",{className:"pharmacy-pagination-container",children:[i.jsxs("div",{className:"pagination-mobile-controls",children:[i.jsx("button",{onClick:()=>g(U=>Math.max(U-1,1)),disabled:p===1,className:"pagination-button prev",children:"Previous"}),i.jsx("button",{onClick:()=>g(U=>Math.min(U+1,b)),disabled:p===b,className:"pagination-button next",children:"Next"})]}),i.jsxs("div",{className:"pagination-desktop-controls",children:[i.jsx("div",{className:"pagination-info",children:i.jsxs("p",{children:["Showing ",i.jsx("span",{className:"font-medium",children:(p-1)*T+1})," ","to ",i.jsx("span",{className:"font-medium",children:Math.min(p*T,S)})," ","of ",i.jsx("span",{className:"font-medium",children:S})," results"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"pagination-nav","aria-label":"Pagination",children:[i.jsxs("button",{onClick:()=>g(U=>Math.max(U-1,1)),disabled:p===1,className:"pagination-nav-button prev",children:[i.jsx("span",{className:"sr-only",children:"Previous"}),i.jsx(_b,{"aria-hidden":"true"})]}),i.jsxs("span",{"aria-current":"page",className:"pagination-current-page",children:["Page ",p," of ",b]}),i.jsxs("button",{onClick:()=>g(U=>Math.min(U+1,b)),disabled:p===b,className:"pagination-nav-button next",children:[i.jsx("span",{className:"sr-only",children:"Next"}),i.jsx(Vd,{"aria-hidden":"true"})]})]})})]})]})]})," "]})},H_=10,BW=3,SE=({isEmbedded:e=!1})=>{const n=Et(),[t,r]=w.useState([]),[a,o]=w.useState([]),[l,d]=w.useState(""),[f,u]=w.useState(!0),[p,g]=w.useState(null),[b,v]=w.useState(new Set),[S,k]=w.useState("all"),T=async()=>{try{const we=await pe("/api/inventory/download-csv");if(!we.ok)throw new Error(`Failed to download CSV: ${we.statusText}`);const xe=await we.blob(),Me=window.URL.createObjectURL(xe),De=document.createElement("a");De.href=Me,De.download="pharmacy_inventory.csv",document.body.appendChild(De),De.click(),De.remove(),window.URL.revokeObjectURL(Me)}catch(we){console.error("Failed to download CSV:",we),g(we.message||"Failed to download inventory CSV. Please try again.")}},[A,M]=w.useState(!1),[R,z]=w.useState(!1),[F,L]=w.useState(null),[U,B]=w.useState(!1),[J,D]=w.useState(new Set),[$,H]=w.useState(1),te=8,[Q,Y]=w.useState(null),[V,ae]=w.useState(0),[re,le]=w.useState(!1),[E,ce]=w.useState(null),[ue,I]=w.useState(1),[de,fe]=w.useState(!1),W=$*te,oe=W-te,se=a.slice(oe,W),je=Math.ceil(a.length/te);w.useEffect(()=>{H(1)},[l,S]);const We=w.useCallback(async()=>{u(!0),g(null);try{const we=await pe("/api/drugs");if(!we.ok)throw new Error(`Failed to fetch drugs: ${we.statusText} (${we.status})`);const xe=await we.json();let Me=Array.isArray(xe)?xe:xe.drugs||[];Me=Me.map(De=>({...De,mrp:parseFloat(String(De.mrp))||0,rate:De.rate!==null&&De.rate!==void 0?parseFloat(String(De.rate)):null,stock:parseInt(String(De.stock),10)||0,gst:De.gst!==null&&De.gst!==void 0?parseFloat(String(De.gst)):null,margin:De.margin!==null&&De.margin!==void 0?parseFloat(String(De.margin)):null,discount:De.discount!==null&&De.discount!==void 0?parseFloat(String(De.discount)):null})),r(Me),o(Me)}catch(we){console.error("Failed to fetch drugs:",we),g(we.message||"Failed to load inventory. Please try again.")}finally{u(!1)}},[]);w.useEffect(()=>{We()},[We]),w.useEffect(()=>{const we=l.toLowerCase();let xe=t.filter(qe=>{var Cn,wt,bt,Ft,St;const st=((Cn=qe.name)==null?void 0:Cn.toLowerCase())||"",yt=((wt=qe.description)==null?void 0:wt.toLowerCase())||"",_t=((bt=qe.supplier)==null?void 0:bt.toLowerCase())||"",cn=((Ft=qe.box_number)==null?void 0:Ft.toLowerCase())||"",gn=((St=qe.brand_name)==null?void 0:St.toLowerCase())||"";return st.includes(we)||yt.includes(we)||_t.includes(we)||cn.includes(we)||gn.includes(we)});const Me=new Date,De=xY(Me,BW);S==="low-stock"?xe=xe.filter(qe=>qe.stock<=H_):S==="near-expiry"?xe=xe.filter(qe=>{if(!qe.expiry_date)return!1;const st=V_(qe.expiry_date);return z1(st)&&D0(st,De)&&!D0(st,Me)}):S==="expired"&&(xe=xe.filter(qe=>{if(!qe.expiry_date)return!1;const st=V_(qe.expiry_date);return z1(st)&&D0(st,Me)})),o(xe)},[l,t,S]);const X=()=>{M(!1),Y(null)},Se=we=>{ae(parseInt(we.target.value,10)||0)},Ae=async we=>{if(we.preventDefault(),g(null),!Q||!Q.id||V===0){g("No drug selected or adjustment amount is zero.");return}try{const xe=await pe(`/api/drugs/${Q.id}/adjust-stock`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantityChange:V})});if(!xe.ok){const De=await xe.json();throw new Error(De.message||`Failed to adjust stock: ${xe.statusText}`)}const Me=await xe.json();r(De=>De.map(qe=>qe.id===Me.id?Me:qe)),X(),alert(`Stock for "${Me.name}" adjusted successfully. New stock: ${Me.stock}`)}catch(xe){console.error("Failed to adjust stock:",xe),g(xe.message||"Failed to adjust stock. Please try again.")}},Pe=we=>{L(we),z(!0)},Ze=()=>{z(!1),L(null)},rt=async()=>{if(!F||!F.id){g("No drug selected for deletion.");return}u(!0),g(null);try{const we=await pe(`/api/drugs/${F.id}`,{method:"DELETE"});if(!we.ok){const xe=await we.json();throw new Error(xe.message||`Failed to delete drug: ${we.statusText}`)}alert(`Drug "${F.name}" deleted successfully.`),We(),Ze()}catch(we){console.error("Failed to delete drug:",we),g(we.message||"Failed to delete drug. Please try again.")}finally{u(!1)}},lt=()=>{B(!0)},ze=()=>{B(!1)},[ot,at]=w.useState(!1),be=()=>{J.size>0&&at(!0)},$e=()=>{at(!1)},Be=async()=>{if(J.size===0){g("No drugs selected for deletion.");return}u(!0),g(null);try{const we=await pe("/api/drugs/batch-delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({drugIds:Array.from(J)})});if(!we.ok){const xe=await we.json();throw new Error(xe.message||`Failed to delete selected drugs: ${we.statusText}`)}alert(`${J.size} drug(s) deleted successfully.`),We(),D(new Set),$e()}catch(we){console.error("Failed to delete selected drugs:",we),g(we.message||"Failed to delete selected drugs. Please try again.")}finally{u(!1)}},ke=async()=>{u(!0),g(null);try{const we=await pe("/api/drugs/all",{method:"DELETE"});if(!we.ok){const xe=await we.json();throw new Error(xe.message||`Failed to delete all drugs: ${we.statusText}`)}alert("All drugs deleted successfully."),We(),ze()}catch(we){console.error("Failed to delete all drugs:",we),g(we.message||"Failed to delete all drugs. Please try again.")}finally{u(!1)}},Ne=we=>{if(!we)return null;const xe=we.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return xe?parseInt(xe[1],10):null},K=we=>{ce(we),I(1),le(!0)},ge=()=>{le(!1),ce(null),I(1)},He=we=>{I(parseInt(we.target.value,10)||0)},Qe=async we=>{if(we.preventDefault(),g(null),!E||!E.id||ue<=0){g("No drug selected or invalid number of packs to convert.");return}const xe=Ne(E.pack);if(!xe||xe<=0){g(`Cannot convert "${E.name}" to loose. Invalid pack unit: ${E.pack||"N/A"}.`);return}if(ue>(E.stock??0)){g(`Cannot convert ${ue} packs. Only ${E.stock??0} packs are in stock.`);return}try{const Me=await pe(`/api/drugs/${E.id}/convert-to-loose`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({packsToConvert:ue,packSize:xe})});if(!Me.ok){const qe=await Me.json();throw new Error(qe.message||`Failed to convert to loose: ${Me.statusText}`)}const De=await Me.json();r(qe=>qe.map(st=>st.id===De.id?De:st)),ge(),alert(`Converted ${ue} pack(s) of "${De.name}" to loose. New stock: ${De.stock} packs, ${De.loose??0} loose units.`)}catch(Me){console.error("Failed to convert to loose:",Me),g(Me.message||"Failed to convert to loose. Please try again.")}finally{u(!1)}},dt=()=>{fe(!0)},At=()=>{fe(!1)},Ht=async()=>{u(!0),g(null);try{const we=await pe("/api/drugs/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!we.ok){const xe=await we.json();throw new Error(xe.message||`Failed to add default medications: ${we.statusText}`)}alert("Default medications added successfully."),We(),At()}catch(we){console.error("Failed to add default medications:",we),g(we.message||"Failed to add default medications. Please try again.")}finally{u(!1)}};return f?i.jsx("div",{className:"loading-indicator",children:"Loading Inventory..."}):p?i.jsxs("div",{className:"error-indicator",children:["Error: ",p]}):i.jsxs("div",{className:`pharmacy-inventory-page ${e?"embedded":""}`,style:e?{minHeight:"auto",padding:"0",background:"transparent"}:{},children:[i.jsx("div",{className:"inventory-header-controls",style:{padding:"20px 20px 0 20px"},children:i.jsxs("div",{className:"inventory-actions-group",children:[i.jsxs("div",{className:"action-group-left",style:{display:"flex",gap:"12px"},children:[i.jsxs("button",{onClick:()=>n("/dashboard/inventory/add"),className:"action-button-outline add-drug-button",children:[i.jsx(Ra,{size:18}),"Add New Drug"]}),i.jsxs("button",{onClick:()=>n("/dashboard/purchase"),className:"action-button-outline",children:[i.jsx(Ra,{size:18}),"Purchase Page"]}),i.jsxs("button",{onClick:()=>n("/dashboard/distributors"),className:"action-button-outline",children:[i.jsx(Ra,{size:18}),"Distributors"]})]}),i.jsxs("div",{className:"action-group-right",style:{display:"flex",gap:"12px"},children:[i.jsx("button",{onClick:T,className:"action-button-outline",children:"Download CSV"}),i.jsxs("button",{onClick:dt,className:"action-button-outline",children:[i.jsx(Ra,{size:18}),"Import Defaults"]}),i.jsxs("button",{onClick:be,className:"action-button-outline delete-button-outline",disabled:J.size===0,children:[i.jsx(Ur,{size:18}),"Delete (",J.size,")"]}),i.jsxs("button",{onClick:lt,className:"action-button-outline delete-all-button-outline",children:[i.jsx(Ur,{size:18}),"Delete All"]})]})]})}),i.jsxs("div",{className:"search-bar-container",style:{padding:"0 20px 20px 20px",borderBottom:"1px solid var(--border-color)",marginBottom:"0"},children:[i.jsxs("div",{className:"search-input-wrapper",style:{maxWidth:"600px"},children:[i.jsx(Hi,{size:20,className:"search-input-icon"}),i.jsx("input",{type:"text",placeholder:"Search drugs...",value:l,onChange:we=>d(we.target.value),className:"inventory-search-input"})]}),i.jsx("div",{className:"filter-dropdown-wrapper",children:i.jsxs("select",{value:S,onChange:we=>k(we.target.value),className:"inventory-filter-select",children:[i.jsx("option",{value:"all",children:"All Drugs"}),i.jsx("option",{value:"low-stock",children:"Low Stock"}),i.jsx("option",{value:"near-expiry",children:"Near Expiry"}),i.jsx("option",{value:"expired",children:"Expired"})]})})]}),i.jsx("div",{className:"inventory-table-container",children:i.jsxs("table",{className:"inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"checkbox-header",children:i.jsx("input",{type:"checkbox",onChange:we=>{if(we.target.checked){const xe=new Set(a.map(Me=>Me.id));D(xe)}else D(new Set)},checked:J.size===a.length&&a.length>0,disabled:a.length===0})}),i.jsx("th",{className:"drug-name-header",children:"DRUG DETAILS"}),i.jsx("th",{className:"pack-header",children:"PACK"}),i.jsx("th",{className:"expiry-header",children:"EXPIRY"}),i.jsx("th",{className:"text-stock qty-header",children:"STOCK"}),i.jsx("th",{className:"text-price mrp-header",children:"MRP"}),i.jsx("th",{className:"text-cost rate-header",children:"RATE"}),i.jsx("th",{className:"box-number-header",children:"BOX"}),i.jsx("th",{className:"discount-header",children:"DISC %"}),i.jsx("th",{className:"margin-header",children:"MARGIN"}),i.jsx("th",{className:"actions-cell",children:"ACTIONS"})]})}),i.jsxs("tbody",{children:[a.length===0&&i.jsx("tr",{className:"no-results-message",children:i.jsx("td",{colSpan:11,children:"No drugs found matching your search."})}),se.map(we=>i.jsxs(_n.Fragment,{children:[i.jsxs("tr",{className:"drug-row",onClick:()=>{const xe=new Set(b);xe.has(we.id)&&we.id!==void 0?xe.delete(we.id):we.id!==void 0&&xe.add(we.id),v(xe)},children:[i.jsx("td",{className:"checkbox-cell",children:i.jsx("input",{type:"checkbox",onClick:xe=>xe.stopPropagation(),checked:J.has(we.id),onChange:()=>{const xe=new Set(J);xe.has(we.id)?xe.delete(we.id):xe.add(we.id),D(xe)}})}),i.jsx("td",{className:"drug-name-cell",children:i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:we.brand_name||we.name||"-"}),we.brand_name&&we.name&&we.brand_name!==we.name&&i.jsx("span",{className:"text-xs text-muted-foreground",style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:we.name})]})}),i.jsx("td",{className:"text-muted pack-cell",children:we.pack||"-"}),i.jsx("td",{className:"text-muted",children:we.expiry_date?new Date(we.expiry_date).toLocaleDateString("en-GB"):"-"}),i.jsxs("td",{className:`text-stock ${we.stock<=H_?"low-stock":""}`,children:[i.jsx("div",{style:{fontWeight:"bold"},children:we.stock}),i.jsx("div",{className:"loose-quantity",children:we.loose!==null&&we.loose!==void 0?`${we.loose} loose`:"0 loose"})]}),i.jsxs("td",{className:"text-muted text-price",children:["",typeof we.mrp=="number"?we.mrp.toFixed(2):"N/A"]}),i.jsx("td",{className:"text-muted text-cost",children:we.rate!==null&&we.rate!==void 0?`${we.rate.toFixed(2)}`:"-"}),i.jsx("td",{className:"text-muted",children:we.box_number||"-"}),i.jsx("td",{className:"text-muted",children:we.discount!==null&&we.discount!==void 0?`${we.discount.toFixed(2)}%`:"0.00%"}),i.jsx("td",{className:"text-muted",children:(()=>{const xe=we.mrp||0,Me=we.rate||0,De=we.discount||0,qe=we.gst||0,yt=Me*(1-De/100)*(1+qe/100),_t=xe-yt;return`${(xe>0?_t/xe*100:0).toFixed(2)}%`})()}),i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsx("button",{onClick:xe=>{xe.stopPropagation(),n(`/dashboard/inventory/edit/${we.id}`)},className:"action-icon-button",title:"Edit Drug",children:i.jsx(Kl,{size:16})}),i.jsx("button",{onClick:xe=>{xe.stopPropagation(),Pe(we)},className:"action-icon-button delete-button",title:"Delete Drug",children:i.jsx(Ur,{size:16})}),i.jsx("button",{onClick:xe=>{xe.stopPropagation(),Y(we),M(!0)},className:"action-icon-button adjust-stock-button",title:"Adjust Stock",children:i.jsx(D3,{size:16})}),i.jsx("button",{onClick:xe=>{xe.stopPropagation(),K(we)},className:"action-icon-button convert-to-loose-button",title:"Convert to Loose",disabled:!we.pack||Ne(we.pack)===null,children:i.jsx(y6,{size:16})})]})})]}),b.has(we.id)&&i.jsx("tr",{className:"collapsible-row",children:i.jsx("td",{colSpan:11,children:i.jsxs("div",{className:"collapsible-content",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Description:"})," ",we.description||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Supplier:"})," ",we.supplier||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Batch:"})," ",we.batch||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"HSN Code:"})," ",we.hsn_code||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"MFG:"})," ",we.mfg||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Loose Price:"}),(()=>{const xe=Ne(we.pack);return xe&&xe>0&&typeof we.mrp=="number"?`${(we.mrp/xe).toFixed(2)}`:"N/A"})()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"GST:"})," ",we.gst!==null&&we.gst!==void 0?`${we.gst.toFixed(2)}%`:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Last Updated:"})," ",new Date(we.last_updated).toLocaleString()]})]})})})]},we.id))]})]})}),je>1&&i.jsxs("div",{className:"pagination-controls",style:{padding:"20px",display:"flex",justifyContent:"center",alignItems:"center",gap:"20px",backgroundColor:"var(--card-bg, #fff)",borderTop:"1px solid var(--border-color)"},children:[i.jsx("button",{onClick:()=>H(we=>Math.max(we-1,1)),disabled:$===1,className:"pagination-button",children:"Previous"}),i.jsxs("span",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:["Page ",$," of ",je]}),i.jsx("button",{onClick:()=>H(we=>Math.min(we+1,je)),disabled:$===je,className:"pagination-button",children:"Next"})]}),R&&F&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Ze,className:"modal-close-button",children:i.jsx(zn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion"}),i.jsxs("p",{className:"modal-description",children:['Are you sure you want to delete "',i.jsx("span",{className:"drug-name",children:F.name||"Unnamed Drug"}),'"? This action cannot be undone.']}),p&&i.jsx("div",{className:"modal-error-message",children:p}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Ze,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:rt,className:"button-delete",children:"Delete"})]})]})}),A&&Q&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:X,className:"modal-close-button",children:i.jsx(zn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Adjust Stock"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:Q.name||"Unnamed Drug"}),i.jsx("br",{}),"Current Stock: ",Q.stock]}),p&&i.jsx("div",{className:"modal-error-message",children:p}),i.jsxs("form",{onSubmit:Ae,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"adjustment",className:"form-label",children:"Adjustment Amount"}),i.jsx("input",{type:"number",name:"adjustment",id:"adjustment",required:!0,step:"1",value:V,onChange:Se,placeholder:"e.g., 10 or -5",className:"form-input"}),i.jsx("p",{className:"form-help-text",children:"Enter a positive number to add stock, negative to remove."})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:X,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Adjust Stock"})]})]})]})}),U&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:ze,className:"modal-close-button",children:i.jsx(zn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of All Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:"ALL"})," drugs from the inventory? This action cannot be undone."]}),p&&i.jsx("div",{className:"modal-error-message",children:p}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:ze,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:ke,className:"button-delete",children:"Delete All"})]})]})}),ot&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:$e,className:"modal-close-button",children:i.jsx(zn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of Selected Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:J.size})," selected drug(s)? This action cannot be undone."]}),p&&i.jsx("div",{className:"modal-error-message",children:p}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:$e,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Be,className:"button-delete",children:"Delete Selected"})]})]})}),re&&E&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:ge,className:"modal-close-button",children:i.jsx(zn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Convert to Loose"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:E.name||"Unnamed Drug"}),i.jsx("br",{}),"Pack Size: ",E.pack,i.jsx("br",{}),"Current Stock: ",E.stock," packs, ",E.loose??0," loose units."]}),p&&i.jsx("div",{className:"modal-error-message",children:p}),i.jsxs("form",{onSubmit:Qe,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"packsToConvert",className:"form-label",children:"Packs to Convert"}),i.jsx("input",{type:"number",name:"packsToConvert",id:"packsToConvert",required:!0,step:"1",min:"1",max:E.stock,value:ue,onChange:He,className:"form-input"}),i.jsxs("p",{className:"form-help-text",children:["Converting ",ue," pack(s) will add ",ue*(Ne(E.pack)||0)," loose units."]})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:ge,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Convert"})]})]})]})}),de&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:At,className:"modal-close-button",children:i.jsx(zn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Add Default Medications"}),i.jsx("p",{className:"modal-description",children:"Are you sure you want to add default medications to the inventory? This will add a predefined set of common medications."}),p&&i.jsx("div",{className:"modal-error-message",children:p}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:At,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Ht,className:"button-submit",children:"Add Defaults"})]})]})})]})},qW=()=>{const e=Et();return i.jsxs("div",{className:"bg-white p-3 md:p-6 rounded-lg shadow",children:[i.jsx("button",{onClick:()=>e(-1),className:"mb-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Back"}),i.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Settings"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Pharmacy settings will be configured here."})]})},NE=()=>{const{id:e}=Gi(),n=Et(),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),[p,g]=w.useState(!1),b=w.useRef(null),v=w.useRef(null),S=w.useRef(null),k=w.useCallback(async()=>{if(!e){d("Drug ID is missing."),o(!1);return}o(!0),d(null);try{const R=await pe(`/api/drugs/${e}`);if(!R.ok){const F=await R.json();throw new Error(F.message||`Failed to fetch drug: ${R.statusText}`)}let z=await R.json();z={...z,name:z.name||"",brand_name:z.brand_name||"",mrp:parseFloat(String(z.mrp))||0,rate:z.rate!==null&&z.rate!==void 0?parseFloat(String(z.rate)):null,stock:parseInt(String(z.stock),10)||0,gst:z.gst!==null&&z.gst!==void 0?parseFloat(String(z.gst)):null,margin:z.margin!==null&&z.margin!==void 0?parseFloat(String(z.margin)):null,discount:z.discount!==null&&z.discount!==void 0?parseFloat(String(z.discount)):null,batch:z.batch||"",hsn_code:z.hsn_code||"",mfg:z.mfg||"",loose:z.loose!==null&&z.loose!==void 0?parseInt(String(z.loose),10):null},r(z)}catch(R){console.error("Failed to fetch drug:",R),d(R.message||"Failed to load drug data. Please try again.")}finally{o(!1)}},[e]);w.useEffect(()=>{k()},[k]),w.useEffect(()=>{const R=F=>{F.key==="Tab"&&v.current===document.activeElement&&(p||(g(!0),setTimeout(()=>{var L;(L=S.current)==null||L.focus()},0),F.preventDefault()))},z=F=>{b.current&&!b.current.contains(F.target)&&g(!1)};return document.addEventListener("keydown",R),document.addEventListener("mousedown",z),()=>{document.removeEventListener("keydown",R),document.removeEventListener("mousedown",z)}},[p]);const T=R=>{const{name:z,value:F,type:L}=R.target;r(U=>U?{...U,[z]:L==="number"?parseFloat(F)||null:F}:null)},A=()=>{n(-1)},M=async R=>{if(R.preventDefault(),d(null),u(!0),!t||!t.id){d("Cannot edit drug: No drug data available."),u(!1);return}if(t.mrp===void 0||t.stock===void 0){d("MRP and Stock Quantity are required."),u(!1);return}const z={...t,name:t.name===""?null:t.name,brand_name:t.brand_name===""?null:t.brand_name,rate:t.rate===0?null:t.rate,expiry_date:t.expiry_date===""?null:t.expiry_date,gst:t.gst===0?null:t.gst,margin:t.margin===0?null:t.margin,discount:t.discount===0?null:t.discount,batch:t.batch===""?null:t.batch,hsn_code:t.hsn_code===""?null:t.hsn_code,mfg:t.mfg===""?null:t.mfg,loose:t.loose===0?null:t.loose};try{const F=await pe(`/api/drugs/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)});if(!F.ok){const U=await F.json();throw new Error(U.message||`Failed to update drug: ${F.statusText}`)}const L=await F.json();alert(`Drug "${L.name}" updated successfully!`),n(-1)}catch(F){console.error("Failed to update drug:",F),d(F.message||"Failed to update drug. Please try again.")}finally{u(!1)}};return a?i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"loading-message",children:"Loading drug data..."})}):l&&!t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"error-message-load",children:["Error: ",l]})}):t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"edit-drug-form-container",children:[i.jsxs("div",{className:"edit-drug-form-header",children:[i.jsxs("h2",{children:["Edit Drug: ",t.name]}),i.jsx("button",{onClick:A,className:"cancel-button",title:"Go Back",children:i.jsx(zn,{size:24})})]}),l&&i.jsx("div",{className:"error-message-submit",children:l}),i.jsxs("form",{onSubmit:M,className:"edit-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-name",className:"form-label",children:"Composition Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Ko,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"edit-name",value:t.name||"",onChange:T,className:"custom-text-input",placeholder:"e.g., Paracetamol",tabIndex:1})," "]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-brand_name",className:"form-label",children:"Brand Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Ko,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"edit-brand_name",value:t.brand_name||"",onChange:T,className:"custom-text-input",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-mrp",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Ko,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"mrp",id:"edit-mrp",required:!0,step:"0.01",min:"0",value:t.mrp,onChange:T,className:"custom-text-input",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Ko,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"stock",id:"edit-stock",required:!0,step:"1",min:"0",value:t.stock,onChange:T,className:"custom-text-input",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-pack",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"pack",id:"edit-pack",value:t.pack||"",onChange:T,className:"custom-text-input",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"edit-expiry_date",value:t.expiry_date||"",onChange:T,className:"custom-text-input",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"edit-box_number",value:t.box_number||"",onChange:T,className:"custom-text-input",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:b,children:[i.jsx("button",{type:"button",onClick:()=>g(!p),className:"form-button w-full text-left",tabIndex:8,ref:v,children:"Others"}),p&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"edit-description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"edit-description",rows:3,value:t.description||"",onChange:T,className:"custom-text-input",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-supplier",className:"form-label",children:"Supplier"}),i.jsx("input",{type:"text",name:"supplier",id:"edit-supplier",value:t.supplier||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:10})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-rate",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"rate",id:"edit-rate",step:"0.01",min:"0",value:t.rate??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:11,ref:S})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"edit-gst",step:"0.01",min:"0",max:"100",value:t.gst??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"edit-margin",step:"0.01",min:"0",max:"100",value:t.margin??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"edit-discount",step:"0.01",min:"0",max:"100",value:t.discount??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"edit-batch",value:t.batch||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"edit-hsn_code",value:t.hsn_code||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"edit-mfg",value:t.mfg||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:17})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-loose",className:"form-label",children:"Loose"}),i.jsx("input",{type:"number",name:"loose",id:"edit-loose",step:"1",min:"0",value:t.loose??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:18})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:A,disabled:f,className:"form-button cancel-form-button",tabIndex:19,children:"Back"}),i.jsx("button",{type:"submit",disabled:f,className:"form-button submit-form-button",tabIndex:20,children:f?"Saving...":"Save Changes"})]})]})]})}):i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"not-found-message",children:"Drug not found."})})},CE=({isOpen:e,onClose:n,onDrugAddedToPurchase:t})=>{const[r,a]=w.useState({name:"",composition:"",description:"",mrp:0,stock:0,pack:"",expiry_date:"",rate:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,p]=w.useState(!1),g=w.useRef(null),b=w.useRef(null),v=w.useRef(null);w.useEffect(()=>{e&&(a({name:"",composition:"",description:"",mrp:0,stock:0,pack:"",expiry_date:"",rate:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),l(null),f(!1),p(!1))},[e]),w.useEffect(()=>{const T=M=>{M.key==="Tab"&&b.current===document.activeElement&&(u||(p(!0),setTimeout(()=>{var R;(R=v.current)==null||R.focus()},0),M.preventDefault()))},A=M=>{g.current&&!g.current.contains(M.target)&&p(!1)};return document.addEventListener("keydown",T),document.addEventListener("mousedown",A),()=>{document.removeEventListener("keydown",T),document.removeEventListener("mousedown",A)}},[u]);const S=T=>{const{name:A,value:M,type:R}=T.target;a(z=>({...z,[A]:R==="number"?parseFloat(M)||null:M}))},k=T=>{if(T.preventDefault(),l(null),f(!0),r.mrp===void 0||r.stock===void 0){l("MRP and Stock Quantity are required."),f(!1);return}const A={...r,name:r.name===""?null:r.name,composition:r.composition===""?null:r.composition,rate:r.rate===0?null:r.rate,expiry_date:r.expiry_date===""?null:r.expiry_date,gst:r.gst===0?null:r.gst,margin:r.margin===0?null:r.margin,discount:r.discount===0?null:r.discount,brand_name:r.brand_name===""?null:r.brand_name,batch:r.batch===""?null:r.batch,hsn_code:r.hsn_code===""?null:r.hsn_code,mfg:r.mfg===""?null:r.mfg,loose:r.loose===0?null:r.loose};t(A),f(!1),n()};return e?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content add-drug-form-container max-w-2xl mx-auto",children:[i.jsxs("div",{className:"add-drug-form-header",children:[i.jsx("h2",{children:"Add New Drug"}),i.jsx("button",{onClick:n,className:"cancel-button",title:"Close",children:i.jsx(zn,{size:24})})]}),o&&i.jsx("div",{className:"error-message",children:o}),i.jsxs("form",{onSubmit:k,className:"add-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"name",className:"form-label",children:"Composition Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Ko,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"name",value:r.name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Paracetamol",tabIndex:1})]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"brand_name",className:"form-label",children:"Brand Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Ko,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"brand_name",value:r.brand_name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"mrp",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Ko,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"mrp",id:"mrp",required:!0,step:"0.01",min:"0",value:r.mrp,onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(Ko,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"stock",id:"stock",required:!0,step:"1",min:"0",value:r.stock,onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"pack",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"pack",id:"pack",value:r.pack||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"expiry_date",value:r.expiry_date||"",onChange:S,className:"custom-text-input mt-1",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"box_number",value:r.box_number||"",onChange:S,className:"custom-text-input mt-1",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:g,children:[i.jsx("button",{type:"button",onClick:()=>p(!u),className:"form-button w-full text-left",tabIndex:8,ref:b,children:"Others"}),u&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"description",rows:3,value:r.description||"",onChange:S,className:"custom-text-input mt-1",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"rate",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"rate",id:"rate",step:"0.01",min:"0",value:r.rate??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:10,ref:v})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"gst",step:"0.01",min:"0",max:"100",value:r.gst??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:11})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"margin",step:"0.01",min:"0",max:"100",value:r.margin??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"discount",step:"0.01",min:"0",max:"100",value:r.discount??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"batch",value:r.batch||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"hsn_code",value:r.hsn_code||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"mfg",value:r.mfg||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"loose",className:"form-label",children:"Loose Quantity"}),i.jsx("input",{type:"number",name:"loose",id:"loose",step:"1",min:"0",value:r.loose??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:17})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:n,disabled:d,className:"form-button cancel-form-button",tabIndex:18,children:"Cancel"}),i.jsx("button",{type:"submit",disabled:d,className:"form-button submit-form-button inline-flex justify-center",tabIndex:19,children:d?"Adding...":"Add Drug"})]})]})]})}):null},VW=()=>{const e=Et(),n=async t=>{try{const r=await pe("/api/drugs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok){const a=await r.json();throw new Error(a.message||"Failed to add drug")}e(-1)}catch(r){console.error("Error adding drug:",r),alert(`Failed to add drug: ${r.message}`)}};return i.jsx("div",{className:"add-drug-page-wrapper",style:{paddingTop:"2rem"},children:i.jsx(CE,{isOpen:!0,onClose:()=>e(-1),onDrugAddedToPurchase:n})})},U1=()=>{const e=Et(),[n,t]=w.useState({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),[u,p]=w.useState(""),[g,b]=w.useState([]),[v,S]=w.useState(null),[k,T]=w.useState(!1),[A,M]=w.useState([]),[R,z]=w.useState(!0);w.useEffect(()=>{(async()=>{z(!0);try{const $=await pe("/api/staff?role=doctor");if(!$.ok)throw new Error("Failed to fetch doctors");const H=await $.json();M(H),H.length>0&&t(te=>({...te,doctorId:""}))}catch($){console.error("Error fetching doctors:",$),l(`Failed to load doctors: ${$.message}`)}finally{z(!1)}})()},[]);const F=w.useCallback(async()=>{if(u.trim()){T(!0),l(null),b([]);try{const D=encodeURIComponent(u.trim()),$=await pe(`/api/patients?search=${D}&limit=10`);if(!$.ok){const te=await $.json().catch(()=>({message:"Failed to search patients"}));throw new Error(te.message||"Failed to search patients")}const H=await $.json();H&&Array.isArray(H.patients)?b(H.patients):(console.error("Unexpected response format from patient search:",H),b([]))}catch(D){console.error("Error searching patients:",D),l(`Search failed: ${D.message}`)}finally{T(!1)}}},[u]);w.useEffect(()=>{if(u.trim().length<2){b([]),l(null);return}const D=setTimeout(()=>{F()},300);return()=>clearTimeout(D)},[u,F]);const L=D=>{S(D),p(""),b([]),l(null),t($=>({...$,name:"",age:"",gender:"",phone:""}))},U=()=>{S(null),p(""),b([]),l(null),t(D=>({...D,name:"",age:"",gender:"",phone:""}))},B=D=>{const{name:$,value:H}=D.target;t(te=>({...te,[$]:H}))},J=async D=>{var $;D.preventDefault(),l(null),f(null),a(!0);try{let H,te;if(v)H=v.id,te=v.name,console.log(`Adding existing patient ${H} to queue.`);else{console.log("Registering new patient...");const ae=await pe("/api/patients",{method:"POST",body:JSON.stringify({name:n.name,age:n.age?parseInt(n.age,10):null,gender:n.gender||null,phone:n.phone||null})});if(!ae.ok){const le=await ae.json();if(ae.status===403&&le.message.includes("Patient limit")){e("/start-clinic-subscription",{state:{errorMessage:le.message}});return}throw new Error(le.message||"Failed to register patient")}const re=await ae.json();H=re.id,te=re.name,console.log(`New patient ${H} registered.`)}const Q=n.doctorId||null;console.log(`Adding patient ${H} to queue for doctor ${Q||"Unassigned"}`);const Y=await pe("/api/queue",{method:"POST",body:JSON.stringify({patientId:H,complaint:n.complaint||null,doctorId:Q})});if(!Y.ok){const ae=await Y.json();throw new Error(ae.message||"Failed to add patient to queue")}const V=await Y.json();if(console.log(`Patient added to queue, entry ID: ${V.id}`),S(null),p(""),b([]),t({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),Q){const ae=(($=A.find(le=>le.id===Q))==null?void 0:$.name)||"Selected Doctor",re=v?`Existing patient "${te}" added to queue for Dr. ${ae}. Redirecting to billing...`:`Patient "${te}" registered and added to queue for Dr. ${ae}. Redirecting to billing...`;f(re),e("/billing",{state:{patientId:H,queueId:V.id,patientName:te,doctorId:Q,billType:"consultation"}})}else{const ae=v?`Existing patient "${te}" added to the general queue.`:`Patient "${te}" registered and added to the general queue.`;f(ae)}}catch(H){console.error("Error in add/queue process:",H),H.message.includes("Patient limit")?(l(`Operation failed: ${H.message}. Please upgrade your plan.`),e("/start-clinic-subscription")):l(`Operation failed: ${H.message}`)}finally{a(!1)}};return i.jsxs("div",{className:"add-patient-page-container flex flex-col items-center justify-start",children:[i.jsxs("div",{className:"w-full max-w-3xl mb-2 flex justify-start",children:[" ",i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Back to Previous Page",children:[i.jsx(rn,{size:20,className:"btn-icon"})," Back"]})]}),i.jsxs("div",{className:"add-patient-card",children:[i.jsxs("h3",{className:"add-patient-title",children:[i.jsx(Rk,{size:28})," ",v?"Add Existing Patient to Queue":"Register New Patient & Add to Queue"]}),i.jsxs("div",{className:"search-section",children:[i.jsx("legend",{className:"form-fieldset legend",children:"Find Existing Patient"})," ",i.jsxs("div",{className:"flex items-center space-x-2",children:[" ",i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by Name or Phone...",value:u,onChange:D=>p(D.target.value),className:"form-input",disabled:r||!!v}),i.jsx(Hi,{size:18,className:`${k?"text-primary animate-pulse":""}`})," "]}),v&&i.jsxs("button",{type:"button",onClick:U,className:"btn btn-danger",title:"Clear Selection",children:[i.jsx(zn,{size:16,className:"btn-icon"})," Clear"]})]}),g.length>0&&!v&&i.jsx("ul",{className:"search-results-list",children:g.map(D=>i.jsxs("li",{onClick:()=>L(D),children:[D.name," (ID: ",D.id,", Phone: ",D.phone||"N/A",")"]},D.id))}),u.length>=2&&g.length===0&&!k&&!v&&i.jsxs("p",{className:"search-info-text",children:['No patients found matching "',u,'". You can register them below.']}),k&&u.length>=2&&i.jsx("p",{className:"search-info-text searching",children:"Searching..."})]}),o&&i.jsxs("div",{className:"alert alert-danger",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:o})]}),d&&i.jsxs("div",{className:"alert alert-success",role:"alert",children:[i.jsx("strong",{children:"Success: "}),i.jsx("span",{children:d})]}),i.jsxs("form",{onSubmit:J,className:"space-y-5",children:[" ",i.jsxs("fieldset",{className:`form-fieldset ${v?"fieldset-disabled":""}`,children:[i.jsx("legend",{children:v?`Selected Patient: ${v.name}`:"New Patient Details"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Full Name *"}),i.jsx("input",{type:"text",name:"name",value:v?v.name:n.name,onChange:B,className:"form-input",required:!v,disabled:r||!!v})]}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Age"}),i.jsx("input",{type:"number",name:"age",value:v?v.age??"":n.age,onChange:B,className:"form-input",min:"0",disabled:r||!!v})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Gender"}),i.jsxs("select",{name:"gender",value:v?v.gender??"":n.gender,onChange:B,className:"form-select",disabled:r||!!v,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Phone"}),i.jsx("input",{type:"tel",name:"phone",value:v?v.phone??"":n.phone,onChange:B,className:"form-input",disabled:r||!!v})]})]})]}),i.jsxs("fieldset",{className:"form-fieldset",children:[i.jsx("legend",{children:"Visit Details"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Assign Doctor (Optional)"}),i.jsxs("select",{name:"doctorId",value:n.doctorId,onChange:B,className:`form-select ${R?"opacity-50":""}`,disabled:r||R,children:[i.jsx("option",{value:"",children:R?"Loading doctors...":A.length===0?"No doctors available":"-- No Doctor (Add to General Queue) --"}),A.map(D=>i.jsx("option",{value:D.id,children:D.name},D.id))]}),A.length===0&&!R&&i.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Please add doctors via the Admin Panel."})]}),i.jsxs("div",{className:"form-grid-col-span-2",children:[" ",i.jsx("label",{className:"form-label",children:"Patient Data / Reason"}),i.jsx("textarea",{name:"complaint",value:n.complaint,onChange:B,rows:2,className:"form-textarea",disabled:r})]})]})]}),i.jsxs("div",{className:"flex justify-end pt-2",children:[" ",i.jsxs("button",{type:"submit",className:`btn btn-primary ${r||R?"disabled":""}`,disabled:r||R,children:[i.jsx(gw,{size:18,className:"btn-icon"}),r?"Processing...":v?"Add Existing to Queue":"Register & Add to Queue"]})]})]})]})]})},HW=({clinicId:e})=>{const n=Et(),[t,r]=w.useState({name:"",email:"",role:"receptionist",password:"",opd_fee:""}),[a,o]=w.useState(null),[l,d]=w.useState(!1);w.useEffect(()=>{o(e?null:"Clinic information is missing. Cannot add staff. Please ensure you are logged in correctly.")},[e]);const f=g=>{const{name:b,value:v}=g.target;r(S=>{const k={...S,[b]:v};return b==="role"&&v!=="doctor"&&(k.opd_fee=""),k})},u=async g=>{if(g.preventDefault(),o(null),!t.name||!t.email||!t.role||!t.password){o("Name, Email, Role, and Password are required.");return}if(!e){o("Clinic information is missing. Cannot add staff.");return}const b={...t,clinic_id:e,opd_fee:t.role==="doctor"&&t.opd_fee?parseFloat(String(t.opd_fee)):null};if(b.role==="doctor"&&t.opd_fee&&isNaN(b.opd_fee)){o("Invalid OPD Fee format. Please enter a number.");return}d(!0);try{const v=await pe("/api/staff",{method:"POST",body:JSON.stringify(b)});if(!v.ok){const S=await v.json();throw new Error(S.message||"Server responded with an error")}n(-1)}catch(v){o(`Failed to add staff: ${v.message}`)}finally{d(!1)}},p=()=>{n(-1)};return i.jsxs("div",{className:"staff-page-container",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("button",{onClick:p,className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[i.jsx(rn,{size:18,className:"mr-2"}),"Back"]}),i.jsx("h1",{children:"Add New Staff Member"}),i.jsx("div",{className:"w-16"})," "]}),a&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[i.jsx(Ar,{size:18,className:"mr-2 text-red-500"}),a]}),i.jsxs("form",{onSubmit:u,className:`staff-form ${e?"":"opacity-50 pointer-events-none"}`,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Full Name"}),i.jsx("input",{id:"name",type:"text",name:"name",value:t.name||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Enter full name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email Address"}),i.jsx("input",{id:"email",type:"email",name:"email",value:t.email||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Enter email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"role",children:"Assign Role"}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:f,required:!0,disabled:l||!e,children:[i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"}),i.jsx("option",{value:"lab",children:"Lab Technician"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"Set Initial Password"}),i.jsx("input",{id:"password",type:"password",name:"password",value:t.password||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Create a password"})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"opd_fee",children:"OPD Consultation Fee () (Optional)"}),i.jsx("input",{id:"opd_fee",type:"number",name:"opd_fee",value:t.opd_fee||"",onChange:f,step:"0.01",min:"0",placeholder:"e.g., 150.00",disabled:l||!e}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank if no specific fee is set for this doctor."})]}),i.jsxs("button",{type:"submit",disabled:l||!e,children:[l?i.jsx(Od,{size:18,className:"animate-spin mr-2"}):i.jsx(Zo,{size:18,className:"mr-2"}),l?"Adding...":"Add Staff Member"]})]})]})},GW=()=>{const{id:e}=Gi(),n=Et(),[t,r]=w.useState({name:"",email:"",role:"receptionist",opd_fee:"",active:!0}),[a,o]=w.useState(""),[l,d]=w.useState(!0),[f,u]=w.useState(!1),[p,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Staff ID is missing."),d(!1);return}d(!0),g(null),v(null);try{const M=await pe(`/staff/${e}`);if(!M.ok){const z=await M.json();throw new Error(z.message||`HTTP error! status: ${M.status}`)}const R=await M.json();r({name:R.name,email:R.email,role:R.role,opd_fee:R.opd_fee??"",active:R.active})}catch(M){g(`Failed to load staff details: ${M.message}`)}finally{d(!1)}},[e]);w.useEffect(()=>{S()},[S]);const k=M=>{const{name:R,value:z,type:F}=M.target;if(F==="checkbox"){const{checked:L}=M.target;r(U=>({...U,[R]:L}))}else r(L=>({...L,[R]:z}))},T=M=>{o(M.target.value)},A=async M=>{if(M.preventDefault(),!e){g("Staff ID is missing.");return}u(!0),g(null),v(null);const R={name:t.name,email:t.email,role:t.role,active:t.active};if(t.role==="doctor"){const z=t.opd_fee?parseFloat(String(t.opd_fee)):null;if(z!==null&&isNaN(z)){g("OPD Fee must be a valid number."),u(!1);return}R.opd_fee=z}else R.opd_fee=null;a.trim()!==""&&(R.password=a.trim());try{const z=await pe(`/staff/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)});if(!z.ok){const F=await z.json();throw new Error(F.message||`HTTP error! status: ${z.status}`)}v("Staff details updated successfully!"),o(""),setTimeout(()=>n(-1),1500)}catch(z){g(`Failed to update staff: ${z.message}`)}finally{u(!1)}};return l?i.jsxs("div",{className:"flex justify-center items-center h-screen",children:[i.jsx(Od,{className:"h-12 w-12 animate-spin text-teal-600"}),i.jsx("span",{className:"ml-4 text-xl text-gray-700",children:"Loading Staff Details..."})]}):i.jsxs("div",{className:"staff-page-container",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[i.jsx(rn,{size:18,className:"mr-2"}),"Back"]}),i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Edit Staff Member"}),i.jsx("div",{className:"w-16"})," "]}),p&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[i.jsx(Ar,{size:18,className:"mr-2 text-red-500"}),p,i.jsx("button",{onClick:()=>g(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),b&&i.jsxs("div",{className:"success-message mb-4 p-3 bg-green-100 border border-green-400 rounded-md flex items-center",children:[i.jsx(ps,{size:18,className:"mr-2 text-green-500"}),b,i.jsx("button",{onClick:()=>v(null),className:"ml-auto text-green-600 hover:text-green-800 text-xl font-bold",children:""})]}),i.jsxs("form",{onSubmit:A,className:"staff-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Full Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:t.name||"",onChange:k,required:!0,placeholder:"Enter full name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"email",children:["Email Address ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"email",id:"email",name:"email",value:t.email||"",onChange:k,required:!0,placeholder:"Enter email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"role",children:["Role ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:k,required:!0,children:[i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"lab",children:"Lab Technician"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"})]})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"opd_fee",children:"OPD Fee ()"}),i.jsx("input",{type:"number",id:"opd_fee",name:"opd_fee",value:t.opd_fee||"",onChange:k,min:"0",step:"0.01",placeholder:"Enter OPD consultation fee (optional)"})]}),i.jsxs("div",{className:"form-group checkbox-group",children:[i.jsx("input",{id:"active",name:"active",type:"checkbox",checked:t.active??!0,onChange:k}),i.jsxs("label",{htmlFor:"active",className:"mb-0",children:[" ","Account Active"]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"New Password (optional)"}),i.jsx("input",{type:"password",id:"password",name:"password",value:a,onChange:T,placeholder:"Leave blank to keep current password",autoComplete:"new-password"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter a new password only if you want to change it. Minimum 6 characters."})]}),i.jsx("button",{type:"submit",disabled:f,children:f?i.jsxs(i.Fragment,{children:[i.jsx(Od,{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Fd,{size:16,className:"mr-2"}),"Save Changes"]})})]})]})},YW=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},WW=e=>{switch(e){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:e,className:"status-badge"}}},R0=({title:e,items:n,renderItemContent:t,headerAction:r,isLoading:a,loadingText:o,noDataText:l,onDeleteItem:d,onEditLabOrder:f,onSaveLabOrder:u,onCancelEditLabOrder:p,onLabOrderTestChange:g,onLabOrderStatusChange:b,onEditPharmacyOrder:v,onPrintUnavailablePrescription:S,onBillLabOrder:k,onUpdateLabOrderStatus:T,onEnterLabReport:A,labInventory:M=[],isSavingLabOrder:R=!1,expandedLabReports:z={},toggleLabReport:F=()=>{}})=>{const L=w.useMemo(()=>{const B={};n.forEach(D=>{if(isNaN(D.date.getTime())){B["Unknown Date"]||(B["Unknown Date"]=[]),B["Unknown Date"].push(D);return}const $=YW(D.originalDateString);B[$]||(B[$]=[]),B[$].push(D)});const J=Object.keys(B);return J.sort((D,$)=>{if(D==="Unknown Date")return 1;if($==="Unknown Date")return-1;try{const H=new Date(D.split(" ").reverse().join(" ")),te=new Date($.split(" ").reverse().join(" "));if(!isNaN(H.getTime())&&!isNaN(te.getTime()))return te.getTime()-H.getTime()}catch{}return $.localeCompare(D)}),J.map(D=>({date:D,items:B[D]}))},[n]),U=["pending","billed","collected","processing","report_ready","completed","cancelled","reported"];return i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title mb-2 pb-1",children:e}),r]}),a&&i.jsx("p",{className:"ai-context-text italic",children:o}),!a&&n.length===0&&i.jsx("p",{className:"ai-context-text italic",children:l}),!a&&n.length>0&&i.jsx("div",{className:"space-y-3",children:L.map(({date:B,items:J})=>i.jsxs("div",{children:[i.jsx("h5",{className:"grouped-history-date",children:B}),i.jsx("div",{className:"space-y-1 grouped-history-item-container",children:J.map((D,$)=>i.jsxs("div",{className:"grouped-history-item ai-context-item flex flex-col",children:[i.jsxs("div",{className:"flex justify-between items-center w-full",children:[i.jsx("div",{className:"flex-grow mr-2 ai-context-text",children:t(D,$,z,F)}),i.jsxs("div",{className:"flex items-center space-x-1",children:[D.type==="Lab Order"&&!D.data.isEditing&&f&&i.jsx("button",{onClick:()=>f(D.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this lab order",disabled:R,children:i.jsx(Gl,{size:14})}),D.type==="Lab Order"&&D.data.isEditing&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>u&&u(D.data.id,D.data.editedTests,D.data.editedStatus),className:"text-green-600 hover:text-green-800 p-1 rounded hover:bg-green-100 focus:outline-none focus:ring-1 focus:ring-green-400",title:"Save lab order changes",disabled:R,children:i.jsx(Fd,{size:14})}),i.jsx("button",{onClick:()=>p&&p(D.data.id),className:"text-gray-600 hover:text-gray-800 p-1 rounded hover:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-gray-400",title:"Cancel editing",disabled:R,children:i.jsx(Ur,{size:14})})]}),D.type==="Lab Order"&&i.jsxs("div",{className:"lab-table-actions",children:[D.data.status==="pending"&&k&&(()=>{const H=D.data.tests.reduce((te,Q)=>te+(Number(Q.price)||0),0).toFixed(2);return i.jsxs("button",{onClick:()=>k(D.data),className:"lab-action-button btn-bill",title:`Pay total of ${H}`,children:["Pay (",H,")"]})})(),D.data.status==="billed"&&T&&i.jsx("button",{onClick:()=>T(D.data.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),D.data.status==="collected"&&T&&i.jsx("button",{onClick:()=>T(D.data.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),["pending","billed","collected","processing","report_ready","reported","completed"].includes(D.data.status)&&A&&i.jsx("button",{onClick:()=>A(D.data),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(D.data.status==="report_ready"||D.data.status==="reported")&&T&&i.jsx("button",{onClick:()=>T(D.data.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"})]}),D.type==="Pharmacy Order"&&D.data.status==="pending"&&v&&i.jsx("button",{onClick:()=>v(D.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this pharmacy order",disabled:R,children:i.jsx(Gl,{size:14})}),D.type==="Pharmacy Order"&&D.data.prescriptionForUnavailableDrugs&&S&&i.jsx("button",{onClick:()=>S(D.data.prescriptionForUnavailableDrugs,`Prescription for Order ${D.data.id}`),className:"text-purple-600 hover:text-purple-800 p-1 rounded hover:bg-purple-100 focus:outline-none focus:ring-1 focus:ring-purple-400",title:"Print Prescription for Unavailable Drugs",disabled:R,children:i.jsx(Qo,{size:14})}),D.type==="Pharmacy Order"&&D.data.status==="pending"&&d&&i.jsx("button",{onClick:()=>d({type:D.type,data:D.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Delete this pending pharmacy order",disabled:R,children:i.jsx(Ur,{size:14})}),d&&["Complaint","Lab Order","Lab Report"].includes(D.type)&&i.jsx("button",{onClick:()=>d({type:D.type,data:D.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:`Delete this ${D.type.toLowerCase()}`,disabled:R,children:i.jsx(Ur,{size:14})})]})]}),D.type==="Lab Order"&&D.data.isEditing&&i.jsxs("div",{className:"lab-order-edit-form mt-2 w-full",children:[i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status:"}),i.jsx("select",{value:D.data.editedStatus||D.data.status,onChange:H=>b&&b(D.data.id,H.target.value),className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:R,children:U.map(H=>i.jsx("option",{value:H,children:H.replace(/_/g," ")},H))})]}),i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tests:"}),D.data.editedTests.map((H,te)=>i.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[i.jsxs("select",{value:H.id,onChange:Q=>{const Y=M.find(V=>String(V.id)===Q.target.value);Y&&(g&&g(D.data.id,te,"id",Y.id),g&&g(D.data.id,te,"name",Y.name),g&&g(D.data.id,te,"price",Y.price))},className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:R,children:[i.jsx("option",{value:"",children:"Select Test"}),M.map(Q=>i.jsxs("option",{value:Q.id,children:[Q.name," (",Q.price,")"]},Q.id))]}),i.jsx("button",{onClick:()=>{const Q=D.data.editedTests.filter((Y,V)=>V!==te);g&&g(D.data.id,-1,"remove",Q)},className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Remove test",disabled:R,children:i.jsx(Ur,{size:14})})]},te)),i.jsx("button",{onClick:()=>{g&&g(D.data.id,-1,"add",{id:"",name:"",price:0})},className:"button-secondary mt-2 text-xs",disabled:R,children:"Add Test"})]})]},`${D.type}-${D.originalDateString}-${$}`))})]},B))})]})},QW="_modalOverlay_1yna4_3",JW="_modalContent_1yna4_29",KW="_modalHeader_1yna4_57",XW="_modalTitle_1yna4_75",ZW="_modalCloseButton_1yna4_87",eQ="_modalBody_1yna4_115",tQ="_errorText_1yna4_129",nQ="_formGroup_1yna4_147",rQ="_inputField_1yna4_171",iQ="_searchResultsCard_1yna4_213",aQ="_searchResultsList_1yna4_241",sQ="_searchResultItem_1yna4_253",oQ="_searchResultPrice_1yna4_289",lQ="_selectedTestsCard_1yna4_299",cQ="_selectedTestsHeader_1yna4_319",uQ="_noTestsMessage_1yna4_335",dQ="_selectedTestsList_1yna4_351",fQ="_selectedTestItem_1yna4_363",hQ="_selectedTestName_1yna4_387",pQ="_selectedTestPrice_1yna4_399",mQ="_removeTestButton_1yna4_411",gQ="_totalAmount_1yna4_437",yQ="_modalFooter_1yna4_455",xQ="_button_1yna4_473",bQ="_buttonPrimary_1yna4_491",vQ="_buttonSecondary_1yna4_513",Tt={modalOverlay:QW,modalContent:JW,modalHeader:KW,modalTitle:XW,modalCloseButton:ZW,modalBody:eQ,errorText:tQ,formGroup:nQ,inputField:rQ,searchResultsCard:iQ,searchResultsList:aQ,searchResultItem:sQ,searchResultPrice:oQ,selectedTestsCard:lQ,selectedTestsHeader:cQ,noTestsMessage:uQ,selectedTestsList:dQ,selectedTestItem:fQ,selectedTestName:hQ,selectedTestPrice:pQ,removeTestButton:mQ,totalAmount:gQ,modalFooter:yQ,button:xQ,buttonPrimary:bQ,buttonSecondary:vQ},wQ=({isOpen:e,onClose:n,patientId:t,labInventory:r,fetchPendingLabOrdersData:a})=>{const[o,l]=w.useState([]),[d,f]=w.useState(""),[u,p]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>{if(!d){p([]);return}const M=d.toLowerCase();p(r.filter(R=>R.name.toLowerCase().includes(M)||R.description&&R.description.toLowerCase().includes(M)).slice(0,10))},[d,r]);const k=async()=>{if(!t){b("Patient ID is missing.");return}if(o.length===0){b("Please select at least one lab test.");return}S(!0),b(null);try{const M={patient_id:t,tests:o.map(z=>({id:z.id,name:z.name,price:z.price}))},R=await pe("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)});if(!R.ok){const z=await R.json().catch(()=>({}));throw new Error(z.message||`Failed to create lab order: ${R.statusText}`)}await R.json(),a(t),n(),l([]),f("")}catch(M){b(`Lab Order Creation Error: ${M.message}`)}finally{S(!1)}},T=M=>{if(o.some(R=>R.id===M.id)){b(`${M.name} is already in the order.`),setTimeout(()=>b(null),3e3),f(""),p([]);return}l(R=>[...R,{...M}]),f(""),p([])},A=M=>{l(R=>R.filter(z=>z.id!==M))};return e?i.jsx("div",{className:Tt.modalOverlay,children:i.jsxs("div",{className:Tt.modalContent,children:[i.jsxs("div",{className:Tt.modalHeader,children:[i.jsx("h3",{className:Tt.modalTitle,children:"Create New Lab Order"}),i.jsx("button",{onClick:n,className:Tt.modalCloseButton,children:i.jsx(zn,{size:20})})]}),i.jsxs("div",{className:Tt.modalBody,children:[g&&i.jsx("div",{className:Tt.errorText,children:g}),i.jsxs("div",{className:Tt.formGroup,style:{position:"relative"},children:[i.jsx("label",{htmlFor:"lab-test-search",children:"Add Lab Test"}),i.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search available lab tests...",value:d,onChange:M=>f(M.target.value),className:Tt.inputField}),d&&u.length>0&&i.jsx("div",{className:Tt.searchResultsCard,children:i.jsx("ul",{className:Tt.searchResultsList,children:u.map(M=>i.jsxs("li",{onClick:()=>T(M),className:Tt.searchResultItem,children:[i.jsx("span",{children:M.name}),i.jsxs("span",{className:Tt.searchResultPrice,children:["(",parseFloat(String(M.price)).toFixed(2),")"]})]},M.id))})})]}),i.jsxs("div",{className:Tt.selectedTestsCard,children:[i.jsx("h4",{className:Tt.selectedTestsHeader,children:"Selected Tests"}),o.length===0?i.jsx("p",{className:Tt.noTestsMessage,children:"No tests added yet."}):i.jsx("ul",{className:Tt.selectedTestsList,children:o.map(M=>i.jsxs("li",{className:Tt.selectedTestItem,children:[i.jsx("span",{className:Tt.selectedTestName,children:M.name}),i.jsxs("span",{className:Tt.selectedTestPrice,children:["",parseFloat(String(M.price)).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>A(String(M.id)),className:Tt.removeTestButton,title:"Remove Test",children:i.jsx(Ur,{size:16})})]},M.id))})]}),o.length>0&&i.jsxs("div",{className:Tt.totalAmount,children:["Total: ",o.reduce((M,R)=>M+parseFloat(String(R.price)),0).toFixed(2)]})]}),i.jsxs("div",{className:Tt.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${Tt.button} ${Tt.buttonSecondary}`,children:" Cancel "}),i.jsxs("button",{type:"button",onClick:k,disabled:o.length===0||v,className:`${Tt.button} ${Tt.buttonPrimary} ${o.length===0||v?Tt.buttonDisabled:""}`,children:[" ",v?"Saving...":"Create Lab Order"," "]})]})]})}):null},kx=e=>{if(!e)return"";let n=e.toLowerCase();return n=n.replace(/\b(mg|g|ml|iu|unit|tabs|tablet|tablets|capsule|capsules|injection|injections|syrup|solution|cream|ointment|lotion|spray|drops|patch|suppository|vial|ampoule|bottle|pack|kit)\b/g,""),n=n.replace(/\b(test|panel|profile|assay|screen|analysis|level|count|culture)\b/g,""),n=n.replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim(),n},zm=(e,n)=>{if(!e||!n||n.length===0)return;const t=kx(e);let r=n.find(l=>kx(l.name)===t);if(r)return r;let a=n.find(l=>kx(l.name).includes(t));if(a)return a;let o=n.find(l=>t.includes(kx(l.name)));if(o)return o},SQ=`You are an expert OPD (Outpatient Department) medical assistant for a Doctor in a clinic in India. You will receive all the medical data of the patient including complaints (history), labs, pharmacy orders, etc., along with their date and time. Your primary goal is to assist the doctor and analyze patient chief complaints (Co), provide a structured clinical assessment including lab test suggestions (Lx), differential diagnoses (Dx), and a treatment plan (Tx). You have access to tools (actions) to order lab tests and pharmacy items, and update patient details.



**1. Definitions:**
   - Co: Chief complaints
   - Pt: Patient (assume living in India)
   - Lx: Laboratory tests
   - Dx: Differential Diagnosis
   - Tx: Treatment Plan

**2. Workflow:**
   - Analyze Co, generate Lx, Dx, and Tx sections as described below.
   - **Prioritization for Orders:** Always prioritize using \`edit_pharmacy_order\` or \`edit_lab_order\` if there are existing pending orders for the patient, before considering \`create_pharmacy_order\` or \`create_lab_order\`.
   - using edit_lab_order edits the lab order with the given serial numnber use to add new tests to the existing order or remove the tests from existing order, marking the status affects all tests in the order not only the test,always use this tool if there are pending lab orders instead of creating new orders.
   - using edit_pharmacy_order edits the pharmacy order with the given serial numnber to add new items to the existing order, update existing items, or remove items (either by \`items_to_remove\` or by setting \`quantity\` to 0). Always use this tool if there are pending pharmacy orders instead of creating new orders.
   - If your Lx section suggests tests from the inventory, use the \`create_lab_order\` action, but only for tests that are both clinically required and have not already been ordered or are still pending. Skip tests that are already ordered and in pending.
   - If your Tx section prescribes medications, use the \`create_pharmacy_order\` action  but only for medications that are clinically required and have not already been prescribed or are still pending. Skip medications that are already dispensed or already ordered.
   - If your Tx section prescribes medications that are *not* available in the inventory, use the \`prescription_for_unavailable_drugs\` parameter within the \`create_pharmacy_order\` action to specify the prescription details for these unavailable drugs.
   - When ordering pharmacy items, specify both \`pack_quantity\` (number of full packs) and \`loose_quantity\` (number of individual units). The system will handle the conversion based on the drug's pack size.
   - **Patient Details Management:** Always store or update patient name, age, sex, and phone number using the \`update_patient_details\` action. If patient name, age, or sex is received as 'New Patient - Direct Entry', 'N/A', or blank, treat it as missing data; if the user input provides anything resembling a name, age, or sex (e.g., shiva 25m, robin 50m, priya 19f), update them using the \`update_patient_details\` action. If details are missing, you can ask the user for the missing details using the \`ask_followup_question\` action.
   - Always update new complaints of the patient using the \`add_complaint_history\` action.
   - If you generate a concise summary of the patient's current situation based on the interaction and history, use the \`update_case_summary\` action to save it.
   - Remember, when you use \`update_case_summary\`, the previous case summary will be replaced by the new one, so you can use it like a short-term memory to store other stuff that **keeps changing**, like the current treatment plan, plan of action, active problems, or current vitals, etc.
   - When you use \`add_complaint_history\`, it will add the complaint to the previous ones. You will be given all the previous complaints back in every query, so you can use it to store other long-term facts that do **not change**, like the history of a chronic illness, surgical history, allergies, or social history, etc.
   - while placing or editing a pharmacy order make sure to set the \`pack_quantity\` and \`loose_quantity\` right.
   - Use the \`update_clinic_ai_memory\` action to store or update **various types of clinic-wide persistent information in a concise way**. This can include 'summaries of common patient encounters'+'summeries of previous **Clinic-wide AI Memory**'(e.g., 'Patient X, 50m, chronic gastritis, last visit YYYY-MM-DD, prescribed Z, follow-up in N days'+'**Clinic-wide AI Memory** summary'), notes on local health trends, common diagnostic patterns observed in the clinic, specific operational protocols. This memory is shared across all interactions for the clinic and helps tailor responses to its specific context over time.
   - **Important: Preventing Loops** If you determine that no further actions are needed (e.g., you have already performed necessary actions, or the user's input does not require any specific action), you **MUST** use the \`end_task\` action. This explicitly signals that your task is complete and prevents the system from re-prompting you unnecessarily.
**3.**Multiple Actions:** You can perform multiple actions (like ordering labs AND meds, adding complaints, updating patient information, and asking a follow-up question) in a single response by including multiple action objects within the main JSON array.


**4. Chief Complaints (Co):**
   - Analyze the provided chief complaints.
   - Present them in a table with two columns: 'Relevant Complaint (Score 8-10)' and 'Irrelevant Complaint (Score 0-7)', based on clinical relevance.

**5. Lab Tests (Lx):**
   - Suggest the most probable basic lab tests based on the clinical picture, ordered by likelihood.
   - If a basic test is positive/abnormal, suggest relevant advanced tests.
   - **Inventory Check:** Compare suggested tests against the provided inventory list.
   - **Table 1: Available Lab Tests:** Present tests *available* in the inventory in a table with columns: '**Clinical Importance (High/Medium/Low)**', 'Lab Test'. If suggesting tests from this table, prepare to use the \`create_lab_order\` tool in your response.
   - **Table 2: Unavailable Lab Tests:** Present tests *not available* in the inventory in a separate table with columns: '**Clinical Importance (High/Medium/Low)**', 'Unavailable Basic Test'. Clearly state these are not orderable via the tool (generate Table 2 only when required tests are unavailable).

**6. Differential Diagnosis (Dx):**
   - List potential differential diagnoses.
   - Provide a confidence score (0-10) for each.
   - Present in a table with columns: 'Differential Diagnosis' and 'Confidence Score (0-10)'.

**7. Treatment Plan (Tx):**
   - Create a structured treatment plan including ideal medications based on the diagnosis.
   - **Inventory Check:** Compare prescribed medications against the provided inventory list.
   - **Table 1: Available Medications:** Present medications *available* in the inventory in a table with columns: 'Time Frame' (from and to dates), 'Treatment Goal', 'Intervention', 'Medication Type', 'Drug Form', 'Drug Name', 'Regimen (Dose, Freq)', 'Duration'. Before using the \`create_pharmacy_order\` tool, check if an order for the same drug has already been placed for this patient today. If an order already exists for today, do *not* create a duplicate order. If no order exists for today, prepare to use the \`create_pharmacy_order\` tool in your response.
   - **Table 2: Unavailable Medications:** Present medications *not available* in the inventory in a separate table with columns: 'Unavailable Drug Name', 'Ideal Regimen', 'Reasoning/Indication', '**Clinical Importance (High/Medium/Low)**', 'Suggested Available Substitute (from inventory, if possible)'. Clearly state these are not orderable via the tool (generate Table 2 only when required medications are unavailable in the inventory).

**8. Tools / Actions:**
   When you need to perform actions like ordering tests/meds, updating patient info, or adding history, use the following JSON array format. The response should ONLY contain this JSON array, nothing else.

   ****STRICT JSON****>>>>>>\`\`\`json
[
  { "action": "create_pharmacy_order", "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "prescription_for_unavailable_drugs": "string | null" },
  { "action": "edit_pharmacy_order", "serialNumber": number, "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "items_to_remove": [ { "drug_id": number | null, "name": "Drug Name" } ], "status": "pending" | "billed" | "dispensed" | "cancelled", "prescription_for_unavailable_drugs": "string | null" },
  { "action": "create_lab_order", "tests": [ { "name": "Test Name" } ] },
  { "action": "edit_lab_order", "serialNumber": number, "tests": [ { "name": "Test Name" } ], "items_to_remove": [ { "id": number | string | null, "name": "Test Name" } ], "status": "pending" | "billed" | "collected" | "processing" | "report_ready" | "completed" | "cancelled" | "reported" },
  { "action": "create_lab_report", "tests": [ { "name": "Test Name", "parameters": [{ "name": "Parameter Name", "value": "Value" }] } ] },
  { "action": "edit_lab_report", "serialNumber": number, "tests": [ { "name": "Test Name", "parameters": [{ "name": "Parameter Name", "value": "Value" }] } ] },
  { "action": "add_complaint_history", "complaint": "Specific past complaint text..." },
  { "action": "update_patient_details", "name": "New Name (optional)", "age": number (optional), "gender": "M" | "F" | "O" | null (optional), "phone_number": "string (optional)" },
  { "action": "update_case_summary", "summary": "Concise summary text..." },
  { "action": "update_clinic_ai_memory", "memory_content": "New clinic-wide AI memory content..." },
  { "action": "end_task" }
]
\`\`\`

   - **Multiple Actions in One Response:** You can include multiple action objects within this single JSON array if several actions are required based on your analysis (e.g., adding history AND ordering labs).
   - **Prioritization Within the Array:** If including multiple actions, order them within the array according to this priority:
     1. \`add_complaint_history\`
     2. \`update_patient_details\`
     3. \`update_case_summary\`
     4. \`update_clinic_ai_memory\`
     5. \`create_lab_order\`
     6. \`edit_lab_order\`
     7. \`create_pharmacy_order\`
     8. \`edit_pharmacy_order\`
   - **Structure:**
     The AI response can be a flat array of actions OR a list of "function call" objects containing grouped actions.
     **Option 1: Flat Array (Simple)**
     \`\`\`json
     [
       { "action": "add_complaint_history", ... },
       { "action": "create_lab_order", ... }
     ]
     \`\`\`
     **Option 2: Grouped Function Calls (Complex)**
     You can group actions under logical "function calls" if needed.
     \`\`\`json
     [
       {
         "function_call": "assess_patient",
         "actions": [
           { "action": "ask_followup_question", "question": "..." }
         ]
       },
       {
         "function_call": "prescribe_treatment",
         "actions": [
            { "action": "create_pharmacy_order", "items": [...] },
            { "action": "create_lab_order", "tests": [...] }
         ]
       }
     ]
     \`\`\`

   - **Example (Multiple Actions):**
     \`\`\`json
     [
       { "action": "add_complaint_history", "complaint": "Patient also reports mild fever since yesterday." },
       { "action": "create_lab_order", "tests": [ { "name": "CBC" } ] }
     ]
     \`\`\`

   - **\`ask_followup_question\`**: Use this action (either standalone or inside a group) only when you need clarification.
     \`\`\`json
     {
       "action": "ask_followup_question",
       "question": "Your clear, specific question here.",
       "options": ["Optional Answer 1", "Optional Answer 2"]
     }
     \`\`\`
     *Description:* Ask the user a question to gather additional information needed to complete the task. This tool should be used when you encounter ambiguities, need clarification, or require more details to proceed effectively. It allows for interactive problem-solving by enabling direct communication with the user. Use this tool judiciously to maintain a balance between gathering necessary information and avoiding excessive back-and-forth.
     *Parameters:*
       - question: (required) The question to ask the user. This should be a clear, specific question that addresses the information you need.
       - options: (optional) An array of 2-5 options for the user to choose from. Each option should be a string describing a possible answer. You may not always need to provide options, but it may be helpful in many cases where it can save the user from having to type out a response manually.


**Important:**
- Ensure all tables are clearly formatted using Markdown.
- Strictly adhere to the inventory constraints for labs and medications when deciding whether to use \`create_lab_order\` or \`create_pharmacy_order\`.
- When using actions, provide ONLY the JSON array (or the single JSON object for \`ask_followup_question\`) as the *very last* part of your response, after all other content including tables. Do not include any other text after the JSON.

**Plan Mode:**
When the user asks a question about a patient's condition or general medical topics (not entering new medical data), respond in PLAN MODE. In this mode, focus on answering the user's inquiry, clarifying their request, brainstorming ideas, or architecting a solution (like exploring treatment options). Ask clarifying questions if needed. Present detailed plans or explanations **using clear table formats and markdown (like bolding) for easy readability**. Engage in back-and-back discussion to finalize details. Do not use action tools (\`create_lab_order\`, \`create_pharmacy_order\`, \`add_complaint_history\`, \`update_patient_details\`) while in PLAN MODE).`,G_="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",NQ="models/gemini-3-flash-preview";async function CQ(){if(!pw())return console.warn("No auth token found, using default Gemini API key."),G_;let n=null;try{const t=await pe("/api/clinics/settings");if(t.ok){const r=await t.json();r.gemini_api_key&&r.gemini_api_key.trim()!==""&&(n=r.gemini_api_key.trim())}}catch(t){console.warn("Could not fetch clinic settings (or key missing), proceeding to global fallback.",t)}if(n)return n;try{const t=await pe("/api/global-settings/app_gemini_api_key");if(t.ok){const a=(await t.json()).value;if(a&&a.trim()!=="")return a.trim()}}catch(t){console.warn("Could not fetch global API key.",t)}return console.warn("Clinic-specific and global Gemini API keys not found, using default env var."),G_}let M0=null;async function _Q(){if(!M0){const e=await CQ();M0=new hw({apiKey:e})}return M0}async function jQ(e,n){const{query:t,currentDateTime:r,patientName:a,patientAge:o,patientGender:l,case_summary:d,case_summary_last_updated:f,clinic_ai_memory:u,clinic_ai_memory_last_updated:p,clinic_wide_system_prompt:g,labHistory:b,pharmacyOrders:v,pastComplaints:S,pharmacyInventory:k,labInventory:T}=e;let A=`Patient Complaint: ${t}`;if(d&&(A+=`

--- Case Summary (Provided by Doctor) ---
${d}`,f))try{const D=new Date(f).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});A+=`
(Last Updated: ${D})`}catch{console.warn(`Could not format case_summary_last_updated: ${f}`),A+=`
(Last Updated: ${f})`}if(a&&(A+=`

Patient Name: ${a}`),o!=null&&(A+=`
Patient Age: ${o}`),l&&(A+=`
Patient Gender: ${l}`),r)try{const D=new Date(r).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});A+=`

Current Interaction Time: ${D}`}catch{console.warn(`Could not format currentDateTime: ${r}`),A+=`

Current Interaction Time: ${r}`}if(u&&(A+=`

--- Clinic-wide AI Memory/Context ---
${u}`,p))try{const D=new Date(p).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});A+=`
(Last Updated: ${D})`}catch{console.warn(`Could not format clinic_ai_memory_last_updated: ${p}`),A+=`
(Last Updated: ${p})`}let M="";b&&Array.isArray(b)&&b.length>0&&(M=`

--- Lab History (Orders & Reports) ---
`,b.forEach(D=>{let $="Unknown Date";try{$=new Date(D.orderDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab order: ${D.orderDate}`)}if(M+=`
Order #${D.serialNumber} Date: ${$} (Status: ${D.status})
`,M+=`Tests: ${D.tests.map(H=>H.name).join(", ")}
`,D.report){let H="Unknown Date";try{H=new Date(D.report.reportDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab report: ${D.report.reportDate}`)}M+=`  -> Report Date: ${H}
`,D.report.tests&&Array.isArray(D.report.tests)?(M+=`     Findings:
`,D.report.tests.forEach(te=>{M+=`       - Test: ${te.testName}
`,te.parameters&&Array.isArray(te.parameters)&&te.parameters.forEach(Q=>{M+=`         - ${Q.name}: ${Q.value} (Normal: ${Q.normal_range})
`})})):(M+=`     Findings: ${D.report.reportContent||"N/A"}
`,D.report.error&&(M+=`     Note: ${D.report.error}
`))}M+=`---
`}),A+=M);let R="";v&&Array.isArray(v)&&v.length>0&&(R=`

--- Recent Pharmacy Orders ---
`,v.forEach(D=>{let $="Unknown Date/Time";try{$=new Date(D.date).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for pharmacy order: ${D.date}`)}R+=`
Order #${D.serialNumber} Date/Time: ${$} (Status: ${D.status})
`,R+=`Prescribed By: ${D.prescribedBy||"N/A"}
`,D.dispensedBy&&(R+=`Dispensed By: ${D.dispensedBy}
`),R+=`Medications:
`,D.medications.forEach(H=>{R+=`  - ${H.name} (Qty: ${H.quantity}`,H.tabletsPerDay&&(R+=`, ${H.tabletsPerDay}/day`),H.numberOfDays&&(R+=` for ${H.numberOfDays} days`),R+=`)
`}),D.prescriptionForUnavailableDrugs&&(R+=`  Prescription for Unavailable Drugs: ${D.prescriptionForUnavailableDrugs}
`),R+=`---
`}),A+=R);let z="";S&&Array.isArray(S)&&S.length>0&&(z=`

--- Past Complaints History ---
`,S.forEach(D=>{let $="Unknown Date/Time";try{$=new Date(D.createdAt).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for past complaint: ${D.createdAt}`)}z+=`
Date/Time: ${$}
Complaint: ${D.complaint||"N/A"}
---
`}),A+=z);let F="";k&&Array.isArray(k)&&k.length>0&&(F=`

--- Current Pharmacy Inventory (Stock Levels) ---
`,k.forEach(D=>{let $=`- ${D.name} (Pack: ${D.pack??"N/A"}): ${D.stock??"N/A"}`;const H=[];D.brand_name&&H.push(`Brand: ${D.brand_name}`),D.batch&&H.push(`Batch: ${D.batch}`),D.expiry_date&&H.push(`Exp: ${D.expiry_date}`),H.length>0&&($+=` [${H.join(", ")}]`),F+=`${$}
`}),A+=F);let L="";T&&Array.isArray(T)&&T.length>0&&(L=`

--- Available Lab Tests (with Parameters) ---
`,T.forEach(D=>{L+=`- ${D.name} (Price: ${D.price??"N/A"})
`,D.default_parameters&&Array.isArray(D.default_parameters)&&D.default_parameters.length>0&&D.default_parameters.forEach($=>{let H=`    * ${$.name}`;$.unit&&(H+=` (${$.unit})`),$.normal_range?H+=` [Normal: ${$.normal_range}]`:$.lower_limit!==void 0&&$.upper_limit!==void 0&&$.lower_limit!==null&&$.upper_limit!==null&&(H+=` [Normal: ${$.lower_limit} - ${$.upper_limit}]`),L+=`${H}
`})}),A+=L);const U=[{text:SQ}];g&&g.trim()!==""&&U.push({text:`--- Additional Clinic-Specific Instructions ---
${g}`});const B=[{text:A}];if(n){const D=new FileReader,$=await new Promise((H,te)=>{D.onloadend=()=>{typeof D.result=="string"?H(D.result.split(",")[1]):te(new Error("Failed to read image file as base64."))},D.onerror=te,D.readAsDataURL(n)});B.push({inlineData:{mimeType:n.type,data:$}})}const J=[];U.length>0&&J.push({role:"user",parts:U}),J.push({role:"user",parts:B});try{const D={model:NQ,contents:J,generationConfig:{temperature:.7,maxOutputTokens:1024,responseMimeType:"text/plain"}},H=await(await _Q()).models.generateContentStream(D);let te="";for await(const Q of H)if(Q&&typeof Q.text=="function"){const Y=Q.text;Y&&(te+=Y)}else Q&&Q.candidates&&Q.candidates[0]&&Q.candidates[0].content&&Q.candidates[0].content.parts&&Q.candidates[0].content.parts[0]&&Q.candidates[0].content.parts[0].text&&(te+=Q.candidates[0].content.parts[0].text);if(te&&te.trim()!=="")return te.trim();throw console.error("Empty or invalid response received from Gemini API stream."),new Error("Failed to get suggestion from AI (Gemini). Empty or invalid stream response.")}catch(D){console.error("Error calling Gemini API:",D);let $="Failed to get suggestion from Gemini.";throw D.message&&($=`Error processing Gemini request: ${D.message}`),new Error($)}}const kQ=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return n?parseInt(n[1],10):1},TQ=w.forwardRef(({recordId:e,patientId:n,patientDetails:t,caseSummary:r,caseSummaryUpdatedAt:a,clinicSettings:o,userMessages:l,selectedImageFile:d,pendingLabOrders:f,labReports:u,pastComplaints:p,pharmacyOrders:g,pharmacyInventory:b,labInventory:v,currentComplaint:S,setCurrentComplaint:k,setAiResponse:T,setAiResponseText:A,setAiResponseJsonString:M,setShowAiJsonDetails:R,setIsLoadingAi:z,setAiError:F,setIsSubmittingAiOrder:L,setAiOrderSubmissionStatus:U,setIsSubmittingAiLabOrder:B,setAiLabOrderSubmissionStatus:J,setIsSubmittingAiComplaint:D,setAiComplaintSubmissionStatus:$,setIsUpdatingCaseSummary:H,setAiCaseSummaryUpdateStatus:te,setCaseSummary:Q,setIsUpdatingAiMemoryByAI:Y,setAiMemoryUpdateByAIStatus:V,setFollowUpQuestion:ae,setFollowUpOptions:re,setError:le,setIsSavingAiResponse:E,setSaveAiResponseError:ce,fetchPharmacyOrdersData:ue,fetchPendingLabOrdersData:I,fetchLabReportsData:de,fetchPastComplaintsData:fe,fetchPatientDetails:W,setClinicSettings:oe,setEditedAiMemory:se,setCanUndo:je,onAiActionSuccess:We,addMessage:X},Se)=>{const[Ae,Pe]=_n.useState(null);_n.useEffect(()=>{je(!!Ae)},[Ae,je]);let Ze;const rt=async(be,$e,Be,ke=0)=>{let Ne;const ge=["AI response did not contain a recognized function call","AI response did not result in a recognized or performed function call"].some(He=>{var Qe;return(Qe=$e.message)==null?void 0:Qe.includes(He)});Be&&ge?Ne=`AI Error: ${$e.message}

${Be}`:(Ne=`I encountered a frontend error while trying to execute the '${be}' function. The error message is: "${$e.message}". Based on this error, please analyze what went wrong and either correct the function call and try again, or explain the problem.`,(be==="create_pharmacy_order"||be==="edit_pharmacy_order")&&(Ne+=`

IMPORTANT: When ordering medication, please first check if the medication ordered matches the exact name given in the inventory. If the name itself is not given in the inventory, you can also use 'prescription_for_unavailable_drugs' to write a prescription for unavailable drugs.`),Be&&(Ne+=`

The original AI response that caused the error was:
\`\`\`
${Be}
\`\`\``)),X==null||X({role:"system",type:"error",content:`AI Error: ${$e.message}. Retrying...`}),await Ze(Ne,ke+1)},lt=async be=>{console.log("Executing Rollback for actions:",be);for(const $e of be){const{actionType:Be,undoData:ke}=$e;if(console.log(`Attempting to rollback ${Be}`,ke),!ke){console.warn(`No undoData found for action ${Be}, skipping.`);continue}try{if(Be==="create_pharmacy_order")ke!=null&&ke.orderId?(console.log(`Deleting pharmacy order ${ke.orderId}`),await pe(`/api/pharmacy-orders/${ke.orderId}`,{method:"DELETE"}),ue(n)):console.error("Missing orderId for create_pharmacy_order rollback");else if(Be==="create_lab_order")ke!=null&&ke.orderId?(console.log(`Deleting lab order ${ke.orderId}`),await pe(`/api/lab/orders/${ke.orderId}`,{method:"DELETE"}),I(n)):console.error("Missing orderId for create_lab_order rollback");else if(Be==="update_patient_details")if(ke!=null&&ke.patientId&&(ke!=null&&ke.originalDetails)){console.log(`Reverting patient details for ${ke.patientId}`);const Ne=ke.originalDetails,K={name:Ne.name,age:Ne.age,gender:Ne.gender,phone:Ne.phone,ai_response:Ne.ai_response};await pe(`/api/patients/${ke.patientId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(K)}),W(ke.patientId)}else console.error("Missing patientId or originalDetails for update_patient_details rollback");else if(Be==="add_complaint_history")ke!=null&&ke.recordId?(console.log(`Reverting complaint history for ${ke.recordId}`),await pe(`/api/queue/doctor/complaint/${ke.recordId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({complaint:ke.originalComplaint||""})}),k(ke.originalComplaint||"")):console.error("Missing recordId for add_complaint_history rollback");else if(Be==="update_case_summary")ke!=null&&ke.recordId?(console.log(`Reverting case summary for ${ke.recordId}`),await pe(`/api/queue/doctor/complaint/${ke.recordId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:ke.originalSummary||""})}),Q(ke.originalSummary||"")):console.error("Missing recordId for update_case_summary rollback");else if(Be==="update_clinic_ai_memory")(ke==null?void 0:ke.originalMemory)!==void 0?(console.log("Reverting AI memory"),await pe("/api/clinics/settings",{method:"PUT",body:JSON.stringify({...o,aiMemory:ke.originalMemory})}),se(ke.originalMemory)):console.error("Missing originalMemory for update_clinic_ai_memory rollback");else if(Be==="edit_pharmacy_order")if(ke!=null&&ke.orderId&&(ke!=null&&ke.originalState)){console.log(`Reverting pharmacy order ${ke.orderId}`);const Ne={items:ke.originalState.medications||[],status:ke.originalState.status,prescription_for_unavailable_drugs:ke.originalState.prescription_for_unavailable_drugs,order_total:ke.originalState.order_total};await pe(`/api/pharmacy-orders/${ke.orderId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ne)}),ue(n)}else console.error("Missing orderId or originalState for edit_pharmacy_order rollback");else if(Be==="edit_lab_order")if(ke!=null&&ke.orderId&&(ke!=null&&ke.originalState)){console.log(`Reverting lab order ${ke.orderId}`);const Ne={tests:ke.originalState.tests,status:ke.originalState.status};await pe(`/api/lab/orders/${ke.orderId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ne)}),I(n)}else console.error("Missing orderId or originalState for edit_lab_order rollback");else console.warn(`Unknown action type for rollback: ${Be}`)}catch(Ne){console.error(`Failed to rollback ${Be}:`,Ne)}}},ze=async()=>{!Ae||!window.confirm("Are you sure you want to undo the last AI actions?")||(z(!0),await lt([...Ae].reverse()),Pe(null),z(!1),F("Last actions undone successfully."))},ot=async(be,$e)=>{Pe(null),U(null),J(null),$(null),te(null),V(null),ae(null),re([]),le(null);let Be=null;const ke=/```json\s*([\s\S]*?)\s*```/,Ne=be.match(ke);if(Ne&&Ne[1])Be=Ne[1];else{const K=be.trim();if(K.startsWith("{")&&K.endsWith("}"))Be=K;else if(K.startsWith("[")&&K.endsWith("]"))Be=K;else throw new Error("AI response did not contain a recognized function call.")}if(Be)try{const K=JSON.parse(Be),ge=xe=>{const Me=[],De=Array.isArray(xe)?xe:[xe];for(const qe of De)qe&&(qe.actions&&Array.isArray(qe.actions)?Me.push(...ge(qe.actions)):qe.sub_actions&&Array.isArray(qe.sub_actions)?Me.push(...ge(qe.sub_actions)):qe.function_calls&&Array.isArray(qe.function_calls)?Me.push(...ge(qe.function_calls)):typeof qe.action=="string"&&Me.push(qe));return Me},He=ge(K),Qe=[];let dt=null,At=!1;for(const xe of He){if(xe.action==="ask_followup_question"){dt=xe,At=!0;continue}At=!0;const Me=xe.action;Me==="update_clinic_ai_memory"&&typeof xe.memory_content=="string"?Qe.push((async()=>{Y(!0),V("Processing AI mem..."),X==null||X({role:"system",type:"loading",content:"Processing AI memory..."});const De=(o==null?void 0:o.aiMemory)||"";try{if(!o)throw new Error("Clinic settings not loaded.");const qe={...o,aiMemory:xe.memory_content.trim(),admissionCharge:o.admissionCharge,perDayCharge:o.perDayCharge,otherCharges:o.otherCharges,clinicWideSystemPrompt:o.clinicWideSystemPrompt},st=await pe("/api/clinics/settings",{method:"PUT",body:JSON.stringify(qe)});if(!st.ok){const _t=await st.json().catch(()=>({}));throw new Error(_t.message||`AI-triggered clinic memory update failed: ${st.statusText}`)}const yt=await st.json();return oe(_t=>_t?{..._t,aiMemory:yt.settings.aiMemory}:null),se(yt.settings.aiMemory||""),V("AI mem updated!"),X==null||X({role:"system",type:"success",content:"AI memory updated successfully."}),{success:!0,actionType:Me,undoData:{originalMemory:De}}}catch(qe){return V("Failed"),{success:!1,actionType:Me,error:qe,originalActionPayload:xe}}finally{Y(!1)}})()):Me==="create_pharmacy_order"?Qe.push((async()=>{var De,qe;L(!0),U("Processing order..."),X==null||X({role:"system",type:"loading",content:"Processing pharmacy order..."});try{if(!n)throw new Error("Missing patient ID.");const st=[];let yt=null;if(Array.isArray(xe.items))for(const wt of xe.items){let bt;if(wt.drug_id?bt=b.find(Ei=>Ei.id===wt.drug_id):wt.name&&(bt=zm(wt.name,b)),!bt){yt=`Drug "${wt.name||wt.drug_id}" not found.`;break}const Ft=kQ(bt.pack),St=Number(bt.mrp),Jn=St,Yi=Ft>0?St/Ft:0,vr=Number(wt.pack_quantity)||0,yn=Number(wt.loose_quantity)||0,wr=vr*Jn+yn*Yi;st.push({drug_id:String(bt.id),name:bt.name,pack_quantity:vr,loose_quantity:yn,tabletsPerDay:wt.tabletsPerDay,numberOfDays:wt.numberOfDays,directions_to_use:wt.directions_to_use,group_id:wt.group_id,pack_price:Jn,loose_price:Yi,total_price:wr,price:St,isLoose:wt.isLoose,unit:bt.pack})}if(yt)throw new Error(yt);const _t=st.reduce((wt,bt)=>wt+bt.total_price,0),cn={patient_id:n,items:st,prescription_for_unavailable_drugs:xe.prescription_for_unavailable_drugs,order_total:parseFloat(_t.toFixed(2))},gn=await pe("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(cn)});if(!gn.ok){const wt=await gn.json().catch(()=>({}));throw new Error(wt.message||"Order creation failed.")}const Cn=await gn.json();return U("Order created!"),ue(n),X==null||X({role:"system",type:"success",content:"Pharmacy order created successfully."}),{success:!0,actionType:Me,data:Cn,undoData:{orderId:((qe=(De=Cn.orders)==null?void 0:De[0])==null?void 0:qe.id)||Cn.id}}}catch(st){return X==null||X({role:"system",type:"error",content:`Pharmacy order failed: ${st.message}`}),{success:!1,actionType:Me,error:st,originalActionPayload:xe}}finally{L(!1)}})()):Me==="update_patient_details"?Qe.push((async()=>{z(!0),X==null||X({role:"system",type:"loading",content:"Updating patient details..."});const De={...t};try{if(!n)throw new Error("Missing patient ID.");const qe={};if(xe.name&&(qe.name=xe.name),xe.age&&(qe.age=xe.age),xe.gender&&(qe.gender=xe.gender),xe.phone_number!==void 0&&(qe.phone_number=xe.phone_number),!(await pe(`/api/patients/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(qe)})).ok)throw new Error("Patient update failed.");return W(n),X==null||X({role:"system",type:"success",content:"Patient details updated."}),{success:!0,actionType:Me,undoData:{patientId:n,originalDetails:De}}}catch(qe){return{success:!1,actionType:Me,error:qe,originalActionPayload:xe}}finally{z(!1)}})()):Me==="create_lab_order"?Qe.push((async()=>{B(!0),J("Processing lab..."),X==null||X({role:"system",type:"loading",content:"Processing lab order..."});try{if(!n)throw new Error("Missing patient ID.");const De=[];for(const yt of xe.tests||[]){let _t;if(yt.id?_t=v.find(cn=>String(cn.id)===String(yt.id)):yt.name&&(_t=zm(yt.name,v)),!_t)throw new Error(`Lab test "${yt.name}" not found.`);De.push({id:_t.id,name:_t.name,price:Number(_t.price)})}const qe=await pe("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:n,tests:De})});if(!qe.ok)throw new Error("Lab order creation failed.");const st=await qe.json();return J("Success!"),I(n),X==null||X({role:"system",type:"success",content:"Lab order created."}),{success:!0,actionType:Me,data:st.labOrder,undoData:{orderId:st.labOrder.id}}}catch(De){return X==null||X({role:"system",type:"error",content:`Lab order failed: ${De.message}`}),{success:!1,actionType:Me,error:De,originalActionPayload:xe}}finally{B(!1)}})()):Me==="create_lab_report"?Qe.push((async()=>{B(!0),J("Creating Report..."),X==null||X({role:"system",type:"loading",content:"Creating lab report..."});try{if(!n)throw new Error("Missing patient ID.");const De=[],qe=xe.tests||[];for(const Cn of qe){let wt;if(Cn.id?wt=v.find(bt=>String(bt.id)===String(Cn.id)):Cn.name&&(wt=zm(Cn.name,v)),!wt)throw new Error(`Lab test "${Cn.name}" not found.`);Cn._matchedTest=wt,De.push({id:wt.id,name:wt.name,price:Number(wt.price)})}const st=await pe("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:n,tests:De,status:"reported"})});if(!st.ok)throw new Error("Lab order creation failed during report generation.");const yt=await st.json(),_t=yt.labOrder.id,cn={};if(qe.forEach(Cn=>{const wt=Cn._matchedTest,bt=wt.id,Ft=Cn.parameters||[],St={};wt.default_parameters&&wt.default_parameters.forEach(Jn=>{Jn.defaultValue!==void 0&&Jn.defaultValue!==null&&(St[Jn.name]=Jn.defaultValue)}),Ft.forEach(Jn=>{Jn.name&&Jn.value!==void 0&&(St[Jn.name]=Jn.value)}),cn[bt]=St}),!(await pe(`/api/lab/${_t}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(cn)})})).ok)throw new Error("Report submission failed.");return J("Report Created!"),I(n),de(n),X==null||X({role:"system",type:"success",content:"Lab report created successfully."}),{success:!0,actionType:Me,data:yt.labOrder,undoData:{orderId:_t}}}catch(De){return X==null||X({role:"system",type:"error",content:`Lab report failed: ${De.message}`}),{success:!1,actionType:Me,error:De,originalActionPayload:xe}}finally{B(!1)}})()):Me==="edit_lab_report"?Qe.push((async()=>{B(!0),J("Updating Report...");try{const De=xe.serialNumber;if(!De)throw new Error("Missing serial number for lab report edit.");const qe=new Map;(f??[]).forEach(Ft=>qe.set(Ft.id,{...Ft})),(u??[]).forEach(Ft=>{if(qe.has(Ft.id)){const St=qe.get(Ft.id);St.report=Ft,St.status=Ft.status}else qe.set(Ft.id,{...Ft,createdAt:Ft.createdAt})});const st=Array.from(qe.values());st.sort((Ft,St)=>new Date(St.createdAt).getTime()-new Date(Ft.createdAt).getTime());const yt=st.length-De,_t=st[yt];if(!_t)throw new Error(`Lab report #${De} not found.`);const cn=_t.id;let gn={};if(_t.report&&_t.report.report_content)try{gn=typeof _t.report.report_content=="string"?JSON.parse(_t.report.report_content):_t.report.report_content}catch{}const Cn={...gn};if((xe.tests||[]).forEach(Ft=>{let Jn=(_t.tests||[]).find(yn=>yn.name.toLowerCase()===Ft.name.toLowerCase());if(!Jn)return;const Yi=Jn.id,vr=Ft.parameters||[];Cn[Yi]||(Cn[Yi]={}),vr.forEach(yn=>{yn.name&&yn.value!==void 0&&(Cn[Yi][yn.name]=yn.value)})}),!(await pe(`/api/lab/${cn}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(Cn)})})).ok)throw new Error("Report update failed.");return J("Report Updated!"),I(n),de(n),X==null||X({role:"system",type:"success",content:"Lab report updated successfully."}),{success:!0,actionType:Me,data:{orderId:cn},undoData:{orderId:cn}}}catch(De){return X==null||X({role:"system",type:"error",content:`Update report failed: ${De.message}`}),{success:!1,actionType:Me,error:De,originalActionPayload:xe}}finally{B(!1)}})()):Me==="edit_pharmacy_order"?Qe.push((async()=>{L(!0);try{const De=xe.serialNumber;let qe;if(De?qe=[...g].sort((bt,Ft)=>new Date(bt.date).getTime()-new Date(Ft.date).getTime())[De-1]:qe=g.find(wt=>wt.status==="pending"),!qe)throw new Error("Order to edit not found.");const st=JSON.parse(JSON.stringify(qe));let yt=[...qe.medications];const _t=xe.items_to_remove,cn=xe.items;if(Array.isArray(_t)&&(yt=yt.filter(wt=>!_t.some(bt=>bt.drug_id&&String(wt.drug_id)===String(bt.drug_id)||bt.name&&wt.name.toLowerCase()===bt.name.toLowerCase()))),Array.isArray(cn))for(const wt of cn){let bt;if(wt.drug_id?bt=b.find(Jn=>String(Jn.id)===String(wt.drug_id)):wt.name&&(bt=zm(wt.name,b)),!bt)throw new Error(`Drug ${wt.name} not found.`);const Ft=yt.findIndex(Jn=>Jn.drug_id===String(bt==null?void 0:bt.id)),St={drug_id:String(bt.id),name:bt.name,pack_quantity:wt.pack_quantity||0,loose_quantity:wt.loose_quantity||0,pack_price:Number(bt.mrp),loose_price:0,total_price:0,price:Number(bt.mrp)};Ft>=0?yt[Ft]={...yt[Ft],...St}:yt.push(St)}const gn={items:yt,status:xe.status,prescription_for_unavailable_drugs:xe.prescription_for_unavailable_drugs,order_total:0};if(!(await pe(`/api/pharmacy-orders/${qe.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(gn)})).ok)throw new Error("Order edit failed.");return ue(n),{success:!0,actionType:Me,undoData:{orderId:qe.id,originalState:st}}}catch(De){return{success:!1,actionType:Me,error:De,originalActionPayload:xe}}finally{L(!1)}})()):Me==="edit_lab_order"?Qe.push((async()=>{B(!0);try{const De=f.sort((_t,cn)=>new Date(cn.createdAt).getTime()-new Date(_t.createdAt).getTime()).find(_t=>_t.status==="pending");if(!De)throw new Error("No pending lab order to edit.");const qe=JSON.parse(JSON.stringify(De)),st={tests:[],status:xe.status};if(!(await pe(`/api/lab/orders/${De.id}`,{method:"PUT",body:JSON.stringify(st),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Lab edit failed.");return I(n),{success:!0,actionType:Me,undoData:{orderId:De.id,originalState:qe}}}catch(De){return{success:!1,actionType:Me,error:De,originalActionPayload:xe}}finally{B(!1)}})()):Me==="add_complaint_history"?Qe.push((async()=>{D(!0),X==null||X({role:"system",type:"loading",content:"Updating complaint history..."});const De=S;try{if(!e)throw new Error("No record ID.");if(!(await pe(`/api/queue/doctor/complaint/${e}`,{method:"PUT",body:JSON.stringify({complaint:xe.complaint}),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Complaint update failed.");return k(xe.complaint),n&&fe(n),X==null||X({role:"system",type:"success",content:"Complaint history updated."}),{success:!0,actionType:Me,undoData:{recordId:e,originalComplaint:De}}}catch(qe){return X==null||X({role:"system",type:"error",content:`Complaint history update failed: ${qe.message}`}),{success:!1,actionType:Me,error:qe,originalActionPayload:xe}}finally{D(!1)}})()):Me==="update_case_summary"?Qe.push((async()=>{H(!0),X==null||X({role:"system",type:"loading",content:"Updating case summary..."});const De=r;try{if(!e)throw new Error("No record ID.");const qe=await pe(`/api/queue/doctor/complaint/${e}`,{method:"PUT",body:JSON.stringify({case_summary:xe.summary}),headers:{"Content-Type":"application/json"}});if(!qe.ok)throw new Error("Summary update failed.");const st=await qe.json();return Q(st.case_summary),X==null||X({role:"system",type:"success",content:"Case summary updated."}),{success:!0,actionType:Me,undoData:{recordId:e,originalSummary:De}}}catch(qe){return X==null||X({role:"system",type:"error",content:`Case summary update failed: ${qe.message}`}),{success:!1,actionType:Me,error:qe,originalActionPayload:xe}}finally{H(!1)}})()):Me==="end_task"?Qe.push((async()=>(X==null||X({role:"system",type:"success",content:"Task completed."}),{success:!0,actionType:Me}))()):(console.warn(`Unknown action ${Me}`),Qe.push(Promise.resolve({success:!1,actionType:Me,error:new Error(`Unknown action: ${Me}`),originalActionPayload:xe})))}const Ht=await Promise.all(Qe),we=Ht.filter(xe=>!xe.success);if(we.length>0){console.log("AI Actions Failed. Initiating Rollback...",we);const xe=Ht.filter(yt=>yt.success),Me=[...xe].reverse();await lt(Me);const De=we.map(yt=>{var _t;return`${yt.actionType}: ${(_t=yt.error)==null?void 0:_t.message}`}).join("; "),qe=xe.length>0?` I successfully rolled back ${xe.length} other actions that succeeded.`:"",st=`One or more actions failed: [${De}].${qe} Please analyze the failure and try again.`;await rt("multiple_actions",{message:st},be,$e)}else{const xe=Ht.filter(Me=>Me.success);if(xe.length>0&&(Pe(xe),We&&xe.forEach(Me=>We(Me.actionType))),dt&&typeof dt.question=="string")ae(dt.question),re(Array.isArray(dt.options)?dt.options:[]);else if(!At)throw new Error("AI response did not result in a recognized or performed function call.")}}catch(K){await rt("parse_json_actions",K,be,$e)}else throw new Error("AI response did not contain a recognized function call.")};Ze=async(be,$e=0)=>{if($e>1){F("AI call failed after multiple retries. Please try a different prompt."),z(!1);return}z(!0),F(null);let Be;const Ne=[...l,be].join(`

`);try{const K=new Map;(f??[]).forEach(we=>{K.set(we.id,{...we})}),(u??[]).forEach(we=>{if(!K.has(we.id))K.set(we.id,{id:we.id,patient_id:we.patient_id,tests:we.tests,status:we.status,createdAt:we.createdAt,report:we});else{const xe=K.get(we.id);xe&&(xe.report=we,xe.status=we.status)}});const ge=Array.from(K.values());ge.sort((we,xe)=>new Date(xe.createdAt).getTime()-new Date(we.createdAt).getTime());const He=ge.map((we,xe)=>{let Me=null;if(we.report)try{const De=typeof we.report.report_content=="string"?we.report.report_content:JSON.stringify(we.report.report_content||{}),qe=JSON.parse(De||"{}"),st=(we.report.tests||[]).map(yt=>{const _t=qe[yt.id]||{},cn=gn=>({name:gn.name,value:_t[gn.name]!==void 0?String(_t[gn.name]):String(gn.defaultValue),normal_range:gn.normal_range||"N/A"});return{testId:yt.id,testName:yt.name,parameters:(yt.default_parameters||[]).map(cn)}});Me={reportId:we.report.reportId,reportDate:we.report.report_date,tests:st}}catch{Me={reportId:we.report.reportId,reportDate:we.report.report_date,reportContent:typeof we.report.report_content=="string"?we.report.report_content:JSON.stringify(we.report.report_content),error:"Failed to parse report content JSON."}}return{serialNumber:ge.length-xe,orderId:we.id,orderDate:isNaN(new Date(we.createdAt).getTime())?we.createdAt:new Date(we.createdAt).toISOString(),tests:we.tests.map(De=>({id:De.id,name:De.name,price:De.price})),status:we.status,report:Me}}),Qe=p.map(we=>{try{return{...we,createdAt:isNaN(new Date(we.createdAt).getTime())?we.createdAt:new Date(we.createdAt).toISOString()}}catch{return we}}),At=[...g].sort((we,xe)=>{const Me=new Date(we.date).getTime(),De=new Date(xe.date).getTime();return Me-De}).map((we,xe)=>{try{return{serialNumber:xe+1,...we,date:we.date&&!isNaN(new Date(we.date).getTime())?new Date(we.date).toISOString():we.date}}catch{return{serialNumber:xe+1,...we}}}),Ht={query:Ne,currentDateTime:new Date().toISOString(),patientName:(t==null?void 0:t.name)||"",patientAge:(t==null?void 0:t.age)||void 0,patientGender:(t==null?void 0:t.gender)||void 0,case_summary:r||"",case_summary_last_updated:a?new Date(a).toISOString():void 0,clinic_ai_memory:(o==null?void 0:o.aiMemory)||"",clinic_ai_memory_last_updated:o!=null&&o.aiMemoryUpdatedAt?new Date(o.aiMemoryUpdatedAt).toISOString():void 0,clinic_wide_system_prompt:(o==null?void 0:o.clinicWideSystemPrompt)||"",labHistory:He,pharmacyOrders:At,pastComplaints:Qe,pharmacyInventory:b,labInventory:v};if(console.log("DEBUG: Payload before sending to Gemini API:",JSON.stringify(Ht,null,2)),Be=await jQ(Ht,d),Be){T(Be),X==null||X({role:"ai",content:Be});const we=/```json\s*([\s\S]*?)\s*```/,xe=Be.match(we);if(xe&&xe[1])A(Be.replace(we,"").trim()),M(xe[1].trim());else{const Me=Be.trim();if(Me.startsWith("{")&&Me.endsWith("}"))try{JSON.parse(Me),A(""),M(Me)}catch{A(Me),M(null)}else if(Me.startsWith("[")&&Me.endsWith("]"))try{JSON.parse(Me),A(""),M(Me)}catch{A(Me),M(null)}else A(Me),M(null)}R(!1),n&&Be&&await at(n,Be),await ot(Be,$e),k("")}else throw new Error("Invalid AI response format.")}catch(K){await rt("call_generative_api",K,Be,$e)}finally{z(!1)}};const at=async(be,$e)=>{E(!0),ce(null);try{const Be={ai_response:$e},ke=await pe(`/api/patients/${be}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Be)});if(!ke.ok){const Ne=await ke.json().catch(()=>({}));throw new Error(Ne.message||`Failed to save AI response to patient: ${ke.statusText}`)}}catch(Be){ce(`AI Response Save Error: ${Be.message}`),X==null||X({role:"system",type:"error",content:`AI Response Save Error: ${Be.message}`})}finally{E(!1)}};return w.useImperativeHandle(Se,()=>({callGenerativeApi:Ze,undoLastAction:ze})),null}),EQ={};function Kw(e,n){const t=EQ,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return _E(e,r,a)}function _E(e,n,t){if(AQ(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return Y_(e.children,n,t)}return Array.isArray(e)?Y_(e,n,t):""}function Y_(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=_E(e[a],n,t);return r.join("")}function AQ(e){return!!(e&&typeof e=="object")}const W_=document.createElement("i");function Xw(e){const n="&"+e+";";W_.innerHTML=n;const t=W_.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function el(e,n,t,r){const a=e.length;let o=0,l;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)l=Array.from(r),l.unshift(n,t),e.splice(...l);else for(t&&e.splice(n,t);o<r.length;)l=r.slice(o,o+1e4),l.unshift(n,0),e.splice(...l),o+=1e4,n+=1e4}function fs(e,n){return e.length>0?(el(e,e.length,0,n),e):n}const Q_={}.hasOwnProperty;function PQ(e){const n={};let t=-1;for(;++t<e.length;)DQ(n,e[t]);return n}function DQ(e,n){let t;for(t in n){const a=(Q_.call(e,t)?e[t]:void 0)||(e[t]={}),o=n[t];let l;if(o)for(l in o){Q_.call(a,l)||(a[l]=[]);const d=o[l];IQ(a[l],Array.isArray(d)?d:d?[d]:[])}}}function IQ(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);el(e,0,0,r)}function jE(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function Eh(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Jo=xu(/[A-Za-z]/),Ma=xu(/[\dA-Za-z]/),RQ=xu(/[#-'*+\--9=?A-Z^-~]/);function B1(e){return e!==null&&(e<32||e===127)}const q1=xu(/\d/),MQ=xu(/[\dA-Fa-f]/),OQ=xu(/[!-/:-@[-`{-~]/);function Vt(e){return e!==null&&e<-2}function ha(e){return e!==null&&(e<0||e===32)}function Mn(e){return e===-2||e===-1||e===32}const LQ=xu(new RegExp("\\p{P}|\\p{S}","u")),FQ=xu(/\s/);function xu(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function Wh(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const o=e.charCodeAt(t);let l="";if(o===37&&Ma(e.charCodeAt(t+1))&&Ma(e.charCodeAt(t+2)))a=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(l=String.fromCharCode(o));else if(o>55295&&o<57344){const d=e.charCodeAt(t+1);o<56320&&d>56319&&d<57344?(l=String.fromCharCode(o,d),a=1):l=""}else l=String.fromCharCode(o);l&&(n.push(e.slice(r,t),encodeURIComponent(l)),r=t+a+1,l=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function or(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let o=0;return l;function l(f){return Mn(f)?(e.enter(t),d(f)):n(f)}function d(f){return Mn(f)&&o++<a?(e.consume(f),d):(e.exit(t),n(f))}}const $Q={tokenize:zQ};function zQ(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(d){if(d===null){e.consume(d);return}return e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),or(e,n,"linePrefix")}function a(d){return e.enter("paragraph"),o(d)}function o(d){const f=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=f),t=f,l(d)}function l(d){if(d===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(d);return}return Vt(d)?(e.consume(d),e.exit("chunkText"),o):(e.consume(d),l)}}const UQ={tokenize:BQ},J_={tokenize:qQ};function BQ(e){const n=this,t=[];let r=0,a,o,l;return d;function d(R){if(r<t.length){const z=t[r];return n.containerState=z[1],e.attempt(z[0].continuation,f,u)(R)}return u(R)}function f(R){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&M();const z=n.events.length;let F=z,L;for(;F--;)if(n.events[F][0]==="exit"&&n.events[F][1].type==="chunkFlow"){L=n.events[F][1].end;break}A(r);let U=z;for(;U<n.events.length;)n.events[U][1].end={...L},U++;return el(n.events,F+1,0,n.events.slice(z)),n.events.length=U,u(R)}return d(R)}function u(R){if(r===t.length){if(!a)return b(R);if(a.currentConstruct&&a.currentConstruct.concrete)return S(R);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(J_,p,g)(R)}function p(R){return a&&M(),A(r),b(R)}function g(R){return n.parser.lazy[n.now().line]=r!==t.length,l=n.now().offset,S(R)}function b(R){return n.containerState={},e.attempt(J_,v,S)(R)}function v(R){return r++,t.push([n.currentConstruct,n.containerState]),b(R)}function S(R){if(R===null){a&&M(),A(0),e.consume(R);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:o}),k(R)}function k(R){if(R===null){T(e.exit("chunkFlow"),!0),A(0),e.consume(R);return}return Vt(R)?(e.consume(R),T(e.exit("chunkFlow")),r=0,n.interrupt=void 0,d):(e.consume(R),k)}function T(R,z){const F=n.sliceStream(R);if(z&&F.push(null),R.previous=o,o&&(o.next=R),o=R,a.defineSkip(R.start),a.write(F),n.parser.lazy[R.start.line]){let L=a.events.length;for(;L--;)if(a.events[L][1].start.offset<l&&(!a.events[L][1].end||a.events[L][1].end.offset>l))return;const U=n.events.length;let B=U,J,D;for(;B--;)if(n.events[B][0]==="exit"&&n.events[B][1].type==="chunkFlow"){if(J){D=n.events[B][1].end;break}J=!0}for(A(r),L=U;L<n.events.length;)n.events[L][1].end={...D},L++;el(n.events,B+1,0,n.events.slice(U)),n.events.length=L}}function A(R){let z=t.length;for(;z-- >R;){const F=t[z];n.containerState=F[1],F[0].exit.call(n,e)}t.length=R}function M(){a.write([null]),o=void 0,a=void 0,n.containerState._closeFlow=void 0}}function qQ(e,n,t){return or(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function pb(e){if(e===null||ha(e)||FQ(e))return 1;if(LQ(e))return 2}function Zw(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const o=e[a].resolveAll;o&&!r.includes(o)&&(n=o(n,t),r.push(o))}return n}const V1={name:"attention",resolveAll:VQ,tokenize:HQ};function VQ(e,n){let t=-1,r,a,o,l,d,f,u,p;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;f=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};K_(g,-f),K_(b,f),l={type:f>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},d={type:f>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},o={type:f>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:f>1?"strong":"emphasis",start:{...l.start},end:{...d.end}},e[r][1].end={...l.start},e[t][1].start={...d.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=fs(u,[["enter",e[r][1],n],["exit",e[r][1],n]])),u=fs(u,[["enter",a,n],["enter",l,n],["exit",l,n],["enter",o,n]]),u=fs(u,Zw(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),u=fs(u,[["exit",o,n],["enter",d,n],["exit",d,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(p=2,u=fs(u,[["enter",e[t][1],n],["exit",e[t][1],n]])):p=0,el(e,r-1,t-r+3,u),t=r+u.length-p-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function HQ(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=pb(r);let o;return l;function l(f){return o=f,e.enter("attentionSequence"),d(f)}function d(f){if(f===o)return e.consume(f),d;const u=e.exit("attentionSequence"),p=pb(f),g=!p||p===2&&a||t.includes(f),b=!a||a===2&&p||t.includes(r);return u._open=!!(o===42?g:g&&(a||!b)),u._close=!!(o===42?b:b&&(p||!g)),n(f)}}function K_(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const GQ={name:"autolink",tokenize:YQ};function YQ(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o}function o(v){return Jo(v)?(e.consume(v),l):v===64?t(v):u(v)}function l(v){return v===43||v===45||v===46||Ma(v)?(r=1,d(v)):u(v)}function d(v){return v===58?(e.consume(v),r=0,f):(v===43||v===45||v===46||Ma(v))&&r++<32?(e.consume(v),d):(r=0,u(v))}function f(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||B1(v)?t(v):(e.consume(v),f)}function u(v){return v===64?(e.consume(v),p):RQ(v)?(e.consume(v),u):t(v)}function p(v){return Ma(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,p):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||Ma(v))&&r++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const Hb={partial:!0,tokenize:WQ};function WQ(e,n,t){return r;function r(o){return Mn(o)?or(e,a,"linePrefix")(o):a(o)}function a(o){return o===null||Vt(o)?n(o):t(o)}}const kE={continuation:{tokenize:JQ},exit:KQ,name:"blockQuote",tokenize:QQ};function QQ(e,n,t){const r=this;return a;function a(l){if(l===62){const d=r.containerState;return d.open||(e.enter("blockQuote",{_container:!0}),d.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),o}return t(l)}function o(l){return Mn(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(l))}}function JQ(e,n,t){const r=this;return a;function a(l){return Mn(l)?or(e,o,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):o(l)}function o(l){return e.attempt(kE,n,t)(l)}}function KQ(e){e.exit("blockQuote")}const TE={name:"characterEscape",tokenize:XQ};function XQ(e,n,t){return r;function r(o){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(o),e.exit("escapeMarker"),a}function a(o){return OQ(o)?(e.enter("characterEscapeValue"),e.consume(o),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(o)}}const EE={name:"characterReference",tokenize:ZQ};function ZQ(e,n,t){const r=this;let a=0,o,l;return d;function d(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),f}function f(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),o=31,l=Ma,p(g))}function u(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,l=MQ,p):(e.enter("characterReferenceValue"),o=7,l=q1,p(g))}function p(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return l===Ma&&!Xw(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return l(g)&&a++<o?(e.consume(g),p):t(g)}}const X_={partial:!0,tokenize:tJ},Z_={concrete:!0,name:"codeFenced",tokenize:eJ};function eJ(e,n,t){const r=this,a={partial:!0,tokenize:F};let o=0,l=0,d;return f;function f(L){return u(L)}function u(L){const U=r.events[r.events.length-1];return o=U&&U[1].type==="linePrefix"?U[2].sliceSerialize(U[1],!0).length:0,d=L,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),p(L)}function p(L){return L===d?(l++,e.consume(L),p):l<3?t(L):(e.exit("codeFencedFenceSequence"),Mn(L)?or(e,g,"whitespace")(L):g(L))}function g(L){return L===null||Vt(L)?(e.exit("codeFencedFence"),r.interrupt?n(L):e.check(X_,k,z)(L)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b(L))}function b(L){return L===null||Vt(L)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g(L)):Mn(L)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),or(e,v,"whitespace")(L)):L===96&&L===d?t(L):(e.consume(L),b)}function v(L){return L===null||Vt(L)?g(L):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S(L))}function S(L){return L===null||Vt(L)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g(L)):L===96&&L===d?t(L):(e.consume(L),S)}function k(L){return e.attempt(a,z,T)(L)}function T(L){return e.enter("lineEnding"),e.consume(L),e.exit("lineEnding"),A}function A(L){return o>0&&Mn(L)?or(e,M,"linePrefix",o+1)(L):M(L)}function M(L){return L===null||Vt(L)?e.check(X_,k,z)(L):(e.enter("codeFlowValue"),R(L))}function R(L){return L===null||Vt(L)?(e.exit("codeFlowValue"),M(L)):(e.consume(L),R)}function z(L){return e.exit("codeFenced"),n(L)}function F(L,U,B){let J=0;return D;function D(Y){return L.enter("lineEnding"),L.consume(Y),L.exit("lineEnding"),$}function $(Y){return L.enter("codeFencedFence"),Mn(Y)?or(L,H,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(Y):H(Y)}function H(Y){return Y===d?(L.enter("codeFencedFenceSequence"),te(Y)):B(Y)}function te(Y){return Y===d?(J++,L.consume(Y),te):J>=l?(L.exit("codeFencedFenceSequence"),Mn(Y)?or(L,Q,"whitespace")(Y):Q(Y)):B(Y)}function Q(Y){return Y===null||Vt(Y)?(L.exit("codeFencedFence"),U(Y)):B(Y)}}}function tJ(e,n,t){const r=this;return a;function a(l){return l===null?t(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}const O0={name:"codeIndented",tokenize:rJ},nJ={partial:!0,tokenize:iJ};function rJ(e,n,t){const r=this;return a;function a(u){return e.enter("codeIndented"),or(e,o,"linePrefix",5)(u)}function o(u){const p=r.events[r.events.length-1];return p&&p[1].type==="linePrefix"&&p[2].sliceSerialize(p[1],!0).length>=4?l(u):t(u)}function l(u){return u===null?f(u):Vt(u)?e.attempt(nJ,l,f)(u):(e.enter("codeFlowValue"),d(u))}function d(u){return u===null||Vt(u)?(e.exit("codeFlowValue"),l(u)):(e.consume(u),d)}function f(u){return e.exit("codeIndented"),n(u)}}function iJ(e,n,t){const r=this;return a;function a(l){return r.parser.lazy[r.now().line]?t(l):Vt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):or(e,o,"linePrefix",5)(l)}function o(l){const d=r.events[r.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):Vt(l)?a(l):t(l)}}const aJ={name:"codeText",previous:oJ,resolve:sJ,tokenize:lJ};function sJ(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function oJ(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function lJ(e,n,t){let r=0,a,o;return l;function l(g){return e.enter("codeText"),e.enter("codeTextSequence"),d(g)}function d(g){return g===96?(e.consume(g),r++,d):(e.exit("codeTextSequence"),f(g))}function f(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),f):g===96?(o=e.enter("codeTextSequence"),a=0,p(g)):Vt(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),f):(e.enter("codeTextData"),u(g))}function u(g){return g===null||g===32||g===96||Vt(g)?(e.exit("codeTextData"),f(g)):(e.consume(g),u)}function p(g){return g===96?(e.consume(g),a++,p):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(o.type="codeTextData",u(g))}}class cJ{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const o=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&Om(this.left,r),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Om(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Om(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Om(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Om(this.left,t.reverse())}}}function Om(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function AE(e){const n={};let t=-1,r,a,o,l,d,f,u;const p=new cJ(e);for(;++t<p.length;){for(;t in n;)t=n[t];if(r=p.get(t),t&&r[1].type==="chunkFlow"&&p.get(t-1)[1].type==="listItemPrefix"&&(f=r[1]._tokenizer.events,o=0,o<f.length&&f[o][1].type==="lineEndingBlank"&&(o+=2),o<f.length&&f[o][1].type==="content"))for(;++o<f.length&&f[o][1].type!=="content";)f[o][1].type==="chunkText"&&(f[o][1]._isInFirstContentOfListItem=!0,o++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,uJ(p,t)),t=n[t],u=!0);else if(r[1]._container){for(o=t,a=void 0;o--;)if(l=p.get(o),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(p.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=o);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(r[1].end={...p.get(a)[1].start},d=p.slice(a,t),d.unshift(r),p.splice(a,t-a+1,d))}}return el(e,0,Number.POSITIVE_INFINITY,p.slice(0)),!u}function uJ(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const o=[];let l=t._tokenizer;l||(l=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const d=l.events,f=[],u={};let p,g,b=-1,v=t,S=0,k=0;const T=[k];for(;v;){for(;e.get(++a)[1]!==v;);o.push(a),v._tokenizer||(p=r.sliceStream(v),v.next||p.push(null),g&&l.defineSkip(v.start),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(p),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<d.length;)d[b][0]==="exit"&&d[b-1][0]==="enter"&&d[b][1].type===d[b-1][1].type&&d[b][1].start.line!==d[b][1].end.line&&(k=b+1,T.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(l.events=[],v?(v._tokenizer=void 0,v.previous=void 0):T.pop(),b=T.length;b--;){const A=d.slice(T[b],T[b+1]),M=o.pop();f.push([M,M+A.length-1]),e.splice(M,2,A)}for(f.reverse(),b=-1;++b<f.length;)u[S+f[b][0]]=S+f[b][1],S+=f[b][1]-f[b][0]-1;return u}const dJ={resolve:hJ,tokenize:pJ},fJ={partial:!0,tokenize:mJ};function hJ(e){return AE(e),e}function pJ(e,n){let t;return r;function r(d){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(d)}function a(d){return d===null?o(d):Vt(d)?e.check(fJ,l,o)(d):(e.consume(d),a)}function o(d){return e.exit("chunkContent"),e.exit("content"),n(d)}function l(d){return e.consume(d),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function mJ(e,n,t){const r=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),or(e,o,"linePrefix")}function o(l){if(l===null||Vt(l))return t(l);const d=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):e.interrupt(r.parser.constructs.flow,t,n)(l)}}function PE(e,n,t,r,a,o,l,d,f){const u=f||Number.POSITIVE_INFINITY;let p=0;return g;function g(A){return A===60?(e.enter(r),e.enter(a),e.enter(o),e.consume(A),e.exit(o),b):A===null||A===32||A===41||B1(A)?t(A):(e.enter(r),e.enter(l),e.enter(d),e.enter("chunkString",{contentType:"string"}),k(A))}function b(A){return A===62?(e.enter(o),e.consume(A),e.exit(o),e.exit(a),e.exit(r),n):(e.enter(d),e.enter("chunkString",{contentType:"string"}),v(A))}function v(A){return A===62?(e.exit("chunkString"),e.exit(d),b(A)):A===null||A===60||Vt(A)?t(A):(e.consume(A),A===92?S:v)}function S(A){return A===60||A===62||A===92?(e.consume(A),v):v(A)}function k(A){return!p&&(A===null||A===41||ha(A))?(e.exit("chunkString"),e.exit(d),e.exit(l),e.exit(r),n(A)):p<u&&A===40?(e.consume(A),p++,k):A===41?(e.consume(A),p--,k):A===null||A===32||A===40||B1(A)?t(A):(e.consume(A),A===92?T:k)}function T(A){return A===40||A===41||A===92?(e.consume(A),k):k(A)}}function DE(e,n,t,r,a,o){const l=this;let d=0,f;return u;function u(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(o),p}function p(v){return d>999||v===null||v===91||v===93&&!f||v===94&&!d&&"_hiddenFootnoteSupport"in l.parser.constructs?t(v):v===93?(e.exit(o),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):Vt(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),p):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||Vt(v)||d++>999?(e.exit("chunkString"),p(v)):(e.consume(v),f||(f=!Mn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),d++,g):g(v)}}function IE(e,n,t,r,a,o){let l;return d;function d(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),l=b===40?41:b,f):t(b)}function f(b){return b===l?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(o),u(b))}function u(b){return b===l?(e.exit(o),f(l)):b===null?t(b):Vt(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),or(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),p(b))}function p(b){return b===l||b===null||Vt(b)?(e.exit("chunkString"),u(b)):(e.consume(b),b===92?g:p)}function g(b){return b===l||b===92?(e.consume(b),p):p(b)}}function Vm(e,n){let t;return r;function r(a){return Vt(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):Mn(a)?or(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const gJ={name:"definition",tokenize:xJ},yJ={partial:!0,tokenize:bJ};function xJ(e,n,t){const r=this;let a;return o;function o(v){return e.enter("definition"),l(v)}function l(v){return DE.call(r,e,d,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function d(v){return a=Eh(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),f):t(v)}function f(v){return ha(v)?Vm(e,u)(v):u(v)}function u(v){return PE(e,p,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function p(v){return e.attempt(yJ,g,g)(v)}function g(v){return Mn(v)?or(e,b,"whitespace")(v):b(v)}function b(v){return v===null||Vt(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function bJ(e,n,t){return r;function r(d){return ha(d)?Vm(e,a)(d):t(d)}function a(d){return IE(e,o,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(d)}function o(d){return Mn(d)?or(e,l,"whitespace")(d):l(d)}function l(d){return d===null||Vt(d)?n(d):t(d)}}const vJ={name:"hardBreakEscape",tokenize:wJ};function wJ(e,n,t){return r;function r(o){return e.enter("hardBreakEscape"),e.consume(o),a}function a(o){return Vt(o)?(e.exit("hardBreakEscape"),n(o)):t(o)}}const SJ={name:"headingAtx",resolve:NJ,tokenize:CJ};function NJ(e,n){let t=e.length-2,r=3,a,o;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},o={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},el(e,r,t-r+1,[["enter",a,n],["enter",o,n],["exit",o,n],["exit",a,n]])),e}function CJ(e,n,t){let r=0;return a;function a(p){return e.enter("atxHeading"),o(p)}function o(p){return e.enter("atxHeadingSequence"),l(p)}function l(p){return p===35&&r++<6?(e.consume(p),l):p===null||ha(p)?(e.exit("atxHeadingSequence"),d(p)):t(p)}function d(p){return p===35?(e.enter("atxHeadingSequence"),f(p)):p===null||Vt(p)?(e.exit("atxHeading"),n(p)):Mn(p)?or(e,d,"whitespace")(p):(e.enter("atxHeadingText"),u(p))}function f(p){return p===35?(e.consume(p),f):(e.exit("atxHeadingSequence"),d(p))}function u(p){return p===null||p===35||ha(p)?(e.exit("atxHeadingText"),d(p)):(e.consume(p),u)}}const _J=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],ej=["pre","script","style","textarea"],jJ={concrete:!0,name:"htmlFlow",resolveTo:EJ,tokenize:AJ},kJ={partial:!0,tokenize:DJ},TJ={partial:!0,tokenize:PJ};function EJ(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function AJ(e,n,t){const r=this;let a,o,l,d,f;return u;function u(I){return p(I)}function p(I){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(I),g}function g(I){return I===33?(e.consume(I),b):I===47?(e.consume(I),o=!0,k):I===63?(e.consume(I),a=3,r.interrupt?n:E):Jo(I)?(e.consume(I),l=String.fromCharCode(I),T):t(I)}function b(I){return I===45?(e.consume(I),a=2,v):I===91?(e.consume(I),a=5,d=0,S):Jo(I)?(e.consume(I),a=4,r.interrupt?n:E):t(I)}function v(I){return I===45?(e.consume(I),r.interrupt?n:E):t(I)}function S(I){const de="CDATA[";return I===de.charCodeAt(d++)?(e.consume(I),d===de.length?r.interrupt?n:H:S):t(I)}function k(I){return Jo(I)?(e.consume(I),l=String.fromCharCode(I),T):t(I)}function T(I){if(I===null||I===47||I===62||ha(I)){const de=I===47,fe=l.toLowerCase();return!de&&!o&&ej.includes(fe)?(a=1,r.interrupt?n(I):H(I)):_J.includes(l.toLowerCase())?(a=6,de?(e.consume(I),A):r.interrupt?n(I):H(I)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(I):o?M(I):R(I))}return I===45||Ma(I)?(e.consume(I),l+=String.fromCharCode(I),T):t(I)}function A(I){return I===62?(e.consume(I),r.interrupt?n:H):t(I)}function M(I){return Mn(I)?(e.consume(I),M):D(I)}function R(I){return I===47?(e.consume(I),D):I===58||I===95||Jo(I)?(e.consume(I),z):Mn(I)?(e.consume(I),R):D(I)}function z(I){return I===45||I===46||I===58||I===95||Ma(I)?(e.consume(I),z):F(I)}function F(I){return I===61?(e.consume(I),L):Mn(I)?(e.consume(I),F):R(I)}function L(I){return I===null||I===60||I===61||I===62||I===96?t(I):I===34||I===39?(e.consume(I),f=I,U):Mn(I)?(e.consume(I),L):B(I)}function U(I){return I===f?(e.consume(I),f=null,J):I===null||Vt(I)?t(I):(e.consume(I),U)}function B(I){return I===null||I===34||I===39||I===47||I===60||I===61||I===62||I===96||ha(I)?F(I):(e.consume(I),B)}function J(I){return I===47||I===62||Mn(I)?R(I):t(I)}function D(I){return I===62?(e.consume(I),$):t(I)}function $(I){return I===null||Vt(I)?H(I):Mn(I)?(e.consume(I),$):t(I)}function H(I){return I===45&&a===2?(e.consume(I),V):I===60&&a===1?(e.consume(I),ae):I===62&&a===4?(e.consume(I),ce):I===63&&a===3?(e.consume(I),E):I===93&&a===5?(e.consume(I),le):Vt(I)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(kJ,ue,te)(I)):I===null||Vt(I)?(e.exit("htmlFlowData"),te(I)):(e.consume(I),H)}function te(I){return e.check(TJ,Q,ue)(I)}function Q(I){return e.enter("lineEnding"),e.consume(I),e.exit("lineEnding"),Y}function Y(I){return I===null||Vt(I)?te(I):(e.enter("htmlFlowData"),H(I))}function V(I){return I===45?(e.consume(I),E):H(I)}function ae(I){return I===47?(e.consume(I),l="",re):H(I)}function re(I){if(I===62){const de=l.toLowerCase();return ej.includes(de)?(e.consume(I),ce):H(I)}return Jo(I)&&l.length<8?(e.consume(I),l+=String.fromCharCode(I),re):H(I)}function le(I){return I===93?(e.consume(I),E):H(I)}function E(I){return I===62?(e.consume(I),ce):I===45&&a===2?(e.consume(I),E):H(I)}function ce(I){return I===null||Vt(I)?(e.exit("htmlFlowData"),ue(I)):(e.consume(I),ce)}function ue(I){return e.exit("htmlFlow"),n(I)}}function PJ(e,n,t){const r=this;return a;function a(l){return Vt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o):t(l)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}function DJ(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(Hb,n,t)}}const IJ={name:"htmlText",tokenize:RJ};function RJ(e,n,t){const r=this;let a,o,l;return d;function d(E){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(E),f}function f(E){return E===33?(e.consume(E),u):E===47?(e.consume(E),F):E===63?(e.consume(E),R):Jo(E)?(e.consume(E),B):t(E)}function u(E){return E===45?(e.consume(E),p):E===91?(e.consume(E),o=0,S):Jo(E)?(e.consume(E),M):t(E)}function p(E){return E===45?(e.consume(E),v):t(E)}function g(E){return E===null?t(E):E===45?(e.consume(E),b):Vt(E)?(l=g,ae(E)):(e.consume(E),g)}function b(E){return E===45?(e.consume(E),v):g(E)}function v(E){return E===62?V(E):E===45?b(E):g(E)}function S(E){const ce="CDATA[";return E===ce.charCodeAt(o++)?(e.consume(E),o===ce.length?k:S):t(E)}function k(E){return E===null?t(E):E===93?(e.consume(E),T):Vt(E)?(l=k,ae(E)):(e.consume(E),k)}function T(E){return E===93?(e.consume(E),A):k(E)}function A(E){return E===62?V(E):E===93?(e.consume(E),A):k(E)}function M(E){return E===null||E===62?V(E):Vt(E)?(l=M,ae(E)):(e.consume(E),M)}function R(E){return E===null?t(E):E===63?(e.consume(E),z):Vt(E)?(l=R,ae(E)):(e.consume(E),R)}function z(E){return E===62?V(E):R(E)}function F(E){return Jo(E)?(e.consume(E),L):t(E)}function L(E){return E===45||Ma(E)?(e.consume(E),L):U(E)}function U(E){return Vt(E)?(l=U,ae(E)):Mn(E)?(e.consume(E),U):V(E)}function B(E){return E===45||Ma(E)?(e.consume(E),B):E===47||E===62||ha(E)?J(E):t(E)}function J(E){return E===47?(e.consume(E),V):E===58||E===95||Jo(E)?(e.consume(E),D):Vt(E)?(l=J,ae(E)):Mn(E)?(e.consume(E),J):V(E)}function D(E){return E===45||E===46||E===58||E===95||Ma(E)?(e.consume(E),D):$(E)}function $(E){return E===61?(e.consume(E),H):Vt(E)?(l=$,ae(E)):Mn(E)?(e.consume(E),$):J(E)}function H(E){return E===null||E===60||E===61||E===62||E===96?t(E):E===34||E===39?(e.consume(E),a=E,te):Vt(E)?(l=H,ae(E)):Mn(E)?(e.consume(E),H):(e.consume(E),Q)}function te(E){return E===a?(e.consume(E),a=void 0,Y):E===null?t(E):Vt(E)?(l=te,ae(E)):(e.consume(E),te)}function Q(E){return E===null||E===34||E===39||E===60||E===61||E===96?t(E):E===47||E===62||ha(E)?J(E):(e.consume(E),Q)}function Y(E){return E===47||E===62||ha(E)?J(E):t(E)}function V(E){return E===62?(e.consume(E),e.exit("htmlTextData"),e.exit("htmlText"),n):t(E)}function ae(E){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(E),e.exit("lineEnding"),re}function re(E){return Mn(E)?or(e,le,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(E):le(E)}function le(E){return e.enter("htmlTextData"),l(E)}}const eS={name:"labelEnd",resolveAll:FJ,resolveTo:$J,tokenize:zJ},MJ={tokenize:UJ},OJ={tokenize:BJ},LJ={tokenize:qJ};function FJ(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&el(e,0,e.length,t),e}function $J(e,n){let t=e.length,r=0,a,o,l,d;for(;t--;)if(a=e[t][1],o){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(o=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(l=t);const f={type:e[o][1].type==="labelLink"?"link":"image",start:{...e[o][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[o][1].start},end:{...e[l][1].end}},p={type:"labelText",start:{...e[o+r+2][1].end},end:{...e[l-2][1].start}};return d=[["enter",f,n],["enter",u,n]],d=fs(d,e.slice(o+1,o+r+3)),d=fs(d,[["enter",p,n]]),d=fs(d,Zw(n.parser.constructs.insideSpan.null,e.slice(o+r+4,l-3),n)),d=fs(d,[["exit",p,n],e[l-2],e[l-1],["exit",u,n]]),d=fs(d,e.slice(l+1)),d=fs(d,[["exit",f,n]]),el(e,o,e.length,d),e}function zJ(e,n,t){const r=this;let a=r.events.length,o,l;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){o=r.events[a][1];break}return d;function d(b){return o?o._inactive?g(b):(l=r.parser.defined.includes(Eh(r.sliceSerialize({start:o.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),f):t(b)}function f(b){return b===40?e.attempt(MJ,p,l?p:g)(b):b===91?e.attempt(OJ,p,l?u:g)(b):l?p(b):g(b)}function u(b){return e.attempt(LJ,p,g)(b)}function p(b){return n(b)}function g(b){return o._balanced=!0,t(b)}}function UJ(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return ha(g)?Vm(e,o)(g):o(g)}function o(g){return g===41?p(g):PE(e,l,d,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function l(g){return ha(g)?Vm(e,f)(g):p(g)}function d(g){return t(g)}function f(g){return g===34||g===39||g===40?IE(e,u,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):p(g)}function u(g){return ha(g)?Vm(e,p)(g):p(g)}function p(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function BJ(e,n,t){const r=this;return a;function a(d){return DE.call(r,e,o,l,"reference","referenceMarker","referenceString")(d)}function o(d){return r.parser.defined.includes(Eh(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(d):t(d)}function l(d){return t(d)}}function qJ(e,n,t){return r;function r(o){return e.enter("reference"),e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),a}function a(o){return o===93?(e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),e.exit("reference"),n):t(o)}}const VJ={name:"labelStartImage",resolveAll:eS.resolveAll,tokenize:HJ};function HJ(e,n,t){const r=this;return a;function a(d){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(d),e.exit("labelImageMarker"),o}function o(d){return d===91?(e.enter("labelMarker"),e.consume(d),e.exit("labelMarker"),e.exit("labelImage"),l):t(d)}function l(d){return d===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(d):n(d)}}const GJ={name:"labelStartLink",resolveAll:eS.resolveAll,tokenize:YJ};function YJ(e,n,t){const r=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),o}function o(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(l):n(l)}}const L0={name:"lineEnding",tokenize:WJ};function WJ(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),or(e,n,"linePrefix")}}const Gx={name:"thematicBreak",tokenize:QJ};function QJ(e,n,t){let r=0,a;return o;function o(u){return e.enter("thematicBreak"),l(u)}function l(u){return a=u,d(u)}function d(u){return u===a?(e.enter("thematicBreakSequence"),f(u)):r>=3&&(u===null||Vt(u))?(e.exit("thematicBreak"),n(u)):t(u)}function f(u){return u===a?(e.consume(u),r++,f):(e.exit("thematicBreakSequence"),Mn(u)?or(e,d,"whitespace")(u):d(u))}}const ua={continuation:{tokenize:ZJ},exit:tK,name:"list",tokenize:XJ},JJ={partial:!0,tokenize:nK},KJ={partial:!0,tokenize:eK};function XJ(e,n,t){const r=this,a=r.events[r.events.length-1];let o=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return d;function d(v){const S=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:q1(v)){if(r.containerState.type||(r.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(Gx,t,u)(v):u(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),f(v)}return t(v)}function f(v){return q1(v)&&++l<10?(e.consume(v),f):(!r.interrupt||l<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),u(v)):t(v)}function u(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(Hb,r.interrupt?t:p,e.attempt(JJ,b,g))}function p(v){return r.containerState.initialBlankLine=!0,o++,b(v)}function g(v){return Mn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=o+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function ZJ(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(Hb,a,o);function a(d){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,or(e,n,"listItemIndent",r.containerState.size+1)(d)}function o(d){return r.containerState.furtherBlankLines||!Mn(d)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,l(d)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(KJ,n,l)(d))}function l(d){return r.containerState._closeFlow=!0,r.interrupt=void 0,or(e,e.attempt(ua,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(d)}}function eK(e,n,t){const r=this;return or(e,a,"listItemIndent",r.containerState.size+1);function a(o){const l=r.events[r.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===r.containerState.size?n(o):t(o)}}function tK(e){e.exit(this.containerState.type)}function nK(e,n,t){const r=this;return or(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(o){const l=r.events[r.events.length-1];return!Mn(o)&&l&&l[1].type==="listItemPrefixWhitespace"?n(o):t(o)}}const tj={name:"setextUnderline",resolveTo:rK,tokenize:iK};function rK(e,n){let t=e.length,r,a,o;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!o&&e[t][1].type==="definition"&&(o=t);const l={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",o?(e.splice(a,0,["enter",l,n]),e.splice(o+1,0,["exit",e[r][1],n]),e[r][1].end={...e[o][1].end}):e[r][1]=l,e.push(["exit",l,n]),e}function iK(e,n,t){const r=this;let a;return o;function o(u){let p=r.events.length,g;for(;p--;)if(r.events[p][1].type!=="lineEnding"&&r.events[p][1].type!=="linePrefix"&&r.events[p][1].type!=="content"){g=r.events[p][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=u,l(u)):t(u)}function l(u){return e.enter("setextHeadingLineSequence"),d(u)}function d(u){return u===a?(e.consume(u),d):(e.exit("setextHeadingLineSequence"),Mn(u)?or(e,f,"lineSuffix")(u):f(u))}function f(u){return u===null||Vt(u)?(e.exit("setextHeadingLine"),n(u)):t(u)}}const aK={tokenize:sK};function sK(e){const n=this,t=e.attempt(Hb,r,e.attempt(this.parser.constructs.flowInitial,a,or(e,e.attempt(this.parser.constructs.flow,a,e.attempt(dJ,a)),"linePrefix")));return t;function r(o){if(o===null){e.consume(o);return}return e.enter("lineEndingBlank"),e.consume(o),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const oK={resolveAll:ME()},lK=RE("string"),cK=RE("text");function RE(e){return{resolveAll:ME(e==="text"?uK:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],o=t.attempt(a,l,d);return l;function l(p){return u(p)?o(p):d(p)}function d(p){if(p===null){t.consume(p);return}return t.enter("data"),t.consume(p),f}function f(p){return u(p)?(t.exit("data"),o(p)):(t.consume(p),f)}function u(p){if(p===null)return!0;const g=a[p];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function ME(e){return n;function n(t,r){let a=-1,o;for(;++a<=t.length;)o===void 0?t[a]&&t[a][1].type==="data"&&(o=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==o+2&&(t[o][1].end=t[a-1][1].end,t.splice(o+2,a-o-2),a=o+2),o=void 0);return e?e(t,r):t}}function uK(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let o=a.length,l=-1,d=0,f;for(;o--;){const u=a[o];if(typeof u=="string"){for(l=u.length;u.charCodeAt(l-1)===32;)d++,l--;if(l)break;l=-1}else if(u===-2)f=!0,d++;else if(u!==-1){o++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(d=0),d){const u={type:t===e.length||f||d<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?l:r.start._bufferIndex+l,_index:r.start._index+o,line:r.end.line,column:r.end.column-d,offset:r.end.offset-d},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(t,0,["enter",u,n],["exit",u,n]),t+=2)}t++}return e}const dK={42:ua,43:ua,45:ua,48:ua,49:ua,50:ua,51:ua,52:ua,53:ua,54:ua,55:ua,56:ua,57:ua,62:kE},fK={91:gJ},hK={[-2]:O0,[-1]:O0,32:O0},pK={35:SJ,42:Gx,45:[tj,Gx],60:jJ,61:tj,95:Gx,96:Z_,126:Z_},mK={38:EE,92:TE},gK={[-5]:L0,[-4]:L0,[-3]:L0,33:VJ,38:EE,42:V1,60:[GQ,IJ],91:GJ,92:[vJ,TE],93:eS,95:V1,96:aJ},yK={null:[V1,oK]},xK={null:[42,95]},bK={null:[]},vK=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:xK,contentInitial:fK,disable:bK,document:dK,flow:pK,flowInitial:hK,insideSpan:yK,string:mK,text:gK},Symbol.toStringTag,{value:"Module"}));function wK(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},o=[];let l=[],d=[];const f={attempt:U(F),check:U(L),consume:M,enter:R,exit:z,interrupt:U(L,{interrupt:!0})},u={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let p=n.tokenize.call(u,f);return n.resolveAll&&o.push(n),u;function g($){return l=fs(l,$),T(),l[l.length-1]!==null?[]:(B(n,0),u.events=Zw(o,u.events,u),u.events)}function b($,H){return NK(v($),H)}function v($){return SK(l,$)}function S(){const{_bufferIndex:$,_index:H,line:te,column:Q,offset:Y}=r;return{_bufferIndex:$,_index:H,line:te,column:Q,offset:Y}}function k($){a[$.line]=$.column,D()}function T(){let $;for(;r._index<l.length;){const H=l[r._index];if(typeof H=="string")for($=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===$&&r._bufferIndex<H.length;)A(H.charCodeAt(r._bufferIndex));else A(H)}}function A($){p=p($)}function M($){Vt($)?(r.line++,r.column=1,r.offset+=$===-3?2:1,D()):$!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===l[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=$}function R($,H){const te=H||{};return te.type=$,te.start=S(),u.events.push(["enter",te,u]),d.push(te),te}function z($){const H=d.pop();return H.end=S(),u.events.push(["exit",H,u]),H}function F($,H){B($,H.from)}function L($,H){H.restore()}function U($,H){return te;function te(Q,Y,V){let ae,re,le,E;return Array.isArray(Q)?ue(Q):"tokenize"in Q?ue([Q]):ce(Q);function ce(W){return oe;function oe(se){const je=se!==null&&W[se],We=se!==null&&W.null,X=[...Array.isArray(je)?je:je?[je]:[],...Array.isArray(We)?We:We?[We]:[]];return ue(X)(se)}}function ue(W){return ae=W,re=0,W.length===0?V:I(W[re])}function I(W){return oe;function oe(se){return E=J(),le=W,W.partial||(u.currentConstruct=W),W.name&&u.parser.constructs.disable.null.includes(W.name)?fe():W.tokenize.call(H?Object.assign(Object.create(u),H):u,f,de,fe)(se)}}function de(W){return $(le,E),Y}function fe(W){return E.restore(),++re<ae.length?I(ae[re]):V}}}function B($,H){$.resolveAll&&!o.includes($)&&o.push($),$.resolve&&el(u.events,H,u.events.length-H,$.resolve(u.events.slice(H),u)),$.resolveTo&&(u.events=$.resolveTo(u.events,u))}function J(){const $=S(),H=u.previous,te=u.currentConstruct,Q=u.events.length,Y=Array.from(d);return{from:Q,restore:V};function V(){r=$,u.previous=H,u.currentConstruct=te,u.events.length=Q,d=Y,D()}}function D(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function SK(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,o=n.end._bufferIndex;let l;if(t===a)l=[e[t].slice(r,o)];else{if(l=e.slice(t,a),r>-1){const d=l[0];typeof d=="string"?l[0]=d.slice(r):l.shift()}o>0&&l.push(e[a].slice(0,o))}return l}function NK(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const o=e[t];let l;if(typeof o=="string")l=o;else switch(o){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=n?" ":"	";break}case-1:{if(!n&&a)continue;l=" ";break}default:l=String.fromCharCode(o)}a=o===-2,r.push(l)}return r.join("")}function CK(e){const r={constructs:PQ([vK,...(e||{}).extensions||[]]),content:a($Q),defined:[],document:a(UQ),flow:a(aK),lazy:{},string:a(lK),text:a(cK)};return r;function a(o){return l;function l(d){return wK(r,o,d)}}}function _K(e){for(;!AE(e););return e}const nj=/[\0\t\n\r]/g;function jK(){let e=1,n="",t=!0,r;return a;function a(o,l,d){const f=[];let u,p,g,b,v;for(o=n+(typeof o=="string"?o.toString():new TextDecoder(l||void 0).decode(o)),g=0,n="",t&&(o.charCodeAt(0)===65279&&g++,t=void 0);g<o.length;){if(nj.lastIndex=g,u=nj.exec(o),b=u&&u.index!==void 0?u.index:o.length,v=o.charCodeAt(b),!u){n=o.slice(g);break}if(v===10&&g===b&&r)f.push(-3),r=void 0;else switch(r&&(f.push(-5),r=void 0),g<b&&(f.push(o.slice(g,b)),e+=b-g),v){case 0:{f.push(65533),e++;break}case 9:{for(p=Math.ceil(e/4)*4,f.push(-2);e++<p;)f.push(-1);break}case 10:{f.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return d&&(r&&f.push(-5),n&&f.push(n),f.push(null)),f}}const kK=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function OE(e){return e.replace(kK,TK)}function TK(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),o=a===120||a===88;return jE(t.slice(o?2:1),o?16:10)}return Xw(t)||e}function Hm(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?rj(e.position):"start"in e||"end"in e?rj(e):"line"in e||"column"in e?H1(e):""}function H1(e){return ij(e&&e.line)+":"+ij(e&&e.column)}function rj(e){return H1(e&&e.start)+"-"+H1(e&&e.end)}function ij(e){return e&&typeof e=="number"?e:1}const LE={}.hasOwnProperty;function EK(e,n,t){return typeof n!="string"&&(t=n,n=void 0),AK(t)(_K(CK(t).document().write(jK()(e,n,!0))))}function AK(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(ot),autolinkProtocol:J,autolinkEmail:J,atxHeading:o(Ze),blockQuote:o(We),characterEscape:J,characterReference:J,codeFenced:o(X),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:o(X,l),codeText:o(Se,l),codeTextData:J,data:J,codeFlowValue:J,definition:o(Ae),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:o(Pe),hardBreakEscape:o(rt),hardBreakTrailing:o(rt),htmlFlow:o(lt,l),htmlFlowData:J,htmlText:o(lt,l),htmlTextData:J,image:o(ze),label:l,link:o(ot),listItem:o(be),listItemValue:b,listOrdered:o(at,g),listUnordered:o(at),paragraph:o($e),reference:I,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:o(Ze),strong:o(Be),thematicBreak:o(Ne)},exit:{atxHeading:f(),atxHeadingSequence:F,autolink:f(),autolinkEmail:je,autolinkProtocol:se,blockQuote:f(),characterEscapeValue:D,characterReferenceMarkerHexadecimal:fe,characterReferenceMarkerNumeric:fe,characterReferenceValue:W,characterReference:oe,codeFenced:f(T),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:D,codeIndented:f(A),codeText:f(Y),codeTextData:D,data:D,definition:f(),definitionDestinationString:z,definitionLabelString:M,definitionTitleString:R,emphasis:f(),hardBreakEscape:f(H),hardBreakTrailing:f(H),htmlFlow:f(te),htmlFlowData:D,htmlText:f(Q),htmlTextData:D,image:f(ae),label:le,labelText:re,lineEnding:$,link:f(V),listItem:f(),listOrdered:f(),listUnordered:f(),paragraph:f(),referenceString:de,resourceDestinationString:E,resourceTitleString:ce,resource:ue,setextHeading:f(B),setextHeadingLineSequence:U,setextHeadingText:L,strong:f(),thematicBreak:f()}};FE(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(K){let ge={type:"root",children:[]};const He={stack:[ge],tokenStack:[],config:n,enter:d,exit:u,buffer:l,resume:p,data:t},Qe=[];let dt=-1;for(;++dt<K.length;)if(K[dt][1].type==="listOrdered"||K[dt][1].type==="listUnordered")if(K[dt][0]==="enter")Qe.push(dt);else{const At=Qe.pop();dt=a(K,At,dt)}for(dt=-1;++dt<K.length;){const At=n[K[dt][0]];LE.call(At,K[dt][1].type)&&At[K[dt][1].type].call(Object.assign({sliceSerialize:K[dt][2].sliceSerialize},He),K[dt][1])}if(He.tokenStack.length>0){const At=He.tokenStack[He.tokenStack.length-1];(At[1]||aj).call(He,void 0,At[0])}for(ge.position={start:su(K.length>0?K[0][1].start:{line:1,column:1,offset:0}),end:su(K.length>0?K[K.length-2][1].end:{line:1,column:1,offset:0})},dt=-1;++dt<n.transforms.length;)ge=n.transforms[dt](ge)||ge;return ge}function a(K,ge,He){let Qe=ge-1,dt=-1,At=!1,Ht,we,xe,Me;for(;++Qe<=He;){const De=K[Qe];switch(De[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{De[0]==="enter"?dt++:dt--,Me=void 0;break}case"lineEndingBlank":{De[0]==="enter"&&(Ht&&!Me&&!dt&&!xe&&(xe=Qe),Me=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Me=void 0}if(!dt&&De[0]==="enter"&&De[1].type==="listItemPrefix"||dt===-1&&De[0]==="exit"&&(De[1].type==="listUnordered"||De[1].type==="listOrdered")){if(Ht){let qe=Qe;for(we=void 0;qe--;){const st=K[qe];if(st[1].type==="lineEnding"||st[1].type==="lineEndingBlank"){if(st[0]==="exit")continue;we&&(K[we][1].type="lineEndingBlank",At=!0),st[1].type="lineEnding",we=qe}else if(!(st[1].type==="linePrefix"||st[1].type==="blockQuotePrefix"||st[1].type==="blockQuotePrefixWhitespace"||st[1].type==="blockQuoteMarker"||st[1].type==="listItemIndent"))break}xe&&(!we||xe<we)&&(Ht._spread=!0),Ht.end=Object.assign({},we?K[we][1].start:De[1].end),K.splice(we||Qe,0,["exit",Ht,De[2]]),Qe++,He++}if(De[1].type==="listItemPrefix"){const qe={type:"listItem",_spread:!1,start:Object.assign({},De[1].start),end:void 0};Ht=qe,K.splice(Qe,0,["enter",qe,De[2]]),Qe++,He++,xe=void 0,Me=!0}}}return K[ge][1]._spread=At,He}function o(K,ge){return He;function He(Qe){d.call(this,K(Qe),Qe),ge&&ge.call(this,Qe)}}function l(){this.stack.push({type:"fragment",children:[]})}function d(K,ge,He){this.stack[this.stack.length-1].children.push(K),this.stack.push(K),this.tokenStack.push([ge,He||void 0]),K.position={start:su(ge.start),end:void 0}}function f(K){return ge;function ge(He){K&&K.call(this,He),u.call(this,He)}}function u(K,ge){const He=this.stack.pop(),Qe=this.tokenStack.pop();if(Qe)Qe[0].type!==K.type&&(ge?ge.call(this,K,Qe[0]):(Qe[1]||aj).call(this,K,Qe[0]));else throw new Error("Cannot close `"+K.type+"` ("+Hm({start:K.start,end:K.end})+"): its not open");He.position.end=su(K.end)}function p(){return Kw(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(K){if(this.data.expectingFirstListItemValue){const ge=this.stack[this.stack.length-2];ge.start=Number.parseInt(this.sliceSerialize(K),10),this.data.expectingFirstListItemValue=void 0}}function v(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.lang=K}function S(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.meta=K}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.value=K.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function A(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.value=K.replace(/(\r?\n|\r)$/g,"")}function M(K){const ge=this.resume(),He=this.stack[this.stack.length-1];He.label=ge,He.identifier=Eh(this.sliceSerialize(K)).toLowerCase()}function R(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.title=K}function z(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.url=K}function F(K){const ge=this.stack[this.stack.length-1];if(!ge.depth){const He=this.sliceSerialize(K).length;ge.depth=He}}function L(){this.data.setextHeadingSlurpLineEnding=!0}function U(K){const ge=this.stack[this.stack.length-1];ge.depth=this.sliceSerialize(K).codePointAt(0)===61?1:2}function B(){this.data.setextHeadingSlurpLineEnding=void 0}function J(K){const He=this.stack[this.stack.length-1].children;let Qe=He[He.length-1];(!Qe||Qe.type!=="text")&&(Qe=ke(),Qe.position={start:su(K.start),end:void 0},He.push(Qe)),this.stack.push(Qe)}function D(K){const ge=this.stack.pop();ge.value+=this.sliceSerialize(K),ge.position.end=su(K.end)}function $(K){const ge=this.stack[this.stack.length-1];if(this.data.atHardBreak){const He=ge.children[ge.children.length-1];He.position.end=su(K.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(ge.type)&&(J.call(this,K),D.call(this,K))}function H(){this.data.atHardBreak=!0}function te(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.value=K}function Q(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.value=K}function Y(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.value=K}function V(){const K=this.stack[this.stack.length-1];if(this.data.inReference){const ge=this.data.referenceType||"shortcut";K.type+="Reference",K.referenceType=ge,delete K.url,delete K.title}else delete K.identifier,delete K.label;this.data.referenceType=void 0}function ae(){const K=this.stack[this.stack.length-1];if(this.data.inReference){const ge=this.data.referenceType||"shortcut";K.type+="Reference",K.referenceType=ge,delete K.url,delete K.title}else delete K.identifier,delete K.label;this.data.referenceType=void 0}function re(K){const ge=this.sliceSerialize(K),He=this.stack[this.stack.length-2];He.label=OE(ge),He.identifier=Eh(ge).toLowerCase()}function le(){const K=this.stack[this.stack.length-1],ge=this.resume(),He=this.stack[this.stack.length-1];if(this.data.inReference=!0,He.type==="link"){const Qe=K.children;He.children=Qe}else He.alt=ge}function E(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.url=K}function ce(){const K=this.resume(),ge=this.stack[this.stack.length-1];ge.title=K}function ue(){this.data.inReference=void 0}function I(){this.data.referenceType="collapsed"}function de(K){const ge=this.resume(),He=this.stack[this.stack.length-1];He.label=ge,He.identifier=Eh(this.sliceSerialize(K)).toLowerCase(),this.data.referenceType="full"}function fe(K){this.data.characterReferenceType=K.type}function W(K){const ge=this.sliceSerialize(K),He=this.data.characterReferenceType;let Qe;He?(Qe=jE(ge,He==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Qe=Xw(ge);const dt=this.stack[this.stack.length-1];dt.value+=Qe}function oe(K){const ge=this.stack.pop();ge.position.end=su(K.end)}function se(K){D.call(this,K);const ge=this.stack[this.stack.length-1];ge.url=this.sliceSerialize(K)}function je(K){D.call(this,K);const ge=this.stack[this.stack.length-1];ge.url="mailto:"+this.sliceSerialize(K)}function We(){return{type:"blockquote",children:[]}}function X(){return{type:"code",lang:null,meta:null,value:""}}function Se(){return{type:"inlineCode",value:""}}function Ae(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Pe(){return{type:"emphasis",children:[]}}function Ze(){return{type:"heading",depth:0,children:[]}}function rt(){return{type:"break"}}function lt(){return{type:"html",value:""}}function ze(){return{type:"image",title:null,url:"",alt:null}}function ot(){return{type:"link",title:null,url:"",children:[]}}function at(K){return{type:"list",ordered:K.type==="listOrdered",start:null,spread:K._spread,children:[]}}function be(K){return{type:"listItem",spread:K._spread,checked:null,children:[]}}function $e(){return{type:"paragraph",children:[]}}function Be(){return{type:"strong",children:[]}}function ke(){return{type:"text",value:""}}function Ne(){return{type:"thematicBreak"}}}function su(e){return{line:e.line,column:e.column,offset:e.offset}}function FE(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?FE(e,r):PK(e,r)}}function PK(e,n){let t;for(t in n)if(LE.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function aj(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+Hm({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+Hm({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+Hm({start:n.start,end:n.end})+") is still open")}function DK(e){const n=this;n.parser=t;function t(r){return EK(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}const sj={}.hasOwnProperty;function $E(e,n){const t=n||{};function r(a,...o){let l=r.invalid;const d=r.handlers;if(a&&sj.call(a,e)){const f=String(a[e]);l=sj.call(d,f)?d[f]:r.unknown}if(l)return l.call(this,a,...o)}return r.handlers=t.handlers||{},r.invalid=t.invalid,r.unknown=t.unknown,r}const IK={}.hasOwnProperty;function zE(e,n){let t=-1,r;if(n.extensions)for(;++t<n.extensions.length;)zE(e,n.extensions[t]);for(r in n)if(IK.call(n,r))switch(r){case"extensions":break;case"unsafe":{oj(e[r],n[r]);break}case"join":{oj(e[r],n[r]);break}case"handlers":{RK(e[r],n[r]);break}default:e.options[r]=n[r]}return e}function oj(e,n){n&&e.push(...n)}function RK(e,n){n&&Object.assign(e,n)}function MK(e,n,t,r){const a=t.enter("blockquote"),o=t.createTracker(r);o.move("> "),o.shift(2);const l=t.indentLines(t.containerFlow(e,o.current()),OK);return a(),l}function OK(e,n,t){return">"+(t?"":" ")+e}function UE(e,n){return lj(e,n.inConstruct,!0)&&!lj(e,n.notInConstruct,!1)}function lj(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function cj(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&UE(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function LK(e,n){const t=String(e);let r=t.indexOf(n),a=r,o=0,l=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++o>l&&(l=o):o=1,a=r+n.length,r=t.indexOf(n,a);return l}function G1(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function FK(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function $K(e,n,t,r){const a=FK(t),o=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if(G1(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(o,zK);return g(),b}const d=t.createTracker(r),f=a.repeat(Math.max(LK(o,a)+1,3)),u=t.enter("codeFenced");let p=d.move(f);if(e.lang){const g=t.enter(`codeFencedLang${l}`);p+=d.move(t.safe(e.lang,{before:p,after:" ",encode:["`"],...d.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${l}`);p+=d.move(" "),p+=d.move(t.safe(e.meta,{before:p,after:`
`,encode:["`"],...d.current()})),g()}return p+=d.move(`
`),o&&(p+=d.move(o+`
`)),p+=d.move(f),u(),p}function zK(e,n,t){return(t?"":"    ")+e}function tS(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function UK(e,n,t,r){const a=tS(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("definition");let d=t.enter("label");const f=t.createTracker(r);let u=f.move("[");return u+=f.move(t.safe(t.associationId(e),{before:u,after:"]",...f.current()})),u+=f.move("]: "),d(),!e.url||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":`
`,...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),l(),u}function BK(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function fu(e){return"&#x"+e.toString(16).toUpperCase()+";"}function mb(e,n,t){const r=pb(e),a=pb(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}BE.peek=qK;function BE(e,n,t,r){const a=BK(t),o=t.enter("emphasis"),l=t.createTracker(r),d=l.move(a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),p=mb(r.before.charCodeAt(r.before.length-1),u,a);p.inside&&(f=fu(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=mb(r.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+fu(g));const v=l.move(a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:p.outside},d+f+v}function qK(e,n,t){return t.options.emphasis||"*"}const nS=function(e){if(e==null)return YK;if(typeof e=="function")return Gb(e);if(typeof e=="object")return Array.isArray(e)?VK(e):HK(e);if(typeof e=="string")return GK(e);throw new Error("Expected function, string, or object as test")};function VK(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=nS(e[t]);return Gb(r);function r(...a){let o=-1;for(;++o<n.length;)if(n[o].apply(this,a))return!0;return!1}}function HK(e){const n=e;return Gb(t);function t(r){const a=r;let o;for(o in e)if(a[o]!==n[o])return!1;return!0}}function GK(e){return Gb(n);function n(t){return t&&t.type===e}}function Gb(e){return n;function n(t,r,a){return!!(WK(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function YK(){return!0}function WK(e){return e!==null&&typeof e=="object"&&"type"in e}const qE=[],QK=!0,Y1=!1,JK="skip";function KK(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const o=nS(a),l=r?-1:1;d(e,void 0,[])();function d(f,u,p){const g=f&&typeof f=="object"?f:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(f.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=qE,S,k,T;if((!n||o(f,u,p[p.length-1]||void 0))&&(v=XK(t(f,p)),v[0]===Y1))return v;if("children"in f&&f.children){const A=f;if(A.children&&v[0]!==JK)for(k=(r?A.children.length:-1)+l,T=p.concat(A);k>-1&&k<A.children.length;){const M=A.children[k];if(S=d(M,k,T)(),S[0]===Y1)return S;k=typeof S[1]=="number"?S[1]:k+l}}return v}}}function XK(e){return Array.isArray(e)?e:typeof e=="number"?[QK,e]:e==null?qE:[e]}function VE(e,n,t,r){let a,o,l;typeof n=="function"?(o=void 0,l=n,a=t):(o=n,l=t,a=r),KK(e,o,d,a);function d(f,u){const p=u[u.length-1],g=p?p.children.indexOf(f):void 0;return l(f,g,p)}}function HE(e,n){let t=!1;return VE(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,Y1}),!!((!e.depth||e.depth<3)&&Kw(e)&&(n.options.setext||t))}function ZK(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),o=t.createTracker(r);if(HE(e,t)){const p=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...o.current(),before:`
`,after:`
`});return g(),p(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const l="#".repeat(a),d=t.enter("headingAtx"),f=t.enter("phrasing");o.move(l+" ");let u=t.containerPhrasing(e,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(u)&&(u=fu(u.charCodeAt(0))+u.slice(1)),u=u?l+" "+u:l,t.options.closeAtx&&(u+=" "+l),f(),d(),u}GE.peek=eX;function GE(e){return e.value||""}function eX(){return"<"}YE.peek=tX;function YE(e,n,t,r){const a=tS(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("image");let d=t.enter("label");const f=t.createTracker(r);let u=f.move("![");return u+=f.move(t.safe(e.alt,{before:u,after:"]",...f.current()})),u+=f.move("]("),d(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":")",...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),u+=f.move(")"),l(),u}function tX(){return"!"}WE.peek=nX;function WE(e,n,t,r){const a=e.referenceType,o=t.enter("imageReference");let l=t.enter("label");const d=t.createTracker(r);let f=d.move("![");const u=t.safe(e.alt,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const p=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=p,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function nX(){return"!"}QE.peek=rX;function QE(e,n,t){let r=e.value||"",a="`",o=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++o<t.unsafe.length;){const l=t.unsafe[o],d=t.compilePattern(l);let f;if(l.atBreak)for(;f=d.exec(r);){let u=f.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(f.index+1)}}return a+r+a}function rX(){return"`"}function JE(e,n){const t=Kw(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}KE.peek=iX;function KE(e,n,t,r){const a=tS(t),o=a==='"'?"Quote":"Apostrophe",l=t.createTracker(r);let d,f;if(JE(e,t)){const p=t.stack;t.stack=[],d=t.enter("autolink");let g=l.move("<");return g+=l.move(t.containerPhrasing(e,{before:g,after:">",...l.current()})),g+=l.move(">"),d(),t.stack=p,g}d=t.enter("link"),f=t.enter("label");let u=l.move("[");return u+=l.move(t.containerPhrasing(e,{before:u,after:"](",...l.current()})),u+=l.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(t.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(f=t.enter("destinationRaw"),u+=l.move(t.safe(e.url,{before:u,after:e.title?" ":")",...l.current()}))),f(),e.title&&(f=t.enter(`title${o}`),u+=l.move(" "+a),u+=l.move(t.safe(e.title,{before:u,after:a,...l.current()})),u+=l.move(a),f()),u+=l.move(")"),d(),u}function iX(e,n,t){return JE(e,t)?"<":"["}XE.peek=aX;function XE(e,n,t,r){const a=e.referenceType,o=t.enter("linkReference");let l=t.enter("label");const d=t.createTracker(r);let f=d.move("[");const u=t.containerPhrasing(e,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const p=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=p,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function aX(){return"["}function rS(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function sX(e){const n=rS(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function oX(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function ZE(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function lX(e,n,t,r){const a=t.enter("list"),o=t.bulletCurrent;let l=e.ordered?oX(t):rS(t);const d=e.ordered?l==="."?")":".":sX(t);let f=n&&t.bulletLastUsed?l===t.bulletLastUsed:!1;if(!e.ordered){const p=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&p&&(!p.children||!p.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(f=!0),ZE(t)===l&&p){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){f=!0;break}}}}f&&(l=d),t.bulletCurrent=l;const u=t.containerFlow(e,r);return t.bulletLastUsed=l,t.bulletCurrent=o,a(),u}function cX(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function uX(e,n,t,r){const a=cX(t);let o=t.bulletCurrent||rS(t);n&&n.type==="list"&&n.ordered&&(o=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+o);let l=o.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(l=Math.ceil(l/4)*4);const d=t.createTracker(r);d.move(o+" ".repeat(l-o.length)),d.shift(l);const f=t.enter("listItem"),u=t.indentLines(t.containerFlow(e,d.current()),p);return f(),u;function p(g,b,v){return b?(v?"":" ".repeat(l))+g:(v?o:o+" ".repeat(l-o.length))+g}}function dX(e,n,t,r){const a=t.enter("paragraph"),o=t.enter("phrasing"),l=t.containerPhrasing(e,r);return o(),a(),l}const fX=nS(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function hX(e,n,t,r){return(e.children.some(function(l){return fX(l)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function pX(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}eA.peek=mX;function eA(e,n,t,r){const a=pX(t),o=t.enter("strong"),l=t.createTracker(r),d=l.move(a+a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),p=mb(r.before.charCodeAt(r.before.length-1),u,a);p.inside&&(f=fu(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=mb(r.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+fu(g));const v=l.move(a+a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:p.outside},d+f+v}function mX(e,n,t){return t.options.strong||"*"}function gX(e,n,t,r){return t.safe(e.value,r)}function yX(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function xX(e,n,t){const r=(ZE(t)+(t.options.ruleSpaces?" ":"")).repeat(yX(t));return t.options.ruleSpaces?r.slice(0,-1):r}const bX={blockquote:MK,break:cj,code:$K,definition:UK,emphasis:BE,hardBreak:cj,heading:ZK,html:GE,image:YE,imageReference:WE,inlineCode:QE,link:KE,linkReference:XE,list:lX,listItem:uX,paragraph:dX,root:hX,strong:eA,text:gX,thematicBreak:xX},vX=[wX];function wX(e,n,t,r){if(n.type==="code"&&G1(n,r)&&(e.type==="list"||e.type===n.type&&G1(e,r)))return!1;if("spread"in t&&typeof t.spread=="boolean")return e.type==="paragraph"&&(e.type===n.type||n.type==="definition"||n.type==="heading"&&HE(n,r))?void 0:t.spread?1:0}const Ad=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],SX=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:Ad},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:Ad},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:Ad},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:Ad},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:Ad},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:Ad},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:Ad},{atBreak:!0,character:"~"}];function NX(e){return e.label||!e.identifier?e.label||"":OE(e.identifier)}function CX(e){if(!e._compiled){const n=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((n?"("+n+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function _X(e,n,t){const r=n.indexStack,a=e.children||[],o=[];let l=-1,d=t.before,f;r.push(-1);let u=n.createTracker(t);for(;++l<a.length;){const p=a[l];let g;if(r[r.length-1]=l,l+1<a.length){let S=n.handle.handlers[a[l+1].type];S&&S.peek&&(S=S.peek),g=S?S(a[l+1],e,n,{before:"",after:"",...u.current()}).charAt(0):""}else g=t.after;o.length>0&&(d==="\r"||d===`
`)&&p.type==="html"&&(o[o.length-1]=o[o.length-1].replace(/(\r?\n|\r)$/," "),d=" ",u=n.createTracker(t),u.move(o.join("")));let b=n.handle(p,e,n,{...u.current(),after:g,before:d});f&&f===b.slice(0,1)&&(b=fu(f.charCodeAt(0))+b.slice(1));const v=n.attentionEncodeSurroundingInfo;n.attentionEncodeSurroundingInfo=void 0,f=void 0,v&&(o.length>0&&v.before&&d===o[o.length-1].slice(-1)&&(o[o.length-1]=o[o.length-1].slice(0,-1)+fu(d.charCodeAt(0))),v.after&&(f=g)),u.move(b),o.push(b),d=b.slice(-1)}return r.pop(),o.join("")}function jX(e,n,t){const r=n.indexStack,a=e.children||[],o=n.createTracker(t),l=[];let d=-1;for(r.push(-1);++d<a.length;){const f=a[d];r[r.length-1]=d,l.push(o.move(n.handle(f,e,n,{before:`
`,after:`
`,...o.current()}))),f.type!=="list"&&(n.bulletLastUsed=void 0),d<a.length-1&&l.push(o.move(kX(f,a[d+1],e,n)))}return r.pop(),l.join("")}function kX(e,n,t,r){let a=r.join.length;for(;a--;){const o=r.join[a](e,n,t,r);if(o===!0||o===1)break;if(typeof o=="number")return`
`.repeat(1+o);if(o===!1)return`

<!---->

`}return`

`}const TX=/\r?\n|\r/g;function EX(e,n){const t=[];let r=0,a=0,o;for(;o=TX.exec(e);)l(e.slice(r,o.index)),t.push(o[0]),r=o.index+o[0].length,a++;return l(e.slice(r)),t.join("");function l(d){t.push(n(d,a,!d))}}function AX(e,n,t){const r=(t.before||"")+(n||"")+(t.after||""),a=[],o=[],l={};let d=-1;for(;++d<e.unsafe.length;){const p=e.unsafe[d];if(!UE(e.stack,p))continue;const g=e.compilePattern(p);let b;for(;b=g.exec(r);){const v="before"in p||!!p.atBreak,S="after"in p,k=b.index+(v?b[1].length:0);a.includes(k)?(l[k].before&&!v&&(l[k].before=!1),l[k].after&&!S&&(l[k].after=!1)):(a.push(k),l[k]={before:v,after:S})}}a.sort(PX);let f=t.before?t.before.length:0;const u=r.length-(t.after?t.after.length:0);for(d=-1;++d<a.length;){const p=a[d];p<f||p>=u||p+1<u&&a[d+1]===p+1&&l[p].after&&!l[p+1].before&&!l[p+1].after||a[d-1]===p-1&&l[p].before&&!l[p-1].before&&!l[p-1].after||(f!==p&&o.push(uj(r.slice(f,p),"\\")),f=p,/[!-/:-@[-`{-~]/.test(r.charAt(p))&&(!t.encode||!t.encode.includes(r.charAt(p)))?o.push("\\"):(o.push(fu(r.charCodeAt(p))),f++))}return o.push(uj(r.slice(f,u),t.after)),o.join("")}function PX(e,n){return e-n}function uj(e,n){const t=/\\(?=[!-/:-@[-`{-~])/g,r=[],a=[],o=e+n;let l=-1,d=0,f;for(;f=t.exec(o);)r.push(f.index);for(;++l<r.length;)d!==r[l]&&a.push(e.slice(d,r[l])),a.push("\\"),d=r[l];return a.push(e.slice(d)),a.join("")}function DX(e){const n=e||{},t=n.now||{};let r=n.lineShift||0,a=t.line||1,o=t.column||1;return{move:f,current:l,shift:d};function l(){return{now:{line:a,column:o},lineShift:r}}function d(u){r+=u}function f(u){const p=u||"",g=p.split(/\r?\n|\r/g),b=g[g.length-1];return a+=g.length-1,o=g.length===1?o+b.length:1+b.length+r,p}}function IX(e,n){const t=n||{},r={associationId:NX,containerPhrasing:LX,containerFlow:FX,createTracker:DX,compilePattern:CX,enter:o,handlers:{...bX},handle:void 0,indentLines:EX,indexStack:[],join:[...vX],options:{},safe:$X,stack:[],unsafe:[...SX]};zE(r,t),r.options.tightDefinitions&&r.join.push(OX),r.handle=$E("type",{invalid:RX,unknown:MX,handlers:r.handlers});let a=r.handle(e,void 0,r,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return a&&a.charCodeAt(a.length-1)!==10&&a.charCodeAt(a.length-1)!==13&&(a+=`
`),a;function o(l){return r.stack.push(l),d;function d(){r.stack.pop()}}}function RX(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function MX(e){const n=e;throw new Error("Cannot handle unknown node `"+n.type+"`")}function OX(e,n){if(e.type==="definition"&&e.type===n.type)return 0}function LX(e,n){return _X(e,this,n)}function FX(e,n){return jX(e,this,n)}function $X(e,n){return AX(this,e,n)}function zX(e){const n=this;n.compiler=t;function t(r){return IX(r,{...n.data("settings"),...e,extensions:n.data("toMarkdownExtensions")||[]})}}function dj(e){if(e)throw e}var F0,fj;function UX(){if(fj)return F0;fj=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(u){return typeof Array.isArray=="function"?Array.isArray(u):n.call(u)==="[object Array]"},o=function(u){if(!u||n.call(u)!=="[object Object]")return!1;var p=e.call(u,"constructor"),g=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!p&&!g)return!1;var b;for(b in u);return typeof b>"u"||e.call(u,b)},l=function(u,p){t&&p.name==="__proto__"?t(u,p.name,{enumerable:!0,configurable:!0,value:p.newValue,writable:!0}):u[p.name]=p.newValue},d=function(u,p){if(p==="__proto__")if(e.call(u,p)){if(r)return r(u,p).value}else return;return u[p]};return F0=function f(){var u,p,g,b,v,S,k=arguments[0],T=1,A=arguments.length,M=!1;for(typeof k=="boolean"&&(M=k,k=arguments[1]||{},T=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});T<A;++T)if(u=arguments[T],u!=null)for(p in u)g=d(k,p),b=d(u,p),k!==b&&(M&&b&&(o(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&o(g)?g:{},l(k,{name:p,newValue:f(M,S,b)})):typeof b<"u"&&l(k,{name:p,newValue:b}));return k},F0}var BX=UX();const $0=qd(BX);function W1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function qX(){const e=[],n={run:t,use:r};return n;function t(...a){let o=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);d(null,...a);function d(f,...u){const p=e[++o];let g=-1;if(f){l(f);return}for(;++g<a.length;)(u[g]===null||u[g]===void 0)&&(u[g]=a[g]);a=u,p?VX(p,d)(...u):l(null,...u)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function VX(e,n){let t;return r;function r(...l){const d=e.length>l.length;let f;d&&l.push(a);try{f=e.apply(this,l)}catch(u){const p=u;if(d&&t)throw p;return a(p)}d||(f&&f.then&&typeof f.then=="function"?f.then(o,a):f instanceof Error?a(f):o(f))}function a(l,...d){t||(t=!0,n(l,...d))}function o(l){a(null,l)}}class ga extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",o={},l=!1;if(t&&("line"in t&&"column"in t?o={place:t}:"start"in t&&"end"in t?o={place:t}:"type"in t?o={ancestors:[t],place:t.position}:o={...t}),typeof n=="string"?a=n:!o.cause&&n&&(l=!0,a=n.message,o.cause=n),!o.ruleId&&!o.source&&typeof r=="string"){const f=r.indexOf(":");f===-1?o.ruleId=r:(o.source=r.slice(0,f),o.ruleId=r.slice(f+1))}if(!o.place&&o.ancestors&&o.ancestors){const f=o.ancestors[o.ancestors.length-1];f&&(o.place=f.position)}const d=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=d?d.column:void 0,this.fatal=void 0,this.file="",this.message=a,this.line=d?d.line:void 0,this.name=Hm(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=l&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}ga.prototype.file="";ga.prototype.name="";ga.prototype.reason="";ga.prototype.message="";ga.prototype.stack="";ga.prototype.column=void 0;ga.prototype.line=void 0;ga.prototype.ancestors=void 0;ga.prototype.cause=void 0;ga.prototype.fatal=void 0;ga.prototype.place=void 0;ga.prototype.ruleId=void 0;ga.prototype.source=void 0;const Go={basename:HX,dirname:GX,extname:YX,join:WX,sep:"/"};function HX(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');pg(e);let t=0,r=-1,a=e.length,o;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else r<0&&(o=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let l=-1,d=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else l<0&&(o=!0,l=a+1),d>-1&&(e.codePointAt(a)===n.codePointAt(d--)?d<0&&(r=a):(d=-1,r=l));return t===r?r=l:r<0&&(r=e.length),e.slice(t,r)}function GX(e){if(pg(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function YX(e){pg(e);let n=e.length,t=-1,r=0,a=-1,o=0,l;for(;n--;){const d=e.codePointAt(n);if(d===47){if(l){r=n+1;break}continue}t<0&&(l=!0,t=n+1),d===46?a<0?a=n:o!==1&&(o=1):a>-1&&(o=-1)}return a<0||t<0||o===0||o===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function WX(...e){let n=-1,t;for(;++n<e.length;)pg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":QX(t)}function QX(e){pg(e);const n=e.codePointAt(0)===47;let t=JX(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function JX(e,n){let t="",r=0,a=-1,o=0,l=-1,d,f;for(;++l<=e.length;){if(l<e.length)d=e.codePointAt(l);else{if(d===47)break;d=47}if(d===47){if(!(a===l-1||o===1))if(a!==l-1&&o===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(f=t.lastIndexOf("/"),f!==t.length-1){f<0?(t="",r=0):(t=t.slice(0,f),r=t.length-1-t.lastIndexOf("/")),a=l,o=0;continue}}else if(t.length>0){t="",r=0,a=l,o=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,l):t=e.slice(a+1,l),r=l-a-1;a=l,o=0}else d===46&&o>-1?o++:o=-1}return t}function pg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const KX={cwd:XX};function XX(){return"/"}function Q1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function ZX(e){if(typeof e=="string")e=new URL(e);else if(!Q1(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return eZ(e)}function eZ(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const z0=["history","path","basename","stem","extname","dirname"];class tZ{constructor(n){let t;n?Q1(n)?t={path:n}:typeof n=="string"||nZ(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":KX.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<z0.length;){const o=z0[r];o in t&&t[o]!==void 0&&t[o]!==null&&(this[o]=o==="history"?[...t[o]]:t[o])}let a;for(a in t)z0.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?Go.basename(this.path):void 0}set basename(n){B0(n,"basename"),U0(n,"basename"),this.path=Go.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?Go.dirname(this.path):void 0}set dirname(n){hj(this.basename,"dirname"),this.path=Go.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?Go.extname(this.path):void 0}set extname(n){if(U0(n,"extname"),hj(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Go.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){Q1(n)&&(n=ZX(n)),B0(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?Go.basename(this.path,this.extname):void 0}set stem(n){B0(n,"stem"),U0(n,"stem"),this.path=Go.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new ga(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}}function U0(e,n){if(e&&e.includes(Go.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+Go.sep+"`")}function B0(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function hj(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function nZ(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const rZ=function(e){const r=this.constructor.prototype,a=r[e],o=function(){return a.apply(o,arguments)};return Object.setPrototypeOf(o,r),o},iZ={}.hasOwnProperty;class iS extends rZ{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=qX()}copy(){const n=new iS;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data($0(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(H0("data",this.frozen),this.namespace[n]=t,this):iZ.call(this.namespace,n)&&this.namespace[n]||void 0:n?(H0("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=Tx(n),r=this.parser||this.Parser;return q0("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),q0("process",this.parser||this.Parser),V0("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(o,l){const d=Tx(n),f=r.parse(d);r.run(f,d,function(p,g,b){if(p||!g||!b)return u(p);const v=g,S=r.stringify(v,b);oZ(S)?b.value=S:b.result=S,u(p,b)});function u(p,g){p||!g?l(p):o?o(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),q0("processSync",this.parser||this.Parser),V0("processSync",this.compiler||this.Compiler),this.process(n,a),mj("processSync","process",t),r;function a(o,l){t=!0,dj(o),r=l}}run(n,t,r){pj(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?o(void 0,r):new Promise(o);function o(l,d){const f=Tx(t);a.run(n,f,u);function u(p,g,b){const v=g||n;p?d(p):l?l(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,o),mj("runSync","run",r),a;function o(l,d){dj(l),a=d,r=!0}}stringify(n,t){this.freeze();const r=Tx(t),a=this.compiler||this.Compiler;return V0("stringify",a),pj(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(H0("use",this.frozen),n!=null)if(typeof n=="function")f(n,t);else if(typeof n=="object")Array.isArray(n)?d(n):l(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function o(u){if(typeof u=="function")f(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[p,...g]=u;f(p,g)}else l(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function l(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");d(u.plugins),u.settings&&(a.settings=$0(!0,a.settings,u.settings))}function d(u){let p=-1;if(u!=null)if(Array.isArray(u))for(;++p<u.length;){const g=u[p];o(g)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function f(u,p){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===u){b=g;break}if(b===-1)r.push([u,...p]);else if(p.length>0){let[v,...S]=p;const k=r[b][1];W1(k)&&W1(v)&&(v=$0(!0,k,v)),r[b]=[u,v,...S]}}}}const aZ=new iS().freeze();function q0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function V0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function H0(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function pj(e){if(!W1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function mj(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function Tx(e){return sZ(e)?e:new tZ(e)}function sZ(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function oZ(e){return typeof e=="string"||lZ(e)}function lZ(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const cZ=aZ().use(DK).use(zX).freeze(),tA=-1,Yb=0,Gm=1,gb=2,aS=3,sS=4,oS=5,lS=6,nA=7,rA=8,gj=typeof self=="object"?self:globalThis,uZ=(e,n)=>{const t=(a,o)=>(e.set(o,a),a),r=a=>{if(e.has(a))return e.get(a);const[o,l]=n[a];switch(o){case Yb:case tA:return t(l,a);case Gm:{const d=t([],a);for(const f of l)d.push(r(f));return d}case gb:{const d=t({},a);for(const[f,u]of l)d[r(f)]=r(u);return d}case aS:return t(new Date(l),a);case sS:{const{source:d,flags:f}=l;return t(new RegExp(d,f),a)}case oS:{const d=t(new Map,a);for(const[f,u]of l)d.set(r(f),r(u));return d}case lS:{const d=t(new Set,a);for(const f of l)d.add(r(f));return d}case nA:{const{name:d,message:f}=l;return t(new gj[d](f),a)}case rA:return t(BigInt(l),a);case"BigInt":return t(Object(BigInt(l)),a);case"ArrayBuffer":return t(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:d}=new Uint8Array(l);return t(new DataView(d),l)}}return t(new gj[o](l),a)};return r},yj=e=>uZ(new Map,e)(0),vh="",{toString:dZ}={},{keys:fZ}=Object,Lm=e=>{const n=typeof e;if(n!=="object"||!e)return[Yb,n];const t=dZ.call(e).slice(8,-1);switch(t){case"Array":return[Gm,vh];case"Object":return[gb,vh];case"Date":return[aS,vh];case"RegExp":return[sS,vh];case"Map":return[oS,vh];case"Set":return[lS,vh];case"DataView":return[Gm,t]}return t.includes("Array")?[Gm,t]:t.includes("Error")?[nA,t]:[gb,t]},Ex=([e,n])=>e===Yb&&(n==="function"||n==="symbol"),hZ=(e,n,t,r)=>{const a=(l,d)=>{const f=r.push(l)-1;return t.set(d,f),f},o=l=>{if(t.has(l))return t.get(l);let[d,f]=Lm(l);switch(d){case Yb:{let p=l;switch(f){case"bigint":d=rA,p=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+f);p=null;break;case"undefined":return a([tA],l)}return a([d,p],l)}case Gm:{if(f){let b=l;return f==="DataView"?b=new Uint8Array(l.buffer):f==="ArrayBuffer"&&(b=new Uint8Array(l)),a([f,[...b]],l)}const p=[],g=a([d,p],l);for(const b of l)p.push(o(b));return g}case gb:{if(f)switch(f){case"BigInt":return a([f,l.toString()],l);case"Boolean":case"Number":case"String":return a([f,l.valueOf()],l)}if(n&&"toJSON"in l)return o(l.toJSON());const p=[],g=a([d,p],l);for(const b of fZ(l))(e||!Ex(Lm(l[b])))&&p.push([o(b),o(l[b])]);return g}case aS:return a([d,l.toISOString()],l);case sS:{const{source:p,flags:g}=l;return a([d,{source:p,flags:g}],l)}case oS:{const p=[],g=a([d,p],l);for(const[b,v]of l)(e||!(Ex(Lm(b))||Ex(Lm(v))))&&p.push([o(b),o(v)]);return g}case lS:{const p=[],g=a([d,p],l);for(const b of l)(e||!Ex(Lm(b)))&&p.push(o(b));return g}}const{message:u}=l;return a([d,{name:f,message:u}],l)};return o},xj=(e,{json:n,lossy:t}={})=>{const r=[];return hZ(!(n||t),!!n,new Map,r)(e),r},rg=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?yj(xj(e,n)):structuredClone(e):(e,n)=>yj(xj(e,n)),iA=sA("end"),aA=sA("start");function sA(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function oA(e){const n=aA(e),t=iA(e);if(n&&t)return{start:n,end:t}}const Pd=["ariaDescribedBy","ariaLabel","ariaLabelledBy"],bj={ancestors:{tbody:["table"],td:["table"],th:["table"],thead:["table"],tfoot:["table"],tr:["table"]},attributes:{a:[...Pd,"dataFootnoteBackref","dataFootnoteRef",["className","data-footnote-backref"],"href"],blockquote:["cite"],code:[["className",/^language-./]],del:["cite"],div:["itemScope","itemType"],dl:[...Pd],h2:[["className","sr-only"]],img:[...Pd,"longDesc","src"],input:[["disabled",!0],["type","checkbox"]],ins:["cite"],li:[["className","task-list-item"]],ol:[...Pd,["className","contains-task-list"]],q:["cite"],section:["dataFootnotes",["className","footnotes"]],source:["srcSet"],summary:[...Pd],table:[...Pd],ul:[...Pd,["className","contains-task-list"]],"*":["abbr","accept","acceptCharset","accessKey","action","align","alt","axis","border","cellPadding","cellSpacing","char","charOff","charSet","checked","clear","colSpan","color","cols","compact","coords","dateTime","dir","encType","frame","hSpace","headers","height","hrefLang","htmlFor","id","isMap","itemProp","label","lang","maxLength","media","method","multiple","name","noHref","noShade","noWrap","open","prompt","readOnly","rev","rowSpan","rows","rules","scope","selected","shape","size","span","start","summary","tabIndex","title","useMap","vAlign","value","width"]},clobber:["ariaDescribedBy","ariaLabelledBy","id","name"],clobberPrefix:"user-content-",protocols:{cite:["http","https"],href:["http","https","irc","ircs","mailto","xmpp"],longDesc:["http","https"],src:["http","https"]},required:{input:{disabled:!0,type:"checkbox"}},strip:["script"],tagNames:["a","b","blockquote","br","code","dd","del","details","div","dl","dt","em","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","li","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","tr","tt","ul","var"]},ou={}.hasOwnProperty;function pZ(e,n){let t={type:"root",children:[]};const r={schema:n?{...bj,...n}:bj,stack:[]},a=lA(r,e);return a&&(Array.isArray(a)?a.length===1?t=a[0]:t.children=a:t=a),t}function lA(e,n){if(n&&typeof n=="object"){const t=n;switch(typeof t.type=="string"?t.type:""){case"comment":return mZ(e,t);case"doctype":return gZ(e,t);case"element":return yZ(e,t);case"root":return xZ(e,t);case"text":return bZ(e,t)}}}function mZ(e,n){if(e.schema.allowComments){const t=typeof n.value=="string"?n.value:"",r=t.indexOf("-->"),o={type:"comment",value:r<0?t:t.slice(0,r)};return mg(o,n),o}}function gZ(e,n){if(e.schema.allowDoctypes){const t={type:"doctype"};return mg(t,n),t}}function yZ(e,n){const t=typeof n.tagName=="string"?n.tagName:"";e.stack.push(t);const r=cA(e,n.children),a=vZ(e,n.properties);e.stack.pop();let o=!1;if(t&&t!=="*"&&(!e.schema.tagNames||e.schema.tagNames.includes(t))&&(o=!0,e.schema.ancestors&&ou.call(e.schema.ancestors,t))){const d=e.schema.ancestors[t];let f=-1;for(o=!1;++f<d.length;)e.stack.includes(d[f])&&(o=!0)}if(!o)return e.schema.strip&&!e.schema.strip.includes(t)?r:void 0;const l={type:"element",tagName:t,properties:a,children:r};return mg(l,n),l}function xZ(e,n){const r={type:"root",children:cA(e,n.children)};return mg(r,n),r}function bZ(e,n){const r={type:"text",value:typeof n.value=="string"?n.value:""};return mg(r,n),r}function cA(e,n){const t=[];if(Array.isArray(n)){const r=n;let a=-1;for(;++a<r.length;){const o=lA(e,r[a]);o&&(Array.isArray(o)?t.push(...o):t.push(o))}}return t}function vZ(e,n){const t=e.stack[e.stack.length-1],r=e.schema.attributes,a=e.schema.required,o=r&&ou.call(r,t)?r[t]:void 0,l=r&&ou.call(r,"*")?r["*"]:void 0,d=n&&typeof n=="object"?n:{},f={};let u;for(u in d)if(ou.call(d,u)){const p=d[u];let g=vj(e,wj(o,u),u,p);g==null&&(g=vj(e,wj(l,u),u,p)),g!=null&&(f[u]=g)}if(a&&ou.call(a,t)){const p=a[t];for(u in p)ou.call(p,u)&&!ou.call(f,u)&&(f[u]=p[u])}return f}function vj(e,n,t,r){return n?Array.isArray(r)?wZ(e,n,t,r):uA(e,n,t,r):void 0}function wZ(e,n,t,r){let a=-1;const o=[];for(;++a<r.length;){const l=uA(e,n,t,r[a]);(typeof l=="number"||typeof l=="string")&&o.push(l)}return o}function uA(e,n,t,r){if(!(typeof r!="boolean"&&typeof r!="number"&&typeof r!="string")&&SZ(e,t,r)){if(typeof n=="object"&&n.length>1){let a=!1,o=0;for(;++o<n.length;){const l=n[o];if(l&&typeof l=="object"&&"flags"in l){if(l.test(String(r))){a=!0;break}}else if(l===r){a=!0;break}}if(!a)return}return e.schema.clobber&&e.schema.clobberPrefix&&e.schema.clobber.includes(t)?e.schema.clobberPrefix+r:r}}function SZ(e,n,t){const r=e.schema.protocols&&ou.call(e.schema.protocols,n)?e.schema.protocols[n]:void 0;if(!r||r.length===0)return!0;const a=String(t),o=a.indexOf(":"),l=a.indexOf("?"),d=a.indexOf("#"),f=a.indexOf("/");if(o<0||f>-1&&o>f||l>-1&&o>l||d>-1&&o>d)return!0;let u=-1;for(;++u<r.length;){const p=r[u];if(o===p.length&&a.slice(0,p.length)===p)return!0}return!1}function mg(e,n){const t=oA(n);n.data&&(e.data=rg(n.data)),t&&(e.position=t)}function wj(e,n){let t,r=-1;if(e)for(;++r<e.length;){const a=e[r],o=typeof a=="string"?a:a[0];if(o===n)return a;o==="data*"&&(t=a)}if(n.length>4&&n.slice(0,4).toLowerCase()==="data")return t}function NZ(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function CZ(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function _Z(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function jZ(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function kZ(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function TZ(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=Wh(r.toLowerCase()),o=e.footnoteOrder.indexOf(r);let l,d=e.footnoteCounts.get(r);d===void 0?(d=0,e.footnoteOrder.push(r),l=e.footnoteOrder.length):l=o+1,d+=1,e.footnoteCounts.set(r,d);const f={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(d>1?"-"+d:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(n,f);const u={type:"element",tagName:"sup",properties:{},children:[f]};return e.patch(n,u),e.applyData(n,u)}function EZ(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function AZ(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function dA(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),o=a[0];o&&o.type==="text"?o.value="["+o.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=r:a.push({type:"text",value:r}),a}function PZ(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return dA(e,n);const a={src:Wh(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,o),e.applyData(n,o)}function DZ(e,n){const t={src:Wh(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function IZ(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function RZ(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return dA(e,n);const a={href:Wh(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,o),e.applyData(n,o)}function MZ(e,n){const t={href:Wh(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function OZ(e,n,t){const r=e.all(n),a=t?LZ(t):fA(n),o={},l=[];if(typeof n.checked=="boolean"){const p=r[0];let g;p&&p.type==="element"&&p.tagName==="p"?g=p:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let d=-1;for(;++d<r.length;){const p=r[d];(a||d!==0||p.type!=="element"||p.tagName!=="p")&&l.push({type:"text",value:`
`}),p.type==="element"&&p.tagName==="p"&&!a?l.push(...p.children):l.push(p)}const f=r[r.length-1];f&&(a||f.type!=="element"||f.tagName!=="p")&&l.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:o,children:l};return e.patch(n,u),e.applyData(n,u)}function LZ(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=fA(t[r])}return n}function fA(e){const n=e.spread;return n??e.children.length>1}function FZ(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const l=r[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const o={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,o),e.applyData(n,o)}function $Z(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function zZ(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function UZ(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function BZ(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],l),a.push(l)}if(t.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},d=aA(n.children[1]),f=iA(n.children[n.children.length-1]);d&&f&&(l.position={start:d,end:f}),a.push(l)}const o={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,o),e.applyData(n,o)}function qZ(e,n,t){const r=t?t.children:void 0,o=(r?r.indexOf(n):1)===0?"th":"td",l=t&&t.type==="table"?t.align:void 0,d=l?l.length:n.children.length;let f=-1;const u=[];for(;++f<d;){const g=n.children[f],b={},v=l?l[f]:void 0;v&&(b.align=v);let S={type:"element",tagName:o,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),u.push(S)}const p={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(n,p),e.applyData(n,p)}function VZ(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const Sj=9,Nj=32;function HZ(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const o=[];for(;r;)o.push(Cj(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return o.push(Cj(n.slice(a),a>0,!1)),o.join("")}function Cj(e,n,t){let r=0,a=e.length;if(n){let o=e.codePointAt(r);for(;o===Sj||o===Nj;)r++,o=e.codePointAt(r)}if(t){let o=e.codePointAt(a-1);for(;o===Sj||o===Nj;)a--,o=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function GZ(e,n){const t={type:"text",value:HZ(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function YZ(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const WZ={blockquote:NZ,break:CZ,code:_Z,delete:jZ,emphasis:kZ,footnoteReference:TZ,heading:EZ,html:AZ,imageReference:PZ,image:DZ,inlineCode:IZ,linkReference:RZ,link:MZ,listItem:OZ,list:FZ,paragraph:$Z,root:zZ,strong:UZ,table:BZ,tableCell:VZ,tableRow:qZ,text:GZ,thematicBreak:YZ,toml:Ax,yaml:Ax,definition:Ax,footnoteDefinition:Ax};function Ax(){}function QZ(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function JZ(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function KZ(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||QZ,r=e.options.footnoteBackLabel||JZ,a=e.options.footnoteLabel||"Footnotes",o=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},d=[];let f=-1;for(;++f<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[f]);if(!u)continue;const p=e.all(u),g=String(u.identifier).toUpperCase(),b=Wh(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let M=typeof t=="string"?t:t(f,v);typeof M=="string"&&(M={type:"text",value:M}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(f,v),className:["data-footnote-backref"]},children:Array.isArray(M)?M:[M]})}const T=p[p.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const M=T.children[T.children.length-1];M&&M.type==="text"?M.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...S)}else p.push(...S);const A={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(p,!0)};e.patch(u,A),d.push(A)}if(d.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...rg(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(d,!0)},{type:"text",value:`
`}]}}const J1={}.hasOwnProperty,XZ={};function ZZ(e,n){const t=n||XZ,r=new Map,a=new Map,o=new Map,l={...WZ,...t.handlers},d={all:u,applyData:tee,definitionById:r,footnoteById:a,footnoteCounts:o,footnoteOrder:[],handlers:l,one:f,options:t,patch:eee,wrap:ree};return VE(e,function(p){if(p.type==="definition"||p.type==="footnoteDefinition"){const g=p.type==="definition"?r:a,b=String(p.identifier).toUpperCase();g.has(b)||g.set(b,p)}}),d;function f(p,g){const b=p.type,v=d.handlers[b];if(J1.call(d.handlers,b)&&v)return v(d,p,g);if(d.options.passThrough&&d.options.passThrough.includes(b)){if("children"in p){const{children:k,...T}=p,A=rg(T);return A.children=d.all(p),A}return rg(p)}return(d.options.unknownHandler||nee)(d,p,g)}function u(p){const g=[];if("children"in p){const b=p.children;let v=-1;for(;++v<b.length;){const S=d.one(b[v],p);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=_j(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=_j(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function eee(e,n){e.position&&(n.position=oA(e))}function tee(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,o=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const l="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:l}}t.type==="element"&&o&&Object.assign(t.properties,rg(o)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function nee(e,n){const t=n.data||{},r="value"in n&&!(J1.call(t,"hProperties")||J1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function ree(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function _j(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function iee(e,n){const t=ZZ(e,n),r=t.one(e,void 0),a=KZ(t),o=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&o.children.push({type:"text",value:`
`},a),o}const aee=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"];class gg{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}}gg.prototype.normal={};gg.prototype.property={};gg.prototype.space=void 0;function hA(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new gg(t,r,n)}function K1(e){return e.toLowerCase()}class ya{constructor(n,t){this.attribute=t,this.property=n}}ya.prototype.attribute="";ya.prototype.booleanish=!1;ya.prototype.boolean=!1;ya.prototype.commaOrSpaceSeparated=!1;ya.prototype.commaSeparated=!1;ya.prototype.defined=!1;ya.prototype.mustUseProperty=!1;ya.prototype.number=!1;ya.prototype.overloadedBoolean=!1;ya.prototype.property="";ya.prototype.spaceSeparated=!1;ya.prototype.space=void 0;let see=0;const Zt=Gd(),Lr=Gd(),X1=Gd(),ut=Gd(),sr=Gd(),Ah=Gd(),Ia=Gd();function Gd(){return 2**++see}const Z1=Object.freeze(Object.defineProperty({__proto__:null,boolean:Zt,booleanish:Lr,commaOrSpaceSeparated:Ia,commaSeparated:Ah,number:ut,overloadedBoolean:X1,spaceSeparated:sr},Symbol.toStringTag,{value:"Module"})),G0=Object.keys(Z1);class cS extends ya{constructor(n,t,r,a){let o=-1;if(super(n,t),jj(this,"space",a),typeof r=="number")for(;++o<G0.length;){const l=G0[o];jj(this,G0[o],(r&Z1[l])===Z1[l])}}}cS.prototype.defined=!0;function jj(e,n,t){t&&(e[n]=t)}function Qh(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const o=new cS(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(o.mustUseProperty=!0),n[r]=o,t[K1(r)]=r,t[K1(o.attribute)]=r}return new gg(n,t,e.space)}const pA=Qh({properties:{ariaActiveDescendant:null,ariaAtomic:Lr,ariaAutoComplete:null,ariaBusy:Lr,ariaChecked:Lr,ariaColCount:ut,ariaColIndex:ut,ariaColSpan:ut,ariaControls:sr,ariaCurrent:null,ariaDescribedBy:sr,ariaDetails:null,ariaDisabled:Lr,ariaDropEffect:sr,ariaErrorMessage:null,ariaExpanded:Lr,ariaFlowTo:sr,ariaGrabbed:Lr,ariaHasPopup:null,ariaHidden:Lr,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:sr,ariaLevel:ut,ariaLive:null,ariaModal:Lr,ariaMultiLine:Lr,ariaMultiSelectable:Lr,ariaOrientation:null,ariaOwns:sr,ariaPlaceholder:null,ariaPosInSet:ut,ariaPressed:Lr,ariaReadOnly:Lr,ariaRelevant:null,ariaRequired:Lr,ariaRoleDescription:sr,ariaRowCount:ut,ariaRowIndex:ut,ariaRowSpan:ut,ariaSelected:Lr,ariaSetSize:ut,ariaSort:null,ariaValueMax:ut,ariaValueMin:ut,ariaValueNow:ut,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function mA(e,n){return n in e?e[n]:n}function gA(e,n){return mA(e,n.toLowerCase())}const oee=Qh({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Ah,acceptCharset:sr,accessKey:sr,action:null,allow:null,allowFullScreen:Zt,allowPaymentRequest:Zt,allowUserMedia:Zt,alt:null,as:null,async:Zt,autoCapitalize:null,autoComplete:sr,autoFocus:Zt,autoPlay:Zt,blocking:sr,capture:null,charSet:null,checked:Zt,cite:null,className:sr,cols:ut,colSpan:null,content:null,contentEditable:Lr,controls:Zt,controlsList:sr,coords:ut|Ah,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Zt,defer:Zt,dir:null,dirName:null,disabled:Zt,download:X1,draggable:Lr,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Zt,formTarget:null,headers:sr,height:ut,hidden:X1,high:ut,href:null,hrefLang:null,htmlFor:sr,httpEquiv:sr,id:null,imageSizes:null,imageSrcSet:null,inert:Zt,inputMode:null,integrity:null,is:null,isMap:Zt,itemId:null,itemProp:sr,itemRef:sr,itemScope:Zt,itemType:sr,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Zt,low:ut,manifest:null,max:null,maxLength:ut,media:null,method:null,min:null,minLength:ut,multiple:Zt,muted:Zt,name:null,nonce:null,noModule:Zt,noValidate:Zt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Zt,optimum:ut,pattern:null,ping:sr,placeholder:null,playsInline:Zt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Zt,referrerPolicy:null,rel:sr,required:Zt,reversed:Zt,rows:ut,rowSpan:ut,sandbox:sr,scope:null,scoped:Zt,seamless:Zt,selected:Zt,shadowRootClonable:Zt,shadowRootDelegatesFocus:Zt,shadowRootMode:null,shape:null,size:ut,sizes:null,slot:null,span:ut,spellCheck:Lr,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ut,step:null,style:null,tabIndex:ut,target:null,title:null,translate:null,type:null,typeMustMatch:Zt,useMap:null,value:Lr,width:ut,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:sr,axis:null,background:null,bgColor:null,border:ut,borderColor:null,bottomMargin:ut,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Zt,declare:Zt,event:null,face:null,frame:null,frameBorder:null,hSpace:ut,leftMargin:ut,link:null,longDesc:null,lowSrc:null,marginHeight:ut,marginWidth:ut,noResize:Zt,noHref:Zt,noShade:Zt,noWrap:Zt,object:null,profile:null,prompt:null,rev:null,rightMargin:ut,rules:null,scheme:null,scrolling:Lr,standby:null,summary:null,text:null,topMargin:ut,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ut,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Zt,disableRemotePlayback:Zt,prefix:null,property:null,results:ut,security:null,unselectable:null},space:"html",transform:gA}),lee=Qh({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ia,accentHeight:ut,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ut,amplitude:ut,arabicForm:null,ascent:ut,attributeName:null,attributeType:null,azimuth:ut,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ut,by:null,calcMode:null,capHeight:ut,className:sr,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ut,diffuseConstant:ut,direction:null,display:null,dur:null,divisor:ut,dominantBaseline:null,download:Zt,dx:null,dy:null,edgeMode:null,editable:null,elevation:ut,enableBackground:null,end:null,event:null,exponent:ut,externalResourcesRequired:null,fill:null,fillOpacity:ut,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Ah,g2:Ah,glyphName:Ah,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ut,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ut,horizOriginX:ut,horizOriginY:ut,id:null,ideographic:ut,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ut,k:ut,k1:ut,k2:ut,k3:ut,k4:ut,kernelMatrix:Ia,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ut,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ut,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ut,overlineThickness:ut,paintOrder:null,panose1:null,path:null,pathLength:ut,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:sr,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ut,pointsAtY:ut,pointsAtZ:ut,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ia,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ia,rev:Ia,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ia,requiredFeatures:Ia,requiredFonts:Ia,requiredFormats:Ia,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ut,specularExponent:ut,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ut,strikethroughThickness:ut,string:null,stroke:null,strokeDashArray:Ia,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ut,strokeOpacity:ut,strokeWidth:null,style:null,surfaceScale:ut,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ia,tabIndex:ut,tableValues:null,target:null,targetX:ut,targetY:ut,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ia,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ut,underlineThickness:ut,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ut,values:null,vAlphabetic:ut,vMathematical:ut,vectorEffect:null,vHanging:ut,vIdeographic:ut,version:null,vertAdvY:ut,vertOriginX:ut,vertOriginY:ut,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ut,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:mA}),yA=Qh({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),xA=Qh({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:gA}),bA=Qh({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),cee=/[A-Z]/g,kj=/-[a-z]/g,uee=/^data[-\w.:]+$/i;function dee(e,n){const t=K1(n);let r=n,a=ya;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&uee.test(n)){if(n.charAt(4)==="-"){const o=n.slice(5).replace(kj,hee);r="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=n.slice(4);if(!kj.test(o)){let l=o.replace(cee,fee);l.charAt(0)!=="-"&&(l="-"+l),n="data"+l}}a=cS}return new a(r,n)}function fee(e){return"-"+e.toLowerCase()}function hee(e){return e.charAt(1).toUpperCase()}const pee=hA([pA,oee,yA,xA,bA],"html"),vA=hA([pA,lee,yA,xA,bA],"svg"),mee=/["&'<>`]/g,gee=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,yee=/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,xee=/[|\\{}()[\]^$+*?.]/g,Tj=new WeakMap;function bee(e,n){if(e=e.replace(n.subset?vee(n.subset):mee,r),n.subset||n.escapeOnly)return e;return e.replace(gee,t).replace(yee,r);function t(a,o,l){return n.format((a.charCodeAt(0)-55296)*1024+a.charCodeAt(1)-56320+65536,l.charCodeAt(o+2),n)}function r(a,o,l){return n.format(a.charCodeAt(0),l.charCodeAt(o+1),n)}}function vee(e){let n=Tj.get(e);return n||(n=wee(e),Tj.set(e,n)),n}function wee(e){const n=[];let t=-1;for(;++t<e.length;)n.push(e[t].replace(xee,"\\$&"));return new RegExp("(?:"+n.join("|")+")","g")}const See=/[\dA-Fa-f]/;function Nee(e,n,t){const r="&#x"+e.toString(16).toUpperCase();return t&&n&&!See.test(String.fromCharCode(n))?r:r+";"}const Cee=/\d/;function _ee(e,n,t){const r="&#"+String(e);return t&&n&&!Cee.test(String.fromCharCode(n))?r:r+";"}const jee=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],Y0={nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",fnof:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",bull:"",hellip:"",prime:"",Prime:"",oline:"",frasl:"",weierp:"",image:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",quot:'"',amp:"&",lt:"<",gt:">",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",permil:"",lsaquo:"",rsaquo:"",euro:""},kee=["cent","copy","divide","gt","lt","not","para","times"],wA={}.hasOwnProperty,ew={};let Px;for(Px in Y0)wA.call(Y0,Px)&&(ew[Y0[Px]]=Px);const Tee=/[^\dA-Za-z]/;function Eee(e,n,t,r){const a=String.fromCharCode(e);if(wA.call(ew,a)){const o=ew[a],l="&"+o;return t&&jee.includes(o)&&!kee.includes(o)&&(!r||n&&n!==61&&Tee.test(String.fromCharCode(n)))?l:l+";"}return""}function Aee(e,n,t){let r=Nee(e,n,t.omitOptionalSemicolons),a;if((t.useNamedReferences||t.useShortestReferences)&&(a=Eee(e,n,t.omitOptionalSemicolons,t.attribute)),(t.useShortestReferences||!a)&&t.useShortestReferences){const o=_ee(e,n,t.omitOptionalSemicolons);o.length<r.length&&(r=o)}return a&&(!t.useShortestReferences||a.length<r.length)?a:r}function Ph(e,n){return bee(e,Object.assign({format:Aee},n))}const Pee=/^>|^->|<!--|-->|--!>|<!-$/g,Dee=[">"],Iee=["<",">"];function Ree(e,n,t,r){return r.settings.bogusComments?"<?"+Ph(e.value,Object.assign({},r.settings.characterReferences,{subset:Dee}))+">":"<!--"+e.value.replace(Pee,a)+"-->";function a(o){return Ph(o,Object.assign({},r.settings.characterReferences,{subset:Iee}))}}function Mee(e,n,t,r){return"<!"+(r.settings.upperDoctype?"DOCTYPE":"doctype")+(r.settings.tightDoctype?"":" ")+"html>"}function Ej(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function Oee(e,n){const t=n||{};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}function Lee(e){return e.join(" ").trim()}const Fee=/[ \t\n\f\r]/g;function uS(e){return typeof e=="object"?e.type==="text"?Aj(e.value):!1:Aj(e)}function Aj(e){return e.replace(Fee,"")===""}const qr=NA(1),SA=NA(-1),$ee=[];function NA(e){return n;function n(t,r,a){const o=t?t.children:$ee;let l=(r||0)+e,d=o[l];if(!a)for(;d&&uS(d);)l+=e,d=o[l];return d}}const zee={}.hasOwnProperty;function CA(e){return n;function n(t,r,a){return zee.call(e,t.tagName)&&e[t.tagName](t,r,a)}}const dS=CA({body:Bee,caption:W0,colgroup:W0,dd:Gee,dt:Hee,head:W0,html:Uee,li:Vee,optgroup:Yee,option:Wee,p:qee,rp:Pj,rt:Pj,tbody:Jee,td:Dj,tfoot:Kee,th:Dj,thead:Qee,tr:Xee});function W0(e,n,t){const r=qr(t,n,!0);return!r||r.type!=="comment"&&!(r.type==="text"&&uS(r.value.charAt(0)))}function Uee(e,n,t){const r=qr(t,n);return!r||r.type!=="comment"}function Bee(e,n,t){const r=qr(t,n);return!r||r.type!=="comment"}function qee(e,n,t){const r=qr(t,n);return r?r.type==="element"&&(r.tagName==="address"||r.tagName==="article"||r.tagName==="aside"||r.tagName==="blockquote"||r.tagName==="details"||r.tagName==="div"||r.tagName==="dl"||r.tagName==="fieldset"||r.tagName==="figcaption"||r.tagName==="figure"||r.tagName==="footer"||r.tagName==="form"||r.tagName==="h1"||r.tagName==="h2"||r.tagName==="h3"||r.tagName==="h4"||r.tagName==="h5"||r.tagName==="h6"||r.tagName==="header"||r.tagName==="hgroup"||r.tagName==="hr"||r.tagName==="main"||r.tagName==="menu"||r.tagName==="nav"||r.tagName==="ol"||r.tagName==="p"||r.tagName==="pre"||r.tagName==="section"||r.tagName==="table"||r.tagName==="ul"):!t||!(t.type==="element"&&(t.tagName==="a"||t.tagName==="audio"||t.tagName==="del"||t.tagName==="ins"||t.tagName==="map"||t.tagName==="noscript"||t.tagName==="video"))}function Vee(e,n,t){const r=qr(t,n);return!r||r.type==="element"&&r.tagName==="li"}function Hee(e,n,t){const r=qr(t,n);return!!(r&&r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd"))}function Gee(e,n,t){const r=qr(t,n);return!r||r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd")}function Pj(e,n,t){const r=qr(t,n);return!r||r.type==="element"&&(r.tagName==="rp"||r.tagName==="rt")}function Yee(e,n,t){const r=qr(t,n);return!r||r.type==="element"&&r.tagName==="optgroup"}function Wee(e,n,t){const r=qr(t,n);return!r||r.type==="element"&&(r.tagName==="option"||r.tagName==="optgroup")}function Qee(e,n,t){const r=qr(t,n);return!!(r&&r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot"))}function Jee(e,n,t){const r=qr(t,n);return!r||r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot")}function Kee(e,n,t){return!qr(t,n)}function Xee(e,n,t){const r=qr(t,n);return!r||r.type==="element"&&r.tagName==="tr"}function Dj(e,n,t){const r=qr(t,n);return!r||r.type==="element"&&(r.tagName==="td"||r.tagName==="th")}const Zee=CA({body:nte,colgroup:rte,head:tte,html:ete,tbody:ite});function ete(e){const n=qr(e,-1);return!n||n.type!=="comment"}function tte(e){const n=new Set;for(const r of e.children)if(r.type==="element"&&(r.tagName==="base"||r.tagName==="title")){if(n.has(r.tagName))return!1;n.add(r.tagName)}const t=e.children[0];return!t||t.type==="element"}function nte(e){const n=qr(e,-1,!0);return!n||n.type!=="comment"&&!(n.type==="text"&&uS(n.value.charAt(0)))&&!(n.type==="element"&&(n.tagName==="meta"||n.tagName==="link"||n.tagName==="script"||n.tagName==="style"||n.tagName==="template"))}function rte(e,n,t){const r=SA(t,n),a=qr(e,-1,!0);return t&&r&&r.type==="element"&&r.tagName==="colgroup"&&dS(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="col")}function ite(e,n,t){const r=SA(t,n),a=qr(e,-1);return t&&r&&r.type==="element"&&(r.tagName==="thead"||r.tagName==="tbody")&&dS(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="tr")}const Dx={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function ate(e,n,t,r){const a=r.schema,o=a.space==="svg"?!1:r.settings.omitOptionalTags;let l=a.space==="svg"?r.settings.closeEmptyElements:r.settings.voids.includes(e.tagName.toLowerCase());const d=[];let f;a.space==="html"&&e.tagName==="svg"&&(r.schema=vA);const u=ste(r,e.properties),p=r.all(a.space==="html"&&e.tagName==="template"?e.content:e);return r.schema=a,p&&(l=!1),(u||!o||!Zee(e,n,t))&&(d.push("<",e.tagName,u?" "+u:""),l&&(a.space==="svg"||r.settings.closeSelfClosing)&&(f=u.charAt(u.length-1),(!r.settings.tightSelfClosing||f==="/"||f&&f!=='"'&&f!=="'")&&d.push(" "),d.push("/")),d.push(">")),d.push(p),!l&&(!o||!dS(e,n,t))&&d.push("</"+e.tagName+">"),d.join("")}function ste(e,n){const t=[];let r=-1,a;if(n){for(a in n)if(n[a]!==null&&n[a]!==void 0){const o=ote(e,a,n[a]);o&&t.push(o)}}for(;++r<t.length;){const o=e.settings.tightAttributes?t[r].charAt(t[r].length-1):void 0;r!==t.length-1&&o!=='"'&&o!=="'"&&(t[r]+=" ")}return t.join("")}function ote(e,n,t){const r=dee(e.schema,n),a=e.settings.allowParseErrors&&e.schema.space==="html"?0:1,o=e.settings.allowDangerousCharacters?0:1;let l=e.quote,d;if(r.overloadedBoolean&&(t===r.attribute||t==="")?t=!0:(r.boolean||r.overloadedBoolean)&&(typeof t!="string"||t===r.attribute||t==="")&&(t=!!t),t==null||t===!1||typeof t=="number"&&Number.isNaN(t))return"";const f=Ph(r.attribute,Object.assign({},e.settings.characterReferences,{subset:Dx.name[a][o]}));return t===!0||(t=Array.isArray(t)?(r.commaSeparated?Oee:Lee)(t,{padLeft:!e.settings.tightCommaSeparatedLists}):String(t),e.settings.collapseEmptyAttributes&&!t)?f:(e.settings.preferUnquoted&&(d=Ph(t,Object.assign({},e.settings.characterReferences,{attribute:!0,subset:Dx.unquoted[a][o]}))),d!==t&&(e.settings.quoteSmart&&Ej(t,l)>Ej(t,e.alternative)&&(l=e.alternative),d=l+Ph(t,Object.assign({},e.settings.characterReferences,{subset:(l==="'"?Dx.single:Dx.double)[a][o],attribute:!0}))+l),f+(d&&"="+d))}const lte=["<","&"];function _A(e,n,t,r){return t&&t.type==="element"&&(t.tagName==="script"||t.tagName==="style")?e.value:Ph(e.value,Object.assign({},r.settings.characterReferences,{subset:lte}))}function cte(e,n,t,r){return r.settings.allowDangerousHtml?e.value:_A(e,n,t,r)}function ute(e,n,t,r){return r.all(e)}const dte=$E("type",{invalid:fte,unknown:hte,handlers:{comment:Ree,doctype:Mee,element:ate,raw:cte,root:ute,text:_A}});function fte(e){throw new Error("Expected node, not `"+e+"`")}function hte(e){const n=e;throw new Error("Cannot compile unknown node `"+n.type+"`")}const pte={},mte={},gte=[];function yte(e,n){const t=n||pte,r=t.quote||'"',a=r==='"'?"'":'"';if(r!=='"'&&r!=="'")throw new Error("Invalid quote `"+r+"`, expected `'` or `\"`");return{one:xte,all:bte,settings:{omitOptionalTags:t.omitOptionalTags||!1,allowParseErrors:t.allowParseErrors||!1,allowDangerousCharacters:t.allowDangerousCharacters||!1,quoteSmart:t.quoteSmart||!1,preferUnquoted:t.preferUnquoted||!1,tightAttributes:t.tightAttributes||!1,upperDoctype:t.upperDoctype||!1,tightDoctype:t.tightDoctype||!1,bogusComments:t.bogusComments||!1,tightCommaSeparatedLists:t.tightCommaSeparatedLists||!1,tightSelfClosing:t.tightSelfClosing||!1,collapseEmptyAttributes:t.collapseEmptyAttributes||!1,allowDangerousHtml:t.allowDangerousHtml||!1,voids:t.voids||aee,characterReferences:t.characterReferences||mte,closeSelfClosing:t.closeSelfClosing||!1,closeEmptyElements:t.closeEmptyElements||!1},schema:t.space==="svg"?vA:pee,quote:r,alternative:a}.one(Array.isArray(e)?{type:"root",children:e}:e,void 0,void 0)}function xte(e,n,t){return dte(e,n,t,this)}function bte(e){const n=[],t=e&&e.children||gte;let r=-1;for(;++r<t.length;)n[r]=this.one(t[r],r,e);return n.join("")}const vte={};function wte(e){const n=this,{handlers:t,sanitize:r,...a}=e||vte;let o=!1,l;typeof r=="boolean"?o=!r:r&&(l=r),n.compiler=d;function d(f,u){const p=iee(f,{handlers:t,allowDangerousHtml:o}),g=o?p:pZ(p,l),b=yte(g,{...a,allowDangerousHtml:o});return u.extname&&(u.extname=".html"),f&&f.type==="root"&&b&&/[^\r\n]/.test(b.charAt(b.length-1))?b+`
`:b}}const Ste=({isOpen:e,onClose:n,patientId:t,pharmacyInventory:r,fetchPharmacyOrdersData:a})=>{const[o,l]=w.useState([]),[d,f]=w.useState(""),[u,p]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>{if(!d){p([]);return}const R=d.toLowerCase();p(r.filter(z=>z.name.toLowerCase().includes(R)).slice(0,10))},[d,r]);const k=async()=>{if(!t){b("Patient ID is missing.");return}if(o.length===0){b("Please select at least one drug.");return}for(const R of o)if(R.selected_pack_quantity===0&&R.selected_loose_quantity===0){b(`Please specify a quantity for ${R.name}.`);return}S(!0),b(null);try{const R={patient_id:t,items:o.map(F=>({drug_id:F.id,name:F.name,pack_quantity:F.selected_pack_quantity,loose_quantity:F.selected_loose_quantity,pack_price:0,loose_price:0,total_price:0,tabletsPerDay:1,numberOfDays:1,directions_to_use:"As directed"})),order_total:0,prescription_for_unavailable_drugs:""},z=await pe("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)});if(!z.ok){const F=await z.json().catch(()=>({}));throw new Error(F.message||`Failed to create pharmacy order: ${z.statusText} `)}await z.json(),a(t),n(),l([]),f("")}catch(R){b(`Order Creation Error: ${R.message} `)}finally{S(!1)}},T=R=>{if(o.some(z=>z.id===R.id)){b(`${R.name} is already in the order.`),setTimeout(()=>b(null),3e3),f(""),p([]);return}l(z=>[...z,{...R,selected_pack_quantity:0,selected_loose_quantity:0}]),f(""),p([])},A=R=>{l(z=>z.filter(F=>F.id!==R))},M=(R,z,F)=>{const L=parseInt(F)||0;l(U=>U.map(B=>B.id===R?{...B,[z==="pack"?"selected_pack_quantity":"selected_loose_quantity"]:L}:B))};return e?i.jsx("div",{className:Tt.modalOverlay,children:i.jsxs("div",{className:Tt.modalContent,children:[i.jsxs("div",{className:Tt.modalHeader,children:[i.jsx("h3",{className:Tt.modalTitle,children:"Create Pharmacy Order"}),i.jsx("button",{onClick:n,className:Tt.modalCloseButton,children:i.jsx(zn,{size:20})})]}),i.jsxs("div",{className:Tt.modalBody,children:[g&&i.jsx("div",{className:Tt.errorText,children:g}),i.jsxs("div",{className:Tt.formGroup,style:{position:"relative"},children:[i.jsx("label",{htmlFor:"drug-search",children:"Add Drug"}),i.jsx("input",{type:"text",id:"drug-search",placeholder:"Search available drugs...",value:d,onChange:R=>f(R.target.value),className:Tt.inputField,autoComplete:"off"}),d&&u.length>0&&i.jsx("div",{className:Tt.searchResultsCard,children:i.jsx("ul",{className:Tt.searchResultsList,children:u.map(R=>i.jsx("li",{onClick:()=>T(R),className:Tt.searchResultItem,children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[i.jsx("span",{children:R.name}),i.jsxs("span",{className:Tt.searchResultPrice,children:["Stock: ",R.stock," (Box) / ",R.loose||0," (Loose)"]})]})},R.id))})})]}),i.jsxs("div",{className:Tt.selectedTestsCard,children:[" ",i.jsx("h4",{className:Tt.selectedTestsHeader,children:"Selected Drugs"}),o.length===0?i.jsx("p",{className:Tt.noTestsMessage,children:"No drugs added yet."}):i.jsx("ul",{className:Tt.selectedTestsList,children:o.map(R=>i.jsxs("li",{className:Tt.selectedTestItem,style:{flexDirection:"column",alignItems:"flex-start",gap:"8px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",alignItems:"center"},children:[i.jsx("span",{className:Tt.selectedTestName,style:{fontWeight:"bold"},children:R.name}),i.jsx("button",{type:"button",onClick:()=>A(String(R.id)),className:Tt.removeTestButton,title:"Remove Drug",children:i.jsx(Ur,{size:16})})]}),i.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",width:"100%"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsx("label",{style:{fontSize:"0.75rem",color:"#666"},children:"Packs"}),i.jsx("input",{type:"number",min:"0",className:Tt.inputField,style:{padding:"4px 8px"},value:R.selected_pack_quantity||"",onChange:z=>M(R.id,"pack",z.target.value),placeholder:"0"})]}),i.jsxs("div",{style:{flex:1},children:[i.jsx("label",{style:{fontSize:"0.75rem",color:"#666"},children:"Loose"}),i.jsx("input",{type:"number",min:"0",className:Tt.inputField,style:{padding:"4px 8px"},value:R.selected_loose_quantity||"",onChange:z=>M(R.id,"loose",z.target.value),placeholder:"0"})]})]})]},R.id))})]})]}),i.jsxs("div",{className:Tt.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${Tt.button} ${Tt.buttonSecondary} `,children:" Cancel "}),i.jsxs("button",{type:"button",onClick:k,disabled:o.length===0||v,className:`${Tt.button} ${Tt.buttonPrimary} ${o.length===0||v?Tt.buttonDisabled:""} `,children:[" ",v?"Creating...":"Create Order"," "]})]})]})}):null},Nte=({messages:e})=>{const n=w.useRef(null);return w.useEffect(()=>{n.current&&(n.current.scrollTop=n.current.scrollHeight)},[e]),i.jsxs("div",{className:"conversation-panel",children:[i.jsxs("div",{className:"conversation-header",children:[i.jsx("div",{className:"conversation-title",children:i.jsx("h3",{children:"Conversation"})}),i.jsxs("span",{className:"conversation-count",children:[e.length," messages"]})]}),i.jsxs("div",{ref:n,className:"message-list custom-scrollbar",children:[e.length===0&&i.jsx("div",{className:"empty-state",children:"Start talking to the AI..."}),e.map(t=>i.jsxs("div",{className:`message-wrapper ${t.role}`,children:[i.jsx("div",{className:`message-bubble ${t.role} ${t.role==="system"?t.type||"info":""}`,children:t.role==="ai"||t.role==="system"&&t.type==="loading"?i.jsx("div",{className:"prose prose-sm max-w-none",children:t.role==="system"&&t.type==="loading"?i.jsxs("span",{className:"flex items-center justify-center gap-2",children:[i.jsx("span",{className:"loading-spinner"}),t.content]}):i.jsx(Vs,{remarkPlugins:[ds],children:t.content})}):i.jsx("div",{className:"whitespace-pre-wrap",children:t.content})}),t.role!=="system"&&i.jsx("span",{className:"message-timestamp",children:t.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},t.id))]})]})},Q0=e=>{if(!e)return"";const n=new Date(e);if(isNaN(n.getTime()))return"";const t=n.getTimezoneOffset()*6e4;return new Date(n.getTime()-t).toISOString().slice(0,16)},Ij=()=>{var bo,vo;const{recordId:e,patientId:n}=Gi(),[t,r]=w.useState(e||void 0),a=Et(),o=Br(),[l,d]=w.useState(""),[f]=w.useState([]),[u,p]=w.useState(null),[g,b]=w.useState(null),[v,S]=w.useState(void 0),[k,T]=w.useState(void 0),[A,M]=w.useState(null),[R,z]=w.useState(!1),[F,L]=w.useState(""),[U,B]=w.useState(!1),[J,D]=w.useState(null),[$,H]=w.useState(null),[te,Q]=w.useState(!1),[Y,V]=w.useState(!1),[ae,re]=w.useState(null),[le,E]=w.useState(""),[ce,ue]=w.useState(""),[I,de]=w.useState(null),[fe,W]=w.useState(!1),[oe,se]=w.useState(!1),[je,We]=w.useState(!1),[X,Se]=w.useState(window.innerHeight),[Ae,Pe]=w.useState([]),[Ze,rt]=w.useState(!1),[lt,ze]=w.useState(null),[ot,at]=w.useState([]),[be,$e]=w.useState([]),[Be,ke]=w.useState(!1),[Ne,K]=w.useState(null),ge=w.useRef(null),He=w.useRef(null),Qe=w.useRef(!1),dt=w.useRef(null),At=w.useRef(null),Ht=w.useRef(null),we=w.useRef(null),xe=w.useRef(null),Me=w.useRef(null),De=w.useRef(null),[qe,st]=w.useState([]),[yt,_t]=w.useState(!1);w.useEffect(()=>{(async()=>{if(qe.length>0&&!yt){_t(!0);const me=qe[0];me.current&&(me.current.scrollIntoView({behavior:"smooth",block:"center"}),me.current.classList.add("ai-glow"),await new Promise(he=>setTimeout(he,2e3)),me.current&&me.current.classList.remove("ai-glow")),st(he=>he.slice(1)),_t(!1)}})()},[qe,yt]);const cn=ne=>{let me=null;switch(ne){case"update_patient_details":me=Ht;break;case"create_pharmacy_order":case"edit_pharmacy_order":me=we;break;case"create_lab_order":case"edit_lab_order":me=xe;break;case"add_complaint_history":me=Me;break;case"update_case_summary":me=De;break}me&&st(he=>[...he,me])},[gn,Cn]=w.useState(33.33),[wt,bt]=w.useState(!1),Ft=w.useRef(null),St=w.useRef(null),[Jn,Yi]=w.useState("response"),vr=w.useRef(null),yn=w.useRef(null),wr=150,[Ei,bu]=w.useState([]),[vu,Jh]=w.useState([]),[nl,Xs]=w.useState(!1),[tc,ms]=w.useState(null),[Zs,eo]=w.useState(!1),[to,gr]=w.useState(!1),[Yd,Wd]=w.useState(!1),[gs,no]=w.useState(!1),[nc,Qd]=w.useState(!1),[ys,Wi]=w.useState([]),[za,rl]=w.useState(!1),[Ai,il]=w.useState(null),[al,Ua]=w.useState(!1),[rc,ic]=w.useState(null),[ac,wu]=w.useState({}),[Jr,sc]=w.useState(!1),[oc,sl]=w.useState(!1),[ro,Ba]=w.useState(!1),[lc,Kr]=w.useState(!1),[io,cc]=w.useState(!1),[xs,bs]=w.useState(!1),[ol,ll]=w.useState(!1),[Pi,Qi]=w.useState(!1),ao=w.useMemo(()=>(g==null?void 0:g.admission_date)&&!(g!=null&&g.discharge_date),[g]),[uc,so]=w.useState(!1),[Jd,dc]=w.useState(null),[vs,oo]=w.useState(""),[cl,qa]=w.useState(void 0),[Va,ul]=w.useState(void 0),[dl,fc]=w.useState(void 0),[Xr,Di]=w.useState(!1),[lo,Ii]=w.useState(null),[Ha,fl]=w.useState(null),[hc,pc]=w.useState(null),[xn,kn]=w.useState(!1),hl=w.useRef(null),[$r,xa]=w.useState(null),[pl,co]=w.useState([]),Kd=w.useCallback(ne=>{co(me=>[...me,{id:Math.random().toString(36).substr(2,9),timestamp:new Date,role:"system",content:"",...ne}])},[]),[uo,mc]=w.useState(null),Hn=w.useRef(null),ba=w.useRef(null),[Ga,gc]=w.useState(!1),[ml,Zr]=w.useState(!1),[wn,yc]=w.useState(null),[gl,xc]=w.useState(""),[fo,ho]=w.useState(""),[Vr,Xd]=w.useState(!0),[Sr,Zd]=w.useState(!1),[bc,ei]=w.useState(!1),[va,vc]=w.useState(!1),[Gn,Ji]=w.useState(!1),ws=w.useRef(null),Kh=async()=>{ws.current&&(await ws.current.undoLastAction(),Ji(!1))},Ya=async ne=>{try{const me=await pe(`/api/patients/${ne}`);if(!me.ok){const Ce=await me.json().catch(()=>({}));throw new Error(Ce.message||`Failed to fetch patient details: ${me.status}`)}const he=await me.json();if(b(he),S(he.age),T(he.gender),E(he.ai_response||""),b(Ce=>Ce?{...Ce,current_status:he.current_status,admission_date:he.admission_date,discharge_date:he.discharge_date}:{...he,current_status:he.current_status,admission_date:he.admission_date,discharge_date:he.discharge_date}),he.insurance_type&&b(Ce=>Ce?{...Ce,insurance_type:he.insurance_type}:{...he}),yl(ne),he.ai_response){const Ce=/```json\s*([\s\S]*?)\s*```/,Je=he.ai_response.match(Ce);if(Je&&Je[1])ue(he.ai_response.replace(Ce,"").trim()),de(Je[1].trim());else{const ht=he.ai_response.trim();if(ht.startsWith("{")&&ht.endsWith("}"))try{JSON.parse(ht),ue(""),de(ht)}catch{ue(ht),de(null)}else if(ht.startsWith("[")&&ht.endsWith("]"))try{JSON.parse(ht),ue(""),de(ht)}catch{ue(ht),de(null)}else ue(ht),de(null)}}else ue(""),de(null)}catch{b(null),E(""),ue(""),de(null)}},Xh=async(ne,me)=>{b(he=>he?{...he,insurance_type:me}:null);try{const he=await pe(`/api/patients/${ne}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:me})});if(!he.ok){const Ce=await he.json();throw new Error(Ce.message||"Failed to update insurance type")}}catch(he){console.error("Error updating insurance type:",he),ne&&Ya(ne)}},ef=async ne=>{ke(!0),K(null),$e([]);try{const me=await pe(`/api/queue/patient/${ne}/complaints`);if(!me.ok){const Ce=await me.json().catch(()=>({}));throw new Error(Ce.message||`HTTP error! status: ${me.status}`)}const he=await me.json();$e(he||[])}catch(me){K(`Past complaints error: ${me.message}`)}finally{ke(!1)}},po=async ne=>{at([]);try{const me=await pe(`/api/pharmacy-orders/patient/${ne}`);if(!me.ok){const Ce=await me.json().catch(()=>({}));throw new Error(Ce.message||`HTTP error! status: ${me.status}`)}const he=await me.json();at(he||[])}catch{}},Ss=async ne=>{rl(!0),il(null),Wi([]);try{const me=await pe(`/api/lab/orders/patient/${ne}`);if(!me.ok){const Ce=await me.json().catch(()=>({}));throw new Error(Ce.message||`HTTP error! status: ${me.status}`)}const he=await me.json();Wi(he||[])}catch(me){il(`Pending labs error: ${me.message}`)}finally{rl(!1)}},Wa=async ne=>{rt(!0),ze(null),Pe([]);try{const me=await pe(`/api/lab/patient/${ne}`);if(!me.ok){const Ce=await me.json().catch(()=>({}));throw new Error(Ce.message||`HTTP error! status: ${me.status}`)}const he=await me.json();Pe(he||[])}catch(me){ze(`Lab reports error: ${me.message}`)}finally{rt(!1)}},mo=async ne=>{try{const me=await pe(`/api/patients/${ne}/context`);if(!me.ok){console.error("Failed to fetch patient context");return}const he=await me.json();if(b(he.patient),S(he.patient.age),T(he.patient.gender),E(he.patient.ai_response||""),he.patient.ai_response){const Ce=/```json\s*([\s\S]*?)\s*```/,Je=he.patient.ai_response.match(Ce);if(Je&&Je[1])ue(he.patient.ai_response.replace(Ce,"").trim()),de(Je[1].trim());else{const ht=he.patient.ai_response.trim();if(ht.startsWith("{")&&ht.endsWith("}"))try{JSON.parse(ht),ue(""),de(ht)}catch{ue(ht),de(null)}else if(ht.startsWith("[")&&ht.endsWith("]"))try{JSON.parse(ht),ue(""),de(ht)}catch{ue(ht),de(null)}else ue(ht),de(null)}}else ue(""),de(null);if(Qi(he.patient.current_status==="In Doctor Queue"||he.patient.current_status==="In Consultation"),$e(Array.isArray(he.history)?he.history:[]),at(Array.isArray(he.pharmacyOrders)?he.pharmacyOrders:[]),Array.isArray(he.labOrders)){const Ce=he.labOrders,Je=Ce.filter(jt=>!jt.report);Wi(Je);const ht=Ce.filter(jt=>jt.report).map(jt=>({...jt.report,id:jt.id,patient_id:jt.patient_id,createdAt:jt.createdAt}));Pe(ht)}else Wi([]),Pe([])}catch(me){console.error("Error fetching patient context:",me)}},yl=async ne=>{try{const me=await pe(`/api/queue/patient/${ne}/latest`);if(!me.ok){const Ce=await me.json().catch(()=>({}));throw new Error(Ce.message||`Failed to fetch queue status: ${me.status}`)}const he=await me.json();if(he){const Ce=new Date(he.createdAt),Je=new Date,ht=Ce.getDate()===Je.getDate()&&Ce.getMonth()===Je.getMonth()&&Ce.getFullYear()===Je.getFullYear(),jt=["waiting","consulting"].includes(he.status);Qi(ht&&jt)}else Qi(!1)}catch(me){console.error("Error checking patient queue status:",me),Qi(!1)}},Ns=async(ne,me)=>{try{if(!(await pe(`/api/pharmacy-orders/${ne}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:me})})).ok)throw new Error("Failed to update pharmacy order date");u&&po(u)}catch(he){console.error("Error updating pharmacy order date:",he),re("Failed to update pharmacy order date")}},xl=async(ne,me,he)=>{try{const Ce={};if(me==="order"?Ce.date=he:me==="report"&&(Ce.reportDate=he),!(await pe(`/api/lab/orders/${ne}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ce)})).ok)throw new Error("Failed to update lab date");u&&(Ss(u),Wa(u))}catch(Ce){console.error("Error updating lab order date:",Ce),re("Failed to update lab order date")}},bl=ne=>{a(`/dashboard/edit-pharmacy-order/${ne}`)},wc=ne=>{re(null),console.log(`Preparing billing navigation for order: ${ne}`);const me=ot.find(he=>he.id===ne);if(me){const he=me.medications.map(Ce=>{const Je=Ce.price??0;return(Ce.price===void 0||Ce.price===null)&&console.warn(`Medication "${Ce.name}" in order ${ne} is missing a price. Defaulting to 0.`),{name:Ce.name,pack_quantity:Ce.pack_quantity,loose_quantity:Ce.loose_quantity,price:Je,pack_price:Ce.pack_price,loose_price:Ce.loose_price,total_price:Number(Ce.total_price)||0,isLoose:Ce.isLoose,unit:Ce.unit,drug_id:Ce.drug_id?String(Ce.drug_id):null,tabletsPerDay:Ce.tabletsPerDay,numberOfDays:Ce.numberOfDays,directions_to_use:Ce.directions_to_use,discount_percentage:Ce.discount_percentage??0,batch:Ce.batch,expiry_date:Ce.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:he}),a(`/dashboard/pharmacy-billing/${ne}`,{state:{initialItems:he}})}else console.error(`Order with ID ${ne} not found.`),re(`Order with ID ${ne} not found.`),alert(`Error: Could not find order ${ne} to bill.`)},Su=async(ne,me)=>{re(null);const he=ot.find(Je=>Je.id===ne);if(!he){re(`Order with ID ${ne} not found.`);return}const Ce={status:me,medications:he.medications};try{const Je=await pe(`/api/pharmacy-orders/${ne}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ce)});if(!Je.ok){const jt=await Je.text();throw new Error(`Failed to update status: ${Je.statusText} (${Je.status}) - ${jt}`)}const ht=await Je.json();at(jt=>jt.map(Ct=>Ct.id===ht.id?{...Ct,status:ht.status}:Ct)),u&&po(u)}catch(Je){console.error("Failed to update order status:",Je),re(Je.message||`Failed to update status for order ${ne}.`),alert(`Error updating status for order ${ne}: ${Je.message||"Please try again."}`)}},tf=ne=>{Wi(me=>me.map(he=>he.id===ne?{...he,isEditing:!0,editedTests:[...he.tests],editedStatus:he.status}:{...he,isEditing:!1}))},Sc=ne=>{Wi(me=>me.map(he=>he.id===ne?{...he,isEditing:!1,editedTests:void 0,editedStatus:void 0}:he))},Qa=(ne,me,he,Ce)=>{Wi(Je=>Je.map(ht=>{if(ht.id===ne){const jt=ht.editedTests?[...ht.editedTests]:[...ht.tests];if(he==="add")return{...ht,editedTests:[...jt,{id:"",name:"",price:0}]};if(he==="remove")return{...ht,editedTests:Ce};if(me!==-1){const Ct={...jt[me],[he]:Ce};return jt[me]=Ct,{...ht,editedTests:jt}}}return ht}))},Zh=(ne,me)=>{Wi(he=>he.map(Ce=>Ce.id===ne?{...Ce,editedStatus:me}:Ce))},nf=async ne=>{if(!ne){console.error("Cannot navigate to billing: Lab Order data is missing."),alert("Could not open billing page: Lab Order information is missing.");return}a(`/dashboard/lab-billing/${ne.id}`)},ti=async(ne,me)=>{console.log(`Updating lab order ${ne} to status ${me}`);try{const he=await pe(`/api/lab/${ne}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:me})});if(!he.ok){const Ce=await he.json();throw new Error(Ce.message||`Failed to update lab order status: ${he.status}`)}u&&(Ss(u),Wa(u)),console.log(`Lab Order ${ne} status updated to ${me}, refetching data.`)}catch(he){console.error("Error updating lab order status:",he),alert(`Failed to update lab order status: ${he instanceof Error?he.message:"Unknown error"}`)}},vl=ne=>{ne&&ne.id?a(`/lab/report/${ne.id}`):(console.error("Cannot navigate: Lab Order or Lab Order ID is missing."),alert("Could not open the report entry page: Lab Order information is missing."))},go=async(ne,me,he)=>{Ba(!0),re(null);try{if(!me||me.length===0)throw new Error("Lab order must have at least one test.");for(const ht of me)if(!ht.id||!ht.name||isNaN(ht.price)||ht.price<0)throw new Error(`Invalid test data: ${JSON.stringify(ht)}. Each test must have id, name, and a valid price.`);const Ce={tests:me,status:he},Je=await pe(`/api/lab/orders/${ne}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ce)});if(!Je.ok){const ht=await Je.json().catch(()=>({}));throw new Error(ht.message||`Failed to update lab order: ${Je.statusText}`)}u&&Ss(u),Wi(ht=>ht.map(jt=>jt.id===ne?{...jt,isEditing:!1,editedTests:void 0,editedStatus:void 0}:jt))}catch(Ce){re(`Lab Order Save Error: ${Ce.message}`)}finally{Ba(!1)}},wa=async ne=>{if(!window.confirm(`Are you sure you want to delete this ${ne.type.toLowerCase()} record? This action cannot be undone.`))return;Ua(!0),ic(null);let he=null,Ce;const Je=ne.type;try{switch(Je){case"Complaint":if(Ce=ne.data.id,!Ce)throw new Error("Complaint ID is missing.");he=`/api/patients/complaints/${Ce}`;break;case"Lab Order":if(Ce=ne.data.id,!Ce)throw new Error("Lab Order ID is missing.");he=`/api/lab/orders/${Ce}`;break;case"Lab Report":if(Ce=ne.data.reportId,!Ce)throw new Error("Lab Report ID is missing.");he=`/api/lab/reports/${Ce}`;break;case"Pharmacy Order":if(Ce=ne.data.id,!Ce)throw new Error("Pharmacy Order ID is missing.");he=`/api/pharmacy-orders/${Ce}`;break;default:throw new Error(`Deletion not supported for item type: ${Je}`)}if(!he)throw new Error(`Could not determine delete URL for type: ${Je}`);const ht=await pe(he,{method:"DELETE"});if(!ht.ok){const jt=await ht.json().catch(()=>({}));throw new Error(jt.message||`Failed to delete ${Je}: ${ht.statusText}`)}u&&(Je==="Complaint"?ef(u):Je==="Lab Order"?(Ss(u),Wa(u)):Je==="Lab Report"?Wa(u):Je==="Pharmacy Order"&&po(u))}catch(ht){ic(`Delete Error (${Je}): ${ht.message}`),al&&Ua(!1)}finally{Ua(!1)}},yo=async()=>{if(!u)return;if(ot.filter(me=>me.status==="pending").length<2){alert("You need at least two pending orders to merge.");return}Zr(!0);try{const me=await pe(`/api/pharmacy-orders/patient/${u}/merge-pending`,{method:"POST"});if(!me.ok){const he=await me.json().catch(()=>({}));throw new Error(he.message||"Failed to merge orders")}po(u)}catch(me){re(`Merge Error: ${me.message}`)}finally{Zr(!1)}},Ja=w.useMemo(()=>{if(!u||!be)return[];const ne=be.map(me=>({date:new Date(me.createdAt),type:"Complaint",data:me,originalDateString:me.createdAt})).filter(me=>!isNaN(me.date.getTime()));return ne.sort((me,he)=>he.date.getTime()-me.date.getTime()),ne},[u,be]),Ri=w.useMemo(()=>{if(!u)return[];const ne=new Map;(ys??[]).forEach(he=>{ne.set(he.id,{...he})}),(Ae??[]).forEach(he=>{if(!ne.has(he.id))ne.set(he.id,{id:he.id,patient_id:he.patient_id,tests:he.tests,status:he.status,createdAt:he.createdAt,report:he});else{const Ce=ne.get(he.id);Ce&&(Ce.report=he,Ce.status=he.status)}});let me=Array.from(ne.values());return me.sort((he,Ce)=>new Date(he.createdAt).getTime()-new Date(Ce.createdAt).getTime()),me=me.map((he,Ce)=>({...he,serialNumber:Ce+1})),me.map(he=>({date:new Date(he.createdAt),type:"Lab Order",data:he,originalDateString:he.createdAt}))},[u,ys,Ae]),Ki=w.useMemo(()=>{if(!u||!ot)return[];const ne=ot.map(me=>({date:new Date(me.date),type:"Pharmacy Order",data:me,originalDateString:me.date})).filter(me=>!isNaN(me.date.getTime()));return ne.sort((me,he)=>he.date.getTime()-me.date.getTime()),ne},[u,ot]),[Nu,Nc]=w.useState(null),[Sa,Cu]=w.useState([]),[xo,wl]=w.useState(""),_u=(ne,me)=>{if(!ne||!ne.report_content||!me)return"";try{const he=JSON.parse(ne.report_content||"{}");if(typeof he!="object"||he===null)return`<p class="italic text-gray-500 text-xs">Report content is not structured data.</p><pre>${ne.report_content}</pre>`;let Ce="";return me.forEach(Je=>{he[Je.id]?(Ce+=`<h5 class="font-semibold text-sm mt-2 mb-1">${Je.name}</h5>`,Ce+='<table class="lab-report-print-table"><thead><tr><th>Parameter</th><th>Value</th><th>Normal Range</th></tr></thead><tbody>',Object.entries(he[Je.id]).map(([ht,jt])=>{var Hr;const Ct=(Hr=Je.default_parameters)==null?void 0:Hr.find(js=>js.name===ht);let Yn="N/A";Ct&&Ct.type==="number"&&(Ct.lower_limit!=null||Ct.upper_limit!=null)?(Yn="",Ct.lower_limit!=null&&(Yn+=` > ${Ct.lower_limit}`),Ct.lower_limit!=null&&Ct.upper_limit!=null&&(Yn+=" - "),Ct.upper_limit!=null&&(Yn+=` < ${Ct.upper_limit}`),Yn=Yn.trim()||"N/A"):(Ct==null?void 0:Ct.type)==="boolean"?Yn="N/A":Ct!=null&&Ct.normal_range&&(Yn=Ct.normal_range),Ce+=`<tr><td>${ht}</td><td>${String(jt)} ${(Ct==null?void 0:Ct.unit)||""}</td><td>${Yn}</td></tr>`}),Ce+="</tbody></table>"):Ce+=`<p class="italic text-gray-500 text-xs">No parameters reported for ${Je.name}.</p>`}),Ce}catch{return`<p class="italic text-gray-500 text-xs">Error parsing report content.</p><pre>${ne.report_content}</pre>`}};w.useEffect(()=>{const ne=()=>{Se(window.innerHeight)};return window.addEventListener("resize",ne),ne(),()=>window.removeEventListener("resize",ne)},[]),w.useEffect(()=>{const ne=he=>{if(!wt||!yn.current||!vr.current)return;const Ce=vr.current.getBoundingClientRect(),ht=he.clientX-yn.current.x;let jt=yn.current.initialWidth+ht;const Ct=Ce.width-wr-10;jt=Math.max(wr,jt),jt=Math.min(jt,Ct);const Yn=jt/Ce.width*100;Cn(Yn)},me=()=>{bt(!1),yn.current=null,document.body.style.cursor="",document.body.style.userSelect=""};return wt&&(window.addEventListener("mousemove",ne),window.addEventListener("mouseup",me),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{window.removeEventListener("mousemove",ne),window.removeEventListener("mouseup",me),document.body.style.cursor="",document.body.style.userSelect=""}},[wt]);const Ka=ne=>{if(!vr.current)return;ne.preventDefault();const me=vr.current.querySelector(".edit-complaint-context-column");me&&(yn.current={x:ne.clientX,initialWidth:me.offsetWidth},bt(!0))},Sl=w.useCallback(async()=>{V(!0),re(null);try{const ne=await pe("/api/queue/doctor/new",{method:"POST"});if(!ne.ok){const he=await ne.json().catch(()=>({}));throw new Error(he.message||`Failed to create record: ${ne.statusText}`)}const me=await ne.json();if(!me.recordId)throw new Error("New record ID not received from server.");a(`/edit-complaint/${me.recordId}`,{replace:!0})}catch(ne){re(`Failed to create new complaint record: ${ne.message}`)}finally{V(!1)}},[a]);w.useEffect(()=>{(async()=>{Xd(!0);try{const me=await pe("/api/clinics/settings");if(!me.ok){const Ce=await me.json().catch(()=>({}));throw new Error(Ce.message||"Failed to fetch clinic settings.")}const he=await me.json();yc({admissionCharge:parseFloat(he.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(he.perDayCharge||0).toFixed(2),otherCharges:parseFloat(he.otherCharges||0).toFixed(2),aiMemory:he.aiMemory||"",aiMemoryUpdatedAt:he.aiMemoryUpdatedAt||null,clinicWideSystemPrompt:he.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:he.clinicWideSystemPromptUpdatedAt||null,gemini_api_key:he.gemini_api_key||""}),xc(he.aiMemory||""),ho(he.clinicWideSystemPrompt||"")}catch{}finally{Xd(!1)}})()},[]),w.useEffect(()=>{var me;(me=o.state)!=null&&me.initialComplaint&&d(o.state.initialComplaint);const ne=async he=>{Q(!0),re(null);try{const Ce=await pe(`/api/queue/doctor/complaint/${he}`);if(!Ce.ok){const ht=await Ce.json().catch(()=>({}));throw new Error(ht.message||`HTTP error! status: ${Ce.status}`)}const Je=await Ce.json();p(Je.patientId),S(Je.age),T(Je.gender),M(Je.case_summary||null),H(Je.updatedAt||null)}catch{re("Failed to load current complaint details."),p(null),S(void 0),T(void 0),M(null),H(null)}finally{Q(!1)}};if(t)ne(t);else if(n){const he=n;he&&(p(he),(async()=>{try{const Je=await pe(`/api/queue/patient/${he}/latest`);if(Je.ok){const jt=await Je.json();if(jt!=null&&jt._id){r(jt._id),ne(jt._id);return}}const ht=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:he,complaint:"Visit Initiated"})});if(ht.ok){const jt=await ht.json();if(jt!=null&&jt.id){r(jt.id),ne(jt.id);return}}}catch(Je){console.error("Background queue resolution failed",Je),re("Failed to initialize visit record.")}})())}else Sl()},[t,Sl,(bo=o.state)==null?void 0:bo.initialComplaint,n]),w.useEffect(()=>{u?mo(u):(b(null),$e([]),at([]),Wi([]),Pe([]),H(null),Qi(!1))},[u]),w.useEffect(()=>{var he;const ne=(he=o.state)==null?void 0:he.initialComplaint;ne&&t&&(!te&&!Be&&!za&&!Ze&&!nl)&&!Qe.current&&l===ne&&(Qe.current=!0,Cs(),a(o.pathname,{replace:!0,state:{}}))},[(vo=o.state)==null?void 0:vo.initialComplaint,t,l,te,Be,za,Ze,nl,a]);const ep=()=>{L(A||""),z(!0),D(null)},tp=()=>{z(!1),L(""),D(null)},ni=async()=>{if(!t){D("Missing Record ID.");return}B(!0),D(null);try{const ne=await pe(`/api/queue/doctor/complaint/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:F.trim()})});if(!ne.ok){const he=await ne.json().catch(()=>({}));throw new Error(he.message||`Failed to save case summary: ${ne.statusText}`)}const me=await ne.json();M(me.case_summary||F.trim()),H(me.updatedAt||null),z(!1)}catch(ne){D(`Save Error: ${ne.message}`)}finally{B(!1)}};w.useEffect(()=>{(async()=>{Xs(!0),ms(null);try{const[me,he]=await Promise.all([pe("/api/drugs"),pe("/api/lab-tests")]);if(!me.ok)throw new Error(`Pharmacy inventory error! status: ${me.status}`);const Ce=await me.json();if(bu(Ce||[]),!he.ok)throw new Error(`Lab inventory error! status: ${he.status}`);const Je=await he.json();Jh(Je||[])}catch(me){ms(me.message)}finally{Xs(!1)}})()},[]);const Xi=async()=>{if(!wn)return;if(gl===wn.aiMemory&&fo===wn.clinicWideSystemPrompt){ei(!1);return}const ne=gl!==wn.aiMemory,me=fo!==wn.clinicWideSystemPrompt;ne&&Zd(!0),me&&vc(!0);try{const he={...wn};ne&&(he.aiMemory=gl),me&&(he.clinicWideSystemPrompt=fo);const Ce=await pe("/api/clinics/settings",{method:"PUT",body:JSON.stringify(he)});if(!Ce.ok){const ht=await Ce.json().catch(()=>({}));throw new Error(ht.message||"Failed to update clinic settings.")}const Je=await Ce.json();yc({admissionCharge:parseFloat(Je.settings.admissionCharge).toFixed(2),perDayCharge:parseFloat(Je.settings.perDayCharge).toFixed(2),otherCharges:parseFloat(Je.settings.otherCharges).toFixed(2),aiMemory:Je.settings.aiMemory||"",aiMemoryUpdatedAt:Je.settings.aiMemoryUpdatedAt||(wn==null?void 0:wn.aiMemoryUpdatedAt)||null,clinicWideSystemPrompt:Je.settings.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:Je.settings.clinicWideSystemPromptUpdatedAt||(wn==null?void 0:wn.clinicWideSystemPromptUpdatedAt)||null}),ne&&xc(Je.settings.aiMemory||""),me&&(ho(Je.settings.clinicWideSystemPrompt||""),ei(!1))}catch{}finally{ne&&Zd(!1),me&&vc(!1)}},ui=()=>{wn&&(ho(wn.clinicWideSystemPrompt||""),ei(!0))},ju=()=>{ei(!1),wn&&ho(wn.clinicWideSystemPrompt||"")},Cs=async ne=>{const me=ne??l;me.trim()&&(ba.current&&(clearTimeout(ba.current),ba.current=null),Kd({role:"user",content:me}),ws.current&&(await ws.current.callGenerativeApi(me),ba.current=setTimeout(()=>{co([])},1e4)))},rf=ne=>{navigator.clipboard.writeText(ne).then(()=>{}).catch(me=>{console.error("Failed to copy text: ",me)})},Nl=(ne,me)=>{const he=window.open("","_blank");he&&(he.document.write(`
        <html>
          <head>
            <title>${me}</title>
            <style>
              body { font-family: sans-serif; margin: 20px; }
              h2 { text-align: center; margin-bottom: 20px; }
              table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
              th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
              th { background-color: #f2f2f2; }
              pre { white-space: pre-wrap; word-wrap: break-word; }
              .ai-context-section { margin-bottom: 20px; border: 1px solid #eee; padding: 15px; border-radius: 5px; }
              .ai-context-section-title { font-size: 1.1em; font-weight: bold; margin-bottom: 10px; color: #333; }
              .ai-context-text { margin-bottom: 5px; }
              .text-gray-400 { color: #999; }
              .font-semibold { font-weight: 600; }
              .italic { font-style: italic; }
              .mt-2 { margin-top: 8px; }
              .ml-1 { margin-left: 4px; }
              .ml-2 { margin-left: 8px; }
              .flex { display: flex; }
              .flex-col { flex-direction: column; }
              .w-full { width: 100%; }
              .text-xs { font-size: 0.75rem; }
              .text-sm { font-size: 0.875rem; }
              .prose { max-width: 65ch; }
              .prose table { display: table; } /* Ensure tables in markdown render correctly */
            </style>
          </head>
          <body>
            <h2>${me}</h2>
            <div id="print-content">${ne}</div>
          </body>
        </html>
      `),he.document.close(),he.print())},np=()=>{if(le){const ne=cZ().use(ds).use(wte).processSync(ce).toString();Nl(`<div class="prose">${ne}</div>`,"AI Response")}};w.useEffect(()=>{if(g){let ne=`
        <div class="print-section">
          <h3>Patient Details</h3>
          <p><strong>Name:</strong> ${g.name||"N/A"}</p>
          <p><strong>Token:</strong> ${g.patient_token_number||"N/A"}</p>
          <p><strong>Age:</strong> ${g.age||"N/A"}</p>
          <p><strong>Gender:</strong> ${g.gender||"N/A"}</p>
          <p><strong>Phone:</strong> ${g.phone||"N/A"}</p>
          <p><strong>Insurance:</strong> ${g.insurance_type||"N/A"}</p>
          <p><strong>Status:</strong> ${g.current_status||"N/A"}</p>
          <p><strong>Admitted:</strong> ${g.admission_date?new Date(g.admission_date).toLocaleDateString():"N/A"}</p>
          <p><strong>Discharged:</strong> ${g.discharge_date?new Date(g.discharge_date).toLocaleDateString():"N/A"}</p>
        </div>
        <div class="print-section">
          <h3>Case Summary</h3>
          <p>${A||"No summary available."}</p>
        </div>
        <div class="print-section">
          <h3>Complaints History</h3>
          ${Ja.length>0?`
            <ul>
              ${Ja.map(me=>`<li>${new Date(me.originalDateString).toLocaleDateString()}: ${me.data.complaint}</li>`).join("")}
            </ul>
          `:"<p>No past complaints.</p>"}
        </div>
        <div class="print-section">
          <h3>Pharmacy Orders</h3>
          ${Ki.length>0?`
            <table class="print-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Status</th>
                  <th>Drug Name</th>
                  <th>Quantity</th>
                  <th>Dosage</th>
                  <th>Directions</th>
                </tr>
              </thead>
              <tbody>
                ${Ki.map(me=>me.data.medications.map((he,Ce)=>`
                    <tr>
                      ${Ce===0?`<td rowspan="${me.data.medications.length}">${new Date(me.originalDateString).toLocaleDateString()}</td>`:""}
                      ${Ce===0?`<td rowspan="${me.data.medications.length}">${me.data.status}</td>`:""}
                      <td><strong>${he.name}</strong></td>
                      <td>
                        ${he.pack_quantity!==void 0&&he.pack_quantity>0?`Packs: ${he.pack_quantity}`:""}
                        ${he.pack_quantity!==void 0&&he.pack_quantity>0&&he.loose_quantity!==void 0&&he.loose_quantity>0?", ":""}
                        ${he.loose_quantity!==void 0&&he.loose_quantity>0?`Loose: ${he.loose_quantity}`:""}
                      </td>
                      <td>${he.tabletsPerDay&&he.numberOfDays?`${he.tabletsPerDay} tab/day for ${he.numberOfDays} days`:"N/A"}</td>
                      <td>${he.directions_to_use||"N/A"}</td>
                    </tr>
                  `).join("")).join("")}
              </tbody>
            </table>
          `:"<p>No pharmacy orders.</p>"}
        </div>
        <div class="print-section">
          <h3>Lab History (Orders & Reports)</h3>
          ${Ri.length>0?`
            ${Ri.map(me=>{const he=me.data.tests.map(Je=>Je.name).join(", ");let Ce="";return me.data.report&&(Ce=`
                  <div class="lab-report-print-container">
                    <h4>Lab Report (${new Date(me.data.report.report_date).toLocaleDateString()})</h4>
                    ${_u(me.data.report,me.data.report.tests)}
                  </div>
                `),`
                <div class="lab-history-item">
                  <p><strong>Order Date:</strong> ${new Date(me.originalDateString).toLocaleDateString()}</p>
                  <p><strong>Status:</strong> ${me.data.status}</p>
                  <p><strong>Tests:</strong> ${he}</p>
                  ${Ce}
                </div>
              `}).join("")}
          `:"<p>No lab history.</p>"}
        </div>
      `;wl(ne)}else wl("")},[g,A,Ja,Ki,Ri,_u]);const Xa=()=>{xo&&Nl(xo,`Patient Details - ${g==null?void 0:g.name}`)},Za=ne=>{d(ne),Nc(null),Cu([]),setTimeout(()=>{Cs(ne)},0)},Ee=te||oe||je||Ze||Be||nl||za||Y||Zs||to||Yd||gs||nc||ro||Xr||Sr||va||ml||al||lc||io||xs||ol||U,Ye=Ee,Ve=()=>{d("reports came,please anaylse"),setTimeout(()=>{Cs()},0)},pt=ne=>{wu(me=>({...me,[ne]:!me[ne]}))},Dt=ne=>{ne.key==="Enter"&&!ne.shiftKey&&(ne.preventDefault(),!Ee&&l.trim()&&t&&Cs())};w.useEffect(()=>{const ne=window.SpeechRecognition||window.webkitSpeechRecognition;if(!ne){xa("Speech recognition not supported in this browser.");return}const me=new ne;return me.continuous=!0,me.interimResults=!0,me.lang="en-US",me.onresult=he=>{let Ce="";for(let Je=he.resultIndex;Je<he.results.length;++Je)he.results[Je].isFinal&&(Ce+=he.results[Je][0].transcript);Ce&&d(Je=>Je+(Je.endsWith(" ")||Je===""?"":" ")+Ce)},me.onerror=he=>{xa(`Speech error: ${he.error}`),kn(!1)},me.onend=()=>{},hl.current=me,()=>{hl.current&&hl.current.stop()}},[]);const un=async()=>{if(u)if(ao){cc(!0);try{const ne=await pe(`/api/patients/${u}/discharge`,{method:"POST"});if(!ne.ok){const me=await ne.json().catch(()=>({}));throw new Error(me.message||`Failed to discharge patient: ${ne.status}`)}Ya(u)}catch(ne){re(`Discharge Error: ${ne.message}`)}finally{cc(!1)}}else{Kr(!0);try{const ne=await pe(`/api/patients/${u}/admit`,{method:"POST"});if(!ne.ok){const me=await ne.json().catch(()=>({}));throw new Error(me.message||`Failed to admit patient: ${ne.status}`)}Ya(u)}catch(ne){re(`Admit Error: ${ne.message}`)}finally{Kr(!1)}}},cr=async ne=>{if(u){bs(!0);try{const he=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:u})});if(!he.ok){const Ce=await he.json().catch(()=>({}));throw new Error(Ce.message||`Failed to add patient to ${ne} queue: ${he.status}`)}alert(`Patient added to ${ne} queue successfully!`),u&&(Ya(u),yl(u))}catch(me){re(`Add to Queue Error: ${me.message}`)}finally{bs(!1)}}},dn=async()=>{if(t){ll(!0),re(null);try{const ne=await pe(`/api/queue/${t}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"seen"})});if(!ne.ok){const me=await ne.json().catch(()=>({}));throw new Error(me.message||"Failed to complete consultation")}alert("Consultation completed successfully!"),u&&(Ya(u),yl(u))}catch(ne){re(`Error completing consultation: ${ne.message}`)}finally{ll(!1)}}},Cc=async()=>{if(!u){Ii("Missing Patient ID.");return}if(!g){Ii("Patient details not loaded.");return}Di(!0),Ii(null);try{const ne={};let me=!1;if(vs!==g.name&&(ne.name=vs,me=!0),cl!==g.age&&(ne.age=cl,me=!0),Va!==g.gender&&(ne.gender=Va,me=!0),dl!==g.phone&&(ne.phone=dl,me=!0),!me){Ii("No changes detected."),Di(!1),so(!1);return}const he=await pe(`/api/patients/${u}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ne)});if(!he.ok){const Je=await he.json().catch(()=>({}));throw new Error(Je.message||`Failed to update patient details: ${he.statusText}`)}const Ce=await he.json();b(Ce),S(Ce.age),T(Ce.gender),oo(Ce.name),qa(Ce.age),ul(Ce.gender),fc(Ce.phone),so(!1)}catch(ne){Ii(`Save Error: ${ne.message}`)}finally{Di(!1)}},af=w.useCallback(()=>{if(!g)return null;const ne={token_number:g.patient_token_number||"N/A",name:g.name||"N/A",age:g.age||"N/A",gender:g.gender||"N/A",phone:g.phone||"N/A"};return Ja.length>0?ne.complaints_history=Ja.map(me=>`${me.data.complaint} (${new Date(me.originalDateString).toLocaleDateString()})`).join("; "):ne.complaints_history="No past complaints.",Ki.length>0?ne.pharmacy_orders_history=Ki.map(me=>`Order: ${me.data.medications.map(Ce=>{let Je=`${Ce.name}`;return Ce.pack_quantity!==void 0&&Ce.pack_quantity>0&&(Je+=` Packs: ${Ce.pack_quantity}`),Ce.loose_quantity!==void 0&&Ce.loose_quantity>0&&(Je+=` Loose: ${Ce.loose_quantity}`),Je}).join(", ")} (${me.data.status}, ${new Date(me.originalDateString).toLocaleDateString()})`).join("; "):ne.pharmacy_orders_history="No pharmacy orders.",Ri.length>0?ne.lab_orders_history=Ri.map(me=>{let Ce=`Lab Order: ${me.data.tests.map(Je=>Je.name).join(", ")} (${me.data.status}, ${new Date(me.originalDateString).toLocaleDateString()})`;return me.data.report&&(Ce+=` - Report: ${me.data.report.report_content} (${new Date(me.data.report.report_date).toLocaleDateString()})`),Ce}).join("; "):ne.lab_orders_history="No lab history.",ne},[g,Ja,Ki,Ri]),ri=()=>{if(!g){xa("Patient details are required to use the Live API.");return}gc(!0)},_c=()=>{var ne;(ne=Hn.current)==null||ne.click()},rp=ne=>{var he;const me=(he=ne.target.files)==null?void 0:he[0];me&&mc(me)},_s=ne=>{Yi(ne),ne==="context"&&Ft.current?Ft.current.scrollIntoView({behavior:"smooth",block:"start"}):ne==="response"&&St.current&&St.current.scrollIntoView({behavior:"smooth",block:"start"})};return w.useEffect(()=>{const ne=new IntersectionObserver(me=>{me.forEach(he=>{he.isIntersecting&&(he.target===St.current?Yi("response"):he.target===Ft.current&&Yi("context"))})},{root:null,threshold:.5});return St.current&&ne.observe(St.current),Ft.current&&ne.observe(Ft.current),()=>{St.current&&ne.unobserve(St.current),Ft.current&&ne.unobserve(Ft.current)}},[]),i.jsxs("div",{className:"edit-complaint-page",style:{height:`${X}px`},children:[i.jsx(TQ,{ref:ws,recordId:t,patientId:u,patientDetails:g,caseSummary:A,caseSummaryUpdatedAt:$,clinicSettings:wn,userMessages:f,selectedImageFile:uo,pendingLabOrders:ys,labReports:Ae,pastComplaints:be,pharmacyOrders:ot,pharmacyInventory:Ei,labInventory:vu,currentComplaint:l,setCurrentComplaint:d,setAiResponse:E,setAiResponseText:ue,setAiResponseJsonString:de,setShowAiJsonDetails:W,setIsLoadingAi:se,setAiError:()=>{},setIsSubmittingAiOrder:eo,setAiOrderSubmissionStatus:()=>{},setIsSubmittingAiLabOrder:gr,setAiLabOrderSubmissionStatus:()=>{},setIsSubmittingAiComplaint:Wd,setAiComplaintSubmissionStatus:()=>{},setIsUpdatingCaseSummary:no,setAiCaseSummaryUpdateStatus:()=>{},setCaseSummary:M,setCaseSummaryUpdatedAt:H,setIsUpdatingAiMemoryByAI:Qd,setAiMemoryUpdateByAIStatus:()=>{},setFollowUpQuestion:Nc,setFollowUpOptions:Cu,setError:re,setIsSavingAiResponse:We,setSaveAiResponseError:()=>{},fetchPharmacyOrdersData:po,fetchPendingLabOrdersData:Ss,fetchLabReportsData:Wa,fetchPastComplaintsData:ef,fetchPatientDetails:Ya,setClinicSettings:yc,setEditedAiMemory:xc,handleDeleteItem:wa,setCanUndo:Ji,onAiActionSuccess:cn,addMessage:Kd}),Ga&&g&&i.jsx(dE,{onClose:()=>gc(!1),patientData:af(),tokenNumber:g.patient_token_number?String(g.patient_token_number):null,onAiSummaryChange:ne=>{ne&&(d(ne),Cs(ne),gc(!1))}}),i.jsxs("div",{className:"edit-complaint-header",children:[i.jsx("button",{onClick:()=>a(-1),disabled:Ee,className:"back-button",title:"Go Back",children:"< Back"}),i.jsx("span",{ref:At,style:{position:"absolute",visibility:"hidden",height:"auto",width:"auto",whiteSpace:"nowrap"}}),g&&i.jsx("div",{className:"edit-complaint-patient-details",children:g&&!uc?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>{so(!0),oo(g.name||""),qa(g.age),ul(g.gender),fc(g.phone),Ii(null)},className:"edit-button mr-2",title:"Edit Patient Details",disabled:Xr,children:i.jsx(Gl,{size:14})}),g.name??"N/A",g.patient_token_number!==null&&g.patient_token_number!==void 0&&` (${g.patient_token_number})`," - ",g.age??"N/A"," / ",g.gender??"N/A",g.phone&&` / ${g.phone}`,i.jsx("button",{onClick:ne=>{ne.stopPropagation(),Xa()},disabled:!xo,title:"Print Patient Details",className:"icon-button small ml-2 text-gray-600 hover:text-gray-900",children:i.jsx(Qo,{size:14})})]}):g&&uc?i.jsxs("div",{className:"patient-details-edit-form",children:[i.jsx("input",{type:"text",value:vs,onChange:ne=>oo(ne.target.value),placeholder:"Name",className:"edit-input",disabled:Xr}),i.jsx("input",{type:"number",value:cl??"",onChange:ne=>qa(ne.target.value?parseInt(ne.target.value):null),placeholder:"Age",className:"edit-input",disabled:Xr}),i.jsxs("select",{value:Va??"",onChange:ne=>ul(ne.target.value||null),className:"edit-input",disabled:Xr,children:[i.jsx("option",{value:"",children:"Select Gender"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]}),i.jsx("input",{type:"text",value:dl??"",onChange:ne=>fc(ne.target.value||null),placeholder:"Phone Number",className:"edit-input",disabled:Xr}),i.jsxs("div",{className:"edit-actions",children:[i.jsx("button",{onClick:()=>{so(!1),Ii(null)},className:"button-secondary",disabled:Xr,children:"Cancel"}),i.jsx("button",{onClick:Cc,className:"button-primary blue",disabled:Xr,children:Xr?"Saving...":"Save"})]}),lo&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:lo})]}):i.jsxs("div",{className:"edit-complaint-patient-details",children:[v??"N/A"," / ",k??"N/A",i.jsx("button",{onClick:ne=>{ne.stopPropagation(),Xa()},disabled:!xo,title:"Print Patient Details",className:"icon-button small ml-2 text-gray-600 hover:text-gray-900",children:i.jsx(Qo,{size:14})})]})}),!g&&v!==void 0&&k!==void 0&&i.jsxs("div",{className:"edit-complaint-patient-details",children:[v??"N/A"," / ",k??"N/A",i.jsx("button",{onClick:ne=>{ne.stopPropagation(),Xa()},disabled:!xo,title:"Print Patient Details",className:"icon-button small ml-2 text-gray-600 hover:text-gray-900",children:i.jsx(Qo,{size:14})})]}),i.jsx("div",{style:{width:"64px"}})]}),i.jsxs("div",{className:"edit-complaint-content-area",ref:vr,children:[pl.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"edit-complaint-chat-column",style:{width:"30%",minWidth:"320px",maxWidth:"40%",flexShrink:0},children:i.jsx(Nte,{messages:pl})}),i.jsx("div",{className:"draggable-divider",onMouseDown:()=>{}})]}),i.jsxs("div",{ref:St,className:"edit-complaint-main-column",style:{flex:1,minWidth:0},children:[ae&&i.jsxs("div",{className:"general-error-message",children:["Error: ",ae]}),(ce||I)&&i.jsxs("div",{ref:ge,className:`${I?"ai-function-call-block":"ai-response-container"} group`,children:[ce&&i.jsx(Vs,{remarkPlugins:[ds],children:ce}),I&&i.jsxs("div",{className:"ai-json-details-container",children:[i.jsxs("button",{onClick:()=>W(!fe),className:"ai-json-toggle-button",children:[fe?i.jsx(FN,{size:14,className:"mr-1"}):i.jsx(LN,{size:14,className:"mr-1"}),fe?"Hide":"Show"," AI Function Call Details"]}),fe&&i.jsx("pre",{className:"ai-json-pre",children:i.jsx("code",{children:JSON.stringify(JSON.parse(I),null,2)})})]}),i.jsxs("div",{className:"ai-response-actions",children:[i.jsx("button",{onClick:()=>rf(le),disabled:!le,title:"Copy Full AI Response",children:i.jsx(U3,{size:12})}),i.jsx("button",{onClick:np,disabled:!le,title:"Print AI Response",children:i.jsx(Qo,{size:12})})]})]})]}),i.jsx("div",{className:"draggable-divider",onMouseDown:Ka}),i.jsx("div",{ref:Ft,className:"edit-complaint-context-column",style:{flexBasis:`calc(${100-gn}% - 5px)`},children:i.jsxs("div",{className:"ai-context-container",children:[i.jsxs("h3",{className:"ai-context-header",children:[i.jsx("span",{children:"AI Context:"}),(g==null?void 0:g.insurance_type)&&i.jsx("div",{className:"insurance-type-container mt-2",children:i.jsxs("select",{ref:dt,value:g.insurance_type,onChange:ne=>Xh(g.id,ne.target.value),className:"insurance-type-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"insurance",children:"Insurance"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})})]}),i.jsxs("div",{ref:Ht,className:"ai-context-section",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Admission Status"}),(g==null?void 0:g.admission_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Admitted:"})," ",new Date(g.admission_date).toLocaleDateString()]}),(g==null?void 0:g.discharge_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Discharged:"})," ",new Date(g.discharge_date).toLocaleDateString()]}),(g==null?void 0:g.current_status)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Current Status:"})," ",i.jsx("span",{className:"font-semibold",children:g.current_status})]}),i.jsxs("div",{className:"flex space-x-2 mt-2",children:[i.jsx("button",{onClick:un,className:`admit-discharge-button ${ao?"discharge":"admit"}`,title:ao?"Discharge Patient":"Admit Patient",disabled:!u||lc||io,children:lc?"Admitting...":io?"Discharging...":ao?"Discharge":"Admit"}),i.jsx("button",{onClick:()=>cr("doctor"),className:`queue-status-button ${Pi?"in-queue":"add-to-queue"}`,title:Pi?"Patient is in Doctor Queue":"Add Patient to Doctor Queue",disabled:!u||xs||Pi,children:xs?"Adding...":Pi?"In Queue":"Add to Queue"}),i.jsx("button",{onClick:dn,className:"complete-consultation-button",title:"Mark Consultation as Complete",disabled:ol,children:ol?"Completing...":"Complete Consultation"})]})]}),i.jsx("div",{ref:we,children:i.jsx(R0,{title:"Pharmacy Order History",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:yo,className:"button-primary blue text-xs px-2 py-1",disabled:ml||ot.filter(ne=>ne.status==="pending").length<2,title:"Merge all pending orders into one",children:ml?"Merging...":"Merge Orders"}),i.jsxs("button",{onClick:()=>sl(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new pharmacy order",disabled:!u,children:[i.jsx(Zo,{size:12,className:"mr-1"})," Create Order"]})]}),items:Ki,isLoading:!1,loadingText:"Loading...",noDataText:"No orders.",renderItemContent:(ne,me)=>i.jsxs("div",{className:"flex flex-col w-full",children:[i.jsxs("span",{className:"ai-context-text flex items-center",children:[" ",Ki.length-me,". Order Status: (",ne.data.status,")",i.jsx("span",{className:"text-gray-400 ml-1 flex items-center",children:Jd===ne.data.id?i.jsx("div",{className:"flex items-center space-x-1 ml-1",children:i.jsx("input",{type:"datetime-local",defaultValue:Q0(ne.originalDateString),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:he=>{he.target.value&&Ns(ne.data.id,he.target.value),dc(null)},onKeyDown:he=>{if(he.key==="Enter"){const Ce=he.target;Ce.value&&Ns(ne.data.id,Ce.value),dc(null)}},autoFocus:!0})}):i.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/date ml-1",onClick:()=>dc(ne.data.id),title:"Click to edit date",children:["(",new Date(ne.originalDateString).toLocaleDateString(),")",i.jsx(Gl,{size:14,className:"ml-1 text-gray-500 hover:text-gray-700"})]})}),i.jsxs("div",{className:"inline-flex space-x-2 ml-2",children:[" ",i.jsx("button",{onClick:()=>bl(ne.data.id),className:"icon-button small",title:"Edit Pharmacy Order",children:i.jsx(Gl,{size:12})}),ne.data.prescriptionForUnavailableDrugs&&i.jsx("button",{onClick:()=>Nl(ne.data.prescriptionForUnavailableDrugs,"Unavailable Drugs Prescription"),className:"icon-button small",title:"Print Unavailable Drugs Prescription",children:i.jsx(Qo,{size:12})}),i.jsx("button",{onClick:()=>wa({type:"Pharmacy Order",data:ne.data}),className:"icon-button small text-red-500",title:"Delete Pharmacy Order",children:i.jsx(Ur,{size:12})}),ne.data.status==="pending"&&i.jsx("button",{onClick:()=>wc(ne.data.id),className:"icon-button small",title:"Bill this pharmacy order",disabled:ro,children:i.jsx(Rh,{size:12})}),ne.data.status==="billed"&&i.jsx("button",{onClick:()=>Su(ne.data.id,"dispensed"),className:"icon-button small",title:"Dispense this pharmacy order",disabled:ro,children:i.jsx(ps,{size:12})})]})]}),i.jsx("div",{className:"pharmacy-order-drugs-table-container mt-2 cursor-pointer hover:bg-gray-50 transition-colors rounded p-1",onClick:()=>bl(ne.data.id),title:"Click to edit order",children:i.jsxs("table",{className:"pharmacy-order-drugs-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2 text-left",children:"Drug Name"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Quantity"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Dosage"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Directions"})]})}),i.jsx("tbody",{children:ne.data.medications.map((he,Ce)=>i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:i.jsx("strong",{children:he.name})}),i.jsxs("td",{className:"py-1 px-2",children:[he.pack_quantity!==void 0&&he.pack_quantity>0&&`Packs: ${he.pack_quantity}`,he.pack_quantity!==void 0&&he.pack_quantity>0&&he.loose_quantity!==void 0&&he.loose_quantity>0&&", ",he.loose_quantity!==void 0&&he.loose_quantity>0&&`Loose: ${he.loose_quantity}`]}),i.jsx("td",{className:"py-1 px-2",children:he.tabletsPerDay&&he.numberOfDays?`${he.tabletsPerDay} tab/day for ${he.numberOfDays} days`:"N/A"}),i.jsx("td",{className:"py-1 px-2",children:he.directions_to_use||"N/A"})]},he.drug_id||he.name||Ce))})]})}),ne.data.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[i.jsx("span",{className:"font-semibold",children:"Prescription:"})," ",ne.data.prescriptionForUnavailableDrugs]})]})})}),oc&&i.jsx(Ste,{isOpen:oc,onClose:()=>sl(!1),patientId:u,pharmacyInventory:Ei,fetchPharmacyOrdersData:po}),i.jsxs("div",{ref:xe,children:[i.jsx(R0,{title:"Lab History (Orders & Reports)",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:Ve,className:"button-primary blue text-xs px-2 py-1",title:"Tell AI to analyse the reports",disabled:Ye,children:"Analyse Reports"}),i.jsxs("button",{onClick:()=>sc(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new lab order",disabled:!u,children:[i.jsx(Zo,{size:12,className:"mr-1"})," Create Lab Order"]})]}),items:Ri,onDeleteItem:wa,onEditLabOrder:tf,onSaveLabOrder:go,onCancelEditLabOrder:Sc,onLabOrderTestChange:Qa,onLabOrderStatusChange:Zh,onBillLabOrder:nf,onUpdateLabOrderStatus:ti,onEnterLabReport:vl,labInventory:vu,isSavingLabOrder:ro,isLoading:za||Ze,loadingText:"Loading...",noDataText:"No lab Hx.",expandedLabReports:ac,toggleLabReport:pt,renderItemContent:(ne,me)=>{const he=WW(ne.data.report?ne.data.report.status:ne.data.status);return i.jsxs("div",{className:"ai-context-text",children:[i.jsxs("div",{onClick:()=>vl(ne.data),className:"cursor-pointer hover:bg-gray-100 rounded p-1 inline-block -ml-1",title:"Click to enter report",children:[ne.data.serialNumber,". ",i.jsx("span",{className:"font-medium",children:"[Order]"})," ",ne.data.tests&&ne.data.tests.length>0?ne.data.tests.map(Ce=>i.jsxs("strong",{children:[Ce.name," (",Ce.price,")"]},Ce.id||Ce.name)).reduce((Ce,Je)=>[Ce,", ",Je]):i.jsx("span",{className:"italic text-gray-500",children:"No tests specified"})," ",ne.data.tests&&ne.data.tests.length>0&&i.jsxs("span",{className:"font-bold ml-2",children:["Total: ",ne.data.tests.reduce((Ce,Je)=>Ce+(Number(Je.price)||0),0).toFixed(2)]}),"(",i.jsx("span",{className:he.className,children:he.text}),")"]}),i.jsx("span",{className:"text-gray-400 ml-1 inline-flex items-center",children:Ha===ne.data.id?i.jsx("div",{className:"flex items-center space-x-1 ml-1",onClick:Ce=>Ce.stopPropagation(),children:i.jsx("input",{type:"datetime-local",defaultValue:Q0(ne.originalDateString),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:Ce=>{Ce.target.value&&xl(ne.data.id,"order",Ce.target.value),fl(null)},onKeyDown:Ce=>{if(Ce.key==="Enter"){const Je=Ce.target;Je.value&&xl(ne.data.id,"order",Je.value),fl(null)}},autoFocus:!0})}):i.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/date ml-1",onClick:Ce=>{Ce.stopPropagation(),fl(ne.data.id)},title:"Click to edit order date",children:["(",new Date(ne.originalDateString).toLocaleDateString(),")",i.jsx(Gl,{size:14,className:"ml-1 text-gray-500 hover:text-gray-700"})]})}),ne.data.report&&i.jsxs("div",{className:"ml-4 mt-1 p-2 border-l-2 border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-medium",children:"[Report]"}),i.jsx("span",{className:"text-gray-400 ml-1 flex items-center",children:hc===ne.data.id?i.jsx("div",{className:"flex items-center space-x-1 ml-1",onClick:Ce=>Ce.stopPropagation(),children:i.jsx("input",{type:"datetime-local",defaultValue:Q0(ne.data.report.report_date),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:Ce=>{Ce.target.value&&xl(ne.data.id,"report",Ce.target.value),pc(null)},onKeyDown:Ce=>{if(Ce.key==="Enter"){const Je=Ce.target;Je.value&&xl(ne.data.id,"report",Je.value),pc(null)}},autoFocus:!0})}):i.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/reportDate ml-1",onClick:Ce=>{Ce.stopPropagation(),pc(ne.data.id)},title:"Click to edit report date",children:["(",new Date(ne.data.report.report_date).toLocaleDateString(),")",i.jsx(Gl,{size:14,className:"ml-1 text-gray-500 hover:text-gray-700"})]})}),i.jsx("button",{onClick:()=>pt(ne.data.report.reportId),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:ac[ne.data.report.reportId]?"Collapse Report":"Expand Report",children:ac[ne.data.report.reportId]?i.jsx(FN,{size:14}):i.jsx(LN,{size:14})})]}),ac[ne.data.report.reportId]&&(()=>{try{const Ce=JSON.parse(ne.data.report.report_content||"{}");return typeof Ce=="object"&&Ce!==null&&ne.data.report.tests?ne.data.report.tests.map(Je=>i.jsxs("div",{style:{marginBottom:"10px"},children:[i.jsx("h5",{className:"font-semibold text-sm mt-2 mb-1",children:Je.name}),Ce[Je.id]?i.jsxs("table",{className:"lab-inventory-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2",children:"Parameter"}),i.jsx("th",{className:"py-1 px-2",children:"Value"}),i.jsx("th",{className:"py-1 px-2",children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(Ce[Je.id]).map(([ht,jt])=>{var Yn;const Ct=(Yn=Je.default_parameters)==null?void 0:Yn.find(Hr=>Hr.name===ht);return i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:ht}),i.jsxs("td",{className:"py-1 px-2",children:[String(jt)," ",(Ct==null?void 0:Ct.unit)||""]}),i.jsx("td",{className:"py-1 px-2",children:(()=>{if(Ct&&Ct.type==="number"&&(Ct.lower_limit!=null||Ct.upper_limit!=null)){let Hr="";return Ct.lower_limit!=null&&(Hr+=` > ${Ct.lower_limit}`),Ct.lower_limit!=null&&Ct.upper_limit!=null&&(Hr+=" - "),Ct.upper_limit!=null&&(Hr+=` < ${Ct.upper_limit}`),Hr.trim()||"N/A"}else if((Ct==null?void 0:Ct.type)==="boolean")return"N/A";return(Ct==null?void 0:Ct.normal_range)||"N/A"})()})]},ht)})})]}):i.jsx("p",{className:"italic text-gray-500 text-xs",children:"No parameters reported for this test."})]},Je.id)):i.jsx(Vs,{remarkPlugins:[ds],children:ne.data.report.report_content})}catch{return i.jsx(Vs,{remarkPlugins:[ds],children:ne.data.report.report_content||"*No findings recorded.*"})}})()]})]})}}),i.jsx(wQ,{isOpen:Jr,onClose:()=>sc(!1),patientId:u,labInventory:vu,fetchPendingLabOrdersData:Ss}),i.jsx("div",{ref:Me,children:i.jsx(R0,{title:"Complaints History",items:Ja,isLoading:Be,loadingText:"Loading...",noDataText:"No past Hx.",renderItemContent:(ne,me)=>i.jsxs("span",{className:"ai-context-text",children:[ne.data.complaint,i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(ne.originalDateString).toLocaleDateString(),")"]})]}),onDeleteItem:wa})}),i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("h4",{className:"ai-context-section-title",children:[i.jsx(jb,{size:16,className:"text-purple-600"})," Clinic-wide System Prompt"]}),!bc&&i.jsx("button",{onClick:ui,className:"edit-button",title:"Edit System Prompt",disabled:Vr||Sr||va,children:i.jsx(Gl,{size:14})})]}),bc&&wn?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:fo,onChange:ne=>ho(ne.target.value),className:"context-edit-textarea",placeholder:"Enter clinic system prompt...",disabled:Sr||va}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:ju,disabled:Sr||va,className:"button-secondary",children:"Cancel"}),i.jsxs("button",{onClick:Xi,disabled:Sr||va||gl===wn.aiMemory&&fo===wn.clinicWideSystemPrompt,className:"button-primary purple",children:[i.jsx(Fd,{size:14,className:"mr-1"}),va||Sr?"Saving...":"Save Settings"]})]})]}):i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:wn!=null&&wn.clinicWideSystemPrompt?i.jsx(Vs,{remarkPlugins:[ds],children:wn.clinicWideSystemPrompt}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),!bc&&(wn==null?void 0:wn.clinicWideSystemPromptUpdatedAt)&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Prompt Last Updated: ",new Date(wn.clinicWideSystemPromptUpdatedAt).toLocaleDateString()]})]}),i.jsxs("div",{ref:De,className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Case Summary"}),!R&&i.jsx("button",{onClick:ep,className:"edit-button",title:"Edit Case Summary",disabled:te||U,children:i.jsx(Gl,{size:14})})]}),R?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:F,onChange:ne=>L(ne.target.value),className:"context-edit-textarea",rows:4,placeholder:"Enter case summary...",disabled:U}),J&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:J}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:tp,disabled:U,className:"button-secondary",children:"Cancel"}),i.jsx("button",{onClick:ni,disabled:U||F===A,className:"button-primary blue",children:U?"Saving...":"Save"})]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:A?i.jsx(Vs,{remarkPlugins:[ds],components:{},children:A}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),$&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Last Edited: ",new Date($).toLocaleDateString()]})]})]}),Ja.length===0&&Ri.length===0&&Ki.length===0&&!(Be||za||Ze)&&i.jsx("p",{className:"ai-context-text italic mt-4",children:"No recent history for this patient."}),al&&i.jsx("p",{className:"text-yellow-600 text-xs mt-2 ai-context-text",children:"Deleting..."}),rc&&i.jsx("p",{className:"text-red-600 text-xs mt-2 ai-context-text",children:rc})]})]})})]}),i.jsxs("div",{className:"edit-complaint-input-area",children:[i.jsx("div",{className:"mobile-section-selector",children:i.jsxs("div",{className:"selector-container",children:[i.jsx("button",{onClick:()=>_s("response"),className:`selector-button ${Jn==="response"?"active":""}`,children:"AI Response"}),i.jsx("button",{onClick:()=>_s("context"),className:`selector-button ${Jn==="context"?"active":""}`,children:"AI Context"})]})}),i.jsxs("div",{className:"status-messages-container",children:[lt&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:lt}),Ne&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Ne}),Ai&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Ai}),tc&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:tc})]}),t&&!Y&&i.jsxs(w.Fragment,{children:[Nu&&i.jsxs("div",{className:"follow-up-question-container",children:[i.jsx("p",{className:"question-text",children:Nu}),Sa.length>0&&i.jsx("div",{className:"options-grid",children:Sa.map((ne,me)=>i.jsx("button",{onClick:()=>Za(ne),className:"option-button",children:ne},me))})]}),$r&&i.jsx("div",{className:"speech-error-display",children:$r}),uo&&i.jsxs("div",{className:"selected-file-display",children:[i.jsxs("span",{children:["Selected: ",uo.name]}),i.jsx("button",{onClick:()=>{mc(null),Hn.current&&(Hn.current.value="")},className:"remove-file-button",title:"Remove image",children:""})]}),i.jsx("div",{className:"input-wrapper",children:i.jsxs("div",{className:"main-input-container",children:[i.jsx("input",{type:"file",ref:Hn,onChange:rp,accept:"image/*",className:"hidden"}),i.jsx("textarea",{ref:He,className:"complaint-textarea",value:l,onChange:ne=>d(ne.target.value),onKeyDown:Dt,placeholder:"name,age,sex,phone,complaints,reports,history",disabled:Ee||!t||xn}),i.jsxs("div",{className:"chat-input-actions-container",children:[u&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>a(`/patient/${u}/lab-reports`),disabled:Ze||!u,className:"icon-button",title:"View Lab Reports",children:i.jsx(du,{size:14})}),i.jsx("button",{onClick:()=>a("/inventory"),disabled:nl,className:"icon-button",title:"View Inventory",children:i.jsx(Ld,{size:14})})]}),i.jsx("button",{type:"button",onClick:_c,disabled:Ee||!t||xn,className:"icon-button",title:"Attach Image",children:i.jsx(Tk,{size:14})}),i.jsx("button",{type:"button",onClick:ri,disabled:Ee||!t||!hl.current,className:`mic-button ${xn?"listening":""}`,title:xn?"Stop":"Mic",children:i.jsx(kk,{size:14})}),i.jsx("button",{onClick:()=>Cs(),disabled:Ee||!l.trim()||!t||xn,className:"send-button",title:Ee?"Processing...":"Save & Ask AI",children:Ee?i.jsx("div",{className:"custom-loader-circle",role:"status","aria-label":"loading"}):i.jsx(u1,{size:14})}),Gn&&i.jsx("button",{type:"button",onClick:Kh,disabled:Ee,className:"icon-button text-red-500",title:"Undo Last AI Actions",children:i.jsx(Ur,{size:14})})]})]})})]})]})]})},Cte=()=>{const{patientId:e}=Gi(),n=Et(),[t,r]=w.useState([]),[a,o]=w.useState(null),[l,d]=w.useState(!1),[f,u]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){u("Patient ID not provided.");return}d(!0),u(null);try{const b=await pe(`/api/patients/${e}`);if(!b.ok)throw new Error(`Failed to fetch patient details: ${b.status}`);const v=await b.json();o({name:v.name,age:v.age,gender:v.gender});const S=await pe(`/api/patients/${e}/complaints`);if(S.ok){const T=(await S.json()).sort((A,M)=>new Date(M.createdAt).getTime()-new Date(A.createdAt).getTime());r(T)}else if(S.status===404)r([]);else throw new Error(`Failed to fetch complaints: ${S.status}`)}catch(b){console.error("Error fetching past complaints or patient info:",b),u(`Failed to load data. ${b.message}`),r([]),o(null)}finally{d(!1)}})()},[e]);const p=g=>{navigator.clipboard.writeText(g).then(()=>console.log("Complaint copied to clipboard")).catch(b=>console.error("Failed to copy complaint: ",b))};return i.jsxs("div",{className:"container mx-auto p-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-1 px-3 rounded text-sm",children:"< Back"}),i.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-center flex-grow",children:"Past Complaints"}),i.jsx("div",{className:"w-16"})," "]}),a&&i.jsxs("div",{className:"mb-4 p-2 bg-gray-100 rounded text-center text-sm sm:text-base",children:["Patient: ",i.jsx("strong",{children:a.name})," (",a.age??"N/A"," / ",a.gender??"N/A",")"]}),f&&i.jsxs("div",{className:"text-red-500 p-3 mb-4 border border-red-500 rounded bg-red-50 text-sm",children:["Error: ",f]}),l&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading..."}),!l&&t.length===0&&!f&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No past complaints found for this patient."}),!l&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(g=>i.jsxs("div",{className:"p-3 border rounded shadow-sm bg-white group relative",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:new Date(g.createdAt).toLocaleString()}),i.jsx("p",{className:"text-sm whitespace-pre-wrap",children:g.complaint}),i.jsx("button",{onClick:()=>p(g.complaint),className:"absolute top-1 right-1 bg-gray-200 hover:bg-gray-300 text-gray-600 text-xs p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Copy complaint text",children:""})]},g.id))})]})},Ix=500,Rj="defaultConsultationFee",_te=({patientId:e,billId:n,queueId:t,onBillCreated:r,onBillUpdated:a,initialItems:o=[],billType:l="other",relatedId:d,initialStatus:f="pending",initialDiscountPercentage:u=0,readOnlyMode:p=!1,doctorId:g,labOrderId:b,patientInsuranceType:v})=>{const[S,k]=w.useState(null),[T,A]=w.useState([]),M=w.useRef([]),[R,z]=w.useState(""),[F,L]=w.useState(""),[U,B]=w.useState(1),[J,D]=w.useState(u),[$,H]=w.useState("cash"),[te,Q]=w.useState(!1),[Y,V]=w.useState(null),[ae,re]=w.useState(!1),[le,E]=w.useState(!1),[ce,ue]=w.useState(!1),[I,de]=w.useState(null),[,fe]=w.useState([]),[W,oe]=w.useState(null),[se,je]=w.useState(""),[We,X]=w.useState("cash"),[Se,Ae]=w.useState(!1),[Pe,Ze]=w.useState(Ix),[rt,lt]=w.useState(Ix.toString()),ze=n?"view_pay":"create";w.useEffect(()=>{const xe=localStorage.getItem(Rj),Me=xe?parseFloat(xe):Ix;isNaN(Me)||(Ze(Me),lt(Me.toString()))},[]);const ot=o.length===0;w.useEffect(()=>{e?(async()=>{Q(!0),V(null);try{const Me=await pe(`/api/patients/${e}`);if(!Me.ok){const qe=await Me.json().catch(()=>({}));throw new Error(qe.message||"Failed to fetch patient details")}const De=await Me.json();k(De)}catch(Me){V(`Failed to load patient details: ${Me.message}`),k(null)}finally{Q(!1)}})():k(null)},[e]),w.useEffect(()=>{n?(async()=>{ue(!0),V(null),de(null),fe([]),oe(null);try{const Me=await pe(`/api/bills/${n}`);if(!Me.ok){const qe=await Me.json().catch(()=>({}));throw new Error(qe.message||"Failed to fetch bill details")}const De=await Me.json();if(!De.bill||!De.payments||!De.calculated)throw new Error("Invalid bill details structure.");de(De.bill),fe(De.payments),oe(De.calculated),D(De.bill.discount_percentage!==void 0&&De.bill.discount_percentage!==null?parseFloat(De.bill.discount_percentage.toString()):0),!S&&De.bill.patient_id&&at(De.bill.patient_id.toString())}catch(Me){V(`Failed to load bill details: ${Me.message}`),de(null),fe([]),oe(null)}finally{ue(!1)}})():(de(null),fe([]),oe(null))},[n]);const at=async xe=>{Q(!0);try{const Me=await pe(`/api/patients/${xe}`);if(!Me.ok)throw new Error("Failed to fetch patient");const De=await Me.json();k(De)}catch(Me){console.error("Error fetching patient details:",Me),k(null)}finally{Q(!1)}},be=w.useCallback(async xe=>{E(!0),V(null);const Me=xe.filter(De=>De.drug_id!=null).map(async De=>{try{const qe=await pe(`/api/drugs/${De.drug_id}`);if(!qe.ok)throw new Error(`Drug ${De.drug_id} not found.`);const st=await qe.json();return{...De,price:st.price,total:st.price*De.quantity}}catch{return V(st=>`${st?st+"; ":""}Failed to fetch price for ${De.name}`),De}});try{const De=await Promise.all(Me);A(qe=>{const st=new Map(De.map(yt=>[yt.id,yt]));return qe.map(yt=>st.get(yt.id)||yt)})}catch{}finally{E(!1)}},[pe]);w.useEffect(()=>{if(n){A([]),M.current=[];return}JSON.stringify(o)===JSON.stringify(M.current)||(async()=>{let De=[];if(o&&o.length>0)De=o.map((qe,st)=>({...qe,id:`initial-${st}-${Date.now()}`})),H(f==="paid"?"cash":v==="no_cash_insurance"?"no_cash_insurance":"cash"),D(u),l==="pharmacy"&&!p&&await be(De);else if(e&&ot&&l==="consultation"){let qe=Pe;if(g)try{const st=await pe(`/api/staff/${g}`);if(!st.ok){const _t=await st.json().catch(()=>({}));throw new Error(_t.message||"Doctor not found or error fetching fee")}const yt=await st.json();yt.opd_fee!=null&&!isNaN(parseFloat(String(yt.opd_fee)))&&parseFloat(String(yt.opd_fee))>=0&&(qe=parseFloat(String(yt.opd_fee)))}catch(st){V(yt=>`${yt?yt+"; ":""}Could not fetch doctor's fee, using default. (${st.message})`)}De=[{id:Date.now(),name:"Consultation Fee",price:qe,quantity:1,total:qe*1,drug_id:null}],H(v==="no_cash_insurance"?"no_cash_insurance":"cash")}else De=[],H(v==="no_cash_insurance"?"no_cash_insurance":"cash");A(De),M.current=o})()},[n,e,g,o,l,Pe,ot,f,p,be,u,v]);const $e=()=>{const xe=parseFloat(F);if(!p)if(R&&!isNaN(xe)&&xe>=0&&U>0){if(R.trim().toLowerCase()==="consultation fee"&&T.some(De=>De.name.toLowerCase()==="consultation fee")){alert("Consultation Fee already added.");return}const Me={id:Date.now(),name:R.trim(),price:xe,quantity:U,total:xe*U,drug_id:null};A([...T,Me]),z(""),L(""),B(1)}else alert("Invalid item details.")},Be=xe=>{p||A(T.filter(Me=>Me.id!==xe))},ke=w.useMemo(()=>{let xe=T.reduce((Me,De)=>Me+De.total,0);return ze==="create"&&J>0&&(xe=xe*(1-J/100)),(W==null?void 0:W.totalDue)!==void 0&&(W==null?void 0:W.totalDue)!==null?W.totalDue:xe},[T,W,J,ze]),Ne=w.useMemo(()=>(W==null?void 0:W.totalPaid)??0,[W]),K=w.useMemo(()=>(W==null?void 0:W.balance)!==void 0&&(W==null?void 0:W.balance)!==null?W.balance:ke-Ne,[W,ke,Ne]),ge=()=>{const xe=parseFloat(rt);!isNaN(xe)&&xe>=0?(Ze(xe),localStorage.setItem(Rj,xe.toString()),alert(`Default Fee set to ${xe.toFixed(2)}`)):alert("Invalid fee amount.")},He=async(xe,Me)=>{re(!0),V(null);try{const De=await pe("/api/payment/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Me,billId:xe})}),qe=await De.json();if(!De.ok||!qe.order)throw new Error(qe.message||"Failed to create Razorpay order.");const{key_id:st,order:yt}=qe,_t={key:st,amount:yt.amount,currency:yt.currency,name:"Newtons Ai HMS Clinic",description:`Bill Payment for Patient ID: ${e}`,order_id:yt.id,handler:async function(cn){try{const gn=await pe("/api/payment/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({razorpay_payment_id:cn.razorpay_payment_id,razorpay_order_id:cn.razorpay_order_id,razorpay_signature:cn.razorpay_signature,billId:xe})}),Cn=await gn.json();if(gn.ok&&Cn.success)alert("Payment Successful!"),r&&r(xe),a&&a(),setTimeout(()=>window.print(),200);else throw new Error(Cn.message||"Payment verification failed.")}catch(gn){V(`Payment verification failed: ${gn.message}. Contact support.`)}finally{re(!1)}},prefill:{name:(S==null?void 0:S.name)||""},notes:{bill_id:xe,patient_id:e},theme:{color:"#3399cc"},modal:{ondismiss:function(){V("Payment cancelled."),re(!1)}}};if(window.Razorpay)new window.Razorpay(_t).open();else throw new Error("Razorpay SDK not loaded.")}catch(De){V(`Failed to initiate online payment: ${De.message}`),re(!1)}},Qe=async()=>{if(!n){V("Bill ID is missing.");return}if(!se||isNaN(parseFloat(se))||parseFloat(se)<=0){V("Please enter a valid positive payment amount.");return}Ae(!0),V(null);const xe={amount_paid:parseFloat(se),payment_mode:We};try{const Me=await pe(`/api/bills/${n}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(xe)}),De=await Me.json();if(!Me.ok)throw new Error(De.message||`Failed to record payment (Status: ${Me.status})`);alert(`Payment of ${xe.amount_paid.toFixed(2)} recorded.`),je(""),a?a():console.log("Payment recorded.")}catch(Me){V(`Failed to record payment: ${Me.message}`)}finally{Ae(!1)}},dt=async()=>{if(ze==="view_pay")return;if(!e){V("Patient ID is missing for creating a bill.");return}if(T.length===0){V("Cannot finalize an empty bill.");return}re(!0),V(null);const xe=ke,Me=T.map(({id:De,...qe})=>qe);if($==="online"){const De={patientId:e,queueId:t||null,items:Me,amount:xe,paymentMode:"online",type:l,related_id:d||b||null,status:"pending",discountPercentage:J,labOrderId:b||null};try{const qe=await pe("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(De)}),st=await qe.json();if(!qe.ok)throw new Error(st.message||"Failed to create pending bill.");He(st.id,Math.round(xe*100))}catch(qe){V(`Failed to create pending bill: ${qe.message}`),re(!1)}}else{const De="paid";if(!$){V("Payment mode required."),re(!1);return}const qe={patientId:e,queueId:t||null,items:Me,amount:xe,paymentMode:$,type:l,related_id:d||b||null,status:De,discountPercentage:J,labOrderId:b||null};setTimeout(()=>window.print(),200);try{const st=await pe("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(qe)}),yt=await st.json();if(!st.ok)throw new Error(yt.message||"Failed to create bill.");alert("Bill marked as paid!"),r&&r(yt.id),re(!1)}catch(st){V(`Failed to process bill: ${st.message}`),re(!1)}}},At=(I==null?void 0:I.type)??l,Ht=(I==null?void 0:I.status)??f,we=ze==="view_pay"&&I&&Ht==="pending";return!e&&!n?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow text-gray-500",children:"Select patient or provide Bill ID."}):te||ze==="view_pay"&&ce?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow",children:"Loading..."}):ze==="view_pay"&&!I&&!ce&&Y?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading bill: ",Y]}):ze==="create"&&!S&&!te&&Y?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading patient: ",Y]}):i.jsxs("div",{className:"billing-component-container printable-section",children:[i.jsxs("div",{className:"billing-header",children:[i.jsx("h2",{children:ze==="create"?"Create Bill":"Bill Details"}),ze==="create"&&l==="consultation"&&!p&&i.jsxs("div",{className:"default-fee-section",children:[i.jsx("label",{htmlFor:"defaultFee",className:"whitespace-nowrap",children:"Default Fee:"}),i.jsx("input",{id:"defaultFee",type:"number",value:rt,onChange:xe=>lt(xe.target.value),className:"",placeholder:Ix.toString(),disabled:p}),i.jsx("button",{onClick:ge,title:"Set Default Fee",className:"",disabled:p,children:i.jsx(Fd,{size:16})})]})]}),Y&&!ce&&!Se&&i.jsxs("div",{className:"error-message",role:"alert",children:[i.jsx("strong",{children:"Error: "}),Y]}),S&&i.jsxs("div",{className:"patient-details-section",children:[i.jsx("h3",{children:"Patient Details"}),i.jsxs("p",{children:[i.jsx("strong",{children:"ID:"})," ",S.id]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",S.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Age:"})," ",S.age||"N/A",", ",i.jsx("strong",{children:"Gender:"})," ",S.gender||"N/A"]})]}),i.jsxs("div",{className:"bill-items-summary-section",children:[i.jsxs("div",{className:"bill-items-header",children:[i.jsx("h3",{children:ze==="create"?"Bill Items":"Billing Summary"}),ze==="create"&&l==="pharmacy"&&!p&&T.some(xe=>xe.drug_id!=null)&&i.jsxs("button",{onClick:()=>be(T),disabled:le,className:"refresh-prices-button",title:"Refresh item prices from inventory",children:[i.jsx(h1,{size:14,className:`lucide ${le?"animate-spin":""}`}),le?"Refreshing...":"Refresh"]})]}),ze==="view_pay"&&I&&i.jsxs("div",{className:"bill-info-bar",children:[i.jsxs("span",{children:["Bill ID: ",i.jsx("strong",{children:I.id})]}),i.jsxs("span",{children:["Type: ",i.jsx("strong",{className:"capitalize",children:At})]}),i.jsxs("span",{children:["Status: ",i.jsx("strong",{className:`capitalize ${Ht==="paid"?"status-paid":"status-pending"}`,children:Ht})]})]}),(ze==="create"||ze==="view_pay"&&I)&&i.jsxs("div",{className:"bill-items-list",children:[ze==="create"&&le&&T.length>0&&i.jsx("div",{className:"loading-placeholder",children:"Updating prices..."}),ze==="create"&&!le&&T.map((xe,Me)=>i.jsxs("div",{className:"bill-item",children:[i.jsxs("div",{className:"bill-item-details",children:[i.jsxs("span",{children:[Me+1,". ",xe.name]}),xe.quantity>1&&i.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",xe.quantity,")"]})]}),i.jsxs("div",{className:"bill-item-price-actions",children:[i.jsxs("span",{className:"bill-item-price",children:["",xe.total.toFixed(2)]}),ze==="create"&&typeof xe.id=="number"&&!p&&i.jsxs("button",{onClick:()=>Be(xe.id),className:"remove-item-button",title:"Remove",children:[" ",i.jsx(zn,{size:16})," "]}),(typeof xe.id!="number"||p||xe.name==="Consultation Fee")&&i.jsxs("span",{className:"lock-icon",title:"Cannot remove",children:[" ",i.jsx($N,{size:14})," "]})]})]},xe.id)),ze==="view_pay"&&I&&I.items.map((xe,Me)=>i.jsxs("div",{className:"bill-item",children:[i.jsxs("div",{className:"bill-item-details",children:[i.jsxs("span",{children:[Me+1,". ",xe.name]}),xe.quantity>1&&i.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",xe.quantity,")"]})]}),i.jsxs("div",{className:"bill-item-price-actions",children:[i.jsxs("span",{className:"bill-item-price",children:["",(xe.total??xe.price*xe.quantity).toFixed(2)]}),i.jsxs("span",{className:"lock-icon",title:"Cannot remove from existing bill",children:[" ",i.jsx($N,{size:14})," "]})]})]},Me)),ze==="create"&&T.length===0&&i.jsx("p",{className:"empty-items-message",children:"No items added."}),ze==="view_pay"&&I&&I.items.length===0&&i.jsx("p",{className:"empty-items-message",children:"No items in bill."})]}),ze==="create"&&!p&&i.jsxs("div",{className:"add-item-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Item"}),i.jsx("input",{type:"text",value:R,onChange:xe=>z(xe.target.value),placeholder:"Service/Item",className:"custom-text-input"})]}),i.jsxs("div",{className:"form-group",style:{flexGrow:.5,minWidth:"80px"},children:[i.jsx("label",{children:"Qty"}),i.jsx("input",{type:"number",min:"1",value:U,onChange:xe=>B(parseInt(xe.target.value)||1),placeholder:"1",className:"custom-text-input"})]}),i.jsxs("div",{className:"form-group",style:{flexGrow:.7,minWidth:"100px"},children:[i.jsx("label",{children:"Price ()"}),i.jsx("input",{type:"number",value:F,onChange:xe=>L(xe.target.value),placeholder:"0.00",className:"custom-text-input"})]}),i.jsx("button",{onClick:$e,className:"add-item-button",children:"Add"})]})]})," ",i.jsxs("div",{className:"billing-footer",children:[i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Total Amount:"}),i.jsxs("span",{className:"total-amount-value",children:["",typeof ke=="number"?ke.toFixed(2):"0.00"]}),ze==="create"&&!p&&i.jsxs("div",{className:"discount-section",children:[i.jsx("label",{htmlFor:"discountPercentage",className:"whitespace-nowrap",children:"Discount (%):"}),i.jsx("input",{id:"discountPercentage",type:"number",min:"0",max:"100",step:"0.01",value:J,onChange:xe=>D(parseFloat(xe.target.value)||0),className:"",disabled:p||ae})]}),ze==="view_pay"&&I&&(I.status==="pending"||I.status==="paid")&&i.jsxs("div",{className:"discount-section",children:[i.jsx("label",{className:"whitespace-nowrap",children:"Discount (%):"}),i.jsxs("span",{className:"discount-value",children:[J.toFixed(2),"%"]})]})]}),ze==="view_pay"&&W&&i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Amount Paid:"}),i.jsxs("span",{className:"total-amount-value",children:["",Ne.toFixed(2)]})]}),ze==="view_pay"&&W&&i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Balance Due:"}),i.jsxs("span",{className:"total-amount-value",children:["",K.toFixed(2)]})]}),i.jsxs("div",{className:"footer-actions",children:[ze==="create"&&!p&&i.jsxs("div",{className:"action-group",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Payment Mode"}),i.jsxs("select",{value:$,onChange:xe=>H(xe.target.value),className:"custom-select-input",disabled:p||ae,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"online",children:"Pay Online (Razorpay)"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsx("button",{onClick:dt,disabled:ae||T.length===0||p,className:"finalize-button",children:ae?"Processing...":"Finalize Bill"})]}),ze==="view_pay"&&we&&!p&&i.jsxs("div",{className:"action-group",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Record Payment Amount ()"}),i.jsx("input",{type:"number",value:se,onChange:xe=>je(xe.target.value),placeholder:`Max: ${K.toFixed(2)}`,className:"custom-text-input",disabled:Se})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Payment Mode"}),i.jsxs("select",{value:We,onChange:xe=>X(xe.target.value),className:"custom-select-input",disabled:Se,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),i.jsx("button",{onClick:Qe,disabled:Se||!se||parseFloat(se)<=0||parseFloat(se)>K,className:"record-payment-button",children:Se?"Recording...":"Record Payment"})]}),ze==="create"&&p&&T.length>0&&i.jsx("div",{className:"status-message read-only",children:"Read-only."}),ze==="view_pay"&&Ht==="paid"&&i.jsx("div",{className:"status-message paid",children:"PAID."}),ze==="view_pay"&&Ht==="cancelled"&&i.jsx("div",{className:"status-message cancelled",children:"CANCELLED."})]})]})]})},jte=()=>{const e=Et(),n=Br(),{patientId:t,queueId:r,patientName:a,initialItems:o,billType:l,relatedId:d,initialStatus:f,initialDiscountPercentage:u,doctorId:p,billId:g,labOrderId:b}=n.state||{},[v,S]=w.useState(null),[k,T]=w.useState(null),[A,M]=w.useState(null),[R,z]=w.useState(null),[F,L]=w.useState(null),[U,B]=w.useState(null),[J,D]=w.useState(null),[$,H]=w.useState(null),[te,Q]=w.useState(!0),[Y,V]=w.useState(null),[ae,re]=w.useState(a||"");w.useEffect(()=>{if(!t){console.error("BillingPage loaded without required patientId in location state."),e("/");return}(async()=>{Q(!0),V(null);try{let de=t,fe=o||null,W=f||null,oe=l||null,se=d||null,je=u!==void 0?parseFloat(u):null,We=a||null,X=null;if(g){console.log(`Fetching details for Bill ID: ${g}`);const Se=await pe(`/api/bills/${g}`);if(!Se.ok){const Pe=await Se.json().catch(()=>({message:`Failed to fetch bill details for ID ${g}`}));throw new Error(Pe.message||`Failed to fetch bill details (Status: ${Se.status})`)}const Ae=await Se.json();if(console.log("Fetched Bill Data:",Ae),fe=Ae.bill.items||[],W=Ae.bill.status||"pending",oe=Ae.bill.type||null,se=Ae.bill.related_id||null,je=Ae.bill.discount_percentage!==void 0&&Ae.bill.discount_percentage!==null?parseFloat(Ae.bill.discount_percentage):0,de=Ae.bill.patient_id,z(fe),L(W),B(oe),D(se),H(je),de){const Pe=await pe(`/api/patients/${de}`);if(Pe.ok){const Ze=await Pe.json();We=Ze.name,X=Ze.phone??null,M(Ze.insurance_type??null),re(We),T(X)}else console.warn(`Could not fetch patient details for ID ${de} from bill.`),re("Patient (Not Found)")}else console.warn(`Bill ${g} does not have an associated patient_id.`),re("Patient (Unknown)")}else if(b){console.log(`Fetching details for Lab Order ID: ${b}`);const Se=await pe(`/api/lab/${b}`);if(!Se.ok){let Pe=`Failed to fetch lab order details (Status: ${Se.status} ${Se.statusText})`;try{Pe=(await Se.json()).message||Pe}catch{console.error("Response was not valid JSON:",await Se.text())}throw new Error(Pe)}const Ae=await Se.json();if(console.log("Fetched Lab Order Data:",JSON.stringify(Ae,null,2)),fe=(Ae.tests||[]).filter(Pe=>Pe&&typeof Pe.name=="string"&&Pe.price!==void 0&&Pe.id!==void 0).map(Pe=>{const Ze=parseFloat(Pe.price||"0"),rt=!isNaN(Ze)&&isFinite(Ze)?Ze:0;return{item_id:Pe.id,name:Pe.name,price:rt,quantity:1,total:rt*1,type:"lab_test"}}),fe&&fe.length===0&&(Ae.tests||[]).length>0&&(console.warn("Warning: Some tests from the lab order were filtered out due to missing id, name, or price.",Ae.tests),V(Pe=>`${Pe?Pe+"; ":""}Warning: Some lab items could not be added to the bill due to missing details.`)),W="pending",oe="lab",se=b,de=Ae.patient_id,z(fe),L(W),B(oe),D(se),de){const Pe=await pe(`/api/patients/${de}`);if(Pe.ok){const Ze=await Pe.json();We=Ze.name,X=Ze.phone??null,M(Ze.insurance_type??null),re(We),T(X)}else console.warn(`Could not fetch patient details for ID ${de} from lab order.`),re("Patient (Not Found)")}else console.warn(`Lab Order ${b} does not have an associated patient_id.`),re("Patient (Unknown)")}else if(z(o||null),L(f||null),B(l||null),D(d||null),H(u!==void 0?parseFloat(u):null),re(a||`ID ${t}`),de){const Se=await pe(`/api/patients/${de}`);if(Se.ok){const Ae=await Se.json();T(Ae.phone??null),M(Ae.insurance_type??null)}else console.warn(`Could not fetch patient details for ID ${de}.`)}if(r){const Se=await pe(`/api/queue/${r}`);if(Se.ok){const Ae=await Se.json();S(Ae.token_number)}else console.warn(`Could not fetch queue details for ID ${r}.`)}}catch(de){console.error("Error fetching billing page details:",de),V(`Failed to load details: ${de.message}`),z(null),L(null),B(null),D(null),re(a||""),T(null),S(null)}finally{Q(!1)}})()},[t,g,b,r,e]);const le=I=>{console.log(`Billing process completed for patient ID ${t}. New Bill ID: ${I}`),e(-1)},E=()=>{console.log(`Bill updated for patient ID ${t}.`),e(-1)};if(!t)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-gray-600",children:[i.jsx(zN,{size:48,className:"mb-4 text-red-500"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Missing Patient Information"}),i.jsx("p",{className:"text-sm",children:"Cannot load the billing page without a patient ID."}),i.jsx("button",{onClick:()=>e("/"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Go to Dashboard"})]});if(te)return i.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:i.jsx("p",{className:"text-teal-600 animate-pulse",children:"Loading Billing Details..."})});if(Y)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-red-600 p-4",children:[i.jsx(zN,{size:48,className:"mb-4"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Error Loading Billing Details"}),i.jsx("p",{className:"text-sm text-center mb-4",children:Y}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"}),i.jsx("button",{onClick:()=>e(-1),className:"mt-2 text-sm text-gray-600 hover:text-teal-700",children:"Go Back"})]});const ue=(F??f)==="paid";return i.jsxs("div",{className:"billing-page-container",children:[i.jsx("div",{className:"back-button-container",children:i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[i.jsx(rn,{size:20,className:"lucide"})," Back"]})}),i.jsxs("div",{className:"billing-content-wrapper",children:[i.jsxs("h3",{className:"billing-page-title",children:[g?"Bill Details":b?"Create Lab Bill":"Create Bill"," for Patient: ",ae||`ID ${t}`]}),i.jsxs("div",{className:"patient-info-bar",children:[v!==null&&i.jsxs("span",{children:[i.jsx(Qm,{size:14,className:"lucide"})," Token: ",v]}),k&&i.jsxs("span",{children:[i.jsx(Ek,{size:14,className:"lucide"})," Phone: ",k]}),b&&i.jsxs("span",{className:"lab-order-info",children:[i.jsx(Jl,{size:14,className:"lucide"})," Lab Order: ",b.substring(0,8),"..."]}),!k&&v===null&&!b&&i.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"}),A&&i.jsxs("span",{className:"insurance-info",children:[i.jsx($6,{size:14,className:"lucide"})," Insurance: ",A.replace(/_/g," ").replace(/\b\w/g,I=>I.toUpperCase())]}),!k&&v===null&&!b&&!A&&i.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"})]}),i.jsx(_te,{patientId:t,labOrderId:b,queueId:r,onBillCreated:le,onBillUpdated:E,initialItems:R??o,billType:U??l,relatedId:J??d,initialStatus:F??f,initialDiscountPercentage:$??u,readOnlyMode:ue,doctorId:p,patientInsuranceType:A??void 0})]})]})},kte=()=>{const{patientId:e}=Gi(),n=Et(),[t,r]=w.useState([]),[a,o]=w.useState(!1),[l,d]=w.useState(null),[f,u]=w.useState("");return w.useEffect(()=>{(async()=>{if(!e){d("Patient ID not provided in URL.");return}o(!0),d(null),r([]);try{try{const v=await pe(`/api/patients/${e}`);if(v.ok){const S=await v.json();u(S.name)}}catch(v){console.warn("Could not fetch patient name:",v)}console.log(`Fetching pharmacy orders for patient ID: ${e}`);const g=await pe(`/api/pharmacy-orders/patient/${e}`);if(!g.ok){const v=await g.json().catch(()=>({}));throw new Error(v.message||`HTTP error! status: ${g.status}`)}const b=await g.json();console.log("Fetched Pharmacy Orders:",b),r(b||[])}catch(g){console.error("Error fetching pharmacy orders:",g),d(`Failed to load pharmacy orders: ${g.message}`)}finally{o(!1)}})()},[e]),i.jsxs("div",{className:"p-4 md:p-6 max-w-4xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6 border-b pb-3",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-900",children:[i.jsx(rn,{size:16,className:"mr-1"}),"Back"]}),i.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[i.jsx(Ld,{size:20,className:"mr-2 text-purple-600"}),"Pharmacy Order History ",f&&`for ${f}`]}),i.jsx("div",{})," "]}),a&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading pharmacy orders..."}),l&&i.jsx("p",{className:"text-center text-red-500 bg-red-100 p-3 rounded border border-red-300",children:l}),!a&&t.length===0&&!l&&i.jsx("p",{className:"text-center text-gray-500",children:"No pharmacy orders found for this patient."}),!a&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(p=>i.jsxs("div",{className:"p-4 border rounded bg-white shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Date:"})," ",new Date(p.date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm font-medium capitalize",children:[i.jsx("strong",{children:"Status:"})," ",p.status]})]}),i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Prescribed By:"})," ",p.prescribedBy||"N/A"]}),p.dispensedBy&&i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Dispensed By:"})," ",p.dispensedBy]}),i.jsx("h4",{className:"text-md font-semibold mt-3 mb-1",children:"Medications:"}),i.jsx("ul",{className:"list-disc list-inside ml-4 text-sm text-gray-700 space-y-1",children:p.medications.map((g,b)=>i.jsxs("li",{children:[g.name," - Qty: ",g.quantity,g.tabletsPerDay&&` (${g.tabletsPerDay} per day`,g.numberOfDays&&` for ${g.numberOfDays} days)`,!g.tabletsPerDay&&g.numberOfDays&&` (for ${g.numberOfDays} days)`,g.tabletsPerDay&&!g.numberOfDays&&")"]},b))})]},p.id))})]})},Tte=()=>{const e=Et(),n=Br(),[t,r]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState([]),[f,u]=w.useState(""),[p,g]=w.useState([]),[b,v]=w.useState(null),[S,k]=w.useState(!1),[T,A]=w.useState(null),[M,R]=w.useState(!0),[z,F]=w.useState(""),[L,U]=w.useState([]),[B,J]=w.useState(!1),[D,$]=w.useState(null),[H,te]=w.useState(!1),[Q,Y]=w.useState(!1),[V,ae]=w.useState([]),[re,le]=w.useState(!1),[E,ce]=w.useState(null),ue=/^\+?[0-9\s\-().]{7,20}$/,I=/^[a-zA-Z\s'-]{2,}$/,de=w.useCallback(async()=>{try{const be=await pe("/api/drugs");if(!be.ok)throw new Error("Failed to fetch drugs");const $e=await be.json();o($e)}catch(be){console.error("Failed to fetch available drugs:",be),v("Could not load drug list. "+be.message)}},[]),fe=w.useCallback(async be=>{le(!0),ce(null);try{const $e=await pe(`/api/pharmacy-orders/patient/${be}`);if(!$e.ok){const ke=await $e.json().catch(()=>({}));throw new Error(ke.message||`HTTP error! status: ${$e.status}`)}const Be=await $e.json();ae(Be||[])}catch($e){console.error("Failed to fetch previous pharmacy orders:",$e),ce(`Could not load previous orders: ${$e.message}`)}finally{le(!1)}},[]);w.useEffect(()=>{var be;de(),(be=n.state)!=null&&be.patient?se(n.state.patient):R(!0)},[de,n.state]),w.useEffect(()=>{t!=null&&t.id?fe(t.id):ae([])},[t,fe]),w.useEffect(()=>{if(!f){g([]);return}const be=f.toLowerCase();g(a.filter($e=>{const Be=$e.name&&$e.name.toLowerCase().includes(be),ke=$e.brand_name&&$e.brand_name.toLowerCase().includes(be);return Be||ke}).slice(0,10))},[f,a]);const W=w.useMemo(()=>Db(async be=>{if(be.trim().length<2){U([]),J(!1),$(null);return}J(!0),$(null);try{const $e=new URLSearchParams({search:encodeURIComponent(be),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Be=await pe(`/api/patients?${$e.toString()}`);if(!Be.ok){const Ne=await Be.text();throw new Error(`API Error (${Be.status}): ${Ne||Be.statusText}`)}const ke=await Be.json();U(ke.patients)}catch($e){console.error("Error searching patients:",$e),$($e.message||"Failed to search patients."),U([])}finally{J(!1)}},300),[ue]),oe=be=>{const $e=be.target.value;F($e),te(ue.test($e)),Y(I.test($e)&&!ue.test($e)),J(!0),W($e)},se=w.useCallback(be=>{r(be),R(!1),F(""),U([]),$(null)},[]),je=w.useCallback(async be=>{if(!z||be==="phone"&&!H||be==="name"&&!Q){$(`Invalid ${be} to create a new patient.`);return}J(!0),$(null);try{const Be=await pe("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:be==="name"?z:"direct pharmacy",phone:be==="phone"?z:null,age:null,gender:null,token:null})});if(!Be.ok){const Ne=await Be.json();throw new Error(Ne.message||`Failed to create patient: ${Be.statusText}`)}const ke=await Be.json();alert(`New patient "${ke.name}" created with ${be==="phone"?`phone ${ke.phone}`:`name ${ke.name}`}.`),se(ke)}catch($e){console.error("Error creating new patient:",$e),$($e.message||"Failed to create new patient.")}finally{J(!1)}},[z,H,Q,se]),We=()=>{r(null),R(!0),d([]),v(null),ae([])},X=be=>{if(l.some($e=>$e.drug_id===be.id)){const $e=be.name||be.brand_name||"This drug";v(`${$e} is already in the order.`),setTimeout(()=>v(null),3e3),u(""),g([]);return}d($e=>[...$e,{drug_id:be.id,name:be.name||be.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,tabletsPerDay:1,numberOfDays:1,mrp:Number(be.mrp)||0,originalMrp:Number(be.mrp)||0,stock:be.stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(be.mrp)||0)/(Ae(be.pack)||1),pack:be.pack}]),u(""),g([])},Se=()=>{const be=f.trim();if(!be){v("Please enter a drug name to navigate to the add drug page."),setTimeout(()=>v(null),3e3);return}e("/dashboard/inventory/add",{state:{initialDrugName:be}}),u(""),g([])},Ae=be=>{if(!be)return null;const $e=be.match(/(?:\d+x)?(\d+)/);return $e?parseInt($e[1],10):null},Pe=be=>{d($e=>$e.filter(Be=>(Be.drug_id??Be.name)!==be))},Ze=(be,$e)=>{d(Be=>Be.map(ke=>{if((ke.drug_id??ke.name)===be&&ke.isLoose){const K=Ae(ke.pack),ge=Math.max(0,$e),He=ge*(K??1)+(ke.looseUnits??0);return{...ke,loosePacks:ge,looseQuantity:He,pack_quantity:ge}}return ke}))},rt=(be,$e)=>{d(Be=>Be.map(ke=>{if((ke.drug_id??ke.name)===be&&ke.isLoose){const K=Ae(ke.pack),ge=Math.max(0,$e),He=(ke.loosePacks??0)*(K??1)+ge;return{...ke,looseUnits:ge,looseQuantity:He}}return ke}))},lt=be=>{const $e=[];be.medications.forEach(Be=>{if(l.find(Ne=>Ne.drug_id&&Be.drug_id&&Ne.drug_id===Be.drug_id||Ne.name.toLowerCase()===Be.name.toLowerCase()))d(Ne=>Ne.map(K=>{if(K.drug_id&&Be.drug_id&&K.drug_id===Be.drug_id||K.name.toLowerCase()===Be.name.toLowerCase()){const ge=(K.pack_quantity??0)+(Be.pack_quantity??0),He=(K.loose_quantity??0)+(Be.loose_quantity??0),Qe=Be.tabletsPerDay??K.tabletsPerDay,dt=Be.numberOfDays??K.numberOfDays,At=Ae(K.pack),Ht=ge*(At??1)+He;return{...K,pack_quantity:ge,loose_quantity:He,directions_to_use:Be.directions_to_use??K.directions_to_use,tabletsPerDay:Qe,numberOfDays:dt,looseQuantity:Ht,loosePacks:Math.floor(Ht/(At??1)),looseUnits:Ht%(At??1)}}return K}));else{let Ne=Be.drug_id,K=Be.drug_id?a.find(ge=>ge.id===Be.drug_id):void 0;if(!Ne&&Be.name){const ge=a.find(He=>He.name&&He.name.toLowerCase()===Be.name.toLowerCase());ge&&(Ne=ge.id,K=ge)}$e.push({drug_id:Ne,name:Be.name,pack_quantity:Be.pack_quantity??0,loose_quantity:Be.loose_quantity??0,directions_to_use:Be.directions_to_use,tabletsPerDay:Be.tabletsPerDay??1,numberOfDays:Be.numberOfDays??1,mrp:K?K.mrp:Be.pack_price,originalMrp:K?K.mrp:Be.pack_price,stock:K?K.stock:Be.stock,isLoose:!0,loosePacks:0,looseUnits:(Be.pack_quantity??0)*(Ae((K==null?void 0:K.pack)||Be.pack)??1)+(Be.loose_quantity??0),looseQuantity:(Be.pack_quantity??0)*(Ae((K==null?void 0:K.pack)||Be.pack)??1)+(Be.loose_quantity??0),pricePerLooseUnit:(K?Number(K.mrp):Number(Be.pack_price)||0)/(Ae((K==null?void 0:K.pack)||Be.pack)||1),pack:(K==null?void 0:K.pack)||Be.pack})}}),d(Be=>[...Be,...$e]),be.prescriptionForUnavailableDrugs&&(!T||!T.includes(be.prescriptionForUnavailableDrugs))&&A(Be=>Be?`${Be}

-- From Order ${be.id.substring(0,8)} --
${be.prescriptionForUnavailableDrugs}`:be.prescriptionForUnavailableDrugs),v("Medications from previous order added to current order."),setTimeout(()=>v(null),3e3)},ze=async be=>{if(be.preventDefault(),v(null),k(!0),!t){v("No patient selected for the order."),k(!1);return}if(l.length===0&&!(T!=null&&T.trim())){v("Please add at least one medication or provide a prescription for unavailable drugs."),k(!1);return}const $e=l.filter(ke=>{const Ne=ke.looseQuantity??0;return Ne<=0||ke.stock!==void 0&&Ne>ke.stock});if($e.length>0){v(`Invalid quantity or insufficient stock for: ${$e.map(ke=>ke.name).join(", ")}`),k(!1);return}const Be={patient_id:t.id,items:l.map(ke=>{const Ne=ke.mrp??0,K=ke.pricePerLooseUnit??0,ge=K*(ke.looseQuantity??0);return{drug_id:ke.drug_id===void 0?null:ke.drug_id,name:ke.name,pack_quantity:ke.loosePacks??0,loose_quantity:ke.looseUnits??0,pack_price:Ne,loose_price:K,total_price:ge,price:ke.originalMrp??0,directions_to_use:ke.directions_to_use===void 0?null:ke.directions_to_use,tabletsPerDay:ke.tabletsPerDay??1,numberOfDays:ke.numberOfDays??1}}),order_total:ot,prescription_for_unavailable_drugs:T};try{const ke=await pe("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Be)});if(!ke.ok){const Ne=await ke.json();throw new Error(Ne.message||`Failed to create order: ${ke.statusText}`)}alert(`Pharmacy order created successfully for ${t.name}!`),e(-1)}catch(ke){console.error("Failed to create pharmacy order:",ke),v(ke.message||"Failed to create order. Please try again.")}finally{k(!1)}},ot=w.useMemo(()=>l.reduce((be,$e)=>{const Be=$e.isLoose?$e.pricePerLooseUnit??0:$e.mrp??0,ke=$e.isLoose?$e.looseQuantity??0:$e.quantity??0;return be+Be*ke},0),[l]),at=(Number(ot)||0).toFixed(2);return i.jsxs("div",{className:"add-pharmacy-order-page p-4 md:p-6 max-w-5xl mx-auto",children:[" ",i.jsxs("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:[" ",i.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:[i.jsx(rn,{size:20})," "]}),i.jsx("h2",{className:"text-2xl",children:"Create New Pharmacy Order"})," "]})]}),M&&i.jsxs("div",{className:"content-section",children:[" ",i.jsx("h3",{className:"section-title",children:"Select Patient"})," ",i.jsxs("div",{className:"mb-3 relative",children:[i.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"})," ",i.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:z,onChange:oe,className:"custom-text-input mt-1",autoFocus:!0}),B&&i.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),D&&i.jsx("div",{className:"ai-function-status error mb-3 p-3",children:D})," ",L.length>0&&i.jsxs("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:[" ",i.jsxs("ul",{children:[" ",L.map(be=>i.jsxs("li",{onClick:()=>se({id:be.id,name:be.name,token:be.token,age:be.age,gender:be.gender,phone:be.phone}),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[i.jsxs("div",{className:"font-medium",children:[i.jsxs("span",{className:"patient-token mr-2",children:["#",be.token]}),be.name]}),i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[be.age?`${be.age} yrs`:"Age N/A",be.gender?` / ${be.gender}`:" / Gender N/A",be.phone&&i.jsxs("span",{className:"hidden sm:inline",children:[" / ",be.phone]})]})]}),be.phone&&i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",be.phone]})]},be.id))]})]}),z.length>=2&&!B&&L.length===0&&!D&&i.jsxs(i.Fragment,{children:[i.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',z,'".']}),H&&i.jsx("button",{type:"button",onClick:()=>je("phone"),className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:B,children:'Create "direct pharmacy" Patient with this Phone'}),Q&&i.jsx("button",{type:"button",onClick:()=>je("name"),className:"create-patient-button mt-3 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ml-2",disabled:B,children:"Create Patient with this Name"})]}),z.length<2&&!B&&i.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]}),t&&!M&&i.jsxs("form",{onSubmit:ze,children:[i.jsxs("div",{className:"selected-patient-info content-section flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[" ",i.jsxs("div",{children:[i.jsxs("h3",{className:"section-title",children:[" ","Patient: ",i.jsx("span",{className:"font-normal",children:t.name})]}),i.jsxs("p",{className:"text-sm mt-1",children:["Token: ",i.jsx("span",{className:"font-medium",children:t.token??"N/A"}),t.age&&`    Age: ${t.age}`,t.gender&&`    Gender: ${t.gender}`,t.phone&&`    Phone: ${t.phone}`]}),i.jsxs("p",{className:"text-xs mt-1",title:`Patient UUID: ${t.id}`,children:["ID: ",t.id.substring(0,12),"..."]})]}),i.jsx("button",{type:"button",onClick:We,className:"change-patient-button mt-2 sm:mt-0 px-3 py-1.5 border rounded-md text-sm font-medium focus:outline-none focus:ring-2",children:"Change Patient"})]}),b&&i.jsx("div",{className:"ai-function-status error mb-4 p-3",children:b})," ",re&&i.jsx("div",{className:"content-section text-center py-4",children:i.jsx("p",{className:"text-gray-500",children:"Loading previous orders..."})}),E&&i.jsx("div",{className:"ai-function-status error mb-4 p-3",children:E}),!re&&V.length>0&&i.jsxs("div",{className:"content-section mt-4",children:[i.jsx("h3",{className:"section-title",children:"Previous Orders"}),i.jsx("div",{className:"space-y-4",children:V.map(be=>i.jsxs("div",{className:"previous-order-card p-4 border rounded-lg shadow-sm bg-gray-50",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("p",{className:"font-semibold text-gray-800",children:["Order Date: ",new Date(be.date).toLocaleDateString()]}),i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${be.status==="dispensed"?"bg-green-100 text-green-800":be.status==="pending"?"bg-yellow-100 text-yellow-800":be.status==="cancelled"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:be.status.charAt(0).toUpperCase()+be.status.slice(1)})]}),i.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mb-3",children:be.medications.map(($e,Be)=>i.jsxs("li",{children:[i.jsx("strong",{children:$e.name}),": ",$e.quantity," Qty",$e.directions_to_use&&` - Directions: ${$e.directions_to_use}`]},Be))}),be.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:[i.jsx("span",{className:"font-semibold",children:"Prescription for Unavailable:"}),i.jsxs("div",{className:"prose prose-sm max-w-none",children:[" ",i.jsx(Vs,{remarkPlugins:[ds],children:be.prescriptionForUnavailableDrugs})]})]}),i.jsxs("button",{type:"button",onClick:()=>lt(be),className:"add-previous-meds-button mt-3 px-3 py-1.5 text-sm font-medium rounded-md flex items-center justify-center",children:[i.jsx(Zo,{size:16,className:"mr-1"})," Add Medications to Current Order"]})]},be.id))})]}),!re&&V.length===0&&t&&i.jsx("div",{className:"content-section text-center py-4 mt-4",children:i.jsx("p",{className:"text-gray-500",children:"No previous orders found for this patient."})}),i.jsxs("div",{className:"mb-4 content-section",children:[i.jsx("label",{htmlFor:"prescription-unavailable",className:"form-label",children:"Prescription for Unavailable Drugs (Optional)"}),i.jsx("textarea",{id:"prescription-unavailable",rows:3,value:T??"",onChange:be=>A(be.target.value||null),placeholder:"Enter prescription details for any drugs that are currently unavailable...",className:"custom-text-input mt-1 w-full"})]}),i.jsxs("div",{className:"mb-4 relative content-section",children:[" ",i.jsx("label",{htmlFor:"drug-search",className:"form-label",children:"Add Medication"})," ",i.jsx("input",{type:"text",id:"drug-search",placeholder:"Search for drug name or type to add custom...",value:f,onChange:be=>u(be.target.value),className:"custom-text-input mt-1"}),f&&i.jsxs("div",{className:"drug-search-dropdown mt-1 w-full max-h-60 rounded-md border shadow-lg overflow-auto focus:outline-none sm:text-sm z-20",children:[" ",p.length>0&&i.jsxs("ul",{children:[" ",p.map(be=>i.jsxs("li",{onClick:()=>X(be),className:"cursor-pointer select-none relative",children:[i.jsx("span",{className:"font-medium block truncate",children:be.name||be.brand_name}),i.jsxs("span",{className:"drug-stock-price text-xs",children:[" ","(Stock: ",be.stock??"N/A",", MRP: ",Number(be.mrp||0).toFixed(2),")"]})]},be.id))]}),f.trim()&&!a.some(be=>be.name&&be.name.toLowerCase()===f.trim().toLowerCase()||be.brand_name&&be.brand_name.toLowerCase()===f.trim().toLowerCase())&&i.jsxs("div",{onClick:Se,className:"add-custom-drug-button cursor-pointer text-sm font-medium",role:"button",children:['Add "',f.trim(),'" as new item']}),f.trim()&&p.length===0&&a.some(be=>be.name&&be.name.toLowerCase()===f.trim().toLowerCase()||be.brand_name&&be.brand_name.toLowerCase()===f.trim().toLowerCase())&&i.jsx("p",{className:"text-gray-400 py-2.5 px-4 text-sm",children:"Drug already selected or no new matches."})]})]}),i.jsxs("div",{className:"order-items-section content-section max-h-96 overflow-y-auto",children:[" ",i.jsx("h4",{className:"section-title",children:"Order Items"})," ",l.length===0&&i.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:"No medications added yet."}),l.length>0&&i.jsx("ul",{className:"space-y-4",children:l.map(be=>{const $e=be.drug_id??be.name,Be=!be.drug_id;return i.jsxs("li",{className:"order-item-card text-sm",children:[" ",i.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-3",children:[i.jsxs("div",{className:"flex-grow mb-2 md:mb-0",children:[i.jsxs("span",{className:`item-name block text-base ${Be?"custom":""}`,children:[" ",be.name,Be?" (custom)":""]}),!Be&&be.pricePerLooseUnit!==void 0&&i.jsxs("span",{className:"item-details text-xs",children:[" ","@ ",(Number(be.pricePerLooseUnit)||0).toFixed(2)," per loose unit"]}),be.stock!==void 0&&i.jsxs("span",{className:`item-details text-xs ml-2 ${be.stock<=10?"item-stock low":""}`,children:[" ","(Stock: ",be.stock,")"]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-x-4 gap-y-2",children:[i.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[i.jsx("label",{htmlFor:`loose-packs-${$e}`,className:"dosage-label",children:"Packs:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>Ze($e,(be.loosePacks??0)-1),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`loose-packs-${$e}`,min:"0",value:be.loosePacks??0,onChange:ke=>{const Ne=parseInt(ke.target.value,10);Ze($e,isNaN(Ne)?0:Ne)},onFocus:ke=>ke.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>Ze($e,(be.loosePacks??0)+1),className:"quantity-btn",children:"+"})]})]}),i.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[i.jsx("label",{htmlFor:`loose-units-${$e}`,className:"dosage-label",children:"Loose:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>rt($e,(be.looseUnits??0)-1),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`loose-units-${$e}`,min:"0",value:be.looseUnits??0,onChange:ke=>{const Ne=parseInt(ke.target.value,10);rt($e,isNaN(Ne)?0:Ne)},onFocus:ke=>ke.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>rt($e,(be.looseUnits??0)+1),className:"quantity-btn",children:"+"})]}),be.pack&&i.jsxs("span",{className:"ml-2 text-sm text-gray-400",children:["(",be.pack.split("x")[1]||be.pack," per pack)"]})]})]}),i.jsxs("div",{className:"flex items-center justify-between md:justify-end gap-3 mt-2 md:mt-0 md:flex-col md:items-end",children:[i.jsxs("div",{className:"w-28 text-right font-semibold",children:[" ","",(Number((be.pricePerLooseUnit??0)*(be.looseQuantity??0))||0).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>Pe($e),className:"remove-item-button p-1.5 -m-1.5 rounded-full",title:"Remove Item",children:i.jsx(Ur,{size:18})})]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-x-4 gap-y-2 mt-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:`tablets-per-day-${$e}`,className:"dosage-label",children:"Per Day:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>d(ke=>ke.map(Ne=>Ne.drug_id===$e?{...Ne,tabletsPerDay:Math.max(1,(Ne.tabletsPerDay??1)-1)}:Ne)),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`tablets-per-day-${$e}`,min:"1",value:be.tabletsPerDay??1,onChange:ke=>{const Ne=parseInt(ke.target.value,10);d(K=>K.map(ge=>ge.drug_id===$e?{...ge,tabletsPerDay:isNaN(Ne)?1:Math.max(1,Ne)}:ge))},onFocus:ke=>ke.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>d(ke=>ke.map(Ne=>Ne.drug_id===$e?{...Ne,tabletsPerDay:(Ne.tabletsPerDay??1)+1}:Ne)),className:"quantity-btn",children:"+"})]})]}),i.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[i.jsx("label",{htmlFor:`number-of-days-${$e}`,className:"dosage-label",children:"No. Days:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>d(ke=>ke.map(Ne=>Ne.drug_id===$e?{...Ne,numberOfDays:Math.max(1,(Ne.numberOfDays??1)-1)}:Ne)),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`number-of-days-${$e}`,min:"1",value:be.numberOfDays??1,onChange:ke=>{const Ne=parseInt(ke.target.value,10);d(K=>K.map(ge=>ge.drug_id===$e?{...ge,numberOfDays:isNaN(Ne)?1:Math.max(1,Ne)}:ge))},onFocus:ke=>ke.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>d(ke=>ke.map(Ne=>Ne.drug_id===$e?{...Ne,numberOfDays:(Ne.numberOfDays??1)+1}:Ne)),className:"quantity-btn",children:"+"})]})]})]}),i.jsx("div",{className:"flex items-center mt-2",children:be.pack&&Ae(be.pack)&&i.jsx("span",{className:"ml-4 text-sm text-gray-400",children:(()=>{const ke=Ae(be.pack),Ne=be.looseQuantity??0;if(ke&&ke>0){const K=Math.floor(Ne/ke),ge=Ne%ke;return`(Subtract: ${K} packs, ${ge} loose)`}return""})()})}),i.jsxs("div",{className:"mt-2",children:[i.jsx("label",{htmlFor:`directions-${$e}`,className:"dosage-label",children:"Directions:"}),i.jsx("input",{type:"text",id:`directions-${$e}`,placeholder:"e.g., 'After food', 'Twice a day'",value:be.directions_to_use??"",onChange:ke=>{const Ne=ke.target.value;d(K=>K.map(ge=>(ge.drug_id??ge.name)===$e?{...ge,directions_to_use:Ne}:ge))},className:"dosage-input text-sm w-full mt-1"})]})]},$e)})})]}),l.length>0&&i.jsx("div",{className:"mt-6 text-right pr-4",children:i.jsxs("span",{className:"grand-total font-bold",children:[" ","Grand Total: ",at]})}),i.jsx("div",{className:"mt-8 flex justify-end",children:i.jsx("button",{type:"submit",disabled:S||l.length===0&&!(T!=null&&T.trim()),className:`submit-order-button inline-flex items-center justify-center text-base shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 ${S||l.length===0&&!(T!=null&&T.trim())?"":"hover:opacity-90"}`,children:S?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"spinner animate-spin rounded-full h-5 w-5 border-2 mr-3"})," ","Creating Order..."]}):"Create Order"})})]})]})},jA=()=>{const{orderId:e}=Gi(),n=Et(),[t,r]=w.useState(null),[a,o]=w.useState(null),[l,d]=w.useState([]),[f,u]=w.useState([]),[p,g]=w.useState(""),[b,v]=w.useState([]),[S,k]=w.useState(null),[T,A]=w.useState(!1),[M,R]=w.useState(null),[z,F]=w.useState(!0),L=w.useCallback(async()=>{F(!0);try{const Y=await pe(`/api/pharmacy-orders/${e}`);if(!Y.ok)throw new Error("Failed to fetch order details");const V=await Y.json();r(V),o({id:V.patientId,name:V.patientName||"N/A",token:V.patientTokenNumber}),R(V.prescriptionForUnavailableDrugs);const ae=V.medications.map(re=>{const le=B(re.pack),E=re.pack_quantity*(le??1)+re.loose_quantity;return{...re,isLoose:!0,loosePacks:re.pack_quantity,looseUnits:re.loose_quantity,looseQuantity:E,pack_price:re.pack_price,loose_price:re.loose_price,total_price:re.total_price,pricePerLooseUnit:re.loose_price,originalPrice:re.pack_price,box_number:re.box_number,pack:re.pack,batch:re.batch,expiry_date:re.expiry_date,discount_percentage:re.discount_percentage}});u(ae)}catch(Y){k("Could not load order details. "+Y.message)}finally{F(!1)}},[e]),U=w.useCallback(async()=>{try{const Y=await pe("/api/drugs");if(!Y.ok)throw new Error("Failed to fetch drugs");const V=await Y.json();d(V)}catch(Y){k("Could not load drug list. "+Y.message)}},[]);w.useEffect(()=>{L(),U()},[L,U]),w.useEffect(()=>{if(!p){v([]);return}const Y=p.toLowerCase();v(l.filter(V=>{const ae=V.name&&V.name.toLowerCase().includes(Y),re=V.brand_name&&V.brand_name.toLowerCase().includes(Y);return ae||re}).slice(0,10))},[p,l]);const B=Y=>{if(!Y)return null;const V=Y.match(/(?:\d+x)?(\d+)/);return V?parseInt(V[1],10):null},J=Y=>{if(f.some(V=>V.drug_id===Y.id)){k(`${Y.name||Y.brand_name} is already in the order.`),setTimeout(()=>k(null),3e3),g(""),v([]);return}u(V=>[...V,{drug_id:Y.id,name:Y.name||Y.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,pack_price:Number(Y.mrp)||0,loose_price:(Number(Y.mrp)||0)/(B(Y.pack)||1),total_price:(Number(Y.mrp)||0)/(B(Y.pack)||1),discount_percentage:0,directions_to_use:"",tabletsPerDay:1,numberOfDays:1,stock:Y.stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(Y.mrp)||0)/(B(Y.pack)||1),originalPrice:Number(Y.mrp)||0,pack:Y.pack}]),g(""),v([])},D=Y=>{u(V=>V.filter(ae=>(ae.drug_id??ae.name)!==Y))},$=(Y,V)=>{u(ae=>ae.map(re=>{if((re.drug_id??re.name)===Y&&re.isLoose){const le=B(re.pack),E=Math.max(0,V),ce=E*(le??1)+(re.looseUnits??0);return{...re,loosePacks:E,looseQuantity:ce,pack_quantity:E}}return re}))},H=(Y,V)=>{u(ae=>ae.map(re=>{if((re.drug_id??re.name)===Y&&re.isLoose){const le=B(re.pack),E=Math.max(0,V),ce=(re.loosePacks??0)*(le??1)+E;return{...re,looseUnits:E,looseQuantity:ce,loose_quantity:E}}return re}))},te=async Y=>{if(Y.preventDefault(),k(null),A(!0),f.length===0&&!(M!=null&&M.trim())){k("Please add at least one medication or provide a prescription."),A(!1);return}const V=f.filter(re=>{const le=re.looseQuantity??0;return le<=0||re.stock!==void 0&&le>re.stock});if(V.length>0){k(`Invalid quantity or insufficient stock for: ${V.map(re=>re.name).join(", ")}`),A(!1);return}const ae={items:f.map(re=>({drug_id:re.drug_id??null,name:re.name,pack_quantity:re.loosePacks??0,loose_quantity:re.looseUnits??0,pack_price:re.pack_price??0,loose_price:re.loose_price??0,total_price:(re.loose_price??0)*(re.looseQuantity??0),discount_percentage:re.discount_percentage??0,directions_to_use:re.directions_to_use??null,tabletsPerDay:re.tabletsPerDay??1,numberOfDays:re.numberOfDays??1})),prescription_for_unavailable_drugs:M,order_total:Q};try{const re=await pe(`/api/pharmacy-orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ae)});if(!re.ok){const le=await re.json();throw new Error(le.message||"Failed to update order")}alert("Pharmacy order updated successfully!"),n(-1)}catch(re){k(re.message||"Failed to update order. Please try again.")}finally{A(!1)}},Q=w.useMemo(()=>f.reduce((Y,V)=>{const ae=V.loose_price??0,re=V.looseQuantity??0;return Y+ae*re},0),[f]);return z?i.jsx("div",{className:"p-6 flex justify-center items-center h-screen text-gray-500",children:"Loading order details..."}):t?i.jsxs("div",{className:"edit-pharmacy-order-container",children:[i.jsxs("div",{className:"page-header",children:[i.jsxs("div",{className:"header-left",children:[i.jsx("button",{onClick:()=>n(-1),className:"back-button",title:"Go Back",children:i.jsx(rn,{size:20})}),i.jsxs("h2",{className:"page-title",children:["EDIT ORDER ",i.jsxs("span",{className:"text-gray-500 text-lg font-normal ml-2",children:[a==null?void 0:a.name," #",t.id.substring(0,4)]})]})]}),i.jsx("div",{className:"header-right",children:i.jsx("span",{className:"status-badge",children:t.status.toUpperCase()})})]}),i.jsx("div",{className:"order-meta",children:i.jsxs("span",{className:"order-date",children:[" Order Date: ",new Date(t.date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})]})}),i.jsxs("form",{onSubmit:te,className:"main-layout",children:[i.jsxs("div",{className:"left-column",children:[i.jsxs("div",{className:"card search-section",children:[i.jsx("div",{className:"card-header",children:i.jsx("h3",{children:" Find & Add Medication"})}),i.jsxs("div",{className:"search-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by name or brand...",value:p,onChange:Y=>g(Y.target.value),className:"search-input"}),p&&i.jsx("div",{className:"dropdown-results",children:b.length>0?i.jsx("ul",{children:b.map(Y=>i.jsxs("li",{onClick:()=>J(Y),className:"dropdown-item",children:[i.jsx("span",{className:"drug-name",children:Y.name||Y.brand_name}),i.jsxs("span",{className:"drug-meta",children:["(Stock: ",Y.stock??"N/A",", MRP: ",Number(Y.mrp||0).toFixed(2),")"]})]},Y.id))}):i.jsxs("div",{className:"p-3 text-gray-500 text-sm",children:['No drugs found matching "',p,'"']})})]})]}),i.jsxs("div",{className:"card medications-list-section",children:[i.jsx("div",{className:"card-header",children:i.jsxs("h3",{children:[" Medications in Order ",i.jsxs("span",{className:"item-count",children:[f.length," items"]})]})}),f.length>0?i.jsxs("div",{className:"table-container",children:[i.jsxs("div",{className:"table-header-row",children:[i.jsx("div",{className:"col-medication",children:"MEDICATION"}),i.jsx("div",{className:"col-directions",children:"DIRECTIONS"}),i.jsx("div",{className:"col-quantity",children:"QUANTITY"}),i.jsx("div",{className:"col-subtotal",children:"SUBTOTAL"}),i.jsx("div",{className:"col-action"})]}),i.jsx("div",{className:"table-body",children:f.map(Y=>{const V=Y.drug_id??Y.name;return i.jsxs("div",{className:"table-row",children:[i.jsxs("div",{className:"col-medication",children:[i.jsx("span",{className:"med-name",children:Y.name}),Y.pack&&i.jsx("span",{className:"med-unit text-xs text-gray-500 block",children:Y.pack}),i.jsxs("div",{className:"stock-info",children:[" Stock: ",i.jsxs("span",{className:"stock-value",children:[" ",Y.stock!==void 0?Y.pack?`BOX OF ${B(Y.pack)}`:Y.stock:"N/A"]})]})]}),i.jsx("div",{className:"col-directions",children:i.jsx("input",{type:"text",placeholder:"1 tablet twice daily...",value:Y.directions_to_use??"",onChange:ae=>{const re=ae.target.value;u(le=>le.map(E=>(E.drug_id??E.name)===V?{...E,directions_to_use:re}:E))},className:"directions-input"})}),i.jsx("div",{className:"col-quantity",children:i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsx("label",{style:{fontSize:"10px",fontWeight:"bold",color:"#9ca3af",display:"block",marginBottom:"2px"},children:"PACKS"}),i.jsx("input",{type:"number",min:"0",value:Y.loosePacks??0,onChange:ae=>$(V,parseInt(ae.target.value)||0),className:"qty-input",style:{width:"100%",textAlign:"center"}})]}),i.jsxs("div",{style:{flex:1},children:[i.jsx("label",{style:{fontSize:"10px",fontWeight:"bold",color:"#9ca3af",display:"block",marginBottom:"2px"},children:"LOOSE"}),i.jsx("input",{type:"number",min:"0",value:Y.looseUnits??0,onChange:ae=>H(V,parseInt(ae.target.value)||0),className:"qty-input",style:{width:"100%",textAlign:"center"}})]})]})}),i.jsxs("div",{className:"col-subtotal",children:["",(Number((Y.pricePerLooseUnit??0)*(Y.looseQuantity??0))||0).toFixed(2)]}),i.jsx("div",{className:"col-action",children:i.jsx("button",{type:"button",onClick:()=>D(V),className:"delete-btn",children:i.jsx(Ur,{size:16})})})]},V)})})]}):i.jsx("div",{className:"empty-state",children:"No medications added. Search above to add."})]})]}),i.jsxs("div",{className:"right-column",children:[i.jsxs("div",{className:"card notes-card",children:[i.jsx("div",{className:"card-header border-b-0 pb-2",children:i.jsx("h3",{children:" Prescription Notes"})}),i.jsx("textarea",{rows:3,value:M??"",onChange:Y=>R(Y.target.value||null),placeholder:"Add notes about unavailable drugs...",className:"notes-input"})]}),i.jsxs("button",{type:"submit",disabled:T,className:"confirm-btn",style:{width:"100%",margin:"20px 0 0 0"},children:[i.jsx("span",{className:"check-icon",children:""})," ",T?"Updating...":"Confirm Changes"]}),S&&i.jsx("div",{className:"error-alert mt-4",children:S})]})]})]}):i.jsx("div",{className:"p-6 text-red-500 flex justify-center items-center h-screen",children:"Order not found or failed to load."})},Ete=(e,n,t,r="non-black")=>{if(isNaN(e)||isNaN(n)||e<=0||n<=0)return null;let a;return t==="female"?e<=.7?a=141*Math.pow(e/.7,-.329)*Math.pow(.993,n):a=141*Math.pow(e/.7,-1.209)*Math.pow(.993,n):e<=.9?a=141*Math.pow(e/.9,-.411)*Math.pow(.993,n):a=141*Math.pow(e/.9,-1.209)*Math.pow(.993,n),r==="black"&&(a*=1.018),parseFloat(a.toFixed(2))},Ate=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0||t>=400)return null;const r=e-n-t/5;return parseFloat(r.toFixed(2))},Pte=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},Dte=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},Ite=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=e-(n+t);return parseFloat(r.toFixed(2))},Rte=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=2*e+n/18+t/2.8;return parseFloat(r.toFixed(2))},Mj=e=>["eGFR","LDL Cholesterol","Indirect Bilirubin","Globulin","Anion Gap","Osmolality"].includes(e),Oj=()=>{var de,fe;const{orderId:e}=Gi(),n=Et(),[t,r]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!0),[f,u]=w.useState(!1),[p,g]=w.useState(null),[b,v]=w.useState(null),[S,k]=w.useState(null),[T,A]=w.useState({}),[M,R]=w.useState(null),[z,F]=w.useState(!1),[L,U]=w.useState(""),[B,J]=w.useState(!1),[D,$]=w.useState(""),H=w.useCallback(async W=>{var oe;try{const se=await pe(`/api/patients/${W}`);if(!se.ok)throw new Error(`Failed to fetch patient details: ${se.status}`);const je=await se.json();v(je.age),k(((oe=je.sex)==null?void 0:oe.toLowerCase())==="female"?"female":"male"),je.phone&&r(We=>We?{...We,Patient:{...We.Patient,phone:je.phone}}:null)}catch(se){console.error("Error fetching patient details:",se),v(null),k(null)}},[]),te=w.useCallback(async()=>{if(e){d(!0),g(null);try{const W=await pe(`/api/lab/${e}`);if(!W.ok){const je=await W.json().catch(()=>({message:`HTTP error! status: ${W.status}`}));throw new Error(je.message||`HTTP error! status: ${W.status}`)}const oe=await W.json();if(r(oe),oe.createdAt)try{const je=new Date(oe.createdAt),We=new Date(je.getTime()-je.getTimezoneOffset()*6e4).toISOString().slice(0,16);U(We)}catch(je){console.error("Error formatting date for edit:",je)}if(oe.report_date)try{const je=new Date(oe.report_date),We=new Date(je.getTime()-je.getTimezoneOffset()*6e4).toISOString().slice(0,16);$(We)}catch(je){console.error("Error formatting report date for edit:",je)}else{const je=new Date,We=new Date(je.getTime()-je.getTimezoneOffset()*6e4).toISOString().slice(0,16);$(We)}oe.patient_id&&H(oe.patient_id);const se={};if(oe.tests&&oe.tests.forEach(je=>{se[je.id]={},je.default_parameters&&je.default_parameters.length>0?je.default_parameters.forEach(We=>{se[je.id][We.name]=We.defaultValue}):se[je.id].report_content=""}),oe.report_content)try{const je=JSON.parse(oe.report_content);typeof je=="object"&&je!==null&&!Array.isArray(je)?o(je):(console.warn("Legacy or unexpected report content format detected. Initializing with defaults."),o(se))}catch{console.warn("Legacy report content detected (not JSON). Initializing with defaults."),o(se)}else o({})}catch(W){console.error("Failed to fetch lab order details:",W),g(W instanceof Error?W.message:"An unknown error occurred while fetching order details.")}finally{d(!1)}}},[e,H]);w.useEffect(()=>{e?te():(g("No Order ID provided in the URL."),d(!1))},[e,te]);const Q=(W,oe,se)=>{o(je=>{var K,ge,He,Qe,dt,At,Ht,we,xe,Me,De,qe,st,yt,_t,cn,gn,Cn,wt;const We={...je,[W]:{...je[W],[oe]:se}},X=parseFloat((K=We[W])==null?void 0:K.Creatinine),Se=b,Ae=S;if(oe==="Creatinine"&&!isNaN(X)&&Se!==null&&Ae!==null){const bt=Ete(X,Se,Ae);bt!==null&&((ge=t==null?void 0:t.tests.find(St=>St.id===W))!=null&&ge.default_parameters.find(St=>St.name==="eGFR"))&&(We[W].eGFR=bt)}const Pe=parseFloat((He=We[W])==null?void 0:He["Total Cholesterol"]),Ze=parseFloat((Qe=We[W])==null?void 0:Qe["HDL Cholesterol"]),rt=parseFloat((dt=We[W])==null?void 0:dt.Triglycerides);if((oe==="Total Cholesterol"||oe==="HDL Cholesterol"||oe==="Triglycerides")&&!isNaN(Pe)&&!isNaN(Ze)&&!isNaN(rt)){const bt=Ate(Pe,Ze,rt);bt!==null&&((At=t==null?void 0:t.tests.find(St=>St.id===W))!=null&&At.default_parameters.find(St=>St.name==="LDL Cholesterol"))&&(We[W]["LDL Cholesterol"]=bt)}const lt=parseFloat((Ht=We[W])==null?void 0:Ht["Total Bilirubin"]),ze=parseFloat((we=We[W])==null?void 0:we["Direct Bilirubin"]);if((oe==="Total Bilirubin"||oe==="Direct Bilirubin")&&!isNaN(lt)&&!isNaN(ze)){const bt=Pte(lt,ze);bt!==null&&((xe=t==null?void 0:t.tests.find(St=>St.id===W))!=null&&xe.default_parameters.find(St=>St.name==="Indirect Bilirubin"))&&(We[W]["Indirect Bilirubin"]=bt)}const ot=parseFloat((Me=We[W])==null?void 0:Me["Total Protein"]),at=parseFloat((De=We[W])==null?void 0:De.Albumin);if((oe==="Total Protein"||oe==="Albumin")&&!isNaN(ot)&&!isNaN(at)){const bt=Dte(ot,at);bt!==null&&((qe=t==null?void 0:t.tests.find(St=>St.id===W))!=null&&qe.default_parameters.find(St=>St.name==="Globulin"))&&(We[W].Globulin=bt)}const be=parseFloat((st=We[W])==null?void 0:st.Sodium),$e=parseFloat((yt=We[W])==null?void 0:yt.Chloride),Be=parseFloat((_t=We[W])==null?void 0:_t.Bicarbonate);if((oe==="Sodium"||oe==="Chloride"||oe==="Bicarbonate")&&!isNaN(be)&&!isNaN($e)&&!isNaN(Be)){const bt=Ite(be,$e,Be);bt!==null&&((cn=t==null?void 0:t.tests.find(St=>St.id===W))!=null&&cn.default_parameters.find(St=>St.name==="Anion Gap"))&&(We[W]["Anion Gap"]=bt)}const ke=parseFloat((gn=We[W])==null?void 0:gn.Glucose),Ne=parseFloat((Cn=We[W])==null?void 0:Cn.BUN);if((oe==="Sodium"||oe==="Glucose"||oe==="BUN")&&!isNaN(be)&&!isNaN(ke)&&!isNaN(Ne)){const bt=Rte(be,ke,Ne);bt!==null&&((wt=t==null?void 0:t.tests.find(St=>St.id===W))!=null&&wt.default_parameters.find(St=>St.name==="Osmolality"))&&(We[W].Osmolality=bt)}return We})},Y=async W=>{const oe=a[W]||{},se=t==null?void 0:t.tests.find(Se=>Se.id===W);if(!se)return;const je={};se.default_parameters&&se.default_parameters.forEach(Se=>{je[Se.name]=Se.defaultValue});const We={...je,...oe},X={...a,[W]:We};o(X),u(!0),g(null);try{const Se=await pe(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(X),isPartial:!0})});if(!Se.ok)throw new Error(`Save failed: ${Se.status}`);alert(`Report for ${se.name} saved successfully!`)}catch(Se){console.error("Error saving test report:",Se),alert("Failed to save test report.")}finally{u(!1)}},V=(W=null)=>{R(W),setTimeout(()=>{window.print()},100)},ae=()=>{t&&Jw(t)},re=async()=>{if(!t||!t.tests){alert("Order details not loaded.");return}if(!e){alert("Cannot submit report without an Order ID.");return}const W={};if(t.tests.forEach(oe=>{const se=a[oe.id]||{},je={};oe.default_parameters&&oe.default_parameters.forEach(We=>{We.defaultValue!==void 0&&We.defaultValue!==null&&(je[We.name]=We.defaultValue)}),W[oe.id]={...je,...se},(!oe.default_parameters||oe.default_parameters.length===0)&&!W[oe.id].report_content&&(W[oe.id].report_content="")}),Object.keys(W).length===0){alert("Report content cannot be empty.");return}o(W),u(!0),g(null);try{const oe=await pe(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(W)})});if(!oe.ok){const se=await oe.json().catch(()=>({message:`Submission failed: ${oe.status}`}));throw new Error(se.message||`Submission failed: ${oe.status}`)}alert("Report submitted successfully!"),n(-1)}catch(oe){console.error("Error submitting report:",oe),g(oe instanceof Error?oe.message:"An unknown error occurred during submission.")}finally{u(!1)}},le=async()=>{if(!(!e||!L))try{const W=await pe(`/api/lab/orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:new Date(L).toISOString()})});if(!W.ok)throw new Error("Failed to update date");const oe=await W.json();oe.order&&r(se=>se?{...se,createdAt:oe.order.createdAt}:null),F(!1)}catch(W){console.error("Failed to update date:",W),alert("Failed to update date")}},E=async()=>{if(!(!e||!D))try{const W=await pe(`/api/lab/orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({reportDate:new Date(D).toISOString()})});if(!W.ok)throw new Error("Failed to update report date");const oe=await W.json();oe.order&&r(se=>se?{...se,report_date:oe.order.report_date}:null),J(!1)}catch(W){console.error("Failed to update report date:",W),alert("Failed to update report date")}};if(l)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",style:{textAlign:"center",padding:"50px"},children:[" ",i.jsxs("div",{className:"loading-text",children:[i.jsx(Od,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading details..."]})]})});if(p&&!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card error-message-container",style:{textAlign:"center",padding:"30px"},children:[i.jsx(Ar,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("h3",{className:"error-title",style:{borderBottom:"none"},children:"Error Loading Details"}),i.jsx("p",{className:"error-text",children:p}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"20px"},children:[i.jsx(rn,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});if(!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(Ko,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("p",{className:"no-data-message",style:{fontSize:"1.1em"},children:`Lab order not found for ID: ${e}.`}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"15px"},children:[i.jsx(rn,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});const ce=(de=t==null?void 0:t.Patient)==null?void 0:de.name,ue=(fe=t==null?void 0:t.Patient)==null?void 0:fe.patient_token_number;return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"none",paddingBottom:0,marginBottom:0},children:[" ",i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:"Enter Lab Report"})," ",i.jsxs("button",{onClick:()=>n(e?"/lab":-1),className:"lab-inventory-button lab-inventory-button-secondary",disabled:f,children:[i.jsx(rn,{size:16,style:{marginRight:"5px"}}),e?"Back to Lab Panel":"Back"]}),i.jsxs("div",{style:{display:"flex",gap:"8px",marginLeft:"10px"},children:[i.jsxs("button",{onClick:()=>V(null),className:"lab-inventory-button",title:"Print Full Report",children:[i.jsx(Qo,{size:16,style:{marginRight:"5px"}})," Print All"]}),i.jsxs("button",{onClick:ae,className:"lab-inventory-button",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},title:"Share via WhatsApp",children:[i.jsx(Dk,{size:16,style:{marginRight:"5px"}})," WhatsApp"]})]})]}),t&&i.jsxs("div",{className:"lab-inventory-card no-print",style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:[i.jsx(Ko,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}})," Order Summary"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"10px",fontSize:"0.95em"},children:[i.jsxs("div",{children:[i.jsx(Ys,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Patient:"})," ",ce??"N/A"," (Token: ",ue??"N/A",")"]}),i.jsxs("div",{children:[i.jsx(ON,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Order Date:"})," ",z?i.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"5px"},children:[i.jsx("input",{type:"datetime-local",value:L,onChange:W=>U(W.target.value),className:"lab-inventory-input",style:{padding:"2px 5px",fontSize:"0.9em",width:"auto"}}),i.jsx("button",{onClick:le,className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Save Date",children:i.jsx(Jx,{size:16,color:"green"})}),i.jsx("button",{onClick:()=>{if(F(!1),t.createdAt){const W=new Date(t.createdAt),oe=new Date(W.getTime()-W.getTimezoneOffset()*6e4).toISOString().slice(0,16);U(oe)}},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Cancel",children:i.jsx(zn,{size:16,color:"red"})})]}):i.jsxs(i.Fragment,{children:[Md(new Date(t.createdAt),"PPpp"),i.jsx("button",{onClick:()=>F(!0),className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"0 4px",minWidth:"auto",marginLeft:"8px",verticalAlign:"middle",border:"none"},title:"Edit Date",children:i.jsx(Qv,{size:14})})]})]}),i.jsxs("div",{children:[i.jsx(ON,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Report Date:"})," ",B?i.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"5px"},children:[i.jsx("input",{type:"datetime-local",value:D,onChange:W=>$(W.target.value),className:"lab-inventory-input",style:{padding:"2px 5px",fontSize:"0.9em",width:"auto"}}),i.jsx("button",{onClick:E,className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Save Report Date",children:i.jsx(Jx,{size:16,color:"green"})}),i.jsx("button",{onClick:()=>{if(J(!1),t.report_date){const W=new Date(t.report_date),oe=new Date(W.getTime()-W.getTimezoneOffset()*6e4).toISOString().slice(0,16);$(oe)}else{const W=new Date,oe=new Date(W.getTime()-W.getTimezoneOffset()*6e4).toISOString().slice(0,16);$(oe)}},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Cancel",children:i.jsx(zn,{size:16,color:"red"})})]}):i.jsxs(i.Fragment,{children:[t.report_date?Md(new Date(t.report_date),"PPpp"):"Not Reported",i.jsx("button",{onClick:()=>J(!0),className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"0 4px",minWidth:"auto",marginLeft:"8px",verticalAlign:"middle",border:"none"},title:"Edit Report Date",children:i.jsx(Qv,{size:14})})]})]}),i.jsxs("div",{style:{gridColumn:"1 / -1"},children:[i.jsx(a6,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Tests:"})," ",(t.tests||[]).map(W=>W.name).join(", ")]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:Ote(t.status),children:Mte(t.status)})]})]})]}),i.jsxs("div",{className:"lab-inventory-form-group no-print",style:{marginTop:"20px"},children:[i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:"Report Parameters"}),t==null?void 0:t.tests.map(W=>{var oe;return i.jsxs("div",{className:"lab-inventory-card",style:{marginBottom:"15px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"10px"},children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",margin:0},children:W.name}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[i.jsxs("button",{type:"button",onClick:se=>{se.stopPropagation(),Y(W.id)},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"4px 8px",fontSize:"0.8em"},disabled:f,children:[i.jsx(Fd,{size:14,style:{marginRight:"4px"}})," Save"]}),i.jsx("button",{type:"button",onClick:se=>{se.stopPropagation(),V(W.id)},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"4px 8px",fontSize:"0.8em",marginLeft:"5px"},title:"Print This Test Only",children:i.jsx(Qo,{size:14})})]})]}),i.jsx("div",{className:"test-parameters-body",style:{display:"block"},children:W.default_parameters&&W.default_parameters.length>0?i.jsx(i.Fragment,{children:i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{className:"lab-inventory-table",style:{marginTop:"10px",width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{backgroundColor:"#f9fafb"},children:[i.jsx("th",{style:{width:"25%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Parameter"}),i.jsx("th",{style:{width:"35%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Result"}),i.jsx("th",{style:{width:"15%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Units"}),i.jsx("th",{style:{width:"25%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Normal Range"})]})}),i.jsx("tbody",{children:W.default_parameters.map(se=>{var je,We,X,Se,Ae,Pe,Ze,rt,lt;return i.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[i.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#374151",fontWeight:"500"},children:i.jsx("label",{htmlFor:`${W.id}-${se.name}`,style:{cursor:"pointer"},children:se.name})}),i.jsx("td",{style:{padding:"10px",verticalAlign:"middle"},children:se.type==="boolean"?i.jsxs("select",{id:`${W.id}-${se.name}`,value:((We=(je=a[W.id])==null?void 0:je[se.name])==null?void 0:We.toString())??"false",onChange:ze=>Q(W.id,se.name,ze.target.value==="true"),className:"lab-inventory-input",disabled:f,style:{margin:0,width:"100%"},children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-Reactive"})]}):i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[i.jsx("input",{id:`${W.id}-${se.name}`,type:se.type==="number"?"number":"text",value:((X=a[W.id])==null?void 0:X[se.name])!==void 0?(Se=a[W.id])==null?void 0:Se[se.name]:se.defaultValue??"",onChange:ze=>{const ot=se.type==="number"&&ze.target.value===""?"":ze.target.value;Q(W.id,se.name,ot)},className:`lab-inventory-input ${se.type==="number"&&((Ae=a[W.id])==null?void 0:Ae[se.name])!==""&&(se.lower_limit!=null&&parseFloat((Pe=a[W.id])==null?void 0:Pe[se.name])<se.lower_limit||se.upper_limit!=null&&parseFloat((Ze=a[W.id])==null?void 0:Ze[se.name])>se.upper_limit)?"abnormal-result":""}`,disabled:f||Mj(se.name)&&!((rt=T[W.id])!=null&&rt[se.name]),style:{margin:0,width:"100%"}}),Mj(se.name)&&i.jsx("button",{type:"button",onClick:()=>A(ze=>{var ot;return{...ze,[W.id]:{...ze[W.id]||{},[se.name]:!((ot=ze[W.id])!=null&&ot[se.name])}}}),className:"lab-inventory-button lab-inventory-button-tertiary",style:{fontSize:"0.7em",padding:"4px 6px",height:"fit-content",whiteSpace:"nowrap"},disabled:f,title:(lt=T[W.id])!=null&&lt[se.name]?"Disable Manual Edit":"Edit Calculated Field",children:i.jsx(Qv,{size:12})})]})}),i.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#6b7280"},children:se.unit||"-"}),i.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#6b7280",fontSize:"0.9em"},children:se.type==="number"&&(se.lower_limit!==null||se.upper_limit!==null)?i.jsxs(i.Fragment,{children:[se.lower_limit!==null&&se.lower_limit!==void 0&&`> ${se.lower_limit}`,se.lower_limit!==null&&se.lower_limit!==void 0&&se.upper_limit!==null&&se.upper_limit!==void 0&&" - ",se.upper_limit!==null&&se.upper_limit!==void 0&&`< ${se.upper_limit}`]}):"-"})]},se.name)})})]})})}):i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:`${W.id}-report_content`,children:"Report Content"}),i.jsx("textarea",{id:`${W.id}-report_content`,value:((oe=a[W.id])==null?void 0:oe.report_content)??"",onChange:se=>Q(W.id,"report_content",se.target.value),className:"lab-inventory-input",rows:5,placeholder:`Enter report for ${W.name}...`,disabled:f})]})})]},W.id)}),p&&i.jsxs("p",{className:"error-text",style:{marginTop:"10px"},children:[i.jsx(Ar,{size:15,className:"inline mr-1"}),p]})]}),i.jsxs("div",{className:"no-print",style:{marginTop:"20px",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[" ",i.jsx("button",{type:"button",onClick:()=>n(-1),disabled:f,className:"lab-inventory-button lab-inventory-button-secondary",children:"Cancel"}),i.jsx("button",{type:"button",onClick:re,disabled:f,className:"lab-inventory-button",children:f?i.jsxs(i.Fragment,{children:[i.jsx(Od,{className:"animate-spin mr-2",size:16})," Submitting..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Fd,{size:16,style:{marginRight:"5px"}})," Submit Full Report"]})})]}),i.jsxs("div",{className:"printable-only",children:[t&&t.Patient&&i.jsxs("div",{style:{marginBottom:"20px",borderBottom:"1px solid #ccc",paddingBottom:"10px"},children:[i.jsx("h2",{style:{textAlign:"center",marginBottom:"15px"},children:"Lab Report"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",fontSize:"12px"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Patient Name:"})," ",t.Patient.name]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Age/Sex:"})," ",b??"N/A"," / ",S??"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Ref. Doctor:"})," ",t.uploaded_by||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Date:"})," ",Md(new Date,"PPpp")]})]})]}),t==null?void 0:t.tests.filter(W=>M===null||W.id===M).map(W=>{var oe;return i.jsxs("div",{style:{marginBottom:"20px",pageBreakInside:"avoid"},children:[i.jsx("h3",{style:{borderBottom:"1px solid #eee",paddingBottom:"5px"},children:W.name}),W.default_parameters&&W.default_parameters.length>0?i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{backgroundColor:"#f9f9f9"},children:[i.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Parameter"}),i.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Result"}),i.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Units"}),i.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Normal Range"})]})}),i.jsx("tbody",{children:W.default_parameters.map(se=>{var Pe;const je=(Pe=a[W.id])==null?void 0:Pe[se.name],We=typeof je=="string"?parseFloat(je):typeof je=="number"?je:NaN,X=se.type==="number"&&!isNaN(We)&&je!==""&&(se.lower_limit!=null&&We<se.lower_limit||se.upper_limit!=null&&We>se.upper_limit),Se=se.type==="boolean"&&(je===!0||je==="true"),Ae=se.type==="boolean"?je===!0||je==="true"?"Reactive":"Non-Reactive":je??"";return i.jsxs("tr",{children:[i.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:se.name}),i.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee",fontWeight:X||Se?"bold":"normal",color:X?"red":Se?"green":"inherit"},children:Ae}),i.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:se.unit??""}),i.jsxs("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:[se.lower_limit!==null&&se.lower_limit!==void 0&&`> ${se.lower_limit}`,se.lower_limit!==null&&se.lower_limit!==void 0&&se.upper_limit!==null&&se.upper_limit!==void 0&&" - ",se.upper_limit!==null&&se.upper_limit!==void 0&&`< ${se.upper_limit}`]})]},se.name)})})]}):i.jsx("div",{style:{whiteSpace:"pre-wrap",fontSize:"12px",padding:"10px"},children:((oe=a[W.id])==null?void 0:oe.report_content)||"No report content entered."})]},W.id)})]})]})})},Mte=e=>e?e.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()):"Unknown",Ote=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},Lte=()=>{const{orderId:e}=Gi(),n=Et(),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),f=w.useCallback(async p=>{if(!p){d("No Order ID specified in the URL."),o(!1),r(null);return}o(!0),d(null),r(null);try{console.log(`Fetching order details for ID: ${p}`);const g=await pe(`/api/lab/orders/${p}/report`);if(!g.ok){let v;try{v=await g.json()}catch{v={message:`Server returned status ${g.status}`}}throw console.error("Fetch order details error response:",v),new Error(v.message||`Failed to fetch order details: ${g.status}`)}const b=await g.json();if(console.log("Received order data:",b),!b)throw console.error("Invalid order data structure:",b),new Error("Invalid order data received from server.");r(b)}catch(g){console.error("Error fetching order details:",g),d(g instanceof Error?g.message:"An unknown error occurred while fetching the order details")}finally{o(!1)}},[pe]);w.useEffect(()=>{f(e)},[e,f]);const u=()=>{t&&Jw(t)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:0,paddingBottom:0,borderBottom:"none"},children:[i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:"Lab Report Viewer"})," ",i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs(hs,{to:"/lab/search-report",className:"lab-inventory-button","aria-label":"Search for other reports",children:[i.jsx(Hi,{size:16,style:{marginRight:"5px"}}),"Search Reports"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(rn,{size:16,style:{marginRight:"5px"}}),"Back"]}),i.jsxs("button",{onClick:()=>window.print(),className:"lab-inventory-button","aria-label":"Print report",children:[i.jsx(Qo,{size:16,style:{marginRight:"5px"}}),"Print"]}),i.jsxs("button",{onClick:u,className:"lab-inventory-button","aria-label":"Share report via WhatsApp",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},children:[i.jsx(Dk,{size:16,style:{marginRight:"5px"}}),"WhatsApp"]})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:["Report Details (Order ID: ",e||"None Specified",")"]}),a&&i.jsx("div",{className:"loading-text",children:"Loading report..."}),l&&!a&&i.jsxs("div",{className:"error-message-container",style:{textAlign:"center"},children:[i.jsx(Ar,{size:48}),i.jsx("h3",{className:"error-title",children:"Error Loading Report"}),i.jsx("p",{children:l}),e&&i.jsx("button",{onClick:()=>f(e),className:"retry-button",children:"Retry"})]}),i.jsxs("div",{className:"printable-section",children:[!a&&!l&&(t==null?void 0:t.Patient)&&i.jsxs("div",{className:"lab-inventory-card",style:{marginBottom:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(Ys,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Patient Information"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"10px",fontSize:"0.9em"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Name:"})," ",t.Patient.name||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Age:"})," ",t.Patient.age??"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Gender:"})," ",t.Patient.gender||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Token No:"})," ",t.Patient.patient_token_number||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Patient ID:"})," ",t.Patient.id]}),t.Patient.phone&&i.jsxs("div",{children:[i.jsx("strong",{children:"Phone:"})," ",t.Patient.phone]})]})]}),!a&&!l&&(t==null?void 0:t.report_content)&&i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(du,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Report Findings"]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6"},children:(()=>{try{const p=JSON.parse(t.report_content||"{}");return typeof p=="object"&&p!==null&&t.tests?t.tests.map(g=>i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em"},children:g.name}),p[g.id]?i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Parameter"}),i.jsx("th",{children:"Value"}),i.jsx("th",{children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(p[g.id]).map(([b,v])=>{var R;const S=(R=g.default_parameters)==null?void 0:R.find(z=>z.name===b),k=typeof v=="string"?parseFloat(v):typeof v=="number"?v:NaN,T=(S==null?void 0:S.type)==="number"&&!isNaN(k)&&(S.lower_limit!=null&&k<S.lower_limit||S.upper_limit!=null&&k>S.upper_limit),A=(S==null?void 0:S.type)==="boolean"?v===!0||v==="true"?"Reactive":"Non-Reactive":String(v),M=(S==null?void 0:S.type)==="boolean"&&(v===!0||v==="true");return i.jsxs("tr",{children:[i.jsx("td",{children:b}),i.jsxs("td",{className:`${T?"abnormal-result":""} ${M?"reactive-result":""}`,children:[A," ",S==null?void 0:S.unit]}),i.jsx("td",{children:S&&S.type==="number"&&(S.lower_limit!==null||S.upper_limit!==null)?i.jsxs(i.Fragment,{children:[S.lower_limit!=null&&` > ${S.lower_limit}`,S.lower_limit!=null&&S.upper_limit!=null&&" - ",S.upper_limit!=null&&` < ${S.upper_limit}`,S.unit&&` ${S.unit}`]}):((S==null?void 0:S.type)==="boolean","N/A")})]},b)})})]}):i.jsx("p",{children:"No parameters reported for this test."})]},g.id)):i.jsx(Vs,{remarkPlugins:[ds],children:t.report_content})}catch{return i.jsx(Vs,{remarkPlugins:[ds],children:t.report_content||"*No findings recorded.*"})}})()})]})]}),!a&&!l&&!(t!=null&&t.report_content)&&!(t!=null&&t.Patient)&&e&&i.jsxs("div",{className:"no-data-message",children:["No report content or patient details found for Order ID: ",e,". The order might be processing, does not exist, or the ID is incorrect."]}),!e&&!a&&!l&&i.jsxs("div",{className:"no-data-message",children:["No order ID specified in the URL.",i.jsx(hs,{to:"/lab/search-report",className:"lab-inventory-link",style:{display:"block",marginTop:"10px"},children:"Go to Search Page"})]})]})]})})},Fte=()=>{const e=Et(),[n,t]=w.useState(""),[r,a]=w.useState(!1),[o,l]=w.useState([]),[d,f]=w.useState(null),[u,p]=w.useState(n);w.useEffect(()=>{const k=setTimeout(()=>{p(n)},500);return()=>{clearTimeout(k)}},[n]),w.useEffect(()=>{g()},[u]);const g=async()=>{const k=n.trim();if(!k){l([]),f(null);return}a(!0),f(null),l([]),console.log(`Searching for: ${k}`);try{const T=await pe("/api/lab");if(!T.ok){let L;try{L=await T.json()}catch{L={message:`Server returned status ${T.status}`}}throw console.error("Search fetch error response:",L),new Error(L.message||`HTTP error! status: ${T.status}`)}const{orders:A}=await T.json();console.log("Received lab orders for search:",A);const R=A.filter(L=>!!L.report_content).map(L=>{var U,B;return{id:L.id,labTokenNumber:String(L.lab_token_number??"N/A"),patientName:((U=L.Patient)==null?void 0:U.name)||"N/A",patientId:L.patient_id,patientTokenNumber:String(((B=L.Patient)==null?void 0:B.patient_token_number)??"N/A"),tests:(L.tests||[]).map(J=>J.name||"Unknown Test"),date:Md(new Date(L.createdAt),"yyyy-MM-dd"),status:L.status}}),z=n.toLowerCase(),F=R.filter(L=>{var J,D,$,H,te;const U=String(L.labTokenNumber).toLowerCase(),B=String(L.patientTokenNumber).toLowerCase();return(((J=L.patientName)==null?void 0:J.toLowerCase())||"").includes(z)||U.includes(z)||B.includes(z)||((($=(D=L.tests)==null?void 0:D.join(" "))==null?void 0:$.toLowerCase())||"").includes(z)||(((H=L.id)==null?void 0:H.toLowerCase())||"").includes(z)||(((te=L.patientId)==null?void 0:te.toLowerCase())||"").includes(z)});console.log("Filtered search results:",F),l(F),F.length===0&&k?f(`No matching reports found for "${k}".`):f(null)}catch(T){console.error("Failed to search lab reports:",T),f(T instanceof Error?T.message:"An unknown error occurred during search")}finally{a(!1)}},b=k=>{console.log(`Result clicked, navigating to view report for order ID: ${k}`),e(`/lab/view-report/${k}`)},v=k=>{switch(k){case"pending":return{text:"Sample Pending",color:"text-red-600 bg-red-100"};case"collected":return{text:"Sample Collected",color:"text-yellow-600 bg-yellow-100"};case"processing":return{text:"Processing",color:"text-blue-600 bg-blue-100"};case"completed":return{text:"Completed",color:"text-green-600 bg-green-100"};case"cancelled":return{text:"Cancelled",color:"text-gray-600 bg-gray-100 line-through"};case"reported":return{text:"Reported",color:"text-purple-600 bg-purple-100"};default:return{text:k,color:"text-gray-600 bg-gray-100"}}},S=k=>{switch(k){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h2",{style:{margin:0},children:"Search Lab Reports"}),i.jsxs("button",{onClick:()=>e(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(rn,{size:16,style:{marginRight:"5px"}}),"Back"]})]}),i.jsxs("div",{className:"lab-inventory-form-group",style:{marginTop:"20px",position:"relative"},children:[i.jsx("label",{htmlFor:"report-search",children:"Enter Search Term"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",position:"relative"},children:[i.jsx(Hi,{size:20,style:{position:"absolute",left:"10px",color:"#777"}}),i.jsx("input",{id:"report-search",type:"text",placeholder:"Patient name, ID, token, report ID, test name...",value:n,onChange:k=>t(k.target.value),className:"lab-inventory-input",style:{paddingLeft:"40px",marginBottom:"0"}})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[r&&i.jsx("div",{className:"loading-text",children:"Searching..."}),d&&!r&&i.jsxs("div",{className:"error-text",children:[i.jsx(Ar,{size:20,className:"inline mr-2"})," ",d]}),o.length>0&&!r&&i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:o.map(k=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(k.id),style:{marginBottom:"15px",cursor:"pointer",padding:"15px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:[i.jsx(M3,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}}),k.patientName," (Token: ",k.patientTokenNumber,")"]}),i.jsx("span",{className:S(k.status),children:v(k.status).text})]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:[i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(du,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Order ID: ",k.id]}),i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(K6,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Tests: ",k.tests.join(", ")]}),i.jsxs("div",{children:[i.jsx(S3,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Date: ",k.date]})]})]},k.id))}),!r&&o.length===0&&!d&&n.trim()&&i.jsxs("div",{className:"no-data-message",children:['No results found for "',n,'".']}),!r&&o.length===0&&!d&&!n.trim()&&i.jsx("div",{className:"no-data-message",style:{backgroundColor:"transparent",border:"none",textAlign:"left",padding:"5px 0"},children:"Enter a search term above to find lab reports."})]})]})})},$te=()=>{const{patientId:e}=Gi(),n=Et(),[t,r]=w.useState([]),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(null),[p,g]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){d("Patient ID is missing from the URL."),o(!1);return}o(!0),d(null),r([]),g(null);try{const S=await pe(`/api/patients/${e}`);if(S.ok){const A=await S.json();g(A.name||`Patient ID: ${e}`)}else console.warn(`Failed to fetch patient name for ID ${e}`),g(`Patient ID: ${e}`);const k=await pe(`/api/lab/patient/${e}`);if(!k.ok){const A=await k.json().catch(()=>({}));throw new Error(A.message||`HTTP error! status: ${k.status}`)}const T=await k.json();r(T||[])}catch(S){console.error("Error fetching data:",S),d(`Failed to load data: ${S.message}`)}finally{o(!1)}})()},[e]);const b=v=>{v.report_content?n(`/lab/view-report/${v.id}`):n(`/lab/enter-report/${v.id}`)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("h2",{style:{margin:0},children:["Lab Reports ",p?`for ${p}`:`for Patient ID: ${e}`]}),i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs("button",{onClick:async()=>{if(!e){alert("Patient ID is missing. Cannot create a new report.");return}try{const v=await pe("/api/lab/create-empty-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:e})});if(!v.ok){const k=await v.json().catch(()=>({message:`Failed to create new lab order: ${v.status}`}));throw new Error(k.message||`Failed to create new lab order: ${v.status}`)}const S=await v.json();n(`/lab/enter-report/${S.newOrderId}`)}catch(v){console.error("Error creating new lab order:",v),alert(`Error creating new lab order: ${v.message}`)}},className:"lab-inventory-button",disabled:!e,title:e?"Enter a new lab report for this patient":"Patient ID missing",children:[i.jsx(Ra,{size:16,style:{marginRight:"5px"}}),"Enter New Report"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",children:[i.jsx(rn,{size:16,style:{marginRight:"5px"}}),"Back"]})]})]}),i.jsx("div",{style:{marginTop:"20px"},children:a?i.jsxs("div",{className:"loading-text",children:[i.jsx(Od,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading reports..."]}):l?i.jsxs("div",{className:"error-text",style:{textAlign:"center",padding:"20px"},children:[i.jsx(eF,{size:40,style:{marginBottom:"10px",color:"#721c24"}}),i.jsx("h3",{style:{fontSize:"1.2em",color:"#721c24",margin:"10px 0"},children:"Error Loading Reports"}),i.jsx("p",{children:l})]}):t.length===0?i.jsxs("div",{className:"no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(du,{size:48,className:"mb-3",style:{margin:"0 auto 15px auto",display:"block"}}),i.jsx("p",{children:"No lab reports found for this patient."}),i.jsxs("p",{children:["You can ",i.jsx(hs,{to:`/lab/create-order/${e}`,className:"lab-inventory-link",children:"create a new lab order"}),"."]})]}):f?i.jsxs("div",{className:"lab-inventory-card",style:{backgroundColor:"#fdfdfd"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.3em",borderBottom:"none",margin:0},children:["Report from: ",f.report_date?Md(new Date(f.report_date),"PPP p"):"N/A"]}),i.jsxs("button",{onClick:()=>u(null),className:"lab-inventory-button lab-inventory-button-secondary",style:{fontSize:"0.9em",padding:"8px 12px"},children:[i.jsx(rn,{size:16,style:{marginRight:"5px"}})," Back to List"]})]}),i.jsxs("p",{style:{marginBottom:"15px",fontSize:"1em"},children:[i.jsx("strong",{children:"Tests Ordered:"})," ",(f.tests||[]).map(v=>v.name).join(", ")]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6",border:"1px solid #eee",padding:"15px",borderRadius:"4px",background:"#fff"},children:i.jsx(Vs,{remarkPlugins:[ds],children:f.report_content||"*No findings recorded.*"})})]}):i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:t.map(v=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(v),tabIndex:0,onKeyPress:S=>S.key==="Enter"&&b(v),style:{marginBottom:"15px",cursor:"pointer",padding:"15px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx(du,{size:24,style:{marginRight:"15px",color:"#007bff"}}),i.jsxs("div",{children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:["Order Date: ",Md(new Date(v.createdAt),"PPP")]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:["Tests: ",v.tests&&v.tests.length>0?v.tests.map(S=>S.name).join(", "):"N/A"]})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[v.status&&i.jsx("span",{className:Ute(v.status),children:zte(v.status)}),i.jsx(Vd,{size:20,style:{color:"#6c757d"}})]})]},v.id))})})]})})},zte=e=>{if(!e)return"Unknown";switch(e.toLowerCase()){case"pending":return"Pending Sample";case"collected":return"Sample Collected";case"processing":return"Processing";case"report_ready":return"Report Ready";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return e.charAt(0).toUpperCase()+e.slice(1)}},Ute=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},kA=()=>{const e=Et(),[n,t]=w.useState("pharmacy");return i.jsxs("div",{className:"inventory-management-container",style:{padding:"20px",backgroundColor:"var(--background-color)",minHeight:"100vh"},children:[i.jsxs("div",{className:"inventory-header",style:{marginBottom:"20px",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"15px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsx("button",{onClick:()=>e(-1),className:"action-icon-button",title:"Go Back",style:{background:"none",border:"none",cursor:"pointer",color:"var(--text-primary)"},children:i.jsx(rn,{size:24})}),i.jsx("h1",{style:{margin:0,fontSize:"1.8rem",fontWeight:"700",color:"var(--text-primary)"},children:"Inventory Management"})]}),i.jsxs("div",{className:"inventory-tabs",style:{display:"flex",gap:"5px",backgroundColor:"var(--card-bg, #f3f4f6)",padding:"5px",borderRadius:"12px",border:"1px solid var(--border-color, #e5e7eb)"},children:[i.jsxs("button",{onClick:()=>t("pharmacy"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 24px",border:"1px solid",borderColor:n==="pharmacy"?"var(--primary-color-20, #e0e7ff)":"transparent",borderRadius:"8px",backgroundColor:n==="pharmacy"?"var(--card-bg-active, #fff)":"transparent",boxShadow:n==="pharmacy"?"0 2px 4px rgba(0,0,0,0.05)":"none",color:n==="pharmacy"?"var(--primary-color)":"var(--text-secondary, #6b7280)",fontWeight:n==="pharmacy"?"600":"500",cursor:"pointer",transition:"all 0.2s ease",fontSize:"0.95rem"},children:[i.jsx(og,{size:18}),"Pharmacy Stock"]}),i.jsxs("button",{onClick:()=>t("lab"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 24px",border:"1px solid",borderColor:n==="lab"?"var(--primary-color-20, #e0e7ff)":"transparent",borderRadius:"8px",backgroundColor:n==="lab"?"var(--card-bg-active, #fff)":"transparent",boxShadow:n==="lab"?"0 2px 4px rgba(0,0,0,0.05)":"none",color:n==="lab"?"var(--primary-color)":"var(--text-secondary, #6b7280)",fontWeight:n==="lab"?"600":"500",cursor:"pointer",transition:"all 0.2s ease",fontSize:"0.95rem"},children:[i.jsx(Jl,{size:18}),"Lab Stock"]})]})]}),i.jsx("div",{className:"inventory-content",style:{backgroundColor:"var(--card-bg, #fff)",borderRadius:"16px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",overflow:"hidden"},children:n==="pharmacy"?i.jsx(SE,{isEmbedded:!0}):i.jsx(Qw,{isEmbedded:!0})})]})},Bte=({fetchWithAuth:e})=>{const n=Et(),[t,r]=w.useState(!0),[a,o]=w.useState([]),[l,d]=w.useState(null),[f,u]=w.useState(null),p=w.useCallback(async()=>{r(!0),d(null);try{const S=await(await e("/staff")).json();o(S.map(k=>({...k,id:k._id||k.id})))}catch(v){d(`Failed to load staff data: ${v.message}`),o([])}finally{r(!1)}},[e]);w.useEffect(()=>{p()},[p]),w.useEffect(()=>{if(f){const v=setTimeout(()=>u(null),5e3);return()=>clearTimeout(v)}},[f]);const g=v=>{switch(v){case"doctor":return"admin-pill-info";case"receptionist":return"admin-pill-success";case"pharmacy":return"admin-pill-primary";case"lab":return"admin-pill-warning";case"admin":return"admin-pill-neutral";default:return"admin-pill-neutral"}},b=v=>{switch(v){case"doctor":return i.jsx(Ik,{size:16,className:"mr-2 text-blue-600"});case"receptionist":return i.jsx(gw,{size:16,className:"mr-2 text-green-600"});case"pharmacy":return i.jsx(og,{size:16,className:"mr-2 text-purple-600"});case"lab":return i.jsx(Jl,{size:16,className:"mr-2 text-yellow-600"});case"admin":return i.jsx(jb,{size:16,className:"mr-2 text-teal-600"});default:return i.jsx(Bh,{size:16,className:"mr-2 text-gray-500"})}};return t?i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:[" ",i.jsx("div",{className:"breathing-ball",style:{width:"30px",height:"30px"}})," "]}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Staff..."})]})}):i.jsxs("div",{className:"staff-page-container",children:[f&&i.jsxs("div",{className:`mb-4 p-3 rounded-md flex items-center ${f.type==="success"?"bg-green-100 border border-green-400 text-green-700":"bg-red-100 border border-red-400 text-red-700"}`,role:"alert",children:[f.type==="success"?i.jsx(ps,{size:18,className:"mr-2"}):i.jsx(Ar,{size:18,className:"mr-2"}),i.jsx("span",{children:f.message}),i.jsx("button",{onClick:()=>u(null),className:"ml-auto text-xl font-bold",children:""})]}),l&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",role:"alert",children:[i.jsx(Ar,{size:18,className:"mr-2 text-red-500"}),l,i.jsx("button",{onClick:()=>d(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"p-2 rounded-md hover:bg-gray-200",children:i.jsx(rn,{size:20})}),i.jsx("h1",{className:"text-2xl font-bold",children:"Manage Staff"})]}),i.jsxs("button",{onClick:()=>n("/dashboard/staff/add"),className:"bg-teal-600 text-white px-4 py-2 rounded-md hover:bg-teal-700 flex items-center",children:[i.jsx(Zo,{size:16,className:"mr-2"})," Add New Staff"]})]}),i.jsx("div",{className:"staff-table-container",children:i.jsxs("table",{className:"staff-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{className:"hidden md:table-cell",children:"Email"}),i.jsx("th",{children:"Role"}),i.jsx("th",{className:"hidden md:table-cell",children:"OPD Fee ()"}),i.jsx("th",{className:"hidden md:table-cell",children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:a.length===0&&!t?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-4",children:"No staff members found."})}):a.map(v=>i.jsxs("tr",{children:[i.jsx("td",{children:v.name}),i.jsx("td",{className:"hidden md:table-cell",children:v.email}),i.jsx("td",{children:i.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g(v.role)}`,children:[b(v.role),v.role.charAt(0).toUpperCase()+v.role.slice(1)]})}),i.jsx("td",{className:"hidden md:table-cell",children:v.role==="doctor"?v.opd_fee?parseFloat(String(v.opd_fee)).toFixed(2):"Not Set":"N/A"}),i.jsx("td",{className:"hidden md:table-cell",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.status==="active"?"Active":"Inactive"})}),i.jsx("td",{className:"actions",children:i.jsxs("button",{onClick:()=>n(`/dashboard/staff/edit/${v.id}`),className:"edit-link",disabled:v.role==="admin",title:"Edit Staff",children:[i.jsx(Kl,{size:16})," Edit"]})})]},v.id))})]})})]})},qte=()=>{var k,T,A,M,R,z,F,L,U,B,J,D,$,H;const{patientId:e,billId:n}=Gi(),t=Et(),[r,a]=w.useState(null),[o,l]=w.useState(!0),[d,f]=w.useState(null),[u,p]=w.useState(""),[g,b]=w.useState("cash"),v=((k=r==null?void 0:r.patient)==null?void 0:k.insurance_type)==="no_cash_insurance";w.useEffect(()=>{b(v?"no_cash_insurance":"cash")},[v]),w.useEffect(()=>{n?(async()=>{l(!0),f(null);try{const Q=await pe(`/api/bills/${n}`);if(!Q.ok)throw new Error(`HTTP error! status: ${Q.status}`);const Y=await Q.json();if(!Y||!Y.bill||!Y.calculated)throw new Error("Incomplete data structure received from backend (missing bill or calculated fields).");if(Y.bill.type!=="admission")throw console.error("Fetched bill is not an admission bill. Bill Type:",Y.bill.type),new Error(`Unexpected bill type received: ${Y.bill.type}. Expected 'admission'.`);console.log("Raw API data received:",JSON.stringify(Y,null,2));const V=Array.isArray(Y.admissionPayments)?Y.admissionPayments:[];console.log("Processed admissionPaymentsData:",V);const ae={...Y.bill,amount:Y.bill.amount,AdmissionPayments:V,calculated:Y.calculated,patient:Y.bill.Patient?{id:Y.bill.Patient.id,name:Y.bill.Patient.name,admission_date:Y.bill.Patient.admission_date,discharge_date:Y.bill.Patient.discharge_date}:void 0};console.log("Setting billDetails state to:",JSON.stringify(ae,null,2)),a(ae)}catch(Q){console.error("Failed to fetch admission bill details:",Q),f(Q instanceof Error?Q.message:"An unknown error occurred")}finally{l(!1)}})():(f("Bill ID is missing."),l(!1))},[n,e]);const S=async te=>{var Q;if(te.preventDefault(),!e||!u||isNaN(parseFloat(u))||parseFloat(u)<=0||parseFloat(u)>(((Q=r==null?void 0:r.calculated)==null?void 0:Q.balance)??0)){f("Please enter a valid payment amount within the balance due. Patient ID must be present.");return}f(null);try{const Y=await pe(`/api/patients/${e}/admission-payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount_paid:parseFloat(u),payment_mode:g})});if(!Y.ok){const re=await Y.json();throw new Error(re.message||`HTTP error! status: ${Y.status}`)}const ae=await(await pe(`/api/bills/${n}`)).json();if(ae&&ae.bill&&ae.calculated&&ae.admissionPayments)a({...ae.bill,amount:parseFloat(ae.bill.amount),AdmissionPayments:ae.admissionPayments,calculated:ae.calculated,patient:ae.bill.Patient?{id:ae.bill.Patient.id,name:ae.bill.Patient.name,admission_date:ae.bill.Patient.admission_date,discharge_date:ae.bill.Patient.discharge_date}:void 0});else throw new Error("Invalid data structure received after payment submission.");p("")}catch(Y){console.error("Failed to submit payment:",Y),f(Y instanceof Error?Y.message:"Failed to record payment")}};return o?i.jsx("div",{className:"p-4",children:"Loading admission bill details..."}):d?i.jsxs("div",{className:"p-4 text-red-600",children:["Error: ",d]}):!r||!r.calculated?i.jsx("div",{className:"p-4",children:"No bill details found or data is incomplete."}):i.jsx("div",{className:"admission-page-container",children:i.jsxs("div",{className:"admission-section",children:[" ",i.jsxs("div",{className:"p-4 border-b",children:[" ",i.jsxs("h2",{className:"admission-header",children:["Admission Billing Details (Bill #",r.id,")"]}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Patient: ",((T=r.patient)==null?void 0:T.name)??"N/A"," (ID: ",r.patient_id,")"]})," ",i.jsxs("p",{className:"text-sm text-gray-600",children:["Admission Date: ",(A=r.patient)!=null&&A.admission_date?new Date(r.patient.admission_date).toLocaleDateString():"N/A"]}),((M=r.patient)==null?void 0:M.discharge_date)&&i.jsxs("p",{className:"text-sm text-gray-600",children:["Discharge Date: ",new Date(r.patient.discharge_date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm",children:["Status: ",i.jsx("span",{className:`font-semibold ${r.status==="paid"?"text-green-600":"text-orange-600"}`,children:((R=r.status)==null?void 0:R.toUpperCase())??"UNKNOWN"})]})]}),i.jsxs("div",{className:"p-4",children:[" ",i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Initial Charges:"})," ",i.jsxs("span",{children:["",(parseFloat((r==null?void 0:r.amount)||"0")||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Days Stayed:"})," ",i.jsx("span",{children:((z=r==null?void 0:r.calculated)==null?void 0:z.daysStayed)??0})]}),i.jsxs("p",{className:"flex justify-between text-sm font-semibold mt-2 pt-2 border-t",children:[i.jsx("span",{children:"Total Due:"})," ",i.jsxs("span",{children:["",(Number((F=r==null?void 0:r.calculated)==null?void 0:F.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[i.jsx("span",{children:"Total Paid:"})," ",i.jsxs("span",{children:["",(Number((L=r==null?void 0:r.calculated)==null?void 0:L.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-lg font-bold mt-1 text-red-600",children:[i.jsx("span",{children:"Balance Due:"})," ",i.jsxs("span",{children:["",(Number((U=r==null?void 0:r.calculated)==null?void 0:U.balance)||0).toFixed(2)]})]})]})]}),(r==null?void 0:r.status)!=="paid"&&(Number((B=r==null?void 0:r.calculated)==null?void 0:B.balance)||0)>0&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title text-blue-800",children:"Record New Payment"}),i.jsxs("form",{onSubmit:S,className:"space-y-4",children:[i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentAmount",className:"admission-label",children:"Amount Paid ()"}),i.jsx("input",{id:"paymentAmount",type:"number",value:u,onChange:te=>p(te.target.value),placeholder:`Max ${(Number((J=r==null?void 0:r.calculated)==null?void 0:J.balance)||0).toFixed(2)}`,required:!0,min:"0.01",step:"0.01",max:Number((D=r==null?void 0:r.calculated)==null?void 0:D.balance)||0,className:"admission-input"})]}),i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentMode",className:"admission-label",children:"Payment Mode"}),i.jsxs("select",{id:"paymentMode",value:g,onChange:te=>b(te.target.value),className:"admission-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"upi",children:"UPI"}),v&&i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),i.jsx("button",{type:"submit",className:"admission-button",disabled:o||!u||parseFloat(u)<=0||parseFloat(u)>(Number(($=r==null?void 0:r.calculated)==null?void 0:$.balance)||0)||v&&g!=="no_cash_insurance",children:"Record Payment"})]})]})]}),i.jsx("h3",{className:"admission-section-title mt-6 border-t pt-4",children:"Admission Payment History"}),Array.isArray(r==null?void 0:r.AdmissionPayments)&&r.AdmissionPayments.length>0?i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"admission-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Payment ID"}),i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Mode"})]})}),i.jsx("tbody",{children:(H=r==null?void 0:r.AdmissionPayments)==null?void 0:H.map(te=>{if(!te||typeof te!="object")return null;let Q="Invalid Date";try{te.payment_date&&!isNaN(new Date(te.payment_date).getTime())&&(Q=new Date(te.payment_date).toLocaleString())}catch(Y){console.error("Error formatting payment date:",te.payment_date,Y)}return i.jsxs("tr",{children:[" ",i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:te.id??"N/A"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Q}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["",(Number(te.amount_paid)||0).toFixed(2)]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:te.payment_mode??"N/A"})]},te.id??Math.random())})})]})]}):i.jsx("p",{className:"text-gray-500 text-sm",children:"No payments recorded yet."})]}),i.jsxs("div",{className:"p-4 border-t bg-gray-50 text-right",children:[" ",i.jsx("button",{type:"button",onClick:()=>t(-1),className:"admission-button admission-button-secondary",children:"Back"})]})]})})};var Vte=Object.defineProperty,yb=Object.getOwnPropertySymbols,TA=Object.prototype.hasOwnProperty,EA=Object.prototype.propertyIsEnumerable,Lj=(e,n,t)=>n in e?Vte(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,tw=(e,n)=>{for(var t in n||(n={}))TA.call(n,t)&&Lj(e,t,n[t]);if(yb)for(var t of yb(n))EA.call(n,t)&&Lj(e,t,n[t]);return e},nw=(e,n)=>{var t={};for(var r in e)TA.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&yb)for(var r of yb(e))n.indexOf(r)<0&&EA.call(e,r)&&(t[r]=e[r]);return t};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Bd;(e=>{const n=class pn{constructor(f,u,p,g){if(this.version=f,this.errorCorrectionLevel=u,this.modules=[],this.isFunction=[],f<pn.MIN_VERSION||f>pn.MAX_VERSION)throw new RangeError("Version value out of range");if(g<-1||g>7)throw new RangeError("Mask value out of range");this.size=f*4+17;let b=[];for(let S=0;S<this.size;S++)b.push(!1);for(let S=0;S<this.size;S++)this.modules.push(b.slice()),this.isFunction.push(b.slice());this.drawFunctionPatterns();const v=this.addEccAndInterleave(p);if(this.drawCodewords(v),g==-1){let S=1e9;for(let k=0;k<8;k++){this.applyMask(k),this.drawFormatBits(k);const T=this.getPenaltyScore();T<S&&(g=k,S=T),this.applyMask(k)}}a(0<=g&&g<=7),this.mask=g,this.applyMask(g),this.drawFormatBits(g),this.isFunction=[]}static encodeText(f,u){const p=e.QrSegment.makeSegments(f);return pn.encodeSegments(p,u)}static encodeBinary(f,u){const p=e.QrSegment.makeBytes(f);return pn.encodeSegments([p],u)}static encodeSegments(f,u,p=1,g=40,b=-1,v=!0){if(!(pn.MIN_VERSION<=p&&p<=g&&g<=pn.MAX_VERSION)||b<-1||b>7)throw new RangeError("Invalid value");let S,k;for(S=p;;S++){const R=pn.getNumDataCodewords(S,u)*8,z=l.getTotalBits(f,S);if(z<=R){k=z;break}if(S>=g)throw new RangeError("Data too long")}for(const R of[pn.Ecc.MEDIUM,pn.Ecc.QUARTILE,pn.Ecc.HIGH])v&&k<=pn.getNumDataCodewords(S,R)*8&&(u=R);let T=[];for(const R of f){t(R.mode.modeBits,4,T),t(R.numChars,R.mode.numCharCountBits(S),T);for(const z of R.getData())T.push(z)}a(T.length==k);const A=pn.getNumDataCodewords(S,u)*8;a(T.length<=A),t(0,Math.min(4,A-T.length),T),t(0,(8-T.length%8)%8,T),a(T.length%8==0);for(let R=236;T.length<A;R^=253)t(R,8,T);let M=[];for(;M.length*8<T.length;)M.push(0);return T.forEach((R,z)=>M[z>>>3]|=R<<7-(z&7)),new pn(S,u,M,b)}getModule(f,u){return 0<=f&&f<this.size&&0<=u&&u<this.size&&this.modules[u][f]}getModules(){return this.modules}drawFunctionPatterns(){for(let p=0;p<this.size;p++)this.setFunctionModule(6,p,p%2==0),this.setFunctionModule(p,6,p%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const f=this.getAlignmentPatternPositions(),u=f.length;for(let p=0;p<u;p++)for(let g=0;g<u;g++)p==0&&g==0||p==0&&g==u-1||p==u-1&&g==0||this.drawAlignmentPattern(f[p],f[g]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(f){const u=this.errorCorrectionLevel.formatBits<<3|f;let p=u;for(let b=0;b<10;b++)p=p<<1^(p>>>9)*1335;const g=(u<<10|p)^21522;a(g>>>15==0);for(let b=0;b<=5;b++)this.setFunctionModule(8,b,r(g,b));this.setFunctionModule(8,7,r(g,6)),this.setFunctionModule(8,8,r(g,7)),this.setFunctionModule(7,8,r(g,8));for(let b=9;b<15;b++)this.setFunctionModule(14-b,8,r(g,b));for(let b=0;b<8;b++)this.setFunctionModule(this.size-1-b,8,r(g,b));for(let b=8;b<15;b++)this.setFunctionModule(8,this.size-15+b,r(g,b));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let f=this.version;for(let p=0;p<12;p++)f=f<<1^(f>>>11)*7973;const u=this.version<<12|f;a(u>>>18==0);for(let p=0;p<18;p++){const g=r(u,p),b=this.size-11+p%3,v=Math.floor(p/3);this.setFunctionModule(b,v,g),this.setFunctionModule(v,b,g)}}drawFinderPattern(f,u){for(let p=-4;p<=4;p++)for(let g=-4;g<=4;g++){const b=Math.max(Math.abs(g),Math.abs(p)),v=f+g,S=u+p;0<=v&&v<this.size&&0<=S&&S<this.size&&this.setFunctionModule(v,S,b!=2&&b!=4)}}drawAlignmentPattern(f,u){for(let p=-2;p<=2;p++)for(let g=-2;g<=2;g++)this.setFunctionModule(f+g,u+p,Math.max(Math.abs(g),Math.abs(p))!=1)}setFunctionModule(f,u,p){this.modules[u][f]=p,this.isFunction[u][f]=!0}addEccAndInterleave(f){const u=this.version,p=this.errorCorrectionLevel;if(f.length!=pn.getNumDataCodewords(u,p))throw new RangeError("Invalid argument");const g=pn.NUM_ERROR_CORRECTION_BLOCKS[p.ordinal][u],b=pn.ECC_CODEWORDS_PER_BLOCK[p.ordinal][u],v=Math.floor(pn.getNumRawDataModules(u)/8),S=g-v%g,k=Math.floor(v/g);let T=[];const A=pn.reedSolomonComputeDivisor(b);for(let R=0,z=0;R<g;R++){let F=f.slice(z,z+k-b+(R<S?0:1));z+=F.length;const L=pn.reedSolomonComputeRemainder(F,A);R<S&&F.push(0),T.push(F.concat(L))}let M=[];for(let R=0;R<T[0].length;R++)T.forEach((z,F)=>{(R!=k-b||F>=S)&&M.push(z[R])});return a(M.length==v),M}drawCodewords(f){if(f.length!=Math.floor(pn.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let u=0;for(let p=this.size-1;p>=1;p-=2){p==6&&(p=5);for(let g=0;g<this.size;g++)for(let b=0;b<2;b++){const v=p-b,k=(p+1&2)==0?this.size-1-g:g;!this.isFunction[k][v]&&u<f.length*8&&(this.modules[k][v]=r(f[u>>>3],7-(u&7)),u++)}}a(u==f.length*8)}applyMask(f){if(f<0||f>7)throw new RangeError("Mask value out of range");for(let u=0;u<this.size;u++)for(let p=0;p<this.size;p++){let g;switch(f){case 0:g=(p+u)%2==0;break;case 1:g=u%2==0;break;case 2:g=p%3==0;break;case 3:g=(p+u)%3==0;break;case 4:g=(Math.floor(p/3)+Math.floor(u/2))%2==0;break;case 5:g=p*u%2+p*u%3==0;break;case 6:g=(p*u%2+p*u%3)%2==0;break;case 7:g=((p+u)%2+p*u%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[u][p]&&g&&(this.modules[u][p]=!this.modules[u][p])}}getPenaltyScore(){let f=0;for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[b][T]==v?(S++,S==5?f+=pn.PENALTY_N1:S>5&&f++):(this.finderPenaltyAddHistory(S,k),v||(f+=this.finderPenaltyCountPatterns(k)*pn.PENALTY_N3),v=this.modules[b][T],S=1);f+=this.finderPenaltyTerminateAndCount(v,S,k)*pn.PENALTY_N3}for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[T][b]==v?(S++,S==5?f+=pn.PENALTY_N1:S>5&&f++):(this.finderPenaltyAddHistory(S,k),v||(f+=this.finderPenaltyCountPatterns(k)*pn.PENALTY_N3),v=this.modules[T][b],S=1);f+=this.finderPenaltyTerminateAndCount(v,S,k)*pn.PENALTY_N3}for(let b=0;b<this.size-1;b++)for(let v=0;v<this.size-1;v++){const S=this.modules[b][v];S==this.modules[b][v+1]&&S==this.modules[b+1][v]&&S==this.modules[b+1][v+1]&&(f+=pn.PENALTY_N2)}let u=0;for(const b of this.modules)u=b.reduce((v,S)=>v+(S?1:0),u);const p=this.size*this.size,g=Math.ceil(Math.abs(u*20-p*10)/p)-1;return a(0<=g&&g<=9),f+=g*pn.PENALTY_N4,a(0<=f&&f<=2568888),f}getAlignmentPatternPositions(){if(this.version==1)return[];{const f=Math.floor(this.version/7)+2,u=this.version==32?26:Math.ceil((this.version*4+4)/(f*2-2))*2;let p=[6];for(let g=this.size-7;p.length<f;g-=u)p.splice(1,0,g);return p}}static getNumRawDataModules(f){if(f<pn.MIN_VERSION||f>pn.MAX_VERSION)throw new RangeError("Version number out of range");let u=(16*f+128)*f+64;if(f>=2){const p=Math.floor(f/7)+2;u-=(25*p-10)*p-55,f>=7&&(u-=36)}return a(208<=u&&u<=29648),u}static getNumDataCodewords(f,u){return Math.floor(pn.getNumRawDataModules(f)/8)-pn.ECC_CODEWORDS_PER_BLOCK[u.ordinal][f]*pn.NUM_ERROR_CORRECTION_BLOCKS[u.ordinal][f]}static reedSolomonComputeDivisor(f){if(f<1||f>255)throw new RangeError("Degree out of range");let u=[];for(let g=0;g<f-1;g++)u.push(0);u.push(1);let p=1;for(let g=0;g<f;g++){for(let b=0;b<u.length;b++)u[b]=pn.reedSolomonMultiply(u[b],p),b+1<u.length&&(u[b]^=u[b+1]);p=pn.reedSolomonMultiply(p,2)}return u}static reedSolomonComputeRemainder(f,u){let p=u.map(g=>0);for(const g of f){const b=g^p.shift();p.push(0),u.forEach((v,S)=>p[S]^=pn.reedSolomonMultiply(v,b))}return p}static reedSolomonMultiply(f,u){if(f>>>8||u>>>8)throw new RangeError("Byte out of range");let p=0;for(let g=7;g>=0;g--)p=p<<1^(p>>>7)*285,p^=(u>>>g&1)*f;return a(p>>>8==0),p}finderPenaltyCountPatterns(f){const u=f[1];a(u<=this.size*3);const p=u>0&&f[2]==u&&f[3]==u*3&&f[4]==u&&f[5]==u;return(p&&f[0]>=u*4&&f[6]>=u?1:0)+(p&&f[6]>=u*4&&f[0]>=u?1:0)}finderPenaltyTerminateAndCount(f,u,p){return f&&(this.finderPenaltyAddHistory(u,p),u=0),u+=this.size,this.finderPenaltyAddHistory(u,p),this.finderPenaltyCountPatterns(p)}finderPenaltyAddHistory(f,u){u[0]==0&&(f+=this.size),u.pop(),u.unshift(f)}};n.MIN_VERSION=1,n.MAX_VERSION=40,n.PENALTY_N1=3,n.PENALTY_N2=3,n.PENALTY_N3=40,n.PENALTY_N4=10,n.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],n.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=n;function t(d,f,u){if(f<0||f>31||d>>>f)throw new RangeError("Value out of range");for(let p=f-1;p>=0;p--)u.push(d>>>p&1)}function r(d,f){return(d>>>f&1)!=0}function a(d){if(!d)throw new Error("Assertion error")}const o=class xr{constructor(f,u,p){if(this.mode=f,this.numChars=u,this.bitData=p,u<0)throw new RangeError("Invalid argument");this.bitData=p.slice()}static makeBytes(f){let u=[];for(const p of f)t(p,8,u);return new xr(xr.Mode.BYTE,f.length,u)}static makeNumeric(f){if(!xr.isNumeric(f))throw new RangeError("String contains non-numeric characters");let u=[];for(let p=0;p<f.length;){const g=Math.min(f.length-p,3);t(parseInt(f.substring(p,p+g),10),g*3+1,u),p+=g}return new xr(xr.Mode.NUMERIC,f.length,u)}static makeAlphanumeric(f){if(!xr.isAlphanumeric(f))throw new RangeError("String contains unencodable characters in alphanumeric mode");let u=[],p;for(p=0;p+2<=f.length;p+=2){let g=xr.ALPHANUMERIC_CHARSET.indexOf(f.charAt(p))*45;g+=xr.ALPHANUMERIC_CHARSET.indexOf(f.charAt(p+1)),t(g,11,u)}return p<f.length&&t(xr.ALPHANUMERIC_CHARSET.indexOf(f.charAt(p)),6,u),new xr(xr.Mode.ALPHANUMERIC,f.length,u)}static makeSegments(f){return f==""?[]:xr.isNumeric(f)?[xr.makeNumeric(f)]:xr.isAlphanumeric(f)?[xr.makeAlphanumeric(f)]:[xr.makeBytes(xr.toUtf8ByteArray(f))]}static makeEci(f){let u=[];if(f<0)throw new RangeError("ECI assignment value out of range");if(f<128)t(f,8,u);else if(f<16384)t(2,2,u),t(f,14,u);else if(f<1e6)t(6,3,u),t(f,21,u);else throw new RangeError("ECI assignment value out of range");return new xr(xr.Mode.ECI,0,u)}static isNumeric(f){return xr.NUMERIC_REGEX.test(f)}static isAlphanumeric(f){return xr.ALPHANUMERIC_REGEX.test(f)}getData(){return this.bitData.slice()}static getTotalBits(f,u){let p=0;for(const g of f){const b=g.mode.numCharCountBits(u);if(g.numChars>=1<<b)return 1/0;p+=4+b+g.bitData.length}return p}static toUtf8ByteArray(f){f=encodeURI(f);let u=[];for(let p=0;p<f.length;p++)f.charAt(p)!="%"?u.push(f.charCodeAt(p)):(u.push(parseInt(f.substring(p+1,p+3),16)),p+=2);return u}};o.NUMERIC_REGEX=/^[0-9]*$/,o.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,o.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let l=o;e.QrSegment=o})(Bd||(Bd={}));(e=>{(n=>{const t=class{constructor(a,o){this.ordinal=a,this.formatBits=o}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),n.Ecc=t})(e.QrCode||(e.QrCode={}))})(Bd||(Bd={}));(e=>{(n=>{const t=class{constructor(a,o){this.modeBits=a,this.numBitsCharCount=o}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),n.Mode=t})(e.QrSegment||(e.QrSegment={}))})(Bd||(Bd={}));var jh=Bd;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Hte={L:jh.QrCode.Ecc.LOW,M:jh.QrCode.Ecc.MEDIUM,Q:jh.QrCode.Ecc.QUARTILE,H:jh.QrCode.Ecc.HIGH},AA=128,PA="L",DA="#FFFFFF",IA="#000000",RA=!1,MA=1,Gte=4,Yte=0,Wte=.1;function OA(e,n=0){const t=[];return e.forEach(function(r,a){let o=null;r.forEach(function(l,d){if(!l&&o!==null){t.push(`M${o+n} ${a+n}h${d-o}v1H${o+n}z`),o=null;return}if(d===r.length-1){if(!l)return;o===null?t.push(`M${d+n},${a+n} h1v1H${d+n}z`):t.push(`M${o+n},${a+n} h${d+1-o}v1H${o+n}z`);return}l&&o===null&&(o=d)})}),t.join("")}function LA(e,n){return e.slice().map((t,r)=>r<n.y||r>=n.y+n.h?t:t.map((a,o)=>o<n.x||o>=n.x+n.w?a:!1))}function Qte(e,n,t,r){if(r==null)return null;const a=e.length+t*2,o=Math.floor(n*Wte),l=a/n,d=(r.width||o)*l,f=(r.height||o)*l,u=r.x==null?e.length/2-d/2:r.x*l,p=r.y==null?e.length/2-f/2:r.y*l,g=r.opacity==null?1:r.opacity;let b=null;if(r.excavate){let S=Math.floor(u),k=Math.floor(p),T=Math.ceil(d+u-S),A=Math.ceil(f+p-k);b={x:S,y:k,w:T,h:A}}const v=r.crossOrigin;return{x:u,y:p,h:f,w:d,excavation:b,opacity:g,crossOrigin:v}}function Jte(e,n){return n!=null?Math.max(Math.floor(n),0):e?Gte:Yte}function FA({value:e,level:n,minVersion:t,includeMargin:r,marginSize:a,imageSettings:o,size:l,boostLevel:d}){let f=_n.useMemo(()=>{const S=(Array.isArray(e)?e:[e]).reduce((k,T)=>(k.push(...jh.QrSegment.makeSegments(T)),k),[]);return jh.QrCode.encodeSegments(S,Hte[n],t,void 0,void 0,d)},[e,n,t,d]);const{cells:u,margin:p,numCells:g,calculatedImageSettings:b}=_n.useMemo(()=>{let v=f.getModules();const S=Jte(r,a),k=v.length+S*2,T=Qte(v,l,S,o);return{cells:v,margin:S,numCells:k,calculatedImageSettings:T}},[f,l,o,r,a]);return{qrcode:f,margin:p,cells:u,numCells:g,calculatedImageSettings:b}}var Kte=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),Lh=_n.forwardRef(function(n,t){const r=n,{value:a,size:o=AA,level:l=PA,bgColor:d=DA,fgColor:f=IA,includeMargin:u=RA,minVersion:p=MA,boostLevel:g,marginSize:b,imageSettings:v}=r,k=nw(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:T}=k,A=nw(k,["style"]),M=v==null?void 0:v.src,R=_n.useRef(null),z=_n.useRef(null),F=_n.useCallback(Q=>{R.current=Q,typeof t=="function"?t(Q):t&&(t.current=Q)},[t]),[L,U]=_n.useState(!1),{margin:B,cells:J,numCells:D,calculatedImageSettings:$}=FA({value:a,level:l,minVersion:p,boostLevel:g,includeMargin:u,marginSize:b,imageSettings:v,size:o});_n.useEffect(()=>{if(R.current!=null){const Q=R.current,Y=Q.getContext("2d");if(!Y)return;let V=J;const ae=z.current,re=$!=null&&ae!==null&&ae.complete&&ae.naturalHeight!==0&&ae.naturalWidth!==0;re&&$.excavation!=null&&(V=LA(J,$.excavation));const le=window.devicePixelRatio||1;Q.height=Q.width=o*le;const E=o/D*le;Y.scale(E,E),Y.fillStyle=d,Y.fillRect(0,0,D,D),Y.fillStyle=f,Kte?Y.fill(new Path2D(OA(V,B))):J.forEach(function(ce,ue){ce.forEach(function(I,de){I&&Y.fillRect(de+B,ue+B,1,1)})}),$&&(Y.globalAlpha=$.opacity),re&&Y.drawImage(ae,$.x+B,$.y+B,$.w,$.h)}}),_n.useEffect(()=>{U(!1)},[M]);const H=tw({height:o,width:o},T);let te=null;return M!=null&&(te=_n.createElement("img",{src:M,key:M,style:{display:"none"},onLoad:()=>{U(!0)},ref:z,crossOrigin:$==null?void 0:$.crossOrigin})),_n.createElement(_n.Fragment,null,_n.createElement("canvas",tw({style:H,height:o,width:o,ref:F,role:"img"},A)),te)});Lh.displayName="QRCodeCanvas";var Xte=_n.forwardRef(function(n,t){const r=n,{value:a,size:o=AA,level:l=PA,bgColor:d=DA,fgColor:f=IA,includeMargin:u=RA,minVersion:p=MA,boostLevel:g,title:b,marginSize:v,imageSettings:S}=r,k=nw(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:T,cells:A,numCells:M,calculatedImageSettings:R}=FA({value:a,level:l,minVersion:p,boostLevel:g,includeMargin:u,marginSize:v,imageSettings:S,size:o});let z=A,F=null;S!=null&&R!=null&&(R.excavation!=null&&(z=LA(A,R.excavation)),F=_n.createElement("image",{href:S.src,height:R.h,width:R.w,x:R.x+T,y:R.y+T,preserveAspectRatio:"none",opacity:R.opacity,crossOrigin:R.crossOrigin}));const L=OA(z,T);return _n.createElement("svg",tw({height:o,width:o,viewBox:`0 0 ${M} ${M}`,ref:t,role:"img"},k),!!b&&_n.createElement("title",null,b),_n.createElement("path",{fill:d,d:`M0,0 h${M}v${M}H0z`,shapeRendering:"crispEdges"}),_n.createElement("path",{fill:f,d:L,shapeRendering:"crispEdges"}),F)});Xte.displayName="QRCodeSVG";const Zte=e=>{switch(e){case"pending":return{text:"text-orange-700",bg:"bg-orange-100"};case"billed":return{text:"text-blue-700",bg:"bg-blue-100"};case"dispensed":return{text:"text-green-700",bg:"bg-green-100"};case"cancelled":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},ene=()=>{const{orderId:e}=Gi(),n=Et(),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),[p,g]=w.useState({}),[b,v]=w.useState(""),[S,k]=w.useState(""),[T,A]=w.useState("cash"),M=w.useMemo(()=>(t==null?void 0:t.medications.reduce(($,H)=>{const te=H.total_price??0,Q=te*(H.discount_percentage??0)/100;return $+te-Q},0))??0,[t==null?void 0:t.medications]),R=5,z=w.useMemo(()=>!t||!t.medications?0:t.medications.reduce(($,H,te)=>{var le,E;const Q=H.drug_id??`index-${te}`,Y=((le=p[Q])==null?void 0:le.pack)||0,V=((E=p[Q])==null?void 0:E.loose)||0,ae=H.pack_price??0,re=H.loose_price??0;return $+Y*ae+V*re},0),[t,p]),F=w.useCallback(async()=>{if(!e){d("Order ID is missing."),o(!1);return}o(!0),d(null);try{const $=await pe(`/api/pharmacy-orders/${e}`);if(!$.ok)throw $.status===404?new Error(`Order with ID ${e} not found.`):new Error(`Failed to fetch order details: ${$.statusText} (${$.status})`);const H=await $.json();console.log("Fetched order data after return:",H);const Q=H.medications.map(V=>V.pack_price&&V.loose_price&&V.loose_price>0?{...V,unitsPerPack:Math.round(V.pack_price/V.loose_price)}:{...V,unitsPerPack:0}).map(V=>({...V,discount_percentage:V.discount_percentage??0}));r({...H,medications:Q});const Y={};Q.forEach((V,ae)=>{const re=V.drug_id??`index-${ae}`;Y[re]={pack:0,loose:0}}),g(Y)}catch($){console.error("Failed to fetch order details:",$),d($.message||"Failed to load order details.")}finally{o(!1)}},[e]);w.useEffect(()=>{F()},[F]),w.useEffect(()=>{(async()=>{try{const H=await pe("/api/clinics/settings");if(!H.ok)throw new Error("Failed to fetch clinic settings");const te=await H.json();console.log("Fetched clinic settings:",te),v(te.upi_id||"")}catch(H){console.error("Error fetching clinic settings:",H)}})()},[]),w.useEffect(()=>{if((t==null?void 0:t.order_total)!==void 0&&t.order_total>0&&b){const $=`upi://pay?pa=${b}&pn=ClinicName&am=${t.order_total.toFixed(2)}&cu=INR`;k($)}else k("")},[t==null?void 0:t.order_total,b]);const L=($,H)=>{r(te=>{if(!te)return null;const Q=te.medications.map((V,ae)=>(V.drug_id??`index-${ae}`)===$?{...V,discount_percentage:isNaN(H)?0:H}:V),Y=Q.reduce((V,ae)=>{const re=ae.total_price??0,le=re*(ae.discount_percentage??0)/100;return V+re-le},0);return{...te,medications:Q,order_total:Y}})},U=($,H,te)=>{g(Q=>{const Y=te.unitsPerPack||0,ae=te.pack_quantity*Y+te.loose_quantity,re=Math.max(0,Math.min(H,ae));let le=0,E=re;return Y>0&&(le=Math.floor(re/Y),E=re%Y),{...Q,[$]:{pack:le,loose:E}}})},B=async()=>{const $=t==null?void 0:t.medications.map((H,te)=>{var ae,re;const Q=H.drug_id??`index-${te}`,Y=((ae=p[Q])==null?void 0:ae.pack)||0,V=((re=p[Q])==null?void 0:re.loose)||0;return Y>0||V>0?{drug_id:H.drug_id,name:H.name,pack_quantity:H.pack_quantity,loose_quantity:H.loose_quantity,returnPackQuantity:Y,returnLooseQuantity:V}:null}).filter(H=>H!==null);if(!$||$.length===0){alert("Please select a quantity greater than 0 for at least one item to return.");return}if(!e){alert("Order ID is missing. Cannot process return.");return}if(!$){alert("Could not prepare items for return.");return}u(!0),d(null);try{const H=await pe(`/api/pharmacy-orders/${e}/return`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemsToReturn:$})}),te=await H.json();if(!H.ok)throw new Error(te.message||`Failed to process return: ${H.statusText}`);alert("Return processed successfully! Stock has been updated.");const Q={};t==null||t.medications.forEach((Y,V)=>{const ae=Y.drug_id??`index-${V}`;Q[ae]={pack:0,loose:0}}),g(Q),F()}catch(H){console.error("Failed to process return:",H),d(H.message||"An error occurred while processing the return."),alert(`Error processing return: ${H.message||"Unknown error"}`)}finally{u(!1)}};if(a)return i.jsx("div",{className:"text-center p-6 text-gray-500 animate-pulse",children:"Loading Order Details..."});if(l)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(rn,{size:14,className:"mr-1.5"})," Back"]}),i.jsxs("div",{className:"bg-red-50 border border-red-300 text-red-700 rounded p-4",children:["Error: ",l]})]});if(!t)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(rn,{size:14,className:"mr-1.5"})," Back"]}),i.jsx("div",{className:"text-center py-10 px-4 text-gray-500 bg-white rounded-lg shadow",children:"Order details could not be loaded."})]});const J=()=>{window.print()},D=Zte(t.status);return i.jsx("div",{className:"pharmacy-order-details-page",children:i.jsxs("div",{className:"order-details-container printable-section",children:[i.jsxs("div",{className:"order-details-header no-print",children:[i.jsx("h1",{children:"Pharmacy Order Details"}),i.jsxs("div",{className:"actions",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:[i.jsx(rn,{size:18})," Back to Queue"]}),i.jsxs("button",{onClick:J,className:"print-button",children:[i.jsx(Qo,{size:18})," Print Bill"]})]})]}),i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{children:"Mahajan Pharmacy"}),i.jsxs("div",{className:"clinic-details-print",children:[i.jsx("span",{className:"small-text clinic-address",children:"D.No: 3-1-289, Plot No. 101, Kabela Center, RR Nagar, Vijayawada  520012."}),i.jsx("span",{className:"small-text clinic-notes",children:"Phone: 93919 44733"}),i.jsx("span",{className:"small-text clinic-license",children:"Licence No:RLF20AP2025003328"})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Patient Name:"})," RESHMA"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Token:"})," 12"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Order Date:"})," 31/10/2025"]})]})]}),i.jsxs("div",{className:"order-info-section no-print",children:[i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Order ID:"})," ",t.id]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Patient:"})," ",t.patientName||"N/A"," (",t.patientTokenNumber||"N/A",")"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Date:"})," ",new Date(t.date).toLocaleString()]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Prescribed By:"})," ",t.prescribedBy||"N/A"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:`status-pill ${D.text} ${D.bg}`,children:t.status})]})]}),i.jsxs("div",{className:"medications-section",children:[i.jsx("h2",{children:"Medications Ordered"}),t.medications.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"PACK QTY"}),i.jsx("th",{children:"PACK PRICE"}),i.jsx("th",{children:"LOOSE QTY"}),i.jsx("th",{children:"LOOSE PRICE"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"no-print",children:"RETURN PACK QTY"}),i.jsx("th",{className:"no-print",children:"RETURN LOOSE QTY"})]})]})}),i.jsx("tbody",{children:t.medications.map(($,H)=>{var le,E,ce,ue,I,de;const te=$.drug_id??`index-${H}`,Q=$.total_price??0,Y=Q*($.discount_percentage??0)/100,V=Q-Y,ae=((le=p[te])==null?void 0:le.pack)||0,re=((E=p[te])==null?void 0:E.loose)||0;return i.jsxs("tr",{children:[i.jsx("td",{children:$.name}),i.jsx("td",{children:$.pack_quantity??0}),i.jsx("td",{children:((ce=$.pack_price)==null?void 0:ce.toFixed(2))??"N/A"}),i.jsx("td",{children:$.loose_quantity??0}),i.jsx("td",{children:((ue=$.loose_price)==null?void 0:ue.toFixed(2))??"N/A"}),i.jsx("td",{children:((I=$.price)==null?void 0:I.toFixed(2))??"N/A"})," ",i.jsx("td",{children:((de=$.price)==null?void 0:de.toFixed(2))??"N/A"})," ",i.jsxs("td",{children:[i.jsx("input",{type:"number",value:$.discount_percentage??0,onChange:fe=>L(te,parseFloat(fe.target.value)),min:"0",max:"100",className:"discount-input-table no-print"}),i.jsxs("span",{className:"print-only",children:[$.discount_percentage??0,"%"]})]}),i.jsxs("td",{children:[R.toFixed(1),"%"]}),i.jsx("td",{children:V.toFixed(2)}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:$.pack_quantity,value:ae,onChange:fe=>{const oe=(parseInt(fe.target.value,10)||0)*($.unitsPerPack||0)+re;U(te,oe,$)},className:"return-quantity-input"})}),i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:$.loose_quantity+$.pack_quantity*($.unitsPerPack||0)-ae*($.unitsPerPack||0),value:re,onChange:fe=>{const W=parseInt(fe.target.value,10)||0,oe=ae*($.unitsPerPack||0)+W;U(te,oe,$)},className:"return-quantity-input"})})]})]},te)})})]}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No medications listed for this order."})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",M.toFixed(2)]})}),i.jsxs("div",{className:"order-total-section no-print",children:[i.jsx("span",{className:"total-label",children:"Order Total:"}),i.jsxs("span",{className:"total-amount",children:["",M.toFixed(2)]})]}),i.jsxs("div",{className:"payment-section no-print",children:[i.jsxs("div",{className:"payment-mode-group",children:[i.jsx("label",{htmlFor:"paymentMode",children:"Payment Mode:"}),i.jsxs("select",{id:"paymentMode",value:T,onChange:$=>A($.target.value),className:"payment-mode-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),S&&i.jsxs("div",{className:"qr-code-container",children:[i.jsx(Lh,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]})]}),(t.status==="dispensed"||t.status==="billed")&&t.medications.length>0&&i.jsxs("div",{className:"return-action-section no-print",children:[z>0&&i.jsxs("div",{className:"total-refund-display",children:["Total Refund: ",z.toFixed(2)]}),i.jsx("button",{onClick:B,disabled:Object.values(p).every($=>$.pack===0&&$.loose===0)||f,className:"process-return-button",children:f?i.jsxs(i.Fragment,{children:[i.jsx(h1,{size:16,className:"mr-2 animate-spin"})," Processing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(h1,{size:16,className:"mr-2"})," Process Return"]})})]})]})})},tne=async()=>{const e=await pe("/subscriptions");if(!e.ok)throw new Error("Failed to fetch subscription plans");return await e.json()},nne=async e=>{const n=await pe(`/subscriptions/${e}`);if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to fetch subscription plan details"}));throw new Error(t.message||"Failed to fetch subscription plan details")}return await n.json()},rne=async e=>{const n=await pe("/subscriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to create subscription plan"}));throw new Error(t.message||"Failed to create subscription plan")}return await n.json()},ine=async(e,n)=>{const t=await pe(`/subscriptions/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to update subscription plan"}));throw new Error(r.message||"Failed to update subscription plan")}return await t.json()},ane=async e=>{const n=await pe(`/subscriptions/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to deactivate subscription plan"}));throw new Error(t.message||"Failed to deactivate subscription plan")}return await n.json()},sne=async(e,n)=>{const t=await pe("/api/payment/razorpay-subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:e,planId:n})});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to initiate Razorpay subscription"}));throw new Error(r.message||"Failed to initiate Razorpay subscription")}return await t.json()},one=()=>{const e=Et(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),u=w.useCallback(async()=>{a(!0),l(null);try{const g=await tne();t(g)}catch(g){l(g.message||"Failed to fetch subscription plans."),f({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{u()},[u]),w.useEffect(()=>{if(d){const g=setTimeout(()=>f(null),5e3);return()=>clearTimeout(g)}},[d]);const p=async g=>{if(f(null),l(null),window.confirm("Are you sure you want to deactivate this plan? This action cannot be undone directly.")){a(!0),l(null),f(null);try{await ane(g),f({type:"success",message:"Plan deactivated successfully!"}),u()}catch(b){l(b.message||"Failed to deactivate plan."),f({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[d&&i.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[d.type==="success"?i.jsx(ps,{size:18,className:"mr-2 text-green-500"}):i.jsx(Ar,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:d.message})]}),i.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(zn,{size:16})})]}),i.jsxs("div",{children:[" ",i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(rn,{size:16}),"Back"]}),i.jsx("h1",{children:"Manage Subscription Plans"}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions/add"),className:"subscription-btn",children:[i.jsx(Zo,{size:16,className:"mr-1 inline-block"})," Add New Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading plans..."})]})}),!r&&o&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:o}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx(Kl,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>p(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(Ur,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!o&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No subscription plans found. Add one to get started!"})]})]})},lne=()=>{const e=Et(),[n,t]=w.useState({name:"",description:"",price:"",period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null);w.useEffect(()=>{if(d){const b=setTimeout(()=>f(null),5e3);return()=>clearTimeout(b)}},[d]);const u=b=>{const{name:v,value:S}=b.target;t(k=>({...k,[v]:S}))},p=async b=>{if(b.preventDefault(),a(!0),l(null),f(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){l("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await rne(n),f({type:"success",message:"Plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create plan.";l(S),f({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[d&&i.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[d.type==="success"?i.jsx(ps,{size:18,className:"mr-2 text-green-500"}):i.jsx(Ar,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:d.message})]}),i.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(zn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Subscription Plan"}),o&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:o}),i.jsxs("form",{onSubmit:p,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:u})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:u,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:u,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:u})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},cne=()=>{const{id:e}=Gi(),n=Et(),[t,r]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!1),[f,u]=w.useState(!0),[p,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),u(!1);return}u(!0),g(null);try{const M=await nne(e);r(M),o({name:M.name,description:M.description||"",price:M.price,period:M.period,interval:M.interval,razorpay_plan_id:M.razorpay_plan_id||"",status:M.status})}catch(M){g(M.message||"Failed to fetch plan details."),v({type:"error",message:M.message||"Failed to fetch plan details."})}finally{u(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const M=setTimeout(()=>v(null),5e3);return()=>clearTimeout(M)}},[b]);const k=M=>{const{name:R,value:z}=M.target;o(F=>({...F,[R]:z}))},T=async M=>{if(M.preventDefault(),!e){g("Plan ID is missing.");return}if(d(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),d(!1);return}try{await ine(e,a),v({type:"success",message:"Plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(R){const z=R.message||"Failed to update plan.";g(z),v({type:"error",message:z})}finally{d(!1)}},A=()=>{n(-1)};return f?i.jsx("div",{className:"p-6 text-center",children:"Loading plan details..."}):p&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:p}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx(ps,{size:18,className:"mr-2"}):i.jsx(Ar,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(zn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Subscription Plan"}),p&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:p}),i.jsxs("form",{onSubmit:T,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval||1,onChange:k,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:A,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:l,className:"subscription-btn",children:[l?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,l?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Plan not found."})},une=()=>{const{patientId:e}=Gi(),n=Et(),[t,r]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState(""),[f,u]=w.useState(!0),[p,g]=w.useState(null),[b,v]=w.useState("manual"),[S,k]=w.useState(!1),[T,A]=w.useState(null),M=w.useCallback(async()=>{u(!0),g(null);try{const F=await pe(`/api/patients/${e}`);if(!F.ok){const J=await F.json();throw new Error(J.message||"Failed to fetch patient details")}const L=await F.json();r(L);const U=await pe("/api/subscriptions");if(!U.ok){const J=await U.json();throw new Error(J.message||"Failed to fetch subscription plans")}const B=await U.json();o(B.filter(J=>J.status==="active"))}catch(F){console.error("Error fetching data:",F),g(`Failed to load data: ${F.message}`)}finally{u(!1)}},[e]);w.useEffect(()=>{e?M():(g("Patient ID is missing."),u(!1))},[e,M]);const R=(F,L)=>{const U=new Date(F),B=L.interval||1;switch(L.period){case"daily":U.setDate(F.getDate()+B);break;case"weekly":U.setDate(F.getDate()+B*7);break;case"monthly":U.setMonth(F.getMonth()+B);break;case"yearly":U.setFullYear(F.getFullYear()+B);break;default:console.warn(`Unknown subscription period: ${L.period}. Defaulting to 1 month.`),U.setMonth(F.getMonth()+1)}return U},z=async()=>{if(!e||!l){A("Please select a subscription plan.");return}const F=a.find(L=>L.id===l);if(!F){A("Selected plan details not found.");return}k(!0),A(null);try{const L=new Date,U=R(L,F);if(b==="manual"){const B={subscription_plan_id:l,subscription_status:"active",subscription_start_date:L.toISOString(),subscription_end_date:U.toISOString(),subscription_payment_method:"manual"},J=await pe(`/api/patients/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)});if(!J.ok){const D=await J.json();throw new Error(D.message||"Failed to start subscription manually")}alert(`Subscription started successfully for ${t==null?void 0:t.name} (Manual Payment)!`),n("/all-patients")}else if(b==="razorpay"){console.log("Initiating Razorpay subscription for plan:",F);const B=await sne(e,l);if(B&&B.short_url)window.location.href=B.short_url;else throw new Error("Failed to get Razorpay subscription link from backend.")}}catch(L){console.error("Error starting subscription:",L),A(`Failed to start subscription: ${L.message}`),k(!1)}};return f?i.jsx("div",{className:"loading-state-subscription",children:"Loading patient and plans..."}):p?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:p})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(rn,{size:16})," ","Back"]})]}):t?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(rn,{size:16})," ","Back"]}),i.jsxs("h1",{children:[i.jsx(Ys,{size:28})," ","Start Subscription for ",t.name]}),T&&i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[" ",i.jsx("span",{children:T})]}),i.jsxs("div",{className:"subscription-form",children:[" ",i.jsx("h2",{children:"Available Subscription Plans"}),a.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:a.map(F=>i.jsxs("div",{className:`subscription-plan-card ${l===F.id?"selected-plan":""}`,onClick:()=>d(F.id),children:[i.jsx("h3",{children:F.name}),i.jsxs("p",{className:"price",children:["",F.price]}),i.jsxs("p",{className:"duration",children:["Every ",F.interval," ",F.period,F.interval>1?"s":""]}),F.description&&i.jsx("p",{children:F.description})]},F.id))})]}),i.jsxs("div",{className:"subscription-form mb-6",children:[" ",i.jsx("h2",{children:"Select Payment Method"}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"manual",checked:b==="manual",onChange:()=>v("manual"),className:"mr-2"}),i.jsx("span",{children:"Cash (Manual)"})]})}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"razorpay",checked:b==="razorpay",onChange:()=>v("razorpay"),className:"mr-2"}),i.jsx("span",{children:"Razorpay"})]})})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:z,disabled:!l||S||a.length===0,className:"subscription-btn",children:[S&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),S?"Starting...":"Start Subscription"]})})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Warning: "}),i.jsx("span",{children:"Patient not found."})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(rn,{size:16}),"Back"]})]})},fS=async()=>{const e=await pe("/api/clinic-subscriptions/plans",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription plans")}return e.json()},dne=async e=>{const n=await pe(`/api/clinic-subscriptions/cancel/${e}`,{method:"PUT"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to cancel clinic subscription")}return n.json()},fne=async e=>{const n=await pe(`/api/clinics/${e}/subscription-status`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||`Failed to fetch subscription status for clinic ${e}`)}return n.json()},hne=async e=>{const n=await pe(`/api/clinic-subscriptions/plans/${e}`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to fetch clinic subscription plan")}return n.json()},pne=async e=>{const n=await pe("/api/clinic-subscriptions/plans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to create clinic subscription plan")}return n.json()},mne=async(e,n)=>{const t=await pe(`/api/clinic-subscriptions/plans/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Failed to update clinic subscription plan")}return t.json()},gne=async e=>{const n=await pe(`/api/clinic-subscriptions/plans/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to deactivate clinic subscription plan")}return n.json()},yne=async e=>{const n=await pe("/api/clinic-subscriptions/initiate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:e})});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to initiate clinic subscription")}return n.json()},xne=async()=>{try{const e=await pe("/api/clinic-subscriptions/pending",{method:"GET"});return e.ok?e.json():null}catch(e){return console.error("Error checking for pending subscription:",e),null}},bne=async()=>{const e=await pe("/api/clinics/subscription-status",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription status")}return e.json()},vne=()=>{const e=Et(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),u=w.useCallback(async()=>{a(!0),l(null);try{const g=await fS();t(g)}catch(g){l(g.message||"Failed to fetch clinic subscription plans."),f({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{u()},[u]),w.useEffect(()=>{if(d){const g=setTimeout(()=>f(null),5e3);return()=>clearTimeout(g)}},[d]);const p=async g=>{if(f(null),l(null),window.confirm("Are you sure you want to deactivate this clinic plan? This action cannot be undone directly.")){a(!0),l(null),f(null);try{await gne(g),f({type:"success",message:"Clinic plan deactivated successfully!"}),u()}catch(b){l(b.message||"Failed to deactivate clinic plan."),f({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[d&&i.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[d.type==="success"?i.jsx(ps,{size:18,className:"mr-2 text-green-500"}):i.jsx(Ar,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:d.message})]}),i.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(zn,{size:16})})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"p-2 rounded-md hover:bg-gray-200",children:i.jsx(rn,{size:20})}),i.jsx("h1",{className:"text-2xl font-bold",children:"Manage Clinic Subscription Plans"})]}),i.jsxs("button",{onClick:()=>e("/dashboard/clinic-subscriptions/add"),className:"subscription-btn",children:[i.jsx(Zo,{size:16,className:"mr-1 inline-block"})," Add New Clinic Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading clinic plans..."})]})}),!r&&o&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:o}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/clinic-subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx(Kl,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>p(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(Ur,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!o&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No clinic subscription plans found. Add one to get started!"})]})]})},wne=()=>{const e=Et(),[n,t]=w.useState({name:"",description:"",price:0,period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null);w.useEffect(()=>{if(d){const b=setTimeout(()=>f(null),5e3);return()=>clearTimeout(b)}},[d]);const u=b=>{const{name:v,value:S,type:k}=b.target;t(T=>({...T,[v]:k==="number"?parseFloat(S):S}))},p=async b=>{if(b.preventDefault(),a(!0),l(null),f(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){l("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await pne(n),f({type:"success",message:"Clinic plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/clinic-subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create clinic plan.";l(S),f({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[d&&i.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[d.type==="success"?i.jsx(ps,{size:18,className:"mr-2 text-green-500"}):i.jsx(Ar,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:d.message})]}),i.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(zn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Clinic Subscription Plan"}),o&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:o}),i.jsxs("form",{onSubmit:p,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:u})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:u,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:u,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:u})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},Sne=()=>{const{id:e}=Gi(),n=Et(),[t,r]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!1),[f,u]=w.useState(!0),[p,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),u(!1);return}u(!0),g(null);try{const M=await hne(e);r(M),o({name:M.name,description:M.description||"",price:Number(M.price),period:M.period,interval:Number(M.interval),razorpay_plan_id:M.razorpay_plan_id||"",status:M.status})}catch(M){g(M.message||"Failed to fetch clinic plan details."),v({type:"error",message:M.message||"Failed to fetch plan details."})}finally{u(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const M=setTimeout(()=>v(null),5e3);return()=>clearTimeout(M)}},[b]);const k=M=>{const{name:R,value:z,type:F}=M.target;o(L=>({...L,[R]:F==="number"?parseFloat(z):z}))},T=async M=>{if(M.preventDefault(),!e){g("Plan ID is missing.");return}if(d(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),d(!1);return}try{await mne(e,a),v({type:"success",message:"Clinic plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(R){const z=R.message||"Failed to update clinic plan.";g(z),v({type:"error",message:z})}finally{d(!1)}},A=()=>{n(-1)};return f?i.jsx("div",{className:"p-6 text-center",children:"Loading clinic plan details..."}):p&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:p}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx(ps,{size:18,className:"mr-2"}):i.jsx(Ar,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(zn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Clinic Subscription Plan"}),p&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:p}),i.jsxs("form",{onSubmit:T,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price!==void 0?a.price:"",onChange:k,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval!==void 0?a.interval:"",onChange:k,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:A,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:l,className:"subscription-btn",children:[l?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,l?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Clinic plan not found."})},Nne=()=>{const e=Et(),[n,t]=w.useState([]),[r,a]=w.useState(""),[o,l]=w.useState(!0),[d,f]=w.useState(null),[u,p]=w.useState(!1),[g,b]=w.useState(null),v=w.useCallback(async()=>{f(null);try{const T=(await fS()).filter(A=>A.status==="active");t(T),T.length>0&&!r&&a(T[0].id)}catch(k){console.error("Error fetching plans:",k),f(`Failed to load subscription plans: ${k.message}`)}},[]);w.useEffect(()=>{(async()=>{l(!0);try{const T=await xne();if(T&&T.short_url){window.location.href=T.short_url,f("You have a pending subscription. Redirecting to payment...");return}await v()}catch(T){console.error("Error during initial page load:",T),f(`An unexpected error occurred: ${T.message}`)}finally{l(!1)}})()},[v]);const S=async()=>{if(!r){b("Please select a clinic subscription plan.");return}const k=n.find(T=>T.id===r);if(!k){b("Selected plan details not found.");return}p(!0),b(null);try{console.log("Initiating Razorpay clinic subscription for plan:",k);const T=await yne(r);if(T&&T.short_url)window.location.href=T.short_url;else throw new Error("Failed to get Razorpay clinic subscription link from backend.")}catch(T){console.error("Error starting clinic subscription:",T),b(`Failed to start clinic subscription: ${T.message}`),p(!1)}};return o?i.jsx("div",{className:"loading-state-subscription",children:"Loading clinic plans..."}):d?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:d})]}),i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(rn,{size:16}),"Back"]})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(rn,{size:16}),"Back"]}),i.jsxs("h1",{children:[i.jsx(b3,{size:28}),"Buy Pro Plan for Clinic"]}),g&&i.jsx("div",{className:"error-alert-subscription",role:"alert",children:i.jsx("span",{children:g})}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h2",{children:"Available Pro Plans"}),n.length===0?i.jsx("p",{className:"empty-state",children:"No active clinic subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:n.map(k=>i.jsxs("div",{className:`subscription-plan-card ${r===k.id?"selected-plan":""}`,onClick:()=>a(k.id),children:[i.jsx("h3",{children:k.name}),i.jsxs("p",{className:"price",children:["",Number(k.price).toFixed(2)]}),i.jsxs("p",{className:"duration",children:["Every ",k.interval," ",k.period,k.interval>1?"s":""]}),k.description&&i.jsx("p",{children:k.description})]},k.id))})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:S,disabled:!r||u||n.length===0,className:"subscription-btn",children:[u&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),u?"Initiating Payment...":"Buy Pro Plan"]})})]})},Cne=()=>{const e=Et(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,p]=w.useState(!1),[g,b]=w.useState(null),[v,S]=w.useState({name:"",email:"",password:"",role:"user"}),[k,T]=w.useState({name:"",email:"",role:"",password:"",confirmPassword:""}),[A,M]=w.useState(""),[R,z]=w.useState(""),[F,L]=w.useState({}),[U,B]=w.useState(!1),[J,D]=w.useState(null),[$,H]=w.useState([]),[te,Q]=w.useState(""),[Y,V]=w.useState(!1),[ae,re]=w.useState(null);w.useEffect(()=>{const se=setTimeout(()=>{z(A)},500);return()=>{clearTimeout(se)}},[A]),w.useEffect(()=>{le(R)},[R]);const le=async(se="")=>{a(!0);try{const je=se?`/api/users?search=${encodeURIComponent(se)}`:"/api/users",X=await(await pe(je)).json();if(t(X),X.length>0){const Se=[...new Set(X.map(Pe=>Pe.clinic_id).filter(Pe=>!!Pe))],Ae={};await Promise.all(Se.map(async Pe=>{try{const Ze=await fne(Pe);Ae[Pe]=Ze}catch(Ze){console.error(`Failed to fetch subscription status for clinic ${Pe}`,Ze),Ae[Pe]={hasProPlan:!1}}})),L(Ae)}l(null)}catch(je){l("Failed to fetch users."),console.error(je)}finally{a(!1)}},E=async se=>{se.preventDefault();try{await pe("/users",{method:"POST",body:JSON.stringify(v)}),f(!1),S({name:"",email:"",password:"",role:"user"}),le()}catch(je){l("Failed to add user."),console.error(je)}},ce=async se=>{if(se.preventDefault(),!g)return;const{password:je,confirmPassword:We,...X}=k,Se={...X};if(je){if(je.length<6){l("Password must be at least 6 characters long.");return}if(je!==We){l("Passwords do not match.");return}Se.password=je}try{await pe(`/users/${g.id}`,{method:"PUT",body:JSON.stringify(Se)}),p(!1),b(null),T({...k,password:"",confirmPassword:""}),le()}catch(Ae){l("Failed to update user."),console.error(Ae)}},ue=async se=>{if(window.confirm("Are you sure you want to delete this user?"))try{await pe(`/users/${se}`,{method:"DELETE"}),le()}catch(je){l("Failed to delete user."),console.error(je)}},I=se=>{b(se),T({name:se.name,email:se.email,role:se.role,password:"",confirmPassword:""}),p(!0)},de=async()=>{V(!0);try{const se=await fS();H(se),se.length>0&&Q(se[0].id),re(null)}catch(se){re("Failed to fetch subscription plans."),console.error(se)}finally{V(!1)}},fe=se=>{D(se),B(!0),de()},W=async se=>{if(se.preventDefault(),!J||!te){l("Please select a clinic and a plan.");return}try{await pe("/clinic-subscriptions/manual-activate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicId:J,planId:te})}),B(!1),D(null),Q(""),le(),l(null)}catch(je){l("Failed to manually activate clinic subscription."),console.error(je)}},oe=async se=>{if(window.confirm("Are you sure you want to cancel this clinic's subscription? This action cannot be undone."))try{await dne(se),le(),l(null)}catch(je){l("Failed to cancel subscription."),console.error(je)}};return r?i.jsx("div",{children:"Loading users..."}):o?i.jsx("div",{className:"error-message",children:o}):i.jsxs("div",{className:"user-management-page",children:[i.jsxs("div",{className:"user-management-header",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(rn,{size:16}),"Back"]}),i.jsx("h1",{children:"User Management"})]}),i.jsxs("div",{className:"controls-container",children:[i.jsx("input",{type:"text",placeholder:"Search by name or email...",value:A,onChange:se=>M(se.target.value),className:"search-input"}),i.jsx("button",{onClick:()=>f(!0),className:"add-user-button",children:"Add New User"})]}),d&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>f(!1),children:""}),i.jsx("h2",{children:"Add New User"}),i.jsxs("form",{onSubmit:E,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:v.name,onChange:se=>S({...v,name:se.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:v.email,onChange:se=>S({...v,email:se.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Password:"}),i.jsx("input",{type:"password",value:v.password,onChange:se=>S({...v,password:se.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:v.role,onChange:se=>S({...v,role:se.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsx("button",{type:"submit",children:"Add User"})]})]})}),u&&g&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>p(!1),children:""}),i.jsx("h2",{children:"Edit User"}),i.jsxs("form",{onSubmit:ce,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:k.name,onChange:se=>T({...k,name:se.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:k.email,onChange:se=>T({...k,email:se.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:k.role,onChange:se=>T({...k,role:se.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"New Password (optional):"}),i.jsx("input",{type:"password",value:k.password,onChange:se=>T({...k,password:se.target.value})})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Confirm New Password:"}),i.jsx("input",{type:"password",value:k.confirmPassword,onChange:se=>T({...k,confirmPassword:se.target.value})})]}),i.jsx("button",{type:"submit",children:"Update User"})]})]})}),U&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>B(!1),children:""}),i.jsx("h2",{children:"Select Subscription Plan for Clinic"}),Y&&i.jsx("div",{children:"Loading plans..."}),ae&&i.jsx("div",{className:"error-message",children:ae}),!Y&&!ae&&$.length===0&&i.jsx("div",{children:"No active subscription plans available."}),!Y&&!ae&&$.length>0&&i.jsxs("form",{onSubmit:W,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Select Plan:"}),i.jsx("select",{value:te,onChange:se=>Q(se.target.value),required:!0,children:$.map(se=>i.jsxs("option",{value:se.id,children:[se.name," - $",se.price,"/",se.interval," ",se.period]},se.id))})]}),i.jsx("button",{type:"submit",children:"Activate Selected Plan"})]})]})}),i.jsxs("table",{className:"user-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Role"}),i.jsx("th",{children:"Clinic ID"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:n.map(se=>{const je=se.clinic_id||"N/A",We=je!=="N/A"?F[je]:null,X=(We==null?void 0:We.hasProPlan)??!1,Se=X?"PRO":"Standard";return i.jsxs("tr",{children:[i.jsx("td",{children:se.name}),i.jsx("td",{children:se.email}),i.jsx("td",{children:se.role}),i.jsx("td",{children:je}),i.jsx("td",{children:je!=="N/A"?i.jsx("span",{className:X?"pro-badge":"standard-badge",children:Se}):"N/A"}),i.jsxs("td",{children:[i.jsx("button",{onClick:()=>I(se),className:"edit-button",children:"Edit"}),i.jsx("button",{onClick:()=>ue(se.id),className:"delete-button",children:"Delete"}),se.clinic_id&&!X&&i.jsx("button",{onClick:()=>fe(se.clinic_id),className:"start-subscription-button",children:"Start Subscription"}),se.clinic_id&&X&&i.jsx("button",{onClick:()=>oe(se.clinic_id),className:"cancel-subscription-button",children:"Cancel Subscription"})]})]},se.id)})})]})]})},_ne="_modalOverlay_1spz3_3",jne="_modalContent_1spz3_29",kne="_modalHeader_1spz3_53",Tne="_modalTitle_1spz3_71",Ene="_modalCloseButton_1spz3_83",Ane="_modalBody_1spz3_111",Pne="_formGroup_1spz3_119",Dne="_inputField_1spz3_141",Ine="_errorText_1spz3_175",Rne="_successText_1spz3_193",Mne="_modalFooter_1spz3_211",One="_button_1spz3_227",Lne="_buttonPrimary_1spz3_247",Fne="_buttonSecondary_1spz3_265",qi={modalOverlay:_ne,modalContent:jne,modalHeader:kne,modalTitle:Tne,modalCloseButton:Ene,modalBody:Ane,formGroup:Pne,inputField:Dne,errorText:Ine,successText:Rne,modalFooter:Mne,button:One,buttonPrimary:Lne,buttonSecondary:Fne},$ne=({isOpen:e,onClose:n})=>{const[t,r]=w.useState(""),[a,o]=w.useState(!1),[l,d]=w.useState(!1),[f,u]=w.useState(null),[p,g]=w.useState(null);w.useEffect(()=>{e&&b()},[e]);const b=async()=>{o(!0),u(null);try{const S=await pe("/api/global-settings/app_gemini_api_key");if(S.ok){const k=await S.json();r(k.value||"")}else S.status}catch(S){console.warn("Could not fetch existing key:",S)}finally{o(!1)}},v=async()=>{d(!0),u(null),g(null);try{if(!(await pe("/api/global-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:"app_gemini_api_key",value:t})})).ok)throw new Error("Failed to save API Key");g("API Key updated successfully!"),setTimeout(()=>{n(),g(null)},1500)}catch(S){u(S.message||"Error saving key")}finally{d(!1)}};return e?i.jsx("div",{className:qi.modalOverlay,children:i.jsxs("div",{className:qi.modalContent,children:[i.jsxs("div",{className:qi.modalHeader,children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx(Ck,{size:24}),i.jsx("h3",{className:qi.modalTitle,children:"App Gemini API Key"})]}),i.jsx("button",{onClick:n,className:qi.modalCloseButton,children:i.jsx(zn,{size:20})})]}),i.jsxs("div",{className:qi.modalBody,children:[f&&i.jsx("div",{className:qi.errorText,children:f}),p&&i.jsx("div",{className:qi.successText,children:p}),i.jsxs("div",{className:qi.formGroup,children:[i.jsx("label",{htmlFor:"gemini-key",children:"Gemini API Key"}),i.jsx("input",{type:"text",id:"gemini-key",value:t,onChange:S=>r(S.target.value),className:qi.inputField,placeholder:"Enter Gemini API Key (AIza...)",disabled:a||l})]}),i.jsx("p",{style:{fontSize:"0.9em",color:"var(--secondary-text-color, #666)"},children:"This key will be used as a fallback for all clinics if their specific Gemini API key is not configured."})]}),i.jsxs("div",{className:qi.modalFooter,children:[i.jsx("button",{onClick:n,className:`${qi.button} ${qi.buttonSecondary}`,disabled:l,children:"Cancel"}),i.jsx("button",{onClick:v,className:`${qi.button} ${qi.buttonPrimary}`,disabled:l,children:l?"Saving...":"Save Key"})]})]})}):null},zne=()=>{const[e,n]=w.useState(!1);return i.jsxs("div",{className:"admin-panel-container",children:[i.jsxs("h1",{className:"admin-panel-title",children:[i.jsx(jb,{size:32,className:"icon-margin"}),"Super Admin Dashboard"]}),i.jsxs("div",{className:"admin-panel-grid",children:[i.jsxs(hs,{to:"/dashboard/clinic-subscriptions",className:"admin-panel-card",children:[i.jsx(Rh,{size:48,className:"card-icon"}),i.jsx("h2",{children:"Manage Clinic Subscription Plans"}),i.jsx("p",{children:"Add, edit, and view clinic subscription plans."})]}),i.jsxs(hs,{to:"/dashboard/users",className:"admin-panel-card",children:[i.jsx(Bh,{size:48,className:"card-icon"}),i.jsx("h2",{children:"User Management"}),i.jsx("p",{children:"Add, edit, and delete users; manage user roles."})]}),i.jsxs("div",{className:"admin-panel-card",onClick:()=>n(!0),style:{cursor:"pointer"},children:[i.jsx(Ck,{size:48,className:"card-icon"}),i.jsx("h2",{children:"Manage App Gemini API Key"}),i.jsx("p",{children:"Update the fallback Gemini API key used by the application."})]})]}),i.jsx($ne,{isOpen:e,onClose:()=>n(!1)})]})},J0="tutorialCurrentStep",Une=({onActionComplete:e,onStaffAdded:n,requiredRole:t})=>{const[r,a]=w.useState(""),[o,l]=w.useState(""),[d,f]=w.useState(""),[u,p]=w.useState(!1),g=t||"receptionist";w.useEffect(()=>{a(t==="lab"?"Lab":t==="pharmacy"?"Pharmacy":"")},[t]);const b=async()=>{if(!r||!o||!d){e(!1,"Please fill all fields.");return}p(!0);try{const v=await pe("/api/staff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,email:o,role:g,password:d})});if(v.ok)e(!0,`Successfully added "${r}" as a ${g}!`),a(""),l(""),f(""),n&&n(g);else{const S=await v.json();e(!1,`Failed: ${S.message||v.statusText}`)}}catch(v){e(!1,`Error: ${v instanceof Error?v.message:String(v)}`)}finally{p(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"text",placeholder:"Name",value:r,onChange:v=>a(v.target.value),disabled:u,className:"tutorial-input"}),i.jsx("input",{type:"email",placeholder:"Email",value:o,onChange:v=>l(v.target.value),disabled:u,className:"tutorial-input"})]}),i.jsxs("div",{className:"input-group",children:[i.jsx("input",{type:"password",placeholder:"Password",value:d,onChange:v=>f(v.target.value),disabled:u,className:"tutorial-input"}),i.jsx("div",{className:"role-badge",children:g==="lab"?"Lab Tech":g==="pharmacy"?"Pharmacist":"Receptionist"})]}),i.jsx("button",{onClick:b,className:"tutorial-button primary small",disabled:u,children:u?"Adding...":"Add Staff"})]})},Bne=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState(!1),o=async()=>{t(!0);try{(await pe("/api/drugs/import-defaults",{method:"POST"})).ok?(a(!0),e(!0,"Default medications imported successfully!","pharmacyImport")):e(!1,"Failed to import medications.")}catch{e(!1,"Error importing medications.")}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component center-content",children:[i.jsx("p",{className:"action-hint",children:"One click to populate your inventory."}),r?i.jsxs("div",{className:"success-badge",children:[i.jsx(Jx,{size:16})," Imported"]}):i.jsx("button",{onClick:o,className:"tutorial-button primary",disabled:n,children:n?"Importing...":i.jsxs(i.Fragment,{children:[i.jsx(mw,{size:18})," Import Drugs"]})})]})},qne=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState(!1),o=async()=>{t(!0);try{(await pe("/api/lab-tests/import-defaults",{method:"POST"})).ok?(a(!0),e(!0,"Default lab tests imported successfully!","labImport")):e(!1,"Failed to import lab tests.")}catch{e(!1,"Error importing lab tests.")}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component center-content",children:[i.jsx("p",{className:"action-hint",children:"Setup your lab with common tests."}),r?i.jsxs("div",{className:"success-badge",children:[i.jsx(Jx,{size:16})," Imported"]}):i.jsx("button",{onClick:o,className:"tutorial-button primary",disabled:n,children:n?"Importing...":i.jsxs(i.Fragment,{children:[i.jsx(Jl,{size:18})," Import Tests"]})})]})},Vne=[{icon:"",title:"Fever & Cold",description:"Rajesh Kumar, 35M, fever 2 days, body pain.",text:"Rajesh Kumar, 35 year old male, fever since 2 days, cold, body pain, no cough"},{icon:"",title:"Stomach Ache",description:"Priya Sharma, 28F, acidity, bloating 3 days.",text:"Priya Sharma, 28 year old female, stomach pain after eating, acidity, bloating since 3 days"}],Hne=({onSelectExample:e})=>i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("p",{className:"action-hint",children:"Click an example to try the AI:"}),i.jsx("div",{className:"example-cards-grid",children:Vne.map((n,t)=>i.jsxs("div",{className:"tutorial-example-card",onClick:()=>e(n.text),children:[i.jsx("div",{className:"example-icon",children:n.icon}),i.jsxs("div",{className:"example-info",children:[i.jsx("h4",{children:n.title}),i.jsx("p",{children:n.description})]}),i.jsx(Vd,{size:16,className:"arrow-icon"})]},t))})]}),K0=[{title:"Welcome to Newtons Ai HMS",description:"Your all-in-one clinic management solution. Let's get your clinic ready in less than 2 minutes.",icon:i.jsx(q6,{size:48,className:"step-icon welcome"}),component:null,actionText:"Get Started"},{title:"Pharmacy Setup",description:"Start by populating your pharmacy. We can import a standard list of medicines for you.",icon:i.jsx(mw,{size:48,className:"step-icon pharmacy"}),component:Bne,actionText:"Next",showSkip:!0},{title:"Lab Configuration",description:"Next, let's set up your lab. Import common lab tests to start generating reports immediately.",icon:i.jsx(Jl,{size:48,className:"step-icon lab"}),component:qne,actionText:"Next",showSkip:!0},{title:"Add Your Team",description:"Invite your staff. Create accounts for receptionists, pharmacists, and lab technicians.",icon:i.jsx(Bh,{size:48,className:"step-icon staff"}),component:Une,actionText:"Next",showSkip:!0},{title:"Experience the AI",description:"The magic happens here. Select an example case below to see how our AI creates patient records instantly.",icon:i.jsx(g3,{size:48,className:"step-icon ai"}),component:Hne,actionText:null,isLast:!0}],Gne=({onClose:e,onMarkAsSeen:n})=>{const[t,r]=w.useState(()=>{const T=localStorage.getItem(J0);return T?parseInt(T,10):0}),[a,o]=w.useState(!1),[l,d]=w.useState(null),[f,u]=w.useState(null),p=Et();w.useEffect(()=>{localStorage.setItem(J0,t.toString()),d(null)},[t]);const g=()=>{o(!0),setTimeout(()=>{r(T=>Math.min(T+1,K0.length-1)),o(!1)},300)},b=(T,A,M)=>{u(T),d(A),T&&(M==="pharmacyImport"||M==="labImport")&&setTimeout(g,1e3)},v=()=>{n(),e(),localStorage.removeItem(J0)},S=T=>{const A=encodeURIComponent(T);p(`/dashboard?tab=newtons-ai&caseDetails=${A}`),v()},k=K0[t];return i.jsx("div",{className:"tutorial-overlay",children:i.jsxs("div",{className:`tutorial-card ${a?"fade-out":"fade-in"}`,children:[i.jsxs("div",{className:"tutorial-visual",children:[i.jsx("div",{className:"icon-circle",children:k.icon}),i.jsx("div",{className:"step-indicators",children:K0.map((T,A)=>i.jsx("div",{className:`step-dot ${A===t?"active":""} ${A<t?"completed":""}`},A))})]}),i.jsxs("div",{className:"tutorial-content",children:[i.jsx("button",{className:"close-button",onClick:v,title:"Close Tutorial",children:i.jsx(zn,{size:20})}),i.jsxs("div",{className:"text-content",children:[i.jsx("h2",{children:k.title}),i.jsx("p",{className:"description",children:k.description})]}),i.jsxs("div",{className:"interactive-area",children:[k.component?i.jsx(k.component,{onActionComplete:b,onSelectExample:S}):null,l&&i.jsx("div",{className:`status-message ${f?"success":"error"}`,children:l})]}),i.jsxs("div",{className:"action-footer",children:[k.showSkip&&i.jsx("button",{onClick:g,className:"tutorial-button text-only",children:"Skip for now"}),k.actionText&&i.jsxs("button",{onClick:g,className:"tutorial-button primary",children:[k.actionText," ",i.jsx(Vd,{size:16})]})]})]})]})})},Yne=({isOpen:e,onClose:n,onSuccess:t,medication:r})=>{const[a,o]=w.useState(""),[l,d]=w.useState([]),[f,u]=w.useState(null),[p,g]=w.useState(!1);w.useEffect(()=>{if(e&&r){v([{id:Date.now(),medication_name:r.medicationName,drug_id:null,quantity:r.quantity,tablets_per_day:r.tabletsPerDay||1,number_of_days:r.numberOfDays||30,directions:r.directions||"",notes:r.notes||""}]),k(r.frequencyDays);try{const fe=new Date(r.nextDeliveryDate);isNaN(fe.getTime())||A(fe.toISOString().split("T")[0])}catch(fe){console.error("Error parsing date",fe)}u({id:r.patientId,name:r.patientName,phone:r.patientPhone,patient_token_number:r.patientToken})}else e&&!r&&(v([{id:Date.now(),medication_name:"",drug_id:null,quantity:1,tablets_per_day:1,number_of_days:30,directions:"",notes:""}]),k(30),A(""),u(null),o(""))},[e,r]);const[b,v]=w.useState([{id:Date.now(),medication_name:"",drug_id:null,quantity:1,tablets_per_day:1,number_of_days:30,directions:"",notes:""}]),[S,k]=w.useState(30),[T,A]=w.useState(""),[M,R]=w.useState(null),[z,F]=w.useState(""),[L,U]=w.useState([]),[B,J]=w.useState(!1),[D,$]=w.useState(!1),[H,te]=w.useState(null),Q=w.useRef(null),Y=w.useRef(null);w.useEffect(()=>{if(e){const fe=new Date;fe.setDate(fe.getDate()+30),A(fe.toISOString().split("T")[0])}},[e]);const V=w.useCallback(async fe=>{if(!fe.trim()){d([]);return}g(!0);try{const W=await pe(`/api/patients?search=${encodeURIComponent(fe)}&limit=10`);if(W.ok){const oe=await W.json();d(oe.patients||[])}}catch(W){console.error("Error searching patients:",W)}finally{g(!1)}},[]);w.useEffect(()=>{Q.current&&clearTimeout(Q.current),a&&!f?Q.current=setTimeout(()=>V(a),300):d([])},[a,f,V]);const ae=w.useCallback(async fe=>{if(!fe.trim()){U([]);return}J(!0);try{const W=await pe(`/api/drugs?search=${encodeURIComponent(fe)}&limit=10`);if(W.ok){const oe=await W.json();U(oe.drugs||[])}}catch(W){console.error("Error searching drugs:",W)}finally{J(!1)}},[]);w.useEffect(()=>{Y.current&&clearTimeout(Y.current),z&&M!==null?Y.current=setTimeout(()=>ae(z),300):U([])},[z,M,ae]);const re=fe=>{if(!fe)return 1;const W=fe.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return W?parseInt(W[1],10):1},le=fe=>{u(fe),o(`${fe.name} (${fe.patient_token_number})`),d([])},E=(fe,W)=>{const oe=[...b];oe[W]={...oe[W],medication_name:fe.name,drug_id:fe.id,pack_size:re(fe.pack),packs:0,loose:0,quantity:0},v(oe),R(null),F(""),U([])},ce=(fe,W,oe)=>{const se=[...b],je={...se[fe]},We=je.pack_size||1;if(W==="packs"||W==="loose"){const X=parseInt(oe)||0;W==="packs"&&(je.packs=X),W==="loose"&&(je.loose=X);const Se=je.packs||0,Ae=je.loose||0;je.quantity=Se*We+Ae}else if(W==="tablets_per_day"||W==="number_of_days"){W==="tablets_per_day"&&(je.tablets_per_day=oe),W==="number_of_days"&&(je.number_of_days=oe);const X=parseFloat(je.tablets_per_day.toString())||0,Se=parseInt(je.number_of_days.toString())||0,Ae=Math.ceil(X*Se);je.quantity=Ae,je.packs=Math.floor(Ae/We),je.loose=Ae%We}else je[W]=oe;se[fe]=je,v(se)},ue=()=>{v([...b,{id:Date.now(),medication_name:"",drug_id:null,quantity:1,tablets_per_day:1,number_of_days:S,directions:"",notes:"",packs:0,loose:0,pack_size:1}])},I=fe=>{b.length>1&&v(b.filter((W,oe)=>oe!==fe))},de=async fe=>{if(fe.preventDefault(),te(null),!f){te("Please select a patient.");return}if(b.some(oe=>!oe.medication_name||oe.quantity<=0)){te("Please ensure all items have a medication name and valid quantity.");return}$(!0);try{const oe={patient_id:f.id,items:b.map(je=>({medication_name:je.medication_name,drug_id:je.drug_id,quantity:je.quantity,tablets_per_day:je.tablets_per_day,number_of_days:je.number_of_days,directions:je.directions,notes:je.notes,frequency_days:S,next_delivery_date:T}))},se=await pe("/api/recurring-medications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(oe)});if(!se.ok){const je=await se.json();throw new Error(je.message+(je.error?": "+je.error:"")||"Failed to create recurring medication.")}t(),n(),u(null),o(""),v([{id:Date.now(),medication_name:"",drug_id:null,quantity:1,tablets_per_day:1,number_of_days:30,directions:"",notes:""}]),k(30)}catch(oe){te(oe.message)}finally{$(!1)}};return e?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"add-recurring-modal",style:{maxWidth:"800px",width:"95%"},children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h3",{children:"Add Recurring Medication Order"}),i.jsx("button",{className:"close-btn",onClick:n,children:i.jsx(zn,{size:20})})]}),i.jsxs("div",{className:"modal-body",children:[H&&i.jsx("div",{className:"error-message",children:H}),i.jsxs("form",{onSubmit:de,className:"recurring-form",children:[i.jsxs("div",{className:"order-settings-row",children:[i.jsxs("div",{className:"form-group",style:{flex:2},children:[i.jsxs("label",{children:[i.jsx(Ys,{size:16})," Patient"]}),i.jsxs("div",{className:"search-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search patient...",value:a,onChange:fe=>{o(fe.target.value),u(null)},className:f?"selected":"unselected"}),p&&i.jsx("span",{className:"spinner",children:"..."}),a&&!f&&l.length>0&&i.jsx("ul",{className:"suggestions-list",children:l.map(fe=>i.jsxs("li",{onClick:()=>le(fe),children:[i.jsx("div",{className:"suggestion-name",children:fe.name}),i.jsxs("div",{className:"suggestion-details",children:[fe.phone,"  ",fe.patient_token_number]})]},fe.id))})]})]}),i.jsxs("div",{className:"form-group",style:{flex:1},children:[i.jsxs("label",{children:[i.jsx($3,{size:16})," Frequency"]}),i.jsxs("select",{value:S,onChange:fe=>{const W=parseInt(fe.target.value);k(W);const oe=new Date;oe.setDate(oe.getDate()+W),A(oe.toISOString().split("T")[0]);const se=b.map(je=>({...je,number_of_days:W}));v(se)},children:[i.jsx("option",{value:15,children:"Every 15 Days"}),i.jsx("option",{value:30,children:"Every 30 Days"}),i.jsx("option",{value:60,children:"Every 60 Days"}),i.jsx("option",{value:90,children:"Every 90 Days"})]})]}),i.jsxs("div",{className:"form-group",style:{flex:1},children:[i.jsxs("label",{children:[i.jsx(Wm,{size:16})," Next Delivery"]}),i.jsx("input",{type:"date",value:T,onChange:fe=>A(fe.target.value)})]})]}),i.jsx("hr",{className:"divider"}),i.jsxs("div",{className:"items-header",children:[i.jsx("h4",{children:"Medications"}),i.jsxs("button",{type:"button",className:"add-item-btn",onClick:ue,children:[i.jsx(Zo,{size:14})," Add Drug"]})]}),i.jsx("div",{className:"items-list",children:b.map((fe,W)=>i.jsxs("div",{className:"medication-item-row",children:[i.jsxs("div",{className:"row-top",children:[i.jsxs("div",{className:"form-group med-search-group",children:[i.jsx("label",{children:"Drug Name"}),i.jsxs("div",{className:"search-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search drug...",value:M===W?z:fe.medication_name,onFocus:()=>{R(W),F(fe.medication_name)},onChange:oe=>{F(oe.target.value),ce(W,"medication_name",oe.target.value)}}),M===W&&B&&i.jsx("span",{className:"spinner",children:"..."}),M===W&&z&&L.length>0&&i.jsx("ul",{className:"suggestions-list",children:L.map(oe=>i.jsxs("li",{onClick:()=>E(oe,W),children:[i.jsx("div",{className:"suggestion-name",children:oe.name}),i.jsxs("div",{className:"suggestion-details",children:["Stock: ",oe.stock]})]},oe.id))})]})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Tabs/Day"}),i.jsx("input",{type:"number",min:"0.5",step:"0.5",value:fe.tablets_per_day,onChange:oe=>ce(W,"tablets_per_day",oe.target.value)})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Days"}),i.jsx("input",{type:"number",min:"1",value:fe.number_of_days,onChange:oe=>ce(W,"number_of_days",oe.target.value)})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Packs"}),i.jsx("input",{type:"number",min:"0",value:fe.packs||"",onChange:oe=>ce(W,"packs",oe.target.value),placeholder:"0"})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Loose"}),i.jsx("input",{type:"number",min:"0",value:fe.loose||"",onChange:oe=>ce(W,"loose",oe.target.value),placeholder:"0"})]}),i.jsxs("div",{className:"form-group small-input",children:[i.jsx("label",{children:"Total"}),i.jsx("input",{type:"number",value:fe.quantity,disabled:!0,style:{backgroundColor:"#f5f5f5",cursor:"not-allowed"}})]}),i.jsx("button",{type:"button",className:"remove-btn",onClick:()=>I(W),disabled:b.length===1,children:i.jsx(Ur,{size:16})})]}),i.jsxs("div",{className:"row-bottom",children:[i.jsx("div",{className:"form-group",style:{flex:1},children:i.jsx("input",{type:"text",placeholder:"Directions (e.g. 1-0-1 after food)",value:fe.directions,onChange:oe=>ce(W,"directions",oe.target.value)})}),i.jsx("div",{className:"form-group",style:{flex:1},children:i.jsx("input",{type:"text",placeholder:"Notes",value:fe.notes,onChange:oe=>ce(W,"notes",oe.target.value)})})]})]},fe.id))}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",className:"btn-cancel",onClick:n,children:"Cancel"}),i.jsx("button",{type:"submit",className:"btn-submit",disabled:D,children:D?"Creating...":"Create Recurring Order"})]})]})]})]})}):null},Wne=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,o]=w.useState(null),[l,d]=w.useState(""),[f,u]=w.useState(1),[p,g]=w.useState(1),[b,v]=w.useState(0),[S,k]=w.useState(!1),[T,A]=w.useState(void 0),M=10,R=w.useRef(null),z=w.useCallback(async($,H)=>{r(!0),o(null);try{let te=`/api/recurring-medications?page=${$}&limit=${M}`;H&&(te+=`&search=${encodeURIComponent(H)}`);const Q=await pe(te);if(!Q.ok)throw new Error("Failed to fetch recurring medications.");const Y=await Q.json();n(Y.medications),g(Y.totalPages),v(Y.total),u(Y.page)}catch(te){console.error(te),o(te.message||"An error occurred while fetching data.")}finally{r(!1)}},[]);w.useEffect(()=>(R.current&&clearTimeout(R.current),R.current=setTimeout(()=>{z(f,l)},500),()=>{R.current&&clearTimeout(R.current)}),[l,f,z]);const F=$=>{d($.target.value),u(1)},L=$=>{$>=1&&$<=p&&u($)},U=$=>{A($),k(!0)},B=()=>{z(f,l),k(!1),A(void 0)},J=$=>$===30?"Every 30 Days (Monthly)":$===15?"Every 15 Days":`Every ${$} Days`,D=$=>{switch($){case"active":return"status-pill status-pill-active";case"paused":return"status-pill status-pill-paused";case"cancelled":return"status-pill status-pill-cancelled";default:return"status-pill"}};return i.jsxs("div",{className:"refill-reminders-container",children:[i.jsxs("div",{className:"refill-header",children:[i.jsx("h3",{className:"refill-title",children:"Recurring Medications"}),i.jsxs("div",{className:"refill-actions",children:[i.jsxs("button",{className:"refill-action-button btn-add",onClick:()=>{A(void 0),k(!0)},children:[i.jsx(Ra,{size:16})," Add New"]}),i.jsxs("div",{className:"search-box",children:[i.jsx("input",{type:"text",placeholder:"Search patient, phone, medication...",value:l,onChange:F}),i.jsx(Hi,{size:18,className:"search-icon"})]})]})]}),a&&i.jsx("div",{className:"error-message-box",children:a}),i.jsx("div",{className:"refill-table-container",children:t?i.jsx("div",{className:"loading-pulse",children:"Loading..."}):e.length===0?i.jsx("div",{className:"empty-state",children:"No recurring medications found."}):i.jsxs("table",{className:"refill-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient Details"}),i.jsx("th",{children:"Medication Info"}),i.jsx("th",{children:"Frequency"}),i.jsx("th",{children:"Next Delivery"}),i.jsx("th",{children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map($=>i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{className:"patient-name",children:$.patientName}),i.jsxs("div",{className:"patient-subtext",children:["Phone: ",$.patientPhone]}),i.jsxs("div",{className:"patient-subtext",children:["Token: ",$.patientToken]})]}),i.jsxs("td",{children:[i.jsx("div",{className:"med-name",children:$.medicationName}),i.jsxs("div",{className:"med-qty",children:["Qty: ",$.quantity]}),($.tabletsPerDay||$.numberOfDays||$.directions)&&i.jsxs("div",{className:"med-usage-details",style:{fontSize:"0.8em",color:"#666",marginTop:"4px"},children:[$.tabletsPerDay&&i.jsxs("span",{children:[$.tabletsPerDay," tabs/day  "]}),$.numberOfDays&&i.jsxs("span",{children:[$.numberOfDays," days  "]}),$.directions&&i.jsx("span",{children:$.directions})]}),$.notes&&i.jsxs("div",{className:"med-notes",children:["Note: ",$.notes]})]}),i.jsx("td",{children:i.jsx("span",{className:"frequency-badge",children:J($.frequencyDays)})}),i.jsx("td",{children:i.jsx("div",{className:"date-display",children:new Date($.nextDeliveryDate).toLocaleDateString()})}),i.jsx("td",{children:i.jsx("span",{className:D($.status),children:$.status})}),i.jsx("td",{children:i.jsxs("div",{className:"action-buttons",children:[i.jsx("button",{className:"action-btn edit",title:"Edit",onClick:()=>U($),children:i.jsx(Kl,{size:16})}),i.jsx("button",{className:"action-btn delete",title:"Cancel/Delete",children:i.jsx(Ur,{size:16})})]})})]},$.id))})]})}),!t&&p>1&&i.jsxs("div",{className:"pagination-container",children:[i.jsxs("span",{className:"pagination-info",children:["Page ",f," of ",p," (Total ",b,")"]}),i.jsxs("div",{className:"pagination-controls",children:[i.jsxs("button",{onClick:()=>L(f-1),disabled:f===1,className:"page-btn",children:[i.jsx(_b,{size:16})," Prev"]}),i.jsxs("button",{onClick:()=>L(f+1),disabled:f===p,className:"page-btn",children:["Next ",i.jsx(Vd,{size:16})]})]})]}),i.jsx(Yne,{isOpen:S,onClose:()=>{k(!1),A(void 0)},onSuccess:B,medication:T})]})},Qne=()=>{const e=Et(),n=Br();return w.useEffect(()=>{const t=new URLSearchParams(n.search),r=t.get("token"),a=t.get("caseDetails");r?(async()=>{try{const l=await pe(`/api/patients?search=${r}&limit=1`);if(!l.ok)throw new Error("Failed to fetch patient by token");const f=(await l.json()).patients[0];if(!f)throw new Error("Patient with the given token not found");const u=await pe(`/api/queue/patient/${f.id}/latest`);if(u.ok){const b=await u.json();if(b!=null&&b._id){e(`/dashboard/edit-complaint/${b._id}`,{state:{initialComplaint:a}});return}}const p=await pe("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:f.id,complaint:a})});if(!p.ok)throw new Error("Failed to create queue entry");const g=await p.json();if(g!=null&&g.id)e(`/dashboard/edit-complaint/${g.id}`,{state:{initialComplaint:a}});else throw new Error("Failed to get ID from new queue entry.")}catch(l){console.error("Error handling complaint URL:",l),e("/dashboard/search-patient")}})():e("/dashboard/search-patient")},[n,e]),i.jsx("div",{children:"Loading..."})},Jne=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,o]=w.useState(null),l=w.useCallback(async()=>{r(!0),o(null);try{const u=await pe("/api/notifications?all=true");if(u.ok){const g=(await u.json()).sort((b,v)=>{const S={expired_drug:1,near_expiry_drug:2,low_stock:3},k=S[b.type]||99,T=S[v.type]||99;return k!==T?k-T:new Date(v.created_at).getTime()-new Date(b.created_at).getTime()});n(g)}else o("Failed to fetch notifications."),console.error("Failed to fetch notifications:",u.statusText)}catch(u){o("Error fetching notifications."),console.error("Error fetching notifications:",u)}finally{r(!1)}},[]);w.useEffect(()=>{l()},[l]);const d=async u=>{try{const p=await pe(`/api/notifications/${u}/read`,{method:"PUT"});p.ok?n(g=>g.map(b=>b.id===u?{...b,is_read:!0}:b)):console.error("Failed to mark notification as read:",p.statusText)}catch(p){console.error("Error marking notification as read:",p)}},f=async()=>{try{const u=e.filter(g=>!g.is_read).map(g=>g.id);if(u.length===0)return;const p=await pe("/api/notifications/mark-all-read",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationIds:u})});p.ok?n(g=>g.map(b=>({...b,is_read:!0}))):console.error("Failed to mark all notifications as read:",p.statusText)}catch(u){console.error("Error marking all notifications as read:",u)}};return t?i.jsx("div",{className:"notifications-page-container",children:"Loading notifications..."}):a?i.jsx("div",{className:"notifications-page-container error-message",children:a}):i.jsxs("div",{className:"notifications-page-container",children:[i.jsx("h2",{className:"notifications-page-title",children:"All Notifications"}),i.jsx("div",{className:"notifications-actions",children:i.jsx("button",{onClick:f,disabled:e.every(u=>u.is_read),className:"mark-all-read-button",children:"Mark All As Read"})}),e.length===0?i.jsx("p",{className:"no-notifications-message",children:"No notifications to display."}):i.jsx("ul",{className:"notifications-list",children:e.map(u=>i.jsxs("li",{className:`notification-item ${u.is_read?"read":"unread"}`,children:[i.jsxs("div",{className:"notification-content",children:[i.jsxs("span",{className:"notification-type",children:[u.type.replace(/_/g," "),": "]}),u.message]}),i.jsxs("div",{className:"notification-meta",children:[i.jsx("span",{className:"notification-timestamp",children:new Date(u.created_at).toLocaleString()}),!u.is_read&&i.jsx("button",{onClick:()=>d(u.id),className:"mark-read-button",children:"Mark as Read"})]})]},u.id))})]})},Fj=()=>{const e=Et(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,p]=w.useState(!1),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[A,M]=w.useState(null),[R,z]=w.useState([]),[F,L]=w.useState(null),[U,B]=w.useState(""),[J,D]=w.useState(""),[$,H]=w.useState(""),[te,Q]=w.useState(""),[Y,V]=w.useState(""),[ae,re]=w.useState(""),[le,E]=w.useState(""),[ce,ue]=w.useState(""),[I,de]=w.useState(""),[fe,W]=w.useState(""),[oe,se]=w.useState(""),je=w.useCallback(async()=>{a(!0),l(null);try{const Ne=await pe("/api/distributors");if(!Ne.ok)throw new Error(`Failed to fetch distributors: ${Ne.statusText}`);const K=await Ne.json();t(K)}catch(Ne){console.error("Failed to fetch distributors:",Ne),l(Ne.message||"Failed to load distributors.")}finally{a(!1)}},[]);w.useEffect(()=>{je()},[je]);const We=async Ne=>{Ne.preventDefault(),l(null);try{const K=await pe("/api/distributors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:U,contact_person:J,phone:$,email:te,address:Y,gst_number:ae,drug_license_number:le})});if(!K.ok){const ge=await K.json();throw new Error(ge.message||"Failed to add distributor.")}alert("Distributor added successfully!"),rt(),je()}catch(K){console.error("Error adding distributor:",K),l(K.message||"Failed to add distributor.")}},X=async Ne=>{if(Ne.preventDefault(),l(null),!!A)try{const K=await pe(`/api/distributors/${A.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:U,contact_person:J,phone:$,email:te,address:Y,gst_number:ae,drug_license_number:le})});if(!K.ok){const ge=await K.json();throw new Error(ge.message||"Failed to update distributor.")}alert("Distributor updated successfully!"),ze(),je()}catch(K){console.error("Error updating distributor:",K),l(K.message||"Failed to update distributor.")}},Se=async()=>{if(l(null),!!A)try{const Ne=await pe(`/api/distributors/${A.id}`,{method:"DELETE"});if(!Ne.ok){const K=await Ne.json();throw new Error(K.message||"Failed to delete distributor.")}alert("Distributor deleted successfully!"),at(),je()}catch(Ne){console.error("Error deleting distributor:",Ne),l(Ne.message||"Failed to delete distributor.")}},Ae=w.useCallback(async Ne=>{l(null);try{const K=await pe(`/api/distributors/${Ne}/payments`);if(!K.ok)throw new Error(`Failed to fetch payments: ${K.statusText}`);const He=(await K.json()).map(At=>({...At,order_value:parseFloat(At.order_value),amount_paid:parseFloat(At.amount_paid),balance_remaining:parseFloat(At.balance_remaining)}));z(He);const Qe=await pe(`/api/distributors/${Ne}/balance`);if(!Qe.ok)throw new Error(`Failed to fetch balance: ${Qe.statusText}`);const dt=await Qe.json();L({totalOrderValue:parseFloat(dt.totalOrderValue),totalAmountPaid:parseFloat(dt.totalAmountPaid),remainingBalance:parseFloat(dt.remainingBalance)})}catch(K){console.error("Error fetching payments/balance:",K),l(K.message||"Failed to load payments or balance.")}},[]),Pe=async Ne=>{if(Ne.preventDefault(),l(null),!!A)try{const K=await pe(`/api/distributors/${A.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:ce,order_value:parseFloat(I||"0"),amount_paid:parseFloat(fe||"0"),notes:oe})});if(!K.ok){const ge=await K.json();throw new Error(ge.message||"Failed to add payment.")}alert("Payment added successfully!"),ke(),Ae(A.id)}catch(K){console.error("Error adding payment:",K),l(K.message||"Failed to add payment.")}},Ze=()=>{B(""),D(""),H(""),Q(""),V(""),re(""),E(""),l(null),f(!0)},rt=()=>{f(!1)},lt=Ne=>{M(Ne),B(Ne.name),D(Ne.contact_person||""),H(Ne.phone||""),Q(Ne.email||""),V(Ne.address||""),re(Ne.gst_number||""),E(Ne.drug_license_number||""),l(null),p(!0)},ze=()=>{p(!1),M(null)},ot=Ne=>{M(Ne),l(null),b(!0)},at=()=>{b(!1),M(null)},be=Ne=>{M(Ne),Ae(Ne.id),l(null),S(!0)},$e=()=>{S(!1),M(null),z([]),L(null)},Be=Ne=>{M(Ne),ue(new Date().toISOString().split("T")[0]),de("0"),W("0"),se(""),l(null),T(!0)},ke=()=>{T(!1),M(null)};return r?i.jsx("div",{className:"loading-indicator",children:"Loading Distributors..."}):o?i.jsxs("div",{className:"error-indicator",children:["Error: ",o]}):i.jsxs("div",{className:"distributor-management-page",children:[i.jsxs("div",{className:"distributor-management-header",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[i.jsx(rn,{size:24})," Back"]}),i.jsx("h2",{children:"Distributor Management"})]}),(()=>{const Ne=n.reduce((ge,He)=>ge+parseFloat(He.remainingBalance||"0"),0),K=Ne>=0?"balance-positive":"balance-negative";return i.jsxs("div",{className:`total-balance-display ${K}`,children:[i.jsx("strong",{children:"Total Combined Balance:"})," ",Ne.toFixed(2)]})})(),i.jsxs("button",{onClick:Ze,className:"add-distributor-button",children:[i.jsx(Ra,{size:18}),"Add New Distributor"]})]}),i.jsx("div",{className:"distributor-table-container",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Contact Person"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Address"}),i.jsx("th",{children:"GST Number"})," ",i.jsx("th",{children:"Drug License Number"})," ",i.jsx("th",{children:"Remaining Balance"})," ",i.jsx("th",{className:"actions-cell",children:"Actions"})]})}),i.jsx("tbody",{children:n.length===0?i.jsxs("tr",{children:[i.jsx("td",{colSpan:9,className:"no-results-message",children:"No distributors found."})," "]}):n.map(Ne=>i.jsxs("tr",{children:[i.jsx("td",{children:Ne.name}),i.jsx("td",{children:Ne.contact_person||"-"}),i.jsx("td",{children:Ne.phone||"-"}),i.jsx("td",{children:Ne.email||"-"}),i.jsx("td",{children:Ne.address||"-"}),i.jsx("td",{children:Ne.gst_number||"-"})," ",i.jsx("td",{children:Ne.drug_license_number||"-"})," ",i.jsxs("td",{className:parseFloat(Ne.remainingBalance||"0")>0?"balance-positive":"balance-negative",children:["",Ne.remainingBalance||"0.00"]})," ",i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsxs("button",{onClick:()=>be(Ne),className:"action-text-button view-button",title:"View Payments & Balance",children:[i.jsx(G3,{size:16})," View Payments"]}),i.jsxs("button",{onClick:()=>Be(Ne),className:"action-text-button add-payment-button",title:"Add Payment",children:[i.jsx(Ra,{size:16})," Add Payment"]}),i.jsx("button",{onClick:()=>lt(Ne),className:"action-icon-button edit-button",title:"Edit Distributor",children:i.jsx(Kl,{size:16})}),i.jsx("button",{onClick:()=>ot(Ne),className:"action-icon-button delete-button",title:"Delete Distributor",children:i.jsx(Ur,{size:16})})]})})]},Ne.id))})]})}),d&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:rt,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Add New Distributor"}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("form",{onSubmit:We,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Name:"}),i.jsx("input",{type:"text",id:"name",value:U,onChange:Ne=>B(Ne.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"contact_person",value:J,onChange:Ne=>D(Ne.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"phone",value:$,onChange:Ne=>H(Ne.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email:"}),i.jsx("input",{type:"email",id:"email",value:te,onChange:Ne=>Q(Ne.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"address",children:"Address:"}),i.jsx("textarea",{id:"address",value:Y,onChange:Ne=>V(Ne.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"gst_number",value:ae,onChange:Ne=>re(Ne.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"drug_license_number",value:le,onChange:Ne=>E(Ne.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:rt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Distributor"})]})]})]})}),u&&A&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:ze,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Edit Distributor"}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("form",{onSubmit:X,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-name",children:"Name:"}),i.jsx("input",{type:"text",id:"edit-name",value:U,onChange:Ne=>B(Ne.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"edit-contact_person",value:J,onChange:Ne=>D(Ne.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"edit-phone",value:$,onChange:Ne=>H(Ne.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-email",children:"Email:"}),i.jsx("input",{type:"email",id:"edit-email",value:te,onChange:Ne=>Q(Ne.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-address",children:"Address:"}),i.jsx("textarea",{id:"edit-address",value:Y,onChange:Ne=>V(Ne.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"edit-gst_number",value:ae,onChange:Ne=>re(Ne.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"edit-drug_license_number",value:le,onChange:Ne=>E(Ne.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:ze,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Save Changes"})]})]})]})}),g&&A&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:at,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Confirm Delete"}),i.jsxs("p",{children:['Are you sure you want to delete distributor "',A.name,'"?']}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:at,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Se,className:"button-delete",children:"Delete"})]})]})}),v&&A&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content large-modal",children:[i.jsx("button",{onClick:$e,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Payments & Balance for ",A.name]}),o&&i.jsx("div",{className:"modal-error-message",children:o}),F&&i.jsxs("div",{className:"balance-summary",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Total Order Value:"})," ",F.totalOrderValue.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Total Amount Paid:"})," ",F.totalAmountPaid.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Remaining Balance:"})," ",F.remainingBalance.toFixed(2)]})]}),i.jsx("h4",{children:"Payment History"}),R.length===0?i.jsx("p",{children:"No payments recorded for this distributor."}):i.jsx("div",{className:"table-responsive",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Order Value"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Balance Remaining"}),i.jsx("th",{children:"Notes"})]})}),i.jsx("tbody",{children:R.map(Ne=>i.jsxs("tr",{children:[i.jsx("td",{children:new Date(Ne.payment_date).toLocaleDateString()}),i.jsxs("td",{children:["",Ne.order_value.toFixed(2)]}),i.jsxs("td",{children:["",Ne.amount_paid.toFixed(2)]}),i.jsxs("td",{children:["",Ne.balance_remaining.toFixed(2)]}),i.jsx("td",{children:Ne.notes||"-"})]},Ne.id))})]})}),i.jsx("div",{className:"modal-actions",children:i.jsx("button",{type:"button",onClick:$e,className:"button-cancel",children:"Close"})})]})}),k&&A&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:ke,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Add Payment for ",A.name]}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("form",{onSubmit:Pe,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_date",children:"Payment Date:"}),i.jsx("input",{type:"date",id:"payment_date",value:ce,onChange:Ne=>ue(Ne.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"order_value",children:"Order Value:"}),i.jsx("input",{type:"number",id:"order_value",value:I,onChange:Ne=>de(Ne.target.value),step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"amount_paid",children:"Amount Paid:"}),i.jsx("input",{type:"number",id:"amount_paid",value:fe,onChange:Ne=>W(Ne.target.value),step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_notes",children:"Notes:"}),i.jsx("textarea",{id:"payment_notes",value:oe,onChange:Ne=>se(Ne.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:ke,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Payment"})]})]})]})})]})},Kne=({isOpen:e,onClose:n,excelHeaders:t,onConfirm:r,availableFields:a})=>{const[o,l]=w.useState({});if(w.useEffect(()=>{e&&f()},[e,t,a]),!e)return null;const d=(p,g)=>{l(b=>({...b,[p]:g}))},f=()=>{const p={};t.forEach(g=>{const b=a.map(S=>({name:S})),v=zm(g,b);v&&(p[g]=v.name)}),l(p)},u=()=>{const p={};for(const g in o)o[g]&&o[g]!=="none"&&(p[g]=o[g]);r(p),n()};return i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:n,className:"modal-close-button",children:i.jsx(zn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Match File Columns"}),i.jsx("p",{className:"modal-description",children:'Please match the columns from your uploaded file to the corresponding fields in the drug inventory. You can use the "Auto Match" button for suggestions.'}),i.jsx("div",{className:"modal-actions-top",children:i.jsx("button",{type:"button",onClick:f,className:"button-auto-match",children:"Auto Match"})}),i.jsxs("div",{className:"column-mapping-grid",children:[i.jsx("div",{className:"grid-header",children:"Excel Column"}),i.jsx("div",{className:"grid-header",children:"App Field"}),t.map((p,g)=>i.jsxs(_n.Fragment,{children:[i.jsx("div",{className:"excel-header-cell",children:p}),i.jsx("div",{className:"app-field-cell",children:i.jsxs("select",{value:o[p]||"",onChange:b=>d(p,b.target.value),className:"app-field-select",children:[i.jsx("option",{value:"",children:"-- Select Field --"}),i.jsx("option",{value:"none",children:"None (Ignore Column)"}),a.map((b,v)=>i.jsxs("option",{value:b,children:[b==="name"?"Composition Name":b==="brand_name"?"Brand Name":b==="price"?"MRP":b==="buying_price"?"Rate":b==="unit"?"Pack":b==="batch"?"Batch":b==="hsn_code"?"HSN Code":b==="mfg"?"MFG":b==="loose_quantity"?"Loose":b.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase())," "]},v))]})})]},g))]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:n,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:u,className:"button-submit",children:"Confirm Mapping"})]})]})})},Xne=({purchaseRows:e,onCellChange:n,onRemoveDrug:t,onAddEmptyRow:r})=>{const a=w.useRef(new Map),o=["name","mrp","stock","pack","expiry_date","rate","brand_name","box_number","gst","discount","batch","hsn_code","mfg","loose"],l=(d,f,u)=>{if(d.key==="Tab"){d.preventDefault();const p=o.indexOf(u);if(p!==-1){const g=(p+1)%o.length,b=o[g],v=a.current.get(`${f}-${b}`);v==null||v.focus()}}};return e.length===0?i.jsxs("div",{className:"no-drugs-message",children:[i.jsx("p",{children:"No drugs added to the purchase list yet."}),i.jsxs("button",{onClick:r,className:"action-button add-drug-to-table-button",children:[i.jsx(Ra,{size:18,className:"button-icon"}),"Add the first drug"]})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"purchase-drugs-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Composition Name"}),i.jsx("th",{children:"MRP ()"}),i.jsx("th",{children:"Qty"}),i.jsx("th",{children:"Pack"}),i.jsx("th",{children:"Supplier"}),i.jsx("th",{children:"Expiry Date"}),i.jsx("th",{children:"Rate ()"}),i.jsx("th",{children:"Brand Name"}),i.jsx("th",{children:"Box Number"}),i.jsx("th",{children:"GST (%)"}),i.jsx("th",{children:"Discount (%)"}),i.jsx("th",{children:"Margin (%)"}),i.jsx("th",{children:"Batch"}),i.jsx("th",{children:"HSN Code"}),i.jsx("th",{children:"MFG"}),i.jsx("th",{children:"Loose"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map((d,f)=>i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("input",{type:"text",value:d.name||"",onChange:u=>n(u,d.id,"name"),onKeyDown:u=>l(u,d.id,"name"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-name`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.mrp,onChange:u=>n(u,d.id,"mrp"),onKeyDown:u=>l(u,d.id,"mrp"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-mrp`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.stock,onChange:u=>n(u,d.id,"stock"),onKeyDown:u=>l(u,d.id,"stock"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-stock`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.pack||"",onChange:u=>n(u,d.id,"pack"),onKeyDown:u=>l(u,d.id,"pack"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-pack`,u)}})}),i.jsx("td",{children:d.supplier||"N/A"}),i.jsx("td",{children:i.jsx("input",{type:"date",value:d.expiry_date||"",onChange:u=>n(u,d.id,"expiry_date"),onKeyDown:u=>l(u,d.id,"expiry_date"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-expiry_date`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.rate||"",onChange:u=>n(u,d.id,"rate"),onKeyDown:u=>l(u,d.id,"rate"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-rate`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.brand_name||"",onChange:u=>n(u,d.id,"brand_name"),onKeyDown:u=>l(u,d.id,"brand_name"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-brand_name`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.box_number||"",onChange:u=>n(u,d.id,"box_number"),onKeyDown:u=>l(u,d.id,"box_number"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-box_number`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.gst||"",onChange:u=>n(u,d.id,"gst"),onKeyDown:u=>l(u,d.id,"gst"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-gst`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.discount||"",onChange:u=>n(u,d.id,"discount"),onKeyDown:u=>l(u,d.id,"discount"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-discount`,u)}})}),i.jsx("td",{children:(()=>{const u=d.mrp||0,p=d.rate||0,g=d.gst!==null&&d.gst!==void 0?d.gst/100*p:0,b=d.discount!==null&&d.discount!==void 0?d.discount/100*u:0,v=u-(p+g)-b;return`${(u>0?v/u*100:0).toFixed(2)}%`})()}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.batch||"",onChange:u=>n(u,d.id,"batch"),onKeyDown:u=>l(u,d.id,"batch"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-batch`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.hsn_code||"",onChange:u=>n(u,d.id,"hsn_code"),onKeyDown:u=>l(u,d.id,"hsn_code"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-hsn_code`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:d.mfg||"",onChange:u=>n(u,d.id,"mfg"),onKeyDown:u=>l(u,d.id,"mfg"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-mfg`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:d.loose||"",onChange:u=>n(u,d.id,"loose"),onKeyDown:u=>l(u,d.id,"loose"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-loose`,u)}})}),i.jsx("td",{children:i.jsx("button",{onClick:()=>t(d.id),className:"text-red-600 hover:text-red-800 text-sm",children:"Remove"})})]},d.id||f))})]})})},$j=()=>{const e=Et(),{purchaseRows:n,setPurchaseRows:t,selectedDistributor:r,setSelectedDistributor:a,searchTerm:o,setSearchTerm:l,amountPaidToDistributor:d,setAmountPaidToDistributor:f,distributors:u,setDistributors:p}=ik(),[g,b]=w.useState(!1),v=w.useRef(null),S=w.useRef(null),[k,T]=w.useState(!1),A=w.useRef(null),[M,R]=w.useState(!1),[z,F]=w.useState([]),[L,U]=w.useState(null),[B,J]=w.useState(null),[D,$]=w.useState(!1),H=["name","description","mrp","stock","pack","supplier","expiry_date","rate","box_number","gst","margin","discount","brand_name","batch","hsn_code","mfg","loose"],te=()=>{const Se={id:Date.now().toString()+Math.random().toString(36).substring(2,9),name:"",composition:"",description:"",mrp:0,stock:0,pack:"",supplier:r?r.name:"",expiry_date:"",rate:0,box_number:"",gst:0,margin:0,discount:0,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:0,last_updated:"",created_at:""};t(Ae=>[...Ae,Se])},Q=async(X,Se)=>{if(!X){J("No file provided for import.");return}if(!r){J("Please select a distributor before importing.");return}b(!0),J(null);const Ae=new FormData;Ae.append("inventoryFile",X),Ae.append("columnMapping",JSON.stringify(Se));try{const Pe=await pe("/api/drugs/parse-excel",{method:"POST",body:Ae});if(!Pe.ok){const rt=await Pe.json();throw new Error(rt.message||`Failed to parse Excel file: ${Pe.statusText}`)}const Ze=await Pe.json();t(rt=>[...rt,...Ze.map(lt=>({...lt,id:Date.now().toString()+Math.random().toString(36).substring(2,9),supplier:r?r.name:lt.supplier}))]),alert(`Successfully parsed ${Ze.length} drugs from Excel. They have been added to the purchase list.`)}catch(Pe){console.error("Failed to parse Excel file:",Pe),J(Pe.message||"Failed to parse Excel file. Please check the file format and try again."),alert(`Excel parsing failed: ${Pe.message||"Please check the file format and try again."}`)}finally{v.current&&(v.current.value=""),b(!1),U(null)}},Y=async X=>{if(X.target.files&&X.target.files[0]){const Se=X.target.files[0];U(Se),J(null),b(!0);const Ae=new FormData;Ae.append("inventoryFile",Se);try{const Pe=await pe("/api/drugs/get-file-headers",{method:"POST",body:Ae});if(!Pe.ok){const rt=await Pe.json();throw new Error(rt.message||`Failed to get file headers: ${Pe.statusText}`)}const{headers:Ze}=await Pe.json();F(Ze),R(!0)}catch(Pe){console.error("Failed to get file headers:",Pe),J(Pe.message||"Failed to read file headers. Please check the file format and try again."),alert(`Error reading file headers: ${Pe.message||"Please check the file format and try again."}`),U(null)}finally{b(!1)}}else U(null)},V=X=>{L?Q(L,X):J("No file selected for import after mapping."),R(!1)},ae=()=>{R(!1),F([]),U(null),v.current&&(v.current.value="")},re=()=>{var X;(X=v.current)==null||X.click()},le=async X=>{if(X.target.files&&X.target.files[0]){const Se=X.target.files[0];J(null),b(!0);const Ae=new FormData;Ae.append("file",Se),Ae.append("output_type","csv");const Ze={Authorization:"Bearer 00841ac4-b279-11f0-ab55-0a3a41e3fad1"};try{const rt=await fetch("https://extraction-api.nanonets.com/extract",{method:"POST",headers:Ze,body:Ae});if(!rt.ok){const ke=await rt.json();throw new Error(ke.message||`Failed to extract data from image/PDF: ${rt.statusText}`)}const lt=await rt.json();if(!lt.success||!lt.content)throw new Error(lt.detail||"Nanonets API did not return expected content.");let ze=lt.content;ze=ze.split(`
`).filter(ke=>!ke.startsWith("#")&&ke.trim()!=="").join(`
`);const at=new File([ze],"extracted_data.csv",{type:"text/csv"}),be=new FormData;be.append("inventoryFile",at);const $e=await pe("/api/drugs/get-file-headers",{method:"POST",body:be});if(!$e.ok){const ke=await $e.json();throw new Error(ke.message||`Failed to get headers from extracted CSV: ${$e.statusText}`)}const{headers:Be}=await $e.json();F(Be),U(at),R(!0),alert("Successfully extracted data from image/PDF as CSV. Please map the columns.")}catch(rt){console.error("Failed to extract data from image/PDF:",rt),J(rt.message||"Failed to extract data from image/PDF. Please check the file and try again."),alert(`Image/PDF extraction failed: ${rt.message||"Please check the file and try again."}`)}finally{S.current&&(S.current.value=""),b(!1)}}},E=()=>{var X;(X=S.current)==null||X.click()},ce=()=>{if(!r){J("Please select a distributor before adding a drug manually.");return}$(!0)},ue=()=>{$(!1),J(null)},I=X=>{t(Se=>[...Se,{...X,id:Date.now().toString(),supplier:r?r.name:X.supplier}]),ue()},de=X=>{t(Se=>Se.filter(Ae=>Ae.id!==X))},fe=(X,Se,Ae)=>{const{value:Pe}=X.target;t(Ze=>Ze.map(rt=>{if(rt.id===Se){let lt=Pe;Ae==="expiry_date"?lt=Pe.trim()===""?null:Pe:["mrp","stock","rate","gst","margin","discount","loose"].includes(Ae)&&(lt=parseFloat(Pe),isNaN(lt)&&(lt=null));const ze={...rt,[Ae]:lt};return Ae==="name"&&r&&!ze.supplier&&(ze.supplier=r.name),ze}return rt}))},W=w.useCallback(()=>n.reduce((X,Se)=>{const Ae=Se.stock||0,Pe=Se.rate||0,Ze=Se.gst||0,rt=Se.discount||0;let lt=Pe*(1-rt/100),ze=Ae*lt;return ze+=ze*(Ze/100),X+ze},0),[n]),oe=async()=>{if(!r){J("Please select a distributor before submitting the purchase.");return}const X=n.filter(Se=>Object.values(Se).some(Ae=>typeof Ae=="string"&&Ae.trim()!==""||typeof Ae=="number"&&Ae!==0||Ae!=null&&typeof Ae!="string"&&typeof Ae!="number"));if(X.length===0){J("No valid drugs to submit. Please fill in at least one field for a row, or remove empty rows."),b(!1);return}b(!0),J(null);try{for(const Ze of X){const rt={...Ze,expiry_date:Ze.expiry_date===""?null:Ze.expiry_date,distributorId:r.id},lt=await pe("/api/drugs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(rt)});if(!lt.ok){const ze=await lt.json();throw new Error(ze.message||`Failed to add drug ${Ze.name}: ${lt.statusText}`)}}const Se=W(),Ae=new Date().toISOString().split("T")[0],Pe=await pe(`/api/distributors/${r.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:Ae,order_value:Se,amount_paid:d,notes:"Payment from purchase page."})});if(!Pe.ok){const Ze=await Pe.json();throw new Error(Ze.message||`Failed to record distributor payment: ${Pe.statusText}`)}alert("All valid drugs added to inventory and distributor payment recorded successfully!"),t([]),a(null),l(""),f(0),e("/dashboard/inventory")}catch(Se){console.error("Failed to submit purchase:",Se),J(Se.message||"Failed to submit purchase. Please try again."),alert(`Purchase submission failed: ${Se.message||"Please try again."}`)}finally{b(!1)}},se=w.useCallback(async X=>{if(X.trim()===""){p([]);return}try{const Se=await pe(`/api/distributors?search=${encodeURIComponent(X)}`);if(!Se.ok)throw new Error(`Failed to fetch distributors: ${Se.statusText}`);const Ae=await Se.json();p(Ae)}catch(Se){console.error("Failed to fetch distributors:",Se),J(Se.message||"Failed to load distributors.")}},[]),je=X=>{const Se=X.target.value;l(Se),a(null),A.current&&clearTimeout(A.current),Se.trim()!==""?A.current=setTimeout(()=>{se(Se),T(!0)},300):(p([]),T(!1))},We=X=>{a(X),l(X.name),T(!1),p([])};return w.useEffect(()=>{const X=Se=>{Se.target instanceof HTMLElement&&!Se.target.closest(".distributor-search-container")&&T(!1)};return document.addEventListener("mousedown",X),()=>{document.removeEventListener("mousedown",X),A.current&&clearTimeout(A.current)}},[]),i.jsxs("div",{className:"purchase-page",children:[i.jsxs("div",{className:"purchase-header",children:[i.jsx("button",{onClick:()=>e(-1),className:"action-icon-button",title:"Go Back",children:i.jsx(rn,{size:24})}),i.jsx("h2",{className:"purchase-page-title",children:"Purchase Inventory"})]}),B&&i.jsx("div",{className:"error-message",children:B}),i.jsxs("div",{className:"purchase-controls-header",children:[i.jsxs("div",{className:"distributor-selection-section",children:[i.jsxs("h3",{children:[i.jsx(nF,{size:24,className:"icon-left"})," Select Distributor"]}),i.jsxs("div",{className:"distributor-search-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(Hi,{size:20,className:"search-icon"}),i.jsx("input",{type:"text",placeholder:"Search distributor by name...",value:o,onChange:je,onFocus:()=>o.trim()!==""&&T(!0),className:"distributor-search-input"})]}),k&&u.length>0&&i.jsx("ul",{className:"distributor-search-results",children:u.map(X=>i.jsx("li",{onClick:()=>We(X),children:X.name},X.id))}),r&&i.jsxs("div",{className:"selected-distributor-info",children:["Selected: ",i.jsx("strong",{children:r.name}),r.contact_person&&i.jsxs("span",{children:[" (",r.contact_person,")"]})]})]})]}),i.jsxs("div",{className:"import-section",children:[i.jsxs("h3",{children:[i.jsx(UN,{size:24,className:"icon-left"})," Import Drugs"]}),i.jsx("p",{children:"Upload an Excel (.xlsx, .xls), CSV, PDF, or Image file to import drug data."}),i.jsxs("div",{className:"import-controls",children:[i.jsx("input",{ref:v,id:"excel-file-upload",name:"excel-file-upload",type:"file",className:"sr-only",accept:".xlsx, .xls, .csv",onChange:Y}),i.jsxs("button",{onClick:re,disabled:g||!r,className:`action-button import-button ${g?"importing":""}`,title:r?"":"Please select a distributor",children:[i.jsx(UN,{size:18,className:"button-icon"}),g?"Reading Headers...":"Import XL or CSV"]}),i.jsx("input",{ref:S,id:"image-pdf-file-upload",name:"image-pdf-file-upload",type:"file",className:"sr-only",accept:".pdf, .png, .jpg, .jpeg",onChange:le}),i.jsxs("button",{onClick:E,disabled:g||!r,className:"action-button import-button",title:r?"":"Please select a distributor",children:[i.jsx(du,{size:18,className:"button-icon"}),"Import from PDF/Image"]}),i.jsxs("button",{onClick:ce,className:"action-button add-drug-manual-button",disabled:!r,title:r?"":"Select a distributor to add drugs manually",children:[i.jsx(Ra,{size:18,className:"button-icon"}),"Add Drug"]})]})]})]}),i.jsx(Kne,{isOpen:M,onClose:ae,excelHeaders:z,onConfirm:V,availableFields:H}),D&&i.jsx(CE,{isOpen:D,onClose:ue,onDrugAddedToPurchase:I}),i.jsxs("div",{className:"purchase-summary-section",children:[i.jsxs("h3",{children:[i.jsx(Q6,{size:24,className:"icon-left"})," Drugs to be Purchased (",n.length,")"]}),i.jsx(Xne,{purchaseRows:n,onCellChange:fe,onRemoveDrug:de,onAddEmptyRow:te}),i.jsxs("div",{className:"purchase-summary-actions",children:[i.jsxs("button",{onClick:te,className:"action-button add-drug-to-table-button",children:[i.jsx(Ra,{size:18,className:"button-icon"}),"Add Row"]}),i.jsxs("div",{className:"summary-details",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"amount-paid-to-distributor",children:"Amount Paid ():"}),i.jsx("input",{type:"number",id:"amount-paid-to-distributor",value:d,onChange:X=>f(parseFloat(X.target.value)||0),placeholder:"0.00",className:"amount-paid-input",step:"0.01",disabled:!r,title:r?"":"Please select a distributor first"})]}),i.jsxs("div",{className:"total-purchase-value",children:[i.jsx("strong",{children:"Total Purchase Value:"})," ",W().toFixed(2)]})]}),i.jsx("button",{onClick:oe,disabled:g||n.length===0||!r,className:"action-button submit-purchase-button",children:g?"Submitting...":"Submit Purchase"})]})]})]})},Zne=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)/);return n&&n[1]?parseInt(n[1],10):1},ere=()=>{const e=Et(),n=Br(),[t,r]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState(!0),[f,u]=w.useState(null),[p,g]=w.useState(!1),[b,v]=w.useState("cash"),[S,k]=w.useState(""),[T,A]=w.useState(""),[M,R]=w.useState(""),[z,F]=w.useState(""),[L,U]=w.useState(""),[B,J]=w.useState(0),D=w.useRef(!1),$=le=>{const E=Math.max(0,Math.min(100,isNaN(le)?0:le));D.current=!0,J(E);const ce=a.map(ue=>({...ue,discount_percentage:E}));o(ce)},H=(le,E)=>{const ce=[...a];ce[le].discount_percentage=isNaN(E)?0:E,o(ce)};w.useEffect(()=>{if(D.current){D.current=!1;return}const le=a.reduce((ue,I)=>ue+(I.total_price??0),0);if(le===0){J(0);return}const ce=a.reduce((ue,I)=>{const fe=(I.total_price??0)*((I.discount_percentage??0)/100);return ue+fe},0)/le*100;J(ue=>Math.abs(ue-ce)>.01?ce:ue)},[a]);const te=async()=>{if(!t)return u("No order data available to bill."),null;if(a.length===0)return u("Cannot bill an empty order."),null;g(!0),u(null);try{const le=a.map(de=>{const fe=(de.pricePerLooseUnit??0)*(de.looseQuantity??0),W=fe*((de.discount_percentage??0)/100),oe=fe-W;return{name:de.name,pack_quantity:de.loosePacks??0,loose_quantity:de.looseUnits??0,price:de.originalPrice??0,pack_price:de.originalPrice??0,loose_price:de.pricePerLooseUnit??0,total:oe,drug_id:de.drug_id,discount_percentage:de.discount_percentage??0,batch:de.batch,expiry_date:de.expiry_date}}),E={patientId:t.patientId,queueId:t.id,items:le,amount:re,paymentMode:b,type:"pharmacy",related_id:t.id,status:"paid",discountPercentage:B},ce=await pe("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)}),ue=await ce.json();if(!ce.ok||!ue.id)throw new Error(ue.message||"Failed to create bill.");const I=await pe(`/api/pharmacy-orders/${t.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"billed",bill_id:ue.id,medications:a})});if(!I.ok){const de=await I.text();throw new Error(`Failed to update pharmacy order status: ${I.statusText} - ${de}`)}return r(de=>de?{...de,status:"billed",bill_id:ue.id}:null),alert(`Order ${t.patientName}'s bill created (ID: ${ue.id}) and marked as billed.`),e(`/dashboard/pharmacy-billing/${t.id}`,{replace:!0,state:{order:{...t,status:"billed",bill_id:ue.id},initialItems:a}}),ue.id}catch(le){return console.error("Billing process failed:",le),u(le.message||"Failed to mark order as billed. Please try again."),null}finally{g(!1)}},Q=()=>{window.print()},Y=async()=>{await te()&&(window.print(),e(-1))};w.useEffect(()=>{const le=n.pathname.split("/"),E=le[le.length-1];E?(async()=>{try{const ue=await pe(`/api/pharmacy-orders/${E}`);if(!ue.ok)throw new Error("Failed to fetch pharmacy order details");const I=await ue.json();r(I);const de=I.medications.map(fe=>{const W=Zne(fe.unit),oe=(fe.pack_quantity??0)*W+(fe.loose_quantity??0);return{...fe,isLoose:!0,loosePacks:fe.pack_quantity??0,looseUnits:fe.loose_quantity??0,looseQuantity:oe,pack_price:Number(fe.pack_price)||0,loose_price:Number(fe.loose_price)||0,total_price:Number(fe.total_price)||0,pricePerLooseUnit:Number(fe.loose_price)||0,originalPrice:Number(fe.pack_price)||0,discount_percentage:Number(fe.discount_percentage)??0,directions_to_use:fe.directions_to_use,tabletsPerDay:fe.tabletsPerDay,numberOfDays:fe.numberOfDays,batch:fe.batch,expiry_date:fe.expiry_date}});o(de)}catch(ue){console.error("Failed to fetch order:",ue),u(ue.message||"Failed to load order details.")}finally{d(!1)}})():(u("No pharmacy order ID provided."),d(!1))},[n.pathname]),w.useEffect(()=>{(async()=>{try{const E=await pe("/api/clinics/settings");if(!E.ok)throw new Error("Failed to fetch clinic settings");const ce=await E.json();A(ce.upi_id||""),R(ce.name||""),F(ce.address||""),U(ce.notes||"")}catch(E){console.error("Error fetching clinic settings:",E)}})()},[]);const V=w.useMemo(()=>a.reduce((le,E)=>le+(E.total_price??0),0),[a]),ae=w.useMemo(()=>a.reduce((le,E)=>{const ue=(E.total_price??0)*(E.discount_percentage??0)/100;return le+ue},0),[a]),re=w.useMemo(()=>V-ae,[V,ae]);return w.useEffect(()=>{if(re>0&&T){const le=`upi://pay?pa=${T}&pn=ClinicName&am=${re.toFixed(2)}&cu=INR`;k(le)}else k("")},[re,T]),l?i.jsx("div",{className:"loading-pulse",children:"Loading Bill..."}):f?i.jsxs("div",{className:"error-message-box",children:["Error: ",f]}):t?i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"TAX INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:M?`${M} Pharmacy`:"Pharmacy Bill"}),(z||L)&&i.jsxs("div",{className:"clinic-details-print",children:[z&&i.jsx("span",{className:"small-text clinic-address",children:z}),L&&i.jsx("span",{className:"small-text clinic-notes",children:L})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ys,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Qm,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Wm,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(rn,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Pharmacy Bill"})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ys,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Qm,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item no-print",children:[i.jsxs("strong",{children:[i.jsx(og,{size:16})," Order ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Wm,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Medications"})}),a.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"BATCH"}),i.jsx("th",{children:"EXPIRY"}),i.jsx("th",{children:"QUANTITY"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:a.map((le,E)=>{var fe,W;const ce=le.total_price??0,ue=ce*(le.discount_percentage??0)/100,I=ce-ue;return i.jsxs("tr",{children:[i.jsx("td",{children:E+1}),i.jsx("td",{children:le.name}),i.jsx("td",{children:le.batch||"N/A"}),i.jsx("td",{children:le.expiry_date?new Date(le.expiry_date).toLocaleDateString():"N/A"}),i.jsxs("td",{children:[i.jsxs("div",{children:["Packs: ",le.loosePacks??0]}),i.jsxs("div",{children:["Loose: ",le.looseUnits??0]})]}),i.jsx("td",{children:((fe=le.originalPrice)==null?void 0:fe.toFixed(2))??"N/A"}),i.jsx("td",{children:((W=le.pricePerLooseUnit)==null?void 0:W.toFixed(2))??"N/A"}),i.jsxs("td",{children:[i.jsx("input",{type:"number",value:le.discount_percentage??0,onChange:oe=>H(E,parseFloat(oe.target.value)),min:"0",max:"100",className:"discount-input-table"}),"%"]}),i.jsxs("td",{children:[5 .toFixed(1),"%"]}),i.jsx("td",{children:I.toFixed(2)})]},E)})})]}):i.jsx("p",{children:"No medications in this order."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[S&&i.jsxs("div",{className:`qr-code-container qr-code-printable-section ${b!=="upi"?"hide-on-screen":""}`,children:[i.jsx(Lh,{value:S,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",V.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsxs("span",{children:["Total Discount (",B.toFixed(2),"%)"]}),i.jsxs("span",{children:["- ",ae.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"GST (Included)"}),i.jsxs("span",{children:["",(re*.05).toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",re.toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",V.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",ae.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount Percentage"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:B,onChange:le=>$(parseFloat(le.target.value)),min:"0",max:"100",className:"discount-input-total",disabled:p||t.status==="billed"}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",re.toFixed(2)]})]}),i.jsx("div",{className:"qr-code-container",children:S?i.jsxs(i.Fragment,{children:[i.jsx(Lh,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]}):i.jsx("p",{children:"UPI QR code not available. Please ensure UPI ID is configured."})}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:b,onChange:le=>v(le.target.value),className:"payment-mode-select",disabled:p||t.status==="billed",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsxs("div",{className:"bill-actions",children:[t.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:Q,className:"secondary-button print-preview-button no-print",disabled:p||a.length===0,children:"Print Preview"}),i.jsx("button",{onClick:Y,className:"primary-button",disabled:p||a.length===0,children:p?"Processing...":"Finalise and Bill"})]}),t.status==="billed"&&i.jsx("button",{onClick:()=>e(`/dashboard/bills/${t.bill_id}`),className:"secondary-button",children:"View Bill"})]})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})}):i.jsx("div",{className:"error-message-box",children:"No order data available."})},tre=()=>{const e=Et(),n=Br(),[t,r]=w.useState(null),[a,o]=w.useState(""),[l,d]=w.useState(""),[f,u]=w.useState([]),[p,g]=w.useState(!0),[b,v]=w.useState(null),[S,k]=w.useState(!1),[T,A]=w.useState("cash"),[M,R]=w.useState(""),[z,F]=w.useState(""),[L,U]=w.useState(""),[B,J]=w.useState(""),[D,$]=w.useState(""),[H,te]=w.useState(0),Q=w.useRef(!1),Y=I=>{const de=Math.max(0,Math.min(100,isNaN(I)?0:I));Q.current=!0,te(de);const fe=f.map(W=>({...W,discount_percentage:de}));u(fe)},V=(I,de)=>{const fe=[...f];fe[I].discount_percentage=isNaN(de)?0:de,u(fe)};w.useEffect(()=>{if(Q.current){Q.current=!1;return}const I=f.reduce((W,oe)=>W+(oe.price??0),0);if(I===0){te(0);return}const fe=f.reduce((W,oe)=>{const je=(oe.price??0)*((oe.discount_percentage??0)/100);return W+je},0)/I*100;te(W=>Math.abs(W-fe)>.01?fe:W)},[f]);const ae=async()=>{if(!t)return v("No order data available to bill."),null;if(f.length===0)return v("Cannot bill an empty order."),null;k(!0),v(null);try{const I=f.map(se=>{const je=se.price,We=je*((se.discount_percentage??0)/100),X=je-We;return{name:se.name,price:se.price,quantity:1,total:X,item_id:se.id,type:"lab_test",discount_percentage:se.discount_percentage??0}}),de={patientId:t.patient_id,items:I,amount:ue,paymentMode:T,type:"lab",related_id:t.id,status:"paid",discountPercentage:H},fe=await pe("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(de)}),W=await fe.json();if(!fe.ok||!W.id)throw new Error(W.message||"Failed to create bill.");const oe=await pe(`/api/lab/${t.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"billed",bill_id:W.id})});if(!oe.ok){const se=await oe.text();throw new Error(`Failed to update lab order status: ${oe.statusText} - ${se}`)}return r(se=>se?{...se,status:"billed",bill_id:W.id}:null),alert(`Lab Order bill created (ID: ${W.id}) and marked as billed.`),e(`/dashboard/lab-billing/${t.id}`,{replace:!0,state:{...n.state,order:{...t,status:"billed",bill_id:W.id}}}),W.id}catch(I){return console.error("Billing process failed:",I),v(I.message||"Failed to mark order as billed. Please try again."),null}finally{k(!1)}},re=()=>{window.print()},le=async()=>{await ae()&&(window.print(),e(-1))};w.useEffect(()=>{const I=n.pathname.split("/"),de=I[I.length-1];de?(async()=>{try{const W=await pe(`/api/lab/${de}`);if(!W.ok)throw new Error("Failed to fetch lab order details");const oe=await W.json();if(r(oe),oe.patient_id){const je=await pe(`/api/patients/${oe.patient_id}`);if(je.ok){const We=await je.json();o(We.name),d(We.patient_token_number)}}const se=oe.tests.map(je=>({...je,price:typeof je.price=="string"?parseFloat(je.price):Number(je.price)||0,discount_percentage:0,total_price:typeof je.price=="string"?parseFloat(je.price):Number(je.price)||0}));u(se)}catch(W){console.error("Failed to fetch order:",W),v(W.message||"Failed to load order details.")}finally{g(!1)}})():(v("No lab order ID provided."),g(!1))},[n.pathname]),w.useEffect(()=>{(async()=>{try{const de=await pe("/api/clinics/settings");if(!de.ok)throw new Error("Failed to fetch clinic settings");const fe=await de.json();F(fe.upi_id||""),U(fe.name||""),J(fe.address||""),$(fe.notes||"")}catch(de){console.error("Error fetching clinic settings:",de)}})()},[]);const E=w.useMemo(()=>f.reduce((I,de)=>I+(de.price??0),0),[f]),ce=w.useMemo(()=>f.reduce((I,de)=>{const W=(de.price??0)*(de.discount_percentage??0)/100;return I+W},0),[f]),ue=w.useMemo(()=>E-ce,[E,ce]);return w.useEffect(()=>{if(ue>0&&z){const I=`upi://pay?pa=${z}&pn=ClinicName&am=${ue.toFixed(2)}&cu=INR`;R(I)}else R("")},[ue,z]),p?i.jsx("div",{className:"loading-pulse",children:"Loading Lab Bill..."}):b?i.jsxs("div",{className:"error-message-box",children:["Error: ",b]}):t?i.jsxs("div",{className:"pharmacy-billing-page",children:[" ",i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"LAB INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:L?`${L} Lab`:"Lab Bill"}),(B||D)&&i.jsxs("div",{className:"clinic-details-print",children:[B&&i.jsx("span",{className:"small-text clinic-address",children:B}),D&&i.jsx("span",{className:"small-text clinic-notes",children:D})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ys,{size:16})," Patient Name"]})," ",a]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Qm,{size:16})," Token"]})," ",l??"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Wm,{size:16})," Order Date"]})," ",new Date(t.createdAt).toLocaleDateString()]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(rn,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Lab Bill"})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Ys,{size:16})," Patient Name"]})," ",a]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Qm,{size:16})," Token"]})," ",l??"N/A"]}),i.jsxs("div",{className:"info-item no-print",children:[i.jsxs("strong",{children:[i.jsx(Jl,{size:16})," Order ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Wm,{size:16})," Order Date"]})," ",new Date(t.createdAt).toLocaleDateString()]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Lab Tests"})}),f.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"TEST DESCRIPTION"}),i.jsx("th",{children:"PRICE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:f.map((I,de)=>{const fe=I.price??0,W=fe*(I.discount_percentage??0)/100,oe=fe-W;return i.jsxs("tr",{children:[i.jsx("td",{children:de+1}),i.jsx("td",{children:I.name}),i.jsx("td",{children:typeof I.price=="number"?I.price.toFixed(2):Number(I.price||0).toFixed(2)}),i.jsxs("td",{children:[i.jsx("input",{type:"number",value:I.discount_percentage??0,onChange:se=>V(de,parseFloat(se.target.value)),min:"0",max:"100",className:"discount-input-table"}),"%"]}),i.jsx("td",{children:oe.toFixed(2)})]},de)})})]}):i.jsx("p",{children:"No tests in this order."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[M&&i.jsxs("div",{className:`qr-code-container qr-code-printable-section ${T!=="upi"?"hide-on-screen":""}`,children:[i.jsx(Lh,{value:M,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",E.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsxs("span",{children:["Total Discount (",H.toFixed(2),"%)"]}),i.jsxs("span",{children:["- ",ce.toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",ue.toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",E.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",ce.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount Percentage"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:H,onChange:I=>Y(parseFloat(I.target.value)),min:"0",max:"100",className:"discount-input-total",disabled:S||t.status==="billed"}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",ue.toFixed(2)]})]}),i.jsx("div",{className:"qr-code-container",children:M?i.jsxs(i.Fragment,{children:[i.jsx(Lh,{value:M,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]}):i.jsx("p",{children:"UPI QR code not available. Please ensure UPI ID is configured."})}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:T,onChange:I=>A(I.target.value),className:"payment-mode-select",disabled:S||t.status==="billed",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsxs("div",{className:"bill-actions",children:[t.status!=="billed"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:re,className:"secondary-button print-preview-button no-print",disabled:S||f.length===0,children:"Print Preview"}),i.jsx("button",{onClick:le,className:"primary-button",disabled:S||f.length===0,children:S?"Processing...":"Finalise and Bill"})]}),t.status==="billed"&&i.jsx("button",{onClick:()=>e("/billing",{state:{billId:t.bill_id}}),className:"secondary-button",children:"View Bill"})]})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})]}):i.jsx("div",{className:"error-message-box",children:"No order data available."})},nre=()=>{const e=Et(),[n,t]=w.useState(!0),[r,a]=w.useState([]),[o,l]=w.useState(""),[d,f]=w.useState(!0),[u,p]=w.useState(!1),[g,b]=w.useState({admissionCharge:"0.00",perDayCharge:"0.00",otherCharges:"0.00",aiMemory:"",clinicWideSystemPrompt:"",gemini_api_key:"",low_stock_threshold:"10",name:"",logoUrl:"",upi_id:"",address:"",notes:""}),[v,S]=w.useState(null),[k,T]=w.useState(!1),A=(D,$)=>{S({type:D,message:$}),setTimeout(()=>S(null),3e3)},M=D=>{switch(D){case"doctor":return i.jsx(Ik,{size:14,className:"text-blue-600"});case"receptionist":return i.jsx(gw,{size:14,className:"text-green-600"});case"pharmacy":return i.jsx(og,{size:14,className:"text-purple-600"});case"lab":return i.jsx(Jl,{size:14,className:"text-yellow-600"});default:return i.jsx(jb,{size:14,className:"text-gray-500"})}},R=D=>{switch(D){case"doctor":return"avatar-blue";case"receptionist":return"avatar-green";case"pharmacy":return"avatar-purple";case"lab":return"avatar-yellow";default:return"avatar-gray"}},z=w.useCallback(async()=>{t(!0);try{const D=await pe("/staff");if(D.ok){const $=await D.json();a($.map(H=>({...H,id:H._id||H.id})))}}catch(D){console.error("Error fetching staff:",D),A("error","Failed to load staff list")}finally{t(!1)}},[]),F=w.useCallback(async()=>{f(!0);try{const D=await pe("/api/clinics/settings");if(D.ok){const $=await D.json();b({admissionCharge:parseFloat($.admissionCharge||0).toFixed(2),perDayCharge:parseFloat($.perDayCharge||0).toFixed(2),otherCharges:parseFloat($.otherCharges||0).toFixed(2),aiMemory:$.aiMemory||"",clinicWideSystemPrompt:$.clinicWideSystemPrompt||"",gemini_api_key:$.gemini_api_key||"",low_stock_threshold:$.low_stock_threshold!==void 0&&$.low_stock_threshold!==null?String($.low_stock_threshold):"10",name:$.name||"",logoUrl:$.logoUrl||"",upi_id:$.upi_id||"",address:$.address||"",notes:$.notes||"",clinic_id:$.clinic_id})}}catch(D){console.error("Error fetching settings:",D),A("error","Failed to load settings")}finally{f(!1)}},[]);w.useEffect(()=>{z(),F()},[z,F]);const L=D=>{const{name:$,value:H}=D.target;b(te=>({...te,[$]:H}))},U=async()=>{p(!0);try{const D=parseFloat(g.admissionCharge),$=parseFloat(g.perDayCharge),H=parseFloat(g.otherCharges),te=parseInt(g.low_stock_threshold);if((await pe("/api/clinics/settings",{method:"PUT",body:JSON.stringify({name:g.name,admissionCharge:D,perDayCharge:$,otherCharges:H,aiMemory:g.aiMemory,clinicWideSystemPrompt:g.clinicWideSystemPrompt,gemini_api_key:g.gemini_api_key,low_stock_threshold:te,logoUrl:g.logoUrl,upi_id:g.upi_id,address:g.address,notes:g.notes})})).ok)A("success","Changes saved successfully");else throw new Error("Failed to save")}catch(D){console.error("Error saving settings:",D),A("error","Failed to save settings")}finally{p(!1)}},B=r.filter(D=>D.name.toLowerCase().includes(o.toLowerCase())||D.role.toLowerCase().includes(o.toLowerCase())),J=async D=>{for(const $ of D){const H=document.getElementById($);H&&(H.scrollIntoView({behavior:"smooth",block:"center"}),H.classList.add("ai-feedback-glow"),await new Promise(te=>setTimeout(te,1500)),H.classList.remove("ai-feedback-glow"))}};return i.jsxs("div",{className:"clinic-hub-container",children:[i.jsxs("header",{className:"clinic-hub-header",children:[i.jsxs("div",{className:"clinic-hub-title",children:[i.jsx("h1",{children:"Clinic Hub"}),i.jsx("p",{className:"clinic-hub-subtitle",children:"Manage your ecosystem"})]}),i.jsxs("div",{className:"clinic-hub-actions",children:[v&&i.jsx("div",{className:`px-4 py-2 rounded-md text-sm font-medium ${v.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.message}),i.jsxs("button",{className:"btn-assistant",onClick:()=>T(!0),style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 16px",backgroundColor:"#7c3aed",color:"white",borderRadius:"6px",marginRight:"8px"},children:[i.jsx(d1,{size:16})," AI Assistant"]}),i.jsxs("button",{className:"btn-add-staff",onClick:()=>e("/dashboard/staff/add"),children:[i.jsx(Zo,{size:16})," Add Staff"]}),i.jsxs("button",{className:"btn-save-changes",onClick:U,disabled:u,children:[i.jsx(Fd,{size:16})," ",u?"Saving...":"Save Changes"]})]})]}),i.jsxs("main",{className:"clinic-hub-content",children:[i.jsxs("div",{className:"team-directory-panel",children:[i.jsxs("div",{className:"panel-header",children:[i.jsx(Bh,{size:18,className:"text-gray-500"}),i.jsxs("span",{className:"panel-title",children:["Team Directory (",r.length,")"]})]}),i.jsx("div",{className:"search-container",children:i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(Hi,{size:16,className:"search-icon"}),i.jsx("input",{type:"text",placeholder:"Find member...",className:"search-input",value:o,onChange:D=>l(D.target.value)})]})}),i.jsx("div",{className:"team-list",children:n?i.jsx("div",{className:"p-4 text-center text-gray-500",children:"Loading staff..."}):B.length===0?i.jsx("div",{className:"empty-state",children:"No staff found."}):B.map(D=>i.jsxs("div",{id:`staff-member-${D.id}`,className:"team-member-item",children:[i.jsx("div",{className:`member-avatar ${R(D.role)}`,children:D.name.charAt(0).toUpperCase()}),i.jsxs("div",{className:"member-info",children:[i.jsx("div",{className:"member-name",children:D.name}),i.jsxs("div",{className:"member-role",children:[M(D.role),D.role]})]}),i.jsx("span",{className:`member-status ${D.active?"status-active":"status-inactive"}`,children:D.active?"Active":"Inactive"}),i.jsx("button",{className:"btn-edit-member",onClick:()=>e(`/dashboard/staff/edit/${D.id}`),children:i.jsx(Kl,{size:16})})]},D.id))})]}),i.jsxs("div",{className:"config-console-panel",children:[i.jsxs("div",{className:"panel-header",children:[i.jsx(_k,{size:18,className:"text-gray-500"}),i.jsx("span",{className:"panel-title",children:"Configuration Console"})]}),d?i.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading settings..."}):i.jsxs("div",{className:"config-content",children:[i.jsxs("div",{className:"config-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx(jk,{size:16})," CLINIC IDENTITY & LOCATION"]}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Clinic Name"}),i.jsx("input",{type:"text",className:"form-input",name:"name",id:"setting-name",value:g.name,onChange:L})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Logo URL"}),i.jsx("input",{type:"url",className:"form-input",placeholder:"https://",name:"logoUrl",id:"setting-logoUrl",value:g.logoUrl,onChange:L})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{className:"form-label",children:"Address"}),i.jsx("textarea",{className:"form-textarea",placeholder:"Full physical address",name:"address",id:"setting-address",value:g.address,onChange:L})]})]})]}),i.jsxs("div",{className:"config-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx(Rh,{size:16})," FINANCIAL OPERATIONS"]}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Admission Charge ()"}),i.jsx("input",{type:"number",className:"form-input",name:"admissionCharge",id:"setting-admissionCharge",value:g.admissionCharge,onChange:L})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Per Day Charge ()"}),i.jsx("input",{type:"number",className:"form-input",name:"perDayCharge",id:"setting-perDayCharge",value:g.perDayCharge,onChange:L})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Other Charges ()"}),i.jsx("input",{type:"number",className:"form-input",name:"otherCharges",id:"setting-otherCharges",value:g.otherCharges,onChange:L})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"UPI ID"}),i.jsx("input",{type:"text",className:"form-input",name:"upi_id",id:"setting-upi_id",value:g.upi_id,onChange:L})]})]})]}),i.jsxs("div",{className:"config-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx(Sk,{size:16})," INVENTORY & AI"]}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Low Stock Threshold"}),i.jsx("input",{type:"number",className:"form-input",name:"low_stock_threshold",id:"setting-low_stock_threshold",value:g.low_stock_threshold,onChange:L})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Gemini API Key"}),i.jsx("input",{type:"password",className:"form-input",name:"gemini_api_key",id:"setting-gemini_api_key",value:g.gemini_api_key,onChange:L,placeholder:"******************"})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{className:"form-label",children:"Clinic-Wide System Prompt"}),i.jsx("textarea",{className:"form-textarea",name:"clinicWideSystemPrompt",id:"setting-clinicWideSystemPrompt",value:g.clinicWideSystemPrompt,onChange:L,placeholder:"Instructions for the AI..."})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{className:"form-label",children:"AI Memory (Context)"}),i.jsx("textarea",{className:"form-textarea",name:"aiMemory",id:"setting-aiMemory",value:g.aiMemory,onChange:L,placeholder:"Shared context for the AI..."})]})]})]})]})]})]}),k&&i.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex justify-end",children:i.jsx("div",{className:"w-96 bg-white h-full shadow-2xl animate-slide-in-right",children:i.jsx(U2,{onClose:()=>T(!1),settings:g,staffList:r,onSettingsUpdate:F,onStaffUpdate:z,onHighlight:J})})})]})},rre="_container_1sjqk_1",ire="_header_1sjqk_15",are="_title_1sjqk_37",sre="_controls_1sjqk_51",ore="_dateInputGroup_1sjqk_63",lre="_dateInputLabel_1sjqk_75",cre="_dateInput_1sjqk_63",ure="_section_1sjqk_121",dre="_sectionTitle_1sjqk_137",fre="_statsGrid_1sjqk_157",hre="_statCard_1sjqk_171",pre="_statTitle_1sjqk_197",mre="_statValue_1sjqk_213",gre="_statSubtitle_1sjqk_225",yre="_revenueGrid_1sjqk_239",xre="_revenueCard_1sjqk_253",bre="_revenueCardTitle_1sjqk_267",vre="_revenueCardList_1sjqk_281",wre="_revenueCardListItem_1sjqk_293",Sre="_tableContainer_1sjqk_321",Nre="_table_1sjqk_321",Cre="_textGreen_1sjqk_395",_re="_textRed_1sjqk_403",jre="_loadingContainer_1sjqk_421",kre="_errorAlert_1sjqk_439",Xt={container:rre,header:ire,title:are,controls:sre,dateInputGroup:ore,dateInputLabel:lre,dateInput:cre,section:ure,sectionTitle:dre,statsGrid:fre,statCard:hre,statTitle:pre,statValue:mre,statSubtitle:gre,revenueGrid:yre,revenueCard:xre,revenueCardTitle:bre,revenueCardList:vre,revenueCardListItem:wre,tableContainer:Sre,table:Nre,textGreen:Cre,textRed:_re,loadingContainer:jre,errorAlert:kre},Tre=()=>{const e=Et(),n=new Date().toISOString().split("T")[0],[t,r]=w.useState(n),[a,o]=w.useState(n),[l,d]=w.useState(!1),[f,u]=w.useState(null),{setAnalysisDateRange:p,analysisDateRange:g,setAnalysisData:b,registerAnalysisNavigator:v,registerAnalysisRefresher:S}=vb(),k=Br(),[T,A]=w.useState(0),[M,R]=w.useState(0),[z,F]=w.useState(null),[L,U]=w.useState(null),[B,J]=w.useState({reception:{},pharmacy:{},lab:{}}),[D,$]=w.useState(null),H=w.useCallback(async(Q,Y)=>{d(!0),u(null);const V=Q||t,ae=Y||a;if(A(0),R(0),F(null),U(null),J({reception:{},pharmacy:{},lab:{}}),$(null),!V||!ae){u("Please select both start and end dates."),d(!1);return}try{const re=YL(),[le,E,ce,ue]=await Promise.all([pe(`/api/bills?startDate=${t}&endDate=${a}`),pe(`/api/payment/admission?startDate=${t}&endDate=${a}`),pe(`/api/subscriptions/transactions/manual?startDate=${t}&endDate=${a}`),re?pe(`/api/inventory/comprehensive-analysis?startDate=${t}&endDate=${a}&clinicId=${re}`):Promise.resolve(null)]);if(le.ok&&E.ok&&ce.ok){const I=await le.json(),de=await E.json(),fe=await ce.json(),W=I.bills||[],oe=de.admissionPayments||[],se=fe||[];let je=0,We=0;const X={},Se={consultation:0,pharmacy:0,lab:0,other:0},Ae={reception:{},pharmacy:{},lab:{}};W.forEach(Pe=>{if(Pe.status==="paid"||Pe.type==="pharmacy_return"){const Ze=parseFloat(Pe.amount.toString()),rt=Pe.payment_mode||"Unknown";let lt=Pe.type||"other";lt==="pharmacy_return"&&(We+=Ze,lt="pharmacy"),je+=Ze,X[rt]=(X[rt]||0)+Ze,Se.hasOwnProperty(lt)?Se[lt]=(Se[lt]||0)+Ze:Se.other=(Se.other||0)+Ze,lt==="pharmacy"?Ae.pharmacy[rt]=(Ae.pharmacy[rt]||0)+Ze:lt==="lab"?Ae.lab[rt]=(Ae.lab[rt]||0)+Ze:Ae.reception[rt]=(Ae.reception[rt]||0)+Ze}}),oe.forEach(Pe=>{const Ze=parseFloat(Pe.amount_paid.toString()),rt=Pe.payment_mode||"Unknown";je+=Ze,X[rt]=(X[rt]||0)+Ze,Ae.reception[rt]=(Ae.reception[rt]||0)+Ze}),se.forEach(Pe=>{var lt,ze;const Ze=parseFloat(((ze=(lt=Pe.subscriptionPlan)==null?void 0:lt.price)==null?void 0:ze.toString())??"0"),rt=Pe.subscription_payment_method||"manual";je+=Ze,X[rt]=(X[rt]||0)+Ze,Ae.reception[rt]=(Ae.reception[rt]||0)+Ze}),A(je),R(We),F(X),U(Se),J(Ae)}if(ue&&ue.ok){const I=await ue.json();$(I)}}catch(re){console.error("Analysis Fetch Error:",re),u("Failed to fetch analysis data. Please try again.")}finally{d(!1)}},[t,a]);w.useEffect(()=>{v(Q=>{const Y=`analysis-${Q}`,V=document.getElementById(Y);V&&(V.scrollIntoView({behavior:"smooth",block:"center"}),V.classList.add("ai-highlight-glow"),setTimeout(()=>V.classList.remove("ai-highlight-glow"),2e3))})},[v]),w.useEffect(()=>{S(async()=>(await H(),null))},[S,H]),w.useEffect(()=>{if(g.startDate&&g.endDate){const Q=g.startDate.toISOString().split("T")[0],Y=g.endDate.toISOString().split("T")[0];(Q!==t||Y!==a)&&(r(Q),o(Y))}},[g]),w.useEffect(()=>{const Y=new URLSearchParams(k.search).get("section");if(Y){const V=`analysis-${Y}`;setTimeout(()=>{const ae=document.getElementById(V);ae&&(ae.scrollIntoView({behavior:"smooth",block:"center"}),ae.classList.add("ai-highlight-glow"),setTimeout(()=>ae.classList.remove("ai-highlight-glow"),2e3))},500)}},[k.search]),w.useEffect(()=>{H()},[t,a,H]),w.useEffect(()=>{!l&&(T>0||D)&&b({totalRevenue:T,inventoryValue:0,pharmacyRevenue:(L==null?void 0:L.pharmacy)||0,labRevenue:(L==null?void 0:L.lab)||0,receptionRevenue:((L==null?void 0:L.consultation)||0)+((L==null?void 0:L.other)||0),inventorySummary:D?{totalItemsAnalyzed:D.pharmacyAnalysis.length,netPositiveItems:D.pharmacyAnalysis.filter(Q=>Q.net_change>0).length}:null})},[T,D,L,l,b]);const te=Q=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(Q);return i.jsxs("div",{className:Xt.container,children:[i.jsxs("div",{className:Xt.header,children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"p-2 hover:bg-gray-100 rounded-full",children:i.jsx(rn,{size:20,className:"text-gray-600"})}),i.jsx("h1",{className:Xt.title,children:"Analysis Dashboard"})]}),i.jsxs("div",{className:Xt.controls,children:[i.jsxs("div",{className:Xt.dateInputGroup,children:[i.jsx("label",{className:Xt.dateInputLabel,children:"From:"}),i.jsx("input",{type:"date",className:Xt.dateInput,value:t,onChange:Q=>{r(Q.target.value),a&&p({startDate:new Date(Q.target.value),endDate:new Date(a)})}})]}),i.jsxs("div",{className:Xt.dateInputGroup,children:[i.jsx("label",{className:Xt.dateInputLabel,children:"To:"}),i.jsx("input",{type:"date",className:Xt.dateInput,value:a,onChange:Q=>{o(Q.target.value),t&&p({startDate:new Date(t),endDate:new Date(Q.target.value)})}})]})]})]}),f&&i.jsxs("div",{className:Xt.errorAlert,children:[i.jsx(Ar,{size:20}),i.jsx("span",{children:f})]}),!l&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("section",{className:Xt.section,id:"analysis-financial",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(Rh,{className:"text-blue-600"}),i.jsx("h2",{className:Xt.sectionTitle,children:"Financial Performance"})]}),i.jsxs("div",{className:Xt.statsGrid,children:[i.jsxs("div",{className:Xt.statCard,children:[i.jsx("div",{className:Xt.statTitle,children:"Total Revenue Collected"}),i.jsx("div",{className:`${Xt.statValue} text-blue-600`,children:te(T)}),i.jsx("div",{className:Xt.statSubtitle,children:"All payment modes"})]}),z&&Object.entries(z).map(([Q,Y])=>i.jsxs("div",{className:Xt.statCard,children:[i.jsxs("div",{className:Xt.statTitle,children:[Q," Collections"]}),i.jsx("div",{className:Xt.statValue,children:te(Y)})]},Q))]}),B&&i.jsxs("div",{className:Xt.revenueGrid,children:[i.jsxs("div",{className:Xt.revenueCard,children:[i.jsx("h3",{className:Xt.revenueCardTitle,children:"Reception / Clinic"}),i.jsx("div",{className:"text-2xl font-bold mb-2",children:te(((L==null?void 0:L.consultation)||0)+((L==null?void 0:L.other)||0))}),i.jsx("ul",{className:Xt.revenueCardList,children:Object.entries(B.reception).map(([Q,Y])=>i.jsxs("li",{className:Xt.revenueCardListItem,children:[i.jsx("span",{children:Q}),i.jsx("span",{className:"font-medium text-gray-900",children:te(Y)})]},Q))})]}),i.jsxs("div",{className:Xt.revenueCard,children:[i.jsx("h3",{className:Xt.revenueCardTitle,children:"Pharmacy"}),i.jsx("div",{className:"text-2xl font-bold mb-2",children:te((L==null?void 0:L.pharmacy)||0)}),M<0&&i.jsxs("div",{className:"text-sm text-red-500 mb-2",children:["Returns: ",te(M)]}),i.jsx("ul",{className:Xt.revenueCardList,children:Object.entries(B.pharmacy).map(([Q,Y])=>i.jsxs("li",{className:Xt.revenueCardListItem,children:[i.jsx("span",{children:Q}),i.jsx("span",{className:"font-medium text-gray-900",children:te(Y)})]},Q))})]}),i.jsxs("div",{className:Xt.revenueCard,children:[i.jsx("h3",{className:Xt.revenueCardTitle,children:"Laboratory"}),i.jsx("div",{className:"text-2xl font-bold mb-2",children:te((L==null?void 0:L.lab)||0)}),i.jsx("ul",{className:Xt.revenueCardList,children:Object.entries(B.lab).map(([Q,Y])=>i.jsxs("li",{className:Xt.revenueCardListItem,children:[i.jsx("span",{children:Q}),i.jsx("span",{className:"font-medium text-gray-900",children:te(Y)})]},Q))})]})]})]}),i.jsxs("section",{className:Xt.section,id:"analysis-inventory",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(Ld,{className:"text-emerald-600"}),i.jsx("h2",{className:Xt.sectionTitle,children:"Inventory Movement"})]}),D&&D.pharmacyAnalysis.length>0?i.jsx("div",{className:Xt.tableContainer,children:i.jsxs("table",{className:Xt.table,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Item Name"}),i.jsx("th",{children:"Stock In"}),i.jsx("th",{children:"Stock Out"}),i.jsx("th",{children:"Net Change"}),i.jsx("th",{className:"text-right",children:"Est. Revenue"}),i.jsx("th",{className:"text-right",children:"Est. Profit"})]})}),i.jsx("tbody",{children:D.pharmacyAnalysis.map(Q=>i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:Q.name}),i.jsx("div",{className:"text-xs text-gray-500",children:Q.supplier})]}),i.jsxs("td",{className:Xt.textGreen,children:["+",Q.quantity_in,Object.entries(Q.quantity_in_by_reason).map(([Y,V])=>i.jsxs("div",{className:"text-xs opacity-75",children:[Y,": ",V]},Y))]}),i.jsxs("td",{className:Xt.textRed,children:["-",Q.quantity_out,Object.entries(Q.quantity_out_by_reason).map(([Y,V])=>i.jsxs("div",{className:"text-xs opacity-75",children:[Y,": ",V]},Y))]}),i.jsx("td",{children:i.jsxs("span",{className:`font-semibold ${Q.net_change>=0?"text-green-600":"text-red-600"}`,children:[Q.net_change>0?"+":"",Q.net_change]})}),i.jsx("td",{className:"text-right font-medium",children:te(Q.revenue)}),i.jsx("td",{className:`text-right font-medium ${Q.profit>=0?"text-green-600":"text-red-600"}`,children:te(Q.profit)})]},Q.drug_id))})]})}):i.jsx("div",{className:"text-center py-8 text-gray-500 mb-4 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:"No inventory movement recorded for this period."})]})]}),l&&i.jsxs("div",{className:Xt.loadingContainer,children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mb-4"}),i.jsx("div",{children:"Analyzing Financial & Inventory Data..."})]})]})},Ere=e=>{const n=new Date(e),r=Math.floor((new Date().getTime()-n.getTime())/1e3);let a=r/31536e3;return a>1?Math.floor(a)+" years ago":(a=r/2592e3,a>1?Math.floor(a)+" months ago":(a=r/86400,a>1?Math.floor(a)+" days ago":(a=r/3600,a>1?Math.floor(a)+" hours ago":(a=r/60,a>1?Math.floor(a)+" mins ago":Math.floor(r)+" seconds ago"))))},Are=({user:e})=>{const n=Et(),[t,r]=w.useState(!1),[a,o]=w.useState([]),[l,d]=w.useState(0),[f,u]=w.useState(!1),p=w.useRef(null),g=w.useCallback(async()=>{if(e!=null&&e.clinic_id)try{const A=await pe("/api/notifications");if(A.ok){const z=(await A.json()).reduce((F,L)=>{const U=F.find(B=>B.message===L.message);return U?new Date(L.created_at)>new Date(U.created_at)?F.map(B=>B.message===L.message?L:B):F:[...F,L]},[]).sort((F,L)=>{const U={expired_drug:1,near_expiry_drug:2,low_stock:3},B=U[F.type]||99,J=U[L.type]||99;return B!==J?B-J:new Date(L.created_at).getTime()-new Date(F.created_at).getTime()});o(z),d(z.filter(F=>!F.is_read).length)}}catch(A){console.error("Error fetching notifications:",A)}},[e==null?void 0:e.clinic_id]);w.useEffect(()=>{g();const A=setInterval(g,5*60*1e3);return()=>clearInterval(A)},[g]),w.useEffect(()=>{const A=M=>{p.current&&!p.current.contains(M.target)&&r(!1)};return t&&document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[t]);const b=()=>r(!t),v=async(A,M)=>{M.stopPropagation();try{(await pe(`/api/notifications/${A}/read`,{method:"PUT"})).ok&&(o(z=>z.map(F=>F.id===A?{...F,is_read:!0}:F)),d(z=>Math.max(0,z-1)))}catch(R){console.error("Error marking as read:",R)}},S=async()=>{const A=a.filter(M=>!M.is_read).map(M=>M.id);if(A.length!==0)try{(await pe("/api/notifications/mark-all-read",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationIds:A})})).ok&&(o(R=>R.map(z=>({...z,is_read:!0}))),d(0))}catch(M){console.error("Error marking all read",M)}},k=async()=>{u(!0);try{await pe("/api/notifications/trigger-all",{method:"POST"}),await g()}catch(A){console.error("Error triggering notifications",A)}finally{u(!1)}},T=A=>{switch(A){case"expired_drug":return i.jsx("div",{className:"notif-icon-bg expired",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})})});case"near_expiry_drug":return i.jsx("div",{className:"notif-icon-bg near-expiry",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})})});case"low_stock":return i.jsx("div",{className:"notif-icon-bg low-stock",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5m8.25 3.251l4.135 4.006a.956.956 0 01-1.352 1.354l-1.92-1.859V20.47a.862.862 0 11-1.725 0v-6.218l-1.92 1.86a.956.956 0 01-1.352-1.355l4.134-4.006zm0-5.836V7.5"})})});default:return i.jsx("div",{className:"notif-icon-bg default",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0"})})})}};return i.jsxs("div",{className:"notifications-section",ref:p,children:[i.jsxs("button",{className:`notification-icon ${t?"active":""}`,"aria-label":"Notifications",onClick:b,children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),l>0&&i.jsx("span",{className:"notification-count",children:l})]}),t&&i.jsxs("div",{className:"notifications-dropdown glass-effect",children:[i.jsxs("div",{className:"dropdown-header",children:[i.jsx("h3",{children:"Notifications"}),i.jsx("div",{className:"header-actions",children:l>0&&i.jsx("button",{className:"mark-all-btn",onClick:S,children:"Mark all read"})})]}),i.jsx("div",{className:"dropdown-list custom-scrollbar",children:a.filter(A=>!A.is_read).length>0?a.filter(A=>!A.is_read).map(A=>i.jsxs("div",{className:`dropdown-item ${A.is_read?"read":"unread"}`,onClick:M=>v(A.id,M),children:[i.jsx("div",{className:"item-icon",children:T(A.type)}),i.jsxs("div",{className:"item-content",children:[i.jsx("p",{className:"item-message",children:A.message}),i.jsx("span",{className:"item-time",children:Ere(A.created_at)})]}),!A.is_read&&i.jsx("div",{className:"unread-dot"})]},A.id)):i.jsx("div",{className:"empty-state",children:i.jsx("p",{children:"No new notifications"})})}),i.jsxs("div",{className:"dropdown-footer",children:[i.jsx("button",{onClick:()=>{r(!1),n("/dashboard/notifications")},children:"View All History"}),(e.role==="admin"||e.role==="superadmin")&&i.jsx("button",{onClick:k,className:"refresh-btn",disabled:f,title:"Refresh Inventory Checks",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:f?"spin":"",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"})})})]})]})]})};function Pre(){const[e,n]=w.useState(!1),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),p=R=>{r(R),n(!0),R.role==="admin"&&!R.has_seen_tutorial&&u(!0)},g=()=>{n(!1),r(null),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")};w.useEffect(()=>{const R=localStorage.getItem("authToken"),z=localStorage.getItem("currentUser");if(R&&z)try{const F=JSON.parse(z);r(F),n(!0),F.role==="admin"&&!F.has_seen_tutorial&&u(!0)}catch(F){console.error("Error parsing stored user data:",F),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")}o(!1)},[]),w.useEffect(()=>{(async()=>{if(e&&t)try{const z=await bne();d(z)}catch(z){console.error("Error fetching clinic pro plan status:",z),d({hasProPlan:!1})}else d(null)})()},[e,t]);const[b,v]=w.useState(null),[S,k]=w.useState(!1);w.useEffect(()=>{const R=z=>{z.preventDefault(),v(z),k(!0),console.log("beforeinstallprompt event fired")};return window.addEventListener("beforeinstallprompt",R),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&(console.log("App is already installed (standalone)."),k(!1)),()=>{window.removeEventListener("beforeinstallprompt",R)}},[]),w.useEffect(()=>{const R=window.matchMedia("(prefers-color-scheme: dark)"),z=()=>{R.matches?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")};return z(),R.addEventListener("change",z),()=>{R.removeEventListener("change",z),document.body.classList.remove("dark-mode")}},[]);const T=w.useCallback(async()=>{if(!b){console.log("Install prompt event not available.");return}const R=b;R.prompt();const{outcome:z}=await R.userChoice;console.log(`User response to the install prompt: ${z}`),v(null),k(!1)},[b]),A=async()=>{if(t)try{(await pe(`/api/users/${t.id}/tutorial-seen`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({has_seen_tutorial:!0})})).ok?(r(z=>z?{...z,has_seen_tutorial:!0}:null),localStorage.setItem("currentUser",JSON.stringify({...t,has_seen_tutorial:!0})),u(!1)):console.error("Failed to update tutorial status on backend.")}catch(R){console.error("Error marking tutorial as seen:",R)}};return a?i.jsx(bP,{}):i.jsx(wP,{clientId:"277898779560-33obduhn8r758rini4qagetdrupvisri.apps.googleusercontent.com",children:i.jsx(KD,{children:i.jsx(XD,{children:i.jsxs($D,{children:[i.jsx(JD,{children:i.jsxs(wh,{children:[i.jsx(mt,{path:"/login",element:e?i.jsx(vn,{to:"/dashboard"}):i.jsx(i9,{onLoginSuccess:p})}),i.jsx(mt,{path:"/register",element:e?i.jsx(vn,{to:"/dashboard"}):i.jsx(a9,{})}),i.jsx(mt,{path:"/handle-complaint-url",element:e?i.jsx(Qne,{}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/live-api",element:e?i.jsx(sY,{}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/create-lab-order",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(pE,{currentUser:t})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/manage-admission",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(fE,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/lab/report/:orderId",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Oj,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/lab/enter-report/:orderId",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Oj,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/dashboard/add-patient",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(U1,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/billing",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(jte,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/dashboard/edit-complaint/:recordId",element:e&&t?i.jsx(Ij,{}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/dashboard/edit-complaint/patient/:patientId",element:e&&t?i.jsx(Ij,{}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/dashboard/edit-pharmacy-order/:orderId",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(jA,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/dashboard/*",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:Dre(t.role,t,pe)}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/lab/view-report/:orderId",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Lte,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/lab/search-report",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Fte,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/patient/:patientId/lab-reports",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx($te,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/patient/:patientId/pharmacy-orders",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(kte,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/dashboard/inventory",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(kA,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/dashboard/inventory/add",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(VW,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/dashboard/inventory/edit/:id",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(NE,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/lab-inventory",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Qw,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/patient/:patientId/complaints",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Cte,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/patient/:patientId/admission-bill/:billId",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(qte,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/start-subscription/:patientId",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(une,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/start-clinic-subscription",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Nne,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/refill-reminders",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Wne,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/dashboard/notifications",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Jne,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/create-custom-bill",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(hE,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/dashboard/pharmacy-billing/:orderId",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(ere,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/dashboard/lab-billing/:orderId",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(tre,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/dashboard/analysis",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Tre,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"/dashboard/clinic-hub",element:e&&t?i.jsx(Zn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(nre,{})}):i.jsx(vn,{to:"/login"})}),i.jsx(mt,{path:"*",element:i.jsx(vn,{to:e?"/dashboard":"/login"})})]})}),f&&i.jsx(Gne,{onClose:()=>u(!1),onMarkAsSeen:A}),e&&t&&i.jsx(Ire,{user:t})]})})})})}const Dre=(e,n,t)=>{switch(e){case"superadmin":return i.jsxs(wh,{children:[i.jsx(mt,{index:!0,element:i.jsx(zne,{})}),i.jsx(mt,{path:"clinic-subscriptions",element:i.jsx(vne,{})}),i.jsx(mt,{path:"clinic-subscriptions/add",element:i.jsx(wne,{})}),i.jsx(mt,{path:"clinic-subscriptions/edit/:id",element:i.jsx(Sne,{})}),i.jsx(mt,{path:"users",element:i.jsx(Cne,{})})," ",i.jsx(mt,{path:"*",element:i.jsx("div",{children:"Unknown Super Admin Section"})})]});case"admin":return i.jsxs(wh,{children:[i.jsx(mt,{index:!0,element:i.jsx(pY,{fetchWithAuth:t})}),i.jsx(mt,{path:"staff",element:i.jsx(Bte,{fetchWithAuth:t})}),i.jsx(mt,{path:"staff/add",element:i.jsx(HW,{clinicId:n==null?void 0:n.clinic_id})}),i.jsx(mt,{path:"staff/edit/:id",element:i.jsx(GW,{})}),i.jsx(mt,{path:"patients/add",element:i.jsx(U1,{})}),i.jsx(mt,{path:"search-patient",element:i.jsx(_h,{})}),i.jsx(mt,{path:"patients",element:i.jsx($1,{})}),i.jsx(mt,{path:"inventory",element:i.jsx(SE,{})}),i.jsx(mt,{path:"inventory/edit/:id",element:i.jsx(NE,{})}),i.jsx(mt,{path:"distributors",element:i.jsx(Fj,{})}),i.jsx(mt,{path:"purchase",element:i.jsx($j,{})})," ",i.jsx(mt,{path:"queue",element:i.jsx(E0,{})}),i.jsx(mt,{path:"subscriptions",element:i.jsx(one,{})}),i.jsx(mt,{path:"subscriptions/add",element:i.jsx(lne,{})}),i.jsx(mt,{path:"subscriptions/edit/:id",element:i.jsx(cne,{})}),i.jsx(mt,{path:"*",element:i.jsx("div",{children:"Unknown Admin Section"})})," "]});case"doctor":return i.jsxs(wh,{children:[i.jsx(mt,{index:!0,element:i.jsx(vn,{to:"search-patient",replace:!0})}),i.jsx(mt,{path:"search-patient",element:i.jsx(_h,{})}),i.jsx(mt,{path:"queue",element:i.jsx(E0,{})}),i.jsx(mt,{path:":patientId",element:i.jsx(E0,{})}),i.jsx(mt,{path:"add-patient",element:i.jsx(U1,{})}),i.jsx(mt,{path:"*",element:i.jsx("div",{children:"Unknown Doctor Section"})})]});case"receptionist":return i.jsxs(wh,{children:[i.jsx(mt,{index:!0,element:i.jsx(gY,{currentUser:n})}),i.jsx(mt,{path:"all-patients",element:i.jsx($1,{})}),i.jsx(mt,{path:"search-patient",element:i.jsx(_h,{})}),i.jsx(mt,{path:"*",element:i.jsx("div",{children:"Unknown Reception Section"})})," "]});case"lab":return i.jsx(zW,{});case"pharmacy":return i.jsxs(wh,{children:[i.jsx(mt,{index:!0,element:i.jsx(UW,{})}),i.jsx(mt,{path:"inventory",element:i.jsx(kA,{})}),i.jsx(mt,{path:"settings",element:i.jsx(qW,{})}),i.jsx(mt,{path:"add-order",element:i.jsx(Tte,{})}),i.jsx(mt,{path:"edit-pharmacy-order/:orderId",element:i.jsx(jA,{})}),i.jsx(mt,{path:"orders/:orderId",element:i.jsx(ene,{})}),i.jsx(mt,{path:"search-patient-records",element:i.jsx(_h,{})}),i.jsx(mt,{path:"distributors",element:i.jsx(Fj,{})}),i.jsx(mt,{path:"purchase",element:i.jsx($j,{})})," ",i.jsx(mt,{path:"*",element:i.jsx(vn,{to:"/dashboard",replace:!0})})]});default:return i.jsxs("div",{children:["Unknown role (",e,") or dashboard not implemented."]},e)}},Zn=({user:e,onLogout:n,children:t,showInstallPrompt:r,onInstallClick:a,clinicProPlanStatus:o})=>{const l=Et(),[d,f]=w.useState(!1),[u,p]=w.useState(window.innerWidth<=768),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>c1.subscribe(A=>{S(A)}),[]),w.useEffect(()=>{const A=()=>{p(window.innerWidth<=768)};return window.addEventListener("resize",A),()=>window.removeEventListener("resize",A)},[]),w.useEffect(()=>{(async()=>{if(e!=null&&e.clinic_id)try{const M=await pe("/api/clinics/settings");if(M.ok){const R=await M.json();b(R.logoUrl)}else console.error("Failed to fetch clinic details for display:",M.statusText),b(null)}catch(M){console.error("Error fetching clinic details for display:",M),b(null)}else b(null)})()},[e==null?void 0:e.clinic_id]);const k=()=>{f(!d)},{toggleAssistant:T}=vb();return i.jsxs("div",{className:"dashboard-layout",children:[" ",i.jsxs("nav",{className:"app-header no-print",children:[i.jsxs("div",{className:"header-left",children:[i.jsx("a",{href:"#",onClick:A=>{A.preventDefault(),l("/dashboard")},className:"logo-container",children:i.jsx("img",{src:g||"/logo.png",alt:"App Logo",className:"logo-image"})}),i.jsxs("div",{className:"title-section",children:[i.jsx("span",{className:"app-title-link",children:"Newtons Ai"}),i.jsxs("span",{className:"user-role-panel",children:["(",e.role.charAt(0).toUpperCase()+e.role.slice(1)," Panel)"]})]})]}),i.jsxs("div",{className:"header-right",children:[r&&i.jsxs("button",{onClick:a,className:"install-button",title:"Install App",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),i.jsx("span",{children:"Install"})]}),o&&(o.hasProPlan?i.jsx("span",{className:"pro-badge",children:"PRO"}):i.jsx("button",{onClick:()=>l("/start-clinic-subscription"),className:"go-pro-button",children:"GoPro"})),i.jsx("button",{onClick:T,className:"p-2 mr-2 text-gray-600 hover:text-blue-600 transition-colors",title:"Open AI Assistant",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:i.jsx("path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"})})}),i.jsx(Are,{user:e}),i.jsx("button",{className:"hamburger-icon",onClick:k,"aria-label":"Open navigation",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})})]}),v&&i.jsx("div",{className:"global-loading-bar"})]}),i.jsx("main",{className:"main-content",children:t}),u?i.jsx(m9,{user:e,onLogout:n,userRole:e.role,isOpen:d,onClose:k,roleNavigation:H2}):i.jsx(p9,{user:e,onLogout:n,userRole:e.role,isOpen:d,onClose:k}),!u&&d&&i.jsx("div",{className:"side-panel-overlay",onClick:k}),!u&&d&&i.jsx("div",{className:"side-panel-overlay",onClick:k})]})},Ire=({user:e})=>{const{isOpen:n,closeAssistant:t}=vb(),r=Et(),[a,o]=w.useState(null),[l,d]=w.useState([]);return w.useEffect(()=>{(async()=>{if(e!=null&&e.clinic_id)try{const[u,p]=await Promise.all([pe("/api/clinics/settings"),pe("/api/staff")]);u.ok&&o(await u.json()),p.ok&&d(await p.json())}catch(u){console.error("Failed to fetch initial AI context",u)}})()},[e.clinic_id]),n?i.jsx("div",{className:"ai-assistant-wrapper",children:i.jsx(U2,{onClose:t,settings:a,staffList:l,onSettingsUpdate:()=>{},onStaffUpdate:()=>{},onHighlight:f=>{f.forEach(u=>{if(u.startsWith("navigate_")){const p=u.replace("navigate_","");r(`/dashboard/analysis?section=${p}`)}else{const p=document.getElementById(u);p&&(p.scrollIntoView({behavior:"smooth",block:"center"}),p.classList.add("ai-highlight-glow"),setTimeout(()=>p.classList.remove("ai-highlight-glow"),2e3))}})}})}):null};xP.createRoot(document.getElementById("root")).render(i.jsx(w.StrictMode,{children:i.jsx(Pre,{})}));
