var _P=Object.defineProperty;var kP=(e,n,t)=>n in e?_P(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var Yn=(e,n,t)=>kP(e,typeof n!="symbol"?n+"":n,t);function EP(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const s=Object.getOwnPropertyDescriptor(r,a);s&&Object.defineProperty(e,a,s.get?s:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();var Vc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var iv={exports:{}},Tm={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PS;function TP(){if(PS)return Tm;PS=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function t(r,a,s){var l=null;if(s!==void 0&&(l=""+s),a.key!==void 0&&(l=""+a.key),"key"in a){s={};for(var f in a)f!=="key"&&(s[f]=a[f])}else s=a;return a=s.ref,{$$typeof:e,type:r,key:l,ref:a!==void 0?a:null,props:s}}return Tm.Fragment=n,Tm.jsx=t,Tm.jsxs=t,Tm}var DS;function AP(){return DS||(DS=1,iv.exports=TP()),iv.exports}var i=AP(),av={exports:{}},Vt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IS;function PP(){if(IS)return Vt;IS=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;function b(A){return A===null||typeof A!="object"?null:(A=g&&A[g]||A["@@iterator"],typeof A=="function"?A:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,k={};function E(A,se,ue){this.props=A,this.context=se,this.refs=k,this.updater=ue||v}E.prototype.isReactComponent={},E.prototype.setState=function(A,se){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,se,"setState")},E.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function T(){}T.prototype=E.prototype;function I(A,se,ue){this.props=A,this.context=se,this.refs=k,this.updater=ue||v}var D=I.prototype=new T;D.constructor=I,S(D,E.prototype),D.isPureReactComponent=!0;var q=Array.isArray,R={H:null,A:null,T:null,S:null,V:null},F=Object.prototype.hasOwnProperty;function U(A,se,ue,M,pe,be){return ue=be.ref,{$$typeof:e,type:A,key:se,ref:ue!==void 0?ue:null,props:be}}function z(A,se){return U(A.type,se,void 0,void 0,void 0,A.props)}function V(A){return typeof A=="object"&&A!==null&&A.$$typeof===e}function L(A){var se={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(ue){return se[ue]})}var $=/\/+/g;function H(A,se){return typeof A=="object"&&A!==null&&A.key!=null?L(""+A.key):se.toString(36)}function ee(){}function te(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(ee,ee):(A.status="pending",A.then(function(se){A.status==="pending"&&(A.status="fulfilled",A.value=se)},function(se){A.status==="pending"&&(A.status="rejected",A.reason=se)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function ae(A,se,ue,M,pe){var be=typeof A;(be==="undefined"||be==="boolean")&&(A=null);var fe=!1;if(A===null)fe=!0;else switch(be){case"bigint":case"string":case"number":fe=!0;break;case"object":switch(A.$$typeof){case e:case n:fe=!0;break;case h:return fe=A._init,ae(fe(A._payload),se,ue,M,pe)}}if(fe)return pe=pe(A),fe=M===""?"."+H(A,0):M,q(pe)?(ue="",fe!=null&&(ue=fe.replace($,"$&/")+"/"),ae(pe,se,ue,"",function(Me){return Me})):pe!=null&&(V(pe)&&(pe=z(pe,ue+(pe.key==null||A&&A.key===pe.key?"":(""+pe.key).replace($,"$&/")+"/")+fe)),se.push(pe)),1;fe=0;var Pe=M===""?".":M+":";if(q(A))for(var de=0;de<A.length;de++)M=A[de],be=Pe+H(M,de),fe+=ae(M,se,ue,be,pe);else if(de=b(A),typeof de=="function")for(A=de.call(A),de=0;!(M=A.next()).done;)M=M.value,be=Pe+H(M,de++),fe+=ae(M,se,ue,be,pe);else if(be==="object"){if(typeof A.then=="function")return ae(te(A),se,ue,M,pe);throw se=String(A),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return fe}function Z(A,se,ue){if(A==null)return A;var M=[],pe=0;return ae(A,M,"","",function(be){return se.call(ue,be,pe++)}),M}function B(A){if(A._status===-1){var se=A._result;se=se(),se.then(function(ue){(A._status===0||A._status===-1)&&(A._status=1,A._result=ue)},function(ue){(A._status===0||A._status===-1)&&(A._status=2,A._result=ue)}),A._status===-1&&(A._status=0,A._result=se)}if(A._status===1)return A._result.default;throw A._result}var K=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)};function oe(){}return Vt.Children={map:Z,forEach:function(A,se,ue){Z(A,function(){se.apply(this,arguments)},ue)},count:function(A){var se=0;return Z(A,function(){se++}),se},toArray:function(A){return Z(A,function(se){return se})||[]},only:function(A){if(!V(A))throw Error("React.Children.only expected to receive a single React element child.");return A}},Vt.Component=E,Vt.Fragment=t,Vt.Profiler=a,Vt.PureComponent=I,Vt.StrictMode=r,Vt.Suspense=d,Vt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Vt.__COMPILER_RUNTIME={__proto__:null,c:function(A){return R.H.useMemoCache(A)}},Vt.cache=function(A){return function(){return A.apply(null,arguments)}},Vt.cloneElement=function(A,se,ue){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var M=S({},A.props),pe=A.key,be=void 0;if(se!=null)for(fe in se.ref!==void 0&&(be=void 0),se.key!==void 0&&(pe=""+se.key),se)!F.call(se,fe)||fe==="key"||fe==="__self"||fe==="__source"||fe==="ref"&&se.ref===void 0||(M[fe]=se[fe]);var fe=arguments.length-2;if(fe===1)M.children=ue;else if(1<fe){for(var Pe=Array(fe),de=0;de<fe;de++)Pe[de]=arguments[de+2];M.children=Pe}return U(A.type,pe,void 0,void 0,be,M)},Vt.createContext=function(A){return A={$$typeof:l,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:s,_context:A},A},Vt.createElement=function(A,se,ue){var M,pe={},be=null;if(se!=null)for(M in se.key!==void 0&&(be=""+se.key),se)F.call(se,M)&&M!=="key"&&M!=="__self"&&M!=="__source"&&(pe[M]=se[M]);var fe=arguments.length-2;if(fe===1)pe.children=ue;else if(1<fe){for(var Pe=Array(fe),de=0;de<fe;de++)Pe[de]=arguments[de+2];pe.children=Pe}if(A&&A.defaultProps)for(M in fe=A.defaultProps,fe)pe[M]===void 0&&(pe[M]=fe[M]);return U(A,be,void 0,void 0,null,pe)},Vt.createRef=function(){return{current:null}},Vt.forwardRef=function(A){return{$$typeof:f,render:A}},Vt.isValidElement=V,Vt.lazy=function(A){return{$$typeof:h,_payload:{_status:-1,_result:A},_init:B}},Vt.memo=function(A,se){return{$$typeof:u,type:A,compare:se===void 0?null:se}},Vt.startTransition=function(A){var se=R.T,ue={};R.T=ue;try{var M=A(),pe=R.S;pe!==null&&pe(ue,M),typeof M=="object"&&M!==null&&typeof M.then=="function"&&M.then(oe,K)}catch(be){K(be)}finally{R.T=se}},Vt.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Vt.use=function(A){return R.H.use(A)},Vt.useActionState=function(A,se,ue){return R.H.useActionState(A,se,ue)},Vt.useCallback=function(A,se){return R.H.useCallback(A,se)},Vt.useContext=function(A){return R.H.useContext(A)},Vt.useDebugValue=function(){},Vt.useDeferredValue=function(A,se){return R.H.useDeferredValue(A,se)},Vt.useEffect=function(A,se,ue){var M=R.H;if(typeof ue=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return M.useEffect(A,se)},Vt.useId=function(){return R.H.useId()},Vt.useImperativeHandle=function(A,se,ue){return R.H.useImperativeHandle(A,se,ue)},Vt.useInsertionEffect=function(A,se){return R.H.useInsertionEffect(A,se)},Vt.useLayoutEffect=function(A,se){return R.H.useLayoutEffect(A,se)},Vt.useMemo=function(A,se){return R.H.useMemo(A,se)},Vt.useOptimistic=function(A,se){return R.H.useOptimistic(A,se)},Vt.useReducer=function(A,se,ue){return R.H.useReducer(A,se,ue)},Vt.useRef=function(A){return R.H.useRef(A)},Vt.useState=function(A){return R.H.useState(A)},Vt.useSyncExternalStore=function(A,se,ue){return R.H.useSyncExternalStore(A,se,ue)},Vt.useTransition=function(){return R.H.useTransition()},Vt.version="19.1.0",Vt}var MS;function Nw(){return MS||(MS=1,av.exports=PP()),av.exports}var w=Nw();const Tn=Bd(w),RS=EP({__proto__:null,default:Tn},[w]);var sv={exports:{}},Am={},ov={exports:{}},lv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OS;function DP(){return OS||(OS=1,function(e){function n(Z,B){var K=Z.length;Z.push(B);e:for(;0<K;){var oe=K-1>>>1,A=Z[oe];if(0<a(A,B))Z[oe]=B,Z[K]=A,K=oe;else break e}}function t(Z){return Z.length===0?null:Z[0]}function r(Z){if(Z.length===0)return null;var B=Z[0],K=Z.pop();if(K!==B){Z[0]=K;e:for(var oe=0,A=Z.length,se=A>>>1;oe<se;){var ue=2*(oe+1)-1,M=Z[ue],pe=ue+1,be=Z[pe];if(0>a(M,K))pe<A&&0>a(be,M)?(Z[oe]=be,Z[pe]=K,oe=pe):(Z[oe]=M,Z[ue]=K,oe=ue);else if(pe<A&&0>a(be,K))Z[oe]=be,Z[pe]=K,oe=pe;else break e}}return B}function a(Z,B){var K=Z.sortIndex-B.sortIndex;return K!==0?K:Z.id-B.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var l=Date,f=l.now();e.unstable_now=function(){return l.now()-f}}var d=[],u=[],h=1,g=null,b=3,v=!1,S=!1,k=!1,E=!1,T=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function q(Z){for(var B=t(u);B!==null;){if(B.callback===null)r(u);else if(B.startTime<=Z)r(u),B.sortIndex=B.expirationTime,n(d,B);else break;B=t(u)}}function R(Z){if(k=!1,q(Z),!S)if(t(d)!==null)S=!0,F||(F=!0,H());else{var B=t(u);B!==null&&ae(R,B.startTime-Z)}}var F=!1,U=-1,z=5,V=-1;function L(){return E?!0:!(e.unstable_now()-V<z)}function $(){if(E=!1,F){var Z=e.unstable_now();V=Z;var B=!0;try{e:{S=!1,k&&(k=!1,I(U),U=-1),v=!0;var K=b;try{t:{for(q(Z),g=t(d);g!==null&&!(g.expirationTime>Z&&L());){var oe=g.callback;if(typeof oe=="function"){g.callback=null,b=g.priorityLevel;var A=oe(g.expirationTime<=Z);if(Z=e.unstable_now(),typeof A=="function"){g.callback=A,q(Z),B=!0;break t}g===t(d)&&r(d),q(Z)}else r(d);g=t(d)}if(g!==null)B=!0;else{var se=t(u);se!==null&&ae(R,se.startTime-Z),B=!1}}break e}finally{g=null,b=K,v=!1}B=void 0}}finally{B?H():F=!1}}}var H;if(typeof D=="function")H=function(){D($)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,te=ee.port2;ee.port1.onmessage=$,H=function(){te.postMessage(null)}}else H=function(){T($,0)};function ae(Z,B){U=T(function(){Z(e.unstable_now())},B)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Z){Z.callback=null},e.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<Z?Math.floor(1e3/Z):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(Z){switch(b){case 1:case 2:case 3:var B=3;break;default:B=b}var K=b;b=B;try{return Z()}finally{b=K}},e.unstable_requestPaint=function(){E=!0},e.unstable_runWithPriority=function(Z,B){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var K=b;b=Z;try{return B()}finally{b=K}},e.unstable_scheduleCallback=function(Z,B,K){var oe=e.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?oe+K:oe):K=oe,Z){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=K+A,Z={id:h++,callback:B,priorityLevel:Z,startTime:K,expirationTime:A,sortIndex:-1},K>oe?(Z.sortIndex=K,n(u,Z),t(d)===null&&Z===t(u)&&(k?(I(U),U=-1):k=!0,ae(R,K-oe))):(Z.sortIndex=A,n(d,Z),S||v||(S=!0,F||(F=!0,H()))),Z},e.unstable_shouldYield=L,e.unstable_wrapCallback=function(Z){var B=b;return function(){var K=b;b=B;try{return Z.apply(this,arguments)}finally{b=K}}}}(lv)),lv}var LS;function IP(){return LS||(LS=1,ov.exports=DP()),ov.exports}var cv={exports:{}},wi={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FS;function MP(){if(FS)return wi;FS=1;var e=Nw();function n(d){var u="https://react.dev/errors/"+d;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)u+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+d+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(n(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function s(d,u,h){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:g==null?null:""+g,children:d,containerInfo:u,implementation:h}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(d,u){if(d==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return wi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,wi.createPortal=function(d,u){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(n(299));return s(d,u,null,h)},wi.flushSync=function(d){var u=l.T,h=r.p;try{if(l.T=null,r.p=2,d)return d()}finally{l.T=u,r.p=h,r.d.f()}},wi.preconnect=function(d,u){typeof d=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,r.d.C(d,u))},wi.prefetchDNS=function(d){typeof d=="string"&&r.d.D(d)},wi.preinit=function(d,u){if(typeof d=="string"&&u&&typeof u.as=="string"){var h=u.as,g=f(h,u.crossOrigin),b=typeof u.integrity=="string"?u.integrity:void 0,v=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;h==="style"?r.d.S(d,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:g,integrity:b,fetchPriority:v}):h==="script"&&r.d.X(d,{crossOrigin:g,integrity:b,fetchPriority:v,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},wi.preinitModule=function(d,u){if(typeof d=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var h=f(u.as,u.crossOrigin);r.d.M(d,{crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&r.d.M(d)},wi.preload=function(d,u){if(typeof d=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var h=u.as,g=f(h,u.crossOrigin);r.d.L(d,h,{crossOrigin:g,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},wi.preloadModule=function(d,u){if(typeof d=="string")if(u){var h=f(u.as,u.crossOrigin);r.d.m(d,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else r.d.m(d)},wi.requestFormReset=function(d){r.d.r(d)},wi.unstable_batchedUpdates=function(d,u){return d(u)},wi.useFormState=function(d,u,h){return l.H.useFormState(d,u,h)},wi.useFormStatus=function(){return l.H.useHostTransitionStatus()},wi.version="19.1.0",wi}var $S;function rk(){if($S)return cv.exports;$S=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),cv.exports=MP(),cv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zS;function RP(){if(zS)return Am;zS=1;var e=IP(),n=Nw(),t=rk();function r(o){var c="https://react.dev/errors/"+o;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)c+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+o+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function s(o){var c=o,p=o;if(o.alternate)for(;c.return;)c=c.return;else{o=c;do c=o,(c.flags&4098)!==0&&(p=c.return),o=c.return;while(o)}return c.tag===3?p:null}function l(o){if(o.tag===13){var c=o.memoizedState;if(c===null&&(o=o.alternate,o!==null&&(c=o.memoizedState)),c!==null)return c.dehydrated}return null}function f(o){if(s(o)!==o)throw Error(r(188))}function d(o){var c=o.alternate;if(!c){if(c=s(o),c===null)throw Error(r(188));return c!==o?null:o}for(var p=o,x=c;;){var N=p.return;if(N===null)break;var P=N.alternate;if(P===null){if(x=N.return,x!==null){p=x;continue}break}if(N.child===P.child){for(P=N.child;P;){if(P===p)return f(N),o;if(P===x)return f(N),c;P=P.sibling}throw Error(r(188))}if(p.return!==x.return)p=N,x=P;else{for(var G=!1,re=N.child;re;){if(re===p){G=!0,p=N,x=P;break}if(re===x){G=!0,x=N,p=P;break}re=re.sibling}if(!G){for(re=P.child;re;){if(re===p){G=!0,p=P,x=N;break}if(re===x){G=!0,x=P,p=N;break}re=re.sibling}if(!G)throw Error(r(189))}}if(p.alternate!==x)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?o:c}function u(o){var c=o.tag;if(c===5||c===26||c===27||c===6)return o;for(o=o.child;o!==null;){if(c=u(o),c!==null)return c;o=o.sibling}return null}var h=Object.assign,g=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),I=Symbol.for("react.consumer"),D=Symbol.for("react.context"),q=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),V=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),$=Symbol.iterator;function H(o){return o===null||typeof o!="object"?null:(o=$&&o[$]||o["@@iterator"],typeof o=="function"?o:null)}var ee=Symbol.for("react.client.reference");function te(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===ee?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case S:return"Fragment";case E:return"Profiler";case k:return"StrictMode";case R:return"Suspense";case F:return"SuspenseList";case V:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case v:return"Portal";case D:return(o.displayName||"Context")+".Provider";case I:return(o._context.displayName||"Context")+".Consumer";case q:var c=o.render;return o=o.displayName,o||(o=c.displayName||c.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case U:return c=o.displayName||null,c!==null?c:te(o.type)||"Memo";case z:c=o._payload,o=o._init;try{return te(o(c))}catch{}}return null}var ae=Array.isArray,Z=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,B=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K={pending:!1,data:null,method:null,action:null},oe=[],A=-1;function se(o){return{current:o}}function ue(o){0>A||(o.current=oe[A],oe[A]=null,A--)}function M(o,c){A++,oe[A]=o.current,o.current=c}var pe=se(null),be=se(null),fe=se(null),Pe=se(null);function de(o,c){switch(M(fe,c),M(be,o),M(pe,null),c.nodeType){case 9:case 11:o=(o=c.documentElement)&&(o=o.namespaceURI)?Gn(o):0;break;default:if(o=c.tagName,c=c.namespaceURI)c=Gn(c),o=er(c,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}ue(pe),M(pe,o)}function Me(){ue(pe),ue(be),ue(fe)}function Ze(o){o.memoizedState!==null&&M(Pe,o);var c=pe.current,p=er(c,o.type);c!==p&&(M(be,o),M(pe,p))}function Fe(o){be.current===o&&(ue(pe),ue(be)),Pe.current===o&&(ue(Pe),Oc._currentValue=K)}var Ce=Object.prototype.hasOwnProperty,Re=e.unstable_scheduleCallback,xe=e.unstable_cancelCallback,Ie=e.unstable_shouldYield,Ge=e.unstable_requestPaint,ze=e.unstable_now,nt=e.unstable_getCurrentPriorityLevel,jt=e.unstable_ImmediatePriority,xt=e.unstable_UserBlockingPriority,ve=e.unstable_NormalPriority,qe=e.unstable_LowPriority,Qe=e.unstable_IdlePriority,Be=e.log,J=e.unstable_setDisableYieldValue,Y=null,X=null;function Ne(o){if(typeof Be=="function"&&J(o),X&&typeof X.setStrictMode=="function")try{X.setStrictMode(Y,o)}catch{}}var ke=Math.clz32?Math.clz32:mt,Ue=Math.log,it=Math.LN2;function mt(o){return o>>>=0,o===0?32:31-(Ue(o)/it|0)|0}var ht=256,Ve=4194304;function tt(o){var c=o&42;if(c!==0)return c;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function Le(o,c,p){var x=o.pendingLanes;if(x===0)return 0;var N=0,P=o.suspendedLanes,G=o.pingedLanes;o=o.warmLanes;var re=x&134217727;return re!==0?(x=re&~P,x!==0?N=tt(x):(G&=re,G!==0?N=tt(G):p||(p=re&~o,p!==0&&(N=tt(p))))):(re=x&~P,re!==0?N=tt(re):G!==0?N=tt(G):p||(p=x&~o,p!==0&&(N=tt(p)))),N===0?0:c!==0&&c!==N&&(c&P)===0&&(P=N&-N,p=c&-c,P>=p||P===32&&(p&4194048)!==0)?c:N}function ot(o,c){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&c)===0}function et(o,c){switch(o){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bt(){var o=ht;return ht<<=1,(ht&4194048)===0&&(ht=256),o}function Un(){var o=Ve;return Ve<<=1,(Ve&62914560)===0&&(Ve=4194304),o}function Ln(o){for(var c=[],p=0;31>p;p++)c.push(o);return c}function jn(o,c){o.pendingLanes|=c,c!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function gn(o,c,p,x,N,P){var G=o.pendingLanes;o.pendingLanes=p,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=p,o.entangledLanes&=p,o.errorRecoveryDisabledLanes&=p,o.shellSuspendCounter=0;var re=o.entanglements,ye=o.expirationTimes,Ae=o.hiddenUpdates;for(p=G&~p;0<p;){var He=31-ke(p),Ke=1<<He;re[He]=0,ye[He]=-1;var Oe=Ae[He];if(Oe!==null)for(Ae[He]=null,He=0;He<Oe.length;He++){var De=Oe[He];De!==null&&(De.lane&=-536870913)}p&=~Ke}x!==0&&dn(o,x,0),P!==0&&N===0&&o.tag!==0&&(o.suspendedLanes|=P&~(G&~c))}function dn(o,c,p){o.pendingLanes|=c,o.suspendedLanes&=~c;var x=31-ke(c);o.entangledLanes|=c,o.entanglements[x]=o.entanglements[x]|1073741824|p&4194090}function Nr(o,c){var p=o.entangledLanes|=c;for(o=o.entanglements;p;){var x=31-ke(p),N=1<<x;N&c|o[x]&c&&(o[x]|=c),p&=~N}}function Ur(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function ri(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function fa(){var o=B.p;return o!==0?o:(o=window.event,o===void 0?32:px(o.type))}function Ti(o,c){var p=B.p;try{return B.p=o,c()}finally{B.p=p}}var nr=Math.random().toString(36).slice(2),Xn="__reactFiber$"+nr,Fn="__reactProps$"+nr,za="__reactContainer$"+nr,ds="__reactEvents$"+nr,ep="__reactListeners$"+nr,tp="__reactHandles$"+nr,Vd="__reactResources$"+nr,fs="__reactMarker$"+nr;function nu(o){delete o[Xn],delete o[Fn],delete o[ds],delete o[ep],delete o[tp]}function Ys(o){var c=o[Xn];if(c)return c;for(var p=o.parentNode;p;){if(c=p[za]||p[Xn]){if(p=c.alternate,c.child!==null||p!==null&&p.child!==null)for(o=nx(o);o!==null;){if(p=o[Xn])return p;o=nx(o)}return c}o=p,p=o.parentNode}return null}function Ws(o){if(o=o[Xn]||o[za]){var c=o.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return o}return null}function Ba(o){var c=o.tag;if(c===5||c===26||c===27||c===6)return o.stateNode;throw Error(r(33))}function Qs(o){var c=o[Vd];return c||(c=o[Vd]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function cr(o){o[fs]=!0}var Hd=new Set,Bl={};function hs(o,c){Ua(o,c),Ua(o+"Capture",c)}function Ua(o,c){for(Bl[o]=c,o=0;o<c.length;o++)Hd.add(c[o])}var qr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Js={},qa={};function Gd(o){return Ce.call(qa,o)?!0:Ce.call(Js,o)?!1:qr.test(o)?qa[o]=!0:(Js[o]=!0,!1)}function Ho(o,c,p){if(Gd(c))if(p===null)o.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":o.removeAttribute(c);return;case"boolean":var x=c.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){o.removeAttribute(c);return}}o.setAttribute(c,""+p)}}function Go(o,c,p){if(p===null)o.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(c);return}o.setAttribute(c,""+p)}}function ii(o,c,p,x){if(x===null)o.removeAttribute(p);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(p);return}o.setAttributeNS(c,p,""+x)}}var Yo,Ul;function ha(o){if(Yo===void 0)try{throw Error()}catch(p){var c=p.stack.trim().match(/\n( *(at )?)/);Yo=c&&c[1]||"",Ul=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Yo+o+Ul}var ru=!1;function iu(o,c){if(!o||ru)return"";ru=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(c){var Ke=function(){throw Error()};if(Object.defineProperty(Ke.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ke,[])}catch(De){var Oe=De}Reflect.construct(o,[],Ke)}else{try{Ke.call()}catch(De){Oe=De}o.call(Ke.prototype)}}else{try{throw Error()}catch(De){Oe=De}(Ke=o())&&typeof Ke.catch=="function"&&Ke.catch(function(){})}}catch(De){if(De&&Oe&&typeof De.stack=="string")return[De.stack,Oe.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var P=x.DetermineComponentFrameRoot(),G=P[0],re=P[1];if(G&&re){var ye=G.split(`
`),Ae=re.split(`
`);for(N=x=0;x<ye.length&&!ye[x].includes("DetermineComponentFrameRoot");)x++;for(;N<Ae.length&&!Ae[N].includes("DetermineComponentFrameRoot");)N++;if(x===ye.length||N===Ae.length)for(x=ye.length-1,N=Ae.length-1;1<=x&&0<=N&&ye[x]!==Ae[N];)N--;for(;1<=x&&0<=N;x--,N--)if(ye[x]!==Ae[N]){if(x!==1||N!==1)do if(x--,N--,0>N||ye[x]!==Ae[N]){var He=`
`+ye[x].replace(" at new "," at ");return o.displayName&&He.includes("<anonymous>")&&(He=He.replace("<anonymous>",o.displayName)),He}while(1<=x&&0<=N);break}}}finally{ru=!1,Error.prepareStackTrace=p}return(p=o?o.displayName||o.name:"")?ha(p):""}function Yd(o){switch(o.tag){case 26:case 27:case 5:return ha(o.type);case 16:return ha("Lazy");case 13:return ha("Suspense");case 19:return ha("SuspenseList");case 0:case 15:return iu(o.type,!1);case 11:return iu(o.type.render,!1);case 1:return iu(o.type,!0);case 31:return ha("Activity");default:return""}}function au(o){try{var c="";do c+=Yd(o),o=o.return;while(o);return c}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function Rr(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function Wo(o){var c=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function ql(o){var c=Wo(o)?"checked":"value",p=Object.getOwnPropertyDescriptor(o.constructor.prototype,c),x=""+o[c];if(!o.hasOwnProperty(c)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var N=p.get,P=p.set;return Object.defineProperty(o,c,{configurable:!0,get:function(){return N.call(this)},set:function(G){x=""+G,P.call(this,G)}}),Object.defineProperty(o,c,{enumerable:p.enumerable}),{getValue:function(){return x},setValue:function(G){x=""+G},stopTracking:function(){o._valueTracker=null,delete o[c]}}}}function Qo(o){o._valueTracker||(o._valueTracker=ql(o))}function Vl(o){if(!o)return!1;var c=o._valueTracker;if(!c)return!0;var p=c.getValue(),x="";return o&&(x=Wo(o)?o.checked?"true":"false":o.value),o=x,o!==p?(c.setValue(o),!0):!1}function Va(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var su=/[\n"\\]/g;function Vr(o){return o.replace(su,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function Jo(o,c,p,x,N,P,G,re){o.name="",G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"?o.type=G:o.removeAttribute("type"),c!=null?G==="number"?(c===0&&o.value===""||o.value!=c)&&(o.value=""+Rr(c)):o.value!==""+Rr(c)&&(o.value=""+Rr(c)):G!=="submit"&&G!=="reset"||o.removeAttribute("value"),c!=null?Ks(o,G,Rr(c)):p!=null?Ks(o,G,Rr(p)):x!=null&&o.removeAttribute("value"),N==null&&P!=null&&(o.defaultChecked=!!P),N!=null&&(o.checked=N&&typeof N!="function"&&typeof N!="symbol"),re!=null&&typeof re!="function"&&typeof re!="symbol"&&typeof re!="boolean"?o.name=""+Rr(re):o.removeAttribute("name")}function Hl(o,c,p,x,N,P,G,re){if(P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"&&(o.type=P),c!=null||p!=null){if(!(P!=="submit"&&P!=="reset"||c!=null))return;p=p!=null?""+Rr(p):"",c=c!=null?""+Rr(c):p,re||c===o.value||(o.value=c),o.defaultValue=c}x=x??N,x=typeof x!="function"&&typeof x!="symbol"&&!!x,o.checked=re?o.checked:!!x,o.defaultChecked=!!x,G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"&&(o.name=G)}function Ks(o,c,p){c==="number"&&Va(o.ownerDocument)===o||o.defaultValue===""+p||(o.defaultValue=""+p)}function pa(o,c,p,x){if(o=o.options,c){c={};for(var N=0;N<p.length;N++)c["$"+p[N]]=!0;for(p=0;p<o.length;p++)N=c.hasOwnProperty("$"+o[p].value),o[p].selected!==N&&(o[p].selected=N),N&&x&&(o[p].defaultSelected=!0)}else{for(p=""+Rr(p),c=null,N=0;N<o.length;N++){if(o[N].value===p){o[N].selected=!0,x&&(o[N].defaultSelected=!0);return}c!==null||o[N].disabled||(c=o[N])}c!==null&&(c.selected=!0)}}function Xs(o,c,p){if(c!=null&&(c=""+Rr(c),c!==o.value&&(o.value=c),p==null)){o.defaultValue!==c&&(o.defaultValue=c);return}o.defaultValue=p!=null?""+Rr(p):""}function ps(o,c,p,x){if(c==null){if(x!=null){if(p!=null)throw Error(r(92));if(ae(x)){if(1<x.length)throw Error(r(93));x=x[0]}p=x}p==null&&(p=""),c=p}p=Rr(c),o.defaultValue=p,x=o.textContent,x===p&&x!==""&&x!==null&&(o.value=x)}function ma(o,c){if(c){var p=o.firstChild;if(p&&p===o.lastChild&&p.nodeType===3){p.nodeValue=c;return}}o.textContent=c}var ga=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ko(o,c,p){var x=c.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?x?o.setProperty(c,""):c==="float"?o.cssFloat="":o[c]="":x?o.setProperty(c,p):typeof p!="number"||p===0||ga.has(c)?c==="float"?o.cssFloat=p:o[c]=(""+p).trim():o[c]=p+"px"}function Xo(o,c,p){if(c!=null&&typeof c!="object")throw Error(r(62));if(o=o.style,p!=null){for(var x in p)!p.hasOwnProperty(x)||c!=null&&c.hasOwnProperty(x)||(x.indexOf("--")===0?o.setProperty(x,""):x==="float"?o.cssFloat="":o[x]="");for(var N in c)x=c[N],c.hasOwnProperty(N)&&p[N]!==x&&Ko(o,N,x)}else for(var P in c)c.hasOwnProperty(P)&&Ko(o,P,c[P])}function Zo(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gl=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Yl=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ms(o){return Yl.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}var Zs=null;function el(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Hr=null,Ha=null;function Wl(o){var c=Ws(o);if(c&&(o=c.stateNode)){var p=o[Fn]||null;e:switch(o=c.stateNode,c.type){case"input":if(Jo(o,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),c=p.name,p.type==="radio"&&c!=null){for(p=o;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+Vr(""+c)+'"][type="radio"]'),c=0;c<p.length;c++){var x=p[c];if(x!==o&&x.form===o.form){var N=x[Fn]||null;if(!N)throw Error(r(90));Jo(x,N.value,N.defaultValue,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name)}}for(c=0;c<p.length;c++)x=p[c],x.form===o.form&&Vl(x)}break e;case"textarea":Xs(o,p.value,p.defaultValue);break e;case"select":c=p.value,c!=null&&pa(o,!!p.multiple,c,!1)}}}var ya=!1;function eo(o,c,p){if(ya)return o(c,p);ya=!0;try{var x=o(c);return x}finally{if(ya=!1,(Hr!==null||Ha!==null)&&(Yf(),Hr&&(c=Hr,o=Ha,Ha=Hr=null,Wl(c),o)))for(c=0;c<o.length;c++)Wl(o[c])}}function tl(o,c){var p=o.stateNode;if(p===null)return null;var x=p[Fn]||null;if(x===null)return null;p=x[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(o=o.type,x=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!x;break e;default:o=!1}if(o)return null;if(p&&typeof p!="function")throw Error(r(231,c,typeof p));return p}var ai=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),to=!1;if(ai)try{var gs={};Object.defineProperty(gs,"passive",{get:function(){to=!0}}),window.addEventListener("test",gs,gs),window.removeEventListener("test",gs,gs)}catch{to=!1}var zi=null,Ql=null,ys=null;function Wd(){if(ys)return ys;var o,c=Ql,p=c.length,x,N="value"in zi?zi.value:zi.textContent,P=N.length;for(o=0;o<p&&c[o]===N[o];o++);var G=p-o;for(x=1;x<=G&&c[p-x]===N[P-x];x++);return ys=N.slice(o,1<x?1-x:void 0)}function yn(o){var c=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&c===13&&(o=13)):o=c,o===10&&(o=13),32<=o||o===13?o:0}function ln(){return!0}function ou(){return!1}function Pr(o){function c(p,x,N,P,G){this._reactName=p,this._targetInst=N,this.type=x,this.nativeEvent=P,this.target=G,this.currentTarget=null;for(var re in o)o.hasOwnProperty(re)&&(p=o[re],this[re]=p?p(P):P[re]);return this.isDefaultPrevented=(P.defaultPrevented!=null?P.defaultPrevented:P.returnValue===!1)?ln:ou,this.isPropagationStopped=ou,this}return h(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=ln)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=ln)},persist:function(){},isPersistent:ln}),c}var Xt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},no=Pr(Xt),Ga=h({},Xt,{view:0,detail:0}),lu=Pr(Ga),Ya,xs,Zn,bs=h({},Ga,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bi,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Zn&&(Zn&&o.type==="mousemove"?(Ya=o.screenX-Zn.screenX,xs=o.screenY-Zn.screenY):xs=Ya=0,Zn=o),Ya)},movementY:function(o){return"movementY"in o?o.movementY:xs}}),si=Pr(bs),cu=h({},bs,{dataTransfer:0}),nl=Pr(cu),Dr=h({},Ga,{relatedTarget:0}),Wa=Pr(Dr),uu=h({},Xt,{animationName:0,elapsedTime:0,pseudoElement:0}),Jl=Pr(uu),vs=h({},Xt,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),Qd=Pr(vs),du=h({},Xt,{data:0}),ur=Pr(du),Kl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Or={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},np={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rl(o){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(o):(o=np[o])?!!c[o]:!1}function Bi(){return rl}var Xl=h({},Ga,{key:function(o){if(o.key){var c=Kl[o.key]||o.key;if(c!=="Unidentified")return c}return o.type==="keypress"?(o=yn(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?Or[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bi,charCode:function(o){return o.type==="keypress"?yn(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?yn(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),fu=Pr(Xl),Mn=h({},bs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xa=Pr(Mn),hu=h({},Ga,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bi}),rp=Pr(hu),pu=h({},Xt,{propertyName:0,elapsedTime:0,pseudoElement:0}),ip=Pr(pu),ap=h({},bs,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),sp=Pr(ap),Jd=h({},Xt,{newState:0,oldState:0}),ws=Pr(Jd),ro=[9,13,27,32],Ui=ai&&"CompositionEvent"in window,Gr=null;ai&&"documentMode"in document&&(Gr=document.documentMode);var qi=ai&&"TextEvent"in window&&!Gr,il=ai&&(!Ui||Gr&&8<Gr&&11>=Gr),al=" ",Zl=!1;function mu(o,c){switch(o){case"keyup":return ro.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function io(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var ba=!1;function Kd(o,c){switch(o){case"compositionend":return io(c);case"keypress":return c.which!==32?null:(Zl=!0,al);case"textInput":return o=c.data,o===al&&Zl?null:o;default:return null}}function Xd(o,c){if(ba)return o==="compositionend"||!Ui&&mu(o,c)?(o=Wd(),ys=Ql=zi=null,ba=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return il&&c.locale!=="ko"?null:c.data;default:return null}}var Lr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ec(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c==="input"?!!Lr[o.type]:c==="textarea"}function ao(o,c,p,x){Hr?Ha?Ha.push(x):Ha=[x]:Hr=x,c=eh(c,"onChange"),0<c.length&&(p=new no("onChange","change",null,p,x),o.push({event:p,listeners:c}))}var so=null,oo=null;function op(o){Wy(o,0)}function tc(o){var c=Ba(o);if(Vl(c))return o}function Ss(o,c){if(o==="change")return c}var Zd=!1;if(ai){var sl;if(ai){var Qa="oninput"in document;if(!Qa){var ef=document.createElement("div");ef.setAttribute("oninput","return;"),Qa=typeof ef.oninput=="function"}sl=Qa}else sl=!1;Zd=sl&&(!document.documentMode||9<document.documentMode)}function tf(){so&&(so.detachEvent("onpropertychange",oi),oo=so=null)}function oi(o){if(o.propertyName==="value"&&tc(oo)){var c=[];ao(c,oo,o,el(o)),eo(op,c)}}function nf(o,c,p){o==="focusin"?(tf(),so=c,oo=p,so.attachEvent("onpropertychange",oi)):o==="focusout"&&tf()}function va(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return tc(oo)}function nc(o,c){if(o==="click")return tc(c)}function lp(o,c){if(o==="input"||o==="change")return tc(c)}function cp(o,c){return o===c&&(o!==0||1/o===1/c)||o!==o&&c!==c}var Yr=typeof Object.is=="function"?Object.is:cp;function Vi(o,c){if(Yr(o,c))return!0;if(typeof o!="object"||o===null||typeof c!="object"||c===null)return!1;var p=Object.keys(o),x=Object.keys(c);if(p.length!==x.length)return!1;for(x=0;x<p.length;x++){var N=p[x];if(!Ce.call(c,N)||!Yr(o[N],c[N]))return!1}return!0}function li(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function gu(o,c){var p=li(o);o=0;for(var x;p;){if(p.nodeType===3){if(x=o+p.textContent.length,o<=c&&x>=c)return{node:p,offset:c-o};o=x}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=li(p)}}function rf(o,c){return o&&c?o===c?!0:o&&o.nodeType===3?!1:c&&c.nodeType===3?rf(o,c.parentNode):"contains"in o?o.contains(c):o.compareDocumentPosition?!!(o.compareDocumentPosition(c)&16):!1:!1}function af(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var c=Va(o.document);c instanceof o.HTMLIFrameElement;){try{var p=typeof c.contentWindow.location.href=="string"}catch{p=!1}if(p)o=c.contentWindow;else break;c=Va(o.document)}return c}function rc(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c&&(c==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||c==="textarea"||o.contentEditable==="true")}var sf=ai&&"documentMode"in document&&11>=document.documentMode,Ns=null,he=null,Q=null,ie=!1;function ce(o,c,p){var x=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;ie||Ns==null||Ns!==Va(x)||(x=Ns,"selectionStart"in x&&rc(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Q&&Vi(Q,x)||(Q=x,x=eh(he,"onSelect"),0<x.length&&(c=new no("onSelect","select",null,c,p),o.push({event:c,listeners:x}),c.target=Ns)))}function Ee(o,c){var p={};return p[o.toLowerCase()]=c.toLowerCase(),p["Webkit"+o]="webkit"+c,p["Moz"+o]="moz"+c,p}var We={animationend:Ee("Animation","AnimationEnd"),animationiteration:Ee("Animation","AnimationIteration"),animationstart:Ee("Animation","AnimationStart"),transitionrun:Ee("Transition","TransitionRun"),transitionstart:Ee("Transition","TransitionStart"),transitioncancel:Ee("Transition","TransitionCancel"),transitionend:Ee("Transition","TransitionEnd")},lt={},ct={};ai&&(ct=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function At(o){if(lt[o])return lt[o];if(!We[o])return o;var c=We[o],p;for(p in c)if(c.hasOwnProperty(p)&&p in ct)return lt[o]=c[p];return o}var ci=At("animationend"),of=At("animationiteration"),Ai=At("animationstart"),lf=At("transitionrun"),h0=At("transitionstart"),ic=At("transitioncancel"),yu=At("transitionend"),xu=new Map,hn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");hn.push("scrollEnd");function wa(o,c){xu.set(o,c),hs(c,[o])}var up=new WeakMap;function Wr(o,c){if(typeof o=="object"&&o!==null){var p=up.get(o);return p!==void 0?p:(c={value:o,source:c,stack:au(c)},up.set(o,c),c)}return{value:o,source:c,stack:au(c)}}var Hi=[],ac=0,dp=0;function ol(){for(var o=ac,c=dp=ac=0;c<o;){var p=Hi[c];Hi[c++]=null;var x=Hi[c];Hi[c++]=null;var N=Hi[c];Hi[c++]=null;var P=Hi[c];if(Hi[c++]=null,x!==null&&N!==null){var G=x.pending;G===null?N.next=N:(N.next=G.next,G.next=N),x.pending=N}P!==0&&bu(p,N,P)}}function Sa(o,c,p,x){Hi[ac++]=o,Hi[ac++]=c,Hi[ac++]=p,Hi[ac++]=x,dp|=x,o.lanes|=x,o=o.alternate,o!==null&&(o.lanes|=x)}function sc(o,c,p,x){return Sa(o,c,p,x),vu(o)}function ll(o,c){return Sa(o,null,null,c),vu(o)}function bu(o,c,p){o.lanes|=p;var x=o.alternate;x!==null&&(x.lanes|=p);for(var N=!1,P=o.return;P!==null;)P.childLanes|=p,x=P.alternate,x!==null&&(x.childLanes|=p),P.tag===22&&(o=P.stateNode,o===null||o._visibility&1||(N=!0)),o=P,P=P.return;return o.tag===3?(P=o.stateNode,N&&c!==null&&(N=31-ke(p),o=P.hiddenUpdates,x=o[N],x===null?o[N]=[c]:x.push(c),c.lane=p|536870912),P):null}function vu(o){if(50<Ec)throw Ec=0,am=null,Error(r(185));for(var c=o.return;c!==null;)o=c,c=o.return;return o.tag===3?o.stateNode:null}var cl={};function cf(o,c,p,x){this.tag=o,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ui(o,c,p,x){return new cf(o,c,p,x)}function ul(o){return o=o.prototype,!(!o||!o.isReactComponent)}function Qr(o,c){var p=o.alternate;return p===null?(p=ui(o.tag,c,o.key,o.mode),p.elementType=o.elementType,p.type=o.type,p.stateNode=o.stateNode,p.alternate=o,o.alternate=p):(p.pendingProps=c,p.type=o.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=o.flags&65011712,p.childLanes=o.childLanes,p.lanes=o.lanes,p.child=o.child,p.memoizedProps=o.memoizedProps,p.memoizedState=o.memoizedState,p.updateQueue=o.updateQueue,c=o.dependencies,p.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},p.sibling=o.sibling,p.index=o.index,p.ref=o.ref,p.refCleanup=o.refCleanup,p}function wu(o,c){o.flags&=65011714;var p=o.alternate;return p===null?(o.childLanes=0,o.lanes=c,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=p.childLanes,o.lanes=p.lanes,o.child=p.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=p.memoizedProps,o.memoizedState=p.memoizedState,o.updateQueue=p.updateQueue,o.type=p.type,c=p.dependencies,o.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),o}function uf(o,c,p,x,N,P){var G=0;if(x=o,typeof o=="function")ul(o)&&(G=1);else if(typeof o=="string")G=V0(o,p,pe.current)?26:o==="html"||o==="head"||o==="body"?27:5;else e:switch(o){case V:return o=ui(31,p,c,N),o.elementType=V,o.lanes=P,o;case S:return dl(p.children,N,P,c);case k:G=8,N|=24;break;case E:return o=ui(12,p,c,N|2),o.elementType=E,o.lanes=P,o;case R:return o=ui(13,p,c,N),o.elementType=R,o.lanes=P,o;case F:return o=ui(19,p,c,N),o.elementType=F,o.lanes=P,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case T:case D:G=10;break e;case I:G=9;break e;case q:G=11;break e;case U:G=14;break e;case z:G=16,x=null;break e}G=29,p=Error(r(130,o===null?"null":typeof o,"")),x=null}return c=ui(G,p,c,N),c.elementType=o,c.type=x,c.lanes=P,c}function dl(o,c,p,x){return o=ui(7,o,x,c),o.lanes=p,o}function fp(o,c,p){return o=ui(6,o,null,c),o.lanes=p,o}function oc(o,c,p){return c=ui(4,o.children!==null?o.children:[],o.key,c),c.lanes=p,c.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},c}var Cs=[],lo=0,df=null,Su=0,Gi=[],Yi=0,$n=null,qn=1,js="";function fl(o,c){Cs[lo++]=Su,Cs[lo++]=df,df=o,Su=c}function hp(o,c,p){Gi[Yi++]=qn,Gi[Yi++]=js,Gi[Yi++]=$n,$n=o;var x=qn;o=js;var N=32-ke(x)-1;x&=~(1<<N),p+=1;var P=32-ke(c)+N;if(30<P){var G=N-N%5;P=(x&(1<<G)-1).toString(32),x>>=G,N-=G,qn=1<<32-ke(c)+N|p<<N|x,js=P+o}else qn=1<<P|p<<N|x,js=o}function pp(o){o.return!==null&&(fl(o,1),hp(o,1,0))}function Nu(o){for(;o===df;)df=Cs[--lo],Cs[lo]=null,Su=Cs[--lo],Cs[lo]=null;for(;o===$n;)$n=Gi[--Yi],Gi[Yi]=null,js=Gi[--Yi],Gi[Yi]=null,qn=Gi[--Yi],Gi[Yi]=null}var mr=null,Vn=null,Zt=!1,Na=null,di=!1,lc=Error(r(519));function Wi(o){var c=Error(r(418,""));throw co(Wr(c,o)),lc}function Eg(o){var c=o.stateNode,p=o.type,x=o.memoizedProps;switch(c[Xn]=o,c[Fn]=x,p){case"dialog":Kt("cancel",c),Kt("close",c);break;case"iframe":case"object":case"embed":Kt("load",c);break;case"video":case"audio":for(p=0;p<dd.length;p++)Kt(dd[p],c);break;case"source":Kt("error",c);break;case"img":case"image":case"link":Kt("error",c),Kt("load",c);break;case"details":Kt("toggle",c);break;case"input":Kt("invalid",c),Hl(c,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),Qo(c);break;case"select":Kt("invalid",c);break;case"textarea":Kt("invalid",c),ps(c,x.value,x.defaultValue,x.children),Qo(c)}p=x.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||c.textContent===""+p||x.suppressHydrationWarning===!0||Ky(c.textContent,p)?(x.popover!=null&&(Kt("beforetoggle",c),Kt("toggle",c)),x.onScroll!=null&&Kt("scroll",c),x.onScrollEnd!=null&&Kt("scrollend",c),x.onClick!=null&&(c.onclick=th),c=!0):c=!1,c||Wi(o)}function Tg(o){for(mr=o.return;mr;)switch(mr.tag){case 5:case 13:di=!1;return;case 27:case 3:di=!0;return;default:mr=mr.return}}function Cu(o){if(o!==mr)return!1;if(!Zt)return Tg(o),Zt=!0,!1;var c=o.tag,p;if((p=c!==3&&c!==27)&&((p=c===5)&&(p=o.type,p=!(p!=="form"&&p!=="button")||rh(o.type,o.memoizedProps)),p=!p),p&&Vn&&Wi(o),Tg(o),c===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(r(317));e:{for(o=o.nextSibling,c=0;o;){if(o.nodeType===8)if(p=o.data,p==="/$"){if(c===0){Vn=Ta(o.nextSibling);break e}c--}else p!=="$"&&p!=="$!"&&p!=="$?"||c++;o=o.nextSibling}Vn=null}}else c===27?(c=Vn,ea(o.type)?(o=bm,bm=null,Vn=o):Vn=c):Vn=mr?Ta(o.stateNode.nextSibling):null;return!0}function ju(){Vn=mr=null,Zt=!1}function Ag(){var o=Na;return o!==null&&(bi===null?bi=o:bi.push.apply(bi,o),Na=null),o}function co(o){Na===null?Na=[o]:Na.push(o)}var hl=se(null),uo=null,ne=null;function Pi(o,c,p){M(hl,c._currentValue),c._currentValue=p}function Qi(o){o._currentValue=hl.current,ue(hl)}function fi(o,c,p){for(;o!==null;){var x=o.alternate;if((o.childLanes&c)!==c?(o.childLanes|=c,x!==null&&(x.childLanes|=c)):x!==null&&(x.childLanes&c)!==c&&(x.childLanes|=c),o===p)break;o=o.return}}function Yt(o,c,p,x){var N=o.child;for(N!==null&&(N.return=o);N!==null;){var P=N.dependencies;if(P!==null){var G=N.child;P=P.firstContext;e:for(;P!==null;){var re=P;P=N;for(var ye=0;ye<c.length;ye++)if(re.context===c[ye]){P.lanes|=p,re=P.alternate,re!==null&&(re.lanes|=p),fi(P.return,p,o),x||(G=null);break e}P=re.next}}else if(N.tag===18){if(G=N.return,G===null)throw Error(r(341));G.lanes|=p,P=G.alternate,P!==null&&(P.lanes|=p),fi(G,p,o),G=null}else G=N.child;if(G!==null)G.return=N;else for(G=N;G!==null;){if(G===o){G=null;break}if(N=G.sibling,N!==null){N.return=G.return,G=N;break}G=G.return}N=G}}function _u(o,c,p,x){o=null;for(var N=c,P=!1;N!==null;){if(!P){if((N.flags&524288)!==0)P=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var G=N.alternate;if(G===null)throw Error(r(387));if(G=G.memoizedProps,G!==null){var re=N.type;Yr(N.pendingProps.value,G.value)||(o!==null?o.push(re):o=[re])}}else if(N===Pe.current){if(G=N.alternate,G===null)throw Error(r(387));G.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(o!==null?o.push(Oc):o=[Oc])}N=N.return}o!==null&&Yt(c,o,p,x),c.flags|=262144}function ff(o){for(o=o.firstContext;o!==null;){if(!Yr(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function pl(o){uo=o,ne=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function rr(o){return Pg(uo,o)}function hf(o,c){return uo===null&&pl(o),Pg(o,c)}function Pg(o,c){var p=c._currentValue;if(c={context:c,memoizedValue:p,next:null},ne===null){if(o===null)throw Error(r(308));ne=c,o.dependencies={lanes:0,firstContext:c},o.flags|=524288}else ne=ne.next=c;return p}var p0=typeof AbortController<"u"?AbortController:function(){var o=[],c=this.signal={aborted:!1,addEventListener:function(p,x){o.push(x)}};this.abort=function(){c.aborted=!0,o.forEach(function(p){return p()})}},m0=e.unstable_scheduleCallback,g0=e.unstable_NormalPriority,An={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function mp(){return{controller:new p0,data:new Map,refCount:0}}function ku(o){o.refCount--,o.refCount===0&&m0(g0,function(){o.controller.abort()})}var Eu=null,gp=0,cc=0,hi=null;function y0(o,c){if(Eu===null){var p=Eu=[];gp=0,cc=Zf(),hi={status:"pending",value:void 0,then:function(x){p.push(x)}}}return gp++,c.then(Dg,Dg),c}function Dg(){if(--gp===0&&Eu!==null){hi!==null&&(hi.status="fulfilled");var o=Eu;Eu=null,cc=0,hi=null;for(var c=0;c<o.length;c++)(0,o[c])()}}function x0(o,c){var p=[],x={status:"pending",value:null,reason:null,then:function(N){p.push(N)}};return o.then(function(){x.status="fulfilled",x.value=c;for(var N=0;N<p.length;N++)(0,p[N])(c)},function(N){for(x.status="rejected",x.reason=N,N=0;N<p.length;N++)(0,p[N])(void 0)}),x}var Ig=Z.S;Z.S=function(o,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&y0(o,c),Ig!==null&&Ig(o,c)};var ml=se(null);function _s(){var o=ml.current;return o!==null?o:Rn.pooledCache}function pf(o,c){c===null?M(ml,ml.current):M(ml,c.pool)}function Mg(){var o=_s();return o===null?null:{parent:An._currentValue,pool:o}}var Jr=Error(r(460)),Rg=Error(r(474)),mf=Error(r(542)),yp={then:function(){}};function Og(o){return o=o.status,o==="fulfilled"||o==="rejected"}function gf(){}function xp(o,c,p){switch(p=o[p],p===void 0?o.push(c):p!==c&&(c.then(gf,gf),c=p),c.status){case"fulfilled":return c.value;case"rejected":throw o=c.reason,Fg(o),o;default:if(typeof c.status=="string")c.then(gf,gf);else{if(o=Rn,o!==null&&100<o.shellSuspendCounter)throw Error(r(482));o=c,o.status="pending",o.then(function(x){if(c.status==="pending"){var N=c;N.status="fulfilled",N.value=x}},function(x){if(c.status==="pending"){var N=c;N.status="rejected",N.reason=x}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw o=c.reason,Fg(o),o}throw uc=c,Jr}}var uc=null;function Lg(){if(uc===null)throw Error(r(459));var o=uc;return uc=null,o}function Fg(o){if(o===Jr||o===mf)throw Error(r(483))}var Ja=!1;function gl(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function dc(o,c){o=o.updateQueue,c.updateQueue===o&&(c.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function fo(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function ks(o,c,p){var x=o.updateQueue;if(x===null)return null;if(x=x.shared,(vn&2)!==0){var N=x.pending;return N===null?c.next=c:(c.next=N.next,N.next=c),x.pending=c,c=vu(o),bu(o,null,p),c}return Sa(o,x,c,p),vu(o)}function Tu(o,c,p){if(c=c.updateQueue,c!==null&&(c=c.shared,(p&4194048)!==0)){var x=c.lanes;x&=o.pendingLanes,p|=x,c.lanes=p,Nr(o,p)}}function Ca(o,c){var p=o.updateQueue,x=o.alternate;if(x!==null&&(x=x.updateQueue,p===x)){var N=null,P=null;if(p=p.firstBaseUpdate,p!==null){do{var G={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};P===null?N=P=G:P=P.next=G,p=p.next}while(p!==null);P===null?N=P=c:P=P.next=c}else N=P=c;p={baseState:x.baseState,firstBaseUpdate:N,lastBaseUpdate:P,shared:x.shared,callbacks:x.callbacks},o.updateQueue=p;return}o=p.lastBaseUpdate,o===null?p.firstBaseUpdate=c:o.next=c,p.lastBaseUpdate=c}var Au=!1;function ja(){if(Au){var o=hi;if(o!==null)throw o}}function Fr(o,c,p,x){Au=!1;var N=o.updateQueue;Ja=!1;var P=N.firstBaseUpdate,G=N.lastBaseUpdate,re=N.shared.pending;if(re!==null){N.shared.pending=null;var ye=re,Ae=ye.next;ye.next=null,G===null?P=Ae:G.next=Ae,G=ye;var He=o.alternate;He!==null&&(He=He.updateQueue,re=He.lastBaseUpdate,re!==G&&(re===null?He.firstBaseUpdate=Ae:re.next=Ae,He.lastBaseUpdate=ye))}if(P!==null){var Ke=N.baseState;G=0,He=Ae=ye=null,re=P;do{var Oe=re.lane&-536870913,De=Oe!==re.lane;if(De?(on&Oe)===Oe:(x&Oe)===Oe){Oe!==0&&Oe===cc&&(Au=!0),He!==null&&(He=He.next={lane:0,tag:re.tag,payload:re.payload,callback:null,next:null});e:{var _t=o,Nt=re;Oe=c;var kn=p;switch(Nt.tag){case 1:if(_t=Nt.payload,typeof _t=="function"){Ke=_t.call(kn,Ke,Oe);break e}Ke=_t;break e;case 3:_t.flags=_t.flags&-65537|128;case 0:if(_t=Nt.payload,Oe=typeof _t=="function"?_t.call(kn,Ke,Oe):_t,Oe==null)break e;Ke=h({},Ke,Oe);break e;case 2:Ja=!0}}Oe=re.callback,Oe!==null&&(o.flags|=64,De&&(o.flags|=8192),De=N.callbacks,De===null?N.callbacks=[Oe]:De.push(Oe))}else De={lane:Oe,tag:re.tag,payload:re.payload,callback:re.callback,next:null},He===null?(Ae=He=De,ye=Ke):He=He.next=De,G|=Oe;if(re=re.next,re===null){if(re=N.shared.pending,re===null)break;De=re,re=De.next,De.next=null,N.lastBaseUpdate=De,N.shared.pending=null}}while(!0);He===null&&(ye=Ke),N.baseState=ye,N.firstBaseUpdate=Ae,N.lastBaseUpdate=He,P===null&&(N.shared.lanes=0),wo|=G,o.lanes=G,o.memoizedState=Ke}}function $g(o,c){if(typeof o!="function")throw Error(r(191,o));o.call(c)}function bp(o,c){var p=o.callbacks;if(p!==null)for(o.callbacks=null,o=0;o<p.length;o++)$g(p[o],c)}var yl=se(null),ho=se(0);function Es(o,c){o=Ls,M(ho,o),M(yl,c),Ls=o|c.baseLanes}function yf(){M(ho,Ls),M(yl,yl.current)}function vp(){Ls=ho.current,ue(yl),ue(ho)}var _a=0,qt=null,bn=null,en=null,fc=!1,xl=!1,$r=!1,hc=0,po=0,Ji=null,zg=0;function tn(){throw Error(r(321))}function Pu(o,c){if(c===null)return!1;for(var p=0;p<c.length&&p<o.length;p++)if(!Yr(o[p],c[p]))return!1;return!0}function wp(o,c,p,x,N,P){return _a=P,qt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Z.H=o===null||o.memoizedState===null?Zg:$p,$r=!1,P=p(x,N),$r=!1,xl&&(P=Ug(c,p,x,N)),Bg(o),P}function Bg(o){Z.H=Uu;var c=bn!==null&&bn.next!==null;if(_a=0,en=bn=qt=null,fc=!1,po=0,Ji=null,c)throw Error(r(300));o===null||Cr||(o=o.dependencies,o!==null&&ff(o)&&(Cr=!0))}function Ug(o,c,p,x){qt=o;var N=0;do{if(xl&&(Ji=null),po=0,xl=!1,25<=N)throw Error(r(301));if(N+=1,en=bn=null,o.updateQueue!=null){var P=o.updateQueue;P.lastEffect=null,P.events=null,P.stores=null,P.memoCache!=null&&(P.memoCache.index=0)}Z.H=ey,P=c(p,x)}while(xl);return P}function Sp(){var o=Z.H,c=o.useState()[0];return c=typeof c.then=="function"?Du(c):c,o=o.useState()[0],(bn!==null?bn.memoizedState:null)!==o&&(qt.flags|=1024),c}function Np(){var o=hc!==0;return hc=0,o}function bl(o,c,p){c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~p}function xf(o){if(fc){for(o=o.memoizedState;o!==null;){var c=o.queue;c!==null&&(c.pending=null),o=o.next}fc=!1}_a=0,en=bn=qt=null,xl=!1,po=hc=0,Ji=null}function pi(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return en===null?qt.memoizedState=en=o:en=en.next=o,en}function dr(){if(bn===null){var o=qt.alternate;o=o!==null?o.memoizedState:null}else o=bn.next;var c=en===null?qt.memoizedState:en.next;if(c!==null)en=c,bn=o;else{if(o===null)throw qt.alternate===null?Error(r(467)):Error(r(310));bn=o,o={memoizedState:bn.memoizedState,baseState:bn.baseState,baseQueue:bn.baseQueue,queue:bn.queue,next:null},en===null?qt.memoizedState=en=o:en=en.next=o}return en}function vl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Du(o){var c=po;return po+=1,Ji===null&&(Ji=[]),o=xp(Ji,o,c),c=qt,(en===null?c.memoizedState:en.next)===null&&(c=c.alternate,Z.H=c===null||c.memoizedState===null?Zg:$p),o}function bf(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return Du(o);if(o.$$typeof===D)return rr(o)}throw Error(r(438,String(o)))}function Iu(o){var c=null,p=qt.updateQueue;if(p!==null&&(c=p.memoCache),c==null){var x=qt.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(c={data:x.data.map(function(N){return N.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),p===null&&(p=vl(),qt.updateQueue=p),p.memoCache=c,p=c.data[c.index],p===void 0)for(p=c.data[c.index]=Array(o),x=0;x<o;x++)p[x]=L;return c.index++,p}function Ka(o,c){return typeof c=="function"?c(o):c}function vf(o){var c=dr();return Cp(c,bn,o)}function Cp(o,c,p){var x=o.queue;if(x===null)throw Error(r(311));x.lastRenderedReducer=p;var N=o.baseQueue,P=x.pending;if(P!==null){if(N!==null){var G=N.next;N.next=P.next,P.next=G}c.baseQueue=N=P,x.pending=null}if(P=o.baseState,N===null)o.memoizedState=P;else{c=N.next;var re=G=null,ye=null,Ae=c,He=!1;do{var Ke=Ae.lane&-536870913;if(Ke!==Ae.lane?(on&Ke)===Ke:(_a&Ke)===Ke){var Oe=Ae.revertLane;if(Oe===0)ye!==null&&(ye=ye.next={lane:0,revertLane:0,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null}),Ke===cc&&(He=!0);else if((_a&Oe)===Oe){Ae=Ae.next,Oe===cc&&(He=!0);continue}else Ke={lane:0,revertLane:Ae.revertLane,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null},ye===null?(re=ye=Ke,G=P):ye=ye.next=Ke,qt.lanes|=Oe,wo|=Oe;Ke=Ae.action,$r&&p(P,Ke),P=Ae.hasEagerState?Ae.eagerState:p(P,Ke)}else Oe={lane:Ke,revertLane:Ae.revertLane,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null},ye===null?(re=ye=Oe,G=P):ye=ye.next=Oe,qt.lanes|=Ke,wo|=Ke;Ae=Ae.next}while(Ae!==null&&Ae!==c);if(ye===null?G=P:ye.next=re,!Yr(P,o.memoizedState)&&(Cr=!0,He&&(p=hi,p!==null)))throw p;o.memoizedState=P,o.baseState=G,o.baseQueue=ye,x.lastRenderedState=P}return N===null&&(x.lanes=0),[o.memoizedState,x.dispatch]}function jp(o){var c=dr(),p=c.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=o;var x=p.dispatch,N=p.pending,P=c.memoizedState;if(N!==null){p.pending=null;var G=N=N.next;do P=o(P,G.action),G=G.next;while(G!==N);Yr(P,c.memoizedState)||(Cr=!0),c.memoizedState=P,c.baseQueue===null&&(c.baseState=P),p.lastRenderedState=P}return[P,x]}function _p(o,c,p){var x=qt,N=dr(),P=Zt;if(P){if(p===void 0)throw Error(r(407));p=p()}else p=c();var G=!Yr((bn||N).memoizedState,p);G&&(N.memoizedState=p,Cr=!0),N=N.queue;var re=Sf.bind(null,x,N,o);if(Ou(2048,8,re,[o]),N.getSnapshot!==c||G||en!==null&&en.memoizedState.tag&1){if(x.flags|=2048,pc(9,kf(),qg.bind(null,x,N,p,c),null),Rn===null)throw Error(r(349));P||(_a&124)!==0||wf(x,c,p)}return p}function wf(o,c,p){o.flags|=16384,o={getSnapshot:c,value:p},c=qt.updateQueue,c===null?(c=vl(),qt.updateQueue=c,c.stores=[o]):(p=c.stores,p===null?c.stores=[o]:p.push(o))}function qg(o,c,p,x){c.value=p,c.getSnapshot=x,kp(c)&&Ep(o)}function Sf(o,c,p){return p(function(){kp(c)&&Ep(o)})}function kp(o){var c=o.getSnapshot;o=o.value;try{var p=c();return!Yr(o,p)}catch{return!0}}function Ep(o){var c=ll(o,2);c!==null&&Oi(c,o,2)}function Nf(o){var c=pi();if(typeof o=="function"){var p=o;if(o=p(),$r){Ne(!0);try{p()}finally{Ne(!1)}}}return c.memoizedState=c.baseState=o,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ka,lastRenderedState:o},c}function Mu(o,c,p,x){return o.baseState=p,Cp(o,bn,typeof x=="function"?x:Ka)}function b0(o,c,p,x,N){if(Pf(o))throw Error(r(485));if(o=c.action,o!==null){var P={payload:N,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(G){P.listeners.push(G)}};Z.T!==null?p(!0):P.isTransition=!1,x(P),p=c.pending,p===null?(P.next=c.pending=P,Tp(c,P)):(P.next=p.next,c.pending=p.next=P)}}function Tp(o,c){var p=c.action,x=c.payload,N=o.state;if(c.isTransition){var P=Z.T,G={};Z.T=G;try{var re=p(N,x),ye=Z.S;ye!==null&&ye(G,re),Ap(o,c,re)}catch(Ae){Cf(o,c,Ae)}finally{Z.T=P}}else try{P=p(N,x),Ap(o,c,P)}catch(Ae){Cf(o,c,Ae)}}function Ap(o,c,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(x){Vg(o,c,x)},function(x){return Cf(o,c,x)}):Vg(o,c,p)}function Vg(o,c,p){c.status="fulfilled",c.value=p,Hg(c),o.state=p,c=o.pending,c!==null&&(p=c.next,p===c?o.pending=null:(p=p.next,c.next=p,Tp(o,p)))}function Cf(o,c,p){var x=o.pending;if(o.pending=null,x!==null){x=x.next;do c.status="rejected",c.reason=p,Hg(c),c=c.next;while(c!==x)}o.action=null}function Hg(o){o=o.listeners;for(var c=0;c<o.length;c++)(0,o[c])()}function jf(o,c){return c}function Pp(o,c){if(Zt){var p=Rn.formState;if(p!==null){e:{var x=qt;if(Zt){if(Vn){t:{for(var N=Vn,P=di;N.nodeType!==8;){if(!P){N=null;break t}if(N=Ta(N.nextSibling),N===null){N=null;break t}}P=N.data,N=P==="F!"||P==="F"?N:null}if(N){Vn=Ta(N.nextSibling),x=N.data==="F!";break e}}Wi(x)}x=!1}x&&(c=p[0])}}return p=pi(),p.memoizedState=p.baseState=c,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jf,lastRenderedState:c},p.queue=x,p=Op.bind(null,qt,x),x.dispatch=p,x=Nf(!1),P=Lp.bind(null,qt,!1,x.queue),x=pi(),N={state:c,dispatch:null,action:o,pending:null},x.queue=N,p=b0.bind(null,qt,N,P,p),N.dispatch=p,x.memoizedState=o,[c,p,!1]}function _f(o){var c=dr();return Gg(c,bn,o)}function Gg(o,c,p){if(c=Cp(o,c,jf)[0],o=vf(Ka)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var x=Du(c)}catch(G){throw G===Jr?mf:G}else x=c;c=dr();var N=c.queue,P=N.dispatch;return p!==c.memoizedState&&(qt.flags|=2048,pc(9,kf(),Dp.bind(null,N,p),null)),[x,P,o]}function Dp(o,c){o.action=c}function $t(o){var c=dr(),p=bn;if(p!==null)return Gg(c,p,o);dr(),c=c.memoizedState,p=dr();var x=p.queue.dispatch;return p.memoizedState=o,[c,x,!1]}function pc(o,c,p,x){return o={tag:o,create:p,deps:x,inst:c,next:null},c=qt.updateQueue,c===null&&(c=vl(),qt.updateQueue=c),p=c.lastEffect,p===null?c.lastEffect=o.next=o:(x=p.next,p.next=o,o.next=x,c.lastEffect=o),o}function kf(){return{destroy:void 0,resource:void 0}}function mc(){return dr().memoizedState}function Ru(o,c,p,x){var N=pi();x=x===void 0?null:x,qt.flags|=o,N.memoizedState=pc(1|c,kf(),p,x)}function Ou(o,c,p,x){var N=dr();x=x===void 0?null:x;var P=N.memoizedState.inst;bn!==null&&x!==null&&Pu(x,bn.memoizedState.deps)?N.memoizedState=pc(c,P,p,x):(qt.flags|=o,N.memoizedState=pc(1|c,P,p,x))}function Yg(o,c){Ru(8390656,8,o,c)}function Di(o,c){Ou(2048,8,o,c)}function Wg(o,c){return Ou(4,2,o,c)}function Lu(o,c){return Ou(4,4,o,c)}function Ef(o,c){if(typeof c=="function"){o=o();var p=c(o);return function(){typeof p=="function"?p():c(null)}}if(c!=null)return o=o(),c.current=o,function(){c.current=null}}function Ip(o,c,p){p=p!=null?p.concat([o]):null,Ou(4,4,Ef.bind(null,c,o),p)}function Tf(){}function mi(o,c){var p=dr();c=c===void 0?null:c;var x=p.memoizedState;return c!==null&&Pu(c,x[1])?x[0]:(p.memoizedState=[o,c],o)}function Ts(o,c){var p=dr();c=c===void 0?null:c;var x=p.memoizedState;if(c!==null&&Pu(c,x[1]))return x[0];if(x=o(),$r){Ne(!0);try{o()}finally{Ne(!1)}}return p.memoizedState=[x,c],x}function Fu(o,c,p){return p===void 0||(_a&1073741824)!==0?o.memoizedState=c:(o.memoizedState=p,o=ky(),qt.lanes|=o,wo|=o,p)}function Mp(o,c,p,x){return Yr(p,c)?p:yl.current!==null?(o=Fu(o,p,x),Yr(o,c)||(Cr=!0),o):(_a&42)===0?(Cr=!0,o.memoizedState=p):(o=ky(),qt.lanes|=o,wo|=o,c)}function $u(o,c,p,x,N){var P=B.p;B.p=P!==0&&8>P?P:8;var G=Z.T,re={};Z.T=re,Lp(o,!1,c,p);try{var ye=N(),Ae=Z.S;if(Ae!==null&&Ae(re,ye),ye!==null&&typeof ye=="object"&&typeof ye.then=="function"){var He=x0(ye,x);wl(o,c,He,Br(o))}else wl(o,c,x,Br(o))}catch(Ke){wl(o,c,{then:function(){},status:"rejected",reason:Ke},Br())}finally{B.p=P,Z.T=G}}function Qg(){}function zu(o,c,p,x){if(o.tag!==5)throw Error(r(476));var N=Rp(o).queue;$u(o,N,c,K,p===null?Qg:function(){return Af(o),p(x)})}function Rp(o){var c=o.memoizedState;if(c!==null)return c;c={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ka,lastRenderedState:K},next:null};var p={};return c.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ka,lastRenderedState:p},next:null},o.memoizedState=c,o=o.alternate,o!==null&&(o.memoizedState=c),c}function Af(o){var c=Rp(o).next.queue;wl(o,c,{},Br())}function Bu(){return rr(Oc)}function As(){return dr().memoizedState}function Jg(){return dr().memoizedState}function mo(o){for(var c=o.return;c!==null;){switch(c.tag){case 24:case 3:var p=Br();o=fo(p);var x=ks(c,o,p);x!==null&&(Oi(x,c,p),Tu(x,c,p)),c={cache:mp()},o.payload=c;return}c=c.return}}function Kg(o,c,p){var x=Br();p={lane:x,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},Pf(o)?Xg(c,p):(p=sc(o,c,p,x),p!==null&&(Oi(p,o,x),Fp(p,c,x)))}function Op(o,c,p){var x=Br();wl(o,c,p,x)}function wl(o,c,p,x){var N={lane:x,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(Pf(o))Xg(c,N);else{var P=o.alternate;if(o.lanes===0&&(P===null||P.lanes===0)&&(P=c.lastRenderedReducer,P!==null))try{var G=c.lastRenderedState,re=P(G,p);if(N.hasEagerState=!0,N.eagerState=re,Yr(re,G))return Sa(o,c,N,0),Rn===null&&ol(),!1}catch{}finally{}if(p=sc(o,c,N,x),p!==null)return Oi(p,o,x),Fp(p,c,x),!0}return!1}function Lp(o,c,p,x){if(x={lane:2,revertLane:Zf(),action:x,hasEagerState:!1,eagerState:null,next:null},Pf(o)){if(c)throw Error(r(479))}else c=sc(o,p,x,2),c!==null&&Oi(c,o,2)}function Pf(o){var c=o.alternate;return o===qt||c!==null&&c===qt}function Xg(o,c){xl=fc=!0;var p=o.pending;p===null?c.next=c:(c.next=p.next,p.next=c),o.pending=c}function Fp(o,c,p){if((p&4194048)!==0){var x=c.lanes;x&=o.pendingLanes,p|=x,c.lanes=p,Nr(o,p)}}var Uu={readContext:rr,use:bf,useCallback:tn,useContext:tn,useEffect:tn,useImperativeHandle:tn,useLayoutEffect:tn,useInsertionEffect:tn,useMemo:tn,useReducer:tn,useRef:tn,useState:tn,useDebugValue:tn,useDeferredValue:tn,useTransition:tn,useSyncExternalStore:tn,useId:tn,useHostTransitionStatus:tn,useFormState:tn,useActionState:tn,useOptimistic:tn,useMemoCache:tn,useCacheRefresh:tn},Zg={readContext:rr,use:bf,useCallback:function(o,c){return pi().memoizedState=[o,c===void 0?null:c],o},useContext:rr,useEffect:Yg,useImperativeHandle:function(o,c,p){p=p!=null?p.concat([o]):null,Ru(4194308,4,Ef.bind(null,c,o),p)},useLayoutEffect:function(o,c){return Ru(4194308,4,o,c)},useInsertionEffect:function(o,c){Ru(4,2,o,c)},useMemo:function(o,c){var p=pi();c=c===void 0?null:c;var x=o();if($r){Ne(!0);try{o()}finally{Ne(!1)}}return p.memoizedState=[x,c],x},useReducer:function(o,c,p){var x=pi();if(p!==void 0){var N=p(c);if($r){Ne(!0);try{p(c)}finally{Ne(!1)}}}else N=c;return x.memoizedState=x.baseState=N,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:N},x.queue=o,o=o.dispatch=Kg.bind(null,qt,o),[x.memoizedState,o]},useRef:function(o){var c=pi();return o={current:o},c.memoizedState=o},useState:function(o){o=Nf(o);var c=o.queue,p=Op.bind(null,qt,c);return c.dispatch=p,[o.memoizedState,p]},useDebugValue:Tf,useDeferredValue:function(o,c){var p=pi();return Fu(p,o,c)},useTransition:function(){var o=Nf(!1);return o=$u.bind(null,qt,o.queue,!0,!1),pi().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,c,p){var x=qt,N=pi();if(Zt){if(p===void 0)throw Error(r(407));p=p()}else{if(p=c(),Rn===null)throw Error(r(349));(on&124)!==0||wf(x,c,p)}N.memoizedState=p;var P={value:p,getSnapshot:c};return N.queue=P,Yg(Sf.bind(null,x,P,o),[o]),x.flags|=2048,pc(9,kf(),qg.bind(null,x,P,p,c),null),p},useId:function(){var o=pi(),c=Rn.identifierPrefix;if(Zt){var p=js,x=qn;p=(x&~(1<<32-ke(x)-1)).toString(32)+p,c=""+c+"R"+p,p=hc++,0<p&&(c+="H"+p.toString(32)),c+=""}else p=zg++,c=""+c+"r"+p.toString(32)+"";return o.memoizedState=c},useHostTransitionStatus:Bu,useFormState:Pp,useActionState:Pp,useOptimistic:function(o){var c=pi();c.memoizedState=c.baseState=o;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=p,c=Lp.bind(null,qt,!0,p),p.dispatch=c,[o,c]},useMemoCache:Iu,useCacheRefresh:function(){return pi().memoizedState=mo.bind(null,qt)}},$p={readContext:rr,use:bf,useCallback:mi,useContext:rr,useEffect:Di,useImperativeHandle:Ip,useInsertionEffect:Wg,useLayoutEffect:Lu,useMemo:Ts,useReducer:vf,useRef:mc,useState:function(){return vf(Ka)},useDebugValue:Tf,useDeferredValue:function(o,c){var p=dr();return Mp(p,bn.memoizedState,o,c)},useTransition:function(){var o=vf(Ka)[0],c=dr().memoizedState;return[typeof o=="boolean"?o:Du(o),c]},useSyncExternalStore:_p,useId:As,useHostTransitionStatus:Bu,useFormState:_f,useActionState:_f,useOptimistic:function(o,c){var p=dr();return Mu(p,bn,o,c)},useMemoCache:Iu,useCacheRefresh:Jg},ey={readContext:rr,use:bf,useCallback:mi,useContext:rr,useEffect:Di,useImperativeHandle:Ip,useInsertionEffect:Wg,useLayoutEffect:Lu,useMemo:Ts,useReducer:jp,useRef:mc,useState:function(){return jp(Ka)},useDebugValue:Tf,useDeferredValue:function(o,c){var p=dr();return bn===null?Fu(p,o,c):Mp(p,bn.memoizedState,o,c)},useTransition:function(){var o=jp(Ka)[0],c=dr().memoizedState;return[typeof o=="boolean"?o:Du(o),c]},useSyncExternalStore:_p,useId:As,useHostTransitionStatus:Bu,useFormState:$t,useActionState:$t,useOptimistic:function(o,c){var p=dr();return bn!==null?Mu(p,bn,o,c):(p.baseState=o,[o,p.queue.dispatch])},useMemoCache:Iu,useCacheRefresh:Jg},gr=null,gi=0;function Df(o){var c=gi;return gi+=1,gr===null&&(gr=[]),xp(gr,o,c)}function qu(o,c){c=c.props.ref,o.ref=c!==void 0?c:null}function Sl(o,c){throw c.$$typeof===g?Error(r(525)):(o=Object.prototype.toString.call(c),Error(r(31,o==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":o)))}function Nl(o){var c=o._init;return c(o._payload)}function zp(o){function c(je,Se){if(o){var Te=je.deletions;Te===null?(je.deletions=[Se],je.flags|=16):Te.push(Se)}}function p(je,Se){if(!o)return null;for(;Se!==null;)c(je,Se),Se=Se.sibling;return null}function x(je){for(var Se=new Map;je!==null;)je.key!==null?Se.set(je.key,je):Se.set(je.index,je),je=je.sibling;return Se}function N(je,Se){return je=Qr(je,Se),je.index=0,je.sibling=null,je}function P(je,Se,Te){return je.index=Te,o?(Te=je.alternate,Te!==null?(Te=Te.index,Te<Se?(je.flags|=67108866,Se):Te):(je.flags|=67108866,Se)):(je.flags|=1048576,Se)}function G(je){return o&&je.alternate===null&&(je.flags|=67108866),je}function re(je,Se,Te,Ye){return Se===null||Se.tag!==6?(Se=fp(Te,je.mode,Ye),Se.return=je,Se):(Se=N(Se,Te),Se.return=je,Se)}function ye(je,Se,Te,Ye){var pt=Te.type;return pt===S?He(je,Se,Te.props.children,Ye,Te.key):Se!==null&&(Se.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===z&&Nl(pt)===Se.type)?(Se=N(Se,Te.props),qu(Se,Te),Se.return=je,Se):(Se=uf(Te.type,Te.key,Te.props,null,je.mode,Ye),qu(Se,Te),Se.return=je,Se)}function Ae(je,Se,Te,Ye){return Se===null||Se.tag!==4||Se.stateNode.containerInfo!==Te.containerInfo||Se.stateNode.implementation!==Te.implementation?(Se=oc(Te,je.mode,Ye),Se.return=je,Se):(Se=N(Se,Te.children||[]),Se.return=je,Se)}function He(je,Se,Te,Ye,pt){return Se===null||Se.tag!==7?(Se=dl(Te,je.mode,Ye,pt),Se.return=je,Se):(Se=N(Se,Te),Se.return=je,Se)}function Ke(je,Se,Te){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return Se=fp(""+Se,je.mode,Te),Se.return=je,Se;if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case b:return Te=uf(Se.type,Se.key,Se.props,null,je.mode,Te),qu(Te,Se),Te.return=je,Te;case v:return Se=oc(Se,je.mode,Te),Se.return=je,Se;case z:var Ye=Se._init;return Se=Ye(Se._payload),Ke(je,Se,Te)}if(ae(Se)||H(Se))return Se=dl(Se,je.mode,Te,null),Se.return=je,Se;if(typeof Se.then=="function")return Ke(je,Df(Se),Te);if(Se.$$typeof===D)return Ke(je,hf(je,Se),Te);Sl(je,Se)}return null}function Oe(je,Se,Te,Ye){var pt=Se!==null?Se.key:null;if(typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint")return pt!==null?null:re(je,Se,""+Te,Ye);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case b:return Te.key===pt?ye(je,Se,Te,Ye):null;case v:return Te.key===pt?Ae(je,Se,Te,Ye):null;case z:return pt=Te._init,Te=pt(Te._payload),Oe(je,Se,Te,Ye)}if(ae(Te)||H(Te))return pt!==null?null:He(je,Se,Te,Ye,null);if(typeof Te.then=="function")return Oe(je,Se,Df(Te),Ye);if(Te.$$typeof===D)return Oe(je,Se,hf(je,Te),Ye);Sl(je,Te)}return null}function De(je,Se,Te,Ye,pt){if(typeof Ye=="string"&&Ye!==""||typeof Ye=="number"||typeof Ye=="bigint")return je=je.get(Te)||null,re(Se,je,""+Ye,pt);if(typeof Ye=="object"&&Ye!==null){switch(Ye.$$typeof){case b:return je=je.get(Ye.key===null?Te:Ye.key)||null,ye(Se,je,Ye,pt);case v:return je=je.get(Ye.key===null?Te:Ye.key)||null,Ae(Se,je,Ye,pt);case z:var Wt=Ye._init;return Ye=Wt(Ye._payload),De(je,Se,Te,Ye,pt)}if(ae(Ye)||H(Ye))return je=je.get(Te)||null,He(Se,je,Ye,pt,null);if(typeof Ye.then=="function")return De(je,Se,Te,Df(Ye),pt);if(Ye.$$typeof===D)return De(je,Se,Te,hf(Se,Ye),pt);Sl(Se,Ye)}return null}function _t(je,Se,Te,Ye){for(var pt=null,Wt=null,yt=Se,kt=Se=0,kr=null;yt!==null&&kt<Te.length;kt++){yt.index>kt?(kr=yt,yt=null):kr=yt.sibling;var cn=Oe(je,yt,Te[kt],Ye);if(cn===null){yt===null&&(yt=kr);break}o&&yt&&cn.alternate===null&&c(je,yt),Se=P(cn,Se,kt),Wt===null?pt=cn:Wt.sibling=cn,Wt=cn,yt=kr}if(kt===Te.length)return p(je,yt),Zt&&fl(je,kt),pt;if(yt===null){for(;kt<Te.length;kt++)yt=Ke(je,Te[kt],Ye),yt!==null&&(Se=P(yt,Se,kt),Wt===null?pt=yt:Wt.sibling=yt,Wt=yt);return Zt&&fl(je,kt),pt}for(yt=x(yt);kt<Te.length;kt++)kr=De(yt,je,kt,Te[kt],Ye),kr!==null&&(o&&kr.alternate!==null&&yt.delete(kr.key===null?kt:kr.key),Se=P(kr,Se,kt),Wt===null?pt=kr:Wt.sibling=kr,Wt=kr);return o&&yt.forEach(function(Po){return c(je,Po)}),Zt&&fl(je,kt),pt}function Nt(je,Se,Te,Ye){if(Te==null)throw Error(r(151));for(var pt=null,Wt=null,yt=Se,kt=Se=0,kr=null,cn=Te.next();yt!==null&&!cn.done;kt++,cn=Te.next()){yt.index>kt?(kr=yt,yt=null):kr=yt.sibling;var Po=Oe(je,yt,cn.value,Ye);if(Po===null){yt===null&&(yt=kr);break}o&&yt&&Po.alternate===null&&c(je,yt),Se=P(Po,Se,kt),Wt===null?pt=Po:Wt.sibling=Po,Wt=Po,yt=kr}if(cn.done)return p(je,yt),Zt&&fl(je,kt),pt;if(yt===null){for(;!cn.done;kt++,cn=Te.next())cn=Ke(je,cn.value,Ye),cn!==null&&(Se=P(cn,Se,kt),Wt===null?pt=cn:Wt.sibling=cn,Wt=cn);return Zt&&fl(je,kt),pt}for(yt=x(yt);!cn.done;kt++,cn=Te.next())cn=De(yt,je,kt,cn.value,Ye),cn!==null&&(o&&cn.alternate!==null&&yt.delete(cn.key===null?kt:cn.key),Se=P(cn,Se,kt),Wt===null?pt=cn:Wt.sibling=cn,Wt=cn);return o&&yt.forEach(function(tv){return c(je,tv)}),Zt&&fl(je,kt),pt}function kn(je,Se,Te,Ye){if(typeof Te=="object"&&Te!==null&&Te.type===S&&Te.key===null&&(Te=Te.props.children),typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case b:e:{for(var pt=Te.key;Se!==null;){if(Se.key===pt){if(pt=Te.type,pt===S){if(Se.tag===7){p(je,Se.sibling),Ye=N(Se,Te.props.children),Ye.return=je,je=Ye;break e}}else if(Se.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===z&&Nl(pt)===Se.type){p(je,Se.sibling),Ye=N(Se,Te.props),qu(Ye,Te),Ye.return=je,je=Ye;break e}p(je,Se);break}else c(je,Se);Se=Se.sibling}Te.type===S?(Ye=dl(Te.props.children,je.mode,Ye,Te.key),Ye.return=je,je=Ye):(Ye=uf(Te.type,Te.key,Te.props,null,je.mode,Ye),qu(Ye,Te),Ye.return=je,je=Ye)}return G(je);case v:e:{for(pt=Te.key;Se!==null;){if(Se.key===pt)if(Se.tag===4&&Se.stateNode.containerInfo===Te.containerInfo&&Se.stateNode.implementation===Te.implementation){p(je,Se.sibling),Ye=N(Se,Te.children||[]),Ye.return=je,je=Ye;break e}else{p(je,Se);break}else c(je,Se);Se=Se.sibling}Ye=oc(Te,je.mode,Ye),Ye.return=je,je=Ye}return G(je);case z:return pt=Te._init,Te=pt(Te._payload),kn(je,Se,Te,Ye)}if(ae(Te))return _t(je,Se,Te,Ye);if(H(Te)){if(pt=H(Te),typeof pt!="function")throw Error(r(150));return Te=pt.call(Te),Nt(je,Se,Te,Ye)}if(typeof Te.then=="function")return kn(je,Se,Df(Te),Ye);if(Te.$$typeof===D)return kn(je,Se,hf(je,Te),Ye);Sl(je,Te)}return typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint"?(Te=""+Te,Se!==null&&Se.tag===6?(p(je,Se.sibling),Ye=N(Se,Te),Ye.return=je,je=Ye):(p(je,Se),Ye=fp(Te,je.mode,Ye),Ye.return=je,je=Ye),G(je)):p(je,Se)}return function(je,Se,Te,Ye){try{gi=0;var pt=kn(je,Se,Te,Ye);return gr=null,pt}catch(yt){if(yt===Jr||yt===mf)throw yt;var Wt=ui(29,yt,null,je.mode);return Wt.lanes=Ye,Wt.return=je,Wt}finally{}}}var Cl=zp(!0),ty=zp(!1),Ii=se(null),Kr=null;function Ki(o){var c=o.alternate;M(ir,ir.current&1),M(Ii,o),Kr===null&&(c===null||yl.current!==null||c.memoizedState!==null)&&(Kr=o)}function ny(o){if(o.tag===22){if(M(ir,ir.current),M(Ii,o),Kr===null){var c=o.alternate;c!==null&&c.memoizedState!==null&&(Kr=o)}}else Ps()}function Ps(){M(ir,ir.current),M(Ii,Ii.current)}function Xa(o){ue(Ii),Kr===o&&(Kr=null),ue(ir)}var ir=se(0);function Vu(o){for(var c=o;c!==null;){if(c.tag===13){var p=c.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||Zr(p)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function gc(o,c,p,x){c=o.memoizedState,p=p(x,c),p=p==null?c:h({},c,p),o.memoizedState=p,o.lanes===0&&(o.updateQueue.baseState=p)}var Hu={enqueueSetState:function(o,c,p){o=o._reactInternals;var x=Br(),N=fo(x);N.payload=c,p!=null&&(N.callback=p),c=ks(o,N,x),c!==null&&(Oi(c,o,x),Tu(c,o,x))},enqueueReplaceState:function(o,c,p){o=o._reactInternals;var x=Br(),N=fo(x);N.tag=1,N.payload=c,p!=null&&(N.callback=p),c=ks(o,N,x),c!==null&&(Oi(c,o,x),Tu(c,o,x))},enqueueForceUpdate:function(o,c){o=o._reactInternals;var p=Br(),x=fo(p);x.tag=2,c!=null&&(x.callback=c),c=ks(o,x,p),c!==null&&(Oi(c,o,p),Tu(c,o,p))}};function Gu(o,c,p,x,N,P,G){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(x,P,G):c.prototype&&c.prototype.isPureReactComponent?!Vi(p,x)||!Vi(N,P):!0}function ry(o,c,p,x){o=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(p,x),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(p,x),c.state!==o&&Hu.enqueueReplaceState(c,c.state,null)}function go(o,c){var p=c;if("ref"in c){p={};for(var x in c)x!=="ref"&&(p[x]=c[x])}if(o=o.defaultProps){p===c&&(p=h({},p));for(var N in o)p[N]===void 0&&(p[N]=o[N])}return p}var jl=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)};function Bp(o){jl(o)}function If(o){console.error(o)}function iy(o){jl(o)}function Yu(o,c){try{var p=o.onUncaughtError;p(c.value,{componentStack:c.stack})}catch(x){setTimeout(function(){throw x})}}function Za(o,c,p){try{var x=o.onCaughtError;x(p.value,{componentStack:p.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function Mf(o,c,p){return p=fo(p),p.tag=3,p.payload={element:null},p.callback=function(){Yu(o,c)},p}function Up(o){return o=fo(o),o.tag=3,o}function ay(o,c,p,x){var N=p.type.getDerivedStateFromError;if(typeof N=="function"){var P=x.value;o.payload=function(){return N(P)},o.callback=function(){Za(c,p,x)}}var G=p.stateNode;G!==null&&typeof G.componentDidCatch=="function"&&(o.callback=function(){Za(c,p,x),typeof N!="function"&&(So===null?So=new Set([this]):So.add(this));var re=x.stack;this.componentDidCatch(x.value,{componentStack:re!==null?re:""})})}function sy(o,c,p,x,N){if(p.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(c=p.alternate,c!==null&&_u(c,p,N,!0),p=Ii.current,p!==null){switch(p.tag){case 13:return Kr===null?om():p.alternate===null&&ar===0&&(ar=3),p.flags&=-257,p.flags|=65536,p.lanes=N,x===yp?p.flags|=16384:(c=p.updateQueue,c===null?p.updateQueue=new Set([x]):c.add(x),um(o,x,N)),!1;case 22:return p.flags|=65536,x===yp?p.flags|=16384:(c=p.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([x])},p.updateQueue=c):(p=c.retryQueue,p===null?c.retryQueue=new Set([x]):p.add(x)),um(o,x,N)),!1}throw Error(r(435,p.tag))}return um(o,x,N),om(),!1}if(Zt)return c=Ii.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=N,x!==lc&&(o=Error(r(422),{cause:x}),co(Wr(o,p)))):(x!==lc&&(c=Error(r(423),{cause:x}),co(Wr(c,p))),o=o.current.alternate,o.flags|=65536,N&=-N,o.lanes|=N,x=Wr(x,p),N=Mf(o.stateNode,x,N),Ca(o,N),ar!==4&&(ar=2)),!1;var P=Error(r(520),{cause:x});if(P=Wr(P,p),rd===null?rd=[P]:rd.push(P),ar!==4&&(ar=2),c===null)return!0;x=Wr(x,p),p=c;do{switch(p.tag){case 3:return p.flags|=65536,o=N&-N,p.lanes|=o,o=Mf(p.stateNode,x,o),Ca(p,o),!1;case 1:if(c=p.type,P=p.stateNode,(p.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(So===null||!So.has(P))))return p.flags|=65536,N&=-N,p.lanes|=N,N=Up(N),ay(N,o,p,x),Ca(p,N),!1}p=p.return}while(p!==null);return!1}var oy=Error(r(461)),Cr=!1;function zn(o,c,p,x){c.child=o===null?ty(c,null,p,x):Cl(c,o.child,p,x)}function Rf(o,c,p,x,N){p=p.render;var P=c.ref;if("ref"in x){var G={};for(var re in x)re!=="ref"&&(G[re]=x[re])}else G=x;return pl(c),x=wp(o,c,p,G,P,N),re=Np(),o!==null&&!Cr?(bl(o,c,N),Ds(o,c,N)):(Zt&&re&&pp(c),c.flags|=1,zn(o,c,x,N),c.child)}function Of(o,c,p,x,N){if(o===null){var P=p.type;return typeof P=="function"&&!ul(P)&&P.defaultProps===void 0&&p.compare===null?(c.tag=15,c.type=P,Lf(o,c,P,x,N)):(o=uf(p.type,null,x,c,c.mode,N),o.ref=c.ref,o.return=c,c.child=o)}if(P=o.child,!ka(o,N)){var G=P.memoizedProps;if(p=p.compare,p=p!==null?p:Vi,p(G,x)&&o.ref===c.ref)return Ds(o,c,N)}return c.flags|=1,o=Qr(P,x),o.ref=c.ref,o.return=c,c.child=o}function Lf(o,c,p,x,N){if(o!==null){var P=o.memoizedProps;if(Vi(P,x)&&o.ref===c.ref)if(Cr=!1,c.pendingProps=x=P,ka(o,N))(o.flags&131072)!==0&&(Cr=!0);else return c.lanes=o.lanes,Ds(o,c,N)}return yc(o,c,p,x,N)}function Wu(o,c,p){var x=c.pendingProps,N=x.children,P=o!==null?o.memoizedState:null;if(x.mode==="hidden"){if((c.flags&128)!==0){if(x=P!==null?P.baseLanes|p:p,o!==null){for(N=c.child=o.child,P=0;N!==null;)P=P|N.lanes|N.childLanes,N=N.sibling;c.childLanes=P&~x}else c.childLanes=0,c.child=null;return _l(o,c,x,p)}if((p&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},o!==null&&pf(c,P!==null?P.cachePool:null),P!==null?Es(c,P):yf(),ny(c);else return c.lanes=c.childLanes=536870912,_l(o,c,P!==null?P.baseLanes|p:p,p)}else P!==null?(pf(c,P.cachePool),Es(c,P),Ps(),c.memoizedState=null):(o!==null&&pf(c,null),yf(),Ps());return zn(o,c,N,p),c.child}function _l(o,c,p,x){var N=_s();return N=N===null?null:{parent:An._currentValue,pool:N},c.memoizedState={baseLanes:p,cachePool:N},o!==null&&pf(c,null),yf(),ny(c),o!==null&&_u(o,c,x,!0),null}function vt(o,c){var p=c.ref;if(p===null)o!==null&&o.ref!==null&&(c.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(r(284));(o===null||o.ref!==p)&&(c.flags|=4194816)}}function yc(o,c,p,x,N){return pl(c),p=wp(o,c,p,x,void 0,N),x=Np(),o!==null&&!Cr?(bl(o,c,N),Ds(o,c,N)):(Zt&&x&&pp(c),c.flags|=1,zn(o,c,p,N),c.child)}function Ff(o,c,p,x,N,P){return pl(c),c.updateQueue=null,p=Ug(c,x,p,N),Bg(o),x=Np(),o!==null&&!Cr?(bl(o,c,P),Ds(o,c,P)):(Zt&&x&&pp(c),c.flags|=1,zn(o,c,p,P),c.child)}function yo(o,c,p,x,N){if(pl(c),c.stateNode===null){var P=cl,G=p.contextType;typeof G=="object"&&G!==null&&(P=rr(G)),P=new p(x,P),c.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,P.updater=Hu,c.stateNode=P,P._reactInternals=c,P=c.stateNode,P.props=x,P.state=c.memoizedState,P.refs={},gl(c),G=p.contextType,P.context=typeof G=="object"&&G!==null?rr(G):cl,P.state=c.memoizedState,G=p.getDerivedStateFromProps,typeof G=="function"&&(gc(c,p,G,x),P.state=c.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(G=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),G!==P.state&&Hu.enqueueReplaceState(P,P.state,null),Fr(c,x,P,N),ja(),P.state=c.memoizedState),typeof P.componentDidMount=="function"&&(c.flags|=4194308),x=!0}else if(o===null){P=c.stateNode;var re=c.memoizedProps,ye=go(p,re);P.props=ye;var Ae=P.context,He=p.contextType;G=cl,typeof He=="object"&&He!==null&&(G=rr(He));var Ke=p.getDerivedStateFromProps;He=typeof Ke=="function"||typeof P.getSnapshotBeforeUpdate=="function",re=c.pendingProps!==re,He||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(re||Ae!==G)&&ry(c,P,x,G),Ja=!1;var Oe=c.memoizedState;P.state=Oe,Fr(c,x,P,N),ja(),Ae=c.memoizedState,re||Oe!==Ae||Ja?(typeof Ke=="function"&&(gc(c,p,Ke,x),Ae=c.memoizedState),(ye=Ja||Gu(c,p,ye,x,Oe,Ae,G))?(He||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(c.flags|=4194308)):(typeof P.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=x,c.memoizedState=Ae),P.props=x,P.state=Ae,P.context=G,x=ye):(typeof P.componentDidMount=="function"&&(c.flags|=4194308),x=!1)}else{P=c.stateNode,dc(o,c),G=c.memoizedProps,He=go(p,G),P.props=He,Ke=c.pendingProps,Oe=P.context,Ae=p.contextType,ye=cl,typeof Ae=="object"&&Ae!==null&&(ye=rr(Ae)),re=p.getDerivedStateFromProps,(Ae=typeof re=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(G!==Ke||Oe!==ye)&&ry(c,P,x,ye),Ja=!1,Oe=c.memoizedState,P.state=Oe,Fr(c,x,P,N),ja();var De=c.memoizedState;G!==Ke||Oe!==De||Ja||o!==null&&o.dependencies!==null&&ff(o.dependencies)?(typeof re=="function"&&(gc(c,p,re,x),De=c.memoizedState),(He=Ja||Gu(c,p,He,x,Oe,De,ye)||o!==null&&o.dependencies!==null&&ff(o.dependencies))?(Ae||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(x,De,ye),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(x,De,ye)),typeof P.componentDidUpdate=="function"&&(c.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof P.componentDidUpdate!="function"||G===o.memoizedProps&&Oe===o.memoizedState||(c.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||G===o.memoizedProps&&Oe===o.memoizedState||(c.flags|=1024),c.memoizedProps=x,c.memoizedState=De),P.props=x,P.state=De,P.context=ye,x=He):(typeof P.componentDidUpdate!="function"||G===o.memoizedProps&&Oe===o.memoizedState||(c.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||G===o.memoizedProps&&Oe===o.memoizedState||(c.flags|=1024),x=!1)}return P=x,vt(o,c),x=(c.flags&128)!==0,P||x?(P=c.stateNode,p=x&&typeof p.getDerivedStateFromError!="function"?null:P.render(),c.flags|=1,o!==null&&x?(c.child=Cl(c,o.child,null,N),c.child=Cl(c,null,p,N)):zn(o,c,p,N),c.memoizedState=P.state,o=c.child):o=Ds(o,c,N),o}function ly(o,c,p,x){return ju(),c.flags|=256,zn(o,c,p,x),c.child}var Qu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function $f(o){return{baseLanes:o,cachePool:Mg()}}function jr(o,c,p){return o=o!==null?o.childLanes&~p:0,c&&(o|=Zi),o}function cy(o,c,p){var x=c.pendingProps,N=!1,P=(c.flags&128)!==0,G;if((G=P)||(G=o!==null&&o.memoizedState===null?!1:(ir.current&2)!==0),G&&(N=!0,c.flags&=-129),G=(c.flags&32)!==0,c.flags&=-33,o===null){if(Zt){if(N?Ki(c):Ps(),Zt){var re=Vn,ye;if(ye=re){e:{for(ye=re,re=di;ye.nodeType!==8;){if(!re){re=null;break e}if(ye=Ta(ye.nextSibling),ye===null){re=null;break e}}re=ye}re!==null?(c.memoizedState={dehydrated:re,treeContext:$n!==null?{id:qn,overflow:js}:null,retryLane:536870912,hydrationErrors:null},ye=ui(18,null,null,0),ye.stateNode=re,ye.return=c,c.child=ye,mr=c,Vn=null,ye=!0):ye=!1}ye||Wi(c)}if(re=c.memoizedState,re!==null&&(re=re.dehydrated,re!==null))return Zr(re)?c.lanes=32:c.lanes=536870912,null;Xa(c)}return re=x.children,x=x.fallback,N?(Ps(),N=c.mode,re=Ju({mode:"hidden",children:re},N),x=dl(x,N,p,null),re.return=c,x.return=c,re.sibling=x,c.child=re,N=c.child,N.memoizedState=$f(p),N.childLanes=jr(o,G,p),c.memoizedState=Qu,x):(Ki(c),qp(c,re))}if(ye=o.memoizedState,ye!==null&&(re=ye.dehydrated,re!==null)){if(P)c.flags&256?(Ki(c),c.flags&=-257,c=Vp(o,c,p)):c.memoizedState!==null?(Ps(),c.child=o.child,c.flags|=128,c=null):(Ps(),N=x.fallback,re=c.mode,x=Ju({mode:"visible",children:x.children},re),N=dl(N,re,p,null),N.flags|=2,x.return=c,N.return=c,x.sibling=N,c.child=x,Cl(c,o.child,null,p),x=c.child,x.memoizedState=$f(p),x.childLanes=jr(o,G,p),c.memoizedState=Qu,c=N);else if(Ki(c),Zr(re)){if(G=re.nextSibling&&re.nextSibling.dataset,G)var Ae=G.dgst;G=Ae,x=Error(r(419)),x.stack="",x.digest=G,co({value:x,source:null,stack:null}),c=Vp(o,c,p)}else if(Cr||_u(o,c,p,!1),G=(p&o.childLanes)!==0,Cr||G){if(G=Rn,G!==null&&(x=p&-p,x=(x&42)!==0?1:Ur(x),x=(x&(G.suspendedLanes|p))!==0?0:x,x!==0&&x!==ye.retryLane))throw ye.retryLane=x,ll(o,x),Oi(G,o,x),oy;re.data==="$?"||om(),c=Vp(o,c,p)}else re.data==="$?"?(c.flags|=192,c.child=o.child,c=null):(o=ye.treeContext,Vn=Ta(re.nextSibling),mr=c,Zt=!0,Na=null,di=!1,o!==null&&(Gi[Yi++]=qn,Gi[Yi++]=js,Gi[Yi++]=$n,qn=o.id,js=o.overflow,$n=c),c=qp(c,x.children),c.flags|=4096);return c}return N?(Ps(),N=x.fallback,re=c.mode,ye=o.child,Ae=ye.sibling,x=Qr(ye,{mode:"hidden",children:x.children}),x.subtreeFlags=ye.subtreeFlags&65011712,Ae!==null?N=Qr(Ae,N):(N=dl(N,re,p,null),N.flags|=2),N.return=c,x.return=c,x.sibling=N,c.child=x,x=N,N=c.child,re=o.child.memoizedState,re===null?re=$f(p):(ye=re.cachePool,ye!==null?(Ae=An._currentValue,ye=ye.parent!==Ae?{parent:Ae,pool:Ae}:ye):ye=Mg(),re={baseLanes:re.baseLanes|p,cachePool:ye}),N.memoizedState=re,N.childLanes=jr(o,G,p),c.memoizedState=Qu,x):(Ki(c),p=o.child,o=p.sibling,p=Qr(p,{mode:"visible",children:x.children}),p.return=c,p.sibling=null,o!==null&&(G=c.deletions,G===null?(c.deletions=[o],c.flags|=16):G.push(o)),c.child=p,c.memoizedState=null,p)}function qp(o,c){return c=Ju({mode:"visible",children:c},o.mode),c.return=o,o.child=c}function Ju(o,c){return o=ui(22,o,null,c),o.lanes=0,o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},o}function Vp(o,c,p){return Cl(c,o.child,null,p),o=qp(c,c.pendingProps.children),o.flags|=2,c.memoizedState=null,o}function Hp(o,c,p){o.lanes|=c;var x=o.alternate;x!==null&&(x.lanes|=c),fi(o.return,c,p)}function Gp(o,c,p,x,N){var P=o.memoizedState;P===null?o.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:x,tail:p,tailMode:N}:(P.isBackwards=c,P.rendering=null,P.renderingStartTime=0,P.last=x,P.tail=p,P.tailMode=N)}function uy(o,c,p){var x=c.pendingProps,N=x.revealOrder,P=x.tail;if(zn(o,c,x.children,p),x=ir.current,(x&2)!==0)x=x&1|2,c.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=c.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Hp(o,p,c);else if(o.tag===19)Hp(o,p,c);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===c)break e;for(;o.sibling===null;){if(o.return===null||o.return===c)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}x&=1}switch(M(ir,x),N){case"forwards":for(p=c.child,N=null;p!==null;)o=p.alternate,o!==null&&Vu(o)===null&&(N=p),p=p.sibling;p=N,p===null?(N=c.child,c.child=null):(N=p.sibling,p.sibling=null),Gp(c,!1,N,p,P);break;case"backwards":for(p=null,N=c.child,c.child=null;N!==null;){if(o=N.alternate,o!==null&&Vu(o)===null){c.child=N;break}o=N.sibling,N.sibling=p,p=N,N=o}Gp(c,!0,p,null,P);break;case"together":Gp(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Ds(o,c,p){if(o!==null&&(c.dependencies=o.dependencies),wo|=c.lanes,(p&c.childLanes)===0)if(o!==null){if(_u(o,c,p,!1),(p&c.childLanes)===0)return null}else return null;if(o!==null&&c.child!==o.child)throw Error(r(153));if(c.child!==null){for(o=c.child,p=Qr(o,o.pendingProps),c.child=p,p.return=c;o.sibling!==null;)o=o.sibling,p=p.sibling=Qr(o,o.pendingProps),p.return=c;p.sibling=null}return c.child}function ka(o,c){return(o.lanes&c)!==0?!0:(o=o.dependencies,!!(o!==null&&ff(o)))}function Xr(o,c,p){switch(c.tag){case 3:de(c,c.stateNode.containerInfo),Pi(c,An,o.memoizedState.cache),ju();break;case 27:case 5:Ze(c);break;case 4:de(c,c.stateNode.containerInfo);break;case 10:Pi(c,c.type,c.memoizedProps.value);break;case 13:var x=c.memoizedState;if(x!==null)return x.dehydrated!==null?(Ki(c),c.flags|=128,null):(p&c.child.childLanes)!==0?cy(o,c,p):(Ki(c),o=Ds(o,c,p),o!==null?o.sibling:null);Ki(c);break;case 19:var N=(o.flags&128)!==0;if(x=(p&c.childLanes)!==0,x||(_u(o,c,p,!1),x=(p&c.childLanes)!==0),N){if(x)return uy(o,c,p);c.flags|=128}if(N=c.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),M(ir,ir.current),x)break;return null;case 22:case 23:return c.lanes=0,Wu(o,c,p);case 24:Pi(c,An,o.memoizedState.cache)}return Ds(o,c,p)}function zf(o,c,p){if(o!==null)if(o.memoizedProps!==c.pendingProps)Cr=!0;else{if(!ka(o,p)&&(c.flags&128)===0)return Cr=!1,Xr(o,c,p);Cr=(o.flags&131072)!==0}else Cr=!1,Zt&&(c.flags&1048576)!==0&&hp(c,Su,c.index);switch(c.lanes=0,c.tag){case 16:e:{o=c.pendingProps;var x=c.elementType,N=x._init;if(x=N(x._payload),c.type=x,typeof x=="function")ul(x)?(o=go(x,o),c.tag=1,c=yo(null,c,x,o,p)):(c.tag=0,c=yc(null,c,x,o,p));else{if(x!=null){if(N=x.$$typeof,N===q){c.tag=11,c=Rf(null,c,x,o,p);break e}else if(N===U){c.tag=14,c=Of(null,c,x,o,p);break e}}throw c=te(x)||x,Error(r(306,c,""))}}return c;case 0:return yc(o,c,c.type,c.pendingProps,p);case 1:return x=c.type,N=go(x,c.pendingProps),yo(o,c,x,N,p);case 3:e:{if(de(c,c.stateNode.containerInfo),o===null)throw Error(r(387));x=c.pendingProps;var P=c.memoizedState;N=P.element,dc(o,c),Fr(c,x,null,p);var G=c.memoizedState;if(x=G.cache,Pi(c,An,x),x!==P.cache&&Yt(c,[An],p,!0),ja(),x=G.element,P.isDehydrated)if(P={element:x,isDehydrated:!1,cache:G.cache},c.updateQueue.baseState=P,c.memoizedState=P,c.flags&256){c=ly(o,c,x,p);break e}else if(x!==N){N=Wr(Error(r(424)),c),co(N),c=ly(o,c,x,p);break e}else{switch(o=c.stateNode.containerInfo,o.nodeType){case 9:o=o.body;break;default:o=o.nodeName==="HTML"?o.ownerDocument.body:o}for(Vn=Ta(o.firstChild),mr=c,Zt=!0,Na=null,di=!0,p=ty(c,null,x,p),c.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(ju(),x===N){c=Ds(o,c,p);break e}zn(o,c,x,p)}c=c.child}return c;case 26:return vt(o,c),o===null?(p=sx(c.type,null,c.pendingProps,null))?c.memoizedState=p:Zt||(p=c.type,o=c.pendingProps,x=Tl(fe.current).createElement(p),x[Xn]=c,x[Fn]=o,br(x,p,o),cr(x),c.stateNode=x):c.memoizedState=sx(c.type,o.memoizedProps,c.pendingProps,o.memoizedState),null;case 27:return Ze(c),o===null&&Zt&&(x=c.stateNode=rx(c.type,c.pendingProps,fe.current),mr=c,di=!0,N=Vn,ea(c.type)?(bm=N,Vn=Ta(x.firstChild)):Vn=N),zn(o,c,c.pendingProps.children,p),vt(o,c),o===null&&(c.flags|=4194304),c.child;case 5:return o===null&&Zt&&((N=x=Vn)&&(x=tx(x,c.type,c.pendingProps,di),x!==null?(c.stateNode=x,mr=c,Vn=Ta(x.firstChild),di=!1,N=!0):N=!1),N||Wi(c)),Ze(c),N=c.type,P=c.pendingProps,G=o!==null?o.memoizedProps:null,x=P.children,rh(N,P)?x=null:G!==null&&rh(N,G)&&(c.flags|=32),c.memoizedState!==null&&(N=wp(o,c,Sp,null,null,p),Oc._currentValue=N),vt(o,c),zn(o,c,x,p),c.child;case 6:return o===null&&Zt&&((o=p=Vn)&&(p=ah(p,c.pendingProps,di),p!==null?(c.stateNode=p,mr=c,Vn=null,o=!0):o=!1),o||Wi(c)),null;case 13:return cy(o,c,p);case 4:return de(c,c.stateNode.containerInfo),x=c.pendingProps,o===null?c.child=Cl(c,null,x,p):zn(o,c,x,p),c.child;case 11:return Rf(o,c,c.type,c.pendingProps,p);case 7:return zn(o,c,c.pendingProps,p),c.child;case 8:return zn(o,c,c.pendingProps.children,p),c.child;case 12:return zn(o,c,c.pendingProps.children,p),c.child;case 10:return x=c.pendingProps,Pi(c,c.type,x.value),zn(o,c,x.children,p),c.child;case 9:return N=c.type._context,x=c.pendingProps.children,pl(c),N=rr(N),x=x(N),c.flags|=1,zn(o,c,x,p),c.child;case 14:return Of(o,c,c.type,c.pendingProps,p);case 15:return Lf(o,c,c.type,c.pendingProps,p);case 19:return uy(o,c,p);case 31:return x=c.pendingProps,p=c.mode,x={mode:x.mode,children:x.children},o===null?(p=Ju(x,p),p.ref=c.ref,c.child=p,p.return=c,c=p):(p=Qr(o.child,x),p.ref=c.ref,c.child=p,p.return=c,c=p),c;case 22:return Wu(o,c,p);case 24:return pl(c),x=rr(An),o===null?(N=_s(),N===null&&(N=Rn,P=mp(),N.pooledCache=P,P.refCount++,P!==null&&(N.pooledCacheLanes|=p),N=P),c.memoizedState={parent:x,cache:N},gl(c),Pi(c,An,N)):((o.lanes&p)!==0&&(dc(o,c),Fr(c,null,null,p),ja()),N=o.memoizedState,P=c.memoizedState,N.parent!==x?(N={parent:x,cache:x},c.memoizedState=N,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=N),Pi(c,An,x)):(x=P.cache,Pi(c,An,x),x!==N.cache&&Yt(c,[An],p,!0))),zn(o,c,c.pendingProps.children,p),c.child;case 29:throw c.pendingProps}throw Error(r(156,c.tag))}function Is(o){o.flags|=4}function Bf(o,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!vr(c)){if(c=Ii.current,c!==null&&((on&4194048)===on?Kr!==null:(on&62914560)!==on&&(on&536870912)===0||c!==Kr))throw uc=yp,Rg;o.flags|=8192}}function Uf(o,c){c!==null&&(o.flags|=4),o.flags&16384&&(c=o.tag!==22?Un():536870912,o.lanes|=c,Cc|=c)}function Ku(o,c){if(!Zt)switch(o.tailMode){case"hidden":c=o.tail;for(var p=null;c!==null;)c.alternate!==null&&(p=c),c=c.sibling;p===null?o.tail=null:p.sibling=null;break;case"collapsed":p=o.tail;for(var x=null;p!==null;)p.alternate!==null&&(x=p),p=p.sibling;x===null?c||o.tail===null?o.tail=null:o.tail.sibling=null:x.sibling=null}}function Pn(o){var c=o.alternate!==null&&o.alternate.child===o.child,p=0,x=0;if(c)for(var N=o.child;N!==null;)p|=N.lanes|N.childLanes,x|=N.subtreeFlags&65011712,x|=N.flags&65011712,N.return=o,N=N.sibling;else for(N=o.child;N!==null;)p|=N.lanes|N.childLanes,x|=N.subtreeFlags,x|=N.flags,N.return=o,N=N.sibling;return o.subtreeFlags|=x,o.childLanes=p,c}function dy(o,c,p){var x=c.pendingProps;switch(Nu(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pn(c),null;case 1:return Pn(c),null;case 3:return p=c.stateNode,x=null,o!==null&&(x=o.memoizedState.cache),c.memoizedState.cache!==x&&(c.flags|=2048),Qi(An),Me(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(o===null||o.child===null)&&(Cu(c)?Is(c):o===null||o.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Ag())),Pn(c),null;case 26:return p=c.memoizedState,o===null?(Is(c),p!==null?(Pn(c),Bf(c,p)):(Pn(c),c.flags&=-16777217)):p?p!==o.memoizedState?(Is(c),Pn(c),Bf(c,p)):(Pn(c),c.flags&=-16777217):(o.memoizedProps!==x&&Is(c),Pn(c),c.flags&=-16777217),null;case 27:Fe(c),p=fe.current;var N=c.type;if(o!==null&&c.stateNode!=null)o.memoizedProps!==x&&Is(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Pn(c),null}o=pe.current,Cu(c)?Eg(c):(o=rx(N,x,p),c.stateNode=o,Is(c))}return Pn(c),null;case 5:if(Fe(c),p=c.type,o!==null&&c.stateNode!=null)o.memoizedProps!==x&&Is(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Pn(c),null}if(o=pe.current,Cu(c))Eg(c);else{switch(N=Tl(fe.current),o){case 1:o=N.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:o=N.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":o=N.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":o=N.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":o=N.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o=typeof x.is=="string"?N.createElement("select",{is:x.is}):N.createElement("select"),x.multiple?o.multiple=!0:x.size&&(o.size=x.size);break;default:o=typeof x.is=="string"?N.createElement(p,{is:x.is}):N.createElement(p)}}o[Xn]=c,o[Fn]=x;e:for(N=c.child;N!==null;){if(N.tag===5||N.tag===6)o.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===c)break e;for(;N.sibling===null;){if(N.return===null||N.return===c)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}c.stateNode=o;e:switch(br(o,p,x),p){case"button":case"input":case"select":case"textarea":o=!!x.autoFocus;break e;case"img":o=!0;break e;default:o=!1}o&&Is(c)}}return Pn(c),c.flags&=-16777217,null;case 6:if(o&&c.stateNode!=null)o.memoizedProps!==x&&Is(c);else{if(typeof x!="string"&&c.stateNode===null)throw Error(r(166));if(o=fe.current,Cu(c)){if(o=c.stateNode,p=c.memoizedProps,x=null,N=mr,N!==null)switch(N.tag){case 27:case 5:x=N.memoizedProps}o[Xn]=c,o=!!(o.nodeValue===p||x!==null&&x.suppressHydrationWarning===!0||Ky(o.nodeValue,p)),o||Wi(c)}else o=Tl(o).createTextNode(x),o[Xn]=c,c.stateNode=o}return Pn(c),null;case 13:if(x=c.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(N=Cu(c),x!==null&&x.dehydrated!==null){if(o===null){if(!N)throw Error(r(318));if(N=c.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(r(317));N[Xn]=c}else ju(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Pn(c),N=!1}else N=Ag(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=N),N=!0;if(!N)return c.flags&256?(Xa(c),c):(Xa(c),null)}if(Xa(c),(c.flags&128)!==0)return c.lanes=p,c;if(p=x!==null,o=o!==null&&o.memoizedState!==null,p){x=c.child,N=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(N=x.alternate.memoizedState.cachePool.pool);var P=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(P=x.memoizedState.cachePool.pool),P!==N&&(x.flags|=2048)}return p!==o&&p&&(c.child.flags|=8192),Uf(c,c.updateQueue),Pn(c),null;case 4:return Me(),o===null&&mm(c.stateNode.containerInfo),Pn(c),null;case 10:return Qi(c.type),Pn(c),null;case 19:if(ue(ir),N=c.memoizedState,N===null)return Pn(c),null;if(x=(c.flags&128)!==0,P=N.rendering,P===null)if(x)Ku(N,!1);else{if(ar!==0||o!==null&&(o.flags&128)!==0)for(o=c.child;o!==null;){if(P=Vu(o),P!==null){for(c.flags|=128,Ku(N,!1),o=P.updateQueue,c.updateQueue=o,Uf(c,o),c.subtreeFlags=0,o=p,p=c.child;p!==null;)wu(p,o),p=p.sibling;return M(ir,ir.current&1|2),c.child}o=o.sibling}N.tail!==null&&ze()>jc&&(c.flags|=128,x=!0,Ku(N,!1),c.lanes=4194304)}else{if(!x)if(o=Vu(P),o!==null){if(c.flags|=128,x=!0,o=o.updateQueue,c.updateQueue=o,Uf(c,o),Ku(N,!0),N.tail===null&&N.tailMode==="hidden"&&!P.alternate&&!Zt)return Pn(c),null}else 2*ze()-N.renderingStartTime>jc&&p!==536870912&&(c.flags|=128,x=!0,Ku(N,!1),c.lanes=4194304);N.isBackwards?(P.sibling=c.child,c.child=P):(o=N.last,o!==null?o.sibling=P:c.child=P,N.last=P)}return N.tail!==null?(c=N.tail,N.rendering=c,N.tail=c.sibling,N.renderingStartTime=ze(),c.sibling=null,o=ir.current,M(ir,x?o&1|2:o&1),c):(Pn(c),null);case 22:case 23:return Xa(c),vp(),x=c.memoizedState!==null,o!==null?o.memoizedState!==null!==x&&(c.flags|=8192):x&&(c.flags|=8192),x?(p&536870912)!==0&&(c.flags&128)===0&&(Pn(c),c.subtreeFlags&6&&(c.flags|=8192)):Pn(c),p=c.updateQueue,p!==null&&Uf(c,p.retryQueue),p=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),x=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(x=c.memoizedState.cachePool.pool),x!==p&&(c.flags|=2048),o!==null&&ue(ml),null;case 24:return p=null,o!==null&&(p=o.memoizedState.cache),c.memoizedState.cache!==p&&(c.flags|=2048),Qi(An),Pn(c),null;case 25:return null;case 30:return null}throw Error(r(156,c.tag))}function fy(o,c){switch(Nu(c),c.tag){case 1:return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 3:return Qi(An),Me(),o=c.flags,(o&65536)!==0&&(o&128)===0?(c.flags=o&-65537|128,c):null;case 26:case 27:case 5:return Fe(c),null;case 13:if(Xa(c),o=c.memoizedState,o!==null&&o.dehydrated!==null){if(c.alternate===null)throw Error(r(340));ju()}return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 19:return ue(ir),null;case 4:return Me(),null;case 10:return Qi(c.type),null;case 22:case 23:return Xa(c),vp(),o!==null&&ue(ml),o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 24:return Qi(An),null;case 25:return null;default:return null}}function hy(o,c){switch(Nu(c),c.tag){case 3:Qi(An),Me();break;case 26:case 27:case 5:Fe(c);break;case 4:Me();break;case 13:Xa(c);break;case 19:ue(ir);break;case 10:Qi(c.type);break;case 22:case 23:Xa(c),vp(),o!==null&&ue(ml);break;case 24:Qi(An)}}function Xu(o,c){try{var p=c.updateQueue,x=p!==null?p.lastEffect:null;if(x!==null){var N=x.next;p=N;do{if((p.tag&o)===o){x=void 0;var P=p.create,G=p.inst;x=P(),G.destroy=x}p=p.next}while(p!==N)}}catch(re){Dn(c,c.return,re)}}function xo(o,c,p){try{var x=c.updateQueue,N=x!==null?x.lastEffect:null;if(N!==null){var P=N.next;x=P;do{if((x.tag&o)===o){var G=x.inst,re=G.destroy;if(re!==void 0){G.destroy=void 0,N=c;var ye=p,Ae=re;try{Ae()}catch(He){Dn(N,ye,He)}}}x=x.next}while(x!==P)}}catch(He){Dn(c,c.return,He)}}function py(o){var c=o.updateQueue;if(c!==null){var p=o.stateNode;try{bp(c,p)}catch(x){Dn(o,o.return,x)}}}function Yp(o,c,p){p.props=go(o.type,o.memoizedProps),p.state=o.memoizedState;try{p.componentWillUnmount()}catch(x){Dn(o,c,x)}}function xc(o,c){try{var p=o.ref;if(p!==null){switch(o.tag){case 26:case 27:case 5:var x=o.stateNode;break;case 30:x=o.stateNode;break;default:x=o.stateNode}typeof p=="function"?o.refCleanup=p(x):p.current=x}}catch(N){Dn(o,c,N)}}function es(o,c){var p=o.ref,x=o.refCleanup;if(p!==null)if(typeof x=="function")try{x()}catch(N){Dn(o,c,N)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(N){Dn(o,c,N)}else p.current=null}function qf(o){var c=o.type,p=o.memoizedProps,x=o.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":p.autoFocus&&x.focus();break e;case"img":p.src?x.src=p.src:p.srcSet&&(x.srcset=p.srcSet)}}catch(N){Dn(o,o.return,N)}}function Vf(o,c,p){try{var x=o.stateNode;M0(x,o.type,p,c),x[Fn]=c}catch(N){Dn(o,o.return,N)}}function bc(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&ea(o.type)||o.tag===4}function Zu(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||bc(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&ea(o.type)||o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Hf(o,c,p){var x=o.tag;if(x===5||x===6)o=o.stateNode,c?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(o,c):(c=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,c.appendChild(o),p=p._reactRootContainer,p!=null||c.onclick!==null||(c.onclick=th));else if(x!==4&&(x===27&&ea(o.type)&&(p=o.stateNode,c=null),o=o.child,o!==null))for(Hf(o,c,p),o=o.sibling;o!==null;)Hf(o,c,p),o=o.sibling}function ed(o,c,p){var x=o.tag;if(x===5||x===6)o=o.stateNode,c?p.insertBefore(o,c):p.appendChild(o);else if(x!==4&&(x===27&&ea(o.type)&&(p=o.stateNode),o=o.child,o!==null))for(ed(o,c,p),o=o.sibling;o!==null;)ed(o,c,p),o=o.sibling}function td(o){var c=o.stateNode,p=o.memoizedProps;try{for(var x=o.type,N=c.attributes;N.length;)c.removeAttributeNode(N[0]);br(c,x,p),c[Xn]=o,c[Fn]=p}catch(P){Dn(o,o.return,P)}}var ts=!1,xn=!1,Ms=!1,my=typeof WeakSet=="function"?WeakSet:Set,yr=null;function v0(o,c){if(o=o.containerInfo,Ea=ch,o=af(o),rc(o)){if("selectionStart"in o)var p={start:o.selectionStart,end:o.selectionEnd};else e:{p=(p=o.ownerDocument)&&p.defaultView||window;var x=p.getSelection&&p.getSelection();if(x&&x.rangeCount!==0){p=x.anchorNode;var N=x.anchorOffset,P=x.focusNode;x=x.focusOffset;try{p.nodeType,P.nodeType}catch{p=null;break e}var G=0,re=-1,ye=-1,Ae=0,He=0,Ke=o,Oe=null;t:for(;;){for(var De;Ke!==p||N!==0&&Ke.nodeType!==3||(re=G+N),Ke!==P||x!==0&&Ke.nodeType!==3||(ye=G+x),Ke.nodeType===3&&(G+=Ke.nodeValue.length),(De=Ke.firstChild)!==null;)Oe=Ke,Ke=De;for(;;){if(Ke===o)break t;if(Oe===p&&++Ae===N&&(re=G),Oe===P&&++He===x&&(ye=G),(De=Ke.nextSibling)!==null)break;Ke=Oe,Oe=Ke.parentNode}Ke=De}p=re===-1||ye===-1?null:{start:re,end:ye}}else p=null}p=p||{start:0,end:0}}else p=null;for(nh={focusedElem:o,selectionRange:p},ch=!1,yr=c;yr!==null;)if(c=yr,o=c.child,(c.subtreeFlags&1024)!==0&&o!==null)o.return=c,yr=o;else for(;yr!==null;){switch(c=yr,P=c.alternate,o=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((o&1024)!==0&&P!==null){o=void 0,p=c,N=P.memoizedProps,P=P.memoizedState,x=p.stateNode;try{var _t=go(p.type,N,p.elementType===p.type);o=x.getSnapshotBeforeUpdate(_t,P),x.__reactInternalSnapshotBeforeUpdate=o}catch(Nt){Dn(p,p.return,Nt)}}break;case 3:if((o&1024)!==0){if(o=c.stateNode.containerInfo,p=o.nodeType,p===9)xm(o);else if(p===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":xm(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(r(163))}if(o=c.sibling,o!==null){o.return=c.return,yr=o;break}yr=c.return}}function gy(o,c,p){var x=p.flags;switch(p.tag){case 0:case 11:case 15:bo(o,p),x&4&&Xu(5,p);break;case 1:if(bo(o,p),x&4)if(o=p.stateNode,c===null)try{o.componentDidMount()}catch(G){Dn(p,p.return,G)}else{var N=go(p.type,c.memoizedProps);c=c.memoizedState;try{o.componentDidUpdate(N,c,o.__reactInternalSnapshotBeforeUpdate)}catch(G){Dn(p,p.return,G)}}x&64&&py(p),x&512&&xc(p,p.return);break;case 3:if(bo(o,p),x&64&&(o=p.updateQueue,o!==null)){if(c=null,p.child!==null)switch(p.child.tag){case 27:case 5:c=p.child.stateNode;break;case 1:c=p.child.stateNode}try{bp(o,c)}catch(G){Dn(p,p.return,G)}}break;case 27:c===null&&x&4&&td(p);case 26:case 5:bo(o,p),c===null&&x&4&&qf(p),x&512&&xc(p,p.return);break;case 12:bo(o,p);break;case 13:bo(o,p),x&4&&by(o,p),x&64&&(o=p.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(p=Jf.bind(null,p),Pc(o,p))));break;case 22:if(x=p.memoizedState!==null||ts,!x){c=c!==null&&c.memoizedState!==null||xn,N=ts;var P=xn;ts=x,(xn=c)&&!P?Os(o,p,(p.subtreeFlags&8772)!==0):bo(o,p),ts=N,xn=P}break;case 30:break;default:bo(o,p)}}function yy(o){var c=o.alternate;c!==null&&(o.alternate=null,yy(c)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(c=o.stateNode,c!==null&&nu(c)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var Hn=null,yi=!1;function Rs(o,c,p){for(p=p.child;p!==null;)xy(o,c,p),p=p.sibling}function xy(o,c,p){if(X&&typeof X.onCommitFiberUnmount=="function")try{X.onCommitFiberUnmount(Y,p)}catch{}switch(p.tag){case 26:xn||es(p,c),Rs(o,c,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:xn||es(p,c);var x=Hn,N=yi;ea(p.type)&&(Hn=p.stateNode,yi=!1),Rs(o,c,p),fd(p.stateNode),Hn=x,yi=N;break;case 5:xn||es(p,c);case 6:if(x=Hn,N=yi,Hn=null,Rs(o,c,p),Hn=x,yi=N,Hn!==null)if(yi)try{(Hn.nodeType===9?Hn.body:Hn.nodeName==="HTML"?Hn.ownerDocument.body:Hn).removeChild(p.stateNode)}catch(P){Dn(p,c,P)}else try{Hn.removeChild(p.stateNode)}catch(P){Dn(p,c,P)}break;case 18:Hn!==null&&(yi?(o=Hn,ih(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,p.stateNode),vd(o)):ih(Hn,p.stateNode));break;case 4:x=Hn,N=yi,Hn=p.stateNode.containerInfo,yi=!0,Rs(o,c,p),Hn=x,yi=N;break;case 0:case 11:case 14:case 15:xn||xo(2,p,c),xn||xo(4,p,c),Rs(o,c,p);break;case 1:xn||(es(p,c),x=p.stateNode,typeof x.componentWillUnmount=="function"&&Yp(p,c,x)),Rs(o,c,p);break;case 21:Rs(o,c,p);break;case 22:xn=(x=xn)||p.memoizedState!==null,Rs(o,c,p),xn=x;break;default:Rs(o,c,p)}}function by(o,c){if(c.memoizedState===null&&(o=c.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{vd(o)}catch(p){Dn(c,c.return,p)}}function w0(o){switch(o.tag){case 13:case 19:var c=o.stateNode;return c===null&&(c=o.stateNode=new my),c;case 22:return o=o.stateNode,c=o._retryCache,c===null&&(c=o._retryCache=new my),c;default:throw Error(r(435,o.tag))}}function Wp(o,c){var p=w0(o);c.forEach(function(x){var N=k0.bind(null,o,x);p.has(x)||(p.add(x),x.then(N,N))})}function Mi(o,c){var p=c.deletions;if(p!==null)for(var x=0;x<p.length;x++){var N=p[x],P=o,G=c,re=G;e:for(;re!==null;){switch(re.tag){case 27:if(ea(re.type)){Hn=re.stateNode,yi=!1;break e}break;case 5:Hn=re.stateNode,yi=!1;break e;case 3:case 4:Hn=re.stateNode.containerInfo,yi=!0;break e}re=re.return}if(Hn===null)throw Error(r(160));xy(P,G,N),Hn=null,yi=!1,P=N.alternate,P!==null&&(P.return=null),N.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)Qp(c,o),c=c.sibling}var Xi=null;function Qp(o,c){var p=o.alternate,x=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:Mi(c,o),xi(o),x&4&&(xo(3,o,o.return),Xu(3,o),xo(5,o,o.return));break;case 1:Mi(c,o),xi(o),x&512&&(xn||p===null||es(p,p.return)),x&64&&ts&&(o=o.updateQueue,o!==null&&(x=o.callbacks,x!==null&&(p=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=p===null?x:p.concat(x))));break;case 26:var N=Xi;if(Mi(c,o),xi(o),x&512&&(xn||p===null||es(p,p.return)),x&4){var P=p!==null?p.memoizedState:null;if(x=o.memoizedState,p===null)if(x===null)if(o.stateNode===null){e:{x=o.type,p=o.memoizedProps,N=N.ownerDocument||N;t:switch(x){case"title":P=N.getElementsByTagName("title")[0],(!P||P[fs]||P[Xn]||P.namespaceURI==="http://www.w3.org/2000/svg"||P.hasAttribute("itemprop"))&&(P=N.createElement(x),N.head.insertBefore(P,N.querySelector("head > title"))),br(P,x,p),P[Xn]=o,cr(P),x=P;break e;case"link":var G=cx("link","href",N).get(x+(p.href||""));if(G){for(var re=0;re<G.length;re++)if(P=G[re],P.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&P.getAttribute("rel")===(p.rel==null?null:p.rel)&&P.getAttribute("title")===(p.title==null?null:p.title)&&P.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){G.splice(re,1);break t}}P=N.createElement(x),br(P,x,p),N.head.appendChild(P);break;case"meta":if(G=cx("meta","content",N).get(x+(p.content||""))){for(re=0;re<G.length;re++)if(P=G[re],P.getAttribute("content")===(p.content==null?null:""+p.content)&&P.getAttribute("name")===(p.name==null?null:p.name)&&P.getAttribute("property")===(p.property==null?null:p.property)&&P.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&P.getAttribute("charset")===(p.charSet==null?null:p.charSet)){G.splice(re,1);break t}}P=N.createElement(x),br(P,x,p),N.head.appendChild(P);break;default:throw Error(r(468,x))}P[Xn]=o,cr(P),x=P}o.stateNode=x}else ux(N,o.type,o.stateNode);else o.stateNode=lx(N,x,o.memoizedProps);else P!==x?(P===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):P.count--,x===null?ux(N,o.type,o.stateNode):lx(N,x,o.memoizedProps)):x===null&&o.stateNode!==null&&Vf(o,o.memoizedProps,p.memoizedProps)}break;case 27:Mi(c,o),xi(o),x&512&&(xn||p===null||es(p,p.return)),p!==null&&x&4&&Vf(o,o.memoizedProps,p.memoizedProps);break;case 5:if(Mi(c,o),xi(o),x&512&&(xn||p===null||es(p,p.return)),o.flags&32){N=o.stateNode;try{ma(N,"")}catch(De){Dn(o,o.return,De)}}x&4&&o.stateNode!=null&&(N=o.memoizedProps,Vf(o,N,p!==null?p.memoizedProps:N)),x&1024&&(Ms=!0);break;case 6:if(Mi(c,o),xi(o),x&4){if(o.stateNode===null)throw Error(r(162));x=o.memoizedProps,p=o.stateNode;try{p.nodeValue=x}catch(De){Dn(o,o.return,De)}}break;case 3:if(Rc=null,N=Xi,Xi=Ft(c.containerInfo),Mi(c,o),Xi=N,xi(o),x&4&&p!==null&&p.memoizedState.isDehydrated)try{vd(c.containerInfo)}catch(De){Dn(o,o.return,De)}Ms&&(Ms=!1,vy(o));break;case 4:x=Xi,Xi=Ft(o.stateNode.containerInfo),Mi(c,o),xi(o),Xi=x;break;case 12:Mi(c,o),xi(o);break;case 13:Mi(c,o),xi(o),o.child.flags&8192&&o.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(nm=ze()),x&4&&(x=o.updateQueue,x!==null&&(o.updateQueue=null,Wp(o,x)));break;case 22:N=o.memoizedState!==null;var ye=p!==null&&p.memoizedState!==null,Ae=ts,He=xn;if(ts=Ae||N,xn=He||ye,Mi(c,o),xn=He,ts=Ae,xi(o),x&8192)e:for(c=o.stateNode,c._visibility=N?c._visibility&-2:c._visibility|1,N&&(p===null||ye||ts||xn||kl(o)),p=null,c=o;;){if(c.tag===5||c.tag===26){if(p===null){ye=p=c;try{if(P=ye.stateNode,N)G=P.style,typeof G.setProperty=="function"?G.setProperty("display","none","important"):G.display="none";else{re=ye.stateNode;var Ke=ye.memoizedProps.style,Oe=Ke!=null&&Ke.hasOwnProperty("display")?Ke.display:null;re.style.display=Oe==null||typeof Oe=="boolean"?"":(""+Oe).trim()}}catch(De){Dn(ye,ye.return,De)}}}else if(c.tag===6){if(p===null){ye=c;try{ye.stateNode.nodeValue=N?"":ye.memoizedProps}catch(De){Dn(ye,ye.return,De)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===o)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break e;for(;c.sibling===null;){if(c.return===null||c.return===o)break e;p===c&&(p=null),c=c.return}p===c&&(p=null),c.sibling.return=c.return,c=c.sibling}x&4&&(x=o.updateQueue,x!==null&&(p=x.retryQueue,p!==null&&(x.retryQueue=null,Wp(o,p))));break;case 19:Mi(c,o),xi(o),x&4&&(x=o.updateQueue,x!==null&&(o.updateQueue=null,Wp(o,x)));break;case 30:break;case 21:break;default:Mi(c,o),xi(o)}}function xi(o){var c=o.flags;if(c&2){try{for(var p,x=o.return;x!==null;){if(bc(x)){p=x;break}x=x.return}if(p==null)throw Error(r(160));switch(p.tag){case 27:var N=p.stateNode,P=Zu(o);ed(o,P,N);break;case 5:var G=p.stateNode;p.flags&32&&(ma(G,""),p.flags&=-33);var re=Zu(o);ed(o,re,G);break;case 3:case 4:var ye=p.stateNode.containerInfo,Ae=Zu(o);Hf(o,Ae,ye);break;default:throw Error(r(161))}}catch(He){Dn(o,o.return,He)}o.flags&=-3}c&4096&&(o.flags&=-4097)}function vy(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var c=o;vy(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),o=o.sibling}}function bo(o,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)gy(o,c.alternate,c),c=c.sibling}function kl(o){for(o=o.child;o!==null;){var c=o;switch(c.tag){case 0:case 11:case 14:case 15:xo(4,c,c.return),kl(c);break;case 1:es(c,c.return);var p=c.stateNode;typeof p.componentWillUnmount=="function"&&Yp(c,c.return,p),kl(c);break;case 27:fd(c.stateNode);case 26:case 5:es(c,c.return),kl(c);break;case 22:c.memoizedState===null&&kl(c);break;case 30:kl(c);break;default:kl(c)}o=o.sibling}}function Os(o,c,p){for(p=p&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var x=c.alternate,N=o,P=c,G=P.flags;switch(P.tag){case 0:case 11:case 15:Os(N,P,p),Xu(4,P);break;case 1:if(Os(N,P,p),x=P,N=x.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(Ae){Dn(x,x.return,Ae)}if(x=P,N=x.updateQueue,N!==null){var re=x.stateNode;try{var ye=N.shared.hiddenCallbacks;if(ye!==null)for(N.shared.hiddenCallbacks=null,N=0;N<ye.length;N++)$g(ye[N],re)}catch(Ae){Dn(x,x.return,Ae)}}p&&G&64&&py(P),xc(P,P.return);break;case 27:td(P);case 26:case 5:Os(N,P,p),p&&x===null&&G&4&&qf(P),xc(P,P.return);break;case 12:Os(N,P,p);break;case 13:Os(N,P,p),p&&G&4&&by(N,P);break;case 22:P.memoizedState===null&&Os(N,P,p),xc(P,P.return);break;case 30:break;default:Os(N,P,p)}c=c.sibling}}function Jp(o,c){var p=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),o=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(o=c.memoizedState.cachePool.pool),o!==p&&(o!=null&&o.refCount++,p!=null&&ku(p))}function Kp(o,c){o=null,c.alternate!==null&&(o=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==o&&(c.refCount++,o!=null&&ku(o))}function ns(o,c,p,x){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)wy(o,c,p,x),c=c.sibling}function wy(o,c,p,x){var N=c.flags;switch(c.tag){case 0:case 11:case 15:ns(o,c,p,x),N&2048&&Xu(9,c);break;case 1:ns(o,c,p,x);break;case 3:ns(o,c,p,x),N&2048&&(o=null,c.alternate!==null&&(o=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==o&&(c.refCount++,o!=null&&ku(o)));break;case 12:if(N&2048){ns(o,c,p,x),o=c.stateNode;try{var P=c.memoizedProps,G=P.id,re=P.onPostCommit;typeof re=="function"&&re(G,c.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(ye){Dn(c,c.return,ye)}}else ns(o,c,p,x);break;case 13:ns(o,c,p,x);break;case 23:break;case 22:P=c.stateNode,G=c.alternate,c.memoizedState!==null?P._visibility&2?ns(o,c,p,x):nd(o,c):P._visibility&2?ns(o,c,p,x):(P._visibility|=2,vc(o,c,p,x,(c.subtreeFlags&10256)!==0)),N&2048&&Jp(G,c);break;case 24:ns(o,c,p,x),N&2048&&Kp(c.alternate,c);break;default:ns(o,c,p,x)}}function vc(o,c,p,x,N){for(N=N&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var P=o,G=c,re=p,ye=x,Ae=G.flags;switch(G.tag){case 0:case 11:case 15:vc(P,G,re,ye,N),Xu(8,G);break;case 23:break;case 22:var He=G.stateNode;G.memoizedState!==null?He._visibility&2?vc(P,G,re,ye,N):nd(P,G):(He._visibility|=2,vc(P,G,re,ye,N)),N&&Ae&2048&&Jp(G.alternate,G);break;case 24:vc(P,G,re,ye,N),N&&Ae&2048&&Kp(G.alternate,G);break;default:vc(P,G,re,ye,N)}c=c.sibling}}function nd(o,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var p=o,x=c,N=x.flags;switch(x.tag){case 22:nd(p,x),N&2048&&Jp(x.alternate,x);break;case 24:nd(p,x),N&2048&&Kp(x.alternate,x);break;default:nd(p,x)}c=c.sibling}}var zr=8192;function wc(o){if(o.subtreeFlags&zr)for(o=o.child;o!==null;)Sy(o),o=o.sibling}function Sy(o){switch(o.tag){case 26:wc(o),o.flags&zr&&o.memoizedState!==null&&G0(Xi,o.memoizedState,o.memoizedProps);break;case 5:wc(o);break;case 3:case 4:var c=Xi;Xi=Ft(o.stateNode.containerInfo),wc(o),Xi=c;break;case 22:o.memoizedState===null&&(c=o.alternate,c!==null&&c.memoizedState!==null?(c=zr,zr=16777216,wc(o),zr=c):wc(o));break;default:wc(o)}}function Ny(o){var c=o.alternate;if(c!==null&&(o=c.child,o!==null)){c.child=null;do c=o.sibling,o.sibling=null,o=c;while(o!==null)}}function Sc(o){var c=o.deletions;if((o.flags&16)!==0){if(c!==null)for(var p=0;p<c.length;p++){var x=c[p];yr=x,jy(x,o)}Ny(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Cy(o),o=o.sibling}function Cy(o){switch(o.tag){case 0:case 11:case 15:Sc(o),o.flags&2048&&xo(9,o,o.return);break;case 3:Sc(o);break;case 12:Sc(o);break;case 22:var c=o.stateNode;o.memoizedState!==null&&c._visibility&2&&(o.return===null||o.return.tag!==13)?(c._visibility&=-3,Gf(o)):Sc(o);break;default:Sc(o)}}function Gf(o){var c=o.deletions;if((o.flags&16)!==0){if(c!==null)for(var p=0;p<c.length;p++){var x=c[p];yr=x,jy(x,o)}Ny(o)}for(o=o.child;o!==null;){switch(c=o,c.tag){case 0:case 11:case 15:xo(8,c,c.return),Gf(c);break;case 22:p=c.stateNode,p._visibility&2&&(p._visibility&=-3,Gf(c));break;default:Gf(c)}o=o.sibling}}function jy(o,c){for(;yr!==null;){var p=yr;switch(p.tag){case 0:case 11:case 15:xo(8,p,c);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var x=p.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:ku(p.memoizedState.cache)}if(x=p.child,x!==null)x.return=p,yr=x;else e:for(p=o;yr!==null;){x=yr;var N=x.sibling,P=x.return;if(yy(x),x===p){yr=null;break e}if(N!==null){N.return=P,yr=N;break e}yr=P}}}var S0={getCacheForType:function(o){var c=rr(An),p=c.data.get(o);return p===void 0&&(p=o(),c.data.set(o,p)),p}},Xp=typeof WeakMap=="function"?WeakMap:Map,vn=0,Rn=null,Jt=null,on=0,wn=0,Ri=null,vo=!1,Nc=!1,Zp=!1,Ls=0,ar=0,wo=0,El=0,em=0,Zi=0,Cc=0,rd=null,bi=null,tm=!1,nm=0,jc=1/0,id=null,So=null,Ir=0,No=null,_c=null,kc=0,rm=0,im=null,_y=null,Ec=0,am=null;function Br(){if((vn&2)!==0&&on!==0)return on&-on;if(Z.T!==null){var o=cc;return o!==0?o:Zf()}return fa()}function ky(){Zi===0&&(Zi=(on&536870912)===0||Zt?bt():536870912);var o=Ii.current;return o!==null&&(o.flags|=32),Zi}function Oi(o,c,p){(o===Rn&&(wn===2||wn===9)||o.cancelPendingCommit!==null)&&(Tc(o,0),Co(o,on,Zi,!1)),jn(o,p),((vn&2)===0||o!==Rn)&&(o===Rn&&((vn&2)===0&&(El|=p),ar===4&&Co(o,on,Zi,!1)),rs(o))}function Ey(o,c,p){if((vn&6)!==0)throw Error(r(327));var x=!p&&(c&124)===0&&(c&o.expiredLanes)===0||ot(o,c),N=x?j0(o,c):lm(o,c,!0),P=x;do{if(N===0){Nc&&!x&&Co(o,c,0,!1);break}else{if(p=o.current.alternate,P&&!N0(p)){N=lm(o,c,!1),P=!1;continue}if(N===2){if(P=c,o.errorRecoveryDisabledLanes&P)var G=0;else G=o.pendingLanes&-536870913,G=G!==0?G:G&536870912?536870912:0;if(G!==0){c=G;e:{var re=o;N=rd;var ye=re.current.memoizedState.isDehydrated;if(ye&&(Tc(re,G).flags|=256),G=lm(re,G,!1),G!==2){if(Zp&&!ye){re.errorRecoveryDisabledLanes|=P,El|=P,N=4;break e}P=bi,bi=N,P!==null&&(bi===null?bi=P:bi.push.apply(bi,P))}N=G}if(P=!1,N!==2)continue}}if(N===1){Tc(o,0),Co(o,c,0,!0);break}e:{switch(x=o,P=N,P){case 0:case 1:throw Error(r(345));case 4:if((c&4194048)!==c)break;case 6:Co(x,c,Zi,!vo);break e;case 2:bi=null;break;case 3:case 5:break;default:throw Error(r(329))}if((c&62914560)===c&&(N=nm+300-ze(),10<N)){if(Co(x,c,Zi,!vo),Le(x,0,!0)!==0)break e;x.timeoutHandle=Xy(Ty.bind(null,x,p,bi,id,tm,c,Zi,El,Cc,vo,P,2,-0,0),N);break e}Ty(x,p,bi,id,tm,c,Zi,El,Cc,vo,P,0,-0,0)}}break}while(!0);rs(o)}function Ty(o,c,p,x,N,P,G,re,ye,Ae,He,Ke,Oe,De){if(o.timeoutHandle=-1,Ke=c.subtreeFlags,(Ke&8192||(Ke&16785408)===16785408)&&(_r={stylesheets:null,count:0,unsuspend:H0},Sy(c),Ke=Y0(),Ke!==null)){o.cancelPendingCommit=Ke(ad.bind(null,o,c,P,p,x,N,G,re,ye,He,1,Oe,De)),Co(o,P,G,!Ae);return}ad(o,c,P,p,x,N,G,re,ye)}function N0(o){for(var c=o;;){var p=c.tag;if((p===0||p===11||p===15)&&c.flags&16384&&(p=c.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var x=0;x<p.length;x++){var N=p[x],P=N.getSnapshot;N=N.value;try{if(!Yr(P(),N))return!1}catch{return!1}}if(p=c.child,c.subtreeFlags&16384&&p!==null)p.return=c,c=p;else{if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Co(o,c,p,x){c&=~em,c&=~El,o.suspendedLanes|=c,o.pingedLanes&=~c,x&&(o.warmLanes|=c),x=o.expirationTimes;for(var N=c;0<N;){var P=31-ke(N),G=1<<P;x[P]=-1,N&=~G}p!==0&&dn(o,p,c)}function Yf(){return(vn&6)===0?(ld(0),!1):!0}function sm(){if(Jt!==null){if(wn===0)var o=Jt.return;else o=Jt,ne=uo=null,xf(o),gr=null,gi=0,o=Jt;for(;o!==null;)hy(o.alternate,o),o=o.return;Jt=null}}function Tc(o,c){var p=o.timeoutHandle;p!==-1&&(o.timeoutHandle=-1,O0(p)),p=o.cancelPendingCommit,p!==null&&(o.cancelPendingCommit=null,p()),sm(),Rn=o,Jt=p=Qr(o.current,null),on=c,wn=0,Ri=null,vo=!1,Nc=ot(o,c),Zp=!1,Cc=Zi=em=El=wo=ar=0,bi=rd=null,tm=!1,(c&8)!==0&&(c|=c&32);var x=o.entangledLanes;if(x!==0)for(o=o.entanglements,x&=c;0<x;){var N=31-ke(x),P=1<<N;c|=o[N],x&=~P}return Ls=c,ol(),p}function Ay(o,c){qt=null,Z.H=Uu,c===Jr||c===mf?(c=Lg(),wn=3):c===Rg?(c=Lg(),wn=4):wn=c===oy?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,Ri=c,Jt===null&&(ar=1,Yu(o,Wr(c,o.current)))}function Py(){var o=Z.H;return Z.H=Uu,o===null?Uu:o}function Dy(){var o=Z.A;return Z.A=S0,o}function om(){ar=4,vo||(on&4194048)!==on&&Ii.current!==null||(Nc=!0),(wo&134217727)===0&&(El&134217727)===0||Rn===null||Co(Rn,on,Zi,!1)}function lm(o,c,p){var x=vn;vn|=2;var N=Py(),P=Dy();(Rn!==o||on!==c)&&(id=null,Tc(o,c)),c=!1;var G=ar;e:do try{if(wn!==0&&Jt!==null){var re=Jt,ye=Ri;switch(wn){case 8:sm(),G=6;break e;case 3:case 2:case 9:case 6:Ii.current===null&&(c=!0);var Ae=wn;if(wn=0,Ri=null,Ac(o,re,ye,Ae),p&&Nc){G=0;break e}break;default:Ae=wn,wn=0,Ri=null,Ac(o,re,ye,Ae)}}C0(),G=ar;break}catch(He){Ay(o,He)}while(!0);return c&&o.shellSuspendCounter++,ne=uo=null,vn=x,Z.H=N,Z.A=P,Jt===null&&(Rn=null,on=0,ol()),G}function C0(){for(;Jt!==null;)cm(Jt)}function j0(o,c){var p=vn;vn|=2;var x=Py(),N=Dy();Rn!==o||on!==c?(id=null,jc=ze()+500,Tc(o,c)):Nc=ot(o,c);e:do try{if(wn!==0&&Jt!==null){c=Jt;var P=Ri;t:switch(wn){case 1:wn=0,Ri=null,Ac(o,c,P,1);break;case 2:case 9:if(Og(P)){wn=0,Ri=null,My(c);break}c=function(){wn!==2&&wn!==9||Rn!==o||(wn=7),rs(o)},P.then(c,c);break e;case 3:wn=7;break e;case 4:wn=5;break e;case 7:Og(P)?(wn=0,Ri=null,My(c)):(wn=0,Ri=null,Ac(o,c,P,7));break;case 5:var G=null;switch(Jt.tag){case 26:G=Jt.memoizedState;case 5:case 27:var re=Jt;if(!G||vr(G)){wn=0,Ri=null;var ye=re.sibling;if(ye!==null)Jt=ye;else{var Ae=re.return;Ae!==null?(Jt=Ae,Wf(Ae)):Jt=null}break t}}wn=0,Ri=null,Ac(o,c,P,5);break;case 6:wn=0,Ri=null,Ac(o,c,P,6);break;case 8:sm(),ar=6;break e;default:throw Error(r(462))}}Iy();break}catch(He){Ay(o,He)}while(!0);return ne=uo=null,Z.H=x,Z.A=N,vn=p,Jt!==null?0:(Rn=null,on=0,ol(),ar)}function Iy(){for(;Jt!==null&&!Ie();)cm(Jt)}function cm(o){var c=zf(o.alternate,o,Ls);o.memoizedProps=o.pendingProps,c===null?Wf(o):Jt=c}function My(o){var c=o,p=c.alternate;switch(c.tag){case 15:case 0:c=Ff(p,c,c.pendingProps,c.type,void 0,on);break;case 11:c=Ff(p,c,c.pendingProps,c.type.render,c.ref,on);break;case 5:xf(c);default:hy(p,c),c=Jt=wu(c,Ls),c=zf(p,c,Ls)}o.memoizedProps=o.pendingProps,c===null?Wf(o):Jt=c}function Ac(o,c,p,x){ne=uo=null,xf(c),gr=null,gi=0;var N=c.return;try{if(sy(o,N,c,p,on)){ar=1,Yu(o,Wr(p,o.current)),Jt=null;return}}catch(P){if(N!==null)throw Jt=N,P;ar=1,Yu(o,Wr(p,o.current)),Jt=null;return}c.flags&32768?(Zt||x===1?o=!0:Nc||(on&536870912)!==0?o=!1:(vo=o=!0,(x===2||x===9||x===3||x===6)&&(x=Ii.current,x!==null&&x.tag===13&&(x.flags|=16384))),Ry(c,o)):Wf(c)}function Wf(o){var c=o;do{if((c.flags&32768)!==0){Ry(c,vo);return}o=c.return;var p=dy(c.alternate,c,Ls);if(p!==null){Jt=p;return}if(c=c.sibling,c!==null){Jt=c;return}Jt=c=o}while(c!==null);ar===0&&(ar=5)}function Ry(o,c){do{var p=fy(o.alternate,o);if(p!==null){p.flags&=32767,Jt=p;return}if(p=o.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!c&&(o=o.sibling,o!==null)){Jt=o;return}Jt=o=p}while(o!==null);ar=6,Jt=null}function ad(o,c,p,x,N,P,G,re,ye){o.cancelPendingCommit=null;do Qf();while(Ir!==0);if((vn&6)!==0)throw Error(r(327));if(c!==null){if(c===o.current)throw Error(r(177));if(P=c.lanes|c.childLanes,P|=dp,gn(o,p,P,G,re,ye),o===Rn&&(Jt=Rn=null,on=0),_c=c,No=o,kc=p,rm=P,im=N,_y=x,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,qy(ve,function(){return zy(),null})):(o.callbackNode=null,o.callbackPriority=0),x=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||x){x=Z.T,Z.T=null,N=B.p,B.p=2,G=vn,vn|=4;try{v0(o,c,p)}finally{vn=G,B.p=N,Z.T=x}}Ir=1,Oy(),Ly(),Fy()}}function Oy(){if(Ir===1){Ir=0;var o=No,c=_c,p=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||p){p=Z.T,Z.T=null;var x=B.p;B.p=2;var N=vn;vn|=4;try{Qp(c,o);var P=nh,G=af(o.containerInfo),re=P.focusedElem,ye=P.selectionRange;if(G!==re&&re&&re.ownerDocument&&rf(re.ownerDocument.documentElement,re)){if(ye!==null&&rc(re)){var Ae=ye.start,He=ye.end;if(He===void 0&&(He=Ae),"selectionStart"in re)re.selectionStart=Ae,re.selectionEnd=Math.min(He,re.value.length);else{var Ke=re.ownerDocument||document,Oe=Ke&&Ke.defaultView||window;if(Oe.getSelection){var De=Oe.getSelection(),_t=re.textContent.length,Nt=Math.min(ye.start,_t),kn=ye.end===void 0?Nt:Math.min(ye.end,_t);!De.extend&&Nt>kn&&(G=kn,kn=Nt,Nt=G);var je=gu(re,Nt),Se=gu(re,kn);if(je&&Se&&(De.rangeCount!==1||De.anchorNode!==je.node||De.anchorOffset!==je.offset||De.focusNode!==Se.node||De.focusOffset!==Se.offset)){var Te=Ke.createRange();Te.setStart(je.node,je.offset),De.removeAllRanges(),Nt>kn?(De.addRange(Te),De.extend(Se.node,Se.offset)):(Te.setEnd(Se.node,Se.offset),De.addRange(Te))}}}}for(Ke=[],De=re;De=De.parentNode;)De.nodeType===1&&Ke.push({element:De,left:De.scrollLeft,top:De.scrollTop});for(typeof re.focus=="function"&&re.focus(),re=0;re<Ke.length;re++){var Ye=Ke[re];Ye.element.scrollLeft=Ye.left,Ye.element.scrollTop=Ye.top}}ch=!!Ea,nh=Ea=null}finally{vn=N,B.p=x,Z.T=p}}o.current=c,Ir=2}}function Ly(){if(Ir===2){Ir=0;var o=No,c=_c,p=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||p){p=Z.T,Z.T=null;var x=B.p;B.p=2;var N=vn;vn|=4;try{gy(o,c.alternate,c)}finally{vn=N,B.p=x,Z.T=p}}Ir=3}}function Fy(){if(Ir===4||Ir===3){Ir=0,Ge();var o=No,c=_c,p=kc,x=_y;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Ir=5:(Ir=0,_c=No=null,$y(o,o.pendingLanes));var N=o.pendingLanes;if(N===0&&(So=null),ri(p),c=c.stateNode,X&&typeof X.onCommitFiberRoot=="function")try{X.onCommitFiberRoot(Y,c,void 0,(c.current.flags&128)===128)}catch{}if(x!==null){c=Z.T,N=B.p,B.p=2,Z.T=null;try{for(var P=o.onRecoverableError,G=0;G<x.length;G++){var re=x[G];P(re.value,{componentStack:re.stack})}}finally{Z.T=c,B.p=N}}(kc&3)!==0&&Qf(),rs(o),N=o.pendingLanes,(p&4194090)!==0&&(N&42)!==0?o===am?Ec++:(Ec=0,am=o):Ec=0,ld(0)}}function $y(o,c){(o.pooledCacheLanes&=c)===0&&(c=o.pooledCache,c!=null&&(o.pooledCache=null,ku(c)))}function Qf(o){return Oy(),Ly(),Fy(),zy()}function zy(){if(Ir!==5)return!1;var o=No,c=rm;rm=0;var p=ri(kc),x=Z.T,N=B.p;try{B.p=32>p?32:p,Z.T=null,p=im,im=null;var P=No,G=kc;if(Ir=0,_c=No=null,kc=0,(vn&6)!==0)throw Error(r(331));var re=vn;if(vn|=4,Cy(P.current),wy(P,P.current,G,p),vn=re,ld(0,!1),X&&typeof X.onPostCommitFiberRoot=="function")try{X.onPostCommitFiberRoot(Y,P)}catch{}return!0}finally{B.p=N,Z.T=x,$y(o,c)}}function By(o,c,p){c=Wr(p,c),c=Mf(o.stateNode,c,2),o=ks(o,c,2),o!==null&&(jn(o,2),rs(o))}function Dn(o,c,p){if(o.tag===3)By(o,o,p);else for(;c!==null;){if(c.tag===3){By(c,o,p);break}else if(c.tag===1){var x=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(So===null||!So.has(x))){o=Wr(p,o),p=Up(2),x=ks(c,p,2),x!==null&&(ay(p,x,c,o),jn(x,2),rs(x));break}}c=c.return}}function um(o,c,p){var x=o.pingCache;if(x===null){x=o.pingCache=new Xp;var N=new Set;x.set(c,N)}else N=x.get(c),N===void 0&&(N=new Set,x.set(c,N));N.has(p)||(Zp=!0,N.add(p),o=_0.bind(null,o,c,p),c.then(o,o))}function _0(o,c,p){var x=o.pingCache;x!==null&&x.delete(c),o.pingedLanes|=o.suspendedLanes&p,o.warmLanes&=~p,Rn===o&&(on&p)===p&&(ar===4||ar===3&&(on&62914560)===on&&300>ze()-nm?(vn&2)===0&&Tc(o,0):em|=p,Cc===on&&(Cc=0)),rs(o)}function Uy(o,c){c===0&&(c=Un()),o=ll(o,c),o!==null&&(jn(o,c),rs(o))}function Jf(o){var c=o.memoizedState,p=0;c!==null&&(p=c.retryLane),Uy(o,p)}function k0(o,c){var p=0;switch(o.tag){case 13:var x=o.stateNode,N=o.memoizedState;N!==null&&(p=N.retryLane);break;case 19:x=o.stateNode;break;case 22:x=o.stateNode._retryCache;break;default:throw Error(r(314))}x!==null&&x.delete(c),Uy(o,p)}function qy(o,c){return Re(o,c)}var sd=null,jo=null,Kf=!1,od=!1,Xf=!1,_o=0;function rs(o){o!==jo&&o.next===null&&(jo===null?sd=jo=o:jo=jo.next=o),od=!0,Kf||(Kf=!0,dm())}function ld(o,c){if(!Xf&&od){Xf=!0;do for(var p=!1,x=sd;x!==null;){if(o!==0){var N=x.pendingLanes;if(N===0)var P=0;else{var G=x.suspendedLanes,re=x.pingedLanes;P=(1<<31-ke(42|o)+1)-1,P&=N&~(G&~re),P=P&201326741?P&201326741|1:P?P|2:0}P!==0&&(p=!0,Hy(x,P))}else P=on,P=Le(x,x===Rn?P:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(P&3)===0||ot(x,P)||(p=!0,Hy(x,P));x=x.next}while(p);Xf=!1}}function E0(){cd()}function cd(){od=Kf=!1;var o=0;_o!==0&&(R0()&&(o=_o),_o=0);for(var c=ze(),p=null,x=sd;x!==null;){var N=x.next,P=ud(x,c);P===0?(x.next=null,p===null?sd=N:p.next=N,N===null&&(jo=p)):(p=x,(o!==0||(P&3)!==0)&&(od=!0)),x=N}ld(o)}function ud(o,c){for(var p=o.suspendedLanes,x=o.pingedLanes,N=o.expirationTimes,P=o.pendingLanes&-62914561;0<P;){var G=31-ke(P),re=1<<G,ye=N[G];ye===-1?((re&p)===0||(re&x)!==0)&&(N[G]=et(re,c)):ye<=c&&(o.expiredLanes|=re),P&=~re}if(c=Rn,p=on,p=Le(o,o===c?p:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),x=o.callbackNode,p===0||o===c&&(wn===2||wn===9)||o.cancelPendingCommit!==null)return x!==null&&x!==null&&xe(x),o.callbackNode=null,o.callbackPriority=0;if((p&3)===0||ot(o,p)){if(c=p&-p,c===o.callbackPriority)return c;switch(x!==null&&xe(x),ri(p)){case 2:case 8:p=xt;break;case 32:p=ve;break;case 268435456:p=Qe;break;default:p=ve}return x=Vy.bind(null,o),p=Re(p,x),o.callbackPriority=c,o.callbackNode=p,c}return x!==null&&x!==null&&xe(x),o.callbackPriority=2,o.callbackNode=null,2}function Vy(o,c){if(Ir!==0&&Ir!==5)return o.callbackNode=null,o.callbackPriority=0,null;var p=o.callbackNode;if(Qf()&&o.callbackNode!==p)return null;var x=on;return x=Le(o,o===Rn?x:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),x===0?null:(Ey(o,x,c),ud(o,ze()),o.callbackNode!=null&&o.callbackNode===p?Vy.bind(null,o):null)}function Hy(o,c){if(Qf())return null;Ey(o,c,!0)}function dm(){L0(function(){(vn&6)!==0?Re(jt,E0):cd()})}function Zf(){return _o===0&&(_o=bt()),_o}function Gy(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:ms(""+o)}function Yy(o,c){var p=c.ownerDocument.createElement("input");return p.name=c.name,p.value=c.value,o.id&&p.setAttribute("form",o.id),c.parentNode.insertBefore(p,c),o=new FormData(o),p.parentNode.removeChild(p),o}function T0(o,c,p,x,N){if(c==="submit"&&p&&p.stateNode===N){var P=Gy((N[Fn]||null).action),G=x.submitter;G&&(c=(c=G[Fn]||null)?Gy(c.formAction):G.getAttribute("formAction"),c!==null&&(P=c,G=null));var re=new no("action","action",null,x,N);o.push({event:re,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(_o!==0){var ye=G?Yy(N,G):new FormData(N);zu(p,{pending:!0,data:ye,method:N.method,action:P},null,ye)}}else typeof P=="function"&&(re.preventDefault(),ye=G?Yy(N,G):new FormData(N),zu(p,{pending:!0,data:ye,method:N.method,action:P},P,ye))},currentTarget:N}]})}}for(var fm=0;fm<hn.length;fm++){var hm=hn[fm],A0=hm.toLowerCase(),P0=hm[0].toUpperCase()+hm.slice(1);wa(A0,"on"+P0)}wa(ci,"onAnimationEnd"),wa(of,"onAnimationIteration"),wa(Ai,"onAnimationStart"),wa("dblclick","onDoubleClick"),wa("focusin","onFocus"),wa("focusout","onBlur"),wa(lf,"onTransitionRun"),wa(h0,"onTransitionStart"),wa(ic,"onTransitionCancel"),wa(yu,"onTransitionEnd"),Ua("onMouseEnter",["mouseout","mouseover"]),Ua("onMouseLeave",["mouseout","mouseover"]),Ua("onPointerEnter",["pointerout","pointerover"]),Ua("onPointerLeave",["pointerout","pointerover"]),hs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),hs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),hs("onBeforeInput",["compositionend","keypress","textInput","paste"]),hs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),hs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),hs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var dd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),D0=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(dd));function Wy(o,c){c=(c&4)!==0;for(var p=0;p<o.length;p++){var x=o[p],N=x.event;x=x.listeners;e:{var P=void 0;if(c)for(var G=x.length-1;0<=G;G--){var re=x[G],ye=re.instance,Ae=re.currentTarget;if(re=re.listener,ye!==P&&N.isPropagationStopped())break e;P=re,N.currentTarget=Ae;try{P(N)}catch(He){jl(He)}N.currentTarget=null,P=ye}else for(G=0;G<x.length;G++){if(re=x[G],ye=re.instance,Ae=re.currentTarget,re=re.listener,ye!==P&&N.isPropagationStopped())break e;P=re,N.currentTarget=Ae;try{P(N)}catch(He){jl(He)}N.currentTarget=null,P=ye}}}}function Kt(o,c){var p=c[ds];p===void 0&&(p=c[ds]=new Set);var x=o+"__bubble";p.has(x)||(Qy(c,o,2,!1),p.add(x))}function pm(o,c,p){var x=0;c&&(x|=4),Qy(p,o,x,c)}var vi="_reactListening"+Math.random().toString(36).slice(2);function mm(o){if(!o[vi]){o[vi]=!0,Hd.forEach(function(p){p!=="selectionchange"&&(D0.has(p)||pm(p,!1,o),pm(p,!0,o))});var c=o.nodeType===9?o:o.ownerDocument;c===null||c[vi]||(c[vi]=!0,pm("selectionchange",!1,c))}}function Qy(o,c,p,x){switch(px(c)){case 2:var N=J0;break;case 8:N=Lc;break;default:N=jm}p=N.bind(null,c,p,o),N=void 0,!to||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(N=!0),x?N!==void 0?o.addEventListener(c,p,{capture:!0,passive:N}):o.addEventListener(c,p,!0):N!==void 0?o.addEventListener(c,p,{passive:N}):o.addEventListener(c,p,!1)}function Fs(o,c,p,x,N){var P=x;if((c&1)===0&&(c&2)===0&&x!==null)e:for(;;){if(x===null)return;var G=x.tag;if(G===3||G===4){var re=x.stateNode.containerInfo;if(re===N)break;if(G===4)for(G=x.return;G!==null;){var ye=G.tag;if((ye===3||ye===4)&&G.stateNode.containerInfo===N)return;G=G.return}for(;re!==null;){if(G=Ys(re),G===null)return;if(ye=G.tag,ye===5||ye===6||ye===26||ye===27){x=P=G;continue e}re=re.parentNode}}x=x.return}eo(function(){var Ae=P,He=el(p),Ke=[];e:{var Oe=xu.get(o);if(Oe!==void 0){var De=no,_t=o;switch(o){case"keypress":if(yn(p)===0)break e;case"keydown":case"keyup":De=fu;break;case"focusin":_t="focus",De=Wa;break;case"focusout":_t="blur",De=Wa;break;case"beforeblur":case"afterblur":De=Wa;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":De=si;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":De=nl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":De=rp;break;case ci:case of:case Ai:De=Jl;break;case yu:De=ip;break;case"scroll":case"scrollend":De=lu;break;case"wheel":De=sp;break;case"copy":case"cut":case"paste":De=Qd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":De=xa;break;case"toggle":case"beforetoggle":De=ws}var Nt=(c&4)!==0,kn=!Nt&&(o==="scroll"||o==="scrollend"),je=Nt?Oe!==null?Oe+"Capture":null:Oe;Nt=[];for(var Se=Ae,Te;Se!==null;){var Ye=Se;if(Te=Ye.stateNode,Ye=Ye.tag,Ye!==5&&Ye!==26&&Ye!==27||Te===null||je===null||(Ye=tl(Se,je),Ye!=null&&Nt.push(Mt(Se,Ye,Te))),kn)break;Se=Se.return}0<Nt.length&&(Oe=new De(Oe,_t,null,p,He),Ke.push({event:Oe,listeners:Nt}))}}if((c&7)===0){e:{if(Oe=o==="mouseover"||o==="pointerover",De=o==="mouseout"||o==="pointerout",Oe&&p!==Zs&&(_t=p.relatedTarget||p.fromElement)&&(Ys(_t)||_t[za]))break e;if((De||Oe)&&(Oe=He.window===He?He:(Oe=He.ownerDocument)?Oe.defaultView||Oe.parentWindow:window,De?(_t=p.relatedTarget||p.toElement,De=Ae,_t=_t?Ys(_t):null,_t!==null&&(kn=s(_t),Nt=_t.tag,_t!==kn||Nt!==5&&Nt!==27&&Nt!==6)&&(_t=null)):(De=null,_t=Ae),De!==_t)){if(Nt=si,Ye="onMouseLeave",je="onMouseEnter",Se="mouse",(o==="pointerout"||o==="pointerover")&&(Nt=xa,Ye="onPointerLeave",je="onPointerEnter",Se="pointer"),kn=De==null?Oe:Ba(De),Te=_t==null?Oe:Ba(_t),Oe=new Nt(Ye,Se+"leave",De,p,He),Oe.target=kn,Oe.relatedTarget=Te,Ye=null,Ys(He)===Ae&&(Nt=new Nt(je,Se+"enter",_t,p,He),Nt.target=Te,Nt.relatedTarget=kn,Ye=Nt),kn=Ye,De&&_t)t:{for(Nt=De,je=_t,Se=0,Te=Nt;Te;Te=xr(Te))Se++;for(Te=0,Ye=je;Ye;Ye=xr(Ye))Te++;for(;0<Se-Te;)Nt=xr(Nt),Se--;for(;0<Te-Se;)je=xr(je),Te--;for(;Se--;){if(Nt===je||je!==null&&Nt===je.alternate)break t;Nt=xr(Nt),je=xr(je)}Nt=null}else Nt=null;De!==null&&sr(Ke,Oe,De,Nt,!1),_t!==null&&kn!==null&&sr(Ke,kn,_t,Nt,!0)}}e:{if(Oe=Ae?Ba(Ae):window,De=Oe.nodeName&&Oe.nodeName.toLowerCase(),De==="select"||De==="input"&&Oe.type==="file")var pt=Ss;else if(ec(Oe))if(Zd)pt=lp;else{pt=va;var Wt=nf}else De=Oe.nodeName,!De||De.toLowerCase()!=="input"||Oe.type!=="checkbox"&&Oe.type!=="radio"?Ae&&Zo(Ae.elementType)&&(pt=Ss):pt=nc;if(pt&&(pt=pt(o,Ae))){ao(Ke,pt,p,He);break e}Wt&&Wt(o,Oe,Ae),o==="focusout"&&Ae&&Oe.type==="number"&&Ae.memoizedProps.value!=null&&Ks(Oe,"number",Oe.value)}switch(Wt=Ae?Ba(Ae):window,o){case"focusin":(ec(Wt)||Wt.contentEditable==="true")&&(Ns=Wt,he=Ae,Q=null);break;case"focusout":Q=he=Ns=null;break;case"mousedown":ie=!0;break;case"contextmenu":case"mouseup":case"dragend":ie=!1,ce(Ke,p,He);break;case"selectionchange":if(sf)break;case"keydown":case"keyup":ce(Ke,p,He)}var yt;if(Ui)e:{switch(o){case"compositionstart":var kt="onCompositionStart";break e;case"compositionend":kt="onCompositionEnd";break e;case"compositionupdate":kt="onCompositionUpdate";break e}kt=void 0}else ba?mu(o,p)&&(kt="onCompositionEnd"):o==="keydown"&&p.keyCode===229&&(kt="onCompositionStart");kt&&(il&&p.locale!=="ko"&&(ba||kt!=="onCompositionStart"?kt==="onCompositionEnd"&&ba&&(yt=Wd()):(zi=He,Ql="value"in zi?zi.value:zi.textContent,ba=!0)),Wt=eh(Ae,kt),0<Wt.length&&(kt=new ur(kt,o,null,p,He),Ke.push({event:kt,listeners:Wt}),yt?kt.data=yt:(yt=io(p),yt!==null&&(kt.data=yt)))),(yt=qi?Kd(o,p):Xd(o,p))&&(kt=eh(Ae,"onBeforeInput"),0<kt.length&&(Wt=new ur("onBeforeInput","beforeinput",null,p,He),Ke.push({event:Wt,listeners:kt}),Wt.data=yt)),T0(Ke,o,Ae,p,He)}Wy(Ke,c)})}function Mt(o,c,p){return{instance:o,listener:c,currentTarget:p}}function eh(o,c){for(var p=c+"Capture",x=[];o!==null;){var N=o,P=N.stateNode;if(N=N.tag,N!==5&&N!==26&&N!==27||P===null||(N=tl(o,p),N!=null&&x.unshift(Mt(o,N,P)),N=tl(o,c),N!=null&&x.push(Mt(o,N,P))),o.tag===3)return x;o=o.return}return[]}function xr(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function sr(o,c,p,x,N){for(var P=c._reactName,G=[];p!==null&&p!==x;){var re=p,ye=re.alternate,Ae=re.stateNode;if(re=re.tag,ye!==null&&ye===x)break;re!==5&&re!==26&&re!==27||Ae===null||(ye=Ae,N?(Ae=tl(p,P),Ae!=null&&G.unshift(Mt(p,Ae,ye))):N||(Ae=tl(p,P),Ae!=null&&G.push(Mt(p,Ae,ye)))),p=p.return}G.length!==0&&o.push({event:c,listeners:G})}var I0=/\r\n?/g,ko=/\u0000|\uFFFD/g;function Jy(o){return(typeof o=="string"?o:""+o).replace(I0,`
`).replace(ko,"")}function Ky(o,c){return c=Jy(c),Jy(o)===c}function th(){}function _n(o,c,p,x,N,P){switch(p){case"children":typeof x=="string"?c==="body"||c==="textarea"&&x===""||ma(o,x):(typeof x=="number"||typeof x=="bigint")&&c!=="body"&&ma(o,""+x);break;case"className":Go(o,"class",x);break;case"tabIndex":Go(o,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":Go(o,p,x);break;case"style":Xo(o,x,P);break;case"data":if(c!=="object"){Go(o,"data",x);break}case"src":case"href":if(x===""&&(c!=="a"||p!=="href")){o.removeAttribute(p);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){o.removeAttribute(p);break}x=ms(""+x),o.setAttribute(p,x);break;case"action":case"formAction":if(typeof x=="function"){o.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof P=="function"&&(p==="formAction"?(c!=="input"&&_n(o,c,"name",N.name,N,null),_n(o,c,"formEncType",N.formEncType,N,null),_n(o,c,"formMethod",N.formMethod,N,null),_n(o,c,"formTarget",N.formTarget,N,null)):(_n(o,c,"encType",N.encType,N,null),_n(o,c,"method",N.method,N,null),_n(o,c,"target",N.target,N,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){o.removeAttribute(p);break}x=ms(""+x),o.setAttribute(p,x);break;case"onClick":x!=null&&(o.onclick=th);break;case"onScroll":x!=null&&Kt("scroll",o);break;case"onScrollEnd":x!=null&&Kt("scrollend",o);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(p=x.__html,p!=null){if(N.children!=null)throw Error(r(60));o.innerHTML=p}}break;case"multiple":o.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":o.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){o.removeAttribute("xlink:href");break}p=ms(""+x),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?o.setAttribute(p,""+x):o.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?o.setAttribute(p,""):o.removeAttribute(p);break;case"capture":case"download":x===!0?o.setAttribute(p,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?o.setAttribute(p,x):o.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?o.setAttribute(p,x):o.removeAttribute(p);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?o.removeAttribute(p):o.setAttribute(p,x);break;case"popover":Kt("beforetoggle",o),Kt("toggle",o),Ho(o,"popover",x);break;case"xlinkActuate":ii(o,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":ii(o,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":ii(o,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":ii(o,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":ii(o,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":ii(o,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":ii(o,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":ii(o,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":ii(o,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":Ho(o,"is",x);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=Gl.get(p)||p,Ho(o,p,x))}}function gm(o,c,p,x,N,P){switch(p){case"style":Xo(o,x,P);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(p=x.__html,p!=null){if(N.children!=null)throw Error(r(60));o.innerHTML=p}}break;case"children":typeof x=="string"?ma(o,x):(typeof x=="number"||typeof x=="bigint")&&ma(o,""+x);break;case"onScroll":x!=null&&Kt("scroll",o);break;case"onScrollEnd":x!=null&&Kt("scrollend",o);break;case"onClick":x!=null&&(o.onclick=th);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Bl.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(N=p.endsWith("Capture"),c=p.slice(2,N?p.length-7:void 0),P=o[Fn]||null,P=P!=null?P[p]:null,typeof P=="function"&&o.removeEventListener(c,P,N),typeof x=="function")){typeof P!="function"&&P!==null&&(p in o?o[p]=null:o.hasAttribute(p)&&o.removeAttribute(p)),o.addEventListener(c,x,N);break e}p in o?o[p]=x:x===!0?o.setAttribute(p,""):Ho(o,p,x)}}}function br(o,c,p){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Kt("error",o),Kt("load",o);var x=!1,N=!1,P;for(P in p)if(p.hasOwnProperty(P)){var G=p[P];if(G!=null)switch(P){case"src":x=!0;break;case"srcSet":N=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:_n(o,c,P,G,p,null)}}N&&_n(o,c,"srcSet",p.srcSet,p,null),x&&_n(o,c,"src",p.src,p,null);return;case"input":Kt("invalid",o);var re=P=G=N=null,ye=null,Ae=null;for(x in p)if(p.hasOwnProperty(x)){var He=p[x];if(He!=null)switch(x){case"name":N=He;break;case"type":G=He;break;case"checked":ye=He;break;case"defaultChecked":Ae=He;break;case"value":P=He;break;case"defaultValue":re=He;break;case"children":case"dangerouslySetInnerHTML":if(He!=null)throw Error(r(137,c));break;default:_n(o,c,x,He,p,null)}}Hl(o,P,re,ye,Ae,G,N,!1),Qo(o);return;case"select":Kt("invalid",o),x=G=P=null;for(N in p)if(p.hasOwnProperty(N)&&(re=p[N],re!=null))switch(N){case"value":P=re;break;case"defaultValue":G=re;break;case"multiple":x=re;default:_n(o,c,N,re,p,null)}c=P,p=G,o.multiple=!!x,c!=null?pa(o,!!x,c,!1):p!=null&&pa(o,!!x,p,!0);return;case"textarea":Kt("invalid",o),P=N=x=null;for(G in p)if(p.hasOwnProperty(G)&&(re=p[G],re!=null))switch(G){case"value":x=re;break;case"defaultValue":N=re;break;case"children":P=re;break;case"dangerouslySetInnerHTML":if(re!=null)throw Error(r(91));break;default:_n(o,c,G,re,p,null)}ps(o,x,N,P),Qo(o);return;case"option":for(ye in p)if(p.hasOwnProperty(ye)&&(x=p[ye],x!=null))switch(ye){case"selected":o.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:_n(o,c,ye,x,p,null)}return;case"dialog":Kt("beforetoggle",o),Kt("toggle",o),Kt("cancel",o),Kt("close",o);break;case"iframe":case"object":Kt("load",o);break;case"video":case"audio":for(x=0;x<dd.length;x++)Kt(dd[x],o);break;case"image":Kt("error",o),Kt("load",o);break;case"details":Kt("toggle",o);break;case"embed":case"source":case"link":Kt("error",o),Kt("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ae in p)if(p.hasOwnProperty(Ae)&&(x=p[Ae],x!=null))switch(Ae){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:_n(o,c,Ae,x,p,null)}return;default:if(Zo(c)){for(He in p)p.hasOwnProperty(He)&&(x=p[He],x!==void 0&&gm(o,c,He,x,p,void 0));return}}for(re in p)p.hasOwnProperty(re)&&(x=p[re],x!=null&&_n(o,c,re,x,p,null))}function M0(o,c,p,x){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var N=null,P=null,G=null,re=null,ye=null,Ae=null,He=null;for(De in p){var Ke=p[De];if(p.hasOwnProperty(De)&&Ke!=null)switch(De){case"checked":break;case"value":break;case"defaultValue":ye=Ke;default:x.hasOwnProperty(De)||_n(o,c,De,null,x,Ke)}}for(var Oe in x){var De=x[Oe];if(Ke=p[Oe],x.hasOwnProperty(Oe)&&(De!=null||Ke!=null))switch(Oe){case"type":P=De;break;case"name":N=De;break;case"checked":Ae=De;break;case"defaultChecked":He=De;break;case"value":G=De;break;case"defaultValue":re=De;break;case"children":case"dangerouslySetInnerHTML":if(De!=null)throw Error(r(137,c));break;default:De!==Ke&&_n(o,c,Oe,De,x,Ke)}}Jo(o,G,re,ye,Ae,He,P,N);return;case"select":De=G=re=Oe=null;for(P in p)if(ye=p[P],p.hasOwnProperty(P)&&ye!=null)switch(P){case"value":break;case"multiple":De=ye;default:x.hasOwnProperty(P)||_n(o,c,P,null,x,ye)}for(N in x)if(P=x[N],ye=p[N],x.hasOwnProperty(N)&&(P!=null||ye!=null))switch(N){case"value":Oe=P;break;case"defaultValue":re=P;break;case"multiple":G=P;default:P!==ye&&_n(o,c,N,P,x,ye)}c=re,p=G,x=De,Oe!=null?pa(o,!!p,Oe,!1):!!x!=!!p&&(c!=null?pa(o,!!p,c,!0):pa(o,!!p,p?[]:"",!1));return;case"textarea":De=Oe=null;for(re in p)if(N=p[re],p.hasOwnProperty(re)&&N!=null&&!x.hasOwnProperty(re))switch(re){case"value":break;case"children":break;default:_n(o,c,re,null,x,N)}for(G in x)if(N=x[G],P=p[G],x.hasOwnProperty(G)&&(N!=null||P!=null))switch(G){case"value":Oe=N;break;case"defaultValue":De=N;break;case"children":break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(r(91));break;default:N!==P&&_n(o,c,G,N,x,P)}Xs(o,Oe,De);return;case"option":for(var _t in p)if(Oe=p[_t],p.hasOwnProperty(_t)&&Oe!=null&&!x.hasOwnProperty(_t))switch(_t){case"selected":o.selected=!1;break;default:_n(o,c,_t,null,x,Oe)}for(ye in x)if(Oe=x[ye],De=p[ye],x.hasOwnProperty(ye)&&Oe!==De&&(Oe!=null||De!=null))switch(ye){case"selected":o.selected=Oe&&typeof Oe!="function"&&typeof Oe!="symbol";break;default:_n(o,c,ye,Oe,x,De)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Nt in p)Oe=p[Nt],p.hasOwnProperty(Nt)&&Oe!=null&&!x.hasOwnProperty(Nt)&&_n(o,c,Nt,null,x,Oe);for(Ae in x)if(Oe=x[Ae],De=p[Ae],x.hasOwnProperty(Ae)&&Oe!==De&&(Oe!=null||De!=null))switch(Ae){case"children":case"dangerouslySetInnerHTML":if(Oe!=null)throw Error(r(137,c));break;default:_n(o,c,Ae,Oe,x,De)}return;default:if(Zo(c)){for(var kn in p)Oe=p[kn],p.hasOwnProperty(kn)&&Oe!==void 0&&!x.hasOwnProperty(kn)&&gm(o,c,kn,void 0,x,Oe);for(He in x)Oe=x[He],De=p[He],!x.hasOwnProperty(He)||Oe===De||Oe===void 0&&De===void 0||gm(o,c,He,Oe,x,De);return}}for(var je in p)Oe=p[je],p.hasOwnProperty(je)&&Oe!=null&&!x.hasOwnProperty(je)&&_n(o,c,je,null,x,Oe);for(Ke in x)Oe=x[Ke],De=p[Ke],!x.hasOwnProperty(Ke)||Oe===De||Oe==null&&De==null||_n(o,c,Ke,Oe,x,De)}var Ea=null,nh=null;function Tl(o){return o.nodeType===9?o:o.ownerDocument}function Gn(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function er(o,c){if(o===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&c==="foreignObject"?0:o}function rh(o,c){return o==="textarea"||o==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var ym=null;function R0(){var o=window.event;return o&&o.type==="popstate"?o===ym?!1:(ym=o,!0):(ym=null,!1)}var Xy=typeof setTimeout=="function"?setTimeout:void 0,O0=typeof clearTimeout=="function"?clearTimeout:void 0,Zy=typeof Promise=="function"?Promise:void 0,L0=typeof queueMicrotask=="function"?queueMicrotask:typeof Zy<"u"?function(o){return Zy.resolve(null).then(o).catch(ex)}:Xy;function ex(o){setTimeout(function(){throw o})}function ea(o){return o==="head"}function ih(o,c){var p=c,x=0,N=0;do{var P=p.nextSibling;if(o.removeChild(p),P&&P.nodeType===8)if(p=P.data,p==="/$"){if(0<x&&8>x){p=x;var G=o.ownerDocument;if(p&1&&fd(G.documentElement),p&2&&fd(G.body),p&4)for(p=G.head,fd(p),G=p.firstChild;G;){var re=G.nextSibling,ye=G.nodeName;G[fs]||ye==="SCRIPT"||ye==="STYLE"||ye==="LINK"&&G.rel.toLowerCase()==="stylesheet"||p.removeChild(G),G=re}}if(N===0){o.removeChild(P),vd(c);return}N--}else p==="$"||p==="$?"||p==="$!"?N++:x=p.charCodeAt(0)-48;else x=0;p=P}while(p);vd(c)}function xm(o){var c=o.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var p=c;switch(c=c.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":xm(p),nu(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}o.removeChild(p)}}function tx(o,c,p,x){for(;o.nodeType===1;){var N=p;if(o.nodeName.toLowerCase()!==c.toLowerCase()){if(!x&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(x){if(!o[fs])switch(c){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(P=o.getAttribute("rel"),P==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(P!==N.rel||o.getAttribute("href")!==(N.href==null||N.href===""?null:N.href)||o.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin)||o.getAttribute("title")!==(N.title==null?null:N.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(P=o.getAttribute("src"),(P!==(N.src==null?null:N.src)||o.getAttribute("type")!==(N.type==null?null:N.type)||o.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin))&&P&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(c==="input"&&o.type==="hidden"){var P=N.name==null?null:""+N.name;if(N.type==="hidden"&&o.getAttribute("name")===P)return o}else return o;if(o=Ta(o.nextSibling),o===null)break}return null}function ah(o,c,p){if(c==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!p||(o=Ta(o.nextSibling),o===null))return null;return o}function Zr(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState==="complete"}function Pc(o,c){var p=o.ownerDocument;if(o.data!=="$?"||p.readyState==="complete")c();else{var x=function(){c(),p.removeEventListener("DOMContentLoaded",x)};p.addEventListener("DOMContentLoaded",x),o._reactRetry=x}}function Ta(o){for(;o!=null;o=o.nextSibling){var c=o.nodeType;if(c===1||c===3)break;if(c===8){if(c=o.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return o}var bm=null;function nx(o){o=o.previousSibling;for(var c=0;o;){if(o.nodeType===8){var p=o.data;if(p==="$"||p==="$!"||p==="$?"){if(c===0)return o;c--}else p==="/$"&&c++}o=o.previousSibling}return null}function rx(o,c,p){switch(c=Tl(p),o){case"html":if(o=c.documentElement,!o)throw Error(r(452));return o;case"head":if(o=c.head,!o)throw Error(r(453));return o;case"body":if(o=c.body,!o)throw Error(r(454));return o;default:throw Error(r(451))}}function fd(o){for(var c=o.attributes;c.length;)o.removeAttributeNode(c[0]);nu(o)}var Li=new Map,is=new Set;function Ft(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var as=B.d;B.d={f:ta,r:ix,D:F0,C:ax,L:sh,m:$0,X:B0,S:z0,M:U0};function ta(){var o=as.f(),c=Yf();return o||c}function ix(o){var c=Ws(o);c!==null&&c.tag===5&&c.type==="form"?Af(c):as.r(o)}var Dc=typeof document>"u"?null:document;function pn(o,c,p){var x=Dc;if(x&&typeof c=="string"&&c){var N=Vr(c);N='link[rel="'+o+'"][href="'+N+'"]',typeof p=="string"&&(N+='[crossorigin="'+p+'"]'),is.has(N)||(is.add(N),o={rel:o,crossOrigin:p,href:c},x.querySelector(N)===null&&(c=x.createElement("link"),br(c,"link",o),cr(c),x.head.appendChild(c)))}}function F0(o){as.D(o),pn("dns-prefetch",o,null)}function ax(o,c){as.C(o,c),pn("preconnect",o,c)}function sh(o,c,p){as.L(o,c,p);var x=Dc;if(x&&o&&c){var N='link[rel="preload"][as="'+Vr(c)+'"]';c==="image"&&p&&p.imageSrcSet?(N+='[imagesrcset="'+Vr(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(N+='[imagesizes="'+Vr(p.imageSizes)+'"]')):N+='[href="'+Vr(o)+'"]';var P=N;switch(c){case"style":P=Ic(o);break;case"script":P=Mc(o)}Li.has(P)||(o=h({rel:"preload",href:c==="image"&&p&&p.imageSrcSet?void 0:o,as:c},p),Li.set(P,o),x.querySelector(N)!==null||c==="style"&&x.querySelector(hd(P))||c==="script"&&x.querySelector(pd(P))||(c=x.createElement("link"),br(c,"link",o),cr(c),x.head.appendChild(c)))}}function $0(o,c){as.m(o,c);var p=Dc;if(p&&o){var x=c&&typeof c.as=="string"?c.as:"script",N='link[rel="modulepreload"][as="'+Vr(x)+'"][href="'+Vr(o)+'"]',P=N;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":P=Mc(o)}if(!Li.has(P)&&(o=h({rel:"modulepreload",href:o},c),Li.set(P,o),p.querySelector(N)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(pd(P)))return}x=p.createElement("link"),br(x,"link",o),cr(x),p.head.appendChild(x)}}}function z0(o,c,p){as.S(o,c,p);var x=Dc;if(x&&o){var N=Qs(x).hoistableStyles,P=Ic(o);c=c||"default";var G=N.get(P);if(!G){var re={loading:0,preload:null};if(G=x.querySelector(hd(P)))re.loading=5;else{o=h({rel:"stylesheet",href:o,"data-precedence":c},p),(p=Li.get(P))&&md(o,p);var ye=G=x.createElement("link");cr(ye),br(ye,"link",o),ye._p=new Promise(function(Ae,He){ye.onload=Ae,ye.onerror=He}),ye.addEventListener("load",function(){re.loading|=1}),ye.addEventListener("error",function(){re.loading|=2}),re.loading|=4,oh(G,c,x)}G={type:"stylesheet",instance:G,count:1,state:re},N.set(P,G)}}}function B0(o,c){as.X(o,c);var p=Dc;if(p&&o){var x=Qs(p).hoistableScripts,N=Mc(o),P=x.get(N);P||(P=p.querySelector(pd(N)),P||(o=h({src:o,async:!0},c),(c=Li.get(N))&&vm(o,c),P=p.createElement("script"),cr(P),br(P,"link",o),p.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},x.set(N,P))}}function U0(o,c){as.M(o,c);var p=Dc;if(p&&o){var x=Qs(p).hoistableScripts,N=Mc(o),P=x.get(N);P||(P=p.querySelector(pd(N)),P||(o=h({src:o,async:!0,type:"module"},c),(c=Li.get(N))&&vm(o,c),P=p.createElement("script"),cr(P),br(P,"link",o),p.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},x.set(N,P))}}function sx(o,c,p,x){var N=(N=fe.current)?Ft(N):null;if(!N)throw Error(r(446));switch(o){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(c=Ic(p.href),p=Qs(N).hoistableStyles,x=p.get(c),x||(x={type:"style",instance:null,count:0,state:null},p.set(c,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){o=Ic(p.href);var P=Qs(N).hoistableStyles,G=P.get(o);if(G||(N=N.ownerDocument||N,G={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},P.set(o,G),(P=N.querySelector(hd(o)))&&!P._p&&(G.instance=P,G.state.loading=5),Li.has(o)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},Li.set(o,p),P||q0(N,o,p,G.state))),c&&x===null)throw Error(r(528,""));return G}if(c&&x!==null)throw Error(r(529,""));return null;case"script":return c=p.async,p=p.src,typeof p=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Mc(p),p=Qs(N).hoistableScripts,x=p.get(c),x||(x={type:"script",instance:null,count:0,state:null},p.set(c,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,o))}}function Ic(o){return'href="'+Vr(o)+'"'}function hd(o){return'link[rel="stylesheet"]['+o+"]"}function ox(o){return h({},o,{"data-precedence":o.precedence,precedence:null})}function q0(o,c,p,x){o.querySelector('link[rel="preload"][as="style"]['+c+"]")?x.loading=1:(c=o.createElement("link"),x.preload=c,c.addEventListener("load",function(){return x.loading|=1}),c.addEventListener("error",function(){return x.loading|=2}),br(c,"link",p),cr(c),o.head.appendChild(c))}function Mc(o){return'[src="'+Vr(o)+'"]'}function pd(o){return"script[async]"+o}function lx(o,c,p){if(c.count++,c.instance===null)switch(c.type){case"style":var x=o.querySelector('style[data-href~="'+Vr(p.href)+'"]');if(x)return c.instance=x,cr(x),x;var N=h({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return x=(o.ownerDocument||o).createElement("style"),cr(x),br(x,"style",N),oh(x,p.precedence,o),c.instance=x;case"stylesheet":N=Ic(p.href);var P=o.querySelector(hd(N));if(P)return c.state.loading|=4,c.instance=P,cr(P),P;x=ox(p),(N=Li.get(N))&&md(x,N),P=(o.ownerDocument||o).createElement("link"),cr(P);var G=P;return G._p=new Promise(function(re,ye){G.onload=re,G.onerror=ye}),br(P,"link",x),c.state.loading|=4,oh(P,p.precedence,o),c.instance=P;case"script":return P=Mc(p.src),(N=o.querySelector(pd(P)))?(c.instance=N,cr(N),N):(x=p,(N=Li.get(P))&&(x=h({},p),vm(x,N)),o=o.ownerDocument||o,N=o.createElement("script"),cr(N),br(N,"link",x),o.head.appendChild(N),c.instance=N);case"void":return null;default:throw Error(r(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(x=c.instance,c.state.loading|=4,oh(x,p.precedence,o));return c.instance}function oh(o,c,p){for(var x=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),N=x.length?x[x.length-1]:null,P=N,G=0;G<x.length;G++){var re=x[G];if(re.dataset.precedence===c)P=re;else if(P!==N)break}P?P.parentNode.insertBefore(o,P.nextSibling):(c=p.nodeType===9?p.head:p,c.insertBefore(o,c.firstChild))}function md(o,c){o.crossOrigin==null&&(o.crossOrigin=c.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=c.referrerPolicy),o.title==null&&(o.title=c.title)}function vm(o,c){o.crossOrigin==null&&(o.crossOrigin=c.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=c.referrerPolicy),o.integrity==null&&(o.integrity=c.integrity)}var Rc=null;function cx(o,c,p){if(Rc===null){var x=new Map,N=Rc=new Map;N.set(p,x)}else N=Rc,x=N.get(p),x||(x=new Map,N.set(p,x));if(x.has(o))return x;for(x.set(o,null),p=p.getElementsByTagName(o),N=0;N<p.length;N++){var P=p[N];if(!(P[fs]||P[Xn]||o==="link"&&P.getAttribute("rel")==="stylesheet")&&P.namespaceURI!=="http://www.w3.org/2000/svg"){var G=P.getAttribute(c)||"";G=o+G;var re=x.get(G);re?re.push(P):x.set(G,[P])}}return x}function ux(o,c,p){o=o.ownerDocument||o,o.head.insertBefore(p,c==="title"?o.querySelector("head > title"):null)}function V0(o,c,p){if(p===1||c.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return o=c.disabled,typeof c.precedence=="string"&&o==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function vr(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}var _r=null;function H0(){}function G0(o,c,p){if(_r===null)throw Error(r(475));var x=_r;if(c.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var N=Ic(p.href),P=o.querySelector(hd(N));if(P){o=P._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(x.count++,x=gd.bind(x),o.then(x,x)),c.state.loading|=4,c.instance=P,cr(P);return}P=o.ownerDocument||o,p=ox(p),(N=Li.get(N))&&md(p,N),P=P.createElement("link"),cr(P);var G=P;G._p=new Promise(function(re,ye){G.onload=re,G.onerror=ye}),br(P,"link",p),c.instance=P}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(c,o),(o=c.state.preload)&&(c.state.loading&3)===0&&(x.count++,c=gd.bind(x),o.addEventListener("load",c),o.addEventListener("error",c))}}function Y0(){if(_r===null)throw Error(r(475));var o=_r;return o.stylesheets&&o.count===0&&wm(o,o.stylesheets),0<o.count?function(c){var p=setTimeout(function(){if(o.stylesheets&&wm(o,o.stylesheets),o.unsuspend){var x=o.unsuspend;o.unsuspend=null,x()}},6e4);return o.unsuspend=c,function(){o.unsuspend=null,clearTimeout(p)}}:null}function gd(){if(this.count--,this.count===0){if(this.stylesheets)wm(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var lh=null;function wm(o,c){o.stylesheets=null,o.unsuspend!==null&&(o.count++,lh=new Map,c.forEach(W0,o),lh=null,gd.call(o))}function W0(o,c){if(!(c.state.loading&4)){var p=lh.get(o);if(p)var x=p.get(null);else{p=new Map,lh.set(o,p);for(var N=o.querySelectorAll("link[data-precedence],style[data-precedence]"),P=0;P<N.length;P++){var G=N[P];(G.nodeName==="LINK"||G.getAttribute("media")!=="not all")&&(p.set(G.dataset.precedence,G),x=G)}x&&p.set(null,x)}N=c.instance,G=N.getAttribute("data-precedence"),P=p.get(G)||x,P===x&&p.set(null,N),p.set(G,N),this.count++,x=gd.bind(this),N.addEventListener("load",x),N.addEventListener("error",x),P?P.parentNode.insertBefore(N,P.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(N,o.firstChild)),c.state.loading|=4}}var Oc={$$typeof:D,Provider:null,Consumer:null,_currentValue:K,_currentValue2:K,_threadCount:0};function Q0(o,c,p,x,N,P,G,re){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ln(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ln(0),this.hiddenUpdates=Ln(null),this.identifierPrefix=x,this.onUncaughtError=N,this.onCaughtError=P,this.onRecoverableError=G,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=re,this.incompleteTransitions=new Map}function dx(o,c,p,x,N,P,G,re,ye,Ae,He,Ke){return o=new Q0(o,c,p,G,re,ye,Ae,Ke),c=1,P===!0&&(c|=24),P=ui(3,null,null,c),o.current=P,P.stateNode=o,c=mp(),c.refCount++,o.pooledCache=c,c.refCount++,P.memoizedState={element:x,isDehydrated:p,cache:c},gl(P),o}function fx(o){return o?(o=cl,o):cl}function Sm(o,c,p,x,N,P){N=fx(N),x.context===null?x.context=N:x.pendingContext=N,x=fo(c),x.payload={element:p},P=P===void 0?null:P,P!==null&&(x.callback=P),p=ks(o,x,c),p!==null&&(Oi(p,o,c),Tu(p,o,c))}function Nm(o,c){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var p=o.retryLane;o.retryLane=p!==0&&p<c?p:c}}function Cm(o,c){Nm(o,c),(o=o.alternate)&&Nm(o,c)}function hx(o){if(o.tag===13){var c=ll(o,67108864);c!==null&&Oi(c,o,67108864),Cm(o,67108864)}}var ch=!0;function J0(o,c,p,x){var N=Z.T;Z.T=null;var P=B.p;try{B.p=2,jm(o,c,p,x)}finally{B.p=P,Z.T=N}}function Lc(o,c,p,x){var N=Z.T;Z.T=null;var P=B.p;try{B.p=8,jm(o,c,p,x)}finally{B.p=P,Z.T=N}}function jm(o,c,p,x){if(ch){var N=_m(x);if(N===null)Fs(o,c,x,uh,p),mx(o,x);else if(X0(N,o,c,p,x))x.stopPropagation();else if(mx(o,x),c&4&&-1<K0.indexOf(o)){for(;N!==null;){var P=Ws(N);if(P!==null)switch(P.tag){case 3:if(P=P.stateNode,P.current.memoizedState.isDehydrated){var G=tt(P.pendingLanes);if(G!==0){var re=P;for(re.pendingLanes|=2,re.entangledLanes|=2;G;){var ye=1<<31-ke(G);re.entanglements[1]|=ye,G&=~ye}rs(P),(vn&6)===0&&(jc=ze()+500,ld(0))}}break;case 13:re=ll(P,2),re!==null&&Oi(re,P,2),Yf(),Cm(P,2)}if(P=_m(x),P===null&&Fs(o,c,x,uh,p),P===N)break;N=P}N!==null&&x.stopPropagation()}else Fs(o,c,x,null,p)}}function _m(o){return o=el(o),km(o)}var uh=null;function km(o){if(uh=null,o=Ys(o),o!==null){var c=s(o);if(c===null)o=null;else{var p=c.tag;if(p===13){if(o=l(c),o!==null)return o;o=null}else if(p===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;o=null}else c!==o&&(o=null)}}return uh=o,null}function px(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(nt()){case jt:return 2;case xt:return 8;case ve:case qe:return 32;case Qe:return 268435456;default:return 32}default:return 32}}var dh=!1,$s=null,Eo=null,To=null,yd=new Map,xd=new Map,Ao=[],K0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function mx(o,c){switch(o){case"focusin":case"focusout":$s=null;break;case"dragenter":case"dragleave":Eo=null;break;case"mouseover":case"mouseout":To=null;break;case"pointerover":case"pointerout":yd.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":xd.delete(c.pointerId)}}function bd(o,c,p,x,N,P){return o===null||o.nativeEvent!==P?(o={blockedOn:c,domEventName:p,eventSystemFlags:x,nativeEvent:P,targetContainers:[N]},c!==null&&(c=Ws(c),c!==null&&hx(c)),o):(o.eventSystemFlags|=x,c=o.targetContainers,N!==null&&c.indexOf(N)===-1&&c.push(N),o)}function X0(o,c,p,x,N){switch(c){case"focusin":return $s=bd($s,o,c,p,x,N),!0;case"dragenter":return Eo=bd(Eo,o,c,p,x,N),!0;case"mouseover":return To=bd(To,o,c,p,x,N),!0;case"pointerover":var P=N.pointerId;return yd.set(P,bd(yd.get(P)||null,o,c,p,x,N)),!0;case"gotpointercapture":return P=N.pointerId,xd.set(P,bd(xd.get(P)||null,o,c,p,x,N)),!0}return!1}function gx(o){var c=Ys(o.target);if(c!==null){var p=s(c);if(p!==null){if(c=p.tag,c===13){if(c=l(p),c!==null){o.blockedOn=c,Ti(o.priority,function(){if(p.tag===13){var x=Br();x=Ur(x);var N=ll(p,x);N!==null&&Oi(N,p,x),Cm(p,x)}});return}}else if(c===3&&p.stateNode.current.memoizedState.isDehydrated){o.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}o.blockedOn=null}function fh(o){if(o.blockedOn!==null)return!1;for(var c=o.targetContainers;0<c.length;){var p=_m(o.nativeEvent);if(p===null){p=o.nativeEvent;var x=new p.constructor(p.type,p);Zs=x,p.target.dispatchEvent(x),Zs=null}else return c=Ws(p),c!==null&&hx(c),o.blockedOn=p,!1;c.shift()}return!0}function yx(o,c,p){fh(o)&&p.delete(c)}function Z0(){dh=!1,$s!==null&&fh($s)&&($s=null),Eo!==null&&fh(Eo)&&(Eo=null),To!==null&&fh(To)&&(To=null),yd.forEach(yx),xd.forEach(yx)}function hh(o,c){o.blockedOn===c&&(o.blockedOn=null,dh||(dh=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Z0)))}var ph=null;function xx(o){ph!==o&&(ph=o,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){ph===o&&(ph=null);for(var c=0;c<o.length;c+=3){var p=o[c],x=o[c+1],N=o[c+2];if(typeof x!="function"){if(km(x||p)===null)continue;break}var P=Ws(p);P!==null&&(o.splice(c,3),c-=3,zu(P,{pending:!0,data:N,method:p.method,action:x},x,N))}}))}function vd(o){function c(ye){return hh(ye,o)}$s!==null&&hh($s,o),Eo!==null&&hh(Eo,o),To!==null&&hh(To,o),yd.forEach(c),xd.forEach(c);for(var p=0;p<Ao.length;p++){var x=Ao[p];x.blockedOn===o&&(x.blockedOn=null)}for(;0<Ao.length&&(p=Ao[0],p.blockedOn===null);)gx(p),p.blockedOn===null&&Ao.shift();if(p=(o.ownerDocument||o).$$reactFormReplay,p!=null)for(x=0;x<p.length;x+=3){var N=p[x],P=p[x+1],G=N[Fn]||null;if(typeof P=="function")G||xx(p);else if(G){var re=null;if(P&&P.hasAttribute("formAction")){if(N=P,G=P[Fn]||null)re=G.formAction;else if(km(N)!==null)continue}else re=G.action;typeof re=="function"?p[x+1]=re:(p.splice(x,3),x-=3),xx(p)}}}function Em(o){this._internalRoot=o}mh.prototype.render=Em.prototype.render=function(o){var c=this._internalRoot;if(c===null)throw Error(r(409));var p=c.current,x=Br();Sm(p,x,o,c,null,null)},mh.prototype.unmount=Em.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var c=o.containerInfo;Sm(o.current,2,null,o,null,null),Yf(),c[za]=null}};function mh(o){this._internalRoot=o}mh.prototype.unstable_scheduleHydration=function(o){if(o){var c=fa();o={blockedOn:null,target:o,priority:c};for(var p=0;p<Ao.length&&c!==0&&c<Ao[p].priority;p++);Ao.splice(p,0,o),p===0&&gx(o)}};var bx=n.version;if(bx!=="19.1.0")throw Error(r(527,bx,"19.1.0"));B.findDOMNode=function(o){var c=o._reactInternals;if(c===void 0)throw typeof o.render=="function"?Error(r(188)):(o=Object.keys(o).join(","),Error(r(268,o)));return o=d(c),o=o!==null?u(o):null,o=o===null?null:o.stateNode,o};var ev={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Z,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gh.isDisabled&&gh.supportsFiber)try{Y=gh.inject(ev),X=gh}catch{}}return Am.createRoot=function(o,c){if(!a(o))throw Error(r(299));var p=!1,x="",N=Bp,P=If,G=iy,re=null;return c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(N=c.onUncaughtError),c.onCaughtError!==void 0&&(P=c.onCaughtError),c.onRecoverableError!==void 0&&(G=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(re=c.unstable_transitionCallbacks)),c=dx(o,1,!1,null,null,p,x,N,P,G,re,null),o[za]=c.current,mm(o),new Em(c)},Am.hydrateRoot=function(o,c,p){if(!a(o))throw Error(r(299));var x=!1,N="",P=Bp,G=If,re=iy,ye=null,Ae=null;return p!=null&&(p.unstable_strictMode===!0&&(x=!0),p.identifierPrefix!==void 0&&(N=p.identifierPrefix),p.onUncaughtError!==void 0&&(P=p.onUncaughtError),p.onCaughtError!==void 0&&(G=p.onCaughtError),p.onRecoverableError!==void 0&&(re=p.onRecoverableError),p.unstable_transitionCallbacks!==void 0&&(ye=p.unstable_transitionCallbacks),p.formState!==void 0&&(Ae=p.formState)),c=dx(o,1,!0,c,p??null,x,N,P,G,re,ye,Ae),c.context=fx(null),p=c.current,x=Br(),x=Ur(x),N=fo(x),N.callback=null,ks(p,N,x),p=x,c.current.lanes=p,jn(c,p),rs(c),o[za]=c.current,mm(o),new mh(c)},Am.version="19.1.0",Am}var BS;function OP(){if(BS)return sv.exports;BS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),sv.exports=RP(),sv.exports}var LP=OP(),Pm={},US;function FP(){if(US)return Pm;US=1,Object.defineProperty(Pm,"__esModule",{value:!0}),Pm.parse=l,Pm.serialize=u;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,n=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,s=(()=>{const b=function(){};return b.prototype=Object.create(null),b})();function l(b,v){const S=new s,k=b.length;if(k<2)return S;const E=(v==null?void 0:v.decode)||h;let T=0;do{const I=b.indexOf("=",T);if(I===-1)break;const D=b.indexOf(";",T),q=D===-1?k:D;if(I>q){T=b.lastIndexOf(";",I-1)+1;continue}const R=f(b,T,I),F=d(b,I,R),U=b.slice(R,F);if(S[U]===void 0){let z=f(b,I+1,q),V=d(b,q,z);const L=E(b.slice(z,V));S[U]=L}T=q+1}while(T<k);return S}function f(b,v,S){do{const k=b.charCodeAt(v);if(k!==32&&k!==9)return v}while(++v<S);return S}function d(b,v,S){for(;v>S;){const k=b.charCodeAt(--v);if(k!==32&&k!==9)return v+1}return S}function u(b,v,S){const k=(S==null?void 0:S.encode)||encodeURIComponent;if(!e.test(b))throw new TypeError(`argument name is invalid: ${b}`);const E=k(v);if(!n.test(E))throw new TypeError(`argument val is invalid: ${v}`);let T=b+"="+E;if(!S)return T;if(S.maxAge!==void 0){if(!Number.isInteger(S.maxAge))throw new TypeError(`option maxAge is invalid: ${S.maxAge}`);T+="; Max-Age="+S.maxAge}if(S.domain){if(!t.test(S.domain))throw new TypeError(`option domain is invalid: ${S.domain}`);T+="; Domain="+S.domain}if(S.path){if(!r.test(S.path))throw new TypeError(`option path is invalid: ${S.path}`);T+="; Path="+S.path}if(S.expires){if(!g(S.expires)||!Number.isFinite(S.expires.valueOf()))throw new TypeError(`option expires is invalid: ${S.expires}`);T+="; Expires="+S.expires.toUTCString()}if(S.httpOnly&&(T+="; HttpOnly"),S.secure&&(T+="; Secure"),S.partitioned&&(T+="; Partitioned"),S.priority)switch(typeof S.priority=="string"?S.priority.toLowerCase():void 0){case"low":T+="; Priority=Low";break;case"medium":T+="; Priority=Medium";break;case"high":T+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${S.priority}`)}if(S.sameSite)switch(typeof S.sameSite=="string"?S.sameSite.toLowerCase():S.sameSite){case!0:case"strict":T+="; SameSite=Strict";break;case"lax":T+="; SameSite=Lax";break;case"none":T+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${S.sameSite}`)}return T}function h(b){if(b.indexOf("%")===-1)return b;try{return decodeURIComponent(b)}catch{return b}}function g(b){return a.call(b)==="[object Date]"}return Pm}FP();var qS="popstate";function $P(e={}){function n(r,a){let{pathname:s,search:l,hash:f}=r.location;return h1("",{pathname:s,search:l,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(r,a){return typeof a=="string"?a:rg(a)}return BP(n,t,null,e)}function or(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function Us(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function zP(){return Math.random().toString(36).substring(2,10)}function VS(e,n){return{usr:e.state,key:e.key,idx:n}}function h1(e,n,t=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof n=="string"?Uh(n):n,state:t,key:n&&n.key||r||zP()}}function rg({pathname:e="/",search:n="",hash:t=""}){return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function Uh(e){let n={};if(e){let t=e.indexOf("#");t>=0&&(n.hash=e.substring(t),e=e.substring(0,t));let r=e.indexOf("?");r>=0&&(n.search=e.substring(r),e=e.substring(0,r)),e&&(n.pathname=e)}return n}function BP(e,n,t,r={}){let{window:a=document.defaultView,v5Compat:s=!1}=r,l=a.history,f="POP",d=null,u=h();u==null&&(u=0,l.replaceState({...l.state,idx:u},""));function h(){return(l.state||{idx:null}).idx}function g(){f="POP";let E=h(),T=E==null?null:E-u;u=E,d&&d({action:f,location:k.location,delta:T})}function b(E,T){f="PUSH";let I=h1(k.location,E,T);u=h()+1;let D=VS(I,u),q=k.createHref(I);try{l.pushState(D,"",q)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;a.location.assign(q)}s&&d&&d({action:f,location:k.location,delta:1})}function v(E,T){f="REPLACE";let I=h1(k.location,E,T);u=h();let D=VS(I,u),q=k.createHref(I);l.replaceState(D,"",q),s&&d&&d({action:f,location:k.location,delta:0})}function S(E){return UP(E)}let k={get action(){return f},get location(){return e(a,l)},listen(E){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(qS,g),d=E,()=>{a.removeEventListener(qS,g),d=null}},createHref(E){return n(a,E)},createURL:S,encodeLocation(E){let T=S(E);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:b,replace:v,go(E){return l.go(E)}};return k}function UP(e,n=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),or(t,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:rg(e);return r=r.replace(/ $/,"%20"),!n&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function ik(e,n,t="/"){return qP(e,n,t,!1)}function qP(e,n,t,r){let a=typeof n=="string"?Uh(n):n,s=Ol(a.pathname||"/",t);if(s==null)return null;let l=ak(e);VP(l);let f=null;for(let d=0;f==null&&d<l.length;++d){let u=tD(s);f=ZP(l[d],u,r)}return f}function ak(e,n=[],t=[],r=""){let a=(s,l,f)=>{let d={relativePath:f===void 0?s.path||"":f,caseSensitive:s.caseSensitive===!0,childrenIndex:l,route:s};d.relativePath.startsWith("/")&&(or(d.relativePath.startsWith(r),`Absolute route path "${d.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(r.length));let u=Il([r,d.relativePath]),h=t.concat(d);s.children&&s.children.length>0&&(or(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),ak(s.children,n,h,u)),!(s.path==null&&!s.index)&&n.push({path:u,score:KP(u,s.index),routesMeta:h})};return e.forEach((s,l)=>{var f;if(s.path===""||!((f=s.path)!=null&&f.includes("?")))a(s,l);else for(let d of sk(s.path))a(s,l,d)}),n}function sk(e){let n=e.split("/");if(n.length===0)return[];let[t,...r]=n,a=t.endsWith("?"),s=t.replace(/\?$/,"");if(r.length===0)return a?[s,""]:[s];let l=sk(r.join("/")),f=[];return f.push(...l.map(d=>d===""?s:[s,d].join("/"))),a&&f.push(...l),f.map(d=>e.startsWith("/")&&d===""?"/":d)}function VP(e){e.sort((n,t)=>n.score!==t.score?t.score-n.score:XP(n.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var HP=/^:[\w-]+$/,GP=3,YP=2,WP=1,QP=10,JP=-2,HS=e=>e==="*";function KP(e,n){let t=e.split("/"),r=t.length;return t.some(HS)&&(r+=JP),n&&(r+=YP),t.filter(a=>!HS(a)).reduce((a,s)=>a+(HP.test(s)?GP:s===""?WP:QP),r)}function XP(e,n){return e.length===n.length&&e.slice(0,-1).every((r,a)=>r===n[a])?e[e.length-1]-n[n.length-1]:0}function ZP(e,n,t=!1){let{routesMeta:r}=e,a={},s="/",l=[];for(let f=0;f<r.length;++f){let d=r[f],u=f===r.length-1,h=s==="/"?n:n.slice(s.length)||"/",g=ab({path:d.relativePath,caseSensitive:d.caseSensitive,end:u},h),b=d.route;if(!g&&u&&t&&!r[r.length-1].route.index&&(g=ab({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},h)),!g)return null;Object.assign(a,g.params),l.push({params:a,pathname:Il([s,g.pathname]),pathnameBase:aD(Il([s,g.pathnameBase])),route:b}),g.pathnameBase!=="/"&&(s=Il([s,g.pathnameBase]))}return l}function ab(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,r]=eD(e.path,e.caseSensitive,e.end),a=n.match(t);if(!a)return null;let s=a[0],l=s.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:r.reduce((u,{paramName:h,isOptional:g},b)=>{if(h==="*"){let S=f[b]||"";l=s.slice(0,s.length-S.length).replace(/(.)\/+$/,"$1")}const v=f[b];return g&&!v?u[h]=void 0:u[h]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:l,pattern:e}}function eD(e,n=!1,t=!0){Us(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,f,d)=>(r.push({paramName:f,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,n?void 0:"i"),r]}function tD(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return Us(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),e}}function Ol(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let t=n.endsWith("/")?n.length-1:n.length,r=e.charAt(t);return r&&r!=="/"?null:e.slice(t)||"/"}function nD(e,n="/"){let{pathname:t,search:r="",hash:a=""}=typeof e=="string"?Uh(e):e;return{pathname:t?t.startsWith("/")?t:rD(t,n):n,search:sD(r),hash:oD(a)}}function rD(e,n){let t=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function uv(e,n,t,r){return`Cannot include a '${e}' character in a manually specified \`to.${n}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function iD(e){return e.filter((n,t)=>t===0||n.route.path&&n.route.path.length>0)}function Cw(e){let n=iD(e);return n.map((t,r)=>r===n.length-1?t.pathname:t.pathnameBase)}function jw(e,n,t,r=!1){let a;typeof e=="string"?a=Uh(e):(a={...e},or(!a.pathname||!a.pathname.includes("?"),uv("?","pathname","search",a)),or(!a.pathname||!a.pathname.includes("#"),uv("#","pathname","hash",a)),or(!a.search||!a.search.includes("#"),uv("#","search","hash",a)));let s=e===""||a.pathname==="",l=s?"/":a.pathname,f;if(l==null)f=t;else{let g=n.length-1;if(!r&&l.startsWith("..")){let b=l.split("/");for(;b[0]==="..";)b.shift(),g-=1;a.pathname=b.join("/")}f=g>=0?n[g]:"/"}let d=nD(a,f),u=l&&l!=="/"&&l.endsWith("/"),h=(s||l===".")&&t.endsWith("/");return!d.pathname.endsWith("/")&&(u||h)&&(d.pathname+="/"),d}var Il=e=>e.join("/").replace(/\/\/+/g,"/"),aD=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),sD=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,oD=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function lD(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var ok=["POST","PUT","PATCH","DELETE"];new Set(ok);var cD=["GET",...ok];new Set(cD);var qh=w.createContext(null);qh.displayName="DataRouter";var Fb=w.createContext(null);Fb.displayName="DataRouterState";var lk=w.createContext({isTransitioning:!1});lk.displayName="ViewTransition";var uD=w.createContext(new Map);uD.displayName="Fetchers";var dD=w.createContext(null);dD.displayName="Await";var Vs=w.createContext(null);Vs.displayName="Navigation";var pg=w.createContext(null);pg.displayName="Location";var Hs=w.createContext({outlet:null,matches:[],isDataRoute:!1});Hs.displayName="Route";var _w=w.createContext(null);_w.displayName="RouteError";function fD(e,{relative:n}={}){or(Vh(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=w.useContext(Vs),{hash:a,pathname:s,search:l}=mg(e,{relative:n}),f=s;return t!=="/"&&(f=s==="/"?t:Il([t,s])),r.createHref({pathname:f,search:l,hash:a})}function Vh(){return w.useContext(pg)!=null}function ni(){return or(Vh(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(pg).location}var ck="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function uk(e){w.useContext(Vs).static||w.useLayoutEffect(e)}function wt(){let{isDataRoute:e}=w.useContext(Hs);return e?jD():hD()}function hD(){or(Vh(),"useNavigate() may be used only in the context of a <Router> component.");let e=w.useContext(qh),{basename:n,navigator:t}=w.useContext(Vs),{matches:r}=w.useContext(Hs),{pathname:a}=ni(),s=JSON.stringify(Cw(r)),l=w.useRef(!1);return uk(()=>{l.current=!0}),w.useCallback((d,u={})=>{if(Us(l.current,ck),!l.current)return;if(typeof d=="number"){t.go(d);return}let h=jw(d,JSON.parse(s),a,u.relative==="path");e==null&&n!=="/"&&(h.pathname=h.pathname==="/"?n:Il([n,h.pathname])),(u.replace?t.replace:t.push)(h,u.state,u)},[n,t,s,a,e])}w.createContext(null);function ki(){let{matches:e}=w.useContext(Hs),n=e[e.length-1];return n?n.params:{}}function mg(e,{relative:n}={}){let{matches:t}=w.useContext(Hs),{pathname:r}=ni(),a=JSON.stringify(Cw(t));return w.useMemo(()=>jw(e,JSON.parse(a),r,n==="path"),[e,a,r,n])}function pD(e,n){return dk(e,n)}function dk(e,n,t,r){var I;or(Vh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:s}=w.useContext(Vs),{matches:l}=w.useContext(Hs),f=l[l.length-1],d=f?f.params:{},u=f?f.pathname:"/",h=f?f.pathnameBase:"/",g=f&&f.route;{let D=g&&g.path||"";fk(u,!g||D.endsWith("*")||D.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${D}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${D}"> to <Route path="${D==="/"?"*":`${D}/*`}">.`)}let b=ni(),v;if(n){let D=typeof n=="string"?Uh(n):n;or(h==="/"||((I=D.pathname)==null?void 0:I.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${D.pathname}" was given in the \`location\` prop.`),v=D}else v=b;let S=v.pathname||"/",k=S;if(h!=="/"){let D=h.replace(/^\//,"").split("/");k="/"+S.replace(/^\//,"").split("/").slice(D.length).join("/")}let E=!s&&t&&t.matches&&t.matches.length>0?t.matches:ik(e,{pathname:k});Us(g||E!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Us(E==null||E[E.length-1].route.element!==void 0||E[E.length-1].route.Component!==void 0||E[E.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=bD(E&&E.map(D=>Object.assign({},D,{params:Object.assign({},d,D.params),pathname:Il([h,a.encodeLocation?a.encodeLocation(D.pathname).pathname:D.pathname]),pathnameBase:D.pathnameBase==="/"?h:Il([h,a.encodeLocation?a.encodeLocation(D.pathnameBase).pathname:D.pathnameBase])})),l,t,r);return n&&T?w.createElement(pg.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},T):T}function mD(){let e=CD(),n=lD(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:s},"ErrorBoundary")," or"," ",w.createElement("code",{style:s},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},n),t?w.createElement("pre",{style:a},t):null,l)}var gD=w.createElement(mD,null),yD=class extends w.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?w.createElement(Hs.Provider,{value:this.props.routeContext},w.createElement(_w.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function xD({routeContext:e,match:n,children:t}){let r=w.useContext(qh);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),w.createElement(Hs.Provider,{value:e},t)}function bD(e,n=[],t=null,r=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(n.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let a=e,s=t==null?void 0:t.errors;if(s!=null){let d=a.findIndex(u=>u.route.id&&(s==null?void 0:s[u.route.id])!==void 0);or(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),a=a.slice(0,Math.min(a.length,d+1))}let l=!1,f=-1;if(t)for(let d=0;d<a.length;d++){let u=a[d];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(f=d),u.route.id){let{loaderData:h,errors:g}=t,b=u.route.loader&&!h.hasOwnProperty(u.route.id)&&(!g||g[u.route.id]===void 0);if(u.route.lazy||b){l=!0,f>=0?a=a.slice(0,f+1):a=[a[0]];break}}}return a.reduceRight((d,u,h)=>{let g,b=!1,v=null,S=null;t&&(g=s&&u.route.id?s[u.route.id]:void 0,v=u.route.errorElement||gD,l&&(f<0&&h===0?(fk("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,S=null):f===h&&(b=!0,S=u.route.hydrateFallbackElement||null)));let k=n.concat(a.slice(0,h+1)),E=()=>{let T;return g?T=v:b?T=S:u.route.Component?T=w.createElement(u.route.Component,null):u.route.element?T=u.route.element:T=d,w.createElement(xD,{match:u,routeContext:{outlet:d,matches:k,isDataRoute:t!=null},children:T})};return t&&(u.route.ErrorBoundary||u.route.errorElement||h===0)?w.createElement(yD,{location:t.location,revalidation:t.revalidation,component:v,error:g,children:E(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):E()},null)}function kw(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function vD(e){let n=w.useContext(qh);return or(n,kw(e)),n}function wD(e){let n=w.useContext(Fb);return or(n,kw(e)),n}function SD(e){let n=w.useContext(Hs);return or(n,kw(e)),n}function Ew(e){let n=SD(e),t=n.matches[n.matches.length-1];return or(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function ND(){return Ew("useRouteId")}function CD(){var r;let e=w.useContext(_w),n=wD("useRouteError"),t=Ew("useRouteError");return e!==void 0?e:(r=n.errors)==null?void 0:r[t]}function jD(){let{router:e}=vD("useNavigate"),n=Ew("useNavigate"),t=w.useRef(!1);return uk(()=>{t.current=!0}),w.useCallback(async(a,s={})=>{Us(t.current,ck),t.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:n,...s}))},[e,n])}var GS={};function fk(e,n,t){!n&&!GS[e]&&(GS[e]=!0,Us(!1,t))}w.memo(_D);function _D({routes:e,future:n,state:t}){return dk(e,void 0,t,n)}function mn({to:e,replace:n,state:t,relative:r}){or(Vh(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=w.useContext(Vs);Us(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=w.useContext(Hs),{pathname:l}=ni(),f=wt(),d=jw(e,Cw(s),l,r==="path"),u=JSON.stringify(d);return w.useEffect(()=>{f(JSON.parse(u),{replace:n,state:t,relative:r})},[f,u,r,n,t]),null}function ut(e){or(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function kD({basename:e="/",children:n=null,location:t,navigationType:r="POP",navigator:a,static:s=!1}){or(!Vh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=e.replace(/^\/*/,"/"),f=w.useMemo(()=>({basename:l,navigator:a,static:s,future:{}}),[l,a,s]);typeof t=="string"&&(t=Uh(t));let{pathname:d="/",search:u="",hash:h="",state:g=null,key:b="default"}=t,v=w.useMemo(()=>{let S=Ol(d,l);return S==null?null:{location:{pathname:S,search:u,hash:h,state:g,key:b},navigationType:r}},[l,d,u,h,g,b,r]);return Us(v!=null,`<Router basename="${l}"> is not able to match the URL "${d}${u}${h}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:w.createElement(Vs.Provider,{value:f},w.createElement(pg.Provider,{children:n,value:v}))}function jh({children:e,location:n}){return pD(p1(e),n)}function p1(e,n=[]){let t=[];return w.Children.forEach(e,(r,a)=>{if(!w.isValidElement(r))return;let s=[...n,a];if(r.type===w.Fragment){t.push.apply(t,p1(r.props.children,s));return}or(r.type===ut,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),or(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=p1(r.props.children,s)),t.push(l)}),t}var Gx="get",Yx="application/x-www-form-urlencoded";function $b(e){return e!=null&&typeof e.tagName=="string"}function ED(e){return $b(e)&&e.tagName.toLowerCase()==="button"}function TD(e){return $b(e)&&e.tagName.toLowerCase()==="form"}function AD(e){return $b(e)&&e.tagName.toLowerCase()==="input"}function PD(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function DD(e,n){return e.button===0&&(!n||n==="_self")&&!PD(e)}var vx=null;function ID(){if(vx===null)try{new FormData(document.createElement("form"),0),vx=!1}catch{vx=!0}return vx}var MD=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function dv(e){return e!=null&&!MD.has(e)?(Us(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Yx}"`),null):e}function RD(e,n){let t,r,a,s,l;if(TD(e)){let f=e.getAttribute("action");r=f?Ol(f,n):null,t=e.getAttribute("method")||Gx,a=dv(e.getAttribute("enctype"))||Yx,s=new FormData(e)}else if(ED(e)||AD(e)&&(e.type==="submit"||e.type==="image")){let f=e.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=e.getAttribute("formaction")||f.getAttribute("action");if(r=d?Ol(d,n):null,t=e.getAttribute("formmethod")||f.getAttribute("method")||Gx,a=dv(e.getAttribute("formenctype"))||dv(f.getAttribute("enctype"))||Yx,s=new FormData(f,e),!ID()){let{name:u,type:h,value:g}=e;if(h==="image"){let b=u?`${u}.`:"";s.append(`${b}x`,"0"),s.append(`${b}y`,"0")}else u&&s.append(u,g)}}else{if($b(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Gx,r=null,a=Yx,l=e}return s&&a==="text/plain"&&(l=s,s=void 0),{action:r,method:t.toLowerCase(),encType:a,formData:s,body:l}}function Tw(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}async function OD(e,n){if(e.id in n)return n[e.id];try{let t=await import(e.module);return n[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function LD(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function FD(e,n,t){let r=await Promise.all(e.map(async a=>{let s=n.routes[a.route.id];if(s){let l=await OD(s,t);return l.links?l.links():[]}return[]}));return UD(r.flat(1).filter(LD).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function YS(e,n,t,r,a,s){let l=(d,u)=>t[u]?d.route.id!==t[u].route.id:!0,f=(d,u)=>{var h;return t[u].pathname!==d.pathname||((h=t[u].route.path)==null?void 0:h.endsWith("*"))&&t[u].params["*"]!==d.params["*"]};return s==="assets"?n.filter((d,u)=>l(d,u)||f(d,u)):s==="data"?n.filter((d,u)=>{var g;let h=r.routes[d.route.id];if(!h||!h.hasLoader)return!1;if(l(d,u)||f(d,u))return!0;if(d.route.shouldRevalidate){let b=d.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((g=t[0])==null?void 0:g.params)||{},nextUrl:new URL(e,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function $D(e,n,{includeHydrateFallback:t}={}){return zD(e.map(r=>{let a=n.routes[r.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function zD(e){return[...new Set(e)]}function BD(e){let n={},t=Object.keys(e).sort();for(let r of t)n[r]=e[r];return n}function UD(e,n){let t=new Set;return new Set(n),e.reduce((r,a)=>{let s=JSON.stringify(BD(a));return t.has(s)||(t.add(s),r.push({key:s,link:a})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var qD=new Set([100,101,204,205]);function VD(e,n){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":n&&Ol(t.pathname,n)==="/"?t.pathname=`${n.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function hk(){let e=w.useContext(qh);return Tw(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function HD(){let e=w.useContext(Fb);return Tw(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Aw=w.createContext(void 0);Aw.displayName="FrameworkContext";function pk(){let e=w.useContext(Aw);return Tw(e,"You must render this element inside a <HydratedRouter> element"),e}function GD(e,n){let t=w.useContext(Aw),[r,a]=w.useState(!1),[s,l]=w.useState(!1),{onFocus:f,onBlur:d,onMouseEnter:u,onMouseLeave:h,onTouchStart:g}=n,b=w.useRef(null);w.useEffect(()=>{if(e==="render"&&l(!0),e==="viewport"){let k=T=>{T.forEach(I=>{l(I.isIntersecting)})},E=new IntersectionObserver(k,{threshold:.5});return b.current&&E.observe(b.current),()=>{E.disconnect()}}},[e]),w.useEffect(()=>{if(r){let k=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(k)}}},[r]);let v=()=>{a(!0)},S=()=>{a(!1),l(!1)};return t?e!=="intent"?[s,b,{}]:[s,b,{onFocus:Dm(f,v),onBlur:Dm(d,S),onMouseEnter:Dm(u,v),onMouseLeave:Dm(h,S),onTouchStart:Dm(g,v)}]:[!1,b,{}]}function Dm(e,n){return t=>{e&&e(t),t.defaultPrevented||n(t)}}function YD({page:e,...n}){let{router:t}=hk(),r=w.useMemo(()=>ik(t.routes,e,t.basename),[t.routes,e,t.basename]);return r?w.createElement(QD,{page:e,matches:r,...n}):null}function WD(e){let{manifest:n,routeModules:t}=pk(),[r,a]=w.useState([]);return w.useEffect(()=>{let s=!1;return FD(e,n,t).then(l=>{s||a(l)}),()=>{s=!0}},[e,n,t]),r}function QD({page:e,matches:n,...t}){let r=ni(),{manifest:a,routeModules:s}=pk(),{basename:l}=hk(),{loaderData:f,matches:d}=HD(),u=w.useMemo(()=>YS(e,n,d,a,r,"data"),[e,n,d,a,r]),h=w.useMemo(()=>YS(e,n,d,a,r,"assets"),[e,n,d,a,r]),g=w.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let S=new Set,k=!1;if(n.forEach(T=>{var D;let I=a.routes[T.route.id];!I||!I.hasLoader||(!u.some(q=>q.route.id===T.route.id)&&T.route.id in f&&((D=s[T.route.id])!=null&&D.shouldRevalidate)||I.hasClientLoader?k=!0:S.add(T.route.id))}),S.size===0)return[];let E=VD(e,l);return k&&S.size>0&&E.searchParams.set("_routes",n.filter(T=>S.has(T.route.id)).map(T=>T.route.id).join(",")),[E.pathname+E.search]},[l,f,r,a,u,n,e,s]),b=w.useMemo(()=>$D(h,a),[h,a]),v=WD(h);return w.createElement(w.Fragment,null,g.map(S=>w.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...t})),b.map(S=>w.createElement("link",{key:S,rel:"modulepreload",href:S,...t})),v.map(({key:S,link:k})=>w.createElement("link",{key:S,...k})))}function JD(...e){return n=>{e.forEach(t=>{typeof t=="function"?t(n):t!=null&&(t.current=n)})}}var mk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{mk&&(window.__reactRouterVersion="7.6.0")}catch{}function KD({basename:e,children:n,window:t}){let r=w.useRef();r.current==null&&(r.current=$P({window:t,v5Compat:!0}));let a=r.current,[s,l]=w.useState({action:a.action,location:a.location}),f=w.useCallback(d=>{w.startTransition(()=>l(d))},[l]);return w.useLayoutEffect(()=>a.listen(f),[a,f]),w.createElement(kD,{basename:e,children:n,location:s.location,navigationType:s.action,navigator:a})}var gk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,cs=w.forwardRef(function({onClick:n,discover:t="render",prefetch:r="none",relative:a,reloadDocument:s,replace:l,state:f,target:d,to:u,preventScrollReset:h,viewTransition:g,...b},v){let{basename:S}=w.useContext(Vs),k=typeof u=="string"&&gk.test(u),E,T=!1;if(typeof u=="string"&&k&&(E=u,mk))try{let V=new URL(window.location.href),L=u.startsWith("//")?new URL(V.protocol+u):new URL(u),$=Ol(L.pathname,S);L.origin===V.origin&&$!=null?u=$+L.search+L.hash:T=!0}catch{Us(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let I=fD(u,{relative:a}),[D,q,R]=GD(r,b),F=tI(u,{replace:l,state:f,target:d,preventScrollReset:h,relative:a,viewTransition:g});function U(V){n&&n(V),V.defaultPrevented||F(V)}let z=w.createElement("a",{...b,...R,href:E||I,onClick:T||s?n:U,ref:JD(v,q),target:d,"data-discover":!k&&t==="render"?"true":void 0});return D&&!k?w.createElement(w.Fragment,null,z,w.createElement(YD,{page:I})):z});cs.displayName="Link";var XD=w.forwardRef(function({"aria-current":n="page",caseSensitive:t=!1,className:r="",end:a=!1,style:s,to:l,viewTransition:f,children:d,...u},h){let g=mg(l,{relative:u.relative}),b=ni(),v=w.useContext(Fb),{navigator:S,basename:k}=w.useContext(Vs),E=v!=null&&sI(g)&&f===!0,T=S.encodeLocation?S.encodeLocation(g).pathname:g.pathname,I=b.pathname,D=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(I=I.toLowerCase(),D=D?D.toLowerCase():null,T=T.toLowerCase()),D&&k&&(D=Ol(D,k)||D);const q=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let R=I===T||!a&&I.startsWith(T)&&I.charAt(q)==="/",F=D!=null&&(D===T||!a&&D.startsWith(T)&&D.charAt(T.length)==="/"),U={isActive:R,isPending:F,isTransitioning:E},z=R?n:void 0,V;typeof r=="function"?V=r(U):V=[r,R?"active":null,F?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let L=typeof s=="function"?s(U):s;return w.createElement(cs,{...u,"aria-current":z,className:V,ref:h,style:L,to:l,viewTransition:f},typeof d=="function"?d(U):d)});XD.displayName="NavLink";var ZD=w.forwardRef(({discover:e="render",fetcherKey:n,navigate:t,reloadDocument:r,replace:a,state:s,method:l=Gx,action:f,onSubmit:d,relative:u,preventScrollReset:h,viewTransition:g,...b},v)=>{let S=iI(),k=aI(f,{relative:u}),E=l.toLowerCase()==="get"?"get":"post",T=typeof f=="string"&&gk.test(f),I=D=>{if(d&&d(D),D.defaultPrevented)return;D.preventDefault();let q=D.nativeEvent.submitter,R=(q==null?void 0:q.getAttribute("formmethod"))||l;S(q||D.currentTarget,{fetcherKey:n,method:R,navigate:t,replace:a,state:s,relative:u,preventScrollReset:h,viewTransition:g})};return w.createElement("form",{ref:v,method:E,action:k,onSubmit:r?d:I,...b,"data-discover":!T&&e==="render"?"true":void 0})});ZD.displayName="Form";function eI(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function yk(e){let n=w.useContext(qh);return or(n,eI(e)),n}function tI(e,{target:n,replace:t,state:r,preventScrollReset:a,relative:s,viewTransition:l}={}){let f=wt(),d=ni(),u=mg(e,{relative:s});return w.useCallback(h=>{if(DD(h,n)){h.preventDefault();let g=t!==void 0?t:rg(d)===rg(u);f(e,{replace:g,state:r,preventScrollReset:a,relative:s,viewTransition:l})}},[d,f,u,t,r,n,e,a,s,l])}var nI=0,rI=()=>`__${String(++nI)}__`;function iI(){let{router:e}=yk("useSubmit"),{basename:n}=w.useContext(Vs),t=ND();return w.useCallback(async(r,a={})=>{let{action:s,method:l,encType:f,formData:d,body:u}=RD(r,n);if(a.navigate===!1){let h=a.fetcherKey||rI();await e.fetch(h,t,a.action||s,{preventScrollReset:a.preventScrollReset,formData:d,body:u,formMethod:a.method||l,formEncType:a.encType||f,flushSync:a.flushSync})}else await e.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:d,body:u,formMethod:a.method||l,formEncType:a.encType||f,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,n,t])}function aI(e,{relative:n}={}){let{basename:t}=w.useContext(Vs),r=w.useContext(Hs);or(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),s={...mg(e||".",{relative:n})},l=ni();if(e==null){s.search=l.search;let f=new URLSearchParams(s.search),d=f.getAll("index");if(d.some(h=>h==="")){f.delete("index"),d.filter(g=>g).forEach(g=>f.append("index",g));let h=f.toString();s.search=h?`?${h}`:""}}return(!e||e===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(s.pathname=s.pathname==="/"?t:Il([t,s.pathname])),rg(s)}function sI(e,n={}){let t=w.useContext(lk);or(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=yk("useViewTransitionState"),a=mg(e,{relative:n.relative});if(!t.isTransitioning)return!1;let s=Ol(t.currentLocation.pathname,r)||t.currentLocation.pathname,l=Ol(t.nextLocation.pathname,r)||t.nextLocation.pathname;return ab(a.pathname,l)!=null||ab(a.pathname,s)!=null}[...qD];var oI=rk();class lI extends w.Component{constructor(){super(...arguments);Yn(this,"state",{hasError:!1})}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){console.error("Uncaught error:",t,r)}render(){return this.state.hasError?i.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"red",border:"1px solid red",borderRadius:"5px"},children:[i.jsx("h1",{children:"Something went wrong."}),i.jsx("p",{children:"We are sorry for the inconvenience. Please try again later."})]}):this.props.children}}const cI="https://backend.newtons.in",uI=()=>localStorage.getItem("authToken"),ge=async(e,n={})=>{const t=uI(),r={...n.headers};t&&(r.Authorization=`Bearer ${t}`),!(n.body instanceof FormData)&&!r["Content-Type"]&&(r["Content-Type"]="application/json");const a=r;let s=e.startsWith("/")?e:`/${e}`;s.startsWith("/api/")||(s=`/api${s}`);const l=`${cI}${s}`;try{console.log(`Making API call to: ${l}`);const f=await fetch(l,{...n,headers:a});if(f.status===401)throw console.error("Unauthorized access - Token might be invalid or expired. Logging out."),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser"),window.location.href="/login",new Error("Unauthorized");if(!f.ok){let d=`HTTP error! status: ${f.status}`;try{const u=await f.json();d=(u==null?void 0:u.message)||(u==null?void 0:u.error)||d}catch{}throw console.error(`API Error: ${f.status} ${f.statusText} - ${d}`),new Error(d)}return f}catch(f){throw f instanceof TypeError&&f.message==="Failed to fetch"?console.error("API Fetch Error: Network error or CORS issue. Check backend CORS configuration.",f):console.error("API Fetch Error:",f),f}},dI=({onLoginSuccess:e})=>{const[n,t]=w.useState(""),[r,a]=w.useState(""),[s,l]=w.useState(null),[f,d]=w.useState(!1),u=wt(),h=async g=>{g.preventDefault(),d(!0),l(null);try{const b=await ge("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});if(!b.ok){let S=`Login failed with status: ${b.status}`;try{S=(await b.json()).message||S}catch{try{const E=await b.text();E&&(S=`${S} - ${E}`)}catch{}}throw new Error(S)}const v=await b.json();console.log("Login successful:",v),localStorage.setItem("authToken",v.token),localStorage.setItem("currentUser",JSON.stringify(v.user)),v.user.clinic_id&&localStorage.setItem("currentClinicId",v.user.clinic_id),e(v.user),v.user.role==="doctor"?u("/dashboard/queue"):u("/dashboard")}catch(b){console.error("Login failed:",b),l(b.message||"Login failed. Please check your credentials.")}finally{d(!1)}};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Sign in to Newtons OPD Zero"}),i.jsxs("form",{onSubmit:h,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email address"}),i.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:n,onChange:g=>t(g.target.value),className:"auth-text-input",placeholder:"you@example.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"Password"}),i.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:r,onChange:g=>a(g.target.value),className:"auth-text-input",placeholder:"Password"})]}),s&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:s})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:f,className:"auth-submit-button",children:f?"Signing in...":"Sign In"})})]}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Don't have an account?"," ",i.jsx(cs,{to:"/register",className:"auth-navigation-link",children:"Register a new clinic"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})},fI=()=>{const[e,n]=w.useState(""),[t,r]=w.useState(""),[a,s]=w.useState(""),[l,f]=w.useState(""),[d,u]=w.useState(null),[h,g]=w.useState(!1),b=wt(),v=async S=>{S.preventDefault(),g(!0),u(null);try{const k=await ge("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicName:e,userName:t,userEmail:a,userPassword:l})}),E=await k.json();if(!k.ok)throw new Error(E.message||`HTTP error! status: ${k.status}`);console.log("Registration successful:",E),alert("Registration successful! Please log in."),b("/login")}catch(k){console.error("Registration failed:",k),u(k.message||"Registration failed. Please try again.")}finally{g(!1)}};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Register Clinic & Admin"}),i.jsxs("form",{onSubmit:v,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"clinicName",children:"Clinic Name"}),i.jsx("input",{id:"clinicName",name:"clinicName",type:"text",required:!0,value:e,onChange:S=>n(S.target.value),className:"auth-text-input",placeholder:"Your Clinic's Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userName",children:"Your Name (Admin)"}),i.jsx("input",{id:"userName",name:"userName",type:"text",required:!0,value:t,onChange:S=>r(S.target.value),className:"auth-text-input",placeholder:"Your Full Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userEmail",children:"Your Email (Admin Login)"}),i.jsx("input",{id:"userEmail",name:"userEmail",type:"email",autoComplete:"email",required:!0,value:a,onChange:S=>s(S.target.value),className:"auth-text-input",placeholder:"you@example.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userPassword",children:"Password"}),i.jsx("input",{id:"userPassword",name:"userPassword",type:"password",required:!0,minLength:6,value:l,onChange:S=>f(S.target.value),className:"auth-text-input",placeholder:"Min. 6 characters"})]}),d&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:d})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:h,className:"auth-submit-button",children:h?"Registering...":"Register Clinic & Admin"})})]}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Already have an account?"," ",i.jsx(cs,{to:"/login",className:"auth-navigation-link",children:"Sign in"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})};var xk={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},WS=Tn.createContext&&Tn.createContext(xk),hI=["attr","size","title"];function pI(e,n){if(e==null)return{};var t=mI(e,n),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}function mI(e,n){if(e==null)return{};var t={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(n.indexOf(r)>=0)continue;t[r]=e[r]}return t}function sb(){return sb=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},sb.apply(this,arguments)}function QS(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function ob(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?QS(Object(t),!0).forEach(function(r){gI(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):QS(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function gI(e,n,t){return n=yI(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function yI(e){var n=xI(e,"string");return typeof n=="symbol"?n:n+""}function xI(e,n){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function bk(e){return e&&e.map((n,t)=>Tn.createElement(n.tag,ob({key:t},n.attr),bk(n.child)))}function us(e){return n=>Tn.createElement(bI,sb({attr:ob({},e.attr)},n),bk(e.child))}function bI(e){var n=t=>{var{attr:r,size:a,title:s}=e,l=pI(e,hI),f=a||t.size||"1em",d;return t.className&&(d=t.className),e.className&&(d=(d?d+" ":"")+e.className),Tn.createElement("svg",sb({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,l,{className:d,style:ob(ob({color:e.color||t.color},t.style),e.style),height:f,width:f,xmlns:"http://www.w3.org/2000/svg"}),s&&Tn.createElement("title",null,s),e.children)};return WS!==void 0?Tn.createElement(WS.Consumer,null,t=>n(t)):n(xk)}function Im(e){return us({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(e)}function vI(e){return us({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function JS(e){return us({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M437.2 403.5L320 215V64h8c13.3 0 24-10.7 24-24V24c0-13.3-10.7-24-24-24H120c-13.3 0-24 10.7-24 24v16c0 13.3 10.7 24 24 24h8v151L10.8 403.5C-18.5 450.6 15.3 512 70.9 512h306.2c55.7 0 89.4-61.5 60.1-108.5zM137.9 320l48.2-77.6c3.7-5.2 5.8-11.6 5.8-18.4V64h64v160c0 6.9 2.2 13.2 5.8 18.4l48.2 77.6h-172z"},child:[]}]})(e)}function _h(e){return us({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function wx(e){return us({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M480 320a96 96 0 1 0-96-96 96 96 0 0 0 96 96zm48 32a22.88 22.88 0 0 0-7.06 1.09 124.76 124.76 0 0 1-81.89 0A22.82 22.82 0 0 0 432 352a112 112 0 0 0-112 112.62c.14 26.26 21.73 47.38 48 47.38h224c26.27 0 47.86-21.12 48-47.38A112 112 0 0 0 528 352zm-198.09 10.45A145.19 145.19 0 0 1 352 344.62V128a32 32 0 0 0-32-32h-32V32a32 32 0 0 0-32-32H96a32 32 0 0 0-32 32v64H32a32 32 0 0 0-32 32v368a16 16 0 0 0 16 16h288.31A78.62 78.62 0 0 1 288 464.79a143.06 143.06 0 0 1 41.91-102.34zM144 404a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm48-122a6 6 0 0 1-6 6h-20a6 6 0 0 1-6-6v-26h-26a6 6 0 0 1-6-6v-20a6 6 0 0 1 6-6h26V70a6 6 0 0 1 6-6h20a6 6 0 0 1 6 6v26h26a6 6 0 0 1 6 6v20a6 6 0 0 1-6 6h-26zm80 250a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12z"},child:[]}]})(e)}function Sx(e){return us({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M352 288h-16v-88c0-4.42-3.58-8-8-8h-13.58c-4.74 0-9.37 1.4-13.31 4.03l-15.33 10.22a7.994 7.994 0 0 0-2.22 11.09l8.88 13.31a7.994 7.994 0 0 0 11.09 2.22l.47-.31V288h-16c-4.42 0-8 3.58-8 8v16c0 4.42 3.58 8 8 8h64c4.42 0 8-3.58 8-8v-16c0-4.42-3.58-8-8-8zM608 64H32C14.33 64 0 78.33 0 96v320c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V96c0-17.67-14.33-32-32-32zM48 400v-64c35.35 0 64 28.65 64 64H48zm0-224v-64h64c0 35.35-28.65 64-64 64zm272 192c-53.02 0-96-50.15-96-112 0-61.86 42.98-112 96-112s96 50.14 96 112c0 61.87-43 112-96 112zm272 32h-64c0-35.35 28.65-64 64-64v64zm0-224c-35.35 0-64-28.65-64-64h64v64z"},child:[]}]})(e)}function Nx(e){return us({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M112 32C50.1 32 0 82.1 0 144v224c0 61.9 50.1 112 112 112s112-50.1 112-112V144c0-61.9-50.1-112-112-112zm48 224H64V144c0-26.5 21.5-48 48-48s48 21.5 48 48v112zm139.7-29.7c-3.5-3.5-9.4-3.1-12.3.8-45.3 62.5-40.4 150.1 15.9 206.4 56.3 56.3 143.9 61.2 206.4 15.9 4-2.9 4.3-8.8.8-12.3L299.7 226.3zm229.8-19c-56.3-56.3-143.9-61.2-206.4-15.9-4 2.9-4.3 8.8-.8 12.3l210.8 210.8c3.5 3.5 9.4 3.1 12.3-.8 45.3-62.6 40.5-150.1-15.9-206.4z"},child:[]}]})(e)}function kh(e){return us({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function vk(e){return us({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(e)}function KS(e){return us({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M447.1 112c-34.2.5-62.3 28.4-63 62.6-.5 24.3 12.5 45.6 32 56.8V344c0 57.3-50.2 104-112 104-60 0-109.2-44.1-111.9-99.2C265 333.8 320 269.2 320 192V36.6c0-11.4-8.1-21.3-19.3-23.5L237.8.5c-13-2.6-25.6 5.8-28.2 18.8L206.4 35c-2.6 13 5.8 25.6 18.8 28.2l30.7 6.1v121.4c0 52.9-42.2 96.7-95.1 97.2-53.4.5-96.9-42.7-96.9-96V69.4l30.7-6.1c13-2.6 21.4-15.2 18.8-28.2l-3.1-15.7C107.7 6.4 95.1-2 82.1.6L19.3 13C8.1 15.3 0 25.1 0 36.6V192c0 77.3 55.1 142 128.1 156.8C130.7 439.2 208.6 512 304 512c97 0 176-75.4 176-168V231.4c19.1-11.1 32-31.7 32-55.4 0-35.7-29.2-64.5-64.9-64zm.9 80c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16z"},child:[]}]})(e)}function fv(e){return us({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zM104 424c0 13.3 10.7 24 24 24s24-10.7 24-24-10.7-24-24-24-24 10.7-24 24zm216-135.4v49c36.5 7.4 64 39.8 64 78.4v41.7c0 7.6-5.4 14.2-12.9 15.7l-32.2 6.4c-4.3.9-8.5-1.9-9.4-6.3l-3.1-15.7c-.9-4.3 1.9-8.6 6.3-9.4l19.3-3.9V416c0-62.8-96-65.1-96 1.9v26.7l19.3 3.9c4.3.9 7.1 5.1 6.3 9.4l-3.1 15.7c-.9 4.3-5.1 7.1-9.4 6.3l-31.2-4.2c-7.9-1.1-13.8-7.8-13.8-15.9V416c0-38.6 27.5-70.9 64-78.4v-45.2c-2.2.7-4.4 1.1-6.6 1.9-18 6.3-37.3 9.8-57.4 9.8s-39.4-3.5-57.4-9.8c-7.4-2.6-14.9-4.2-22.6-5.2v81.6c23.1 6.9 40 28.1 40 53.4 0 30.9-25.1 56-56 56s-56-25.1-56-56c0-25.3 16.9-46.5 40-53.4v-80.4C48.5 301 0 355.8 0 422.4v44.8C0 491.9 20.1 512 44.8 512h358.4c24.7 0 44.8-20.1 44.8-44.8v-44.8c0-72-56.8-130.3-128-133.8z"},child:[]}]})(e)}function yh(e){return us({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(e)}const wk={superadmin:[{title:"Admin Pages",links:[{path:"/dashboard",name:"Super Admin Dashboard",icon:_h},{path:"/dashboard/clinic-subscriptions",name:"Clinic Subscriptions",icon:wx},{path:"/dashboard/users",name:"User Management",icon:yh}]}],admin:[{title:"Dashboard",links:[{path:"/dashboard",name:"Admin Dashboard",icon:_h}]},{title:"Staff Management",links:[{path:"/dashboard/staff",name:"Manage Staff",icon:yh},{path:"/dashboard/staff/add",name:"Add Staff",icon:fv}]},{title:"Patient Management",links:[{path:"/dashboard/patients/add",name:"Add Patient",icon:wx},{path:"/dashboard/patients",name:"All Patients",icon:yh},{path:"/dashboard/patients/search",name:"Search Patient",icon:kh}]},{title:"Inventory & Pharmacy",links:[{path:"/dashboard/analysis",name:"Inventory Analysis",icon:Im},{path:"/dashboard/inventory",name:"Pharmacy Inventory",icon:Nx},{path:"/dashboard/purchase",name:"Add Drug",icon:Nx},{path:"/dashboard/recurring-medications",name:"Recurring Medications",icon:Im},{path:"/dashboard/distributors",name:"Distributor Management",icon:yh}]},{title:"Queue & Subscriptions",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:KS},{path:"/dashboard/subscriptions",name:"Manage Subscriptions",icon:Sx},{path:"/dashboard/subscriptions/add",name:"Add Subscription Plan",icon:Sx}]}],doctor:[{title:"Patient & Admissions",links:[{path:"/dashboard/search",name:"Patient Search",icon:kh},{path:"/dashboard/add-patient",name:"Add Patient",icon:wx},{path:"/manage-admission",name:"Manage Admission",icon:fv}]},{title:"Lab & Billing",links:[{path:"/create-lab-order",name:"Create Lab Order",icon:JS},{path:"/billing",name:"Billing",icon:Sx}]},{title:"Queue",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:KS}]}],receptionist:[{title:"Reception",links:[{path:"/dashboard",name:"Reception Dashboard",icon:_h}]},{title:"Patient Management",links:[{path:"/dashboard/all-patients",name:"All Patients",icon:yh},{path:"/dashboard/patients/add",name:"Add Patient",icon:wx},{path:"/dashboard/patients/search",name:"Search Patient",icon:kh}]},{title:"Billing & Admissions",links:[{path:"/billing",name:"Billing",icon:Sx},{path:"/manage-admission",name:"Manage Admission",icon:fv}]}],lab:[{title:"Lab Operations",links:[{path:"/dashboard",name:"Lab Dashboard",icon:_h},{path:"/lab-inventory",name:"Lab Test Inventory",icon:JS},{path:"/lab/search-report",name:"Search Lab Report",icon:kh}]}],pharmacy:[{title:"Pharmacy Operations",links:[{path:"/dashboard",name:"Pharmacy Queue",icon:_h},{path:"/dashboard/inventory",name:"Pharmacy Inventory",icon:Nx},{path:"/dashboard/purchase",name:"Add Drug",icon:Nx},{path:"/dashboard/add-order",name:"Add Pharmacy Order",icon:Im},{path:"/dashboard/recurring-medications",name:"Recurring Medications",icon:Im},{path:"/dashboard/distributors",name:"Distributor Management",icon:yh}]},{title:"Analysis & Settings",links:[{path:"/dashboard/analysis",name:"Inventory Analysis",icon:Im},{path:"/dashboard/settings",name:"Pharmacy Settings",icon:vI},{path:"/dashboard/search-patient-records",name:"Search Patient Records",icon:kh}]}]},wI=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a})=>{const s=ni(),[l,f]=w.useState(""),d=wk[t]||[],[u,h]=w.useState(500),g=w.useRef(!1),b=w.useCallback(E=>{g.current=!0,E.preventDefault()},[]),v=w.useCallback(()=>{g.current=!1},[]),S=w.useCallback(E=>{if(g.current){const T=window.innerWidth-E.clientX;T>250&&T<window.innerWidth*.8&&h(T)}},[]);w.useEffect(()=>(window.addEventListener("mousemove",S),window.addEventListener("mouseup",v),()=>{window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",v)}),[S,v]);const k=d.map(E=>({...E,links:E.links.filter(T=>T.name.toLowerCase().includes(l.toLowerCase()))})).filter(E=>E.links.length>0);return i.jsxs("div",{className:`side-panel ${r?"open":""}`,style:{width:`${u}px`,right:r?"0":`-${u}px`},children:[i.jsx("div",{className:"resizer",onMouseDown:b}),i.jsxs("div",{className:"side-panel-header",children:[i.jsx(cs,{to:"/dashboard",className:"home-button",onClick:a,children:i.jsx(_h,{})}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx(kh,{style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",color:"#94a3b8"}}),i.jsx("input",{type:"text",placeholder:"Search pages...",className:"search-bar",value:l,onChange:E=>f(E.target.value)})]}),i.jsx("button",{className:"close-button",onClick:a,children:""})]}),i.jsx("nav",{children:k.map((E,T)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:E.title}),i.jsx("ul",{className:"sub-page-list",children:E.links.map(I=>{const D=I.icon;return i.jsx("li",{children:i.jsxs(cs,{to:I.path,className:s.pathname===I.path?"active":"",onClick:a,children:[D&&i.jsx(D,{})," ",I.name]})},I.path)})})]},T))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx(vk,{})," Logout"]})]})]})},SI=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a,roleNavigation:s})=>{const l=ni(),f=s[t]||[];return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:`mobile-side-panel-overlay ${r?"open":""}`,onClick:a}),i.jsxs("div",{className:`mobile-side-panel ${r?"open":""}`,children:[i.jsxs("div",{className:"mobile-side-panel-header",children:[i.jsx("h3",{children:"Menu"}),i.jsx("button",{className:"close-button",onClick:a,children:""})]}),i.jsx("nav",{children:f.map((d,u)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:d.title}),i.jsx("ul",{className:"sub-page-list",children:d.links.map(h=>{const g=h.icon;return i.jsx("li",{children:i.jsxs(cs,{to:h.path,className:l.pathname===h.path?"active":"",onClick:a,children:[g&&i.jsx(g,{})," ",h.name]})},h.path)})})]},u))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx(vk,{})," Logout"]})]})]})]})};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NI=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),CI=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,t,r)=>r?r.toUpperCase():t.toLowerCase()),XS=e=>{const n=CI(e);return n.charAt(0).toUpperCase()+n.slice(1)},Sk=(...e)=>e.filter((n,t,r)=>!!n&&n.trim()!==""&&r.indexOf(n)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var jI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _I=w.forwardRef(({color:e="currentColor",size:n=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:a="",children:s,iconNode:l,...f},d)=>w.createElement("svg",{ref:d,...jI,width:n,height:n,stroke:e,strokeWidth:r?Number(t)*24/Number(n):t,className:Sk("lucide",a),...f},[...l.map(([u,h])=>w.createElement(u,h)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=(e,n)=>{const t=w.forwardRef(({className:r,...a},s)=>w.createElement(_I,{ref:s,iconNode:n,className:Sk(`lucide-${NI(XS(e))}`,`lucide-${e}`,r),...a}));return t.displayName=XS(e),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kI=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],Uc=dt("arrow-down",kI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EI=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Ut=dt("arrow-left",EI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TI=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],Pl=dt("arrow-up",TI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AI=[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]],Pw=dt("beaker",AI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PI=[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]],DI=dt("bed-double",PI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const II=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],MI=dt("bell",II);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RI=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}]],OI=dt("bell-ring",RI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LI=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],m1=dt("brain",LI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FI=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],$I=dt("building",FI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]],BI=dt("calendar-check-2",zI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],qI=dt("calendar-days",UI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],lb=dt("calendar",VI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HI=[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]],GI=dt("chart-no-axes-column",HI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YI=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],WI=dt("check",YI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QI=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],cb=dt("chevron-down",QI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JI=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],zb=dt("chevron-left",JI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KI=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],gg=dt("chevron-right",KI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XI=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ub=dt("chevron-up",XI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Sr=dt("circle-alert",ZI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eM=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],$a=dt("circle-check-big",eM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]],nM=dt("circle-minus",tM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],ls=dt("circle-plus",rM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],aM=dt("circle-user",iM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sM=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],ZS=dt("clipboard-list",sM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oM=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],Nk=dt("clipboard",oM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lM=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],cM=dt("copy",lM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uM=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],g1=dt("credit-card",uM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dM=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Ad=dt("dollar-sign",dM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fM=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],y1=dt("eye",fM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hM=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],eN=dt("file-check",hM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pM=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Uo=dt("file-text",pM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mM=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],db=dt("flask-conical",mM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gM=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Ck=dt("funnel",gM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yM=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],kd=dt("hash",yM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xM=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],jk=dt("house",xM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],$o=dt("info",bM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vM=[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]],wM=dt("list-ordered",vM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SM=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],NM=dt("list",SM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CM=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Pd=dt("loader-circle",CM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jM=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],tN=dt("lock",jM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _M=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],kM=dt("message-square",_M);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EM=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],TM=dt("mic-off",EM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AM=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],_k=dt("mic",AM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PM=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],DM=dt("monitor",PM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IM=[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]],MM=dt("package-open",IM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RM=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Id=dt("package",RM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OM=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],LM=dt("paperclip",OM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FM=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],$M=dt("pause",FM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zM=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],jd=dt("pencil",zM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BM=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],UM=dt("phone",BM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qM=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],Bb=dt("pill",qM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VM=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],HM=dt("play",VM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GM=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Md=dt("plus",GM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YM=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Ml=dt("printer",YM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WM=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],fb=dt("refresh-cw",WM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QM=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Rd=dt("save",QM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JM=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],aa=dt("search",JM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KM=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],XM=dt("send",KM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZM=[["path",{d:"M6 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-2",key:"4b9dqc"}],["path",{d:"M6 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-2",key:"22nnkd"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m13 6-4 6h6l-4 6",key:"14hqih"}]],hb=dt("server-crash",ZM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],yg=dt("settings",eR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tR=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],nR=dt("share-2",tR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rR=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],iR=dt("shield-check",rR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aR=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],sR=dt("shopping-cart",aR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oR=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Od=dt("square-pen",oR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lR=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],cR=dt("stethoscope",lR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uR=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],dR=dt("table",uR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fR=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],hR=dt("tag",fR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pR=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],ti=dt("trash-2",pR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mR=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],kk=dt("triangle-alert",mR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gR=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],yR=dt("truck",gR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xR=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],nN=dt("upload",xR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],Ek=dt("user-check",bR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Tk=dt("user-plus",vR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wR=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Gc=dt("user",wR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],ig=dt("users",SR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NR=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],CR=dt("video",NR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jR=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Jn=dt("x",jR),_R="_container_djej9_1",kR="_title_djej9_17",ER="_filtersContainer_djej9_31",TR="_dateInputLabel_djej9_55",AR="_dateInput_djej9_55",PR="_fetchButton_djej9_105",DR="_summarySection_djej9_145",IR="_totalRevenue_djej9_153",MR="_totalRevenueAmount_djej9_175",RR="_card_djej9_187",OR="_cardTitle_djej9_203",LR="_cardList_djej9_217",FR="_cardListItem_djej9_227",$R="_cardListItemAmount_djej9_247",zR="_revenueGrid_djej9_257",BR="_revenueCard_djej9_271",UR="_revenueCardTitle_djej9_285",qR="_revenueCardAmount_djej9_297",VR="_revenueCardSubtitle_djej9_307",HR="_receptionRevenue_djej9_317",GR="_pharmacyRevenue_djej9_323",YR="_labRevenue_djej9_329",WR="_revenueCardList_djej9_337",QR="_tableSectionTitle_djej9_377",JR="_tableContainer_djej9_397",KR="_styledTable_djej9_411",XR="_capitalize_djej9_461",ZR="_noDataMessage_djej9_469",e4="_errorAlert_djej9_489",t4="_loadingContainer_djej9_521",n4="_breathingBall_djej9_543",Ct={container:_R,title:kR,filtersContainer:ER,dateInputLabel:TR,dateInput:AR,fetchButton:PR,summarySection:DR,totalRevenue:IR,totalRevenueAmount:MR,card:RR,cardTitle:OR,cardList:LR,cardListItem:FR,cardListItemAmount:$R,revenueGrid:zR,revenueCard:BR,revenueCardTitle:UR,revenueCardAmount:qR,revenueCardSubtitle:VR,receptionRevenue:HR,pharmacyRevenue:GR,labRevenue:YR,revenueCardList:WR,tableSectionTitle:QR,tableContainer:JR,styledTable:KR,capitalize:XR,noDataMessage:ZR,errorAlert:e4,loadingContainer:t4,breathingBall:n4},r4=()=>{const e=new Date().toISOString().split("T")[0],[n,t]=w.useState(e),[r,a]=w.useState(e),[s,l]=w.useState([]),[f,d]=w.useState([]),[u,h]=w.useState([]),[g,b]=w.useState(0),[v,S]=w.useState(0),[k,E]=w.useState(null),[T,I]=w.useState(null),[D,q]=w.useState({reception:{},pharmacy:{},lab:{}}),[R,F]=w.useState(!1),[U,z]=w.useState(null),V=async()=>{if(F(!0),z(null),l([]),d([]),h([]),b(0),S(0),E(null),I(null),q({reception:{},pharmacy:{},lab:{}}),!n||!r){z("Please select both start and end dates."),F(!1);return}if(new Date(n)>new Date(r)){z("Start date cannot be after end date."),F(!1);return}try{const[$,H,ee]=await Promise.all([ge(`/api/bills?startDate=${n}&endDate=${r}`),ge(`/api/payment/admission?startDate=${n}&endDate=${r}`),ge(`/api/subscriptions/transactions/manual?startDate=${n}&endDate=${r}`)]);if(!$.ok){const be=await $.json().catch(()=>({}));throw new Error(`Bills fetch error: ${be.message||$.statusText}`)}if(!H.ok){const be=await H.json().catch(()=>({}));throw new Error(`Admission Payments fetch error: ${be.message||H.statusText}`)}if(!ee.ok){const be=await ee.json().catch(()=>({}));throw new Error(`Manual Subscriptions fetch error: ${be.message||ee.statusText}`)}const te=await $.json(),ae=await H.json(),Z=await ee.json(),B=te.bills||[],K=ae.admissionPayments||[],oe=Z||[];l(B),d(K),h(oe);let A=0,se=0;const ue={},M={consultation:0,pharmacy:0,lab:0,other:0},pe={reception:{},pharmacy:{},lab:{}};B.forEach(be=>{if(be.status==="paid"||be.type==="pharmacy_return"){const fe=parseFloat(be.amount.toString()),Pe=be.payment_mode||"Unknown";let de=be.type||"other";de==="pharmacy_return"&&(se+=fe,de="pharmacy"),A+=fe,ue[Pe]=(ue[Pe]||0)+fe,M.hasOwnProperty(de)?M[de]=(M[de]||0)+fe:M.other=(M.other||0)+fe,de==="pharmacy"?pe.pharmacy[Pe]=(pe.pharmacy[Pe]||0)+fe:de==="lab"?pe.lab[Pe]=(pe.lab[Pe]||0)+fe:pe.reception[Pe]=(pe.reception[Pe]||0)+fe}}),K.forEach(be=>{const fe=parseFloat(be.amount_paid.toString()),Pe=be.payment_mode||"Unknown";A+=fe,ue[Pe]=(ue[Pe]||0)+fe,pe.reception[Pe]=(pe.reception[Pe]||0)+fe}),oe.forEach(be=>{var de,Me;const fe=parseFloat(((Me=(de=be.subscriptionPlan)==null?void 0:de.price)==null?void 0:Me.toString())??"0"),Pe=be.subscription_payment_method||"Unknown";A+=fe,ue[Pe]=(ue[Pe]||0)+fe,pe.reception[Pe]=(pe.reception[Pe]||0)+fe}),E(ue),I(M),q(pe),b(A),S(se)}catch($){console.error("Failed to fetch money flow data:",$),z($.message||"Failed to fetch data. Check console for details.")}finally{F(!1)}},L=()=>{V()};return i.jsxs("div",{className:Ct.container,children:[i.jsx("h2",{className:Ct.title,children:"Money Flow Analysis"}),i.jsxs("div",{className:Ct.filtersContainer,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"start-date-money",className:Ct.dateInputLabel,children:"Start Date:"}),i.jsx("input",{type:"date",id:"start-date-money",value:n,onChange:$=>t($.target.value),className:Ct.dateInput})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"end-date-money",className:Ct.dateInputLabel,children:"End Date:"}),i.jsx("input",{type:"date",id:"end-date-money",value:r,onChange:$=>a($.target.value),className:Ct.dateInput})]}),i.jsx("button",{onClick:L,disabled:R,className:Ct.fetchButton,children:R?"Loading...":"Fetch Data"})]}),U&&i.jsxs("div",{className:Ct.errorAlert,role:"alert",children:[i.jsx(Sr,{size:20})," ",i.jsxs("span",{children:["Error: ",U]})]}),!R&&!U&&(s.length>0||f.length>0||u.length>0)&&i.jsxs("div",{className:Ct.summarySection,children:[i.jsxs("h3",{className:Ct.totalRevenue,children:["Total Paid Revenue (",n," to ",r,"):",i.jsxs("span",{className:Ct.totalRevenueAmount,children:["",g.toFixed(2)]})]}),k&&Object.keys(k).length>0&&i.jsxs("div",{className:Ct.card,children:[i.jsx("h4",{className:Ct.cardTitle,children:"Revenue by Payment Mode:"}),i.jsx("ul",{className:Ct.cardList,children:Object.entries(k).map(([$,H])=>i.jsxs("li",{className:Ct.cardListItem,children:[$,": ",i.jsxs("span",{className:Ct.cardListItemAmount,children:["",H.toFixed(2)]})]},$))})]}),T&&D&&i.jsxs("div",{className:Ct.revenueGrid,children:[i.jsxs("div",{className:`${Ct.revenueCard} ${Ct.receptionRevenue}`,children:[i.jsx("h4",{className:Ct.revenueCardTitle,children:"Reception Revenue"}),i.jsxs("p",{className:Ct.revenueCardAmount,children:["",(T.consultation+T.other).toFixed(2)]}),i.jsx("span",{className:Ct.revenueCardSubtitle,children:"(Consultation + Other + Admissions + Subscriptions)"}),Object.keys(D.reception).length>0&&i.jsx("ul",{className:Ct.revenueCardList,children:Object.entries(D.reception).map(([$,H])=>i.jsxs("li",{children:[$,": ",i.jsxs("span",{children:["",H.toFixed(2)]})]},`reception-${$}`))})]}),i.jsxs("div",{className:`${Ct.revenueCard} ${Ct.pharmacyRevenue}`,children:[i.jsx("h4",{className:Ct.revenueCardTitle,children:"Pharmacy Revenue"}),i.jsxs("p",{className:Ct.revenueCardAmount,children:["",T.pharmacy.toFixed(2)]}),v<0&&i.jsxs("p",{className:Ct.revenueCardSubtitle,children:["Returns: ",i.jsxs("span",{className:Ct.negativeAmount,children:["",v.toFixed(2)]})]}),Object.keys(D.pharmacy).length>0&&i.jsx("ul",{className:Ct.revenueCardList,children:Object.entries(D.pharmacy).map(([$,H])=>i.jsxs("li",{children:[$,": ",i.jsxs("span",{children:["",H.toFixed(2)]})]},`pharmacy-${$}`))})]}),i.jsxs("div",{className:`${Ct.revenueCard} ${Ct.labRevenue}`,children:[i.jsx("h4",{className:Ct.revenueCardTitle,children:"Lab Revenue"}),i.jsxs("p",{className:Ct.revenueCardAmount,children:["",T.lab.toFixed(2)]}),Object.keys(D.lab).length>0&&i.jsx("ul",{className:Ct.revenueCardList,children:Object.entries(D.lab).map(([$,H])=>i.jsxs("li",{children:[$,": ",i.jsxs("span",{children:["",H.toFixed(2)]})]},`lab-${$}`))})]})]}),i.jsxs("h4",{className:Ct.tableSectionTitle,children:["Individual Bills (",s.filter($=>$.status==="paid"||$.type==="pharmacy_return").length,"):"]}),s.filter($=>$.status==="paid"||$.type==="pharmacy_return").length>0?i.jsx("div",{className:Ct.tableContainer,children:i.jsxs("table",{className:Ct.styledTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Bill ID"}),i.jsx("th",{children:"Patient ID"}),i.jsx("th",{children:"Type"}),i.jsx("th",{children:"Amount"}),i.jsx("th",{children:"Payment Mode"})]})}),i.jsx("tbody",{children:s.filter($=>$.status==="paid"||$.type==="pharmacy_return").map($=>i.jsxs("tr",{children:[i.jsx("td",{children:new Date($.createdAt).toLocaleDateString()}),i.jsx("td",{children:$.id}),i.jsx("td",{children:$.patient_id}),i.jsx("td",{className:Ct.capitalize,children:$.type}),i.jsxs("td",{children:["",parseFloat($.amount.toString()).toFixed(2)]}),i.jsx("td",{children:$.payment_mode})]},`bill-${$.id}`))})]})}):i.jsx("p",{className:Ct.noDataMessage,children:"No relevant bills found for the selected period."}),i.jsxs("h4",{className:Ct.tableSectionTitle,children:["Admission Payments (",f.length,"):"]}),f.length>0?i.jsx("div",{className:Ct.tableContainer,children:i.jsxs("table",{className:Ct.styledTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Payment ID"}),i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Payment Mode"})]})}),i.jsx("tbody",{children:f.map($=>{var H;return i.jsxs("tr",{children:[i.jsx("td",{children:new Date($.payment_date).toLocaleDateString()}),i.jsx("td",{children:$.id}),i.jsx("td",{children:((H=$.Patient)==null?void 0:H.name)??$.patient_id})," ",i.jsxs("td",{children:["",parseFloat($.amount_paid.toString()).toFixed(2)]}),i.jsx("td",{children:$.payment_mode})]},`admission-${$.id}`)})})]})}):i.jsx("p",{className:Ct.noDataMessage,children:"No admission payments found for the selected period."}),i.jsxs("h4",{className:Ct.tableSectionTitle,children:["Manual Subscription Payments (",u.length,"):"]}),u.length>0?i.jsx("div",{className:Ct.tableContainer,children:i.jsxs("table",{className:Ct.styledTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Start Date"}),i.jsx("th",{children:"Patient ID"}),i.jsx("th",{children:"Patient Name"}),i.jsx("th",{children:"Plan Name"}),i.jsx("th",{children:"Plan Amount"}),i.jsx("th",{children:"Payment Mode"})]})}),i.jsx("tbody",{children:u.map($=>{var H,ee,te;return i.jsxs("tr",{children:[i.jsx("td",{children:new Date($.subscription_start_date).toLocaleDateString()}),i.jsx("td",{children:$.id}),i.jsx("td",{children:$.name}),i.jsx("td",{children:((H=$.subscriptionPlan)==null?void 0:H.name)??"N/A"}),i.jsxs("td",{children:["",parseFloat(((te=(ee=$.subscriptionPlan)==null?void 0:ee.price)==null?void 0:te.toString())??"0").toFixed(2)]}),i.jsx("td",{className:Ct.capitalize,children:$.subscription_payment_method})]},`sub-patient-${$.id}`)})})]})}):i.jsx("p",{className:Ct.noDataMessage,children:"No manual subscription payments found for the selected period."})]}),R&&i.jsxs("div",{className:Ct.loadingContainer,children:[i.jsx("div",{className:Ct.breathingBall}),i.jsx("p",{children:"Loading data..."})]}),!R&&!U&&s.length===0&&f.length===0&&u.length===0&&i.jsx("p",{className:Ct.noDataMessage,children:"No data found for the selected period. Click 'Fetch Data'."})]})},i4=()=>{const e=localStorage.getItem("currentClinicId");return e||(console.warn("getCurrentClinicId: Clinic ID not found. Returning null. Ensure this is implemented correctly."),null)},Ak=()=>localStorage.getItem("authToken"),Dw=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!1),[a,s]=w.useState(null),[l,f]=w.useState(!1),[d,u]=w.useState(null),h=w.useRef(null),[g,b]=w.useState(!1),[v,S]=w.useState(null),[k,E]=w.useState(!1),[T,I]=w.useState(!1),[D,q]=w.useState(null),[R,F]=w.useState({name:"",description:"",price:"",default_parameters:[]}),U=w.useCallback(async()=>{r(!0),s(null),u(null),S(null);try{const ue=await ge("/api/lab-tests");if(!ue.ok)throw new Error(`HTTP error! status: ${ue.status}`);const M=await ue.json();n(M)}catch(ue){console.error("Error fetching lab tests:",ue),s(ue.message||"Failed to fetch lab tests.")}finally{r(!1)}},[]);w.useEffect(()=>{U()},[U]);const z=ue=>{const{name:M,value:pe}=ue.target;F(be=>({...be,[M]:pe}))},V=(ue,M,pe)=>{const be=[...R.default_parameters],fe=be[ue];if(M==="type")switch(fe.type=pe,pe){case"number":fe.defaultValue=0,fe.lower_limit=null,fe.upper_limit=null,fe.unit="";break;case"boolean":fe.defaultValue=!1,fe.lower_limit=void 0,fe.upper_limit=void 0,fe.unit=void 0;break;case"string":default:fe.defaultValue="",fe.lower_limit=void 0,fe.upper_limit=void 0,fe.unit=void 0;break}else M==="defaultValue"?fe.type==="number"?fe.defaultValue=parseFloat(pe)||0:(fe.type,fe.defaultValue=pe):M==="lower_limit"||M==="upper_limit"?fe[M]=pe===""?null:parseFloat(pe):fe[M]=pe;F(Pe=>({...Pe,default_parameters:be}))},L=()=>{F(ue=>({...ue,default_parameters:[...ue.default_parameters,{name:"",type:"string",defaultValue:"",unit:"",lower_limit:null,upper_limit:null}]}))},$=ue=>{F(M=>({...M,default_parameters:M.default_parameters.filter((pe,be)=>be!==ue)}))},H=async ue=>{ue.preventDefault(),r(!0),s(null);const M=D!==null,pe=M?`/api/lab-tests/${D}`:"/api/lab-tests",be=M?"PUT":"POST";try{const fe=await ge(pe,{method:be,headers:{"Content-Type":"application/json"},body:JSON.stringify({name:R.name,description:R.description,price:parseFloat(R.price),default_parameters:R.default_parameters})});if(!fe.ok){const Pe=await fe.json();throw new Error(Pe.message||`HTTP error! status: ${fe.status}`)}I(!1),q(null),F({name:"",description:"",price:"",default_parameters:[]}),U()}catch(fe){console.error(`Error ${M?"updating":"adding"} lab test:`,fe),s(fe.message||`Failed to ${M?"update":"add"} lab test.`)}finally{r(!1)}},ee=()=>{q(null),F({name:"",description:"",price:"",default_parameters:[]}),I(!0)},te=ue=>{if(D===ue.id)q(null);else{q(ue.id);const M=(ue.default_parameters||[]).map(pe=>({...pe,unit:pe.unit||"",lower_limit:pe.lower_limit===void 0?null:pe.lower_limit,upper_limit:pe.upper_limit===void 0?null:pe.upper_limit}));F({name:ue.name,description:ue.description||"",price:ue.price,default_parameters:M}),I(!1)}},ae=async ue=>{if(window.confirm("Are you sure you want to delete this lab test?")){r(!0),s(null);try{const M=await ge(`/api/lab-tests/${ue}`,{method:"DELETE"});if(!M.ok){const pe=await M.json();throw new Error(pe.message||`HTTP error! status: ${M.status}`)}U()}catch(M){console.error("Error deleting lab test:",M),s(M.message||"Failed to delete lab test.")}finally{r(!1)}}},Z=()=>{I(!1),q(null),s(null),F({name:"",description:"",price:"",default_parameters:[]})},B=async ue=>{if(!ue){u("No file selected.");return}f(!0),u(null),s(null);const M=new FormData;M.append("file",ue);try{const pe=await ge("/api/lab-tests/import",{method:"POST",body:M});if(!pe.ok){const be=await pe.json();throw new Error(be.message||`Import failed: ${pe.statusText}`)}U()}catch(pe){console.error("Error importing lab tests from Excel:",pe),u(pe.message||"Failed to import lab tests from Excel.")}finally{f(!1)}},K=async ue=>{if(ue.target.files&&ue.target.files[0]){const M=ue.target.files[0];await B(M),ue.target&&(ue.target.value="")}},oe=async()=>{if(window.confirm("Are you sure you want to import default biochemistry and pathology tests? This will add new tests and may duplicate existing ones if names match.")){b(!0),S(null),s(null);try{const ue=await ge("/api/lab-tests/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"}});if(!ue.ok){const M=await ue.json();throw new Error(M.message||`Default import failed: ${ue.statusText}`)}U()}catch(ue){console.error("Error importing default lab tests:",ue),S(ue.message||"Failed to import default lab tests.")}finally{b(!1)}}},A=async()=>{if(window.confirm("Are you sure you want to delete ALL lab tests? This action cannot be undone.")){E(!0),s(null),u(null),S(null);try{const ue=await ge("/api/lab-tests/all",{method:"DELETE"});if(!ue.ok){const M=await ue.json();throw new Error(M.message||`Delete all failed: ${ue.statusText}`)}U()}catch(ue){console.error("Error deleting all lab tests:",ue),s(ue.message||"Failed to delete all lab tests.")}finally{E(!1)}}},se=t||l||g||k;return i.jsxs("div",{className:"lab-inventory-card",children:[i.jsx("h2",{className:"lab-inventory-header",children:"Available Lab Tests"}),i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px"},children:[i.jsx("button",{onClick:ee,className:"lab-inventory-button",disabled:se,children:"Add New Test"}),i.jsx("button",{onClick:()=>{var ue;return(ue=h.current)==null?void 0:ue.click()},className:"lab-inventory-button lab-inventory-button-secondary",disabled:se,children:l?"Importing...":"Import from Excel"}),i.jsx("input",{type:"file",ref:h,onChange:K,accept:".xlsx, .xls",style:{display:"none"},disabled:l}),i.jsx("button",{onClick:oe,className:"lab-inventory-button lab-inventory-button-secondary",disabled:se,children:g?"Importing Defaults...":"Import Default Tests"}),i.jsx("button",{onClick:A,className:"lab-inventory-button lab-inventory-button-danger",disabled:se,style:{backgroundColor:"#dc3545",borderColor:"#dc3545",color:"white"},children:k?"Deleting All...":"Delete All Tests"})]}),a&&i.jsx("div",{className:"error-text mb-4",children:a}),d&&i.jsxs("div",{className:"error-text mb-4",children:["Import Excel Error: ",d]}),v&&i.jsxs("div",{className:"error-text mb-4",children:["Import Default Error: ",v]}),T&&i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"20px",marginBottom:"20px"},children:[" ",i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"1px solid #eee",marginBottom:"15px"},children:"Add New Lab Test"}),i.jsxs("form",{onSubmit:H,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:R.name,onChange:z,className:"lab-inventory-input",required:!0,disabled:se})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:R.description,onChange:z,rows:3,className:"lab-inventory-input",disabled:se})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:R.price,onChange:z,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:se})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginTop:"20px",marginBottom:"10px"},children:"Default Parameters"}),R.default_parameters.map((ue,M)=>{var pe,be;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:ue.name,onChange:fe=>V(M,"name",fe.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:ue.type,onChange:fe=>V(M,"type",fe.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),ue.type==="boolean"?i.jsxs("select",{value:ue.defaultValue.toString(),onChange:fe=>V(M,"defaultValue",fe.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:ue.type==="number"?"number":"text",placeholder:"Default Value",value:ue.defaultValue.toString(),onChange:fe=>V(M,"defaultValue",fe.target.value),className:"lab-inventory-input"}),ue.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:ue.lower_limit===null?"":((pe=ue.lower_limit)==null?void 0:pe.toString())??"",onChange:fe=>V(M,"lower_limit",fe.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:ue.upper_limit===null?"":((be=ue.upper_limit)==null?void 0:be.toString())??"",onChange:fe=>V(M,"upper_limit",fe.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:ue.unit||"",onChange:fe=>V(M,"unit",fe.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>$(M),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},M)}),i.jsx("button",{type:"button",onClick:L,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:Z,className:"lab-inventory-button lab-inventory-button-secondary",disabled:se,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:se,children:t?"Saving...":"Add Test"})]})]})]}),se&&!T&&i.jsxs("p",{className:"loading-text",children:[" ",l?"Importing Excel data...":g?"Importing default data...":"Loading tests..."]}),!se&&e.length===0&&!a&&!d&&!v&&i.jsx("p",{className:"no-data-message",children:"No lab tests found. Add one or import from Excel to get started."}),!se&&e.length>0&&i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{className:"hidden md:table-cell",children:"Description"})," ",i.jsx("th",{children:"Price"}),i.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),i.jsx("tbody",{children:e.map(ue=>{const M=D===ue.id,pe=ue.price&&typeof ue.price=="string"?parseFloat(ue.price):NaN,be=isNaN(pe)?"0.00":pe.toFixed(2);return i.jsxs(Tn.Fragment,{children:[i.jsxs("tr",{onClick:()=>te(ue),style:{cursor:"pointer"},children:[i.jsx("td",{children:ue.name}),i.jsx("td",{className:"hidden md:table-cell",style:{whiteSpace:"pre-wrap"},children:ue.description||"-"}),i.jsxs("td",{children:["",be]}),i.jsx("td",{style:{textAlign:"right"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[i.jsx("button",{onClick:fe=>{fe.stopPropagation(),te(ue)},className:"lab-inventory-link",disabled:se,style:{background:"none",border:"none",padding:"0",cursor:"pointer"},children:"Edit"}),i.jsx("button",{onClick:fe=>{fe.stopPropagation(),ae(ue.id)},className:"lab-inventory-link",disabled:se,style:{background:"none",border:"none",padding:"0",cursor:"pointer",color:"#dc3545"},children:"Delete"})]})})]}),M&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"10px",marginBottom:"10px",border:"1px solid #ddd",padding:"15px"},children:[i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em"},children:"Edit Lab Test"}),i.jsxs("form",{onSubmit:H,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:R.name,onChange:z,className:"lab-inventory-input",required:!0,disabled:se})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:R.description,onChange:z,rows:3,className:"lab-inventory-input",disabled:se})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:R.price,onChange:z,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:se})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",marginTop:"15px"},children:"Default Parameters"}),R.default_parameters.map((fe,Pe)=>{var de,Me;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:fe.name,onChange:Ze=>V(Pe,"name",Ze.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:fe.type,onChange:Ze=>V(Pe,"type",Ze.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),fe.type==="boolean"?i.jsxs("select",{value:fe.defaultValue.toString(),onChange:Ze=>V(Pe,"defaultValue",Ze.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:fe.type==="number"?"number":"text",placeholder:"Default Value",value:fe.defaultValue.toString(),onChange:Ze=>V(Pe,"defaultValue",Ze.target.value),className:"lab-inventory-input"}),fe.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:fe.lower_limit===null?"":((de=fe.lower_limit)==null?void 0:de.toString())??"",onChange:Ze=>V(Pe,"lower_limit",Ze.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:fe.upper_limit===null?"":((Me=fe.upper_limit)==null?void 0:Me.toString())??"",onChange:Ze=>V(Pe,"upper_limit",Ze.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:fe.unit||"",onChange:Ze=>V(Pe,"unit",Ze.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>$(Pe),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},Pe)}),i.jsx("button",{type:"button",onClick:L,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:Z,className:"lab-inventory-button lab-inventory-button-secondary",disabled:se,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:se,children:t?"Saving...":"Update Test"})]})]})]})})})]},ue.id)})})]})]})]})},Pk=6048e5,a4=864e5,Dk=6e4,Ik=36e5,rN=Symbol.for("constructDateFrom");function qs(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&rN in e?e[rN](n):e instanceof Date?new e.constructor(n):new Date(n)}function _i(e,n){return qs(n||e,e)}function x1(e,n,t){const r=_i(e,t==null?void 0:t.in);if(isNaN(n))return qs(e,NaN);if(!n)return r;const a=r.getDate(),s=qs(e,r.getTime());s.setMonth(r.getMonth()+n+1,0);const l=s.getDate();return a>=l?s:(r.setFullYear(s.getFullYear(),s.getMonth(),a),r)}let s4={};function Ub(){return s4}function ag(e,n){var f,d,u,h;const t=Ub(),r=(n==null?void 0:n.weekStartsOn)??((d=(f=n==null?void 0:n.locale)==null?void 0:f.options)==null?void 0:d.weekStartsOn)??t.weekStartsOn??((h=(u=t.locale)==null?void 0:u.options)==null?void 0:h.weekStartsOn)??0,a=_i(e,n==null?void 0:n.in),s=a.getDay(),l=(s<r?7:0)+s-r;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function pb(e,n){return ag(e,{...n,weekStartsOn:1})}function Mk(e,n){const t=_i(e,n==null?void 0:n.in),r=t.getFullYear(),a=qs(t,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const s=pb(a),l=qs(t,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const f=pb(l);return t.getTime()>=s.getTime()?r+1:t.getTime()>=f.getTime()?r:r-1}function iN(e){const n=_i(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function o4(e,...n){const t=qs.bind(null,n.find(r=>typeof r=="object"));return n.map(t)}function aN(e,n){const t=_i(e,n==null?void 0:n.in);return t.setHours(0,0,0,0),t}function l4(e,n,t){const[r,a]=o4(t==null?void 0:t.in,e,n),s=aN(r),l=aN(a),f=+s-iN(s),d=+l-iN(l);return Math.round((f-d)/a4)}function c4(e,n){const t=Mk(e,n),r=qs(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),pb(r)}function u4(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function sg(e){return!(!u4(e)&&typeof e!="number"||isNaN(+_i(e)))}function d4(e,n){const t=_i(e,n==null?void 0:n.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}const f4={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},h4=(e,n,t)=>{let r;const a=f4[e];return typeof a=="string"?r=a:n===1?r=a.one:r=a.other.replace("{{count}}",n.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function hv(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const p4={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},m4={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},g4={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},y4={date:hv({formats:p4,defaultWidth:"full"}),time:hv({formats:m4,defaultWidth:"full"}),dateTime:hv({formats:g4,defaultWidth:"full"})},x4={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},b4=(e,n,t,r)=>x4[e];function Mm(e){return(n,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,f=t!=null&&t.width?String(t.width):l;a=e.formattingValues[f]||e.formattingValues[l]}else{const l=e.defaultWidth,f=t!=null&&t.width?String(t.width):e.defaultWidth;a=e.values[f]||e.values[l]}const s=e.argumentCallback?e.argumentCallback(n):n;return a[s]}}const v4={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},w4={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},S4={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},N4={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},C4={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},j4={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},_4=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},k4={ordinalNumber:_4,era:Mm({values:v4,defaultWidth:"wide"}),quarter:Mm({values:w4,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Mm({values:S4,defaultWidth:"wide"}),day:Mm({values:N4,defaultWidth:"wide"}),dayPeriod:Mm({values:C4,defaultWidth:"wide",formattingValues:j4,defaultFormattingWidth:"wide"})};function Rm(e){return(n,t={})=>{const r=t.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],s=n.match(a);if(!s)return null;const l=s[0],f=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],d=Array.isArray(f)?T4(f,g=>g.test(l)):E4(f,g=>g.test(l));let u;u=e.valueCallback?e.valueCallback(d):d,u=t.valueCallback?t.valueCallback(u):u;const h=n.slice(l.length);return{value:u,rest:h}}}function E4(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function T4(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function A4(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const a=r[0],s=n.match(e.parsePattern);if(!s)return null;let l=e.valueCallback?e.valueCallback(s[0]):s[0];l=t.valueCallback?t.valueCallback(l):l;const f=n.slice(a.length);return{value:l,rest:f}}}const P4=/^(\d+)(th|st|nd|rd)?/i,D4=/\d+/i,I4={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},M4={any:[/^b/i,/^(a|c)/i]},R4={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},O4={any:[/1/i,/2/i,/3/i,/4/i]},L4={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},F4={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},$4={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},z4={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},B4={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},U4={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},q4={ordinalNumber:A4({matchPattern:P4,parsePattern:D4,valueCallback:e=>parseInt(e,10)}),era:Rm({matchPatterns:I4,defaultMatchWidth:"wide",parsePatterns:M4,defaultParseWidth:"any"}),quarter:Rm({matchPatterns:R4,defaultMatchWidth:"wide",parsePatterns:O4,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Rm({matchPatterns:L4,defaultMatchWidth:"wide",parsePatterns:F4,defaultParseWidth:"any"}),day:Rm({matchPatterns:$4,defaultMatchWidth:"wide",parsePatterns:z4,defaultParseWidth:"any"}),dayPeriod:Rm({matchPatterns:B4,defaultMatchWidth:"any",parsePatterns:U4,defaultParseWidth:"any"})},V4={code:"en-US",formatDistance:h4,formatLong:y4,formatRelative:b4,localize:k4,match:q4,options:{weekStartsOn:0,firstWeekContainsDate:1}};function H4(e,n){const t=_i(e,n==null?void 0:n.in);return l4(t,d4(t))+1}function G4(e,n){const t=_i(e,n==null?void 0:n.in),r=+pb(t)-+c4(t);return Math.round(r/Pk)+1}function Rk(e,n){var h,g,b,v;const t=_i(e,n==null?void 0:n.in),r=t.getFullYear(),a=Ub(),s=(n==null?void 0:n.firstWeekContainsDate)??((g=(h=n==null?void 0:n.locale)==null?void 0:h.options)==null?void 0:g.firstWeekContainsDate)??a.firstWeekContainsDate??((v=(b=a.locale)==null?void 0:b.options)==null?void 0:v.firstWeekContainsDate)??1,l=qs((n==null?void 0:n.in)||e,0);l.setFullYear(r+1,0,s),l.setHours(0,0,0,0);const f=ag(l,n),d=qs((n==null?void 0:n.in)||e,0);d.setFullYear(r,0,s),d.setHours(0,0,0,0);const u=ag(d,n);return+t>=+f?r+1:+t>=+u?r:r-1}function Y4(e,n){var f,d,u,h;const t=Ub(),r=(n==null?void 0:n.firstWeekContainsDate)??((d=(f=n==null?void 0:n.locale)==null?void 0:f.options)==null?void 0:d.firstWeekContainsDate)??t.firstWeekContainsDate??((h=(u=t.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??1,a=Rk(e,n),s=qs((n==null?void 0:n.in)||e,0);return s.setFullYear(a,0,r),s.setHours(0,0,0,0),ag(s,n)}function W4(e,n){const t=_i(e,n==null?void 0:n.in),r=+ag(t,n)-+Y4(t,n);return Math.round(r/Pk)+1}function In(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const Fc={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return In(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):In(t+1,2)},d(e,n){return In(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return In(e.getHours()%12||12,n.length)},H(e,n){return In(e.getHours(),n.length)},m(e,n){return In(e.getMinutes(),n.length)},s(e,n){return In(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,t-3));return In(a,n.length)}},xh={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},sN={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return t.ordinalNumber(a,{unit:"year"})}return Fc.y(e,n)},Y:function(e,n,t,r){const a=Rk(e,r),s=a>0?a:1-a;if(n==="YY"){const l=s%100;return In(l,2)}return n==="Yo"?t.ordinalNumber(s,{unit:"year"}):In(s,n.length)},R:function(e,n){const t=Mk(e);return In(t,n.length)},u:function(e,n){const t=e.getFullYear();return In(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return In(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return In(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return Fc.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return In(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const a=W4(e,r);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):In(a,n.length)},I:function(e,n,t){const r=G4(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):In(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):Fc.d(e,n)},D:function(e,n,t){const r=H4(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):In(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const a=e.getDay(),s=(a-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(s);case"ee":return In(s,2);case"eo":return t.ordinalNumber(s,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const a=e.getDay(),s=(a-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(s);case"cc":return In(s,n.length);case"co":return t.ordinalNumber(s,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),a=r===0?7:r;switch(n){case"i":return String(a);case"ii":return In(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let a;switch(r===12?a=xh.noon:r===0?a=xh.midnight:a=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let a;switch(r>=17?a=xh.evening:r>=12?a=xh.afternoon:r>=4?a=xh.morning:a=xh.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return Fc.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):Fc.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):In(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):In(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):Fc.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):Fc.s(e,n)},S:function(e,n){return Fc.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return lN(r);case"XXXX":case"XX":return Cd(r);case"XXXXX":case"XXX":default:return Cd(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return lN(r);case"xxxx":case"xx":return Cd(r);case"xxxxx":case"xxx":default:return Cd(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+oN(r,":");case"OOOO":default:return"GMT"+Cd(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+oN(r,":");case"zzzz":default:return"GMT"+Cd(r,":")}},t:function(e,n,t){const r=Math.trunc(+e/1e3);return In(r,n.length)},T:function(e,n,t){return In(+e,n.length)}};function oN(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),s=r%60;return s===0?t+String(a):t+String(a)+n+In(s,2)}function lN(e,n){return e%60===0?(e>0?"-":"+")+In(Math.abs(e)/60,2):Cd(e,n)}function Cd(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=In(Math.trunc(r/60),2),s=In(r%60,2);return t+a+n+s}const cN=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},Ok=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},Q4=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],a=t[2];if(!a)return cN(e,n);let s;switch(r){case"P":s=n.dateTime({width:"short"});break;case"PP":s=n.dateTime({width:"medium"});break;case"PPP":s=n.dateTime({width:"long"});break;case"PPPP":default:s=n.dateTime({width:"full"});break}return s.replace("{{date}}",cN(r,n)).replace("{{time}}",Ok(a,n))},J4={p:Ok,P:Q4},K4=/^D+$/,X4=/^Y+$/,Z4=["D","DD","YY","YYYY"];function eO(e){return K4.test(e)}function tO(e){return X4.test(e)}function nO(e,n,t){const r=rO(e,n,t);if(console.warn(r),Z4.includes(e))throw new RangeError(r)}function rO(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const iO=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,aO=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,sO=/^'([^]*?)'?$/,oO=/''/g,lO=/[a-zA-Z]/;function Oh(e,n,t){var h,g,b,v;const r=Ub(),a=r.locale??V4,s=r.firstWeekContainsDate??((g=(h=r.locale)==null?void 0:h.options)==null?void 0:g.firstWeekContainsDate)??1,l=r.weekStartsOn??((v=(b=r.locale)==null?void 0:b.options)==null?void 0:v.weekStartsOn)??0,f=_i(e,t==null?void 0:t.in);if(!sg(f))throw new RangeError("Invalid time value");let d=n.match(aO).map(S=>{const k=S[0];if(k==="p"||k==="P"){const E=J4[k];return E(S,a.formatLong)}return S}).join("").match(iO).map(S=>{if(S==="''")return{isToken:!1,value:"'"};const k=S[0];if(k==="'")return{isToken:!1,value:cO(S)};if(sN[k])return{isToken:!0,value:S};if(k.match(lO))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");return{isToken:!1,value:S}});a.localize.preprocessor&&(d=a.localize.preprocessor(f,d));const u={firstWeekContainsDate:s,weekStartsOn:l,locale:a};return d.map(S=>{if(!S.isToken)return S.value;const k=S.value;(tO(k)||eO(k))&&nO(k,n,String(e));const E=sN[k[0]];return E(f,k,a.localize,u)}).join("")}function cO(e){const n=e.match(sO);return n?n[1].replace(oO,"'"):e}function Ed(e,n){return+_i(e)<+_i(n)}function mb(e,n){const t=()=>qs(n==null?void 0:n.in,NaN),a=hO(e);let s;if(a.date){const u=pO(a.date,2);s=mO(u.restDateString,u.year)}if(!s||isNaN(+s))return t();const l=+s;let f=0,d;if(a.time&&(f=gO(a.time),isNaN(f)))return t();if(a.timezone){if(d=yO(a.timezone),isNaN(d))return t()}else{const u=new Date(l+f),h=_i(0,n==null?void 0:n.in);return h.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),h.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),h}return _i(l+f+d,n==null?void 0:n.in)}const Cx={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},uO=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,dO=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,fO=/^([+-])(\d{2})(?::?(\d{2}))?$/;function hO(e){const n={},t=e.split(Cx.dateTimeDelimiter);let r;if(t.length>2)return n;if(/:/.test(t[0])?r=t[0]:(n.date=t[0],r=t[1],Cx.timeZoneDelimiter.test(n.date)&&(n.date=e.split(Cx.timeZoneDelimiter)[0],r=e.substr(n.date.length,e.length))),r){const a=Cx.timezone.exec(r);a?(n.time=r.replace(a[1],""),n.timezone=a[1]):n.time=r}return n}function pO(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),r=e.match(t);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,s=r[2]?parseInt(r[2]):null;return{year:s===null?a:s*100,restDateString:e.slice((r[1]||r[2]).length)}}function mO(e,n){if(n===null)return new Date(NaN);const t=e.match(uO);if(!t)return new Date(NaN);const r=!!t[4],a=Om(t[1]),s=Om(t[2])-1,l=Om(t[3]),f=Om(t[4]),d=Om(t[5])-1;if(r)return SO(n,f,d)?xO(n,f,d):new Date(NaN);{const u=new Date(0);return!vO(n,s,l)||!wO(n,a)?new Date(NaN):(u.setUTCFullYear(n,s,Math.max(a,l)),u)}}function Om(e){return e?parseInt(e):1}function gO(e){const n=e.match(dO);if(!n)return NaN;const t=pv(n[1]),r=pv(n[2]),a=pv(n[3]);return NO(t,r,a)?t*Ik+r*Dk+a*1e3:NaN}function pv(e){return e&&parseFloat(e.replace(",","."))||0}function yO(e){if(e==="Z")return 0;const n=e.match(fO);if(!n)return 0;const t=n[1]==="+"?-1:1,r=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return CO(r,a)?t*(r*Ik+a*Dk):NaN}function xO(e,n,t){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,s=(n-1)*7+t+1-a;return r.setUTCDate(r.getUTCDate()+s),r}const bO=[31,null,31,30,31,30,31,31,30,31,30,31];function Lk(e){return e%400===0||e%4===0&&e%100!==0}function vO(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(bO[n]||(Lk(e)?29:28))}function wO(e,n){return n>=1&&n<=(Lk(e)?366:365)}function SO(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function NO(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function CO(e,n){return n>=0&&n<=59}const uN=10,jO=3,Fk=()=>{const e=wt(),[n,t]=w.useState([]),[r,a]=w.useState([]),[s,l]=w.useState(""),[f,d]=w.useState(!0),[u,h]=w.useState(null),[g,b]=w.useState(new Set),[v,S]=w.useState("all"),k=async()=>{try{const J=await ge("/api/inventory/download-csv");if(!J.ok)throw new Error(`Failed to download CSV: ${J.statusText}`);const Y=await J.blob(),X=window.URL.createObjectURL(Y),Ne=document.createElement("a");Ne.href=X,Ne.download="pharmacy_inventory.csv",document.body.appendChild(Ne),Ne.click(),Ne.remove(),window.URL.revokeObjectURL(X)}catch(J){console.error("Failed to download CSV:",J),h(J.message||"Failed to download inventory CSV. Please try again.")}},[E,T]=w.useState(!1),[I,D]=w.useState(!1),[q,R]=w.useState(null),[F,U]=w.useState(!1),[z,V]=w.useState(new Set),[L,$]=w.useState(null),[H,ee]=w.useState(0),[te,ae]=w.useState(!1),[Z,B]=w.useState(null),[K,oe]=w.useState(1),[A,se]=w.useState(!1),ue=w.useCallback(async()=>{d(!0),h(null);try{const J=await ge("/api/drugs");if(!J.ok)throw new Error(`Failed to fetch drugs: ${J.statusText} (${J.status})`);let Y=await J.json();Y=Y.map(X=>({...X,price:parseFloat(String(X.price))||0,buying_price:X.buying_price!==null&&X.buying_price!==void 0?parseFloat(String(X.buying_price)):null,quantity_in_stock:parseInt(String(X.quantity_in_stock),10)||0,gst:X.gst!==null&&X.gst!==void 0?parseFloat(String(X.gst)):null,margin:X.margin!==null&&X.margin!==void 0?parseFloat(String(X.margin)):null,discount:X.discount!==null&&X.discount!==void 0?parseFloat(String(X.discount)):null})),t(Y),a(Y)}catch(J){console.error("Failed to fetch drugs:",J),h(J.message||"Failed to load inventory. Please try again.")}finally{d(!1)}},[]);w.useEffect(()=>{ue()},[ue]),w.useEffect(()=>{const J=s.toLowerCase();let Y=n.filter(ke=>{var tt,Le,ot,et,bt;const Ue=((tt=ke.name)==null?void 0:tt.toLowerCase())||"",it=((Le=ke.description)==null?void 0:Le.toLowerCase())||"",mt=((ot=ke.supplier)==null?void 0:ot.toLowerCase())||"",ht=((et=ke.box_number)==null?void 0:et.toLowerCase())||"",Ve=((bt=ke.brand_name)==null?void 0:bt.toLowerCase())||"";return Ue.includes(J)||it.includes(J)||mt.includes(J)||ht.includes(J)||Ve.includes(J)});const X=new Date,Ne=x1(X,jO);v==="low-stock"?Y=Y.filter(ke=>ke.quantity_in_stock<=uN):v==="near-expiry"?Y=Y.filter(ke=>{if(!ke.expiry_date)return!1;const Ue=mb(ke.expiry_date);return sg(Ue)&&Ed(Ue,Ne)&&!Ed(Ue,X)}):v==="expired"&&(Y=Y.filter(ke=>{if(!ke.expiry_date)return!1;const Ue=mb(ke.expiry_date);return sg(Ue)&&Ed(Ue,X)})),a(Y)},[s,n,v]);const M=()=>{T(!1),$(null)},pe=J=>{ee(parseInt(J.target.value,10)||0)},be=async J=>{if(J.preventDefault(),h(null),!L||!L.id||H===0){h("No drug selected or adjustment amount is zero.");return}try{const Y=await ge(`/api/drugs/${L.id}/adjust-stock`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantityChange:H})});if(!Y.ok){const Ne=await Y.json();throw new Error(Ne.message||`Failed to adjust stock: ${Y.statusText}`)}const X=await Y.json();t(Ne=>Ne.map(ke=>ke.id===X.id?X:ke)),M(),alert(`Stock for "${X.name}" adjusted successfully. New stock: ${X.quantity_in_stock}`)}catch(Y){console.error("Failed to adjust stock:",Y),h(Y.message||"Failed to adjust stock. Please try again.")}},fe=J=>{R(J),D(!0)},Pe=()=>{D(!1),R(null)},de=async()=>{if(!q||!q.id){h("No drug selected for deletion.");return}d(!0),h(null);try{const J=await ge(`/api/drugs/${q.id}`,{method:"DELETE"});if(!J.ok){const Y=await J.json();throw new Error(Y.message||`Failed to delete drug: ${J.statusText}`)}alert(`Drug "${q.name}" deleted successfully.`),ue(),Pe()}catch(J){console.error("Failed to delete drug:",J),h(J.message||"Failed to delete drug. Please try again.")}finally{d(!1)}},Me=()=>{U(!0)},Ze=()=>{U(!1)},[Fe,Ce]=w.useState(!1),Re=()=>{z.size>0&&Ce(!0)},xe=()=>{Ce(!1)},Ie=async()=>{if(z.size===0){h("No drugs selected for deletion.");return}d(!0),h(null);try{const J=await ge("/api/drugs/batch-delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({drugIds:Array.from(z)})});if(!J.ok){const Y=await J.json();throw new Error(Y.message||`Failed to delete selected drugs: ${J.statusText}`)}alert(`${z.size} drug(s) deleted successfully.`),ue(),V(new Set),xe()}catch(J){console.error("Failed to delete selected drugs:",J),h(J.message||"Failed to delete selected drugs. Please try again.")}finally{d(!1)}},Ge=async()=>{d(!0),h(null);try{const J=await ge("/api/drugs/all",{method:"DELETE"});if(!J.ok){const Y=await J.json();throw new Error(Y.message||`Failed to delete all drugs: ${J.statusText}`)}alert("All drugs deleted successfully."),ue(),Ze()}catch(J){console.error("Failed to delete all drugs:",J),h(J.message||"Failed to delete all drugs. Please try again.")}finally{d(!1)}},ze=J=>{if(!J)return null;const Y=J.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return Y?parseInt(Y[1],10):null},nt=J=>{B(J),oe(1),ae(!0)},jt=()=>{ae(!1),B(null),oe(1)},xt=J=>{oe(parseInt(J.target.value,10)||0)},ve=async J=>{if(J.preventDefault(),h(null),!Z||!Z.id||K<=0){h("No drug selected or invalid number of packs to convert.");return}const Y=ze(Z.unit);if(!Y||Y<=0){h(`Cannot convert "${Z.name}" to loose. Invalid pack unit: ${Z.unit||"N/A"}.`);return}if(K>(Z.quantity_in_stock??0)){h(`Cannot convert ${K} packs. Only ${Z.quantity_in_stock??0} packs are in stock.`);return}try{const X=await ge(`/api/drugs/${Z.id}/convert-to-loose`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({packsToConvert:K,packSize:Y})});if(!X.ok){const ke=await X.json();throw new Error(ke.message||`Failed to convert to loose: ${X.statusText}`)}const Ne=await X.json();t(ke=>ke.map(Ue=>Ue.id===Ne.id?Ne:Ue)),jt(),alert(`Converted ${K} pack(s) of "${Ne.name}" to loose. New stock: ${Ne.quantity_in_stock} packs, ${Ne.loose??0} loose units.`)}catch(X){console.error("Failed to convert to loose:",X),h(X.message||"Failed to convert to loose. Please try again.")}finally{d(!1)}},qe=()=>{se(!0)},Qe=()=>{se(!1)},Be=async()=>{d(!0),h(null);try{const J=await ge("/api/drugs/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!J.ok){const Y=await J.json();throw new Error(Y.message||`Failed to add default medications: ${J.statusText}`)}alert("Default medications added successfully."),ue(),Qe()}catch(J){console.error("Failed to add default medications:",J),h(J.message||"Failed to add default medications. Please try again.")}finally{d(!1)}};return f?i.jsx("div",{className:"loading-indicator",children:"Loading Inventory..."}):u?i.jsxs("div",{className:"error-indicator",children:["Error: ",u]}):i.jsxs("div",{className:"pharmacy-inventory-page",children:[i.jsxs("div",{className:"inventory-header-controls",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsx("button",{onClick:()=>e(-1),className:"action-icon-button",title:"Go Back",children:i.jsx(Ut,{size:24})}),i.jsx("h2",{className:"inventory-page-title",children:"Pharmacy Inventory"})]}),i.jsxs("div",{className:"inventory-actions-group",children:[i.jsxs("div",{className:"action-group-left",children:[i.jsxs("button",{onClick:()=>e("/dashboard/purchase"),className:"action-button add-drug-button",children:[i.jsx(ls,{size:18,className:"button-icon"}),"Add New Drug"]}),i.jsxs("button",{onClick:()=>e("/dashboard/purchase"),className:"action-button add-purchase-button",children:[i.jsx(ls,{size:18,className:"button-icon"}),"Open Purchase Page"]}),i.jsxs("button",{onClick:()=>e("/dashboard/distributors"),className:"action-button view-distributors-button",children:[i.jsx(ls,{size:18,className:"button-icon"}),"View Distributors"]})]}),i.jsxs("div",{className:"action-group-right",children:[i.jsx("button",{onClick:k,className:"action-button download-csv-button",children:"Download CSV"}),i.jsxs("button",{onClick:qe,className:"action-button add-defaults-button",children:[i.jsx(ls,{size:18,className:"button-icon"}),"Add Default Medications"]}),i.jsxs("button",{onClick:Re,className:"action-button delete-selected-drugs-button",disabled:z.size===0,children:[i.jsx(ti,{size:18,className:"button-icon"}),"Delete Selected (",z.size,")"]}),i.jsxs("button",{onClick:Me,className:"action-button delete-all-drugs-button",children:[i.jsx(ti,{size:18,className:"button-icon"}),"Delete All Drugs"]})]})]})]}),i.jsxs("div",{className:"search-bar-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search drugs by name, brand, description, or supplier...",value:s,onChange:J=>l(J.target.value),className:"inventory-search-input"}),i.jsx(aa,{size:18,className:"search-input-icon"})]}),i.jsxs("div",{className:"filter-dropdown-wrapper",children:[i.jsx("label",{htmlFor:"filter-option",className:"sr-only",children:"Filter Inventory"}),i.jsxs("select",{id:"filter-option",value:v,onChange:J=>S(J.target.value),className:"inventory-filter-select",children:[i.jsx("option",{value:"all",children:"All Drugs"}),i.jsx("option",{value:"low-stock",children:"Low Stock"}),i.jsx("option",{value:"near-expiry",children:"Near Expiry"}),i.jsx("option",{value:"expired",children:"Expired"})]})]})]}),i.jsx("div",{className:"inventory-table-container",children:i.jsxs("table",{className:"inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"checkbox-header",children:i.jsx("input",{type:"checkbox",onChange:J=>{if(J.target.checked){const Y=new Set(r.map(X=>X.id));V(Y)}else V(new Set)},checked:z.size===r.length&&r.length>0,disabled:r.length===0})}),i.jsx("th",{className:"drug-name-header",children:"Drug Name"}),i.jsx("th",{className:"brand-name-header",children:"Brand Name"}),i.jsx("th",{className:"pack-header",children:"Pack"}),i.jsx("th",{className:"expiry-header",children:"Expiry"}),i.jsx("th",{className:"text-stock qty-header",children:"Stock"}),i.jsx("th",{className:"text-price mrp-header",children:"MRP"}),i.jsx("th",{className:"text-cost rate-header",children:"Rate"}),i.jsx("th",{className:"box-number-header",children:"Box Number"}),i.jsx("th",{className:"discount-header",children:"Discount (%)"}),i.jsx("th",{className:"margin-header",children:"Margin (%)"}),i.jsx("th",{className:"hidden-loose-price",children:"Loose Price"}),i.jsx("th",{className:"actions-cell",children:"Actions"}),i.jsx("th",{className:"expand-collapse-header"})]})}),i.jsxs("tbody",{children:[r.length===0&&i.jsx("tr",{className:"no-results-message",children:i.jsx("td",{colSpan:15,children:"No drugs found matching your search."})}),r.map(J=>i.jsxs(i.Fragment,{children:[i.jsxs("tr",{className:"drug-row",onClick:()=>{const Y=new Set(g);Y.has(J.id)&&J.id!==void 0?Y.delete(J.id):J.id!==void 0&&Y.add(J.id),b(Y)},children:[i.jsx("td",{className:"checkbox-cell",children:i.jsx("input",{type:"checkbox",onClick:Y=>Y.stopPropagation(),checked:z.has(J.id),onChange:()=>{const Y=new Set(z);Y.has(J.id)?Y.delete(J.id):Y.add(J.id),V(Y)}})}),i.jsx("td",{className:"drug-name-cell",children:J.name||"-"}),i.jsx("td",{className:"brand-name-cell",children:J.brand_name||"-"}),i.jsx("td",{className:"text-muted pack-cell",children:J.unit||"-"}),i.jsx("td",{className:"text-muted",children:J.expiry_date?new Date(J.expiry_date).toLocaleDateString():"-"}),i.jsxs("td",{className:`text-stock ${J.quantity_in_stock<=uN?"low-stock":""}`,children:[i.jsxs("div",{children:[J.quantity_in_stock," packs"]}),i.jsx("div",{className:"loose-quantity",children:J.loose!==null&&J.loose!==void 0?`${J.loose} loose`:""})]}),i.jsxs("td",{className:"text-muted text-price",children:["",typeof J.price=="number"?J.price.toFixed(2):"N/A"]}),i.jsx("td",{className:"text-muted text-cost",children:J.buying_price!==null&&J.buying_price!==void 0?`${J.buying_price.toFixed(2)}`:"-"}),i.jsx("td",{className:"text-muted",children:J.box_number||"-"}),i.jsx("td",{className:"text-muted",children:J.discount!==null&&J.discount!==void 0?`${J.discount.toFixed(2)}%`:"-"}),i.jsx("td",{className:"text-muted",children:(()=>{const Y=J.price||0,X=J.buying_price||0,Ne=J.discount||0,ke=J.gst||0,it=X*(1-Ne/100)*(1+ke/100),mt=Y-it;return`${(Y>0?mt/Y*100:0).toFixed(2)}%`})()}),i.jsx("td",{className:"text-muted hidden-loose-price",children:(()=>{const Y=ze(J.unit);return Y&&Y>0&&typeof J.price=="number"?`${(J.price/Y).toFixed(2)}`:"N/A"})()}),i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsx("button",{onClick:()=>e(`/dashboard/inventory/edit/${J.id}`),className:"action-icon-button",title:"Edit Drug",children:i.jsx(Od,{size:18})}),i.jsx("button",{onClick:()=>fe(J),className:"action-icon-button delete-button",title:"Delete Drug",children:i.jsx(ti,{size:18})}),i.jsx("button",{onClick:()=>{$(J),T(!0)},className:"action-icon-button adjust-stock-button",title:"Adjust Stock",children:i.jsx(nM,{size:18})}),i.jsx("button",{onClick:()=>nt(J),className:"action-icon-button convert-to-loose-button",title:"Convert to Loose",disabled:!J.unit||ze(J.unit)===null,children:i.jsx(MM,{size:18})})]})}),i.jsx("td",{className:"expand-collapse-cell",children:g.has(J.id)?i.jsx(ub,{size:20}):i.jsx(cb,{size:20})})]},J.id),g.has(J.id)&&i.jsx("tr",{className:"collapsible-row",children:i.jsx("td",{colSpan:15,children:i.jsxs("div",{className:"collapsible-content",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Drug Name:"})," ",J.name||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Description:"})," ",J.description||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Supplier:"})," ",J.supplier||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Brand Name:"})," ",J.brand_name||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Batch:"})," ",J.batch||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"HSN Code:"})," ",J.hsn_code||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"MFG:"})," ",J.mfg||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Loose:"})," ",J.loose!==null&&J.loose!==void 0?J.loose:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Loose Price:"}),(()=>{const Y=ze(J.unit);return Y&&Y>0&&typeof J.price=="number"?`${(J.price/Y).toFixed(2)}`:"N/A"})()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"GST:"})," ",J.gst!==null&&J.gst!==void 0?`${J.gst.toFixed(2)}%`:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Discount:"})," ",J.discount!==null&&J.discount!==void 0?`${J.discount.toFixed(2)}%`:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Calculated Margin:"}),(()=>{const Y=J.price||0,X=J.buying_price||0,Ne=J.discount||0,ke=J.gst||0,it=X*(1-Ne/100)*(1+ke/100),mt=Y-it;return`${(Y>0?mt/Y*100:0).toFixed(2)}%`})()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Last Updated:"})," ",new Date(J.last_updated).toLocaleString()]})]})})})]}))]})]})}),I&&q&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Pe,className:"modal-close-button",children:i.jsx(Jn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion"}),i.jsxs("p",{className:"modal-description",children:['Are you sure you want to delete "',i.jsx("span",{className:"drug-name",children:q.name||"Unnamed Drug"}),'"? This action cannot be undone.']}),u&&i.jsx("div",{className:"modal-error-message",children:u}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Pe,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:de,className:"button-delete",children:"Delete"})]})]})}),E&&L&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:M,className:"modal-close-button",children:i.jsx(Jn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Adjust Stock"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:L.name||"Unnamed Drug"}),i.jsx("br",{}),"Current Stock: ",L.quantity_in_stock]}),u&&i.jsx("div",{className:"modal-error-message",children:u}),i.jsxs("form",{onSubmit:be,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"adjustment",className:"form-label",children:"Adjustment Amount"}),i.jsx("input",{type:"number",name:"adjustment",id:"adjustment",required:!0,step:"1",value:H,onChange:pe,placeholder:"e.g., 10 or -5",className:"form-input"}),i.jsx("p",{className:"form-help-text",children:"Enter a positive number to add stock, negative to remove."})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:M,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Adjust Stock"})]})]})]})}),F&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Ze,className:"modal-close-button",children:i.jsx(Jn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of All Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:"ALL"})," drugs from the inventory? This action cannot be undone."]}),u&&i.jsx("div",{className:"modal-error-message",children:u}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Ze,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Ge,className:"button-delete",children:"Delete All"})]})]})}),Fe&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:xe,className:"modal-close-button",children:i.jsx(Jn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of Selected Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:z.size})," selected drug(s)? This action cannot be undone."]}),u&&i.jsx("div",{className:"modal-error-message",children:u}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:xe,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Ie,className:"button-delete",children:"Delete Selected"})]})]})}),te&&Z&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:jt,className:"modal-close-button",children:i.jsx(Jn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Convert Pack to Loose"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:Z.name||"Unnamed Drug"}),i.jsx("br",{}),"Current Packs in Stock: ",Z.quantity_in_stock??0,i.jsx("br",{}),"Current Loose Units: ",Z.loose??0,i.jsx("br",{}),"Pack Size: ",ze(Z.unit)||"N/A"," units per pack"]}),u&&i.jsx("div",{className:"modal-error-message",children:u}),i.jsxs("form",{onSubmit:ve,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"packs-to-convert",className:"form-label",children:"Number of Packs to Convert"}),i.jsx("input",{type:"number",name:"packs-to-convert",id:"packs-to-convert",required:!0,min:"1",step:"1",value:K,onChange:xt,placeholder:"e.g., 1",className:"form-input"}),i.jsxs("p",{className:"form-help-text",children:["This will reduce pack quantity by ",K," and add ",K*(ze(Z.unit)||0)," to loose quantity."]})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:jt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Convert to Loose"})]})]})]})}),A&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Qe,className:"modal-close-button",children:i.jsx(Jn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Add Default Medications"}),i.jsx("p",{className:"modal-description",children:"Are you sure you want to add default medications to the inventory? This will add a predefined set of common medications."}),u&&i.jsx("div",{className:"modal-error-message",children:u}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Qe,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Be,className:"button-submit",children:"Add Defaults"})]})]})})]})},_O="_container_1ihgb_1",kO="_title_1ihgb_17",EO="_dateRangeContainer_1ihgb_31",TO="_dateInputLabel_1ihgb_51",AO="_dateInput_1ihgb_51",PO="_fetchButton_1ihgb_87",DO="_sectionTitle_1ihgb_123",IO="_tableContainer_1ihgb_137",MO="_analysisTable_1ihgb_153",RO="_textRight_1ihgb_217",OO="_textGreen_1ihgb_225",LO="_textRed_1ihgb_233",FO="_textOrange_1ihgb_249",$O="_alertBox_1ihgb_265",zO="_alertBoxError_1ihgb_283",BO="_alertBoxIcon_1ihgb_295",UO="_loadingContainer_1ihgb_303",qO="_viewSwitcher_1ihgb_321",VO="_viewButton_1ihgb_339",HO="_viewButtonActive_1ihgb_365",GO="_viewButtonInactive_1ihgb_383",YO="_reasonDistribution_1ihgb_497",WO="_totalRow_1ihgb_513",Ht={container:_O,title:kO,dateRangeContainer:EO,dateInputLabel:TO,dateInput:AO,fetchButton:PO,sectionTitle:DO,tableContainer:IO,analysisTable:MO,textRight:RO,textGreen:OO,textRed:LO,textOrange:FO,alertBox:$O,alertBoxError:zO,alertBoxIcon:BO,loadingContainer:UO,viewSwitcher:qO,viewButton:VO,viewButtonActive:HO,viewButtonInactive:GO,reasonDistribution:YO,totalRow:WO},b1=()=>{const e=wt(),n=new Date().toISOString().split("T")[0],[t,r]=w.useState(n),[a,s]=w.useState(n),[l,f]=w.useState(null),[d,u]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState("analysis"),S=async()=>{if(u(!0),g(null),f(null),!t||!a){g("Please select both start and end dates."),u(!1);return}if(new Date(t)>new Date(a)){g("Start date cannot be after end date."),u(!1);return}try{const T=i4();if(!T){g("Clinic ID not found. Please log in again."),u(!1);return}const I=await ge(`/api/inventory/comprehensive-analysis?startDate=${t}&endDate=${a}&clinicId=${T}`);if(!I.ok){const q=await I.json();throw new Error(q.message||`HTTP error! status: ${I.status}`)}const D=await I.json();f(D)}catch(T){console.error("Failed to fetch comprehensive inventory analysis data:",T),g(T.message||"Failed to fetch data. Check console for details.")}finally{u(!1)}},k=()=>{S()},E=T=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(T);return i.jsxs("div",{className:Ht.container,children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[" ",i.jsx("h2",{className:Ht.title,children:"Inventory Analysis & Management"}),i.jsx("button",{onClick:()=>e(-1),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 text-sm",children:"Back"})]}),i.jsxs("div",{className:Ht.viewSwitcher,children:[i.jsxs("button",{onClick:()=>v("analysis"),className:`${Ht.viewButton} ${b==="analysis"?Ht.viewButtonActive:Ht.viewButtonInactive}`,children:[i.jsx(GI,{size:16})," ","Analysis"]}),i.jsxs("button",{onClick:()=>v("labInventory"),className:`${Ht.viewButton} ${b==="labInventory"?Ht.viewButtonActive:Ht.viewButtonInactive}`,children:[i.jsx(Pw,{size:16}),"Lab Test Inventory"]}),i.jsxs("button",{onClick:()=>e("/dashboard/inventory"),className:`${Ht.viewButton} ${b==="pharmacyInventory"?Ht.viewButtonActive:Ht.viewButtonInactive}`,children:[i.jsx(Bb,{size:16}),"Pharmacy Inventory"]})]}),b==="analysis"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:Ht.dateRangeContainer,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"start-date-inventory",className:Ht.dateInputLabel,children:"Start Date:"}),i.jsx("input",{type:"date",id:"start-date-inventory",value:t,onChange:T=>r(T.target.value),className:Ht.dateInput})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"end-date-inventory",className:Ht.dateInputLabel,children:"End Date:"}),i.jsx("input",{type:"date",id:"end-date-inventory",value:a,onChange:T=>s(T.target.value),className:Ht.dateInput})]}),i.jsx("button",{onClick:k,disabled:d,className:Ht.fetchButton,children:d?"Loading...":"Fetch Comprehensive Analysis"})]}),h&&i.jsxs("div",{className:`${Ht.alertBox} ${Ht.alertBoxError}`,role:"alert",children:[i.jsx("div",{className:Ht.alertBoxIcon,children:i.jsx(Sr,{size:18})}),i.jsxs("div",{children:[" ",i.jsxs("span",{children:["Error: ",h]})]})]}),d&&i.jsxs("div",{className:Ht.loadingContainer,children:[" ",i.jsx("p",{children:"Loading data..."})]}),l&&!d&&i.jsxs("div",{className:"space-y-6",children:[" ",i.jsxs("div",{children:[i.jsxs("h3",{className:Ht.sectionTitle,children:["Pharmacy Inventory Changes (",l.startDate," to ",l.endDate,")"]}),l.pharmacyAnalysis.length>0?i.jsx("div",{className:Ht.tableContainer,children:i.jsxs("table",{className:Ht.analysisTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Drug Name"}),i.jsx("th",{children:"Unit"}),i.jsx("th",{className:Ht.textRight,children:"Price"}),i.jsx("th",{children:"Qty In (+)"}),i.jsx("th",{className:Ht.textRight,children:"Packs Out (-)"}),i.jsx("th",{className:Ht.textRight,children:"Loose Qty Out (-)"}),i.jsx("th",{className:Ht.textRight,children:"Packs Converted"})]})}),i.jsx("tbody",{children:l.pharmacyAnalysis.map(T=>i.jsxs("tr",{children:[i.jsx("td",{children:T.name}),i.jsx("td",{children:T.unit||"N/A"}),i.jsx("td",{className:Ht.textRight,children:E(T.price)}),i.jsxs("td",{className:Ht.textGreen,children:[" ",i.jsxs("div",{className:Ht.reasonDistribution,children:[Object.entries(T.quantity_in_by_reason).map(([I,D])=>i.jsxs("div",{children:[i.jsxs("span",{children:[I,":"]}),i.jsx("span",{children:D})]},I)),Object.keys(T.quantity_in_by_reason).length>0&&i.jsxs("div",{className:Ht.totalRow,children:[i.jsx("span",{children:"Total:"}),i.jsx("span",{children:T.quantity_in})]})]})]}),i.jsxs("td",{className:Ht.textRed,children:[" ",i.jsxs("div",{className:Ht.reasonDistribution,children:[Object.entries(T.quantity_out_by_reason||{}).map(([I,D])=>i.jsxs("div",{children:[i.jsxs("span",{children:[I,":"]}),i.jsx("span",{children:D})]},I)),Object.keys(T.quantity_out_by_reason||{}).length>0&&i.jsxs("div",{className:Ht.totalRow,children:[i.jsx("span",{children:"Total:"}),i.jsx("span",{children:T.quantity_out})]}),(!T.quantity_out_by_reason||Object.keys(T.quantity_out_by_reason).length===0)&&i.jsx("div",{className:Ht.textRight,children:T.quantity_out})]})]}),i.jsx("td",{className:`${Ht.textRed} ${Ht.textRight}`,children:T.loose_quantity_out}),i.jsx("td",{className:`${Ht.textOrange} ${Ht.textRight}`,children:T.quantity_converted})]},T.drug_id))})]})}):i.jsx("p",{className:"text-gray-500",children:"No pharmacy inventory changes found for the selected period."})]})]})]}),b==="labInventory"&&i.jsxs("div",{className:"mt-4",children:[" ",i.jsx(Dw,{})]}),b==="pharmacyInventory"&&i.jsxs("div",{className:"mt-4",children:[" ",i.jsx(Fk,{})]})]})};var mv,dN;function QO(){if(dN)return mv;dN=1;var e="Expected a function",n=NaN,t="[object Symbol]",r=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,f=parseInt,d=typeof Vc=="object"&&Vc&&Vc.Object===Object&&Vc,u=typeof self=="object"&&self&&self.Object===Object&&self,h=d||u||Function("return this")(),g=Object.prototype,b=g.toString,v=Math.max,S=Math.min,k=function(){return h.Date.now()};function E(R,F,U){var z,V,L,$,H,ee,te=0,ae=!1,Z=!1,B=!0;if(typeof R!="function")throw new TypeError(e);F=q(F)||0,T(U)&&(ae=!!U.leading,Z="maxWait"in U,L=Z?v(q(U.maxWait)||0,F):L,B="trailing"in U?!!U.trailing:B);function K(Pe){var de=z,Me=V;return z=V=void 0,te=Pe,$=R.apply(Me,de),$}function oe(Pe){return te=Pe,H=setTimeout(ue,F),ae?K(Pe):$}function A(Pe){var de=Pe-ee,Me=Pe-te,Ze=F-de;return Z?S(Ze,L-Me):Ze}function se(Pe){var de=Pe-ee,Me=Pe-te;return ee===void 0||de>=F||de<0||Z&&Me>=L}function ue(){var Pe=k();if(se(Pe))return M(Pe);H=setTimeout(ue,A(Pe))}function M(Pe){return H=void 0,B&&z?K(Pe):(z=V=void 0,$)}function pe(){H!==void 0&&clearTimeout(H),te=0,z=ee=V=H=void 0}function be(){return H===void 0?$:M(k())}function fe(){var Pe=k(),de=se(Pe);if(z=arguments,V=this,ee=Pe,de){if(H===void 0)return oe(ee);if(Z)return H=setTimeout(ue,F),K(ee)}return H===void 0&&(H=setTimeout(ue,F)),$}return fe.cancel=pe,fe.flush=be,fe}function T(R){var F=typeof R;return!!R&&(F=="object"||F=="function")}function I(R){return!!R&&typeof R=="object"}function D(R){return typeof R=="symbol"||I(R)&&b.call(R)==t}function q(R){if(typeof R=="number")return R;if(D(R))return n;if(T(R)){var F=typeof R.valueOf=="function"?R.valueOf():R;R=T(F)?F+"":F}if(typeof R!="string")return R===0?R:+R;R=R.replace(r,"");var U=s.test(R);return U||l.test(R)?f(R.slice(2),U?2:8):a.test(R)?n:+R}return mv=E,mv}var JO=QO();const qb=Bd(JO),Iw=async()=>{const e=await ge("/api/clinic-subscriptions/plans",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription plans")}return e.json()},KO=async e=>{const n=await ge(`/api/clinic-subscriptions/cancel/${e}`,{method:"PUT"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to cancel clinic subscription")}return n.json()},XO=async e=>{const n=await ge(`/api/clinics/${e}/subscription-status`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||`Failed to fetch subscription status for clinic ${e}`)}return n.json()},ZO=async e=>{const n=await ge(`/api/clinic-subscriptions/plans/${e}`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to fetch clinic subscription plan")}return n.json()},eL=async e=>{const n=await ge("/api/clinic-subscriptions/plans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to create clinic subscription plan")}return n.json()},tL=async(e,n)=>{const t=await ge(`/api/clinic-subscriptions/plans/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Failed to update clinic subscription plan")}return t.json()},nL=async e=>{const n=await ge(`/api/clinic-subscriptions/plans/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to deactivate clinic subscription plan")}return n.json()},rL=async e=>{const n=await ge("/api/clinic-subscriptions/initiate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:e})});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to initiate clinic subscription")}return n.json()},iL=async()=>{try{const e=await ge("/api/clinic-subscriptions/pending",{method:"GET"});return e.ok?e.json():null}catch(e){return console.error("Error checking for pending subscription:",e),null}},$k=async()=>{const e=await ge("/api/clinics/subscription-status",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription status")}return e.json()};var gv={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var fN;function aL(){return fN||(fN=1,function(e){(function(){var n={}.hasOwnProperty;function t(){for(var s="",l=0;l<arguments.length;l++){var f=arguments[l];f&&(s=a(s,r(f)))}return s}function r(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return t.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var l="";for(var f in s)n.call(s,f)&&s[f]&&(l=a(l,f));return l}function a(s,l){return l?s?s+" "+l:s+l:s}e.exports?(t.default=t,e.exports=t):window.classNames=t})()}(gv)),gv.exports}var sL=aL();const Hc=Bd(sL);function Ld(e){"@babel/helpers - typeof";return Ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Ld(e)}function oL(e,n){if(Ld(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(Ld(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function zk(e){var n=oL(e,"string");return Ld(n)=="symbol"?n:n+""}function Wm(e,n,t){return(n=zk(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function hN(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function Et(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?hN(Object(t),!0).forEach(function(r){Wm(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):hN(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function lL(e){if(Array.isArray(e))return e}function cL(e,n){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var r,a,s,l,f=[],d=!0,u=!1;try{if(s=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;d=!1}else for(;!(d=(r=s.call(t)).done)&&(f.push(r.value),f.length!==n);d=!0);}catch(h){u=!0,a=h}finally{try{if(!d&&t.return!=null&&(l=t.return(),Object(l)!==l))return}finally{if(u)throw a}}return f}}function v1(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function Bk(e,n){if(e){if(typeof e=="string")return v1(e,n);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?v1(e,n):void 0}}function uL(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rl(e,n){return lL(e)||cL(e,n)||Bk(e,n)||uL()}function dL(e,n){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(n.indexOf(r)!==-1)continue;t[r]=e[r]}return t}function $l(e,n){if(e==null)return{};var t,r,a=dL(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var fL=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function hL(e){var n=e.defaultInputValue,t=n===void 0?"":n,r=e.defaultMenuIsOpen,a=r===void 0?!1:r,s=e.defaultValue,l=s===void 0?null:s,f=e.inputValue,d=e.menuIsOpen,u=e.onChange,h=e.onInputChange,g=e.onMenuClose,b=e.onMenuOpen,v=e.value,S=$l(e,fL),k=w.useState(f!==void 0?f:t),E=Rl(k,2),T=E[0],I=E[1],D=w.useState(d!==void 0?d:a),q=Rl(D,2),R=q[0],F=q[1],U=w.useState(v!==void 0?v:l),z=Rl(U,2),V=z[0],L=z[1],$=w.useCallback(function(K,oe){typeof u=="function"&&u(K,oe),L(K)},[u]),H=w.useCallback(function(K,oe){var A;typeof h=="function"&&(A=h(K,oe)),I(A!==void 0?A:K)},[h]),ee=w.useCallback(function(){typeof b=="function"&&b(),F(!0)},[b]),te=w.useCallback(function(){typeof g=="function"&&g(),F(!1)},[g]),ae=f!==void 0?f:T,Z=d!==void 0?d:R,B=v!==void 0?v:V;return Et(Et({},S),{},{inputValue:ae,menuIsOpen:Z,onChange:$,onInputChange:H,onMenuClose:te,onMenuOpen:ee,value:B})}function It(){return It=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},It.apply(null,arguments)}function pL(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function pN(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,zk(r.key),r)}}function mL(e,n,t){return n&&pN(e.prototype,n),t&&pN(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function w1(e,n){return w1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},w1(e,n)}function gL(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&w1(e,n)}function gb(e){return gb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},gb(e)}function Uk(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Uk=function(){return!!e})()}function yL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xL(e,n){if(n&&(Ld(n)=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yL(e)}function bL(e){var n=Uk();return function(){var t,r=gb(e);if(n){var a=gb(this).constructor;t=Reflect.construct(r,arguments,a)}else t=r.apply(this,arguments);return xL(this,t)}}function vL(e){if(Array.isArray(e))return v1(e)}function wL(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function SL(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mw(e){return vL(e)||wL(e)||Bk(e)||SL()}function NL(e){if(e.sheet)return e.sheet;for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].ownerNode===e)return document.styleSheets[n]}function CL(e){var n=document.createElement("style");return n.setAttribute("data-emotion",e.key),e.nonce!==void 0&&n.setAttribute("nonce",e.nonce),n.appendChild(document.createTextNode("")),n.setAttribute("data-s",""),n}var jL=function(){function e(t){var r=this;this._insertTag=function(a){var s;r.tags.length===0?r.insertionPoint?s=r.insertionPoint.nextSibling:r.prepend?s=r.container.firstChild:s=r.before:s=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(a,s),r.tags.push(a)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var n=e.prototype;return n.hydrate=function(r){r.forEach(this._insertTag)},n.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(CL(this));var a=this.tags[this.tags.length-1];if(this.isSpeedy){var s=NL(a);try{s.insertRule(r,s.cssRules.length)}catch{}}else a.appendChild(document.createTextNode(r));this.ctr++},n.flush=function(){this.tags.forEach(function(r){var a;return(a=r.parentNode)==null?void 0:a.removeChild(r)}),this.tags=[],this.ctr=0},e}(),Si="-ms-",yb="-moz-",Sn="-webkit-",qk="comm",Rw="rule",Ow="decl",_L="@import",Vk="@keyframes",kL="@layer",EL=Math.abs,Vb=String.fromCharCode,TL=Object.assign;function AL(e,n){return ei(e,0)^45?(((n<<2^ei(e,0))<<2^ei(e,1))<<2^ei(e,2))<<2^ei(e,3):0}function Hk(e){return e.trim()}function PL(e,n){return(e=n.exec(e))?e[0]:e}function Nn(e,n,t){return e.replace(n,t)}function S1(e,n){return e.indexOf(n)}function ei(e,n){return e.charCodeAt(n)|0}function og(e,n,t){return e.slice(n,t)}function Ro(e){return e.length}function Lw(e){return e.length}function jx(e,n){return n.push(e),e}function DL(e,n){return e.map(n).join("")}var Hb=1,Lh=1,Gk=0,la=0,Ar=0,Hh="";function Gb(e,n,t,r,a,s,l){return{value:e,root:n,parent:t,type:r,props:a,children:s,line:Hb,column:Lh,length:l,return:""}}function Lm(e,n){return TL(Gb("",null,null,"",null,null,0),e,{length:-e.length},n)}function IL(){return Ar}function ML(){return Ar=la>0?ei(Hh,--la):0,Lh--,Ar===10&&(Lh=1,Hb--),Ar}function Oa(){return Ar=la<Gk?ei(Hh,la++):0,Lh++,Ar===10&&(Lh=1,Hb++),Ar}function Bo(){return ei(Hh,la)}function Wx(){return la}function xg(e,n){return og(Hh,e,n)}function lg(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Yk(e){return Hb=Lh=1,Gk=Ro(Hh=e),la=0,[]}function Wk(e){return Hh="",e}function Qx(e){return Hk(xg(la-1,N1(e===91?e+2:e===40?e+1:e)))}function RL(e){for(;(Ar=Bo())&&Ar<33;)Oa();return lg(e)>2||lg(Ar)>3?"":" "}function OL(e,n){for(;--n&&Oa()&&!(Ar<48||Ar>102||Ar>57&&Ar<65||Ar>70&&Ar<97););return xg(e,Wx()+(n<6&&Bo()==32&&Oa()==32))}function N1(e){for(;Oa();)switch(Ar){case e:return la;case 34:case 39:e!==34&&e!==39&&N1(Ar);break;case 40:e===41&&N1(e);break;case 92:Oa();break}return la}function LL(e,n){for(;Oa()&&e+Ar!==57;)if(e+Ar===84&&Bo()===47)break;return"/*"+xg(n,la-1)+"*"+Vb(e===47?e:Oa())}function FL(e){for(;!lg(Bo());)Oa();return xg(e,la)}function $L(e){return Wk(Jx("",null,null,null,[""],e=Yk(e),0,[0],e))}function Jx(e,n,t,r,a,s,l,f,d){for(var u=0,h=0,g=l,b=0,v=0,S=0,k=1,E=1,T=1,I=0,D="",q=a,R=s,F=r,U=D;E;)switch(S=I,I=Oa()){case 40:if(S!=108&&ei(U,g-1)==58){S1(U+=Nn(Qx(I),"&","&\f"),"&\f")!=-1&&(T=-1);break}case 34:case 39:case 91:U+=Qx(I);break;case 9:case 10:case 13:case 32:U+=RL(S);break;case 92:U+=OL(Wx()-1,7);continue;case 47:switch(Bo()){case 42:case 47:jx(zL(LL(Oa(),Wx()),n,t),d);break;default:U+="/"}break;case 123*k:f[u++]=Ro(U)*T;case 125*k:case 59:case 0:switch(I){case 0:case 125:E=0;case 59+h:T==-1&&(U=Nn(U,/\f/g,"")),v>0&&Ro(U)-g&&jx(v>32?gN(U+";",r,t,g-1):gN(Nn(U," ","")+";",r,t,g-2),d);break;case 59:U+=";";default:if(jx(F=mN(U,n,t,u,h,a,f,D,q=[],R=[],g),s),I===123)if(h===0)Jx(U,n,F,F,q,s,g,f,R);else switch(b===99&&ei(U,3)===110?100:b){case 100:case 108:case 109:case 115:Jx(e,F,F,r&&jx(mN(e,F,F,0,0,a,f,D,a,q=[],g),R),a,R,g,f,r?q:R);break;default:Jx(U,F,F,F,[""],R,0,f,R)}}u=h=v=0,k=T=1,D=U="",g=l;break;case 58:g=1+Ro(U),v=S;default:if(k<1){if(I==123)--k;else if(I==125&&k++==0&&ML()==125)continue}switch(U+=Vb(I),I*k){case 38:T=h>0?1:(U+="\f",-1);break;case 44:f[u++]=(Ro(U)-1)*T,T=1;break;case 64:Bo()===45&&(U+=Qx(Oa())),b=Bo(),h=g=Ro(D=U+=FL(Wx())),I++;break;case 45:S===45&&Ro(U)==2&&(k=0)}}return s}function mN(e,n,t,r,a,s,l,f,d,u,h){for(var g=a-1,b=a===0?s:[""],v=Lw(b),S=0,k=0,E=0;S<r;++S)for(var T=0,I=og(e,g+1,g=EL(k=l[S])),D=e;T<v;++T)(D=Hk(k>0?b[T]+" "+I:Nn(I,/&\f/g,b[T])))&&(d[E++]=D);return Gb(e,n,t,a===0?Rw:f,d,u,h)}function zL(e,n,t){return Gb(e,n,t,qk,Vb(IL()),og(e,2,-2),0)}function gN(e,n,t,r){return Gb(e,n,t,Ow,og(e,0,r),og(e,r+1,-1),r)}function Ph(e,n){for(var t="",r=Lw(e),a=0;a<r;a++)t+=n(e[a],a,e,n)||"";return t}function BL(e,n,t,r){switch(e.type){case kL:if(e.children.length)break;case _L:case Ow:return e.return=e.return||e.value;case qk:return"";case Vk:return e.return=e.value+"{"+Ph(e.children,r)+"}";case Rw:e.value=e.props.join(",")}return Ro(t=Ph(e.children,r))?e.return=e.value+"{"+t+"}":""}function UL(e){var n=Lw(e);return function(t,r,a,s){for(var l="",f=0;f<n;f++)l+=e[f](t,r,a,s)||"";return l}}function qL(e){return function(n){n.root||(n=n.return)&&e(n)}}function VL(e){var n=Object.create(null);return function(t){return n[t]===void 0&&(n[t]=e(t)),n[t]}}var HL=function(n,t,r){for(var a=0,s=0;a=s,s=Bo(),a===38&&s===12&&(t[r]=1),!lg(s);)Oa();return xg(n,la)},GL=function(n,t){var r=-1,a=44;do switch(lg(a)){case 0:a===38&&Bo()===12&&(t[r]=1),n[r]+=HL(la-1,t,r);break;case 2:n[r]+=Qx(a);break;case 4:if(a===44){n[++r]=Bo()===58?"&\f":"",t[r]=n[r].length;break}default:n[r]+=Vb(a)}while(a=Oa());return n},YL=function(n,t){return Wk(GL(Yk(n),t))},yN=new WeakMap,WL=function(n){if(!(n.type!=="rule"||!n.parent||n.length<1)){for(var t=n.value,r=n.parent,a=n.column===r.column&&n.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(n.props.length===1&&t.charCodeAt(0)!==58&&!yN.get(r))&&!a){yN.set(n,!0);for(var s=[],l=YL(t,s),f=r.props,d=0,u=0;d<l.length;d++)for(var h=0;h<f.length;h++,u++)n.props[u]=s[d]?l[d].replace(/&\f/g,f[h]):f[h]+" "+l[d]}}},QL=function(n){if(n.type==="decl"){var t=n.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(n.return="",n.value="")}};function Qk(e,n){switch(AL(e,n)){case 5103:return Sn+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Sn+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Sn+e+yb+e+Si+e+e;case 6828:case 4268:return Sn+e+Si+e+e;case 6165:return Sn+e+Si+"flex-"+e+e;case 5187:return Sn+e+Nn(e,/(\w+).+(:[^]+)/,Sn+"box-$1$2"+Si+"flex-$1$2")+e;case 5443:return Sn+e+Si+"flex-item-"+Nn(e,/flex-|-self/,"")+e;case 4675:return Sn+e+Si+"flex-line-pack"+Nn(e,/align-content|flex-|-self/,"")+e;case 5548:return Sn+e+Si+Nn(e,"shrink","negative")+e;case 5292:return Sn+e+Si+Nn(e,"basis","preferred-size")+e;case 6060:return Sn+"box-"+Nn(e,"-grow","")+Sn+e+Si+Nn(e,"grow","positive")+e;case 4554:return Sn+Nn(e,/([^-])(transform)/g,"$1"+Sn+"$2")+e;case 6187:return Nn(Nn(Nn(e,/(zoom-|grab)/,Sn+"$1"),/(image-set)/,Sn+"$1"),e,"")+e;case 5495:case 3959:return Nn(e,/(image-set\([^]*)/,Sn+"$1$`$1");case 4968:return Nn(Nn(e,/(.+:)(flex-)?(.*)/,Sn+"box-pack:$3"+Si+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Sn+e+e;case 4095:case 3583:case 4068:case 2532:return Nn(e,/(.+)-inline(.+)/,Sn+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Ro(e)-1-n>6)switch(ei(e,n+1)){case 109:if(ei(e,n+4)!==45)break;case 102:return Nn(e,/(.+:)(.+)-([^]+)/,"$1"+Sn+"$2-$3$1"+yb+(ei(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~S1(e,"stretch")?Qk(Nn(e,"stretch","fill-available"),n)+e:e}break;case 4949:if(ei(e,n+1)!==115)break;case 6444:switch(ei(e,Ro(e)-3-(~S1(e,"!important")&&10))){case 107:return Nn(e,":",":"+Sn)+e;case 101:return Nn(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Sn+(ei(e,14)===45?"inline-":"")+"box$3$1"+Sn+"$2$3$1"+Si+"$2box$3")+e}break;case 5936:switch(ei(e,n+11)){case 114:return Sn+e+Si+Nn(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Sn+e+Si+Nn(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Sn+e+Si+Nn(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Sn+e+Si+e+e}return e}var JL=function(n,t,r,a){if(n.length>-1&&!n.return)switch(n.type){case Ow:n.return=Qk(n.value,n.length);break;case Vk:return Ph([Lm(n,{value:Nn(n.value,"@","@"+Sn)})],a);case Rw:if(n.length)return DL(n.props,function(s){switch(PL(s,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Ph([Lm(n,{props:[Nn(s,/:(read-\w+)/,":"+yb+"$1")]})],a);case"::placeholder":return Ph([Lm(n,{props:[Nn(s,/:(plac\w+)/,":"+Sn+"input-$1")]}),Lm(n,{props:[Nn(s,/:(plac\w+)/,":"+yb+"$1")]}),Lm(n,{props:[Nn(s,/:(plac\w+)/,Si+"input-$1")]})],a)}return""})}},KL=[JL],XL=function(n){var t=n.key;if(t==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(k){var E=k.getAttribute("data-emotion");E.indexOf(" ")!==-1&&(document.head.appendChild(k),k.setAttribute("data-s",""))})}var a=n.stylisPlugins||KL,s={},l,f=[];l=n.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(k){for(var E=k.getAttribute("data-emotion").split(" "),T=1;T<E.length;T++)s[E[T]]=!0;f.push(k)});var d,u=[WL,QL];{var h,g=[BL,qL(function(k){h.insert(k)})],b=UL(u.concat(a,g)),v=function(E){return Ph($L(E),b)};d=function(E,T,I,D){h=I,v(E?E+"{"+T.styles+"}":T.styles),D&&(S.inserted[T.name]=!0)}}var S={key:t,sheet:new jL({key:t,container:l,nonce:n.nonce,speedy:n.speedy,prepend:n.prepend,insertionPoint:n.insertionPoint}),nonce:n.nonce,inserted:s,registered:{},insert:d};return S.sheet.hydrate(f),S},yv={exports:{}},En={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xN;function ZL(){if(xN)return En;xN=1;var e=typeof Symbol=="function"&&Symbol.for,n=e?Symbol.for("react.element"):60103,t=e?Symbol.for("react.portal"):60106,r=e?Symbol.for("react.fragment"):60107,a=e?Symbol.for("react.strict_mode"):60108,s=e?Symbol.for("react.profiler"):60114,l=e?Symbol.for("react.provider"):60109,f=e?Symbol.for("react.context"):60110,d=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,h=e?Symbol.for("react.forward_ref"):60112,g=e?Symbol.for("react.suspense"):60113,b=e?Symbol.for("react.suspense_list"):60120,v=e?Symbol.for("react.memo"):60115,S=e?Symbol.for("react.lazy"):60116,k=e?Symbol.for("react.block"):60121,E=e?Symbol.for("react.fundamental"):60117,T=e?Symbol.for("react.responder"):60118,I=e?Symbol.for("react.scope"):60119;function D(R){if(typeof R=="object"&&R!==null){var F=R.$$typeof;switch(F){case n:switch(R=R.type,R){case d:case u:case r:case s:case a:case g:return R;default:switch(R=R&&R.$$typeof,R){case f:case h:case S:case v:case l:return R;default:return F}}case t:return F}}}function q(R){return D(R)===u}return En.AsyncMode=d,En.ConcurrentMode=u,En.ContextConsumer=f,En.ContextProvider=l,En.Element=n,En.ForwardRef=h,En.Fragment=r,En.Lazy=S,En.Memo=v,En.Portal=t,En.Profiler=s,En.StrictMode=a,En.Suspense=g,En.isAsyncMode=function(R){return q(R)||D(R)===d},En.isConcurrentMode=q,En.isContextConsumer=function(R){return D(R)===f},En.isContextProvider=function(R){return D(R)===l},En.isElement=function(R){return typeof R=="object"&&R!==null&&R.$$typeof===n},En.isForwardRef=function(R){return D(R)===h},En.isFragment=function(R){return D(R)===r},En.isLazy=function(R){return D(R)===S},En.isMemo=function(R){return D(R)===v},En.isPortal=function(R){return D(R)===t},En.isProfiler=function(R){return D(R)===s},En.isStrictMode=function(R){return D(R)===a},En.isSuspense=function(R){return D(R)===g},En.isValidElementType=function(R){return typeof R=="string"||typeof R=="function"||R===r||R===u||R===s||R===a||R===g||R===b||typeof R=="object"&&R!==null&&(R.$$typeof===S||R.$$typeof===v||R.$$typeof===l||R.$$typeof===f||R.$$typeof===h||R.$$typeof===E||R.$$typeof===T||R.$$typeof===I||R.$$typeof===k)},En.typeOf=D,En}var bN;function e3(){return bN||(bN=1,yv.exports=ZL()),yv.exports}var xv,vN;function t3(){if(vN)return xv;vN=1;var e=e3(),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},t={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};s[e.ForwardRef]=r,s[e.Memo]=a;function l(S){return e.isMemo(S)?a:s[S.$$typeof]||n}var f=Object.defineProperty,d=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,g=Object.getPrototypeOf,b=Object.prototype;function v(S,k,E){if(typeof k!="string"){if(b){var T=g(k);T&&T!==b&&v(S,T,E)}var I=d(k);u&&(I=I.concat(u(k)));for(var D=l(S),q=l(k),R=0;R<I.length;++R){var F=I[R];if(!t[F]&&!(E&&E[F])&&!(q&&q[F])&&!(D&&D[F])){var U=h(k,F);try{f(S,F,U)}catch{}}}}return S}return xv=v,xv}t3();var n3=!0;function r3(e,n,t){var r="";return t.split(" ").forEach(function(a){e[a]!==void 0?n.push(e[a]+";"):a&&(r+=a+" ")}),r}var Jk=function(n,t,r){var a=n.key+"-"+t.name;(r===!1||n3===!1)&&n.registered[a]===void 0&&(n.registered[a]=t.styles)},i3=function(n,t,r){Jk(n,t,r);var a=n.key+"-"+t.name;if(n.inserted[t.name]===void 0){var s=t;do n.insert(t===s?"."+a:"",s,n.sheet,!0),s=s.next;while(s!==void 0)}};function a3(e){for(var n=0,t,r=0,a=e.length;a>=4;++r,a-=4)t=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,n=(t&65535)*1540483477+((t>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(a){case 3:n^=(e.charCodeAt(r+2)&255)<<16;case 2:n^=(e.charCodeAt(r+1)&255)<<8;case 1:n^=e.charCodeAt(r)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}var s3={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},o3=/[A-Z]|^ms/g,l3=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Kk=function(n){return n.charCodeAt(1)===45},wN=function(n){return n!=null&&typeof n!="boolean"},bv=VL(function(e){return Kk(e)?e:e.replace(o3,"-$&").toLowerCase()}),SN=function(n,t){switch(n){case"animation":case"animationName":if(typeof t=="string")return t.replace(l3,function(r,a,s){return Oo={name:a,styles:s,next:Oo},a})}return s3[n]!==1&&!Kk(n)&&typeof t=="number"&&t!==0?t+"px":t};function cg(e,n,t){if(t==null)return"";var r=t;if(r.__emotion_styles!==void 0)return r;switch(typeof t){case"boolean":return"";case"object":{var a=t;if(a.anim===1)return Oo={name:a.name,styles:a.styles,next:Oo},a.name;var s=t;if(s.styles!==void 0){var l=s.next;if(l!==void 0)for(;l!==void 0;)Oo={name:l.name,styles:l.styles,next:Oo},l=l.next;var f=s.styles+";";return f}return c3(e,n,t)}case"function":{if(e!==void 0){var d=Oo,u=t(e);return Oo=d,cg(e,n,u)}break}}var h=t;return h}function c3(e,n,t){var r="";if(Array.isArray(t))for(var a=0;a<t.length;a++)r+=cg(e,n,t[a])+";";else for(var s in t){var l=t[s];if(typeof l!="object"){var f=l;wN(f)&&(r+=bv(s)+":"+SN(s,f)+";")}else if(Array.isArray(l)&&typeof l[0]=="string"&&n==null)for(var d=0;d<l.length;d++)wN(l[d])&&(r+=bv(s)+":"+SN(s,l[d])+";");else{var u=cg(e,n,l);switch(s){case"animation":case"animationName":{r+=bv(s)+":"+u+";";break}default:r+=s+"{"+u+"}"}}}return r}var NN=/label:\s*([^\s;{]+)\s*(;|$)/g,Oo;function Xk(e,n,t){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var r=!0,a="";Oo=void 0;var s=e[0];if(s==null||s.raw===void 0)r=!1,a+=cg(t,n,s);else{var l=s;a+=l[0]}for(var f=1;f<e.length;f++)if(a+=cg(t,n,e[f]),r){var d=s;a+=d[f]}NN.lastIndex=0;for(var u="",h;(h=NN.exec(a))!==null;)u+="-"+h[1];var g=a3(a)+u;return{name:g,styles:a,next:Oo}}var u3=function(n){return n()},d3=RS.useInsertionEffect?RS.useInsertionEffect:!1,f3=d3||u3,Zk=w.createContext(typeof HTMLElement<"u"?XL({key:"css"}):null);Zk.Provider;var h3=function(n){return w.forwardRef(function(t,r){var a=w.useContext(Zk);return n(t,a,r)})},p3=w.createContext({}),Fw={}.hasOwnProperty,C1="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",m3=function(n,t){var r={};for(var a in t)Fw.call(t,a)&&(r[a]=t[a]);return r[C1]=n,r},g3=function(n){var t=n.cache,r=n.serialized,a=n.isStringTag;return Jk(t,r,a),f3(function(){return i3(t,r,a)}),null},y3=h3(function(e,n,t){var r=e.css;typeof r=="string"&&n.registered[r]!==void 0&&(r=n.registered[r]);var a=e[C1],s=[r],l="";typeof e.className=="string"?l=r3(n.registered,s,e.className):e.className!=null&&(l=e.className+" ");var f=Xk(s,void 0,w.useContext(p3));l+=n.key+"-"+f.name;var d={};for(var u in e)Fw.call(e,u)&&u!=="css"&&u!==C1&&(d[u]=e[u]);return d.className=l,t&&(d.ref=t),w.createElement(w.Fragment,null,w.createElement(g3,{cache:n,serialized:f,isStringTag:typeof a=="string"}),w.createElement(a,d))}),x3=y3,St=function(n,t){var r=arguments;if(t==null||!Fw.call(t,"css"))return w.createElement.apply(void 0,r);var a=r.length,s=new Array(a);s[0]=x3,s[1]=m3(n,t);for(var l=2;l<a;l++)s[l]=r[l];return w.createElement.apply(null,s)};(function(e){var n;n||(n=e.JSX||(e.JSX={}))})(St||(St={}));function $w(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return Xk(n)}function b3(){var e=$w.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function v3(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}const w3=Math.min,S3=Math.max,xb=Math.round,_x=Math.floor,bb=e=>({x:e,y:e});function N3(e){const{x:n,y:t,width:r,height:a}=e;return{width:r,height:a,top:t,left:n,right:n+r,bottom:t+a,x:n,y:t}}function Yb(){return typeof window<"u"}function e2(e){return n2(e)?(e.nodeName||"").toLowerCase():"#document"}function Ll(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function t2(e){var n;return(n=(n2(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function n2(e){return Yb()?e instanceof Node||e instanceof Ll(e).Node:!1}function C3(e){return Yb()?e instanceof Element||e instanceof Ll(e).Element:!1}function zw(e){return Yb()?e instanceof HTMLElement||e instanceof Ll(e).HTMLElement:!1}function CN(e){return!Yb()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Ll(e).ShadowRoot}const j3=new Set(["inline","contents"]);function r2(e){const{overflow:n,overflowX:t,overflowY:r,display:a}=Bw(e);return/auto|scroll|overlay|hidden|clip/.test(n+r+t)&&!j3.has(a)}function _3(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const k3=new Set(["html","body","#document"]);function E3(e){return k3.has(e2(e))}function Bw(e){return Ll(e).getComputedStyle(e)}function T3(e){if(e2(e)==="html")return e;const n=e.assignedSlot||e.parentNode||CN(e)&&e.host||t2(e);return CN(n)?n.host:n}function i2(e){const n=T3(e);return E3(n)?e.ownerDocument?e.ownerDocument.body:e.body:zw(n)&&r2(n)?n:i2(n)}function vb(e,n,t){var r;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=i2(e),s=a===((r=e.ownerDocument)==null?void 0:r.body),l=Ll(a);if(s){const f=j1(l);return n.concat(l,l.visualViewport||[],r2(a)?a:[],f&&t?vb(f):[])}return n.concat(a,vb(a,[],t))}function j1(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function A3(e){const n=Bw(e);let t=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const a=zw(e),s=a?e.offsetWidth:t,l=a?e.offsetHeight:r,f=xb(t)!==s||xb(r)!==l;return f&&(t=s,r=l),{width:t,height:r,$:f}}function Uw(e){return C3(e)?e:e.contextElement}function jN(e){const n=Uw(e);if(!zw(n))return bb(1);const t=n.getBoundingClientRect(),{width:r,height:a,$:s}=A3(n);let l=(s?xb(t.width):t.width)/r,f=(s?xb(t.height):t.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!f||!Number.isFinite(f))&&(f=1),{x:l,y:f}}const P3=bb(0);function D3(e){const n=Ll(e);return!_3()||!n.visualViewport?P3:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function I3(e,n,t){return!1}function _N(e,n,t,r){n===void 0&&(n=!1);const a=e.getBoundingClientRect(),s=Uw(e);let l=bb(1);n&&(l=jN(e));const f=I3()?D3(s):bb(0);let d=(a.left+f.x)/l.x,u=(a.top+f.y)/l.y,h=a.width/l.x,g=a.height/l.y;if(s){const b=Ll(s),v=r;let S=b,k=j1(S);for(;k&&r&&v!==S;){const E=jN(k),T=k.getBoundingClientRect(),I=Bw(k),D=T.left+(k.clientLeft+parseFloat(I.paddingLeft))*E.x,q=T.top+(k.clientTop+parseFloat(I.paddingTop))*E.y;d*=E.x,u*=E.y,h*=E.x,g*=E.y,d+=D,u+=q,S=Ll(k),k=j1(S)}}return N3({width:h,height:g,x:d,y:u})}function a2(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function M3(e,n){let t=null,r;const a=t2(e);function s(){var f;clearTimeout(r),(f=t)==null||f.disconnect(),t=null}function l(f,d){f===void 0&&(f=!1),d===void 0&&(d=1),s();const u=e.getBoundingClientRect(),{left:h,top:g,width:b,height:v}=u;if(f||n(),!b||!v)return;const S=_x(g),k=_x(a.clientWidth-(h+b)),E=_x(a.clientHeight-(g+v)),T=_x(h),D={rootMargin:-S+"px "+-k+"px "+-E+"px "+-T+"px",threshold:S3(0,w3(1,d))||1};let q=!0;function R(F){const U=F[0].intersectionRatio;if(U!==d){if(!q)return l();U?l(!1,U):r=setTimeout(()=>{l(!1,1e-7)},1e3)}U===1&&!a2(u,e.getBoundingClientRect())&&l(),q=!1}try{t=new IntersectionObserver(R,{...D,root:a.ownerDocument})}catch{t=new IntersectionObserver(R,D)}t.observe(e)}return l(!0),s}function R3(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:s=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:f=typeof IntersectionObserver=="function",animationFrame:d=!1}=r,u=Uw(e),h=a||s?[...u?vb(u):[],...vb(n)]:[];h.forEach(T=>{a&&T.addEventListener("scroll",t,{passive:!0}),s&&T.addEventListener("resize",t)});const g=u&&f?M3(u,t):null;let b=-1,v=null;l&&(v=new ResizeObserver(T=>{let[I]=T;I&&I.target===u&&v&&(v.unobserve(n),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var D;(D=v)==null||D.observe(n)})),t()}),u&&!d&&v.observe(u),v.observe(n));let S,k=d?_N(e):null;d&&E();function E(){const T=_N(e);k&&!a2(k,T)&&t(),k=T,S=requestAnimationFrame(E)}return t(),()=>{var T;h.forEach(I=>{a&&I.removeEventListener("scroll",t),s&&I.removeEventListener("resize",t)}),g==null||g(),(T=v)==null||T.disconnect(),v=null,d&&cancelAnimationFrame(S)}}var _1=w.useLayoutEffect,O3=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],wb=function(){};function L3(e,n){return n?n[0]==="-"?e+n:e+"__"+n:e}function F3(e,n){for(var t=arguments.length,r=new Array(t>2?t-2:0),a=2;a<t;a++)r[a-2]=arguments[a];var s=[].concat(r);if(n&&e)for(var l in n)n.hasOwnProperty(l)&&n[l]&&s.push("".concat(L3(e,l)));return s.filter(function(f){return f}).map(function(f){return String(f).trim()}).join(" ")}var kN=function(n){return Y3(n)?n.filter(Boolean):Ld(n)==="object"&&n!==null?[n]:[]},s2=function(n){n.className,n.clearValue,n.cx,n.getStyles,n.getClassNames,n.getValue,n.hasValue,n.isMulti,n.isRtl,n.options,n.selectOption,n.selectProps,n.setValue,n.theme;var t=$l(n,O3);return Et({},t)},hr=function(n,t,r){var a=n.cx,s=n.getStyles,l=n.getClassNames,f=n.className;return{css:s(t,n),className:a(r??{},l(t,n),f)}};function Wb(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function $3(e){return Wb(e)?window.innerHeight:e.clientHeight}function o2(e){return Wb(e)?window.pageYOffset:e.scrollTop}function Sb(e,n){if(Wb(e)){window.scrollTo(0,n);return}e.scrollTop=n}function z3(e){var n=getComputedStyle(e),t=n.position==="absolute",r=/(auto|scroll)/;if(n.position==="fixed")return document.documentElement;for(var a=e;a=a.parentElement;)if(n=getComputedStyle(a),!(t&&n.position==="static")&&r.test(n.overflow+n.overflowY+n.overflowX))return a;return document.documentElement}function B3(e,n,t,r){return t*((e=e/r-1)*e*e+1)+n}function kx(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:wb,a=o2(e),s=n-a,l=10,f=0;function d(){f+=l;var u=B3(f,a,s,t);Sb(e,u),f<t?window.requestAnimationFrame(d):r(e)}d()}function EN(e,n){var t=e.getBoundingClientRect(),r=n.getBoundingClientRect(),a=n.offsetHeight/3;r.bottom+a>t.bottom?Sb(e,Math.min(n.offsetTop+n.clientHeight-e.offsetHeight+a,e.scrollHeight)):r.top-a<t.top&&Sb(e,Math.max(n.offsetTop-a,0))}function U3(e){var n=e.getBoundingClientRect();return{bottom:n.bottom,height:n.height,left:n.left,right:n.right,top:n.top,width:n.width}}function TN(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function q3(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var l2=!1,V3={get passive(){return l2=!0}},Ex=typeof window<"u"?window:{};Ex.addEventListener&&Ex.removeEventListener&&(Ex.addEventListener("p",wb,V3),Ex.removeEventListener("p",wb,!1));var H3=l2;function G3(e){return e!=null}function Y3(e){return Array.isArray(e)}function Tx(e,n,t){return e?n:t}var W3=function(n){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];var s=Object.entries(n).filter(function(l){var f=Rl(l,1),d=f[0];return!r.includes(d)});return s.reduce(function(l,f){var d=Rl(f,2),u=d[0],h=d[1];return l[u]=h,l},{})},Q3=["children","innerProps"],J3=["children","innerProps"];function K3(e){var n=e.maxHeight,t=e.menuEl,r=e.minHeight,a=e.placement,s=e.shouldScroll,l=e.isFixedPosition,f=e.controlHeight,d=z3(t),u={placement:"bottom",maxHeight:n};if(!t||!t.offsetParent)return u;var h=d.getBoundingClientRect(),g=h.height,b=t.getBoundingClientRect(),v=b.bottom,S=b.height,k=b.top,E=t.offsetParent.getBoundingClientRect(),T=E.top,I=l?window.innerHeight:$3(d),D=o2(d),q=parseInt(getComputedStyle(t).marginBottom,10),R=parseInt(getComputedStyle(t).marginTop,10),F=T-R,U=I-k,z=F+D,V=g-D-k,L=v-I+D+q,$=D+k-R,H=160;switch(a){case"auto":case"bottom":if(U>=S)return{placement:"bottom",maxHeight:n};if(V>=S&&!l)return s&&kx(d,L,H),{placement:"bottom",maxHeight:n};if(!l&&V>=r||l&&U>=r){s&&kx(d,L,H);var ee=l?U-q:V-q;return{placement:"bottom",maxHeight:ee}}if(a==="auto"||l){var te=n,ae=l?F:z;return ae>=r&&(te=Math.min(ae-q-f,n)),{placement:"top",maxHeight:te}}if(a==="bottom")return s&&Sb(d,L),{placement:"bottom",maxHeight:n};break;case"top":if(F>=S)return{placement:"top",maxHeight:n};if(z>=S&&!l)return s&&kx(d,$,H),{placement:"top",maxHeight:n};if(!l&&z>=r||l&&F>=r){var Z=n;return(!l&&z>=r||l&&F>=r)&&(Z=l?F-R:z-R),s&&kx(d,$,H),{placement:"top",maxHeight:Z}}return{placement:"bottom",maxHeight:n};default:throw new Error('Invalid placement provided "'.concat(a,'".'))}return u}function X3(e){var n={bottom:"top",top:"bottom"};return e?n[e]:"bottom"}var c2=function(n){return n==="auto"?"bottom":n},Z3=function(n,t){var r,a=n.placement,s=n.theme,l=s.borderRadius,f=s.spacing,d=s.colors;return Et((r={label:"menu"},Wm(r,X3(a),"100%"),Wm(r,"position","absolute"),Wm(r,"width","100%"),Wm(r,"zIndex",1),r),t?{}:{backgroundColor:d.neutral0,borderRadius:l,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:f.menuGutter,marginTop:f.menuGutter})},u2=w.createContext(null),eF=function(n){var t=n.children,r=n.minMenuHeight,a=n.maxMenuHeight,s=n.menuPlacement,l=n.menuPosition,f=n.menuShouldScrollIntoView,d=n.theme,u=w.useContext(u2)||{},h=u.setPortalPlacement,g=w.useRef(null),b=w.useState(a),v=Rl(b,2),S=v[0],k=v[1],E=w.useState(null),T=Rl(E,2),I=T[0],D=T[1],q=d.spacing.controlHeight;return _1(function(){var R=g.current;if(R){var F=l==="fixed",U=f&&!F,z=K3({maxHeight:a,menuEl:R,minHeight:r,placement:s,shouldScroll:U,isFixedPosition:F,controlHeight:q});k(z.maxHeight),D(z.placement),h==null||h(z.placement)}},[a,s,l,f,r,h,q]),t({ref:g,placerProps:Et(Et({},n),{},{placement:I||c2(s),maxHeight:S})})},tF=function(n){var t=n.children,r=n.innerRef,a=n.innerProps;return St("div",It({},hr(n,"menu",{menu:!0}),{ref:r},a),t)},nF=tF,rF=function(n,t){var r=n.maxHeight,a=n.theme.spacing.baseUnit;return Et({maxHeight:r,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},t?{}:{paddingBottom:a,paddingTop:a})},iF=function(n){var t=n.children,r=n.innerProps,a=n.innerRef,s=n.isMulti;return St("div",It({},hr(n,"menuList",{"menu-list":!0,"menu-list--is-multi":s}),{ref:a},r),t)},d2=function(n,t){var r=n.theme,a=r.spacing.baseUnit,s=r.colors;return Et({textAlign:"center"},t?{}:{color:s.neutral40,padding:"".concat(a*2,"px ").concat(a*3,"px")})},aF=d2,sF=d2,oF=function(n){var t=n.children,r=t===void 0?"No options":t,a=n.innerProps,s=$l(n,Q3);return St("div",It({},hr(Et(Et({},s),{},{children:r,innerProps:a}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),a),r)},lF=function(n){var t=n.children,r=t===void 0?"Loading...":t,a=n.innerProps,s=$l(n,J3);return St("div",It({},hr(Et(Et({},s),{},{children:r,innerProps:a}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),a),r)},cF=function(n){var t=n.rect,r=n.offset,a=n.position;return{left:t.left,position:a,top:r,width:t.width,zIndex:1}},uF=function(n){var t=n.appendTo,r=n.children,a=n.controlElement,s=n.innerProps,l=n.menuPlacement,f=n.menuPosition,d=w.useRef(null),u=w.useRef(null),h=w.useState(c2(l)),g=Rl(h,2),b=g[0],v=g[1],S=w.useMemo(function(){return{setPortalPlacement:v}},[]),k=w.useState(null),E=Rl(k,2),T=E[0],I=E[1],D=w.useCallback(function(){if(a){var U=U3(a),z=f==="fixed"?0:window.pageYOffset,V=U[b]+z;(V!==(T==null?void 0:T.offset)||U.left!==(T==null?void 0:T.rect.left)||U.width!==(T==null?void 0:T.rect.width))&&I({offset:V,rect:U})}},[a,f,b,T==null?void 0:T.offset,T==null?void 0:T.rect.left,T==null?void 0:T.rect.width]);_1(function(){D()},[D]);var q=w.useCallback(function(){typeof u.current=="function"&&(u.current(),u.current=null),a&&d.current&&(u.current=R3(a,d.current,D,{elementResize:"ResizeObserver"in window}))},[a,D]);_1(function(){q()},[q]);var R=w.useCallback(function(U){d.current=U,q()},[q]);if(!t&&f!=="fixed"||!T)return null;var F=St("div",It({ref:R},hr(Et(Et({},n),{},{offset:T.offset,position:f,rect:T.rect}),"menuPortal",{"menu-portal":!0}),s),r);return St(u2.Provider,{value:S},t?oI.createPortal(F,t):F)},dF=function(n){var t=n.isDisabled,r=n.isRtl;return{label:"container",direction:r?"rtl":void 0,pointerEvents:t?"none":void 0,position:"relative"}},fF=function(n){var t=n.children,r=n.innerProps,a=n.isDisabled,s=n.isRtl;return St("div",It({},hr(n,"container",{"--is-disabled":a,"--is-rtl":s}),r),t)},hF=function(n,t){var r=n.theme.spacing,a=n.isMulti,s=n.hasValue,l=n.selectProps.controlShouldRenderValue;return Et({alignItems:"center",display:a&&s&&l?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},t?{}:{padding:"".concat(r.baseUnit/2,"px ").concat(r.baseUnit*2,"px")})},pF=function(n){var t=n.children,r=n.innerProps,a=n.isMulti,s=n.hasValue;return St("div",It({},hr(n,"valueContainer",{"value-container":!0,"value-container--is-multi":a,"value-container--has-value":s}),r),t)},mF=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},gF=function(n){var t=n.children,r=n.innerProps;return St("div",It({},hr(n,"indicatorsContainer",{indicators:!0}),r),t)},AN,yF=["size"],xF=["innerProps","isRtl","size"],bF={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},f2=function(n){var t=n.size,r=$l(n,yF);return St("svg",It({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:bF},r))},qw=function(n){return St(f2,It({size:20},n),St("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},h2=function(n){return St(f2,It({size:20},n),St("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},p2=function(n,t){var r=n.isFocused,a=n.theme,s=a.spacing.baseUnit,l=a.colors;return Et({label:"indicatorContainer",display:"flex",transition:"color 150ms"},t?{}:{color:r?l.neutral60:l.neutral20,padding:s*2,":hover":{color:r?l.neutral80:l.neutral40}})},vF=p2,wF=function(n){var t=n.children,r=n.innerProps;return St("div",It({},hr(n,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),r),t||St(h2,null))},SF=p2,NF=function(n){var t=n.children,r=n.innerProps;return St("div",It({},hr(n,"clearIndicator",{indicator:!0,"clear-indicator":!0}),r),t||St(qw,null))},CF=function(n,t){var r=n.isDisabled,a=n.theme,s=a.spacing.baseUnit,l=a.colors;return Et({label:"indicatorSeparator",alignSelf:"stretch",width:1},t?{}:{backgroundColor:r?l.neutral10:l.neutral20,marginBottom:s*2,marginTop:s*2})},jF=function(n){var t=n.innerProps;return St("span",It({},t,hr(n,"indicatorSeparator",{"indicator-separator":!0})))},_F=b3(AN||(AN=v3([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),kF=function(n,t){var r=n.isFocused,a=n.size,s=n.theme,l=s.colors,f=s.spacing.baseUnit;return Et({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:a,lineHeight:1,marginRight:a,textAlign:"center",verticalAlign:"middle"},t?{}:{color:r?l.neutral60:l.neutral20,padding:f*2})},vv=function(n){var t=n.delay,r=n.offset;return St("span",{css:$w({animation:"".concat(_F," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:r?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},EF=function(n){var t=n.innerProps,r=n.isRtl,a=n.size,s=a===void 0?4:a,l=$l(n,xF);return St("div",It({},hr(Et(Et({},l),{},{innerProps:t,isRtl:r,size:s}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),t),St(vv,{delay:0,offset:r}),St(vv,{delay:160,offset:!0}),St(vv,{delay:320,offset:!r}))},TF=function(n,t){var r=n.isDisabled,a=n.isFocused,s=n.theme,l=s.colors,f=s.borderRadius,d=s.spacing;return Et({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:d.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},t?{}:{backgroundColor:r?l.neutral5:l.neutral0,borderColor:r?l.neutral10:a?l.primary:l.neutral20,borderRadius:f,borderStyle:"solid",borderWidth:1,boxShadow:a?"0 0 0 1px ".concat(l.primary):void 0,"&:hover":{borderColor:a?l.primary:l.neutral30}})},AF=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,s=n.innerRef,l=n.innerProps,f=n.menuIsOpen;return St("div",It({ref:s},hr(n,"control",{control:!0,"control--is-disabled":r,"control--is-focused":a,"control--menu-is-open":f}),l,{"aria-disabled":r||void 0}),t)},PF=AF,DF=["data"],IF=function(n,t){var r=n.theme.spacing;return t?{}:{paddingBottom:r.baseUnit*2,paddingTop:r.baseUnit*2}},MF=function(n){var t=n.children,r=n.cx,a=n.getStyles,s=n.getClassNames,l=n.Heading,f=n.headingProps,d=n.innerProps,u=n.label,h=n.theme,g=n.selectProps;return St("div",It({},hr(n,"group",{group:!0}),d),St(l,It({},f,{selectProps:g,theme:h,getStyles:a,getClassNames:s,cx:r}),u),St("div",null,t))},RF=function(n,t){var r=n.theme,a=r.colors,s=r.spacing;return Et({label:"group",cursor:"default",display:"block"},t?{}:{color:a.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:s.baseUnit*3,paddingRight:s.baseUnit*3,textTransform:"uppercase"})},OF=function(n){var t=s2(n);t.data;var r=$l(t,DF);return St("div",It({},hr(n,"groupHeading",{"group-heading":!0}),r))},LF=MF,FF=["innerRef","isDisabled","isHidden","inputClassName"],$F=function(n,t){var r=n.isDisabled,a=n.value,s=n.theme,l=s.spacing,f=s.colors;return Et(Et({visibility:r?"hidden":"visible",transform:a?"translateZ(0)":""},zF),t?{}:{margin:l.baseUnit/2,paddingBottom:l.baseUnit/2,paddingTop:l.baseUnit/2,color:f.neutral80})},m2={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},zF={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Et({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},m2)},BF=function(n){return Et({label:"input",color:"inherit",background:0,opacity:n?0:1,width:"100%"},m2)},UF=function(n){var t=n.cx,r=n.value,a=s2(n),s=a.innerRef,l=a.isDisabled,f=a.isHidden,d=a.inputClassName,u=$l(a,FF);return St("div",It({},hr(n,"input",{"input-container":!0}),{"data-value":r||""}),St("input",It({className:t({input:!0},d),ref:s,style:BF(f),disabled:l},u)))},qF=UF,VF=function(n,t){var r=n.theme,a=r.spacing,s=r.borderRadius,l=r.colors;return Et({label:"multiValue",display:"flex",minWidth:0},t?{}:{backgroundColor:l.neutral10,borderRadius:s/2,margin:a.baseUnit/2})},HF=function(n,t){var r=n.theme,a=r.borderRadius,s=r.colors,l=n.cropWithEllipsis;return Et({overflow:"hidden",textOverflow:l||l===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},t?{}:{borderRadius:a/2,color:s.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},GF=function(n,t){var r=n.theme,a=r.spacing,s=r.borderRadius,l=r.colors,f=n.isFocused;return Et({alignItems:"center",display:"flex"},t?{}:{borderRadius:s/2,backgroundColor:f?l.dangerLight:void 0,paddingLeft:a.baseUnit,paddingRight:a.baseUnit,":hover":{backgroundColor:l.dangerLight,color:l.danger}})},g2=function(n){var t=n.children,r=n.innerProps;return St("div",r,t)},YF=g2,WF=g2;function QF(e){var n=e.children,t=e.innerProps;return St("div",It({role:"button"},t),n||St(qw,{size:14}))}var JF=function(n){var t=n.children,r=n.components,a=n.data,s=n.innerProps,l=n.isDisabled,f=n.removeProps,d=n.selectProps,u=r.Container,h=r.Label,g=r.Remove;return St(u,{data:a,innerProps:Et(Et({},hr(n,"multiValue",{"multi-value":!0,"multi-value--is-disabled":l})),s),selectProps:d},St(h,{data:a,innerProps:Et({},hr(n,"multiValueLabel",{"multi-value__label":!0})),selectProps:d},t),St(g,{data:a,innerProps:Et(Et({},hr(n,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(t||"option")},f),selectProps:d}))},KF=JF,XF=function(n,t){var r=n.isDisabled,a=n.isFocused,s=n.isSelected,l=n.theme,f=l.spacing,d=l.colors;return Et({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},t?{}:{backgroundColor:s?d.primary:a?d.primary25:"transparent",color:r?d.neutral20:s?d.neutral0:"inherit",padding:"".concat(f.baseUnit*2,"px ").concat(f.baseUnit*3,"px"),":active":{backgroundColor:r?void 0:s?d.primary:d.primary50}})},ZF=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,s=n.isSelected,l=n.innerRef,f=n.innerProps;return St("div",It({},hr(n,"option",{option:!0,"option--is-disabled":r,"option--is-focused":a,"option--is-selected":s}),{ref:l,"aria-disabled":r},f),t)},e6=ZF,t6=function(n,t){var r=n.theme,a=r.spacing,s=r.colors;return Et({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},t?{}:{color:s.neutral50,marginLeft:a.baseUnit/2,marginRight:a.baseUnit/2})},n6=function(n){var t=n.children,r=n.innerProps;return St("div",It({},hr(n,"placeholder",{placeholder:!0}),r),t)},r6=n6,i6=function(n,t){var r=n.isDisabled,a=n.theme,s=a.spacing,l=a.colors;return Et({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t?{}:{color:r?l.neutral40:l.neutral80,marginLeft:s.baseUnit/2,marginRight:s.baseUnit/2})},a6=function(n){var t=n.children,r=n.isDisabled,a=n.innerProps;return St("div",It({},hr(n,"singleValue",{"single-value":!0,"single-value--is-disabled":r}),a),t)},s6=a6,o6={ClearIndicator:NF,Control:PF,DropdownIndicator:wF,DownChevron:h2,CrossIcon:qw,Group:LF,GroupHeading:OF,IndicatorsContainer:gF,IndicatorSeparator:jF,Input:qF,LoadingIndicator:EF,Menu:nF,MenuList:iF,MenuPortal:uF,LoadingMessage:lF,NoOptionsMessage:oF,MultiValue:KF,MultiValueContainer:YF,MultiValueLabel:WF,MultiValueRemove:QF,Option:e6,Placeholder:r6,SelectContainer:fF,SingleValue:s6,ValueContainer:pF},l6=function(n){return Et(Et({},o6),n.components)},PN=Number.isNaN||function(n){return typeof n=="number"&&n!==n};function c6(e,n){return!!(e===n||PN(e)&&PN(n))}function u6(e,n){if(e.length!==n.length)return!1;for(var t=0;t<e.length;t++)if(!c6(e[t],n[t]))return!1;return!0}function d6(e,n){n===void 0&&(n=u6);var t=null;function r(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];if(t&&t.lastThis===this&&n(a,t.lastArgs))return t.lastResult;var l=e.apply(this,a);return t={lastResult:l,lastArgs:a,lastThis:this},l}return r.clear=function(){t=null},r}var f6={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},h6=function(n){return St("span",It({css:f6},n))},DN=h6,p6={guidance:function(n){var t=n.isSearchable,r=n.isMulti,a=n.tabSelectsValue,s=n.context,l=n.isInitialFocus;switch(s){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(a?", press Tab to select the option and exit the menu":"",".");case"input":return l?"".concat(n["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(r?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(n){var t=n.action,r=n.label,a=r===void 0?"":r,s=n.labels,l=n.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(a,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(s.length>1?"s":""," ").concat(s.join(","),", selected.");case"select-option":return l?"option ".concat(a," is disabled. Select another option."):"option ".concat(a,", selected.");default:return""}},onFocus:function(n){var t=n.context,r=n.focused,a=n.options,s=n.label,l=s===void 0?"":s,f=n.selectValue,d=n.isDisabled,u=n.isSelected,h=n.isAppleDevice,g=function(k,E){return k&&k.length?"".concat(k.indexOf(E)+1," of ").concat(k.length):""};if(t==="value"&&f)return"value ".concat(l," focused, ").concat(g(f,r),".");if(t==="menu"&&h){var b=d?" disabled":"",v="".concat(u?" selected":"").concat(b);return"".concat(l).concat(v,", ").concat(g(a,r),".")}return""},onFilter:function(n){var t=n.inputValue,r=n.resultsMessage;return"".concat(r).concat(t?" for search term "+t:"",".")}},m6=function(n){var t=n.ariaSelection,r=n.focusedOption,a=n.focusedValue,s=n.focusableOptions,l=n.isFocused,f=n.selectValue,d=n.selectProps,u=n.id,h=n.isAppleDevice,g=d.ariaLiveMessages,b=d.getOptionLabel,v=d.inputValue,S=d.isMulti,k=d.isOptionDisabled,E=d.isSearchable,T=d.menuIsOpen,I=d.options,D=d.screenReaderStatus,q=d.tabSelectsValue,R=d.isLoading,F=d["aria-label"],U=d["aria-live"],z=w.useMemo(function(){return Et(Et({},p6),g||{})},[g]),V=w.useMemo(function(){var ae="";if(t&&z.onChange){var Z=t.option,B=t.options,K=t.removedValue,oe=t.removedValues,A=t.value,se=function(de){return Array.isArray(de)?null:de},ue=K||Z||se(A),M=ue?b(ue):"",pe=B||oe||void 0,be=pe?pe.map(b):[],fe=Et({isDisabled:ue&&k(ue,f),label:M,labels:be},t);ae=z.onChange(fe)}return ae},[t,z,k,f,b]),L=w.useMemo(function(){var ae="",Z=r||a,B=!!(r&&f&&f.includes(r));if(Z&&z.onFocus){var K={focused:Z,label:b(Z),isDisabled:k(Z,f),isSelected:B,options:s,context:Z===r?"menu":"value",selectValue:f,isAppleDevice:h};ae=z.onFocus(K)}return ae},[r,a,b,k,z,s,f,h]),$=w.useMemo(function(){var ae="";if(T&&I.length&&!R&&z.onFilter){var Z=D({count:s.length});ae=z.onFilter({inputValue:v,resultsMessage:Z})}return ae},[s,v,T,z,I,D,R]),H=(t==null?void 0:t.action)==="initial-input-focus",ee=w.useMemo(function(){var ae="";if(z.guidance){var Z=a?"value":T?"menu":"input";ae=z.guidance({"aria-label":F,context:Z,isDisabled:r&&k(r,f),isMulti:S,isSearchable:E,tabSelectsValue:q,isInitialFocus:H})}return ae},[F,r,a,S,k,E,T,z,f,q,H]),te=St(w.Fragment,null,St("span",{id:"aria-selection"},V),St("span",{id:"aria-focused"},L),St("span",{id:"aria-results"},$),St("span",{id:"aria-guidance"},ee));return St(w.Fragment,null,St(DN,{id:u},H&&te),St(DN,{"aria-live":U,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},l&&!H&&te))},g6=m6,k1=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],y6=new RegExp("["+k1.map(function(e){return e.letters}).join("")+"]","g"),y2={};for(var wv=0;wv<k1.length;wv++)for(var Sv=k1[wv],Nv=0;Nv<Sv.letters.length;Nv++)y2[Sv.letters[Nv]]=Sv.base;var x2=function(n){return n.replace(y6,function(t){return y2[t]})},x6=d6(x2),IN=function(n){return n.replace(/^\s+|\s+$/g,"")},b6=function(n){return"".concat(n.label," ").concat(n.value)},v6=function(n){return function(t,r){if(t.data.__isNew__)return!0;var a=Et({ignoreCase:!0,ignoreAccents:!0,stringify:b6,trim:!0,matchFrom:"any"},n),s=a.ignoreCase,l=a.ignoreAccents,f=a.stringify,d=a.trim,u=a.matchFrom,h=d?IN(r):r,g=d?IN(f(t)):f(t);return s&&(h=h.toLowerCase(),g=g.toLowerCase()),l&&(h=x6(h),g=x2(g)),u==="start"?g.substr(0,h.length)===h:g.indexOf(h)>-1}},w6=["innerRef"];function S6(e){var n=e.innerRef,t=$l(e,w6),r=W3(t,"onExited","in","enter","exit","appear");return St("input",It({ref:n},r,{css:$w({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var N6=function(n){n.cancelable&&n.preventDefault(),n.stopPropagation()};function C6(e){var n=e.isEnabled,t=e.onBottomArrive,r=e.onBottomLeave,a=e.onTopArrive,s=e.onTopLeave,l=w.useRef(!1),f=w.useRef(!1),d=w.useRef(0),u=w.useRef(null),h=w.useCallback(function(E,T){if(u.current!==null){var I=u.current,D=I.scrollTop,q=I.scrollHeight,R=I.clientHeight,F=u.current,U=T>0,z=q-R-D,V=!1;z>T&&l.current&&(r&&r(E),l.current=!1),U&&f.current&&(s&&s(E),f.current=!1),U&&T>z?(t&&!l.current&&t(E),F.scrollTop=q,V=!0,l.current=!0):!U&&-T>D&&(a&&!f.current&&a(E),F.scrollTop=0,V=!0,f.current=!0),V&&N6(E)}},[t,r,a,s]),g=w.useCallback(function(E){h(E,E.deltaY)},[h]),b=w.useCallback(function(E){d.current=E.changedTouches[0].clientY},[]),v=w.useCallback(function(E){var T=d.current-E.changedTouches[0].clientY;h(E,T)},[h]),S=w.useCallback(function(E){if(E){var T=H3?{passive:!1}:!1;E.addEventListener("wheel",g,T),E.addEventListener("touchstart",b,T),E.addEventListener("touchmove",v,T)}},[v,b,g]),k=w.useCallback(function(E){E&&(E.removeEventListener("wheel",g,!1),E.removeEventListener("touchstart",b,!1),E.removeEventListener("touchmove",v,!1))},[v,b,g]);return w.useEffect(function(){if(n){var E=u.current;return S(E),function(){k(E)}}},[n,S,k]),function(E){u.current=E}}var MN=["boxSizing","height","overflow","paddingRight","position"],RN={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function ON(e){e.cancelable&&e.preventDefault()}function LN(e){e.stopPropagation()}function FN(){var e=this.scrollTop,n=this.scrollHeight,t=e+this.offsetHeight;e===0?this.scrollTop=1:t===n&&(this.scrollTop=e-1)}function $N(){return"ontouchstart"in window||navigator.maxTouchPoints}var zN=!!(typeof window<"u"&&window.document&&window.document.createElement),Fm=0,bh={capture:!1,passive:!1};function j6(e){var n=e.isEnabled,t=e.accountForScrollbars,r=t===void 0?!0:t,a=w.useRef({}),s=w.useRef(null),l=w.useCallback(function(d){if(zN){var u=document.body,h=u&&u.style;if(r&&MN.forEach(function(S){var k=h&&h[S];a.current[S]=k}),r&&Fm<1){var g=parseInt(a.current.paddingRight,10)||0,b=document.body?document.body.clientWidth:0,v=window.innerWidth-b+g||0;Object.keys(RN).forEach(function(S){var k=RN[S];h&&(h[S]=k)}),h&&(h.paddingRight="".concat(v,"px"))}u&&$N()&&(u.addEventListener("touchmove",ON,bh),d&&(d.addEventListener("touchstart",FN,bh),d.addEventListener("touchmove",LN,bh))),Fm+=1}},[r]),f=w.useCallback(function(d){if(zN){var u=document.body,h=u&&u.style;Fm=Math.max(Fm-1,0),r&&Fm<1&&MN.forEach(function(g){var b=a.current[g];h&&(h[g]=b)}),u&&$N()&&(u.removeEventListener("touchmove",ON,bh),d&&(d.removeEventListener("touchstart",FN,bh),d.removeEventListener("touchmove",LN,bh)))}},[r]);return w.useEffect(function(){if(n){var d=s.current;return l(d),function(){f(d)}}},[n,l,f]),function(d){s.current=d}}var _6=function(n){var t=n.target;return t.ownerDocument.activeElement&&t.ownerDocument.activeElement.blur()},k6={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function E6(e){var n=e.children,t=e.lockEnabled,r=e.captureEnabled,a=r===void 0?!0:r,s=e.onBottomArrive,l=e.onBottomLeave,f=e.onTopArrive,d=e.onTopLeave,u=C6({isEnabled:a,onBottomArrive:s,onBottomLeave:l,onTopArrive:f,onTopLeave:d}),h=j6({isEnabled:t}),g=function(v){u(v),h(v)};return St(w.Fragment,null,t&&St("div",{onClick:_6,css:k6}),n(g))}var T6={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},A6=function(n){var t=n.name,r=n.onFocus;return St("input",{required:!0,name:t,tabIndex:-1,"aria-hidden":"true",onFocus:r,css:T6,value:"",onChange:function(){}})},P6=A6;function Vw(e){var n;return typeof window<"u"&&window.navigator!=null?e.test(((n=window.navigator.userAgentData)===null||n===void 0?void 0:n.platform)||window.navigator.platform):!1}function D6(){return Vw(/^iPhone/i)}function b2(){return Vw(/^Mac/i)}function I6(){return Vw(/^iPad/i)||b2()&&navigator.maxTouchPoints>1}function M6(){return D6()||I6()}function R6(){return b2()||M6()}var O6=function(n){return n.label},L6=function(n){return n.label},F6=function(n){return n.value},$6=function(n){return!!n.isDisabled},z6={clearIndicator:SF,container:dF,control:TF,dropdownIndicator:vF,group:IF,groupHeading:RF,indicatorsContainer:mF,indicatorSeparator:CF,input:$F,loadingIndicator:kF,loadingMessage:sF,menu:Z3,menuList:rF,menuPortal:cF,multiValue:VF,multiValueLabel:HF,multiValueRemove:GF,noOptionsMessage:aF,option:XF,placeholder:t6,singleValue:i6,valueContainer:hF},B6={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},U6=4,v2=4,q6=38,V6=v2*2,H6={baseUnit:v2,controlHeight:q6,menuGutter:V6},Cv={borderRadius:U6,colors:B6,spacing:H6},G6={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:TN(),captureMenuScroll:!TN(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:v6(),formatGroupLabel:O6,getOptionLabel:L6,getOptionValue:F6,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:$6,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!q3(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(n){var t=n.count;return"".concat(t," result").concat(t!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function BN(e,n,t,r){var a=N2(e,n,t),s=C2(e,n,t),l=S2(e,n),f=Nb(e,n);return{type:"option",data:n,isDisabled:a,isSelected:s,label:l,value:f,index:r}}function Kx(e,n){return e.options.map(function(t,r){if("options"in t){var a=t.options.map(function(l,f){return BN(e,l,n,f)}).filter(function(l){return qN(e,l)});return a.length>0?{type:"group",data:t,options:a,index:r}:void 0}var s=BN(e,t,n,r);return qN(e,s)?s:void 0}).filter(G3)}function w2(e){return e.reduce(function(n,t){return t.type==="group"?n.push.apply(n,Mw(t.options.map(function(r){return r.data}))):n.push(t.data),n},[])}function UN(e,n){return e.reduce(function(t,r){return r.type==="group"?t.push.apply(t,Mw(r.options.map(function(a){return{data:a.data,id:"".concat(n,"-").concat(r.index,"-").concat(a.index)}}))):t.push({data:r.data,id:"".concat(n,"-").concat(r.index)}),t},[])}function Y6(e,n){return w2(Kx(e,n))}function qN(e,n){var t=e.inputValue,r=t===void 0?"":t,a=n.data,s=n.isSelected,l=n.label,f=n.value;return(!_2(e)||!s)&&j2(e,{label:l,value:f,data:a},r)}function W6(e,n){var t=e.focusedValue,r=e.selectValue,a=r.indexOf(t);if(a>-1){var s=n.indexOf(t);if(s>-1)return t;if(a<n.length)return n[a]}return null}function Q6(e,n){var t=e.focusedOption;return t&&n.indexOf(t)>-1?t:n[0]}var jv=function(n,t){var r,a=(r=n.find(function(s){return s.data===t}))===null||r===void 0?void 0:r.id;return a||null},S2=function(n,t){return n.getOptionLabel(t)},Nb=function(n,t){return n.getOptionValue(t)};function N2(e,n,t){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(n,t):!1}function C2(e,n,t){if(t.indexOf(n)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(n,t);var r=Nb(e,n);return t.some(function(a){return Nb(e,a)===r})}function j2(e,n,t){return e.filterOption?e.filterOption(n,t):!0}var _2=function(n){var t=n.hideSelectedOptions,r=n.isMulti;return t===void 0?r:t},J6=1,k2=function(e){gL(t,e);var n=bL(t);function t(r){var a;if(pL(this,t),a=n.call(this,r),a.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},a.blockOptionHover=!1,a.isComposing=!1,a.commonProps=void 0,a.initialTouchX=0,a.initialTouchY=0,a.openAfterFocus=!1,a.scrollToFocusedOptionOnUpdate=!1,a.userIsDragging=void 0,a.controlRef=null,a.getControlRef=function(d){a.controlRef=d},a.focusedOptionRef=null,a.getFocusedOptionRef=function(d){a.focusedOptionRef=d},a.menuListRef=null,a.getMenuListRef=function(d){a.menuListRef=d},a.inputRef=null,a.getInputRef=function(d){a.inputRef=d},a.focus=a.focusInput,a.blur=a.blurInput,a.onChange=function(d,u){var h=a.props,g=h.onChange,b=h.name;u.name=b,a.ariaOnChange(d,u),g(d,u)},a.setValue=function(d,u,h){var g=a.props,b=g.closeMenuOnSelect,v=g.isMulti,S=g.inputValue;a.onInputChange("",{action:"set-value",prevInputValue:S}),b&&(a.setState({inputIsHiddenAfterUpdate:!v}),a.onMenuClose()),a.setState({clearFocusValueOnUpdate:!0}),a.onChange(d,{action:u,option:h})},a.selectOption=function(d){var u=a.props,h=u.blurInputOnSelect,g=u.isMulti,b=u.name,v=a.state.selectValue,S=g&&a.isOptionSelected(d,v),k=a.isOptionDisabled(d,v);if(S){var E=a.getOptionValue(d);a.setValue(v.filter(function(T){return a.getOptionValue(T)!==E}),"deselect-option",d)}else if(!k)g?a.setValue([].concat(Mw(v),[d]),"select-option",d):a.setValue(d,"select-option");else{a.ariaOnChange(d,{action:"select-option",option:d,name:b});return}h&&a.blurInput()},a.removeValue=function(d){var u=a.props.isMulti,h=a.state.selectValue,g=a.getOptionValue(d),b=h.filter(function(S){return a.getOptionValue(S)!==g}),v=Tx(u,b,b[0]||null);a.onChange(v,{action:"remove-value",removedValue:d}),a.focusInput()},a.clearValue=function(){var d=a.state.selectValue;a.onChange(Tx(a.props.isMulti,[],null),{action:"clear",removedValues:d})},a.popValue=function(){var d=a.props.isMulti,u=a.state.selectValue,h=u[u.length-1],g=u.slice(0,u.length-1),b=Tx(d,g,g[0]||null);h&&a.onChange(b,{action:"pop-value",removedValue:h})},a.getFocusedOptionId=function(d){return jv(a.state.focusableOptionsWithIds,d)},a.getFocusableOptionsWithIds=function(){return UN(Kx(a.props,a.state.selectValue),a.getElementId("option"))},a.getValue=function(){return a.state.selectValue},a.cx=function(){for(var d=arguments.length,u=new Array(d),h=0;h<d;h++)u[h]=arguments[h];return F3.apply(void 0,[a.props.classNamePrefix].concat(u))},a.getOptionLabel=function(d){return S2(a.props,d)},a.getOptionValue=function(d){return Nb(a.props,d)},a.getStyles=function(d,u){var h=a.props.unstyled,g=z6[d](u,h);g.boxSizing="border-box";var b=a.props.styles[d];return b?b(g,u):g},a.getClassNames=function(d,u){var h,g;return(h=(g=a.props.classNames)[d])===null||h===void 0?void 0:h.call(g,u)},a.getElementId=function(d){return"".concat(a.state.instancePrefix,"-").concat(d)},a.getComponents=function(){return l6(a.props)},a.buildCategorizedOptions=function(){return Kx(a.props,a.state.selectValue)},a.getCategorizedOptions=function(){return a.props.menuIsOpen?a.buildCategorizedOptions():[]},a.buildFocusableOptions=function(){return w2(a.buildCategorizedOptions())},a.getFocusableOptions=function(){return a.props.menuIsOpen?a.buildFocusableOptions():[]},a.ariaOnChange=function(d,u){a.setState({ariaSelection:Et({value:d},u)})},a.onMenuMouseDown=function(d){d.button===0&&(d.stopPropagation(),d.preventDefault(),a.focusInput())},a.onMenuMouseMove=function(d){a.blockOptionHover=!1},a.onControlMouseDown=function(d){if(!d.defaultPrevented){var u=a.props.openMenuOnClick;a.state.isFocused?a.props.menuIsOpen?d.target.tagName!=="INPUT"&&d.target.tagName!=="TEXTAREA"&&a.onMenuClose():u&&a.openMenu("first"):(u&&(a.openAfterFocus=!0),a.focusInput()),d.target.tagName!=="INPUT"&&d.target.tagName!=="TEXTAREA"&&d.preventDefault()}},a.onDropdownIndicatorMouseDown=function(d){if(!(d&&d.type==="mousedown"&&d.button!==0)&&!a.props.isDisabled){var u=a.props,h=u.isMulti,g=u.menuIsOpen;a.focusInput(),g?(a.setState({inputIsHiddenAfterUpdate:!h}),a.onMenuClose()):a.openMenu("first"),d.preventDefault()}},a.onClearIndicatorMouseDown=function(d){d&&d.type==="mousedown"&&d.button!==0||(a.clearValue(),d.preventDefault(),a.openAfterFocus=!1,d.type==="touchend"?a.focusInput():setTimeout(function(){return a.focusInput()}))},a.onScroll=function(d){typeof a.props.closeMenuOnScroll=="boolean"?d.target instanceof HTMLElement&&Wb(d.target)&&a.props.onMenuClose():typeof a.props.closeMenuOnScroll=="function"&&a.props.closeMenuOnScroll(d)&&a.props.onMenuClose()},a.onCompositionStart=function(){a.isComposing=!0},a.onCompositionEnd=function(){a.isComposing=!1},a.onTouchStart=function(d){var u=d.touches,h=u&&u.item(0);h&&(a.initialTouchX=h.clientX,a.initialTouchY=h.clientY,a.userIsDragging=!1)},a.onTouchMove=function(d){var u=d.touches,h=u&&u.item(0);if(h){var g=Math.abs(h.clientX-a.initialTouchX),b=Math.abs(h.clientY-a.initialTouchY),v=5;a.userIsDragging=g>v||b>v}},a.onTouchEnd=function(d){a.userIsDragging||(a.controlRef&&!a.controlRef.contains(d.target)&&a.menuListRef&&!a.menuListRef.contains(d.target)&&a.blurInput(),a.initialTouchX=0,a.initialTouchY=0)},a.onControlTouchEnd=function(d){a.userIsDragging||a.onControlMouseDown(d)},a.onClearIndicatorTouchEnd=function(d){a.userIsDragging||a.onClearIndicatorMouseDown(d)},a.onDropdownIndicatorTouchEnd=function(d){a.userIsDragging||a.onDropdownIndicatorMouseDown(d)},a.handleInputChange=function(d){var u=a.props.inputValue,h=d.currentTarget.value;a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange(h,{action:"input-change",prevInputValue:u}),a.props.menuIsOpen||a.onMenuOpen()},a.onInputFocus=function(d){a.props.onFocus&&a.props.onFocus(d),a.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(a.openAfterFocus||a.props.openMenuOnFocus)&&a.openMenu("first"),a.openAfterFocus=!1},a.onInputBlur=function(d){var u=a.props.inputValue;if(a.menuListRef&&a.menuListRef.contains(document.activeElement)){a.inputRef.focus();return}a.props.onBlur&&a.props.onBlur(d),a.onInputChange("",{action:"input-blur",prevInputValue:u}),a.onMenuClose(),a.setState({focusedValue:null,isFocused:!1})},a.onOptionHover=function(d){if(!(a.blockOptionHover||a.state.focusedOption===d)){var u=a.getFocusableOptions(),h=u.indexOf(d);a.setState({focusedOption:d,focusedOptionId:h>-1?a.getFocusedOptionId(d):null})}},a.shouldHideSelectedOptions=function(){return _2(a.props)},a.onValueInputFocus=function(d){d.preventDefault(),d.stopPropagation(),a.focus()},a.onKeyDown=function(d){var u=a.props,h=u.isMulti,g=u.backspaceRemovesValue,b=u.escapeClearsValue,v=u.inputValue,S=u.isClearable,k=u.isDisabled,E=u.menuIsOpen,T=u.onKeyDown,I=u.tabSelectsValue,D=u.openMenuOnFocus,q=a.state,R=q.focusedOption,F=q.focusedValue,U=q.selectValue;if(!k&&!(typeof T=="function"&&(T(d),d.defaultPrevented))){switch(a.blockOptionHover=!0,d.key){case"ArrowLeft":if(!h||v)return;a.focusValue("previous");break;case"ArrowRight":if(!h||v)return;a.focusValue("next");break;case"Delete":case"Backspace":if(v)return;if(F)a.removeValue(F);else{if(!g)return;h?a.popValue():S&&a.clearValue()}break;case"Tab":if(a.isComposing||d.shiftKey||!E||!I||!R||D&&a.isOptionSelected(R,U))return;a.selectOption(R);break;case"Enter":if(d.keyCode===229)break;if(E){if(!R||a.isComposing)return;a.selectOption(R);break}return;case"Escape":E?(a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange("",{action:"menu-close",prevInputValue:v}),a.onMenuClose()):S&&b&&a.clearValue();break;case" ":if(v)return;if(!E){a.openMenu("first");break}if(!R)return;a.selectOption(R);break;case"ArrowUp":E?a.focusOption("up"):a.openMenu("last");break;case"ArrowDown":E?a.focusOption("down"):a.openMenu("first");break;case"PageUp":if(!E)return;a.focusOption("pageup");break;case"PageDown":if(!E)return;a.focusOption("pagedown");break;case"Home":if(!E)return;a.focusOption("first");break;case"End":if(!E)return;a.focusOption("last");break;default:return}d.preventDefault()}},a.state.instancePrefix="react-select-"+(a.props.instanceId||++J6),a.state.selectValue=kN(r.value),r.menuIsOpen&&a.state.selectValue.length){var s=a.getFocusableOptionsWithIds(),l=a.buildFocusableOptions(),f=l.indexOf(a.state.selectValue[0]);a.state.focusableOptionsWithIds=s,a.state.focusedOption=l[f],a.state.focusedOptionId=jv(s,l[f])}return a}return mL(t,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&EN(this.menuListRef,this.focusedOptionRef),R6()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(a){var s=this.props,l=s.isDisabled,f=s.menuIsOpen,d=this.state.isFocused;(d&&!l&&a.isDisabled||d&&f&&!a.menuIsOpen)&&this.focusInput(),d&&l&&!a.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!d&&!l&&a.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(EN(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(a,s){this.props.onInputChange(a,s)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(a){var s=this,l=this.state,f=l.selectValue,d=l.isFocused,u=this.buildFocusableOptions(),h=a==="first"?0:u.length-1;if(!this.props.isMulti){var g=u.indexOf(f[0]);g>-1&&(h=g)}this.scrollToFocusedOptionOnUpdate=!(d&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:u[h],focusedOptionId:this.getFocusedOptionId(u[h])},function(){return s.onMenuOpen()})}},{key:"focusValue",value:function(a){var s=this.state,l=s.selectValue,f=s.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var d=l.indexOf(f);f||(d=-1);var u=l.length-1,h=-1;if(l.length){switch(a){case"previous":d===0?h=0:d===-1?h=u:h=d-1;break;case"next":d>-1&&d<u&&(h=d+1);break}this.setState({inputIsHidden:h!==-1,focusedValue:l[h]})}}}},{key:"focusOption",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",s=this.props.pageSize,l=this.state.focusedOption,f=this.getFocusableOptions();if(f.length){var d=0,u=f.indexOf(l);l||(u=-1),a==="up"?d=u>0?u-1:f.length-1:a==="down"?d=(u+1)%f.length:a==="pageup"?(d=u-s,d<0&&(d=0)):a==="pagedown"?(d=u+s,d>f.length-1&&(d=f.length-1)):a==="last"&&(d=f.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:f[d],focusedValue:null,focusedOptionId:this.getFocusedOptionId(f[d])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(Cv):Et(Et({},Cv),this.props.theme):Cv}},{key:"getCommonProps",value:function(){var a=this.clearValue,s=this.cx,l=this.getStyles,f=this.getClassNames,d=this.getValue,u=this.selectOption,h=this.setValue,g=this.props,b=g.isMulti,v=g.isRtl,S=g.options,k=this.hasValue();return{clearValue:a,cx:s,getStyles:l,getClassNames:f,getValue:d,hasValue:k,isMulti:b,isRtl:v,options:S,selectOption:u,selectProps:g,setValue:h,theme:this.getTheme()}}},{key:"hasValue",value:function(){var a=this.state.selectValue;return a.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var a=this.props,s=a.isClearable,l=a.isMulti;return s===void 0?l:s}},{key:"isOptionDisabled",value:function(a,s){return N2(this.props,a,s)}},{key:"isOptionSelected",value:function(a,s){return C2(this.props,a,s)}},{key:"filterOption",value:function(a,s){return j2(this.props,a,s)}},{key:"formatOptionLabel",value:function(a,s){if(typeof this.props.formatOptionLabel=="function"){var l=this.props.inputValue,f=this.state.selectValue;return this.props.formatOptionLabel(a,{context:s,inputValue:l,selectValue:f})}else return this.getOptionLabel(a)}},{key:"formatGroupLabel",value:function(a){return this.props.formatGroupLabel(a)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var a=this.props,s=a.isDisabled,l=a.isSearchable,f=a.inputId,d=a.inputValue,u=a.tabIndex,h=a.form,g=a.menuIsOpen,b=a.required,v=this.getComponents(),S=v.Input,k=this.state,E=k.inputIsHidden,T=k.ariaSelection,I=this.commonProps,D=f||this.getElementId("input"),q=Et(Et(Et({"aria-autocomplete":"list","aria-expanded":g,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":b,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},g&&{"aria-controls":this.getElementId("listbox")}),!l&&{"aria-readonly":!0}),this.hasValue()?(T==null?void 0:T.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return l?w.createElement(S,It({},I,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:D,innerRef:this.getInputRef,isDisabled:s,isHidden:E,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:u,form:h,type:"text",value:d},q)):w.createElement(S6,It({id:D,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:wb,onFocus:this.onInputFocus,disabled:s,tabIndex:u,inputMode:"none",form:h,value:""},q))}},{key:"renderPlaceholderOrValue",value:function(){var a=this,s=this.getComponents(),l=s.MultiValue,f=s.MultiValueContainer,d=s.MultiValueLabel,u=s.MultiValueRemove,h=s.SingleValue,g=s.Placeholder,b=this.commonProps,v=this.props,S=v.controlShouldRenderValue,k=v.isDisabled,E=v.isMulti,T=v.inputValue,I=v.placeholder,D=this.state,q=D.selectValue,R=D.focusedValue,F=D.isFocused;if(!this.hasValue()||!S)return T?null:w.createElement(g,It({},b,{key:"placeholder",isDisabled:k,isFocused:F,innerProps:{id:this.getElementId("placeholder")}}),I);if(E)return q.map(function(z,V){var L=z===R,$="".concat(a.getOptionLabel(z),"-").concat(a.getOptionValue(z));return w.createElement(l,It({},b,{components:{Container:f,Label:d,Remove:u},isFocused:L,isDisabled:k,key:$,index:V,removeProps:{onClick:function(){return a.removeValue(z)},onTouchEnd:function(){return a.removeValue(z)},onMouseDown:function(ee){ee.preventDefault()}},data:z}),a.formatOptionLabel(z,"value"))});if(T)return null;var U=q[0];return w.createElement(h,It({},b,{data:U,isDisabled:k}),this.formatOptionLabel(U,"value"))}},{key:"renderClearIndicator",value:function(){var a=this.getComponents(),s=a.ClearIndicator,l=this.commonProps,f=this.props,d=f.isDisabled,u=f.isLoading,h=this.state.isFocused;if(!this.isClearable()||!s||d||!this.hasValue()||u)return null;var g={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(s,It({},l,{innerProps:g,isFocused:h}))}},{key:"renderLoadingIndicator",value:function(){var a=this.getComponents(),s=a.LoadingIndicator,l=this.commonProps,f=this.props,d=f.isDisabled,u=f.isLoading,h=this.state.isFocused;if(!s||!u)return null;var g={"aria-hidden":"true"};return w.createElement(s,It({},l,{innerProps:g,isDisabled:d,isFocused:h}))}},{key:"renderIndicatorSeparator",value:function(){var a=this.getComponents(),s=a.DropdownIndicator,l=a.IndicatorSeparator;if(!s||!l)return null;var f=this.commonProps,d=this.props.isDisabled,u=this.state.isFocused;return w.createElement(l,It({},f,{isDisabled:d,isFocused:u}))}},{key:"renderDropdownIndicator",value:function(){var a=this.getComponents(),s=a.DropdownIndicator;if(!s)return null;var l=this.commonProps,f=this.props.isDisabled,d=this.state.isFocused,u={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(s,It({},l,{innerProps:u,isDisabled:f,isFocused:d}))}},{key:"renderMenu",value:function(){var a=this,s=this.getComponents(),l=s.Group,f=s.GroupHeading,d=s.Menu,u=s.MenuList,h=s.MenuPortal,g=s.LoadingMessage,b=s.NoOptionsMessage,v=s.Option,S=this.commonProps,k=this.state.focusedOption,E=this.props,T=E.captureMenuScroll,I=E.inputValue,D=E.isLoading,q=E.loadingMessage,R=E.minMenuHeight,F=E.maxMenuHeight,U=E.menuIsOpen,z=E.menuPlacement,V=E.menuPosition,L=E.menuPortalTarget,$=E.menuShouldBlockScroll,H=E.menuShouldScrollIntoView,ee=E.noOptionsMessage,te=E.onMenuScrollToTop,ae=E.onMenuScrollToBottom;if(!U)return null;var Z=function(M,pe){var be=M.type,fe=M.data,Pe=M.isDisabled,de=M.isSelected,Me=M.label,Ze=M.value,Fe=k===fe,Ce=Pe?void 0:function(){return a.onOptionHover(fe)},Re=Pe?void 0:function(){return a.selectOption(fe)},xe="".concat(a.getElementId("option"),"-").concat(pe),Ie={id:xe,onClick:Re,onMouseMove:Ce,onMouseOver:Ce,tabIndex:-1,role:"option","aria-selected":a.state.isAppleDevice?void 0:de};return w.createElement(v,It({},S,{innerProps:Ie,data:fe,isDisabled:Pe,isSelected:de,key:xe,label:Me,type:be,value:Ze,isFocused:Fe,innerRef:Fe?a.getFocusedOptionRef:void 0}),a.formatOptionLabel(M.data,"menu"))},B;if(this.hasOptions())B=this.getCategorizedOptions().map(function(ue){if(ue.type==="group"){var M=ue.data,pe=ue.options,be=ue.index,fe="".concat(a.getElementId("group"),"-").concat(be),Pe="".concat(fe,"-heading");return w.createElement(l,It({},S,{key:fe,data:M,options:pe,Heading:f,headingProps:{id:Pe,data:ue.data},label:a.formatGroupLabel(ue.data)}),ue.options.map(function(de){return Z(de,"".concat(be,"-").concat(de.index))}))}else if(ue.type==="option")return Z(ue,"".concat(ue.index))});else if(D){var K=q({inputValue:I});if(K===null)return null;B=w.createElement(g,S,K)}else{var oe=ee({inputValue:I});if(oe===null)return null;B=w.createElement(b,S,oe)}var A={minMenuHeight:R,maxMenuHeight:F,menuPlacement:z,menuPosition:V,menuShouldScrollIntoView:H},se=w.createElement(eF,It({},S,A),function(ue){var M=ue.ref,pe=ue.placerProps,be=pe.placement,fe=pe.maxHeight;return w.createElement(d,It({},S,A,{innerRef:M,innerProps:{onMouseDown:a.onMenuMouseDown,onMouseMove:a.onMenuMouseMove},isLoading:D,placement:be}),w.createElement(E6,{captureEnabled:T,onTopArrive:te,onBottomArrive:ae,lockEnabled:$},function(Pe){return w.createElement(u,It({},S,{innerRef:function(Me){a.getMenuListRef(Me),Pe(Me)},innerProps:{role:"listbox","aria-multiselectable":S.isMulti,id:a.getElementId("listbox")},isLoading:D,maxHeight:fe,focusedOption:k}),B)}))});return L||V==="fixed"?w.createElement(h,It({},S,{appendTo:L,controlElement:this.controlRef,menuPlacement:z,menuPosition:V}),se):se}},{key:"renderFormField",value:function(){var a=this,s=this.props,l=s.delimiter,f=s.isDisabled,d=s.isMulti,u=s.name,h=s.required,g=this.state.selectValue;if(h&&!this.hasValue()&&!f)return w.createElement(P6,{name:u,onFocus:this.onValueInputFocus});if(!(!u||f))if(d)if(l){var b=g.map(function(k){return a.getOptionValue(k)}).join(l);return w.createElement("input",{name:u,type:"hidden",value:b})}else{var v=g.length>0?g.map(function(k,E){return w.createElement("input",{key:"i-".concat(E),name:u,type:"hidden",value:a.getOptionValue(k)})}):w.createElement("input",{name:u,type:"hidden",value:""});return w.createElement("div",null,v)}else{var S=g[0]?this.getOptionValue(g[0]):"";return w.createElement("input",{name:u,type:"hidden",value:S})}}},{key:"renderLiveRegion",value:function(){var a=this.commonProps,s=this.state,l=s.ariaSelection,f=s.focusedOption,d=s.focusedValue,u=s.isFocused,h=s.selectValue,g=this.getFocusableOptions();return w.createElement(g6,It({},a,{id:this.getElementId("live-region"),ariaSelection:l,focusedOption:f,focusedValue:d,isFocused:u,selectValue:h,focusableOptions:g,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var a=this.getComponents(),s=a.Control,l=a.IndicatorsContainer,f=a.SelectContainer,d=a.ValueContainer,u=this.props,h=u.className,g=u.id,b=u.isDisabled,v=u.menuIsOpen,S=this.state.isFocused,k=this.commonProps=this.getCommonProps();return w.createElement(f,It({},k,{className:h,innerProps:{id:g,onKeyDown:this.onKeyDown},isDisabled:b,isFocused:S}),this.renderLiveRegion(),w.createElement(s,It({},k,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:b,isFocused:S,menuIsOpen:v}),w.createElement(d,It({},k,{isDisabled:b}),this.renderPlaceholderOrValue(),this.renderInput()),w.createElement(l,It({},k,{isDisabled:b}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(a,s){var l=s.prevProps,f=s.clearFocusValueOnUpdate,d=s.inputIsHiddenAfterUpdate,u=s.ariaSelection,h=s.isFocused,g=s.prevWasFocused,b=s.instancePrefix,v=a.options,S=a.value,k=a.menuIsOpen,E=a.inputValue,T=a.isMulti,I=kN(S),D={};if(l&&(S!==l.value||v!==l.options||k!==l.menuIsOpen||E!==l.inputValue)){var q=k?Y6(a,I):[],R=k?UN(Kx(a,I),"".concat(b,"-option")):[],F=f?W6(s,I):null,U=Q6(s,q),z=jv(R,U);D={selectValue:I,focusedOption:U,focusedOptionId:z,focusableOptionsWithIds:R,focusedValue:F,clearFocusValueOnUpdate:!1}}var V=d!=null&&a!==l?{inputIsHidden:d,inputIsHiddenAfterUpdate:void 0}:{},L=u,$=h&&g;return h&&!$&&(L={value:Tx(T,I,I[0]||null),options:I,action:"initial-input-focus"},$=!g),(u==null?void 0:u.action)==="initial-input-focus"&&(L=null),Et(Et(Et({},D),V),{},{prevProps:a,ariaSelection:L,prevWasFocused:$})}}]),t}(w.Component);k2.defaultProps=G6;var K6=w.forwardRef(function(e,n){var t=hL(e);return w.createElement(k2,It({ref:n},t))}),E2=K6;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let X6,Z6;function e5(){return{geminiUrl:X6,vertexUrl:Z6}}function t5(e,n,t){var r,a,s;if(!(!((r=e.httpOptions)===null||r===void 0)&&r.baseUrl)){const l=e5();return e.vertexai?(a=l.vertexUrl)!==null&&a!==void 0?a:n:(s=l.geminiUrl)!==null&&s!==void 0?s:t}return e.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class bg{}function Ot(e,n){const t=/\{([^}]+)\}/g;return e.replace(t,(r,a)=>{if(Object.prototype.hasOwnProperty.call(n,a)){const s=n[a];return s!=null?String(s):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function j(e,n,t){for(let s=0;s<n.length-1;s++){const l=n[s];if(l.endsWith("[]")){const f=l.slice(0,-2);if(!(f in e))if(Array.isArray(t))e[f]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(e[f])){const d=e[f];if(Array.isArray(t))for(let u=0;u<d.length;u++){const h=d[u];j(h,n.slice(s+1),t[u])}else for(const u of d)j(u,n.slice(s+1),t)}return}else if(l.endsWith("[0]")){const f=l.slice(0,-3);f in e||(e[f]=[{}]);const d=e[f];j(d[0],n.slice(s+1),t);return}(!e[l]||typeof e[l]!="object")&&(e[l]={}),e=e[l]}const r=n[n.length-1],a=e[r];if(a!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===a)return;if(typeof a=="object"&&typeof t=="object"&&a!==null&&t!==null)Object.assign(a,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else e[r]=t}function C(e,n){try{if(n.length===1&&n[0]==="_self")return e;for(let t=0;t<n.length;t++){if(typeof e!="object"||e===null)return;const r=n[t];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in e){const s=e[a];return Array.isArray(s)?s.map(l=>C(l,n.slice(t+1))):void 0}else return}else e=e[r]}return e}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function lr(e,n){if(!n||typeof n!="string")throw new Error("model is required and must be a string");if(e.isVertexAI()){if(n.startsWith("publishers/")||n.startsWith("projects/")||n.startsWith("models/"))return n;if(n.indexOf("/")>=0){const t=n.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${n}`}else return n.startsWith("models/")||n.startsWith("tunedModels/")?n:`models/${n}`}function T2(e,n){const t=lr(e,n);return t?t.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:t.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${t}`:t:""}function A2(e,n){return Array.isArray(n)?n.map(t=>Cb(e,t)):[Cb(e,n)]}function Cb(e,n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function n5(e,n){const t=Cb(e,n);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function r5(e,n){const t=Cb(e,n);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function VN(e,n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function P2(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(t=>VN(e,t)):[VN(e,n)]}function E1(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function HN(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function GN(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function ia(e,n){if(n==null)throw new Error("ContentUnion is required");return E1(n)?n:{role:"user",parts:P2(e,n)}}function D2(e,n){if(!n)return[];if(e.isVertexAI()&&Array.isArray(n))return n.flatMap(t=>{const r=ia(e,t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const t=ia(e,n);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(n)?n.map(t=>ia(e,t)):[ia(e,n)]}function Qc(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(HN(n)||GN(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ia(e,n)]}const t=[],r=[],a=E1(n[0]);for(const s of n){const l=E1(s);if(l!=a)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)t.push(s);else{if(HN(s)||GN(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(s)}}return a||t.push({role:"user",parts:P2(e,r)}),t}function I2(e,n){return n}function M2(e,n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Qb(e,n){return n}function Jb(e,n){if(!Array.isArray(n))throw new Error("tool is required and must be an array of Tools");return n}function i5(e,n,t,r=1){const a=!n.startsWith(`${t}/`)&&n.split("/").length===r;return e.isVertexAI()?n.startsWith("projects/")?n:n.startsWith("locations/")?`projects/${e.getProject()}/${n}`:n.startsWith(`${t}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:a?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}/${n}`:n:a?`${t}/${n}`:n}function Jc(e,n){if(typeof n!="string")throw new Error("name must be a string");return i5(e,n,"cachedContents")}function R2(e,n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Kc(e,n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function a5(e){return e!=null&&typeof e=="object"&&"name"in e}function s5(e){return e!=null&&typeof e=="object"&&"video"in e}function o5(e){return e!=null&&typeof e=="object"&&"uri"in e}function O2(e,n){var t;let r;if(a5(n)&&(r=n.name),!(o5(n)&&(r=n.uri,r===void 0))&&!(s5(n)&&(r=(t=n.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof n=="string"&&(r=n),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const s=r.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${r}`);r=s[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function L2(e,n){let t;return e.isVertexAI()?t=n?"publishers/google/models":"models":t=n?"models":"tunedModels",t}function F2(e,n){for(const t of["models","tunedModels","publisherModels"])if(l5(n,t))return n[t];return[]}function l5(e,n){return e!==null&&typeof e=="object"&&n in e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function c5(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&j(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function u5(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&j(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],c5(e,a));const s=C(n,["codeExecutionResult"]);s!=null&&j(t,["codeExecutionResult"],s);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const d=C(n,["functionCall"]);d!=null&&j(t,["functionCall"],d);const u=C(n,["functionResponse"]);u!=null&&j(t,["functionResponse"],u);const h=C(n,["text"]);return h!=null&&j(t,["text"],h),t}function YN(e,n){const t={},r=C(n,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>u5(e,l))),j(t,["parts"],s)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function d5(){return{}}function f5(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function h5(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],f5(e,r)),t}function p5(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&j(t,["googleSearch"],d5());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&j(t,["googleSearchRetrieval"],h5(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const s=C(n,["codeExecution"]);s!=null&&j(t,["codeExecution"],s);const l=C(n,["functionDeclarations"]);return l!=null&&j(t,["functionDeclarations"],l),t}function m5(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function g5(e,n){const t={},r=C(n,["functionCallingConfig"]);if(r!=null&&j(t,["functionCallingConfig"],m5(e,r)),C(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function y5(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const s=C(n,["expireTime"]);t!==void 0&&s!=null&&j(t,["expireTime"],s);const l=C(n,["displayName"]);t!==void 0&&l!=null&&j(t,["displayName"],l);const f=C(n,["contents"]);if(t!==void 0&&f!=null){let g=Qc(e,f);Array.isArray(g)&&(g=g.map(b=>YN(e,b))),j(t,["contents"],g)}const d=C(n,["systemInstruction"]);t!==void 0&&d!=null&&j(t,["systemInstruction"],YN(e,ia(e,d)));const u=C(n,["tools"]);if(t!==void 0&&u!=null){let g=u;Array.isArray(g)&&(g=g.map(b=>p5(e,b))),j(t,["tools"],g)}const h=C(n,["toolConfig"]);return t!==void 0&&h!=null&&j(t,["toolConfig"],g5(e,h)),r}function x5(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["model"],T2(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],y5(e,a,t)),t}function b5(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],Jc(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function v5(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],Jc(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function w5(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const s=C(n,["expireTime"]);return t!==void 0&&s!=null&&j(t,["expireTime"],s),r}function S5(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],Jc(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],w5(e,a,t)),t}function N5(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const s=C(n,["pageToken"]);return t!==void 0&&s!=null&&j(t,["_query","pageToken"],s),r}function C5(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],N5(e,r,t)),t}function j5(e,n){const t={},r=C(n,["displayName"]);r!=null&&j(t,["displayName"],r);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const s=C(n,["mimeType"]);return s!=null&&j(t,["mimeType"],s),t}function _5(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&j(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const s=C(n,["inlineData"]);s!=null&&j(t,["inlineData"],j5(e,s));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const f=C(n,["executableCode"]);f!=null&&j(t,["executableCode"],f);const d=C(n,["fileData"]);d!=null&&j(t,["fileData"],d);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const h=C(n,["functionResponse"]);h!=null&&j(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function WN(e,n){const t={},r=C(n,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>_5(e,l))),j(t,["parts"],s)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function k5(){return{}}function E5(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function T5(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],E5(e,r)),t}function A5(){return{}}function P5(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&j(t,["apiKeyString"],r),t}function D5(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&j(t,["apiKeyConfig"],P5(e,r));const a=C(n,["authType"]);a!=null&&j(t,["authType"],a);const s=C(n,["googleServiceAccountConfig"]);s!=null&&j(t,["googleServiceAccountConfig"],s);const l=C(n,["httpBasicAuthConfig"]);l!=null&&j(t,["httpBasicAuthConfig"],l);const f=C(n,["oauthConfig"]);f!=null&&j(t,["oauthConfig"],f);const d=C(n,["oidcConfig"]);return d!=null&&j(t,["oidcConfig"],d),t}function I5(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&j(t,["authConfig"],D5(e,r)),t}function M5(e,n){const t={},r=C(n,["retrieval"]);r!=null&&j(t,["retrieval"],r),C(n,["googleSearch"])!=null&&j(t,["googleSearch"],k5());const s=C(n,["googleSearchRetrieval"]);s!=null&&j(t,["googleSearchRetrieval"],T5(e,s)),C(n,["enterpriseWebSearch"])!=null&&j(t,["enterpriseWebSearch"],A5());const f=C(n,["googleMaps"]);f!=null&&j(t,["googleMaps"],I5(e,f));const d=C(n,["codeExecution"]);d!=null&&j(t,["codeExecution"],d);const u=C(n,["functionDeclarations"]);return u!=null&&j(t,["functionDeclarations"],u),t}function R5(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function O5(e,n){const t={},r=C(n,["latitude"]);r!=null&&j(t,["latitude"],r);const a=C(n,["longitude"]);return a!=null&&j(t,["longitude"],a),t}function L5(e,n){const t={},r=C(n,["latLng"]);return r!=null&&j(t,["latLng"],O5(e,r)),t}function F5(e,n){const t={},r=C(n,["functionCallingConfig"]);r!=null&&j(t,["functionCallingConfig"],R5(e,r));const a=C(n,["retrievalConfig"]);return a!=null&&j(t,["retrievalConfig"],L5(e,a)),t}function $5(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const s=C(n,["expireTime"]);t!==void 0&&s!=null&&j(t,["expireTime"],s);const l=C(n,["displayName"]);t!==void 0&&l!=null&&j(t,["displayName"],l);const f=C(n,["contents"]);if(t!==void 0&&f!=null){let g=Qc(e,f);Array.isArray(g)&&(g=g.map(b=>WN(e,b))),j(t,["contents"],g)}const d=C(n,["systemInstruction"]);t!==void 0&&d!=null&&j(t,["systemInstruction"],WN(e,ia(e,d)));const u=C(n,["tools"]);if(t!==void 0&&u!=null){let g=u;Array.isArray(g)&&(g=g.map(b=>M5(e,b))),j(t,["tools"],g)}const h=C(n,["toolConfig"]);return t!==void 0&&h!=null&&j(t,["toolConfig"],F5(e,h)),r}function z5(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["model"],T2(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],$5(e,a,t)),t}function B5(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],Jc(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function U5(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],Jc(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function q5(e,n,t){const r={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const s=C(n,["expireTime"]);return t!==void 0&&s!=null&&j(t,["expireTime"],s),r}function V5(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],Jc(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],q5(e,a,t)),t}function H5(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const s=C(n,["pageToken"]);return t!==void 0&&s!=null&&j(t,["_query","pageToken"],s),r}function G5(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],H5(e,r,t)),t}function Xx(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const s=C(n,["model"]);s!=null&&j(t,["model"],s);const l=C(n,["createTime"]);l!=null&&j(t,["createTime"],l);const f=C(n,["updateTime"]);f!=null&&j(t,["updateTime"],f);const d=C(n,["expireTime"]);d!=null&&j(t,["expireTime"],d);const u=C(n,["usageMetadata"]);return u!=null&&j(t,["usageMetadata"],u),t}function Y5(){return{}}function W5(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["cachedContents"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>Xx(e,l))),j(t,["cachedContents"],s)}return t}function Zx(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const s=C(n,["model"]);s!=null&&j(t,["model"],s);const l=C(n,["createTime"]);l!=null&&j(t,["createTime"],l);const f=C(n,["updateTime"]);f!=null&&j(t,["updateTime"],f);const d=C(n,["expireTime"]);d!=null&&j(t,["expireTime"],d);const u=C(n,["usageMetadata"]);return u!=null&&j(t,["usageMetadata"],u),t}function Q5(){return{}}function J5(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["cachedContents"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>Zx(e,l))),j(t,["cachedContents"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Fh;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Fh||(Fh={}));class Kb{constructor(n,t,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(n,r,a)}init(n,t,r){var a,s;this.nameInternal=n,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};r?typeof r=="object"?l=Object.assign({},r):l=r:l={config:{}},l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(s=(a=l.config)===null||a===void 0?void 0:a.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(n){this.init(this.nameInternal,n,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(n){return this.pageInternal[n]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const n=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:n,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const n=await this.requestInternal(this.params);return this.initNextPage(n),this.page}hasNextPage(){var n;return((n=this.params.config)===null||n===void 0?void 0:n.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var QN;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(QN||(QN={}));var JN;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(JN||(JN={}));var KN;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(KN||(KN={}));var XN;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(XN||(XN={}));var ZN;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(ZN||(ZN={}));var eC;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(eC||(eC={}));var tC;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(tC||(tC={}));var $h;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT"})($h||($h={}));var nC;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY"})(nC||(nC={}));var rC;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(rC||(rC={}));var iC;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(iC||(iC={}));var aC;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(aC||(aC={}));var sC;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(sC||(sC={}));var Yc;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(Yc||(Yc={}));var oC;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(oC||(oC={}));var T1;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(T1||(T1={}));var lC;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(lC||(lC={}));var cC;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(cC||(cC={}));var uC;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(uC||(uC={}));var dC;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(dC||(dC={}));var fC;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(fC||(fC={}));var hC;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(hC||(hC={}));var pC;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi"})(pC||(pC={}));var mC;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(mC||(mC={}));var gC;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(gC||(gC={}));var yC;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(yC||(yC={}));var xC;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(xC||(xC={}));var bC;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(bC||(bC={}));var vC;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(vC||(vC={}));var wC;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(wC||(wC={}));var SC;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(SC||(SC={}));var NC;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(NC||(NC={}));var CC;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(CC||(CC={}));var jC;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(jC||(jC={}));class Ax{get text(){var n,t,r,a,s,l,f,d;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",h=!1;const g=[];for(const b of(d=(f=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||f===void 0?void 0:f.parts)!==null&&d!==void 0?d:[]){for(const[v,S]of Object.entries(b))v!=="text"&&v!=="thought"&&(S!==null||S!==void 0)&&g.push(v);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;h=!0,u+=b.text}}return g.length>0&&console.warn(`there are non-text parts ${g} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?u:void 0}get data(){var n,t,r,a,s,l,f,d;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const h=[];for(const g of(d=(f=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||f===void 0?void 0:f.parts)!==null&&d!==void 0?d:[]){for(const[b,v]of Object.entries(g))b!=="inlineData"&&(v!==null||v!==void 0)&&h.push(b);g.inlineData&&typeof g.inlineData.data=="string"&&(u+=atob(g.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var n,t,r,a,s,l,f,d;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(d=(f=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||f===void 0?void 0:f.parts)===null||d===void 0?void 0:d.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var n,t,r,a,s,l,f,d,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(d=(f=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||f===void 0?void 0:f.parts)===null||d===void 0?void 0:d.filter(g=>g.executableCode).map(g=>g.executableCode).filter(g=>g!==void 0);if((h==null?void 0:h.length)!==0)return(u=h==null?void 0:h[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var n,t,r,a,s,l,f,d,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(d=(f=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||f===void 0?void 0:f.parts)===null||d===void 0?void 0:d.filter(g=>g.codeExecutionResult).map(g=>g.codeExecutionResult).filter(g=>g!==void 0);if((h==null?void 0:h.length)!==0)return(u=h==null?void 0:h[0])===null||u===void 0?void 0:u.output}}class _C{}class kC{}class K5{}class X5{}class EC{}class TC{}class AC{}class Z5{}class PC{}class DC{}class IC{}class e${}class A1{constructor(n){const t={};for(const r of n.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=n}json(){return this.responseInternal.json()}}class t${}class n${}class r${get text(){var n,t,r;let a="",s=!1;const l=[];for(const f of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[d,u]of Object.entries(f))d!=="text"&&d!=="thought"&&u!==null&&l.push(d);if(typeof f.text=="string"){if(typeof f.thought=="boolean"&&f.thought)continue;s=!0,a+=f.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?a:void 0}get data(){var n,t,r;let a="";const s=[];for(const l of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[f,d]of Object.entries(l))f!=="inlineData"&&d!==null&&s.push(f);l.inlineData&&typeof l.inlineData.data=="string"&&(a+=atob(l.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class i$ extends bg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Kb(Fh.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(n){var t,r,a,s;let l,f="",d={};if(this.apiClient.isVertexAI()){const u=z5(this.apiClient,n);return f=Ot("cachedContents",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>Zx(this.apiClient,h))}else{const u=x5(this.apiClient,n);return f=Ot("cachedContents",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>Xx(this.apiClient,h))}}async get(n){var t,r,a,s;let l,f="",d={};if(this.apiClient.isVertexAI()){const u=B5(this.apiClient,n);return f=Ot("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>Zx(this.apiClient,h))}else{const u=b5(this.apiClient,n);return f=Ot("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>Xx(this.apiClient,h))}}async delete(n){var t,r,a,s;let l,f="",d={};if(this.apiClient.isVertexAI()){const u=U5(this.apiClient,n);return f=Ot("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(()=>{const h=Q5(),g=new DC;return Object.assign(g,h),g})}else{const u=v5(this.apiClient,n);return f=Ot("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(()=>{const h=Y5(),g=new DC;return Object.assign(g,h),g})}}async update(n){var t,r,a,s;let l,f="",d={};if(this.apiClient.isVertexAI()){const u=V5(this.apiClient,n);return f=Ot("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>Zx(this.apiClient,h))}else{const u=S5(this.apiClient,n);return f=Ot("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>Xx(this.apiClient,h))}}async listInternal(n){var t,r,a,s;let l,f="",d={};if(this.apiClient.isVertexAI()){const u=G5(this.apiClient,n);return f=Ot("cachedContents",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=J5(this.apiClient,h),b=new IC;return Object.assign(b,g),b})}else{const u=C5(this.apiClient,n);return f=Ot("cachedContents",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>{const g=W5(this.apiClient,h),b=new IC;return Object.assign(b,g),b})}}}function MC(e){var n=typeof Symbol=="function"&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ni(e){return this instanceof Ni?(this.v=e,this):new Ni(e)}function jb(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(e,n||[]),a,s=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),f("next"),f("throw"),f("return",l),a[Symbol.asyncIterator]=function(){return this},a;function l(v){return function(S){return Promise.resolve(S).then(v,g)}}function f(v,S){r[v]&&(a[v]=function(k){return new Promise(function(E,T){s.push([v,k,E,T])>1||d(v,k)})},S&&(a[v]=S(a[v])))}function d(v,S){try{u(r[v](S))}catch(k){b(s[0][3],k)}}function u(v){v.value instanceof Ni?Promise.resolve(v.value.v).then(h,g):b(s[0][2],v)}function h(v){d("next",v)}function g(v){d("throw",v)}function b(v,S){v(S),s.shift(),s.length&&d(s[0][0],s[0][1])}}function P1(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e[Symbol.asyncIterator],t;return n?n.call(e):(e=typeof MC=="function"?MC(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=e[s]&&function(l){return new Promise(function(f,d){l=e[s](l),a(f,d,l.done,l.value)})}}function a(s,l,f,d){Promise.resolve(d).then(function(u){s({value:u,done:f})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function a$(e){var n;if(e.candidates==null||e.candidates.length===0)return!1;const t=(n=e.candidates[0])===null||n===void 0?void 0:n.content;return t===void 0?!1:$2(t)}function $2(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const n of e.parts)if(n===void 0||Object.keys(n).length===0||n.text!==void 0&&n.text==="")return!1;return!0}function s$(e){if(e.length!==0){if(e[0].role!=="user")throw new Error("History must start with a user turn.");for(const n of e)if(n.role!=="user"&&n.role!=="model")throw new Error(`Role must be user or model, but got ${n.role}.`)}}function o$(e){if(e===void 0||e.length===0)return[];const n=[],t=e.length;let r=0,a=e[0];for(;r<t;)if(e[r].role==="user")a=e[r],r++;else{const s=[];let l=!0;for(;r<t&&e[r].role==="model";)s.push(e[r]),l&&!$2(e[r])&&(l=!1),r++;l&&(n.push(a),n.push(...s))}return n}class l${constructor(n,t){this.modelsModule=n,this.apiClient=t}create(n){return new c$(this.apiClient,this.modelsModule,n.model,n.config,n.history)}}class c${constructor(n,t,r,a={},s=[]){this.apiClient=n,this.modelsModule=t,this.model=r,this.config=a,this.history=s,this.sendPromise=Promise.resolve(),s$(s)}async sendMessage(n){var t;await this.sendPromise;const r=ia(this.apiClient,n.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var s,l;const d=(l=(s=(await a).candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content,u=d?[d]:[];this.recordHistory(r,u)})(),await this.sendPromise,a}async sendMessageStream(n){var t;await this.sendPromise;const r=ia(this.apiClient,n.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const s=await a;return this.processStreamResponse(s,r)}getHistory(n=!1){return n?o$(this.history):this.history}processStreamResponse(n,t){var r,a;return jb(this,arguments,function*(){var l,f,d,u;const h=[];try{for(var g=!0,b=P1(n),v;v=yield Ni(b.next()),l=v.done,!l;g=!0){u=v.value,g=!1;const S=u;if(a$(S)){const k=(a=(r=S.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;k!==void 0&&h.push(k)}yield yield Ni(S)}}catch(S){f={error:S}}finally{try{!g&&!l&&(d=b.return)&&(yield Ni(d.call(b)))}finally{if(f)throw f.error}}this.recordHistory(t,h)})}recordHistory(n,t){let r=[];t.length>0&&t.every(a=>a.role==="model")?r=t:r.push({role:"model",parts:[]}),this.history.push(n),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function u$(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const s=C(n,["pageToken"]);return t!==void 0&&s!=null&&j(t,["_query","pageToken"],s),r}function d$(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],u$(e,r,t)),t}function f$(e,n){const t={},r=C(n,["details"]);r!=null&&j(t,["details"],r);const a=C(n,["message"]);a!=null&&j(t,["message"],a);const s=C(n,["code"]);return s!=null&&j(t,["code"],s),t}function h$(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const s=C(n,["mimeType"]);s!=null&&j(t,["mimeType"],s);const l=C(n,["sizeBytes"]);l!=null&&j(t,["sizeBytes"],l);const f=C(n,["createTime"]);f!=null&&j(t,["createTime"],f);const d=C(n,["expirationTime"]);d!=null&&j(t,["expirationTime"],d);const u=C(n,["updateTime"]);u!=null&&j(t,["updateTime"],u);const h=C(n,["sha256Hash"]);h!=null&&j(t,["sha256Hash"],h);const g=C(n,["uri"]);g!=null&&j(t,["uri"],g);const b=C(n,["downloadUri"]);b!=null&&j(t,["downloadUri"],b);const v=C(n,["state"]);v!=null&&j(t,["state"],v);const S=C(n,["source"]);S!=null&&j(t,["source"],S);const k=C(n,["videoMetadata"]);k!=null&&j(t,["videoMetadata"],k);const E=C(n,["error"]);return E!=null&&j(t,["error"],f$(e,E)),t}function p$(e,n){const t={},r=C(n,["file"]);r!=null&&j(t,["file"],h$(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function m$(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","file"],O2(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function g$(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","file"],O2(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function y$(e,n){const t={},r=C(n,["details"]);r!=null&&j(t,["details"],r);const a=C(n,["message"]);a!=null&&j(t,["message"],a);const s=C(n,["code"]);return s!=null&&j(t,["code"],s),t}function D1(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const s=C(n,["mimeType"]);s!=null&&j(t,["mimeType"],s);const l=C(n,["sizeBytes"]);l!=null&&j(t,["sizeBytes"],l);const f=C(n,["createTime"]);f!=null&&j(t,["createTime"],f);const d=C(n,["expirationTime"]);d!=null&&j(t,["expirationTime"],d);const u=C(n,["updateTime"]);u!=null&&j(t,["updateTime"],u);const h=C(n,["sha256Hash"]);h!=null&&j(t,["sha256Hash"],h);const g=C(n,["uri"]);g!=null&&j(t,["uri"],g);const b=C(n,["downloadUri"]);b!=null&&j(t,["downloadUri"],b);const v=C(n,["state"]);v!=null&&j(t,["state"],v);const S=C(n,["source"]);S!=null&&j(t,["source"],S);const k=C(n,["videoMetadata"]);k!=null&&j(t,["videoMetadata"],k);const E=C(n,["error"]);return E!=null&&j(t,["error"],y$(e,E)),t}function x$(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["files"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>D1(e,l))),j(t,["files"],s)}return t}function b$(){return{}}function v$(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class w$ extends bg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Kb(Fh.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(n){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(n.file,n.config).then(t=>D1(this.apiClient,t))}async download(n){await this.apiClient.downloadFile(n)}async listInternal(n){var t,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=d$(this.apiClient,n);return s=Ot("files",f._url),l=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const u=x$(this.apiClient,d),h=new e$;return Object.assign(h,u),h})}}async createInternal(n){var t,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=p$(this.apiClient,n);return s=Ot("upload/v1beta/files",f._url),l=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(()=>{const d=b$(),u=new t$;return Object.assign(u,d),u})}}async get(n){var t,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=m$(this.apiClient,n);return s=Ot("files/{file}",f._url),l=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>D1(this.apiClient,d))}}async delete(n){var t,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=g$(this.apiClient,n);return s=Ot("files/{file}",f._url),l=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(()=>{const d=v$(),u=new n$;return Object.assign(u,d),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function S$(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&j(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function N$(e,n){const t={},r=C(n,["displayName"]);r!=null&&j(t,["displayName"],r);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const s=C(n,["mimeType"]);return s!=null&&j(t,["mimeType"],s),t}function C$(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&j(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],S$(e,a));const s=C(n,["codeExecutionResult"]);s!=null&&j(t,["codeExecutionResult"],s);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const d=C(n,["functionCall"]);d!=null&&j(t,["functionCall"],d);const u=C(n,["functionResponse"]);u!=null&&j(t,["functionResponse"],u);const h=C(n,["text"]);return h!=null&&j(t,["text"],h),t}function j$(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&j(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const s=C(n,["inlineData"]);s!=null&&j(t,["inlineData"],N$(e,s));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const f=C(n,["executableCode"]);f!=null&&j(t,["executableCode"],f);const d=C(n,["fileData"]);d!=null&&j(t,["fileData"],d);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const h=C(n,["functionResponse"]);h!=null&&j(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function _$(e,n){const t={},r=C(n,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>C$(e,l))),j(t,["parts"],s)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function k$(e,n){const t={},r=C(n,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>j$(e,l))),j(t,["parts"],s)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function E$(){return{}}function T$(){return{}}function A$(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function P$(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function D$(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],A$(e,r)),t}function I$(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],P$(e,r)),t}function M$(){return{}}function R$(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&j(t,["apiKeyString"],r),t}function O$(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&j(t,["apiKeyConfig"],R$(e,r));const a=C(n,["authType"]);a!=null&&j(t,["authType"],a);const s=C(n,["googleServiceAccountConfig"]);s!=null&&j(t,["googleServiceAccountConfig"],s);const l=C(n,["httpBasicAuthConfig"]);l!=null&&j(t,["httpBasicAuthConfig"],l);const f=C(n,["oauthConfig"]);f!=null&&j(t,["oauthConfig"],f);const d=C(n,["oidcConfig"]);return d!=null&&j(t,["oidcConfig"],d),t}function L$(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&j(t,["authConfig"],O$(e,r)),t}function F$(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&j(t,["googleSearch"],E$());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&j(t,["googleSearchRetrieval"],D$(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const s=C(n,["codeExecution"]);s!=null&&j(t,["codeExecution"],s);const l=C(n,["functionDeclarations"]);return l!=null&&j(t,["functionDeclarations"],l),t}function $$(e,n){const t={},r=C(n,["retrieval"]);r!=null&&j(t,["retrieval"],r),C(n,["googleSearch"])!=null&&j(t,["googleSearch"],T$());const s=C(n,["googleSearchRetrieval"]);s!=null&&j(t,["googleSearchRetrieval"],I$(e,s)),C(n,["enterpriseWebSearch"])!=null&&j(t,["enterpriseWebSearch"],M$());const f=C(n,["googleMaps"]);f!=null&&j(t,["googleMaps"],L$(e,f));const d=C(n,["codeExecution"]);d!=null&&j(t,["codeExecution"],d);const u=C(n,["functionDeclarations"]);return u!=null&&j(t,["functionDeclarations"],u),t}function z$(e,n){const t={},r=C(n,["handle"]);if(r!=null&&j(t,["handle"],r),C(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function B$(e,n){const t={},r=C(n,["handle"]);r!=null&&j(t,["handle"],r);const a=C(n,["transparent"]);return a!=null&&j(t,["transparent"],a),t}function RC(){return{}}function OC(){return{}}function U$(e,n){const t={},r=C(n,["disabled"]);r!=null&&j(t,["disabled"],r);const a=C(n,["startOfSpeechSensitivity"]);a!=null&&j(t,["startOfSpeechSensitivity"],a);const s=C(n,["endOfSpeechSensitivity"]);s!=null&&j(t,["endOfSpeechSensitivity"],s);const l=C(n,["prefixPaddingMs"]);l!=null&&j(t,["prefixPaddingMs"],l);const f=C(n,["silenceDurationMs"]);return f!=null&&j(t,["silenceDurationMs"],f),t}function q$(e,n){const t={},r=C(n,["disabled"]);r!=null&&j(t,["disabled"],r);const a=C(n,["startOfSpeechSensitivity"]);a!=null&&j(t,["startOfSpeechSensitivity"],a);const s=C(n,["endOfSpeechSensitivity"]);s!=null&&j(t,["endOfSpeechSensitivity"],s);const l=C(n,["prefixPaddingMs"]);l!=null&&j(t,["prefixPaddingMs"],l);const f=C(n,["silenceDurationMs"]);return f!=null&&j(t,["silenceDurationMs"],f),t}function V$(e,n){const t={},r=C(n,["automaticActivityDetection"]);r!=null&&j(t,["automaticActivityDetection"],U$(e,r));const a=C(n,["activityHandling"]);a!=null&&j(t,["activityHandling"],a);const s=C(n,["turnCoverage"]);return s!=null&&j(t,["turnCoverage"],s),t}function H$(e,n){const t={},r=C(n,["automaticActivityDetection"]);r!=null&&j(t,["automaticActivityDetection"],q$(e,r));const a=C(n,["activityHandling"]);a!=null&&j(t,["activityHandling"],a);const s=C(n,["turnCoverage"]);return s!=null&&j(t,["turnCoverage"],s),t}function G$(e,n){const t={},r=C(n,["targetTokens"]);return r!=null&&j(t,["targetTokens"],r),t}function Y$(e,n){const t={},r=C(n,["targetTokens"]);return r!=null&&j(t,["targetTokens"],r),t}function W$(e,n){const t={},r=C(n,["triggerTokens"]);r!=null&&j(t,["triggerTokens"],r);const a=C(n,["slidingWindow"]);return a!=null&&j(t,["slidingWindow"],G$(e,a)),t}function Q$(e,n){const t={},r=C(n,["triggerTokens"]);r!=null&&j(t,["triggerTokens"],r);const a=C(n,["slidingWindow"]);return a!=null&&j(t,["slidingWindow"],Y$(e,a)),t}function J$(e,n,t){const r={},a=C(n,["generationConfig"]);t!==void 0&&a!=null&&j(t,["setup","generationConfig"],a);const s=C(n,["responseModalities"]);t!==void 0&&s!=null&&j(t,["setup","generationConfig","responseModalities"],s);const l=C(n,["temperature"]);t!==void 0&&l!=null&&j(t,["setup","generationConfig","temperature"],l);const f=C(n,["topP"]);t!==void 0&&f!=null&&j(t,["setup","generationConfig","topP"],f);const d=C(n,["topK"]);t!==void 0&&d!=null&&j(t,["setup","generationConfig","topK"],d);const u=C(n,["maxOutputTokens"]);t!==void 0&&u!=null&&j(t,["setup","generationConfig","maxOutputTokens"],u);const h=C(n,["mediaResolution"]);t!==void 0&&h!=null&&j(t,["setup","generationConfig","mediaResolution"],h);const g=C(n,["seed"]);t!==void 0&&g!=null&&j(t,["setup","generationConfig","seed"],g);const b=C(n,["speechConfig"]);t!==void 0&&b!=null&&j(t,["setup","generationConfig","speechConfig"],b);const v=C(n,["systemInstruction"]);t!==void 0&&v!=null&&j(t,["setup","systemInstruction"],_$(e,ia(e,v)));const S=C(n,["tools"]);if(t!==void 0&&S!=null){let q=Jb(e,S);Array.isArray(q)&&(q=q.map(R=>F$(e,Qb(e,R)))),j(t,["setup","tools"],q)}const k=C(n,["sessionResumption"]);t!==void 0&&k!=null&&j(t,["setup","sessionResumption"],z$(e,k));const E=C(n,["inputAudioTranscription"]);t!==void 0&&E!=null&&j(t,["setup","inputAudioTranscription"],RC());const T=C(n,["outputAudioTranscription"]);t!==void 0&&T!=null&&j(t,["setup","outputAudioTranscription"],RC());const I=C(n,["realtimeInputConfig"]);t!==void 0&&I!=null&&j(t,["setup","realtimeInputConfig"],V$(e,I));const D=C(n,["contextWindowCompression"]);return t!==void 0&&D!=null&&j(t,["setup","contextWindowCompression"],W$(e,D)),r}function K$(e,n,t){const r={},a=C(n,["generationConfig"]);t!==void 0&&a!=null&&j(t,["setup","generationConfig"],a);const s=C(n,["responseModalities"]);t!==void 0&&s!=null&&j(t,["setup","generationConfig","responseModalities"],s);const l=C(n,["temperature"]);t!==void 0&&l!=null&&j(t,["setup","generationConfig","temperature"],l);const f=C(n,["topP"]);t!==void 0&&f!=null&&j(t,["setup","generationConfig","topP"],f);const d=C(n,["topK"]);t!==void 0&&d!=null&&j(t,["setup","generationConfig","topK"],d);const u=C(n,["maxOutputTokens"]);t!==void 0&&u!=null&&j(t,["setup","generationConfig","maxOutputTokens"],u);const h=C(n,["mediaResolution"]);t!==void 0&&h!=null&&j(t,["setup","generationConfig","mediaResolution"],h);const g=C(n,["seed"]);t!==void 0&&g!=null&&j(t,["setup","generationConfig","seed"],g);const b=C(n,["speechConfig"]);t!==void 0&&b!=null&&j(t,["setup","generationConfig","speechConfig"],b);const v=C(n,["systemInstruction"]);t!==void 0&&v!=null&&j(t,["setup","systemInstruction"],k$(e,ia(e,v)));const S=C(n,["tools"]);if(t!==void 0&&S!=null){let q=Jb(e,S);Array.isArray(q)&&(q=q.map(R=>$$(e,Qb(e,R)))),j(t,["setup","tools"],q)}const k=C(n,["sessionResumption"]);t!==void 0&&k!=null&&j(t,["setup","sessionResumption"],B$(e,k));const E=C(n,["inputAudioTranscription"]);t!==void 0&&E!=null&&j(t,["setup","inputAudioTranscription"],OC());const T=C(n,["outputAudioTranscription"]);t!==void 0&&T!=null&&j(t,["setup","outputAudioTranscription"],OC());const I=C(n,["realtimeInputConfig"]);t!==void 0&&I!=null&&j(t,["setup","realtimeInputConfig"],H$(e,I));const D=C(n,["contextWindowCompression"]);return t!==void 0&&D!=null&&j(t,["setup","contextWindowCompression"],Q$(e,D)),r}function X$(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["setup","model"],lr(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],J$(e,a,t)),t}function Z$(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["setup","model"],lr(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],K$(e,a,t)),t}function ez(){return{}}function tz(){return{}}function nz(){return{}}function rz(){return{}}function iz(e,n){const t={},r=C(n,["media"]);r!=null&&j(t,["mediaChunks"],A2(e,r));const a=C(n,["audio"]);a!=null&&j(t,["audio"],r5(e,a));const s=C(n,["audioStreamEnd"]);s!=null&&j(t,["audioStreamEnd"],s);const l=C(n,["video"]);l!=null&&j(t,["video"],n5(e,l));const f=C(n,["text"]);return f!=null&&j(t,["text"],f),C(n,["activityStart"])!=null&&j(t,["activityStart"],ez()),C(n,["activityEnd"])!=null&&j(t,["activityEnd"],nz()),t}function az(e,n){const t={},r=C(n,["media"]);if(r!=null&&j(t,["mediaChunks"],A2(e,r)),C(n,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const a=C(n,["audioStreamEnd"]);if(a!=null&&j(t,["audioStreamEnd"],a),C(n,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(C(n,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return C(n,["activityStart"])!=null&&j(t,["activityStart"],tz()),C(n,["activityEnd"])!=null&&j(t,["activityEnd"],rz()),t}function sz(){return{}}function oz(){return{}}function lz(e,n){const t={},r=C(n,["data"]);r!=null&&j(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function cz(e,n){const t={},r=C(n,["displayName"]);r!=null&&j(t,["displayName"],r);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const s=C(n,["mimeType"]);return s!=null&&j(t,["mimeType"],s),t}function uz(e,n){const t={},r=C(n,["thought"]);r!=null&&j(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],lz(e,a));const s=C(n,["codeExecutionResult"]);s!=null&&j(t,["codeExecutionResult"],s);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const d=C(n,["functionCall"]);d!=null&&j(t,["functionCall"],d);const u=C(n,["functionResponse"]);u!=null&&j(t,["functionResponse"],u);const h=C(n,["text"]);return h!=null&&j(t,["text"],h),t}function dz(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&j(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const s=C(n,["inlineData"]);s!=null&&j(t,["inlineData"],cz(e,s));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const f=C(n,["executableCode"]);f!=null&&j(t,["executableCode"],f);const d=C(n,["fileData"]);d!=null&&j(t,["fileData"],d);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const h=C(n,["functionResponse"]);h!=null&&j(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function fz(e,n){const t={},r=C(n,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>uz(e,l))),j(t,["parts"],s)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function hz(e,n){const t={},r=C(n,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>dz(e,l))),j(t,["parts"],s)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function LC(e,n){const t={},r=C(n,["text"]);r!=null&&j(t,["text"],r);const a=C(n,["finished"]);return a!=null&&j(t,["finished"],a),t}function FC(e,n){const t={},r=C(n,["text"]);r!=null&&j(t,["text"],r);const a=C(n,["finished"]);return a!=null&&j(t,["finished"],a),t}function pz(e,n){const t={},r=C(n,["modelTurn"]);r!=null&&j(t,["modelTurn"],fz(e,r));const a=C(n,["turnComplete"]);a!=null&&j(t,["turnComplete"],a);const s=C(n,["interrupted"]);s!=null&&j(t,["interrupted"],s);const l=C(n,["groundingMetadata"]);l!=null&&j(t,["groundingMetadata"],l);const f=C(n,["generationComplete"]);f!=null&&j(t,["generationComplete"],f);const d=C(n,["inputTranscription"]);d!=null&&j(t,["inputTranscription"],LC(e,d));const u=C(n,["outputTranscription"]);return u!=null&&j(t,["outputTranscription"],LC(e,u)),t}function mz(e,n){const t={},r=C(n,["modelTurn"]);r!=null&&j(t,["modelTurn"],hz(e,r));const a=C(n,["turnComplete"]);a!=null&&j(t,["turnComplete"],a);const s=C(n,["interrupted"]);s!=null&&j(t,["interrupted"],s);const l=C(n,["groundingMetadata"]);l!=null&&j(t,["groundingMetadata"],l);const f=C(n,["generationComplete"]);f!=null&&j(t,["generationComplete"],f);const d=C(n,["inputTranscription"]);d!=null&&j(t,["inputTranscription"],FC(e,d));const u=C(n,["outputTranscription"]);return u!=null&&j(t,["outputTranscription"],FC(e,u)),t}function gz(e,n){const t={},r=C(n,["id"]);r!=null&&j(t,["id"],r);const a=C(n,["args"]);a!=null&&j(t,["args"],a);const s=C(n,["name"]);return s!=null&&j(t,["name"],s),t}function yz(e,n){const t={},r=C(n,["args"]);r!=null&&j(t,["args"],r);const a=C(n,["name"]);return a!=null&&j(t,["name"],a),t}function xz(e,n){const t={},r=C(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>gz(e,s))),j(t,["functionCalls"],a)}return t}function bz(e,n){const t={},r=C(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>yz(e,s))),j(t,["functionCalls"],a)}return t}function vz(e,n){const t={},r=C(n,["ids"]);return r!=null&&j(t,["ids"],r),t}function wz(e,n){const t={},r=C(n,["ids"]);return r!=null&&j(t,["ids"],r),t}function Px(e,n){const t={},r=C(n,["modality"]);r!=null&&j(t,["modality"],r);const a=C(n,["tokenCount"]);return a!=null&&j(t,["tokenCount"],a),t}function Dx(e,n){const t={},r=C(n,["modality"]);r!=null&&j(t,["modality"],r);const a=C(n,["tokenCount"]);return a!=null&&j(t,["tokenCount"],a),t}function Sz(e,n){const t={},r=C(n,["promptTokenCount"]);r!=null&&j(t,["promptTokenCount"],r);const a=C(n,["cachedContentTokenCount"]);a!=null&&j(t,["cachedContentTokenCount"],a);const s=C(n,["responseTokenCount"]);s!=null&&j(t,["responseTokenCount"],s);const l=C(n,["toolUsePromptTokenCount"]);l!=null&&j(t,["toolUsePromptTokenCount"],l);const f=C(n,["thoughtsTokenCount"]);f!=null&&j(t,["thoughtsTokenCount"],f);const d=C(n,["totalTokenCount"]);d!=null&&j(t,["totalTokenCount"],d);const u=C(n,["promptTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(S=>Px(e,S))),j(t,["promptTokensDetails"],v)}const h=C(n,["cacheTokensDetails"]);if(h!=null){let v=h;Array.isArray(v)&&(v=v.map(S=>Px(e,S))),j(t,["cacheTokensDetails"],v)}const g=C(n,["responseTokensDetails"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(S=>Px(e,S))),j(t,["responseTokensDetails"],v)}const b=C(n,["toolUsePromptTokensDetails"]);if(b!=null){let v=b;Array.isArray(v)&&(v=v.map(S=>Px(e,S))),j(t,["toolUsePromptTokensDetails"],v)}return t}function Nz(e,n){const t={},r=C(n,["promptTokenCount"]);r!=null&&j(t,["promptTokenCount"],r);const a=C(n,["cachedContentTokenCount"]);a!=null&&j(t,["cachedContentTokenCount"],a);const s=C(n,["candidatesTokenCount"]);s!=null&&j(t,["responseTokenCount"],s);const l=C(n,["toolUsePromptTokenCount"]);l!=null&&j(t,["toolUsePromptTokenCount"],l);const f=C(n,["thoughtsTokenCount"]);f!=null&&j(t,["thoughtsTokenCount"],f);const d=C(n,["totalTokenCount"]);d!=null&&j(t,["totalTokenCount"],d);const u=C(n,["promptTokensDetails"]);if(u!=null){let S=u;Array.isArray(S)&&(S=S.map(k=>Dx(e,k))),j(t,["promptTokensDetails"],S)}const h=C(n,["cacheTokensDetails"]);if(h!=null){let S=h;Array.isArray(S)&&(S=S.map(k=>Dx(e,k))),j(t,["cacheTokensDetails"],S)}const g=C(n,["candidatesTokensDetails"]);if(g!=null){let S=g;Array.isArray(S)&&(S=S.map(k=>Dx(e,k))),j(t,["responseTokensDetails"],S)}const b=C(n,["toolUsePromptTokensDetails"]);if(b!=null){let S=b;Array.isArray(S)&&(S=S.map(k=>Dx(e,k))),j(t,["toolUsePromptTokensDetails"],S)}const v=C(n,["trafficType"]);return v!=null&&j(t,["trafficType"],v),t}function Cz(e,n){const t={},r=C(n,["timeLeft"]);return r!=null&&j(t,["timeLeft"],r),t}function jz(e,n){const t={},r=C(n,["timeLeft"]);return r!=null&&j(t,["timeLeft"],r),t}function _z(e,n){const t={},r=C(n,["newHandle"]);r!=null&&j(t,["newHandle"],r);const a=C(n,["resumable"]);a!=null&&j(t,["resumable"],a);const s=C(n,["lastConsumedClientMessageIndex"]);return s!=null&&j(t,["lastConsumedClientMessageIndex"],s),t}function kz(e,n){const t={},r=C(n,["newHandle"]);r!=null&&j(t,["newHandle"],r);const a=C(n,["resumable"]);a!=null&&j(t,["resumable"],a);const s=C(n,["lastConsumedClientMessageIndex"]);return s!=null&&j(t,["lastConsumedClientMessageIndex"],s),t}function Ez(e,n){const t={};C(n,["setupComplete"])!=null&&j(t,["setupComplete"],sz());const a=C(n,["serverContent"]);a!=null&&j(t,["serverContent"],pz(e,a));const s=C(n,["toolCall"]);s!=null&&j(t,["toolCall"],xz(e,s));const l=C(n,["toolCallCancellation"]);l!=null&&j(t,["toolCallCancellation"],vz(e,l));const f=C(n,["usageMetadata"]);f!=null&&j(t,["usageMetadata"],Sz(e,f));const d=C(n,["goAway"]);d!=null&&j(t,["goAway"],Cz(e,d));const u=C(n,["sessionResumptionUpdate"]);return u!=null&&j(t,["sessionResumptionUpdate"],_z(e,u)),t}function Tz(e,n){const t={};C(n,["setupComplete"])!=null&&j(t,["setupComplete"],oz());const a=C(n,["serverContent"]);a!=null&&j(t,["serverContent"],mz(e,a));const s=C(n,["toolCall"]);s!=null&&j(t,["toolCall"],bz(e,s));const l=C(n,["toolCallCancellation"]);l!=null&&j(t,["toolCallCancellation"],wz(e,l));const f=C(n,["usageMetadata"]);f!=null&&j(t,["usageMetadata"],Nz(e,f));const d=C(n,["goAway"]);d!=null&&j(t,["goAway"],jz(e,d));const u=C(n,["sessionResumptionUpdate"]);return u!=null&&j(t,["sessionResumptionUpdate"],kz(e,u)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Az(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=C(n,["data"]);r!=null&&j(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function Pz(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=C(n,["thought"]);r!=null&&j(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],Az(e,a));const s=C(n,["codeExecutionResult"]);s!=null&&j(t,["codeExecutionResult"],s);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const d=C(n,["functionCall"]);d!=null&&j(t,["functionCall"],d);const u=C(n,["functionResponse"]);u!=null&&j(t,["functionResponse"],u);const h=C(n,["text"]);return h!=null&&j(t,["text"],h),t}function Xb(e,n){const t={},r=C(n,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>Pz(e,l))),j(t,["parts"],s)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function Dz(e,n){const t={};if(C(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=C(n,["category"]);r!=null&&j(t,["category"],r);const a=C(n,["threshold"]);return a!=null&&j(t,["threshold"],a),t}function Iz(){return{}}function Mz(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function Rz(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],Mz(e,r)),t}function Oz(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&j(t,["googleSearch"],Iz());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&j(t,["googleSearchRetrieval"],Rz(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const s=C(n,["codeExecution"]);s!=null&&j(t,["codeExecution"],s);const l=C(n,["functionDeclarations"]);return l!=null&&j(t,["functionDeclarations"],l),t}function Lz(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function Fz(e,n){const t={},r=C(n,["functionCallingConfig"]);if(r!=null&&j(t,["functionCallingConfig"],Lz(e,r)),C(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function $z(e,n){const t={},r=C(n,["voiceName"]);return r!=null&&j(t,["voiceName"],r),t}function zz(e,n){const t={},r=C(n,["prebuiltVoiceConfig"]);return r!=null&&j(t,["prebuiltVoiceConfig"],$z(e,r)),t}function Bz(e,n){const t={},r=C(n,["voiceConfig"]);r!=null&&j(t,["voiceConfig"],zz(e,r));const a=C(n,["languageCode"]);return a!=null&&j(t,["languageCode"],a),t}function Uz(e,n){const t={},r=C(n,["includeThoughts"]);r!=null&&j(t,["includeThoughts"],r);const a=C(n,["thinkingBudget"]);return a!=null&&j(t,["thinkingBudget"],a),t}function qz(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&j(t,["systemInstruction"],Xb(e,ia(e,a)));const s=C(n,["temperature"]);s!=null&&j(r,["temperature"],s);const l=C(n,["topP"]);l!=null&&j(r,["topP"],l);const f=C(n,["topK"]);f!=null&&j(r,["topK"],f);const d=C(n,["candidateCount"]);d!=null&&j(r,["candidateCount"],d);const u=C(n,["maxOutputTokens"]);u!=null&&j(r,["maxOutputTokens"],u);const h=C(n,["stopSequences"]);h!=null&&j(r,["stopSequences"],h);const g=C(n,["responseLogprobs"]);g!=null&&j(r,["responseLogprobs"],g);const b=C(n,["logprobs"]);b!=null&&j(r,["logprobs"],b);const v=C(n,["presencePenalty"]);v!=null&&j(r,["presencePenalty"],v);const S=C(n,["frequencyPenalty"]);S!=null&&j(r,["frequencyPenalty"],S);const k=C(n,["seed"]);k!=null&&j(r,["seed"],k);const E=C(n,["responseMimeType"]);E!=null&&j(r,["responseMimeType"],E);const T=C(n,["responseSchema"]);if(T!=null&&j(r,["responseSchema"],I2(e,T)),C(n,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(C(n,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const I=C(n,["safetySettings"]);if(t!==void 0&&I!=null){let L=I;Array.isArray(L)&&(L=L.map($=>Dz(e,$))),j(t,["safetySettings"],L)}const D=C(n,["tools"]);if(t!==void 0&&D!=null){let L=Jb(e,D);Array.isArray(L)&&(L=L.map($=>Oz(e,Qb(e,$)))),j(t,["tools"],L)}const q=C(n,["toolConfig"]);if(t!==void 0&&q!=null&&j(t,["toolConfig"],Fz(e,q)),C(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const R=C(n,["cachedContent"]);t!==void 0&&R!=null&&j(t,["cachedContent"],Jc(e,R));const F=C(n,["responseModalities"]);F!=null&&j(r,["responseModalities"],F);const U=C(n,["mediaResolution"]);U!=null&&j(r,["mediaResolution"],U);const z=C(n,["speechConfig"]);if(z!=null&&j(r,["speechConfig"],Bz(e,M2(e,z))),C(n,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const V=C(n,["thinkingConfig"]);return V!=null&&j(r,["thinkingConfig"],Uz(e,V)),r}function $C(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],lr(e,r));const a=C(n,["contents"]);if(a!=null){let l=Qc(e,a);Array.isArray(l)&&(l=l.map(f=>Xb(e,f))),j(t,["contents"],l)}const s=C(n,["config"]);return s!=null&&j(t,["generationConfig"],qz(e,s,t)),t}function Vz(e,n,t){const r={},a=C(n,["taskType"]);t!==void 0&&a!=null&&j(t,["requests[]","taskType"],a);const s=C(n,["title"]);t!==void 0&&s!=null&&j(t,["requests[]","title"],s);const l=C(n,["outputDimensionality"]);if(t!==void 0&&l!=null&&j(t,["requests[]","outputDimensionality"],l),C(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(C(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function Hz(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],lr(e,r));const a=C(n,["contents"]);a!=null&&j(t,["requests[]","content"],D2(e,a));const s=C(n,["config"]);s!=null&&j(t,["config"],Vz(e,s,t));const l=C(n,["model"]);return l!==void 0&&j(t,["requests[]","model"],lr(e,l)),t}function Gz(e,n,t){const r={};if(C(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(C(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const a=C(n,["numberOfImages"]);t!==void 0&&a!=null&&j(t,["parameters","sampleCount"],a);const s=C(n,["aspectRatio"]);t!==void 0&&s!=null&&j(t,["parameters","aspectRatio"],s);const l=C(n,["guidanceScale"]);if(t!==void 0&&l!=null&&j(t,["parameters","guidanceScale"],l),C(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const f=C(n,["safetyFilterLevel"]);t!==void 0&&f!=null&&j(t,["parameters","safetySetting"],f);const d=C(n,["personGeneration"]);t!==void 0&&d!=null&&j(t,["parameters","personGeneration"],d);const u=C(n,["includeSafetyAttributes"]);t!==void 0&&u!=null&&j(t,["parameters","includeSafetyAttributes"],u);const h=C(n,["includeRaiReason"]);t!==void 0&&h!=null&&j(t,["parameters","includeRaiReason"],h);const g=C(n,["language"]);t!==void 0&&g!=null&&j(t,["parameters","language"],g);const b=C(n,["outputMimeType"]);t!==void 0&&b!=null&&j(t,["parameters","outputOptions","mimeType"],b);const v=C(n,["outputCompressionQuality"]);if(t!==void 0&&v!=null&&j(t,["parameters","outputOptions","compressionQuality"],v),C(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(C(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function Yz(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],lr(e,r));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const s=C(n,["config"]);return s!=null&&j(t,["config"],Gz(e,s,t)),t}function Wz(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","name"],lr(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function Qz(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const s=C(n,["pageToken"]);t!==void 0&&s!=null&&j(t,["_query","pageToken"],s);const l=C(n,["filter"]);t!==void 0&&l!=null&&j(t,["_query","filter"],l);const f=C(n,["queryBase"]);return t!==void 0&&f!=null&&j(t,["_url","models_url"],L2(e,f)),r}function Jz(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],Qz(e,r,t)),t}function Kz(e,n,t){const r={},a=C(n,["displayName"]);t!==void 0&&a!=null&&j(t,["displayName"],a);const s=C(n,["description"]);t!==void 0&&s!=null&&j(t,["description"],s);const l=C(n,["defaultCheckpointId"]);return t!==void 0&&l!=null&&j(t,["defaultCheckpointId"],l),r}function Xz(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","name"],lr(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],Kz(e,a,t)),t}function Zz(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","name"],lr(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function eB(e,n){const t={};if(C(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(C(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(C(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function tB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],lr(e,r));const a=C(n,["contents"]);if(a!=null){let l=Qc(e,a);Array.isArray(l)&&(l=l.map(f=>Xb(e,f))),j(t,["contents"],l)}const s=C(n,["config"]);return s!=null&&j(t,["config"],eB(e,s)),t}function nB(e,n){const t={};if(C(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=C(n,["imageBytes"]);r!=null&&j(t,["bytesBase64Encoded"],Kc(e,r));const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function rB(e,n,t){const r={},a=C(n,["numberOfVideos"]);if(t!==void 0&&a!=null&&j(t,["parameters","sampleCount"],a),C(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(C(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=C(n,["durationSeconds"]);if(t!==void 0&&s!=null&&j(t,["parameters","durationSeconds"],s),C(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=C(n,["aspectRatio"]);if(t!==void 0&&l!=null&&j(t,["parameters","aspectRatio"],l),C(n,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const f=C(n,["personGeneration"]);if(t!==void 0&&f!=null&&j(t,["parameters","personGeneration"],f),C(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const d=C(n,["negativePrompt"]);if(t!==void 0&&d!=null&&j(t,["parameters","negativePrompt"],d),C(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function iB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],lr(e,r));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const s=C(n,["image"]);s!=null&&j(t,["instances[0]","image"],nB(e,s));const l=C(n,["config"]);return l!=null&&j(t,["config"],rB(e,l,t)),t}function aB(e,n){const t={},r=C(n,["displayName"]);r!=null&&j(t,["displayName"],r);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const s=C(n,["mimeType"]);return s!=null&&j(t,["mimeType"],s),t}function sB(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&j(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const s=C(n,["inlineData"]);s!=null&&j(t,["inlineData"],aB(e,s));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const f=C(n,["executableCode"]);f!=null&&j(t,["executableCode"],f);const d=C(n,["fileData"]);d!=null&&j(t,["fileData"],d);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const h=C(n,["functionResponse"]);h!=null&&j(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function Gh(e,n){const t={},r=C(n,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>sB(e,l))),j(t,["parts"],s)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function oB(e,n){const t={},r=C(n,["featureSelectionPreference"]);return r!=null&&j(t,["featureSelectionPreference"],r),t}function lB(e,n){const t={},r=C(n,["method"]);r!=null&&j(t,["method"],r);const a=C(n,["category"]);a!=null&&j(t,["category"],a);const s=C(n,["threshold"]);return s!=null&&j(t,["threshold"],s),t}function cB(){return{}}function uB(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function dB(e,n){const t={},r=C(n,["dynamicRetrievalConfig"]);return r!=null&&j(t,["dynamicRetrievalConfig"],uB(e,r)),t}function fB(){return{}}function hB(e,n){const t={},r=C(n,["apiKeyString"]);return r!=null&&j(t,["apiKeyString"],r),t}function pB(e,n){const t={},r=C(n,["apiKeyConfig"]);r!=null&&j(t,["apiKeyConfig"],hB(e,r));const a=C(n,["authType"]);a!=null&&j(t,["authType"],a);const s=C(n,["googleServiceAccountConfig"]);s!=null&&j(t,["googleServiceAccountConfig"],s);const l=C(n,["httpBasicAuthConfig"]);l!=null&&j(t,["httpBasicAuthConfig"],l);const f=C(n,["oauthConfig"]);f!=null&&j(t,["oauthConfig"],f);const d=C(n,["oidcConfig"]);return d!=null&&j(t,["oidcConfig"],d),t}function mB(e,n){const t={},r=C(n,["authConfig"]);return r!=null&&j(t,["authConfig"],pB(e,r)),t}function z2(e,n){const t={},r=C(n,["retrieval"]);r!=null&&j(t,["retrieval"],r),C(n,["googleSearch"])!=null&&j(t,["googleSearch"],cB());const s=C(n,["googleSearchRetrieval"]);s!=null&&j(t,["googleSearchRetrieval"],dB(e,s)),C(n,["enterpriseWebSearch"])!=null&&j(t,["enterpriseWebSearch"],fB());const f=C(n,["googleMaps"]);f!=null&&j(t,["googleMaps"],mB(e,f));const d=C(n,["codeExecution"]);d!=null&&j(t,["codeExecution"],d);const u=C(n,["functionDeclarations"]);return u!=null&&j(t,["functionDeclarations"],u),t}function gB(e,n){const t={},r=C(n,["mode"]);r!=null&&j(t,["mode"],r);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function yB(e,n){const t={},r=C(n,["latitude"]);r!=null&&j(t,["latitude"],r);const a=C(n,["longitude"]);return a!=null&&j(t,["longitude"],a),t}function xB(e,n){const t={},r=C(n,["latLng"]);return r!=null&&j(t,["latLng"],yB(e,r)),t}function bB(e,n){const t={},r=C(n,["functionCallingConfig"]);r!=null&&j(t,["functionCallingConfig"],gB(e,r));const a=C(n,["retrievalConfig"]);return a!=null&&j(t,["retrievalConfig"],xB(e,a)),t}function vB(e,n){const t={},r=C(n,["voiceName"]);return r!=null&&j(t,["voiceName"],r),t}function wB(e,n){const t={},r=C(n,["prebuiltVoiceConfig"]);return r!=null&&j(t,["prebuiltVoiceConfig"],vB(e,r)),t}function SB(e,n){const t={},r=C(n,["voiceConfig"]);r!=null&&j(t,["voiceConfig"],wB(e,r));const a=C(n,["languageCode"]);return a!=null&&j(t,["languageCode"],a),t}function NB(e,n){const t={},r=C(n,["includeThoughts"]);r!=null&&j(t,["includeThoughts"],r);const a=C(n,["thinkingBudget"]);return a!=null&&j(t,["thinkingBudget"],a),t}function CB(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&j(t,["systemInstruction"],Gh(e,ia(e,a)));const s=C(n,["temperature"]);s!=null&&j(r,["temperature"],s);const l=C(n,["topP"]);l!=null&&j(r,["topP"],l);const f=C(n,["topK"]);f!=null&&j(r,["topK"],f);const d=C(n,["candidateCount"]);d!=null&&j(r,["candidateCount"],d);const u=C(n,["maxOutputTokens"]);u!=null&&j(r,["maxOutputTokens"],u);const h=C(n,["stopSequences"]);h!=null&&j(r,["stopSequences"],h);const g=C(n,["responseLogprobs"]);g!=null&&j(r,["responseLogprobs"],g);const b=C(n,["logprobs"]);b!=null&&j(r,["logprobs"],b);const v=C(n,["presencePenalty"]);v!=null&&j(r,["presencePenalty"],v);const S=C(n,["frequencyPenalty"]);S!=null&&j(r,["frequencyPenalty"],S);const k=C(n,["seed"]);k!=null&&j(r,["seed"],k);const E=C(n,["responseMimeType"]);E!=null&&j(r,["responseMimeType"],E);const T=C(n,["responseSchema"]);T!=null&&j(r,["responseSchema"],I2(e,T));const I=C(n,["routingConfig"]);I!=null&&j(r,["routingConfig"],I);const D=C(n,["modelSelectionConfig"]);D!=null&&j(r,["modelConfig"],oB(e,D));const q=C(n,["safetySettings"]);if(t!==void 0&&q!=null){let te=q;Array.isArray(te)&&(te=te.map(ae=>lB(e,ae))),j(t,["safetySettings"],te)}const R=C(n,["tools"]);if(t!==void 0&&R!=null){let te=Jb(e,R);Array.isArray(te)&&(te=te.map(ae=>z2(e,Qb(e,ae)))),j(t,["tools"],te)}const F=C(n,["toolConfig"]);t!==void 0&&F!=null&&j(t,["toolConfig"],bB(e,F));const U=C(n,["labels"]);t!==void 0&&U!=null&&j(t,["labels"],U);const z=C(n,["cachedContent"]);t!==void 0&&z!=null&&j(t,["cachedContent"],Jc(e,z));const V=C(n,["responseModalities"]);V!=null&&j(r,["responseModalities"],V);const L=C(n,["mediaResolution"]);L!=null&&j(r,["mediaResolution"],L);const $=C(n,["speechConfig"]);$!=null&&j(r,["speechConfig"],SB(e,M2(e,$)));const H=C(n,["audioTimestamp"]);H!=null&&j(r,["audioTimestamp"],H);const ee=C(n,["thinkingConfig"]);return ee!=null&&j(r,["thinkingConfig"],NB(e,ee)),r}function zC(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],lr(e,r));const a=C(n,["contents"]);if(a!=null){let l=Qc(e,a);Array.isArray(l)&&(l=l.map(f=>Gh(e,f))),j(t,["contents"],l)}const s=C(n,["config"]);return s!=null&&j(t,["generationConfig"],CB(e,s,t)),t}function jB(e,n,t){const r={},a=C(n,["taskType"]);t!==void 0&&a!=null&&j(t,["instances[]","task_type"],a);const s=C(n,["title"]);t!==void 0&&s!=null&&j(t,["instances[]","title"],s);const l=C(n,["outputDimensionality"]);t!==void 0&&l!=null&&j(t,["parameters","outputDimensionality"],l);const f=C(n,["mimeType"]);t!==void 0&&f!=null&&j(t,["instances[]","mimeType"],f);const d=C(n,["autoTruncate"]);return t!==void 0&&d!=null&&j(t,["parameters","autoTruncate"],d),r}function _B(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],lr(e,r));const a=C(n,["contents"]);a!=null&&j(t,["instances[]","content"],D2(e,a));const s=C(n,["config"]);return s!=null&&j(t,["config"],jB(e,s,t)),t}function kB(e,n,t){const r={},a=C(n,["outputGcsUri"]);t!==void 0&&a!=null&&j(t,["parameters","storageUri"],a);const s=C(n,["negativePrompt"]);t!==void 0&&s!=null&&j(t,["parameters","negativePrompt"],s);const l=C(n,["numberOfImages"]);t!==void 0&&l!=null&&j(t,["parameters","sampleCount"],l);const f=C(n,["aspectRatio"]);t!==void 0&&f!=null&&j(t,["parameters","aspectRatio"],f);const d=C(n,["guidanceScale"]);t!==void 0&&d!=null&&j(t,["parameters","guidanceScale"],d);const u=C(n,["seed"]);t!==void 0&&u!=null&&j(t,["parameters","seed"],u);const h=C(n,["safetyFilterLevel"]);t!==void 0&&h!=null&&j(t,["parameters","safetySetting"],h);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&j(t,["parameters","personGeneration"],g);const b=C(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&j(t,["parameters","includeSafetyAttributes"],b);const v=C(n,["includeRaiReason"]);t!==void 0&&v!=null&&j(t,["parameters","includeRaiReason"],v);const S=C(n,["language"]);t!==void 0&&S!=null&&j(t,["parameters","language"],S);const k=C(n,["outputMimeType"]);t!==void 0&&k!=null&&j(t,["parameters","outputOptions","mimeType"],k);const E=C(n,["outputCompressionQuality"]);t!==void 0&&E!=null&&j(t,["parameters","outputOptions","compressionQuality"],E);const T=C(n,["addWatermark"]);t!==void 0&&T!=null&&j(t,["parameters","addWatermark"],T);const I=C(n,["enhancePrompt"]);return t!==void 0&&I!=null&&j(t,["parameters","enhancePrompt"],I),r}function EB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],lr(e,r));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const s=C(n,["config"]);return s!=null&&j(t,["config"],kB(e,s,t)),t}function Hw(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&j(t,["gcsUri"],r);const a=C(n,["imageBytes"]);a!=null&&j(t,["bytesBase64Encoded"],Kc(e,a));const s=C(n,["mimeType"]);return s!=null&&j(t,["mimeType"],s),t}function TB(e,n){const t={},r=C(n,["maskMode"]);r!=null&&j(t,["maskMode"],r);const a=C(n,["segmentationClasses"]);a!=null&&j(t,["maskClasses"],a);const s=C(n,["maskDilation"]);return s!=null&&j(t,["dilation"],s),t}function AB(e,n){const t={},r=C(n,["controlType"]);r!=null&&j(t,["controlType"],r);const a=C(n,["enableControlImageComputation"]);return a!=null&&j(t,["computeControl"],a),t}function PB(e,n){const t={},r=C(n,["styleDescription"]);return r!=null&&j(t,["styleDescription"],r),t}function DB(e,n){const t={},r=C(n,["subjectType"]);r!=null&&j(t,["subjectType"],r);const a=C(n,["subjectDescription"]);return a!=null&&j(t,["subjectDescription"],a),t}function IB(e,n){const t={},r=C(n,["referenceImage"]);r!=null&&j(t,["referenceImage"],Hw(e,r));const a=C(n,["referenceId"]);a!=null&&j(t,["referenceId"],a);const s=C(n,["referenceType"]);s!=null&&j(t,["referenceType"],s);const l=C(n,["maskImageConfig"]);l!=null&&j(t,["maskImageConfig"],TB(e,l));const f=C(n,["controlImageConfig"]);f!=null&&j(t,["controlImageConfig"],AB(e,f));const d=C(n,["styleImageConfig"]);d!=null&&j(t,["styleImageConfig"],PB(e,d));const u=C(n,["subjectImageConfig"]);return u!=null&&j(t,["subjectImageConfig"],DB(e,u)),t}function MB(e,n,t){const r={},a=C(n,["outputGcsUri"]);t!==void 0&&a!=null&&j(t,["parameters","storageUri"],a);const s=C(n,["negativePrompt"]);t!==void 0&&s!=null&&j(t,["parameters","negativePrompt"],s);const l=C(n,["numberOfImages"]);t!==void 0&&l!=null&&j(t,["parameters","sampleCount"],l);const f=C(n,["aspectRatio"]);t!==void 0&&f!=null&&j(t,["parameters","aspectRatio"],f);const d=C(n,["guidanceScale"]);t!==void 0&&d!=null&&j(t,["parameters","guidanceScale"],d);const u=C(n,["seed"]);t!==void 0&&u!=null&&j(t,["parameters","seed"],u);const h=C(n,["safetyFilterLevel"]);t!==void 0&&h!=null&&j(t,["parameters","safetySetting"],h);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&j(t,["parameters","personGeneration"],g);const b=C(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&j(t,["parameters","includeSafetyAttributes"],b);const v=C(n,["includeRaiReason"]);t!==void 0&&v!=null&&j(t,["parameters","includeRaiReason"],v);const S=C(n,["language"]);t!==void 0&&S!=null&&j(t,["parameters","language"],S);const k=C(n,["outputMimeType"]);t!==void 0&&k!=null&&j(t,["parameters","outputOptions","mimeType"],k);const E=C(n,["outputCompressionQuality"]);t!==void 0&&E!=null&&j(t,["parameters","outputOptions","compressionQuality"],E);const T=C(n,["editMode"]);t!==void 0&&T!=null&&j(t,["parameters","editMode"],T);const I=C(n,["baseSteps"]);return t!==void 0&&I!=null&&j(t,["parameters","editConfig","baseSteps"],I),r}function RB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],lr(e,r));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const s=C(n,["referenceImages"]);if(s!=null){let f=s;Array.isArray(f)&&(f=f.map(d=>IB(e,d))),j(t,["instances[0]","referenceImages"],f)}const l=C(n,["config"]);return l!=null&&j(t,["config"],MB(e,l,t)),t}function OB(e,n,t){const r={},a=C(n,["includeRaiReason"]);t!==void 0&&a!=null&&j(t,["parameters","includeRaiReason"],a);const s=C(n,["outputMimeType"]);t!==void 0&&s!=null&&j(t,["parameters","outputOptions","mimeType"],s);const l=C(n,["outputCompressionQuality"]);t!==void 0&&l!=null&&j(t,["parameters","outputOptions","compressionQuality"],l);const f=C(n,["numberOfImages"]);t!==void 0&&f!=null&&j(t,["parameters","sampleCount"],f);const d=C(n,["mode"]);return t!==void 0&&d!=null&&j(t,["parameters","mode"],d),r}function LB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],lr(e,r));const a=C(n,["image"]);a!=null&&j(t,["instances[0]","image"],Hw(e,a));const s=C(n,["upscaleFactor"]);s!=null&&j(t,["parameters","upscaleConfig","upscaleFactor"],s);const l=C(n,["config"]);return l!=null&&j(t,["config"],OB(e,l,t)),t}function FB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","name"],lr(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function $B(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const s=C(n,["pageToken"]);t!==void 0&&s!=null&&j(t,["_query","pageToken"],s);const l=C(n,["filter"]);t!==void 0&&l!=null&&j(t,["_query","filter"],l);const f=C(n,["queryBase"]);return t!==void 0&&f!=null&&j(t,["_url","models_url"],L2(e,f)),r}function zB(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],$B(e,r,t)),t}function BB(e,n,t){const r={},a=C(n,["displayName"]);t!==void 0&&a!=null&&j(t,["displayName"],a);const s=C(n,["description"]);t!==void 0&&s!=null&&j(t,["description"],s);const l=C(n,["defaultCheckpointId"]);return t!==void 0&&l!=null&&j(t,["defaultCheckpointId"],l),r}function UB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],lr(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],BB(e,a,t)),t}function qB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","name"],lr(e,r));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function VB(e,n,t){const r={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&j(t,["systemInstruction"],Gh(e,ia(e,a)));const s=C(n,["tools"]);if(t!==void 0&&s!=null){let f=s;Array.isArray(f)&&(f=f.map(d=>z2(e,d))),j(t,["tools"],f)}const l=C(n,["generationConfig"]);return t!==void 0&&l!=null&&j(t,["generationConfig"],l),r}function HB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],lr(e,r));const a=C(n,["contents"]);if(a!=null){let l=Qc(e,a);Array.isArray(l)&&(l=l.map(f=>Gh(e,f))),j(t,["contents"],l)}const s=C(n,["config"]);return s!=null&&j(t,["config"],VB(e,s,t)),t}function GB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],lr(e,r));const a=C(n,["contents"]);if(a!=null){let l=Qc(e,a);Array.isArray(l)&&(l=l.map(f=>Gh(e,f))),j(t,["contents"],l)}const s=C(n,["config"]);return s!=null&&j(t,["config"],s),t}function YB(e,n,t){const r={},a=C(n,["numberOfVideos"]);t!==void 0&&a!=null&&j(t,["parameters","sampleCount"],a);const s=C(n,["outputGcsUri"]);t!==void 0&&s!=null&&j(t,["parameters","storageUri"],s);const l=C(n,["fps"]);t!==void 0&&l!=null&&j(t,["parameters","fps"],l);const f=C(n,["durationSeconds"]);t!==void 0&&f!=null&&j(t,["parameters","durationSeconds"],f);const d=C(n,["seed"]);t!==void 0&&d!=null&&j(t,["parameters","seed"],d);const u=C(n,["aspectRatio"]);t!==void 0&&u!=null&&j(t,["parameters","aspectRatio"],u);const h=C(n,["resolution"]);t!==void 0&&h!=null&&j(t,["parameters","resolution"],h);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&j(t,["parameters","personGeneration"],g);const b=C(n,["pubsubTopic"]);t!==void 0&&b!=null&&j(t,["parameters","pubsubTopic"],b);const v=C(n,["negativePrompt"]);t!==void 0&&v!=null&&j(t,["parameters","negativePrompt"],v);const S=C(n,["enhancePrompt"]);return t!==void 0&&S!=null&&j(t,["parameters","enhancePrompt"],S),r}function WB(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["_url","model"],lr(e,r));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const s=C(n,["image"]);s!=null&&j(t,["instances[0]","image"],Hw(e,s));const l=C(n,["config"]);return l!=null&&j(t,["config"],YB(e,l,t)),t}function QB(e,n){const t={},r=C(n,["data"]);r!=null&&j(t,["data"],r);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function JB(e,n){const t={},r=C(n,["thought"]);r!=null&&j(t,["thought"],r);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],QB(e,a));const s=C(n,["codeExecutionResult"]);s!=null&&j(t,["codeExecutionResult"],s);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const d=C(n,["functionCall"]);d!=null&&j(t,["functionCall"],d);const u=C(n,["functionResponse"]);u!=null&&j(t,["functionResponse"],u);const h=C(n,["text"]);return h!=null&&j(t,["text"],h),t}function KB(e,n){const t={},r=C(n,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>JB(e,l))),j(t,["parts"],s)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function XB(e,n){const t={},r=C(n,["citationSources"]);return r!=null&&j(t,["citations"],r),t}function ZB(e,n){const t={},r=C(n,["content"]);r!=null&&j(t,["content"],KB(e,r));const a=C(n,["citationMetadata"]);a!=null&&j(t,["citationMetadata"],XB(e,a));const s=C(n,["tokenCount"]);s!=null&&j(t,["tokenCount"],s);const l=C(n,["finishReason"]);l!=null&&j(t,["finishReason"],l);const f=C(n,["avgLogprobs"]);f!=null&&j(t,["avgLogprobs"],f);const d=C(n,["groundingMetadata"]);d!=null&&j(t,["groundingMetadata"],d);const u=C(n,["index"]);u!=null&&j(t,["index"],u);const h=C(n,["logprobsResult"]);h!=null&&j(t,["logprobsResult"],h);const g=C(n,["safetyRatings"]);return g!=null&&j(t,["safetyRatings"],g),t}function BC(e,n){const t={},r=C(n,["candidates"]);if(r!=null){let f=r;Array.isArray(f)&&(f=f.map(d=>ZB(e,d))),j(t,["candidates"],f)}const a=C(n,["modelVersion"]);a!=null&&j(t,["modelVersion"],a);const s=C(n,["promptFeedback"]);s!=null&&j(t,["promptFeedback"],s);const l=C(n,["usageMetadata"]);return l!=null&&j(t,["usageMetadata"],l),t}function e8(e,n){const t={},r=C(n,["values"]);return r!=null&&j(t,["values"],r),t}function t8(){return{}}function n8(e,n){const t={},r=C(n,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>e8(e,l))),j(t,["embeddings"],s)}return C(n,["metadata"])!=null&&j(t,["metadata"],t8()),t}function r8(e,n){const t={},r=C(n,["bytesBase64Encoded"]);r!=null&&j(t,["imageBytes"],Kc(e,r));const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function B2(e,n){const t={},r=C(n,["safetyAttributes","categories"]);r!=null&&j(t,["categories"],r);const a=C(n,["safetyAttributes","scores"]);a!=null&&j(t,["scores"],a);const s=C(n,["contentType"]);return s!=null&&j(t,["contentType"],s),t}function i8(e,n){const t={},r=C(n,["_self"]);r!=null&&j(t,["image"],r8(e,r));const a=C(n,["raiFilteredReason"]);a!=null&&j(t,["raiFilteredReason"],a);const s=C(n,["_self"]);return s!=null&&j(t,["safetyAttributes"],B2(e,s)),t}function a8(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>i8(e,l))),j(t,["generatedImages"],s)}const a=C(n,["positivePromptSafetyAttributes"]);return a!=null&&j(t,["positivePromptSafetyAttributes"],B2(e,a)),t}function s8(e,n){const t={},r=C(n,["baseModel"]);r!=null&&j(t,["baseModel"],r);const a=C(n,["createTime"]);a!=null&&j(t,["createTime"],a);const s=C(n,["updateTime"]);return s!=null&&j(t,["updateTime"],s),t}function I1(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const s=C(n,["description"]);s!=null&&j(t,["description"],s);const l=C(n,["version"]);l!=null&&j(t,["version"],l);const f=C(n,["_self"]);f!=null&&j(t,["tunedModelInfo"],s8(e,f));const d=C(n,["inputTokenLimit"]);d!=null&&j(t,["inputTokenLimit"],d);const u=C(n,["outputTokenLimit"]);u!=null&&j(t,["outputTokenLimit"],u);const h=C(n,["supportedGenerationMethods"]);return h!=null&&j(t,["supportedActions"],h),t}function o8(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["_self"]);if(a!=null){let s=F2(e,a);Array.isArray(s)&&(s=s.map(l=>I1(e,l))),j(t,["models"],s)}return t}function l8(){return{}}function c8(e,n){const t={},r=C(n,["totalTokens"]);r!=null&&j(t,["totalTokens"],r);const a=C(n,["cachedContentTokenCount"]);return a!=null&&j(t,["cachedContentTokenCount"],a),t}function u8(e,n){const t={},r=C(n,["video","uri"]);r!=null&&j(t,["uri"],r);const a=C(n,["video","encodedVideo"]);a!=null&&j(t,["videoBytes"],Kc(e,a));const s=C(n,["encoding"]);return s!=null&&j(t,["mimeType"],s),t}function d8(e,n){const t={},r=C(n,["_self"]);return r!=null&&j(t,["video"],u8(e,r)),t}function f8(e,n){const t={},r=C(n,["generatedSamples"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(f=>d8(e,f))),j(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const s=C(n,["raiMediaFilteredReasons"]);return s!=null&&j(t,["raiMediaFilteredReasons"],s),t}function h8(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const s=C(n,["done"]);s!=null&&j(t,["done"],s);const l=C(n,["error"]);l!=null&&j(t,["error"],l);const f=C(n,["response","generateVideoResponse"]);return f!=null&&j(t,["response"],f8(e,f)),t}function p8(e,n){const t={},r=C(n,["displayName"]);r!=null&&j(t,["displayName"],r);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const s=C(n,["mimeType"]);return s!=null&&j(t,["mimeType"],s),t}function m8(e,n){const t={},r=C(n,["videoMetadata"]);r!=null&&j(t,["videoMetadata"],r);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const s=C(n,["inlineData"]);s!=null&&j(t,["inlineData"],p8(e,s));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const f=C(n,["executableCode"]);f!=null&&j(t,["executableCode"],f);const d=C(n,["fileData"]);d!=null&&j(t,["fileData"],d);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const h=C(n,["functionResponse"]);h!=null&&j(t,["functionResponse"],h);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function g8(e,n){const t={},r=C(n,["parts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>m8(e,l))),j(t,["parts"],s)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function y8(e,n){const t={},r=C(n,["citations"]);return r!=null&&j(t,["citations"],r),t}function x8(e,n){const t={},r=C(n,["content"]);r!=null&&j(t,["content"],g8(e,r));const a=C(n,["citationMetadata"]);a!=null&&j(t,["citationMetadata"],y8(e,a));const s=C(n,["finishMessage"]);s!=null&&j(t,["finishMessage"],s);const l=C(n,["finishReason"]);l!=null&&j(t,["finishReason"],l);const f=C(n,["avgLogprobs"]);f!=null&&j(t,["avgLogprobs"],f);const d=C(n,["groundingMetadata"]);d!=null&&j(t,["groundingMetadata"],d);const u=C(n,["index"]);u!=null&&j(t,["index"],u);const h=C(n,["logprobsResult"]);h!=null&&j(t,["logprobsResult"],h);const g=C(n,["safetyRatings"]);return g!=null&&j(t,["safetyRatings"],g),t}function UC(e,n){const t={},r=C(n,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(h=>x8(e,h))),j(t,["candidates"],u)}const a=C(n,["createTime"]);a!=null&&j(t,["createTime"],a);const s=C(n,["responseId"]);s!=null&&j(t,["responseId"],s);const l=C(n,["modelVersion"]);l!=null&&j(t,["modelVersion"],l);const f=C(n,["promptFeedback"]);f!=null&&j(t,["promptFeedback"],f);const d=C(n,["usageMetadata"]);return d!=null&&j(t,["usageMetadata"],d),t}function b8(e,n){const t={},r=C(n,["truncated"]);r!=null&&j(t,["truncated"],r);const a=C(n,["token_count"]);return a!=null&&j(t,["tokenCount"],a),t}function v8(e,n){const t={},r=C(n,["values"]);r!=null&&j(t,["values"],r);const a=C(n,["statistics"]);return a!=null&&j(t,["statistics"],b8(e,a)),t}function w8(e,n){const t={},r=C(n,["billableCharacterCount"]);return r!=null&&j(t,["billableCharacterCount"],r),t}function S8(e,n){const t={},r=C(n,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>v8(e,l))),j(t,["embeddings"],s)}const a=C(n,["metadata"]);return a!=null&&j(t,["metadata"],w8(e,a)),t}function N8(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&j(t,["gcsUri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&j(t,["imageBytes"],Kc(e,a));const s=C(n,["mimeType"]);return s!=null&&j(t,["mimeType"],s),t}function U2(e,n){const t={},r=C(n,["safetyAttributes","categories"]);r!=null&&j(t,["categories"],r);const a=C(n,["safetyAttributes","scores"]);a!=null&&j(t,["scores"],a);const s=C(n,["contentType"]);return s!=null&&j(t,["contentType"],s),t}function Gw(e,n){const t={},r=C(n,["_self"]);r!=null&&j(t,["image"],N8(e,r));const a=C(n,["raiFilteredReason"]);a!=null&&j(t,["raiFilteredReason"],a);const s=C(n,["_self"]);s!=null&&j(t,["safetyAttributes"],U2(e,s));const l=C(n,["prompt"]);return l!=null&&j(t,["enhancedPrompt"],l),t}function C8(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(l=>Gw(e,l))),j(t,["generatedImages"],s)}const a=C(n,["positivePromptSafetyAttributes"]);return a!=null&&j(t,["positivePromptSafetyAttributes"],U2(e,a)),t}function j8(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>Gw(e,s))),j(t,["generatedImages"],a)}return t}function _8(e,n){const t={},r=C(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>Gw(e,s))),j(t,["generatedImages"],a)}return t}function k8(e,n){const t={},r=C(n,["endpoint"]);r!=null&&j(t,["name"],r);const a=C(n,["deployedModelId"]);return a!=null&&j(t,["deployedModelId"],a),t}function E8(e,n){const t={},r=C(n,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&j(t,["baseModel"],r);const a=C(n,["createTime"]);a!=null&&j(t,["createTime"],a);const s=C(n,["updateTime"]);return s!=null&&j(t,["updateTime"],s),t}function T8(e,n){const t={},r=C(n,["checkpointId"]);r!=null&&j(t,["checkpointId"],r);const a=C(n,["epoch"]);a!=null&&j(t,["epoch"],a);const s=C(n,["step"]);return s!=null&&j(t,["step"],s),t}function M1(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const s=C(n,["description"]);s!=null&&j(t,["description"],s);const l=C(n,["versionId"]);l!=null&&j(t,["version"],l);const f=C(n,["deployedModels"]);if(f!=null){let b=f;Array.isArray(b)&&(b=b.map(v=>k8(e,v))),j(t,["endpoints"],b)}const d=C(n,["labels"]);d!=null&&j(t,["labels"],d);const u=C(n,["_self"]);u!=null&&j(t,["tunedModelInfo"],E8(e,u));const h=C(n,["defaultCheckpointId"]);h!=null&&j(t,["defaultCheckpointId"],h);const g=C(n,["checkpoints"]);if(g!=null){let b=g;Array.isArray(b)&&(b=b.map(v=>T8(e,v))),j(t,["checkpoints"],b)}return t}function A8(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["_self"]);if(a!=null){let s=F2(e,a);Array.isArray(s)&&(s=s.map(l=>M1(e,l))),j(t,["models"],s)}return t}function P8(){return{}}function D8(e,n){const t={},r=C(n,["totalTokens"]);return r!=null&&j(t,["totalTokens"],r),t}function I8(e,n){const t={},r=C(n,["tokensInfo"]);return r!=null&&j(t,["tokensInfo"],r),t}function M8(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&j(t,["uri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&j(t,["videoBytes"],Kc(e,a));const s=C(n,["mimeType"]);return s!=null&&j(t,["mimeType"],s),t}function R8(e,n){const t={},r=C(n,["_self"]);return r!=null&&j(t,["video"],M8(e,r)),t}function O8(e,n){const t={},r=C(n,["videos"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(f=>R8(e,f))),j(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const s=C(n,["raiMediaFilteredReasons"]);return s!=null&&j(t,["raiMediaFilteredReasons"],s),t}function L8(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const s=C(n,["done"]);s!=null&&j(t,["done"],s);const l=C(n,["error"]);l!=null&&j(t,["error"],l);const f=C(n,["response"]);return f!=null&&j(t,["response"],O8(e,f)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const F8="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function $8(e,n,t){const r=new r$;let a;if(t.data instanceof Blob?a=JSON.parse(await t.data.text()):a=JSON.parse(t.data),e.isVertexAI()){const s=Tz(e,a);Object.assign(r,s)}else{const s=Ez(e,a);Object.assign(r,s)}n(r)}class z8{constructor(n,t,r){this.apiClient=n,this.auth=t,this.webSocketFactory=r}async connect(n){var t,r,a,s;const l=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let d;const u=V8(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())d=`${l}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(u);else{const q=this.apiClient.getApiKey();d=`${l}/ws/google.ai.generativelanguage.${f}.GenerativeService.BidiGenerateContent?key=${q}`}let h=()=>{};const g=new Promise(q=>{h=q}),b=n.callbacks,v=function(){var q;(q=b==null?void 0:b.onopen)===null||q===void 0||q.call(b),h({})},S=this.apiClient,k={onopen:v,onmessage:q=>{$8(S,b.onmessage,q)},onerror:(t=b==null?void 0:b.onerror)!==null&&t!==void 0?t:function(q){},onclose:(r=b==null?void 0:b.onclose)!==null&&r!==void 0?r:function(q){}},E=this.webSocketFactory.create(d,q8(u),k);E.connect(),await g;let T=lr(this.apiClient,n.model);if(this.apiClient.isVertexAI()&&T.startsWith("publishers/")){const q=this.apiClient.getProject(),R=this.apiClient.getLocation();T=`projects/${q}/locations/${R}/`+T}let I={};this.apiClient.isVertexAI()&&((a=n.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(n.config===void 0?n.config={responseModalities:[Yc.AUDIO]}:n.config.responseModalities=[Yc.AUDIO]),!((s=n.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const D={model:T,config:n.config,callbacks:n.callbacks};return this.apiClient.isVertexAI()?I=Z$(this.apiClient,D):I=X$(this.apiClient,D),delete I.config,E.send(JSON.stringify(I)),new U8(E,this.apiClient)}}const B8={turnComplete:!0};class U8{constructor(n,t){this.conn=n,this.apiClient=t}tLiveClientContent(n,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=Qc(n,t.turns),n.isVertexAI()?r=r.map(a=>Gh(n,a)):r=r.map(a=>Xb(n,a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(n,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!n.isVertexAI()&&!("id"in s))throw new Error(F8)}return{toolResponse:{functionResponses:r}}}sendClientContent(n){n=Object.assign(Object.assign({},B8),n);const t=this.tLiveClientContent(this.apiClient,n);this.conn.send(JSON.stringify(t))}sendRealtimeInput(n){let t={};this.apiClient.isVertexAI()?t={realtimeInput:az(this.apiClient,n)}:t={realtimeInput:iz(this.apiClient,n)},this.conn.send(JSON.stringify(t))}sendToolResponse(n){if(n.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,n);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function q8(e){const n={};return e.forEach((t,r)=>{n[r]=t}),n}function V8(e){const n=new Headers;for(const[t,r]of Object.entries(e))n.append(t,r);return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class H8 extends bg{constructor(n){super(),this.apiClient=n,this.generateContent=async t=>await this.generateContentInternal(t),this.generateContentStream=async t=>await this.generateContentStreamInternal(t),this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var a;let s;const l=[];if(r!=null&&r.generatedImages)for(const d of r.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((a=d==null?void 0:d.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?s=d==null?void 0:d.safetyAttributes:l.push(d);let f;return s?f={generatedImages:l,positivePromptSafetyAttributes:s}:f={generatedImages:l},f}),this.list=async t=>{var r;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((r=l.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Kb(Fh.PAGED_ITEM_MODELS,f=>this.listInternal(f),await this.listInternal(l),l)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const a={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(a)}}async generateContentInternal(n){var t,r,a,s;let l,f="",d={};if(this.apiClient.isVertexAI()){const u=zC(this.apiClient,n);return f=Ot("{model}:generateContent",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=UC(this.apiClient,h),b=new Ax;return Object.assign(b,g),b})}else{const u=$C(this.apiClient,n);return f=Ot("{model}:generateContent",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>{const g=BC(this.apiClient,h),b=new Ax;return Object.assign(b,g),b})}}async generateContentStreamInternal(n){var t,r,a,s;let l,f="",d={};if(this.apiClient.isVertexAI()){const u=zC(this.apiClient,n);f=Ot("{model}:streamGenerateContent?alt=sse",u._url),d=u._query,delete u.config,delete u._url,delete u._query;const h=this.apiClient;return l=h.requestStream({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}),l.then(function(g){return jb(this,arguments,function*(){var b,v,S,k;try{for(var E=!0,T=P1(g),I;I=yield Ni(T.next()),b=I.done,!b;E=!0){k=I.value,E=!1;const q=UC(h,yield Ni(k.json())),R=new Ax;Object.assign(R,q),yield yield Ni(R)}}catch(D){v={error:D}}finally{try{!E&&!b&&(S=T.return)&&(yield Ni(S.call(T)))}finally{if(v)throw v.error}}})})}else{const u=$C(this.apiClient,n);f=Ot("{model}:streamGenerateContent?alt=sse",u._url),d=u._query,delete u.config,delete u._url,delete u._query;const h=this.apiClient;return l=h.requestStream({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}),l.then(function(g){return jb(this,arguments,function*(){var b,v,S,k;try{for(var E=!0,T=P1(g),I;I=yield Ni(T.next()),b=I.done,!b;E=!0){k=I.value,E=!1;const q=BC(h,yield Ni(k.json())),R=new Ax;Object.assign(R,q),yield yield Ni(R)}}catch(D){v={error:D}}finally{try{!E&&!b&&(S=T.return)&&(yield Ni(S.call(T)))}finally{if(v)throw v.error}}})})}}async embedContent(n){var t,r,a,s;let l,f="",d={};if(this.apiClient.isVertexAI()){const u=_B(this.apiClient,n);return f=Ot("{model}:predict",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=S8(this.apiClient,h),b=new _C;return Object.assign(b,g),b})}else{const u=Hz(this.apiClient,n);return f=Ot("{model}:batchEmbedContents",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>{const g=n8(this.apiClient,h),b=new _C;return Object.assign(b,g),b})}}async generateImagesInternal(n){var t,r,a,s;let l,f="",d={};if(this.apiClient.isVertexAI()){const u=EB(this.apiClient,n);return f=Ot("{model}:predict",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=C8(this.apiClient,h),b=new kC;return Object.assign(b,g),b})}else{const u=Yz(this.apiClient,n);return f=Ot("{model}:predict",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>{const g=a8(this.apiClient,h),b=new kC;return Object.assign(b,g),b})}}async editImageInternal(n){var t,r;let a,s="",l={};if(this.apiClient.isVertexAI()){const f=RB(this.apiClient,n);return s=Ot("{model}:predict",f._url),l=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const u=j8(this.apiClient,d),h=new K5;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(n){var t,r;let a,s="",l={};if(this.apiClient.isVertexAI()){const f=LB(this.apiClient,n);return s=Ot("{model}:predict",f._url),l=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const u=_8(this.apiClient,d),h=new X5;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(n){var t,r,a,s;let l,f="",d={};if(this.apiClient.isVertexAI()){const u=FB(this.apiClient,n);return f=Ot("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>M1(this.apiClient,h))}else{const u=Wz(this.apiClient,n);return f=Ot("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>I1(this.apiClient,h))}}async listInternal(n){var t,r,a,s;let l,f="",d={};if(this.apiClient.isVertexAI()){const u=zB(this.apiClient,n);return f=Ot("{models_url}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=A8(this.apiClient,h),b=new EC;return Object.assign(b,g),b})}else{const u=Jz(this.apiClient,n);return f=Ot("{models_url}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>{const g=o8(this.apiClient,h),b=new EC;return Object.assign(b,g),b})}}async update(n){var t,r,a,s;let l,f="",d={};if(this.apiClient.isVertexAI()){const u=UB(this.apiClient,n);return f=Ot("{model}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>M1(this.apiClient,h))}else{const u=Xz(this.apiClient,n);return f=Ot("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>I1(this.apiClient,h))}}async delete(n){var t,r,a,s;let l,f="",d={};if(this.apiClient.isVertexAI()){const u=qB(this.apiClient,n);return f=Ot("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(()=>{const h=P8(),g=new TC;return Object.assign(g,h),g})}else{const u=Zz(this.apiClient,n);return f=Ot("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(()=>{const h=l8(),g=new TC;return Object.assign(g,h),g})}}async countTokens(n){var t,r,a,s;let l,f="",d={};if(this.apiClient.isVertexAI()){const u=HB(this.apiClient,n);return f=Ot("{model}:countTokens",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=D8(this.apiClient,h),b=new AC;return Object.assign(b,g),b})}else{const u=tB(this.apiClient,n);return f=Ot("{model}:countTokens",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>{const g=c8(this.apiClient,h),b=new AC;return Object.assign(b,g),b})}}async computeTokens(n){var t,r;let a,s="",l={};if(this.apiClient.isVertexAI()){const f=GB(this.apiClient,n);return s=Ot("{model}:computeTokens",f._url),l=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const u=I8(this.apiClient,d),h=new Z5;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(n){var t,r,a,s;let l,f="",d={};if(this.apiClient.isVertexAI()){const u=WB(this.apiClient,n);return f=Ot("{model}:predictLongRunning",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>L8(this.apiClient,h))}else{const u=iB(this.apiClient,n);return f=Ot("{model}:predictLongRunning",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>h8(this.apiClient,h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function G8(e,n){const t={},r=C(n,["operationName"]);r!=null&&j(t,["_url","operationName"],r);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function Y8(e,n){const t={},r=C(n,["operationName"]);r!=null&&j(t,["_url","operationName"],r);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function W8(e,n){const t={},r=C(n,["operationName"]);r!=null&&j(t,["operationName"],r);const a=C(n,["resourceName"]);a!=null&&j(t,["_url","resourceName"],a);const s=C(n,["config"]);return s!=null&&j(t,["config"],s),t}function Q8(e,n){const t={},r=C(n,["video","uri"]);r!=null&&j(t,["uri"],r);const a=C(n,["video","encodedVideo"]);a!=null&&j(t,["videoBytes"],Kc(e,a));const s=C(n,["encoding"]);return s!=null&&j(t,["mimeType"],s),t}function J8(e,n){const t={},r=C(n,["_self"]);return r!=null&&j(t,["video"],Q8(e,r)),t}function K8(e,n){const t={},r=C(n,["generatedSamples"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(f=>J8(e,f))),j(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const s=C(n,["raiMediaFilteredReasons"]);return s!=null&&j(t,["raiMediaFilteredReasons"],s),t}function X8(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const s=C(n,["done"]);s!=null&&j(t,["done"],s);const l=C(n,["error"]);l!=null&&j(t,["error"],l);const f=C(n,["response","generateVideoResponse"]);return f!=null&&j(t,["response"],K8(e,f)),t}function Z8(e,n){const t={},r=C(n,["gcsUri"]);r!=null&&j(t,["uri"],r);const a=C(n,["bytesBase64Encoded"]);a!=null&&j(t,["videoBytes"],Kc(e,a));const s=C(n,["mimeType"]);return s!=null&&j(t,["mimeType"],s),t}function eU(e,n){const t={},r=C(n,["_self"]);return r!=null&&j(t,["video"],Z8(e,r)),t}function tU(e,n){const t={},r=C(n,["videos"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(f=>eU(e,f))),j(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const s=C(n,["raiMediaFilteredReasons"]);return s!=null&&j(t,["raiMediaFilteredReasons"],s),t}function qC(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const s=C(n,["done"]);s!=null&&j(t,["done"],s);const l=C(n,["error"]);l!=null&&j(t,["error"],l);const f=C(n,["response"]);return f!=null&&j(t,["response"],tU(e,f)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nU extends bg{constructor(n){super(),this.apiClient=n}async getVideosOperation(n){const t=n.operation,r=n.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=t.name.split("/operations/")[0];let s;return r&&"httpOptions"in r&&(s=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:a,config:{httpOptions:s}})}else return this.getVideosOperationInternal({operationName:t.name,config:r})}async getVideosOperationInternal(n){var t,r,a,s;let l,f="",d={};if(this.apiClient.isVertexAI()){const u=Y8(this.apiClient,n);return f=Ot("{operationName}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>qC(this.apiClient,h))}else{const u=G8(this.apiClient,n);return f=Ot("{operationName}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>X8(this.apiClient,h))}}async fetchPredictVideosOperationInternal(n){var t,r;let a,s="",l={};if(this.apiClient.isVertexAI()){const f=W8(this.apiClient,n);return s=Ot("{resourceName}:fetchPredictOperation",f._url),l=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>qC(this.apiClient,d))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const rU="Content-Type",iU="X-Server-Timeout",aU="User-Agent",sU="x-goog-api-client",oU="0.14.1",lU=`google-genai-sdk/${oU}`,cU="v1beta1",uU="v1beta",VC=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class q2 extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ClientError"}}class R1 extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ServerError"}}class dU{constructor(n){var t,r;this.clientOptions=Object.assign(Object.assign({},n),{project:n.project,location:n.location,apiKey:n.apiKey,vertexai:n.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:cU,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:uU,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,n.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,n.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var n;return(n=this.clientOptions.vertexai)!==null&&n!==void 0?n:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(n){if(!n||n.baseUrl===void 0||n.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[n.baseUrl.endsWith("/")?n.baseUrl.slice(0,-1):n.baseUrl];return n.apiVersion&&n.apiVersion!==""&&r.push(n.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const n=this.getBaseUrl(),t=new URL(n);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(n){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=n;else throw new Error("HTTP options are not correctly set.")}constructUrl(n,t,r){const a=[this.getRequestUrlInternal(t)];return r&&a.push(this.getBaseResourcePath()),n!==""&&a.push(n),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(n){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||n.path.startsWith("projects/")||n.httpMethod==="GET"&&n.path.startsWith("publishers/google/models"))}async request(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);if(n.queryParams)for(const[l,f]of Object.entries(n.queryParams))a.searchParams.append(l,String(f));let s={};if(n.httpMethod==="GET"){if(n.body&&n.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=n.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,t,n.abortSignal),this.unaryApiCall(a,s,n.httpMethod)}patchHttpOptions(n,t){const r=JSON.parse(JSON.stringify(n));for(const[a,s]of Object.entries(t))typeof s=="object"?r[a]=Object.assign(Object.assign({},r[a]),s):s!==void 0&&(r[a]=s);return r}async requestStream(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let s={};return s.body=n.body,s=await this.includeExtraHttpOptionsToRequestInit(s,t,n.abortSignal),this.streamApiCall(a,s,n.httpMethod)}async includeExtraHttpOptionsToRequestInit(n,t,r){if(t&&t.timeout||r){const a=new AbortController,s=a.signal;t.timeout&&(t==null?void 0:t.timeout)>0&&setTimeout(()=>a.abort(),t.timeout),r&&r.addEventListener("abort",()=>{a.abort()}),n.signal=s}return n.headers=await this.getHeadersInternal(t),n}async unaryApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await HC(a),new A1(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await HC(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(n){var t;return jb(this,arguments,function*(){const a=(t=n==null?void 0:n.body)===null||t===void 0?void 0:t.getReader(),s=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let l="";for(;;){const{done:f,value:d}=yield Ni(a.read());if(f){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=s.decode(d);try{const g=JSON.parse(u);if("error"in g){const b=JSON.parse(JSON.stringify(g.error)),v=b.status,S=b.code,k=`got status: ${v}. ${JSON.stringify(g)}`;if(S>=400&&S<500)throw new q2(k);if(S>=500&&S<600)throw new R1(k)}}catch(g){const b=g;if(b.name==="ClientError"||b.name==="ServerError")throw g}l+=u;let h=l.match(VC);for(;h;){const g=h[1];try{const b=new Response(g,{headers:n==null?void 0:n.headers,status:n==null?void 0:n.status,statusText:n==null?void 0:n.statusText});yield yield Ni(new A1(b)),l=l.slice(h[0].length),h=l.match(VC)}catch(b){throw new Error(`exception parsing stream chunk ${g}. ${b}`)}}}}finally{a.releaseLock()}})}async apiCall(n,t){return fetch(n,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const n={},t=lU+" "+this.clientOptions.userAgentExtra;return n[aU]=t,n[sU]=t,n[rU]="application/json",n}async getHeadersInternal(n){const t=new Headers;if(n&&n.headers){for(const[r,a]of Object.entries(n.headers))t.append(r,a);n.timeout&&n.timeout>0&&t.append(iU,String(Math.ceil(n.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(n,t){var r;const a={};t!=null&&(a.mimeType=t.mimeType,a.name=t.name,a.displayName=t.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const s=this.clientOptions.uploader,l=await s.stat(n);a.sizeBytes=String(l.size);const f=(r=t==null?void 0:t.mimeType)!==null&&r!==void 0?r:l.type;if(f===void 0||f==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=f;const d=await this.fetchUploadUrl(a,t);return s.upload(n,d,this)}async downloadFile(n){await this.clientOptions.downloader.download(n,this)}async fetchUploadUrl(n,t){var r;let a={};t!=null&&t.httpOptions?a=t.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${n.mimeType}`}};const s={file:n},l=await this.request({path:Ot("upload/v1beta/files",s._url),body:JSON.stringify(s),httpMethod:"POST",httpOptions:a});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const f=(r=l==null?void 0:l.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(f===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return f}}async function HC(e){var n;if(e===void 0)throw new R1("response is undefined");if(!e.ok){const t=e.status,r=e.statusText;let a;!((n=e.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?a=await e.json():a={error:{message:await e.text(),code:e.status,status:e.statusText}};const s=`got status: ${t} ${r}. ${JSON.stringify(a)}`;throw t>=400&&t<500?new q2(s):t>=500&&t<600?new R1(s):new Error(s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function fU(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],r);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function hU(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const s=C(n,["pageToken"]);t!==void 0&&s!=null&&j(t,["_query","pageToken"],s);const l=C(n,["filter"]);return t!==void 0&&l!=null&&j(t,["_query","filter"],l),r}function pU(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],hU(e,r,t)),t}function mU(e,n){const t={},r=C(n,["textInput"]);r!=null&&j(t,["textInput"],r);const a=C(n,["output"]);return a!=null&&j(t,["output"],a),t}function gU(e,n){const t={};if(C(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=C(n,["examples"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(s=>mU(e,s))),j(t,["examples","examples"],a)}return t}function yU(e,n,t){const r={};if(C(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const a=C(n,["tunedModelDisplayName"]);if(t!==void 0&&a!=null&&j(t,["displayName"],a),C(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=C(n,["epochCount"]);t!==void 0&&s!=null&&j(t,["tuningTask","hyperparameters","epochCount"],s);const l=C(n,["learningRateMultiplier"]);if(l!=null&&j(r,["tuningTask","hyperparameters","learningRateMultiplier"],l),C(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(C(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const f=C(n,["batchSize"]);t!==void 0&&f!=null&&j(t,["tuningTask","hyperparameters","batchSize"],f);const d=C(n,["learningRate"]);return t!==void 0&&d!=null&&j(t,["tuningTask","hyperparameters","learningRate"],d),r}function xU(e,n){const t={},r=C(n,["baseModel"]);r!=null&&j(t,["baseModel"],r);const a=C(n,["trainingDataset"]);a!=null&&j(t,["tuningTask","trainingData"],gU(e,a));const s=C(n,["config"]);return s!=null&&j(t,["config"],yU(e,s,t)),t}function bU(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["_url","name"],r);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function vU(e,n,t){const r={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const s=C(n,["pageToken"]);t!==void 0&&s!=null&&j(t,["_query","pageToken"],s);const l=C(n,["filter"]);return t!==void 0&&l!=null&&j(t,["_query","filter"],l),r}function wU(e,n){const t={},r=C(n,["config"]);return r!=null&&j(t,["config"],vU(e,r,t)),t}function SU(e,n,t){const r={},a=C(n,["gcsUri"]);if(t!==void 0&&a!=null&&j(t,["supervisedTuningSpec","trainingDatasetUri"],a),C(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function NU(e,n){const t={},r=C(n,["gcsUri"]);return r!=null&&j(t,["validationDatasetUri"],r),t}function CU(e,n,t){const r={},a=C(n,["validationDataset"]);t!==void 0&&a!=null&&j(t,["supervisedTuningSpec"],NU(e,a));const s=C(n,["tunedModelDisplayName"]);t!==void 0&&s!=null&&j(t,["tunedModelDisplayName"],s);const l=C(n,["description"]);t!==void 0&&l!=null&&j(t,["description"],l);const f=C(n,["epochCount"]);t!==void 0&&f!=null&&j(t,["supervisedTuningSpec","hyperParameters","epochCount"],f);const d=C(n,["learningRateMultiplier"]);t!==void 0&&d!=null&&j(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],d);const u=C(n,["exportLastCheckpointOnly"]);t!==void 0&&u!=null&&j(t,["supervisedTuningSpec","exportLastCheckpointOnly"],u);const h=C(n,["adapterSize"]);if(t!==void 0&&h!=null&&j(t,["supervisedTuningSpec","hyperParameters","adapterSize"],h),C(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(C(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function jU(e,n){const t={},r=C(n,["baseModel"]);r!=null&&j(t,["baseModel"],r);const a=C(n,["trainingDataset"]);a!=null&&j(t,["supervisedTuningSpec","trainingDatasetUri"],SU(e,a,t));const s=C(n,["config"]);return s!=null&&j(t,["config"],CU(e,s,t)),t}function _U(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["model"],r);const a=C(n,["name"]);return a!=null&&j(t,["endpoint"],a),t}function V2(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["state"]);a!=null&&j(t,["state"],R2(e,a));const s=C(n,["createTime"]);s!=null&&j(t,["createTime"],s);const l=C(n,["tuningTask","startTime"]);l!=null&&j(t,["startTime"],l);const f=C(n,["tuningTask","completeTime"]);f!=null&&j(t,["endTime"],f);const d=C(n,["updateTime"]);d!=null&&j(t,["updateTime"],d);const u=C(n,["description"]);u!=null&&j(t,["description"],u);const h=C(n,["baseModel"]);h!=null&&j(t,["baseModel"],h);const g=C(n,["_self"]);g!=null&&j(t,["tunedModel"],_U(e,g));const b=C(n,["distillationSpec"]);b!=null&&j(t,["distillationSpec"],b);const v=C(n,["experiment"]);v!=null&&j(t,["experiment"],v);const S=C(n,["labels"]);S!=null&&j(t,["labels"],S);const k=C(n,["pipelineJob"]);k!=null&&j(t,["pipelineJob"],k);const E=C(n,["tunedModelDisplayName"]);return E!=null&&j(t,["tunedModelDisplayName"],E),t}function kU(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["tunedModels"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>V2(e,l))),j(t,["tuningJobs"],s)}return t}function EU(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const s=C(n,["done"]);s!=null&&j(t,["done"],s);const l=C(n,["error"]);return l!=null&&j(t,["error"],l),t}function TU(e,n){const t={},r=C(n,["checkpointId"]);r!=null&&j(t,["checkpointId"],r);const a=C(n,["epoch"]);a!=null&&j(t,["epoch"],a);const s=C(n,["step"]);s!=null&&j(t,["step"],s);const l=C(n,["endpoint"]);return l!=null&&j(t,["endpoint"],l),t}function AU(e,n){const t={},r=C(n,["model"]);r!=null&&j(t,["model"],r);const a=C(n,["endpoint"]);a!=null&&j(t,["endpoint"],a);const s=C(n,["checkpoints"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(f=>TU(e,f))),j(t,["checkpoints"],l)}return t}function O1(e,n){const t={},r=C(n,["name"]);r!=null&&j(t,["name"],r);const a=C(n,["state"]);a!=null&&j(t,["state"],R2(e,a));const s=C(n,["createTime"]);s!=null&&j(t,["createTime"],s);const l=C(n,["startTime"]);l!=null&&j(t,["startTime"],l);const f=C(n,["endTime"]);f!=null&&j(t,["endTime"],f);const d=C(n,["updateTime"]);d!=null&&j(t,["updateTime"],d);const u=C(n,["error"]);u!=null&&j(t,["error"],u);const h=C(n,["description"]);h!=null&&j(t,["description"],h);const g=C(n,["baseModel"]);g!=null&&j(t,["baseModel"],g);const b=C(n,["tunedModel"]);b!=null&&j(t,["tunedModel"],AU(e,b));const v=C(n,["supervisedTuningSpec"]);v!=null&&j(t,["supervisedTuningSpec"],v);const S=C(n,["tuningDataStats"]);S!=null&&j(t,["tuningDataStats"],S);const k=C(n,["encryptionSpec"]);k!=null&&j(t,["encryptionSpec"],k);const E=C(n,["partnerModelTuningSpec"]);E!=null&&j(t,["partnerModelTuningSpec"],E);const T=C(n,["distillationSpec"]);T!=null&&j(t,["distillationSpec"],T);const I=C(n,["experiment"]);I!=null&&j(t,["experiment"],I);const D=C(n,["labels"]);D!=null&&j(t,["labels"],D);const q=C(n,["pipelineJob"]);q!=null&&j(t,["pipelineJob"],q);const R=C(n,["tunedModelDisplayName"]);return R!=null&&j(t,["tunedModelDisplayName"],R),t}function PU(e,n){const t={},r=C(n,["nextPageToken"]);r!=null&&j(t,["nextPageToken"],r);const a=C(n,["tuningJobs"]);if(a!=null){let s=a;Array.isArray(s)&&(s=s.map(l=>O1(e,l))),j(t,["tuningJobs"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class DU extends bg{constructor(n){super(),this.apiClient=n,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Kb(Fh.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const r=await this.tuneMldevInternal(t);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:T1.JOB_STATE_QUEUED}}}}async getInternal(n){var t,r,a,s;let l,f="",d={};if(this.apiClient.isVertexAI()){const u=bU(this.apiClient,n);return f=Ot("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>O1(this.apiClient,h))}else{const u=fU(this.apiClient,n);return f=Ot("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>V2(this.apiClient,h))}}async listInternal(n){var t,r,a,s;let l,f="",d={};if(this.apiClient.isVertexAI()){const u=wU(this.apiClient,n);return f=Ot("tuningJobs",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const g=PU(this.apiClient,h),b=new PC;return Object.assign(b,g),b})}else{const u=pU(this.apiClient,n);return f=Ot("tunedModels",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:f,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(s=n.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),l.then(h=>{const g=kU(this.apiClient,h),b=new PC;return Object.assign(b,g),b})}}async tuneInternal(n){var t,r;let a,s="",l={};if(this.apiClient.isVertexAI()){const f=jU(this.apiClient,n);return s=Ot("tuningJobs",f._url),l=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>O1(this.apiClient,d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(n){var t,r;let a,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=xU(this.apiClient,n);return s=Ot("tunedModels",f._url),l=f._query,delete f.config,delete f._url,delete f._query,a=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>EU(this.apiClient,d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class IU{async download(n,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const MU=1024*1024*8,RU=3,OU=1e3,LU=2,_v="x-goog-upload-status";async function FU(e,n,t){var r,a,s;let l=0,f=0,d=new A1(new Response),u="upload";for(l=e.size;f<l;){const g=Math.min(MU,l-f),b=e.slice(f,f+g);f+g>=l&&(u+=", finalize");let v=0,S=OU;for(;v<RU&&(d=await t.request({path:"",body:b,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:n,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(f),"Content-Length":String(g)}}}),!(!((r=d==null?void 0:d.headers)===null||r===void 0)&&r[_v]));)v++,await zU(S),S=S*LU;if(f+=g,((a=d==null?void 0:d.headers)===null||a===void 0?void 0:a[_v])!=="active")break;if(l<=f)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const h=await(d==null?void 0:d.json());if(((s=d==null?void 0:d.headers)===null||s===void 0?void 0:s[_v])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return h.file}async function $U(e){return{size:e.size,type:e.type}}function zU(e){return new Promise(n=>setTimeout(n,e))}class BU{async upload(n,t,r){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await FU(n,t,r)}async stat(n){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await $U(n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class UU{create(n,t,r){return new qU(n,t,r)}}class qU{constructor(n,t,r){this.url=n,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(n){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(n)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const GC="x-goog-api-key";class VU{constructor(n){this.apiKey=n}async addAuthHeaders(n){n.get(GC)===null&&n.append(GC,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const HU="gl-node/";class H2{constructor(n){var t;if(n.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(n.project||n.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=n.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=n.apiKey;const r=t5(n,void 0,void 0);r&&(n.httpOptions?n.httpOptions.baseUrl=r:n.httpOptions={baseUrl:r}),this.apiVersion=n.apiVersion;const a=new VU(this.apiKey);this.apiClient=new dU({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:n.httpOptions,userAgentExtra:HU+"web",uploader:new BU,downloader:new IU}),this.models=new H8(this.apiClient),this.live=new z8(this.apiClient,a,new UU),this.chats=new l$(this.models,this.apiClient),this.caches=new i$(this.apiClient),this.files=new w$(this.apiClient),this.operations=new nU(this.apiClient),this.tunings=new DU(this.apiClient)}}const vh=new Map,G2=(()=>{const e=new Promise(n=>{window.addEventListener("pointerdown",n,{once:!0}),window.addEventListener("keydown",n,{once:!0})});return async n=>{try{const t=new Audio;if(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",await t.play(),n!=null&&n.id&&vh.has(n.id)){const a=vh.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&vh.set(n.id,r),r}catch{if(await e,n!=null&&n.id&&vh.has(n.id)){const a=vh.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&vh.set(n.id,r),r}}})();function GU(e){var n=atob(e),t=new Uint8Array(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t.buffer}const YU=`
class AudioProcessingWorklet extends AudioWorkletProcessor {

  // send and clear buffer every 2048 samples, 
  // which at 16khz is about 8 times a second
  buffer = new Int16Array(2048);

  // current write index
  bufferWriteIndex = 0;

  constructor() {
    super();
    this.hasAudio = false;
  }

  /**
   * @param inputs Float32Array[][] [input#][channel#][sample#] so to access first inputs 1st channel inputs[0][0]
   * @param outputs Float32Array[][]
   */
  process(inputs) {
    if (inputs[0].length) {
      const channel0 = inputs[0][0];
      this.processChunk(channel0);
    }
    return true;
  }

  sendAndClearBuffer(){
    this.port.postMessage({
      event: "chunk",
      data: {
        int16arrayBuffer: this.buffer.slice(0, this.bufferWriteIndex).buffer,
      },
    });
    this.bufferWriteIndex = 0;
  }

  processChunk(float32Array) {
    const l = float32Array.length;
    
    for (let i = 0; i < l; i++) {
      // convert float32 -1 to 1 to int16 -32768 to 32767
      const int16Value = float32Array[i] * 32768;
      this.buffer[this.bufferWriteIndex++] = int16Value;
      if(this.bufferWriteIndex >= this.buffer.length) {
        this.sendAndClearBuffer();
      }
    }

    if(this.bufferWriteIndex >= this.buffer.length) {
      this.sendAndClearBuffer();
    }
  }
}
`,Y2=`
  class VolMeter extends AudioWorkletProcessor {
    volume
    updateIntervalInMS
    nextUpdateFrame

    constructor() {
      super()
      this.volume = 0
      this.updateIntervalInMS = 25
      this.nextUpdateFrame = this.updateIntervalInMS
      this.port.onmessage = event => {
        if (event.data.updateIntervalInMS) {
          this.updateIntervalInMS = event.data.updateIntervalInMS
        }
      }
    }

    get intervalInFrames() {
      return (this.updateIntervalInMS / 1000) * sampleRate
    }

    process(inputs) {
      const input = inputs[0]

      if (input.length > 0) {
        const samples = input[0]
        let sum = 0
        let rms = 0

        for (let i = 0; i < samples.length; ++i) {
          sum += samples[i] * samples[i]
        }

        rms = Math.sqrt(sum / samples.length)
        this.volume = Math.max(rms, this.volume * 0.7)

        this.nextUpdateFrame -= samples.length
        if (this.nextUpdateFrame < 0) {
          this.nextUpdateFrame += this.intervalInFrames
          this.port.postMessage({volume: this.volume})
        }
      }

      return true
    }
  }`,Ix=new Map,L1=(e,n)=>{const t=new Blob([`registerProcessor("${e}", ${n})`],{type:"application/javascript"});return URL.createObjectURL(t)};var kv={exports:{}},YC;function WU(){return YC||(YC=1,function(e){var n=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function a(d,u,h){this.fn=d,this.context=u,this.once=h||!1}function s(d,u,h,g,b){if(typeof h!="function")throw new TypeError("The listener must be a function");var v=new a(h,g||d,b),S=t?t+u:u;return d._events[S]?d._events[S].fn?d._events[S]=[d._events[S],v]:d._events[S].push(v):(d._events[S]=v,d._eventsCount++),d}function l(d,u){--d._eventsCount===0?d._events=new r:delete d._events[u]}function f(){this._events=new r,this._eventsCount=0}f.prototype.eventNames=function(){var u=[],h,g;if(this._eventsCount===0)return u;for(g in h=this._events)n.call(h,g)&&u.push(t?g.slice(1):g);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},f.prototype.listeners=function(u){var h=t?t+u:u,g=this._events[h];if(!g)return[];if(g.fn)return[g.fn];for(var b=0,v=g.length,S=new Array(v);b<v;b++)S[b]=g[b].fn;return S},f.prototype.listenerCount=function(u){var h=t?t+u:u,g=this._events[h];return g?g.fn?1:g.length:0},f.prototype.emit=function(u,h,g,b,v,S){var k=t?t+u:u;if(!this._events[k])return!1;var E=this._events[k],T=arguments.length,I,D;if(E.fn){switch(E.once&&this.removeListener(u,E.fn,void 0,!0),T){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,h),!0;case 3:return E.fn.call(E.context,h,g),!0;case 4:return E.fn.call(E.context,h,g,b),!0;case 5:return E.fn.call(E.context,h,g,b,v),!0;case 6:return E.fn.call(E.context,h,g,b,v,S),!0}for(D=1,I=new Array(T-1);D<T;D++)I[D-1]=arguments[D];E.fn.apply(E.context,I)}else{var q=E.length,R;for(D=0;D<q;D++)switch(E[D].once&&this.removeListener(u,E[D].fn,void 0,!0),T){case 1:E[D].fn.call(E[D].context);break;case 2:E[D].fn.call(E[D].context,h);break;case 3:E[D].fn.call(E[D].context,h,g);break;case 4:E[D].fn.call(E[D].context,h,g,b);break;default:if(!I)for(R=1,I=new Array(T-1);R<T;R++)I[R-1]=arguments[R];E[D].fn.apply(E[D].context,I)}}return!0},f.prototype.on=function(u,h,g){return s(this,u,h,g,!1)},f.prototype.once=function(u,h,g){return s(this,u,h,g,!0)},f.prototype.removeListener=function(u,h,g,b){var v=t?t+u:u;if(!this._events[v])return this;if(!h)return l(this,v),this;var S=this._events[v];if(S.fn)S.fn===h&&(!b||S.once)&&(!g||S.context===g)&&l(this,v);else{for(var k=0,E=[],T=S.length;k<T;k++)(S[k].fn!==h||b&&!S[k].once||g&&S[k].context!==g)&&E.push(S[k]);E.length?this._events[v]=E.length===1?E[0]:E:l(this,v)}return this},f.prototype.removeAllListeners=function(u){var h;return u?(h=t?t+u:u,this._events[h]&&l(this,h)):(this._events=new r,this._eventsCount=0),this},f.prototype.off=f.prototype.removeListener,f.prototype.addListener=f.prototype.on,f.prefixed=t,f.EventEmitter=f,e.exports=f}(kv)),kv.exports}var QU=WU();const W2=Bd(QU);function JU(e){for(var n="",t=new Uint8Array(e),r=t.byteLength,a=0;a<r;a++)n+=String.fromCharCode(t[a]);return window.btoa(n)}class Q2 extends W2{constructor(t=16e3){super();Yn(this,"stream");Yn(this,"audioContext");Yn(this,"source");Yn(this,"recording",!1);Yn(this,"recordingWorklet");Yn(this,"vuWorklet");Yn(this,"starting",null);this.sampleRate=t}async start(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Could not request user media");this.starting=new Promise(async t=>{this.stream=await navigator.mediaDevices.getUserMedia({audio:!0}),this.audioContext=await G2({sampleRate:this.sampleRate}),this.source=this.audioContext.createMediaStreamSource(this.stream);const r="audio-recorder-worklet",a=L1(r,YU);await this.audioContext.audioWorklet.addModule(a),this.recordingWorklet=new AudioWorkletNode(this.audioContext,r),this.recordingWorklet.port.onmessage=async l=>{const f=l.data.data.int16arrayBuffer;if(f){const d=JU(f);this.emit("data",d)}},this.source.connect(this.recordingWorklet);const s="vu-meter";await this.audioContext.audioWorklet.addModule(L1(s,Y2)),this.vuWorklet=new AudioWorkletNode(this.audioContext,s),this.vuWorklet.port.onmessage=l=>{this.emit("volume",l.data.volume)},this.source.connect(this.vuWorklet),this.recording=!0,t(),this.starting=null})}stop(){const t=()=>{var r,a;(r=this.source)==null||r.disconnect(),(a=this.stream)==null||a.getTracks().forEach(s=>s.stop()),this.stream=void 0,this.recordingWorklet=void 0,this.vuWorklet=void 0,this.audioContext&&(this.audioContext.close(),this.audioContext=void 0)};if(this.starting){this.starting.then(t);return}t()}}const KU=3,XU=({active:e,volume:n,hover:t})=>{const r=w.useRef([]);return w.useEffect(()=>{let a=null;const s=()=>{r.current.forEach((l,f)=>{l&&(l.style.height=`${Math.min(24,4+n*(f===1?400:60))}px`)}),a=window.setTimeout(s,100)};return s(),()=>clearTimeout(a)},[n]),i.jsx("div",{className:Hc("audioPulse",{active:e,hover:t}),children:Array(KU).fill(null).map((a,s)=>i.jsx("div",{ref:l=>{r.current[s]=l},style:{animationDelay:`${s*133}ms`}},s))})};var Qm={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var ZU=Qm.exports,WC;function e9(){return WC||(WC=1,function(e,n){(function(){var t,r="4.17.21",a=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",f="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",u=500,h="__lodash_placeholder__",g=1,b=2,v=4,S=1,k=2,E=1,T=2,I=4,D=8,q=16,R=32,F=64,U=128,z=256,V=512,L=30,$="...",H=800,ee=16,te=1,ae=2,Z=3,B=1/0,K=9007199254740991,oe=17976931348623157e292,A=NaN,se=4294967295,ue=se-1,M=se>>>1,pe=[["ary",U],["bind",E],["bindKey",T],["curry",D],["curryRight",q],["flip",V],["partial",R],["partialRight",F],["rearg",z]],be="[object Arguments]",fe="[object Array]",Pe="[object AsyncFunction]",de="[object Boolean]",Me="[object Date]",Ze="[object DOMException]",Fe="[object Error]",Ce="[object Function]",Re="[object GeneratorFunction]",xe="[object Map]",Ie="[object Number]",Ge="[object Null]",ze="[object Object]",nt="[object Promise]",jt="[object Proxy]",xt="[object RegExp]",ve="[object Set]",qe="[object String]",Qe="[object Symbol]",Be="[object Undefined]",J="[object WeakMap]",Y="[object WeakSet]",X="[object ArrayBuffer]",Ne="[object DataView]",ke="[object Float32Array]",Ue="[object Float64Array]",it="[object Int8Array]",mt="[object Int16Array]",ht="[object Int32Array]",Ve="[object Uint8Array]",tt="[object Uint8ClampedArray]",Le="[object Uint16Array]",ot="[object Uint32Array]",et=/\b__p \+= '';/g,bt=/\b(__p \+=) '' \+/g,Un=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ln=/&(?:amp|lt|gt|quot|#39);/g,jn=/[&<>"']/g,gn=RegExp(Ln.source),dn=RegExp(jn.source),Nr=/<%-([\s\S]+?)%>/g,Ur=/<%([\s\S]+?)%>/g,ri=/<%=([\s\S]+?)%>/g,fa=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ti=/^\w*$/,nr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Xn=/[\\^$.*+?()[\]{}|]/g,Fn=RegExp(Xn.source),za=/^\s+/,ds=/\s/,ep=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,tp=/\{\n\/\* \[wrapped with (.+)\] \*/,Vd=/,? & /,fs=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,nu=/[()=,{}\[\]\/\s]/,Ys=/\\(\\)?/g,Ws=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ba=/\w*$/,Qs=/^[-+]0x[0-9a-f]+$/i,cr=/^0b[01]+$/i,Hd=/^\[object .+?Constructor\]$/,Bl=/^0o[0-7]+$/i,hs=/^(?:0|[1-9]\d*)$/,Ua=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,qr=/($^)/,Js=/['\n\r\u2028\u2029\\]/g,qa="\\ud800-\\udfff",Gd="\\u0300-\\u036f",Ho="\\ufe20-\\ufe2f",Go="\\u20d0-\\u20ff",ii=Gd+Ho+Go,Yo="\\u2700-\\u27bf",Ul="a-z\\xdf-\\xf6\\xf8-\\xff",ha="\\xac\\xb1\\xd7\\xf7",ru="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",iu="\\u2000-\\u206f",Yd=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",au="A-Z\\xc0-\\xd6\\xd8-\\xde",Rr="\\ufe0e\\ufe0f",Wo=ha+ru+iu+Yd,ql="[']",Qo="["+qa+"]",Vl="["+Wo+"]",Va="["+ii+"]",su="\\d+",Vr="["+Yo+"]",Jo="["+Ul+"]",Hl="[^"+qa+Wo+su+Yo+Ul+au+"]",Ks="\\ud83c[\\udffb-\\udfff]",pa="(?:"+Va+"|"+Ks+")",Xs="[^"+qa+"]",ps="(?:\\ud83c[\\udde6-\\uddff]){2}",ma="[\\ud800-\\udbff][\\udc00-\\udfff]",ga="["+au+"]",Ko="\\u200d",Xo="(?:"+Jo+"|"+Hl+")",Zo="(?:"+ga+"|"+Hl+")",Gl="(?:"+ql+"(?:d|ll|m|re|s|t|ve))?",Yl="(?:"+ql+"(?:D|LL|M|RE|S|T|VE))?",ms=pa+"?",Zs="["+Rr+"]?",el="(?:"+Ko+"(?:"+[Xs,ps,ma].join("|")+")"+Zs+ms+")*",Hr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ha="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Wl=Zs+ms+el,ya="(?:"+[Vr,ps,ma].join("|")+")"+Wl,eo="(?:"+[Xs+Va+"?",Va,ps,ma,Qo].join("|")+")",tl=RegExp(ql,"g"),ai=RegExp(Va,"g"),to=RegExp(Ks+"(?="+Ks+")|"+eo+Wl,"g"),gs=RegExp([ga+"?"+Jo+"+"+Gl+"(?="+[Vl,ga,"$"].join("|")+")",Zo+"+"+Yl+"(?="+[Vl,ga+Xo,"$"].join("|")+")",ga+"?"+Xo+"+"+Gl,ga+"+"+Yl,Ha,Hr,su,ya].join("|"),"g"),zi=RegExp("["+Ko+qa+ii+Rr+"]"),Ql=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ys=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Wd=-1,yn={};yn[ke]=yn[Ue]=yn[it]=yn[mt]=yn[ht]=yn[Ve]=yn[tt]=yn[Le]=yn[ot]=!0,yn[be]=yn[fe]=yn[X]=yn[de]=yn[Ne]=yn[Me]=yn[Fe]=yn[Ce]=yn[xe]=yn[Ie]=yn[ze]=yn[xt]=yn[ve]=yn[qe]=yn[J]=!1;var ln={};ln[be]=ln[fe]=ln[X]=ln[Ne]=ln[de]=ln[Me]=ln[ke]=ln[Ue]=ln[it]=ln[mt]=ln[ht]=ln[xe]=ln[Ie]=ln[ze]=ln[xt]=ln[ve]=ln[qe]=ln[Qe]=ln[Ve]=ln[tt]=ln[Le]=ln[ot]=!0,ln[Fe]=ln[Ce]=ln[J]=!1;var ou={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Pr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Xt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},no={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ga=parseFloat,lu=parseInt,Ya=typeof Vc=="object"&&Vc&&Vc.Object===Object&&Vc,xs=typeof self=="object"&&self&&self.Object===Object&&self,Zn=Ya||xs||Function("return this")(),bs=n&&!n.nodeType&&n,si=bs&&!0&&e&&!e.nodeType&&e,cu=si&&si.exports===bs,nl=cu&&Ya.process,Dr=function(){try{var Q=si&&si.require&&si.require("util").types;return Q||nl&&nl.binding&&nl.binding("util")}catch{}}(),Wa=Dr&&Dr.isArrayBuffer,uu=Dr&&Dr.isDate,Jl=Dr&&Dr.isMap,vs=Dr&&Dr.isRegExp,Qd=Dr&&Dr.isSet,du=Dr&&Dr.isTypedArray;function ur(Q,ie,ce){switch(ce.length){case 0:return Q.call(ie);case 1:return Q.call(ie,ce[0]);case 2:return Q.call(ie,ce[0],ce[1]);case 3:return Q.call(ie,ce[0],ce[1],ce[2])}return Q.apply(ie,ce)}function Kl(Q,ie,ce,Ee){for(var We=-1,lt=Q==null?0:Q.length;++We<lt;){var ct=Q[We];ie(Ee,ct,ce(ct),Q)}return Ee}function Or(Q,ie){for(var ce=-1,Ee=Q==null?0:Q.length;++ce<Ee&&ie(Q[ce],ce,Q)!==!1;);return Q}function np(Q,ie){for(var ce=Q==null?0:Q.length;ce--&&ie(Q[ce],ce,Q)!==!1;);return Q}function rl(Q,ie){for(var ce=-1,Ee=Q==null?0:Q.length;++ce<Ee;)if(!ie(Q[ce],ce,Q))return!1;return!0}function Bi(Q,ie){for(var ce=-1,Ee=Q==null?0:Q.length,We=0,lt=[];++ce<Ee;){var ct=Q[ce];ie(ct,ce,Q)&&(lt[We++]=ct)}return lt}function Xl(Q,ie){var ce=Q==null?0:Q.length;return!!ce&&ro(Q,ie,0)>-1}function fu(Q,ie,ce){for(var Ee=-1,We=Q==null?0:Q.length;++Ee<We;)if(ce(ie,Q[Ee]))return!0;return!1}function Mn(Q,ie){for(var ce=-1,Ee=Q==null?0:Q.length,We=Array(Ee);++ce<Ee;)We[ce]=ie(Q[ce],ce,Q);return We}function xa(Q,ie){for(var ce=-1,Ee=ie.length,We=Q.length;++ce<Ee;)Q[We+ce]=ie[ce];return Q}function hu(Q,ie,ce,Ee){var We=-1,lt=Q==null?0:Q.length;for(Ee&&lt&&(ce=Q[++We]);++We<lt;)ce=ie(ce,Q[We],We,Q);return ce}function rp(Q,ie,ce,Ee){var We=Q==null?0:Q.length;for(Ee&&We&&(ce=Q[--We]);We--;)ce=ie(ce,Q[We],We,Q);return ce}function pu(Q,ie){for(var ce=-1,Ee=Q==null?0:Q.length;++ce<Ee;)if(ie(Q[ce],ce,Q))return!0;return!1}var ip=il("length");function ap(Q){return Q.split("")}function sp(Q){return Q.match(fs)||[]}function Jd(Q,ie,ce){var Ee;return ce(Q,function(We,lt,ct){if(ie(We,lt,ct))return Ee=lt,!1}),Ee}function ws(Q,ie,ce,Ee){for(var We=Q.length,lt=ce+(Ee?1:-1);Ee?lt--:++lt<We;)if(ie(Q[lt],lt,Q))return lt;return-1}function ro(Q,ie,ce){return ie===ie?cp(Q,ie,ce):ws(Q,Gr,ce)}function Ui(Q,ie,ce,Ee){for(var We=ce-1,lt=Q.length;++We<lt;)if(Ee(Q[We],ie))return We;return-1}function Gr(Q){return Q!==Q}function qi(Q,ie){var ce=Q==null?0:Q.length;return ce?io(Q,ie)/ce:A}function il(Q){return function(ie){return ie==null?t:ie[Q]}}function al(Q){return function(ie){return Q==null?t:Q[ie]}}function Zl(Q,ie,ce,Ee,We){return We(Q,function(lt,ct,At){ce=Ee?(Ee=!1,lt):ie(ce,lt,ct,At)}),ce}function mu(Q,ie){var ce=Q.length;for(Q.sort(ie);ce--;)Q[ce]=Q[ce].value;return Q}function io(Q,ie){for(var ce,Ee=-1,We=Q.length;++Ee<We;){var lt=ie(Q[Ee]);lt!==t&&(ce=ce===t?lt:ce+lt)}return ce}function ba(Q,ie){for(var ce=-1,Ee=Array(Q);++ce<Q;)Ee[ce]=ie(ce);return Ee}function Kd(Q,ie){return Mn(ie,function(ce){return[ce,Q[ce]]})}function Xd(Q){return Q&&Q.slice(0,gu(Q)+1).replace(za,"")}function Lr(Q){return function(ie){return Q(ie)}}function ec(Q,ie){return Mn(ie,function(ce){return Q[ce]})}function ao(Q,ie){return Q.has(ie)}function so(Q,ie){for(var ce=-1,Ee=Q.length;++ce<Ee&&ro(ie,Q[ce],0)>-1;);return ce}function oo(Q,ie){for(var ce=Q.length;ce--&&ro(ie,Q[ce],0)>-1;);return ce}function op(Q,ie){for(var ce=Q.length,Ee=0;ce--;)Q[ce]===ie&&++Ee;return Ee}var tc=al(ou),Ss=al(Pr);function Zd(Q){return"\\"+no[Q]}function sl(Q,ie){return Q==null?t:Q[ie]}function Qa(Q){return zi.test(Q)}function ef(Q){return Ql.test(Q)}function tf(Q){for(var ie,ce=[];!(ie=Q.next()).done;)ce.push(ie.value);return ce}function oi(Q){var ie=-1,ce=Array(Q.size);return Q.forEach(function(Ee,We){ce[++ie]=[We,Ee]}),ce}function nf(Q,ie){return function(ce){return Q(ie(ce))}}function va(Q,ie){for(var ce=-1,Ee=Q.length,We=0,lt=[];++ce<Ee;){var ct=Q[ce];(ct===ie||ct===h)&&(Q[ce]=h,lt[We++]=ce)}return lt}function nc(Q){var ie=-1,ce=Array(Q.size);return Q.forEach(function(Ee){ce[++ie]=Ee}),ce}function lp(Q){var ie=-1,ce=Array(Q.size);return Q.forEach(function(Ee){ce[++ie]=[Ee,Ee]}),ce}function cp(Q,ie,ce){for(var Ee=ce-1,We=Q.length;++Ee<We;)if(Q[Ee]===ie)return Ee;return-1}function Yr(Q,ie,ce){for(var Ee=ce+1;Ee--;)if(Q[Ee]===ie)return Ee;return Ee}function Vi(Q){return Qa(Q)?af(Q):ip(Q)}function li(Q){return Qa(Q)?rc(Q):ap(Q)}function gu(Q){for(var ie=Q.length;ie--&&ds.test(Q.charAt(ie)););return ie}var rf=al(Xt);function af(Q){for(var ie=to.lastIndex=0;to.test(Q);)++ie;return ie}function rc(Q){return Q.match(to)||[]}function sf(Q){return Q.match(gs)||[]}var Ns=function Q(ie){ie=ie==null?Zn:he.defaults(Zn.Object(),ie,he.pick(Zn,ys));var ce=ie.Array,Ee=ie.Date,We=ie.Error,lt=ie.Function,ct=ie.Math,At=ie.Object,ci=ie.RegExp,of=ie.String,Ai=ie.TypeError,lf=ce.prototype,h0=lt.prototype,ic=At.prototype,yu=ie["__core-js_shared__"],xu=h0.toString,hn=ic.hasOwnProperty,wa=0,up=function(){var m=/[^.]+$/.exec(yu&&yu.keys&&yu.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),Wr=ic.toString,Hi=xu.call(At),ac=Zn._,dp=ci("^"+xu.call(hn).replace(Xn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ol=cu?ie.Buffer:t,Sa=ie.Symbol,sc=ie.Uint8Array,ll=ol?ol.allocUnsafe:t,bu=nf(At.getPrototypeOf,At),vu=At.create,cl=ic.propertyIsEnumerable,cf=lf.splice,ui=Sa?Sa.isConcatSpreadable:t,ul=Sa?Sa.iterator:t,Qr=Sa?Sa.toStringTag:t,wu=function(){try{var m=yo(At,"defineProperty");return m({},"",{}),m}catch{}}(),uf=ie.clearTimeout!==Zn.clearTimeout&&ie.clearTimeout,dl=Ee&&Ee.now!==Zn.Date.now&&Ee.now,fp=ie.setTimeout!==Zn.setTimeout&&ie.setTimeout,oc=ct.ceil,Cs=ct.floor,lo=At.getOwnPropertySymbols,df=ol?ol.isBuffer:t,Su=ie.isFinite,Gi=lf.join,Yi=nf(At.keys,At),$n=ct.max,qn=ct.min,js=Ee.now,fl=ie.parseInt,hp=ct.random,pp=lf.reverse,Nu=yo(ie,"DataView"),mr=yo(ie,"Map"),Vn=yo(ie,"Promise"),Zt=yo(ie,"Set"),Na=yo(ie,"WeakMap"),di=yo(At,"create"),lc=Na&&new Na,Wi={},Eg=Ms(Nu),Tg=Ms(mr),Cu=Ms(Vn),ju=Ms(Zt),Ag=Ms(Na),co=Sa?Sa.prototype:t,hl=co?co.valueOf:t,uo=co?co.toString:t;function ne(m){if(er(m)&&!Mt(m)&&!(m instanceof Yt)){if(m instanceof fi)return m;if(hn.call(m,"__wrapped__"))return yr(m)}return new fi(m)}var Pi=function(){function m(){}return function(y){if(!Gn(y))return{};if(vu)return vu(y);m.prototype=y;var _=new m;return m.prototype=t,_}}();function Qi(){}function fi(m,y){this.__wrapped__=m,this.__actions__=[],this.__chain__=!!y,this.__index__=0,this.__values__=t}ne.templateSettings={escape:Nr,evaluate:Ur,interpolate:ri,variable:"",imports:{_:ne}},ne.prototype=Qi.prototype,ne.prototype.constructor=ne,fi.prototype=Pi(Qi.prototype),fi.prototype.constructor=fi;function Yt(m){this.__wrapped__=m,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=se,this.__views__=[]}function _u(){var m=new Yt(this.__wrapped__);return m.__actions__=gr(this.__actions__),m.__dir__=this.__dir__,m.__filtered__=this.__filtered__,m.__iteratees__=gr(this.__iteratees__),m.__takeCount__=this.__takeCount__,m.__views__=gr(this.__views__),m}function ff(){if(this.__filtered__){var m=new Yt(this);m.__dir__=-1,m.__filtered__=!0}else m=this.clone(),m.__dir__*=-1;return m}function pl(){var m=this.__wrapped__.value(),y=this.__dir__,_=Mt(m),O=y<0,W=_?m.length:0,le=cy(0,W,this.__views__),me=le.start,we=le.end,_e=we-me,Je=O?we:me-1,Xe=this.__iteratees__,rt=Xe.length,ft=0,gt=qn(_e,this.__takeCount__);if(!_||!O&&W==_e&&gt==_e)return Qg(m,this.__actions__);var Pt=[];e:for(;_e--&&ft<gt;){Je+=y;for(var Qt=-1,Dt=m[Je];++Qt<rt;){var nn=Xe[Qt],un=nn.iteratee,Aa=nn.type,Fi=un(Dt);if(Aa==ae)Dt=Fi;else if(!Fi){if(Aa==te)continue e;break e}}Pt[ft++]=Dt}return Pt}Yt.prototype=Pi(Qi.prototype),Yt.prototype.constructor=Yt;function rr(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var O=m[y];this.set(O[0],O[1])}}function hf(){this.__data__=di?di(null):{},this.size=0}function Pg(m){var y=this.has(m)&&delete this.__data__[m];return this.size-=y?1:0,y}function p0(m){var y=this.__data__;if(di){var _=y[m];return _===d?t:_}return hn.call(y,m)?y[m]:t}function m0(m){var y=this.__data__;return di?y[m]!==t:hn.call(y,m)}function g0(m,y){var _=this.__data__;return this.size+=this.has(m)?0:1,_[m]=di&&y===t?d:y,this}rr.prototype.clear=hf,rr.prototype.delete=Pg,rr.prototype.get=p0,rr.prototype.has=m0,rr.prototype.set=g0;function An(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var O=m[y];this.set(O[0],O[1])}}function mp(){this.__data__=[],this.size=0}function ku(m){var y=this.__data__,_=dc(y,m);if(_<0)return!1;var O=y.length-1;return _==O?y.pop():cf.call(y,_,1),--this.size,!0}function Eu(m){var y=this.__data__,_=dc(y,m);return _<0?t:y[_][1]}function gp(m){return dc(this.__data__,m)>-1}function cc(m,y){var _=this.__data__,O=dc(_,m);return O<0?(++this.size,_.push([m,y])):_[O][1]=y,this}An.prototype.clear=mp,An.prototype.delete=ku,An.prototype.get=Eu,An.prototype.has=gp,An.prototype.set=cc;function hi(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var O=m[y];this.set(O[0],O[1])}}function y0(){this.size=0,this.__data__={hash:new rr,map:new(mr||An),string:new rr}}function Dg(m){var y=yc(this,m).delete(m);return this.size-=y?1:0,y}function x0(m){return yc(this,m).get(m)}function Ig(m){return yc(this,m).has(m)}function ml(m,y){var _=yc(this,m),O=_.size;return _.set(m,y),this.size+=_.size==O?0:1,this}hi.prototype.clear=y0,hi.prototype.delete=Dg,hi.prototype.get=x0,hi.prototype.has=Ig,hi.prototype.set=ml;function _s(m){var y=-1,_=m==null?0:m.length;for(this.__data__=new hi;++y<_;)this.add(m[y])}function pf(m){return this.__data__.set(m,d),this}function Mg(m){return this.__data__.has(m)}_s.prototype.add=_s.prototype.push=pf,_s.prototype.has=Mg;function Jr(m){var y=this.__data__=new An(m);this.size=y.size}function Rg(){this.__data__=new An,this.size=0}function mf(m){var y=this.__data__,_=y.delete(m);return this.size=y.size,_}function yp(m){return this.__data__.get(m)}function Og(m){return this.__data__.has(m)}function gf(m,y){var _=this.__data__;if(_ instanceof An){var O=_.__data__;if(!mr||O.length<a-1)return O.push([m,y]),this.size=++_.size,this;_=this.__data__=new hi(O)}return _.set(m,y),this.size=_.size,this}Jr.prototype.clear=Rg,Jr.prototype.delete=mf,Jr.prototype.get=yp,Jr.prototype.has=Og,Jr.prototype.set=gf;function xp(m,y){var _=Mt(m),O=!_&&Fs(m),W=!_&&!O&&ko(m),le=!_&&!O&&!W&&Pc(m),me=_||O||W||le,we=me?ba(m.length,of):[],_e=we.length;for(var Je in m)(y||hn.call(m,Je))&&!(me&&(Je=="length"||W&&(Je=="offset"||Je=="parent")||le&&(Je=="buffer"||Je=="byteLength"||Je=="byteOffset")||ka(Je,_e)))&&we.push(Je);return we}function uc(m){var y=m.length;return y?m[_f(0,y-1)]:t}function Lg(m,y){return td(gr(m),ja(y,0,m.length))}function Fg(m){return td(gr(m))}function Ja(m,y,_){(_!==t&&!vi(m[y],_)||_===t&&!(y in m))&&Ca(m,y,_)}function gl(m,y,_){var O=m[y];(!(hn.call(m,y)&&vi(O,_))||_===t&&!(y in m))&&Ca(m,y,_)}function dc(m,y){for(var _=m.length;_--;)if(vi(m[_][0],y))return _;return-1}function fo(m,y,_,O){return Es(m,function(W,le,me){y(O,W,_(W),me)}),O}function ks(m,y){return m&&gi(y,vr(y),m)}function Tu(m,y){return m&&gi(y,_r(y),m)}function Ca(m,y,_){y=="__proto__"&&wu?wu(m,y,{configurable:!0,enumerable:!0,value:_,writable:!0}):m[y]=_}function Au(m,y){for(var _=-1,O=y.length,W=ce(O),le=m==null;++_<O;)W[_]=le?t:md(m,y[_]);return W}function ja(m,y,_){return m===m&&(_!==t&&(m=m<=_?m:_),y!==t&&(m=m>=y?m:y)),m}function Fr(m,y,_,O,W,le){var me,we=y&g,_e=y&b,Je=y&v;if(_&&(me=W?_(m,O,W,le):_(m)),me!==t)return me;if(!Gn(m))return m;var Xe=Mt(m);if(Xe){if(me=Vp(m),!we)return gr(m,me)}else{var rt=jr(m),ft=rt==Ce||rt==Re;if(ko(m))return Op(m,we);if(rt==ze||rt==be||ft&&!W){if(me=_e||ft?{}:Hp(m),!we)return _e?qu(m,Tu(me,m)):Df(m,ks(me,m))}else{if(!ln[rt])return W?m:{};me=Gp(m,rt,we)}}le||(le=new Jr);var gt=le.get(m);if(gt)return gt;le.set(m,me),tx(m)?m.forEach(function(Dt){me.add(Fr(Dt,y,_,Dt,m,le))}):rh(m)&&m.forEach(function(Dt,nn){me.set(nn,Fr(Dt,y,_,nn,m,le))});var Pt=Je?_e?Of:Rf:_e?_r:vr,Qt=Xe?t:Pt(m);return Or(Qt||m,function(Dt,nn){Qt&&(nn=Dt,Dt=m[nn]),gl(me,nn,Fr(Dt,y,_,nn,m,le))}),me}function $g(m){var y=vr(m);return function(_){return bp(_,m,y)}}function bp(m,y,_){var O=_.length;if(m==null)return!O;for(m=At(m);O--;){var W=_[O],le=y[W],me=m[W];if(me===t&&!(W in m)||!le(me))return!1}return!0}function yl(m,y,_){if(typeof m!="function")throw new Ai(l);return bc(function(){m.apply(t,_)},y)}function ho(m,y,_,O){var W=-1,le=Xl,me=!0,we=m.length,_e=[],Je=y.length;if(!we)return _e;_&&(y=Mn(y,Lr(_))),O?(le=fu,me=!1):y.length>=a&&(le=ao,me=!1,y=new _s(y));e:for(;++W<we;){var Xe=m[W],rt=_==null?Xe:_(Xe);if(Xe=O||Xe!==0?Xe:0,me&&rt===rt){for(var ft=Je;ft--;)if(y[ft]===rt)continue e;_e.push(Xe)}else le(y,rt,O)||_e.push(Xe)}return _e}var Es=zp($r),yf=zp(hc,!0);function vp(m,y){var _=!0;return Es(m,function(O,W,le){return _=!!y(O,W,le),_}),_}function _a(m,y,_){for(var O=-1,W=m.length;++O<W;){var le=m[O],me=y(le);if(me!=null&&(we===t?me===me&&!Zr(me):_(me,we)))var we=me,_e=le}return _e}function qt(m,y,_,O){var W=m.length;for(_=Ft(_),_<0&&(_=-_>W?0:W+_),O=O===t||O>W?W:Ft(O),O<0&&(O+=W),O=_>O?0:as(O);_<O;)m[_++]=y;return m}function bn(m,y){var _=[];return Es(m,function(O,W,le){y(O,W,le)&&_.push(O)}),_}function en(m,y,_,O,W){var le=-1,me=m.length;for(_||(_=Ds),W||(W=[]);++le<me;){var we=m[le];y>0&&_(we)?y>1?en(we,y-1,_,O,W):xa(W,we):O||(W[W.length]=we)}return W}var fc=Cl(),xl=Cl(!0);function $r(m,y){return m&&fc(m,y,vr)}function hc(m,y){return m&&xl(m,y,vr)}function po(m,y){return Bi(y,function(_){return Ea(m[_])})}function Ji(m,y){y=As(y,m);for(var _=0,O=y.length;m!=null&&_<O;)m=m[xn(y[_++])];return _&&_==O?m:t}function zg(m,y,_){var O=y(m);return Mt(m)?O:xa(O,_(m))}function tn(m){return m==null?m===t?Be:Ge:Qr&&Qr in At(m)?ly(m):py(m)}function Pu(m,y){return m>y}function wp(m,y){return m!=null&&hn.call(m,y)}function Bg(m,y){return m!=null&&y in At(m)}function Ug(m,y,_){return m>=qn(y,_)&&m<$n(y,_)}function Sp(m,y,_){for(var O=_?fu:Xl,W=m[0].length,le=m.length,me=le,we=ce(le),_e=1/0,Je=[];me--;){var Xe=m[me];me&&y&&(Xe=Mn(Xe,Lr(y))),_e=qn(Xe.length,_e),we[me]=!_&&(y||W>=120&&Xe.length>=120)?new _s(me&&Xe):t}Xe=m[0];var rt=-1,ft=we[0];e:for(;++rt<W&&Je.length<_e;){var gt=Xe[rt],Pt=y?y(gt):gt;if(gt=_||gt!==0?gt:0,!(ft?ao(ft,Pt):O(Je,Pt,_))){for(me=le;--me;){var Qt=we[me];if(!(Qt?ao(Qt,Pt):O(m[me],Pt,_)))continue e}ft&&ft.push(Pt),Je.push(gt)}}return Je}function Np(m,y,_,O){return $r(m,function(W,le,me){y(O,_(W),le,me)}),O}function bl(m,y,_){y=As(y,m),m=xc(m,y);var O=m==null?m:m[xn(zr(y))];return O==null?t:ur(O,m,_)}function xf(m){return er(m)&&tn(m)==be}function pi(m){return er(m)&&tn(m)==X}function dr(m){return er(m)&&tn(m)==Me}function vl(m,y,_,O,W){return m===y?!0:m==null||y==null||!er(m)&&!er(y)?m!==m&&y!==y:Du(m,y,_,O,vl,W)}function Du(m,y,_,O,W,le){var me=Mt(m),we=Mt(y),_e=me?fe:jr(m),Je=we?fe:jr(y);_e=_e==be?ze:_e,Je=Je==be?ze:Je;var Xe=_e==ze,rt=Je==ze,ft=_e==Je;if(ft&&ko(m)){if(!ko(y))return!1;me=!0,Xe=!1}if(ft&&!Xe)return le||(le=new Jr),me||Pc(m)?sy(m,y,_,O,W,le):oy(m,y,_e,_,O,W,le);if(!(_&S)){var gt=Xe&&hn.call(m,"__wrapped__"),Pt=rt&&hn.call(y,"__wrapped__");if(gt||Pt){var Qt=gt?m.value():m,Dt=Pt?y.value():y;return le||(le=new Jr),W(Qt,Dt,_,O,le)}}return ft?(le||(le=new Jr),Cr(m,y,_,O,W,le)):!1}function bf(m){return er(m)&&jr(m)==xe}function Iu(m,y,_,O){var W=_.length,le=W,me=!O;if(m==null)return!le;for(m=At(m);W--;){var we=_[W];if(me&&we[2]?we[1]!==m[we[0]]:!(we[0]in m))return!1}for(;++W<le;){we=_[W];var _e=we[0],Je=m[_e],Xe=we[1];if(me&&we[2]){if(Je===t&&!(_e in m))return!1}else{var rt=new Jr;if(O)var ft=O(Je,Xe,_e,m,y,rt);if(!(ft===t?vl(Xe,Je,S|k,O,rt):ft))return!1}}return!0}function Ka(m){if(!Gn(m)||Uf(m))return!1;var y=Ea(m)?dp:Hd;return y.test(Ms(m))}function vf(m){return er(m)&&tn(m)==xt}function Cp(m){return er(m)&&jr(m)==ve}function jp(m){return er(m)&&Tl(m.length)&&!!yn[tn(m)]}function _p(m){return typeof m=="function"?m:m==null?De:typeof m=="object"?Mt(m)?Nf(m[0],m[1]):Ep(m):cn(m)}function wf(m){if(!Pn(m))return Yi(m);var y=[];for(var _ in At(m))hn.call(m,_)&&_!="constructor"&&y.push(_);return y}function qg(m){if(!Gn(m))return xo(m);var y=Pn(m),_=[];for(var O in m)O=="constructor"&&(y||!hn.call(m,O))||_.push(O);return _}function Sf(m,y){return m<y}function kp(m,y){var _=-1,O=xr(m)?ce(m.length):[];return Es(m,function(W,le,me){O[++_]=y(W,le,me)}),O}function Ep(m){var y=Ff(m);return y.length==1&&y[0][2]?fy(y[0][0],y[0][1]):function(_){return _===m||Iu(_,m,y)}}function Nf(m,y){return zf(m)&&dy(y)?fy(xn(m),y):function(_){var O=md(_,m);return O===t&&O===y?Rc(_,m):vl(y,O,S|k)}}function Mu(m,y,_,O,W){m!==y&&fc(y,function(le,me){if(W||(W=new Jr),Gn(le))b0(m,y,me,_,Mu,O,W);else{var we=O?O(qf(m,me),le,me+"",m,y,W):t;we===t&&(we=le),Ja(m,me,we)}},_r)}function b0(m,y,_,O,W,le,me){var we=qf(m,_),_e=qf(y,_),Je=me.get(_e);if(Je){Ja(m,_,Je);return}var Xe=le?le(we,_e,_+"",m,y,me):t,rt=Xe===t;if(rt){var ft=Mt(_e),gt=!ft&&ko(_e),Pt=!ft&&!gt&&Pc(_e);Xe=_e,ft||gt||Pt?Mt(we)?Xe=we:sr(we)?Xe=gr(we):gt?(rt=!1,Xe=Op(_e,!0)):Pt?(rt=!1,Xe=Fp(_e,!0)):Xe=[]:ea(_e)||Fs(_e)?(Xe=we,Fs(we)?Xe=ix(we):(!Gn(we)||Ea(we))&&(Xe=Hp(_e))):rt=!1}rt&&(me.set(_e,Xe),W(Xe,_e,O,le,me),me.delete(_e)),Ja(m,_,Xe)}function Tp(m,y){var _=m.length;if(_)return y+=y<0?_:0,ka(y,_)?m[y]:t}function Ap(m,y,_){y.length?y=Mn(y,function(le){return Mt(le)?function(me){return Ji(me,le.length===1?le[0]:le)}:le}):y=[De];var O=-1;y=Mn(y,Lr(vt()));var W=kp(m,function(le,me,we){var _e=Mn(y,function(Je){return Je(le)});return{criteria:_e,index:++O,value:le}});return mu(W,function(le,me){return Zg(le,me,_)})}function Vg(m,y){return Cf(m,y,function(_,O){return Rc(m,O)})}function Cf(m,y,_){for(var O=-1,W=y.length,le={};++O<W;){var me=y[O],we=Ji(m,me);_(we,me)&&mc(le,As(me,m),we)}return le}function Hg(m){return function(y){return Ji(y,m)}}function jf(m,y,_,O){var W=O?Ui:ro,le=-1,me=y.length,we=m;for(m===y&&(y=gr(y)),_&&(we=Mn(m,Lr(_)));++le<me;)for(var _e=0,Je=y[le],Xe=_?_(Je):Je;(_e=W(we,Xe,_e,O))>-1;)we!==m&&cf.call(we,_e,1),cf.call(m,_e,1);return m}function Pp(m,y){for(var _=m?y.length:0,O=_-1;_--;){var W=y[_];if(_==O||W!==le){var le=W;ka(W)?cf.call(m,W,1):Fu(m,W)}}return m}function _f(m,y){return m+Cs(hp()*(y-m+1))}function Gg(m,y,_,O){for(var W=-1,le=$n(oc((y-m)/(_||1)),0),me=ce(le);le--;)me[O?le:++W]=m,m+=_;return me}function Dp(m,y){var _="";if(!m||y<1||y>K)return _;do y%2&&(_+=m),y=Cs(y/2),y&&(m+=m);while(y);return _}function $t(m,y){return Zu(Yp(m,y,De),m+"")}function pc(m){return uc(Lc(m))}function kf(m,y){var _=Lc(m);return td(_,ja(y,0,_.length))}function mc(m,y,_,O){if(!Gn(m))return m;y=As(y,m);for(var W=-1,le=y.length,me=le-1,we=m;we!=null&&++W<le;){var _e=xn(y[W]),Je=_;if(_e==="__proto__"||_e==="constructor"||_e==="prototype")return m;if(W!=me){var Xe=we[_e];Je=O?O(Xe,_e,we):t,Je===t&&(Je=Gn(Xe)?Xe:ka(y[W+1])?[]:{})}gl(we,_e,Je),we=we[_e]}return m}var Ru=lc?function(m,y){return lc.set(m,y),m}:De,Ou=wu?function(m,y){return wu(m,"toString",{configurable:!0,enumerable:!1,value:Ae(y),writable:!0})}:De;function Yg(m){return td(Lc(m))}function Di(m,y,_){var O=-1,W=m.length;y<0&&(y=-y>W?0:W+y),_=_>W?W:_,_<0&&(_+=W),W=y>_?0:_-y>>>0,y>>>=0;for(var le=ce(W);++O<W;)le[O]=m[O+y];return le}function Wg(m,y){var _;return Es(m,function(O,W,le){return _=y(O,W,le),!_}),!!_}function Lu(m,y,_){var O=0,W=m==null?O:m.length;if(typeof y=="number"&&y===y&&W<=M){for(;O<W;){var le=O+W>>>1,me=m[le];me!==null&&!Zr(me)&&(_?me<=y:me<y)?O=le+1:W=le}return W}return Ef(m,y,De,_)}function Ef(m,y,_,O){var W=0,le=m==null?0:m.length;if(le===0)return 0;y=_(y);for(var me=y!==y,we=y===null,_e=Zr(y),Je=y===t;W<le;){var Xe=Cs((W+le)/2),rt=_(m[Xe]),ft=rt!==t,gt=rt===null,Pt=rt===rt,Qt=Zr(rt);if(me)var Dt=O||Pt;else Je?Dt=Pt&&(O||ft):we?Dt=Pt&&ft&&(O||!gt):_e?Dt=Pt&&ft&&!gt&&(O||!Qt):gt||Qt?Dt=!1:Dt=O?rt<=y:rt<y;Dt?W=Xe+1:le=Xe}return qn(le,ue)}function Ip(m,y){for(var _=-1,O=m.length,W=0,le=[];++_<O;){var me=m[_],we=y?y(me):me;if(!_||!vi(we,_e)){var _e=we;le[W++]=me===0?0:me}}return le}function Tf(m){return typeof m=="number"?m:Zr(m)?A:+m}function mi(m){if(typeof m=="string")return m;if(Mt(m))return Mn(m,mi)+"";if(Zr(m))return uo?uo.call(m):"";var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function Ts(m,y,_){var O=-1,W=Xl,le=m.length,me=!0,we=[],_e=we;if(_)me=!1,W=fu;else if(le>=a){var Je=y?null:iy(m);if(Je)return nc(Je);me=!1,W=ao,_e=new _s}else _e=y?[]:we;e:for(;++O<le;){var Xe=m[O],rt=y?y(Xe):Xe;if(Xe=_||Xe!==0?Xe:0,me&&rt===rt){for(var ft=_e.length;ft--;)if(_e[ft]===rt)continue e;y&&_e.push(rt),we.push(Xe)}else W(_e,rt,_)||(_e!==we&&_e.push(rt),we.push(Xe))}return we}function Fu(m,y){return y=As(y,m),m=xc(m,y),m==null||delete m[xn(zr(y))]}function Mp(m,y,_,O){return mc(m,y,_(Ji(m,y)),O)}function $u(m,y,_,O){for(var W=m.length,le=O?W:-1;(O?le--:++le<W)&&y(m[le],le,m););return _?Di(m,O?0:le,O?le+1:W):Di(m,O?le+1:0,O?W:le)}function Qg(m,y){var _=m;return _ instanceof Yt&&(_=_.value()),hu(y,function(O,W){return W.func.apply(W.thisArg,xa([O],W.args))},_)}function zu(m,y,_){var O=m.length;if(O<2)return O?Ts(m[0]):[];for(var W=-1,le=ce(O);++W<O;)for(var me=m[W],we=-1;++we<O;)we!=W&&(le[W]=ho(le[W]||me,m[we],y,_));return Ts(en(le,1),y,_)}function Rp(m,y,_){for(var O=-1,W=m.length,le=y.length,me={};++O<W;){var we=O<le?y[O]:t;_(me,m[O],we)}return me}function Af(m){return sr(m)?m:[]}function Bu(m){return typeof m=="function"?m:De}function As(m,y){return Mt(m)?m:zf(m,y)?[m]:ts(pn(m))}var Jg=$t;function mo(m,y,_){var O=m.length;return _=_===t?O:_,!y&&_>=O?m:Di(m,y,_)}var Kg=uf||function(m){return Zn.clearTimeout(m)};function Op(m,y){if(y)return m.slice();var _=m.length,O=ll?ll(_):new m.constructor(_);return m.copy(O),O}function wl(m){var y=new m.constructor(m.byteLength);return new sc(y).set(new sc(m)),y}function Lp(m,y){var _=y?wl(m.buffer):m.buffer;return new m.constructor(_,m.byteOffset,m.byteLength)}function Pf(m){var y=new m.constructor(m.source,Ba.exec(m));return y.lastIndex=m.lastIndex,y}function Xg(m){return hl?At(hl.call(m)):{}}function Fp(m,y){var _=y?wl(m.buffer):m.buffer;return new m.constructor(_,m.byteOffset,m.length)}function Uu(m,y){if(m!==y){var _=m!==t,O=m===null,W=m===m,le=Zr(m),me=y!==t,we=y===null,_e=y===y,Je=Zr(y);if(!we&&!Je&&!le&&m>y||le&&me&&_e&&!we&&!Je||O&&me&&_e||!_&&_e||!W)return 1;if(!O&&!le&&!Je&&m<y||Je&&_&&W&&!O&&!le||we&&_&&W||!me&&W||!_e)return-1}return 0}function Zg(m,y,_){for(var O=-1,W=m.criteria,le=y.criteria,me=W.length,we=_.length;++O<me;){var _e=Uu(W[O],le[O]);if(_e){if(O>=we)return _e;var Je=_[O];return _e*(Je=="desc"?-1:1)}}return m.index-y.index}function $p(m,y,_,O){for(var W=-1,le=m.length,me=_.length,we=-1,_e=y.length,Je=$n(le-me,0),Xe=ce(_e+Je),rt=!O;++we<_e;)Xe[we]=y[we];for(;++W<me;)(rt||W<le)&&(Xe[_[W]]=m[W]);for(;Je--;)Xe[we++]=m[W++];return Xe}function ey(m,y,_,O){for(var W=-1,le=m.length,me=-1,we=_.length,_e=-1,Je=y.length,Xe=$n(le-we,0),rt=ce(Xe+Je),ft=!O;++W<Xe;)rt[W]=m[W];for(var gt=W;++_e<Je;)rt[gt+_e]=y[_e];for(;++me<we;)(ft||W<le)&&(rt[gt+_[me]]=m[W++]);return rt}function gr(m,y){var _=-1,O=m.length;for(y||(y=ce(O));++_<O;)y[_]=m[_];return y}function gi(m,y,_,O){var W=!_;_||(_={});for(var le=-1,me=y.length;++le<me;){var we=y[le],_e=O?O(_[we],m[we],we,_,m):t;_e===t&&(_e=m[we]),W?Ca(_,we,_e):gl(_,we,_e)}return _}function Df(m,y){return gi(m,Qu(m),y)}function qu(m,y){return gi(m,$f(m),y)}function Sl(m,y){return function(_,O){var W=Mt(_)?Kl:fo,le=y?y():{};return W(_,m,vt(O,2),le)}}function Nl(m){return $t(function(y,_){var O=-1,W=_.length,le=W>1?_[W-1]:t,me=W>2?_[2]:t;for(le=m.length>3&&typeof le=="function"?(W--,le):t,me&&Xr(_[0],_[1],me)&&(le=W<3?t:le,W=1),y=At(y);++O<W;){var we=_[O];we&&m(y,we,O,le)}return y})}function zp(m,y){return function(_,O){if(_==null)return _;if(!xr(_))return m(_,O);for(var W=_.length,le=y?W:-1,me=At(_);(y?le--:++le<W)&&O(me[le],le,me)!==!1;);return _}}function Cl(m){return function(y,_,O){for(var W=-1,le=At(y),me=O(y),we=me.length;we--;){var _e=me[m?we:++W];if(_(le[_e],_e,le)===!1)break}return y}}function ty(m,y,_){var O=y&E,W=Ki(m);function le(){var me=this&&this!==Zn&&this instanceof le?W:m;return me.apply(O?_:this,arguments)}return le}function Ii(m){return function(y){y=pn(y);var _=Qa(y)?li(y):t,O=_?_[0]:y.charAt(0),W=_?mo(_,1).join(""):y.slice(1);return O[m]()+W}}function Kr(m){return function(y){return hu(N($s(y).replace(tl,"")),m,"")}}function Ki(m){return function(){var y=arguments;switch(y.length){case 0:return new m;case 1:return new m(y[0]);case 2:return new m(y[0],y[1]);case 3:return new m(y[0],y[1],y[2]);case 4:return new m(y[0],y[1],y[2],y[3]);case 5:return new m(y[0],y[1],y[2],y[3],y[4]);case 6:return new m(y[0],y[1],y[2],y[3],y[4],y[5]);case 7:return new m(y[0],y[1],y[2],y[3],y[4],y[5],y[6])}var _=Pi(m.prototype),O=m.apply(_,y);return Gn(O)?O:_}}function ny(m,y,_){var O=Ki(m);function W(){for(var le=arguments.length,me=ce(le),we=le,_e=_l(W);we--;)me[we]=arguments[we];var Je=le<3&&me[0]!==_e&&me[le-1]!==_e?[]:va(me,_e);if(le-=Je.length,le<_)return Bp(m,y,ir,W.placeholder,t,me,Je,t,t,_-le);var Xe=this&&this!==Zn&&this instanceof W?O:m;return ur(Xe,this,me)}return W}function Ps(m){return function(y,_,O){var W=At(y);if(!xr(y)){var le=vt(_,3);y=vr(y),_=function(we){return le(W[we],we,W)}}var me=m(y,_,O);return me>-1?W[le?y[me]:me]:t}}function Xa(m){return zn(function(y){var _=y.length,O=_,W=fi.prototype.thru;for(m&&y.reverse();O--;){var le=y[O];if(typeof le!="function")throw new Ai(l);if(W&&!me&&Wu(le)=="wrapper")var me=new fi([],!0)}for(O=me?O:_;++O<_;){le=y[O];var we=Wu(le),_e=we=="wrapper"?Lf(le):t;_e&&Bf(_e[0])&&_e[1]==(U|D|R|z)&&!_e[4].length&&_e[9]==1?me=me[Wu(_e[0])].apply(me,_e[3]):me=le.length==1&&Bf(le)?me[we]():me.thru(le)}return function(){var Je=arguments,Xe=Je[0];if(me&&Je.length==1&&Mt(Xe))return me.plant(Xe).value();for(var rt=0,ft=_?y[rt].apply(this,Je):Xe;++rt<_;)ft=y[rt].call(this,ft);return ft}})}function ir(m,y,_,O,W,le,me,we,_e,Je){var Xe=y&U,rt=y&E,ft=y&T,gt=y&(D|q),Pt=y&V,Qt=ft?t:Ki(m);function Dt(){for(var nn=arguments.length,un=ce(nn),Aa=nn;Aa--;)un[Aa]=arguments[Aa];if(gt)var Fi=_l(Dt),Pa=op(un,Fi);if(O&&(un=$p(un,O,W,gt)),le&&(un=ey(un,le,me,gt)),nn-=Pa,gt&&nn<Je){var wr=va(un,Fi);return Bp(m,y,ir,Dt.placeholder,_,un,wr,we,_e,Je-nn)}var zs=rt?_:this,Al=ft?zs[m]:m;return nn=un.length,we?un=es(un,we):Pt&&nn>1&&un.reverse(),Xe&&_e<nn&&(un.length=_e),this&&this!==Zn&&this instanceof Dt&&(Al=Qt||Ki(Al)),Al.apply(zs,un)}return Dt}function Vu(m,y){return function(_,O){return Np(_,m,y(O),{})}}function gc(m,y){return function(_,O){var W;if(_===t&&O===t)return y;if(_!==t&&(W=_),O!==t){if(W===t)return O;typeof _=="string"||typeof O=="string"?(_=mi(_),O=mi(O)):(_=Tf(_),O=Tf(O)),W=m(_,O)}return W}}function Hu(m){return zn(function(y){return y=Mn(y,Lr(vt())),$t(function(_){var O=this;return m(y,function(W){return ur(W,O,_)})})})}function Gu(m,y){y=y===t?" ":mi(y);var _=y.length;if(_<2)return _?Dp(y,m):y;var O=Dp(y,oc(m/Vi(y)));return Qa(y)?mo(li(O),0,m).join(""):O.slice(0,m)}function ry(m,y,_,O){var W=y&E,le=Ki(m);function me(){for(var we=-1,_e=arguments.length,Je=-1,Xe=O.length,rt=ce(Xe+_e),ft=this&&this!==Zn&&this instanceof me?le:m;++Je<Xe;)rt[Je]=O[Je];for(;_e--;)rt[Je++]=arguments[++we];return ur(ft,W?_:this,rt)}return me}function go(m){return function(y,_,O){return O&&typeof O!="number"&&Xr(y,_,O)&&(_=O=t),y=is(y),_===t?(_=y,y=0):_=is(_),O=O===t?y<_?1:-1:is(O),Gg(y,_,O,m)}}function jl(m){return function(y,_){return typeof y=="string"&&typeof _=="string"||(y=ta(y),_=ta(_)),m(y,_)}}function Bp(m,y,_,O,W,le,me,we,_e,Je){var Xe=y&D,rt=Xe?me:t,ft=Xe?t:me,gt=Xe?le:t,Pt=Xe?t:le;y|=Xe?R:F,y&=~(Xe?F:R),y&I||(y&=-4);var Qt=[m,y,W,gt,rt,Pt,ft,we,_e,Je],Dt=_.apply(t,Qt);return Bf(m)&&Vf(Dt,Qt),Dt.placeholder=O,Hf(Dt,m,y)}function If(m){var y=ct[m];return function(_,O){if(_=ta(_),O=O==null?0:qn(Ft(O),292),O&&Su(_)){var W=(pn(_)+"e").split("e"),le=y(W[0]+"e"+(+W[1]+O));return W=(pn(le)+"e").split("e"),+(W[0]+"e"+(+W[1]-O))}return y(_)}}var iy=Zt&&1/nc(new Zt([,-0]))[1]==B?function(m){return new Zt(m)}:pt;function Yu(m){return function(y){var _=jr(y);return _==xe?oi(y):_==ve?lp(y):Kd(y,m(y))}}function Za(m,y,_,O,W,le,me,we){var _e=y&T;if(!_e&&typeof m!="function")throw new Ai(l);var Je=O?O.length:0;if(Je||(y&=-97,O=W=t),me=me===t?me:$n(Ft(me),0),we=we===t?we:Ft(we),Je-=W?W.length:0,y&F){var Xe=O,rt=W;O=W=t}var ft=_e?t:Lf(m),gt=[m,y,_,O,W,Xe,rt,le,me,we];if(ft&&Xu(gt,ft),m=gt[0],y=gt[1],_=gt[2],O=gt[3],W=gt[4],we=gt[9]=gt[9]===t?_e?0:m.length:$n(gt[9]-Je,0),!we&&y&(D|q)&&(y&=-25),!y||y==E)var Pt=ty(m,y,_);else y==D||y==q?Pt=ny(m,y,we):(y==R||y==(E|R))&&!W.length?Pt=ry(m,y,_,O):Pt=ir.apply(t,gt);var Qt=ft?Ru:Vf;return Hf(Qt(Pt,gt),m,y)}function Mf(m,y,_,O){return m===t||vi(m,ic[_])&&!hn.call(O,_)?y:m}function Up(m,y,_,O,W,le){return Gn(m)&&Gn(y)&&(le.set(y,m),Mu(m,y,t,Up,le),le.delete(y)),m}function ay(m){return ea(m)?t:m}function sy(m,y,_,O,W,le){var me=_&S,we=m.length,_e=y.length;if(we!=_e&&!(me&&_e>we))return!1;var Je=le.get(m),Xe=le.get(y);if(Je&&Xe)return Je==y&&Xe==m;var rt=-1,ft=!0,gt=_&k?new _s:t;for(le.set(m,y),le.set(y,m);++rt<we;){var Pt=m[rt],Qt=y[rt];if(O)var Dt=me?O(Qt,Pt,rt,y,m,le):O(Pt,Qt,rt,m,y,le);if(Dt!==t){if(Dt)continue;ft=!1;break}if(gt){if(!pu(y,function(nn,un){if(!ao(gt,un)&&(Pt===nn||W(Pt,nn,_,O,le)))return gt.push(un)})){ft=!1;break}}else if(!(Pt===Qt||W(Pt,Qt,_,O,le))){ft=!1;break}}return le.delete(m),le.delete(y),ft}function oy(m,y,_,O,W,le,me){switch(_){case Ne:if(m.byteLength!=y.byteLength||m.byteOffset!=y.byteOffset)return!1;m=m.buffer,y=y.buffer;case X:return!(m.byteLength!=y.byteLength||!le(new sc(m),new sc(y)));case de:case Me:case Ie:return vi(+m,+y);case Fe:return m.name==y.name&&m.message==y.message;case xt:case qe:return m==y+"";case xe:var we=oi;case ve:var _e=O&S;if(we||(we=nc),m.size!=y.size&&!_e)return!1;var Je=me.get(m);if(Je)return Je==y;O|=k,me.set(m,y);var Xe=sy(we(m),we(y),O,W,le,me);return me.delete(m),Xe;case Qe:if(hl)return hl.call(m)==hl.call(y)}return!1}function Cr(m,y,_,O,W,le){var me=_&S,we=Rf(m),_e=we.length,Je=Rf(y),Xe=Je.length;if(_e!=Xe&&!me)return!1;for(var rt=_e;rt--;){var ft=we[rt];if(!(me?ft in y:hn.call(y,ft)))return!1}var gt=le.get(m),Pt=le.get(y);if(gt&&Pt)return gt==y&&Pt==m;var Qt=!0;le.set(m,y),le.set(y,m);for(var Dt=me;++rt<_e;){ft=we[rt];var nn=m[ft],un=y[ft];if(O)var Aa=me?O(un,nn,ft,y,m,le):O(nn,un,ft,m,y,le);if(!(Aa===t?nn===un||W(nn,un,_,O,le):Aa)){Qt=!1;break}Dt||(Dt=ft=="constructor")}if(Qt&&!Dt){var Fi=m.constructor,Pa=y.constructor;Fi!=Pa&&"constructor"in m&&"constructor"in y&&!(typeof Fi=="function"&&Fi instanceof Fi&&typeof Pa=="function"&&Pa instanceof Pa)&&(Qt=!1)}return le.delete(m),le.delete(y),Qt}function zn(m){return Zu(Yp(m,t,xi),m+"")}function Rf(m){return zg(m,vr,Qu)}function Of(m){return zg(m,_r,$f)}var Lf=lc?function(m){return lc.get(m)}:pt;function Wu(m){for(var y=m.name+"",_=Wi[y],O=hn.call(Wi,y)?_.length:0;O--;){var W=_[O],le=W.func;if(le==null||le==m)return W.name}return y}function _l(m){var y=hn.call(ne,"placeholder")?ne:m;return y.placeholder}function vt(){var m=ne.iteratee||_t;return m=m===_t?_p:m,arguments.length?m(arguments[0],arguments[1]):m}function yc(m,y){var _=m.__data__;return Is(y)?_[typeof y=="string"?"string":"hash"]:_.map}function Ff(m){for(var y=vr(m),_=y.length;_--;){var O=y[_],W=m[O];y[_]=[O,W,dy(W)]}return y}function yo(m,y){var _=sl(m,y);return Ka(_)?_:t}function ly(m){var y=hn.call(m,Qr),_=m[Qr];try{m[Qr]=t;var O=!0}catch{}var W=Wr.call(m);return O&&(y?m[Qr]=_:delete m[Qr]),W}var Qu=lo?function(m){return m==null?[]:(m=At(m),Bi(lo(m),function(y){return cl.call(m,y)}))}:nv,$f=lo?function(m){for(var y=[];m;)xa(y,Qu(m)),m=bu(m);return y}:nv,jr=tn;(Nu&&jr(new Nu(new ArrayBuffer(1)))!=Ne||mr&&jr(new mr)!=xe||Vn&&jr(Vn.resolve())!=nt||Zt&&jr(new Zt)!=ve||Na&&jr(new Na)!=J)&&(jr=function(m){var y=tn(m),_=y==ze?m.constructor:t,O=_?Ms(_):"";if(O)switch(O){case Eg:return Ne;case Tg:return xe;case Cu:return nt;case ju:return ve;case Ag:return J}return y});function cy(m,y,_){for(var O=-1,W=_.length;++O<W;){var le=_[O],me=le.size;switch(le.type){case"drop":m+=me;break;case"dropRight":y-=me;break;case"take":y=qn(y,m+me);break;case"takeRight":m=$n(m,y-me);break}}return{start:m,end:y}}function qp(m){var y=m.match(tp);return y?y[1].split(Vd):[]}function Ju(m,y,_){y=As(y,m);for(var O=-1,W=y.length,le=!1;++O<W;){var me=xn(y[O]);if(!(le=m!=null&&_(m,me)))break;m=m[me]}return le||++O!=W?le:(W=m==null?0:m.length,!!W&&Tl(W)&&ka(me,W)&&(Mt(m)||Fs(m)))}function Vp(m){var y=m.length,_=new m.constructor(y);return y&&typeof m[0]=="string"&&hn.call(m,"index")&&(_.index=m.index,_.input=m.input),_}function Hp(m){return typeof m.constructor=="function"&&!Pn(m)?Pi(bu(m)):{}}function Gp(m,y,_){var O=m.constructor;switch(y){case X:return wl(m);case de:case Me:return new O(+m);case Ne:return Lp(m,_);case ke:case Ue:case it:case mt:case ht:case Ve:case tt:case Le:case ot:return Fp(m,_);case xe:return new O;case Ie:case qe:return new O(m);case xt:return Pf(m);case ve:return new O;case Qe:return Xg(m)}}function uy(m,y){var _=y.length;if(!_)return m;var O=_-1;return y[O]=(_>1?"& ":"")+y[O],y=y.join(_>2?", ":" "),m.replace(ep,`{
/* [wrapped with `+y+`] */
`)}function Ds(m){return Mt(m)||Fs(m)||!!(ui&&m&&m[ui])}function ka(m,y){var _=typeof m;return y=y??K,!!y&&(_=="number"||_!="symbol"&&hs.test(m))&&m>-1&&m%1==0&&m<y}function Xr(m,y,_){if(!Gn(_))return!1;var O=typeof y;return(O=="number"?xr(_)&&ka(y,_.length):O=="string"&&y in _)?vi(_[y],m):!1}function zf(m,y){if(Mt(m))return!1;var _=typeof m;return _=="number"||_=="symbol"||_=="boolean"||m==null||Zr(m)?!0:Ti.test(m)||!fa.test(m)||y!=null&&m in At(y)}function Is(m){var y=typeof m;return y=="string"||y=="number"||y=="symbol"||y=="boolean"?m!=="__proto__":m===null}function Bf(m){var y=Wu(m),_=ne[y];if(typeof _!="function"||!(y in Yt.prototype))return!1;if(m===_)return!0;var O=Lf(_);return!!O&&m===O[0]}function Uf(m){return!!up&&up in m}var Ku=yu?Ea:rv;function Pn(m){var y=m&&m.constructor,_=typeof y=="function"&&y.prototype||ic;return m===_}function dy(m){return m===m&&!Gn(m)}function fy(m,y){return function(_){return _==null?!1:_[m]===y&&(y!==t||m in At(_))}}function hy(m){var y=cd(m,function(O){return _.size===u&&_.clear(),O}),_=y.cache;return y}function Xu(m,y){var _=m[1],O=y[1],W=_|O,le=W<(E|T|U),me=O==U&&_==D||O==U&&_==z&&m[7].length<=y[8]||O==(U|z)&&y[7].length<=y[8]&&_==D;if(!(le||me))return m;O&E&&(m[2]=y[2],W|=_&E?0:I);var we=y[3];if(we){var _e=m[3];m[3]=_e?$p(_e,we,y[4]):we,m[4]=_e?va(m[3],h):y[4]}return we=y[5],we&&(_e=m[5],m[5]=_e?ey(_e,we,y[6]):we,m[6]=_e?va(m[5],h):y[6]),we=y[7],we&&(m[7]=we),O&U&&(m[8]=m[8]==null?y[8]:qn(m[8],y[8])),m[9]==null&&(m[9]=y[9]),m[0]=y[0],m[1]=W,m}function xo(m){var y=[];if(m!=null)for(var _ in At(m))y.push(_);return y}function py(m){return Wr.call(m)}function Yp(m,y,_){return y=$n(y===t?m.length-1:y,0),function(){for(var O=arguments,W=-1,le=$n(O.length-y,0),me=ce(le);++W<le;)me[W]=O[y+W];W=-1;for(var we=ce(y+1);++W<y;)we[W]=O[W];return we[y]=_(me),ur(m,this,we)}}function xc(m,y){return y.length<2?m:Ji(m,Di(y,0,-1))}function es(m,y){for(var _=m.length,O=qn(y.length,_),W=gr(m);O--;){var le=y[O];m[O]=ka(le,_)?W[le]:t}return m}function qf(m,y){if(!(y==="constructor"&&typeof m[y]=="function")&&y!="__proto__")return m[y]}var Vf=ed(Ru),bc=fp||function(m,y){return Zn.setTimeout(m,y)},Zu=ed(Ou);function Hf(m,y,_){var O=y+"";return Zu(m,uy(O,my(qp(O),_)))}function ed(m){var y=0,_=0;return function(){var O=js(),W=ee-(O-_);if(_=O,W>0){if(++y>=H)return arguments[0]}else y=0;return m.apply(t,arguments)}}function td(m,y){var _=-1,O=m.length,W=O-1;for(y=y===t?O:y;++_<y;){var le=_f(_,W),me=m[le];m[le]=m[_],m[_]=me}return m.length=y,m}var ts=hy(function(m){var y=[];return m.charCodeAt(0)===46&&y.push(""),m.replace(nr,function(_,O,W,le){y.push(W?le.replace(Ys,"$1"):O||_)}),y});function xn(m){if(typeof m=="string"||Zr(m))return m;var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function Ms(m){if(m!=null){try{return xu.call(m)}catch{}try{return m+""}catch{}}return""}function my(m,y){return Or(pe,function(_){var O="_."+_[0];y&_[1]&&!Xl(m,O)&&m.push(O)}),m.sort()}function yr(m){if(m instanceof Yt)return m.clone();var y=new fi(m.__wrapped__,m.__chain__);return y.__actions__=gr(m.__actions__),y.__index__=m.__index__,y.__values__=m.__values__,y}function v0(m,y,_){(_?Xr(m,y,_):y===t)?y=1:y=$n(Ft(y),0);var O=m==null?0:m.length;if(!O||y<1)return[];for(var W=0,le=0,me=ce(oc(O/y));W<O;)me[le++]=Di(m,W,W+=y);return me}function gy(m){for(var y=-1,_=m==null?0:m.length,O=0,W=[];++y<_;){var le=m[y];le&&(W[O++]=le)}return W}function yy(){var m=arguments.length;if(!m)return[];for(var y=ce(m-1),_=arguments[0],O=m;O--;)y[O-1]=arguments[O];return xa(Mt(_)?gr(_):[_],en(y,1))}var Hn=$t(function(m,y){return sr(m)?ho(m,en(y,1,sr,!0)):[]}),yi=$t(function(m,y){var _=zr(y);return sr(_)&&(_=t),sr(m)?ho(m,en(y,1,sr,!0),vt(_,2)):[]}),Rs=$t(function(m,y){var _=zr(y);return sr(_)&&(_=t),sr(m)?ho(m,en(y,1,sr,!0),t,_):[]});function xy(m,y,_){var O=m==null?0:m.length;return O?(y=_||y===t?1:Ft(y),Di(m,y<0?0:y,O)):[]}function by(m,y,_){var O=m==null?0:m.length;return O?(y=_||y===t?1:Ft(y),y=O-y,Di(m,0,y<0?0:y)):[]}function w0(m,y){return m&&m.length?$u(m,vt(y,3),!0,!0):[]}function Wp(m,y){return m&&m.length?$u(m,vt(y,3),!0):[]}function Mi(m,y,_,O){var W=m==null?0:m.length;return W?(_&&typeof _!="number"&&Xr(m,y,_)&&(_=0,O=W),qt(m,y,_,O)):[]}function Xi(m,y,_){var O=m==null?0:m.length;if(!O)return-1;var W=_==null?0:Ft(_);return W<0&&(W=$n(O+W,0)),ws(m,vt(y,3),W)}function Qp(m,y,_){var O=m==null?0:m.length;if(!O)return-1;var W=O-1;return _!==t&&(W=Ft(_),W=_<0?$n(O+W,0):qn(W,O-1)),ws(m,vt(y,3),W,!0)}function xi(m){var y=m==null?0:m.length;return y?en(m,1):[]}function vy(m){var y=m==null?0:m.length;return y?en(m,B):[]}function bo(m,y){var _=m==null?0:m.length;return _?(y=y===t?1:Ft(y),en(m,y)):[]}function kl(m){for(var y=-1,_=m==null?0:m.length,O={};++y<_;){var W=m[y];O[W[0]]=W[1]}return O}function Os(m){return m&&m.length?m[0]:t}function Jp(m,y,_){var O=m==null?0:m.length;if(!O)return-1;var W=_==null?0:Ft(_);return W<0&&(W=$n(O+W,0)),ro(m,y,W)}function Kp(m){var y=m==null?0:m.length;return y?Di(m,0,-1):[]}var ns=$t(function(m){var y=Mn(m,Af);return y.length&&y[0]===m[0]?Sp(y):[]}),wy=$t(function(m){var y=zr(m),_=Mn(m,Af);return y===zr(_)?y=t:_.pop(),_.length&&_[0]===m[0]?Sp(_,vt(y,2)):[]}),vc=$t(function(m){var y=zr(m),_=Mn(m,Af);return y=typeof y=="function"?y:t,y&&_.pop(),_.length&&_[0]===m[0]?Sp(_,t,y):[]});function nd(m,y){return m==null?"":Gi.call(m,y)}function zr(m){var y=m==null?0:m.length;return y?m[y-1]:t}function wc(m,y,_){var O=m==null?0:m.length;if(!O)return-1;var W=O;return _!==t&&(W=Ft(_),W=W<0?$n(O+W,0):qn(W,O-1)),y===y?Yr(m,y,W):ws(m,Gr,W,!0)}function Sy(m,y){return m&&m.length?Tp(m,Ft(y)):t}var Ny=$t(Sc);function Sc(m,y){return m&&m.length&&y&&y.length?jf(m,y):m}function Cy(m,y,_){return m&&m.length&&y&&y.length?jf(m,y,vt(_,2)):m}function Gf(m,y,_){return m&&m.length&&y&&y.length?jf(m,y,t,_):m}var jy=zn(function(m,y){var _=m==null?0:m.length,O=Au(m,y);return Pp(m,Mn(y,function(W){return ka(W,_)?+W:W}).sort(Uu)),O});function S0(m,y){var _=[];if(!(m&&m.length))return _;var O=-1,W=[],le=m.length;for(y=vt(y,3);++O<le;){var me=m[O];y(me,O,m)&&(_.push(me),W.push(O))}return Pp(m,W),_}function Xp(m){return m==null?m:pp.call(m)}function vn(m,y,_){var O=m==null?0:m.length;return O?(_&&typeof _!="number"&&Xr(m,y,_)?(y=0,_=O):(y=y==null?0:Ft(y),_=_===t?O:Ft(_)),Di(m,y,_)):[]}function Rn(m,y){return Lu(m,y)}function Jt(m,y,_){return Ef(m,y,vt(_,2))}function on(m,y){var _=m==null?0:m.length;if(_){var O=Lu(m,y);if(O<_&&vi(m[O],y))return O}return-1}function wn(m,y){return Lu(m,y,!0)}function Ri(m,y,_){return Ef(m,y,vt(_,2),!0)}function vo(m,y){var _=m==null?0:m.length;if(_){var O=Lu(m,y,!0)-1;if(vi(m[O],y))return O}return-1}function Nc(m){return m&&m.length?Ip(m):[]}function Zp(m,y){return m&&m.length?Ip(m,vt(y,2)):[]}function Ls(m){var y=m==null?0:m.length;return y?Di(m,1,y):[]}function ar(m,y,_){return m&&m.length?(y=_||y===t?1:Ft(y),Di(m,0,y<0?0:y)):[]}function wo(m,y,_){var O=m==null?0:m.length;return O?(y=_||y===t?1:Ft(y),y=O-y,Di(m,y<0?0:y,O)):[]}function El(m,y){return m&&m.length?$u(m,vt(y,3),!1,!0):[]}function em(m,y){return m&&m.length?$u(m,vt(y,3)):[]}var Zi=$t(function(m){return Ts(en(m,1,sr,!0))}),Cc=$t(function(m){var y=zr(m);return sr(y)&&(y=t),Ts(en(m,1,sr,!0),vt(y,2))}),rd=$t(function(m){var y=zr(m);return y=typeof y=="function"?y:t,Ts(en(m,1,sr,!0),t,y)});function bi(m){return m&&m.length?Ts(m):[]}function tm(m,y){return m&&m.length?Ts(m,vt(y,2)):[]}function nm(m,y){return y=typeof y=="function"?y:t,m&&m.length?Ts(m,t,y):[]}function jc(m){if(!(m&&m.length))return[];var y=0;return m=Bi(m,function(_){if(sr(_))return y=$n(_.length,y),!0}),ba(y,function(_){return Mn(m,il(_))})}function id(m,y){if(!(m&&m.length))return[];var _=jc(m);return y==null?_:Mn(_,function(O){return ur(y,t,O)})}var So=$t(function(m,y){return sr(m)?ho(m,y):[]}),Ir=$t(function(m){return zu(Bi(m,sr))}),No=$t(function(m){var y=zr(m);return sr(y)&&(y=t),zu(Bi(m,sr),vt(y,2))}),_c=$t(function(m){var y=zr(m);return y=typeof y=="function"?y:t,zu(Bi(m,sr),t,y)}),kc=$t(jc);function rm(m,y){return Rp(m||[],y||[],gl)}function im(m,y){return Rp(m||[],y||[],mc)}var _y=$t(function(m){var y=m.length,_=y>1?m[y-1]:t;return _=typeof _=="function"?(m.pop(),_):t,id(m,_)});function Ec(m){var y=ne(m);return y.__chain__=!0,y}function am(m,y){return y(m),m}function Br(m,y){return y(m)}var ky=zn(function(m){var y=m.length,_=y?m[0]:0,O=this.__wrapped__,W=function(le){return Au(le,m)};return y>1||this.__actions__.length||!(O instanceof Yt)||!ka(_)?this.thru(W):(O=O.slice(_,+_+(y?1:0)),O.__actions__.push({func:Br,args:[W],thisArg:t}),new fi(O,this.__chain__).thru(function(le){return y&&!le.length&&le.push(t),le}))});function Oi(){return Ec(this)}function Ey(){return new fi(this.value(),this.__chain__)}function Ty(){this.__values__===t&&(this.__values__=Li(this.value()));var m=this.__index__>=this.__values__.length,y=m?t:this.__values__[this.__index__++];return{done:m,value:y}}function N0(){return this}function Co(m){for(var y,_=this;_ instanceof Qi;){var O=yr(_);O.__index__=0,O.__values__=t,y?W.__wrapped__=O:y=O;var W=O;_=_.__wrapped__}return W.__wrapped__=m,y}function Yf(){var m=this.__wrapped__;if(m instanceof Yt){var y=m;return this.__actions__.length&&(y=new Yt(this)),y=y.reverse(),y.__actions__.push({func:Br,args:[Xp],thisArg:t}),new fi(y,this.__chain__)}return this.thru(Xp)}function sm(){return Qg(this.__wrapped__,this.__actions__)}var Tc=Sl(function(m,y,_){hn.call(m,_)?++m[_]:Ca(m,_,1)});function Ay(m,y,_){var O=Mt(m)?rl:vp;return _&&Xr(m,y,_)&&(y=t),O(m,vt(y,3))}function Py(m,y){var _=Mt(m)?Bi:bn;return _(m,vt(y,3))}var Dy=Ps(Xi),om=Ps(Qp);function lm(m,y){return en(ad(m,y),1)}function C0(m,y){return en(ad(m,y),B)}function j0(m,y,_){return _=_===t?1:Ft(_),en(ad(m,y),_)}function Iy(m,y){var _=Mt(m)?Or:Es;return _(m,vt(y,3))}function cm(m,y){var _=Mt(m)?np:yf;return _(m,vt(y,3))}var My=Sl(function(m,y,_){hn.call(m,_)?m[_].push(y):Ca(m,_,[y])});function Ac(m,y,_,O){m=xr(m)?m:Lc(m),_=_&&!O?Ft(_):0;var W=m.length;return _<0&&(_=$n(W+_,0)),ah(m)?_<=W&&m.indexOf(y,_)>-1:!!W&&ro(m,y,_)>-1}var Wf=$t(function(m,y,_){var O=-1,W=typeof y=="function",le=xr(m)?ce(m.length):[];return Es(m,function(me){le[++O]=W?ur(y,me,_):bl(me,y,_)}),le}),Ry=Sl(function(m,y,_){Ca(m,_,y)});function ad(m,y){var _=Mt(m)?Mn:kp;return _(m,vt(y,3))}function Oy(m,y,_,O){return m==null?[]:(Mt(y)||(y=y==null?[]:[y]),_=O?t:_,Mt(_)||(_=_==null?[]:[_]),Ap(m,y,_))}var Ly=Sl(function(m,y,_){m[_?0:1].push(y)},function(){return[[],[]]});function Fy(m,y,_){var O=Mt(m)?hu:Zl,W=arguments.length<3;return O(m,vt(y,4),_,W,Es)}function $y(m,y,_){var O=Mt(m)?rp:Zl,W=arguments.length<3;return O(m,vt(y,4),_,W,yf)}function Qf(m,y){var _=Mt(m)?Bi:bn;return _(m,ud(vt(y,3)))}function zy(m){var y=Mt(m)?uc:pc;return y(m)}function By(m,y,_){(_?Xr(m,y,_):y===t)?y=1:y=Ft(y);var O=Mt(m)?Lg:kf;return O(m,y)}function Dn(m){var y=Mt(m)?Fg:Yg;return y(m)}function um(m){if(m==null)return 0;if(xr(m))return ah(m)?Vi(m):m.length;var y=jr(m);return y==xe||y==ve?m.size:wf(m).length}function _0(m,y,_){var O=Mt(m)?pu:Wg;return _&&Xr(m,y,_)&&(y=t),O(m,vt(y,3))}var Uy=$t(function(m,y){if(m==null)return[];var _=y.length;return _>1&&Xr(m,y[0],y[1])?y=[]:_>2&&Xr(y[0],y[1],y[2])&&(y=[y[0]]),Ap(m,en(y,1),[])}),Jf=dl||function(){return Zn.Date.now()};function k0(m,y){if(typeof y!="function")throw new Ai(l);return m=Ft(m),function(){if(--m<1)return y.apply(this,arguments)}}function qy(m,y,_){return y=_?t:y,y=m&&y==null?m.length:y,Za(m,U,t,t,t,t,y)}function sd(m,y){var _;if(typeof y!="function")throw new Ai(l);return m=Ft(m),function(){return--m>0&&(_=y.apply(this,arguments)),m<=1&&(y=t),_}}var jo=$t(function(m,y,_){var O=E;if(_.length){var W=va(_,_l(jo));O|=R}return Za(m,O,y,_,W)}),Kf=$t(function(m,y,_){var O=E|T;if(_.length){var W=va(_,_l(Kf));O|=R}return Za(y,O,m,_,W)});function od(m,y,_){y=_?t:y;var O=Za(m,D,t,t,t,t,t,y);return O.placeholder=od.placeholder,O}function Xf(m,y,_){y=_?t:y;var O=Za(m,q,t,t,t,t,t,y);return O.placeholder=Xf.placeholder,O}function _o(m,y,_){var O,W,le,me,we,_e,Je=0,Xe=!1,rt=!1,ft=!0;if(typeof m!="function")throw new Ai(l);y=ta(y)||0,Gn(_)&&(Xe=!!_.leading,rt="maxWait"in _,le=rt?$n(ta(_.maxWait)||0,y):le,ft="trailing"in _?!!_.trailing:ft);function gt(wr){var zs=O,Al=W;return O=W=t,Je=wr,me=m.apply(Al,zs),me}function Pt(wr){return Je=wr,we=bc(nn,y),Xe?gt(wr):me}function Qt(wr){var zs=wr-_e,Al=wr-Je,AS=y-zs;return rt?qn(AS,le-Al):AS}function Dt(wr){var zs=wr-_e,Al=wr-Je;return _e===t||zs>=y||zs<0||rt&&Al>=le}function nn(){var wr=Jf();if(Dt(wr))return un(wr);we=bc(nn,Qt(wr))}function un(wr){return we=t,ft&&O?gt(wr):(O=W=t,me)}function Aa(){we!==t&&Kg(we),Je=0,O=_e=W=we=t}function Fi(){return we===t?me:un(Jf())}function Pa(){var wr=Jf(),zs=Dt(wr);if(O=arguments,W=this,_e=wr,zs){if(we===t)return Pt(_e);if(rt)return Kg(we),we=bc(nn,y),gt(_e)}return we===t&&(we=bc(nn,y)),me}return Pa.cancel=Aa,Pa.flush=Fi,Pa}var rs=$t(function(m,y){return yl(m,1,y)}),ld=$t(function(m,y,_){return yl(m,ta(y)||0,_)});function E0(m){return Za(m,V)}function cd(m,y){if(typeof m!="function"||y!=null&&typeof y!="function")throw new Ai(l);var _=function(){var O=arguments,W=y?y.apply(this,O):O[0],le=_.cache;if(le.has(W))return le.get(W);var me=m.apply(this,O);return _.cache=le.set(W,me)||le,me};return _.cache=new(cd.Cache||hi),_}cd.Cache=hi;function ud(m){if(typeof m!="function")throw new Ai(l);return function(){var y=arguments;switch(y.length){case 0:return!m.call(this);case 1:return!m.call(this,y[0]);case 2:return!m.call(this,y[0],y[1]);case 3:return!m.call(this,y[0],y[1],y[2])}return!m.apply(this,y)}}function Vy(m){return sd(2,m)}var Hy=Jg(function(m,y){y=y.length==1&&Mt(y[0])?Mn(y[0],Lr(vt())):Mn(en(y,1),Lr(vt()));var _=y.length;return $t(function(O){for(var W=-1,le=qn(O.length,_);++W<le;)O[W]=y[W].call(this,O[W]);return ur(m,this,O)})}),dm=$t(function(m,y){var _=va(y,_l(dm));return Za(m,R,t,y,_)}),Zf=$t(function(m,y){var _=va(y,_l(Zf));return Za(m,F,t,y,_)}),Gy=zn(function(m,y){return Za(m,z,t,t,t,y)});function Yy(m,y){if(typeof m!="function")throw new Ai(l);return y=y===t?y:Ft(y),$t(m,y)}function T0(m,y){if(typeof m!="function")throw new Ai(l);return y=y==null?0:$n(Ft(y),0),$t(function(_){var O=_[y],W=mo(_,0,y);return O&&xa(W,O),ur(m,this,W)})}function fm(m,y,_){var O=!0,W=!0;if(typeof m!="function")throw new Ai(l);return Gn(_)&&(O="leading"in _?!!_.leading:O,W="trailing"in _?!!_.trailing:W),_o(m,y,{leading:O,maxWait:y,trailing:W})}function hm(m){return qy(m,1)}function A0(m,y){return dm(Bu(y),m)}function P0(){if(!arguments.length)return[];var m=arguments[0];return Mt(m)?m:[m]}function dd(m){return Fr(m,v)}function D0(m,y){return y=typeof y=="function"?y:t,Fr(m,v,y)}function Wy(m){return Fr(m,g|v)}function Kt(m,y){return y=typeof y=="function"?y:t,Fr(m,g|v,y)}function pm(m,y){return y==null||bp(m,y,vr(y))}function vi(m,y){return m===y||m!==m&&y!==y}var mm=jl(Pu),Qy=jl(function(m,y){return m>=y}),Fs=xf(function(){return arguments}())?xf:function(m){return er(m)&&hn.call(m,"callee")&&!cl.call(m,"callee")},Mt=ce.isArray,eh=Wa?Lr(Wa):pi;function xr(m){return m!=null&&Tl(m.length)&&!Ea(m)}function sr(m){return er(m)&&xr(m)}function I0(m){return m===!0||m===!1||er(m)&&tn(m)==de}var ko=df||rv,Jy=uu?Lr(uu):dr;function Ky(m){return er(m)&&m.nodeType===1&&!ea(m)}function th(m){if(m==null)return!0;if(xr(m)&&(Mt(m)||typeof m=="string"||typeof m.splice=="function"||ko(m)||Pc(m)||Fs(m)))return!m.length;var y=jr(m);if(y==xe||y==ve)return!m.size;if(Pn(m))return!wf(m).length;for(var _ in m)if(hn.call(m,_))return!1;return!0}function _n(m,y){return vl(m,y)}function gm(m,y,_){_=typeof _=="function"?_:t;var O=_?_(m,y):t;return O===t?vl(m,y,t,_):!!O}function br(m){if(!er(m))return!1;var y=tn(m);return y==Fe||y==Ze||typeof m.message=="string"&&typeof m.name=="string"&&!ea(m)}function M0(m){return typeof m=="number"&&Su(m)}function Ea(m){if(!Gn(m))return!1;var y=tn(m);return y==Ce||y==Re||y==Pe||y==jt}function nh(m){return typeof m=="number"&&m==Ft(m)}function Tl(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=K}function Gn(m){var y=typeof m;return m!=null&&(y=="object"||y=="function")}function er(m){return m!=null&&typeof m=="object"}var rh=Jl?Lr(Jl):bf;function ym(m,y){return m===y||Iu(m,y,Ff(y))}function R0(m,y,_){return _=typeof _=="function"?_:t,Iu(m,y,Ff(y),_)}function Xy(m){return ex(m)&&m!=+m}function O0(m){if(Ku(m))throw new We(s);return Ka(m)}function Zy(m){return m===null}function L0(m){return m==null}function ex(m){return typeof m=="number"||er(m)&&tn(m)==Ie}function ea(m){if(!er(m)||tn(m)!=ze)return!1;var y=bu(m);if(y===null)return!0;var _=hn.call(y,"constructor")&&y.constructor;return typeof _=="function"&&_ instanceof _&&xu.call(_)==Hi}var ih=vs?Lr(vs):vf;function xm(m){return nh(m)&&m>=-9007199254740991&&m<=K}var tx=Qd?Lr(Qd):Cp;function ah(m){return typeof m=="string"||!Mt(m)&&er(m)&&tn(m)==qe}function Zr(m){return typeof m=="symbol"||er(m)&&tn(m)==Qe}var Pc=du?Lr(du):jp;function Ta(m){return m===t}function bm(m){return er(m)&&jr(m)==J}function nx(m){return er(m)&&tn(m)==Y}var rx=jl(Sf),fd=jl(function(m,y){return m<=y});function Li(m){if(!m)return[];if(xr(m))return ah(m)?li(m):gr(m);if(ul&&m[ul])return tf(m[ul]());var y=jr(m),_=y==xe?oi:y==ve?nc:Lc;return _(m)}function is(m){if(!m)return m===0?m:0;if(m=ta(m),m===B||m===-1/0){var y=m<0?-1:1;return y*oe}return m===m?m:0}function Ft(m){var y=is(m),_=y%1;return y===y?_?y-_:y:0}function as(m){return m?ja(Ft(m),0,se):0}function ta(m){if(typeof m=="number")return m;if(Zr(m))return A;if(Gn(m)){var y=typeof m.valueOf=="function"?m.valueOf():m;m=Gn(y)?y+"":y}if(typeof m!="string")return m===0?m:+m;m=Xd(m);var _=cr.test(m);return _||Bl.test(m)?lu(m.slice(2),_?2:8):Qs.test(m)?A:+m}function ix(m){return gi(m,_r(m))}function Dc(m){return m?ja(Ft(m),-9007199254740991,K):m===0?m:0}function pn(m){return m==null?"":mi(m)}var F0=Nl(function(m,y){if(Pn(y)||xr(y)){gi(y,vr(y),m);return}for(var _ in y)hn.call(y,_)&&gl(m,_,y[_])}),ax=Nl(function(m,y){gi(y,_r(y),m)}),sh=Nl(function(m,y,_,O){gi(y,_r(y),m,O)}),$0=Nl(function(m,y,_,O){gi(y,vr(y),m,O)}),z0=zn(Au);function B0(m,y){var _=Pi(m);return y==null?_:ks(_,y)}var U0=$t(function(m,y){m=At(m);var _=-1,O=y.length,W=O>2?y[2]:t;for(W&&Xr(y[0],y[1],W)&&(O=1);++_<O;)for(var le=y[_],me=_r(le),we=-1,_e=me.length;++we<_e;){var Je=me[we],Xe=m[Je];(Xe===t||vi(Xe,ic[Je])&&!hn.call(m,Je))&&(m[Je]=le[Je])}return m}),sx=$t(function(m){return m.push(t,Up),ur(gd,t,m)});function Ic(m,y){return Jd(m,vt(y,3),$r)}function hd(m,y){return Jd(m,vt(y,3),hc)}function ox(m,y){return m==null?m:fc(m,vt(y,3),_r)}function q0(m,y){return m==null?m:xl(m,vt(y,3),_r)}function Mc(m,y){return m&&$r(m,vt(y,3))}function pd(m,y){return m&&hc(m,vt(y,3))}function lx(m){return m==null?[]:po(m,vr(m))}function oh(m){return m==null?[]:po(m,_r(m))}function md(m,y,_){var O=m==null?t:Ji(m,y);return O===t?_:O}function vm(m,y){return m!=null&&Ju(m,y,wp)}function Rc(m,y){return m!=null&&Ju(m,y,Bg)}var cx=Vu(function(m,y,_){y!=null&&typeof y.toString!="function"&&(y=Wr.call(y)),m[y]=_},Ae(De)),ux=Vu(function(m,y,_){y!=null&&typeof y.toString!="function"&&(y=Wr.call(y)),hn.call(m,y)?m[y].push(_):m[y]=[_]},vt),V0=$t(bl);function vr(m){return xr(m)?xp(m):wf(m)}function _r(m){return xr(m)?xp(m,!0):qg(m)}function H0(m,y){var _={};return y=vt(y,3),$r(m,function(O,W,le){Ca(_,y(O,W,le),O)}),_}function G0(m,y){var _={};return y=vt(y,3),$r(m,function(O,W,le){Ca(_,W,y(O,W,le))}),_}var Y0=Nl(function(m,y,_){Mu(m,y,_)}),gd=Nl(function(m,y,_,O){Mu(m,y,_,O)}),lh=zn(function(m,y){var _={};if(m==null)return _;var O=!1;y=Mn(y,function(le){return le=As(le,m),O||(O=le.length>1),le}),gi(m,Of(m),_),O&&(_=Fr(_,g|b|v,ay));for(var W=y.length;W--;)Fu(_,y[W]);return _});function wm(m,y){return Oc(m,ud(vt(y)))}var W0=zn(function(m,y){return m==null?{}:Vg(m,y)});function Oc(m,y){if(m==null)return{};var _=Mn(Of(m),function(O){return[O]});return y=vt(y),Cf(m,_,function(O,W){return y(O,W[0])})}function Q0(m,y,_){y=As(y,m);var O=-1,W=y.length;for(W||(W=1,m=t);++O<W;){var le=m==null?t:m[xn(y[O])];le===t&&(O=W,le=_),m=Ea(le)?le.call(m):le}return m}function dx(m,y,_){return m==null?m:mc(m,y,_)}function fx(m,y,_,O){return O=typeof O=="function"?O:t,m==null?m:mc(m,y,_,O)}var Sm=Yu(vr),Nm=Yu(_r);function Cm(m,y,_){var O=Mt(m),W=O||ko(m)||Pc(m);if(y=vt(y,4),_==null){var le=m&&m.constructor;W?_=O?new le:[]:Gn(m)?_=Ea(le)?Pi(bu(m)):{}:_={}}return(W?Or:$r)(m,function(me,we,_e){return y(_,me,we,_e)}),_}function hx(m,y){return m==null?!0:Fu(m,y)}function ch(m,y,_){return m==null?m:Mp(m,y,Bu(_))}function J0(m,y,_,O){return O=typeof O=="function"?O:t,m==null?m:Mp(m,y,Bu(_),O)}function Lc(m){return m==null?[]:ec(m,vr(m))}function jm(m){return m==null?[]:ec(m,_r(m))}function _m(m,y,_){return _===t&&(_=y,y=t),_!==t&&(_=ta(_),_=_===_?_:0),y!==t&&(y=ta(y),y=y===y?y:0),ja(ta(m),y,_)}function uh(m,y,_){return y=is(y),_===t?(_=y,y=0):_=is(_),m=ta(m),Ug(m,y,_)}function km(m,y,_){if(_&&typeof _!="boolean"&&Xr(m,y,_)&&(y=_=t),_===t&&(typeof y=="boolean"?(_=y,y=t):typeof m=="boolean"&&(_=m,m=t)),m===t&&y===t?(m=0,y=1):(m=is(m),y===t?(y=m,m=0):y=is(y)),m>y){var O=m;m=y,y=O}if(_||m%1||y%1){var W=hp();return qn(m+W*(y-m+Ga("1e-"+((W+"").length-1))),y)}return _f(m,y)}var px=Kr(function(m,y,_){return y=y.toLowerCase(),m+(_?dh(y):y)});function dh(m){return x(pn(m).toLowerCase())}function $s(m){return m=pn(m),m&&m.replace(Ua,tc).replace(ai,"")}function Eo(m,y,_){m=pn(m),y=mi(y);var O=m.length;_=_===t?O:ja(Ft(_),0,O);var W=_;return _-=y.length,_>=0&&m.slice(_,W)==y}function To(m){return m=pn(m),m&&dn.test(m)?m.replace(jn,Ss):m}function yd(m){return m=pn(m),m&&Fn.test(m)?m.replace(Xn,"\\$&"):m}var xd=Kr(function(m,y,_){return m+(_?"-":"")+y.toLowerCase()}),Ao=Kr(function(m,y,_){return m+(_?" ":"")+y.toLowerCase()}),K0=Ii("toLowerCase");function mx(m,y,_){m=pn(m),y=Ft(y);var O=y?Vi(m):0;if(!y||O>=y)return m;var W=(y-O)/2;return Gu(Cs(W),_)+m+Gu(oc(W),_)}function bd(m,y,_){m=pn(m),y=Ft(y);var O=y?Vi(m):0;return y&&O<y?m+Gu(y-O,_):m}function X0(m,y,_){m=pn(m),y=Ft(y);var O=y?Vi(m):0;return y&&O<y?Gu(y-O,_)+m:m}function gx(m,y,_){return _||y==null?y=0:y&&(y=+y),fl(pn(m).replace(za,""),y||0)}function fh(m,y,_){return(_?Xr(m,y,_):y===t)?y=1:y=Ft(y),Dp(pn(m),y)}function yx(){var m=arguments,y=pn(m[0]);return m.length<3?y:y.replace(m[1],m[2])}var Z0=Kr(function(m,y,_){return m+(_?"_":"")+y.toLowerCase()});function hh(m,y,_){return _&&typeof _!="number"&&Xr(m,y,_)&&(y=_=t),_=_===t?se:_>>>0,_?(m=pn(m),m&&(typeof y=="string"||y!=null&&!ih(y))&&(y=mi(y),!y&&Qa(m))?mo(li(m),0,_):m.split(y,_)):[]}var ph=Kr(function(m,y,_){return m+(_?" ":"")+x(y)});function xx(m,y,_){return m=pn(m),_=_==null?0:ja(Ft(_),0,m.length),y=mi(y),m.slice(_,_+y.length)==y}function vd(m,y,_){var O=ne.templateSettings;_&&Xr(m,y,_)&&(y=t),m=pn(m),y=sh({},y,O,Mf);var W=sh({},y.imports,O.imports,Mf),le=vr(W),me=ec(W,le),we,_e,Je=0,Xe=y.interpolate||qr,rt="__p += '",ft=ci((y.escape||qr).source+"|"+Xe.source+"|"+(Xe===ri?Ws:qr).source+"|"+(y.evaluate||qr).source+"|$","g"),gt="//# sourceURL="+(hn.call(y,"sourceURL")?(y.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Wd+"]")+`
`;m.replace(ft,function(Dt,nn,un,Aa,Fi,Pa){return un||(un=Aa),rt+=m.slice(Je,Pa).replace(Js,Zd),nn&&(we=!0,rt+=`' +
__e(`+nn+`) +
'`),Fi&&(_e=!0,rt+=`';
`+Fi+`;
__p += '`),un&&(rt+=`' +
((__t = (`+un+`)) == null ? '' : __t) +
'`),Je=Pa+Dt.length,Dt}),rt+=`';
`;var Pt=hn.call(y,"variable")&&y.variable;if(!Pt)rt=`with (obj) {
`+rt+`
}
`;else if(nu.test(Pt))throw new We(f);rt=(_e?rt.replace(et,""):rt).replace(bt,"$1").replace(Un,"$1;"),rt="function("+(Pt||"obj")+`) {
`+(Pt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(we?", __e = _.escape":"")+(_e?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+rt+`return __p
}`;var Qt=P(function(){return lt(le,gt+"return "+rt).apply(t,me)});if(Qt.source=rt,br(Qt))throw Qt;return Qt}function Em(m){return pn(m).toLowerCase()}function mh(m){return pn(m).toUpperCase()}function bx(m,y,_){if(m=pn(m),m&&(_||y===t))return Xd(m);if(!m||!(y=mi(y)))return m;var O=li(m),W=li(y),le=so(O,W),me=oo(O,W)+1;return mo(O,le,me).join("")}function ev(m,y,_){if(m=pn(m),m&&(_||y===t))return m.slice(0,gu(m)+1);if(!m||!(y=mi(y)))return m;var O=li(m),W=oo(O,li(y))+1;return mo(O,0,W).join("")}function gh(m,y,_){if(m=pn(m),m&&(_||y===t))return m.replace(za,"");if(!m||!(y=mi(y)))return m;var O=li(m),W=so(O,li(y));return mo(O,W).join("")}function o(m,y){var _=L,O=$;if(Gn(y)){var W="separator"in y?y.separator:W;_="length"in y?Ft(y.length):_,O="omission"in y?mi(y.omission):O}m=pn(m);var le=m.length;if(Qa(m)){var me=li(m);le=me.length}if(_>=le)return m;var we=_-Vi(O);if(we<1)return O;var _e=me?mo(me,0,we).join(""):m.slice(0,we);if(W===t)return _e+O;if(me&&(we+=_e.length-we),ih(W)){if(m.slice(we).search(W)){var Je,Xe=_e;for(W.global||(W=ci(W.source,pn(Ba.exec(W))+"g")),W.lastIndex=0;Je=W.exec(Xe);)var rt=Je.index;_e=_e.slice(0,rt===t?we:rt)}}else if(m.indexOf(mi(W),we)!=we){var ft=_e.lastIndexOf(W);ft>-1&&(_e=_e.slice(0,ft))}return _e+O}function c(m){return m=pn(m),m&&gn.test(m)?m.replace(Ln,rf):m}var p=Kr(function(m,y,_){return m+(_?" ":"")+y.toUpperCase()}),x=Ii("toUpperCase");function N(m,y,_){return m=pn(m),y=_?t:y,y===t?ef(m)?sf(m):sp(m):m.match(y)||[]}var P=$t(function(m,y){try{return ur(m,t,y)}catch(_){return br(_)?_:new We(_)}}),G=zn(function(m,y){return Or(y,function(_){_=xn(_),Ca(m,_,jo(m[_],m))}),m});function re(m){var y=m==null?0:m.length,_=vt();return m=y?Mn(m,function(O){if(typeof O[1]!="function")throw new Ai(l);return[_(O[0]),O[1]]}):[],$t(function(O){for(var W=-1;++W<y;){var le=m[W];if(ur(le[0],this,O))return ur(le[1],this,O)}})}function ye(m){return $g(Fr(m,g))}function Ae(m){return function(){return m}}function He(m,y){return m==null||m!==m?y:m}var Ke=Xa(),Oe=Xa(!0);function De(m){return m}function _t(m){return _p(typeof m=="function"?m:Fr(m,g))}function Nt(m){return Ep(Fr(m,g))}function kn(m,y){return Nf(m,Fr(y,g))}var je=$t(function(m,y){return function(_){return bl(_,m,y)}}),Se=$t(function(m,y){return function(_){return bl(m,_,y)}});function Te(m,y,_){var O=vr(y),W=po(y,O);_==null&&!(Gn(y)&&(W.length||!O.length))&&(_=y,y=m,m=this,W=po(y,vr(y)));var le=!(Gn(_)&&"chain"in _)||!!_.chain,me=Ea(m);return Or(W,function(we){var _e=y[we];m[we]=_e,me&&(m.prototype[we]=function(){var Je=this.__chain__;if(le||Je){var Xe=m(this.__wrapped__),rt=Xe.__actions__=gr(this.__actions__);return rt.push({func:_e,args:arguments,thisArg:m}),Xe.__chain__=Je,Xe}return _e.apply(m,xa([this.value()],arguments))})}),m}function Ye(){return Zn._===this&&(Zn._=ac),this}function pt(){}function Wt(m){return m=Ft(m),$t(function(y){return Tp(y,m)})}var yt=Hu(Mn),kt=Hu(rl),kr=Hu(pu);function cn(m){return zf(m)?il(xn(m)):Hg(m)}function Po(m){return function(y){return m==null?t:Ji(m,y)}}var tv=go(),iP=go(!0);function nv(){return[]}function rv(){return!1}function aP(){return{}}function sP(){return""}function oP(){return!0}function lP(m,y){if(m=Ft(m),m<1||m>K)return[];var _=se,O=qn(m,se);y=vt(y),m-=se;for(var W=ba(O,y);++_<m;)y(_);return W}function cP(m){return Mt(m)?Mn(m,xn):Zr(m)?[m]:gr(ts(pn(m)))}function uP(m){var y=++wa;return pn(m)+y}var dP=gc(function(m,y){return m+y},0),fP=If("ceil"),hP=gc(function(m,y){return m/y},1),pP=If("floor");function mP(m){return m&&m.length?_a(m,De,Pu):t}function gP(m,y){return m&&m.length?_a(m,vt(y,2),Pu):t}function yP(m){return qi(m,De)}function xP(m,y){return qi(m,vt(y,2))}function bP(m){return m&&m.length?_a(m,De,Sf):t}function vP(m,y){return m&&m.length?_a(m,vt(y,2),Sf):t}var wP=gc(function(m,y){return m*y},1),SP=If("round"),NP=gc(function(m,y){return m-y},0);function CP(m){return m&&m.length?io(m,De):0}function jP(m,y){return m&&m.length?io(m,vt(y,2)):0}return ne.after=k0,ne.ary=qy,ne.assign=F0,ne.assignIn=ax,ne.assignInWith=sh,ne.assignWith=$0,ne.at=z0,ne.before=sd,ne.bind=jo,ne.bindAll=G,ne.bindKey=Kf,ne.castArray=P0,ne.chain=Ec,ne.chunk=v0,ne.compact=gy,ne.concat=yy,ne.cond=re,ne.conforms=ye,ne.constant=Ae,ne.countBy=Tc,ne.create=B0,ne.curry=od,ne.curryRight=Xf,ne.debounce=_o,ne.defaults=U0,ne.defaultsDeep=sx,ne.defer=rs,ne.delay=ld,ne.difference=Hn,ne.differenceBy=yi,ne.differenceWith=Rs,ne.drop=xy,ne.dropRight=by,ne.dropRightWhile=w0,ne.dropWhile=Wp,ne.fill=Mi,ne.filter=Py,ne.flatMap=lm,ne.flatMapDeep=C0,ne.flatMapDepth=j0,ne.flatten=xi,ne.flattenDeep=vy,ne.flattenDepth=bo,ne.flip=E0,ne.flow=Ke,ne.flowRight=Oe,ne.fromPairs=kl,ne.functions=lx,ne.functionsIn=oh,ne.groupBy=My,ne.initial=Kp,ne.intersection=ns,ne.intersectionBy=wy,ne.intersectionWith=vc,ne.invert=cx,ne.invertBy=ux,ne.invokeMap=Wf,ne.iteratee=_t,ne.keyBy=Ry,ne.keys=vr,ne.keysIn=_r,ne.map=ad,ne.mapKeys=H0,ne.mapValues=G0,ne.matches=Nt,ne.matchesProperty=kn,ne.memoize=cd,ne.merge=Y0,ne.mergeWith=gd,ne.method=je,ne.methodOf=Se,ne.mixin=Te,ne.negate=ud,ne.nthArg=Wt,ne.omit=lh,ne.omitBy=wm,ne.once=Vy,ne.orderBy=Oy,ne.over=yt,ne.overArgs=Hy,ne.overEvery=kt,ne.overSome=kr,ne.partial=dm,ne.partialRight=Zf,ne.partition=Ly,ne.pick=W0,ne.pickBy=Oc,ne.property=cn,ne.propertyOf=Po,ne.pull=Ny,ne.pullAll=Sc,ne.pullAllBy=Cy,ne.pullAllWith=Gf,ne.pullAt=jy,ne.range=tv,ne.rangeRight=iP,ne.rearg=Gy,ne.reject=Qf,ne.remove=S0,ne.rest=Yy,ne.reverse=Xp,ne.sampleSize=By,ne.set=dx,ne.setWith=fx,ne.shuffle=Dn,ne.slice=vn,ne.sortBy=Uy,ne.sortedUniq=Nc,ne.sortedUniqBy=Zp,ne.split=hh,ne.spread=T0,ne.tail=Ls,ne.take=ar,ne.takeRight=wo,ne.takeRightWhile=El,ne.takeWhile=em,ne.tap=am,ne.throttle=fm,ne.thru=Br,ne.toArray=Li,ne.toPairs=Sm,ne.toPairsIn=Nm,ne.toPath=cP,ne.toPlainObject=ix,ne.transform=Cm,ne.unary=hm,ne.union=Zi,ne.unionBy=Cc,ne.unionWith=rd,ne.uniq=bi,ne.uniqBy=tm,ne.uniqWith=nm,ne.unset=hx,ne.unzip=jc,ne.unzipWith=id,ne.update=ch,ne.updateWith=J0,ne.values=Lc,ne.valuesIn=jm,ne.without=So,ne.words=N,ne.wrap=A0,ne.xor=Ir,ne.xorBy=No,ne.xorWith=_c,ne.zip=kc,ne.zipObject=rm,ne.zipObjectDeep=im,ne.zipWith=_y,ne.entries=Sm,ne.entriesIn=Nm,ne.extend=ax,ne.extendWith=sh,Te(ne,ne),ne.add=dP,ne.attempt=P,ne.camelCase=px,ne.capitalize=dh,ne.ceil=fP,ne.clamp=_m,ne.clone=dd,ne.cloneDeep=Wy,ne.cloneDeepWith=Kt,ne.cloneWith=D0,ne.conformsTo=pm,ne.deburr=$s,ne.defaultTo=He,ne.divide=hP,ne.endsWith=Eo,ne.eq=vi,ne.escape=To,ne.escapeRegExp=yd,ne.every=Ay,ne.find=Dy,ne.findIndex=Xi,ne.findKey=Ic,ne.findLast=om,ne.findLastIndex=Qp,ne.findLastKey=hd,ne.floor=pP,ne.forEach=Iy,ne.forEachRight=cm,ne.forIn=ox,ne.forInRight=q0,ne.forOwn=Mc,ne.forOwnRight=pd,ne.get=md,ne.gt=mm,ne.gte=Qy,ne.has=vm,ne.hasIn=Rc,ne.head=Os,ne.identity=De,ne.includes=Ac,ne.indexOf=Jp,ne.inRange=uh,ne.invoke=V0,ne.isArguments=Fs,ne.isArray=Mt,ne.isArrayBuffer=eh,ne.isArrayLike=xr,ne.isArrayLikeObject=sr,ne.isBoolean=I0,ne.isBuffer=ko,ne.isDate=Jy,ne.isElement=Ky,ne.isEmpty=th,ne.isEqual=_n,ne.isEqualWith=gm,ne.isError=br,ne.isFinite=M0,ne.isFunction=Ea,ne.isInteger=nh,ne.isLength=Tl,ne.isMap=rh,ne.isMatch=ym,ne.isMatchWith=R0,ne.isNaN=Xy,ne.isNative=O0,ne.isNil=L0,ne.isNull=Zy,ne.isNumber=ex,ne.isObject=Gn,ne.isObjectLike=er,ne.isPlainObject=ea,ne.isRegExp=ih,ne.isSafeInteger=xm,ne.isSet=tx,ne.isString=ah,ne.isSymbol=Zr,ne.isTypedArray=Pc,ne.isUndefined=Ta,ne.isWeakMap=bm,ne.isWeakSet=nx,ne.join=nd,ne.kebabCase=xd,ne.last=zr,ne.lastIndexOf=wc,ne.lowerCase=Ao,ne.lowerFirst=K0,ne.lt=rx,ne.lte=fd,ne.max=mP,ne.maxBy=gP,ne.mean=yP,ne.meanBy=xP,ne.min=bP,ne.minBy=vP,ne.stubArray=nv,ne.stubFalse=rv,ne.stubObject=aP,ne.stubString=sP,ne.stubTrue=oP,ne.multiply=wP,ne.nth=Sy,ne.noConflict=Ye,ne.noop=pt,ne.now=Jf,ne.pad=mx,ne.padEnd=bd,ne.padStart=X0,ne.parseInt=gx,ne.random=km,ne.reduce=Fy,ne.reduceRight=$y,ne.repeat=fh,ne.replace=yx,ne.result=Q0,ne.round=SP,ne.runInContext=Q,ne.sample=zy,ne.size=um,ne.snakeCase=Z0,ne.some=_0,ne.sortedIndex=Rn,ne.sortedIndexBy=Jt,ne.sortedIndexOf=on,ne.sortedLastIndex=wn,ne.sortedLastIndexBy=Ri,ne.sortedLastIndexOf=vo,ne.startCase=ph,ne.startsWith=xx,ne.subtract=NP,ne.sum=CP,ne.sumBy=jP,ne.template=vd,ne.times=lP,ne.toFinite=is,ne.toInteger=Ft,ne.toLength=as,ne.toLower=Em,ne.toNumber=ta,ne.toSafeInteger=Dc,ne.toString=pn,ne.toUpper=mh,ne.trim=bx,ne.trimEnd=ev,ne.trimStart=gh,ne.truncate=o,ne.unescape=c,ne.uniqueId=uP,ne.upperCase=p,ne.upperFirst=x,ne.each=Iy,ne.eachRight=cm,ne.first=Os,Te(ne,function(){var m={};return $r(ne,function(y,_){hn.call(ne.prototype,_)||(m[_]=y)}),m}(),{chain:!1}),ne.VERSION=r,Or(["bind","bindKey","curry","curryRight","partial","partialRight"],function(m){ne[m].placeholder=ne}),Or(["drop","take"],function(m,y){Yt.prototype[m]=function(_){_=_===t?1:$n(Ft(_),0);var O=this.__filtered__&&!y?new Yt(this):this.clone();return O.__filtered__?O.__takeCount__=qn(_,O.__takeCount__):O.__views__.push({size:qn(_,se),type:m+(O.__dir__<0?"Right":"")}),O},Yt.prototype[m+"Right"]=function(_){return this.reverse()[m](_).reverse()}}),Or(["filter","map","takeWhile"],function(m,y){var _=y+1,O=_==te||_==Z;Yt.prototype[m]=function(W){var le=this.clone();return le.__iteratees__.push({iteratee:vt(W,3),type:_}),le.__filtered__=le.__filtered__||O,le}}),Or(["head","last"],function(m,y){var _="take"+(y?"Right":"");Yt.prototype[m]=function(){return this[_](1).value()[0]}}),Or(["initial","tail"],function(m,y){var _="drop"+(y?"":"Right");Yt.prototype[m]=function(){return this.__filtered__?new Yt(this):this[_](1)}}),Yt.prototype.compact=function(){return this.filter(De)},Yt.prototype.find=function(m){return this.filter(m).head()},Yt.prototype.findLast=function(m){return this.reverse().find(m)},Yt.prototype.invokeMap=$t(function(m,y){return typeof m=="function"?new Yt(this):this.map(function(_){return bl(_,m,y)})}),Yt.prototype.reject=function(m){return this.filter(ud(vt(m)))},Yt.prototype.slice=function(m,y){m=Ft(m);var _=this;return _.__filtered__&&(m>0||y<0)?new Yt(_):(m<0?_=_.takeRight(-m):m&&(_=_.drop(m)),y!==t&&(y=Ft(y),_=y<0?_.dropRight(-y):_.take(y-m)),_)},Yt.prototype.takeRightWhile=function(m){return this.reverse().takeWhile(m).reverse()},Yt.prototype.toArray=function(){return this.take(se)},$r(Yt.prototype,function(m,y){var _=/^(?:filter|find|map|reject)|While$/.test(y),O=/^(?:head|last)$/.test(y),W=ne[O?"take"+(y=="last"?"Right":""):y],le=O||/^find/.test(y);W&&(ne.prototype[y]=function(){var me=this.__wrapped__,we=O?[1]:arguments,_e=me instanceof Yt,Je=we[0],Xe=_e||Mt(me),rt=function(nn){var un=W.apply(ne,xa([nn],we));return O&&ft?un[0]:un};Xe&&_&&typeof Je=="function"&&Je.length!=1&&(_e=Xe=!1);var ft=this.__chain__,gt=!!this.__actions__.length,Pt=le&&!ft,Qt=_e&&!gt;if(!le&&Xe){me=Qt?me:new Yt(this);var Dt=m.apply(me,we);return Dt.__actions__.push({func:Br,args:[rt],thisArg:t}),new fi(Dt,ft)}return Pt&&Qt?m.apply(this,we):(Dt=this.thru(rt),Pt?O?Dt.value()[0]:Dt.value():Dt)})}),Or(["pop","push","shift","sort","splice","unshift"],function(m){var y=lf[m],_=/^(?:push|sort|unshift)$/.test(m)?"tap":"thru",O=/^(?:pop|shift)$/.test(m);ne.prototype[m]=function(){var W=arguments;if(O&&!this.__chain__){var le=this.value();return y.apply(Mt(le)?le:[],W)}return this[_](function(me){return y.apply(Mt(me)?me:[],W)})}}),$r(Yt.prototype,function(m,y){var _=ne[y];if(_){var O=_.name+"";hn.call(Wi,O)||(Wi[O]=[]),Wi[O].push({name:y,func:_})}}),Wi[ir(t,T).name]=[{name:"wrapper",func:t}],Yt.prototype.clone=_u,Yt.prototype.reverse=ff,Yt.prototype.value=pl,ne.prototype.at=ky,ne.prototype.chain=Oi,ne.prototype.commit=Ey,ne.prototype.next=Ty,ne.prototype.plant=Co,ne.prototype.reverse=Yf,ne.prototype.toJSON=ne.prototype.valueOf=ne.prototype.value=sm,ne.prototype.first=ne.prototype.head,ul&&(ne.prototype[ul]=N0),ne},he=Ns();si?((si.exports=he)._=he,bs._=he):Zn._=he}).call(ZU)}(Qm,Qm.exports)),Qm.exports}var J2=e9();class t9{constructor(n){Yn(this,"sampleRate",24e3);Yn(this,"bufferSize",7680);Yn(this,"audioQueue",[]);Yn(this,"isPlaying",!1);Yn(this,"isStreamComplete",!1);Yn(this,"checkInterval",null);Yn(this,"scheduledTime",0);Yn(this,"initialBufferTime",.1);Yn(this,"gainNode");Yn(this,"source");Yn(this,"endOfQueueAudioSource",null);Yn(this,"onComplete",()=>{});this.context=n,this.gainNode=this.context.createGain(),this.source=this.context.createBufferSource(),this.gainNode.connect(this.context.destination),this.addPCM16=this.addPCM16.bind(this)}async addWorklet(n,t,r){let a=Ix.get(this.context);if(a&&a[n])return a[n].handlers.push(r),Promise.resolve(this);a||(Ix.set(this.context,{}),a=Ix.get(this.context)),a[n]={handlers:[r]};const s=L1(n,t);await this.context.audioWorklet.addModule(s);const l=new AudioWorkletNode(this.context,n);return a[n].node=l,this}_processPCM16Chunk(n){const t=new Float32Array(n.length/2),r=new DataView(n.buffer);for(let a=0;a<n.length/2;a++)try{const s=r.getInt16(a*2,!0);t[a]=s/32768}catch(s){console.error(s)}return t}addPCM16(n){this.isStreamComplete=!1;let t=this._processPCM16Chunk(n);for(;t.length>=this.bufferSize;){const r=t.slice(0,this.bufferSize);this.audioQueue.push(r),t=t.slice(this.bufferSize)}t.length>0&&this.audioQueue.push(t),this.isPlaying||(this.isPlaying=!0,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.scheduleNextBuffer())}createAudioBuffer(n){const t=this.context.createBuffer(1,n.length,this.sampleRate);return t.getChannelData(0).set(n),t}scheduleNextBuffer(){for(;this.audioQueue.length>0&&this.scheduledTime<this.context.currentTime+.2;){const t=this.audioQueue.shift(),r=this.createAudioBuffer(t),a=this.context.createBufferSource();this.audioQueue.length===0&&(this.endOfQueueAudioSource&&(this.endOfQueueAudioSource.onended=null),this.endOfQueueAudioSource=a,a.onended=()=>{!this.audioQueue.length&&this.endOfQueueAudioSource===a&&(this.endOfQueueAudioSource=null,this.onComplete())}),a.buffer=r,a.connect(this.gainNode);const s=Ix.get(this.context);s&&Object.entries(s).forEach(([,f])=>{const{node:d,handlers:u}=f;d&&(a.connect(d),d.port.onmessage=function(h){u.forEach(g=>{g.call(d.port,h)})},d.connect(this.context.destination))});const l=Math.max(this.scheduledTime,this.context.currentTime);a.start(l),this.scheduledTime=l+r.duration}if(this.audioQueue.length===0)this.isStreamComplete?(this.isPlaying=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)):this.checkInterval||(this.checkInterval=window.setInterval(()=>{this.audioQueue.length>0&&this.scheduleNextBuffer()},100));else{const t=(this.scheduledTime-this.context.currentTime)*1e3;setTimeout(()=>this.scheduleNextBuffer(),Math.max(0,t-50))}}stop(){this.isPlaying=!1,this.isStreamComplete=!0,this.audioQueue=[],this.scheduledTime=this.context.currentTime,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.gainNode.gain.linearRampToValueAtTime(0,this.context.currentTime+.1),setTimeout(()=>{this.gainNode.disconnect(),this.gainNode=this.context.createGain(),this.gainNode.connect(this.context.destination)},200)}async resume(){this.context.state==="suspended"&&await this.context.resume(),this.isStreamComplete=!1,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.gainNode.gain.setValueAtTime(1,this.context.currentTime)}complete(){this.isStreamComplete=!0,this.onComplete()}}function K2(e,n){return function(){return e.apply(n,arguments)}}const{toString:n9}=Object.prototype,{getPrototypeOf:Yw}=Object,Zb=(e=>n=>{const t=n9.call(n);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Gs=e=>(e=e.toLowerCase(),n=>Zb(n)===e),e0=e=>n=>typeof n===e,{isArray:Yh}=Array,ug=e0("undefined");function r9(e){return e!==null&&!ug(e)&&e.constructor!==null&&!ug(e.constructor)&&La(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const X2=Gs("ArrayBuffer");function i9(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&X2(e.buffer),n}const a9=e0("string"),La=e0("function"),Z2=e0("number"),t0=e=>e!==null&&typeof e=="object",s9=e=>e===!0||e===!1,eb=e=>{if(Zb(e)!=="object")return!1;const n=Yw(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},o9=Gs("Date"),l9=Gs("File"),c9=Gs("Blob"),u9=Gs("FileList"),d9=e=>t0(e)&&La(e.pipe),f9=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||La(e.append)&&((n=Zb(e))==="formdata"||n==="object"&&La(e.toString)&&e.toString()==="[object FormData]"))},h9=Gs("URLSearchParams"),[p9,m9,g9,y9]=["ReadableStream","Request","Response","Headers"].map(Gs),x9=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function vg(e,n,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let r,a;if(typeof e!="object"&&(e=[e]),Yh(e))for(r=0,a=e.length;r<a;r++)n.call(null,e[r],r,e);else{const s=t?Object.getOwnPropertyNames(e):Object.keys(e),l=s.length;let f;for(r=0;r<l;r++)f=s[r],n.call(null,e[f],f,e)}}function eE(e,n){n=n.toLowerCase();const t=Object.keys(e);let r=t.length,a;for(;r-- >0;)if(a=t[r],n===a.toLowerCase())return a;return null}const Td=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,tE=e=>!ug(e)&&e!==Td;function F1(){const{caseless:e}=tE(this)&&this||{},n={},t=(r,a)=>{const s=e&&eE(n,a)||a;eb(n[s])&&eb(r)?n[s]=F1(n[s],r):eb(r)?n[s]=F1({},r):Yh(r)?n[s]=r.slice():n[s]=r};for(let r=0,a=arguments.length;r<a;r++)arguments[r]&&vg(arguments[r],t);return n}const b9=(e,n,t,{allOwnKeys:r}={})=>(vg(n,(a,s)=>{t&&La(a)?e[s]=K2(a,t):e[s]=a},{allOwnKeys:r}),e),v9=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),w9=(e,n,t,r)=>{e.prototype=Object.create(n.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),t&&Object.assign(e.prototype,t)},S9=(e,n,t,r)=>{let a,s,l;const f={};if(n=n||{},e==null)return n;do{for(a=Object.getOwnPropertyNames(e),s=a.length;s-- >0;)l=a[s],(!r||r(l,e,n))&&!f[l]&&(n[l]=e[l],f[l]=!0);e=t!==!1&&Yw(e)}while(e&&(!t||t(e,n))&&e!==Object.prototype);return n},N9=(e,n,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=n.length;const r=e.indexOf(n,t);return r!==-1&&r===t},C9=e=>{if(!e)return null;if(Yh(e))return e;let n=e.length;if(!Z2(n))return null;const t=new Array(n);for(;n-- >0;)t[n]=e[n];return t},j9=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&Yw(Uint8Array)),_9=(e,n)=>{const r=(e&&e[Symbol.iterator]).call(e);let a;for(;(a=r.next())&&!a.done;){const s=a.value;n.call(e,s[0],s[1])}},k9=(e,n)=>{let t;const r=[];for(;(t=e.exec(n))!==null;)r.push(t);return r},E9=Gs("HTMLFormElement"),T9=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,a){return r.toUpperCase()+a}),QC=(({hasOwnProperty:e})=>(n,t)=>e.call(n,t))(Object.prototype),A9=Gs("RegExp"),nE=(e,n)=>{const t=Object.getOwnPropertyDescriptors(e),r={};vg(t,(a,s)=>{let l;(l=n(a,s,e))!==!1&&(r[s]=l||a)}),Object.defineProperties(e,r)},P9=e=>{nE(e,(n,t)=>{if(La(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=e[t];if(La(r)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},D9=(e,n)=>{const t={},r=a=>{a.forEach(s=>{t[s]=!0})};return Yh(e)?r(e):r(String(e).split(n)),t},I9=()=>{},M9=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n;function R9(e){return!!(e&&La(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const O9=e=>{const n=new Array(10),t=(r,a)=>{if(t0(r)){if(n.indexOf(r)>=0)return;if(!("toJSON"in r)){n[a]=r;const s=Yh(r)?[]:{};return vg(r,(l,f)=>{const d=t(l,a+1);!ug(d)&&(s[f]=d)}),n[a]=void 0,s}}return r};return t(e,0)},L9=Gs("AsyncFunction"),F9=e=>e&&(t0(e)||La(e))&&La(e.then)&&La(e.catch),rE=((e,n)=>e?setImmediate:n?((t,r)=>(Td.addEventListener("message",({source:a,data:s})=>{a===Td&&s===t&&r.length&&r.shift()()},!1),a=>{r.push(a),Td.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",La(Td.postMessage)),$9=typeof queueMicrotask<"u"?queueMicrotask.bind(Td):typeof process<"u"&&process.nextTick||rE,$e={isArray:Yh,isArrayBuffer:X2,isBuffer:r9,isFormData:f9,isArrayBufferView:i9,isString:a9,isNumber:Z2,isBoolean:s9,isObject:t0,isPlainObject:eb,isReadableStream:p9,isRequest:m9,isResponse:g9,isHeaders:y9,isUndefined:ug,isDate:o9,isFile:l9,isBlob:c9,isRegExp:A9,isFunction:La,isStream:d9,isURLSearchParams:h9,isTypedArray:j9,isFileList:u9,forEach:vg,merge:F1,extend:b9,trim:x9,stripBOM:v9,inherits:w9,toFlatObject:S9,kindOf:Zb,kindOfTest:Gs,endsWith:N9,toArray:C9,forEachEntry:_9,matchAll:k9,isHTMLForm:E9,hasOwnProperty:QC,hasOwnProp:QC,reduceDescriptors:nE,freezeMethods:P9,toObjectSet:D9,toCamelCase:T9,noop:I9,toFiniteNumber:M9,findKey:eE,global:Td,isContextDefined:tE,isSpecCompliantForm:R9,toJSONObject:O9,isAsyncFn:L9,isThenable:F9,setImmediate:rE,asap:$9};function Bt(e,n,t,r,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),t&&(this.config=t),r&&(this.request=r),a&&(this.response=a,this.status=a.status?a.status:null)}$e.inherits(Bt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:$e.toJSONObject(this.config),code:this.code,status:this.status}}});const iE=Bt.prototype,aE={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{aE[e]={value:e}});Object.defineProperties(Bt,aE);Object.defineProperty(iE,"isAxiosError",{value:!0});Bt.from=(e,n,t,r,a,s)=>{const l=Object.create(iE);return $e.toFlatObject(e,l,function(d){return d!==Error.prototype},f=>f!=="isAxiosError"),Bt.call(l,e.message,n,t,r,a),l.cause=e,l.name=e.name,s&&Object.assign(l,s),l};const z9=null;function $1(e){return $e.isPlainObject(e)||$e.isArray(e)}function sE(e){return $e.endsWith(e,"[]")?e.slice(0,-2):e}function JC(e,n,t){return e?e.concat(n).map(function(a,s){return a=sE(a),!t&&s?"["+a+"]":a}).join(t?".":""):n}function B9(e){return $e.isArray(e)&&!e.some($1)}const U9=$e.toFlatObject($e,{},null,function(n){return/^is[A-Z]/.test(n)});function n0(e,n,t){if(!$e.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,t=$e.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(k,E){return!$e.isUndefined(E[k])});const r=t.metaTokens,a=t.visitor||h,s=t.dots,l=t.indexes,d=(t.Blob||typeof Blob<"u"&&Blob)&&$e.isSpecCompliantForm(n);if(!$e.isFunction(a))throw new TypeError("visitor must be a function");function u(S){if(S===null)return"";if($e.isDate(S))return S.toISOString();if(!d&&$e.isBlob(S))throw new Bt("Blob is not supported. Use a Buffer instead.");return $e.isArrayBuffer(S)||$e.isTypedArray(S)?d&&typeof Blob=="function"?new Blob([S]):Buffer.from(S):S}function h(S,k,E){let T=S;if(S&&!E&&typeof S=="object"){if($e.endsWith(k,"{}"))k=r?k:k.slice(0,-2),S=JSON.stringify(S);else if($e.isArray(S)&&B9(S)||($e.isFileList(S)||$e.endsWith(k,"[]"))&&(T=$e.toArray(S)))return k=sE(k),T.forEach(function(D,q){!($e.isUndefined(D)||D===null)&&n.append(l===!0?JC([k],q,s):l===null?k:k+"[]",u(D))}),!1}return $1(S)?!0:(n.append(JC(E,k,s),u(S)),!1)}const g=[],b=Object.assign(U9,{defaultVisitor:h,convertValue:u,isVisitable:$1});function v(S,k){if(!$e.isUndefined(S)){if(g.indexOf(S)!==-1)throw Error("Circular reference detected in "+k.join("."));g.push(S),$e.forEach(S,function(T,I){(!($e.isUndefined(T)||T===null)&&a.call(n,T,$e.isString(I)?I.trim():I,k,b))===!0&&v(T,k?k.concat(I):[I])}),g.pop()}}if(!$e.isObject(e))throw new TypeError("data must be an object");return v(e),n}function KC(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return n[r]})}function Ww(e,n){this._pairs=[],e&&n0(e,this,n)}const oE=Ww.prototype;oE.append=function(n,t){this._pairs.push([n,t])};oE.toString=function(n){const t=n?function(r){return n.call(this,r,KC)}:KC;return this._pairs.map(function(a){return t(a[0])+"="+t(a[1])},"").join("&")};function q9(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function lE(e,n,t){if(!n)return e;const r=t&&t.encode||q9;$e.isFunction(t)&&(t={serialize:t});const a=t&&t.serialize;let s;if(a?s=a(n,t):s=$e.isURLSearchParams(n)?n.toString():new Ww(n,t).toString(r),s){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class XC{constructor(){this.handlers=[]}use(n,t,r){return this.handlers.push({fulfilled:n,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){$e.forEach(this.handlers,function(r){r!==null&&n(r)})}}const cE={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},V9=typeof URLSearchParams<"u"?URLSearchParams:Ww,H9=typeof FormData<"u"?FormData:null,G9=typeof Blob<"u"?Blob:null,Y9={isBrowser:!0,classes:{URLSearchParams:V9,FormData:H9,Blob:G9},protocols:["http","https","file","blob","url","data"]},Qw=typeof window<"u"&&typeof document<"u",z1=typeof navigator=="object"&&navigator||void 0,W9=Qw&&(!z1||["ReactNative","NativeScript","NS"].indexOf(z1.product)<0),Q9=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",J9=Qw&&window.location.href||"http://localhost",K9=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Qw,hasStandardBrowserEnv:W9,hasStandardBrowserWebWorkerEnv:Q9,navigator:z1,origin:J9},Symbol.toStringTag,{value:"Module"})),Ci={...K9,...Y9};function X9(e,n){return n0(e,new Ci.classes.URLSearchParams,Object.assign({visitor:function(t,r,a,s){return Ci.isNode&&$e.isBuffer(t)?(this.append(r,t.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},n))}function Z9(e){return $e.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function e7(e){const n={},t=Object.keys(e);let r;const a=t.length;let s;for(r=0;r<a;r++)s=t[r],n[s]=e[s];return n}function uE(e){function n(t,r,a,s){let l=t[s++];if(l==="__proto__")return!0;const f=Number.isFinite(+l),d=s>=t.length;return l=!l&&$e.isArray(a)?a.length:l,d?($e.hasOwnProp(a,l)?a[l]=[a[l],r]:a[l]=r,!f):((!a[l]||!$e.isObject(a[l]))&&(a[l]=[]),n(t,r,a[l],s)&&$e.isArray(a[l])&&(a[l]=e7(a[l])),!f)}if($e.isFormData(e)&&$e.isFunction(e.entries)){const t={};return $e.forEachEntry(e,(r,a)=>{n(Z9(r),a,t,0)}),t}return null}function t7(e,n,t){if($e.isString(e))try{return(n||JSON.parse)(e),$e.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(e)}const wg={transitional:cE,adapter:["xhr","http","fetch"],transformRequest:[function(n,t){const r=t.getContentType()||"",a=r.indexOf("application/json")>-1,s=$e.isObject(n);if(s&&$e.isHTMLForm(n)&&(n=new FormData(n)),$e.isFormData(n))return a?JSON.stringify(uE(n)):n;if($e.isArrayBuffer(n)||$e.isBuffer(n)||$e.isStream(n)||$e.isFile(n)||$e.isBlob(n)||$e.isReadableStream(n))return n;if($e.isArrayBufferView(n))return n.buffer;if($e.isURLSearchParams(n))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let f;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return X9(n,this.formSerializer).toString();if((f=$e.isFileList(n))||r.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return n0(f?{"files[]":n}:n,d&&new d,this.formSerializer)}}return s||a?(t.setContentType("application/json",!1),t7(n)):n}],transformResponse:[function(n){const t=this.transitional||wg.transitional,r=t&&t.forcedJSONParsing,a=this.responseType==="json";if($e.isResponse(n)||$e.isReadableStream(n))return n;if(n&&$e.isString(n)&&(r&&!this.responseType||a)){const l=!(t&&t.silentJSONParsing)&&a;try{return JSON.parse(n)}catch(f){if(l)throw f.name==="SyntaxError"?Bt.from(f,Bt.ERR_BAD_RESPONSE,this,null,this.response):f}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ci.classes.FormData,Blob:Ci.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};$e.forEach(["delete","get","head","post","put","patch"],e=>{wg.headers[e]={}});const n7=$e.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),r7=e=>{const n={};let t,r,a;return e&&e.split(`
`).forEach(function(l){a=l.indexOf(":"),t=l.substring(0,a).trim().toLowerCase(),r=l.substring(a+1).trim(),!(!t||n[t]&&n7[t])&&(t==="set-cookie"?n[t]?n[t].push(r):n[t]=[r]:n[t]=n[t]?n[t]+", "+r:r)}),n},ZC=Symbol("internals");function $m(e){return e&&String(e).trim().toLowerCase()}function tb(e){return e===!1||e==null?e:$e.isArray(e)?e.map(tb):String(e)}function i7(e){const n=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(e);)n[r[1]]=r[2];return n}const a7=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Ev(e,n,t,r,a){if($e.isFunction(r))return r.call(this,n,t);if(a&&(n=t),!!$e.isString(n)){if($e.isString(r))return n.indexOf(r)!==-1;if($e.isRegExp(r))return r.test(n)}}function s7(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,t,r)=>t.toUpperCase()+r)}function o7(e,n){const t=$e.toCamelCase(" "+n);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+t,{value:function(a,s,l){return this[r].call(this,n,a,s,l)},configurable:!0})})}let sa=class{constructor(n){n&&this.set(n)}set(n,t,r){const a=this;function s(f,d,u){const h=$m(d);if(!h)throw new Error("header name must be a non-empty string");const g=$e.findKey(a,h);(!g||a[g]===void 0||u===!0||u===void 0&&a[g]!==!1)&&(a[g||d]=tb(f))}const l=(f,d)=>$e.forEach(f,(u,h)=>s(u,h,d));if($e.isPlainObject(n)||n instanceof this.constructor)l(n,t);else if($e.isString(n)&&(n=n.trim())&&!a7(n))l(r7(n),t);else if($e.isHeaders(n))for(const[f,d]of n.entries())s(d,f,r);else n!=null&&s(t,n,r);return this}get(n,t){if(n=$m(n),n){const r=$e.findKey(this,n);if(r){const a=this[r];if(!t)return a;if(t===!0)return i7(a);if($e.isFunction(t))return t.call(this,a,r);if($e.isRegExp(t))return t.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,t){if(n=$m(n),n){const r=$e.findKey(this,n);return!!(r&&this[r]!==void 0&&(!t||Ev(this,this[r],r,t)))}return!1}delete(n,t){const r=this;let a=!1;function s(l){if(l=$m(l),l){const f=$e.findKey(r,l);f&&(!t||Ev(r,r[f],f,t))&&(delete r[f],a=!0)}}return $e.isArray(n)?n.forEach(s):s(n),a}clear(n){const t=Object.keys(this);let r=t.length,a=!1;for(;r--;){const s=t[r];(!n||Ev(this,this[s],s,n,!0))&&(delete this[s],a=!0)}return a}normalize(n){const t=this,r={};return $e.forEach(this,(a,s)=>{const l=$e.findKey(r,s);if(l){t[l]=tb(a),delete t[s];return}const f=n?s7(s):String(s).trim();f!==s&&delete t[s],t[f]=tb(a),r[f]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const t=Object.create(null);return $e.forEach(this,(r,a)=>{r!=null&&r!==!1&&(t[a]=n&&$e.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,t])=>n+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...t){const r=new this(n);return t.forEach(a=>r.set(a)),r}static accessor(n){const r=(this[ZC]=this[ZC]={accessors:{}}).accessors,a=this.prototype;function s(l){const f=$m(l);r[f]||(o7(a,l),r[f]=!0)}return $e.isArray(n)?n.forEach(s):s(n),this}};sa.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);$e.reduceDescriptors(sa.prototype,({value:e},n)=>{let t=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(r){this[t]=r}}});$e.freezeMethods(sa);function Tv(e,n){const t=this||wg,r=n||t,a=sa.from(r.headers);let s=r.data;return $e.forEach(e,function(f){s=f.call(t,s,a.normalize(),n?n.status:void 0)}),a.normalize(),s}function dE(e){return!!(e&&e.__CANCEL__)}function Wh(e,n,t){Bt.call(this,e??"canceled",Bt.ERR_CANCELED,n,t),this.name="CanceledError"}$e.inherits(Wh,Bt,{__CANCEL__:!0});function fE(e,n,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?e(t):n(new Bt("Request failed with status code "+t.status,[Bt.ERR_BAD_REQUEST,Bt.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function l7(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function c7(e,n){e=e||10;const t=new Array(e),r=new Array(e);let a=0,s=0,l;return n=n!==void 0?n:1e3,function(d){const u=Date.now(),h=r[s];l||(l=u),t[a]=d,r[a]=u;let g=s,b=0;for(;g!==a;)b+=t[g++],g=g%e;if(a=(a+1)%e,a===s&&(s=(s+1)%e),u-l<n)return;const v=h&&u-h;return v?Math.round(b*1e3/v):void 0}}function u7(e,n){let t=0,r=1e3/n,a,s;const l=(u,h=Date.now())=>{t=h,a=null,s&&(clearTimeout(s),s=null),e.apply(null,u)};return[(...u)=>{const h=Date.now(),g=h-t;g>=r?l(u,h):(a=u,s||(s=setTimeout(()=>{s=null,l(a)},r-g)))},()=>a&&l(a)]}const _b=(e,n,t=3)=>{let r=0;const a=c7(50,250);return u7(s=>{const l=s.loaded,f=s.lengthComputable?s.total:void 0,d=l-r,u=a(d),h=l<=f;r=l;const g={loaded:l,total:f,progress:f?l/f:void 0,bytes:d,rate:u||void 0,estimated:u&&f&&h?(f-l)/u:void 0,event:s,lengthComputable:f!=null,[n?"download":"upload"]:!0};e(g)},t)},ej=(e,n)=>{const t=e!=null;return[r=>n[0]({lengthComputable:t,total:e,loaded:r}),n[1]]},tj=e=>(...n)=>$e.asap(()=>e(...n)),d7=Ci.hasStandardBrowserEnv?((e,n)=>t=>(t=new URL(t,Ci.origin),e.protocol===t.protocol&&e.host===t.host&&(n||e.port===t.port)))(new URL(Ci.origin),Ci.navigator&&/(msie|trident)/i.test(Ci.navigator.userAgent)):()=>!0,f7=Ci.hasStandardBrowserEnv?{write(e,n,t,r,a,s){const l=[e+"="+encodeURIComponent(n)];$e.isNumber(t)&&l.push("expires="+new Date(t).toGMTString()),$e.isString(r)&&l.push("path="+r),$e.isString(a)&&l.push("domain="+a),s===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function h7(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function p7(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function hE(e,n,t){let r=!h7(n);return e&&(r||t==!1)?p7(e,n):n}const nj=e=>e instanceof sa?{...e}:e;function Fd(e,n){n=n||{};const t={};function r(u,h,g,b){return $e.isPlainObject(u)&&$e.isPlainObject(h)?$e.merge.call({caseless:b},u,h):$e.isPlainObject(h)?$e.merge({},h):$e.isArray(h)?h.slice():h}function a(u,h,g,b){if($e.isUndefined(h)){if(!$e.isUndefined(u))return r(void 0,u,g,b)}else return r(u,h,g,b)}function s(u,h){if(!$e.isUndefined(h))return r(void 0,h)}function l(u,h){if($e.isUndefined(h)){if(!$e.isUndefined(u))return r(void 0,u)}else return r(void 0,h)}function f(u,h,g){if(g in n)return r(u,h);if(g in e)return r(void 0,u)}const d={url:s,method:s,data:s,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:f,headers:(u,h,g)=>a(nj(u),nj(h),g,!0)};return $e.forEach(Object.keys(Object.assign({},e,n)),function(h){const g=d[h]||a,b=g(e[h],n[h],h);$e.isUndefined(b)&&g!==f||(t[h]=b)}),t}const pE=e=>{const n=Fd({},e);let{data:t,withXSRFToken:r,xsrfHeaderName:a,xsrfCookieName:s,headers:l,auth:f}=n;n.headers=l=sa.from(l),n.url=lE(hE(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),f&&l.set("Authorization","Basic "+btoa((f.username||"")+":"+(f.password?unescape(encodeURIComponent(f.password)):"")));let d;if($e.isFormData(t)){if(Ci.hasStandardBrowserEnv||Ci.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((d=l.getContentType())!==!1){const[u,...h]=d?d.split(";").map(g=>g.trim()).filter(Boolean):[];l.setContentType([u||"multipart/form-data",...h].join("; "))}}if(Ci.hasStandardBrowserEnv&&(r&&$e.isFunction(r)&&(r=r(n)),r||r!==!1&&d7(n.url))){const u=a&&s&&f7.read(s);u&&l.set(a,u)}return n},m7=typeof XMLHttpRequest<"u",g7=m7&&function(e){return new Promise(function(t,r){const a=pE(e);let s=a.data;const l=sa.from(a.headers).normalize();let{responseType:f,onUploadProgress:d,onDownloadProgress:u}=a,h,g,b,v,S;function k(){v&&v(),S&&S(),a.cancelToken&&a.cancelToken.unsubscribe(h),a.signal&&a.signal.removeEventListener("abort",h)}let E=new XMLHttpRequest;E.open(a.method.toUpperCase(),a.url,!0),E.timeout=a.timeout;function T(){if(!E)return;const D=sa.from("getAllResponseHeaders"in E&&E.getAllResponseHeaders()),R={data:!f||f==="text"||f==="json"?E.responseText:E.response,status:E.status,statusText:E.statusText,headers:D,config:e,request:E};fE(function(U){t(U),k()},function(U){r(U),k()},R),E=null}"onloadend"in E?E.onloadend=T:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout(T)},E.onabort=function(){E&&(r(new Bt("Request aborted",Bt.ECONNABORTED,e,E)),E=null)},E.onerror=function(){r(new Bt("Network Error",Bt.ERR_NETWORK,e,E)),E=null},E.ontimeout=function(){let q=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const R=a.transitional||cE;a.timeoutErrorMessage&&(q=a.timeoutErrorMessage),r(new Bt(q,R.clarifyTimeoutError?Bt.ETIMEDOUT:Bt.ECONNABORTED,e,E)),E=null},s===void 0&&l.setContentType(null),"setRequestHeader"in E&&$e.forEach(l.toJSON(),function(q,R){E.setRequestHeader(R,q)}),$e.isUndefined(a.withCredentials)||(E.withCredentials=!!a.withCredentials),f&&f!=="json"&&(E.responseType=a.responseType),u&&([b,S]=_b(u,!0),E.addEventListener("progress",b)),d&&E.upload&&([g,v]=_b(d),E.upload.addEventListener("progress",g),E.upload.addEventListener("loadend",v)),(a.cancelToken||a.signal)&&(h=D=>{E&&(r(!D||D.type?new Wh(null,e,E):D),E.abort(),E=null)},a.cancelToken&&a.cancelToken.subscribe(h),a.signal&&(a.signal.aborted?h():a.signal.addEventListener("abort",h)));const I=l7(a.url);if(I&&Ci.protocols.indexOf(I)===-1){r(new Bt("Unsupported protocol "+I+":",Bt.ERR_BAD_REQUEST,e));return}E.send(s||null)})},y7=(e,n)=>{const{length:t}=e=e?e.filter(Boolean):[];if(n||t){let r=new AbortController,a;const s=function(u){if(!a){a=!0,f();const h=u instanceof Error?u:this.reason;r.abort(h instanceof Bt?h:new Wh(h instanceof Error?h.message:h))}};let l=n&&setTimeout(()=>{l=null,s(new Bt(`timeout ${n} of ms exceeded`,Bt.ETIMEDOUT))},n);const f=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(s):u.removeEventListener("abort",s)}),e=null)};e.forEach(u=>u.addEventListener("abort",s));const{signal:d}=r;return d.unsubscribe=()=>$e.asap(f),d}},x7=function*(e,n){let t=e.byteLength;if(t<n){yield e;return}let r=0,a;for(;r<t;)a=r+n,yield e.slice(r,a),r=a},b7=async function*(e,n){for await(const t of v7(e))yield*x7(t,n)},v7=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const n=e.getReader();try{for(;;){const{done:t,value:r}=await n.read();if(t)break;yield r}}finally{await n.cancel()}},rj=(e,n,t,r)=>{const a=b7(e,n);let s=0,l,f=d=>{l||(l=!0,r&&r(d))};return new ReadableStream({async pull(d){try{const{done:u,value:h}=await a.next();if(u){f(),d.close();return}let g=h.byteLength;if(t){let b=s+=g;t(b)}d.enqueue(new Uint8Array(h))}catch(u){throw f(u),u}},cancel(d){return f(d),a.return()}},{highWaterMark:2})},r0=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",mE=r0&&typeof ReadableStream=="function",w7=r0&&(typeof TextEncoder=="function"?(e=>n=>e.encode(n))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),gE=(e,...n)=>{try{return!!e(...n)}catch{return!1}},S7=mE&&gE(()=>{let e=!1;const n=new Request(Ci.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!n}),ij=64*1024,B1=mE&&gE(()=>$e.isReadableStream(new Response("").body)),kb={stream:B1&&(e=>e.body)};r0&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!kb[n]&&(kb[n]=$e.isFunction(e[n])?t=>t[n]():(t,r)=>{throw new Bt(`Response type '${n}' is not supported`,Bt.ERR_NOT_SUPPORT,r)})})})(new Response);const N7=async e=>{if(e==null)return 0;if($e.isBlob(e))return e.size;if($e.isSpecCompliantForm(e))return(await new Request(Ci.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if($e.isArrayBufferView(e)||$e.isArrayBuffer(e))return e.byteLength;if($e.isURLSearchParams(e)&&(e=e+""),$e.isString(e))return(await w7(e)).byteLength},C7=async(e,n)=>{const t=$e.toFiniteNumber(e.getContentLength());return t??N7(n)},j7=r0&&(async e=>{let{url:n,method:t,data:r,signal:a,cancelToken:s,timeout:l,onDownloadProgress:f,onUploadProgress:d,responseType:u,headers:h,withCredentials:g="same-origin",fetchOptions:b}=pE(e);u=u?(u+"").toLowerCase():"text";let v=y7([a,s&&s.toAbortSignal()],l),S;const k=v&&v.unsubscribe&&(()=>{v.unsubscribe()});let E;try{if(d&&S7&&t!=="get"&&t!=="head"&&(E=await C7(h,r))!==0){let R=new Request(n,{method:"POST",body:r,duplex:"half"}),F;if($e.isFormData(r)&&(F=R.headers.get("content-type"))&&h.setContentType(F),R.body){const[U,z]=ej(E,_b(tj(d)));r=rj(R.body,ij,U,z)}}$e.isString(g)||(g=g?"include":"omit");const T="credentials"in Request.prototype;S=new Request(n,{...b,signal:v,method:t.toUpperCase(),headers:h.normalize().toJSON(),body:r,duplex:"half",credentials:T?g:void 0});let I=await fetch(S);const D=B1&&(u==="stream"||u==="response");if(B1&&(f||D&&k)){const R={};["status","statusText","headers"].forEach(V=>{R[V]=I[V]});const F=$e.toFiniteNumber(I.headers.get("content-length")),[U,z]=f&&ej(F,_b(tj(f),!0))||[];I=new Response(rj(I.body,ij,U,()=>{z&&z(),k&&k()}),R)}u=u||"text";let q=await kb[$e.findKey(kb,u)||"text"](I,e);return!D&&k&&k(),await new Promise((R,F)=>{fE(R,F,{data:q,headers:sa.from(I.headers),status:I.status,statusText:I.statusText,config:e,request:S})})}catch(T){throw k&&k(),T&&T.name==="TypeError"&&/fetch/i.test(T.message)?Object.assign(new Bt("Network Error",Bt.ERR_NETWORK,e,S),{cause:T.cause||T}):Bt.from(T,T&&T.code,e,S)}}),U1={http:z9,xhr:g7,fetch:j7};$e.forEach(U1,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const aj=e=>`- ${e}`,_7=e=>$e.isFunction(e)||e===null||e===!1,yE={getAdapter:e=>{e=$e.isArray(e)?e:[e];const{length:n}=e;let t,r;const a={};for(let s=0;s<n;s++){t=e[s];let l;if(r=t,!_7(t)&&(r=U1[(l=String(t)).toLowerCase()],r===void 0))throw new Bt(`Unknown adapter '${l}'`);if(r)break;a[l||"#"+s]=r}if(!r){const s=Object.entries(a).map(([f,d])=>`adapter ${f} `+(d===!1?"is not supported by the environment":"is not available in the build"));let l=n?s.length>1?`since :
`+s.map(aj).join(`
`):" "+aj(s[0]):"as no adapter specified";throw new Bt("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return r},adapters:U1};function Av(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Wh(null,e)}function sj(e){return Av(e),e.headers=sa.from(e.headers),e.data=Tv.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),yE.getAdapter(e.adapter||wg.adapter)(e).then(function(r){return Av(e),r.data=Tv.call(e,e.transformResponse,r),r.headers=sa.from(r.headers),r},function(r){return dE(r)||(Av(e),r&&r.response&&(r.response.data=Tv.call(e,e.transformResponse,r.response),r.response.headers=sa.from(r.response.headers))),Promise.reject(r)})}const xE="1.8.4",i0={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{i0[e]=function(r){return typeof r===e||"a"+(n<1?"n ":" ")+e}});const oj={};i0.transitional=function(n,t,r){function a(s,l){return"[Axios v"+xE+"] Transitional option '"+s+"'"+l+(r?". "+r:"")}return(s,l,f)=>{if(n===!1)throw new Bt(a(l," has been removed"+(t?" in "+t:"")),Bt.ERR_DEPRECATED);return t&&!oj[l]&&(oj[l]=!0,console.warn(a(l," has been deprecated since v"+t+" and will be removed in the near future"))),n?n(s,l,f):!0}};i0.spelling=function(n){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${n}`),!0)};function k7(e,n,t){if(typeof e!="object")throw new Bt("options must be an object",Bt.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let a=r.length;for(;a-- >0;){const s=r[a],l=n[s];if(l){const f=e[s],d=f===void 0||l(f,s,e);if(d!==!0)throw new Bt("option "+s+" must be "+d,Bt.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Bt("Unknown option "+s,Bt.ERR_BAD_OPTION)}}const nb={assertOptions:k7,validators:i0},Do=nb.validators;let Dd=class{constructor(n){this.defaults=n,this.interceptors={request:new XC,response:new XC}}async request(n,t){try{return await this._request(n,t)}catch(r){if(r instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const s=a.stack?a.stack.replace(/^.+\n/,""):"";try{r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}catch{}}throw r}}_request(n,t){typeof n=="string"?(t=t||{},t.url=n):t=n||{},t=Fd(this.defaults,t);const{transitional:r,paramsSerializer:a,headers:s}=t;r!==void 0&&nb.assertOptions(r,{silentJSONParsing:Do.transitional(Do.boolean),forcedJSONParsing:Do.transitional(Do.boolean),clarifyTimeoutError:Do.transitional(Do.boolean)},!1),a!=null&&($e.isFunction(a)?t.paramsSerializer={serialize:a}:nb.assertOptions(a,{encode:Do.function,serialize:Do.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),nb.assertOptions(t,{baseUrl:Do.spelling("baseURL"),withXsrfToken:Do.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let l=s&&$e.merge(s.common,s[t.method]);s&&$e.forEach(["delete","get","head","post","put","patch","common"],S=>{delete s[S]}),t.headers=sa.concat(l,s);const f=[];let d=!0;this.interceptors.request.forEach(function(k){typeof k.runWhen=="function"&&k.runWhen(t)===!1||(d=d&&k.synchronous,f.unshift(k.fulfilled,k.rejected))});const u=[];this.interceptors.response.forEach(function(k){u.push(k.fulfilled,k.rejected)});let h,g=0,b;if(!d){const S=[sj.bind(this),void 0];for(S.unshift.apply(S,f),S.push.apply(S,u),b=S.length,h=Promise.resolve(t);g<b;)h=h.then(S[g++],S[g++]);return h}b=f.length;let v=t;for(g=0;g<b;){const S=f[g++],k=f[g++];try{v=S(v)}catch(E){k.call(this,E);break}}try{h=sj.call(this,v)}catch(S){return Promise.reject(S)}for(g=0,b=u.length;g<b;)h=h.then(u[g++],u[g++]);return h}getUri(n){n=Fd(this.defaults,n);const t=hE(n.baseURL,n.url,n.allowAbsoluteUrls);return lE(t,n.params,n.paramsSerializer)}};$e.forEach(["delete","get","head","options"],function(n){Dd.prototype[n]=function(t,r){return this.request(Fd(r||{},{method:n,url:t,data:(r||{}).data}))}});$e.forEach(["post","put","patch"],function(n){function t(r){return function(s,l,f){return this.request(Fd(f||{},{method:n,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:l}))}}Dd.prototype[n]=t(),Dd.prototype[n+"Form"]=t(!0)});let E7=class bE{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(s){t=s});const r=this;this.promise.then(a=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](a);r._listeners=null}),this.promise.then=a=>{let s;const l=new Promise(f=>{r.subscribe(f),s=f}).then(a);return l.cancel=function(){r.unsubscribe(s)},l},n(function(s,l,f){r.reason||(r.reason=new Wh(s,l,f),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const t=this._listeners.indexOf(n);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const n=new AbortController,t=r=>{n.abort(r)};return this.subscribe(t),n.signal.unsubscribe=()=>this.unsubscribe(t),n.signal}static source(){let n;return{token:new bE(function(a){n=a}),cancel:n}}};function T7(e){return function(t){return e.apply(null,t)}}function A7(e){return $e.isObject(e)&&e.isAxiosError===!0}const q1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(q1).forEach(([e,n])=>{q1[n]=e});function vE(e){const n=new Dd(e),t=K2(Dd.prototype.request,n);return $e.extend(t,Dd.prototype,n,{allOwnKeys:!0}),$e.extend(t,n,null,{allOwnKeys:!0}),t.create=function(a){return vE(Fd(e,a))},t}const pr=vE(wg);pr.Axios=Dd;pr.CanceledError=Wh;pr.CancelToken=E7;pr.isCancel=dE;pr.VERSION=xE;pr.toFormData=n0;pr.AxiosError=Bt;pr.Cancel=pr.CanceledError;pr.all=function(n){return Promise.all(n)};pr.spread=T7;pr.isAxiosError=A7;pr.mergeConfig=Fd;pr.AxiosHeaders=sa;pr.formToJSON=e=>uE($e.isHTMLForm(e)?new FormData(e):e);pr.getAdapter=yE.getAdapter;pr.HttpStatusCode=q1;pr.default=pr;const{Axios:Lie,AxiosError:Fie,CanceledError:$ie,isCancel:zie,CancelToken:Bie,VERSION:Uie,all:qie,Cancel:Vie,isAxiosError:Hie,spread:Gie,toFormData:Yie,AxiosHeaders:Wie,HttpStatusCode:Qie,formToJSON:Jie,getAdapter:Kie,mergeConfig:Xie}=pr;function P7(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const f=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(d=>d.addEventListener("ended",f)),()=>{e.getTracks().forEach(d=>d.removeEventListener("ended",f))}},[e]),{type:"screen",start:async()=>{const f=await navigator.mediaDevices.getDisplayMedia({video:!0});return n(f),r(!0),f},stop:()=>{e&&(e.getTracks().forEach(f=>f.stop()),n(null),r(!1))},isStreaming:t,stream:e}}function D7(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const f=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(d=>d.addEventListener("ended",f)),()=>{e.getTracks().forEach(d=>d.removeEventListener("ended",f))}},[e]),{type:"webcam",start:async()=>{const f=await navigator.mediaDevices.getUserMedia({video:!0});return n(f),r(!0),f},stop:()=>{e&&(e.getTracks().forEach(f=>f.stop()),n(null),r(!1))},isStreaming:t,stream:e}}class I7 extends W2{constructor(t){super();Yn(this,"client");Yn(this,"_status","disconnected");Yn(this,"_session",null);Yn(this,"_model",null);Yn(this,"config",null);this.client=new H2(t),this.send=this.send.bind(this),this.onopen=this.onopen.bind(this),this.onerror=this.onerror.bind(this),this.onclose=this.onclose.bind(this),this.onmessage=this.onmessage.bind(this)}get status(){return this._status}get session(){return this._session}get model(){return this._model}getConfig(){return{...this.config}}log(t,r){const a={date:new Date,type:t,message:r};this.emit("log",a)}async connect(t,r){if(this._status==="connected"||this._status==="connecting")return!1;this._status="connecting",this.config=r,this._model=t;const a={onopen:this.onopen,onmessage:this.onmessage,onerror:this.onerror,onclose:this.onclose};try{this._session=await this.client.live.connect({model:t,config:r,callbacks:a})}catch(s){return console.error("Error connecting to GenAI Live:",s),this._status="disconnected",!1}return this._status="connected",!0}disconnect(){var t;return this.session?((t=this.session)==null||t.close(),this._session=null,this._status="disconnected",this.log("client.close","Disconnected"),!0):!1}onopen(){this.log("client.open","Connected"),this.emit("open")}onerror(t){this.log("server.error",t.message),this.emit("error",t)}onclose(t){this.log("server.close",`disconnected ${t.reason?`with reason: ${t.reason}`:""}`),this.emit("close",t)}async onmessage(t){var r;if(t.setupComplete){this.log("server.send","setupComplete"),this.emit("setupcomplete");return}if(t.toolCall){this.log("server.toolCall",t),this.emit("toolcall",t.toolCall);return}if(t.toolCallCancellation){this.log("server.toolCallCancellation",t),this.emit("toolcallcancellation",t.toolCallCancellation);return}if(t.serverContent){const{serverContent:a}=t;if("interrupted"in a){this.log("server.content","interrupted"),this.emit("interrupted");return}if("turnComplete"in a&&(this.log("server.content","turnComplete"),this.emit("turncomplete")),"modelTurn"in a){let s=((r=a.modelTurn)==null?void 0:r.parts)||[];const l=s.filter(h=>{var g;return h.inlineData&&((g=h.inlineData.mimeType)==null?void 0:g.startsWith("audio/pcm"))}),f=l.map(h=>{var g;return(g=h.inlineData)==null?void 0:g.data}),d=J2.difference(s,l);if(f.forEach(h=>{if(h){const g=GU(h);this.emit("audio",g),this.log("server.audio",`buffer (${g.byteLength})`)}}),!d.length)return;s=d;const u={modelTurn:{parts:s}};this.emit("content",u),this.log("server.content",t)}}else console.log("received unmatched message",t)}sendRealtimeInput(t){var l;let r=!1,a=!1;for(const f of t)if((l=this.session)==null||l.sendRealtimeInput({media:f}),f.mimeType.includes("audio")&&(r=!0),f.mimeType.includes("image")&&(a=!0),r&&a)break;const s=r&&a?"audio + video":r?"audio":a?"video":"unknown";this.log("client.realtimeInput",s)}sendToolResponse(t){var r;t.functionResponses&&t.functionResponses.length&&((r=this.session)==null||r.sendToolResponse({functionResponses:t.functionResponses}),this.log("client.toolResponse",t))}send(t,r=!0){var a;(a=this.session)==null||a.sendClientContent({turns:t,turnComplete:r}),this.log("client.send",{turns:Array.isArray(t)?t:[t],turnComplete:r})}}function M7(e){const n=w.useMemo(()=>new I7(e),[e]),t=w.useRef(null),[r,a]=w.useState("models/gemini-2.5-flash-live-preview"),[s,l]=w.useState({}),[f,d]=w.useState(!1),[u,h]=w.useState(0),[g,b]=w.useState(null);w.useEffect(()=>{t.current||G2({id:"audio-out"}).then(k=>{t.current=new t9(k),t.current.addWorklet("vumeter-out",Y2,E=>{h(E.data.volume)}).then(()=>{})})},[t]),w.useEffect(()=>{const k=()=>{d(!0)},E=()=>{d(!1)},T=R=>{console.error("error",R)},I=()=>{var R;return(R=t.current)==null?void 0:R.stop()},D=R=>{var F;return(F=t.current)==null?void 0:F.addPCM16(new Uint8Array(R))},q=R=>{if(console.log("Received content event:",R),R.modelTurn&&R.modelTurn.parts){const F=R.modelTurn.parts.filter(U=>"text"in U&&U.text);if(F.length>0){const U=F.map(z=>z.text).join(" ");b(U),console.log("AI Summary received:",U)}}};return n.on("error",T).on("open",k).on("close",E).on("interrupted",I).on("audio",D).on("content",q),()=>{n.off("error",T).off("open",k).off("close",E).off("interrupted",I).off("audio",D).off("content",q).disconnect()}},[n]);const v=w.useCallback(async()=>{if(!s)throw new Error("config has not been set");n.disconnect(),await n.connect(r,s)},[n,s,r]),S=w.useCallback(async()=>{n.disconnect(),d(!1)},[d,n]);return{client:n,config:s,setConfig:l,model:r,setModel:a,connected:f,connect:v,disconnect:S,volume:u,aiSummary:g}}const wE=w.createContext(void 0),Jw=({options:e,children:n})=>{const t=M7(e);return i.jsx(wE.Provider,{value:t,children:n})},Xc=()=>{const e=w.useContext(wE);if(!e)throw new Error("useLiveAPIContext must be used wihin a LiveAPIProvider");return e};function R7(){const{config:e,setConfig:n}=Xc(),[t,r]=w.useState({value:"audio",label:"audio"}),a=w.useCallback(s=>{n({...e,responseModalities:[s==="audio"?Yc.AUDIO:Yc.TEXT]})},[e,n]);return i.jsxs("div",{className:"select-group",children:[i.jsx("label",{htmlFor:"response-modality-selector",children:"Response modality"}),i.jsx(E2,{id:"response-modality-selector",className:"react-select",classNamePrefix:"react-select",styles:{},defaultValue:t,options:[{value:"audio",label:"audio"},{value:"text",label:"text"}],onChange:s=>{r(s),s&&(s.value==="audio"||s.value==="text")&&a(s.value)}})]})}const lj=[{value:"Puck",label:"Puck"},{value:"Charon",label:"Charon"},{value:"Kore",label:"Kore"},{value:"Fenrir",label:"Fenrir"},{value:"Aoede",label:"Aoede"}];function O7(){const{config:e,setConfig:n}=Xc();w.useEffect(()=>{var f,d,u;const s=((u=(d=(f=e.speechConfig)==null?void 0:f.voiceConfig)==null?void 0:d.prebuiltVoiceConfig)==null?void 0:u.voiceName)||"Atari02";r({value:s,label:s})},[e]);const[t,r]=w.useState(lj[5]),a=w.useCallback(s=>{n({...e,speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:s}}}})},[e,n]);return i.jsxs("div",{className:"select-group",children:[i.jsx("label",{htmlFor:"voice-selector",children:"Voice"}),i.jsx(E2,{id:"voice-selector",className:"react-select",classNamePrefix:"react-select",styles:{},value:t,defaultValue:t,options:lj,onChange:s=>{r(s),s&&a(s.value)}})]})}function L7(){const[e,n]=w.useState(!1),{config:t,setConfig:r,connected:a}=Xc(),s=w.useMemo(()=>Array.isArray(t.tools)?t.tools.filter(u=>Array.isArray(u.functionDeclarations)).map(u=>u.functionDeclarations).filter(u=>!!u).flat():[],[t]),l=w.useMemo(()=>{var u;return t.systemInstruction?typeof t.systemInstruction=="string"?t.systemInstruction:Array.isArray(t.systemInstruction)?t.systemInstruction.map(h=>typeof h=="string"?h:h.text).join(`
`):typeof t.systemInstruction=="object"&&"parts"in t.systemInstruction&&((u=t.systemInstruction.parts)==null?void 0:u.map(h=>h.text).join(`
`))||"":""},[t]),f=w.useCallback(u=>{const h={...t,systemInstruction:u.target.value};r(h)},[t,r]),d=w.useCallback((u,h)=>{var b;const g={...t,tools:((b=t.tools)==null?void 0:b.map(v=>{const S=v;return Array.isArray(S.functionDeclarations)?{...v,functionDeclarations:S.functionDeclarations.map(k=>k.name===u?{...k,description:h}:k)}:v}))||[]};r(g)},[t,r]);return i.jsxs("div",{className:"settings-dialog",children:[i.jsx("button",{className:"action-button material-symbols-outlined",onClick:()=>n(!e),children:"settings"}),i.jsx("dialog",{className:"dialog",style:{display:e?"block":"none"},children:i.jsxs("div",{className:`dialog-container ${a?"disabled":""}`,children:[a&&i.jsx("div",{className:"connected-indicator",children:i.jsx("p",{children:"These settings can only be applied before connecting and will override other settings."})}),i.jsxs("div",{className:"mode-selectors",children:[i.jsx(R7,{}),i.jsx(O7,{})]}),i.jsx("h3",{children:"System Instructions"}),i.jsx("textarea",{className:"system",onChange:f,value:l}),i.jsx("h4",{children:"Function declarations"}),i.jsx("div",{className:"function-declarations",children:i.jsx("div",{className:"fd-rows",children:s.map((u,h)=>{var g;return i.jsxs("div",{className:"fd-row",children:[i.jsx("span",{className:"fd-row-name",children:u.name}),i.jsx("span",{className:"fd-row-args",children:Object.keys(((g=u.parameters)==null?void 0:g.properties)||{}).map((b,v)=>i.jsx("span",{children:b},v))}),i.jsx("input",{className:"fd-row-description",type:"text",defaultValue:u.description,onBlur:b=>d(u.name,b.target.value)},`fd-${u.description}`)]},`function-${h}`)})})})]})})]})}const cj=w.memo(({isStreaming:e,onIcon:n,offIcon:t,start:r,stop:a})=>e?i.jsx("button",{className:"action-button",onClick:a,children:i.jsx("span",{className:"material-symbols-outlined",children:n})}):i.jsx("button",{className:"action-button",onClick:r,children:i.jsx("span",{className:"material-symbols-outlined",children:t})}));function F7({videoRef:e,children:n,onVideoStreamChange:t=()=>{},supportsVideo:r,enableEditingSettings:a}){const s=[D7(),P7()],[l,f]=w.useState(null),[d,u]=s,[h,g]=w.useState(0),[b]=w.useState(()=>new Q2),[v,S]=w.useState(!1),k=w.useRef(null),E=w.useRef(null),{client:T,connected:I,connect:D,disconnect:q,volume:R}=Xc();w.useEffect(()=>{!I&&E.current&&E.current.focus()},[I]),w.useEffect(()=>{document.documentElement.style.setProperty("--volume",`${Math.max(5,Math.min(h*200,8))}px`)},[h]),w.useEffect(()=>{const U=z=>{T.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:z}])};return I&&!v&&b?b.on("data",U).on("volume",g).start():b.stop(),()=>{b.off("data",U).off("volume",g)}},[I,T,v,b]),w.useEffect(()=>{e.current&&(e.current.srcObject=l);let U=-1;function z(){const V=e.current,L=k.current;if(!V||!L)return;const $=L.getContext("2d");if(L.width=V.videoWidth*.25,L.height=V.videoHeight*.25,L.width+L.height>0){$.drawImage(V,0,0,L.width,L.height);const H=L.toDataURL("image/jpeg",1),ee=H.slice(H.indexOf(",")+1,1/0);T.sendRealtimeInput([{mimeType:"image/jpeg",data:ee}])}I&&(U=window.setTimeout(z,1e3/.5))}return I&&l!==null&&requestAnimationFrame(z),()=>{clearTimeout(U)}},[I,l,T,e]);const F=U=>async()=>{if(U){const z=await U.start();f(z),t(z)}else f(null),t(null);s.filter(z=>z!==U).forEach(z=>z.stop())};return i.jsxs("section",{className:"control-tray",children:[i.jsx("canvas",{style:{display:"none"},ref:k}),i.jsxs("nav",{className:Hc("actions-nav",{disabled:!I}),children:[i.jsx("button",{className:Hc("action-button mic-button",{recording:!v&&I}),onClick:()=>S(!v),children:v?i.jsx("span",{className:"material-symbols-outlined filled",children:"mic_off"}):i.jsx("span",{className:"material-symbols-outlined filled",children:"mic"})}),i.jsx("div",{className:"action-button no-action outlined",children:i.jsx(XU,{volume:R,active:I,hover:!1})}),r&&i.jsxs(i.Fragment,{children:[i.jsx(cj,{isStreaming:u.isStreaming,start:F(u),stop:F(),onIcon:"cancel_presentation",offIcon:"present_to_all"}),i.jsx(cj,{isStreaming:d.isStreaming,start:F(d),stop:F(),onIcon:"videocam_off",offIcon:"videocam"})]}),n]}),i.jsxs("div",{className:Hc("connection-container",{connected:I}),children:[i.jsx("div",{className:"connection-button-container",children:i.jsx("button",{ref:E,className:Hc("action-button connect-toggle",{connected:I}),onClick:I?q:D,children:i.jsx("span",{className:"material-symbols-outlined filled",children:I?"pause":"play_arrow"})})}),i.jsx("span",{className:"text-indicator",children:"Streaming"})]}),a?i.jsx(L7,{}):""]})}const uj={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:$h.OBJECT,properties:{summary:{type:$h.STRING,description:"The summary of the patient's case."}},required:["summary"]}},$7=({patientData:e,tokenNumber:n})=>{const[t,r]=w.useState(""),{client:a,setConfig:s,setModel:l}=Xc();return w.useEffect(()=>{l("models/gemini-2.5-flash-live-preview"),s({responseModalities:[Yc.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:`Your job is to:

If patient details like name, age, sex, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details (e.g., phone number) are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's name, age, sex, and phone number.

When pronouncing a phone number, always state each digit individually (e.g., "six three" instead of "sixty-three" or "six billion three").

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in Telugu.dont write the telugu words in english`}]},tools:[{functionDeclarations:[uj]}]})},[s,l]),w.useEffect(()=>{const f=d=>{if(!d.functionCalls)return;const u=d.functionCalls.find(h=>h.name===uj.name);if(u){const h=u.args.summary;r(h)}d.functionCalls.length&&setTimeout(()=>{var h;return a.sendToolResponse({functionResponses:(h=d.functionCalls)==null?void 0:h.map(g=>({response:{output:{success:!0}},id:g.id,name:g.name}))})},200)};return a.on("toolcall",f),()=>{a.off("toolcall",f)}},[a]),w.useEffect(()=>{if(t){const f=encodeURIComponent(t);n?window.location.href=`https://hms.newtons.in/handle-complaint-url?token=${n}&caseDetails=${f}`:window.location.href=`https://hms.newtons.in/dashboard/search-patient?caseDetails=${f}`}},[t,n]),i.jsxs("div",{className:"hospital-reception",children:[i.jsx("h1",{children:"Newtons Ai"}),i.jsx("p",{children:"Newtons Ai"}),n&&i.jsxs("h2",{children:["Token Number: ",n]}),e&&i.jsxs("div",{children:[i.jsx("h2",{children:"Patient Details"}),i.jsx("pre",{children:JSON.stringify(e,null,2)})]}),t&&i.jsxs("div",{children:[i.jsx("h2",{children:"Case Summary (from Tool Call)"}),i.jsx("p",{children:t})]})]})},dj="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes";async function z7(){const e=Ak();if(!e)return console.warn("No auth token found, using default Live API key."),dj;try{const t=(await pr.get("/api/clinics/gemini-api-key",{headers:{Authorization:`Bearer ${e}`}})).data.geminiApiKey;if(t)return t}catch(n){console.error("Failed to fetch clinic-specific Live API key:",n)}return console.warn("Clinic-specific Live API key not found or failed to fetch, using default."),dj}function B7(){const e=w.useRef(null),[n,t]=w.useState(null),[r,a]=w.useState(null);return w.useEffect(()=>{(async()=>{try{const l=await z7();a({apiKey:l})}catch(l){console.error("Error setting Live API options:",l)}})()},[]),r?i.jsx("div",{className:"App",children:i.jsx(Jw,{options:r,children:i.jsx(U7,{videoRef:e,setVideoStream:t,videoStream:n})})}):i.jsx("div",{children:"Loading Live API settings..."})}const U7=({videoRef:e,setVideoStream:n,videoStream:t})=>{const[r,a]=w.useState(null),[s,l]=w.useState(null),{connected:f,client:d,connect:u,config:h,model:g}=Xc(),[b,v]=w.useState(""),S=w.useRef(null),[k,E]=w.useState(!1);w.useEffect(()=>{const I=window.matchMedia("(prefers-color-scheme: dark)"),D=q=>{document.documentElement.setAttribute("data-theme",q.matches?"dark":"light")};return D(I),I.addEventListener("change",D),()=>I.removeEventListener("change",D)},[]),w.useEffect(()=>{const I=new URLSearchParams(window.location.search),D={};for(const[q,R]of I.entries())q==="token_number"?l(R):D[q]=R;a(D)},[]),w.useEffect(()=>{Object.keys(h).length>0&&g&&u()},[u,h,g]),w.useEffect(()=>{if(f&&r&&!k){const I=JSON.stringify(r,null,2);d.send([{text:I}]),v(""),E(!0)}},[f,r,d,k]),w.useEffect(()=>{r&&v(JSON.stringify(r,null,2))},[r]);const T=()=>{d.send([{text:b}]),v(""),S.current&&(S.current.innerText="")};return i.jsx("div",{className:"streaming-console",children:i.jsxs("main",{children:[i.jsxs("div",{className:"main-app-area",children:[i.jsx($7,{patientData:r,tokenNumber:s}),i.jsx("video",{className:Hc("stream",{hidden:!e.current||!t}),ref:e,autoPlay:!0,playsInline:!0})]}),i.jsx("div",{className:Hc("input-container",{disabled:!f}),children:i.jsxs("div",{className:"input-content",children:[i.jsx("textarea",{className:"input-area",ref:S,onKeyDown:I=>{I.key==="Enter"&&!I.shiftKey&&(I.preventDefault(),I.stopPropagation(),T())},onChange:I=>v(I.target.value),value:b}),i.jsx("span",{className:Hc("input-content-placeholder",{hidden:b.length}),children:"Typesomething..."}),i.jsx("button",{className:"send-button material-symbols-outlined filled",onClick:T,children:"send"})]})}),i.jsx(F7,{videoRef:e,supportsVideo:!0,onVideoStreamChange:n,enableEditingSettings:!0})]})})},fj="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",q7=({volume:e,active:n})=>{const t=Array.from({length:5},(r,a)=>i.jsx("div",{className:`audio-bar ${n?"active":""}`,style:{height:n?`${Math.min(24,20+e*40*(1+Math.sin(a)*.3))}px`:"8px",animationDelay:`${a*.1}s`}},a));return i.jsx("div",{className:"audio-pulse",children:t})},V7=w.forwardRef(({videoRef:e,supportsVideo:n,onVideoStreamChange:t,textInput:r,onSubmitTextInput:a},s)=>{var F;const{connected:l,connect:f,disconnect:d,client:u,volume:h}=Xc(),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,E]=w.useState(!1),[T]=w.useState(()=>new Q2),I=async()=>{l?await d():(await f(),r.trim()&&a())};w.useEffect(()=>{const U=z=>{u.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:z}])};return l&&!g?T.on("data",U).start():T.stop(),()=>{T.off("data",U),T.stop()}},[l,u,g,T]);const D=w.useCallback(async()=>{if(v)R==null||R.getTracks().forEach(U=>U.stop()),t(null),S(!1);else try{const U=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=U),t(U),S(!0)}catch(U){console.error("Error accessing webcam:",U),S(!1)}},[v,t,e]),q=w.useCallback(async()=>{if(k)R==null||R.getTracks().forEach(U=>U.stop()),t(null),E(!1);else try{const U=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=U),t(U),E(!0)}catch(U){console.error("Error accessing screen share:",U),E(!1)}},[k,t,e]),R=(F=e.current)==null?void 0:F.srcObject;return w.useEffect(()=>()=>{R&&R.getTracks().forEach(U=>U.stop())},[R]),w.useImperativeHandle(s,()=>({handleConnect:I})),i.jsx("div",{className:"live-api-control-tray",children:i.jsxs("div",{className:"live-api-control-tray-inner",children:[i.jsxs("div",{className:"live-api-control-group",children:[i.jsx("button",{onClick:()=>b(!g),disabled:!l,className:`live-api-control-button ${l&&!g?"mic-active":"mic-inactive"}`,"aria-label":g?"Unmute microphone":"Mute microphone",children:g?i.jsx(TM,{className:"w-5 h-5"}):i.jsx(_k,{className:"w-5 h-5"})}),i.jsx("div",{className:"live-api-audio-pulse-container",children:i.jsx(q7,{volume:h,active:l})}),n&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:q,disabled:!l,className:`live-api-control-button ${k?"video-active":"video-inactive"}`,"aria-label":k?"Stop screen share":"Start screen share",children:i.jsx(DM,{className:"w-5 h-5"})}),i.jsx("button",{onClick:D,disabled:!l,className:`live-api-control-button ${v?"video-active":"video-inactive"}`,"aria-label":v?"Turn off webcam":"Turn on webcam",children:i.jsx(CR,{className:"w-5 h-5"})})]})]}),i.jsxs("div",{className:"live-api-control-group",children:[i.jsxs("div",{className:"live-api-status-indicator",children:[i.jsx("div",{className:`live-api-status-dot ${l?"connected":"disconnected"}`}),i.jsx("span",{className:"live-api-status-text",children:l?"Streaming":"Disconnected"})]}),i.jsx("button",{onClick:I,className:`live-api-connect-button ${l?"connected":"disconnected"}`,children:l?i.jsxs(i.Fragment,{children:[i.jsx($M,{className:"w-5 h-5"}),i.jsx("span",{children:"Pause"})]}):i.jsxs(i.Fragment,{children:[i.jsx(HM,{className:"w-5 h-5"}),i.jsx("span",{children:"Start"})]})})]})]})})}),H7=({patientData:e,tokenNumber:n,aiSummary:t,clinicName:r})=>i.jsxs("div",{className:"hospital-reception-container",children:[i.jsxs("div",{className:"hospital-reception-logo-section",children:[i.jsx("div",{className:"hospital-reception-logo",children:i.jsx("span",{children:r.charAt(0)})}),i.jsxs("h1",{className:"hospital-reception-title",children:[r," AI"]}),i.jsxs("p",{className:"hospital-reception-subtitle",children:["Intelligent ",r," Reception Assistant"]})]}),n&&i.jsxs("div",{className:"hospital-reception-token-card",children:[i.jsx("h2",{className:"hospital-reception-token-title",children:"Token Number"}),i.jsx("p",{className:"hospital-reception-token-number",children:n})]}),e?i.jsxs("div",{className:"hospital-reception-patient-info-card",children:[i.jsx("h3",{className:"hospital-reception-patient-info-title",children:"Patient Information"}),i.jsx("div",{className:"hospital-reception-patient-info-content",children:i.jsx("pre",{className:"hospital-reception-patient-info-pre",children:JSON.stringify(e,null,2)})})]}):i.jsxs("div",{className:"hospital-reception-patient-info-card",children:[i.jsx("h3",{className:"hospital-reception-patient-info-title",children:"New Case"}),i.jsx("p",{className:"hospital-reception-patient-info-pre",children:"No patient data provided. This is a new case."})]}),t&&i.jsxs("div",{className:"hospital-reception-summary-card",children:[i.jsx("h3",{className:"hospital-reception-summary-title",children:"Case Summary"}),i.jsx("p",{className:"hospital-reception-summary-text",children:t})]})]}),hj={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:$h.OBJECT,properties:{summary:{type:$h.STRING,description:"The summary of the patient's case."}},required:["summary"]}},G7=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:a,aiLanguage:s})=>{const l=w.useRef(null),f=w.useRef(null),[d,u]=w.useState(null),[h,g]=w.useState("hi"),{client:b,connected:v,aiSummary:S,setConfig:k,setModel:E,disconnect:T}=Xc(),[I,D]=w.useState(null),q=w.useMemo(()=>{let U=`Your job is to:

If patient details like name, age, sex, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's name, age, and sex(dont ask for sex ,detect automatically through voice recognition).

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in ${s||"English"}.dont write the ${s||"English"} words in english.donot use function calls in the middle of the conversation`;return n&&(U+=`

Patient Data: ${JSON.stringify(n,null,2)}`),{responseModalities:[Yc.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:U}]},tools:[{functionDeclarations:[hj]}]}},[n,s]);w.useEffect(()=>{E("models/gemini-2.5-flash-native-audio-preview-09-2025"),k(q);const U=setTimeout(()=>{f.current&&!v&&f.current.handleConnect()},2e3);return()=>clearTimeout(U)},[k,E,q,v]),w.useEffect(()=>()=>{v&&T()},[v,T]),w.useEffect(()=>{r(S)},[S,r]),w.useEffect(()=>{const U=z=>{if(z.modelTurn&&z.modelTurn.parts){for(const V of z.modelTurn.parts)if(V.executableCode){const L=V.executableCode.code,$=/summary=["'](.*?)["']/.exec(L);if($&&$[1]){const H=$[1];D(H),r(H)}}}};return b.on("content",U),()=>{b.off("content",U)}},[b,r]),w.useEffect(()=>{const U=z=>{if(!z.functionCalls)return;const V=z.functionCalls.find(L=>L.name===hj.name);if(V){const L=V.args.summary;r(L)}z.functionCalls.length&&setTimeout(()=>{var L;return b.sendToolResponse({functionResponses:(L=z.functionCalls)==null?void 0:L.map($=>({response:{output:{success:!0}},id:$.id,name:$.name}))})},200)};return b.on("toolcall",U),()=>{b.off("toolcall",U)}},[b,r]);const R=()=>{h.trim()&&(b.send([{text:h}]),g(""))},F=U=>{U.key==="Enter"&&!U.shiftKey&&(U.preventDefault(),R())};return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsxs("div",{className:"live-api-modal-content",children:[i.jsxs("div",{className:"live-api-modal-header",children:[i.jsxs("div",{className:"live-api-modal-header-left",children:[i.jsx("div",{className:"live-api-modal-logo",children:i.jsx("span",{children:a.charAt(0)})}),i.jsxs("div",{children:[i.jsx("h1",{className:"live-api-modal-title",children:a}),i.jsxs("p",{className:"live-api-modal-subtitle",children:[a," Hospital Assistant"]})]})]}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("button",{onClick:e,className:"live-api-modal-close-button","aria-label":"Close modal",children:i.jsx(Jn,{className:"w-6 h-6"})})})]}),i.jsx("div",{className:"live-api-modal-main-content",children:i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsxs("div",{className:"live-api-reception-area",children:[i.jsx(H7,{patientData:n,tokenNumber:t,aiSummary:I??S,clinicName:a}),d&&i.jsx("video",{ref:l,autoPlay:!0,playsInline:!0,className:"live-api-video-stream"})]}),i.jsx("div",{className:"live-api-input-area",children:i.jsxs("div",{className:"live-api-input-container",children:[i.jsx("textarea",{value:h,onChange:U=>g(U.target.value),onKeyDown:F,placeholder:"Type your message here...",disabled:!v,rows:1,className:"live-api-textarea"}),i.jsx("button",{onClick:R,disabled:!v||!h.trim(),className:"live-api-send-button","aria-label":"Send message",children:i.jsx(XM,{className:"w-5 h-5"})})]})}),i.jsx(V7,{ref:f,videoRef:l,supportsVideo:!0,onVideoStreamChange:u,textInput:h,onSubmitTextInput:R})]})})]})})},SE=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r})=>{const[a,s]=w.useState(null),[l,f]=w.useState("Newtons Ai"),[d,u]=w.useState(""),[h,g]=w.useState(!0);if(w.useEffect(()=>{(async()=>{try{const k=await(await ge("/api/clinics/settings")).json();k.gemini_api_key?s(k.gemini_api_key):s(fj),k.name&&k.name!==""?f(k.name):f("Newtons Ai"),u(k.aiLanguage||"")}catch(S){console.error("Failed to fetch clinic settings, using default API key and unknown clinic name:",S),s(fj),f("Newtons Ai"),u("")}finally{g(!1)}})()},[]),h)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsx("div",{className:"live-api-modal-content",children:i.jsx("div",{children:"Loading API Key and Clinic Name..."})})});if(!a)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsx("div",{className:"live-api-modal-content",children:i.jsx("div",{children:"Error: API Key not available."})})});const b={apiKey:a};return i.jsx(Jw,{options:b,children:i.jsx(G7,{onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:l,aiLanguage:d})})},Y7=({onClose:e})=>{const n=wt(),t=()=>{e(),n("/start-clinic-subscription")};return i.jsx("div",{className:"go-pro-modal-overlay",children:i.jsxs("div",{className:"go-pro-modal-content",children:[i.jsx("button",{onClick:e,className:"go-pro-modal-close-button",children:i.jsx(Jn,{size:24})}),i.jsx("h2",{className:"go-pro-modal-title",children:"Voice AI Agent for Pro Members Only"}),i.jsx("p",{className:"go-pro-modal-message",children:"Unlock the full potential of our Voice AI Agent by upgrading to a Pro subscription. Enjoy advanced features and seamless patient interactions."}),i.jsx("button",{onClick:t,className:"go-pro-button",children:"Go Pro Now"})]})})},W7="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",Q7={apiKey:W7},Th=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,s]=w.useState([]),[l,f]=w.useState(!1),[d,u]=w.useState(null),[h,g]=w.useState(!1),[b,v]=w.useState(null),[S,k]=w.useState(!1),[E,T]=w.useState(null),I=w.useRef(null),[D,q]=w.useState(!1),[R,F]=w.useState(!1),[U,z]=w.useState(null),[V,L]=w.useState(null),[$,H]=w.useState(null),[ee,te]=w.useState(!1),ae=wt(),Z=ni();w.useEffect(()=>{(async()=>{try{const be=await $k();H(be.hasProPlan)}catch(be){console.error("Error fetching pro status:",be),H(!1)}})(),B()},[]);const B=async()=>{try{const pe=new URLSearchParams({page:"1",limit:"4",sortBy:"created_at",sortOrder:"desc"}),be=await ge(`/api/patients?${pe.toString()}`);if(be.ok){const fe=await be.json();s(fe.patients)}}catch(pe){console.error("Error fetching recent patients:",pe)}},K=w.useCallback(async pe=>{const be=pe||e;if(!be.trim()){T("Please enter complaint details.");return}k(!0),T(null);try{const fe=await ge("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"New Patient - Direct Entry",age:null,gender:null,phone:null,address:null})});if(!fe.ok){const Ze=await fe.json().catch(()=>({message:"Failed to create patient"}));if(fe.status===403&&Ze.message.includes("Patient limit")){ae("/start-clinic-subscription",{state:{errorMessage:Ze.message}});return}throw new Error(Ze.message||`Failed to create patient: ${fe.statusText}`)}const Pe=await fe.json();if(!Pe||!Pe.id)throw new Error("Failed to create new patient or retrieve patient ID.");const de=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:Pe.id,complaint:be})});if(!de.ok){const Ze=await de.text();throw new Error(`Failed to create queue entry: ${Ze||de.statusText}`)}const Me=await de.json();if(!Me||!Me.id)throw new Error("Failed to create new complaint record or retrieve record ID.");ae(`/dashboard/edit-complaint/${Me.id}`,{state:{initialComplaint:be,patientId:Pe.id}})}catch(fe){console.error("Error starting new complaint:",fe),fe.message.includes("Patient limit")?(T(`Error: ${fe.message}. Please upgrade your plan.`),ae("/start-clinic-subscription")):T(`Error: ${fe.message||"Failed to start new complaint process."}`)}finally{k(!1)}},[e,ae]);w.useEffect(()=>{const pe=I.current;pe&&(pe.style.height="auto",pe.style.height=`${pe.scrollHeight}px`);const fe=new URLSearchParams(Z.search).get("caseDetails");if(fe){const Pe=decodeURIComponent(fe);Pe!==e&&(n(Pe),q(!0))}},[Z.search,e]),w.useEffect(()=>{D&&e.trim()&&(ae(Z.pathname,{replace:!0}),K(e),q(!1))},[D,e,K,ae,Z.pathname]),w.useEffect(()=>{const pe=I.current;pe&&(pe.style.height="auto",pe.style.height=`${pe.scrollHeight}px`)},[e]),w.useEffect(()=>{U&&(n(U),F(!1),K(U),z(null))},[U,K]);const oe=()=>{if($===!1){te(!0);return}L({id:null,token:null,name:"New Case",age:null,gender:null}),F(!0)},A=w.useMemo(()=>qb(async pe=>{const be=pe.trim(),fe=/^\d+$/.test(be),Pe=be.split(/\s+/).length;if(be.length<2||fe&&be.length>10||!fe&&Pe>2){r([]),f(!1),u(null);return}f(!0),u(null);try{const de=new URLSearchParams({search:encodeURIComponent(pe),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),Me=await ge(`/api/patients?${de.toString()}`);if(!Me.ok){const Fe=await Me.text();throw new Error(`API Error (${Me.status}): ${Fe||Me.statusText}`)}const Ze=await Me.json();r(Ze.patients)}catch(de){console.error("Error searching patients:",de),u(de.message||"Failed to search patients."),r([])}finally{f(!1)}},300),[]),se=pe=>{const be=pe.target.value;n(be);const fe=be.trim(),Pe=/^\d+$/.test(fe),de=fe.split(/\s+/).length;fe.length>=2&&!(Pe&&fe.length>10||!Pe&&de>2)?f(!0):(f(!1),r([])),A(be)},ue=pe=>{pe.key==="Enter"&&!pe.shiftKey&&(pe.preventDefault(),t.length>0&&!l?M(t[0]):e.trim()&&!l&&K(e))},M=async pe=>{r([]),n(""),g(!0),v(null);try{const be=await ge(`/api/queue/patient/${pe.id}/latest`);if(be.ok){const de=await be.json();if(de!=null&&de._id){if(de!=null&&de._id){ae(`/dashboard/edit-complaint/${de._id}`,{state:{patientId:pe.id}}),g(!1);return}g(!1);return}}else if(be.status!==404){const de=await be.text();throw new Error(`Failed to fetch queue entry: ${de||be.statusText} (${be.status})`)}const fe=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:pe.id})});if(!fe.ok){const de=await fe.text();throw new Error(`Failed to create queue entry: ${de||fe.statusText} (${fe.status})`)}const Pe=await fe.json();if(Pe!=null&&Pe.id)ae(`/dashboard/edit-complaint/${Pe.id}`,{state:{patientId:pe.id}});else throw new Error("Failed to get ID from new queue entry.")}catch(be){console.error("Error processing patient selection:",be),v(be.message||"An error occurred while processing the selection.")}finally{g(!1)}};return i.jsxs("div",{className:"patient-search-page-container",children:[i.jsxs("div",{className:"patient-search-header",children:[i.jsxs("button",{onClick:()=>ae(-1),className:"patient-search-button patient-search-button-back",children:[i.jsx(Ut,{size:16}),"Back"]}),i.jsx("h1",{className:"patient-search-page-title",children:"Search Patient Records"}),i.jsx("button",{onClick:()=>ae("/dashboard/queue"),className:"patient-search-button patient-search-button-primary",children:"OPD Queue"})]}),i.jsxs("div",{className:"patient-search-content-box",children:[d&&i.jsx("p",{className:"patient-search-error",children:d}),b&&i.jsx("p",{className:"patient-search-error",children:b}),E&&i.jsx("p",{className:"patient-search-error",children:E})]}),!e&&a.length>0&&i.jsxs("div",{className:"recent-patients-section",children:[i.jsx("h2",{className:"recent-patients-title",children:"Newly Registered"}),i.jsx("div",{className:"recent-patients-grid",children:a.map(pe=>i.jsxs("div",{onClick:()=>M(pe),className:"recent-patient-card",children:[i.jsxs("div",{className:"recent-patient-info",children:[i.jsx("span",{className:"recent-patient-name",children:pe.name}),i.jsxs("span",{className:"recent-patient-details",children:[pe.age?`${pe.age} yrs`:"",pe.age&&pe.gender?" / ":"",pe.gender||""]})]}),i.jsxs("div",{className:"recent-patient-token",children:["#",pe.token]})]},pe.id))})]}),i.jsxs("div",{className:"sticky-chat-input-box",children:[t.length>0&&!h&&!S&&i.jsx("ul",{className:"patient-search-results-list",children:t.map(pe=>i.jsxs("li",{onClick:()=>M(pe),className:"patient-search-result-item",children:[i.jsxs("div",{className:"patient-search-result-item-name-container",children:[i.jsxs("span",{className:"patient-search-result-item-token",children:["[#",pe.token,"]"]}),i.jsx("span",{className:"patient-search-result-item-name",children:pe.name})]}),i.jsxs("div",{className:"patient-search-result-item-details",children:[pe.age?`${pe.age} yrs`:"",pe.age&&pe.gender?" / ":"",pe.gender||"N/A"]})]},pe.id))}),e.length>=2&&!l&&t.length===0&&!d&&!h&&i.jsxs("p",{className:"patient-search-no-results",children:['No patients found matching, taking new case: "',e,'".']}),i.jsxs("div",{className:"chat-input-controls",children:[i.jsx("textarea",{ref:I,placeholder:"Search by Name/Phone/Token or Enter New Case: Name, Age, Sex, Complaint...",value:e,onChange:se,onKeyDown:ue,className:"chat-input",autoFocus:!0,disabled:h||S,rows:1}),i.jsx("button",{onClick:e.trim()?()=>K(e):oe,className:`chat-submit-button ${S||l?"opacity-50":""}`,disabled:S||l||!!e.trim()&&!e.trim(),"aria-label":e.trim()?"Create New Case":"Use Microphone",children:S||l?i.jsx("div",{className:"spinner"}):e.trim()?i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24",children:i.jsx("path",{d:"M12 4l1.41 1.41L7.83 11H20v2H7.83l5.58 5.59L12 20l-8-8 8-8z",transform:"rotate(90 12 12)"})}):i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24",children:i.jsx("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm-1.2-9.1c0-.66.54-1.2 1.2-1.2s1.2.54 1.2 1.2V9c0 .66-.54 1.2-1.2 1.2s-1.2-.54-1.2-1.2V4.9zM17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"})})})]})]}),R&&i.jsx(Jw,{options:Q7,children:i.jsx(SE,{onClose:()=>F(!1),patientData:V,tokenNumber:null,onAiSummaryChange:z})}),ee&&i.jsx(Y7,{onClose:()=>te(!1)})]})},J7=()=>{const e=wt(),[n,t]=w.useState({admissionCharge:"0.00",perDayCharge:"0.00",otherCharges:"0.00",aiMemory:"",clinicWideSystemPrompt:"",gemini_api_key:"",low_stock_threshold:"10",aiLanguage:"",name:"",logoUrl:"",upi_id:"",address:"",notes:""}),[r,a]=w.useState(!0),[s,l]=w.useState(!1),[f,d]=w.useState(null),[u,h]=w.useState(null);w.useEffect(()=>{(async()=>{a(!0),d(null);try{const S=await ge("/api/clinics/settings");if(!S.ok){const E=await S.json();throw new Error(E.message||"Failed to fetch clinic settings.")}const k=await S.json();t({admissionCharge:parseFloat(k.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(k.perDayCharge||0).toFixed(2),otherCharges:parseFloat(k.otherCharges||0).toFixed(2),aiMemory:k.aiMemory||"",clinicWideSystemPrompt:k.clinicWideSystemPrompt||"",gemini_api_key:k.gemini_api_key||"",low_stock_threshold:k.low_stock_threshold!==void 0&&k.low_stock_threshold!==null?String(k.low_stock_threshold):"10",aiLanguage:k.aiLanguage||"",name:k.name||"",logoUrl:k.logoUrl||"",upi_id:k.upi_id||"",address:k.address||"",notes:k.notes||""})}catch(S){console.error("Error fetching settings:",S),d(`Failed to load settings: ${S.message}`),t({admissionCharge:"0.00",perDayCharge:"0.00",otherCharges:"0.00",aiMemory:"",clinicWideSystemPrompt:"",gemini_api_key:"",low_stock_threshold:"10",aiLanguage:"",name:"Unknown Clinic",logoUrl:"",upi_id:"",address:"",notes:""})}finally{a(!1)}})()},[]);const g=v=>{const{name:S,value:k}=v.target;t(E=>({...E,[S]:k}))},b=async v=>{v.preventDefault(),d(null),h(null),l(!0);const S=parseFloat(n.admissionCharge),k=parseFloat(n.perDayCharge),E=parseFloat(n.otherCharges),T=parseInt(n.low_stock_threshold);if(isNaN(S)||S<0||isNaN(k)||k<0||isNaN(E)||E<0){d("Invalid charge amount. Please enter non-negative numbers for all fields."),l(!1);return}if(isNaN(T)||T<0){d("Invalid low stock threshold. Please enter a non-negative number."),l(!1);return}try{const I=await ge("/api/clinics/settings",{method:"PUT",body:JSON.stringify({name:n.name,admissionCharge:S,perDayCharge:k,otherCharges:E,aiMemory:n.aiMemory,clinicWideSystemPrompt:n.clinicWideSystemPrompt,gemini_api_key:n.gemini_api_key,low_stock_threshold:T,aiLanguage:n.aiLanguage,logoUrl:n.logoUrl,upi_id:n.upi_id,address:n.address,notes:n.notes})});if(!I.ok){const q=await I.json();throw new Error(q.message||"Failed to update settings.")}const D=await I.json();t({admissionCharge:parseFloat(D.settings.admissionCharge).toFixed(2),perDayCharge:parseFloat(D.settings.perDayCharge).toFixed(2),otherCharges:parseFloat(D.settings.otherCharges).toFixed(2),aiMemory:D.settings.aiMemory||"",clinicWideSystemPrompt:D.settings.clinicWideSystemPrompt||"",gemini_api_key:D.settings.gemini_api_key||"",low_stock_threshold:D.settings.low_stock_threshold!==void 0&&D.settings.low_stock_threshold!==null?String(D.settings.low_stock_threshold):"10",aiLanguage:D.settings.aiLanguage||"",name:D.settings.name||"",logoUrl:D.settings.logoUrl||"",upi_id:D.settings.upi_id||"",address:D.settings.address||"",notes:D.settings.notes||""}),h("Clinic settings updated successfully!"),setTimeout(()=>h(null),3e3)}catch(I){console.error("Error updating settings:",I),d(`Update failed: ${I.message}`)}finally{l(!1)}};return r?i.jsxs("div",{className:"loading-animation-container",children:[i.jsx("div",{className:"breathing-ball"}),i.jsx("div",{className:"loading-text",children:"Loading settings..."})]}):i.jsxs("div",{className:"clinic-settings-container",children:[i.jsxs("div",{className:"clinic-settings-header-container",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button",children:i.jsx(Ut,{size:24})}),i.jsxs("h3",{className:"clinic-settings-header",children:[i.jsx(yg,{size:24}),"Clinic Settings"]})]}),f&&i.jsx("div",{className:"clinic-settings-alert clinic-settings-alert-error",role:"alert",children:f}),u&&i.jsx("div",{className:"clinic-settings-alert clinic-settings-alert-success",role:"alert",children:u}),i.jsxs("form",{onSubmit:b,className:"clinic-settings-form",children:[i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"name",className:"clinic-settings-label",children:"Clinic Name"}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name,onChange:g,className:"clinic-settings-input",disabled:s,placeholder:"e.g., My Awesome Clinic"})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"admissionCharge",className:"clinic-settings-label",children:[i.jsx(Ad,{size:16})," Admission Charge ()"]}),i.jsx("input",{type:"number",id:"admissionCharge",name:"admissionCharge",value:n.admissionCharge,onChange:g,className:"clinic-settings-input",step:"0.01",min:"0",required:!0,disabled:s,placeholder:"e.g., 500.00"})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"perDayCharge",className:"clinic-settings-label",children:[i.jsx(Ad,{size:16})," Per Day Charge ()"]}),i.jsx("input",{type:"number",id:"perDayCharge",name:"perDayCharge",value:n.perDayCharge,onChange:g,className:"clinic-settings-input",step:"0.01",min:"0",required:!0,disabled:s,placeholder:"e.g., 1000.00"})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"otherCharges",className:"clinic-settings-label",children:[i.jsx(Ad,{size:16})," Other Charges (Default/Misc.) ()"]}),i.jsx("input",{type:"number",id:"otherCharges",name:"otherCharges",value:n.otherCharges,onChange:g,className:"clinic-settings-input",step:"0.01",min:"0",required:!0,disabled:s,placeholder:"e.g., 50.00"})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"low_stock_threshold",className:"clinic-settings-label",children:[i.jsx(MI,{size:16})," Low Stock Notification Threshold"]}),i.jsx("input",{type:"number",id:"low_stock_threshold",name:"low_stock_threshold",value:n.low_stock_threshold,onChange:g,className:"clinic-settings-input",min:"0",required:!0,disabled:s,placeholder:"e.g., 10"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Set the minimum quantity of a drug to trigger a low stock notification."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"aiMemory",className:"clinic-settings-label",children:[i.jsx(m1,{size:16})," AI Memory (Plain Text)"]}),i.jsx("textarea",{id:"aiMemory",name:"aiMemory",value:n.aiMemory,onChange:g,className:"clinic-settings-textarea",disabled:s,placeholder:"Enter any clinic-wide notes or context for the AI..."}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter clinic-wide AI memory data as plain text."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"clinicWideSystemPrompt",className:"clinic-settings-label",children:[i.jsx(kM,{size:16})," Clinic-Wide AI System Prompt"]}),i.jsx("textarea",{id:"clinicWideSystemPrompt",name:"clinicWideSystemPrompt",value:n.clinicWideSystemPrompt,onChange:g,className:"clinic-settings-textarea",disabled:s,placeholder:"Enter the system prompt for the AI that will apply to all interactions within this clinic..."}),i.jsx("p",{className:"clinic-settings-help-text",children:"This prompt will be used as the base instruction for the AI across the clinic."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"aiLanguage",className:"clinic-settings-label",children:"AI Language"}),i.jsxs("select",{id:"aiLanguage",name:"aiLanguage",value:n.aiLanguage,onChange:g,className:"clinic-settings-input",disabled:s,children:[i.jsx("option",{value:"",children:"Select Language"}),i.jsx("option",{value:"English",children:"English"}),i.jsx("option",{value:"Hindi",children:"Hindi"}),i.jsx("option",{value:"Telugu",children:"Telugu"}),i.jsx("option",{value:"Tamil",children:"Tamil"}),i.jsx("option",{value:"Kannada",children:"Kannada"}),i.jsx("option",{value:"Malayalam",children:"Malayalam"}),i.jsx("option",{value:"Bengali",children:"Bengali"}),i.jsx("option",{value:"Gujarati",children:"Gujarati"}),i.jsx("option",{value:"Marathi",children:"Marathi"}),i.jsx("option",{value:"Punjabi",children:"Punjabi"})]}),i.jsx("p",{className:"clinic-settings-help-text",children:"Specify the language for AI interactions."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"logoUrl",className:"clinic-settings-label",children:"Clinic Logo URL"}),i.jsx("input",{type:"url",id:"logoUrl",name:"logoUrl",value:n.logoUrl,onChange:g,className:"clinic-settings-input",disabled:s,placeholder:"e.g., https://example.com/logo.png"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter the URL for your clinic's logo."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"upi_id",className:"clinic-settings-label",children:"UPI ID"}),i.jsx("input",{type:"text",id:"upi_id",name:"upi_id",value:n.upi_id,onChange:g,className:"clinic-settings-input",disabled:s,placeholder:"e.g., yourclinic@upi"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter your clinic's UPI ID for payments."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"address",className:"clinic-settings-label",children:"Clinic Address"}),i.jsx("textarea",{id:"address",name:"address",value:n.address,onChange:g,className:"clinic-settings-textarea",disabled:s,placeholder:"Enter your clinic's full address"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter the physical address of your clinic."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsx("label",{htmlFor:"notes",className:"clinic-settings-label",children:"Other Clinic Details/Notes"}),i.jsx("textarea",{id:"notes",name:"notes",value:n.notes,onChange:g,className:"clinic-settings-textarea",disabled:s,placeholder:"Enter any other relevant clinic details or notes"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Add any additional information or notes about your clinic."})]}),i.jsxs("div",{className:"clinic-settings-form-group",children:[i.jsxs("label",{htmlFor:"gemini_api_key",className:"clinic-settings-label",children:[i.jsx(m1,{size:16})," Gemini API Key"]}),i.jsx("input",{type:"text",id:"gemini_api_key",name:"gemini_api_key",value:n.gemini_api_key,onChange:g,className:"clinic-settings-input",disabled:s,placeholder:"Enter your Gemini API key"}),i.jsx("p",{className:"clinic-settings-help-text",children:"Enter your Gemini API key to enable AI features."})]}),i.jsx("div",{className:"clinic-settings-button-container",children:i.jsxs("button",{type:"submit",className:"clinic-settings-button",disabled:s,children:[i.jsx(Rd,{size:18})," ",s?"Saving...":"Save Settings"]})})]})]})},K7=({})=>{const e=wt(),[n,t]=w.useState("patientSearch"),[r]=w.useState(!1),[a,s]=w.useState(null),[l,f]=w.useState(null);return w.useEffect(()=>{if(l){const d=setTimeout(()=>f(null),5e3);return()=>clearTimeout(d)}},[l]),r?i.jsxs("div",{className:"loading-animation-container",children:[" ",i.jsx("div",{className:"breathing-ball"}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Admin Panel..."})]}):i.jsxs("div",{className:"admin-panel-container",children:[" ",l&&i.jsxs("div",{className:`alert-box ${l.type==="success"?"alert-box-success":"alert-box-error"} fixed top-4 right-4 z-[100]`,role:"alert",children:[i.jsx("div",{className:"alert-box-icon",children:l.type==="success"?i.jsx($a,{size:18}):i.jsx(Sr,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{children:l.message})}),i.jsx("button",{onClick:()=>f(null),className:"alert-box-close",children:i.jsx(Jn,{size:16})})]}),a&&i.jsxs("div",{className:"alert-box alert-box-error mb-4",role:"alert",children:[" ",i.jsx("div",{className:"alert-box-icon",children:i.jsx(Sr,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{className:"block sm:inline flex-1",children:a})}),i.jsx("button",{onClick:()=>s(null),className:"alert-box-close",children:i.jsx(Jn,{size:16})})]}),i.jsxs("div",{className:"admin-nav-bar",children:[" ",i.jsxs("button",{onClick:()=>window.location.reload(),className:"admin-nav-button",title:"Refresh Page",children:[i.jsx(jk,{})," "]}),i.jsxs("button",{onClick:()=>e("/dashboard/staff"),className:"admin-nav-button",children:[i.jsx(ig,{})," Staff"]}),i.jsx("button",{onClick:()=>t("moneyFlow"),className:`admin-nav-button ${n==="moneyFlow"?"active":""}`,children:"Money"}),i.jsx("button",{onClick:()=>t("inventory"),className:`admin-nav-button ${n==="inventory"?"active":""}`,children:"Inventory"}),i.jsx("button",{onClick:()=>e("/lab-inventory"),className:"admin-nav-button hidden-button",children:"Lab Inventory"}),i.jsxs("button",{onClick:()=>t("clinicSettings"),className:`admin-nav-button ${n==="clinicSettings"?"active":""}`,children:[i.jsx(yg,{})," Settings"]}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions"),className:"admin-nav-button hidden-button",children:[i.jsx(g1,{})," Patient Subscriptions"]}),i.jsxs("button",{onClick:()=>e("/start-clinic-subscription"),className:"admin-nav-button",children:[i.jsx(g1,{})," Buy Pro Plan"]}),i.jsx("button",{onClick:()=>e("/dashboard/recurring-medications"),className:"admin-nav-button",children:"Recurring Meds"}),i.jsxs("button",{onClick:()=>e("/create-lab-order"),className:"admin-nav-button",children:[i.jsx(Nk,{})," Lab Tests"]})]}),i.jsxs("div",{className:"admin-actions-bar",children:[" ",i.jsxs("button",{onClick:()=>e("/dashboard/patients"),className:"admin-action-button all-patients",children:[i.jsx(ig,{})," All Patients"]})]}),i.jsxs("div",{className:"space-y-6",children:[" ",n==="patientSearch"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(Th,{})}),n==="moneyFlow"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(r4,{})}),n==="inventory"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(b1,{})}),n==="clinicSettings"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(J7,{})})]})]})},$c=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},X7=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},wh=({title:e,icon:n,items:t,renderItemContent:r,isLoading:a,loadingText:s,noDataText:l})=>{const f=w.useMemo(()=>{const d={};t.forEach(h=>{if(isNaN(h.date.getTime())){d["Unknown Date"]||(d["Unknown Date"]=[]),d["Unknown Date"].push(h);return}const g=X7(h.originalDateString);d[g]||(d[g]=[]),d[g].push(h)});const u=Object.keys(d);return u.sort((h,g)=>{if(h==="Unknown Date")return 1;if(g==="Unknown Date")return-1;try{const b=k=>{const E=k.split(" ");if(E.length===3){const I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(E[1]);if(I!==-1)return new Date(parseInt(E[2]),I,parseInt(E[0]))}return new Date(k)},v=b(h),S=b(g);if(!isNaN(v.getTime())&&!isNaN(S.getTime()))return S.getTime()-v.getTime()}catch(b){console.error("Error parsing date for sorting:",b)}return g.localeCompare(h)}),u.map(h=>({date:h,items:d[h]}))},[t]);return i.jsxs("div",{className:"mb-2 p-2 bg-gray-50 rounded-md border border-gray-200",children:[i.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-1.5 border-b border-gray-300 pb-1 flex items-center",children:[" ",n&&i.jsx(n,{size:14,className:"mr-1.5 text-indigo-600"})," ",e]}),a&&i.jsx("p",{className:"text-gray-500 italic text-xs px-1",children:s}),!a&&t.length===0&&i.jsx("p",{className:"text-gray-500 italic text-xs px-1",children:l}),!a&&t.length>0&&i.jsxs("div",{className:"space-y-2",children:[" ",f.map(({date:d,items:u})=>i.jsxs("div",{className:"pl-0.5",children:[" ",i.jsxs("h5",{className:"text-[11px] font-medium text-indigo-700 mb-1 bg-indigo-50 px-1 py-0.5 rounded-sm inline-block",children:[" ",d]}),i.jsx("div",{className:"space-y-1 pl-1.5 border-l-2 border-indigo-200 ml-0.5",children:u.map((h,g)=>i.jsxs("div",{className:"text-xs py-0 flex items-start",children:[" ",i.jsx("div",{className:"flex-grow mr-1",children:r(h)})," "]},`${h.type}-${h.originalDateString}-${g}`))})]},d))]})]})},Pv=()=>{var ae,Z;const[e,n]=w.useState({currentPatient:null,nextPatient:null,waitingCount:0}),[t,r]=w.useState(!0),[a,s]=w.useState(null),[l,f]=w.useState(null),[d,u]=w.useState(null),[h,g]=w.useState(null),[b,v]=w.useState({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),[S,k]=w.useState(!1),[E,T]=w.useState(null),{patientId:I}=ki(),D=wt(),q=w.useCallback(async B=>{g(null),f(null),u(null),k(!0),T(null),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]});try{const K=await ge(`/api/patients/${B}`);if(!K.ok)throw new Error(`Patient details fetch failed (${K.status})`);const oe=await K.json();f(oe);const A=await ge(`/api/queue/patient/${B}/latest`);if(!A.ok&&A.status!==404)throw new Error(`Queue entry fetch failed (${A.status})`);if(A.ok){const se=await A.json();u(se)}await R(B)}catch(K){console.error("Error fetching specific patient data:",K),g(K.message||"Failed to load patient data."),T(K.message||"Failed to load patient history.")}finally{k(!1)}},[]),R=w.useCallback(async B=>{k(!0),T(null);try{const[K,oe,A,se]=await Promise.all([ge(`/api/queue/patient/${B}/complaints`),ge(`/api/lab/patient/${B}`),ge(`/api/lab/orders/patient/${B}?status=pending`),ge(`/api/pharmacy-orders/patient/${B}`)]),ue=K.ok?await K.json():[],M=oe.ok?await oe.json():[],pe=A.ok?await A.json():[],be=se.ok?await se.json():[];v({pastComplaints:ue||[],labReports:M||[],pendingLabOrders:pe||[],pharmacyOrders:be||[]})}catch(K){console.error("Error fetching patient history:",K),T(K.message||"Failed to load patient history."),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]})}finally{k(!1)}},[]),F=w.useCallback(async()=>{r(!0),s(null);try{const B=await ge("/api/queue/doctor");if(!B.ok){const oe=await B.text();throw new Error(`API Error (${B.status}): ${oe||B.statusText}`)}const K=await B.json();if(K===null||typeof K!="object"||typeof K.waitingCount!="number")throw console.error("Invalid queue data format:",K),new Error("Invalid queue data format received");n({currentPatient:K.currentPatient||null,nextPatient:K.nextPatient||null,waitingCount:K.waitingCount})}catch(B){console.error("Error fetching queue data:",B),s(B.message||"Failed to fetch queue data.")}finally{r(!1)}},[]);w.useEffect(()=>{let B=null;return I?(q(I),n({currentPatient:null,nextPatient:null,waitingCount:0})):(F(),B=setInterval(F,1e4),f(null),u(null)),()=>{B&&clearInterval(B)}},[I,q,F]),w.useEffect(()=>{var B;!I&&((B=e.currentPatient)!=null&&B.patientId)?R(e.currentPatient.patientId):!I&&!e.currentPatient&&(v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),T(null))},[I,(ae=e.currentPatient)==null?void 0:ae.patientId,R]);const U=((Z=e.currentPatient)==null?void 0:Z.patientId)||(I?parseInt(I,10):null),z=w.useMemo(()=>{if(!U||!b.pastComplaints)return[];const B=b.pastComplaints.map(K=>({date:new Date(K.createdAt),type:"Complaint",data:K,originalDateString:K.createdAt})).filter(K=>!isNaN(K.date.getTime()));return B.sort((K,oe)=>oe.date.getTime()-K.date.getTime()),B},[U,b.pastComplaints]),V=w.useMemo(()=>{if(!U)return[];const B=[];return(b.pendingLabOrders??[]).forEach(K=>{const oe=new Date(K.createdAt);isNaN(oe.getTime())||B.push({date:oe,type:"Lab Order (Pending)",data:K,originalDateString:K.createdAt})}),(b.labReports??[]).forEach(K=>{const oe=K.reportCreatedAt?new Date(K.reportCreatedAt):null;oe&&!isNaN(oe.getTime())&&B.push({date:oe,type:"Lab Report",data:K,originalDateString:K.reportCreatedAt})}),B.sort((K,oe)=>oe.date.getTime()-K.date.getTime()),B},[U,b.pendingLabOrders,b.labReports]),L=w.useMemo(()=>{if(!U||!b.pharmacyOrders)return[];const B=b.pharmacyOrders.map(K=>({date:new Date(K.date),type:"Pharmacy Order",data:K,originalDateString:K.date})).filter(K=>!isNaN(K.date.getTime()));return B.sort((K,oe)=>oe.date.getTime()-K.date.getTime()),B},[U,b.pharmacyOrders]),$=async()=>{r(!0),s(null);try{await ge("/api/queue/doctor/next",{method:"POST"}),await F()}catch(B){console.error("Error calling next patient:",B),s(B.message||"Failed to call next patient.")}finally{r(!1)}},H=async()=>{if(!(!e.currentPatient||I)){r(!0),s(null);try{await ge(`/api/queue/doctor/complete/${e.currentPatient._id}`,{method:"POST"}),await F(),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),T(null)}catch(B){console.error("Error completing consultation:",B),s(B.message||"Failed to complete consultation.")}finally{r(!1)}}},ee=B=>{switch(B){case"waiting":return"Waiting";case"consulting":return"Consulting";case"seen":return"Seen";case"cancelled":return"Cancelled";default:return B}};let te=null;return e.currentPatient&&(te=i.jsxs("div",{className:"patient-info-section bg-white rounded-lg shadow-md p-4 md:p-6 border-l-8 border-teal-500",children:[i.jsx("h2",{className:"text-xl text-teal-700 font-semibold mb-3",children:"NOW SEEING:"}),i.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[i.jsxs("div",{className:"flex-grow md:w-1/2",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{className:"flex-grow mr-4",children:[i.jsx("div",{className:"text-3xl md:text-4xl font-bold text-gray-800 mb-1",children:e.currentPatient.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-600",children:[i.jsx("span",{className:"font-bold",children:e.currentPatient.age})," | ",i.jsx("span",{className:"font-bold",children:e.currentPatient.gender})]})]}),i.jsxs("div",{className:"text-right flex-shrink-0",children:[i.jsx("div",{className:"text-2xl md:text-3xl font-bold text-gray-700 mb-1",children:e.currentPatient.token}),i.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-sm md:text-base font-medium ${e.currentPatient.status==="consulting"?"bg-teal-100 text-teal-800":"bg-gray-100 text-gray-800"}`,children:ee(e.currentPatient.status)})]})]}),i.jsxs("div",{className:"actions-section mt-4 md:mt-6 flex justify-end space-x-3 border-t pt-4",children:[i.jsx("button",{onClick:()=>{var K;const B=(K=e.currentPatient)==null?void 0:K._id;B&&D(`/dashboard/edit-complaint/${B}`)},disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:"Edit Complaint / AI"}),i.jsx("button",{onClick:H,disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-success disabled:opacity-50 disabled:cursor-not-allowed",children:"Complete Consultation"})]})]})," ",i.jsxs("div",{className:"complaint-section md:w-1/2 mt-4 md:mt-0 border-t md:border-t-0 md:border-l md:pl-6 pt-4 md:pt-0",children:[i.jsx("h3",{className:"text-base font-semibold text-gray-800 mb-2",children:"Context & History:"}),E&&i.jsx("p",{className:"text-red-500 text-xs mb-2",children:E}),i.jsxs("div",{className:"space-y-2 pr-2",children:[i.jsx(wh,{title:"Complaints History",icon:Uo,items:z,isLoading:S,loadingText:"Loading complaints...",noDataText:"No past complaints found.",renderItemContent:B=>i.jsxs("span",{className:"block text-xs",children:[B.data.complaint,i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",$c(B.originalDateString),")"]})]})}),i.jsx(wh,{title:"Lab History (Orders & Reports)",icon:db,items:V,isLoading:S,loadingText:"Loading lab history...",noDataText:"No lab history found.",renderItemContent:B=>B.type==="Lab Order (Pending)"?i.jsxs("span",{className:"flex items-start text-xs",children:[i.jsx(ZS,{size:12,className:"mr-1.5 mt-0.5 text-blue-600 flex-shrink-0"}),i.jsxs("span",{className:"block",children:[i.jsx("span",{className:"font-medium text-blue-700",children:"Order:"})," ",B.data.tests.map(K=>K.name).join(", ")," ",i.jsxs("span",{className:"text-gray-600",children:["(",B.data.status,")"]}),i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",$c(B.originalDateString),")"]})]})]}):i.jsxs("span",{className:"flex items-start text-xs",children:[i.jsx(eN,{size:12,className:"mr-1.5 mt-0.5 text-green-600 flex-shrink-0"}),i.jsxs("span",{className:"block",children:[i.jsx("span",{className:"font-medium text-green-700",children:"Report:"})," ",B.data.testName," - ",B.data.reportFindings.substring(0,50),B.data.reportFindings.length>50?"...":"",i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",$c(B.originalDateString),")"]})]})]})}),i.jsx(wh,{title:"Pharmacy Order History",icon:Id,items:L,isLoading:S,loadingText:"Loading pharmacy orders...",noDataText:"No pharmacy order history found.",renderItemContent:B=>i.jsxs("span",{className:"block text-xs",children:[B.data.medications.map(K=>`${K.name} (Qty: ${K.quantity})`).join(", ")," ",i.jsxs("span",{className:"text-gray-600",children:["(",B.data.status,")"]}),i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",$c(B.originalDateString),")"]})]})}),z.length===0&&V.length===0&&L.length===0&&!S&&i.jsx("p",{className:"text-gray-500 italic text-xs mt-2 px-1",children:"No history found for this patient."})]})," "]})," "]})," "]})),i.jsx(i.Fragment,{children:i.jsxs("div",{className:"doctor-screen-container flex-grow flex flex-col space-y-6 md:space-y-8",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("button",{onClick:()=>D(-1),className:"back-button mr-4",children:i.jsx(Ut,{size:24})}),i.jsx("h1",{className:"doctor-screen-header",children:"Doctor Consultation Panel"})]}),I?i.jsxs(i.Fragment,{children:[h&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:h}),l&&i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border-l-8 border-purple-500",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"text-xl text-purple-700 font-semibold",children:"Patient Record:"}),i.jsx("button",{onClick:()=>D("/dashboard/doctor"),className:"text-sm text-blue-600 hover:underline",children:"Back to Queue"})]}),i.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-1 md:mb-2",children:l.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-600 mb-3 md:mb-4",children:["Age: ",l.age??"N/A"," | ",l.gender??"N/A"]}),i.jsxs("div",{className:"mt-3 md:mt-4 p-3 bg-gray-50 rounded border border-gray-200",children:[i.jsx("label",{className:"font-medium block mb-1 text-sm text-gray-600",children:"Latest Queue Entry:"}),d?i.jsxs("div",{className:"space-y-2",children:[" ",i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("span",{className:"text-sm flex-1 break-words",children:[i.jsxs("span",{className:"font-medium text-gray-700",children:["(",d.age," / ",d.gender,")"]}),": ",d.complaint||i.jsx("span",{className:"text-gray-400 italic",children:"No complaint"}),i.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full text-xs font-medium ${d.status==="consulting"?"bg-teal-100 text-teal-800":d.status==="seen"?"bg-green-100 text-green-800":d.status==="waiting"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:ee(d.status)})]}),d.status==="consulting"&&d._id&&i.jsx("button",{onClick:()=>D(`/dashboard/edit-complaint/${d._id}`),className:"ml-4 px-2 py-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 rounded flex-shrink-0",children:"Edit"})]}),d.case_summary&&i.jsxs("p",{className:"text-xs text-gray-700 bg-yellow-50 p-2 rounded border border-yellow-200",children:[i.jsx("span",{className:"font-semibold text-gray-800",children:"AI Summary:"})," ",d.case_summary]})]}):i.jsx("p",{className:"text-gray-500 italic text-sm",children:"No queue entry found for this patient today."})]}),i.jsxs("div",{className:"mt-4 border-t pt-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Patient History:"}),E&&i.jsx("p",{className:"text-red-500 text-xs mb-2",children:E}),i.jsx(wh,{title:"Complaints History",icon:Uo,items:z,isLoading:S,loadingText:"Loading complaints...",noDataText:"No past complaints found.",renderItemContent:B=>i.jsxs("span",{className:"block text-xs",children:[" ",B.data.complaint,i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",$c(B.originalDateString),")"]})]})}),i.jsx(wh,{title:"Lab History (Orders & Reports)",icon:db,items:V,isLoading:S,loadingText:"Loading lab history...",noDataText:"No lab history found.",renderItemContent:B=>B.type==="Lab Order (Pending)"?i.jsxs("span",{className:"flex items-start text-xs",children:[" ",i.jsx(ZS,{size:12,className:"mr-1.5 mt-0.5 text-blue-600 flex-shrink-0"})," ",i.jsxs("span",{className:"block",children:[i.jsx("span",{className:"font-medium text-blue-700",children:"Order:"})," ",B.data.tests.map(K=>K.name).join(", ")," ",i.jsxs("span",{className:"text-gray-600",children:["(",B.data.status,")"]}),i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",$c(B.originalDateString),")"]})]})]}):i.jsxs("span",{className:"flex items-start text-xs",children:[" ",i.jsx(eN,{size:12,className:"mr-1.5 mt-0.5 text-green-600 flex-shrink-0"})," ",i.jsxs("span",{className:"block",children:[i.jsx("span",{className:"font-medium text-green-700",children:"Report:"})," ",B.data.testName," - ",B.data.reportFindings.substring(0,50),B.data.reportFindings.length>50?"...":"",i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",$c(B.originalDateString),")"]})]})]})}),i.jsx(wh,{title:"Pharmacy Order History",icon:Id,items:L,isLoading:S,loadingText:"Loading pharmacy orders...",noDataText:"No pharmacy order history found.",renderItemContent:B=>i.jsxs("span",{className:"block text-xs",children:[" ",B.data.medications.map(K=>`${K.name} (Qty: ${K.quantity})`).join(", ")," ",i.jsxs("span",{className:"text-gray-600",children:["(",B.data.status,")"]}),i.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",$c(B.originalDateString),")"]})]})}),z.length===0&&V.length===0&&L.length===0&&!S&&i.jsx("p",{className:"text-gray-500 italic text-sm mt-2",children:"No history found."})]})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex justify-end space-x-3 mb-4",children:[i.jsxs("button",{onClick:()=>D("/dashboard/add-patient"),className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded shadow flex items-center",children:[i.jsx(Tk,{size:18,className:"mr-2"})," Add Patient"]}),i.jsx("button",{onClick:()=>D("/search-patient"),className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded shadow",children:"Search Patient"})]}),a&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:a}),t&&!e.currentPatient&&i.jsx("p",{className:"text-gray-500 p-4 text-center",children:"Loading queue..."}),i.jsx("div",{className:"mb-6 md:mb-8",children:te||i.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 text-center text-gray-500",children:"No patient currently being seen. Use 'Call Next' or search for a patient record."})}),i.jsxs("div",{className:"current-queue-section mb-6 md:mb-8",children:[i.jsx("h2",{className:"text-xl text-blue-700 font-semibold mb-3 md:mb-4",children:"NEXT IN QUEUE:"}),e.nextPatient?i.jsxs("div",{className:"patient-info-section bg-blue-50 rounded-lg shadow-md p-5 md:p-6 border-l-8 border-blue-500",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 md:mb-4",children:[i.jsxs("span",{className:"text-2xl md:text-3xl font-bold text-blue-800 mb-2 sm:mb-0",children:["Token #",e.nextPatient.token]}),i.jsx("span",{className:`px-3 py-1 rounded-full text-sm md:text-base font-medium ${e.nextPatient.status==="waiting"?"bg-blue-200 text-blue-900":"bg-gray-200 text-gray-800"}`,children:ee(e.nextPatient.status)})]}),i.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-2 md:mb-3",children:e.nextPatient.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-700 mb-3 md:mb-4",children:["Age: ",e.nextPatient.age," | ",e.nextPatient.gender]}),(e.nextPatient.complaint||e.nextPatient.case_summary)&&i.jsxs("div",{className:"mt-3 md:mt-4 pt-3 border-t border-blue-200 space-y-2",children:[e.nextPatient.complaint&&i.jsxs("p",{className:"text-base md:text-lg text-gray-800",children:[i.jsx("span",{className:"font-semibold text-gray-900",children:"Complaint:"})," ",e.nextPatient.complaint]}),e.nextPatient.case_summary&&i.jsxs("p",{className:"text-sm text-gray-700 bg-yellow-50 p-2 rounded border border-yellow-200",children:[i.jsx("span",{className:"font-semibold text-gray-800",children:"AI Summary:"})," ",e.nextPatient.case_summary]})]})]}):i.jsx("div",{className:"bg-gray-50 rounded-lg shadow-inner p-6 text-center text-gray-600 border border-gray-200",children:"No patient waiting next in the queue."})]}),i.jsxs("div",{className:"actions-section mt-auto pt-4 md:pt-6 flex flex-col sm:flex-row justify-between items-center gap-4",children:[i.jsx("button",{onClick:$,disabled:t||!e.nextPatient||!!e.currentPatient,className:"btn btn-primary w-full sm:w-auto disabled:opacity-50 disabled:cursor-not-allowed order-1 sm:order-none",children:"Call Next Patient"}),i.jsx("div",{className:"bg-gray-200 inline-block px-4 py-2 rounded-full order-2 sm:order-none",children:i.jsxs("span",{className:"text-base md:text-lg font-medium",children:[e.waitingCount," patients waiting"]})})]})]})]})})},NE=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,s]=w.useState(null),[l,f]=w.useState(null),[d,u]=w.useState(null),[h,g]=w.useState(null),[b,v]=w.useState(!1),[S,k]=w.useState(!1),[E,T]=w.useState(null),I=wt(),D=w.useCallback(J2.debounce(async L=>{if(L.trim().length<2){r([]),k(!1);return}k(!0),T(null);try{const $=new URLSearchParams({search:encodeURIComponent(L),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),H=await ge(`/api/patients?${$.toString()}`);if(!H.ok){const te=await H.text();throw new Error(`API Error (${H.status}): ${te||H.statusText||"Failed to fetch patients"}`)}const ee=await H.json();r(ee.patients)}catch($){T($ instanceof Error?$.message:"An unknown error occurred while searching patients"),r([])}finally{k(!1)}},500),[]);w.useEffect(()=>(e?(k(!0),D(e)):(r([]),D.cancel()),()=>{D.cancel()}),[e,D]);const q=L=>{s(L),n(""),r([]),T(null),f(null),u(null),g(null),v(!1)},R=async()=>{if(!a){T("No patient selected.");return}T(null),k(!0);try{const L=await ge(`/api/patients/${a.id}/admit`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!L.ok){const H=await L.json().catch(()=>({message:"Failed to admit patient"}));throw new Error(H.message||"Failed to admit patient")}const $=await L.json();alert($.message||"Patient admitted successfully!"),$.bill&&$.bill.id?I(`/patient/${a.id}/admission-bill/${$.bill.id}`):(console.error("Admission successful, but bill ID missing in response."),T("Admission successful, but couldn't navigate to billing."),s($.patient))}catch(L){T(L instanceof Error?L.message:"Failed to admit patient")}finally{k(!1)}};w.useEffect(()=>{(async()=>{if(!a||!a.admission_date||a.discharge_date){f(null),g(null);return}v(!0),u(null),f(null),g(null);try{const $=await ge(`/api/patients/${a.id}/active-bill?type=admission`);if(!$.ok)throw $.status===404?new Error("No active admission bill found."):new Error("Failed to fetch active bill ID.");const H=await $.json(),ee=H==null?void 0:H.id;if(!ee)throw new Error("Active admission bill ID not found in response.");f(ee);const te=await ge(`/api/bills/${ee}`);if(!te.ok)throw new Error(`Failed to fetch bill details (ID: ${ee}). Status: ${te.status}`);const ae=await te.json();if(ae&&ae.calculated)g(ae.calculated);else throw console.error("Fetched bill details missing 'calculated' object:",ae),new Error("Fetched bill details are incomplete (missing calculated data).")}catch($){u($ instanceof Error?$.message:"An unknown error occurred while fetching bill details."),f(null),g(null)}finally{v(!1)}})()},[a]);const F=async()=>{if(!a){T("No patient selected.");return}if(!a.admission_date||a.discharge_date){T("Patient is not currently admitted.");return}T(null),k(!0);try{const L=await ge(`/api/patients/${a.id}/discharge`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!L.ok){const H=await L.json().catch(()=>({message:"Failed to discharge patient"}));throw new Error(H.message||"Failed to discharge patient")}const $=await L.json();alert($.message||"Patient discharged successfully!"),$.patient?s($.patient):(console.error("Discharge successful, but updated patient info missing in response."),s(null),T("Discharge successful, but couldn't update patient details locally."))}catch(L){T(L instanceof Error?L.message:"Failed to discharge patient")}finally{k(!1)}},U=()=>{if(!a||!l){T("Cannot navigate to billing: Patient or Bill ID missing.");return}I(`/patient/${a.id}/admission-bill/${l}`)};let z="",V=null;if(a){const L=a.admission_date?new Date(a.admission_date).toLocaleDateString():null,$=a.discharge_date?new Date(a.discharge_date).toLocaleDateString():null;a.admission_date?a.admission_date&&!a.discharge_date?(z=`Patient admitted on: ${L}`,V=i.jsxs("div",{className:"space-y-4",children:[" ",b&&i.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Loading billing details..."})," ",d&&i.jsx("p",{className:"text-sm text-red-500 text-center",children:d})," ",!b&&h&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Total Due:"}),i.jsxs("span",{children:["",(Number(h.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[" ",i.jsx("span",{children:"Total Paid:"}),i.jsxs("span",{children:["",(Number(h.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm font-bold mt-1 text-red-600",children:[" ",i.jsx("span",{children:"Balance Due:"}),i.jsxs("span",{children:["",(Number(h.balance)||0).toFixed(2)]})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("button",{onClick:U,disabled:S||b||!l,className:`admission-button admission-button-secondary ${S||b||!l?"opacity-50 cursor-not-allowed":""}`,children:b?"Loading Bill...":!l&&!d?"Finding Bill...":"Pay Bill / View Details"}),i.jsx("button",{onClick:F,disabled:S||b,className:`admission-button admission-button-danger ${S||b?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Discharge Patient"})]})]})):(z=`Patient admitted on ${L} and discharged on ${$}.`,V=i.jsx("p",{className:"text-center text-gray-600 italic",children:"Patient has been discharged."})):(z="Patient is not admitted.",V=i.jsx("button",{onClick:R,disabled:S,className:`admission-button ${S?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Admit Patient"}))}return i.jsxs("div",{className:"admission-page-container",children:[i.jsxs("div",{className:"admission-header-container",children:[i.jsxs("button",{onClick:()=>I(-1),className:"back-button",children:[i.jsx(Ut,{size:16}),"Back"]}),i.jsx("h1",{className:"admission-header",children:"Manage Admission/Discharge"})]}),i.jsxs("div",{className:"admission-section mb-6 relative",children:[i.jsx("label",{htmlFor:"patientSearch",className:"admission-label",children:"Search Patient (Name, Phone, or Token)"}),i.jsx("input",{type:"text",id:"patientSearch",value:e,onChange:L=>n(L.target.value),placeholder:"Start typing to search...",className:"admission-input"}),S&&!a&&i.jsx("div",{className:"absolute right-3 top-9 text-sm text-gray-500",children:"Loading..."})," ",t.length>0&&!a&&i.jsxs("ul",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[" ",t.map(L=>i.jsxs("li",{onClick:()=>q(L),className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",children:[" ",L.name," (Token: ",L.token,")",i.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[L.admission_date?`Admitted: ${new Date(L.admission_date).toLocaleDateString()}`:"Not Admitted",L.discharge_date?`, Discharged: ${new Date(L.discharge_date).toLocaleDateString()}`:""]})]},L.id))]}),t.length===0&&e&&!S&&!a&&i.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg p-4 text-gray-500",children:['No patients found matching "',e,'".']})]}),a&&i.jsxs("div",{className:"admission-section",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"admission-section-title",children:"Selected Patient"}),i.jsx("button",{onClick:()=>s(null),className:"admission-link",children:"Clear Selection"})]}),i.jsxs("div",{className:"admission-card-content mb-4 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",a.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Token:"})," ",a.token]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Age:"})," ",a.age??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Gender:"})," ",a.gender??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Phone:"})," ",a.phone??"N/A"]}),i.jsxs("p",{className:"col-span-2",children:[i.jsx("strong",{children:"Address:"})," ",a.address??"N/A"]})]}),i.jsx("hr",{className:"my-4"}),i.jsx("p",{className:"text-sm text-gray-600 mb-3",children:z})," ",E&&i.jsx("p",{className:"text-red-500 text-sm mb-3",children:E})," ",V]})]})},Dv=15,V1=()=>{const e=wt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[s,l]=w.useState(null),[f,d]=w.useState(""),[u,h]=w.useState(1),[g,b]=w.useState(1),[v,S]=w.useState(0),[k,E]=w.useState("created_at"),[T,I]=w.useState("desc"),[D,q]=w.useState(""),[R,F]=w.useState(!1),[U,z]=w.useState(null),[V,L]=w.useState([]),[$,H]=w.useState(""),[ee,te]=w.useState(!1),[ae,Z]=w.useState(null),[B,K]=w.useState(null),[oe,A]=w.useState(!0),[se,ue]=w.useState(null),[M,pe]=w.useState(f);w.useEffect(()=>{const xe=setTimeout(()=>{pe(f),h(1)},500);return()=>{clearTimeout(xe)}},[f]);const be=w.useCallback(async()=>{A(!0),ue(null);try{const xe=await ge("/api/subscriptions");if(!xe.ok){let Ge=`Failed to fetch subscription plans (${xe.status})`;try{Ge=(await xe.json()).message||Ge}catch{}throw new Error(Ge)}const Ie=await xe.json();L(Ie)}catch(xe){console.error("Error fetching subscription plans:",xe),ue(xe.message||"An unknown error occurred while fetching plans."),L([])}finally{A(!1)}},[]),fe=w.useCallback(async(xe,Ie,Ge,ze,nt)=>{a(!0),l(null);try{const jt=new URLSearchParams({page:xe.toString(),limit:Dv.toString(),sortBy:Ge,sortOrder:ze});Ie&&jt.append("search",Ie),nt&&jt.append("gender",nt);const xt=await ge(`/api/patients?${jt.toString()}`);if(!xt.ok){const qe=await xt.json();throw new Error(qe.message||"Failed to fetch patients")}const ve=await xt.json();t(ve.patients),S(ve.totalCount),h(ve.currentPage),b(ve.totalPages)}catch(jt){console.error("Error fetching patients:",jt),l(`Failed to load patients: ${jt.message}`),t([]),S(0),h(1),b(1)}finally{a(!1)}},[]);w.useEffect(()=>{fe(u,M,k,T,D),be()},[u,M,k,T,D,fe,be]);const Pe=xe=>{const Ie=k===xe&&T==="asc"?"desc":"asc";E(xe),I(Ie),h(1)},de=xe=>{try{return new Date(xe).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},Me=()=>{F(!1),z(null),H(""),Z(null),te(!1)},Ze=async(xe,Ie)=>{t(Ge=>Ge.map(ze=>ze.id===xe?{...ze,insurance_type:Ie}:ze));try{const Ge=await ge(`/api/patients/${xe}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:Ie})});if(!Ge.ok){const ze=await Ge.json();throw new Error(ze.message||"Failed to update insurance type")}}catch(Ge){console.error("Error updating insurance type:",Ge),fe(u,M,k,T,D)}},Fe=(xe,Ie)=>{const Ge=new Date(xe),ze=Ie.interval||1;switch(Ie.period){case"daily":Ge.setDate(xe.getDate()+ze);break;case"weekly":Ge.setDate(xe.getDate()+ze*7);break;case"monthly":Ge.setMonth(xe.getMonth()+ze);break;case"yearly":Ge.setFullYear(xe.getFullYear()+ze);break;default:console.warn(`Unknown subscription period: ${Ie.period}. Defaulting to 1 month.`),Ge.setMonth(xe.getMonth()+1)}return Ge},Ce=async()=>{if(!U||!$){Z("Please select a subscription plan.");return}const xe=V.find(Ie=>Ie.id===$);if(!xe){Z("Selected plan details not found.");return}te(!0),Z(null);try{const Ie=new Date,Ge=Fe(Ie,xe),ze={subscription_plan_id:$,subscription_status:"active",subscription_start_date:Ie.toISOString(),subscription_end_date:Ge.toISOString(),subscription_payment_method:"manual"},nt=await ge(`/api/patients/${U.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ze)});if(!nt.ok){const jt=await nt.json();throw new Error(jt.message||"Failed to update patient subscription")}Me(),fe(u,M,k,T,D)}catch(Ie){console.error("Error starting subscription:",Ie),Z(`Failed to start subscription: ${Ie.message}`)}finally{te(!1)}},Re=async xe=>{if(!B){K(xe.id);try{const Ie=await ge(`/api/queue/patient/${xe.id}/latest`);if(Ie.ok){const nt=await Ie.json();if(nt!=null&&nt._id){e(`/dashboard/edit-complaint/${nt._id}`,{state:{patientId:xe.id}});return}}else if(Ie.status!==404){const nt=await Ie.text();throw new Error(`Failed to fetch queue entry: ${nt||Ie.statusText}`)}const Ge=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:xe.id})});if(!Ge.ok){const nt=await Ge.text();throw new Error(`Failed to create queue entry: ${nt||Ge.statusText}`)}const ze=await Ge.json();if(ze!=null&&ze.id)e(`/dashboard/edit-complaint/${ze.id}`,{state:{patientId:xe.id}});else throw new Error("Failed to get ID from new queue entry.")}catch(Ie){console.error("Error processing patient selection:",Ie),alert(Ie.message||"An error occurred while processing the selection.")}finally{K(null)}}};return i.jsxs("div",{className:"all-patients-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(Ut,{size:16}),"Back"]}),i.jsxs("h1",{className:"all-patients-title",children:[i.jsx(Gc,{size:28}),"All Registered Patients"]}),s&&i.jsxs("div",{className:"error-alert",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:s})]}),i.jsxs("div",{className:"subscription-plans-card",children:[i.jsx("h2",{className:"subscription-plans-title",children:"Available Subscription Plans"}),i.jsx("div",{children:oe?i.jsx("p",{className:"loading-state",children:"Loading plans..."}):se?i.jsxs("p",{className:"error-message",children:["Error loading plans: ",se]}):V.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("ul",{className:"subscription-plans-list",children:V.map(xe=>i.jsxs("li",{children:[i.jsx("strong",{children:xe.name}),": ",xe.price," / ",xe.interval," ",xe.period,xe.interval>1?"s":"",xe.description&&i.jsx("span",{className:"plan-description",children:xe.description})]},xe.id))})})]}),i.jsxs("div",{className:"controls-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by name or phone...",className:"search-input",value:f,onChange:xe=>d(xe.target.value)}),i.jsx(aa,{className:"search-input-icon",size:20})]}),i.jsxs("div",{className:"filter-dropdown-wrapper",children:[i.jsx("label",{htmlFor:"genderFilter",className:"sr-only",children:"Filter by Gender"}),i.jsxs("div",{className:"filter-select-container",children:[i.jsx(Ck,{size:16,className:"filter-select-icon"}),i.jsxs("select",{id:"genderFilter",value:D,onChange:xe=>q(xe.target.value),className:"filter-select",children:[i.jsx("option",{value:"",children:"All Genders"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]})]})]}),r?i.jsx("div",{className:"loading-state",children:"Loading patients..."}):n.length===0?i.jsx("div",{className:"empty-state",children:M?"No patients found matching your search.":"No patients registered yet."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"patients-table-wrapper",children:i.jsxs("table",{className:"patients-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Token"}),i.jsxs("th",{className:"sortable-header",onClick:()=>Pe("name"),children:["Name",k==="name"&&(T==="asc"?i.jsx(Pl,{size:14,className:"sort-icon"}):i.jsx(Uc,{size:14,className:"sort-icon"}))]}),i.jsx("th",{children:"Age"}),i.jsx("th",{children:"Gender"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Address"}),i.jsxs("th",{className:"sortable-header",onClick:()=>Pe("created_at"),children:["Registered On",k==="created_at"&&(T==="asc"?i.jsx(Pl,{size:14,className:"sort-icon"}):i.jsx(Uc,{size:14,className:"sort-icon"}))]}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Insurance Type"})," ",i.jsx("th",{children:"Action"})," "]})}),i.jsx("tbody",{children:n.map(xe=>i.jsxs("tr",{onClick:()=>Re(xe),className:`patient-row ${B===xe.id?"navigating":""}`,style:{cursor:"pointer",opacity:B===xe.id?.7:1},children:[i.jsx("td",{children:xe.token??"-"}),i.jsx("td",{className:"patient-name",children:xe.name}),i.jsx("td",{children:xe.age??"-"}),i.jsx("td",{children:xe.gender??"-"}),i.jsx("td",{children:xe.phone??"-"}),i.jsx("td",{children:xe.address??"-"}),i.jsx("td",{children:de(xe.created_at)}),i.jsx("td",{children:i.jsx("span",{className:`status-badge ${xe.subscription_status==="active"?"active":xe.subscription_status==="cancelled"||xe.subscription_status==="expired"?"inactive":"none"}`,children:xe.subscription_status??"None"})}),i.jsx("td",{children:i.jsxs("select",{value:xe.insurance_type,onChange:Ie=>Ze(xe.id,Ie.target.value),onClick:Ie=>Ie.stopPropagation(),className:"form-select insurance-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"insurance",children:"Insurance"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})}),i.jsx("td",{children:i.jsx("button",{onClick:Ie=>{Ie.stopPropagation(),e(`/start-subscription/${xe.id}`)},className:"action-button",children:"Start Sub"})})]},xe.id))})]})}),g>1&&i.jsxs("div",{className:"pagination-controls",children:[i.jsxs("div",{className:"pagination-info",children:["Showing"," ",i.jsx("span",{className:"font-medium",children:(u-1)*Dv+1})," ","to"," ",i.jsx("span",{className:"font-medium",children:Math.min(u*Dv,v)})," ","of"," ",i.jsx("span",{className:"font-medium",children:v})," results"]}),i.jsxs("div",{className:"pagination-buttons",children:[i.jsxs("button",{onClick:()=>h(xe=>Math.max(xe-1,1)),disabled:u===1||r,className:"pagination-button",children:[i.jsx(zb,{size:16,className:"prev-icon"}),"Previous"]}),i.jsxs("span",{className:"pagination-current-page",children:["Page ",i.jsx("span",{className:"font-medium",children:u})," of ",i.jsx("span",{className:"font-medium",children:g})]}),i.jsxs("button",{onClick:()=>h(xe=>Math.min(xe+1,g)),disabled:u===g||r,className:"pagination-button",children:["Next",i.jsx(gg,{size:16,className:"next-icon"})]})]})]})]}),R&&U&&i.jsx("div",{className:"subscription-modal-overlay",children:i.jsxs("div",{className:"subscription-modal-content",children:[i.jsxs("div",{className:"subscription-modal-header",children:[i.jsxs("h2",{className:"subscription-modal-title",children:["Start Subscription for ",U.name]}),i.jsx("button",{onClick:Me,className:"subscription-modal-close-button",children:i.jsx(Jn,{size:24})})]}),ae&&i.jsx("div",{className:"error-alert",role:"alert",children:i.jsx("span",{children:ae})}),i.jsxs("div",{className:"subscription-modal-body",children:[i.jsx("label",{htmlFor:"subscriptionPlan",className:"form-label",children:"Select Plan:"}),i.jsxs("select",{id:"subscriptionPlan",value:$,onChange:xe=>H(xe.target.value),className:"form-select",disabled:ee||oe||se!==null||V.length===0,children:[i.jsx("option",{value:"",disabled:!0,children:"-- Select a Plan --"}),oe?i.jsx("option",{value:"",disabled:!0,children:"Loading plans..."}):se?i.jsx("option",{value:"",disabled:!0,children:"Error loading plans"}):V.length>0?V.map(xe=>i.jsxs("option",{value:xe.id,children:[xe.name," - ",xe.price," (",xe.interval," ",xe.period,xe.interval>1?"s":"",")"]},xe.id)):i.jsx("option",{value:"",disabled:!0,children:"No active plans found"})]}),se&&i.jsx("p",{className:"error-message",children:se}),V.length===0&&!oe&&!se&&i.jsx("p",{className:"empty-state",children:"No active subscription plans available."})]}),i.jsxs("div",{className:"subscription-modal-footer",children:[i.jsx("button",{onClick:Me,disabled:ee,className:"subscription-modal-button cancel",children:"Cancel"}),i.jsx("button",{onClick:Ce,disabled:!$||ee,className:"subscription-modal-button submit",children:ee?"Starting...":"Start Subscription"})]})]})})]})},CE=()=>{const e=wt(),[n]=w.useState(!0),[t,r]=w.useState(""),[a,s]=w.useState([]),[l,f]=w.useState(!1),[d,u]=w.useState(null),[h,g]=w.useState(!1),b=/^\+?[0-9\s\-().]{7,20}$/,v=w.useMemo(()=>qb(async T=>{if(T.trim().length<2){s([]),f(!1),u(null);return}f(!0),u(null);try{const I=new URLSearchParams({search:encodeURIComponent(T),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),D=await ge(`/api/patients?${I.toString()}`);if(!D.ok){const R=await D.text();throw new Error(`API Error (${D.status}): ${R||D.statusText}`)}const q=await D.json();s(q.patients)}catch(I){console.error("Error searching patients:",I),u(I.message||"Failed to search patients."),s([])}finally{f(!1)}},300),[]),S=T=>{const I=T.target.value;r(I),g(b.test(I)),f(!0),v(I)},k=w.useCallback(T=>{e("/billing",{state:{patientId:T.id,patientName:T.name}})},[e]),E=w.useCallback(async()=>{if(!t||!h){u("Invalid phone number to create a new patient.");return}f(!0),u(null);try{const I=await ge("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"direct pharmacy",phone:t,age:null,gender:null,token:null})});if(!I.ok){const q=await I.json();throw new Error(q.message||`Failed to create patient: ${I.statusText}`)}const D=await I.json();alert(`New patient "direct pharmacy" created with phone ${D.phone}.`),k(D)}catch(T){console.error("Error creating new patient:",T),u(T.message||"Failed to create new patient.")}finally{f(!1)}},[t,h,k]);return i.jsxs("div",{className:"create-custom-bill-page p-4 md:p-6 max-w-5xl mx-auto",children:[i.jsx("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:i.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:i.jsx(Ut,{size:20})}),i.jsx("h2",{className:"text-2xl",children:"Create Custom Bill"})]})}),n&&i.jsxs("div",{className:"content-section",children:[i.jsx("h3",{className:"section-title",children:"Select Patient"}),i.jsxs("div",{className:"mb-3 relative",children:[i.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"}),i.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:t,onChange:S,className:"custom-text-input mt-1",autoFocus:!0}),l&&i.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),d&&i.jsx("div",{className:"ai-function-status error mb-3 p-3",children:d}),a.length>0&&i.jsx("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:i.jsx("ul",{children:a.map(T=>i.jsxs("li",{onClick:()=>k({id:T.id,name:T.name,token:T.token,age:T.age,gender:T.gender,phone:T.phone}),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[i.jsxs("div",{className:"font-medium",children:[i.jsxs("span",{className:"patient-token mr-2",children:["#",T.token]}),T.name]}),i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[T.age?`${T.age} yrs`:"Age N/A",T.gender?` / ${T.gender}`:" / Gender N/A",T.phone&&i.jsxs("span",{className:"hidden sm:inline",children:[" / ",T.phone]})]})]}),T.phone&&i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",T.phone]})]},T.id))})}),t.length>=2&&!l&&a.length===0&&!d&&i.jsxs(i.Fragment,{children:[i.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',t,'".']}),h&&i.jsx("button",{type:"button",onClick:E,className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:l,children:'Create "direct pharmacy" Patient with this Phone'})]}),t.length<2&&!l&&i.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]})]})},jE=({currentUser:e})=>{const n=wt(),[t,r]=w.useState("select_patient"),[a,s]=w.useState({name:"",age:void 0,gender:null,phone:"",address:""}),[l,f]=w.useState(null),[d,u]=w.useState([]),[h,g]=w.useState([]),[b,v]=w.useState(""),[S,k]=w.useState([]),[E,T]=w.useState(""),[I,D]=w.useState([]),[q,R]=w.useState(!1),[F,U]=w.useState(null),[z,V]=w.useState(null),[L,$]=w.useState(null),[H,ee]=w.useState(!1),[te,ae]=w.useState(!1),[Z,B]=w.useState(!1),K=/^\+?[0-9\s\-().]{7,20}$/,oe=/^[a-zA-Z\s'-]{2,}$/,A=w.useCallback(async()=>{if(!(d.length>0)){ee(!0),$(null);try{const Ce=await ge("/api/lab-tests");if(!Ce.ok)throw new Error("Failed to fetch lab tests");const Re=await Ce.json();u(Re)}catch(Ce){console.error("Failed to fetch available lab tests:",Ce),$("Could not load lab test list: "+Ce.message),u([])}finally{ee(!1)}}},[d.length]);w.useEffect(()=>{if(!b){k([]);return}const Ce=b.toLowerCase();k(d.filter(Re=>Re.name.toLowerCase().includes(Ce)||Re.description&&Re.description.toLowerCase().includes(Ce)).slice(0,10))},[b,d]);const se=w.useCallback(Ce=>{const Re={id:Ce.id,name:Ce.name,token:Ce.token,age:Ce.age,gender:Ce.gender,phone:Ce.phone};f(Re),r("create_order"),g([]),v(""),k([]),$(null),A()},[A]),ue=w.useMemo(()=>qb(async Ce=>{if(Ce.trim().length<2){D([]),R(!1),U(null);return}R(!0),U(null);try{const Re=new URLSearchParams({search:encodeURIComponent(Ce),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),xe=await ge(`/api/patients?${Re.toString()}`);if(!xe.ok){const Ge=await xe.text();throw new Error(`API Error (${xe.status}): ${Ge||xe.statusText}`)}const Ie=await xe.json();D(Ie.patients)}catch(Re){console.error("Error searching lab patients:",Re),U(Re.message||"Failed to search lab patients."),D([])}finally{R(!1)}},300),[K,oe]),M=Ce=>{const Re=Ce.target.value;T(Re),ae(K.test(Re)),B(oe.test(Re)&&!K.test(Re)),R(!0),ue(Re)},pe=w.useCallback(async Ce=>{if(!E||Ce==="phone"&&!te||Ce==="name"&&!Z){U(`Invalid ${Ce} to create a new patient.`);return}R(!0),U(null);try{const xe=await ge("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Ce==="name"?E:"direct lab",phone:Ce==="phone"?E:null,age:null,gender:null,token:null})});if(!xe.ok){const Ge=await xe.json();throw new Error(Ge.message||`Failed to create patient: ${xe.statusText}`)}const Ie=await xe.json();alert(`New patient "${Ie.name}" created with ${Ce==="phone"?`phone ${Ie.phone}`:`name ${Ie.name}`}.`),se({id:Ie.id,name:Ie.name,token:Ie.token??null,age:Ie.age??null,gender:Ie.gender??null,phone:Ie.phone})}catch(Re){console.error("Error creating new patient:",Re),U(Re.message||"Failed to create new patient.")}finally{R(!1)}},[E,te,Z,se]),be=()=>{s({name:"",age:void 0,gender:null,phone:"",address:""}),V(null),r("create_patient"),f(null)},fe=()=>{r("select_patient"),f(null),T(""),D([]),U(null)},Pe=Ce=>{const{name:Re,value:xe}=Ce.target;s(Ie=>({...Ie,[Re]:Re==="age"?xe?parseInt(xe,10):void 0:xe}))},de=async Ce=>{if(Ce.preventDefault(),V(null),!a.name){V("Patient Name is required.");return}const Re={name:a.name,age:a.age,gender:a.gender,phone:a.phone,address:a.address};try{const xe=await ge("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Re)});if(!xe.ok){const Ge=await xe.json();throw new Error(Ge.message||`Failed to create patient: ${xe.statusText}`)}const Ie=await xe.json();alert(`Patient "${Ie.name}" created successfully!`),se({id:Ie.id,name:Ie.name,token:Ie.token??null,age:Ie.age??null,gender:Ie.gender??null,phone:Ie.phone})}catch(xe){console.error("Failed to create patient:",xe),V(xe.message||"Failed to create patient. Please try again.")}},Me=Ce=>{if(h.some(Re=>Re.id===Ce.id)){$(`${Ce.name} is already in the order.`),setTimeout(()=>$(null),3e3),v(""),k([]);return}g(Re=>[...Re,{...Ce}]),v(""),k([])},Ze=Ce=>{g(Re=>Re.filter(xe=>xe.id!==Ce))},Fe=async Ce=>{if(Ce.preventDefault(),$(null),!l){$("No patient selected.");return}if(h.length===0){$("No lab tests selected.");return}const Re={patient_id:l.id,tests:h.map(xe=>({id:xe.id,name:xe.name,price:xe.price}))};console.log("Submitting Lab Order:",Re);try{const xe=await ge("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Re)});if(!xe.ok){const ze=await xe.json();throw console.error("API Error Data:",ze),new Error(ze.message||`Failed to create lab order: ${xe.statusText}`)}const Ie=await xe.json();console.log("Lab Order Creation Result:",Ie);let Ge=l.queueId;if(!Ge){const ze=await ge(`/api/queue/patient/${l.id}/latest`);if(ze.ok){const nt=await ze.json();nt!=null&&nt._id&&(Ge=nt._id)}}if(!Ge){const ze=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:l.id})});if(!ze.ok){const jt=await ze.text();throw new Error(`Failed to create queue entry for redirection: ${jt||ze.statusText}`)}const nt=await ze.json();if(nt!=null&&nt.id)Ge=nt.id;else throw new Error("Failed to get ID from new queue entry for redirection.")}alert(`Lab order created successfully for ${l.name}!`),(e==null?void 0:e.role)==="lab"?n("/dashboard"):n(`/dashboard/edit-complaint/${Ge}`,{state:{patientId:l.id}})}catch(xe){console.error("Failed to create lab order:",xe),$(xe.message||"Failed to create lab order.")}};return w.useEffect(()=>{A()},[A]),i.jsxs("div",{className:"lab-inventory-container",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[i.jsx(Ut,{size:18,className:"mr-2"}),"Back"]}),i.jsx("h1",{className:"lab-inventory-header",children:"Create New Lab Order"}),i.jsx("div",{className:"w-16"})," "]}),(t==="select_patient"||t==="create_patient")&&i.jsxs("div",{className:"lab-inventory-card",children:[t==="select_patient"&&i.jsxs(i.Fragment,{children:[i.jsx("h2",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"1px solid #eee",marginBottom:"15px"},children:"Select Existing Patient"}),i.jsxs("div",{className:"lab-inventory-form-group",style:{position:"relative"},children:[i.jsx("label",{htmlFor:"lab-patient-search",children:"Search Patient (Name, Token, or Phone)"}),i.jsx("input",{type:"text",id:"lab-patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:E,onChange:M,className:"lab-inventory-input",autoFocus:!0}),q&&i.jsx("span",{className:"loading-text",style:{position:"absolute",right:"10px",top:"35px",fontSize:"0.8em"},children:"Searching..."})]}),F&&i.jsx("div",{className:"error-text",children:F}),I.length>0&&i.jsx("div",{className:"lab-inventory-card",style:{maxHeight:"300px",overflowY:"auto",padding:"0",marginTop:"10px"},children:i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:I.map(Ce=>i.jsxs("li",{onClick:()=>se(Ce),className:"lab-inventory-link",style:{padding:"10px 15px",borderBottom:"1px solid #eee",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{children:[i.jsxs("span",{style:{color:"#007bff",marginRight:"10px"},children:["[#",Ce.token,"]"]}),Ce.name]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:[Ce.age?`${Ce.age} yrs`:"",Ce.age&&Ce.gender?" / ":"",Ce.gender||"N/A"]})]},Ce.id))})}),E.length>=2&&!q&&I.length===0&&!F&&i.jsxs(i.Fragment,{children:[i.jsxs("p",{className:"no-data-message",children:['No patients found matching "',E,'".']}),te&&i.jsx("button",{type:"button",onClick:()=>pe("phone"),className:"lab-inventory-button",style:{marginTop:"15px",marginRight:"10px"},disabled:q,children:'Create "direct lab" Patient with this Phone'}),Z&&i.jsx("button",{type:"button",onClick:()=>pe("name"),className:"lab-inventory-button",style:{marginTop:"15px"},disabled:q,children:"Create Patient with this Name"})]}),E.length<2&&!q&&i.jsx("p",{className:"no-data-message",style:{backgroundColor:"transparent",border:"none",textAlign:"left",padding:"5px 0"},children:"Enter at least 2 characters to search."}),i.jsx("button",{onClick:be,className:"lab-inventory-link",style:{marginTop:"15px",background:"none",border:"none",padding:"0",cursor:"pointer"},children:"Or, Register New Patient"})]}),t==="create_patient"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[i.jsx("h2",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"none",margin:"0"},children:"Register New Patient"}),i.jsx("button",{onClick:fe,className:"lab-inventory-link",style:{background:"none",border:"none",padding:"0",cursor:"pointer"},children:" Back to Search "})]}),z&&i.jsx("div",{className:"error-text",children:z}),i.jsxs("form",{onSubmit:de,children:[i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"15px"},children:[i.jsxs("div",{className:"lab-inventory-form-group",style:{gridColumn:"1 / -1"},children:[i.jsx("label",{htmlFor:"lab-patient-name",children:"Name *"}),i.jsx("input",{type:"text",name:"name",id:"lab-patient-name",required:!0,value:a.name,onChange:Pe,className:"lab-inventory-input"})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"lab-patient-age",children:"Age"}),i.jsx("input",{type:"number",name:"age",id:"lab-patient-age",value:a.age??"",onChange:Pe,className:"lab-inventory-input"})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"lab-patient-gender",children:"Gender"}),i.jsxs("select",{name:"gender",id:"lab-patient-gender",value:a.gender??"",onChange:Pe,className:"lab-inventory-select",children:[i.jsx("option",{value:"",children:"Select..."})," ",i.jsx("option",{value:"M",children:"Male"})," ",i.jsx("option",{value:"F",children:"Female"})," ",i.jsx("option",{value:"O",children:"Other"})]})]}),i.jsxs("div",{className:"lab-inventory-form-group",style:{gridColumn:"1 / -1"},children:[i.jsx("label",{htmlFor:"lab-patient-phone",children:"Phone"}),i.jsx("input",{type:"tel",name:"phone",id:"lab-patient-phone",value:a.phone||"",onChange:Pe,className:"lab-inventory-input"})]}),i.jsxs("div",{className:"lab-inventory-form-group",style:{gridColumn:"1 / -1"},children:[i.jsx("label",{htmlFor:"lab-patient-address",children:"Address"}),i.jsx("textarea",{name:"address",id:"lab-patient-address",rows:2,value:a.address||"",onChange:Pe,className:"lab-inventory-input"})]})]}),i.jsxs("div",{style:{marginTop:"20px",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[i.jsx("button",{type:"button",onClick:fe,className:"lab-inventory-button lab-inventory-button-secondary",children:" Cancel "}),i.jsx("button",{type:"submit",className:"lab-inventory-button",children:" Create Patient & Proceed "})]})]})]})]}),t==="create_order"&&l&&i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[i.jsxs("h2",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"none",margin:"0"},children:["Create Order for: ",l.name]}),i.jsx("button",{onClick:fe,className:"lab-inventory-link",style:{background:"none",border:"none",padding:"0",cursor:"pointer"},children:" Change Patient "})]}),i.jsxs("p",{style:{fontSize:"0.9em",color:"#555",marginBottom:"20px"},children:["ID: ",l.id.substring(0,8),"... ",l.age&&`| Age: ${l.age}`," ",l.gender&&`| Gender: ${l.gender}`]}),L&&i.jsx("div",{className:"error-text",children:L}),i.jsxs("form",{onSubmit:Fe,children:[i.jsxs("div",{className:"lab-inventory-form-group",style:{position:"relative"},children:[i.jsx("label",{htmlFor:"lab-test-search",children:"Add Lab Test"}),i.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search available lab tests...",value:b,onChange:Ce=>v(Ce.target.value),className:"lab-inventory-input",disabled:H}),H&&i.jsx("span",{className:"loading-text",style:{position:"absolute",right:"10px",top:"35px",fontSize:"0.8em"},children:"Loading tests..."}),b&&S.length>0&&i.jsx("div",{className:"lab-inventory-card",style:{maxHeight:"200px",overflowY:"auto",padding:"0",marginTop:"5px",position:"absolute",width:"100%",zIndex:10},children:i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:S.map(Ce=>i.jsxs("li",{onClick:()=>Me(Ce),className:"lab-inventory-link",style:{padding:"10px 15px",borderBottom:"1px solid #eee",cursor:"pointer",display:"flex",justifyContent:"space-between"},children:[i.jsx("span",{children:Ce.name}),i.jsxs("span",{style:{color:"#555",fontSize:"0.9em"},children:["(",parseFloat(Ce.price).toFixed(2),")"]})]},Ce.id))})}),b&&S.length===0&&!H&&i.jsxs("div",{className:"no-data-message",style:{marginTop:"5px"},children:['No tests found matching "',b,'".']})]}),i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"20px",maxHeight:"300px",overflowY:"auto"},children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.2em",borderBottom:"1px solid #eee",marginBottom:"10px"},children:"Selected Tests"}),h.length===0?i.jsx("p",{className:"no-data-message",style:{backgroundColor:"transparent",border:"none",textAlign:"left",padding:"0"},children:"No tests added yet."}):i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:h.map(Ce=>i.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid #f0f0f0"},children:[i.jsx("span",{style:{flex:1,marginRight:"10px"},children:Ce.name}),i.jsxs("span",{style:{fontWeight:"500",marginRight:"15px"},children:["",parseFloat(Ce.price).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>Ze(Ce.id),className:"lab-inventory-link",title:"Remove Test",style:{background:"none",border:"none",padding:"0",cursor:"pointer",color:"#dc3545"},children:i.jsx(ti,{size:16})})]},Ce.id))})]}),h.length>0&&i.jsxs("div",{style:{textAlign:"right",fontWeight:"bold",fontSize:"1.2em",marginTop:"20px",marginBottom:"20px"},children:["Total: ",h.reduce((Ce,Re)=>Ce+parseFloat(Re.price),0).toFixed(2)]}),i.jsxs("div",{style:{marginTop:"20px",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[i.jsx("button",{type:"button",onClick:fe,className:"lab-inventory-button lab-inventory-button-secondary",children:" Cancel Order "}),i.jsx("button",{type:"submit",disabled:h.length===0,className:`lab-inventory-button ${h.length===0?"opacity-50 cursor-not-allowed":""}`,children:" Create Lab Order "})]})]})]})]})},Z7=({currentUser:e})=>{const[n,t]=w.useState("newtons-ai"),[r,a]=w.useState(""),[s,l]=w.useState([]),[f,d]=w.useState(!0),[u,h]=w.useState([]),[g,b]=w.useState(!1),[v,S]=w.useState(null),[k,E]=w.useState(null),T=wt(),I=async()=>{d(!0),E(null);let V=[];try{const L=await ge("/api/queue");if(!L.ok){const ee=await L.json();throw new Error(ee.message||"Failed to fetch queue")}V=await L.json(),console.log("Fetched Initial Queue Data:",JSON.stringify(V,null,2));const $=V.map(async ee=>{if(!ee.patient_id)return console.warn(`Queue entry ${ee.id} has no patient_id.`),ee;try{const te=await ge(`/api/patients/${ee.patient_id}`);if(!te.ok)return console.error(`Failed to fetch patient details for ${ee.patient_id}: ${te.status}`),ee;const ae=await te.json();return{...ee,Patient:{...ee.Patient??{},...ae}}}catch(te){return console.error(`Error fetching patient details for ${ee.patient_id}:`,te),ee}}),H=await Promise.all($);console.log("Enriched Queue Data (Before Sort):",JSON.stringify(H,null,2)),H.sort((ee,te)=>{var oe,A;const ae=((oe=ee.Patient)==null?void 0:oe.subscription_status)==="active",Z=((A=te.Patient)==null?void 0:A.subscription_status)==="active";if(ae&&!Z)return-1;if(!ae&&Z)return 1;const B=ee.created_at?new Date(ee.created_at).getTime():0,K=te.created_at?new Date(te.created_at).getTime():0;return B-K}),console.log("Sorted Queue Data:",JSON.stringify(H,null,2)),l(H)}catch(L){console.error("Error in fetchQueue process:",L),E(`Failed to load queue: ${L.message}`),l(V)}finally{d(!1)}},D=async()=>{b(!0),E(null);try{const V=await ge("/api/staff?role=doctor");if(!V.ok){const $=await V.json();throw new Error($.message||"Failed to fetch doctors")}const L=await V.json();h(L.filter($=>$.active))}catch(V){console.error("Error fetching doctors:",V),E(`Failed to fetch doctors: ${V.message}`)}finally{b(!1)}};w.useEffect(()=>{n==="queue"&&(I(),D()),S(null)},[n]);const q=w.useCallback(async(V,L)=>{if(console.log(`Attempting to assign doctor ${L} to queue ${V}`),E(null),S(null),!L){console.log("No doctor ID provided, skipping assignment.");return}const $=s.find(te=>te.id===V);if(!$){console.error(`Queue entry ${V} not found in local state.`),E("Queue entry not found.");return}if($.doctor_id===L){console.log(`Queue ${V} already assigned to doctor ${L}. Skipping.`);return}const H=async te=>{if(!te||!te.id||!te.name){E("Cannot proceed: Patient ID or Name is missing."),console.error("assignAndNavigate called with invalid patientInfo",te);return}const ae=async()=>{try{const Z={status:"waiting",doctorId:L},B=await ge(`/api/queue/${V}/status`,{method:"PATCH",body:JSON.stringify(Z)}),K=await B.json();if(!B.ok)throw new Error(K.message||`HTTP error! status: ${B.status}`);const oe=u.find(A=>A.id===L);return console.log(`Successfully assigned doctor ${oe==null?void 0:oe.name} to queue ${V}.`),l(A=>A.map(se=>se.id===V?{...se,doctor_id:L,status:K.status||se.status,User:oe?{name:oe.name}:null,Patient:te}:se)),!0}catch(Z){return console.error(`Error assigning doctor for queue ${V}:`,Z),E(`Failed to assign doctor: ${Z.message}`),!1}};te.subscription_status==="active"?(console.log(`Patient ${te.name} (ID: ${te.id}) has active subscription. Assigning doctor directly.`),await ae()):(console.log(`Patient ${te.name} (ID: ${te.id}) does not have active subscription (Status: ${te.subscription_status}). Assigning doctor and proceeding to billing.`),await ae()?(console.log(`Navigating to billing for patient ${te.name} (ID: ${te.id}), queue ID: ${V}, doctor ID: ${L}`),T("/billing",{state:{patientId:te.id,queueId:V,patientName:te.name,doctorId:L,billType:"consultation"}})):console.log(`Assignment failed for patient ${te.name}, skipping navigation.`))},ee=$.Patient;if(ee&&ee.id&&ee.name)console.log("Patient details found in state. Proceeding with assignment."),await H(ee);else{console.warn(`Patient details missing for queue entry ${V}. Fetching patient ${$.patient_id}...`);try{const te=await ge(`/api/patients/${$.patient_id}`);if(!te.ok){const Z=await te.json().catch(()=>({}));throw new Error(Z.message||`Failed to fetch patient details (status ${te.status})`)}const ae=await te.json();console.log("Successfully fetched patient details:",ae),await H(ae)}catch(te){console.error(`Failed to fetch patient details for patient ID ${$.patient_id}:`,te),E(`Failed to fetch required patient details: ${te.message}`)}}},[u,s,T]),R=async(V,L)=>{E(null);const $=L==="consulting"?"start consultation":"complete visit";try{const H=s.find(Z=>Z.id===V);if(!H&&L==="consulting")throw new Error("Queue entry not found to start consultation.");let ee={status:L};if(L==="consulting"){if(!(H!=null&&H.doctor_id))throw new Error("Cannot start consultation without an assigned doctor.");ee.doctorId=H.doctor_id}const te=await ge(`/api/queue/${V}/status`,{method:"PATCH",body:JSON.stringify(ee)}),ae=await te.json();if(!te.ok)throw new Error(ae.message||`HTTP error! status: ${te.status}`);l(Z=>Z.map(B=>B.id===V?{...B,status:L}:B))}catch(H){console.error(`Error trying to ${$}:`,H),E(`Failed to ${$}: ${H.message}`)}},F=[{id:"queue",label:"Queue",icon:i.jsx(ig,{size:20})},{id:"newtons-ai",label:"Newtons AI",icon:i.jsx(aa,{size:20})},{id:"manage-admission",label:"Manage Admission",icon:i.jsx(DI,{size:20})},{id:"all-patients",label:"All Patients",icon:i.jsx(NM,{size:20})},{id:"lab",label:"Lab Tests",icon:i.jsx(Nk,{size:20})},{id:"custom-bill",label:"Custom Bill",icon:i.jsx(ls,{size:20})}],U=V=>{try{return new Date(V).toLocaleTimeString("en-IN",{hour:"numeric",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},z=s.filter(V=>{var L,$;return($=(L=V.Patient)==null?void 0:L.name)==null?void 0:$.toLowerCase().includes(r.toLowerCase())});return i.jsx("div",{className:"reception-dashboard-container",children:i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[k&&i.jsxs("div",{className:"error-message-reception",role:"alert",children:[" ",i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:k})]}),i.jsxs("div",{className:"reception-tab-nav",children:[" ",F.map(V=>i.jsxs("button",{className:`reception-tab-button ${n===V.id?"active":""}`,onClick:()=>t(V.id),children:[i.jsx("span",{children:V.icon}),V.label]},V.id))]}),n==="queue"&&i.jsxs("div",{className:"space-y-6",children:[" ",i.jsxs("div",{className:"queue-header",children:[" ",i.jsxs("div",{className:"queue-actions",children:[" ",i.jsxs("div",{className:"search-bar-container",children:[" ",i.jsx("input",{type:"text",placeholder:"Search patients in queue...",className:"search-input",value:r,onChange:V=>a(V.target.value)}),i.jsx(aa,{className:"search-icon",size:18})]})]}),i.jsxs("div",{className:"summary-cards-grid",children:[" ",i.jsxs("div",{className:"summary-card card-waiting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Waiting"})," ",i.jsx("div",{className:"summary-card-value",children:s.filter(V=>V.status==="waiting").length})," "]}),i.jsxs("div",{className:"summary-card card-consulting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Consulting"})," ",i.jsx("div",{className:"summary-card-value",children:s.filter(V=>V.status==="consulting").length})," "]}),i.jsxs("div",{className:"summary-card card-completed",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Completed"})," ",i.jsx("div",{className:"summary-card-value",children:s.filter(V=>V.status==="seen").length})," "]})]})]}),f?i.jsxs("div",{className:"loading-container",children:[" ",i.jsx("div",{className:"breathing-ball"})," ",i.jsx("span",{children:"Loading queue..."})]}):z.length===0?i.jsx("div",{className:"empty-queue-message",children:r?"No patients found matching your search.":"Queue is empty."}):i.jsxs("div",{className:"queue-table-wrapper",children:[" ",i.jsxs("table",{className:"queue-table",children:[" ",i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Queue"}),i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Phone Number"}),i.jsx("th",{children:"Complaint"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{className:"hidden md:table-cell",children:"Time Added"})," ",i.jsx("th",{className:"text-center",children:"Action / Doctor"})," "]})}),i.jsx("tbody",{children:z.map(V=>{var L,$,H,ee,te,ae,Z,B,K,oe,A;return i.jsxs("tr",{onClick:()=>T(`/dashboard/edit-complaint/${V.id}`),className:"queue-row-clickable",children:[i.jsxs("td",{children:[" ",i.jsxs("span",{className:"queue-token",children:["#",V.token_no]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-name",children:((L=V.Patient)==null?void 0:L.name)||"N/A"})," ",i.jsxs("div",{className:"patient-details",children:[($=V.Patient)!=null&&$.age?`${V.Patient.age} yrs, `:"",((H=V.Patient)==null?void 0:H.gender)||""]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-phone",children:((ee=V.Patient)==null?void 0:ee.phone)||"N/A"})," "]}),i.jsx("td",{className:"complaint-text",children:V.complaint||"-"}),i.jsxs("td",{children:[i.jsx("span",{className:`subscription-status-badge ${((te=V.Patient)==null?void 0:te.subscription_status)==="active"?"status-active":((ae=V.Patient)==null?void 0:ae.subscription_status)==="cancelled"||((Z=V.Patient)==null?void 0:Z.subscription_status)==="expired"?"status-inactive":"status-none"}`,children:((B=V.Patient)==null?void 0:B.subscription_status)??"None"}),V.Patient&&V.Patient.id&&V.Patient.subscription_status!=="active"&&i.jsx("button",{onClick:se=>{se.stopPropagation(),V.Patient&&T(`/start-subscription/${V.Patient.id}`)},className:"action-button btn-start-sub-queue mt-2",children:"Start Sub"})]}),i.jsx("td",{className:"hidden md:table-cell time-added",children:U(V.created_at)}),i.jsx("td",{className:"action-doctor-cell",children:v===V.id?i.jsx("div",{className:"relative inline-block text-left w-full",onClick:se=>se.stopPropagation(),children:i.jsxs("select",{value:"",onChange:se=>q(V.id,se.target.value),onBlur:()=>S(null),className:"doctor-select-dropdown",autoFocus:!0,children:[i.jsx("option",{value:"",disabled:!0,children:"Select Doctor..."}),g?i.jsx("option",{disabled:!0,children:"Loading..."}):u.length>0?u.map(se=>i.jsx("option",{value:se.id,children:se.name},se.id)):i.jsx("option",{disabled:!0,children:"No doctors available"})]})}):i.jsxs("div",{className:"action-doctor-content",onClick:se=>se.stopPropagation(),children:[" ",V.status==="waiting"&&i.jsx(i.Fragment,{children:(K=V.User)!=null&&K.name?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"doctor-name-display",children:V.User.name}),i.jsx("button",{onClick:()=>R(V.id,"consulting"),className:"action-button btn-start",children:"Start"})]}):g?i.jsx("span",{className:"status-text-italic",children:"Loading..."}):u.length===0?i.jsx("span",{className:"status-text-red",children:"No doctors"}):u.length===1?i.jsxs("button",{onClick:()=>q(V.id,u[0].id),className:"action-button btn-assign",children:["Assign ",u[0].name]}):i.jsx("button",{onClick:()=>S(V.id),className:"action-button btn-assign",children:"Assign"})}),V.status==="consulting"&&i.jsxs(i.Fragment,{children:[((oe=V.User)==null?void 0:oe.name)&&i.jsx("span",{className:"doctor-name-display",children:V.User.name}),i.jsx("button",{onClick:()=>R(V.id,"seen"),className:"action-button btn-complete",children:"Complete"})]}),V.status==="seen"&&i.jsxs(i.Fragment,{children:[((A=V.User)==null?void 0:A.name)&&i.jsx("span",{className:"doctor-name-display",children:V.User.name}),i.jsx("span",{className:"status-text-italic",children:"Completed"})]}),V.status==="cancelled"&&i.jsx("span",{className:"status-text-red",children:"Cancelled"})]})})]},V.id)})})]})]})]}),n==="lab"&&i.jsxs("div",{className:"lab-tab-content",children:[" ",i.jsx(jE,{currentUser:e}),i.jsxs("button",{onClick:()=>T("/lab/search-report"),className:"lab-action-button btn-search-lab-reports",children:[i.jsx(aa,{size:16}),"Search Lab Reports"]})]}),n==="newtons-ai"&&i.jsx("div",{className:"newtons-ai-tab-content",children:i.jsx(Th,{})}),n==="manage-admission"&&i.jsx("div",{className:"manage-admission-tab-content",children:i.jsx(NE,{})}),n==="all-patients"&&i.jsx("div",{className:"all-patients-tab-content",children:i.jsx(V1,{})}),n==="custom-bill"&&i.jsx("div",{className:"custom-bill-tab-content",children:i.jsx(CE,{})})]})})},eq=e=>{let n="";if(!e.report_content)return"No report content available.";n+=`*Report Date:* ${e.report_date?new Date(e.report_date).toLocaleDateString():"N/A"}

`;try{const t=JSON.parse(e.report_content);typeof t=="object"&&t!==null&&e.tests?e.tests.forEach((r,a)=>{n+=`*Test: ${r.name}*
`,t[r.id]?Object.entries(t[r.id]).forEach(([s,l])=>{var h;const f=(h=r.default_parameters)==null?void 0:h.find(g=>g.name===s);let d=String(l),u="";if(f){const g=f.unit?` _${f.unit}_`:"";if(f.type==="boolean"){const b=l===!0||l==="true";d=b?"*Reactive*":"Non-Reactive",b||(u="`Normal: Non-Reactive`")}else if(f.type==="number"){const b=typeof l=="string"?parseFloat(l):typeof l=="number"?l:NaN;if(f.lower_limit!=null||f.upper_limit!=null){let v=[];f.lower_limit!=null&&v.push(`${f.lower_limit}`),f.upper_limit!=null&&v.push(`${f.upper_limit}`),u=`\`Normal: ${v.join(" - ")}\`${g}`,!isNaN(b)&&(f.lower_limit!=null&&b<f.lower_limit||f.upper_limit!=null&&b>f.upper_limit)&&(d=`*${d}*`)}}f.unit&&(d+=g)}n+=`${s}: ${d}
`,u&&((f==null?void 0:f.type)==="boolean"&&(l===!0||l==="true")||(n+=`${u}
`))}):n+=`_No parameters reported for this test._
`,a<e.tests.length-1&&(n+=`
`)}):n+=e.report_content}catch{n+=e.report_content}return n},_E=e=>{var l;if(!((l=e==null?void 0:e.Patient)!=null&&l.phone)){alert("Cannot share report via WhatsApp: Patient phone number is not available.");return}if(!(e!=null&&e.report_content)){alert("Cannot share report: No report content is available to share.");return}const n=e.Patient.name||"Patient",t=eq(e),r=`Hello ${n},

Your lab report is ready.

${t}`,s=`https://wa.me/${tq(e.Patient.phone)}?text=${encodeURIComponent(r)}`;window.open(s,"_blank")},tq=e=>{let n=e.replace(/\D/g,"");const t=/^(?:\\+?91)?[\\s-]*?(\\d{10})$/,r=n.match(t);return r?n="91"+r[1]:n.startsWith("91")||(n="91"+n),n},nq=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,s]=w.useState(!0),[l,f]=w.useState(null),[d,u]=w.useState("orders"),[h,g]=w.useState(1),[b]=w.useState(20),[v,S]=w.useState(0),k=w.useMemo(()=>Math.ceil(v/b),[v,b]),E=w.useCallback(async(z=1,V="")=>{s(!0),f(null);try{const L=new URLSearchParams({page:String(z),limit:String(b)});V&&L.append("search",V);const $=await ge(`/api/lab?${L.toString()}`);if(!$.ok)throw new Error(`HTTP error! status: ${$.status}`);const H=await $.json(),ee=H.orders.map(te=>{var ae,Z;return{id:te.id,labTokenNumber:String(te.lab_token_number??"N/A"),patientName:((ae=te.Patient)==null?void 0:ae.name)||"N/A",patientId:te.patient_id,patientTokenNumber:String(((Z=te.Patient)==null?void 0:Z.patient_token_number)??"N/A"),tests:(te.tests||[]).map(B=>B.name||"Unknown Test"),date:Oh(new Date(te.createdAt),"yyyy-MM-dd"),status:te.status,reportId:te.reportId,billId:te.billId}});n(ee),S(H.totalCount),g(z)}catch(L){console.error("Failed to fetch lab orders:",L),f(L instanceof Error?L.message:"An unknown error occurred"),n([]),S(0)}finally{s(!1)}},[b]);w.useEffect(()=>{console.log(`Fetch effect triggered. Current page: ${h}, Search term: "${t}"`),t.length===0||t.length>=2?(console.log(`Condition met (length ${t.length}). Fetching orders...`),E(h,t)):console.log(`Condition not met (length ${t.length}). Not fetching.`)},[E,h,t]),w.useEffect(()=>{const z=setTimeout(()=>{t.length>=2?h!==1&&g(1):t.length<2&&h!==1&&g(1)},1e3);return()=>{clearTimeout(z)}},[t]);const T=async(z,V)=>{console.log(`Updating order ${z} to status ${V}`);try{const L=await ge(`/api/lab/${z}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:V})});if(!L.ok){const $=await L.json();throw new Error($.message||`Failed to update status: ${L.status}`)}if(V==="completed"){const $=await ge(`/api/lab/orders/${z}/report`);if($.ok){const H=await $.json();_E(H)}}await E(h,t),console.log(`Order ${z} status updated to ${V}, refetching page ${h}`)}catch(L){console.error("Error updating status:",L),alert(`Failed to update status: ${L instanceof Error?L.message:"Unknown error"}`)}},I=wt(),D=z=>{if(!z){console.error("Cannot navigate to billing: Order data is missing."),alert("Could not open billing page: Order information is missing.");return}z.billId?(console.log(`Navigating to existing bill for Bill ID: ${z.billId}, Patient: ${z.patientName}`),I("/billing",{state:{billId:z.billId,patientId:z.patientId,patientName:z.patientName,billType:"lab"}})):(console.log(`Navigating to create new bill for Lab Order ID: ${z.id}, Patient: ${z.patientName}`),I("/lab-billing",{state:{labOrderId:z.id}}))},q=z=>{z&&z.id?I(`/lab/report/${z.id}`):(console.error("Cannot navigate: Order or Order ID is missing."),alert("Could not open the report entry page: Order information is missing."))},R=z=>{switch(z){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:z,className:"status-badge"}}};if(a)return i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsx("div",{className:"text-teal-600 text-xl animate-pulse",children:"Loading Lab Panel..."})});if(l)return i.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-red-50 text-red-700",children:[i.jsx(Sr,{size:48,className:"mb-4"}),i.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Error Loading Lab Data"}),i.jsx("p",{className:"mb-4",children:l}),i.jsx("button",{onClick:()=>E(1,""),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry Fetch"})]});const F=()=>{h>1&&g(z=>z-1)},U=()=>{h<k&&g(z=>z+1)};return i.jsxs("div",{className:"lab-inventory-container",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("button",{onClick:()=>I(-1),className:"back-button mr-4",children:i.jsx(Ut,{size:24})}),i.jsx("h2",{className:"text-2xl font-semibold",children:"Lab Panel"})]}),i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px",borderBottom:"1px solid #ddd",paddingBottom:"10px"},children:[i.jsxs("button",{onClick:()=>u("orders"),className:`lab-inventory-button ${d==="orders"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[i.jsx(jk,{size:16,style:{marginRight:"8px"}}),"Orders"]}),i.jsx("button",{onClick:()=>I("/create-lab-order"),className:"lab-inventory-button",style:{display:"flex",alignItems:"center"},children:"Create New Lab Order"}),i.jsxs("button",{onClick:()=>u("inventory"),className:`lab-inventory-button ${d==="inventory"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[i.jsx(Pw,{size:16,style:{marginRight:"8px"}}),"Inventory"]})]}),d==="orders"&&i.jsxs("div",{className:"lab-orders-view",children:[" ",i.jsxs("div",{className:"lab-orders-header-controls",children:[i.jsx("h3",{className:"lab-orders-title",children:"Current Lab Orders"}),i.jsxs("div",{className:"lab-orders-search-container",children:[i.jsx("input",{type:"text",placeholder:"Search name, token, tests...",value:t,onChange:z=>r(z.target.value),className:"lab-inventory-input lab-orders-search-input"}),i.jsx(aa,{size:18,className:"lab-orders-search-icon"})]})]}),i.jsx("div",{className:"lab-orders-table-container",children:i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient (Token)"}),i.jsx("th",{children:"Tests"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"lab-table-actions-header",children:"Actions"})]})}),i.jsxs("tbody",{children:[a&&!l&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:"Loading orders..."})}),!a&&!l&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."})}),!a&&!l&&e.map(z=>{const V=R(z.status);return i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{children:z.patientName}),i.jsxs("div",{className:"lab-table-patient-token",children:["Token: ",z.patientTokenNumber]})]}),i.jsx("td",{children:z.tests.map((L,$)=>i.jsx("div",{children:L},$))}),i.jsx("td",{className:"hidden md:table-cell",children:z.date}),i.jsx("td",{children:i.jsx("span",{className:V.className,children:V.text})}),i.jsx("td",{children:i.jsxs("div",{className:"lab-table-actions",children:[z.status==="pending"&&i.jsx("button",{onClick:()=>D(z),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),z.status==="billed"&&i.jsx("button",{onClick:()=>T(z.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),z.status==="collected"&&i.jsx("button",{onClick:()=>T(z.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(z.status==="processing"||z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>q(z),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>T(z.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(z.status==="completed"||z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>{z.id?I(`/lab/view-report/${z.id}`):(console.error("Attempted to view report for an order with no ID:",z),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})})]},z.id)})]})]})}),i.jsxs("div",{className:"lab-orders-card-container",children:[a&&!l&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:"Loading orders..."}),!a&&!l&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."}),!a&&!l&&e.map(z=>{const V=R(z.status);return i.jsxs("div",{className:"lab-order-card",children:[i.jsxs("div",{className:"lab-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"lab-card-patient-name",children:z.patientName}),i.jsxs("div",{className:"lab-card-patient-token",children:["Token: ",z.patientTokenNumber]}),i.jsx("div",{className:"lab-card-date",children:z.date})]}),i.jsx("span",{className:`${V.className} lab-card-status-pill`,children:V.text})]}),i.jsxs("div",{className:"lab-card-section",children:[i.jsx("p",{className:"lab-card-section-title",children:"Tests:"}),z.tests.map((L,$)=>i.jsx("div",{className:"lab-card-test-item",children:L},$)),z.tests.length===0&&i.jsx("div",{className:"lab-card-no-tests",children:"No tests listed."})]}),i.jsxs("div",{className:"lab-card-actions",children:[z.status==="pending"&&i.jsx("button",{onClick:()=>D(z),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),z.status==="billed"&&i.jsx("button",{onClick:()=>T(z.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),z.status==="collected"&&i.jsx("button",{onClick:()=>T(z.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(z.status==="processing"||z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>q(z),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>T(z.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(z.status==="completed"||z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>{z.id?I(`/lab/view-report/${z.id}`):(console.error("Attempted to view report for an order with no ID:",z),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})]},z.id)})]}),!a&&v>0&&i.jsxs("div",{className:"lab-pagination-controls",children:[i.jsxs("div",{className:"lab-pagination-info",children:["Showing"," ",i.jsx("strong",{children:(h-1)*b+1})," ","to"," ",i.jsx("strong",{children:Math.min(h*b,v)})," ","of"," ",i.jsx("strong",{children:v})," ","results"]}),i.jsxs("div",{className:"lab-pagination-buttons",children:[i.jsx("button",{onClick:F,disabled:h===1,className:"lab-pagination-button","aria-label":"Previous page",children:i.jsx(zb,{size:18})}),i.jsxs("span",{children:["Page ",h," of ",k]}),i.jsx("button",{onClick:U,disabled:h===k,className:"lab-pagination-button","aria-label":"Next page",children:i.jsx(gg,{size:18})})]})]})]}),d==="inventory"&&i.jsxs("div",{className:"lab-inventory-content-wrapper",children:[" ",i.jsx(Dw,{})]})]})]})},rq=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,s]=w.useState(!0),[l,f]=w.useState(null),d=wt(),u=w.useRef(null),[h,g]=w.useState(1),[b,v]=w.useState(1),[S,k]=w.useState(0),E=10,T=w.useCallback(async(U,z,V)=>{s(!0),f(null);try{let L=`/api/pharmacy-orders?page=${U}&limit=${z}`;V&&V.trim()!==""&&(L+=`&search=${encodeURIComponent(V.trim())}`);const $=await ge(L);if(!$.ok)throw new Error(`Failed to fetch orders: ${$.statusText} (${$.status})`);const H=await $.json();if(H&&Array.isArray(H.orders)&&typeof H.totalOrders=="number"&&typeof H.totalPages=="number")console.log("Fetched pharmacy orders data:",H.orders),n(H.orders),k(H.totalOrders),v(H.totalPages),g(H.currentPage||U);else throw console.error("Received data does not match expected paginated structure:",H),new Error("Invalid data format received from API")}catch(L){console.error("Failed to fetch pharmacy orders:",L),f(L.message||"Failed to fetch orders. Please try again."),n([]),v(1),k(0)}finally{s(!1)}},[]);w.useEffect(()=>(u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{const U=t===""?h:1;t!==""&&h!==1&&g(1),T(U,E,t)},500),()=>{u.current&&clearTimeout(u.current)}),[t,h,T,E]);const I=U=>{d(`/dashboard/edit-pharmacy-order/${U}`)},D=U=>{f(null),console.log(`Preparing billing navigation for order: ${U}`);const z=e.find(V=>V.id===U);if(z){const V=z.medications.map(L=>{const $=L.price??0;return(L.price===void 0||L.price===null)&&console.warn(`Medication "${L.name}" in order ${U} is missing a price. Defaulting to 0.`),{name:L.name,pack_quantity:L.pack_quantity,loose_quantity:L.loose_quantity,price:$,pack_price:L.pack_price,loose_price:L.loose_price,total_price:L.total_price,isLoose:L.isLoose,unit:L.unit,drug_id:L.drug_id?String(L.drug_id):null,tabletsPerDay:L.tabletsPerDay,numberOfDays:L.numberOfDays,directions_to_use:L.directions_to_use,discount_percentage:0,batch:L.batch,expiry_date:L.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:V}),d(`/dashboard/pharmacy-billing/${U}`,{state:{initialItems:V}})}else console.error(`Order with ID ${U} not found.`),f(`Order with ID ${U} not found.`),alert(`Error: Could not find order ${U} to bill.`)},q=async(U,z)=>{f(null);const V=e.find($=>$.id===U);if(!V){f(`Order with ID ${U} not found.`);return}const L={status:z,medications:V.medications};try{const $=await ge(`/api/pharmacy-orders/${U}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)});if(!$.ok){const ee=await $.text();throw new Error(`Failed to update status: ${$.statusText} (${$.status}) - ${ee}`)}const H=await $.json();n(ee=>ee.map(te=>te.id===H.id?{...te,status:H.status}:te))}catch($){console.error("Failed to update order status:",$),f($.message||`Failed to update status for order ${U}.`),alert(`Error updating status for order ${U}: ${$.message||"Please try again."}`)}},R=U=>{switch(U){case"pending":return"status-pill status-pill-pending";case"billed":return"status-pill status-pill-billed";case"dispensed":return"status-pill status-pill-dispensed";case"cancelled":return"status-pill status-pill-cancelled";default:return"status-pill status-pill-default"}},F=U=>{d(`/dashboard/orders/${U.id}`)};return a&&e.length===0&&!l?i.jsx("div",{className:"loading-pulse",children:"Loading Orders..."}):l&&e.length===0?i.jsxs("div",{className:"error-message-box",children:["Error loading orders: ",l]}):i.jsxs("div",{className:"pharmacy-queue-container",children:[i.jsxs("div",{className:"pharmacy-queue-header",children:[i.jsx("h3",{className:"pharmacy-queue-title",children:"Pharmacy Queue"}),i.jsxs("div",{className:"pharmacy-actions-container",children:[i.jsxs("div",{className:"pharmacy-buttons-group",children:[i.jsxs("button",{onClick:()=>d("/dashboard/add-order"),className:"pharmacy-action-button btn-add-order",children:[i.jsx(ls,{size:16}),"Add Order"]}),i.jsxs("button",{onClick:()=>d("/dashboard/inventory"),className:"pharmacy-action-button btn-inventory",title:"View Pharmacy Inventory",children:[i.jsx(Id,{size:16}),"Inventory"]}),i.jsxs("button",{onClick:()=>d("/dashboard/search-patient-records"),className:"pharmacy-action-button btn-ai-search",title:"Search Patient Records with Newton's AI",children:[i.jsx(m1,{size:16}),"Newton's AI"]}),i.jsxs("button",{onClick:()=>d("/dashboard/distributors"),className:"pharmacy-action-button btn-distributors",title:"Manage Distributors",children:[i.jsx(Id,{size:16}),"Distributors"]}),i.jsxs("button",{onClick:()=>d("/dashboard/recurring-medications"),className:"pharmacy-action-button btn-refill-reminders",title:"View Recurring Medications",children:[i.jsx(OI,{size:16}),"Recurring Meds"]})]}),i.jsxs("div",{className:"pharmacy-search-input-container",children:[i.jsx("input",{type:"text",placeholder:"Search orders by patient name, token, or medication...",value:t,onChange:U=>r(U.target.value),className:"pharmacy-search-input"}),i.jsx(aa,{size:18,className:"pharmacy-search-icon"})]})]})]}),i.jsxs("div",{className:"pharmacy-orders-scroll-container",children:[l&&e.length>0&&i.jsxs("div",{className:"error-message-box",children:["Error: ",l]}),a&&e.length>0&&i.jsx("div",{className:"loading-pulse",children:"Updating Orders..."}),!a&&e.length===0&&!l&&i.jsx("div",{className:"empty-state-message",children:t?`No pharmacy orders found matching "${t}".`:"There are currently no pharmacy orders."}),e.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"pharmacy-table-container",children:i.jsxs("table",{className:"pharmacy-queue-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Medications"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Order Total"}),i.jsx("th",{children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map(U=>i.jsxs("tr",{onClick:()=>F(U),style:{cursor:"pointer"},children:[i.jsxs("td",{children:[i.jsx("div",{className:"patient-name",children:U.patientName}),i.jsx("div",{className:"patient-token",title:`Patient Token: ${U.patientTokenNumber}`,children:U.patientTokenNumber})]}),i.jsxs("td",{className:"medication-info",children:[U.medications.map((z,V)=>i.jsxs("div",{className:"medication-item",children:[i.jsxs("span",{children:[z.name," (Packs: ",z.pack_quantity,", Loose: ",z.loose_quantity,", ",z.tabletsPerDay??"N/A","x",z.numberOfDays??"N/A","d)",z.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",z.box_number,")"]})]}),z.directions_to_use&&i.jsxs("span",{className:"medication-directions",children:["Directions: ",z.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[z.pack_price!==void 0&&`Pack Price: ${Number(z.pack_price).toFixed(2)}`,z.loose_price!==void 0&&` | Loose Price: ${Number(z.loose_price).toFixed(2)}`,z.total_price!==void 0&&` | Item Total: ${Number(z.total_price).toFixed(2)}`]})]},V)),U.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",U.prescriptionForUnavailableDrugs]})]}),i.jsx("td",{className:"hidden md:table-cell date-info",children:new Date(U.date).toLocaleDateString()}),i.jsxs("td",{className:"order-total-cell font-semibold",children:["",Number(U.order_total??0).toFixed(2)]}),i.jsx("td",{children:i.jsx("span",{className:R(U.status),children:U.status})}),i.jsx("td",{children:i.jsxs("div",{className:"pharmacy-table-actions",children:[U.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:z=>{z.stopPropagation(),I(U.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx(Od,{size:14})," Edit"]}),i.jsxs("button",{onClick:z=>{z.stopPropagation(),D(U.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx(Ad,{size:14})," Bill"]})]}),U.status==="billed"&&i.jsxs("button",{onClick:z=>{z.stopPropagation(),q(U.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx($a,{size:14})," Dispense"]}),(U.status==="pending"||U.status==="billed")&&i.jsx("button",{onClick:z=>{z.stopPropagation(),q(U.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:z=>{z.stopPropagation(),F(U)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})})]},U.id))})]})}),i.jsx("div",{className:"pharmacy-card-view-container",children:e.map(U=>{const z=R(U.status);return i.jsxs("div",{className:"pharmacy-order-card",onClick:()=>F(U),children:[i.jsxs("div",{className:"pharmacy-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"pharmacy-card-patient-name",children:U.patientName||"N/A"}),i.jsxs("div",{className:"pharmacy-card-patient-token",title:`Patient Token: ${U.patientTokenNumber}`,children:["Token: ",U.patientTokenNumber||"N/A"]}),i.jsx("div",{className:"pharmacy-card-date",children:new Date(U.date).toLocaleDateString()})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:z,children:U.status}),U.order_total!==void 0&&i.jsxs("span",{className:"pharmacy-card-order-total font-semibold",children:["",Number(U.order_total).toFixed(2)]})]})]}),i.jsxs("div",{className:"pharmacy-card-medications",children:[i.jsx("p",{className:"pharmacy-card-medications-title",children:"Medications:"}),i.jsxs("div",{className:"space-y-0_5",children:[U.medications.slice(0,2).map((V,L)=>i.jsxs("div",{className:"pharmacy-card-medication-item",children:[i.jsxs("span",{title:`${V.name} (Packs: ${V.pack_quantity}, Loose: ${V.loose_quantity}, ${V.tabletsPerDay??"N/A"}x${V.numberOfDays??"N/A"}d)`,children:[V.name," (Packs: ",V.pack_quantity,", Loose: ",V.loose_quantity,", ",V.tabletsPerDay??"N/A","x",V.numberOfDays??"N/A","d)",V.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",V.box_number,")"]})]}),V.directions_to_use&&i.jsxs("span",{className:"medication-directions",title:`Directions: ${V.directions_to_use}`,children:["Directions: ",V.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[V.pack_price!==void 0&&`Pack Price: ${Number(V.pack_price).toFixed(2)}`,V.loose_price!==void 0&&` | Loose Price: ${Number(V.loose_price).toFixed(2)}`,V.total_price!==void 0&&` | Item Total: ${Number(V.total_price).toFixed(2)}`]})]},L)),U.medications.length>2&&i.jsxs("div",{className:"pharmacy-card-medications-more",children:["...and ",U.medications.length-2," more"]}),U.medications.length===0&&i.jsx("div",{className:"pharmacy-card-no-medications",children:"No medications listed."})]}),U.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",U.prescriptionForUnavailableDrugs]})]}),i.jsxs("div",{className:"pharmacy-card-actions",children:[U.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:V=>{V.stopPropagation(),I(U.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx(Od,{size:14})," Edit"]}),i.jsxs("button",{onClick:V=>{V.stopPropagation(),D(U.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx(Ad,{size:14})," Bill"]})]}),U.status==="billed"&&i.jsxs("button",{onClick:V=>{V.stopPropagation(),q(U.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx($a,{size:14})," Dispense"]}),(U.status==="pending"||U.status==="billed")&&i.jsx("button",{onClick:V=>{V.stopPropagation(),q(U.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:V=>{V.stopPropagation(),F(U)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})]},U.id)})})]}),!a&&b>1&&i.jsxs("div",{className:"pharmacy-pagination-container",children:[i.jsxs("div",{className:"pagination-mobile-controls",children:[i.jsx("button",{onClick:()=>g(U=>Math.max(U-1,1)),disabled:h===1,className:"pagination-button prev",children:"Previous"}),i.jsx("button",{onClick:()=>g(U=>Math.min(U+1,b)),disabled:h===b,className:"pagination-button next",children:"Next"})]}),i.jsxs("div",{className:"pagination-desktop-controls",children:[i.jsx("div",{className:"pagination-info",children:i.jsxs("p",{children:["Showing ",i.jsx("span",{className:"font-medium",children:(h-1)*E+1})," ","to ",i.jsx("span",{className:"font-medium",children:Math.min(h*E,S)})," ","of ",i.jsx("span",{className:"font-medium",children:S})," results"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"pagination-nav","aria-label":"Pagination",children:[i.jsxs("button",{onClick:()=>g(U=>Math.max(U-1,1)),disabled:h===1,className:"pagination-nav-button prev",children:[i.jsx("span",{className:"sr-only",children:"Previous"}),i.jsx(zb,{"aria-hidden":"true"})]}),i.jsxs("span",{"aria-current":"page",className:"pagination-current-page",children:["Page ",h," of ",b]}),i.jsxs("button",{onClick:()=>g(U=>Math.min(U+1,b)),disabled:h===b,className:"pagination-nav-button next",children:[i.jsx("span",{className:"sr-only",children:"Next"}),i.jsx(gg,{"aria-hidden":"true"})]})]})})]})]})]})," "]})},iq=()=>{const e=wt();return i.jsxs("div",{className:"bg-white p-3 md:p-6 rounded-lg shadow",children:[i.jsx("button",{onClick:()=>e(-1),className:"mb-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Back"}),i.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Settings"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Pharmacy settings will be configured here."})]})},aq=()=>{const{id:e}=ki(),n=wt(),[t,r]=w.useState(null),[a,s]=w.useState(!0),[l,f]=w.useState(null),[d,u]=w.useState(!1),[h,g]=w.useState(!1),b=w.useRef(null),v=w.useRef(null),S=w.useRef(null),k=w.useCallback(async()=>{if(!e){f("Drug ID is missing."),s(!1);return}s(!0),f(null);try{const D=await ge(`/api/drugs/${e}`);if(!D.ok){const R=await D.json();throw new Error(R.message||`Failed to fetch drug: ${D.statusText}`)}let q=await D.json();q={...q,name:q.name||"",brand_name:q.brand_name||"",price:parseFloat(String(q.price))||0,buying_price:q.buying_price!==null&&q.buying_price!==void 0?parseFloat(String(q.buying_price)):null,quantity_in_stock:parseInt(String(q.quantity_in_stock),10)||0,gst:q.gst!==null&&q.gst!==void 0?parseFloat(String(q.gst)):null,margin:q.margin!==null&&q.margin!==void 0?parseFloat(String(q.margin)):null,discount:q.discount!==null&&q.discount!==void 0?parseFloat(String(q.discount)):null,batch:q.batch||"",hsn_code:q.hsn_code||"",mfg:q.mfg||"",loose:q.loose!==null&&q.loose!==void 0?parseInt(String(q.loose),10):null},r(q)}catch(D){console.error("Failed to fetch drug:",D),f(D.message||"Failed to load drug data. Please try again.")}finally{s(!1)}},[e]);w.useEffect(()=>{k()},[k]),w.useEffect(()=>{const D=R=>{R.key==="Tab"&&v.current===document.activeElement&&(h||(g(!0),setTimeout(()=>{var F;(F=S.current)==null||F.focus()},0),R.preventDefault()))},q=R=>{b.current&&!b.current.contains(R.target)&&g(!1)};return document.addEventListener("keydown",D),document.addEventListener("mousedown",q),()=>{document.removeEventListener("keydown",D),document.removeEventListener("mousedown",q)}},[h]);const E=D=>{const{name:q,value:R,type:F}=D.target;r(U=>U?{...U,[q]:F==="number"?parseFloat(R)||null:R}:null)},T=()=>{n(-1)},I=async D=>{if(D.preventDefault(),f(null),u(!0),!t||!t.id){f("Cannot edit drug: No drug data available."),u(!1);return}if(t.price===void 0||t.quantity_in_stock===void 0){f("Price and Stock Quantity are required."),u(!1);return}const q={...t,name:t.name===""?null:t.name,brand_name:t.brand_name===""?null:t.brand_name,buying_price:t.buying_price===0?null:t.buying_price,expiry_date:t.expiry_date===""?null:t.expiry_date,gst:t.gst===0?null:t.gst,margin:t.margin===0?null:t.margin,discount:t.discount===0?null:t.discount,batch:t.batch===""?null:t.batch,hsn_code:t.hsn_code===""?null:t.hsn_code,mfg:t.mfg===""?null:t.mfg,loose:t.loose===0?null:t.loose};try{const R=await ge(`/api/drugs/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(q)});if(!R.ok){const U=await R.json();throw new Error(U.message||`Failed to update drug: ${R.statusText}`)}const F=await R.json();alert(`Drug "${F.name}" updated successfully!`),n(-1)}catch(R){console.error("Failed to update drug:",R),f(R.message||"Failed to update drug. Please try again.")}finally{u(!1)}};return a?i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"loading-message",children:"Loading drug data..."})}):l&&!t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"error-message-load",children:["Error: ",l]})}):t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"edit-drug-form-container",children:[i.jsxs("div",{className:"edit-drug-form-header",children:[i.jsxs("h2",{children:["Edit Drug: ",t.name]}),i.jsx("button",{onClick:T,className:"cancel-button",title:"Go Back",children:i.jsx(Jn,{size:24})})]}),l&&i.jsx("div",{className:"error-message-submit",children:l}),i.jsxs("form",{onSubmit:I,className:"edit-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-name",className:"form-label",children:"Composition Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx($o,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"edit-name",value:t.name||"",onChange:E,className:"custom-text-input",placeholder:"e.g., Paracetamol",tabIndex:1})," "]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-brand_name",className:"form-label",children:"Brand Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx($o,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"edit-brand_name",value:t.brand_name||"",onChange:E,className:"custom-text-input",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-price",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx($o,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"price",id:"edit-price",required:!0,step:"0.01",min:"0",value:t.price,onChange:E,className:"custom-text-input",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-quantity_in_stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx($o,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"quantity_in_stock",id:"edit-quantity_in_stock",required:!0,step:"1",min:"0",value:t.quantity_in_stock,onChange:E,className:"custom-text-input",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-unit",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"unit",id:"edit-unit",value:t.unit||"",onChange:E,className:"custom-text-input",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"edit-expiry_date",value:t.expiry_date||"",onChange:E,className:"custom-text-input",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"edit-box_number",value:t.box_number||"",onChange:E,className:"custom-text-input",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:b,children:[i.jsx("button",{type:"button",onClick:()=>g(!h),className:"form-button w-full text-left",tabIndex:8,ref:v,children:"Others"}),h&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"edit-description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"edit-description",rows:3,value:t.description||"",onChange:E,className:"custom-text-input",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-supplier",className:"form-label",children:"Supplier"}),i.jsx("input",{type:"text",name:"supplier",id:"edit-supplier",value:t.supplier||"",onChange:E,className:"custom-text-input",placeholder:"Optional",tabIndex:10})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-buying_price",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"buying_price",id:"edit-buying_price",step:"0.01",min:"0",value:t.buying_price??"",onChange:E,placeholder:"Optional",className:"custom-text-input",tabIndex:11,ref:S})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"edit-gst",step:"0.01",min:"0",max:"100",value:t.gst??"",onChange:E,placeholder:"Optional",className:"custom-text-input",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"edit-margin",step:"0.01",min:"0",max:"100",value:t.margin??"",onChange:E,placeholder:"Optional",className:"custom-text-input",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"edit-discount",step:"0.01",min:"0",max:"100",value:t.discount??"",onChange:E,placeholder:"Optional",className:"custom-text-input",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"edit-batch",value:t.batch||"",onChange:E,className:"custom-text-input",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"edit-hsn_code",value:t.hsn_code||"",onChange:E,className:"custom-text-input",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"edit-mfg",value:t.mfg||"",onChange:E,className:"custom-text-input",placeholder:"Optional",tabIndex:17})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-loose",className:"form-label",children:"Loose"}),i.jsx("input",{type:"number",name:"loose",id:"edit-loose",step:"1",min:"0",value:t.loose??"",onChange:E,placeholder:"Optional",className:"custom-text-input",tabIndex:18})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:T,disabled:d,className:"form-button cancel-form-button",tabIndex:19,children:"Back"}),i.jsx("button",{type:"submit",disabled:d,className:"form-button submit-form-button",tabIndex:20,children:d?"Saving...":"Save Changes"})]})]})]})}):i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"not-found-message",children:"Drug not found."})})},H1=()=>{const e=wt(),[n,t]=w.useState({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),[r,a]=w.useState(!1),[s,l]=w.useState(null),[f,d]=w.useState(null),[u,h]=w.useState(""),[g,b]=w.useState([]),[v,S]=w.useState(null),[k,E]=w.useState(!1),[T,I]=w.useState([]),[D,q]=w.useState(!0);w.useEffect(()=>{(async()=>{q(!0);try{const $=await ge("/api/staff?role=doctor");if(!$.ok)throw new Error("Failed to fetch doctors");const H=await $.json();I(H),H.length>0&&t(ee=>({...ee,doctorId:""}))}catch($){console.error("Error fetching doctors:",$),l(`Failed to load doctors: ${$.message}`)}finally{q(!1)}})()},[]);const R=w.useCallback(async()=>{if(u.trim()){E(!0),l(null),b([]);try{const L=encodeURIComponent(u.trim()),$=await ge(`/api/patients?search=${L}&limit=10`);if(!$.ok){const ee=await $.json().catch(()=>({message:"Failed to search patients"}));throw new Error(ee.message||"Failed to search patients")}const H=await $.json();H&&Array.isArray(H.patients)?b(H.patients):(console.error("Unexpected response format from patient search:",H),b([]))}catch(L){console.error("Error searching patients:",L),l(`Search failed: ${L.message}`)}finally{E(!1)}}},[u]);w.useEffect(()=>{if(u.trim().length<2){b([]),l(null);return}const L=setTimeout(()=>{R()},300);return()=>clearTimeout(L)},[u,R]);const F=L=>{S(L),h(""),b([]),l(null),t($=>({...$,name:"",age:"",gender:"",phone:""}))},U=()=>{S(null),h(""),b([]),l(null),t(L=>({...L,name:"",age:"",gender:"",phone:""}))},z=L=>{const{name:$,value:H}=L.target;t(ee=>({...ee,[$]:H}))},V=async L=>{var $;L.preventDefault(),l(null),d(null),a(!0);try{let H,ee;if(v)H=v.id,ee=v.name,console.log(`Adding existing patient ${H} to queue.`);else{console.log("Registering new patient...");const B=await ge("/api/patients",{method:"POST",body:JSON.stringify({name:n.name,age:n.age?parseInt(n.age,10):null,gender:n.gender||null,phone:n.phone||null})});if(!B.ok){const oe=await B.json();if(B.status===403&&oe.message.includes("Patient limit")){e("/start-clinic-subscription",{state:{errorMessage:oe.message}});return}throw new Error(oe.message||"Failed to register patient")}const K=await B.json();H=K.id,ee=K.name,console.log(`New patient ${H} registered.`)}const te=n.doctorId||null;console.log(`Adding patient ${H} to queue for doctor ${te||"Unassigned"}`);const ae=await ge("/api/queue",{method:"POST",body:JSON.stringify({patientId:H,complaint:n.complaint||null,doctorId:te})});if(!ae.ok){const B=await ae.json();throw new Error(B.message||"Failed to add patient to queue")}const Z=await ae.json();if(console.log(`Patient added to queue, entry ID: ${Z.id}`),S(null),h(""),b([]),t({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),te){const B=(($=T.find(oe=>oe.id===te))==null?void 0:$.name)||"Selected Doctor",K=v?`Existing patient "${ee}" added to queue for Dr. ${B}. Redirecting to billing...`:`Patient "${ee}" registered and added to queue for Dr. ${B}. Redirecting to billing...`;d(K),e("/billing",{state:{patientId:H,queueId:Z.id,patientName:ee,doctorId:te,billType:"consultation"}})}else{const B=v?`Existing patient "${ee}" added to the general queue.`:`Patient "${ee}" registered and added to the general queue.`;d(B)}}catch(H){console.error("Error in add/queue process:",H),H.message.includes("Patient limit")?(l(`Operation failed: ${H.message}. Please upgrade your plan.`),e("/start-clinic-subscription")):l(`Operation failed: ${H.message}`)}finally{a(!1)}};return i.jsxs("div",{className:"add-patient-page-container flex flex-col items-center justify-start",children:[i.jsxs("div",{className:"w-full max-w-3xl mb-2 flex justify-start",children:[" ",i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Back to Previous Page",children:[i.jsx(Ut,{size:20,className:"btn-icon"})," Back"]})]}),i.jsxs("div",{className:"add-patient-card",children:[i.jsxs("h3",{className:"add-patient-title",children:[i.jsx(Tk,{size:28})," ",v?"Add Existing Patient to Queue":"Register New Patient & Add to Queue"]}),i.jsxs("div",{className:"search-section",children:[i.jsx("legend",{className:"form-fieldset legend",children:"Find Existing Patient"})," ",i.jsxs("div",{className:"flex items-center space-x-2",children:[" ",i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("input",{type:"text",placeholder:"Search by Name or Phone...",value:u,onChange:L=>h(L.target.value),className:"form-input",disabled:r||!!v}),i.jsx(aa,{size:18,className:`${k?"text-primary animate-pulse":""}`})," "]}),v&&i.jsxs("button",{type:"button",onClick:U,className:"btn btn-danger",title:"Clear Selection",children:[i.jsx(Jn,{size:16,className:"btn-icon"})," Clear"]})]}),g.length>0&&!v&&i.jsx("ul",{className:"search-results-list",children:g.map(L=>i.jsxs("li",{onClick:()=>F(L),children:[L.name," (ID: ",L.id,", Phone: ",L.phone||"N/A",")"]},L.id))}),u.length>=2&&g.length===0&&!k&&!v&&i.jsxs("p",{className:"search-info-text",children:['No patients found matching "',u,'". You can register them below.']}),k&&u.length>=2&&i.jsx("p",{className:"search-info-text searching",children:"Searching..."})]}),s&&i.jsxs("div",{className:"alert alert-danger",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:s})]}),f&&i.jsxs("div",{className:"alert alert-success",role:"alert",children:[i.jsx("strong",{children:"Success: "}),i.jsx("span",{children:f})]}),i.jsxs("form",{onSubmit:V,className:"space-y-5",children:[" ",i.jsxs("fieldset",{className:`form-fieldset ${v?"fieldset-disabled":""}`,children:[i.jsx("legend",{children:v?`Selected Patient: ${v.name}`:"New Patient Details"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Full Name *"}),i.jsx("input",{type:"text",name:"name",value:v?v.name:n.name,onChange:z,className:"form-input",required:!v,disabled:r||!!v})]}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Age"}),i.jsx("input",{type:"number",name:"age",value:v?v.age??"":n.age,onChange:z,className:"form-input",min:"0",disabled:r||!!v})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Gender"}),i.jsxs("select",{name:"gender",value:v?v.gender??"":n.gender,onChange:z,className:"form-select",disabled:r||!!v,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Phone"}),i.jsx("input",{type:"tel",name:"phone",value:v?v.phone??"":n.phone,onChange:z,className:"form-input",disabled:r||!!v})]})]})]}),i.jsxs("fieldset",{className:"form-fieldset",children:[i.jsx("legend",{children:"Visit Details"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Assign Doctor (Optional)"}),i.jsxs("select",{name:"doctorId",value:n.doctorId,onChange:z,className:`form-select ${D?"opacity-50":""}`,disabled:r||D,children:[i.jsx("option",{value:"",children:D?"Loading doctors...":T.length===0?"No doctors available":"-- No Doctor (Add to General Queue) --"}),T.map(L=>i.jsx("option",{value:L.id,children:L.name},L.id))]}),T.length===0&&!D&&i.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Please add doctors via the Admin Panel."})]}),i.jsxs("div",{className:"form-grid-col-span-2",children:[" ",i.jsx("label",{className:"form-label",children:"Patient Data / Reason"}),i.jsx("textarea",{name:"complaint",value:n.complaint,onChange:z,rows:2,className:"form-textarea",disabled:r})]})]})]}),i.jsxs("div",{className:"flex justify-end pt-2",children:[" ",i.jsxs("button",{type:"submit",className:`btn btn-primary ${r||D?"disabled":""}`,disabled:r||D,children:[i.jsx(Ek,{size:18,className:"btn-icon"}),r?"Processing...":v?"Add Existing to Queue":"Register & Add to Queue"]})]})]})]})]})},sq=({clinicId:e})=>{const n=wt(),[t,r]=w.useState({name:"",email:"",role:"receptionist",password:"",opd_fee:""}),[a,s]=w.useState(null),[l,f]=w.useState(!1);w.useEffect(()=>{s(e?null:"Clinic information is missing. Cannot add staff. Please ensure you are logged in correctly.")},[e]);const d=g=>{const{name:b,value:v}=g.target;r(S=>{const k={...S,[b]:v};return b==="role"&&v!=="doctor"&&(k.opd_fee=""),k})},u=async g=>{if(g.preventDefault(),s(null),!t.name||!t.email||!t.role||!t.password){s("Name, Email, Role, and Password are required.");return}if(!e){s("Clinic information is missing. Cannot add staff.");return}const b={...t,clinic_id:e,opd_fee:t.role==="doctor"&&t.opd_fee?parseFloat(String(t.opd_fee)):null};if(b.role==="doctor"&&t.opd_fee&&isNaN(b.opd_fee)){s("Invalid OPD Fee format. Please enter a number.");return}f(!0);try{const v=await ge("/api/staff",{method:"POST",body:JSON.stringify(b)});if(!v.ok){const S=await v.json();throw new Error(S.message||"Server responded with an error")}n(-1)}catch(v){s(`Failed to add staff: ${v.message}`)}finally{f(!1)}},h=()=>{n(-1)};return i.jsxs("div",{className:"staff-page-container",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("button",{onClick:h,className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[i.jsx(Ut,{size:18,className:"mr-2"}),"Back"]}),i.jsx("h1",{children:"Add New Staff Member"}),i.jsx("div",{className:"w-16"})," "]}),a&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[i.jsx(Sr,{size:18,className:"mr-2 text-red-500"}),a]}),i.jsxs("form",{onSubmit:u,className:`staff-form ${e?"":"opacity-50 pointer-events-none"}`,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Full Name"}),i.jsx("input",{id:"name",type:"text",name:"name",value:t.name||"",onChange:d,required:!0,disabled:l||!e,placeholder:"Enter full name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email Address"}),i.jsx("input",{id:"email",type:"email",name:"email",value:t.email||"",onChange:d,required:!0,disabled:l||!e,placeholder:"Enter email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"role",children:"Assign Role"}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:d,required:!0,disabled:l||!e,children:[i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"}),i.jsx("option",{value:"lab",children:"Lab Technician"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"Set Initial Password"}),i.jsx("input",{id:"password",type:"password",name:"password",value:t.password||"",onChange:d,required:!0,disabled:l||!e,placeholder:"Create a password"})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"opd_fee",children:"OPD Consultation Fee () (Optional)"}),i.jsx("input",{id:"opd_fee",type:"number",name:"opd_fee",value:t.opd_fee||"",onChange:d,step:"0.01",min:"0",placeholder:"e.g., 150.00",disabled:l||!e}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank if no specific fee is set for this doctor."})]}),i.jsxs("button",{type:"submit",disabled:l||!e,children:[l?i.jsx(Pd,{size:18,className:"animate-spin mr-2"}):i.jsx(Md,{size:18,className:"mr-2"}),l?"Adding...":"Add Staff Member"]})]})]})},oq=()=>{const{id:e}=ki(),n=wt(),[t,r]=w.useState({name:"",email:"",role:"receptionist",opd_fee:"",active:!0}),[a,s]=w.useState(""),[l,f]=w.useState(!0),[d,u]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Staff ID is missing."),f(!1);return}f(!0),g(null),v(null);try{const I=await ge(`/staff/${e}`);if(!I.ok){const q=await I.json();throw new Error(q.message||`HTTP error! status: ${I.status}`)}const D=await I.json();r({name:D.name,email:D.email,role:D.role,opd_fee:D.opd_fee??"",active:D.active})}catch(I){g(`Failed to load staff details: ${I.message}`)}finally{f(!1)}},[e]);w.useEffect(()=>{S()},[S]);const k=I=>{const{name:D,value:q,type:R}=I.target;if(R==="checkbox"){const{checked:F}=I.target;r(U=>({...U,[D]:F}))}else r(F=>({...F,[D]:q}))},E=I=>{s(I.target.value)},T=async I=>{if(I.preventDefault(),!e){g("Staff ID is missing.");return}u(!0),g(null),v(null);const D={name:t.name,email:t.email,role:t.role,active:t.active};if(t.role==="doctor"){const q=t.opd_fee?parseFloat(String(t.opd_fee)):null;if(q!==null&&isNaN(q)){g("OPD Fee must be a valid number."),u(!1);return}D.opd_fee=q}else D.opd_fee=null;a.trim()!==""&&(D.password=a.trim());try{const q=await ge(`/staff/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(D)});if(!q.ok){const R=await q.json();throw new Error(R.message||`HTTP error! status: ${q.status}`)}v("Staff details updated successfully!"),s(""),setTimeout(()=>n(-1),1500)}catch(q){g(`Failed to update staff: ${q.message}`)}finally{u(!1)}};return l?i.jsxs("div",{className:"flex justify-center items-center h-screen",children:[i.jsx(Pd,{className:"h-12 w-12 animate-spin text-teal-600"}),i.jsx("span",{className:"ml-4 text-xl text-gray-700",children:"Loading Staff Details..."})]}):i.jsxs("div",{className:"staff-page-container",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[i.jsx(Ut,{size:18,className:"mr-2"}),"Back"]}),i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Edit Staff Member"}),i.jsx("div",{className:"w-16"})," "]}),h&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[i.jsx(Sr,{size:18,className:"mr-2 text-red-500"}),h,i.jsx("button",{onClick:()=>g(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),b&&i.jsxs("div",{className:"success-message mb-4 p-3 bg-green-100 border border-green-400 rounded-md flex items-center",children:[i.jsx($a,{size:18,className:"mr-2 text-green-500"}),b,i.jsx("button",{onClick:()=>v(null),className:"ml-auto text-green-600 hover:text-green-800 text-xl font-bold",children:""})]}),i.jsxs("form",{onSubmit:T,className:"staff-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Full Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:t.name||"",onChange:k,required:!0,placeholder:"Enter full name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"email",children:["Email Address ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"email",id:"email",name:"email",value:t.email||"",onChange:k,required:!0,placeholder:"Enter email address"})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"role",children:["Role ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:k,required:!0,children:[i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"lab",children:"Lab Technician"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"})]})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"opd_fee",children:"OPD Fee ()"}),i.jsx("input",{type:"number",id:"opd_fee",name:"opd_fee",value:t.opd_fee||"",onChange:k,min:"0",step:"0.01",placeholder:"Enter OPD consultation fee (optional)"})]}),i.jsxs("div",{className:"form-group checkbox-group",children:[i.jsx("input",{id:"active",name:"active",type:"checkbox",checked:t.active??!0,onChange:k}),i.jsxs("label",{htmlFor:"active",className:"mb-0",children:[" ","Account Active"]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"New Password (optional)"}),i.jsx("input",{type:"password",id:"password",name:"password",value:a,onChange:E,placeholder:"Leave blank to keep current password",autoComplete:"new-password"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter a new password only if you want to change it. Minimum 6 characters."})]}),i.jsx("button",{type:"submit",disabled:d,children:d?i.jsxs(i.Fragment,{children:[i.jsx(Pd,{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Rd,{size:16,className:"mr-2"}),"Save Changes"]})})]})]})};function lq(e,n){const t={};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const cq=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,uq=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,dq={};function pj(e,n){return(dq.jsx?uq:cq).test(e)}const fq=/[ \t\n\f\r]/g;function hq(e){return typeof e=="object"?e.type==="text"?mj(e.value):!1:mj(e)}function mj(e){return e.replace(fq,"")===""}let Sg=class{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}};Sg.prototype.normal={};Sg.prototype.property={};Sg.prototype.space=void 0;function kE(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new Sg(t,r,n)}function G1(e){return e.toLowerCase()}let ca=class{constructor(n,t){this.attribute=t,this.property=n}};ca.prototype.attribute="";ca.prototype.booleanish=!1;ca.prototype.boolean=!1;ca.prototype.commaOrSpaceSeparated=!1;ca.prototype.commaSeparated=!1;ca.prototype.defined=!1;ca.prototype.mustUseProperty=!1;ca.prototype.number=!1;ca.prototype.overloadedBoolean=!1;ca.prototype.property="";ca.prototype.spaceSeparated=!1;ca.prototype.space=void 0;let pq=0;const zt=Ud(),Er=Ud(),EE=Ud(),at=Ud(),Wn=Ud(),Dh=Ud(),Da=Ud();function Ud(){return 2**++pq}const Y1=Object.freeze(Object.defineProperty({__proto__:null,boolean:zt,booleanish:Er,commaOrSpaceSeparated:Da,commaSeparated:Dh,number:at,overloadedBoolean:EE,spaceSeparated:Wn},Symbol.toStringTag,{value:"Module"})),Iv=Object.keys(Y1);let Kw=class extends ca{constructor(n,t,r,a){let s=-1;if(super(n,t),gj(this,"space",a),typeof r=="number")for(;++s<Iv.length;){const l=Iv[s];gj(this,Iv[s],(r&Y1[l])===Y1[l])}}};Kw.prototype.defined=!0;function gj(e,n,t){t&&(e[n]=t)}function Qh(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const s=new Kw(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(s.mustUseProperty=!0),n[r]=s,t[G1(r)]=r,t[G1(s.attribute)]=r}return new Sg(n,t,e.space)}const TE=Qh({properties:{ariaActiveDescendant:null,ariaAtomic:Er,ariaAutoComplete:null,ariaBusy:Er,ariaChecked:Er,ariaColCount:at,ariaColIndex:at,ariaColSpan:at,ariaControls:Wn,ariaCurrent:null,ariaDescribedBy:Wn,ariaDetails:null,ariaDisabled:Er,ariaDropEffect:Wn,ariaErrorMessage:null,ariaExpanded:Er,ariaFlowTo:Wn,ariaGrabbed:Er,ariaHasPopup:null,ariaHidden:Er,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Wn,ariaLevel:at,ariaLive:null,ariaModal:Er,ariaMultiLine:Er,ariaMultiSelectable:Er,ariaOrientation:null,ariaOwns:Wn,ariaPlaceholder:null,ariaPosInSet:at,ariaPressed:Er,ariaReadOnly:Er,ariaRelevant:null,ariaRequired:Er,ariaRoleDescription:Wn,ariaRowCount:at,ariaRowIndex:at,ariaRowSpan:at,ariaSelected:Er,ariaSetSize:at,ariaSort:null,ariaValueMax:at,ariaValueMin:at,ariaValueNow:at,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function AE(e,n){return n in e?e[n]:n}function PE(e,n){return AE(e,n.toLowerCase())}const mq=Qh({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Dh,acceptCharset:Wn,accessKey:Wn,action:null,allow:null,allowFullScreen:zt,allowPaymentRequest:zt,allowUserMedia:zt,alt:null,as:null,async:zt,autoCapitalize:null,autoComplete:Wn,autoFocus:zt,autoPlay:zt,blocking:Wn,capture:null,charSet:null,checked:zt,cite:null,className:Wn,cols:at,colSpan:null,content:null,contentEditable:Er,controls:zt,controlsList:Wn,coords:at|Dh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:zt,defer:zt,dir:null,dirName:null,disabled:zt,download:EE,draggable:Er,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:zt,formTarget:null,headers:Wn,height:at,hidden:zt,high:at,href:null,hrefLang:null,htmlFor:Wn,httpEquiv:Wn,id:null,imageSizes:null,imageSrcSet:null,inert:zt,inputMode:null,integrity:null,is:null,isMap:zt,itemId:null,itemProp:Wn,itemRef:Wn,itemScope:zt,itemType:Wn,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:zt,low:at,manifest:null,max:null,maxLength:at,media:null,method:null,min:null,minLength:at,multiple:zt,muted:zt,name:null,nonce:null,noModule:zt,noValidate:zt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:zt,optimum:at,pattern:null,ping:Wn,placeholder:null,playsInline:zt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:zt,referrerPolicy:null,rel:Wn,required:zt,reversed:zt,rows:at,rowSpan:at,sandbox:Wn,scope:null,scoped:zt,seamless:zt,selected:zt,shadowRootClonable:zt,shadowRootDelegatesFocus:zt,shadowRootMode:null,shape:null,size:at,sizes:null,slot:null,span:at,spellCheck:Er,src:null,srcDoc:null,srcLang:null,srcSet:null,start:at,step:null,style:null,tabIndex:at,target:null,title:null,translate:null,type:null,typeMustMatch:zt,useMap:null,value:Er,width:at,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Wn,axis:null,background:null,bgColor:null,border:at,borderColor:null,bottomMargin:at,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:zt,declare:zt,event:null,face:null,frame:null,frameBorder:null,hSpace:at,leftMargin:at,link:null,longDesc:null,lowSrc:null,marginHeight:at,marginWidth:at,noResize:zt,noHref:zt,noShade:zt,noWrap:zt,object:null,profile:null,prompt:null,rev:null,rightMargin:at,rules:null,scheme:null,scrolling:Er,standby:null,summary:null,text:null,topMargin:at,valueType:null,version:null,vAlign:null,vLink:null,vSpace:at,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:zt,disableRemotePlayback:zt,prefix:null,property:null,results:at,security:null,unselectable:null},space:"html",transform:PE}),gq=Qh({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Da,accentHeight:at,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:at,amplitude:at,arabicForm:null,ascent:at,attributeName:null,attributeType:null,azimuth:at,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:at,by:null,calcMode:null,capHeight:at,className:Wn,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:at,diffuseConstant:at,direction:null,display:null,dur:null,divisor:at,dominantBaseline:null,download:zt,dx:null,dy:null,edgeMode:null,editable:null,elevation:at,enableBackground:null,end:null,event:null,exponent:at,externalResourcesRequired:null,fill:null,fillOpacity:at,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Dh,g2:Dh,glyphName:Dh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:at,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:at,horizOriginX:at,horizOriginY:at,id:null,ideographic:at,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:at,k:at,k1:at,k2:at,k3:at,k4:at,kernelMatrix:Da,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:at,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:at,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:at,overlineThickness:at,paintOrder:null,panose1:null,path:null,pathLength:at,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Wn,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:at,pointsAtY:at,pointsAtZ:at,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Da,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Da,rev:Da,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Da,requiredFeatures:Da,requiredFonts:Da,requiredFormats:Da,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:at,specularExponent:at,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:at,strikethroughThickness:at,string:null,stroke:null,strokeDashArray:Da,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:at,strokeOpacity:at,strokeWidth:null,style:null,surfaceScale:at,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Da,tabIndex:at,tableValues:null,target:null,targetX:at,targetY:at,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Da,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:at,underlineThickness:at,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:at,values:null,vAlphabetic:at,vMathematical:at,vectorEffect:null,vHanging:at,vIdeographic:at,version:null,vertAdvY:at,vertOriginX:at,vertOriginY:at,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:at,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:AE}),DE=Qh({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),IE=Qh({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:PE}),ME=Qh({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),yq={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},xq=/[A-Z]/g,yj=/-[a-z]/g,bq=/^data[-\w.:]+$/i;function vq(e,n){const t=G1(n);let r=n,a=ca;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&bq.test(n)){if(n.charAt(4)==="-"){const s=n.slice(5).replace(yj,Sq);r="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=n.slice(4);if(!yj.test(s)){let l=s.replace(xq,wq);l.charAt(0)!=="-"&&(l="-"+l),n="data"+l}}a=Kw}return new a(r,n)}function wq(e){return"-"+e.toLowerCase()}function Sq(e){return e.charAt(1).toUpperCase()}const Nq=kE([TE,mq,DE,IE,ME],"html"),Xw=kE([TE,gq,DE,IE,ME],"svg");function Cq(e){return e.join(" ").trim()}var Sh={},Mv,xj;function jq(){if(xj)return Mv;xj=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=/\n/g,t=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,a=/^:\s*/,s=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,l=/^[;\s]*/,f=/^\s+|\s+$/g,d=`
`,u="/",h="*",g="",b="comment",v="declaration";Mv=function(k,E){if(typeof k!="string")throw new TypeError("First argument must be a string");if(!k)return[];E=E||{};var T=1,I=1;function D(ee){var te=ee.match(n);te&&(T+=te.length);var ae=ee.lastIndexOf(d);I=~ae?ee.length-ae:I+ee.length}function q(){var ee={line:T,column:I};return function(te){return te.position=new R(ee),z(),te}}function R(ee){this.start=ee,this.end={line:T,column:I},this.source=E.source}R.prototype.content=k;function F(ee){var te=new Error(E.source+":"+T+":"+I+": "+ee);if(te.reason=ee,te.filename=E.source,te.line=T,te.column=I,te.source=k,!E.silent)throw te}function U(ee){var te=ee.exec(k);if(te){var ae=te[0];return D(ae),k=k.slice(ae.length),te}}function z(){U(t)}function V(ee){var te;for(ee=ee||[];te=L();)te!==!1&&ee.push(te);return ee}function L(){var ee=q();if(!(u!=k.charAt(0)||h!=k.charAt(1))){for(var te=2;g!=k.charAt(te)&&(h!=k.charAt(te)||u!=k.charAt(te+1));)++te;if(te+=2,g===k.charAt(te-1))return F("End of comment missing");var ae=k.slice(2,te-2);return I+=2,D(ae),k=k.slice(te),I+=2,ee({type:b,comment:ae})}}function $(){var ee=q(),te=U(r);if(te){if(L(),!U(a))return F("property missing ':'");var ae=U(s),Z=ee({type:v,property:S(te[0].replace(e,g)),value:ae?S(ae[0].replace(e,g)):g});return U(l),Z}}function H(){var ee=[];V(ee);for(var te;te=$();)te!==!1&&(ee.push(te),V(ee));return ee}return z(),H()};function S(k){return k?k.replace(f,g):g}return Mv}var bj;function _q(){if(bj)return Sh;bj=1;var e=Sh&&Sh.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Sh,"__esModule",{value:!0}),Sh.default=t;var n=e(jq());function t(r,a){var s=null;if(!r||typeof r!="string")return s;var l=(0,n.default)(r),f=typeof a=="function";return l.forEach(function(d){if(d.type==="declaration"){var u=d.property,h=d.value;f?a(u,h,d):h&&(s=s||{},s[u]=h)}}),s}return Sh}var zm={},vj;function kq(){if(vj)return zm;vj=1,Object.defineProperty(zm,"__esModule",{value:!0}),zm.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,n=/-([a-z])/g,t=/^[^-]+$/,r=/^-(webkit|moz|ms|o|khtml)-/,a=/^-(ms)-/,s=function(u){return!u||t.test(u)||e.test(u)},l=function(u,h){return h.toUpperCase()},f=function(u,h){return"".concat(h,"-")},d=function(u,h){return h===void 0&&(h={}),s(u)?u:(u=u.toLowerCase(),h.reactCompat?u=u.replace(a,f):u=u.replace(r,f),u.replace(n,l))};return zm.camelCase=d,zm}var Bm,wj;function Eq(){if(wj)return Bm;wj=1;var e=Bm&&Bm.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},n=e(_q()),t=kq();function r(a,s){var l={};return!a||typeof a!="string"||(0,n.default)(a,function(f,d){f&&d&&(l[(0,t.camelCase)(f,s)]=d)}),l}return r.default=r,Bm=r,Bm}var Tq=Eq();const Aq=Bd(Tq),RE=OE("end"),Zw=OE("start");function OE(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function Pq(e){const n=Zw(e),t=RE(e);if(n&&t)return{start:n,end:t}}function Km(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?Sj(e.position):"start"in e||"end"in e?Sj(e):"line"in e||"column"in e?W1(e):""}function W1(e){return Nj(e&&e.line)+":"+Nj(e&&e.column)}function Sj(e){return W1(e&&e.start)+"-"+W1(e&&e.end)}function Nj(e){return e&&typeof e=="number"?e:1}let Ei=class extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",s={},l=!1;if(t&&("line"in t&&"column"in t?s={place:t}:"start"in t&&"end"in t?s={place:t}:"type"in t?s={ancestors:[t],place:t.position}:s={...t}),typeof n=="string"?a=n:!s.cause&&n&&(l=!0,a=n.message,s.cause=n),!s.ruleId&&!s.source&&typeof r=="string"){const d=r.indexOf(":");d===-1?s.ruleId=r:(s.source=r.slice(0,d),s.ruleId=r.slice(d+1))}if(!s.place&&s.ancestors&&s.ancestors){const d=s.ancestors[s.ancestors.length-1];d&&(s.place=d.position)}const f=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=f?f.column:void 0,this.fatal=void 0,this.file,this.message=a,this.line=f?f.line:void 0,this.name=Km(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=l&&s.cause&&typeof s.cause.stack=="string"?s.cause.stack:"",this.actual,this.expected,this.note,this.url}};Ei.prototype.file="";Ei.prototype.name="";Ei.prototype.reason="";Ei.prototype.message="";Ei.prototype.stack="";Ei.prototype.column=void 0;Ei.prototype.line=void 0;Ei.prototype.ancestors=void 0;Ei.prototype.cause=void 0;Ei.prototype.fatal=void 0;Ei.prototype.place=void 0;Ei.prototype.ruleId=void 0;Ei.prototype.source=void 0;const eS={}.hasOwnProperty,Dq=new Map,Iq=/[A-Z]/g,Mq=new Set(["table","tbody","thead","tfoot","tr"]),Rq=new Set(["td","th"]),LE="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function Oq(e,n){if(!n||n.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=n.filePath||void 0;let r;if(n.development){if(typeof n.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=Vq(t,n.jsxDEV)}else{if(typeof n.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof n.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=qq(t,n.jsx,n.jsxs)}const a={Fragment:n.Fragment,ancestors:[],components:n.components||{},create:r,elementAttributeNameCase:n.elementAttributeNameCase||"react",evaluater:n.createEvaluater?n.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:n.ignoreInvalidStyle||!1,passKeys:n.passKeys!==!1,passNode:n.passNode||!1,schema:n.space==="svg"?Xw:Nq,stylePropertyNameCase:n.stylePropertyNameCase||"dom",tableCellAlignToStyle:n.tableCellAlignToStyle!==!1},s=FE(a,e,void 0);return s&&typeof s!="string"?s:a.create(e,a.Fragment,{children:s||void 0},void 0)}function FE(e,n,t){if(n.type==="element")return Lq(e,n,t);if(n.type==="mdxFlowExpression"||n.type==="mdxTextExpression")return Fq(e,n);if(n.type==="mdxJsxFlowElement"||n.type==="mdxJsxTextElement")return zq(e,n,t);if(n.type==="mdxjsEsm")return $q(e,n);if(n.type==="root")return Bq(e,n,t);if(n.type==="text")return Uq(e,n)}function Lq(e,n,t){const r=e.schema;let a=r;n.tagName.toLowerCase()==="svg"&&r.space==="html"&&(a=Xw,e.schema=a),e.ancestors.push(n);const s=zE(e,n.tagName,!1),l=Hq(e,n);let f=nS(e,n);return Mq.has(n.tagName)&&(f=f.filter(function(d){return typeof d=="string"?!hq(d):!0})),$E(e,l,s,n),tS(l,f),e.ancestors.pop(),e.schema=r,e.create(n,s,l,t)}function Fq(e,n){if(n.data&&n.data.estree&&e.evaluater){const r=n.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}dg(e,n.position)}function $q(e,n){if(n.data&&n.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(n.data.estree);dg(e,n.position)}function zq(e,n,t){const r=e.schema;let a=r;n.name==="svg"&&r.space==="html"&&(a=Xw,e.schema=a),e.ancestors.push(n);const s=n.name===null?e.Fragment:zE(e,n.name,!0),l=Gq(e,n),f=nS(e,n);return $E(e,l,s,n),tS(l,f),e.ancestors.pop(),e.schema=r,e.create(n,s,l,t)}function Bq(e,n,t){const r={};return tS(r,nS(e,n)),e.create(n,e.Fragment,r,t)}function Uq(e,n){return n.value}function $E(e,n,t,r){typeof t!="string"&&t!==e.Fragment&&e.passNode&&(n.node=r)}function tS(e,n){if(n.length>0){const t=n.length>1?n:n[0];t&&(e.children=t)}}function qq(e,n,t){return r;function r(a,s,l,f){const u=Array.isArray(l.children)?t:n;return f?u(s,l,f):u(s,l)}}function Vq(e,n){return t;function t(r,a,s,l){const f=Array.isArray(s.children),d=Zw(r);return n(a,s,l,f,{columnNumber:d?d.column-1:void 0,fileName:e,lineNumber:d?d.line:void 0},void 0)}}function Hq(e,n){const t={};let r,a;for(a in n.properties)if(a!=="children"&&eS.call(n.properties,a)){const s=Yq(e,a,n.properties[a]);if(s){const[l,f]=s;e.tableCellAlignToStyle&&l==="align"&&typeof f=="string"&&Rq.has(n.tagName)?r=f:t[l]=f}}if(r){const s=t.style||(t.style={});s[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return t}function Gq(e,n){const t={};for(const r of n.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const s=r.data.estree.body[0];s.type;const l=s.expression;l.type;const f=l.properties[0];f.type,Object.assign(t,e.evaluater.evaluateExpression(f.argument))}else dg(e,n.position);else{const a=r.name;let s;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const f=r.value.data.estree.body[0];f.type,s=e.evaluater.evaluateExpression(f.expression)}else dg(e,n.position);else s=r.value===null?!0:r.value;t[a]=s}return t}function nS(e,n){const t=[];let r=-1;const a=e.passKeys?new Map:Dq;for(;++r<n.children.length;){const s=n.children[r];let l;if(e.passKeys){const d=s.type==="element"?s.tagName:s.type==="mdxJsxFlowElement"||s.type==="mdxJsxTextElement"?s.name:void 0;if(d){const u=a.get(d)||0;l=d+"-"+u,a.set(d,u+1)}}const f=FE(e,s,l);f!==void 0&&t.push(f)}return t}function Yq(e,n,t){const r=vq(e.schema,n);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=r.commaSeparated?lq(t):Cq(t)),r.property==="style"){let a=typeof t=="object"?t:Wq(e,String(t));return e.stylePropertyNameCase==="css"&&(a=Qq(a)),["style",a]}return[e.elementAttributeNameCase==="react"&&r.space?yq[r.property]||r.property:r.attribute,t]}}function Wq(e,n){try{return Aq(n,{reactCompat:!0})}catch(t){if(e.ignoreInvalidStyle)return{};const r=t,a=new Ei("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=e.filePath||void 0,a.url=LE+"#cannot-parse-style-attribute",a}}function zE(e,n,t){let r;if(!t)r={type:"Literal",value:n};else if(n.includes(".")){const a=n.split(".");let s=-1,l;for(;++s<a.length;){const f=pj(a[s])?{type:"Identifier",name:a[s]}:{type:"Literal",value:a[s]};l=l?{type:"MemberExpression",object:l,property:f,computed:!!(s&&f.type==="Literal"),optional:!1}:f}r=l}else r=pj(n)&&!/^[a-z]/.test(n)?{type:"Identifier",name:n}:{type:"Literal",value:n};if(r.type==="Literal"){const a=r.value;return eS.call(e.components,a)?e.components[a]:a}if(e.evaluater)return e.evaluater.evaluateExpression(r);dg(e)}function dg(e,n){const t=new Ei("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:n,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=e.filePath||void 0,t.url=LE+"#cannot-handle-mdx-estrees-without-createevaluater",t}function Qq(e){const n={};let t;for(t in e)eS.call(e,t)&&(n[Jq(t)]=e[t]);return n}function Jq(e){let n=e.replace(Iq,Kq);return n.slice(0,3)==="ms-"&&(n="-"+n),n}function Kq(e){return"-"+e.toLowerCase()}const Rv={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},Xq={};function rS(e,n){const t=Xq,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return BE(e,r,a)}function BE(e,n,t){if(Zq(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return Cj(e.children,n,t)}return Array.isArray(e)?Cj(e,n,t):""}function Cj(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=BE(e[a],n,t);return r.join("")}function Zq(e){return!!(e&&typeof e=="object")}const jj=document.createElement("i");function iS(e){const n="&"+e+";";jj.innerHTML=n;const t=jj.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function Fa(e,n,t,r){const a=e.length;let s=0,l;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)l=Array.from(r),l.unshift(n,t),e.splice(...l);else for(t&&e.splice(n,t);s<r.length;)l=r.slice(s,s+1e4),l.unshift(n,0),e.splice(...l),s+=1e4,n+=1e4}function ss(e,n){return e.length>0?(Fa(e,e.length,0,n),e):n}const _j={}.hasOwnProperty;function UE(e){const n={};let t=-1;for(;++t<e.length;)eV(n,e[t]);return n}function eV(e,n){let t;for(t in n){const a=(_j.call(e,t)?e[t]:void 0)||(e[t]={}),s=n[t];let l;if(s)for(l in s){_j.call(a,l)||(a[l]=[]);const f=s[l];tV(a[l],Array.isArray(f)?f:f?[f]:[])}}}function tV(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);Fa(e,0,0,r)}function qE(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function Bs(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const $i=Zc(/[A-Za-z]/),ji=Zc(/[\dA-Za-z]/),nV=Zc(/[#-'*+\--9=?A-Z^-~]/);function Eb(e){return e!==null&&(e<32||e===127)}const Q1=Zc(/\d/),rV=Zc(/[\dA-Fa-f]/),iV=Zc(/[!-/:-@[-`{-~]/);function Tt(e){return e!==null&&e<-2}function Bn(e){return e!==null&&(e<0||e===32)}function sn(e){return e===-2||e===-1||e===32}const a0=Zc(new RegExp("\\p{P}|\\p{S}","u")),$d=Zc(/\s/);function Zc(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function Jh(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const s=e.charCodeAt(t);let l="";if(s===37&&ji(e.charCodeAt(t+1))&&ji(e.charCodeAt(t+2)))a=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(l=String.fromCharCode(s));else if(s>55295&&s<57344){const f=e.charCodeAt(t+1);s<56320&&f>56319&&f<57344?(l=String.fromCharCode(s,f),a=1):l=""}else l=String.fromCharCode(s);l&&(n.push(e.slice(r,t),encodeURIComponent(l)),r=t+a+1,l=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function fn(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let s=0;return l;function l(d){return sn(d)?(e.enter(t),f(d)):n(d)}function f(d){return sn(d)&&s++<a?(e.consume(d),f):(e.exit(t),n(d))}}const aV={tokenize:sV};function sV(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(f){if(f===null){e.consume(f);return}return e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),fn(e,n,"linePrefix")}function a(f){return e.enter("paragraph"),s(f)}function s(f){const d=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=d),t=d,l(f)}function l(f){if(f===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(f);return}return Tt(f)?(e.consume(f),e.exit("chunkText"),s):(e.consume(f),l)}}const oV={tokenize:lV},kj={tokenize:cV};function lV(e){const n=this,t=[];let r=0,a,s,l;return f;function f(D){if(r<t.length){const q=t[r];return n.containerState=q[1],e.attempt(q[0].continuation,d,u)(D)}return u(D)}function d(D){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&I();const q=n.events.length;let R=q,F;for(;R--;)if(n.events[R][0]==="exit"&&n.events[R][1].type==="chunkFlow"){F=n.events[R][1].end;break}T(r);let U=q;for(;U<n.events.length;)n.events[U][1].end={...F},U++;return Fa(n.events,R+1,0,n.events.slice(q)),n.events.length=U,u(D)}return f(D)}function u(D){if(r===t.length){if(!a)return b(D);if(a.currentConstruct&&a.currentConstruct.concrete)return S(D);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(kj,h,g)(D)}function h(D){return a&&I(),T(r),b(D)}function g(D){return n.parser.lazy[n.now().line]=r!==t.length,l=n.now().offset,S(D)}function b(D){return n.containerState={},e.attempt(kj,v,S)(D)}function v(D){return r++,t.push([n.currentConstruct,n.containerState]),b(D)}function S(D){if(D===null){a&&I(),T(0),e.consume(D);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:s}),k(D)}function k(D){if(D===null){E(e.exit("chunkFlow"),!0),T(0),e.consume(D);return}return Tt(D)?(e.consume(D),E(e.exit("chunkFlow")),r=0,n.interrupt=void 0,f):(e.consume(D),k)}function E(D,q){const R=n.sliceStream(D);if(q&&R.push(null),D.previous=s,s&&(s.next=D),s=D,a.defineSkip(D.start),a.write(R),n.parser.lazy[D.start.line]){let F=a.events.length;for(;F--;)if(a.events[F][1].start.offset<l&&(!a.events[F][1].end||a.events[F][1].end.offset>l))return;const U=n.events.length;let z=U,V,L;for(;z--;)if(n.events[z][0]==="exit"&&n.events[z][1].type==="chunkFlow"){if(V){L=n.events[z][1].end;break}V=!0}for(T(r),F=U;F<n.events.length;)n.events[F][1].end={...L},F++;Fa(n.events,z+1,0,n.events.slice(U)),n.events.length=F}}function T(D){let q=t.length;for(;q-- >D;){const R=t[q];n.containerState=R[1],R[0].exit.call(n,e)}t.length=D}function I(){a.write([null]),s=void 0,a=void 0,n.containerState._closeFlow=void 0}}function cV(e,n,t){return fn(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function zh(e){if(e===null||Bn(e)||$d(e))return 1;if(a0(e))return 2}function s0(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const s=e[a].resolveAll;s&&!r.includes(s)&&(n=s(n,t),r.push(s))}return n}const J1={name:"attention",resolveAll:uV,tokenize:dV};function uV(e,n){let t=-1,r,a,s,l,f,d,u,h;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;d=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};Ej(g,-d),Ej(b,d),l={type:d>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},f={type:d>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},s={type:d>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:d>1?"strong":"emphasis",start:{...l.start},end:{...f.end}},e[r][1].end={...l.start},e[t][1].start={...f.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=ss(u,[["enter",e[r][1],n],["exit",e[r][1],n]])),u=ss(u,[["enter",a,n],["enter",l,n],["exit",l,n],["enter",s,n]]),u=ss(u,s0(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),u=ss(u,[["exit",s,n],["enter",f,n],["exit",f,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(h=2,u=ss(u,[["enter",e[t][1],n],["exit",e[t][1],n]])):h=0,Fa(e,r-1,t-r+3,u),t=r+u.length-h-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function dV(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=zh(r);let s;return l;function l(d){return s=d,e.enter("attentionSequence"),f(d)}function f(d){if(d===s)return e.consume(d),f;const u=e.exit("attentionSequence"),h=zh(d),g=!h||h===2&&a||t.includes(d),b=!a||a===2&&h||t.includes(r);return u._open=!!(s===42?g:g&&(a||!b)),u._close=!!(s===42?b:b&&(h||!g)),n(d)}}function Ej(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const fV={name:"autolink",tokenize:hV};function hV(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),s}function s(v){return $i(v)?(e.consume(v),l):v===64?t(v):u(v)}function l(v){return v===43||v===45||v===46||ji(v)?(r=1,f(v)):u(v)}function f(v){return v===58?(e.consume(v),r=0,d):(v===43||v===45||v===46||ji(v))&&r++<32?(e.consume(v),f):(r=0,u(v))}function d(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||Eb(v)?t(v):(e.consume(v),d)}function u(v){return v===64?(e.consume(v),h):nV(v)?(e.consume(v),u):t(v)}function h(v){return ji(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,h):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||ji(v))&&r++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const Ng={partial:!0,tokenize:pV};function pV(e,n,t){return r;function r(s){return sn(s)?fn(e,a,"linePrefix")(s):a(s)}function a(s){return s===null||Tt(s)?n(s):t(s)}}const VE={continuation:{tokenize:gV},exit:yV,name:"blockQuote",tokenize:mV};function mV(e,n,t){const r=this;return a;function a(l){if(l===62){const f=r.containerState;return f.open||(e.enter("blockQuote",{_container:!0}),f.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),s}return t(l)}function s(l){return sn(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(l))}}function gV(e,n,t){const r=this;return a;function a(l){return sn(l)?fn(e,s,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):s(l)}function s(l){return e.attempt(VE,n,t)(l)}}function yV(e){e.exit("blockQuote")}const HE={name:"characterEscape",tokenize:xV};function xV(e,n,t){return r;function r(s){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(s),e.exit("escapeMarker"),a}function a(s){return iV(s)?(e.enter("characterEscapeValue"),e.consume(s),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(s)}}const GE={name:"characterReference",tokenize:bV};function bV(e,n,t){const r=this;let a=0,s,l;return f;function f(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),d}function d(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),s=31,l=ji,h(g))}function u(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),s=6,l=rV,h):(e.enter("characterReferenceValue"),s=7,l=Q1,h(g))}function h(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return l===ji&&!iS(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return l(g)&&a++<s?(e.consume(g),h):t(g)}}const Tj={partial:!0,tokenize:wV},Aj={concrete:!0,name:"codeFenced",tokenize:vV};function vV(e,n,t){const r=this,a={partial:!0,tokenize:R};let s=0,l=0,f;return d;function d(F){return u(F)}function u(F){const U=r.events[r.events.length-1];return s=U&&U[1].type==="linePrefix"?U[2].sliceSerialize(U[1],!0).length:0,f=F,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),h(F)}function h(F){return F===f?(l++,e.consume(F),h):l<3?t(F):(e.exit("codeFencedFenceSequence"),sn(F)?fn(e,g,"whitespace")(F):g(F))}function g(F){return F===null||Tt(F)?(e.exit("codeFencedFence"),r.interrupt?n(F):e.check(Tj,k,q)(F)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b(F))}function b(F){return F===null||Tt(F)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g(F)):sn(F)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),fn(e,v,"whitespace")(F)):F===96&&F===f?t(F):(e.consume(F),b)}function v(F){return F===null||Tt(F)?g(F):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S(F))}function S(F){return F===null||Tt(F)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g(F)):F===96&&F===f?t(F):(e.consume(F),S)}function k(F){return e.attempt(a,q,E)(F)}function E(F){return e.enter("lineEnding"),e.consume(F),e.exit("lineEnding"),T}function T(F){return s>0&&sn(F)?fn(e,I,"linePrefix",s+1)(F):I(F)}function I(F){return F===null||Tt(F)?e.check(Tj,k,q)(F):(e.enter("codeFlowValue"),D(F))}function D(F){return F===null||Tt(F)?(e.exit("codeFlowValue"),I(F)):(e.consume(F),D)}function q(F){return e.exit("codeFenced"),n(F)}function R(F,U,z){let V=0;return L;function L(ae){return F.enter("lineEnding"),F.consume(ae),F.exit("lineEnding"),$}function $(ae){return F.enter("codeFencedFence"),sn(ae)?fn(F,H,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(ae):H(ae)}function H(ae){return ae===f?(F.enter("codeFencedFenceSequence"),ee(ae)):z(ae)}function ee(ae){return ae===f?(V++,F.consume(ae),ee):V>=l?(F.exit("codeFencedFenceSequence"),sn(ae)?fn(F,te,"whitespace")(ae):te(ae)):z(ae)}function te(ae){return ae===null||Tt(ae)?(F.exit("codeFencedFence"),U(ae)):z(ae)}}}function wV(e,n,t){const r=this;return a;function a(l){return l===null?t(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),s)}function s(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}const Ov={name:"codeIndented",tokenize:NV},SV={partial:!0,tokenize:CV};function NV(e,n,t){const r=this;return a;function a(u){return e.enter("codeIndented"),fn(e,s,"linePrefix",5)(u)}function s(u){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?l(u):t(u)}function l(u){return u===null?d(u):Tt(u)?e.attempt(SV,l,d)(u):(e.enter("codeFlowValue"),f(u))}function f(u){return u===null||Tt(u)?(e.exit("codeFlowValue"),l(u)):(e.consume(u),f)}function d(u){return e.exit("codeIndented"),n(u)}}function CV(e,n,t){const r=this;return a;function a(l){return r.parser.lazy[r.now().line]?t(l):Tt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):fn(e,s,"linePrefix",5)(l)}function s(l){const f=r.events[r.events.length-1];return f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?n(l):Tt(l)?a(l):t(l)}}const jV={name:"codeText",previous:kV,resolve:_V,tokenize:EV};function _V(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function kV(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function EV(e,n,t){let r=0,a,s;return l;function l(g){return e.enter("codeText"),e.enter("codeTextSequence"),f(g)}function f(g){return g===96?(e.consume(g),r++,f):(e.exit("codeTextSequence"),d(g))}function d(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),d):g===96?(s=e.enter("codeTextSequence"),a=0,h(g)):Tt(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),d):(e.enter("codeTextData"),u(g))}function u(g){return g===null||g===32||g===96||Tt(g)?(e.exit("codeTextData"),d(g)):(e.consume(g),u)}function h(g){return g===96?(e.consume(g),a++,h):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(s.type="codeTextData",u(g))}}let TV=class{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const s=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&Um(this.left,r),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Um(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Um(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Um(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Um(this.left,t.reverse())}}};function Um(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function YE(e){const n={};let t=-1,r,a,s,l,f,d,u;const h=new TV(e);for(;++t<h.length;){for(;t in n;)t=n[t];if(r=h.get(t),t&&r[1].type==="chunkFlow"&&h.get(t-1)[1].type==="listItemPrefix"&&(d=r[1]._tokenizer.events,s=0,s<d.length&&d[s][1].type==="lineEndingBlank"&&(s+=2),s<d.length&&d[s][1].type==="content"))for(;++s<d.length&&d[s][1].type!=="content";)d[s][1].type==="chunkText"&&(d[s][1]._isInFirstContentOfListItem=!0,s++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,AV(h,t)),t=n[t],u=!0);else if(r[1]._container){for(s=t,a=void 0;s--;)if(l=h.get(s),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(h.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=s);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(r[1].end={...h.get(a)[1].start},f=h.slice(a,t),f.unshift(r),h.splice(a,t-a+1,f))}}return Fa(e,0,Number.POSITIVE_INFINITY,h.slice(0)),!u}function AV(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const s=[];let l=t._tokenizer;l||(l=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const f=l.events,d=[],u={};let h,g,b=-1,v=t,S=0,k=0;const E=[k];for(;v;){for(;e.get(++a)[1]!==v;);s.push(a),v._tokenizer||(h=r.sliceStream(v),v.next||h.push(null),g&&l.defineSkip(v.start),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(h),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<f.length;)f[b][0]==="exit"&&f[b-1][0]==="enter"&&f[b][1].type===f[b-1][1].type&&f[b][1].start.line!==f[b][1].end.line&&(k=b+1,E.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(l.events=[],v?(v._tokenizer=void 0,v.previous=void 0):E.pop(),b=E.length;b--;){const T=f.slice(E[b],E[b+1]),I=s.pop();d.push([I,I+T.length-1]),e.splice(I,2,T)}for(d.reverse(),b=-1;++b<d.length;)u[S+d[b][0]]=S+d[b][1],S+=d[b][1]-d[b][0]-1;return u}const PV={resolve:IV,tokenize:MV},DV={partial:!0,tokenize:RV};function IV(e){return YE(e),e}function MV(e,n){let t;return r;function r(f){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(f)}function a(f){return f===null?s(f):Tt(f)?e.check(DV,l,s)(f):(e.consume(f),a)}function s(f){return e.exit("chunkContent"),e.exit("content"),n(f)}function l(f){return e.consume(f),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function RV(e,n,t){const r=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),fn(e,s,"linePrefix")}function s(l){if(l===null||Tt(l))return t(l);const f=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?n(l):e.interrupt(r.parser.constructs.flow,t,n)(l)}}function WE(e,n,t,r,a,s,l,f,d){const u=d||Number.POSITIVE_INFINITY;let h=0;return g;function g(T){return T===60?(e.enter(r),e.enter(a),e.enter(s),e.consume(T),e.exit(s),b):T===null||T===32||T===41||Eb(T)?t(T):(e.enter(r),e.enter(l),e.enter(f),e.enter("chunkString",{contentType:"string"}),k(T))}function b(T){return T===62?(e.enter(s),e.consume(T),e.exit(s),e.exit(a),e.exit(r),n):(e.enter(f),e.enter("chunkString",{contentType:"string"}),v(T))}function v(T){return T===62?(e.exit("chunkString"),e.exit(f),b(T)):T===null||T===60||Tt(T)?t(T):(e.consume(T),T===92?S:v)}function S(T){return T===60||T===62||T===92?(e.consume(T),v):v(T)}function k(T){return!h&&(T===null||T===41||Bn(T))?(e.exit("chunkString"),e.exit(f),e.exit(l),e.exit(r),n(T)):h<u&&T===40?(e.consume(T),h++,k):T===41?(e.consume(T),h--,k):T===null||T===32||T===40||Eb(T)?t(T):(e.consume(T),T===92?E:k)}function E(T){return T===40||T===41||T===92?(e.consume(T),k):k(T)}}function QE(e,n,t,r,a,s){const l=this;let f=0,d;return u;function u(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(s),h}function h(v){return f>999||v===null||v===91||v===93&&!d||v===94&&!f&&"_hiddenFootnoteSupport"in l.parser.constructs?t(v):v===93?(e.exit(s),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):Tt(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),h):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||Tt(v)||f++>999?(e.exit("chunkString"),h(v)):(e.consume(v),d||(d=!sn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),f++,g):g(v)}}function JE(e,n,t,r,a,s){let l;return f;function f(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),l=b===40?41:b,d):t(b)}function d(b){return b===l?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(s),u(b))}function u(b){return b===l?(e.exit(s),d(l)):b===null?t(b):Tt(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),fn(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),h(b))}function h(b){return b===l||b===null||Tt(b)?(e.exit("chunkString"),u(b)):(e.consume(b),b===92?g:h)}function g(b){return b===l||b===92?(e.consume(b),h):h(b)}}function Xm(e,n){let t;return r;function r(a){return Tt(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):sn(a)?fn(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const OV={name:"definition",tokenize:FV},LV={partial:!0,tokenize:$V};function FV(e,n,t){const r=this;let a;return s;function s(v){return e.enter("definition"),l(v)}function l(v){return QE.call(r,e,f,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function f(v){return a=Bs(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),d):t(v)}function d(v){return Bn(v)?Xm(e,u)(v):u(v)}function u(v){return WE(e,h,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function h(v){return e.attempt(LV,g,g)(v)}function g(v){return sn(v)?fn(e,b,"whitespace")(v):b(v)}function b(v){return v===null||Tt(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function $V(e,n,t){return r;function r(f){return Bn(f)?Xm(e,a)(f):t(f)}function a(f){return JE(e,s,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(f)}function s(f){return sn(f)?fn(e,l,"whitespace")(f):l(f)}function l(f){return f===null||Tt(f)?n(f):t(f)}}const zV={name:"hardBreakEscape",tokenize:BV};function BV(e,n,t){return r;function r(s){return e.enter("hardBreakEscape"),e.consume(s),a}function a(s){return Tt(s)?(e.exit("hardBreakEscape"),n(s)):t(s)}}const UV={name:"headingAtx",resolve:qV,tokenize:VV};function qV(e,n){let t=e.length-2,r=3,a,s;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},s={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},Fa(e,r,t-r+1,[["enter",a,n],["enter",s,n],["exit",s,n],["exit",a,n]])),e}function VV(e,n,t){let r=0;return a;function a(h){return e.enter("atxHeading"),s(h)}function s(h){return e.enter("atxHeadingSequence"),l(h)}function l(h){return h===35&&r++<6?(e.consume(h),l):h===null||Bn(h)?(e.exit("atxHeadingSequence"),f(h)):t(h)}function f(h){return h===35?(e.enter("atxHeadingSequence"),d(h)):h===null||Tt(h)?(e.exit("atxHeading"),n(h)):sn(h)?fn(e,f,"whitespace")(h):(e.enter("atxHeadingText"),u(h))}function d(h){return h===35?(e.consume(h),d):(e.exit("atxHeadingSequence"),f(h))}function u(h){return h===null||h===35||Bn(h)?(e.exit("atxHeadingText"),f(h)):(e.consume(h),u)}}const HV=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Pj=["pre","script","style","textarea"],GV={concrete:!0,name:"htmlFlow",resolveTo:QV,tokenize:JV},YV={partial:!0,tokenize:XV},WV={partial:!0,tokenize:KV};function QV(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function JV(e,n,t){const r=this;let a,s,l,f,d;return u;function u(M){return h(M)}function h(M){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(M),g}function g(M){return M===33?(e.consume(M),b):M===47?(e.consume(M),s=!0,k):M===63?(e.consume(M),a=3,r.interrupt?n:A):$i(M)?(e.consume(M),l=String.fromCharCode(M),E):t(M)}function b(M){return M===45?(e.consume(M),a=2,v):M===91?(e.consume(M),a=5,f=0,S):$i(M)?(e.consume(M),a=4,r.interrupt?n:A):t(M)}function v(M){return M===45?(e.consume(M),r.interrupt?n:A):t(M)}function S(M){const pe="CDATA[";return M===pe.charCodeAt(f++)?(e.consume(M),f===pe.length?r.interrupt?n:H:S):t(M)}function k(M){return $i(M)?(e.consume(M),l=String.fromCharCode(M),E):t(M)}function E(M){if(M===null||M===47||M===62||Bn(M)){const pe=M===47,be=l.toLowerCase();return!pe&&!s&&Pj.includes(be)?(a=1,r.interrupt?n(M):H(M)):HV.includes(l.toLowerCase())?(a=6,pe?(e.consume(M),T):r.interrupt?n(M):H(M)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(M):s?I(M):D(M))}return M===45||ji(M)?(e.consume(M),l+=String.fromCharCode(M),E):t(M)}function T(M){return M===62?(e.consume(M),r.interrupt?n:H):t(M)}function I(M){return sn(M)?(e.consume(M),I):L(M)}function D(M){return M===47?(e.consume(M),L):M===58||M===95||$i(M)?(e.consume(M),q):sn(M)?(e.consume(M),D):L(M)}function q(M){return M===45||M===46||M===58||M===95||ji(M)?(e.consume(M),q):R(M)}function R(M){return M===61?(e.consume(M),F):sn(M)?(e.consume(M),R):D(M)}function F(M){return M===null||M===60||M===61||M===62||M===96?t(M):M===34||M===39?(e.consume(M),d=M,U):sn(M)?(e.consume(M),F):z(M)}function U(M){return M===d?(e.consume(M),d=null,V):M===null||Tt(M)?t(M):(e.consume(M),U)}function z(M){return M===null||M===34||M===39||M===47||M===60||M===61||M===62||M===96||Bn(M)?R(M):(e.consume(M),z)}function V(M){return M===47||M===62||sn(M)?D(M):t(M)}function L(M){return M===62?(e.consume(M),$):t(M)}function $(M){return M===null||Tt(M)?H(M):sn(M)?(e.consume(M),$):t(M)}function H(M){return M===45&&a===2?(e.consume(M),Z):M===60&&a===1?(e.consume(M),B):M===62&&a===4?(e.consume(M),se):M===63&&a===3?(e.consume(M),A):M===93&&a===5?(e.consume(M),oe):Tt(M)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(YV,ue,ee)(M)):M===null||Tt(M)?(e.exit("htmlFlowData"),ee(M)):(e.consume(M),H)}function ee(M){return e.check(WV,te,ue)(M)}function te(M){return e.enter("lineEnding"),e.consume(M),e.exit("lineEnding"),ae}function ae(M){return M===null||Tt(M)?ee(M):(e.enter("htmlFlowData"),H(M))}function Z(M){return M===45?(e.consume(M),A):H(M)}function B(M){return M===47?(e.consume(M),l="",K):H(M)}function K(M){if(M===62){const pe=l.toLowerCase();return Pj.includes(pe)?(e.consume(M),se):H(M)}return $i(M)&&l.length<8?(e.consume(M),l+=String.fromCharCode(M),K):H(M)}function oe(M){return M===93?(e.consume(M),A):H(M)}function A(M){return M===62?(e.consume(M),se):M===45&&a===2?(e.consume(M),A):H(M)}function se(M){return M===null||Tt(M)?(e.exit("htmlFlowData"),ue(M)):(e.consume(M),se)}function ue(M){return e.exit("htmlFlow"),n(M)}}function KV(e,n,t){const r=this;return a;function a(l){return Tt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),s):t(l)}function s(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}function XV(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(Ng,n,t)}}const ZV={name:"htmlText",tokenize:eH};function eH(e,n,t){const r=this;let a,s,l;return f;function f(A){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(A),d}function d(A){return A===33?(e.consume(A),u):A===47?(e.consume(A),R):A===63?(e.consume(A),D):$i(A)?(e.consume(A),z):t(A)}function u(A){return A===45?(e.consume(A),h):A===91?(e.consume(A),s=0,S):$i(A)?(e.consume(A),I):t(A)}function h(A){return A===45?(e.consume(A),v):t(A)}function g(A){return A===null?t(A):A===45?(e.consume(A),b):Tt(A)?(l=g,B(A)):(e.consume(A),g)}function b(A){return A===45?(e.consume(A),v):g(A)}function v(A){return A===62?Z(A):A===45?b(A):g(A)}function S(A){const se="CDATA[";return A===se.charCodeAt(s++)?(e.consume(A),s===se.length?k:S):t(A)}function k(A){return A===null?t(A):A===93?(e.consume(A),E):Tt(A)?(l=k,B(A)):(e.consume(A),k)}function E(A){return A===93?(e.consume(A),T):k(A)}function T(A){return A===62?Z(A):A===93?(e.consume(A),T):k(A)}function I(A){return A===null||A===62?Z(A):Tt(A)?(l=I,B(A)):(e.consume(A),I)}function D(A){return A===null?t(A):A===63?(e.consume(A),q):Tt(A)?(l=D,B(A)):(e.consume(A),D)}function q(A){return A===62?Z(A):D(A)}function R(A){return $i(A)?(e.consume(A),F):t(A)}function F(A){return A===45||ji(A)?(e.consume(A),F):U(A)}function U(A){return Tt(A)?(l=U,B(A)):sn(A)?(e.consume(A),U):Z(A)}function z(A){return A===45||ji(A)?(e.consume(A),z):A===47||A===62||Bn(A)?V(A):t(A)}function V(A){return A===47?(e.consume(A),Z):A===58||A===95||$i(A)?(e.consume(A),L):Tt(A)?(l=V,B(A)):sn(A)?(e.consume(A),V):Z(A)}function L(A){return A===45||A===46||A===58||A===95||ji(A)?(e.consume(A),L):$(A)}function $(A){return A===61?(e.consume(A),H):Tt(A)?(l=$,B(A)):sn(A)?(e.consume(A),$):V(A)}function H(A){return A===null||A===60||A===61||A===62||A===96?t(A):A===34||A===39?(e.consume(A),a=A,ee):Tt(A)?(l=H,B(A)):sn(A)?(e.consume(A),H):(e.consume(A),te)}function ee(A){return A===a?(e.consume(A),a=void 0,ae):A===null?t(A):Tt(A)?(l=ee,B(A)):(e.consume(A),ee)}function te(A){return A===null||A===34||A===39||A===60||A===61||A===96?t(A):A===47||A===62||Bn(A)?V(A):(e.consume(A),te)}function ae(A){return A===47||A===62||Bn(A)?V(A):t(A)}function Z(A){return A===62?(e.consume(A),e.exit("htmlTextData"),e.exit("htmlText"),n):t(A)}function B(A){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(A),e.exit("lineEnding"),K}function K(A){return sn(A)?fn(e,oe,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(A):oe(A)}function oe(A){return e.enter("htmlTextData"),l(A)}}const aS={name:"labelEnd",resolveAll:iH,resolveTo:aH,tokenize:sH},tH={tokenize:oH},nH={tokenize:lH},rH={tokenize:cH};function iH(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&Fa(e,0,e.length,t),e}function aH(e,n){let t=e.length,r=0,a,s,l,f;for(;t--;)if(a=e[t][1],s){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(s=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(l=t);const d={type:e[s][1].type==="labelLink"?"link":"image",start:{...e[s][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[s][1].start},end:{...e[l][1].end}},h={type:"labelText",start:{...e[s+r+2][1].end},end:{...e[l-2][1].start}};return f=[["enter",d,n],["enter",u,n]],f=ss(f,e.slice(s+1,s+r+3)),f=ss(f,[["enter",h,n]]),f=ss(f,s0(n.parser.constructs.insideSpan.null,e.slice(s+r+4,l-3),n)),f=ss(f,[["exit",h,n],e[l-2],e[l-1],["exit",u,n]]),f=ss(f,e.slice(l+1)),f=ss(f,[["exit",d,n]]),Fa(e,s,e.length,f),e}function sH(e,n,t){const r=this;let a=r.events.length,s,l;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){s=r.events[a][1];break}return f;function f(b){return s?s._inactive?g(b):(l=r.parser.defined.includes(Bs(r.sliceSerialize({start:s.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),d):t(b)}function d(b){return b===40?e.attempt(tH,h,l?h:g)(b):b===91?e.attempt(nH,h,l?u:g)(b):l?h(b):g(b)}function u(b){return e.attempt(rH,h,g)(b)}function h(b){return n(b)}function g(b){return s._balanced=!0,t(b)}}function oH(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return Bn(g)?Xm(e,s)(g):s(g)}function s(g){return g===41?h(g):WE(e,l,f,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function l(g){return Bn(g)?Xm(e,d)(g):h(g)}function f(g){return t(g)}function d(g){return g===34||g===39||g===40?JE(e,u,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):h(g)}function u(g){return Bn(g)?Xm(e,h)(g):h(g)}function h(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function lH(e,n,t){const r=this;return a;function a(f){return QE.call(r,e,s,l,"reference","referenceMarker","referenceString")(f)}function s(f){return r.parser.defined.includes(Bs(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(f):t(f)}function l(f){return t(f)}}function cH(e,n,t){return r;function r(s){return e.enter("reference"),e.enter("referenceMarker"),e.consume(s),e.exit("referenceMarker"),a}function a(s){return s===93?(e.enter("referenceMarker"),e.consume(s),e.exit("referenceMarker"),e.exit("reference"),n):t(s)}}const uH={name:"labelStartImage",resolveAll:aS.resolveAll,tokenize:dH};function dH(e,n,t){const r=this;return a;function a(f){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(f),e.exit("labelImageMarker"),s}function s(f){return f===91?(e.enter("labelMarker"),e.consume(f),e.exit("labelMarker"),e.exit("labelImage"),l):t(f)}function l(f){return f===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(f):n(f)}}const fH={name:"labelStartLink",resolveAll:aS.resolveAll,tokenize:hH};function hH(e,n,t){const r=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),s}function s(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(l):n(l)}}const Lv={name:"lineEnding",tokenize:pH};function pH(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),fn(e,n,"linePrefix")}}const rb={name:"thematicBreak",tokenize:mH};function mH(e,n,t){let r=0,a;return s;function s(u){return e.enter("thematicBreak"),l(u)}function l(u){return a=u,f(u)}function f(u){return u===a?(e.enter("thematicBreakSequence"),d(u)):r>=3&&(u===null||Tt(u))?(e.exit("thematicBreak"),n(u)):t(u)}function d(u){return u===a?(e.consume(u),r++,d):(e.exit("thematicBreakSequence"),sn(u)?fn(e,f,"whitespace")(u):f(u))}}const na={continuation:{tokenize:bH},exit:wH,name:"list",tokenize:xH},gH={partial:!0,tokenize:SH},yH={partial:!0,tokenize:vH};function xH(e,n,t){const r=this,a=r.events[r.events.length-1];let s=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return f;function f(v){const S=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:Q1(v)){if(r.containerState.type||(r.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(rb,t,u)(v):u(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),d(v)}return t(v)}function d(v){return Q1(v)&&++l<10?(e.consume(v),d):(!r.interrupt||l<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),u(v)):t(v)}function u(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(Ng,r.interrupt?t:h,e.attempt(gH,b,g))}function h(v){return r.containerState.initialBlankLine=!0,s++,b(v)}function g(v){return sn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=s+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function bH(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(Ng,a,s);function a(f){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,fn(e,n,"listItemIndent",r.containerState.size+1)(f)}function s(f){return r.containerState.furtherBlankLines||!sn(f)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,l(f)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(yH,n,l)(f))}function l(f){return r.containerState._closeFlow=!0,r.interrupt=void 0,fn(e,e.attempt(na,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(f)}}function vH(e,n,t){const r=this;return fn(e,a,"listItemIndent",r.containerState.size+1);function a(s){const l=r.events[r.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===r.containerState.size?n(s):t(s)}}function wH(e){e.exit(this.containerState.type)}function SH(e,n,t){const r=this;return fn(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(s){const l=r.events[r.events.length-1];return!sn(s)&&l&&l[1].type==="listItemPrefixWhitespace"?n(s):t(s)}}const Dj={name:"setextUnderline",resolveTo:NH,tokenize:CH};function NH(e,n){let t=e.length,r,a,s;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!s&&e[t][1].type==="definition"&&(s=t);const l={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",s?(e.splice(a,0,["enter",l,n]),e.splice(s+1,0,["exit",e[r][1],n]),e[r][1].end={...e[s][1].end}):e[r][1]=l,e.push(["exit",l,n]),e}function CH(e,n,t){const r=this;let a;return s;function s(u){let h=r.events.length,g;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){g=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=u,l(u)):t(u)}function l(u){return e.enter("setextHeadingLineSequence"),f(u)}function f(u){return u===a?(e.consume(u),f):(e.exit("setextHeadingLineSequence"),sn(u)?fn(e,d,"lineSuffix")(u):d(u))}function d(u){return u===null||Tt(u)?(e.exit("setextHeadingLine"),n(u)):t(u)}}const jH={tokenize:_H};function _H(e){const n=this,t=e.attempt(Ng,r,e.attempt(this.parser.constructs.flowInitial,a,fn(e,e.attempt(this.parser.constructs.flow,a,e.attempt(PV,a)),"linePrefix")));return t;function r(s){if(s===null){e.consume(s);return}return e.enter("lineEndingBlank"),e.consume(s),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(s){if(s===null){e.consume(s);return}return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const kH={resolveAll:XE()},EH=KE("string"),TH=KE("text");function KE(e){return{resolveAll:XE(e==="text"?AH:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],s=t.attempt(a,l,f);return l;function l(h){return u(h)?s(h):f(h)}function f(h){if(h===null){t.consume(h);return}return t.enter("data"),t.consume(h),d}function d(h){return u(h)?(t.exit("data"),s(h)):(t.consume(h),d)}function u(h){if(h===null)return!0;const g=a[h];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function XE(e){return n;function n(t,r){let a=-1,s;for(;++a<=t.length;)s===void 0?t[a]&&t[a][1].type==="data"&&(s=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==s+2&&(t[s][1].end=t[a-1][1].end,t.splice(s+2,a-s-2),a=s+2),s=void 0);return e?e(t,r):t}}function AH(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let s=a.length,l=-1,f=0,d;for(;s--;){const u=a[s];if(typeof u=="string"){for(l=u.length;u.charCodeAt(l-1)===32;)f++,l--;if(l)break;l=-1}else if(u===-2)d=!0,f++;else if(u!==-1){s++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(f=0),f){const u={type:t===e.length||d||f<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?l:r.start._bufferIndex+l,_index:r.start._index+s,line:r.end.line,column:r.end.column-f,offset:r.end.offset-f},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(t,0,["enter",u,n],["exit",u,n]),t+=2)}t++}return e}const PH={42:na,43:na,45:na,48:na,49:na,50:na,51:na,52:na,53:na,54:na,55:na,56:na,57:na,62:VE},DH={91:OV},IH={[-2]:Ov,[-1]:Ov,32:Ov},MH={35:UV,42:rb,45:[Dj,rb],60:GV,61:Dj,95:rb,96:Aj,126:Aj},RH={38:GE,92:HE},OH={[-5]:Lv,[-4]:Lv,[-3]:Lv,33:uH,38:GE,42:J1,60:[fV,ZV],91:fH,92:[zV,HE],93:aS,95:J1,96:jV},LH={null:[J1,kH]},FH={null:[42,95]},$H={null:[]},zH=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:FH,contentInitial:DH,disable:$H,document:PH,flow:MH,flowInitial:IH,insideSpan:LH,string:RH,text:OH},Symbol.toStringTag,{value:"Module"}));function BH(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},s=[];let l=[],f=[];const d={attempt:U(R),check:U(F),consume:I,enter:D,exit:q,interrupt:U(F,{interrupt:!0})},u={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let h=n.tokenize.call(u,d);return n.resolveAll&&s.push(n),u;function g($){return l=ss(l,$),E(),l[l.length-1]!==null?[]:(z(n,0),u.events=s0(s,u.events,u),u.events)}function b($,H){return qH(v($),H)}function v($){return UH(l,$)}function S(){const{_bufferIndex:$,_index:H,line:ee,column:te,offset:ae}=r;return{_bufferIndex:$,_index:H,line:ee,column:te,offset:ae}}function k($){a[$.line]=$.column,L()}function E(){let $;for(;r._index<l.length;){const H=l[r._index];if(typeof H=="string")for($=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===$&&r._bufferIndex<H.length;)T(H.charCodeAt(r._bufferIndex));else T(H)}}function T($){h=h($)}function I($){Tt($)?(r.line++,r.column=1,r.offset+=$===-3?2:1,L()):$!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===l[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=$}function D($,H){const ee=H||{};return ee.type=$,ee.start=S(),u.events.push(["enter",ee,u]),f.push(ee),ee}function q($){const H=f.pop();return H.end=S(),u.events.push(["exit",H,u]),H}function R($,H){z($,H.from)}function F($,H){H.restore()}function U($,H){return ee;function ee(te,ae,Z){let B,K,oe,A;return Array.isArray(te)?ue(te):"tokenize"in te?ue([te]):se(te);function se(fe){return Pe;function Pe(de){const Me=de!==null&&fe[de],Ze=de!==null&&fe.null,Fe=[...Array.isArray(Me)?Me:Me?[Me]:[],...Array.isArray(Ze)?Ze:Ze?[Ze]:[]];return ue(Fe)(de)}}function ue(fe){return B=fe,K=0,fe.length===0?Z:M(fe[K])}function M(fe){return Pe;function Pe(de){return A=V(),oe=fe,fe.partial||(u.currentConstruct=fe),fe.name&&u.parser.constructs.disable.null.includes(fe.name)?be():fe.tokenize.call(H?Object.assign(Object.create(u),H):u,d,pe,be)(de)}}function pe(fe){return $(oe,A),ae}function be(fe){return A.restore(),++K<B.length?M(B[K]):Z}}}function z($,H){$.resolveAll&&!s.includes($)&&s.push($),$.resolve&&Fa(u.events,H,u.events.length-H,$.resolve(u.events.slice(H),u)),$.resolveTo&&(u.events=$.resolveTo(u.events,u))}function V(){const $=S(),H=u.previous,ee=u.currentConstruct,te=u.events.length,ae=Array.from(f);return{from:te,restore:Z};function Z(){r=$,u.previous=H,u.currentConstruct=ee,u.events.length=te,f=ae,L()}}function L(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function UH(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,s=n.end._bufferIndex;let l;if(t===a)l=[e[t].slice(r,s)];else{if(l=e.slice(t,a),r>-1){const f=l[0];typeof f=="string"?l[0]=f.slice(r):l.shift()}s>0&&l.push(e[a].slice(0,s))}return l}function qH(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const s=e[t];let l;if(typeof s=="string")l=s;else switch(s){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=n?" ":"	";break}case-1:{if(!n&&a)continue;l=" ";break}default:l=String.fromCharCode(s)}a=s===-2,r.push(l)}return r.join("")}function VH(e){const r={constructs:UE([zH,...(e||{}).extensions||[]]),content:a(aV),defined:[],document:a(oV),flow:a(jH),lazy:{},string:a(EH),text:a(TH)};return r;function a(s){return l;function l(f){return BH(r,s,f)}}}function HH(e){for(;!YE(e););return e}const Ij=/[\0\t\n\r]/g;function GH(){let e=1,n="",t=!0,r;return a;function a(s,l,f){const d=[];let u,h,g,b,v;for(s=n+(typeof s=="string"?s.toString():new TextDecoder(l||void 0).decode(s)),g=0,n="",t&&(s.charCodeAt(0)===65279&&g++,t=void 0);g<s.length;){if(Ij.lastIndex=g,u=Ij.exec(s),b=u&&u.index!==void 0?u.index:s.length,v=s.charCodeAt(b),!u){n=s.slice(g);break}if(v===10&&g===b&&r)d.push(-3),r=void 0;else switch(r&&(d.push(-5),r=void 0),g<b&&(d.push(s.slice(g,b)),e+=b-g),v){case 0:{d.push(65533),e++;break}case 9:{for(h=Math.ceil(e/4)*4,d.push(-2);e++<h;)d.push(-1);break}case 10:{d.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return f&&(r&&d.push(-5),n&&d.push(n),d.push(null)),d}}const YH=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function WH(e){return e.replace(YH,QH)}function QH(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),s=a===120||a===88;return qE(t.slice(s?2:1),s?16:10)}return iS(t)||e}const ZE={}.hasOwnProperty;function JH(e,n,t){return typeof n!="string"&&(t=n,n=void 0),KH(t)(HH(VH(t).document().write(GH()(e,n,!0))))}function KH(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(jt),autolinkProtocol:V,autolinkEmail:V,atxHeading:s(Ie),blockQuote:s(Ze),characterEscape:V,characterReference:V,codeFenced:s(Fe),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:s(Fe,l),codeText:s(Ce,l),codeTextData:V,data:V,codeFlowValue:V,definition:s(Re),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:s(xe),hardBreakEscape:s(Ge),hardBreakTrailing:s(Ge),htmlFlow:s(ze,l),htmlFlowData:V,htmlText:s(ze,l),htmlTextData:V,image:s(nt),label:l,link:s(jt),listItem:s(ve),listItemValue:b,listOrdered:s(xt,g),listUnordered:s(xt),paragraph:s(qe),reference:M,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:s(Ie),strong:s(Qe),thematicBreak:s(J)},exit:{atxHeading:d(),atxHeadingSequence:R,autolink:d(),autolinkEmail:Me,autolinkProtocol:de,blockQuote:d(),characterEscapeValue:L,characterReferenceMarkerHexadecimal:be,characterReferenceMarkerNumeric:be,characterReferenceValue:fe,characterReference:Pe,codeFenced:d(E),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:L,codeIndented:d(T),codeText:d(ae),codeTextData:L,data:L,definition:d(),definitionDestinationString:q,definitionLabelString:I,definitionTitleString:D,emphasis:d(),hardBreakEscape:d(H),hardBreakTrailing:d(H),htmlFlow:d(ee),htmlFlowData:L,htmlText:d(te),htmlTextData:L,image:d(B),label:oe,labelText:K,lineEnding:$,link:d(Z),listItem:d(),listOrdered:d(),listUnordered:d(),paragraph:d(),referenceString:pe,resourceDestinationString:A,resourceTitleString:se,resource:ue,setextHeading:d(z),setextHeadingLineSequence:U,setextHeadingText:F,strong:d(),thematicBreak:d()}};eT(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(Y){let X={type:"root",children:[]};const Ne={stack:[X],tokenStack:[],config:n,enter:f,exit:u,buffer:l,resume:h,data:t},ke=[];let Ue=-1;for(;++Ue<Y.length;)if(Y[Ue][1].type==="listOrdered"||Y[Ue][1].type==="listUnordered")if(Y[Ue][0]==="enter")ke.push(Ue);else{const it=ke.pop();Ue=a(Y,it,Ue)}for(Ue=-1;++Ue<Y.length;){const it=n[Y[Ue][0]];ZE.call(it,Y[Ue][1].type)&&it[Y[Ue][1].type].call(Object.assign({sliceSerialize:Y[Ue][2].sliceSerialize},Ne),Y[Ue][1])}if(Ne.tokenStack.length>0){const it=Ne.tokenStack[Ne.tokenStack.length-1];(it[1]||Mj).call(Ne,void 0,it[0])}for(X.position={start:zc(Y.length>0?Y[0][1].start:{line:1,column:1,offset:0}),end:zc(Y.length>0?Y[Y.length-2][1].end:{line:1,column:1,offset:0})},Ue=-1;++Ue<n.transforms.length;)X=n.transforms[Ue](X)||X;return X}function a(Y,X,Ne){let ke=X-1,Ue=-1,it=!1,mt,ht,Ve,tt;for(;++ke<=Ne;){const Le=Y[ke];switch(Le[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Le[0]==="enter"?Ue++:Ue--,tt=void 0;break}case"lineEndingBlank":{Le[0]==="enter"&&(mt&&!tt&&!Ue&&!Ve&&(Ve=ke),tt=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:tt=void 0}if(!Ue&&Le[0]==="enter"&&Le[1].type==="listItemPrefix"||Ue===-1&&Le[0]==="exit"&&(Le[1].type==="listUnordered"||Le[1].type==="listOrdered")){if(mt){let ot=ke;for(ht=void 0;ot--;){const et=Y[ot];if(et[1].type==="lineEnding"||et[1].type==="lineEndingBlank"){if(et[0]==="exit")continue;ht&&(Y[ht][1].type="lineEndingBlank",it=!0),et[1].type="lineEnding",ht=ot}else if(!(et[1].type==="linePrefix"||et[1].type==="blockQuotePrefix"||et[1].type==="blockQuotePrefixWhitespace"||et[1].type==="blockQuoteMarker"||et[1].type==="listItemIndent"))break}Ve&&(!ht||Ve<ht)&&(mt._spread=!0),mt.end=Object.assign({},ht?Y[ht][1].start:Le[1].end),Y.splice(ht||ke,0,["exit",mt,Le[2]]),ke++,Ne++}if(Le[1].type==="listItemPrefix"){const ot={type:"listItem",_spread:!1,start:Object.assign({},Le[1].start),end:void 0};mt=ot,Y.splice(ke,0,["enter",ot,Le[2]]),ke++,Ne++,Ve=void 0,tt=!0}}}return Y[X][1]._spread=it,Ne}function s(Y,X){return Ne;function Ne(ke){f.call(this,Y(ke),ke),X&&X.call(this,ke)}}function l(){this.stack.push({type:"fragment",children:[]})}function f(Y,X,Ne){this.stack[this.stack.length-1].children.push(Y),this.stack.push(Y),this.tokenStack.push([X,Ne||void 0]),Y.position={start:zc(X.start),end:void 0}}function d(Y){return X;function X(Ne){Y&&Y.call(this,Ne),u.call(this,Ne)}}function u(Y,X){const Ne=this.stack.pop(),ke=this.tokenStack.pop();if(ke)ke[0].type!==Y.type&&(X?X.call(this,Y,ke[0]):(ke[1]||Mj).call(this,Y,ke[0]));else throw new Error("Cannot close `"+Y.type+"` ("+Km({start:Y.start,end:Y.end})+"): its not open");Ne.position.end=zc(Y.end)}function h(){return rS(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(Y){if(this.data.expectingFirstListItemValue){const X=this.stack[this.stack.length-2];X.start=Number.parseInt(this.sliceSerialize(Y),10),this.data.expectingFirstListItemValue=void 0}}function v(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.lang=Y}function S(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.meta=Y}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function E(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.value=Y.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function T(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.value=Y.replace(/(\r?\n|\r)$/g,"")}function I(Y){const X=this.resume(),Ne=this.stack[this.stack.length-1];Ne.label=X,Ne.identifier=Bs(this.sliceSerialize(Y)).toLowerCase()}function D(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.title=Y}function q(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.url=Y}function R(Y){const X=this.stack[this.stack.length-1];if(!X.depth){const Ne=this.sliceSerialize(Y).length;X.depth=Ne}}function F(){this.data.setextHeadingSlurpLineEnding=!0}function U(Y){const X=this.stack[this.stack.length-1];X.depth=this.sliceSerialize(Y).codePointAt(0)===61?1:2}function z(){this.data.setextHeadingSlurpLineEnding=void 0}function V(Y){const Ne=this.stack[this.stack.length-1].children;let ke=Ne[Ne.length-1];(!ke||ke.type!=="text")&&(ke=Be(),ke.position={start:zc(Y.start),end:void 0},Ne.push(ke)),this.stack.push(ke)}function L(Y){const X=this.stack.pop();X.value+=this.sliceSerialize(Y),X.position.end=zc(Y.end)}function $(Y){const X=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Ne=X.children[X.children.length-1];Ne.position.end=zc(Y.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(X.type)&&(V.call(this,Y),L.call(this,Y))}function H(){this.data.atHardBreak=!0}function ee(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.value=Y}function te(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.value=Y}function ae(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.value=Y}function Z(){const Y=this.stack[this.stack.length-1];if(this.data.inReference){const X=this.data.referenceType||"shortcut";Y.type+="Reference",Y.referenceType=X,delete Y.url,delete Y.title}else delete Y.identifier,delete Y.label;this.data.referenceType=void 0}function B(){const Y=this.stack[this.stack.length-1];if(this.data.inReference){const X=this.data.referenceType||"shortcut";Y.type+="Reference",Y.referenceType=X,delete Y.url,delete Y.title}else delete Y.identifier,delete Y.label;this.data.referenceType=void 0}function K(Y){const X=this.sliceSerialize(Y),Ne=this.stack[this.stack.length-2];Ne.label=WH(X),Ne.identifier=Bs(X).toLowerCase()}function oe(){const Y=this.stack[this.stack.length-1],X=this.resume(),Ne=this.stack[this.stack.length-1];if(this.data.inReference=!0,Ne.type==="link"){const ke=Y.children;Ne.children=ke}else Ne.alt=X}function A(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.url=Y}function se(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.title=Y}function ue(){this.data.inReference=void 0}function M(){this.data.referenceType="collapsed"}function pe(Y){const X=this.resume(),Ne=this.stack[this.stack.length-1];Ne.label=X,Ne.identifier=Bs(this.sliceSerialize(Y)).toLowerCase(),this.data.referenceType="full"}function be(Y){this.data.characterReferenceType=Y.type}function fe(Y){const X=this.sliceSerialize(Y),Ne=this.data.characterReferenceType;let ke;Ne?(ke=qE(X,Ne==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):ke=iS(X);const Ue=this.stack[this.stack.length-1];Ue.value+=ke}function Pe(Y){const X=this.stack.pop();X.position.end=zc(Y.end)}function de(Y){L.call(this,Y);const X=this.stack[this.stack.length-1];X.url=this.sliceSerialize(Y)}function Me(Y){L.call(this,Y);const X=this.stack[this.stack.length-1];X.url="mailto:"+this.sliceSerialize(Y)}function Ze(){return{type:"blockquote",children:[]}}function Fe(){return{type:"code",lang:null,meta:null,value:""}}function Ce(){return{type:"inlineCode",value:""}}function Re(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function xe(){return{type:"emphasis",children:[]}}function Ie(){return{type:"heading",depth:0,children:[]}}function Ge(){return{type:"break"}}function ze(){return{type:"html",value:""}}function nt(){return{type:"image",title:null,url:"",alt:null}}function jt(){return{type:"link",title:null,url:"",children:[]}}function xt(Y){return{type:"list",ordered:Y.type==="listOrdered",start:null,spread:Y._spread,children:[]}}function ve(Y){return{type:"listItem",spread:Y._spread,checked:null,children:[]}}function qe(){return{type:"paragraph",children:[]}}function Qe(){return{type:"strong",children:[]}}function Be(){return{type:"text",value:""}}function J(){return{type:"thematicBreak"}}}function zc(e){return{line:e.line,column:e.column,offset:e.offset}}function eT(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?eT(e,r):XH(e,r)}}function XH(e,n){let t;for(t in n)if(ZE.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function Mj(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+Km({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+Km({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+Km({start:n.start,end:n.end})+") is still open")}function ZH(e){const n=this;n.parser=t;function t(r){return JH(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}function eG(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function tG(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function nG(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function rG(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function iG(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function aG(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=Jh(r.toLowerCase()),s=e.footnoteOrder.indexOf(r);let l,f=e.footnoteCounts.get(r);f===void 0?(f=0,e.footnoteOrder.push(r),l=e.footnoteOrder.length):l=s+1,f+=1,e.footnoteCounts.set(r,f);const d={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(f>1?"-"+f:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(n,d);const u={type:"element",tagName:"sup",properties:{},children:[d]};return e.patch(n,u),e.applyData(n,u)}function sG(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function oG(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function tT(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),s=a[0];s&&s.type==="text"?s.value="["+s.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=r:a.push({type:"text",value:r}),a}function lG(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return tT(e,n);const a={src:Jh(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const s={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,s),e.applyData(n,s)}function cG(e,n){const t={src:Jh(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function uG(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function dG(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return tT(e,n);const a={href:Jh(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const s={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,s),e.applyData(n,s)}function fG(e,n){const t={href:Jh(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function hG(e,n,t){const r=e.all(n),a=t?pG(t):nT(n),s={},l=[];if(typeof n.checked=="boolean"){const h=r[0];let g;h&&h.type==="element"&&h.tagName==="p"?g=h:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let f=-1;for(;++f<r.length;){const h=r[f];(a||f!==0||h.type!=="element"||h.tagName!=="p")&&l.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!a?l.push(...h.children):l.push(h)}const d=r[r.length-1];d&&(a||d.type!=="element"||d.tagName!=="p")&&l.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:s,children:l};return e.patch(n,u),e.applyData(n,u)}function pG(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=nT(t[r])}return n}function nT(e){const n=e.spread;return n??e.children.length>1}function mG(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const l=r[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const s={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,s),e.applyData(n,s)}function gG(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function yG(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function xG(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function bG(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],l),a.push(l)}if(t.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},f=Zw(n.children[1]),d=RE(n.children[n.children.length-1]);f&&d&&(l.position={start:f,end:d}),a.push(l)}const s={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,s),e.applyData(n,s)}function vG(e,n,t){const r=t?t.children:void 0,s=(r?r.indexOf(n):1)===0?"th":"td",l=t&&t.type==="table"?t.align:void 0,f=l?l.length:n.children.length;let d=-1;const u=[];for(;++d<f;){const g=n.children[d],b={},v=l?l[d]:void 0;v&&(b.align=v);let S={type:"element",tagName:s,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),u.push(S)}const h={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(n,h),e.applyData(n,h)}function wG(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const Rj=9,Oj=32;function SG(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const s=[];for(;r;)s.push(Lj(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return s.push(Lj(n.slice(a),a>0,!1)),s.join("")}function Lj(e,n,t){let r=0,a=e.length;if(n){let s=e.codePointAt(r);for(;s===Rj||s===Oj;)r++,s=e.codePointAt(r)}if(t){let s=e.codePointAt(a-1);for(;s===Rj||s===Oj;)a--,s=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function NG(e,n){const t={type:"text",value:SG(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function CG(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const jG={blockquote:eG,break:tG,code:nG,delete:rG,emphasis:iG,footnoteReference:aG,heading:sG,html:oG,imageReference:lG,image:cG,inlineCode:uG,linkReference:dG,link:fG,listItem:hG,list:mG,paragraph:gG,root:yG,strong:xG,table:bG,tableCell:wG,tableRow:vG,text:NG,thematicBreak:CG,toml:Mx,yaml:Mx,definition:Mx,footnoteDefinition:Mx};function Mx(){}const rT=-1,o0=0,Zm=1,Tb=2,sS=3,oS=4,lS=5,cS=6,iT=7,aT=8,Fj=typeof self=="object"?self:globalThis,_G=(e,n)=>{const t=(a,s)=>(e.set(s,a),a),r=a=>{if(e.has(a))return e.get(a);const[s,l]=n[a];switch(s){case o0:case rT:return t(l,a);case Zm:{const f=t([],a);for(const d of l)f.push(r(d));return f}case Tb:{const f=t({},a);for(const[d,u]of l)f[r(d)]=r(u);return f}case sS:return t(new Date(l),a);case oS:{const{source:f,flags:d}=l;return t(new RegExp(f,d),a)}case lS:{const f=t(new Map,a);for(const[d,u]of l)f.set(r(d),r(u));return f}case cS:{const f=t(new Set,a);for(const d of l)f.add(r(d));return f}case iT:{const{name:f,message:d}=l;return t(new Fj[f](d),a)}case aT:return t(BigInt(l),a);case"BigInt":return t(Object(BigInt(l)),a);case"ArrayBuffer":return t(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:f}=new Uint8Array(l);return t(new DataView(f),l)}}return t(new Fj[s](l),a)};return r},$j=e=>_G(new Map,e)(0),Nh="",{toString:kG}={},{keys:EG}=Object,qm=e=>{const n=typeof e;if(n!=="object"||!e)return[o0,n];const t=kG.call(e).slice(8,-1);switch(t){case"Array":return[Zm,Nh];case"Object":return[Tb,Nh];case"Date":return[sS,Nh];case"RegExp":return[oS,Nh];case"Map":return[lS,Nh];case"Set":return[cS,Nh];case"DataView":return[Zm,t]}return t.includes("Array")?[Zm,t]:t.includes("Error")?[iT,t]:[Tb,t]},Rx=([e,n])=>e===o0&&(n==="function"||n==="symbol"),TG=(e,n,t,r)=>{const a=(l,f)=>{const d=r.push(l)-1;return t.set(f,d),d},s=l=>{if(t.has(l))return t.get(l);let[f,d]=qm(l);switch(f){case o0:{let h=l;switch(d){case"bigint":f=aT,h=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+d);h=null;break;case"undefined":return a([rT],l)}return a([f,h],l)}case Zm:{if(d){let b=l;return d==="DataView"?b=new Uint8Array(l.buffer):d==="ArrayBuffer"&&(b=new Uint8Array(l)),a([d,[...b]],l)}const h=[],g=a([f,h],l);for(const b of l)h.push(s(b));return g}case Tb:{if(d)switch(d){case"BigInt":return a([d,l.toString()],l);case"Boolean":case"Number":case"String":return a([d,l.valueOf()],l)}if(n&&"toJSON"in l)return s(l.toJSON());const h=[],g=a([f,h],l);for(const b of EG(l))(e||!Rx(qm(l[b])))&&h.push([s(b),s(l[b])]);return g}case sS:return a([f,l.toISOString()],l);case oS:{const{source:h,flags:g}=l;return a([f,{source:h,flags:g}],l)}case lS:{const h=[],g=a([f,h],l);for(const[b,v]of l)(e||!(Rx(qm(b))||Rx(qm(v))))&&h.push([s(b),s(v)]);return g}case cS:{const h=[],g=a([f,h],l);for(const b of l)(e||!Rx(qm(b)))&&h.push(s(b));return g}}const{message:u}=l;return a([f,{name:d,message:u}],l)};return s},zj=(e,{json:n,lossy:t}={})=>{const r=[];return TG(!(n||t),!!n,new Map,r)(e),r},Ab=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?$j(zj(e,n)):structuredClone(e):(e,n)=>$j(zj(e,n));function AG(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function PG(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function DG(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||AG,r=e.options.footnoteBackLabel||PG,a=e.options.footnoteLabel||"Footnotes",s=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},f=[];let d=-1;for(;++d<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[d]);if(!u)continue;const h=e.all(u),g=String(u.identifier).toUpperCase(),b=Jh(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let I=typeof t=="string"?t:t(d,v);typeof I=="string"&&(I={type:"text",value:I}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(d,v),className:["data-footnote-backref"]},children:Array.isArray(I)?I:[I]})}const E=h[h.length-1];if(E&&E.type==="element"&&E.tagName==="p"){const I=E.children[E.children.length-1];I&&I.type==="text"?I.value+=" ":E.children.push({type:"text",value:" "}),E.children.push(...S)}else h.push(...S);const T={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(h,!0)};e.patch(u,T),f.push(T)}if(f.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:{...Ab(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(f,!0)},{type:"text",value:`
`}]}}const l0=function(e){if(e==null)return OG;if(typeof e=="function")return c0(e);if(typeof e=="object")return Array.isArray(e)?IG(e):MG(e);if(typeof e=="string")return RG(e);throw new Error("Expected function, string, or object as test")};function IG(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=l0(e[t]);return c0(r);function r(...a){let s=-1;for(;++s<n.length;)if(n[s].apply(this,a))return!0;return!1}}function MG(e){const n=e;return c0(t);function t(r){const a=r;let s;for(s in e)if(a[s]!==n[s])return!1;return!0}}function RG(e){return c0(n);function n(t){return t&&t.type===e}}function c0(e){return n;function n(t,r,a){return!!(LG(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function OG(){return!0}function LG(e){return e!==null&&typeof e=="object"&&"type"in e}const sT=[],FG=!0,K1=!1,$G="skip";function oT(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const s=l0(a),l=r?-1:1;f(e,void 0,[])();function f(d,u,h){const g=d&&typeof d=="object"?d:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(d.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=sT,S,k,E;if((!n||s(d,u,h[h.length-1]||void 0))&&(v=zG(t(d,h)),v[0]===K1))return v;if("children"in d&&d.children){const T=d;if(T.children&&v[0]!==$G)for(k=(r?T.children.length:-1)+l,E=h.concat(T);k>-1&&k<T.children.length;){const I=T.children[k];if(S=f(I,k,E)(),S[0]===K1)return S;k=typeof S[1]=="number"?S[1]:k+l}}return v}}}function zG(e){return Array.isArray(e)?e:typeof e=="number"?[FG,e]:e==null?sT:[e]}function uS(e,n,t,r){let a,s,l;typeof n=="function"?(s=void 0,l=n,a=t):(s=n,l=t,a=r),oT(e,s,f,a);function f(d,u){const h=u[u.length-1],g=h?h.children.indexOf(d):void 0;return l(d,g,h)}}const X1={}.hasOwnProperty,BG={};function UG(e,n){const t=n||BG,r=new Map,a=new Map,s=new Map,l={...jG,...t.handlers},f={all:u,applyData:VG,definitionById:r,footnoteById:a,footnoteCounts:s,footnoteOrder:[],handlers:l,one:d,options:t,patch:qG,wrap:GG};return uS(e,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const g=h.type==="definition"?r:a,b=String(h.identifier).toUpperCase();g.has(b)||g.set(b,h)}}),f;function d(h,g){const b=h.type,v=f.handlers[b];if(X1.call(f.handlers,b)&&v)return v(f,h,g);if(f.options.passThrough&&f.options.passThrough.includes(b)){if("children"in h){const{children:k,...E}=h,T=Ab(E);return T.children=f.all(h),T}return Ab(h)}return(f.options.unknownHandler||HG)(f,h,g)}function u(h){const g=[];if("children"in h){const b=h.children;let v=-1;for(;++v<b.length;){const S=f.one(b[v],h);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=Bj(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=Bj(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function qG(e,n){e.position&&(n.position=Pq(e))}function VG(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,s=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const l="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:l}}t.type==="element"&&s&&Object.assign(t.properties,Ab(s)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function HG(e,n){const t=n.data||{},r="value"in n&&!(X1.call(t,"hProperties")||X1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function GG(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function Bj(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function Uj(e,n){const t=UG(e,n),r=t.one(e,void 0),a=DG(t),s=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&s.children.push({type:"text",value:`
`},a),s}function YG(e,n){return e&&"run"in e?async function(t,r){const a=Uj(t,{file:r,...n});await e.run(a,r)}:function(t,r){return Uj(t,{file:r,...e||n})}}function qj(e){if(e)throw e}var Fv,Vj;function WG(){if(Vj)return Fv;Vj=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(u){return typeof Array.isArray=="function"?Array.isArray(u):n.call(u)==="[object Array]"},s=function(u){if(!u||n.call(u)!=="[object Object]")return!1;var h=e.call(u,"constructor"),g=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!h&&!g)return!1;var b;for(b in u);return typeof b>"u"||e.call(u,b)},l=function(u,h){t&&h.name==="__proto__"?t(u,h.name,{enumerable:!0,configurable:!0,value:h.newValue,writable:!0}):u[h.name]=h.newValue},f=function(u,h){if(h==="__proto__")if(e.call(u,h)){if(r)return r(u,h).value}else return;return u[h]};return Fv=function d(){var u,h,g,b,v,S,k=arguments[0],E=1,T=arguments.length,I=!1;for(typeof k=="boolean"&&(I=k,k=arguments[1]||{},E=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});E<T;++E)if(u=arguments[E],u!=null)for(h in u)g=f(k,h),b=f(u,h),k!==b&&(I&&b&&(s(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&s(g)?g:{},l(k,{name:h,newValue:d(I,S,b)})):typeof b<"u"&&l(k,{name:h,newValue:b}));return k},Fv}var QG=WG();const $v=Bd(QG);function Z1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function JG(){const e=[],n={run:t,use:r};return n;function t(...a){let s=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);f(null,...a);function f(d,...u){const h=e[++s];let g=-1;if(d){l(d);return}for(;++g<a.length;)(u[g]===null||u[g]===void 0)&&(u[g]=a[g]);a=u,h?KG(h,f)(...u):l(null,...u)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function KG(e,n){let t;return r;function r(...l){const f=e.length>l.length;let d;f&&l.push(a);try{d=e.apply(this,l)}catch(u){const h=u;if(f&&t)throw h;return a(h)}f||(d&&d.then&&typeof d.then=="function"?d.then(s,a):d instanceof Error?a(d):s(d))}function a(l,...f){t||(t=!0,n(l,...f))}function s(l){a(null,l)}}const Io={basename:XG,dirname:ZG,extname:eY,join:tY,sep:"/"};function XG(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');Cg(e);let t=0,r=-1,a=e.length,s;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(s){t=a+1;break}}else r<0&&(s=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let l=-1,f=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(s){t=a+1;break}}else l<0&&(s=!0,l=a+1),f>-1&&(e.codePointAt(a)===n.codePointAt(f--)?f<0&&(r=a):(f=-1,r=l));return t===r?r=l:r<0&&(r=e.length),e.slice(t,r)}function ZG(e){if(Cg(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function eY(e){Cg(e);let n=e.length,t=-1,r=0,a=-1,s=0,l;for(;n--;){const f=e.codePointAt(n);if(f===47){if(l){r=n+1;break}continue}t<0&&(l=!0,t=n+1),f===46?a<0?a=n:s!==1&&(s=1):a>-1&&(s=-1)}return a<0||t<0||s===0||s===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function tY(...e){let n=-1,t;for(;++n<e.length;)Cg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":nY(t)}function nY(e){Cg(e);const n=e.codePointAt(0)===47;let t=rY(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function rY(e,n){let t="",r=0,a=-1,s=0,l=-1,f,d;for(;++l<=e.length;){if(l<e.length)f=e.codePointAt(l);else{if(f===47)break;f=47}if(f===47){if(!(a===l-1||s===1))if(a!==l-1&&s===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(d=t.lastIndexOf("/"),d!==t.length-1){d<0?(t="",r=0):(t=t.slice(0,d),r=t.length-1-t.lastIndexOf("/")),a=l,s=0;continue}}else if(t.length>0){t="",r=0,a=l,s=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,l):t=e.slice(a+1,l),r=l-a-1;a=l,s=0}else f===46&&s>-1?s++:s=-1}return t}function Cg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const iY={cwd:aY};function aY(){return"/"}function ew(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function sY(e){if(typeof e=="string")e=new URL(e);else if(!ew(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return oY(e)}function oY(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const zv=["history","path","basename","stem","extname","dirname"];let lT=class{constructor(n){let t;n?ew(n)?t={path:n}:typeof n=="string"||lY(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":iY.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<zv.length;){const s=zv[r];s in t&&t[s]!==void 0&&t[s]!==null&&(this[s]=s==="history"?[...t[s]]:t[s])}let a;for(a in t)zv.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?Io.basename(this.path):void 0}set basename(n){Uv(n,"basename"),Bv(n,"basename"),this.path=Io.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?Io.dirname(this.path):void 0}set dirname(n){Hj(this.basename,"dirname"),this.path=Io.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?Io.extname(this.path):void 0}set extname(n){if(Bv(n,"extname"),Hj(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Io.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){ew(n)&&(n=sY(n)),Uv(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?Io.basename(this.path,this.extname):void 0}set stem(n){Uv(n,"stem"),Bv(n,"stem"),this.path=Io.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new Ei(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}};function Bv(e,n){if(e&&e.includes(Io.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+Io.sep+"`")}function Uv(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function Hj(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function lY(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const cY=function(e){const r=this.constructor.prototype,a=r[e],s=function(){return a.apply(s,arguments)};return Object.setPrototypeOf(s,r),s},uY={}.hasOwnProperty;let dY=class cT extends cY{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=JG()}copy(){const n=new cT;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data($v(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(Hv("data",this.frozen),this.namespace[n]=t,this):uY.call(this.namespace,n)&&this.namespace[n]||void 0:n?(Hv("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=Ox(n),r=this.parser||this.Parser;return qv("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),qv("process",this.parser||this.Parser),Vv("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(s,l){const f=Ox(n),d=r.parse(f);r.run(d,f,function(h,g,b){if(h||!g||!b)return u(h);const v=g,S=r.stringify(v,b);pY(S)?b.value=S:b.result=S,u(h,b)});function u(h,g){h||!g?l(h):s?s(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),qv("processSync",this.parser||this.Parser),Vv("processSync",this.compiler||this.Compiler),this.process(n,a),Yj("processSync","process",t),r;function a(s,l){t=!0,qj(s),r=l}}run(n,t,r){Gj(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?s(void 0,r):new Promise(s);function s(l,f){const d=Ox(t);a.run(n,d,u);function u(h,g,b){const v=g||n;h?f(h):l?l(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,s),Yj("runSync","run",r),a;function s(l,f){qj(l),a=f,r=!0}}stringify(n,t){this.freeze();const r=Ox(t),a=this.compiler||this.Compiler;return Vv("stringify",a),Gj(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(Hv("use",this.frozen),n!=null)if(typeof n=="function")d(n,t);else if(typeof n=="object")Array.isArray(n)?f(n):l(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function s(u){if(typeof u=="function")d(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[h,...g]=u;d(h,g)}else l(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function l(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");f(u.plugins),u.settings&&(a.settings=$v(!0,a.settings,u.settings))}function f(u){let h=-1;if(u!=null)if(Array.isArray(u))for(;++h<u.length;){const g=u[h];s(g)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function d(u,h){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===u){b=g;break}if(b===-1)r.push([u,...h]);else if(h.length>0){let[v,...S]=h;const k=r[b][1];Z1(k)&&Z1(v)&&(v=$v(!0,k,v)),r[b]=[u,v,...S]}}}};const fY=new dY().freeze();function qv(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function Vv(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function Hv(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function Gj(e){if(!Z1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function Yj(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function Ox(e){return hY(e)?e:new lT(e)}function hY(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function pY(e){return typeof e=="string"||mY(e)}function mY(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const gY="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",Wj=[],Qj={allowDangerousHtml:!0},yY=/^(https?|ircs?|mailto|xmpp)$/i,xY=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Dl(e){const n=bY(e),t=vY(e);return wY(n.runSync(n.parse(t),t),e)}function bY(e){const n=e.rehypePlugins||Wj,t=e.remarkPlugins||Wj,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...Qj}:Qj;return fY().use(ZH).use(t).use(YG,r).use(n)}function vY(e){const n=e.children||"",t=new lT;return typeof n=="string"&&(t.value=n),t}function wY(e,n){const t=n.allowedElements,r=n.allowElement,a=n.components,s=n.disallowedElements,l=n.skipHtml,f=n.unwrapDisallowed,d=n.urlTransform||SY;for(const h of xY)Object.hasOwn(n,h.from)&&(""+h.from+(h.to?"use `"+h.to+"` instead":"remove it")+gY+h.id,void 0);return uS(e,u),Oq(e,{Fragment:i.Fragment,components:a,ignoreInvalidStyle:!0,jsx:i.jsx,jsxs:i.jsxs,passKeys:!0,passNode:!0});function u(h,g,b){if(h.type==="raw"&&b&&typeof g=="number")return l?b.children.splice(g,1):b.children[g]={type:"text",value:h.value},g;if(h.type==="element"){let v;for(v in Rv)if(Object.hasOwn(Rv,v)&&Object.hasOwn(h.properties,v)){const S=h.properties[v],k=Rv[v];(k===null||k.includes(h.tagName))&&(h.properties[v]=d(String(S||""),v,h))}}if(h.type==="element"){let v=t?!t.includes(h.tagName):s?s.includes(h.tagName):!1;if(!v&&r&&typeof g=="number"&&(v=!r(h,g,b)),v&&b&&typeof g=="number")return f&&h.children?b.children.splice(g,1,...h.children):b.children.splice(g,1),g}}}function SY(e){const n=e.indexOf(":"),t=e.indexOf("?"),r=e.indexOf("#"),a=e.indexOf("/");return n===-1||a!==-1&&n>a||t!==-1&&n>t||r!==-1&&n>r||yY.test(e.slice(0,n))?e:""}function Jj(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function NY(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function CY(e,n,t){const a=l0((t||{}).ignore||[]),s=jY(n);let l=-1;for(;++l<s.length;)oT(e,"text",f);function f(u,h){let g=-1,b;for(;++g<h.length;){const v=h[g],S=b?b.children:void 0;if(a(v,S?S.indexOf(v):void 0,b))return;b=v}if(b)return d(u,h)}function d(u,h){const g=h[h.length-1],b=s[l][0],v=s[l][1];let S=0;const E=g.children.indexOf(u);let T=!1,I=[];b.lastIndex=0;let D=b.exec(u.value);for(;D;){const q=D.index,R={index:D.index,input:D.input,stack:[...h,u]};let F=v(...D,R);if(typeof F=="string"&&(F=F.length>0?{type:"text",value:F}:void 0),F===!1?b.lastIndex=q+1:(S!==q&&I.push({type:"text",value:u.value.slice(S,q)}),Array.isArray(F)?I.push(...F):F&&I.push(F),S=q+D[0].length,T=!0),!b.global)break;D=b.exec(u.value)}return T?(S<u.value.length&&I.push({type:"text",value:u.value.slice(S)}),g.children.splice(E,1,...I)):I=[u],E+I.length}}function jY(e){const n=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const t=!e[0]||Array.isArray(e[0])?e:[e];let r=-1;for(;++r<t.length;){const a=t[r];n.push([_Y(a[0]),kY(a[1])])}return n}function _Y(e){return typeof e=="string"?new RegExp(NY(e),"g"):e}function kY(e){return typeof e=="function"?e:function(){return e}}const Gv="phrasing",Yv=["autolink","link","image","label"];function EY(){return{transforms:[RY],enter:{literalAutolink:AY,literalAutolinkEmail:Wv,literalAutolinkHttp:Wv,literalAutolinkWww:Wv},exit:{literalAutolink:MY,literalAutolinkEmail:IY,literalAutolinkHttp:PY,literalAutolinkWww:DY}}}function TY(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:Gv,notInConstruct:Yv},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:Gv,notInConstruct:Yv},{character:":",before:"[ps]",after:"\\/",inConstruct:Gv,notInConstruct:Yv}]}}function AY(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function Wv(e){this.config.enter.autolinkProtocol.call(this,e)}function PY(e){this.config.exit.autolinkProtocol.call(this,e)}function DY(e){this.config.exit.data.call(this,e);const n=this.stack[this.stack.length-1];n.type,n.url="http://"+this.sliceSerialize(e)}function IY(e){this.config.exit.autolinkEmail.call(this,e)}function MY(e){this.exit(e)}function RY(e){CY(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,OY],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),LY]],{ignore:["link","linkReference"]})}function OY(e,n,t,r,a){let s="";if(!uT(a)||(/^w/i.test(n)&&(t=n+t,n="",s="http://"),!FY(t)))return!1;const l=$Y(t+r);if(!l[0])return!1;const f={type:"link",title:null,url:s+n+l[0],children:[{type:"text",value:n+l[0]}]};return l[1]?[f,{type:"text",value:l[1]}]:f}function LY(e,n,t,r){return!uT(r,!0)||/[-\d_]$/.test(t)?!1:{type:"link",title:null,url:"mailto:"+n+"@"+t,children:[{type:"text",value:n+"@"+t}]}}function FY(e){const n=e.split(".");return!(n.length<2||n[n.length-1]&&(/_/.test(n[n.length-1])||!/[a-zA-Z\d]/.test(n[n.length-1]))||n[n.length-2]&&(/_/.test(n[n.length-2])||!/[a-zA-Z\d]/.test(n[n.length-2])))}function $Y(e){const n=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!n)return[e,void 0];e=e.slice(0,n.index);let t=n[0],r=t.indexOf(")");const a=Jj(e,"(");let s=Jj(e,")");for(;r!==-1&&a>s;)e+=t.slice(0,r+1),t=t.slice(r+1),r=t.indexOf(")"),s++;return[e,t]}function uT(e,n){const t=e.input.charCodeAt(e.index-1);return(e.index===0||$d(t)||a0(t))&&(!n||t!==47)}dT.peek=WY;function zY(){this.buffer()}function BY(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function UY(){this.buffer()}function qY(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function VY(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=Bs(this.sliceSerialize(e)).toLowerCase(),t.label=n}function HY(e){this.exit(e)}function GY(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=Bs(this.sliceSerialize(e)).toLowerCase(),t.label=n}function YY(e){this.exit(e)}function WY(){return"["}function dT(e,n,t,r){const a=t.createTracker(r);let s=a.move("[^");const l=t.enter("footnoteReference"),f=t.enter("reference");return s+=a.move(t.safe(t.associationId(e),{after:"]",before:s})),f(),l(),s+=a.move("]"),s}function QY(){return{enter:{gfmFootnoteCallString:zY,gfmFootnoteCall:BY,gfmFootnoteDefinitionLabelString:UY,gfmFootnoteDefinition:qY},exit:{gfmFootnoteCallString:VY,gfmFootnoteCall:HY,gfmFootnoteDefinitionLabelString:GY,gfmFootnoteDefinition:YY}}}function JY(e){let n=!1;return e&&e.firstLineBlank&&(n=!0),{handlers:{footnoteDefinition:t,footnoteReference:dT},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function t(r,a,s,l){const f=s.createTracker(l);let d=f.move("[^");const u=s.enter("footnoteDefinition"),h=s.enter("label");return d+=f.move(s.safe(s.associationId(r),{before:d,after:"]"})),h(),d+=f.move("]:"),r.children&&r.children.length>0&&(f.shift(4),d+=f.move((n?`
`:" ")+s.indentLines(s.containerFlow(r,f.current()),n?fT:KY))),u(),d}}function KY(e,n,t){return n===0?e:fT(e,n,t)}function fT(e,n,t){return(t?"":"    ")+e}const XY=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];hT.peek=rW;function ZY(){return{canContainEols:["delete"],enter:{strikethrough:tW},exit:{strikethrough:nW}}}function eW(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:XY}],handlers:{delete:hT}}}function tW(e){this.enter({type:"delete",children:[]},e)}function nW(e){this.exit(e)}function hT(e,n,t,r){const a=t.createTracker(r),s=t.enter("strikethrough");let l=a.move("~~");return l+=t.containerPhrasing(e,{...a.current(),before:l,after:"~"}),l+=a.move("~~"),s(),l}function rW(){return"~"}function iW(e){return e.length}function aW(e,n){const t=n||{},r=(t.align||[]).concat(),a=t.stringLength||iW,s=[],l=[],f=[],d=[];let u=0,h=-1;for(;++h<e.length;){const k=[],E=[];let T=-1;for(e[h].length>u&&(u=e[h].length);++T<e[h].length;){const I=sW(e[h][T]);if(t.alignDelimiters!==!1){const D=a(I);E[T]=D,(d[T]===void 0||D>d[T])&&(d[T]=D)}k.push(I)}l[h]=k,f[h]=E}let g=-1;if(typeof r=="object"&&"length"in r)for(;++g<u;)s[g]=Kj(r[g]);else{const k=Kj(r);for(;++g<u;)s[g]=k}g=-1;const b=[],v=[];for(;++g<u;){const k=s[g];let E="",T="";k===99?(E=":",T=":"):k===108?E=":":k===114&&(T=":");let I=t.alignDelimiters===!1?1:Math.max(1,d[g]-E.length-T.length);const D=E+"-".repeat(I)+T;t.alignDelimiters!==!1&&(I=E.length+I+T.length,I>d[g]&&(d[g]=I),v[g]=I),b[g]=D}l.splice(1,0,b),f.splice(1,0,v),h=-1;const S=[];for(;++h<l.length;){const k=l[h],E=f[h];g=-1;const T=[];for(;++g<u;){const I=k[g]||"";let D="",q="";if(t.alignDelimiters!==!1){const R=d[g]-(E[g]||0),F=s[g];F===114?D=" ".repeat(R):F===99?R%2?(D=" ".repeat(R/2+.5),q=" ".repeat(R/2-.5)):(D=" ".repeat(R/2),q=D):q=" ".repeat(R)}t.delimiterStart!==!1&&!g&&T.push("|"),t.padding!==!1&&!(t.alignDelimiters===!1&&I==="")&&(t.delimiterStart!==!1||g)&&T.push(" "),t.alignDelimiters!==!1&&T.push(D),T.push(I),t.alignDelimiters!==!1&&T.push(q),t.padding!==!1&&T.push(" "),(t.delimiterEnd!==!1||g!==u-1)&&T.push("|")}S.push(t.delimiterEnd===!1?T.join("").replace(/ +$/,""):T.join(""))}return S.join(`
`)}function sW(e){return e==null?"":String(e)}function Kj(e){const n=typeof e=="string"?e.codePointAt(0):0;return n===67||n===99?99:n===76||n===108?108:n===82||n===114?114:0}function oW(e,n,t,r){const a=t.enter("blockquote"),s=t.createTracker(r);s.move("> "),s.shift(2);const l=t.indentLines(t.containerFlow(e,s.current()),lW);return a(),l}function lW(e,n,t){return">"+(t?"":" ")+e}function cW(e,n){return Xj(e,n.inConstruct,!0)&&!Xj(e,n.notInConstruct,!1)}function Xj(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function Zj(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&cW(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function uW(e,n){const t=String(e);let r=t.indexOf(n),a=r,s=0,l=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++s>l&&(l=s):s=1,a=r+n.length,r=t.indexOf(n,a);return l}function dW(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function fW(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function hW(e,n,t,r){const a=fW(t),s=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if(dW(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(s,pW);return g(),b}const f=t.createTracker(r),d=a.repeat(Math.max(uW(s,a)+1,3)),u=t.enter("codeFenced");let h=f.move(d);if(e.lang){const g=t.enter(`codeFencedLang${l}`);h+=f.move(t.safe(e.lang,{before:h,after:" ",encode:["`"],...f.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${l}`);h+=f.move(" "),h+=f.move(t.safe(e.meta,{before:h,after:`
`,encode:["`"],...f.current()})),g()}return h+=f.move(`
`),s&&(h+=f.move(s+`
`)),h+=f.move(d),u(),h}function pW(e,n,t){return(t?"":"    ")+e}function dS(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function mW(e,n,t,r){const a=dS(t),s=a==='"'?"Quote":"Apostrophe",l=t.enter("definition");let f=t.enter("label");const d=t.createTracker(r);let u=d.move("[");return u+=d.move(t.safe(t.associationId(e),{before:u,after:"]",...d.current()})),u+=d.move("]: "),f(),!e.url||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),u+=d.move("<"),u+=d.move(t.safe(e.url,{before:u,after:">",...d.current()})),u+=d.move(">")):(f=t.enter("destinationRaw"),u+=d.move(t.safe(e.url,{before:u,after:e.title?" ":`
`,...d.current()}))),f(),e.title&&(f=t.enter(`title${s}`),u+=d.move(" "+a),u+=d.move(t.safe(e.title,{before:u,after:a,...d.current()})),u+=d.move(a),f()),l(),u}function gW(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function fg(e){return"&#x"+e.toString(16).toUpperCase()+";"}function Pb(e,n,t){const r=zh(e),a=zh(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}pT.peek=yW;function pT(e,n,t,r){const a=gW(t),s=t.enter("emphasis"),l=t.createTracker(r),f=l.move(a);let d=l.move(t.containerPhrasing(e,{after:a,before:f,...l.current()}));const u=d.charCodeAt(0),h=Pb(r.before.charCodeAt(r.before.length-1),u,a);h.inside&&(d=fg(u)+d.slice(1));const g=d.charCodeAt(d.length-1),b=Pb(r.after.charCodeAt(0),g,a);b.inside&&(d=d.slice(0,-1)+fg(g));const v=l.move(a);return s(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},f+d+v}function yW(e,n,t){return t.options.emphasis||"*"}function xW(e,n){let t=!1;return uS(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,K1}),!!((!e.depth||e.depth<3)&&rS(e)&&(n.options.setext||t))}function bW(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),s=t.createTracker(r);if(xW(e,t)){const h=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...s.current(),before:`
`,after:`
`});return g(),h(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const l="#".repeat(a),f=t.enter("headingAtx"),d=t.enter("phrasing");s.move(l+" ");let u=t.containerPhrasing(e,{before:"# ",after:`
`,...s.current()});return/^[\t ]/.test(u)&&(u=fg(u.charCodeAt(0))+u.slice(1)),u=u?l+" "+u:l,t.options.closeAtx&&(u+=" "+l),d(),f(),u}mT.peek=vW;function mT(e){return e.value||""}function vW(){return"<"}gT.peek=wW;function gT(e,n,t,r){const a=dS(t),s=a==='"'?"Quote":"Apostrophe",l=t.enter("image");let f=t.enter("label");const d=t.createTracker(r);let u=d.move("![");return u+=d.move(t.safe(e.alt,{before:u,after:"]",...d.current()})),u+=d.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),u+=d.move("<"),u+=d.move(t.safe(e.url,{before:u,after:">",...d.current()})),u+=d.move(">")):(f=t.enter("destinationRaw"),u+=d.move(t.safe(e.url,{before:u,after:e.title?" ":")",...d.current()}))),f(),e.title&&(f=t.enter(`title${s}`),u+=d.move(" "+a),u+=d.move(t.safe(e.title,{before:u,after:a,...d.current()})),u+=d.move(a),f()),u+=d.move(")"),l(),u}function wW(){return"!"}yT.peek=SW;function yT(e,n,t,r){const a=e.referenceType,s=t.enter("imageReference");let l=t.enter("label");const f=t.createTracker(r);let d=f.move("![");const u=t.safe(e.alt,{before:d,after:"]",...f.current()});d+=f.move(u+"]["),l();const h=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:d,after:"]",...f.current()});return l(),t.stack=h,s(),a==="full"||!u||u!==g?d+=f.move(g+"]"):a==="shortcut"?d=d.slice(0,-1):d+=f.move("]"),d}function SW(){return"!"}xT.peek=NW;function xT(e,n,t){let r=e.value||"",a="`",s=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++s<t.unsafe.length;){const l=t.unsafe[s],f=t.compilePattern(l);let d;if(l.atBreak)for(;d=f.exec(r);){let u=d.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(d.index+1)}}return a+r+a}function NW(){return"`"}function bT(e,n){const t=rS(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}vT.peek=CW;function vT(e,n,t,r){const a=dS(t),s=a==='"'?"Quote":"Apostrophe",l=t.createTracker(r);let f,d;if(bT(e,t)){const h=t.stack;t.stack=[],f=t.enter("autolink");let g=l.move("<");return g+=l.move(t.containerPhrasing(e,{before:g,after:">",...l.current()})),g+=l.move(">"),f(),t.stack=h,g}f=t.enter("link"),d=t.enter("label");let u=l.move("[");return u+=l.move(t.containerPhrasing(e,{before:u,after:"](",...l.current()})),u+=l.move("]("),d(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(t.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(d=t.enter("destinationRaw"),u+=l.move(t.safe(e.url,{before:u,after:e.title?" ":")",...l.current()}))),d(),e.title&&(d=t.enter(`title${s}`),u+=l.move(" "+a),u+=l.move(t.safe(e.title,{before:u,after:a,...l.current()})),u+=l.move(a),d()),u+=l.move(")"),f(),u}function CW(e,n,t){return bT(e,t)?"<":"["}wT.peek=jW;function wT(e,n,t,r){const a=e.referenceType,s=t.enter("linkReference");let l=t.enter("label");const f=t.createTracker(r);let d=f.move("[");const u=t.containerPhrasing(e,{before:d,after:"]",...f.current()});d+=f.move(u+"]["),l();const h=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:d,after:"]",...f.current()});return l(),t.stack=h,s(),a==="full"||!u||u!==g?d+=f.move(g+"]"):a==="shortcut"?d=d.slice(0,-1):d+=f.move("]"),d}function jW(){return"["}function fS(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function _W(e){const n=fS(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function kW(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function ST(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function EW(e,n,t,r){const a=t.enter("list"),s=t.bulletCurrent;let l=e.ordered?kW(t):fS(t);const f=e.ordered?l==="."?")":".":_W(t);let d=n&&t.bulletLastUsed?l===t.bulletLastUsed:!1;if(!e.ordered){const h=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&h&&(!h.children||!h.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(d=!0),ST(t)===l&&h){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){d=!0;break}}}}d&&(l=f),t.bulletCurrent=l;const u=t.containerFlow(e,r);return t.bulletLastUsed=l,t.bulletCurrent=s,a(),u}function TW(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function AW(e,n,t,r){const a=TW(t);let s=t.bulletCurrent||fS(t);n&&n.type==="list"&&n.ordered&&(s=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+s);let l=s.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(l=Math.ceil(l/4)*4);const f=t.createTracker(r);f.move(s+" ".repeat(l-s.length)),f.shift(l);const d=t.enter("listItem"),u=t.indentLines(t.containerFlow(e,f.current()),h);return d(),u;function h(g,b,v){return b?(v?"":" ".repeat(l))+g:(v?s:s+" ".repeat(l-s.length))+g}}function PW(e,n,t,r){const a=t.enter("paragraph"),s=t.enter("phrasing"),l=t.containerPhrasing(e,r);return s(),a(),l}const DW=l0(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function IW(e,n,t,r){return(e.children.some(function(l){return DW(l)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function MW(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}NT.peek=RW;function NT(e,n,t,r){const a=MW(t),s=t.enter("strong"),l=t.createTracker(r),f=l.move(a+a);let d=l.move(t.containerPhrasing(e,{after:a,before:f,...l.current()}));const u=d.charCodeAt(0),h=Pb(r.before.charCodeAt(r.before.length-1),u,a);h.inside&&(d=fg(u)+d.slice(1));const g=d.charCodeAt(d.length-1),b=Pb(r.after.charCodeAt(0),g,a);b.inside&&(d=d.slice(0,-1)+fg(g));const v=l.move(a+a);return s(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},f+d+v}function RW(e,n,t){return t.options.strong||"*"}function OW(e,n,t,r){return t.safe(e.value,r)}function LW(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function FW(e,n,t){const r=(ST(t)+(t.options.ruleSpaces?" ":"")).repeat(LW(t));return t.options.ruleSpaces?r.slice(0,-1):r}const CT={blockquote:oW,break:Zj,code:hW,definition:mW,emphasis:pT,hardBreak:Zj,heading:bW,html:mT,image:gT,imageReference:yT,inlineCode:xT,link:vT,linkReference:wT,list:EW,listItem:AW,paragraph:PW,root:IW,strong:NT,text:OW,thematicBreak:FW};function $W(){return{enter:{table:zW,tableData:e_,tableHeader:e_,tableRow:UW},exit:{codeText:qW,table:BW,tableData:Qv,tableHeader:Qv,tableRow:Qv}}}function zW(e){const n=e._align;this.enter({type:"table",align:n.map(function(t){return t==="none"?null:t}),children:[]},e),this.data.inTable=!0}function BW(e){this.exit(e),this.data.inTable=void 0}function UW(e){this.enter({type:"tableRow",children:[]},e)}function Qv(e){this.exit(e)}function e_(e){this.enter({type:"tableCell",children:[]},e)}function qW(e){let n=this.resume();this.data.inTable&&(n=n.replace(/\\([\\|])/g,VW));const t=this.stack[this.stack.length-1];t.type,t.value=n,this.exit(e)}function VW(e,n){return n==="|"?n:e}function HW(e){const n=e||{},t=n.tableCellPadding,r=n.tablePipeAlign,a=n.stringLength,s=t?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:b,table:l,tableCell:d,tableRow:f}};function l(v,S,k,E){return u(h(v,k,E),v.align)}function f(v,S,k,E){const T=g(v,k,E),I=u([T]);return I.slice(0,I.indexOf(`
`))}function d(v,S,k,E){const T=k.enter("tableCell"),I=k.enter("phrasing"),D=k.containerPhrasing(v,{...E,before:s,after:s});return I(),T(),D}function u(v,S){return aW(v,{align:S,alignDelimiters:r,padding:t,stringLength:a})}function h(v,S,k){const E=v.children;let T=-1;const I=[],D=S.enter("table");for(;++T<E.length;)I[T]=g(E[T],S,k);return D(),I}function g(v,S,k){const E=v.children;let T=-1;const I=[],D=S.enter("tableRow");for(;++T<E.length;)I[T]=d(E[T],v,S,k);return D(),I}function b(v,S,k){let E=CT.inlineCode(v,S,k);return k.stack.includes("tableCell")&&(E=E.replace(/\|/g,"\\$&")),E}}function GW(){return{exit:{taskListCheckValueChecked:t_,taskListCheckValueUnchecked:t_,paragraph:WW}}}function YW(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:QW}}}function t_(e){const n=this.stack[this.stack.length-2];n.type,n.checked=e.type==="taskListCheckValueChecked"}function WW(e){const n=this.stack[this.stack.length-2];if(n&&n.type==="listItem"&&typeof n.checked=="boolean"){const t=this.stack[this.stack.length-1];t.type;const r=t.children[0];if(r&&r.type==="text"){const a=n.children;let s=-1,l;for(;++s<a.length;){const f=a[s];if(f.type==="paragraph"){l=f;break}}l===t&&(r.value=r.value.slice(1),r.value.length===0?t.children.shift():t.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,t.position.start=Object.assign({},r.position.start)))}}this.exit(e)}function QW(e,n,t,r){const a=e.children[0],s=typeof e.checked=="boolean"&&a&&a.type==="paragraph",l="["+(e.checked?"x":" ")+"] ",f=t.createTracker(r);s&&f.move(l);let d=CT.listItem(e,n,t,{...r,...f.current()});return s&&(d=d.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,u)),d;function u(h){return h+l}}function JW(){return[EY(),QY(),ZY(),$W(),GW()]}function KW(e){return{extensions:[TY(),JY(e),eW(),HW(e),YW()]}}const XW={tokenize:iQ,partial:!0},jT={tokenize:aQ,partial:!0},_T={tokenize:sQ,partial:!0},kT={tokenize:oQ,partial:!0},ZW={tokenize:lQ,partial:!0},ET={name:"wwwAutolink",tokenize:nQ,previous:AT},TT={name:"protocolAutolink",tokenize:rQ,previous:PT},zl={name:"emailAutolink",tokenize:tQ,previous:DT},Vo={};function eQ(){return{text:Vo}}let wd=48;for(;wd<123;)Vo[wd]=zl,wd++,wd===58?wd=65:wd===91&&(wd=97);Vo[43]=zl;Vo[45]=zl;Vo[46]=zl;Vo[95]=zl;Vo[72]=[zl,TT];Vo[104]=[zl,TT];Vo[87]=[zl,ET];Vo[119]=[zl,ET];function tQ(e,n,t){const r=this;let a,s;return l;function l(g){return!tw(g)||!DT.call(r,r.previous)||hS(r.events)?t(g):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),f(g))}function f(g){return tw(g)?(e.consume(g),f):g===64?(e.consume(g),d):t(g)}function d(g){return g===46?e.check(ZW,h,u)(g):g===45||g===95||ji(g)?(s=!0,e.consume(g),d):h(g)}function u(g){return e.consume(g),a=!0,d}function h(g){return s&&a&&$i(r.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),n(g)):t(g)}}function nQ(e,n,t){const r=this;return a;function a(l){return l!==87&&l!==119||!AT.call(r,r.previous)||hS(r.events)?t(l):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(XW,e.attempt(jT,e.attempt(_T,s),t),t)(l))}function s(l){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),n(l)}}function rQ(e,n,t){const r=this;let a="",s=!1;return l;function l(g){return(g===72||g===104)&&PT.call(r,r.previous)&&!hS(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),a+=String.fromCodePoint(g),e.consume(g),f):t(g)}function f(g){if($i(g)&&a.length<5)return a+=String.fromCodePoint(g),e.consume(g),f;if(g===58){const b=a.toLowerCase();if(b==="http"||b==="https")return e.consume(g),d}return t(g)}function d(g){return g===47?(e.consume(g),s?u:(s=!0,d)):t(g)}function u(g){return g===null||Eb(g)||Bn(g)||$d(g)||a0(g)?t(g):e.attempt(jT,e.attempt(_T,h),t)(g)}function h(g){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),n(g)}}function iQ(e,n,t){let r=0;return a;function a(l){return(l===87||l===119)&&r<3?(r++,e.consume(l),a):l===46&&r===3?(e.consume(l),s):t(l)}function s(l){return l===null?t(l):n(l)}}function aQ(e,n,t){let r,a,s;return l;function l(u){return u===46||u===95?e.check(kT,d,f)(u):u===null||Bn(u)||$d(u)||u!==45&&a0(u)?d(u):(s=!0,e.consume(u),l)}function f(u){return u===95?r=!0:(a=r,r=void 0),e.consume(u),l}function d(u){return a||r||!s?t(u):n(u)}}function sQ(e,n){let t=0,r=0;return a;function a(l){return l===40?(t++,e.consume(l),a):l===41&&r<t?s(l):l===33||l===34||l===38||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===60||l===63||l===93||l===95||l===126?e.check(kT,n,s)(l):l===null||Bn(l)||$d(l)?n(l):(e.consume(l),a)}function s(l){return l===41&&r++,e.consume(l),a}}function oQ(e,n,t){return r;function r(f){return f===33||f===34||f===39||f===41||f===42||f===44||f===46||f===58||f===59||f===63||f===95||f===126?(e.consume(f),r):f===38?(e.consume(f),s):f===93?(e.consume(f),a):f===60||f===null||Bn(f)||$d(f)?n(f):t(f)}function a(f){return f===null||f===40||f===91||Bn(f)||$d(f)?n(f):r(f)}function s(f){return $i(f)?l(f):t(f)}function l(f){return f===59?(e.consume(f),r):$i(f)?(e.consume(f),l):t(f)}}function lQ(e,n,t){return r;function r(s){return e.consume(s),a}function a(s){return ji(s)?t(s):n(s)}}function AT(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||Bn(e)}function PT(e){return!$i(e)}function DT(e){return!(e===47||tw(e))}function tw(e){return e===43||e===45||e===46||e===95||ji(e)}function hS(e){let n=e.length,t=!1;for(;n--;){const r=e[n][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){t=!0;break}if(r._gfmAutolinkLiteralWalkedInto){t=!1;break}}return e.length>0&&!t&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),t}const cQ={tokenize:yQ,partial:!0};function uQ(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:pQ,continuation:{tokenize:mQ},exit:gQ}},text:{91:{name:"gfmFootnoteCall",tokenize:hQ},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:dQ,resolveTo:fQ}}}}function dQ(e,n,t){const r=this;let a=r.events.length;const s=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let l;for(;a--;){const d=r.events[a][1];if(d.type==="labelImage"){l=d;break}if(d.type==="gfmFootnoteCall"||d.type==="labelLink"||d.type==="label"||d.type==="image"||d.type==="link")break}return f;function f(d){if(!l||!l._balanced)return t(d);const u=Bs(r.sliceSerialize({start:l.end,end:r.now()}));return u.codePointAt(0)!==94||!s.includes(u.slice(1))?t(d):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(d),e.exit("gfmFootnoteCallLabelMarker"),n(d))}}function fQ(e,n){let t=e.length;for(;t--;)if(e[t][1].type==="labelImage"&&e[t][0]==="enter"){e[t][1];break}e[t+1][1].type="data",e[t+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[t+3][1].start),end:Object.assign({},e[e.length-1][1].end)},a={type:"gfmFootnoteCallMarker",start:Object.assign({},e[t+3][1].end),end:Object.assign({},e[t+3][1].end)};a.end.column++,a.end.offset++,a.end._bufferIndex++;const s={type:"gfmFootnoteCallString",start:Object.assign({},a.end),end:Object.assign({},e[e.length-1][1].start)},l={type:"chunkString",contentType:"string",start:Object.assign({},s.start),end:Object.assign({},s.end)},f=[e[t+1],e[t+2],["enter",r,n],e[t+3],e[t+4],["enter",a,n],["exit",a,n],["enter",s,n],["enter",l,n],["exit",l,n],["exit",s,n],e[e.length-2],e[e.length-1],["exit",r,n]];return e.splice(t,e.length-t+1,...f),e}function hQ(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let s=0,l;return f;function f(g){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),d}function d(g){return g!==94?t(g):(e.enter("gfmFootnoteCallMarker"),e.consume(g),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",u)}function u(g){if(s>999||g===93&&!l||g===null||g===91||Bn(g))return t(g);if(g===93){e.exit("chunkString");const b=e.exit("gfmFootnoteCallString");return a.includes(Bs(r.sliceSerialize(b)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),n):t(g)}return Bn(g)||(l=!0),s++,e.consume(g),g===92?h:u}function h(g){return g===91||g===92||g===93?(e.consume(g),s++,u):u(g)}}function pQ(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let s,l=0,f;return d;function d(S){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),u}function u(S){return S===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",h):t(S)}function h(S){if(l>999||S===93&&!f||S===null||S===91||Bn(S))return t(S);if(S===93){e.exit("chunkString");const k=e.exit("gfmFootnoteDefinitionLabelString");return s=Bs(r.sliceSerialize(k)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),b}return Bn(S)||(f=!0),l++,e.consume(S),S===92?g:h}function g(S){return S===91||S===92||S===93?(e.consume(S),l++,h):h(S)}function b(S){return S===58?(e.enter("definitionMarker"),e.consume(S),e.exit("definitionMarker"),a.includes(s)||a.push(s),fn(e,v,"gfmFootnoteDefinitionWhitespace")):t(S)}function v(S){return n(S)}}function mQ(e,n,t){return e.check(Ng,n,e.attempt(cQ,n,t))}function gQ(e){e.exit("gfmFootnoteDefinition")}function yQ(e,n,t){const r=this;return fn(e,a,"gfmFootnoteDefinitionIndent",5);function a(s){const l=r.events[r.events.length-1];return l&&l[1].type==="gfmFootnoteDefinitionIndent"&&l[2].sliceSerialize(l[1],!0).length===4?n(s):t(s)}}function xQ(e){let t=(e||{}).singleTilde;const r={name:"strikethrough",tokenize:s,resolveAll:a};return t==null&&(t=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function a(l,f){let d=-1;for(;++d<l.length;)if(l[d][0]==="enter"&&l[d][1].type==="strikethroughSequenceTemporary"&&l[d][1]._close){let u=d;for(;u--;)if(l[u][0]==="exit"&&l[u][1].type==="strikethroughSequenceTemporary"&&l[u][1]._open&&l[d][1].end.offset-l[d][1].start.offset===l[u][1].end.offset-l[u][1].start.offset){l[d][1].type="strikethroughSequence",l[u][1].type="strikethroughSequence";const h={type:"strikethrough",start:Object.assign({},l[u][1].start),end:Object.assign({},l[d][1].end)},g={type:"strikethroughText",start:Object.assign({},l[u][1].end),end:Object.assign({},l[d][1].start)},b=[["enter",h,f],["enter",l[u][1],f],["exit",l[u][1],f],["enter",g,f]],v=f.parser.constructs.insideSpan.null;v&&Fa(b,b.length,0,s0(v,l.slice(u+1,d),f)),Fa(b,b.length,0,[["exit",g,f],["enter",l[d][1],f],["exit",l[d][1],f],["exit",h,f]]),Fa(l,u-1,d-u+3,b),d=u+b.length-2;break}}for(d=-1;++d<l.length;)l[d][1].type==="strikethroughSequenceTemporary"&&(l[d][1].type="data");return l}function s(l,f,d){const u=this.previous,h=this.events;let g=0;return b;function b(S){return u===126&&h[h.length-1][1].type!=="characterEscape"?d(S):(l.enter("strikethroughSequenceTemporary"),v(S))}function v(S){const k=zh(u);if(S===126)return g>1?d(S):(l.consume(S),g++,v);if(g<2&&!t)return d(S);const E=l.exit("strikethroughSequenceTemporary"),T=zh(S);return E._open=!T||T===2&&!!k,E._close=!k||k===2&&!!T,f(S)}}}class bQ{constructor(){this.map=[]}add(n,t,r){vQ(this,n,t,r)}consume(n){if(this.map.sort(function(s,l){return s[0]-l[0]}),this.map.length===0)return;let t=this.map.length;const r=[];for(;t>0;)t-=1,r.push(n.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),n.length=this.map[t][0];r.push(n.slice()),n.length=0;let a=r.pop();for(;a;){for(const s of a)n.push(s);a=r.pop()}this.map.length=0}}function vQ(e,n,t,r){let a=0;if(!(t===0&&r.length===0)){for(;a<e.map.length;){if(e.map[a][0]===n){e.map[a][1]+=t,e.map[a][2].push(...r);return}a+=1}e.map.push([n,t,r])}}function wQ(e,n){let t=!1;const r=[];for(;n<e.length;){const a=e[n];if(t){if(a[0]==="enter")a[1].type==="tableContent"&&r.push(e[n+1][1].type==="tableDelimiterMarker"?"left":"none");else if(a[1].type==="tableContent"){if(e[n-1][1].type==="tableDelimiterMarker"){const s=r.length-1;r[s]=r[s]==="left"?"center":"right"}}else if(a[1].type==="tableDelimiterRow")break}else a[0]==="enter"&&a[1].type==="tableDelimiterRow"&&(t=!0);n+=1}return r}function SQ(){return{flow:{null:{name:"table",tokenize:NQ,resolveAll:CQ}}}}function NQ(e,n,t){const r=this;let a=0,s=0,l;return f;function f(L){let $=r.events.length-1;for(;$>-1;){const te=r.events[$][1].type;if(te==="lineEnding"||te==="linePrefix")$--;else break}const H=$>-1?r.events[$][1].type:null,ee=H==="tableHead"||H==="tableRow"?F:d;return ee===F&&r.parser.lazy[r.now().line]?t(L):ee(L)}function d(L){return e.enter("tableHead"),e.enter("tableRow"),u(L)}function u(L){return L===124||(l=!0,s+=1),h(L)}function h(L){return L===null?t(L):Tt(L)?s>1?(s=0,r.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(L),e.exit("lineEnding"),v):t(L):sn(L)?fn(e,h,"whitespace")(L):(s+=1,l&&(l=!1,a+=1),L===124?(e.enter("tableCellDivider"),e.consume(L),e.exit("tableCellDivider"),l=!0,h):(e.enter("data"),g(L)))}function g(L){return L===null||L===124||Bn(L)?(e.exit("data"),h(L)):(e.consume(L),L===92?b:g)}function b(L){return L===92||L===124?(e.consume(L),g):g(L)}function v(L){return r.interrupt=!1,r.parser.lazy[r.now().line]?t(L):(e.enter("tableDelimiterRow"),l=!1,sn(L)?fn(e,S,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(L):S(L))}function S(L){return L===45||L===58?E(L):L===124?(l=!0,e.enter("tableCellDivider"),e.consume(L),e.exit("tableCellDivider"),k):R(L)}function k(L){return sn(L)?fn(e,E,"whitespace")(L):E(L)}function E(L){return L===58?(s+=1,l=!0,e.enter("tableDelimiterMarker"),e.consume(L),e.exit("tableDelimiterMarker"),T):L===45?(s+=1,T(L)):L===null||Tt(L)?q(L):R(L)}function T(L){return L===45?(e.enter("tableDelimiterFiller"),I(L)):R(L)}function I(L){return L===45?(e.consume(L),I):L===58?(l=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(L),e.exit("tableDelimiterMarker"),D):(e.exit("tableDelimiterFiller"),D(L))}function D(L){return sn(L)?fn(e,q,"whitespace")(L):q(L)}function q(L){return L===124?S(L):L===null||Tt(L)?!l||a!==s?R(L):(e.exit("tableDelimiterRow"),e.exit("tableHead"),n(L)):R(L)}function R(L){return t(L)}function F(L){return e.enter("tableRow"),U(L)}function U(L){return L===124?(e.enter("tableCellDivider"),e.consume(L),e.exit("tableCellDivider"),U):L===null||Tt(L)?(e.exit("tableRow"),n(L)):sn(L)?fn(e,U,"whitespace")(L):(e.enter("data"),z(L))}function z(L){return L===null||L===124||Bn(L)?(e.exit("data"),U(L)):(e.consume(L),L===92?V:z)}function V(L){return L===92||L===124?(e.consume(L),z):z(L)}}function CQ(e,n){let t=-1,r=!0,a=0,s=[0,0,0,0],l=[0,0,0,0],f=!1,d=0,u,h,g;const b=new bQ;for(;++t<e.length;){const v=e[t],S=v[1];v[0]==="enter"?S.type==="tableHead"?(f=!1,d!==0&&(n_(b,n,d,u,h),h=void 0,d=0),u={type:"table",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",u,n]])):S.type==="tableRow"||S.type==="tableDelimiterRow"?(r=!0,g=void 0,s=[0,0,0,0],l=[0,t+1,0,0],f&&(f=!1,h={type:"tableBody",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",h,n]])),a=S.type==="tableDelimiterRow"?2:h?3:1):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")?(r=!1,l[2]===0&&(s[1]!==0&&(l[0]=l[1],g=Lx(b,n,s,a,void 0,g),s=[0,0,0,0]),l[2]=t)):S.type==="tableCellDivider"&&(r?r=!1:(s[1]!==0&&(l[0]=l[1],g=Lx(b,n,s,a,void 0,g)),s=l,l=[s[1],t,0,0])):S.type==="tableHead"?(f=!0,d=t):S.type==="tableRow"||S.type==="tableDelimiterRow"?(d=t,s[1]!==0?(l[0]=l[1],g=Lx(b,n,s,a,t,g)):l[1]!==0&&(g=Lx(b,n,l,a,t,g)),a=0):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")&&(l[3]=t)}for(d!==0&&n_(b,n,d,u,h),b.consume(n.events),t=-1;++t<n.events.length;){const v=n.events[t];v[0]==="enter"&&v[1].type==="table"&&(v[1]._align=wQ(n.events,t))}return e}function Lx(e,n,t,r,a,s){const l=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",f="tableContent";t[0]!==0&&(s.end=Object.assign({},Eh(n.events,t[0])),e.add(t[0],0,[["exit",s,n]]));const d=Eh(n.events,t[1]);if(s={type:l,start:Object.assign({},d),end:Object.assign({},d)},e.add(t[1],0,[["enter",s,n]]),t[2]!==0){const u=Eh(n.events,t[2]),h=Eh(n.events,t[3]),g={type:f,start:Object.assign({},u),end:Object.assign({},h)};if(e.add(t[2],0,[["enter",g,n]]),r!==2){const b=n.events[t[2]],v=n.events[t[3]];if(b[1].end=Object.assign({},v[1].end),b[1].type="chunkText",b[1].contentType="text",t[3]>t[2]+1){const S=t[2]+1,k=t[3]-t[2]-1;e.add(S,k,[])}}e.add(t[3]+1,0,[["exit",g,n]])}return a!==void 0&&(s.end=Object.assign({},Eh(n.events,a)),e.add(a,0,[["exit",s,n]]),s=void 0),s}function n_(e,n,t,r,a){const s=[],l=Eh(n.events,t);a&&(a.end=Object.assign({},l),s.push(["exit",a,n])),r.end=Object.assign({},l),s.push(["exit",r,n]),e.add(t+1,0,s)}function Eh(e,n){const t=e[n],r=t[0]==="enter"?"start":"end";return t[1][r]}const jQ={name:"tasklistCheck",tokenize:kQ};function _Q(){return{text:{91:jQ}}}function kQ(e,n,t){const r=this;return a;function a(d){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?t(d):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(d),e.exit("taskListCheckMarker"),s)}function s(d){return Bn(d)?(e.enter("taskListCheckValueUnchecked"),e.consume(d),e.exit("taskListCheckValueUnchecked"),l):d===88||d===120?(e.enter("taskListCheckValueChecked"),e.consume(d),e.exit("taskListCheckValueChecked"),l):t(d)}function l(d){return d===93?(e.enter("taskListCheckMarker"),e.consume(d),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),f):t(d)}function f(d){return Tt(d)?n(d):sn(d)?e.check({tokenize:EQ},n,t)(d):t(d)}}function EQ(e,n,t){return fn(e,r,"whitespace");function r(a){return a===null?t(a):n(a)}}function TQ(e){return UE([eQ(),uQ(),xQ(e),SQ(),_Q()])}const AQ={};function Lo(e){const n=this,t=e||AQ,r=n.data(),a=r.micromarkExtensions||(r.micromarkExtensions=[]),s=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),l=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);a.push(TQ(t)),s.push(JW()),l.push(KW(t))}const PQ=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},DQ=e=>{switch(e){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:e,className:"status-badge"}}},Jv=({title:e,items:n,renderItemContent:t,headerAction:r,isLoading:a,loadingText:s,noDataText:l,onDeleteItem:f,onEditLabOrder:d,onSaveLabOrder:u,onCancelEditLabOrder:h,onLabOrderTestChange:g,onLabOrderStatusChange:b,onEditPharmacyOrder:v,onPrintUnavailablePrescription:S,onBillLabOrder:k,onUpdateLabOrderStatus:E,onEnterLabReport:T,onViewLabReport:I,onMarkAsRecurring:D,labInventory:q=[],isSavingLabOrder:R=!1,expandedLabReports:F={},toggleLabReport:U=()=>{}})=>{const z=w.useMemo(()=>{const L={};n.forEach(H=>{if(isNaN(H.date.getTime())){L["Unknown Date"]||(L["Unknown Date"]=[]),L["Unknown Date"].push(H);return}const ee=PQ(H.originalDateString);L[ee]||(L[ee]=[]),L[ee].push(H)});const $=Object.keys(L);return $.sort((H,ee)=>{if(H==="Unknown Date")return 1;if(ee==="Unknown Date")return-1;try{const te=new Date(H.split(" ").reverse().join(" ")),ae=new Date(ee.split(" ").reverse().join(" "));if(!isNaN(te.getTime())&&!isNaN(ae.getTime()))return ae.getTime()-te.getTime()}catch{}return ee.localeCompare(H)}),$.map(H=>({date:H,items:L[H]}))},[n]),V=["pending","billed","collected","processing","report_ready","completed","cancelled","reported"];return i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title mb-2 pb-1",children:e}),r]}),a&&i.jsx("p",{className:"ai-context-text italic",children:s}),!a&&n.length===0&&i.jsx("p",{className:"ai-context-text italic",children:l}),!a&&n.length>0&&i.jsx("div",{className:"space-y-3",children:z.map(({date:L,items:$})=>i.jsxs("div",{children:[i.jsx("h5",{className:"grouped-history-date",children:L}),i.jsx("div",{className:"space-y-1 grouped-history-item-container",children:$.map((H,ee)=>i.jsxs("div",{className:"grouped-history-item ai-context-item flex flex-col",children:[i.jsxs("div",{className:"flex justify-between items-center w-full",children:[i.jsx("div",{className:"flex-grow mr-2 ai-context-text",children:t(H,ee,F,U)}),i.jsxs("div",{className:"flex items-center space-x-1",children:[H.type==="Lab Order"&&!H.data.isEditing&&d&&i.jsx("button",{onClick:()=>d(H.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this lab order",disabled:R,children:i.jsx(jd,{size:14})}),H.type==="Lab Order"&&H.data.isEditing&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>u&&u(H.data.id,H.data.editedTests,H.data.editedStatus),className:"text-green-600 hover:text-green-800 p-1 rounded hover:bg-green-100 focus:outline-none focus:ring-1 focus:ring-green-400",title:"Save lab order changes",disabled:R,children:i.jsx(Rd,{size:14})}),i.jsx("button",{onClick:()=>h&&h(H.data.id),className:"text-gray-600 hover:text-gray-800 p-1 rounded hover:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-gray-400",title:"Cancel editing",disabled:R,children:i.jsx(ti,{size:14})})]}),H.type==="Lab Order"&&i.jsxs("div",{className:"lab-table-actions",children:[H.data.status==="pending"&&k&&(()=>{const te=H.data.tests.reduce((ae,Z)=>ae+(Number(Z.price)||0),0).toFixed(2);return i.jsxs("button",{onClick:()=>k(H.data),className:"lab-action-button btn-bill",title:`Pay total of ${te}`,children:["Pay (",te,")"]})})(),H.data.status==="billed"&&E&&i.jsx("button",{onClick:()=>E(H.data.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),H.data.status==="collected"&&E&&i.jsx("button",{onClick:()=>E(H.data.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(H.data.status==="processing"||H.data.status==="report_ready"||H.data.status==="reported")&&T&&i.jsx("button",{onClick:()=>T(H.data),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(H.data.status==="report_ready"||H.data.status==="reported")&&E&&i.jsx("button",{onClick:()=>E(H.data.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(H.data.status==="completed"||H.data.status==="report_ready"||H.data.status==="reported")&&I&&i.jsx("button",{onClick:()=>I(H.data),className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]}),H.type==="Pharmacy Order"&&H.data.status==="pending"&&v&&i.jsx("button",{onClick:()=>v(H.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this pharmacy order",disabled:R,children:i.jsx(jd,{size:14})}),H.type==="Pharmacy Order"&&H.data.prescriptionForUnavailableDrugs&&S&&i.jsx("button",{onClick:()=>S(H.data.prescriptionForUnavailableDrugs,`Prescription for Order ${H.data.id}`),className:"text-purple-600 hover:text-purple-800 p-1 rounded hover:bg-purple-100 focus:outline-none focus:ring-1 focus:ring-purple-400",title:"Print Prescription for Unavailable Drugs",disabled:R,children:i.jsx(Ml,{size:14})}),H.type==="Pharmacy Order"&&D&&i.jsx("button",{onClick:()=>D(H.data.id),className:"text-teal-600 hover:text-teal-800 p-1 rounded hover:bg-teal-100 focus:outline-none focus:ring-1 focus:ring-teal-400",title:"Mark as Recurring Medication",disabled:R,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-repeat",children:[i.jsx("path",{d:"m17 2 4 4-4 4"}),i.jsx("path",{d:"M3 11v-1a4 4 0 0 1 4-4h14"}),i.jsx("path",{d:"m7 22-4-4 4-4"}),i.jsx("path",{d:"M21 13v1a4 4 0 0 1-4 4H3"})]})}),H.type==="Pharmacy Order"&&H.data.status==="pending"&&f&&i.jsx("button",{onClick:()=>f({type:H.type,data:H.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Delete this pending pharmacy order",disabled:R,children:i.jsx(ti,{size:14})}),f&&["Complaint","Lab Order","Lab Report"].includes(H.type)&&i.jsx("button",{onClick:()=>f({type:H.type,data:H.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:`Delete this ${H.type.toLowerCase()}`,disabled:R,children:i.jsx(ti,{size:14})})]})]}),H.type==="Lab Order"&&H.data.isEditing&&i.jsxs("div",{className:"lab-order-edit-form mt-2 w-full",children:[i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status:"}),i.jsx("select",{value:H.data.editedStatus||H.data.status,onChange:te=>b&&b(H.data.id,te.target.value),className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:R,children:V.map(te=>i.jsx("option",{value:te,children:te.replace(/_/g," ")},te))})]}),i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tests:"}),H.data.editedTests.map((te,ae)=>i.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[i.jsxs("select",{value:te.id,onChange:Z=>{const B=q.find(K=>String(K.id)===Z.target.value);B&&(g&&g(H.data.id,ae,"id",B.id),g&&g(H.data.id,ae,"name",B.name),g&&g(H.data.id,ae,"price",B.price))},className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:R,children:[i.jsx("option",{value:"",children:"Select Test"}),q.map(Z=>i.jsxs("option",{value:Z.id,children:[Z.name," (",Z.price,")"]},Z.id))]}),i.jsx("button",{onClick:()=>{const Z=H.data.editedTests.filter((B,K)=>K!==ae);g&&g(H.data.id,-1,"remove",Z)},className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Remove test",disabled:R,children:i.jsx(ti,{size:14})})]},ae)),i.jsx("button",{onClick:()=>{g&&g(H.data.id,-1,"add",{id:"",name:"",price:0})},className:"button-secondary mt-2 text-xs",disabled:R,children:"Add Test"})]})]},`${H.type}-${H.originalDateString}-${ee}`))})]},L))})]})},IQ="_modalOverlay_1yna4_3",MQ="_modalContent_1yna4_29",RQ="_modalHeader_1yna4_57",OQ="_modalTitle_1yna4_75",LQ="_modalCloseButton_1yna4_87",FQ="_modalBody_1yna4_115",$Q="_errorText_1yna4_129",zQ="_formGroup_1yna4_147",BQ="_inputField_1yna4_171",UQ="_searchResultsCard_1yna4_213",qQ="_searchResultsList_1yna4_241",VQ="_searchResultItem_1yna4_253",HQ="_searchResultPrice_1yna4_289",GQ="_selectedTestsCard_1yna4_299",YQ="_selectedTestsHeader_1yna4_319",WQ="_noTestsMessage_1yna4_335",QQ="_selectedTestsList_1yna4_351",JQ="_selectedTestItem_1yna4_363",KQ="_selectedTestName_1yna4_387",XQ="_selectedTestPrice_1yna4_399",ZQ="_removeTestButton_1yna4_411",eJ="_totalAmount_1yna4_437",tJ="_modalFooter_1yna4_455",nJ="_button_1yna4_473",rJ="_buttonPrimary_1yna4_491",iJ="_buttonSecondary_1yna4_513",On={modalOverlay:IQ,modalContent:MQ,modalHeader:RQ,modalTitle:OQ,modalCloseButton:LQ,modalBody:FQ,errorText:$Q,formGroup:zQ,inputField:BQ,searchResultsCard:UQ,searchResultsList:qQ,searchResultItem:VQ,searchResultPrice:HQ,selectedTestsCard:GQ,selectedTestsHeader:YQ,noTestsMessage:WQ,selectedTestsList:QQ,selectedTestItem:JQ,selectedTestName:KQ,selectedTestPrice:XQ,removeTestButton:ZQ,totalAmount:eJ,modalFooter:tJ,button:nJ,buttonPrimary:rJ,buttonSecondary:iJ},aJ=({isOpen:e,onClose:n,patientId:t,labInventory:r,fetchPendingLabOrdersData:a})=>{const[s,l]=w.useState([]),[f,d]=w.useState(""),[u,h]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>{if(!f){h([]);return}const I=f.toLowerCase();h(r.filter(D=>D.name.toLowerCase().includes(I)||D.description&&D.description.toLowerCase().includes(I)).slice(0,10))},[f,r]);const k=async()=>{if(!t){b("Patient ID is missing.");return}if(s.length===0){b("Please select at least one lab test.");return}S(!0),b(null);try{const I={patient_id:t,tests:s.map(q=>({id:q.id,name:q.name,price:q.price}))},D=await ge("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)});if(!D.ok){const q=await D.json().catch(()=>({}));throw new Error(q.message||`Failed to create lab order: ${D.statusText}`)}await D.json(),a(t),n(),l([]),d("")}catch(I){b(`Lab Order Creation Error: ${I.message}`)}finally{S(!1)}},E=I=>{if(s.some(D=>D.id===I.id)){b(`${I.name} is already in the order.`),setTimeout(()=>b(null),3e3),d(""),h([]);return}l(D=>[...D,{...I}]),d(""),h([])},T=I=>{l(D=>D.filter(q=>q.id!==I))};return e?i.jsx("div",{className:On.modalOverlay,children:i.jsxs("div",{className:On.modalContent,children:[i.jsxs("div",{className:On.modalHeader,children:[i.jsx("h3",{className:On.modalTitle,children:"Create New Lab Order"}),i.jsx("button",{onClick:n,className:On.modalCloseButton,children:i.jsx(Jn,{size:20})})]}),i.jsxs("div",{className:On.modalBody,children:[g&&i.jsx("div",{className:On.errorText,children:g}),i.jsxs("div",{className:On.formGroup,style:{position:"relative"},children:[i.jsx("label",{htmlFor:"lab-test-search",children:"Add Lab Test"}),i.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search available lab tests...",value:f,onChange:I=>d(I.target.value),className:On.inputField}),f&&u.length>0&&i.jsx("div",{className:On.searchResultsCard,children:i.jsx("ul",{className:On.searchResultsList,children:u.map(I=>i.jsxs("li",{onClick:()=>E(I),className:On.searchResultItem,children:[i.jsx("span",{children:I.name}),i.jsxs("span",{className:On.searchResultPrice,children:["(",parseFloat(String(I.price)).toFixed(2),")"]})]},I.id))})})]}),i.jsxs("div",{className:On.selectedTestsCard,children:[i.jsx("h4",{className:On.selectedTestsHeader,children:"Selected Tests"}),s.length===0?i.jsx("p",{className:On.noTestsMessage,children:"No tests added yet."}):i.jsx("ul",{className:On.selectedTestsList,children:s.map(I=>i.jsxs("li",{className:On.selectedTestItem,children:[i.jsx("span",{className:On.selectedTestName,children:I.name}),i.jsxs("span",{className:On.selectedTestPrice,children:["",parseFloat(String(I.price)).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>T(String(I.id)),className:On.removeTestButton,title:"Remove Test",children:i.jsx(ti,{size:16})})]},I.id))})]}),s.length>0&&i.jsxs("div",{className:On.totalAmount,children:["Total: ",s.reduce((I,D)=>I+parseFloat(String(D.price)),0).toFixed(2)]})]}),i.jsxs("div",{className:On.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${On.button} ${On.buttonSecondary}`,children:" Cancel "}),i.jsxs("button",{type:"button",onClick:k,disabled:s.length===0||v,className:`${On.button} ${On.buttonPrimary} ${s.length===0||v?On.buttonDisabled:""}`,children:[" ",v?"Saving...":"Create Lab Order"," "]})]})]})}):null},sJ="_modalOverlay_7kwn4_3",oJ="_modalContent_7kwn4_29",lJ="_modalHeader_7kwn4_61",cJ="_modalTitle_7kwn4_79",uJ="_modalCloseButton_7kwn4_93",dJ="_modalBody_7kwn4_129",fJ="_errorText_7kwn4_141",hJ="_formGroup_7kwn4_161",pJ="_stickySearchHeader_7kwn4_173",mJ="_inputField_7kwn4_211",gJ="_searchResultsCard_7kwn4_253",yJ="_searchResultsList_7kwn4_281",xJ="_searchResultItem_7kwn4_293",bJ="_searchResultPrice_7kwn4_323",vJ="_selectedTestsCard_7kwn4_335",wJ="_selectedTestsHeader_7kwn4_351",SJ="_noTestsMessage_7kwn4_375",NJ="_selectedTestsList_7kwn4_395",CJ="_selectedTestItem_7kwn4_413",jJ="_selectedTestHeader_7kwn4_441",_J="_selectedTestName_7kwn4_457",kJ="_selectedTestInputs_7kwn4_469",EJ="_inputGroup_7kwn4_481",TJ="_quantityInput_7kwn4_503",AJ="_removeTestButton_7kwn4_523",PJ="_textareaField_7kwn4_559",DJ="_modalFooter_7kwn4_573",IJ="_button_7kwn4_591",MJ="_buttonPrimary_7kwn4_615",RJ="_buttonSecondary_7kwn4_637",OJ="_buttonDisabled_7kwn4_659",rn={modalOverlay:sJ,modalContent:oJ,modalHeader:lJ,modalTitle:cJ,modalCloseButton:uJ,modalBody:dJ,errorText:fJ,formGroup:hJ,stickySearchHeader:pJ,inputField:mJ,searchResultsCard:gJ,searchResultsList:yJ,searchResultItem:xJ,searchResultPrice:bJ,selectedTestsCard:vJ,selectedTestsHeader:wJ,noTestsMessage:SJ,selectedTestsList:NJ,selectedTestItem:CJ,selectedTestHeader:jJ,selectedTestName:_J,selectedTestInputs:kJ,inputGroup:EJ,quantityInput:TJ,removeTestButton:AJ,textareaField:PJ,modalFooter:DJ,button:IJ,buttonPrimary:MJ,buttonSecondary:RJ,buttonDisabled:OJ},LJ=({isOpen:e,onClose:n,patientId:t,pharmacyInventory:r,fetchPharmacyOrdersData:a})=>{const[s,l]=w.useState([]),[f,d]=w.useState(""),[u,h]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1),[k,E]=w.useState(""),T=w.useRef(null);w.useEffect(()=>{if(!f){h([]);return}const z=f.toLowerCase();h(r.filter(V=>V.name.toLowerCase().includes(z)).slice(0,10))},[f,r]),w.useEffect(()=>{T.current&&(T.current.style.height="auto",T.current.style.height=`${T.current.scrollHeight}px`)},[k]);const I=z=>{if(!z)return null;const V=z.match(/(?:\d+x)?(\d+)/);return V?parseInt(V[1],10):null},D=Tn.useMemo(()=>s.reduce((z,V)=>{const L=V.pack_price||0,$=V.loose_price||0,H=(V.pack_quantity||0)*L,ee=(V.loose_quantity||0)*$;return z+H+ee},0),[s]),q=async()=>{if(!t){b("Patient ID is missing.");return}if(s.length===0&&!k.trim()){b("Please select at least one medication or provide a prescription.");return}S(!0),b(null);try{const z={patient_id:t,items:s.map(L=>({drug_id:L.drug_id,name:L.name,pack_quantity:L.pack_quantity||0,loose_quantity:L.loose_quantity||0,price:L.price,pack_price:L.pack_price||0,loose_price:L.loose_price||0,total_price:(L.pack_quantity||0)*(L.pack_price||0)+(L.loose_quantity||0)*(L.loose_price||0),unit:L.unit})),prescription_for_unavailable_drugs:k,status:"pending",date:new Date().toISOString(),order_total:D},V=await ge("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)});if(!V.ok){const L=await V.json().catch(()=>({}));throw new Error(L.message||`Failed to create pharmacy order: ${V.statusText}`)}await V.json(),a(t),n(),l([]),d(""),E("")}catch(z){b(`Pharmacy Order Creation Error: ${z.message}`)}finally{S(!1)}},R=z=>{if(s.some(H=>H.drug_id===z.id)){b(`${z.name} is already in the order.`),setTimeout(()=>b(null),3e3),d(""),h([]);return}const V=I(z.unit),L=Number(z.price)||0,$=L/(V||1);l(H=>[...H,{drug_id:z.id,name:z.name,price:z.price,pack_price:L,loose_price:$,pack_quantity:1,loose_quantity:0,unit:z.unit}]),d(""),h([])},F=z=>{l(V=>V.filter(L=>L.drug_id!==z))},U=(z,V,L)=>{l($=>$.map(H=>H.drug_id===z?{...H,[V]:L}:H))};return e?i.jsx("div",{className:rn.modalOverlay,children:i.jsxs("div",{className:rn.modalContent,children:[i.jsxs("div",{className:rn.modalHeader,children:[i.jsx("h3",{className:rn.modalTitle,children:"Create New Pharmacy Order"}),i.jsx("button",{onClick:n,className:rn.modalCloseButton,children:i.jsx(Jn,{size:20})})]}),i.jsxs("div",{className:rn.modalBody,children:[i.jsxs("div",{className:`${rn.formGroup} ${rn.stickySearchHeader}`,children:[i.jsx("label",{htmlFor:"drug-search",children:"Add Medication"}),i.jsx("input",{type:"text",id:"drug-search",placeholder:"Search available drugs...",value:f,onChange:z=>d(z.target.value),className:rn.inputField}),f&&u.length>0&&i.jsx("div",{className:rn.searchResultsCard,children:i.jsx("ul",{className:rn.searchResultsList,children:u.map(z=>i.jsxs("li",{onClick:()=>R(z),className:rn.searchResultItem,children:[i.jsx("span",{children:z.name}),i.jsxs("span",{className:rn.searchResultPrice,children:["(",parseFloat(String(z.price)).toFixed(2),")"]})]},z.id))})})]}),g&&i.jsx("div",{className:rn.errorText,children:g}),i.jsxs("div",{className:rn.selectedTestsCard,children:[i.jsx("h4",{className:rn.selectedTestsHeader,children:"Selected Medications"}),s.length===0?i.jsx("p",{className:rn.noTestsMessage,children:"No medications added yet."}):i.jsx("ul",{className:rn.selectedTestsList,children:s.map(z=>i.jsxs("li",{className:rn.selectedTestItem,children:[i.jsxs("div",{className:rn.selectedTestHeader,children:[i.jsx("span",{className:rn.selectedTestName,children:z.name}),i.jsx("button",{type:"button",onClick:()=>F(z.drug_id),className:rn.removeTestButton,title:"Remove Medication",children:i.jsx(ti,{size:16})})]}),i.jsxs("div",{className:rn.selectedTestInputs,children:[i.jsxs("div",{className:rn.inputGroup,children:[i.jsx("label",{children:"Packs"}),i.jsx("input",{type:"number",min:"0",value:z.pack_quantity,onChange:V=>U(z.drug_id,"pack_quantity",parseInt(V.target.value)||0),className:rn.quantityInput})]}),i.jsxs("div",{className:rn.inputGroup,children:[i.jsx("label",{children:"Loose"}),i.jsx("input",{type:"number",min:"0",value:z.loose_quantity,onChange:V=>U(z.drug_id,"loose_quantity",parseInt(V.target.value)||0),className:rn.quantityInput})]})]})]},z.drug_id))})]}),s.length>0&&i.jsxs("div",{className:rn.totalAmount,children:["Total: ",D.toFixed(2)]}),i.jsxs("div",{className:rn.formGroup,style:{marginTop:"20px"},children:[i.jsx("label",{htmlFor:"prescription-notes",children:"Prescription for Unavailable Drugs (Optional)"}),i.jsx("textarea",{id:"prescription-notes",ref:T,rows:1,value:k,onChange:z=>E(z.target.value),placeholder:"Enter any additional notes or prescription details...",className:`${rn.inputField} ${rn.textareaField}`})]})]}),i.jsxs("div",{className:rn.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${rn.button} ${rn.buttonSecondary}`,children:" Cancel "}),i.jsx("button",{type:"button",onClick:q,disabled:s.length===0&&!k.trim()||v,className:`${rn.button} ${rn.buttonPrimary} ${s.length===0&&!k.trim()||v?rn.buttonDisabled:""}`,children:v?"Saving...":"Create Order"})]})]})}):null},Fx=e=>{if(!e)return"";let n=e.toLowerCase();return n=n.replace(/\b(mg|g|ml|iu|unit|tabs|tablet|tablets|capsule|capsules|injection|injections|syrup|solution|cream|ointment|lotion|spray|drops|patch|suppository|vial|ampoule|bottle|pack|kit)\b/g,""),n=n.replace(/\b(test|panel|profile|assay|screen|analysis|level|count|culture)\b/g,""),n=n.replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim(),n},Jm=(e,n)=>{if(!e||!n||n.length===0)return;const t=Fx(e);let r=n.find(l=>Fx(l.name)===t);if(r)return r;let a=n.find(l=>Fx(l.name).includes(t));if(a)return a;let s=n.find(l=>t.includes(Fx(l.name)));if(s)return s},FJ=`You are an expert OPD (Outpatient Department) medical assistant for a Doctor in a clinic in India. You will receive all the medical data of the patient including complaints (history), labs, pharmacy orders, etc., along with their date and time. Your primary goal is to assist the doctor and analyze patient chief complaints (Co), provide a structured clinical assessment including lab test suggestions (Lx), differential diagnoses (Dx), and a treatment plan (Tx). You have access to tools (actions) to order lab tests and pharmacy items, and update patient details.



**1. Definitions:**
   - Co: Chief complaints
   - Pt: Patient (assume living in India)
   - Lx: Laboratory tests
   - Dx: Differential Diagnosis
   - Tx: Treatment Plan

**2. Workflow:**
   - Analyze Co, generate Lx, Dx, and Tx sections as described below.
   - **Prioritization for Orders:** Always prioritize using \`edit_pharmacy_order\` or \`edit_lab_order\` if there are existing pending orders for the patient, before considering \`create_pharmacy_order\` or \`create_lab_order\`.
   - using edit_lab_order edits the lab order with the given serial numnber use to add new tests to the existing order or remove the tests from existing order, marking the status affects all tests in the order not only the test,always use this tool if there are pending lab orders instead of creating new orders.
   - using edit_pharmacy_order edits the pharmacy order with the given serial numnber to add new items to the existing order, update existing items, or remove items (either by \`items_to_remove\` or by setting \`quantity\` to 0). Always use this tool if there are pending pharmacy orders instead of creating new orders.
   - If your Lx section suggests tests from the inventory, use the \`create_lab_order\` action, but only for tests that are both clinically required and have not already been ordered or are still pending. Skip tests that are already ordered and in pending.
   - If your Tx section prescribes medications, use the \`create_pharmacy_order\` action  but only for medications that are clinically required and have not already been prescribed or are still pending. Skip medications that are already dispensed or already ordered.
   - If your Tx section prescribes medications that are *not* available in the inventory, use the \`prescription_for_unavailable_drugs\` parameter within the \`create_pharmacy_order\` action to specify the prescription details for these unavailable drugs.
   - When ordering pharmacy items, specify both \`pack_quantity\` (number of full packs) and \`loose_quantity\` (number of individual units). The system will handle the conversion based on the drug's unit/pack size.
   - **Patient Details Management:** Always store or update patient name, age, sex, and phone number using the \`update_patient_details\` action. If patient name, age, or sex is received as 'New Patient - Direct Entry', 'N/A', or blank, treat it as missing data; if the user input provides anything resembling a name, age, or sex (e.g., shiva 25m, robin 50m, priya 19f), update them using the \`update_patient_details\` action. If details are missing, you can ask the user for the missing details using the \`ask_followup_question\` action.
   - Always update new complaints of the patient using the \`add_complaint_history\` action.
   - If you generate a concise summary of the patient's current situation based on the interaction and history, use the \`update_case_summary\` action to save it.
   - Remember, when you use \`update_case_summary\`, the previous case summary will be replaced by the new one, so you can use it like a short-term memory to store other stuff that **keeps changing**, like the current treatment plan, plan of action, active problems, or current vitals, etc.
   - When you use \`add_complaint_history\`, it will add the complaint to the previous ones. You will be given all the previous complaints back in every query, so you can use it to store other long-term facts that do **not change**, like the history of a chronic illness, surgical history, allergies, or social history, etc.
   - while placing or editing a pharmacy order make sure to set the \`pack_quantity\` and \`loose_quantity\` right.
   - Use the \`update_clinic_ai_memory\` action to store or update **various types of clinic-wide persistent information in a concise way**. This can include 'summaries of common patient encounters'+'summeries of previous **Clinic-wide AI Memory**'(e.g., 'Patient X, 50m, chronic gastritis, last visit YYYY-MM-DD, prescribed Z, follow-up in N days'+'**Clinic-wide AI Memory** summary'), notes on local health trends, common diagnostic patterns observed in the clinic, specific operational protocols. This memory is shared across all interactions for the clinic and helps tailor responses to its specific context over time.
**3.**Multiple Actions:** You can perform multiple actions (like ordering labs AND meds, adding complaints, updating patient information, and asking a follow-up question) in a single response by including multiple action objects within the main JSON array.


**4. Chief Complaints (Co):**
   - Analyze the provided chief complaints.
   - Present them in a table with two columns: 'Relevant Complaint (Score 8-10)' and 'Irrelevant Complaint (Score 0-7)', based on clinical relevance.

**5. Lab Tests (Lx):**
   - Suggest the most probable basic lab tests based on the clinical picture, ordered by likelihood.
   - If a basic test is positive/abnormal, suggest relevant advanced tests.
   - **Inventory Check:** Compare suggested tests against the provided inventory list.
   - **Table 1: Available Lab Tests:** Present tests *available* in the inventory in a table with columns: '**Clinical Importance (High/Medium/Low)**', 'Lab Test'. If suggesting tests from this table, prepare to use the \`create_lab_order\` tool in your response.
   - **Table 2: Unavailable Lab Tests:** Present tests *not available* in the inventory in a separate table with columns: '**Clinical Importance (High/Medium/Low)**', 'Unavailable Basic Test'. Clearly state these are not orderable via the tool (generate Table 2 only when required tests are unavailable).

**6. Differential Diagnosis (Dx):**
   - List potential differential diagnoses.
   - Provide a confidence score (0-10) for each.
   - Present in a table with columns: 'Differential Diagnosis' and 'Confidence Score (0-10)'.

**7. Treatment Plan (Tx):**
   - Create a structured treatment plan including ideal medications based on the diagnosis.
   - **Inventory Check:** Compare prescribed medications against the provided inventory list.
   - **Table 1: Available Medications:** Present medications *available* in the inventory in a table with columns: 'Time Frame' (from and to dates), 'Treatment Goal', 'Intervention', 'Medication Type', 'Drug Form', 'Drug Name', 'Regimen (Dose, Freq)', 'Duration'. Before using the \`create_pharmacy_order\` tool, check if an order for the same drug has already been placed for this patient today. If an order already exists for today, do *not* create a duplicate order. If no order exists for today, prepare to use the \`create_pharmacy_order\` tool in your response.
   - **Table 2: Unavailable Medications:** Present medications *not available* in the inventory in a separate table with columns: 'Unavailable Drug Name', 'Ideal Regimen', 'Reasoning/Indication', '**Clinical Importance (High/Medium/Low)**', 'Suggested Available Substitute (from inventory, if possible)'. Clearly state these are not orderable via the tool (generate Table 2 only when required medications are unavailable in the inventory).

**8. Tools / Actions:**
   When you need to perform actions like ordering tests/meds, updating patient info, or adding history, use the following JSON array format. The response should ONLY contain this JSON array, nothing else.

   ****STRICT JSON****>>>>>>\`\`\`json
[
  { "action": "create_pharmacy_order", "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "prescription_for_unavailable_drugs": "string | null" },
  { "action": "edit_pharmacy_order", "serialNumber": number, "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "items_to_remove": [ { "drug_id": number | null, "name": "Drug Name" } ], "status": "pending" | "billed" | "dispensed" | "cancelled", "prescription_for_unavailable_drugs": "string | null" },
  { "action": "create_lab_order", "tests": [ { "name": "Test Name" } ] },
  { "action": "edit_lab_order", "serialNumber": number, "tests": [ { "name": "Test Name" } ], "items_to_remove": [ { "id": number | string | null, "name": "Test Name" } ], "status": "pending" | "billed" | "collected" | "processing" | "report_ready" | "completed" | "cancelled" | "reported" },
  { "action": "add_complaint_history", "complaint": "Specific past complaint text..." },
  { "action": "update_patient_details", "name": "New Name (optional)", "age": number (optional), "gender": "M" | "F" | "O" | null (optional), "phone_number": "string (optional)" },
  { "action": "update_case_summary", "summary": "Concise summary text..." },
  { "action": "update_clinic_ai_memory", "memory_content": "New clinic-wide AI memory content..." }
]
\`\`\`

   - **Multiple Actions in One Response:** You can include multiple action objects within this single JSON array if several actions are required based on your analysis (e.g., adding history AND ordering labs).
   - **Prioritization Within the Array:** If including multiple actions, order them within the array according to this priority:
     1. \`add_complaint_history\`
     2. \`update_patient_details\`
     3. \`update_case_summary\`
     4. \`update_clinic_ai_memory\`
     5. \`create_lab_order\`
     6. \`edit_lab_order\`
     7. \`create_pharmacy_order\`
     8. \`edit_pharmacy_order\`
   - **Example (Multiple Actions):**
     \`\`\`json
     [
       { "action": "add_complaint_history", "complaint": "Patient also reports mild fever since yesterday." },
       { "action": "create_lab_order", "tests": [ { "name": "CBC" } ] }
     ]
     \`\`\`

   - **\`ask_followup_question\`**: Use this *separate* tool format (a single JSON object, NOT inside the array) only when you need clarification or missing information that prevents you from completing the assessment or required actions.
     \`\`\`json
     {
       "action": "ask_followup_question",
       "question": "Your clear, specific question here.",
       "options": ["Optional Answer 1", "Optional Answer 2"] // Optional: Provide 2-5 choices
     }
     \`\`\`
     *Description:* Ask the user a question to gather additional information needed to complete the task. This tool should be used when you encounter ambiguities, need clarification, or require more details to proceed effectively. It allows for interactive problem-solving by enabling direct communication with the user. Use this tool judiciously to maintain a balance between gathering necessary information and avoiding excessive back-and-forth.
     *Parameters:*
       - question: (required) The question to ask the user. This should be a clear, specific question that addresses the information you need.
       - options: (optional) An array of 2-5 options for the user to choose from. Each option should be a string describing a possible answer. You may not always need to provide options, but it may be helpful in many cases where it can save the user from having to type out a response manually.


**Important:**
- Ensure all tables are clearly formatted using Markdown.
- Strictly adhere to the inventory constraints for labs and medications when deciding whether to use \`create_lab_order\` or \`create_pharmacy_order\`.
- When using actions, provide ONLY the JSON array (or the single JSON object for \`ask_followup_question\`) as the *very last* part of your response, after all other content including tables. Do not include any other text after the JSON.

**Plan Mode:**
When the user asks a question about a patient's condition or general medical topics (not entering new medical data), respond in PLAN MODE. In this mode, focus on answering the user's inquiry, clarifying their request, brainstorming ideas, or architecting a solution (like exploring treatment options). Ask clarifying questions if needed. Present detailed plans or explanations **using clear table formats and markdown (like bolding) for easy readability**. Engage in back-and-back discussion to finalize details. Do not use action tools (\`create_lab_order\`, \`create_pharmacy_order\`, \`add_complaint_history\`, \`update_patient_details\`) while in PLAN MODE).`,r_="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",$J="gemini-2.5-flash";async function zJ(){const e=Ak();if(!e)return console.warn("No auth token found, using default Gemini API key."),r_;try{const t=(await pr.get("/api/clinics/settings",{headers:{Authorization:`Bearer ${e}`}})).data.gemini_api_key;if(t)return t}catch(n){console.error("Failed to fetch clinic-specific Gemini API key:",n)}return console.warn("Clinic-specific Gemini API key not found or failed to fetch, using default."),r_}let Kv=null;async function BJ(){if(!Kv){const e=await zJ();Kv=new H2({apiKey:e})}return Kv}async function UJ(e,n){const{query:t,currentDateTime:r,patientName:a,patientAge:s,patientGender:l,case_summary:f,case_summary_last_updated:d,clinic_ai_memory:u,clinic_ai_memory_last_updated:h,clinic_wide_system_prompt:g,labHistory:b,pharmacyOrders:v,pastComplaints:S,pharmacyInventory:k,labInventory:E}=e;let T=`Patient Complaint: ${t}`;if(f&&(T+=`

--- Case Summary (Provided by Doctor) ---
${f}`,d))try{const L=new Date(d).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});T+=`
(Last Updated: ${L})`}catch{console.warn(`Could not format case_summary_last_updated: ${d}`),T+=`
(Last Updated: ${d})`}if(a&&(T+=`

Patient Name: ${a}`),s!=null&&(T+=`
Patient Age: ${s}`),l&&(T+=`
Patient Gender: ${l}`),r)try{const L=new Date(r).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});T+=`

Current Interaction Time: ${L}`}catch{console.warn(`Could not format currentDateTime: ${r}`),T+=`

Current Interaction Time: ${r}`}if(u&&(T+=`

--- Clinic-wide AI Memory/Context ---
${u}`,h))try{const L=new Date(h).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});T+=`
(Last Updated: ${L})`}catch{console.warn(`Could not format clinic_ai_memory_last_updated: ${h}`),T+=`
(Last Updated: ${h})`}let I="";b&&Array.isArray(b)&&b.length>0&&(I=`

--- Lab History (Orders & Reports) ---
`,b.forEach(L=>{let $="Unknown Date";try{$=new Date(L.orderDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab order: ${L.orderDate}`)}if(I+=`
Order #${L.serialNumber} Date: ${$} (Status: ${L.status})
`,I+=`Tests: ${L.tests.map(H=>H.name).join(", ")}
`,L.report){let H="Unknown Date";try{H=new Date(L.report.reportDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab report: ${L.report.reportDate}`)}I+=`  -> Report Date: ${H}
`,L.report.tests&&Array.isArray(L.report.tests)?(I+=`     Findings:
`,L.report.tests.forEach(ee=>{I+=`       - Test: ${ee.testName}
`,ee.parameters&&Array.isArray(ee.parameters)&&ee.parameters.forEach(te=>{I+=`         - ${te.name}: ${te.value} (Normal: ${te.normal_range})
`})})):(I+=`     Findings: ${L.report.reportContent||"N/A"}
`,L.report.error&&(I+=`     Note: ${L.report.error}
`))}I+=`---
`}),T+=I);let D="";v&&Array.isArray(v)&&v.length>0&&(D=`

--- Recent Pharmacy Orders ---
`,v.forEach(L=>{let $="Unknown Date/Time";try{$=new Date(L.date).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for pharmacy order: ${L.date}`)}D+=`
Order #${L.serialNumber} Date/Time: ${$} (Status: ${L.status})
`,D+=`Prescribed By: ${L.prescribedBy||"N/A"}
`,L.dispensedBy&&(D+=`Dispensed By: ${L.dispensedBy}
`),D+=`Medications:
`,L.medications.forEach(H=>{D+=`  - ${H.name} (Qty: ${H.quantity}`,H.tabletsPerDay&&(D+=`, ${H.tabletsPerDay}/day`),H.numberOfDays&&(D+=` for ${H.numberOfDays} days`),D+=`)
`}),L.prescriptionForUnavailableDrugs&&(D+=`  Prescription for Unavailable Drugs: ${L.prescriptionForUnavailableDrugs}
`),D+=`---
`}),T+=D);let q="";S&&Array.isArray(S)&&S.length>0&&(q=`

--- Past Complaints History ---
`,S.forEach(L=>{let $="Unknown Date/Time";try{$=new Date(L.createdAt).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for past complaint: ${L.createdAt}`)}q+=`
Date/Time: ${$}
Complaint: ${L.complaint||"N/A"}
---
`}),T+=q);let R="";k&&Array.isArray(k)&&k.length>0&&(R=`

--- Current Pharmacy Inventory (Stock Levels) ---
`,k.forEach(L=>{R+=`- ${L.name} (Pack: ${L.unit??"N/A"}): ${L.quantity_in_stock??"N/A"}
`}),T+=R);let F="";E&&Array.isArray(E)&&E.length>0&&(F=`

--- Available Lab Tests ---
`,E.forEach(L=>{F+=`- ${L.name} (Price: ${L.price??"N/A"})
`}),T+=F);const U=[{text:FJ}];g&&g.trim()!==""&&U.push({text:`--- Additional Clinic-Specific Instructions ---
${g}`});const z=[{text:T}];if(n){const L=new FileReader,$=await new Promise((H,ee)=>{L.onloadend=()=>{typeof L.result=="string"?H(L.result.split(",")[1]):ee(new Error("Failed to read image file as base64."))},L.onerror=ee,L.readAsDataURL(n)});z.push({inlineData:{mimeType:n.type,data:$}})}const V=[];U.length>0&&V.push({role:"user",parts:U}),V.push({role:"user",parts:z});try{const L={model:$J,contents:V,generationConfig:{temperature:.7,maxOutputTokens:1024,responseMimeType:"text/plain"}},H=await(await BJ()).models.generateContentStream(L);let ee="";for await(const te of H)if(te&&typeof te.text=="function"){const ae=te.text;ae&&(ee+=ae)}else te&&te.candidates&&te.candidates[0]&&te.candidates[0].content&&te.candidates[0].content.parts&&te.candidates[0].content.parts[0]&&te.candidates[0].content.parts[0].text&&(ee+=te.candidates[0].content.parts[0].text);if(ee&&ee.trim()!=="")return ee.trim();throw console.error("Empty or invalid response received from Gemini API stream."),new Error("Failed to get suggestion from AI (Gemini). Empty or invalid stream response.")}catch(L){console.error("Error calling Gemini API:",L);let $="Failed to get suggestion from Gemini.";throw L.message&&($=`Error processing Gemini request: ${L.message}`),new Error($)}}const i_=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return n?parseInt(n[1],10):1},qJ=w.forwardRef(({recordId:e,patientId:n,patientDetails:t,caseSummary:r,caseSummaryUpdatedAt:a,clinicSettings:s,userMessages:l,selectedImageFile:f,pendingLabOrders:d,labReports:u,pastComplaints:h,pharmacyOrders:g,pharmacyInventory:b,labInventory:v,setCurrentComplaint:S,setAiResponse:k,setAiResponseText:E,setAiResponseJsonString:T,setShowAiJsonDetails:I,setIsLoadingAi:D,setAiError:q,setIsSubmittingAiOrder:R,setAiOrderSubmissionStatus:F,setIsSubmittingAiLabOrder:U,setAiLabOrderSubmissionStatus:z,setIsSubmittingAiComplaint:V,setAiComplaintSubmissionStatus:L,setIsUpdatingCaseSummary:$,setAiCaseSummaryUpdateStatus:H,setCaseSummary:ee,setCaseSummaryUpdatedAt:te,setIsUpdatingAiMemoryByAI:ae,setAiMemoryUpdateByAIStatus:Z,setFollowUpQuestion:B,setFollowUpOptions:K,setError:oe,setIsSavingAiResponse:A,setSaveAiResponseError:se,fetchPharmacyOrdersData:ue,fetchPendingLabOrdersData:M,fetchLabReportsData:pe,fetchPastComplaintsData:be,fetchPatientDetails:fe,setClinicSettings:Pe,setEditedAiMemory:de,handleDeleteItem:Me},Ze)=>{let Fe;const Ce=async(Ie,Ge,ze,nt=0)=>{let jt;const ve=["AI response did not contain a recognized function call","AI response did not result in a recognized or performed function call"].some(qe=>{var Qe;return(Qe=Ge.message)==null?void 0:Qe.includes(qe)});ze&&ve?jt=`AI Error: ${Ge.message}

${ze}`:(jt=`I encountered a frontend error while trying to execute the '${Ie}' function. The error message is: "${Ge.message}". Based on this error, please analyze what went wrong and either correct the function call and try again, or explain the problem.`,(Ie==="create_pharmacy_order"||Ie==="edit_pharmacy_order")&&(jt+=`

IMPORTANT: When ordering medication, please first check if the medication ordered matches the exact name given in the inventory. If the name itself is not given in the inventory, you can also use 'prescription_for_unavailable_drugs' to write a prescription for unavailable drugs.`),ze&&(jt+=`

The original AI response that caused the error was:
\`\`\`
${ze}
\`\`\``)),await Fe(jt,nt+1)},Re=async(Ie,Ge)=>{F(null),z(null),L(null),H(null),Z(null),B(null),K([]),oe(null);let ze=!1,nt=null;const jt=/```json\s*([\s\S]*?)\s*```/,xt=Ie.match(jt);if(xt&&xt[1])nt=xt[1];else{const ve=Ie.trim();if(ve.startsWith("{")&&ve.endsWith("}"))nt=ve;else if(ve.startsWith("[")&&ve.endsWith("]"))nt=ve;else throw new Error("AI response did not contain a recognized function call.")}if(nt)try{const ve=JSON.parse(nt),qe=Array.isArray(ve)?ve:[ve],Qe=[];let Be=null;for(const J of qe){if(J.action==="ask_followup_question"){Be=J,ze=!0;continue}J.action==="update_clinic_ai_memory"&&typeof J.memory_content=="string"?(ze=!0,Qe.push((async()=>{ae(!0),Z("Processing AI mem...");try{if(!s)throw new Error("Clinic settings not loaded, cannot update AI memory.");const Y={...s,aiMemory:J.memory_content.trim(),admissionCharge:s.admissionCharge,perDayCharge:s.perDayCharge,otherCharges:s.otherCharges,clinicWideSystemPrompt:s.clinicWideSystemPrompt},X=await ge("/api/clinics/settings",{method:"PUT",body:JSON.stringify(Y)});if(!X.ok){const ke=await X.json().catch(()=>({}));throw new Error(ke.message||`AI-triggered clinic memory update failed: ${X.statusText}`)}const Ne=await X.json();Pe({admissionCharge:parseFloat(Ne.settings.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(Ne.settings.perDayCharge||0).toFixed(2),otherCharges:parseFloat(Ne.settings.otherCharges||0).toFixed(2),aiMemory:Ne.settings.aiMemory||"",aiMemoryUpdatedAt:Ne.settings.aiMemoryUpdatedAt||null,clinicWideSystemPrompt:Ne.settings.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:Ne.settings.clinicWideSystemPromptUpdatedAt||null}),de(Ne.settings.aiMemory||""),Z("AI mem updated!")}catch(Y){await Ce(J.action,Y,Ie,Ge)}finally{ae(!1)}})())):J.action==="create_pharmacy_order"&&(Array.isArray(J.items)||J.prescription_for_unavailable_drugs&&J.prescription_for_unavailable_drugs.trim()!=="")?(ze=!0,Qe.push((async()=>{R(!0),F("Processing order...");try{if(!n)throw new Error("Missing patient ID for pharmacy order.");const Y=[];let X=null;if(Array.isArray(J.items))for(const it of J.items){const{pack_price:mt,loose_price:ht,total_price:Ve,price:tt,...Le}=it;let ot;if(Le.drug_id?ot=b.find(Ti=>Ti.id===Le.drug_id):Le.name&&(ot=Jm(Le.name,b)),!ot){X=`Drug "${Le.name||Le.drug_id||"Unknown"}" not found or no close match.`;break}let et;const bt=Le.tabletsPerDay;if(bt&&Number(bt)>0){const Ti=Number(bt);Number.isInteger(Ti)?et=Ti:et=null}else et=1;const Un=Number(Le.numberOfDays)||1,Ln=Number(Le.pack_quantity)||0,jn=Number(Le.loose_quantity)||0;if(Ln<=0&&jn<=0){X=`Invalid quantity for ${ot.name}. Pack quantity or loose quantity must be greater than 0.`;break}const gn=ot.unit,dn=i_(gn),Nr=Number(ot.price),Ur=Nr,ri=dn>0?Nr/dn:0,fa=Ln*Ur+jn*ri;Y.push({drug_id:ot.id?String(ot.id):null,name:ot.name,pack_quantity:Ln,loose_quantity:jn,tabletsPerDay:et,numberOfDays:Un,price:Nr,directions_to_use:Le.directions_to_use||void 0,box_number:Le.box_number||void 0,isLoose:Le.isLoose||void 0,unit:gn||void 0,pack_price:parseFloat(Ur.toFixed(2)),loose_price:parseFloat(ri.toFixed(2)),total_price:parseFloat(fa.toFixed(2))})}if(X)throw new Error(X);const Ne=Y.reduce((it,mt)=>it+mt.total_price,0),ke={patient_id:n,items:Y.map(({drug_id:it,name:mt,pack_quantity:ht,loose_quantity:Ve,tabletsPerDay:tt,numberOfDays:Le,directions_to_use:ot,box_number:et,isLoose:bt,unit:Un,pack_price:Ln,loose_price:jn,total_price:gn})=>({drug_id:it,name:mt,pack_quantity:ht,loose_quantity:Ve,tabletsPerDay:tt,numberOfDays:Le,directions_to_use:ot,box_number:et,isLoose:bt,unit:Un,pack_price:Ln,loose_price:jn,total_price:gn})),prescription_for_unavailable_drugs:J.prescription_for_unavailable_drugs||null,order_total:parseFloat(Ne.toFixed(2))},Ue=await ge("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ke)});if(!Ue.ok){const it=await Ue.json().catch(()=>({}));throw new Error(it.message||`AI order creation failed: ${Ue.statusText}`)}F("Order created!"),n&&ue(n)}catch(Y){await Ce(J.action,Y,Ie,Ge)}finally{R(!1)}})())):J.action==="update_patient_details"?(ze=!0,Qe.push((async()=>{D(!0),oe(null);try{if(!n)throw new Error("Missing patient ID for updating details.");const Y={};let X=!1;if(J.name!==void 0&&typeof J.name=="string"&&(Y.name=J.name,X=!0),J.age!==void 0&&typeof J.age=="number"&&(Y.age=J.age,X=!0),J.gender!==void 0&&typeof J.gender=="string"){if(!["M","F","O",null,""].includes(J.gender))throw new Error(`Invalid gender specified: "${J.gender}". Use M, F, or O.`);Y.gender=J.gender===""?null:J.gender,X=!0}if(J.phone_number!==void 0&&(typeof J.phone_number=="string"||J.phone_number===null)&&(Y.phone_number=J.phone_number,X=!0),!X)throw new Error("No valid patient details provided for update.");const Ne=await ge(`/api/patients/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Y)});if(!Ne.ok){const ke=await Ne.json().catch(()=>({}));throw new Error(ke.message||`AI patient update failed: ${Ne.statusText}`)}await Ne.json(),fe(n)}catch(Y){await Ce(J.action,Y,Ie,Ge)}finally{D(!1)}})())):J.action==="create_lab_order"&&Array.isArray(J.tests)&&J.tests.length>0?(ze=!0,Qe.push((async()=>{U(!0),z("Processing lab...");try{if(!n)throw new Error("Missing patient ID for lab order.");const Y=[];let X=null;for(const Ue of J.tests){let it;if(Ue.id?it=v.find(ht=>String(ht.id)===String(Ue.id)):Ue.name&&(it=Jm(Ue.name,v)),!it){X=`Lab test "${Ue.name||Ue.id||"Unknown"}" not found or no close match.`;break}const mt=typeof it.price=="string"?parseFloat(it.price):it.price;Y.push({id:it.id,name:it.name,price:mt,description:it.description,default_parameters:it.default_parameters})}if(X)throw new Error(X);const Ne={patient_id:n,tests:Y.map(Ue=>({id:Ue.id,name:Ue.name,price:Ue.price}))},ke=await ge("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ne)});if(!ke.ok){const Ue=await ke.json().catch(()=>({}));throw new Error(Ue.message||`AI lab order creation failed: ${ke.statusText}`)}await ke.json(),z("Success: Lab order created!"),n&&M(n)}catch(Y){await Ce(J.action,Y,Ie,Ge)}finally{U(!1)}})())):J.action==="edit_pharmacy_order"?(ze=!0,Qe.push((async()=>{R(!0),F("Processing pharmacy order edit...");try{const Y=J.serialNumber;let X;if(Y?X=[...g].sort((Ve,tt)=>{const Le=new Date(Ve.date).getTime(),ot=new Date(tt.date).getTime();return Le-ot})[Y-1]:X=g.sort((ht,Ve)=>new Date(ht.date).getTime()-new Date(Ve.date).getTime()).find(ht=>ht.status==="pending"),!X)throw new Error(`Pharmacy order with serial number ${Y} not found, or no pending order to edit.`);const Ne=X.id,ke=J.items,Ue=J.items_to_remove,it=J.status,mt=J.prescription_for_unavailable_drugs;if((!ke||Array.isArray(ke)&&ke.length===0)&&!Ue&&!it&&(!mt||mt.trim()===""))throw new Error("No items, items to remove, status, or unavailable drugs prescription provided for pharmacy order edit.");if(it==="cancelled")await Me({type:"Pharmacy Order",data:X}),F("Success: Pharmacy order cancelled and deleted!");else{let ht=[...X.medications];if(Array.isArray(Ue)&&Ue.length>0&&(ht=ht.filter(et=>{const bt=et.name.toLowerCase().replace(/\s+/g," ").trim();return!Ue.some(Un=>{if(Un.drug_id&&String(et.drug_id)===String(Un.drug_id))return!0;if(Un.name){const Ln=Un.name.toLowerCase().replace(/\s+/g," ").trim();return bt===Ln}return!1})})),Array.isArray(ke)&&ke.length>0)for(const et of ke){const{pack_price:bt,loose_price:Un,total_price:Ln,price:jn,...gn}=et;let dn;if(gn.drug_id?dn=b.find(Fn=>Fn.id===String(gn.drug_id)):gn.name&&(dn=Jm(gn.name,b)),!dn)throw new Error(`Drug "${gn.name||gn.drug_id||"Unknown"}" not found or no close match for update.`);let Nr;const Ur=gn.tabletsPerDay;if(Ur&&Number(Ur)>0){const Fn=Number(Ur);Number.isInteger(Fn)?Nr=Fn:Nr=null}else Nr=1;const ri=Number(gn.numberOfDays)||1,fa=Number(gn.pack_quantity)||0,Ti=Number(gn.loose_quantity)||0,nr=ht.findIndex(Fn=>Fn.drug_id&&Fn.drug_id===(dn==null?void 0:dn.id)||Fn.name.toLowerCase()===(dn==null?void 0:dn.name.toLowerCase()));if(fa<=0&&Ti<=0){nr!==-1&&ht.splice(nr,1);continue}const Xn={drug_id:dn.id?String(dn.id):null,name:dn.name,pack_quantity:fa,loose_quantity:Ti,tabletsPerDay:Nr,numberOfDays:ri,price:dn.price,directions_to_use:gn.directions_to_use||void 0,box_number:gn.box_number||void 0,isLoose:gn.isLoose||void 0,unit:dn.unit||void 0};nr!==-1?ht[nr]={...ht[nr],...Xn}:ht.push(Xn)}const Ve=ht.map(et=>{const bt=b.find(Nr=>Nr.id===et.drug_id),Un=bt?i_(bt.unit):1,Ln=Number(bt==null?void 0:bt.price)||0,jn=Ln,gn=Un>0?Ln/Un:0,dn=(et.pack_quantity||0)*jn+(et.loose_quantity||0)*gn;return{...et,pack_price:parseFloat(jn.toFixed(2)),loose_price:parseFloat(gn.toFixed(2)),total_price:parseFloat(dn.toFixed(2))}}),tt=Ve.reduce((et,bt)=>et+bt.total_price,0),Le={};if(Ve.length>0?Le.items=Ve.map(({drug_id:et,name:bt,pack_quantity:Un,loose_quantity:Ln,tabletsPerDay:jn,numberOfDays:gn,directions_to_use:dn,box_number:Nr,isLoose:Ur,unit:ri,pack_price:fa,loose_price:Ti,total_price:nr})=>({drug_id:et,name:bt,pack_quantity:Un,loose_quantity:Ln,tabletsPerDay:jn===null?null:jn,numberOfDays:gn,directions_to_use:dn,box_number:Nr,isLoose:Ur,unit:ri,pack_price:fa,loose_price:Ti,total_price:nr})):ke&&ke.length>0&&(Le.items=[]),mt!==void 0&&(Le.prescription_for_unavailable_drugs=mt),Le.order_total=parseFloat(tt.toFixed(2)),it){if(!["pending","billed","dispensed","cancelled"].includes(it))throw new Error(`Invalid status for pharmacy order: ${it}.`);Le.status=it}const ot=await ge(`/api/pharmacy-orders/${Ne}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Le)});if(!ot.ok){const et=await ot.json().catch(()=>({}));throw new Error(et.message||`AI pharmacy order edit failed: ${ot.statusText}`)}F("Success: Pharmacy order updated!"),n&&ue(n)}}catch(Y){await Ce(J.action,Y,Ie,Ge)}finally{R(!1)}})())):J.action==="edit_lab_order"?(ze=!0,Qe.push((async()=>{U(!0),z("Processing lab order edit...");try{const Y=d.sort((it,mt)=>new Date(mt.createdAt).getTime()-new Date(it.createdAt).getTime()).find(it=>it.status==="pending");if(!Y)throw new Error("No pending lab orders found to edit.");const X=Y.id,Ne=J.tests,ke=J.items_to_remove,Ue=J.status;if(!Ne&&!ke&&!Ue)throw new Error("No tests, items to remove, or status provided for lab order edit.");if(Ue==="cancelled"){if(Y.report)throw new Error("Cannot delete lab order with an associated report. Please delete the report first.");await Me({type:"Lab Order",data:Y}),z("Success: Lab order cancelled and deleted!")}else{let it=[...Y.tests];if(Array.isArray(ke)&&ke.length>0&&(it=it.filter(Ve=>!ke.some(tt=>!!(tt.id&&String(Ve.id)===String(tt.id)||tt.name&&Ve.name.toLowerCase()===tt.name.toLowerCase())))),Array.isArray(Ne)&&Ne.length>0)for(const Ve of Ne){let tt;if(Ve.id?tt=v.find(bt=>String(bt.id)===String(Ve.id)):Ve.name&&(tt=Jm(Ve.name,v)),!tt)throw new Error(`Lab test "${Ve.name||Ve.id||"Unknown"}" not found or no close match for update.`);const Le=typeof tt.price=="string"?parseFloat(tt.price):tt.price,ot=it.findIndex(bt=>bt.id&&String(bt.id)===String(tt==null?void 0:tt.id)||bt.name.toLowerCase()===(tt==null?void 0:tt.name.toLowerCase())),et={id:tt.id,name:tt.name,price:Le};ot!==-1?it[ot]={...it[ot],...et}:it.push(et)}const mt={};if(it.length>0?mt.tests=it:Ne&&Ne.length>0&&(mt.tests=[]),Ue){if(!["pending","billed","collected","processing","report_ready","completed","cancelled","reported"].includes(Ue))throw new Error(`Invalid status for lab order: ${Ue}.`);mt.status=Ue}const ht=await ge(`/api/lab/orders/${X}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(mt)});if(!ht.ok){const Ve=await ht.json().catch(()=>({}));throw new Error(Ve.message||`AI lab order edit failed: ${ht.statusText}`)}z("Success: Lab order updated!"),n&&(M(n),pe(n))}}catch(Y){await Ce(J.action,Y,Ie,Ge)}finally{U(!1)}})())):J.action==="add_complaint_history"&&J.complaint?(ze=!0,Qe.push((async()=>{V(!0),L("Processing Hx...");try{if(!e)throw new Error("Missing Record ID for complaint history.");if(!J.complaint||typeof J.complaint!="string")throw new Error("Invalid AI complaint text.");const Y={complaint:J.complaint.trim()},X=await ge(`/api/queue/doctor/complaint/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Y)});if(!X.ok){const Ne=await X.json().catch(()=>({}));throw new Error(Ne.message||`AI complaint add failed: ${X.statusText}`)}S(Y.complaint),L("Hx updated!"),n&&be(n)}catch(Y){await Ce(J.action,Y,Ie,Ge)}finally{V(!1)}})())):J.action==="update_case_summary"&&J.summary?(ze=!0,Qe.push((async()=>{$(!0),H("Processing summary...");try{if(!e)throw new Error("Missing Record ID for case summary update.");if(typeof J.summary!="string")throw new Error("Invalid AI case summary text.");const Y={case_summary:J.summary.trim()},X=await ge(`/api/queue/doctor/complaint/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Y)});if(!X.ok){const ke=await X.json().catch(()=>({}));throw new Error(ke.message||`AI case summary update failed: ${X.statusText}`)}const Ne=await X.json();ee(Ne.case_summary),te(Ne.updatedAt),H("Summary updated!")}catch(Y){await Ce(J.action,Y,Ie,Ge)}finally{$(!1)}})())):J.action&&console.warn(`Unrecognized AI action: ${J.action}`)}if(await Promise.allSettled(Qe),Be)typeof Be.question=="string"?(B(Be.question),K(Array.isArray(Be.options)?Be.options:[])):console.warn("Invalid 'ask_followup_question' format.");else if(!ze)throw new Error("AI response did not result in a recognized or performed function call.")}catch(ve){await Ce("parse_json_actions",ve,Ie,Ge)}else throw new Error("AI response did not contain a recognized function call.")};Fe=async(Ie,Ge=0)=>{if(Ge>1){q("AI call failed after multiple retries. Please try a different prompt."),D(!1);return}D(!0),q(null);let ze;const jt=[...l,Ie].join(`

`);try{const xt=new Map;(d??[]).forEach(X=>{xt.set(X.id,{...X})}),(u??[]).forEach(X=>{if(!xt.has(X.id))xt.set(X.id,{id:X.id,patient_id:X.patient_id,tests:X.tests,status:X.status,createdAt:X.createdAt,report:X});else{const Ne=xt.get(X.id);Ne&&(Ne.report=X,Ne.status=X.status)}});const ve=Array.from(xt.values());ve.sort((X,Ne)=>new Date(Ne.createdAt).getTime()-new Date(X.createdAt).getTime());const qe=ve.map((X,Ne)=>{let ke=null;if(X.report)try{const Ue=typeof X.report.report_content=="string"?X.report.report_content:JSON.stringify(X.report.report_content||{}),it=JSON.parse(Ue||"{}"),mt=(X.report.tests||[]).map(ht=>{const Ve=it[ht.id]||{},tt=Le=>({name:Le.name,value:Ve[Le.name]!==void 0?String(Ve[Le.name]):String(Le.defaultValue),normal_range:Le.normal_range||"N/A"});return{testId:ht.id,testName:ht.name,parameters:(ht.default_parameters||[]).map(tt)}});ke={reportId:X.report.reportId,reportDate:X.report.report_date,tests:mt}}catch{ke={reportId:X.report.reportId,reportDate:X.report.report_date,reportContent:typeof X.report.report_content=="string"?X.report.report_content:JSON.stringify(X.report.report_content),error:"Failed to parse report content JSON."}}return{serialNumber:ve.length-Ne,orderId:X.id,orderDate:isNaN(new Date(X.createdAt).getTime())?X.createdAt:new Date(X.createdAt).toISOString(),tests:X.tests.map(Ue=>({id:Ue.id,name:Ue.name,price:Ue.price})),status:X.status,report:ke}}),Qe=h.map(X=>{try{return{...X,createdAt:isNaN(new Date(X.createdAt).getTime())?X.createdAt:new Date(X.createdAt).toISOString()}}catch{return X}}),J=[...g].sort((X,Ne)=>{const ke=new Date(X.date).getTime(),Ue=new Date(Ne.date).getTime();return ke-Ue}).map((X,Ne)=>{try{return{serialNumber:Ne+1,...X,date:X.date&&!isNaN(new Date(X.date).getTime())?new Date(X.date).toISOString():X.date}}catch{return{serialNumber:Ne+1,...X}}}),Y={query:jt,currentDateTime:new Date().toISOString(),patientName:(t==null?void 0:t.name)||"",patientAge:(t==null?void 0:t.age)||void 0,patientGender:(t==null?void 0:t.gender)||void 0,case_summary:r||"",case_summary_last_updated:a?new Date(a).toISOString():void 0,clinic_ai_memory:(s==null?void 0:s.aiMemory)||"",clinic_ai_memory_last_updated:s!=null&&s.aiMemoryUpdatedAt?new Date(s.aiMemoryUpdatedAt).toISOString():void 0,clinic_wide_system_prompt:(s==null?void 0:s.clinicWideSystemPrompt)||"",labHistory:qe,pharmacyOrders:J,pastComplaints:Qe,pharmacyInventory:b,labInventory:v};if(console.log("DEBUG: Payload before sending to Gemini API:",JSON.stringify(Y,null,2)),ze=await UJ(Y,f),ze){k(ze);const X=/```json\s*([\s\S]*?)\s*```/,Ne=ze.match(X);if(Ne&&Ne[1])E(ze.replace(X,"").trim()),T(Ne[1].trim());else{const ke=ze.trim();if(ke.startsWith("{")&&ke.endsWith("}"))try{JSON.parse(ke),E(""),T(ke)}catch{E(ke),T(null)}else if(ke.startsWith("[")&&ke.endsWith("]"))try{JSON.parse(ke),E(""),T(ke)}catch{E(ke),T(null)}else E(ke),T(null)}I(!1),n&&ze&&await xe(n,ze),await Re(ze,Ge),S("")}else throw new Error("Invalid AI response format.")}catch(xt){await Ce("call_generative_api",xt,ze,Ge)}finally{D(!1)}};const xe=async(Ie,Ge)=>{A(!0),se(null);try{const ze={ai_response:Ge},nt=await ge(`/api/patients/${Ie}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ze)});if(!nt.ok){const jt=await nt.json().catch(()=>({}));throw new Error(jt.message||`Failed to save AI response to patient: ${nt.statusText}`)}}catch(ze){se(`AI Response Save Error: ${ze.message}`)}finally{A(!1)}};return w.useImperativeHandle(Ze,()=>({callGenerativeApi:Fe})),null}),VJ={};function pS(e,n){const t=VJ,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return IT(e,r,a)}function IT(e,n,t){if(HJ(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return a_(e.children,n,t)}return Array.isArray(e)?a_(e,n,t):""}function a_(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=IT(e[a],n,t);return r.join("")}function HJ(e){return!!(e&&typeof e=="object")}const s_=document.createElement("i");function mS(e){const n="&"+e+";";s_.innerHTML=n;const t=s_.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function qo(e,n,t,r){const a=e.length;let s=0,l;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)l=Array.from(r),l.unshift(n,t),e.splice(...l);else for(t&&e.splice(n,t);s<r.length;)l=r.slice(s,s+1e4),l.unshift(n,0),e.splice(...l),s+=1e4,n+=1e4}function os(e,n){return e.length>0?(qo(e,e.length,0,n),e):n}const o_={}.hasOwnProperty;function GJ(e){const n={};let t=-1;for(;++t<e.length;)YJ(n,e[t]);return n}function YJ(e,n){let t;for(t in n){const a=(o_.call(e,t)?e[t]:void 0)||(e[t]={}),s=n[t];let l;if(s)for(l in s){o_.call(a,l)||(a[l]=[]);const f=s[l];WJ(a[l],Array.isArray(f)?f:f?[f]:[])}}}function WJ(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);qo(e,0,0,r)}function MT(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function Ih(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Fo=eu(/[A-Za-z]/),Ra=eu(/[\dA-Za-z]/),QJ=eu(/[#-'*+\--9=?A-Z^-~]/);function nw(e){return e!==null&&(e<32||e===127)}const rw=eu(/\d/),JJ=eu(/[\dA-Fa-f]/),KJ=eu(/[!-/:-@[-`{-~]/);function Lt(e){return e!==null&&e<-2}function oa(e){return e!==null&&(e<0||e===32)}function Cn(e){return e===-2||e===-1||e===32}const XJ=eu(new RegExp("\\p{P}|\\p{S}","u")),ZJ=eu(/\s/);function eu(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function Kh(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const s=e.charCodeAt(t);let l="";if(s===37&&Ra(e.charCodeAt(t+1))&&Ra(e.charCodeAt(t+2)))a=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(l=String.fromCharCode(s));else if(s>55295&&s<57344){const f=e.charCodeAt(t+1);s<56320&&f>56319&&f<57344?(l=String.fromCharCode(s,f),a=1):l=""}else l=String.fromCharCode(s);l&&(n.push(e.slice(r,t),encodeURIComponent(l)),r=t+a+1,l=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function Kn(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let s=0;return l;function l(d){return Cn(d)?(e.enter(t),f(d)):n(d)}function f(d){return Cn(d)&&s++<a?(e.consume(d),f):(e.exit(t),n(d))}}const eK={tokenize:tK};function tK(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(f){if(f===null){e.consume(f);return}return e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),Kn(e,n,"linePrefix")}function a(f){return e.enter("paragraph"),s(f)}function s(f){const d=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=d),t=d,l(f)}function l(f){if(f===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(f);return}return Lt(f)?(e.consume(f),e.exit("chunkText"),s):(e.consume(f),l)}}const nK={tokenize:rK},l_={tokenize:iK};function rK(e){const n=this,t=[];let r=0,a,s,l;return f;function f(D){if(r<t.length){const q=t[r];return n.containerState=q[1],e.attempt(q[0].continuation,d,u)(D)}return u(D)}function d(D){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&I();const q=n.events.length;let R=q,F;for(;R--;)if(n.events[R][0]==="exit"&&n.events[R][1].type==="chunkFlow"){F=n.events[R][1].end;break}T(r);let U=q;for(;U<n.events.length;)n.events[U][1].end={...F},U++;return qo(n.events,R+1,0,n.events.slice(q)),n.events.length=U,u(D)}return f(D)}function u(D){if(r===t.length){if(!a)return b(D);if(a.currentConstruct&&a.currentConstruct.concrete)return S(D);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(l_,h,g)(D)}function h(D){return a&&I(),T(r),b(D)}function g(D){return n.parser.lazy[n.now().line]=r!==t.length,l=n.now().offset,S(D)}function b(D){return n.containerState={},e.attempt(l_,v,S)(D)}function v(D){return r++,t.push([n.currentConstruct,n.containerState]),b(D)}function S(D){if(D===null){a&&I(),T(0),e.consume(D);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:s}),k(D)}function k(D){if(D===null){E(e.exit("chunkFlow"),!0),T(0),e.consume(D);return}return Lt(D)?(e.consume(D),E(e.exit("chunkFlow")),r=0,n.interrupt=void 0,f):(e.consume(D),k)}function E(D,q){const R=n.sliceStream(D);if(q&&R.push(null),D.previous=s,s&&(s.next=D),s=D,a.defineSkip(D.start),a.write(R),n.parser.lazy[D.start.line]){let F=a.events.length;for(;F--;)if(a.events[F][1].start.offset<l&&(!a.events[F][1].end||a.events[F][1].end.offset>l))return;const U=n.events.length;let z=U,V,L;for(;z--;)if(n.events[z][0]==="exit"&&n.events[z][1].type==="chunkFlow"){if(V){L=n.events[z][1].end;break}V=!0}for(T(r),F=U;F<n.events.length;)n.events[F][1].end={...L},F++;qo(n.events,z+1,0,n.events.slice(U)),n.events.length=F}}function T(D){let q=t.length;for(;q-- >D;){const R=t[q];n.containerState=R[1],R[0].exit.call(n,e)}t.length=D}function I(){a.write([null]),s=void 0,a=void 0,n.containerState._closeFlow=void 0}}function iK(e,n,t){return Kn(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Db(e){if(e===null||oa(e)||ZJ(e))return 1;if(XJ(e))return 2}function gS(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const s=e[a].resolveAll;s&&!r.includes(s)&&(n=s(n,t),r.push(s))}return n}const iw={name:"attention",resolveAll:aK,tokenize:sK};function aK(e,n){let t=-1,r,a,s,l,f,d,u,h;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;d=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};c_(g,-d),c_(b,d),l={type:d>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},f={type:d>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},s={type:d>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:d>1?"strong":"emphasis",start:{...l.start},end:{...f.end}},e[r][1].end={...l.start},e[t][1].start={...f.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=os(u,[["enter",e[r][1],n],["exit",e[r][1],n]])),u=os(u,[["enter",a,n],["enter",l,n],["exit",l,n],["enter",s,n]]),u=os(u,gS(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),u=os(u,[["exit",s,n],["enter",f,n],["exit",f,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(h=2,u=os(u,[["enter",e[t][1],n],["exit",e[t][1],n]])):h=0,qo(e,r-1,t-r+3,u),t=r+u.length-h-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function sK(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=Db(r);let s;return l;function l(d){return s=d,e.enter("attentionSequence"),f(d)}function f(d){if(d===s)return e.consume(d),f;const u=e.exit("attentionSequence"),h=Db(d),g=!h||h===2&&a||t.includes(d),b=!a||a===2&&h||t.includes(r);return u._open=!!(s===42?g:g&&(a||!b)),u._close=!!(s===42?b:b&&(h||!g)),n(d)}}function c_(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const oK={name:"autolink",tokenize:lK};function lK(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),s}function s(v){return Fo(v)?(e.consume(v),l):v===64?t(v):u(v)}function l(v){return v===43||v===45||v===46||Ra(v)?(r=1,f(v)):u(v)}function f(v){return v===58?(e.consume(v),r=0,d):(v===43||v===45||v===46||Ra(v))&&r++<32?(e.consume(v),f):(r=0,u(v))}function d(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||nw(v)?t(v):(e.consume(v),d)}function u(v){return v===64?(e.consume(v),h):QJ(v)?(e.consume(v),u):t(v)}function h(v){return Ra(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,h):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||Ra(v))&&r++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const u0={partial:!0,tokenize:cK};function cK(e,n,t){return r;function r(s){return Cn(s)?Kn(e,a,"linePrefix")(s):a(s)}function a(s){return s===null||Lt(s)?n(s):t(s)}}const RT={continuation:{tokenize:dK},exit:fK,name:"blockQuote",tokenize:uK};function uK(e,n,t){const r=this;return a;function a(l){if(l===62){const f=r.containerState;return f.open||(e.enter("blockQuote",{_container:!0}),f.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),s}return t(l)}function s(l){return Cn(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(l))}}function dK(e,n,t){const r=this;return a;function a(l){return Cn(l)?Kn(e,s,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):s(l)}function s(l){return e.attempt(RT,n,t)(l)}}function fK(e){e.exit("blockQuote")}const OT={name:"characterEscape",tokenize:hK};function hK(e,n,t){return r;function r(s){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(s),e.exit("escapeMarker"),a}function a(s){return KJ(s)?(e.enter("characterEscapeValue"),e.consume(s),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(s)}}const LT={name:"characterReference",tokenize:pK};function pK(e,n,t){const r=this;let a=0,s,l;return f;function f(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),d}function d(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),s=31,l=Ra,h(g))}function u(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),s=6,l=JJ,h):(e.enter("characterReferenceValue"),s=7,l=rw,h(g))}function h(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return l===Ra&&!mS(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return l(g)&&a++<s?(e.consume(g),h):t(g)}}const u_={partial:!0,tokenize:gK},d_={concrete:!0,name:"codeFenced",tokenize:mK};function mK(e,n,t){const r=this,a={partial:!0,tokenize:R};let s=0,l=0,f;return d;function d(F){return u(F)}function u(F){const U=r.events[r.events.length-1];return s=U&&U[1].type==="linePrefix"?U[2].sliceSerialize(U[1],!0).length:0,f=F,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),h(F)}function h(F){return F===f?(l++,e.consume(F),h):l<3?t(F):(e.exit("codeFencedFenceSequence"),Cn(F)?Kn(e,g,"whitespace")(F):g(F))}function g(F){return F===null||Lt(F)?(e.exit("codeFencedFence"),r.interrupt?n(F):e.check(u_,k,q)(F)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b(F))}function b(F){return F===null||Lt(F)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g(F)):Cn(F)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Kn(e,v,"whitespace")(F)):F===96&&F===f?t(F):(e.consume(F),b)}function v(F){return F===null||Lt(F)?g(F):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S(F))}function S(F){return F===null||Lt(F)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g(F)):F===96&&F===f?t(F):(e.consume(F),S)}function k(F){return e.attempt(a,q,E)(F)}function E(F){return e.enter("lineEnding"),e.consume(F),e.exit("lineEnding"),T}function T(F){return s>0&&Cn(F)?Kn(e,I,"linePrefix",s+1)(F):I(F)}function I(F){return F===null||Lt(F)?e.check(u_,k,q)(F):(e.enter("codeFlowValue"),D(F))}function D(F){return F===null||Lt(F)?(e.exit("codeFlowValue"),I(F)):(e.consume(F),D)}function q(F){return e.exit("codeFenced"),n(F)}function R(F,U,z){let V=0;return L;function L(ae){return F.enter("lineEnding"),F.consume(ae),F.exit("lineEnding"),$}function $(ae){return F.enter("codeFencedFence"),Cn(ae)?Kn(F,H,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(ae):H(ae)}function H(ae){return ae===f?(F.enter("codeFencedFenceSequence"),ee(ae)):z(ae)}function ee(ae){return ae===f?(V++,F.consume(ae),ee):V>=l?(F.exit("codeFencedFenceSequence"),Cn(ae)?Kn(F,te,"whitespace")(ae):te(ae)):z(ae)}function te(ae){return ae===null||Lt(ae)?(F.exit("codeFencedFence"),U(ae)):z(ae)}}}function gK(e,n,t){const r=this;return a;function a(l){return l===null?t(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),s)}function s(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}const Xv={name:"codeIndented",tokenize:xK},yK={partial:!0,tokenize:bK};function xK(e,n,t){const r=this;return a;function a(u){return e.enter("codeIndented"),Kn(e,s,"linePrefix",5)(u)}function s(u){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?l(u):t(u)}function l(u){return u===null?d(u):Lt(u)?e.attempt(yK,l,d)(u):(e.enter("codeFlowValue"),f(u))}function f(u){return u===null||Lt(u)?(e.exit("codeFlowValue"),l(u)):(e.consume(u),f)}function d(u){return e.exit("codeIndented"),n(u)}}function bK(e,n,t){const r=this;return a;function a(l){return r.parser.lazy[r.now().line]?t(l):Lt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):Kn(e,s,"linePrefix",5)(l)}function s(l){const f=r.events[r.events.length-1];return f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?n(l):Lt(l)?a(l):t(l)}}const vK={name:"codeText",previous:SK,resolve:wK,tokenize:NK};function wK(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function SK(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function NK(e,n,t){let r=0,a,s;return l;function l(g){return e.enter("codeText"),e.enter("codeTextSequence"),f(g)}function f(g){return g===96?(e.consume(g),r++,f):(e.exit("codeTextSequence"),d(g))}function d(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),d):g===96?(s=e.enter("codeTextSequence"),a=0,h(g)):Lt(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),d):(e.enter("codeTextData"),u(g))}function u(g){return g===null||g===32||g===96||Lt(g)?(e.exit("codeTextData"),d(g)):(e.consume(g),u)}function h(g){return g===96?(e.consume(g),a++,h):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(s.type="codeTextData",u(g))}}class CK{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const s=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&Vm(this.left,r),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Vm(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Vm(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Vm(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Vm(this.left,t.reverse())}}}function Vm(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function FT(e){const n={};let t=-1,r,a,s,l,f,d,u;const h=new CK(e);for(;++t<h.length;){for(;t in n;)t=n[t];if(r=h.get(t),t&&r[1].type==="chunkFlow"&&h.get(t-1)[1].type==="listItemPrefix"&&(d=r[1]._tokenizer.events,s=0,s<d.length&&d[s][1].type==="lineEndingBlank"&&(s+=2),s<d.length&&d[s][1].type==="content"))for(;++s<d.length&&d[s][1].type!=="content";)d[s][1].type==="chunkText"&&(d[s][1]._isInFirstContentOfListItem=!0,s++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,jK(h,t)),t=n[t],u=!0);else if(r[1]._container){for(s=t,a=void 0;s--;)if(l=h.get(s),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(h.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=s);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(r[1].end={...h.get(a)[1].start},f=h.slice(a,t),f.unshift(r),h.splice(a,t-a+1,f))}}return qo(e,0,Number.POSITIVE_INFINITY,h.slice(0)),!u}function jK(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const s=[];let l=t._tokenizer;l||(l=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const f=l.events,d=[],u={};let h,g,b=-1,v=t,S=0,k=0;const E=[k];for(;v;){for(;e.get(++a)[1]!==v;);s.push(a),v._tokenizer||(h=r.sliceStream(v),v.next||h.push(null),g&&l.defineSkip(v.start),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(h),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<f.length;)f[b][0]==="exit"&&f[b-1][0]==="enter"&&f[b][1].type===f[b-1][1].type&&f[b][1].start.line!==f[b][1].end.line&&(k=b+1,E.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(l.events=[],v?(v._tokenizer=void 0,v.previous=void 0):E.pop(),b=E.length;b--;){const T=f.slice(E[b],E[b+1]),I=s.pop();d.push([I,I+T.length-1]),e.splice(I,2,T)}for(d.reverse(),b=-1;++b<d.length;)u[S+d[b][0]]=S+d[b][1],S+=d[b][1]-d[b][0]-1;return u}const _K={resolve:EK,tokenize:TK},kK={partial:!0,tokenize:AK};function EK(e){return FT(e),e}function TK(e,n){let t;return r;function r(f){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(f)}function a(f){return f===null?s(f):Lt(f)?e.check(kK,l,s)(f):(e.consume(f),a)}function s(f){return e.exit("chunkContent"),e.exit("content"),n(f)}function l(f){return e.consume(f),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function AK(e,n,t){const r=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),Kn(e,s,"linePrefix")}function s(l){if(l===null||Lt(l))return t(l);const f=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?n(l):e.interrupt(r.parser.constructs.flow,t,n)(l)}}function $T(e,n,t,r,a,s,l,f,d){const u=d||Number.POSITIVE_INFINITY;let h=0;return g;function g(T){return T===60?(e.enter(r),e.enter(a),e.enter(s),e.consume(T),e.exit(s),b):T===null||T===32||T===41||nw(T)?t(T):(e.enter(r),e.enter(l),e.enter(f),e.enter("chunkString",{contentType:"string"}),k(T))}function b(T){return T===62?(e.enter(s),e.consume(T),e.exit(s),e.exit(a),e.exit(r),n):(e.enter(f),e.enter("chunkString",{contentType:"string"}),v(T))}function v(T){return T===62?(e.exit("chunkString"),e.exit(f),b(T)):T===null||T===60||Lt(T)?t(T):(e.consume(T),T===92?S:v)}function S(T){return T===60||T===62||T===92?(e.consume(T),v):v(T)}function k(T){return!h&&(T===null||T===41||oa(T))?(e.exit("chunkString"),e.exit(f),e.exit(l),e.exit(r),n(T)):h<u&&T===40?(e.consume(T),h++,k):T===41?(e.consume(T),h--,k):T===null||T===32||T===40||nw(T)?t(T):(e.consume(T),T===92?E:k)}function E(T){return T===40||T===41||T===92?(e.consume(T),k):k(T)}}function zT(e,n,t,r,a,s){const l=this;let f=0,d;return u;function u(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(s),h}function h(v){return f>999||v===null||v===91||v===93&&!d||v===94&&!f&&"_hiddenFootnoteSupport"in l.parser.constructs?t(v):v===93?(e.exit(s),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):Lt(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),h):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||Lt(v)||f++>999?(e.exit("chunkString"),h(v)):(e.consume(v),d||(d=!Cn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),f++,g):g(v)}}function BT(e,n,t,r,a,s){let l;return f;function f(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),l=b===40?41:b,d):t(b)}function d(b){return b===l?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(s),u(b))}function u(b){return b===l?(e.exit(s),d(l)):b===null?t(b):Lt(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),Kn(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),h(b))}function h(b){return b===l||b===null||Lt(b)?(e.exit("chunkString"),u(b)):(e.consume(b),b===92?g:h)}function g(b){return b===l||b===92?(e.consume(b),h):h(b)}}function eg(e,n){let t;return r;function r(a){return Lt(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):Cn(a)?Kn(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const PK={name:"definition",tokenize:IK},DK={partial:!0,tokenize:MK};function IK(e,n,t){const r=this;let a;return s;function s(v){return e.enter("definition"),l(v)}function l(v){return zT.call(r,e,f,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function f(v){return a=Ih(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),d):t(v)}function d(v){return oa(v)?eg(e,u)(v):u(v)}function u(v){return $T(e,h,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function h(v){return e.attempt(DK,g,g)(v)}function g(v){return Cn(v)?Kn(e,b,"whitespace")(v):b(v)}function b(v){return v===null||Lt(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function MK(e,n,t){return r;function r(f){return oa(f)?eg(e,a)(f):t(f)}function a(f){return BT(e,s,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(f)}function s(f){return Cn(f)?Kn(e,l,"whitespace")(f):l(f)}function l(f){return f===null||Lt(f)?n(f):t(f)}}const RK={name:"hardBreakEscape",tokenize:OK};function OK(e,n,t){return r;function r(s){return e.enter("hardBreakEscape"),e.consume(s),a}function a(s){return Lt(s)?(e.exit("hardBreakEscape"),n(s)):t(s)}}const LK={name:"headingAtx",resolve:FK,tokenize:$K};function FK(e,n){let t=e.length-2,r=3,a,s;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},s={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},qo(e,r,t-r+1,[["enter",a,n],["enter",s,n],["exit",s,n],["exit",a,n]])),e}function $K(e,n,t){let r=0;return a;function a(h){return e.enter("atxHeading"),s(h)}function s(h){return e.enter("atxHeadingSequence"),l(h)}function l(h){return h===35&&r++<6?(e.consume(h),l):h===null||oa(h)?(e.exit("atxHeadingSequence"),f(h)):t(h)}function f(h){return h===35?(e.enter("atxHeadingSequence"),d(h)):h===null||Lt(h)?(e.exit("atxHeading"),n(h)):Cn(h)?Kn(e,f,"whitespace")(h):(e.enter("atxHeadingText"),u(h))}function d(h){return h===35?(e.consume(h),d):(e.exit("atxHeadingSequence"),f(h))}function u(h){return h===null||h===35||oa(h)?(e.exit("atxHeadingText"),f(h)):(e.consume(h),u)}}const zK=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],f_=["pre","script","style","textarea"],BK={concrete:!0,name:"htmlFlow",resolveTo:VK,tokenize:HK},UK={partial:!0,tokenize:YK},qK={partial:!0,tokenize:GK};function VK(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function HK(e,n,t){const r=this;let a,s,l,f,d;return u;function u(M){return h(M)}function h(M){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(M),g}function g(M){return M===33?(e.consume(M),b):M===47?(e.consume(M),s=!0,k):M===63?(e.consume(M),a=3,r.interrupt?n:A):Fo(M)?(e.consume(M),l=String.fromCharCode(M),E):t(M)}function b(M){return M===45?(e.consume(M),a=2,v):M===91?(e.consume(M),a=5,f=0,S):Fo(M)?(e.consume(M),a=4,r.interrupt?n:A):t(M)}function v(M){return M===45?(e.consume(M),r.interrupt?n:A):t(M)}function S(M){const pe="CDATA[";return M===pe.charCodeAt(f++)?(e.consume(M),f===pe.length?r.interrupt?n:H:S):t(M)}function k(M){return Fo(M)?(e.consume(M),l=String.fromCharCode(M),E):t(M)}function E(M){if(M===null||M===47||M===62||oa(M)){const pe=M===47,be=l.toLowerCase();return!pe&&!s&&f_.includes(be)?(a=1,r.interrupt?n(M):H(M)):zK.includes(l.toLowerCase())?(a=6,pe?(e.consume(M),T):r.interrupt?n(M):H(M)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(M):s?I(M):D(M))}return M===45||Ra(M)?(e.consume(M),l+=String.fromCharCode(M),E):t(M)}function T(M){return M===62?(e.consume(M),r.interrupt?n:H):t(M)}function I(M){return Cn(M)?(e.consume(M),I):L(M)}function D(M){return M===47?(e.consume(M),L):M===58||M===95||Fo(M)?(e.consume(M),q):Cn(M)?(e.consume(M),D):L(M)}function q(M){return M===45||M===46||M===58||M===95||Ra(M)?(e.consume(M),q):R(M)}function R(M){return M===61?(e.consume(M),F):Cn(M)?(e.consume(M),R):D(M)}function F(M){return M===null||M===60||M===61||M===62||M===96?t(M):M===34||M===39?(e.consume(M),d=M,U):Cn(M)?(e.consume(M),F):z(M)}function U(M){return M===d?(e.consume(M),d=null,V):M===null||Lt(M)?t(M):(e.consume(M),U)}function z(M){return M===null||M===34||M===39||M===47||M===60||M===61||M===62||M===96||oa(M)?R(M):(e.consume(M),z)}function V(M){return M===47||M===62||Cn(M)?D(M):t(M)}function L(M){return M===62?(e.consume(M),$):t(M)}function $(M){return M===null||Lt(M)?H(M):Cn(M)?(e.consume(M),$):t(M)}function H(M){return M===45&&a===2?(e.consume(M),Z):M===60&&a===1?(e.consume(M),B):M===62&&a===4?(e.consume(M),se):M===63&&a===3?(e.consume(M),A):M===93&&a===5?(e.consume(M),oe):Lt(M)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(UK,ue,ee)(M)):M===null||Lt(M)?(e.exit("htmlFlowData"),ee(M)):(e.consume(M),H)}function ee(M){return e.check(qK,te,ue)(M)}function te(M){return e.enter("lineEnding"),e.consume(M),e.exit("lineEnding"),ae}function ae(M){return M===null||Lt(M)?ee(M):(e.enter("htmlFlowData"),H(M))}function Z(M){return M===45?(e.consume(M),A):H(M)}function B(M){return M===47?(e.consume(M),l="",K):H(M)}function K(M){if(M===62){const pe=l.toLowerCase();return f_.includes(pe)?(e.consume(M),se):H(M)}return Fo(M)&&l.length<8?(e.consume(M),l+=String.fromCharCode(M),K):H(M)}function oe(M){return M===93?(e.consume(M),A):H(M)}function A(M){return M===62?(e.consume(M),se):M===45&&a===2?(e.consume(M),A):H(M)}function se(M){return M===null||Lt(M)?(e.exit("htmlFlowData"),ue(M)):(e.consume(M),se)}function ue(M){return e.exit("htmlFlow"),n(M)}}function GK(e,n,t){const r=this;return a;function a(l){return Lt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),s):t(l)}function s(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}function YK(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(u0,n,t)}}const WK={name:"htmlText",tokenize:QK};function QK(e,n,t){const r=this;let a,s,l;return f;function f(A){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(A),d}function d(A){return A===33?(e.consume(A),u):A===47?(e.consume(A),R):A===63?(e.consume(A),D):Fo(A)?(e.consume(A),z):t(A)}function u(A){return A===45?(e.consume(A),h):A===91?(e.consume(A),s=0,S):Fo(A)?(e.consume(A),I):t(A)}function h(A){return A===45?(e.consume(A),v):t(A)}function g(A){return A===null?t(A):A===45?(e.consume(A),b):Lt(A)?(l=g,B(A)):(e.consume(A),g)}function b(A){return A===45?(e.consume(A),v):g(A)}function v(A){return A===62?Z(A):A===45?b(A):g(A)}function S(A){const se="CDATA[";return A===se.charCodeAt(s++)?(e.consume(A),s===se.length?k:S):t(A)}function k(A){return A===null?t(A):A===93?(e.consume(A),E):Lt(A)?(l=k,B(A)):(e.consume(A),k)}function E(A){return A===93?(e.consume(A),T):k(A)}function T(A){return A===62?Z(A):A===93?(e.consume(A),T):k(A)}function I(A){return A===null||A===62?Z(A):Lt(A)?(l=I,B(A)):(e.consume(A),I)}function D(A){return A===null?t(A):A===63?(e.consume(A),q):Lt(A)?(l=D,B(A)):(e.consume(A),D)}function q(A){return A===62?Z(A):D(A)}function R(A){return Fo(A)?(e.consume(A),F):t(A)}function F(A){return A===45||Ra(A)?(e.consume(A),F):U(A)}function U(A){return Lt(A)?(l=U,B(A)):Cn(A)?(e.consume(A),U):Z(A)}function z(A){return A===45||Ra(A)?(e.consume(A),z):A===47||A===62||oa(A)?V(A):t(A)}function V(A){return A===47?(e.consume(A),Z):A===58||A===95||Fo(A)?(e.consume(A),L):Lt(A)?(l=V,B(A)):Cn(A)?(e.consume(A),V):Z(A)}function L(A){return A===45||A===46||A===58||A===95||Ra(A)?(e.consume(A),L):$(A)}function $(A){return A===61?(e.consume(A),H):Lt(A)?(l=$,B(A)):Cn(A)?(e.consume(A),$):V(A)}function H(A){return A===null||A===60||A===61||A===62||A===96?t(A):A===34||A===39?(e.consume(A),a=A,ee):Lt(A)?(l=H,B(A)):Cn(A)?(e.consume(A),H):(e.consume(A),te)}function ee(A){return A===a?(e.consume(A),a=void 0,ae):A===null?t(A):Lt(A)?(l=ee,B(A)):(e.consume(A),ee)}function te(A){return A===null||A===34||A===39||A===60||A===61||A===96?t(A):A===47||A===62||oa(A)?V(A):(e.consume(A),te)}function ae(A){return A===47||A===62||oa(A)?V(A):t(A)}function Z(A){return A===62?(e.consume(A),e.exit("htmlTextData"),e.exit("htmlText"),n):t(A)}function B(A){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(A),e.exit("lineEnding"),K}function K(A){return Cn(A)?Kn(e,oe,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(A):oe(A)}function oe(A){return e.enter("htmlTextData"),l(A)}}const yS={name:"labelEnd",resolveAll:ZK,resolveTo:eX,tokenize:tX},JK={tokenize:nX},KK={tokenize:rX},XK={tokenize:iX};function ZK(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&qo(e,0,e.length,t),e}function eX(e,n){let t=e.length,r=0,a,s,l,f;for(;t--;)if(a=e[t][1],s){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(s=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(l=t);const d={type:e[s][1].type==="labelLink"?"link":"image",start:{...e[s][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[s][1].start},end:{...e[l][1].end}},h={type:"labelText",start:{...e[s+r+2][1].end},end:{...e[l-2][1].start}};return f=[["enter",d,n],["enter",u,n]],f=os(f,e.slice(s+1,s+r+3)),f=os(f,[["enter",h,n]]),f=os(f,gS(n.parser.constructs.insideSpan.null,e.slice(s+r+4,l-3),n)),f=os(f,[["exit",h,n],e[l-2],e[l-1],["exit",u,n]]),f=os(f,e.slice(l+1)),f=os(f,[["exit",d,n]]),qo(e,s,e.length,f),e}function tX(e,n,t){const r=this;let a=r.events.length,s,l;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){s=r.events[a][1];break}return f;function f(b){return s?s._inactive?g(b):(l=r.parser.defined.includes(Ih(r.sliceSerialize({start:s.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),d):t(b)}function d(b){return b===40?e.attempt(JK,h,l?h:g)(b):b===91?e.attempt(KK,h,l?u:g)(b):l?h(b):g(b)}function u(b){return e.attempt(XK,h,g)(b)}function h(b){return n(b)}function g(b){return s._balanced=!0,t(b)}}function nX(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return oa(g)?eg(e,s)(g):s(g)}function s(g){return g===41?h(g):$T(e,l,f,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function l(g){return oa(g)?eg(e,d)(g):h(g)}function f(g){return t(g)}function d(g){return g===34||g===39||g===40?BT(e,u,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):h(g)}function u(g){return oa(g)?eg(e,h)(g):h(g)}function h(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function rX(e,n,t){const r=this;return a;function a(f){return zT.call(r,e,s,l,"reference","referenceMarker","referenceString")(f)}function s(f){return r.parser.defined.includes(Ih(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(f):t(f)}function l(f){return t(f)}}function iX(e,n,t){return r;function r(s){return e.enter("reference"),e.enter("referenceMarker"),e.consume(s),e.exit("referenceMarker"),a}function a(s){return s===93?(e.enter("referenceMarker"),e.consume(s),e.exit("referenceMarker"),e.exit("reference"),n):t(s)}}const aX={name:"labelStartImage",resolveAll:yS.resolveAll,tokenize:sX};function sX(e,n,t){const r=this;return a;function a(f){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(f),e.exit("labelImageMarker"),s}function s(f){return f===91?(e.enter("labelMarker"),e.consume(f),e.exit("labelMarker"),e.exit("labelImage"),l):t(f)}function l(f){return f===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(f):n(f)}}const oX={name:"labelStartLink",resolveAll:yS.resolveAll,tokenize:lX};function lX(e,n,t){const r=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),s}function s(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(l):n(l)}}const Zv={name:"lineEnding",tokenize:cX};function cX(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),Kn(e,n,"linePrefix")}}const ib={name:"thematicBreak",tokenize:uX};function uX(e,n,t){let r=0,a;return s;function s(u){return e.enter("thematicBreak"),l(u)}function l(u){return a=u,f(u)}function f(u){return u===a?(e.enter("thematicBreakSequence"),d(u)):r>=3&&(u===null||Lt(u))?(e.exit("thematicBreak"),n(u)):t(u)}function d(u){return u===a?(e.consume(u),r++,d):(e.exit("thematicBreakSequence"),Cn(u)?Kn(e,f,"whitespace")(u):f(u))}}const ra={continuation:{tokenize:pX},exit:gX,name:"list",tokenize:hX},dX={partial:!0,tokenize:yX},fX={partial:!0,tokenize:mX};function hX(e,n,t){const r=this,a=r.events[r.events.length-1];let s=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return f;function f(v){const S=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:rw(v)){if(r.containerState.type||(r.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(ib,t,u)(v):u(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),d(v)}return t(v)}function d(v){return rw(v)&&++l<10?(e.consume(v),d):(!r.interrupt||l<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),u(v)):t(v)}function u(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(u0,r.interrupt?t:h,e.attempt(dX,b,g))}function h(v){return r.containerState.initialBlankLine=!0,s++,b(v)}function g(v){return Cn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=s+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function pX(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(u0,a,s);function a(f){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,Kn(e,n,"listItemIndent",r.containerState.size+1)(f)}function s(f){return r.containerState.furtherBlankLines||!Cn(f)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,l(f)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(fX,n,l)(f))}function l(f){return r.containerState._closeFlow=!0,r.interrupt=void 0,Kn(e,e.attempt(ra,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(f)}}function mX(e,n,t){const r=this;return Kn(e,a,"listItemIndent",r.containerState.size+1);function a(s){const l=r.events[r.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===r.containerState.size?n(s):t(s)}}function gX(e){e.exit(this.containerState.type)}function yX(e,n,t){const r=this;return Kn(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(s){const l=r.events[r.events.length-1];return!Cn(s)&&l&&l[1].type==="listItemPrefixWhitespace"?n(s):t(s)}}const h_={name:"setextUnderline",resolveTo:xX,tokenize:bX};function xX(e,n){let t=e.length,r,a,s;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!s&&e[t][1].type==="definition"&&(s=t);const l={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",s?(e.splice(a,0,["enter",l,n]),e.splice(s+1,0,["exit",e[r][1],n]),e[r][1].end={...e[s][1].end}):e[r][1]=l,e.push(["exit",l,n]),e}function bX(e,n,t){const r=this;let a;return s;function s(u){let h=r.events.length,g;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){g=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=u,l(u)):t(u)}function l(u){return e.enter("setextHeadingLineSequence"),f(u)}function f(u){return u===a?(e.consume(u),f):(e.exit("setextHeadingLineSequence"),Cn(u)?Kn(e,d,"lineSuffix")(u):d(u))}function d(u){return u===null||Lt(u)?(e.exit("setextHeadingLine"),n(u)):t(u)}}const vX={tokenize:wX};function wX(e){const n=this,t=e.attempt(u0,r,e.attempt(this.parser.constructs.flowInitial,a,Kn(e,e.attempt(this.parser.constructs.flow,a,e.attempt(_K,a)),"linePrefix")));return t;function r(s){if(s===null){e.consume(s);return}return e.enter("lineEndingBlank"),e.consume(s),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(s){if(s===null){e.consume(s);return}return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const SX={resolveAll:qT()},NX=UT("string"),CX=UT("text");function UT(e){return{resolveAll:qT(e==="text"?jX:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],s=t.attempt(a,l,f);return l;function l(h){return u(h)?s(h):f(h)}function f(h){if(h===null){t.consume(h);return}return t.enter("data"),t.consume(h),d}function d(h){return u(h)?(t.exit("data"),s(h)):(t.consume(h),d)}function u(h){if(h===null)return!0;const g=a[h];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function qT(e){return n;function n(t,r){let a=-1,s;for(;++a<=t.length;)s===void 0?t[a]&&t[a][1].type==="data"&&(s=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==s+2&&(t[s][1].end=t[a-1][1].end,t.splice(s+2,a-s-2),a=s+2),s=void 0);return e?e(t,r):t}}function jX(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let s=a.length,l=-1,f=0,d;for(;s--;){const u=a[s];if(typeof u=="string"){for(l=u.length;u.charCodeAt(l-1)===32;)f++,l--;if(l)break;l=-1}else if(u===-2)d=!0,f++;else if(u!==-1){s++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(f=0),f){const u={type:t===e.length||d||f<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?l:r.start._bufferIndex+l,_index:r.start._index+s,line:r.end.line,column:r.end.column-f,offset:r.end.offset-f},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(t,0,["enter",u,n],["exit",u,n]),t+=2)}t++}return e}const _X={42:ra,43:ra,45:ra,48:ra,49:ra,50:ra,51:ra,52:ra,53:ra,54:ra,55:ra,56:ra,57:ra,62:RT},kX={91:PK},EX={[-2]:Xv,[-1]:Xv,32:Xv},TX={35:LK,42:ib,45:[h_,ib],60:BK,61:h_,95:ib,96:d_,126:d_},AX={38:LT,92:OT},PX={[-5]:Zv,[-4]:Zv,[-3]:Zv,33:aX,38:LT,42:iw,60:[oK,WK],91:oX,92:[RK,OT],93:yS,95:iw,96:vK},DX={null:[iw,SX]},IX={null:[42,95]},MX={null:[]},RX=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:IX,contentInitial:kX,disable:MX,document:_X,flow:TX,flowInitial:EX,insideSpan:DX,string:AX,text:PX},Symbol.toStringTag,{value:"Module"}));function OX(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},s=[];let l=[],f=[];const d={attempt:U(R),check:U(F),consume:I,enter:D,exit:q,interrupt:U(F,{interrupt:!0})},u={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let h=n.tokenize.call(u,d);return n.resolveAll&&s.push(n),u;function g($){return l=os(l,$),E(),l[l.length-1]!==null?[]:(z(n,0),u.events=gS(s,u.events,u),u.events)}function b($,H){return FX(v($),H)}function v($){return LX(l,$)}function S(){const{_bufferIndex:$,_index:H,line:ee,column:te,offset:ae}=r;return{_bufferIndex:$,_index:H,line:ee,column:te,offset:ae}}function k($){a[$.line]=$.column,L()}function E(){let $;for(;r._index<l.length;){const H=l[r._index];if(typeof H=="string")for($=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===$&&r._bufferIndex<H.length;)T(H.charCodeAt(r._bufferIndex));else T(H)}}function T($){h=h($)}function I($){Lt($)?(r.line++,r.column=1,r.offset+=$===-3?2:1,L()):$!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===l[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=$}function D($,H){const ee=H||{};return ee.type=$,ee.start=S(),u.events.push(["enter",ee,u]),f.push(ee),ee}function q($){const H=f.pop();return H.end=S(),u.events.push(["exit",H,u]),H}function R($,H){z($,H.from)}function F($,H){H.restore()}function U($,H){return ee;function ee(te,ae,Z){let B,K,oe,A;return Array.isArray(te)?ue(te):"tokenize"in te?ue([te]):se(te);function se(fe){return Pe;function Pe(de){const Me=de!==null&&fe[de],Ze=de!==null&&fe.null,Fe=[...Array.isArray(Me)?Me:Me?[Me]:[],...Array.isArray(Ze)?Ze:Ze?[Ze]:[]];return ue(Fe)(de)}}function ue(fe){return B=fe,K=0,fe.length===0?Z:M(fe[K])}function M(fe){return Pe;function Pe(de){return A=V(),oe=fe,fe.partial||(u.currentConstruct=fe),fe.name&&u.parser.constructs.disable.null.includes(fe.name)?be():fe.tokenize.call(H?Object.assign(Object.create(u),H):u,d,pe,be)(de)}}function pe(fe){return $(oe,A),ae}function be(fe){return A.restore(),++K<B.length?M(B[K]):Z}}}function z($,H){$.resolveAll&&!s.includes($)&&s.push($),$.resolve&&qo(u.events,H,u.events.length-H,$.resolve(u.events.slice(H),u)),$.resolveTo&&(u.events=$.resolveTo(u.events,u))}function V(){const $=S(),H=u.previous,ee=u.currentConstruct,te=u.events.length,ae=Array.from(f);return{from:te,restore:Z};function Z(){r=$,u.previous=H,u.currentConstruct=ee,u.events.length=te,f=ae,L()}}function L(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function LX(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,s=n.end._bufferIndex;let l;if(t===a)l=[e[t].slice(r,s)];else{if(l=e.slice(t,a),r>-1){const f=l[0];typeof f=="string"?l[0]=f.slice(r):l.shift()}s>0&&l.push(e[a].slice(0,s))}return l}function FX(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const s=e[t];let l;if(typeof s=="string")l=s;else switch(s){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=n?" ":"	";break}case-1:{if(!n&&a)continue;l=" ";break}default:l=String.fromCharCode(s)}a=s===-2,r.push(l)}return r.join("")}function $X(e){const r={constructs:GJ([RX,...(e||{}).extensions||[]]),content:a(eK),defined:[],document:a(nK),flow:a(vX),lazy:{},string:a(NX),text:a(CX)};return r;function a(s){return l;function l(f){return OX(r,s,f)}}}function zX(e){for(;!FT(e););return e}const p_=/[\0\t\n\r]/g;function BX(){let e=1,n="",t=!0,r;return a;function a(s,l,f){const d=[];let u,h,g,b,v;for(s=n+(typeof s=="string"?s.toString():new TextDecoder(l||void 0).decode(s)),g=0,n="",t&&(s.charCodeAt(0)===65279&&g++,t=void 0);g<s.length;){if(p_.lastIndex=g,u=p_.exec(s),b=u&&u.index!==void 0?u.index:s.length,v=s.charCodeAt(b),!u){n=s.slice(g);break}if(v===10&&g===b&&r)d.push(-3),r=void 0;else switch(r&&(d.push(-5),r=void 0),g<b&&(d.push(s.slice(g,b)),e+=b-g),v){case 0:{d.push(65533),e++;break}case 9:{for(h=Math.ceil(e/4)*4,d.push(-2);e++<h;)d.push(-1);break}case 10:{d.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return f&&(r&&d.push(-5),n&&d.push(n),d.push(null)),d}}const UX=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function VT(e){return e.replace(UX,qX)}function qX(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),s=a===120||a===88;return MT(t.slice(s?2:1),s?16:10)}return mS(t)||e}function tg(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?m_(e.position):"start"in e||"end"in e?m_(e):"line"in e||"column"in e?aw(e):""}function aw(e){return g_(e&&e.line)+":"+g_(e&&e.column)}function m_(e){return aw(e&&e.start)+"-"+aw(e&&e.end)}function g_(e){return e&&typeof e=="number"?e:1}const HT={}.hasOwnProperty;function VX(e,n,t){return typeof n!="string"&&(t=n,n=void 0),HX(t)(zX($X(t).document().write(BX()(e,n,!0))))}function HX(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(jt),autolinkProtocol:V,autolinkEmail:V,atxHeading:s(Ie),blockQuote:s(Ze),characterEscape:V,characterReference:V,codeFenced:s(Fe),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:s(Fe,l),codeText:s(Ce,l),codeTextData:V,data:V,codeFlowValue:V,definition:s(Re),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:s(xe),hardBreakEscape:s(Ge),hardBreakTrailing:s(Ge),htmlFlow:s(ze,l),htmlFlowData:V,htmlText:s(ze,l),htmlTextData:V,image:s(nt),label:l,link:s(jt),listItem:s(ve),listItemValue:b,listOrdered:s(xt,g),listUnordered:s(xt),paragraph:s(qe),reference:M,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:s(Ie),strong:s(Qe),thematicBreak:s(J)},exit:{atxHeading:d(),atxHeadingSequence:R,autolink:d(),autolinkEmail:Me,autolinkProtocol:de,blockQuote:d(),characterEscapeValue:L,characterReferenceMarkerHexadecimal:be,characterReferenceMarkerNumeric:be,characterReferenceValue:fe,characterReference:Pe,codeFenced:d(E),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:L,codeIndented:d(T),codeText:d(ae),codeTextData:L,data:L,definition:d(),definitionDestinationString:q,definitionLabelString:I,definitionTitleString:D,emphasis:d(),hardBreakEscape:d(H),hardBreakTrailing:d(H),htmlFlow:d(ee),htmlFlowData:L,htmlText:d(te),htmlTextData:L,image:d(B),label:oe,labelText:K,lineEnding:$,link:d(Z),listItem:d(),listOrdered:d(),listUnordered:d(),paragraph:d(),referenceString:pe,resourceDestinationString:A,resourceTitleString:se,resource:ue,setextHeading:d(z),setextHeadingLineSequence:U,setextHeadingText:F,strong:d(),thematicBreak:d()}};GT(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(Y){let X={type:"root",children:[]};const Ne={stack:[X],tokenStack:[],config:n,enter:f,exit:u,buffer:l,resume:h,data:t},ke=[];let Ue=-1;for(;++Ue<Y.length;)if(Y[Ue][1].type==="listOrdered"||Y[Ue][1].type==="listUnordered")if(Y[Ue][0]==="enter")ke.push(Ue);else{const it=ke.pop();Ue=a(Y,it,Ue)}for(Ue=-1;++Ue<Y.length;){const it=n[Y[Ue][0]];HT.call(it,Y[Ue][1].type)&&it[Y[Ue][1].type].call(Object.assign({sliceSerialize:Y[Ue][2].sliceSerialize},Ne),Y[Ue][1])}if(Ne.tokenStack.length>0){const it=Ne.tokenStack[Ne.tokenStack.length-1];(it[1]||y_).call(Ne,void 0,it[0])}for(X.position={start:Bc(Y.length>0?Y[0][1].start:{line:1,column:1,offset:0}),end:Bc(Y.length>0?Y[Y.length-2][1].end:{line:1,column:1,offset:0})},Ue=-1;++Ue<n.transforms.length;)X=n.transforms[Ue](X)||X;return X}function a(Y,X,Ne){let ke=X-1,Ue=-1,it=!1,mt,ht,Ve,tt;for(;++ke<=Ne;){const Le=Y[ke];switch(Le[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Le[0]==="enter"?Ue++:Ue--,tt=void 0;break}case"lineEndingBlank":{Le[0]==="enter"&&(mt&&!tt&&!Ue&&!Ve&&(Ve=ke),tt=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:tt=void 0}if(!Ue&&Le[0]==="enter"&&Le[1].type==="listItemPrefix"||Ue===-1&&Le[0]==="exit"&&(Le[1].type==="listUnordered"||Le[1].type==="listOrdered")){if(mt){let ot=ke;for(ht=void 0;ot--;){const et=Y[ot];if(et[1].type==="lineEnding"||et[1].type==="lineEndingBlank"){if(et[0]==="exit")continue;ht&&(Y[ht][1].type="lineEndingBlank",it=!0),et[1].type="lineEnding",ht=ot}else if(!(et[1].type==="linePrefix"||et[1].type==="blockQuotePrefix"||et[1].type==="blockQuotePrefixWhitespace"||et[1].type==="blockQuoteMarker"||et[1].type==="listItemIndent"))break}Ve&&(!ht||Ve<ht)&&(mt._spread=!0),mt.end=Object.assign({},ht?Y[ht][1].start:Le[1].end),Y.splice(ht||ke,0,["exit",mt,Le[2]]),ke++,Ne++}if(Le[1].type==="listItemPrefix"){const ot={type:"listItem",_spread:!1,start:Object.assign({},Le[1].start),end:void 0};mt=ot,Y.splice(ke,0,["enter",ot,Le[2]]),ke++,Ne++,Ve=void 0,tt=!0}}}return Y[X][1]._spread=it,Ne}function s(Y,X){return Ne;function Ne(ke){f.call(this,Y(ke),ke),X&&X.call(this,ke)}}function l(){this.stack.push({type:"fragment",children:[]})}function f(Y,X,Ne){this.stack[this.stack.length-1].children.push(Y),this.stack.push(Y),this.tokenStack.push([X,Ne||void 0]),Y.position={start:Bc(X.start),end:void 0}}function d(Y){return X;function X(Ne){Y&&Y.call(this,Ne),u.call(this,Ne)}}function u(Y,X){const Ne=this.stack.pop(),ke=this.tokenStack.pop();if(ke)ke[0].type!==Y.type&&(X?X.call(this,Y,ke[0]):(ke[1]||y_).call(this,Y,ke[0]));else throw new Error("Cannot close `"+Y.type+"` ("+tg({start:Y.start,end:Y.end})+"): its not open");Ne.position.end=Bc(Y.end)}function h(){return pS(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(Y){if(this.data.expectingFirstListItemValue){const X=this.stack[this.stack.length-2];X.start=Number.parseInt(this.sliceSerialize(Y),10),this.data.expectingFirstListItemValue=void 0}}function v(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.lang=Y}function S(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.meta=Y}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function E(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.value=Y.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function T(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.value=Y.replace(/(\r?\n|\r)$/g,"")}function I(Y){const X=this.resume(),Ne=this.stack[this.stack.length-1];Ne.label=X,Ne.identifier=Ih(this.sliceSerialize(Y)).toLowerCase()}function D(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.title=Y}function q(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.url=Y}function R(Y){const X=this.stack[this.stack.length-1];if(!X.depth){const Ne=this.sliceSerialize(Y).length;X.depth=Ne}}function F(){this.data.setextHeadingSlurpLineEnding=!0}function U(Y){const X=this.stack[this.stack.length-1];X.depth=this.sliceSerialize(Y).codePointAt(0)===61?1:2}function z(){this.data.setextHeadingSlurpLineEnding=void 0}function V(Y){const Ne=this.stack[this.stack.length-1].children;let ke=Ne[Ne.length-1];(!ke||ke.type!=="text")&&(ke=Be(),ke.position={start:Bc(Y.start),end:void 0},Ne.push(ke)),this.stack.push(ke)}function L(Y){const X=this.stack.pop();X.value+=this.sliceSerialize(Y),X.position.end=Bc(Y.end)}function $(Y){const X=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Ne=X.children[X.children.length-1];Ne.position.end=Bc(Y.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(X.type)&&(V.call(this,Y),L.call(this,Y))}function H(){this.data.atHardBreak=!0}function ee(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.value=Y}function te(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.value=Y}function ae(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.value=Y}function Z(){const Y=this.stack[this.stack.length-1];if(this.data.inReference){const X=this.data.referenceType||"shortcut";Y.type+="Reference",Y.referenceType=X,delete Y.url,delete Y.title}else delete Y.identifier,delete Y.label;this.data.referenceType=void 0}function B(){const Y=this.stack[this.stack.length-1];if(this.data.inReference){const X=this.data.referenceType||"shortcut";Y.type+="Reference",Y.referenceType=X,delete Y.url,delete Y.title}else delete Y.identifier,delete Y.label;this.data.referenceType=void 0}function K(Y){const X=this.sliceSerialize(Y),Ne=this.stack[this.stack.length-2];Ne.label=VT(X),Ne.identifier=Ih(X).toLowerCase()}function oe(){const Y=this.stack[this.stack.length-1],X=this.resume(),Ne=this.stack[this.stack.length-1];if(this.data.inReference=!0,Ne.type==="link"){const ke=Y.children;Ne.children=ke}else Ne.alt=X}function A(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.url=Y}function se(){const Y=this.resume(),X=this.stack[this.stack.length-1];X.title=Y}function ue(){this.data.inReference=void 0}function M(){this.data.referenceType="collapsed"}function pe(Y){const X=this.resume(),Ne=this.stack[this.stack.length-1];Ne.label=X,Ne.identifier=Ih(this.sliceSerialize(Y)).toLowerCase(),this.data.referenceType="full"}function be(Y){this.data.characterReferenceType=Y.type}function fe(Y){const X=this.sliceSerialize(Y),Ne=this.data.characterReferenceType;let ke;Ne?(ke=MT(X,Ne==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):ke=mS(X);const Ue=this.stack[this.stack.length-1];Ue.value+=ke}function Pe(Y){const X=this.stack.pop();X.position.end=Bc(Y.end)}function de(Y){L.call(this,Y);const X=this.stack[this.stack.length-1];X.url=this.sliceSerialize(Y)}function Me(Y){L.call(this,Y);const X=this.stack[this.stack.length-1];X.url="mailto:"+this.sliceSerialize(Y)}function Ze(){return{type:"blockquote",children:[]}}function Fe(){return{type:"code",lang:null,meta:null,value:""}}function Ce(){return{type:"inlineCode",value:""}}function Re(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function xe(){return{type:"emphasis",children:[]}}function Ie(){return{type:"heading",depth:0,children:[]}}function Ge(){return{type:"break"}}function ze(){return{type:"html",value:""}}function nt(){return{type:"image",title:null,url:"",alt:null}}function jt(){return{type:"link",title:null,url:"",children:[]}}function xt(Y){return{type:"list",ordered:Y.type==="listOrdered",start:null,spread:Y._spread,children:[]}}function ve(Y){return{type:"listItem",spread:Y._spread,checked:null,children:[]}}function qe(){return{type:"paragraph",children:[]}}function Qe(){return{type:"strong",children:[]}}function Be(){return{type:"text",value:""}}function J(){return{type:"thematicBreak"}}}function Bc(e){return{line:e.line,column:e.column,offset:e.offset}}function GT(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?GT(e,r):GX(e,r)}}function GX(e,n){let t;for(t in n)if(HT.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function y_(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+tg({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+tg({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+tg({start:n.start,end:n.end})+") is still open")}function YX(e){const n=this;n.parser=t;function t(r){return VX(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}const x_={}.hasOwnProperty;function YT(e,n){const t=n||{};function r(a,...s){let l=r.invalid;const f=r.handlers;if(a&&x_.call(a,e)){const d=String(a[e]);l=x_.call(f,d)?f[d]:r.unknown}if(l)return l.call(this,a,...s)}return r.handlers=t.handlers||{},r.invalid=t.invalid,r.unknown=t.unknown,r}const WX={}.hasOwnProperty;function WT(e,n){let t=-1,r;if(n.extensions)for(;++t<n.extensions.length;)WT(e,n.extensions[t]);for(r in n)if(WX.call(n,r))switch(r){case"extensions":break;case"unsafe":{b_(e[r],n[r]);break}case"join":{b_(e[r],n[r]);break}case"handlers":{QX(e[r],n[r]);break}default:e.options[r]=n[r]}return e}function b_(e,n){n&&e.push(...n)}function QX(e,n){n&&Object.assign(e,n)}function JX(e,n,t,r){const a=t.enter("blockquote"),s=t.createTracker(r);s.move("> "),s.shift(2);const l=t.indentLines(t.containerFlow(e,s.current()),KX);return a(),l}function KX(e,n,t){return">"+(t?"":" ")+e}function QT(e,n){return v_(e,n.inConstruct,!0)&&!v_(e,n.notInConstruct,!1)}function v_(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function w_(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&QT(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function XX(e,n){const t=String(e);let r=t.indexOf(n),a=r,s=0,l=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++s>l&&(l=s):s=1,a=r+n.length,r=t.indexOf(n,a);return l}function sw(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function ZX(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function eZ(e,n,t,r){const a=ZX(t),s=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if(sw(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(s,tZ);return g(),b}const f=t.createTracker(r),d=a.repeat(Math.max(XX(s,a)+1,3)),u=t.enter("codeFenced");let h=f.move(d);if(e.lang){const g=t.enter(`codeFencedLang${l}`);h+=f.move(t.safe(e.lang,{before:h,after:" ",encode:["`"],...f.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${l}`);h+=f.move(" "),h+=f.move(t.safe(e.meta,{before:h,after:`
`,encode:["`"],...f.current()})),g()}return h+=f.move(`
`),s&&(h+=f.move(s+`
`)),h+=f.move(d),u(),h}function tZ(e,n,t){return(t?"":"    ")+e}function xS(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function nZ(e,n,t,r){const a=xS(t),s=a==='"'?"Quote":"Apostrophe",l=t.enter("definition");let f=t.enter("label");const d=t.createTracker(r);let u=d.move("[");return u+=d.move(t.safe(t.associationId(e),{before:u,after:"]",...d.current()})),u+=d.move("]: "),f(),!e.url||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),u+=d.move("<"),u+=d.move(t.safe(e.url,{before:u,after:">",...d.current()})),u+=d.move(">")):(f=t.enter("destinationRaw"),u+=d.move(t.safe(e.url,{before:u,after:e.title?" ":`
`,...d.current()}))),f(),e.title&&(f=t.enter(`title${s}`),u+=d.move(" "+a),u+=d.move(t.safe(e.title,{before:u,after:a,...d.current()})),u+=d.move(a),f()),l(),u}function rZ(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function Wc(e){return"&#x"+e.toString(16).toUpperCase()+";"}function Ib(e,n,t){const r=Db(e),a=Db(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}JT.peek=iZ;function JT(e,n,t,r){const a=rZ(t),s=t.enter("emphasis"),l=t.createTracker(r),f=l.move(a);let d=l.move(t.containerPhrasing(e,{after:a,before:f,...l.current()}));const u=d.charCodeAt(0),h=Ib(r.before.charCodeAt(r.before.length-1),u,a);h.inside&&(d=Wc(u)+d.slice(1));const g=d.charCodeAt(d.length-1),b=Ib(r.after.charCodeAt(0),g,a);b.inside&&(d=d.slice(0,-1)+Wc(g));const v=l.move(a);return s(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},f+d+v}function iZ(e,n,t){return t.options.emphasis||"*"}const bS=function(e){if(e==null)return lZ;if(typeof e=="function")return d0(e);if(typeof e=="object")return Array.isArray(e)?aZ(e):sZ(e);if(typeof e=="string")return oZ(e);throw new Error("Expected function, string, or object as test")};function aZ(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=bS(e[t]);return d0(r);function r(...a){let s=-1;for(;++s<n.length;)if(n[s].apply(this,a))return!0;return!1}}function sZ(e){const n=e;return d0(t);function t(r){const a=r;let s;for(s in e)if(a[s]!==n[s])return!1;return!0}}function oZ(e){return d0(n);function n(t){return t&&t.type===e}}function d0(e){return n;function n(t,r,a){return!!(cZ(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function lZ(){return!0}function cZ(e){return e!==null&&typeof e=="object"&&"type"in e}const KT=[],uZ=!0,ow=!1,dZ="skip";function fZ(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const s=bS(a),l=r?-1:1;f(e,void 0,[])();function f(d,u,h){const g=d&&typeof d=="object"?d:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(d.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=KT,S,k,E;if((!n||s(d,u,h[h.length-1]||void 0))&&(v=hZ(t(d,h)),v[0]===ow))return v;if("children"in d&&d.children){const T=d;if(T.children&&v[0]!==dZ)for(k=(r?T.children.length:-1)+l,E=h.concat(T);k>-1&&k<T.children.length;){const I=T.children[k];if(S=f(I,k,E)(),S[0]===ow)return S;k=typeof S[1]=="number"?S[1]:k+l}}return v}}}function hZ(e){return Array.isArray(e)?e:typeof e=="number"?[uZ,e]:e==null?KT:[e]}function XT(e,n,t,r){let a,s,l;typeof n=="function"?(s=void 0,l=n,a=t):(s=n,l=t,a=r),fZ(e,s,f,a);function f(d,u){const h=u[u.length-1],g=h?h.children.indexOf(d):void 0;return l(d,g,h)}}function ZT(e,n){let t=!1;return XT(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,ow}),!!((!e.depth||e.depth<3)&&pS(e)&&(n.options.setext||t))}function pZ(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),s=t.createTracker(r);if(ZT(e,t)){const h=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...s.current(),before:`
`,after:`
`});return g(),h(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const l="#".repeat(a),f=t.enter("headingAtx"),d=t.enter("phrasing");s.move(l+" ");let u=t.containerPhrasing(e,{before:"# ",after:`
`,...s.current()});return/^[\t ]/.test(u)&&(u=Wc(u.charCodeAt(0))+u.slice(1)),u=u?l+" "+u:l,t.options.closeAtx&&(u+=" "+l),d(),f(),u}eA.peek=mZ;function eA(e){return e.value||""}function mZ(){return"<"}tA.peek=gZ;function tA(e,n,t,r){const a=xS(t),s=a==='"'?"Quote":"Apostrophe",l=t.enter("image");let f=t.enter("label");const d=t.createTracker(r);let u=d.move("![");return u+=d.move(t.safe(e.alt,{before:u,after:"]",...d.current()})),u+=d.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),u+=d.move("<"),u+=d.move(t.safe(e.url,{before:u,after:">",...d.current()})),u+=d.move(">")):(f=t.enter("destinationRaw"),u+=d.move(t.safe(e.url,{before:u,after:e.title?" ":")",...d.current()}))),f(),e.title&&(f=t.enter(`title${s}`),u+=d.move(" "+a),u+=d.move(t.safe(e.title,{before:u,after:a,...d.current()})),u+=d.move(a),f()),u+=d.move(")"),l(),u}function gZ(){return"!"}nA.peek=yZ;function nA(e,n,t,r){const a=e.referenceType,s=t.enter("imageReference");let l=t.enter("label");const f=t.createTracker(r);let d=f.move("![");const u=t.safe(e.alt,{before:d,after:"]",...f.current()});d+=f.move(u+"]["),l();const h=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:d,after:"]",...f.current()});return l(),t.stack=h,s(),a==="full"||!u||u!==g?d+=f.move(g+"]"):a==="shortcut"?d=d.slice(0,-1):d+=f.move("]"),d}function yZ(){return"!"}rA.peek=xZ;function rA(e,n,t){let r=e.value||"",a="`",s=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++s<t.unsafe.length;){const l=t.unsafe[s],f=t.compilePattern(l);let d;if(l.atBreak)for(;d=f.exec(r);){let u=d.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(d.index+1)}}return a+r+a}function xZ(){return"`"}function iA(e,n){const t=pS(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}aA.peek=bZ;function aA(e,n,t,r){const a=xS(t),s=a==='"'?"Quote":"Apostrophe",l=t.createTracker(r);let f,d;if(iA(e,t)){const h=t.stack;t.stack=[],f=t.enter("autolink");let g=l.move("<");return g+=l.move(t.containerPhrasing(e,{before:g,after:">",...l.current()})),g+=l.move(">"),f(),t.stack=h,g}f=t.enter("link"),d=t.enter("label");let u=l.move("[");return u+=l.move(t.containerPhrasing(e,{before:u,after:"](",...l.current()})),u+=l.move("]("),d(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(t.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(d=t.enter("destinationRaw"),u+=l.move(t.safe(e.url,{before:u,after:e.title?" ":")",...l.current()}))),d(),e.title&&(d=t.enter(`title${s}`),u+=l.move(" "+a),u+=l.move(t.safe(e.title,{before:u,after:a,...l.current()})),u+=l.move(a),d()),u+=l.move(")"),f(),u}function bZ(e,n,t){return iA(e,t)?"<":"["}sA.peek=vZ;function sA(e,n,t,r){const a=e.referenceType,s=t.enter("linkReference");let l=t.enter("label");const f=t.createTracker(r);let d=f.move("[");const u=t.containerPhrasing(e,{before:d,after:"]",...f.current()});d+=f.move(u+"]["),l();const h=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:d,after:"]",...f.current()});return l(),t.stack=h,s(),a==="full"||!u||u!==g?d+=f.move(g+"]"):a==="shortcut"?d=d.slice(0,-1):d+=f.move("]"),d}function vZ(){return"["}function vS(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function wZ(e){const n=vS(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function SZ(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function oA(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function NZ(e,n,t,r){const a=t.enter("list"),s=t.bulletCurrent;let l=e.ordered?SZ(t):vS(t);const f=e.ordered?l==="."?")":".":wZ(t);let d=n&&t.bulletLastUsed?l===t.bulletLastUsed:!1;if(!e.ordered){const h=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&h&&(!h.children||!h.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(d=!0),oA(t)===l&&h){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){d=!0;break}}}}d&&(l=f),t.bulletCurrent=l;const u=t.containerFlow(e,r);return t.bulletLastUsed=l,t.bulletCurrent=s,a(),u}function CZ(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function jZ(e,n,t,r){const a=CZ(t);let s=t.bulletCurrent||vS(t);n&&n.type==="list"&&n.ordered&&(s=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+s);let l=s.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(l=Math.ceil(l/4)*4);const f=t.createTracker(r);f.move(s+" ".repeat(l-s.length)),f.shift(l);const d=t.enter("listItem"),u=t.indentLines(t.containerFlow(e,f.current()),h);return d(),u;function h(g,b,v){return b?(v?"":" ".repeat(l))+g:(v?s:s+" ".repeat(l-s.length))+g}}function _Z(e,n,t,r){const a=t.enter("paragraph"),s=t.enter("phrasing"),l=t.containerPhrasing(e,r);return s(),a(),l}const kZ=bS(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function EZ(e,n,t,r){return(e.children.some(function(l){return kZ(l)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function TZ(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}lA.peek=AZ;function lA(e,n,t,r){const a=TZ(t),s=t.enter("strong"),l=t.createTracker(r),f=l.move(a+a);let d=l.move(t.containerPhrasing(e,{after:a,before:f,...l.current()}));const u=d.charCodeAt(0),h=Ib(r.before.charCodeAt(r.before.length-1),u,a);h.inside&&(d=Wc(u)+d.slice(1));const g=d.charCodeAt(d.length-1),b=Ib(r.after.charCodeAt(0),g,a);b.inside&&(d=d.slice(0,-1)+Wc(g));const v=l.move(a+a);return s(),t.attentionEncodeSurroundingInfo={after:b.outside,before:h.outside},f+d+v}function AZ(e,n,t){return t.options.strong||"*"}function PZ(e,n,t,r){return t.safe(e.value,r)}function DZ(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function IZ(e,n,t){const r=(oA(t)+(t.options.ruleSpaces?" ":"")).repeat(DZ(t));return t.options.ruleSpaces?r.slice(0,-1):r}const MZ={blockquote:JX,break:w_,code:eZ,definition:nZ,emphasis:JT,hardBreak:w_,heading:pZ,html:eA,image:tA,imageReference:nA,inlineCode:rA,link:aA,linkReference:sA,list:NZ,listItem:jZ,paragraph:_Z,root:EZ,strong:lA,text:PZ,thematicBreak:IZ},RZ=[OZ];function OZ(e,n,t,r){if(n.type==="code"&&sw(n,r)&&(e.type==="list"||e.type===n.type&&sw(e,r)))return!1;if("spread"in t&&typeof t.spread=="boolean")return e.type==="paragraph"&&(e.type===n.type||n.type==="definition"||n.type==="heading"&&ZT(n,r))?void 0:t.spread?1:0}const Sd=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],LZ=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:Sd},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:Sd},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:Sd},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:Sd},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:Sd},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:Sd},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:Sd},{atBreak:!0,character:"~"}];function FZ(e){return e.label||!e.identifier?e.label||"":VT(e.identifier)}function $Z(e){if(!e._compiled){const n=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((n?"("+n+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function zZ(e,n,t){const r=n.indexStack,a=e.children||[],s=[];let l=-1,f=t.before,d;r.push(-1);let u=n.createTracker(t);for(;++l<a.length;){const h=a[l];let g;if(r[r.length-1]=l,l+1<a.length){let S=n.handle.handlers[a[l+1].type];S&&S.peek&&(S=S.peek),g=S?S(a[l+1],e,n,{before:"",after:"",...u.current()}).charAt(0):""}else g=t.after;s.length>0&&(f==="\r"||f===`
`)&&h.type==="html"&&(s[s.length-1]=s[s.length-1].replace(/(\r?\n|\r)$/," "),f=" ",u=n.createTracker(t),u.move(s.join("")));let b=n.handle(h,e,n,{...u.current(),after:g,before:f});d&&d===b.slice(0,1)&&(b=Wc(d.charCodeAt(0))+b.slice(1));const v=n.attentionEncodeSurroundingInfo;n.attentionEncodeSurroundingInfo=void 0,d=void 0,v&&(s.length>0&&v.before&&f===s[s.length-1].slice(-1)&&(s[s.length-1]=s[s.length-1].slice(0,-1)+Wc(f.charCodeAt(0))),v.after&&(d=g)),u.move(b),s.push(b),f=b.slice(-1)}return r.pop(),s.join("")}function BZ(e,n,t){const r=n.indexStack,a=e.children||[],s=n.createTracker(t),l=[];let f=-1;for(r.push(-1);++f<a.length;){const d=a[f];r[r.length-1]=f,l.push(s.move(n.handle(d,e,n,{before:`
`,after:`
`,...s.current()}))),d.type!=="list"&&(n.bulletLastUsed=void 0),f<a.length-1&&l.push(s.move(UZ(d,a[f+1],e,n)))}return r.pop(),l.join("")}function UZ(e,n,t,r){let a=r.join.length;for(;a--;){const s=r.join[a](e,n,t,r);if(s===!0||s===1)break;if(typeof s=="number")return`
`.repeat(1+s);if(s===!1)return`

<!---->

`}return`

`}const qZ=/\r?\n|\r/g;function VZ(e,n){const t=[];let r=0,a=0,s;for(;s=qZ.exec(e);)l(e.slice(r,s.index)),t.push(s[0]),r=s.index+s[0].length,a++;return l(e.slice(r)),t.join("");function l(f){t.push(n(f,a,!f))}}function HZ(e,n,t){const r=(t.before||"")+(n||"")+(t.after||""),a=[],s=[],l={};let f=-1;for(;++f<e.unsafe.length;){const h=e.unsafe[f];if(!QT(e.stack,h))continue;const g=e.compilePattern(h);let b;for(;b=g.exec(r);){const v="before"in h||!!h.atBreak,S="after"in h,k=b.index+(v?b[1].length:0);a.includes(k)?(l[k].before&&!v&&(l[k].before=!1),l[k].after&&!S&&(l[k].after=!1)):(a.push(k),l[k]={before:v,after:S})}}a.sort(GZ);let d=t.before?t.before.length:0;const u=r.length-(t.after?t.after.length:0);for(f=-1;++f<a.length;){const h=a[f];h<d||h>=u||h+1<u&&a[f+1]===h+1&&l[h].after&&!l[h+1].before&&!l[h+1].after||a[f-1]===h-1&&l[h].before&&!l[h-1].before&&!l[h-1].after||(d!==h&&s.push(S_(r.slice(d,h),"\\")),d=h,/[!-/:-@[-`{-~]/.test(r.charAt(h))&&(!t.encode||!t.encode.includes(r.charAt(h)))?s.push("\\"):(s.push(Wc(r.charCodeAt(h))),d++))}return s.push(S_(r.slice(d,u),t.after)),s.join("")}function GZ(e,n){return e-n}function S_(e,n){const t=/\\(?=[!-/:-@[-`{-~])/g,r=[],a=[],s=e+n;let l=-1,f=0,d;for(;d=t.exec(s);)r.push(d.index);for(;++l<r.length;)f!==r[l]&&a.push(e.slice(f,r[l])),a.push("\\"),f=r[l];return a.push(e.slice(f)),a.join("")}function YZ(e){const n=e||{},t=n.now||{};let r=n.lineShift||0,a=t.line||1,s=t.column||1;return{move:d,current:l,shift:f};function l(){return{now:{line:a,column:s},lineShift:r}}function f(u){r+=u}function d(u){const h=u||"",g=h.split(/\r?\n|\r/g),b=g[g.length-1];return a+=g.length-1,s=g.length===1?s+b.length:1+b.length+r,h}}function WZ(e,n){const t=n||{},r={associationId:FZ,containerPhrasing:XZ,containerFlow:ZZ,createTracker:YZ,compilePattern:$Z,enter:s,handlers:{...MZ},handle:void 0,indentLines:VZ,indexStack:[],join:[...RZ],options:{},safe:eee,stack:[],unsafe:[...LZ]};WT(r,t),r.options.tightDefinitions&&r.join.push(KZ),r.handle=YT("type",{invalid:QZ,unknown:JZ,handlers:r.handlers});let a=r.handle(e,void 0,r,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return a&&a.charCodeAt(a.length-1)!==10&&a.charCodeAt(a.length-1)!==13&&(a+=`
`),a;function s(l){return r.stack.push(l),f;function f(){r.stack.pop()}}}function QZ(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function JZ(e){const n=e;throw new Error("Cannot handle unknown node `"+n.type+"`")}function KZ(e,n){if(e.type==="definition"&&e.type===n.type)return 0}function XZ(e,n){return zZ(e,this,n)}function ZZ(e,n){return BZ(e,this,n)}function eee(e,n){return HZ(this,e,n)}function tee(e){const n=this;n.compiler=t;function t(r){return WZ(r,{...n.data("settings"),...e,extensions:n.data("toMarkdownExtensions")||[]})}}function N_(e){if(e)throw e}var e1,C_;function nee(){if(C_)return e1;C_=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(u){return typeof Array.isArray=="function"?Array.isArray(u):n.call(u)==="[object Array]"},s=function(u){if(!u||n.call(u)!=="[object Object]")return!1;var h=e.call(u,"constructor"),g=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!h&&!g)return!1;var b;for(b in u);return typeof b>"u"||e.call(u,b)},l=function(u,h){t&&h.name==="__proto__"?t(u,h.name,{enumerable:!0,configurable:!0,value:h.newValue,writable:!0}):u[h.name]=h.newValue},f=function(u,h){if(h==="__proto__")if(e.call(u,h)){if(r)return r(u,h).value}else return;return u[h]};return e1=function d(){var u,h,g,b,v,S,k=arguments[0],E=1,T=arguments.length,I=!1;for(typeof k=="boolean"&&(I=k,k=arguments[1]||{},E=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});E<T;++E)if(u=arguments[E],u!=null)for(h in u)g=f(k,h),b=f(u,h),k!==b&&(I&&b&&(s(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&s(g)?g:{},l(k,{name:h,newValue:d(I,S,b)})):typeof b<"u"&&l(k,{name:h,newValue:b}));return k},e1}var ree=nee();const t1=Bd(ree);function lw(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function iee(){const e=[],n={run:t,use:r};return n;function t(...a){let s=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);f(null,...a);function f(d,...u){const h=e[++s];let g=-1;if(d){l(d);return}for(;++g<a.length;)(u[g]===null||u[g]===void 0)&&(u[g]=a[g]);a=u,h?aee(h,f)(...u):l(null,...u)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function aee(e,n){let t;return r;function r(...l){const f=e.length>l.length;let d;f&&l.push(a);try{d=e.apply(this,l)}catch(u){const h=u;if(f&&t)throw h;return a(h)}f||(d&&d.then&&typeof d.then=="function"?d.then(s,a):d instanceof Error?a(d):s(d))}function a(l,...f){t||(t=!0,n(l,...f))}function s(l){a(null,l)}}class ua extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",s={},l=!1;if(t&&("line"in t&&"column"in t?s={place:t}:"start"in t&&"end"in t?s={place:t}:"type"in t?s={ancestors:[t],place:t.position}:s={...t}),typeof n=="string"?a=n:!s.cause&&n&&(l=!0,a=n.message,s.cause=n),!s.ruleId&&!s.source&&typeof r=="string"){const d=r.indexOf(":");d===-1?s.ruleId=r:(s.source=r.slice(0,d),s.ruleId=r.slice(d+1))}if(!s.place&&s.ancestors&&s.ancestors){const d=s.ancestors[s.ancestors.length-1];d&&(s.place=d.position)}const f=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=f?f.column:void 0,this.fatal=void 0,this.file="",this.message=a,this.line=f?f.line:void 0,this.name=tg(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=l&&s.cause&&typeof s.cause.stack=="string"?s.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}ua.prototype.file="";ua.prototype.name="";ua.prototype.reason="";ua.prototype.message="";ua.prototype.stack="";ua.prototype.column=void 0;ua.prototype.line=void 0;ua.prototype.ancestors=void 0;ua.prototype.cause=void 0;ua.prototype.fatal=void 0;ua.prototype.place=void 0;ua.prototype.ruleId=void 0;ua.prototype.source=void 0;const Mo={basename:see,dirname:oee,extname:lee,join:cee,sep:"/"};function see(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');jg(e);let t=0,r=-1,a=e.length,s;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(s){t=a+1;break}}else r<0&&(s=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let l=-1,f=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(s){t=a+1;break}}else l<0&&(s=!0,l=a+1),f>-1&&(e.codePointAt(a)===n.codePointAt(f--)?f<0&&(r=a):(f=-1,r=l));return t===r?r=l:r<0&&(r=e.length),e.slice(t,r)}function oee(e){if(jg(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function lee(e){jg(e);let n=e.length,t=-1,r=0,a=-1,s=0,l;for(;n--;){const f=e.codePointAt(n);if(f===47){if(l){r=n+1;break}continue}t<0&&(l=!0,t=n+1),f===46?a<0?a=n:s!==1&&(s=1):a>-1&&(s=-1)}return a<0||t<0||s===0||s===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function cee(...e){let n=-1,t;for(;++n<e.length;)jg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":uee(t)}function uee(e){jg(e);const n=e.codePointAt(0)===47;let t=dee(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function dee(e,n){let t="",r=0,a=-1,s=0,l=-1,f,d;for(;++l<=e.length;){if(l<e.length)f=e.codePointAt(l);else{if(f===47)break;f=47}if(f===47){if(!(a===l-1||s===1))if(a!==l-1&&s===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(d=t.lastIndexOf("/"),d!==t.length-1){d<0?(t="",r=0):(t=t.slice(0,d),r=t.length-1-t.lastIndexOf("/")),a=l,s=0;continue}}else if(t.length>0){t="",r=0,a=l,s=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,l):t=e.slice(a+1,l),r=l-a-1;a=l,s=0}else f===46&&s>-1?s++:s=-1}return t}function jg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const fee={cwd:hee};function hee(){return"/"}function cw(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function pee(e){if(typeof e=="string")e=new URL(e);else if(!cw(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return mee(e)}function mee(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const n1=["history","path","basename","stem","extname","dirname"];class gee{constructor(n){let t;n?cw(n)?t={path:n}:typeof n=="string"||yee(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":fee.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<n1.length;){const s=n1[r];s in t&&t[s]!==void 0&&t[s]!==null&&(this[s]=s==="history"?[...t[s]]:t[s])}let a;for(a in t)n1.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?Mo.basename(this.path):void 0}set basename(n){i1(n,"basename"),r1(n,"basename"),this.path=Mo.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?Mo.dirname(this.path):void 0}set dirname(n){j_(this.basename,"dirname"),this.path=Mo.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?Mo.extname(this.path):void 0}set extname(n){if(r1(n,"extname"),j_(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Mo.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){cw(n)&&(n=pee(n)),i1(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?Mo.basename(this.path,this.extname):void 0}set stem(n){i1(n,"stem"),r1(n,"stem"),this.path=Mo.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new ua(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}}function r1(e,n){if(e&&e.includes(Mo.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+Mo.sep+"`")}function i1(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function j_(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function yee(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const xee=function(e){const r=this.constructor.prototype,a=r[e],s=function(){return a.apply(s,arguments)};return Object.setPrototypeOf(s,r),s},bee={}.hasOwnProperty;class wS extends xee{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=iee()}copy(){const n=new wS;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data(t1(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(o1("data",this.frozen),this.namespace[n]=t,this):bee.call(this.namespace,n)&&this.namespace[n]||void 0:n?(o1("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=$x(n),r=this.parser||this.Parser;return a1("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),a1("process",this.parser||this.Parser),s1("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(s,l){const f=$x(n),d=r.parse(f);r.run(d,f,function(h,g,b){if(h||!g||!b)return u(h);const v=g,S=r.stringify(v,b);See(S)?b.value=S:b.result=S,u(h,b)});function u(h,g){h||!g?l(h):s?s(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),a1("processSync",this.parser||this.Parser),s1("processSync",this.compiler||this.Compiler),this.process(n,a),k_("processSync","process",t),r;function a(s,l){t=!0,N_(s),r=l}}run(n,t,r){__(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?s(void 0,r):new Promise(s);function s(l,f){const d=$x(t);a.run(n,d,u);function u(h,g,b){const v=g||n;h?f(h):l?l(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,s),k_("runSync","run",r),a;function s(l,f){N_(l),a=f,r=!0}}stringify(n,t){this.freeze();const r=$x(t),a=this.compiler||this.Compiler;return s1("stringify",a),__(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(o1("use",this.frozen),n!=null)if(typeof n=="function")d(n,t);else if(typeof n=="object")Array.isArray(n)?f(n):l(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function s(u){if(typeof u=="function")d(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[h,...g]=u;d(h,g)}else l(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function l(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");f(u.plugins),u.settings&&(a.settings=t1(!0,a.settings,u.settings))}function f(u){let h=-1;if(u!=null)if(Array.isArray(u))for(;++h<u.length;){const g=u[h];s(g)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function d(u,h){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===u){b=g;break}if(b===-1)r.push([u,...h]);else if(h.length>0){let[v,...S]=h;const k=r[b][1];lw(k)&&lw(v)&&(v=t1(!0,k,v)),r[b]=[u,v,...S]}}}}const vee=new wS().freeze();function a1(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function s1(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function o1(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function __(e){if(!lw(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function k_(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function $x(e){return wee(e)?e:new gee(e)}function wee(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function See(e){return typeof e=="string"||Nee(e)}function Nee(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const Cee=vee().use(YX).use(tee).freeze(),cA=-1,f0=0,ng=1,Mb=2,SS=3,NS=4,CS=5,jS=6,uA=7,dA=8,E_=typeof self=="object"?self:globalThis,jee=(e,n)=>{const t=(a,s)=>(e.set(s,a),a),r=a=>{if(e.has(a))return e.get(a);const[s,l]=n[a];switch(s){case f0:case cA:return t(l,a);case ng:{const f=t([],a);for(const d of l)f.push(r(d));return f}case Mb:{const f=t({},a);for(const[d,u]of l)f[r(d)]=r(u);return f}case SS:return t(new Date(l),a);case NS:{const{source:f,flags:d}=l;return t(new RegExp(f,d),a)}case CS:{const f=t(new Map,a);for(const[d,u]of l)f.set(r(d),r(u));return f}case jS:{const f=t(new Set,a);for(const d of l)f.add(r(d));return f}case uA:{const{name:f,message:d}=l;return t(new E_[f](d),a)}case dA:return t(BigInt(l),a);case"BigInt":return t(Object(BigInt(l)),a);case"ArrayBuffer":return t(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:f}=new Uint8Array(l);return t(new DataView(f),l)}}return t(new E_[s](l),a)};return r},T_=e=>jee(new Map,e)(0),Ch="",{toString:_ee}={},{keys:kee}=Object,Hm=e=>{const n=typeof e;if(n!=="object"||!e)return[f0,n];const t=_ee.call(e).slice(8,-1);switch(t){case"Array":return[ng,Ch];case"Object":return[Mb,Ch];case"Date":return[SS,Ch];case"RegExp":return[NS,Ch];case"Map":return[CS,Ch];case"Set":return[jS,Ch];case"DataView":return[ng,t]}return t.includes("Array")?[ng,t]:t.includes("Error")?[uA,t]:[Mb,t]},zx=([e,n])=>e===f0&&(n==="function"||n==="symbol"),Eee=(e,n,t,r)=>{const a=(l,f)=>{const d=r.push(l)-1;return t.set(f,d),d},s=l=>{if(t.has(l))return t.get(l);let[f,d]=Hm(l);switch(f){case f0:{let h=l;switch(d){case"bigint":f=dA,h=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+d);h=null;break;case"undefined":return a([cA],l)}return a([f,h],l)}case ng:{if(d){let b=l;return d==="DataView"?b=new Uint8Array(l.buffer):d==="ArrayBuffer"&&(b=new Uint8Array(l)),a([d,[...b]],l)}const h=[],g=a([f,h],l);for(const b of l)h.push(s(b));return g}case Mb:{if(d)switch(d){case"BigInt":return a([d,l.toString()],l);case"Boolean":case"Number":case"String":return a([d,l.valueOf()],l)}if(n&&"toJSON"in l)return s(l.toJSON());const h=[],g=a([f,h],l);for(const b of kee(l))(e||!zx(Hm(l[b])))&&h.push([s(b),s(l[b])]);return g}case SS:return a([f,l.toISOString()],l);case NS:{const{source:h,flags:g}=l;return a([f,{source:h,flags:g}],l)}case CS:{const h=[],g=a([f,h],l);for(const[b,v]of l)(e||!(zx(Hm(b))||zx(Hm(v))))&&h.push([s(b),s(v)]);return g}case jS:{const h=[],g=a([f,h],l);for(const b of l)(e||!zx(Hm(b)))&&h.push(s(b));return g}}const{message:u}=l;return a([f,{name:d,message:u}],l)};return s},A_=(e,{json:n,lossy:t}={})=>{const r=[];return Eee(!(n||t),!!n,new Map,r)(e),r},hg=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?T_(A_(e,n)):structuredClone(e):(e,n)=>T_(A_(e,n)),fA=pA("end"),hA=pA("start");function pA(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function mA(e){const n=hA(e),t=fA(e);if(n&&t)return{start:n,end:t}}const Nd=["ariaDescribedBy","ariaLabel","ariaLabelledBy"],P_={ancestors:{tbody:["table"],td:["table"],th:["table"],thead:["table"],tfoot:["table"],tr:["table"]},attributes:{a:[...Nd,"dataFootnoteBackref","dataFootnoteRef",["className","data-footnote-backref"],"href"],blockquote:["cite"],code:[["className",/^language-./]],del:["cite"],div:["itemScope","itemType"],dl:[...Nd],h2:[["className","sr-only"]],img:[...Nd,"longDesc","src"],input:[["disabled",!0],["type","checkbox"]],ins:["cite"],li:[["className","task-list-item"]],ol:[...Nd,["className","contains-task-list"]],q:["cite"],section:["dataFootnotes",["className","footnotes"]],source:["srcSet"],summary:[...Nd],table:[...Nd],ul:[...Nd,["className","contains-task-list"]],"*":["abbr","accept","acceptCharset","accessKey","action","align","alt","axis","border","cellPadding","cellSpacing","char","charOff","charSet","checked","clear","colSpan","color","cols","compact","coords","dateTime","dir","encType","frame","hSpace","headers","height","hrefLang","htmlFor","id","isMap","itemProp","label","lang","maxLength","media","method","multiple","name","noHref","noShade","noWrap","open","prompt","readOnly","rev","rowSpan","rows","rules","scope","selected","shape","size","span","start","summary","tabIndex","title","useMap","vAlign","value","width"]},clobber:["ariaDescribedBy","ariaLabelledBy","id","name"],clobberPrefix:"user-content-",protocols:{cite:["http","https"],href:["http","https","irc","ircs","mailto","xmpp"],longDesc:["http","https"],src:["http","https"]},required:{input:{disabled:!0,type:"checkbox"}},strip:["script"],tagNames:["a","b","blockquote","br","code","dd","del","details","div","dl","dt","em","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","li","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","tr","tt","ul","var"]},qc={}.hasOwnProperty;function Tee(e,n){let t={type:"root",children:[]};const r={schema:n?{...P_,...n}:P_,stack:[]},a=gA(r,e);return a&&(Array.isArray(a)?a.length===1?t=a[0]:t.children=a:t=a),t}function gA(e,n){if(n&&typeof n=="object"){const t=n;switch(typeof t.type=="string"?t.type:""){case"comment":return Aee(e,t);case"doctype":return Pee(e,t);case"element":return Dee(e,t);case"root":return Iee(e,t);case"text":return Mee(e,t)}}}function Aee(e,n){if(e.schema.allowComments){const t=typeof n.value=="string"?n.value:"",r=t.indexOf("-->"),s={type:"comment",value:r<0?t:t.slice(0,r)};return _g(s,n),s}}function Pee(e,n){if(e.schema.allowDoctypes){const t={type:"doctype"};return _g(t,n),t}}function Dee(e,n){const t=typeof n.tagName=="string"?n.tagName:"";e.stack.push(t);const r=yA(e,n.children),a=Ree(e,n.properties);e.stack.pop();let s=!1;if(t&&t!=="*"&&(!e.schema.tagNames||e.schema.tagNames.includes(t))&&(s=!0,e.schema.ancestors&&qc.call(e.schema.ancestors,t))){const f=e.schema.ancestors[t];let d=-1;for(s=!1;++d<f.length;)e.stack.includes(f[d])&&(s=!0)}if(!s)return e.schema.strip&&!e.schema.strip.includes(t)?r:void 0;const l={type:"element",tagName:t,properties:a,children:r};return _g(l,n),l}function Iee(e,n){const r={type:"root",children:yA(e,n.children)};return _g(r,n),r}function Mee(e,n){const r={type:"text",value:typeof n.value=="string"?n.value:""};return _g(r,n),r}function yA(e,n){const t=[];if(Array.isArray(n)){const r=n;let a=-1;for(;++a<r.length;){const s=gA(e,r[a]);s&&(Array.isArray(s)?t.push(...s):t.push(s))}}return t}function Ree(e,n){const t=e.stack[e.stack.length-1],r=e.schema.attributes,a=e.schema.required,s=r&&qc.call(r,t)?r[t]:void 0,l=r&&qc.call(r,"*")?r["*"]:void 0,f=n&&typeof n=="object"?n:{},d={};let u;for(u in f)if(qc.call(f,u)){const h=f[u];let g=D_(e,I_(s,u),u,h);g==null&&(g=D_(e,I_(l,u),u,h)),g!=null&&(d[u]=g)}if(a&&qc.call(a,t)){const h=a[t];for(u in h)qc.call(h,u)&&!qc.call(d,u)&&(d[u]=h[u])}return d}function D_(e,n,t,r){return n?Array.isArray(r)?Oee(e,n,t,r):xA(e,n,t,r):void 0}function Oee(e,n,t,r){let a=-1;const s=[];for(;++a<r.length;){const l=xA(e,n,t,r[a]);(typeof l=="number"||typeof l=="string")&&s.push(l)}return s}function xA(e,n,t,r){if(!(typeof r!="boolean"&&typeof r!="number"&&typeof r!="string")&&Lee(e,t,r)){if(typeof n=="object"&&n.length>1){let a=!1,s=0;for(;++s<n.length;){const l=n[s];if(l&&typeof l=="object"&&"flags"in l){if(l.test(String(r))){a=!0;break}}else if(l===r){a=!0;break}}if(!a)return}return e.schema.clobber&&e.schema.clobberPrefix&&e.schema.clobber.includes(t)?e.schema.clobberPrefix+r:r}}function Lee(e,n,t){const r=e.schema.protocols&&qc.call(e.schema.protocols,n)?e.schema.protocols[n]:void 0;if(!r||r.length===0)return!0;const a=String(t),s=a.indexOf(":"),l=a.indexOf("?"),f=a.indexOf("#"),d=a.indexOf("/");if(s<0||d>-1&&s>d||l>-1&&s>l||f>-1&&s>f)return!0;let u=-1;for(;++u<r.length;){const h=r[u];if(s===h.length&&a.slice(0,h.length)===h)return!0}return!1}function _g(e,n){const t=mA(n);n.data&&(e.data=hg(n.data)),t&&(e.position=t)}function I_(e,n){let t,r=-1;if(e)for(;++r<e.length;){const a=e[r],s=typeof a=="string"?a:a[0];if(s===n)return a;s==="data*"&&(t=a)}if(n.length>4&&n.slice(0,4).toLowerCase()==="data")return t}function Fee(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function $ee(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function zee(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function Bee(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Uee(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function qee(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=Kh(r.toLowerCase()),s=e.footnoteOrder.indexOf(r);let l,f=e.footnoteCounts.get(r);f===void 0?(f=0,e.footnoteOrder.push(r),l=e.footnoteOrder.length):l=s+1,f+=1,e.footnoteCounts.set(r,f);const d={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(f>1?"-"+f:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(n,d);const u={type:"element",tagName:"sup",properties:{},children:[d]};return e.patch(n,u),e.applyData(n,u)}function Vee(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function Hee(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function bA(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),s=a[0];s&&s.type==="text"?s.value="["+s.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=r:a.push({type:"text",value:r}),a}function Gee(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return bA(e,n);const a={src:Kh(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const s={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,s),e.applyData(n,s)}function Yee(e,n){const t={src:Kh(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function Wee(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function Qee(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return bA(e,n);const a={href:Kh(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const s={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,s),e.applyData(n,s)}function Jee(e,n){const t={href:Kh(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function Kee(e,n,t){const r=e.all(n),a=t?Xee(t):vA(n),s={},l=[];if(typeof n.checked=="boolean"){const h=r[0];let g;h&&h.type==="element"&&h.tagName==="p"?g=h:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let f=-1;for(;++f<r.length;){const h=r[f];(a||f!==0||h.type!=="element"||h.tagName!=="p")&&l.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!a?l.push(...h.children):l.push(h)}const d=r[r.length-1];d&&(a||d.type!=="element"||d.tagName!=="p")&&l.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:s,children:l};return e.patch(n,u),e.applyData(n,u)}function Xee(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=vA(t[r])}return n}function vA(e){const n=e.spread;return n??e.children.length>1}function Zee(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const l=r[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const s={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,s),e.applyData(n,s)}function ete(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function tte(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function nte(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function rte(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],l),a.push(l)}if(t.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},f=hA(n.children[1]),d=fA(n.children[n.children.length-1]);f&&d&&(l.position={start:f,end:d}),a.push(l)}const s={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,s),e.applyData(n,s)}function ite(e,n,t){const r=t?t.children:void 0,s=(r?r.indexOf(n):1)===0?"th":"td",l=t&&t.type==="table"?t.align:void 0,f=l?l.length:n.children.length;let d=-1;const u=[];for(;++d<f;){const g=n.children[d],b={},v=l?l[d]:void 0;v&&(b.align=v);let S={type:"element",tagName:s,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),u.push(S)}const h={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(n,h),e.applyData(n,h)}function ate(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const M_=9,R_=32;function ste(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const s=[];for(;r;)s.push(O_(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return s.push(O_(n.slice(a),a>0,!1)),s.join("")}function O_(e,n,t){let r=0,a=e.length;if(n){let s=e.codePointAt(r);for(;s===M_||s===R_;)r++,s=e.codePointAt(r)}if(t){let s=e.codePointAt(a-1);for(;s===M_||s===R_;)a--,s=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function ote(e,n){const t={type:"text",value:ste(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function lte(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const cte={blockquote:Fee,break:$ee,code:zee,delete:Bee,emphasis:Uee,footnoteReference:qee,heading:Vee,html:Hee,imageReference:Gee,image:Yee,inlineCode:Wee,linkReference:Qee,link:Jee,listItem:Kee,list:Zee,paragraph:ete,root:tte,strong:nte,table:rte,tableCell:ate,tableRow:ite,text:ote,thematicBreak:lte,toml:Bx,yaml:Bx,definition:Bx,footnoteDefinition:Bx};function Bx(){}function ute(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function dte(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function fte(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||ute,r=e.options.footnoteBackLabel||dte,a=e.options.footnoteLabel||"Footnotes",s=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},f=[];let d=-1;for(;++d<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[d]);if(!u)continue;const h=e.all(u),g=String(u.identifier).toUpperCase(),b=Kh(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let I=typeof t=="string"?t:t(d,v);typeof I=="string"&&(I={type:"text",value:I}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(d,v),className:["data-footnote-backref"]},children:Array.isArray(I)?I:[I]})}const E=h[h.length-1];if(E&&E.type==="element"&&E.tagName==="p"){const I=E.children[E.children.length-1];I&&I.type==="text"?I.value+=" ":E.children.push({type:"text",value:" "}),E.children.push(...S)}else h.push(...S);const T={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(h,!0)};e.patch(u,T),f.push(T)}if(f.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:{...hg(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(f,!0)},{type:"text",value:`
`}]}}const uw={}.hasOwnProperty,hte={};function pte(e,n){const t=n||hte,r=new Map,a=new Map,s=new Map,l={...cte,...t.handlers},f={all:u,applyData:gte,definitionById:r,footnoteById:a,footnoteCounts:s,footnoteOrder:[],handlers:l,one:d,options:t,patch:mte,wrap:xte};return XT(e,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const g=h.type==="definition"?r:a,b=String(h.identifier).toUpperCase();g.has(b)||g.set(b,h)}}),f;function d(h,g){const b=h.type,v=f.handlers[b];if(uw.call(f.handlers,b)&&v)return v(f,h,g);if(f.options.passThrough&&f.options.passThrough.includes(b)){if("children"in h){const{children:k,...E}=h,T=hg(E);return T.children=f.all(h),T}return hg(h)}return(f.options.unknownHandler||yte)(f,h,g)}function u(h){const g=[];if("children"in h){const b=h.children;let v=-1;for(;++v<b.length;){const S=f.one(b[v],h);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=L_(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=L_(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function mte(e,n){e.position&&(n.position=mA(e))}function gte(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,s=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const l="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:l}}t.type==="element"&&s&&Object.assign(t.properties,hg(s)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function yte(e,n){const t=n.data||{},r="value"in n&&!(uw.call(t,"hProperties")||uw.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function xte(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function L_(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function bte(e,n){const t=pte(e,n),r=t.one(e,void 0),a=fte(t),s=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&s.children.push({type:"text",value:`
`},a),s}const vte=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"];class kg{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}}kg.prototype.normal={};kg.prototype.property={};kg.prototype.space=void 0;function wA(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new kg(t,r,n)}function dw(e){return e.toLowerCase()}class da{constructor(n,t){this.attribute=t,this.property=n}}da.prototype.attribute="";da.prototype.booleanish=!1;da.prototype.boolean=!1;da.prototype.commaOrSpaceSeparated=!1;da.prototype.commaSeparated=!1;da.prototype.defined=!1;da.prototype.mustUseProperty=!1;da.prototype.number=!1;da.prototype.overloadedBoolean=!1;da.prototype.property="";da.prototype.spaceSeparated=!1;da.prototype.space=void 0;let wte=0;const Gt=qd(),Tr=qd(),fw=qd(),st=qd(),Qn=qd(),Mh=qd(),Ia=qd();function qd(){return 2**++wte}const hw=Object.freeze(Object.defineProperty({__proto__:null,boolean:Gt,booleanish:Tr,commaOrSpaceSeparated:Ia,commaSeparated:Mh,number:st,overloadedBoolean:fw,spaceSeparated:Qn},Symbol.toStringTag,{value:"Module"})),l1=Object.keys(hw);class _S extends da{constructor(n,t,r,a){let s=-1;if(super(n,t),F_(this,"space",a),typeof r=="number")for(;++s<l1.length;){const l=l1[s];F_(this,l1[s],(r&hw[l])===hw[l])}}}_S.prototype.defined=!0;function F_(e,n,t){t&&(e[n]=t)}function Xh(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const s=new _S(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(s.mustUseProperty=!0),n[r]=s,t[dw(r)]=r,t[dw(s.attribute)]=r}return new kg(n,t,e.space)}const SA=Xh({properties:{ariaActiveDescendant:null,ariaAtomic:Tr,ariaAutoComplete:null,ariaBusy:Tr,ariaChecked:Tr,ariaColCount:st,ariaColIndex:st,ariaColSpan:st,ariaControls:Qn,ariaCurrent:null,ariaDescribedBy:Qn,ariaDetails:null,ariaDisabled:Tr,ariaDropEffect:Qn,ariaErrorMessage:null,ariaExpanded:Tr,ariaFlowTo:Qn,ariaGrabbed:Tr,ariaHasPopup:null,ariaHidden:Tr,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Qn,ariaLevel:st,ariaLive:null,ariaModal:Tr,ariaMultiLine:Tr,ariaMultiSelectable:Tr,ariaOrientation:null,ariaOwns:Qn,ariaPlaceholder:null,ariaPosInSet:st,ariaPressed:Tr,ariaReadOnly:Tr,ariaRelevant:null,ariaRequired:Tr,ariaRoleDescription:Qn,ariaRowCount:st,ariaRowIndex:st,ariaRowSpan:st,ariaSelected:Tr,ariaSetSize:st,ariaSort:null,ariaValueMax:st,ariaValueMin:st,ariaValueNow:st,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function NA(e,n){return n in e?e[n]:n}function CA(e,n){return NA(e,n.toLowerCase())}const Ste=Xh({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Mh,acceptCharset:Qn,accessKey:Qn,action:null,allow:null,allowFullScreen:Gt,allowPaymentRequest:Gt,allowUserMedia:Gt,alt:null,as:null,async:Gt,autoCapitalize:null,autoComplete:Qn,autoFocus:Gt,autoPlay:Gt,blocking:Qn,capture:null,charSet:null,checked:Gt,cite:null,className:Qn,cols:st,colSpan:null,content:null,contentEditable:Tr,controls:Gt,controlsList:Qn,coords:st|Mh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Gt,defer:Gt,dir:null,dirName:null,disabled:Gt,download:fw,draggable:Tr,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Gt,formTarget:null,headers:Qn,height:st,hidden:fw,high:st,href:null,hrefLang:null,htmlFor:Qn,httpEquiv:Qn,id:null,imageSizes:null,imageSrcSet:null,inert:Gt,inputMode:null,integrity:null,is:null,isMap:Gt,itemId:null,itemProp:Qn,itemRef:Qn,itemScope:Gt,itemType:Qn,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Gt,low:st,manifest:null,max:null,maxLength:st,media:null,method:null,min:null,minLength:st,multiple:Gt,muted:Gt,name:null,nonce:null,noModule:Gt,noValidate:Gt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Gt,optimum:st,pattern:null,ping:Qn,placeholder:null,playsInline:Gt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Gt,referrerPolicy:null,rel:Qn,required:Gt,reversed:Gt,rows:st,rowSpan:st,sandbox:Qn,scope:null,scoped:Gt,seamless:Gt,selected:Gt,shadowRootClonable:Gt,shadowRootDelegatesFocus:Gt,shadowRootMode:null,shape:null,size:st,sizes:null,slot:null,span:st,spellCheck:Tr,src:null,srcDoc:null,srcLang:null,srcSet:null,start:st,step:null,style:null,tabIndex:st,target:null,title:null,translate:null,type:null,typeMustMatch:Gt,useMap:null,value:Tr,width:st,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Qn,axis:null,background:null,bgColor:null,border:st,borderColor:null,bottomMargin:st,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Gt,declare:Gt,event:null,face:null,frame:null,frameBorder:null,hSpace:st,leftMargin:st,link:null,longDesc:null,lowSrc:null,marginHeight:st,marginWidth:st,noResize:Gt,noHref:Gt,noShade:Gt,noWrap:Gt,object:null,profile:null,prompt:null,rev:null,rightMargin:st,rules:null,scheme:null,scrolling:Tr,standby:null,summary:null,text:null,topMargin:st,valueType:null,version:null,vAlign:null,vLink:null,vSpace:st,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Gt,disableRemotePlayback:Gt,prefix:null,property:null,results:st,security:null,unselectable:null},space:"html",transform:CA}),Nte=Xh({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ia,accentHeight:st,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:st,amplitude:st,arabicForm:null,ascent:st,attributeName:null,attributeType:null,azimuth:st,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:st,by:null,calcMode:null,capHeight:st,className:Qn,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:st,diffuseConstant:st,direction:null,display:null,dur:null,divisor:st,dominantBaseline:null,download:Gt,dx:null,dy:null,edgeMode:null,editable:null,elevation:st,enableBackground:null,end:null,event:null,exponent:st,externalResourcesRequired:null,fill:null,fillOpacity:st,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Mh,g2:Mh,glyphName:Mh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:st,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:st,horizOriginX:st,horizOriginY:st,id:null,ideographic:st,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:st,k:st,k1:st,k2:st,k3:st,k4:st,kernelMatrix:Ia,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:st,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:st,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:st,overlineThickness:st,paintOrder:null,panose1:null,path:null,pathLength:st,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Qn,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:st,pointsAtY:st,pointsAtZ:st,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ia,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ia,rev:Ia,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ia,requiredFeatures:Ia,requiredFonts:Ia,requiredFormats:Ia,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:st,specularExponent:st,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:st,strikethroughThickness:st,string:null,stroke:null,strokeDashArray:Ia,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:st,strokeOpacity:st,strokeWidth:null,style:null,surfaceScale:st,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ia,tabIndex:st,tableValues:null,target:null,targetX:st,targetY:st,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ia,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:st,underlineThickness:st,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:st,values:null,vAlphabetic:st,vMathematical:st,vectorEffect:null,vHanging:st,vIdeographic:st,version:null,vertAdvY:st,vertOriginX:st,vertOriginY:st,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:st,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:NA}),jA=Xh({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),_A=Xh({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:CA}),kA=Xh({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),Cte=/[A-Z]/g,$_=/-[a-z]/g,jte=/^data[-\w.:]+$/i;function _te(e,n){const t=dw(n);let r=n,a=da;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&jte.test(n)){if(n.charAt(4)==="-"){const s=n.slice(5).replace($_,Ete);r="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=n.slice(4);if(!$_.test(s)){let l=s.replace(Cte,kte);l.charAt(0)!=="-"&&(l="-"+l),n="data"+l}}a=_S}return new a(r,n)}function kte(e){return"-"+e.toLowerCase()}function Ete(e){return e.charAt(1).toUpperCase()}const Tte=wA([SA,Ste,jA,_A,kA],"html"),EA=wA([SA,Nte,jA,_A,kA],"svg"),Ate=/["&'<>`]/g,Pte=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Dte=/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,Ite=/[|\\{}()[\]^$+*?.]/g,z_=new WeakMap;function Mte(e,n){if(e=e.replace(n.subset?Rte(n.subset):Ate,r),n.subset||n.escapeOnly)return e;return e.replace(Pte,t).replace(Dte,r);function t(a,s,l){return n.format((a.charCodeAt(0)-55296)*1024+a.charCodeAt(1)-56320+65536,l.charCodeAt(s+2),n)}function r(a,s,l){return n.format(a.charCodeAt(0),l.charCodeAt(s+1),n)}}function Rte(e){let n=z_.get(e);return n||(n=Ote(e),z_.set(e,n)),n}function Ote(e){const n=[];let t=-1;for(;++t<e.length;)n.push(e[t].replace(Ite,"\\$&"));return new RegExp("(?:"+n.join("|")+")","g")}const Lte=/[\dA-Fa-f]/;function Fte(e,n,t){const r="&#x"+e.toString(16).toUpperCase();return t&&n&&!Lte.test(String.fromCharCode(n))?r:r+";"}const $te=/\d/;function zte(e,n,t){const r="&#"+String(e);return t&&n&&!$te.test(String.fromCharCode(n))?r:r+";"}const Bte=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],c1={nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",fnof:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",bull:"",hellip:"",prime:"",Prime:"",oline:"",frasl:"",weierp:"",image:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",quot:'"',amp:"&",lt:"<",gt:">",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",permil:"",lsaquo:"",rsaquo:"",euro:""},Ute=["cent","copy","divide","gt","lt","not","para","times"],TA={}.hasOwnProperty,pw={};let Ux;for(Ux in c1)TA.call(c1,Ux)&&(pw[c1[Ux]]=Ux);const qte=/[^\dA-Za-z]/;function Vte(e,n,t,r){const a=String.fromCharCode(e);if(TA.call(pw,a)){const s=pw[a],l="&"+s;return t&&Bte.includes(s)&&!Ute.includes(s)&&(!r||n&&n!==61&&qte.test(String.fromCharCode(n)))?l:l+";"}return""}function Hte(e,n,t){let r=Fte(e,n,t.omitOptionalSemicolons),a;if((t.useNamedReferences||t.useShortestReferences)&&(a=Vte(e,n,t.omitOptionalSemicolons,t.attribute)),(t.useShortestReferences||!a)&&t.useShortestReferences){const s=zte(e,n,t.omitOptionalSemicolons);s.length<r.length&&(r=s)}return a&&(!t.useShortestReferences||a.length<r.length)?a:r}function Rh(e,n){return Mte(e,Object.assign({format:Hte},n))}const Gte=/^>|^->|<!--|-->|--!>|<!-$/g,Yte=[">"],Wte=["<",">"];function Qte(e,n,t,r){return r.settings.bogusComments?"<?"+Rh(e.value,Object.assign({},r.settings.characterReferences,{subset:Yte}))+">":"<!--"+e.value.replace(Gte,a)+"-->";function a(s){return Rh(s,Object.assign({},r.settings.characterReferences,{subset:Wte}))}}function Jte(e,n,t,r){return"<!"+(r.settings.upperDoctype?"DOCTYPE":"doctype")+(r.settings.tightDoctype?"":" ")+"html>"}function B_(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function Kte(e,n){const t=n||{};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}function Xte(e){return e.join(" ").trim()}const Zte=/[ \t\n\f\r]/g;function kS(e){return typeof e=="object"?e.type==="text"?U_(e.value):!1:U_(e)}function U_(e){return e.replace(Zte,"")===""}const Mr=PA(1),AA=PA(-1),ene=[];function PA(e){return n;function n(t,r,a){const s=t?t.children:ene;let l=(r||0)+e,f=s[l];if(!a)for(;f&&kS(f);)l+=e,f=s[l];return f}}const tne={}.hasOwnProperty;function DA(e){return n;function n(t,r,a){return tne.call(e,t.tagName)&&e[t.tagName](t,r,a)}}const ES=DA({body:rne,caption:u1,colgroup:u1,dd:one,dt:sne,head:u1,html:nne,li:ane,optgroup:lne,option:cne,p:ine,rp:q_,rt:q_,tbody:dne,td:V_,tfoot:fne,th:V_,thead:une,tr:hne});function u1(e,n,t){const r=Mr(t,n,!0);return!r||r.type!=="comment"&&!(r.type==="text"&&kS(r.value.charAt(0)))}function nne(e,n,t){const r=Mr(t,n);return!r||r.type!=="comment"}function rne(e,n,t){const r=Mr(t,n);return!r||r.type!=="comment"}function ine(e,n,t){const r=Mr(t,n);return r?r.type==="element"&&(r.tagName==="address"||r.tagName==="article"||r.tagName==="aside"||r.tagName==="blockquote"||r.tagName==="details"||r.tagName==="div"||r.tagName==="dl"||r.tagName==="fieldset"||r.tagName==="figcaption"||r.tagName==="figure"||r.tagName==="footer"||r.tagName==="form"||r.tagName==="h1"||r.tagName==="h2"||r.tagName==="h3"||r.tagName==="h4"||r.tagName==="h5"||r.tagName==="h6"||r.tagName==="header"||r.tagName==="hgroup"||r.tagName==="hr"||r.tagName==="main"||r.tagName==="menu"||r.tagName==="nav"||r.tagName==="ol"||r.tagName==="p"||r.tagName==="pre"||r.tagName==="section"||r.tagName==="table"||r.tagName==="ul"):!t||!(t.type==="element"&&(t.tagName==="a"||t.tagName==="audio"||t.tagName==="del"||t.tagName==="ins"||t.tagName==="map"||t.tagName==="noscript"||t.tagName==="video"))}function ane(e,n,t){const r=Mr(t,n);return!r||r.type==="element"&&r.tagName==="li"}function sne(e,n,t){const r=Mr(t,n);return!!(r&&r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd"))}function one(e,n,t){const r=Mr(t,n);return!r||r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd")}function q_(e,n,t){const r=Mr(t,n);return!r||r.type==="element"&&(r.tagName==="rp"||r.tagName==="rt")}function lne(e,n,t){const r=Mr(t,n);return!r||r.type==="element"&&r.tagName==="optgroup"}function cne(e,n,t){const r=Mr(t,n);return!r||r.type==="element"&&(r.tagName==="option"||r.tagName==="optgroup")}function une(e,n,t){const r=Mr(t,n);return!!(r&&r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot"))}function dne(e,n,t){const r=Mr(t,n);return!r||r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot")}function fne(e,n,t){return!Mr(t,n)}function hne(e,n,t){const r=Mr(t,n);return!r||r.type==="element"&&r.tagName==="tr"}function V_(e,n,t){const r=Mr(t,n);return!r||r.type==="element"&&(r.tagName==="td"||r.tagName==="th")}const pne=DA({body:yne,colgroup:xne,head:gne,html:mne,tbody:bne});function mne(e){const n=Mr(e,-1);return!n||n.type!=="comment"}function gne(e){const n=new Set;for(const r of e.children)if(r.type==="element"&&(r.tagName==="base"||r.tagName==="title")){if(n.has(r.tagName))return!1;n.add(r.tagName)}const t=e.children[0];return!t||t.type==="element"}function yne(e){const n=Mr(e,-1,!0);return!n||n.type!=="comment"&&!(n.type==="text"&&kS(n.value.charAt(0)))&&!(n.type==="element"&&(n.tagName==="meta"||n.tagName==="link"||n.tagName==="script"||n.tagName==="style"||n.tagName==="template"))}function xne(e,n,t){const r=AA(t,n),a=Mr(e,-1,!0);return t&&r&&r.type==="element"&&r.tagName==="colgroup"&&ES(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="col")}function bne(e,n,t){const r=AA(t,n),a=Mr(e,-1);return t&&r&&r.type==="element"&&(r.tagName==="thead"||r.tagName==="tbody")&&ES(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="tr")}const qx={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function vne(e,n,t,r){const a=r.schema,s=a.space==="svg"?!1:r.settings.omitOptionalTags;let l=a.space==="svg"?r.settings.closeEmptyElements:r.settings.voids.includes(e.tagName.toLowerCase());const f=[];let d;a.space==="html"&&e.tagName==="svg"&&(r.schema=EA);const u=wne(r,e.properties),h=r.all(a.space==="html"&&e.tagName==="template"?e.content:e);return r.schema=a,h&&(l=!1),(u||!s||!pne(e,n,t))&&(f.push("<",e.tagName,u?" "+u:""),l&&(a.space==="svg"||r.settings.closeSelfClosing)&&(d=u.charAt(u.length-1),(!r.settings.tightSelfClosing||d==="/"||d&&d!=='"'&&d!=="'")&&f.push(" "),f.push("/")),f.push(">")),f.push(h),!l&&(!s||!ES(e,n,t))&&f.push("</"+e.tagName+">"),f.join("")}function wne(e,n){const t=[];let r=-1,a;if(n){for(a in n)if(n[a]!==null&&n[a]!==void 0){const s=Sne(e,a,n[a]);s&&t.push(s)}}for(;++r<t.length;){const s=e.settings.tightAttributes?t[r].charAt(t[r].length-1):void 0;r!==t.length-1&&s!=='"'&&s!=="'"&&(t[r]+=" ")}return t.join("")}function Sne(e,n,t){const r=_te(e.schema,n),a=e.settings.allowParseErrors&&e.schema.space==="html"?0:1,s=e.settings.allowDangerousCharacters?0:1;let l=e.quote,f;if(r.overloadedBoolean&&(t===r.attribute||t==="")?t=!0:(r.boolean||r.overloadedBoolean)&&(typeof t!="string"||t===r.attribute||t==="")&&(t=!!t),t==null||t===!1||typeof t=="number"&&Number.isNaN(t))return"";const d=Rh(r.attribute,Object.assign({},e.settings.characterReferences,{subset:qx.name[a][s]}));return t===!0||(t=Array.isArray(t)?(r.commaSeparated?Kte:Xte)(t,{padLeft:!e.settings.tightCommaSeparatedLists}):String(t),e.settings.collapseEmptyAttributes&&!t)?d:(e.settings.preferUnquoted&&(f=Rh(t,Object.assign({},e.settings.characterReferences,{attribute:!0,subset:qx.unquoted[a][s]}))),f!==t&&(e.settings.quoteSmart&&B_(t,l)>B_(t,e.alternative)&&(l=e.alternative),f=l+Rh(t,Object.assign({},e.settings.characterReferences,{subset:(l==="'"?qx.single:qx.double)[a][s],attribute:!0}))+l),d+(f&&"="+f))}const Nne=["<","&"];function IA(e,n,t,r){return t&&t.type==="element"&&(t.tagName==="script"||t.tagName==="style")?e.value:Rh(e.value,Object.assign({},r.settings.characterReferences,{subset:Nne}))}function Cne(e,n,t,r){return r.settings.allowDangerousHtml?e.value:IA(e,n,t,r)}function jne(e,n,t,r){return r.all(e)}const _ne=YT("type",{invalid:kne,unknown:Ene,handlers:{comment:Qte,doctype:Jte,element:vne,raw:Cne,root:jne,text:IA}});function kne(e){throw new Error("Expected node, not `"+e+"`")}function Ene(e){const n=e;throw new Error("Cannot compile unknown node `"+n.type+"`")}const Tne={},Ane={},Pne=[];function Dne(e,n){const t=n||Tne,r=t.quote||'"',a=r==='"'?"'":'"';if(r!=='"'&&r!=="'")throw new Error("Invalid quote `"+r+"`, expected `'` or `\"`");return{one:Ine,all:Mne,settings:{omitOptionalTags:t.omitOptionalTags||!1,allowParseErrors:t.allowParseErrors||!1,allowDangerousCharacters:t.allowDangerousCharacters||!1,quoteSmart:t.quoteSmart||!1,preferUnquoted:t.preferUnquoted||!1,tightAttributes:t.tightAttributes||!1,upperDoctype:t.upperDoctype||!1,tightDoctype:t.tightDoctype||!1,bogusComments:t.bogusComments||!1,tightCommaSeparatedLists:t.tightCommaSeparatedLists||!1,tightSelfClosing:t.tightSelfClosing||!1,collapseEmptyAttributes:t.collapseEmptyAttributes||!1,allowDangerousHtml:t.allowDangerousHtml||!1,voids:t.voids||vte,characterReferences:t.characterReferences||Ane,closeSelfClosing:t.closeSelfClosing||!1,closeEmptyElements:t.closeEmptyElements||!1},schema:t.space==="svg"?EA:Tte,quote:r,alternative:a}.one(Array.isArray(e)?{type:"root",children:e}:e,void 0,void 0)}function Ine(e,n,t){return _ne(e,n,t,this)}function Mne(e){const n=[],t=e&&e.children||Pne;let r=-1;for(;++r<t.length;)n[r]=this.one(t[r],r,e);return n.join("")}const Rne={};function One(e){const n=this,{handlers:t,sanitize:r,...a}=e||Rne;let s=!1,l;typeof r=="boolean"?s=!r:r&&(l=r),n.compiler=f;function f(d,u){const h=bte(d,{handlers:t,allowDangerousHtml:s}),g=s?h:Tee(h,l),b=Dne(g,{...a,allowDangerousHtml:s});return u.extname&&(u.extname=".html"),d&&d.type==="root"&&b&&/[^\r\n]/.test(b.charAt(b.length-1))?b+`
`:b}}const Lne=()=>{var rc,sf,Ns;const{recordId:e}=ki(),n=wt(),t=ni(),[r,a]=w.useState(""),[s]=w.useState([]),[l,f]=w.useState(null),[d,u]=w.useState(null),[h,g]=w.useState(void 0),[b,v]=w.useState(void 0),[S,k]=w.useState(null),[E,T]=w.useState(!1),[I,D]=w.useState(""),[q,R]=w.useState(!1),[F,U]=w.useState(null),[z,V]=w.useState(null),[L,$]=w.useState(!1),[H,ee]=w.useState(!1),[te,ae]=w.useState(null),[Z,B]=w.useState(""),[K,oe]=w.useState(""),[A,se]=w.useState(null),[ue,M]=w.useState(!1),[pe,be]=w.useState(!1),[fe,Pe]=w.useState(null),[de,Me]=w.useState(!1),[Ze,Fe]=w.useState(null),[Ce,Re]=w.useState(window.innerHeight),[xe,Ie]=w.useState([]),[Ge,ze]=w.useState(!1),[nt,jt]=w.useState(null),[xt,ve]=w.useState([]),[qe,Qe]=w.useState([]),[Be,J]=w.useState(!1),[Y,X]=w.useState(null),Ne=w.useRef(null),ke=w.useRef(null),Ue=w.useRef(!1),it=w.useRef(null),mt=w.useRef(null),[ht,Ve]=w.useState(33.33),[tt,Le]=w.useState(!1),ot=w.useRef(null),et=w.useRef(null),bt=150,[Un,Ln]=w.useState([]),[jn,gn]=w.useState([]),[dn,Nr]=w.useState(!1),[Ur,ri]=w.useState(null),[fa,Ti]=w.useState(!1),[nr,Xn]=w.useState(null),[Fn,za]=w.useState(!1),[ds,ep]=w.useState(null),[tp,Vd]=w.useState(!1),[fs,nu]=w.useState(null),[Ys,Ws]=w.useState(!1),[Ba,Qs]=w.useState(null),[cr,Hd]=w.useState(!1),[Bl,hs]=w.useState(null),[Ua,qr]=w.useState([]),[Js,qa]=w.useState(!1),[Gd,Ho]=w.useState(null),[Go,ii]=w.useState(!1),[Yo,Ul]=w.useState(null),[ha,ru]=w.useState({}),[iu,Yd]=w.useState(!1),[au,Rr]=w.useState(!1),[Wo,ql]=w.useState(!1),[Qo,Vl]=w.useState(!1),[Va,su]=w.useState(!1),[Vr,Jo]=w.useState(!1),[Hl,Ks]=w.useState(!1),[pa,Xs]=w.useState(!1),ps=w.useMemo(()=>(d==null?void 0:d.admission_date)&&!(d!=null&&d.discharge_date),[d]),[ma,ga]=w.useState(!1),[Ko,Xo]=w.useState(""),[Zo,Gl]=w.useState(void 0),[Yl,ms]=w.useState(void 0),[Zs,el]=w.useState(void 0),[Hr,Ha]=w.useState(!1),[Wl,ya]=w.useState(null),[eo,tl]=w.useState(!1),ai=w.useRef(null),[to,gs]=w.useState(null),[zi,Ql]=w.useState(null),ys=w.useRef(null),[Wd]=w.useState("Loading..."),[yn,ln]=w.useState(!1),[ou,Pr]=w.useState(!1),[Xt,no]=w.useState(null),[Ga,lu]=w.useState(""),[Ya,xs]=w.useState(""),[Zn,bs]=w.useState(!0),[si,cu]=w.useState(!1),[nl,Dr]=w.useState(!1),[Wa,uu]=w.useState(!1),Jl=w.useRef(null),vs=async he=>{try{const Q=await ge(`/api/patients/${he}`);if(!Q.ok){const ce=await Q.json().catch(()=>({}));throw new Error(ce.message||`Failed to fetch patient details: ${Q.status}`)}const ie=await Q.json();if(u(ie),g(ie.age),v(ie.gender),B(ie.ai_response||""),u(ce=>ce?{...ce,current_status:ie.current_status,admission_date:ie.admission_date,discharge_date:ie.discharge_date}:{...ie,current_status:ie.current_status,admission_date:ie.admission_date,discharge_date:ie.discharge_date}),ie.insurance_type&&u(ce=>ce?{...ce,insurance_type:ie.insurance_type}:{...ie}),rl(he),ie.ai_response){const ce=/```json\s*([\s\S]*?)\s*```/,Ee=ie.ai_response.match(ce);if(Ee&&Ee[1])oe(ie.ai_response.replace(ce,"").trim()),se(Ee[1].trim());else{const We=ie.ai_response.trim();if(We.startsWith("{")&&We.endsWith("}"))try{JSON.parse(We),oe(""),se(We)}catch{oe(We),se(null)}else if(We.startsWith("[")&&We.endsWith("]"))try{JSON.parse(We),oe(""),se(We)}catch{oe(We),se(null)}else oe(We),se(null)}}else oe(""),se(null)}catch{u(null),B(""),oe(""),se(null)}},Qd=async(he,Q)=>{u(ie=>ie?{...ie,insurance_type:Q}:null);try{const ie=await ge(`/api/patients/${he}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:Q})});if(!ie.ok){const ce=await ie.json();throw new Error(ce.message||"Failed to update insurance type")}}catch(ie){console.error("Error updating insurance type:",ie),he&&vs(he)}},du=async he=>{J(!0),X(null),Qe([]);try{const Q=await ge(`/api/queue/patient/${he}/complaints`);if(!Q.ok){const ce=await Q.json().catch(()=>({}));throw new Error(ce.message||`HTTP error! status: ${Q.status}`)}const ie=await Q.json();Qe(ie||[])}catch(Q){X(`Past complaints error: ${Q.message}`)}finally{J(!1)}},ur=async he=>{ve([]);try{const Q=await ge(`/api/pharmacy-orders/patient/${he}`);if(!Q.ok){const ce=await Q.json().catch(()=>({}));throw new Error(ce.message||`HTTP error! status: ${Q.status}`)}const ie=await Q.json();ve(ie||[])}catch{}},Kl=async he=>{qa(!0),Ho(null),qr([]);try{const Q=await ge(`/api/lab/orders/patient/${he}`);if(!Q.ok){const ce=await Q.json().catch(()=>({}));throw new Error(ce.message||`HTTP error! status: ${Q.status}`)}const ie=await Q.json();qr(ie||[])}catch(Q){Ho(`Pending labs error: ${Q.message}`)}finally{qa(!1)}},Or=async he=>{ze(!0),jt(null),Ie([]);try{const Q=await ge(`/api/lab/patient/${he}`);if(!Q.ok){const ce=await Q.json().catch(()=>({}));throw new Error(ce.message||`HTTP error! status: ${Q.status}`)}const ie=await Q.json();Ie(ie||[])}catch(Q){jt(`Lab reports error: ${Q.message}`)}finally{ze(!1)}},np=async he=>{$(!0),J(!0),qa(!0),ze(!0),ve([]);try{const Q=await ge(`/api/patients/${he}/context`);if(!Q.ok){const Ee=await Q.json().catch(()=>({}));throw new Error(Ee.message||`Failed to fetch patient context: ${Q.status}`)}const ie=await Q.json(),ce=ie.patient;if(u(ce),g(ce.age),v(ce.gender),B(ce.ai_response||""),rl(he),ce.ai_response){const Ee=/```json\s*([\s\S]*?)\s*```/,We=ce.ai_response.match(Ee);if(We&&We[1])oe(ce.ai_response.replace(Ee,"").trim()),se(We[1].trim());else{const lt=ce.ai_response.trim();if(lt.startsWith("{")&&lt.endsWith("}"))try{JSON.parse(lt),oe(""),se(lt)}catch{oe(lt),se(null)}else if(lt.startsWith("[")&&lt.endsWith("]"))try{JSON.parse(lt),oe(""),se(lt)}catch{oe(lt),se(null)}else oe(lt),se(null)}}else oe(""),se(null);Qe(ie.pastComplaints||[]),ve(ie.pharmacyOrders||[]),qr(ie.labOrders||[]),Ie(ie.labReports||[])}catch(Q){console.error("Error fetching patient context:",Q),ae(Q.message),u(null),B(""),oe(""),se(null),Qe([]),ve([]),qr([]),Ie([])}finally{$(!1),J(!1),qa(!1),ze(!1)}},rl=async he=>{try{const Q=await ge(`/api/queue/patient/${he}/latest`);if(!Q.ok){const ce=await Q.json().catch(()=>({}));throw new Error(ce.message||`Failed to fetch queue status: ${Q.status}`)}const ie=await Q.json();if(ie){const ce=new Date(ie.createdAt),Ee=new Date,We=ce.getDate()===Ee.getDate()&&ce.getMonth()===Ee.getMonth()&&ce.getFullYear()===Ee.getFullYear(),lt=["waiting","consulting"].includes(ie.status);Xs(We&&lt)}else Xs(!1)}catch(Q){console.error("Error checking patient queue status:",Q),Xs(!1)}},Bi=he=>{n(`/dashboard/edit-pharmacy-order/${he}`)},Xl=he=>{ae(null),console.log(`Preparing billing navigation for order: ${he}`);const Q=xt.find(ie=>ie.id===he);if(Q){const ie=Q.medications.map(ce=>{const Ee=ce.price??0;return(ce.price===void 0||ce.price===null)&&console.warn(`Medication "${ce.name}" in order ${he} is missing a price. Defaulting to 0.`),{name:ce.name,pack_quantity:ce.pack_quantity,loose_quantity:ce.loose_quantity,price:Ee,pack_price:ce.pack_price,loose_price:ce.loose_price,total_price:Number(ce.total_price)||0,isLoose:ce.isLoose,unit:ce.unit,drug_id:ce.drug_id?String(ce.drug_id):null,tabletsPerDay:ce.tabletsPerDay,numberOfDays:ce.numberOfDays,directions_to_use:ce.directions_to_use,discount_percentage:ce.discount_percentage??0,batch:ce.batch,expiry_date:ce.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:ie}),n(`/dashboard/pharmacy-billing/${he}`,{state:{initialItems:ie}})}else console.error(`Order with ID ${he} not found.`),ae(`Order with ID ${he} not found.`),alert(`Error: Could not find order ${he} to bill.`)},fu=async(he,Q)=>{ae(null);const ie=xt.find(Ee=>Ee.id===he);if(!ie){ae(`Order with ID ${he} not found.`);return}const ce={status:Q,medications:ie.medications};try{const Ee=await ge(`/api/pharmacy-orders/${he}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ce)});if(!Ee.ok){const lt=await Ee.text();throw new Error(`Failed to update status: ${Ee.statusText} (${Ee.status}) - ${lt}`)}const We=await Ee.json();ve(lt=>lt.map(ct=>ct.id===We.id?We:ct)),l&&ur(l)}catch(Ee){console.error("Failed to update order status:",Ee),ae(Ee.message||`Failed to update status for order ${he}.`),alert(`Error updating status for order ${he}: ${Ee.message||"Please try again."}`)}},Mn=async he=>{ae(null);try{const Q=await ge(`/api/pharmacy-orders/${he}/recurring`,{method:"POST"});if(!Q.ok){const ie=await Q.json().catch(()=>({}));throw new Error(ie.message||"Failed to mark order as recurring")}alert("Order marked as recurring successfully!")}catch(Q){console.error("Failed to mark order as recurring:",Q),ae(Q.message||`Failed to mark order ${he} as recurring.`),alert(`Error: ${Q.message||"Please try again."}`)}},xa=he=>{qr(Q=>Q.map(ie=>ie.id===he?{...ie,isEditing:!0,editedTests:[...ie.tests],editedStatus:ie.status}:{...ie,isEditing:!1}))},hu=he=>{qr(Q=>Q.map(ie=>ie.id===he?{...ie,isEditing:!1,editedTests:void 0,editedStatus:void 0}:ie))},rp=(he,Q,ie,ce)=>{qr(Ee=>Ee.map(We=>{if(We.id===he){const lt=We.editedTests?[...We.editedTests]:[...We.tests];if(ie==="add")return{...We,editedTests:[...lt,{id:"",name:"",price:0}]};if(ie==="remove")return{...We,editedTests:ce};if(Q!==-1){const ct={...lt[Q],[ie]:ce};return lt[Q]=ct,{...We,editedTests:lt}}}return We}))},pu=(he,Q)=>{qr(ie=>ie.map(ce=>ce.id===he?{...ce,editedStatus:Q}:ce))},ip=he=>{if(!he||!he.id){console.error("Cannot navigate to billing: Lab Order data or ID is missing."),alert("Could not open billing page: Lab Order information is missing.");return}n("/lab-billing",{state:{labOrderId:he.id}})},ap=he=>{he&&he.id?n(`/lab/report/${he.id}`):(console.error("Cannot navigate: Lab Order or Lab Order ID is missing."),alert("Could not open the report entry page: Lab Order information is missing."))},sp=he=>{he&&he.id?n(`/lab/view-report/${he.id}`):(console.error("Attempted to view report for a lab order with no ID:",he),alert("Cannot view report: Lab Order ID is missing."))},Jd=async(he,Q,ie)=>{ql(!0),ae(null);try{if(!Q||Q.length===0)throw new Error("Lab order must have at least one test.");for(const We of Q)if(!We.id||!We.name||isNaN(We.price)||We.price<0)throw new Error(`Invalid test data: ${JSON.stringify(We)}. Each test must have id, name, and a valid price.`);const ce={tests:Q,status:ie},Ee=await ge(`/api/lab/orders/${he}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ce)});if(!Ee.ok){const We=await Ee.json().catch(()=>({}));throw new Error(We.message||`Failed to update lab order: ${Ee.statusText}`)}l&&Kl(l),qr(We=>We.map(lt=>lt.id===he?{...lt,isEditing:!1,editedTests:void 0,editedStatus:void 0}:lt))}catch(ce){ae(`Lab Order Save Error: ${ce.message}`)}finally{ql(!1)}},ws=async he=>{if(!window.confirm(`Are you sure you want to delete this ${he.type.toLowerCase()} record? This action cannot be undone.`))return;ii(!0),Ul(null);let ie=null,ce;const Ee=he.type;try{switch(Ee){case"Complaint":if(ce=he.data.id,!ce)throw new Error("Complaint ID is missing.");ie=`/api/patients/complaints/${ce}`;break;case"Lab Order":if(ce=he.data.id,!ce)throw new Error("Lab Order ID is missing.");ie=`/api/lab/orders/${ce}`;break;case"Lab Report":if(ce=he.data.reportId,!ce)throw new Error("Lab Report ID is missing.");ie=`/api/lab/reports/${ce}`;break;case"Pharmacy Order":if(ce=he.data.id,!ce)throw new Error("Pharmacy Order ID is missing.");ie=`/api/pharmacy-orders/${ce}`;break;default:throw new Error(`Deletion not supported for item type: ${Ee}`)}if(!ie)throw new Error(`Could not determine delete URL for type: ${Ee}`);const We=await ge(ie,{method:"DELETE"});if(!We.ok){const lt=await We.json().catch(()=>({}));throw new Error(lt.message||`Failed to delete ${Ee}: ${We.statusText}`)}l&&(Ee==="Complaint"?du(l):Ee==="Lab Order"?(Kl(l),Or(l)):Ee==="Lab Report"?Or(l):Ee==="Pharmacy Order"&&ur(l))}catch(We){Ul(`Delete Error (${Ee}): ${We.message}`),Go&&ii(!1)}finally{ii(!1)}},ro=async()=>{if(!l)return;if(xt.filter(Q=>Q.status==="pending").length<2){alert("You need at least two pending orders to merge.");return}Pr(!0);try{const Q=await ge(`/api/pharmacy-orders/patient/${l}/merge-pending`,{method:"POST"});if(!Q.ok){const ie=await Q.json().catch(()=>({}));throw new Error(ie.message||"Failed to merge orders")}ur(l)}catch(Q){ae(`Merge Error: ${Q.message}`)}finally{Pr(!1)}},Ui=w.useMemo(()=>{if(!l||!qe)return[];const he=qe.map(Q=>({date:new Date(Q.createdAt),type:"Complaint",data:Q,originalDateString:Q.createdAt})).filter(Q=>!isNaN(Q.date.getTime()));return he.sort((Q,ie)=>ie.date.getTime()-Q.date.getTime()),he},[l,qe]),Gr=w.useMemo(()=>{if(!l)return[];const he=new Map;(Ua??[]).forEach(ie=>{he.set(ie.id,{...ie})}),(xe??[]).forEach(ie=>{if(!he.has(ie.id))he.set(ie.id,{id:ie.id,patient_id:ie.patient_id,tests:ie.tests,status:ie.status,createdAt:ie.createdAt,report:ie});else{const ce=he.get(ie.id);ce&&(ce.report=ie,ce.status=ie.status)}});let Q=Array.from(he.values());return Q.sort((ie,ce)=>new Date(ie.createdAt).getTime()-new Date(ce.createdAt).getTime()),Q=Q.map((ie,ce)=>({...ie,serialNumber:ce+1})),Q.map(ie=>({date:new Date(ie.createdAt),type:"Lab Order",data:ie,originalDateString:ie.createdAt}))},[l,Ua,xe]),qi=w.useMemo(()=>{if(!l||!xt)return[];const he=xt.map(Q=>({date:new Date(Q.date),type:"Pharmacy Order",data:Q,originalDateString:Q.date})).filter(Q=>!isNaN(Q.date.getTime()));return he.sort((Q,ie)=>ie.date.getTime()-Q.date.getTime()),he},[l,xt]),[il,al]=w.useState(null),[Zl,mu]=w.useState([]),[io,ba]=w.useState(""),Kd=(he,Q)=>{if(!he||!he.report_content||!Q)return"";try{const ie=JSON.parse(he.report_content||"{}");if(typeof ie!="object"||ie===null)return`<p class="italic text-gray-500 text-xs">Report content is not structured data.</p><pre>${he.report_content}</pre>`;let ce="";return Q.forEach(Ee=>{ie[Ee.id]?(ce+=`<h5 class="font-semibold text-sm mt-2 mb-1">${Ee.name}</h5>`,ce+='<table class="lab-report-print-table"><thead><tr><th>Parameter</th><th>Value</th><th>Normal Range</th></tr></thead><tbody>',Object.entries(ie[Ee.id]).map(([We,lt])=>{var ci;const ct=(ci=Ee.default_parameters)==null?void 0:ci.find(of=>of.name===We);let At="N/A";ct&&ct.type==="number"&&(ct.lower_limit!=null||ct.upper_limit!=null)?(At="",ct.lower_limit!=null&&(At+=` > ${ct.lower_limit}`),ct.lower_limit!=null&&ct.upper_limit!=null&&(At+=" - "),ct.upper_limit!=null&&(At+=` < ${ct.upper_limit}`),At=At.trim()||"N/A"):(ct==null?void 0:ct.type)==="boolean"?At="N/A":ct!=null&&ct.normal_range&&(At=ct.normal_range),ce+=`<tr><td>${We}</td><td>${String(lt)} ${(ct==null?void 0:ct.unit)||""}</td><td>${At}</td></tr>`}),ce+="</tbody></table>"):ce+=`<p class="italic text-gray-500 text-xs">No parameters reported for ${Ee.name}.</p>`}),ce}catch{return`<p class="italic text-gray-500 text-xs">Error parsing report content.</p><pre>${he.report_content}</pre>`}};w.useEffect(()=>{const he=()=>{Re(window.innerHeight)};return window.addEventListener("resize",he),he(),()=>window.removeEventListener("resize",he)},[]),w.useEffect(()=>{const he=ie=>{if(!tt||!et.current||!ot.current)return;const ce=ot.current.getBoundingClientRect(),We=ie.clientX-et.current.x;let lt=et.current.initialWidth-We;const ct=ce.width-bt-10;lt=Math.max(bt,lt),lt=Math.min(lt,ct);const At=lt/ce.width*100;Ve(At)},Q=()=>{Le(!1),et.current=null,document.body.style.cursor="",document.body.style.userSelect=""};return tt&&(window.addEventListener("mousemove",he),window.addEventListener("mouseup",Q),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{window.removeEventListener("mousemove",he),window.removeEventListener("mouseup",Q),document.body.style.cursor="",document.body.style.userSelect=""}},[tt]);const Xd=he=>{if(!ot.current)return;he.preventDefault();const Q=ot.current.querySelector(".edit-complaint-context-column");Q&&(et.current={x:he.clientX,initialWidth:Q.offsetWidth},Le(!0))},Lr=w.useCallback(async()=>{ee(!0),ae(null);try{const he=await ge("/api/queue/doctor/new",{method:"POST"});if(!he.ok){const ie=await he.json().catch(()=>({}));throw new Error(ie.message||`Failed to create record: ${he.statusText}`)}const Q=await he.json();if(!Q.recordId)throw new Error("New record ID not received from server.");n(`/edit-complaint/${Q.recordId}`,{replace:!0})}catch(he){ae(`Failed to create new complaint record: ${he.message}`)}finally{ee(!1)}},[n]);w.useEffect(()=>{(async()=>{bs(!0);try{const Q=await ge("/api/clinics/settings");if(!Q.ok){const ce=await Q.json().catch(()=>({}));throw new Error(ce.message||"Failed to fetch clinic settings.")}const ie=await Q.json();no({admissionCharge:parseFloat(ie.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(ie.perDayCharge||0).toFixed(2),otherCharges:parseFloat(ie.otherCharges||0).toFixed(2),aiMemory:ie.aiMemory||"",aiMemoryUpdatedAt:ie.aiMemoryUpdatedAt||null,clinicWideSystemPrompt:ie.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:ie.clinicWideSystemPromptUpdatedAt||null,gemini_api_key:ie.gemini_api_key||""}),lu(ie.aiMemory||""),xs(ie.clinicWideSystemPrompt||"")}catch{}finally{bs(!1)}})()},[]),w.useEffect(()=>{var Q,ie;(Q=t.state)!=null&&Q.patientId&&f(Number(t.state.patientId)),(ie=t.state)!=null&&ie.initialComplaint&&a(t.state.initialComplaint),e?(async ce=>{var Ee;$(!0),ae(null);try{const We=await ge(`/api/queue/doctor/complaint/${ce}`);if(!We.ok){const ct=await We.json().catch(()=>({}));throw new Error(ct.message||`HTTP error! status: ${We.status}`)}const lt=await We.json();f(ct=>ct===lt.patientId?ct:lt.patientId),g(lt.age),v(lt.gender),k(lt.case_summary||null),V(lt.updatedAt||null)}catch{ae("Failed to load current complaint details."),(Ee=t.state)!=null&&Ee.patientId||f(null),g(void 0),v(void 0),k(null),V(null)}finally{$(!1)}})(e):Lr()},[e,Lr,(rc=t.state)==null?void 0:rc.initialComplaint,(sf=t.state)==null?void 0:sf.patientId]),w.useEffect(()=>{l?np(l):(u(null),Qe([]),ve([]),qr([]),Ie([]),V(null),Xs(!1))},[l]),w.useEffect(()=>{var ie;const he=(ie=t.state)==null?void 0:ie.initialComplaint;he&&e&&(!L&&!Be&&!Js&&!Ge&&!dn)&&!Ue.current&&r===he&&(Ue.current=!0,Ss(),n(t.pathname,{replace:!0,state:{}}))},[(Ns=t.state)==null?void 0:Ns.initialComplaint,e,r,L,Be,Js,Ge,dn,n]);const ec=()=>{D(S||""),T(!0),U(null)},ao=()=>{T(!1),D(""),U(null)},so=async()=>{if(!e){U("Missing Record ID.");return}R(!0),U(null);try{const he=await ge(`/api/queue/doctor/complaint/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:I.trim()})});if(!he.ok){const ie=await he.json().catch(()=>({}));throw new Error(ie.message||`Failed to save case summary: ${he.statusText}`)}const Q=await he.json();k(Q.case_summary||I.trim()),V(Q.updatedAt||null),T(!1)}catch(he){U(`Save Error: ${he.message}`)}finally{R(!1)}};w.useEffect(()=>{(async()=>{Nr(!0),ri(null);try{const[Q,ie]=await Promise.all([ge("/api/drugs"),ge("/api/lab-tests")]);if(!Q.ok)throw new Error(`Pharmacy inventory error! status: ${Q.status}`);const ce=await Q.json();if(Ln(ce||[]),!ie.ok)throw new Error(`Lab inventory error! status: ${ie.status}`);const Ee=await ie.json();gn(Ee||[])}catch(Q){ri(Q.message)}finally{Nr(!1)}})()},[]);const oo=async()=>{if(!Xt)return;if(Ga===Xt.aiMemory&&Ya===Xt.clinicWideSystemPrompt){Dr(!1);return}const he=Ga!==Xt.aiMemory,Q=Ya!==Xt.clinicWideSystemPrompt;he&&cu(!0),Q&&uu(!0);try{const ie={...Xt};he&&(ie.aiMemory=Ga),Q&&(ie.clinicWideSystemPrompt=Ya);const ce=await ge("/api/clinics/settings",{method:"PUT",body:JSON.stringify(ie)});if(!ce.ok){const We=await ce.json().catch(()=>({}));throw new Error(We.message||"Failed to update clinic settings.")}const Ee=await ce.json();no({admissionCharge:parseFloat(Ee.settings.admissionCharge).toFixed(2),perDayCharge:parseFloat(Ee.settings.perDayCharge).toFixed(2),otherCharges:parseFloat(Ee.settings.otherCharges).toFixed(2),aiMemory:Ee.settings.aiMemory||"",aiMemoryUpdatedAt:Ee.settings.aiMemoryUpdatedAt||(Xt==null?void 0:Xt.aiMemoryUpdatedAt)||null,clinicWideSystemPrompt:Ee.settings.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:Ee.settings.clinicWideSystemPromptUpdatedAt||(Xt==null?void 0:Xt.clinicWideSystemPromptUpdatedAt)||null}),he&&lu(Ee.settings.aiMemory||""),Q&&(xs(Ee.settings.clinicWideSystemPrompt||""),Dr(!1))}catch{}finally{he&&cu(!1),Q&&uu(!1)}},op=()=>{Xt&&(xs(Xt.clinicWideSystemPrompt||""),Dr(!0))},tc=()=>{Dr(!1),Xt&&xs(Xt.clinicWideSystemPrompt||"")},Ss=async he=>{const Q=he??r;Jl.current&&await Jl.current.callGenerativeApi(Q)},Zd=he=>{navigator.clipboard.writeText(he).then(()=>{}).catch(Q=>{console.error("Failed to copy text: ",Q)})},sl=(he,Q)=>{const ie=window.open("","_blank");ie&&(ie.document.write(`
        <html>
          <head>
            <title>${Q}</title>
            <style>
              body { font-family: sans-serif; margin: 20px; }
              h2 { text-align: center; margin-bottom: 20px; }
              table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
              th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
              th { background-color: #f2f2f2; }
              pre { white-space: pre-wrap; word-wrap: break-word; }
              .ai-context-section { margin-bottom: 20px; border: 1px solid #eee; padding: 15px; border-radius: 5px; }
              .ai-context-section-title { font-size: 1.1em; font-weight: bold; margin-bottom: 10px; color: #333; }
              .ai-context-text { margin-bottom: 5px; }
              .text-gray-400 { color: #999; }
              .font-semibold { font-weight: 600; }
              .italic { font-style: italic; }
              .mt-2 { margin-top: 8px; }
              .ml-1 { margin-left: 4px; }
              .ml-2 { margin-left: 8px; }
              .flex { display: flex; }
              .flex-col { flex-direction: column; }
              .w-full { width: 100%; }
              .text-xs { font-size: 0.75rem; }
              .text-sm { font-size: 0.875rem; }
              .prose { max-width: 65ch; }
              .prose table { display: table; } /* Ensure tables in markdown render correctly */
            </style>
          </head>
          <body>
            <h2>${Q}</h2>
            <div id="print-content">${he}</div>
          </body>
        </html>
      `),ie.document.close(),ie.print())},Qa=()=>{if(Z){const he=Cee().use(Lo).use(One).processSync(K).toString();sl(`<div class="prose">${he}</div>`,"AI Response")}};w.useEffect(()=>{if(d){let he=`
        <div class="print-section">
          <h3>Patient Details</h3>
          <p><strong>Name:</strong> ${d.name||"N/A"}</p>
          <p><strong>Token:</strong> ${d.patient_token_number||"N/A"}</p>
          <p><strong>Age:</strong> ${d.age||"N/A"}</p>
          <p><strong>Gender:</strong> ${d.gender||"N/A"}</p>
          <p><strong>Phone:</strong> ${d.phone||"N/A"}</p>
          <p><strong>Insurance:</strong> ${d.insurance_type||"N/A"}</p>
          <p><strong>Status:</strong> ${d.current_status||"N/A"}</p>
          <p><strong>Admitted:</strong> ${d.admission_date?new Date(d.admission_date).toLocaleDateString():"N/A"}</p>
          <p><strong>Discharged:</strong> ${d.discharge_date?new Date(d.discharge_date).toLocaleDateString():"N/A"}</p>
        </div>
        <div class="print-section">
          <h3>Case Summary</h3>
          <p>${S||"No summary available."}</p>
        </div>
        <div class="print-section">
          <h3>Complaints History</h3>
          ${Ui.length>0?`
            <ul>
              ${Ui.map(Q=>`<li>${new Date(Q.originalDateString).toLocaleDateString()}: ${Q.data.complaint}</li>`).join("")}
            </ul>
          `:"<p>No past complaints.</p>"}
        </div>
        <div class="print-section">
          <h3>Pharmacy Orders</h3>
          ${qi.length>0?`
            <table class="print-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Status</th>
                  <th>Drug Name</th>
                  <th>Quantity</th>
                  <th>Dosage</th>
                  <th>Directions</th>
                </tr>
              </thead>
              <tbody>
                ${qi.map(Q=>Q.data.medications.map((ie,ce)=>`
                    <tr>
                      ${ce===0?`<td rowspan="${Q.data.medications.length}">${new Date(Q.originalDateString).toLocaleDateString()}</td>`:""}
                      ${ce===0?`<td rowspan="${Q.data.medications.length}">${Q.data.status}</td>`:""}
                      <td><strong>${ie.name}</strong></td>
                      <td>
                        ${ie.pack_quantity!==void 0&&ie.pack_quantity>0?`Packs: ${ie.pack_quantity}`:""}
                        ${ie.pack_quantity!==void 0&&ie.pack_quantity>0&&ie.loose_quantity!==void 0&&ie.loose_quantity>0?", ":""}
                        ${ie.loose_quantity!==void 0&&ie.loose_quantity>0?`Loose: ${ie.loose_quantity}`:""}
                      </td>
                      <td>${ie.tabletsPerDay&&ie.numberOfDays?`${ie.tabletsPerDay} tab/day for ${ie.numberOfDays} days`:"N/A"}</td>
                      <td>${ie.directions_to_use||"N/A"}</td>
                    </tr>
                  `).join("")).join("")}
              </tbody>
            </table>
          `:"<p>No pharmacy orders.</p>"}
        </div>
        <div class="print-section">
          <h3>Lab History (Orders & Reports)</h3>
          ${Gr.length>0?`
            ${Gr.map(Q=>{const ie=Q.data.tests.map(Ee=>Ee.name).join(", ");let ce="";return Q.data.report&&(ce=`
                  <div class="lab-report-print-container">
                    <h4>Lab Report (${new Date(Q.data.report.report_date).toLocaleDateString()})</h4>
                    ${Kd(Q.data.report,Q.data.report.tests)}
                  </div>
                `),`
                <div class="lab-history-item">
                  <p><strong>Order Date:</strong> ${new Date(Q.originalDateString).toLocaleDateString()}</p>
                  <p><strong>Status:</strong> ${Q.data.status}</p>
                  <p><strong>Tests:</strong> ${ie}</p>
                  ${ce}
                </div>
              `}).join("")}
          `:"<p>No lab history.</p>"}
        </div>
      `;ba(he)}else ba("")},[d,S,Ui,qi,Gr,Kd]);const ef=()=>{io&&sl(io,`Patient Details - ${d==null?void 0:d.name}`)},tf=he=>{a(he),al(null),mu([]),setTimeout(()=>{Ss(he)},0)},oi=L||pe||de,nf=()=>{a("reports came,please anaylse"),setTimeout(()=>{Ss()},0)},va=he=>{ru(Q=>({...Q,[he]:!Q[he]}))},nc=he=>{he.key==="Enter"&&!he.shiftKey&&(he.preventDefault(),!oi&&!dn&&!H&&r.trim()&&e&&Ss())};w.useEffect(()=>{const he=window.SpeechRecognition||window.webkitSpeechRecognition;if(!he){gs("Speech recognition not supported in this browser.");return}const Q=new he;return Q.continuous=!0,Q.interimResults=!0,Q.lang="en-US",Q.onresult=ie=>{let ce="";for(let Ee=ie.resultIndex;Ee<ie.results.length;++Ee)ie.results[Ee].isFinal&&(ce+=ie.results[Ee][0].transcript);ce&&a(Ee=>Ee+(Ee.endsWith(" ")||Ee===""?"":" ")+ce)},Q.onerror=ie=>{gs(`Speech error: ${ie.error}`),tl(!1)},Q.onend=()=>{},ai.current=Q,()=>{ai.current&&ai.current.stop()}},[]);const lp=async()=>{if(l)if(ps){su(!0);try{const he=await ge(`/api/patients/${l}/discharge`,{method:"POST"});if(!he.ok){const Q=await he.json().catch(()=>({}));throw new Error(Q.message||`Failed to discharge patient: ${he.status}`)}vs(l)}catch(he){ae(`Discharge Error: ${he.message}`)}finally{su(!1)}}else{Vl(!0);try{const he=await ge(`/api/patients/${l}/admit`,{method:"POST"});if(!he.ok){const Q=await he.json().catch(()=>({}));throw new Error(Q.message||`Failed to admit patient: ${he.status}`)}vs(l)}catch(he){ae(`Admit Error: ${he.message}`)}finally{Vl(!1)}}},cp=async he=>{if(l){Jo(!0);try{const ie=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:l})});if(!ie.ok){const ce=await ie.json().catch(()=>({}));throw new Error(ce.message||`Failed to add patient to ${he} queue: ${ie.status}`)}alert(`Patient added to ${he} queue successfully!`),l&&(vs(l),rl(l))}catch(Q){ae(`Add to Queue Error: ${Q.message}`)}finally{Jo(!1)}}},Yr=async()=>{if(e){Ks(!0),ae(null);try{const he=await ge(`/api/queue/${e}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"seen"})});if(!he.ok){const Q=await he.json().catch(()=>({}));throw new Error(Q.message||"Failed to complete consultation")}alert("Consultation completed successfully!"),l&&(vs(l),rl(l))}catch(he){ae(`Error completing consultation: ${he.message}`)}finally{Ks(!1)}}},Vi=async()=>{if(!l){ya("Missing Patient ID.");return}if(!d){ya("Patient details not loaded.");return}Ha(!0),ya(null);try{const he={};let Q=!1;if(Ko!==d.name&&(he.name=Ko,Q=!0),Zo!==d.age&&(he.age=Zo,Q=!0),Yl!==d.gender&&(he.gender=Yl,Q=!0),Zs!==d.phone&&(he.phone=Zs,Q=!0),!Q){ya("No changes detected."),Ha(!1),ga(!1);return}const ie=await ge(`/api/patients/${l}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(he)});if(!ie.ok){const Ee=await ie.json().catch(()=>({}));throw new Error(Ee.message||`Failed to update patient details: ${ie.statusText}`)}const ce=await ie.json();u(ce),g(ce.age),v(ce.gender),Xo(ce.name),Gl(ce.age),ms(ce.gender),el(ce.phone),ga(!1)}catch(he){ya(`Save Error: ${he.message}`)}finally{Ha(!1)}},li=w.useCallback(()=>{if(!d)return null;const he={token_number:d.patient_token_number||"N/A",name:d.name||"N/A",age:d.age||"N/A",gender:d.gender||"N/A",phone:d.phone||"N/A"};return Ui.length>0?he.complaints_history=Ui.map(Q=>`${Q.data.complaint} (${new Date(Q.originalDateString).toLocaleDateString()})`).join("; "):he.complaints_history="No past complaints.",qi.length>0?he.pharmacy_orders_history=qi.map(Q=>`Order: ${Q.data.medications.map(ce=>{let Ee=`${ce.name}`;return ce.pack_quantity!==void 0&&ce.pack_quantity>0&&(Ee+=` Packs: ${ce.pack_quantity}`),ce.loose_quantity!==void 0&&ce.loose_quantity>0&&(Ee+=` Loose: ${ce.loose_quantity}`),Ee}).join(", ")} (${Q.data.status}, ${new Date(Q.originalDateString).toLocaleDateString()})`).join("; "):he.pharmacy_orders_history="No pharmacy orders.",Gr.length>0?he.lab_orders_history=Gr.map(Q=>{let ce=`Lab Order: ${Q.data.tests.map(Ee=>Ee.name).join(", ")} (${Q.data.status}, ${new Date(Q.originalDateString).toLocaleDateString()})`;return Q.data.report&&(ce+=` - Report: ${Q.data.report.report_content} (${new Date(Q.data.report.report_date).toLocaleDateString()})`),ce}).join("; "):he.lab_orders_history="No lab history.",he},[d,Ui,qi,Gr]),gu=()=>{if(!d){gs("Patient details are required to use the Live API.");return}ln(!0)},rf=()=>{var he;(he=ys.current)==null||he.click()},af=he=>{var ie;const Q=(ie=he.target.files)==null?void 0:ie[0];Q&&Ql(Q)};return i.jsxs("div",{className:"edit-complaint-page",style:{height:`${Ce}px`},children:[i.jsx(qJ,{ref:Jl,recordId:e,patientId:l,patientDetails:d,caseSummary:S,caseSummaryUpdatedAt:z,clinicSettings:Xt,userMessages:s,selectedImageFile:zi,pendingLabOrders:Ua,labReports:xe,pastComplaints:qe,pharmacyOrders:xt,pharmacyInventory:Un,labInventory:jn,setCurrentComplaint:a,setAiResponse:B,setAiResponseText:oe,setAiResponseJsonString:se,setShowAiJsonDetails:M,setIsLoadingAi:be,setAiError:Pe,setIsSubmittingAiOrder:Ti,setAiOrderSubmissionStatus:Xn,setIsSubmittingAiLabOrder:za,setAiLabOrderSubmissionStatus:ep,setIsSubmittingAiComplaint:Vd,setAiComplaintSubmissionStatus:nu,setIsUpdatingCaseSummary:Ws,setAiCaseSummaryUpdateStatus:Qs,setCaseSummary:k,setCaseSummaryUpdatedAt:V,setIsUpdatingAiMemoryByAI:Hd,setAiMemoryUpdateByAIStatus:hs,setFollowUpQuestion:al,setFollowUpOptions:mu,setError:ae,setIsSavingAiResponse:Me,setSaveAiResponseError:Fe,fetchPharmacyOrdersData:ur,fetchPendingLabOrdersData:Kl,fetchLabReportsData:Or,fetchPastComplaintsData:du,fetchPatientDetails:vs,setClinicSettings:no,setEditedAiMemory:lu,handleDeleteItem:ws}),yn&&d&&i.jsx(SE,{onClose:()=>ln(!1),patientData:li(),tokenNumber:d.patient_token_number?String(d.patient_token_number):null,onAiSummaryChange:he=>{he&&(a(he),Ss(he),ln(!1))}}),i.jsxs("div",{className:"edit-complaint-header",children:[i.jsx("button",{onClick:()=>n(-1),disabled:oi,className:"back-button",title:"Go Back",children:"< Back"}),i.jsx("span",{ref:mt,style:{position:"absolute",visibility:"hidden",height:"auto",width:"auto",whiteSpace:"nowrap"}}),d&&i.jsx("div",{className:"edit-complaint-patient-details",children:d&&!ma?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>{ga(!0),Xo(d.name||""),Gl(d.age),ms(d.gender),el(d.phone),ya(null)},className:"edit-button mr-2",title:"Edit Patient Details",disabled:Hr,children:i.jsx(jd,{size:14})}),d.name??"N/A",d.patient_token_number!==null&&d.patient_token_number!==void 0&&` (${d.patient_token_number})`," - ",d.age??"N/A"," / ",d.gender??"N/A",d.phone&&` / ${d.phone}`]}):d&&ma?i.jsxs("div",{className:"patient-details-edit-form",children:[i.jsx("input",{type:"text",value:Ko,onChange:he=>Xo(he.target.value),placeholder:"Name",className:"edit-input",disabled:Hr}),i.jsx("input",{type:"number",value:Zo??"",onChange:he=>Gl(he.target.value?parseInt(he.target.value):null),placeholder:"Age",className:"edit-input",disabled:Hr}),i.jsxs("select",{value:Yl??"",onChange:he=>ms(he.target.value||null),className:"edit-input",disabled:Hr,children:[i.jsx("option",{value:"",children:"Select Gender"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]}),i.jsx("input",{type:"text",value:Zs??"",onChange:he=>el(he.target.value||null),placeholder:"Phone Number",className:"edit-input",disabled:Hr}),i.jsxs("div",{className:"edit-actions",children:[i.jsx("button",{onClick:()=>{ga(!1),ya(null)},className:"button-secondary",disabled:Hr,children:"Cancel"}),i.jsx("button",{onClick:Vi,className:"button-primary blue",disabled:Hr,children:Hr?"Saving...":"Save"})]}),Wl&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:Wl})]}):i.jsxs("div",{className:"edit-complaint-patient-details",children:[h??"N/A"," / ",b??"N/A"]})}),!d&&h!==void 0&&b!==void 0&&i.jsxs("div",{className:"edit-complaint-patient-details",children:[h??"N/A"," / ",b??"N/A"]}),i.jsx("div",{style:{width:"64px"}})]}),i.jsxs("div",{className:"edit-complaint-content-area",ref:ot,children:[i.jsxs("div",{className:"edit-complaint-main-column",style:{flexBasis:`calc(${100-ht}% - 5px)`},children:[te&&i.jsxs("div",{className:"general-error-message",children:["Error: ",te]}),H&&i.jsx("div",{className:"ai-function-status info text-center",children:"Creating record..."}),pe&&i.jsx("div",{className:"loading-animation-container",children:i.jsx("div",{className:"loading-text",children:Wd})}),fe&&i.jsx("div",{className:"ai-error-message",children:fe}),nr&&i.jsxs("div",{className:`ai-function-status ${nr.toLowerCase().includes("error:")?"error":nr.toLowerCase().startsWith("order created")||nr.toLowerCase().startsWith("success:")?"success":"info"}`,children:[fa&&i.jsx("span",{className:"animate-spin",role:"status"}),nr]}),ds&&i.jsxs("div",{className:`ai-function-status ${ds.toLowerCase().includes("error:")?"error":ds.toLowerCase().startsWith("success:")||ds.toLowerCase().startsWith("lab order created")?"success":"info"}`,children:[Fn&&i.jsx("span",{className:"animate-spin",role:"status"}),ds]}),fs&&i.jsxs("div",{className:`ai-function-status ${fs.toLowerCase().includes("error:")?"error":"info"}`,children:[tp&&i.jsx("span",{className:"animate-spin",role:"status"}),fs]}),Ba&&i.jsxs("div",{className:`ai-function-status ${Ba.toLowerCase().includes("error:")?"error":"info"}`,children:[Ys&&i.jsx("span",{className:"animate-spin",role:"status"}),Ba]}),Bl&&i.jsxs("div",{className:`ai-function-status ${Bl.toLowerCase().includes("error:")?"error":"info"}`,children:[cr&&i.jsx("span",{className:"animate-spin",role:"status"}),Bl]}),Ze&&i.jsxs("div",{className:"general-error-message",children:["Error saving AI response: ",Ze]}),de&&i.jsx("div",{className:"ai-function-status info text-center",children:"Saving AI response..."}),(K||A)&&i.jsxs("div",{ref:Ne,className:`${A?"ai-function-call-block":"ai-response-container"} group`,children:[K&&i.jsx(Dl,{remarkPlugins:[Lo],children:K}),A&&i.jsxs("div",{className:"ai-json-details-container",children:[i.jsxs("button",{onClick:()=>M(!ue),className:"ai-json-toggle-button",children:[ue?i.jsx(ub,{size:14,className:"mr-1"}):i.jsx(cb,{size:14,className:"mr-1"}),ue?"Hide":"Show"," AI Function Call Details"]}),ue&&i.jsx("pre",{className:"ai-json-pre",children:i.jsx("code",{children:JSON.stringify(JSON.parse(A),null,2)})})]}),i.jsxs("div",{className:"ai-response-actions",children:[i.jsx("button",{onClick:()=>Zd(Z),disabled:!Z,title:"Copy Full AI Response",children:i.jsx(cM,{size:12})}),i.jsx("button",{onClick:Qa,disabled:!Z,title:"Print AI Response",children:i.jsx(Ml,{size:12})})]})]})]}),i.jsx("div",{className:"draggable-divider",onMouseDown:Xd}),i.jsx("div",{className:"edit-complaint-context-column",style:{flexBasis:`calc(${100-ht}% - 5px)`},children:i.jsxs("div",{className:"ai-context-container",children:[i.jsxs("h3",{className:"ai-context-header",children:[i.jsx("span",{children:"AI Context:"}),i.jsx("div",{className:"ai-context-actions-top",children:i.jsxs("button",{onClick:ef,disabled:!io,title:"Print All Patient Details",className:"context-action-button",children:[i.jsx(Ml,{size:14})," Print"]})}),(d==null?void 0:d.insurance_type)&&i.jsx("div",{className:"insurance-type-container mt-2",children:i.jsxs("select",{ref:it,value:d.insurance_type,onChange:he=>Qd(d.id,he.target.value),className:"insurance-type-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"insurance",children:"Insurance"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})})]}),i.jsxs("div",{className:"ai-context-section",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Admission Status"}),(d==null?void 0:d.admission_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Admitted:"})," ",new Date(d.admission_date).toLocaleDateString()]}),(d==null?void 0:d.discharge_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Discharged:"})," ",new Date(d.discharge_date).toLocaleDateString()]}),(d==null?void 0:d.current_status)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Current Status:"})," ",i.jsx("span",{className:"font-semibold",children:d.current_status})]}),i.jsxs("div",{className:"flex space-x-2 mt-2",children:[i.jsx("button",{onClick:lp,className:`admit-discharge-button ${ps?"discharge":"admit"}`,title:ps?"Discharge Patient":"Admit Patient",disabled:!l||Qo||Va,children:Qo?"Admitting...":Va?"Discharging...":ps?"Discharge":"Admit"}),i.jsx("button",{onClick:()=>cp("doctor"),className:`queue-status-button ${pa?"in-queue":"add-to-queue"}`,title:pa?"Patient is in Doctor Queue":"Add Patient to Doctor Queue",disabled:!l||Vr||pa,children:Vr?"Adding...":pa?"In Queue":"Add to Queue"}),i.jsx("button",{onClick:Yr,className:"complete-consultation-button",title:"Mark Consultation as Complete",disabled:Hl,children:Hl?"Completing...":"Complete Consultation"})]})]}),i.jsx(Jv,{title:"Pharmacy Order History",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:ro,className:"button-primary blue text-xs px-2 py-1",disabled:ou||xt.filter(he=>he.status==="pending").length<2,title:"Merge all pending orders into one",children:ou?"Merging...":"Merge Orders"}),i.jsxs("button",{onClick:()=>Rr(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new pharmacy order",disabled:!l,children:[i.jsx(Md,{size:12,className:"mr-1"})," Add Pharmacy Order"]})]}),items:qi,onMarkAsRecurring:Mn,isLoading:!1,loadingText:"Loading...",noDataText:"No orders.",renderItemContent:(he,Q)=>i.jsxs("div",{className:"flex flex-col w-full",children:[i.jsxs("span",{className:"ai-context-text flex items-center",children:[" ",qi.length-Q,". Order Status: (",he.data.status,")",i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(he.originalDateString).toLocaleDateString(),")"]}),i.jsxs("div",{className:"inline-flex space-x-2 ml-2",children:[" ",i.jsx("button",{onClick:()=>Bi(he.data.id),className:"icon-button small",title:"Edit Pharmacy Order",children:i.jsx(jd,{size:12})}),he.data.prescriptionForUnavailableDrugs&&i.jsx("button",{onClick:()=>sl(he.data.prescriptionForUnavailableDrugs,"Unavailable Drugs Prescription"),className:"icon-button small",title:"Print Unavailable Drugs Prescription",children:i.jsx(Ml,{size:12})}),i.jsx("button",{onClick:()=>ws({type:"Pharmacy Order",data:he.data}),className:"icon-button small text-red-500",title:"Delete Pharmacy Order",children:i.jsx(ti,{size:12})}),he.data.status==="pending"&&i.jsx("button",{onClick:()=>Xl(he.data.id),className:"icon-button small",title:"Bill this pharmacy order",disabled:Wo,children:i.jsx(Ad,{size:12})}),he.data.status==="billed"&&i.jsx("button",{onClick:()=>fu(he.data.id,"dispensed"),className:"icon-button small",title:"Dispense this pharmacy order",disabled:Wo,children:i.jsx($a,{size:12})}),he.data.status==="dispensed"&&i.jsx("button",{onClick:async()=>{var ie;try{const ce=await ge(`/api/bills?patientId=${he.data.patientId}`);if(!ce.ok)throw new Error("Failed to fetch bills");const We=(ie=(await ce.json()).bills)==null?void 0:ie.find(lt=>lt.related_id===he.data.id&&lt.type==="pharmacy");We?n(`/dashboard/bills/${We.id}`):alert("Bill not found for this order.")}catch(ce){console.error("Error fetching bill:",ce),alert("Failed to fetch bill. Please try again.")}},className:"icon-button small",title:"View Bill",children:i.jsx(y1,{size:12})})]})]}),i.jsx("div",{className:"pharmacy-order-drugs-table-container mt-2",children:i.jsxs("table",{className:"pharmacy-order-drugs-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2 text-left",children:"Drug Name"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Quantity"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Dosage"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Directions"})]})}),i.jsx("tbody",{children:he.data.medications.map((ie,ce)=>i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:i.jsx("strong",{children:ie.name})}),i.jsxs("td",{className:"py-1 px-2",children:[ie.pack_quantity!==void 0&&ie.pack_quantity>0&&`Packs: ${ie.pack_quantity}`,ie.pack_quantity!==void 0&&ie.pack_quantity>0&&ie.loose_quantity!==void 0&&ie.loose_quantity>0&&", ",ie.loose_quantity!==void 0&&ie.loose_quantity>0&&`Loose: ${ie.loose_quantity}`]}),i.jsx("td",{className:"py-1 px-2",children:ie.tabletsPerDay&&ie.numberOfDays?`${ie.tabletsPerDay} tab/day for ${ie.numberOfDays} days`:"N/A"}),i.jsx("td",{className:"py-1 px-2",children:ie.directions_to_use||"N/A"})]},ie.drug_id||ie.name||ce))})]})}),he.data.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[i.jsx("span",{className:"font-semibold",children:"Prescription:"})," ",he.data.prescriptionForUnavailableDrugs]})]})}),i.jsx(LJ,{isOpen:au,onClose:()=>Rr(!1),patientId:l,pharmacyInventory:Un,fetchPharmacyOrdersData:ur}),i.jsx(Jv,{title:"Lab History (Orders & Reports)",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:nf,className:"button-primary blue text-xs px-2 py-1",title:"Tell AI to analyse the reports",disabled:oi,children:"Analyse Reports"}),i.jsxs("button",{onClick:()=>Yd(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new lab order",disabled:!l,children:[i.jsx(Md,{size:12,className:"mr-1"})," Create Lab Order"]})]}),items:Gr,onSaveLabOrder:Jd,onCancelEditLabOrder:hu,onLabOrderTestChange:rp,onLabOrderStatusChange:pu,onBillLabOrder:ip,labInventory:jn,isSavingLabOrder:Wo,isLoading:Js||Ge,loadingText:"Loading...",noDataText:"No lab Hx.",expandedLabReports:ha,toggleLabReport:va,renderItemContent:(he,Q)=>{const ie=DQ(he.data.report?he.data.report.status:he.data.status);return i.jsxs("div",{className:"ai-context-text",children:[he.data.serialNumber,". ",i.jsx("span",{className:"font-medium",children:"[Order]"})," ",he.data.tests&&he.data.tests.length>0?he.data.tests.map(ce=>i.jsxs("strong",{children:[ce.name," (",ce.price,")"]},ce.id||ce.name)).reduce((ce,Ee)=>[ce,", ",Ee]):i.jsx("span",{className:"italic text-gray-500",children:"No tests specified"})," ",he.data.tests&&he.data.tests.length>0&&i.jsxs("span",{className:"font-bold ml-2",children:["Total: ",he.data.tests.reduce((ce,Ee)=>ce+(Number(Ee.price)||0),0).toFixed(2)]}),"(",i.jsx("span",{className:ie.className,children:ie.text}),")",i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(he.originalDateString).toLocaleDateString(),")"]}),i.jsxs("div",{className:"inline-flex space-x-2 ml-2",children:[i.jsx("button",{onClick:()=>ap(he.data),className:"icon-button small",title:"Enter/Edit Report",children:i.jsx(Uo,{size:12})}),i.jsx("button",{onClick:()=>sp(he.data),className:"icon-button small",title:"View Full Report",children:i.jsx(y1,{size:12})}),i.jsx("button",{onClick:()=>xa(he.data.id),className:"icon-button small",title:"Edit Order Details",children:i.jsx(jd,{size:12})}),i.jsx("button",{onClick:()=>ws({type:"Lab Order",data:he.data}),className:"icon-button small text-red-500",title:"Delete Lab Order",children:i.jsx(ti,{size:12})})]}),he.data.report&&i.jsxs("div",{className:"ml-4 mt-1 p-2 border-l-2 border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-medium",children:"[Report]"}),i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(he.data.report.report_date).toLocaleDateString(),")"]}),i.jsx("button",{onClick:()=>va(he.data.report.reportId),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:ha[he.data.report.reportId]?"Collapse Report":"Expand Report",children:ha[he.data.report.reportId]?i.jsx(ub,{size:14}):i.jsx(cb,{size:14})})]}),ha[he.data.report.reportId]&&(()=>{try{const ce=JSON.parse(he.data.report.report_content||"{}");return typeof ce=="object"&&ce!==null&&he.data.report.tests?he.data.report.tests.map(Ee=>i.jsxs("div",{style:{marginBottom:"10px"},children:[i.jsx("h5",{className:"font-semibold text-sm mt-2 mb-1",children:Ee.name}),ce[Ee.id]?i.jsxs("table",{className:"lab-inventory-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2",children:"Parameter"}),i.jsx("th",{className:"py-1 px-2",children:"Value"}),i.jsx("th",{className:"py-1 px-2",children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(ce[Ee.id]).map(([We,lt])=>{var At;const ct=(At=Ee.default_parameters)==null?void 0:At.find(ci=>ci.name===We);return i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:We}),i.jsxs("td",{className:"py-1 px-2",children:[String(lt)," ",(ct==null?void 0:ct.unit)||""]}),i.jsx("td",{className:"py-1 px-2",children:(()=>{if(ct&&ct.type==="number"&&(ct.lower_limit!=null||ct.upper_limit!=null)){let ci="";return ct.lower_limit!=null&&(ci+=` > ${ct.lower_limit}`),ct.lower_limit!=null&&ct.upper_limit!=null&&(ci+=" - "),ct.upper_limit!=null&&(ci+=` < ${ct.upper_limit}`),ci.trim()||"N/A"}else if((ct==null?void 0:ct.type)==="boolean")return"N/A";return(ct==null?void 0:ct.normal_range)||"N/A"})()})]},We)})})]}):i.jsx("p",{className:"italic text-gray-500 text-xs",children:"No parameters reported for this test."})]},Ee.id)):i.jsx(Dl,{remarkPlugins:[Lo],children:he.data.report.report_content})}catch{return i.jsx(Dl,{remarkPlugins:[Lo],children:he.data.report.report_content||"*No findings recorded.*"})}})()]})]})}}),i.jsx(aJ,{isOpen:iu,onClose:()=>Yd(!1),patientId:l,labInventory:jn,fetchPendingLabOrdersData:Kl}),i.jsx(Jv,{title:"Complaints History",items:Ui,isLoading:Be,loadingText:"Loading...",noDataText:"No past Hx.",renderItemContent:(he,Q)=>i.jsxs("span",{className:"ai-context-text",children:[he.data.complaint,i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(he.originalDateString).toLocaleDateString(),")"]})]}),onDeleteItem:ws}),i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("h4",{className:"ai-context-section-title",children:[i.jsx(yg,{size:16,className:"text-purple-600"})," Clinic-wide System Prompt"]}),!nl&&i.jsx("button",{onClick:op,className:"edit-button",title:"Edit System Prompt",disabled:Zn||si||Wa,children:i.jsx(jd,{size:14})})]}),nl&&Xt?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:Ya,onChange:he=>xs(he.target.value),className:"context-edit-textarea",placeholder:"Enter clinic system prompt...",disabled:si||Wa}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:tc,disabled:si||Wa,className:"button-secondary",children:"Cancel"}),i.jsxs("button",{onClick:oo,disabled:si||Wa||Ga===Xt.aiMemory&&Ya===Xt.clinicWideSystemPrompt,className:"button-primary purple",children:[i.jsx(Rd,{size:14,className:"mr-1"}),Wa||si?"Saving...":"Save Settings"]})]})]}):i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:Xt!=null&&Xt.clinicWideSystemPrompt?i.jsx(Dl,{remarkPlugins:[Lo],children:Xt.clinicWideSystemPrompt}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),!nl&&(Xt==null?void 0:Xt.clinicWideSystemPromptUpdatedAt)&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Prompt Last Updated: ",new Date(Xt.clinicWideSystemPromptUpdatedAt).toLocaleDateString()]})]}),i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title",children:"Case Summary"}),!E&&i.jsx("button",{onClick:ec,className:"edit-button",title:"Edit Case Summary",disabled:L||q,children:i.jsx(jd,{size:14})})]}),E?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:I,onChange:he=>D(he.target.value),className:"context-edit-textarea",rows:4,placeholder:"Enter case summary...",disabled:q}),F&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:F}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:ao,disabled:q,className:"button-secondary",children:"Cancel"}),i.jsx("button",{onClick:so,disabled:q||I===S,className:"button-primary blue",children:q?"Saving...":"Save"})]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:S?i.jsx(Dl,{remarkPlugins:[Lo],components:{},children:S}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),z&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Last Edited: ",new Date(z).toLocaleDateString()]})]})]}),Ui.length===0&&Gr.length===0&&qi.length===0&&!(Be||Js||Ge)&&i.jsx("p",{className:"ai-context-text italic mt-4",children:"No recent history for this patient."}),Go&&i.jsx("p",{className:"text-yellow-600 text-xs mt-2 ai-context-text",children:"Deleting..."}),Yo&&i.jsx("p",{className:"text-red-600 text-xs mt-2 ai-context-text",children:Yo})]})})]}),i.jsxs("div",{className:"edit-complaint-input-area",children:[i.jsxs("div",{className:"status-messages-container",children:[nt&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:nt}),Be&&i.jsx("div",{className:"loading-animation-container",children:i.jsx("div",{className:"loading-text",children:"Loading past complaints..."})}),Y&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Y}),Js&&i.jsx("div",{className:"loading-animation-container",children:i.jsx("div",{className:"loading-text",children:"Loading pending lab orders..."})}),Gd&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Gd}),dn&&i.jsx("div",{className:"loading-animation-container",children:i.jsx("div",{className:"loading-text",children:"Loading inventory..."})}),Ur&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Ur}),L&&i.jsx("div",{className:"loading-animation-container",children:i.jsx("div",{className:"loading-text",children:"Loading..."})})]}),e&&!H&&i.jsxs(w.Fragment,{children:[il&&i.jsxs("div",{className:"follow-up-question-container",children:[i.jsx("p",{className:"question-text",children:il}),Zl.length>0&&i.jsx("div",{className:"options-grid",children:Zl.map((he,Q)=>i.jsx("button",{onClick:()=>tf(he),className:"option-button",children:he},Q))})]}),to&&i.jsx("div",{className:"speech-error-display",children:to}),zi&&i.jsxs("div",{className:"selected-file-display",children:[i.jsxs("span",{children:["Selected: ",zi.name]}),i.jsx("button",{onClick:()=>{Ql(null),ys.current&&(ys.current.value="")},className:"remove-file-button",title:"Remove image",children:""})]}),i.jsx("div",{className:"input-wrapper",children:i.jsxs("div",{className:"main-input-container",children:[i.jsx("input",{type:"file",ref:ys,onChange:af,accept:"image/*",className:"hidden"}),i.jsx("textarea",{ref:ke,className:"complaint-textarea",value:r,onChange:he=>a(he.target.value),onKeyDown:nc,placeholder:"name,age,sex,phone,complaints,reports,history",disabled:oi||!e||eo}),i.jsxs("div",{className:"chat-input-actions-container",children:[l&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>n(`/patient/${l}/lab-reports`),disabled:Ge||!l,className:"icon-button",title:"View Lab Reports",children:i.jsx(Uo,{size:14})}),i.jsx("button",{onClick:()=>n("/inventory"),disabled:dn,className:"icon-button",title:"View Inventory",children:i.jsx(Id,{size:14})})]}),i.jsx("button",{type:"button",onClick:rf,disabled:oi||!e||eo,className:"icon-button",title:"Attach Image",children:i.jsx(LM,{size:14})}),i.jsx("button",{type:"button",onClick:gu,disabled:oi||!e||!ai.current,className:`mic-button ${eo?"listening":""}`,title:eo?"Stop":"Mic",children:i.jsx(_k,{size:14})}),i.jsx("button",{onClick:()=>Ss(),disabled:oi||dn||H||!r.trim()||!e||eo,className:"send-button",title:oi||dn||H?"Processing...":"Save & Ask AI",children:oi?i.jsx("span",{className:"animate-spin",role:"status","aria-label":"loading"}):i.jsx(Pl,{size:14})})]})]})})]})]})]})},Fne=()=>{const{patientId:e}=ki(),n=wt(),[t,r]=w.useState([]),[a,s]=w.useState(null),[l,f]=w.useState(!1),[d,u]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){u("Patient ID not provided.");return}f(!0),u(null);try{const b=await ge(`/api/patients/${e}`);if(!b.ok)throw new Error(`Failed to fetch patient details: ${b.status}`);const v=await b.json();s({name:v.name,age:v.age,gender:v.gender});const S=await ge(`/api/patients/${e}/complaints`);if(S.ok){const E=(await S.json()).sort((T,I)=>new Date(I.createdAt).getTime()-new Date(T.createdAt).getTime());r(E)}else if(S.status===404)r([]);else throw new Error(`Failed to fetch complaints: ${S.status}`)}catch(b){console.error("Error fetching past complaints or patient info:",b),u(`Failed to load data. ${b.message}`),r([]),s(null)}finally{f(!1)}})()},[e]);const h=g=>{navigator.clipboard.writeText(g).then(()=>console.log("Complaint copied to clipboard")).catch(b=>console.error("Failed to copy complaint: ",b))};return i.jsxs("div",{className:"container mx-auto p-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-1 px-3 rounded text-sm",children:"< Back"}),i.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-center flex-grow",children:"Past Complaints"}),i.jsx("div",{className:"w-16"})," "]}),a&&i.jsxs("div",{className:"mb-4 p-2 bg-gray-100 rounded text-center text-sm sm:text-base",children:["Patient: ",i.jsx("strong",{children:a.name})," (",a.age??"N/A"," / ",a.gender??"N/A",")"]}),d&&i.jsxs("div",{className:"text-red-500 p-3 mb-4 border border-red-500 rounded bg-red-50 text-sm",children:["Error: ",d]}),l&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading..."}),!l&&t.length===0&&!d&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No past complaints found for this patient."}),!l&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(g=>i.jsxs("div",{className:"p-3 border rounded shadow-sm bg-white group relative",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:new Date(g.createdAt).toLocaleString()}),i.jsx("p",{className:"text-sm whitespace-pre-wrap",children:g.complaint}),i.jsx("button",{onClick:()=>h(g.complaint),className:"absolute top-1 right-1 bg-gray-200 hover:bg-gray-300 text-gray-600 text-xs p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Copy complaint text",children:""})]},g.id))})]})},Vx=500,H_="defaultConsultationFee",$ne=({patientId:e,billId:n,queueId:t,onBillCreated:r,onBillUpdated:a,initialItems:s=[],billType:l="other",relatedId:f,initialStatus:d="pending",initialDiscountPercentage:u=0,readOnlyMode:h=!1,doctorId:g,labOrderId:b,patientInsuranceType:v})=>{const[S,k]=w.useState(null),[E,T]=w.useState([]),I=w.useRef([]),[D,q]=w.useState(""),[R,F]=w.useState(""),[U,z]=w.useState(1),[V,L]=w.useState(u),[$,H]=w.useState("cash"),[ee,te]=w.useState(!1),[ae,Z]=w.useState(null),[B,K]=w.useState(!1),[oe,A]=w.useState(!1),[se,ue]=w.useState(!1),[M,pe]=w.useState(null),[,be]=w.useState([]),[fe,Pe]=w.useState(null),[de,Me]=w.useState(""),[Ze,Fe]=w.useState("cash"),[Ce,Re]=w.useState(!1),[xe,Ie]=w.useState(Vx),[Ge,ze]=w.useState(Vx.toString()),nt=n?"view_pay":"create";w.useEffect(()=>{const Ve=localStorage.getItem(H_),tt=Ve?parseFloat(Ve):Vx;isNaN(tt)||(Ie(tt),ze(tt.toString()))},[]);const jt=s.length===0;w.useEffect(()=>{e?(async()=>{te(!0),Z(null);try{const tt=await ge(`/api/patients/${e}`);if(!tt.ok){const ot=await tt.json().catch(()=>({}));throw new Error(ot.message||"Failed to fetch patient details")}const Le=await tt.json();k(Le)}catch(tt){Z(`Failed to load patient details: ${tt.message}`),k(null)}finally{te(!1)}})():k(null)},[e]),w.useEffect(()=>{n?(async()=>{ue(!0),Z(null),pe(null),be([]),Pe(null);try{const tt=await ge(`/api/bills/${n}`);if(!tt.ok){const ot=await tt.json().catch(()=>({}));throw new Error(ot.message||"Failed to fetch bill details")}const Le=await tt.json();if(!Le.bill||!Le.payments||!Le.calculated)throw new Error("Invalid bill details structure.");pe(Le.bill),be(Le.payments),Pe(Le.calculated),L(Le.bill.discount_percentage!==void 0&&Le.bill.discount_percentage!==null?parseFloat(Le.bill.discount_percentage.toString()):0),!S&&Le.bill.patient_id&&xt(Le.bill.patient_id.toString())}catch(tt){Z(`Failed to load bill details: ${tt.message}`),pe(null),be([]),Pe(null)}finally{ue(!1)}})():(pe(null),be([]),Pe(null))},[n]);const xt=async Ve=>{te(!0);try{const tt=await ge(`/api/patients/${Ve}`);if(!tt.ok)throw new Error("Failed to fetch patient");const Le=await tt.json();k(Le)}catch(tt){console.error("Error fetching patient details:",tt),k(null)}finally{te(!1)}},ve=w.useCallback(async Ve=>{A(!0),Z(null);const tt=Ve.filter(Le=>Le.drug_id!=null).map(async Le=>{try{const ot=await ge(`/api/drugs/${Le.drug_id}`);if(!ot.ok)throw new Error(`Drug ${Le.drug_id} not found.`);const et=await ot.json();return{...Le,price:et.price,total:et.price*Le.quantity}}catch{return Z(et=>`${et?et+"; ":""}Failed to fetch price for ${Le.name}`),Le}});try{const Le=await Promise.all(tt);T(ot=>{const et=new Map(Le.map(bt=>[bt.id,bt]));return ot.map(bt=>et.get(bt.id)||bt)})}catch{}finally{A(!1)}},[ge]);w.useEffect(()=>{if(n){T([]),I.current=[];return}JSON.stringify(s)===JSON.stringify(I.current)||(async()=>{let Le=[];if(s&&s.length>0)Le=s.map((ot,et)=>({...ot,id:`initial-${et}-${Date.now()}`})),H(d==="paid"?"cash":v==="no_cash_insurance"?"no_cash_insurance":"cash"),L(u),l==="pharmacy"&&!h&&await ve(Le);else if(e&&jt&&l==="consultation"){let ot=xe;if(g)try{const et=await ge(`/api/staff/${g}`);if(!et.ok){const Un=await et.json().catch(()=>({}));throw new Error(Un.message||"Doctor not found or error fetching fee")}const bt=await et.json();bt.opd_fee!=null&&!isNaN(parseFloat(String(bt.opd_fee)))&&parseFloat(String(bt.opd_fee))>=0&&(ot=parseFloat(String(bt.opd_fee)))}catch(et){Z(bt=>`${bt?bt+"; ":""}Could not fetch doctor's fee, using default. (${et.message})`)}Le=[{id:Date.now(),name:"Consultation Fee",price:ot,quantity:1,total:ot*1,drug_id:null}],H(v==="no_cash_insurance"?"no_cash_insurance":"cash")}else Le=[],H(v==="no_cash_insurance"?"no_cash_insurance":"cash");T(Le),I.current=s})()},[n,e,g,s,l,xe,jt,d,h,ve,u,v]);const qe=()=>{const Ve=parseFloat(R);if(!h)if(D&&!isNaN(Ve)&&Ve>=0&&U>0){if(D.trim().toLowerCase()==="consultation fee"&&E.some(Le=>Le.name.toLowerCase()==="consultation fee")){alert("Consultation Fee already added.");return}const tt={id:Date.now(),name:D.trim(),price:Ve,quantity:U,total:Ve*U,drug_id:null};T([...E,tt]),q(""),F(""),z(1)}else alert("Invalid item details.")},Qe=Ve=>{h||T(E.filter(tt=>tt.id!==Ve))},Be=w.useMemo(()=>{let Ve=E.reduce((tt,Le)=>tt+Le.total,0);return nt==="create"&&V>0&&(Ve=Ve*(1-V/100)),(fe==null?void 0:fe.totalDue)!==void 0&&(fe==null?void 0:fe.totalDue)!==null?fe.totalDue:Ve},[E,fe,V,nt]),J=w.useMemo(()=>(fe==null?void 0:fe.totalPaid)??0,[fe]),Y=w.useMemo(()=>(fe==null?void 0:fe.balance)!==void 0&&(fe==null?void 0:fe.balance)!==null?fe.balance:Be-J,[fe,Be,J]),X=()=>{const Ve=parseFloat(Ge);!isNaN(Ve)&&Ve>=0?(Ie(Ve),localStorage.setItem(H_,Ve.toString()),alert(`Default Fee set to ${Ve.toFixed(2)}`)):alert("Invalid fee amount.")},Ne=async(Ve,tt)=>{K(!0),Z(null);try{const Le=await ge("/api/payment/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:tt,billId:Ve})}),ot=await Le.json();if(!Le.ok||!ot.order)throw new Error(ot.message||"Failed to create Razorpay order.");const{key_id:et,order:bt}=ot,Un={key:et,amount:bt.amount,currency:bt.currency,name:"Newtons OPD Zero Clinic",description:`Bill Payment for Patient ID: ${e}`,order_id:bt.id,handler:async function(Ln){try{const jn=await ge("/api/payment/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({razorpay_payment_id:Ln.razorpay_payment_id,razorpay_order_id:Ln.razorpay_order_id,razorpay_signature:Ln.razorpay_signature,billId:Ve})}),gn=await jn.json();if(jn.ok&&gn.success)alert("Payment Successful!"),r&&r(Ve),a&&a(),setTimeout(()=>window.print(),200);else throw new Error(gn.message||"Payment verification failed.")}catch(jn){Z(`Payment verification failed: ${jn.message}. Contact support.`)}finally{K(!1)}},prefill:{name:(S==null?void 0:S.name)||""},notes:{bill_id:Ve,patient_id:e},theme:{color:"#3399cc"},modal:{ondismiss:function(){Z("Payment cancelled."),K(!1)}}};if(window.Razorpay)new window.Razorpay(Un).open();else throw new Error("Razorpay SDK not loaded.")}catch(Le){Z(`Failed to initiate online payment: ${Le.message}`),K(!1)}},ke=async()=>{if(!n){Z("Bill ID is missing.");return}if(!de||isNaN(parseFloat(de))||parseFloat(de)<=0){Z("Please enter a valid positive payment amount.");return}Re(!0),Z(null);const Ve={amount_paid:parseFloat(de),payment_mode:Ze};try{const tt=await ge(`/api/bills/${n}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ve)}),Le=await tt.json();if(!tt.ok)throw new Error(Le.message||`Failed to record payment (Status: ${tt.status})`);alert(`Payment of ${Ve.amount_paid.toFixed(2)} recorded.`),Me(""),a?a():console.log("Payment recorded.")}catch(tt){Z(`Failed to record payment: ${tt.message}`)}finally{Re(!1)}},Ue=async()=>{if(nt==="view_pay")return;if(!e){Z("Patient ID is missing for creating a bill.");return}if(E.length===0){Z("Cannot finalize an empty bill.");return}K(!0),Z(null);const Ve=Be,tt=E.map(({id:Le,...ot})=>ot);if($==="online"){const Le={patientId:e,queueId:t||null,items:tt,amount:Ve,paymentMode:"online",type:l,related_id:f||b||null,status:"pending",discountPercentage:V,labOrderId:b||null};try{const ot=await ge("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Le)}),et=await ot.json();if(!ot.ok)throw new Error(et.message||"Failed to create pending bill.");Ne(et.id,Math.round(Ve*100))}catch(ot){Z(`Failed to create pending bill: ${ot.message}`),K(!1)}}else{const Le="paid";if(!$){Z("Payment mode required."),K(!1);return}const ot={patientId:e,queueId:t||null,items:tt,amount:Ve,paymentMode:$,type:l,related_id:f||b||null,status:Le,discountPercentage:V,labOrderId:b||null};setTimeout(()=>window.print(),200);try{const et=await ge("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ot)}),bt=await et.json();if(!et.ok)throw new Error(bt.message||"Failed to create bill.");alert("Bill marked as paid!"),r&&r(bt.id),K(!1)}catch(et){Z(`Failed to process bill: ${et.message}`),K(!1)}}},it=(M==null?void 0:M.type)??l,mt=(M==null?void 0:M.status)??d,ht=nt==="view_pay"&&M&&mt==="pending";return!e&&!n?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow text-gray-500",children:"Select patient or provide Bill ID."}):ee||nt==="view_pay"&&se?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow",children:"Loading..."}):nt==="view_pay"&&!M&&!se&&ae?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading bill: ",ae]}):nt==="create"&&!S&&!ee&&ae?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading patient: ",ae]}):i.jsxs("div",{className:"billing-component-container printable-section",children:[i.jsxs("div",{className:"billing-header",children:[i.jsx("h2",{children:nt==="create"?"Create Bill":"Bill Details"}),nt==="create"&&l==="consultation"&&!h&&i.jsxs("div",{className:"default-fee-section",children:[i.jsx("label",{htmlFor:"defaultFee",className:"whitespace-nowrap",children:"Default Fee:"}),i.jsx("input",{id:"defaultFee",type:"number",value:Ge,onChange:Ve=>ze(Ve.target.value),className:"",placeholder:Vx.toString(),disabled:h}),i.jsx("button",{onClick:X,title:"Set Default Fee",className:"",disabled:h,children:i.jsx(Rd,{size:16})})]})]}),ae&&!se&&!Ce&&i.jsxs("div",{className:"error-message",role:"alert",children:[i.jsx("strong",{children:"Error: "}),ae]}),S&&i.jsxs("div",{className:"patient-details-section",children:[i.jsx("h3",{children:"Patient Details"}),i.jsxs("p",{children:[i.jsx("strong",{children:"ID:"})," ",S.id]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",S.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Age:"})," ",S.age||"N/A",", ",i.jsx("strong",{children:"Gender:"})," ",S.gender||"N/A"]})]}),i.jsxs("div",{className:"bill-items-summary-section",children:[i.jsxs("div",{className:"bill-items-header",children:[i.jsx("h3",{children:nt==="create"?"Bill Items":"Billing Summary"}),nt==="create"&&l==="pharmacy"&&!h&&E.some(Ve=>Ve.drug_id!=null)&&i.jsxs("button",{onClick:()=>ve(E),disabled:oe,className:"refresh-prices-button",title:"Refresh item prices from inventory",children:[i.jsx(fb,{size:14,className:`lucide ${oe?"animate-spin":""}`}),oe?"Refreshing...":"Refresh"]})]}),nt==="view_pay"&&M&&i.jsxs("div",{className:"bill-info-bar",children:[i.jsxs("span",{children:["Bill ID: ",i.jsx("strong",{children:M.id})]}),i.jsxs("span",{children:["Type: ",i.jsx("strong",{className:"capitalize",children:it})]}),i.jsxs("span",{children:["Status: ",i.jsx("strong",{className:`capitalize ${mt==="paid"?"status-paid":"status-pending"}`,children:mt})]})]}),(nt==="create"||nt==="view_pay"&&M)&&i.jsxs("div",{className:"bill-items-list",children:[nt==="create"&&oe&&E.length>0&&i.jsx("div",{className:"loading-placeholder",children:"Updating prices..."}),nt==="create"&&!oe&&E.map((Ve,tt)=>i.jsxs("div",{className:"bill-item",children:[i.jsxs("div",{className:"bill-item-details",children:[i.jsxs("span",{children:[tt+1,". ",Ve.name]}),Ve.quantity>1&&i.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",Ve.quantity,")"]})]}),i.jsxs("div",{className:"bill-item-price-actions",children:[i.jsxs("span",{className:"bill-item-price",children:["",Ve.total.toFixed(2)]}),nt==="create"&&typeof Ve.id=="number"&&!h&&i.jsxs("button",{onClick:()=>Qe(Ve.id),className:"remove-item-button",title:"Remove",children:[" ",i.jsx(Jn,{size:16})," "]}),(typeof Ve.id!="number"||h||Ve.name==="Consultation Fee")&&i.jsxs("span",{className:"lock-icon",title:"Cannot remove",children:[" ",i.jsx(tN,{size:14})," "]})]})]},Ve.id)),nt==="view_pay"&&M&&M.items.map((Ve,tt)=>i.jsxs("div",{className:"bill-item",children:[i.jsxs("div",{className:"bill-item-details",children:[i.jsxs("span",{children:[tt+1,". ",Ve.name]}),Ve.quantity>1&&i.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",Ve.quantity,")"]})]}),i.jsxs("div",{className:"bill-item-price-actions",children:[i.jsxs("span",{className:"bill-item-price",children:["",(Ve.total??Ve.price*Ve.quantity).toFixed(2)]}),i.jsxs("span",{className:"lock-icon",title:"Cannot remove from existing bill",children:[" ",i.jsx(tN,{size:14})," "]})]})]},tt)),nt==="create"&&E.length===0&&i.jsx("p",{className:"empty-items-message",children:"No items added."}),nt==="view_pay"&&M&&M.items.length===0&&i.jsx("p",{className:"empty-items-message",children:"No items in bill."})]}),nt==="create"&&!h&&i.jsxs("div",{className:"add-item-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Item"}),i.jsx("input",{type:"text",value:D,onChange:Ve=>q(Ve.target.value),placeholder:"Service/Item",className:"custom-text-input"})]}),i.jsxs("div",{className:"form-group",style:{flexGrow:.5,minWidth:"80px"},children:[i.jsx("label",{children:"Qty"}),i.jsx("input",{type:"number",min:"1",value:U,onChange:Ve=>z(parseInt(Ve.target.value)||1),placeholder:"1",className:"custom-text-input"})]}),i.jsxs("div",{className:"form-group",style:{flexGrow:.7,minWidth:"100px"},children:[i.jsx("label",{children:"Price ()"}),i.jsx("input",{type:"number",value:R,onChange:Ve=>F(Ve.target.value),placeholder:"0.00",className:"custom-text-input"})]}),i.jsx("button",{onClick:qe,className:"add-item-button",children:"Add"})]})]})," ",i.jsxs("div",{className:"billing-footer",children:[i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Total Amount:"}),i.jsxs("span",{className:"total-amount-value",children:["",typeof Be=="number"?Be.toFixed(2):"0.00"]}),nt==="create"&&!h&&i.jsxs("div",{className:"discount-section",children:[i.jsx("label",{htmlFor:"discountPercentage",className:"whitespace-nowrap",children:"Discount (%):"}),i.jsx("input",{id:"discountPercentage",type:"number",min:"0",max:"100",step:"0.01",value:V,onChange:Ve=>L(parseFloat(Ve.target.value)||0),className:"",disabled:h||B})]}),nt==="view_pay"&&M&&(M.status==="pending"||M.status==="paid")&&i.jsxs("div",{className:"discount-section",children:[i.jsx("label",{className:"whitespace-nowrap",children:"Discount (%):"}),i.jsxs("span",{className:"discount-value",children:[V.toFixed(2),"%"]})]})]}),nt==="view_pay"&&fe&&i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Amount Paid:"}),i.jsxs("span",{className:"total-amount-value",children:["",J.toFixed(2)]})]}),nt==="view_pay"&&fe&&i.jsxs("div",{className:"total-amount-section",children:[i.jsx("span",{className:"total-amount-label",children:"Balance Due:"}),i.jsxs("span",{className:"total-amount-value",children:["",Y.toFixed(2)]})]}),i.jsxs("div",{className:"footer-actions",children:[nt==="create"&&!h&&i.jsxs("div",{className:"action-group",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Payment Mode"}),i.jsxs("select",{value:$,onChange:Ve=>H(Ve.target.value),className:"custom-select-input",disabled:h||B,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"online",children:"Pay Online (Razorpay)"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsx("button",{onClick:Ue,disabled:B||E.length===0||h,className:"finalize-button",children:B?"Processing...":"Finalize Bill"})]}),nt==="view_pay"&&ht&&!h&&i.jsxs("div",{className:"action-group",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Record Payment Amount ()"}),i.jsx("input",{type:"number",value:de,onChange:Ve=>Me(Ve.target.value),placeholder:`Max: ${Y.toFixed(2)}`,className:"custom-text-input",disabled:Ce})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Payment Mode"}),i.jsxs("select",{value:Ze,onChange:Ve=>Fe(Ve.target.value),className:"custom-select-input",disabled:Ce,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),i.jsx("button",{onClick:ke,disabled:Ce||!de||parseFloat(de)<=0||parseFloat(de)>Y,className:"record-payment-button",children:Ce?"Recording...":"Record Payment"})]}),nt==="create"&&h&&E.length>0&&i.jsx("div",{className:"status-message read-only",children:"Read-only."}),nt==="view_pay"&&mt==="paid"&&i.jsx("div",{className:"status-message paid",children:"PAID."}),nt==="view_pay"&&mt==="cancelled"&&i.jsx("div",{className:"status-message cancelled",children:"CANCELLED."})]})]})]})},zne=()=>{const e=wt(),n=ni(),{patientId:t,queueId:r,patientName:a,initialItems:s,billType:l,relatedId:f,initialStatus:d,initialDiscountPercentage:u,doctorId:h,billId:g,labOrderId:b}=n.state||{},[v,S]=w.useState(null),[k,E]=w.useState(null),[T,I]=w.useState(null),[D,q]=w.useState(null),[R,F]=w.useState(null),[U,z]=w.useState(null),[V,L]=w.useState(null),[$,H]=w.useState(null),[ee,te]=w.useState(!0),[ae,Z]=w.useState(null),[B,K]=w.useState(a||"");w.useEffect(()=>{if(!t){console.error("BillingPage loaded without required patientId in location state."),e("/");return}(async()=>{te(!0),Z(null);try{let pe=t,be=s||null,fe=d||null,Pe=l||null,de=f||null,Me=u!==void 0?parseFloat(u):null,Ze=a||null,Fe=null;if(g){console.log(`Fetching details for Bill ID: ${g}`);const Ce=await ge(`/api/bills/${g}`);if(!Ce.ok){const xe=await Ce.json().catch(()=>({message:`Failed to fetch bill details for ID ${g}`}));throw new Error(xe.message||`Failed to fetch bill details (Status: ${Ce.status})`)}const Re=await Ce.json();if(console.log("Fetched Bill Data:",Re),be=Re.bill.items||[],fe=Re.bill.status||"pending",Pe=Re.bill.type||null,de=Re.bill.related_id||null,Me=Re.bill.discount_percentage!==void 0&&Re.bill.discount_percentage!==null?parseFloat(Re.bill.discount_percentage):0,pe=Re.bill.patient_id,q(be),F(fe),z(Pe),L(de),H(Me),pe){const xe=await ge(`/api/patients/${pe}`);if(xe.ok){const Ie=await xe.json();Ze=Ie.name,Fe=Ie.phone??null,I(Ie.insurance_type??null),K(Ze),E(Fe)}else console.warn(`Could not fetch patient details for ID ${pe} from bill.`),K("Patient (Not Found)")}else console.warn(`Bill ${g} does not have an associated patient_id.`),K("Patient (Unknown)")}else if(l==="consultation"&&h){console.log(`Creating consultation bill for doctor ID: ${h}`);const Ce=await ge(`/api/staff/${h}`);if(!Ce.ok){const Ie=await Ce.json().catch(()=>({}));throw new Error(Ie.message||`Failed to fetch doctor details (status ${Ce.status})`)}const Re=await Ce.json();console.log("Fetched Doctor Data:",Re);const xe=Re.opd_fee?parseFloat(String(Re.opd_fee)):0;if(xe>0?be=[{drug_id:h,name:`Consultation Fee - Dr. ${Re.name}`,price:xe,quantity:1,total:xe}]:be=[],fe="pending",Pe="consultation",de=r,q(be),F(fe),z(Pe),L(de),pe){const Ie=await ge(`/api/patients/${pe}`);if(Ie.ok){const Ge=await Ie.json();E(Ge.phone??null),I(Ge.insurance_type??null)}else console.warn(`Could not fetch patient details for ID ${pe}.`)}}else if(b){console.log(`Fetching details for Lab Order ID: ${b}`);const Ce=await ge(`/api/lab/${b}`);if(!Ce.ok){let xe=`Failed to fetch lab order details (Status: ${Ce.status} ${Ce.statusText})`;try{xe=(await Ce.json()).message||xe}catch{console.error("Response was not valid JSON:",await Ce.text())}throw new Error(xe)}const Re=await Ce.json();if(console.log("Fetched Lab Order Data:",JSON.stringify(Re,null,2)),be=(Re.tests||[]).filter(xe=>xe&&typeof xe.name=="string"&&xe.price!==void 0&&xe.id!==void 0).map(xe=>{const Ie=parseFloat(xe.price||"0"),Ge=!isNaN(Ie)&&isFinite(Ie)?Ie:0;return{drug_id:xe.id,name:xe.name,price:Ge,quantity:1,total:Ge*1,type:"lab_test"}}),be&&be.length===0&&(Re.tests||[]).length>0&&(console.warn("Warning: Some tests from the lab order were filtered out due to missing id, name, or price.",Re.tests),Z(xe=>`${xe?xe+"; ":""}Warning: Some lab items could not be added to the bill due to missing details.`)),fe="pending",Pe="lab",de=b,pe=Re.patient_id,q(be),F(fe),z(Pe),L(de),pe){const xe=await ge(`/api/patients/${pe}`);if(xe.ok){const Ie=await xe.json();Ze=Ie.name,Fe=Ie.phone??null,I(Ie.insurance_type??null),K(Ze),E(Fe)}else console.warn(`Could not fetch patient details for ID ${pe} from lab order.`),K("Patient (Not Found)")}else console.warn(`Lab Order ${b} does not have an associated patient_id.`),K("Patient (Unknown)")}else if(q(s||null),F(d||null),z(l||null),L(f||null),H(u!==void 0?parseFloat(u):null),K(a||`ID ${t}`),pe){const Ce=await ge(`/api/patients/${pe}`);if(Ce.ok){const Re=await Ce.json();E(Re.phone??null),I(Re.insurance_type??null)}else console.warn(`Could not fetch patient details for ID ${pe}.`)}if(r){const Ce=await ge(`/api/queue/${r}`);if(Ce.ok){const Re=await Ce.json();S(Re.token_number)}else console.warn(`Could not fetch queue details for ID ${r}.`)}}catch(pe){console.error("Error fetching billing page details:",pe),Z(`Failed to load details: ${pe.message}`),q(null),F(null),z(null),L(null),K(a||""),E(null),S(null)}finally{te(!1)}})()},[t,g,b,r,e]);const oe=M=>{console.log(`Billing process completed for patient ID ${t}. New Bill ID: ${M}`),e(-1)},A=()=>{console.log(`Bill updated for patient ID ${t}.`),e(-1)};if(!t)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-gray-600",children:[i.jsx(hb,{size:48,className:"mb-4 text-red-500"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Missing Patient Information"}),i.jsx("p",{className:"text-sm",children:"Cannot load the billing page without a patient ID."}),i.jsx("button",{onClick:()=>e("/"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Go to Dashboard"})]});if(ee)return i.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:i.jsx("p",{className:"text-teal-600 animate-pulse",children:"Loading Billing Details..."})});if(ae)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-red-600 p-4",children:[i.jsx(hb,{size:48,className:"mb-4"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Error Loading Billing Details"}),i.jsx("p",{className:"text-sm text-center mb-4",children:ae}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"}),i.jsx("button",{onClick:()=>e(-1),className:"mt-2 text-sm text-gray-600 hover:text-teal-700",children:"Go Back"})]});const ue=(R??d)==="paid";return i.jsxs("div",{className:"billing-page-container",children:[i.jsx("div",{className:"back-button-container",children:i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[i.jsx(Ut,{size:20,className:"lucide"})," Back"]})}),i.jsxs("div",{className:"billing-content-wrapper",children:[i.jsxs("h3",{className:"billing-page-title",children:[g?"Bill Details":b?"Create Lab Bill":"Create Bill"," for Patient: ",B||`ID ${t}`]}),i.jsxs("div",{className:"patient-info-bar",children:[v!==null&&i.jsxs("span",{children:[i.jsx(kd,{size:14,className:"lucide"})," Token: ",v]}),k&&i.jsxs("span",{children:[i.jsx(UM,{size:14,className:"lucide"})," Phone: ",k]}),b&&i.jsxs("span",{className:"lab-order-info",children:[i.jsx(db,{size:14,className:"lucide"})," Lab Order: ",b.substring(0,8),"..."]}),!k&&v===null&&!b&&i.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"}),T&&i.jsxs("span",{className:"insurance-info",children:[i.jsx(iR,{size:14,className:"lucide"})," Insurance: ",T.replace(/_/g," ").replace(/\b\w/g,M=>M.toUpperCase())]}),!k&&v===null&&!b&&!T&&i.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"})]}),i.jsx($ne,{patientId:t,labOrderId:b,queueId:r,onBillCreated:oe,onBillUpdated:A,initialItems:D??s,billType:U??l,relatedId:V??f,initialStatus:R??d,initialDiscountPercentage:$??u,readOnlyMode:ue,doctorId:h,patientInsuranceType:T??void 0})]})]})},Bne=({patientId:e,labOrderId:n,onBillingSuccess:t,initialItems:r,patientName:a})=>{const[s]=w.useState(r),[l,f]=w.useState(0),[d,u]=w.useState("cash"),[h,g]=w.useState(null),[b,v]=w.useState(!1),S=w.useMemo(()=>s.reduce((T,I)=>T+I.total,0)*(1-l/100),[s,l]),k=async()=>{if(s.length===0){g("Cannot finalize an empty bill.");return}v(!0),g(null);const E={patientId:e,items:s,amount:S,paymentMode:d,type:"lab",related_id:n,status:"paid",discountPercentage:l,labOrderId:n};try{const T=await ge("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)}),I=await T.json();if(!T.ok)throw new Error(I.message||"Failed to create bill.");alert("Bill created successfully!");const D=window.open("","_blank");if(D){const q=`
                    <html>
                        <head>
                            <title>Lab Bill</title>
                            <style>
                                body { font-family: sans-serif; }
                                .bill-container { max-width: 800px; margin: auto; padding: 20px; border: 1px solid #ccc; }
                                .bill-header { text-align: center; margin-bottom: 20px; }
                                .bill-item { display: flex; justify-content: space-between; padding: 5px 0; }
                                .bill-total { text-align: right; margin-top: 20px; font-weight: bold; }
                            </style>
                        </head>
                        <body>
                            <div class="bill-container">
                                <div class="bill-header">
                                    <h2>Lab Bill for ${a}</h2>
                                </div>
                                <div class="bill-items-list">
                                    ${s.map(R=>`
                                        <div class="bill-item">
                                            <span>${R.name}</span>
                                            <span>${R.total.toFixed(2)}</span>
                                        </div>
                                    `).join("")}
                                </div>
                                <div class="bill-total">
                                    Total: ${S.toFixed(2)}
                                </div>
                            </div>
                        </body>
                    </html>
                `;D.document.write(q),D.document.close(),D.print()}t()}catch(T){g(`Failed to process bill: ${T.message}`)}finally{v(!1)}};return i.jsxs("div",{className:"billing-layout",children:[i.jsx("main",{className:"order-content",children:i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Lab Tests"})}),s.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"PRICE"})]})}),i.jsx("tbody",{children:s.map((E,T)=>i.jsxs("tr",{children:[i.jsx("td",{children:T+1}),i.jsx("td",{children:E.name}),i.jsx("td",{children:E.total.toFixed(2)})]},T))})]}):i.jsx("p",{children:"No lab tests in this order."})]})}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",s.reduce((E,T)=>E+T.total,0).toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:l,onChange:E=>f(parseFloat(E.target.value)||0),min:"0",max:"100",className:"discount-input-total",disabled:b}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",S.toFixed(2)]})]}),h&&i.jsx("p",{className:"error-message",style:{color:"red",textAlign:"center"},children:h}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:d,onChange:E=>u(E.target.value),className:"payment-mode-select",disabled:b,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsx("div",{className:"bill-actions",children:i.jsx("button",{onClick:k,className:"primary-button",disabled:b||s.length===0,children:b?"Processing...":"Finalise and Bill"})})]})})]})},Une=()=>{const e=wt(),n=ni(),{labOrderId:t}=n.state||{},[r,a]=w.useState(null),[s,l]=w.useState(""),[f,d]=w.useState(null),[u,h]=w.useState(null),[g,b]=w.useState(null),[v,S]=w.useState(!0),[k,E]=w.useState(null);w.useEffect(()=>{if(!t){console.error("LabBillingPage loaded without a labOrderId."),e("/");return}(async()=>{S(!0),E(null);try{const D=await ge(`/api/lab/${t}`);if(!D.ok){const F=await D.json().catch(()=>({}));throw new Error(F.message||`Failed to fetch lab order details (Status: ${D.status})`)}const q=await D.json(),R=(q.tests||[]).filter(F=>F&&typeof F.name=="string"&&F.price!==void 0&&F.id!==void 0).map(F=>{const U=parseFloat(F.price||"0"),z=!isNaN(U)&&isFinite(U)?U:0;return{drug_id:F.id,name:F.name,price:z,quantity:1,total:z,type:"lab_test"}});if(b(R),q.patient_id){a(q.patient_id);const F=await ge(`/api/patients/${q.patient_id}`);if(F.ok){const U=await F.json();l(U.name),d(U.phone??null),h(U.insurance_type??null)}else l("Patient (Not Found)")}else throw new Error("Lab order does not have an associated patient.")}catch(D){console.error("Error fetching lab billing details:",D),E(`Failed to load details: ${D.message}`)}finally{S(!1)}})()},[t,e]);const T=()=>{console.log(`Lab billing process completed for Lab Order ID: ${t}`),e(-1)};return t?v?i.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:i.jsx("p",{className:"text-teal-600 animate-pulse",children:"Loading Lab Bill..."})}):k?i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-red-600 p-4",children:[i.jsx(hb,{size:48,className:"mb-4"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Error Loading Lab Bill"}),i.jsx("p",{className:"text-sm text-center mb-4",children:k}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"}),i.jsx("button",{onClick:()=>e(-1),className:"mt-2 text-sm text-gray-600 hover:text-teal-700",children:"Go Back"})]}):i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(Ut,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Lab Bill"})]}),i.jsx("div",{className:"billing-layout",children:i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Patient Name:"})," ",s]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Phone:"})," ",f||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Lab Order ID:"})," ",t]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Insurance:"})," ",u?u.replace(/_/g," "):"N/A"]})]})]}),r&&g&&i.jsx(Bne,{patientId:r,labOrderId:t,onBillingSuccess:T,initialItems:g,patientInsuranceType:u,patientName:s})]})})]})}):i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-gray-600",children:[i.jsx(hb,{size:48,className:"mb-4 text-red-500"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Missing Lab Order Information"}),i.jsx("p",{className:"text-sm",children:"Cannot load the lab billing page without a lab order ID."}),i.jsx("button",{onClick:()=>e("/"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Go to Dashboard"})]})},qne=()=>{const{patientId:e}=ki(),n=wt(),[t,r]=w.useState([]),[a,s]=w.useState(!1),[l,f]=w.useState(null),[d,u]=w.useState("");return w.useEffect(()=>{(async()=>{if(!e){f("Patient ID not provided in URL.");return}s(!0),f(null),r([]);try{try{const v=await ge(`/api/patients/${e}`);if(v.ok){const S=await v.json();u(S.name)}}catch(v){console.warn("Could not fetch patient name:",v)}console.log(`Fetching pharmacy orders for patient ID: ${e}`);const g=await ge(`/api/pharmacy-orders/patient/${e}`);if(!g.ok){const v=await g.json().catch(()=>({}));throw new Error(v.message||`HTTP error! status: ${g.status}`)}const b=await g.json();console.log("Fetched Pharmacy Orders:",b),r(b||[])}catch(g){console.error("Error fetching pharmacy orders:",g),f(`Failed to load pharmacy orders: ${g.message}`)}finally{s(!1)}})()},[e]),i.jsxs("div",{className:"p-4 md:p-6 max-w-4xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6 border-b pb-3",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-900",children:[i.jsx(Ut,{size:16,className:"mr-1"}),"Back"]}),i.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[i.jsx(Id,{size:20,className:"mr-2 text-purple-600"}),"Pharmacy Order History ",d&&`for ${d}`]}),i.jsx("div",{})," "]}),a&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading pharmacy orders..."}),l&&i.jsx("p",{className:"text-center text-red-500 bg-red-100 p-3 rounded border border-red-300",children:l}),!a&&t.length===0&&!l&&i.jsx("p",{className:"text-center text-gray-500",children:"No pharmacy orders found for this patient."}),!a&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(h=>i.jsxs("div",{className:"p-4 border rounded bg-white shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Date:"})," ",new Date(h.date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm font-medium capitalize",children:[i.jsx("strong",{children:"Status:"})," ",h.status]})]}),i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Prescribed By:"})," ",h.prescribedBy||"N/A"]}),h.dispensedBy&&i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Dispensed By:"})," ",h.dispensedBy]}),i.jsx("h4",{className:"text-md font-semibold mt-3 mb-1",children:"Medications:"}),i.jsx("ul",{className:"list-disc list-inside ml-4 text-sm text-gray-700 space-y-1",children:h.medications.map((g,b)=>i.jsxs("li",{children:[g.name," - Qty: ",g.quantity,g.tabletsPerDay&&` (${g.tabletsPerDay} per day`,g.numberOfDays&&` for ${g.numberOfDays} days)`,!g.tabletsPerDay&&g.numberOfDays&&` (for ${g.numberOfDays} days)`,g.tabletsPerDay&&!g.numberOfDays&&")"]},b))})]},h.id))})]})},Vne=()=>{const e=wt(),n=ni(),[t,r]=w.useState(null),[a,s]=w.useState([]),[l,f]=w.useState([]),[d,u]=w.useState(""),[h,g]=w.useState([]),[b,v]=w.useState(null),[S,k]=w.useState(!1),[E,T]=w.useState(null),[I,D]=w.useState(!0),[q,R]=w.useState(""),[F,U]=w.useState([]),[z,V]=w.useState(!1),[L,$]=w.useState(null),[H,ee]=w.useState(!1),[te,ae]=w.useState(!1),[Z,B]=w.useState([]),[K,oe]=w.useState(!1),[A,se]=w.useState(null),ue=/^\+?[0-9\s\-().]{7,20}$/,M=/^[a-zA-Z\s'-]{2,}$/,pe=w.useCallback(async()=>{try{const ve=await ge("/api/drugs");if(!ve.ok)throw new Error("Failed to fetch drugs");const qe=await ve.json();s(qe)}catch(ve){console.error("Failed to fetch available drugs:",ve),v("Could not load drug list. "+ve.message)}},[]),be=w.useCallback(async ve=>{oe(!0),se(null);try{const qe=await ge(`/api/pharmacy-orders/patient/${ve}`);if(!qe.ok){const Be=await qe.json().catch(()=>({}));throw new Error(Be.message||`HTTP error! status: ${qe.status}`)}const Qe=await qe.json();B(Qe||[])}catch(qe){console.error("Failed to fetch previous pharmacy orders:",qe),se(`Could not load previous orders: ${qe.message}`)}finally{oe(!1)}},[]);w.useEffect(()=>{var ve;pe(),(ve=n.state)!=null&&ve.patient?de(n.state.patient):D(!0)},[pe,n.state]),w.useEffect(()=>{t!=null&&t.id?be(t.id):B([])},[t,be]),w.useEffect(()=>{if(!d){g([]);return}const ve=d.toLowerCase();g(a.filter(qe=>{const Qe=qe.name&&qe.name.toLowerCase().includes(ve),Be=qe.brand_name&&qe.brand_name.toLowerCase().includes(ve);return Qe||Be}).slice(0,10))},[d,a]);const fe=w.useMemo(()=>qb(async ve=>{if(ve.trim().length<2){U([]),V(!1),$(null);return}V(!0),$(null);try{const qe=new URLSearchParams({search:encodeURIComponent(ve),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Qe=await ge(`/api/patients?${qe.toString()}`);if(!Qe.ok){const J=await Qe.text();throw new Error(`API Error (${Qe.status}): ${J||Qe.statusText}`)}const Be=await Qe.json();U(Be.patients)}catch(qe){console.error("Error searching patients:",qe),$(qe.message||"Failed to search patients."),U([])}finally{V(!1)}},300),[ue]),Pe=ve=>{const qe=ve.target.value;R(qe),ee(ue.test(qe)),ae(M.test(qe)&&!ue.test(qe)),V(!0),fe(qe)},de=w.useCallback(ve=>{r(ve),D(!1),R(""),U([]),$(null)},[]),Me=w.useCallback(async ve=>{if(!q||ve==="phone"&&!H||ve==="name"&&!te){$(`Invalid ${ve} to create a new patient.`);return}V(!0),$(null);try{const Qe=await ge("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:ve==="name"?q:"direct pharmacy",phone:ve==="phone"?q:null,age:null,gender:null,token:null})});if(!Qe.ok){const J=await Qe.json();throw new Error(J.message||`Failed to create patient: ${Qe.statusText}`)}const Be=await Qe.json();alert(`New patient "${Be.name}" created with ${ve==="phone"?`phone ${Be.phone}`:`name ${Be.name}`}.`),de(Be)}catch(qe){console.error("Error creating new patient:",qe),$(qe.message||"Failed to create new patient.")}finally{V(!1)}},[q,H,te,de]),Ze=()=>{r(null),D(!0),f([]),v(null),B([])},Fe=ve=>{if(l.some(qe=>qe.drug_id===ve.id)){const qe=ve.name||ve.brand_name||"This drug";v(`${qe} is already in the order.`),setTimeout(()=>v(null),3e3),u(""),g([]);return}f(qe=>[...qe,{drug_id:ve.id,name:ve.name||ve.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,tabletsPerDay:1,numberOfDays:1,price:Number(ve.price)||0,originalPrice:Number(ve.price)||0,stock:ve.quantity_in_stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(ve.price)||0)/(Re(ve.unit)||1),unit:ve.unit}]),u(""),g([])},Ce=()=>{const ve=d.trim();if(!ve){v("Please enter a drug name to navigate to the add drug page."),setTimeout(()=>v(null),3e3);return}e("/dashboard/inventory/add",{state:{initialDrugName:ve}}),u(""),g([])},Re=ve=>{if(!ve)return null;const qe=ve.match(/(?:\d+x)?(\d+)/);return qe?parseInt(qe[1],10):null},xe=ve=>{f(qe=>qe.filter(Qe=>(Qe.drug_id??Qe.name)!==ve))},Ie=(ve,qe)=>{f(Qe=>Qe.map(Be=>{if((Be.drug_id??Be.name)===ve&&Be.isLoose){const Y=Re(Be.unit),X=Math.max(0,qe),Ne=X*(Y??1)+(Be.looseUnits??0);return{...Be,loosePacks:X,looseQuantity:Ne}}return Be}))},Ge=(ve,qe)=>{f(Qe=>Qe.map(Be=>{if((Be.drug_id??Be.name)===ve&&Be.isLoose){const Y=Re(Be.unit),X=Math.max(0,qe),Ne=(Be.loosePacks??0)*(Y??1)+X;return{...Be,looseUnits:X,looseQuantity:Ne}}return Be}))},ze=ve=>{const qe=[];ve.medications.forEach(Qe=>{if(l.find(J=>J.drug_id&&Qe.drug_id&&J.drug_id===Qe.drug_id||J.name.toLowerCase()===Qe.name.toLowerCase()))f(J=>J.map(Y=>{if(Y.drug_id&&Qe.drug_id&&Y.drug_id===Qe.drug_id||Y.name.toLowerCase()===Qe.name.toLowerCase()){const X=(Y.pack_quantity??0)+(Qe.pack_quantity??0),Ne=(Y.loose_quantity??0)+(Qe.loose_quantity??0),ke=Qe.tabletsPerDay??Y.tabletsPerDay,Ue=Qe.numberOfDays??Y.numberOfDays,it=Re(Y.unit),mt=X*(it??1)+Ne;return{...Y,pack_quantity:X,loose_quantity:Ne,directions_to_use:Qe.directions_to_use??Y.directions_to_use,tabletsPerDay:ke,numberOfDays:Ue,looseQuantity:mt,loosePacks:Math.floor(mt/(it??1)),looseUnits:mt%(it??1)}}return Y}));else{let J=Qe.drug_id,Y=Qe.drug_id?a.find(X=>X.id===Qe.drug_id):void 0;if(!J&&Qe.name){const X=a.find(Ne=>Ne.name&&Ne.name.toLowerCase()===Qe.name.toLowerCase());X&&(J=X.id,Y=X)}qe.push({drug_id:J,name:Qe.name,pack_quantity:Qe.pack_quantity??0,loose_quantity:Qe.loose_quantity??0,directions_to_use:Qe.directions_to_use,tabletsPerDay:Qe.tabletsPerDay??1,numberOfDays:Qe.numberOfDays??1,price:Y?Y.price:Qe.price,stock:Y?Y.quantity_in_stock:Qe.stock,isLoose:!0,loosePacks:0,looseUnits:(Qe.pack_quantity??0)*(Re((Y==null?void 0:Y.unit)||Qe.unit)??1)+(Qe.loose_quantity??0),looseQuantity:(Qe.pack_quantity??0)*(Re((Y==null?void 0:Y.unit)||Qe.unit)??1)+(Qe.loose_quantity??0),pricePerLooseUnit:(Y?Number(Y.price):Number(Qe.price)||0)/(Re((Y==null?void 0:Y.unit)||Qe.unit)||1),unit:(Y==null?void 0:Y.unit)||Qe.unit})}}),f(Qe=>[...Qe,...qe]),ve.prescriptionForUnavailableDrugs&&(!E||!E.includes(ve.prescriptionForUnavailableDrugs))&&T(Qe=>Qe?`${Qe}

-- From Order ${ve.id.substring(0,8)} --
${ve.prescriptionForUnavailableDrugs}`:ve.prescriptionForUnavailableDrugs),v("Medications from previous order added to current order."),setTimeout(()=>v(null),3e3)},nt=async ve=>{if(ve.preventDefault(),v(null),k(!0),!t){v("No patient selected for the order."),k(!1);return}if(l.length===0&&!(E!=null&&E.trim())){v("Please add at least one medication or provide a prescription for unavailable drugs."),k(!1);return}const qe=l.filter(Be=>{const J=Be.looseQuantity??0;return J<=0||Be.stock!==void 0&&J>Be.stock});if(qe.length>0){v(`Invalid quantity or insufficient stock for: ${qe.map(Be=>Be.name).join(", ")}`),k(!1);return}const Qe={patient_id:t.id,items:l.map(Be=>{const J=Be.price??0,Y=Be.pricePerLooseUnit??0,X=Y*(Be.looseQuantity??0);return{drug_id:Be.drug_id===void 0?null:Be.drug_id,name:Be.name,pack_quantity:Be.loosePacks??0,loose_quantity:Be.looseUnits??0,pack_price:J,loose_price:Y,total_price:X,price:Be.originalPrice??0,directions_to_use:Be.directions_to_use===void 0?null:Be.directions_to_use,tabletsPerDay:Be.tabletsPerDay??1,numberOfDays:Be.numberOfDays??1}}),order_total:jt,prescription_for_unavailable_drugs:E};try{const Be=await ge("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Qe)});if(!Be.ok){const J=await Be.json();throw new Error(J.message||`Failed to create order: ${Be.statusText}`)}alert(`Pharmacy order created successfully for ${t.name}!`),e(-1)}catch(Be){console.error("Failed to create pharmacy order:",Be),v(Be.message||"Failed to create order. Please try again.")}finally{k(!1)}},jt=w.useMemo(()=>l.reduce((ve,qe)=>{const Qe=qe.isLoose?qe.pricePerLooseUnit??0:qe.price??0,Be=qe.isLoose?qe.looseQuantity??0:qe.quantity??0;return ve+Qe*Be},0),[l]),xt=(Number(jt)||0).toFixed(2);return i.jsxs("div",{className:"add-pharmacy-order-page p-4 md:p-6 max-w-5xl mx-auto",children:[" ",i.jsxs("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:[" ",i.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:[i.jsx(Ut,{size:20})," "]}),i.jsx("h2",{className:"text-2xl",children:"Create New Pharmacy Order"})," "]})]}),I&&i.jsxs("div",{className:"content-section",children:[" ",i.jsx("h3",{className:"section-title",children:"Select Patient"})," ",i.jsxs("div",{className:"mb-3 relative",children:[i.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"})," ",i.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:q,onChange:Pe,className:"custom-text-input mt-1",autoFocus:!0}),z&&i.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),L&&i.jsx("div",{className:"ai-function-status error mb-3 p-3",children:L})," ",F.length>0&&i.jsxs("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:[" ",i.jsxs("ul",{children:[" ",F.map(ve=>i.jsxs("li",{onClick:()=>de({id:ve.id,name:ve.name,token:ve.token,age:ve.age,gender:ve.gender,phone:ve.phone}),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[i.jsxs("div",{className:"font-medium",children:[i.jsxs("span",{className:"patient-token mr-2",children:["#",ve.token]}),ve.name]}),i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[ve.age?`${ve.age} yrs`:"Age N/A",ve.gender?` / ${ve.gender}`:" / Gender N/A",ve.phone&&i.jsxs("span",{className:"hidden sm:inline",children:[" / ",ve.phone]})]})]}),ve.phone&&i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",ve.phone]})]},ve.id))]})]}),q.length>=2&&!z&&F.length===0&&!L&&i.jsxs(i.Fragment,{children:[i.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',q,'".']}),H&&i.jsx("button",{type:"button",onClick:()=>Me("phone"),className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:z,children:'Create "direct pharmacy" Patient with this Phone'}),te&&i.jsx("button",{type:"button",onClick:()=>Me("name"),className:"create-patient-button mt-3 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ml-2",disabled:z,children:"Create Patient with this Name"})]}),q.length<2&&!z&&i.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]}),t&&!I&&i.jsxs("form",{onSubmit:nt,children:[i.jsxs("div",{className:"selected-patient-info content-section flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[" ",i.jsxs("div",{children:[i.jsxs("h3",{className:"section-title",children:[" ","Patient: ",i.jsx("span",{className:"font-normal",children:t.name})]}),i.jsxs("p",{className:"text-sm mt-1",children:["Token: ",i.jsx("span",{className:"font-medium",children:t.token??"N/A"}),t.age&&`    Age: ${t.age}`,t.gender&&`    Gender: ${t.gender}`,t.phone&&`    Phone: ${t.phone}`]}),i.jsxs("p",{className:"text-xs mt-1",title:`Patient UUID: ${t.id}`,children:["ID: ",t.id.substring(0,12),"..."]})]}),i.jsx("button",{type:"button",onClick:Ze,className:"change-patient-button mt-2 sm:mt-0 px-3 py-1.5 border rounded-md text-sm font-medium focus:outline-none focus:ring-2",children:"Change Patient"})]}),b&&i.jsx("div",{className:"ai-function-status error mb-4 p-3",children:b})," ",K&&i.jsx("div",{className:"content-section text-center py-4",children:i.jsx("p",{className:"text-gray-500",children:"Loading previous orders..."})}),A&&i.jsx("div",{className:"ai-function-status error mb-4 p-3",children:A}),!K&&Z.length>0&&i.jsxs("div",{className:"content-section mt-4",children:[i.jsx("h3",{className:"section-title",children:"Previous Orders"}),i.jsx("div",{className:"space-y-4",children:Z.map(ve=>i.jsxs("div",{className:"previous-order-card p-4 border rounded-lg shadow-sm bg-gray-50",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("p",{className:"font-semibold text-gray-800",children:["Order Date: ",new Date(ve.date).toLocaleDateString()]}),i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ve.status==="dispensed"?"bg-green-100 text-green-800":ve.status==="pending"?"bg-yellow-100 text-yellow-800":ve.status==="cancelled"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:ve.status.charAt(0).toUpperCase()+ve.status.slice(1)})]}),i.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mb-3",children:ve.medications.map((qe,Qe)=>i.jsxs("li",{children:[i.jsx("strong",{children:qe.name}),": ",qe.quantity," Qty",qe.directions_to_use&&` - Directions: ${qe.directions_to_use}`]},Qe))}),ve.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:[i.jsx("span",{className:"font-semibold",children:"Prescription for Unavailable:"}),i.jsxs("div",{className:"prose prose-sm max-w-none",children:[" ",i.jsx(Dl,{remarkPlugins:[Lo],children:ve.prescriptionForUnavailableDrugs})]})]}),i.jsxs("button",{type:"button",onClick:()=>ze(ve),className:"add-previous-meds-button mt-3 px-3 py-1.5 text-sm font-medium rounded-md flex items-center justify-center",children:[i.jsx(Md,{size:16,className:"mr-1"})," Add Medications to Current Order"]})]},ve.id))})]}),!K&&Z.length===0&&t&&i.jsx("div",{className:"content-section text-center py-4 mt-4",children:i.jsx("p",{className:"text-gray-500",children:"No previous orders found for this patient."})}),i.jsxs("div",{className:"mb-4 content-section",children:[i.jsx("label",{htmlFor:"prescription-unavailable",className:"form-label",children:"Prescription for Unavailable Drugs (Optional)"}),i.jsx("textarea",{id:"prescription-unavailable",rows:3,value:E??"",onChange:ve=>T(ve.target.value||null),placeholder:"Enter prescription details for any drugs that are currently unavailable...",className:"custom-text-input mt-1 w-full"})]}),i.jsxs("div",{className:"mb-4 relative content-section",children:[" ",i.jsx("label",{htmlFor:"drug-search",className:"form-label",children:"Add Medication"})," ",i.jsx("input",{type:"text",id:"drug-search",placeholder:"Search for drug name or type to add custom...",value:d,onChange:ve=>u(ve.target.value),className:"custom-text-input mt-1"}),d&&i.jsxs("div",{className:"drug-search-dropdown mt-1 w-full max-h-60 rounded-md border shadow-lg overflow-auto focus:outline-none sm:text-sm z-20",children:[" ",h.length>0&&i.jsxs("ul",{children:[" ",h.map(ve=>i.jsxs("li",{onClick:()=>Fe(ve),className:"cursor-pointer select-none relative",children:[i.jsx("span",{className:"font-medium block truncate",children:ve.name||ve.brand_name}),i.jsxs("span",{className:"drug-stock-price text-xs",children:[" ","(Stock: ",ve.quantity_in_stock??"N/A",", Price: ",Number(ve.price||0).toFixed(2),")"]})]},ve.id))]}),d.trim()&&!a.some(ve=>ve.name&&ve.name.toLowerCase()===d.trim().toLowerCase()||ve.brand_name&&ve.brand_name.toLowerCase()===d.trim().toLowerCase())&&i.jsxs("div",{onClick:Ce,className:"add-custom-drug-button cursor-pointer text-sm font-medium",role:"button",children:['Add "',d.trim(),'" as new item']}),d.trim()&&h.length===0&&a.some(ve=>ve.name&&ve.name.toLowerCase()===d.trim().toLowerCase()||ve.brand_name&&ve.brand_name.toLowerCase()===d.trim().toLowerCase())&&i.jsx("p",{className:"text-gray-400 py-2.5 px-4 text-sm",children:"Drug already selected or no new matches."})]})]}),i.jsxs("div",{className:"order-items-section content-section max-h-96 overflow-y-auto",children:[" ",i.jsx("h4",{className:"section-title",children:"Order Items"})," ",l.length===0&&i.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:"No medications added yet."}),l.length>0&&i.jsx("ul",{className:"space-y-4",children:l.map(ve=>{const qe=ve.drug_id??ve.name,Qe=!ve.drug_id;return i.jsxs("li",{className:"order-item-card text-sm",children:[" ",i.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-3",children:[i.jsxs("div",{className:"flex-grow mb-2 md:mb-0",children:[i.jsxs("span",{className:`item-name block text-base ${Qe?"custom":""}`,children:[" ",ve.name,Qe?" (custom)":""]}),!Qe&&ve.pricePerLooseUnit!==void 0&&i.jsxs("span",{className:"item-details text-xs",children:[" ","@ ",(Number(ve.pricePerLooseUnit)||0).toFixed(2)," per loose unit"]}),ve.stock!==void 0&&i.jsxs("span",{className:`item-details text-xs ml-2 ${ve.stock<=10?"item-stock low":""}`,children:[" ","(Stock: ",ve.stock,")"]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-x-4 gap-y-2",children:[i.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[i.jsx("label",{htmlFor:`loose-packs-${qe}`,className:"dosage-label",children:"Packs:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>Ie(qe,(ve.loosePacks??0)-1),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`loose-packs-${qe}`,min:"0",value:ve.loosePacks??0,onChange:Be=>{const J=parseInt(Be.target.value,10);Ie(qe,isNaN(J)?0:J)},onFocus:Be=>Be.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>Ie(qe,(ve.loosePacks??0)+1),className:"quantity-btn",children:"+"})]})]}),i.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[i.jsx("label",{htmlFor:`loose-units-${qe}`,className:"dosage-label",children:"Loose:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>Ge(qe,(ve.looseUnits??0)-1),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`loose-units-${qe}`,min:"0",value:ve.looseUnits??0,onChange:Be=>{const J=parseInt(Be.target.value,10);Ge(qe,isNaN(J)?0:J)},onFocus:Be=>Be.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>Ge(qe,(ve.looseUnits??0)+1),className:"quantity-btn",children:"+"})]}),ve.unit&&i.jsxs("span",{className:"ml-2 text-sm text-gray-400",children:["(",ve.unit.split("x")[1]||ve.unit," per pack)"]})]})]}),i.jsxs("div",{className:"flex items-center justify-between md:justify-end gap-3 mt-2 md:mt-0 md:flex-col md:items-end",children:[i.jsxs("div",{className:"w-28 text-right font-semibold",children:[" ","",(Number((ve.pricePerLooseUnit??0)*(ve.looseQuantity??0))||0).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>xe(qe),className:"remove-item-button p-1.5 -m-1.5 rounded-full",title:"Remove Item",children:i.jsx(ti,{size:18})})]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-x-4 gap-y-2 mt-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:`tablets-per-day-${qe}`,className:"dosage-label",children:"Per Day:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>f(Be=>Be.map(J=>J.drug_id===qe?{...J,tabletsPerDay:Math.max(1,(J.tabletsPerDay??1)-1)}:J)),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`tablets-per-day-${qe}`,min:"1",value:ve.tabletsPerDay??1,onChange:Be=>{const J=parseInt(Be.target.value,10);f(Y=>Y.map(X=>X.drug_id===qe?{...X,tabletsPerDay:isNaN(J)?1:Math.max(1,J)}:X))},onFocus:Be=>Be.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>f(Be=>Be.map(J=>J.drug_id===qe?{...J,tabletsPerDay:(J.tabletsPerDay??1)+1}:J)),className:"quantity-btn",children:"+"})]})]}),i.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[i.jsx("label",{htmlFor:`number-of-days-${qe}`,className:"dosage-label",children:"No. Days:"}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("button",{type:"button",onClick:()=>f(Be=>Be.map(J=>J.drug_id===qe?{...J,numberOfDays:Math.max(1,(J.numberOfDays??1)-1)}:J)),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",id:`number-of-days-${qe}`,min:"1",value:ve.numberOfDays??1,onChange:Be=>{const J=parseInt(Be.target.value,10);f(Y=>Y.map(X=>X.drug_id===qe?{...X,numberOfDays:isNaN(J)?1:Math.max(1,J)}:X))},onFocus:Be=>Be.target.select(),className:"dosage-input text-sm text-right"}),i.jsx("button",{type:"button",onClick:()=>f(Be=>Be.map(J=>J.drug_id===qe?{...J,numberOfDays:(J.numberOfDays??1)+1}:J)),className:"quantity-btn",children:"+"})]})]})]}),i.jsx("div",{className:"flex items-center mt-2",children:ve.unit&&Re(ve.unit)&&i.jsx("span",{className:"ml-4 text-sm text-gray-400",children:(()=>{const Be=Re(ve.unit),J=ve.looseQuantity??0;if(Be&&Be>0){const Y=Math.floor(J/Be),X=J%Be;return`(Subtract: ${Y} packs, ${X} loose)`}return""})()})}),i.jsxs("div",{className:"mt-2",children:[i.jsx("label",{htmlFor:`directions-${qe}`,className:"dosage-label",children:"Directions:"}),i.jsx("input",{type:"text",id:`directions-${qe}`,placeholder:"e.g., 'After food', 'Twice a day'",value:ve.directions_to_use??"",onChange:Be=>{const J=Be.target.value;f(Y=>Y.map(X=>(X.drug_id??X.name)===qe?{...X,directions_to_use:J}:X))},className:"dosage-input text-sm w-full mt-1"})]})]},qe)})})]}),l.length>0&&i.jsx("div",{className:"mt-6 text-right pr-4",children:i.jsxs("span",{className:"grand-total font-bold",children:[" ","Grand Total: ",xt]})}),i.jsx("div",{className:"mt-8 flex justify-end",children:i.jsx("button",{type:"submit",disabled:S||l.length===0&&!(E!=null&&E.trim()),className:`submit-order-button inline-flex items-center justify-center text-base shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 ${S||l.length===0&&!(E!=null&&E.trim())?"":"hover:opacity-90"}`,children:S?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"spinner animate-spin rounded-full h-5 w-5 border-2 mr-3"})," ","Creating Order..."]}):"Create Order"})})]})]})},MA=()=>{var Z;const{orderId:e}=ki(),n=wt(),[t,r]=w.useState(null),[a,s]=w.useState(null),[l,f]=w.useState([]),[d,u]=w.useState([]),[h,g]=w.useState(""),[b,v]=w.useState([]),[S,k]=w.useState(null),[E,T]=w.useState(!1),[I,D]=w.useState(null),[q,R]=w.useState(!0),F=w.useCallback(async()=>{R(!0);try{const B=await ge(`/api/pharmacy-orders/${e}`);if(!B.ok)throw new Error("Failed to fetch order details");const K=await B.json();r(K),s({id:K.patientId,name:K.patientName||"N/A",token:K.patientTokenNumber}),D(K.prescriptionForUnavailableDrugs);const oe=K.medications.map(A=>{const se=z(A.unit),ue=A.pack_quantity*(se??1)+A.loose_quantity;return{...A,isLoose:!0,loosePacks:A.pack_quantity,looseUnits:A.loose_quantity,looseQuantity:ue,pack_price:A.pack_price,loose_price:A.loose_price,total_price:A.total_price,pricePerLooseUnit:A.loose_price,originalPrice:A.pack_price,box_number:A.box_number,unit:A.unit,batch:A.batch,expiry_date:A.expiry_date,discount_percentage:A.discount_percentage}});u(oe)}catch(B){k("Could not load order details. "+B.message)}finally{R(!1)}},[e]),U=w.useCallback(async()=>{try{const B=await ge("/api/drugs");if(!B.ok)throw new Error("Failed to fetch drugs");const K=await B.json();f(K)}catch(B){k("Could not load drug list. "+B.message)}},[]);w.useEffect(()=>{F(),U()},[F,U]),w.useEffect(()=>{if(!h){v([]);return}const B=h.toLowerCase();v(l.filter(K=>{const oe=K.name&&K.name.toLowerCase().includes(B),A=K.brand_name&&K.brand_name.toLowerCase().includes(B);return oe||A}).slice(0,10))},[h,l]);const z=B=>{if(!B)return null;const K=B.match(/(?:\d+x)?(\d+)/);return K?parseInt(K[1],10):null},V=B=>{if(d.some(K=>K.drug_id===B.id)){k(`${B.name||B.brand_name} is already in the order.`),setTimeout(()=>k(null),3e3),g(""),v([]);return}u(K=>[...K,{drug_id:B.id,name:B.name||B.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,pack_price:Number(B.price)||0,loose_price:(Number(B.price)||0)/(z(B.unit)||1),total_price:(Number(B.price)||0)/(z(B.unit)||1),discount_percentage:0,directions_to_use:"",tabletsPerDay:1,numberOfDays:1,stock:B.quantity_in_stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(B.price)||0)/(z(B.unit)||1),originalPrice:Number(B.price)||0,unit:B.unit}]),g(""),v([])},L=B=>{u(K=>K.filter(oe=>(oe.drug_id??oe.name)!==B))},$=(B,K)=>{u(oe=>oe.map(A=>{if((A.drug_id??A.name)===B&&A.isLoose){const se=z(A.unit),ue=Math.max(0,K),M=ue*(se??1)+(A.looseUnits??0);return{...A,loosePacks:ue,looseQuantity:M,pack_quantity:ue}}return A}))},H=(B,K)=>{u(oe=>oe.map(A=>{if((A.drug_id??A.name)===B&&A.isLoose){const se=z(A.unit),ue=Math.max(0,K),M=(A.loosePacks??0)*(se??1)+ue;return{...A,looseUnits:ue,looseQuantity:M,loose_quantity:ue}}return A}))},ee=async B=>{if(B.preventDefault(),k(null),T(!0),d.length===0&&!(I!=null&&I.trim())){k("Please add at least one medication or provide a prescription."),T(!1);return}const K=d.filter(A=>{const se=A.looseQuantity??0;return se<=0||A.stock!==void 0&&se>A.stock});if(K.length>0){k(`Invalid quantity or insufficient stock for: ${K.map(A=>A.name).join(", ")}`),T(!1);return}const oe={items:d.map(A=>({drug_id:A.drug_id??null,name:A.name,pack_quantity:A.loosePacks??0,loose_quantity:A.looseUnits??0,pack_price:A.pack_price??0,loose_price:A.loose_price??0,total_price:(A.loose_price??0)*(A.looseQuantity??0),discount_percentage:A.discount_percentage??0,directions_to_use:A.directions_to_use??null,tabletsPerDay:A.tabletsPerDay??1,numberOfDays:A.numberOfDays??1})),prescription_for_unavailable_drugs:I,order_total:te};try{const A=await ge(`/api/pharmacy-orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(oe)});if(!A.ok){const se=await A.json();throw new Error(se.message||"Failed to update order")}alert("Pharmacy order updated successfully!"),n(-1)}catch(A){k(A.message||"Failed to update order. Please try again.")}finally{T(!1)}},te=w.useMemo(()=>d.reduce((B,K)=>{const oe=K.loose_price??0,A=K.looseQuantity??0;return B+oe*A},0),[d]),ae=(Number(te)||0).toFixed(2);return q?i.jsx("div",{className:"p-6",children:"Loading order details..."}):t?i.jsx("div",{className:"add-pharmacy-order-page p-4 md:p-6 min-h-screen",children:i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsx("div",{className:"page-header flex items-center justify-between mb-8 pb-4 border-b border-gray-700",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"back-button p-2 rounded-full hover:bg-gray-800 transition-colors",title:"Go Back",children:i.jsx(Ut,{size:24})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-white",children:"Edit Order"}),i.jsxs("p",{className:"text-gray-400 text-sm",children:["Order #",t.id.substring(0,8)]})]})]})}),i.jsxs("form",{onSubmit:ee,className:"edit-pharmacy-order-container",children:[i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"modern-input-group",children:[i.jsx("input",{type:"text",placeholder:"Search and add medications...",value:h,onChange:B=>g(B.target.value),className:"modern-input"}),i.jsx("div",{className:"search-icon",children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("circle",{cx:"11",cy:"11",r:"8"}),i.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})}),h&&b.length>0&&i.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-[#2c2c2c] border border-gray-700 rounded-lg shadow-xl z-50 max-h-60 overflow-y-auto",children:i.jsx("ul",{children:b.map(B=>i.jsxs("li",{onClick:()=>V(B),className:"p-3 hover:bg-[#3a3a3a] cursor-pointer border-b border-gray-700 last:border-0 transition-colors",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-medium text-white",children:B.name||B.brand_name}),i.jsxs("span",{className:"text-xs text-gray-400 bg-gray-800 px-2 py-1 rounded",children:["Stock: ",B.quantity_in_stock]})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Price: ",Number(B.price||0).toFixed(2)]})]},B.id))})})]}),i.jsx("div",{className:"order-items-table-container animate-fade-in",children:d.length===0?i.jsxs("div",{className:"p-8 text-center text-gray-500",children:[i.jsx("p",{children:"No medications added yet."}),i.jsx("p",{className:"text-sm mt-2",children:"Search above to add items to this order."})]}):i.jsxs("table",{className:"order-items-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Medication"}),i.jsx("th",{className:"text-center",children:"Packs"}),i.jsx("th",{className:"text-center",children:"Loose"}),i.jsx("th",{children:"Directions"}),i.jsx("th",{className:"text-right",children:"Total"}),i.jsx("th",{className:"text-center",children:"Action"})]})}),i.jsx("tbody",{children:d.map(B=>{const K=B.drug_id??B.name;return i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{className:"font-medium text-white",children:B.name}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["",(Number(B.loose_price)||0).toFixed(2)," / unit",B.stock!==void 0&&i.jsxs("span",{className:`ml-2 ${B.stock<=10?"text-red-400":""}`,children:["(Stock: ",B.stock,")"]})]})]}),i.jsx("td",{className:"text-center",children:i.jsx("input",{type:"number",min:"0",value:B.loosePacks??0,onChange:oe=>$(K,parseInt(oe.target.value)||0),className:"qty-input"})}),i.jsx("td",{className:"text-center",children:i.jsx("input",{type:"number",min:"0",value:B.looseUnits??0,onChange:oe=>H(K,parseInt(oe.target.value)||0),className:"qty-input"})}),i.jsx("td",{children:i.jsx("input",{type:"text",placeholder:"e.g. 1-0-1",value:B.directions_to_use??"",onChange:oe=>{const A=oe.target.value;u(se=>se.map(ue=>(ue.drug_id??ue.name)===K?{...ue,directions_to_use:A}:ue))},className:"bg-transparent border-b border-gray-600 focus:border-[#7b61ff] text-sm text-gray-300 w-full outline-none py-1 transition-colors"})}),i.jsxs("td",{className:"text-right font-medium text-white",children:["",(Number((B.pricePerLooseUnit??0)*(B.looseQuantity??0))||0).toFixed(2)]}),i.jsx("td",{className:"text-center",children:i.jsx("button",{type:"button",onClick:()=>L(K),className:"action-btn delete",title:"Remove Item",children:i.jsx(ti,{size:16})})})]},K)})})]})}),i.jsxs("div",{className:"content-section",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Prescription Notes (Optional)"}),i.jsx("textarea",{rows:3,value:I??"",onChange:B=>D(B.target.value||null),placeholder:"Enter any additional notes or prescription details for unavailable drugs...",className:"modern-input resize-none"})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"patient-info-card",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[i.jsx("div",{className:"patient-avatar-placeholder",children:((Z=a==null?void 0:a.name)==null?void 0:Z.charAt(0).toUpperCase())||"P"}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-bold text-white text-lg",children:a==null?void 0:a.name}),i.jsxs("p",{className:"text-sm text-gray-400",children:["Token: ",i.jsx("span",{className:"text-white font-mono bg-gray-700 px-1 rounded",children:(a==null?void 0:a.token)??"N/A"})]})]})]}),i.jsxs("div",{className:"border-t border-gray-700 pt-4 mt-2",children:[i.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[i.jsx("span",{className:"text-gray-400",children:"Order Date"}),i.jsx("span",{className:"text-white",children:new Date(t.date).toLocaleDateString()})]}),i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-gray-400",children:"Status"}),i.jsx("span",{className:`capitalize px-2 py-0.5 rounded text-xs font-medium ${t.status==="pending"?"bg-yellow-900 text-yellow-200":t.status==="billed"?"bg-green-900 text-green-200":"bg-gray-700 text-gray-300"}`,children:t.status})]})]})]}),i.jsxs("div",{className:"order-summary-panel",children:[i.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Order Summary"}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Items"}),i.jsx("span",{children:d.length})]}),i.jsxs("div",{className:"summary-row total",children:[i.jsx("span",{children:"Grand Total"}),i.jsxs("span",{children:["",ae]})]}),S&&i.jsx("div",{className:"mt-4 p-3 bg-red-900/30 border border-red-500/50 rounded-lg text-red-200 text-sm",children:S}),i.jsx("button",{type:"submit",disabled:E,className:"w-full mt-6 bg-[#7b61ff] hover:bg-[#6a51e6] text-white font-bold py-3 px-4 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex justify-center items-center",children:E?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"animate-spin mr-2 h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),"Updating..."]}):"Update Order"})]})]})]})]})}):i.jsx("div",{className:"p-6 text-red-500",children:"Order not found or failed to load."})},Hne=(e,n,t,r="non-black")=>{if(isNaN(e)||isNaN(n)||e<=0||n<=0)return null;let a;return t==="female"?e<=.7?a=141*Math.pow(e/.7,-.329)*Math.pow(.993,n):a=141*Math.pow(e/.7,-1.209)*Math.pow(.993,n):e<=.9?a=141*Math.pow(e/.9,-.411)*Math.pow(.993,n):a=141*Math.pow(e/.9,-1.209)*Math.pow(.993,n),r==="black"&&(a*=1.018),parseFloat(a.toFixed(2))},Gne=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0||t>=400)return null;const r=e-n-t/5;return parseFloat(r.toFixed(2))},Yne=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},Wne=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},Qne=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=e-(n+t);return parseFloat(r.toFixed(2))},Jne=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=2*e+n/18+t/2.8;return parseFloat(r.toFixed(2))},G_=e=>["eGFR","LDL Cholesterol","Indirect Bilirubin","Globulin","Anion Gap","Osmolality"].includes(e),Y_=()=>{var ae,Z;const{orderId:e}=ki(),n=wt(),[t,r]=w.useState(null),[a,s]=w.useState({}),[l,f]=w.useState(!0),[d,u]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(new Set),[S,k]=w.useState(null),[E,T]=w.useState(null),[I,D]=w.useState({}),[q,R]=w.useState(null),F=B=>{v(K=>{const oe=new Set(K);return oe.has(B)?oe.delete(B):oe.add(B),oe})},U=w.useCallback(async B=>{var K;try{const oe=await ge(`/api/patients/${B}`);if(!oe.ok)throw new Error(`Failed to fetch patient details: ${oe.status}`);const A=await oe.json();k(A.age),T(((K=A.sex)==null?void 0:K.toLowerCase())==="female"?"female":"male")}catch(oe){console.error("Error fetching patient details:",oe),k(null),T(null)}},[]),z=w.useCallback(async()=>{if(e){f(!0),g(null);try{const B=await ge(`/api/lab/${e}`);if(!B.ok){const A=await B.json().catch(()=>({message:`HTTP error! status: ${B.status}`}));throw new Error(A.message||`HTTP error! status: ${B.status}`)}const K=await B.json();r(K),K.patient_id&&U(K.patient_id);const oe={};if(K.tests&&K.tests.forEach(A=>{oe[A.id]={},A.default_parameters&&A.default_parameters.length>0?A.default_parameters.forEach(se=>{oe[A.id][se.name]=se.defaultValue}):oe[A.id].report_content=""}),K.report_content)try{const A=JSON.parse(K.report_content);if(typeof A=="object"&&A!==null&&!Array.isArray(A)){const se={...oe};Object.keys(A).forEach(ue=>{se[ue]?se[ue]={...se[ue],...A[ue]}:se[ue]=A[ue]}),s(se)}else console.warn("Legacy or unexpected report content format detected. Initializing with defaults."),s(oe)}catch{console.warn("Legacy report content detected (not JSON). Initializing with defaults."),s(oe)}else s(oe)}catch(B){console.error("Failed to fetch lab order details:",B),g(B instanceof Error?B.message:"An unknown error occurred while fetching order details.")}finally{f(!1)}}},[e,U]);w.useEffect(()=>{e?z():(g("No Order ID provided in the URL."),f(!1))},[e,z]);const V=(B,K,oe)=>{s(A=>{var ze,nt,jt,xt,ve,qe,Qe,Be,J,Y,X,Ne,ke,Ue,it,mt,ht,Ve,tt;const se={...A,[B]:{...A[B],[K]:oe}},ue=parseFloat((ze=se[B])==null?void 0:ze.Creatinine),M=S,pe=E;if(K==="Creatinine"&&!isNaN(ue)&&M!==null&&pe!==null){const Le=Hne(ue,M,pe);Le!==null&&((nt=t==null?void 0:t.tests.find(et=>et.id===B))!=null&&nt.default_parameters.find(et=>et.name==="eGFR"))&&(se[B].eGFR=Le)}const be=parseFloat((jt=se[B])==null?void 0:jt["Total Cholesterol"]),fe=parseFloat((xt=se[B])==null?void 0:xt["HDL Cholesterol"]),Pe=parseFloat((ve=se[B])==null?void 0:ve.Triglycerides);if((K==="Total Cholesterol"||K==="HDL Cholesterol"||K==="Triglycerides")&&!isNaN(be)&&!isNaN(fe)&&!isNaN(Pe)){const Le=Gne(be,fe,Pe);Le!==null&&((qe=t==null?void 0:t.tests.find(et=>et.id===B))!=null&&qe.default_parameters.find(et=>et.name==="LDL Cholesterol"))&&(se[B]["LDL Cholesterol"]=Le)}const de=parseFloat((Qe=se[B])==null?void 0:Qe["Total Bilirubin"]),Me=parseFloat((Be=se[B])==null?void 0:Be["Direct Bilirubin"]);if((K==="Total Bilirubin"||K==="Direct Bilirubin")&&!isNaN(de)&&!isNaN(Me)){const Le=Yne(de,Me);Le!==null&&((J=t==null?void 0:t.tests.find(et=>et.id===B))!=null&&J.default_parameters.find(et=>et.name==="Indirect Bilirubin"))&&(se[B]["Indirect Bilirubin"]=Le)}const Ze=parseFloat((Y=se[B])==null?void 0:Y["Total Protein"]),Fe=parseFloat((X=se[B])==null?void 0:X.Albumin);if((K==="Total Protein"||K==="Albumin")&&!isNaN(Ze)&&!isNaN(Fe)){const Le=Wne(Ze,Fe);Le!==null&&((Ne=t==null?void 0:t.tests.find(et=>et.id===B))!=null&&Ne.default_parameters.find(et=>et.name==="Globulin"))&&(se[B].Globulin=Le)}const Ce=parseFloat((ke=se[B])==null?void 0:ke.Sodium),Re=parseFloat((Ue=se[B])==null?void 0:Ue.Chloride),xe=parseFloat((it=se[B])==null?void 0:it.Bicarbonate);if((K==="Sodium"||K==="Chloride"||K==="Bicarbonate")&&!isNaN(Ce)&&!isNaN(Re)&&!isNaN(xe)){const Le=Qne(Ce,Re,xe);Le!==null&&((mt=t==null?void 0:t.tests.find(et=>et.id===B))!=null&&mt.default_parameters.find(et=>et.name==="Anion Gap"))&&(se[B]["Anion Gap"]=Le)}const Ie=parseFloat((ht=se[B])==null?void 0:ht.Glucose),Ge=parseFloat((Ve=se[B])==null?void 0:Ve.BUN);if((K==="Sodium"||K==="Glucose"||K==="BUN")&&!isNaN(Ce)&&!isNaN(Ie)&&!isNaN(Ge)){const Le=Jne(Ce,Ie,Ge);Le!==null&&((tt=t==null?void 0:t.tests.find(et=>et.id===B))!=null&&tt.default_parameters.find(et=>et.name==="Osmolality"))&&(se[B].Osmolality=Le)}return se})},L=async(B,K)=>{if(!e){alert("Cannot submit report without an Order ID.");return}if(!a[B]||Object.keys(a[B]).length===0){alert(`Please enter data for ${K} before saving.`);return}R(B),g(null);try{const A={...t!=null&&t.report_content?JSON.parse(t.report_content):{}};A[B]=a[B];const se=await ge(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(A)})});if(!se.ok){const ue=await se.json().catch(()=>({message:`Submission failed: ${se.status}`}));throw new Error(ue.message||`Submission failed: ${se.status}`)}t&&r({...t,report_content:JSON.stringify(A)}),alert(`Report for ${K} saved successfully!`)}catch(oe){console.error(`Error submitting report for ${K}:`,oe),alert(`Failed to save report for ${K}: ${oe instanceof Error?oe.message:"Unknown error"}`)}finally{R(null)}},$=async()=>{if(Object.keys(a).length===0){alert("Report content cannot be empty.");return}if(!e){alert("Cannot submit report without an Order ID.");return}u(!0),g(null);try{const B=await ge(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(a)})});if(!B.ok){const K=await B.json().catch(()=>({message:`Submission failed: ${B.status}`}));throw new Error(K.message||`Submission failed: ${B.status}`)}alert("Report submitted successfully!"),n(-1)}catch(B){console.error("Error submitting report:",B),g(B instanceof Error?B.message:"An unknown error occurred during submission.")}finally{u(!1)}};if(l)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",style:{textAlign:"center",padding:"50px"},children:[" ",i.jsxs("div",{className:"loading-text",children:[i.jsx(Pd,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading details..."]})]})});if(h&&!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card error-message-container",style:{textAlign:"center",padding:"30px"},children:[i.jsx(Sr,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("h3",{className:"error-title",style:{borderBottom:"none"},children:"Error Loading Details"}),i.jsx("p",{className:"error-text",children:h}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"20px"},children:[i.jsx(Ut,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});if(!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx($o,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("p",{className:"no-data-message",style:{fontSize:"1.1em"},children:`Lab order not found for ID: ${e}.`}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"15px"},children:[i.jsx(Ut,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});const H=(ae=t==null?void 0:t.Patient)==null?void 0:ae.name,ee=(Z=t==null?void 0:t.Patient)==null?void 0:Z.patient_token_number,te=`Enter Report for Order #${(t==null?void 0:t.lab_token_number)??e}`;return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"none",paddingBottom:0,marginBottom:0},children:[" ",i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:te})," ",i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",disabled:d,children:[i.jsx(Ut,{size:16,style:{marginRight:"5px"}}),"Back"]})]}),t&&i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:[i.jsx($o,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}})," Order Summary"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"10px",fontSize:"0.95em"},children:[i.jsxs("div",{children:[i.jsx(Gc,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Patient:"})," ",H??"N/A"," (Token: ",ee??"N/A",")"]}),i.jsxs("div",{children:[i.jsx(Uo,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Order Token:"})," ",t.lab_token_number??"N/A"]}),i.jsxs("div",{children:[i.jsx(BI,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Order Date:"})," ",Oh(new Date(t.createdAt),"PPpp")]}),i.jsxs("div",{style:{gridColumn:"1 / -1"},children:[i.jsx(wM,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Tests:"})," ",(t.tests||[]).map(B=>B.name).join(", ")]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:Xne(t.status),children:Kne(t.status)})]})]})]}),i.jsxs("div",{className:"lab-inventory-form-group",style:{marginTop:"20px"},children:[i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:"Report Parameters"}),t==null?void 0:t.tests.map(B=>{var K;return i.jsxs("div",{className:"lab-inventory-card",style:{marginBottom:"15px"},children:[i.jsxs("button",{type:"button",onClick:()=>F(B.id),className:"test-header-button","aria-expanded":b.has(B.id),children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",margin:0},children:B.name}),b.has(B.id)?i.jsx(ub,{size:20}):i.jsx(cb,{size:20})]}),b.has(B.id)&&i.jsxs("div",{className:"test-parameters-body",children:[B.default_parameters&&B.default_parameters.length>0?i.jsx(i.Fragment,{children:B.default_parameters.map(oe=>{var A,se,ue,M,pe,be,fe,Pe,de,Me;return i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:`${B.id}-${oe.name}`,children:[oe.name,oe.unit&&i.jsxs("span",{className:"normal-range-label",children:[" (",oe.unit,")"]}),oe.type==="number"&&(oe.lower_limit!==null||oe.upper_limit!==null)&&i.jsxs("span",{className:"normal-range-label",children:[" ","Normal:",oe.lower_limit!==null&&oe.lower_limit!==void 0&&` > ${oe.lower_limit}`,oe.lower_limit!==null&&oe.lower_limit!==void 0&&oe.upper_limit!==null&&oe.upper_limit!==void 0&&" - ",oe.upper_limit!==null&&oe.upper_limit!==void 0&&` < ${oe.upper_limit}`]})]}),oe.type==="boolean"?i.jsxs("select",{id:`${B.id}-${oe.name}`,value:((se=(A=a[B.id])==null?void 0:A[oe.name])==null?void 0:se.toString())??"false",onChange:Ze=>V(B.id,oe.name,Ze.target.value==="true"),className:"lab-inventory-input",disabled:d,children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-Reactive"})]}):i.jsx("input",{id:`${B.id}-${oe.name}`,type:oe.type==="number"?"number":"text",value:((ue=a[B.id])==null?void 0:ue[oe.name])===null||((M=a[B.id])==null?void 0:M[oe.name])===void 0?"":(pe=a[B.id])==null?void 0:pe[oe.name],onChange:Ze=>{const Fe=oe.type==="number"&&Ze.target.value===""?0:Ze.target.value;V(B.id,oe.name,Fe)},className:`lab-inventory-input ${oe.type==="number"&&((be=a[B.id])==null?void 0:be[oe.name])!==""&&(oe.lower_limit!=null&&parseFloat((fe=a[B.id])==null?void 0:fe[oe.name])<oe.lower_limit||oe.upper_limit!=null&&parseFloat((Pe=a[B.id])==null?void 0:Pe[oe.name])>oe.upper_limit)?"abnormal-result":""}`,disabled:d||G_(oe.name)&&!((de=I[B.id])!=null&&de[oe.name])}),G_(oe.name)&&i.jsx("div",{style:{marginTop:"5px",textAlign:"right"},children:i.jsx("button",{type:"button",onClick:()=>D(Ze=>{var Fe;return{...Ze,[B.id]:{...Ze[B.id]||{},[oe.name]:!((Fe=Ze[B.id])!=null&&Fe[oe.name])}}}),className:"lab-inventory-button lab-inventory-button-tertiary",style:{fontSize:"0.8em",padding:"5px 10px"},disabled:d,children:(Me=I[B.id])!=null&&Me[oe.name]?"Disable Edit":"Edit Calculated Field"})})]},oe.name)})}):i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:`${B.id}-report_content`,children:"Report Content"}),i.jsx("textarea",{id:`${B.id}-report_content`,value:((K=a[B.id])==null?void 0:K.report_content)??"",onChange:oe=>V(B.id,"report_content",oe.target.value),className:"lab-inventory-input",rows:5,placeholder:`Enter report for ${B.name}...`,disabled:d})]}),i.jsx("div",{style:{marginTop:"15px",textAlign:"right"},children:i.jsx("button",{type:"button",onClick:()=>L(B.id,B.name),disabled:d||q===B.id,className:"lab-inventory-button",style:{fontSize:"0.9em",padding:"8px 16px"},children:q===B.id?i.jsxs(i.Fragment,{children:[i.jsx(Pd,{className:"animate-spin mr-2",size:14})," Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Rd,{size:14,style:{marginRight:"5px"}})," Save ",B.name]})})})]})]},B.id)}),h&&i.jsxs("p",{className:"error-text",style:{marginTop:"10px"},children:[i.jsx(Sr,{size:15,className:"inline mr-1"}),h]})]}),i.jsxs("div",{style:{marginTop:"20px",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[" ",i.jsx("button",{type:"button",onClick:()=>n(-1),disabled:d,className:"lab-inventory-button lab-inventory-button-secondary",children:"Cancel"}),i.jsx("button",{type:"button",onClick:$,disabled:d||Object.keys(a).length===0,className:"lab-inventory-button",children:d?i.jsxs(i.Fragment,{children:[i.jsx(Pd,{className:"animate-spin mr-2",size:16})," Submitting..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Rd,{size:16,style:{marginRight:"5px"}})," Submit All Reports"]})})]})]})})},Kne=e=>e?e.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()):"Unknown",Xne=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},Zne=()=>{const{orderId:e}=ki(),n=wt(),[t,r]=w.useState(null),[a,s]=w.useState(!0),[l,f]=w.useState(null),d=w.useCallback(async g=>{if(!g){f("No Order ID specified in the URL."),s(!1),r(null);return}s(!0),f(null),r(null);try{console.log(`Fetching order details for ID: ${g}`);const b=await ge(`/api/lab/orders/${g}/report`);if(!b.ok){let S;try{S=await b.json()}catch{S={message:`Server returned status ${b.status}`}}throw console.error("Fetch order details error response:",S),new Error(S.message||`Failed to fetch order details: ${b.status}`)}const v=await b.json();if(console.log("Received order data:",v),!v)throw console.error("Invalid order data structure:",v),new Error("Invalid order data received from server.");r(v)}catch(b){console.error("Error fetching order details:",b),f(b instanceof Error?b.message:"An unknown error occurred while fetching the order details")}finally{s(!1)}},[ge]);w.useEffect(()=>{d(e)},[e,d]);const u=g=>{const b=document.querySelector(`[data-test-id='${g}']`);b&&(document.body.classList.add("printing-single-test"),b.classList.add("printing"),window.print())};w.useEffect(()=>{const g=()=>{document.body.classList.remove("printing-single-test");const b=document.querySelector(".printing");b&&b.classList.remove("printing")};return window.addEventListener("afterprint",g),()=>{window.removeEventListener("afterprint",g)}},[]);const h=()=>{t&&_E(t)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:0,paddingBottom:0,borderBottom:"none"},children:[i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:"Lab Report Viewer"})," ",i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs(cs,{to:"/lab/search-report",className:"lab-inventory-button","aria-label":"Search for other reports",children:[i.jsx(aa,{size:16,style:{marginRight:"5px"}}),"Search Reports"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(Ut,{size:16,style:{marginRight:"5px"}}),"Back"]}),i.jsxs("button",{onClick:()=>window.print(),className:"lab-inventory-button","aria-label":"Print report",children:[i.jsx(Ml,{size:16,style:{marginRight:"5px"}}),"Print"]}),i.jsxs("button",{onClick:h,className:"lab-inventory-button","aria-label":"Share report via WhatsApp",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},children:[i.jsx(nR,{size:16,style:{marginRight:"5px"}}),"WhatsApp"]})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:["Report Details (Order ID: ",e||"None Specified",")"]}),a&&i.jsx("div",{className:"loading-text",children:"Loading report..."}),l&&!a&&i.jsxs("div",{className:"error-message-container",style:{textAlign:"center"},children:[i.jsx(Sr,{size:48}),i.jsx("h3",{className:"error-title",children:"Error Loading Report"}),i.jsx("p",{children:l}),e&&i.jsx("button",{onClick:()=>d(e),className:"retry-button",children:"Retry"})]}),i.jsxs("div",{className:"printable-section",children:[!a&&!l&&(t==null?void 0:t.Patient)&&i.jsxs("div",{className:"lab-inventory-card",style:{marginBottom:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(Gc,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Patient Information"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"10px",fontSize:"0.9em"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Name:"})," ",t.Patient.name||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Age:"})," ",t.Patient.age??"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Gender:"})," ",t.Patient.gender||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Token No:"})," ",t.Patient.patient_token_number||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Patient ID:"})," ",t.Patient.id]}),t.Patient.phone&&i.jsxs("div",{children:[i.jsx("strong",{children:"Phone:"})," ",t.Patient.phone]})]})]}),!a&&!l&&(t==null?void 0:t.report_content)&&i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(Uo,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Report Findings"]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6"},children:(()=>{try{const g=JSON.parse(t.report_content||"{}");return typeof g=="object"&&g!==null&&t.tests?t.tests.map(b=>i.jsxs("div",{"data-test-id":b.id,className:"test-report-container",style:{marginBottom:"20px"},children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h4",{style:{fontSize:"1.1em",margin:0},children:b.name}),i.jsx("button",{onClick:()=>u(b.id),className:"lab-inventory-button print-test-button","aria-label":`Print ${b.name}`,children:i.jsx(Ml,{size:16})})]}),g[b.id]?i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Parameter"}),i.jsx("th",{children:"Value"}),i.jsx("th",{children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(g[b.id]).map(([v,S])=>{var q;const k=(q=b.default_parameters)==null?void 0:q.find(R=>R.name===v),E=typeof S=="string"?parseFloat(S):typeof S=="number"?S:NaN,T=(k==null?void 0:k.type)==="number"&&!isNaN(E)&&(k.lower_limit!=null&&E<k.lower_limit||k.upper_limit!=null&&E>k.upper_limit),I=(k==null?void 0:k.type)==="boolean"?S===!0||S==="true"?"Reactive":"Non-Reactive":String(S),D=(k==null?void 0:k.type)==="boolean"&&(S===!0||S==="true");return i.jsxs("tr",{children:[i.jsx("td",{children:v}),i.jsxs("td",{className:`${T?"abnormal-result":""} ${D?"reactive-result":""}`,children:[I," ",k==null?void 0:k.unit]}),i.jsx("td",{children:k&&k.type==="number"&&(k.lower_limit!==null||k.upper_limit!==null)?i.jsxs(i.Fragment,{children:[k.lower_limit!=null&&` > ${k.lower_limit}`,k.lower_limit!=null&&k.upper_limit!=null&&" - ",k.upper_limit!=null&&` < ${k.upper_limit}`,k.unit&&` ${k.unit}`]}):((k==null?void 0:k.type)==="boolean","N/A")})]},v)})})]}):i.jsx("p",{children:"No parameters reported for this test."})]},b.id)):i.jsx(Dl,{remarkPlugins:[Lo],children:t.report_content})}catch{return i.jsx(Dl,{remarkPlugins:[Lo],children:t.report_content||"*No findings recorded.*"})}})()})]})]}),!a&&!l&&!(t!=null&&t.report_content)&&!(t!=null&&t.Patient)&&e&&i.jsxs("div",{className:"no-data-message",children:["No report content or patient details found for Order ID: ",e,". The order might be processing, does not exist, or the ID is incorrect."]}),!e&&!a&&!l&&i.jsxs("div",{className:"no-data-message",children:["No order ID specified in the URL.",i.jsx(cs,{to:"/lab/search-report",className:"lab-inventory-link",style:{display:"block",marginTop:"10px"},children:"Go to Search Page"})]})]})]})})},ere=()=>{const e=wt(),[n,t]=w.useState(""),[r,a]=w.useState(!1),[s,l]=w.useState([]),[f,d]=w.useState(null),[u,h]=w.useState(n);w.useEffect(()=>{const k=setTimeout(()=>{h(n)},500);return()=>{clearTimeout(k)}},[n]),w.useEffect(()=>{g()},[u]);const g=async()=>{const k=n.trim();if(!k){l([]),d(null);return}a(!0),d(null),l([]),console.log(`Searching for: ${k}`);try{const E=await ge("/api/lab");if(!E.ok){let F;try{F=await E.json()}catch{F={message:`Server returned status ${E.status}`}}throw console.error("Search fetch error response:",F),new Error(F.message||`HTTP error! status: ${E.status}`)}const{orders:T}=await E.json();console.log("Received lab orders for search:",T);const D=T.filter(F=>!!F.report_content).map(F=>{var U,z;return{id:F.id,labTokenNumber:String(F.lab_token_number??"N/A"),patientName:((U=F.Patient)==null?void 0:U.name)||"N/A",patientId:F.patient_id,patientTokenNumber:String(((z=F.Patient)==null?void 0:z.patient_token_number)??"N/A"),tests:(F.tests||[]).map(V=>V.name||"Unknown Test"),date:Oh(new Date(F.createdAt),"yyyy-MM-dd"),status:F.status}}),q=n.toLowerCase(),R=D.filter(F=>{var V,L,$,H,ee;const U=String(F.labTokenNumber).toLowerCase(),z=String(F.patientTokenNumber).toLowerCase();return(((V=F.patientName)==null?void 0:V.toLowerCase())||"").includes(q)||U.includes(q)||z.includes(q)||((($=(L=F.tests)==null?void 0:L.join(" "))==null?void 0:$.toLowerCase())||"").includes(q)||(((H=F.id)==null?void 0:H.toLowerCase())||"").includes(q)||(((ee=F.patientId)==null?void 0:ee.toLowerCase())||"").includes(q)});console.log("Filtered search results:",R),l(R),R.length===0&&k?d(`No matching reports found for "${k}".`):d(null)}catch(E){console.error("Failed to search lab reports:",E),d(E instanceof Error?E.message:"An unknown error occurred during search")}finally{a(!1)}},b=k=>{console.log(`Result clicked, navigating to view report for order ID: ${k}`),e(`/lab/view-report/${k}`)},v=k=>{switch(k){case"pending":return{text:"Sample Pending",color:"text-red-600 bg-red-100"};case"collected":return{text:"Sample Collected",color:"text-yellow-600 bg-yellow-100"};case"processing":return{text:"Processing",color:"text-blue-600 bg-blue-100"};case"completed":return{text:"Completed",color:"text-green-600 bg-green-100"};case"cancelled":return{text:"Cancelled",color:"text-gray-600 bg-gray-100 line-through"};case"reported":return{text:"Reported",color:"text-purple-600 bg-purple-100"};default:return{text:k,color:"text-gray-600 bg-gray-100"}}},S=k=>{switch(k){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h2",{style:{margin:0},children:"Search Lab Reports"}),i.jsxs("button",{onClick:()=>e(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(Ut,{size:16,style:{marginRight:"5px"}}),"Back"]})]}),i.jsxs("div",{className:"lab-inventory-form-group",style:{marginTop:"20px",position:"relative"},children:[i.jsx("label",{htmlFor:"report-search",children:"Enter Search Term"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",position:"relative"},children:[i.jsx(aa,{size:20,style:{position:"absolute",left:"10px",color:"#777"}}),i.jsx("input",{id:"report-search",type:"text",placeholder:"Patient name, ID, token, report ID, test name...",value:n,onChange:k=>t(k.target.value),className:"lab-inventory-input",style:{paddingLeft:"40px",marginBottom:"0"}})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[r&&i.jsx("div",{className:"loading-text",children:"Searching..."}),f&&!r&&i.jsxs("div",{className:"error-text",children:[i.jsx(Sr,{size:20,className:"inline mr-2"})," ",f]}),s.length>0&&!r&&i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:s.map(k=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(k.id),style:{marginBottom:"15px",cursor:"pointer",padding:"15px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:[i.jsx(aM,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}}),k.patientName," (Token: ",k.patientTokenNumber,")"]}),i.jsx("span",{className:S(k.status),children:v(k.status).text})]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:[i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(Uo,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Order ID: ",k.id]}),i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(hR,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Tests: ",k.tests.join(", ")]}),i.jsxs("div",{children:[i.jsx(qI,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Date: ",k.date]})]})]},k.id))}),!r&&s.length===0&&!f&&n.trim()&&i.jsxs("div",{className:"no-data-message",children:['No results found for "',n,'".']}),!r&&s.length===0&&!f&&!n.trim()&&i.jsx("div",{className:"no-data-message",style:{backgroundColor:"transparent",border:"none",textAlign:"left",padding:"5px 0"},children:"Enter a search term above to find lab reports."})]})]})})},tre=()=>{const{patientId:e}=ki(),n=wt(),[t,r]=w.useState([]),[a,s]=w.useState(!0),[l,f]=w.useState(null),[d,u]=w.useState(null),[h,g]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){f("Patient ID is missing from the URL."),s(!1);return}s(!0),f(null),r([]),g(null);try{const S=await ge(`/api/patients/${e}`);if(S.ok){const T=await S.json();g(T.name||`Patient ID: ${e}`)}else console.warn(`Failed to fetch patient name for ID ${e}`),g(`Patient ID: ${e}`);const k=await ge(`/api/lab/patient/${e}`);if(!k.ok){const T=await k.json().catch(()=>({}));throw new Error(T.message||`HTTP error! status: ${k.status}`)}const E=await k.json();r(E||[])}catch(S){console.error("Error fetching data:",S),f(`Failed to load data: ${S.message}`)}finally{s(!1)}})()},[e]);const b=v=>{v.report_content?n(`/lab/view-report/${v.id}`):n(`/lab/enter-report/${v.id}`)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("h2",{style:{margin:0},children:["Lab Reports ",h?`for ${h}`:`for Patient ID: ${e}`]}),i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs("button",{onClick:async()=>{if(!e){alert("Patient ID is missing. Cannot create a new report.");return}try{const v=await ge("/api/lab/create-empty-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:e})});if(!v.ok){const k=await v.json().catch(()=>({message:`Failed to create new lab order: ${v.status}`}));throw new Error(k.message||`Failed to create new lab order: ${v.status}`)}const S=await v.json();n(`/lab/enter-report/${S.newOrderId}`)}catch(v){console.error("Error creating new lab order:",v),alert(`Error creating new lab order: ${v.message}`)}},className:"lab-inventory-button",disabled:!e,title:e?"Enter a new lab report for this patient":"Patient ID missing",children:[i.jsx(ls,{size:16,style:{marginRight:"5px"}}),"Enter New Report"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",children:[i.jsx(Ut,{size:16,style:{marginRight:"5px"}}),"Back"]})]})]}),i.jsx("div",{style:{marginTop:"20px"},children:a?i.jsxs("div",{className:"loading-text",children:[i.jsx(Pd,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading reports..."]}):l?i.jsxs("div",{className:"error-text",style:{textAlign:"center",padding:"20px"},children:[i.jsx(kk,{size:40,style:{marginBottom:"10px",color:"#721c24"}}),i.jsx("h3",{style:{fontSize:"1.2em",color:"#721c24",margin:"10px 0"},children:"Error Loading Reports"}),i.jsx("p",{children:l})]}):t.length===0?i.jsxs("div",{className:"no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(Uo,{size:48,className:"mb-3",style:{margin:"0 auto 15px auto",display:"block"}}),i.jsx("p",{children:"No lab reports found for this patient."}),i.jsxs("p",{children:["You can ",i.jsx(cs,{to:`/lab/create-order/${e}`,className:"lab-inventory-link",children:"create a new lab order"}),"."]})]}):d?i.jsxs("div",{className:"lab-inventory-card",style:{backgroundColor:"#fdfdfd"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.3em",borderBottom:"none",margin:0},children:["Report from: ",d.report_date?Oh(new Date(d.report_date),"PPP p"):"N/A"]}),i.jsxs("button",{onClick:()=>u(null),className:"lab-inventory-button lab-inventory-button-secondary",style:{fontSize:"0.9em",padding:"8px 12px"},children:[i.jsx(Ut,{size:16,style:{marginRight:"5px"}})," Back to List"]})]}),i.jsxs("p",{style:{marginBottom:"15px",fontSize:"1em"},children:[i.jsx("strong",{children:"Tests Ordered:"})," ",(d.tests||[]).map(v=>v.name).join(", ")]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6",border:"1px solid #eee",padding:"15px",borderRadius:"4px",background:"#fff"},children:i.jsx(Dl,{remarkPlugins:[Lo],children:d.report_content||"*No findings recorded.*"})})]}):i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:t.map(v=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(v),tabIndex:0,onKeyPress:S=>S.key==="Enter"&&b(v),style:{marginBottom:"15px",cursor:"pointer",padding:"15px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx(Uo,{size:24,style:{marginRight:"15px",color:"#007bff"}}),i.jsxs("div",{children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:["Order Date: ",Oh(new Date(v.createdAt),"PPP")]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:["Tests: ",v.tests&&v.tests.length>0?v.tests.map(S=>S.name).join(", "):"N/A"]})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[v.status&&i.jsx("span",{className:rre(v.status),children:nre(v.status)}),i.jsx(gg,{size:20,style:{color:"#6c757d"}})]})]},v.id))})})]})})},nre=e=>{if(!e)return"Unknown";switch(e.toLowerCase()){case"pending":return"Pending Sample";case"collected":return"Sample Collected";case"processing":return"Processing";case"report_ready":return"Report Ready";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return e.charAt(0).toUpperCase()+e.slice(1)}},rre=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},RA=()=>{const e=wt(),[n,t]=w.useState([]),[r,a]=w.useState([]),[s,l]=w.useState(!1),[f,d]=w.useState(null),[u,h]=w.useState(""),[g,b]=w.useState("all"),v=10,S=1;w.useEffect(()=>{(async()=>{l(!0),d(null);try{console.log("Fetching pharmacy inventory for view page...");const T=await ge("/api/drugs");if(!T.ok)throw new Error(`HTTP error! status: ${T.status}`);const I=await T.json();console.log("Fetched Pharmacy Inventory for view page:",I),t(I||[])}catch(T){console.error("Error fetching pharmacy inventory:",T),d("Failed to load pharmacy inventory.")}finally{}})()},[]),w.useEffect(()=>{(async()=>{try{console.log("Fetching lab inventory for view page...");const T=await ge("/api/lab-tests");if(!T.ok)throw new Error(`HTTP error! status: ${T.status}`);const I=await T.json();console.log("Fetched Lab Inventory for view page:",I),a(I||[])}catch(T){console.error("Error fetching lab inventory:",T),d(I=>I?`${I} & Failed to load lab inventory.`:"Failed to load lab inventory.")}finally{l(!1)}})()},[]);const k=w.useMemo(()=>{let E=n;return u&&(E=E.filter(T=>T.name.toLowerCase().includes(u.toLowerCase()))),g!=="all"&&(E=E.filter(T=>{const I=(T.quantity_in_stock??1/0)<=v;let D=!1,q=!1;if(T.expiry_date)try{const R=mb(T.expiry_date);if(sg(R)){const F=x1(new Date,S),U=new Date;U.setHours(0,0,0,0),q=Ed(R,U),D=!q&&Ed(R,F)}}catch(R){console.error("Error parsing expiry date for filter:",T.expiry_date,R),D=!0}else D=!0;switch(g){case"low-stock":return I;case"near-expiry":return D;case"expired":return q;default:return!0}})),E},[n,u,g]);return i.jsxs("div",{className:"lab-inventory-container",children:[i.jsxs("div",{className:"lab-inventory-header",children:[i.jsx("h1",{children:"Inventory Overview"}),i.jsxs("button",{onClick:()=>e(-1),className:"lab-inventory-button lab-inventory-button-secondary",title:"Go Back",children:[i.jsx(Ut,{size:18,style:{marginRight:"5px"}})," Back"]})]}),s&&i.jsx("p",{className:"loading-text",children:"Loading inventory..."}),f&&i.jsx("p",{className:"error-text",children:f}),!s&&!f&&i.jsxs("div",{className:"inventory-sections-container",children:[i.jsxs("div",{className:"lab-inventory-card",children:[" ",i.jsxs("div",{className:"inventory-section__header-bar",children:[i.jsxs("h2",{className:"lab-inventory-header",children:[i.jsx(Bb,{size:24,style:{marginRight:"10px",verticalAlign:"middle"}})," Pharmacy Inventory"]}),i.jsxs("div",{className:"inventory-section__controls",children:[" ",i.jsxs("div",{className:"inventory-section__search-area",children:[i.jsx("input",{type:"text",placeholder:"Search drugs...",value:u,onChange:E=>h(E.target.value),className:"lab-inventory-input",style:{marginRight:"5px",marginBottom:"0"}}),i.jsx(aa,{size:18,style:{color:"#777"}})]}),i.jsxs("div",{className:"inventory-section__filter-area",children:[" ",i.jsxs("select",{value:g,onChange:E=>b(E.target.value),className:"lab-inventory-select",children:[i.jsx("option",{value:"all",children:"All Drugs"}),i.jsx("option",{value:"low-stock",children:"Low Stock"}),i.jsx("option",{value:"near-expiry",children:"Near Expiry"}),i.jsx("option",{value:"expired",children:"Expired"})]})]})]})]}),k.length>0?i.jsxs("div",{className:"table-container",children:[" ",i.jsxs("div",{className:"table-scroll-wrapper",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Stock"}),i.jsx("th",{children:"Expiry Date"}),i.jsx("th",{children:"Buying Price"}),i.jsx("th",{children:"Selling Price"})]})}),i.jsx("tbody",{children:k.map(E=>{let T="N/A",I="";const D=(E.quantity_in_stock??1/0)<=v;if(E.expiry_date)try{const q=mb(E.expiry_date);if(sg(q)){T=Oh(q,"dd/MM/yyyy");const R=x1(new Date,1),F=new Date;F.setHours(0,0,0,0),Ed(q,F)?I="highlight-expired":Ed(q,R)&&(I="highlight-near-expiry")}else T="Invalid Date",I="highlight-near-expiry"}catch(q){console.error("Error parsing expiry date:",E.expiry_date,q),T="Error Parsing",I="highlight-near-expiry"}else I="highlight-near-expiry";return i.jsxs("tr",{children:[i.jsx("td",{children:E.name}),i.jsx("td",{children:i.jsx("span",{className:`highlight-box ${D?"highlight-low-stock":""}`,children:E.quantity_in_stock??"N/A"})}),i.jsx("td",{children:i.jsx("span",{className:`highlight-box ${I}`,children:T})}),i.jsx("td",{className:"price-text",children:E.buying_price?`${E.buying_price}`:"N/A"}),i.jsx("td",{className:"price-text",children:E.price?`${E.price}`:"N/A"})]},E.id)})})]})]})]}):i.jsx("p",{className:"no-data-message",children:u?`No drugs found matching "${u}".`:"No pharmacy inventory data available."})]}),i.jsxs("div",{className:"lab-inventory-card",children:[" ",i.jsxs("h2",{className:"lab-inventory-header inventory-section__lab-title",children:[i.jsx(Pw,{size:24,style:{marginRight:"10px",verticalAlign:"middle"}})," Lab Test Inventory"]}),r.length>0?i.jsxs("div",{className:"table-container",children:[" ",i.jsxs("div",{className:"table-scroll-wrapper",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"})]})}),i.jsx("tbody",{children:r.map(E=>i.jsxs("tr",{children:[i.jsx("td",{children:E.name}),i.jsx("td",{className:"price-text",children:E.price?`${E.price}`:"N/A"})]},E.id))})]})]})]}):i.jsx("p",{className:"no-data-message",children:"No lab test inventory data available."})]})]})]})},ire=({fetchWithAuth:e})=>{const n=wt(),[t,r]=w.useState(!0),[a,s]=w.useState([]),[l,f]=w.useState(null),[d,u]=w.useState(null),h=w.useCallback(async()=>{r(!0),f(null);try{const S=await(await e("/staff")).json();s(S.map(k=>({...k,id:k._id||k.id})))}catch(v){f(`Failed to load staff data: ${v.message}`),s([])}finally{r(!1)}},[e]);w.useEffect(()=>{h()},[h]),w.useEffect(()=>{if(d){const v=setTimeout(()=>u(null),5e3);return()=>clearTimeout(v)}},[d]);const g=v=>{switch(v){case"doctor":return"admin-pill-info";case"receptionist":return"admin-pill-success";case"pharmacy":return"admin-pill-primary";case"lab":return"admin-pill-warning";case"admin":return"admin-pill-neutral";default:return"admin-pill-neutral"}},b=v=>{switch(v){case"doctor":return i.jsx(cR,{size:16,className:"mr-2 text-blue-600"});case"receptionist":return i.jsx(Ek,{size:16,className:"mr-2 text-green-600"});case"pharmacy":return i.jsx(Bb,{size:16,className:"mr-2 text-purple-600"});case"lab":return i.jsx(db,{size:16,className:"mr-2 text-yellow-600"});case"admin":return i.jsx(yg,{size:16,className:"mr-2 text-teal-600"});default:return i.jsx(ig,{size:16,className:"mr-2 text-gray-500"})}};return t?i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:[" ",i.jsx("div",{className:"breathing-ball",style:{width:"30px",height:"30px"}})," "]}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Staff..."})]})}):i.jsxs("div",{className:"staff-page-container",children:[d&&i.jsxs("div",{className:`mb-4 p-3 rounded-md flex items-center ${d.type==="success"?"bg-green-100 border border-green-400 text-green-700":"bg-red-100 border border-red-400 text-red-700"}`,role:"alert",children:[d.type==="success"?i.jsx($a,{size:18,className:"mr-2"}):i.jsx(Sr,{size:18,className:"mr-2"}),i.jsx("span",{children:d.message}),i.jsx("button",{onClick:()=>u(null),className:"ml-auto text-xl font-bold",children:""})]}),l&&i.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",role:"alert",children:[i.jsx(Sr,{size:18,className:"mr-2 text-red-500"}),l,i.jsx("button",{onClick:()=>f(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"p-2 rounded-md hover:bg-gray-200",children:i.jsx(Ut,{size:20})}),i.jsx("h1",{className:"text-2xl font-bold",children:"Manage Staff"})]}),i.jsxs("button",{onClick:()=>n("/dashboard/staff/add"),className:"bg-teal-600 text-white px-4 py-2 rounded-md hover:bg-teal-700 flex items-center",children:[i.jsx(Md,{size:16,className:"mr-2"})," Add New Staff"]})]}),i.jsx("div",{className:"staff-table-container",children:i.jsxs("table",{className:"staff-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{className:"hidden md:table-cell",children:"Email"}),i.jsx("th",{children:"Role"}),i.jsx("th",{className:"hidden md:table-cell",children:"OPD Fee ()"}),i.jsx("th",{className:"hidden md:table-cell",children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:a.length===0&&!t?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-4",children:"No staff members found."})}):a.map(v=>i.jsxs("tr",{children:[i.jsx("td",{children:v.name}),i.jsx("td",{className:"hidden md:table-cell",children:v.email}),i.jsx("td",{children:i.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g(v.role)}`,children:[b(v.role),v.role.charAt(0).toUpperCase()+v.role.slice(1)]})}),i.jsx("td",{className:"hidden md:table-cell",children:v.role==="doctor"?v.opd_fee?parseFloat(String(v.opd_fee)).toFixed(2):"Not Set":"N/A"}),i.jsx("td",{className:"hidden md:table-cell",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.status==="active"?"Active":"Inactive"})}),i.jsx("td",{className:"actions",children:i.jsxs("button",{onClick:()=>n(`/dashboard/staff/edit/${v.id}`),className:"edit-link",disabled:v.role==="admin",title:"Edit Staff",children:[i.jsx(Od,{size:16})," Edit"]})})]},v.id))})]})})]})},are=()=>{var k,E,T,I,D,q,R,F,U,z,V,L,$,H;const{patientId:e,billId:n}=ki(),t=wt(),[r,a]=w.useState(null),[s,l]=w.useState(!0),[f,d]=w.useState(null),[u,h]=w.useState(""),[g,b]=w.useState("cash"),v=((k=r==null?void 0:r.patient)==null?void 0:k.insurance_type)==="no_cash_insurance";w.useEffect(()=>{b(v?"no_cash_insurance":"cash")},[v]),w.useEffect(()=>{n?(async()=>{l(!0),d(null);try{const te=await ge(`/api/bills/${n}`);if(!te.ok)throw new Error(`HTTP error! status: ${te.status}`);const ae=await te.json();if(!ae||!ae.bill||!ae.calculated)throw new Error("Incomplete data structure received from backend (missing bill or calculated fields).");if(ae.bill.type!=="admission")throw console.error("Fetched bill is not an admission bill. Bill Type:",ae.bill.type),new Error(`Unexpected bill type received: ${ae.bill.type}. Expected 'admission'.`);console.log("Raw API data received:",JSON.stringify(ae,null,2));const Z=Array.isArray(ae.admissionPayments)?ae.admissionPayments:[];console.log("Processed admissionPaymentsData:",Z);const B={...ae.bill,amount:ae.bill.amount,AdmissionPayments:Z,calculated:ae.calculated,patient:ae.bill.Patient?{id:ae.bill.Patient.id,name:ae.bill.Patient.name,admission_date:ae.bill.Patient.admission_date,discharge_date:ae.bill.Patient.discharge_date}:void 0};console.log("Setting billDetails state to:",JSON.stringify(B,null,2)),a(B)}catch(te){console.error("Failed to fetch admission bill details:",te),d(te instanceof Error?te.message:"An unknown error occurred")}finally{l(!1)}})():(d("Bill ID is missing."),l(!1))},[n,e]);const S=async ee=>{var te;if(ee.preventDefault(),!e||!u||isNaN(parseFloat(u))||parseFloat(u)<=0||parseFloat(u)>(((te=r==null?void 0:r.calculated)==null?void 0:te.balance)??0)){d("Please enter a valid payment amount within the balance due. Patient ID must be present.");return}d(null);try{const ae=await ge(`/api/patients/${e}/admission-payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount_paid:parseFloat(u),payment_mode:g})});if(!ae.ok){const K=await ae.json();throw new Error(K.message||`HTTP error! status: ${ae.status}`)}const B=await(await ge(`/api/bills/${n}`)).json();if(B&&B.bill&&B.calculated&&B.admissionPayments)a({...B.bill,amount:parseFloat(B.bill.amount),AdmissionPayments:B.admissionPayments,calculated:B.calculated,patient:B.bill.Patient?{id:B.bill.Patient.id,name:B.bill.Patient.name,admission_date:B.bill.Patient.admission_date,discharge_date:B.bill.Patient.discharge_date}:void 0});else throw new Error("Invalid data structure received after payment submission.");h("")}catch(ae){console.error("Failed to submit payment:",ae),d(ae instanceof Error?ae.message:"Failed to record payment")}};return s?i.jsx("div",{className:"p-4",children:"Loading admission bill details..."}):f?i.jsxs("div",{className:"p-4 text-red-600",children:["Error: ",f]}):!r||!r.calculated?i.jsx("div",{className:"p-4",children:"No bill details found or data is incomplete."}):i.jsx("div",{className:"admission-page-container",children:i.jsxs("div",{className:"admission-section",children:[" ",i.jsxs("div",{className:"p-4 border-b",children:[" ",i.jsxs("h2",{className:"admission-header",children:["Admission Billing Details (Bill #",r.id,")"]}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Patient: ",((E=r.patient)==null?void 0:E.name)??"N/A"," (ID: ",r.patient_id,")"]})," ",i.jsxs("p",{className:"text-sm text-gray-600",children:["Admission Date: ",(T=r.patient)!=null&&T.admission_date?new Date(r.patient.admission_date).toLocaleDateString():"N/A"]}),((I=r.patient)==null?void 0:I.discharge_date)&&i.jsxs("p",{className:"text-sm text-gray-600",children:["Discharge Date: ",new Date(r.patient.discharge_date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm",children:["Status: ",i.jsx("span",{className:`font-semibold ${r.status==="paid"?"text-green-600":"text-orange-600"}`,children:((D=r.status)==null?void 0:D.toUpperCase())??"UNKNOWN"})]})]}),i.jsxs("div",{className:"p-4",children:[" ",i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Initial Charges:"})," ",i.jsxs("span",{children:["",(parseFloat((r==null?void 0:r.amount)||"0")||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Days Stayed:"})," ",i.jsx("span",{children:((q=r==null?void 0:r.calculated)==null?void 0:q.daysStayed)??0})]}),i.jsxs("p",{className:"flex justify-between text-sm font-semibold mt-2 pt-2 border-t",children:[i.jsx("span",{children:"Total Due:"})," ",i.jsxs("span",{children:["",(Number((R=r==null?void 0:r.calculated)==null?void 0:R.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[i.jsx("span",{children:"Total Paid:"})," ",i.jsxs("span",{children:["",(Number((F=r==null?void 0:r.calculated)==null?void 0:F.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-lg font-bold mt-1 text-red-600",children:[i.jsx("span",{children:"Balance Due:"})," ",i.jsxs("span",{children:["",(Number((U=r==null?void 0:r.calculated)==null?void 0:U.balance)||0).toFixed(2)]})]})]})]}),(r==null?void 0:r.status)!=="paid"&&(Number((z=r==null?void 0:r.calculated)==null?void 0:z.balance)||0)>0&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title text-blue-800",children:"Record New Payment"}),i.jsxs("form",{onSubmit:S,className:"space-y-4",children:[i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentAmount",className:"admission-label",children:"Amount Paid ()"}),i.jsx("input",{id:"paymentAmount",type:"number",value:u,onChange:ee=>h(ee.target.value),placeholder:`Max ${(Number((V=r==null?void 0:r.calculated)==null?void 0:V.balance)||0).toFixed(2)}`,required:!0,min:"0.01",step:"0.01",max:Number((L=r==null?void 0:r.calculated)==null?void 0:L.balance)||0,className:"admission-input"})]}),i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentMode",className:"admission-label",children:"Payment Mode"}),i.jsxs("select",{id:"paymentMode",value:g,onChange:ee=>b(ee.target.value),className:"admission-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"upi",children:"UPI"}),v&&i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),i.jsx("button",{type:"submit",className:"admission-button",disabled:s||!u||parseFloat(u)<=0||parseFloat(u)>(Number(($=r==null?void 0:r.calculated)==null?void 0:$.balance)||0)||v&&g!=="no_cash_insurance",children:"Record Payment"})]})]})]}),i.jsx("h3",{className:"admission-section-title mt-6 border-t pt-4",children:"Admission Payment History"}),Array.isArray(r==null?void 0:r.AdmissionPayments)&&r.AdmissionPayments.length>0?i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"admission-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Payment ID"}),i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Mode"})]})}),i.jsx("tbody",{children:(H=r==null?void 0:r.AdmissionPayments)==null?void 0:H.map(ee=>{if(!ee||typeof ee!="object")return null;let te="Invalid Date";try{ee.payment_date&&!isNaN(new Date(ee.payment_date).getTime())&&(te=new Date(ee.payment_date).toLocaleString())}catch(ae){console.error("Error formatting payment date:",ee.payment_date,ae)}return i.jsxs("tr",{children:[" ",i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ee.id??"N/A"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:te}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["",(Number(ee.amount_paid)||0).toFixed(2)]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:ee.payment_mode??"N/A"})]},ee.id??Math.random())})})]})]}):i.jsx("p",{className:"text-gray-500 text-sm",children:"No payments recorded yet."})]}),i.jsxs("div",{className:"p-4 border-t bg-gray-50 text-right",children:[" ",i.jsx("button",{type:"button",onClick:()=>t(-1),className:"admission-button admission-button-secondary",children:"Back"})]})]})})};var sre=Object.defineProperty,Rb=Object.getOwnPropertySymbols,OA=Object.prototype.hasOwnProperty,LA=Object.prototype.propertyIsEnumerable,W_=(e,n,t)=>n in e?sre(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,mw=(e,n)=>{for(var t in n||(n={}))OA.call(n,t)&&W_(e,t,n[t]);if(Rb)for(var t of Rb(n))LA.call(n,t)&&W_(e,t,n[t]);return e},gw=(e,n)=>{var t={};for(var r in e)OA.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&Rb)for(var r of Rb(e))n.indexOf(r)<0&&LA.call(e,r)&&(t[r]=e[r]);return t};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var zd;(e=>{const n=class an{constructor(d,u,h,g){if(this.version=d,this.errorCorrectionLevel=u,this.modules=[],this.isFunction=[],d<an.MIN_VERSION||d>an.MAX_VERSION)throw new RangeError("Version value out of range");if(g<-1||g>7)throw new RangeError("Mask value out of range");this.size=d*4+17;let b=[];for(let S=0;S<this.size;S++)b.push(!1);for(let S=0;S<this.size;S++)this.modules.push(b.slice()),this.isFunction.push(b.slice());this.drawFunctionPatterns();const v=this.addEccAndInterleave(h);if(this.drawCodewords(v),g==-1){let S=1e9;for(let k=0;k<8;k++){this.applyMask(k),this.drawFormatBits(k);const E=this.getPenaltyScore();E<S&&(g=k,S=E),this.applyMask(k)}}a(0<=g&&g<=7),this.mask=g,this.applyMask(g),this.drawFormatBits(g),this.isFunction=[]}static encodeText(d,u){const h=e.QrSegment.makeSegments(d);return an.encodeSegments(h,u)}static encodeBinary(d,u){const h=e.QrSegment.makeBytes(d);return an.encodeSegments([h],u)}static encodeSegments(d,u,h=1,g=40,b=-1,v=!0){if(!(an.MIN_VERSION<=h&&h<=g&&g<=an.MAX_VERSION)||b<-1||b>7)throw new RangeError("Invalid value");let S,k;for(S=h;;S++){const D=an.getNumDataCodewords(S,u)*8,q=l.getTotalBits(d,S);if(q<=D){k=q;break}if(S>=g)throw new RangeError("Data too long")}for(const D of[an.Ecc.MEDIUM,an.Ecc.QUARTILE,an.Ecc.HIGH])v&&k<=an.getNumDataCodewords(S,D)*8&&(u=D);let E=[];for(const D of d){t(D.mode.modeBits,4,E),t(D.numChars,D.mode.numCharCountBits(S),E);for(const q of D.getData())E.push(q)}a(E.length==k);const T=an.getNumDataCodewords(S,u)*8;a(E.length<=T),t(0,Math.min(4,T-E.length),E),t(0,(8-E.length%8)%8,E),a(E.length%8==0);for(let D=236;E.length<T;D^=253)t(D,8,E);let I=[];for(;I.length*8<E.length;)I.push(0);return E.forEach((D,q)=>I[q>>>3]|=D<<7-(q&7)),new an(S,u,I,b)}getModule(d,u){return 0<=d&&d<this.size&&0<=u&&u<this.size&&this.modules[u][d]}getModules(){return this.modules}drawFunctionPatterns(){for(let h=0;h<this.size;h++)this.setFunctionModule(6,h,h%2==0),this.setFunctionModule(h,6,h%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const d=this.getAlignmentPatternPositions(),u=d.length;for(let h=0;h<u;h++)for(let g=0;g<u;g++)h==0&&g==0||h==0&&g==u-1||h==u-1&&g==0||this.drawAlignmentPattern(d[h],d[g]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(d){const u=this.errorCorrectionLevel.formatBits<<3|d;let h=u;for(let b=0;b<10;b++)h=h<<1^(h>>>9)*1335;const g=(u<<10|h)^21522;a(g>>>15==0);for(let b=0;b<=5;b++)this.setFunctionModule(8,b,r(g,b));this.setFunctionModule(8,7,r(g,6)),this.setFunctionModule(8,8,r(g,7)),this.setFunctionModule(7,8,r(g,8));for(let b=9;b<15;b++)this.setFunctionModule(14-b,8,r(g,b));for(let b=0;b<8;b++)this.setFunctionModule(this.size-1-b,8,r(g,b));for(let b=8;b<15;b++)this.setFunctionModule(8,this.size-15+b,r(g,b));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let d=this.version;for(let h=0;h<12;h++)d=d<<1^(d>>>11)*7973;const u=this.version<<12|d;a(u>>>18==0);for(let h=0;h<18;h++){const g=r(u,h),b=this.size-11+h%3,v=Math.floor(h/3);this.setFunctionModule(b,v,g),this.setFunctionModule(v,b,g)}}drawFinderPattern(d,u){for(let h=-4;h<=4;h++)for(let g=-4;g<=4;g++){const b=Math.max(Math.abs(g),Math.abs(h)),v=d+g,S=u+h;0<=v&&v<this.size&&0<=S&&S<this.size&&this.setFunctionModule(v,S,b!=2&&b!=4)}}drawAlignmentPattern(d,u){for(let h=-2;h<=2;h++)for(let g=-2;g<=2;g++)this.setFunctionModule(d+g,u+h,Math.max(Math.abs(g),Math.abs(h))!=1)}setFunctionModule(d,u,h){this.modules[u][d]=h,this.isFunction[u][d]=!0}addEccAndInterleave(d){const u=this.version,h=this.errorCorrectionLevel;if(d.length!=an.getNumDataCodewords(u,h))throw new RangeError("Invalid argument");const g=an.NUM_ERROR_CORRECTION_BLOCKS[h.ordinal][u],b=an.ECC_CODEWORDS_PER_BLOCK[h.ordinal][u],v=Math.floor(an.getNumRawDataModules(u)/8),S=g-v%g,k=Math.floor(v/g);let E=[];const T=an.reedSolomonComputeDivisor(b);for(let D=0,q=0;D<g;D++){let R=d.slice(q,q+k-b+(D<S?0:1));q+=R.length;const F=an.reedSolomonComputeRemainder(R,T);D<S&&R.push(0),E.push(R.concat(F))}let I=[];for(let D=0;D<E[0].length;D++)E.forEach((q,R)=>{(D!=k-b||R>=S)&&I.push(q[D])});return a(I.length==v),I}drawCodewords(d){if(d.length!=Math.floor(an.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let u=0;for(let h=this.size-1;h>=1;h-=2){h==6&&(h=5);for(let g=0;g<this.size;g++)for(let b=0;b<2;b++){const v=h-b,k=(h+1&2)==0?this.size-1-g:g;!this.isFunction[k][v]&&u<d.length*8&&(this.modules[k][v]=r(d[u>>>3],7-(u&7)),u++)}}a(u==d.length*8)}applyMask(d){if(d<0||d>7)throw new RangeError("Mask value out of range");for(let u=0;u<this.size;u++)for(let h=0;h<this.size;h++){let g;switch(d){case 0:g=(h+u)%2==0;break;case 1:g=u%2==0;break;case 2:g=h%3==0;break;case 3:g=(h+u)%3==0;break;case 4:g=(Math.floor(h/3)+Math.floor(u/2))%2==0;break;case 5:g=h*u%2+h*u%3==0;break;case 6:g=(h*u%2+h*u%3)%2==0;break;case 7:g=((h+u)%2+h*u%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[u][h]&&g&&(this.modules[u][h]=!this.modules[u][h])}}getPenaltyScore(){let d=0;for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let E=0;E<this.size;E++)this.modules[b][E]==v?(S++,S==5?d+=an.PENALTY_N1:S>5&&d++):(this.finderPenaltyAddHistory(S,k),v||(d+=this.finderPenaltyCountPatterns(k)*an.PENALTY_N3),v=this.modules[b][E],S=1);d+=this.finderPenaltyTerminateAndCount(v,S,k)*an.PENALTY_N3}for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let E=0;E<this.size;E++)this.modules[E][b]==v?(S++,S==5?d+=an.PENALTY_N1:S>5&&d++):(this.finderPenaltyAddHistory(S,k),v||(d+=this.finderPenaltyCountPatterns(k)*an.PENALTY_N3),v=this.modules[E][b],S=1);d+=this.finderPenaltyTerminateAndCount(v,S,k)*an.PENALTY_N3}for(let b=0;b<this.size-1;b++)for(let v=0;v<this.size-1;v++){const S=this.modules[b][v];S==this.modules[b][v+1]&&S==this.modules[b+1][v]&&S==this.modules[b+1][v+1]&&(d+=an.PENALTY_N2)}let u=0;for(const b of this.modules)u=b.reduce((v,S)=>v+(S?1:0),u);const h=this.size*this.size,g=Math.ceil(Math.abs(u*20-h*10)/h)-1;return a(0<=g&&g<=9),d+=g*an.PENALTY_N4,a(0<=d&&d<=2568888),d}getAlignmentPatternPositions(){if(this.version==1)return[];{const d=Math.floor(this.version/7)+2,u=this.version==32?26:Math.ceil((this.version*4+4)/(d*2-2))*2;let h=[6];for(let g=this.size-7;h.length<d;g-=u)h.splice(1,0,g);return h}}static getNumRawDataModules(d){if(d<an.MIN_VERSION||d>an.MAX_VERSION)throw new RangeError("Version number out of range");let u=(16*d+128)*d+64;if(d>=2){const h=Math.floor(d/7)+2;u-=(25*h-10)*h-55,d>=7&&(u-=36)}return a(208<=u&&u<=29648),u}static getNumDataCodewords(d,u){return Math.floor(an.getNumRawDataModules(d)/8)-an.ECC_CODEWORDS_PER_BLOCK[u.ordinal][d]*an.NUM_ERROR_CORRECTION_BLOCKS[u.ordinal][d]}static reedSolomonComputeDivisor(d){if(d<1||d>255)throw new RangeError("Degree out of range");let u=[];for(let g=0;g<d-1;g++)u.push(0);u.push(1);let h=1;for(let g=0;g<d;g++){for(let b=0;b<u.length;b++)u[b]=an.reedSolomonMultiply(u[b],h),b+1<u.length&&(u[b]^=u[b+1]);h=an.reedSolomonMultiply(h,2)}return u}static reedSolomonComputeRemainder(d,u){let h=u.map(g=>0);for(const g of d){const b=g^h.shift();h.push(0),u.forEach((v,S)=>h[S]^=an.reedSolomonMultiply(v,b))}return h}static reedSolomonMultiply(d,u){if(d>>>8||u>>>8)throw new RangeError("Byte out of range");let h=0;for(let g=7;g>=0;g--)h=h<<1^(h>>>7)*285,h^=(u>>>g&1)*d;return a(h>>>8==0),h}finderPenaltyCountPatterns(d){const u=d[1];a(u<=this.size*3);const h=u>0&&d[2]==u&&d[3]==u*3&&d[4]==u&&d[5]==u;return(h&&d[0]>=u*4&&d[6]>=u?1:0)+(h&&d[6]>=u*4&&d[0]>=u?1:0)}finderPenaltyTerminateAndCount(d,u,h){return d&&(this.finderPenaltyAddHistory(u,h),u=0),u+=this.size,this.finderPenaltyAddHistory(u,h),this.finderPenaltyCountPatterns(h)}finderPenaltyAddHistory(d,u){u[0]==0&&(d+=this.size),u.pop(),u.unshift(d)}};n.MIN_VERSION=1,n.MAX_VERSION=40,n.PENALTY_N1=3,n.PENALTY_N2=3,n.PENALTY_N3=40,n.PENALTY_N4=10,n.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],n.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=n;function t(f,d,u){if(d<0||d>31||f>>>d)throw new RangeError("Value out of range");for(let h=d-1;h>=0;h--)u.push(f>>>h&1)}function r(f,d){return(f>>>d&1)!=0}function a(f){if(!f)throw new Error("Assertion error")}const s=class fr{constructor(d,u,h){if(this.mode=d,this.numChars=u,this.bitData=h,u<0)throw new RangeError("Invalid argument");this.bitData=h.slice()}static makeBytes(d){let u=[];for(const h of d)t(h,8,u);return new fr(fr.Mode.BYTE,d.length,u)}static makeNumeric(d){if(!fr.isNumeric(d))throw new RangeError("String contains non-numeric characters");let u=[];for(let h=0;h<d.length;){const g=Math.min(d.length-h,3);t(parseInt(d.substring(h,h+g),10),g*3+1,u),h+=g}return new fr(fr.Mode.NUMERIC,d.length,u)}static makeAlphanumeric(d){if(!fr.isAlphanumeric(d))throw new RangeError("String contains unencodable characters in alphanumeric mode");let u=[],h;for(h=0;h+2<=d.length;h+=2){let g=fr.ALPHANUMERIC_CHARSET.indexOf(d.charAt(h))*45;g+=fr.ALPHANUMERIC_CHARSET.indexOf(d.charAt(h+1)),t(g,11,u)}return h<d.length&&t(fr.ALPHANUMERIC_CHARSET.indexOf(d.charAt(h)),6,u),new fr(fr.Mode.ALPHANUMERIC,d.length,u)}static makeSegments(d){return d==""?[]:fr.isNumeric(d)?[fr.makeNumeric(d)]:fr.isAlphanumeric(d)?[fr.makeAlphanumeric(d)]:[fr.makeBytes(fr.toUtf8ByteArray(d))]}static makeEci(d){let u=[];if(d<0)throw new RangeError("ECI assignment value out of range");if(d<128)t(d,8,u);else if(d<16384)t(2,2,u),t(d,14,u);else if(d<1e6)t(6,3,u),t(d,21,u);else throw new RangeError("ECI assignment value out of range");return new fr(fr.Mode.ECI,0,u)}static isNumeric(d){return fr.NUMERIC_REGEX.test(d)}static isAlphanumeric(d){return fr.ALPHANUMERIC_REGEX.test(d)}getData(){return this.bitData.slice()}static getTotalBits(d,u){let h=0;for(const g of d){const b=g.mode.numCharCountBits(u);if(g.numChars>=1<<b)return 1/0;h+=4+b+g.bitData.length}return h}static toUtf8ByteArray(d){d=encodeURI(d);let u=[];for(let h=0;h<d.length;h++)d.charAt(h)!="%"?u.push(d.charCodeAt(h)):(u.push(parseInt(d.substring(h+1,h+3),16)),h+=2);return u}};s.NUMERIC_REGEX=/^[0-9]*$/,s.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,s.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let l=s;e.QrSegment=s})(zd||(zd={}));(e=>{(n=>{const t=class{constructor(a,s){this.ordinal=a,this.formatBits=s}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),n.Ecc=t})(e.QrCode||(e.QrCode={}))})(zd||(zd={}));(e=>{(n=>{const t=class{constructor(a,s){this.modeBits=a,this.numBitsCharCount=s}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),n.Mode=t})(e.QrSegment||(e.QrSegment={}))})(zd||(zd={}));var Ah=zd;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var ore={L:Ah.QrCode.Ecc.LOW,M:Ah.QrCode.Ecc.MEDIUM,Q:Ah.QrCode.Ecc.QUARTILE,H:Ah.QrCode.Ecc.HIGH},FA=128,$A="L",zA="#FFFFFF",BA="#000000",UA=!1,qA=1,lre=4,cre=0,ure=.1;function VA(e,n=0){const t=[];return e.forEach(function(r,a){let s=null;r.forEach(function(l,f){if(!l&&s!==null){t.push(`M${s+n} ${a+n}h${f-s}v1H${s+n}z`),s=null;return}if(f===r.length-1){if(!l)return;s===null?t.push(`M${f+n},${a+n} h1v1H${f+n}z`):t.push(`M${s+n},${a+n} h${f+1-s}v1H${s+n}z`);return}l&&s===null&&(s=f)})}),t.join("")}function HA(e,n){return e.slice().map((t,r)=>r<n.y||r>=n.y+n.h?t:t.map((a,s)=>s<n.x||s>=n.x+n.w?a:!1))}function dre(e,n,t,r){if(r==null)return null;const a=e.length+t*2,s=Math.floor(n*ure),l=a/n,f=(r.width||s)*l,d=(r.height||s)*l,u=r.x==null?e.length/2-f/2:r.x*l,h=r.y==null?e.length/2-d/2:r.y*l,g=r.opacity==null?1:r.opacity;let b=null;if(r.excavate){let S=Math.floor(u),k=Math.floor(h),E=Math.ceil(f+u-S),T=Math.ceil(d+h-k);b={x:S,y:k,w:E,h:T}}const v=r.crossOrigin;return{x:u,y:h,h:d,w:f,excavation:b,opacity:g,crossOrigin:v}}function fre(e,n){return n!=null?Math.max(Math.floor(n),0):e?lre:cre}function GA({value:e,level:n,minVersion:t,includeMargin:r,marginSize:a,imageSettings:s,size:l,boostLevel:f}){let d=Tn.useMemo(()=>{const S=(Array.isArray(e)?e:[e]).reduce((k,E)=>(k.push(...Ah.QrSegment.makeSegments(E)),k),[]);return Ah.QrCode.encodeSegments(S,ore[n],t,void 0,void 0,f)},[e,n,t,f]);const{cells:u,margin:h,numCells:g,calculatedImageSettings:b}=Tn.useMemo(()=>{let v=d.getModules();const S=fre(r,a),k=v.length+S*2,E=dre(v,l,S,s);return{cells:v,margin:S,numCells:k,calculatedImageSettings:E}},[d,l,s,r,a]);return{qrcode:d,margin:h,cells:u,numCells:g,calculatedImageSettings:b}}var hre=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),Bh=Tn.forwardRef(function(n,t){const r=n,{value:a,size:s=FA,level:l=$A,bgColor:f=zA,fgColor:d=BA,includeMargin:u=UA,minVersion:h=qA,boostLevel:g,marginSize:b,imageSettings:v}=r,k=gw(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:E}=k,T=gw(k,["style"]),I=v==null?void 0:v.src,D=Tn.useRef(null),q=Tn.useRef(null),R=Tn.useCallback(te=>{D.current=te,typeof t=="function"?t(te):t&&(t.current=te)},[t]),[F,U]=Tn.useState(!1),{margin:z,cells:V,numCells:L,calculatedImageSettings:$}=GA({value:a,level:l,minVersion:h,boostLevel:g,includeMargin:u,marginSize:b,imageSettings:v,size:s});Tn.useEffect(()=>{if(D.current!=null){const te=D.current,ae=te.getContext("2d");if(!ae)return;let Z=V;const B=q.current,K=$!=null&&B!==null&&B.complete&&B.naturalHeight!==0&&B.naturalWidth!==0;K&&$.excavation!=null&&(Z=HA(V,$.excavation));const oe=window.devicePixelRatio||1;te.height=te.width=s*oe;const A=s/L*oe;ae.scale(A,A),ae.fillStyle=f,ae.fillRect(0,0,L,L),ae.fillStyle=d,hre?ae.fill(new Path2D(VA(Z,z))):V.forEach(function(se,ue){se.forEach(function(M,pe){M&&ae.fillRect(pe+z,ue+z,1,1)})}),$&&(ae.globalAlpha=$.opacity),K&&ae.drawImage(B,$.x+z,$.y+z,$.w,$.h)}}),Tn.useEffect(()=>{U(!1)},[I]);const H=mw({height:s,width:s},E);let ee=null;return I!=null&&(ee=Tn.createElement("img",{src:I,key:I,style:{display:"none"},onLoad:()=>{U(!0)},ref:q,crossOrigin:$==null?void 0:$.crossOrigin})),Tn.createElement(Tn.Fragment,null,Tn.createElement("canvas",mw({style:H,height:s,width:s,ref:R,role:"img"},T)),ee)});Bh.displayName="QRCodeCanvas";var pre=Tn.forwardRef(function(n,t){const r=n,{value:a,size:s=FA,level:l=$A,bgColor:f=zA,fgColor:d=BA,includeMargin:u=UA,minVersion:h=qA,boostLevel:g,title:b,marginSize:v,imageSettings:S}=r,k=gw(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:E,cells:T,numCells:I,calculatedImageSettings:D}=GA({value:a,level:l,minVersion:h,boostLevel:g,includeMargin:u,marginSize:v,imageSettings:S,size:s});let q=T,R=null;S!=null&&D!=null&&(D.excavation!=null&&(q=HA(T,D.excavation)),R=Tn.createElement("image",{href:S.src,height:D.h,width:D.w,x:D.x+E,y:D.y+E,preserveAspectRatio:"none",opacity:D.opacity,crossOrigin:D.crossOrigin}));const F=VA(q,E);return Tn.createElement("svg",mw({height:s,width:s,viewBox:`0 0 ${I} ${I}`,ref:t,role:"img"},k),!!b&&Tn.createElement("title",null,b),Tn.createElement("path",{fill:f,d:`M0,0 h${I}v${I}H0z`,shapeRendering:"crispEdges"}),Tn.createElement("path",{fill:d,d:F,shapeRendering:"crispEdges"}),R)});pre.displayName="QRCodeSVG";const mre=e=>{switch(e){case"pending":return{text:"text-orange-700",bg:"bg-orange-100"};case"billed":return{text:"text-blue-700",bg:"bg-blue-100"};case"dispensed":return{text:"text-green-700",bg:"bg-green-100"};case"cancelled":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},gre=()=>{const{orderId:e}=ki(),n=wt(),[t,r]=w.useState(null),[a,s]=w.useState(!0),[l,f]=w.useState(null),[d,u]=w.useState(!1),[h,g]=w.useState({}),[b,v]=w.useState(""),[S,k]=w.useState(""),[E,T]=w.useState("cash"),I=w.useMemo(()=>(t==null?void 0:t.medications.reduce(($,H)=>{const ee=H.total_price??0,te=ee*(H.discount_percentage??0)/100;return $+ee-te},0))??0,[t==null?void 0:t.medications]),D=5,q=w.useMemo(()=>!t||!t.medications?0:t.medications.reduce(($,H,ee)=>{var oe,A;const te=H.drug_id??`index-${ee}`,ae=((oe=h[te])==null?void 0:oe.pack)||0,Z=((A=h[te])==null?void 0:A.loose)||0,B=H.pack_price??0,K=H.loose_price??0;return $+ae*B+Z*K},0),[t,h]),R=w.useCallback(async()=>{if(!e){f("Order ID is missing."),s(!1);return}s(!0),f(null);try{const $=await ge(`/api/pharmacy-orders/${e}`);if(!$.ok)throw $.status===404?new Error(`Order with ID ${e} not found.`):new Error(`Failed to fetch order details: ${$.statusText} (${$.status})`);const H=await $.json();console.log("Fetched order data after return:",H);const te=H.medications.map(Z=>Z.pack_price&&Z.loose_price&&Z.loose_price>0?{...Z,unitsPerPack:Math.round(Z.pack_price/Z.loose_price)}:{...Z,unitsPerPack:0}).map(Z=>({...Z,discount_percentage:Z.discount_percentage??0}));r({...H,medications:te});const ae={};te.forEach((Z,B)=>{const K=Z.drug_id??`index-${B}`;ae[K]={pack:0,loose:0}}),g(ae)}catch($){console.error("Failed to fetch order details:",$),f($.message||"Failed to load order details.")}finally{s(!1)}},[e]);w.useEffect(()=>{R()},[R]),w.useEffect(()=>{(async()=>{try{const H=await ge("/api/clinics/settings");if(!H.ok)throw new Error("Failed to fetch clinic settings");const ee=await H.json();console.log("Fetched clinic settings:",ee),v(ee.upi_id||"")}catch(H){console.error("Error fetching clinic settings:",H)}})()},[]),w.useEffect(()=>{if((t==null?void 0:t.order_total)!==void 0&&t.order_total>0&&b){const $=`upi://pay?pa=${b}&pn=ClinicName&am=${t.order_total.toFixed(2)}&cu=INR`;k($)}else k("")},[t==null?void 0:t.order_total,b]);const F=($,H)=>{r(ee=>{if(!ee)return null;const te=ee.medications.map((Z,B)=>(Z.drug_id??`index-${B}`)===$?{...Z,discount_percentage:isNaN(H)?0:H}:Z),ae=te.reduce((Z,B)=>{const K=B.total_price??0,oe=K*(B.discount_percentage??0)/100;return Z+K-oe},0);return{...ee,medications:te,order_total:ae}})},U=($,H,ee)=>{g(te=>{const ae=ee.unitsPerPack||0,B=ee.pack_quantity*ae+ee.loose_quantity,K=Math.max(0,Math.min(H,B));let oe=0,A=K;return ae>0&&(oe=Math.floor(K/ae),A=K%ae),{...te,[$]:{pack:oe,loose:A}}})},z=async()=>{const $=t==null?void 0:t.medications.map((H,ee)=>{var B,K;const te=H.drug_id??`index-${ee}`,ae=((B=h[te])==null?void 0:B.pack)||0,Z=((K=h[te])==null?void 0:K.loose)||0;return ae>0||Z>0?{drug_id:H.drug_id,name:H.name,pack_quantity:H.pack_quantity,loose_quantity:H.loose_quantity,returnPackQuantity:ae,returnLooseQuantity:Z}:null}).filter(H=>H!==null);if(!$||$.length===0){alert("Please select a quantity greater than 0 for at least one item to return.");return}if(!e){alert("Order ID is missing. Cannot process return.");return}if(!$){alert("Could not prepare items for return.");return}u(!0),f(null);try{const H=await ge(`/api/pharmacy-orders/${e}/return`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemsToReturn:$})}),ee=await H.json();if(!H.ok)throw new Error(ee.message||`Failed to process return: ${H.statusText}`);alert("Return processed successfully! Stock has been updated.");const te={};t==null||t.medications.forEach((ae,Z)=>{const B=ae.drug_id??`index-${Z}`;te[B]={pack:0,loose:0}}),g(te),R()}catch(H){console.error("Failed to process return:",H),f(H.message||"An error occurred while processing the return."),alert(`Error processing return: ${H.message||"Unknown error"}`)}finally{u(!1)}};if(a)return i.jsx("div",{className:"text-center p-6 text-gray-500 animate-pulse",children:"Loading Order Details..."});if(l)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(Ut,{size:14,className:"mr-1.5"})," Back"]}),i.jsxs("div",{className:"bg-red-50 border border-red-300 text-red-700 rounded p-4",children:["Error: ",l]})]});if(!t)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(Ut,{size:14,className:"mr-1.5"})," Back"]}),i.jsx("div",{className:"text-center py-10 px-4 text-gray-500 bg-white rounded-lg shadow",children:"Order details could not be loaded."})]});const V=()=>{window.print()},L=mre(t.status);return i.jsx("div",{className:"pharmacy-order-details-page",children:i.jsxs("div",{className:"order-details-container printable-section",children:[i.jsxs("div",{className:"order-details-header no-print",children:[i.jsx("h1",{children:"Pharmacy Order Details"}),i.jsxs("div",{className:"actions",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:[i.jsx(Ut,{size:18})," Back to Queue"]}),i.jsxs("button",{onClick:V,className:"print-button",children:[i.jsx(Ml,{size:18})," Print Bill"]})]})]}),i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{children:"Mahajan Pharmacy"}),i.jsxs("div",{className:"clinic-details-print",children:[i.jsx("span",{className:"small-text clinic-address",children:"D.No: 3-1-289, Plot No. 101, Kabela Center, RR Nagar, Vijayawada  520012."}),i.jsx("span",{className:"small-text clinic-notes",children:"Phone: 93919 44733"}),i.jsx("span",{className:"small-text clinic-license",children:"Licence No:RLF20AP2025003328"})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Patient Name:"})," RESHMA"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Token:"})," 12"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Order Date:"})," 31/10/2025"]})]})]}),i.jsxs("div",{className:"order-info-section no-print",children:[i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Order ID:"})," ",t.id]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Patient:"})," ",t.patientName||"N/A"," (",t.patientTokenNumber||"N/A",")"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Date:"})," ",new Date(t.date).toLocaleString()]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Prescribed By:"})," ",t.prescribedBy||"N/A"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:`status-pill ${L.text} ${L.bg}`,children:t.status})]})]}),i.jsxs("div",{className:"medications-section",children:[i.jsx("h2",{children:"Medications Ordered"}),t.medications.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"PACK QTY"}),i.jsx("th",{children:"PACK PRICE"}),i.jsx("th",{children:"LOOSE QTY"}),i.jsx("th",{children:"LOOSE PRICE"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"no-print",children:"RETURN PACK QTY"}),i.jsx("th",{className:"no-print",children:"RETURN LOOSE QTY"})]})]})}),i.jsx("tbody",{children:t.medications.map(($,H)=>{var oe,A,se,ue,M,pe;const ee=$.drug_id??`index-${H}`,te=$.total_price??0,ae=te*($.discount_percentage??0)/100,Z=te-ae,B=((oe=h[ee])==null?void 0:oe.pack)||0,K=((A=h[ee])==null?void 0:A.loose)||0;return i.jsxs("tr",{children:[i.jsx("td",{children:$.name}),i.jsx("td",{children:$.pack_quantity??0}),i.jsx("td",{children:((se=$.pack_price)==null?void 0:se.toFixed(2))??"N/A"}),i.jsx("td",{children:$.loose_quantity??0}),i.jsx("td",{children:((ue=$.loose_price)==null?void 0:ue.toFixed(2))??"N/A"}),i.jsx("td",{children:((M=$.price)==null?void 0:M.toFixed(2))??"N/A"})," ",i.jsx("td",{children:((pe=$.price)==null?void 0:pe.toFixed(2))??"N/A"})," ",i.jsxs("td",{children:[i.jsx("input",{type:"number",value:$.discount_percentage??0,onChange:be=>F(ee,parseFloat(be.target.value)),min:"0",max:"100",className:"discount-input-table no-print"}),i.jsxs("span",{className:"print-only",children:[$.discount_percentage??0,"%"]})]}),i.jsxs("td",{children:[D.toFixed(1),"%"]}),i.jsx("td",{children:Z.toFixed(2)}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:$.pack_quantity,value:B,onChange:be=>{const Pe=(parseInt(be.target.value,10)||0)*($.unitsPerPack||0)+K;U(ee,Pe,$)},className:"return-quantity-input"})}),i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:$.loose_quantity+$.pack_quantity*($.unitsPerPack||0)-B*($.unitsPerPack||0),value:K,onChange:be=>{const fe=parseInt(be.target.value,10)||0,Pe=B*($.unitsPerPack||0)+fe;U(ee,Pe,$)},className:"return-quantity-input"})})]})]},ee)})})]}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No medications listed for this order."})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",I.toFixed(2)]})}),i.jsxs("div",{className:"order-total-section no-print",children:[i.jsx("span",{className:"total-label",children:"Order Total:"}),i.jsxs("span",{className:"total-amount",children:["",I.toFixed(2)]})]}),i.jsxs("div",{className:"payment-section no-print",children:[i.jsxs("div",{className:"payment-mode-group",children:[i.jsx("label",{htmlFor:"paymentMode",children:"Payment Mode:"}),i.jsxs("select",{id:"paymentMode",value:E,onChange:$=>T($.target.value),className:"payment-mode-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),S&&i.jsxs("div",{className:"qr-code-container",children:[i.jsx(Bh,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]})]}),(t.status==="dispensed"||t.status==="billed")&&t.medications.length>0&&i.jsxs("div",{className:"return-action-section no-print",children:[q>0&&i.jsxs("div",{className:"total-refund-display",children:["Total Refund: ",q.toFixed(2)]}),i.jsx("button",{onClick:z,disabled:Object.values(h).every($=>$.pack===0&&$.loose===0)||d,className:"process-return-button",children:d?i.jsxs(i.Fragment,{children:[i.jsx(fb,{size:16,className:"mr-2 animate-spin"})," Processing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(fb,{size:16,className:"mr-2"})," Process Return"]})})]})]})})},yre=async()=>{const e=await ge("/subscriptions");if(!e.ok)throw new Error("Failed to fetch subscription plans");return await e.json()},xre=async e=>{const n=await ge(`/subscriptions/${e}`);if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to fetch subscription plan details"}));throw new Error(t.message||"Failed to fetch subscription plan details")}return await n.json()},bre=async e=>{const n=await ge("/subscriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to create subscription plan"}));throw new Error(t.message||"Failed to create subscription plan")}return await n.json()},vre=async(e,n)=>{const t=await ge(`/subscriptions/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to update subscription plan"}));throw new Error(r.message||"Failed to update subscription plan")}return await t.json()},wre=async e=>{const n=await ge(`/subscriptions/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to deactivate subscription plan"}));throw new Error(t.message||"Failed to deactivate subscription plan")}return await n.json()},Sre=async(e,n)=>{const t=await ge("/api/payment/razorpay-subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:e,planId:n})});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to initiate Razorpay subscription"}));throw new Error(r.message||"Failed to initiate Razorpay subscription")}return await t.json()},Nre=()=>{const e=wt(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[s,l]=w.useState(null),[f,d]=w.useState(null),u=w.useCallback(async()=>{a(!0),l(null);try{const g=await yre();t(g)}catch(g){l(g.message||"Failed to fetch subscription plans."),d({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{u()},[u]),w.useEffect(()=>{if(f){const g=setTimeout(()=>d(null),5e3);return()=>clearTimeout(g)}},[f]);const h=async g=>{if(d(null),l(null),window.confirm("Are you sure you want to deactivate this plan? This action cannot be undone directly.")){a(!0),l(null),d(null);try{await wre(g),d({type:"success",message:"Plan deactivated successfully!"}),u()}catch(b){l(b.message||"Failed to deactivate plan."),d({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[f&&i.jsxs("div",{className:`${f.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[f.type==="success"?i.jsx($a,{size:18,className:"mr-2 text-green-500"}):i.jsx(Sr,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:f.message})]}),i.jsx("button",{onClick:()=>d(null),className:`${f.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Jn,{size:16})})]}),i.jsxs("div",{children:[" ",i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(Ut,{size:16}),"Back"]}),i.jsx("h1",{children:"Manage Subscription Plans"}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions/add"),className:"subscription-btn",children:[i.jsx(Md,{size:16,className:"mr-1 inline-block"})," Add New Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading plans..."})]})}),!r&&s&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:s}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx(Od,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>h(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(ti,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!s&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No subscription plans found. Add one to get started!"})]})]})},Cre=()=>{const e=wt(),[n,t]=w.useState({name:"",description:"",price:"",period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[s,l]=w.useState(null),[f,d]=w.useState(null);w.useEffect(()=>{if(f){const b=setTimeout(()=>d(null),5e3);return()=>clearTimeout(b)}},[f]);const u=b=>{const{name:v,value:S}=b.target;t(k=>({...k,[v]:S}))},h=async b=>{if(b.preventDefault(),a(!0),l(null),d(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){l("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await bre(n),d({type:"success",message:"Plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create plan.";l(S),d({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[f&&i.jsxs("div",{className:`${f.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[f.type==="success"?i.jsx($a,{size:18,className:"mr-2 text-green-500"}):i.jsx(Sr,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:f.message})]}),i.jsx("button",{onClick:()=>d(null),className:`${f.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Jn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Subscription Plan"}),s&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:s}),i.jsxs("form",{onSubmit:h,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:u})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:u,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:u,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:u})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},jre=()=>{const{id:e}=ki(),n=wt(),[t,r]=w.useState(null),[a,s]=w.useState({}),[l,f]=w.useState(!1),[d,u]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),u(!1);return}u(!0),g(null);try{const I=await xre(e);r(I),s({name:I.name,description:I.description||"",price:I.price,period:I.period,interval:I.interval,razorpay_plan_id:I.razorpay_plan_id||"",status:I.status})}catch(I){g(I.message||"Failed to fetch plan details."),v({type:"error",message:I.message||"Failed to fetch plan details."})}finally{u(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const I=setTimeout(()=>v(null),5e3);return()=>clearTimeout(I)}},[b]);const k=I=>{const{name:D,value:q}=I.target;s(R=>({...R,[D]:q}))},E=async I=>{if(I.preventDefault(),!e){g("Plan ID is missing.");return}if(f(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),f(!1);return}try{await vre(e,a),v({type:"success",message:"Plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(D){const q=D.message||"Failed to update plan.";g(q),v({type:"error",message:q})}finally{f(!1)}},T=()=>{n(-1)};return d?i.jsx("div",{className:"p-6 text-center",children:"Loading plan details..."}):h&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:h}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx($a,{size:18,className:"mr-2"}):i.jsx(Sr,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(Jn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Subscription Plan"}),h&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:h}),i.jsxs("form",{onSubmit:E,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval||1,onChange:k,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:T,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:l,className:"subscription-btn",children:[l?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,l?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Plan not found."})},_re=()=>{const{patientId:e}=ki(),n=wt(),[t,r]=w.useState(null),[a,s]=w.useState([]),[l,f]=w.useState(""),[d,u]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState("manual"),[S,k]=w.useState(!1),[E,T]=w.useState(null),I=w.useCallback(async()=>{u(!0),g(null);try{const R=await ge(`/api/patients/${e}`);if(!R.ok){const V=await R.json();throw new Error(V.message||"Failed to fetch patient details")}const F=await R.json();r(F);const U=await ge("/api/subscriptions");if(!U.ok){const V=await U.json();throw new Error(V.message||"Failed to fetch subscription plans")}const z=await U.json();s(z.filter(V=>V.status==="active"))}catch(R){console.error("Error fetching data:",R),g(`Failed to load data: ${R.message}`)}finally{u(!1)}},[e]);w.useEffect(()=>{e?I():(g("Patient ID is missing."),u(!1))},[e,I]);const D=(R,F)=>{const U=new Date(R),z=F.interval||1;switch(F.period){case"daily":U.setDate(R.getDate()+z);break;case"weekly":U.setDate(R.getDate()+z*7);break;case"monthly":U.setMonth(R.getMonth()+z);break;case"yearly":U.setFullYear(R.getFullYear()+z);break;default:console.warn(`Unknown subscription period: ${F.period}. Defaulting to 1 month.`),U.setMonth(R.getMonth()+1)}return U},q=async()=>{if(!e||!l){T("Please select a subscription plan.");return}const R=a.find(F=>F.id===l);if(!R){T("Selected plan details not found.");return}k(!0),T(null);try{const F=new Date,U=D(F,R);if(b==="manual"){const z={subscription_plan_id:l,subscription_status:"active",subscription_start_date:F.toISOString(),subscription_end_date:U.toISOString(),subscription_payment_method:"manual"},V=await ge(`/api/patients/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)});if(!V.ok){const L=await V.json();throw new Error(L.message||"Failed to start subscription manually")}alert(`Subscription started successfully for ${t==null?void 0:t.name} (Manual Payment)!`),n("/all-patients")}else if(b==="razorpay"){console.log("Initiating Razorpay subscription for plan:",R);const z=await Sre(e,l);if(z&&z.short_url)window.location.href=z.short_url;else throw new Error("Failed to get Razorpay subscription link from backend.")}}catch(F){console.error("Error starting subscription:",F),T(`Failed to start subscription: ${F.message}`),k(!1)}};return d?i.jsx("div",{className:"loading-state-subscription",children:"Loading patient and plans..."}):h?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:h})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(Ut,{size:16})," ","Back"]})]}):t?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(Ut,{size:16})," ","Back"]}),i.jsxs("h1",{children:[i.jsx(Gc,{size:28})," ","Start Subscription for ",t.name]}),E&&i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[" ",i.jsx("span",{children:E})]}),i.jsxs("div",{className:"subscription-form",children:[" ",i.jsx("h2",{children:"Available Subscription Plans"}),a.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:a.map(R=>i.jsxs("div",{className:`subscription-plan-card ${l===R.id?"selected-plan":""}`,onClick:()=>f(R.id),children:[i.jsx("h3",{children:R.name}),i.jsxs("p",{className:"price",children:["",R.price]}),i.jsxs("p",{className:"duration",children:["Every ",R.interval," ",R.period,R.interval>1?"s":""]}),R.description&&i.jsx("p",{children:R.description})]},R.id))})]}),i.jsxs("div",{className:"subscription-form mb-6",children:[" ",i.jsx("h2",{children:"Select Payment Method"}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"manual",checked:b==="manual",onChange:()=>v("manual"),className:"mr-2"}),i.jsx("span",{children:"Cash (Manual)"})]})}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"razorpay",checked:b==="razorpay",onChange:()=>v("razorpay"),className:"mr-2"}),i.jsx("span",{children:"Razorpay"})]})})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:q,disabled:!l||S||a.length===0,className:"subscription-btn",children:[S&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),S?"Starting...":"Start Subscription"]})})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Warning: "}),i.jsx("span",{children:"Patient not found."})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(Ut,{size:16}),"Back"]})]})},kre=()=>{const e=wt(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[s,l]=w.useState(null),[f,d]=w.useState(null),u=w.useCallback(async()=>{a(!0),l(null);try{const g=await Iw();t(g)}catch(g){l(g.message||"Failed to fetch clinic subscription plans."),d({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{u()},[u]),w.useEffect(()=>{if(f){const g=setTimeout(()=>d(null),5e3);return()=>clearTimeout(g)}},[f]);const h=async g=>{if(d(null),l(null),window.confirm("Are you sure you want to deactivate this clinic plan? This action cannot be undone directly.")){a(!0),l(null),d(null);try{await nL(g),d({type:"success",message:"Clinic plan deactivated successfully!"}),u()}catch(b){l(b.message||"Failed to deactivate clinic plan."),d({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[f&&i.jsxs("div",{className:`${f.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[f.type==="success"?i.jsx($a,{size:18,className:"mr-2 text-green-500"}):i.jsx(Sr,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:f.message})]}),i.jsx("button",{onClick:()=>d(null),className:`${f.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Jn,{size:16})})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"p-2 rounded-md hover:bg-gray-200",children:i.jsx(Ut,{size:20})}),i.jsx("h1",{className:"text-2xl font-bold",children:"Manage Clinic Subscription Plans"})]}),i.jsxs("button",{onClick:()=>e("/dashboard/clinic-subscriptions/add"),className:"subscription-btn",children:[i.jsx(Md,{size:16,className:"mr-1 inline-block"})," Add New Clinic Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading clinic plans..."})]})}),!r&&s&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:s}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/clinic-subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx(Od,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>h(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(ti,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!s&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No clinic subscription plans found. Add one to get started!"})]})]})},Ere=()=>{const e=wt(),[n,t]=w.useState({name:"",description:"",price:0,period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[s,l]=w.useState(null),[f,d]=w.useState(null);w.useEffect(()=>{if(f){const b=setTimeout(()=>d(null),5e3);return()=>clearTimeout(b)}},[f]);const u=b=>{const{name:v,value:S,type:k}=b.target;t(E=>({...E,[v]:k==="number"?parseFloat(S):S}))},h=async b=>{if(b.preventDefault(),a(!0),l(null),d(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){l("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await eL(n),d({type:"success",message:"Clinic plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/clinic-subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create clinic plan.";l(S),d({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[f&&i.jsxs("div",{className:`${f.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[f.type==="success"?i.jsx($a,{size:18,className:"mr-2 text-green-500"}):i.jsx(Sr,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:f.message})]}),i.jsx("button",{onClick:()=>d(null),className:`${f.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(Jn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Clinic Subscription Plan"}),s&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:s}),i.jsxs("form",{onSubmit:h,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:u})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:u,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:u,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:u})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},Tre=()=>{const{id:e}=ki(),n=wt(),[t,r]=w.useState(null),[a,s]=w.useState({}),[l,f]=w.useState(!1),[d,u]=w.useState(!0),[h,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),u(!1);return}u(!0),g(null);try{const I=await ZO(e);r(I),s({name:I.name,description:I.description||"",price:Number(I.price),period:I.period,interval:Number(I.interval),razorpay_plan_id:I.razorpay_plan_id||"",status:I.status})}catch(I){g(I.message||"Failed to fetch clinic plan details."),v({type:"error",message:I.message||"Failed to fetch plan details."})}finally{u(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const I=setTimeout(()=>v(null),5e3);return()=>clearTimeout(I)}},[b]);const k=I=>{const{name:D,value:q,type:R}=I.target;s(F=>({...F,[D]:R==="number"?parseFloat(q):q}))},E=async I=>{if(I.preventDefault(),!e){g("Plan ID is missing.");return}if(f(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),f(!1);return}try{await tL(e,a),v({type:"success",message:"Clinic plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(D){const q=D.message||"Failed to update clinic plan.";g(q),v({type:"error",message:q})}finally{f(!1)}},T=()=>{n(-1)};return d?i.jsx("div",{className:"p-6 text-center",children:"Loading clinic plan details..."}):h&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:h}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx($a,{size:18,className:"mr-2"}):i.jsx(Sr,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(Jn,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Clinic Subscription Plan"}),h&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:h}),i.jsxs("form",{onSubmit:E,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price!==void 0?a.price:"",onChange:k,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval!==void 0?a.interval:"",onChange:k,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:T,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:l,className:"subscription-btn",children:[l?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,l?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Clinic plan not found."})},Are=()=>{const e=wt(),[n,t]=w.useState([]),[r,a]=w.useState(""),[s,l]=w.useState(!0),[f,d]=w.useState(null),[u,h]=w.useState(!1),[g,b]=w.useState(null),v=w.useCallback(async()=>{d(null);try{const E=(await Iw()).filter(T=>T.status==="active");t(E),E.length>0&&!r&&a(E[0].id)}catch(k){console.error("Error fetching plans:",k),d(`Failed to load subscription plans: ${k.message}`)}},[]);w.useEffect(()=>{(async()=>{l(!0);try{const E=await iL();if(E&&E.short_url){window.location.href=E.short_url,d("You have a pending subscription. Redirecting to payment...");return}await v()}catch(E){console.error("Error during initial page load:",E),d(`An unexpected error occurred: ${E.message}`)}finally{l(!1)}})()},[v]);const S=async()=>{if(!r){b("Please select a clinic subscription plan.");return}const k=n.find(E=>E.id===r);if(!k){b("Selected plan details not found.");return}h(!0),b(null);try{console.log("Initiating Razorpay clinic subscription for plan:",k);const E=await rL(r);if(E&&E.short_url)window.location.href=E.short_url;else throw new Error("Failed to get Razorpay clinic subscription link from backend.")}catch(E){console.error("Error starting clinic subscription:",E),b(`Failed to start clinic subscription: ${E.message}`),h(!1)}};return s?i.jsx("div",{className:"loading-state-subscription",children:"Loading clinic plans..."}):f?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:f})]}),i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(Ut,{size:16}),"Back"]})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(Ut,{size:16}),"Back"]}),i.jsxs("h1",{children:[i.jsx($I,{size:28}),"Buy Pro Plan for Clinic"]}),g&&i.jsx("div",{className:"error-alert-subscription",role:"alert",children:i.jsx("span",{children:g})}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h2",{children:"Available Pro Plans"}),n.length===0?i.jsx("p",{className:"empty-state",children:"No active clinic subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:n.map(k=>i.jsxs("div",{className:`subscription-plan-card ${r===k.id?"selected-plan":""}`,onClick:()=>a(k.id),children:[i.jsx("h3",{children:k.name}),i.jsxs("p",{className:"price",children:["",Number(k.price).toFixed(2)]}),i.jsxs("p",{className:"duration",children:["Every ",k.interval," ",k.period,k.interval>1?"s":""]}),k.description&&i.jsx("p",{children:k.description})]},k.id))})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:S,disabled:!r||u||n.length===0,className:"subscription-btn",children:[u&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),u?"Initiating Payment...":"Buy Pro Plan"]})})]})},Pre=()=>{const e=wt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[s,l]=w.useState(null),[f,d]=w.useState(!1),[u,h]=w.useState(!1),[g,b]=w.useState(null),[v,S]=w.useState({name:"",email:"",password:"",role:"user"}),[k,E]=w.useState({name:"",email:"",role:"",password:"",confirmPassword:""}),[T,I]=w.useState(""),[D,q]=w.useState(""),[R,F]=w.useState({}),[U,z]=w.useState(!1),[V,L]=w.useState(null),[$,H]=w.useState([]),[ee,te]=w.useState(""),[ae,Z]=w.useState(!1),[B,K]=w.useState(null);w.useEffect(()=>{const de=setTimeout(()=>{q(T)},500);return()=>{clearTimeout(de)}},[T]),w.useEffect(()=>{oe(D)},[D]);const oe=async(de="")=>{a(!0);try{const Me=de?`/api/users?search=${encodeURIComponent(de)}`:"/api/users",Fe=await(await ge(Me)).json();if(t(Fe),Fe.length>0){const Ce=[...new Set(Fe.map(xe=>xe.clinic_id).filter(xe=>!!xe))],Re={};await Promise.all(Ce.map(async xe=>{try{const Ie=await XO(xe);Re[xe]=Ie}catch(Ie){console.error(`Failed to fetch subscription status for clinic ${xe}`,Ie),Re[xe]={hasProPlan:!1}}})),F(Re)}l(null)}catch(Me){l("Failed to fetch users."),console.error(Me)}finally{a(!1)}},A=async de=>{de.preventDefault();try{await ge("/users",{method:"POST",body:JSON.stringify(v)}),d(!1),S({name:"",email:"",password:"",role:"user"}),oe()}catch(Me){l("Failed to add user."),console.error(Me)}},se=async de=>{if(de.preventDefault(),!g)return;const{password:Me,confirmPassword:Ze,...Fe}=k,Ce={...Fe};if(Me){if(Me.length<6){l("Password must be at least 6 characters long.");return}if(Me!==Ze){l("Passwords do not match.");return}Ce.password=Me}try{await ge(`/users/${g.id}`,{method:"PUT",body:JSON.stringify(Ce)}),h(!1),b(null),E({...k,password:"",confirmPassword:""}),oe()}catch(Re){l("Failed to update user."),console.error(Re)}},ue=async de=>{if(window.confirm("Are you sure you want to delete this user?"))try{await ge(`/users/${de}`,{method:"DELETE"}),oe()}catch(Me){l("Failed to delete user."),console.error(Me)}},M=de=>{b(de),E({name:de.name,email:de.email,role:de.role,password:"",confirmPassword:""}),h(!0)},pe=async()=>{Z(!0);try{const de=await Iw();H(de),de.length>0&&te(de[0].id),K(null)}catch(de){K("Failed to fetch subscription plans."),console.error(de)}finally{Z(!1)}},be=de=>{L(de),z(!0),pe()},fe=async de=>{if(de.preventDefault(),!V||!ee){l("Please select a clinic and a plan.");return}try{await ge("/clinic-subscriptions/manual-activate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicId:V,planId:ee})}),z(!1),L(null),te(""),oe(),l(null)}catch(Me){l("Failed to manually activate clinic subscription."),console.error(Me)}},Pe=async de=>{if(window.confirm("Are you sure you want to cancel this clinic's subscription? This action cannot be undone."))try{await KO(de),oe(),l(null)}catch(Me){l("Failed to cancel subscription."),console.error(Me)}};return r?i.jsx("div",{children:"Loading users..."}):s?i.jsx("div",{className:"error-message",children:s}):i.jsxs("div",{className:"user-management-page",children:[i.jsxs("div",{className:"user-management-header",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(Ut,{size:16}),"Back"]}),i.jsx("h1",{children:"User Management"})]}),i.jsxs("div",{className:"controls-container",children:[i.jsx("input",{type:"text",placeholder:"Search by name or email...",value:T,onChange:de=>I(de.target.value),className:"search-input"}),i.jsx("button",{onClick:()=>d(!0),className:"add-user-button",children:"Add New User"})]}),f&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>d(!1),children:""}),i.jsx("h2",{children:"Add New User"}),i.jsxs("form",{onSubmit:A,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:v.name,onChange:de=>S({...v,name:de.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:v.email,onChange:de=>S({...v,email:de.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Password:"}),i.jsx("input",{type:"password",value:v.password,onChange:de=>S({...v,password:de.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:v.role,onChange:de=>S({...v,role:de.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsx("button",{type:"submit",children:"Add User"})]})]})}),u&&g&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>h(!1),children:""}),i.jsx("h2",{children:"Edit User"}),i.jsxs("form",{onSubmit:se,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:k.name,onChange:de=>E({...k,name:de.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:k.email,onChange:de=>E({...k,email:de.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:k.role,onChange:de=>E({...k,role:de.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"New Password (optional):"}),i.jsx("input",{type:"password",value:k.password,onChange:de=>E({...k,password:de.target.value})})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Confirm New Password:"}),i.jsx("input",{type:"password",value:k.confirmPassword,onChange:de=>E({...k,confirmPassword:de.target.value})})]}),i.jsx("button",{type:"submit",children:"Update User"})]})]})}),U&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>z(!1),children:""}),i.jsx("h2",{children:"Select Subscription Plan for Clinic"}),ae&&i.jsx("div",{children:"Loading plans..."}),B&&i.jsx("div",{className:"error-message",children:B}),!ae&&!B&&$.length===0&&i.jsx("div",{children:"No active subscription plans available."}),!ae&&!B&&$.length>0&&i.jsxs("form",{onSubmit:fe,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Select Plan:"}),i.jsx("select",{value:ee,onChange:de=>te(de.target.value),required:!0,children:$.map(de=>i.jsxs("option",{value:de.id,children:[de.name," - $",de.price,"/",de.interval," ",de.period]},de.id))})]}),i.jsx("button",{type:"submit",children:"Activate Selected Plan"})]})]})}),i.jsxs("table",{className:"user-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Role"}),i.jsx("th",{children:"Clinic ID"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:n.map(de=>{const Me=de.clinic_id||"N/A",Ze=Me!=="N/A"?R[Me]:null,Fe=(Ze==null?void 0:Ze.hasProPlan)??!1,Ce=Fe?"PRO":"Standard";return i.jsxs("tr",{children:[i.jsx("td",{children:de.name}),i.jsx("td",{children:de.email}),i.jsx("td",{children:de.role}),i.jsx("td",{children:Me}),i.jsx("td",{children:Me!=="N/A"?i.jsx("span",{className:Fe?"pro-badge":"standard-badge",children:Ce}):"N/A"}),i.jsxs("td",{children:[i.jsx("button",{onClick:()=>M(de),className:"edit-button",children:"Edit"}),i.jsx("button",{onClick:()=>ue(de.id),className:"delete-button",children:"Delete"}),de.clinic_id&&!Fe&&i.jsx("button",{onClick:()=>be(de.clinic_id),className:"start-subscription-button",children:"Start Subscription"}),de.clinic_id&&Fe&&i.jsx("button",{onClick:()=>Pe(de.clinic_id),className:"cancel-subscription-button",children:"Cancel Subscription"})]})]},de.id)})})]})]})},Dre=()=>i.jsxs("div",{className:"admin-panel-container",children:[i.jsxs("h1",{className:"admin-panel-title",children:[i.jsx(yg,{size:32,className:"icon-margin"}),"Super Admin Dashboard"]}),i.jsxs("div",{className:"admin-panel-grid",children:[i.jsxs(cs,{to:"/dashboard/clinic-subscriptions",className:"admin-panel-card",children:[i.jsx(Ad,{size:48,className:"card-icon"}),i.jsx("h2",{children:"Manage Clinic Subscription Plans"}),i.jsx("p",{children:"Add, edit, and view clinic subscription plans."})]}),i.jsxs(cs,{to:"/dashboard/users",className:"admin-panel-card",children:[i.jsx(ig,{size:48,className:"card-icon"}),i.jsx("h2",{children:"User Management"}),i.jsx("p",{children:"Add, edit, and delete users; manage user roles."})]})]})]}),Gm="tutorialCurrentStep",YA=({onActionComplete:e,onStaffAdded:n,requiredRole:t})=>{const[r,a]=w.useState(""),[s,l]=w.useState(""),[f,d]=w.useState(""),[u,h]=w.useState(!1),g=t||"receptionist";w.useEffect(()=>{a(t==="lab"?"Lab":t==="pharmacy"?"Pharmacy":"")},[t]);const b=async()=>{if(!r||!s||!f){e(!1,"Please fill all fields.");return}h(!0);try{const v=await ge("/api/staff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,email:s,role:g,password:f})});if(v.ok)e(!0,`Successfully added "${r}" as a ${g}!`),a(""),l(""),d(""),n&&n(g);else{const S=await v.json();e(!1,`Failed to add staff: ${S.message||v.statusText}`)}}catch(v){console.error("Error adding staff:",v),e(!1,`Error adding staff: ${v instanceof Error?v.message:String(v)}`)}finally{h(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("h3",{children:"Add a New Staff Member"}),i.jsx("input",{type:"text",placeholder:"Staff Name",value:r,onChange:v=>a(v.target.value),className:"tutorial-input",disabled:u}),i.jsx("input",{type:"email",placeholder:"Email",value:s,onChange:v=>l(v.target.value),className:"tutorial-input",disabled:u}),i.jsx("input",{type:"password",placeholder:"Password",value:f,onChange:v=>d(v.target.value),className:"tutorial-input",disabled:u}),i.jsx("input",{type:"text",placeholder:"Role",value:g==="lab"?"Lab Technician":g==="pharmacy"?"Pharmacist":"Receptionist",className:"tutorial-input",disabled:!0}),i.jsx("button",{onClick:b,className:"tutorial-button primary",disabled:u,children:u?"Adding...":"Add Staff"})]})},Ire=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState([]),[s,l]=w.useState(!1),f=async()=>{t(!0);try{const d=await ge("/api/drugs/import-defaults",{method:"POST"});if(d.ok){const u=await d.json(),h=u.drugs?u.drugs.map(g=>g.name):[];a(h),l(!0),e(!0,`Default medications imported: Added ${u.details.added}, Updated ${u.details.updated}.`,"pharmacyImport")}else{const u=await d.json();e(!1,`Failed to import default medications: ${u.message||d.statusText}`)}}catch(d){console.error("Error importing default medications:",d),e(!1,`Error importing default medications: ${d instanceof Error?d.message:String(d)}`)}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("h3",{children:"Import Default Medications"}),i.jsx("p",{children:"Click the button below to populate your pharmacy inventory with a list of common medications."}),i.jsx("button",{onClick:f,className:"tutorial-button primary",disabled:n,children:n?"Importing...":i.jsxs(i.Fragment,{children:[" ",i.jsx("i",{className:"fas fa-pills"})," Import Default Drugs"]})}),s&&r.length>0&&i.jsxs("div",{className:"imported-drugs-list",children:[i.jsx("h4",{children:"Medications Imported:"}),i.jsx("ul",{children:r.map((d,u)=>i.jsx("li",{children:d},u))})]})]})},Mre=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState([]),[s,l]=w.useState(!1),f=async()=>{t(!0);try{const d=await ge("/api/lab-tests/import-defaults",{method:"POST"});if(d.ok){const u=await d.json(),h=u.tests?u.tests.map(g=>g.name):[];a(h),l(!0),e(!0,`Default lab tests imported: Added ${u.details.added}, Updated ${u.details.updated}.`,"labImport")}else{const u=await d.json();e(!1,`Failed to import default lab tests: ${u.message||d.statusText}`)}}catch(d){console.error("Error importing default lab tests:",d),e(!1,`Error importing default lab tests: ${d instanceof Error?d.message:String(d)}`)}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("h3",{children:"Import Default Lab Tests"}),i.jsx("p",{children:"Click the button below to populate your lab test inventory with a list of common tests."}),i.jsx("button",{onClick:f,className:"tutorial-button primary",disabled:n,children:n?"Importing...":i.jsxs(i.Fragment,{children:[" ",i.jsx("i",{className:"fas fa-flask"})," Import Default Lab Tests"]})}),s&&r.length>0&&i.jsxs("div",{className:"imported-drugs-list",children:[i.jsx("h4",{children:"Tests Imported:"}),i.jsx("ul",{children:r.map((d,u)=>i.jsx("li",{children:d},u))})]})]})},Ym=[{title:"Welcome to Your Admin Dashboard!",description:"This quick tour will guide you through essential features to get your clinic set up.",actionText:"Let's Start!",actionPath:null,component:null},{title:"Step 1: Manage Pharmacy Inventory",description:"Set up your pharmacy by adding drugs, managing stock levels, and importing default drug lists. This ensures smooth prescription fulfillment. Import default medications now!",actionText:"Go to Pharmacy Inventory",actionPath:"/dashboard/inventory",component:Ire},{title:"Step 2: Manage Lab Test Inventory",description:"Configure your laboratory by adding available lab tests and importing default test lists. This is crucial for accurate diagnostics. Import default lab tests now!",actionText:"Go to Lab Test Inventory",actionPath:"/lab-inventory",component:Mre},{title:"Step 3: Add Staff Members (Optional)",description:"You can add your clinic's staff, including doctors, receptionists, lab technicians, and pharmacists. Each role has specific permissions. You can skip this step for now.",actionText:"Go to Staff Management",actionPath:null,component:YA},{title:"You're All Set!",description:"You've completed the basic setup tour. Now, try out the AI-powered complaint analysis feature!",actionText:"Try the AI!",actionPath:"/edit-complaints",component:null}],Rre=({onClose:e,onMarkAsSeen:n})=>{const[t,r]=w.useState(()=>{const R=localStorage.getItem(Gm);return R?parseInt(R,10):0}),[a,s]=w.useState(null),[l,f]=w.useState(null),[d,u]=w.useState(!1),[h,g]=w.useState(null),[b,v]=w.useState(4),S=wt();w.useEffect(()=>{if(localStorage.setItem(Gm,t.toString()),s(null),f(null),t===0){v(4);const R=setTimeout(()=>{r(U=>U+1)},4e3),F=setInterval(()=>{v(U=>U-1)},1e3);return()=>{clearTimeout(R),clearInterval(F)}}},[t]);const k=(R,F,U)=>{f(R),s(F),R&&(U==="pharmacyImport"||U==="labImport")&&r(z=>z+1)},E=()=>{},T=()=>{n(),e(),localStorage.removeItem(Gm)},I=async()=>{const R=Ym[t];if(q&&R.actionPath==="/edit-complaints"){u(!0),g(null);try{const F=await ge("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"New Patient - AI Entry",age:null,gender:null,phone:null,address:null})});if(!F.ok){const H=await F.text();throw new Error(`Failed to create patient: ${H||F.statusText} (${F.status})`)}const U=await F.json();if(!U||!U.id)throw new Error("Failed to create new patient or retrieve patient ID.");const z=U.id,V=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:z,complaint:""})});if(!V.ok){const H=await V.text();throw new Error(`Failed to create queue entry: ${H||V.statusText} (${V.status})`)}const L=await V.json();if(!L||!L.id)throw new Error("Failed to create new complaint record or retrieve record ID.");const $=L.id;S(`/dashboard/edit-complaint/${$}`),e(),n(),localStorage.removeItem(Gm)}catch(F){console.error("Error starting new AI complaint:",F);const U=`Error: ${F.message||"Failed to start new AI complaint process."}`;g(U)}finally{u(!1)}}else R.actionPath&&(S(R.actionPath),e(),t===Ym.length-1&&(n(),localStorage.removeItem(Gm)))},D=Ym[t],q=t===Ym.length-1;return i.jsx("div",{className:"tutorial-modal-overlay",children:i.jsxs("div",{className:"tutorial-modal-content",children:[i.jsx("h2",{children:D.title}),i.jsx("p",{children:D.description}),D.component&&i.jsxs("div",{className:"tutorial-interactive-area",children:[t===3?i.jsx(YA,{onActionComplete:k,onStaffAdded:E,requiredRole:null}):i.jsx(D.component,{onActionComplete:k}),a&&i.jsx("p",{className:`tutorial-message ${l?"success":"error"}`,children:a})]}),h&&i.jsx("p",{className:"tutorial-message error",children:h})," ",i.jsxs("div",{className:"tutorial-modal-actions",children:[D.actionPath&&i.jsx("button",{onClick:I,className:"tutorial-button action",disabled:d,children:d?"Creating AI Patient...":D.actionText}),t===3&&i.jsx("button",{onClick:()=>r(t+1),className:"tutorial-button secondary",children:"Next Step"}),i.jsx("button",{onClick:T,className:"tutorial-button secondary",disabled:d,children:"Skip Tutorial"})]}),t===0&&i.jsxs("div",{className:"tutorial-countdown-indicator",children:["Next step in ",b," seconds..."]}),i.jsxs("div",{className:"tutorial-step-indicator",children:["Step ",t+1," of ",Ym.length]})]})})},Ore=(e,n,t)=>{const r=Math.abs(e.getTime()-n.getTime());return Math.ceil(r/(1e3*60*60*24))<=t},Q_=e=>{if(e.match(/^\d{4}-\d{2}-\d{2}$/))return new Date(e);const n=e.split("/");if(n.length===3){const t=parseInt(n[0],10),r=parseInt(n[1],10)-1,a=parseInt(n[2],10),s=new Date(a,r,t),l=parseInt(n[0],10)-1,f=parseInt(n[1],10),d=parseInt(n[2],10),u=new Date(d,l,f),h=!isNaN(s.getTime()),g=!isNaN(u.getTime());if(h&&g)return s;if(h)return s;if(g)return u}return new Date(e)},WA=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,s]=w.useState(null),[l,f]=w.useState(""),[d,u]=w.useState(""),[h,g]=w.useState(1),[b]=w.useState(10),v=new Date,S=wt();w.useEffect(()=>{(async()=>{r(!0);try{const L=await ge("/api/pharmacy-orders/refill-reminders");if(L.ok){const $=await L.json();n($)}else s("Failed to fetch refill reminders.")}catch{s("An error occurred while fetching data.")}finally{r(!1)}})()},[]);const k=z=>{f(z.target.value),g(1)},E=z=>{u(z.target.value),g(1)},T=e.filter(z=>{const V=l?z.medicationRefillDates.some($=>{const H=Q_($.refillDate);return!isNaN(H.getTime())&&H.toISOString().split("T")[0]===l}):!0,L=d?z.patientName.toLowerCase().includes(d.toLowerCase())||z.patientPhoneNumber.includes(d)||z.items.some($=>$.name.toLowerCase().includes(d.toLowerCase())):!0;return V&&L}),I=h*b,D=I-b,q=T.slice(D,I),R=Math.ceil(T.length/b),F=z=>g(z),U=async z=>{try{const V=await ge(`/api/queue/patient/${z}/latest`);if(V.ok){const $=await V.json();if($!=null&&$._id){S(`/dashboard/edit-complaint/${$._id}`,{state:{patientId:z}});return}}const L=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:z})});if(L.ok){const $=await L.json();$!=null&&$.id&&S(`/dashboard/edit-complaint/${$.id}`,{state:{patientId:z}})}}catch(V){console.error("Error handling row click:",V),s("Failed to navigate to patient complaint.")}};return t?i.jsx("div",{children:"Loading..."}):a?i.jsx("div",{children:a}):i.jsxs("div",{className:"refill-reminders-container",children:[i.jsx("h1",{children:"Refill Reminders"}),i.jsxs("div",{className:"controls-container",children:[i.jsxs("div",{className:"filter-container",children:[i.jsx("label",{htmlFor:"refillDate",children:"Filter by Refill Date: "}),i.jsx("input",{type:"date",id:"refillDate",value:l,onChange:k})]}),i.jsxs("div",{className:"search-container",children:[i.jsx("label",{htmlFor:"search",children:"Search: "}),i.jsx("input",{type:"text",id:"search",placeholder:"Search by patient name, phone, or medication",value:d,onChange:E})]})]}),i.jsxs("table",{children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient Name"}),i.jsx("th",{children:"Patient Phone Number"}),i.jsx("th",{children:"Medications"}),i.jsx("th",{children:"Refill Dates"})]})}),i.jsx("tbody",{children:q.length>0?q.map(z=>i.jsxs("tr",{onClick:()=>U(z.patientId),style:{cursor:"pointer"},children:[i.jsx("td",{children:z.patientName}),i.jsx("td",{children:z.patientPhoneNumber}),i.jsxs("td",{children:[i.jsx("ul",{children:z.items.map((V,L)=>i.jsxs("li",{children:[V.name," (Qty: ",V.quantity,")",V.tabletsPerDay&&i.jsxs("span",{children:[" - ",V.tabletsPerDay," / day"]}),V.numberOfDays&&i.jsxs("span",{children:[" for ",V.numberOfDays," days"]})]},L))}),i.jsxs("div",{children:["Last Updated: ",new Date(z.updatedAt).toLocaleDateString()]}),z.prescription_for_unavailable_drugs&&i.jsxs("div",{className:"unavailable-prescription",children:[i.jsx("strong",{children:"Unavailable:"})," ",z.prescription_for_unavailable_drugs]})]}),i.jsx("td",{children:i.jsx("ul",{children:z.medicationRefillDates.map((V,L)=>{const $=Q_(V.refillDate),H=!isNaN($.getTime())&&Ore($,v,2);return i.jsxs("li",{className:H?"highlight-refill-date":"",children:[V.name,": ",isNaN($.getTime())?"Invalid Date":$.toLocaleDateString()]},L)})})})]},z.id)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:"No refill reminders found."})})})]}),i.jsxs("div",{className:"pagination-container",children:[i.jsx("button",{onClick:()=>F(h-1),disabled:h===1,children:"Previous"}),Array.from({length:R},(z,V)=>i.jsx("button",{onClick:()=>F(V+1),className:h===V+1?"active":"",children:V+1},V+1)),i.jsx("button",{onClick:()=>F(h+1),disabled:h===R,children:"Next"})]})]})},Lre=()=>{const e=wt(),n=ni();return w.useEffect(()=>{const t=new URLSearchParams(n.search),r=t.get("token"),a=t.get("caseDetails");r?(async()=>{try{const l=await ge(`/api/patients?search=${r}&limit=1`);if(!l.ok)throw new Error("Failed to fetch patient by token");const d=(await l.json()).patients[0];if(!d)throw new Error("Patient with the given token not found");const u=await ge(`/api/queue/patient/${d.id}/latest`);if(u.ok){const b=await u.json();if(b!=null&&b._id){e(`/dashboard/edit-complaint/${b._id}`,{state:{initialComplaint:a,patientId:d.id}});return}}const h=await ge("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:d.id,complaint:a})});if(!h.ok)throw new Error("Failed to create queue entry");const g=await h.json();if(g!=null&&g.id)e(`/dashboard/edit-complaint/${g.id}`,{state:{initialComplaint:a,patientId:d.id}});else throw new Error("Failed to get ID from new queue entry.")}catch(l){console.error("Error handling complaint URL:",l),e("/dashboard/search-patient")}})():e("/dashboard/search-patient")},[n,e]),i.jsx("div",{children:"Loading..."})},Fre=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,s]=w.useState(null),l=w.useCallback(async()=>{r(!0),s(null);try{const u=await ge("/api/notifications?all=true");if(u.ok){const g=(await u.json()).sort((b,v)=>{const S={expired_drug:1,near_expiry_drug:2,low_stock:3},k=S[b.type]||99,E=S[v.type]||99;return k!==E?k-E:new Date(v.created_at).getTime()-new Date(b.created_at).getTime()});n(g)}else s("Failed to fetch notifications."),console.error("Failed to fetch notifications:",u.statusText)}catch(u){s("Error fetching notifications."),console.error("Error fetching notifications:",u)}finally{r(!1)}},[]);w.useEffect(()=>{l()},[l]);const f=async u=>{try{const h=await ge(`/api/notifications/${u}/read`,{method:"PUT"});h.ok?n(g=>g.map(b=>b.id===u?{...b,is_read:!0}:b)):console.error("Failed to mark notification as read:",h.statusText)}catch(h){console.error("Error marking notification as read:",h)}},d=async()=>{try{const u=e.filter(g=>!g.is_read).map(g=>g.id);if(u.length===0)return;const h=await ge("/api/notifications/mark-all-read",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationIds:u})});h.ok?n(g=>g.map(b=>({...b,is_read:!0}))):console.error("Failed to mark all notifications as read:",h.statusText)}catch(u){console.error("Error marking all notifications as read:",u)}};return t?i.jsx("div",{className:"notifications-page-container",children:"Loading notifications..."}):a?i.jsx("div",{className:"notifications-page-container error-message",children:a}):i.jsxs("div",{className:"notifications-page-container",children:[i.jsx("h2",{className:"notifications-page-title",children:"All Notifications"}),i.jsx("div",{className:"notifications-actions",children:i.jsx("button",{onClick:d,disabled:e.every(u=>u.is_read),className:"mark-all-read-button",children:"Mark All As Read"})}),e.length===0?i.jsx("p",{className:"no-notifications-message",children:"No notifications to display."}):i.jsx("ul",{className:"notifications-list",children:e.map(u=>i.jsxs("li",{className:`notification-item ${u.is_read?"read":"unread"}`,children:[i.jsxs("div",{className:"notification-content",children:[i.jsxs("span",{className:"notification-type",children:[u.type.replace(/_/g," "),": "]}),u.message]}),i.jsxs("div",{className:"notification-meta",children:[i.jsx("span",{className:"notification-timestamp",children:new Date(u.created_at).toLocaleString()}),!u.is_read&&i.jsx("button",{onClick:()=>f(u.id),className:"mark-read-button",children:"Mark as Read"})]})]},u.id))})]})},J_=()=>{const e=wt(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[s,l]=w.useState(null),[f,d]=w.useState(!1),[u,h]=w.useState(!1),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,E]=w.useState(!1),[T,I]=w.useState(null),[D,q]=w.useState([]),[R,F]=w.useState(null),[U,z]=w.useState(""),[V,L]=w.useState(""),[$,H]=w.useState(""),[ee,te]=w.useState(""),[ae,Z]=w.useState(""),[B,K]=w.useState(""),[oe,A]=w.useState(""),[se,ue]=w.useState(""),[M,pe]=w.useState(""),[be,fe]=w.useState(""),[Pe,de]=w.useState(""),Me=w.useCallback(async()=>{a(!0),l(null);try{const J=await ge("/api/distributors");if(!J.ok)throw new Error(`Failed to fetch distributors: ${J.statusText}`);const Y=await J.json();t(Y)}catch(J){console.error("Failed to fetch distributors:",J),l(J.message||"Failed to load distributors.")}finally{a(!1)}},[]);w.useEffect(()=>{Me()},[Me]);const Ze=async J=>{J.preventDefault(),l(null);try{const Y=await ge("/api/distributors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:U,contact_person:V,phone:$,email:ee,address:ae,gst_number:B,drug_license_number:oe})});if(!Y.ok){const X=await Y.json();throw new Error(X.message||"Failed to add distributor.")}alert("Distributor added successfully!"),Ge(),Me()}catch(Y){console.error("Error adding distributor:",Y),l(Y.message||"Failed to add distributor.")}},Fe=async J=>{if(J.preventDefault(),l(null),!!T)try{const Y=await ge(`/api/distributors/${T.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:U,contact_person:V,phone:$,email:ee,address:ae,gst_number:B,drug_license_number:oe})});if(!Y.ok){const X=await Y.json();throw new Error(X.message||"Failed to update distributor.")}alert("Distributor updated successfully!"),nt(),Me()}catch(Y){console.error("Error updating distributor:",Y),l(Y.message||"Failed to update distributor.")}},Ce=async()=>{if(l(null),!!T)try{const J=await ge(`/api/distributors/${T.id}`,{method:"DELETE"});if(!J.ok){const Y=await J.json();throw new Error(Y.message||"Failed to delete distributor.")}alert("Distributor deleted successfully!"),xt(),Me()}catch(J){console.error("Error deleting distributor:",J),l(J.message||"Failed to delete distributor.")}},Re=w.useCallback(async J=>{l(null);try{const Y=await ge(`/api/distributors/${J}/payments`);if(!Y.ok)throw new Error(`Failed to fetch payments: ${Y.statusText}`);const Ne=(await Y.json()).map(it=>({...it,order_value:parseFloat(it.order_value),amount_paid:parseFloat(it.amount_paid),balance_remaining:parseFloat(it.balance_remaining)}));q(Ne);const ke=await ge(`/api/distributors/${J}/balance`);if(!ke.ok)throw new Error(`Failed to fetch balance: ${ke.statusText}`);const Ue=await ke.json();F({totalOrderValue:parseFloat(Ue.totalOrderValue),totalAmountPaid:parseFloat(Ue.totalAmountPaid),remainingBalance:parseFloat(Ue.remainingBalance)})}catch(Y){console.error("Error fetching payments/balance:",Y),l(Y.message||"Failed to load payments or balance.")}},[]),xe=async J=>{if(J.preventDefault(),l(null),!!T)try{const Y=await ge(`/api/distributors/${T.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:se,order_value:parseFloat(M||"0"),amount_paid:parseFloat(be||"0"),notes:Pe})});if(!Y.ok){const X=await Y.json();throw new Error(X.message||"Failed to add payment.")}alert("Payment added successfully!"),Be(),Re(T.id)}catch(Y){console.error("Error adding payment:",Y),l(Y.message||"Failed to add payment.")}},Ie=()=>{z(""),L(""),H(""),te(""),Z(""),K(""),A(""),l(null),d(!0)},Ge=()=>{d(!1)},ze=J=>{I(J),z(J.name),L(J.contact_person||""),H(J.phone||""),te(J.email||""),Z(J.address||""),K(J.gst_number||""),A(J.drug_license_number||""),l(null),h(!0)},nt=()=>{h(!1),I(null)},jt=J=>{I(J),l(null),b(!0)},xt=()=>{b(!1),I(null)},ve=J=>{I(J),Re(J.id),l(null),S(!0)},qe=()=>{S(!1),I(null),q([]),F(null)},Qe=J=>{I(J),ue(new Date().toISOString().split("T")[0]),pe("0"),fe("0"),de(""),l(null),E(!0)},Be=()=>{E(!1),I(null)};return r?i.jsx("div",{className:"loading-indicator",children:"Loading Distributors..."}):s?i.jsxs("div",{className:"error-indicator",children:["Error: ",s]}):i.jsxs("div",{className:"distributor-management-page",children:[i.jsxs("div",{className:"distributor-management-header",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[i.jsx(Ut,{size:24})," Back"]}),i.jsx("h2",{children:"Distributor Management"})]}),(()=>{const J=n.reduce((X,Ne)=>X+parseFloat(Ne.remainingBalance||"0"),0),Y=J>=0?"balance-positive":"balance-negative";return i.jsxs("div",{className:`total-balance-display ${Y}`,children:[i.jsx("strong",{children:"Total Combined Balance:"})," ",J.toFixed(2)]})})(),i.jsxs("button",{onClick:Ie,className:"add-distributor-button",children:[i.jsx(ls,{size:18}),"Add New Distributor"]})]}),i.jsx("div",{className:"distributor-table-container",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Contact Person"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Address"}),i.jsx("th",{children:"GST Number"})," ",i.jsx("th",{children:"Drug License Number"})," ",i.jsx("th",{children:"Remaining Balance"})," ",i.jsx("th",{className:"actions-cell",children:"Actions"})]})}),i.jsx("tbody",{children:n.length===0?i.jsxs("tr",{children:[i.jsx("td",{colSpan:9,className:"no-results-message",children:"No distributors found."})," "]}):n.map(J=>i.jsxs("tr",{children:[i.jsx("td",{children:J.name}),i.jsx("td",{children:J.contact_person||"-"}),i.jsx("td",{children:J.phone||"-"}),i.jsx("td",{children:J.email||"-"}),i.jsx("td",{children:J.address||"-"}),i.jsx("td",{children:J.gst_number||"-"})," ",i.jsx("td",{children:J.drug_license_number||"-"})," ",i.jsxs("td",{className:parseFloat(J.remainingBalance||"0")>0?"balance-positive":"balance-negative",children:["",J.remainingBalance||"0.00"]})," ",i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsxs("button",{onClick:()=>ve(J),className:"action-text-button view-button",title:"View Payments & Balance",children:[i.jsx(y1,{size:16})," View Payments"]}),i.jsxs("button",{onClick:()=>Qe(J),className:"action-text-button add-payment-button",title:"Add Payment",children:[i.jsx(ls,{size:16})," Add Payment"]}),i.jsx("button",{onClick:()=>ze(J),className:"action-icon-button edit-button",title:"Edit Distributor",children:i.jsx(Od,{size:16})}),i.jsx("button",{onClick:()=>jt(J),className:"action-icon-button delete-button",title:"Delete Distributor",children:i.jsx(ti,{size:16})})]})})]},J.id))})]})}),f&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Ge,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Add New Distributor"}),s&&i.jsx("div",{className:"modal-error-message",children:s}),i.jsxs("form",{onSubmit:Ze,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Name:"}),i.jsx("input",{type:"text",id:"name",value:U,onChange:J=>z(J.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"contact_person",value:V,onChange:J=>L(J.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"phone",value:$,onChange:J=>H(J.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email:"}),i.jsx("input",{type:"email",id:"email",value:ee,onChange:J=>te(J.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"address",children:"Address:"}),i.jsx("textarea",{id:"address",value:ae,onChange:J=>Z(J.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"gst_number",value:B,onChange:J=>K(J.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"drug_license_number",value:oe,onChange:J=>A(J.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Ge,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Distributor"})]})]})]})}),u&&T&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:nt,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Edit Distributor"}),s&&i.jsx("div",{className:"modal-error-message",children:s}),i.jsxs("form",{onSubmit:Fe,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-name",children:"Name:"}),i.jsx("input",{type:"text",id:"edit-name",value:U,onChange:J=>z(J.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"edit-contact_person",value:V,onChange:J=>L(J.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"edit-phone",value:$,onChange:J=>H(J.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-email",children:"Email:"}),i.jsx("input",{type:"email",id:"edit-email",value:ee,onChange:J=>te(J.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-address",children:"Address:"}),i.jsx("textarea",{id:"edit-address",value:ae,onChange:J=>Z(J.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"edit-gst_number",value:B,onChange:J=>K(J.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"edit-drug_license_number",value:oe,onChange:J=>A(J.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:nt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Save Changes"})]})]})]})}),g&&T&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:xt,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Confirm Delete"}),i.jsxs("p",{children:['Are you sure you want to delete distributor "',T.name,'"?']}),s&&i.jsx("div",{className:"modal-error-message",children:s}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:xt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Ce,className:"button-delete",children:"Delete"})]})]})}),v&&T&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content large-modal",children:[i.jsx("button",{onClick:qe,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Payments & Balance for ",T.name]}),s&&i.jsx("div",{className:"modal-error-message",children:s}),R&&i.jsxs("div",{className:"balance-summary",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Total Order Value:"})," ",R.totalOrderValue.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Total Amount Paid:"})," ",R.totalAmountPaid.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Remaining Balance:"})," ",R.remainingBalance.toFixed(2)]})]}),i.jsx("h4",{children:"Payment History"}),D.length===0?i.jsx("p",{children:"No payments recorded for this distributor."}):i.jsx("div",{className:"table-responsive",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Order Value"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Balance Remaining"}),i.jsx("th",{children:"Notes"})]})}),i.jsx("tbody",{children:D.map(J=>i.jsxs("tr",{children:[i.jsx("td",{children:new Date(J.payment_date).toLocaleDateString()}),i.jsxs("td",{children:["",J.order_value.toFixed(2)]}),i.jsxs("td",{children:["",J.amount_paid.toFixed(2)]}),i.jsxs("td",{children:["",J.balance_remaining.toFixed(2)]}),i.jsx("td",{children:J.notes||"-"})]},J.id))})]})}),i.jsx("div",{className:"modal-actions",children:i.jsx("button",{type:"button",onClick:qe,className:"button-cancel",children:"Close"})})]})}),k&&T&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Be,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Add Payment for ",T.name]}),s&&i.jsx("div",{className:"modal-error-message",children:s}),i.jsxs("form",{onSubmit:xe,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_date",children:"Payment Date:"}),i.jsx("input",{type:"date",id:"payment_date",value:se,onChange:J=>ue(J.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"order_value",children:"Order Value:"}),i.jsx("input",{type:"number",id:"order_value",value:M,onChange:J=>pe(J.target.value),step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"amount_paid",children:"Amount Paid:"}),i.jsx("input",{type:"number",id:"amount_paid",value:be,onChange:J=>fe(J.target.value),step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_notes",children:"Notes:"}),i.jsx("textarea",{id:"payment_notes",value:Pe,onChange:J=>de(J.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Be,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Payment"})]})]})]})})]})},$re=({isOpen:e,onClose:n,excelHeaders:t,onConfirm:r,availableFields:a})=>{const[s,l]=w.useState({});if(w.useEffect(()=>{e&&d()},[e,t,a]),!e)return null;const f=(h,g)=>{l(b=>({...b,[h]:g}))},d=()=>{const h={};t.forEach(g=>{const b=a.map(S=>({name:S})),v=Jm(g,b);v&&(h[g]=v.name)}),l(h)},u=()=>{const h={};for(const g in s)s[g]&&s[g]!=="none"&&(h[g]=s[g]);r(h),n()};return i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:n,className:"modal-close-button",children:i.jsx(Jn,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Match File Columns"}),i.jsx("p",{className:"modal-description",children:'Please match the columns from your uploaded file to the corresponding fields in the drug inventory. You can use the "Auto Match" button for suggestions.'}),i.jsx("div",{className:"modal-actions-top",children:i.jsx("button",{type:"button",onClick:d,className:"button-auto-match",children:"Auto Match"})}),i.jsxs("div",{className:"column-mapping-grid",children:[i.jsx("div",{className:"grid-header",children:"Excel Column"}),i.jsx("div",{className:"grid-header",children:"App Field"}),t.map((h,g)=>i.jsxs(Tn.Fragment,{children:[i.jsx("div",{className:"excel-header-cell",children:h}),i.jsx("div",{className:"app-field-cell",children:i.jsxs("select",{value:s[h]||"",onChange:b=>f(h,b.target.value),className:"app-field-select",children:[i.jsx("option",{value:"",children:"-- Select Field --"}),i.jsx("option",{value:"none",children:"None (Ignore Column)"}),a.map((b,v)=>i.jsxs("option",{value:b,children:[b==="name"?"Composition Name":b==="brand_name"?"Brand Name":b==="price"?"MRP":b==="buying_price"?"Rate":b==="unit"?"Pack":b==="batch"?"Batch":b==="hsn_code"?"HSN Code":b==="mfg"?"MFG":b==="loose_quantity"?"Loose":b.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase())," "]},v))]})})]},g))]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:n,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:u,className:"button-submit",children:"Confirm Mapping"})]})]})})},zre=({isOpen:e,onClose:n,onDrugAddedToPurchase:t})=>{const[r,a]=w.useState({name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",expiry_date:"",buying_price:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),[s,l]=w.useState(null),[f,d]=w.useState(!1),[u,h]=w.useState(!1),g=w.useRef(null),b=w.useRef(null),v=w.useRef(null);w.useEffect(()=>{e&&(a({name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",expiry_date:"",buying_price:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),l(null),d(!1),h(!1))},[e]),w.useEffect(()=>{const E=I=>{I.key==="Tab"&&b.current===document.activeElement&&(u||(h(!0),setTimeout(()=>{var D;(D=v.current)==null||D.focus()},0),I.preventDefault()))},T=I=>{g.current&&!g.current.contains(I.target)&&h(!1)};return document.addEventListener("keydown",E),document.addEventListener("mousedown",T),()=>{document.removeEventListener("keydown",E),document.removeEventListener("mousedown",T)}},[u]);const S=E=>{const{name:T,value:I,type:D}=E.target;a(q=>({...q,[T]:D==="number"?parseFloat(I)||null:I}))},k=E=>{if(E.preventDefault(),l(null),d(!0),r.price===void 0||r.quantity_in_stock===void 0){l("MRP and Stock Quantity are required."),d(!1);return}const T={...r,name:r.name===""?null:r.name,composition:r.composition===""?null:r.composition,buying_price:r.buying_price===0?null:r.buying_price,expiry_date:r.expiry_date===""?null:r.expiry_date,gst:r.gst===0?null:r.gst,margin:r.margin===0?null:r.margin,discount:r.discount===0?null:r.discount,brand_name:r.brand_name===""?null:r.brand_name,batch:r.batch===""?null:r.batch,hsn_code:r.hsn_code===""?null:r.hsn_code,mfg:r.mfg===""?null:r.mfg,loose:r.loose===0?null:r.loose};t(T),d(!1),n()};return e?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content add-drug-form-container max-w-2xl mx-auto",children:[i.jsxs("div",{className:"add-drug-form-header",children:[i.jsx("h2",{children:"Add New Drug"}),i.jsx("button",{onClick:n,className:"cancel-button",title:"Close",children:i.jsx(Jn,{size:24})})]}),s&&i.jsx("div",{className:"error-message",children:s}),i.jsxs("form",{onSubmit:k,className:"add-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"name",className:"form-label",children:"Composition Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx($o,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"name",value:r.name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Paracetamol",tabIndex:1})]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"brand_name",className:"form-label",children:"Brand Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx($o,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"brand_name",value:r.brand_name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"price",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx($o,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"price",id:"price",required:!0,step:"0.01",min:"0",value:r.price,onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"quantity_in_stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx($o,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"quantity_in_stock",id:"quantity_in_stock",required:!0,step:"1",min:"0",value:r.quantity_in_stock,onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"unit",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"unit",id:"unit",value:r.unit||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"expiry_date",value:r.expiry_date||"",onChange:S,className:"custom-text-input mt-1",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"box_number",value:r.box_number||"",onChange:S,className:"custom-text-input mt-1",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:g,children:[i.jsx("button",{type:"button",onClick:()=>h(!u),className:"form-button w-full text-left",tabIndex:8,ref:b,children:"Others"}),u&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"description",rows:3,value:r.description||"",onChange:S,className:"custom-text-input mt-1",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"buying_price",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"buying_price",id:"buying_price",step:"0.01",min:"0",value:r.buying_price??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:10,ref:v})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"gst",step:"0.01",min:"0",max:"100",value:r.gst??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:11})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"margin",step:"0.01",min:"0",max:"100",value:r.margin??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"discount",step:"0.01",min:"0",max:"100",value:r.discount??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"batch",value:r.batch||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"hsn_code",value:r.hsn_code||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"mfg",value:r.mfg||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"loose",className:"form-label",children:"Loose Quantity"}),i.jsx("input",{type:"number",name:"loose",id:"loose",step:"1",min:"0",value:r.loose??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:17})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:n,disabled:f,className:"form-button cancel-form-button",tabIndex:18,children:"Cancel"}),i.jsx("button",{type:"submit",disabled:f,className:"form-button submit-form-button inline-flex justify-center",tabIndex:19,children:f?"Adding...":"Add Drug"})]})]})]})}):null},Bre=({purchaseRows:e,onCellChange:n,onRemoveDrug:t,onAddEmptyRow:r})=>{const a=w.useRef(new Map),s=["name","price","quantity_in_stock","unit","expiry_date","buying_price","brand_name","box_number","gst","discount","batch","hsn_code","mfg","loose"],l=(f,d,u)=>{if(f.key==="Tab"){f.preventDefault();const h=s.indexOf(u);if(h!==-1){const g=(h+1)%s.length,b=s[g],v=a.current.get(`${d}-${b}`);v==null||v.focus()}}};return e.length===0?i.jsxs("div",{className:"no-drugs-message",children:[i.jsx("p",{children:"No drugs added to the purchase list yet."}),i.jsxs("button",{onClick:r,className:"action-button add-drug-to-table-button",children:[i.jsx(ls,{size:18,className:"button-icon"}),"Add the first drug"]})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"purchase-drugs-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Composition Name"}),i.jsx("th",{children:"MRP ()"}),i.jsx("th",{children:"Qty"}),i.jsx("th",{children:"Pack"}),i.jsx("th",{children:"Supplier"}),i.jsx("th",{children:"Expiry Date"}),i.jsx("th",{children:"Rate ()"}),i.jsx("th",{children:"Brand Name"}),i.jsx("th",{children:"Box Number"}),i.jsx("th",{children:"GST (%)"}),i.jsx("th",{children:"Discount (%)"}),i.jsx("th",{children:"Margin (%)"}),i.jsx("th",{children:"Batch"}),i.jsx("th",{children:"HSN Code"}),i.jsx("th",{children:"MFG"}),i.jsx("th",{children:"Loose"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map((f,d)=>i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("input",{type:"text",value:f.name||"",onChange:u=>n(u,f.id,"name"),onKeyDown:u=>l(u,f.id,"name"),className:"editable-cell-input",ref:u=>{f.id&&a.current.set(`${f.id}-name`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:f.price,onChange:u=>n(u,f.id,"price"),onKeyDown:u=>l(u,f.id,"price"),className:"editable-cell-input",ref:u=>{f.id&&a.current.set(`${f.id}-price`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:f.quantity_in_stock,onChange:u=>n(u,f.id,"quantity_in_stock"),onKeyDown:u=>l(u,f.id,"quantity_in_stock"),className:"editable-cell-input",ref:u=>{f.id&&a.current.set(`${f.id}-quantity_in_stock`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:f.unit||"",onChange:u=>n(u,f.id,"unit"),onKeyDown:u=>l(u,f.id,"unit"),className:"editable-cell-input",ref:u=>{f.id&&a.current.set(`${f.id}-unit`,u)}})}),i.jsx("td",{children:f.supplier||"N/A"}),i.jsx("td",{children:i.jsx("input",{type:"date",value:f.expiry_date||"",onChange:u=>n(u,f.id,"expiry_date"),onKeyDown:u=>l(u,f.id,"expiry_date"),className:"editable-cell-input",ref:u=>{f.id&&a.current.set(`${f.id}-expiry_date`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:f.buying_price||"",onChange:u=>n(u,f.id,"buying_price"),onKeyDown:u=>l(u,f.id,"buying_price"),className:"editable-cell-input",ref:u=>{f.id&&a.current.set(`${f.id}-buying_price`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:f.brand_name||"",onChange:u=>n(u,f.id,"brand_name"),onKeyDown:u=>l(u,f.id,"brand_name"),className:"editable-cell-input",ref:u=>{f.id&&a.current.set(`${f.id}-brand_name`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:f.box_number||"",onChange:u=>n(u,f.id,"box_number"),onKeyDown:u=>l(u,f.id,"box_number"),className:"editable-cell-input",ref:u=>{f.id&&a.current.set(`${f.id}-box_number`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:f.gst||"",onChange:u=>n(u,f.id,"gst"),onKeyDown:u=>l(u,f.id,"gst"),className:"editable-cell-input",ref:u=>{f.id&&a.current.set(`${f.id}-gst`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:f.discount||"",onChange:u=>n(u,f.id,"discount"),onKeyDown:u=>l(u,f.id,"discount"),className:"editable-cell-input",ref:u=>{f.id&&a.current.set(`${f.id}-discount`,u)}})}),i.jsx("td",{children:(()=>{const u=f.price||0,h=f.buying_price||0,g=f.gst!==null&&f.gst!==void 0?f.gst/100*h:0,b=f.discount!==null&&f.discount!==void 0?f.discount/100*u:0,v=u-(h+g)-b;return`${(u>0?v/u*100:0).toFixed(2)}%`})()}),i.jsx("td",{children:i.jsx("input",{type:"text",value:f.batch||"",onChange:u=>n(u,f.id,"batch"),onKeyDown:u=>l(u,f.id,"batch"),className:"editable-cell-input",ref:u=>{f.id&&a.current.set(`${f.id}-batch`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:f.hsn_code||"",onChange:u=>n(u,f.id,"hsn_code"),onKeyDown:u=>l(u,f.id,"hsn_code"),className:"editable-cell-input",ref:u=>{f.id&&a.current.set(`${f.id}-hsn_code`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"text",value:f.mfg||"",onChange:u=>n(u,f.id,"mfg"),onKeyDown:u=>l(u,f.id,"mfg"),className:"editable-cell-input",ref:u=>{f.id&&a.current.set(`${f.id}-mfg`,u)}})}),i.jsx("td",{children:i.jsx("input",{type:"number",value:f.loose||"",onChange:u=>n(u,f.id,"loose"),onKeyDown:u=>l(u,f.id,"loose"),className:"editable-cell-input",ref:u=>{f.id&&a.current.set(`${f.id}-loose`,u)}})}),i.jsx("td",{children:i.jsx("button",{onClick:()=>t(f.id),className:"text-red-600 hover:text-red-800 text-sm",children:"Remove"})})]},f.id||d))})]})})},K_=()=>{const e=wt(),[n,t]=w.useState(!1),r=w.useRef(null),a=w.useRef(null),[s,l]=w.useState(""),[f,d]=w.useState([]),[u,h]=w.useState(null),[g,b]=w.useState(!1),v=w.useRef(null),[S,k]=w.useState(!1),[E,T]=w.useState([]),[I,D]=w.useState(null),[q,R]=w.useState(null),[F,U]=w.useState(0),[z,V]=w.useState(!1),[L,$]=w.useState([]),H=["name","description","price","quantity_in_stock","unit","supplier","expiry_date","buying_price","box_number","gst","margin","discount","brand_name","batch","hsn_code","mfg","loose"],ee=()=>{const Ce={id:Date.now().toString()+Math.random().toString(36).substring(2,9),name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",supplier:u?u.name:"",expiry_date:"",buying_price:0,box_number:"",gst:0,margin:0,discount:0,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:0,last_updated:"",created_at:""};$(Re=>[...Re,Ce])},te=async(Fe,Ce)=>{if(!Fe){R("No file provided for import.");return}if(!u){R("Please select a distributor before importing.");return}t(!0),R(null);const Re=new FormData;Re.append("inventoryFile",Fe),Re.append("columnMapping",JSON.stringify(Ce));try{const xe=await ge("/api/drugs/parse-excel",{method:"POST",body:Re});if(!xe.ok){const Ge=await xe.json();throw new Error(Ge.message||`Failed to parse Excel file: ${xe.statusText}`)}const Ie=await xe.json();$(Ge=>[...Ge,...Ie.map(ze=>({...ze,id:Date.now().toString()+Math.random().toString(36).substring(2,9),supplier:u?u.name:ze.supplier}))]),alert(`Successfully parsed ${Ie.length} drugs from Excel. They have been added to the purchase list.`)}catch(xe){console.error("Failed to parse Excel file:",xe),R(xe.message||"Failed to parse Excel file. Please check the file format and try again."),alert(`Excel parsing failed: ${xe.message||"Please check the file format and try again."}`)}finally{r.current&&(r.current.value=""),t(!1),D(null)}},ae=async Fe=>{if(Fe.target.files&&Fe.target.files[0]){const Ce=Fe.target.files[0];D(Ce),R(null),t(!0);const Re=new FormData;Re.append("inventoryFile",Ce);try{const xe=await ge("/api/drugs/get-file-headers",{method:"POST",body:Re});if(!xe.ok){const Ge=await xe.json();throw new Error(Ge.message||`Failed to get file headers: ${xe.statusText}`)}const{headers:Ie}=await xe.json();T(Ie),k(!0)}catch(xe){console.error("Failed to get file headers:",xe),R(xe.message||"Failed to read file headers. Please check the file format and try again."),alert(`Error reading file headers: ${xe.message||"Please check the file format and try again."}`),D(null)}finally{t(!1)}}else D(null)},Z=Fe=>{I?te(I,Fe):R("No file selected for import after mapping."),k(!1)},B=()=>{k(!1),T([]),D(null),r.current&&(r.current.value="")},K=()=>{var Fe;(Fe=r.current)==null||Fe.click()},oe=async Fe=>{if(Fe.target.files&&Fe.target.files[0]){const Ce=Fe.target.files[0];R(null),t(!0);const Re=new FormData;Re.append("file",Ce),Re.append("output_type","csv");const Ie={Authorization:"Bearer 00841ac4-b279-11f0-ab55-0a3a41e3fad1"};try{const Ge=await fetch("https://extraction-api.nanonets.com/extract",{method:"POST",headers:Ie,body:Re});if(!Ge.ok){const Be=await Ge.json();throw new Error(Be.message||`Failed to extract data from image/PDF: ${Ge.statusText}`)}const ze=await Ge.json();if(!ze.success||!ze.content)throw new Error(ze.detail||"Nanonets API did not return expected content.");let nt=ze.content;nt=nt.split(`
`).filter(Be=>!Be.startsWith("#")&&Be.trim()!=="").join(`
`);const xt=new File([nt],"extracted_data.csv",{type:"text/csv"}),ve=new FormData;ve.append("inventoryFile",xt);const qe=await ge("/api/drugs/get-file-headers",{method:"POST",body:ve});if(!qe.ok){const Be=await qe.json();throw new Error(Be.message||`Failed to get headers from extracted CSV: ${qe.statusText}`)}const{headers:Qe}=await qe.json();T(Qe),D(xt),k(!0),alert("Successfully extracted data from image/PDF as CSV. Please map the columns.")}catch(Ge){console.error("Failed to extract data from image/PDF:",Ge),R(Ge.message||"Failed to extract data from image/PDF. Please check the file and try again."),alert(`Image/PDF extraction failed: ${Ge.message||"Please check the file and try again."}`)}finally{a.current&&(a.current.value=""),t(!1)}}},A=()=>{var Fe;(Fe=a.current)==null||Fe.click()},se=()=>{if(!u){R("Please select a distributor before adding a drug manually.");return}V(!0)},ue=()=>{V(!1),R(null)},M=Fe=>{$(Ce=>[...Ce,{...Fe,id:Date.now().toString(),supplier:u?u.name:Fe.supplier}]),ue()},pe=Fe=>{$(Ce=>Ce.filter(Re=>Re.id!==Fe))},be=(Fe,Ce,Re)=>{const{value:xe}=Fe.target;$(Ie=>Ie.map(Ge=>{if(Ge.id===Ce){let ze=xe;Re==="expiry_date"?ze=xe.trim()===""?null:xe:["price","quantity_in_stock","buying_price","gst","margin","discount","loose"].includes(Re)&&(ze=parseFloat(xe),isNaN(ze)&&(ze=null));const nt={...Ge,[Re]:ze};return Re==="name"&&u&&!nt.supplier&&(nt.supplier=u.name),nt}return Ge}))},fe=w.useCallback(()=>L.reduce((Fe,Ce)=>{const Re=Ce.quantity_in_stock||0,xe=Ce.buying_price||0,Ie=Ce.gst||0,Ge=Ce.discount||0;let ze=xe*(1-Ge/100),nt=Re*ze;return nt+=nt*(Ie/100),Fe+nt},0),[L]),Pe=async()=>{if(!u){R("Please select a distributor before submitting the purchase.");return}const Fe=L.filter(Ce=>Object.values(Ce).some(Re=>typeof Re=="string"&&Re.trim()!==""||typeof Re=="number"&&Re!==0||Re!=null&&typeof Re!="string"&&typeof Re!="number"));if(Fe.length===0){R("No valid drugs to submit. Please fill in at least one field for a row, or remove empty rows."),t(!1);return}t(!0),R(null);try{for(const Ie of Fe){const Ge={...Ie,expiry_date:Ie.expiry_date===""?null:Ie.expiry_date,distributorId:u.id},ze=await ge("/api/drugs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ge)});if(!ze.ok){const nt=await ze.json();throw new Error(nt.message||`Failed to add drug ${Ie.name}: ${ze.statusText}`)}}const Ce=fe(),Re=new Date().toISOString().split("T")[0],xe=await ge(`/api/distributors/${u.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:Re,order_value:Ce,amount_paid:F,notes:"Payment from purchase page."})});if(!xe.ok){const Ie=await xe.json();throw new Error(Ie.message||`Failed to record distributor payment: ${xe.statusText}`)}alert("All valid drugs added to inventory and distributor payment recorded successfully!"),$([]),h(null),l(""),U(0),e("/dashboard/inventory")}catch(Ce){console.error("Failed to submit purchase:",Ce),R(Ce.message||"Failed to submit purchase. Please try again."),alert(`Purchase submission failed: ${Ce.message||"Please try again."}`)}finally{t(!1)}},de=w.useCallback(async Fe=>{if(Fe.trim()===""){d([]);return}try{const Ce=await ge(`/api/distributors?search=${encodeURIComponent(Fe)}`);if(!Ce.ok)throw new Error(`Failed to fetch distributors: ${Ce.statusText}`);const Re=await Ce.json();d(Re)}catch(Ce){console.error("Failed to fetch distributors:",Ce),R(Ce.message||"Failed to load distributors.")}},[]),Me=Fe=>{const Ce=Fe.target.value;l(Ce),h(null),v.current&&clearTimeout(v.current),Ce.trim()!==""?v.current=setTimeout(()=>{de(Ce),b(!0)},300):(d([]),b(!1))},Ze=Fe=>{h(Fe),l(Fe.name),b(!1),d([])};return w.useEffect(()=>{const Fe=Ce=>{Ce.target instanceof HTMLElement&&!Ce.target.closest(".distributor-search-container")&&b(!1)};return document.addEventListener("mousedown",Fe),()=>{document.removeEventListener("mousedown",Fe),v.current&&clearTimeout(v.current)}},[]),i.jsxs("div",{className:"purchase-page",children:[i.jsxs("div",{className:"purchase-header",children:[i.jsx("button",{onClick:()=>e(-1),className:"action-icon-button",title:"Go Back",children:i.jsx(Ut,{size:24})}),i.jsx("h2",{className:"purchase-page-title",children:"Purchase Inventory"})]}),q&&i.jsx("div",{className:"error-message",children:q}),i.jsxs("div",{className:"purchase-controls-header",children:[i.jsxs("div",{className:"distributor-selection-section",children:[i.jsxs("h3",{children:[i.jsx(yR,{size:24,className:"icon-left"})," Select Distributor"]}),i.jsxs("div",{className:"distributor-search-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(aa,{size:20,className:"search-icon"}),i.jsx("input",{type:"text",placeholder:"Search distributor by name...",value:s,onChange:Me,onFocus:()=>s.trim()!==""&&b(!0),className:"distributor-search-input"})]}),g&&f.length>0&&i.jsx("ul",{className:"distributor-search-results",children:f.map(Fe=>i.jsx("li",{onClick:()=>Ze(Fe),children:Fe.name},Fe.id))}),u&&i.jsxs("div",{className:"selected-distributor-info",children:["Selected: ",i.jsx("strong",{children:u.name}),u.contact_person&&i.jsxs("span",{children:[" (",u.contact_person,")"]})]})]})]}),i.jsxs("div",{className:"import-section",children:[i.jsxs("h3",{children:[i.jsx(nN,{size:24,className:"icon-left"})," Import Drugs"]}),i.jsx("p",{children:"Upload an Excel (.xlsx, .xls), CSV, PDF, or Image file to import drug data."}),i.jsxs("div",{className:"import-controls",children:[i.jsx("input",{ref:r,id:"excel-file-upload",name:"excel-file-upload",type:"file",className:"sr-only",accept:".xlsx, .xls, .csv",onChange:ae}),i.jsxs("button",{onClick:K,disabled:n||!u,className:`action-button import-button ${n?"importing":""}`,title:u?"":"Please select a distributor",children:[i.jsx(nN,{size:18,className:"button-icon"}),n?"Reading Headers...":"Import XL or CSV"]}),i.jsx("input",{ref:a,id:"image-pdf-file-upload",name:"image-pdf-file-upload",type:"file",className:"sr-only",accept:".pdf, .png, .jpg, .jpeg",onChange:oe}),i.jsxs("button",{onClick:A,disabled:n||!u,className:"action-button import-button",title:u?"":"Please select a distributor",children:[i.jsx(Uo,{size:18,className:"button-icon"}),"Import from PDF/Image"]}),i.jsxs("button",{onClick:se,className:"action-button add-drug-manual-button",disabled:!u,title:u?"":"Select a distributor to add drugs manually",children:[i.jsx(ls,{size:18,className:"button-icon"}),"Add Drug"]})]})]})]}),i.jsx($re,{isOpen:S,onClose:B,excelHeaders:E,onConfirm:Z,availableFields:H}),z&&i.jsx(zre,{isOpen:z,onClose:ue,onDrugAddedToPurchase:M}),i.jsxs("div",{className:"purchase-summary-section",children:[i.jsxs("h3",{children:[i.jsx(dR,{size:24,className:"icon-left"})," Drugs to be Purchased (",L.length,")"]}),i.jsx(Bre,{purchaseRows:L,onCellChange:be,onRemoveDrug:pe,onAddEmptyRow:ee}),i.jsxs("div",{className:"purchase-summary-actions",children:[i.jsxs("button",{onClick:ee,className:"action-button add-drug-to-table-button",children:[i.jsx(ls,{size:18,className:"button-icon"}),"Add Row"]}),i.jsxs("div",{className:"summary-details",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"amount-paid-to-distributor",children:"Amount Paid ():"}),i.jsx("input",{type:"number",id:"amount-paid-to-distributor",value:F,onChange:Fe=>U(parseFloat(Fe.target.value)||0),placeholder:"0.00",className:"amount-paid-input",step:"0.01",disabled:!u,title:u?"":"Please select a distributor first"})]}),i.jsxs("div",{className:"total-purchase-value",children:[i.jsx("strong",{children:"Total Purchase Value:"})," ",fe().toFixed(2)]})]}),i.jsx("button",{onClick:Pe,disabled:n||L.length===0||!u,className:"action-button submit-purchase-button",children:n?"Submitting...":"Submit Purchase"})]})]})]})},Ure=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)/);return n&&n[1]?parseInt(n[1],10):1},qre=()=>{const e=wt(),n=ni(),[t,r]=w.useState(null),[a,s]=w.useState([]),[l,f]=w.useState(!0),[d,u]=w.useState(null),[h,g]=w.useState(!1),[b,v]=w.useState("cash"),[S,k]=w.useState(""),[E,T]=w.useState(""),[I,D]=w.useState(""),[q,R]=w.useState(""),[F,U]=w.useState(""),[z,V]=w.useState(0),L=w.useRef(!1),$=oe=>{const A=Math.max(0,Math.min(100,isNaN(oe)?0:oe));L.current=!0,V(A);const se=a.map(ue=>({...ue,discount_percentage:A}));s(se)},H=(oe,A)=>{const se=[...a];se[oe].discount_percentage=isNaN(A)?0:A,s(se)};w.useEffect(()=>{if(L.current){L.current=!1;return}const oe=a.reduce((ue,M)=>ue+(M.total_price??0),0);if(oe===0){V(0);return}const se=a.reduce((ue,M)=>{const be=(M.total_price??0)*((M.discount_percentage??0)/100);return ue+be},0)/oe*100;V(ue=>Math.abs(ue-se)>.01?se:ue)},[a]);const ee=async()=>{if(!t)return u("No order data available to bill."),null;if(a.length===0)return u("Cannot bill an empty order."),null;g(!0),u(null);try{const oe=a.map(pe=>{const be=(pe.pricePerLooseUnit??0)*(pe.looseQuantity??0),fe=be*((pe.discount_percentage??0)/100),Pe=be-fe;return{name:pe.name,pack_quantity:pe.loosePacks??0,loose_quantity:pe.looseUnits??0,price:pe.originalPrice??0,pack_price:pe.originalPrice??0,loose_price:pe.pricePerLooseUnit??0,total:Pe,drug_id:pe.drug_id,discount_percentage:pe.discount_percentage??0,batch:pe.batch,expiry_date:pe.expiry_date}}),A={patientId:t.patientId,queueId:t.id,items:oe,amount:K,paymentMode:b,type:"pharmacy",related_id:t.id,status:"paid",discountPercentage:z},se=await ge("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)}),ue=await se.json();if(!se.ok||!ue.id)throw new Error(ue.message||"Failed to create bill.");const M=await ge(`/api/pharmacy-orders/${t.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"billed",bill_id:ue.id,medications:a})});if(!M.ok){const pe=await M.text();throw new Error(`Failed to update pharmacy order status: ${M.statusText} - ${pe}`)}return r(pe=>pe?{...pe,status:"billed",bill_id:ue.id}:null),alert(`Order ${t.patientName}'s bill created (ID: ${ue.id}) and marked as billed.`),e(`/dashboard/pharmacy-billing/${t.id}`,{replace:!0,state:{order:{...t,status:"billed",bill_id:ue.id},initialItems:a}}),ue.id}catch(oe){return console.error("Billing process failed:",oe),u(oe.message||"Failed to mark order as billed. Please try again."),null}finally{g(!1)}},te=()=>{window.print()},ae=async()=>{await ee()&&(window.print(),e(-1))};w.useEffect(()=>{const oe=n.pathname.split("/"),A=oe[oe.length-1];A?(async()=>{try{const ue=await ge(`/api/pharmacy-orders/${A}`);if(!ue.ok)throw new Error("Failed to fetch pharmacy order details");const M=await ue.json();r(M);const pe=M.medications.map(be=>{const fe=Ure(be.unit),Pe=(be.pack_quantity??0)*fe+(be.loose_quantity??0);return{...be,isLoose:!0,loosePacks:be.pack_quantity??0,looseUnits:be.loose_quantity??0,looseQuantity:Pe,pack_price:Number(be.pack_price)||0,loose_price:Number(be.loose_price)||0,total_price:Number(be.total_price)||0,pricePerLooseUnit:Number(be.loose_price)||0,originalPrice:Number(be.pack_price)||0,discount_percentage:Number(be.discount_percentage)??0,directions_to_use:be.directions_to_use,tabletsPerDay:be.tabletsPerDay,numberOfDays:be.numberOfDays,batch:be.batch,expiry_date:be.expiry_date}});s(pe)}catch(ue){console.error("Failed to fetch order:",ue),u(ue.message||"Failed to load order details.")}finally{f(!1)}})():(u("No pharmacy order ID provided."),f(!1))},[n.pathname]),w.useEffect(()=>{(async()=>{try{const A=await ge("/api/clinics/settings");if(!A.ok)throw new Error("Failed to fetch clinic settings");const se=await A.json();T(se.upi_id||""),D(se.name||""),R(se.address||""),U(se.notes||"")}catch(A){console.error("Error fetching clinic settings:",A)}})()},[]);const Z=w.useMemo(()=>a.reduce((oe,A)=>oe+(A.total_price??0),0),[a]),B=w.useMemo(()=>a.reduce((oe,A)=>{const ue=(A.total_price??0)*(A.discount_percentage??0)/100;return oe+ue},0),[a]),K=w.useMemo(()=>Z-B,[Z,B]);return w.useEffect(()=>{if(K>0&&E){const oe=`upi://pay?pa=${E}&pn=ClinicName&am=${K.toFixed(2)}&cu=INR`;k(oe)}else k("")},[K,E]),l?i.jsx("div",{className:"loading-pulse",children:"Loading Bill..."}):d?i.jsxs("div",{className:"error-message-box",children:["Error: ",d]}):t?i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"TAX INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:I?`${I} Pharmacy`:"Pharmacy Bill"}),(q||F)&&i.jsxs("div",{className:"clinic-details-print",children:[q&&i.jsx("span",{className:"small-text clinic-address",children:q}),F&&i.jsx("span",{className:"small-text clinic-notes",children:F})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Gc,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(kd,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(lb,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(Ut,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Pharmacy Bill"})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Gc,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(kd,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item no-print",children:[i.jsxs("strong",{children:[i.jsx(Bb,{size:16})," Order ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(lb,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Medications"})}),a.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"BATCH"}),i.jsx("th",{children:"EXPIRY"}),i.jsx("th",{children:"QUANTITY"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:a.map((oe,A)=>{var be,fe;const se=oe.total_price??0,ue=se*(oe.discount_percentage??0)/100,M=se-ue;return i.jsxs("tr",{children:[i.jsx("td",{children:A+1}),i.jsx("td",{children:oe.name}),i.jsx("td",{children:oe.batch||"N/A"}),i.jsx("td",{children:oe.expiry_date?new Date(oe.expiry_date).toLocaleDateString():"N/A"}),i.jsxs("td",{children:[i.jsxs("div",{children:["Packs: ",oe.loosePacks??0]}),i.jsxs("div",{children:["Loose: ",oe.looseUnits??0]})]}),i.jsx("td",{children:((be=oe.originalPrice)==null?void 0:be.toFixed(2))??"N/A"}),i.jsx("td",{children:((fe=oe.pricePerLooseUnit)==null?void 0:fe.toFixed(2))??"N/A"}),i.jsxs("td",{children:[i.jsx("input",{type:"number",value:oe.discount_percentage??0,onChange:Pe=>H(A,parseFloat(Pe.target.value)),min:"0",max:"100",className:"discount-input-table"}),"%"]}),i.jsxs("td",{children:[5 .toFixed(1),"%"]}),i.jsx("td",{children:M.toFixed(2)})]},A)})})]}):i.jsx("p",{children:"No medications in this order."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[S&&i.jsxs("div",{className:`qr-code-container qr-code-printable-section ${b!=="upi"?"hide-on-screen":""}`,children:[i.jsx(Bh,{value:S,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",Z.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsxs("span",{children:["Total Discount (",z.toFixed(2),"%)"]}),i.jsxs("span",{children:["- ",B.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"GST (Included)"}),i.jsxs("span",{children:["",(K*.05).toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",K.toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",Z.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",B.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount Percentage"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:z,onChange:oe=>$(parseFloat(oe.target.value)),min:"0",max:"100",className:"discount-input-total",disabled:h||t.status==="billed"}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",K.toFixed(2)]})]}),i.jsx("div",{className:"qr-code-container",children:S?i.jsxs(i.Fragment,{children:[i.jsx(Bh,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]}):i.jsx("p",{children:"UPI QR code not available. Please ensure UPI ID is configured."})}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:b,onChange:oe=>v(oe.target.value),className:"payment-mode-select",disabled:h||t.status==="billed",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsxs("div",{className:"bill-actions",children:[t.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:te,className:"secondary-button print-preview-button no-print",disabled:h||a.length===0,children:"Print Preview"}),i.jsx("button",{onClick:ae,className:"primary-button",disabled:h||a.length===0,children:h?"Processing...":"Finalise and Bill"})]}),t.status==="billed"&&i.jsx("button",{onClick:()=>e(`/dashboard/bills/${t.bill_id}`),className:"secondary-button",children:"View Bill"})]})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})}):i.jsx("div",{className:"error-message-box",children:"No order data available."})},Vre=()=>{var q,R,F,U,z;const{billId:e}=ki(),n=wt(),[t,r]=w.useState(null),[a,s]=w.useState(!0),[l,f]=w.useState(null),[d,u]=w.useState(""),[h,g]=w.useState(""),[b,v]=w.useState(""),[S,k]=w.useState("");w.useEffect(()=>{(async()=>{try{if(!e)throw new Error("Bill ID is missing");const L=await ge(`/api/bills/${e}`);if(!L.ok)throw new Error("Failed to fetch bill details");const $=await L.json();r($.bill);const H=await ge("/api/clinics/settings");if(H.ok){const ee=await H.json();if(u(ee.name||""),g(ee.address||""),v(ee.notes||""),ee.upi_id&&$.amount>0){const te=`upi://pay?pa=${ee.upi_id}&pn=${encodeURIComponent(ee.name||"Clinic")}&am=${Number($.amount).toFixed(2)}&cu=INR`;k(te)}}}catch(L){console.error("Error fetching data:",L),f(L.message||"Failed to load bill details.")}finally{s(!1)}})()},[e]);const E=()=>{window.print()};if(a)return i.jsx("div",{className:"loading-pulse",children:"Loading Bill..."});if(l)return i.jsxs("div",{className:"error-message-box",children:["Error: ",l]});if(!t)return i.jsx("div",{className:"error-message-box",children:"No bill found."});const T=(t.items||[]).reduce((V,L)=>{const $=(Number(L.pack_price)||0)*(Number(L.pack_quantity)||0),H=(Number(L.loose_price)||0)*(Number(L.loose_quantity)||0);return V+$+H},0),I=T-Number(t.amount),D=Number(t.amount)*.05;return i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"TAX INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:d?`${d} Pharmacy`:"Pharmacy Bill"}),(h||b)&&i.jsxs("div",{className:"clinic-details-print",children:[h&&i.jsx("span",{className:"small-text clinic-address",children:h}),b&&i.jsx("span",{className:"small-text clinic-notes",children:b})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Gc,{size:16})," Patient Name"]})," ",((q=t.Patient)==null?void 0:q.name)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(kd,{size:16})," Token"]})," ",((R=t.Patient)==null?void 0:R.token_no)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(lb,{size:16})," Bill Date"]})," ",new Date(t.createdAt).toLocaleDateString()]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(kd,{size:16})," Bill No"]})," ",((F=t.id)==null?void 0:F.slice(0,8).toUpperCase())||"N/A"]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:[i.jsx(Ut,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"View Bill"}),i.jsxs("button",{onClick:E,className:"primary-button",style:{marginLeft:"auto",width:"auto",padding:"0.5rem 1rem"},children:[i.jsx(Ml,{size:16,style:{marginRight:"8px"}})," Print"]})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Bill Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Gc,{size:16})," Patient Name"]})," ",((U=t.Patient)==null?void 0:U.name)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(kd,{size:16})," Token"]})," ",((z=t.Patient)==null?void 0:z.token_no)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(kd,{size:16})," Bill ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(lb,{size:16})," Date"]})," ",new Date(t.createdAt).toLocaleString()]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Status"})," ",i.jsx("span",{className:"status-badge status-billed",children:t.status})]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Items"})}),t.items&&t.items.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"BATCH"}),i.jsx("th",{children:"EXPIRY"}),i.jsx("th",{children:"QUANTITY"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:t.items.map((V,L)=>{const $=Number(V.total)||0,H=5;let ee="N/A";if(V.expiry_date)try{ee=new Date(V.expiry_date).toLocaleDateString()}catch{}return i.jsxs("tr",{children:[i.jsx("td",{children:L+1}),i.jsx("td",{children:V.name}),i.jsx("td",{children:V.batch||"N/A"}),i.jsx("td",{children:ee}),i.jsxs("td",{children:[i.jsxs("div",{children:["Packs: ",V.pack_quantity??0]}),i.jsxs("div",{children:["Loose: ",V.loose_quantity??0]})]}),i.jsx("td",{children:Number(V.pack_price||0).toFixed(2)}),i.jsx("td",{children:Number(V.loose_price||0).toFixed(2)}),i.jsxs("td",{children:[Number(V.discount_percentage||0),"%"]}),i.jsxs("td",{children:[H.toFixed(1),"%"]}),i.jsx("td",{children:$.toFixed(2)})]},L)})})]}):i.jsx("p",{children:"No items in this bill."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[S&&i.jsxs("div",{className:"qr-code-container qr-code-printable-section",children:[i.jsx(Bh,{value:S,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",T.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Discount"}),i.jsxs("span",{children:["- ",I.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"GST (Included)"}),i.jsxs("span",{children:["",D.toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",Number(t.amount).toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Payment Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",T.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",I.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",Number(t.amount).toFixed(2)]})]}),i.jsxs("div",{className:"payment-mode-section",style:{marginTop:"1rem",padding:"1rem",background:"#f8f9fa",borderRadius:"8px"},children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Payment Mode:"})," ",(t.payment_mode||"N/A").toUpperCase()]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Payment Status:"})," ",(t.status||"N/A").toUpperCase()]})]}),i.jsx("div",{className:"qr-code-container",children:S&&i.jsxs(i.Fragment,{children:[i.jsx(Bh,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]})}),i.jsx("div",{className:"bill-actions",children:i.jsxs("button",{onClick:E,className:"primary-button",style:{width:"100%"},children:[i.jsx(Ml,{size:16,style:{marginRight:"8px"}})," Print Bill"]})})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})})};function Fl(e){return Array.isArray?Array.isArray(e):KA(e)==="[object Array]"}function Hre(e){if(typeof e=="string")return e;let n=e+"";return n=="0"&&1/e==-1/0?"-0":n}function Gre(e){return e==null?"":Hre(e)}function zo(e){return typeof e=="string"}function QA(e){return typeof e=="number"}function Yre(e){return e===!0||e===!1||Wre(e)&&KA(e)=="[object Boolean]"}function JA(e){return typeof e=="object"}function Wre(e){return JA(e)&&e!==null}function Ma(e){return e!=null}function d1(e){return!e.trim().length}function KA(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const Qre="Incorrect 'index' type",Jre=e=>`Invalid value for key ${e}`,Kre=e=>`Pattern length exceeds max of ${e}.`,Xre=e=>`Missing ${e} property in key`,Zre=e=>`Property 'weight' in key '${e}' must be a positive integer`,X_=Object.prototype.hasOwnProperty;class eie{constructor(n){this._keys=[],this._keyMap={};let t=0;n.forEach(r=>{let a=XA(r);this._keys.push(a),this._keyMap[a.id]=a,t+=a.weight}),this._keys.forEach(r=>{r.weight/=t})}get(n){return this._keyMap[n]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function XA(e){let n=null,t=null,r=null,a=1,s=null;if(zo(e)||Fl(e))r=e,n=Z_(e),t=yw(e);else{if(!X_.call(e,"name"))throw new Error(Xre("name"));const l=e.name;if(r=l,X_.call(e,"weight")&&(a=e.weight,a<=0))throw new Error(Zre(l));n=Z_(l),t=yw(l),s=e.getFn}return{path:n,id:t,weight:a,src:r,getFn:s}}function Z_(e){return Fl(e)?e:e.split(".")}function yw(e){return Fl(e)?e.join("."):e}function tie(e,n){let t=[],r=!1;const a=(s,l,f)=>{if(Ma(s))if(!l[f])t.push(s);else{let d=l[f];const u=s[d];if(!Ma(u))return;if(f===l.length-1&&(zo(u)||QA(u)||Yre(u)))t.push(Gre(u));else if(Fl(u)){r=!0;for(let h=0,g=u.length;h<g;h+=1)a(u[h],l,f+1)}else l.length&&a(u,l,f+1)}};return a(e,zo(n)?n.split("."):n,0),r?t:t[0]}const nie={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},rie={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,n)=>e.score===n.score?e.idx<n.idx?-1:1:e.score<n.score?-1:1},iie={location:0,threshold:.6,distance:100},aie={useExtendedSearch:!1,getFn:tie,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var Rt={...rie,...nie,...iie,...aie};const sie=/[^ ]+/g;function oie(e=1,n=3){const t=new Map,r=Math.pow(10,n);return{get(a){const s=a.match(sie).length;if(t.has(s))return t.get(s);const l=1/Math.pow(s,.5*e),f=parseFloat(Math.round(l*r)/r);return t.set(s,f),f},clear(){t.clear()}}}class TS{constructor({getFn:n=Rt.getFn,fieldNormWeight:t=Rt.fieldNormWeight}={}){this.norm=oie(t,3),this.getFn=n,this.isCreated=!1,this.setIndexRecords()}setSources(n=[]){this.docs=n}setIndexRecords(n=[]){this.records=n}setKeys(n=[]){this.keys=n,this._keysMap={},n.forEach((t,r)=>{this._keysMap[t.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,zo(this.docs[0])?this.docs.forEach((n,t)=>{this._addString(n,t)}):this.docs.forEach((n,t)=>{this._addObject(n,t)}),this.norm.clear())}add(n){const t=this.size();zo(n)?this._addString(n,t):this._addObject(n,t)}removeAt(n){this.records.splice(n,1);for(let t=n,r=this.size();t<r;t+=1)this.records[t].i-=1}getValueForItemAtKeyId(n,t){return n[this._keysMap[t]]}size(){return this.records.length}_addString(n,t){if(!Ma(n)||d1(n))return;let r={v:n,i:t,n:this.norm.get(n)};this.records.push(r)}_addObject(n,t){let r={i:t,$:{}};this.keys.forEach((a,s)=>{let l=a.getFn?a.getFn(n):this.getFn(n,a.path);if(Ma(l)){if(Fl(l)){let f=[];const d=[{nestedArrIndex:-1,value:l}];for(;d.length;){const{nestedArrIndex:u,value:h}=d.pop();if(Ma(h))if(zo(h)&&!d1(h)){let g={v:h,i:u,n:this.norm.get(h)};f.push(g)}else Fl(h)&&h.forEach((g,b)=>{d.push({nestedArrIndex:b,value:g})})}r.$[s]=f}else if(zo(l)&&!d1(l)){let f={v:l,n:this.norm.get(l)};r.$[s]=f}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}}function ZA(e,n,{getFn:t=Rt.getFn,fieldNormWeight:r=Rt.fieldNormWeight}={}){const a=new TS({getFn:t,fieldNormWeight:r});return a.setKeys(e.map(XA)),a.setSources(n),a.create(),a}function lie(e,{getFn:n=Rt.getFn,fieldNormWeight:t=Rt.fieldNormWeight}={}){const{keys:r,records:a}=e,s=new TS({getFn:n,fieldNormWeight:t});return s.setKeys(r),s.setIndexRecords(a),s}function Hx(e,{errors:n=0,currentLocation:t=0,expectedLocation:r=0,distance:a=Rt.distance,ignoreLocation:s=Rt.ignoreLocation}={}){const l=n/e.length;if(s)return l;const f=Math.abs(r-t);return a?l+f/a:f?1:l}function cie(e=[],n=Rt.minMatchCharLength){let t=[],r=-1,a=-1,s=0;for(let l=e.length;s<l;s+=1){let f=e[s];f&&r===-1?r=s:!f&&r!==-1&&(a=s-1,a-r+1>=n&&t.push([r,a]),r=-1)}return e[s-1]&&s-r>=n&&t.push([r,s-1]),t}const _d=32;function uie(e,n,t,{location:r=Rt.location,distance:a=Rt.distance,threshold:s=Rt.threshold,findAllMatches:l=Rt.findAllMatches,minMatchCharLength:f=Rt.minMatchCharLength,includeMatches:d=Rt.includeMatches,ignoreLocation:u=Rt.ignoreLocation}={}){if(n.length>_d)throw new Error(Kre(_d));const h=n.length,g=e.length,b=Math.max(0,Math.min(r,g));let v=s,S=b;const k=f>1||d,E=k?Array(g):[];let T;for(;(T=e.indexOf(n,S))>-1;){let U=Hx(n,{currentLocation:T,expectedLocation:b,distance:a,ignoreLocation:u});if(v=Math.min(U,v),S=T+h,k){let z=0;for(;z<h;)E[T+z]=1,z+=1}}S=-1;let I=[],D=1,q=h+g;const R=1<<h-1;for(let U=0;U<h;U+=1){let z=0,V=q;for(;z<V;)Hx(n,{errors:U,currentLocation:b+V,expectedLocation:b,distance:a,ignoreLocation:u})<=v?z=V:q=V,V=Math.floor((q-z)/2+z);q=V;let L=Math.max(1,b-V+1),$=l?g:Math.min(b+V,g)+h,H=Array($+2);H[$+1]=(1<<U)-1;for(let te=$;te>=L;te-=1){let ae=te-1,Z=t[e.charAt(ae)];if(k&&(E[ae]=+!!Z),H[te]=(H[te+1]<<1|1)&Z,U&&(H[te]|=(I[te+1]|I[te])<<1|1|I[te+1]),H[te]&R&&(D=Hx(n,{errors:U,currentLocation:ae,expectedLocation:b,distance:a,ignoreLocation:u}),D<=v)){if(v=D,S=ae,S<=b)break;L=Math.max(1,2*b-S)}}if(Hx(n,{errors:U+1,currentLocation:b,expectedLocation:b,distance:a,ignoreLocation:u})>v)break;I=H}const F={isMatch:S>=0,score:Math.max(.001,D)};if(k){const U=cie(E,f);U.length?d&&(F.indices=U):F.isMatch=!1}return F}function die(e){let n={};for(let t=0,r=e.length;t<r;t+=1){const a=e.charAt(t);n[a]=(n[a]||0)|1<<r-t-1}return n}const Ob=String.prototype.normalize?e=>e.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):e=>e;class eP{constructor(n,{location:t=Rt.location,threshold:r=Rt.threshold,distance:a=Rt.distance,includeMatches:s=Rt.includeMatches,findAllMatches:l=Rt.findAllMatches,minMatchCharLength:f=Rt.minMatchCharLength,isCaseSensitive:d=Rt.isCaseSensitive,ignoreDiacritics:u=Rt.ignoreDiacritics,ignoreLocation:h=Rt.ignoreLocation}={}){if(this.options={location:t,threshold:r,distance:a,includeMatches:s,findAllMatches:l,minMatchCharLength:f,isCaseSensitive:d,ignoreDiacritics:u,ignoreLocation:h},n=d?n:n.toLowerCase(),n=u?Ob(n):n,this.pattern=n,this.chunks=[],!this.pattern.length)return;const g=(v,S)=>{this.chunks.push({pattern:v,alphabet:die(v),startIndex:S})},b=this.pattern.length;if(b>_d){let v=0;const S=b%_d,k=b-S;for(;v<k;)g(this.pattern.substr(v,_d),v),v+=_d;if(S){const E=b-_d;g(this.pattern.substr(E),E)}}else g(this.pattern,0)}searchIn(n){const{isCaseSensitive:t,ignoreDiacritics:r,includeMatches:a}=this.options;if(n=t?n:n.toLowerCase(),n=r?Ob(n):n,this.pattern===n){let k={isMatch:!0,score:0};return a&&(k.indices=[[0,n.length-1]]),k}const{location:s,distance:l,threshold:f,findAllMatches:d,minMatchCharLength:u,ignoreLocation:h}=this.options;let g=[],b=0,v=!1;this.chunks.forEach(({pattern:k,alphabet:E,startIndex:T})=>{const{isMatch:I,score:D,indices:q}=uie(n,k,E,{location:s+T,distance:l,threshold:f,findAllMatches:d,minMatchCharLength:u,includeMatches:a,ignoreLocation:h});I&&(v=!0),b+=D,I&&q&&(g=[...g,...q])});let S={isMatch:v,score:v?b/this.chunks.length:1};return v&&a&&(S.indices=g),S}}class tu{constructor(n){this.pattern=n}static isMultiMatch(n){return ek(n,this.multiRegex)}static isSingleMatch(n){return ek(n,this.singleRegex)}search(){}}function ek(e,n){const t=e.match(n);return t?t[1]:null}class fie extends tu{constructor(n){super(n)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(n){const t=n===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class hie extends tu{constructor(n){super(n)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(n){const r=n.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,n.length-1]}}}class pie extends tu{constructor(n){super(n)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(n){const t=n.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class mie extends tu{constructor(n){super(n)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(n){const t=!n.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,n.length-1]}}}class gie extends tu{constructor(n){super(n)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(n){const t=n.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[n.length-this.pattern.length,n.length-1]}}}class yie extends tu{constructor(n){super(n)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(n){const t=!n.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,n.length-1]}}}class tP extends tu{constructor(n,{location:t=Rt.location,threshold:r=Rt.threshold,distance:a=Rt.distance,includeMatches:s=Rt.includeMatches,findAllMatches:l=Rt.findAllMatches,minMatchCharLength:f=Rt.minMatchCharLength,isCaseSensitive:d=Rt.isCaseSensitive,ignoreDiacritics:u=Rt.ignoreDiacritics,ignoreLocation:h=Rt.ignoreLocation}={}){super(n),this._bitapSearch=new eP(n,{location:t,threshold:r,distance:a,includeMatches:s,findAllMatches:l,minMatchCharLength:f,isCaseSensitive:d,ignoreDiacritics:u,ignoreLocation:h})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(n){return this._bitapSearch.searchIn(n)}}class nP extends tu{constructor(n){super(n)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(n){let t=0,r;const a=[],s=this.pattern.length;for(;(r=n.indexOf(this.pattern,t))>-1;)t=r+s,a.push([r,t-1]);const l=!!a.length;return{isMatch:l,score:l?0:1,indices:a}}}const xw=[fie,nP,pie,mie,yie,gie,hie,tP],tk=xw.length,xie=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,bie="|";function vie(e,n={}){return e.split(bie).map(t=>{let r=t.trim().split(xie).filter(s=>s&&!!s.trim()),a=[];for(let s=0,l=r.length;s<l;s+=1){const f=r[s];let d=!1,u=-1;for(;!d&&++u<tk;){const h=xw[u];let g=h.isMultiMatch(f);g&&(a.push(new h(g,n)),d=!0)}if(!d)for(u=-1;++u<tk;){const h=xw[u];let g=h.isSingleMatch(f);if(g){a.push(new h(g,n));break}}}return a})}const wie=new Set([tP.type,nP.type]);class Sie{constructor(n,{isCaseSensitive:t=Rt.isCaseSensitive,ignoreDiacritics:r=Rt.ignoreDiacritics,includeMatches:a=Rt.includeMatches,minMatchCharLength:s=Rt.minMatchCharLength,ignoreLocation:l=Rt.ignoreLocation,findAllMatches:f=Rt.findAllMatches,location:d=Rt.location,threshold:u=Rt.threshold,distance:h=Rt.distance}={}){this.query=null,this.options={isCaseSensitive:t,ignoreDiacritics:r,includeMatches:a,minMatchCharLength:s,findAllMatches:f,ignoreLocation:l,location:d,threshold:u,distance:h},n=t?n:n.toLowerCase(),n=r?Ob(n):n,this.pattern=n,this.query=vie(this.pattern,this.options)}static condition(n,t){return t.useExtendedSearch}searchIn(n){const t=this.query;if(!t)return{isMatch:!1,score:1};const{includeMatches:r,isCaseSensitive:a,ignoreDiacritics:s}=this.options;n=a?n:n.toLowerCase(),n=s?Ob(n):n;let l=0,f=[],d=0;for(let u=0,h=t.length;u<h;u+=1){const g=t[u];f.length=0,l=0;for(let b=0,v=g.length;b<v;b+=1){const S=g[b],{isMatch:k,indices:E,score:T}=S.search(n);if(k){if(l+=1,d+=T,r){const I=S.constructor.type;wie.has(I)?f=[...f,...E]:f.push(E)}}else{d=0,l=0,f.length=0;break}}if(l){let b={isMatch:!0,score:d/l};return r&&(b.indices=f),b}}return{isMatch:!1,score:1}}}const bw=[];function Nie(...e){bw.push(...e)}function vw(e,n){for(let t=0,r=bw.length;t<r;t+=1){let a=bw[t];if(a.condition(e,n))return new a(e,n)}return new eP(e,n)}const Lb={AND:"$and",OR:"$or"},ww={PATH:"$path",PATTERN:"$val"},Sw=e=>!!(e[Lb.AND]||e[Lb.OR]),Cie=e=>!!e[ww.PATH],jie=e=>!Fl(e)&&JA(e)&&!Sw(e),nk=e=>({[Lb.AND]:Object.keys(e).map(n=>({[n]:e[n]}))});function rP(e,n,{auto:t=!0}={}){const r=a=>{let s=Object.keys(a);const l=Cie(a);if(!l&&s.length>1&&!Sw(a))return r(nk(a));if(jie(a)){const d=l?a[ww.PATH]:s[0],u=l?a[ww.PATTERN]:a[d];if(!zo(u))throw new Error(Jre(d));const h={keyId:yw(d),pattern:u};return t&&(h.searcher=vw(u,n)),h}let f={children:[],operator:s[0]};return s.forEach(d=>{const u=a[d];Fl(u)&&u.forEach(h=>{f.children.push(r(h))})}),f};return Sw(e)||(e=nk(e)),r(e)}function _ie(e,{ignoreFieldNorm:n=Rt.ignoreFieldNorm}){e.forEach(t=>{let r=1;t.matches.forEach(({key:a,norm:s,score:l})=>{const f=a?a.weight:null;r*=Math.pow(l===0&&f?Number.EPSILON:l,(f||1)*(n?1:s))}),t.score=r})}function kie(e,n){const t=e.matches;n.matches=[],Ma(t)&&t.forEach(r=>{if(!Ma(r.indices)||!r.indices.length)return;const{indices:a,value:s}=r;let l={indices:a,value:s};r.key&&(l.key=r.key.src),r.idx>-1&&(l.refIndex=r.idx),n.matches.push(l)})}function Eie(e,n){n.score=e.score}function Tie(e,n,{includeMatches:t=Rt.includeMatches,includeScore:r=Rt.includeScore}={}){const a=[];return t&&a.push(kie),r&&a.push(Eie),e.map(s=>{const{idx:l}=s,f={item:n[l],refIndex:l};return a.length&&a.forEach(d=>{d(s,f)}),f})}class Zh{constructor(n,t={},r){this.options={...Rt,...t},this.options.useExtendedSearch,this._keyStore=new eie(this.options.keys),this.setCollection(n,r)}setCollection(n,t){if(this._docs=n,t&&!(t instanceof TS))throw new Error(Qre);this._myIndex=t||ZA(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(n){Ma(n)&&(this._docs.push(n),this._myIndex.add(n))}remove(n=()=>!1){const t=[];for(let r=0,a=this._docs.length;r<a;r+=1){const s=this._docs[r];n(s,r)&&(this.removeAt(r),r-=1,a-=1,t.push(s))}return t}removeAt(n){this._docs.splice(n,1),this._myIndex.removeAt(n)}getIndex(){return this._myIndex}search(n,{limit:t=-1}={}){const{includeMatches:r,includeScore:a,shouldSort:s,sortFn:l,ignoreFieldNorm:f}=this.options;let d=zo(n)?zo(this._docs[0])?this._searchStringList(n):this._searchObjectList(n):this._searchLogical(n);return _ie(d,{ignoreFieldNorm:f}),s&&d.sort(l),QA(t)&&t>-1&&(d=d.slice(0,t)),Tie(d,this._docs,{includeMatches:r,includeScore:a})}_searchStringList(n){const t=vw(n,this.options),{records:r}=this._myIndex,a=[];return r.forEach(({v:s,i:l,n:f})=>{if(!Ma(s))return;const{isMatch:d,score:u,indices:h}=t.searchIn(s);d&&a.push({item:s,idx:l,matches:[{score:u,value:s,norm:f,indices:h}]})}),a}_searchLogical(n){const t=rP(n,this.options),r=(f,d,u)=>{if(!f.children){const{keyId:g,searcher:b}=f,v=this._findMatches({key:this._keyStore.get(g),value:this._myIndex.getValueForItemAtKeyId(d,g),searcher:b});return v&&v.length?[{idx:u,item:d,matches:v}]:[]}const h=[];for(let g=0,b=f.children.length;g<b;g+=1){const v=f.children[g],S=r(v,d,u);if(S.length)h.push(...S);else if(f.operator===Lb.AND)return[]}return h},a=this._myIndex.records,s={},l=[];return a.forEach(({$:f,i:d})=>{if(Ma(f)){let u=r(t,f,d);u.length&&(s[d]||(s[d]={idx:d,item:f,matches:[]},l.push(s[d])),u.forEach(({matches:h})=>{s[d].matches.push(...h)}))}}),l}_searchObjectList(n){const t=vw(n,this.options),{keys:r,records:a}=this._myIndex,s=[];return a.forEach(({$:l,i:f})=>{if(!Ma(l))return;let d=[];r.forEach((u,h)=>{d.push(...this._findMatches({key:u,value:l[h],searcher:t}))}),d.length&&s.push({idx:f,item:l,matches:d})}),s}_findMatches({key:n,value:t,searcher:r}){if(!Ma(t))return[];let a=[];if(Fl(t))t.forEach(({v:s,i:l,n:f})=>{if(!Ma(s))return;const{isMatch:d,score:u,indices:h}=r.searchIn(s);d&&a.push({score:u,key:n,value:s,idx:l,norm:f,indices:h})});else{const{v:s,n:l}=t,{isMatch:f,score:d,indices:u}=r.searchIn(s);f&&a.push({score:d,key:n,value:s,norm:l,indices:u})}return a}}Zh.version="7.1.0";Zh.createIndex=ZA;Zh.parseIndex=lie;Zh.config=Rt;Zh.parseQuery=rP;Nie(Sie);const Aie=({isOpen:e,onClose:n,recurringItems:t,inventory:r,onCreateOrder:a})=>{const[s,l]=w.useState([]),[f,d]=w.useState(""),[u,h]=w.useState(null),[g,b]=w.useState([]),v=w.useMemo(()=>new Zh(r,{keys:["name","composition"],threshold:.4,includeScore:!0}),[r]);w.useEffect(()=>{if(e&&t.length>0&&r.length>0){const T=t.map(I=>{const D=v.search(I.name);let q=null,R="none";if(D.length>0){q=D[0].item;const F=D[0].score||1;F<.1?R="high":F<.4?R="medium":R="low"}return{original:I,matchedDrug:q,confidence:R}});l(T)}},[e,t,r,v]),w.useEffect(()=>{if(f){const T=v.search(f).map(I=>I.item);b(T.slice(0,10))}else b([])},[f,v]);const S=(T,I)=>{l(D=>{const q=[...D];return q[T]={...q[T],matchedDrug:I,confidence:"high"},q}),h(null),d("")},k=()=>{const T=s.filter(I=>I.matchedDrug).map(I=>{const D=Number(I.matchedDrug.price),q=E(I.matchedDrug.unit),R=D/(q||1),F=I.original.pack_quantity||0,U=I.original.loose_quantity||0,z=F*D+U*R;return{drug_id:I.matchedDrug.id,name:I.matchedDrug.name,pack_quantity:F,loose_quantity:U,pack_price:D,loose_price:R,total_price:z,unit:I.matchedDrug.unit}});a(T)},E=T=>{if(!T)return 1;const I=T.match(/(?:\d+x)?(\d+)/);return I?parseInt(I[1],10):1};return e?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-container",children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h2",{className:"modal-title",children:"Review Recurring Order Items"}),i.jsx("button",{onClick:n,className:"modal-close-button",children:i.jsx(Jn,{size:24})})]}),i.jsx("div",{className:"modal-content",children:i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:s.map((T,I)=>i.jsx("div",{className:`modal-item-card ${T.confidence==="high"?"high-confidence":T.confidence==="medium"?"medium-confidence":"low-confidence"}`,children:i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"1rem"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsx("p",{style:{fontSize:"0.875rem",fontWeight:500,color:"#6b7280"},children:"Recurring Item"}),i.jsx("p",{style:{fontSize:"1.125rem",fontWeight:600,color:"#1f2937"},children:T.original.name}),i.jsxs("p",{style:{fontSize:"0.875rem",color:"#4b5563"},children:["Qty: ",T.original.pack_quantity?`${T.original.pack_quantity} packs`:"",T.original.loose_quantity?` ${T.original.loose_quantity} loose`:""]})]}),i.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"0 1rem"},children:T.confidence==="high"?i.jsx(WI,{style:{color:"#22c55e"}}):i.jsx(kk,{style:{color:"#eab308"}})}),i.jsxs("div",{style:{flex:1},children:[i.jsx("p",{style:{fontSize:"0.875rem",fontWeight:500,color:"#6b7280"},children:"Matched Inventory Item"}),u===I?i.jsxs("div",{style:{position:"relative"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",border:"1px solid #d1d5db",borderRadius:"0.375rem",backgroundColor:"#ffffff"},children:[i.jsx(aa,{size:16,style:{marginLeft:"0.5rem",color:"#9ca3af"}}),i.jsx("input",{type:"text",value:f,onChange:D=>d(D.target.value),placeholder:"Search inventory...",style:{width:"100%",padding:"0.5rem",outline:"none",fontSize:"0.875rem",border:"none"},autoFocus:!0}),i.jsx("button",{onClick:()=>h(null),style:{padding:"0.5rem",color:"#9ca3af",background:"transparent",border:"none",cursor:"pointer"},children:i.jsx(Jn,{size:16})})]}),g.length>0&&i.jsx("div",{style:{position:"absolute",zIndex:10,width:"100%",marginTop:"0.25rem",backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"0.375rem",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1)",maxHeight:"12rem",overflowY:"auto"},children:g.map(D=>i.jsxs("div",{onClick:()=>S(I,D),style:{padding:"0.5rem",cursor:"pointer",fontSize:"0.875rem"},onMouseEnter:q=>q.currentTarget.style.backgroundColor="#f3f4f6",onMouseLeave:q=>q.currentTarget.style.backgroundColor="transparent",children:[i.jsx("div",{style:{fontWeight:500},children:D.name}),i.jsxs("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:["Stock: ",D.quantity_in_stock," | ",D.price]})]},D.id))})]}):i.jsx("div",{onClick:()=>{h(I),d("")},style:{cursor:"pointer",padding:"0.5rem",borderRadius:"0.375rem",border:"1px solid transparent",transition:"all 0.2s"},onMouseEnter:D=>{D.currentTarget.style.backgroundColor="#ffffff",D.currentTarget.style.borderColor="#d1d5db"},onMouseLeave:D=>{D.currentTarget.style.backgroundColor="transparent",D.currentTarget.style.borderColor="transparent"},children:T.matchedDrug?i.jsxs("div",{children:[i.jsx("p",{style:{fontWeight:600,color:"#1f2937"},children:T.matchedDrug.name}),i.jsxs("p",{style:{fontSize:"0.75rem",color:"#6b7280"},children:["Stock: ",T.matchedDrug.quantity_in_stock," | ",T.matchedDrug.price]})]}):i.jsx("p",{style:{color:"#ef4444",fontWeight:500},children:"No match found. Click to search."})})]})]})},I))})}),i.jsxs("div",{className:"modal-footer",children:[i.jsx("button",{onClick:n,className:"recurring-medications-button recurring-medications-button-secondary",children:"Cancel"}),i.jsx("button",{onClick:k,disabled:s.some(T=>!T.matchedDrug),className:"recurring-medications-button recurring-medications-button-primary",style:{opacity:s.some(T=>!T.matchedDrug)?.5:1,cursor:s.some(T=>!T.matchedDrug)?"not-allowed":"pointer"},children:"Create Order"})]})]})}):null},f1=15,Pie=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,s]=w.useState(null),[l,f]=w.useState(!1),[d,u]=w.useState(null),[h,g]=w.useState([]),[b,v]=w.useState(null),[S,k]=w.useState(30),E=wt(),[T,I]=w.useState(""),[D,q]=w.useState(""),[R,F]=w.useState(1),[U,z]=w.useState(1),[V,L]=w.useState(0),[$,H]=w.useState("next_delivery_date"),[ee,te]=w.useState("asc"),[ae,Z]=w.useState("");w.useEffect(()=>{const de=setTimeout(()=>{q(T),F(1)},500);return()=>{clearTimeout(de)}},[T]);const B=w.useCallback(async(de,Me,Ze,Fe,Ce)=>{r(!0),s(null);try{const Re=new URLSearchParams({page:de.toString(),limit:f1.toString(),sortBy:Ze,sortOrder:Fe});Me&&Re.append("search",Me),Ce&&Re.append("status",Ce);const xe=await ge(`/api/recurring-medications?${Re.toString()}`);if(!xe.ok){const Ge=await xe.json().catch(()=>({}));throw new Error(Ge.message||"Failed to fetch recurring medications")}const Ie=await xe.json();n(Ie.recurringMedications),L(Ie.totalCount),F(Ie.currentPage),z(Ie.totalPages)}catch(Re){s(Re.message),n([]),L(0),F(1),z(1)}finally{r(!1)}},[]),K=async()=>{try{const de=await ge("/api/drugs");if(de.ok){const Me=await de.json();g(Me)}}catch(de){console.error("Failed to fetch inventory:",de)}};w.useEffect(()=>{B(R,D,$,ee,ae),K()},[R,D,$,ee,ae,B]);const oe=de=>{const Me=$===de&&ee==="asc"?"desc":"asc";H(de),te(Me),F(1)},A=async(de,Me)=>{try{if(!(await ge(`/api/recurring-medications/${de}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:Me})})).ok)throw new Error("Failed to update status");B(R,D,$,ee,ae)}catch(Ze){alert(`Error updating status: ${Ze.message}`)}},se=(de,Me)=>{v(de),k(Me)},ue=async de=>{if(S<1||S>365){alert("Frequency must be between 1 and 365 days");return}try{const Me=await ge(`/api/recurring-medications/${de}/frequency`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({frequency_days:S})});if(!Me.ok){const Ze=await Me.json().catch(()=>({}));throw new Error(Ze.message||"Failed to update frequency")}v(null),B(R,D,$,ee,ae)}catch(Me){alert(`Error updating frequency: ${Me.message}`)}},M=()=>{v(null)},pe=de=>{u(de),f(!0)},be=async de=>{if(d)try{const Me={patient_id:d.patient_id,items:de,prescription_for_unavailable_drugs:"",status:"pending",date:new Date().toISOString(),order_total:de.reduce((Fe,Ce)=>Fe+(Ce.total_price||Ce.pack_quantity*Ce.pack_price+Ce.loose_quantity*Ce.loose_price),0),recurring_medication_id:d.id},Ze=await ge("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Me)});if(!Ze.ok){const Fe=await Ze.json().catch(()=>({}));throw new Error(Fe.message||"Failed to create order")}alert("Order created successfully!"),f(!1),u(null),B(R,D,$,ee,ae)}catch(Me){alert(`Failed to create order: ${Me.message}`)}},fe=(de,Me)=>{const Ze=Me.map(Fe=>({name:Fe.name,pack_quantity:Fe.pack_quantity,loose_quantity:Fe.loose_quantity,price:Fe.price,pack_price:Fe.pack_price,loose_price:Fe.loose_price,total_price:Number(Fe.total_price)||0,isLoose:Fe.isLoose,unit:Fe.unit,drug_id:Fe.drug_id?String(Fe.drug_id):null,tabletsPerDay:Fe.tabletsPerDay,numberOfDays:Fe.numberOfDays,directions_to_use:Fe.directions_to_use,discount_percentage:Fe.discount_percentage??0,batch:Fe.batch,expiry_date:Fe.expiry_date}));E(`/dashboard/pharmacy-billing/${de}`,{state:{initialItems:Ze}})},Pe=async(de,Me)=>{try{const Ze=await ge(`/api/pharmacy-orders/${de}`);if(!Ze.ok)throw new Error("Failed to fetch order details");const Fe=await Ze.json(),Ce={status:Me,medications:Fe.medications},Re=await ge(`/api/pharmacy-orders/${de}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ce)});if(!Re.ok){const xe=await Re.text();throw new Error(`Failed to update status: ${Re.statusText} (${Re.status}) - ${xe}`)}B(R,D,$,ee,ae),alert(`Order marked as ${Me} successfully!`)}catch(Ze){console.error("Failed to update order status:",Ze),alert(`Error updating status: ${Ze.message}`)}};return i.jsxs("div",{className:"recurring-medications-page-container",children:[i.jsxs("div",{className:"recurring-medications-header",children:[i.jsxs("div",{className:"recurring-medications-header-left",children:[i.jsxs("button",{onClick:()=>E(-1),className:"recurring-medications-button recurring-medications-button-back",children:[i.jsx(Ut,{size:20}),"Back"]}),i.jsx("h1",{className:"recurring-medications-page-title",children:"Recurring Medications"})]}),i.jsxs("button",{onClick:()=>B(R,D,$,ee,ae),className:"recurring-medications-button recurring-medications-button-primary",children:[i.jsx(fb,{size:18}),"Refresh"]})]}),i.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",flexDirection:"column",gap:"1rem"},children:[i.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center",flexWrap:"wrap"},children:[i.jsxs("div",{style:{flex:"1 1 300px",position:"relative"},children:[i.jsx("input",{type:"text",placeholder:"Search by name, phone, or token...",value:T,onChange:de=>I(de.target.value),style:{width:"100%",padding:"0.75rem 3rem 0.75rem 1rem",border:"2px solid #e5e7eb",borderRadius:"0.5rem",fontSize:"0.95rem",transition:"all 0.2s ease",outline:"none"},onFocus:de=>de.target.style.borderColor="#6d28d9",onBlur:de=>de.target.style.borderColor="#e5e7eb"}),i.jsx(aa,{size:20,style:{position:"absolute",right:"1rem",top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",border:"2px solid #e5e7eb",borderRadius:"0.5rem",padding:"0.75rem 1rem",backgroundColor:"#ffffff"},children:[i.jsx(Ck,{size:18,style:{color:"#6b7280"}}),i.jsxs("select",{id:"statusFilter",value:ae,onChange:de=>Z(de.target.value),style:{border:"none",outline:"none",fontSize:"0.95rem",backgroundColor:"transparent",cursor:"pointer",fontWeight:500,color:"#374151"},children:[i.jsx("option",{value:"",children:"All Status"}),i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"paused",children:"Paused"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})]}),!t&&V>0&&i.jsxs("div",{style:{fontSize:"0.875rem",color:"#6b7280",fontWeight:500},children:["Found ",i.jsx("span",{style:{color:"#6d28d9",fontWeight:700},children:V})," recurring medication",V!==1?"s":"",(D||ae)&&" matching your criteria"]})]}),i.jsxs("div",{className:"recurring-medications-content-box",children:[a&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"1rem 1.25rem",backgroundColor:"#fee2e2",border:"2px solid #fca5a5",borderRadius:"0.75rem",color:"#991b1b",marginBottom:"1.5rem",boxShadow:"0 2px 4px rgba(239, 68, 68, 0.1)"},children:[i.jsx(Sr,{size:24,style:{flexShrink:0}}),i.jsxs("div",{children:[i.jsx("p",{style:{fontWeight:600,marginBottom:"0.25rem"},children:"Error Loading Data"}),i.jsx("p",{style:{fontSize:"0.875rem",margin:0},children:a})]})]}),t?i.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"20rem",gap:"1rem"},children:[i.jsx("div",{className:"spinner"}),i.jsx("p",{style:{color:"#6b7280",fontSize:"0.95rem",fontWeight:500},children:"Loading recurring medications..."})]}):e.length===0?i.jsxs("div",{style:{textAlign:"center",padding:"4rem 2rem",background:"linear-gradient(135deg, #f9fafb 0%, #ffffff 100%)",borderRadius:"1rem",border:"2px dashed #d1d5db",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[i.jsx("div",{style:{width:"4rem",height:"4rem",margin:"0 auto 1.5rem",borderRadius:"50%",background:"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx(Sr,{size:32,style:{color:"#3b82f6"}})}),i.jsx("p",{style:{color:"#1f2937",fontSize:"1.125rem",fontWeight:600,marginBottom:"0.5rem"},children:D||ae?"No matches found":"No recurring medications"}),i.jsx("p",{style:{color:"#6b7280",fontSize:"0.95rem"},children:D||ae?"Try adjusting your search or filter criteria":"Recurring medications will appear here once created"})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"recurring-medications-table-container",children:i.jsxs("table",{className:"recurring-medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[i.jsxs("div",{className:"sortable-header",onClick:()=>oe("patient_name"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"0.25rem"},children:[i.jsx("span",{children:"Name"}),$==="patient_name"&&(ee==="asc"?i.jsx(Pl,{size:12}):i.jsx(Uc,{size:12}))]}),i.jsxs("div",{style:{display:"flex",gap:"0.5rem",fontSize:"0.75rem",color:"#6b7280"},children:[i.jsxs("div",{className:"sortable-header",onClick:()=>oe("patient_phone"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"0.25rem"},children:[i.jsx("span",{children:"Phone"}),$==="patient_phone"&&(ee==="asc"?i.jsx(Pl,{size:10}):i.jsx(Uc,{size:10}))]}),i.jsx("span",{children:"|"}),i.jsxs("div",{className:"sortable-header",onClick:()=>oe("patient_token"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"0.25rem"},children:[i.jsx("span",{children:"Token"}),$==="patient_token"&&(ee==="asc"?i.jsx(Pl,{size:10}):i.jsx(Uc,{size:10}))]})]})]})}),i.jsx("th",{children:"Medications"}),i.jsxs("th",{className:"sortable-header",onClick:()=>oe("next_delivery_date"),style:{cursor:"pointer",userSelect:"none"},children:["Next Delivery",$==="next_delivery_date"&&(ee==="asc"?i.jsx(Pl,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}):i.jsx(Uc,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}))]}),i.jsxs("th",{className:"sortable-header",onClick:()=>oe("frequency_days"),style:{cursor:"pointer",userSelect:"none"},children:["Frequency",$==="frequency_days"&&(ee==="asc"?i.jsx(Pl,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}):i.jsx(Uc,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}))]}),i.jsxs("th",{className:"sortable-header",onClick:()=>oe("status"),style:{cursor:"pointer",userSelect:"none"},children:["Status",$==="status"&&(ee==="asc"?i.jsx(Pl,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}):i.jsx(Uc,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}))]}),i.jsx("th",{children:"Last Order"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map(de=>i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{style:{fontWeight:500,color:"#1f2937"},children:de.patient_name}),i.jsx("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:de.patient_phone}),i.jsxs("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:["Token: ",de.patient_token]})]}),i.jsx("td",{children:i.jsx("ul",{style:{listStyleType:"disc",paddingLeft:"1.25rem",fontSize:"0.875rem",color:"#4b5563"},children:de.medications.map((Me,Ze)=>i.jsxs("li",{children:[Me.name,Me.pack_quantity?` (${Me.pack_quantity} packs)`:"",Me.loose_quantity?` (${Me.loose_quantity} loose)`:""]},Ze))})}),i.jsx("td",{children:i.jsx("div",{style:{fontSize:"0.875rem"},children:new Date(de.next_delivery_date).toLocaleDateString()})}),i.jsx("td",{children:b===de.id?i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.jsx("input",{type:"number",min:"1",max:"365",value:S,onChange:Me=>k(parseInt(Me.target.value,10)||1),style:{width:"4rem",padding:"0.25rem 0.5rem",border:"2px solid #6d28d9",borderRadius:"0.375rem",fontSize:"0.875rem",outline:"none"},autoFocus:!0,onKeyDown:Me=>{Me.key==="Enter"&&ue(de.id),Me.key==="Escape"&&M()}}),i.jsx("span",{style:{fontSize:"0.875rem",color:"#4b5563"},children:"days"}),i.jsx("button",{onClick:()=>ue(de.id),style:{padding:"0.25rem 0.5rem",backgroundColor:"#22c55e",color:"white",border:"none",borderRadius:"0.375rem",cursor:"pointer",fontSize:"0.75rem",fontWeight:600},title:"Save (Enter)",children:""}),i.jsx("button",{onClick:M,style:{padding:"0.25rem 0.5rem",backgroundColor:"#ef4444",color:"white",border:"none",borderRadius:"0.375rem",cursor:"pointer",fontSize:"0.75rem",fontWeight:600},title:"Cancel (Esc)",children:""})]}):i.jsxs("div",{onClick:()=>se(de.id,de.frequency_days||30),style:{fontSize:"0.875rem",color:"#4b5563",cursor:"pointer",padding:"0.25rem 0.5rem",borderRadius:"0.375rem",transition:"all 0.2s ease",display:"inline-block"},onMouseEnter:Me=>{Me.currentTarget.style.backgroundColor="#f3f4f6",Me.currentTarget.style.color="#6d28d9"},onMouseLeave:Me=>{Me.currentTarget.style.backgroundColor="transparent",Me.currentTarget.style.color="#4b5563"},title:"Click to edit frequency",children:["Every ",de.frequency_days||30," days "]})}),i.jsx("td",{children:i.jsx("span",{className:`status-badge ${de.status}`,children:de.status})}),i.jsx("td",{children:de.last_order?i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[i.jsxs("div",{style:{fontSize:"0.875rem"},children:[i.jsx("span",{style:{fontWeight:500},children:"Status: "}),i.jsx("span",{className:`status-badge ${de.last_order.status}`,children:de.last_order.status})]}),i.jsx("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:new Date(de.last_order.date).toLocaleDateString()}),i.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[de.last_order.status==="pending"&&i.jsxs("button",{onClick:()=>fe(de.last_order.id,de.medications),className:"small-action-button bill",children:[i.jsx(g1,{size:12})," Bill"]}),de.last_order.status==="billed"&&i.jsxs("button",{onClick:()=>Pe(de.last_order.id,"dispensed"),className:"small-action-button dispense",children:[i.jsx(Id,{size:12})," Dispense"]}),de.last_order.status==="dispensed"&&i.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem",color:"#16a34a"},children:[i.jsx($a,{size:12})," Complete"]})]})]}):i.jsx("span",{style:{fontSize:"0.875rem",color:"#9ca3af"},children:"No recent order"})}),i.jsx("td",{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.jsxs("select",{value:de.status,onChange:Me=>A(de.id,Me.target.value),style:{fontSize:"0.875rem",borderColor:"#d1d5db",borderRadius:"0.375rem",padding:"0.25rem 0.5rem"},children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"paused",children:"Paused"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]}),i.jsx("button",{onClick:()=>pe(de),className:"action-button",title:"Create Order",children:i.jsx(sR,{size:18})})]})})]},de.id))})]})}),U>1&&i.jsxs("div",{className:"pagination-controls",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"1.5rem",padding:"1rem",backgroundColor:"#f9fafb",borderRadius:"0.5rem"},children:[i.jsxs("div",{className:"pagination-info",style:{fontSize:"0.875rem",color:"#6b7280"},children:["Showing"," ",i.jsx("span",{style:{fontWeight:500,color:"#1f2937"},children:(R-1)*f1+1})," ","to"," ",i.jsx("span",{style:{fontWeight:500,color:"#1f2937"},children:Math.min(R*f1,V)})," ","of"," ",i.jsx("span",{style:{fontWeight:500,color:"#1f2937"},children:V})," results"]}),i.jsxs("div",{className:"pagination-buttons",style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[i.jsxs("button",{onClick:()=>F(de=>Math.max(de-1,1)),disabled:R===1||t,className:"pagination-button",style:{display:"flex",alignItems:"center",gap:"0.25rem",padding:"0.5rem 1rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",backgroundColor:R===1?"#f3f4f6":"#fff",cursor:R===1?"not-allowed":"pointer",fontSize:"0.875rem"},children:[i.jsx(zb,{size:16}),"Previous"]}),i.jsxs("span",{style:{fontSize:"0.875rem",color:"#6b7280"},children:["Page ",i.jsx("span",{style:{fontWeight:500,color:"#1f2937"},children:R})," of ",i.jsx("span",{style:{fontWeight:500,color:"#1f2937"},children:U})]}),i.jsxs("button",{onClick:()=>F(de=>Math.min(de+1,U)),disabled:R===U||t,className:"pagination-button",style:{display:"flex",alignItems:"center",gap:"0.25rem",padding:"0.5rem 1rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",backgroundColor:R===U?"#f3f4f6":"#fff",cursor:R===U?"not-allowed":"pointer",fontSize:"0.875rem"},children:["Next",i.jsx(gg,{size:16})]})]})]})]})]}),d&&i.jsx(Aie,{isOpen:l,onClose:()=>f(!1),recurringItems:d.medications,inventory:h,onCreateOrder:be})]})};function Die(){const[e,n]=w.useState(!1),[t,r]=w.useState(null),[a,s]=w.useState(!0),[l,f]=w.useState(null),[d,u]=w.useState(!1),h=I=>{r(I),n(!0),I.role==="admin"&&!I.has_seen_tutorial&&u(!0)},g=()=>{n(!1),r(null),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")};w.useEffect(()=>{const I=localStorage.getItem("authToken"),D=localStorage.getItem("currentUser");if(I&&D)try{const q=JSON.parse(D);r(q),n(!0),q.role==="admin"&&!q.has_seen_tutorial&&u(!0)}catch(q){console.error("Error parsing stored user data:",q),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")}s(!1)},[]),w.useEffect(()=>{(async()=>{if(e&&t)try{const D=await $k();f(D)}catch(D){console.error("Error fetching clinic pro plan status:",D),f({hasProPlan:!1})}else f(null)})()},[e,t]);const[b,v]=w.useState(null),[S,k]=w.useState(!1);w.useEffect(()=>{const I=D=>{D.preventDefault(),v(D),k(!0),console.log("beforeinstallprompt event fired")};return window.addEventListener("beforeinstallprompt",I),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&(console.log("App is already installed (standalone)."),k(!1)),()=>{window.removeEventListener("beforeinstallprompt",I)}},[]),w.useEffect(()=>{const I=window.matchMedia("(prefers-color-scheme: dark)"),D=()=>{I.matches?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")};return D(),I.addEventListener("change",D),()=>{I.removeEventListener("change",D),document.body.classList.remove("dark-mode")}},[]);const E=w.useCallback(async()=>{if(!b){console.log("Install prompt event not available.");return}const I=b;I.prompt();const{outcome:D}=await I.userChoice;console.log(`User response to the install prompt: ${D}`),v(null),k(!1)},[b]),T=async()=>{if(t)try{(await ge(`/api/users/${t.id}/tutorial-seen`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({has_seen_tutorial:!0})})).ok?(r(D=>D?{...D,has_seen_tutorial:!0}:null),localStorage.setItem("currentUser",JSON.stringify({...t,has_seen_tutorial:!0})),u(!1)):console.error("Failed to update tutorial status on backend.")}catch(I){console.error("Error marking tutorial as seen:",I)}};return a?i.jsx("div",{children:"Loading..."}):i.jsxs(KD,{children:[i.jsx(lI,{children:i.jsxs(jh,{children:[i.jsx(ut,{path:"/login",element:e?i.jsx(mn,{to:"/dashboard"}):i.jsx(dI,{onLoginSuccess:h})}),i.jsx(ut,{path:"/register",element:e?i.jsx(mn,{to:"/dashboard"}):i.jsx(fI,{})}),i.jsx(ut,{path:"/handle-complaint-url",element:e?i.jsx(Lre,{}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/live-api",element:e?i.jsx(B7,{}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/create-lab-order",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(jE,{currentUser:t})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/manage-admission",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(NE,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/lab/report/:orderId",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Y_,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/lab/enter-report/:orderId",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Y_,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/add-patient",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(H1,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/billing",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(zne,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/lab-billing",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Une,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/edit-complaint/:recordId",element:e&&t?i.jsx(Lne,{}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/edit-pharmacy-order/:orderId",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(MA,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/*",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:Iie(t.role,t,ge)}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/lab/view-report/:orderId",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Zne,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/lab/search-report",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(ere,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/patient/:patientId/lab-reports",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(tre,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/patient/:patientId/pharmacy-orders",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(qne,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/inventory",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(RA,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/lab-inventory",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Dw,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/patient/:patientId/complaints",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Fne,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/patient/:patientId/admission-bill/:billId",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(are,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/start-subscription/:patientId",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(_re,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/start-clinic-subscription",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Are,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/refill-reminders",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(WA,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/notifications",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Fre,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/create-custom-bill",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(CE,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/pharmacy-billing/:orderId",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(qre,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/bills/:billId",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Vre,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"/dashboard/recurring-medications",element:e&&t?i.jsx(tr,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:E,clinicProPlanStatus:l,children:i.jsx(Pie,{})}):i.jsx(mn,{to:"/login"})}),i.jsx(ut,{path:"*",element:i.jsx(mn,{to:e?"/dashboard":"/login"})})]})}),d&&i.jsx(Rre,{onClose:()=>u(!1),onMarkAsSeen:T})]})}const Iie=(e,n,t)=>{switch(e){case"superadmin":return i.jsxs(jh,{children:[i.jsx(ut,{index:!0,element:i.jsx(Dre,{})}),i.jsx(ut,{path:"clinic-subscriptions",element:i.jsx(kre,{})}),i.jsx(ut,{path:"clinic-subscriptions/add",element:i.jsx(Ere,{})}),i.jsx(ut,{path:"clinic-subscriptions/edit/:id",element:i.jsx(Tre,{})}),i.jsx(ut,{path:"users",element:i.jsx(Pre,{})})," ",i.jsx(ut,{path:"*",element:i.jsx("div",{children:"Unknown Super Admin Section"})})]});case"admin":return i.jsxs(jh,{children:[i.jsx(ut,{index:!0,element:i.jsx(K7,{fetchWithAuth:t})}),i.jsx(ut,{path:"staff",element:i.jsx(ire,{fetchWithAuth:t})}),i.jsx(ut,{path:"staff/add",element:i.jsx(sq,{clinicId:n==null?void 0:n.clinic_id})}),i.jsx(ut,{path:"staff/edit/:id",element:i.jsx(oq,{})}),i.jsx(ut,{path:"patients/add",element:i.jsx(H1,{})}),i.jsx(ut,{path:"search-patient",element:i.jsx(Th,{})}),i.jsx(ut,{path:"patients",element:i.jsx(V1,{})}),i.jsx(ut,{path:"analysis",element:i.jsx(b1,{})}),i.jsx(ut,{path:"inventory",element:i.jsx(Fk,{})}),i.jsx(ut,{path:"inventory/edit/:id",element:i.jsx(aq,{})}),i.jsx(ut,{path:"distributors",element:i.jsx(J_,{})}),i.jsx(ut,{path:"purchase",element:i.jsx(K_,{})})," ",i.jsx(ut,{path:"queue",element:i.jsx(Pv,{})}),i.jsx(ut,{path:"subscriptions",element:i.jsx(Nre,{})}),i.jsx(ut,{path:"subscriptions/add",element:i.jsx(Cre,{})}),i.jsx(ut,{path:"subscriptions/edit/:id",element:i.jsx(jre,{})}),i.jsx(ut,{path:"*",element:i.jsx("div",{children:"Unknown Admin Section"})})," "]});case"doctor":return i.jsxs(jh,{children:[i.jsx(ut,{index:!0,element:i.jsx(mn,{to:"search-patient",replace:!0})}),i.jsx(ut,{path:"search-patient",element:i.jsx(Th,{})}),i.jsx(ut,{path:"queue",element:i.jsx(Pv,{})}),i.jsx(ut,{path:":patientId",element:i.jsx(Pv,{})}),i.jsx(ut,{path:"add-patient",element:i.jsx(H1,{})}),i.jsx(ut,{path:"*",element:i.jsx("div",{children:"Unknown Doctor Section"})})]});case"receptionist":return i.jsxs(jh,{children:[i.jsx(ut,{index:!0,element:i.jsx(Z7,{currentUser:n})}),i.jsx(ut,{path:"all-patients",element:i.jsx(V1,{})}),i.jsx(ut,{path:"search-patient",element:i.jsx(Th,{})}),i.jsx(ut,{path:"*",element:i.jsx("div",{children:"Unknown Reception Section"})})," "]});case"lab":return i.jsx(nq,{});case"pharmacy":return i.jsxs(jh,{children:[i.jsx(ut,{index:!0,element:i.jsx(rq,{})}),i.jsx(ut,{path:"inventory",element:i.jsx(RA,{})}),i.jsx(ut,{path:"settings",element:i.jsx(iq,{})}),i.jsx(ut,{path:"add-order",element:i.jsx(Vne,{})}),i.jsx(ut,{path:"edit-pharmacy-order/:orderId",element:i.jsx(MA,{})}),i.jsx(ut,{path:"analysis",element:i.jsx(b1,{})}),i.jsx(ut,{path:"orders/:orderId",element:i.jsx(gre,{})}),i.jsx(ut,{path:"search-patient-records",element:i.jsx(Th,{})}),i.jsx(ut,{path:"distributors",element:i.jsx(J_,{})}),i.jsx(ut,{path:"purchase",element:i.jsx(K_,{})})," ",i.jsx(ut,{path:"refill-reminders",element:i.jsx(WA,{})})," ",i.jsx(ut,{path:"*",element:i.jsx(mn,{to:"/dashboard",replace:!0})})]});default:return i.jsxs("div",{children:["Unknown role (",e,") or dashboard not implemented."]},e)}},tr=({user:e,onLogout:n,children:t,showInstallPrompt:r,onInstallClick:a,clinicProPlanStatus:s})=>{const l=wt(),[f,d]=w.useState(!1),[u,h]=w.useState(window.innerWidth<=768),[g,b]=w.useState(!1),[v,S]=w.useState([]),[k,E]=w.useState(0),[T,I]=w.useState(!1),[D,q]=w.useState("Newtons Ai"),[R,F]=w.useState(null),U=w.useRef(null);w.useEffect(()=>{const ee=()=>{h(window.innerWidth<=768)};return window.addEventListener("resize",ee),()=>window.removeEventListener("resize",ee)},[]);const z=w.useCallback(async()=>{try{const ee=await ge("/api/notifications");if(ee.ok){const Z=(await ee.json()).reduce((B,K)=>{const oe=B.find(A=>A.message===K.message);return oe?new Date(K.created_at)>new Date(oe.created_at)?B.map(A=>A.message===K.message?K:A):B:[...B,K]},[]).sort((B,K)=>{const oe={expired_drug:1,near_expiry_drug:2,low_stock:3},A=oe[B.type]||99,se=oe[K.type]||99;return A!==se?A-se:new Date(K.created_at).getTime()-new Date(B.created_at).getTime()});S(Z),E(Z.filter(B=>!B.is_read).length)}else console.error("Failed to fetch notifications:",ee.statusText)}catch(ee){console.error("Error fetching notifications:",ee)}},[]);w.useEffect(()=>{(async()=>{if(e!=null&&e.clinic_id)try{const te=await ge("/api/clinics/settings");if(te.ok){const ae=await te.json();ae.name===""?q("Newtons Ai"):q(ae.name),F(ae.logoUrl)}else console.error("Failed to fetch clinic details for display:",te.statusText),q("Newtons Ai"),F(null)}catch(te){console.error("Error fetching clinic details for display:",te),q("Newtons Ai"),F(null)}else q("Newtons Ai"),F(null)})()},[e==null?void 0:e.clinic_id]),w.useEffect(()=>{if(e!=null&&e.clinic_id){z();const ee=setInterval(z,5*60*1e3);return()=>clearInterval(ee)}},[e==null?void 0:e.clinic_id,z]);const V=()=>{d(!f),f||b(!1)},L=()=>{b(!g),g||d(!1)};w.useEffect(()=>{const ee=te=>{U.current&&!U.current.contains(te.target)&&g&&b(!1)};return g&&document.addEventListener("mousedown",ee),()=>{document.removeEventListener("mousedown",ee)}},[g]);const $=async ee=>{try{const te=await ge(`/api/notifications/${ee}/read`,{method:"PUT"});te.ok?z():console.error("Failed to mark notification as read:",te.statusText)}catch(te){console.error("Error marking notification as read:",te)}},H=async()=>{I(!0);try{const ee=await ge("/api/notifications/trigger-all",{method:"POST"});ee.ok?(console.log("Notification checks triggered successfully."),await z()):console.error("Failed to trigger notification checks:",ee.statusText)}catch(ee){console.error("Error triggering notification checks:",ee)}finally{I(!1)}};return i.jsxs("div",{className:"dashboard-layout",children:[" ",i.jsxs("nav",{className:"app-header no-print",children:[i.jsxs("div",{className:"header-left",children:[i.jsx("a",{href:"#",onClick:ee=>{ee.preventDefault(),l("/dashboard")},className:"logo-container",children:i.jsx("img",{src:R||"/logo.png",alt:"App Logo",className:"logo-image"})}),i.jsxs("div",{className:"title-section",children:[i.jsx("span",{className:"app-title-link",children:D}),i.jsxs("span",{className:"user-role-panel",children:["(",e.role.charAt(0).toUpperCase()+e.role.slice(1)," Panel)"]})]})]}),i.jsxs("div",{className:"header-right",children:[r&&i.jsxs("button",{onClick:a,className:"install-button",title:"Install App",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),i.jsx("span",{children:"Install"})]}),s&&(s.hasProPlan?i.jsx("span",{className:"pro-badge",children:"PRO"}):i.jsx("button",{onClick:()=>l("/start-clinic-subscription"),className:"go-pro-button",children:"GoPro"})),i.jsxs("div",{className:"notifications-section",ref:U,children:[" ",i.jsxs("button",{className:"notification-icon","aria-label":"Notifications",onClick:L,children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),k>0&&i.jsx("span",{className:"notification-count",children:k})]}),g&&i.jsxs("div",{className:"notifications-dropdown",children:[i.jsx("div",{className:"dropdown-header",children:"Notifications"}),i.jsx("ul",{className:"dropdown-list",children:v.length>0?v.map(ee=>i.jsxs("li",{className:`dropdown-item ${ee.is_read?"read":"unread"}`,onClick:()=>$(ee.id),children:[ee.message,i.jsx("span",{className:"notification-timestamp",children:new Date(ee.created_at).toLocaleString()})]},ee.id)):i.jsx("li",{className:"dropdown-item",children:"No new notifications"})}),i.jsxs("div",{className:"dropdown-footer",children:[i.jsx("button",{onClick:()=>l("/dashboard/notifications"),children:"View All"}),(e.role==="admin"||e.role==="superadmin")&&i.jsx("button",{onClick:H,className:"fetch-all-button",disabled:T,children:T?"Fetching...":"Fetch All"})]})]})]}),i.jsx("button",{className:"hamburger-icon",onClick:V,"aria-label":"Open navigation",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})})]})]}),i.jsx("main",{className:"main-content",children:t}),u?i.jsx(SI,{user:e,onLogout:n,userRole:e.role,isOpen:f,onClose:V,roleNavigation:wk}):i.jsx(wI,{user:e,onLogout:n,userRole:e.role,isOpen:f,onClose:V}),!u&&f&&i.jsx("div",{className:"side-panel-overlay",onClick:V})]})};LP.createRoot(document.getElementById("root")).render(i.jsx(w.StrictMode,{children:i.jsx(Die,{})}));
