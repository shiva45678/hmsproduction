var _A=Object.defineProperty;var CA=(e,n,t)=>n in e?_A(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var ri=(e,n,t)=>CA(e,typeof n!="symbol"?n+"":n,t);function kA(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const o=Object.getOwnPropertyDescriptor(r,a);o&&Object.defineProperty(e,a,o.get?o:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();var fu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Vv={exports:{}},Dm={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uN;function EA(){if(uN)return Dm;uN=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function t(r,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var h in a)h!=="key"&&(o[h]=a[h])}else o=a;return a=o.ref,{$$typeof:e,type:r,key:l,ref:a!==void 0?a:null,props:o}}return Dm.Fragment=n,Dm.jsx=t,Dm.jsxs=t,Dm}var dN;function TA(){return dN||(dN=1,Vv.exports=EA()),Vv.exports}var i=TA(),Hv={exports:{}},cn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hN;function AA(){if(hN)return cn;hN=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),g=Symbol.iterator;function b(D){return D===null||typeof D!="object"?null:(D=g&&D[g]||D["@@iterator"],typeof D=="function"?D:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,k={};function T(D,te,ve){this.props=D,this.context=te,this.refs=k,this.updater=ve||v}T.prototype.isReactComponent={},T.prototype.setState=function(D,te){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,te,"setState")},T.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function E(){}E.prototype=T.prototype;function P(D,te,ve){this.props=D,this.context=te,this.refs=k,this.updater=ve||v}var I=P.prototype=new E;I.constructor=P,S(I,T.prototype),I.isPureReactComponent=!0;var q=Array.isArray,$={H:null,A:null,T:null,S:null,V:null},L=Object.prototype.hasOwnProperty;function F(D,te,ve,M,ge,_e){return ve=_e.ref,{$$typeof:e,type:D,key:te,ref:ve!==void 0?ve:null,props:_e}}function z(D,te){return F(D.type,te,void 0,void 0,void 0,D.props)}function B(D){return typeof D=="object"&&D!==null&&D.$$typeof===e}function R(D){var te={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(ve){return te[ve]})}var U=/\/+/g;function Y(D,te){return typeof D=="object"&&D!==null&&D.key!=null?R(""+D.key):te.toString(36)}function Z(){}function ne(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(Z,Z):(D.status="pending",D.then(function(te){D.status==="pending"&&(D.status="fulfilled",D.value=te)},function(te){D.status==="pending"&&(D.status="rejected",D.reason=te)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function ae(D,te,ve,M,ge){var _e=typeof D;(_e==="undefined"||_e==="boolean")&&(D=null);var se=!1;if(D===null)se=!0;else switch(_e){case"bigint":case"string":case"number":se=!0;break;case"object":switch(D.$$typeof){case e:case n:se=!0;break;case f:return se=D._init,ae(se(D._payload),te,ve,M,ge)}}if(se)return ge=ge(D),se=M===""?"."+Y(D,0):M,q(ge)?(ve="",se!=null&&(ve=se.replace(U,"$&/")+"/"),ae(ge,te,ve,"",function(ue){return ue})):ge!=null&&(B(ge)&&(ge=z(ge,ve+(ge.key==null||D&&D.key===ge.key?"":(""+ge.key).replace(U,"$&/")+"/")+se)),te.push(ge)),1;se=0;var ee=M===""?".":M+":";if(q(D))for(var oe=0;oe<D.length;oe++)M=D[oe],_e=ee+Y(M,oe),se+=ae(M,te,ve,_e,ge);else if(oe=b(D),typeof oe=="function")for(D=oe.call(D),oe=0;!(M=D.next()).done;)M=M.value,_e=ee+Y(M,oe++),se+=ae(M,te,ve,_e,ge);else if(_e==="object"){if(typeof D.then=="function")return ae(ne(D),te,ve,M,ge);throw te=String(D),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.")}return se}function X(D,te,ve){if(D==null)return D;var M=[],ge=0;return ae(D,M,"","",function(_e){return te.call(ve,_e,ge++)}),M}function W(D){if(D._status===-1){var te=D._result;te=te(),te.then(function(ve){(D._status===0||D._status===-1)&&(D._status=1,D._result=ve)},function(ve){(D._status===0||D._status===-1)&&(D._status=2,D._result=ve)}),D._status===-1&&(D._status=0,D._result=te)}if(D._status===1)return D._result.default;throw D._result}var H=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var te=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(te))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)};function he(){}return cn.Children={map:X,forEach:function(D,te,ve){X(D,function(){te.apply(this,arguments)},ve)},count:function(D){var te=0;return X(D,function(){te++}),te},toArray:function(D){return X(D,function(te){return te})||[]},only:function(D){if(!B(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},cn.Component=T,cn.Fragment=t,cn.Profiler=a,cn.PureComponent=P,cn.StrictMode=r,cn.Suspense=d,cn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=$,cn.__COMPILER_RUNTIME={__proto__:null,c:function(D){return $.H.useMemoCache(D)}},cn.cache=function(D){return function(){return D.apply(null,arguments)}},cn.cloneElement=function(D,te,ve){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var M=S({},D.props),ge=D.key,_e=void 0;if(te!=null)for(se in te.ref!==void 0&&(_e=void 0),te.key!==void 0&&(ge=""+te.key),te)!L.call(te,se)||se==="key"||se==="__self"||se==="__source"||se==="ref"&&te.ref===void 0||(M[se]=te[se]);var se=arguments.length-2;if(se===1)M.children=ve;else if(1<se){for(var ee=Array(se),oe=0;oe<se;oe++)ee[oe]=arguments[oe+2];M.children=ee}return F(D.type,ge,void 0,void 0,_e,M)},cn.createContext=function(D){return D={$$typeof:l,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:o,_context:D},D},cn.createElement=function(D,te,ve){var M,ge={},_e=null;if(te!=null)for(M in te.key!==void 0&&(_e=""+te.key),te)L.call(te,M)&&M!=="key"&&M!=="__self"&&M!=="__source"&&(ge[M]=te[M]);var se=arguments.length-2;if(se===1)ge.children=ve;else if(1<se){for(var ee=Array(se),oe=0;oe<se;oe++)ee[oe]=arguments[oe+2];ge.children=ee}if(D&&D.defaultProps)for(M in se=D.defaultProps,se)ge[M]===void 0&&(ge[M]=se[M]);return F(D,_e,void 0,void 0,null,ge)},cn.createRef=function(){return{current:null}},cn.forwardRef=function(D){return{$$typeof:h,render:D}},cn.isValidElement=B,cn.lazy=function(D){return{$$typeof:f,_payload:{_status:-1,_result:D},_init:W}},cn.memo=function(D,te){return{$$typeof:u,type:D,compare:te===void 0?null:te}},cn.startTransition=function(D){var te=$.T,ve={};$.T=ve;try{var M=D(),ge=$.S;ge!==null&&ge(ve,M),typeof M=="object"&&M!==null&&typeof M.then=="function"&&M.then(he,H)}catch(_e){H(_e)}finally{$.T=te}},cn.unstable_useCacheRefresh=function(){return $.H.useCacheRefresh()},cn.use=function(D){return $.H.use(D)},cn.useActionState=function(D,te,ve){return $.H.useActionState(D,te,ve)},cn.useCallback=function(D,te){return $.H.useCallback(D,te)},cn.useContext=function(D){return $.H.useContext(D)},cn.useDebugValue=function(){},cn.useDeferredValue=function(D,te){return $.H.useDeferredValue(D,te)},cn.useEffect=function(D,te,ve){var M=$.H;if(typeof ve=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return M.useEffect(D,te)},cn.useId=function(){return $.H.useId()},cn.useImperativeHandle=function(D,te,ve){return $.H.useImperativeHandle(D,te,ve)},cn.useInsertionEffect=function(D,te){return $.H.useInsertionEffect(D,te)},cn.useLayoutEffect=function(D,te){return $.H.useLayoutEffect(D,te)},cn.useMemo=function(D,te){return $.H.useMemo(D,te)},cn.useOptimistic=function(D,te){return $.H.useOptimistic(D,te)},cn.useReducer=function(D,te,ve){return $.H.useReducer(D,te,ve)},cn.useRef=function(D){return $.H.useRef(D)},cn.useState=function(D){return $.H.useState(D)},cn.useSyncExternalStore=function(D,te,ve){return $.H.useSyncExternalStore(D,te,ve)},cn.useTransition=function(){return $.H.useTransition()},cn.version="19.1.0",cn}var fN;function rw(){return fN||(fN=1,Hv.exports=AA()),Hv.exports}var w=rw();const Pn=qd(w),pN=kA({__proto__:null,default:Pn},[w]);var Gv={exports:{}},Pm={},Yv={exports:{}},Wv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mN;function DA(){return mN||(mN=1,function(e){function n(X,W){var H=X.length;X.push(W);e:for(;0<H;){var he=H-1>>>1,D=X[he];if(0<a(D,W))X[he]=W,X[H]=D,H=he;else break e}}function t(X){return X.length===0?null:X[0]}function r(X){if(X.length===0)return null;var W=X[0],H=X.pop();if(H!==W){X[0]=H;e:for(var he=0,D=X.length,te=D>>>1;he<te;){var ve=2*(he+1)-1,M=X[ve],ge=ve+1,_e=X[ge];if(0>a(M,H))ge<D&&0>a(_e,M)?(X[he]=_e,X[ge]=H,he=ge):(X[he]=M,X[ve]=H,he=ve);else if(ge<D&&0>a(_e,H))X[he]=_e,X[ge]=H,he=ge;else break e}}return W}function a(X,W){var H=X.sortIndex-W.sortIndex;return H!==0?H:X.id-W.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,h=l.now();e.unstable_now=function(){return l.now()-h}}var d=[],u=[],f=1,g=null,b=3,v=!1,S=!1,k=!1,T=!1,E=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function q(X){for(var W=t(u);W!==null;){if(W.callback===null)r(u);else if(W.startTime<=X)r(u),W.sortIndex=W.expirationTime,n(d,W);else break;W=t(u)}}function $(X){if(k=!1,q(X),!S)if(t(d)!==null)S=!0,L||(L=!0,Y());else{var W=t(u);W!==null&&ae($,W.startTime-X)}}var L=!1,F=-1,z=5,B=-1;function R(){return T?!0:!(e.unstable_now()-B<z)}function U(){if(T=!1,L){var X=e.unstable_now();B=X;var W=!0;try{e:{S=!1,k&&(k=!1,P(F),F=-1),v=!0;var H=b;try{t:{for(q(X),g=t(d);g!==null&&!(g.expirationTime>X&&R());){var he=g.callback;if(typeof he=="function"){g.callback=null,b=g.priorityLevel;var D=he(g.expirationTime<=X);if(X=e.unstable_now(),typeof D=="function"){g.callback=D,q(X),W=!0;break t}g===t(d)&&r(d),q(X)}else r(d);g=t(d)}if(g!==null)W=!0;else{var te=t(u);te!==null&&ae($,te.startTime-X),W=!1}}break e}finally{g=null,b=H,v=!1}W=void 0}}finally{W?Y():L=!1}}}var Y;if(typeof I=="function")Y=function(){I(U)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,ne=Z.port2;Z.port1.onmessage=U,Y=function(){ne.postMessage(null)}}else Y=function(){E(U,0)};function ae(X,W){F=E(function(){X(e.unstable_now())},W)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(X){X.callback=null},e.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<X?Math.floor(1e3/X):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(X){switch(b){case 1:case 2:case 3:var W=3;break;default:W=b}var H=b;b=W;try{return X()}finally{b=H}},e.unstable_requestPaint=function(){T=!0},e.unstable_runWithPriority=function(X,W){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var H=b;b=X;try{return W()}finally{b=H}},e.unstable_scheduleCallback=function(X,W,H){var he=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?he+H:he):H=he,X){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=H+D,X={id:f++,callback:W,priorityLevel:X,startTime:H,expirationTime:D,sortIndex:-1},H>he?(X.sortIndex=H,n(u,X),t(d)===null&&X===t(u)&&(k?(P(F),F=-1):k=!0,ae($,H-he))):(X.sortIndex=D,n(d,X),S||v||(S=!0,L||(L=!0,Y()))),X},e.unstable_shouldYield=R,e.unstable_wrapCallback=function(X){var W=b;return function(){var H=b;b=W;try{return X.apply(this,arguments)}finally{b=H}}}}(Wv)),Wv}var gN;function PA(){return gN||(gN=1,Yv.exports=DA()),Yv.exports}var Qv={exports:{}},Ur={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yN;function IA(){if(yN)return Ur;yN=1;var e=rw();function n(d){var u="https://react.dev/errors/"+d;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)u+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+d+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(n(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(d,u,f){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:g==null?null:""+g,children:d,containerInfo:u,implementation:f}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(d,u){if(d==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return Ur.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Ur.createPortal=function(d,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(n(299));return o(d,u,null,f)},Ur.flushSync=function(d){var u=l.T,f=r.p;try{if(l.T=null,r.p=2,d)return d()}finally{l.T=u,r.p=f,r.d.f()}},Ur.preconnect=function(d,u){typeof d=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,r.d.C(d,u))},Ur.prefetchDNS=function(d){typeof d=="string"&&r.d.D(d)},Ur.preinit=function(d,u){if(typeof d=="string"&&u&&typeof u.as=="string"){var f=u.as,g=h(f,u.crossOrigin),b=typeof u.integrity=="string"?u.integrity:void 0,v=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;f==="style"?r.d.S(d,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:g,integrity:b,fetchPriority:v}):f==="script"&&r.d.X(d,{crossOrigin:g,integrity:b,fetchPriority:v,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},Ur.preinitModule=function(d,u){if(typeof d=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var f=h(u.as,u.crossOrigin);r.d.M(d,{crossOrigin:f,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&r.d.M(d)},Ur.preload=function(d,u){if(typeof d=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var f=u.as,g=h(f,u.crossOrigin);r.d.L(d,f,{crossOrigin:g,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},Ur.preloadModule=function(d,u){if(typeof d=="string")if(u){var f=h(u.as,u.crossOrigin);r.d.m(d,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:f,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else r.d.m(d)},Ur.requestFormReset=function(d){r.d.r(d)},Ur.unstable_batchedUpdates=function(d,u){return d(u)},Ur.useFormState=function(d,u,f){return l.H.useFormState(d,u,f)},Ur.useFormStatus=function(){return l.H.useHostTransitionStatus()},Ur.version="19.1.0",Ur}var xN;function wC(){if(xN)return Qv.exports;xN=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),Qv.exports=IA(),Qv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bN;function MA(){if(bN)return Pm;bN=1;var e=PA(),n=rw(),t=wC();function r(s){var c="https://react.dev/errors/"+s;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)c+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+s+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var c=s,p=s;if(s.alternate)for(;c.return;)c=c.return;else{s=c;do c=s,(c.flags&4098)!==0&&(p=c.return),s=c.return;while(s)}return c.tag===3?p:null}function l(s){if(s.tag===13){var c=s.memoizedState;if(c===null&&(s=s.alternate,s!==null&&(c=s.memoizedState)),c!==null)return c.dehydrated}return null}function h(s){if(o(s)!==s)throw Error(r(188))}function d(s){var c=s.alternate;if(!c){if(c=o(s),c===null)throw Error(r(188));return c!==s?null:s}for(var p=s,x=c;;){var N=p.return;if(N===null)break;var A=N.alternate;if(A===null){if(x=N.return,x!==null){p=x;continue}break}if(N.child===A.child){for(A=N.child;A;){if(A===p)return h(N),s;if(A===x)return h(N),c;A=A.sibling}throw Error(r(188))}if(p.return!==x.return)p=N,x=A;else{for(var V=!1,K=N.child;K;){if(K===p){V=!0,p=N,x=A;break}if(K===x){V=!0,x=N,p=A;break}K=K.sibling}if(!V){for(K=A.child;K;){if(K===p){V=!0,p=A,x=N;break}if(K===x){V=!0,x=A,p=N;break}K=K.sibling}if(!V)throw Error(r(189))}}if(p.alternate!==x)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?s:c}function u(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s;for(s=s.child;s!==null;){if(c=u(s),c!==null)return c;s=s.sibling}return null}var f=Object.assign,g=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),P=Symbol.for("react.consumer"),I=Symbol.for("react.context"),q=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),R=Symbol.for("react.memo_cache_sentinel"),U=Symbol.iterator;function Y(s){return s===null||typeof s!="object"?null:(s=U&&s[U]||s["@@iterator"],typeof s=="function"?s:null)}var Z=Symbol.for("react.client.reference");function ne(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===Z?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case S:return"Fragment";case T:return"Profiler";case k:return"StrictMode";case $:return"Suspense";case L:return"SuspenseList";case B:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case v:return"Portal";case I:return(s.displayName||"Context")+".Provider";case P:return(s._context.displayName||"Context")+".Consumer";case q:var c=s.render;return s=s.displayName,s||(s=c.displayName||c.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case F:return c=s.displayName||null,c!==null?c:ne(s.type)||"Memo";case z:c=s._payload,s=s._init;try{return ne(s(c))}catch{}}return null}var ae=Array.isArray,X=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H={pending:!1,data:null,method:null,action:null},he=[],D=-1;function te(s){return{current:s}}function ve(s){0>D||(s.current=he[D],he[D]=null,D--)}function M(s,c){D++,he[D]=s.current,s.current=c}var ge=te(null),_e=te(null),se=te(null),ee=te(null);function oe(s,c){switch(M(se,c),M(_e,s),M(ge,null),c.nodeType){case 9:case 11:s=(s=c.documentElement)&&(s=s.namespaceURI)?gi(s):0;break;default:if(s=c.tagName,c=c.namespaceURI)c=gi(c),s=Ni(c,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ve(ge),M(ge,s)}function ue(){ve(ge),ve(_e),ve(se)}function Ee(s){s.memoizedState!==null&&M(ee,s);var c=ge.current,p=Ni(c,s.type);c!==p&&(M(_e,s),M(ge,p))}function Ie(s){_e.current===s&&(ve(ge),ve(_e)),ee.current===s&&(ve(ee),su._currentValue=H)}var fe=Object.prototype.hasOwnProperty,pe=e.unstable_scheduleCallback,Re=e.unstable_cancelCallback,Ye=e.unstable_shouldYield,ut=e.unstable_requestPaint,Ge=e.unstable_now,Se=e.unstable_getCurrentPriorityLevel,qe=e.unstable_ImmediatePriority,Ue=e.unstable_UserBlockingPriority,ze=e.unstable_NormalPriority,lt=e.unstable_LowPriority,Ke=e.unstable_IdlePriority,pt=e.log,Te=e.unstable_setDisableYieldValue,ie=null,xe=null;function Qe(s){if(typeof pt=="function"&&Te(s),xe&&typeof xe.setStrictMode=="function")try{xe.setStrictMode(ie,s)}catch{}}var we=Math.clz32?Math.clz32:at,Pe=Math.log,Je=Math.LN2;function at(s){return s>>>=0,s===0?32:31-(Pe(s)/Je|0)|0}var ft=256,Ae=4194304;function Ve(s){var c=s&42;if(c!==0)return c;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function $e(s,c,p){var x=s.pendingLanes;if(x===0)return 0;var N=0,A=s.suspendedLanes,V=s.pingedLanes;s=s.warmLanes;var K=x&134217727;return K!==0?(x=K&~A,x!==0?N=Ve(x):(V&=K,V!==0?N=Ve(V):p||(p=K&~s,p!==0&&(N=Ve(p))))):(K=x&~A,K!==0?N=Ve(K):V!==0?N=Ve(V):p||(p=x&~s,p!==0&&(N=Ve(p)))),N===0?0:c!==0&&c!==N&&(c&A)===0&&(A=N&-N,p=c&-c,A>=p||A===32&&(p&4194048)!==0)?c:N}function We(s,c){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&c)===0}function ct(s,c){switch(s){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dt(){var s=ft;return ft<<=1,(ft&4194048)===0&&(ft=256),s}function wt(){var s=Ae;return Ae<<=1,(Ae&62914560)===0&&(Ae=4194304),s}function bt(s){for(var c=[],p=0;31>p;p++)c.push(s);return c}function kt(s,c){s.pendingLanes|=c,c!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Tt(s,c,p,x,N,A){var V=s.pendingLanes;s.pendingLanes=p,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=p,s.entangledLanes&=p,s.errorRecoveryDisabledLanes&=p,s.shellSuspendCounter=0;var K=s.entanglements,ye=s.expirationTimes,Le=s.hiddenUpdates;for(p=V&~p;0<p;){var et=31-we(p),st=1<<et;K[et]=0,ye[et]=-1;var Be=Le[et];if(Be!==null)for(Le[et]=null,et=0;et<Be.length;et++){var Fe=Be[et];Fe!==null&&(Fe.lane&=-536870913)}p&=~st}x!==0&&It(s,x,0),A!==0&&N===0&&s.tag!==0&&(s.suspendedLanes|=A&~(V&~c))}function It(s,c,p){s.pendingLanes|=c,s.suspendedLanes&=~c;var x=31-we(c);s.entangledLanes|=c,s.entanglements[x]=s.entanglements[x]|1073741824|p&4194090}function mt(s,c){var p=s.entangledLanes|=c;for(s=s.entanglements;p;){var x=31-we(p),N=1<<x;N&c|s[x]&c&&(s[x]|=c),p&=~N}}function $t(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function en(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function be(){var s=W.p;return s!==0?s:(s=window.event,s===void 0?32:px(s.type))}function nt(s,c){var p=W.p;try{return W.p=s,c()}finally{W.p=p}}var Ze=Math.random().toString(36).slice(2),Pt="__reactFiber$"+Ze,Ut="__reactProps$"+Ze,hn="__reactContainer$"+Ze,Ln="__reactEvents$"+Ze,Qn="__reactListeners$"+Ze,Oi="__reactHandles$"+Ze,Si="__reactResources$"+Ze,hr="__reactMarker$"+Ze;function ss(s){delete s[Pt],delete s[Ut],delete s[Ln],delete s[Qn],delete s[Oi]}function ni(s){var c=s[Pt];if(c)return c;for(var p=s.parentNode;p;){if(c=p[hn]||p[Pt]){if(p=c.alternate,c.child!==null||p!==null&&p.child!==null)for(s=nx(s);s!==null;){if(p=s[Pt])return p;s=nx(s)}return c}s=p,p=s.parentNode}return null}function gn(s){if(s=s[Pt]||s[hn]){var c=s.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return s}return null}function Pi(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s.stateNode;throw Error(r(33))}function er(s){var c=s[Si];return c||(c=s[Si]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function oi(s){s[hr]=!0}var vi=new Set,sa={};function fr(s,c){oa(s,c),oa(s+"Capture",c)}function oa(s,c){for(sa[s]=c,s=0;s<c.length;s++)vi.add(c[s])}var os=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Is={},la={};function Yd(s){return fe.call(la,s)?!0:fe.call(Is,s)?!1:os.test(s)?la[s]=!0:(Is[s]=!0,!1)}function gl(s,c,p){if(Yd(c))if(p===null)s.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":s.removeAttribute(c);return;case"boolean":var x=c.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){s.removeAttribute(c);return}}s.setAttribute(c,""+p)}}function Ms(s,c,p){if(p===null)s.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttribute(c,""+p)}}function ca(s,c,p,x){if(x===null)s.removeAttribute(p);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(p);return}s.setAttributeNS(c,p,""+x)}}var hc,fc;function vo(s){if(hc===void 0)try{throw Error()}catch(p){var c=p.stack.trim().match(/\n( *(at )?)/);hc=c&&c[1]||"",fc=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+hc+s+fc}var pc=!1;function Nu(s,c){if(!s||pc)return"";pc=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(c){var st=function(){throw Error()};if(Object.defineProperty(st.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(st,[])}catch(Fe){var Be=Fe}Reflect.construct(s,[],st)}else{try{st.call()}catch(Fe){Be=Fe}s.call(st.prototype)}}else{try{throw Error()}catch(Fe){Be=Fe}(st=s())&&typeof st.catch=="function"&&st.catch(function(){})}}catch(Fe){if(Fe&&Be&&typeof Fe.stack=="string")return[Fe.stack,Be.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=x.DetermineComponentFrameRoot(),V=A[0],K=A[1];if(V&&K){var ye=V.split(`
`),Le=K.split(`
`);for(N=x=0;x<ye.length&&!ye[x].includes("DetermineComponentFrameRoot");)x++;for(;N<Le.length&&!Le[N].includes("DetermineComponentFrameRoot");)N++;if(x===ye.length||N===Le.length)for(x=ye.length-1,N=Le.length-1;1<=x&&0<=N&&ye[x]!==Le[N];)N--;for(;1<=x&&0<=N;x--,N--)if(ye[x]!==Le[N]){if(x!==1||N!==1)do if(x--,N--,0>N||ye[x]!==Le[N]){var et=`
`+ye[x].replace(" at new "," at ");return s.displayName&&et.includes("<anonymous>")&&(et=et.replace("<anonymous>",s.displayName)),et}while(1<=x&&0<=N);break}}}finally{pc=!1,Error.prepareStackTrace=p}return(p=s?s.displayName||s.name:"")?vo(p):""}function Wd(s){switch(s.tag){case 26:case 27:case 5:return vo(s.type);case 16:return vo("Lazy");case 13:return vo("Suspense");case 19:return vo("SuspenseList");case 0:case 15:return Nu(s.type,!1);case 11:return Nu(s.type.render,!1);case 1:return Nu(s.type,!0);case 31:return vo("Activity");default:return""}}function mc(s){try{var c="";do c+=Wd(s),s=s.return;while(s);return c}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function pr(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Rs(s){var c=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function gc(s){var c=Rs(s)?"checked":"value",p=Object.getOwnPropertyDescriptor(s.constructor.prototype,c),x=""+s[c];if(!s.hasOwnProperty(c)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var N=p.get,A=p.set;return Object.defineProperty(s,c,{configurable:!0,get:function(){return N.call(this)},set:function(V){x=""+V,A.call(this,V)}}),Object.defineProperty(s,c,{enumerable:p.enumerable}),{getValue:function(){return x},setValue:function(V){x=""+V},stopTracking:function(){s._valueTracker=null,delete s[c]}}}}function Os(s){s._valueTracker||(s._valueTracker=gc(s))}function yc(s){if(!s)return!1;var c=s._valueTracker;if(!c)return!0;var p=c.getValue(),x="";return s&&(x=Rs(s)?s.checked?"true":"false":s.value),s=x,s!==p?(c.setValue(s),!0):!1}function ua(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Su=/[\n"\\]/g;function tr(s){return s.replace(Su,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function yl(s,c,p,x,N,A,V,K){s.name="",V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"?s.type=V:s.removeAttribute("type"),c!=null?V==="number"?(c===0&&s.value===""||s.value!=c)&&(s.value=""+pr(c)):s.value!==""+pr(c)&&(s.value=""+pr(c)):V!=="submit"&&V!=="reset"||s.removeAttribute("value"),c!=null?No(s,V,pr(c)):p!=null?No(s,V,pr(p)):x!=null&&s.removeAttribute("value"),N==null&&A!=null&&(s.defaultChecked=!!A),N!=null&&(s.checked=N&&typeof N!="function"&&typeof N!="symbol"),K!=null&&typeof K!="function"&&typeof K!="symbol"&&typeof K!="boolean"?s.name=""+pr(K):s.removeAttribute("name")}function wo(s,c,p,x,N,A,V,K){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(s.type=A),c!=null||p!=null){if(!(A!=="submit"&&A!=="reset"||c!=null))return;p=p!=null?""+pr(p):"",c=c!=null?""+pr(c):p,K||c===s.value||(s.value=c),s.defaultValue=c}x=x??N,x=typeof x!="function"&&typeof x!="symbol"&&!!x,s.checked=K?s.checked:!!x,s.defaultChecked=!!x,V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"&&(s.name=V)}function No(s,c,p){c==="number"&&ua(s.ownerDocument)===s||s.defaultValue===""+p||(s.defaultValue=""+p)}function Ia(s,c,p,x){if(s=s.options,c){c={};for(var N=0;N<p.length;N++)c["$"+p[N]]=!0;for(p=0;p<s.length;p++)N=c.hasOwnProperty("$"+s[p].value),s[p].selected!==N&&(s[p].selected=N),N&&x&&(s[p].defaultSelected=!0)}else{for(p=""+pr(p),c=null,N=0;N<s.length;N++){if(s[N].value===p){s[N].selected=!0,x&&(s[N].defaultSelected=!0);return}c!==null||s[N].disabled||(c=s[N])}c!==null&&(c.selected=!0)}}function So(s,c,p){if(c!=null&&(c=""+pr(c),c!==s.value&&(s.value=c),p==null)){s.defaultValue!==c&&(s.defaultValue=c);return}s.defaultValue=p!=null?""+pr(p):""}function Ls(s,c,p,x){if(c==null){if(x!=null){if(p!=null)throw Error(r(92));if(ae(x)){if(1<x.length)throw Error(r(93));x=x[0]}p=x}p==null&&(p=""),c=p}p=pr(c),s.defaultValue=p,x=s.textContent,x===p&&x!==""&&x!==null&&(s.value=x)}function ls(s,c){if(c){var p=s.firstChild;if(p&&p===s.lastChild&&p.nodeType===3){p.nodeValue=c;return}}s.textContent=c}var Ma=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function xl(s,c,p){var x=c.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?x?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="":x?s.setProperty(c,p):typeof p!="number"||p===0||Ma.has(c)?c==="float"?s.cssFloat=p:s[c]=(""+p).trim():s[c]=p+"px"}function bl(s,c,p){if(c!=null&&typeof c!="object")throw Error(r(62));if(s=s.style,p!=null){for(var x in p)!p.hasOwnProperty(x)||c!=null&&c.hasOwnProperty(x)||(x.indexOf("--")===0?s.setProperty(x,""):x==="float"?s.cssFloat="":s[x]="");for(var N in c)x=c[N],c.hasOwnProperty(N)&&p[N]!==x&&xl(s,N,x)}else for(var A in c)c.hasOwnProperty(A)&&xl(s,A,c[A])}function cs(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vl=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),xc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Fs(s){return xc.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var jo=null;function wl(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var sr=null,us=null;function bc(s){var c=gn(s);if(c&&(s=c.stateNode)){var p=s[Ut]||null;e:switch(s=c.stateNode,c.type){case"input":if(yl(s,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),c=p.name,p.type==="radio"&&c!=null){for(p=s;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+tr(""+c)+'"][type="radio"]'),c=0;c<p.length;c++){var x=p[c];if(x!==s&&x.form===s.form){var N=x[Ut]||null;if(!N)throw Error(r(90));yl(x,N.value,N.defaultValue,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name)}}for(c=0;c<p.length;c++)x=p[c],x.form===s.form&&yc(x)}break e;case"textarea":So(s,p.value,p.defaultValue);break e;case"select":c=p.value,c!=null&&Ia(s,!!p.multiple,c,!1)}}}var Ra=!1;function _o(s,c,p){if(Ra)return s(c,p);Ra=!0;try{var x=s(c);return x}finally{if(Ra=!1,(sr!==null||us!==null)&&(Yh(),sr&&(c=sr,s=us,us=sr=null,bc(c),s)))for(c=0;c<s.length;c++)bc(s[c])}}function Nl(s,c){var p=s.stateNode;if(p===null)return null;var x=p[Ut]||null;if(x===null)return null;p=x[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(s=s.type,x=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!x;break e;default:s=!1}if(s)return null;if(p&&typeof p!="function")throw Error(r(231,c,typeof p));return p}var kr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Co=!1;if(kr)try{var $s={};Object.defineProperty($s,"passive",{get:function(){Co=!0}}),window.addEventListener("test",$s,$s),window.removeEventListener("test",$s,$s)}catch{Co=!1}var da=null,vc=null,zs=null;function Qd(){if(zs)return zs;var s,c=vc,p=c.length,x,N="value"in da?da.value:da.textContent,A=N.length;for(s=0;s<p&&c[s]===N[s];s++);var V=p-s;for(x=1;x<=V&&c[p-x]===N[A-x];x++);return zs=N.slice(s,1<x?1-x:void 0)}function Mn(s){var c=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&c===13&&(s=13)):s=c,s===10&&(s=13),32<=s||s===13?s:0}function Tn(){return!0}function ju(){return!1}function nn(s){function c(p,x,N,A,V){this._reactName=p,this._targetInst=N,this.type=x,this.nativeEvent=A,this.target=V,this.currentTarget=null;for(var K in s)s.hasOwnProperty(K)&&(p=s[K],this[K]=p?p(A):A[K]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?Tn:ju,this.isPropagationStopped=ju,this}return f(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Tn)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Tn)},persist:function(){},isPersistent:Tn}),c}var Oa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bs=nn(Oa),Us=f({},Oa,{view:0,detail:0}),Sl=nn(Us),ds,_u,hi,Qr=f({},Us,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gi,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==hi&&(hi&&s.type==="mousemove"?(ds=s.screenX-hi.screenX,_u=s.screenY-hi.screenY):_u=ds=0,hi=s),ds)},movementY:function(s){return"movementY"in s?s.movementY:_u}}),La=nn(Qr),wc=f({},Qr,{dataTransfer:0}),ko=nn(wc),Li=f({},Us,{relatedTarget:0}),jl=nn(Li),Fa=f({},Oa,{animationName:0,elapsedTime:0,pseudoElement:0}),_l=nn(Fa),Jd=f({},Oa,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Kd=nn(Jd),Cl=f({},Oa,{data:0}),nr=nn(Cl),Eo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Er={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qs(s){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(s):(s=Xd[s])?!!c[s]:!1}function Gi(){return qs}var hs=f({},Us,{key:function(s){if(s.key){var c=Eo[s.key]||s.key;if(c!=="Unidentified")return c}return s.type==="keypress"?(s=Mn(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Er[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gi,charCode:function(s){return s.type==="keypress"?Mn(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Mn(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),kl=nn(hs),Jn=f({},Qr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Tr=nn(Jn),Nc=f({},Us,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gi}),sp=nn(Nc),Cu=f({},Oa,{propertyName:0,elapsedTime:0,pseudoElement:0}),op=nn(Cu),lp=f({},Qr,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),cp=nn(lp),Zd=f({},Oa,{newState:0,oldState:0}),Sc=nn(Zd),To=[9,13,27,32],ku=kr&&"CompositionEvent"in window,Ao=null;kr&&"documentMode"in document&&(Ao=document.documentMode);var jc=kr&&"TextEvent"in window&&!Ao,Do=kr&&(!ku||Ao&&8<Ao&&11>=Ao),El=" ",Eu=!1;function Tl(s,c){switch(s){case"keyup":return To.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _c(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var fs=!1;function up(s,c){switch(s){case"compositionend":return _c(c);case"keypress":return c.which!==32?null:(Eu=!0,El);case"textInput":return s=c.data,s===El&&Eu?null:s;default:return null}}function eh(s,c){if(fs)return s==="compositionend"||!ku&&Tl(s,c)?(s=Qd(),zs=vc=da=null,fs=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Do&&c.locale!=="ko"?null:c.data;default:return null}}var mr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jr(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c==="input"?!!mr[s.type]:c==="textarea"}function gr(s,c,p,x){sr?us?us.push(x):us=[x]:sr=x,c=ef(c,"onChange"),0<c.length&&(p=new Bs("onChange","change",null,p,x),s.push({event:p,listeners:c}))}var or=null,$a=null;function th(s){Wy(s,0)}function Al(s){var c=Pi(s);if(yc(c))return s}function Tu(s,c){if(s==="change")return c}var Cc=!1;if(kr){var kc;if(kr){var za="oninput"in document;if(!za){var nh=document.createElement("div");nh.setAttribute("oninput","return;"),za=typeof nh.oninput=="function"}kc=za}else kc=!1;Cc=kc&&(!document.documentMode||9<document.documentMode)}function ih(){or&&(or.detachEvent("onpropertychange",Dl),$a=or=null)}function Dl(s){if(s.propertyName==="value"&&Al($a)){var c=[];gr(c,$a,s,wl(s)),_o(th,c)}}function rh(s,c,p){s==="focusin"?(ih(),or=c,$a=p,or.attachEvent("onpropertychange",Dl)):s==="focusout"&&ih()}function ps(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Al($a)}function Ec(s,c){if(s==="click")return Al(c)}function dp(s,c){if(s==="input"||s==="change")return Al(c)}function hp(s,c){return s===c&&(s!==0||1/s===1/c)||s!==s&&c!==c}var yr=typeof Object.is=="function"?Object.is:hp;function ir(s,c){if(yr(s,c))return!0;if(typeof s!="object"||s===null||typeof c!="object"||c===null)return!1;var p=Object.keys(s),x=Object.keys(c);if(p.length!==x.length)return!1;for(x=0;x<p.length;x++){var N=p[x];if(!fe.call(c,N)||!yr(s[N],c[N]))return!1}return!0}function Ar(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Au(s,c){var p=Ar(s);s=0;for(var x;p;){if(p.nodeType===3){if(x=s+p.textContent.length,s<=c&&x>=c)return{node:p,offset:c-s};s=x}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Ar(p)}}function ah(s,c){return s&&c?s===c?!0:s&&s.nodeType===3?!1:c&&c.nodeType===3?ah(s,c.parentNode):"contains"in s?s.contains(c):s.compareDocumentPosition?!!(s.compareDocumentPosition(c)&16):!1:!1}function sh(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var c=ua(s.document);c instanceof s.HTMLIFrameElement;){try{var p=typeof c.contentWindow.location.href=="string"}catch{p=!1}if(p)s=c.contentWindow;else break;c=ua(s.document)}return c}function Pl(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c&&(c==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||c==="textarea"||s.contentEditable==="true")}var fp=kr&&"documentMode"in document&&11>=document.documentMode,Po=null,ms=null,ke=null,Xe=!1;function He(s,c,p){var x=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;Xe||Po==null||Po!==ua(x)||(x=Po,"selectionStart"in x&&Pl(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),ke&&ir(ke,x)||(ke=x,x=ef(ms,"onSelect"),0<x.length&&(c=new Bs("onSelect","select",null,c,p),s.push({event:c,listeners:x}),c.target=Po)))}function jt(s,c){var p={};return p[s.toLowerCase()]=c.toLowerCase(),p["Webkit"+s]="webkit"+c,p["Moz"+s]="moz"+c,p}var zt={animationend:jt("Animation","AnimationEnd"),animationiteration:jt("Animation","AnimationIteration"),animationstart:jt("Animation","AnimationStart"),transitionrun:jt("Transition","TransitionRun"),transitionstart:jt("Transition","TransitionStart"),transitioncancel:jt("Transition","TransitionCancel"),transitionend:jt("Transition","TransitionEnd")},bn={},wi={};kr&&(wi=document.createElement("div").style,"AnimationEvent"in window||(delete zt.animationend.animation,delete zt.animationiteration.animation,delete zt.animationstart.animation),"TransitionEvent"in window||delete zt.transitionend.transition);function Nn(s){if(bn[s])return bn[s];if(!zt[s])return s;var c=zt[s],p;for(p in c)if(c.hasOwnProperty(p)&&p in wi)return bn[s]=c[p];return s}var Tc=Nn("animationend"),oh=Nn("animationiteration"),xr=Nn("animationstart"),Ac=Nn("transitionrun"),lh=Nn("transitionstart"),Vs=Nn("transitioncancel"),Io=Nn("transitionend"),Mo=new Map,Q="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Q.push("scrollEnd");function le(s,c){Mo.set(s,c),fr(c,[s])}var ce=new WeakMap;function Ne(s,c){if(typeof s=="object"&&s!==null){var p=ce.get(s);return p!==void 0?p:(c={value:s,source:c,stack:mc(c)},ce.set(s,c),c)}return{value:s,source:c,stack:mc(c)}}var tt=[],vt=0,At=0;function Ct(){for(var s=vt,c=At=vt=0;c<s;){var p=tt[c];tt[c++]=null;var x=tt[c];tt[c++]=null;var N=tt[c];tt[c++]=null;var A=tt[c];if(tt[c++]=null,x!==null&&N!==null){var V=x.pending;V===null?N.next=N:(N.next=V.next,V.next=N),x.pending=N}A!==0&&Ro(p,N,A)}}function Kn(s,c,p,x){tt[vt++]=s,tt[vt++]=c,tt[vt++]=p,tt[vt++]=x,At|=x,s.lanes|=x,s=s.alternate,s!==null&&(s.lanes|=x)}function Ba(s,c,p,x){return Kn(s,c,p,x),ha(s)}function Ua(s,c){return Kn(s,null,null,c),ha(s)}function Ro(s,c,p){s.lanes|=p;var x=s.alternate;x!==null&&(x.lanes|=p);for(var N=!1,A=s.return;A!==null;)A.childLanes|=p,x=A.alternate,x!==null&&(x.childLanes|=p),A.tag===22&&(s=A.stateNode,s===null||s._visibility&1||(N=!0)),s=A,A=A.return;return s.tag===3?(A=s.stateNode,N&&c!==null&&(N=31-we(p),s=A.hiddenUpdates,x=s[N],x===null?s[N]=[c]:x.push(c),c.lane=p|536870912),A):null}function ha(s){if(50<Xc)throw Xc=0,om=null,Error(r(185));for(var c=s.return;c!==null;)s=c,c=s.return;return s.tag===3?s.stateNode:null}var Il={};function ch(s,c,p,x){this.tag=s,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dr(s,c,p,x){return new ch(s,c,p,x)}function Ml(s){return s=s.prototype,!(!s||!s.isReactComponent)}function br(s,c){var p=s.alternate;return p===null?(p=Dr(s.tag,c,s.key,s.mode),p.elementType=s.elementType,p.type=s.type,p.stateNode=s.stateNode,p.alternate=s,s.alternate=p):(p.pendingProps=c,p.type=s.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=s.flags&65011712,p.childLanes=s.childLanes,p.lanes=s.lanes,p.child=s.child,p.memoizedProps=s.memoizedProps,p.memoizedState=s.memoizedState,p.updateQueue=s.updateQueue,c=s.dependencies,p.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},p.sibling=s.sibling,p.index=s.index,p.ref=s.ref,p.refCleanup=s.refCleanup,p}function Du(s,c){s.flags&=65011714;var p=s.alternate;return p===null?(s.childLanes=0,s.lanes=c,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=p.childLanes,s.lanes=p.lanes,s.child=p.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=p.memoizedProps,s.memoizedState=p.memoizedState,s.updateQueue=p.updateQueue,s.type=p.type,c=p.dependencies,s.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),s}function uh(s,c,p,x,N,A){var V=0;if(x=s,typeof s=="function")Ml(s)&&(V=1);else if(typeof s=="string")V=Av(s,p,ge.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case B:return s=Dr(31,p,c,N),s.elementType=B,s.lanes=A,s;case S:return Rl(p.children,N,A,c);case k:V=8,N|=24;break;case T:return s=Dr(12,p,c,N|2),s.elementType=T,s.lanes=A,s;case $:return s=Dr(13,p,c,N),s.elementType=$,s.lanes=A,s;case L:return s=Dr(19,p,c,N),s.elementType=L,s.lanes=A,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case E:case I:V=10;break e;case P:V=9;break e;case q:V=11;break e;case F:V=14;break e;case z:V=16,x=null;break e}V=29,p=Error(r(130,s===null?"null":typeof s,"")),x=null}return c=Dr(V,p,c,N),c.elementType=s,c.type=x,c.lanes=A,c}function Rl(s,c,p,x){return s=Dr(7,s,x,c),s.lanes=p,s}function pp(s,c,p){return s=Dr(6,s,null,c),s.lanes=p,s}function Dc(s,c,p){return c=Dr(4,s.children!==null?s.children:[],s.key,c),c.lanes=p,c.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},c}var Hs=[],Oo=0,dh=null,Pu=0,fa=[],pa=0,li=null,fi=1,Gs="";function Ol(s,c){Hs[Oo++]=Pu,Hs[Oo++]=dh,dh=s,Pu=c}function mp(s,c,p){fa[pa++]=fi,fa[pa++]=Gs,fa[pa++]=li,li=s;var x=fi;s=Gs;var N=32-we(x)-1;x&=~(1<<N),p+=1;var A=32-we(c)+N;if(30<A){var V=N-N%5;A=(x&(1<<V)-1).toString(32),x>>=V,N-=V,fi=1<<32-we(c)+N|p<<N|x,Gs=A+s}else fi=1<<A|p<<N|x,Gs=s}function gp(s){s.return!==null&&(Ol(s,1),mp(s,1,0))}function Iu(s){for(;s===dh;)dh=Hs[--Oo],Hs[Oo]=null,Pu=Hs[--Oo],Hs[Oo]=null;for(;s===li;)li=fa[--pa],fa[pa]=null,Gs=fa[--pa],fa[pa]=null,fi=fa[--pa],fa[pa]=null}var Fi=null,pi=null,vn=!1,qa=null,Pr=!1,Pc=Error(r(519));function ma(s){var c=Error(r(418,""));throw Lo(Ne(c,s)),Pc}function Eg(s){var c=s.stateNode,p=s.type,x=s.memoizedProps;switch(c[Pt]=s,c[Ut]=x,p){case"dialog":xn("cancel",c),xn("close",c);break;case"iframe":case"object":case"embed":xn("load",c);break;case"video":case"audio":for(p=0;p<wd.length;p++)xn(wd[p],c);break;case"source":xn("error",c);break;case"img":case"image":case"link":xn("error",c),xn("load",c);break;case"details":xn("toggle",c);break;case"input":xn("invalid",c),wo(c,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),Os(c);break;case"select":xn("invalid",c);break;case"textarea":xn("invalid",c),Ls(c,x.value,x.defaultValue,x.children),Os(c)}p=x.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||c.textContent===""+p||x.suppressHydrationWarning===!0||Ky(c.textContent,p)?(x.popover!=null&&(xn("beforetoggle",c),xn("toggle",c)),x.onScroll!=null&&xn("scroll",c),x.onScrollEnd!=null&&xn("scrollend",c),x.onClick!=null&&(c.onclick=tf),c=!0):c=!1,c||ma(s)}function Tg(s){for(Fi=s.return;Fi;)switch(Fi.tag){case 5:case 13:Pr=!1;return;case 27:case 3:Pr=!0;return;default:Fi=Fi.return}}function Mu(s){if(s!==Fi)return!1;if(!vn)return Tg(s),vn=!0,!1;var c=s.tag,p;if((p=c!==3&&c!==27)&&((p=c===5)&&(p=s.type,p=!(p!=="form"&&p!=="button")||rf(s.type,s.memoizedProps)),p=!p),p&&pi&&ma(s),Tg(s),c===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,c=0;s;){if(s.nodeType===8)if(p=s.data,p==="/$"){if(c===0){pi=Qa(s.nextSibling);break e}c--}else p!=="$"&&p!=="$!"&&p!=="$?"||c++;s=s.nextSibling}pi=null}}else c===27?(c=pi,wa(s.type)?(s=wm,wm=null,pi=s):pi=c):pi=Fi?Qa(s.stateNode.nextSibling):null;return!0}function Ru(){pi=Fi=null,vn=!1}function Ag(){var s=qa;return s!==null&&(zr===null?zr=s:zr.push.apply(zr,s),qa=null),s}function Lo(s){qa===null?qa=[s]:qa.push(s)}var Ll=te(null),Fo=null,J=null;function Kr(s,c,p){M(Ll,c._currentValue),c._currentValue=p}function ga(s){s._currentValue=Ll.current,ve(Ll)}function Ir(s,c,p){for(;s!==null;){var x=s.alternate;if((s.childLanes&c)!==c?(s.childLanes|=c,x!==null&&(x.childLanes|=c)):x!==null&&(x.childLanes&c)!==c&&(x.childLanes|=c),s===p)break;s=s.return}}function fn(s,c,p,x){var N=s.child;for(N!==null&&(N.return=s);N!==null;){var A=N.dependencies;if(A!==null){var V=N.child;A=A.firstContext;e:for(;A!==null;){var K=A;A=N;for(var ye=0;ye<c.length;ye++)if(K.context===c[ye]){A.lanes|=p,K=A.alternate,K!==null&&(K.lanes|=p),Ir(A.return,p,s),x||(V=null);break e}A=K.next}}else if(N.tag===18){if(V=N.return,V===null)throw Error(r(341));V.lanes|=p,A=V.alternate,A!==null&&(A.lanes|=p),Ir(V,p,s),V=null}else V=N.child;if(V!==null)V.return=N;else for(V=N;V!==null;){if(V===s){V=null;break}if(N=V.sibling,N!==null){N.return=V.return,V=N;break}V=V.return}N=V}}function Ou(s,c,p,x){s=null;for(var N=c,A=!1;N!==null;){if(!A){if((N.flags&524288)!==0)A=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var V=N.alternate;if(V===null)throw Error(r(387));if(V=V.memoizedProps,V!==null){var K=N.type;yr(N.pendingProps.value,V.value)||(s!==null?s.push(K):s=[K])}}else if(N===ee.current){if(V=N.alternate,V===null)throw Error(r(387));V.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(s!==null?s.push(su):s=[su])}N=N.return}s!==null&&fn(c,s,p,x),c.flags|=262144}function hh(s){for(s=s.firstContext;s!==null;){if(!yr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Fl(s){Fo=s,J=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function ji(s){return Dg(Fo,s)}function fh(s,c){return Fo===null&&Fl(s),Dg(s,c)}function Dg(s,c){var p=c._currentValue;if(c={context:c,memoizedValue:p,next:null},J===null){if(s===null)throw Error(r(308));J=c,s.dependencies={lanes:0,firstContext:c},s.flags|=524288}else J=J.next=c;return p}var ev=typeof AbortController<"u"?AbortController:function(){var s=[],c=this.signal={aborted:!1,addEventListener:function(p,x){s.push(x)}};this.abort=function(){c.aborted=!0,s.forEach(function(p){return p()})}},tv=e.unstable_scheduleCallback,nv=e.unstable_NormalPriority,Xn={$$typeof:I,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function yp(){return{controller:new ev,data:new Map,refCount:0}}function Lu(s){s.refCount--,s.refCount===0&&tv(nv,function(){s.controller.abort()})}var Fu=null,xp=0,Ic=0,Mr=null;function iv(s,c){if(Fu===null){var p=Fu=[];xp=0,Ic=Zh(),Mr={status:"pending",value:void 0,then:function(x){p.push(x)}}}return xp++,c.then(Pg,Pg),c}function Pg(){if(--xp===0&&Fu!==null){Mr!==null&&(Mr.status="fulfilled");var s=Fu;Fu=null,Ic=0,Mr=null;for(var c=0;c<s.length;c++)(0,s[c])()}}function rv(s,c){var p=[],x={status:"pending",value:null,reason:null,then:function(N){p.push(N)}};return s.then(function(){x.status="fulfilled",x.value=c;for(var N=0;N<p.length;N++)(0,p[N])(c)},function(N){for(x.status="rejected",x.reason=N,N=0;N<p.length;N++)(0,p[N])(void 0)}),x}var Ig=X.S;X.S=function(s,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&iv(s,c),Ig!==null&&Ig(s,c)};var $l=te(null);function Ys(){var s=$l.current;return s!==null?s:ii.pooledCache}function ph(s,c){c===null?M($l,$l.current):M($l,c.pool)}function Mg(){var s=Ys();return s===null?null:{parent:Xn._currentValue,pool:s}}var vr=Error(r(460)),Rg=Error(r(474)),mh=Error(r(542)),bp={then:function(){}};function Og(s){return s=s.status,s==="fulfilled"||s==="rejected"}function gh(){}function vp(s,c,p){switch(p=s[p],p===void 0?s.push(c):p!==c&&(c.then(gh,gh),c=p),c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,Fg(s),s;default:if(typeof c.status=="string")c.then(gh,gh);else{if(s=ii,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=c,s.status="pending",s.then(function(x){if(c.status==="pending"){var N=c;N.status="fulfilled",N.value=x}},function(x){if(c.status==="pending"){var N=c;N.status="rejected",N.reason=x}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,Fg(s),s}throw Mc=c,vr}}var Mc=null;function Lg(){if(Mc===null)throw Error(r(459));var s=Mc;return Mc=null,s}function Fg(s){if(s===vr||s===mh)throw Error(r(483))}var gs=!1;function zl(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Rc(s,c){s=s.updateQueue,c.updateQueue===s&&(c.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function $o(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ws(s,c,p){var x=s.updateQueue;if(x===null)return null;if(x=x.shared,(Bn&2)!==0){var N=x.pending;return N===null?c.next=c:(c.next=N.next,N.next=c),x.pending=c,c=ha(s),Ro(s,null,p),c}return Kn(s,x,c,p),ha(s)}function $u(s,c,p){if(c=c.updateQueue,c!==null&&(c=c.shared,(p&4194048)!==0)){var x=c.lanes;x&=s.pendingLanes,p|=x,c.lanes=p,mt(s,p)}}function Va(s,c){var p=s.updateQueue,x=s.alternate;if(x!==null&&(x=x.updateQueue,p===x)){var N=null,A=null;if(p=p.firstBaseUpdate,p!==null){do{var V={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};A===null?N=A=V:A=A.next=V,p=p.next}while(p!==null);A===null?N=A=c:A=A.next=c}else N=A=c;p={baseState:x.baseState,firstBaseUpdate:N,lastBaseUpdate:A,shared:x.shared,callbacks:x.callbacks},s.updateQueue=p;return}s=p.lastBaseUpdate,s===null?p.firstBaseUpdate=c:s.next=c,p.lastBaseUpdate=c}var zu=!1;function Ha(){if(zu){var s=Mr;if(s!==null)throw s}}function lr(s,c,p,x){zu=!1;var N=s.updateQueue;gs=!1;var A=N.firstBaseUpdate,V=N.lastBaseUpdate,K=N.shared.pending;if(K!==null){N.shared.pending=null;var ye=K,Le=ye.next;ye.next=null,V===null?A=Le:V.next=Le,V=ye;var et=s.alternate;et!==null&&(et=et.updateQueue,K=et.lastBaseUpdate,K!==V&&(K===null?et.firstBaseUpdate=Le:K.next=Le,et.lastBaseUpdate=ye))}if(A!==null){var st=N.baseState;V=0,et=Le=ye=null,K=A;do{var Be=K.lane&-536870913,Fe=Be!==K.lane;if(Fe?(En&Be)===Be:(x&Be)===Be){Be!==0&&Be===Ic&&(zu=!0),et!==null&&(et=et.next={lane:0,tag:K.tag,payload:K.payload,callback:null,next:null});e:{var qt=s,Bt=K;Be=c;var Yn=p;switch(Bt.tag){case 1:if(qt=Bt.payload,typeof qt=="function"){st=qt.call(Yn,st,Be);break e}st=qt;break e;case 3:qt.flags=qt.flags&-65537|128;case 0:if(qt=Bt.payload,Be=typeof qt=="function"?qt.call(Yn,st,Be):qt,Be==null)break e;st=f({},st,Be);break e;case 2:gs=!0}}Be=K.callback,Be!==null&&(s.flags|=64,Fe&&(s.flags|=8192),Fe=N.callbacks,Fe===null?N.callbacks=[Be]:Fe.push(Be))}else Fe={lane:Be,tag:K.tag,payload:K.payload,callback:K.callback,next:null},et===null?(Le=et=Fe,ye=st):et=et.next=Fe,V|=Be;if(K=K.next,K===null){if(K=N.shared.pending,K===null)break;Fe=K,K=Fe.next,Fe.next=null,N.lastBaseUpdate=Fe,N.shared.pending=null}}while(!0);et===null&&(ye=st),N.baseState=ye,N.firstBaseUpdate=Le,N.lastBaseUpdate=et,A===null&&(N.shared.lanes=0),Wo|=V,s.lanes=V,s.memoizedState=st}}function $g(s,c){if(typeof s!="function")throw Error(r(191,s));s.call(c)}function wp(s,c){var p=s.callbacks;if(p!==null)for(s.callbacks=null,s=0;s<p.length;s++)$g(p[s],c)}var Bl=te(null),zo=te(0);function Qs(s,c){s=ro,M(zo,s),M(Bl,c),ro=s|c.baseLanes}function yh(){M(zo,ro),M(Bl,Bl.current)}function Np(){ro=zo.current,ve(Bl),ve(zo)}var Ga=0,ln=null,zn=null,wn=null,Oc=!1,Ul=!1,cr=!1,Lc=0,Bo=0,ya=null,zg=0;function Sn(){throw Error(r(321))}function Bu(s,c){if(c===null)return!1;for(var p=0;p<c.length&&p<s.length;p++)if(!yr(s[p],c[p]))return!1;return!0}function Sp(s,c,p,x,N,A){return Ga=A,ln=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,X.H=s===null||s.memoizedState===null?Zg:Bp,cr=!1,A=p(x,N),cr=!1,Ul&&(A=Ug(c,p,x,N)),Bg(s),A}function Bg(s){X.H=Xu;var c=zn!==null&&zn.next!==null;if(Ga=0,wn=zn=ln=null,Oc=!1,Bo=0,ya=null,c)throw Error(r(300));s===null||Yi||(s=s.dependencies,s!==null&&hh(s)&&(Yi=!0))}function Ug(s,c,p,x){ln=s;var N=0;do{if(Ul&&(ya=null),Bo=0,Ul=!1,25<=N)throw Error(r(301));if(N+=1,wn=zn=null,s.updateQueue!=null){var A=s.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}X.H=ey,A=c(p,x)}while(Ul);return A}function jp(){var s=X.H,c=s.useState()[0];return c=typeof c.then=="function"?Uu(c):c,s=s.useState()[0],(zn!==null?zn.memoizedState:null)!==s&&(ln.flags|=1024),c}function _p(){var s=Lc!==0;return Lc=0,s}function ql(s,c,p){c.updateQueue=s.updateQueue,c.flags&=-2053,s.lanes&=~p}function xh(s){if(Oc){for(s=s.memoizedState;s!==null;){var c=s.queue;c!==null&&(c.pending=null),s=s.next}Oc=!1}Ga=0,wn=zn=ln=null,Ul=!1,Bo=Lc=0,ya=null}function Rr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wn===null?ln.memoizedState=wn=s:wn=wn.next=s,wn}function Ii(){if(zn===null){var s=ln.alternate;s=s!==null?s.memoizedState:null}else s=zn.next;var c=wn===null?ln.memoizedState:wn.next;if(c!==null)wn=c,zn=s;else{if(s===null)throw ln.alternate===null?Error(r(467)):Error(r(310));zn=s,s={memoizedState:zn.memoizedState,baseState:zn.baseState,baseQueue:zn.baseQueue,queue:zn.queue,next:null},wn===null?ln.memoizedState=wn=s:wn=wn.next=s}return wn}function Vl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Uu(s){var c=Bo;return Bo+=1,ya===null&&(ya=[]),s=vp(ya,s,c),c=ln,(wn===null?c.memoizedState:wn.next)===null&&(c=c.alternate,X.H=c===null||c.memoizedState===null?Zg:Bp),s}function bh(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Uu(s);if(s.$$typeof===I)return ji(s)}throw Error(r(438,String(s)))}function qu(s){var c=null,p=ln.updateQueue;if(p!==null&&(c=p.memoCache),c==null){var x=ln.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(c={data:x.data.map(function(N){return N.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),p===null&&(p=Vl(),ln.updateQueue=p),p.memoCache=c,p=c.data[c.index],p===void 0)for(p=c.data[c.index]=Array(s),x=0;x<s;x++)p[x]=R;return c.index++,p}function ys(s,c){return typeof c=="function"?c(s):c}function vh(s){var c=Ii();return Cp(c,zn,s)}function Cp(s,c,p){var x=s.queue;if(x===null)throw Error(r(311));x.lastRenderedReducer=p;var N=s.baseQueue,A=x.pending;if(A!==null){if(N!==null){var V=N.next;N.next=A.next,A.next=V}c.baseQueue=N=A,x.pending=null}if(A=s.baseState,N===null)s.memoizedState=A;else{c=N.next;var K=V=null,ye=null,Le=c,et=!1;do{var st=Le.lane&-536870913;if(st!==Le.lane?(En&st)===st:(Ga&st)===st){var Be=Le.revertLane;if(Be===0)ye!==null&&(ye=ye.next={lane:0,revertLane:0,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null}),st===Ic&&(et=!0);else if((Ga&Be)===Be){Le=Le.next,Be===Ic&&(et=!0);continue}else st={lane:0,revertLane:Le.revertLane,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null},ye===null?(K=ye=st,V=A):ye=ye.next=st,ln.lanes|=Be,Wo|=Be;st=Le.action,cr&&p(A,st),A=Le.hasEagerState?Le.eagerState:p(A,st)}else Be={lane:st,revertLane:Le.revertLane,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null},ye===null?(K=ye=Be,V=A):ye=ye.next=Be,ln.lanes|=st,Wo|=st;Le=Le.next}while(Le!==null&&Le!==c);if(ye===null?V=A:ye.next=K,!yr(A,s.memoizedState)&&(Yi=!0,et&&(p=Mr,p!==null)))throw p;s.memoizedState=A,s.baseState=V,s.baseQueue=ye,x.lastRenderedState=A}return N===null&&(x.lanes=0),[s.memoizedState,x.dispatch]}function kp(s){var c=Ii(),p=c.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=s;var x=p.dispatch,N=p.pending,A=c.memoizedState;if(N!==null){p.pending=null;var V=N=N.next;do A=s(A,V.action),V=V.next;while(V!==N);yr(A,c.memoizedState)||(Yi=!0),c.memoizedState=A,c.baseQueue===null&&(c.baseState=A),p.lastRenderedState=A}return[A,x]}function Ep(s,c,p){var x=ln,N=Ii(),A=vn;if(A){if(p===void 0)throw Error(r(407));p=p()}else p=c();var V=!yr((zn||N).memoizedState,p);V&&(N.memoizedState=p,Yi=!0),N=N.queue;var K=Nh.bind(null,x,N,s);if(Gu(2048,8,K,[s]),N.getSnapshot!==c||V||wn!==null&&wn.memoizedState.tag&1){if(x.flags|=2048,Fc(9,kh(),qg.bind(null,x,N,p,c),null),ii===null)throw Error(r(349));A||(Ga&124)!==0||wh(x,c,p)}return p}function wh(s,c,p){s.flags|=16384,s={getSnapshot:c,value:p},c=ln.updateQueue,c===null?(c=Vl(),ln.updateQueue=c,c.stores=[s]):(p=c.stores,p===null?c.stores=[s]:p.push(s))}function qg(s,c,p,x){c.value=p,c.getSnapshot=x,Tp(c)&&Ap(s)}function Nh(s,c,p){return p(function(){Tp(c)&&Ap(s)})}function Tp(s){var c=s.getSnapshot;s=s.value;try{var p=c();return!yr(s,p)}catch{return!0}}function Ap(s){var c=Ua(s,2);c!==null&&na(c,s,2)}function Sh(s){var c=Rr();if(typeof s=="function"){var p=s;if(s=p(),cr){Qe(!0);try{p()}finally{Qe(!1)}}}return c.memoizedState=c.baseState=s,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ys,lastRenderedState:s},c}function Vu(s,c,p,x){return s.baseState=p,Cp(s,zn,typeof x=="function"?x:ys)}function av(s,c,p,x,N){if(Dh(s))throw Error(r(485));if(s=c.action,s!==null){var A={payload:N,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(V){A.listeners.push(V)}};X.T!==null?p(!0):A.isTransition=!1,x(A),p=c.pending,p===null?(A.next=c.pending=A,Dp(c,A)):(A.next=p.next,c.pending=p.next=A)}}function Dp(s,c){var p=c.action,x=c.payload,N=s.state;if(c.isTransition){var A=X.T,V={};X.T=V;try{var K=p(N,x),ye=X.S;ye!==null&&ye(V,K),Pp(s,c,K)}catch(Le){jh(s,c,Le)}finally{X.T=A}}else try{A=p(N,x),Pp(s,c,A)}catch(Le){jh(s,c,Le)}}function Pp(s,c,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(x){Vg(s,c,x)},function(x){return jh(s,c,x)}):Vg(s,c,p)}function Vg(s,c,p){c.status="fulfilled",c.value=p,Hg(c),s.state=p,c=s.pending,c!==null&&(p=c.next,p===c?s.pending=null:(p=p.next,c.next=p,Dp(s,p)))}function jh(s,c,p){var x=s.pending;if(s.pending=null,x!==null){x=x.next;do c.status="rejected",c.reason=p,Hg(c),c=c.next;while(c!==x)}s.action=null}function Hg(s){s=s.listeners;for(var c=0;c<s.length;c++)(0,s[c])()}function _h(s,c){return c}function Ip(s,c){if(vn){var p=ii.formState;if(p!==null){e:{var x=ln;if(vn){if(pi){t:{for(var N=pi,A=Pr;N.nodeType!==8;){if(!A){N=null;break t}if(N=Qa(N.nextSibling),N===null){N=null;break t}}A=N.data,N=A==="F!"||A==="F"?N:null}if(N){pi=Qa(N.nextSibling),x=N.data==="F!";break e}}ma(x)}x=!1}x&&(c=p[0])}}return p=Rr(),p.memoizedState=p.baseState=c,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_h,lastRenderedState:c},p.queue=x,p=Fp.bind(null,ln,x),x.dispatch=p,x=Sh(!1),A=$p.bind(null,ln,!1,x.queue),x=Rr(),N={state:c,dispatch:null,action:s,pending:null},x.queue=N,p=av.bind(null,ln,N,A,p),N.dispatch=p,x.memoizedState=s,[c,p,!1]}function Ch(s){var c=Ii();return Gg(c,zn,s)}function Gg(s,c,p){if(c=Cp(s,c,_h)[0],s=vh(ys)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var x=Uu(c)}catch(V){throw V===vr?mh:V}else x=c;c=Ii();var N=c.queue,A=N.dispatch;return p!==c.memoizedState&&(ln.flags|=2048,Fc(9,kh(),Mp.bind(null,N,p),null)),[x,A,s]}function Mp(s,c){s.action=c}function an(s){var c=Ii(),p=zn;if(p!==null)return Gg(c,p,s);Ii(),c=c.memoizedState,p=Ii();var x=p.queue.dispatch;return p.memoizedState=s,[c,x,!1]}function Fc(s,c,p,x){return s={tag:s,create:p,deps:x,inst:c,next:null},c=ln.updateQueue,c===null&&(c=Vl(),ln.updateQueue=c),p=c.lastEffect,p===null?c.lastEffect=s.next=s:(x=p.next,p.next=s,s.next=x,c.lastEffect=s),s}function kh(){return{destroy:void 0,resource:void 0}}function $c(){return Ii().memoizedState}function Hu(s,c,p,x){var N=Rr();x=x===void 0?null:x,ln.flags|=s,N.memoizedState=Fc(1|c,kh(),p,x)}function Gu(s,c,p,x){var N=Ii();x=x===void 0?null:x;var A=N.memoizedState.inst;zn!==null&&x!==null&&Bu(x,zn.memoizedState.deps)?N.memoizedState=Fc(c,A,p,x):(ln.flags|=s,N.memoizedState=Fc(1|c,A,p,x))}function Yg(s,c){Hu(8390656,8,s,c)}function Xr(s,c){Gu(2048,8,s,c)}function Wg(s,c){return Gu(4,2,s,c)}function Yu(s,c){return Gu(4,4,s,c)}function Eh(s,c){if(typeof c=="function"){s=s();var p=c(s);return function(){typeof p=="function"?p():c(null)}}if(c!=null)return s=s(),c.current=s,function(){c.current=null}}function Rp(s,c,p){p=p!=null?p.concat([s]):null,Gu(4,4,Eh.bind(null,c,s),p)}function Th(){}function Or(s,c){var p=Ii();c=c===void 0?null:c;var x=p.memoizedState;return c!==null&&Bu(c,x[1])?x[0]:(p.memoizedState=[s,c],s)}function Js(s,c){var p=Ii();c=c===void 0?null:c;var x=p.memoizedState;if(c!==null&&Bu(c,x[1]))return x[0];if(x=s(),cr){Qe(!0);try{s()}finally{Qe(!1)}}return p.memoizedState=[x,c],x}function Wu(s,c,p){return p===void 0||(Ga&1073741824)!==0?s.memoizedState=c:(s.memoizedState=p,s=ky(),ln.lanes|=s,Wo|=s,p)}function Op(s,c,p,x){return yr(p,c)?p:Bl.current!==null?(s=Wu(s,p,x),yr(s,c)||(Yi=!0),s):(Ga&42)===0?(Yi=!0,s.memoizedState=p):(s=ky(),ln.lanes|=s,Wo|=s,c)}function Qu(s,c,p,x,N){var A=W.p;W.p=A!==0&&8>A?A:8;var V=X.T,K={};X.T=K,$p(s,!1,c,p);try{var ye=N(),Le=X.S;if(Le!==null&&Le(K,ye),ye!==null&&typeof ye=="object"&&typeof ye.then=="function"){var et=rv(ye,x);Hl(s,c,et,dr(s))}else Hl(s,c,x,dr(s))}catch(st){Hl(s,c,{then:function(){},status:"rejected",reason:st},dr())}finally{W.p=A,X.T=V}}function Qg(){}function Ju(s,c,p,x){if(s.tag!==5)throw Error(r(476));var N=Lp(s).queue;Qu(s,N,c,H,p===null?Qg:function(){return Ah(s),p(x)})}function Lp(s){var c=s.memoizedState;if(c!==null)return c;c={memoizedState:H,baseState:H,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ys,lastRenderedState:H},next:null};var p={};return c.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ys,lastRenderedState:p},next:null},s.memoizedState=c,s=s.alternate,s!==null&&(s.memoizedState=c),c}function Ah(s){var c=Lp(s).next.queue;Hl(s,c,{},dr())}function Ku(){return ji(su)}function Ks(){return Ii().memoizedState}function Jg(){return Ii().memoizedState}function Uo(s){for(var c=s.return;c!==null;){switch(c.tag){case 24:case 3:var p=dr();s=$o(p);var x=Ws(c,s,p);x!==null&&(na(x,c,p),$u(x,c,p)),c={cache:yp()},s.payload=c;return}c=c.return}}function Kg(s,c,p){var x=dr();p={lane:x,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},Dh(s)?Xg(c,p):(p=Ba(s,c,p,x),p!==null&&(na(p,s,x),zp(p,c,x)))}function Fp(s,c,p){var x=dr();Hl(s,c,p,x)}function Hl(s,c,p,x){var N={lane:x,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(Dh(s))Xg(c,N);else{var A=s.alternate;if(s.lanes===0&&(A===null||A.lanes===0)&&(A=c.lastRenderedReducer,A!==null))try{var V=c.lastRenderedState,K=A(V,p);if(N.hasEagerState=!0,N.eagerState=K,yr(K,V))return Kn(s,c,N,0),ii===null&&Ct(),!1}catch{}finally{}if(p=Ba(s,c,N,x),p!==null)return na(p,s,x),zp(p,c,x),!0}return!1}function $p(s,c,p,x){if(x={lane:2,revertLane:Zh(),action:x,hasEagerState:!1,eagerState:null,next:null},Dh(s)){if(c)throw Error(r(479))}else c=Ba(s,p,x,2),c!==null&&na(c,s,2)}function Dh(s){var c=s.alternate;return s===ln||c!==null&&c===ln}function Xg(s,c){Ul=Oc=!0;var p=s.pending;p===null?c.next=c:(c.next=p.next,p.next=c),s.pending=c}function zp(s,c,p){if((p&4194048)!==0){var x=c.lanes;x&=s.pendingLanes,p|=x,c.lanes=p,mt(s,p)}}var Xu={readContext:ji,use:bh,useCallback:Sn,useContext:Sn,useEffect:Sn,useImperativeHandle:Sn,useLayoutEffect:Sn,useInsertionEffect:Sn,useMemo:Sn,useReducer:Sn,useRef:Sn,useState:Sn,useDebugValue:Sn,useDeferredValue:Sn,useTransition:Sn,useSyncExternalStore:Sn,useId:Sn,useHostTransitionStatus:Sn,useFormState:Sn,useActionState:Sn,useOptimistic:Sn,useMemoCache:Sn,useCacheRefresh:Sn},Zg={readContext:ji,use:bh,useCallback:function(s,c){return Rr().memoizedState=[s,c===void 0?null:c],s},useContext:ji,useEffect:Yg,useImperativeHandle:function(s,c,p){p=p!=null?p.concat([s]):null,Hu(4194308,4,Eh.bind(null,c,s),p)},useLayoutEffect:function(s,c){return Hu(4194308,4,s,c)},useInsertionEffect:function(s,c){Hu(4,2,s,c)},useMemo:function(s,c){var p=Rr();c=c===void 0?null:c;var x=s();if(cr){Qe(!0);try{s()}finally{Qe(!1)}}return p.memoizedState=[x,c],x},useReducer:function(s,c,p){var x=Rr();if(p!==void 0){var N=p(c);if(cr){Qe(!0);try{p(c)}finally{Qe(!1)}}}else N=c;return x.memoizedState=x.baseState=N,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:N},x.queue=s,s=s.dispatch=Kg.bind(null,ln,s),[x.memoizedState,s]},useRef:function(s){var c=Rr();return s={current:s},c.memoizedState=s},useState:function(s){s=Sh(s);var c=s.queue,p=Fp.bind(null,ln,c);return c.dispatch=p,[s.memoizedState,p]},useDebugValue:Th,useDeferredValue:function(s,c){var p=Rr();return Wu(p,s,c)},useTransition:function(){var s=Sh(!1);return s=Qu.bind(null,ln,s.queue,!0,!1),Rr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,c,p){var x=ln,N=Rr();if(vn){if(p===void 0)throw Error(r(407));p=p()}else{if(p=c(),ii===null)throw Error(r(349));(En&124)!==0||wh(x,c,p)}N.memoizedState=p;var A={value:p,getSnapshot:c};return N.queue=A,Yg(Nh.bind(null,x,A,s),[s]),x.flags|=2048,Fc(9,kh(),qg.bind(null,x,A,p,c),null),p},useId:function(){var s=Rr(),c=ii.identifierPrefix;if(vn){var p=Gs,x=fi;p=(x&~(1<<32-we(x)-1)).toString(32)+p,c=""+c+"R"+p,p=Lc++,0<p&&(c+="H"+p.toString(32)),c+=""}else p=zg++,c=""+c+"r"+p.toString(32)+"";return s.memoizedState=c},useHostTransitionStatus:Ku,useFormState:Ip,useActionState:Ip,useOptimistic:function(s){var c=Rr();c.memoizedState=c.baseState=s;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=p,c=$p.bind(null,ln,!0,p),p.dispatch=c,[s,c]},useMemoCache:qu,useCacheRefresh:function(){return Rr().memoizedState=Uo.bind(null,ln)}},Bp={readContext:ji,use:bh,useCallback:Or,useContext:ji,useEffect:Xr,useImperativeHandle:Rp,useInsertionEffect:Wg,useLayoutEffect:Yu,useMemo:Js,useReducer:vh,useRef:$c,useState:function(){return vh(ys)},useDebugValue:Th,useDeferredValue:function(s,c){var p=Ii();return Op(p,zn.memoizedState,s,c)},useTransition:function(){var s=vh(ys)[0],c=Ii().memoizedState;return[typeof s=="boolean"?s:Uu(s),c]},useSyncExternalStore:Ep,useId:Ks,useHostTransitionStatus:Ku,useFormState:Ch,useActionState:Ch,useOptimistic:function(s,c){var p=Ii();return Vu(p,zn,s,c)},useMemoCache:qu,useCacheRefresh:Jg},ey={readContext:ji,use:bh,useCallback:Or,useContext:ji,useEffect:Xr,useImperativeHandle:Rp,useInsertionEffect:Wg,useLayoutEffect:Yu,useMemo:Js,useReducer:kp,useRef:$c,useState:function(){return kp(ys)},useDebugValue:Th,useDeferredValue:function(s,c){var p=Ii();return zn===null?Wu(p,s,c):Op(p,zn.memoizedState,s,c)},useTransition:function(){var s=kp(ys)[0],c=Ii().memoizedState;return[typeof s=="boolean"?s:Uu(s),c]},useSyncExternalStore:Ep,useId:Ks,useHostTransitionStatus:Ku,useFormState:an,useActionState:an,useOptimistic:function(s,c){var p=Ii();return zn!==null?Vu(p,zn,s,c):(p.baseState=s,[s,p.queue.dispatch])},useMemoCache:qu,useCacheRefresh:Jg},$i=null,Lr=0;function Ph(s){var c=Lr;return Lr+=1,$i===null&&($i=[]),vp($i,s,c)}function Zu(s,c){c=c.props.ref,s.ref=c!==void 0?c:null}function Gl(s,c){throw c.$$typeof===g?Error(r(525)):(s=Object.prototype.toString.call(c),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":s)))}function Yl(s){var c=s._init;return c(s._payload)}function Up(s){function c(De,Ce){if(s){var Oe=De.deletions;Oe===null?(De.deletions=[Ce],De.flags|=16):Oe.push(Ce)}}function p(De,Ce){if(!s)return null;for(;Ce!==null;)c(De,Ce),Ce=Ce.sibling;return null}function x(De){for(var Ce=new Map;De!==null;)De.key!==null?Ce.set(De.key,De):Ce.set(De.index,De),De=De.sibling;return Ce}function N(De,Ce){return De=br(De,Ce),De.index=0,De.sibling=null,De}function A(De,Ce,Oe){return De.index=Oe,s?(Oe=De.alternate,Oe!==null?(Oe=Oe.index,Oe<Ce?(De.flags|=67108866,Ce):Oe):(De.flags|=67108866,Ce)):(De.flags|=1048576,Ce)}function V(De){return s&&De.alternate===null&&(De.flags|=67108866),De}function K(De,Ce,Oe,it){return Ce===null||Ce.tag!==6?(Ce=pp(Oe,De.mode,it),Ce.return=De,Ce):(Ce=N(Ce,Oe),Ce.return=De,Ce)}function ye(De,Ce,Oe,it){var Dt=Oe.type;return Dt===S?et(De,Ce,Oe.props.children,it,Oe.key):Ce!==null&&(Ce.elementType===Dt||typeof Dt=="object"&&Dt!==null&&Dt.$$typeof===z&&Yl(Dt)===Ce.type)?(Ce=N(Ce,Oe.props),Zu(Ce,Oe),Ce.return=De,Ce):(Ce=uh(Oe.type,Oe.key,Oe.props,null,De.mode,it),Zu(Ce,Oe),Ce.return=De,Ce)}function Le(De,Ce,Oe,it){return Ce===null||Ce.tag!==4||Ce.stateNode.containerInfo!==Oe.containerInfo||Ce.stateNode.implementation!==Oe.implementation?(Ce=Dc(Oe,De.mode,it),Ce.return=De,Ce):(Ce=N(Ce,Oe.children||[]),Ce.return=De,Ce)}function et(De,Ce,Oe,it,Dt){return Ce===null||Ce.tag!==7?(Ce=Rl(Oe,De.mode,it,Dt),Ce.return=De,Ce):(Ce=N(Ce,Oe),Ce.return=De,Ce)}function st(De,Ce,Oe){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return Ce=pp(""+Ce,De.mode,Oe),Ce.return=De,Ce;if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case b:return Oe=uh(Ce.type,Ce.key,Ce.props,null,De.mode,Oe),Zu(Oe,Ce),Oe.return=De,Oe;case v:return Ce=Dc(Ce,De.mode,Oe),Ce.return=De,Ce;case z:var it=Ce._init;return Ce=it(Ce._payload),st(De,Ce,Oe)}if(ae(Ce)||Y(Ce))return Ce=Rl(Ce,De.mode,Oe,null),Ce.return=De,Ce;if(typeof Ce.then=="function")return st(De,Ph(Ce),Oe);if(Ce.$$typeof===I)return st(De,fh(De,Ce),Oe);Gl(De,Ce)}return null}function Be(De,Ce,Oe,it){var Dt=Ce!==null?Ce.key:null;if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint")return Dt!==null?null:K(De,Ce,""+Oe,it);if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case b:return Oe.key===Dt?ye(De,Ce,Oe,it):null;case v:return Oe.key===Dt?Le(De,Ce,Oe,it):null;case z:return Dt=Oe._init,Oe=Dt(Oe._payload),Be(De,Ce,Oe,it)}if(ae(Oe)||Y(Oe))return Dt!==null?null:et(De,Ce,Oe,it,null);if(typeof Oe.then=="function")return Be(De,Ce,Ph(Oe),it);if(Oe.$$typeof===I)return Be(De,Ce,fh(De,Oe),it);Gl(De,Oe)}return null}function Fe(De,Ce,Oe,it,Dt){if(typeof it=="string"&&it!==""||typeof it=="number"||typeof it=="bigint")return De=De.get(Oe)||null,K(Ce,De,""+it,Dt);if(typeof it=="object"&&it!==null){switch(it.$$typeof){case b:return De=De.get(it.key===null?Oe:it.key)||null,ye(Ce,De,it,Dt);case v:return De=De.get(it.key===null?Oe:it.key)||null,Le(Ce,De,it,Dt);case z:var pn=it._init;return it=pn(it._payload),Fe(De,Ce,Oe,it,Dt)}if(ae(it)||Y(it))return De=De.get(Oe)||null,et(Ce,De,it,Dt,null);if(typeof it.then=="function")return Fe(De,Ce,Oe,Ph(it),Dt);if(it.$$typeof===I)return Fe(De,Ce,Oe,fh(Ce,it),Dt);Gl(Ce,it)}return null}function qt(De,Ce,Oe,it){for(var Dt=null,pn=null,Rt=Ce,Vt=Ce=0,Ji=null;Rt!==null&&Vt<Oe.length;Vt++){Rt.index>Vt?(Ji=Rt,Rt=null):Ji=Rt.sibling;var An=Be(De,Rt,Oe[Vt],it);if(An===null){Rt===null&&(Rt=Ji);break}s&&Rt&&An.alternate===null&&c(De,Rt),Ce=A(An,Ce,Vt),pn===null?Dt=An:pn.sibling=An,pn=An,Rt=Ji}if(Vt===Oe.length)return p(De,Rt),vn&&Ol(De,Vt),Dt;if(Rt===null){for(;Vt<Oe.length;Vt++)Rt=st(De,Oe[Vt],it),Rt!==null&&(Ce=A(Rt,Ce,Vt),pn===null?Dt=Rt:pn.sibling=Rt,pn=Rt);return vn&&Ol(De,Vt),Dt}for(Rt=x(Rt);Vt<Oe.length;Vt++)Ji=Fe(Rt,De,Vt,Oe[Vt],it),Ji!==null&&(s&&Ji.alternate!==null&&Rt.delete(Ji.key===null?Vt:Ji.key),Ce=A(Ji,Ce,Vt),pn===null?Dt=Ji:pn.sibling=Ji,pn=Ji);return s&&Rt.forEach(function(rl){return c(De,rl)}),vn&&Ol(De,Vt),Dt}function Bt(De,Ce,Oe,it){if(Oe==null)throw Error(r(151));for(var Dt=null,pn=null,Rt=Ce,Vt=Ce=0,Ji=null,An=Oe.next();Rt!==null&&!An.done;Vt++,An=Oe.next()){Rt.index>Vt?(Ji=Rt,Rt=null):Ji=Rt.sibling;var rl=Be(De,Rt,An.value,it);if(rl===null){Rt===null&&(Rt=Ji);break}s&&Rt&&rl.alternate===null&&c(De,Rt),Ce=A(rl,Ce,Vt),pn===null?Dt=rl:pn.sibling=rl,pn=rl,Rt=Ji}if(An.done)return p(De,Rt),vn&&Ol(De,Vt),Dt;if(Rt===null){for(;!An.done;Vt++,An=Oe.next())An=st(De,An.value,it),An!==null&&(Ce=A(An,Ce,Vt),pn===null?Dt=An:pn.sibling=An,pn=An);return vn&&Ol(De,Vt),Dt}for(Rt=x(Rt);!An.done;Vt++,An=Oe.next())An=Fe(Rt,De,Vt,An.value,it),An!==null&&(s&&An.alternate!==null&&Rt.delete(An.key===null?Vt:An.key),Ce=A(An,Ce,Vt),pn===null?Dt=An:pn.sibling=An,pn=An);return s&&Rt.forEach(function(Bv){return c(De,Bv)}),vn&&Ol(De,Vt),Dt}function Yn(De,Ce,Oe,it){if(typeof Oe=="object"&&Oe!==null&&Oe.type===S&&Oe.key===null&&(Oe=Oe.props.children),typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case b:e:{for(var Dt=Oe.key;Ce!==null;){if(Ce.key===Dt){if(Dt=Oe.type,Dt===S){if(Ce.tag===7){p(De,Ce.sibling),it=N(Ce,Oe.props.children),it.return=De,De=it;break e}}else if(Ce.elementType===Dt||typeof Dt=="object"&&Dt!==null&&Dt.$$typeof===z&&Yl(Dt)===Ce.type){p(De,Ce.sibling),it=N(Ce,Oe.props),Zu(it,Oe),it.return=De,De=it;break e}p(De,Ce);break}else c(De,Ce);Ce=Ce.sibling}Oe.type===S?(it=Rl(Oe.props.children,De.mode,it,Oe.key),it.return=De,De=it):(it=uh(Oe.type,Oe.key,Oe.props,null,De.mode,it),Zu(it,Oe),it.return=De,De=it)}return V(De);case v:e:{for(Dt=Oe.key;Ce!==null;){if(Ce.key===Dt)if(Ce.tag===4&&Ce.stateNode.containerInfo===Oe.containerInfo&&Ce.stateNode.implementation===Oe.implementation){p(De,Ce.sibling),it=N(Ce,Oe.children||[]),it.return=De,De=it;break e}else{p(De,Ce);break}else c(De,Ce);Ce=Ce.sibling}it=Dc(Oe,De.mode,it),it.return=De,De=it}return V(De);case z:return Dt=Oe._init,Oe=Dt(Oe._payload),Yn(De,Ce,Oe,it)}if(ae(Oe))return qt(De,Ce,Oe,it);if(Y(Oe)){if(Dt=Y(Oe),typeof Dt!="function")throw Error(r(150));return Oe=Dt.call(Oe),Bt(De,Ce,Oe,it)}if(typeof Oe.then=="function")return Yn(De,Ce,Ph(Oe),it);if(Oe.$$typeof===I)return Yn(De,Ce,fh(De,Oe),it);Gl(De,Oe)}return typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint"?(Oe=""+Oe,Ce!==null&&Ce.tag===6?(p(De,Ce.sibling),it=N(Ce,Oe),it.return=De,De=it):(p(De,Ce),it=pp(Oe,De.mode,it),it.return=De,De=it),V(De)):p(De,Ce)}return function(De,Ce,Oe,it){try{Lr=0;var Dt=Yn(De,Ce,Oe,it);return $i=null,Dt}catch(Rt){if(Rt===vr||Rt===mh)throw Rt;var pn=Dr(29,Rt,null,De.mode);return pn.lanes=it,pn.return=De,pn}finally{}}}var Wl=Up(!0),ty=Up(!1),Zr=te(null),wr=null;function xa(s){var c=s.alternate;M(_i,_i.current&1),M(Zr,s),wr===null&&(c===null||Bl.current!==null||c.memoizedState!==null)&&(wr=s)}function ny(s){if(s.tag===22){if(M(_i,_i.current),M(Zr,s),wr===null){var c=s.alternate;c!==null&&c.memoizedState!==null&&(wr=s)}}else Xs()}function Xs(){M(_i,_i.current),M(Zr,Zr.current)}function xs(s){ve(Zr),wr===s&&(wr=null),ve(_i)}var _i=te(0);function ed(s){for(var c=s;c!==null;){if(c.tag===13){var p=c.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||Sr(p)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function zc(s,c,p,x){c=s.memoizedState,p=p(x,c),p=p==null?c:f({},c,p),s.memoizedState=p,s.lanes===0&&(s.updateQueue.baseState=p)}var td={enqueueSetState:function(s,c,p){s=s._reactInternals;var x=dr(),N=$o(x);N.payload=c,p!=null&&(N.callback=p),c=Ws(s,N,x),c!==null&&(na(c,s,x),$u(c,s,x))},enqueueReplaceState:function(s,c,p){s=s._reactInternals;var x=dr(),N=$o(x);N.tag=1,N.payload=c,p!=null&&(N.callback=p),c=Ws(s,N,x),c!==null&&(na(c,s,x),$u(c,s,x))},enqueueForceUpdate:function(s,c){s=s._reactInternals;var p=dr(),x=$o(p);x.tag=2,c!=null&&(x.callback=c),c=Ws(s,x,p),c!==null&&(na(c,s,p),$u(c,s,p))}};function nd(s,c,p,x,N,A,V){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(x,A,V):c.prototype&&c.prototype.isPureReactComponent?!ir(p,x)||!ir(N,A):!0}function iy(s,c,p,x){s=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(p,x),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(p,x),c.state!==s&&td.enqueueReplaceState(c,c.state,null)}function qo(s,c){var p=c;if("ref"in c){p={};for(var x in c)x!=="ref"&&(p[x]=c[x])}if(s=s.defaultProps){p===c&&(p=f({},p));for(var N in s)p[N]===void 0&&(p[N]=s[N])}return p}var Ql=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function qp(s){Ql(s)}function Ih(s){console.error(s)}function ry(s){Ql(s)}function id(s,c){try{var p=s.onUncaughtError;p(c.value,{componentStack:c.stack})}catch(x){setTimeout(function(){throw x})}}function bs(s,c,p){try{var x=s.onCaughtError;x(p.value,{componentStack:p.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function Mh(s,c,p){return p=$o(p),p.tag=3,p.payload={element:null},p.callback=function(){id(s,c)},p}function Vp(s){return s=$o(s),s.tag=3,s}function ay(s,c,p,x){var N=p.type.getDerivedStateFromError;if(typeof N=="function"){var A=x.value;s.payload=function(){return N(A)},s.callback=function(){bs(c,p,x)}}var V=p.stateNode;V!==null&&typeof V.componentDidCatch=="function"&&(s.callback=function(){bs(c,p,x),typeof N!="function"&&(Qo===null?Qo=new Set([this]):Qo.add(this));var K=x.stack;this.componentDidCatch(x.value,{componentStack:K!==null?K:""})})}function sy(s,c,p,x,N){if(p.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(c=p.alternate,c!==null&&Ou(c,p,N,!0),p=Zr.current,p!==null){switch(p.tag){case 13:return wr===null?cm():p.alternate===null&&Ci===0&&(Ci=3),p.flags&=-257,p.flags|=65536,p.lanes=N,x===bp?p.flags|=16384:(c=p.updateQueue,c===null?p.updateQueue=new Set([x]):c.add(x),hm(s,x,N)),!1;case 22:return p.flags|=65536,x===bp?p.flags|=16384:(c=p.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([x])},p.updateQueue=c):(p=c.retryQueue,p===null?c.retryQueue=new Set([x]):p.add(x)),hm(s,x,N)),!1}throw Error(r(435,p.tag))}return hm(s,x,N),cm(),!1}if(vn)return c=Zr.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=N,x!==Pc&&(s=Error(r(422),{cause:x}),Lo(Ne(s,p)))):(x!==Pc&&(c=Error(r(423),{cause:x}),Lo(Ne(c,p))),s=s.current.alternate,s.flags|=65536,N&=-N,s.lanes|=N,x=Ne(x,p),N=Mh(s.stateNode,x,N),Va(s,N),Ci!==4&&(Ci=2)),!1;var A=Error(r(520),{cause:x});if(A=Ne(A,p),fd===null?fd=[A]:fd.push(A),Ci!==4&&(Ci=2),c===null)return!0;x=Ne(x,p),p=c;do{switch(p.tag){case 3:return p.flags|=65536,s=N&-N,p.lanes|=s,s=Mh(p.stateNode,x,s),Va(p,s),!1;case 1:if(c=p.type,A=p.stateNode,(p.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Qo===null||!Qo.has(A))))return p.flags|=65536,N&=-N,p.lanes|=N,N=Vp(N),ay(N,s,p,x),Va(p,N),!1}p=p.return}while(p!==null);return!1}var oy=Error(r(461)),Yi=!1;function ci(s,c,p,x){c.child=s===null?ty(c,null,p,x):Wl(c,s.child,p,x)}function Rh(s,c,p,x,N){p=p.render;var A=c.ref;if("ref"in x){var V={};for(var K in x)K!=="ref"&&(V[K]=x[K])}else V=x;return Fl(c),x=Sp(s,c,p,V,A,N),K=_p(),s!==null&&!Yi?(ql(s,c,N),Zs(s,c,N)):(vn&&K&&gp(c),c.flags|=1,ci(s,c,x,N),c.child)}function Oh(s,c,p,x,N){if(s===null){var A=p.type;return typeof A=="function"&&!Ml(A)&&A.defaultProps===void 0&&p.compare===null?(c.tag=15,c.type=A,Lh(s,c,A,x,N)):(s=uh(p.type,null,x,c,c.mode,N),s.ref=c.ref,s.return=c,c.child=s)}if(A=s.child,!Ya(s,N)){var V=A.memoizedProps;if(p=p.compare,p=p!==null?p:ir,p(V,x)&&s.ref===c.ref)return Zs(s,c,N)}return c.flags|=1,s=br(A,x),s.ref=c.ref,s.return=c,c.child=s}function Lh(s,c,p,x,N){if(s!==null){var A=s.memoizedProps;if(ir(A,x)&&s.ref===c.ref)if(Yi=!1,c.pendingProps=x=A,Ya(s,N))(s.flags&131072)!==0&&(Yi=!0);else return c.lanes=s.lanes,Zs(s,c,N)}return Bc(s,c,p,x,N)}function rd(s,c,p){var x=c.pendingProps,N=x.children,A=s!==null?s.memoizedState:null;if(x.mode==="hidden"){if((c.flags&128)!==0){if(x=A!==null?A.baseLanes|p:p,s!==null){for(N=c.child=s.child,A=0;N!==null;)A=A|N.lanes|N.childLanes,N=N.sibling;c.childLanes=A&~x}else c.childLanes=0,c.child=null;return Jl(s,c,x,p)}if((p&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},s!==null&&ph(c,A!==null?A.cachePool:null),A!==null?Qs(c,A):yh(),ny(c);else return c.lanes=c.childLanes=536870912,Jl(s,c,A!==null?A.baseLanes|p:p,p)}else A!==null?(ph(c,A.cachePool),Qs(c,A),Xs(),c.memoizedState=null):(s!==null&&ph(c,null),yh(),Xs());return ci(s,c,N,p),c.child}function Jl(s,c,p,x){var N=Ys();return N=N===null?null:{parent:Xn._currentValue,pool:N},c.memoizedState={baseLanes:p,cachePool:N},s!==null&&ph(c,null),yh(),ny(c),s!==null&&Ou(s,c,x,!0),null}function Lt(s,c){var p=c.ref;if(p===null)s!==null&&s.ref!==null&&(c.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(r(284));(s===null||s.ref!==p)&&(c.flags|=4194816)}}function Bc(s,c,p,x,N){return Fl(c),p=Sp(s,c,p,x,void 0,N),x=_p(),s!==null&&!Yi?(ql(s,c,N),Zs(s,c,N)):(vn&&x&&gp(c),c.flags|=1,ci(s,c,p,N),c.child)}function Fh(s,c,p,x,N,A){return Fl(c),c.updateQueue=null,p=Ug(c,x,p,N),Bg(s),x=_p(),s!==null&&!Yi?(ql(s,c,A),Zs(s,c,A)):(vn&&x&&gp(c),c.flags|=1,ci(s,c,p,A),c.child)}function Vo(s,c,p,x,N){if(Fl(c),c.stateNode===null){var A=Il,V=p.contextType;typeof V=="object"&&V!==null&&(A=ji(V)),A=new p(x,A),c.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=td,c.stateNode=A,A._reactInternals=c,A=c.stateNode,A.props=x,A.state=c.memoizedState,A.refs={},zl(c),V=p.contextType,A.context=typeof V=="object"&&V!==null?ji(V):Il,A.state=c.memoizedState,V=p.getDerivedStateFromProps,typeof V=="function"&&(zc(c,p,V,x),A.state=c.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(V=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),V!==A.state&&td.enqueueReplaceState(A,A.state,null),lr(c,x,A,N),Ha(),A.state=c.memoizedState),typeof A.componentDidMount=="function"&&(c.flags|=4194308),x=!0}else if(s===null){A=c.stateNode;var K=c.memoizedProps,ye=qo(p,K);A.props=ye;var Le=A.context,et=p.contextType;V=Il,typeof et=="object"&&et!==null&&(V=ji(et));var st=p.getDerivedStateFromProps;et=typeof st=="function"||typeof A.getSnapshotBeforeUpdate=="function",K=c.pendingProps!==K,et||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(K||Le!==V)&&iy(c,A,x,V),gs=!1;var Be=c.memoizedState;A.state=Be,lr(c,x,A,N),Ha(),Le=c.memoizedState,K||Be!==Le||gs?(typeof st=="function"&&(zc(c,p,st,x),Le=c.memoizedState),(ye=gs||nd(c,p,ye,x,Be,Le,V))?(et||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(c.flags|=4194308)):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=x,c.memoizedState=Le),A.props=x,A.state=Le,A.context=V,x=ye):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),x=!1)}else{A=c.stateNode,Rc(s,c),V=c.memoizedProps,et=qo(p,V),A.props=et,st=c.pendingProps,Be=A.context,Le=p.contextType,ye=Il,typeof Le=="object"&&Le!==null&&(ye=ji(Le)),K=p.getDerivedStateFromProps,(Le=typeof K=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(V!==st||Be!==ye)&&iy(c,A,x,ye),gs=!1,Be=c.memoizedState,A.state=Be,lr(c,x,A,N),Ha();var Fe=c.memoizedState;V!==st||Be!==Fe||gs||s!==null&&s.dependencies!==null&&hh(s.dependencies)?(typeof K=="function"&&(zc(c,p,K,x),Fe=c.memoizedState),(et=gs||nd(c,p,et,x,Be,Fe,ye)||s!==null&&s.dependencies!==null&&hh(s.dependencies))?(Le||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(x,Fe,ye),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(x,Fe,ye)),typeof A.componentDidUpdate=="function"&&(c.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof A.componentDidUpdate!="function"||V===s.memoizedProps&&Be===s.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||V===s.memoizedProps&&Be===s.memoizedState||(c.flags|=1024),c.memoizedProps=x,c.memoizedState=Fe),A.props=x,A.state=Fe,A.context=ye,x=et):(typeof A.componentDidUpdate!="function"||V===s.memoizedProps&&Be===s.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||V===s.memoizedProps&&Be===s.memoizedState||(c.flags|=1024),x=!1)}return A=x,Lt(s,c),x=(c.flags&128)!==0,A||x?(A=c.stateNode,p=x&&typeof p.getDerivedStateFromError!="function"?null:A.render(),c.flags|=1,s!==null&&x?(c.child=Wl(c,s.child,null,N),c.child=Wl(c,null,p,N)):ci(s,c,p,N),c.memoizedState=A.state,s=c.child):s=Zs(s,c,N),s}function ly(s,c,p,x){return Ru(),c.flags|=256,ci(s,c,p,x),c.child}var ad={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function $h(s){return{baseLanes:s,cachePool:Mg()}}function Wi(s,c,p){return s=s!==null?s.childLanes&~p:0,c&&(s|=va),s}function cy(s,c,p){var x=c.pendingProps,N=!1,A=(c.flags&128)!==0,V;if((V=A)||(V=s!==null&&s.memoizedState===null?!1:(_i.current&2)!==0),V&&(N=!0,c.flags&=-129),V=(c.flags&32)!==0,c.flags&=-33,s===null){if(vn){if(N?xa(c):Xs(),vn){var K=pi,ye;if(ye=K){e:{for(ye=K,K=Pr;ye.nodeType!==8;){if(!K){K=null;break e}if(ye=Qa(ye.nextSibling),ye===null){K=null;break e}}K=ye}K!==null?(c.memoizedState={dehydrated:K,treeContext:li!==null?{id:fi,overflow:Gs}:null,retryLane:536870912,hydrationErrors:null},ye=Dr(18,null,null,0),ye.stateNode=K,ye.return=c,c.child=ye,Fi=c,pi=null,ye=!0):ye=!1}ye||ma(c)}if(K=c.memoizedState,K!==null&&(K=K.dehydrated,K!==null))return Sr(K)?c.lanes=32:c.lanes=536870912,null;xs(c)}return K=x.children,x=x.fallback,N?(Xs(),N=c.mode,K=sd({mode:"hidden",children:K},N),x=Rl(x,N,p,null),K.return=c,x.return=c,K.sibling=x,c.child=K,N=c.child,N.memoizedState=$h(p),N.childLanes=Wi(s,V,p),c.memoizedState=ad,x):(xa(c),Hp(c,K))}if(ye=s.memoizedState,ye!==null&&(K=ye.dehydrated,K!==null)){if(A)c.flags&256?(xa(c),c.flags&=-257,c=Gp(s,c,p)):c.memoizedState!==null?(Xs(),c.child=s.child,c.flags|=128,c=null):(Xs(),N=x.fallback,K=c.mode,x=sd({mode:"visible",children:x.children},K),N=Rl(N,K,p,null),N.flags|=2,x.return=c,N.return=c,x.sibling=N,c.child=x,Wl(c,s.child,null,p),x=c.child,x.memoizedState=$h(p),x.childLanes=Wi(s,V,p),c.memoizedState=ad,c=N);else if(xa(c),Sr(K)){if(V=K.nextSibling&&K.nextSibling.dataset,V)var Le=V.dgst;V=Le,x=Error(r(419)),x.stack="",x.digest=V,Lo({value:x,source:null,stack:null}),c=Gp(s,c,p)}else if(Yi||Ou(s,c,p,!1),V=(p&s.childLanes)!==0,Yi||V){if(V=ii,V!==null&&(x=p&-p,x=(x&42)!==0?1:$t(x),x=(x&(V.suspendedLanes|p))!==0?0:x,x!==0&&x!==ye.retryLane))throw ye.retryLane=x,Ua(s,x),na(V,s,x),oy;K.data==="$?"||cm(),c=Gp(s,c,p)}else K.data==="$?"?(c.flags|=192,c.child=s.child,c=null):(s=ye.treeContext,pi=Qa(K.nextSibling),Fi=c,vn=!0,qa=null,Pr=!1,s!==null&&(fa[pa++]=fi,fa[pa++]=Gs,fa[pa++]=li,fi=s.id,Gs=s.overflow,li=c),c=Hp(c,x.children),c.flags|=4096);return c}return N?(Xs(),N=x.fallback,K=c.mode,ye=s.child,Le=ye.sibling,x=br(ye,{mode:"hidden",children:x.children}),x.subtreeFlags=ye.subtreeFlags&65011712,Le!==null?N=br(Le,N):(N=Rl(N,K,p,null),N.flags|=2),N.return=c,x.return=c,x.sibling=N,c.child=x,x=N,N=c.child,K=s.child.memoizedState,K===null?K=$h(p):(ye=K.cachePool,ye!==null?(Le=Xn._currentValue,ye=ye.parent!==Le?{parent:Le,pool:Le}:ye):ye=Mg(),K={baseLanes:K.baseLanes|p,cachePool:ye}),N.memoizedState=K,N.childLanes=Wi(s,V,p),c.memoizedState=ad,x):(xa(c),p=s.child,s=p.sibling,p=br(p,{mode:"visible",children:x.children}),p.return=c,p.sibling=null,s!==null&&(V=c.deletions,V===null?(c.deletions=[s],c.flags|=16):V.push(s)),c.child=p,c.memoizedState=null,p)}function Hp(s,c){return c=sd({mode:"visible",children:c},s.mode),c.return=s,s.child=c}function sd(s,c){return s=Dr(22,s,null,c),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Gp(s,c,p){return Wl(c,s.child,null,p),s=Hp(c,c.pendingProps.children),s.flags|=2,c.memoizedState=null,s}function Yp(s,c,p){s.lanes|=c;var x=s.alternate;x!==null&&(x.lanes|=c),Ir(s.return,c,p)}function Wp(s,c,p,x,N){var A=s.memoizedState;A===null?s.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:x,tail:p,tailMode:N}:(A.isBackwards=c,A.rendering=null,A.renderingStartTime=0,A.last=x,A.tail=p,A.tailMode=N)}function uy(s,c,p){var x=c.pendingProps,N=x.revealOrder,A=x.tail;if(ci(s,c,x.children,p),x=_i.current,(x&2)!==0)x=x&1|2,c.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=c.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Yp(s,p,c);else if(s.tag===19)Yp(s,p,c);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===c)break e;for(;s.sibling===null;){if(s.return===null||s.return===c)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}x&=1}switch(M(_i,x),N){case"forwards":for(p=c.child,N=null;p!==null;)s=p.alternate,s!==null&&ed(s)===null&&(N=p),p=p.sibling;p=N,p===null?(N=c.child,c.child=null):(N=p.sibling,p.sibling=null),Wp(c,!1,N,p,A);break;case"backwards":for(p=null,N=c.child,c.child=null;N!==null;){if(s=N.alternate,s!==null&&ed(s)===null){c.child=N;break}s=N.sibling,N.sibling=p,p=N,N=s}Wp(c,!0,p,null,A);break;case"together":Wp(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Zs(s,c,p){if(s!==null&&(c.dependencies=s.dependencies),Wo|=c.lanes,(p&c.childLanes)===0)if(s!==null){if(Ou(s,c,p,!1),(p&c.childLanes)===0)return null}else return null;if(s!==null&&c.child!==s.child)throw Error(r(153));if(c.child!==null){for(s=c.child,p=br(s,s.pendingProps),c.child=p,p.return=c;s.sibling!==null;)s=s.sibling,p=p.sibling=br(s,s.pendingProps),p.return=c;p.sibling=null}return c.child}function Ya(s,c){return(s.lanes&c)!==0?!0:(s=s.dependencies,!!(s!==null&&hh(s)))}function Nr(s,c,p){switch(c.tag){case 3:oe(c,c.stateNode.containerInfo),Kr(c,Xn,s.memoizedState.cache),Ru();break;case 27:case 5:Ee(c);break;case 4:oe(c,c.stateNode.containerInfo);break;case 10:Kr(c,c.type,c.memoizedProps.value);break;case 13:var x=c.memoizedState;if(x!==null)return x.dehydrated!==null?(xa(c),c.flags|=128,null):(p&c.child.childLanes)!==0?cy(s,c,p):(xa(c),s=Zs(s,c,p),s!==null?s.sibling:null);xa(c);break;case 19:var N=(s.flags&128)!==0;if(x=(p&c.childLanes)!==0,x||(Ou(s,c,p,!1),x=(p&c.childLanes)!==0),N){if(x)return uy(s,c,p);c.flags|=128}if(N=c.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),M(_i,_i.current),x)break;return null;case 22:case 23:return c.lanes=0,rd(s,c,p);case 24:Kr(c,Xn,s.memoizedState.cache)}return Zs(s,c,p)}function zh(s,c,p){if(s!==null)if(s.memoizedProps!==c.pendingProps)Yi=!0;else{if(!Ya(s,p)&&(c.flags&128)===0)return Yi=!1,Nr(s,c,p);Yi=(s.flags&131072)!==0}else Yi=!1,vn&&(c.flags&1048576)!==0&&mp(c,Pu,c.index);switch(c.lanes=0,c.tag){case 16:e:{s=c.pendingProps;var x=c.elementType,N=x._init;if(x=N(x._payload),c.type=x,typeof x=="function")Ml(x)?(s=qo(x,s),c.tag=1,c=Vo(null,c,x,s,p)):(c.tag=0,c=Bc(null,c,x,s,p));else{if(x!=null){if(N=x.$$typeof,N===q){c.tag=11,c=Rh(null,c,x,s,p);break e}else if(N===F){c.tag=14,c=Oh(null,c,x,s,p);break e}}throw c=ne(x)||x,Error(r(306,c,""))}}return c;case 0:return Bc(s,c,c.type,c.pendingProps,p);case 1:return x=c.type,N=qo(x,c.pendingProps),Vo(s,c,x,N,p);case 3:e:{if(oe(c,c.stateNode.containerInfo),s===null)throw Error(r(387));x=c.pendingProps;var A=c.memoizedState;N=A.element,Rc(s,c),lr(c,x,null,p);var V=c.memoizedState;if(x=V.cache,Kr(c,Xn,x),x!==A.cache&&fn(c,[Xn],p,!0),Ha(),x=V.element,A.isDehydrated)if(A={element:x,isDehydrated:!1,cache:V.cache},c.updateQueue.baseState=A,c.memoizedState=A,c.flags&256){c=ly(s,c,x,p);break e}else if(x!==N){N=Ne(Error(r(424)),c),Lo(N),c=ly(s,c,x,p);break e}else{switch(s=c.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(pi=Qa(s.firstChild),Fi=c,vn=!0,qa=null,Pr=!0,p=ty(c,null,x,p),c.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(Ru(),x===N){c=Zs(s,c,p);break e}ci(s,c,x,p)}c=c.child}return c;case 26:return Lt(s,c),s===null?(p=sx(c.type,null,c.pendingProps,null))?c.memoizedState=p:vn||(p=c.type,s=c.pendingProps,x=Zl(se.current).createElement(p),x[Pt]=c,x[Ut]=s,Ui(x,p,s),oi(x),c.stateNode=x):c.memoizedState=sx(c.type,s.memoizedProps,c.pendingProps,s.memoizedState),null;case 27:return Ee(c),s===null&&vn&&(x=c.stateNode=ix(c.type,c.pendingProps,se.current),Fi=c,Pr=!0,N=pi,wa(c.type)?(wm=N,pi=Qa(x.firstChild)):pi=N),ci(s,c,c.pendingProps.children,p),Lt(s,c),s===null&&(c.flags|=4194304),c.child;case 5:return s===null&&vn&&((N=x=pi)&&(x=tx(x,c.type,c.pendingProps,Pr),x!==null?(c.stateNode=x,Fi=c,pi=Qa(x.firstChild),Pr=!1,N=!0):N=!1),N||ma(c)),Ee(c),N=c.type,A=c.pendingProps,V=s!==null?s.memoizedProps:null,x=A.children,rf(N,A)?x=null:V!==null&&rf(N,V)&&(c.flags|=32),c.memoizedState!==null&&(N=Sp(s,c,jp,null,null,p),su._currentValue=N),Lt(s,c),ci(s,c,x,p),c.child;case 6:return s===null&&vn&&((s=p=pi)&&(p=sf(p,c.pendingProps,Pr),p!==null?(c.stateNode=p,Fi=c,pi=null,s=!0):s=!1),s||ma(c)),null;case 13:return cy(s,c,p);case 4:return oe(c,c.stateNode.containerInfo),x=c.pendingProps,s===null?c.child=Wl(c,null,x,p):ci(s,c,x,p),c.child;case 11:return Rh(s,c,c.type,c.pendingProps,p);case 7:return ci(s,c,c.pendingProps,p),c.child;case 8:return ci(s,c,c.pendingProps.children,p),c.child;case 12:return ci(s,c,c.pendingProps.children,p),c.child;case 10:return x=c.pendingProps,Kr(c,c.type,x.value),ci(s,c,x.children,p),c.child;case 9:return N=c.type._context,x=c.pendingProps.children,Fl(c),N=ji(N),x=x(N),c.flags|=1,ci(s,c,x,p),c.child;case 14:return Oh(s,c,c.type,c.pendingProps,p);case 15:return Lh(s,c,c.type,c.pendingProps,p);case 19:return uy(s,c,p);case 31:return x=c.pendingProps,p=c.mode,x={mode:x.mode,children:x.children},s===null?(p=sd(x,p),p.ref=c.ref,c.child=p,p.return=c,c=p):(p=br(s.child,x),p.ref=c.ref,c.child=p,p.return=c,c=p),c;case 22:return rd(s,c,p);case 24:return Fl(c),x=ji(Xn),s===null?(N=Ys(),N===null&&(N=ii,A=yp(),N.pooledCache=A,A.refCount++,A!==null&&(N.pooledCacheLanes|=p),N=A),c.memoizedState={parent:x,cache:N},zl(c),Kr(c,Xn,N)):((s.lanes&p)!==0&&(Rc(s,c),lr(c,null,null,p),Ha()),N=s.memoizedState,A=c.memoizedState,N.parent!==x?(N={parent:x,cache:x},c.memoizedState=N,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=N),Kr(c,Xn,x)):(x=A.cache,Kr(c,Xn,x),x!==N.cache&&fn(c,[Xn],p,!0))),ci(s,c,c.pendingProps.children,p),c.child;case 29:throw c.pendingProps}throw Error(r(156,c.tag))}function eo(s){s.flags|=4}function Bh(s,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!qi(c)){if(c=Zr.current,c!==null&&((En&4194048)===En?wr!==null:(En&62914560)!==En&&(En&536870912)===0||c!==wr))throw Mc=bp,Rg;s.flags|=8192}}function Uh(s,c){c!==null&&(s.flags|=4),s.flags&16384&&(c=s.tag!==22?wt():536870912,s.lanes|=c,Wc|=c)}function od(s,c){if(!vn)switch(s.tailMode){case"hidden":c=s.tail;for(var p=null;c!==null;)c.alternate!==null&&(p=c),c=c.sibling;p===null?s.tail=null:p.sibling=null;break;case"collapsed":p=s.tail;for(var x=null;p!==null;)p.alternate!==null&&(x=p),p=p.sibling;x===null?c||s.tail===null?s.tail=null:s.tail.sibling=null:x.sibling=null}}function Zn(s){var c=s.alternate!==null&&s.alternate.child===s.child,p=0,x=0;if(c)for(var N=s.child;N!==null;)p|=N.lanes|N.childLanes,x|=N.subtreeFlags&65011712,x|=N.flags&65011712,N.return=s,N=N.sibling;else for(N=s.child;N!==null;)p|=N.lanes|N.childLanes,x|=N.subtreeFlags,x|=N.flags,N.return=s,N=N.sibling;return s.subtreeFlags|=x,s.childLanes=p,c}function dy(s,c,p){var x=c.pendingProps;switch(Iu(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zn(c),null;case 1:return Zn(c),null;case 3:return p=c.stateNode,x=null,s!==null&&(x=s.memoizedState.cache),c.memoizedState.cache!==x&&(c.flags|=2048),ga(Xn),ue(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(s===null||s.child===null)&&(Mu(c)?eo(c):s===null||s.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Ag())),Zn(c),null;case 26:return p=c.memoizedState,s===null?(eo(c),p!==null?(Zn(c),Bh(c,p)):(Zn(c),c.flags&=-16777217)):p?p!==s.memoizedState?(eo(c),Zn(c),Bh(c,p)):(Zn(c),c.flags&=-16777217):(s.memoizedProps!==x&&eo(c),Zn(c),c.flags&=-16777217),null;case 27:Ie(c),p=se.current;var N=c.type;if(s!==null&&c.stateNode!=null)s.memoizedProps!==x&&eo(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Zn(c),null}s=ge.current,Mu(c)?Eg(c):(s=ix(N,x,p),c.stateNode=s,eo(c))}return Zn(c),null;case 5:if(Ie(c),p=c.type,s!==null&&c.stateNode!=null)s.memoizedProps!==x&&eo(c);else{if(!x){if(c.stateNode===null)throw Error(r(166));return Zn(c),null}if(s=ge.current,Mu(c))Eg(c);else{switch(N=Zl(se.current),s){case 1:s=N.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:s=N.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":s=N.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":s=N.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":s=N.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof x.is=="string"?N.createElement("select",{is:x.is}):N.createElement("select"),x.multiple?s.multiple=!0:x.size&&(s.size=x.size);break;default:s=typeof x.is=="string"?N.createElement(p,{is:x.is}):N.createElement(p)}}s[Pt]=c,s[Ut]=x;e:for(N=c.child;N!==null;){if(N.tag===5||N.tag===6)s.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===c)break e;for(;N.sibling===null;){if(N.return===null||N.return===c)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}c.stateNode=s;e:switch(Ui(s,p,x),p){case"button":case"input":case"select":case"textarea":s=!!x.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&eo(c)}}return Zn(c),c.flags&=-16777217,null;case 6:if(s&&c.stateNode!=null)s.memoizedProps!==x&&eo(c);else{if(typeof x!="string"&&c.stateNode===null)throw Error(r(166));if(s=se.current,Mu(c)){if(s=c.stateNode,p=c.memoizedProps,x=null,N=Fi,N!==null)switch(N.tag){case 27:case 5:x=N.memoizedProps}s[Pt]=c,s=!!(s.nodeValue===p||x!==null&&x.suppressHydrationWarning===!0||Ky(s.nodeValue,p)),s||ma(c)}else s=Zl(s).createTextNode(x),s[Pt]=c,c.stateNode=s}return Zn(c),null;case 13:if(x=c.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(N=Mu(c),x!==null&&x.dehydrated!==null){if(s===null){if(!N)throw Error(r(318));if(N=c.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(r(317));N[Pt]=c}else Ru(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Zn(c),N=!1}else N=Ag(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=N),N=!0;if(!N)return c.flags&256?(xs(c),c):(xs(c),null)}if(xs(c),(c.flags&128)!==0)return c.lanes=p,c;if(p=x!==null,s=s!==null&&s.memoizedState!==null,p){x=c.child,N=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(N=x.alternate.memoizedState.cachePool.pool);var A=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(A=x.memoizedState.cachePool.pool),A!==N&&(x.flags|=2048)}return p!==s&&p&&(c.child.flags|=8192),Uh(c,c.updateQueue),Zn(c),null;case 4:return ue(),s===null&&ym(c.stateNode.containerInfo),Zn(c),null;case 10:return ga(c.type),Zn(c),null;case 19:if(ve(_i),N=c.memoizedState,N===null)return Zn(c),null;if(x=(c.flags&128)!==0,A=N.rendering,A===null)if(x)od(N,!1);else{if(Ci!==0||s!==null&&(s.flags&128)!==0)for(s=c.child;s!==null;){if(A=ed(s),A!==null){for(c.flags|=128,od(N,!1),s=A.updateQueue,c.updateQueue=s,Uh(c,s),c.subtreeFlags=0,s=p,p=c.child;p!==null;)Du(p,s),p=p.sibling;return M(_i,_i.current&1|2),c.child}s=s.sibling}N.tail!==null&&Ge()>Qc&&(c.flags|=128,x=!0,od(N,!1),c.lanes=4194304)}else{if(!x)if(s=ed(A),s!==null){if(c.flags|=128,x=!0,s=s.updateQueue,c.updateQueue=s,Uh(c,s),od(N,!0),N.tail===null&&N.tailMode==="hidden"&&!A.alternate&&!vn)return Zn(c),null}else 2*Ge()-N.renderingStartTime>Qc&&p!==536870912&&(c.flags|=128,x=!0,od(N,!1),c.lanes=4194304);N.isBackwards?(A.sibling=c.child,c.child=A):(s=N.last,s!==null?s.sibling=A:c.child=A,N.last=A)}return N.tail!==null?(c=N.tail,N.rendering=c,N.tail=c.sibling,N.renderingStartTime=Ge(),c.sibling=null,s=_i.current,M(_i,x?s&1|2:s&1),c):(Zn(c),null);case 22:case 23:return xs(c),Np(),x=c.memoizedState!==null,s!==null?s.memoizedState!==null!==x&&(c.flags|=8192):x&&(c.flags|=8192),x?(p&536870912)!==0&&(c.flags&128)===0&&(Zn(c),c.subtreeFlags&6&&(c.flags|=8192)):Zn(c),p=c.updateQueue,p!==null&&Uh(c,p.retryQueue),p=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),x=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(x=c.memoizedState.cachePool.pool),x!==p&&(c.flags|=2048),s!==null&&ve($l),null;case 24:return p=null,s!==null&&(p=s.memoizedState.cache),c.memoizedState.cache!==p&&(c.flags|=2048),ga(Xn),Zn(c),null;case 25:return null;case 30:return null}throw Error(r(156,c.tag))}function hy(s,c){switch(Iu(c),c.tag){case 1:return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 3:return ga(Xn),ue(),s=c.flags,(s&65536)!==0&&(s&128)===0?(c.flags=s&-65537|128,c):null;case 26:case 27:case 5:return Ie(c),null;case 13:if(xs(c),s=c.memoizedState,s!==null&&s.dehydrated!==null){if(c.alternate===null)throw Error(r(340));Ru()}return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 19:return ve(_i),null;case 4:return ue(),null;case 10:return ga(c.type),null;case 22:case 23:return xs(c),Np(),s!==null&&ve($l),s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 24:return ga(Xn),null;case 25:return null;default:return null}}function fy(s,c){switch(Iu(c),c.tag){case 3:ga(Xn),ue();break;case 26:case 27:case 5:Ie(c);break;case 4:ue();break;case 13:xs(c);break;case 19:ve(_i);break;case 10:ga(c.type);break;case 22:case 23:xs(c),Np(),s!==null&&ve($l);break;case 24:ga(Xn)}}function ld(s,c){try{var p=c.updateQueue,x=p!==null?p.lastEffect:null;if(x!==null){var N=x.next;p=N;do{if((p.tag&s)===s){x=void 0;var A=p.create,V=p.inst;x=A(),V.destroy=x}p=p.next}while(p!==N)}}catch(K){ei(c,c.return,K)}}function Ho(s,c,p){try{var x=c.updateQueue,N=x!==null?x.lastEffect:null;if(N!==null){var A=N.next;x=A;do{if((x.tag&s)===s){var V=x.inst,K=V.destroy;if(K!==void 0){V.destroy=void 0,N=c;var ye=p,Le=K;try{Le()}catch(et){ei(N,ye,et)}}}x=x.next}while(x!==A)}}catch(et){ei(c,c.return,et)}}function py(s){var c=s.updateQueue;if(c!==null){var p=s.stateNode;try{wp(c,p)}catch(x){ei(s,s.return,x)}}}function Qp(s,c,p){p.props=qo(s.type,s.memoizedProps),p.state=s.memoizedState;try{p.componentWillUnmount()}catch(x){ei(s,c,x)}}function Uc(s,c){try{var p=s.ref;if(p!==null){switch(s.tag){case 26:case 27:case 5:var x=s.stateNode;break;case 30:x=s.stateNode;break;default:x=s.stateNode}typeof p=="function"?s.refCleanup=p(x):p.current=x}}catch(N){ei(s,c,N)}}function vs(s,c){var p=s.ref,x=s.refCleanup;if(p!==null)if(typeof x=="function")try{x()}catch(N){ei(s,c,N)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(N){ei(s,c,N)}else p.current=null}function qh(s){var c=s.type,p=s.memoizedProps,x=s.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":p.autoFocus&&x.focus();break e;case"img":p.src?x.src=p.src:p.srcSet&&(x.srcset=p.srcSet)}}catch(N){ei(s,s.return,N)}}function Vh(s,c,p){try{var x=s.stateNode;vv(x,s.type,p,c),x[Ut]=c}catch(N){ei(s,s.return,N)}}function qc(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&wa(s.type)||s.tag===4}function cd(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||qc(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&wa(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Hh(s,c,p){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(s,c):(c=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,c.appendChild(s),p=p._reactRootContainer,p!=null||c.onclick!==null||(c.onclick=tf));else if(x!==4&&(x===27&&wa(s.type)&&(p=s.stateNode,c=null),s=s.child,s!==null))for(Hh(s,c,p),s=s.sibling;s!==null;)Hh(s,c,p),s=s.sibling}function ud(s,c,p){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?p.insertBefore(s,c):p.appendChild(s);else if(x!==4&&(x===27&&wa(s.type)&&(p=s.stateNode),s=s.child,s!==null))for(ud(s,c,p),s=s.sibling;s!==null;)ud(s,c,p),s=s.sibling}function dd(s){var c=s.stateNode,p=s.memoizedProps;try{for(var x=s.type,N=c.attributes;N.length;)c.removeAttributeNode(N[0]);Ui(c,x,p),c[Pt]=s,c[Ut]=p}catch(A){ei(s,s.return,A)}}var ws=!1,Fn=!1,to=!1,my=typeof WeakSet=="function"?WeakSet:Set,zi=null;function sv(s,c){if(s=s.containerInfo,Wa=uf,s=sh(s),Pl(s)){if("selectionStart"in s)var p={start:s.selectionStart,end:s.selectionEnd};else e:{p=(p=s.ownerDocument)&&p.defaultView||window;var x=p.getSelection&&p.getSelection();if(x&&x.rangeCount!==0){p=x.anchorNode;var N=x.anchorOffset,A=x.focusNode;x=x.focusOffset;try{p.nodeType,A.nodeType}catch{p=null;break e}var V=0,K=-1,ye=-1,Le=0,et=0,st=s,Be=null;t:for(;;){for(var Fe;st!==p||N!==0&&st.nodeType!==3||(K=V+N),st!==A||x!==0&&st.nodeType!==3||(ye=V+x),st.nodeType===3&&(V+=st.nodeValue.length),(Fe=st.firstChild)!==null;)Be=st,st=Fe;for(;;){if(st===s)break t;if(Be===p&&++Le===N&&(K=V),Be===A&&++et===x&&(ye=V),(Fe=st.nextSibling)!==null)break;st=Be,Be=st.parentNode}st=Fe}p=K===-1||ye===-1?null:{start:K,end:ye}}else p=null}p=p||{start:0,end:0}}else p=null;for(nf={focusedElem:s,selectionRange:p},uf=!1,zi=c;zi!==null;)if(c=zi,s=c.child,(c.subtreeFlags&1024)!==0&&s!==null)s.return=c,zi=s;else for(;zi!==null;){switch(c=zi,A=c.alternate,s=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&A!==null){s=void 0,p=c,N=A.memoizedProps,A=A.memoizedState,x=p.stateNode;try{var qt=qo(p.type,N,p.elementType===p.type);s=x.getSnapshotBeforeUpdate(qt,A),x.__reactInternalSnapshotBeforeUpdate=s}catch(Bt){ei(p,p.return,Bt)}}break;case 3:if((s&1024)!==0){if(s=c.stateNode.containerInfo,p=s.nodeType,p===9)vm(s);else if(p===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":vm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=c.sibling,s!==null){s.return=c.return,zi=s;break}zi=c.return}}function gy(s,c,p){var x=p.flags;switch(p.tag){case 0:case 11:case 15:Go(s,p),x&4&&ld(5,p);break;case 1:if(Go(s,p),x&4)if(s=p.stateNode,c===null)try{s.componentDidMount()}catch(V){ei(p,p.return,V)}else{var N=qo(p.type,c.memoizedProps);c=c.memoizedState;try{s.componentDidUpdate(N,c,s.__reactInternalSnapshotBeforeUpdate)}catch(V){ei(p,p.return,V)}}x&64&&py(p),x&512&&Uc(p,p.return);break;case 3:if(Go(s,p),x&64&&(s=p.updateQueue,s!==null)){if(c=null,p.child!==null)switch(p.child.tag){case 27:case 5:c=p.child.stateNode;break;case 1:c=p.child.stateNode}try{wp(s,c)}catch(V){ei(p,p.return,V)}}break;case 27:c===null&&x&4&&dd(p);case 26:case 5:Go(s,p),c===null&&x&4&&qh(p),x&512&&Uc(p,p.return);break;case 12:Go(s,p);break;case 13:Go(s,p),x&4&&by(s,p),x&64&&(s=p.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(p=Jh.bind(null,p),tu(s,p))));break;case 22:if(x=p.memoizedState!==null||ws,!x){c=c!==null&&c.memoizedState!==null||Fn,N=ws;var A=Fn;ws=x,(Fn=c)&&!A?io(s,p,(p.subtreeFlags&8772)!==0):Go(s,p),ws=N,Fn=A}break;case 30:break;default:Go(s,p)}}function yy(s){var c=s.alternate;c!==null&&(s.alternate=null,yy(c)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(c=s.stateNode,c!==null&&ss(c)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var mi=null,Fr=!1;function no(s,c,p){for(p=p.child;p!==null;)xy(s,c,p),p=p.sibling}function xy(s,c,p){if(xe&&typeof xe.onCommitFiberUnmount=="function")try{xe.onCommitFiberUnmount(ie,p)}catch{}switch(p.tag){case 26:Fn||vs(p,c),no(s,c,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:Fn||vs(p,c);var x=mi,N=Fr;wa(p.type)&&(mi=p.stateNode,Fr=!1),no(s,c,p),Nd(p.stateNode),mi=x,Fr=N;break;case 5:Fn||vs(p,c);case 6:if(x=mi,N=Fr,mi=null,no(s,c,p),mi=x,Fr=N,mi!==null)if(Fr)try{(mi.nodeType===9?mi.body:mi.nodeName==="HTML"?mi.ownerDocument.body:mi).removeChild(p.stateNode)}catch(A){ei(p,c,A)}else try{mi.removeChild(p.stateNode)}catch(A){ei(p,c,A)}break;case 18:mi!==null&&(Fr?(s=mi,af(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,p.stateNode),Ad(s)):af(mi,p.stateNode));break;case 4:x=mi,N=Fr,mi=p.stateNode.containerInfo,Fr=!0,no(s,c,p),mi=x,Fr=N;break;case 0:case 11:case 14:case 15:Fn||Ho(2,p,c),Fn||Ho(4,p,c),no(s,c,p);break;case 1:Fn||(vs(p,c),x=p.stateNode,typeof x.componentWillUnmount=="function"&&Qp(p,c,x)),no(s,c,p);break;case 21:no(s,c,p);break;case 22:Fn=(x=Fn)||p.memoizedState!==null,no(s,c,p),Fn=x;break;default:no(s,c,p)}}function by(s,c){if(c.memoizedState===null&&(s=c.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Ad(s)}catch(p){ei(c,c.return,p)}}function ov(s){switch(s.tag){case 13:case 19:var c=s.stateNode;return c===null&&(c=s.stateNode=new my),c;case 22:return s=s.stateNode,c=s._retryCache,c===null&&(c=s._retryCache=new my),c;default:throw Error(r(435,s.tag))}}function Jp(s,c){var p=ov(s);c.forEach(function(x){var N=fv.bind(null,s,x);p.has(x)||(p.add(x),x.then(N,N))})}function ea(s,c){var p=c.deletions;if(p!==null)for(var x=0;x<p.length;x++){var N=p[x],A=s,V=c,K=V;e:for(;K!==null;){switch(K.tag){case 27:if(wa(K.type)){mi=K.stateNode,Fr=!1;break e}break;case 5:mi=K.stateNode,Fr=!1;break e;case 3:case 4:mi=K.stateNode.containerInfo,Fr=!0;break e}K=K.return}if(mi===null)throw Error(r(160));xy(A,V,N),mi=null,Fr=!1,A=N.alternate,A!==null&&(A.return=null),N.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)Kp(c,s),c=c.sibling}var ba=null;function Kp(s,c){var p=s.alternate,x=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:ea(c,s),$r(s),x&4&&(Ho(3,s,s.return),ld(3,s),Ho(5,s,s.return));break;case 1:ea(c,s),$r(s),x&512&&(Fn||p===null||vs(p,p.return)),x&64&&ws&&(s=s.updateQueue,s!==null&&(x=s.callbacks,x!==null&&(p=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=p===null?x:p.concat(x))));break;case 26:var N=ba;if(ea(c,s),$r(s),x&512&&(Fn||p===null||vs(p,p.return)),x&4){var A=p!==null?p.memoizedState:null;if(x=s.memoizedState,p===null)if(x===null)if(s.stateNode===null){e:{x=s.type,p=s.memoizedProps,N=N.ownerDocument||N;t:switch(x){case"title":A=N.getElementsByTagName("title")[0],(!A||A[hr]||A[Pt]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=N.createElement(x),N.head.insertBefore(A,N.querySelector("head > title"))),Ui(A,x,p),A[Pt]=s,oi(A),x=A;break e;case"link":var V=cx("link","href",N).get(x+(p.href||""));if(V){for(var K=0;K<V.length;K++)if(A=V[K],A.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&A.getAttribute("rel")===(p.rel==null?null:p.rel)&&A.getAttribute("title")===(p.title==null?null:p.title)&&A.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){V.splice(K,1);break t}}A=N.createElement(x),Ui(A,x,p),N.head.appendChild(A);break;case"meta":if(V=cx("meta","content",N).get(x+(p.content||""))){for(K=0;K<V.length;K++)if(A=V[K],A.getAttribute("content")===(p.content==null?null:""+p.content)&&A.getAttribute("name")===(p.name==null?null:p.name)&&A.getAttribute("property")===(p.property==null?null:p.property)&&A.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&A.getAttribute("charset")===(p.charSet==null?null:p.charSet)){V.splice(K,1);break t}}A=N.createElement(x),Ui(A,x,p),N.head.appendChild(A);break;default:throw Error(r(468,x))}A[Pt]=s,oi(A),x=A}s.stateNode=x}else ux(N,s.type,s.stateNode);else s.stateNode=lx(N,x,s.memoizedProps);else A!==x?(A===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):A.count--,x===null?ux(N,s.type,s.stateNode):lx(N,x,s.memoizedProps)):x===null&&s.stateNode!==null&&Vh(s,s.memoizedProps,p.memoizedProps)}break;case 27:ea(c,s),$r(s),x&512&&(Fn||p===null||vs(p,p.return)),p!==null&&x&4&&Vh(s,s.memoizedProps,p.memoizedProps);break;case 5:if(ea(c,s),$r(s),x&512&&(Fn||p===null||vs(p,p.return)),s.flags&32){N=s.stateNode;try{ls(N,"")}catch(Fe){ei(s,s.return,Fe)}}x&4&&s.stateNode!=null&&(N=s.memoizedProps,Vh(s,N,p!==null?p.memoizedProps:N)),x&1024&&(to=!0);break;case 6:if(ea(c,s),$r(s),x&4){if(s.stateNode===null)throw Error(r(162));x=s.memoizedProps,p=s.stateNode;try{p.nodeValue=x}catch(Fe){ei(s,s.return,Fe)}}break;case 3:if(au=null,N=ba,ba=tn(c.containerInfo),ea(c,s),ba=N,$r(s),x&4&&p!==null&&p.memoizedState.isDehydrated)try{Ad(c.containerInfo)}catch(Fe){ei(s,s.return,Fe)}to&&(to=!1,vy(s));break;case 4:x=ba,ba=tn(s.stateNode.containerInfo),ea(c,s),$r(s),ba=x;break;case 12:ea(c,s),$r(s);break;case 13:ea(c,s),$r(s),s.child.flags&8192&&s.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(rm=Ge()),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,Jp(s,x)));break;case 22:N=s.memoizedState!==null;var ye=p!==null&&p.memoizedState!==null,Le=ws,et=Fn;if(ws=Le||N,Fn=et||ye,ea(c,s),Fn=et,ws=Le,$r(s),x&8192)e:for(c=s.stateNode,c._visibility=N?c._visibility&-2:c._visibility|1,N&&(p===null||ye||ws||Fn||Kl(s)),p=null,c=s;;){if(c.tag===5||c.tag===26){if(p===null){ye=p=c;try{if(A=ye.stateNode,N)V=A.style,typeof V.setProperty=="function"?V.setProperty("display","none","important"):V.display="none";else{K=ye.stateNode;var st=ye.memoizedProps.style,Be=st!=null&&st.hasOwnProperty("display")?st.display:null;K.style.display=Be==null||typeof Be=="boolean"?"":(""+Be).trim()}}catch(Fe){ei(ye,ye.return,Fe)}}}else if(c.tag===6){if(p===null){ye=c;try{ye.stateNode.nodeValue=N?"":ye.memoizedProps}catch(Fe){ei(ye,ye.return,Fe)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===s)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break e;for(;c.sibling===null;){if(c.return===null||c.return===s)break e;p===c&&(p=null),c=c.return}p===c&&(p=null),c.sibling.return=c.return,c=c.sibling}x&4&&(x=s.updateQueue,x!==null&&(p=x.retryQueue,p!==null&&(x.retryQueue=null,Jp(s,p))));break;case 19:ea(c,s),$r(s),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,Jp(s,x)));break;case 30:break;case 21:break;default:ea(c,s),$r(s)}}function $r(s){var c=s.flags;if(c&2){try{for(var p,x=s.return;x!==null;){if(qc(x)){p=x;break}x=x.return}if(p==null)throw Error(r(160));switch(p.tag){case 27:var N=p.stateNode,A=cd(s);ud(s,A,N);break;case 5:var V=p.stateNode;p.flags&32&&(ls(V,""),p.flags&=-33);var K=cd(s);ud(s,K,V);break;case 3:case 4:var ye=p.stateNode.containerInfo,Le=cd(s);Hh(s,Le,ye);break;default:throw Error(r(161))}}catch(et){ei(s,s.return,et)}s.flags&=-3}c&4096&&(s.flags&=-4097)}function vy(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var c=s;vy(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),s=s.sibling}}function Go(s,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)gy(s,c.alternate,c),c=c.sibling}function Kl(s){for(s=s.child;s!==null;){var c=s;switch(c.tag){case 0:case 11:case 14:case 15:Ho(4,c,c.return),Kl(c);break;case 1:vs(c,c.return);var p=c.stateNode;typeof p.componentWillUnmount=="function"&&Qp(c,c.return,p),Kl(c);break;case 27:Nd(c.stateNode);case 26:case 5:vs(c,c.return),Kl(c);break;case 22:c.memoizedState===null&&Kl(c);break;case 30:Kl(c);break;default:Kl(c)}s=s.sibling}}function io(s,c,p){for(p=p&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var x=c.alternate,N=s,A=c,V=A.flags;switch(A.tag){case 0:case 11:case 15:io(N,A,p),ld(4,A);break;case 1:if(io(N,A,p),x=A,N=x.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(Le){ei(x,x.return,Le)}if(x=A,N=x.updateQueue,N!==null){var K=x.stateNode;try{var ye=N.shared.hiddenCallbacks;if(ye!==null)for(N.shared.hiddenCallbacks=null,N=0;N<ye.length;N++)$g(ye[N],K)}catch(Le){ei(x,x.return,Le)}}p&&V&64&&py(A),Uc(A,A.return);break;case 27:dd(A);case 26:case 5:io(N,A,p),p&&x===null&&V&4&&qh(A),Uc(A,A.return);break;case 12:io(N,A,p);break;case 13:io(N,A,p),p&&V&4&&by(N,A);break;case 22:A.memoizedState===null&&io(N,A,p),Uc(A,A.return);break;case 30:break;default:io(N,A,p)}c=c.sibling}}function Xp(s,c){var p=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),s=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(s=c.memoizedState.cachePool.pool),s!==p&&(s!=null&&s.refCount++,p!=null&&Lu(p))}function Zp(s,c){s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&Lu(s))}function Ns(s,c,p,x){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)wy(s,c,p,x),c=c.sibling}function wy(s,c,p,x){var N=c.flags;switch(c.tag){case 0:case 11:case 15:Ns(s,c,p,x),N&2048&&ld(9,c);break;case 1:Ns(s,c,p,x);break;case 3:Ns(s,c,p,x),N&2048&&(s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&Lu(s)));break;case 12:if(N&2048){Ns(s,c,p,x),s=c.stateNode;try{var A=c.memoizedProps,V=A.id,K=A.onPostCommit;typeof K=="function"&&K(V,c.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(ye){ei(c,c.return,ye)}}else Ns(s,c,p,x);break;case 13:Ns(s,c,p,x);break;case 23:break;case 22:A=c.stateNode,V=c.alternate,c.memoizedState!==null?A._visibility&2?Ns(s,c,p,x):hd(s,c):A._visibility&2?Ns(s,c,p,x):(A._visibility|=2,Vc(s,c,p,x,(c.subtreeFlags&10256)!==0)),N&2048&&Xp(V,c);break;case 24:Ns(s,c,p,x),N&2048&&Zp(c.alternate,c);break;default:Ns(s,c,p,x)}}function Vc(s,c,p,x,N){for(N=N&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var A=s,V=c,K=p,ye=x,Le=V.flags;switch(V.tag){case 0:case 11:case 15:Vc(A,V,K,ye,N),ld(8,V);break;case 23:break;case 22:var et=V.stateNode;V.memoizedState!==null?et._visibility&2?Vc(A,V,K,ye,N):hd(A,V):(et._visibility|=2,Vc(A,V,K,ye,N)),N&&Le&2048&&Xp(V.alternate,V);break;case 24:Vc(A,V,K,ye,N),N&&Le&2048&&Zp(V.alternate,V);break;default:Vc(A,V,K,ye,N)}c=c.sibling}}function hd(s,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var p=s,x=c,N=x.flags;switch(x.tag){case 22:hd(p,x),N&2048&&Xp(x.alternate,x);break;case 24:hd(p,x),N&2048&&Zp(x.alternate,x);break;default:hd(p,x)}c=c.sibling}}var ur=8192;function Hc(s){if(s.subtreeFlags&ur)for(s=s.child;s!==null;)Ny(s),s=s.sibling}function Ny(s){switch(s.tag){case 26:Hc(s),s.flags&ur&&s.memoizedState!==null&&Pv(ba,s.memoizedState,s.memoizedProps);break;case 5:Hc(s);break;case 3:case 4:var c=ba;ba=tn(s.stateNode.containerInfo),Hc(s),ba=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=ur,ur=16777216,Hc(s),ur=c):Hc(s));break;default:Hc(s)}}function Sy(s){var c=s.alternate;if(c!==null&&(s=c.child,s!==null)){c.child=null;do c=s.sibling,s.sibling=null,s=c;while(s!==null)}}function Gc(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var p=0;p<c.length;p++){var x=c[p];zi=x,_y(x,s)}Sy(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)jy(s),s=s.sibling}function jy(s){switch(s.tag){case 0:case 11:case 15:Gc(s),s.flags&2048&&Ho(9,s,s.return);break;case 3:Gc(s);break;case 12:Gc(s);break;case 22:var c=s.stateNode;s.memoizedState!==null&&c._visibility&2&&(s.return===null||s.return.tag!==13)?(c._visibility&=-3,Gh(s)):Gc(s);break;default:Gc(s)}}function Gh(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var p=0;p<c.length;p++){var x=c[p];zi=x,_y(x,s)}Sy(s)}for(s=s.child;s!==null;){switch(c=s,c.tag){case 0:case 11:case 15:Ho(8,c,c.return),Gh(c);break;case 22:p=c.stateNode,p._visibility&2&&(p._visibility&=-3,Gh(c));break;default:Gh(c)}s=s.sibling}}function _y(s,c){for(;zi!==null;){var p=zi;switch(p.tag){case 0:case 11:case 15:Ho(8,p,c);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var x=p.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Lu(p.memoizedState.cache)}if(x=p.child,x!==null)x.return=p,zi=x;else e:for(p=s;zi!==null;){x=zi;var N=x.sibling,A=x.return;if(yy(x),x===p){zi=null;break e}if(N!==null){N.return=A,zi=N;break e}zi=A}}}var lv={getCacheForType:function(s){var c=ji(Xn),p=c.data.get(s);return p===void 0&&(p=s(),c.data.set(s,p)),p}},em=typeof WeakMap=="function"?WeakMap:Map,Bn=0,ii=null,yn=null,En=0,Un=0,ta=null,Yo=!1,Yc=!1,tm=!1,ro=0,Ci=0,Wo=0,Xl=0,nm=0,va=0,Wc=0,fd=null,zr=null,im=!1,rm=0,Qc=1/0,pd=null,Qo=null,rr=0,Jo=null,Jc=null,Kc=0,am=0,sm=null,Cy=null,Xc=0,om=null;function dr(){if((Bn&2)!==0&&En!==0)return En&-En;if(X.T!==null){var s=Ic;return s!==0?s:Zh()}return be()}function ky(){va===0&&(va=(En&536870912)===0||vn?dt():536870912);var s=Zr.current;return s!==null&&(s.flags|=32),va}function na(s,c,p){(s===ii&&(Un===2||Un===9)||s.cancelPendingCommit!==null)&&(Zc(s,0),Ko(s,En,va,!1)),kt(s,p),((Bn&2)===0||s!==ii)&&(s===ii&&((Bn&2)===0&&(Xl|=p),Ci===4&&Ko(s,En,va,!1)),Ss(s))}function Ey(s,c,p){if((Bn&6)!==0)throw Error(r(327));var x=!p&&(c&124)===0&&(c&s.expiredLanes)===0||We(s,c),N=x?dv(s,c):um(s,c,!0),A=x;do{if(N===0){Yc&&!x&&Ko(s,c,0,!1);break}else{if(p=s.current.alternate,A&&!cv(p)){N=um(s,c,!1),A=!1;continue}if(N===2){if(A=c,s.errorRecoveryDisabledLanes&A)var V=0;else V=s.pendingLanes&-536870913,V=V!==0?V:V&536870912?536870912:0;if(V!==0){c=V;e:{var K=s;N=fd;var ye=K.current.memoizedState.isDehydrated;if(ye&&(Zc(K,V).flags|=256),V=um(K,V,!1),V!==2){if(tm&&!ye){K.errorRecoveryDisabledLanes|=A,Xl|=A,N=4;break e}A=zr,zr=N,A!==null&&(zr===null?zr=A:zr.push.apply(zr,A))}N=V}if(A=!1,N!==2)continue}}if(N===1){Zc(s,0),Ko(s,c,0,!0);break}e:{switch(x=s,A=N,A){case 0:case 1:throw Error(r(345));case 4:if((c&4194048)!==c)break;case 6:Ko(x,c,va,!Yo);break e;case 2:zr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((c&62914560)===c&&(N=rm+300-Ge(),10<N)){if(Ko(x,c,va,!Yo),$e(x,0,!0)!==0)break e;x.timeoutHandle=Xy(Ty.bind(null,x,p,zr,pd,im,c,va,Xl,Wc,Yo,A,2,-0,0),N);break e}Ty(x,p,zr,pd,im,c,va,Xl,Wc,Yo,A,0,-0,0)}}break}while(!0);Ss(s)}function Ty(s,c,p,x,N,A,V,K,ye,Le,et,st,Be,Fe){if(s.timeoutHandle=-1,st=c.subtreeFlags,(st&8192||(st&16785408)===16785408)&&(Qi={stylesheets:null,count:0,unsuspend:Dv},Ny(c),st=Iv(),st!==null)){s.cancelPendingCommit=st(md.bind(null,s,c,A,p,x,N,V,K,ye,et,1,Be,Fe)),Ko(s,A,V,!Le);return}md(s,c,A,p,x,N,V,K,ye)}function cv(s){for(var c=s;;){var p=c.tag;if((p===0||p===11||p===15)&&c.flags&16384&&(p=c.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var x=0;x<p.length;x++){var N=p[x],A=N.getSnapshot;N=N.value;try{if(!yr(A(),N))return!1}catch{return!1}}if(p=c.child,c.subtreeFlags&16384&&p!==null)p.return=c,c=p;else{if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Ko(s,c,p,x){c&=~nm,c&=~Xl,s.suspendedLanes|=c,s.pingedLanes&=~c,x&&(s.warmLanes|=c),x=s.expirationTimes;for(var N=c;0<N;){var A=31-we(N),V=1<<A;x[A]=-1,N&=~V}p!==0&&It(s,p,c)}function Yh(){return(Bn&6)===0?(xd(0),!1):!0}function lm(){if(yn!==null){if(Un===0)var s=yn.return;else s=yn,J=Fo=null,xh(s),$i=null,Lr=0,s=yn;for(;s!==null;)fy(s.alternate,s),s=s.return;yn=null}}function Zc(s,c){var p=s.timeoutHandle;p!==-1&&(s.timeoutHandle=-1,Nv(p)),p=s.cancelPendingCommit,p!==null&&(s.cancelPendingCommit=null,p()),lm(),ii=s,yn=p=br(s.current,null),En=c,Un=0,ta=null,Yo=!1,Yc=We(s,c),tm=!1,Wc=va=nm=Xl=Wo=Ci=0,zr=fd=null,im=!1,(c&8)!==0&&(c|=c&32);var x=s.entangledLanes;if(x!==0)for(s=s.entanglements,x&=c;0<x;){var N=31-we(x),A=1<<N;c|=s[N],x&=~A}return ro=c,Ct(),p}function Ay(s,c){ln=null,X.H=Xu,c===vr||c===mh?(c=Lg(),Un=3):c===Rg?(c=Lg(),Un=4):Un=c===oy?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,ta=c,yn===null&&(Ci=1,id(s,Ne(c,s.current)))}function Dy(){var s=X.H;return X.H=Xu,s===null?Xu:s}function Py(){var s=X.A;return X.A=lv,s}function cm(){Ci=4,Yo||(En&4194048)!==En&&Zr.current!==null||(Yc=!0),(Wo&134217727)===0&&(Xl&134217727)===0||ii===null||Ko(ii,En,va,!1)}function um(s,c,p){var x=Bn;Bn|=2;var N=Dy(),A=Py();(ii!==s||En!==c)&&(pd=null,Zc(s,c)),c=!1;var V=Ci;e:do try{if(Un!==0&&yn!==null){var K=yn,ye=ta;switch(Un){case 8:lm(),V=6;break e;case 3:case 2:case 9:case 6:Zr.current===null&&(c=!0);var Le=Un;if(Un=0,ta=null,eu(s,K,ye,Le),p&&Yc){V=0;break e}break;default:Le=Un,Un=0,ta=null,eu(s,K,ye,Le)}}uv(),V=Ci;break}catch(et){Ay(s,et)}while(!0);return c&&s.shellSuspendCounter++,J=Fo=null,Bn=x,X.H=N,X.A=A,yn===null&&(ii=null,En=0,Ct()),V}function uv(){for(;yn!==null;)dm(yn)}function dv(s,c){var p=Bn;Bn|=2;var x=Dy(),N=Py();ii!==s||En!==c?(pd=null,Qc=Ge()+500,Zc(s,c)):Yc=We(s,c);e:do try{if(Un!==0&&yn!==null){c=yn;var A=ta;t:switch(Un){case 1:Un=0,ta=null,eu(s,c,A,1);break;case 2:case 9:if(Og(A)){Un=0,ta=null,My(c);break}c=function(){Un!==2&&Un!==9||ii!==s||(Un=7),Ss(s)},A.then(c,c);break e;case 3:Un=7;break e;case 4:Un=5;break e;case 7:Og(A)?(Un=0,ta=null,My(c)):(Un=0,ta=null,eu(s,c,A,7));break;case 5:var V=null;switch(yn.tag){case 26:V=yn.memoizedState;case 5:case 27:var K=yn;if(!V||qi(V)){Un=0,ta=null;var ye=K.sibling;if(ye!==null)yn=ye;else{var Le=K.return;Le!==null?(yn=Le,Wh(Le)):yn=null}break t}}Un=0,ta=null,eu(s,c,A,5);break;case 6:Un=0,ta=null,eu(s,c,A,6);break;case 8:lm(),Ci=6;break e;default:throw Error(r(462))}}Iy();break}catch(et){Ay(s,et)}while(!0);return J=Fo=null,X.H=x,X.A=N,Bn=p,yn!==null?0:(ii=null,En=0,Ct(),Ci)}function Iy(){for(;yn!==null&&!Ye();)dm(yn)}function dm(s){var c=zh(s.alternate,s,ro);s.memoizedProps=s.pendingProps,c===null?Wh(s):yn=c}function My(s){var c=s,p=c.alternate;switch(c.tag){case 15:case 0:c=Fh(p,c,c.pendingProps,c.type,void 0,En);break;case 11:c=Fh(p,c,c.pendingProps,c.type.render,c.ref,En);break;case 5:xh(c);default:fy(p,c),c=yn=Du(c,ro),c=zh(p,c,ro)}s.memoizedProps=s.pendingProps,c===null?Wh(s):yn=c}function eu(s,c,p,x){J=Fo=null,xh(c),$i=null,Lr=0;var N=c.return;try{if(sy(s,N,c,p,En)){Ci=1,id(s,Ne(p,s.current)),yn=null;return}}catch(A){if(N!==null)throw yn=N,A;Ci=1,id(s,Ne(p,s.current)),yn=null;return}c.flags&32768?(vn||x===1?s=!0:Yc||(En&536870912)!==0?s=!1:(Yo=s=!0,(x===2||x===9||x===3||x===6)&&(x=Zr.current,x!==null&&x.tag===13&&(x.flags|=16384))),Ry(c,s)):Wh(c)}function Wh(s){var c=s;do{if((c.flags&32768)!==0){Ry(c,Yo);return}s=c.return;var p=dy(c.alternate,c,ro);if(p!==null){yn=p;return}if(c=c.sibling,c!==null){yn=c;return}yn=c=s}while(c!==null);Ci===0&&(Ci=5)}function Ry(s,c){do{var p=hy(s.alternate,s);if(p!==null){p.flags&=32767,yn=p;return}if(p=s.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!c&&(s=s.sibling,s!==null)){yn=s;return}yn=s=p}while(s!==null);Ci=6,yn=null}function md(s,c,p,x,N,A,V,K,ye){s.cancelPendingCommit=null;do Qh();while(rr!==0);if((Bn&6)!==0)throw Error(r(327));if(c!==null){if(c===s.current)throw Error(r(177));if(A=c.lanes|c.childLanes,A|=At,Tt(s,p,A,V,K,ye),s===ii&&(yn=ii=null,En=0),Jc=c,Jo=s,Kc=p,am=A,sm=N,Cy=x,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,qy(ze,function(){return zy(),null})):(s.callbackNode=null,s.callbackPriority=0),x=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||x){x=X.T,X.T=null,N=W.p,W.p=2,V=Bn,Bn|=4;try{sv(s,c,p)}finally{Bn=V,W.p=N,X.T=x}}rr=1,Oy(),Ly(),Fy()}}function Oy(){if(rr===1){rr=0;var s=Jo,c=Jc,p=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||p){p=X.T,X.T=null;var x=W.p;W.p=2;var N=Bn;Bn|=4;try{Kp(c,s);var A=nf,V=sh(s.containerInfo),K=A.focusedElem,ye=A.selectionRange;if(V!==K&&K&&K.ownerDocument&&ah(K.ownerDocument.documentElement,K)){if(ye!==null&&Pl(K)){var Le=ye.start,et=ye.end;if(et===void 0&&(et=Le),"selectionStart"in K)K.selectionStart=Le,K.selectionEnd=Math.min(et,K.value.length);else{var st=K.ownerDocument||document,Be=st&&st.defaultView||window;if(Be.getSelection){var Fe=Be.getSelection(),qt=K.textContent.length,Bt=Math.min(ye.start,qt),Yn=ye.end===void 0?Bt:Math.min(ye.end,qt);!Fe.extend&&Bt>Yn&&(V=Yn,Yn=Bt,Bt=V);var De=Au(K,Bt),Ce=Au(K,Yn);if(De&&Ce&&(Fe.rangeCount!==1||Fe.anchorNode!==De.node||Fe.anchorOffset!==De.offset||Fe.focusNode!==Ce.node||Fe.focusOffset!==Ce.offset)){var Oe=st.createRange();Oe.setStart(De.node,De.offset),Fe.removeAllRanges(),Bt>Yn?(Fe.addRange(Oe),Fe.extend(Ce.node,Ce.offset)):(Oe.setEnd(Ce.node,Ce.offset),Fe.addRange(Oe))}}}}for(st=[],Fe=K;Fe=Fe.parentNode;)Fe.nodeType===1&&st.push({element:Fe,left:Fe.scrollLeft,top:Fe.scrollTop});for(typeof K.focus=="function"&&K.focus(),K=0;K<st.length;K++){var it=st[K];it.element.scrollLeft=it.left,it.element.scrollTop=it.top}}uf=!!Wa,nf=Wa=null}finally{Bn=N,W.p=x,X.T=p}}s.current=c,rr=2}}function Ly(){if(rr===2){rr=0;var s=Jo,c=Jc,p=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||p){p=X.T,X.T=null;var x=W.p;W.p=2;var N=Bn;Bn|=4;try{gy(s,c.alternate,c)}finally{Bn=N,W.p=x,X.T=p}}rr=3}}function Fy(){if(rr===4||rr===3){rr=0,ut();var s=Jo,c=Jc,p=Kc,x=Cy;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?rr=5:(rr=0,Jc=Jo=null,$y(s,s.pendingLanes));var N=s.pendingLanes;if(N===0&&(Qo=null),en(p),c=c.stateNode,xe&&typeof xe.onCommitFiberRoot=="function")try{xe.onCommitFiberRoot(ie,c,void 0,(c.current.flags&128)===128)}catch{}if(x!==null){c=X.T,N=W.p,W.p=2,X.T=null;try{for(var A=s.onRecoverableError,V=0;V<x.length;V++){var K=x[V];A(K.value,{componentStack:K.stack})}}finally{X.T=c,W.p=N}}(Kc&3)!==0&&Qh(),Ss(s),N=s.pendingLanes,(p&4194090)!==0&&(N&42)!==0?s===om?Xc++:(Xc=0,om=s):Xc=0,xd(0)}}function $y(s,c){(s.pooledCacheLanes&=c)===0&&(c=s.pooledCache,c!=null&&(s.pooledCache=null,Lu(c)))}function Qh(s){return Oy(),Ly(),Fy(),zy()}function zy(){if(rr!==5)return!1;var s=Jo,c=am;am=0;var p=en(Kc),x=X.T,N=W.p;try{W.p=32>p?32:p,X.T=null,p=sm,sm=null;var A=Jo,V=Kc;if(rr=0,Jc=Jo=null,Kc=0,(Bn&6)!==0)throw Error(r(331));var K=Bn;if(Bn|=4,jy(A.current),wy(A,A.current,V,p),Bn=K,xd(0,!1),xe&&typeof xe.onPostCommitFiberRoot=="function")try{xe.onPostCommitFiberRoot(ie,A)}catch{}return!0}finally{W.p=N,X.T=x,$y(s,c)}}function By(s,c,p){c=Ne(p,c),c=Mh(s.stateNode,c,2),s=Ws(s,c,2),s!==null&&(kt(s,2),Ss(s))}function ei(s,c,p){if(s.tag===3)By(s,s,p);else for(;c!==null;){if(c.tag===3){By(c,s,p);break}else if(c.tag===1){var x=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Qo===null||!Qo.has(x))){s=Ne(p,s),p=Vp(2),x=Ws(c,p,2),x!==null&&(ay(p,x,c,s),kt(x,2),Ss(x));break}}c=c.return}}function hm(s,c,p){var x=s.pingCache;if(x===null){x=s.pingCache=new em;var N=new Set;x.set(c,N)}else N=x.get(c),N===void 0&&(N=new Set,x.set(c,N));N.has(p)||(tm=!0,N.add(p),s=hv.bind(null,s,c,p),c.then(s,s))}function hv(s,c,p){var x=s.pingCache;x!==null&&x.delete(c),s.pingedLanes|=s.suspendedLanes&p,s.warmLanes&=~p,ii===s&&(En&p)===p&&(Ci===4||Ci===3&&(En&62914560)===En&&300>Ge()-rm?(Bn&2)===0&&Zc(s,0):nm|=p,Wc===En&&(Wc=0)),Ss(s)}function Uy(s,c){c===0&&(c=wt()),s=Ua(s,c),s!==null&&(kt(s,c),Ss(s))}function Jh(s){var c=s.memoizedState,p=0;c!==null&&(p=c.retryLane),Uy(s,p)}function fv(s,c){var p=0;switch(s.tag){case 13:var x=s.stateNode,N=s.memoizedState;N!==null&&(p=N.retryLane);break;case 19:x=s.stateNode;break;case 22:x=s.stateNode._retryCache;break;default:throw Error(r(314))}x!==null&&x.delete(c),Uy(s,p)}function qy(s,c){return pe(s,c)}var gd=null,Xo=null,Kh=!1,yd=!1,Xh=!1,Zo=0;function Ss(s){s!==Xo&&s.next===null&&(Xo===null?gd=Xo=s:Xo=Xo.next=s),yd=!0,Kh||(Kh=!0,fm())}function xd(s,c){if(!Xh&&yd){Xh=!0;do for(var p=!1,x=gd;x!==null;){if(s!==0){var N=x.pendingLanes;if(N===0)var A=0;else{var V=x.suspendedLanes,K=x.pingedLanes;A=(1<<31-we(42|s)+1)-1,A&=N&~(V&~K),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(p=!0,Hy(x,A))}else A=En,A=$e(x,x===ii?A:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(A&3)===0||We(x,A)||(p=!0,Hy(x,A));x=x.next}while(p);Xh=!1}}function pv(){bd()}function bd(){yd=Kh=!1;var s=0;Zo!==0&&(wv()&&(s=Zo),Zo=0);for(var c=Ge(),p=null,x=gd;x!==null;){var N=x.next,A=vd(x,c);A===0?(x.next=null,p===null?gd=N:p.next=N,N===null&&(Xo=p)):(p=x,(s!==0||(A&3)!==0)&&(yd=!0)),x=N}xd(s)}function vd(s,c){for(var p=s.suspendedLanes,x=s.pingedLanes,N=s.expirationTimes,A=s.pendingLanes&-62914561;0<A;){var V=31-we(A),K=1<<V,ye=N[V];ye===-1?((K&p)===0||(K&x)!==0)&&(N[V]=ct(K,c)):ye<=c&&(s.expiredLanes|=K),A&=~K}if(c=ii,p=En,p=$e(s,s===c?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x=s.callbackNode,p===0||s===c&&(Un===2||Un===9)||s.cancelPendingCommit!==null)return x!==null&&x!==null&&Re(x),s.callbackNode=null,s.callbackPriority=0;if((p&3)===0||We(s,p)){if(c=p&-p,c===s.callbackPriority)return c;switch(x!==null&&Re(x),en(p)){case 2:case 8:p=Ue;break;case 32:p=ze;break;case 268435456:p=Ke;break;default:p=ze}return x=Vy.bind(null,s),p=pe(p,x),s.callbackPriority=c,s.callbackNode=p,c}return x!==null&&x!==null&&Re(x),s.callbackPriority=2,s.callbackNode=null,2}function Vy(s,c){if(rr!==0&&rr!==5)return s.callbackNode=null,s.callbackPriority=0,null;var p=s.callbackNode;if(Qh()&&s.callbackNode!==p)return null;var x=En;return x=$e(s,s===ii?x:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x===0?null:(Ey(s,x,c),vd(s,Ge()),s.callbackNode!=null&&s.callbackNode===p?Vy.bind(null,s):null)}function Hy(s,c){if(Qh())return null;Ey(s,c,!0)}function fm(){Sv(function(){(Bn&6)!==0?pe(qe,pv):bd()})}function Zh(){return Zo===0&&(Zo=dt()),Zo}function Gy(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Fs(""+s)}function Yy(s,c){var p=c.ownerDocument.createElement("input");return p.name=c.name,p.value=c.value,s.id&&p.setAttribute("form",s.id),c.parentNode.insertBefore(p,c),s=new FormData(s),p.parentNode.removeChild(p),s}function mv(s,c,p,x,N){if(c==="submit"&&p&&p.stateNode===N){var A=Gy((N[Ut]||null).action),V=x.submitter;V&&(c=(c=V[Ut]||null)?Gy(c.formAction):V.getAttribute("formAction"),c!==null&&(A=c,V=null));var K=new Bs("action","action",null,x,N);s.push({event:K,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Zo!==0){var ye=V?Yy(N,V):new FormData(N);Ju(p,{pending:!0,data:ye,method:N.method,action:A},null,ye)}}else typeof A=="function"&&(K.preventDefault(),ye=V?Yy(N,V):new FormData(N),Ju(p,{pending:!0,data:ye,method:N.method,action:A},A,ye))},currentTarget:N}]})}}for(var pm=0;pm<Q.length;pm++){var mm=Q[pm],gv=mm.toLowerCase(),yv=mm[0].toUpperCase()+mm.slice(1);le(gv,"on"+yv)}le(Tc,"onAnimationEnd"),le(oh,"onAnimationIteration"),le(xr,"onAnimationStart"),le("dblclick","onDoubleClick"),le("focusin","onFocus"),le("focusout","onBlur"),le(Ac,"onTransitionRun"),le(lh,"onTransitionStart"),le(Vs,"onTransitionCancel"),le(Io,"onTransitionEnd"),oa("onMouseEnter",["mouseout","mouseover"]),oa("onMouseLeave",["mouseout","mouseover"]),oa("onPointerEnter",["pointerout","pointerover"]),oa("onPointerLeave",["pointerout","pointerover"]),fr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),fr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),fr("onBeforeInput",["compositionend","keypress","textInput","paste"]),fr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),fr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),fr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(wd));function Wy(s,c){c=(c&4)!==0;for(var p=0;p<s.length;p++){var x=s[p],N=x.event;x=x.listeners;e:{var A=void 0;if(c)for(var V=x.length-1;0<=V;V--){var K=x[V],ye=K.instance,Le=K.currentTarget;if(K=K.listener,ye!==A&&N.isPropagationStopped())break e;A=K,N.currentTarget=Le;try{A(N)}catch(et){Ql(et)}N.currentTarget=null,A=ye}else for(V=0;V<x.length;V++){if(K=x[V],ye=K.instance,Le=K.currentTarget,K=K.listener,ye!==A&&N.isPropagationStopped())break e;A=K,N.currentTarget=Le;try{A(N)}catch(et){Ql(et)}N.currentTarget=null,A=ye}}}}function xn(s,c){var p=c[Ln];p===void 0&&(p=c[Ln]=new Set);var x=s+"__bubble";p.has(x)||(Qy(c,s,2,!1),p.add(x))}function gm(s,c,p){var x=0;c&&(x|=4),Qy(p,s,x,c)}var Br="_reactListening"+Math.random().toString(36).slice(2);function ym(s){if(!s[Br]){s[Br]=!0,vi.forEach(function(p){p!=="selectionchange"&&(xv.has(p)||gm(p,!1,s),gm(p,!0,s))});var c=s.nodeType===9?s:s.ownerDocument;c===null||c[Br]||(c[Br]=!0,gm("selectionchange",!1,c))}}function Qy(s,c,p,x){switch(px(c)){case 2:var N=Ov;break;case 8:N=ou;break;default:N=km}p=N.bind(null,c,p,s),N=void 0,!Co||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(N=!0),x?N!==void 0?s.addEventListener(c,p,{capture:!0,passive:N}):s.addEventListener(c,p,!0):N!==void 0?s.addEventListener(c,p,{passive:N}):s.addEventListener(c,p,!1)}function ao(s,c,p,x,N){var A=x;if((c&1)===0&&(c&2)===0&&x!==null)e:for(;;){if(x===null)return;var V=x.tag;if(V===3||V===4){var K=x.stateNode.containerInfo;if(K===N)break;if(V===4)for(V=x.return;V!==null;){var ye=V.tag;if((ye===3||ye===4)&&V.stateNode.containerInfo===N)return;V=V.return}for(;K!==null;){if(V=ni(K),V===null)return;if(ye=V.tag,ye===5||ye===6||ye===26||ye===27){x=A=V;continue e}K=K.parentNode}}x=x.return}_o(function(){var Le=A,et=wl(p),st=[];e:{var Be=Mo.get(s);if(Be!==void 0){var Fe=Bs,qt=s;switch(s){case"keypress":if(Mn(p)===0)break e;case"keydown":case"keyup":Fe=kl;break;case"focusin":qt="focus",Fe=jl;break;case"focusout":qt="blur",Fe=jl;break;case"beforeblur":case"afterblur":Fe=jl;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Fe=La;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Fe=ko;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Fe=sp;break;case Tc:case oh:case xr:Fe=_l;break;case Io:Fe=op;break;case"scroll":case"scrollend":Fe=Sl;break;case"wheel":Fe=cp;break;case"copy":case"cut":case"paste":Fe=Kd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Fe=Tr;break;case"toggle":case"beforetoggle":Fe=Sc}var Bt=(c&4)!==0,Yn=!Bt&&(s==="scroll"||s==="scrollend"),De=Bt?Be!==null?Be+"Capture":null:Be;Bt=[];for(var Ce=Le,Oe;Ce!==null;){var it=Ce;if(Oe=it.stateNode,it=it.tag,it!==5&&it!==26&&it!==27||Oe===null||De===null||(it=Nl(Ce,De),it!=null&&Bt.push(Jt(Ce,it,Oe))),Yn)break;Ce=Ce.return}0<Bt.length&&(Be=new Fe(Be,qt,null,p,et),st.push({event:Be,listeners:Bt}))}}if((c&7)===0){e:{if(Be=s==="mouseover"||s==="pointerover",Fe=s==="mouseout"||s==="pointerout",Be&&p!==jo&&(qt=p.relatedTarget||p.fromElement)&&(ni(qt)||qt[hn]))break e;if((Fe||Be)&&(Be=et.window===et?et:(Be=et.ownerDocument)?Be.defaultView||Be.parentWindow:window,Fe?(qt=p.relatedTarget||p.toElement,Fe=Le,qt=qt?ni(qt):null,qt!==null&&(Yn=o(qt),Bt=qt.tag,qt!==Yn||Bt!==5&&Bt!==27&&Bt!==6)&&(qt=null)):(Fe=null,qt=Le),Fe!==qt)){if(Bt=La,it="onMouseLeave",De="onMouseEnter",Ce="mouse",(s==="pointerout"||s==="pointerover")&&(Bt=Tr,it="onPointerLeave",De="onPointerEnter",Ce="pointer"),Yn=Fe==null?Be:Pi(Fe),Oe=qt==null?Be:Pi(qt),Be=new Bt(it,Ce+"leave",Fe,p,et),Be.target=Yn,Be.relatedTarget=Oe,it=null,ni(et)===Le&&(Bt=new Bt(De,Ce+"enter",qt,p,et),Bt.target=Oe,Bt.relatedTarget=Yn,it=Bt),Yn=it,Fe&&qt)t:{for(Bt=Fe,De=qt,Ce=0,Oe=Bt;Oe;Oe=Bi(Oe))Ce++;for(Oe=0,it=De;it;it=Bi(it))Oe++;for(;0<Ce-Oe;)Bt=Bi(Bt),Ce--;for(;0<Oe-Ce;)De=Bi(De),Oe--;for(;Ce--;){if(Bt===De||De!==null&&Bt===De.alternate)break t;Bt=Bi(Bt),De=Bi(De)}Bt=null}else Bt=null;Fe!==null&&ki(st,Be,Fe,Bt,!1),qt!==null&&Yn!==null&&ki(st,Yn,qt,Bt,!0)}}e:{if(Be=Le?Pi(Le):window,Fe=Be.nodeName&&Be.nodeName.toLowerCase(),Fe==="select"||Fe==="input"&&Be.type==="file")var Dt=Tu;else if(Jr(Be))if(Cc)Dt=dp;else{Dt=ps;var pn=rh}else Fe=Be.nodeName,!Fe||Fe.toLowerCase()!=="input"||Be.type!=="checkbox"&&Be.type!=="radio"?Le&&cs(Le.elementType)&&(Dt=Tu):Dt=Ec;if(Dt&&(Dt=Dt(s,Le))){gr(st,Dt,p,et);break e}pn&&pn(s,Be,Le),s==="focusout"&&Le&&Be.type==="number"&&Le.memoizedProps.value!=null&&No(Be,"number",Be.value)}switch(pn=Le?Pi(Le):window,s){case"focusin":(Jr(pn)||pn.contentEditable==="true")&&(Po=pn,ms=Le,ke=null);break;case"focusout":ke=ms=Po=null;break;case"mousedown":Xe=!0;break;case"contextmenu":case"mouseup":case"dragend":Xe=!1,He(st,p,et);break;case"selectionchange":if(fp)break;case"keydown":case"keyup":He(st,p,et)}var Rt;if(ku)e:{switch(s){case"compositionstart":var Vt="onCompositionStart";break e;case"compositionend":Vt="onCompositionEnd";break e;case"compositionupdate":Vt="onCompositionUpdate";break e}Vt=void 0}else fs?Tl(s,p)&&(Vt="onCompositionEnd"):s==="keydown"&&p.keyCode===229&&(Vt="onCompositionStart");Vt&&(Do&&p.locale!=="ko"&&(fs||Vt!=="onCompositionStart"?Vt==="onCompositionEnd"&&fs&&(Rt=Qd()):(da=et,vc="value"in da?da.value:da.textContent,fs=!0)),pn=ef(Le,Vt),0<pn.length&&(Vt=new nr(Vt,s,null,p,et),st.push({event:Vt,listeners:pn}),Rt?Vt.data=Rt:(Rt=_c(p),Rt!==null&&(Vt.data=Rt)))),(Rt=jc?up(s,p):eh(s,p))&&(Vt=ef(Le,"onBeforeInput"),0<Vt.length&&(pn=new nr("onBeforeInput","beforeinput",null,p,et),st.push({event:pn,listeners:Vt}),pn.data=Rt)),mv(st,s,Le,p,et)}Wy(st,c)})}function Jt(s,c,p){return{instance:s,listener:c,currentTarget:p}}function ef(s,c){for(var p=c+"Capture",x=[];s!==null;){var N=s,A=N.stateNode;if(N=N.tag,N!==5&&N!==26&&N!==27||A===null||(N=Nl(s,p),N!=null&&x.unshift(Jt(s,N,A)),N=Nl(s,c),N!=null&&x.push(Jt(s,N,A))),s.tag===3)return x;s=s.return}return[]}function Bi(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function ki(s,c,p,x,N){for(var A=c._reactName,V=[];p!==null&&p!==x;){var K=p,ye=K.alternate,Le=K.stateNode;if(K=K.tag,ye!==null&&ye===x)break;K!==5&&K!==26&&K!==27||Le===null||(ye=Le,N?(Le=Nl(p,A),Le!=null&&V.unshift(Jt(p,Le,ye))):N||(Le=Nl(p,A),Le!=null&&V.push(Jt(p,Le,ye)))),p=p.return}V.length!==0&&s.push({event:c,listeners:V})}var bv=/\r\n?/g,el=/\u0000|\uFFFD/g;function Jy(s){return(typeof s=="string"?s:""+s).replace(bv,`
`).replace(el,"")}function Ky(s,c){return c=Jy(c),Jy(s)===c}function tf(){}function Gn(s,c,p,x,N,A){switch(p){case"children":typeof x=="string"?c==="body"||c==="textarea"&&x===""||ls(s,x):(typeof x=="number"||typeof x=="bigint")&&c!=="body"&&ls(s,""+x);break;case"className":Ms(s,"class",x);break;case"tabIndex":Ms(s,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":Ms(s,p,x);break;case"style":bl(s,x,A);break;case"data":if(c!=="object"){Ms(s,"data",x);break}case"src":case"href":if(x===""&&(c!=="a"||p!=="href")){s.removeAttribute(p);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(p);break}x=Fs(""+x),s.setAttribute(p,x);break;case"action":case"formAction":if(typeof x=="function"){s.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(p==="formAction"?(c!=="input"&&Gn(s,c,"name",N.name,N,null),Gn(s,c,"formEncType",N.formEncType,N,null),Gn(s,c,"formMethod",N.formMethod,N,null),Gn(s,c,"formTarget",N.formTarget,N,null)):(Gn(s,c,"encType",N.encType,N,null),Gn(s,c,"method",N.method,N,null),Gn(s,c,"target",N.target,N,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(p);break}x=Fs(""+x),s.setAttribute(p,x);break;case"onClick":x!=null&&(s.onclick=tf);break;case"onScroll":x!=null&&xn("scroll",s);break;case"onScrollEnd":x!=null&&xn("scrollend",s);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(p=x.__html,p!=null){if(N.children!=null)throw Error(r(60));s.innerHTML=p}}break;case"multiple":s.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":s.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){s.removeAttribute("xlink:href");break}p=Fs(""+x),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,""+x):s.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,""):s.removeAttribute(p);break;case"capture":case"download":x===!0?s.setAttribute(p,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(p,x):s.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?s.setAttribute(p,x):s.removeAttribute(p);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?s.removeAttribute(p):s.setAttribute(p,x);break;case"popover":xn("beforetoggle",s),xn("toggle",s),gl(s,"popover",x);break;case"xlinkActuate":ca(s,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":ca(s,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":ca(s,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":ca(s,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":ca(s,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":ca(s,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":ca(s,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":ca(s,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":ca(s,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":gl(s,"is",x);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=vl.get(p)||p,gl(s,p,x))}}function xm(s,c,p,x,N,A){switch(p){case"style":bl(s,x,A);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(r(61));if(p=x.__html,p!=null){if(N.children!=null)throw Error(r(60));s.innerHTML=p}}break;case"children":typeof x=="string"?ls(s,x):(typeof x=="number"||typeof x=="bigint")&&ls(s,""+x);break;case"onScroll":x!=null&&xn("scroll",s);break;case"onScrollEnd":x!=null&&xn("scrollend",s);break;case"onClick":x!=null&&(s.onclick=tf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!sa.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(N=p.endsWith("Capture"),c=p.slice(2,N?p.length-7:void 0),A=s[Ut]||null,A=A!=null?A[p]:null,typeof A=="function"&&s.removeEventListener(c,A,N),typeof x=="function")){typeof A!="function"&&A!==null&&(p in s?s[p]=null:s.hasAttribute(p)&&s.removeAttribute(p)),s.addEventListener(c,x,N);break e}p in s?s[p]=x:x===!0?s.setAttribute(p,""):gl(s,p,x)}}}function Ui(s,c,p){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":xn("error",s),xn("load",s);var x=!1,N=!1,A;for(A in p)if(p.hasOwnProperty(A)){var V=p[A];if(V!=null)switch(A){case"src":x=!0;break;case"srcSet":N=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:Gn(s,c,A,V,p,null)}}N&&Gn(s,c,"srcSet",p.srcSet,p,null),x&&Gn(s,c,"src",p.src,p,null);return;case"input":xn("invalid",s);var K=A=V=N=null,ye=null,Le=null;for(x in p)if(p.hasOwnProperty(x)){var et=p[x];if(et!=null)switch(x){case"name":N=et;break;case"type":V=et;break;case"checked":ye=et;break;case"defaultChecked":Le=et;break;case"value":A=et;break;case"defaultValue":K=et;break;case"children":case"dangerouslySetInnerHTML":if(et!=null)throw Error(r(137,c));break;default:Gn(s,c,x,et,p,null)}}wo(s,A,K,ye,Le,V,N,!1),Os(s);return;case"select":xn("invalid",s),x=V=A=null;for(N in p)if(p.hasOwnProperty(N)&&(K=p[N],K!=null))switch(N){case"value":A=K;break;case"defaultValue":V=K;break;case"multiple":x=K;default:Gn(s,c,N,K,p,null)}c=A,p=V,s.multiple=!!x,c!=null?Ia(s,!!x,c,!1):p!=null&&Ia(s,!!x,p,!0);return;case"textarea":xn("invalid",s),A=N=x=null;for(V in p)if(p.hasOwnProperty(V)&&(K=p[V],K!=null))switch(V){case"value":x=K;break;case"defaultValue":N=K;break;case"children":A=K;break;case"dangerouslySetInnerHTML":if(K!=null)throw Error(r(91));break;default:Gn(s,c,V,K,p,null)}Ls(s,x,N,A),Os(s);return;case"option":for(ye in p)if(p.hasOwnProperty(ye)&&(x=p[ye],x!=null))switch(ye){case"selected":s.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:Gn(s,c,ye,x,p,null)}return;case"dialog":xn("beforetoggle",s),xn("toggle",s),xn("cancel",s),xn("close",s);break;case"iframe":case"object":xn("load",s);break;case"video":case"audio":for(x=0;x<wd.length;x++)xn(wd[x],s);break;case"image":xn("error",s),xn("load",s);break;case"details":xn("toggle",s);break;case"embed":case"source":case"link":xn("error",s),xn("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Le in p)if(p.hasOwnProperty(Le)&&(x=p[Le],x!=null))switch(Le){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:Gn(s,c,Le,x,p,null)}return;default:if(cs(c)){for(et in p)p.hasOwnProperty(et)&&(x=p[et],x!==void 0&&xm(s,c,et,x,p,void 0));return}}for(K in p)p.hasOwnProperty(K)&&(x=p[K],x!=null&&Gn(s,c,K,x,p,null))}function vv(s,c,p,x){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var N=null,A=null,V=null,K=null,ye=null,Le=null,et=null;for(Fe in p){var st=p[Fe];if(p.hasOwnProperty(Fe)&&st!=null)switch(Fe){case"checked":break;case"value":break;case"defaultValue":ye=st;default:x.hasOwnProperty(Fe)||Gn(s,c,Fe,null,x,st)}}for(var Be in x){var Fe=x[Be];if(st=p[Be],x.hasOwnProperty(Be)&&(Fe!=null||st!=null))switch(Be){case"type":A=Fe;break;case"name":N=Fe;break;case"checked":Le=Fe;break;case"defaultChecked":et=Fe;break;case"value":V=Fe;break;case"defaultValue":K=Fe;break;case"children":case"dangerouslySetInnerHTML":if(Fe!=null)throw Error(r(137,c));break;default:Fe!==st&&Gn(s,c,Be,Fe,x,st)}}yl(s,V,K,ye,Le,et,A,N);return;case"select":Fe=V=K=Be=null;for(A in p)if(ye=p[A],p.hasOwnProperty(A)&&ye!=null)switch(A){case"value":break;case"multiple":Fe=ye;default:x.hasOwnProperty(A)||Gn(s,c,A,null,x,ye)}for(N in x)if(A=x[N],ye=p[N],x.hasOwnProperty(N)&&(A!=null||ye!=null))switch(N){case"value":Be=A;break;case"defaultValue":K=A;break;case"multiple":V=A;default:A!==ye&&Gn(s,c,N,A,x,ye)}c=K,p=V,x=Fe,Be!=null?Ia(s,!!p,Be,!1):!!x!=!!p&&(c!=null?Ia(s,!!p,c,!0):Ia(s,!!p,p?[]:"",!1));return;case"textarea":Fe=Be=null;for(K in p)if(N=p[K],p.hasOwnProperty(K)&&N!=null&&!x.hasOwnProperty(K))switch(K){case"value":break;case"children":break;default:Gn(s,c,K,null,x,N)}for(V in x)if(N=x[V],A=p[V],x.hasOwnProperty(V)&&(N!=null||A!=null))switch(V){case"value":Be=N;break;case"defaultValue":Fe=N;break;case"children":break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(r(91));break;default:N!==A&&Gn(s,c,V,N,x,A)}So(s,Be,Fe);return;case"option":for(var qt in p)if(Be=p[qt],p.hasOwnProperty(qt)&&Be!=null&&!x.hasOwnProperty(qt))switch(qt){case"selected":s.selected=!1;break;default:Gn(s,c,qt,null,x,Be)}for(ye in x)if(Be=x[ye],Fe=p[ye],x.hasOwnProperty(ye)&&Be!==Fe&&(Be!=null||Fe!=null))switch(ye){case"selected":s.selected=Be&&typeof Be!="function"&&typeof Be!="symbol";break;default:Gn(s,c,ye,Be,x,Fe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Bt in p)Be=p[Bt],p.hasOwnProperty(Bt)&&Be!=null&&!x.hasOwnProperty(Bt)&&Gn(s,c,Bt,null,x,Be);for(Le in x)if(Be=x[Le],Fe=p[Le],x.hasOwnProperty(Le)&&Be!==Fe&&(Be!=null||Fe!=null))switch(Le){case"children":case"dangerouslySetInnerHTML":if(Be!=null)throw Error(r(137,c));break;default:Gn(s,c,Le,Be,x,Fe)}return;default:if(cs(c)){for(var Yn in p)Be=p[Yn],p.hasOwnProperty(Yn)&&Be!==void 0&&!x.hasOwnProperty(Yn)&&xm(s,c,Yn,void 0,x,Be);for(et in x)Be=x[et],Fe=p[et],!x.hasOwnProperty(et)||Be===Fe||Be===void 0&&Fe===void 0||xm(s,c,et,Be,x,Fe);return}}for(var De in p)Be=p[De],p.hasOwnProperty(De)&&Be!=null&&!x.hasOwnProperty(De)&&Gn(s,c,De,null,x,Be);for(st in x)Be=x[st],Fe=p[st],!x.hasOwnProperty(st)||Be===Fe||Be==null&&Fe==null||Gn(s,c,st,Be,x,Fe)}var Wa=null,nf=null;function Zl(s){return s.nodeType===9?s:s.ownerDocument}function gi(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ni(s,c){if(s===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&c==="foreignObject"?0:s}function rf(s,c){return s==="textarea"||s==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var bm=null;function wv(){var s=window.event;return s&&s.type==="popstate"?s===bm?!1:(bm=s,!0):(bm=null,!1)}var Xy=typeof setTimeout=="function"?setTimeout:void 0,Nv=typeof clearTimeout=="function"?clearTimeout:void 0,Zy=typeof Promise=="function"?Promise:void 0,Sv=typeof queueMicrotask=="function"?queueMicrotask:typeof Zy<"u"?function(s){return Zy.resolve(null).then(s).catch(ex)}:Xy;function ex(s){setTimeout(function(){throw s})}function wa(s){return s==="head"}function af(s,c){var p=c,x=0,N=0;do{var A=p.nextSibling;if(s.removeChild(p),A&&A.nodeType===8)if(p=A.data,p==="/$"){if(0<x&&8>x){p=x;var V=s.ownerDocument;if(p&1&&Nd(V.documentElement),p&2&&Nd(V.body),p&4)for(p=V.head,Nd(p),V=p.firstChild;V;){var K=V.nextSibling,ye=V.nodeName;V[hr]||ye==="SCRIPT"||ye==="STYLE"||ye==="LINK"&&V.rel.toLowerCase()==="stylesheet"||p.removeChild(V),V=K}}if(N===0){s.removeChild(A),Ad(c);return}N--}else p==="$"||p==="$?"||p==="$!"?N++:x=p.charCodeAt(0)-48;else x=0;p=A}while(p);Ad(c)}function vm(s){var c=s.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var p=c;switch(c=c.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":vm(p),ss(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}s.removeChild(p)}}function tx(s,c,p,x){for(;s.nodeType===1;){var N=p;if(s.nodeName.toLowerCase()!==c.toLowerCase()){if(!x&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(x){if(!s[hr])switch(c){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(A=s.getAttribute("rel"),A==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(A!==N.rel||s.getAttribute("href")!==(N.href==null||N.href===""?null:N.href)||s.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin)||s.getAttribute("title")!==(N.title==null?null:N.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(A=s.getAttribute("src"),(A!==(N.src==null?null:N.src)||s.getAttribute("type")!==(N.type==null?null:N.type)||s.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin))&&A&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(c==="input"&&s.type==="hidden"){var A=N.name==null?null:""+N.name;if(N.type==="hidden"&&s.getAttribute("name")===A)return s}else return s;if(s=Qa(s.nextSibling),s===null)break}return null}function sf(s,c,p){if(c==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!p||(s=Qa(s.nextSibling),s===null))return null;return s}function Sr(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function tu(s,c){var p=s.ownerDocument;if(s.data!=="$?"||p.readyState==="complete")c();else{var x=function(){c(),p.removeEventListener("DOMContentLoaded",x)};p.addEventListener("DOMContentLoaded",x),s._reactRetry=x}}function Qa(s){for(;s!=null;s=s.nextSibling){var c=s.nodeType;if(c===1||c===3)break;if(c===8){if(c=s.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return s}var wm=null;function nx(s){s=s.previousSibling;for(var c=0;s;){if(s.nodeType===8){var p=s.data;if(p==="$"||p==="$!"||p==="$?"){if(c===0)return s;c--}else p==="/$"&&c++}s=s.previousSibling}return null}function ix(s,c,p){switch(c=Zl(p),s){case"html":if(s=c.documentElement,!s)throw Error(r(452));return s;case"head":if(s=c.head,!s)throw Error(r(453));return s;case"body":if(s=c.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function Nd(s){for(var c=s.attributes;c.length;)s.removeAttributeNode(c[0]);ss(s)}var ia=new Map,js=new Set;function tn(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var _s=W.d;W.d={f:Na,r:rx,D:jv,C:ax,L:of,m:_v,X:kv,S:Cv,M:Ev};function Na(){var s=_s.f(),c=Yh();return s||c}function rx(s){var c=gn(s);c!==null&&c.tag===5&&c.type==="form"?Ah(c):_s.r(s)}var nu=typeof document>"u"?null:document;function On(s,c,p){var x=nu;if(x&&typeof c=="string"&&c){var N=tr(c);N='link[rel="'+s+'"][href="'+N+'"]',typeof p=="string"&&(N+='[crossorigin="'+p+'"]'),js.has(N)||(js.add(N),s={rel:s,crossOrigin:p,href:c},x.querySelector(N)===null&&(c=x.createElement("link"),Ui(c,"link",s),oi(c),x.head.appendChild(c)))}}function jv(s){_s.D(s),On("dns-prefetch",s,null)}function ax(s,c){_s.C(s,c),On("preconnect",s,c)}function of(s,c,p){_s.L(s,c,p);var x=nu;if(x&&s&&c){var N='link[rel="preload"][as="'+tr(c)+'"]';c==="image"&&p&&p.imageSrcSet?(N+='[imagesrcset="'+tr(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(N+='[imagesizes="'+tr(p.imageSizes)+'"]')):N+='[href="'+tr(s)+'"]';var A=N;switch(c){case"style":A=iu(s);break;case"script":A=ru(s)}ia.has(A)||(s=f({rel:"preload",href:c==="image"&&p&&p.imageSrcSet?void 0:s,as:c},p),ia.set(A,s),x.querySelector(N)!==null||c==="style"&&x.querySelector(Sd(A))||c==="script"&&x.querySelector(jd(A))||(c=x.createElement("link"),Ui(c,"link",s),oi(c),x.head.appendChild(c)))}}function _v(s,c){_s.m(s,c);var p=nu;if(p&&s){var x=c&&typeof c.as=="string"?c.as:"script",N='link[rel="modulepreload"][as="'+tr(x)+'"][href="'+tr(s)+'"]',A=N;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=ru(s)}if(!ia.has(A)&&(s=f({rel:"modulepreload",href:s},c),ia.set(A,s),p.querySelector(N)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(jd(A)))return}x=p.createElement("link"),Ui(x,"link",s),oi(x),p.head.appendChild(x)}}}function Cv(s,c,p){_s.S(s,c,p);var x=nu;if(x&&s){var N=er(x).hoistableStyles,A=iu(s);c=c||"default";var V=N.get(A);if(!V){var K={loading:0,preload:null};if(V=x.querySelector(Sd(A)))K.loading=5;else{s=f({rel:"stylesheet",href:s,"data-precedence":c},p),(p=ia.get(A))&&_d(s,p);var ye=V=x.createElement("link");oi(ye),Ui(ye,"link",s),ye._p=new Promise(function(Le,et){ye.onload=Le,ye.onerror=et}),ye.addEventListener("load",function(){K.loading|=1}),ye.addEventListener("error",function(){K.loading|=2}),K.loading|=4,lf(V,c,x)}V={type:"stylesheet",instance:V,count:1,state:K},N.set(A,V)}}}function kv(s,c){_s.X(s,c);var p=nu;if(p&&s){var x=er(p).hoistableScripts,N=ru(s),A=x.get(N);A||(A=p.querySelector(jd(N)),A||(s=f({src:s,async:!0},c),(c=ia.get(N))&&Nm(s,c),A=p.createElement("script"),oi(A),Ui(A,"link",s),p.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},x.set(N,A))}}function Ev(s,c){_s.M(s,c);var p=nu;if(p&&s){var x=er(p).hoistableScripts,N=ru(s),A=x.get(N);A||(A=p.querySelector(jd(N)),A||(s=f({src:s,async:!0,type:"module"},c),(c=ia.get(N))&&Nm(s,c),A=p.createElement("script"),oi(A),Ui(A,"link",s),p.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},x.set(N,A))}}function sx(s,c,p,x){var N=(N=se.current)?tn(N):null;if(!N)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(c=iu(p.href),p=er(N).hoistableStyles,x=p.get(c),x||(x={type:"style",instance:null,count:0,state:null},p.set(c,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){s=iu(p.href);var A=er(N).hoistableStyles,V=A.get(s);if(V||(N=N.ownerDocument||N,V={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(s,V),(A=N.querySelector(Sd(s)))&&!A._p&&(V.instance=A,V.state.loading=5),ia.has(s)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},ia.set(s,p),A||Tv(N,s,p,V.state))),c&&x===null)throw Error(r(528,""));return V}if(c&&x!==null)throw Error(r(529,""));return null;case"script":return c=p.async,p=p.src,typeof p=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=ru(p),p=er(N).hoistableScripts,x=p.get(c),x||(x={type:"script",instance:null,count:0,state:null},p.set(c,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function iu(s){return'href="'+tr(s)+'"'}function Sd(s){return'link[rel="stylesheet"]['+s+"]"}function ox(s){return f({},s,{"data-precedence":s.precedence,precedence:null})}function Tv(s,c,p,x){s.querySelector('link[rel="preload"][as="style"]['+c+"]")?x.loading=1:(c=s.createElement("link"),x.preload=c,c.addEventListener("load",function(){return x.loading|=1}),c.addEventListener("error",function(){return x.loading|=2}),Ui(c,"link",p),oi(c),s.head.appendChild(c))}function ru(s){return'[src="'+tr(s)+'"]'}function jd(s){return"script[async]"+s}function lx(s,c,p){if(c.count++,c.instance===null)switch(c.type){case"style":var x=s.querySelector('style[data-href~="'+tr(p.href)+'"]');if(x)return c.instance=x,oi(x),x;var N=f({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return x=(s.ownerDocument||s).createElement("style"),oi(x),Ui(x,"style",N),lf(x,p.precedence,s),c.instance=x;case"stylesheet":N=iu(p.href);var A=s.querySelector(Sd(N));if(A)return c.state.loading|=4,c.instance=A,oi(A),A;x=ox(p),(N=ia.get(N))&&_d(x,N),A=(s.ownerDocument||s).createElement("link"),oi(A);var V=A;return V._p=new Promise(function(K,ye){V.onload=K,V.onerror=ye}),Ui(A,"link",x),c.state.loading|=4,lf(A,p.precedence,s),c.instance=A;case"script":return A=ru(p.src),(N=s.querySelector(jd(A)))?(c.instance=N,oi(N),N):(x=p,(N=ia.get(A))&&(x=f({},p),Nm(x,N)),s=s.ownerDocument||s,N=s.createElement("script"),oi(N),Ui(N,"link",x),s.head.appendChild(N),c.instance=N);case"void":return null;default:throw Error(r(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(x=c.instance,c.state.loading|=4,lf(x,p.precedence,s));return c.instance}function lf(s,c,p){for(var x=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),N=x.length?x[x.length-1]:null,A=N,V=0;V<x.length;V++){var K=x[V];if(K.dataset.precedence===c)A=K;else if(A!==N)break}A?A.parentNode.insertBefore(s,A.nextSibling):(c=p.nodeType===9?p.head:p,c.insertBefore(s,c.firstChild))}function _d(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.title==null&&(s.title=c.title)}function Nm(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.integrity==null&&(s.integrity=c.integrity)}var au=null;function cx(s,c,p){if(au===null){var x=new Map,N=au=new Map;N.set(p,x)}else N=au,x=N.get(p),x||(x=new Map,N.set(p,x));if(x.has(s))return x;for(x.set(s,null),p=p.getElementsByTagName(s),N=0;N<p.length;N++){var A=p[N];if(!(A[hr]||A[Pt]||s==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var V=A.getAttribute(c)||"";V=s+V;var K=x.get(V);K?K.push(A):x.set(V,[A])}}return x}function ux(s,c,p){s=s.ownerDocument||s,s.head.insertBefore(p,c==="title"?s.querySelector("head > title"):null)}function Av(s,c,p){if(p===1||c.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return s=c.disabled,typeof c.precedence=="string"&&s==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function qi(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var Qi=null;function Dv(){}function Pv(s,c,p){if(Qi===null)throw Error(r(475));var x=Qi;if(c.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var N=iu(p.href),A=s.querySelector(Sd(N));if(A){s=A._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(x.count++,x=Cd.bind(x),s.then(x,x)),c.state.loading|=4,c.instance=A,oi(A);return}A=s.ownerDocument||s,p=ox(p),(N=ia.get(N))&&_d(p,N),A=A.createElement("link"),oi(A);var V=A;V._p=new Promise(function(K,ye){V.onload=K,V.onerror=ye}),Ui(A,"link",p),c.instance=A}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(x.count++,c=Cd.bind(x),s.addEventListener("load",c),s.addEventListener("error",c))}}function Iv(){if(Qi===null)throw Error(r(475));var s=Qi;return s.stylesheets&&s.count===0&&Sm(s,s.stylesheets),0<s.count?function(c){var p=setTimeout(function(){if(s.stylesheets&&Sm(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(p)}}:null}function Cd(){if(this.count--,this.count===0){if(this.stylesheets)Sm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var cf=null;function Sm(s,c){s.stylesheets=null,s.unsuspend!==null&&(s.count++,cf=new Map,c.forEach(Mv,s),cf=null,Cd.call(s))}function Mv(s,c){if(!(c.state.loading&4)){var p=cf.get(s);if(p)var x=p.get(null);else{p=new Map,cf.set(s,p);for(var N=s.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<N.length;A++){var V=N[A];(V.nodeName==="LINK"||V.getAttribute("media")!=="not all")&&(p.set(V.dataset.precedence,V),x=V)}x&&p.set(null,x)}N=c.instance,V=N.getAttribute("data-precedence"),A=p.get(V)||x,A===x&&p.set(null,N),p.set(V,N),this.count++,x=Cd.bind(this),N.addEventListener("load",x),N.addEventListener("error",x),A?A.parentNode.insertBefore(N,A.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(N,s.firstChild)),c.state.loading|=4}}var su={$$typeof:I,Provider:null,Consumer:null,_currentValue:H,_currentValue2:H,_threadCount:0};function Rv(s,c,p,x,N,A,V,K){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=bt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bt(0),this.hiddenUpdates=bt(null),this.identifierPrefix=x,this.onUncaughtError=N,this.onCaughtError=A,this.onRecoverableError=V,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=K,this.incompleteTransitions=new Map}function dx(s,c,p,x,N,A,V,K,ye,Le,et,st){return s=new Rv(s,c,p,V,K,ye,Le,st),c=1,A===!0&&(c|=24),A=Dr(3,null,null,c),s.current=A,A.stateNode=s,c=yp(),c.refCount++,s.pooledCache=c,c.refCount++,A.memoizedState={element:x,isDehydrated:p,cache:c},zl(A),s}function hx(s){return s?(s=Il,s):Il}function jm(s,c,p,x,N,A){N=hx(N),x.context===null?x.context=N:x.pendingContext=N,x=$o(c),x.payload={element:p},A=A===void 0?null:A,A!==null&&(x.callback=A),p=Ws(s,x,c),p!==null&&(na(p,s,c),$u(p,s,c))}function _m(s,c){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var p=s.retryLane;s.retryLane=p!==0&&p<c?p:c}}function Cm(s,c){_m(s,c),(s=s.alternate)&&_m(s,c)}function fx(s){if(s.tag===13){var c=Ua(s,67108864);c!==null&&na(c,s,67108864),Cm(s,67108864)}}var uf=!0;function Ov(s,c,p,x){var N=X.T;X.T=null;var A=W.p;try{W.p=2,km(s,c,p,x)}finally{W.p=A,X.T=N}}function ou(s,c,p,x){var N=X.T;X.T=null;var A=W.p;try{W.p=8,km(s,c,p,x)}finally{W.p=A,X.T=N}}function km(s,c,p,x){if(uf){var N=Em(x);if(N===null)ao(s,c,x,df,p),mx(s,x);else if(Fv(N,s,c,p,x))x.stopPropagation();else if(mx(s,x),c&4&&-1<Lv.indexOf(s)){for(;N!==null;){var A=gn(N);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var V=Ve(A.pendingLanes);if(V!==0){var K=A;for(K.pendingLanes|=2,K.entangledLanes|=2;V;){var ye=1<<31-we(V);K.entanglements[1]|=ye,V&=~ye}Ss(A),(Bn&6)===0&&(Qc=Ge()+500,xd(0))}}break;case 13:K=Ua(A,2),K!==null&&na(K,A,2),Yh(),Cm(A,2)}if(A=Em(x),A===null&&ao(s,c,x,df,p),A===N)break;N=A}N!==null&&x.stopPropagation()}else ao(s,c,x,null,p)}}function Em(s){return s=wl(s),Tm(s)}var df=null;function Tm(s){if(df=null,s=ni(s),s!==null){var c=o(s);if(c===null)s=null;else{var p=c.tag;if(p===13){if(s=l(c),s!==null)return s;s=null}else if(p===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;s=null}else c!==s&&(s=null)}}return df=s,null}function px(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Se()){case qe:return 2;case Ue:return 8;case ze:case lt:return 32;case Ke:return 268435456;default:return 32}default:return 32}}var hf=!1,so=null,tl=null,nl=null,kd=new Map,Ed=new Map,il=[],Lv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function mx(s,c){switch(s){case"focusin":case"focusout":so=null;break;case"dragenter":case"dragleave":tl=null;break;case"mouseover":case"mouseout":nl=null;break;case"pointerover":case"pointerout":kd.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ed.delete(c.pointerId)}}function Td(s,c,p,x,N,A){return s===null||s.nativeEvent!==A?(s={blockedOn:c,domEventName:p,eventSystemFlags:x,nativeEvent:A,targetContainers:[N]},c!==null&&(c=gn(c),c!==null&&fx(c)),s):(s.eventSystemFlags|=x,c=s.targetContainers,N!==null&&c.indexOf(N)===-1&&c.push(N),s)}function Fv(s,c,p,x,N){switch(c){case"focusin":return so=Td(so,s,c,p,x,N),!0;case"dragenter":return tl=Td(tl,s,c,p,x,N),!0;case"mouseover":return nl=Td(nl,s,c,p,x,N),!0;case"pointerover":var A=N.pointerId;return kd.set(A,Td(kd.get(A)||null,s,c,p,x,N)),!0;case"gotpointercapture":return A=N.pointerId,Ed.set(A,Td(Ed.get(A)||null,s,c,p,x,N)),!0}return!1}function gx(s){var c=ni(s.target);if(c!==null){var p=o(c);if(p!==null){if(c=p.tag,c===13){if(c=l(p),c!==null){s.blockedOn=c,nt(s.priority,function(){if(p.tag===13){var x=dr();x=$t(x);var N=Ua(p,x);N!==null&&na(N,p,x),Cm(p,x)}});return}}else if(c===3&&p.stateNode.current.memoizedState.isDehydrated){s.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ff(s){if(s.blockedOn!==null)return!1;for(var c=s.targetContainers;0<c.length;){var p=Em(s.nativeEvent);if(p===null){p=s.nativeEvent;var x=new p.constructor(p.type,p);jo=x,p.target.dispatchEvent(x),jo=null}else return c=gn(p),c!==null&&fx(c),s.blockedOn=p,!1;c.shift()}return!0}function yx(s,c,p){ff(s)&&p.delete(c)}function $v(){hf=!1,so!==null&&ff(so)&&(so=null),tl!==null&&ff(tl)&&(tl=null),nl!==null&&ff(nl)&&(nl=null),kd.forEach(yx),Ed.forEach(yx)}function pf(s,c){s.blockedOn===c&&(s.blockedOn=null,hf||(hf=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,$v)))}var mf=null;function xx(s){mf!==s&&(mf=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){mf===s&&(mf=null);for(var c=0;c<s.length;c+=3){var p=s[c],x=s[c+1],N=s[c+2];if(typeof x!="function"){if(Tm(x||p)===null)continue;break}var A=gn(p);A!==null&&(s.splice(c,3),c-=3,Ju(A,{pending:!0,data:N,method:p.method,action:x},x,N))}}))}function Ad(s){function c(ye){return pf(ye,s)}so!==null&&pf(so,s),tl!==null&&pf(tl,s),nl!==null&&pf(nl,s),kd.forEach(c),Ed.forEach(c);for(var p=0;p<il.length;p++){var x=il[p];x.blockedOn===s&&(x.blockedOn=null)}for(;0<il.length&&(p=il[0],p.blockedOn===null);)gx(p),p.blockedOn===null&&il.shift();if(p=(s.ownerDocument||s).$$reactFormReplay,p!=null)for(x=0;x<p.length;x+=3){var N=p[x],A=p[x+1],V=N[Ut]||null;if(typeof A=="function")V||xx(p);else if(V){var K=null;if(A&&A.hasAttribute("formAction")){if(N=A,V=A[Ut]||null)K=V.formAction;else if(Tm(N)!==null)continue}else K=V.action;typeof K=="function"?p[x+1]=K:(p.splice(x,3),x-=3),xx(p)}}}function Am(s){this._internalRoot=s}gf.prototype.render=Am.prototype.render=function(s){var c=this._internalRoot;if(c===null)throw Error(r(409));var p=c.current,x=dr();jm(p,x,s,c,null,null)},gf.prototype.unmount=Am.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var c=s.containerInfo;jm(s.current,2,null,s,null,null),Yh(),c[hn]=null}};function gf(s){this._internalRoot=s}gf.prototype.unstable_scheduleHydration=function(s){if(s){var c=be();s={blockedOn:null,target:s,priority:c};for(var p=0;p<il.length&&c!==0&&c<il[p].priority;p++);il.splice(p,0,s),p===0&&gx(s)}};var bx=n.version;if(bx!=="19.1.0")throw Error(r(527,bx,"19.1.0"));W.findDOMNode=function(s){var c=s._reactInternals;if(c===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(c),s=s!==null?u(s):null,s=s===null?null:s.stateNode,s};var zv={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:X,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yf.isDisabled&&yf.supportsFiber)try{ie=yf.inject(zv),xe=yf}catch{}}return Pm.createRoot=function(s,c){if(!a(s))throw Error(r(299));var p=!1,x="",N=qp,A=Ih,V=ry,K=null;return c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(N=c.onUncaughtError),c.onCaughtError!==void 0&&(A=c.onCaughtError),c.onRecoverableError!==void 0&&(V=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(K=c.unstable_transitionCallbacks)),c=dx(s,1,!1,null,null,p,x,N,A,V,K,null),s[hn]=c.current,ym(s),new Am(c)},Pm.hydrateRoot=function(s,c,p){if(!a(s))throw Error(r(299));var x=!1,N="",A=qp,V=Ih,K=ry,ye=null,Le=null;return p!=null&&(p.unstable_strictMode===!0&&(x=!0),p.identifierPrefix!==void 0&&(N=p.identifierPrefix),p.onUncaughtError!==void 0&&(A=p.onUncaughtError),p.onCaughtError!==void 0&&(V=p.onCaughtError),p.onRecoverableError!==void 0&&(K=p.onRecoverableError),p.unstable_transitionCallbacks!==void 0&&(ye=p.unstable_transitionCallbacks),p.formState!==void 0&&(Le=p.formState)),c=dx(s,1,!0,c,p??null,x,N,A,V,K,ye,Le),c.context=hx(null),p=c.current,x=dr(),x=$t(x),N=$o(x),N.callback=null,Ws(p,N,x),p=x,c.current.lanes=p,kt(c,p),Ss(c),s[hn]=c.current,ym(s),new gf(c)},Pm.version="19.1.0",Pm}var vN;function RA(){if(vN)return Gv.exports;vN=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),Gv.exports=MA(),Gv.exports}var OA=RA();function LA(e={}){const{nonce:n,locale:t,onScriptLoadSuccess:r,onScriptLoadError:a}=e,[o,l]=w.useState(!1),h=w.useRef(r);h.current=r;const d=w.useRef(a);return d.current=a,w.useEffect(()=>{const u=document.createElement("script");return u.src="https://accounts.google.com/gsi/client",t&&(u.src+=`?hl=${t}`),u.async=!0,u.defer=!0,u.nonce=n,u.onload=()=>{var f;l(!0),(f=h.current)===null||f===void 0||f.call(h)},u.onerror=()=>{var f;l(!1),(f=d.current)===null||f===void 0||f.call(d)},document.body.appendChild(u),()=>{document.body.removeChild(u)}},[n]),o}const NC=w.createContext(null);function FA({clientId:e,nonce:n,locale:t,onScriptLoadSuccess:r,onScriptLoadError:a,children:o}){const l=LA({nonce:n,onScriptLoadSuccess:r,onScriptLoadError:a,locale:t}),h=w.useMemo(()=>({locale:t,clientId:e,scriptLoadedSuccessfully:l}),[e,l]);return Pn.createElement(NC.Provider,{value:h},o)}function $A(){const e=w.useContext(NC);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function zA(e){var n;return(n=e==null?void 0:e.clientId)!==null&&n!==void 0?n:e==null?void 0:e.client_id}const BA={large:40,medium:32,small:20};function UA({onSuccess:e,onError:n,useOneTap:t,promptMomentNotification:r,type:a="standard",theme:o="outline",size:l="large",text:h,shape:d,logo_alignment:u,width:f,click_listener:g,state:b,containerProps:v,...S}){const k=w.useRef(null),{clientId:T,locale:E,scriptLoadedSuccessfully:P}=$A(),I=w.useRef(e);I.current=e;const q=w.useRef(n);q.current=n;const $=w.useRef(r);return $.current=r,w.useEffect(()=>{var L,F,z,B,R,U,Y,Z,ne;if(P)return(z=(F=(L=window==null?void 0:window.google)===null||L===void 0?void 0:L.accounts)===null||F===void 0?void 0:F.id)===null||z===void 0||z.initialize({client_id:T,callback:ae=>{var X;if(!(ae!=null&&ae.credential))return(X=q.current)===null||X===void 0?void 0:X.call(q);const{credential:W,select_by:H}=ae;I.current({credential:W,clientId:zA(ae),select_by:H})},...S}),(U=(R=(B=window==null?void 0:window.google)===null||B===void 0?void 0:B.accounts)===null||R===void 0?void 0:R.id)===null||U===void 0||U.renderButton(k.current,{type:a,theme:o,size:l,text:h,shape:d,logo_alignment:u,width:f,locale:E,click_listener:g,state:b}),t&&((ne=(Z=(Y=window==null?void 0:window.google)===null||Y===void 0?void 0:Y.accounts)===null||Z===void 0?void 0:Z.id)===null||ne===void 0||ne.prompt($.current)),()=>{var ae,X,W;t&&((W=(X=(ae=window==null?void 0:window.google)===null||ae===void 0?void 0:ae.accounts)===null||X===void 0?void 0:X.id)===null||W===void 0||W.cancel())}},[T,P,t,a,o,l,h,d,u,f,E]),Pn.createElement("div",{...v,ref:k,style:{height:BA[l],...v==null?void 0:v.style}})}var Im={},wN;function qA(){if(wN)return Im;wN=1,Object.defineProperty(Im,"__esModule",{value:!0}),Im.parse=l,Im.serialize=u;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,n=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const b=function(){};return b.prototype=Object.create(null),b})();function l(b,v){const S=new o,k=b.length;if(k<2)return S;const T=(v==null?void 0:v.decode)||f;let E=0;do{const P=b.indexOf("=",E);if(P===-1)break;const I=b.indexOf(";",E),q=I===-1?k:I;if(P>q){E=b.lastIndexOf(";",P-1)+1;continue}const $=h(b,E,P),L=d(b,P,$),F=b.slice($,L);if(S[F]===void 0){let z=h(b,P+1,q),B=d(b,q,z);const R=T(b.slice(z,B));S[F]=R}E=q+1}while(E<k);return S}function h(b,v,S){do{const k=b.charCodeAt(v);if(k!==32&&k!==9)return v}while(++v<S);return S}function d(b,v,S){for(;v>S;){const k=b.charCodeAt(--v);if(k!==32&&k!==9)return v+1}return S}function u(b,v,S){const k=(S==null?void 0:S.encode)||encodeURIComponent;if(!e.test(b))throw new TypeError(`argument name is invalid: ${b}`);const T=k(v);if(!n.test(T))throw new TypeError(`argument val is invalid: ${v}`);let E=b+"="+T;if(!S)return E;if(S.maxAge!==void 0){if(!Number.isInteger(S.maxAge))throw new TypeError(`option maxAge is invalid: ${S.maxAge}`);E+="; Max-Age="+S.maxAge}if(S.domain){if(!t.test(S.domain))throw new TypeError(`option domain is invalid: ${S.domain}`);E+="; Domain="+S.domain}if(S.path){if(!r.test(S.path))throw new TypeError(`option path is invalid: ${S.path}`);E+="; Path="+S.path}if(S.expires){if(!g(S.expires)||!Number.isFinite(S.expires.valueOf()))throw new TypeError(`option expires is invalid: ${S.expires}`);E+="; Expires="+S.expires.toUTCString()}if(S.httpOnly&&(E+="; HttpOnly"),S.secure&&(E+="; Secure"),S.partitioned&&(E+="; Partitioned"),S.priority)switch(typeof S.priority=="string"?S.priority.toLowerCase():void 0){case"low":E+="; Priority=Low";break;case"medium":E+="; Priority=Medium";break;case"high":E+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${S.priority}`)}if(S.sameSite)switch(typeof S.sameSite=="string"?S.sameSite.toLowerCase():S.sameSite){case!0:case"strict":E+="; SameSite=Strict";break;case"lax":E+="; SameSite=Lax";break;case"none":E+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${S.sameSite}`)}return E}function f(b){if(b.indexOf("%")===-1)return b;try{return decodeURIComponent(b)}catch{return b}}function g(b){return a.call(b)==="[object Date]"}return Im}qA();var NN="popstate";function VA(e={}){function n(r,a){let{pathname:o,search:l,hash:h}=r.location;return Z0("",{pathname:o,search:l,hash:h},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(r,a){return typeof a=="string"?a:ag(a)}return GA(n,t,null,e)}function Ti(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function mo(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function HA(){return Math.random().toString(36).substring(2,10)}function SN(e,n){return{usr:e.state,key:e.key,idx:n}}function Z0(e,n,t=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof n=="string"?Jf(n):n,state:t,key:n&&n.key||r||HA()}}function ag({pathname:e="/",search:n="",hash:t=""}){return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function Jf(e){let n={};if(e){let t=e.indexOf("#");t>=0&&(n.hash=e.substring(t),e=e.substring(0,t));let r=e.indexOf("?");r>=0&&(n.search=e.substring(r),e=e.substring(0,r)),e&&(n.pathname=e)}return n}function GA(e,n,t,r={}){let{window:a=document.defaultView,v5Compat:o=!1}=r,l=a.history,h="POP",d=null,u=f();u==null&&(u=0,l.replaceState({...l.state,idx:u},""));function f(){return(l.state||{idx:null}).idx}function g(){h="POP";let T=f(),E=T==null?null:T-u;u=T,d&&d({action:h,location:k.location,delta:E})}function b(T,E){h="PUSH";let P=Z0(k.location,T,E);u=f()+1;let I=SN(P,u),q=k.createHref(P);try{l.pushState(I,"",q)}catch($){if($ instanceof DOMException&&$.name==="DataCloneError")throw $;a.location.assign(q)}o&&d&&d({action:h,location:k.location,delta:1})}function v(T,E){h="REPLACE";let P=Z0(k.location,T,E);u=f();let I=SN(P,u),q=k.createHref(P);l.replaceState(I,"",q),o&&d&&d({action:h,location:k.location,delta:0})}function S(T){return YA(T)}let k={get action(){return h},get location(){return e(a,l)},listen(T){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(NN,g),d=T,()=>{a.removeEventListener(NN,g),d=null}},createHref(T){return n(a,T)},createURL:S,encodeLocation(T){let E=S(T);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:b,replace:v,go(T){return l.go(T)}};return k}function YA(e,n=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Ti(t,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:ag(e);return r=r.replace(/ $/,"%20"),!n&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function SC(e,n,t="/"){return WA(e,n,t,!1)}function WA(e,n,t,r){let a=typeof n=="string"?Jf(n):n,o=ac(a.pathname||"/",t);if(o==null)return null;let l=jC(e);QA(l);let h=null;for(let d=0;h==null&&d<l.length;++d){let u=sD(o);h=rD(l[d],u,r)}return h}function jC(e,n=[],t=[],r=""){let a=(o,l,h)=>{let d={relativePath:h===void 0?o.path||"":h,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};d.relativePath.startsWith("/")&&(Ti(d.relativePath.startsWith(r),`Absolute route path "${d.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(r.length));let u=ic([r,d.relativePath]),f=t.concat(d);o.children&&o.children.length>0&&(Ti(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),jC(o.children,n,f,u)),!(o.path==null&&!o.index)&&n.push({path:u,score:nD(u,o.index),routesMeta:f})};return e.forEach((o,l)=>{var h;if(o.path===""||!((h=o.path)!=null&&h.includes("?")))a(o,l);else for(let d of _C(o.path))a(o,l,d)}),n}function _C(e){let n=e.split("/");if(n.length===0)return[];let[t,...r]=n,a=t.endsWith("?"),o=t.replace(/\?$/,"");if(r.length===0)return a?[o,""]:[o];let l=_C(r.join("/")),h=[];return h.push(...l.map(d=>d===""?o:[o,d].join("/"))),a&&h.push(...l),h.map(d=>e.startsWith("/")&&d===""?"/":d)}function QA(e){e.sort((n,t)=>n.score!==t.score?t.score-n.score:iD(n.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var JA=/^:[\w-]+$/,KA=3,XA=2,ZA=1,eD=10,tD=-2,jN=e=>e==="*";function nD(e,n){let t=e.split("/"),r=t.length;return t.some(jN)&&(r+=tD),n&&(r+=XA),t.filter(a=>!jN(a)).reduce((a,o)=>a+(JA.test(o)?KA:o===""?ZA:eD),r)}function iD(e,n){return e.length===n.length&&e.slice(0,-1).every((r,a)=>r===n[a])?e[e.length-1]-n[n.length-1]:0}function rD(e,n,t=!1){let{routesMeta:r}=e,a={},o="/",l=[];for(let h=0;h<r.length;++h){let d=r[h],u=h===r.length-1,f=o==="/"?n:n.slice(o.length)||"/",g=tb({path:d.relativePath,caseSensitive:d.caseSensitive,end:u},f),b=d.route;if(!g&&u&&t&&!r[r.length-1].route.index&&(g=tb({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},f)),!g)return null;Object.assign(a,g.params),l.push({params:a,pathname:ic([o,g.pathname]),pathnameBase:uD(ic([o,g.pathnameBase])),route:b}),g.pathnameBase!=="/"&&(o=ic([o,g.pathnameBase]))}return l}function tb(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,r]=aD(e.path,e.caseSensitive,e.end),a=n.match(t);if(!a)return null;let o=a[0],l=o.replace(/(.)\/+$/,"$1"),h=a.slice(1);return{params:r.reduce((u,{paramName:f,isOptional:g},b)=>{if(f==="*"){let S=h[b]||"";l=o.slice(0,o.length-S.length).replace(/(.)\/+$/,"$1")}const v=h[b];return g&&!v?u[f]=void 0:u[f]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:l,pattern:e}}function aD(e,n=!1,t=!0){mo(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,h,d)=>(r.push({paramName:h,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,n?void 0:"i"),r]}function sD(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return mo(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),e}}function ac(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let t=n.endsWith("/")?n.length-1:n.length,r=e.charAt(t);return r&&r!=="/"?null:e.slice(t)||"/"}function oD(e,n="/"){let{pathname:t,search:r="",hash:a=""}=typeof e=="string"?Jf(e):e;return{pathname:t?t.startsWith("/")?t:lD(t,n):n,search:dD(r),hash:hD(a)}}function lD(e,n){let t=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function Jv(e,n,t,r){return`Cannot include a '${e}' character in a manually specified \`to.${n}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function cD(e){return e.filter((n,t)=>t===0||n.route.path&&n.route.path.length>0)}function aw(e){let n=cD(e);return n.map((t,r)=>r===n.length-1?t.pathname:t.pathnameBase)}function sw(e,n,t,r=!1){let a;typeof e=="string"?a=Jf(e):(a={...e},Ti(!a.pathname||!a.pathname.includes("?"),Jv("?","pathname","search",a)),Ti(!a.pathname||!a.pathname.includes("#"),Jv("#","pathname","hash",a)),Ti(!a.search||!a.search.includes("#"),Jv("#","search","hash",a)));let o=e===""||a.pathname==="",l=o?"/":a.pathname,h;if(l==null)h=t;else{let g=n.length-1;if(!r&&l.startsWith("..")){let b=l.split("/");for(;b[0]==="..";)b.shift(),g-=1;a.pathname=b.join("/")}h=g>=0?n[g]:"/"}let d=oD(a,h),u=l&&l!=="/"&&l.endsWith("/"),f=(o||l===".")&&t.endsWith("/");return!d.pathname.endsWith("/")&&(u||f)&&(d.pathname+="/"),d}var ic=e=>e.join("/").replace(/\/\/+/g,"/"),uD=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),dD=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,hD=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function fD(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var CC=["POST","PUT","PATCH","DELETE"];new Set(CC);var pD=["GET",...CC];new Set(pD);var Kf=w.createContext(null);Kf.displayName="DataRouter";var Tb=w.createContext(null);Tb.displayName="DataRouterState";var kC=w.createContext({isTransitioning:!1});kC.displayName="ViewTransition";var mD=w.createContext(new Map);mD.displayName="Fetchers";var gD=w.createContext(null);gD.displayName="Await";var xo=w.createContext(null);xo.displayName="Navigation";var yg=w.createContext(null);yg.displayName="Location";var bo=w.createContext({outlet:null,matches:[],isDataRoute:!1});bo.displayName="Route";var ow=w.createContext(null);ow.displayName="RouteError";function yD(e,{relative:n}={}){Ti(Xf(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=w.useContext(xo),{hash:a,pathname:o,search:l}=xg(e,{relative:n}),h=o;return t!=="/"&&(h=o==="/"?t:ic([t,o])),r.createHref({pathname:h,search:l,hash:a})}function Xf(){return w.useContext(yg)!=null}function Cr(){return Ti(Xf(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(yg).location}var EC="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function TC(e){w.useContext(xo).static||w.useLayoutEffect(e)}function Ot(){let{isDataRoute:e}=w.useContext(bo);return e?AD():xD()}function xD(){Ti(Xf(),"useNavigate() may be used only in the context of a <Router> component.");let e=w.useContext(Kf),{basename:n,navigator:t}=w.useContext(xo),{matches:r}=w.useContext(bo),{pathname:a}=Cr(),o=JSON.stringify(aw(r)),l=w.useRef(!1);return TC(()=>{l.current=!0}),w.useCallback((d,u={})=>{if(mo(l.current,EC),!l.current)return;if(typeof d=="number"){t.go(d);return}let f=sw(d,JSON.parse(o),a,u.relative==="path");e==null&&n!=="/"&&(f.pathname=f.pathname==="/"?n:ic([n,f.pathname])),(u.replace?t.replace:t.push)(f,u.state,u)},[n,t,o,a,e])}w.createContext(null);function Yr(){let{matches:e}=w.useContext(bo),n=e[e.length-1];return n?n.params:{}}function xg(e,{relative:n}={}){let{matches:t}=w.useContext(bo),{pathname:r}=Cr(),a=JSON.stringify(aw(t));return w.useMemo(()=>sw(e,JSON.parse(a),r,n==="path"),[e,a,r,n])}function bD(e,n){return AC(e,n)}function AC(e,n,t,r){var P;Ti(Xf(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:o}=w.useContext(xo),{matches:l}=w.useContext(bo),h=l[l.length-1],d=h?h.params:{},u=h?h.pathname:"/",f=h?h.pathnameBase:"/",g=h&&h.route;{let I=g&&g.path||"";DC(u,!g||I.endsWith("*")||I.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${I}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${I}"> to <Route path="${I==="/"?"*":`${I}/*`}">.`)}let b=Cr(),v;if(n){let I=typeof n=="string"?Jf(n):n;Ti(f==="/"||((P=I.pathname)==null?void 0:P.startsWith(f)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${I.pathname}" was given in the \`location\` prop.`),v=I}else v=b;let S=v.pathname||"/",k=S;if(f!=="/"){let I=f.replace(/^\//,"").split("/");k="/"+S.replace(/^\//,"").split("/").slice(I.length).join("/")}let T=!o&&t&&t.matches&&t.matches.length>0?t.matches:SC(e,{pathname:k});mo(g||T!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),mo(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=jD(T&&T.map(I=>Object.assign({},I,{params:Object.assign({},d,I.params),pathname:ic([f,a.encodeLocation?a.encodeLocation(I.pathname).pathname:I.pathname]),pathnameBase:I.pathnameBase==="/"?f:ic([f,a.encodeLocation?a.encodeLocation(I.pathnameBase).pathname:I.pathnameBase])})),l,t,r);return n&&E?w.createElement(yg.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},E):E}function vD(){let e=TD(),n=fD(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:o},"ErrorBoundary")," or"," ",w.createElement("code",{style:o},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},n),t?w.createElement("pre",{style:a},t):null,l)}var wD=w.createElement(vD,null),ND=class extends w.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?w.createElement(bo.Provider,{value:this.props.routeContext},w.createElement(ow.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function SD({routeContext:e,match:n,children:t}){let r=w.useContext(Kf);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),w.createElement(bo.Provider,{value:e},t)}function jD(e,n=[],t=null,r=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(n.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let a=e,o=t==null?void 0:t.errors;if(o!=null){let d=a.findIndex(u=>u.route.id&&(o==null?void 0:o[u.route.id])!==void 0);Ti(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,d+1))}let l=!1,h=-1;if(t)for(let d=0;d<a.length;d++){let u=a[d];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(h=d),u.route.id){let{loaderData:f,errors:g}=t,b=u.route.loader&&!f.hasOwnProperty(u.route.id)&&(!g||g[u.route.id]===void 0);if(u.route.lazy||b){l=!0,h>=0?a=a.slice(0,h+1):a=[a[0]];break}}}return a.reduceRight((d,u,f)=>{let g,b=!1,v=null,S=null;t&&(g=o&&u.route.id?o[u.route.id]:void 0,v=u.route.errorElement||wD,l&&(h<0&&f===0?(DC("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,S=null):h===f&&(b=!0,S=u.route.hydrateFallbackElement||null)));let k=n.concat(a.slice(0,f+1)),T=()=>{let E;return g?E=v:b?E=S:u.route.Component?E=w.createElement(u.route.Component,null):u.route.element?E=u.route.element:E=d,w.createElement(SD,{match:u,routeContext:{outlet:d,matches:k,isDataRoute:t!=null},children:E})};return t&&(u.route.ErrorBoundary||u.route.errorElement||f===0)?w.createElement(ND,{location:t.location,revalidation:t.revalidation,component:v,error:g,children:T(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):T()},null)}function lw(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function _D(e){let n=w.useContext(Kf);return Ti(n,lw(e)),n}function CD(e){let n=w.useContext(Tb);return Ti(n,lw(e)),n}function kD(e){let n=w.useContext(bo);return Ti(n,lw(e)),n}function cw(e){let n=kD(e),t=n.matches[n.matches.length-1];return Ti(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function ED(){return cw("useRouteId")}function TD(){var r;let e=w.useContext(ow),n=CD("useRouteError"),t=cw("useRouteError");return e!==void 0?e:(r=n.errors)==null?void 0:r[t]}function AD(){let{router:e}=_D("useNavigate"),n=cw("useNavigate"),t=w.useRef(!1);return TC(()=>{t.current=!0}),w.useCallback(async(a,o={})=>{mo(t.current,EC),t.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:n,...o}))},[e,n])}var _N={};function DC(e,n,t){!n&&!_N[e]&&(_N[e]=!0,mo(!1,t))}w.memo(DD);function DD({routes:e,future:n,state:t}){return AC(e,void 0,t,n)}function $n({to:e,replace:n,state:t,relative:r}){Ti(Xf(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=w.useContext(xo);mo(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=w.useContext(bo),{pathname:l}=Cr(),h=Ot(),d=sw(e,aw(o),l,r==="path"),u=JSON.stringify(d);return w.useEffect(()=>{h(JSON.parse(u),{replace:n,state:t,relative:r})},[h,u,r,n,t]),null}function Nt(e){Ti(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function PD({basename:e="/",children:n=null,location:t,navigationType:r="POP",navigator:a,static:o=!1}){Ti(!Xf(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=e.replace(/^\/*/,"/"),h=w.useMemo(()=>({basename:l,navigator:a,static:o,future:{}}),[l,a,o]);typeof t=="string"&&(t=Jf(t));let{pathname:d="/",search:u="",hash:f="",state:g=null,key:b="default"}=t,v=w.useMemo(()=>{let S=ac(d,l);return S==null?null:{location:{pathname:S,search:u,hash:f,state:g,key:b},navigationType:r}},[l,d,u,f,g,b,r]);return mo(v!=null,`<Router basename="${l}"> is not able to match the URL "${d}${u}${f}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:w.createElement(xo.Provider,{value:h},w.createElement(yg.Provider,{children:n,value:v}))}function kf({children:e,location:n}){return bD(e1(e),n)}function e1(e,n=[]){let t=[];return w.Children.forEach(e,(r,a)=>{if(!w.isValidElement(r))return;let o=[...n,a];if(r.type===w.Fragment){t.push.apply(t,e1(r.props.children,o));return}Ti(r.type===Nt,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ti(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=e1(r.props.children,o)),t.push(l)}),t}var Hx="get",Gx="application/x-www-form-urlencoded";function Ab(e){return e!=null&&typeof e.tagName=="string"}function ID(e){return Ab(e)&&e.tagName.toLowerCase()==="button"}function MD(e){return Ab(e)&&e.tagName.toLowerCase()==="form"}function RD(e){return Ab(e)&&e.tagName.toLowerCase()==="input"}function OD(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function LD(e,n){return e.button===0&&(!n||n==="_self")&&!OD(e)}var vx=null;function FD(){if(vx===null)try{new FormData(document.createElement("form"),0),vx=!1}catch{vx=!0}return vx}var $D=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Kv(e){return e!=null&&!$D.has(e)?(mo(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Gx}"`),null):e}function zD(e,n){let t,r,a,o,l;if(MD(e)){let h=e.getAttribute("action");r=h?ac(h,n):null,t=e.getAttribute("method")||Hx,a=Kv(e.getAttribute("enctype"))||Gx,o=new FormData(e)}else if(ID(e)||RD(e)&&(e.type==="submit"||e.type==="image")){let h=e.form;if(h==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=e.getAttribute("formaction")||h.getAttribute("action");if(r=d?ac(d,n):null,t=e.getAttribute("formmethod")||h.getAttribute("method")||Hx,a=Kv(e.getAttribute("formenctype"))||Kv(h.getAttribute("enctype"))||Gx,o=new FormData(h,e),!FD()){let{name:u,type:f,value:g}=e;if(f==="image"){let b=u?`${u}.`:"";o.append(`${b}x`,"0"),o.append(`${b}y`,"0")}else u&&o.append(u,g)}}else{if(Ab(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Hx,r=null,a=Gx,l=e}return o&&a==="text/plain"&&(l=o,o=void 0),{action:r,method:t.toLowerCase(),encType:a,formData:o,body:l}}function uw(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}async function BD(e,n){if(e.id in n)return n[e.id];try{let t=await import(e.module);return n[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function UD(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function qD(e,n,t){let r=await Promise.all(e.map(async a=>{let o=n.routes[a.route.id];if(o){let l=await BD(o,t);return l.links?l.links():[]}return[]}));return YD(r.flat(1).filter(UD).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function CN(e,n,t,r,a,o){let l=(d,u)=>t[u]?d.route.id!==t[u].route.id:!0,h=(d,u)=>{var f;return t[u].pathname!==d.pathname||((f=t[u].route.path)==null?void 0:f.endsWith("*"))&&t[u].params["*"]!==d.params["*"]};return o==="assets"?n.filter((d,u)=>l(d,u)||h(d,u)):o==="data"?n.filter((d,u)=>{var g;let f=r.routes[d.route.id];if(!f||!f.hasLoader)return!1;if(l(d,u)||h(d,u))return!0;if(d.route.shouldRevalidate){let b=d.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((g=t[0])==null?void 0:g.params)||{},nextUrl:new URL(e,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function VD(e,n,{includeHydrateFallback:t}={}){return HD(e.map(r=>{let a=n.routes[r.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function HD(e){return[...new Set(e)]}function GD(e){let n={},t=Object.keys(e).sort();for(let r of t)n[r]=e[r];return n}function YD(e,n){let t=new Set;return new Set(n),e.reduce((r,a)=>{let o=JSON.stringify(GD(a));return t.has(o)||(t.add(o),r.push({key:o,link:a})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var WD=new Set([100,101,204,205]);function QD(e,n){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":n&&ac(t.pathname,n)==="/"?t.pathname=`${n.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function PC(){let e=w.useContext(Kf);return uw(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function JD(){let e=w.useContext(Tb);return uw(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var dw=w.createContext(void 0);dw.displayName="FrameworkContext";function IC(){let e=w.useContext(dw);return uw(e,"You must render this element inside a <HydratedRouter> element"),e}function KD(e,n){let t=w.useContext(dw),[r,a]=w.useState(!1),[o,l]=w.useState(!1),{onFocus:h,onBlur:d,onMouseEnter:u,onMouseLeave:f,onTouchStart:g}=n,b=w.useRef(null);w.useEffect(()=>{if(e==="render"&&l(!0),e==="viewport"){let k=E=>{E.forEach(P=>{l(P.isIntersecting)})},T=new IntersectionObserver(k,{threshold:.5});return b.current&&T.observe(b.current),()=>{T.disconnect()}}},[e]),w.useEffect(()=>{if(r){let k=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(k)}}},[r]);let v=()=>{a(!0)},S=()=>{a(!1),l(!1)};return t?e!=="intent"?[o,b,{}]:[o,b,{onFocus:Mm(h,v),onBlur:Mm(d,S),onMouseEnter:Mm(u,v),onMouseLeave:Mm(f,S),onTouchStart:Mm(g,v)}]:[!1,b,{}]}function Mm(e,n){return t=>{e&&e(t),t.defaultPrevented||n(t)}}function XD({page:e,...n}){let{router:t}=PC(),r=w.useMemo(()=>SC(t.routes,e,t.basename),[t.routes,e,t.basename]);return r?w.createElement(eP,{page:e,matches:r,...n}):null}function ZD(e){let{manifest:n,routeModules:t}=IC(),[r,a]=w.useState([]);return w.useEffect(()=>{let o=!1;return qD(e,n,t).then(l=>{o||a(l)}),()=>{o=!0}},[e,n,t]),r}function eP({page:e,matches:n,...t}){let r=Cr(),{manifest:a,routeModules:o}=IC(),{basename:l}=PC(),{loaderData:h,matches:d}=JD(),u=w.useMemo(()=>CN(e,n,d,a,r,"data"),[e,n,d,a,r]),f=w.useMemo(()=>CN(e,n,d,a,r,"assets"),[e,n,d,a,r]),g=w.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let S=new Set,k=!1;if(n.forEach(E=>{var I;let P=a.routes[E.route.id];!P||!P.hasLoader||(!u.some(q=>q.route.id===E.route.id)&&E.route.id in h&&((I=o[E.route.id])!=null&&I.shouldRevalidate)||P.hasClientLoader?k=!0:S.add(E.route.id))}),S.size===0)return[];let T=QD(e,l);return k&&S.size>0&&T.searchParams.set("_routes",n.filter(E=>S.has(E.route.id)).map(E=>E.route.id).join(",")),[T.pathname+T.search]},[l,h,r,a,u,n,e,o]),b=w.useMemo(()=>VD(f,a),[f,a]),v=ZD(f);return w.createElement(w.Fragment,null,g.map(S=>w.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...t})),b.map(S=>w.createElement("link",{key:S,rel:"modulepreload",href:S,...t})),v.map(({key:S,link:k})=>w.createElement("link",{key:S,...k})))}function tP(...e){return n=>{e.forEach(t=>{typeof t=="function"?t(n):t!=null&&(t.current=n)})}}var MC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{MC&&(window.__reactRouterVersion="7.6.0")}catch{}function nP({basename:e,children:n,window:t}){let r=w.useRef();r.current==null&&(r.current=VA({window:t,v5Compat:!0}));let a=r.current,[o,l]=w.useState({action:a.action,location:a.location}),h=w.useCallback(d=>{w.startTransition(()=>l(d))},[l]);return w.useLayoutEffect(()=>a.listen(h),[a,h]),w.createElement(PD,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:a})}var RC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ps=w.forwardRef(function({onClick:n,discover:t="render",prefetch:r="none",relative:a,reloadDocument:o,replace:l,state:h,target:d,to:u,preventScrollReset:f,viewTransition:g,...b},v){let{basename:S}=w.useContext(xo),k=typeof u=="string"&&RC.test(u),T,E=!1;if(typeof u=="string"&&k&&(T=u,MC))try{let B=new URL(window.location.href),R=u.startsWith("//")?new URL(B.protocol+u):new URL(u),U=ac(R.pathname,S);R.origin===B.origin&&U!=null?u=U+R.search+R.hash:E=!0}catch{mo(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let P=yD(u,{relative:a}),[I,q,$]=KD(r,b),L=sP(u,{replace:l,state:h,target:d,preventScrollReset:f,relative:a,viewTransition:g});function F(B){n&&n(B),B.defaultPrevented||L(B)}let z=w.createElement("a",{...b,...$,href:T||P,onClick:E||o?n:F,ref:tP(v,q),target:d,"data-discover":!k&&t==="render"?"true":void 0});return I&&!k?w.createElement(w.Fragment,null,z,w.createElement(XD,{page:P})):z});Ps.displayName="Link";var iP=w.forwardRef(function({"aria-current":n="page",caseSensitive:t=!1,className:r="",end:a=!1,style:o,to:l,viewTransition:h,children:d,...u},f){let g=xg(l,{relative:u.relative}),b=Cr(),v=w.useContext(Tb),{navigator:S,basename:k}=w.useContext(xo),T=v!=null&&dP(g)&&h===!0,E=S.encodeLocation?S.encodeLocation(g).pathname:g.pathname,P=b.pathname,I=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(P=P.toLowerCase(),I=I?I.toLowerCase():null,E=E.toLowerCase()),I&&k&&(I=ac(I,k)||I);const q=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let $=P===E||!a&&P.startsWith(E)&&P.charAt(q)==="/",L=I!=null&&(I===E||!a&&I.startsWith(E)&&I.charAt(E.length)==="/"),F={isActive:$,isPending:L,isTransitioning:T},z=$?n:void 0,B;typeof r=="function"?B=r(F):B=[r,$?"active":null,L?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let R=typeof o=="function"?o(F):o;return w.createElement(Ps,{...u,"aria-current":z,className:B,ref:f,style:R,to:l,viewTransition:h},typeof d=="function"?d(F):d)});iP.displayName="NavLink";var rP=w.forwardRef(({discover:e="render",fetcherKey:n,navigate:t,reloadDocument:r,replace:a,state:o,method:l=Hx,action:h,onSubmit:d,relative:u,preventScrollReset:f,viewTransition:g,...b},v)=>{let S=cP(),k=uP(h,{relative:u}),T=l.toLowerCase()==="get"?"get":"post",E=typeof h=="string"&&RC.test(h),P=I=>{if(d&&d(I),I.defaultPrevented)return;I.preventDefault();let q=I.nativeEvent.submitter,$=(q==null?void 0:q.getAttribute("formmethod"))||l;S(q||I.currentTarget,{fetcherKey:n,method:$,navigate:t,replace:a,state:o,relative:u,preventScrollReset:f,viewTransition:g})};return w.createElement("form",{ref:v,method:T,action:k,onSubmit:r?d:P,...b,"data-discover":!E&&e==="render"?"true":void 0})});rP.displayName="Form";function aP(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function OC(e){let n=w.useContext(Kf);return Ti(n,aP(e)),n}function sP(e,{target:n,replace:t,state:r,preventScrollReset:a,relative:o,viewTransition:l}={}){let h=Ot(),d=Cr(),u=xg(e,{relative:o});return w.useCallback(f=>{if(LD(f,n)){f.preventDefault();let g=t!==void 0?t:ag(d)===ag(u);h(e,{replace:g,state:r,preventScrollReset:a,relative:o,viewTransition:l})}},[d,h,u,t,r,n,e,a,o,l])}var oP=0,lP=()=>`__${String(++oP)}__`;function cP(){let{router:e}=OC("useSubmit"),{basename:n}=w.useContext(xo),t=ED();return w.useCallback(async(r,a={})=>{let{action:o,method:l,encType:h,formData:d,body:u}=zD(r,n);if(a.navigate===!1){let f=a.fetcherKey||lP();await e.fetch(f,t,a.action||o,{preventScrollReset:a.preventScrollReset,formData:d,body:u,formMethod:a.method||l,formEncType:a.encType||h,flushSync:a.flushSync})}else await e.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:d,body:u,formMethod:a.method||l,formEncType:a.encType||h,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,n,t])}function uP(e,{relative:n}={}){let{basename:t}=w.useContext(xo),r=w.useContext(bo);Ti(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),o={...xg(e||".",{relative:n})},l=Cr();if(e==null){o.search=l.search;let h=new URLSearchParams(o.search),d=h.getAll("index");if(d.some(f=>f==="")){h.delete("index"),d.filter(g=>g).forEach(g=>h.append("index",g));let f=h.toString();o.search=f?`?${f}`:""}}return(!e||e===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:ic([t,o.pathname])),ag(o)}function dP(e,n={}){let t=w.useContext(kC);Ti(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=OC("useViewTransitionState"),a=xg(e,{relative:n.relative});if(!t.isTransitioning)return!1;let o=ac(t.currentLocation.pathname,r)||t.currentLocation.pathname,l=ac(t.nextLocation.pathname,r)||t.nextLocation.pathname;return tb(a.pathname,l)!=null||tb(a.pathname,o)!=null}[...WD];var hP=wC();class fP extends w.Component{constructor(){super(...arguments);ri(this,"state",{hasError:!1})}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){console.error("Uncaught error:",t,r)}render(){return this.state.hasError?i.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"red",border:"1px solid red",borderRadius:"5px"},children:[i.jsx("h1",{children:"Something went wrong."}),i.jsx("p",{children:"We are sorry for the inconvenience. Please try again later."})]}):this.props.children}}class pP{constructor(){ri(this,"requestCount",0);ri(this,"listeners",[])}subscribe(n){return this.listeners.push(n),()=>{this.listeners=this.listeners.filter(t=>t!==n)}}notify(){const n=this.requestCount>0;this.listeners.forEach(t=>t(n))}addRequest(){this.requestCount++,this.notify()}removeRequest(){this.requestCount--,this.requestCount<0&&(this.requestCount=0),this.notify()}}const lo=new pP,mP="https://backend.newtons.in",gP=()=>localStorage.getItem("authToken"),de=async(e,n={})=>{const t=gP(),r={...n.headers};t&&(r.Authorization=`Bearer ${t}`),!(n.body instanceof FormData)&&!r["Content-Type"]&&(r["Content-Type"]="application/json");const a=r;let o=e.startsWith("/")?e:`/${e}`;o.startsWith("/api/")||(o=`/api${o}`);const l=`${mP}${o}`;lo.addRequest();try{console.log(`Making API call to: ${l}`);const h=await fetch(l,{...n,headers:a});if(h.status===401)throw console.error("Unauthorized access - Token might be invalid or expired. Logging out."),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser"),window.location.href="/login",new Error("Unauthorized");if(!h.ok){let d=`HTTP error! status: ${h.status}`;try{const u=await h.json();d=(u==null?void 0:u.message)||(u==null?void 0:u.error)||d}catch{}throw console.error(`API Error: ${h.status} ${h.statusText} - ${d}`),new Error(d)}return h}catch(h){throw h instanceof TypeError&&h.message==="Failed to fetch"?console.error("API Fetch Error: Network error or CORS issue. Check backend CORS configuration.",h):console.error("API Fetch Error:",h),h}finally{lo.removeRequest()}},yP=({onLoginSuccess:e})=>{const[n,t]=w.useState(""),[r,a]=w.useState(""),[o,l]=w.useState(null),[h,d]=w.useState(!1),u=Ot(),f=async b=>{b.preventDefault(),d(!0),l(null);try{const v=await de("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});if(!v.ok){let k=`Login failed with status: ${v.status}`;try{k=(await v.json()).message||k}catch{try{const E=await v.text();E&&(k=`${k} - ${E}`)}catch{}}throw new Error(k)}const S=await v.json();console.log("Login successful:",S),localStorage.setItem("authToken",S.token),localStorage.setItem("currentUser",JSON.stringify(S.user)),S.user.clinic_id&&localStorage.setItem("currentClinicId",S.user.clinic_id),e(S.user),S.user.role==="doctor"?u("/dashboard/queue"):u("/dashboard")}catch(v){console.error("Login failed:",v),l(v.message||"Login failed. Please check your credentials.")}finally{d(!1)}},g=async b=>{d(!0),l(null);try{const v=await de("/api/auth/google",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({credential:b.credential})});if(!v.ok)throw new Error("Google login failed");const S=await v.json();localStorage.setItem("authToken",S.token),localStorage.setItem("currentUser",JSON.stringify(S.user)),S.user.clinic_id&&localStorage.setItem("currentClinicId",S.user.clinic_id),e(S.user),S.user.role==="doctor"?u("/dashboard/queue"):u("/dashboard")}catch(v){console.error("Google login error:",v),l("Google login failed. Please try again.")}finally{d(!1)}};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Newtons AI HMS"}),i.jsx("p",{className:"auth-subtitle",children:"Hospital Management System"}),i.jsxs("form",{onSubmit:f,className:"auth-form",children:[i.jsx("div",{className:"form-group",children:i.jsxs("div",{className:"auth-floating-input",children:[i.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:n,onChange:b=>t(b.target.value),className:"auth-text-input",placeholder:" "}),i.jsx("label",{htmlFor:"email",children:"Email Address"})]})}),i.jsx("div",{className:"form-group",children:i.jsxs("div",{className:"auth-floating-input",children:[i.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:r,onChange:b=>a(b.target.value),className:"auth-text-input",placeholder:" "}),i.jsx("label",{htmlFor:"password",children:"Password"})]})}),o&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:o})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:h,className:`auth-submit-button ${h?"loading":""}`,children:h?"Signing in...":"Sign In"})}),i.jsx("div",{className:"auth-divider",children:i.jsx("span",{children:"OR"})}),i.jsx("div",{className:"google-login-container",children:i.jsx(UA,{onSuccess:g,onError:()=>{l("Google Login Failed")},useOneTap:!0,theme:"outline",size:"large",width:"100%"})})]}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Don't have an account?"," ",i.jsx(Ps,{to:"/register",className:"auth-navigation-link",children:"Register a new clinic"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})},xP=()=>{const[e,n]=w.useState(""),[t,r]=w.useState(""),[a,o]=w.useState(""),[l,h]=w.useState(""),[d,u]=w.useState(null),[f,g]=w.useState(!1),b=Ot(),v=async S=>{S.preventDefault(),g(!0),u(null);try{const k=await de("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicName:e,userName:t,userEmail:a,userPassword:l})}),T=await k.json();if(!k.ok)throw new Error(T.message||`HTTP error! status: ${k.status}`);console.log("Registration successful:",T),alert("Registration successful! Please log in."),b("/login")}catch(k){console.error("Registration failed:",k),u(k.message||"Registration failed. Please try again.")}finally{g(!1)}};return i.jsx("div",{className:"auth-page-container",children:i.jsxs("div",{className:"auth-form-card",children:[i.jsx("h2",{className:"auth-title",children:"Newtons Ai HMS"}),i.jsx("p",{className:"auth-subtitle",children:"Register Clinic & Admin"}),i.jsxs("form",{onSubmit:v,className:"auth-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"clinicName",children:"Clinic Name"}),i.jsx("input",{id:"clinicName",name:"clinicName",type:"text",required:!0,value:e,onChange:S=>n(S.target.value),className:"auth-text-input",placeholder:"Your Clinic's Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userName",children:"Your Name (Admin)"}),i.jsx("input",{id:"userName",name:"userName",type:"text",required:!0,value:t,onChange:S=>r(S.target.value),className:"auth-text-input",placeholder:"Your Full Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userEmail",children:"Your Email (Admin Login)"}),i.jsx("input",{id:"userEmail",name:"userEmail",type:"email",autoComplete:"email",required:!0,value:a,onChange:S=>o(S.target.value),className:"auth-text-input",placeholder:"you@example.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"userPassword",children:"Password"}),i.jsx("input",{id:"userPassword",name:"userPassword",type:"password",required:!0,minLength:6,value:l,onChange:S=>h(S.target.value),className:"auth-text-input",placeholder:"Min. 6 characters"})]}),d&&i.jsx("div",{className:"auth-error-message",children:i.jsx("p",{children:d})}),i.jsx("div",{className:"form-group",children:i.jsx("button",{type:"submit",disabled:f,className:`auth-submit-button ${f?"loading":""}`,children:f?"Registering...":"Register Clinic & Admin"})})]}),i.jsxs("div",{className:"auth-navigation-link-container",children:["Already have an account?"," ",i.jsx(Ps,{to:"/login",className:"auth-navigation-link",children:"Sign in"})]}),i.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})};var LC={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},kN=Pn.createContext&&Pn.createContext(LC),bP=["attr","size","title"];function vP(e,n){if(e==null)return{};var t=wP(e,n),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}function wP(e,n){if(e==null)return{};var t={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(n.indexOf(r)>=0)continue;t[r]=e[r]}return t}function nb(){return nb=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},nb.apply(this,arguments)}function EN(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function ib(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?EN(Object(t),!0).forEach(function(r){NP(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):EN(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function NP(e,n,t){return n=SP(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function SP(e){var n=jP(e,"string");return typeof n=="symbol"?n:n+""}function jP(e,n){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function FC(e){return e&&e.map((n,t)=>Pn.createElement(n.tag,ib({key:t},n.attr),FC(n.child)))}function as(e){return n=>Pn.createElement(_P,nb({attr:ib({},e.attr)},n),FC(e.child))}function _P(e){var n=t=>{var{attr:r,size:a,title:o}=e,l=vP(e,bP),h=a||t.size||"1em",d;return t.className&&(d=t.className),e.className&&(d=(d?d+" ":"")+e.className),Pn.createElement("svg",nb({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,l,{className:d,style:ib(ib({color:e.color||t.color},t.style),e.style),height:h,width:h,xmlns:"http://www.w3.org/2000/svg"}),o&&Pn.createElement("title",null,o),e.children)};return kN!==void 0?Pn.createElement(kN.Consumer,null,t=>n(t)):n(LC)}function xf(e){return as({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(e)}function CP(e){return as({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function TN(e){return as({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M437.2 403.5L320 215V64h8c13.3 0 24-10.7 24-24V24c0-13.3-10.7-24-24-24H120c-13.3 0-24 10.7-24 24v16c0 13.3 10.7 24 24 24h8v151L10.8 403.5C-18.5 450.6 15.3 512 70.9 512h306.2c55.7 0 89.4-61.5 60.1-108.5zM137.9 320l48.2-77.6c3.7-5.2 5.8-11.6 5.8-18.4V64h64v160c0 6.9 2.2 13.2 5.8 18.4l48.2 77.6h-172z"},child:[]}]})(e)}function Ef(e){return as({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function Rm(e){return as({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M480 320a96 96 0 1 0-96-96 96 96 0 0 0 96 96zm48 32a22.88 22.88 0 0 0-7.06 1.09 124.76 124.76 0 0 1-81.89 0A22.82 22.82 0 0 0 432 352a112 112 0 0 0-112 112.62c.14 26.26 21.73 47.38 48 47.38h224c26.27 0 47.86-21.12 48-47.38A112 112 0 0 0 528 352zm-198.09 10.45A145.19 145.19 0 0 1 352 344.62V128a32 32 0 0 0-32-32h-32V32a32 32 0 0 0-32-32H96a32 32 0 0 0-32 32v64H32a32 32 0 0 0-32 32v368a16 16 0 0 0 16 16h288.31A78.62 78.62 0 0 1 288 464.79a143.06 143.06 0 0 1 41.91-102.34zM144 404a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm48-122a6 6 0 0 1-6 6h-20a6 6 0 0 1-6-6v-26h-26a6 6 0 0 1-6-6v-20a6 6 0 0 1 6-6h26V70a6 6 0 0 1 6-6h20a6 6 0 0 1 6 6v26h26a6 6 0 0 1 6 6v20a6 6 0 0 1-6 6h-26zm80 250a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12z"},child:[]}]})(e)}function wx(e){return as({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M352 288h-16v-88c0-4.42-3.58-8-8-8h-13.58c-4.74 0-9.37 1.4-13.31 4.03l-15.33 10.22a7.994 7.994 0 0 0-2.22 11.09l8.88 13.31a7.994 7.994 0 0 0 11.09 2.22l.47-.31V288h-16c-4.42 0-8 3.58-8 8v16c0 4.42 3.58 8 8 8h64c4.42 0 8-3.58 8-8v-16c0-4.42-3.58-8-8-8zM608 64H32C14.33 64 0 78.33 0 96v320c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V96c0-17.67-14.33-32-32-32zM48 400v-64c35.35 0 64 28.65 64 64H48zm0-224v-64h64c0 35.35-28.65 64-64 64zm272 192c-53.02 0-96-50.15-96-112 0-61.86 42.98-112 96-112s96 50.14 96 112c0 61.87-43 112-96 112zm272 32h-64c0-35.35 28.65-64 64-64v64zm0-224c-35.35 0-64-28.65-64-64h64v64z"},child:[]}]})(e)}function Nx(e){return as({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M112 32C50.1 32 0 82.1 0 144v224c0 61.9 50.1 112 112 112s112-50.1 112-112V144c0-61.9-50.1-112-112-112zm48 224H64V144c0-26.5 21.5-48 48-48s48 21.5 48 48v112zm139.7-29.7c-3.5-3.5-9.4-3.1-12.3.8-45.3 62.5-40.4 150.1 15.9 206.4 56.3 56.3 143.9 61.2 206.4 15.9 4-2.9 4.3-8.8.8-12.3L299.7 226.3zm229.8-19c-56.3-56.3-143.9-61.2-206.4-15.9-4 2.9-4.3 8.8-.8 12.3l210.8 210.8c3.5 3.5 9.4 3.1 12.3-.8 45.3-62.6 40.5-150.1-15.9-206.4z"},child:[]}]})(e)}function Tf(e){return as({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function $C(e){return as({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(e)}function AN(e){return as({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M447.1 112c-34.2.5-62.3 28.4-63 62.6-.5 24.3 12.5 45.6 32 56.8V344c0 57.3-50.2 104-112 104-60 0-109.2-44.1-111.9-99.2C265 333.8 320 269.2 320 192V36.6c0-11.4-8.1-21.3-19.3-23.5L237.8.5c-13-2.6-25.6 5.8-28.2 18.8L206.4 35c-2.6 13 5.8 25.6 18.8 28.2l30.7 6.1v121.4c0 52.9-42.2 96.7-95.1 97.2-53.4.5-96.9-42.7-96.9-96V69.4l30.7-6.1c13-2.6 21.4-15.2 18.8-28.2l-3.1-15.7C107.7 6.4 95.1-2 82.1.6L19.3 13C8.1 15.3 0 25.1 0 36.6V192c0 77.3 55.1 142 128.1 156.8C130.7 439.2 208.6 512 304 512c97 0 176-75.4 176-168V231.4c19.1-11.1 32-31.7 32-55.4 0-35.7-29.2-64.5-64.9-64zm.9 80c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16z"},child:[]}]})(e)}function zC(e){return as({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(e)}function Xv(e){return as({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zM104 424c0 13.3 10.7 24 24 24s24-10.7 24-24-10.7-24-24-24-24 10.7-24 24zm216-135.4v49c36.5 7.4 64 39.8 64 78.4v41.7c0 7.6-5.4 14.2-12.9 15.7l-32.2 6.4c-4.3.9-8.5-1.9-9.4-6.3l-3.1-15.7c-.9-4.3 1.9-8.6 6.3-9.4l19.3-3.9V416c0-62.8-96-65.1-96 1.9v26.7l19.3 3.9c4.3.9 7.1 5.1 6.3 9.4l-3.1 15.7c-.9 4.3-5.1 7.1-9.4 6.3l-31.2-4.2c-7.9-1.1-13.8-7.8-13.8-15.9V416c0-38.6 27.5-70.9 64-78.4v-45.2c-2.2.7-4.4 1.1-6.6 1.9-18 6.3-37.3 9.8-57.4 9.8s-39.4-3.5-57.4-9.8c-7.4-2.6-14.9-4.2-22.6-5.2v81.6c23.1 6.9 40 28.1 40 53.4 0 30.9-25.1 56-56 56s-56-25.1-56-56c0-25.3 16.9-46.5 40-53.4v-80.4C48.5 301 0 355.8 0 422.4v44.8C0 491.9 20.1 512 44.8 512h358.4c24.7 0 44.8-20.1 44.8-44.8v-44.8c0-72-56.8-130.3-128-133.8z"},child:[]}]})(e)}function Om(e){return as({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(e)}const hw={superadmin:[{title:"Admin Pages",links:[{path:"/dashboard",name:"Super Admin Dashboard",icon:Ef},{path:"/dashboard/clinic-subscriptions",name:"Clinic Subscriptions",icon:Rm},{path:"/dashboard/users",name:"User Management",icon:Om}]}],admin:[{title:"Dashboard",links:[{path:"/dashboard",name:"Admin Dashboard",icon:Ef}]},{title:"Staff Management",links:[{path:"/dashboard/clinic-hub",name:"Clinic Hub",icon:Rm},{path:"/dashboard/staff/add",name:"Add Staff",icon:Xv}]},{title:"Patient Management",links:[{path:"/dashboard/patients/add",name:"Add Patient",icon:Rm},{path:"/dashboard/patients",name:"All Patients",icon:Om},{path:"/dashboard/search-patient",name:"Search Patient",icon:Tf}]},{title:"Inventory & Pharmacy",links:[{path:"/dashboard/analysis",name:"Inventory Analysis",icon:xf},{path:"/dashboard/inventory",name:"Pharmacy Inventory",icon:Nx},{path:"/dashboard/purchase",name:"Add Drug",icon:Nx},{path:"/dashboard/recurring-medications",name:"Recurring Medications",icon:xf},{path:"/dashboard/distributors",name:"Distributor Management",icon:Om}]},{title:"Queue & Subscriptions",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:AN},{path:"/dashboard/subscriptions",name:"Manage Subscriptions",icon:wx},{path:"/dashboard/subscriptions/add",name:"Add Subscription Plan",icon:wx}]}],doctor:[{title:"Patient & Admissions",links:[{path:"/dashboard/search-patient",name:"Patient Search",icon:Tf},{path:"/dashboard/add-patient",name:"Add Patient",icon:Rm},{path:"/manage-admission",name:"Manage Admission",icon:Xv}]},{title:"Lab & Billing",links:[{path:"/create-lab-order",name:"Create Lab Order",icon:TN},{path:"/billing",name:"Billing",icon:wx}]},{title:"Queue",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:AN}]}],receptionist:[{title:"Reception",links:[{path:"/dashboard",name:"Reception Dashboard",icon:Ef}]},{title:"Patient Management",links:[{path:"/dashboard/all-patients",name:"All Patients",icon:Om},{path:"/dashboard/patients/add",name:"Add Patient",icon:Rm},{path:"/dashboard/search-patient",name:"Search Patient",icon:Tf}]},{title:"Billing & Admissions",links:[{path:"/billing",name:"Billing",icon:wx},{path:"/manage-admission",name:"Manage Admission",icon:Xv}]}],lab:[{title:"Lab Operations",links:[{path:"/dashboard",name:"Lab Dashboard",icon:Ef},{path:"/lab-inventory",name:"Lab Test Inventory",icon:TN},{path:"/lab/search-report",name:"Search Lab Report",icon:Tf}]}],pharmacy:[{title:"Pharmacy Operations",links:[{path:"/dashboard",name:"Pharmacy Queue",icon:Ef},{path:"/dashboard/inventory",name:"Pharmacy Inventory",icon:Nx},{path:"/dashboard/purchase",name:"Add Drug",icon:Nx},{path:"/dashboard/add-order",name:"Add Pharmacy Order",icon:xf},{path:"/dashboard/recurring-medications",name:"Recurring Medications",icon:xf},{path:"/dashboard/distributors",name:"Distributor Management",icon:Om},{path:"/dashboard/refill-reminders",name:"Refill Reminders",icon:xf}]},{title:"Analysis & Settings",links:[{path:"/dashboard/analysis",name:"Inventory Analysis",icon:xf},{path:"/dashboard/settings",name:"Pharmacy Settings",icon:CP},{path:"/dashboard/search-patient-records",name:"Search Patient Records",icon:Tf}]}]},kP=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a})=>{const o=Cr(),[l,h]=w.useState(""),d=hw[t]||[],[u,f]=w.useState(500),g=w.useRef(!1),b=w.useCallback(T=>{g.current=!0,T.preventDefault()},[]),v=w.useCallback(()=>{g.current=!1},[]),S=w.useCallback(T=>{if(g.current){const E=window.innerWidth-T.clientX;E>250&&E<window.innerWidth*.8&&f(E)}},[]);w.useEffect(()=>(window.addEventListener("mousemove",S),window.addEventListener("mouseup",v),()=>{window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",v)}),[S,v]);const k=d.map(T=>({...T,links:T.links.filter(E=>E.name.toLowerCase().includes(l.toLowerCase()))})).filter(T=>T.links.length>0);return i.jsxs("div",{className:`side-panel ${r?"open":""}`,style:{width:`${u}px`},children:[i.jsx("div",{className:"resizer",onMouseDown:b}),i.jsxs("div",{className:"side-panel-header",children:[i.jsx(Ps,{to:"/dashboard",className:"home-button",onClick:a,title:"Go to Dashboard",children:i.jsx(Ef,{})}),i.jsxs("div",{className:"search-container",children:[i.jsx(Tf,{className:"search-icon"}),i.jsx("input",{type:"text",placeholder:"Search pages...",className:"search-bar",value:l,onChange:T=>h(T.target.value)})]}),i.jsx("button",{className:"side-panel-close-button",onClick:a,"aria-label":"Close panel",children:i.jsx(zC,{})})]}),i.jsx("nav",{children:k.map((T,E)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:T.title}),i.jsx("ul",{className:"sub-page-list",children:T.links.map(P=>{const I=P.icon;return i.jsx("li",{children:i.jsxs(Ps,{to:P.path,className:o.pathname===P.path?"active":"",onClick:a,children:[I&&i.jsx(I,{})," ",i.jsx("span",{children:P.name})]})},P.path)})})]},E))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("div",{className:"user-name",children:["Welcome back, ",i.jsx("strong",{children:e.name})]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx($C,{})," Sign Out"]})]})]})},EP=({user:e,onLogout:n,userRole:t,isOpen:r,onClose:a,roleNavigation:o})=>{const l=Cr(),h=o[t]||[];return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:`mobile-side-panel-overlay ${r?"open":""}`,onClick:a}),i.jsxs("div",{className:`mobile-side-panel ${r?"open":""}`,children:[i.jsxs("div",{className:"mobile-side-panel-header",children:[i.jsx("h3",{children:"Menu"}),i.jsx("button",{className:"mobile-close-button",onClick:a,"aria-label":"Close panel",children:i.jsx(zC,{})})]}),i.jsx("nav",{children:h.map((d,u)=>i.jsxs("div",{className:"page-section",children:[i.jsx("div",{className:"page-title",children:d.title}),i.jsx("ul",{className:"sub-page-list",children:d.links.map(f=>{const g=f.icon;return i.jsx("li",{children:i.jsxs(Ps,{to:f.path,className:l.pathname===f.path?"active":"",onClick:a,children:[g&&i.jsx(g,{})," ",f.name]})},f.path)})})]},u))}),i.jsxs("div",{className:"user-info-section",children:[i.jsxs("div",{className:"user-name",children:["Welcome back, ",i.jsx("strong",{children:e.name})]}),i.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[i.jsx($C,{})," Sign Out"]})]})]})]})};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TP=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),AP=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,t,r)=>r?r.toUpperCase():t.toLowerCase()),DN=e=>{const n=AP(e);return n.charAt(0).toUpperCase()+n.slice(1)},BC=(...e)=>e.filter((n,t,r)=>!!n&&n.trim()!==""&&r.indexOf(n)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var DP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PP=w.forwardRef(({color:e="currentColor",size:n=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:a="",children:o,iconNode:l,...h},d)=>w.createElement("svg",{ref:d,...DP,width:n,height:n,stroke:e,strokeWidth:r?Number(t)*24/Number(n):t,className:BC("lucide",a),...h},[...l.map(([u,f])=>w.createElement(u,f)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=(e,n)=>{const t=w.forwardRef(({className:r,...a},o)=>w.createElement(PP,{ref:o,iconNode:n,className:BC(`lucide-${TP(DN(e))}`,`lucide-${e}`,r),...a}));return t.displayName=DN(e),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IP=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],MP=xt("activity",IP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RP=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],du=xt("arrow-down",RP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OP=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],on=xt("arrow-left",OP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LP=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],FP=xt("arrow-right",LP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $P=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],co=xt("arrow-up",$P);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zP=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]],PN=xt("banknote",zP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BP=[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]],Db=xt("beaker",BP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UP=[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]],qP=xt("bed-double",UP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VP=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],HP=xt("bell",VP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GP=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}]],YP=xt("bell-ring",GP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WP=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],tc=xt("bot",WP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QP=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],UC=xt("brain",QP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JP=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],qC=xt("building",JP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KP=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]],rb=xt("calendar-check-2",KP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XP=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],ZP=xt("calendar-days",XP);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Bf=xt("calendar",eI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tI=[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]],VC=xt("chart-no-axes-column",tI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Ds=xt("check",nI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iI=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ab=xt("chevron-down",iI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rI=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Pb=xt("chevron-left",rI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],bg=xt("chevron-right",aI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sI=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],t1=xt("chevron-up",sI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ui=xt("circle-alert",oI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lI=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ea=xt("circle-check-big",lI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]],uI=xt("circle-minus",cI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],nc=xt("circle-plus",dI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],fI=xt("circle-user",hI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pI=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],IN=xt("clipboard-list",pI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mI=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],HC=xt("clipboard",mI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],yI=xt("clock",gI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xI=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],bI=xt("copy",xI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vI=[["polyline",{points:"9 10 4 15 9 20",key:"r3jprv"}],["path",{d:"M20 4v7a4 4 0 0 1-4 4H4",key:"6o5b7l"}]],wI=xt("corner-down-left",vI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NI=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Mf=xt("credit-card",NI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SI=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],sg=xt("dollar-sign",SI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jI=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],GC=xt("eye-off",jI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _I=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],og=xt("eye",_I);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CI=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],kI=xt("file-check",CI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EI=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ns=xt("file-text",EI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TI=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],n1=xt("flask-conical",TI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AI=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],YC=xt("funnel",AI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DI=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Df=xt("hash",DI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PI=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],WC=xt("house",PI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const II=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],As=xt("info",II);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MI=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],RI=xt("key",MI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OI=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],LI=xt("layout-dashboard",OI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FI=[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]],$I=xt("list-ordered",FI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zI=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],BI=xt("list",zI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UI=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Rf=xt("loader-circle",UI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qI=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],VI=xt("lock",qI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HI=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],GI=xt("mic-off",HI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YI=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],QC=xt("mic",YI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WI=[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]],JC=xt("minimize-2",WI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QI=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],JI=xt("monitor",QI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KI=[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]],XI=xt("package-open",KI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZI=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],ho=xt("package",ZI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eM=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],tM=xt("paperclip",eM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nM=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],iM=xt("pause",nM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rM=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],lg=xt("pen",rM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aM=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Cs=xt("pencil",aM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sM=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],go=xt("pill",sM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oM=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],lM=xt("play",oM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cM=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],hl=xt("plus",cM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uM=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],fo=xt("printer",uM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dM=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],sc=xt("refresh-cw",dM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hM=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],fM=xt("repeat",hM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pM=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],mM=xt("rotate-ccw",pM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gM=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],oc=xt("save",gM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yM=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Ai=xt("search",yM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xM=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],fw=xt("send",xM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bM=[["path",{d:"M6 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-2",key:"4b9dqc"}],["path",{d:"M6 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-2",key:"22nnkd"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m13 6-4 6h6l-4 6",key:"14hqih"}]],sb=xt("server-crash",bM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vM=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Xm=xt("settings",vM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wM=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],KC=xt("share-2",wM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NM=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],XC=xt("shopping-cart",NM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SM=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],Zv=xt("smartphone",SM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jM=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],$d=xt("square-pen",jM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _M=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],CM=xt("stethoscope",_M);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kM=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],EM=xt("tag",kM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TM=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Hi=xt("trash-2",TM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AM=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],DM=xt("trending-up",AM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PM=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ZC=xt("triangle-alert",PM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IM=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],MM=xt("truck",IM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RM=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],OM=xt("upload",RM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LM=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],FM=xt("user-check",LM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $M=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],i1=xt("user-plus",$M);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zM=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],fl=xt("user",zM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BM=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],Uf=xt("users",BM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UM=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],qM=xt("video",UM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VM=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],Ld=xt("wallet",VM);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HM=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],In=xt("x",HM);function GM(e,n){const t={};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const YM=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,WM=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,QM={};function MN(e,n){return(QM.jsx?WM:YM).test(e)}const JM=/[ \t\n\f\r]/g;function KM(e){return typeof e=="object"?e.type==="text"?RN(e.value):!1:RN(e)}function RN(e){return e.replace(JM,"")===""}let vg=class{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}};vg.prototype.normal={};vg.prototype.property={};vg.prototype.space=void 0;function e2(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new vg(t,r,n)}function r1(e){return e.toLowerCase()}let Aa=class{constructor(n,t){this.attribute=t,this.property=n}};Aa.prototype.attribute="";Aa.prototype.booleanish=!1;Aa.prototype.boolean=!1;Aa.prototype.commaOrSpaceSeparated=!1;Aa.prototype.commaSeparated=!1;Aa.prototype.defined=!1;Aa.prototype.mustUseProperty=!1;Aa.prototype.number=!1;Aa.prototype.overloadedBoolean=!1;Aa.prototype.property="";Aa.prototype.spaceSeparated=!1;Aa.prototype.space=void 0;let XM=0;const sn=Vd(),Ki=Vd(),t2=Vd(),gt=Vd(),yi=Vd(),Of=Vd(),Xa=Vd();function Vd(){return 2**++XM}const a1=Object.freeze(Object.defineProperty({__proto__:null,boolean:sn,booleanish:Ki,commaOrSpaceSeparated:Xa,commaSeparated:Of,number:gt,overloadedBoolean:t2,spaceSeparated:yi},Symbol.toStringTag,{value:"Module"})),e0=Object.keys(a1);let pw=class extends Aa{constructor(n,t,r,a){let o=-1;if(super(n,t),ON(this,"space",a),typeof r=="number")for(;++o<e0.length;){const l=e0[o];ON(this,e0[o],(r&a1[l])===a1[l])}}};pw.prototype.defined=!0;function ON(e,n,t){t&&(e[n]=t)}function Zf(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const o=new pw(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(o.mustUseProperty=!0),n[r]=o,t[r1(r)]=r,t[r1(o.attribute)]=r}return new vg(n,t,e.space)}const n2=Zf({properties:{ariaActiveDescendant:null,ariaAtomic:Ki,ariaAutoComplete:null,ariaBusy:Ki,ariaChecked:Ki,ariaColCount:gt,ariaColIndex:gt,ariaColSpan:gt,ariaControls:yi,ariaCurrent:null,ariaDescribedBy:yi,ariaDetails:null,ariaDisabled:Ki,ariaDropEffect:yi,ariaErrorMessage:null,ariaExpanded:Ki,ariaFlowTo:yi,ariaGrabbed:Ki,ariaHasPopup:null,ariaHidden:Ki,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:yi,ariaLevel:gt,ariaLive:null,ariaModal:Ki,ariaMultiLine:Ki,ariaMultiSelectable:Ki,ariaOrientation:null,ariaOwns:yi,ariaPlaceholder:null,ariaPosInSet:gt,ariaPressed:Ki,ariaReadOnly:Ki,ariaRelevant:null,ariaRequired:Ki,ariaRoleDescription:yi,ariaRowCount:gt,ariaRowIndex:gt,ariaRowSpan:gt,ariaSelected:Ki,ariaSetSize:gt,ariaSort:null,ariaValueMax:gt,ariaValueMin:gt,ariaValueNow:gt,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function i2(e,n){return n in e?e[n]:n}function r2(e,n){return i2(e,n.toLowerCase())}const ZM=Zf({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Of,acceptCharset:yi,accessKey:yi,action:null,allow:null,allowFullScreen:sn,allowPaymentRequest:sn,allowUserMedia:sn,alt:null,as:null,async:sn,autoCapitalize:null,autoComplete:yi,autoFocus:sn,autoPlay:sn,blocking:yi,capture:null,charSet:null,checked:sn,cite:null,className:yi,cols:gt,colSpan:null,content:null,contentEditable:Ki,controls:sn,controlsList:yi,coords:gt|Of,crossOrigin:null,data:null,dateTime:null,decoding:null,default:sn,defer:sn,dir:null,dirName:null,disabled:sn,download:t2,draggable:Ki,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:sn,formTarget:null,headers:yi,height:gt,hidden:sn,high:gt,href:null,hrefLang:null,htmlFor:yi,httpEquiv:yi,id:null,imageSizes:null,imageSrcSet:null,inert:sn,inputMode:null,integrity:null,is:null,isMap:sn,itemId:null,itemProp:yi,itemRef:yi,itemScope:sn,itemType:yi,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:sn,low:gt,manifest:null,max:null,maxLength:gt,media:null,method:null,min:null,minLength:gt,multiple:sn,muted:sn,name:null,nonce:null,noModule:sn,noValidate:sn,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:sn,optimum:gt,pattern:null,ping:yi,placeholder:null,playsInline:sn,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:sn,referrerPolicy:null,rel:yi,required:sn,reversed:sn,rows:gt,rowSpan:gt,sandbox:yi,scope:null,scoped:sn,seamless:sn,selected:sn,shadowRootClonable:sn,shadowRootDelegatesFocus:sn,shadowRootMode:null,shape:null,size:gt,sizes:null,slot:null,span:gt,spellCheck:Ki,src:null,srcDoc:null,srcLang:null,srcSet:null,start:gt,step:null,style:null,tabIndex:gt,target:null,title:null,translate:null,type:null,typeMustMatch:sn,useMap:null,value:Ki,width:gt,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:yi,axis:null,background:null,bgColor:null,border:gt,borderColor:null,bottomMargin:gt,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:sn,declare:sn,event:null,face:null,frame:null,frameBorder:null,hSpace:gt,leftMargin:gt,link:null,longDesc:null,lowSrc:null,marginHeight:gt,marginWidth:gt,noResize:sn,noHref:sn,noShade:sn,noWrap:sn,object:null,profile:null,prompt:null,rev:null,rightMargin:gt,rules:null,scheme:null,scrolling:Ki,standby:null,summary:null,text:null,topMargin:gt,valueType:null,version:null,vAlign:null,vLink:null,vSpace:gt,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:sn,disableRemotePlayback:sn,prefix:null,property:null,results:gt,security:null,unselectable:null},space:"html",transform:r2}),e4=Zf({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Xa,accentHeight:gt,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:gt,amplitude:gt,arabicForm:null,ascent:gt,attributeName:null,attributeType:null,azimuth:gt,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:gt,by:null,calcMode:null,capHeight:gt,className:yi,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:gt,diffuseConstant:gt,direction:null,display:null,dur:null,divisor:gt,dominantBaseline:null,download:sn,dx:null,dy:null,edgeMode:null,editable:null,elevation:gt,enableBackground:null,end:null,event:null,exponent:gt,externalResourcesRequired:null,fill:null,fillOpacity:gt,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Of,g2:Of,glyphName:Of,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:gt,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:gt,horizOriginX:gt,horizOriginY:gt,id:null,ideographic:gt,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:gt,k:gt,k1:gt,k2:gt,k3:gt,k4:gt,kernelMatrix:Xa,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:gt,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:gt,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:gt,overlineThickness:gt,paintOrder:null,panose1:null,path:null,pathLength:gt,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:yi,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:gt,pointsAtY:gt,pointsAtZ:gt,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Xa,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Xa,rev:Xa,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Xa,requiredFeatures:Xa,requiredFonts:Xa,requiredFormats:Xa,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:gt,specularExponent:gt,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:gt,strikethroughThickness:gt,string:null,stroke:null,strokeDashArray:Xa,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:gt,strokeOpacity:gt,strokeWidth:null,style:null,surfaceScale:gt,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Xa,tabIndex:gt,tableValues:null,target:null,targetX:gt,targetY:gt,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Xa,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:gt,underlineThickness:gt,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:gt,values:null,vAlphabetic:gt,vMathematical:gt,vectorEffect:null,vHanging:gt,vIdeographic:gt,version:null,vertAdvY:gt,vertOriginX:gt,vertOriginY:gt,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:gt,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:i2}),a2=Zf({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),s2=Zf({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:r2}),o2=Zf({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),t4={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},n4=/[A-Z]/g,LN=/-[a-z]/g,i4=/^data[-\w.:]+$/i;function r4(e,n){const t=r1(n);let r=n,a=Aa;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&i4.test(n)){if(n.charAt(4)==="-"){const o=n.slice(5).replace(LN,s4);r="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=n.slice(4);if(!LN.test(o)){let l=o.replace(n4,a4);l.charAt(0)!=="-"&&(l="-"+l),n="data"+l}}a=pw}return new a(r,n)}function a4(e){return"-"+e.toLowerCase()}function s4(e){return e.charAt(1).toUpperCase()}const o4=e2([n2,ZM,a2,s2,o2],"html"),mw=e2([n2,e4,a2,s2,o2],"svg");function l4(e){return e.join(" ").trim()}var bf={},t0,FN;function c4(){if(FN)return t0;FN=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=/\n/g,t=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,a=/^:\s*/,o=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,l=/^[;\s]*/,h=/^\s+|\s+$/g,d=`
`,u="/",f="*",g="",b="comment",v="declaration";t0=function(k,T){if(typeof k!="string")throw new TypeError("First argument must be a string");if(!k)return[];T=T||{};var E=1,P=1;function I(Z){var ne=Z.match(n);ne&&(E+=ne.length);var ae=Z.lastIndexOf(d);P=~ae?Z.length-ae:P+Z.length}function q(){var Z={line:E,column:P};return function(ne){return ne.position=new $(Z),z(),ne}}function $(Z){this.start=Z,this.end={line:E,column:P},this.source=T.source}$.prototype.content=k;function L(Z){var ne=new Error(T.source+":"+E+":"+P+": "+Z);if(ne.reason=Z,ne.filename=T.source,ne.line=E,ne.column=P,ne.source=k,!T.silent)throw ne}function F(Z){var ne=Z.exec(k);if(ne){var ae=ne[0];return I(ae),k=k.slice(ae.length),ne}}function z(){F(t)}function B(Z){var ne;for(Z=Z||[];ne=R();)ne!==!1&&Z.push(ne);return Z}function R(){var Z=q();if(!(u!=k.charAt(0)||f!=k.charAt(1))){for(var ne=2;g!=k.charAt(ne)&&(f!=k.charAt(ne)||u!=k.charAt(ne+1));)++ne;if(ne+=2,g===k.charAt(ne-1))return L("End of comment missing");var ae=k.slice(2,ne-2);return P+=2,I(ae),k=k.slice(ne),P+=2,Z({type:b,comment:ae})}}function U(){var Z=q(),ne=F(r);if(ne){if(R(),!F(a))return L("property missing ':'");var ae=F(o),X=Z({type:v,property:S(ne[0].replace(e,g)),value:ae?S(ae[0].replace(e,g)):g});return F(l),X}}function Y(){var Z=[];B(Z);for(var ne;ne=U();)ne!==!1&&(Z.push(ne),B(Z));return Z}return z(),Y()};function S(k){return k?k.replace(h,g):g}return t0}var $N;function u4(){if($N)return bf;$N=1;var e=bf&&bf.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(bf,"__esModule",{value:!0}),bf.default=t;var n=e(c4());function t(r,a){var o=null;if(!r||typeof r!="string")return o;var l=(0,n.default)(r),h=typeof a=="function";return l.forEach(function(d){if(d.type==="declaration"){var u=d.property,f=d.value;h?a(u,f,d):f&&(o=o||{},o[u]=f)}}),o}return bf}var Lm={},zN;function d4(){if(zN)return Lm;zN=1,Object.defineProperty(Lm,"__esModule",{value:!0}),Lm.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,n=/-([a-z])/g,t=/^[^-]+$/,r=/^-(webkit|moz|ms|o|khtml)-/,a=/^-(ms)-/,o=function(u){return!u||t.test(u)||e.test(u)},l=function(u,f){return f.toUpperCase()},h=function(u,f){return"".concat(f,"-")},d=function(u,f){return f===void 0&&(f={}),o(u)?u:(u=u.toLowerCase(),f.reactCompat?u=u.replace(a,h):u=u.replace(r,h),u.replace(n,l))};return Lm.camelCase=d,Lm}var Fm,BN;function h4(){if(BN)return Fm;BN=1;var e=Fm&&Fm.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},n=e(u4()),t=d4();function r(a,o){var l={};return!a||typeof a!="string"||(0,n.default)(a,function(h,d){h&&d&&(l[(0,t.camelCase)(h,o)]=d)}),l}return r.default=r,Fm=r,Fm}var f4=h4();const p4=qd(f4),l2=c2("end"),gw=c2("start");function c2(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function m4(e){const n=gw(e),t=l2(e);if(n&&t)return{start:n,end:t}}function Zm(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?UN(e.position):"start"in e||"end"in e?UN(e):"line"in e||"column"in e?s1(e):""}function s1(e){return qN(e&&e.line)+":"+qN(e&&e.column)}function UN(e){return s1(e&&e.start)+"-"+s1(e&&e.end)}function qN(e){return e&&typeof e=="number"?e:1}let Wr=class extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",o={},l=!1;if(t&&("line"in t&&"column"in t?o={place:t}:"start"in t&&"end"in t?o={place:t}:"type"in t?o={ancestors:[t],place:t.position}:o={...t}),typeof n=="string"?a=n:!o.cause&&n&&(l=!0,a=n.message,o.cause=n),!o.ruleId&&!o.source&&typeof r=="string"){const d=r.indexOf(":");d===-1?o.ruleId=r:(o.source=r.slice(0,d),o.ruleId=r.slice(d+1))}if(!o.place&&o.ancestors&&o.ancestors){const d=o.ancestors[o.ancestors.length-1];d&&(o.place=d.position)}const h=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=h?h.column:void 0,this.fatal=void 0,this.file,this.message=a,this.line=h?h.line:void 0,this.name=Zm(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=l&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual,this.expected,this.note,this.url}};Wr.prototype.file="";Wr.prototype.name="";Wr.prototype.reason="";Wr.prototype.message="";Wr.prototype.stack="";Wr.prototype.column=void 0;Wr.prototype.line=void 0;Wr.prototype.ancestors=void 0;Wr.prototype.cause=void 0;Wr.prototype.fatal=void 0;Wr.prototype.place=void 0;Wr.prototype.ruleId=void 0;Wr.prototype.source=void 0;const yw={}.hasOwnProperty,g4=new Map,y4=/[A-Z]/g,x4=new Set(["table","tbody","thead","tfoot","tr"]),b4=new Set(["td","th"]),u2="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function v4(e,n){if(!n||n.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=n.filePath||void 0;let r;if(n.development){if(typeof n.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=E4(t,n.jsxDEV)}else{if(typeof n.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof n.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=k4(t,n.jsx,n.jsxs)}const a={Fragment:n.Fragment,ancestors:[],components:n.components||{},create:r,elementAttributeNameCase:n.elementAttributeNameCase||"react",evaluater:n.createEvaluater?n.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:n.ignoreInvalidStyle||!1,passKeys:n.passKeys!==!1,passNode:n.passNode||!1,schema:n.space==="svg"?mw:o4,stylePropertyNameCase:n.stylePropertyNameCase||"dom",tableCellAlignToStyle:n.tableCellAlignToStyle!==!1},o=d2(a,e,void 0);return o&&typeof o!="string"?o:a.create(e,a.Fragment,{children:o||void 0},void 0)}function d2(e,n,t){if(n.type==="element")return w4(e,n,t);if(n.type==="mdxFlowExpression"||n.type==="mdxTextExpression")return N4(e,n);if(n.type==="mdxJsxFlowElement"||n.type==="mdxJsxTextElement")return j4(e,n,t);if(n.type==="mdxjsEsm")return S4(e,n);if(n.type==="root")return _4(e,n,t);if(n.type==="text")return C4(e,n)}function w4(e,n,t){const r=e.schema;let a=r;n.tagName.toLowerCase()==="svg"&&r.space==="html"&&(a=mw,e.schema=a),e.ancestors.push(n);const o=f2(e,n.tagName,!1),l=T4(e,n);let h=bw(e,n);return x4.has(n.tagName)&&(h=h.filter(function(d){return typeof d=="string"?!KM(d):!0})),h2(e,l,o,n),xw(l,h),e.ancestors.pop(),e.schema=r,e.create(n,o,l,t)}function N4(e,n){if(n.data&&n.data.estree&&e.evaluater){const r=n.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}cg(e,n.position)}function S4(e,n){if(n.data&&n.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(n.data.estree);cg(e,n.position)}function j4(e,n,t){const r=e.schema;let a=r;n.name==="svg"&&r.space==="html"&&(a=mw,e.schema=a),e.ancestors.push(n);const o=n.name===null?e.Fragment:f2(e,n.name,!0),l=A4(e,n),h=bw(e,n);return h2(e,l,o,n),xw(l,h),e.ancestors.pop(),e.schema=r,e.create(n,o,l,t)}function _4(e,n,t){const r={};return xw(r,bw(e,n)),e.create(n,e.Fragment,r,t)}function C4(e,n){return n.value}function h2(e,n,t,r){typeof t!="string"&&t!==e.Fragment&&e.passNode&&(n.node=r)}function xw(e,n){if(n.length>0){const t=n.length>1?n:n[0];t&&(e.children=t)}}function k4(e,n,t){return r;function r(a,o,l,h){const u=Array.isArray(l.children)?t:n;return h?u(o,l,h):u(o,l)}}function E4(e,n){return t;function t(r,a,o,l){const h=Array.isArray(o.children),d=gw(r);return n(a,o,l,h,{columnNumber:d?d.column-1:void 0,fileName:e,lineNumber:d?d.line:void 0},void 0)}}function T4(e,n){const t={};let r,a;for(a in n.properties)if(a!=="children"&&yw.call(n.properties,a)){const o=D4(e,a,n.properties[a]);if(o){const[l,h]=o;e.tableCellAlignToStyle&&l==="align"&&typeof h=="string"&&b4.has(n.tagName)?r=h:t[l]=h}}if(r){const o=t.style||(t.style={});o[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return t}function A4(e,n){const t={};for(const r of n.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const o=r.data.estree.body[0];o.type;const l=o.expression;l.type;const h=l.properties[0];h.type,Object.assign(t,e.evaluater.evaluateExpression(h.argument))}else cg(e,n.position);else{const a=r.name;let o;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const h=r.value.data.estree.body[0];h.type,o=e.evaluater.evaluateExpression(h.expression)}else cg(e,n.position);else o=r.value===null?!0:r.value;t[a]=o}return t}function bw(e,n){const t=[];let r=-1;const a=e.passKeys?new Map:g4;for(;++r<n.children.length;){const o=n.children[r];let l;if(e.passKeys){const d=o.type==="element"?o.tagName:o.type==="mdxJsxFlowElement"||o.type==="mdxJsxTextElement"?o.name:void 0;if(d){const u=a.get(d)||0;l=d+"-"+u,a.set(d,u+1)}}const h=d2(e,o,l);h!==void 0&&t.push(h)}return t}function D4(e,n,t){const r=r4(e.schema,n);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=r.commaSeparated?GM(t):l4(t)),r.property==="style"){let a=typeof t=="object"?t:P4(e,String(t));return e.stylePropertyNameCase==="css"&&(a=I4(a)),["style",a]}return[e.elementAttributeNameCase==="react"&&r.space?t4[r.property]||r.property:r.attribute,t]}}function P4(e,n){try{return p4(n,{reactCompat:!0})}catch(t){if(e.ignoreInvalidStyle)return{};const r=t,a=new Wr("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=e.filePath||void 0,a.url=u2+"#cannot-parse-style-attribute",a}}function f2(e,n,t){let r;if(!t)r={type:"Literal",value:n};else if(n.includes(".")){const a=n.split(".");let o=-1,l;for(;++o<a.length;){const h=MN(a[o])?{type:"Identifier",name:a[o]}:{type:"Literal",value:a[o]};l=l?{type:"MemberExpression",object:l,property:h,computed:!!(o&&h.type==="Literal"),optional:!1}:h}r=l}else r=MN(n)&&!/^[a-z]/.test(n)?{type:"Identifier",name:n}:{type:"Literal",value:n};if(r.type==="Literal"){const a=r.value;return yw.call(e.components,a)?e.components[a]:a}if(e.evaluater)return e.evaluater.evaluateExpression(r);cg(e)}function cg(e,n){const t=new Wr("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:n,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=e.filePath||void 0,t.url=u2+"#cannot-handle-mdx-estrees-without-createevaluater",t}function I4(e){const n={};let t;for(t in e)yw.call(e,t)&&(n[M4(t)]=e[t]);return n}function M4(e){let n=e.replace(y4,R4);return n.slice(0,3)==="ms-"&&(n="-"+n),n}function R4(e){return"-"+e.toLowerCase()}const n0={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},O4={};function vw(e,n){const t=O4,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return p2(e,r,a)}function p2(e,n,t){if(L4(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return VN(e.children,n,t)}return Array.isArray(e)?VN(e,n,t):""}function VN(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=p2(e[a],n,t);return r.join("")}function L4(e){return!!(e&&typeof e=="object")}const HN=document.createElement("i");function ww(e){const n="&"+e+";";HN.innerHTML=n;const t=HN.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function is(e,n,t,r){const a=e.length;let o=0,l;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)l=Array.from(r),l.unshift(n,t),e.splice(...l);else for(t&&e.splice(n,t);o<r.length;)l=r.slice(o,o+1e4),l.unshift(n,0),e.splice(...l),o+=1e4,n+=1e4}function Es(e,n){return e.length>0?(is(e,e.length,0,n),e):n}const GN={}.hasOwnProperty;function m2(e){const n={};let t=-1;for(;++t<e.length;)F4(n,e[t]);return n}function F4(e,n){let t;for(t in n){const a=(GN.call(e,t)?e[t]:void 0)||(e[t]={}),o=n[t];let l;if(o)for(l in o){GN.call(a,l)||(a[l]=[]);const h=o[l];$4(a[l],Array.isArray(h)?h:h?[h]:[])}}}function $4(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);is(e,0,0,r)}function g2(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function po(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const aa=gu(/[A-Za-z]/),Hr=gu(/[\dA-Za-z]/),z4=gu(/[#-'*+\--9=?A-Z^-~]/);function ob(e){return e!==null&&(e<32||e===127)}const o1=gu(/\d/),B4=gu(/[\dA-Fa-f]/),U4=gu(/[!-/:-@[-`{-~]/);function Ht(e){return e!==null&&e<-2}function di(e){return e!==null&&(e<0||e===32)}function kn(e){return e===-2||e===-1||e===32}const Ib=gu(new RegExp("\\p{P}|\\p{S}","u")),zd=gu(/\s/);function gu(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function ep(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const o=e.charCodeAt(t);let l="";if(o===37&&Hr(e.charCodeAt(t+1))&&Hr(e.charCodeAt(t+2)))a=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(l=String.fromCharCode(o));else if(o>55295&&o<57344){const h=e.charCodeAt(t+1);o<56320&&h>56319&&h<57344?(l=String.fromCharCode(o,h),a=1):l=""}else l=String.fromCharCode(o);l&&(n.push(e.slice(r,t),encodeURIComponent(l)),r=t+a+1,l=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function Rn(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let o=0;return l;function l(d){return kn(d)?(e.enter(t),h(d)):n(d)}function h(d){return kn(d)&&o++<a?(e.consume(d),h):(e.exit(t),n(d))}}const q4={tokenize:V4};function V4(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(h){if(h===null){e.consume(h);return}return e.enter("lineEnding"),e.consume(h),e.exit("lineEnding"),Rn(e,n,"linePrefix")}function a(h){return e.enter("paragraph"),o(h)}function o(h){const d=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=d),t=d,l(h)}function l(h){if(h===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(h);return}return Ht(h)?(e.consume(h),e.exit("chunkText"),o):(e.consume(h),l)}}const H4={tokenize:G4},YN={tokenize:Y4};function G4(e){const n=this,t=[];let r=0,a,o,l;return h;function h(I){if(r<t.length){const q=t[r];return n.containerState=q[1],e.attempt(q[0].continuation,d,u)(I)}return u(I)}function d(I){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&P();const q=n.events.length;let $=q,L;for(;$--;)if(n.events[$][0]==="exit"&&n.events[$][1].type==="chunkFlow"){L=n.events[$][1].end;break}E(r);let F=q;for(;F<n.events.length;)n.events[F][1].end={...L},F++;return is(n.events,$+1,0,n.events.slice(q)),n.events.length=F,u(I)}return h(I)}function u(I){if(r===t.length){if(!a)return b(I);if(a.currentConstruct&&a.currentConstruct.concrete)return S(I);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(YN,f,g)(I)}function f(I){return a&&P(),E(r),b(I)}function g(I){return n.parser.lazy[n.now().line]=r!==t.length,l=n.now().offset,S(I)}function b(I){return n.containerState={},e.attempt(YN,v,S)(I)}function v(I){return r++,t.push([n.currentConstruct,n.containerState]),b(I)}function S(I){if(I===null){a&&P(),E(0),e.consume(I);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:o}),k(I)}function k(I){if(I===null){T(e.exit("chunkFlow"),!0),E(0),e.consume(I);return}return Ht(I)?(e.consume(I),T(e.exit("chunkFlow")),r=0,n.interrupt=void 0,h):(e.consume(I),k)}function T(I,q){const $=n.sliceStream(I);if(q&&$.push(null),I.previous=o,o&&(o.next=I),o=I,a.defineSkip(I.start),a.write($),n.parser.lazy[I.start.line]){let L=a.events.length;for(;L--;)if(a.events[L][1].start.offset<l&&(!a.events[L][1].end||a.events[L][1].end.offset>l))return;const F=n.events.length;let z=F,B,R;for(;z--;)if(n.events[z][0]==="exit"&&n.events[z][1].type==="chunkFlow"){if(B){R=n.events[z][1].end;break}B=!0}for(E(r),L=F;L<n.events.length;)n.events[L][1].end={...R},L++;is(n.events,z+1,0,n.events.slice(F)),n.events.length=L}}function E(I){let q=t.length;for(;q-- >I;){const $=t[q];n.containerState=$[1],$[0].exit.call(n,e)}t.length=I}function P(){a.write([null]),o=void 0,a=void 0,n.containerState._closeFlow=void 0}}function Y4(e,n,t){return Rn(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function qf(e){if(e===null||di(e)||zd(e))return 1;if(Ib(e))return 2}function Mb(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const o=e[a].resolveAll;o&&!r.includes(o)&&(n=o(n,t),r.push(o))}return n}const l1={name:"attention",resolveAll:W4,tokenize:Q4};function W4(e,n){let t=-1,r,a,o,l,h,d,u,f;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;d=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};WN(g,-d),WN(b,d),l={type:d>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},h={type:d>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},o={type:d>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:d>1?"strong":"emphasis",start:{...l.start},end:{...h.end}},e[r][1].end={...l.start},e[t][1].start={...h.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=Es(u,[["enter",e[r][1],n],["exit",e[r][1],n]])),u=Es(u,[["enter",a,n],["enter",l,n],["exit",l,n],["enter",o,n]]),u=Es(u,Mb(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),u=Es(u,[["exit",o,n],["enter",h,n],["exit",h,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(f=2,u=Es(u,[["enter",e[t][1],n],["exit",e[t][1],n]])):f=0,is(e,r-1,t-r+3,u),t=r+u.length-f-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function Q4(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=qf(r);let o;return l;function l(d){return o=d,e.enter("attentionSequence"),h(d)}function h(d){if(d===o)return e.consume(d),h;const u=e.exit("attentionSequence"),f=qf(d),g=!f||f===2&&a||t.includes(d),b=!a||a===2&&f||t.includes(r);return u._open=!!(o===42?g:g&&(a||!b)),u._close=!!(o===42?b:b&&(f||!g)),n(d)}}function WN(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const J4={name:"autolink",tokenize:K4};function K4(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o}function o(v){return aa(v)?(e.consume(v),l):v===64?t(v):u(v)}function l(v){return v===43||v===45||v===46||Hr(v)?(r=1,h(v)):u(v)}function h(v){return v===58?(e.consume(v),r=0,d):(v===43||v===45||v===46||Hr(v))&&r++<32?(e.consume(v),h):(r=0,u(v))}function d(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||ob(v)?t(v):(e.consume(v),d)}function u(v){return v===64?(e.consume(v),f):z4(v)?(e.consume(v),u):t(v)}function f(v){return Hr(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,f):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||Hr(v))&&r++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const wg={partial:!0,tokenize:X4};function X4(e,n,t){return r;function r(o){return kn(o)?Rn(e,a,"linePrefix")(o):a(o)}function a(o){return o===null||Ht(o)?n(o):t(o)}}const y2={continuation:{tokenize:eR},exit:tR,name:"blockQuote",tokenize:Z4};function Z4(e,n,t){const r=this;return a;function a(l){if(l===62){const h=r.containerState;return h.open||(e.enter("blockQuote",{_container:!0}),h.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),o}return t(l)}function o(l){return kn(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(l))}}function eR(e,n,t){const r=this;return a;function a(l){return kn(l)?Rn(e,o,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):o(l)}function o(l){return e.attempt(y2,n,t)(l)}}function tR(e){e.exit("blockQuote")}const x2={name:"characterEscape",tokenize:nR};function nR(e,n,t){return r;function r(o){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(o),e.exit("escapeMarker"),a}function a(o){return U4(o)?(e.enter("characterEscapeValue"),e.consume(o),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(o)}}const b2={name:"characterReference",tokenize:iR};function iR(e,n,t){const r=this;let a=0,o,l;return h;function h(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),d}function d(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),o=31,l=Hr,f(g))}function u(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,l=B4,f):(e.enter("characterReferenceValue"),o=7,l=o1,f(g))}function f(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return l===Hr&&!ww(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return l(g)&&a++<o?(e.consume(g),f):t(g)}}const QN={partial:!0,tokenize:aR},JN={concrete:!0,name:"codeFenced",tokenize:rR};function rR(e,n,t){const r=this,a={partial:!0,tokenize:$};let o=0,l=0,h;return d;function d(L){return u(L)}function u(L){const F=r.events[r.events.length-1];return o=F&&F[1].type==="linePrefix"?F[2].sliceSerialize(F[1],!0).length:0,h=L,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),f(L)}function f(L){return L===h?(l++,e.consume(L),f):l<3?t(L):(e.exit("codeFencedFenceSequence"),kn(L)?Rn(e,g,"whitespace")(L):g(L))}function g(L){return L===null||Ht(L)?(e.exit("codeFencedFence"),r.interrupt?n(L):e.check(QN,k,q)(L)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b(L))}function b(L){return L===null||Ht(L)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g(L)):kn(L)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Rn(e,v,"whitespace")(L)):L===96&&L===h?t(L):(e.consume(L),b)}function v(L){return L===null||Ht(L)?g(L):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S(L))}function S(L){return L===null||Ht(L)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g(L)):L===96&&L===h?t(L):(e.consume(L),S)}function k(L){return e.attempt(a,q,T)(L)}function T(L){return e.enter("lineEnding"),e.consume(L),e.exit("lineEnding"),E}function E(L){return o>0&&kn(L)?Rn(e,P,"linePrefix",o+1)(L):P(L)}function P(L){return L===null||Ht(L)?e.check(QN,k,q)(L):(e.enter("codeFlowValue"),I(L))}function I(L){return L===null||Ht(L)?(e.exit("codeFlowValue"),P(L)):(e.consume(L),I)}function q(L){return e.exit("codeFenced"),n(L)}function $(L,F,z){let B=0;return R;function R(ae){return L.enter("lineEnding"),L.consume(ae),L.exit("lineEnding"),U}function U(ae){return L.enter("codeFencedFence"),kn(ae)?Rn(L,Y,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(ae):Y(ae)}function Y(ae){return ae===h?(L.enter("codeFencedFenceSequence"),Z(ae)):z(ae)}function Z(ae){return ae===h?(B++,L.consume(ae),Z):B>=l?(L.exit("codeFencedFenceSequence"),kn(ae)?Rn(L,ne,"whitespace")(ae):ne(ae)):z(ae)}function ne(ae){return ae===null||Ht(ae)?(L.exit("codeFencedFence"),F(ae)):z(ae)}}}function aR(e,n,t){const r=this;return a;function a(l){return l===null?t(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}const i0={name:"codeIndented",tokenize:oR},sR={partial:!0,tokenize:lR};function oR(e,n,t){const r=this;return a;function a(u){return e.enter("codeIndented"),Rn(e,o,"linePrefix",5)(u)}function o(u){const f=r.events[r.events.length-1];return f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?l(u):t(u)}function l(u){return u===null?d(u):Ht(u)?e.attempt(sR,l,d)(u):(e.enter("codeFlowValue"),h(u))}function h(u){return u===null||Ht(u)?(e.exit("codeFlowValue"),l(u)):(e.consume(u),h)}function d(u){return e.exit("codeIndented"),n(u)}}function lR(e,n,t){const r=this;return a;function a(l){return r.parser.lazy[r.now().line]?t(l):Ht(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):Rn(e,o,"linePrefix",5)(l)}function o(l){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?n(l):Ht(l)?a(l):t(l)}}const cR={name:"codeText",previous:dR,resolve:uR,tokenize:hR};function uR(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function dR(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function hR(e,n,t){let r=0,a,o;return l;function l(g){return e.enter("codeText"),e.enter("codeTextSequence"),h(g)}function h(g){return g===96?(e.consume(g),r++,h):(e.exit("codeTextSequence"),d(g))}function d(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),d):g===96?(o=e.enter("codeTextSequence"),a=0,f(g)):Ht(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),d):(e.enter("codeTextData"),u(g))}function u(g){return g===null||g===32||g===96||Ht(g)?(e.exit("codeTextData"),d(g)):(e.consume(g),u)}function f(g){return g===96?(e.consume(g),a++,f):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(o.type="codeTextData",u(g))}}let fR=class{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const o=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&$m(this.left,r),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),$m(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),$m(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);$m(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);$m(this.left,t.reverse())}}};function $m(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function v2(e){const n={};let t=-1,r,a,o,l,h,d,u;const f=new fR(e);for(;++t<f.length;){for(;t in n;)t=n[t];if(r=f.get(t),t&&r[1].type==="chunkFlow"&&f.get(t-1)[1].type==="listItemPrefix"&&(d=r[1]._tokenizer.events,o=0,o<d.length&&d[o][1].type==="lineEndingBlank"&&(o+=2),o<d.length&&d[o][1].type==="content"))for(;++o<d.length&&d[o][1].type!=="content";)d[o][1].type==="chunkText"&&(d[o][1]._isInFirstContentOfListItem=!0,o++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,pR(f,t)),t=n[t],u=!0);else if(r[1]._container){for(o=t,a=void 0;o--;)if(l=f.get(o),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(f.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=o);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(r[1].end={...f.get(a)[1].start},h=f.slice(a,t),h.unshift(r),f.splice(a,t-a+1,h))}}return is(e,0,Number.POSITIVE_INFINITY,f.slice(0)),!u}function pR(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const o=[];let l=t._tokenizer;l||(l=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const h=l.events,d=[],u={};let f,g,b=-1,v=t,S=0,k=0;const T=[k];for(;v;){for(;e.get(++a)[1]!==v;);o.push(a),v._tokenizer||(f=r.sliceStream(v),v.next||f.push(null),g&&l.defineSkip(v.start),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(f),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<h.length;)h[b][0]==="exit"&&h[b-1][0]==="enter"&&h[b][1].type===h[b-1][1].type&&h[b][1].start.line!==h[b][1].end.line&&(k=b+1,T.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(l.events=[],v?(v._tokenizer=void 0,v.previous=void 0):T.pop(),b=T.length;b--;){const E=h.slice(T[b],T[b+1]),P=o.pop();d.push([P,P+E.length-1]),e.splice(P,2,E)}for(d.reverse(),b=-1;++b<d.length;)u[S+d[b][0]]=S+d[b][1],S+=d[b][1]-d[b][0]-1;return u}const mR={resolve:yR,tokenize:xR},gR={partial:!0,tokenize:bR};function yR(e){return v2(e),e}function xR(e,n){let t;return r;function r(h){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(h)}function a(h){return h===null?o(h):Ht(h)?e.check(gR,l,o)(h):(e.consume(h),a)}function o(h){return e.exit("chunkContent"),e.exit("content"),n(h)}function l(h){return e.consume(h),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function bR(e,n,t){const r=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),Rn(e,o,"linePrefix")}function o(l){if(l===null||Ht(l))return t(l);const h=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?n(l):e.interrupt(r.parser.constructs.flow,t,n)(l)}}function w2(e,n,t,r,a,o,l,h,d){const u=d||Number.POSITIVE_INFINITY;let f=0;return g;function g(E){return E===60?(e.enter(r),e.enter(a),e.enter(o),e.consume(E),e.exit(o),b):E===null||E===32||E===41||ob(E)?t(E):(e.enter(r),e.enter(l),e.enter(h),e.enter("chunkString",{contentType:"string"}),k(E))}function b(E){return E===62?(e.enter(o),e.consume(E),e.exit(o),e.exit(a),e.exit(r),n):(e.enter(h),e.enter("chunkString",{contentType:"string"}),v(E))}function v(E){return E===62?(e.exit("chunkString"),e.exit(h),b(E)):E===null||E===60||Ht(E)?t(E):(e.consume(E),E===92?S:v)}function S(E){return E===60||E===62||E===92?(e.consume(E),v):v(E)}function k(E){return!f&&(E===null||E===41||di(E))?(e.exit("chunkString"),e.exit(h),e.exit(l),e.exit(r),n(E)):f<u&&E===40?(e.consume(E),f++,k):E===41?(e.consume(E),f--,k):E===null||E===32||E===40||ob(E)?t(E):(e.consume(E),E===92?T:k)}function T(E){return E===40||E===41||E===92?(e.consume(E),k):k(E)}}function N2(e,n,t,r,a,o){const l=this;let h=0,d;return u;function u(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(o),f}function f(v){return h>999||v===null||v===91||v===93&&!d||v===94&&!h&&"_hiddenFootnoteSupport"in l.parser.constructs?t(v):v===93?(e.exit(o),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):Ht(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),f):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||Ht(v)||h++>999?(e.exit("chunkString"),f(v)):(e.consume(v),d||(d=!kn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),h++,g):g(v)}}function S2(e,n,t,r,a,o){let l;return h;function h(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),l=b===40?41:b,d):t(b)}function d(b){return b===l?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(o),u(b))}function u(b){return b===l?(e.exit(o),d(l)):b===null?t(b):Ht(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),Rn(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),f(b))}function f(b){return b===l||b===null||Ht(b)?(e.exit("chunkString"),u(b)):(e.consume(b),b===92?g:f)}function g(b){return b===l||b===92?(e.consume(b),f):f(b)}}function eg(e,n){let t;return r;function r(a){return Ht(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):kn(a)?Rn(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const vR={name:"definition",tokenize:NR},wR={partial:!0,tokenize:SR};function NR(e,n,t){const r=this;let a;return o;function o(v){return e.enter("definition"),l(v)}function l(v){return N2.call(r,e,h,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function h(v){return a=po(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),d):t(v)}function d(v){return di(v)?eg(e,u)(v):u(v)}function u(v){return w2(e,f,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function f(v){return e.attempt(wR,g,g)(v)}function g(v){return kn(v)?Rn(e,b,"whitespace")(v):b(v)}function b(v){return v===null||Ht(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function SR(e,n,t){return r;function r(h){return di(h)?eg(e,a)(h):t(h)}function a(h){return S2(e,o,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(h)}function o(h){return kn(h)?Rn(e,l,"whitespace")(h):l(h)}function l(h){return h===null||Ht(h)?n(h):t(h)}}const jR={name:"hardBreakEscape",tokenize:_R};function _R(e,n,t){return r;function r(o){return e.enter("hardBreakEscape"),e.consume(o),a}function a(o){return Ht(o)?(e.exit("hardBreakEscape"),n(o)):t(o)}}const CR={name:"headingAtx",resolve:kR,tokenize:ER};function kR(e,n){let t=e.length-2,r=3,a,o;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},o={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},is(e,r,t-r+1,[["enter",a,n],["enter",o,n],["exit",o,n],["exit",a,n]])),e}function ER(e,n,t){let r=0;return a;function a(f){return e.enter("atxHeading"),o(f)}function o(f){return e.enter("atxHeadingSequence"),l(f)}function l(f){return f===35&&r++<6?(e.consume(f),l):f===null||di(f)?(e.exit("atxHeadingSequence"),h(f)):t(f)}function h(f){return f===35?(e.enter("atxHeadingSequence"),d(f)):f===null||Ht(f)?(e.exit("atxHeading"),n(f)):kn(f)?Rn(e,h,"whitespace")(f):(e.enter("atxHeadingText"),u(f))}function d(f){return f===35?(e.consume(f),d):(e.exit("atxHeadingSequence"),h(f))}function u(f){return f===null||f===35||di(f)?(e.exit("atxHeadingText"),h(f)):(e.consume(f),u)}}const TR=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],KN=["pre","script","style","textarea"],AR={concrete:!0,name:"htmlFlow",resolveTo:IR,tokenize:MR},DR={partial:!0,tokenize:OR},PR={partial:!0,tokenize:RR};function IR(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function MR(e,n,t){const r=this;let a,o,l,h,d;return u;function u(M){return f(M)}function f(M){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(M),g}function g(M){return M===33?(e.consume(M),b):M===47?(e.consume(M),o=!0,k):M===63?(e.consume(M),a=3,r.interrupt?n:D):aa(M)?(e.consume(M),l=String.fromCharCode(M),T):t(M)}function b(M){return M===45?(e.consume(M),a=2,v):M===91?(e.consume(M),a=5,h=0,S):aa(M)?(e.consume(M),a=4,r.interrupt?n:D):t(M)}function v(M){return M===45?(e.consume(M),r.interrupt?n:D):t(M)}function S(M){const ge="CDATA[";return M===ge.charCodeAt(h++)?(e.consume(M),h===ge.length?r.interrupt?n:Y:S):t(M)}function k(M){return aa(M)?(e.consume(M),l=String.fromCharCode(M),T):t(M)}function T(M){if(M===null||M===47||M===62||di(M)){const ge=M===47,_e=l.toLowerCase();return!ge&&!o&&KN.includes(_e)?(a=1,r.interrupt?n(M):Y(M)):TR.includes(l.toLowerCase())?(a=6,ge?(e.consume(M),E):r.interrupt?n(M):Y(M)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(M):o?P(M):I(M))}return M===45||Hr(M)?(e.consume(M),l+=String.fromCharCode(M),T):t(M)}function E(M){return M===62?(e.consume(M),r.interrupt?n:Y):t(M)}function P(M){return kn(M)?(e.consume(M),P):R(M)}function I(M){return M===47?(e.consume(M),R):M===58||M===95||aa(M)?(e.consume(M),q):kn(M)?(e.consume(M),I):R(M)}function q(M){return M===45||M===46||M===58||M===95||Hr(M)?(e.consume(M),q):$(M)}function $(M){return M===61?(e.consume(M),L):kn(M)?(e.consume(M),$):I(M)}function L(M){return M===null||M===60||M===61||M===62||M===96?t(M):M===34||M===39?(e.consume(M),d=M,F):kn(M)?(e.consume(M),L):z(M)}function F(M){return M===d?(e.consume(M),d=null,B):M===null||Ht(M)?t(M):(e.consume(M),F)}function z(M){return M===null||M===34||M===39||M===47||M===60||M===61||M===62||M===96||di(M)?$(M):(e.consume(M),z)}function B(M){return M===47||M===62||kn(M)?I(M):t(M)}function R(M){return M===62?(e.consume(M),U):t(M)}function U(M){return M===null||Ht(M)?Y(M):kn(M)?(e.consume(M),U):t(M)}function Y(M){return M===45&&a===2?(e.consume(M),X):M===60&&a===1?(e.consume(M),W):M===62&&a===4?(e.consume(M),te):M===63&&a===3?(e.consume(M),D):M===93&&a===5?(e.consume(M),he):Ht(M)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(DR,ve,Z)(M)):M===null||Ht(M)?(e.exit("htmlFlowData"),Z(M)):(e.consume(M),Y)}function Z(M){return e.check(PR,ne,ve)(M)}function ne(M){return e.enter("lineEnding"),e.consume(M),e.exit("lineEnding"),ae}function ae(M){return M===null||Ht(M)?Z(M):(e.enter("htmlFlowData"),Y(M))}function X(M){return M===45?(e.consume(M),D):Y(M)}function W(M){return M===47?(e.consume(M),l="",H):Y(M)}function H(M){if(M===62){const ge=l.toLowerCase();return KN.includes(ge)?(e.consume(M),te):Y(M)}return aa(M)&&l.length<8?(e.consume(M),l+=String.fromCharCode(M),H):Y(M)}function he(M){return M===93?(e.consume(M),D):Y(M)}function D(M){return M===62?(e.consume(M),te):M===45&&a===2?(e.consume(M),D):Y(M)}function te(M){return M===null||Ht(M)?(e.exit("htmlFlowData"),ve(M)):(e.consume(M),te)}function ve(M){return e.exit("htmlFlow"),n(M)}}function RR(e,n,t){const r=this;return a;function a(l){return Ht(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o):t(l)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}function OR(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(wg,n,t)}}const LR={name:"htmlText",tokenize:FR};function FR(e,n,t){const r=this;let a,o,l;return h;function h(D){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(D),d}function d(D){return D===33?(e.consume(D),u):D===47?(e.consume(D),$):D===63?(e.consume(D),I):aa(D)?(e.consume(D),z):t(D)}function u(D){return D===45?(e.consume(D),f):D===91?(e.consume(D),o=0,S):aa(D)?(e.consume(D),P):t(D)}function f(D){return D===45?(e.consume(D),v):t(D)}function g(D){return D===null?t(D):D===45?(e.consume(D),b):Ht(D)?(l=g,W(D)):(e.consume(D),g)}function b(D){return D===45?(e.consume(D),v):g(D)}function v(D){return D===62?X(D):D===45?b(D):g(D)}function S(D){const te="CDATA[";return D===te.charCodeAt(o++)?(e.consume(D),o===te.length?k:S):t(D)}function k(D){return D===null?t(D):D===93?(e.consume(D),T):Ht(D)?(l=k,W(D)):(e.consume(D),k)}function T(D){return D===93?(e.consume(D),E):k(D)}function E(D){return D===62?X(D):D===93?(e.consume(D),E):k(D)}function P(D){return D===null||D===62?X(D):Ht(D)?(l=P,W(D)):(e.consume(D),P)}function I(D){return D===null?t(D):D===63?(e.consume(D),q):Ht(D)?(l=I,W(D)):(e.consume(D),I)}function q(D){return D===62?X(D):I(D)}function $(D){return aa(D)?(e.consume(D),L):t(D)}function L(D){return D===45||Hr(D)?(e.consume(D),L):F(D)}function F(D){return Ht(D)?(l=F,W(D)):kn(D)?(e.consume(D),F):X(D)}function z(D){return D===45||Hr(D)?(e.consume(D),z):D===47||D===62||di(D)?B(D):t(D)}function B(D){return D===47?(e.consume(D),X):D===58||D===95||aa(D)?(e.consume(D),R):Ht(D)?(l=B,W(D)):kn(D)?(e.consume(D),B):X(D)}function R(D){return D===45||D===46||D===58||D===95||Hr(D)?(e.consume(D),R):U(D)}function U(D){return D===61?(e.consume(D),Y):Ht(D)?(l=U,W(D)):kn(D)?(e.consume(D),U):B(D)}function Y(D){return D===null||D===60||D===61||D===62||D===96?t(D):D===34||D===39?(e.consume(D),a=D,Z):Ht(D)?(l=Y,W(D)):kn(D)?(e.consume(D),Y):(e.consume(D),ne)}function Z(D){return D===a?(e.consume(D),a=void 0,ae):D===null?t(D):Ht(D)?(l=Z,W(D)):(e.consume(D),Z)}function ne(D){return D===null||D===34||D===39||D===60||D===61||D===96?t(D):D===47||D===62||di(D)?B(D):(e.consume(D),ne)}function ae(D){return D===47||D===62||di(D)?B(D):t(D)}function X(D){return D===62?(e.consume(D),e.exit("htmlTextData"),e.exit("htmlText"),n):t(D)}function W(D){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(D),e.exit("lineEnding"),H}function H(D){return kn(D)?Rn(e,he,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(D):he(D)}function he(D){return e.enter("htmlTextData"),l(D)}}const Nw={name:"labelEnd",resolveAll:UR,resolveTo:qR,tokenize:VR},$R={tokenize:HR},zR={tokenize:GR},BR={tokenize:YR};function UR(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&is(e,0,e.length,t),e}function qR(e,n){let t=e.length,r=0,a,o,l,h;for(;t--;)if(a=e[t][1],o){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(o=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(l=t);const d={type:e[o][1].type==="labelLink"?"link":"image",start:{...e[o][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[o][1].start},end:{...e[l][1].end}},f={type:"labelText",start:{...e[o+r+2][1].end},end:{...e[l-2][1].start}};return h=[["enter",d,n],["enter",u,n]],h=Es(h,e.slice(o+1,o+r+3)),h=Es(h,[["enter",f,n]]),h=Es(h,Mb(n.parser.constructs.insideSpan.null,e.slice(o+r+4,l-3),n)),h=Es(h,[["exit",f,n],e[l-2],e[l-1],["exit",u,n]]),h=Es(h,e.slice(l+1)),h=Es(h,[["exit",d,n]]),is(e,o,e.length,h),e}function VR(e,n,t){const r=this;let a=r.events.length,o,l;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){o=r.events[a][1];break}return h;function h(b){return o?o._inactive?g(b):(l=r.parser.defined.includes(po(r.sliceSerialize({start:o.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),d):t(b)}function d(b){return b===40?e.attempt($R,f,l?f:g)(b):b===91?e.attempt(zR,f,l?u:g)(b):l?f(b):g(b)}function u(b){return e.attempt(BR,f,g)(b)}function f(b){return n(b)}function g(b){return o._balanced=!0,t(b)}}function HR(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return di(g)?eg(e,o)(g):o(g)}function o(g){return g===41?f(g):w2(e,l,h,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function l(g){return di(g)?eg(e,d)(g):f(g)}function h(g){return t(g)}function d(g){return g===34||g===39||g===40?S2(e,u,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):f(g)}function u(g){return di(g)?eg(e,f)(g):f(g)}function f(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function GR(e,n,t){const r=this;return a;function a(h){return N2.call(r,e,o,l,"reference","referenceMarker","referenceString")(h)}function o(h){return r.parser.defined.includes(po(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(h):t(h)}function l(h){return t(h)}}function YR(e,n,t){return r;function r(o){return e.enter("reference"),e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),a}function a(o){return o===93?(e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),e.exit("reference"),n):t(o)}}const WR={name:"labelStartImage",resolveAll:Nw.resolveAll,tokenize:QR};function QR(e,n,t){const r=this;return a;function a(h){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(h),e.exit("labelImageMarker"),o}function o(h){return h===91?(e.enter("labelMarker"),e.consume(h),e.exit("labelMarker"),e.exit("labelImage"),l):t(h)}function l(h){return h===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(h):n(h)}}const JR={name:"labelStartLink",resolveAll:Nw.resolveAll,tokenize:KR};function KR(e,n,t){const r=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),o}function o(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(l):n(l)}}const r0={name:"lineEnding",tokenize:XR};function XR(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),Rn(e,n,"linePrefix")}}const Yx={name:"thematicBreak",tokenize:ZR};function ZR(e,n,t){let r=0,a;return o;function o(u){return e.enter("thematicBreak"),l(u)}function l(u){return a=u,h(u)}function h(u){return u===a?(e.enter("thematicBreakSequence"),d(u)):r>=3&&(u===null||Ht(u))?(e.exit("thematicBreak"),n(u)):t(u)}function d(u){return u===a?(e.consume(u),r++,d):(e.exit("thematicBreakSequence"),kn(u)?Rn(e,h,"whitespace")(u):h(u))}}const ja={continuation:{tokenize:iO},exit:aO,name:"list",tokenize:nO},eO={partial:!0,tokenize:sO},tO={partial:!0,tokenize:rO};function nO(e,n,t){const r=this,a=r.events[r.events.length-1];let o=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return h;function h(v){const S=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:o1(v)){if(r.containerState.type||(r.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(Yx,t,u)(v):u(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),d(v)}return t(v)}function d(v){return o1(v)&&++l<10?(e.consume(v),d):(!r.interrupt||l<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),u(v)):t(v)}function u(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(wg,r.interrupt?t:f,e.attempt(eO,b,g))}function f(v){return r.containerState.initialBlankLine=!0,o++,b(v)}function g(v){return kn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=o+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function iO(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(wg,a,o);function a(h){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,Rn(e,n,"listItemIndent",r.containerState.size+1)(h)}function o(h){return r.containerState.furtherBlankLines||!kn(h)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,l(h)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(tO,n,l)(h))}function l(h){return r.containerState._closeFlow=!0,r.interrupt=void 0,Rn(e,e.attempt(ja,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(h)}}function rO(e,n,t){const r=this;return Rn(e,a,"listItemIndent",r.containerState.size+1);function a(o){const l=r.events[r.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===r.containerState.size?n(o):t(o)}}function aO(e){e.exit(this.containerState.type)}function sO(e,n,t){const r=this;return Rn(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(o){const l=r.events[r.events.length-1];return!kn(o)&&l&&l[1].type==="listItemPrefixWhitespace"?n(o):t(o)}}const XN={name:"setextUnderline",resolveTo:oO,tokenize:lO};function oO(e,n){let t=e.length,r,a,o;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!o&&e[t][1].type==="definition"&&(o=t);const l={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",o?(e.splice(a,0,["enter",l,n]),e.splice(o+1,0,["exit",e[r][1],n]),e[r][1].end={...e[o][1].end}):e[r][1]=l,e.push(["exit",l,n]),e}function lO(e,n,t){const r=this;let a;return o;function o(u){let f=r.events.length,g;for(;f--;)if(r.events[f][1].type!=="lineEnding"&&r.events[f][1].type!=="linePrefix"&&r.events[f][1].type!=="content"){g=r.events[f][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=u,l(u)):t(u)}function l(u){return e.enter("setextHeadingLineSequence"),h(u)}function h(u){return u===a?(e.consume(u),h):(e.exit("setextHeadingLineSequence"),kn(u)?Rn(e,d,"lineSuffix")(u):d(u))}function d(u){return u===null||Ht(u)?(e.exit("setextHeadingLine"),n(u)):t(u)}}const cO={tokenize:uO};function uO(e){const n=this,t=e.attempt(wg,r,e.attempt(this.parser.constructs.flowInitial,a,Rn(e,e.attempt(this.parser.constructs.flow,a,e.attempt(mR,a)),"linePrefix")));return t;function r(o){if(o===null){e.consume(o);return}return e.enter("lineEndingBlank"),e.consume(o),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const dO={resolveAll:_2()},hO=j2("string"),fO=j2("text");function j2(e){return{resolveAll:_2(e==="text"?pO:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],o=t.attempt(a,l,h);return l;function l(f){return u(f)?o(f):h(f)}function h(f){if(f===null){t.consume(f);return}return t.enter("data"),t.consume(f),d}function d(f){return u(f)?(t.exit("data"),o(f)):(t.consume(f),d)}function u(f){if(f===null)return!0;const g=a[f];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function _2(e){return n;function n(t,r){let a=-1,o;for(;++a<=t.length;)o===void 0?t[a]&&t[a][1].type==="data"&&(o=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==o+2&&(t[o][1].end=t[a-1][1].end,t.splice(o+2,a-o-2),a=o+2),o=void 0);return e?e(t,r):t}}function pO(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let o=a.length,l=-1,h=0,d;for(;o--;){const u=a[o];if(typeof u=="string"){for(l=u.length;u.charCodeAt(l-1)===32;)h++,l--;if(l)break;l=-1}else if(u===-2)d=!0,h++;else if(u!==-1){o++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(h=0),h){const u={type:t===e.length||d||h<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?l:r.start._bufferIndex+l,_index:r.start._index+o,line:r.end.line,column:r.end.column-h,offset:r.end.offset-h},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(t,0,["enter",u,n],["exit",u,n]),t+=2)}t++}return e}const mO={42:ja,43:ja,45:ja,48:ja,49:ja,50:ja,51:ja,52:ja,53:ja,54:ja,55:ja,56:ja,57:ja,62:y2},gO={91:vR},yO={[-2]:i0,[-1]:i0,32:i0},xO={35:CR,42:Yx,45:[XN,Yx],60:AR,61:XN,95:Yx,96:JN,126:JN},bO={38:b2,92:x2},vO={[-5]:r0,[-4]:r0,[-3]:r0,33:WR,38:b2,42:l1,60:[J4,LR],91:JR,92:[jR,x2],93:Nw,95:l1,96:cR},wO={null:[l1,dO]},NO={null:[42,95]},SO={null:[]},jO=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:NO,contentInitial:gO,disable:SO,document:mO,flow:xO,flowInitial:yO,insideSpan:wO,string:bO,text:vO},Symbol.toStringTag,{value:"Module"}));function _O(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},o=[];let l=[],h=[];const d={attempt:F($),check:F(L),consume:P,enter:I,exit:q,interrupt:F(L,{interrupt:!0})},u={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let f=n.tokenize.call(u,d);return n.resolveAll&&o.push(n),u;function g(U){return l=Es(l,U),T(),l[l.length-1]!==null?[]:(z(n,0),u.events=Mb(o,u.events,u),u.events)}function b(U,Y){return kO(v(U),Y)}function v(U){return CO(l,U)}function S(){const{_bufferIndex:U,_index:Y,line:Z,column:ne,offset:ae}=r;return{_bufferIndex:U,_index:Y,line:Z,column:ne,offset:ae}}function k(U){a[U.line]=U.column,R()}function T(){let U;for(;r._index<l.length;){const Y=l[r._index];if(typeof Y=="string")for(U=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===U&&r._bufferIndex<Y.length;)E(Y.charCodeAt(r._bufferIndex));else E(Y)}}function E(U){f=f(U)}function P(U){Ht(U)?(r.line++,r.column=1,r.offset+=U===-3?2:1,R()):U!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===l[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=U}function I(U,Y){const Z=Y||{};return Z.type=U,Z.start=S(),u.events.push(["enter",Z,u]),h.push(Z),Z}function q(U){const Y=h.pop();return Y.end=S(),u.events.push(["exit",Y,u]),Y}function $(U,Y){z(U,Y.from)}function L(U,Y){Y.restore()}function F(U,Y){return Z;function Z(ne,ae,X){let W,H,he,D;return Array.isArray(ne)?ve(ne):"tokenize"in ne?ve([ne]):te(ne);function te(se){return ee;function ee(oe){const ue=oe!==null&&se[oe],Ee=oe!==null&&se.null,Ie=[...Array.isArray(ue)?ue:ue?[ue]:[],...Array.isArray(Ee)?Ee:Ee?[Ee]:[]];return ve(Ie)(oe)}}function ve(se){return W=se,H=0,se.length===0?X:M(se[H])}function M(se){return ee;function ee(oe){return D=B(),he=se,se.partial||(u.currentConstruct=se),se.name&&u.parser.constructs.disable.null.includes(se.name)?_e():se.tokenize.call(Y?Object.assign(Object.create(u),Y):u,d,ge,_e)(oe)}}function ge(se){return U(he,D),ae}function _e(se){return D.restore(),++H<W.length?M(W[H]):X}}}function z(U,Y){U.resolveAll&&!o.includes(U)&&o.push(U),U.resolve&&is(u.events,Y,u.events.length-Y,U.resolve(u.events.slice(Y),u)),U.resolveTo&&(u.events=U.resolveTo(u.events,u))}function B(){const U=S(),Y=u.previous,Z=u.currentConstruct,ne=u.events.length,ae=Array.from(h);return{from:ne,restore:X};function X(){r=U,u.previous=Y,u.currentConstruct=Z,u.events.length=ne,h=ae,R()}}function R(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function CO(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,o=n.end._bufferIndex;let l;if(t===a)l=[e[t].slice(r,o)];else{if(l=e.slice(t,a),r>-1){const h=l[0];typeof h=="string"?l[0]=h.slice(r):l.shift()}o>0&&l.push(e[a].slice(0,o))}return l}function kO(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const o=e[t];let l;if(typeof o=="string")l=o;else switch(o){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=n?" ":"	";break}case-1:{if(!n&&a)continue;l=" ";break}default:l=String.fromCharCode(o)}a=o===-2,r.push(l)}return r.join("")}function EO(e){const r={constructs:m2([jO,...(e||{}).extensions||[]]),content:a(q4),defined:[],document:a(H4),flow:a(cO),lazy:{},string:a(hO),text:a(fO)};return r;function a(o){return l;function l(h){return _O(r,o,h)}}}function TO(e){for(;!v2(e););return e}const ZN=/[\0\t\n\r]/g;function AO(){let e=1,n="",t=!0,r;return a;function a(o,l,h){const d=[];let u,f,g,b,v;for(o=n+(typeof o=="string"?o.toString():new TextDecoder(l||void 0).decode(o)),g=0,n="",t&&(o.charCodeAt(0)===65279&&g++,t=void 0);g<o.length;){if(ZN.lastIndex=g,u=ZN.exec(o),b=u&&u.index!==void 0?u.index:o.length,v=o.charCodeAt(b),!u){n=o.slice(g);break}if(v===10&&g===b&&r)d.push(-3),r=void 0;else switch(r&&(d.push(-5),r=void 0),g<b&&(d.push(o.slice(g,b)),e+=b-g),v){case 0:{d.push(65533),e++;break}case 9:{for(f=Math.ceil(e/4)*4,d.push(-2);e++<f;)d.push(-1);break}case 10:{d.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return h&&(r&&d.push(-5),n&&d.push(n),d.push(null)),d}}const DO=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function PO(e){return e.replace(DO,IO)}function IO(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),o=a===120||a===88;return g2(t.slice(o?2:1),o?16:10)}return ww(t)||e}const C2={}.hasOwnProperty;function MO(e,n,t){return typeof n!="string"&&(t=n,n=void 0),RO(t)(TO(EO(t).document().write(AO()(e,n,!0))))}function RO(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(qe),autolinkProtocol:B,autolinkEmail:B,atxHeading:o(Ye),blockQuote:o(Ee),characterEscape:B,characterReference:B,codeFenced:o(Ie),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:o(Ie,l),codeText:o(fe,l),codeTextData:B,data:B,codeFlowValue:B,definition:o(pe),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:o(Re),hardBreakEscape:o(ut),hardBreakTrailing:o(ut),htmlFlow:o(Ge,l),htmlFlowData:B,htmlText:o(Ge,l),htmlTextData:B,image:o(Se),label:l,link:o(qe),listItem:o(ze),listItemValue:b,listOrdered:o(Ue,g),listUnordered:o(Ue),paragraph:o(lt),reference:M,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:o(Ye),strong:o(Ke),thematicBreak:o(Te)},exit:{atxHeading:d(),atxHeadingSequence:$,autolink:d(),autolinkEmail:ue,autolinkProtocol:oe,blockQuote:d(),characterEscapeValue:R,characterReferenceMarkerHexadecimal:_e,characterReferenceMarkerNumeric:_e,characterReferenceValue:se,characterReference:ee,codeFenced:d(T),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:R,codeIndented:d(E),codeText:d(ae),codeTextData:R,data:R,definition:d(),definitionDestinationString:q,definitionLabelString:P,definitionTitleString:I,emphasis:d(),hardBreakEscape:d(Y),hardBreakTrailing:d(Y),htmlFlow:d(Z),htmlFlowData:R,htmlText:d(ne),htmlTextData:R,image:d(W),label:he,labelText:H,lineEnding:U,link:d(X),listItem:d(),listOrdered:d(),listUnordered:d(),paragraph:d(),referenceString:ge,resourceDestinationString:D,resourceTitleString:te,resource:ve,setextHeading:d(z),setextHeadingLineSequence:F,setextHeadingText:L,strong:d(),thematicBreak:d()}};k2(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(ie){let xe={type:"root",children:[]};const Qe={stack:[xe],tokenStack:[],config:n,enter:h,exit:u,buffer:l,resume:f,data:t},we=[];let Pe=-1;for(;++Pe<ie.length;)if(ie[Pe][1].type==="listOrdered"||ie[Pe][1].type==="listUnordered")if(ie[Pe][0]==="enter")we.push(Pe);else{const Je=we.pop();Pe=a(ie,Je,Pe)}for(Pe=-1;++Pe<ie.length;){const Je=n[ie[Pe][0]];C2.call(Je,ie[Pe][1].type)&&Je[ie[Pe][1].type].call(Object.assign({sliceSerialize:ie[Pe][2].sliceSerialize},Qe),ie[Pe][1])}if(Qe.tokenStack.length>0){const Je=Qe.tokenStack[Qe.tokenStack.length-1];(Je[1]||eS).call(Qe,void 0,Je[0])}for(xe.position={start:lu(ie.length>0?ie[0][1].start:{line:1,column:1,offset:0}),end:lu(ie.length>0?ie[ie.length-2][1].end:{line:1,column:1,offset:0})},Pe=-1;++Pe<n.transforms.length;)xe=n.transforms[Pe](xe)||xe;return xe}function a(ie,xe,Qe){let we=xe-1,Pe=-1,Je=!1,at,ft,Ae,Ve;for(;++we<=Qe;){const $e=ie[we];switch($e[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{$e[0]==="enter"?Pe++:Pe--,Ve=void 0;break}case"lineEndingBlank":{$e[0]==="enter"&&(at&&!Ve&&!Pe&&!Ae&&(Ae=we),Ve=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Ve=void 0}if(!Pe&&$e[0]==="enter"&&$e[1].type==="listItemPrefix"||Pe===-1&&$e[0]==="exit"&&($e[1].type==="listUnordered"||$e[1].type==="listOrdered")){if(at){let We=we;for(ft=void 0;We--;){const ct=ie[We];if(ct[1].type==="lineEnding"||ct[1].type==="lineEndingBlank"){if(ct[0]==="exit")continue;ft&&(ie[ft][1].type="lineEndingBlank",Je=!0),ct[1].type="lineEnding",ft=We}else if(!(ct[1].type==="linePrefix"||ct[1].type==="blockQuotePrefix"||ct[1].type==="blockQuotePrefixWhitespace"||ct[1].type==="blockQuoteMarker"||ct[1].type==="listItemIndent"))break}Ae&&(!ft||Ae<ft)&&(at._spread=!0),at.end=Object.assign({},ft?ie[ft][1].start:$e[1].end),ie.splice(ft||we,0,["exit",at,$e[2]]),we++,Qe++}if($e[1].type==="listItemPrefix"){const We={type:"listItem",_spread:!1,start:Object.assign({},$e[1].start),end:void 0};at=We,ie.splice(we,0,["enter",We,$e[2]]),we++,Qe++,Ae=void 0,Ve=!0}}}return ie[xe][1]._spread=Je,Qe}function o(ie,xe){return Qe;function Qe(we){h.call(this,ie(we),we),xe&&xe.call(this,we)}}function l(){this.stack.push({type:"fragment",children:[]})}function h(ie,xe,Qe){this.stack[this.stack.length-1].children.push(ie),this.stack.push(ie),this.tokenStack.push([xe,Qe||void 0]),ie.position={start:lu(xe.start),end:void 0}}function d(ie){return xe;function xe(Qe){ie&&ie.call(this,Qe),u.call(this,Qe)}}function u(ie,xe){const Qe=this.stack.pop(),we=this.tokenStack.pop();if(we)we[0].type!==ie.type&&(xe?xe.call(this,ie,we[0]):(we[1]||eS).call(this,ie,we[0]));else throw new Error("Cannot close `"+ie.type+"` ("+Zm({start:ie.start,end:ie.end})+"): its not open");Qe.position.end=lu(ie.end)}function f(){return vw(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(ie){if(this.data.expectingFirstListItemValue){const xe=this.stack[this.stack.length-2];xe.start=Number.parseInt(this.sliceSerialize(ie),10),this.data.expectingFirstListItemValue=void 0}}function v(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.lang=ie}function S(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.meta=ie}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.value=ie.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function E(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.value=ie.replace(/(\r?\n|\r)$/g,"")}function P(ie){const xe=this.resume(),Qe=this.stack[this.stack.length-1];Qe.label=xe,Qe.identifier=po(this.sliceSerialize(ie)).toLowerCase()}function I(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.title=ie}function q(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.url=ie}function $(ie){const xe=this.stack[this.stack.length-1];if(!xe.depth){const Qe=this.sliceSerialize(ie).length;xe.depth=Qe}}function L(){this.data.setextHeadingSlurpLineEnding=!0}function F(ie){const xe=this.stack[this.stack.length-1];xe.depth=this.sliceSerialize(ie).codePointAt(0)===61?1:2}function z(){this.data.setextHeadingSlurpLineEnding=void 0}function B(ie){const Qe=this.stack[this.stack.length-1].children;let we=Qe[Qe.length-1];(!we||we.type!=="text")&&(we=pt(),we.position={start:lu(ie.start),end:void 0},Qe.push(we)),this.stack.push(we)}function R(ie){const xe=this.stack.pop();xe.value+=this.sliceSerialize(ie),xe.position.end=lu(ie.end)}function U(ie){const xe=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Qe=xe.children[xe.children.length-1];Qe.position.end=lu(ie.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(xe.type)&&(B.call(this,ie),R.call(this,ie))}function Y(){this.data.atHardBreak=!0}function Z(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.value=ie}function ne(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.value=ie}function ae(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.value=ie}function X(){const ie=this.stack[this.stack.length-1];if(this.data.inReference){const xe=this.data.referenceType||"shortcut";ie.type+="Reference",ie.referenceType=xe,delete ie.url,delete ie.title}else delete ie.identifier,delete ie.label;this.data.referenceType=void 0}function W(){const ie=this.stack[this.stack.length-1];if(this.data.inReference){const xe=this.data.referenceType||"shortcut";ie.type+="Reference",ie.referenceType=xe,delete ie.url,delete ie.title}else delete ie.identifier,delete ie.label;this.data.referenceType=void 0}function H(ie){const xe=this.sliceSerialize(ie),Qe=this.stack[this.stack.length-2];Qe.label=PO(xe),Qe.identifier=po(xe).toLowerCase()}function he(){const ie=this.stack[this.stack.length-1],xe=this.resume(),Qe=this.stack[this.stack.length-1];if(this.data.inReference=!0,Qe.type==="link"){const we=ie.children;Qe.children=we}else Qe.alt=xe}function D(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.url=ie}function te(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.title=ie}function ve(){this.data.inReference=void 0}function M(){this.data.referenceType="collapsed"}function ge(ie){const xe=this.resume(),Qe=this.stack[this.stack.length-1];Qe.label=xe,Qe.identifier=po(this.sliceSerialize(ie)).toLowerCase(),this.data.referenceType="full"}function _e(ie){this.data.characterReferenceType=ie.type}function se(ie){const xe=this.sliceSerialize(ie),Qe=this.data.characterReferenceType;let we;Qe?(we=g2(xe,Qe==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):we=ww(xe);const Pe=this.stack[this.stack.length-1];Pe.value+=we}function ee(ie){const xe=this.stack.pop();xe.position.end=lu(ie.end)}function oe(ie){R.call(this,ie);const xe=this.stack[this.stack.length-1];xe.url=this.sliceSerialize(ie)}function ue(ie){R.call(this,ie);const xe=this.stack[this.stack.length-1];xe.url="mailto:"+this.sliceSerialize(ie)}function Ee(){return{type:"blockquote",children:[]}}function Ie(){return{type:"code",lang:null,meta:null,value:""}}function fe(){return{type:"inlineCode",value:""}}function pe(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Re(){return{type:"emphasis",children:[]}}function Ye(){return{type:"heading",depth:0,children:[]}}function ut(){return{type:"break"}}function Ge(){return{type:"html",value:""}}function Se(){return{type:"image",title:null,url:"",alt:null}}function qe(){return{type:"link",title:null,url:"",children:[]}}function Ue(ie){return{type:"list",ordered:ie.type==="listOrdered",start:null,spread:ie._spread,children:[]}}function ze(ie){return{type:"listItem",spread:ie._spread,checked:null,children:[]}}function lt(){return{type:"paragraph",children:[]}}function Ke(){return{type:"strong",children:[]}}function pt(){return{type:"text",value:""}}function Te(){return{type:"thematicBreak"}}}function lu(e){return{line:e.line,column:e.column,offset:e.offset}}function k2(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?k2(e,r):OO(e,r)}}function OO(e,n){let t;for(t in n)if(C2.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function eS(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+Zm({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+Zm({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+Zm({start:n.start,end:n.end})+") is still open")}function LO(e){const n=this;n.parser=t;function t(r){return MO(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}function FO(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function $O(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function zO(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function BO(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function UO(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function qO(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=ep(r.toLowerCase()),o=e.footnoteOrder.indexOf(r);let l,h=e.footnoteCounts.get(r);h===void 0?(h=0,e.footnoteOrder.push(r),l=e.footnoteOrder.length):l=o+1,h+=1,e.footnoteCounts.set(r,h);const d={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(h>1?"-"+h:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(n,d);const u={type:"element",tagName:"sup",properties:{},children:[d]};return e.patch(n,u),e.applyData(n,u)}function VO(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function HO(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function E2(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),o=a[0];o&&o.type==="text"?o.value="["+o.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=r:a.push({type:"text",value:r}),a}function GO(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return E2(e,n);const a={src:ep(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,o),e.applyData(n,o)}function YO(e,n){const t={src:ep(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function WO(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function QO(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return E2(e,n);const a={href:ep(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,o),e.applyData(n,o)}function JO(e,n){const t={href:ep(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function KO(e,n,t){const r=e.all(n),a=t?XO(t):T2(n),o={},l=[];if(typeof n.checked=="boolean"){const f=r[0];let g;f&&f.type==="element"&&f.tagName==="p"?g=f:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let h=-1;for(;++h<r.length;){const f=r[h];(a||h!==0||f.type!=="element"||f.tagName!=="p")&&l.push({type:"text",value:`
`}),f.type==="element"&&f.tagName==="p"&&!a?l.push(...f.children):l.push(f)}const d=r[r.length-1];d&&(a||d.type!=="element"||d.tagName!=="p")&&l.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:o,children:l};return e.patch(n,u),e.applyData(n,u)}function XO(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=T2(t[r])}return n}function T2(e){const n=e.spread;return n??e.children.length>1}function ZO(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const l=r[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const o={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,o),e.applyData(n,o)}function eL(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function tL(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function nL(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function iL(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],l),a.push(l)}if(t.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},h=gw(n.children[1]),d=l2(n.children[n.children.length-1]);h&&d&&(l.position={start:h,end:d}),a.push(l)}const o={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,o),e.applyData(n,o)}function rL(e,n,t){const r=t?t.children:void 0,o=(r?r.indexOf(n):1)===0?"th":"td",l=t&&t.type==="table"?t.align:void 0,h=l?l.length:n.children.length;let d=-1;const u=[];for(;++d<h;){const g=n.children[d],b={},v=l?l[d]:void 0;v&&(b.align=v);let S={type:"element",tagName:o,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),u.push(S)}const f={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(n,f),e.applyData(n,f)}function aL(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const tS=9,nS=32;function sL(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const o=[];for(;r;)o.push(iS(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return o.push(iS(n.slice(a),a>0,!1)),o.join("")}function iS(e,n,t){let r=0,a=e.length;if(n){let o=e.codePointAt(r);for(;o===tS||o===nS;)r++,o=e.codePointAt(r)}if(t){let o=e.codePointAt(a-1);for(;o===tS||o===nS;)a--,o=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function oL(e,n){const t={type:"text",value:sL(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function lL(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const cL={blockquote:FO,break:$O,code:zO,delete:BO,emphasis:UO,footnoteReference:qO,heading:VO,html:HO,imageReference:GO,image:YO,inlineCode:WO,linkReference:QO,link:JO,listItem:KO,list:ZO,paragraph:eL,root:tL,strong:nL,table:iL,tableCell:aL,tableRow:rL,text:oL,thematicBreak:lL,toml:Sx,yaml:Sx,definition:Sx,footnoteDefinition:Sx};function Sx(){}const A2=-1,Rb=0,tg=1,lb=2,Sw=3,jw=4,_w=5,Cw=6,D2=7,P2=8,rS=typeof self=="object"?self:globalThis,uL=(e,n)=>{const t=(a,o)=>(e.set(o,a),a),r=a=>{if(e.has(a))return e.get(a);const[o,l]=n[a];switch(o){case Rb:case A2:return t(l,a);case tg:{const h=t([],a);for(const d of l)h.push(r(d));return h}case lb:{const h=t({},a);for(const[d,u]of l)h[r(d)]=r(u);return h}case Sw:return t(new Date(l),a);case jw:{const{source:h,flags:d}=l;return t(new RegExp(h,d),a)}case _w:{const h=t(new Map,a);for(const[d,u]of l)h.set(r(d),r(u));return h}case Cw:{const h=t(new Set,a);for(const d of l)h.add(r(d));return h}case D2:{const{name:h,message:d}=l;return t(new rS[h](d),a)}case P2:return t(BigInt(l),a);case"BigInt":return t(Object(BigInt(l)),a);case"ArrayBuffer":return t(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:h}=new Uint8Array(l);return t(new DataView(h),l)}}return t(new rS[o](l),a)};return r},aS=e=>uL(new Map,e)(0),vf="",{toString:dL}={},{keys:hL}=Object,zm=e=>{const n=typeof e;if(n!=="object"||!e)return[Rb,n];const t=dL.call(e).slice(8,-1);switch(t){case"Array":return[tg,vf];case"Object":return[lb,vf];case"Date":return[Sw,vf];case"RegExp":return[jw,vf];case"Map":return[_w,vf];case"Set":return[Cw,vf];case"DataView":return[tg,t]}return t.includes("Array")?[tg,t]:t.includes("Error")?[D2,t]:[lb,t]},jx=([e,n])=>e===Rb&&(n==="function"||n==="symbol"),fL=(e,n,t,r)=>{const a=(l,h)=>{const d=r.push(l)-1;return t.set(h,d),d},o=l=>{if(t.has(l))return t.get(l);let[h,d]=zm(l);switch(h){case Rb:{let f=l;switch(d){case"bigint":h=P2,f=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+d);f=null;break;case"undefined":return a([A2],l)}return a([h,f],l)}case tg:{if(d){let b=l;return d==="DataView"?b=new Uint8Array(l.buffer):d==="ArrayBuffer"&&(b=new Uint8Array(l)),a([d,[...b]],l)}const f=[],g=a([h,f],l);for(const b of l)f.push(o(b));return g}case lb:{if(d)switch(d){case"BigInt":return a([d,l.toString()],l);case"Boolean":case"Number":case"String":return a([d,l.valueOf()],l)}if(n&&"toJSON"in l)return o(l.toJSON());const f=[],g=a([h,f],l);for(const b of hL(l))(e||!jx(zm(l[b])))&&f.push([o(b),o(l[b])]);return g}case Sw:return a([h,l.toISOString()],l);case jw:{const{source:f,flags:g}=l;return a([h,{source:f,flags:g}],l)}case _w:{const f=[],g=a([h,f],l);for(const[b,v]of l)(e||!(jx(zm(b))||jx(zm(v))))&&f.push([o(b),o(v)]);return g}case Cw:{const f=[],g=a([h,f],l);for(const b of l)(e||!jx(zm(b)))&&f.push(o(b));return g}}const{message:u}=l;return a([h,{name:d,message:u}],l)};return o},sS=(e,{json:n,lossy:t}={})=>{const r=[];return fL(!(n||t),!!n,new Map,r)(e),r},cb=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?aS(sS(e,n)):structuredClone(e):(e,n)=>aS(sS(e,n));function pL(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function mL(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function gL(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||pL,r=e.options.footnoteBackLabel||mL,a=e.options.footnoteLabel||"Footnotes",o=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},h=[];let d=-1;for(;++d<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[d]);if(!u)continue;const f=e.all(u),g=String(u.identifier).toUpperCase(),b=ep(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let P=typeof t=="string"?t:t(d,v);typeof P=="string"&&(P={type:"text",value:P}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(d,v),className:["data-footnote-backref"]},children:Array.isArray(P)?P:[P]})}const T=f[f.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const P=T.children[T.children.length-1];P&&P.type==="text"?P.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...S)}else f.push(...S);const E={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(f,!0)};e.patch(u,E),h.push(E)}if(h.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...cb(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(h,!0)},{type:"text",value:`
`}]}}const Ob=function(e){if(e==null)return vL;if(typeof e=="function")return Lb(e);if(typeof e=="object")return Array.isArray(e)?yL(e):xL(e);if(typeof e=="string")return bL(e);throw new Error("Expected function, string, or object as test")};function yL(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=Ob(e[t]);return Lb(r);function r(...a){let o=-1;for(;++o<n.length;)if(n[o].apply(this,a))return!0;return!1}}function xL(e){const n=e;return Lb(t);function t(r){const a=r;let o;for(o in e)if(a[o]!==n[o])return!1;return!0}}function bL(e){return Lb(n);function n(t){return t&&t.type===e}}function Lb(e){return n;function n(t,r,a){return!!(wL(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function vL(){return!0}function wL(e){return e!==null&&typeof e=="object"&&"type"in e}const I2=[],NL=!0,c1=!1,SL="skip";function M2(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const o=Ob(a),l=r?-1:1;h(e,void 0,[])();function h(d,u,f){const g=d&&typeof d=="object"?d:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(d.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=I2,S,k,T;if((!n||o(d,u,f[f.length-1]||void 0))&&(v=jL(t(d,f)),v[0]===c1))return v;if("children"in d&&d.children){const E=d;if(E.children&&v[0]!==SL)for(k=(r?E.children.length:-1)+l,T=f.concat(E);k>-1&&k<E.children.length;){const P=E.children[k];if(S=h(P,k,T)(),S[0]===c1)return S;k=typeof S[1]=="number"?S[1]:k+l}}return v}}}function jL(e){return Array.isArray(e)?e:typeof e=="number"?[NL,e]:e==null?I2:[e]}function kw(e,n,t,r){let a,o,l;typeof n=="function"?(o=void 0,l=n,a=t):(o=n,l=t,a=r),M2(e,o,h,a);function h(d,u){const f=u[u.length-1],g=f?f.children.indexOf(d):void 0;return l(d,g,f)}}const u1={}.hasOwnProperty,_L={};function CL(e,n){const t=n||_L,r=new Map,a=new Map,o=new Map,l={...cL,...t.handlers},h={all:u,applyData:EL,definitionById:r,footnoteById:a,footnoteCounts:o,footnoteOrder:[],handlers:l,one:d,options:t,patch:kL,wrap:AL};return kw(e,function(f){if(f.type==="definition"||f.type==="footnoteDefinition"){const g=f.type==="definition"?r:a,b=String(f.identifier).toUpperCase();g.has(b)||g.set(b,f)}}),h;function d(f,g){const b=f.type,v=h.handlers[b];if(u1.call(h.handlers,b)&&v)return v(h,f,g);if(h.options.passThrough&&h.options.passThrough.includes(b)){if("children"in f){const{children:k,...T}=f,E=cb(T);return E.children=h.all(f),E}return cb(f)}return(h.options.unknownHandler||TL)(h,f,g)}function u(f){const g=[];if("children"in f){const b=f.children;let v=-1;for(;++v<b.length;){const S=h.one(b[v],f);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=oS(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=oS(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function kL(e,n){e.position&&(n.position=m4(e))}function EL(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,o=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const l="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:l}}t.type==="element"&&o&&Object.assign(t.properties,cb(o)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function TL(e,n){const t=n.data||{},r="value"in n&&!(u1.call(t,"hProperties")||u1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function AL(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function oS(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function lS(e,n){const t=CL(e,n),r=t.one(e,void 0),a=gL(t),o=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&o.children.push({type:"text",value:`
`},a),o}function DL(e,n){return e&&"run"in e?async function(t,r){const a=lS(t,{file:r,...n});await e.run(a,r)}:function(t,r){return lS(t,{file:r,...e||n})}}function cS(e){if(e)throw e}var a0,uS;function PL(){if(uS)return a0;uS=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(u){return typeof Array.isArray=="function"?Array.isArray(u):n.call(u)==="[object Array]"},o=function(u){if(!u||n.call(u)!=="[object Object]")return!1;var f=e.call(u,"constructor"),g=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!f&&!g)return!1;var b;for(b in u);return typeof b>"u"||e.call(u,b)},l=function(u,f){t&&f.name==="__proto__"?t(u,f.name,{enumerable:!0,configurable:!0,value:f.newValue,writable:!0}):u[f.name]=f.newValue},h=function(u,f){if(f==="__proto__")if(e.call(u,f)){if(r)return r(u,f).value}else return;return u[f]};return a0=function d(){var u,f,g,b,v,S,k=arguments[0],T=1,E=arguments.length,P=!1;for(typeof k=="boolean"&&(P=k,k=arguments[1]||{},T=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});T<E;++T)if(u=arguments[T],u!=null)for(f in u)g=h(k,f),b=h(u,f),k!==b&&(P&&b&&(o(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&o(g)?g:{},l(k,{name:f,newValue:d(P,S,b)})):typeof b<"u"&&l(k,{name:f,newValue:b}));return k},a0}var IL=PL();const s0=qd(IL);function d1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function ML(){const e=[],n={run:t,use:r};return n;function t(...a){let o=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);h(null,...a);function h(d,...u){const f=e[++o];let g=-1;if(d){l(d);return}for(;++g<a.length;)(u[g]===null||u[g]===void 0)&&(u[g]=a[g]);a=u,f?RL(f,h)(...u):l(null,...u)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function RL(e,n){let t;return r;function r(...l){const h=e.length>l.length;let d;h&&l.push(a);try{d=e.apply(this,l)}catch(u){const f=u;if(h&&t)throw f;return a(f)}h||(d&&d.then&&typeof d.then=="function"?d.then(o,a):d instanceof Error?a(d):o(d))}function a(l,...h){t||(t=!0,n(l,...h))}function o(l){a(null,l)}}const al={basename:OL,dirname:LL,extname:FL,join:$L,sep:"/"};function OL(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');Ng(e);let t=0,r=-1,a=e.length,o;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else r<0&&(o=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let l=-1,h=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else l<0&&(o=!0,l=a+1),h>-1&&(e.codePointAt(a)===n.codePointAt(h--)?h<0&&(r=a):(h=-1,r=l));return t===r?r=l:r<0&&(r=e.length),e.slice(t,r)}function LL(e){if(Ng(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function FL(e){Ng(e);let n=e.length,t=-1,r=0,a=-1,o=0,l;for(;n--;){const h=e.codePointAt(n);if(h===47){if(l){r=n+1;break}continue}t<0&&(l=!0,t=n+1),h===46?a<0?a=n:o!==1&&(o=1):a>-1&&(o=-1)}return a<0||t<0||o===0||o===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function $L(...e){let n=-1,t;for(;++n<e.length;)Ng(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":zL(t)}function zL(e){Ng(e);const n=e.codePointAt(0)===47;let t=BL(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function BL(e,n){let t="",r=0,a=-1,o=0,l=-1,h,d;for(;++l<=e.length;){if(l<e.length)h=e.codePointAt(l);else{if(h===47)break;h=47}if(h===47){if(!(a===l-1||o===1))if(a!==l-1&&o===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(d=t.lastIndexOf("/"),d!==t.length-1){d<0?(t="",r=0):(t=t.slice(0,d),r=t.length-1-t.lastIndexOf("/")),a=l,o=0;continue}}else if(t.length>0){t="",r=0,a=l,o=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,l):t=e.slice(a+1,l),r=l-a-1;a=l,o=0}else h===46&&o>-1?o++:o=-1}return t}function Ng(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const UL={cwd:qL};function qL(){return"/"}function h1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function VL(e){if(typeof e=="string")e=new URL(e);else if(!h1(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return HL(e)}function HL(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const o0=["history","path","basename","stem","extname","dirname"];let R2=class{constructor(n){let t;n?h1(n)?t={path:n}:typeof n=="string"||GL(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":UL.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<o0.length;){const o=o0[r];o in t&&t[o]!==void 0&&t[o]!==null&&(this[o]=o==="history"?[...t[o]]:t[o])}let a;for(a in t)o0.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?al.basename(this.path):void 0}set basename(n){c0(n,"basename"),l0(n,"basename"),this.path=al.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?al.dirname(this.path):void 0}set dirname(n){dS(this.basename,"dirname"),this.path=al.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?al.extname(this.path):void 0}set extname(n){if(l0(n,"extname"),dS(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=al.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){h1(n)&&(n=VL(n)),c0(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?al.basename(this.path,this.extname):void 0}set stem(n){c0(n,"stem"),l0(n,"stem"),this.path=al.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new Wr(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}};function l0(e,n){if(e&&e.includes(al.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+al.sep+"`")}function c0(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function dS(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function GL(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const YL=function(e){const r=this.constructor.prototype,a=r[e],o=function(){return a.apply(o,arguments)};return Object.setPrototypeOf(o,r),o},WL={}.hasOwnProperty;let QL=class O2 extends YL{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=ML()}copy(){const n=new O2;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data(s0(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(h0("data",this.frozen),this.namespace[n]=t,this):WL.call(this.namespace,n)&&this.namespace[n]||void 0:n?(h0("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=_x(n),r=this.parser||this.Parser;return u0("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),u0("process",this.parser||this.Parser),d0("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(o,l){const h=_x(n),d=r.parse(h);r.run(d,h,function(f,g,b){if(f||!g||!b)return u(f);const v=g,S=r.stringify(v,b);XL(S)?b.value=S:b.result=S,u(f,b)});function u(f,g){f||!g?l(f):o?o(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),u0("processSync",this.parser||this.Parser),d0("processSync",this.compiler||this.Compiler),this.process(n,a),fS("processSync","process",t),r;function a(o,l){t=!0,cS(o),r=l}}run(n,t,r){hS(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?o(void 0,r):new Promise(o);function o(l,h){const d=_x(t);a.run(n,d,u);function u(f,g,b){const v=g||n;f?h(f):l?l(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,o),fS("runSync","run",r),a;function o(l,h){cS(l),a=h,r=!0}}stringify(n,t){this.freeze();const r=_x(t),a=this.compiler||this.Compiler;return d0("stringify",a),hS(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(h0("use",this.frozen),n!=null)if(typeof n=="function")d(n,t);else if(typeof n=="object")Array.isArray(n)?h(n):l(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function o(u){if(typeof u=="function")d(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[f,...g]=u;d(f,g)}else l(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function l(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");h(u.plugins),u.settings&&(a.settings=s0(!0,a.settings,u.settings))}function h(u){let f=-1;if(u!=null)if(Array.isArray(u))for(;++f<u.length;){const g=u[f];o(g)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function d(u,f){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===u){b=g;break}if(b===-1)r.push([u,...f]);else if(f.length>0){let[v,...S]=f;const k=r[b][1];d1(k)&&d1(v)&&(v=s0(!0,k,v)),r[b]=[u,v,...S]}}}};const JL=new QL().freeze();function u0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function d0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function h0(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function hS(e){if(!d1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function fS(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function _x(e){return KL(e)?e:new R2(e)}function KL(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function XL(e){return typeof e=="string"||ZL(e)}function ZL(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const e3="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",pS=[],mS={allowDangerousHtml:!0},t3=/^(https?|ircs?|mailto|xmpp)$/i,n3=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function uo(e){const n=i3(e),t=r3(e);return a3(n.runSync(n.parse(t),t),e)}function i3(e){const n=e.rehypePlugins||pS,t=e.remarkPlugins||pS,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...mS}:mS;return JL().use(LO).use(t).use(DL,r).use(n)}function r3(e){const n=e.children||"",t=new R2;return typeof n=="string"&&(t.value=n),t}function a3(e,n){const t=n.allowedElements,r=n.allowElement,a=n.components,o=n.disallowedElements,l=n.skipHtml,h=n.unwrapDisallowed,d=n.urlTransform||s3;for(const f of n3)Object.hasOwn(n,f.from)&&(""+f.from+(f.to?"use `"+f.to+"` instead":"remove it")+e3+f.id,void 0);return kw(e,u),v4(e,{Fragment:i.Fragment,components:a,ignoreInvalidStyle:!0,jsx:i.jsx,jsxs:i.jsxs,passKeys:!0,passNode:!0});function u(f,g,b){if(f.type==="raw"&&b&&typeof g=="number")return l?b.children.splice(g,1):b.children[g]={type:"text",value:f.value},g;if(f.type==="element"){let v;for(v in n0)if(Object.hasOwn(n0,v)&&Object.hasOwn(f.properties,v)){const S=f.properties[v],k=n0[v];(k===null||k.includes(f.tagName))&&(f.properties[v]=d(String(S||""),v,f))}}if(f.type==="element"){let v=t?!t.includes(f.tagName):o?o.includes(f.tagName):!1;if(!v&&r&&typeof g=="number"&&(v=!r(f,g,b)),v&&b&&typeof g=="number")return h&&f.children?b.children.splice(g,1,...f.children):b.children.splice(g,1),g}}}function s3(e){const n=e.indexOf(":"),t=e.indexOf("?"),r=e.indexOf("#"),a=e.indexOf("/");return n===-1||a!==-1&&n>a||t!==-1&&n>t||r!==-1&&n>r||t3.test(e.slice(0,n))?e:""}function gS(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function o3(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function l3(e,n,t){const a=Ob((t||{}).ignore||[]),o=c3(n);let l=-1;for(;++l<o.length;)M2(e,"text",h);function h(u,f){let g=-1,b;for(;++g<f.length;){const v=f[g],S=b?b.children:void 0;if(a(v,S?S.indexOf(v):void 0,b))return;b=v}if(b)return d(u,f)}function d(u,f){const g=f[f.length-1],b=o[l][0],v=o[l][1];let S=0;const T=g.children.indexOf(u);let E=!1,P=[];b.lastIndex=0;let I=b.exec(u.value);for(;I;){const q=I.index,$={index:I.index,input:I.input,stack:[...f,u]};let L=v(...I,$);if(typeof L=="string"&&(L=L.length>0?{type:"text",value:L}:void 0),L===!1?b.lastIndex=q+1:(S!==q&&P.push({type:"text",value:u.value.slice(S,q)}),Array.isArray(L)?P.push(...L):L&&P.push(L),S=q+I[0].length,E=!0),!b.global)break;I=b.exec(u.value)}return E?(S<u.value.length&&P.push({type:"text",value:u.value.slice(S)}),g.children.splice(T,1,...P)):P=[u],T+P.length}}function c3(e){const n=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const t=!e[0]||Array.isArray(e[0])?e:[e];let r=-1;for(;++r<t.length;){const a=t[r];n.push([u3(a[0]),d3(a[1])])}return n}function u3(e){return typeof e=="string"?new RegExp(o3(e),"g"):e}function d3(e){return typeof e=="function"?e:function(){return e}}const f0="phrasing",p0=["autolink","link","image","label"];function h3(){return{transforms:[b3],enter:{literalAutolink:p3,literalAutolinkEmail:m0,literalAutolinkHttp:m0,literalAutolinkWww:m0},exit:{literalAutolink:x3,literalAutolinkEmail:y3,literalAutolinkHttp:m3,literalAutolinkWww:g3}}}function f3(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:f0,notInConstruct:p0},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:f0,notInConstruct:p0},{character:":",before:"[ps]",after:"\\/",inConstruct:f0,notInConstruct:p0}]}}function p3(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function m0(e){this.config.enter.autolinkProtocol.call(this,e)}function m3(e){this.config.exit.autolinkProtocol.call(this,e)}function g3(e){this.config.exit.data.call(this,e);const n=this.stack[this.stack.length-1];n.type,n.url="http://"+this.sliceSerialize(e)}function y3(e){this.config.exit.autolinkEmail.call(this,e)}function x3(e){this.exit(e)}function b3(e){l3(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,v3],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),w3]],{ignore:["link","linkReference"]})}function v3(e,n,t,r,a){let o="";if(!L2(a)||(/^w/i.test(n)&&(t=n+t,n="",o="http://"),!N3(t)))return!1;const l=S3(t+r);if(!l[0])return!1;const h={type:"link",title:null,url:o+n+l[0],children:[{type:"text",value:n+l[0]}]};return l[1]?[h,{type:"text",value:l[1]}]:h}function w3(e,n,t,r){return!L2(r,!0)||/[-\d_]$/.test(t)?!1:{type:"link",title:null,url:"mailto:"+n+"@"+t,children:[{type:"text",value:n+"@"+t}]}}function N3(e){const n=e.split(".");return!(n.length<2||n[n.length-1]&&(/_/.test(n[n.length-1])||!/[a-zA-Z\d]/.test(n[n.length-1]))||n[n.length-2]&&(/_/.test(n[n.length-2])||!/[a-zA-Z\d]/.test(n[n.length-2])))}function S3(e){const n=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!n)return[e,void 0];e=e.slice(0,n.index);let t=n[0],r=t.indexOf(")");const a=gS(e,"(");let o=gS(e,")");for(;r!==-1&&a>o;)e+=t.slice(0,r+1),t=t.slice(r+1),r=t.indexOf(")"),o++;return[e,t]}function L2(e,n){const t=e.input.charCodeAt(e.index-1);return(e.index===0||zd(t)||Ib(t))&&(!n||t!==47)}F2.peek=P3;function j3(){this.buffer()}function _3(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function C3(){this.buffer()}function k3(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function E3(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=po(this.sliceSerialize(e)).toLowerCase(),t.label=n}function T3(e){this.exit(e)}function A3(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=po(this.sliceSerialize(e)).toLowerCase(),t.label=n}function D3(e){this.exit(e)}function P3(){return"["}function F2(e,n,t,r){const a=t.createTracker(r);let o=a.move("[^");const l=t.enter("footnoteReference"),h=t.enter("reference");return o+=a.move(t.safe(t.associationId(e),{after:"]",before:o})),h(),l(),o+=a.move("]"),o}function I3(){return{enter:{gfmFootnoteCallString:j3,gfmFootnoteCall:_3,gfmFootnoteDefinitionLabelString:C3,gfmFootnoteDefinition:k3},exit:{gfmFootnoteCallString:E3,gfmFootnoteCall:T3,gfmFootnoteDefinitionLabelString:A3,gfmFootnoteDefinition:D3}}}function M3(e){let n=!1;return e&&e.firstLineBlank&&(n=!0),{handlers:{footnoteDefinition:t,footnoteReference:F2},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function t(r,a,o,l){const h=o.createTracker(l);let d=h.move("[^");const u=o.enter("footnoteDefinition"),f=o.enter("label");return d+=h.move(o.safe(o.associationId(r),{before:d,after:"]"})),f(),d+=h.move("]:"),r.children&&r.children.length>0&&(h.shift(4),d+=h.move((n?`
`:" ")+o.indentLines(o.containerFlow(r,h.current()),n?$2:R3))),u(),d}}function R3(e,n,t){return n===0?e:$2(e,n,t)}function $2(e,n,t){return(t?"":"    ")+e}const O3=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];z2.peek=B3;function L3(){return{canContainEols:["delete"],enter:{strikethrough:$3},exit:{strikethrough:z3}}}function F3(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:O3}],handlers:{delete:z2}}}function $3(e){this.enter({type:"delete",children:[]},e)}function z3(e){this.exit(e)}function z2(e,n,t,r){const a=t.createTracker(r),o=t.enter("strikethrough");let l=a.move("~~");return l+=t.containerPhrasing(e,{...a.current(),before:l,after:"~"}),l+=a.move("~~"),o(),l}function B3(){return"~"}function U3(e){return e.length}function q3(e,n){const t=n||{},r=(t.align||[]).concat(),a=t.stringLength||U3,o=[],l=[],h=[],d=[];let u=0,f=-1;for(;++f<e.length;){const k=[],T=[];let E=-1;for(e[f].length>u&&(u=e[f].length);++E<e[f].length;){const P=V3(e[f][E]);if(t.alignDelimiters!==!1){const I=a(P);T[E]=I,(d[E]===void 0||I>d[E])&&(d[E]=I)}k.push(P)}l[f]=k,h[f]=T}let g=-1;if(typeof r=="object"&&"length"in r)for(;++g<u;)o[g]=yS(r[g]);else{const k=yS(r);for(;++g<u;)o[g]=k}g=-1;const b=[],v=[];for(;++g<u;){const k=o[g];let T="",E="";k===99?(T=":",E=":"):k===108?T=":":k===114&&(E=":");let P=t.alignDelimiters===!1?1:Math.max(1,d[g]-T.length-E.length);const I=T+"-".repeat(P)+E;t.alignDelimiters!==!1&&(P=T.length+P+E.length,P>d[g]&&(d[g]=P),v[g]=P),b[g]=I}l.splice(1,0,b),h.splice(1,0,v),f=-1;const S=[];for(;++f<l.length;){const k=l[f],T=h[f];g=-1;const E=[];for(;++g<u;){const P=k[g]||"";let I="",q="";if(t.alignDelimiters!==!1){const $=d[g]-(T[g]||0),L=o[g];L===114?I=" ".repeat($):L===99?$%2?(I=" ".repeat($/2+.5),q=" ".repeat($/2-.5)):(I=" ".repeat($/2),q=I):q=" ".repeat($)}t.delimiterStart!==!1&&!g&&E.push("|"),t.padding!==!1&&!(t.alignDelimiters===!1&&P==="")&&(t.delimiterStart!==!1||g)&&E.push(" "),t.alignDelimiters!==!1&&E.push(I),E.push(P),t.alignDelimiters!==!1&&E.push(q),t.padding!==!1&&E.push(" "),(t.delimiterEnd!==!1||g!==u-1)&&E.push("|")}S.push(t.delimiterEnd===!1?E.join("").replace(/ +$/,""):E.join(""))}return S.join(`
`)}function V3(e){return e==null?"":String(e)}function yS(e){const n=typeof e=="string"?e.codePointAt(0):0;return n===67||n===99?99:n===76||n===108?108:n===82||n===114?114:0}function H3(e,n,t,r){const a=t.enter("blockquote"),o=t.createTracker(r);o.move("> "),o.shift(2);const l=t.indentLines(t.containerFlow(e,o.current()),G3);return a(),l}function G3(e,n,t){return">"+(t?"":" ")+e}function Y3(e,n){return xS(e,n.inConstruct,!0)&&!xS(e,n.notInConstruct,!1)}function xS(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function bS(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&Y3(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function W3(e,n){const t=String(e);let r=t.indexOf(n),a=r,o=0,l=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++o>l&&(l=o):o=1,a=r+n.length,r=t.indexOf(n,a);return l}function Q3(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function J3(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function K3(e,n,t,r){const a=J3(t),o=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if(Q3(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(o,X3);return g(),b}const h=t.createTracker(r),d=a.repeat(Math.max(W3(o,a)+1,3)),u=t.enter("codeFenced");let f=h.move(d);if(e.lang){const g=t.enter(`codeFencedLang${l}`);f+=h.move(t.safe(e.lang,{before:f,after:" ",encode:["`"],...h.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${l}`);f+=h.move(" "),f+=h.move(t.safe(e.meta,{before:f,after:`
`,encode:["`"],...h.current()})),g()}return f+=h.move(`
`),o&&(f+=h.move(o+`
`)),f+=h.move(d),u(),f}function X3(e,n,t){return(t?"":"    ")+e}function Ew(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function Z3(e,n,t,r){const a=Ew(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("definition");let h=t.enter("label");const d=t.createTracker(r);let u=d.move("[");return u+=d.move(t.safe(t.associationId(e),{before:u,after:"]",...d.current()})),u+=d.move("]: "),h(),!e.url||/[\0- \u007F]/.test(e.url)?(h=t.enter("destinationLiteral"),u+=d.move("<"),u+=d.move(t.safe(e.url,{before:u,after:">",...d.current()})),u+=d.move(">")):(h=t.enter("destinationRaw"),u+=d.move(t.safe(e.url,{before:u,after:e.title?" ":`
`,...d.current()}))),h(),e.title&&(h=t.enter(`title${o}`),u+=d.move(" "+a),u+=d.move(t.safe(e.title,{before:u,after:a,...d.current()})),u+=d.move(a),h()),l(),u}function eF(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function ug(e){return"&#x"+e.toString(16).toUpperCase()+";"}function ub(e,n,t){const r=qf(e),a=qf(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}B2.peek=tF;function B2(e,n,t,r){const a=eF(t),o=t.enter("emphasis"),l=t.createTracker(r),h=l.move(a);let d=l.move(t.containerPhrasing(e,{after:a,before:h,...l.current()}));const u=d.charCodeAt(0),f=ub(r.before.charCodeAt(r.before.length-1),u,a);f.inside&&(d=ug(u)+d.slice(1));const g=d.charCodeAt(d.length-1),b=ub(r.after.charCodeAt(0),g,a);b.inside&&(d=d.slice(0,-1)+ug(g));const v=l.move(a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:f.outside},h+d+v}function tF(e,n,t){return t.options.emphasis||"*"}function nF(e,n){let t=!1;return kw(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,c1}),!!((!e.depth||e.depth<3)&&vw(e)&&(n.options.setext||t))}function iF(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),o=t.createTracker(r);if(nF(e,t)){const f=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...o.current(),before:`
`,after:`
`});return g(),f(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const l="#".repeat(a),h=t.enter("headingAtx"),d=t.enter("phrasing");o.move(l+" ");let u=t.containerPhrasing(e,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(u)&&(u=ug(u.charCodeAt(0))+u.slice(1)),u=u?l+" "+u:l,t.options.closeAtx&&(u+=" "+l),d(),h(),u}U2.peek=rF;function U2(e){return e.value||""}function rF(){return"<"}q2.peek=aF;function q2(e,n,t,r){const a=Ew(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("image");let h=t.enter("label");const d=t.createTracker(r);let u=d.move("![");return u+=d.move(t.safe(e.alt,{before:u,after:"]",...d.current()})),u+=d.move("]("),h(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(h=t.enter("destinationLiteral"),u+=d.move("<"),u+=d.move(t.safe(e.url,{before:u,after:">",...d.current()})),u+=d.move(">")):(h=t.enter("destinationRaw"),u+=d.move(t.safe(e.url,{before:u,after:e.title?" ":")",...d.current()}))),h(),e.title&&(h=t.enter(`title${o}`),u+=d.move(" "+a),u+=d.move(t.safe(e.title,{before:u,after:a,...d.current()})),u+=d.move(a),h()),u+=d.move(")"),l(),u}function aF(){return"!"}V2.peek=sF;function V2(e,n,t,r){const a=e.referenceType,o=t.enter("imageReference");let l=t.enter("label");const h=t.createTracker(r);let d=h.move("![");const u=t.safe(e.alt,{before:d,after:"]",...h.current()});d+=h.move(u+"]["),l();const f=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:d,after:"]",...h.current()});return l(),t.stack=f,o(),a==="full"||!u||u!==g?d+=h.move(g+"]"):a==="shortcut"?d=d.slice(0,-1):d+=h.move("]"),d}function sF(){return"!"}H2.peek=oF;function H2(e,n,t){let r=e.value||"",a="`",o=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++o<t.unsafe.length;){const l=t.unsafe[o],h=t.compilePattern(l);let d;if(l.atBreak)for(;d=h.exec(r);){let u=d.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(d.index+1)}}return a+r+a}function oF(){return"`"}function G2(e,n){const t=vw(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}Y2.peek=lF;function Y2(e,n,t,r){const a=Ew(t),o=a==='"'?"Quote":"Apostrophe",l=t.createTracker(r);let h,d;if(G2(e,t)){const f=t.stack;t.stack=[],h=t.enter("autolink");let g=l.move("<");return g+=l.move(t.containerPhrasing(e,{before:g,after:">",...l.current()})),g+=l.move(">"),h(),t.stack=f,g}h=t.enter("link"),d=t.enter("label");let u=l.move("[");return u+=l.move(t.containerPhrasing(e,{before:u,after:"](",...l.current()})),u+=l.move("]("),d(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(t.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(d=t.enter("destinationRaw"),u+=l.move(t.safe(e.url,{before:u,after:e.title?" ":")",...l.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=l.move(" "+a),u+=l.move(t.safe(e.title,{before:u,after:a,...l.current()})),u+=l.move(a),d()),u+=l.move(")"),h(),u}function lF(e,n,t){return G2(e,t)?"<":"["}W2.peek=cF;function W2(e,n,t,r){const a=e.referenceType,o=t.enter("linkReference");let l=t.enter("label");const h=t.createTracker(r);let d=h.move("[");const u=t.containerPhrasing(e,{before:d,after:"]",...h.current()});d+=h.move(u+"]["),l();const f=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:d,after:"]",...h.current()});return l(),t.stack=f,o(),a==="full"||!u||u!==g?d+=h.move(g+"]"):a==="shortcut"?d=d.slice(0,-1):d+=h.move("]"),d}function cF(){return"["}function Tw(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function uF(e){const n=Tw(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function dF(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function Q2(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function hF(e,n,t,r){const a=t.enter("list"),o=t.bulletCurrent;let l=e.ordered?dF(t):Tw(t);const h=e.ordered?l==="."?")":".":uF(t);let d=n&&t.bulletLastUsed?l===t.bulletLastUsed:!1;if(!e.ordered){const f=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&f&&(!f.children||!f.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(d=!0),Q2(t)===l&&f){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){d=!0;break}}}}d&&(l=h),t.bulletCurrent=l;const u=t.containerFlow(e,r);return t.bulletLastUsed=l,t.bulletCurrent=o,a(),u}function fF(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function pF(e,n,t,r){const a=fF(t);let o=t.bulletCurrent||Tw(t);n&&n.type==="list"&&n.ordered&&(o=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+o);let l=o.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(l=Math.ceil(l/4)*4);const h=t.createTracker(r);h.move(o+" ".repeat(l-o.length)),h.shift(l);const d=t.enter("listItem"),u=t.indentLines(t.containerFlow(e,h.current()),f);return d(),u;function f(g,b,v){return b?(v?"":" ".repeat(l))+g:(v?o:o+" ".repeat(l-o.length))+g}}function mF(e,n,t,r){const a=t.enter("paragraph"),o=t.enter("phrasing"),l=t.containerPhrasing(e,r);return o(),a(),l}const gF=Ob(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function yF(e,n,t,r){return(e.children.some(function(l){return gF(l)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function xF(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}J2.peek=bF;function J2(e,n,t,r){const a=xF(t),o=t.enter("strong"),l=t.createTracker(r),h=l.move(a+a);let d=l.move(t.containerPhrasing(e,{after:a,before:h,...l.current()}));const u=d.charCodeAt(0),f=ub(r.before.charCodeAt(r.before.length-1),u,a);f.inside&&(d=ug(u)+d.slice(1));const g=d.charCodeAt(d.length-1),b=ub(r.after.charCodeAt(0),g,a);b.inside&&(d=d.slice(0,-1)+ug(g));const v=l.move(a+a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:f.outside},h+d+v}function bF(e,n,t){return t.options.strong||"*"}function vF(e,n,t,r){return t.safe(e.value,r)}function wF(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function NF(e,n,t){const r=(Q2(t)+(t.options.ruleSpaces?" ":"")).repeat(wF(t));return t.options.ruleSpaces?r.slice(0,-1):r}const K2={blockquote:H3,break:bS,code:K3,definition:Z3,emphasis:B2,hardBreak:bS,heading:iF,html:U2,image:q2,imageReference:V2,inlineCode:H2,link:Y2,linkReference:W2,list:hF,listItem:pF,paragraph:mF,root:yF,strong:J2,text:vF,thematicBreak:NF};function SF(){return{enter:{table:jF,tableData:vS,tableHeader:vS,tableRow:CF},exit:{codeText:kF,table:_F,tableData:g0,tableHeader:g0,tableRow:g0}}}function jF(e){const n=e._align;this.enter({type:"table",align:n.map(function(t){return t==="none"?null:t}),children:[]},e),this.data.inTable=!0}function _F(e){this.exit(e),this.data.inTable=void 0}function CF(e){this.enter({type:"tableRow",children:[]},e)}function g0(e){this.exit(e)}function vS(e){this.enter({type:"tableCell",children:[]},e)}function kF(e){let n=this.resume();this.data.inTable&&(n=n.replace(/\\([\\|])/g,EF));const t=this.stack[this.stack.length-1];t.type,t.value=n,this.exit(e)}function EF(e,n){return n==="|"?n:e}function TF(e){const n=e||{},t=n.tableCellPadding,r=n.tablePipeAlign,a=n.stringLength,o=t?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:b,table:l,tableCell:d,tableRow:h}};function l(v,S,k,T){return u(f(v,k,T),v.align)}function h(v,S,k,T){const E=g(v,k,T),P=u([E]);return P.slice(0,P.indexOf(`
`))}function d(v,S,k,T){const E=k.enter("tableCell"),P=k.enter("phrasing"),I=k.containerPhrasing(v,{...T,before:o,after:o});return P(),E(),I}function u(v,S){return q3(v,{align:S,alignDelimiters:r,padding:t,stringLength:a})}function f(v,S,k){const T=v.children;let E=-1;const P=[],I=S.enter("table");for(;++E<T.length;)P[E]=g(T[E],S,k);return I(),P}function g(v,S,k){const T=v.children;let E=-1;const P=[],I=S.enter("tableRow");for(;++E<T.length;)P[E]=d(T[E],v,S,k);return I(),P}function b(v,S,k){let T=K2.inlineCode(v,S,k);return k.stack.includes("tableCell")&&(T=T.replace(/\|/g,"\\$&")),T}}function AF(){return{exit:{taskListCheckValueChecked:wS,taskListCheckValueUnchecked:wS,paragraph:PF}}}function DF(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:IF}}}function wS(e){const n=this.stack[this.stack.length-2];n.type,n.checked=e.type==="taskListCheckValueChecked"}function PF(e){const n=this.stack[this.stack.length-2];if(n&&n.type==="listItem"&&typeof n.checked=="boolean"){const t=this.stack[this.stack.length-1];t.type;const r=t.children[0];if(r&&r.type==="text"){const a=n.children;let o=-1,l;for(;++o<a.length;){const h=a[o];if(h.type==="paragraph"){l=h;break}}l===t&&(r.value=r.value.slice(1),r.value.length===0?t.children.shift():t.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,t.position.start=Object.assign({},r.position.start)))}}this.exit(e)}function IF(e,n,t,r){const a=e.children[0],o=typeof e.checked=="boolean"&&a&&a.type==="paragraph",l="["+(e.checked?"x":" ")+"] ",h=t.createTracker(r);o&&h.move(l);let d=K2.listItem(e,n,t,{...r,...h.current()});return o&&(d=d.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,u)),d;function u(f){return f+l}}function MF(){return[h3(),I3(),L3(),SF(),AF()]}function RF(e){return{extensions:[f3(),M3(e),F3(),TF(e),DF()]}}const OF={tokenize:UF,partial:!0},X2={tokenize:qF,partial:!0},Z2={tokenize:VF,partial:!0},ek={tokenize:HF,partial:!0},LF={tokenize:GF,partial:!0},tk={name:"wwwAutolink",tokenize:zF,previous:ik},nk={name:"protocolAutolink",tokenize:BF,previous:rk},uc={name:"emailAutolink",tokenize:$F,previous:ak},ml={};function FF(){return{text:ml}}let Dd=48;for(;Dd<123;)ml[Dd]=uc,Dd++,Dd===58?Dd=65:Dd===91&&(Dd=97);ml[43]=uc;ml[45]=uc;ml[46]=uc;ml[95]=uc;ml[72]=[uc,nk];ml[104]=[uc,nk];ml[87]=[uc,tk];ml[119]=[uc,tk];function $F(e,n,t){const r=this;let a,o;return l;function l(g){return!f1(g)||!ak.call(r,r.previous)||Aw(r.events)?t(g):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),h(g))}function h(g){return f1(g)?(e.consume(g),h):g===64?(e.consume(g),d):t(g)}function d(g){return g===46?e.check(LF,f,u)(g):g===45||g===95||Hr(g)?(o=!0,e.consume(g),d):f(g)}function u(g){return e.consume(g),a=!0,d}function f(g){return o&&a&&aa(r.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),n(g)):t(g)}}function zF(e,n,t){const r=this;return a;function a(l){return l!==87&&l!==119||!ik.call(r,r.previous)||Aw(r.events)?t(l):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(OF,e.attempt(X2,e.attempt(Z2,o),t),t)(l))}function o(l){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),n(l)}}function BF(e,n,t){const r=this;let a="",o=!1;return l;function l(g){return(g===72||g===104)&&rk.call(r,r.previous)&&!Aw(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),a+=String.fromCodePoint(g),e.consume(g),h):t(g)}function h(g){if(aa(g)&&a.length<5)return a+=String.fromCodePoint(g),e.consume(g),h;if(g===58){const b=a.toLowerCase();if(b==="http"||b==="https")return e.consume(g),d}return t(g)}function d(g){return g===47?(e.consume(g),o?u:(o=!0,d)):t(g)}function u(g){return g===null||ob(g)||di(g)||zd(g)||Ib(g)?t(g):e.attempt(X2,e.attempt(Z2,f),t)(g)}function f(g){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),n(g)}}function UF(e,n,t){let r=0;return a;function a(l){return(l===87||l===119)&&r<3?(r++,e.consume(l),a):l===46&&r===3?(e.consume(l),o):t(l)}function o(l){return l===null?t(l):n(l)}}function qF(e,n,t){let r,a,o;return l;function l(u){return u===46||u===95?e.check(ek,d,h)(u):u===null||di(u)||zd(u)||u!==45&&Ib(u)?d(u):(o=!0,e.consume(u),l)}function h(u){return u===95?r=!0:(a=r,r=void 0),e.consume(u),l}function d(u){return a||r||!o?t(u):n(u)}}function VF(e,n){let t=0,r=0;return a;function a(l){return l===40?(t++,e.consume(l),a):l===41&&r<t?o(l):l===33||l===34||l===38||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===60||l===63||l===93||l===95||l===126?e.check(ek,n,o)(l):l===null||di(l)||zd(l)?n(l):(e.consume(l),a)}function o(l){return l===41&&r++,e.consume(l),a}}function HF(e,n,t){return r;function r(h){return h===33||h===34||h===39||h===41||h===42||h===44||h===46||h===58||h===59||h===63||h===95||h===126?(e.consume(h),r):h===38?(e.consume(h),o):h===93?(e.consume(h),a):h===60||h===null||di(h)||zd(h)?n(h):t(h)}function a(h){return h===null||h===40||h===91||di(h)||zd(h)?n(h):r(h)}function o(h){return aa(h)?l(h):t(h)}function l(h){return h===59?(e.consume(h),r):aa(h)?(e.consume(h),l):t(h)}}function GF(e,n,t){return r;function r(o){return e.consume(o),a}function a(o){return Hr(o)?t(o):n(o)}}function ik(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||di(e)}function rk(e){return!aa(e)}function ak(e){return!(e===47||f1(e))}function f1(e){return e===43||e===45||e===46||e===95||Hr(e)}function Aw(e){let n=e.length,t=!1;for(;n--;){const r=e[n][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){t=!0;break}if(r._gfmAutolinkLiteralWalkedInto){t=!1;break}}return e.length>0&&!t&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),t}const YF={tokenize:t6,partial:!0};function WF(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:XF,continuation:{tokenize:ZF},exit:e6}},text:{91:{name:"gfmFootnoteCall",tokenize:KF},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:QF,resolveTo:JF}}}}function QF(e,n,t){const r=this;let a=r.events.length;const o=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let l;for(;a--;){const d=r.events[a][1];if(d.type==="labelImage"){l=d;break}if(d.type==="gfmFootnoteCall"||d.type==="labelLink"||d.type==="label"||d.type==="image"||d.type==="link")break}return h;function h(d){if(!l||!l._balanced)return t(d);const u=po(r.sliceSerialize({start:l.end,end:r.now()}));return u.codePointAt(0)!==94||!o.includes(u.slice(1))?t(d):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(d),e.exit("gfmFootnoteCallLabelMarker"),n(d))}}function JF(e,n){let t=e.length;for(;t--;)if(e[t][1].type==="labelImage"&&e[t][0]==="enter"){e[t][1];break}e[t+1][1].type="data",e[t+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[t+3][1].start),end:Object.assign({},e[e.length-1][1].end)},a={type:"gfmFootnoteCallMarker",start:Object.assign({},e[t+3][1].end),end:Object.assign({},e[t+3][1].end)};a.end.column++,a.end.offset++,a.end._bufferIndex++;const o={type:"gfmFootnoteCallString",start:Object.assign({},a.end),end:Object.assign({},e[e.length-1][1].start)},l={type:"chunkString",contentType:"string",start:Object.assign({},o.start),end:Object.assign({},o.end)},h=[e[t+1],e[t+2],["enter",r,n],e[t+3],e[t+4],["enter",a,n],["exit",a,n],["enter",o,n],["enter",l,n],["exit",l,n],["exit",o,n],e[e.length-2],e[e.length-1],["exit",r,n]];return e.splice(t,e.length-t+1,...h),e}function KF(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o=0,l;return h;function h(g){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),d}function d(g){return g!==94?t(g):(e.enter("gfmFootnoteCallMarker"),e.consume(g),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",u)}function u(g){if(o>999||g===93&&!l||g===null||g===91||di(g))return t(g);if(g===93){e.exit("chunkString");const b=e.exit("gfmFootnoteCallString");return a.includes(po(r.sliceSerialize(b)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),n):t(g)}return di(g)||(l=!0),o++,e.consume(g),g===92?f:u}function f(g){return g===91||g===92||g===93?(e.consume(g),o++,u):u(g)}}function XF(e,n,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o,l=0,h;return d;function d(S){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),u}function u(S){return S===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",f):t(S)}function f(S){if(l>999||S===93&&!h||S===null||S===91||di(S))return t(S);if(S===93){e.exit("chunkString");const k=e.exit("gfmFootnoteDefinitionLabelString");return o=po(r.sliceSerialize(k)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),b}return di(S)||(h=!0),l++,e.consume(S),S===92?g:f}function g(S){return S===91||S===92||S===93?(e.consume(S),l++,f):f(S)}function b(S){return S===58?(e.enter("definitionMarker"),e.consume(S),e.exit("definitionMarker"),a.includes(o)||a.push(o),Rn(e,v,"gfmFootnoteDefinitionWhitespace")):t(S)}function v(S){return n(S)}}function ZF(e,n,t){return e.check(wg,n,e.attempt(YF,n,t))}function e6(e){e.exit("gfmFootnoteDefinition")}function t6(e,n,t){const r=this;return Rn(e,a,"gfmFootnoteDefinitionIndent",5);function a(o){const l=r.events[r.events.length-1];return l&&l[1].type==="gfmFootnoteDefinitionIndent"&&l[2].sliceSerialize(l[1],!0).length===4?n(o):t(o)}}function n6(e){let t=(e||{}).singleTilde;const r={name:"strikethrough",tokenize:o,resolveAll:a};return t==null&&(t=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function a(l,h){let d=-1;for(;++d<l.length;)if(l[d][0]==="enter"&&l[d][1].type==="strikethroughSequenceTemporary"&&l[d][1]._close){let u=d;for(;u--;)if(l[u][0]==="exit"&&l[u][1].type==="strikethroughSequenceTemporary"&&l[u][1]._open&&l[d][1].end.offset-l[d][1].start.offset===l[u][1].end.offset-l[u][1].start.offset){l[d][1].type="strikethroughSequence",l[u][1].type="strikethroughSequence";const f={type:"strikethrough",start:Object.assign({},l[u][1].start),end:Object.assign({},l[d][1].end)},g={type:"strikethroughText",start:Object.assign({},l[u][1].end),end:Object.assign({},l[d][1].start)},b=[["enter",f,h],["enter",l[u][1],h],["exit",l[u][1],h],["enter",g,h]],v=h.parser.constructs.insideSpan.null;v&&is(b,b.length,0,Mb(v,l.slice(u+1,d),h)),is(b,b.length,0,[["exit",g,h],["enter",l[d][1],h],["exit",l[d][1],h],["exit",f,h]]),is(l,u-1,d-u+3,b),d=u+b.length-2;break}}for(d=-1;++d<l.length;)l[d][1].type==="strikethroughSequenceTemporary"&&(l[d][1].type="data");return l}function o(l,h,d){const u=this.previous,f=this.events;let g=0;return b;function b(S){return u===126&&f[f.length-1][1].type!=="characterEscape"?d(S):(l.enter("strikethroughSequenceTemporary"),v(S))}function v(S){const k=qf(u);if(S===126)return g>1?d(S):(l.consume(S),g++,v);if(g<2&&!t)return d(S);const T=l.exit("strikethroughSequenceTemporary"),E=qf(S);return T._open=!E||E===2&&!!k,T._close=!k||k===2&&!!E,h(S)}}}class i6{constructor(){this.map=[]}add(n,t,r){r6(this,n,t,r)}consume(n){if(this.map.sort(function(o,l){return o[0]-l[0]}),this.map.length===0)return;let t=this.map.length;const r=[];for(;t>0;)t-=1,r.push(n.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),n.length=this.map[t][0];r.push(n.slice()),n.length=0;let a=r.pop();for(;a;){for(const o of a)n.push(o);a=r.pop()}this.map.length=0}}function r6(e,n,t,r){let a=0;if(!(t===0&&r.length===0)){for(;a<e.map.length;){if(e.map[a][0]===n){e.map[a][1]+=t,e.map[a][2].push(...r);return}a+=1}e.map.push([n,t,r])}}function a6(e,n){let t=!1;const r=[];for(;n<e.length;){const a=e[n];if(t){if(a[0]==="enter")a[1].type==="tableContent"&&r.push(e[n+1][1].type==="tableDelimiterMarker"?"left":"none");else if(a[1].type==="tableContent"){if(e[n-1][1].type==="tableDelimiterMarker"){const o=r.length-1;r[o]=r[o]==="left"?"center":"right"}}else if(a[1].type==="tableDelimiterRow")break}else a[0]==="enter"&&a[1].type==="tableDelimiterRow"&&(t=!0);n+=1}return r}function s6(){return{flow:{null:{name:"table",tokenize:o6,resolveAll:l6}}}}function o6(e,n,t){const r=this;let a=0,o=0,l;return h;function h(R){let U=r.events.length-1;for(;U>-1;){const ne=r.events[U][1].type;if(ne==="lineEnding"||ne==="linePrefix")U--;else break}const Y=U>-1?r.events[U][1].type:null,Z=Y==="tableHead"||Y==="tableRow"?L:d;return Z===L&&r.parser.lazy[r.now().line]?t(R):Z(R)}function d(R){return e.enter("tableHead"),e.enter("tableRow"),u(R)}function u(R){return R===124||(l=!0,o+=1),f(R)}function f(R){return R===null?t(R):Ht(R)?o>1?(o=0,r.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(R),e.exit("lineEnding"),v):t(R):kn(R)?Rn(e,f,"whitespace")(R):(o+=1,l&&(l=!1,a+=1),R===124?(e.enter("tableCellDivider"),e.consume(R),e.exit("tableCellDivider"),l=!0,f):(e.enter("data"),g(R)))}function g(R){return R===null||R===124||di(R)?(e.exit("data"),f(R)):(e.consume(R),R===92?b:g)}function b(R){return R===92||R===124?(e.consume(R),g):g(R)}function v(R){return r.interrupt=!1,r.parser.lazy[r.now().line]?t(R):(e.enter("tableDelimiterRow"),l=!1,kn(R)?Rn(e,S,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(R):S(R))}function S(R){return R===45||R===58?T(R):R===124?(l=!0,e.enter("tableCellDivider"),e.consume(R),e.exit("tableCellDivider"),k):$(R)}function k(R){return kn(R)?Rn(e,T,"whitespace")(R):T(R)}function T(R){return R===58?(o+=1,l=!0,e.enter("tableDelimiterMarker"),e.consume(R),e.exit("tableDelimiterMarker"),E):R===45?(o+=1,E(R)):R===null||Ht(R)?q(R):$(R)}function E(R){return R===45?(e.enter("tableDelimiterFiller"),P(R)):$(R)}function P(R){return R===45?(e.consume(R),P):R===58?(l=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(R),e.exit("tableDelimiterMarker"),I):(e.exit("tableDelimiterFiller"),I(R))}function I(R){return kn(R)?Rn(e,q,"whitespace")(R):q(R)}function q(R){return R===124?S(R):R===null||Ht(R)?!l||a!==o?$(R):(e.exit("tableDelimiterRow"),e.exit("tableHead"),n(R)):$(R)}function $(R){return t(R)}function L(R){return e.enter("tableRow"),F(R)}function F(R){return R===124?(e.enter("tableCellDivider"),e.consume(R),e.exit("tableCellDivider"),F):R===null||Ht(R)?(e.exit("tableRow"),n(R)):kn(R)?Rn(e,F,"whitespace")(R):(e.enter("data"),z(R))}function z(R){return R===null||R===124||di(R)?(e.exit("data"),F(R)):(e.consume(R),R===92?B:z)}function B(R){return R===92||R===124?(e.consume(R),z):z(R)}}function l6(e,n){let t=-1,r=!0,a=0,o=[0,0,0,0],l=[0,0,0,0],h=!1,d=0,u,f,g;const b=new i6;for(;++t<e.length;){const v=e[t],S=v[1];v[0]==="enter"?S.type==="tableHead"?(h=!1,d!==0&&(NS(b,n,d,u,f),f=void 0,d=0),u={type:"table",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",u,n]])):S.type==="tableRow"||S.type==="tableDelimiterRow"?(r=!0,g=void 0,o=[0,0,0,0],l=[0,t+1,0,0],h&&(h=!1,f={type:"tableBody",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",f,n]])),a=S.type==="tableDelimiterRow"?2:f?3:1):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")?(r=!1,l[2]===0&&(o[1]!==0&&(l[0]=l[1],g=Cx(b,n,o,a,void 0,g),o=[0,0,0,0]),l[2]=t)):S.type==="tableCellDivider"&&(r?r=!1:(o[1]!==0&&(l[0]=l[1],g=Cx(b,n,o,a,void 0,g)),o=l,l=[o[1],t,0,0])):S.type==="tableHead"?(h=!0,d=t):S.type==="tableRow"||S.type==="tableDelimiterRow"?(d=t,o[1]!==0?(l[0]=l[1],g=Cx(b,n,o,a,t,g)):l[1]!==0&&(g=Cx(b,n,l,a,t,g)),a=0):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")&&(l[3]=t)}for(d!==0&&NS(b,n,d,u,f),b.consume(n.events),t=-1;++t<n.events.length;){const v=n.events[t];v[0]==="enter"&&v[1].type==="table"&&(v[1]._align=a6(n.events,t))}return e}function Cx(e,n,t,r,a,o){const l=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",h="tableContent";t[0]!==0&&(o.end=Object.assign({},Af(n.events,t[0])),e.add(t[0],0,[["exit",o,n]]));const d=Af(n.events,t[1]);if(o={type:l,start:Object.assign({},d),end:Object.assign({},d)},e.add(t[1],0,[["enter",o,n]]),t[2]!==0){const u=Af(n.events,t[2]),f=Af(n.events,t[3]),g={type:h,start:Object.assign({},u),end:Object.assign({},f)};if(e.add(t[2],0,[["enter",g,n]]),r!==2){const b=n.events[t[2]],v=n.events[t[3]];if(b[1].end=Object.assign({},v[1].end),b[1].type="chunkText",b[1].contentType="text",t[3]>t[2]+1){const S=t[2]+1,k=t[3]-t[2]-1;e.add(S,k,[])}}e.add(t[3]+1,0,[["exit",g,n]])}return a!==void 0&&(o.end=Object.assign({},Af(n.events,a)),e.add(a,0,[["exit",o,n]]),o=void 0),o}function NS(e,n,t,r,a){const o=[],l=Af(n.events,t);a&&(a.end=Object.assign({},l),o.push(["exit",a,n])),r.end=Object.assign({},l),o.push(["exit",r,n]),e.add(t+1,0,o)}function Af(e,n){const t=e[n],r=t[0]==="enter"?"start":"end";return t[1][r]}const c6={name:"tasklistCheck",tokenize:d6};function u6(){return{text:{91:c6}}}function d6(e,n,t){const r=this;return a;function a(d){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?t(d):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(d),e.exit("taskListCheckMarker"),o)}function o(d){return di(d)?(e.enter("taskListCheckValueUnchecked"),e.consume(d),e.exit("taskListCheckValueUnchecked"),l):d===88||d===120?(e.enter("taskListCheckValueChecked"),e.consume(d),e.exit("taskListCheckValueChecked"),l):t(d)}function l(d){return d===93?(e.enter("taskListCheckMarker"),e.consume(d),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),h):t(d)}function h(d){return Ht(d)?n(d):kn(d)?e.check({tokenize:h6},n,t)(d):t(d)}}function h6(e,n,t){return Rn(e,r,"whitespace");function r(a){return a===null?t(a):n(a)}}function f6(e){return m2([FF(),WF(),n6(e),s6(),u6()])}const p6={};function ks(e){const n=this,t=e||p6,r=n.data(),a=r.micromarkExtensions||(r.micromarkExtensions=[]),o=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),l=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);a.push(f6(t)),o.push(MF()),l.push(RF(t))}const p1=()=>{const e=localStorage.getItem("currentClinicId");return e||(console.warn("getCurrentClinicId: Clinic ID not found. Returning null. Ensure this is implemented correctly."),null)},Vf=()=>localStorage.getItem("authToken"),m6="_container_6q5ye_3",g6="_title_6q5ye_29",y6="_filtersContainer_6q5ye_145",x6="_dateInputLabel_6q5ye_197",b6="_dateInput_6q5ye_197",v6="_fetchButton_6q5ye_279",w6="_dashboardGrid_6q5ye_333",N6="_sectionContainer_6q5ye_345",S6="_sectionTitle_6q5ye_371",j6="_totalRevenue_6q5ye_407",_6="_totalRevenueAmount_6q5ye_477",C6="_revenueGrid_6q5ye_505",k6="_revenueCard_6q5ye_519",E6="_revenueCardTitle_6q5ye_555",T6="_revenueCardAmount_6q5ye_587",A6="_revenueCardList_6q5ye_609",D6="_tableContainer_6q5ye_681",P6="_styledTable_6q5ye_707",I6="_capitalize_6q5ye_805",M6="_textRight_6q5ye_813",R6="_textGreen_6q5ye_823",O6="_textRed_6q5ye_833",L6="_textOrange_6q5ye_843",F6="_reasonDistribution_6q5ye_865",$6="_loadingContainer_6q5ye_911",z6="_breathingBall_6q5ye_931",B6="_errorAlert_6q5ye_981",U6="_noDataMessage_6q5ye_1007",St={container:m6,title:g6,filtersContainer:y6,dateInputLabel:x6,dateInput:b6,fetchButton:v6,dashboardGrid:w6,sectionContainer:N6,sectionTitle:S6,totalRevenue:j6,totalRevenueAmount:_6,revenueGrid:C6,revenueCard:k6,revenueCardTitle:E6,revenueCardAmount:T6,revenueCardList:A6,tableContainer:D6,styledTable:P6,capitalize:I6,textRight:M6,textGreen:R6,textRed:O6,textOrange:L6,reasonDistribution:F6,loadingContainer:$6,breathingBall:z6,errorAlert:B6,noDataMessage:U6},q6="_chatWidget_x6b8i_7",V6="_chatToggleBtn_x6b8i_31",H6="_chatWindow_x6b8i_107",G6="_chatHeader_x6b8i_179",Y6="_chatHeaderTitle_x6b8i_209",W6="_chatMessages_x6b8i_237",Q6="_messageBubble_x6b8i_323",J6="_messageIcon_x6b8i_363",K6="_userMessage_x6b8i_391",X6="_messageContent_x6b8i_421",Z6="_aiMessage_x6b8i_447",e5="_emptyChatState_x6b8i_985",t5="_emptyChatIcon_x6b8i_1009",n5="_suggestionChips_x6b8i_1039",i5="_chatInputArea_x6b8i_1127",r5="_sendBtn_x6b8i_1231",a5="_typingIndicator_x6b8i_1317",rn={chatWidget:q6,chatToggleBtn:V6,chatWindow:H6,chatHeader:G6,chatHeaderTitle:Y6,chatMessages:W6,messageBubble:Q6,messageIcon:J6,userMessage:K6,messageContent:X6,aiMessage:Z6,emptyChatState:e5,emptyChatIcon:t5,suggestionChips:n5,chatInputArea:i5,sendBtn:r5,typingIndicator:a5};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let s5,o5;function l5(){return{geminiUrl:s5,vertexUrl:o5}}function c5(e,n,t){var r,a,o;if(!(!((r=e.httpOptions)===null||r===void 0)&&r.baseUrl)){const l=l5();return e.vertexai?(a=l.vertexUrl)!==null&&a!==void 0?a:n:(o=l.geminiUrl)!==null&&o!==void 0?o:t}return e.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Sg{}function Xt(e,n){const t=/\{([^}]+)\}/g;return e.replace(t,(r,a)=>{if(Object.prototype.hasOwnProperty.call(n,a)){const o=n[a];return o!=null?String(o):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function _(e,n,t){for(let o=0;o<n.length-1;o++){const l=n[o];if(l.endsWith("[]")){const h=l.slice(0,-2);if(!(h in e))if(Array.isArray(t))e[h]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(e[h])){const d=e[h];if(Array.isArray(t))for(let u=0;u<d.length;u++){const f=d[u];_(f,n.slice(o+1),t[u])}else for(const u of d)_(u,n.slice(o+1),t)}return}else if(l.endsWith("[0]")){const h=l.slice(0,-3);h in e||(e[h]=[{}]);const d=e[h];_(d[0],n.slice(o+1),t);return}(!e[l]||typeof e[l]!="object")&&(e[l]={}),e=e[l]}const r=n[n.length-1],a=e[r];if(a!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===a)return;if(typeof a=="object"&&typeof t=="object"&&a!==null&&t!==null)Object.assign(a,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else e[r]=t}function j(e,n){try{if(n.length===1&&n[0]==="_self")return e;for(let t=0;t<n.length;t++){if(typeof e!="object"||e===null)return;const r=n[t];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in e){const o=e[a];return Array.isArray(o)?o.map(l=>j(l,n.slice(t+1))):void 0}else return}else e=e[r]}return e}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Di(e,n){if(!n||typeof n!="string")throw new Error("model is required and must be a string");if(e.isVertexAI()){if(n.startsWith("publishers/")||n.startsWith("projects/")||n.startsWith("models/"))return n;if(n.indexOf("/")>=0){const t=n.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${n}`}else return n.startsWith("models/")||n.startsWith("tunedModels/")?n:`models/${n}`}function sk(e,n){const t=Di(e,n);return t?t.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:t.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${t}`:t:""}function ok(e,n){return Array.isArray(n)?n.map(t=>db(e,t)):[db(e,n)]}function db(e,n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function u5(e,n){const t=db(e,n);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function d5(e,n){const t=db(e,n);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function SS(e,n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function lk(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(t=>SS(e,t)):[SS(e,n)]}function m1(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function jS(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function _S(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function Ca(e,n){if(n==null)throw new Error("ContentUnion is required");return m1(n)?n:{role:"user",parts:lk(e,n)}}function ck(e,n){if(!n)return[];if(e.isVertexAI()&&Array.isArray(n))return n.flatMap(t=>{const r=Ca(e,t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const t=Ca(e,n);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(n)?n.map(t=>Ca(e,t)):[Ca(e,n)]}function yu(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(jS(n)||_S(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Ca(e,n)]}const t=[],r=[],a=m1(n[0]);for(const o of n){const l=m1(o);if(l!=a)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)t.push(o);else{if(jS(o)||_S(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(o)}}return a||t.push({role:"user",parts:lk(e,r)}),t}function uk(e,n){return n}function dk(e,n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Fb(e,n){return n}function $b(e,n){if(!Array.isArray(n))throw new Error("tool is required and must be an array of Tools");return n}function h5(e,n,t,r=1){const a=!n.startsWith(`${t}/`)&&n.split("/").length===r;return e.isVertexAI()?n.startsWith("projects/")?n:n.startsWith("locations/")?`projects/${e.getProject()}/${n}`:n.startsWith(`${t}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:a?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}/${n}`:n:a?`${t}/${n}`:n}function xu(e,n){if(typeof n!="string")throw new Error("name must be a string");return h5(e,n,"cachedContents")}function hk(e,n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function bu(e,n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function f5(e){return e!=null&&typeof e=="object"&&"name"in e}function p5(e){return e!=null&&typeof e=="object"&&"video"in e}function m5(e){return e!=null&&typeof e=="object"&&"uri"in e}function fk(e,n){var t;let r;if(f5(n)&&(r=n.name),!(m5(n)&&(r=n.uri,r===void 0))&&!(p5(n)&&(r=(t=n.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof n=="string"&&(r=n),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const o=r.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${r}`);r=o[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function pk(e,n){let t;return e.isVertexAI()?t=n?"publishers/google/models":"models":t=n?"models":"tunedModels",t}function mk(e,n){for(const t of["models","tunedModels","publisherModels"])if(g5(n,t))return n[t];return[]}function g5(e,n){return e!==null&&typeof e=="object"&&n in e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function y5(e,n){const t={};if(j(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=j(n,["data"]);r!=null&&_(t,["data"],r);const a=j(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function x5(e,n){const t={};if(j(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=j(n,["thought"]);r!=null&&_(t,["thought"],r);const a=j(n,["inlineData"]);a!=null&&_(t,["inlineData"],y5(e,a));const o=j(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=j(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const h=j(n,["fileData"]);h!=null&&_(t,["fileData"],h);const d=j(n,["functionCall"]);d!=null&&_(t,["functionCall"],d);const u=j(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const f=j(n,["text"]);return f!=null&&_(t,["text"],f),t}function CS(e,n){const t={},r=j(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>x5(e,l))),_(t,["parts"],o)}const a=j(n,["role"]);return a!=null&&_(t,["role"],a),t}function b5(){return{}}function v5(e,n){const t={},r=j(n,["mode"]);r!=null&&_(t,["mode"],r);const a=j(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function w5(e,n){const t={},r=j(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],v5(e,r)),t}function N5(e,n){const t={};if(j(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");j(n,["googleSearch"])!=null&&_(t,["googleSearch"],b5());const a=j(n,["googleSearchRetrieval"]);if(a!=null&&_(t,["googleSearchRetrieval"],w5(e,a)),j(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(j(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=j(n,["codeExecution"]);o!=null&&_(t,["codeExecution"],o);const l=j(n,["functionDeclarations"]);return l!=null&&_(t,["functionDeclarations"],l),t}function S5(e,n){const t={},r=j(n,["mode"]);r!=null&&_(t,["mode"],r);const a=j(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function j5(e,n){const t={},r=j(n,["functionCallingConfig"]);if(r!=null&&_(t,["functionCallingConfig"],S5(e,r)),j(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function _5(e,n,t){const r={},a=j(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const o=j(n,["expireTime"]);t!==void 0&&o!=null&&_(t,["expireTime"],o);const l=j(n,["displayName"]);t!==void 0&&l!=null&&_(t,["displayName"],l);const h=j(n,["contents"]);if(t!==void 0&&h!=null){let g=yu(e,h);Array.isArray(g)&&(g=g.map(b=>CS(e,b))),_(t,["contents"],g)}const d=j(n,["systemInstruction"]);t!==void 0&&d!=null&&_(t,["systemInstruction"],CS(e,Ca(e,d)));const u=j(n,["tools"]);if(t!==void 0&&u!=null){let g=u;Array.isArray(g)&&(g=g.map(b=>N5(e,b))),_(t,["tools"],g)}const f=j(n,["toolConfig"]);return t!==void 0&&f!=null&&_(t,["toolConfig"],j5(e,f)),r}function C5(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["model"],sk(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],_5(e,a,t)),t}function k5(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["_url","name"],xu(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function E5(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["_url","name"],xu(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function T5(e,n,t){const r={},a=j(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const o=j(n,["expireTime"]);return t!==void 0&&o!=null&&_(t,["expireTime"],o),r}function A5(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["_url","name"],xu(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],T5(e,a,t)),t}function D5(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=j(n,["pageToken"]);return t!==void 0&&o!=null&&_(t,["_query","pageToken"],o),r}function P5(e,n){const t={},r=j(n,["config"]);return r!=null&&_(t,["config"],D5(e,r,t)),t}function I5(e,n){const t={},r=j(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=j(n,["data"]);a!=null&&_(t,["data"],a);const o=j(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function M5(e,n){const t={},r=j(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=j(n,["thought"]);a!=null&&_(t,["thought"],a);const o=j(n,["inlineData"]);o!=null&&_(t,["inlineData"],I5(e,o));const l=j(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const h=j(n,["executableCode"]);h!=null&&_(t,["executableCode"],h);const d=j(n,["fileData"]);d!=null&&_(t,["fileData"],d);const u=j(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const f=j(n,["functionResponse"]);f!=null&&_(t,["functionResponse"],f);const g=j(n,["text"]);return g!=null&&_(t,["text"],g),t}function kS(e,n){const t={},r=j(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>M5(e,l))),_(t,["parts"],o)}const a=j(n,["role"]);return a!=null&&_(t,["role"],a),t}function R5(){return{}}function O5(e,n){const t={},r=j(n,["mode"]);r!=null&&_(t,["mode"],r);const a=j(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function L5(e,n){const t={},r=j(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],O5(e,r)),t}function F5(){return{}}function $5(e,n){const t={},r=j(n,["apiKeyString"]);return r!=null&&_(t,["apiKeyString"],r),t}function z5(e,n){const t={},r=j(n,["apiKeyConfig"]);r!=null&&_(t,["apiKeyConfig"],$5(e,r));const a=j(n,["authType"]);a!=null&&_(t,["authType"],a);const o=j(n,["googleServiceAccountConfig"]);o!=null&&_(t,["googleServiceAccountConfig"],o);const l=j(n,["httpBasicAuthConfig"]);l!=null&&_(t,["httpBasicAuthConfig"],l);const h=j(n,["oauthConfig"]);h!=null&&_(t,["oauthConfig"],h);const d=j(n,["oidcConfig"]);return d!=null&&_(t,["oidcConfig"],d),t}function B5(e,n){const t={},r=j(n,["authConfig"]);return r!=null&&_(t,["authConfig"],z5(e,r)),t}function U5(e,n){const t={},r=j(n,["retrieval"]);r!=null&&_(t,["retrieval"],r),j(n,["googleSearch"])!=null&&_(t,["googleSearch"],R5());const o=j(n,["googleSearchRetrieval"]);o!=null&&_(t,["googleSearchRetrieval"],L5(e,o)),j(n,["enterpriseWebSearch"])!=null&&_(t,["enterpriseWebSearch"],F5());const h=j(n,["googleMaps"]);h!=null&&_(t,["googleMaps"],B5(e,h));const d=j(n,["codeExecution"]);d!=null&&_(t,["codeExecution"],d);const u=j(n,["functionDeclarations"]);return u!=null&&_(t,["functionDeclarations"],u),t}function q5(e,n){const t={},r=j(n,["mode"]);r!=null&&_(t,["mode"],r);const a=j(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function V5(e,n){const t={},r=j(n,["latitude"]);r!=null&&_(t,["latitude"],r);const a=j(n,["longitude"]);return a!=null&&_(t,["longitude"],a),t}function H5(e,n){const t={},r=j(n,["latLng"]);return r!=null&&_(t,["latLng"],V5(e,r)),t}function G5(e,n){const t={},r=j(n,["functionCallingConfig"]);r!=null&&_(t,["functionCallingConfig"],q5(e,r));const a=j(n,["retrievalConfig"]);return a!=null&&_(t,["retrievalConfig"],H5(e,a)),t}function Y5(e,n,t){const r={},a=j(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const o=j(n,["expireTime"]);t!==void 0&&o!=null&&_(t,["expireTime"],o);const l=j(n,["displayName"]);t!==void 0&&l!=null&&_(t,["displayName"],l);const h=j(n,["contents"]);if(t!==void 0&&h!=null){let g=yu(e,h);Array.isArray(g)&&(g=g.map(b=>kS(e,b))),_(t,["contents"],g)}const d=j(n,["systemInstruction"]);t!==void 0&&d!=null&&_(t,["systemInstruction"],kS(e,Ca(e,d)));const u=j(n,["tools"]);if(t!==void 0&&u!=null){let g=u;Array.isArray(g)&&(g=g.map(b=>U5(e,b))),_(t,["tools"],g)}const f=j(n,["toolConfig"]);return t!==void 0&&f!=null&&_(t,["toolConfig"],G5(e,f)),r}function W5(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["model"],sk(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],Y5(e,a,t)),t}function Q5(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["_url","name"],xu(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function J5(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["_url","name"],xu(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function K5(e,n,t){const r={},a=j(n,["ttl"]);t!==void 0&&a!=null&&_(t,["ttl"],a);const o=j(n,["expireTime"]);return t!==void 0&&o!=null&&_(t,["expireTime"],o),r}function X5(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["_url","name"],xu(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],K5(e,a,t)),t}function Z5(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=j(n,["pageToken"]);return t!==void 0&&o!=null&&_(t,["_query","pageToken"],o),r}function e$(e,n){const t={},r=j(n,["config"]);return r!=null&&_(t,["config"],Z5(e,r,t)),t}function Wx(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=j(n,["model"]);o!=null&&_(t,["model"],o);const l=j(n,["createTime"]);l!=null&&_(t,["createTime"],l);const h=j(n,["updateTime"]);h!=null&&_(t,["updateTime"],h);const d=j(n,["expireTime"]);d!=null&&_(t,["expireTime"],d);const u=j(n,["usageMetadata"]);return u!=null&&_(t,["usageMetadata"],u),t}function t$(){return{}}function n$(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=j(n,["cachedContents"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>Wx(e,l))),_(t,["cachedContents"],o)}return t}function Qx(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=j(n,["model"]);o!=null&&_(t,["model"],o);const l=j(n,["createTime"]);l!=null&&_(t,["createTime"],l);const h=j(n,["updateTime"]);h!=null&&_(t,["updateTime"],h);const d=j(n,["expireTime"]);d!=null&&_(t,["expireTime"],d);const u=j(n,["usageMetadata"]);return u!=null&&_(t,["usageMetadata"],u),t}function i$(){return{}}function r$(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=j(n,["cachedContents"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>Qx(e,l))),_(t,["cachedContents"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Hf;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Hf||(Hf={}));class zb{constructor(n,t,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(n,r,a)}init(n,t,r){var a,o;this.nameInternal=n,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};r?typeof r=="object"?l=Object.assign({},r):l=r:l={config:{}},l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(o=(a=l.config)===null||a===void 0?void 0:a.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(n){this.init(this.nameInternal,n,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(n){return this.pageInternal[n]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const n=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:n,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const n=await this.requestInternal(this.params);return this.initNextPage(n),this.page}hasNextPage(){var n;return((n=this.params.config)===null||n===void 0?void 0:n.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ES;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(ES||(ES={}));var TS;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(TS||(TS={}));var AS;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(AS||(AS={}));var DS;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(DS||(DS={}));var PS;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(PS||(PS={}));var IS;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(IS||(IS={}));var MS;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(MS||(MS={}));var Gf;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT"})(Gf||(Gf={}));var RS;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY"})(RS||(RS={}));var OS;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(OS||(OS={}));var LS;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(LS||(LS={}));var FS;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(FS||(FS={}));var $S;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})($S||($S={}));var Yf;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(Yf||(Yf={}));var g1;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(g1||(g1={}));var y1;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(y1||(y1={}));var zS;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(zS||(zS={}));var BS;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(BS||(BS={}));var US;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(US||(US={}));var qS;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(qS||(qS={}));var VS;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(VS||(VS={}));var HS;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(HS||(HS={}));var GS;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi"})(GS||(GS={}));var YS;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(YS||(YS={}));var WS;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(WS||(WS={}));var QS;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(QS||(QS={}));var JS;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(JS||(JS={}));var KS;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(KS||(KS={}));var XS;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(XS||(XS={}));var ZS;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(ZS||(ZS={}));var ej;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(ej||(ej={}));var tj;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(tj||(tj={}));var nj;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(nj||(nj={}));var ij;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(ij||(ij={}));class kx{get text(){var n,t,r,a,o,l,h,d;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",f=!1;const g=[];for(const b of(d=(h=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||h===void 0?void 0:h.parts)!==null&&d!==void 0?d:[]){for(const[v,S]of Object.entries(b))v!=="text"&&v!=="thought"&&(S!==null||S!==void 0)&&g.push(v);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;f=!0,u+=b.text}}return g.length>0&&console.warn(`there are non-text parts ${g} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?u:void 0}get data(){var n,t,r,a,o,l,h,d;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const f=[];for(const g of(d=(h=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||h===void 0?void 0:h.parts)!==null&&d!==void 0?d:[]){for(const[b,v]of Object.entries(g))b!=="inlineData"&&(v!==null||v!==void 0)&&f.push(b);g.inlineData&&typeof g.inlineData.data=="string"&&(u+=atob(g.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var n,t,r,a,o,l,h,d;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(d=(h=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||h===void 0?void 0:h.parts)===null||d===void 0?void 0:d.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var n,t,r,a,o,l,h,d,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(d=(h=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||h===void 0?void 0:h.parts)===null||d===void 0?void 0:d.filter(g=>g.executableCode).map(g=>g.executableCode).filter(g=>g!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var n,t,r,a,o,l,h,d,u;if(((a=(r=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(d=(h=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||h===void 0?void 0:h.parts)===null||d===void 0?void 0:d.filter(g=>g.codeExecutionResult).map(g=>g.codeExecutionResult).filter(g=>g!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.output}}class rj{}class aj{}class a${}class s${}class sj{}class oj{}class lj{}class o${}class cj{}class uj{}class dj{}class l${}class x1{constructor(n){const t={};for(const r of n.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=n}json(){return this.responseInternal.json()}}class c${}class u${}class d${get text(){var n,t,r;let a="",o=!1;const l=[];for(const h of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[d,u]of Object.entries(h))d!=="text"&&d!=="thought"&&u!==null&&l.push(d);if(typeof h.text=="string"){if(typeof h.thought=="boolean"&&h.thought)continue;o=!0,a+=h.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?a:void 0}get data(){var n,t,r;let a="";const o=[];for(const l of(r=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[h,d]of Object.entries(l))h!=="inlineData"&&d!==null&&o.push(h);l.inlineData&&typeof l.inlineData.data=="string"&&(a+=atob(l.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class h$ extends Sg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new zb(Hf.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(n){var t,r,a,o;let l,h="",d={};if(this.apiClient.isVertexAI()){const u=W5(this.apiClient,n);return h=Xt("cachedContents",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>Qx(this.apiClient,f))}else{const u=C5(this.apiClient,n);return h=Xt("cachedContents",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>Wx(this.apiClient,f))}}async get(n){var t,r,a,o;let l,h="",d={};if(this.apiClient.isVertexAI()){const u=Q5(this.apiClient,n);return h=Xt("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>Qx(this.apiClient,f))}else{const u=k5(this.apiClient,n);return h=Xt("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>Wx(this.apiClient,f))}}async delete(n){var t,r,a,o;let l,h="",d={};if(this.apiClient.isVertexAI()){const u=J5(this.apiClient,n);return h=Xt("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(()=>{const f=i$(),g=new uj;return Object.assign(g,f),g})}else{const u=E5(this.apiClient,n);return h=Xt("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(()=>{const f=t$(),g=new uj;return Object.assign(g,f),g})}}async update(n){var t,r,a,o;let l,h="",d={};if(this.apiClient.isVertexAI()){const u=X5(this.apiClient,n);return h=Xt("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>Qx(this.apiClient,f))}else{const u=A5(this.apiClient,n);return h=Xt("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>Wx(this.apiClient,f))}}async listInternal(n){var t,r,a,o;let l,h="",d={};if(this.apiClient.isVertexAI()){const u=e$(this.apiClient,n);return h=Xt("cachedContents",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const g=r$(this.apiClient,f),b=new dj;return Object.assign(b,g),b})}else{const u=P5(this.apiClient,n);return h=Xt("cachedContents",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>{const g=n$(this.apiClient,f),b=new dj;return Object.assign(b,g),b})}}}function hj(e){var n=typeof Symbol=="function"&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function Vr(e){return this instanceof Vr?(this.v=e,this):new Vr(e)}function hb(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(e,n||[]),a,o=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),h("next"),h("throw"),h("return",l),a[Symbol.asyncIterator]=function(){return this},a;function l(v){return function(S){return Promise.resolve(S).then(v,g)}}function h(v,S){r[v]&&(a[v]=function(k){return new Promise(function(T,E){o.push([v,k,T,E])>1||d(v,k)})},S&&(a[v]=S(a[v])))}function d(v,S){try{u(r[v](S))}catch(k){b(o[0][3],k)}}function u(v){v.value instanceof Vr?Promise.resolve(v.value.v).then(f,g):b(o[0][2],v)}function f(v){d("next",v)}function g(v){d("throw",v)}function b(v,S){v(S),o.shift(),o.length&&d(o[0][0],o[0][1])}}function b1(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e[Symbol.asyncIterator],t;return n?n.call(e):(e=typeof hj=="function"?hj(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=e[o]&&function(l){return new Promise(function(h,d){l=e[o](l),a(h,d,l.done,l.value)})}}function a(o,l,h,d){Promise.resolve(d).then(function(u){o({value:u,done:h})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function f$(e){var n;if(e.candidates==null||e.candidates.length===0)return!1;const t=(n=e.candidates[0])===null||n===void 0?void 0:n.content;return t===void 0?!1:gk(t)}function gk(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const n of e.parts)if(n===void 0||Object.keys(n).length===0||n.text!==void 0&&n.text==="")return!1;return!0}function p$(e){if(e.length!==0){if(e[0].role!=="user")throw new Error("History must start with a user turn.");for(const n of e)if(n.role!=="user"&&n.role!=="model")throw new Error(`Role must be user or model, but got ${n.role}.`)}}function m$(e){if(e===void 0||e.length===0)return[];const n=[],t=e.length;let r=0,a=e[0];for(;r<t;)if(e[r].role==="user")a=e[r],r++;else{const o=[];let l=!0;for(;r<t&&e[r].role==="model";)o.push(e[r]),l&&!gk(e[r])&&(l=!1),r++;l&&(n.push(a),n.push(...o))}return n}class g${constructor(n,t){this.modelsModule=n,this.apiClient=t}create(n){return new y$(this.apiClient,this.modelsModule,n.model,n.config,n.history)}}class y${constructor(n,t,r,a={},o=[]){this.apiClient=n,this.modelsModule=t,this.model=r,this.config=a,this.history=o,this.sendPromise=Promise.resolve(),p$(o)}async sendMessage(n){var t;await this.sendPromise;const r=Ca(this.apiClient,n.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,l;const d=(l=(o=(await a).candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content,u=d?[d]:[];this.recordHistory(r,u)})(),await this.sendPromise,a}async sendMessageStream(n){var t;await this.sendPromise;const r=Ca(this.apiClient,n.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=n.config)!==null&&t!==void 0?t:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const o=await a;return this.processStreamResponse(o,r)}getHistory(n=!1){return n?m$(this.history):this.history}processStreamResponse(n,t){var r,a;return hb(this,arguments,function*(){var l,h,d,u;const f=[];try{for(var g=!0,b=b1(n),v;v=yield Vr(b.next()),l=v.done,!l;g=!0){u=v.value,g=!1;const S=u;if(f$(S)){const k=(a=(r=S.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;k!==void 0&&f.push(k)}yield yield Vr(S)}}catch(S){h={error:S}}finally{try{!g&&!l&&(d=b.return)&&(yield Vr(d.call(b)))}finally{if(h)throw h.error}}this.recordHistory(t,f)})}recordHistory(n,t){let r=[];t.length>0&&t.every(a=>a.role==="model")?r=t:r.push({role:"model",parts:[]}),this.history.push(n),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function x$(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=j(n,["pageToken"]);return t!==void 0&&o!=null&&_(t,["_query","pageToken"],o),r}function b$(e,n){const t={},r=j(n,["config"]);return r!=null&&_(t,["config"],x$(e,r,t)),t}function v$(e,n){const t={},r=j(n,["details"]);r!=null&&_(t,["details"],r);const a=j(n,["message"]);a!=null&&_(t,["message"],a);const o=j(n,["code"]);return o!=null&&_(t,["code"],o),t}function w$(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=j(n,["mimeType"]);o!=null&&_(t,["mimeType"],o);const l=j(n,["sizeBytes"]);l!=null&&_(t,["sizeBytes"],l);const h=j(n,["createTime"]);h!=null&&_(t,["createTime"],h);const d=j(n,["expirationTime"]);d!=null&&_(t,["expirationTime"],d);const u=j(n,["updateTime"]);u!=null&&_(t,["updateTime"],u);const f=j(n,["sha256Hash"]);f!=null&&_(t,["sha256Hash"],f);const g=j(n,["uri"]);g!=null&&_(t,["uri"],g);const b=j(n,["downloadUri"]);b!=null&&_(t,["downloadUri"],b);const v=j(n,["state"]);v!=null&&_(t,["state"],v);const S=j(n,["source"]);S!=null&&_(t,["source"],S);const k=j(n,["videoMetadata"]);k!=null&&_(t,["videoMetadata"],k);const T=j(n,["error"]);return T!=null&&_(t,["error"],v$(e,T)),t}function N$(e,n){const t={},r=j(n,["file"]);r!=null&&_(t,["file"],w$(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function S$(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["_url","file"],fk(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function j$(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["_url","file"],fk(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function _$(e,n){const t={},r=j(n,["details"]);r!=null&&_(t,["details"],r);const a=j(n,["message"]);a!=null&&_(t,["message"],a);const o=j(n,["code"]);return o!=null&&_(t,["code"],o),t}function v1(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=j(n,["mimeType"]);o!=null&&_(t,["mimeType"],o);const l=j(n,["sizeBytes"]);l!=null&&_(t,["sizeBytes"],l);const h=j(n,["createTime"]);h!=null&&_(t,["createTime"],h);const d=j(n,["expirationTime"]);d!=null&&_(t,["expirationTime"],d);const u=j(n,["updateTime"]);u!=null&&_(t,["updateTime"],u);const f=j(n,["sha256Hash"]);f!=null&&_(t,["sha256Hash"],f);const g=j(n,["uri"]);g!=null&&_(t,["uri"],g);const b=j(n,["downloadUri"]);b!=null&&_(t,["downloadUri"],b);const v=j(n,["state"]);v!=null&&_(t,["state"],v);const S=j(n,["source"]);S!=null&&_(t,["source"],S);const k=j(n,["videoMetadata"]);k!=null&&_(t,["videoMetadata"],k);const T=j(n,["error"]);return T!=null&&_(t,["error"],_$(e,T)),t}function C$(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=j(n,["files"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>v1(e,l))),_(t,["files"],o)}return t}function k$(){return{}}function E$(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class T$ extends Sg{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new zb(Hf.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(n){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(n.file,n.config).then(t=>v1(this.apiClient,t))}async download(n){await this.apiClient.downloadFile(n)}async listInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=b$(this.apiClient,n);return o=Xt("files",h._url),l=h._query,delete h.config,delete h._url,delete h._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const u=C$(this.apiClient,d),f=new l$;return Object.assign(f,u),f})}}async createInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=N$(this.apiClient,n);return o=Xt("upload/v1beta/files",h._url),l=h._query,delete h.config,delete h._url,delete h._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(()=>{const d=k$(),u=new c$;return Object.assign(u,d),u})}}async get(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=S$(this.apiClient,n);return o=Xt("files/{file}",h._url),l=h._query,delete h.config,delete h._url,delete h._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>v1(this.apiClient,d))}}async delete(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=j$(this.apiClient,n);return o=Xt("files/{file}",h._url),l=h._query,delete h.config,delete h._url,delete h._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(()=>{const d=E$(),u=new u$;return Object.assign(u,d),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function A$(e,n){const t={};if(j(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=j(n,["data"]);r!=null&&_(t,["data"],r);const a=j(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function D$(e,n){const t={},r=j(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=j(n,["data"]);a!=null&&_(t,["data"],a);const o=j(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function P$(e,n){const t={};if(j(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=j(n,["thought"]);r!=null&&_(t,["thought"],r);const a=j(n,["inlineData"]);a!=null&&_(t,["inlineData"],A$(e,a));const o=j(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=j(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const h=j(n,["fileData"]);h!=null&&_(t,["fileData"],h);const d=j(n,["functionCall"]);d!=null&&_(t,["functionCall"],d);const u=j(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const f=j(n,["text"]);return f!=null&&_(t,["text"],f),t}function I$(e,n){const t={},r=j(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=j(n,["thought"]);a!=null&&_(t,["thought"],a);const o=j(n,["inlineData"]);o!=null&&_(t,["inlineData"],D$(e,o));const l=j(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const h=j(n,["executableCode"]);h!=null&&_(t,["executableCode"],h);const d=j(n,["fileData"]);d!=null&&_(t,["fileData"],d);const u=j(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const f=j(n,["functionResponse"]);f!=null&&_(t,["functionResponse"],f);const g=j(n,["text"]);return g!=null&&_(t,["text"],g),t}function M$(e,n){const t={},r=j(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>P$(e,l))),_(t,["parts"],o)}const a=j(n,["role"]);return a!=null&&_(t,["role"],a),t}function R$(e,n){const t={},r=j(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>I$(e,l))),_(t,["parts"],o)}const a=j(n,["role"]);return a!=null&&_(t,["role"],a),t}function O$(){return{}}function L$(){return{}}function F$(e,n){const t={},r=j(n,["mode"]);r!=null&&_(t,["mode"],r);const a=j(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function $$(e,n){const t={},r=j(n,["mode"]);r!=null&&_(t,["mode"],r);const a=j(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function z$(e,n){const t={},r=j(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],F$(e,r)),t}function B$(e,n){const t={},r=j(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],$$(e,r)),t}function U$(){return{}}function q$(e,n){const t={},r=j(n,["apiKeyString"]);return r!=null&&_(t,["apiKeyString"],r),t}function V$(e,n){const t={},r=j(n,["apiKeyConfig"]);r!=null&&_(t,["apiKeyConfig"],q$(e,r));const a=j(n,["authType"]);a!=null&&_(t,["authType"],a);const o=j(n,["googleServiceAccountConfig"]);o!=null&&_(t,["googleServiceAccountConfig"],o);const l=j(n,["httpBasicAuthConfig"]);l!=null&&_(t,["httpBasicAuthConfig"],l);const h=j(n,["oauthConfig"]);h!=null&&_(t,["oauthConfig"],h);const d=j(n,["oidcConfig"]);return d!=null&&_(t,["oidcConfig"],d),t}function H$(e,n){const t={},r=j(n,["authConfig"]);return r!=null&&_(t,["authConfig"],V$(e,r)),t}function G$(e,n){const t={};if(j(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");j(n,["googleSearch"])!=null&&_(t,["googleSearch"],O$());const a=j(n,["googleSearchRetrieval"]);if(a!=null&&_(t,["googleSearchRetrieval"],z$(e,a)),j(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(j(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=j(n,["codeExecution"]);o!=null&&_(t,["codeExecution"],o);const l=j(n,["functionDeclarations"]);return l!=null&&_(t,["functionDeclarations"],l),t}function Y$(e,n){const t={},r=j(n,["retrieval"]);r!=null&&_(t,["retrieval"],r),j(n,["googleSearch"])!=null&&_(t,["googleSearch"],L$());const o=j(n,["googleSearchRetrieval"]);o!=null&&_(t,["googleSearchRetrieval"],B$(e,o)),j(n,["enterpriseWebSearch"])!=null&&_(t,["enterpriseWebSearch"],U$());const h=j(n,["googleMaps"]);h!=null&&_(t,["googleMaps"],H$(e,h));const d=j(n,["codeExecution"]);d!=null&&_(t,["codeExecution"],d);const u=j(n,["functionDeclarations"]);return u!=null&&_(t,["functionDeclarations"],u),t}function W$(e,n){const t={},r=j(n,["handle"]);if(r!=null&&_(t,["handle"],r),j(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function Q$(e,n){const t={},r=j(n,["handle"]);r!=null&&_(t,["handle"],r);const a=j(n,["transparent"]);return a!=null&&_(t,["transparent"],a),t}function fj(){return{}}function pj(){return{}}function J$(e,n){const t={},r=j(n,["disabled"]);r!=null&&_(t,["disabled"],r);const a=j(n,["startOfSpeechSensitivity"]);a!=null&&_(t,["startOfSpeechSensitivity"],a);const o=j(n,["endOfSpeechSensitivity"]);o!=null&&_(t,["endOfSpeechSensitivity"],o);const l=j(n,["prefixPaddingMs"]);l!=null&&_(t,["prefixPaddingMs"],l);const h=j(n,["silenceDurationMs"]);return h!=null&&_(t,["silenceDurationMs"],h),t}function K$(e,n){const t={},r=j(n,["disabled"]);r!=null&&_(t,["disabled"],r);const a=j(n,["startOfSpeechSensitivity"]);a!=null&&_(t,["startOfSpeechSensitivity"],a);const o=j(n,["endOfSpeechSensitivity"]);o!=null&&_(t,["endOfSpeechSensitivity"],o);const l=j(n,["prefixPaddingMs"]);l!=null&&_(t,["prefixPaddingMs"],l);const h=j(n,["silenceDurationMs"]);return h!=null&&_(t,["silenceDurationMs"],h),t}function X$(e,n){const t={},r=j(n,["automaticActivityDetection"]);r!=null&&_(t,["automaticActivityDetection"],J$(e,r));const a=j(n,["activityHandling"]);a!=null&&_(t,["activityHandling"],a);const o=j(n,["turnCoverage"]);return o!=null&&_(t,["turnCoverage"],o),t}function Z$(e,n){const t={},r=j(n,["automaticActivityDetection"]);r!=null&&_(t,["automaticActivityDetection"],K$(e,r));const a=j(n,["activityHandling"]);a!=null&&_(t,["activityHandling"],a);const o=j(n,["turnCoverage"]);return o!=null&&_(t,["turnCoverage"],o),t}function ez(e,n){const t={},r=j(n,["targetTokens"]);return r!=null&&_(t,["targetTokens"],r),t}function tz(e,n){const t={},r=j(n,["targetTokens"]);return r!=null&&_(t,["targetTokens"],r),t}function nz(e,n){const t={},r=j(n,["triggerTokens"]);r!=null&&_(t,["triggerTokens"],r);const a=j(n,["slidingWindow"]);return a!=null&&_(t,["slidingWindow"],ez(e,a)),t}function iz(e,n){const t={},r=j(n,["triggerTokens"]);r!=null&&_(t,["triggerTokens"],r);const a=j(n,["slidingWindow"]);return a!=null&&_(t,["slidingWindow"],tz(e,a)),t}function rz(e,n,t){const r={},a=j(n,["generationConfig"]);t!==void 0&&a!=null&&_(t,["setup","generationConfig"],a);const o=j(n,["responseModalities"]);t!==void 0&&o!=null&&_(t,["setup","generationConfig","responseModalities"],o);const l=j(n,["temperature"]);t!==void 0&&l!=null&&_(t,["setup","generationConfig","temperature"],l);const h=j(n,["topP"]);t!==void 0&&h!=null&&_(t,["setup","generationConfig","topP"],h);const d=j(n,["topK"]);t!==void 0&&d!=null&&_(t,["setup","generationConfig","topK"],d);const u=j(n,["maxOutputTokens"]);t!==void 0&&u!=null&&_(t,["setup","generationConfig","maxOutputTokens"],u);const f=j(n,["mediaResolution"]);t!==void 0&&f!=null&&_(t,["setup","generationConfig","mediaResolution"],f);const g=j(n,["seed"]);t!==void 0&&g!=null&&_(t,["setup","generationConfig","seed"],g);const b=j(n,["speechConfig"]);t!==void 0&&b!=null&&_(t,["setup","generationConfig","speechConfig"],b);const v=j(n,["systemInstruction"]);t!==void 0&&v!=null&&_(t,["setup","systemInstruction"],M$(e,Ca(e,v)));const S=j(n,["tools"]);if(t!==void 0&&S!=null){let q=$b(e,S);Array.isArray(q)&&(q=q.map($=>G$(e,Fb(e,$)))),_(t,["setup","tools"],q)}const k=j(n,["sessionResumption"]);t!==void 0&&k!=null&&_(t,["setup","sessionResumption"],W$(e,k));const T=j(n,["inputAudioTranscription"]);t!==void 0&&T!=null&&_(t,["setup","inputAudioTranscription"],fj());const E=j(n,["outputAudioTranscription"]);t!==void 0&&E!=null&&_(t,["setup","outputAudioTranscription"],fj());const P=j(n,["realtimeInputConfig"]);t!==void 0&&P!=null&&_(t,["setup","realtimeInputConfig"],X$(e,P));const I=j(n,["contextWindowCompression"]);return t!==void 0&&I!=null&&_(t,["setup","contextWindowCompression"],nz(e,I)),r}function az(e,n,t){const r={},a=j(n,["generationConfig"]);t!==void 0&&a!=null&&_(t,["setup","generationConfig"],a);const o=j(n,["responseModalities"]);t!==void 0&&o!=null&&_(t,["setup","generationConfig","responseModalities"],o);const l=j(n,["temperature"]);t!==void 0&&l!=null&&_(t,["setup","generationConfig","temperature"],l);const h=j(n,["topP"]);t!==void 0&&h!=null&&_(t,["setup","generationConfig","topP"],h);const d=j(n,["topK"]);t!==void 0&&d!=null&&_(t,["setup","generationConfig","topK"],d);const u=j(n,["maxOutputTokens"]);t!==void 0&&u!=null&&_(t,["setup","generationConfig","maxOutputTokens"],u);const f=j(n,["mediaResolution"]);t!==void 0&&f!=null&&_(t,["setup","generationConfig","mediaResolution"],f);const g=j(n,["seed"]);t!==void 0&&g!=null&&_(t,["setup","generationConfig","seed"],g);const b=j(n,["speechConfig"]);t!==void 0&&b!=null&&_(t,["setup","generationConfig","speechConfig"],b);const v=j(n,["systemInstruction"]);t!==void 0&&v!=null&&_(t,["setup","systemInstruction"],R$(e,Ca(e,v)));const S=j(n,["tools"]);if(t!==void 0&&S!=null){let q=$b(e,S);Array.isArray(q)&&(q=q.map($=>Y$(e,Fb(e,$)))),_(t,["setup","tools"],q)}const k=j(n,["sessionResumption"]);t!==void 0&&k!=null&&_(t,["setup","sessionResumption"],Q$(e,k));const T=j(n,["inputAudioTranscription"]);t!==void 0&&T!=null&&_(t,["setup","inputAudioTranscription"],pj());const E=j(n,["outputAudioTranscription"]);t!==void 0&&E!=null&&_(t,["setup","outputAudioTranscription"],pj());const P=j(n,["realtimeInputConfig"]);t!==void 0&&P!=null&&_(t,["setup","realtimeInputConfig"],Z$(e,P));const I=j(n,["contextWindowCompression"]);return t!==void 0&&I!=null&&_(t,["setup","contextWindowCompression"],iz(e,I)),r}function sz(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["setup","model"],Di(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],rz(e,a,t)),t}function oz(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["setup","model"],Di(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],az(e,a,t)),t}function lz(){return{}}function cz(){return{}}function uz(){return{}}function dz(){return{}}function hz(e,n){const t={},r=j(n,["media"]);r!=null&&_(t,["mediaChunks"],ok(e,r));const a=j(n,["audio"]);a!=null&&_(t,["audio"],d5(e,a));const o=j(n,["audioStreamEnd"]);o!=null&&_(t,["audioStreamEnd"],o);const l=j(n,["video"]);l!=null&&_(t,["video"],u5(e,l));const h=j(n,["text"]);return h!=null&&_(t,["text"],h),j(n,["activityStart"])!=null&&_(t,["activityStart"],lz()),j(n,["activityEnd"])!=null&&_(t,["activityEnd"],uz()),t}function fz(e,n){const t={},r=j(n,["media"]);if(r!=null&&_(t,["mediaChunks"],ok(e,r)),j(n,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const a=j(n,["audioStreamEnd"]);if(a!=null&&_(t,["audioStreamEnd"],a),j(n,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(j(n,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return j(n,["activityStart"])!=null&&_(t,["activityStart"],cz()),j(n,["activityEnd"])!=null&&_(t,["activityEnd"],dz()),t}function pz(){return{}}function mz(){return{}}function gz(e,n){const t={},r=j(n,["data"]);r!=null&&_(t,["data"],r);const a=j(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function yz(e,n){const t={},r=j(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=j(n,["data"]);a!=null&&_(t,["data"],a);const o=j(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function xz(e,n){const t={},r=j(n,["thought"]);r!=null&&_(t,["thought"],r);const a=j(n,["inlineData"]);a!=null&&_(t,["inlineData"],gz(e,a));const o=j(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=j(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const h=j(n,["fileData"]);h!=null&&_(t,["fileData"],h);const d=j(n,["functionCall"]);d!=null&&_(t,["functionCall"],d);const u=j(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const f=j(n,["text"]);return f!=null&&_(t,["text"],f),t}function bz(e,n){const t={},r=j(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=j(n,["thought"]);a!=null&&_(t,["thought"],a);const o=j(n,["inlineData"]);o!=null&&_(t,["inlineData"],yz(e,o));const l=j(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const h=j(n,["executableCode"]);h!=null&&_(t,["executableCode"],h);const d=j(n,["fileData"]);d!=null&&_(t,["fileData"],d);const u=j(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const f=j(n,["functionResponse"]);f!=null&&_(t,["functionResponse"],f);const g=j(n,["text"]);return g!=null&&_(t,["text"],g),t}function vz(e,n){const t={},r=j(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>xz(e,l))),_(t,["parts"],o)}const a=j(n,["role"]);return a!=null&&_(t,["role"],a),t}function wz(e,n){const t={},r=j(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>bz(e,l))),_(t,["parts"],o)}const a=j(n,["role"]);return a!=null&&_(t,["role"],a),t}function mj(e,n){const t={},r=j(n,["text"]);r!=null&&_(t,["text"],r);const a=j(n,["finished"]);return a!=null&&_(t,["finished"],a),t}function gj(e,n){const t={},r=j(n,["text"]);r!=null&&_(t,["text"],r);const a=j(n,["finished"]);return a!=null&&_(t,["finished"],a),t}function Nz(e,n){const t={},r=j(n,["modelTurn"]);r!=null&&_(t,["modelTurn"],vz(e,r));const a=j(n,["turnComplete"]);a!=null&&_(t,["turnComplete"],a);const o=j(n,["interrupted"]);o!=null&&_(t,["interrupted"],o);const l=j(n,["groundingMetadata"]);l!=null&&_(t,["groundingMetadata"],l);const h=j(n,["generationComplete"]);h!=null&&_(t,["generationComplete"],h);const d=j(n,["inputTranscription"]);d!=null&&_(t,["inputTranscription"],mj(e,d));const u=j(n,["outputTranscription"]);return u!=null&&_(t,["outputTranscription"],mj(e,u)),t}function Sz(e,n){const t={},r=j(n,["modelTurn"]);r!=null&&_(t,["modelTurn"],wz(e,r));const a=j(n,["turnComplete"]);a!=null&&_(t,["turnComplete"],a);const o=j(n,["interrupted"]);o!=null&&_(t,["interrupted"],o);const l=j(n,["groundingMetadata"]);l!=null&&_(t,["groundingMetadata"],l);const h=j(n,["generationComplete"]);h!=null&&_(t,["generationComplete"],h);const d=j(n,["inputTranscription"]);d!=null&&_(t,["inputTranscription"],gj(e,d));const u=j(n,["outputTranscription"]);return u!=null&&_(t,["outputTranscription"],gj(e,u)),t}function jz(e,n){const t={},r=j(n,["id"]);r!=null&&_(t,["id"],r);const a=j(n,["args"]);a!=null&&_(t,["args"],a);const o=j(n,["name"]);return o!=null&&_(t,["name"],o),t}function _z(e,n){const t={},r=j(n,["args"]);r!=null&&_(t,["args"],r);const a=j(n,["name"]);return a!=null&&_(t,["name"],a),t}function Cz(e,n){const t={},r=j(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>jz(e,o))),_(t,["functionCalls"],a)}return t}function kz(e,n){const t={},r=j(n,["functionCalls"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>_z(e,o))),_(t,["functionCalls"],a)}return t}function Ez(e,n){const t={},r=j(n,["ids"]);return r!=null&&_(t,["ids"],r),t}function Tz(e,n){const t={},r=j(n,["ids"]);return r!=null&&_(t,["ids"],r),t}function Ex(e,n){const t={},r=j(n,["modality"]);r!=null&&_(t,["modality"],r);const a=j(n,["tokenCount"]);return a!=null&&_(t,["tokenCount"],a),t}function Tx(e,n){const t={},r=j(n,["modality"]);r!=null&&_(t,["modality"],r);const a=j(n,["tokenCount"]);return a!=null&&_(t,["tokenCount"],a),t}function Az(e,n){const t={},r=j(n,["promptTokenCount"]);r!=null&&_(t,["promptTokenCount"],r);const a=j(n,["cachedContentTokenCount"]);a!=null&&_(t,["cachedContentTokenCount"],a);const o=j(n,["responseTokenCount"]);o!=null&&_(t,["responseTokenCount"],o);const l=j(n,["toolUsePromptTokenCount"]);l!=null&&_(t,["toolUsePromptTokenCount"],l);const h=j(n,["thoughtsTokenCount"]);h!=null&&_(t,["thoughtsTokenCount"],h);const d=j(n,["totalTokenCount"]);d!=null&&_(t,["totalTokenCount"],d);const u=j(n,["promptTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(S=>Ex(e,S))),_(t,["promptTokensDetails"],v)}const f=j(n,["cacheTokensDetails"]);if(f!=null){let v=f;Array.isArray(v)&&(v=v.map(S=>Ex(e,S))),_(t,["cacheTokensDetails"],v)}const g=j(n,["responseTokensDetails"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(S=>Ex(e,S))),_(t,["responseTokensDetails"],v)}const b=j(n,["toolUsePromptTokensDetails"]);if(b!=null){let v=b;Array.isArray(v)&&(v=v.map(S=>Ex(e,S))),_(t,["toolUsePromptTokensDetails"],v)}return t}function Dz(e,n){const t={},r=j(n,["promptTokenCount"]);r!=null&&_(t,["promptTokenCount"],r);const a=j(n,["cachedContentTokenCount"]);a!=null&&_(t,["cachedContentTokenCount"],a);const o=j(n,["candidatesTokenCount"]);o!=null&&_(t,["responseTokenCount"],o);const l=j(n,["toolUsePromptTokenCount"]);l!=null&&_(t,["toolUsePromptTokenCount"],l);const h=j(n,["thoughtsTokenCount"]);h!=null&&_(t,["thoughtsTokenCount"],h);const d=j(n,["totalTokenCount"]);d!=null&&_(t,["totalTokenCount"],d);const u=j(n,["promptTokensDetails"]);if(u!=null){let S=u;Array.isArray(S)&&(S=S.map(k=>Tx(e,k))),_(t,["promptTokensDetails"],S)}const f=j(n,["cacheTokensDetails"]);if(f!=null){let S=f;Array.isArray(S)&&(S=S.map(k=>Tx(e,k))),_(t,["cacheTokensDetails"],S)}const g=j(n,["candidatesTokensDetails"]);if(g!=null){let S=g;Array.isArray(S)&&(S=S.map(k=>Tx(e,k))),_(t,["responseTokensDetails"],S)}const b=j(n,["toolUsePromptTokensDetails"]);if(b!=null){let S=b;Array.isArray(S)&&(S=S.map(k=>Tx(e,k))),_(t,["toolUsePromptTokensDetails"],S)}const v=j(n,["trafficType"]);return v!=null&&_(t,["trafficType"],v),t}function Pz(e,n){const t={},r=j(n,["timeLeft"]);return r!=null&&_(t,["timeLeft"],r),t}function Iz(e,n){const t={},r=j(n,["timeLeft"]);return r!=null&&_(t,["timeLeft"],r),t}function Mz(e,n){const t={},r=j(n,["newHandle"]);r!=null&&_(t,["newHandle"],r);const a=j(n,["resumable"]);a!=null&&_(t,["resumable"],a);const o=j(n,["lastConsumedClientMessageIndex"]);return o!=null&&_(t,["lastConsumedClientMessageIndex"],o),t}function Rz(e,n){const t={},r=j(n,["newHandle"]);r!=null&&_(t,["newHandle"],r);const a=j(n,["resumable"]);a!=null&&_(t,["resumable"],a);const o=j(n,["lastConsumedClientMessageIndex"]);return o!=null&&_(t,["lastConsumedClientMessageIndex"],o),t}function Oz(e,n){const t={};j(n,["setupComplete"])!=null&&_(t,["setupComplete"],pz());const a=j(n,["serverContent"]);a!=null&&_(t,["serverContent"],Nz(e,a));const o=j(n,["toolCall"]);o!=null&&_(t,["toolCall"],Cz(e,o));const l=j(n,["toolCallCancellation"]);l!=null&&_(t,["toolCallCancellation"],Ez(e,l));const h=j(n,["usageMetadata"]);h!=null&&_(t,["usageMetadata"],Az(e,h));const d=j(n,["goAway"]);d!=null&&_(t,["goAway"],Pz(e,d));const u=j(n,["sessionResumptionUpdate"]);return u!=null&&_(t,["sessionResumptionUpdate"],Mz(e,u)),t}function Lz(e,n){const t={};j(n,["setupComplete"])!=null&&_(t,["setupComplete"],mz());const a=j(n,["serverContent"]);a!=null&&_(t,["serverContent"],Sz(e,a));const o=j(n,["toolCall"]);o!=null&&_(t,["toolCall"],kz(e,o));const l=j(n,["toolCallCancellation"]);l!=null&&_(t,["toolCallCancellation"],Tz(e,l));const h=j(n,["usageMetadata"]);h!=null&&_(t,["usageMetadata"],Dz(e,h));const d=j(n,["goAway"]);d!=null&&_(t,["goAway"],Iz(e,d));const u=j(n,["sessionResumptionUpdate"]);return u!=null&&_(t,["sessionResumptionUpdate"],Rz(e,u)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Fz(e,n){const t={};if(j(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=j(n,["data"]);r!=null&&_(t,["data"],r);const a=j(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function $z(e,n){const t={};if(j(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=j(n,["thought"]);r!=null&&_(t,["thought"],r);const a=j(n,["inlineData"]);a!=null&&_(t,["inlineData"],Fz(e,a));const o=j(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=j(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const h=j(n,["fileData"]);h!=null&&_(t,["fileData"],h);const d=j(n,["functionCall"]);d!=null&&_(t,["functionCall"],d);const u=j(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const f=j(n,["text"]);return f!=null&&_(t,["text"],f),t}function Bb(e,n){const t={},r=j(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>$z(e,l))),_(t,["parts"],o)}const a=j(n,["role"]);return a!=null&&_(t,["role"],a),t}function zz(e,n){const t={};if(j(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=j(n,["category"]);r!=null&&_(t,["category"],r);const a=j(n,["threshold"]);return a!=null&&_(t,["threshold"],a),t}function Bz(){return{}}function Uz(e,n){const t={},r=j(n,["mode"]);r!=null&&_(t,["mode"],r);const a=j(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function qz(e,n){const t={},r=j(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],Uz(e,r)),t}function Vz(e,n){const t={};if(j(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");j(n,["googleSearch"])!=null&&_(t,["googleSearch"],Bz());const a=j(n,["googleSearchRetrieval"]);if(a!=null&&_(t,["googleSearchRetrieval"],qz(e,a)),j(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(j(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=j(n,["codeExecution"]);o!=null&&_(t,["codeExecution"],o);const l=j(n,["functionDeclarations"]);return l!=null&&_(t,["functionDeclarations"],l),t}function Hz(e,n){const t={},r=j(n,["mode"]);r!=null&&_(t,["mode"],r);const a=j(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function Gz(e,n){const t={},r=j(n,["functionCallingConfig"]);if(r!=null&&_(t,["functionCallingConfig"],Hz(e,r)),j(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function Yz(e,n){const t={},r=j(n,["voiceName"]);return r!=null&&_(t,["voiceName"],r),t}function Wz(e,n){const t={},r=j(n,["prebuiltVoiceConfig"]);return r!=null&&_(t,["prebuiltVoiceConfig"],Yz(e,r)),t}function Qz(e,n){const t={},r=j(n,["voiceConfig"]);r!=null&&_(t,["voiceConfig"],Wz(e,r));const a=j(n,["languageCode"]);return a!=null&&_(t,["languageCode"],a),t}function Jz(e,n){const t={},r=j(n,["includeThoughts"]);r!=null&&_(t,["includeThoughts"],r);const a=j(n,["thinkingBudget"]);return a!=null&&_(t,["thinkingBudget"],a),t}function Kz(e,n,t){const r={},a=j(n,["systemInstruction"]);t!==void 0&&a!=null&&_(t,["systemInstruction"],Bb(e,Ca(e,a)));const o=j(n,["temperature"]);o!=null&&_(r,["temperature"],o);const l=j(n,["topP"]);l!=null&&_(r,["topP"],l);const h=j(n,["topK"]);h!=null&&_(r,["topK"],h);const d=j(n,["candidateCount"]);d!=null&&_(r,["candidateCount"],d);const u=j(n,["maxOutputTokens"]);u!=null&&_(r,["maxOutputTokens"],u);const f=j(n,["stopSequences"]);f!=null&&_(r,["stopSequences"],f);const g=j(n,["responseLogprobs"]);g!=null&&_(r,["responseLogprobs"],g);const b=j(n,["logprobs"]);b!=null&&_(r,["logprobs"],b);const v=j(n,["presencePenalty"]);v!=null&&_(r,["presencePenalty"],v);const S=j(n,["frequencyPenalty"]);S!=null&&_(r,["frequencyPenalty"],S);const k=j(n,["seed"]);k!=null&&_(r,["seed"],k);const T=j(n,["responseMimeType"]);T!=null&&_(r,["responseMimeType"],T);const E=j(n,["responseSchema"]);if(E!=null&&_(r,["responseSchema"],uk(e,E)),j(n,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(j(n,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=j(n,["safetySettings"]);if(t!==void 0&&P!=null){let R=P;Array.isArray(R)&&(R=R.map(U=>zz(e,U))),_(t,["safetySettings"],R)}const I=j(n,["tools"]);if(t!==void 0&&I!=null){let R=$b(e,I);Array.isArray(R)&&(R=R.map(U=>Vz(e,Fb(e,U)))),_(t,["tools"],R)}const q=j(n,["toolConfig"]);if(t!==void 0&&q!=null&&_(t,["toolConfig"],Gz(e,q)),j(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const $=j(n,["cachedContent"]);t!==void 0&&$!=null&&_(t,["cachedContent"],xu(e,$));const L=j(n,["responseModalities"]);L!=null&&_(r,["responseModalities"],L);const F=j(n,["mediaResolution"]);F!=null&&_(r,["mediaResolution"],F);const z=j(n,["speechConfig"]);if(z!=null&&_(r,["speechConfig"],Qz(e,dk(e,z))),j(n,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const B=j(n,["thinkingConfig"]);return B!=null&&_(r,["thinkingConfig"],Jz(e,B)),r}function yj(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],Di(e,r));const a=j(n,["contents"]);if(a!=null){let l=yu(e,a);Array.isArray(l)&&(l=l.map(h=>Bb(e,h))),_(t,["contents"],l)}const o=j(n,["config"]);return o!=null&&_(t,["generationConfig"],Kz(e,o,t)),t}function Xz(e,n,t){const r={},a=j(n,["taskType"]);t!==void 0&&a!=null&&_(t,["requests[]","taskType"],a);const o=j(n,["title"]);t!==void 0&&o!=null&&_(t,["requests[]","title"],o);const l=j(n,["outputDimensionality"]);if(t!==void 0&&l!=null&&_(t,["requests[]","outputDimensionality"],l),j(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(j(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function Zz(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],Di(e,r));const a=j(n,["contents"]);a!=null&&_(t,["requests[]","content"],ck(e,a));const o=j(n,["config"]);o!=null&&_(t,["config"],Xz(e,o,t));const l=j(n,["model"]);return l!==void 0&&_(t,["requests[]","model"],Di(e,l)),t}function e8(e,n,t){const r={};if(j(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(j(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const a=j(n,["numberOfImages"]);t!==void 0&&a!=null&&_(t,["parameters","sampleCount"],a);const o=j(n,["aspectRatio"]);t!==void 0&&o!=null&&_(t,["parameters","aspectRatio"],o);const l=j(n,["guidanceScale"]);if(t!==void 0&&l!=null&&_(t,["parameters","guidanceScale"],l),j(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const h=j(n,["safetyFilterLevel"]);t!==void 0&&h!=null&&_(t,["parameters","safetySetting"],h);const d=j(n,["personGeneration"]);t!==void 0&&d!=null&&_(t,["parameters","personGeneration"],d);const u=j(n,["includeSafetyAttributes"]);t!==void 0&&u!=null&&_(t,["parameters","includeSafetyAttributes"],u);const f=j(n,["includeRaiReason"]);t!==void 0&&f!=null&&_(t,["parameters","includeRaiReason"],f);const g=j(n,["language"]);t!==void 0&&g!=null&&_(t,["parameters","language"],g);const b=j(n,["outputMimeType"]);t!==void 0&&b!=null&&_(t,["parameters","outputOptions","mimeType"],b);const v=j(n,["outputCompressionQuality"]);if(t!==void 0&&v!=null&&_(t,["parameters","outputOptions","compressionQuality"],v),j(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(j(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function t8(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],Di(e,r));const a=j(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=j(n,["config"]);return o!=null&&_(t,["config"],e8(e,o,t)),t}function n8(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","name"],Di(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function i8(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=j(n,["pageToken"]);t!==void 0&&o!=null&&_(t,["_query","pageToken"],o);const l=j(n,["filter"]);t!==void 0&&l!=null&&_(t,["_query","filter"],l);const h=j(n,["queryBase"]);return t!==void 0&&h!=null&&_(t,["_url","models_url"],pk(e,h)),r}function r8(e,n){const t={},r=j(n,["config"]);return r!=null&&_(t,["config"],i8(e,r,t)),t}function a8(e,n,t){const r={},a=j(n,["displayName"]);t!==void 0&&a!=null&&_(t,["displayName"],a);const o=j(n,["description"]);t!==void 0&&o!=null&&_(t,["description"],o);const l=j(n,["defaultCheckpointId"]);return t!==void 0&&l!=null&&_(t,["defaultCheckpointId"],l),r}function s8(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","name"],Di(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a8(e,a,t)),t}function o8(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","name"],Di(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function l8(e,n){const t={};if(j(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(j(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(j(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function c8(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],Di(e,r));const a=j(n,["contents"]);if(a!=null){let l=yu(e,a);Array.isArray(l)&&(l=l.map(h=>Bb(e,h))),_(t,["contents"],l)}const o=j(n,["config"]);return o!=null&&_(t,["config"],l8(e,o)),t}function u8(e,n){const t={};if(j(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=j(n,["imageBytes"]);r!=null&&_(t,["bytesBase64Encoded"],bu(e,r));const a=j(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function d8(e,n,t){const r={},a=j(n,["numberOfVideos"]);if(t!==void 0&&a!=null&&_(t,["parameters","sampleCount"],a),j(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(j(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=j(n,["durationSeconds"]);if(t!==void 0&&o!=null&&_(t,["parameters","durationSeconds"],o),j(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=j(n,["aspectRatio"]);if(t!==void 0&&l!=null&&_(t,["parameters","aspectRatio"],l),j(n,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const h=j(n,["personGeneration"]);if(t!==void 0&&h!=null&&_(t,["parameters","personGeneration"],h),j(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const d=j(n,["negativePrompt"]);if(t!==void 0&&d!=null&&_(t,["parameters","negativePrompt"],d),j(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function h8(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],Di(e,r));const a=j(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=j(n,["image"]);o!=null&&_(t,["instances[0]","image"],u8(e,o));const l=j(n,["config"]);return l!=null&&_(t,["config"],d8(e,l,t)),t}function f8(e,n){const t={},r=j(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=j(n,["data"]);a!=null&&_(t,["data"],a);const o=j(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function p8(e,n){const t={},r=j(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=j(n,["thought"]);a!=null&&_(t,["thought"],a);const o=j(n,["inlineData"]);o!=null&&_(t,["inlineData"],f8(e,o));const l=j(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const h=j(n,["executableCode"]);h!=null&&_(t,["executableCode"],h);const d=j(n,["fileData"]);d!=null&&_(t,["fileData"],d);const u=j(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const f=j(n,["functionResponse"]);f!=null&&_(t,["functionResponse"],f);const g=j(n,["text"]);return g!=null&&_(t,["text"],g),t}function tp(e,n){const t={},r=j(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>p8(e,l))),_(t,["parts"],o)}const a=j(n,["role"]);return a!=null&&_(t,["role"],a),t}function m8(e,n){const t={},r=j(n,["featureSelectionPreference"]);return r!=null&&_(t,["featureSelectionPreference"],r),t}function g8(e,n){const t={},r=j(n,["method"]);r!=null&&_(t,["method"],r);const a=j(n,["category"]);a!=null&&_(t,["category"],a);const o=j(n,["threshold"]);return o!=null&&_(t,["threshold"],o),t}function y8(){return{}}function x8(e,n){const t={},r=j(n,["mode"]);r!=null&&_(t,["mode"],r);const a=j(n,["dynamicThreshold"]);return a!=null&&_(t,["dynamicThreshold"],a),t}function b8(e,n){const t={},r=j(n,["dynamicRetrievalConfig"]);return r!=null&&_(t,["dynamicRetrievalConfig"],x8(e,r)),t}function v8(){return{}}function w8(e,n){const t={},r=j(n,["apiKeyString"]);return r!=null&&_(t,["apiKeyString"],r),t}function N8(e,n){const t={},r=j(n,["apiKeyConfig"]);r!=null&&_(t,["apiKeyConfig"],w8(e,r));const a=j(n,["authType"]);a!=null&&_(t,["authType"],a);const o=j(n,["googleServiceAccountConfig"]);o!=null&&_(t,["googleServiceAccountConfig"],o);const l=j(n,["httpBasicAuthConfig"]);l!=null&&_(t,["httpBasicAuthConfig"],l);const h=j(n,["oauthConfig"]);h!=null&&_(t,["oauthConfig"],h);const d=j(n,["oidcConfig"]);return d!=null&&_(t,["oidcConfig"],d),t}function S8(e,n){const t={},r=j(n,["authConfig"]);return r!=null&&_(t,["authConfig"],N8(e,r)),t}function yk(e,n){const t={},r=j(n,["retrieval"]);r!=null&&_(t,["retrieval"],r),j(n,["googleSearch"])!=null&&_(t,["googleSearch"],y8());const o=j(n,["googleSearchRetrieval"]);o!=null&&_(t,["googleSearchRetrieval"],b8(e,o)),j(n,["enterpriseWebSearch"])!=null&&_(t,["enterpriseWebSearch"],v8());const h=j(n,["googleMaps"]);h!=null&&_(t,["googleMaps"],S8(e,h));const d=j(n,["codeExecution"]);d!=null&&_(t,["codeExecution"],d);const u=j(n,["functionDeclarations"]);return u!=null&&_(t,["functionDeclarations"],u),t}function j8(e,n){const t={},r=j(n,["mode"]);r!=null&&_(t,["mode"],r);const a=j(n,["allowedFunctionNames"]);return a!=null&&_(t,["allowedFunctionNames"],a),t}function _8(e,n){const t={},r=j(n,["latitude"]);r!=null&&_(t,["latitude"],r);const a=j(n,["longitude"]);return a!=null&&_(t,["longitude"],a),t}function C8(e,n){const t={},r=j(n,["latLng"]);return r!=null&&_(t,["latLng"],_8(e,r)),t}function k8(e,n){const t={},r=j(n,["functionCallingConfig"]);r!=null&&_(t,["functionCallingConfig"],j8(e,r));const a=j(n,["retrievalConfig"]);return a!=null&&_(t,["retrievalConfig"],C8(e,a)),t}function E8(e,n){const t={},r=j(n,["voiceName"]);return r!=null&&_(t,["voiceName"],r),t}function T8(e,n){const t={},r=j(n,["prebuiltVoiceConfig"]);return r!=null&&_(t,["prebuiltVoiceConfig"],E8(e,r)),t}function A8(e,n){const t={},r=j(n,["voiceConfig"]);r!=null&&_(t,["voiceConfig"],T8(e,r));const a=j(n,["languageCode"]);return a!=null&&_(t,["languageCode"],a),t}function D8(e,n){const t={},r=j(n,["includeThoughts"]);r!=null&&_(t,["includeThoughts"],r);const a=j(n,["thinkingBudget"]);return a!=null&&_(t,["thinkingBudget"],a),t}function P8(e,n,t){const r={},a=j(n,["systemInstruction"]);t!==void 0&&a!=null&&_(t,["systemInstruction"],tp(e,Ca(e,a)));const o=j(n,["temperature"]);o!=null&&_(r,["temperature"],o);const l=j(n,["topP"]);l!=null&&_(r,["topP"],l);const h=j(n,["topK"]);h!=null&&_(r,["topK"],h);const d=j(n,["candidateCount"]);d!=null&&_(r,["candidateCount"],d);const u=j(n,["maxOutputTokens"]);u!=null&&_(r,["maxOutputTokens"],u);const f=j(n,["stopSequences"]);f!=null&&_(r,["stopSequences"],f);const g=j(n,["responseLogprobs"]);g!=null&&_(r,["responseLogprobs"],g);const b=j(n,["logprobs"]);b!=null&&_(r,["logprobs"],b);const v=j(n,["presencePenalty"]);v!=null&&_(r,["presencePenalty"],v);const S=j(n,["frequencyPenalty"]);S!=null&&_(r,["frequencyPenalty"],S);const k=j(n,["seed"]);k!=null&&_(r,["seed"],k);const T=j(n,["responseMimeType"]);T!=null&&_(r,["responseMimeType"],T);const E=j(n,["responseSchema"]);E!=null&&_(r,["responseSchema"],uk(e,E));const P=j(n,["routingConfig"]);P!=null&&_(r,["routingConfig"],P);const I=j(n,["modelSelectionConfig"]);I!=null&&_(r,["modelConfig"],m8(e,I));const q=j(n,["safetySettings"]);if(t!==void 0&&q!=null){let ne=q;Array.isArray(ne)&&(ne=ne.map(ae=>g8(e,ae))),_(t,["safetySettings"],ne)}const $=j(n,["tools"]);if(t!==void 0&&$!=null){let ne=$b(e,$);Array.isArray(ne)&&(ne=ne.map(ae=>yk(e,Fb(e,ae)))),_(t,["tools"],ne)}const L=j(n,["toolConfig"]);t!==void 0&&L!=null&&_(t,["toolConfig"],k8(e,L));const F=j(n,["labels"]);t!==void 0&&F!=null&&_(t,["labels"],F);const z=j(n,["cachedContent"]);t!==void 0&&z!=null&&_(t,["cachedContent"],xu(e,z));const B=j(n,["responseModalities"]);B!=null&&_(r,["responseModalities"],B);const R=j(n,["mediaResolution"]);R!=null&&_(r,["mediaResolution"],R);const U=j(n,["speechConfig"]);U!=null&&_(r,["speechConfig"],A8(e,dk(e,U)));const Y=j(n,["audioTimestamp"]);Y!=null&&_(r,["audioTimestamp"],Y);const Z=j(n,["thinkingConfig"]);return Z!=null&&_(r,["thinkingConfig"],D8(e,Z)),r}function xj(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],Di(e,r));const a=j(n,["contents"]);if(a!=null){let l=yu(e,a);Array.isArray(l)&&(l=l.map(h=>tp(e,h))),_(t,["contents"],l)}const o=j(n,["config"]);return o!=null&&_(t,["generationConfig"],P8(e,o,t)),t}function I8(e,n,t){const r={},a=j(n,["taskType"]);t!==void 0&&a!=null&&_(t,["instances[]","task_type"],a);const o=j(n,["title"]);t!==void 0&&o!=null&&_(t,["instances[]","title"],o);const l=j(n,["outputDimensionality"]);t!==void 0&&l!=null&&_(t,["parameters","outputDimensionality"],l);const h=j(n,["mimeType"]);t!==void 0&&h!=null&&_(t,["instances[]","mimeType"],h);const d=j(n,["autoTruncate"]);return t!==void 0&&d!=null&&_(t,["parameters","autoTruncate"],d),r}function M8(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],Di(e,r));const a=j(n,["contents"]);a!=null&&_(t,["instances[]","content"],ck(e,a));const o=j(n,["config"]);return o!=null&&_(t,["config"],I8(e,o,t)),t}function R8(e,n,t){const r={},a=j(n,["outputGcsUri"]);t!==void 0&&a!=null&&_(t,["parameters","storageUri"],a);const o=j(n,["negativePrompt"]);t!==void 0&&o!=null&&_(t,["parameters","negativePrompt"],o);const l=j(n,["numberOfImages"]);t!==void 0&&l!=null&&_(t,["parameters","sampleCount"],l);const h=j(n,["aspectRatio"]);t!==void 0&&h!=null&&_(t,["parameters","aspectRatio"],h);const d=j(n,["guidanceScale"]);t!==void 0&&d!=null&&_(t,["parameters","guidanceScale"],d);const u=j(n,["seed"]);t!==void 0&&u!=null&&_(t,["parameters","seed"],u);const f=j(n,["safetyFilterLevel"]);t!==void 0&&f!=null&&_(t,["parameters","safetySetting"],f);const g=j(n,["personGeneration"]);t!==void 0&&g!=null&&_(t,["parameters","personGeneration"],g);const b=j(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&_(t,["parameters","includeSafetyAttributes"],b);const v=j(n,["includeRaiReason"]);t!==void 0&&v!=null&&_(t,["parameters","includeRaiReason"],v);const S=j(n,["language"]);t!==void 0&&S!=null&&_(t,["parameters","language"],S);const k=j(n,["outputMimeType"]);t!==void 0&&k!=null&&_(t,["parameters","outputOptions","mimeType"],k);const T=j(n,["outputCompressionQuality"]);t!==void 0&&T!=null&&_(t,["parameters","outputOptions","compressionQuality"],T);const E=j(n,["addWatermark"]);t!==void 0&&E!=null&&_(t,["parameters","addWatermark"],E);const P=j(n,["enhancePrompt"]);return t!==void 0&&P!=null&&_(t,["parameters","enhancePrompt"],P),r}function O8(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],Di(e,r));const a=j(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=j(n,["config"]);return o!=null&&_(t,["config"],R8(e,o,t)),t}function Dw(e,n){const t={},r=j(n,["gcsUri"]);r!=null&&_(t,["gcsUri"],r);const a=j(n,["imageBytes"]);a!=null&&_(t,["bytesBase64Encoded"],bu(e,a));const o=j(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function L8(e,n){const t={},r=j(n,["maskMode"]);r!=null&&_(t,["maskMode"],r);const a=j(n,["segmentationClasses"]);a!=null&&_(t,["maskClasses"],a);const o=j(n,["maskDilation"]);return o!=null&&_(t,["dilation"],o),t}function F8(e,n){const t={},r=j(n,["controlType"]);r!=null&&_(t,["controlType"],r);const a=j(n,["enableControlImageComputation"]);return a!=null&&_(t,["computeControl"],a),t}function $8(e,n){const t={},r=j(n,["styleDescription"]);return r!=null&&_(t,["styleDescription"],r),t}function z8(e,n){const t={},r=j(n,["subjectType"]);r!=null&&_(t,["subjectType"],r);const a=j(n,["subjectDescription"]);return a!=null&&_(t,["subjectDescription"],a),t}function B8(e,n){const t={},r=j(n,["referenceImage"]);r!=null&&_(t,["referenceImage"],Dw(e,r));const a=j(n,["referenceId"]);a!=null&&_(t,["referenceId"],a);const o=j(n,["referenceType"]);o!=null&&_(t,["referenceType"],o);const l=j(n,["maskImageConfig"]);l!=null&&_(t,["maskImageConfig"],L8(e,l));const h=j(n,["controlImageConfig"]);h!=null&&_(t,["controlImageConfig"],F8(e,h));const d=j(n,["styleImageConfig"]);d!=null&&_(t,["styleImageConfig"],$8(e,d));const u=j(n,["subjectImageConfig"]);return u!=null&&_(t,["subjectImageConfig"],z8(e,u)),t}function U8(e,n,t){const r={},a=j(n,["outputGcsUri"]);t!==void 0&&a!=null&&_(t,["parameters","storageUri"],a);const o=j(n,["negativePrompt"]);t!==void 0&&o!=null&&_(t,["parameters","negativePrompt"],o);const l=j(n,["numberOfImages"]);t!==void 0&&l!=null&&_(t,["parameters","sampleCount"],l);const h=j(n,["aspectRatio"]);t!==void 0&&h!=null&&_(t,["parameters","aspectRatio"],h);const d=j(n,["guidanceScale"]);t!==void 0&&d!=null&&_(t,["parameters","guidanceScale"],d);const u=j(n,["seed"]);t!==void 0&&u!=null&&_(t,["parameters","seed"],u);const f=j(n,["safetyFilterLevel"]);t!==void 0&&f!=null&&_(t,["parameters","safetySetting"],f);const g=j(n,["personGeneration"]);t!==void 0&&g!=null&&_(t,["parameters","personGeneration"],g);const b=j(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&_(t,["parameters","includeSafetyAttributes"],b);const v=j(n,["includeRaiReason"]);t!==void 0&&v!=null&&_(t,["parameters","includeRaiReason"],v);const S=j(n,["language"]);t!==void 0&&S!=null&&_(t,["parameters","language"],S);const k=j(n,["outputMimeType"]);t!==void 0&&k!=null&&_(t,["parameters","outputOptions","mimeType"],k);const T=j(n,["outputCompressionQuality"]);t!==void 0&&T!=null&&_(t,["parameters","outputOptions","compressionQuality"],T);const E=j(n,["editMode"]);t!==void 0&&E!=null&&_(t,["parameters","editMode"],E);const P=j(n,["baseSteps"]);return t!==void 0&&P!=null&&_(t,["parameters","editConfig","baseSteps"],P),r}function q8(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],Di(e,r));const a=j(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=j(n,["referenceImages"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(d=>B8(e,d))),_(t,["instances[0]","referenceImages"],h)}const l=j(n,["config"]);return l!=null&&_(t,["config"],U8(e,l,t)),t}function V8(e,n,t){const r={},a=j(n,["includeRaiReason"]);t!==void 0&&a!=null&&_(t,["parameters","includeRaiReason"],a);const o=j(n,["outputMimeType"]);t!==void 0&&o!=null&&_(t,["parameters","outputOptions","mimeType"],o);const l=j(n,["outputCompressionQuality"]);t!==void 0&&l!=null&&_(t,["parameters","outputOptions","compressionQuality"],l);const h=j(n,["numberOfImages"]);t!==void 0&&h!=null&&_(t,["parameters","sampleCount"],h);const d=j(n,["mode"]);return t!==void 0&&d!=null&&_(t,["parameters","mode"],d),r}function H8(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],Di(e,r));const a=j(n,["image"]);a!=null&&_(t,["instances[0]","image"],Dw(e,a));const o=j(n,["upscaleFactor"]);o!=null&&_(t,["parameters","upscaleConfig","upscaleFactor"],o);const l=j(n,["config"]);return l!=null&&_(t,["config"],V8(e,l,t)),t}function G8(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","name"],Di(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function Y8(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=j(n,["pageToken"]);t!==void 0&&o!=null&&_(t,["_query","pageToken"],o);const l=j(n,["filter"]);t!==void 0&&l!=null&&_(t,["_query","filter"],l);const h=j(n,["queryBase"]);return t!==void 0&&h!=null&&_(t,["_url","models_url"],pk(e,h)),r}function W8(e,n){const t={},r=j(n,["config"]);return r!=null&&_(t,["config"],Y8(e,r,t)),t}function Q8(e,n,t){const r={},a=j(n,["displayName"]);t!==void 0&&a!=null&&_(t,["displayName"],a);const o=j(n,["description"]);t!==void 0&&o!=null&&_(t,["description"],o);const l=j(n,["defaultCheckpointId"]);return t!==void 0&&l!=null&&_(t,["defaultCheckpointId"],l),r}function J8(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],Di(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],Q8(e,a,t)),t}function K8(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","name"],Di(e,r));const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function X8(e,n,t){const r={},a=j(n,["systemInstruction"]);t!==void 0&&a!=null&&_(t,["systemInstruction"],tp(e,Ca(e,a)));const o=j(n,["tools"]);if(t!==void 0&&o!=null){let h=o;Array.isArray(h)&&(h=h.map(d=>yk(e,d))),_(t,["tools"],h)}const l=j(n,["generationConfig"]);return t!==void 0&&l!=null&&_(t,["generationConfig"],l),r}function Z8(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],Di(e,r));const a=j(n,["contents"]);if(a!=null){let l=yu(e,a);Array.isArray(l)&&(l=l.map(h=>tp(e,h))),_(t,["contents"],l)}const o=j(n,["config"]);return o!=null&&_(t,["config"],X8(e,o,t)),t}function eB(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],Di(e,r));const a=j(n,["contents"]);if(a!=null){let l=yu(e,a);Array.isArray(l)&&(l=l.map(h=>tp(e,h))),_(t,["contents"],l)}const o=j(n,["config"]);return o!=null&&_(t,["config"],o),t}function tB(e,n,t){const r={},a=j(n,["numberOfVideos"]);t!==void 0&&a!=null&&_(t,["parameters","sampleCount"],a);const o=j(n,["outputGcsUri"]);t!==void 0&&o!=null&&_(t,["parameters","storageUri"],o);const l=j(n,["fps"]);t!==void 0&&l!=null&&_(t,["parameters","fps"],l);const h=j(n,["durationSeconds"]);t!==void 0&&h!=null&&_(t,["parameters","durationSeconds"],h);const d=j(n,["seed"]);t!==void 0&&d!=null&&_(t,["parameters","seed"],d);const u=j(n,["aspectRatio"]);t!==void 0&&u!=null&&_(t,["parameters","aspectRatio"],u);const f=j(n,["resolution"]);t!==void 0&&f!=null&&_(t,["parameters","resolution"],f);const g=j(n,["personGeneration"]);t!==void 0&&g!=null&&_(t,["parameters","personGeneration"],g);const b=j(n,["pubsubTopic"]);t!==void 0&&b!=null&&_(t,["parameters","pubsubTopic"],b);const v=j(n,["negativePrompt"]);t!==void 0&&v!=null&&_(t,["parameters","negativePrompt"],v);const S=j(n,["enhancePrompt"]);return t!==void 0&&S!=null&&_(t,["parameters","enhancePrompt"],S),r}function nB(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["_url","model"],Di(e,r));const a=j(n,["prompt"]);a!=null&&_(t,["instances[0]","prompt"],a);const o=j(n,["image"]);o!=null&&_(t,["instances[0]","image"],Dw(e,o));const l=j(n,["config"]);return l!=null&&_(t,["config"],tB(e,l,t)),t}function iB(e,n){const t={},r=j(n,["data"]);r!=null&&_(t,["data"],r);const a=j(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function rB(e,n){const t={},r=j(n,["thought"]);r!=null&&_(t,["thought"],r);const a=j(n,["inlineData"]);a!=null&&_(t,["inlineData"],iB(e,a));const o=j(n,["codeExecutionResult"]);o!=null&&_(t,["codeExecutionResult"],o);const l=j(n,["executableCode"]);l!=null&&_(t,["executableCode"],l);const h=j(n,["fileData"]);h!=null&&_(t,["fileData"],h);const d=j(n,["functionCall"]);d!=null&&_(t,["functionCall"],d);const u=j(n,["functionResponse"]);u!=null&&_(t,["functionResponse"],u);const f=j(n,["text"]);return f!=null&&_(t,["text"],f),t}function aB(e,n){const t={},r=j(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>rB(e,l))),_(t,["parts"],o)}const a=j(n,["role"]);return a!=null&&_(t,["role"],a),t}function sB(e,n){const t={},r=j(n,["citationSources"]);return r!=null&&_(t,["citations"],r),t}function oB(e,n){const t={},r=j(n,["content"]);r!=null&&_(t,["content"],aB(e,r));const a=j(n,["citationMetadata"]);a!=null&&_(t,["citationMetadata"],sB(e,a));const o=j(n,["tokenCount"]);o!=null&&_(t,["tokenCount"],o);const l=j(n,["finishReason"]);l!=null&&_(t,["finishReason"],l);const h=j(n,["avgLogprobs"]);h!=null&&_(t,["avgLogprobs"],h);const d=j(n,["groundingMetadata"]);d!=null&&_(t,["groundingMetadata"],d);const u=j(n,["index"]);u!=null&&_(t,["index"],u);const f=j(n,["logprobsResult"]);f!=null&&_(t,["logprobsResult"],f);const g=j(n,["safetyRatings"]);return g!=null&&_(t,["safetyRatings"],g),t}function bj(e,n){const t={},r=j(n,["candidates"]);if(r!=null){let h=r;Array.isArray(h)&&(h=h.map(d=>oB(e,d))),_(t,["candidates"],h)}const a=j(n,["modelVersion"]);a!=null&&_(t,["modelVersion"],a);const o=j(n,["promptFeedback"]);o!=null&&_(t,["promptFeedback"],o);const l=j(n,["usageMetadata"]);return l!=null&&_(t,["usageMetadata"],l),t}function lB(e,n){const t={},r=j(n,["values"]);return r!=null&&_(t,["values"],r),t}function cB(){return{}}function uB(e,n){const t={},r=j(n,["embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>lB(e,l))),_(t,["embeddings"],o)}return j(n,["metadata"])!=null&&_(t,["metadata"],cB()),t}function dB(e,n){const t={},r=j(n,["bytesBase64Encoded"]);r!=null&&_(t,["imageBytes"],bu(e,r));const a=j(n,["mimeType"]);return a!=null&&_(t,["mimeType"],a),t}function xk(e,n){const t={},r=j(n,["safetyAttributes","categories"]);r!=null&&_(t,["categories"],r);const a=j(n,["safetyAttributes","scores"]);a!=null&&_(t,["scores"],a);const o=j(n,["contentType"]);return o!=null&&_(t,["contentType"],o),t}function hB(e,n){const t={},r=j(n,["_self"]);r!=null&&_(t,["image"],dB(e,r));const a=j(n,["raiFilteredReason"]);a!=null&&_(t,["raiFilteredReason"],a);const o=j(n,["_self"]);return o!=null&&_(t,["safetyAttributes"],xk(e,o)),t}function fB(e,n){const t={},r=j(n,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>hB(e,l))),_(t,["generatedImages"],o)}const a=j(n,["positivePromptSafetyAttributes"]);return a!=null&&_(t,["positivePromptSafetyAttributes"],xk(e,a)),t}function pB(e,n){const t={},r=j(n,["baseModel"]);r!=null&&_(t,["baseModel"],r);const a=j(n,["createTime"]);a!=null&&_(t,["createTime"],a);const o=j(n,["updateTime"]);return o!=null&&_(t,["updateTime"],o),t}function w1(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=j(n,["description"]);o!=null&&_(t,["description"],o);const l=j(n,["version"]);l!=null&&_(t,["version"],l);const h=j(n,["_self"]);h!=null&&_(t,["tunedModelInfo"],pB(e,h));const d=j(n,["inputTokenLimit"]);d!=null&&_(t,["inputTokenLimit"],d);const u=j(n,["outputTokenLimit"]);u!=null&&_(t,["outputTokenLimit"],u);const f=j(n,["supportedGenerationMethods"]);return f!=null&&_(t,["supportedActions"],f),t}function mB(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=j(n,["_self"]);if(a!=null){let o=mk(e,a);Array.isArray(o)&&(o=o.map(l=>w1(e,l))),_(t,["models"],o)}return t}function gB(){return{}}function yB(e,n){const t={},r=j(n,["totalTokens"]);r!=null&&_(t,["totalTokens"],r);const a=j(n,["cachedContentTokenCount"]);return a!=null&&_(t,["cachedContentTokenCount"],a),t}function xB(e,n){const t={},r=j(n,["video","uri"]);r!=null&&_(t,["uri"],r);const a=j(n,["video","encodedVideo"]);a!=null&&_(t,["videoBytes"],bu(e,a));const o=j(n,["encoding"]);return o!=null&&_(t,["mimeType"],o),t}function bB(e,n){const t={},r=j(n,["_self"]);return r!=null&&_(t,["video"],xB(e,r)),t}function vB(e,n){const t={},r=j(n,["generatedSamples"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(h=>bB(e,h))),_(t,["generatedVideos"],l)}const a=j(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const o=j(n,["raiMediaFilteredReasons"]);return o!=null&&_(t,["raiMediaFilteredReasons"],o),t}function wB(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=j(n,["done"]);o!=null&&_(t,["done"],o);const l=j(n,["error"]);l!=null&&_(t,["error"],l);const h=j(n,["response","generateVideoResponse"]);return h!=null&&_(t,["response"],vB(e,h)),t}function NB(e,n){const t={},r=j(n,["displayName"]);r!=null&&_(t,["displayName"],r);const a=j(n,["data"]);a!=null&&_(t,["data"],a);const o=j(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function SB(e,n){const t={},r=j(n,["videoMetadata"]);r!=null&&_(t,["videoMetadata"],r);const a=j(n,["thought"]);a!=null&&_(t,["thought"],a);const o=j(n,["inlineData"]);o!=null&&_(t,["inlineData"],NB(e,o));const l=j(n,["codeExecutionResult"]);l!=null&&_(t,["codeExecutionResult"],l);const h=j(n,["executableCode"]);h!=null&&_(t,["executableCode"],h);const d=j(n,["fileData"]);d!=null&&_(t,["fileData"],d);const u=j(n,["functionCall"]);u!=null&&_(t,["functionCall"],u);const f=j(n,["functionResponse"]);f!=null&&_(t,["functionResponse"],f);const g=j(n,["text"]);return g!=null&&_(t,["text"],g),t}function jB(e,n){const t={},r=j(n,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>SB(e,l))),_(t,["parts"],o)}const a=j(n,["role"]);return a!=null&&_(t,["role"],a),t}function _B(e,n){const t={},r=j(n,["citations"]);return r!=null&&_(t,["citations"],r),t}function CB(e,n){const t={},r=j(n,["content"]);r!=null&&_(t,["content"],jB(e,r));const a=j(n,["citationMetadata"]);a!=null&&_(t,["citationMetadata"],_B(e,a));const o=j(n,["finishMessage"]);o!=null&&_(t,["finishMessage"],o);const l=j(n,["finishReason"]);l!=null&&_(t,["finishReason"],l);const h=j(n,["avgLogprobs"]);h!=null&&_(t,["avgLogprobs"],h);const d=j(n,["groundingMetadata"]);d!=null&&_(t,["groundingMetadata"],d);const u=j(n,["index"]);u!=null&&_(t,["index"],u);const f=j(n,["logprobsResult"]);f!=null&&_(t,["logprobsResult"],f);const g=j(n,["safetyRatings"]);return g!=null&&_(t,["safetyRatings"],g),t}function vj(e,n){const t={},r=j(n,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(f=>CB(e,f))),_(t,["candidates"],u)}const a=j(n,["createTime"]);a!=null&&_(t,["createTime"],a);const o=j(n,["responseId"]);o!=null&&_(t,["responseId"],o);const l=j(n,["modelVersion"]);l!=null&&_(t,["modelVersion"],l);const h=j(n,["promptFeedback"]);h!=null&&_(t,["promptFeedback"],h);const d=j(n,["usageMetadata"]);return d!=null&&_(t,["usageMetadata"],d),t}function kB(e,n){const t={},r=j(n,["truncated"]);r!=null&&_(t,["truncated"],r);const a=j(n,["token_count"]);return a!=null&&_(t,["tokenCount"],a),t}function EB(e,n){const t={},r=j(n,["values"]);r!=null&&_(t,["values"],r);const a=j(n,["statistics"]);return a!=null&&_(t,["statistics"],kB(e,a)),t}function TB(e,n){const t={},r=j(n,["billableCharacterCount"]);return r!=null&&_(t,["billableCharacterCount"],r),t}function AB(e,n){const t={},r=j(n,["predictions[]","embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>EB(e,l))),_(t,["embeddings"],o)}const a=j(n,["metadata"]);return a!=null&&_(t,["metadata"],TB(e,a)),t}function DB(e,n){const t={},r=j(n,["gcsUri"]);r!=null&&_(t,["gcsUri"],r);const a=j(n,["bytesBase64Encoded"]);a!=null&&_(t,["imageBytes"],bu(e,a));const o=j(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function bk(e,n){const t={},r=j(n,["safetyAttributes","categories"]);r!=null&&_(t,["categories"],r);const a=j(n,["safetyAttributes","scores"]);a!=null&&_(t,["scores"],a);const o=j(n,["contentType"]);return o!=null&&_(t,["contentType"],o),t}function Pw(e,n){const t={},r=j(n,["_self"]);r!=null&&_(t,["image"],DB(e,r));const a=j(n,["raiFilteredReason"]);a!=null&&_(t,["raiFilteredReason"],a);const o=j(n,["_self"]);o!=null&&_(t,["safetyAttributes"],bk(e,o));const l=j(n,["prompt"]);return l!=null&&_(t,["enhancedPrompt"],l),t}function PB(e,n){const t={},r=j(n,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Pw(e,l))),_(t,["generatedImages"],o)}const a=j(n,["positivePromptSafetyAttributes"]);return a!=null&&_(t,["positivePromptSafetyAttributes"],bk(e,a)),t}function IB(e,n){const t={},r=j(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>Pw(e,o))),_(t,["generatedImages"],a)}return t}function MB(e,n){const t={},r=j(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>Pw(e,o))),_(t,["generatedImages"],a)}return t}function RB(e,n){const t={},r=j(n,["endpoint"]);r!=null&&_(t,["name"],r);const a=j(n,["deployedModelId"]);return a!=null&&_(t,["deployedModelId"],a),t}function OB(e,n){const t={},r=j(n,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&_(t,["baseModel"],r);const a=j(n,["createTime"]);a!=null&&_(t,["createTime"],a);const o=j(n,["updateTime"]);return o!=null&&_(t,["updateTime"],o),t}function LB(e,n){const t={},r=j(n,["checkpointId"]);r!=null&&_(t,["checkpointId"],r);const a=j(n,["epoch"]);a!=null&&_(t,["epoch"],a);const o=j(n,["step"]);return o!=null&&_(t,["step"],o),t}function N1(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["displayName"]);a!=null&&_(t,["displayName"],a);const o=j(n,["description"]);o!=null&&_(t,["description"],o);const l=j(n,["versionId"]);l!=null&&_(t,["version"],l);const h=j(n,["deployedModels"]);if(h!=null){let b=h;Array.isArray(b)&&(b=b.map(v=>RB(e,v))),_(t,["endpoints"],b)}const d=j(n,["labels"]);d!=null&&_(t,["labels"],d);const u=j(n,["_self"]);u!=null&&_(t,["tunedModelInfo"],OB(e,u));const f=j(n,["defaultCheckpointId"]);f!=null&&_(t,["defaultCheckpointId"],f);const g=j(n,["checkpoints"]);if(g!=null){let b=g;Array.isArray(b)&&(b=b.map(v=>LB(e,v))),_(t,["checkpoints"],b)}return t}function FB(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=j(n,["_self"]);if(a!=null){let o=mk(e,a);Array.isArray(o)&&(o=o.map(l=>N1(e,l))),_(t,["models"],o)}return t}function $B(){return{}}function zB(e,n){const t={},r=j(n,["totalTokens"]);return r!=null&&_(t,["totalTokens"],r),t}function BB(e,n){const t={},r=j(n,["tokensInfo"]);return r!=null&&_(t,["tokensInfo"],r),t}function UB(e,n){const t={},r=j(n,["gcsUri"]);r!=null&&_(t,["uri"],r);const a=j(n,["bytesBase64Encoded"]);a!=null&&_(t,["videoBytes"],bu(e,a));const o=j(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function qB(e,n){const t={},r=j(n,["_self"]);return r!=null&&_(t,["video"],UB(e,r)),t}function VB(e,n){const t={},r=j(n,["videos"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(h=>qB(e,h))),_(t,["generatedVideos"],l)}const a=j(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const o=j(n,["raiMediaFilteredReasons"]);return o!=null&&_(t,["raiMediaFilteredReasons"],o),t}function HB(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=j(n,["done"]);o!=null&&_(t,["done"],o);const l=j(n,["error"]);l!=null&&_(t,["error"],l);const h=j(n,["response"]);return h!=null&&_(t,["response"],VB(e,h)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const GB="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function YB(e,n,t){const r=new d$;let a;if(t.data instanceof Blob?a=JSON.parse(await t.data.text()):a=JSON.parse(t.data),e.isVertexAI()){const o=Lz(e,a);Object.assign(r,o)}else{const o=Oz(e,a);Object.assign(r,o)}n(r)}class WB{constructor(n,t,r){this.apiClient=n,this.auth=t,this.webSocketFactory=r}async connect(n){var t,r,a,o;const l=this.apiClient.getWebsocketBaseUrl(),h=this.apiClient.getApiVersion();let d;const u=XB(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())d=`${l}/ws/google.cloud.aiplatform.${h}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(u);else{const q=this.apiClient.getApiKey();d=`${l}/ws/google.ai.generativelanguage.${h}.GenerativeService.BidiGenerateContent?key=${q}`}let f=()=>{};const g=new Promise(q=>{f=q}),b=n.callbacks,v=function(){var q;(q=b==null?void 0:b.onopen)===null||q===void 0||q.call(b),f({})},S=this.apiClient,k={onopen:v,onmessage:q=>{YB(S,b.onmessage,q)},onerror:(t=b==null?void 0:b.onerror)!==null&&t!==void 0?t:function(q){},onclose:(r=b==null?void 0:b.onclose)!==null&&r!==void 0?r:function(q){}},T=this.webSocketFactory.create(d,KB(u),k);T.connect(),await g;let E=Di(this.apiClient,n.model);if(this.apiClient.isVertexAI()&&E.startsWith("publishers/")){const q=this.apiClient.getProject(),$=this.apiClient.getLocation();E=`projects/${q}/locations/${$}/`+E}let P={};this.apiClient.isVertexAI()&&((a=n.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(n.config===void 0?n.config={responseModalities:[Yf.AUDIO]}:n.config.responseModalities=[Yf.AUDIO]),!((o=n.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const I={model:E,config:n.config,callbacks:n.callbacks};return this.apiClient.isVertexAI()?P=oz(this.apiClient,I):P=sz(this.apiClient,I),delete P.config,T.send(JSON.stringify(P)),new JB(T,this.apiClient)}}const QB={turnComplete:!0};class JB{constructor(n,t){this.conn=n,this.apiClient=t}tLiveClientContent(n,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=yu(n,t.turns),n.isVertexAI()?r=r.map(a=>tp(n,a)):r=r.map(a=>Bb(n,a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(n,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const o of r){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!n.isVertexAI()&&!("id"in o))throw new Error(GB)}return{toolResponse:{functionResponses:r}}}sendClientContent(n){n=Object.assign(Object.assign({},QB),n);const t=this.tLiveClientContent(this.apiClient,n);this.conn.send(JSON.stringify(t))}sendRealtimeInput(n){let t={};this.apiClient.isVertexAI()?t={realtimeInput:fz(this.apiClient,n)}:t={realtimeInput:hz(this.apiClient,n)},this.conn.send(JSON.stringify(t))}sendToolResponse(n){if(n.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,n);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function KB(e){const n={};return e.forEach((t,r)=>{n[r]=t}),n}function XB(e){const n=new Headers;for(const[t,r]of Object.entries(e))n.append(t,r);return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ZB extends Sg{constructor(n){super(),this.apiClient=n,this.generateContent=async t=>await this.generateContentInternal(t),this.generateContentStream=async t=>await this.generateContentStreamInternal(t),this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var a;let o;const l=[];if(r!=null&&r.generatedImages)for(const d of r.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((a=d==null?void 0:d.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?o=d==null?void 0:d.safetyAttributes:l.push(d);let h;return o?h={generatedImages:l,positivePromptSafetyAttributes:o}:h={generatedImages:l},h}),this.list=async t=>{var r;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((r=l.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new zb(Hf.PAGED_ITEM_MODELS,h=>this.listInternal(h),await this.listInternal(l),l)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const a={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(a)}}async generateContentInternal(n){var t,r,a,o;let l,h="",d={};if(this.apiClient.isVertexAI()){const u=xj(this.apiClient,n);return h=Xt("{model}:generateContent",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const g=vj(this.apiClient,f),b=new kx;return Object.assign(b,g),b})}else{const u=yj(this.apiClient,n);return h=Xt("{model}:generateContent",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>{const g=bj(this.apiClient,f),b=new kx;return Object.assign(b,g),b})}}async generateContentStreamInternal(n){var t,r,a,o;let l,h="",d={};if(this.apiClient.isVertexAI()){const u=xj(this.apiClient,n);h=Xt("{model}:streamGenerateContent?alt=sse",u._url),d=u._query,delete u.config,delete u._url,delete u._query;const f=this.apiClient;return l=f.requestStream({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}),l.then(function(g){return hb(this,arguments,function*(){var b,v,S,k;try{for(var T=!0,E=b1(g),P;P=yield Vr(E.next()),b=P.done,!b;T=!0){k=P.value,T=!1;const q=vj(f,yield Vr(k.json())),$=new kx;Object.assign($,q),yield yield Vr($)}}catch(I){v={error:I}}finally{try{!T&&!b&&(S=E.return)&&(yield Vr(S.call(E)))}finally{if(v)throw v.error}}})})}else{const u=yj(this.apiClient,n);h=Xt("{model}:streamGenerateContent?alt=sse",u._url),d=u._query,delete u.config,delete u._url,delete u._query;const f=this.apiClient;return l=f.requestStream({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}),l.then(function(g){return hb(this,arguments,function*(){var b,v,S,k;try{for(var T=!0,E=b1(g),P;P=yield Vr(E.next()),b=P.done,!b;T=!0){k=P.value,T=!1;const q=bj(f,yield Vr(k.json())),$=new kx;Object.assign($,q),yield yield Vr($)}}catch(I){v={error:I}}finally{try{!T&&!b&&(S=E.return)&&(yield Vr(S.call(E)))}finally{if(v)throw v.error}}})})}}async embedContent(n){var t,r,a,o;let l,h="",d={};if(this.apiClient.isVertexAI()){const u=M8(this.apiClient,n);return h=Xt("{model}:predict",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const g=AB(this.apiClient,f),b=new rj;return Object.assign(b,g),b})}else{const u=Zz(this.apiClient,n);return h=Xt("{model}:batchEmbedContents",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>{const g=uB(this.apiClient,f),b=new rj;return Object.assign(b,g),b})}}async generateImagesInternal(n){var t,r,a,o;let l,h="",d={};if(this.apiClient.isVertexAI()){const u=O8(this.apiClient,n);return h=Xt("{model}:predict",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const g=PB(this.apiClient,f),b=new aj;return Object.assign(b,g),b})}else{const u=t8(this.apiClient,n);return h=Xt("{model}:predict",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>{const g=fB(this.apiClient,f),b=new aj;return Object.assign(b,g),b})}}async editImageInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const h=q8(this.apiClient,n);return o=Xt("{model}:predict",h._url),l=h._query,delete h.config,delete h._url,delete h._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const u=IB(this.apiClient,d),f=new a$;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const h=H8(this.apiClient,n);return o=Xt("{model}:predict",h._url),l=h._query,delete h.config,delete h._url,delete h._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const u=MB(this.apiClient,d),f=new s$;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(n){var t,r,a,o;let l,h="",d={};if(this.apiClient.isVertexAI()){const u=G8(this.apiClient,n);return h=Xt("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>N1(this.apiClient,f))}else{const u=n8(this.apiClient,n);return h=Xt("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>w1(this.apiClient,f))}}async listInternal(n){var t,r,a,o;let l,h="",d={};if(this.apiClient.isVertexAI()){const u=W8(this.apiClient,n);return h=Xt("{models_url}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const g=FB(this.apiClient,f),b=new sj;return Object.assign(b,g),b})}else{const u=r8(this.apiClient,n);return h=Xt("{models_url}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>{const g=mB(this.apiClient,f),b=new sj;return Object.assign(b,g),b})}}async update(n){var t,r,a,o;let l,h="",d={};if(this.apiClient.isVertexAI()){const u=J8(this.apiClient,n);return h=Xt("{model}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>N1(this.apiClient,f))}else{const u=s8(this.apiClient,n);return h=Xt("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>w1(this.apiClient,f))}}async delete(n){var t,r,a,o;let l,h="",d={};if(this.apiClient.isVertexAI()){const u=K8(this.apiClient,n);return h=Xt("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(()=>{const f=$B(),g=new oj;return Object.assign(g,f),g})}else{const u=o8(this.apiClient,n);return h=Xt("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(()=>{const f=gB(),g=new oj;return Object.assign(g,f),g})}}async countTokens(n){var t,r,a,o;let l,h="",d={};if(this.apiClient.isVertexAI()){const u=Z8(this.apiClient,n);return h=Xt("{model}:countTokens",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const g=zB(this.apiClient,f),b=new lj;return Object.assign(b,g),b})}else{const u=c8(this.apiClient,n);return h=Xt("{model}:countTokens",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>{const g=yB(this.apiClient,f),b=new lj;return Object.assign(b,g),b})}}async computeTokens(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const h=eB(this.apiClient,n);return o=Xt("{model}:computeTokens",h._url),l=h._query,delete h.config,delete h._url,delete h._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const u=BB(this.apiClient,d),f=new o$;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(n){var t,r,a,o;let l,h="",d={};if(this.apiClient.isVertexAI()){const u=nB(this.apiClient,n);return h=Xt("{model}:predictLongRunning",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>HB(this.apiClient,f))}else{const u=h8(this.apiClient,n);return h=Xt("{model}:predictLongRunning",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>wB(this.apiClient,f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eU(e,n){const t={},r=j(n,["operationName"]);r!=null&&_(t,["_url","operationName"],r);const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function tU(e,n){const t={},r=j(n,["operationName"]);r!=null&&_(t,["_url","operationName"],r);const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function nU(e,n){const t={},r=j(n,["operationName"]);r!=null&&_(t,["operationName"],r);const a=j(n,["resourceName"]);a!=null&&_(t,["_url","resourceName"],a);const o=j(n,["config"]);return o!=null&&_(t,["config"],o),t}function iU(e,n){const t={},r=j(n,["video","uri"]);r!=null&&_(t,["uri"],r);const a=j(n,["video","encodedVideo"]);a!=null&&_(t,["videoBytes"],bu(e,a));const o=j(n,["encoding"]);return o!=null&&_(t,["mimeType"],o),t}function rU(e,n){const t={},r=j(n,["_self"]);return r!=null&&_(t,["video"],iU(e,r)),t}function aU(e,n){const t={},r=j(n,["generatedSamples"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(h=>rU(e,h))),_(t,["generatedVideos"],l)}const a=j(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const o=j(n,["raiMediaFilteredReasons"]);return o!=null&&_(t,["raiMediaFilteredReasons"],o),t}function sU(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=j(n,["done"]);o!=null&&_(t,["done"],o);const l=j(n,["error"]);l!=null&&_(t,["error"],l);const h=j(n,["response","generateVideoResponse"]);return h!=null&&_(t,["response"],aU(e,h)),t}function oU(e,n){const t={},r=j(n,["gcsUri"]);r!=null&&_(t,["uri"],r);const a=j(n,["bytesBase64Encoded"]);a!=null&&_(t,["videoBytes"],bu(e,a));const o=j(n,["mimeType"]);return o!=null&&_(t,["mimeType"],o),t}function lU(e,n){const t={},r=j(n,["_self"]);return r!=null&&_(t,["video"],oU(e,r)),t}function cU(e,n){const t={},r=j(n,["videos"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(h=>lU(e,h))),_(t,["generatedVideos"],l)}const a=j(n,["raiMediaFilteredCount"]);a!=null&&_(t,["raiMediaFilteredCount"],a);const o=j(n,["raiMediaFilteredReasons"]);return o!=null&&_(t,["raiMediaFilteredReasons"],o),t}function wj(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=j(n,["done"]);o!=null&&_(t,["done"],o);const l=j(n,["error"]);l!=null&&_(t,["error"],l);const h=j(n,["response"]);return h!=null&&_(t,["response"],cU(e,h)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class uU extends Sg{constructor(n){super(),this.apiClient=n}async getVideosOperation(n){const t=n.operation,r=n.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=t.name.split("/operations/")[0];let o;return r&&"httpOptions"in r&&(o=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:a,config:{httpOptions:o}})}else return this.getVideosOperationInternal({operationName:t.name,config:r})}async getVideosOperationInternal(n){var t,r,a,o;let l,h="",d={};if(this.apiClient.isVertexAI()){const u=tU(this.apiClient,n);return h=Xt("{operationName}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>wj(this.apiClient,f))}else{const u=eU(this.apiClient,n);return h=Xt("{operationName}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>sU(this.apiClient,f))}}async fetchPredictVideosOperationInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const h=nU(this.apiClient,n);return o=Xt("{resourceName}:fetchPredictOperation",h._url),l=h._query,delete h.config,delete h._url,delete h._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>wj(this.apiClient,d))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const dU="Content-Type",hU="X-Server-Timeout",fU="User-Agent",pU="x-goog-api-client",mU="0.14.1",gU=`google-genai-sdk/${mU}`,yU="v1beta1",xU="v1beta",Nj=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class vk extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ClientError"}}class S1 extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ServerError"}}class bU{constructor(n){var t,r;this.clientOptions=Object.assign(Object.assign({},n),{project:n.project,location:n.location,apiKey:n.apiKey,vertexai:n.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:yU,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:xU,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,n.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,n.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var n;return(n=this.clientOptions.vertexai)!==null&&n!==void 0?n:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(n){if(!n||n.baseUrl===void 0||n.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[n.baseUrl.endsWith("/")?n.baseUrl.slice(0,-1):n.baseUrl];return n.apiVersion&&n.apiVersion!==""&&r.push(n.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const n=this.getBaseUrl(),t=new URL(n);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(n){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=n;else throw new Error("HTTP options are not correctly set.")}constructUrl(n,t,r){const a=[this.getRequestUrlInternal(t)];return r&&a.push(this.getBaseResourcePath()),n!==""&&a.push(n),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(n){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||n.path.startsWith("projects/")||n.httpMethod==="GET"&&n.path.startsWith("publishers/google/models"))}async request(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);if(n.queryParams)for(const[l,h]of Object.entries(n.queryParams))a.searchParams.append(l,String(h));let o={};if(n.httpMethod==="GET"){if(n.body&&n.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=n.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,n.abortSignal),this.unaryApiCall(a,o,n.httpMethod)}patchHttpOptions(n,t){const r=JSON.parse(JSON.stringify(n));for(const[a,o]of Object.entries(t))typeof o=="object"?r[a]=Object.assign(Object.assign({},r[a]),o):o!==void 0&&(r[a]=o);return r}async requestStream(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let o={};return o.body=n.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,n.abortSignal),this.streamApiCall(a,o,n.httpMethod)}async includeExtraHttpOptionsToRequestInit(n,t,r){if(t&&t.timeout||r){const a=new AbortController,o=a.signal;t.timeout&&(t==null?void 0:t.timeout)>0&&setTimeout(()=>a.abort(),t.timeout),r&&r.addEventListener("abort",()=>{a.abort()}),n.signal=o}return n.headers=await this.getHeadersInternal(t),n}async unaryApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await Sj(a),new x1(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(n,t,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:r})).then(async a=>(await Sj(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(n){var t;return hb(this,arguments,function*(){const a=(t=n==null?void 0:n.body)===null||t===void 0?void 0:t.getReader(),o=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let l="";for(;;){const{done:h,value:d}=yield Vr(a.read());if(h){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=o.decode(d);try{const g=JSON.parse(u);if("error"in g){const b=JSON.parse(JSON.stringify(g.error)),v=b.status,S=b.code,k=`got status: ${v}. ${JSON.stringify(g)}`;if(S>=400&&S<500)throw new vk(k);if(S>=500&&S<600)throw new S1(k)}}catch(g){const b=g;if(b.name==="ClientError"||b.name==="ServerError")throw g}l+=u;let f=l.match(Nj);for(;f;){const g=f[1];try{const b=new Response(g,{headers:n==null?void 0:n.headers,status:n==null?void 0:n.status,statusText:n==null?void 0:n.statusText});yield yield Vr(new x1(b)),l=l.slice(f[0].length),f=l.match(Nj)}catch(b){throw new Error(`exception parsing stream chunk ${g}. ${b}`)}}}}finally{a.releaseLock()}})}async apiCall(n,t){return fetch(n,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const n={},t=gU+" "+this.clientOptions.userAgentExtra;return n[fU]=t,n[pU]=t,n[dU]="application/json",n}async getHeadersInternal(n){const t=new Headers;if(n&&n.headers){for(const[r,a]of Object.entries(n.headers))t.append(r,a);n.timeout&&n.timeout>0&&t.append(hU,String(Math.ceil(n.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(n,t){var r;const a={};t!=null&&(a.mimeType=t.mimeType,a.name=t.name,a.displayName=t.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const o=this.clientOptions.uploader,l=await o.stat(n);a.sizeBytes=String(l.size);const h=(r=t==null?void 0:t.mimeType)!==null&&r!==void 0?r:l.type;if(h===void 0||h==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=h;const d=await this.fetchUploadUrl(a,t);return o.upload(n,d,this)}async downloadFile(n){await this.clientOptions.downloader.download(n,this)}async fetchUploadUrl(n,t){var r;let a={};t!=null&&t.httpOptions?a=t.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${n.mimeType}`}};const o={file:n},l=await this.request({path:Xt("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:a});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const h=(r=l==null?void 0:l.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(h===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return h}}async function Sj(e){var n;if(e===void 0)throw new S1("response is undefined");if(!e.ok){const t=e.status,r=e.statusText;let a;!((n=e.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?a=await e.json():a={error:{message:await e.text(),code:e.status,status:e.statusText}};const o=`got status: ${t} ${r}. ${JSON.stringify(a)}`;throw t>=400&&t<500?new vk(o):t>=500&&t<600?new S1(o):new Error(o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vU(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["_url","name"],r);const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function wU(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=j(n,["pageToken"]);t!==void 0&&o!=null&&_(t,["_query","pageToken"],o);const l=j(n,["filter"]);return t!==void 0&&l!=null&&_(t,["_query","filter"],l),r}function NU(e,n){const t={},r=j(n,["config"]);return r!=null&&_(t,["config"],wU(e,r,t)),t}function SU(e,n){const t={},r=j(n,["textInput"]);r!=null&&_(t,["textInput"],r);const a=j(n,["output"]);return a!=null&&_(t,["output"],a),t}function jU(e,n){const t={};if(j(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=j(n,["examples"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>SU(e,o))),_(t,["examples","examples"],a)}return t}function _U(e,n,t){const r={};if(j(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const a=j(n,["tunedModelDisplayName"]);if(t!==void 0&&a!=null&&_(t,["displayName"],a),j(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=j(n,["epochCount"]);t!==void 0&&o!=null&&_(t,["tuningTask","hyperparameters","epochCount"],o);const l=j(n,["learningRateMultiplier"]);if(l!=null&&_(r,["tuningTask","hyperparameters","learningRateMultiplier"],l),j(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(j(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const h=j(n,["batchSize"]);t!==void 0&&h!=null&&_(t,["tuningTask","hyperparameters","batchSize"],h);const d=j(n,["learningRate"]);return t!==void 0&&d!=null&&_(t,["tuningTask","hyperparameters","learningRate"],d),r}function CU(e,n){const t={},r=j(n,["baseModel"]);r!=null&&_(t,["baseModel"],r);const a=j(n,["trainingDataset"]);a!=null&&_(t,["tuningTask","trainingData"],jU(e,a));const o=j(n,["config"]);return o!=null&&_(t,["config"],_U(e,o,t)),t}function kU(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["_url","name"],r);const a=j(n,["config"]);return a!=null&&_(t,["config"],a),t}function EU(e,n,t){const r={},a=j(n,["pageSize"]);t!==void 0&&a!=null&&_(t,["_query","pageSize"],a);const o=j(n,["pageToken"]);t!==void 0&&o!=null&&_(t,["_query","pageToken"],o);const l=j(n,["filter"]);return t!==void 0&&l!=null&&_(t,["_query","filter"],l),r}function TU(e,n){const t={},r=j(n,["config"]);return r!=null&&_(t,["config"],EU(e,r,t)),t}function AU(e,n,t){const r={},a=j(n,["gcsUri"]);if(t!==void 0&&a!=null&&_(t,["supervisedTuningSpec","trainingDatasetUri"],a),j(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function DU(e,n){const t={},r=j(n,["gcsUri"]);return r!=null&&_(t,["validationDatasetUri"],r),t}function PU(e,n,t){const r={},a=j(n,["validationDataset"]);t!==void 0&&a!=null&&_(t,["supervisedTuningSpec"],DU(e,a));const o=j(n,["tunedModelDisplayName"]);t!==void 0&&o!=null&&_(t,["tunedModelDisplayName"],o);const l=j(n,["description"]);t!==void 0&&l!=null&&_(t,["description"],l);const h=j(n,["epochCount"]);t!==void 0&&h!=null&&_(t,["supervisedTuningSpec","hyperParameters","epochCount"],h);const d=j(n,["learningRateMultiplier"]);t!==void 0&&d!=null&&_(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],d);const u=j(n,["exportLastCheckpointOnly"]);t!==void 0&&u!=null&&_(t,["supervisedTuningSpec","exportLastCheckpointOnly"],u);const f=j(n,["adapterSize"]);if(t!==void 0&&f!=null&&_(t,["supervisedTuningSpec","hyperParameters","adapterSize"],f),j(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(j(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function IU(e,n){const t={},r=j(n,["baseModel"]);r!=null&&_(t,["baseModel"],r);const a=j(n,["trainingDataset"]);a!=null&&_(t,["supervisedTuningSpec","trainingDatasetUri"],AU(e,a,t));const o=j(n,["config"]);return o!=null&&_(t,["config"],PU(e,o,t)),t}function MU(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["model"],r);const a=j(n,["name"]);return a!=null&&_(t,["endpoint"],a),t}function wk(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["state"]);a!=null&&_(t,["state"],hk(e,a));const o=j(n,["createTime"]);o!=null&&_(t,["createTime"],o);const l=j(n,["tuningTask","startTime"]);l!=null&&_(t,["startTime"],l);const h=j(n,["tuningTask","completeTime"]);h!=null&&_(t,["endTime"],h);const d=j(n,["updateTime"]);d!=null&&_(t,["updateTime"],d);const u=j(n,["description"]);u!=null&&_(t,["description"],u);const f=j(n,["baseModel"]);f!=null&&_(t,["baseModel"],f);const g=j(n,["_self"]);g!=null&&_(t,["tunedModel"],MU(e,g));const b=j(n,["distillationSpec"]);b!=null&&_(t,["distillationSpec"],b);const v=j(n,["experiment"]);v!=null&&_(t,["experiment"],v);const S=j(n,["labels"]);S!=null&&_(t,["labels"],S);const k=j(n,["pipelineJob"]);k!=null&&_(t,["pipelineJob"],k);const T=j(n,["tunedModelDisplayName"]);return T!=null&&_(t,["tunedModelDisplayName"],T),t}function RU(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=j(n,["tunedModels"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>wk(e,l))),_(t,["tuningJobs"],o)}return t}function OU(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["metadata"]);a!=null&&_(t,["metadata"],a);const o=j(n,["done"]);o!=null&&_(t,["done"],o);const l=j(n,["error"]);return l!=null&&_(t,["error"],l),t}function LU(e,n){const t={},r=j(n,["checkpointId"]);r!=null&&_(t,["checkpointId"],r);const a=j(n,["epoch"]);a!=null&&_(t,["epoch"],a);const o=j(n,["step"]);o!=null&&_(t,["step"],o);const l=j(n,["endpoint"]);return l!=null&&_(t,["endpoint"],l),t}function FU(e,n){const t={},r=j(n,["model"]);r!=null&&_(t,["model"],r);const a=j(n,["endpoint"]);a!=null&&_(t,["endpoint"],a);const o=j(n,["checkpoints"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(h=>LU(e,h))),_(t,["checkpoints"],l)}return t}function j1(e,n){const t={},r=j(n,["name"]);r!=null&&_(t,["name"],r);const a=j(n,["state"]);a!=null&&_(t,["state"],hk(e,a));const o=j(n,["createTime"]);o!=null&&_(t,["createTime"],o);const l=j(n,["startTime"]);l!=null&&_(t,["startTime"],l);const h=j(n,["endTime"]);h!=null&&_(t,["endTime"],h);const d=j(n,["updateTime"]);d!=null&&_(t,["updateTime"],d);const u=j(n,["error"]);u!=null&&_(t,["error"],u);const f=j(n,["description"]);f!=null&&_(t,["description"],f);const g=j(n,["baseModel"]);g!=null&&_(t,["baseModel"],g);const b=j(n,["tunedModel"]);b!=null&&_(t,["tunedModel"],FU(e,b));const v=j(n,["supervisedTuningSpec"]);v!=null&&_(t,["supervisedTuningSpec"],v);const S=j(n,["tuningDataStats"]);S!=null&&_(t,["tuningDataStats"],S);const k=j(n,["encryptionSpec"]);k!=null&&_(t,["encryptionSpec"],k);const T=j(n,["partnerModelTuningSpec"]);T!=null&&_(t,["partnerModelTuningSpec"],T);const E=j(n,["distillationSpec"]);E!=null&&_(t,["distillationSpec"],E);const P=j(n,["experiment"]);P!=null&&_(t,["experiment"],P);const I=j(n,["labels"]);I!=null&&_(t,["labels"],I);const q=j(n,["pipelineJob"]);q!=null&&_(t,["pipelineJob"],q);const $=j(n,["tunedModelDisplayName"]);return $!=null&&_(t,["tunedModelDisplayName"],$),t}function $U(e,n){const t={},r=j(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=j(n,["tuningJobs"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>j1(e,l))),_(t,["tuningJobs"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zU extends Sg{constructor(n){super(),this.apiClient=n,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new zb(Hf.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const r=await this.tuneMldevInternal(t);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:y1.JOB_STATE_QUEUED}}}}async getInternal(n){var t,r,a,o;let l,h="",d={};if(this.apiClient.isVertexAI()){const u=kU(this.apiClient,n);return h=Xt("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>j1(this.apiClient,f))}else{const u=vU(this.apiClient,n);return h=Xt("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>wk(this.apiClient,f))}}async listInternal(n){var t,r,a,o;let l,h="",d={};if(this.apiClient.isVertexAI()){const u=TU(this.apiClient,n);return h=Xt("tuningJobs",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),l.then(f=>{const g=$U(this.apiClient,f),b=new cj;return Object.assign(b,g),b})}else{const u=NU(this.apiClient,n);return h=Xt("tunedModels",u._url),d=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:h,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),l.then(f=>{const g=RU(this.apiClient,f),b=new cj;return Object.assign(b,g),b})}}async tuneInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const h=IU(this.apiClient,n);return o=Xt("tuningJobs",h._url),l=h._query,delete h.config,delete h._url,delete h._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>j1(this.apiClient,d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(n){var t,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=CU(this.apiClient,n);return o=Xt("tunedModels",h._url),l=h._query,delete h.config,delete h._url,delete h._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>OU(this.apiClient,d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class BU{async download(n,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const UU=1024*1024*8,qU=3,VU=1e3,HU=2,y0="x-goog-upload-status";async function GU(e,n,t){var r,a,o;let l=0,h=0,d=new x1(new Response),u="upload";for(l=e.size;h<l;){const g=Math.min(UU,l-h),b=e.slice(h,h+g);h+g>=l&&(u+=", finalize");let v=0,S=VU;for(;v<qU&&(d=await t.request({path:"",body:b,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:n,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(h),"Content-Length":String(g)}}}),!(!((r=d==null?void 0:d.headers)===null||r===void 0)&&r[y0]));)v++,await WU(S),S=S*HU;if(h+=g,((a=d==null?void 0:d.headers)===null||a===void 0?void 0:a[y0])!=="active")break;if(l<=h)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(d==null?void 0:d.json());if(((o=d==null?void 0:d.headers)===null||o===void 0?void 0:o[y0])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function YU(e){return{size:e.size,type:e.type}}function WU(e){return new Promise(n=>setTimeout(n,e))}class QU{async upload(n,t,r){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await GU(n,t,r)}async stat(n){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await YU(n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class JU{create(n,t,r){return new KU(n,t,r)}}class KU{constructor(n,t,r){this.url=n,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(n){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(n)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const jj="x-goog-api-key";class XU{constructor(n){this.apiKey=n}async addAuthHeaders(n){n.get(jj)===null&&n.append(jj,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ZU="gl-node/";class Ub{constructor(n){var t;if(n.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(n.project||n.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=n.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=n.apiKey;const r=c5(n,void 0,void 0);r&&(n.httpOptions?n.httpOptions.baseUrl=r:n.httpOptions={baseUrl:r}),this.apiVersion=n.apiVersion;const a=new XU(this.apiKey);this.apiClient=new bU({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:n.httpOptions,userAgentExtra:ZU+"web",uploader:new QU,downloader:new BU}),this.models=new ZB(this.apiClient),this.live=new WB(this.apiClient,a,new JU),this.chats=new g$(this.models,this.apiClient),this.caches=new h$(this.apiClient),this.files=new T$(this.apiClient),this.operations=new uU(this.apiClient),this.tunings=new zU(this.apiClient)}}const e7="gemini-3-flash-preview";async function t7(){const e=Vf();if(!e)throw new Error("Authentication token not found. Please log in.");try{const t=await(await de("/api/clinics/settings",{headers:{Authorization:`Bearer ${e}`}})).json();if(t.gemini_api_key)return t.gemini_api_key}catch(n){console.warn("Failed to fetch clinic-specific Gemini API key, trying global fallback.",n)}try{const t=await(await de("/api/super-admin-settings/gemini-api-key",{headers:{Authorization:`Bearer ${e}`}})).json();if(t.gemini_api_key)return t.gemini_api_key}catch(n){console.warn("Failed to fetch global Gemini API key.",n)}throw new Error("Gemini API key not found. Please contact your administrator.")}let x0=null;async function n7(){if(!x0){const e=await t7();x0=new Ub({apiKey:e})}return x0}const i7=`You are an expert Clinic Business Data Analyst. You assist the clinic owner/doctor in understanding their financial and inventory performance.

**Your Goal:**
Answer questions based *strictly* on the provided JSON data context. Do not halllucinate data. If data is missing for a specific question, state that clearly.

**Capabilities:**
1.  **Analyze Revenue:** Break down revenue by type (Consultation, Pharmacy, Lab) and payment mode (Cash, UPI, etc.).
2.  **Analyze Inventory:** Identify top-selling drugs, profitable items, or stock movements.
3.  **Control Dashboard:** You can change the date range of the dashboard if the user asks for analysis of a different period (e.g., "last month", "yesterday", "since Jan 1st").

**Tools / Actions:**
To respond, you must output a **JSON object**.
- **Text Response:** Use this for normal answers.
  \`{ "response_type": "text", "content": "Your answer using markdown..." }\`

- **Change Date Range:** Use this if you need to see data for a different time period.
  *IMPORTANT:* When you use this tool, the system will *automatically* fetch new data for that range and call you again with the fresh context. You do not need to ask the user to wait.
  \`{ "response_type": "action", "action_name": "change_date_range", "parameters": { "startDate": "YYYY-MM-DD", "endDate": "YYYY-MM-DD" } }\`

- **End Analysis:** Use this when you have completed your analysis and answered the user's question fully.
  \`{ "response_type": "action", "action_name": "end_analysis", "content": "Optional final summary..." }\`

**Response Format:**
ALWAYS return valid JSON code block.
\`\`\`json
{ ... }
\`\`\`
`;async function r7(e){const{query:n,todayDate:t,currentStartDate:r,currentEndDate:a,revenueSummary:o,detailedRevenue:l,inventoryStats:h,history:d=[]}=e;let u=`Today's Date: ${t}
`;if(u+=`Current Dashboard Date Range: ${r} to ${a}

`,u+=`--- Financial Overview ---
`,o&&(u+=`Revenue Summary: ${JSON.stringify(o,null,2)}
`),l&&(u+=`Detailed Revenue by Mode: ${JSON.stringify(l,null,2)}
`),h&&(u+=`
--- Inventory Analysis ---
`,h.totals&&(u+=`Totals: ${JSON.stringify(h.totals)}
`),h.pharmacyAnalysis&&Array.isArray(h.pharmacyAnalysis))){const b=h.pharmacyAnalysis.sort((v,S)=>S.revenue-v.revenue).slice(0,50).map(v=>({name:v.name,sold:v.quantity_out,revenue:v.revenue,profit:v.profit}));u+=`Top 50 Drugs by Revenue: ${JSON.stringify(b)}
`}const f=`User Question: "${n}"

Analyze the data above to answer.`,g=[{role:"user",parts:[{text:i7}]},...d.map(b=>({role:b.role==="model"?"model":"user",parts:[{text:b.content}]})),{role:"user",parts:[{text:u}]},{role:"user",parts:[{text:f}]}];try{const b=await n7(),v={model:e7,contents:g,config:{responseMimeType:"application/json"}},S=await b.models.generateContentStream(v);let k="";for await(const T of S){const E=T.text;E&&(k+=E)}try{const T=k.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(T)}catch(T){return console.warn("Failed to parse Gemini JSON response for analysis:",T),{response_type:"text",content:k}}}catch(b){throw console.error("Analysis AI Error:",b),new Error(b.message||"Failed to generate analysis.")}}const Nk=()=>{const e=new Date().toISOString().split("T")[0],[n,t]=w.useState(e),[r,a]=w.useState(e),[o,l]=w.useState([]),[h,d]=w.useState([]),[u,f]=w.useState([]),[g,b]=w.useState(0),[v,S]=w.useState(0),[k,T]=w.useState(null),[E,P]=w.useState({reception:{},pharmacy:{},lab:{}}),[I,q]=w.useState(null),[$,L]=w.useState(!1),[F,z]=w.useState(null),[B,R]=w.useState(!1),[U,Y]=w.useState([]),[Z,ne]=w.useState(""),[ae,X]=w.useState(!1),W=w.useRef(null),H=w.useRef(null),he=w.useRef(null),D=()=>{var ee;(ee=W.current)==null||ee.scrollIntoView({behavior:"smooth"})};w.useEffect(()=>{D()},[U,B]);const te=async(ee,oe)=>{const ue=ee||n,Ee=oe||r;if(L(!0),z(null),l([]),d([]),f([]),q(null),b(0),S(0),T(null),P({reception:{},pharmacy:{},lab:{}}),!ue||!Ee){z("Please select both start and end dates."),L(!1);return}if(new Date(ue)>new Date(Ee)){z("Start date cannot be after end date."),L(!1);return}const Ie=p1();if(!Ie){z("Clinic ID not found. Please log in again."),L(!1);return}try{const[fe,pe,Re,Ye]=await Promise.all([de(`/api/bills?startDate=${ue}&endDate=${Ee}`,{cache:"no-store"}),de(`/api/payment/admission?startDate=${ue}&endDate=${Ee}`,{cache:"no-store"}),de(`/api/subscriptions/transactions/manual?startDate=${ue}&endDate=${Ee}`,{cache:"no-store"}),de(`/api/inventory/comprehensive-analysis?startDate=${ue}&endDate=${Ee}&clinicId=${Ie}`,{cache:"no-store"})]);if(!fe.ok)throw new Error("Failed to fetch bills");if(!pe.ok)throw new Error("Failed to fetch admission payments");if(!Re.ok)throw new Error("Failed to fetch subscriptions");if(!Ye.ok)throw new Error("Failed to fetch inventory analysis");const ut=await fe.json(),Ge=await pe.json(),Se=await Re.json(),qe=ut.bills||[],Ue=Ge.admissionPayments||[],ze=Se||[];l(qe),d(Ue),f(ze);let lt=0,Ke=0;const pt={consultation:0,pharmacy:0,lab:0,other:0},Te={reception:{},pharmacy:{},lab:{}};qe.forEach(xe=>{if(xe.status==="paid"||xe.type==="pharmacy_return"){const Qe=parseFloat(xe.amount.toString()),we=xe.payment_mode||"Unknown";let Pe=xe.type||"other";Pe==="pharmacy_return"&&(Ke+=Qe,Pe="pharmacy"),lt+=Qe,pt.hasOwnProperty(Pe)?pt[Pe]=(pt[Pe]||0)+Qe:pt.other=(pt.other||0)+Qe,Pe==="pharmacy"?Te.pharmacy[we]=(Te.pharmacy[we]||0)+Qe:Pe==="lab"?Te.lab[we]=(Te.lab[we]||0)+Qe:Te.reception[we]=(Te.reception[we]||0)+Qe}}),Ue.forEach(xe=>{const Qe=parseFloat(xe.amount_paid.toString()),we=xe.payment_mode||"Unknown";lt+=Qe,Te.reception[we]=(Te.reception[we]||0)+Qe}),ze.forEach(xe=>{var Pe,Je;const Qe=parseFloat(((Je=(Pe=xe.subscriptionPlan)==null?void 0:Pe.price)==null?void 0:Je.toString())??"0"),we=xe.subscription_payment_method||"manual";lt+=Qe,Te.reception[we]=(Te.reception[we]||0)+Qe}),T(pt),P(Te),b(lt),S(Ke);const ie=await Ye.json();q(ie)}catch(fe){console.error("Analysis Fetch Error:",fe),z(fe.message||"Failed to fetch analysis data.")}finally{L(!1)}},ve=async(ee,oe)=>{const ue=p1();if(!ue)throw new Error("Clinic ID not found.");const[Ee,Ie,fe,pe]=await Promise.all([de(`/api/bills?startDate=${ee}&endDate=${oe}`,{cache:"no-store"}),de(`/api/payment/admission?startDate=${ee}&endDate=${oe}`,{cache:"no-store"}),de(`/api/subscriptions/transactions/manual?startDate=${ee}&endDate=${oe}`,{cache:"no-store"}),de(`/api/inventory/comprehensive-analysis?startDate=${ee}&endDate=${oe}&clinicId=${ue}`,{cache:"no-store"})]);if(!Ee.ok||!Ie.ok||!fe.ok||!pe.ok)throw new Error("Failed to fetch fresh data for AI analysis.");const Re=await Ee.json(),Ye=await Ie.json(),ut=await fe.json(),Ge=await pe.json(),Se=Re.bills||[],qe=Ye.admissionPayments||[],Ue=ut||[],ze={consultation:0,pharmacy:0,lab:0,other:0},lt={reception:{},pharmacy:{},lab:{}};return Se.forEach(Ke=>{if(Ke.status==="paid"||Ke.type==="pharmacy_return"){const pt=parseFloat(Ke.amount.toString()),Te=Ke.payment_mode||"Unknown";let ie=Ke.type||"other";ie==="pharmacy_return"&&(ie="pharmacy"),ze.hasOwnProperty(ie)?ze[ie]=(ze[ie]||0)+pt:ze.other=(ze.other||0)+pt,ie==="pharmacy"?lt.pharmacy[Te]=(lt.pharmacy[Te]||0)+pt:ie==="lab"?lt.lab[Te]=(lt.lab[Te]||0)+pt:lt.reception[Te]=(lt.reception[Te]||0)+pt}}),qe.forEach(Ke=>{const pt=parseFloat(Ke.amount_paid.toString()),Te=Ke.payment_mode||"Unknown";lt.reception[Te]=(lt.reception[Te]||0)+pt}),Ue.forEach(Ke=>{var ie,xe;const pt=parseFloat(((xe=(ie=Ke.subscriptionPlan)==null?void 0:ie.price)==null?void 0:xe.toString())??"0"),Te=Ke.subscription_payment_method||"manual";lt.reception[Te]=(lt.reception[Te]||0)+pt}),{revenueSummary:ze,detailedRevenue:lt,inventoryStats:Ge}},M=ee=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0}).format(ee),ge=async(ee,oe,ue,Ee,Ie,fe)=>{let pe=ee,Re=oe,Ye=ue,ut=Ee,Ge=Ie,Se=fe,qe=0;const Ue=5,ze=[];try{for(;qe<Ue;){const lt={query:pe,todayDate:new Date().toISOString().split("T")[0],currentStartDate:Re,currentEndDate:Ye,revenueSummary:ut,detailedRevenue:Ge,inventoryStats:Se,history:ze},Ke=await r7(lt);if(Ke.response_type==="action"&&Ke.action_name==="change_date_range"){const{startDate:pt,endDate:Te}=Ke.parameters;Y(xe=>[...xe,{role:"ai",content:`Checking data from ${pt} to ${Te}...`}]),t(pt),a(Te),te(pt,Te);const ie=await ve(pt,Te);Re=pt,Ye=Te,ut=ie.revenueSummary,Ge=ie.detailedRevenue,Se=ie.inventoryStats,ze.push({role:"model",content:JSON.stringify(Ke)}),ze.push({role:"user",content:`Action ${Ke.action_name} executed successfully.Data refreshed.Continuing analysis.`}),setTimeout(()=>{var xe;(xe=he.current)==null||xe.scrollIntoView({behavior:"smooth",block:"start"})},100),qe++}else if(Ke.response_type==="action"&&Ke.action_name==="end_analysis"){Ke.content&&Y(pt=>[...pt,{role:"ai",content:Ke.content}]),ze.push({role:"model",content:JSON.stringify(Ke)});break}else{Y(pt=>[...pt,{role:"ai",content:Ke.content||"Analysis complete."}]),ze.push({role:"model",content:JSON.stringify(Ke)});break}}}catch(lt){console.error("AI Loop Error:",lt),Y(Ke=>[...Ke,{role:"ai",content:"I encountered an error while analyzing deeply."}])}},_e=async()=>{if(!Z.trim())return;const ee=Z;Y(oe=>[...oe,{role:"user",content:ee}]),ne(""),X(!0),await ge(ee,n,r,k,E,I),X(!1)},se=()=>{Y([]),ne("")};return i.jsxs("div",{className:St.container,ref:H,children:[i.jsxs("header",{className:St.header,children:[i.jsx("h2",{className:St.title,children:"Comprehensive Analysis Dashboard"}),i.jsxs("div",{className:St.filtersContainer,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"start-date",className:St.dateInputLabel,children:"Start Date"}),i.jsx("input",{type:"date",id:"start-date",value:n,onChange:ee=>t(ee.target.value),className:St.dateInput})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"end-date",className:St.dateInputLabel,children:"End Date"}),i.jsx("input",{type:"date",id:"end-date",value:r,onChange:ee=>a(ee.target.value),className:St.dateInput})]}),i.jsx("button",{onClick:()=>te(),disabled:$,className:St.fetchButton,children:$?"Analyzing...":"Generate Report"})]})]}),i.jsxs(i.Fragment,{children:[F&&i.jsxs("div",{className:St.errorAlert,children:[i.jsx(ui,{size:20}),i.jsx("span",{children:F})]}),$&&i.jsxs("div",{className:St.loadingContainer,children:[i.jsx("div",{className:St.breathingBall}),i.jsx("p",{children:"Compiling Financial & Inventory Data..."})]}),!$&&!F&&(k||I)&&i.jsxs("div",{className:St.dashboardGrid,children:[i.jsxs("div",{className:St.sectionContainer,ref:he,children:[i.jsxs("h3",{className:St.sectionTitle,children:[i.jsx(Mf,{size:20,className:"text-blue-500"})," Financial Overview"]}),i.jsxs("div",{className:St.totalRevenue,children:[i.jsxs("span",{children:["Total Revenue (",n," to ",r,")"]}),i.jsx("div",{className:St.totalRevenueAmount,children:M(g)})]}),k&&E&&i.jsxs("div",{className:St.revenueGrid,children:[i.jsxs("div",{className:St.revenueCard,children:[i.jsxs("div",{className:St.revenueCardTitle,children:[i.jsx(MP,{size:16,color:"var(--Primary-60)"}),i.jsx("span",{children:"Reception & Admissions"})]}),i.jsx("div",{className:St.revenueCardAmount,children:M((k.consultation||0)+(k.other||0))}),i.jsx("ul",{className:St.revenueCardList,children:Object.entries(E.reception).map(([ee,oe])=>i.jsxs("li",{children:[i.jsx("span",{className:St.capitalize,children:ee}),i.jsx("span",{children:M(oe)})]},`rec - ${ee} `))})]}),i.jsxs("div",{className:St.revenueCard,children:[i.jsxs("div",{className:St.revenueCardTitle,children:[i.jsx(XC,{size:16,color:"#A78BFA"}),i.jsx("span",{children:"Pharmacy Sales"})]}),i.jsx("div",{className:St.revenueCardAmount,children:M(k.pharmacy||0)}),i.jsxs("ul",{className:St.revenueCardList,children:[Object.entries(E.pharmacy).map(([ee,oe])=>i.jsxs("li",{children:[i.jsx("span",{className:St.capitalize,children:ee}),i.jsx("span",{children:M(oe)})]},`phar - ${ee} `)),v<0&&i.jsxs("li",{style:{color:"var(--Danger)",borderTop:"1px dashed #eee",marginTop:"0.5rem",paddingTop:"0.5rem"},children:[i.jsx("span",{children:"Returns"}),i.jsx("span",{children:M(v)})]})]})]}),i.jsxs("div",{className:St.revenueCard,children:[i.jsxs("div",{className:St.revenueCardTitle,children:[i.jsx(DM,{size:16,color:"#5EEAD4"}),i.jsx("span",{children:"Lab Revenue"})]}),i.jsx("div",{className:St.revenueCardAmount,children:M(k.lab||0)}),i.jsx("ul",{className:St.revenueCardList,children:Object.entries(E.lab).map(([ee,oe])=>i.jsxs("li",{children:[i.jsx("span",{className:St.capitalize,children:ee}),i.jsx("span",{children:M(oe)})]},`lab - ${ee} `))})]})]})]}),I&&i.jsxs("div",{className:St.sectionContainer,children:[i.jsxs("h3",{className:St.sectionTitle,children:[i.jsx(go,{size:20,className:"text-purple-500"})," Inventory Analytics"]}),i.jsxs("div",{className:St.revenueGrid,children:[i.jsxs("div",{className:St.revenueCard,children:[i.jsx("div",{className:St.revenueCardTitle,children:"Pharmacy Net Profit"}),i.jsx("div",{className:`${St.revenueCardAmount} ${St.textGreen} `,children:M(I.totals.pharmacyProfit)})]}),i.jsxs("div",{className:St.revenueCard,children:[i.jsx("div",{className:St.revenueCardTitle,children:"Pharmacy Revenue"}),i.jsx("div",{className:St.revenueCardAmount,children:M(I.totals.pharmacyRevenue)})]}),i.jsxs("div",{className:St.revenueCard,children:[i.jsx("div",{className:St.revenueCardTitle,children:"Lab Estimated Revenue"}),i.jsx("div",{className:St.revenueCardAmount,children:M(I.totals.labRevenue)})]})]}),i.jsx("h4",{style:{margin:"0.75rem 0 0.5rem",fontSize:"0.9rem",fontWeight:600},children:"Pharmacy Stock Movement"}),i.jsx("div",{className:St.tableContainer,children:i.jsxs("table",{className:St.styledTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Drug Name"}),i.jsx("th",{className:St.textRight,children:"Stock In (+)"}),i.jsx("th",{className:St.textRight,children:"Stock Out (-)"}),i.jsx("th",{className:St.textRight,children:"Converted"}),i.jsx("th",{className:St.textRight,children:"Profit"})]})}),i.jsxs("tbody",{children:[I==null?void 0:I.pharmacyAnalysis.map(ee=>i.jsxs("tr",{children:[i.jsxs("td",{children:[ee.name," ",i.jsxs("span",{style:{fontSize:"0.8em",color:"#666"},children:["(",ee.unit,")"]})]}),i.jsx("td",{className:St.textRight,children:i.jsx("div",{className:St.reasonDistribution,children:ee.quantity_in>0?i.jsxs("span",{className:St.textGreen,children:["+",ee.quantity_in]}):"-"})}),i.jsx("td",{className:St.textRight,children:i.jsxs("div",{className:St.reasonDistribution,children:[ee.quantity_out>0?i.jsxs("span",{className:St.textRed,children:["-",ee.quantity_out]}):"-",ee.loose_quantity_out>0&&i.jsxs("div",{style:{fontSize:"0.8em"},children:["(",ee.loose_quantity_out," loose)"]})]})}),i.jsx("td",{className:`${St.textRight} ${St.textOrange} `,children:ee.quantity_converted>0?ee.quantity_converted:"-"}),i.jsx("td",{className:`${St.textRight} ${St.fontMedium} `,children:M(ee.profit)})]},ee.drug_id)),(I==null?void 0:I.pharmacyAnalysis.length)===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center p-4 text-gray-400",children:"No stock movement recorded"})})]})]})})]}),i.jsxs("div",{className:St.sectionContainer,children:[i.jsxs("h3",{className:St.sectionTitle,children:[i.jsx(ns,{size:20,className:"text-gray-500"})," Transaction Detail"]}),i.jsx("div",{className:St.tableContainer,children:i.jsxs("table",{className:St.styledTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Type"}),i.jsx("th",{children:"Mode"}),i.jsx("th",{className:St.textRight,children:"Amount"})]})}),i.jsxs("tbody",{children:[o.filter(ee=>ee.status==="paid"||ee.type==="pharmacy_return").map(ee=>i.jsxs("tr",{children:[i.jsx("td",{children:new Date(ee.createdAt).toLocaleDateString()}),i.jsxs("td",{children:["#",ee.id]}),i.jsx("td",{children:ee.patient_id}),i.jsx("td",{className:St.capitalize,children:ee.type.replace("_"," ")}),i.jsx("td",{className:St.capitalize,children:ee.payment_mode}),i.jsx("td",{className:`${St.textRight} ${St.fontMedium} `,children:M(Math.abs(Number(ee.amount)))})]},`bill - ${ee.id} `)),h.map(ee=>{var oe;return i.jsxs("tr",{children:[i.jsx("td",{children:new Date(ee.payment_date).toLocaleDateString()}),i.jsxs("td",{children:["IPD-",ee.id]}),i.jsx("td",{children:((oe=ee.Patient)==null?void 0:oe.name)||ee.patient_id}),i.jsx("td",{children:"Admission"}),i.jsx("td",{className:St.capitalize,children:ee.payment_mode}),i.jsx("td",{className:`${St.textRight} ${St.fontMedium} `,children:M(Number(ee.amount_paid))})]},`adm - ${ee.id} `)}),u.map(ee=>{var oe;return i.jsxs("tr",{children:[i.jsx("td",{children:new Date(ee.subscription_start_date).toLocaleDateString()}),i.jsxs("td",{children:["SUB-",ee.id]}),i.jsx("td",{children:ee.name}),i.jsx("td",{children:"Subscription"}),i.jsx("td",{className:St.capitalize,children:"Manual"}),i.jsx("td",{className:`${St.textRight} ${St.fontMedium} `,children:M(Number(((oe=ee.subscriptionPlan)==null?void 0:oe.price)||0))})]},`sub - ${ee.id} `)})]})]})})]})]}),!$&&!k&&!I&&i.jsx("div",{className:St.noDataMessage,children:i.jsx("p",{children:'Select a date range and click "Generate Report" to view analysis.'})})]}),i.jsxs("div",{className:`${rn.chatWidget} ${B?rn.chatOpen:""} `,children:[!B&&i.jsxs("button",{className:rn.chatToggleBtn,onClick:()=>R(!0),children:[i.jsx(tc,{size:24}),i.jsx("span",{className:rn.chatToggleText,children:"Ask AI Analyst"})]}),B&&i.jsxs("div",{className:rn.chatWindow,children:[i.jsxs("div",{className:rn.chatHeader,children:[i.jsxs("div",{className:rn.chatHeaderTitle,children:[i.jsx(tc,{size:22}),i.jsx("span",{children:"Clinic Analyst AI"})]}),i.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[i.jsx("button",{onClick:se,title:"Refresh chat",style:{background:"rgba(255, 255, 255, 0.2)",border:"none",color:"#ffffff",width:"32px",height:"32px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s",padding:"0"},onMouseEnter:ee=>ee.currentTarget.style.background="rgba(255, 255, 255, 0.35)",onMouseLeave:ee=>ee.currentTarget.style.background="rgba(255, 255, 255, 0.2)",children:i.jsx(sc,{size:16,color:"#ffffff",strokeWidth:2.5})}),i.jsx("button",{onClick:()=>R(!1),title:"Minimize chat",style:{background:"rgba(255, 255, 255, 0.2)",border:"none",color:"#ffffff",width:"32px",height:"32px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s",padding:"0"},onMouseEnter:ee=>ee.currentTarget.style.background="rgba(255, 255, 255, 0.35)",onMouseLeave:ee=>ee.currentTarget.style.background="rgba(255, 255, 255, 0.2)",children:i.jsx(JC,{size:16,color:"#ffffff",strokeWidth:2.5})})]})]}),i.jsxs("div",{className:rn.chatMessages,children:[U.length===0&&i.jsxs("div",{className:rn.emptyChatState,children:[i.jsx("div",{className:rn.emptyChatIcon,children:i.jsx(tc,{size:42})}),i.jsx("p",{children:"Hi! I'm your data analyst. Ask me about your revenue, inventory, or specific trends."}),i.jsxs("div",{className:rn.suggestionChips,children:[i.jsx("button",{onClick:()=>ne("What is the total revenue this month?"),children:"Revenue this month?"}),i.jsx("button",{onClick:()=>ne("Which drugs are selling the most?"),children:"Top selling drugs?"}),i.jsx("button",{onClick:()=>ne("Analyze the pharmacy profit."),children:"Pharmacy profit?"})]})]}),U.map((ee,oe)=>i.jsxs("div",{className:`${rn.messageBubble} ${ee.role==="user"?rn.userMessage:rn.aiMessage} `,children:[i.jsx("div",{className:rn.messageIcon,children:ee.role==="user"?i.jsx(fl,{size:16}):i.jsx(tc,{size:16})}),i.jsx("div",{className:rn.messageContent,children:i.jsx(uo,{remarkPlugins:[ks],children:ee.content})})]},oe)),ae&&i.jsx("div",{className:`${rn.messageBubble} ${rn.aiMessage} `,children:i.jsxs("div",{className:rn.typingIndicator,children:[i.jsx("span",{}),i.jsx("span",{}),i.jsx("span",{})]})}),i.jsx("div",{ref:W})]}),i.jsxs("div",{className:rn.chatInputArea,children:[i.jsx("input",{type:"text",value:Z,onChange:ee=>ne(ee.target.value),onKeyDown:ee=>ee.key==="Enter"&&_e(),placeholder:"Ask about your data...",disabled:ae,autoFocus:!0}),i.jsx("button",{onClick:_e,disabled:!Z.trim()||ae,className:rn.sendBtn,children:i.jsx(fw,{size:20})})]})]})]})]})};var b0,_j;function a7(){if(_j)return b0;_j=1;var e="Expected a function",n=NaN,t="[object Symbol]",r=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,l=/^0o[0-7]+$/i,h=parseInt,d=typeof fu=="object"&&fu&&fu.Object===Object&&fu,u=typeof self=="object"&&self&&self.Object===Object&&self,f=d||u||Function("return this")(),g=Object.prototype,b=g.toString,v=Math.max,S=Math.min,k=function(){return f.Date.now()};function T($,L,F){var z,B,R,U,Y,Z,ne=0,ae=!1,X=!1,W=!0;if(typeof $!="function")throw new TypeError(e);L=q(L)||0,E(F)&&(ae=!!F.leading,X="maxWait"in F,R=X?v(q(F.maxWait)||0,L):R,W="trailing"in F?!!F.trailing:W);function H(ee){var oe=z,ue=B;return z=B=void 0,ne=ee,U=$.apply(ue,oe),U}function he(ee){return ne=ee,Y=setTimeout(ve,L),ae?H(ee):U}function D(ee){var oe=ee-Z,ue=ee-ne,Ee=L-oe;return X?S(Ee,R-ue):Ee}function te(ee){var oe=ee-Z,ue=ee-ne;return Z===void 0||oe>=L||oe<0||X&&ue>=R}function ve(){var ee=k();if(te(ee))return M(ee);Y=setTimeout(ve,D(ee))}function M(ee){return Y=void 0,W&&z?H(ee):(z=B=void 0,U)}function ge(){Y!==void 0&&clearTimeout(Y),ne=0,z=Z=B=Y=void 0}function _e(){return Y===void 0?U:M(k())}function se(){var ee=k(),oe=te(ee);if(z=arguments,B=this,Z=ee,oe){if(Y===void 0)return he(Z);if(X)return Y=setTimeout(ve,L),H(Z)}return Y===void 0&&(Y=setTimeout(ve,L)),U}return se.cancel=ge,se.flush=_e,se}function E($){var L=typeof $;return!!$&&(L=="object"||L=="function")}function P($){return!!$&&typeof $=="object"}function I($){return typeof $=="symbol"||P($)&&b.call($)==t}function q($){if(typeof $=="number")return $;if(I($))return n;if(E($)){var L=typeof $.valueOf=="function"?$.valueOf():$;$=E(L)?L+"":L}if(typeof $!="string")return $===0?$:+$;$=$.replace(r,"");var F=o.test($);return F||l.test($)?h($.slice(2),F?2:8):a.test($)?n:+$}return b0=T,b0}var s7=a7();const qb=qd(s7),Iw=async()=>{const e=await de("/api/clinic-subscriptions/plans",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription plans")}return e.json()},o7=async e=>{const n=await de(`/api/clinic-subscriptions/cancel/${e}`,{method:"PUT"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to cancel clinic subscription")}return n.json()},l7=async e=>{const n=await de(`/api/clinics/${e}/subscription-status`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||`Failed to fetch subscription status for clinic ${e}`)}return n.json()},c7=async e=>{const n=await de(`/api/clinic-subscriptions/plans/${e}`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to fetch clinic subscription plan")}return n.json()},u7=async e=>{const n=await de("/api/clinic-subscriptions/plans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to create clinic subscription plan")}return n.json()},d7=async(e,n)=>{const t=await de(`/api/clinic-subscriptions/plans/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Failed to update clinic subscription plan")}return t.json()},h7=async e=>{const n=await de(`/api/clinic-subscriptions/plans/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to deactivate clinic subscription plan")}return n.json()},f7=async e=>{const n=await de("/api/clinic-subscriptions/initiate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:e})});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to initiate clinic subscription")}return n.json()},p7=async()=>{try{const e=await de("/api/clinic-subscriptions/pending",{method:"GET"});return e.ok?e.json():null}catch(e){return console.error("Error checking for pending subscription:",e),null}},Sk=async()=>{const e=await de("/api/clinics/subscription-status",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription status")}return e.json()};var v0={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var Cj;function m7(){return Cj||(Cj=1,function(e){(function(){var n={}.hasOwnProperty;function t(){for(var o="",l=0;l<arguments.length;l++){var h=arguments[l];h&&(o=a(o,r(h)))}return o}function r(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return t.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var l="";for(var h in o)n.call(o,h)&&o[h]&&(l=a(l,h));return l}function a(o,l){return l?o?o+" "+l:o+l:o}e.exports?(t.default=t,e.exports=t):window.classNames=t})()}(v0)),v0.exports}var g7=m7();const pu=qd(g7);function Bd(e){"@babel/helpers - typeof";return Bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Bd(e)}function y7(e,n){if(Bd(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(Bd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function jk(e){var n=y7(e,"string");return Bd(n)=="symbol"?n:n+""}function Jm(e,n,t){return(n=jk(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function kj(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}function Gt(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?kj(Object(t),!0).forEach(function(r){Jm(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):kj(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function x7(e){if(Array.isArray(e))return e}function b7(e,n){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var r,a,o,l,h=[],d=!0,u=!1;try{if(o=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;d=!1}else for(;!(d=(r=o.call(t)).done)&&(h.push(r.value),h.length!==n);d=!0);}catch(f){u=!0,a=f}finally{try{if(!d&&t.return!=null&&(l=t.return(),Object(l)!==l))return}finally{if(u)throw a}}return h}}function _1(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function _k(e,n){if(e){if(typeof e=="string")return _1(e,n);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_1(e,n):void 0}}function v7(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rc(e,n){return x7(e)||b7(e,n)||_k(e,n)||v7()}function w7(e,n){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(n.indexOf(r)!==-1)continue;t[r]=e[r]}return t}function dc(e,n){if(e==null)return{};var t,r,a=w7(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var N7=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function S7(e){var n=e.defaultInputValue,t=n===void 0?"":n,r=e.defaultMenuIsOpen,a=r===void 0?!1:r,o=e.defaultValue,l=o===void 0?null:o,h=e.inputValue,d=e.menuIsOpen,u=e.onChange,f=e.onInputChange,g=e.onMenuClose,b=e.onMenuOpen,v=e.value,S=dc(e,N7),k=w.useState(h!==void 0?h:t),T=rc(k,2),E=T[0],P=T[1],I=w.useState(d!==void 0?d:a),q=rc(I,2),$=q[0],L=q[1],F=w.useState(v!==void 0?v:l),z=rc(F,2),B=z[0],R=z[1],U=w.useCallback(function(H,he){typeof u=="function"&&u(H,he),R(H)},[u]),Y=w.useCallback(function(H,he){var D;typeof f=="function"&&(D=f(H,he)),P(D!==void 0?D:H)},[f]),Z=w.useCallback(function(){typeof b=="function"&&b(),L(!0)},[b]),ne=w.useCallback(function(){typeof g=="function"&&g(),L(!1)},[g]),ae=h!==void 0?h:E,X=d!==void 0?d:$,W=v!==void 0?v:B;return Gt(Gt({},S),{},{inputValue:ae,menuIsOpen:X,onChange:U,onInputChange:Y,onMenuClose:ne,onMenuOpen:Z,value:W})}function Qt(){return Qt=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Qt.apply(null,arguments)}function j7(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function Ej(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,jk(r.key),r)}}function _7(e,n,t){return n&&Ej(e.prototype,n),t&&Ej(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function C1(e,n){return C1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},C1(e,n)}function C7(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&C1(e,n)}function fb(e){return fb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},fb(e)}function Ck(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ck=function(){return!!e})()}function k7(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E7(e,n){if(n&&(Bd(n)=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return k7(e)}function T7(e){var n=Ck();return function(){var t,r=fb(e);if(n){var a=fb(this).constructor;t=Reflect.construct(r,arguments,a)}else t=r.apply(this,arguments);return E7(this,t)}}function A7(e){if(Array.isArray(e))return _1(e)}function D7(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function P7(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mw(e){return A7(e)||D7(e)||_k(e)||P7()}function I7(e){if(e.sheet)return e.sheet;for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].ownerNode===e)return document.styleSheets[n]}function M7(e){var n=document.createElement("style");return n.setAttribute("data-emotion",e.key),e.nonce!==void 0&&n.setAttribute("nonce",e.nonce),n.appendChild(document.createTextNode("")),n.setAttribute("data-s",""),n}var R7=function(){function e(t){var r=this;this._insertTag=function(a){var o;r.tags.length===0?r.insertionPoint?o=r.insertionPoint.nextSibling:r.prepend?o=r.container.firstChild:o=r.before:o=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(a,o),r.tags.push(a)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var n=e.prototype;return n.hydrate=function(r){r.forEach(this._insertTag)},n.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(M7(this));var a=this.tags[this.tags.length-1];if(this.isSpeedy){var o=I7(a);try{o.insertRule(r,o.cssRules.length)}catch{}}else a.appendChild(document.createTextNode(r));this.ctr++},n.flush=function(){this.tags.forEach(function(r){var a;return(a=r.parentNode)==null?void 0:a.removeChild(r)}),this.tags=[],this.ctr=0},e}(),qr="-ms-",pb="-moz-",qn="-webkit-",kk="comm",Rw="rule",Ow="decl",O7="@import",Ek="@keyframes",L7="@layer",F7=Math.abs,Vb=String.fromCharCode,$7=Object.assign;function z7(e,n){return jr(e,0)^45?(((n<<2^jr(e,0))<<2^jr(e,1))<<2^jr(e,2))<<2^jr(e,3):0}function Tk(e){return e.trim()}function B7(e,n){return(e=n.exec(e))?e[0]:e}function Vn(e,n,t){return e.replace(n,t)}function k1(e,n){return e.indexOf(n)}function jr(e,n){return e.charCodeAt(n)|0}function dg(e,n,t){return e.slice(n,t)}function ol(e){return e.length}function Lw(e){return e.length}function Ax(e,n){return n.push(e),e}function U7(e,n){return e.map(n).join("")}var Hb=1,Wf=1,Ak=0,Ta=0,Zi=0,np="";function Gb(e,n,t,r,a,o,l){return{value:e,root:n,parent:t,type:r,props:a,children:o,line:Hb,column:Wf,length:l,return:""}}function Bm(e,n){return $7(Gb("",null,null,"",null,null,0),e,{length:-e.length},n)}function q7(){return Zi}function V7(){return Zi=Ta>0?jr(np,--Ta):0,Wf--,Zi===10&&(Wf=1,Hb--),Zi}function rs(){return Zi=Ta<Ak?jr(np,Ta++):0,Wf++,Zi===10&&(Wf=1,Hb++),Zi}function dl(){return jr(np,Ta)}function Jx(){return Ta}function jg(e,n){return dg(np,e,n)}function hg(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Dk(e){return Hb=Wf=1,Ak=ol(np=e),Ta=0,[]}function Pk(e){return np="",e}function Kx(e){return Tk(jg(Ta-1,E1(e===91?e+2:e===40?e+1:e)))}function H7(e){for(;(Zi=dl())&&Zi<33;)rs();return hg(e)>2||hg(Zi)>3?"":" "}function G7(e,n){for(;--n&&rs()&&!(Zi<48||Zi>102||Zi>57&&Zi<65||Zi>70&&Zi<97););return jg(e,Jx()+(n<6&&dl()==32&&rs()==32))}function E1(e){for(;rs();)switch(Zi){case e:return Ta;case 34:case 39:e!==34&&e!==39&&E1(Zi);break;case 40:e===41&&E1(e);break;case 92:rs();break}return Ta}function Y7(e,n){for(;rs()&&e+Zi!==57;)if(e+Zi===84&&dl()===47)break;return"/*"+jg(n,Ta-1)+"*"+Vb(e===47?e:rs())}function W7(e){for(;!hg(dl());)rs();return jg(e,Ta)}function Q7(e){return Pk(Xx("",null,null,null,[""],e=Dk(e),0,[0],e))}function Xx(e,n,t,r,a,o,l,h,d){for(var u=0,f=0,g=l,b=0,v=0,S=0,k=1,T=1,E=1,P=0,I="",q=a,$=o,L=r,F=I;T;)switch(S=P,P=rs()){case 40:if(S!=108&&jr(F,g-1)==58){k1(F+=Vn(Kx(P),"&","&\f"),"&\f")!=-1&&(E=-1);break}case 34:case 39:case 91:F+=Kx(P);break;case 9:case 10:case 13:case 32:F+=H7(S);break;case 92:F+=G7(Jx()-1,7);continue;case 47:switch(dl()){case 42:case 47:Ax(J7(Y7(rs(),Jx()),n,t),d);break;default:F+="/"}break;case 123*k:h[u++]=ol(F)*E;case 125*k:case 59:case 0:switch(P){case 0:case 125:T=0;case 59+f:E==-1&&(F=Vn(F,/\f/g,"")),v>0&&ol(F)-g&&Ax(v>32?Aj(F+";",r,t,g-1):Aj(Vn(F," ","")+";",r,t,g-2),d);break;case 59:F+=";";default:if(Ax(L=Tj(F,n,t,u,f,a,h,I,q=[],$=[],g),o),P===123)if(f===0)Xx(F,n,L,L,q,o,g,h,$);else switch(b===99&&jr(F,3)===110?100:b){case 100:case 108:case 109:case 115:Xx(e,L,L,r&&Ax(Tj(e,L,L,0,0,a,h,I,a,q=[],g),$),a,$,g,h,r?q:$);break;default:Xx(F,L,L,L,[""],$,0,h,$)}}u=f=v=0,k=E=1,I=F="",g=l;break;case 58:g=1+ol(F),v=S;default:if(k<1){if(P==123)--k;else if(P==125&&k++==0&&V7()==125)continue}switch(F+=Vb(P),P*k){case 38:E=f>0?1:(F+="\f",-1);break;case 44:h[u++]=(ol(F)-1)*E,E=1;break;case 64:dl()===45&&(F+=Kx(rs())),b=dl(),f=g=ol(I=F+=W7(Jx())),P++;break;case 45:S===45&&ol(F)==2&&(k=0)}}return o}function Tj(e,n,t,r,a,o,l,h,d,u,f){for(var g=a-1,b=a===0?o:[""],v=Lw(b),S=0,k=0,T=0;S<r;++S)for(var E=0,P=dg(e,g+1,g=F7(k=l[S])),I=e;E<v;++E)(I=Tk(k>0?b[E]+" "+P:Vn(P,/&\f/g,b[E])))&&(d[T++]=I);return Gb(e,n,t,a===0?Rw:h,d,u,f)}function J7(e,n,t){return Gb(e,n,t,kk,Vb(q7()),dg(e,2,-2),0)}function Aj(e,n,t,r){return Gb(e,n,t,Ow,dg(e,0,r),dg(e,r+1,-1),r)}function Lf(e,n){for(var t="",r=Lw(e),a=0;a<r;a++)t+=n(e[a],a,e,n)||"";return t}function K7(e,n,t,r){switch(e.type){case L7:if(e.children.length)break;case O7:case Ow:return e.return=e.return||e.value;case kk:return"";case Ek:return e.return=e.value+"{"+Lf(e.children,r)+"}";case Rw:e.value=e.props.join(",")}return ol(t=Lf(e.children,r))?e.return=e.value+"{"+t+"}":""}function X7(e){var n=Lw(e);return function(t,r,a,o){for(var l="",h=0;h<n;h++)l+=e[h](t,r,a,o)||"";return l}}function Z7(e){return function(n){n.root||(n=n.return)&&e(n)}}function e9(e){var n=Object.create(null);return function(t){return n[t]===void 0&&(n[t]=e(t)),n[t]}}var t9=function(n,t,r){for(var a=0,o=0;a=o,o=dl(),a===38&&o===12&&(t[r]=1),!hg(o);)rs();return jg(n,Ta)},n9=function(n,t){var r=-1,a=44;do switch(hg(a)){case 0:a===38&&dl()===12&&(t[r]=1),n[r]+=t9(Ta-1,t,r);break;case 2:n[r]+=Kx(a);break;case 4:if(a===44){n[++r]=dl()===58?"&\f":"",t[r]=n[r].length;break}default:n[r]+=Vb(a)}while(a=rs());return n},i9=function(n,t){return Pk(n9(Dk(n),t))},Dj=new WeakMap,r9=function(n){if(!(n.type!=="rule"||!n.parent||n.length<1)){for(var t=n.value,r=n.parent,a=n.column===r.column&&n.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(n.props.length===1&&t.charCodeAt(0)!==58&&!Dj.get(r))&&!a){Dj.set(n,!0);for(var o=[],l=i9(t,o),h=r.props,d=0,u=0;d<l.length;d++)for(var f=0;f<h.length;f++,u++)n.props[u]=o[d]?l[d].replace(/&\f/g,h[f]):h[f]+" "+l[d]}}},a9=function(n){if(n.type==="decl"){var t=n.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(n.return="",n.value="")}};function Ik(e,n){switch(z7(e,n)){case 5103:return qn+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return qn+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return qn+e+pb+e+qr+e+e;case 6828:case 4268:return qn+e+qr+e+e;case 6165:return qn+e+qr+"flex-"+e+e;case 5187:return qn+e+Vn(e,/(\w+).+(:[^]+)/,qn+"box-$1$2"+qr+"flex-$1$2")+e;case 5443:return qn+e+qr+"flex-item-"+Vn(e,/flex-|-self/,"")+e;case 4675:return qn+e+qr+"flex-line-pack"+Vn(e,/align-content|flex-|-self/,"")+e;case 5548:return qn+e+qr+Vn(e,"shrink","negative")+e;case 5292:return qn+e+qr+Vn(e,"basis","preferred-size")+e;case 6060:return qn+"box-"+Vn(e,"-grow","")+qn+e+qr+Vn(e,"grow","positive")+e;case 4554:return qn+Vn(e,/([^-])(transform)/g,"$1"+qn+"$2")+e;case 6187:return Vn(Vn(Vn(e,/(zoom-|grab)/,qn+"$1"),/(image-set)/,qn+"$1"),e,"")+e;case 5495:case 3959:return Vn(e,/(image-set\([^]*)/,qn+"$1$`$1");case 4968:return Vn(Vn(e,/(.+:)(flex-)?(.*)/,qn+"box-pack:$3"+qr+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+qn+e+e;case 4095:case 3583:case 4068:case 2532:return Vn(e,/(.+)-inline(.+)/,qn+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ol(e)-1-n>6)switch(jr(e,n+1)){case 109:if(jr(e,n+4)!==45)break;case 102:return Vn(e,/(.+:)(.+)-([^]+)/,"$1"+qn+"$2-$3$1"+pb+(jr(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~k1(e,"stretch")?Ik(Vn(e,"stretch","fill-available"),n)+e:e}break;case 4949:if(jr(e,n+1)!==115)break;case 6444:switch(jr(e,ol(e)-3-(~k1(e,"!important")&&10))){case 107:return Vn(e,":",":"+qn)+e;case 101:return Vn(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+qn+(jr(e,14)===45?"inline-":"")+"box$3$1"+qn+"$2$3$1"+qr+"$2box$3")+e}break;case 5936:switch(jr(e,n+11)){case 114:return qn+e+qr+Vn(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return qn+e+qr+Vn(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return qn+e+qr+Vn(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return qn+e+qr+e+e}return e}var s9=function(n,t,r,a){if(n.length>-1&&!n.return)switch(n.type){case Ow:n.return=Ik(n.value,n.length);break;case Ek:return Lf([Bm(n,{value:Vn(n.value,"@","@"+qn)})],a);case Rw:if(n.length)return U7(n.props,function(o){switch(B7(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Lf([Bm(n,{props:[Vn(o,/:(read-\w+)/,":"+pb+"$1")]})],a);case"::placeholder":return Lf([Bm(n,{props:[Vn(o,/:(plac\w+)/,":"+qn+"input-$1")]}),Bm(n,{props:[Vn(o,/:(plac\w+)/,":"+pb+"$1")]}),Bm(n,{props:[Vn(o,/:(plac\w+)/,qr+"input-$1")]})],a)}return""})}},o9=[s9],l9=function(n){var t=n.key;if(t==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(k){var T=k.getAttribute("data-emotion");T.indexOf(" ")!==-1&&(document.head.appendChild(k),k.setAttribute("data-s",""))})}var a=n.stylisPlugins||o9,o={},l,h=[];l=n.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(k){for(var T=k.getAttribute("data-emotion").split(" "),E=1;E<T.length;E++)o[T[E]]=!0;h.push(k)});var d,u=[r9,a9];{var f,g=[K7,Z7(function(k){f.insert(k)})],b=X7(u.concat(a,g)),v=function(T){return Lf(Q7(T),b)};d=function(T,E,P,I){f=P,v(T?T+"{"+E.styles+"}":E.styles),I&&(S.inserted[E.name]=!0)}}var S={key:t,sheet:new R7({key:t,container:l,nonce:n.nonce,speedy:n.speedy,prepend:n.prepend,insertionPoint:n.insertionPoint}),nonce:n.nonce,inserted:o,registered:{},insert:d};return S.sheet.hydrate(h),S},w0={exports:{}},Wn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pj;function c9(){if(Pj)return Wn;Pj=1;var e=typeof Symbol=="function"&&Symbol.for,n=e?Symbol.for("react.element"):60103,t=e?Symbol.for("react.portal"):60106,r=e?Symbol.for("react.fragment"):60107,a=e?Symbol.for("react.strict_mode"):60108,o=e?Symbol.for("react.profiler"):60114,l=e?Symbol.for("react.provider"):60109,h=e?Symbol.for("react.context"):60110,d=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,f=e?Symbol.for("react.forward_ref"):60112,g=e?Symbol.for("react.suspense"):60113,b=e?Symbol.for("react.suspense_list"):60120,v=e?Symbol.for("react.memo"):60115,S=e?Symbol.for("react.lazy"):60116,k=e?Symbol.for("react.block"):60121,T=e?Symbol.for("react.fundamental"):60117,E=e?Symbol.for("react.responder"):60118,P=e?Symbol.for("react.scope"):60119;function I($){if(typeof $=="object"&&$!==null){var L=$.$$typeof;switch(L){case n:switch($=$.type,$){case d:case u:case r:case o:case a:case g:return $;default:switch($=$&&$.$$typeof,$){case h:case f:case S:case v:case l:return $;default:return L}}case t:return L}}}function q($){return I($)===u}return Wn.AsyncMode=d,Wn.ConcurrentMode=u,Wn.ContextConsumer=h,Wn.ContextProvider=l,Wn.Element=n,Wn.ForwardRef=f,Wn.Fragment=r,Wn.Lazy=S,Wn.Memo=v,Wn.Portal=t,Wn.Profiler=o,Wn.StrictMode=a,Wn.Suspense=g,Wn.isAsyncMode=function($){return q($)||I($)===d},Wn.isConcurrentMode=q,Wn.isContextConsumer=function($){return I($)===h},Wn.isContextProvider=function($){return I($)===l},Wn.isElement=function($){return typeof $=="object"&&$!==null&&$.$$typeof===n},Wn.isForwardRef=function($){return I($)===f},Wn.isFragment=function($){return I($)===r},Wn.isLazy=function($){return I($)===S},Wn.isMemo=function($){return I($)===v},Wn.isPortal=function($){return I($)===t},Wn.isProfiler=function($){return I($)===o},Wn.isStrictMode=function($){return I($)===a},Wn.isSuspense=function($){return I($)===g},Wn.isValidElementType=function($){return typeof $=="string"||typeof $=="function"||$===r||$===u||$===o||$===a||$===g||$===b||typeof $=="object"&&$!==null&&($.$$typeof===S||$.$$typeof===v||$.$$typeof===l||$.$$typeof===h||$.$$typeof===f||$.$$typeof===T||$.$$typeof===E||$.$$typeof===P||$.$$typeof===k)},Wn.typeOf=I,Wn}var Ij;function u9(){return Ij||(Ij=1,w0.exports=c9()),w0.exports}var N0,Mj;function d9(){if(Mj)return N0;Mj=1;var e=u9(),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},t={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};o[e.ForwardRef]=r,o[e.Memo]=a;function l(S){return e.isMemo(S)?a:o[S.$$typeof]||n}var h=Object.defineProperty,d=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,g=Object.getPrototypeOf,b=Object.prototype;function v(S,k,T){if(typeof k!="string"){if(b){var E=g(k);E&&E!==b&&v(S,E,T)}var P=d(k);u&&(P=P.concat(u(k)));for(var I=l(S),q=l(k),$=0;$<P.length;++$){var L=P[$];if(!t[L]&&!(T&&T[L])&&!(q&&q[L])&&!(I&&I[L])){var F=f(k,L);try{h(S,L,F)}catch{}}}}return S}return N0=v,N0}d9();var h9=!0;function f9(e,n,t){var r="";return t.split(" ").forEach(function(a){e[a]!==void 0?n.push(e[a]+";"):a&&(r+=a+" ")}),r}var Mk=function(n,t,r){var a=n.key+"-"+t.name;(r===!1||h9===!1)&&n.registered[a]===void 0&&(n.registered[a]=t.styles)},p9=function(n,t,r){Mk(n,t,r);var a=n.key+"-"+t.name;if(n.inserted[t.name]===void 0){var o=t;do n.insert(t===o?"."+a:"",o,n.sheet,!0),o=o.next;while(o!==void 0)}};function m9(e){for(var n=0,t,r=0,a=e.length;a>=4;++r,a-=4)t=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,n=(t&65535)*1540483477+((t>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(a){case 3:n^=(e.charCodeAt(r+2)&255)<<16;case 2:n^=(e.charCodeAt(r+1)&255)<<8;case 1:n^=e.charCodeAt(r)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}var g9={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},y9=/[A-Z]|^ms/g,x9=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Rk=function(n){return n.charCodeAt(1)===45},Rj=function(n){return n!=null&&typeof n!="boolean"},S0=e9(function(e){return Rk(e)?e:e.replace(y9,"-$&").toLowerCase()}),Oj=function(n,t){switch(n){case"animation":case"animationName":if(typeof t=="string")return t.replace(x9,function(r,a,o){return ll={name:a,styles:o,next:ll},a})}return g9[n]!==1&&!Rk(n)&&typeof t=="number"&&t!==0?t+"px":t};function fg(e,n,t){if(t==null)return"";var r=t;if(r.__emotion_styles!==void 0)return r;switch(typeof t){case"boolean":return"";case"object":{var a=t;if(a.anim===1)return ll={name:a.name,styles:a.styles,next:ll},a.name;var o=t;if(o.styles!==void 0){var l=o.next;if(l!==void 0)for(;l!==void 0;)ll={name:l.name,styles:l.styles,next:ll},l=l.next;var h=o.styles+";";return h}return b9(e,n,t)}case"function":{if(e!==void 0){var d=ll,u=t(e);return ll=d,fg(e,n,u)}break}}var f=t;return f}function b9(e,n,t){var r="";if(Array.isArray(t))for(var a=0;a<t.length;a++)r+=fg(e,n,t[a])+";";else for(var o in t){var l=t[o];if(typeof l!="object"){var h=l;Rj(h)&&(r+=S0(o)+":"+Oj(o,h)+";")}else if(Array.isArray(l)&&typeof l[0]=="string"&&n==null)for(var d=0;d<l.length;d++)Rj(l[d])&&(r+=S0(o)+":"+Oj(o,l[d])+";");else{var u=fg(e,n,l);switch(o){case"animation":case"animationName":{r+=S0(o)+":"+u+";";break}default:r+=o+"{"+u+"}"}}}return r}var Lj=/label:\s*([^\s;{]+)\s*(;|$)/g,ll;function Ok(e,n,t){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var r=!0,a="";ll=void 0;var o=e[0];if(o==null||o.raw===void 0)r=!1,a+=fg(t,n,o);else{var l=o;a+=l[0]}for(var h=1;h<e.length;h++)if(a+=fg(t,n,e[h]),r){var d=o;a+=d[h]}Lj.lastIndex=0;for(var u="",f;(f=Lj.exec(a))!==null;)u+="-"+f[1];var g=m9(a)+u;return{name:g,styles:a,next:ll}}var v9=function(n){return n()},w9=pN.useInsertionEffect?pN.useInsertionEffect:!1,N9=w9||v9,Lk=w.createContext(typeof HTMLElement<"u"?l9({key:"css"}):null);Lk.Provider;var S9=function(n){return w.forwardRef(function(t,r){var a=w.useContext(Lk);return n(t,a,r)})},j9=w.createContext({}),Fw={}.hasOwnProperty,T1="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",_9=function(n,t){var r={};for(var a in t)Fw.call(t,a)&&(r[a]=t[a]);return r[T1]=n,r},C9=function(n){var t=n.cache,r=n.serialized,a=n.isStringTag;return Mk(t,r,a),N9(function(){return p9(t,r,a)}),null},k9=S9(function(e,n,t){var r=e.css;typeof r=="string"&&n.registered[r]!==void 0&&(r=n.registered[r]);var a=e[T1],o=[r],l="";typeof e.className=="string"?l=f9(n.registered,o,e.className):e.className!=null&&(l=e.className+" ");var h=Ok(o,void 0,w.useContext(j9));l+=n.key+"-"+h.name;var d={};for(var u in e)Fw.call(e,u)&&u!=="css"&&u!==T1&&(d[u]=e[u]);return d.className=l,t&&(d.ref=t),w.createElement(w.Fragment,null,w.createElement(C9,{cache:n,serialized:h,isStringTag:typeof a=="string"}),w.createElement(a,d))}),E9=k9,Ft=function(n,t){var r=arguments;if(t==null||!Fw.call(t,"css"))return w.createElement.apply(void 0,r);var a=r.length,o=new Array(a);o[0]=E9,o[1]=_9(n,t);for(var l=2;l<a;l++)o[l]=r[l];return w.createElement.apply(null,o)};(function(e){var n;n||(n=e.JSX||(e.JSX={}))})(Ft||(Ft={}));function $w(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return Ok(n)}function T9(){var e=$w.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function A9(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}const D9=Math.min,P9=Math.max,mb=Math.round,Dx=Math.floor,gb=e=>({x:e,y:e});function I9(e){const{x:n,y:t,width:r,height:a}=e;return{width:r,height:a,top:t,left:n,right:n+r,bottom:t+a,x:n,y:t}}function Yb(){return typeof window<"u"}function Fk(e){return zk(e)?(e.nodeName||"").toLowerCase():"#document"}function lc(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function $k(e){var n;return(n=(zk(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function zk(e){return Yb()?e instanceof Node||e instanceof lc(e).Node:!1}function M9(e){return Yb()?e instanceof Element||e instanceof lc(e).Element:!1}function zw(e){return Yb()?e instanceof HTMLElement||e instanceof lc(e).HTMLElement:!1}function Fj(e){return!Yb()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof lc(e).ShadowRoot}const R9=new Set(["inline","contents"]);function Bk(e){const{overflow:n,overflowX:t,overflowY:r,display:a}=Bw(e);return/auto|scroll|overlay|hidden|clip/.test(n+r+t)&&!R9.has(a)}function O9(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const L9=new Set(["html","body","#document"]);function F9(e){return L9.has(Fk(e))}function Bw(e){return lc(e).getComputedStyle(e)}function $9(e){if(Fk(e)==="html")return e;const n=e.assignedSlot||e.parentNode||Fj(e)&&e.host||$k(e);return Fj(n)?n.host:n}function Uk(e){const n=$9(e);return F9(n)?e.ownerDocument?e.ownerDocument.body:e.body:zw(n)&&Bk(n)?n:Uk(n)}function yb(e,n,t){var r;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=Uk(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),l=lc(a);if(o){const h=A1(l);return n.concat(l,l.visualViewport||[],Bk(a)?a:[],h&&t?yb(h):[])}return n.concat(a,yb(a,[],t))}function A1(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function z9(e){const n=Bw(e);let t=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const a=zw(e),o=a?e.offsetWidth:t,l=a?e.offsetHeight:r,h=mb(t)!==o||mb(r)!==l;return h&&(t=o,r=l),{width:t,height:r,$:h}}function Uw(e){return M9(e)?e:e.contextElement}function $j(e){const n=Uw(e);if(!zw(n))return gb(1);const t=n.getBoundingClientRect(),{width:r,height:a,$:o}=z9(n);let l=(o?mb(t.width):t.width)/r,h=(o?mb(t.height):t.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!h||!Number.isFinite(h))&&(h=1),{x:l,y:h}}const B9=gb(0);function U9(e){const n=lc(e);return!O9()||!n.visualViewport?B9:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function q9(e,n,t){return!1}function zj(e,n,t,r){n===void 0&&(n=!1);const a=e.getBoundingClientRect(),o=Uw(e);let l=gb(1);n&&(l=$j(e));const h=q9()?U9(o):gb(0);let d=(a.left+h.x)/l.x,u=(a.top+h.y)/l.y,f=a.width/l.x,g=a.height/l.y;if(o){const b=lc(o),v=r;let S=b,k=A1(S);for(;k&&r&&v!==S;){const T=$j(k),E=k.getBoundingClientRect(),P=Bw(k),I=E.left+(k.clientLeft+parseFloat(P.paddingLeft))*T.x,q=E.top+(k.clientTop+parseFloat(P.paddingTop))*T.y;d*=T.x,u*=T.y,f*=T.x,g*=T.y,d+=I,u+=q,S=lc(k),k=A1(S)}}return I9({width:f,height:g,x:d,y:u})}function qk(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function V9(e,n){let t=null,r;const a=$k(e);function o(){var h;clearTimeout(r),(h=t)==null||h.disconnect(),t=null}function l(h,d){h===void 0&&(h=!1),d===void 0&&(d=1),o();const u=e.getBoundingClientRect(),{left:f,top:g,width:b,height:v}=u;if(h||n(),!b||!v)return;const S=Dx(g),k=Dx(a.clientWidth-(f+b)),T=Dx(a.clientHeight-(g+v)),E=Dx(f),I={rootMargin:-S+"px "+-k+"px "+-T+"px "+-E+"px",threshold:P9(0,D9(1,d))||1};let q=!0;function $(L){const F=L[0].intersectionRatio;if(F!==d){if(!q)return l();F?l(!1,F):r=setTimeout(()=>{l(!1,1e-7)},1e3)}F===1&&!qk(u,e.getBoundingClientRect())&&l(),q=!1}try{t=new IntersectionObserver($,{...I,root:a.ownerDocument})}catch{t=new IntersectionObserver($,I)}t.observe(e)}return l(!0),o}function H9(e,n,t,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:h=typeof IntersectionObserver=="function",animationFrame:d=!1}=r,u=Uw(e),f=a||o?[...u?yb(u):[],...yb(n)]:[];f.forEach(E=>{a&&E.addEventListener("scroll",t,{passive:!0}),o&&E.addEventListener("resize",t)});const g=u&&h?V9(u,t):null;let b=-1,v=null;l&&(v=new ResizeObserver(E=>{let[P]=E;P&&P.target===u&&v&&(v.unobserve(n),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var I;(I=v)==null||I.observe(n)})),t()}),u&&!d&&v.observe(u),v.observe(n));let S,k=d?zj(e):null;d&&T();function T(){const E=zj(e);k&&!qk(k,E)&&t(),k=E,S=requestAnimationFrame(T)}return t(),()=>{var E;f.forEach(P=>{a&&P.removeEventListener("scroll",t),o&&P.removeEventListener("resize",t)}),g==null||g(),(E=v)==null||E.disconnect(),v=null,d&&cancelAnimationFrame(S)}}var D1=w.useLayoutEffect,G9=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],xb=function(){};function Y9(e,n){return n?n[0]==="-"?e+n:e+"__"+n:e}function W9(e,n){for(var t=arguments.length,r=new Array(t>2?t-2:0),a=2;a<t;a++)r[a-2]=arguments[a];var o=[].concat(r);if(n&&e)for(var l in n)n.hasOwnProperty(l)&&n[l]&&o.push("".concat(Y9(e,l)));return o.filter(function(h){return h}).map(function(h){return String(h).trim()}).join(" ")}var Bj=function(n){return iq(n)?n.filter(Boolean):Bd(n)==="object"&&n!==null?[n]:[]},Vk=function(n){n.className,n.clearValue,n.cx,n.getStyles,n.getClassNames,n.getValue,n.hasValue,n.isMulti,n.isRtl,n.options,n.selectOption,n.selectProps,n.setValue,n.theme;var t=dc(n,G9);return Gt({},t)},Ri=function(n,t,r){var a=n.cx,o=n.getStyles,l=n.getClassNames,h=n.className;return{css:o(t,n),className:a(r??{},l(t,n),h)}};function Wb(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function Q9(e){return Wb(e)?window.innerHeight:e.clientHeight}function Hk(e){return Wb(e)?window.pageYOffset:e.scrollTop}function bb(e,n){if(Wb(e)){window.scrollTo(0,n);return}e.scrollTop=n}function J9(e){var n=getComputedStyle(e),t=n.position==="absolute",r=/(auto|scroll)/;if(n.position==="fixed")return document.documentElement;for(var a=e;a=a.parentElement;)if(n=getComputedStyle(a),!(t&&n.position==="static")&&r.test(n.overflow+n.overflowY+n.overflowX))return a;return document.documentElement}function K9(e,n,t,r){return t*((e=e/r-1)*e*e+1)+n}function Px(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:xb,a=Hk(e),o=n-a,l=10,h=0;function d(){h+=l;var u=K9(h,a,o,t);bb(e,u),h<t?window.requestAnimationFrame(d):r(e)}d()}function Uj(e,n){var t=e.getBoundingClientRect(),r=n.getBoundingClientRect(),a=n.offsetHeight/3;r.bottom+a>t.bottom?bb(e,Math.min(n.offsetTop+n.clientHeight-e.offsetHeight+a,e.scrollHeight)):r.top-a<t.top&&bb(e,Math.max(n.offsetTop-a,0))}function X9(e){var n=e.getBoundingClientRect();return{bottom:n.bottom,height:n.height,left:n.left,right:n.right,top:n.top,width:n.width}}function qj(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function Z9(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var Gk=!1,eq={get passive(){return Gk=!0}},Ix=typeof window<"u"?window:{};Ix.addEventListener&&Ix.removeEventListener&&(Ix.addEventListener("p",xb,eq),Ix.removeEventListener("p",xb,!1));var tq=Gk;function nq(e){return e!=null}function iq(e){return Array.isArray(e)}function Mx(e,n,t){return e?n:t}var rq=function(n){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];var o=Object.entries(n).filter(function(l){var h=rc(l,1),d=h[0];return!r.includes(d)});return o.reduce(function(l,h){var d=rc(h,2),u=d[0],f=d[1];return l[u]=f,l},{})},aq=["children","innerProps"],sq=["children","innerProps"];function oq(e){var n=e.maxHeight,t=e.menuEl,r=e.minHeight,a=e.placement,o=e.shouldScroll,l=e.isFixedPosition,h=e.controlHeight,d=J9(t),u={placement:"bottom",maxHeight:n};if(!t||!t.offsetParent)return u;var f=d.getBoundingClientRect(),g=f.height,b=t.getBoundingClientRect(),v=b.bottom,S=b.height,k=b.top,T=t.offsetParent.getBoundingClientRect(),E=T.top,P=l?window.innerHeight:Q9(d),I=Hk(d),q=parseInt(getComputedStyle(t).marginBottom,10),$=parseInt(getComputedStyle(t).marginTop,10),L=E-$,F=P-k,z=L+I,B=g-I-k,R=v-P+I+q,U=I+k-$,Y=160;switch(a){case"auto":case"bottom":if(F>=S)return{placement:"bottom",maxHeight:n};if(B>=S&&!l)return o&&Px(d,R,Y),{placement:"bottom",maxHeight:n};if(!l&&B>=r||l&&F>=r){o&&Px(d,R,Y);var Z=l?F-q:B-q;return{placement:"bottom",maxHeight:Z}}if(a==="auto"||l){var ne=n,ae=l?L:z;return ae>=r&&(ne=Math.min(ae-q-h,n)),{placement:"top",maxHeight:ne}}if(a==="bottom")return o&&bb(d,R),{placement:"bottom",maxHeight:n};break;case"top":if(L>=S)return{placement:"top",maxHeight:n};if(z>=S&&!l)return o&&Px(d,U,Y),{placement:"top",maxHeight:n};if(!l&&z>=r||l&&L>=r){var X=n;return(!l&&z>=r||l&&L>=r)&&(X=l?L-$:z-$),o&&Px(d,U,Y),{placement:"top",maxHeight:X}}return{placement:"bottom",maxHeight:n};default:throw new Error('Invalid placement provided "'.concat(a,'".'))}return u}function lq(e){var n={bottom:"top",top:"bottom"};return e?n[e]:"bottom"}var Yk=function(n){return n==="auto"?"bottom":n},cq=function(n,t){var r,a=n.placement,o=n.theme,l=o.borderRadius,h=o.spacing,d=o.colors;return Gt((r={label:"menu"},Jm(r,lq(a),"100%"),Jm(r,"position","absolute"),Jm(r,"width","100%"),Jm(r,"zIndex",1),r),t?{}:{backgroundColor:d.neutral0,borderRadius:l,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:h.menuGutter,marginTop:h.menuGutter})},Wk=w.createContext(null),uq=function(n){var t=n.children,r=n.minMenuHeight,a=n.maxMenuHeight,o=n.menuPlacement,l=n.menuPosition,h=n.menuShouldScrollIntoView,d=n.theme,u=w.useContext(Wk)||{},f=u.setPortalPlacement,g=w.useRef(null),b=w.useState(a),v=rc(b,2),S=v[0],k=v[1],T=w.useState(null),E=rc(T,2),P=E[0],I=E[1],q=d.spacing.controlHeight;return D1(function(){var $=g.current;if($){var L=l==="fixed",F=h&&!L,z=oq({maxHeight:a,menuEl:$,minHeight:r,placement:o,shouldScroll:F,isFixedPosition:L,controlHeight:q});k(z.maxHeight),I(z.placement),f==null||f(z.placement)}},[a,o,l,h,r,f,q]),t({ref:g,placerProps:Gt(Gt({},n),{},{placement:P||Yk(o),maxHeight:S})})},dq=function(n){var t=n.children,r=n.innerRef,a=n.innerProps;return Ft("div",Qt({},Ri(n,"menu",{menu:!0}),{ref:r},a),t)},hq=dq,fq=function(n,t){var r=n.maxHeight,a=n.theme.spacing.baseUnit;return Gt({maxHeight:r,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},t?{}:{paddingBottom:a,paddingTop:a})},pq=function(n){var t=n.children,r=n.innerProps,a=n.innerRef,o=n.isMulti;return Ft("div",Qt({},Ri(n,"menuList",{"menu-list":!0,"menu-list--is-multi":o}),{ref:a},r),t)},Qk=function(n,t){var r=n.theme,a=r.spacing.baseUnit,o=r.colors;return Gt({textAlign:"center"},t?{}:{color:o.neutral40,padding:"".concat(a*2,"px ").concat(a*3,"px")})},mq=Qk,gq=Qk,yq=function(n){var t=n.children,r=t===void 0?"No options":t,a=n.innerProps,o=dc(n,aq);return Ft("div",Qt({},Ri(Gt(Gt({},o),{},{children:r,innerProps:a}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),a),r)},xq=function(n){var t=n.children,r=t===void 0?"Loading...":t,a=n.innerProps,o=dc(n,sq);return Ft("div",Qt({},Ri(Gt(Gt({},o),{},{children:r,innerProps:a}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),a),r)},bq=function(n){var t=n.rect,r=n.offset,a=n.position;return{left:t.left,position:a,top:r,width:t.width,zIndex:1}},vq=function(n){var t=n.appendTo,r=n.children,a=n.controlElement,o=n.innerProps,l=n.menuPlacement,h=n.menuPosition,d=w.useRef(null),u=w.useRef(null),f=w.useState(Yk(l)),g=rc(f,2),b=g[0],v=g[1],S=w.useMemo(function(){return{setPortalPlacement:v}},[]),k=w.useState(null),T=rc(k,2),E=T[0],P=T[1],I=w.useCallback(function(){if(a){var F=X9(a),z=h==="fixed"?0:window.pageYOffset,B=F[b]+z;(B!==(E==null?void 0:E.offset)||F.left!==(E==null?void 0:E.rect.left)||F.width!==(E==null?void 0:E.rect.width))&&P({offset:B,rect:F})}},[a,h,b,E==null?void 0:E.offset,E==null?void 0:E.rect.left,E==null?void 0:E.rect.width]);D1(function(){I()},[I]);var q=w.useCallback(function(){typeof u.current=="function"&&(u.current(),u.current=null),a&&d.current&&(u.current=H9(a,d.current,I,{elementResize:"ResizeObserver"in window}))},[a,I]);D1(function(){q()},[q]);var $=w.useCallback(function(F){d.current=F,q()},[q]);if(!t&&h!=="fixed"||!E)return null;var L=Ft("div",Qt({ref:$},Ri(Gt(Gt({},n),{},{offset:E.offset,position:h,rect:E.rect}),"menuPortal",{"menu-portal":!0}),o),r);return Ft(Wk.Provider,{value:S},t?hP.createPortal(L,t):L)},wq=function(n){var t=n.isDisabled,r=n.isRtl;return{label:"container",direction:r?"rtl":void 0,pointerEvents:t?"none":void 0,position:"relative"}},Nq=function(n){var t=n.children,r=n.innerProps,a=n.isDisabled,o=n.isRtl;return Ft("div",Qt({},Ri(n,"container",{"--is-disabled":a,"--is-rtl":o}),r),t)},Sq=function(n,t){var r=n.theme.spacing,a=n.isMulti,o=n.hasValue,l=n.selectProps.controlShouldRenderValue;return Gt({alignItems:"center",display:a&&o&&l?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},t?{}:{padding:"".concat(r.baseUnit/2,"px ").concat(r.baseUnit*2,"px")})},jq=function(n){var t=n.children,r=n.innerProps,a=n.isMulti,o=n.hasValue;return Ft("div",Qt({},Ri(n,"valueContainer",{"value-container":!0,"value-container--is-multi":a,"value-container--has-value":o}),r),t)},_q=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},Cq=function(n){var t=n.children,r=n.innerProps;return Ft("div",Qt({},Ri(n,"indicatorsContainer",{indicators:!0}),r),t)},Vj,kq=["size"],Eq=["innerProps","isRtl","size"],Tq={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},Jk=function(n){var t=n.size,r=dc(n,kq);return Ft("svg",Qt({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:Tq},r))},qw=function(n){return Ft(Jk,Qt({size:20},n),Ft("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},Kk=function(n){return Ft(Jk,Qt({size:20},n),Ft("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},Xk=function(n,t){var r=n.isFocused,a=n.theme,o=a.spacing.baseUnit,l=a.colors;return Gt({label:"indicatorContainer",display:"flex",transition:"color 150ms"},t?{}:{color:r?l.neutral60:l.neutral20,padding:o*2,":hover":{color:r?l.neutral80:l.neutral40}})},Aq=Xk,Dq=function(n){var t=n.children,r=n.innerProps;return Ft("div",Qt({},Ri(n,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),r),t||Ft(Kk,null))},Pq=Xk,Iq=function(n){var t=n.children,r=n.innerProps;return Ft("div",Qt({},Ri(n,"clearIndicator",{indicator:!0,"clear-indicator":!0}),r),t||Ft(qw,null))},Mq=function(n,t){var r=n.isDisabled,a=n.theme,o=a.spacing.baseUnit,l=a.colors;return Gt({label:"indicatorSeparator",alignSelf:"stretch",width:1},t?{}:{backgroundColor:r?l.neutral10:l.neutral20,marginBottom:o*2,marginTop:o*2})},Rq=function(n){var t=n.innerProps;return Ft("span",Qt({},t,Ri(n,"indicatorSeparator",{"indicator-separator":!0})))},Oq=T9(Vj||(Vj=A9([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),Lq=function(n,t){var r=n.isFocused,a=n.size,o=n.theme,l=o.colors,h=o.spacing.baseUnit;return Gt({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:a,lineHeight:1,marginRight:a,textAlign:"center",verticalAlign:"middle"},t?{}:{color:r?l.neutral60:l.neutral20,padding:h*2})},j0=function(n){var t=n.delay,r=n.offset;return Ft("span",{css:$w({animation:"".concat(Oq," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:r?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},Fq=function(n){var t=n.innerProps,r=n.isRtl,a=n.size,o=a===void 0?4:a,l=dc(n,Eq);return Ft("div",Qt({},Ri(Gt(Gt({},l),{},{innerProps:t,isRtl:r,size:o}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),t),Ft(j0,{delay:0,offset:r}),Ft(j0,{delay:160,offset:!0}),Ft(j0,{delay:320,offset:!r}))},$q=function(n,t){var r=n.isDisabled,a=n.isFocused,o=n.theme,l=o.colors,h=o.borderRadius,d=o.spacing;return Gt({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:d.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},t?{}:{backgroundColor:r?l.neutral5:l.neutral0,borderColor:r?l.neutral10:a?l.primary:l.neutral20,borderRadius:h,borderStyle:"solid",borderWidth:1,boxShadow:a?"0 0 0 1px ".concat(l.primary):void 0,"&:hover":{borderColor:a?l.primary:l.neutral30}})},zq=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,o=n.innerRef,l=n.innerProps,h=n.menuIsOpen;return Ft("div",Qt({ref:o},Ri(n,"control",{control:!0,"control--is-disabled":r,"control--is-focused":a,"control--menu-is-open":h}),l,{"aria-disabled":r||void 0}),t)},Bq=zq,Uq=["data"],qq=function(n,t){var r=n.theme.spacing;return t?{}:{paddingBottom:r.baseUnit*2,paddingTop:r.baseUnit*2}},Vq=function(n){var t=n.children,r=n.cx,a=n.getStyles,o=n.getClassNames,l=n.Heading,h=n.headingProps,d=n.innerProps,u=n.label,f=n.theme,g=n.selectProps;return Ft("div",Qt({},Ri(n,"group",{group:!0}),d),Ft(l,Qt({},h,{selectProps:g,theme:f,getStyles:a,getClassNames:o,cx:r}),u),Ft("div",null,t))},Hq=function(n,t){var r=n.theme,a=r.colors,o=r.spacing;return Gt({label:"group",cursor:"default",display:"block"},t?{}:{color:a.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:o.baseUnit*3,paddingRight:o.baseUnit*3,textTransform:"uppercase"})},Gq=function(n){var t=Vk(n);t.data;var r=dc(t,Uq);return Ft("div",Qt({},Ri(n,"groupHeading",{"group-heading":!0}),r))},Yq=Vq,Wq=["innerRef","isDisabled","isHidden","inputClassName"],Qq=function(n,t){var r=n.isDisabled,a=n.value,o=n.theme,l=o.spacing,h=o.colors;return Gt(Gt({visibility:r?"hidden":"visible",transform:a?"translateZ(0)":""},Jq),t?{}:{margin:l.baseUnit/2,paddingBottom:l.baseUnit/2,paddingTop:l.baseUnit/2,color:h.neutral80})},Zk={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},Jq={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Gt({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},Zk)},Kq=function(n){return Gt({label:"input",color:"inherit",background:0,opacity:n?0:1,width:"100%"},Zk)},Xq=function(n){var t=n.cx,r=n.value,a=Vk(n),o=a.innerRef,l=a.isDisabled,h=a.isHidden,d=a.inputClassName,u=dc(a,Wq);return Ft("div",Qt({},Ri(n,"input",{"input-container":!0}),{"data-value":r||""}),Ft("input",Qt({className:t({input:!0},d),ref:o,style:Kq(h),disabled:l},u)))},Zq=Xq,eV=function(n,t){var r=n.theme,a=r.spacing,o=r.borderRadius,l=r.colors;return Gt({label:"multiValue",display:"flex",minWidth:0},t?{}:{backgroundColor:l.neutral10,borderRadius:o/2,margin:a.baseUnit/2})},tV=function(n,t){var r=n.theme,a=r.borderRadius,o=r.colors,l=n.cropWithEllipsis;return Gt({overflow:"hidden",textOverflow:l||l===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},t?{}:{borderRadius:a/2,color:o.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},nV=function(n,t){var r=n.theme,a=r.spacing,o=r.borderRadius,l=r.colors,h=n.isFocused;return Gt({alignItems:"center",display:"flex"},t?{}:{borderRadius:o/2,backgroundColor:h?l.dangerLight:void 0,paddingLeft:a.baseUnit,paddingRight:a.baseUnit,":hover":{backgroundColor:l.dangerLight,color:l.danger}})},eE=function(n){var t=n.children,r=n.innerProps;return Ft("div",r,t)},iV=eE,rV=eE;function aV(e){var n=e.children,t=e.innerProps;return Ft("div",Qt({role:"button"},t),n||Ft(qw,{size:14}))}var sV=function(n){var t=n.children,r=n.components,a=n.data,o=n.innerProps,l=n.isDisabled,h=n.removeProps,d=n.selectProps,u=r.Container,f=r.Label,g=r.Remove;return Ft(u,{data:a,innerProps:Gt(Gt({},Ri(n,"multiValue",{"multi-value":!0,"multi-value--is-disabled":l})),o),selectProps:d},Ft(f,{data:a,innerProps:Gt({},Ri(n,"multiValueLabel",{"multi-value__label":!0})),selectProps:d},t),Ft(g,{data:a,innerProps:Gt(Gt({},Ri(n,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(t||"option")},h),selectProps:d}))},oV=sV,lV=function(n,t){var r=n.isDisabled,a=n.isFocused,o=n.isSelected,l=n.theme,h=l.spacing,d=l.colors;return Gt({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},t?{}:{backgroundColor:o?d.primary:a?d.primary25:"transparent",color:r?d.neutral20:o?d.neutral0:"inherit",padding:"".concat(h.baseUnit*2,"px ").concat(h.baseUnit*3,"px"),":active":{backgroundColor:r?void 0:o?d.primary:d.primary50}})},cV=function(n){var t=n.children,r=n.isDisabled,a=n.isFocused,o=n.isSelected,l=n.innerRef,h=n.innerProps;return Ft("div",Qt({},Ri(n,"option",{option:!0,"option--is-disabled":r,"option--is-focused":a,"option--is-selected":o}),{ref:l,"aria-disabled":r},h),t)},uV=cV,dV=function(n,t){var r=n.theme,a=r.spacing,o=r.colors;return Gt({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},t?{}:{color:o.neutral50,marginLeft:a.baseUnit/2,marginRight:a.baseUnit/2})},hV=function(n){var t=n.children,r=n.innerProps;return Ft("div",Qt({},Ri(n,"placeholder",{placeholder:!0}),r),t)},fV=hV,pV=function(n,t){var r=n.isDisabled,a=n.theme,o=a.spacing,l=a.colors;return Gt({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t?{}:{color:r?l.neutral40:l.neutral80,marginLeft:o.baseUnit/2,marginRight:o.baseUnit/2})},mV=function(n){var t=n.children,r=n.isDisabled,a=n.innerProps;return Ft("div",Qt({},Ri(n,"singleValue",{"single-value":!0,"single-value--is-disabled":r}),a),t)},gV=mV,yV={ClearIndicator:Iq,Control:Bq,DropdownIndicator:Dq,DownChevron:Kk,CrossIcon:qw,Group:Yq,GroupHeading:Gq,IndicatorsContainer:Cq,IndicatorSeparator:Rq,Input:Zq,LoadingIndicator:Fq,Menu:hq,MenuList:pq,MenuPortal:vq,LoadingMessage:xq,NoOptionsMessage:yq,MultiValue:oV,MultiValueContainer:iV,MultiValueLabel:rV,MultiValueRemove:aV,Option:uV,Placeholder:fV,SelectContainer:Nq,SingleValue:gV,ValueContainer:jq},xV=function(n){return Gt(Gt({},yV),n.components)},Hj=Number.isNaN||function(n){return typeof n=="number"&&n!==n};function bV(e,n){return!!(e===n||Hj(e)&&Hj(n))}function vV(e,n){if(e.length!==n.length)return!1;for(var t=0;t<e.length;t++)if(!bV(e[t],n[t]))return!1;return!0}function wV(e,n){n===void 0&&(n=vV);var t=null;function r(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];if(t&&t.lastThis===this&&n(a,t.lastArgs))return t.lastResult;var l=e.apply(this,a);return t={lastResult:l,lastArgs:a,lastThis:this},l}return r.clear=function(){t=null},r}var NV={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},SV=function(n){return Ft("span",Qt({css:NV},n))},Gj=SV,jV={guidance:function(n){var t=n.isSearchable,r=n.isMulti,a=n.tabSelectsValue,o=n.context,l=n.isInitialFocus;switch(o){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(a?", press Tab to select the option and exit the menu":"",".");case"input":return l?"".concat(n["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(r?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(n){var t=n.action,r=n.label,a=r===void 0?"":r,o=n.labels,l=n.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(a,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(o.length>1?"s":""," ").concat(o.join(","),", selected.");case"select-option":return l?"option ".concat(a," is disabled. Select another option."):"option ".concat(a,", selected.");default:return""}},onFocus:function(n){var t=n.context,r=n.focused,a=n.options,o=n.label,l=o===void 0?"":o,h=n.selectValue,d=n.isDisabled,u=n.isSelected,f=n.isAppleDevice,g=function(k,T){return k&&k.length?"".concat(k.indexOf(T)+1," of ").concat(k.length):""};if(t==="value"&&h)return"value ".concat(l," focused, ").concat(g(h,r),".");if(t==="menu"&&f){var b=d?" disabled":"",v="".concat(u?" selected":"").concat(b);return"".concat(l).concat(v,", ").concat(g(a,r),".")}return""},onFilter:function(n){var t=n.inputValue,r=n.resultsMessage;return"".concat(r).concat(t?" for search term "+t:"",".")}},_V=function(n){var t=n.ariaSelection,r=n.focusedOption,a=n.focusedValue,o=n.focusableOptions,l=n.isFocused,h=n.selectValue,d=n.selectProps,u=n.id,f=n.isAppleDevice,g=d.ariaLiveMessages,b=d.getOptionLabel,v=d.inputValue,S=d.isMulti,k=d.isOptionDisabled,T=d.isSearchable,E=d.menuIsOpen,P=d.options,I=d.screenReaderStatus,q=d.tabSelectsValue,$=d.isLoading,L=d["aria-label"],F=d["aria-live"],z=w.useMemo(function(){return Gt(Gt({},jV),g||{})},[g]),B=w.useMemo(function(){var ae="";if(t&&z.onChange){var X=t.option,W=t.options,H=t.removedValue,he=t.removedValues,D=t.value,te=function(oe){return Array.isArray(oe)?null:oe},ve=H||X||te(D),M=ve?b(ve):"",ge=W||he||void 0,_e=ge?ge.map(b):[],se=Gt({isDisabled:ve&&k(ve,h),label:M,labels:_e},t);ae=z.onChange(se)}return ae},[t,z,k,h,b]),R=w.useMemo(function(){var ae="",X=r||a,W=!!(r&&h&&h.includes(r));if(X&&z.onFocus){var H={focused:X,label:b(X),isDisabled:k(X,h),isSelected:W,options:o,context:X===r?"menu":"value",selectValue:h,isAppleDevice:f};ae=z.onFocus(H)}return ae},[r,a,b,k,z,o,h,f]),U=w.useMemo(function(){var ae="";if(E&&P.length&&!$&&z.onFilter){var X=I({count:o.length});ae=z.onFilter({inputValue:v,resultsMessage:X})}return ae},[o,v,E,z,P,I,$]),Y=(t==null?void 0:t.action)==="initial-input-focus",Z=w.useMemo(function(){var ae="";if(z.guidance){var X=a?"value":E?"menu":"input";ae=z.guidance({"aria-label":L,context:X,isDisabled:r&&k(r,h),isMulti:S,isSearchable:T,tabSelectsValue:q,isInitialFocus:Y})}return ae},[L,r,a,S,k,T,E,z,h,q,Y]),ne=Ft(w.Fragment,null,Ft("span",{id:"aria-selection"},B),Ft("span",{id:"aria-focused"},R),Ft("span",{id:"aria-results"},U),Ft("span",{id:"aria-guidance"},Z));return Ft(w.Fragment,null,Ft(Gj,{id:u},Y&&ne),Ft(Gj,{"aria-live":F,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},l&&!Y&&ne))},CV=_V,P1=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],kV=new RegExp("["+P1.map(function(e){return e.letters}).join("")+"]","g"),tE={};for(var _0=0;_0<P1.length;_0++)for(var C0=P1[_0],k0=0;k0<C0.letters.length;k0++)tE[C0.letters[k0]]=C0.base;var nE=function(n){return n.replace(kV,function(t){return tE[t]})},EV=wV(nE),Yj=function(n){return n.replace(/^\s+|\s+$/g,"")},TV=function(n){return"".concat(n.label," ").concat(n.value)},AV=function(n){return function(t,r){if(t.data.__isNew__)return!0;var a=Gt({ignoreCase:!0,ignoreAccents:!0,stringify:TV,trim:!0,matchFrom:"any"},n),o=a.ignoreCase,l=a.ignoreAccents,h=a.stringify,d=a.trim,u=a.matchFrom,f=d?Yj(r):r,g=d?Yj(h(t)):h(t);return o&&(f=f.toLowerCase(),g=g.toLowerCase()),l&&(f=EV(f),g=nE(g)),u==="start"?g.substr(0,f.length)===f:g.indexOf(f)>-1}},DV=["innerRef"];function PV(e){var n=e.innerRef,t=dc(e,DV),r=rq(t,"onExited","in","enter","exit","appear");return Ft("input",Qt({ref:n},r,{css:$w({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var IV=function(n){n.cancelable&&n.preventDefault(),n.stopPropagation()};function MV(e){var n=e.isEnabled,t=e.onBottomArrive,r=e.onBottomLeave,a=e.onTopArrive,o=e.onTopLeave,l=w.useRef(!1),h=w.useRef(!1),d=w.useRef(0),u=w.useRef(null),f=w.useCallback(function(T,E){if(u.current!==null){var P=u.current,I=P.scrollTop,q=P.scrollHeight,$=P.clientHeight,L=u.current,F=E>0,z=q-$-I,B=!1;z>E&&l.current&&(r&&r(T),l.current=!1),F&&h.current&&(o&&o(T),h.current=!1),F&&E>z?(t&&!l.current&&t(T),L.scrollTop=q,B=!0,l.current=!0):!F&&-E>I&&(a&&!h.current&&a(T),L.scrollTop=0,B=!0,h.current=!0),B&&IV(T)}},[t,r,a,o]),g=w.useCallback(function(T){f(T,T.deltaY)},[f]),b=w.useCallback(function(T){d.current=T.changedTouches[0].clientY},[]),v=w.useCallback(function(T){var E=d.current-T.changedTouches[0].clientY;f(T,E)},[f]),S=w.useCallback(function(T){if(T){var E=tq?{passive:!1}:!1;T.addEventListener("wheel",g,E),T.addEventListener("touchstart",b,E),T.addEventListener("touchmove",v,E)}},[v,b,g]),k=w.useCallback(function(T){T&&(T.removeEventListener("wheel",g,!1),T.removeEventListener("touchstart",b,!1),T.removeEventListener("touchmove",v,!1))},[v,b,g]);return w.useEffect(function(){if(n){var T=u.current;return S(T),function(){k(T)}}},[n,S,k]),function(T){u.current=T}}var Wj=["boxSizing","height","overflow","paddingRight","position"],Qj={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function Jj(e){e.cancelable&&e.preventDefault()}function Kj(e){e.stopPropagation()}function Xj(){var e=this.scrollTop,n=this.scrollHeight,t=e+this.offsetHeight;e===0?this.scrollTop=1:t===n&&(this.scrollTop=e-1)}function Zj(){return"ontouchstart"in window||navigator.maxTouchPoints}var e_=!!(typeof window<"u"&&window.document&&window.document.createElement),Um=0,wf={capture:!1,passive:!1};function RV(e){var n=e.isEnabled,t=e.accountForScrollbars,r=t===void 0?!0:t,a=w.useRef({}),o=w.useRef(null),l=w.useCallback(function(d){if(e_){var u=document.body,f=u&&u.style;if(r&&Wj.forEach(function(S){var k=f&&f[S];a.current[S]=k}),r&&Um<1){var g=parseInt(a.current.paddingRight,10)||0,b=document.body?document.body.clientWidth:0,v=window.innerWidth-b+g||0;Object.keys(Qj).forEach(function(S){var k=Qj[S];f&&(f[S]=k)}),f&&(f.paddingRight="".concat(v,"px"))}u&&Zj()&&(u.addEventListener("touchmove",Jj,wf),d&&(d.addEventListener("touchstart",Xj,wf),d.addEventListener("touchmove",Kj,wf))),Um+=1}},[r]),h=w.useCallback(function(d){if(e_){var u=document.body,f=u&&u.style;Um=Math.max(Um-1,0),r&&Um<1&&Wj.forEach(function(g){var b=a.current[g];f&&(f[g]=b)}),u&&Zj()&&(u.removeEventListener("touchmove",Jj,wf),d&&(d.removeEventListener("touchstart",Xj,wf),d.removeEventListener("touchmove",Kj,wf)))}},[r]);return w.useEffect(function(){if(n){var d=o.current;return l(d),function(){h(d)}}},[n,l,h]),function(d){o.current=d}}var OV=function(n){var t=n.target;return t.ownerDocument.activeElement&&t.ownerDocument.activeElement.blur()},LV={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function FV(e){var n=e.children,t=e.lockEnabled,r=e.captureEnabled,a=r===void 0?!0:r,o=e.onBottomArrive,l=e.onBottomLeave,h=e.onTopArrive,d=e.onTopLeave,u=MV({isEnabled:a,onBottomArrive:o,onBottomLeave:l,onTopArrive:h,onTopLeave:d}),f=RV({isEnabled:t}),g=function(v){u(v),f(v)};return Ft(w.Fragment,null,t&&Ft("div",{onClick:OV,css:LV}),n(g))}var $V={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},zV=function(n){var t=n.name,r=n.onFocus;return Ft("input",{required:!0,name:t,tabIndex:-1,"aria-hidden":"true",onFocus:r,css:$V,value:"",onChange:function(){}})},BV=zV;function Vw(e){var n;return typeof window<"u"&&window.navigator!=null?e.test(((n=window.navigator.userAgentData)===null||n===void 0?void 0:n.platform)||window.navigator.platform):!1}function UV(){return Vw(/^iPhone/i)}function iE(){return Vw(/^Mac/i)}function qV(){return Vw(/^iPad/i)||iE()&&navigator.maxTouchPoints>1}function VV(){return UV()||qV()}function HV(){return iE()||VV()}var GV=function(n){return n.label},YV=function(n){return n.label},WV=function(n){return n.value},QV=function(n){return!!n.isDisabled},JV={clearIndicator:Pq,container:wq,control:$q,dropdownIndicator:Aq,group:qq,groupHeading:Hq,indicatorsContainer:_q,indicatorSeparator:Mq,input:Qq,loadingIndicator:Lq,loadingMessage:gq,menu:cq,menuList:fq,menuPortal:bq,multiValue:eV,multiValueLabel:tV,multiValueRemove:nV,noOptionsMessage:mq,option:lV,placeholder:dV,singleValue:pV,valueContainer:Sq},KV={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},XV=4,rE=4,ZV=38,eH=rE*2,tH={baseUnit:rE,controlHeight:ZV,menuGutter:eH},E0={borderRadius:XV,colors:KV,spacing:tH},nH={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:qj(),captureMenuScroll:!qj(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:AV(),formatGroupLabel:GV,getOptionLabel:YV,getOptionValue:WV,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:QV,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!Z9(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(n){var t=n.count;return"".concat(t," result").concat(t!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function t_(e,n,t,r){var a=oE(e,n,t),o=lE(e,n,t),l=sE(e,n),h=vb(e,n);return{type:"option",data:n,isDisabled:a,isSelected:o,label:l,value:h,index:r}}function Zx(e,n){return e.options.map(function(t,r){if("options"in t){var a=t.options.map(function(l,h){return t_(e,l,n,h)}).filter(function(l){return i_(e,l)});return a.length>0?{type:"group",data:t,options:a,index:r}:void 0}var o=t_(e,t,n,r);return i_(e,o)?o:void 0}).filter(nq)}function aE(e){return e.reduce(function(n,t){return t.type==="group"?n.push.apply(n,Mw(t.options.map(function(r){return r.data}))):n.push(t.data),n},[])}function n_(e,n){return e.reduce(function(t,r){return r.type==="group"?t.push.apply(t,Mw(r.options.map(function(a){return{data:a.data,id:"".concat(n,"-").concat(r.index,"-").concat(a.index)}}))):t.push({data:r.data,id:"".concat(n,"-").concat(r.index)}),t},[])}function iH(e,n){return aE(Zx(e,n))}function i_(e,n){var t=e.inputValue,r=t===void 0?"":t,a=n.data,o=n.isSelected,l=n.label,h=n.value;return(!uE(e)||!o)&&cE(e,{label:l,value:h,data:a},r)}function rH(e,n){var t=e.focusedValue,r=e.selectValue,a=r.indexOf(t);if(a>-1){var o=n.indexOf(t);if(o>-1)return t;if(a<n.length)return n[a]}return null}function aH(e,n){var t=e.focusedOption;return t&&n.indexOf(t)>-1?t:n[0]}var T0=function(n,t){var r,a=(r=n.find(function(o){return o.data===t}))===null||r===void 0?void 0:r.id;return a||null},sE=function(n,t){return n.getOptionLabel(t)},vb=function(n,t){return n.getOptionValue(t)};function oE(e,n,t){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(n,t):!1}function lE(e,n,t){if(t.indexOf(n)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(n,t);var r=vb(e,n);return t.some(function(a){return vb(e,a)===r})}function cE(e,n,t){return e.filterOption?e.filterOption(n,t):!0}var uE=function(n){var t=n.hideSelectedOptions,r=n.isMulti;return t===void 0?r:t},sH=1,dE=function(e){C7(t,e);var n=T7(t);function t(r){var a;if(j7(this,t),a=n.call(this,r),a.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},a.blockOptionHover=!1,a.isComposing=!1,a.commonProps=void 0,a.initialTouchX=0,a.initialTouchY=0,a.openAfterFocus=!1,a.scrollToFocusedOptionOnUpdate=!1,a.userIsDragging=void 0,a.controlRef=null,a.getControlRef=function(d){a.controlRef=d},a.focusedOptionRef=null,a.getFocusedOptionRef=function(d){a.focusedOptionRef=d},a.menuListRef=null,a.getMenuListRef=function(d){a.menuListRef=d},a.inputRef=null,a.getInputRef=function(d){a.inputRef=d},a.focus=a.focusInput,a.blur=a.blurInput,a.onChange=function(d,u){var f=a.props,g=f.onChange,b=f.name;u.name=b,a.ariaOnChange(d,u),g(d,u)},a.setValue=function(d,u,f){var g=a.props,b=g.closeMenuOnSelect,v=g.isMulti,S=g.inputValue;a.onInputChange("",{action:"set-value",prevInputValue:S}),b&&(a.setState({inputIsHiddenAfterUpdate:!v}),a.onMenuClose()),a.setState({clearFocusValueOnUpdate:!0}),a.onChange(d,{action:u,option:f})},a.selectOption=function(d){var u=a.props,f=u.blurInputOnSelect,g=u.isMulti,b=u.name,v=a.state.selectValue,S=g&&a.isOptionSelected(d,v),k=a.isOptionDisabled(d,v);if(S){var T=a.getOptionValue(d);a.setValue(v.filter(function(E){return a.getOptionValue(E)!==T}),"deselect-option",d)}else if(!k)g?a.setValue([].concat(Mw(v),[d]),"select-option",d):a.setValue(d,"select-option");else{a.ariaOnChange(d,{action:"select-option",option:d,name:b});return}f&&a.blurInput()},a.removeValue=function(d){var u=a.props.isMulti,f=a.state.selectValue,g=a.getOptionValue(d),b=f.filter(function(S){return a.getOptionValue(S)!==g}),v=Mx(u,b,b[0]||null);a.onChange(v,{action:"remove-value",removedValue:d}),a.focusInput()},a.clearValue=function(){var d=a.state.selectValue;a.onChange(Mx(a.props.isMulti,[],null),{action:"clear",removedValues:d})},a.popValue=function(){var d=a.props.isMulti,u=a.state.selectValue,f=u[u.length-1],g=u.slice(0,u.length-1),b=Mx(d,g,g[0]||null);f&&a.onChange(b,{action:"pop-value",removedValue:f})},a.getFocusedOptionId=function(d){return T0(a.state.focusableOptionsWithIds,d)},a.getFocusableOptionsWithIds=function(){return n_(Zx(a.props,a.state.selectValue),a.getElementId("option"))},a.getValue=function(){return a.state.selectValue},a.cx=function(){for(var d=arguments.length,u=new Array(d),f=0;f<d;f++)u[f]=arguments[f];return W9.apply(void 0,[a.props.classNamePrefix].concat(u))},a.getOptionLabel=function(d){return sE(a.props,d)},a.getOptionValue=function(d){return vb(a.props,d)},a.getStyles=function(d,u){var f=a.props.unstyled,g=JV[d](u,f);g.boxSizing="border-box";var b=a.props.styles[d];return b?b(g,u):g},a.getClassNames=function(d,u){var f,g;return(f=(g=a.props.classNames)[d])===null||f===void 0?void 0:f.call(g,u)},a.getElementId=function(d){return"".concat(a.state.instancePrefix,"-").concat(d)},a.getComponents=function(){return xV(a.props)},a.buildCategorizedOptions=function(){return Zx(a.props,a.state.selectValue)},a.getCategorizedOptions=function(){return a.props.menuIsOpen?a.buildCategorizedOptions():[]},a.buildFocusableOptions=function(){return aE(a.buildCategorizedOptions())},a.getFocusableOptions=function(){return a.props.menuIsOpen?a.buildFocusableOptions():[]},a.ariaOnChange=function(d,u){a.setState({ariaSelection:Gt({value:d},u)})},a.onMenuMouseDown=function(d){d.button===0&&(d.stopPropagation(),d.preventDefault(),a.focusInput())},a.onMenuMouseMove=function(d){a.blockOptionHover=!1},a.onControlMouseDown=function(d){if(!d.defaultPrevented){var u=a.props.openMenuOnClick;a.state.isFocused?a.props.menuIsOpen?d.target.tagName!=="INPUT"&&d.target.tagName!=="TEXTAREA"&&a.onMenuClose():u&&a.openMenu("first"):(u&&(a.openAfterFocus=!0),a.focusInput()),d.target.tagName!=="INPUT"&&d.target.tagName!=="TEXTAREA"&&d.preventDefault()}},a.onDropdownIndicatorMouseDown=function(d){if(!(d&&d.type==="mousedown"&&d.button!==0)&&!a.props.isDisabled){var u=a.props,f=u.isMulti,g=u.menuIsOpen;a.focusInput(),g?(a.setState({inputIsHiddenAfterUpdate:!f}),a.onMenuClose()):a.openMenu("first"),d.preventDefault()}},a.onClearIndicatorMouseDown=function(d){d&&d.type==="mousedown"&&d.button!==0||(a.clearValue(),d.preventDefault(),a.openAfterFocus=!1,d.type==="touchend"?a.focusInput():setTimeout(function(){return a.focusInput()}))},a.onScroll=function(d){typeof a.props.closeMenuOnScroll=="boolean"?d.target instanceof HTMLElement&&Wb(d.target)&&a.props.onMenuClose():typeof a.props.closeMenuOnScroll=="function"&&a.props.closeMenuOnScroll(d)&&a.props.onMenuClose()},a.onCompositionStart=function(){a.isComposing=!0},a.onCompositionEnd=function(){a.isComposing=!1},a.onTouchStart=function(d){var u=d.touches,f=u&&u.item(0);f&&(a.initialTouchX=f.clientX,a.initialTouchY=f.clientY,a.userIsDragging=!1)},a.onTouchMove=function(d){var u=d.touches,f=u&&u.item(0);if(f){var g=Math.abs(f.clientX-a.initialTouchX),b=Math.abs(f.clientY-a.initialTouchY),v=5;a.userIsDragging=g>v||b>v}},a.onTouchEnd=function(d){a.userIsDragging||(a.controlRef&&!a.controlRef.contains(d.target)&&a.menuListRef&&!a.menuListRef.contains(d.target)&&a.blurInput(),a.initialTouchX=0,a.initialTouchY=0)},a.onControlTouchEnd=function(d){a.userIsDragging||a.onControlMouseDown(d)},a.onClearIndicatorTouchEnd=function(d){a.userIsDragging||a.onClearIndicatorMouseDown(d)},a.onDropdownIndicatorTouchEnd=function(d){a.userIsDragging||a.onDropdownIndicatorMouseDown(d)},a.handleInputChange=function(d){var u=a.props.inputValue,f=d.currentTarget.value;a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange(f,{action:"input-change",prevInputValue:u}),a.props.menuIsOpen||a.onMenuOpen()},a.onInputFocus=function(d){a.props.onFocus&&a.props.onFocus(d),a.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(a.openAfterFocus||a.props.openMenuOnFocus)&&a.openMenu("first"),a.openAfterFocus=!1},a.onInputBlur=function(d){var u=a.props.inputValue;if(a.menuListRef&&a.menuListRef.contains(document.activeElement)){a.inputRef.focus();return}a.props.onBlur&&a.props.onBlur(d),a.onInputChange("",{action:"input-blur",prevInputValue:u}),a.onMenuClose(),a.setState({focusedValue:null,isFocused:!1})},a.onOptionHover=function(d){if(!(a.blockOptionHover||a.state.focusedOption===d)){var u=a.getFocusableOptions(),f=u.indexOf(d);a.setState({focusedOption:d,focusedOptionId:f>-1?a.getFocusedOptionId(d):null})}},a.shouldHideSelectedOptions=function(){return uE(a.props)},a.onValueInputFocus=function(d){d.preventDefault(),d.stopPropagation(),a.focus()},a.onKeyDown=function(d){var u=a.props,f=u.isMulti,g=u.backspaceRemovesValue,b=u.escapeClearsValue,v=u.inputValue,S=u.isClearable,k=u.isDisabled,T=u.menuIsOpen,E=u.onKeyDown,P=u.tabSelectsValue,I=u.openMenuOnFocus,q=a.state,$=q.focusedOption,L=q.focusedValue,F=q.selectValue;if(!k&&!(typeof E=="function"&&(E(d),d.defaultPrevented))){switch(a.blockOptionHover=!0,d.key){case"ArrowLeft":if(!f||v)return;a.focusValue("previous");break;case"ArrowRight":if(!f||v)return;a.focusValue("next");break;case"Delete":case"Backspace":if(v)return;if(L)a.removeValue(L);else{if(!g)return;f?a.popValue():S&&a.clearValue()}break;case"Tab":if(a.isComposing||d.shiftKey||!T||!P||!$||I&&a.isOptionSelected($,F))return;a.selectOption($);break;case"Enter":if(d.keyCode===229)break;if(T){if(!$||a.isComposing)return;a.selectOption($);break}return;case"Escape":T?(a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange("",{action:"menu-close",prevInputValue:v}),a.onMenuClose()):S&&b&&a.clearValue();break;case" ":if(v)return;if(!T){a.openMenu("first");break}if(!$)return;a.selectOption($);break;case"ArrowUp":T?a.focusOption("up"):a.openMenu("last");break;case"ArrowDown":T?a.focusOption("down"):a.openMenu("first");break;case"PageUp":if(!T)return;a.focusOption("pageup");break;case"PageDown":if(!T)return;a.focusOption("pagedown");break;case"Home":if(!T)return;a.focusOption("first");break;case"End":if(!T)return;a.focusOption("last");break;default:return}d.preventDefault()}},a.state.instancePrefix="react-select-"+(a.props.instanceId||++sH),a.state.selectValue=Bj(r.value),r.menuIsOpen&&a.state.selectValue.length){var o=a.getFocusableOptionsWithIds(),l=a.buildFocusableOptions(),h=l.indexOf(a.state.selectValue[0]);a.state.focusableOptionsWithIds=o,a.state.focusedOption=l[h],a.state.focusedOptionId=T0(o,l[h])}return a}return _7(t,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&Uj(this.menuListRef,this.focusedOptionRef),HV()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(a){var o=this.props,l=o.isDisabled,h=o.menuIsOpen,d=this.state.isFocused;(d&&!l&&a.isDisabled||d&&h&&!a.menuIsOpen)&&this.focusInput(),d&&l&&!a.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!d&&!l&&a.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(Uj(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(a,o){this.props.onInputChange(a,o)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(a){var o=this,l=this.state,h=l.selectValue,d=l.isFocused,u=this.buildFocusableOptions(),f=a==="first"?0:u.length-1;if(!this.props.isMulti){var g=u.indexOf(h[0]);g>-1&&(f=g)}this.scrollToFocusedOptionOnUpdate=!(d&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:u[f],focusedOptionId:this.getFocusedOptionId(u[f])},function(){return o.onMenuOpen()})}},{key:"focusValue",value:function(a){var o=this.state,l=o.selectValue,h=o.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var d=l.indexOf(h);h||(d=-1);var u=l.length-1,f=-1;if(l.length){switch(a){case"previous":d===0?f=0:d===-1?f=u:f=d-1;break;case"next":d>-1&&d<u&&(f=d+1);break}this.setState({inputIsHidden:f!==-1,focusedValue:l[f]})}}}},{key:"focusOption",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",o=this.props.pageSize,l=this.state.focusedOption,h=this.getFocusableOptions();if(h.length){var d=0,u=h.indexOf(l);l||(u=-1),a==="up"?d=u>0?u-1:h.length-1:a==="down"?d=(u+1)%h.length:a==="pageup"?(d=u-o,d<0&&(d=0)):a==="pagedown"?(d=u+o,d>h.length-1&&(d=h.length-1)):a==="last"&&(d=h.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:h[d],focusedValue:null,focusedOptionId:this.getFocusedOptionId(h[d])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(E0):Gt(Gt({},E0),this.props.theme):E0}},{key:"getCommonProps",value:function(){var a=this.clearValue,o=this.cx,l=this.getStyles,h=this.getClassNames,d=this.getValue,u=this.selectOption,f=this.setValue,g=this.props,b=g.isMulti,v=g.isRtl,S=g.options,k=this.hasValue();return{clearValue:a,cx:o,getStyles:l,getClassNames:h,getValue:d,hasValue:k,isMulti:b,isRtl:v,options:S,selectOption:u,selectProps:g,setValue:f,theme:this.getTheme()}}},{key:"hasValue",value:function(){var a=this.state.selectValue;return a.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var a=this.props,o=a.isClearable,l=a.isMulti;return o===void 0?l:o}},{key:"isOptionDisabled",value:function(a,o){return oE(this.props,a,o)}},{key:"isOptionSelected",value:function(a,o){return lE(this.props,a,o)}},{key:"filterOption",value:function(a,o){return cE(this.props,a,o)}},{key:"formatOptionLabel",value:function(a,o){if(typeof this.props.formatOptionLabel=="function"){var l=this.props.inputValue,h=this.state.selectValue;return this.props.formatOptionLabel(a,{context:o,inputValue:l,selectValue:h})}else return this.getOptionLabel(a)}},{key:"formatGroupLabel",value:function(a){return this.props.formatGroupLabel(a)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var a=this.props,o=a.isDisabled,l=a.isSearchable,h=a.inputId,d=a.inputValue,u=a.tabIndex,f=a.form,g=a.menuIsOpen,b=a.required,v=this.getComponents(),S=v.Input,k=this.state,T=k.inputIsHidden,E=k.ariaSelection,P=this.commonProps,I=h||this.getElementId("input"),q=Gt(Gt(Gt({"aria-autocomplete":"list","aria-expanded":g,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":b,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},g&&{"aria-controls":this.getElementId("listbox")}),!l&&{"aria-readonly":!0}),this.hasValue()?(E==null?void 0:E.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return l?w.createElement(S,Qt({},P,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:I,innerRef:this.getInputRef,isDisabled:o,isHidden:T,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:u,form:f,type:"text",value:d},q)):w.createElement(PV,Qt({id:I,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:xb,onFocus:this.onInputFocus,disabled:o,tabIndex:u,inputMode:"none",form:f,value:""},q))}},{key:"renderPlaceholderOrValue",value:function(){var a=this,o=this.getComponents(),l=o.MultiValue,h=o.MultiValueContainer,d=o.MultiValueLabel,u=o.MultiValueRemove,f=o.SingleValue,g=o.Placeholder,b=this.commonProps,v=this.props,S=v.controlShouldRenderValue,k=v.isDisabled,T=v.isMulti,E=v.inputValue,P=v.placeholder,I=this.state,q=I.selectValue,$=I.focusedValue,L=I.isFocused;if(!this.hasValue()||!S)return E?null:w.createElement(g,Qt({},b,{key:"placeholder",isDisabled:k,isFocused:L,innerProps:{id:this.getElementId("placeholder")}}),P);if(T)return q.map(function(z,B){var R=z===$,U="".concat(a.getOptionLabel(z),"-").concat(a.getOptionValue(z));return w.createElement(l,Qt({},b,{components:{Container:h,Label:d,Remove:u},isFocused:R,isDisabled:k,key:U,index:B,removeProps:{onClick:function(){return a.removeValue(z)},onTouchEnd:function(){return a.removeValue(z)},onMouseDown:function(Z){Z.preventDefault()}},data:z}),a.formatOptionLabel(z,"value"))});if(E)return null;var F=q[0];return w.createElement(f,Qt({},b,{data:F,isDisabled:k}),this.formatOptionLabel(F,"value"))}},{key:"renderClearIndicator",value:function(){var a=this.getComponents(),o=a.ClearIndicator,l=this.commonProps,h=this.props,d=h.isDisabled,u=h.isLoading,f=this.state.isFocused;if(!this.isClearable()||!o||d||!this.hasValue()||u)return null;var g={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(o,Qt({},l,{innerProps:g,isFocused:f}))}},{key:"renderLoadingIndicator",value:function(){var a=this.getComponents(),o=a.LoadingIndicator,l=this.commonProps,h=this.props,d=h.isDisabled,u=h.isLoading,f=this.state.isFocused;if(!o||!u)return null;var g={"aria-hidden":"true"};return w.createElement(o,Qt({},l,{innerProps:g,isDisabled:d,isFocused:f}))}},{key:"renderIndicatorSeparator",value:function(){var a=this.getComponents(),o=a.DropdownIndicator,l=a.IndicatorSeparator;if(!o||!l)return null;var h=this.commonProps,d=this.props.isDisabled,u=this.state.isFocused;return w.createElement(l,Qt({},h,{isDisabled:d,isFocused:u}))}},{key:"renderDropdownIndicator",value:function(){var a=this.getComponents(),o=a.DropdownIndicator;if(!o)return null;var l=this.commonProps,h=this.props.isDisabled,d=this.state.isFocused,u={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(o,Qt({},l,{innerProps:u,isDisabled:h,isFocused:d}))}},{key:"renderMenu",value:function(){var a=this,o=this.getComponents(),l=o.Group,h=o.GroupHeading,d=o.Menu,u=o.MenuList,f=o.MenuPortal,g=o.LoadingMessage,b=o.NoOptionsMessage,v=o.Option,S=this.commonProps,k=this.state.focusedOption,T=this.props,E=T.captureMenuScroll,P=T.inputValue,I=T.isLoading,q=T.loadingMessage,$=T.minMenuHeight,L=T.maxMenuHeight,F=T.menuIsOpen,z=T.menuPlacement,B=T.menuPosition,R=T.menuPortalTarget,U=T.menuShouldBlockScroll,Y=T.menuShouldScrollIntoView,Z=T.noOptionsMessage,ne=T.onMenuScrollToTop,ae=T.onMenuScrollToBottom;if(!F)return null;var X=function(M,ge){var _e=M.type,se=M.data,ee=M.isDisabled,oe=M.isSelected,ue=M.label,Ee=M.value,Ie=k===se,fe=ee?void 0:function(){return a.onOptionHover(se)},pe=ee?void 0:function(){return a.selectOption(se)},Re="".concat(a.getElementId("option"),"-").concat(ge),Ye={id:Re,onClick:pe,onMouseMove:fe,onMouseOver:fe,tabIndex:-1,role:"option","aria-selected":a.state.isAppleDevice?void 0:oe};return w.createElement(v,Qt({},S,{innerProps:Ye,data:se,isDisabled:ee,isSelected:oe,key:Re,label:ue,type:_e,value:Ee,isFocused:Ie,innerRef:Ie?a.getFocusedOptionRef:void 0}),a.formatOptionLabel(M.data,"menu"))},W;if(this.hasOptions())W=this.getCategorizedOptions().map(function(ve){if(ve.type==="group"){var M=ve.data,ge=ve.options,_e=ve.index,se="".concat(a.getElementId("group"),"-").concat(_e),ee="".concat(se,"-heading");return w.createElement(l,Qt({},S,{key:se,data:M,options:ge,Heading:h,headingProps:{id:ee,data:ve.data},label:a.formatGroupLabel(ve.data)}),ve.options.map(function(oe){return X(oe,"".concat(_e,"-").concat(oe.index))}))}else if(ve.type==="option")return X(ve,"".concat(ve.index))});else if(I){var H=q({inputValue:P});if(H===null)return null;W=w.createElement(g,S,H)}else{var he=Z({inputValue:P});if(he===null)return null;W=w.createElement(b,S,he)}var D={minMenuHeight:$,maxMenuHeight:L,menuPlacement:z,menuPosition:B,menuShouldScrollIntoView:Y},te=w.createElement(uq,Qt({},S,D),function(ve){var M=ve.ref,ge=ve.placerProps,_e=ge.placement,se=ge.maxHeight;return w.createElement(d,Qt({},S,D,{innerRef:M,innerProps:{onMouseDown:a.onMenuMouseDown,onMouseMove:a.onMenuMouseMove},isLoading:I,placement:_e}),w.createElement(FV,{captureEnabled:E,onTopArrive:ne,onBottomArrive:ae,lockEnabled:U},function(ee){return w.createElement(u,Qt({},S,{innerRef:function(ue){a.getMenuListRef(ue),ee(ue)},innerProps:{role:"listbox","aria-multiselectable":S.isMulti,id:a.getElementId("listbox")},isLoading:I,maxHeight:se,focusedOption:k}),W)}))});return R||B==="fixed"?w.createElement(f,Qt({},S,{appendTo:R,controlElement:this.controlRef,menuPlacement:z,menuPosition:B}),te):te}},{key:"renderFormField",value:function(){var a=this,o=this.props,l=o.delimiter,h=o.isDisabled,d=o.isMulti,u=o.name,f=o.required,g=this.state.selectValue;if(f&&!this.hasValue()&&!h)return w.createElement(BV,{name:u,onFocus:this.onValueInputFocus});if(!(!u||h))if(d)if(l){var b=g.map(function(k){return a.getOptionValue(k)}).join(l);return w.createElement("input",{name:u,type:"hidden",value:b})}else{var v=g.length>0?g.map(function(k,T){return w.createElement("input",{key:"i-".concat(T),name:u,type:"hidden",value:a.getOptionValue(k)})}):w.createElement("input",{name:u,type:"hidden",value:""});return w.createElement("div",null,v)}else{var S=g[0]?this.getOptionValue(g[0]):"";return w.createElement("input",{name:u,type:"hidden",value:S})}}},{key:"renderLiveRegion",value:function(){var a=this.commonProps,o=this.state,l=o.ariaSelection,h=o.focusedOption,d=o.focusedValue,u=o.isFocused,f=o.selectValue,g=this.getFocusableOptions();return w.createElement(CV,Qt({},a,{id:this.getElementId("live-region"),ariaSelection:l,focusedOption:h,focusedValue:d,isFocused:u,selectValue:f,focusableOptions:g,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var a=this.getComponents(),o=a.Control,l=a.IndicatorsContainer,h=a.SelectContainer,d=a.ValueContainer,u=this.props,f=u.className,g=u.id,b=u.isDisabled,v=u.menuIsOpen,S=this.state.isFocused,k=this.commonProps=this.getCommonProps();return w.createElement(h,Qt({},k,{className:f,innerProps:{id:g,onKeyDown:this.onKeyDown},isDisabled:b,isFocused:S}),this.renderLiveRegion(),w.createElement(o,Qt({},k,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:b,isFocused:S,menuIsOpen:v}),w.createElement(d,Qt({},k,{isDisabled:b}),this.renderPlaceholderOrValue(),this.renderInput()),w.createElement(l,Qt({},k,{isDisabled:b}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(a,o){var l=o.prevProps,h=o.clearFocusValueOnUpdate,d=o.inputIsHiddenAfterUpdate,u=o.ariaSelection,f=o.isFocused,g=o.prevWasFocused,b=o.instancePrefix,v=a.options,S=a.value,k=a.menuIsOpen,T=a.inputValue,E=a.isMulti,P=Bj(S),I={};if(l&&(S!==l.value||v!==l.options||k!==l.menuIsOpen||T!==l.inputValue)){var q=k?iH(a,P):[],$=k?n_(Zx(a,P),"".concat(b,"-option")):[],L=h?rH(o,P):null,F=aH(o,q),z=T0($,F);I={selectValue:P,focusedOption:F,focusedOptionId:z,focusableOptionsWithIds:$,focusedValue:L,clearFocusValueOnUpdate:!1}}var B=d!=null&&a!==l?{inputIsHidden:d,inputIsHiddenAfterUpdate:void 0}:{},R=u,U=f&&g;return f&&!U&&(R={value:Mx(E,P,P[0]||null),options:P,action:"initial-input-focus"},U=!g),(u==null?void 0:u.action)==="initial-input-focus"&&(R=null),Gt(Gt(Gt({},I),B),{},{prevProps:a,ariaSelection:R,prevWasFocused:U})}}]),t}(w.Component);dE.defaultProps=nH;var oH=w.forwardRef(function(e,n){var t=S7(e);return w.createElement(dE,Qt({ref:n},t))}),lH=oH;const Nf=new Map,hE=(()=>{const e=new Promise(n=>{window.addEventListener("pointerdown",n,{once:!0}),window.addEventListener("keydown",n,{once:!0})});return async n=>{try{const t=new Audio;if(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",await t.play(),n!=null&&n.id&&Nf.has(n.id)){const a=Nf.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&Nf.set(n.id,r),r}catch{if(await e,n!=null&&n.id&&Nf.has(n.id)){const a=Nf.get(n.id);if(a)return a}const r=new AudioContext(n);return n!=null&&n.id&&Nf.set(n.id,r),r}}})();function cH(e){var n=atob(e),t=new Uint8Array(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t.buffer}const uH=`
class AudioProcessingWorklet extends AudioWorkletProcessor {

  // send and clear buffer every 2048 samples, 
  // which at 16khz is about 8 times a second
  buffer = new Int16Array(2048);

  // current write index
  bufferWriteIndex = 0;

  constructor() {
    super();
    this.hasAudio = false;
  }

  /**
   * @param inputs Float32Array[][] [input#][channel#][sample#] so to access first inputs 1st channel inputs[0][0]
   * @param outputs Float32Array[][]
   */
  process(inputs) {
    if (inputs[0].length) {
      const channel0 = inputs[0][0];
      this.processChunk(channel0);
    }
    return true;
  }

  sendAndClearBuffer(){
    this.port.postMessage({
      event: "chunk",
      data: {
        int16arrayBuffer: this.buffer.slice(0, this.bufferWriteIndex).buffer,
      },
    });
    this.bufferWriteIndex = 0;
  }

  processChunk(float32Array) {
    const l = float32Array.length;
    
    for (let i = 0; i < l; i++) {
      // convert float32 -1 to 1 to int16 -32768 to 32767
      const int16Value = float32Array[i] * 32768;
      this.buffer[this.bufferWriteIndex++] = int16Value;
      if(this.bufferWriteIndex >= this.buffer.length) {
        this.sendAndClearBuffer();
      }
    }

    if(this.bufferWriteIndex >= this.buffer.length) {
      this.sendAndClearBuffer();
    }
  }
}
`,fE=`
  class VolMeter extends AudioWorkletProcessor {
    volume
    updateIntervalInMS
    nextUpdateFrame

    constructor() {
      super()
      this.volume = 0
      this.updateIntervalInMS = 25
      this.nextUpdateFrame = this.updateIntervalInMS
      this.port.onmessage = event => {
        if (event.data.updateIntervalInMS) {
          this.updateIntervalInMS = event.data.updateIntervalInMS
        }
      }
    }

    get intervalInFrames() {
      return (this.updateIntervalInMS / 1000) * sampleRate
    }

    process(inputs) {
      const input = inputs[0]

      if (input.length > 0) {
        const samples = input[0]
        let sum = 0
        let rms = 0

        for (let i = 0; i < samples.length; ++i) {
          sum += samples[i] * samples[i]
        }

        rms = Math.sqrt(sum / samples.length)
        this.volume = Math.max(rms, this.volume * 0.7)

        this.nextUpdateFrame -= samples.length
        if (this.nextUpdateFrame < 0) {
          this.nextUpdateFrame += this.intervalInFrames
          this.port.postMessage({volume: this.volume})
        }
      }

      return true
    }
  }`,Rx=new Map,I1=(e,n)=>{const t=new Blob([`registerProcessor("${e}", ${n})`],{type:"application/javascript"});return URL.createObjectURL(t)};var A0={exports:{}},r_;function dH(){return r_||(r_=1,function(e){var n=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function a(d,u,f){this.fn=d,this.context=u,this.once=f||!1}function o(d,u,f,g,b){if(typeof f!="function")throw new TypeError("The listener must be a function");var v=new a(f,g||d,b),S=t?t+u:u;return d._events[S]?d._events[S].fn?d._events[S]=[d._events[S],v]:d._events[S].push(v):(d._events[S]=v,d._eventsCount++),d}function l(d,u){--d._eventsCount===0?d._events=new r:delete d._events[u]}function h(){this._events=new r,this._eventsCount=0}h.prototype.eventNames=function(){var u=[],f,g;if(this._eventsCount===0)return u;for(g in f=this._events)n.call(f,g)&&u.push(t?g.slice(1):g);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},h.prototype.listeners=function(u){var f=t?t+u:u,g=this._events[f];if(!g)return[];if(g.fn)return[g.fn];for(var b=0,v=g.length,S=new Array(v);b<v;b++)S[b]=g[b].fn;return S},h.prototype.listenerCount=function(u){var f=t?t+u:u,g=this._events[f];return g?g.fn?1:g.length:0},h.prototype.emit=function(u,f,g,b,v,S){var k=t?t+u:u;if(!this._events[k])return!1;var T=this._events[k],E=arguments.length,P,I;if(T.fn){switch(T.once&&this.removeListener(u,T.fn,void 0,!0),E){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,f),!0;case 3:return T.fn.call(T.context,f,g),!0;case 4:return T.fn.call(T.context,f,g,b),!0;case 5:return T.fn.call(T.context,f,g,b,v),!0;case 6:return T.fn.call(T.context,f,g,b,v,S),!0}for(I=1,P=new Array(E-1);I<E;I++)P[I-1]=arguments[I];T.fn.apply(T.context,P)}else{var q=T.length,$;for(I=0;I<q;I++)switch(T[I].once&&this.removeListener(u,T[I].fn,void 0,!0),E){case 1:T[I].fn.call(T[I].context);break;case 2:T[I].fn.call(T[I].context,f);break;case 3:T[I].fn.call(T[I].context,f,g);break;case 4:T[I].fn.call(T[I].context,f,g,b);break;default:if(!P)for($=1,P=new Array(E-1);$<E;$++)P[$-1]=arguments[$];T[I].fn.apply(T[I].context,P)}}return!0},h.prototype.on=function(u,f,g){return o(this,u,f,g,!1)},h.prototype.once=function(u,f,g){return o(this,u,f,g,!0)},h.prototype.removeListener=function(u,f,g,b){var v=t?t+u:u;if(!this._events[v])return this;if(!f)return l(this,v),this;var S=this._events[v];if(S.fn)S.fn===f&&(!b||S.once)&&(!g||S.context===g)&&l(this,v);else{for(var k=0,T=[],E=S.length;k<E;k++)(S[k].fn!==f||b&&!S[k].once||g&&S[k].context!==g)&&T.push(S[k]);T.length?this._events[v]=T.length===1?T[0]:T:l(this,v)}return this},h.prototype.removeAllListeners=function(u){var f;return u?(f=t?t+u:u,this._events[f]&&l(this,f)):(this._events=new r,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=t,h.EventEmitter=h,e.exports=h}(A0)),A0.exports}var hH=dH();const pE=qd(hH);function fH(e){for(var n="",t=new Uint8Array(e),r=t.byteLength,a=0;a<r;a++)n+=String.fromCharCode(t[a]);return window.btoa(n)}class mE extends pE{constructor(t=16e3){super();ri(this,"stream");ri(this,"audioContext");ri(this,"source");ri(this,"recording",!1);ri(this,"recordingWorklet");ri(this,"vuWorklet");ri(this,"starting",null);this.sampleRate=t}async start(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Could not request user media");this.starting=new Promise(async t=>{this.stream=await navigator.mediaDevices.getUserMedia({audio:!0}),this.audioContext=await hE({sampleRate:this.sampleRate}),this.source=this.audioContext.createMediaStreamSource(this.stream);const r="audio-recorder-worklet",a=I1(r,uH);await this.audioContext.audioWorklet.addModule(a),this.recordingWorklet=new AudioWorkletNode(this.audioContext,r),this.recordingWorklet.port.onmessage=async l=>{const h=l.data.data.int16arrayBuffer;if(h){const d=fH(h);this.emit("data",d)}},this.source.connect(this.recordingWorklet);const o="vu-meter";await this.audioContext.audioWorklet.addModule(I1(o,fE)),this.vuWorklet=new AudioWorkletNode(this.audioContext,o),this.vuWorklet.port.onmessage=l=>{this.emit("volume",l.data.volume)},this.source.connect(this.vuWorklet),this.recording=!0,t(),this.starting=null})}stop(){const t=()=>{var r,a;(r=this.source)==null||r.disconnect(),(a=this.stream)==null||a.getTracks().forEach(o=>o.stop()),this.stream=void 0,this.recordingWorklet=void 0,this.vuWorklet=void 0,this.audioContext&&(this.audioContext.close(),this.audioContext=void 0)};if(this.starting){this.starting.then(t);return}t()}}const pH=3,mH=({active:e,volume:n,hover:t})=>{const r=w.useRef([]);return w.useEffect(()=>{let a=null;const o=()=>{r.current.forEach((l,h)=>{l&&(l.style.height=`${Math.min(24,4+n*(h===1?400:60))}px`)}),a=window.setTimeout(o,100)};return o(),()=>clearTimeout(a)},[n]),i.jsx("div",{className:pu("audioPulse",{active:e,hover:t}),children:Array(pH).fill(null).map((a,o)=>i.jsx("div",{ref:l=>{r.current[o]=l},style:{animationDelay:`${o*133}ms`}},o))})};var Km={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var gH=Km.exports,a_;function yH(){return a_||(a_=1,function(e,n){(function(){var t,r="4.17.21",a=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",h="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",u=500,f="__lodash_placeholder__",g=1,b=2,v=4,S=1,k=2,T=1,E=2,P=4,I=8,q=16,$=32,L=64,F=128,z=256,B=512,R=30,U="...",Y=800,Z=16,ne=1,ae=2,X=3,W=1/0,H=9007199254740991,he=17976931348623157e292,D=NaN,te=4294967295,ve=te-1,M=te>>>1,ge=[["ary",F],["bind",T],["bindKey",E],["curry",I],["curryRight",q],["flip",B],["partial",$],["partialRight",L],["rearg",z]],_e="[object Arguments]",se="[object Array]",ee="[object AsyncFunction]",oe="[object Boolean]",ue="[object Date]",Ee="[object DOMException]",Ie="[object Error]",fe="[object Function]",pe="[object GeneratorFunction]",Re="[object Map]",Ye="[object Number]",ut="[object Null]",Ge="[object Object]",Se="[object Promise]",qe="[object Proxy]",Ue="[object RegExp]",ze="[object Set]",lt="[object String]",Ke="[object Symbol]",pt="[object Undefined]",Te="[object WeakMap]",ie="[object WeakSet]",xe="[object ArrayBuffer]",Qe="[object DataView]",we="[object Float32Array]",Pe="[object Float64Array]",Je="[object Int8Array]",at="[object Int16Array]",ft="[object Int32Array]",Ae="[object Uint8Array]",Ve="[object Uint8ClampedArray]",$e="[object Uint16Array]",We="[object Uint32Array]",ct=/\b__p \+= '';/g,dt=/\b(__p \+=) '' \+/g,wt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,bt=/&(?:amp|lt|gt|quot|#39);/g,kt=/[&<>"']/g,Tt=RegExp(bt.source),It=RegExp(kt.source),mt=/<%-([\s\S]+?)%>/g,$t=/<%([\s\S]+?)%>/g,en=/<%=([\s\S]+?)%>/g,be=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,nt=/^\w*$/,Ze=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Pt=/[\\^$.*+?()[\]{}|]/g,Ut=RegExp(Pt.source),hn=/^\s+/,Ln=/\s/,Qn=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Oi=/\{\n\/\* \[wrapped with (.+)\] \*/,Si=/,? & /,hr=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ss=/[()=,{}\[\]\/\s]/,ni=/\\(\\)?/g,gn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Pi=/\w*$/,er=/^[-+]0x[0-9a-f]+$/i,oi=/^0b[01]+$/i,vi=/^\[object .+?Constructor\]$/,sa=/^0o[0-7]+$/i,fr=/^(?:0|[1-9]\d*)$/,oa=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,os=/($^)/,Is=/['\n\r\u2028\u2029\\]/g,la="\\ud800-\\udfff",Yd="\\u0300-\\u036f",gl="\\ufe20-\\ufe2f",Ms="\\u20d0-\\u20ff",ca=Yd+gl+Ms,hc="\\u2700-\\u27bf",fc="a-z\\xdf-\\xf6\\xf8-\\xff",vo="\\xac\\xb1\\xd7\\xf7",pc="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Nu="\\u2000-\\u206f",Wd=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",mc="A-Z\\xc0-\\xd6\\xd8-\\xde",pr="\\ufe0e\\ufe0f",Rs=vo+pc+Nu+Wd,gc="[']",Os="["+la+"]",yc="["+Rs+"]",ua="["+ca+"]",Su="\\d+",tr="["+hc+"]",yl="["+fc+"]",wo="[^"+la+Rs+Su+hc+fc+mc+"]",No="\\ud83c[\\udffb-\\udfff]",Ia="(?:"+ua+"|"+No+")",So="[^"+la+"]",Ls="(?:\\ud83c[\\udde6-\\uddff]){2}",ls="[\\ud800-\\udbff][\\udc00-\\udfff]",Ma="["+mc+"]",xl="\\u200d",bl="(?:"+yl+"|"+wo+")",cs="(?:"+Ma+"|"+wo+")",vl="(?:"+gc+"(?:d|ll|m|re|s|t|ve))?",xc="(?:"+gc+"(?:D|LL|M|RE|S|T|VE))?",Fs=Ia+"?",jo="["+pr+"]?",wl="(?:"+xl+"(?:"+[So,Ls,ls].join("|")+")"+jo+Fs+")*",sr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",us="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",bc=jo+Fs+wl,Ra="(?:"+[tr,Ls,ls].join("|")+")"+bc,_o="(?:"+[So+ua+"?",ua,Ls,ls,Os].join("|")+")",Nl=RegExp(gc,"g"),kr=RegExp(ua,"g"),Co=RegExp(No+"(?="+No+")|"+_o+bc,"g"),$s=RegExp([Ma+"?"+yl+"+"+vl+"(?="+[yc,Ma,"$"].join("|")+")",cs+"+"+xc+"(?="+[yc,Ma+bl,"$"].join("|")+")",Ma+"?"+bl+"+"+vl,Ma+"+"+xc,us,sr,Su,Ra].join("|"),"g"),da=RegExp("["+xl+la+ca+pr+"]"),vc=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,zs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Qd=-1,Mn={};Mn[we]=Mn[Pe]=Mn[Je]=Mn[at]=Mn[ft]=Mn[Ae]=Mn[Ve]=Mn[$e]=Mn[We]=!0,Mn[_e]=Mn[se]=Mn[xe]=Mn[oe]=Mn[Qe]=Mn[ue]=Mn[Ie]=Mn[fe]=Mn[Re]=Mn[Ye]=Mn[Ge]=Mn[Ue]=Mn[ze]=Mn[lt]=Mn[Te]=!1;var Tn={};Tn[_e]=Tn[se]=Tn[xe]=Tn[Qe]=Tn[oe]=Tn[ue]=Tn[we]=Tn[Pe]=Tn[Je]=Tn[at]=Tn[ft]=Tn[Re]=Tn[Ye]=Tn[Ge]=Tn[Ue]=Tn[ze]=Tn[lt]=Tn[Ke]=Tn[Ae]=Tn[Ve]=Tn[$e]=Tn[We]=!0,Tn[Ie]=Tn[fe]=Tn[Te]=!1;var ju={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},nn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Oa={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Bs={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Us=parseFloat,Sl=parseInt,ds=typeof fu=="object"&&fu&&fu.Object===Object&&fu,_u=typeof self=="object"&&self&&self.Object===Object&&self,hi=ds||_u||Function("return this")(),Qr=n&&!n.nodeType&&n,La=Qr&&!0&&e&&!e.nodeType&&e,wc=La&&La.exports===Qr,ko=wc&&ds.process,Li=function(){try{var ke=La&&La.require&&La.require("util").types;return ke||ko&&ko.binding&&ko.binding("util")}catch{}}(),jl=Li&&Li.isArrayBuffer,Fa=Li&&Li.isDate,_l=Li&&Li.isMap,Jd=Li&&Li.isRegExp,Kd=Li&&Li.isSet,Cl=Li&&Li.isTypedArray;function nr(ke,Xe,He){switch(He.length){case 0:return ke.call(Xe);case 1:return ke.call(Xe,He[0]);case 2:return ke.call(Xe,He[0],He[1]);case 3:return ke.call(Xe,He[0],He[1],He[2])}return ke.apply(Xe,He)}function Eo(ke,Xe,He,jt){for(var zt=-1,bn=ke==null?0:ke.length;++zt<bn;){var wi=ke[zt];Xe(jt,wi,He(wi),ke)}return jt}function Er(ke,Xe){for(var He=-1,jt=ke==null?0:ke.length;++He<jt&&Xe(ke[He],He,ke)!==!1;);return ke}function Xd(ke,Xe){for(var He=ke==null?0:ke.length;He--&&Xe(ke[He],He,ke)!==!1;);return ke}function qs(ke,Xe){for(var He=-1,jt=ke==null?0:ke.length;++He<jt;)if(!Xe(ke[He],He,ke))return!1;return!0}function Gi(ke,Xe){for(var He=-1,jt=ke==null?0:ke.length,zt=0,bn=[];++He<jt;){var wi=ke[He];Xe(wi,He,ke)&&(bn[zt++]=wi)}return bn}function hs(ke,Xe){var He=ke==null?0:ke.length;return!!He&&To(ke,Xe,0)>-1}function kl(ke,Xe,He){for(var jt=-1,zt=ke==null?0:ke.length;++jt<zt;)if(He(Xe,ke[jt]))return!0;return!1}function Jn(ke,Xe){for(var He=-1,jt=ke==null?0:ke.length,zt=Array(jt);++He<jt;)zt[He]=Xe(ke[He],He,ke);return zt}function Tr(ke,Xe){for(var He=-1,jt=Xe.length,zt=ke.length;++He<jt;)ke[zt+He]=Xe[He];return ke}function Nc(ke,Xe,He,jt){var zt=-1,bn=ke==null?0:ke.length;for(jt&&bn&&(He=ke[++zt]);++zt<bn;)He=Xe(He,ke[zt],zt,ke);return He}function sp(ke,Xe,He,jt){var zt=ke==null?0:ke.length;for(jt&&zt&&(He=ke[--zt]);zt--;)He=Xe(He,ke[zt],zt,ke);return He}function Cu(ke,Xe){for(var He=-1,jt=ke==null?0:ke.length;++He<jt;)if(Xe(ke[He],He,ke))return!0;return!1}var op=Do("length");function lp(ke){return ke.split("")}function cp(ke){return ke.match(hr)||[]}function Zd(ke,Xe,He){var jt;return He(ke,function(zt,bn,wi){if(Xe(zt,bn,wi))return jt=bn,!1}),jt}function Sc(ke,Xe,He,jt){for(var zt=ke.length,bn=He+(jt?1:-1);jt?bn--:++bn<zt;)if(Xe(ke[bn],bn,ke))return bn;return-1}function To(ke,Xe,He){return Xe===Xe?hp(ke,Xe,He):Sc(ke,Ao,He)}function ku(ke,Xe,He,jt){for(var zt=He-1,bn=ke.length;++zt<bn;)if(jt(ke[zt],Xe))return zt;return-1}function Ao(ke){return ke!==ke}function jc(ke,Xe){var He=ke==null?0:ke.length;return He?_c(ke,Xe)/He:D}function Do(ke){return function(Xe){return Xe==null?t:Xe[ke]}}function El(ke){return function(Xe){return ke==null?t:ke[Xe]}}function Eu(ke,Xe,He,jt,zt){return zt(ke,function(bn,wi,Nn){He=jt?(jt=!1,bn):Xe(He,bn,wi,Nn)}),He}function Tl(ke,Xe){var He=ke.length;for(ke.sort(Xe);He--;)ke[He]=ke[He].value;return ke}function _c(ke,Xe){for(var He,jt=-1,zt=ke.length;++jt<zt;){var bn=Xe(ke[jt]);bn!==t&&(He=He===t?bn:He+bn)}return He}function fs(ke,Xe){for(var He=-1,jt=Array(ke);++He<ke;)jt[He]=Xe(He);return jt}function up(ke,Xe){return Jn(Xe,function(He){return[He,ke[He]]})}function eh(ke){return ke&&ke.slice(0,Au(ke)+1).replace(hn,"")}function mr(ke){return function(Xe){return ke(Xe)}}function Jr(ke,Xe){return Jn(Xe,function(He){return ke[He]})}function gr(ke,Xe){return ke.has(Xe)}function or(ke,Xe){for(var He=-1,jt=ke.length;++He<jt&&To(Xe,ke[He],0)>-1;);return He}function $a(ke,Xe){for(var He=ke.length;He--&&To(Xe,ke[He],0)>-1;);return He}function th(ke,Xe){for(var He=ke.length,jt=0;He--;)ke[He]===Xe&&++jt;return jt}var Al=El(ju),Tu=El(nn);function Cc(ke){return"\\"+Bs[ke]}function kc(ke,Xe){return ke==null?t:ke[Xe]}function za(ke){return da.test(ke)}function nh(ke){return vc.test(ke)}function ih(ke){for(var Xe,He=[];!(Xe=ke.next()).done;)He.push(Xe.value);return He}function Dl(ke){var Xe=-1,He=Array(ke.size);return ke.forEach(function(jt,zt){He[++Xe]=[zt,jt]}),He}function rh(ke,Xe){return function(He){return ke(Xe(He))}}function ps(ke,Xe){for(var He=-1,jt=ke.length,zt=0,bn=[];++He<jt;){var wi=ke[He];(wi===Xe||wi===f)&&(ke[He]=f,bn[zt++]=He)}return bn}function Ec(ke){var Xe=-1,He=Array(ke.size);return ke.forEach(function(jt){He[++Xe]=jt}),He}function dp(ke){var Xe=-1,He=Array(ke.size);return ke.forEach(function(jt){He[++Xe]=[jt,jt]}),He}function hp(ke,Xe,He){for(var jt=He-1,zt=ke.length;++jt<zt;)if(ke[jt]===Xe)return jt;return-1}function yr(ke,Xe,He){for(var jt=He+1;jt--;)if(ke[jt]===Xe)return jt;return jt}function ir(ke){return za(ke)?sh(ke):op(ke)}function Ar(ke){return za(ke)?Pl(ke):lp(ke)}function Au(ke){for(var Xe=ke.length;Xe--&&Ln.test(ke.charAt(Xe)););return Xe}var ah=El(Oa);function sh(ke){for(var Xe=Co.lastIndex=0;Co.test(ke);)++Xe;return Xe}function Pl(ke){return ke.match(Co)||[]}function fp(ke){return ke.match($s)||[]}var Po=function ke(Xe){Xe=Xe==null?hi:ms.defaults(hi.Object(),Xe,ms.pick(hi,zs));var He=Xe.Array,jt=Xe.Date,zt=Xe.Error,bn=Xe.Function,wi=Xe.Math,Nn=Xe.Object,Tc=Xe.RegExp,oh=Xe.String,xr=Xe.TypeError,Ac=He.prototype,lh=bn.prototype,Vs=Nn.prototype,Io=Xe["__core-js_shared__"],Mo=lh.toString,Q=Vs.hasOwnProperty,le=0,ce=function(){var m=/[^.]+$/.exec(Io&&Io.keys&&Io.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),Ne=Vs.toString,tt=Mo.call(Nn),vt=hi._,At=Tc("^"+Mo.call(Q).replace(Pt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ct=wc?Xe.Buffer:t,Kn=Xe.Symbol,Ba=Xe.Uint8Array,Ua=Ct?Ct.allocUnsafe:t,Ro=rh(Nn.getPrototypeOf,Nn),ha=Nn.create,Il=Vs.propertyIsEnumerable,ch=Ac.splice,Dr=Kn?Kn.isConcatSpreadable:t,Ml=Kn?Kn.iterator:t,br=Kn?Kn.toStringTag:t,Du=function(){try{var m=Vo(Nn,"defineProperty");return m({},"",{}),m}catch{}}(),uh=Xe.clearTimeout!==hi.clearTimeout&&Xe.clearTimeout,Rl=jt&&jt.now!==hi.Date.now&&jt.now,pp=Xe.setTimeout!==hi.setTimeout&&Xe.setTimeout,Dc=wi.ceil,Hs=wi.floor,Oo=Nn.getOwnPropertySymbols,dh=Ct?Ct.isBuffer:t,Pu=Xe.isFinite,fa=Ac.join,pa=rh(Nn.keys,Nn),li=wi.max,fi=wi.min,Gs=jt.now,Ol=Xe.parseInt,mp=wi.random,gp=Ac.reverse,Iu=Vo(Xe,"DataView"),Fi=Vo(Xe,"Map"),pi=Vo(Xe,"Promise"),vn=Vo(Xe,"Set"),qa=Vo(Xe,"WeakMap"),Pr=Vo(Nn,"create"),Pc=qa&&new qa,ma={},Eg=to(Iu),Tg=to(Fi),Mu=to(pi),Ru=to(vn),Ag=to(qa),Lo=Kn?Kn.prototype:t,Ll=Lo?Lo.valueOf:t,Fo=Lo?Lo.toString:t;function J(m){if(Ni(m)&&!Jt(m)&&!(m instanceof fn)){if(m instanceof Ir)return m;if(Q.call(m,"__wrapped__"))return zi(m)}return new Ir(m)}var Kr=function(){function m(){}return function(y){if(!gi(y))return{};if(ha)return ha(y);m.prototype=y;var C=new m;return m.prototype=t,C}}();function ga(){}function Ir(m,y){this.__wrapped__=m,this.__actions__=[],this.__chain__=!!y,this.__index__=0,this.__values__=t}J.templateSettings={escape:mt,evaluate:$t,interpolate:en,variable:"",imports:{_:J}},J.prototype=ga.prototype,J.prototype.constructor=J,Ir.prototype=Kr(ga.prototype),Ir.prototype.constructor=Ir;function fn(m){this.__wrapped__=m,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=te,this.__views__=[]}function Ou(){var m=new fn(this.__wrapped__);return m.__actions__=$i(this.__actions__),m.__dir__=this.__dir__,m.__filtered__=this.__filtered__,m.__iteratees__=$i(this.__iteratees__),m.__takeCount__=this.__takeCount__,m.__views__=$i(this.__views__),m}function hh(){if(this.__filtered__){var m=new fn(this);m.__dir__=-1,m.__filtered__=!0}else m=this.clone(),m.__dir__*=-1;return m}function Fl(){var m=this.__wrapped__.value(),y=this.__dir__,C=Jt(m),O=y<0,G=C?m.length:0,re=cy(0,G,this.__views__),me=re.start,je=re.end,Me=je-me,rt=O?je:me-1,ot=this.__iteratees__,ht=ot.length,_t=0,Mt=fi(Me,this.__takeCount__);if(!C||!O&&G==Me&&Mt==Me)return Qg(m,this.__actions__);var Yt=[];e:for(;Me--&&_t<Mt;){rt+=y;for(var mn=-1,Wt=m[rt];++mn<ht;){var jn=ot[mn],Dn=jn.iteratee,Ja=jn.type,ra=Dn(Wt);if(Ja==ae)Wt=ra;else if(!ra){if(Ja==ne)continue e;break e}}Yt[_t++]=Wt}return Yt}fn.prototype=Kr(ga.prototype),fn.prototype.constructor=fn;function ji(m){var y=-1,C=m==null?0:m.length;for(this.clear();++y<C;){var O=m[y];this.set(O[0],O[1])}}function fh(){this.__data__=Pr?Pr(null):{},this.size=0}function Dg(m){var y=this.has(m)&&delete this.__data__[m];return this.size-=y?1:0,y}function ev(m){var y=this.__data__;if(Pr){var C=y[m];return C===d?t:C}return Q.call(y,m)?y[m]:t}function tv(m){var y=this.__data__;return Pr?y[m]!==t:Q.call(y,m)}function nv(m,y){var C=this.__data__;return this.size+=this.has(m)?0:1,C[m]=Pr&&y===t?d:y,this}ji.prototype.clear=fh,ji.prototype.delete=Dg,ji.prototype.get=ev,ji.prototype.has=tv,ji.prototype.set=nv;function Xn(m){var y=-1,C=m==null?0:m.length;for(this.clear();++y<C;){var O=m[y];this.set(O[0],O[1])}}function yp(){this.__data__=[],this.size=0}function Lu(m){var y=this.__data__,C=Rc(y,m);if(C<0)return!1;var O=y.length-1;return C==O?y.pop():ch.call(y,C,1),--this.size,!0}function Fu(m){var y=this.__data__,C=Rc(y,m);return C<0?t:y[C][1]}function xp(m){return Rc(this.__data__,m)>-1}function Ic(m,y){var C=this.__data__,O=Rc(C,m);return O<0?(++this.size,C.push([m,y])):C[O][1]=y,this}Xn.prototype.clear=yp,Xn.prototype.delete=Lu,Xn.prototype.get=Fu,Xn.prototype.has=xp,Xn.prototype.set=Ic;function Mr(m){var y=-1,C=m==null?0:m.length;for(this.clear();++y<C;){var O=m[y];this.set(O[0],O[1])}}function iv(){this.size=0,this.__data__={hash:new ji,map:new(Fi||Xn),string:new ji}}function Pg(m){var y=Bc(this,m).delete(m);return this.size-=y?1:0,y}function rv(m){return Bc(this,m).get(m)}function Ig(m){return Bc(this,m).has(m)}function $l(m,y){var C=Bc(this,m),O=C.size;return C.set(m,y),this.size+=C.size==O?0:1,this}Mr.prototype.clear=iv,Mr.prototype.delete=Pg,Mr.prototype.get=rv,Mr.prototype.has=Ig,Mr.prototype.set=$l;function Ys(m){var y=-1,C=m==null?0:m.length;for(this.__data__=new Mr;++y<C;)this.add(m[y])}function ph(m){return this.__data__.set(m,d),this}function Mg(m){return this.__data__.has(m)}Ys.prototype.add=Ys.prototype.push=ph,Ys.prototype.has=Mg;function vr(m){var y=this.__data__=new Xn(m);this.size=y.size}function Rg(){this.__data__=new Xn,this.size=0}function mh(m){var y=this.__data__,C=y.delete(m);return this.size=y.size,C}function bp(m){return this.__data__.get(m)}function Og(m){return this.__data__.has(m)}function gh(m,y){var C=this.__data__;if(C instanceof Xn){var O=C.__data__;if(!Fi||O.length<a-1)return O.push([m,y]),this.size=++C.size,this;C=this.__data__=new Mr(O)}return C.set(m,y),this.size=C.size,this}vr.prototype.clear=Rg,vr.prototype.delete=mh,vr.prototype.get=bp,vr.prototype.has=Og,vr.prototype.set=gh;function vp(m,y){var C=Jt(m),O=!C&&ao(m),G=!C&&!O&&el(m),re=!C&&!O&&!G&&tu(m),me=C||O||G||re,je=me?fs(m.length,oh):[],Me=je.length;for(var rt in m)(y||Q.call(m,rt))&&!(me&&(rt=="length"||G&&(rt=="offset"||rt=="parent")||re&&(rt=="buffer"||rt=="byteLength"||rt=="byteOffset")||Ya(rt,Me)))&&je.push(rt);return je}function Mc(m){var y=m.length;return y?m[Ch(0,y-1)]:t}function Lg(m,y){return dd($i(m),Ha(y,0,m.length))}function Fg(m){return dd($i(m))}function gs(m,y,C){(C!==t&&!Br(m[y],C)||C===t&&!(y in m))&&Va(m,y,C)}function zl(m,y,C){var O=m[y];(!(Q.call(m,y)&&Br(O,C))||C===t&&!(y in m))&&Va(m,y,C)}function Rc(m,y){for(var C=m.length;C--;)if(Br(m[C][0],y))return C;return-1}function $o(m,y,C,O){return Qs(m,function(G,re,me){y(O,G,C(G),me)}),O}function Ws(m,y){return m&&Lr(y,qi(y),m)}function $u(m,y){return m&&Lr(y,Qi(y),m)}function Va(m,y,C){y=="__proto__"&&Du?Du(m,y,{configurable:!0,enumerable:!0,value:C,writable:!0}):m[y]=C}function zu(m,y){for(var C=-1,O=y.length,G=He(O),re=m==null;++C<O;)G[C]=re?t:_d(m,y[C]);return G}function Ha(m,y,C){return m===m&&(C!==t&&(m=m<=C?m:C),y!==t&&(m=m>=y?m:y)),m}function lr(m,y,C,O,G,re){var me,je=y&g,Me=y&b,rt=y&v;if(C&&(me=G?C(m,O,G,re):C(m)),me!==t)return me;if(!gi(m))return m;var ot=Jt(m);if(ot){if(me=Gp(m),!je)return $i(m,me)}else{var ht=Wi(m),_t=ht==fe||ht==pe;if(el(m))return Fp(m,je);if(ht==Ge||ht==_e||_t&&!G){if(me=Me||_t?{}:Yp(m),!je)return Me?Zu(m,$u(me,m)):Ph(m,Ws(me,m))}else{if(!Tn[ht])return G?m:{};me=Wp(m,ht,je)}}re||(re=new vr);var Mt=re.get(m);if(Mt)return Mt;re.set(m,me),tx(m)?m.forEach(function(Wt){me.add(lr(Wt,y,C,Wt,m,re))}):rf(m)&&m.forEach(function(Wt,jn){me.set(jn,lr(Wt,y,C,jn,m,re))});var Yt=rt?Me?Oh:Rh:Me?Qi:qi,mn=ot?t:Yt(m);return Er(mn||m,function(Wt,jn){mn&&(jn=Wt,Wt=m[jn]),zl(me,jn,lr(Wt,y,C,jn,m,re))}),me}function $g(m){var y=qi(m);return function(C){return wp(C,m,y)}}function wp(m,y,C){var O=C.length;if(m==null)return!O;for(m=Nn(m);O--;){var G=C[O],re=y[G],me=m[G];if(me===t&&!(G in m)||!re(me))return!1}return!0}function Bl(m,y,C){if(typeof m!="function")throw new xr(l);return qc(function(){m.apply(t,C)},y)}function zo(m,y,C,O){var G=-1,re=hs,me=!0,je=m.length,Me=[],rt=y.length;if(!je)return Me;C&&(y=Jn(y,mr(C))),O?(re=kl,me=!1):y.length>=a&&(re=gr,me=!1,y=new Ys(y));e:for(;++G<je;){var ot=m[G],ht=C==null?ot:C(ot);if(ot=O||ot!==0?ot:0,me&&ht===ht){for(var _t=rt;_t--;)if(y[_t]===ht)continue e;Me.push(ot)}else re(y,ht,O)||Me.push(ot)}return Me}var Qs=Up(cr),yh=Up(Lc,!0);function Np(m,y){var C=!0;return Qs(m,function(O,G,re){return C=!!y(O,G,re),C}),C}function Ga(m,y,C){for(var O=-1,G=m.length;++O<G;){var re=m[O],me=y(re);if(me!=null&&(je===t?me===me&&!Sr(me):C(me,je)))var je=me,Me=re}return Me}function ln(m,y,C,O){var G=m.length;for(C=tn(C),C<0&&(C=-C>G?0:G+C),O=O===t||O>G?G:tn(O),O<0&&(O+=G),O=C>O?0:_s(O);C<O;)m[C++]=y;return m}function zn(m,y){var C=[];return Qs(m,function(O,G,re){y(O,G,re)&&C.push(O)}),C}function wn(m,y,C,O,G){var re=-1,me=m.length;for(C||(C=Zs),G||(G=[]);++re<me;){var je=m[re];y>0&&C(je)?y>1?wn(je,y-1,C,O,G):Tr(G,je):O||(G[G.length]=je)}return G}var Oc=Wl(),Ul=Wl(!0);function cr(m,y){return m&&Oc(m,y,qi)}function Lc(m,y){return m&&Ul(m,y,qi)}function Bo(m,y){return Gi(y,function(C){return Wa(m[C])})}function ya(m,y){y=Ks(y,m);for(var C=0,O=y.length;m!=null&&C<O;)m=m[Fn(y[C++])];return C&&C==O?m:t}function zg(m,y,C){var O=y(m);return Jt(m)?O:Tr(O,C(m))}function Sn(m){return m==null?m===t?pt:ut:br&&br in Nn(m)?ly(m):py(m)}function Bu(m,y){return m>y}function Sp(m,y){return m!=null&&Q.call(m,y)}function Bg(m,y){return m!=null&&y in Nn(m)}function Ug(m,y,C){return m>=fi(y,C)&&m<li(y,C)}function jp(m,y,C){for(var O=C?kl:hs,G=m[0].length,re=m.length,me=re,je=He(re),Me=1/0,rt=[];me--;){var ot=m[me];me&&y&&(ot=Jn(ot,mr(y))),Me=fi(ot.length,Me),je[me]=!C&&(y||G>=120&&ot.length>=120)?new Ys(me&&ot):t}ot=m[0];var ht=-1,_t=je[0];e:for(;++ht<G&&rt.length<Me;){var Mt=ot[ht],Yt=y?y(Mt):Mt;if(Mt=C||Mt!==0?Mt:0,!(_t?gr(_t,Yt):O(rt,Yt,C))){for(me=re;--me;){var mn=je[me];if(!(mn?gr(mn,Yt):O(m[me],Yt,C)))continue e}_t&&_t.push(Yt),rt.push(Mt)}}return rt}function _p(m,y,C,O){return cr(m,function(G,re,me){y(O,C(G),re,me)}),O}function ql(m,y,C){y=Ks(y,m),m=Uc(m,y);var O=m==null?m:m[Fn(ur(y))];return O==null?t:nr(O,m,C)}function xh(m){return Ni(m)&&Sn(m)==_e}function Rr(m){return Ni(m)&&Sn(m)==xe}function Ii(m){return Ni(m)&&Sn(m)==ue}function Vl(m,y,C,O,G){return m===y?!0:m==null||y==null||!Ni(m)&&!Ni(y)?m!==m&&y!==y:Uu(m,y,C,O,Vl,G)}function Uu(m,y,C,O,G,re){var me=Jt(m),je=Jt(y),Me=me?se:Wi(m),rt=je?se:Wi(y);Me=Me==_e?Ge:Me,rt=rt==_e?Ge:rt;var ot=Me==Ge,ht=rt==Ge,_t=Me==rt;if(_t&&el(m)){if(!el(y))return!1;me=!0,ot=!1}if(_t&&!ot)return re||(re=new vr),me||tu(m)?sy(m,y,C,O,G,re):oy(m,y,Me,C,O,G,re);if(!(C&S)){var Mt=ot&&Q.call(m,"__wrapped__"),Yt=ht&&Q.call(y,"__wrapped__");if(Mt||Yt){var mn=Mt?m.value():m,Wt=Yt?y.value():y;return re||(re=new vr),G(mn,Wt,C,O,re)}}return _t?(re||(re=new vr),Yi(m,y,C,O,G,re)):!1}function bh(m){return Ni(m)&&Wi(m)==Re}function qu(m,y,C,O){var G=C.length,re=G,me=!O;if(m==null)return!re;for(m=Nn(m);G--;){var je=C[G];if(me&&je[2]?je[1]!==m[je[0]]:!(je[0]in m))return!1}for(;++G<re;){je=C[G];var Me=je[0],rt=m[Me],ot=je[1];if(me&&je[2]){if(rt===t&&!(Me in m))return!1}else{var ht=new vr;if(O)var _t=O(rt,ot,Me,m,y,ht);if(!(_t===t?Vl(ot,rt,S|k,O,ht):_t))return!1}}return!0}function ys(m){if(!gi(m)||Uh(m))return!1;var y=Wa(m)?At:vi;return y.test(to(m))}function vh(m){return Ni(m)&&Sn(m)==Ue}function Cp(m){return Ni(m)&&Wi(m)==ze}function kp(m){return Ni(m)&&Zl(m.length)&&!!Mn[Sn(m)]}function Ep(m){return typeof m=="function"?m:m==null?Fe:typeof m=="object"?Jt(m)?Sh(m[0],m[1]):Ap(m):An(m)}function wh(m){if(!Zn(m))return pa(m);var y=[];for(var C in Nn(m))Q.call(m,C)&&C!="constructor"&&y.push(C);return y}function qg(m){if(!gi(m))return Ho(m);var y=Zn(m),C=[];for(var O in m)O=="constructor"&&(y||!Q.call(m,O))||C.push(O);return C}function Nh(m,y){return m<y}function Tp(m,y){var C=-1,O=Bi(m)?He(m.length):[];return Qs(m,function(G,re,me){O[++C]=y(G,re,me)}),O}function Ap(m){var y=Fh(m);return y.length==1&&y[0][2]?hy(y[0][0],y[0][1]):function(C){return C===m||qu(C,m,y)}}function Sh(m,y){return zh(m)&&dy(y)?hy(Fn(m),y):function(C){var O=_d(C,m);return O===t&&O===y?au(C,m):Vl(y,O,S|k)}}function Vu(m,y,C,O,G){m!==y&&Oc(y,function(re,me){if(G||(G=new vr),gi(re))av(m,y,me,C,Vu,O,G);else{var je=O?O(qh(m,me),re,me+"",m,y,G):t;je===t&&(je=re),gs(m,me,je)}},Qi)}function av(m,y,C,O,G,re,me){var je=qh(m,C),Me=qh(y,C),rt=me.get(Me);if(rt){gs(m,C,rt);return}var ot=re?re(je,Me,C+"",m,y,me):t,ht=ot===t;if(ht){var _t=Jt(Me),Mt=!_t&&el(Me),Yt=!_t&&!Mt&&tu(Me);ot=Me,_t||Mt||Yt?Jt(je)?ot=je:ki(je)?ot=$i(je):Mt?(ht=!1,ot=Fp(Me,!0)):Yt?(ht=!1,ot=zp(Me,!0)):ot=[]:wa(Me)||ao(Me)?(ot=je,ao(je)?ot=rx(je):(!gi(je)||Wa(je))&&(ot=Yp(Me))):ht=!1}ht&&(me.set(Me,ot),G(ot,Me,O,re,me),me.delete(Me)),gs(m,C,ot)}function Dp(m,y){var C=m.length;if(C)return y+=y<0?C:0,Ya(y,C)?m[y]:t}function Pp(m,y,C){y.length?y=Jn(y,function(re){return Jt(re)?function(me){return ya(me,re.length===1?re[0]:re)}:re}):y=[Fe];var O=-1;y=Jn(y,mr(Lt()));var G=Tp(m,function(re,me,je){var Me=Jn(y,function(rt){return rt(re)});return{criteria:Me,index:++O,value:re}});return Tl(G,function(re,me){return Zg(re,me,C)})}function Vg(m,y){return jh(m,y,function(C,O){return au(m,O)})}function jh(m,y,C){for(var O=-1,G=y.length,re={};++O<G;){var me=y[O],je=ya(m,me);C(je,me)&&$c(re,Ks(me,m),je)}return re}function Hg(m){return function(y){return ya(y,m)}}function _h(m,y,C,O){var G=O?ku:To,re=-1,me=y.length,je=m;for(m===y&&(y=$i(y)),C&&(je=Jn(m,mr(C)));++re<me;)for(var Me=0,rt=y[re],ot=C?C(rt):rt;(Me=G(je,ot,Me,O))>-1;)je!==m&&ch.call(je,Me,1),ch.call(m,Me,1);return m}function Ip(m,y){for(var C=m?y.length:0,O=C-1;C--;){var G=y[C];if(C==O||G!==re){var re=G;Ya(G)?ch.call(m,G,1):Wu(m,G)}}return m}function Ch(m,y){return m+Hs(mp()*(y-m+1))}function Gg(m,y,C,O){for(var G=-1,re=li(Dc((y-m)/(C||1)),0),me=He(re);re--;)me[O?re:++G]=m,m+=C;return me}function Mp(m,y){var C="";if(!m||y<1||y>H)return C;do y%2&&(C+=m),y=Hs(y/2),y&&(m+=m);while(y);return C}function an(m,y){return cd(Qp(m,y,Fe),m+"")}function Fc(m){return Mc(ou(m))}function kh(m,y){var C=ou(m);return dd(C,Ha(y,0,C.length))}function $c(m,y,C,O){if(!gi(m))return m;y=Ks(y,m);for(var G=-1,re=y.length,me=re-1,je=m;je!=null&&++G<re;){var Me=Fn(y[G]),rt=C;if(Me==="__proto__"||Me==="constructor"||Me==="prototype")return m;if(G!=me){var ot=je[Me];rt=O?O(ot,Me,je):t,rt===t&&(rt=gi(ot)?ot:Ya(y[G+1])?[]:{})}zl(je,Me,rt),je=je[Me]}return m}var Hu=Pc?function(m,y){return Pc.set(m,y),m}:Fe,Gu=Du?function(m,y){return Du(m,"toString",{configurable:!0,enumerable:!1,value:Le(y),writable:!0})}:Fe;function Yg(m){return dd(ou(m))}function Xr(m,y,C){var O=-1,G=m.length;y<0&&(y=-y>G?0:G+y),C=C>G?G:C,C<0&&(C+=G),G=y>C?0:C-y>>>0,y>>>=0;for(var re=He(G);++O<G;)re[O]=m[O+y];return re}function Wg(m,y){var C;return Qs(m,function(O,G,re){return C=y(O,G,re),!C}),!!C}function Yu(m,y,C){var O=0,G=m==null?O:m.length;if(typeof y=="number"&&y===y&&G<=M){for(;O<G;){var re=O+G>>>1,me=m[re];me!==null&&!Sr(me)&&(C?me<=y:me<y)?O=re+1:G=re}return G}return Eh(m,y,Fe,C)}function Eh(m,y,C,O){var G=0,re=m==null?0:m.length;if(re===0)return 0;y=C(y);for(var me=y!==y,je=y===null,Me=Sr(y),rt=y===t;G<re;){var ot=Hs((G+re)/2),ht=C(m[ot]),_t=ht!==t,Mt=ht===null,Yt=ht===ht,mn=Sr(ht);if(me)var Wt=O||Yt;else rt?Wt=Yt&&(O||_t):je?Wt=Yt&&_t&&(O||!Mt):Me?Wt=Yt&&_t&&!Mt&&(O||!mn):Mt||mn?Wt=!1:Wt=O?ht<=y:ht<y;Wt?G=ot+1:re=ot}return fi(re,ve)}function Rp(m,y){for(var C=-1,O=m.length,G=0,re=[];++C<O;){var me=m[C],je=y?y(me):me;if(!C||!Br(je,Me)){var Me=je;re[G++]=me===0?0:me}}return re}function Th(m){return typeof m=="number"?m:Sr(m)?D:+m}function Or(m){if(typeof m=="string")return m;if(Jt(m))return Jn(m,Or)+"";if(Sr(m))return Fo?Fo.call(m):"";var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function Js(m,y,C){var O=-1,G=hs,re=m.length,me=!0,je=[],Me=je;if(C)me=!1,G=kl;else if(re>=a){var rt=y?null:ry(m);if(rt)return Ec(rt);me=!1,G=gr,Me=new Ys}else Me=y?[]:je;e:for(;++O<re;){var ot=m[O],ht=y?y(ot):ot;if(ot=C||ot!==0?ot:0,me&&ht===ht){for(var _t=Me.length;_t--;)if(Me[_t]===ht)continue e;y&&Me.push(ht),je.push(ot)}else G(Me,ht,C)||(Me!==je&&Me.push(ht),je.push(ot))}return je}function Wu(m,y){return y=Ks(y,m),m=Uc(m,y),m==null||delete m[Fn(ur(y))]}function Op(m,y,C,O){return $c(m,y,C(ya(m,y)),O)}function Qu(m,y,C,O){for(var G=m.length,re=O?G:-1;(O?re--:++re<G)&&y(m[re],re,m););return C?Xr(m,O?0:re,O?re+1:G):Xr(m,O?re+1:0,O?G:re)}function Qg(m,y){var C=m;return C instanceof fn&&(C=C.value()),Nc(y,function(O,G){return G.func.apply(G.thisArg,Tr([O],G.args))},C)}function Ju(m,y,C){var O=m.length;if(O<2)return O?Js(m[0]):[];for(var G=-1,re=He(O);++G<O;)for(var me=m[G],je=-1;++je<O;)je!=G&&(re[G]=zo(re[G]||me,m[je],y,C));return Js(wn(re,1),y,C)}function Lp(m,y,C){for(var O=-1,G=m.length,re=y.length,me={};++O<G;){var je=O<re?y[O]:t;C(me,m[O],je)}return me}function Ah(m){return ki(m)?m:[]}function Ku(m){return typeof m=="function"?m:Fe}function Ks(m,y){return Jt(m)?m:zh(m,y)?[m]:ws(On(m))}var Jg=an;function Uo(m,y,C){var O=m.length;return C=C===t?O:C,!y&&C>=O?m:Xr(m,y,C)}var Kg=uh||function(m){return hi.clearTimeout(m)};function Fp(m,y){if(y)return m.slice();var C=m.length,O=Ua?Ua(C):new m.constructor(C);return m.copy(O),O}function Hl(m){var y=new m.constructor(m.byteLength);return new Ba(y).set(new Ba(m)),y}function $p(m,y){var C=y?Hl(m.buffer):m.buffer;return new m.constructor(C,m.byteOffset,m.byteLength)}function Dh(m){var y=new m.constructor(m.source,Pi.exec(m));return y.lastIndex=m.lastIndex,y}function Xg(m){return Ll?Nn(Ll.call(m)):{}}function zp(m,y){var C=y?Hl(m.buffer):m.buffer;return new m.constructor(C,m.byteOffset,m.length)}function Xu(m,y){if(m!==y){var C=m!==t,O=m===null,G=m===m,re=Sr(m),me=y!==t,je=y===null,Me=y===y,rt=Sr(y);if(!je&&!rt&&!re&&m>y||re&&me&&Me&&!je&&!rt||O&&me&&Me||!C&&Me||!G)return 1;if(!O&&!re&&!rt&&m<y||rt&&C&&G&&!O&&!re||je&&C&&G||!me&&G||!Me)return-1}return 0}function Zg(m,y,C){for(var O=-1,G=m.criteria,re=y.criteria,me=G.length,je=C.length;++O<me;){var Me=Xu(G[O],re[O]);if(Me){if(O>=je)return Me;var rt=C[O];return Me*(rt=="desc"?-1:1)}}return m.index-y.index}function Bp(m,y,C,O){for(var G=-1,re=m.length,me=C.length,je=-1,Me=y.length,rt=li(re-me,0),ot=He(Me+rt),ht=!O;++je<Me;)ot[je]=y[je];for(;++G<me;)(ht||G<re)&&(ot[C[G]]=m[G]);for(;rt--;)ot[je++]=m[G++];return ot}function ey(m,y,C,O){for(var G=-1,re=m.length,me=-1,je=C.length,Me=-1,rt=y.length,ot=li(re-je,0),ht=He(ot+rt),_t=!O;++G<ot;)ht[G]=m[G];for(var Mt=G;++Me<rt;)ht[Mt+Me]=y[Me];for(;++me<je;)(_t||G<re)&&(ht[Mt+C[me]]=m[G++]);return ht}function $i(m,y){var C=-1,O=m.length;for(y||(y=He(O));++C<O;)y[C]=m[C];return y}function Lr(m,y,C,O){var G=!C;C||(C={});for(var re=-1,me=y.length;++re<me;){var je=y[re],Me=O?O(C[je],m[je],je,C,m):t;Me===t&&(Me=m[je]),G?Va(C,je,Me):zl(C,je,Me)}return C}function Ph(m,y){return Lr(m,ad(m),y)}function Zu(m,y){return Lr(m,$h(m),y)}function Gl(m,y){return function(C,O){var G=Jt(C)?Eo:$o,re=y?y():{};return G(C,m,Lt(O,2),re)}}function Yl(m){return an(function(y,C){var O=-1,G=C.length,re=G>1?C[G-1]:t,me=G>2?C[2]:t;for(re=m.length>3&&typeof re=="function"?(G--,re):t,me&&Nr(C[0],C[1],me)&&(re=G<3?t:re,G=1),y=Nn(y);++O<G;){var je=C[O];je&&m(y,je,O,re)}return y})}function Up(m,y){return function(C,O){if(C==null)return C;if(!Bi(C))return m(C,O);for(var G=C.length,re=y?G:-1,me=Nn(C);(y?re--:++re<G)&&O(me[re],re,me)!==!1;);return C}}function Wl(m){return function(y,C,O){for(var G=-1,re=Nn(y),me=O(y),je=me.length;je--;){var Me=me[m?je:++G];if(C(re[Me],Me,re)===!1)break}return y}}function ty(m,y,C){var O=y&T,G=xa(m);function re(){var me=this&&this!==hi&&this instanceof re?G:m;return me.apply(O?C:this,arguments)}return re}function Zr(m){return function(y){y=On(y);var C=za(y)?Ar(y):t,O=C?C[0]:y.charAt(0),G=C?Uo(C,1).join(""):y.slice(1);return O[m]()+G}}function wr(m){return function(y){return Nc(N(so(y).replace(Nl,"")),m,"")}}function xa(m){return function(){var y=arguments;switch(y.length){case 0:return new m;case 1:return new m(y[0]);case 2:return new m(y[0],y[1]);case 3:return new m(y[0],y[1],y[2]);case 4:return new m(y[0],y[1],y[2],y[3]);case 5:return new m(y[0],y[1],y[2],y[3],y[4]);case 6:return new m(y[0],y[1],y[2],y[3],y[4],y[5]);case 7:return new m(y[0],y[1],y[2],y[3],y[4],y[5],y[6])}var C=Kr(m.prototype),O=m.apply(C,y);return gi(O)?O:C}}function ny(m,y,C){var O=xa(m);function G(){for(var re=arguments.length,me=He(re),je=re,Me=Jl(G);je--;)me[je]=arguments[je];var rt=re<3&&me[0]!==Me&&me[re-1]!==Me?[]:ps(me,Me);if(re-=rt.length,re<C)return qp(m,y,_i,G.placeholder,t,me,rt,t,t,C-re);var ot=this&&this!==hi&&this instanceof G?O:m;return nr(ot,this,me)}return G}function Xs(m){return function(y,C,O){var G=Nn(y);if(!Bi(y)){var re=Lt(C,3);y=qi(y),C=function(je){return re(G[je],je,G)}}var me=m(y,C,O);return me>-1?G[re?y[me]:me]:t}}function xs(m){return ci(function(y){var C=y.length,O=C,G=Ir.prototype.thru;for(m&&y.reverse();O--;){var re=y[O];if(typeof re!="function")throw new xr(l);if(G&&!me&&rd(re)=="wrapper")var me=new Ir([],!0)}for(O=me?O:C;++O<C;){re=y[O];var je=rd(re),Me=je=="wrapper"?Lh(re):t;Me&&Bh(Me[0])&&Me[1]==(F|I|$|z)&&!Me[4].length&&Me[9]==1?me=me[rd(Me[0])].apply(me,Me[3]):me=re.length==1&&Bh(re)?me[je]():me.thru(re)}return function(){var rt=arguments,ot=rt[0];if(me&&rt.length==1&&Jt(ot))return me.plant(ot).value();for(var ht=0,_t=C?y[ht].apply(this,rt):ot;++ht<C;)_t=y[ht].call(this,_t);return _t}})}function _i(m,y,C,O,G,re,me,je,Me,rt){var ot=y&F,ht=y&T,_t=y&E,Mt=y&(I|q),Yt=y&B,mn=_t?t:xa(m);function Wt(){for(var jn=arguments.length,Dn=He(jn),Ja=jn;Ja--;)Dn[Ja]=arguments[Ja];if(Mt)var ra=Jl(Wt),Ka=th(Dn,ra);if(O&&(Dn=Bp(Dn,O,G,Mt)),re&&(Dn=ey(Dn,re,me,Mt)),jn-=Ka,Mt&&jn<rt){var Vi=ps(Dn,ra);return qp(m,y,_i,Wt.placeholder,C,Dn,Vi,je,Me,rt-jn)}var oo=ht?C:this,ec=_t?oo[m]:m;return jn=Dn.length,je?Dn=vs(Dn,je):Yt&&jn>1&&Dn.reverse(),ot&&Me<jn&&(Dn.length=Me),this&&this!==hi&&this instanceof Wt&&(ec=mn||xa(ec)),ec.apply(oo,Dn)}return Wt}function ed(m,y){return function(C,O){return _p(C,m,y(O),{})}}function zc(m,y){return function(C,O){var G;if(C===t&&O===t)return y;if(C!==t&&(G=C),O!==t){if(G===t)return O;typeof C=="string"||typeof O=="string"?(C=Or(C),O=Or(O)):(C=Th(C),O=Th(O)),G=m(C,O)}return G}}function td(m){return ci(function(y){return y=Jn(y,mr(Lt())),an(function(C){var O=this;return m(y,function(G){return nr(G,O,C)})})})}function nd(m,y){y=y===t?" ":Or(y);var C=y.length;if(C<2)return C?Mp(y,m):y;var O=Mp(y,Dc(m/ir(y)));return za(y)?Uo(Ar(O),0,m).join(""):O.slice(0,m)}function iy(m,y,C,O){var G=y&T,re=xa(m);function me(){for(var je=-1,Me=arguments.length,rt=-1,ot=O.length,ht=He(ot+Me),_t=this&&this!==hi&&this instanceof me?re:m;++rt<ot;)ht[rt]=O[rt];for(;Me--;)ht[rt++]=arguments[++je];return nr(_t,G?C:this,ht)}return me}function qo(m){return function(y,C,O){return O&&typeof O!="number"&&Nr(y,C,O)&&(C=O=t),y=js(y),C===t?(C=y,y=0):C=js(C),O=O===t?y<C?1:-1:js(O),Gg(y,C,O,m)}}function Ql(m){return function(y,C){return typeof y=="string"&&typeof C=="string"||(y=Na(y),C=Na(C)),m(y,C)}}function qp(m,y,C,O,G,re,me,je,Me,rt){var ot=y&I,ht=ot?me:t,_t=ot?t:me,Mt=ot?re:t,Yt=ot?t:re;y|=ot?$:L,y&=~(ot?L:$),y&P||(y&=-4);var mn=[m,y,G,Mt,ht,Yt,_t,je,Me,rt],Wt=C.apply(t,mn);return Bh(m)&&Vh(Wt,mn),Wt.placeholder=O,Hh(Wt,m,y)}function Ih(m){var y=wi[m];return function(C,O){if(C=Na(C),O=O==null?0:fi(tn(O),292),O&&Pu(C)){var G=(On(C)+"e").split("e"),re=y(G[0]+"e"+(+G[1]+O));return G=(On(re)+"e").split("e"),+(G[0]+"e"+(+G[1]-O))}return y(C)}}var ry=vn&&1/Ec(new vn([,-0]))[1]==W?function(m){return new vn(m)}:Dt;function id(m){return function(y){var C=Wi(y);return C==Re?Dl(y):C==ze?dp(y):up(y,m(y))}}function bs(m,y,C,O,G,re,me,je){var Me=y&E;if(!Me&&typeof m!="function")throw new xr(l);var rt=O?O.length:0;if(rt||(y&=-97,O=G=t),me=me===t?me:li(tn(me),0),je=je===t?je:tn(je),rt-=G?G.length:0,y&L){var ot=O,ht=G;O=G=t}var _t=Me?t:Lh(m),Mt=[m,y,C,O,G,ot,ht,re,me,je];if(_t&&ld(Mt,_t),m=Mt[0],y=Mt[1],C=Mt[2],O=Mt[3],G=Mt[4],je=Mt[9]=Mt[9]===t?Me?0:m.length:li(Mt[9]-rt,0),!je&&y&(I|q)&&(y&=-25),!y||y==T)var Yt=ty(m,y,C);else y==I||y==q?Yt=ny(m,y,je):(y==$||y==(T|$))&&!G.length?Yt=iy(m,y,C,O):Yt=_i.apply(t,Mt);var mn=_t?Hu:Vh;return Hh(mn(Yt,Mt),m,y)}function Mh(m,y,C,O){return m===t||Br(m,Vs[C])&&!Q.call(O,C)?y:m}function Vp(m,y,C,O,G,re){return gi(m)&&gi(y)&&(re.set(y,m),Vu(m,y,t,Vp,re),re.delete(y)),m}function ay(m){return wa(m)?t:m}function sy(m,y,C,O,G,re){var me=C&S,je=m.length,Me=y.length;if(je!=Me&&!(me&&Me>je))return!1;var rt=re.get(m),ot=re.get(y);if(rt&&ot)return rt==y&&ot==m;var ht=-1,_t=!0,Mt=C&k?new Ys:t;for(re.set(m,y),re.set(y,m);++ht<je;){var Yt=m[ht],mn=y[ht];if(O)var Wt=me?O(mn,Yt,ht,y,m,re):O(Yt,mn,ht,m,y,re);if(Wt!==t){if(Wt)continue;_t=!1;break}if(Mt){if(!Cu(y,function(jn,Dn){if(!gr(Mt,Dn)&&(Yt===jn||G(Yt,jn,C,O,re)))return Mt.push(Dn)})){_t=!1;break}}else if(!(Yt===mn||G(Yt,mn,C,O,re))){_t=!1;break}}return re.delete(m),re.delete(y),_t}function oy(m,y,C,O,G,re,me){switch(C){case Qe:if(m.byteLength!=y.byteLength||m.byteOffset!=y.byteOffset)return!1;m=m.buffer,y=y.buffer;case xe:return!(m.byteLength!=y.byteLength||!re(new Ba(m),new Ba(y)));case oe:case ue:case Ye:return Br(+m,+y);case Ie:return m.name==y.name&&m.message==y.message;case Ue:case lt:return m==y+"";case Re:var je=Dl;case ze:var Me=O&S;if(je||(je=Ec),m.size!=y.size&&!Me)return!1;var rt=me.get(m);if(rt)return rt==y;O|=k,me.set(m,y);var ot=sy(je(m),je(y),O,G,re,me);return me.delete(m),ot;case Ke:if(Ll)return Ll.call(m)==Ll.call(y)}return!1}function Yi(m,y,C,O,G,re){var me=C&S,je=Rh(m),Me=je.length,rt=Rh(y),ot=rt.length;if(Me!=ot&&!me)return!1;for(var ht=Me;ht--;){var _t=je[ht];if(!(me?_t in y:Q.call(y,_t)))return!1}var Mt=re.get(m),Yt=re.get(y);if(Mt&&Yt)return Mt==y&&Yt==m;var mn=!0;re.set(m,y),re.set(y,m);for(var Wt=me;++ht<Me;){_t=je[ht];var jn=m[_t],Dn=y[_t];if(O)var Ja=me?O(Dn,jn,_t,y,m,re):O(jn,Dn,_t,m,y,re);if(!(Ja===t?jn===Dn||G(jn,Dn,C,O,re):Ja)){mn=!1;break}Wt||(Wt=_t=="constructor")}if(mn&&!Wt){var ra=m.constructor,Ka=y.constructor;ra!=Ka&&"constructor"in m&&"constructor"in y&&!(typeof ra=="function"&&ra instanceof ra&&typeof Ka=="function"&&Ka instanceof Ka)&&(mn=!1)}return re.delete(m),re.delete(y),mn}function ci(m){return cd(Qp(m,t,$r),m+"")}function Rh(m){return zg(m,qi,ad)}function Oh(m){return zg(m,Qi,$h)}var Lh=Pc?function(m){return Pc.get(m)}:Dt;function rd(m){for(var y=m.name+"",C=ma[y],O=Q.call(ma,y)?C.length:0;O--;){var G=C[O],re=G.func;if(re==null||re==m)return G.name}return y}function Jl(m){var y=Q.call(J,"placeholder")?J:m;return y.placeholder}function Lt(){var m=J.iteratee||qt;return m=m===qt?Ep:m,arguments.length?m(arguments[0],arguments[1]):m}function Bc(m,y){var C=m.__data__;return eo(y)?C[typeof y=="string"?"string":"hash"]:C.map}function Fh(m){for(var y=qi(m),C=y.length;C--;){var O=y[C],G=m[O];y[C]=[O,G,dy(G)]}return y}function Vo(m,y){var C=kc(m,y);return ys(C)?C:t}function ly(m){var y=Q.call(m,br),C=m[br];try{m[br]=t;var O=!0}catch{}var G=Ne.call(m);return O&&(y?m[br]=C:delete m[br]),G}var ad=Oo?function(m){return m==null?[]:(m=Nn(m),Gi(Oo(m),function(y){return Il.call(m,y)}))}:Uv,$h=Oo?function(m){for(var y=[];m;)Tr(y,ad(m)),m=Ro(m);return y}:Uv,Wi=Sn;(Iu&&Wi(new Iu(new ArrayBuffer(1)))!=Qe||Fi&&Wi(new Fi)!=Re||pi&&Wi(pi.resolve())!=Se||vn&&Wi(new vn)!=ze||qa&&Wi(new qa)!=Te)&&(Wi=function(m){var y=Sn(m),C=y==Ge?m.constructor:t,O=C?to(C):"";if(O)switch(O){case Eg:return Qe;case Tg:return Re;case Mu:return Se;case Ru:return ze;case Ag:return Te}return y});function cy(m,y,C){for(var O=-1,G=C.length;++O<G;){var re=C[O],me=re.size;switch(re.type){case"drop":m+=me;break;case"dropRight":y-=me;break;case"take":y=fi(y,m+me);break;case"takeRight":m=li(m,y-me);break}}return{start:m,end:y}}function Hp(m){var y=m.match(Oi);return y?y[1].split(Si):[]}function sd(m,y,C){y=Ks(y,m);for(var O=-1,G=y.length,re=!1;++O<G;){var me=Fn(y[O]);if(!(re=m!=null&&C(m,me)))break;m=m[me]}return re||++O!=G?re:(G=m==null?0:m.length,!!G&&Zl(G)&&Ya(me,G)&&(Jt(m)||ao(m)))}function Gp(m){var y=m.length,C=new m.constructor(y);return y&&typeof m[0]=="string"&&Q.call(m,"index")&&(C.index=m.index,C.input=m.input),C}function Yp(m){return typeof m.constructor=="function"&&!Zn(m)?Kr(Ro(m)):{}}function Wp(m,y,C){var O=m.constructor;switch(y){case xe:return Hl(m);case oe:case ue:return new O(+m);case Qe:return $p(m,C);case we:case Pe:case Je:case at:case ft:case Ae:case Ve:case $e:case We:return zp(m,C);case Re:return new O;case Ye:case lt:return new O(m);case Ue:return Dh(m);case ze:return new O;case Ke:return Xg(m)}}function uy(m,y){var C=y.length;if(!C)return m;var O=C-1;return y[O]=(C>1?"& ":"")+y[O],y=y.join(C>2?", ":" "),m.replace(Qn,`{
/* [wrapped with `+y+`] */
`)}function Zs(m){return Jt(m)||ao(m)||!!(Dr&&m&&m[Dr])}function Ya(m,y){var C=typeof m;return y=y??H,!!y&&(C=="number"||C!="symbol"&&fr.test(m))&&m>-1&&m%1==0&&m<y}function Nr(m,y,C){if(!gi(C))return!1;var O=typeof y;return(O=="number"?Bi(C)&&Ya(y,C.length):O=="string"&&y in C)?Br(C[y],m):!1}function zh(m,y){if(Jt(m))return!1;var C=typeof m;return C=="number"||C=="symbol"||C=="boolean"||m==null||Sr(m)?!0:nt.test(m)||!be.test(m)||y!=null&&m in Nn(y)}function eo(m){var y=typeof m;return y=="string"||y=="number"||y=="symbol"||y=="boolean"?m!=="__proto__":m===null}function Bh(m){var y=rd(m),C=J[y];if(typeof C!="function"||!(y in fn.prototype))return!1;if(m===C)return!0;var O=Lh(C);return!!O&&m===O[0]}function Uh(m){return!!ce&&ce in m}var od=Io?Wa:qv;function Zn(m){var y=m&&m.constructor,C=typeof y=="function"&&y.prototype||Vs;return m===C}function dy(m){return m===m&&!gi(m)}function hy(m,y){return function(C){return C==null?!1:C[m]===y&&(y!==t||m in Nn(C))}}function fy(m){var y=bd(m,function(O){return C.size===u&&C.clear(),O}),C=y.cache;return y}function ld(m,y){var C=m[1],O=y[1],G=C|O,re=G<(T|E|F),me=O==F&&C==I||O==F&&C==z&&m[7].length<=y[8]||O==(F|z)&&y[7].length<=y[8]&&C==I;if(!(re||me))return m;O&T&&(m[2]=y[2],G|=C&T?0:P);var je=y[3];if(je){var Me=m[3];m[3]=Me?Bp(Me,je,y[4]):je,m[4]=Me?ps(m[3],f):y[4]}return je=y[5],je&&(Me=m[5],m[5]=Me?ey(Me,je,y[6]):je,m[6]=Me?ps(m[5],f):y[6]),je=y[7],je&&(m[7]=je),O&F&&(m[8]=m[8]==null?y[8]:fi(m[8],y[8])),m[9]==null&&(m[9]=y[9]),m[0]=y[0],m[1]=G,m}function Ho(m){var y=[];if(m!=null)for(var C in Nn(m))y.push(C);return y}function py(m){return Ne.call(m)}function Qp(m,y,C){return y=li(y===t?m.length-1:y,0),function(){for(var O=arguments,G=-1,re=li(O.length-y,0),me=He(re);++G<re;)me[G]=O[y+G];G=-1;for(var je=He(y+1);++G<y;)je[G]=O[G];return je[y]=C(me),nr(m,this,je)}}function Uc(m,y){return y.length<2?m:ya(m,Xr(y,0,-1))}function vs(m,y){for(var C=m.length,O=fi(y.length,C),G=$i(m);O--;){var re=y[O];m[O]=Ya(re,C)?G[re]:t}return m}function qh(m,y){if(!(y==="constructor"&&typeof m[y]=="function")&&y!="__proto__")return m[y]}var Vh=ud(Hu),qc=pp||function(m,y){return hi.setTimeout(m,y)},cd=ud(Gu);function Hh(m,y,C){var O=y+"";return cd(m,uy(O,my(Hp(O),C)))}function ud(m){var y=0,C=0;return function(){var O=Gs(),G=Z-(O-C);if(C=O,G>0){if(++y>=Y)return arguments[0]}else y=0;return m.apply(t,arguments)}}function dd(m,y){var C=-1,O=m.length,G=O-1;for(y=y===t?O:y;++C<y;){var re=Ch(C,G),me=m[re];m[re]=m[C],m[C]=me}return m.length=y,m}var ws=fy(function(m){var y=[];return m.charCodeAt(0)===46&&y.push(""),m.replace(Ze,function(C,O,G,re){y.push(G?re.replace(ni,"$1"):O||C)}),y});function Fn(m){if(typeof m=="string"||Sr(m))return m;var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function to(m){if(m!=null){try{return Mo.call(m)}catch{}try{return m+""}catch{}}return""}function my(m,y){return Er(ge,function(C){var O="_."+C[0];y&C[1]&&!hs(m,O)&&m.push(O)}),m.sort()}function zi(m){if(m instanceof fn)return m.clone();var y=new Ir(m.__wrapped__,m.__chain__);return y.__actions__=$i(m.__actions__),y.__index__=m.__index__,y.__values__=m.__values__,y}function sv(m,y,C){(C?Nr(m,y,C):y===t)?y=1:y=li(tn(y),0);var O=m==null?0:m.length;if(!O||y<1)return[];for(var G=0,re=0,me=He(Dc(O/y));G<O;)me[re++]=Xr(m,G,G+=y);return me}function gy(m){for(var y=-1,C=m==null?0:m.length,O=0,G=[];++y<C;){var re=m[y];re&&(G[O++]=re)}return G}function yy(){var m=arguments.length;if(!m)return[];for(var y=He(m-1),C=arguments[0],O=m;O--;)y[O-1]=arguments[O];return Tr(Jt(C)?$i(C):[C],wn(y,1))}var mi=an(function(m,y){return ki(m)?zo(m,wn(y,1,ki,!0)):[]}),Fr=an(function(m,y){var C=ur(y);return ki(C)&&(C=t),ki(m)?zo(m,wn(y,1,ki,!0),Lt(C,2)):[]}),no=an(function(m,y){var C=ur(y);return ki(C)&&(C=t),ki(m)?zo(m,wn(y,1,ki,!0),t,C):[]});function xy(m,y,C){var O=m==null?0:m.length;return O?(y=C||y===t?1:tn(y),Xr(m,y<0?0:y,O)):[]}function by(m,y,C){var O=m==null?0:m.length;return O?(y=C||y===t?1:tn(y),y=O-y,Xr(m,0,y<0?0:y)):[]}function ov(m,y){return m&&m.length?Qu(m,Lt(y,3),!0,!0):[]}function Jp(m,y){return m&&m.length?Qu(m,Lt(y,3),!0):[]}function ea(m,y,C,O){var G=m==null?0:m.length;return G?(C&&typeof C!="number"&&Nr(m,y,C)&&(C=0,O=G),ln(m,y,C,O)):[]}function ba(m,y,C){var O=m==null?0:m.length;if(!O)return-1;var G=C==null?0:tn(C);return G<0&&(G=li(O+G,0)),Sc(m,Lt(y,3),G)}function Kp(m,y,C){var O=m==null?0:m.length;if(!O)return-1;var G=O-1;return C!==t&&(G=tn(C),G=C<0?li(O+G,0):fi(G,O-1)),Sc(m,Lt(y,3),G,!0)}function $r(m){var y=m==null?0:m.length;return y?wn(m,1):[]}function vy(m){var y=m==null?0:m.length;return y?wn(m,W):[]}function Go(m,y){var C=m==null?0:m.length;return C?(y=y===t?1:tn(y),wn(m,y)):[]}function Kl(m){for(var y=-1,C=m==null?0:m.length,O={};++y<C;){var G=m[y];O[G[0]]=G[1]}return O}function io(m){return m&&m.length?m[0]:t}function Xp(m,y,C){var O=m==null?0:m.length;if(!O)return-1;var G=C==null?0:tn(C);return G<0&&(G=li(O+G,0)),To(m,y,G)}function Zp(m){var y=m==null?0:m.length;return y?Xr(m,0,-1):[]}var Ns=an(function(m){var y=Jn(m,Ah);return y.length&&y[0]===m[0]?jp(y):[]}),wy=an(function(m){var y=ur(m),C=Jn(m,Ah);return y===ur(C)?y=t:C.pop(),C.length&&C[0]===m[0]?jp(C,Lt(y,2)):[]}),Vc=an(function(m){var y=ur(m),C=Jn(m,Ah);return y=typeof y=="function"?y:t,y&&C.pop(),C.length&&C[0]===m[0]?jp(C,t,y):[]});function hd(m,y){return m==null?"":fa.call(m,y)}function ur(m){var y=m==null?0:m.length;return y?m[y-1]:t}function Hc(m,y,C){var O=m==null?0:m.length;if(!O)return-1;var G=O;return C!==t&&(G=tn(C),G=G<0?li(O+G,0):fi(G,O-1)),y===y?yr(m,y,G):Sc(m,Ao,G,!0)}function Ny(m,y){return m&&m.length?Dp(m,tn(y)):t}var Sy=an(Gc);function Gc(m,y){return m&&m.length&&y&&y.length?_h(m,y):m}function jy(m,y,C){return m&&m.length&&y&&y.length?_h(m,y,Lt(C,2)):m}function Gh(m,y,C){return m&&m.length&&y&&y.length?_h(m,y,t,C):m}var _y=ci(function(m,y){var C=m==null?0:m.length,O=zu(m,y);return Ip(m,Jn(y,function(G){return Ya(G,C)?+G:G}).sort(Xu)),O});function lv(m,y){var C=[];if(!(m&&m.length))return C;var O=-1,G=[],re=m.length;for(y=Lt(y,3);++O<re;){var me=m[O];y(me,O,m)&&(C.push(me),G.push(O))}return Ip(m,G),C}function em(m){return m==null?m:gp.call(m)}function Bn(m,y,C){var O=m==null?0:m.length;return O?(C&&typeof C!="number"&&Nr(m,y,C)?(y=0,C=O):(y=y==null?0:tn(y),C=C===t?O:tn(C)),Xr(m,y,C)):[]}function ii(m,y){return Yu(m,y)}function yn(m,y,C){return Eh(m,y,Lt(C,2))}function En(m,y){var C=m==null?0:m.length;if(C){var O=Yu(m,y);if(O<C&&Br(m[O],y))return O}return-1}function Un(m,y){return Yu(m,y,!0)}function ta(m,y,C){return Eh(m,y,Lt(C,2),!0)}function Yo(m,y){var C=m==null?0:m.length;if(C){var O=Yu(m,y,!0)-1;if(Br(m[O],y))return O}return-1}function Yc(m){return m&&m.length?Rp(m):[]}function tm(m,y){return m&&m.length?Rp(m,Lt(y,2)):[]}function ro(m){var y=m==null?0:m.length;return y?Xr(m,1,y):[]}function Ci(m,y,C){return m&&m.length?(y=C||y===t?1:tn(y),Xr(m,0,y<0?0:y)):[]}function Wo(m,y,C){var O=m==null?0:m.length;return O?(y=C||y===t?1:tn(y),y=O-y,Xr(m,y<0?0:y,O)):[]}function Xl(m,y){return m&&m.length?Qu(m,Lt(y,3),!1,!0):[]}function nm(m,y){return m&&m.length?Qu(m,Lt(y,3)):[]}var va=an(function(m){return Js(wn(m,1,ki,!0))}),Wc=an(function(m){var y=ur(m);return ki(y)&&(y=t),Js(wn(m,1,ki,!0),Lt(y,2))}),fd=an(function(m){var y=ur(m);return y=typeof y=="function"?y:t,Js(wn(m,1,ki,!0),t,y)});function zr(m){return m&&m.length?Js(m):[]}function im(m,y){return m&&m.length?Js(m,Lt(y,2)):[]}function rm(m,y){return y=typeof y=="function"?y:t,m&&m.length?Js(m,t,y):[]}function Qc(m){if(!(m&&m.length))return[];var y=0;return m=Gi(m,function(C){if(ki(C))return y=li(C.length,y),!0}),fs(y,function(C){return Jn(m,Do(C))})}function pd(m,y){if(!(m&&m.length))return[];var C=Qc(m);return y==null?C:Jn(C,function(O){return nr(y,t,O)})}var Qo=an(function(m,y){return ki(m)?zo(m,y):[]}),rr=an(function(m){return Ju(Gi(m,ki))}),Jo=an(function(m){var y=ur(m);return ki(y)&&(y=t),Ju(Gi(m,ki),Lt(y,2))}),Jc=an(function(m){var y=ur(m);return y=typeof y=="function"?y:t,Ju(Gi(m,ki),t,y)}),Kc=an(Qc);function am(m,y){return Lp(m||[],y||[],zl)}function sm(m,y){return Lp(m||[],y||[],$c)}var Cy=an(function(m){var y=m.length,C=y>1?m[y-1]:t;return C=typeof C=="function"?(m.pop(),C):t,pd(m,C)});function Xc(m){var y=J(m);return y.__chain__=!0,y}function om(m,y){return y(m),m}function dr(m,y){return y(m)}var ky=ci(function(m){var y=m.length,C=y?m[0]:0,O=this.__wrapped__,G=function(re){return zu(re,m)};return y>1||this.__actions__.length||!(O instanceof fn)||!Ya(C)?this.thru(G):(O=O.slice(C,+C+(y?1:0)),O.__actions__.push({func:dr,args:[G],thisArg:t}),new Ir(O,this.__chain__).thru(function(re){return y&&!re.length&&re.push(t),re}))});function na(){return Xc(this)}function Ey(){return new Ir(this.value(),this.__chain__)}function Ty(){this.__values__===t&&(this.__values__=ia(this.value()));var m=this.__index__>=this.__values__.length,y=m?t:this.__values__[this.__index__++];return{done:m,value:y}}function cv(){return this}function Ko(m){for(var y,C=this;C instanceof ga;){var O=zi(C);O.__index__=0,O.__values__=t,y?G.__wrapped__=O:y=O;var G=O;C=C.__wrapped__}return G.__wrapped__=m,y}function Yh(){var m=this.__wrapped__;if(m instanceof fn){var y=m;return this.__actions__.length&&(y=new fn(this)),y=y.reverse(),y.__actions__.push({func:dr,args:[em],thisArg:t}),new Ir(y,this.__chain__)}return this.thru(em)}function lm(){return Qg(this.__wrapped__,this.__actions__)}var Zc=Gl(function(m,y,C){Q.call(m,C)?++m[C]:Va(m,C,1)});function Ay(m,y,C){var O=Jt(m)?qs:Np;return C&&Nr(m,y,C)&&(y=t),O(m,Lt(y,3))}function Dy(m,y){var C=Jt(m)?Gi:zn;return C(m,Lt(y,3))}var Py=Xs(ba),cm=Xs(Kp);function um(m,y){return wn(md(m,y),1)}function uv(m,y){return wn(md(m,y),W)}function dv(m,y,C){return C=C===t?1:tn(C),wn(md(m,y),C)}function Iy(m,y){var C=Jt(m)?Er:Qs;return C(m,Lt(y,3))}function dm(m,y){var C=Jt(m)?Xd:yh;return C(m,Lt(y,3))}var My=Gl(function(m,y,C){Q.call(m,C)?m[C].push(y):Va(m,C,[y])});function eu(m,y,C,O){m=Bi(m)?m:ou(m),C=C&&!O?tn(C):0;var G=m.length;return C<0&&(C=li(G+C,0)),sf(m)?C<=G&&m.indexOf(y,C)>-1:!!G&&To(m,y,C)>-1}var Wh=an(function(m,y,C){var O=-1,G=typeof y=="function",re=Bi(m)?He(m.length):[];return Qs(m,function(me){re[++O]=G?nr(y,me,C):ql(me,y,C)}),re}),Ry=Gl(function(m,y,C){Va(m,C,y)});function md(m,y){var C=Jt(m)?Jn:Tp;return C(m,Lt(y,3))}function Oy(m,y,C,O){return m==null?[]:(Jt(y)||(y=y==null?[]:[y]),C=O?t:C,Jt(C)||(C=C==null?[]:[C]),Pp(m,y,C))}var Ly=Gl(function(m,y,C){m[C?0:1].push(y)},function(){return[[],[]]});function Fy(m,y,C){var O=Jt(m)?Nc:Eu,G=arguments.length<3;return O(m,Lt(y,4),C,G,Qs)}function $y(m,y,C){var O=Jt(m)?sp:Eu,G=arguments.length<3;return O(m,Lt(y,4),C,G,yh)}function Qh(m,y){var C=Jt(m)?Gi:zn;return C(m,vd(Lt(y,3)))}function zy(m){var y=Jt(m)?Mc:Fc;return y(m)}function By(m,y,C){(C?Nr(m,y,C):y===t)?y=1:y=tn(y);var O=Jt(m)?Lg:kh;return O(m,y)}function ei(m){var y=Jt(m)?Fg:Yg;return y(m)}function hm(m){if(m==null)return 0;if(Bi(m))return sf(m)?ir(m):m.length;var y=Wi(m);return y==Re||y==ze?m.size:wh(m).length}function hv(m,y,C){var O=Jt(m)?Cu:Wg;return C&&Nr(m,y,C)&&(y=t),O(m,Lt(y,3))}var Uy=an(function(m,y){if(m==null)return[];var C=y.length;return C>1&&Nr(m,y[0],y[1])?y=[]:C>2&&Nr(y[0],y[1],y[2])&&(y=[y[0]]),Pp(m,wn(y,1),[])}),Jh=Rl||function(){return hi.Date.now()};function fv(m,y){if(typeof y!="function")throw new xr(l);return m=tn(m),function(){if(--m<1)return y.apply(this,arguments)}}function qy(m,y,C){return y=C?t:y,y=m&&y==null?m.length:y,bs(m,F,t,t,t,t,y)}function gd(m,y){var C;if(typeof y!="function")throw new xr(l);return m=tn(m),function(){return--m>0&&(C=y.apply(this,arguments)),m<=1&&(y=t),C}}var Xo=an(function(m,y,C){var O=T;if(C.length){var G=ps(C,Jl(Xo));O|=$}return bs(m,O,y,C,G)}),Kh=an(function(m,y,C){var O=T|E;if(C.length){var G=ps(C,Jl(Kh));O|=$}return bs(y,O,m,C,G)});function yd(m,y,C){y=C?t:y;var O=bs(m,I,t,t,t,t,t,y);return O.placeholder=yd.placeholder,O}function Xh(m,y,C){y=C?t:y;var O=bs(m,q,t,t,t,t,t,y);return O.placeholder=Xh.placeholder,O}function Zo(m,y,C){var O,G,re,me,je,Me,rt=0,ot=!1,ht=!1,_t=!0;if(typeof m!="function")throw new xr(l);y=Na(y)||0,gi(C)&&(ot=!!C.leading,ht="maxWait"in C,re=ht?li(Na(C.maxWait)||0,y):re,_t="trailing"in C?!!C.trailing:_t);function Mt(Vi){var oo=O,ec=G;return O=G=t,rt=Vi,me=m.apply(ec,oo),me}function Yt(Vi){return rt=Vi,je=qc(jn,y),ot?Mt(Vi):me}function mn(Vi){var oo=Vi-Me,ec=Vi-rt,cN=y-oo;return ht?fi(cN,re-ec):cN}function Wt(Vi){var oo=Vi-Me,ec=Vi-rt;return Me===t||oo>=y||oo<0||ht&&ec>=re}function jn(){var Vi=Jh();if(Wt(Vi))return Dn(Vi);je=qc(jn,mn(Vi))}function Dn(Vi){return je=t,_t&&O?Mt(Vi):(O=G=t,me)}function Ja(){je!==t&&Kg(je),rt=0,O=Me=G=je=t}function ra(){return je===t?me:Dn(Jh())}function Ka(){var Vi=Jh(),oo=Wt(Vi);if(O=arguments,G=this,Me=Vi,oo){if(je===t)return Yt(Me);if(ht)return Kg(je),je=qc(jn,y),Mt(Me)}return je===t&&(je=qc(jn,y)),me}return Ka.cancel=Ja,Ka.flush=ra,Ka}var Ss=an(function(m,y){return Bl(m,1,y)}),xd=an(function(m,y,C){return Bl(m,Na(y)||0,C)});function pv(m){return bs(m,B)}function bd(m,y){if(typeof m!="function"||y!=null&&typeof y!="function")throw new xr(l);var C=function(){var O=arguments,G=y?y.apply(this,O):O[0],re=C.cache;if(re.has(G))return re.get(G);var me=m.apply(this,O);return C.cache=re.set(G,me)||re,me};return C.cache=new(bd.Cache||Mr),C}bd.Cache=Mr;function vd(m){if(typeof m!="function")throw new xr(l);return function(){var y=arguments;switch(y.length){case 0:return!m.call(this);case 1:return!m.call(this,y[0]);case 2:return!m.call(this,y[0],y[1]);case 3:return!m.call(this,y[0],y[1],y[2])}return!m.apply(this,y)}}function Vy(m){return gd(2,m)}var Hy=Jg(function(m,y){y=y.length==1&&Jt(y[0])?Jn(y[0],mr(Lt())):Jn(wn(y,1),mr(Lt()));var C=y.length;return an(function(O){for(var G=-1,re=fi(O.length,C);++G<re;)O[G]=y[G].call(this,O[G]);return nr(m,this,O)})}),fm=an(function(m,y){var C=ps(y,Jl(fm));return bs(m,$,t,y,C)}),Zh=an(function(m,y){var C=ps(y,Jl(Zh));return bs(m,L,t,y,C)}),Gy=ci(function(m,y){return bs(m,z,t,t,t,y)});function Yy(m,y){if(typeof m!="function")throw new xr(l);return y=y===t?y:tn(y),an(m,y)}function mv(m,y){if(typeof m!="function")throw new xr(l);return y=y==null?0:li(tn(y),0),an(function(C){var O=C[y],G=Uo(C,0,y);return O&&Tr(G,O),nr(m,this,G)})}function pm(m,y,C){var O=!0,G=!0;if(typeof m!="function")throw new xr(l);return gi(C)&&(O="leading"in C?!!C.leading:O,G="trailing"in C?!!C.trailing:G),Zo(m,y,{leading:O,maxWait:y,trailing:G})}function mm(m){return qy(m,1)}function gv(m,y){return fm(Ku(y),m)}function yv(){if(!arguments.length)return[];var m=arguments[0];return Jt(m)?m:[m]}function wd(m){return lr(m,v)}function xv(m,y){return y=typeof y=="function"?y:t,lr(m,v,y)}function Wy(m){return lr(m,g|v)}function xn(m,y){return y=typeof y=="function"?y:t,lr(m,g|v,y)}function gm(m,y){return y==null||wp(m,y,qi(y))}function Br(m,y){return m===y||m!==m&&y!==y}var ym=Ql(Bu),Qy=Ql(function(m,y){return m>=y}),ao=xh(function(){return arguments}())?xh:function(m){return Ni(m)&&Q.call(m,"callee")&&!Il.call(m,"callee")},Jt=He.isArray,ef=jl?mr(jl):Rr;function Bi(m){return m!=null&&Zl(m.length)&&!Wa(m)}function ki(m){return Ni(m)&&Bi(m)}function bv(m){return m===!0||m===!1||Ni(m)&&Sn(m)==oe}var el=dh||qv,Jy=Fa?mr(Fa):Ii;function Ky(m){return Ni(m)&&m.nodeType===1&&!wa(m)}function tf(m){if(m==null)return!0;if(Bi(m)&&(Jt(m)||typeof m=="string"||typeof m.splice=="function"||el(m)||tu(m)||ao(m)))return!m.length;var y=Wi(m);if(y==Re||y==ze)return!m.size;if(Zn(m))return!wh(m).length;for(var C in m)if(Q.call(m,C))return!1;return!0}function Gn(m,y){return Vl(m,y)}function xm(m,y,C){C=typeof C=="function"?C:t;var O=C?C(m,y):t;return O===t?Vl(m,y,t,C):!!O}function Ui(m){if(!Ni(m))return!1;var y=Sn(m);return y==Ie||y==Ee||typeof m.message=="string"&&typeof m.name=="string"&&!wa(m)}function vv(m){return typeof m=="number"&&Pu(m)}function Wa(m){if(!gi(m))return!1;var y=Sn(m);return y==fe||y==pe||y==ee||y==qe}function nf(m){return typeof m=="number"&&m==tn(m)}function Zl(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=H}function gi(m){var y=typeof m;return m!=null&&(y=="object"||y=="function")}function Ni(m){return m!=null&&typeof m=="object"}var rf=_l?mr(_l):bh;function bm(m,y){return m===y||qu(m,y,Fh(y))}function wv(m,y,C){return C=typeof C=="function"?C:t,qu(m,y,Fh(y),C)}function Xy(m){return ex(m)&&m!=+m}function Nv(m){if(od(m))throw new zt(o);return ys(m)}function Zy(m){return m===null}function Sv(m){return m==null}function ex(m){return typeof m=="number"||Ni(m)&&Sn(m)==Ye}function wa(m){if(!Ni(m)||Sn(m)!=Ge)return!1;var y=Ro(m);if(y===null)return!0;var C=Q.call(y,"constructor")&&y.constructor;return typeof C=="function"&&C instanceof C&&Mo.call(C)==tt}var af=Jd?mr(Jd):vh;function vm(m){return nf(m)&&m>=-9007199254740991&&m<=H}var tx=Kd?mr(Kd):Cp;function sf(m){return typeof m=="string"||!Jt(m)&&Ni(m)&&Sn(m)==lt}function Sr(m){return typeof m=="symbol"||Ni(m)&&Sn(m)==Ke}var tu=Cl?mr(Cl):kp;function Qa(m){return m===t}function wm(m){return Ni(m)&&Wi(m)==Te}function nx(m){return Ni(m)&&Sn(m)==ie}var ix=Ql(Nh),Nd=Ql(function(m,y){return m<=y});function ia(m){if(!m)return[];if(Bi(m))return sf(m)?Ar(m):$i(m);if(Ml&&m[Ml])return ih(m[Ml]());var y=Wi(m),C=y==Re?Dl:y==ze?Ec:ou;return C(m)}function js(m){if(!m)return m===0?m:0;if(m=Na(m),m===W||m===-1/0){var y=m<0?-1:1;return y*he}return m===m?m:0}function tn(m){var y=js(m),C=y%1;return y===y?C?y-C:y:0}function _s(m){return m?Ha(tn(m),0,te):0}function Na(m){if(typeof m=="number")return m;if(Sr(m))return D;if(gi(m)){var y=typeof m.valueOf=="function"?m.valueOf():m;m=gi(y)?y+"":y}if(typeof m!="string")return m===0?m:+m;m=eh(m);var C=oi.test(m);return C||sa.test(m)?Sl(m.slice(2),C?2:8):er.test(m)?D:+m}function rx(m){return Lr(m,Qi(m))}function nu(m){return m?Ha(tn(m),-9007199254740991,H):m===0?m:0}function On(m){return m==null?"":Or(m)}var jv=Yl(function(m,y){if(Zn(y)||Bi(y)){Lr(y,qi(y),m);return}for(var C in y)Q.call(y,C)&&zl(m,C,y[C])}),ax=Yl(function(m,y){Lr(y,Qi(y),m)}),of=Yl(function(m,y,C,O){Lr(y,Qi(y),m,O)}),_v=Yl(function(m,y,C,O){Lr(y,qi(y),m,O)}),Cv=ci(zu);function kv(m,y){var C=Kr(m);return y==null?C:Ws(C,y)}var Ev=an(function(m,y){m=Nn(m);var C=-1,O=y.length,G=O>2?y[2]:t;for(G&&Nr(y[0],y[1],G)&&(O=1);++C<O;)for(var re=y[C],me=Qi(re),je=-1,Me=me.length;++je<Me;){var rt=me[je],ot=m[rt];(ot===t||Br(ot,Vs[rt])&&!Q.call(m,rt))&&(m[rt]=re[rt])}return m}),sx=an(function(m){return m.push(t,Vp),nr(Cd,t,m)});function iu(m,y){return Zd(m,Lt(y,3),cr)}function Sd(m,y){return Zd(m,Lt(y,3),Lc)}function ox(m,y){return m==null?m:Oc(m,Lt(y,3),Qi)}function Tv(m,y){return m==null?m:Ul(m,Lt(y,3),Qi)}function ru(m,y){return m&&cr(m,Lt(y,3))}function jd(m,y){return m&&Lc(m,Lt(y,3))}function lx(m){return m==null?[]:Bo(m,qi(m))}function lf(m){return m==null?[]:Bo(m,Qi(m))}function _d(m,y,C){var O=m==null?t:ya(m,y);return O===t?C:O}function Nm(m,y){return m!=null&&sd(m,y,Sp)}function au(m,y){return m!=null&&sd(m,y,Bg)}var cx=ed(function(m,y,C){y!=null&&typeof y.toString!="function"&&(y=Ne.call(y)),m[y]=C},Le(Fe)),ux=ed(function(m,y,C){y!=null&&typeof y.toString!="function"&&(y=Ne.call(y)),Q.call(m,y)?m[y].push(C):m[y]=[C]},Lt),Av=an(ql);function qi(m){return Bi(m)?vp(m):wh(m)}function Qi(m){return Bi(m)?vp(m,!0):qg(m)}function Dv(m,y){var C={};return y=Lt(y,3),cr(m,function(O,G,re){Va(C,y(O,G,re),O)}),C}function Pv(m,y){var C={};return y=Lt(y,3),cr(m,function(O,G,re){Va(C,G,y(O,G,re))}),C}var Iv=Yl(function(m,y,C){Vu(m,y,C)}),Cd=Yl(function(m,y,C,O){Vu(m,y,C,O)}),cf=ci(function(m,y){var C={};if(m==null)return C;var O=!1;y=Jn(y,function(re){return re=Ks(re,m),O||(O=re.length>1),re}),Lr(m,Oh(m),C),O&&(C=lr(C,g|b|v,ay));for(var G=y.length;G--;)Wu(C,y[G]);return C});function Sm(m,y){return su(m,vd(Lt(y)))}var Mv=ci(function(m,y){return m==null?{}:Vg(m,y)});function su(m,y){if(m==null)return{};var C=Jn(Oh(m),function(O){return[O]});return y=Lt(y),jh(m,C,function(O,G){return y(O,G[0])})}function Rv(m,y,C){y=Ks(y,m);var O=-1,G=y.length;for(G||(G=1,m=t);++O<G;){var re=m==null?t:m[Fn(y[O])];re===t&&(O=G,re=C),m=Wa(re)?re.call(m):re}return m}function dx(m,y,C){return m==null?m:$c(m,y,C)}function hx(m,y,C,O){return O=typeof O=="function"?O:t,m==null?m:$c(m,y,C,O)}var jm=id(qi),_m=id(Qi);function Cm(m,y,C){var O=Jt(m),G=O||el(m)||tu(m);if(y=Lt(y,4),C==null){var re=m&&m.constructor;G?C=O?new re:[]:gi(m)?C=Wa(re)?Kr(Ro(m)):{}:C={}}return(G?Er:cr)(m,function(me,je,Me){return y(C,me,je,Me)}),C}function fx(m,y){return m==null?!0:Wu(m,y)}function uf(m,y,C){return m==null?m:Op(m,y,Ku(C))}function Ov(m,y,C,O){return O=typeof O=="function"?O:t,m==null?m:Op(m,y,Ku(C),O)}function ou(m){return m==null?[]:Jr(m,qi(m))}function km(m){return m==null?[]:Jr(m,Qi(m))}function Em(m,y,C){return C===t&&(C=y,y=t),C!==t&&(C=Na(C),C=C===C?C:0),y!==t&&(y=Na(y),y=y===y?y:0),Ha(Na(m),y,C)}function df(m,y,C){return y=js(y),C===t?(C=y,y=0):C=js(C),m=Na(m),Ug(m,y,C)}function Tm(m,y,C){if(C&&typeof C!="boolean"&&Nr(m,y,C)&&(y=C=t),C===t&&(typeof y=="boolean"?(C=y,y=t):typeof m=="boolean"&&(C=m,m=t)),m===t&&y===t?(m=0,y=1):(m=js(m),y===t?(y=m,m=0):y=js(y)),m>y){var O=m;m=y,y=O}if(C||m%1||y%1){var G=mp();return fi(m+G*(y-m+Us("1e-"+((G+"").length-1))),y)}return Ch(m,y)}var px=wr(function(m,y,C){return y=y.toLowerCase(),m+(C?hf(y):y)});function hf(m){return x(On(m).toLowerCase())}function so(m){return m=On(m),m&&m.replace(oa,Al).replace(kr,"")}function tl(m,y,C){m=On(m),y=Or(y);var O=m.length;C=C===t?O:Ha(tn(C),0,O);var G=C;return C-=y.length,C>=0&&m.slice(C,G)==y}function nl(m){return m=On(m),m&&It.test(m)?m.replace(kt,Tu):m}function kd(m){return m=On(m),m&&Ut.test(m)?m.replace(Pt,"\\$&"):m}var Ed=wr(function(m,y,C){return m+(C?"-":"")+y.toLowerCase()}),il=wr(function(m,y,C){return m+(C?" ":"")+y.toLowerCase()}),Lv=Zr("toLowerCase");function mx(m,y,C){m=On(m),y=tn(y);var O=y?ir(m):0;if(!y||O>=y)return m;var G=(y-O)/2;return nd(Hs(G),C)+m+nd(Dc(G),C)}function Td(m,y,C){m=On(m),y=tn(y);var O=y?ir(m):0;return y&&O<y?m+nd(y-O,C):m}function Fv(m,y,C){m=On(m),y=tn(y);var O=y?ir(m):0;return y&&O<y?nd(y-O,C)+m:m}function gx(m,y,C){return C||y==null?y=0:y&&(y=+y),Ol(On(m).replace(hn,""),y||0)}function ff(m,y,C){return(C?Nr(m,y,C):y===t)?y=1:y=tn(y),Mp(On(m),y)}function yx(){var m=arguments,y=On(m[0]);return m.length<3?y:y.replace(m[1],m[2])}var $v=wr(function(m,y,C){return m+(C?"_":"")+y.toLowerCase()});function pf(m,y,C){return C&&typeof C!="number"&&Nr(m,y,C)&&(y=C=t),C=C===t?te:C>>>0,C?(m=On(m),m&&(typeof y=="string"||y!=null&&!af(y))&&(y=Or(y),!y&&za(m))?Uo(Ar(m),0,C):m.split(y,C)):[]}var mf=wr(function(m,y,C){return m+(C?" ":"")+x(y)});function xx(m,y,C){return m=On(m),C=C==null?0:Ha(tn(C),0,m.length),y=Or(y),m.slice(C,C+y.length)==y}function Ad(m,y,C){var O=J.templateSettings;C&&Nr(m,y,C)&&(y=t),m=On(m),y=of({},y,O,Mh);var G=of({},y.imports,O.imports,Mh),re=qi(G),me=Jr(G,re),je,Me,rt=0,ot=y.interpolate||os,ht="__p += '",_t=Tc((y.escape||os).source+"|"+ot.source+"|"+(ot===en?gn:os).source+"|"+(y.evaluate||os).source+"|$","g"),Mt="//# sourceURL="+(Q.call(y,"sourceURL")?(y.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Qd+"]")+`
`;m.replace(_t,function(Wt,jn,Dn,Ja,ra,Ka){return Dn||(Dn=Ja),ht+=m.slice(rt,Ka).replace(Is,Cc),jn&&(je=!0,ht+=`' +
__e(`+jn+`) +
'`),ra&&(Me=!0,ht+=`';
`+ra+`;
__p += '`),Dn&&(ht+=`' +
((__t = (`+Dn+`)) == null ? '' : __t) +
'`),rt=Ka+Wt.length,Wt}),ht+=`';
`;var Yt=Q.call(y,"variable")&&y.variable;if(!Yt)ht=`with (obj) {
`+ht+`
}
`;else if(ss.test(Yt))throw new zt(h);ht=(Me?ht.replace(ct,""):ht).replace(dt,"$1").replace(wt,"$1;"),ht="function("+(Yt||"obj")+`) {
`+(Yt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(je?", __e = _.escape":"")+(Me?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ht+`return __p
}`;var mn=A(function(){return bn(re,Mt+"return "+ht).apply(t,me)});if(mn.source=ht,Ui(mn))throw mn;return mn}function Am(m){return On(m).toLowerCase()}function gf(m){return On(m).toUpperCase()}function bx(m,y,C){if(m=On(m),m&&(C||y===t))return eh(m);if(!m||!(y=Or(y)))return m;var O=Ar(m),G=Ar(y),re=or(O,G),me=$a(O,G)+1;return Uo(O,re,me).join("")}function zv(m,y,C){if(m=On(m),m&&(C||y===t))return m.slice(0,Au(m)+1);if(!m||!(y=Or(y)))return m;var O=Ar(m),G=$a(O,Ar(y))+1;return Uo(O,0,G).join("")}function yf(m,y,C){if(m=On(m),m&&(C||y===t))return m.replace(hn,"");if(!m||!(y=Or(y)))return m;var O=Ar(m),G=or(O,Ar(y));return Uo(O,G).join("")}function s(m,y){var C=R,O=U;if(gi(y)){var G="separator"in y?y.separator:G;C="length"in y?tn(y.length):C,O="omission"in y?Or(y.omission):O}m=On(m);var re=m.length;if(za(m)){var me=Ar(m);re=me.length}if(C>=re)return m;var je=C-ir(O);if(je<1)return O;var Me=me?Uo(me,0,je).join(""):m.slice(0,je);if(G===t)return Me+O;if(me&&(je+=Me.length-je),af(G)){if(m.slice(je).search(G)){var rt,ot=Me;for(G.global||(G=Tc(G.source,On(Pi.exec(G))+"g")),G.lastIndex=0;rt=G.exec(ot);)var ht=rt.index;Me=Me.slice(0,ht===t?je:ht)}}else if(m.indexOf(Or(G),je)!=je){var _t=Me.lastIndexOf(G);_t>-1&&(Me=Me.slice(0,_t))}return Me+O}function c(m){return m=On(m),m&&Tt.test(m)?m.replace(bt,ah):m}var p=wr(function(m,y,C){return m+(C?" ":"")+y.toUpperCase()}),x=Zr("toUpperCase");function N(m,y,C){return m=On(m),y=C?t:y,y===t?nh(m)?fp(m):cp(m):m.match(y)||[]}var A=an(function(m,y){try{return nr(m,t,y)}catch(C){return Ui(C)?C:new zt(C)}}),V=ci(function(m,y){return Er(y,function(C){C=Fn(C),Va(m,C,Xo(m[C],m))}),m});function K(m){var y=m==null?0:m.length,C=Lt();return m=y?Jn(m,function(O){if(typeof O[1]!="function")throw new xr(l);return[C(O[0]),O[1]]}):[],an(function(O){for(var G=-1;++G<y;){var re=m[G];if(nr(re[0],this,O))return nr(re[1],this,O)}})}function ye(m){return $g(lr(m,g))}function Le(m){return function(){return m}}function et(m,y){return m==null||m!==m?y:m}var st=xs(),Be=xs(!0);function Fe(m){return m}function qt(m){return Ep(typeof m=="function"?m:lr(m,g))}function Bt(m){return Ap(lr(m,g))}function Yn(m,y){return Sh(m,lr(y,g))}var De=an(function(m,y){return function(C){return ql(C,m,y)}}),Ce=an(function(m,y){return function(C){return ql(m,C,y)}});function Oe(m,y,C){var O=qi(y),G=Bo(y,O);C==null&&!(gi(y)&&(G.length||!O.length))&&(C=y,y=m,m=this,G=Bo(y,qi(y)));var re=!(gi(C)&&"chain"in C)||!!C.chain,me=Wa(m);return Er(G,function(je){var Me=y[je];m[je]=Me,me&&(m.prototype[je]=function(){var rt=this.__chain__;if(re||rt){var ot=m(this.__wrapped__),ht=ot.__actions__=$i(this.__actions__);return ht.push({func:Me,args:arguments,thisArg:m}),ot.__chain__=rt,ot}return Me.apply(m,Tr([this.value()],arguments))})}),m}function it(){return hi._===this&&(hi._=vt),this}function Dt(){}function pn(m){return m=tn(m),an(function(y){return Dp(y,m)})}var Rt=td(Jn),Vt=td(qs),Ji=td(Cu);function An(m){return zh(m)?Do(Fn(m)):Hg(m)}function rl(m){return function(y){return m==null?t:ya(m,y)}}var Bv=qo(),iA=qo(!0);function Uv(){return[]}function qv(){return!1}function rA(){return{}}function aA(){return""}function sA(){return!0}function oA(m,y){if(m=tn(m),m<1||m>H)return[];var C=te,O=fi(m,te);y=Lt(y),m-=te;for(var G=fs(O,y);++C<m;)y(C);return G}function lA(m){return Jt(m)?Jn(m,Fn):Sr(m)?[m]:$i(ws(On(m)))}function cA(m){var y=++le;return On(m)+y}var uA=zc(function(m,y){return m+y},0),dA=Ih("ceil"),hA=zc(function(m,y){return m/y},1),fA=Ih("floor");function pA(m){return m&&m.length?Ga(m,Fe,Bu):t}function mA(m,y){return m&&m.length?Ga(m,Lt(y,2),Bu):t}function gA(m){return jc(m,Fe)}function yA(m,y){return jc(m,Lt(y,2))}function xA(m){return m&&m.length?Ga(m,Fe,Nh):t}function bA(m,y){return m&&m.length?Ga(m,Lt(y,2),Nh):t}var vA=zc(function(m,y){return m*y},1),wA=Ih("round"),NA=zc(function(m,y){return m-y},0);function SA(m){return m&&m.length?_c(m,Fe):0}function jA(m,y){return m&&m.length?_c(m,Lt(y,2)):0}return J.after=fv,J.ary=qy,J.assign=jv,J.assignIn=ax,J.assignInWith=of,J.assignWith=_v,J.at=Cv,J.before=gd,J.bind=Xo,J.bindAll=V,J.bindKey=Kh,J.castArray=yv,J.chain=Xc,J.chunk=sv,J.compact=gy,J.concat=yy,J.cond=K,J.conforms=ye,J.constant=Le,J.countBy=Zc,J.create=kv,J.curry=yd,J.curryRight=Xh,J.debounce=Zo,J.defaults=Ev,J.defaultsDeep=sx,J.defer=Ss,J.delay=xd,J.difference=mi,J.differenceBy=Fr,J.differenceWith=no,J.drop=xy,J.dropRight=by,J.dropRightWhile=ov,J.dropWhile=Jp,J.fill=ea,J.filter=Dy,J.flatMap=um,J.flatMapDeep=uv,J.flatMapDepth=dv,J.flatten=$r,J.flattenDeep=vy,J.flattenDepth=Go,J.flip=pv,J.flow=st,J.flowRight=Be,J.fromPairs=Kl,J.functions=lx,J.functionsIn=lf,J.groupBy=My,J.initial=Zp,J.intersection=Ns,J.intersectionBy=wy,J.intersectionWith=Vc,J.invert=cx,J.invertBy=ux,J.invokeMap=Wh,J.iteratee=qt,J.keyBy=Ry,J.keys=qi,J.keysIn=Qi,J.map=md,J.mapKeys=Dv,J.mapValues=Pv,J.matches=Bt,J.matchesProperty=Yn,J.memoize=bd,J.merge=Iv,J.mergeWith=Cd,J.method=De,J.methodOf=Ce,J.mixin=Oe,J.negate=vd,J.nthArg=pn,J.omit=cf,J.omitBy=Sm,J.once=Vy,J.orderBy=Oy,J.over=Rt,J.overArgs=Hy,J.overEvery=Vt,J.overSome=Ji,J.partial=fm,J.partialRight=Zh,J.partition=Ly,J.pick=Mv,J.pickBy=su,J.property=An,J.propertyOf=rl,J.pull=Sy,J.pullAll=Gc,J.pullAllBy=jy,J.pullAllWith=Gh,J.pullAt=_y,J.range=Bv,J.rangeRight=iA,J.rearg=Gy,J.reject=Qh,J.remove=lv,J.rest=Yy,J.reverse=em,J.sampleSize=By,J.set=dx,J.setWith=hx,J.shuffle=ei,J.slice=Bn,J.sortBy=Uy,J.sortedUniq=Yc,J.sortedUniqBy=tm,J.split=pf,J.spread=mv,J.tail=ro,J.take=Ci,J.takeRight=Wo,J.takeRightWhile=Xl,J.takeWhile=nm,J.tap=om,J.throttle=pm,J.thru=dr,J.toArray=ia,J.toPairs=jm,J.toPairsIn=_m,J.toPath=lA,J.toPlainObject=rx,J.transform=Cm,J.unary=mm,J.union=va,J.unionBy=Wc,J.unionWith=fd,J.uniq=zr,J.uniqBy=im,J.uniqWith=rm,J.unset=fx,J.unzip=Qc,J.unzipWith=pd,J.update=uf,J.updateWith=Ov,J.values=ou,J.valuesIn=km,J.without=Qo,J.words=N,J.wrap=gv,J.xor=rr,J.xorBy=Jo,J.xorWith=Jc,J.zip=Kc,J.zipObject=am,J.zipObjectDeep=sm,J.zipWith=Cy,J.entries=jm,J.entriesIn=_m,J.extend=ax,J.extendWith=of,Oe(J,J),J.add=uA,J.attempt=A,J.camelCase=px,J.capitalize=hf,J.ceil=dA,J.clamp=Em,J.clone=wd,J.cloneDeep=Wy,J.cloneDeepWith=xn,J.cloneWith=xv,J.conformsTo=gm,J.deburr=so,J.defaultTo=et,J.divide=hA,J.endsWith=tl,J.eq=Br,J.escape=nl,J.escapeRegExp=kd,J.every=Ay,J.find=Py,J.findIndex=ba,J.findKey=iu,J.findLast=cm,J.findLastIndex=Kp,J.findLastKey=Sd,J.floor=fA,J.forEach=Iy,J.forEachRight=dm,J.forIn=ox,J.forInRight=Tv,J.forOwn=ru,J.forOwnRight=jd,J.get=_d,J.gt=ym,J.gte=Qy,J.has=Nm,J.hasIn=au,J.head=io,J.identity=Fe,J.includes=eu,J.indexOf=Xp,J.inRange=df,J.invoke=Av,J.isArguments=ao,J.isArray=Jt,J.isArrayBuffer=ef,J.isArrayLike=Bi,J.isArrayLikeObject=ki,J.isBoolean=bv,J.isBuffer=el,J.isDate=Jy,J.isElement=Ky,J.isEmpty=tf,J.isEqual=Gn,J.isEqualWith=xm,J.isError=Ui,J.isFinite=vv,J.isFunction=Wa,J.isInteger=nf,J.isLength=Zl,J.isMap=rf,J.isMatch=bm,J.isMatchWith=wv,J.isNaN=Xy,J.isNative=Nv,J.isNil=Sv,J.isNull=Zy,J.isNumber=ex,J.isObject=gi,J.isObjectLike=Ni,J.isPlainObject=wa,J.isRegExp=af,J.isSafeInteger=vm,J.isSet=tx,J.isString=sf,J.isSymbol=Sr,J.isTypedArray=tu,J.isUndefined=Qa,J.isWeakMap=wm,J.isWeakSet=nx,J.join=hd,J.kebabCase=Ed,J.last=ur,J.lastIndexOf=Hc,J.lowerCase=il,J.lowerFirst=Lv,J.lt=ix,J.lte=Nd,J.max=pA,J.maxBy=mA,J.mean=gA,J.meanBy=yA,J.min=xA,J.minBy=bA,J.stubArray=Uv,J.stubFalse=qv,J.stubObject=rA,J.stubString=aA,J.stubTrue=sA,J.multiply=vA,J.nth=Ny,J.noConflict=it,J.noop=Dt,J.now=Jh,J.pad=mx,J.padEnd=Td,J.padStart=Fv,J.parseInt=gx,J.random=Tm,J.reduce=Fy,J.reduceRight=$y,J.repeat=ff,J.replace=yx,J.result=Rv,J.round=wA,J.runInContext=ke,J.sample=zy,J.size=hm,J.snakeCase=$v,J.some=hv,J.sortedIndex=ii,J.sortedIndexBy=yn,J.sortedIndexOf=En,J.sortedLastIndex=Un,J.sortedLastIndexBy=ta,J.sortedLastIndexOf=Yo,J.startCase=mf,J.startsWith=xx,J.subtract=NA,J.sum=SA,J.sumBy=jA,J.template=Ad,J.times=oA,J.toFinite=js,J.toInteger=tn,J.toLength=_s,J.toLower=Am,J.toNumber=Na,J.toSafeInteger=nu,J.toString=On,J.toUpper=gf,J.trim=bx,J.trimEnd=zv,J.trimStart=yf,J.truncate=s,J.unescape=c,J.uniqueId=cA,J.upperCase=p,J.upperFirst=x,J.each=Iy,J.eachRight=dm,J.first=io,Oe(J,function(){var m={};return cr(J,function(y,C){Q.call(J.prototype,C)||(m[C]=y)}),m}(),{chain:!1}),J.VERSION=r,Er(["bind","bindKey","curry","curryRight","partial","partialRight"],function(m){J[m].placeholder=J}),Er(["drop","take"],function(m,y){fn.prototype[m]=function(C){C=C===t?1:li(tn(C),0);var O=this.__filtered__&&!y?new fn(this):this.clone();return O.__filtered__?O.__takeCount__=fi(C,O.__takeCount__):O.__views__.push({size:fi(C,te),type:m+(O.__dir__<0?"Right":"")}),O},fn.prototype[m+"Right"]=function(C){return this.reverse()[m](C).reverse()}}),Er(["filter","map","takeWhile"],function(m,y){var C=y+1,O=C==ne||C==X;fn.prototype[m]=function(G){var re=this.clone();return re.__iteratees__.push({iteratee:Lt(G,3),type:C}),re.__filtered__=re.__filtered__||O,re}}),Er(["head","last"],function(m,y){var C="take"+(y?"Right":"");fn.prototype[m]=function(){return this[C](1).value()[0]}}),Er(["initial","tail"],function(m,y){var C="drop"+(y?"":"Right");fn.prototype[m]=function(){return this.__filtered__?new fn(this):this[C](1)}}),fn.prototype.compact=function(){return this.filter(Fe)},fn.prototype.find=function(m){return this.filter(m).head()},fn.prototype.findLast=function(m){return this.reverse().find(m)},fn.prototype.invokeMap=an(function(m,y){return typeof m=="function"?new fn(this):this.map(function(C){return ql(C,m,y)})}),fn.prototype.reject=function(m){return this.filter(vd(Lt(m)))},fn.prototype.slice=function(m,y){m=tn(m);var C=this;return C.__filtered__&&(m>0||y<0)?new fn(C):(m<0?C=C.takeRight(-m):m&&(C=C.drop(m)),y!==t&&(y=tn(y),C=y<0?C.dropRight(-y):C.take(y-m)),C)},fn.prototype.takeRightWhile=function(m){return this.reverse().takeWhile(m).reverse()},fn.prototype.toArray=function(){return this.take(te)},cr(fn.prototype,function(m,y){var C=/^(?:filter|find|map|reject)|While$/.test(y),O=/^(?:head|last)$/.test(y),G=J[O?"take"+(y=="last"?"Right":""):y],re=O||/^find/.test(y);G&&(J.prototype[y]=function(){var me=this.__wrapped__,je=O?[1]:arguments,Me=me instanceof fn,rt=je[0],ot=Me||Jt(me),ht=function(jn){var Dn=G.apply(J,Tr([jn],je));return O&&_t?Dn[0]:Dn};ot&&C&&typeof rt=="function"&&rt.length!=1&&(Me=ot=!1);var _t=this.__chain__,Mt=!!this.__actions__.length,Yt=re&&!_t,mn=Me&&!Mt;if(!re&&ot){me=mn?me:new fn(this);var Wt=m.apply(me,je);return Wt.__actions__.push({func:dr,args:[ht],thisArg:t}),new Ir(Wt,_t)}return Yt&&mn?m.apply(this,je):(Wt=this.thru(ht),Yt?O?Wt.value()[0]:Wt.value():Wt)})}),Er(["pop","push","shift","sort","splice","unshift"],function(m){var y=Ac[m],C=/^(?:push|sort|unshift)$/.test(m)?"tap":"thru",O=/^(?:pop|shift)$/.test(m);J.prototype[m]=function(){var G=arguments;if(O&&!this.__chain__){var re=this.value();return y.apply(Jt(re)?re:[],G)}return this[C](function(me){return y.apply(Jt(me)?me:[],G)})}}),cr(fn.prototype,function(m,y){var C=J[y];if(C){var O=C.name+"";Q.call(ma,O)||(ma[O]=[]),ma[O].push({name:y,func:C})}}),ma[_i(t,E).name]=[{name:"wrapper",func:t}],fn.prototype.clone=Ou,fn.prototype.reverse=hh,fn.prototype.value=Fl,J.prototype.at=ky,J.prototype.chain=na,J.prototype.commit=Ey,J.prototype.next=Ty,J.prototype.plant=Ko,J.prototype.reverse=Yh,J.prototype.toJSON=J.prototype.valueOf=J.prototype.value=lm,J.prototype.first=J.prototype.head,Ml&&(J.prototype[Ml]=cv),J},ms=Po();La?((La.exports=ms)._=ms,Qr._=ms):hi._=ms}).call(gH)}(Km,Km.exports)),Km.exports}var gE=yH();class xH{constructor(n){ri(this,"sampleRate",24e3);ri(this,"bufferSize",7680);ri(this,"audioQueue",[]);ri(this,"isPlaying",!1);ri(this,"isStreamComplete",!1);ri(this,"checkInterval",null);ri(this,"scheduledTime",0);ri(this,"initialBufferTime",.1);ri(this,"gainNode");ri(this,"source");ri(this,"endOfQueueAudioSource",null);ri(this,"onComplete",()=>{});this.context=n,this.gainNode=this.context.createGain(),this.source=this.context.createBufferSource(),this.gainNode.connect(this.context.destination),this.addPCM16=this.addPCM16.bind(this)}async addWorklet(n,t,r){let a=Rx.get(this.context);if(a&&a[n])return a[n].handlers.push(r),Promise.resolve(this);a||(Rx.set(this.context,{}),a=Rx.get(this.context)),a[n]={handlers:[r]};const o=I1(n,t);await this.context.audioWorklet.addModule(o);const l=new AudioWorkletNode(this.context,n);return a[n].node=l,this}_processPCM16Chunk(n){const t=new Float32Array(n.length/2),r=new DataView(n.buffer);for(let a=0;a<n.length/2;a++)try{const o=r.getInt16(a*2,!0);t[a]=o/32768}catch(o){console.error(o)}return t}addPCM16(n){this.isStreamComplete=!1;let t=this._processPCM16Chunk(n);for(;t.length>=this.bufferSize;){const r=t.slice(0,this.bufferSize);this.audioQueue.push(r),t=t.slice(this.bufferSize)}t.length>0&&this.audioQueue.push(t),this.isPlaying||(this.isPlaying=!0,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.scheduleNextBuffer())}createAudioBuffer(n){const t=this.context.createBuffer(1,n.length,this.sampleRate);return t.getChannelData(0).set(n),t}scheduleNextBuffer(){for(;this.audioQueue.length>0&&this.scheduledTime<this.context.currentTime+.2;){const t=this.audioQueue.shift(),r=this.createAudioBuffer(t),a=this.context.createBufferSource();this.audioQueue.length===0&&(this.endOfQueueAudioSource&&(this.endOfQueueAudioSource.onended=null),this.endOfQueueAudioSource=a,a.onended=()=>{!this.audioQueue.length&&this.endOfQueueAudioSource===a&&(this.endOfQueueAudioSource=null,this.onComplete())}),a.buffer=r,a.connect(this.gainNode);const o=Rx.get(this.context);o&&Object.entries(o).forEach(([,h])=>{const{node:d,handlers:u}=h;d&&(a.connect(d),d.port.onmessage=function(f){u.forEach(g=>{g.call(d.port,f)})},d.connect(this.context.destination))});const l=Math.max(this.scheduledTime,this.context.currentTime);a.start(l),this.scheduledTime=l+r.duration}if(this.audioQueue.length===0)this.isStreamComplete?(this.isPlaying=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)):this.checkInterval||(this.checkInterval=window.setInterval(()=>{this.audioQueue.length>0&&this.scheduleNextBuffer()},100));else{const t=(this.scheduledTime-this.context.currentTime)*1e3;setTimeout(()=>this.scheduleNextBuffer(),Math.max(0,t-50))}}stop(){this.isPlaying=!1,this.isStreamComplete=!0,this.audioQueue=[],this.scheduledTime=this.context.currentTime,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.gainNode.gain.linearRampToValueAtTime(0,this.context.currentTime+.1),setTimeout(()=>{this.gainNode.disconnect(),this.gainNode=this.context.createGain(),this.gainNode.connect(this.context.destination)},200)}async resume(){this.context.state==="suspended"&&await this.context.resume(),this.isStreamComplete=!1,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.gainNode.gain.setValueAtTime(1,this.context.currentTime)}complete(){this.isStreamComplete=!0,this.onComplete()}}function bH(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const h=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(d=>d.addEventListener("ended",h)),()=>{e.getTracks().forEach(d=>d.removeEventListener("ended",h))}},[e]),{type:"screen",start:async()=>{const h=await navigator.mediaDevices.getDisplayMedia({video:!0});return n(h),r(!0),h},stop:()=>{e&&(e.getTracks().forEach(h=>h.stop()),n(null),r(!1))},isStreaming:t,stream:e}}function vH(){const[e,n]=w.useState(null),[t,r]=w.useState(!1);return w.useEffect(()=>{const h=()=>{r(!1),n(null)};if(e)return e.getTracks().forEach(d=>d.addEventListener("ended",h)),()=>{e.getTracks().forEach(d=>d.removeEventListener("ended",h))}},[e]),{type:"webcam",start:async()=>{const h=await navigator.mediaDevices.getUserMedia({video:!0});return n(h),r(!0),h},stop:()=>{e&&(e.getTracks().forEach(h=>h.stop()),n(null),r(!1))},isStreaming:t,stream:e}}class wH extends pE{constructor(t){super();ri(this,"client");ri(this,"_status","disconnected");ri(this,"_session",null);ri(this,"_model",null);ri(this,"config",null);this.client=new Ub(t),this.send=this.send.bind(this),this.onopen=this.onopen.bind(this),this.onerror=this.onerror.bind(this),this.onclose=this.onclose.bind(this),this.onmessage=this.onmessage.bind(this)}get status(){return this._status}get session(){return this._session}get model(){return this._model}getConfig(){return{...this.config}}log(t,r){const a={date:new Date,type:t,message:r};this.emit("log",a)}async connect(t,r){if(this._status==="connected"||this._status==="connecting")return!1;this._status="connecting",this.config=r,this._model=t;const a={onopen:this.onopen,onmessage:this.onmessage,onerror:this.onerror,onclose:this.onclose};try{this._session=await this.client.live.connect({model:t,config:r,callbacks:a})}catch(o){return console.error("Error connecting to GenAI Live:",o),this._status="disconnected",!1}return this._status="connected",!0}disconnect(){var t;return this.session?((t=this.session)==null||t.close(),this._session=null,this._status="disconnected",this.log("client.close","Disconnected"),!0):!1}onopen(){this.log("client.open","Connected"),this.emit("open")}onerror(t){this.log("server.error",t.message),this.emit("error",t)}onclose(t){this.log("server.close",`disconnected ${t.reason?`with reason: ${t.reason}`:""}`),this.emit("close",t)}async onmessage(t){var r;if(t.setupComplete){this.log("server.send","setupComplete"),this.emit("setupcomplete");return}if(t.toolCall){this.log("server.toolCall",t),this.emit("toolcall",t.toolCall);return}if(t.toolCallCancellation){this.log("server.toolCallCancellation",t),this.emit("toolcallcancellation",t.toolCallCancellation);return}if(t.serverContent){const{serverContent:a}=t;if("interrupted"in a){this.log("server.content","interrupted"),this.emit("interrupted");return}if("turnComplete"in a&&(this.log("server.content","turnComplete"),this.emit("turncomplete")),"modelTurn"in a){let o=((r=a.modelTurn)==null?void 0:r.parts)||[];const l=o.filter(f=>{var g;return f.inlineData&&((g=f.inlineData.mimeType)==null?void 0:g.startsWith("audio/pcm"))}),h=l.map(f=>{var g;return(g=f.inlineData)==null?void 0:g.data}),d=gE.difference(o,l);if(h.forEach(f=>{if(f){const g=cH(f);this.emit("audio",g),this.log("server.audio",`buffer (${g.byteLength})`)}}),!d.length)return;o=d;const u={modelTurn:{parts:o}};this.emit("content",u),this.log("server.content",t)}}else console.log("received unmatched message",t)}sendRealtimeInput(t){var l;let r=!1,a=!1;for(const h of t)if((l=this.session)==null||l.sendRealtimeInput({media:h}),h.mimeType.includes("audio")&&(r=!0),h.mimeType.includes("image")&&(a=!0),r&&a)break;const o=r&&a?"audio + video":r?"audio":a?"video":"unknown";this.log("client.realtimeInput",o)}sendToolResponse(t){var r;t.functionResponses&&t.functionResponses.length&&((r=this.session)==null||r.sendToolResponse({functionResponses:t.functionResponses}),this.log("client.toolResponse",t))}send(t,r=!0){var a;(a=this.session)==null||a.sendClientContent({turns:t,turnComplete:r}),this.log("client.send",{turns:Array.isArray(t)?t:[t],turnComplete:r})}}function NH(e){const n=w.useMemo(()=>new wH(e),[e]),t=w.useRef(null),[r,a]=w.useState("models/gemini-2.5-flash-live-preview"),[o,l]=w.useState({}),[h,d]=w.useState(!1),[u,f]=w.useState(0),[g,b]=w.useState(null);w.useEffect(()=>{t.current||hE({id:"audio-out"}).then(k=>{t.current=new xH(k),t.current.addWorklet("vumeter-out",fE,T=>{f(T.data.volume)}).then(()=>{})})},[t]),w.useEffect(()=>{const k=()=>{d(!0)},T=()=>{d(!1)},E=$=>{console.error("error",$)},P=()=>{var $;return($=t.current)==null?void 0:$.stop()},I=$=>{var L;return(L=t.current)==null?void 0:L.addPCM16(new Uint8Array($))},q=$=>{if(console.log("Received content event:",$),$.modelTurn&&$.modelTurn.parts){const L=$.modelTurn.parts.filter(F=>"text"in F&&F.text&&!F.thought);if(L.length>0){const F=L.map(z=>z.text).join(" ");b(F),console.log("AI Summary received:",F)}}};return n.on("error",E).on("open",k).on("close",T).on("interrupted",P).on("audio",I).on("content",q),()=>{n.off("error",E).off("open",k).off("close",T).off("interrupted",P).off("audio",I).off("content",q).disconnect()}},[n]);const v=w.useCallback(async()=>{if(!o)throw new Error("config has not been set");n.disconnect(),await n.connect(r,o)},[n,o,r]),S=w.useCallback(async()=>{n.disconnect(),d(!1)},[d,n]);return{client:n,config:o,setConfig:l,model:r,setModel:a,connected:h,connect:v,disconnect:S,volume:u,aiSummary:g}}const yE=w.createContext(void 0),Hw=({options:e,children:n})=>{const t=NH(e);return i.jsx(yE.Provider,{value:t,children:n})},Hd=()=>{const e=w.useContext(yE);if(!e)throw new Error("useLiveAPIContext must be used wihin a LiveAPIProvider");return e},s_=[{value:"Puck",label:"Puck"},{value:"Charon",label:"Charon"},{value:"Kore",label:"Kore"},{value:"Fenrir",label:"Fenrir"},{value:"Aoede",label:"Aoede"}];function SH(){const{config:e,setConfig:n}=Hd();w.useEffect(()=>{var h,d,u;const o=((u=(d=(h=e.speechConfig)==null?void 0:h.voiceConfig)==null?void 0:d.prebuiltVoiceConfig)==null?void 0:u.voiceName)||"Atari02";r({value:o,label:o})},[e]);const[t,r]=w.useState(s_[5]),a=w.useCallback(o=>{n({...e,speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:o}}}})},[e,n]);return i.jsxs("div",{className:"select-group",children:[i.jsx("label",{htmlFor:"voice-selector",children:"Voice"}),i.jsx(lH,{id:"voice-selector",className:"react-select",classNamePrefix:"react-select",styles:{},value:t,defaultValue:t,options:s_,onChange:o=>{r(o),o&&a(o.value)}})]})}function jH(){const[e,n]=w.useState(!1),{config:t,setConfig:r,connected:a}=Hd(),o=w.useMemo(()=>Array.isArray(t.tools)?t.tools.filter(u=>Array.isArray(u.functionDeclarations)).map(u=>u.functionDeclarations).filter(u=>!!u).flat():[],[t]),l=w.useMemo(()=>{var u;return t.systemInstruction?typeof t.systemInstruction=="string"?t.systemInstruction:Array.isArray(t.systemInstruction)?t.systemInstruction.map(f=>typeof f=="string"?f:f.text).join(`
`):typeof t.systemInstruction=="object"&&"parts"in t.systemInstruction&&((u=t.systemInstruction.parts)==null?void 0:u.map(f=>f.text).join(`
`))||"":""},[t]),h=w.useCallback(u=>{const f={...t,systemInstruction:u.target.value};r(f)},[t,r]),d=w.useCallback((u,f)=>{var b;const g={...t,tools:((b=t.tools)==null?void 0:b.map(v=>{const S=v;return Array.isArray(S.functionDeclarations)?{...v,functionDeclarations:S.functionDeclarations.map(k=>k.name===u?{...k,description:f}:k)}:v}))||[]};r(g)},[t,r]);return i.jsxs("div",{className:"settings-dialog",children:[i.jsx("button",{className:"action-button material-symbols-outlined",onClick:()=>n(!e),children:"settings"}),i.jsx("dialog",{className:"dialog",style:{display:e?"block":"none"},children:i.jsxs("div",{className:`dialog-container ${a?"disabled":""}`,children:[a&&i.jsx("div",{className:"connected-indicator",children:i.jsx("p",{children:"These settings can only be applied before connecting and will override other settings."})}),i.jsx("div",{className:"mode-selectors",children:i.jsx(SH,{})}),i.jsx("h3",{children:"System Instructions"}),i.jsx("textarea",{className:"system",onChange:h,value:l}),i.jsx("h4",{children:"Function declarations"}),i.jsx("div",{className:"function-declarations",children:i.jsx("div",{className:"fd-rows",children:o.map((u,f)=>{var g;return i.jsxs("div",{className:"fd-row",children:[i.jsx("span",{className:"fd-row-name",children:u.name}),i.jsx("span",{className:"fd-row-args",children:Object.keys(((g=u.parameters)==null?void 0:g.properties)||{}).map((b,v)=>i.jsx("span",{children:b},v))}),i.jsx("input",{className:"fd-row-description",type:"text",defaultValue:u.description,onBlur:b=>d(u.name,b.target.value)},`fd-${u.description}`)]},`function-${f}`)})})})]})})]})}const o_=w.memo(({isStreaming:e,onIcon:n,offIcon:t,start:r,stop:a})=>e?i.jsx("button",{className:"action-button",onClick:a,children:i.jsx("span",{className:"material-symbols-outlined",children:n})}):i.jsx("button",{className:"action-button",onClick:r,children:i.jsx("span",{className:"material-symbols-outlined",children:t})}));function _H({videoRef:e,children:n,onVideoStreamChange:t=()=>{},supportsVideo:r,enableEditingSettings:a}){const o=[vH(),bH()],[l,h]=w.useState(null),[d,u]=o,[f,g]=w.useState(0),[b]=w.useState(()=>new mE),[v,S]=w.useState(!1),k=w.useRef(null),T=w.useRef(null),{client:E,connected:P,connect:I,disconnect:q,volume:$}=Hd();w.useEffect(()=>{!P&&T.current&&T.current.focus()},[P]),w.useEffect(()=>{document.documentElement.style.setProperty("--volume",`${Math.max(5,Math.min(f*200,8))}px`)},[f]),w.useEffect(()=>{const F=z=>{E.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:z}])};return P&&!v&&b?b.on("data",F).on("volume",g).start():b.stop(),()=>{b.off("data",F).off("volume",g)}},[P,E,v,b]),w.useEffect(()=>{e.current&&(e.current.srcObject=l);let F=-1;function z(){const B=e.current,R=k.current;if(!B||!R)return;const U=R.getContext("2d");if(R.width=B.videoWidth*.25,R.height=B.videoHeight*.25,R.width+R.height>0){U.drawImage(B,0,0,R.width,R.height);const Y=R.toDataURL("image/jpeg",1),Z=Y.slice(Y.indexOf(",")+1,1/0);E.sendRealtimeInput([{mimeType:"image/jpeg",data:Z}])}P&&(F=window.setTimeout(z,1e3/.5))}return P&&l!==null&&requestAnimationFrame(z),()=>{clearTimeout(F)}},[P,l,E,e]);const L=F=>async()=>{if(F){const z=await F.start();h(z),t(z)}else h(null),t(null);o.filter(z=>z!==F).forEach(z=>z.stop())};return i.jsxs("section",{className:"control-tray",children:[i.jsx("canvas",{style:{display:"none"},ref:k}),i.jsxs("nav",{className:pu("actions-nav",{disabled:!P}),children:[i.jsx("button",{className:pu("action-button mic-button",{recording:!v&&P}),onClick:()=>S(!v),children:v?i.jsx("span",{className:"material-symbols-outlined filled",children:"mic_off"}):i.jsx("span",{className:"material-symbols-outlined filled",children:"mic"})}),i.jsx("div",{className:"action-button no-action outlined",children:i.jsx(mH,{volume:$,active:P,hover:!1})}),r&&i.jsxs(i.Fragment,{children:[i.jsx(o_,{isStreaming:u.isStreaming,start:L(u),stop:L(),onIcon:"cancel_presentation",offIcon:"present_to_all"}),i.jsx(o_,{isStreaming:d.isStreaming,start:L(d),stop:L(),onIcon:"videocam_off",offIcon:"videocam"})]}),n]}),i.jsxs("div",{className:pu("connection-container",{connected:P}),children:[i.jsx("div",{className:"connection-button-container",children:i.jsx("button",{ref:T,className:pu("action-button connect-toggle",{connected:P}),onClick:P?q:I,children:i.jsx("span",{className:"material-symbols-outlined filled",children:P?"pause":"play_arrow"})})}),i.jsx("span",{className:"text-indicator",children:"Streaming"})]}),a?i.jsx(jH,{}):""]})}const l_={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Gf.OBJECT,properties:{summary:{type:Gf.STRING,description:"The summary of the patient's case."}},required:["summary"]}},CH=({patientData:e,tokenNumber:n})=>{const[t,r]=w.useState(""),{client:a,setConfig:o,setModel:l}=Hd();return w.useEffect(()=>{l("models/gemini-2.5-flash-live-preview"),o({responseModalities:[Yf.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:`Your job is to:

If patient details like name, age, sex, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details (e.g., phone number) are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's name, age, sex, and phone number.

When pronouncing a phone number, always state each digit individually (e.g., "six three" instead of "sixty-three" or "six billion three").

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in Telugu.dont write the telugu words in english`}]},tools:[{functionDeclarations:[l_]}]})},[o,l]),w.useEffect(()=>{const h=d=>{if(!d.functionCalls)return;const u=d.functionCalls.find(f=>f.name===l_.name);if(u){const f=u.args.summary;r(f)}d.functionCalls.length&&setTimeout(()=>{var f;return a.sendToolResponse({functionResponses:(f=d.functionCalls)==null?void 0:f.map(g=>({response:{output:{success:!0}},id:g.id,name:g.name}))})},200)};return a.on("toolcall",h),()=>{a.off("toolcall",h)}},[a]),w.useEffect(()=>{if(t){const h=encodeURIComponent(t);n?window.location.href=`https://hms.newtons.in/handle-complaint-url?token=${n}&caseDetails=${h}`:window.location.href=`https://hms.newtons.in/dashboard/search-patient?caseDetails=${h}`}},[t,n]),i.jsxs("div",{className:"hospital-reception",children:[i.jsx("h1",{children:"Newtons Ai"}),i.jsx("p",{children:"Newtons Ai"}),n&&i.jsxs("h2",{children:["Token Number: ",n]}),e&&i.jsxs("div",{children:[i.jsx("h2",{children:"Patient Details"}),i.jsx("pre",{children:JSON.stringify(e,null,2)})]}),t&&i.jsxs("div",{children:[i.jsx("h2",{children:"Case Summary (from Tool Call)"}),i.jsx("p",{children:t})]})]})};async function kH(){const e=Vf();if(!e)throw new Error("Authentication token not found. Please log in.");try{const r=(await(await de("/api/clinics/settings",{headers:{Authorization:`Bearer ${e}`}})).json()).gemini_api_key;if(r)return console.log("Using clinic-specific Live API key."),r}catch(n){console.warn("Failed to fetch clinic-specific Live API key, trying global fallback.",n)}try{const r=(await(await de("/api/super-admin-settings/gemini-api-key",{headers:{Authorization:`Bearer ${e}`}})).json()).gemini_api_key;if(r)return console.log("Using global Live API key."),r}catch(n){console.warn("Failed to fetch global Live API key.",n)}throw new Error("Live API key not found. Please contact your administrator.")}function EH(){const e=w.useRef(null),[n,t]=w.useState(null),[r,a]=w.useState(null);return w.useEffect(()=>{(async()=>{try{const l=await kH();a({apiKey:l})}catch(l){console.error("Error setting Live API options:",l)}})()},[]),r?i.jsx("div",{className:"App",children:i.jsx(Hw,{options:r,children:i.jsx(TH,{videoRef:e,setVideoStream:t,videoStream:n})})}):i.jsx("div",{children:"Loading Live API settings..."})}const TH=({videoRef:e,setVideoStream:n,videoStream:t})=>{const[r,a]=w.useState(null),[o,l]=w.useState(null),{connected:h,client:d,connect:u,config:f,model:g}=Hd(),[b,v]=w.useState(""),S=w.useRef(null),[k,T]=w.useState(!1);w.useEffect(()=>{const P=window.matchMedia("(prefers-color-scheme: dark)"),I=q=>{document.documentElement.setAttribute("data-theme",q.matches?"dark":"light")};return I(P),P.addEventListener("change",I),()=>P.removeEventListener("change",I)},[]),w.useEffect(()=>{const P=new URLSearchParams(window.location.search),I={};for(const[q,$]of P.entries())q==="token_number"?l($):I[q]=$;a(I)},[]),w.useEffect(()=>{Object.keys(f).length>0&&g&&u()},[u,f,g]),w.useEffect(()=>{if(h&&r&&!k){const P=JSON.stringify(r,null,2);d.send([{text:P}]),v(""),T(!0)}},[h,r,d,k]),w.useEffect(()=>{r&&v(JSON.stringify(r,null,2))},[r]);const E=()=>{d.send([{text:b}]),v(""),S.current&&(S.current.innerText="")};return i.jsx("div",{className:"streaming-console",children:i.jsxs("main",{children:[i.jsxs("div",{className:"main-app-area",children:[i.jsx(CH,{patientData:r,tokenNumber:o}),i.jsx("video",{className:pu("stream",{hidden:!e.current||!t}),ref:e,autoPlay:!0,playsInline:!0})]}),i.jsx("div",{className:pu("input-container",{disabled:!h}),children:i.jsxs("div",{className:"input-content",children:[i.jsx("textarea",{className:"input-area",ref:S,onKeyDown:P=>{P.key==="Enter"&&!P.shiftKey&&(P.preventDefault(),P.stopPropagation(),E())},onChange:P=>v(P.target.value),value:b}),i.jsx("span",{className:pu("input-content-placeholder",{hidden:b.length}),children:"Typesomething..."}),i.jsx("button",{className:"send-button material-symbols-outlined filled",onClick:E,children:"send"})]})}),i.jsx(_H,{videoRef:e,supportsVideo:!0,onVideoStreamChange:n,enableEditingSettings:!0})]})})},c_="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",AH=({volume:e,active:n})=>{const t=Array.from({length:5},(r,a)=>i.jsx("div",{className:`audio-bar ${n?"active":""}`,style:{height:n?`${Math.min(24,20+e*40*(1+Math.sin(a)*.3))}px`:"8px",animationDelay:`${a*.1}s`}},a));return i.jsx("div",{className:"audio-pulse",children:t})},DH=w.forwardRef(({videoRef:e,supportsVideo:n,onVideoStreamChange:t,textInput:r,onSubmitTextInput:a},o)=>{var L;const{connected:l,connect:h,disconnect:d,client:u,volume:f}=Hd(),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[E]=w.useState(()=>new mE),P=async()=>{l?await d():(await h(),r.trim()&&a())};w.useEffect(()=>{const F=z=>{u.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:z}])};return l&&!g?E.on("data",F).start():E.stop(),()=>{E.off("data",F),E.stop()}},[l,u,g,E]);const I=w.useCallback(async()=>{if(v)$==null||$.getTracks().forEach(F=>F.stop()),t(null),S(!1);else try{const F=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=F),t(F),S(!0)}catch(F){console.error("Error accessing webcam:",F),S(!1)}},[v,t,e]),q=w.useCallback(async()=>{if(k)$==null||$.getTracks().forEach(F=>F.stop()),t(null),T(!1);else try{const F=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=F),t(F),T(!0)}catch(F){console.error("Error accessing screen share:",F),T(!1)}},[k,t,e]),$=(L=e.current)==null?void 0:L.srcObject;return w.useEffect(()=>()=>{$&&$.getTracks().forEach(F=>F.stop())},[$]),w.useImperativeHandle(o,()=>({handleConnect:P})),i.jsx("div",{className:"live-api-control-tray",children:i.jsxs("div",{className:"live-api-control-tray-inner",children:[i.jsxs("div",{className:"live-api-control-group",children:[i.jsx("button",{onClick:()=>b(!g),disabled:!l,className:`live-api-control-button ${l&&!g?"mic-active":"mic-inactive"}`,"aria-label":g?"Unmute microphone":"Mute microphone",children:g?i.jsx(GI,{className:"w-5 h-5"}):i.jsx(QC,{className:"w-5 h-5"})}),i.jsx("div",{className:"live-api-audio-pulse-container",children:i.jsx(AH,{volume:f,active:l})}),n&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:q,disabled:!l,className:`live-api-control-button ${k?"video-active":"video-inactive"}`,"aria-label":k?"Stop screen share":"Start screen share",children:i.jsx(JI,{className:"w-5 h-5"})}),i.jsx("button",{onClick:I,disabled:!l,className:`live-api-control-button ${v?"video-active":"video-inactive"}`,"aria-label":v?"Turn off webcam":"Turn on webcam",children:i.jsx(qM,{className:"w-5 h-5"})})]})]}),i.jsxs("div",{className:"live-api-control-group",children:[i.jsxs("div",{className:"live-api-status-indicator",children:[i.jsx("div",{className:`live-api-status-dot ${l?"connected":"disconnected"}`}),i.jsx("span",{className:"live-api-status-text",children:l?"Streaming":"Disconnected"})]}),i.jsx("button",{onClick:P,className:`live-api-connect-button ${l?"connected":"disconnected"}`,children:l?i.jsxs(i.Fragment,{children:[i.jsx(iM,{className:"w-5 h-5"}),i.jsx("span",{children:"Pause"})]}):i.jsxs(i.Fragment,{children:[i.jsx(lM,{className:"w-5 h-5"}),i.jsx("span",{children:"Start"})]})})]})]})})}),PH=({patientData:e,tokenNumber:n,aiSummary:t,clinicName:r})=>i.jsxs("div",{className:"hospital-reception-container",children:[i.jsxs("div",{className:"hospital-reception-logo-section",children:[i.jsx("div",{className:"hospital-reception-logo",children:i.jsx("span",{children:r.charAt(0)})}),i.jsxs("h1",{className:"hospital-reception-title",children:[r," AI"]}),i.jsxs("p",{className:"hospital-reception-subtitle",children:["Intelligent ",r," Reception Assistant"]})]}),n&&i.jsxs("div",{className:"hospital-reception-token-card",children:[i.jsx("h2",{className:"hospital-reception-token-title",children:"Token Number"}),i.jsx("p",{className:"hospital-reception-token-number",children:n})]}),!1,t&&i.jsxs("div",{className:"hospital-reception-summary-card",children:[i.jsx("h3",{className:"hospital-reception-summary-title",children:"Case Summary"}),i.jsx("p",{className:"hospital-reception-summary-text",children:t})]})]}),u_={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Gf.OBJECT,properties:{summary:{type:Gf.STRING,description:"The summary of the patient's case."}},required:["summary"]}},IH=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:a,aiLanguage:o})=>{const l=w.useRef(null),h=w.useRef(null),[d,u]=w.useState(null),[f,g]=w.useState("hi"),{client:b,connected:v,aiSummary:S,setConfig:k,setModel:T,disconnect:E}=Hd(),[P,I]=w.useState(null),q=w.useMemo(()=>{let F=`Your job is to:

If patient details like name, age, sex, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's name, age, and sex(dont ask for sex ,detect automatically through voice recognition).

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in ${o||"English"}.dont write the ${o||"English"} words in english.donot use function calls in the middle of the conversation`;return n&&(F+=`

Patient Data: ${JSON.stringify(n,null,2)}`),{responseModalities:[Yf.AUDIO],mediaResolution:g1.MEDIA_RESOLUTION_MEDIUM,speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},contextWindowCompression:{triggerTokens:"25600",slidingWindow:{targetTokens:"12800"}},systemInstruction:{parts:[{text:F+`

IMPORTANT: Do not verbalize your internal thought process. Only speak the final response to the user. Do not include any 'Thinking' or internal narration in the audio response.`}]},tools:[{functionDeclarations:[u_]}]}},[n,o]);w.useEffect(()=>{T("models/gemini-2.5-flash-native-audio-preview-12-2025"),k(q);const F=setTimeout(()=>{h.current&&!v&&h.current.handleConnect()},2e3);return()=>clearTimeout(F)},[k,T,q,v]),w.useEffect(()=>()=>{v&&E()},[v,E]),w.useEffect(()=>{const F=z=>{if(z.modelTurn&&z.modelTurn.parts){for(const B of z.modelTurn.parts)if(B.executableCode){const R=B.executableCode.code,U=/summary=["'](.*?)["']/.exec(R);if(U&&U[1]){const Y=U[1];I(Y),r(Y)}}}};return b.on("content",F),()=>{b.off("content",F)}},[b,r]),w.useEffect(()=>{const F=z=>{if(!z.functionCalls)return;const B=z.functionCalls.find(R=>R.name===u_.name);if(B){const R=B.args.summary;I(R),r(R)}z.functionCalls.length&&setTimeout(()=>{var R;return b.sendToolResponse({functionResponses:(R=z.functionCalls)==null?void 0:R.map(U=>({response:{output:{success:!0}},id:U.id,name:U.name}))})},200)};return b.on("toolcall",F),()=>{b.off("toolcall",F)}},[b,r]);const $=()=>{f.trim()&&(b.send([{text:f}]),g(""))},L=F=>{F.key==="Enter"&&!F.shiftKey&&(F.preventDefault(),$())};return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsxs("div",{className:"live-api-modal-content",children:[i.jsxs("div",{className:"live-api-modal-header",children:[i.jsxs("div",{className:"live-api-modal-header-left",children:[i.jsx("div",{className:"live-api-modal-logo",children:i.jsx("span",{children:a.charAt(0)})}),i.jsxs("div",{children:[i.jsx("h1",{className:"live-api-modal-title",children:a}),i.jsxs("p",{className:"live-api-modal-subtitle",children:[a," Hospital Assistant"]})]})]}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("button",{onClick:e,className:"live-api-modal-close-button","aria-label":"Close modal",children:i.jsx(In,{className:"w-6 h-6"})})})]}),i.jsx("div",{className:"live-api-modal-main-content",children:i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsxs("div",{className:"live-api-reception-area",children:[i.jsx(PH,{patientData:n,tokenNumber:t,aiSummary:P??S,clinicName:a}),d&&i.jsx("video",{ref:l,autoPlay:!0,playsInline:!0,className:"live-api-video-stream"})]}),i.jsx("div",{className:"live-api-input-area",children:i.jsxs("div",{className:"live-api-input-container",children:[i.jsx("textarea",{value:f,onChange:F=>g(F.target.value),onKeyDown:L,placeholder:"Type your message here...",disabled:!v,rows:1,className:"live-api-textarea"}),i.jsx("button",{onClick:$,disabled:!v||!f.trim(),className:"live-api-send-button","aria-label":"Send message",children:i.jsx(fw,{className:"w-5 h-5"})})]})}),i.jsx(DH,{ref:h,videoRef:l,supportsVideo:!0,onVideoStreamChange:u,textInput:f,onSubmitTextInput:$})]})})]})})},xE=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r})=>{const[a,o]=w.useState(null),[l,h]=w.useState("Newtons Ai"),[d,u]=w.useState(""),[f,g]=w.useState(!0);if(w.useEffect(()=>{(async()=>{try{const k=await(await de("/api/clinics/settings")).json();k.gemini_api_key?o(k.gemini_api_key):o(c_),k.name&&k.name!==""?h(k.name):h("Newtons Ai"),u(k.aiLanguage||"")}catch(S){console.error("Failed to fetch clinic settings, using default API key and unknown clinic name:",S),o(c_),h("Newtons Ai"),u("")}finally{g(!1)}})()},[]),f)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsxs("div",{className:"live-api-modal-content live-api-loading-container",children:[i.jsxs("div",{className:"live-api-loading-spinner",children:[i.jsx("div",{className:"live-api-spinner-ring"}),i.jsx("div",{className:"live-api-spinner-ring"}),i.jsx("div",{className:"live-api-spinner-ring"})]}),i.jsx("div",{className:"live-api-loading-text",children:"Initializing Live API"})]})});if(!a)return i.jsx("div",{className:"live-api-modal-overlay",children:i.jsx("div",{className:"live-api-modal-content",children:i.jsx("div",{children:"Error: API Key not available."})})});const b={apiKey:a};return i.jsx(Hw,{options:b,children:i.jsx(IH,{onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:r,clinicName:l,aiLanguage:d})})},MH=({onClose:e})=>{const n=Ot(),t=()=>{e(),n("/start-clinic-subscription")};return i.jsx("div",{className:"go-pro-modal-overlay",children:i.jsxs("div",{className:"go-pro-modal-content",children:[i.jsx("button",{onClick:e,className:"go-pro-modal-close-button",children:i.jsx(In,{size:24})}),i.jsx("h2",{className:"go-pro-modal-title",children:"Voice AI Agent for Pro Members Only"}),i.jsx("p",{className:"go-pro-modal-message",children:"Unlock the full potential of our Voice AI Agent by upgrading to a Pro subscription. Enjoy advanced features and seamless patient interactions."}),i.jsx("button",{onClick:t,className:"go-pro-button",children:"Go Pro Now"})]})})},RH="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",OH={apiKey:RH},Pf=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,o]=w.useState([]),[l,h]=w.useState(!1),[d,u]=w.useState(null),[f,g]=w.useState(!1),[b,v]=w.useState(null),[S,k]=w.useState(!1),[T,E]=w.useState(null),P=w.useRef(null),[I,q]=w.useState(!1),[$,L]=w.useState(!1),[F,z]=w.useState(null),[B,R]=w.useState(null),[U,Y]=w.useState(null),[Z,ne]=w.useState(!1),[ae,X]=w.useState(!0),W=Ot(),H=Cr();w.useEffect(()=>{(async()=>{try{const oe=await Sk();Y(oe.hasProPlan)}catch(oe){console.error("Error fetching pro status:",oe),Y(!1)}})(),he()},[]);const he=async()=>{try{const ee=new URLSearchParams({page:"1",limit:"4",sortBy:"created_at",sortOrder:"desc"}),oe=await de(`/api/patients?${ee.toString()}`);if(oe.ok){const ue=await oe.json();o(ue.patients)}}catch(ee){console.error("Error fetching recent patients:",ee)}},D=w.useCallback(async ee=>{const oe=ee||e;if(!oe.trim()){E("Please enter complaint details.");return}k(!0),E(null);try{const ue=await de("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"New Patient - Direct Entry",age:null,gender:null,phone:null,address:null})});if(!ue.ok){const pe=await ue.json().catch(()=>({message:"Failed to create patient"}));if(ue.status===403&&pe.message.includes("Patient limit")){W("/start-clinic-subscription",{state:{errorMessage:pe.message}});return}throw new Error(pe.message||`Failed to create patient: ${ue.statusText}`)}const Ee=await ue.json();if(!Ee||!Ee.id)throw new Error("Failed to create new patient or retrieve patient ID.");const Ie=await de("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:Ee.id})});if(!Ie.ok){const pe=await Ie.text();throw new Error(`Failed to create queue entry: ${pe||Ie.statusText}`)}const fe=await Ie.json();if(!fe||!fe.id)throw new Error("Failed to create new complaint record or retrieve record ID.");W(`/dashboard/edit-complaint/${fe.id}`,{state:{initialMessage:oe,patientId:Ee.id}})}catch(ue){console.error("Error starting new complaint:",ue),ue.message.includes("Patient limit")?(E(`Error: ${ue.message}. Please upgrade your plan.`),W("/start-clinic-subscription")):E(`Error: ${ue.message||"Failed to start new complaint process."}`)}finally{k(!1)}},[e,W]);w.useEffect(()=>{const ee=P.current;ee&&(ee.style.height="auto",ee.style.height=`${ee.scrollHeight}px`);const ue=new URLSearchParams(H.search).get("caseDetails");if(ue){const Ee=decodeURIComponent(ue);Ee!==e&&(n(Ee),q(!0))}},[H.search,e]),w.useEffect(()=>{I&&e.trim()&&(W(H.pathname,{replace:!0}),D(e),q(!1))},[I,e,D,W,H.pathname]),w.useEffect(()=>{const ee=P.current;ee&&(ee.style.height="auto",ee.style.height=`${ee.scrollHeight}px`)},[e]),w.useEffect(()=>{F&&(n(F),L(!1),D(F),z(null))},[F,D]),w.useEffect(()=>{const ee=P.current;ee&&ee.focus({preventScroll:!0})},[]);const te=()=>{X(!1)},ve=()=>{if(U===!1){ne(!0);return}R({id:null,token:null,name:"New Case",age:null,gender:null}),L(!0)},M=w.useMemo(()=>qb(async ee=>{const oe=ee.trim(),ue=/^\d+$/.test(oe),Ee=oe.split(/\s+/).length;if(oe.length<2||ue&&oe.length>10||!ue&&Ee>2){r([]),h(!1),u(null);return}h(!0),u(null);try{const Ie=new URLSearchParams({search:encodeURIComponent(ee),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),fe=await de(`/api/patients?${Ie.toString()}`);if(!fe.ok){const Re=await fe.text();throw new Error(`API Error (${fe.status}): ${Re||fe.statusText}`)}const pe=await fe.json();r(pe.patients)}catch(Ie){console.error("Error searching patients:",Ie),u(Ie.message||"Failed to search patients."),r([])}finally{h(!1)}},300),[]),ge=ee=>{const oe=ee.target.value;n(oe);const ue=oe.trim(),Ee=/^\d+$/.test(ue),Ie=ue.split(/\s+/).length;ue.length>=2&&!(Ee&&ue.length>10||!Ee&&Ie>2)?h(!0):(h(!1),r([])),X(!0),M(oe)},_e=ee=>{ee.key==="Enter"&&!ee.shiftKey&&(ee.preventDefault(),t.length>0&&!l?se(t[0]):e.trim()&&!l&&D(e))},se=async ee=>{r([]),n(""),g(!0),v(null);try{const oe=await de(`/api/queue/patient/${ee.id}/latest`);if(oe.ok){const Ie=await oe.json();if(Ie!=null&&Ie._id){if(Ie!=null&&Ie._id){W(`/dashboard/edit-complaint/${Ie._id}`,{state:{patientId:ee.id,initialMessage:e.trim()||void 0}}),g(!1);return}g(!1);return}}else if(oe.status!==404){const Ie=await oe.text();throw new Error(`Failed to fetch queue entry: ${Ie||oe.statusText} (${oe.status})`)}const ue=await de("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:ee.id})});if(!ue.ok){const Ie=await ue.text();throw new Error(`Failed to create queue entry: ${Ie||ue.statusText} (${ue.status})`)}const Ee=await ue.json();if(Ee!=null&&Ee.id)W(`/dashboard/edit-complaint/${Ee.id}`,{state:{patientId:ee.id,initialMessage:e.trim()||void 0}});else throw new Error("Failed to get ID from new queue entry.")}catch(oe){console.error("Error processing patient selection:",oe),v(oe.message||"An error occurred while processing the selection.")}finally{g(!1)}};return i.jsxs("div",{className:"patient-search-page-container",children:[i.jsxs("div",{className:"patient-search-header",children:[i.jsx("button",{onClick:()=>W("/dashboard/queue"),className:"patient-search-button patient-search-button-primary",children:"OPD Queue"}),i.jsx("button",{onClick:()=>W(-1),className:"back-button",children:i.jsx(on,{size:16})})]}),i.jsxs("div",{className:"patient-search-content-box",children:[d&&i.jsx("p",{className:"patient-search-error",children:d}),b&&i.jsx("p",{className:"patient-search-error",children:b}),T&&i.jsx("p",{className:"patient-search-error",children:T})]}),!e&&a.length>0&&i.jsxs("div",{className:"recent-patients-section",children:[i.jsx("div",{className:"recent-patients-grid",children:a.map((ee,oe)=>i.jsxs("div",{onClick:()=>se(ee),className:"recent-patient-card",style:{"--i":oe},children:[i.jsxs("div",{className:"recent-patient-info",children:[i.jsx("span",{className:"recent-patient-name",children:ee.name}),i.jsxs("span",{className:"recent-patient-details",children:[ee.age?`${ee.age} yrs`:"",ee.age&&ee.gender?" / ":"",ee.gender||""]})]}),i.jsxs("div",{className:"recent-patient-token",children:["#",ee.token]})]},ee.id))}),i.jsx("h2",{className:"recent-patients-title",children:"Newly Registered"})]}),i.jsxs("div",{className:"sticky-chat-input-box",children:[t.length>0&&ae&&i.jsx("div",{className:"search-results-backdrop",onClick:te}),t.length>0&&ae&&!f&&!S&&i.jsx("ul",{className:"patient-search-results-list",children:t.map((ee,oe)=>i.jsxs("li",{onClick:()=>se(ee),className:"patient-search-result-item",style:{"--i":oe},children:[i.jsx("div",{className:"patient-search-result-item-name-container",children:i.jsxs("div",{className:"patient-search-result-item-primary-info",children:[i.jsxs("span",{className:"patient-search-result-item-token",children:["#",ee.token]}),i.jsx("span",{className:"patient-search-result-item-name",children:ee.name}),i.jsxs("span",{className:"patient-search-result-item-meta",children:[ee.age?`${ee.age}y`:"",ee.age&&ee.gender?"  ":"",ee.gender||""]})]})}),i.jsx("div",{className:"patient-search-result-item-chevron",children:i.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:i.jsx("polyline",{points:"9 18 15 12 9 6"})})})]},ee.id))}),e.length>=2&&!l&&t.length===0&&!d&&!f&&i.jsxs("p",{className:"patient-search-no-results",children:['No patients found matching, taking new case: "',e,'".']}),i.jsxs("div",{className:"chat-input-controls",children:[i.jsx("textarea",{ref:P,placeholder:"Search or Create Case: Name, Age, Sex, Complaint...",value:e,onChange:ge,onKeyDown:_e,onFocus:()=>X(!0),onClick:()=>X(!0),className:"chat-input",disabled:f||S,rows:1}),i.jsx("button",{onClick:e.trim()?()=>D(e):ve,className:`chat-submit-button ${S||l?"opacity-50":""}`,disabled:S||l||!!e.trim()&&!e.trim(),"aria-label":e.trim()?"Create New Case":"Use Microphone",children:S||l?i.jsxs("div",{className:"spinner-dots",children:[i.jsx("div",{}),i.jsx("div",{}),i.jsx("div",{})]}):e.trim()?i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24",children:i.jsx("path",{d:"M12 4l1.41 1.41L7.83 11H20v2H7.83l5.58 5.59L12 20l-8-8 8-8z",transform:"rotate(90 12 12)"})}):i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24",children:i.jsx("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm-1.2-9.1c0-.66.54-1.2 1.2-1.2s1.2.54 1.2 1.2V9c0 .66-.54 1.2-1.2 1.2s-1.2-.54-1.2-1.2V4.9zM17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"})})})]})]}),$&&i.jsx(Hw,{options:OH,children:i.jsx(xE,{onClose:()=>L(!1),patientData:B,tokenNumber:null,onAiSummaryChange:z})}),Z&&i.jsx(MH,{onClose:()=>ne(!1)})]})},bE=({fetchWithAuth:e})=>{const n=Ot(),[t,r]=w.useState([]),[a,o]=w.useState(""),[l,h]=w.useState(!0),[d,u]=w.useState({admissionCharge:"0",perDayCharge:"0",otherCharges:"0",aiMemory:"",clinicWideSystemPrompt:"",gemini_api_key:"",low_stock_threshold:"10",aiLanguage:"English",name:"",logoUrl:"",upi_id:"",address:"",notes:""}),[f,g]=w.useState(!1),[b,v]=w.useState(null),S=w.useCallback(async()=>{h(!0);try{const[q,$]=await Promise.all([e("/staff"),e("/api/clinics/settings")]);if(q.ok){const L=await q.json();r(L.map(F=>({...F,id:F._id||F.id})))}if($.ok){const L=await $.json();u({admissionCharge:parseFloat(L.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(L.perDayCharge||0).toFixed(2),otherCharges:parseFloat(L.otherCharges||0).toFixed(2),aiMemory:L.aiMemory||"",clinicWideSystemPrompt:L.clinicWideSystemPrompt||"",gemini_api_key:L.gemini_api_key||"",low_stock_threshold:String(L.low_stock_threshold||"10"),aiLanguage:L.aiLanguage||"English",name:L.name||"",logoUrl:L.logoUrl||"",upi_id:L.upi_id||"",address:L.address||"",notes:L.notes||""})}}catch(q){console.error("Failed to load management data",q),v({text:"Failed to load clinic data. Please refresh.",type:"error"})}finally{h(!1)}},[e]);w.useEffect(()=>{S()},[S]);const k=q=>{u($=>({...$,[q.target.name]:q.target.value}))},T=async()=>{g(!0),v(null);try{const q={...d,admissionCharge:parseFloat(d.admissionCharge),perDayCharge:parseFloat(d.perDayCharge),otherCharges:parseFloat(d.otherCharges),low_stock_threshold:parseInt(d.low_stock_threshold)};if(!(await e("/api/clinics/settings",{method:"PUT",body:JSON.stringify(q)})).ok)throw new Error("Failed to save");v({text:"Settings saved successfully",type:"success"}),setTimeout(()=>v(null),3e3)}catch{v({text:"Error saving settings. Check your inputs.",type:"error"})}finally{g(!1)}},E=t.filter(q=>q.name.toLowerCase().includes(a.toLowerCase())||q.role.toLowerCase().includes(a.toLowerCase())),P=q=>{switch(q){case"doctor":return i.jsx(CM,{size:12});case"pharmacy":return i.jsx(go,{size:12});case"lab":return i.jsx(n1,{size:12});default:return i.jsx(Uf,{size:12})}},I=q=>q.split(" ").map($=>$[0]).join("").substring(0,2).toUpperCase();return i.jsxs("div",{className:"cm-container",children:[i.jsxs("div",{className:"cm-header",children:[i.jsxs("div",{className:"cm-title",children:[i.jsx("h1",{children:"Clinic Hub"}),i.jsx("p",{children:"Manage your ecosystem"})]}),i.jsxs("div",{className:"cm-actions",children:[i.jsxs("button",{onClick:()=>n("/dashboard/staff/add"),className:"cm-btn cm-btn-secondary",children:[i.jsx(hl,{size:16})," ",i.jsx("span",{children:"Add Staff"})]}),i.jsxs("button",{onClick:T,disabled:f,className:"cm-btn cm-btn-primary",children:[i.jsx(oc,{size:16})," ",i.jsx("span",{children:f?"Saving...":"Save Changes"})]})]})]}),i.jsxs("div",{className:"cm-grid-layout",children:[i.jsxs("div",{className:"cm-card",children:[i.jsx("div",{className:"cm-card-header",children:i.jsxs("div",{className:"cm-card-title",children:[i.jsx(Uf,{size:18,className:"text-teal-600"}),i.jsxs("span",{children:["Team Directory ",i.jsxs("span",{className:"text-slate-400 text-xs font-normal",children:["(",t.length,")"]})]})]})}),i.jsx("div",{className:"p-3 border-b border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/50",children:i.jsxs("div",{className:"cm-input-wrapper",children:[i.jsx(Ai,{size:14,className:"cm-input-icon"}),i.jsx("input",{className:"cm-input cm-input-pl",placeholder:"Find member...",value:a,onChange:q=>o(q.target.value)})]})}),i.jsx("div",{className:"cm-card-content",children:l?i.jsx("div",{className:"p-8 text-center text-slate-400 text-sm",children:"Loading team..."}):E.length===0?i.jsx("div",{className:"p-8 text-center text-slate-400 text-sm",children:"No members found."}):i.jsx("ul",{className:"cm-staff-list",children:E.map(q=>i.jsxs("li",{className:"cm-staff-item group",children:[i.jsxs("div",{className:"flex items-center flex-1 min-w-0",children:[i.jsx("div",{className:"cm-avatar",children:I(q.name)}),i.jsxs("div",{className:"cm-staff-info",children:[i.jsx("div",{className:"cm-staff-name",children:q.name}),i.jsxs("div",{className:"cm-staff-role",children:[P(q.role)," ",q.role]})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:`cm-badge ${q.status==="active"?"cm-badge-active":""}`,children:q.status||"Active"}),i.jsx("button",{onClick:()=>n(`/dashboard/staff/edit/${q.id}`),className:"text-slate-400 hover:text-teal-600 transition-colors p-1",children:i.jsx(lg,{size:16})})]})]},q.id))})})]}),i.jsxs("div",{className:"cm-card",children:[i.jsx("div",{className:"cm-card-header",children:i.jsxs("div",{className:"cm-card-title",children:[i.jsx(LI,{size:18,className:"text-teal-600"}),i.jsx("span",{children:"Configuration Console"})]})}),i.jsxs("div",{className:"cm-card-content",children:[b&&i.jsx("div",{className:`cm-alert ${b.type==="error"?"cm-alert-error":"cm-alert-success"}`,children:b.text}),i.jsxs("div",{className:"cm-settings-grid",children:[i.jsxs("div",{className:"cm-section-title",children:[i.jsx(qC,{size:16})," Clinic Identity & Location"]}),i.jsxs("div",{className:"cm-form-group",children:[i.jsx("label",{className:"cm-label",children:"Clinic Name"}),i.jsx("input",{name:"name",className:"cm-input",value:d.name,onChange:k,placeholder:"e.g. City Care"})]}),i.jsxs("div",{className:"cm-form-group",children:[i.jsx("label",{className:"cm-label",children:"Logo URL"}),i.jsx("input",{name:"logoUrl",className:"cm-input",value:d.logoUrl,onChange:k,placeholder:"https://..."})]}),i.jsxs("div",{className:"cm-form-group full-width",children:[i.jsx("label",{className:"cm-label",children:"Address"}),i.jsx("textarea",{name:"address",className:"cm-input cm-textarea",value:d.address,onChange:k,placeholder:"Full physical address"})]}),i.jsxs("div",{className:"cm-section-title",children:[i.jsx(Ld,{size:16})," Financial Operations"]}),i.jsxs("div",{className:"cm-form-group",children:[i.jsx("label",{className:"cm-label",children:"Admission Fee ()"}),i.jsx("input",{name:"admissionCharge",type:"number",className:"cm-input",value:d.admissionCharge,onChange:k})]}),i.jsxs("div",{className:"cm-form-group",children:[i.jsx("label",{className:"cm-label",children:"Daily Charge ()"}),i.jsx("input",{name:"perDayCharge",type:"number",className:"cm-input",value:d.perDayCharge,onChange:k})]}),i.jsxs("div",{className:"cm-form-group",children:[i.jsx("label",{className:"cm-label",children:"UPI ID"}),i.jsx("input",{name:"upi_id",className:"cm-input",value:d.upi_id,onChange:k,placeholder:"user@upi"})]}),i.jsxs("div",{className:"cm-form-group",children:[i.jsx("label",{className:"cm-label",children:"Misc. Charges ()"}),i.jsx("input",{name:"otherCharges",type:"number",className:"cm-input",value:d.otherCharges,onChange:k})]}),i.jsxs("div",{className:"cm-section-title",children:[i.jsx(UC,{size:16})," AI Intelligence & System"]}),i.jsxs("div",{className:"cm-form-group",children:[i.jsx("label",{className:"cm-label",children:"Gemini API Key"}),i.jsx("input",{name:"gemini_api_key",type:"password",className:"cm-input",value:d.gemini_api_key,onChange:k,placeholder:"sk-..."})]}),i.jsxs("div",{className:"cm-form-group",children:[i.jsx("label",{className:"cm-label",children:"AI Language"}),i.jsxs("select",{name:"aiLanguage",className:"cm-input",value:d.aiLanguage,onChange:k,children:[i.jsx("option",{children:"English"}),i.jsx("option",{children:"Hindi"}),i.jsx("option",{children:"Spanish"})]})]}),i.jsxs("div",{className:"cm-form-group full-width",children:[i.jsx("label",{className:"cm-label",children:"Clinic System Prompt (Base Instructions)"}),i.jsx("textarea",{name:"clinicWideSystemPrompt",className:"cm-input cm-textarea",rows:3,value:d.clinicWideSystemPrompt,onChange:k,placeholder:"You are a helpful assistant for..."})]}),i.jsxs("div",{className:"cm-form-group full-width",children:[i.jsx("label",{className:"cm-label",children:"Memory & Context"}),i.jsx("textarea",{name:"aiMemory",className:"cm-input cm-textarea",rows:3,value:d.aiMemory,onChange:k,placeholder:"Permanent context about the clinic..."})]}),i.jsxs("div",{className:"cm-section-title",children:[i.jsx(HP,{size:16})," Inventory Alerts"]}),i.jsxs("div",{className:"cm-form-group",children:[i.jsx("label",{className:"cm-label",children:"Low Stock Threshold"}),i.jsx("input",{name:"low_stock_threshold",type:"number",className:"cm-input",value:d.low_stock_threshold,onChange:k})]}),i.jsxs("div",{className:"cm-form-group full-width",children:[i.jsx("label",{className:"cm-label",children:"Internal Notes"}),i.jsx("textarea",{name:"notes",className:"cm-input cm-textarea",value:d.notes,onChange:k,placeholder:"Private notes for admins..."})]})]})]})]})]})]})},LH=({fetchWithAuth:e})=>{const n=Ot(),[t,r]=w.useState("patientSearch"),[a]=w.useState(!1),[o,l]=w.useState(null),[h,d]=w.useState(null);return w.useEffect(()=>{if(h){const u=setTimeout(()=>d(null),5e3);return()=>clearTimeout(u)}},[h]),a?i.jsxs("div",{className:"loading-animation-container",children:[i.jsx("div",{className:"breathing-ball"}),i.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Admin Panel..."})]}):i.jsxs("div",{className:"admin-panel-container",children:[h&&i.jsxs("div",{className:`alert-box ${h.type==="success"?"alert-box-success":"alert-box-error"} fixed top-4 right-4 z-[100]`,role:"alert",children:[i.jsx("div",{className:"alert-box-icon",children:h.type==="success"?i.jsx(Ea,{size:18}):i.jsx(ui,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{children:h.message})}),i.jsx("button",{onClick:()=>d(null),className:"alert-box-close",children:i.jsx(In,{size:16})})]}),o&&i.jsxs("div",{className:"alert-box alert-box-error mb-4",role:"alert",children:[i.jsx("div",{className:"alert-box-icon",children:i.jsx(ui,{size:18})}),i.jsx("div",{className:"alert-box-content",children:i.jsx("span",{className:"block sm:inline flex-1",children:o})}),i.jsx("button",{onClick:()=>l(null),className:"alert-box-close",children:i.jsx(In,{size:16})})]}),i.jsxs("div",{className:"admin-nav-bar",children:[i.jsx("button",{onClick:()=>window.location.reload(),className:"admin-nav-button",title:"Refresh Page",children:i.jsx(WC,{})}),i.jsxs("button",{onClick:()=>r("management"),className:`admin-nav-button ${t==="management"?"active":""}`,children:[i.jsx(Xm,{})," Management"]}),i.jsxs("button",{onClick:()=>r("analysis"),className:`admin-nav-button ${t==="analysis"?"active":""}`,children:[i.jsx(VC,{})," Analysis"]}),i.jsxs("button",{onClick:()=>n("/dashboard/inventory"),className:"admin-nav-button",children:[i.jsx(ho,{})," Inventory"]}),i.jsxs("button",{onClick:()=>n("/dashboard/subscriptions"),className:"admin-nav-button hidden-button",children:[i.jsx(Mf,{})," Patient Subscriptions"]}),i.jsxs("button",{onClick:()=>n("/dashboard/add-pharmacy-order"),className:"admin-nav-button",children:[i.jsx(go,{})," Order Meds"]}),i.jsx("button",{onClick:()=>n("/dashboard/recurring-medications"),className:"admin-nav-button",children:"Daily Meds"}),i.jsxs("button",{onClick:()=>n("/create-lab-order"),className:"admin-nav-button",children:[i.jsx(HC,{})," Order Tests"]}),i.jsxs("button",{onClick:()=>n("/dashboard/patients"),className:"admin-nav-button",children:[i.jsx(Uf,{})," All Patients"]})]}),i.jsxs("div",{className:"space-y-6",children:[t==="patientSearch"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(Pf,{})}),t==="analysis"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(Nk,{})}),t==="management"&&i.jsx("div",{className:"admin-content-section",children:i.jsx(bE,{fetchWithAuth:e})})]})]})},Sf=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},FH=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},jf=({title:e,icon:n,items:t,renderItemContent:r,isLoading:a})=>{const o=w.useMemo(()=>{const l={};t.forEach(d=>{if(isNaN(d.date.getTime())){l["Unknown Date"]||(l["Unknown Date"]=[]),l["Unknown Date"].push(d);return}const u=FH(d.originalDateString);l[u]||(l[u]=[]),l[u].push(d)});const h=Object.keys(l);return h.sort((d,u)=>{if(d==="Unknown Date")return 1;if(u==="Unknown Date")return-1;try{const f=v=>{const S=v.split(" ");if(S.length===3){const T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(S[1]);if(T!==-1)return new Date(parseInt(S[2]),T,parseInt(S[0]))}return new Date(v)},g=f(d),b=f(u);if(!isNaN(g.getTime())&&!isNaN(b.getTime()))return b.getTime()-g.getTime()}catch(f){console.error("Error parsing date for sorting:",f)}return u.localeCompare(d)}),h.map(d=>({date:d,items:l[d]}))},[t]);return i.jsxs("div",{className:"mb-3",children:[i.jsxs("h4",{className:"history-section-title",children:[n&&i.jsx(n,{size:18,className:"text-teal-600"}),e]}),a&&i.jsx("p",{className:"text-gray-500 italic text-[10px] px-1",children:"Loading..."}),!a&&t.length===0&&i.jsx("p",{className:"text-gray-500 italic text-[10px] px-1",children:"None found"}),!a&&t.length>0&&i.jsx("div",{className:"space-y-2",children:o.map(({date:l,items:h})=>i.jsxs("div",{children:[i.jsx("h5",{className:"text-[9px] font-bold text-teal-700 mb-1 uppercase tracking-widest opacity-60",children:l}),i.jsx("div",{className:"space-y-1 border-l-2 border-teal-100 dark:border-teal-900/30 ml-1 pl-2",children:h.map((d,u)=>i.jsx("div",{className:"text-xs",children:i.jsx("div",{className:"flex-grow",children:r(d)})},`${d.type}-${d.originalDateString}-${u}`))})]},l))})]})},D0=()=>{var ae,X;const[e,n]=w.useState({currentPatient:null,nextPatient:null,waitingCount:0}),[t,r]=w.useState(!0),[a,o]=w.useState(null),[l,h]=w.useState(null),[d,u]=w.useState(null),[f,g]=w.useState(null),[b,v]=w.useState({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),[S,k]=w.useState(!1),[T,E]=w.useState(null),{patientId:P}=Yr(),I=Ot(),q=w.useCallback(async W=>{g(null),h(null),u(null),k(!0),E(null),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]});try{const H=await de(`/api/patients/${W}`);if(!H.ok)throw new Error(`Patient details fetch failed (${H.status})`);const he=await H.json();h(he);const D=await de(`/api/queue/patient/${W}/latest`);if(!D.ok&&D.status!==404)throw new Error(`Queue entry fetch failed (${D.status})`);if(D.ok){const te=await D.json();u(te)}await $(W)}catch(H){console.error("Error fetching specific patient data:",H),g(H.message||"Failed to load patient data."),E(H.message||"Failed to load patient history.")}finally{k(!1)}},[]),$=w.useCallback(async W=>{k(!0),E(null);try{const[H,he,D,te]=await Promise.all([de(`/api/queue/patient/${W}/complaints`),de(`/api/lab/patient/${W}`),de(`/api/lab/orders/patient/${W}?status=pending`),de(`/api/pharmacy-orders/patient/${W}`)]),ve=H.ok?await H.json():[],M=he.ok?await he.json():[],ge=D.ok?await D.json():[],_e=te.ok?await te.json():[];v({pastComplaints:ve||[],labReports:M||[],pendingLabOrders:ge||[],pharmacyOrders:_e||[]})}catch(H){console.error("Error fetching patient history:",H),E(H.message||"Failed to load patient history."),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]})}finally{k(!1)}},[]),L=w.useCallback(async()=>{r(!0),o(null);try{const W=await de("/api/queue/doctor");if(!W.ok){const he=await W.text();throw new Error(`API Error (${W.status}): ${he||W.statusText}`)}const H=await W.json();if(H===null||typeof H!="object"||typeof H.waitingCount!="number")throw console.error("Invalid queue data format:",H),new Error("Invalid queue data format received");n({currentPatient:H.currentPatient||null,nextPatient:H.nextPatient||null,waitingCount:H.waitingCount})}catch(W){console.error("Error fetching queue data:",W),o(W.message||"Failed to fetch queue data.")}finally{r(!1)}},[]);w.useEffect(()=>{let W=null;return P?(q(P),n({currentPatient:null,nextPatient:null,waitingCount:0})):(L(),W=setInterval(L,1e4),h(null),u(null)),()=>{W&&clearInterval(W)}},[P,q,L]),w.useEffect(()=>{var W;!P&&((W=e.currentPatient)!=null&&W.patientId)?$(e.currentPatient.patientId):!P&&!e.currentPatient&&(v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),E(null))},[P,(ae=e.currentPatient)==null?void 0:ae.patientId,$]);const F=((X=e.currentPatient)==null?void 0:X.patientId)||(P?parseInt(P,10):null),z=w.useMemo(()=>{if(!F||!b.pastComplaints)return[];const W=b.pastComplaints.map(H=>({date:new Date(H.createdAt),type:"Complaint",data:H,originalDateString:H.createdAt})).filter(H=>!isNaN(H.date.getTime()));return W.sort((H,he)=>he.date.getTime()-H.date.getTime()),W},[F,b.pastComplaints]),B=w.useMemo(()=>{if(!F)return[];const W=[];return(b.pendingLabOrders??[]).forEach(H=>{const he=new Date(H.createdAt);isNaN(he.getTime())||W.push({date:he,type:"Lab Order (Pending)",data:H,originalDateString:H.createdAt})}),(b.labReports??[]).forEach(H=>{const he=H.reportCreatedAt?new Date(H.reportCreatedAt):null;he&&!isNaN(he.getTime())&&W.push({date:he,type:"Lab Report",data:H,originalDateString:H.reportCreatedAt})}),W.sort((H,he)=>he.date.getTime()-H.date.getTime()),W},[F,b.pendingLabOrders,b.labReports]),R=w.useMemo(()=>{if(!F||!b.pharmacyOrders)return[];const W=b.pharmacyOrders.map(H=>({date:new Date(H.date),type:"Pharmacy Order",data:H,originalDateString:H.date})).filter(H=>!isNaN(H.date.getTime()));return W.sort((H,he)=>he.date.getTime()-H.date.getTime()),W},[F,b.pharmacyOrders]),U=async()=>{r(!0),o(null);try{await de("/api/queue/doctor/next",{method:"POST"}),await L()}catch(W){console.error("Error calling next patient:",W),o(W.message||"Failed to call next patient.")}finally{r(!1)}},Y=async()=>{if(!(!e.currentPatient||P)){r(!0),o(null);try{await de(`/api/queue/doctor/complete/${e.currentPatient._id}`,{method:"POST"}),await L(),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),E(null)}catch(W){console.error("Error completing consultation:",W),o(W.message||"Failed to complete consultation.")}finally{r(!1)}}},Z=W=>{switch(W){case"waiting":return"Waiting";case"consulting":return"Consulting";case"seen":return"Seen";case"cancelled":return"Cancelled";default:return W}};let ne=null;return e.currentPatient&&(ne=i.jsxs("div",{className:"doctor-panel now-seeing-card",children:[i.jsxs("div",{className:"patient-main-info flex flex-col justify-between",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsxs("div",{className:"token-badge",children:["#",e.currentPatient.token]}),i.jsx("span",{className:`status-badge status-${e.currentPatient.status}`,children:Z(e.currentPatient.status)})]}),i.jsx("div",{className:"patient-name-large",children:e.currentPatient.name}),i.jsxs("div",{className:"patient-meta-large mb-4",children:[i.jsxs("span",{className:"bg-slate-100 dark:bg-slate-800 px-3 py-1 rounded-lg",children:[i.jsx("span",{className:"font-bold",children:e.currentPatient.age})," Yrs"]}),i.jsx("span",{className:"bg-slate-100 dark:bg-slate-800 px-3 py-1 rounded-lg",children:e.currentPatient.gender})]})]}),i.jsxs("div",{className:"flex gap-3 mt-4",children:[i.jsxs("button",{onClick:()=>{var H;const W=(H=e.currentPatient)==null?void 0:H._id;W&&I(`/dashboard/edit-complaint/${W}`)},disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"doctor-btn doctor-btn-primary flex-1",children:[i.jsx(ns,{size:18})," CONSULT & AI"]}),i.jsxs("button",{onClick:Y,disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"doctor-btn doctor-btn-secondary flex-1",children:[i.jsx(kI,{size:18})," COMPLETE"]})]})]}),i.jsxs("div",{className:"patient-history-preview pl-4 border-l border-slate-200 dark:border-slate-700",children:[i.jsxs("h3",{className:"history-section-title",children:[i.jsx(IN,{size:20,className:"text-teal-500"}),"Clinical Context"]}),T&&i.jsx("p",{className:"text-red-500 text-xs mb-2",children:T}),i.jsxs("div",{className:"space-y-1",children:[i.jsx(jf,{title:"Previous Complaints",icon:ns,items:z,isLoading:S,renderItemContent:W=>i.jsxs("div",{className:"history-item-compact history-item-complaint bg-white dark:bg-slate-800/50 shadow-sm border border-slate-100 dark:border-slate-700/50",children:[i.jsx("span",{className:"font-medium",children:W.data.complaint}),i.jsx("span",{className:"text-slate-400 block text-[10px] mt-0.5",children:Sf(W.originalDateString)})]})}),i.jsx(jf,{title:"Lab Observations",icon:n1,items:B,isLoading:S,renderItemContent:W=>i.jsxs("div",{className:"history-item-compact history-item-lab bg-white dark:bg-slate-800/50 shadow-sm border border-slate-100 dark:border-slate-700/50 text-[11px]",children:[W.type==="Lab Order (Pending)"?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"font-bold text-amber-600 dark:text-amber-400",children:"ORDER:"})," ",W.data.tests.map(H=>H.name).join(", ")]}):i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"font-bold text-teal-600 dark:text-teal-400",children:"REPORT:"})," ",W.data.testName," - ",W.data.reportFindings.substring(0,40),"..."]}),i.jsx("span",{className:"text-slate-400 block text-[10px] mt-0.5",children:Sf(W.originalDateString)})]})}),i.jsx(jf,{title:"Pharmacy History",icon:ho,items:R,isLoading:S,renderItemContent:W=>i.jsxs("div",{className:"history-item-compact history-item-pharmacy bg-white dark:bg-slate-800/50 shadow-sm border border-slate-100 dark:border-slate-700/50 text-[11px]",children:[i.jsx("span",{className:"font-medium",children:W.data.medications.map(H=>H.name).join(", ")}),i.jsx("span",{className:"text-slate-400 block text-[10px] mt-0.5",children:Sf(W.originalDateString)})]})})]})]})]})),i.jsx(i.Fragment,{children:i.jsxs("div",{className:"doctor-screen-container",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("button",{onClick:()=>I(-1),className:"back-button !mr-4 hover:scale-110 transition-transform",children:i.jsx(on,{size:24})}),i.jsx("h1",{className:"doctor-screen-header uppercase font-black",children:"Doctor Panel"})]}),i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("button",{onClick:()=>I("/dashboard/add-patient"),className:"doctor-btn doctor-btn-outline",children:[i.jsx(i1,{size:18})," Add Patient"]}),i.jsx("button",{onClick:()=>I("/search-patient"),className:"doctor-btn doctor-btn-outline",children:"Search Record"})]})]}),P?i.jsxs(i.Fragment,{children:[f&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:f}),l&&i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border-l-8 border-purple-500",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"text-xl text-purple-700 font-semibold",children:"Patient Record:"}),i.jsx("button",{onClick:()=>I("/dashboard/doctor"),className:"text-sm text-blue-600 hover:underline",children:"Back to Queue"})]}),i.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-1 md:mb-2",children:l.name}),i.jsxs("div",{className:"text-lg md:text-xl text-gray-600 mb-3 md:mb-4",children:["Age: ",l.age??"N/A"," | ",l.gender??"N/A"]}),i.jsxs("div",{className:"mt-3 md:mt-4 p-3 bg-gray-50 rounded border border-gray-200",children:[i.jsx("label",{className:"font-medium block mb-1 text-sm text-gray-600",children:"Latest Queue Entry:"}),d?i.jsxs("div",{className:"space-y-2",children:[" ",i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("span",{className:"text-sm flex-1 break-words",children:[i.jsxs("span",{className:"font-medium text-gray-700",children:["(",d.age," / ",d.gender,")"]}),": ",d.complaint||i.jsx("span",{className:"text-gray-400 italic",children:"No complaint"}),i.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full text-xs font-medium ${d.status==="consulting"?"bg-teal-100 text-teal-800":d.status==="seen"?"bg-green-100 text-green-800":d.status==="waiting"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:Z(d.status)})]}),d.status==="consulting"&&d._id&&i.jsx("button",{onClick:()=>I(`/dashboard/edit-complaint/${d._id}`),className:"ml-4 px-2 py-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 rounded flex-shrink-0",children:"Edit"})]}),d.case_summary&&i.jsxs("p",{className:"text-xs text-gray-700 bg-yellow-50 p-2 rounded border border-yellow-200",children:[i.jsx("span",{className:"font-semibold text-gray-800",children:"AI Summary:"})," ",d.case_summary]})]}):i.jsx("p",{className:"text-gray-500 italic text-sm",children:"No queue entry found for this patient today."})]}),i.jsxs("div",{className:"mt-4 border-t pt-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Patient History:"}),T&&i.jsx("p",{className:"text-red-500 text-xs mb-2",children:T}),i.jsx(jf,{title:"Complaints History",icon:ns,items:z,isLoading:S,renderItemContent:W=>i.jsxs("div",{className:"history-item-compact history-item-complaint bg-white dark:bg-slate-800/50 shadow-sm border border-slate-100 dark:border-slate-700/50",children:[i.jsx("span",{className:"font-medium",children:W.data.complaint}),i.jsx("span",{className:"text-slate-400 block text-[10px] mt-0.5",children:Sf(W.originalDateString)})]})}),i.jsx(jf,{title:"Lab History (Orders & Reports)",icon:n1,items:B,isLoading:S,renderItemContent:W=>i.jsxs("div",{className:"history-item-compact history-item-lab bg-white dark:bg-slate-800/50 shadow-sm border border-slate-100 dark:border-slate-700/50 text-[11px]",children:[W.type==="Lab Order (Pending)"?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"font-bold text-amber-600 dark:text-amber-400",children:"ORDER:"})," ",W.data.tests.map(H=>H.name).join(", ")]}):i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"font-bold text-teal-600 dark:text-teal-400",children:"REPORT:"})," ",W.data.testName," - ",W.data.reportFindings.substring(0,40),"..."]}),i.jsx("span",{className:"text-slate-400 block text-[10px] mt-0.5",children:Sf(W.originalDateString)})]})}),i.jsx(jf,{title:"Pharmacy Order History",icon:ho,items:R,isLoading:S,renderItemContent:W=>i.jsxs("div",{className:"history-item-compact history-item-pharmacy bg-white dark:bg-slate-800/50 shadow-sm border border-slate-100 dark:border-slate-700/50 text-[11px]",children:[i.jsx("span",{className:"font-medium",children:W.data.medications.map(H=>H.name).join(", ")}),i.jsx("span",{className:"text-slate-400 block text-[10px] mt-0.5",children:Sf(W.originalDateString)})]})}),z.length===0&&B.length===0&&R.length===0&&!S&&i.jsx("p",{className:"text-slate-500 italic text-sm mt-4",children:"No clinical history found for this patient."})]})]})]}):i.jsxs(i.Fragment,{children:[a&&i.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded mb-6 font-medium shadow-sm border border-red-100",children:a}),t&&!e.currentPatient&&i.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-slate-400",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-500 mb-4"}),i.jsx("p",{className:"font-medium",children:"Fetching doctor queue..."})]}),i.jsx("div",{className:"mb-4",children:ne||i.jsxs("div",{className:"doctor-panel text-center py-8 flex flex-col items-center justify-center",children:[i.jsx("div",{className:"text-slate-200 mb-4",children:i.jsx(i1,{size:64,strokeWidth:1})}),i.jsx("div",{className:"text-xl font-bold text-slate-500",children:"No Patient Session Active"}),i.jsxs("p",{className:"text-slate-400 mt-2 max-w-sm text-sm",children:["The consultation area is ready. Press ",i.jsx("b",{children:"Call Patient"})," below or from the upcoming list to start a session."]})]})}),i.jsxs("div",{className:"current-queue-section mb-10",children:[i.jsxs("h2",{className:"history-section-title !text-lg !mb-6",children:[i.jsx(on,{size:22,className:"rotate-180 p-1 bg-teal-100 dark:bg-teal-900/40 text-teal-600 rounded-lg"}),"UPCOMING IN QUEUE"]}),e.nextPatient?i.jsxs("div",{className:"doctor-panel next-patient-card !p-0 overflow-hidden",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-stretch",children:[i.jsxs("div",{className:"flex items-center gap-6 p-4",children:[i.jsxs("div",{className:"token-badge !text-2xl !p-3 !mb-0 min-w-[4rem] !rounded-xl",children:["#",e.nextPatient.token]}),i.jsxs("div",{children:[i.jsxs("div",{className:"text-2xl font-black mb-1 flex items-center gap-3",children:[e.nextPatient.name,i.jsx("span",{className:`status-badge status-${e.nextPatient.status} !text-[10px]`,children:Z(e.nextPatient.status)})]}),i.jsxs("div",{className:"flex gap-2 items-center text-slate-500",children:[i.jsxs("span",{className:"font-bold text-slate-700 dark:text-slate-300",children:[e.nextPatient.age," Yrs"]}),i.jsx("span",{className:"opacity-30",children:"|"}),i.jsx("span",{children:e.nextPatient.gender})]})]})]}),i.jsx("div",{className:"flex px-6 py-4 md:py-0 bg-slate-50 dark:bg-slate-800/30 items-center justify-end",children:i.jsx("button",{onClick:U,disabled:t||!!e.currentPatient,className:"doctor-btn doctor-btn-primary !px-10 !py-4 !text-lg !rounded-xl w-full md:w-auto shadow-lg disabled:opacity-30",children:"CALL PATIENT"})})]}),(e.nextPatient.complaint||e.nextPatient.case_summary)&&i.jsxs("div",{className:"bg-slate-50/50 dark:bg-slate-900/20 px-8 py-3 border-t border-slate-100 dark:border-slate-800 flex flex-col gap-2",children:[e.nextPatient.complaint&&i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"font-bold text-slate-400 mr-2",children:"CHIEF COMPLAINT:"}),i.jsxs("span",{className:"text-slate-600 dark:text-slate-400 italic",children:['"',e.nextPatient.complaint,'"']})]}),e.nextPatient.case_summary&&i.jsxs("div",{className:"text-xs bg-teal-50 dark:bg-teal-900/20 text-teal-700 dark:text-teal-400 p-2 rounded-lg border border-teal-100/50 dark:border-teal-800/50",children:[i.jsx("span",{className:"font-bold mr-2 uppercase tracking-tight",children:"AI Insights:"}),e.nextPatient.case_summary]})]})]}):i.jsxs("div",{className:"doctor-panel text-center py-10 text-slate-400 border-dashed border-2",children:[i.jsx(ho,{size:32,className:"mx-auto mb-3 opacity-20"}),i.jsx("p",{className:"font-medium",children:"The waiting queue is currently empty."})]})]}),i.jsxs("div",{className:"mt-auto pt-4 border-t border-slate-200 dark:border-slate-800 flex justify-between items-center",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-8 h-8 rounded-full bg-teal-100 dark:bg-teal-900/40 flex items-center justify-center text-teal-600",children:i.jsx(IN,{size:16})}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Queue Status"}),i.jsxs("div",{className:"text-base font-black",children:[e.waitingCount," Patients waiting"]})]})]}),i.jsx("div",{className:"flex gap-2"})]})]})]})})},vE=()=>{const[e,n]=w.useState(""),[t,r]=w.useState([]),[a,o]=w.useState(null),[l,h]=w.useState(null),[d,u]=w.useState(null),[f,g]=w.useState(null),[b,v]=w.useState(!1),[S,k]=w.useState(!1),[T,E]=w.useState(null),P=Ot(),I=w.useCallback(gE.debounce(async R=>{if(R.trim().length<2){r([]),k(!1);return}k(!0),E(null);try{const U=new URLSearchParams({search:encodeURIComponent(R),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),Y=await de(`/api/patients?${U.toString()}`);if(!Y.ok){const ne=await Y.text();throw new Error(`API Error (${Y.status}): ${ne||Y.statusText||"Failed to fetch patients"}`)}const Z=await Y.json();r(Z.patients)}catch(U){E(U instanceof Error?U.message:"An unknown error occurred while searching patients"),r([])}finally{k(!1)}},500),[]);w.useEffect(()=>(e?(k(!0),I(e)):(r([]),I.cancel()),()=>{I.cancel()}),[e,I]);const q=R=>{o(R),n(""),r([]),E(null),h(null),u(null),g(null),v(!1)},$=async()=>{if(!a){E("No patient selected.");return}E(null),k(!0);try{const R=await de(`/api/patients/${a.id}/admit`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!R.ok){const Y=await R.json().catch(()=>({message:"Failed to admit patient"}));throw new Error(Y.message||"Failed to admit patient")}const U=await R.json();alert(U.message||"Patient admitted successfully!"),U.bill&&U.bill.id?P(`/patient/${a.id}/admission-bill/${U.bill.id}`):(console.error("Admission successful, but bill ID missing in response."),E("Admission successful, but couldn't navigate to billing."),o(U.patient))}catch(R){E(R instanceof Error?R.message:"Failed to admit patient")}finally{k(!1)}};w.useEffect(()=>{(async()=>{if(!a||!a.admission_date||a.discharge_date){h(null),g(null);return}v(!0),u(null),h(null),g(null);try{const U=await de(`/api/patients/${a.id}/active-bill?type=admission`);if(!U.ok)throw U.status===404?new Error("No active admission bill found."):new Error("Failed to fetch active bill ID.");const Y=await U.json(),Z=Y==null?void 0:Y.id;if(!Z)throw new Error("Active admission bill ID not found in response.");h(Z);const ne=await de(`/api/bills/${Z}`);if(!ne.ok)throw new Error(`Failed to fetch bill details (ID: ${Z}). Status: ${ne.status}`);const ae=await ne.json();if(ae&&ae.calculated)g(ae.calculated);else throw console.error("Fetched bill details missing 'calculated' object:",ae),new Error("Fetched bill details are incomplete (missing calculated data).")}catch(U){u(U instanceof Error?U.message:"An unknown error occurred while fetching bill details."),h(null),g(null)}finally{v(!1)}})()},[a]);const L=async()=>{if(!a){E("No patient selected.");return}if(!a.admission_date||a.discharge_date){E("Patient is not currently admitted.");return}E(null),k(!0);try{const R=await de(`/api/patients/${a.id}/discharge`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!R.ok){const Y=await R.json().catch(()=>({message:"Failed to discharge patient"}));throw new Error(Y.message||"Failed to discharge patient")}const U=await R.json();alert(U.message||"Patient discharged successfully!"),U.patient?o(U.patient):(console.error("Discharge successful, but updated patient info missing in response."),o(null),E("Discharge successful, but couldn't update patient details locally."))}catch(R){E(R instanceof Error?R.message:"Failed to discharge patient")}finally{k(!1)}},F=()=>{if(!a||!l){E("Cannot navigate to billing: Patient or Bill ID missing.");return}P(`/patient/${a.id}/admission-bill/${l}`)};let z="",B=null;if(a){const R=a.admission_date?new Date(a.admission_date).toLocaleDateString():null,U=a.discharge_date?new Date(a.discharge_date).toLocaleDateString():null;a.admission_date?a.admission_date&&!a.discharge_date?(z=`Patient admitted on: ${R}`,B=i.jsxs("div",{className:"space-y-4",children:[" ",b&&i.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Loading billing details..."})," ",d&&i.jsx("p",{className:"text-sm text-red-500 text-center",children:d})," ",!b&&f&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Total Due:"}),i.jsxs("span",{children:["",(Number(f.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[" ",i.jsx("span",{children:"Total Paid:"}),i.jsxs("span",{children:["",(Number(f.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm font-bold mt-1 text-red-600",children:[" ",i.jsx("span",{children:"Balance Due:"}),i.jsxs("span",{children:["",(Number(f.balance)||0).toFixed(2)]})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("button",{onClick:F,disabled:S||b||!l,className:`admission-button admission-button-secondary ${S||b||!l?"opacity-50 cursor-not-allowed":""}`,children:b?"Loading Bill...":!l&&!d?"Finding Bill...":"Pay Bill / View Details"}),i.jsx("button",{onClick:L,disabled:S||b,className:`admission-button admission-button-danger ${S||b?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Discharge Patient"})]})]})):(z=`Patient admitted on ${R} and discharged on ${U}.`,B=i.jsx("p",{className:"text-center text-gray-600 italic",children:"Patient has been discharged."})):(z="Patient is not admitted.",B=i.jsx("button",{onClick:$,disabled:S,className:`admission-button ${S?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Admit Patient"}))}return i.jsxs("div",{className:"admission-page-container",children:[i.jsxs("div",{className:"admission-header-container",children:[i.jsxs("button",{onClick:()=>P(-1),className:"back-button",children:[i.jsx(on,{size:16}),"Back"]}),i.jsx("h1",{className:"admission-header",children:"Manage Admission/Discharge"})]}),i.jsxs("div",{className:"admission-section mb-6 relative",children:[i.jsx("label",{htmlFor:"patientSearch",className:"admission-label",children:"Search Patient (Name, Phone, or Token)"}),i.jsx("input",{type:"text",id:"patientSearch",value:e,onChange:R=>n(R.target.value),placeholder:"Start typing to search...",className:"admission-input"}),S&&!a&&i.jsx("div",{className:"absolute right-3 top-9 text-sm text-gray-500",children:"Loading..."})," ",t.length>0&&!a&&i.jsxs("ul",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[" ",t.map(R=>i.jsxs("li",{onClick:()=>q(R),className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",children:[" ",R.name," (Token: ",R.token,")",i.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[R.admission_date?`Admitted: ${new Date(R.admission_date).toLocaleDateString()}`:"Not Admitted",R.discharge_date?`, Discharged: ${new Date(R.discharge_date).toLocaleDateString()}`:""]})]},R.id))]}),t.length===0&&e&&!S&&!a&&i.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg p-4 text-gray-500",children:['No patients found matching "',e,'".']})]}),a&&i.jsxs("div",{className:"admission-section",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h2",{className:"admission-section-title",children:"Selected Patient"}),i.jsx("button",{onClick:()=>o(null),className:"admission-link",children:"Clear Selection"})]}),i.jsxs("div",{className:"admission-card-content mb-4 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Name:"})," ",a.name]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Token:"})," ",a.token]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Age:"})," ",a.age??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Gender:"})," ",a.gender??"N/A"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Phone:"})," ",a.phone??"N/A"]}),i.jsxs("p",{className:"col-span-2",children:[i.jsx("strong",{children:"Address:"})," ",a.address??"N/A"]})]}),i.jsx("hr",{className:"my-4"}),i.jsx("p",{className:"text-sm text-gray-600 mb-3",children:z})," ",T&&i.jsx("p",{className:"text-red-500 text-sm mb-3",children:T})," ",B]})]})},$H=15,M1=()=>{const e=Ot(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[o,l]=w.useState(null),[h,d]=w.useState(""),[u,f]=w.useState(1),[g,b]=w.useState(1),[v,S]=w.useState("created_at"),[k,T]=w.useState("desc"),[E,P]=w.useState(""),[I,q]=w.useState(!1),[$,L]=w.useState(null),[F,z]=w.useState([]),[B,R]=w.useState(""),[U,Y]=w.useState(!1),[Z,ne]=w.useState(null),[ae,X]=w.useState(null),[W,H]=w.useState(!0),[he,D]=w.useState(null),[te,ve]=w.useState(h);w.useEffect(()=>{const fe=setTimeout(()=>{ve(h),f(1)},500);return()=>{clearTimeout(fe)}},[h]);const M=w.useCallback(async()=>{H(!0),D(null);try{const fe=await de("/api/subscriptions");if(!fe.ok){let Re=`Failed to fetch subscription plans (${fe.status})`;try{Re=(await fe.json()).message||Re}catch{}throw new Error(Re)}const pe=await fe.json();z(pe)}catch(fe){console.error("Error fetching subscription plans:",fe),D(fe.message||"An unknown error occurred while fetching plans."),z([])}finally{H(!1)}},[]),ge=w.useCallback(async(fe,pe,Re,Ye,ut)=>{a(!0),l(null);try{const Ge=new URLSearchParams({page:fe.toString(),limit:$H.toString(),sortBy:Re,sortOrder:Ye});pe&&Ge.append("search",pe),ut&&Ge.append("gender",ut);const Se=await de(`/api/patients?${Ge.toString()}`);if(!Se.ok){const Ue=await Se.json();throw new Error(Ue.message||"Failed to fetch patients")}const qe=await Se.json();t(qe.patients),f(qe.currentPage),b(qe.totalPages)}catch(Ge){console.error("Error fetching patients:",Ge),l(`Failed to load patients: ${Ge.message}`),t([]),f(1),b(1)}finally{a(!1)}},[]);w.useEffect(()=>{ge(u,te,v,k,E),M()},[u,te,v,k,E,ge,M]);const _e=fe=>{const pe=v===fe&&k==="asc"?"desc":"asc";S(fe),T(pe),f(1)},se=fe=>{try{return new Date(fe).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},ee=()=>{q(!1),L(null),R(""),ne(null),Y(!1)},oe=async(fe,pe)=>{t(Re=>Re.map(Ye=>Ye.id===fe?{...Ye,insurance_type:pe}:Ye));try{const Re=await de(`/api/patients/${fe}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:pe})});if(!Re.ok){const Ye=await Re.json();throw new Error(Ye.message||"Failed to update insurance type")}}catch(Re){console.error("Error updating insurance type:",Re),ge(u,te,v,k,E)}},ue=(fe,pe)=>{const Re=new Date(fe),Ye=pe.interval||1;switch(pe.period){case"daily":Re.setDate(fe.getDate()+Ye);break;case"weekly":Re.setDate(fe.getDate()+Ye*7);break;case"monthly":Re.setMonth(fe.getMonth()+Ye);break;case"yearly":Re.setFullYear(fe.getFullYear()+Ye);break;default:console.warn(`Unknown subscription period: ${pe.period}. Defaulting to 1 month.`),Re.setMonth(fe.getMonth()+1)}return Re},Ee=async()=>{if(!$||!B){ne("Please select a subscription plan.");return}const fe=F.find(pe=>pe.id===B);if(!fe){ne("Selected plan details not found.");return}Y(!0),ne(null);try{const pe=new Date,Re=ue(pe,fe),Ye={subscription_plan_id:B,subscription_status:"active",subscription_start_date:pe.toISOString(),subscription_end_date:Re.toISOString(),subscription_payment_method:"manual"},ut=await de(`/api/patients/${$.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ye)});if(!ut.ok){const Ge=await ut.json();throw new Error(Ge.message||"Failed to update patient subscription")}ee(),ge(u,te,v,k,E)}catch(pe){console.error("Error starting subscription:",pe),ne(`Failed to start subscription: ${pe.message}`)}finally{Y(!1)}},Ie=async fe=>{if(!ae){X(fe.id);try{const pe=await de(`/api/queue/patient/${fe.id}/latest`);if(pe.ok){const ut=await pe.json();if(ut!=null&&ut._id){e(`/dashboard/edit-complaint/${ut._id}`,{state:{patientId:fe.id}});return}}else if(pe.status!==404){const ut=await pe.text();throw new Error(`Failed to fetch queue entry: ${ut||pe.statusText}`)}const Re=await de("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:fe.id})});if(!Re.ok){const ut=await Re.text();throw new Error(`Failed to create queue entry: ${ut||Re.statusText}`)}const Ye=await Re.json();if(Ye!=null&&Ye.id)e(`/dashboard/edit-complaint/${Ye.id}`,{state:{patientId:fe.id}});else throw new Error("Failed to get ID from new queue entry.")}catch(pe){console.error("Error processing patient selection:",pe),alert(pe.message||"An error occurred while processing the selection.")}finally{X(null)}}};return i.jsxs("div",{className:"all-patients-container",children:[i.jsx("div",{className:"compact-header-container",children:i.jsxs("div",{className:"header-top-row",children:[i.jsxs("div",{className:"header-left",children:[i.jsx("button",{onClick:()=>e(-1),className:"icon-back-button",title:"Go Back",children:i.jsx(on,{size:20})}),i.jsx("h1",{className:"compact-page-title",children:"All Patients"})]}),i.jsxs("div",{className:"header-right-controls",children:[i.jsxs("div",{className:"compact-search-wrapper",children:[i.jsx(Ai,{className:"search-icon-small",size:16}),i.jsx("input",{type:"text",placeholder:"Search...",className:"compact-search-input",value:h,onChange:fe=>d(fe.target.value)}),h&&i.jsx("button",{onClick:()=>d(""),className:"clear-search-button",children:i.jsx(In,{size:14})})]}),i.jsxs("div",{className:"compact-filter-wrapper",children:[i.jsx(YC,{size:14,className:"filter-icon-small"}),i.jsxs("select",{value:E,onChange:fe=>P(fe.target.value),className:"compact-filter-select",children:[i.jsx("option",{value:"",children:"All Genders"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]}),i.jsx("div",{className:"plans-indicator",children:W?i.jsx("span",{className:"text-xs text-gray-400",children:"..."}):i.jsxs("span",{className:"text-xs font-medium text-indigo-600 bg-indigo-50 px-2 py-1 rounded-full",children:[F.length," Plans"]})})]})]})}),o&&i.jsx("div",{className:"compact-error-alert",role:"alert",children:i.jsx("span",{children:o})}),!W&&F.length>0&&i.jsx("div",{className:"compact-plans-strip",children:i.jsxs("div",{className:"plans-ticker-content",children:[i.jsx("span",{className:"plans-label",children:"Available Plans:"}),F.map(fe=>i.jsxs("span",{className:"plan-pill",children:[fe.name," ",i.jsxs("span",{className:"plan-price",children:["",fe.price]})]},fe.id))]})}),r?i.jsx("div",{className:"compact-loading-state",children:"Loading..."}):n.length===0?i.jsx("div",{className:"compact-empty-state",children:te?"No matching patients.":"No patients registered."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"compact-table-container",children:i.jsxs("table",{className:"compact-patients-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"w-16",children:"Token"}),i.jsx("th",{onClick:()=>_e("name"),className:"cursor-pointer hover:bg-gray-50 transition-colors",children:i.jsxs("div",{className:"flex items-center gap-1",children:["Name",v==="name"&&(k==="asc"?i.jsx(co,{size:12}):i.jsx(du,{size:12}))]})}),i.jsx("th",{className:"w-16",children:"Age"}),i.jsx("th",{className:"w-16",children:"Sex"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"City/Address"}),i.jsx("th",{onClick:()=>_e("created_at"),className:"cursor-pointer hover:bg-gray-50 transition-colors",children:i.jsxs("div",{className:"flex items-center gap-1",children:["Reg. Date",v==="created_at"&&(k==="asc"?i.jsx(co,{size:12}):i.jsx(du,{size:12}))]})}),i.jsx("th",{children:"Sub. Status"}),i.jsx("th",{children:"Payment"}),i.jsx("th",{className:"w-24 text-center",children:"Action"})]})}),i.jsx("tbody",{children:n.map(fe=>i.jsxs("tr",{onClick:()=>Ie(fe),className:`compact-row ${ae===fe.id?"navigating":""}`,children:[i.jsxs("td",{className:"font-mono text-gray-500",children:["#",fe.token??"-"]}),i.jsx("td",{className:"font-medium text-gray-900",children:fe.name}),i.jsx("td",{children:fe.age??"-"}),i.jsx("td",{children:fe.gender??"-"}),i.jsx("td",{children:fe.phone??"-"}),i.jsx("td",{className:"truncate max-w-[150px]",title:fe.address||"",children:fe.address??"-"}),i.jsx("td",{className:"text-xs text-gray-500",children:se(fe.created_at)}),i.jsxs("td",{children:[i.jsx("span",{className:`compact-status-dot ${fe.subscription_status==="active"?"bg-green-500":["cancelled","expired"].includes(fe.subscription_status||"")?"bg-red-400":"bg-gray-300"}`}),i.jsx("span",{className:"text-xs ml-2 capitalize",children:fe.subscription_status??"None"})]}),i.jsx("td",{children:i.jsxs("select",{value:fe.insurance_type,onChange:pe=>oe(fe.id,pe.target.value),onClick:pe=>pe.stopPropagation(),className:"compact-select-input",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"insurance",children:"Insurance"}),i.jsx("option",{value:"no_cash_insurance",children:"N/C Ins"})]})}),i.jsx("td",{className:"text-center",children:i.jsx("button",{onClick:pe=>{pe.stopPropagation(),e(`/start-subscription/${fe.id}`)},className:"compact-action-btn",title:"Start Subscription",children:"Sub"})})]},fe.id))})]})}),g>1&&i.jsxs("div",{className:"compact-pagination",children:[i.jsx("button",{onClick:()=>f(fe=>Math.max(fe-1,1)),disabled:u===1||r,className:"compact-page-btn",children:i.jsx(Pb,{size:16})}),i.jsxs("span",{className:"text-xs text-gray-600 font-medium",children:[u," / ",g]}),i.jsx("button",{onClick:()=>f(fe=>Math.min(fe+1,g)),disabled:u===g||r,className:"compact-page-btn",children:i.jsx(bg,{size:16})})]})]}),I&&$&&i.jsx("div",{className:"subscription-modal-overlay",children:i.jsxs("div",{className:"subscription-modal-content",children:[i.jsxs("div",{className:"subscription-modal-header",children:[i.jsxs("h2",{className:"subscription-modal-title",children:["Start Subscription for ",$.name]}),i.jsx("button",{onClick:ee,className:"subscription-modal-close-button",children:i.jsx(In,{size:24})})]}),Z&&i.jsx("div",{className:"error-alert",role:"alert",children:i.jsx("span",{children:Z})}),i.jsxs("div",{className:"subscription-modal-body",children:[i.jsx("label",{htmlFor:"subscriptionPlan",className:"form-label",children:"Select Plan:"}),i.jsxs("select",{id:"subscriptionPlan",value:B,onChange:fe=>R(fe.target.value),className:"form-select",disabled:U||W||he!==null||F.length===0,children:[i.jsx("option",{value:"",disabled:!0,children:"-- Select a Plan --"}),W?i.jsx("option",{value:"",disabled:!0,children:"Loading plans..."}):he?i.jsx("option",{value:"",disabled:!0,children:"Error loading plans"}):F.length>0?F.map(fe=>i.jsxs("option",{value:fe.id,children:[fe.name," - ",fe.price," (",fe.interval," ",fe.period,fe.interval>1?"s":"",")"]},fe.id)):i.jsx("option",{value:"",disabled:!0,children:"No active plans found"})]}),he&&i.jsx("p",{className:"error-message",children:he}),F.length===0&&!W&&!he&&i.jsx("p",{className:"empty-state",children:"No active subscription plans available."})]}),i.jsxs("div",{className:"subscription-modal-footer",children:[i.jsx("button",{onClick:ee,disabled:U,className:"subscription-modal-button cancel",children:"Cancel"}),i.jsx("button",{onClick:Ee,disabled:!B||U,className:"subscription-modal-button submit",children:U?"Starting...":"Start Subscription"})]})]})})]})},wE=()=>{const e=Ot(),[n]=w.useState(!0),[t,r]=w.useState(""),[a,o]=w.useState([]),[l,h]=w.useState(!1),[d,u]=w.useState(null),[f,g]=w.useState(!1),b=/^\+?[0-9\s\-().]{7,20}$/,v=w.useMemo(()=>qb(async E=>{if(E.trim().length<2){o([]),h(!1),u(null);return}h(!0),u(null);try{const P=new URLSearchParams({search:encodeURIComponent(E),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),I=await de(`/api/patients?${P.toString()}`);if(!I.ok){const $=await I.text();throw new Error(`API Error (${I.status}): ${$||I.statusText}`)}const q=await I.json();o(q.patients)}catch(P){console.error("Error searching patients:",P),u(P.message||"Failed to search patients."),o([])}finally{h(!1)}},300),[]),S=E=>{const P=E.target.value;r(P),g(b.test(P)),h(!0),v(P)},k=w.useCallback(E=>{e("/billing",{state:{patientId:E.id,patientName:E.name}})},[e]),T=w.useCallback(async()=>{if(!t||!f){u("Invalid phone number to create a new patient.");return}h(!0),u(null);try{const P=await de("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"direct pharmacy",phone:t,age:null,gender:null,token:null})});if(!P.ok){const q=await P.json();throw new Error(q.message||`Failed to create patient: ${P.statusText}`)}const I=await P.json();alert(`New patient "direct pharmacy" created with phone ${I.phone}.`),k(I)}catch(E){console.error("Error creating new patient:",E),u(E.message||"Failed to create new patient.")}finally{h(!1)}},[t,f,k]);return i.jsxs("div",{className:"create-custom-bill-page p-4 md:p-6 max-w-5xl mx-auto",children:[i.jsx("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:i.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:i.jsx(on,{size:20})}),i.jsx("h2",{className:"text-2xl",children:"Create Custom Bill"})]})}),n&&i.jsxs("div",{className:"content-section",children:[i.jsx("h3",{className:"section-title",children:"Select Patient"}),i.jsxs("div",{className:"mb-3 relative",children:[i.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"}),i.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:t,onChange:S,className:"custom-text-input mt-1",autoFocus:!0}),l&&i.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),d&&i.jsx("div",{className:"ai-function-status error mb-3 p-3",children:d}),a.length>0&&i.jsx("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:i.jsx("ul",{children:a.map(E=>i.jsxs("li",{onClick:()=>k({id:E.id,name:E.name,token:E.token,age:E.age,gender:E.gender,phone:E.phone}),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[i.jsxs("div",{className:"font-medium",children:[i.jsxs("span",{className:"patient-token mr-2",children:["#",E.token]}),E.name]}),i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[E.age?`${E.age} yrs`:"Age N/A",E.gender?` / ${E.gender}`:" / Gender N/A",E.phone&&i.jsxs("span",{className:"hidden sm:inline",children:[" / ",E.phone]})]})]}),E.phone&&i.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",E.phone]})]},E.id))})}),t.length>=2&&!l&&a.length===0&&!d&&i.jsxs(i.Fragment,{children:[i.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',t,'".']}),f&&i.jsx("button",{type:"button",onClick:T,className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:l,children:'Create "direct pharmacy" Patient with this Phone'})]}),t.length<2&&!l&&i.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]})]})},NE=({currentUser:e})=>{const n=Ot(),[t,r]=w.useState("select_patient"),[a,o]=w.useState({name:"",age:void 0,gender:null,phone:"",address:""}),[l,h]=w.useState(null),[d,u]=w.useState([]),[f,g]=w.useState([]),[b,v]=w.useState(""),[S,k]=w.useState([]),[T,E]=w.useState(""),[P,I]=w.useState([]),[q,$]=w.useState(!1),[L,F]=w.useState(null),[z,B]=w.useState(null),[R,U]=w.useState(null),[Y,Z]=w.useState(!1),[ne,ae]=w.useState(!1),[X,W]=w.useState(!1),H=/^\+?[0-9\s\-().]{7,20}$/,he=/^[a-zA-Z\s'-]{2,}$/,D=w.useCallback(async()=>{if(!(d.length>0)){Z(!0),U(null);try{const pe=await de("/api/lab-tests");if(!pe.ok)throw new Error("Failed to fetch lab tests");const Re=await pe.json();u(Re)}catch(pe){console.error("Failed to fetch available lab tests:",pe),U("Could not load lab test list: "+pe.message),u([])}finally{Z(!1)}}},[d.length]);w.useEffect(()=>{if(!b){k([]);return}const pe=b.toLowerCase();k(d.filter(Re=>Re.name.toLowerCase().includes(pe)||Re.description&&Re.description.toLowerCase().includes(pe)).slice(0,10))},[b,d]);const te=w.useCallback(pe=>{const Re={id:pe.id,name:pe.name,token:pe.token,age:pe.age,gender:pe.gender,phone:pe.phone};h(Re),r("create_order"),g([]),v(""),k([]),U(null),D()},[D]),ve=w.useMemo(()=>qb(async pe=>{if(pe.trim().length<2){I([]),$(!1),F(null);return}$(!0),F(null);try{const Re=new URLSearchParams({search:encodeURIComponent(pe),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Ye=await de(`/api/patients?${Re.toString()}`);if(!Ye.ok){const Ge=await Ye.text();throw new Error(`API Error (${Ye.status}): ${Ge||Ye.statusText}`)}const ut=await Ye.json();I(ut.patients)}catch(Re){console.error("Error searching lab patients:",Re),F(Re.message||"Failed to search lab patients."),I([])}finally{$(!1)}},300),[H,he]),M=pe=>{const Re=pe.target.value;E(Re),ae(H.test(Re)),W(he.test(Re)&&!H.test(Re)),$(!0),ve(Re)},ge=w.useCallback(async pe=>{if(!T||pe==="phone"&&!ne||pe==="name"&&!X){F(`Invalid ${pe} to create a new patient.`);return}$(!0),F(null);try{const ut=await(await de("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:pe==="name"?T:"direct lab",phone:pe==="phone"?T:null,age:null,gender:null,token:null})})).json();alert(`New patient "${ut.name}" created with ${pe==="phone"?`phone ${ut.phone}`:`name ${ut.name}`}.`),te({id:ut.id,name:ut.name,token:ut.token??null,age:ut.age??null,gender:ut.gender??null,phone:ut.phone})}catch(Re){console.error("Error creating new patient:",Re);const Ye=Re.message||"";if(Ye.toLowerCase().includes("patient limit")){n("/start-clinic-subscription",{state:{errorMessage:Ye}});return}F(Ye||"Failed to create new patient.")}finally{$(!1)}},[T,ne,X,te]),_e=()=>{o({name:"",age:void 0,gender:null,phone:"",address:""}),B(null),r("create_patient"),h(null)},se=()=>{r("select_patient"),h(null),E(""),I([]),F(null)},ee=pe=>{const{name:Re,value:Ye}=pe.target;o(ut=>({...ut,[Re]:Re==="age"?Ye?parseInt(Ye,10):void 0:Ye}))},oe=async pe=>{if(pe.preventDefault(),B(null),!a.name){B("Patient Name is required.");return}const Re={name:a.name,age:a.age,gender:a.gender,phone:a.phone,address:a.address};try{const ut=await(await de("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Re)})).json();te({id:ut.id,name:ut.name,token:ut.token??null,age:ut.age??null,gender:ut.gender??null,phone:ut.phone})}catch(Ye){console.error("Failed to create patient:",Ye);const ut=Ye.message||"";if(ut.toLowerCase().includes("patient limit")){n("/start-clinic-subscription",{state:{errorMessage:ut}});return}B(ut||"Failed to create patient. Please try again.")}},ue=pe=>{if(f.some(Re=>Re.id===pe.id)){U(`${pe.name} is already in the order.`),setTimeout(()=>U(null),3e3),v(""),k([]);return}g(Re=>[...Re,{...pe}]),v(""),k([])},Ee=pe=>{g(Re=>Re.filter(Ye=>Ye.id!==pe))},Ie=async pe=>{if(pe.preventDefault(),U(null),!l){U("No patient selected.");return}if(f.length===0){U("No lab tests selected.");return}const Re={patient_id:l.id,tests:f.map(Ye=>({id:Ye.id,name:Ye.name,price:Ye.price}))};try{const Ye=await de("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Re)});if(!Ye.ok){const Ge=await Ye.json();throw new Error(Ge.message||`Failed to create lab order: ${Ye.statusText}`)}await Ye.json();let ut=l.queueId;if(!ut){const Ge=await de(`/api/queue/patient/${l.id}/latest`);if(Ge.ok){const Se=await Ge.json();Se!=null&&Se._id&&(ut=Se._id)}}if(!ut){const Ge=await de("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:l.id})});if(!Ge.ok){const qe=await Ge.text();throw new Error(`Failed to create queue entry for redirection: ${qe||Ge.statusText}`)}const Se=await Ge.json();Se!=null&&Se.id&&(ut=Se.id)}alert(`Lab order created successfully for ${l.name}!`),(e==null?void 0:e.role)==="lab"?n("/dashboard"):n(`/dashboard/edit-complaint/${ut}`,{state:{patientId:l.id}})}catch(Ye){console.error("Failed to create lab order:",Ye),U(Ye.message||"Failed to create lab order.")}};w.useEffect(()=>{D()},[D]);const fe=()=>f.reduce((pe,Re)=>pe+parseFloat(Re.price),0).toFixed(2);return i.jsxs("div",{className:"create-lab-order-page",children:[i.jsxs("div",{className:"page-header",children:[i.jsx("button",{onClick:()=>n(-1),className:"back-button","aria-label":"Go back",children:i.jsx(on,{size:20})}),i.jsx("h1",{children:"Create New Lab Order"}),i.jsx("div",{className:"w-10"})," "]}),(t==="select_patient"||t==="create_patient")&&i.jsxs("div",{className:"patient-selection-container",children:[t==="select_patient"&&i.jsxs("div",{className:"content-panel",children:[i.jsx("h2",{className:"section-title",style:{justifyContent:"center"},children:"Select Patient"}),i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(Ai,{className:"search-icon",size:20}),i.jsx("input",{type:"text",placeholder:"Search by Name, Token, or Phone...",value:T,onChange:M,className:"custom-text-input",autoFocus:!0})]}),q&&i.jsx("div",{className:"loading-text",style:{marginTop:"1rem"},children:"detail..."}),L&&i.jsx("div",{className:"error-text",children:L}),P.length>0&&i.jsx("div",{className:"search-results-dropdown",style:{position:"relative",boxShadow:"none",borderTop:"none",maxHeight:"40vh"},children:P.map(pe=>i.jsxs("div",{onClick:()=>te(pe),className:"search-result-item",children:[i.jsxs("div",{children:[pe.token&&i.jsxs("span",{className:"token-badge",children:["#",pe.token]}),i.jsx("span",{style:{fontWeight:500},children:pe.name})]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"var(--text-secondary)"},children:[pe.age?`${pe.age}y`:"",pe.gender?` / ${pe.gender}`:"",pe.phone?` / ${pe.phone}`:""]})]},pe.id))}),T.length>=2&&!q&&P.length===0&&!L&&i.jsxs("div",{style:{marginTop:"1.5rem"},children:[i.jsxs("p",{className:"no-data",children:['No patients found matching "',T,'".']}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px",marginTop:"10px"},children:[ne&&i.jsxs("button",{type:"button",onClick:()=>ge("phone"),className:"btn-primary",children:["Create Patient with Phone ",T]}),X&&i.jsxs("button",{type:"button",onClick:()=>ge("name"),className:"btn-primary",children:['Create Patient with Name "',T,'"']})]})]}),i.jsx("div",{className:"or-divider",children:"OR"}),i.jsxs("button",{onClick:_e,className:"btn-secondary",style:{width:"100%"},children:[i.jsx(hl,{size:18,style:{marginRight:"8px",verticalAlign:"text-bottom"}}),"Register New Patient manually"]})]}),t==="create_patient"&&i.jsxs("div",{className:"content-panel",children:[i.jsxs("div",{className:"section-title",style:{justifyContent:"space-between"},children:[i.jsx("span",{children:"Register New Patient"}),i.jsx("button",{onClick:se,className:"action-link-btn",children:"Back to Search"})]}),z&&i.jsx("div",{className:"error-text",children:z}),i.jsxs("form",{onSubmit:oe,children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[i.jsx("label",{htmlFor:"lab-patient-name",children:"Name *"}),i.jsx("input",{type:"text",name:"name",id:"lab-patient-name",required:!0,value:a.name,onChange:ee,className:"form-input",placeholder:"Patient Full Name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lab-patient-age",children:"Age"}),i.jsx("input",{type:"number",name:"age",id:"lab-patient-age",value:a.age??"",onChange:ee,className:"form-input",placeholder:"Age"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"lab-patient-gender",children:"Gender"}),i.jsxs("select",{name:"gender",id:"lab-patient-gender",value:a.gender??"",onChange:ee,className:"form-select",children:[i.jsx("option",{value:"",children:"Select..."})," ",i.jsx("option",{value:"M",children:"Male"})," ",i.jsx("option",{value:"F",children:"Female"})," ",i.jsx("option",{value:"O",children:"Other"})]})]}),i.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[i.jsx("label",{htmlFor:"lab-patient-phone",children:"Phone"}),i.jsx("input",{type:"tel",name:"phone",id:"lab-patient-phone",value:a.phone||"",onChange:ee,className:"form-input",placeholder:"Phone Number"})]}),i.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[i.jsx("label",{htmlFor:"lab-patient-address",children:"Address"}),i.jsx("textarea",{name:"address",id:"lab-patient-address",rows:2,value:a.address||"",onChange:ee,className:"form-textarea",placeholder:"Address (Optional)"})]})]}),i.jsxs("div",{style:{marginTop:"2rem",display:"flex",justifyContent:"flex-end",gap:"1rem"},children:[i.jsx("button",{type:"button",onClick:se,className:"btn-secondary",children:" Cancel "}),i.jsx("button",{type:"submit",className:"btn-primary",children:" Create & Proceed "})]})]})]})]}),t==="create_order"&&l&&i.jsxs("div",{className:"lab-order-grid",children:[i.jsx("div",{className:"left-column",children:i.jsxs("div",{className:"content-panel",children:[i.jsx("h2",{className:"section-title",children:"Add Lab Tests"}),i.jsxs("div",{className:"search-input-wrapper",style:{marginBottom:"1.5rem"},children:[i.jsx(Ai,{className:"search-icon",size:20}),i.jsx("input",{type:"text",placeholder:"Search available lab tests...",value:b,onChange:pe=>v(pe.target.value),className:"custom-text-input",disabled:Y,autoFocus:!0}),Y&&i.jsx("span",{style:{position:"absolute",right:"15px",fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Loading..."}),b&&S.length>0&&i.jsx("div",{className:"search-results-dropdown",children:S.map(pe=>i.jsxs("div",{onClick:()=>ue(pe),className:"search-result-item",children:[i.jsx("span",{children:pe.name}),i.jsxs("span",{style:{fontWeight:600,color:"var(--primary-color)"},children:["",parseFloat(pe.price).toFixed(2)]})]},pe.id))}),b&&S.length===0&&!Y&&i.jsx("div",{className:"search-results-dropdown",style:{padding:"1rem",color:"var(--text-secondary)",textAlign:"center"},children:"No tests found."})]}),R&&i.jsxs("div",{className:"error-text",style:{display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx(ui,{size:18})," ",R]}),i.jsx("div",{className:"order-table-container",children:i.jsxs("table",{className:"order-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Test Name"}),i.jsx("th",{style:{width:"100px",textAlign:"right"},children:"Price"}),i.jsx("th",{style:{width:"60px",textAlign:"center"},children:"Action"})]})}),i.jsx("tbody",{children:f.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"no-data",children:"No tests added yet. Search above to add."})}):f.map(pe=>i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("span",{style:{fontWeight:500},children:pe.name})}),i.jsxs("td",{style:{textAlign:"right",fontWeight:600},children:["",parseFloat(pe.price).toFixed(2)]}),i.jsx("td",{style:{textAlign:"center"},children:i.jsx("button",{type:"button",onClick:()=>Ee(pe.id),className:"delete-btn",title:"Remove",children:i.jsx(Hi,{size:16})})})]},pe.id))})]})})]})}),i.jsxs("div",{className:"right-column",children:[i.jsxs("div",{className:"patient-card",children:[i.jsx("div",{className:"patient-avatar",children:i.jsx(fl,{size:32})}),i.jsx("h3",{className:"patient-name",children:l.name}),i.jsxs("div",{className:"patient-info-text",children:[l.age?`${l.age} yrs`:"",l.gender?`  ${l.gender}`:""]}),l.phone&&i.jsx("div",{className:"patient-info-text",style:{marginTop:"4px"},children:l.phone}),i.jsx("button",{onClick:se,className:"change-patient-btn",children:"Change Patient"})]}),i.jsxs("div",{className:"order-summary-container",children:[i.jsx("h3",{className:"section-title",style:{marginBottom:"1rem"},children:"Order Summary"}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Tests"}),i.jsx("span",{children:f.length})]}),i.jsxs("div",{className:"summary-total",children:[i.jsx("span",{className:"total-label",children:"Total Amount"}),i.jsxs("span",{className:"total-value",children:["",fe()]})]}),i.jsx("button",{onClick:Ie,disabled:f.length===0,className:"create-order-btn",children:"Confirm Order"}),i.jsx("button",{type:"button",onClick:()=>n(-1),className:"btn-secondary",style:{width:"100%",marginTop:"1rem",border:"none",color:"var(--text-secondary)"},children:"Cancel"})]})]})]})]})},zH=({currentUser:e})=>{const[n,t]=w.useState("newtons-ai"),[r,a]=w.useState(""),[o,l]=w.useState([]),[h,d]=w.useState(!0),[u,f]=w.useState([]),[g,b]=w.useState(!1),[v,S]=w.useState(null),[k,T]=w.useState(null),E=Ot(),P=async()=>{d(!0),T(null);let B=[];try{const R=await de("/api/queue");if(!R.ok){const Z=await R.json();throw new Error(Z.message||"Failed to fetch queue")}B=await R.json(),console.log("Fetched Initial Queue Data:",JSON.stringify(B,null,2));const U=B.map(async Z=>{if(!Z.patient_id)return console.warn(`Queue entry ${Z.id} has no patient_id.`),Z;try{const ne=await de(`/api/patients/${Z.patient_id}`);if(!ne.ok)return console.error(`Failed to fetch patient details for ${Z.patient_id}: ${ne.status}`),Z;const ae=await ne.json();return{...Z,Patient:{...Z.Patient??{},...ae}}}catch(ne){return console.error(`Error fetching patient details for ${Z.patient_id}:`,ne),Z}}),Y=await Promise.all(U);console.log("Enriched Queue Data (Before Sort):",JSON.stringify(Y,null,2)),Y.sort((Z,ne)=>{var he,D;const ae=((he=Z.Patient)==null?void 0:he.subscription_status)==="active",X=((D=ne.Patient)==null?void 0:D.subscription_status)==="active";if(ae&&!X)return-1;if(!ae&&X)return 1;const W=Z.created_at?new Date(Z.created_at).getTime():0,H=ne.created_at?new Date(ne.created_at).getTime():0;return W-H}),console.log("Sorted Queue Data:",JSON.stringify(Y,null,2)),l(Y)}catch(R){console.error("Error in fetchQueue process:",R),T(`Failed to load queue: ${R.message}`),l(B)}finally{d(!1)}},I=async()=>{b(!0),T(null);try{const B=await de("/api/staff?role=doctor");if(!B.ok){const U=await B.json();throw new Error(U.message||"Failed to fetch doctors")}const R=await B.json();f(R.filter(U=>U.active))}catch(B){console.error("Error fetching doctors:",B),T(`Failed to fetch doctors: ${B.message}`)}finally{b(!1)}};w.useEffect(()=>{n==="queue"&&(P(),I()),S(null)},[n]);const q=w.useCallback(async(B,R)=>{if(console.log(`Attempting to assign doctor ${R} to queue ${B}`),T(null),S(null),!R){console.log("No doctor ID provided, skipping assignment.");return}const U=o.find(ne=>ne.id===B);if(!U){console.error(`Queue entry ${B} not found in local state.`),T("Queue entry not found.");return}if(U.doctor_id===R){console.log(`Queue ${B} already assigned to doctor ${R}. Skipping.`);return}const Y=async ne=>{if(!ne||!ne.id||!ne.name){T("Cannot proceed: Patient ID or Name is missing."),console.error("assignAndNavigate called with invalid patientInfo",ne);return}const ae=async()=>{try{const X={status:"waiting",doctorId:R},W=await de(`/api/queue/${B}/status`,{method:"PATCH",body:JSON.stringify(X)}),H=await W.json();if(!W.ok)throw new Error(H.message||`HTTP error! status: ${W.status}`);const he=u.find(D=>D.id===R);return console.log(`Successfully assigned doctor ${he==null?void 0:he.name} to queue ${B}.`),l(D=>D.map(te=>te.id===B?{...te,doctor_id:R,status:H.status||te.status,User:he?{name:he.name}:null,Patient:ne}:te)),!0}catch(X){return console.error(`Error assigning doctor for queue ${B}:`,X),T(`Failed to assign doctor: ${X.message}`),!1}};ne.subscription_status==="active"?(console.log(`Patient ${ne.name} (ID: ${ne.id}) has active subscription. Assigning doctor directly.`),await ae()):(console.log(`Patient ${ne.name} (ID: ${ne.id}) does not have active subscription (Status: ${ne.subscription_status}). Navigating to billing first.`),console.log(`Navigating to billing for patient ${ne.name} (ID: ${ne.id}), queue ID: ${B}, doctor ID: ${R}`),E("/billing",{state:{patientId:ne.id,queueId:B,patientName:ne.name,doctorId:R,billType:"consultation",finalizeQueueAssignment:!0}}))},Z=U.Patient;if(Z&&Z.id&&Z.name)console.log("Patient details found in state. Proceeding with assignment."),await Y(Z);else{console.warn(`Patient details missing for queue entry ${B}. Fetching patient ${U.patient_id}...`);try{const ne=await de(`/api/patients/${U.patient_id}`);if(!ne.ok){const X=await ne.json().catch(()=>({}));throw new Error(X.message||`Failed to fetch patient details (status ${ne.status})`)}const ae=await ne.json();console.log("Successfully fetched patient details:",ae),await Y(ae)}catch(ne){console.error(`Failed to fetch patient details for patient ID ${U.patient_id}:`,ne),T(`Failed to fetch required patient details: ${ne.message}`)}}},[u,o,E]),$=async(B,R)=>{T(null);const U=R==="consulting"?"start consultation":"complete visit";try{const Y=o.find(X=>X.id===B);if(!Y&&R==="consulting")throw new Error("Queue entry not found to start consultation.");let Z={status:R};if(R==="consulting"){if(!(Y!=null&&Y.doctor_id))throw new Error("Cannot start consultation without an assigned doctor.");Z.doctorId=Y.doctor_id}const ne=await de(`/api/queue/${B}/status`,{method:"PATCH",body:JSON.stringify(Z)}),ae=await ne.json();if(!ne.ok)throw new Error(ae.message||`HTTP error! status: ${ne.status}`);l(X=>X.map(W=>W.id===B?{...W,status:R}:W))}catch(Y){console.error(`Error trying to ${U}:`,Y),T(`Failed to ${U}: ${Y.message}`)}},L=[{id:"queue",label:"Queue",icon:i.jsx(Uf,{size:20})},{id:"newtons-ai",label:"Newtons AI",icon:i.jsx(Ai,{size:20})},{id:"manage-admission",label:"Manage Admission",icon:i.jsx(qP,{size:20})},{id:"all-patients",label:"All Patients",icon:i.jsx(BI,{size:20})},{id:"lab",label:"Lab Tests",icon:i.jsx(HC,{size:20})},{id:"custom-bill",label:"Custom Bill",icon:i.jsx(nc,{size:20})}],F=B=>{try{return new Date(B).toLocaleTimeString("en-IN",{hour:"numeric",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},z=o.filter(B=>{var R,U;return(U=(R=B.Patient)==null?void 0:R.name)==null?void 0:U.toLowerCase().includes(r.toLowerCase())});return i.jsx("div",{className:"reception-dashboard-container",children:i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[k&&i.jsxs("div",{className:"error-message-reception",role:"alert",children:[" ",i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:k})]}),i.jsxs("div",{className:"reception-tab-nav",children:[" ",L.map(B=>i.jsxs("button",{className:`reception-tab-button ${n===B.id?"active":""}`,onClick:()=>t(B.id),children:[i.jsx("span",{children:B.icon}),B.label]},B.id))]}),n==="queue"&&i.jsxs("div",{className:"space-y-6",children:[" ",i.jsxs("div",{className:"queue-header",children:[" ",i.jsxs("div",{className:"queue-actions",children:[" ",i.jsxs("div",{className:"search-bar-container",children:[" ",i.jsx("input",{type:"text",placeholder:"Search patients in queue...",className:"search-input",value:r,onChange:B=>a(B.target.value)}),i.jsx(Ai,{className:"search-icon",size:18})]})]}),i.jsxs("div",{className:"summary-cards-grid",children:[" ",i.jsxs("div",{className:"summary-card card-waiting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Waiting"})," ",i.jsx("div",{className:"summary-card-value",children:o.filter(B=>B.status==="waiting").length})," "]}),i.jsxs("div",{className:"summary-card card-consulting",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Consulting"})," ",i.jsx("div",{className:"summary-card-value",children:o.filter(B=>B.status==="consulting").length})," "]}),i.jsxs("div",{className:"summary-card card-completed",children:[" ",i.jsx("div",{className:"summary-card-title",children:"Completed"})," ",i.jsx("div",{className:"summary-card-value",children:o.filter(B=>B.status==="seen").length})," "]})]})]}),h?i.jsxs("div",{className:"loading-container",children:[" ",i.jsx("div",{className:"breathing-ball"})," ",i.jsx("span",{children:"Loading queue..."})]}):z.length===0?i.jsx("div",{className:"empty-queue-message",children:r?"No patients found matching your search.":"Queue is empty."}):i.jsxs("div",{className:"queue-table-wrapper",children:[" ",i.jsxs("table",{className:"queue-table",children:[" ",i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Queue"}),i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Phone Number"}),i.jsx("th",{children:"Complaint"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{className:"hidden md:table-cell",children:"Time Added"})," ",i.jsx("th",{className:"text-center",children:"Action / Doctor"})," "]})}),i.jsx("tbody",{children:z.map(B=>{var R,U,Y,Z,ne,ae,X,W,H,he,D;return i.jsxs("tr",{onClick:()=>E(`/dashboard/edit-complaint/${B.id}`),className:"queue-row-clickable",children:[i.jsxs("td",{children:[" ",i.jsxs("span",{className:"queue-token",children:["#",B.token_no]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-name",children:((R=B.Patient)==null?void 0:R.name)||"N/A"})," ",i.jsxs("div",{className:"patient-details",children:[(U=B.Patient)!=null&&U.age?`${B.Patient.age} yrs, `:"",((Y=B.Patient)==null?void 0:Y.gender)||""]})," "]}),i.jsxs("td",{children:[" ",i.jsx("div",{className:"patient-phone",children:((Z=B.Patient)==null?void 0:Z.phone)||"N/A"})," "]}),i.jsx("td",{className:"complaint-text",children:B.complaint||"-"}),i.jsxs("td",{children:[i.jsx("span",{className:`subscription-status-badge ${((ne=B.Patient)==null?void 0:ne.subscription_status)==="active"?"status-active":((ae=B.Patient)==null?void 0:ae.subscription_status)==="cancelled"||((X=B.Patient)==null?void 0:X.subscription_status)==="expired"?"status-inactive":"status-none"}`,children:((W=B.Patient)==null?void 0:W.subscription_status)??"None"}),B.Patient&&B.Patient.id&&B.Patient.subscription_status!=="active"&&i.jsx("button",{onClick:te=>{te.stopPropagation(),B.Patient&&E(`/start-subscription/${B.Patient.id}`)},className:"action-button btn-start-sub-queue mt-2",children:"Start Sub"})]}),i.jsx("td",{className:"hidden md:table-cell time-added",children:F(B.created_at)}),i.jsx("td",{className:"action-doctor-cell",children:v===B.id?i.jsx("div",{className:"relative inline-block text-left w-full",onClick:te=>te.stopPropagation(),children:i.jsxs("select",{value:"",onChange:te=>q(B.id,te.target.value),onBlur:()=>S(null),className:"doctor-select-dropdown",autoFocus:!0,children:[i.jsx("option",{value:"",disabled:!0,children:"Select Doctor..."}),g?i.jsx("option",{disabled:!0,children:"Loading..."}):u.length>0?u.map(te=>i.jsx("option",{value:te.id,children:te.name},te.id)):i.jsx("option",{disabled:!0,children:"No doctors available"})]})}):i.jsxs("div",{className:"action-doctor-content",onClick:te=>te.stopPropagation(),children:[" ",B.status==="waiting"&&i.jsx(i.Fragment,{children:(H=B.User)!=null&&H.name?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"doctor-name-display",children:B.User.name}),i.jsx("button",{onClick:()=>$(B.id,"consulting"),className:"action-button btn-start",children:"Start"})]}):g?i.jsx("span",{className:"status-text-italic",children:"Loading..."}):u.length===0?i.jsx("span",{className:"status-text-red",children:"No doctors"}):u.length===1?i.jsxs("button",{onClick:()=>q(B.id,u[0].id),className:"action-button btn-assign",children:["Assign ",u[0].name]}):i.jsx("button",{onClick:()=>S(B.id),className:"action-button btn-assign",children:"Assign"})}),B.status==="consulting"&&i.jsxs(i.Fragment,{children:[((he=B.User)==null?void 0:he.name)&&i.jsx("span",{className:"doctor-name-display",children:B.User.name}),i.jsx("button",{onClick:()=>$(B.id,"seen"),className:"action-button btn-complete",children:"Complete"})]}),B.status==="seen"&&i.jsxs(i.Fragment,{children:[((D=B.User)==null?void 0:D.name)&&i.jsx("span",{className:"doctor-name-display",children:B.User.name}),i.jsx("span",{className:"status-text-italic",children:"Completed"})]}),B.status==="cancelled"&&i.jsx("span",{className:"status-text-red",children:"Cancelled"})]})})]},B.id)})})]})]})]}),n==="lab"&&i.jsxs("div",{className:"lab-tab-content",children:[" ",i.jsx(NE,{currentUser:e}),i.jsxs("button",{onClick:()=>E("/lab/search-report"),className:"lab-action-button btn-search-lab-reports",children:[i.jsx(Ai,{size:16}),"Search Lab Reports"]})]}),n==="newtons-ai"&&i.jsx("div",{className:"newtons-ai-tab-content",children:i.jsx(Pf,{})}),n==="manage-admission"&&i.jsx("div",{className:"manage-admission-tab-content",children:i.jsx(vE,{})}),n==="all-patients"&&i.jsx("div",{className:"all-patients-tab-content",children:i.jsx(M1,{})}),n==="custom-bill"&&i.jsx("div",{className:"custom-bill-tab-content",children:i.jsx(wE,{})})]})})},SE=6048e5,BH=864e5,jE=6e4,_E=36e5,d_=Symbol.for("constructDateFrom");function yo(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&d_ in e?e[d_](n):e instanceof Date?new e.constructor(n):new Date(n)}function Gr(e,n){return yo(n||e,e)}function R1(e,n,t){const r=Gr(e,t==null?void 0:t.in);if(isNaN(n))return yo(e,NaN);if(!n)return r;const a=r.getDate(),o=yo(e,r.getTime());o.setMonth(r.getMonth()+n+1,0);const l=o.getDate();return a>=l?o:(r.setFullYear(o.getFullYear(),o.getMonth(),a),r)}let UH={};function Qb(){return UH}function pg(e,n){var h,d,u,f;const t=Qb(),r=(n==null?void 0:n.weekStartsOn)??((d=(h=n==null?void 0:n.locale)==null?void 0:h.options)==null?void 0:d.weekStartsOn)??t.weekStartsOn??((f=(u=t.locale)==null?void 0:u.options)==null?void 0:f.weekStartsOn)??0,a=Gr(e,n==null?void 0:n.in),o=a.getDay(),l=(o<r?7:0)+o-r;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function wb(e,n){return pg(e,{...n,weekStartsOn:1})}function CE(e,n){const t=Gr(e,n==null?void 0:n.in),r=t.getFullYear(),a=yo(t,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const o=wb(a),l=yo(t,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const h=wb(l);return t.getTime()>=o.getTime()?r+1:t.getTime()>=h.getTime()?r:r-1}function h_(e){const n=Gr(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function qH(e,...n){const t=yo.bind(null,n.find(r=>typeof r=="object"));return n.map(t)}function f_(e,n){const t=Gr(e,n==null?void 0:n.in);return t.setHours(0,0,0,0),t}function VH(e,n,t){const[r,a]=qH(t==null?void 0:t.in,e,n),o=f_(r),l=f_(a),h=+o-h_(o),d=+l-h_(l);return Math.round((h-d)/BH)}function HH(e,n){const t=CE(e,n),r=yo(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),wb(r)}function GH(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function mg(e){return!(!GH(e)&&typeof e!="number"||isNaN(+Gr(e)))}function YH(e,n){const t=Gr(e,n==null?void 0:n.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}const WH={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},QH=(e,n,t)=>{let r;const a=WH[e];return typeof a=="string"?r=a:n===1?r=a.one:r=a.other.replace("{{count}}",n.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function P0(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const JH={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},KH={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},XH={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},ZH={date:P0({formats:JH,defaultWidth:"full"}),time:P0({formats:KH,defaultWidth:"full"}),dateTime:P0({formats:XH,defaultWidth:"full"})},eG={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},tG=(e,n,t,r)=>eG[e];function qm(e){return(n,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,h=t!=null&&t.width?String(t.width):l;a=e.formattingValues[h]||e.formattingValues[l]}else{const l=e.defaultWidth,h=t!=null&&t.width?String(t.width):e.defaultWidth;a=e.values[h]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(n):n;return a[o]}}const nG={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},iG={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},rG={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},aG={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},sG={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},oG={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},lG=(e,n)=>{const t=Number(e),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},cG={ordinalNumber:lG,era:qm({values:nG,defaultWidth:"wide"}),quarter:qm({values:iG,defaultWidth:"wide",argumentCallback:e=>e-1}),month:qm({values:rG,defaultWidth:"wide"}),day:qm({values:aG,defaultWidth:"wide"}),dayPeriod:qm({values:sG,defaultWidth:"wide",formattingValues:oG,defaultFormattingWidth:"wide"})};function Vm(e){return(n,t={})=>{const r=t.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],o=n.match(a);if(!o)return null;const l=o[0],h=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],d=Array.isArray(h)?dG(h,g=>g.test(l)):uG(h,g=>g.test(l));let u;u=e.valueCallback?e.valueCallback(d):d,u=t.valueCallback?t.valueCallback(u):u;const f=n.slice(l.length);return{value:u,rest:f}}}function uG(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function dG(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function hG(e){return(n,t={})=>{const r=n.match(e.matchPattern);if(!r)return null;const a=r[0],o=n.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=t.valueCallback?t.valueCallback(l):l;const h=n.slice(a.length);return{value:l,rest:h}}}const fG=/^(\d+)(th|st|nd|rd)?/i,pG=/\d+/i,mG={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},gG={any:[/^b/i,/^(a|c)/i]},yG={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},xG={any:[/1/i,/2/i,/3/i,/4/i]},bG={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},vG={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},wG={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},NG={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},SG={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},jG={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},_G={ordinalNumber:hG({matchPattern:fG,parsePattern:pG,valueCallback:e=>parseInt(e,10)}),era:Vm({matchPatterns:mG,defaultMatchWidth:"wide",parsePatterns:gG,defaultParseWidth:"any"}),quarter:Vm({matchPatterns:yG,defaultMatchWidth:"wide",parsePatterns:xG,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Vm({matchPatterns:bG,defaultMatchWidth:"wide",parsePatterns:vG,defaultParseWidth:"any"}),day:Vm({matchPatterns:wG,defaultMatchWidth:"wide",parsePatterns:NG,defaultParseWidth:"any"}),dayPeriod:Vm({matchPatterns:SG,defaultMatchWidth:"any",parsePatterns:jG,defaultParseWidth:"any"})},CG={code:"en-US",formatDistance:QH,formatLong:ZH,formatRelative:tG,localize:cG,match:_G,options:{weekStartsOn:0,firstWeekContainsDate:1}};function kG(e,n){const t=Gr(e,n==null?void 0:n.in);return VH(t,YH(t))+1}function EG(e,n){const t=Gr(e,n==null?void 0:n.in),r=+wb(t)-+HH(t);return Math.round(r/SE)+1}function kE(e,n){var f,g,b,v;const t=Gr(e,n==null?void 0:n.in),r=t.getFullYear(),a=Qb(),o=(n==null?void 0:n.firstWeekContainsDate)??((g=(f=n==null?void 0:n.locale)==null?void 0:f.options)==null?void 0:g.firstWeekContainsDate)??a.firstWeekContainsDate??((v=(b=a.locale)==null?void 0:b.options)==null?void 0:v.firstWeekContainsDate)??1,l=yo((n==null?void 0:n.in)||e,0);l.setFullYear(r+1,0,o),l.setHours(0,0,0,0);const h=pg(l,n),d=yo((n==null?void 0:n.in)||e,0);d.setFullYear(r,0,o),d.setHours(0,0,0,0);const u=pg(d,n);return+t>=+h?r+1:+t>=+u?r:r-1}function TG(e,n){var h,d,u,f;const t=Qb(),r=(n==null?void 0:n.firstWeekContainsDate)??((d=(h=n==null?void 0:n.locale)==null?void 0:h.options)==null?void 0:d.firstWeekContainsDate)??t.firstWeekContainsDate??((f=(u=t.locale)==null?void 0:u.options)==null?void 0:f.firstWeekContainsDate)??1,a=kE(e,n),o=yo((n==null?void 0:n.in)||e,0);return o.setFullYear(a,0,r),o.setHours(0,0,0,0),pg(o,n)}function AG(e,n){const t=Gr(e,n==null?void 0:n.in),r=+pg(t,n)-+TG(t,n);return Math.round(r/SE)+1}function ti(e,n){const t=e<0?"-":"",r=Math.abs(e).toString().padStart(n,"0");return t+r}const cu={y(e,n){const t=e.getFullYear(),r=t>0?t:1-t;return ti(n==="yy"?r%100:r,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):ti(t+1,2)},d(e,n){return ti(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return ti(e.getHours()%12||12,n.length)},H(e,n){return ti(e.getHours(),n.length)},m(e,n){return ti(e.getMinutes(),n.length)},s(e,n){return ti(e.getSeconds(),n.length)},S(e,n){const t=n.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,t-3));return ti(a,n.length)}},_f={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},p_={G:function(e,n,t){const r=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return t.ordinalNumber(a,{unit:"year"})}return cu.y(e,n)},Y:function(e,n,t,r){const a=kE(e,r),o=a>0?a:1-a;if(n==="YY"){const l=o%100;return ti(l,2)}return n==="Yo"?t.ordinalNumber(o,{unit:"year"}):ti(o,n.length)},R:function(e,n){const t=CE(e);return ti(t,n.length)},u:function(e,n){const t=e.getFullYear();return ti(t,n.length)},Q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(r);case"QQ":return ti(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,n,t){const r=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(r);case"qq":return ti(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,n,t){const r=e.getMonth();switch(n){case"M":case"MM":return cu.M(e,n);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(e,n,t){const r=e.getMonth();switch(n){case"L":return String(r+1);case"LL":return ti(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(e,n,t,r){const a=AG(e,r);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):ti(a,n.length)},I:function(e,n,t){const r=EG(e);return n==="Io"?t.ordinalNumber(r,{unit:"week"}):ti(r,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):cu.d(e,n)},D:function(e,n,t){const r=kG(e);return n==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):ti(r,n.length)},E:function(e,n,t){const r=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"e":return String(o);case"ee":return ti(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(n){case"c":return String(o);case"cc":return ti(o,n.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const r=e.getDay(),a=r===0?7:r;switch(n){case"i":return String(a);case"ii":return ti(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const r=e.getHours();let a;switch(r===12?a=_f.noon:r===0?a=_f.midnight:a=r/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const r=e.getHours();let a;switch(r>=17?a=_f.evening:r>=12?a=_f.afternoon:r>=4?a=_f.morning:a=_f.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let r=e.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return cu.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):cu.H(e,n)},K:function(e,n,t){const r=e.getHours()%12;return n==="Ko"?t.ordinalNumber(r,{unit:"hour"}):ti(r,n.length)},k:function(e,n,t){let r=e.getHours();return r===0&&(r=24),n==="ko"?t.ordinalNumber(r,{unit:"hour"}):ti(r,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):cu.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):cu.s(e,n)},S:function(e,n){return cu.S(e,n)},X:function(e,n,t){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(n){case"X":return g_(r);case"XXXX":case"XX":return Md(r);case"XXXXX":case"XXX":default:return Md(r,":")}},x:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"x":return g_(r);case"xxxx":case"xx":return Md(r);case"xxxxx":case"xxx":default:return Md(r,":")}},O:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+m_(r,":");case"OOOO":default:return"GMT"+Md(r,":")}},z:function(e,n,t){const r=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+m_(r,":");case"zzzz":default:return"GMT"+Md(r,":")}},t:function(e,n,t){const r=Math.trunc(+e/1e3);return ti(r,n.length)},T:function(e,n,t){return ti(+e,n.length)}};function m_(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),o=r%60;return o===0?t+String(a):t+String(a)+n+ti(o,2)}function g_(e,n){return e%60===0?(e>0?"-":"+")+ti(Math.abs(e)/60,2):Md(e,n)}function Md(e,n=""){const t=e>0?"-":"+",r=Math.abs(e),a=ti(Math.trunc(r/60),2),o=ti(r%60,2);return t+a+n+o}const y_=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},EE=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},DG=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],r=t[1],a=t[2];if(!a)return y_(e,n);let o;switch(r){case"P":o=n.dateTime({width:"short"});break;case"PP":o=n.dateTime({width:"medium"});break;case"PPP":o=n.dateTime({width:"long"});break;case"PPPP":default:o=n.dateTime({width:"full"});break}return o.replace("{{date}}",y_(r,n)).replace("{{time}}",EE(a,n))},PG={p:EE,P:DG},IG=/^D+$/,MG=/^Y+$/,RG=["D","DD","YY","YYYY"];function OG(e){return IG.test(e)}function LG(e){return MG.test(e)}function FG(e,n,t){const r=$G(e,n,t);if(console.warn(r),RG.includes(e))throw new RangeError(r)}function $G(e,n,t){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const zG=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,BG=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,UG=/^'([^]*?)'?$/,qG=/''/g,VG=/[a-zA-Z]/;function _r(e,n,t){var f,g,b,v;const r=Qb(),a=r.locale??CG,o=r.firstWeekContainsDate??((g=(f=r.locale)==null?void 0:f.options)==null?void 0:g.firstWeekContainsDate)??1,l=r.weekStartsOn??((v=(b=r.locale)==null?void 0:b.options)==null?void 0:v.weekStartsOn)??0,h=Gr(e,t==null?void 0:t.in);if(!mg(h))throw new RangeError("Invalid time value");let d=n.match(BG).map(S=>{const k=S[0];if(k==="p"||k==="P"){const T=PG[k];return T(S,a.formatLong)}return S}).join("").match(zG).map(S=>{if(S==="''")return{isToken:!1,value:"'"};const k=S[0];if(k==="'")return{isToken:!1,value:HG(S)};if(p_[k])return{isToken:!0,value:S};if(k.match(VG))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");return{isToken:!1,value:S}});a.localize.preprocessor&&(d=a.localize.preprocessor(h,d));const u={firstWeekContainsDate:o,weekStartsOn:l,locale:a};return d.map(S=>{if(!S.isToken)return S.value;const k=S.value;(LG(k)||OG(k))&&FG(k,n,String(e));const T=p_[k[0]];return T(h,k,a.localize,u)}).join("")}function HG(e){const n=e.match(UG);return n?n[1].replace(qG,"'"):e}function Fd(e,n){return+Gr(e)<+Gr(n)}function Nb(e,n){const t=()=>yo(n==null?void 0:n.in,NaN),a=QG(e);let o;if(a.date){const u=JG(a.date,2);o=KG(u.restDateString,u.year)}if(!o||isNaN(+o))return t();const l=+o;let h=0,d;if(a.time&&(h=XG(a.time),isNaN(h)))return t();if(a.timezone){if(d=ZG(a.timezone),isNaN(d))return t()}else{const u=new Date(l+h),f=Gr(0,n==null?void 0:n.in);return f.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),f.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),f}return Gr(l+h+d,n==null?void 0:n.in)}const Ox={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},GG=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,YG=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,WG=/^([+-])(\d{2})(?::?(\d{2}))?$/;function QG(e){const n={},t=e.split(Ox.dateTimeDelimiter);let r;if(t.length>2)return n;if(/:/.test(t[0])?r=t[0]:(n.date=t[0],r=t[1],Ox.timeZoneDelimiter.test(n.date)&&(n.date=e.split(Ox.timeZoneDelimiter)[0],r=e.substr(n.date.length,e.length))),r){const a=Ox.timezone.exec(r);a?(n.time=r.replace(a[1],""),n.timezone=a[1]):n.time=r}return n}function JG(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),r=e.match(t);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:o===null?a:o*100,restDateString:e.slice((r[1]||r[2]).length)}}function KG(e,n){if(n===null)return new Date(NaN);const t=e.match(GG);if(!t)return new Date(NaN);const r=!!t[4],a=Hm(t[1]),o=Hm(t[2])-1,l=Hm(t[3]),h=Hm(t[4]),d=Hm(t[5])-1;if(r)return rY(n,h,d)?eY(n,h,d):new Date(NaN);{const u=new Date(0);return!nY(n,o,l)||!iY(n,a)?new Date(NaN):(u.setUTCFullYear(n,o,Math.max(a,l)),u)}}function Hm(e){return e?parseInt(e):1}function XG(e){const n=e.match(YG);if(!n)return NaN;const t=I0(n[1]),r=I0(n[2]),a=I0(n[3]);return aY(t,r,a)?t*_E+r*jE+a*1e3:NaN}function I0(e){return e&&parseFloat(e.replace(",","."))||0}function ZG(e){if(e==="Z")return 0;const n=e.match(WG);if(!n)return 0;const t=n[1]==="+"?-1:1,r=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return sY(r,a)?t*(r*_E+a*jE):NaN}function eY(e,n,t){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,o=(n-1)*7+t+1-a;return r.setUTCDate(r.getUTCDate()+o),r}const tY=[31,null,31,30,31,30,31,31,30,31,30,31];function TE(e){return e%400===0||e%4===0&&e%100!==0}function nY(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(tY[n]||(TE(e)?29:28))}function iY(e,n){return n>=1&&n<=(TE(e)?366:365)}function rY(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function aY(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function sY(e,n){return n>=0&&n<=59}const Jb=({showHeader:e=!0})=>{const[n,t]=w.useState([]),[r,a]=w.useState(!1),[o,l]=w.useState(null),[h,d]=w.useState(!1),[u,f]=w.useState(null),g=w.useRef(null),[b,v]=w.useState(!1),[S,k]=w.useState(null),[T,E]=w.useState(!1),[P,I]=w.useState(!1),[q,$]=w.useState(null),[L,F]=w.useState({name:"",description:"",price:"",default_parameters:[]}),[z,B]=w.useState(1),[R]=w.useState(15),U=w.useCallback(async()=>{a(!0),l(null),f(null),k(null);try{const se=await de("/api/lab-tests");if(!se.ok)throw new Error(`HTTP error! status: ${se.status}`);const ee=await se.json();t(ee),B(1)}catch(se){console.error("Error fetching lab tests:",se),l(se.message||"Failed to fetch lab tests.")}finally{a(!1)}},[]);w.useEffect(()=>{U()},[U]);const Y=se=>{const{name:ee,value:oe}=se.target;F(ue=>({...ue,[ee]:oe}))},Z=(se,ee,oe)=>{const ue=[...L.default_parameters],Ee=ue[se];if(ee==="type")switch(Ee.type=oe,oe){case"number":Ee.defaultValue=0,Ee.lower_limit=null,Ee.upper_limit=null,Ee.unit="";break;case"boolean":Ee.defaultValue=!1,Ee.lower_limit=void 0,Ee.upper_limit=void 0,Ee.unit=void 0;break;case"string":default:Ee.defaultValue="",Ee.lower_limit=void 0,Ee.upper_limit=void 0,Ee.unit=void 0;break}else ee==="defaultValue"?Ee.type==="number"?Ee.defaultValue=parseFloat(oe)||0:(Ee.type,Ee.defaultValue=oe):ee==="lower_limit"||ee==="upper_limit"?Ee[ee]=oe===""?null:parseFloat(oe):Ee[ee]=oe;F(Ie=>({...Ie,default_parameters:ue}))},ne=()=>{F(se=>({...se,default_parameters:[...se.default_parameters,{name:"",type:"string",defaultValue:"",unit:"",lower_limit:null,upper_limit:null}]}))},ae=se=>{F(ee=>({...ee,default_parameters:ee.default_parameters.filter((oe,ue)=>ue!==se)}))},X=async se=>{se.preventDefault(),a(!0),l(null);const ee=q!==null,oe=ee?`/api/lab-tests/${q}`:"/api/lab-tests",ue=ee?"PUT":"POST";try{const Ee=await de(oe,{method:ue,headers:{"Content-Type":"application/json"},body:JSON.stringify({name:L.name,description:L.description,price:parseFloat(L.price),default_parameters:L.default_parameters})});if(!Ee.ok){const Ie=await Ee.json();throw new Error(Ie.message||`HTTP error! status: ${Ee.status}`)}I(!1),$(null),F({name:"",description:"",price:"",default_parameters:[]}),U()}catch(Ee){console.error(`Error ${ee?"updating":"adding"} lab test:`,Ee),l(Ee.message||`Failed to ${ee?"update":"add"} lab test.`)}finally{a(!1)}},W=()=>{$(null),F({name:"",description:"",price:"",default_parameters:[]}),I(!0)},H=se=>{if(q===se.id)$(null);else{$(se.id);const ee=(se.default_parameters||[]).map(oe=>({...oe,unit:oe.unit||"",lower_limit:oe.lower_limit===void 0?null:oe.lower_limit,upper_limit:oe.upper_limit===void 0?null:oe.upper_limit}));F({name:se.name,description:se.description||"",price:se.price,default_parameters:ee}),I(!1)}},he=async se=>{if(window.confirm("Are you sure you want to delete this lab test?")){a(!0),l(null);try{const ee=await de(`/api/lab-tests/${se}`,{method:"DELETE"});if(!ee.ok){const oe=await ee.json();throw new Error(oe.message||`HTTP error! status: ${ee.status}`)}U()}catch(ee){console.error("Error deleting lab test:",ee),l(ee.message||"Failed to delete lab test.")}finally{a(!1)}}},D=()=>{I(!1),$(null),l(null),F({name:"",description:"",price:"",default_parameters:[]})},te=async se=>{if(!se){f("No file selected.");return}d(!0),f(null),l(null);const ee=new FormData;ee.append("file",se);try{const oe=await de("/api/lab-tests/import",{method:"POST",body:ee});if(!oe.ok){const ue=await oe.json();throw new Error(ue.message||`Import failed: ${oe.statusText}`)}U()}catch(oe){console.error("Error importing lab tests from Excel:",oe),f(oe.message||"Failed to import lab tests from Excel.")}finally{d(!1)}},ve=async se=>{if(se.target.files&&se.target.files[0]){const ee=se.target.files[0];await te(ee),se.target&&(se.target.value="")}},M=async()=>{if(window.confirm("Are you sure you want to import default biochemistry and pathology tests? This will add new tests and may duplicate existing ones if names match.")){v(!0),k(null),l(null);try{const se=await de("/api/lab-tests/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"}});if(!se.ok){const ee=await se.json();throw new Error(ee.message||`Default import failed: ${se.statusText}`)}U()}catch(se){console.error("Error importing default lab tests:",se),k(se.message||"Failed to import default lab tests.")}finally{v(!1)}}},ge=async()=>{if(window.confirm("Are you sure you want to delete ALL lab tests? This action cannot be undone.")){E(!0),l(null),f(null),k(null);try{const se=await de("/api/lab-tests/all",{method:"DELETE"});if(!se.ok){const ee=await se.json();throw new Error(ee.message||`Delete all failed: ${se.statusText}`)}U()}catch(se){console.error("Error deleting all lab tests:",se),l(se.message||"Failed to delete all lab tests.")}finally{E(!1)}}},_e=r||h||b||T;return i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{style:{padding:"12px 16px"},children:[e&&i.jsx("h2",{className:"lab-inventory-header",children:"Available Lab Tests"}),i.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px"},children:[i.jsx("button",{onClick:W,className:"lab-inventory-button",disabled:_e,children:"Add New Test"}),i.jsx("button",{onClick:()=>{var se;return(se=g.current)==null?void 0:se.click()},className:"lab-inventory-button lab-inventory-button-secondary",disabled:_e,children:h?"Importing...":"Import from Excel"}),i.jsx("input",{type:"file",ref:g,onChange:ve,accept:".xlsx, .xls",style:{display:"none"},disabled:h}),i.jsx("button",{onClick:M,className:"lab-inventory-button lab-inventory-button-secondary",disabled:_e,children:b?"Importing Defaults...":"Import Default Tests"}),i.jsx("button",{onClick:ge,className:"lab-inventory-button lab-inventory-button-danger",disabled:_e,style:{backgroundColor:"#dc3545",borderColor:"#dc3545",color:"white"},children:T?"Deleting All...":"Delete All Tests"})]})]}),o&&i.jsx("div",{className:"error-text mb-4",children:o}),u&&i.jsxs("div",{className:"error-text mb-4",children:["Import Excel Error: ",u]}),S&&i.jsxs("div",{className:"error-text mb-4",children:["Import Default Error: ",S]}),P&&i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"20px",marginBottom:"20px"},children:[" ",i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"1px solid #eee",marginBottom:"15px"},children:"Add New Lab Test"}),i.jsxs("form",{onSubmit:X,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:L.name,onChange:Y,className:"lab-inventory-input",required:!0,disabled:_e})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:L.description,onChange:Y,rows:3,className:"lab-inventory-input",disabled:_e})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:L.price,onChange:Y,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:_e})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginTop:"20px",marginBottom:"10px"},children:"Default Parameters"}),L.default_parameters.map((se,ee)=>{var oe,ue;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:se.name,onChange:Ee=>Z(ee,"name",Ee.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:se.type,onChange:Ee=>Z(ee,"type",Ee.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),se.type==="boolean"?i.jsxs("select",{value:se.defaultValue.toString(),onChange:Ee=>Z(ee,"defaultValue",Ee.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:se.type==="number"?"number":"text",placeholder:"Default Value",value:se.defaultValue.toString(),onChange:Ee=>Z(ee,"defaultValue",Ee.target.value),className:"lab-inventory-input"}),se.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:se.lower_limit===null?"":((oe=se.lower_limit)==null?void 0:oe.toString())??"",onChange:Ee=>Z(ee,"lower_limit",Ee.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:se.upper_limit===null?"":((ue=se.upper_limit)==null?void 0:ue.toString())??"",onChange:Ee=>Z(ee,"upper_limit",Ee.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:se.unit||"",onChange:Ee=>Z(ee,"unit",Ee.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>ae(ee),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},ee)}),i.jsx("button",{type:"button",onClick:ne,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:D,className:"lab-inventory-button lab-inventory-button-secondary",disabled:_e,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:_e,children:r?"Saving...":"Add Test"})]})]})]}),_e&&!P&&i.jsxs("p",{className:"loading-text",children:[" ",h?"Importing Excel data...":b?"Importing default data...":"Loading tests..."]}),!_e&&n.length===0&&!o&&!u&&!S&&i.jsx("p",{className:"no-data-message",children:"No lab tests found. Add one or import from Excel to get started."}),!_e&&n.length>0&&i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{className:"hidden md:table-cell",children:"Description"})," ",i.jsx("th",{children:"Price"}),i.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),i.jsx("tbody",{children:(()=>{const se=z*R,ee=se-R;return n.slice(ee,se).map(ue=>{const Ee=q===ue.id,Ie=ue.price&&typeof ue.price=="string"?parseFloat(ue.price):NaN,fe=isNaN(Ie)?"0.00":Ie.toFixed(2);return i.jsxs(Pn.Fragment,{children:[i.jsxs("tr",{onClick:()=>H(ue),style:{cursor:"pointer"},children:[i.jsx("td",{children:ue.name}),i.jsx("td",{className:"hidden md:table-cell",style:{whiteSpace:"pre-wrap"},children:ue.description||"-"}),i.jsxs("td",{children:["",fe]}),i.jsx("td",{style:{textAlign:"right"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[i.jsx("button",{onClick:pe=>{pe.stopPropagation(),H(ue)},className:"lab-inventory-link",disabled:_e,style:{background:"none",border:"none",padding:"0",cursor:"pointer"},children:"Edit"}),i.jsx("button",{onClick:pe=>{pe.stopPropagation(),he(ue.id)},className:"lab-inventory-link",disabled:_e,style:{background:"none",border:"none",padding:"0",cursor:"pointer",color:"#dc3545"},children:"Delete"})]})})]}),Ee&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:i.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"10px",marginBottom:"10px",border:"1px solid #ddd",padding:"15px"},children:[i.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em"},children:"Edit Lab Test"}),i.jsxs("form",{onSubmit:X,children:[i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Test Name ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:L.name,onChange:Y,className:"lab-inventory-input",required:!0,disabled:_e})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",value:L.description,onChange:Y,rows:3,className:"lab-inventory-input",disabled:_e})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price ",i.jsx("span",{style:{color:"red"},children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",value:L.price,onChange:Y,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:_e})]}),i.jsxs("div",{className:"lab-inventory-form-group",children:[i.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",marginTop:"15px"},children:"Default Parameters"}),L.default_parameters.map((pe,Re)=>{var Ye,ut;return i.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[i.jsx("input",{type:"text",placeholder:"Parameter Name",value:pe.name,onChange:Ge=>Z(Re,"name",Ge.target.value),className:"lab-inventory-input"}),i.jsxs("select",{value:pe.type,onChange:Ge=>Z(Re,"type",Ge.target.value),className:"lab-inventory-input",children:[i.jsx("option",{value:"string",children:"Text"}),i.jsx("option",{value:"number",children:"Number"}),i.jsx("option",{value:"boolean",children:"Yes/No"})]}),pe.type==="boolean"?i.jsxs("select",{value:pe.defaultValue.toString(),onChange:Ge=>Z(Re,"defaultValue",Ge.target.value==="true"),className:"lab-inventory-input",children:[i.jsx("option",{value:"true",children:"Reactive"}),i.jsx("option",{value:"false",children:"Non-reactive"})]}):i.jsx("input",{type:pe.type==="number"?"number":"text",placeholder:"Default Value",value:pe.defaultValue.toString(),onChange:Ge=>Z(Re,"defaultValue",Ge.target.value),className:"lab-inventory-input"}),pe.type==="number"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"number",placeholder:"Lower Limit",value:pe.lower_limit===null?"":((Ye=pe.lower_limit)==null?void 0:Ye.toString())??"",onChange:Ge=>Z(Re,"lower_limit",Ge.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"number",placeholder:"Upper Limit",value:pe.upper_limit===null?"":((ut=pe.upper_limit)==null?void 0:ut.toString())??"",onChange:Ge=>Z(Re,"upper_limit",Ge.target.value),className:"lab-inventory-input"}),i.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:pe.unit||"",onChange:Ge=>Z(Re,"unit",Ge.target.value),className:"lab-inventory-input"})]}),i.jsx("button",{type:"button",onClick:()=>ae(Re),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},Re)}),i.jsx("button",{type:"button",onClick:ne,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[i.jsx("button",{type:"button",onClick:D,className:"lab-inventory-button lab-inventory-button-secondary",disabled:_e,children:"Cancel"}),i.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:_e,children:r?"Saving...":"Update Test"})]})]})]})})})]},ue.id)})})()})]})]}),n.length>R&&!_e&&i.jsxs("div",{className:"pagination-controls",style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"20px",gap:"15px"},children:[i.jsx("button",{onClick:()=>B(se=>Math.max(se-1,1)),disabled:z===1,className:"pagination-button",style:{padding:"8px 16px",borderRadius:"4px",border:"1px solid #ddd",background:z===1?"#f5f5f5":"white",cursor:z===1?"not-allowed":"pointer"},children:"Previous"}),i.jsxs("span",{className:"pagination-info",style:{fontWeight:500},children:["Page ",z," of ",Math.ceil(n.length/R)]}),i.jsx("button",{onClick:()=>B(se=>Math.min(se+1,Math.ceil(n.length/R))),disabled:z===Math.ceil(n.length/R),className:"pagination-button",style:{padding:"8px 16px",borderRadius:"4px",border:"1px solid #ddd",background:z===Math.ceil(n.length/R)?"#f5f5f5":"white",cursor:z===Math.ceil(n.length/R)?"not-allowed":"pointer"},children:"Next"})]})]})},oY=e=>{let n="";if(!e.report_content)return"No report content available.";n+=`*Report Date:* ${e.report_date?new Date(e.report_date).toLocaleDateString():"N/A"}

`;try{const t=JSON.parse(e.report_content);typeof t=="object"&&t!==null&&e.tests?e.tests.forEach((r,a)=>{n+=`*Test: ${r.name}*
`,t[r.id]?Object.entries(t[r.id]).forEach(([o,l])=>{var f;const h=(f=r.default_parameters)==null?void 0:f.find(g=>g.name===o);let d=String(l),u="";if(h){const g=h.unit?` _${h.unit}_`:"";if(h.type==="boolean"){const b=l===!0||l==="true";d=b?"*Reactive*":"Non-Reactive",b||(u="`Normal: Non-Reactive`")}else if(h.type==="number"){const b=typeof l=="string"?parseFloat(l):typeof l=="number"?l:NaN;if(h.lower_limit!=null||h.upper_limit!=null){let v=[];h.lower_limit!=null&&v.push(`${h.lower_limit}`),h.upper_limit!=null&&v.push(`${h.upper_limit}`),u=`\`Normal: ${v.join(" - ")}\`${g}`,!isNaN(b)&&(h.lower_limit!=null&&b<h.lower_limit||h.upper_limit!=null&&b>h.upper_limit)&&(d=`*${d}*`)}}h.unit&&(d+=g)}n+=`${o}: ${d}
`,u&&((h==null?void 0:h.type)==="boolean"&&(l===!0||l==="true")||(n+=`${u}
`))}):n+=`_No parameters reported for this test._
`,a<e.tests.length-1&&(n+=`
`)}):n+=e.report_content}catch{n+=e.report_content}return n},Gw=e=>{var l;if(!((l=e==null?void 0:e.Patient)!=null&&l.phone)){alert("Cannot share report via WhatsApp: Patient phone number is not available.");return}if(!(e!=null&&e.report_content)){alert("Cannot share report: No report content is available to share.");return}const n=e.Patient.name||"Patient",t=oY(e),r=`Hello ${n},

Your lab report is ready.

${t}`,o=`https://wa.me/${lY(e.Patient.phone)}?text=${encodeURIComponent(r)}`;window.open(o,"_blank")},lY=e=>{let n=e.replace(/\D/g,"");const t=/^(?:\\+?91)?[\\s-]*?(\\d{10})$/,r=n.match(t);return r?n="91"+r[1]:n.startsWith("91")||(n="91"+n),n},cY=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,o]=w.useState(!0),[l,h]=w.useState(null),[d,u]=w.useState("orders"),[f,g]=w.useState(1),[b]=w.useState(20),[v,S]=w.useState(0),k=w.useMemo(()=>Math.ceil(v/b),[v,b]),T=w.useCallback(async(z=1,B="")=>{o(!0),h(null);try{const R=new URLSearchParams({page:String(z),limit:String(b)});B&&R.append("search",B);const U=await de(`/api/lab?${R.toString()}`);if(!U.ok)throw new Error(`HTTP error! status: ${U.status}`);const Y=await U.json(),Z=Y.orders.map(ne=>{var ae,X;return{id:ne.id,labTokenNumber:String(ne.lab_token_number??"N/A"),patientName:((ae=ne.Patient)==null?void 0:ae.name)||"N/A",patientId:ne.patient_id,patientTokenNumber:String(((X=ne.Patient)==null?void 0:X.patient_token_number)??"N/A"),tests:(ne.tests||[]).map(W=>W.name||"Unknown Test"),date:_r(new Date(ne.createdAt),"yyyy-MM-dd"),status:ne.status,reportId:ne.reportId,billId:ne.billId}});n(Z),S(Y.totalCount),g(z)}catch(R){console.error("Failed to fetch lab orders:",R),h(R instanceof Error?R.message:"An unknown error occurred"),n([]),S(0)}finally{o(!1)}},[b]);w.useEffect(()=>{console.log(`Fetch effect triggered. Current page: ${f}, Search term: "${t}"`),t.length===0||t.length>=2?(console.log(`Condition met (length ${t.length}). Fetching orders...`),T(f,t)):console.log(`Condition not met (length ${t.length}). Not fetching.`)},[T,f,t]),w.useEffect(()=>{const z=setTimeout(()=>{t.length>=2?f!==1&&g(1):t.length<2&&f!==1&&g(1)},1e3);return()=>{clearTimeout(z)}},[t]);const E=async(z,B)=>{console.log(`Updating order ${z} to status ${B}`);try{const R=await de(`/api/lab/${z}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:B})});if(!R.ok){const U=await R.json();throw new Error(U.message||`Failed to update status: ${R.status}`)}if(B==="completed"){const U=await de(`/api/lab/orders/${z}/report`);if(U.ok){const Y=await U.json();Gw(Y)}}await T(f,t),console.log(`Order ${z} status updated to ${B}, refetching page ${f}`)}catch(R){console.error("Error updating status:",R),alert(`Failed to update status: ${R instanceof Error?R.message:"Unknown error"}`)}},P=Ot(),I=z=>{if(!z){console.error("Cannot navigate to billing: Order data is missing."),alert("Could not open billing page: Order information is missing.");return}z.billId?(console.log(`Navigating to existing bill for Bill ID: ${z.billId}, Patient: ${z.patientName}`),P("/billing",{state:{billId:z.billId,patientId:z.patientId,patientName:z.patientName,billType:"lab"}})):(console.log(`Navigating to create new bill for Lab Order ID: ${z.id}, Patient: ${z.patientName}`),P("/lab-billing",{state:{labOrderId:z.id}}))},q=z=>{z&&z.id?P(`/lab/report/${z.id}`):(console.error("Cannot navigate: Order or Order ID is missing."),alert("Could not open the report entry page: Order information is missing."))},$=z=>{switch(z){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:z,className:"status-badge"}}};if(a)return i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsx("div",{className:"text-teal-600 text-xl animate-pulse",children:"Loading Lab Panel..."})});if(l)return i.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-red-50 text-red-700",children:[i.jsx(ui,{size:48,className:"mb-4"}),i.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Error Loading Lab Data"}),i.jsx("p",{className:"mb-4",children:l}),i.jsx("button",{onClick:()=>T(1,""),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry Fetch"})]});const L=()=>{f>1&&g(z=>z-1)},F=()=>{f<k&&g(z=>z+1)};return i.jsxs("div",{className:"lab-inventory-container",children:[i.jsxs("div",{className:"lab-panel-header-wrapper",children:[i.jsx("button",{onClick:()=>P(-1),className:"back-button",children:i.jsx(on,{size:20})}),i.jsx("h2",{className:"lab-panel-title",children:"Lab Panel"})]}),i.jsxs("main",{className:"flex-1 overflow-y-auto",children:[i.jsxs("div",{className:"lab-panel-nav-tabs",children:[i.jsxs("button",{onClick:()=>u("orders"),className:`lab-inventory-button ${d==="orders"?"":"lab-inventory-button-secondary"}`,children:[i.jsx(WC,{size:14}),i.jsx("span",{children:"Orders"})]}),i.jsxs("button",{onClick:()=>P("/create-lab-order"),className:"lab-inventory-button",children:[i.jsx("span",{className:"hidden sm:inline",children:"Create "}),"New Order"]}),i.jsxs("button",{onClick:()=>u("inventory"),className:`lab-inventory-button ${d==="inventory"?"":"lab-inventory-button-secondary"}`,children:[i.jsx(Db,{size:14}),i.jsx("span",{children:"Inventory"})]})]}),d==="orders"&&i.jsxs("div",{className:"lab-orders-view",children:[" ",i.jsxs("div",{className:"lab-orders-header-controls",children:[i.jsx("h3",{className:"lab-orders-title",children:"Current Lab Orders"}),i.jsxs("div",{className:"lab-orders-search-container",children:[i.jsx("input",{type:"text",placeholder:"Search name, token, tests...",value:t,onChange:z=>r(z.target.value),className:"lab-inventory-input lab-orders-search-input"}),i.jsx(Ai,{size:18,className:"lab-orders-search-icon"})]})]}),i.jsx("div",{className:"lab-orders-table-container",children:i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient (Token)"}),i.jsx("th",{children:"Tests"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"lab-table-actions-header",children:"Actions"})]})}),i.jsxs("tbody",{children:[a&&!l&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:"Loading orders..."})}),!a&&!l&&e.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."})}),!a&&!l&&e.map(z=>{const B=$(z.status);return i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{children:z.patientName}),i.jsxs("div",{className:"lab-table-patient-token",children:["Token: ",z.patientTokenNumber]})]}),i.jsx("td",{children:z.tests.map((R,U)=>i.jsx("div",{children:R},U))}),i.jsx("td",{className:"hidden md:table-cell",children:z.date}),i.jsx("td",{children:i.jsx("span",{className:B.className,children:B.text})}),i.jsx("td",{children:i.jsxs("div",{className:"lab-table-actions",children:[z.status==="pending"&&i.jsx("button",{onClick:()=>I(z),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),z.status==="billed"&&i.jsx("button",{onClick:()=>E(z.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),z.status==="collected"&&i.jsx("button",{onClick:()=>E(z.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(z.status==="processing"||z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>q(z),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>E(z.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(z.status==="completed"||z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>{z.id?P(`/lab/view-report/${z.id}`):(console.error("Attempted to view report for an order with no ID:",z),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})})]},z.id)})]})]})}),i.jsxs("div",{className:"lab-orders-card-container",children:[a&&!l&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:"Loading orders..."}),!a&&!l&&e.length===0&&i.jsx("div",{className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."}),!a&&!l&&e.map(z=>{const B=$(z.status);return i.jsxs("div",{className:"lab-order-card",children:[i.jsxs("div",{className:"lab-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"lab-card-patient-name",children:z.patientName}),i.jsxs("div",{className:"lab-card-patient-token",children:["Token: ",z.patientTokenNumber]}),i.jsx("div",{className:"lab-card-date",children:z.date})]}),i.jsx("span",{className:`${B.className} lab-card-status-pill`,children:B.text})]}),i.jsxs("div",{className:"lab-card-section",children:[i.jsx("p",{className:"lab-card-section-title",children:"Tests:"}),z.tests.map((R,U)=>i.jsx("div",{className:"lab-card-test-item",children:R},U)),z.tests.length===0&&i.jsx("div",{className:"lab-card-no-tests",children:"No tests listed."})]}),i.jsxs("div",{className:"lab-card-actions",children:[z.status==="pending"&&i.jsx("button",{onClick:()=>I(z),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),z.status==="billed"&&i.jsx("button",{onClick:()=>E(z.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),z.status==="collected"&&i.jsx("button",{onClick:()=>E(z.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(z.status==="processing"||z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>q(z),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>E(z.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(z.status==="completed"||z.status==="report_ready"||z.status==="reported")&&i.jsx("button",{onClick:()=>{z.id?P(`/lab/view-report/${z.id}`):(console.error("Attempted to view report for an order with no ID:",z),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})]},z.id)})]}),!a&&v>0&&i.jsxs("div",{className:"lab-pagination-controls",children:[i.jsxs("div",{className:"lab-pagination-info",children:["Showing"," ",i.jsx("strong",{children:(f-1)*b+1})," ","to"," ",i.jsx("strong",{children:Math.min(f*b,v)})," ","of"," ",i.jsx("strong",{children:v})," ","results"]}),i.jsxs("div",{className:"lab-pagination-buttons",children:[i.jsx("button",{onClick:L,disabled:f===1,className:"lab-pagination-button","aria-label":"Previous page",children:i.jsx(Pb,{size:18})}),i.jsxs("span",{children:["Page ",f," of ",k]}),i.jsx("button",{onClick:F,disabled:f===k,className:"lab-pagination-button","aria-label":"Next page",children:i.jsx(bg,{size:18})})]})]})]}),d==="inventory"&&i.jsxs("div",{className:"lab-inventory-content-wrapper",children:[" ",i.jsx(Jb,{})]})]})]})},uY=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(""),[a,o]=w.useState(!0),[l,h]=w.useState(null),d=Ot(),u=w.useRef(null),[f,g]=w.useState(1),[b,v]=w.useState(1),[S,k]=w.useState(0),T=10,E=w.useCallback(async(F,z,B)=>{o(!0),h(null);try{let R=`/api/pharmacy-orders?page=${F}&limit=${z}`;B&&B.trim()!==""&&(R+=`&search=${encodeURIComponent(B.trim())}`);const U=await de(R);if(!U.ok)throw new Error(`Failed to fetch orders: ${U.statusText} (${U.status})`);const Y=await U.json();if(Y&&Array.isArray(Y.orders)&&typeof Y.totalOrders=="number"&&typeof Y.totalPages=="number")console.log("Fetched pharmacy orders data:",Y.orders),n(Y.orders),k(Y.totalOrders),v(Y.totalPages),g(Y.currentPage||F);else throw console.error("Received data does not match expected paginated structure:",Y),new Error("Invalid data format received from API")}catch(R){console.error("Failed to fetch pharmacy orders:",R),h(R.message||"Failed to fetch orders. Please try again."),n([]),v(1),k(0)}finally{o(!1)}},[]);w.useEffect(()=>(u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{E(f,T,t)},500),()=>{u.current&&clearTimeout(u.current)}),[t,f,E,T]);const P=F=>{d(`/dashboard/edit-pharmacy-order/${F}`)},I=F=>{h(null),console.log(`Preparing billing navigation for order: ${F}`);const z=e.find(B=>B.id===F);if(z){const B=z.medications.map(R=>{const U=R.price??0;return(R.price===void 0||R.price===null)&&console.warn(`Medication "${R.name}" in order ${F} is missing a price. Defaulting to 0.`),{name:R.name,pack_quantity:R.pack_quantity,loose_quantity:R.loose_quantity,price:U,pack_price:R.pack_price,loose_price:R.loose_price,total_price:R.total_price,isLoose:R.isLoose,unit:R.unit,drug_id:R.drug_id?String(R.drug_id):null,tabletsPerDay:R.tabletsPerDay,numberOfDays:R.numberOfDays,directions_to_use:R.directions_to_use,discount_percentage:0,batch:R.batch,expiry_date:R.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:B}),d(`/dashboard/pharmacy-billing/${F}`,{state:{initialItems:B}})}else console.error(`Order with ID ${F} not found.`),h(`Order with ID ${F} not found.`),alert(`Error: Could not find order ${F} to bill.`)},q=async(F,z)=>{h(null);const B=e.find(U=>U.id===F);if(!B){h(`Order with ID ${F} not found.`);return}const R={status:z,medications:B.medications};try{const U=await de(`/api/pharmacy-orders/${F}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)});if(!U.ok){const Z=await U.text();throw new Error(`Failed to update status: ${U.statusText} (${U.status}) - ${Z}`)}const Y=await U.json();n(Z=>Z.map(ne=>ne.id===Y.id?{...ne,status:Y.status}:ne))}catch(U){console.error("Failed to update order status:",U),h(U.message||`Failed to update status for order ${F}.`),alert(`Error updating status for order ${F}: ${U.message||"Please try again."}`)}},$=F=>{switch(F){case"pending":return"status-pill status-pill-pending";case"billed":return"status-pill status-pill-billed";case"dispensed":return"status-pill status-pill-dispensed";case"cancelled":return"status-pill status-pill-cancelled";default:return"status-pill status-pill-default"}},L=F=>{d(`/dashboard/orders/${F.id}`)};return a&&e.length===0&&!l?i.jsx("div",{className:"loading-pulse",children:"Loading Orders..."}):l&&e.length===0?i.jsxs("div",{className:"error-message-box",children:["Error loading orders: ",l]}):i.jsxs("div",{className:"pharmacy-queue-container",children:[i.jsxs("div",{className:"pharmacy-queue-header",children:[i.jsx("h3",{className:"pharmacy-queue-title",children:"Pharmacy Queue"}),i.jsxs("div",{className:"pharmacy-actions-container",children:[i.jsxs("div",{className:"pharmacy-buttons-group",children:[i.jsxs("button",{onClick:()=>d("/dashboard/add-order"),className:"pharmacy-action-button btn-add-order",title:"Add New Order",children:[i.jsx(nc,{size:14}),"Add Order"]}),i.jsxs("button",{onClick:()=>d("/dashboard/inventory"),className:"pharmacy-action-button btn-inventory",title:"View Inventory",children:[i.jsx(ho,{size:14}),"Inventory"]}),i.jsxs("button",{onClick:()=>d("/dashboard/distributors"),className:"pharmacy-action-button btn-distributors",title:"Distributors",children:[i.jsx(ho,{size:14}),"Distributors"]}),i.jsxs("button",{onClick:()=>d("/dashboard/recurring-medications"),className:"pharmacy-action-button btn-refill-reminders",title:"Recurring Meds",children:[i.jsx(YP,{size:14}),"Refills"]}),i.jsxs("button",{onClick:()=>d("/dashboard/search-patient-records"),className:"pharmacy-action-button btn-ai-search",title:"Newton's AI Search",children:[i.jsx(UC,{size:14}),"AI Search"]})]}),i.jsxs("div",{className:"pharmacy-search-input-container",children:[i.jsx("input",{type:"text",placeholder:"Search orders by patient name, token, or medication...",value:t,onChange:F=>{r(F.target.value),g(1)},className:"pharmacy-search-input"}),i.jsx(Ai,{size:16,className:"pharmacy-search-icon"})]})]})]}),i.jsxs("div",{className:"pharmacy-orders-scroll-container",children:[l&&e.length>0&&i.jsxs("div",{className:"error-message-box",children:["Error: ",l]}),a&&e.length>0&&i.jsx("div",{className:"loading-pulse",children:"Updating Orders..."}),!a&&e.length===0&&!l&&i.jsx("div",{className:"empty-state-message",children:t?`No pharmacy orders found matching "${t}".`:"There are currently no pharmacy orders."}),e.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"pharmacy-table-container",children:i.jsxs("table",{className:"pharmacy-queue-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient"}),i.jsx("th",{children:"Medications"}),i.jsx("th",{className:"hidden md:table-cell",children:"Date"}),i.jsx("th",{children:"Order Total"}),i.jsx("th",{children:"Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map(F=>i.jsxs("tr",{onClick:()=>L(F),style:{cursor:"pointer"},children:[i.jsxs("td",{children:[i.jsx("div",{className:"patient-name",children:F.patientName}),i.jsx("div",{className:"patient-token",title:`Patient Token: ${F.patientTokenNumber}`,children:F.patientTokenNumber})]}),i.jsxs("td",{className:"medication-info",children:[F.medications.map((z,B)=>i.jsxs("div",{className:"medication-item",children:[i.jsxs("span",{children:[z.name," (Packs: ",z.pack_quantity,", Loose: ",z.loose_quantity,", ",z.tabletsPerDay??"N/A","x",z.numberOfDays??"N/A","d)",z.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",z.box_number,")"]})]}),z.directions_to_use&&i.jsxs("span",{className:"medication-directions",children:["Directions: ",z.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[z.pack_price!==void 0&&`Pack Price: ${Number(z.pack_price).toFixed(2)}`,z.loose_price!==void 0&&` | Loose Price: ${Number(z.loose_price).toFixed(2)}`,z.total_price!==void 0&&` | Item Total: ${Number(z.total_price).toFixed(2)}`]})]},B)),F.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",F.prescriptionForUnavailableDrugs]})]}),i.jsx("td",{className:"hidden md:table-cell date-info",children:new Date(F.date).toLocaleDateString()}),i.jsxs("td",{className:"order-total-cell font-semibold",children:["",Number(F.order_total??0).toFixed(2)]}),i.jsx("td",{children:i.jsx("span",{className:$(F.status),children:F.status})}),i.jsx("td",{children:i.jsxs("div",{className:"pharmacy-table-actions",children:[F.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:z=>{z.stopPropagation(),P(F.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx($d,{size:14})," Edit"]}),i.jsxs("button",{onClick:z=>{z.stopPropagation(),I(F.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx(sg,{size:14})," Bill"]})]}),F.status==="billed"&&i.jsxs("button",{onClick:z=>{z.stopPropagation(),q(F.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx(Ea,{size:14})," Dispense"]}),(F.status==="pending"||F.status==="billed")&&i.jsx("button",{onClick:z=>{z.stopPropagation(),q(F.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:z=>{z.stopPropagation(),L(F)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})})]},F.id))})]})}),i.jsx("div",{className:"pharmacy-card-view-container",children:e.map(F=>{const z=$(F.status);return i.jsxs("div",{className:"pharmacy-order-card",onClick:()=>L(F),children:[i.jsxs("div",{className:"pharmacy-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"pharmacy-card-patient-name",children:F.patientName||"N/A"}),i.jsxs("div",{className:"pharmacy-card-patient-token",title:`Patient Token: ${F.patientTokenNumber}`,children:["Token: ",F.patientTokenNumber||"N/A"]}),i.jsx("div",{className:"pharmacy-card-date",children:new Date(F.date).toLocaleDateString()})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:z,children:F.status}),F.order_total!==void 0&&i.jsxs("span",{className:"pharmacy-card-order-total font-semibold",children:["",Number(F.order_total).toFixed(2)]})]})]}),i.jsxs("div",{className:"pharmacy-card-medications",children:[i.jsx("p",{className:"pharmacy-card-medications-title",children:"Medications:"}),i.jsxs("div",{className:"space-y-0_5",children:[F.medications.slice(0,2).map((B,R)=>i.jsxs("div",{className:"pharmacy-card-medication-item",children:[i.jsxs("span",{title:`${B.name} (Packs: ${B.pack_quantity}, Loose: ${B.loose_quantity}, ${B.tabletsPerDay??"N/A"}x${B.numberOfDays??"N/A"}d)`,children:[B.name," (Packs: ",B.pack_quantity,", Loose: ",B.loose_quantity,", ",B.tabletsPerDay??"N/A","x",B.numberOfDays??"N/A","d)",B.box_number&&i.jsxs("span",{className:"medication-box-number",children:[" (Box: ",B.box_number,")"]})]}),B.directions_to_use&&i.jsxs("span",{className:"medication-directions",title:`Directions: ${B.directions_to_use}`,children:["Directions: ",B.directions_to_use]}),i.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[B.pack_price!==void 0&&`Pack Price: ${Number(B.pack_price).toFixed(2)}`,B.loose_price!==void 0&&` | Loose Price: ${Number(B.loose_price).toFixed(2)}`,B.total_price!==void 0&&` | Item Total: ${Number(B.total_price).toFixed(2)}`]})]},R)),F.medications.length>2&&i.jsxs("div",{className:"pharmacy-card-medications-more",children:["...and ",F.medications.length-2," more"]}),F.medications.length===0&&i.jsx("div",{className:"pharmacy-card-no-medications",children:"No medications listed."})]}),F.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"unavailable-drugs-note",children:[i.jsx("strong",{children:"Unavailable Drugs Note:"})," ",F.prescriptionForUnavailableDrugs]})]}),i.jsxs("div",{className:"pharmacy-card-actions",children:[F.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:B=>{B.stopPropagation(),P(F.id)},className:"pharmacy-table-action-button btn-edit-order",children:[i.jsx($d,{size:14})," Edit"]}),i.jsxs("button",{onClick:B=>{B.stopPropagation(),I(F.id)},className:"pharmacy-table-action-button btn-bill-order",children:[i.jsx(sg,{size:14})," Bill"]})]}),F.status==="billed"&&i.jsxs("button",{onClick:B=>{B.stopPropagation(),q(F.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[i.jsx(Ea,{size:14})," Dispense"]}),(F.status==="pending"||F.status==="billed")&&i.jsx("button",{onClick:B=>{B.stopPropagation(),q(F.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),i.jsx("button",{onClick:B=>{B.stopPropagation(),L(F)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})]},F.id)})})]}),!a&&b>1&&i.jsxs("div",{className:"pharmacy-pagination-container",children:[i.jsxs("div",{className:"pagination-mobile-controls",children:[i.jsx("button",{onClick:()=>g(F=>Math.max(F-1,1)),disabled:f===1,className:"pagination-button prev",children:"Previous"}),i.jsx("button",{onClick:()=>g(F=>Math.min(F+1,b)),disabled:f===b,className:"pagination-button next",children:"Next"})]}),i.jsxs("div",{className:"pagination-desktop-controls",children:[i.jsx("div",{className:"pagination-info",children:i.jsxs("p",{children:["Showing ",i.jsx("span",{className:"font-medium",children:(f-1)*T+1})," ","to ",i.jsx("span",{className:"font-medium",children:Math.min(f*T,S)})," ","of ",i.jsx("span",{className:"font-medium",children:S})," results"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"pagination-nav","aria-label":"Pagination",children:[i.jsxs("button",{onClick:()=>g(F=>Math.max(F-1,1)),disabled:f===1,className:"pagination-nav-button prev",children:[i.jsx("span",{className:"sr-only",children:"Previous"}),i.jsx(Pb,{"aria-hidden":"true"})]}),i.jsxs("span",{"aria-current":"page",className:"pagination-current-page",children:["Page ",f," of ",b]}),i.jsxs("button",{onClick:()=>g(F=>Math.min(F+1,b)),disabled:f===b,className:"pagination-nav-button next",children:[i.jsx("span",{className:"sr-only",children:"Next"}),i.jsx(bg,{"aria-hidden":"true"})]})]})})]})]})]})," "]})},dY=()=>{const e=Ot();return i.jsxs("div",{className:"bg-white p-3 md:p-6 rounded-lg shadow",children:[i.jsx("button",{onClick:()=>e(-1),className:"mb-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Back"}),i.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Settings"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Pharmacy settings will be configured here."})]})},hY=()=>{const{id:e}=Yr(),n=Ot(),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,h]=w.useState(null),[d,u]=w.useState(!1),[f,g]=w.useState(!1),b=w.useRef(null),v=w.useRef(null),S=w.useRef(null),k=w.useCallback(async()=>{if(!e){h("Drug ID is missing."),o(!1);return}o(!0),h(null);try{const I=await de(`/api/drugs/${e}`);if(!I.ok){const $=await I.json();throw new Error($.message||`Failed to fetch drug: ${I.statusText}`)}let q=await I.json();q={...q,name:q.name||"",brand_name:q.brand_name||"",price:parseFloat(String(q.price))||0,buying_price:q.buying_price!==null&&q.buying_price!==void 0?parseFloat(String(q.buying_price)):null,quantity_in_stock:parseInt(String(q.quantity_in_stock),10)||0,gst:q.gst!==null&&q.gst!==void 0?parseFloat(String(q.gst)):null,margin:q.margin!==null&&q.margin!==void 0?parseFloat(String(q.margin)):null,discount:q.discount!==null&&q.discount!==void 0?parseFloat(String(q.discount)):null,batch:q.batch||"",hsn_code:q.hsn_code||"",mfg:q.mfg||"",loose:q.loose!==null&&q.loose!==void 0?parseInt(String(q.loose),10):null},r(q)}catch(I){console.error("Failed to fetch drug:",I),h(I.message||"Failed to load drug data. Please try again.")}finally{o(!1)}},[e]);w.useEffect(()=>{k()},[k]),w.useEffect(()=>{const I=$=>{$.key==="Tab"&&v.current===document.activeElement&&(f||(g(!0),setTimeout(()=>{var L;(L=S.current)==null||L.focus()},0),$.preventDefault()))},q=$=>{b.current&&!b.current.contains($.target)&&g(!1)};return document.addEventListener("keydown",I),document.addEventListener("mousedown",q),()=>{document.removeEventListener("keydown",I),document.removeEventListener("mousedown",q)}},[f]);const T=I=>{const{name:q,value:$,type:L}=I.target;r(F=>F?{...F,[q]:L==="number"?parseFloat($)||null:$}:null)},E=()=>{n(-1)},P=async I=>{if(I.preventDefault(),h(null),u(!0),!t||!t.id){h("Cannot edit drug: No drug data available."),u(!1);return}if(t.price===void 0||t.quantity_in_stock===void 0){h("Price and Stock Quantity are required."),u(!1);return}const q={...t,name:t.name===""?null:t.name,brand_name:t.brand_name===""?null:t.brand_name,buying_price:t.buying_price===0?null:t.buying_price,expiry_date:t.expiry_date===""?null:t.expiry_date,gst:t.gst===0?null:t.gst,margin:t.margin===0?null:t.margin,discount:t.discount===0?null:t.discount,batch:t.batch===""?null:t.batch,hsn_code:t.hsn_code===""?null:t.hsn_code,mfg:t.mfg===""?null:t.mfg,loose:t.loose===0?null:t.loose};try{const $=await de(`/api/drugs/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(q)});if(!$.ok){const F=await $.json();throw new Error(F.message||`Failed to update drug: ${$.statusText}`)}const L=await $.json();alert(`Drug "${L.name}" updated successfully!`),n(-1)}catch($){console.error("Failed to update drug:",$),h($.message||"Failed to update drug. Please try again.")}finally{u(!1)}};return a?i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"loading-message",children:"Loading drug data..."})}):l&&!t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"error-message-load",children:["Error: ",l]})}):t?i.jsx("div",{className:"edit-drug-form-page",children:i.jsxs("div",{className:"edit-drug-form-container",children:[i.jsxs("div",{className:"edit-drug-form-header",children:[i.jsxs("h2",{children:["Edit Drug: ",t.name]}),i.jsx("button",{onClick:E,className:"cancel-button",title:"Go Back",children:i.jsx(In,{size:24})})]}),l&&i.jsx("div",{className:"error-message-submit",children:l}),i.jsxs("form",{onSubmit:P,className:"edit-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-name",className:"form-label",children:"Composition Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(As,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"edit-name",value:t.name||"",onChange:T,className:"custom-text-input",placeholder:"e.g., Paracetamol",tabIndex:1})," "]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-brand_name",className:"form-label",children:"Brand Name"})," ",i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(As,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"edit-brand_name",value:t.brand_name||"",onChange:T,className:"custom-text-input",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-price",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(As,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"price",id:"edit-price",required:!0,step:"0.01",min:"0",value:t.price,onChange:T,className:"custom-text-input",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"edit-quantity_in_stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(As,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"quantity_in_stock",id:"edit-quantity_in_stock",required:!0,step:"1",min:"0",value:t.quantity_in_stock,onChange:T,className:"custom-text-input",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-unit",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"unit",id:"edit-unit",value:t.unit||"",onChange:T,className:"custom-text-input",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"edit-expiry_date",value:t.expiry_date||"",onChange:T,className:"custom-text-input",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"edit-box_number",value:t.box_number||"",onChange:T,className:"custom-text-input",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:b,children:[i.jsx("button",{type:"button",onClick:()=>g(!f),className:"form-button w-full text-left",tabIndex:8,ref:v,children:"Others"}),f&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"edit-description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"edit-description",rows:3,value:t.description||"",onChange:T,className:"custom-text-input",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-supplier",className:"form-label",children:"Supplier"}),i.jsx("input",{type:"text",name:"supplier",id:"edit-supplier",value:t.supplier||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:10})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-buying_price",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"buying_price",id:"edit-buying_price",step:"0.01",min:"0",value:t.buying_price??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:11,ref:S})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"edit-gst",step:"0.01",min:"0",max:"100",value:t.gst??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"edit-margin",step:"0.01",min:"0",max:"100",value:t.margin??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"edit-discount",step:"0.01",min:"0",max:"100",value:t.discount??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"edit-batch",value:t.batch||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"edit-hsn_code",value:t.hsn_code||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"edit-mfg",value:t.mfg||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:17})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"edit-loose",className:"form-label",children:"Loose"}),i.jsx("input",{type:"number",name:"loose",id:"edit-loose",step:"1",min:"0",value:t.loose??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:18})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:E,disabled:d,className:"form-button cancel-form-button",tabIndex:19,children:"Back"}),i.jsx("button",{type:"submit",disabled:d,className:"form-button submit-form-button",tabIndex:20,children:d?"Saving...":"Save Changes"})]})]})]})}):i.jsx("div",{className:"edit-drug-form-page",children:i.jsx("div",{className:"not-found-message",children:"Drug not found."})})},O1=()=>{const e=Ot(),[n,t]=w.useState({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),[r,a]=w.useState(!1),[o,l]=w.useState(null),[h,d]=w.useState(null),[u,f]=w.useState([]),[g,b]=w.useState(!0);w.useEffect(()=>{(async()=>{b(!0);try{const T=await de("/api/staff?role=doctor");if(!T.ok)throw new Error("Failed to fetch doctors");const E=await T.json();f(E),E.length>0&&t(P=>({...P,doctorId:""}))}catch(T){console.error("Error fetching doctors:",T),l(`Failed to load doctors: ${T.message}`)}finally{b(!1)}})()},[]);const v=k=>{const{name:T,value:E}=k.target;t(P=>({...P,[T]:E}))},S=async k=>{var T;k.preventDefault(),l(null),d(null),a(!0);try{let E,P;console.log("Registering new patient...");const I=await de("/api/patients",{method:"POST",body:JSON.stringify({name:n.name,age:n.age?parseInt(n.age,10):null,gender:n.gender||null,phone:n.phone||null})});if(!I.ok){const z=await I.json();if(I.status===403&&z.message.includes("Patient limit")){e("/start-clinic-subscription",{state:{errorMessage:z.message}});return}throw new Error(z.message||"Failed to register patient")}const q=await I.json();E=q.id,P=q.name,console.log(`New patient ${E} registered.`);const $=n.doctorId||null;console.log(`Adding patient ${E} to general queue first (Assignment pending payment)`);const L=await de("/api/queue",{method:"POST",body:JSON.stringify({patientId:E,complaint:n.complaint||null,doctorId:null})});if(!L.ok){const z=await L.json();throw new Error(z.message||"Failed to add patient to queue")}const F=await L.json();if(console.log(`Patient added to queue, entry ID: ${F.id}`),t({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),$){const z=((T=u.find(R=>R.id===$))==null?void 0:T.name)||"Selected Doctor",B=`Patient "${P}" registered and added to queue. Redirecting to billing for Dr. ${z}...`;d(B),e("/billing",{state:{patientId:E,queueId:F.id,patientName:P,doctorId:$,billType:"consultation",finalizeQueueAssignment:!0}})}else{const z=`Patient "${P}" registered and added to the general queue.`;d(z)}}catch(E){console.error("Error in add/queue process:",E),E.message.includes("Patient limit")?(l(`Operation failed: ${E.message}. Please upgrade your plan.`),e("/start-clinic-subscription")):l(`Operation failed: ${E.message}`)}finally{a(!1)}};return i.jsxs("div",{className:"add-patient-page-container",children:[i.jsx("div",{className:"w-full max-w-3xl flex justify-start",children:i.jsx("button",{onClick:()=>e(-1),className:"back-button",title:"Back to Previous Page",children:i.jsx(on,{size:20})})}),i.jsxs("div",{className:"add-patient-card",children:[i.jsxs("h1",{className:"add-patient-title",children:[i.jsx(i1,{size:32}),"Register New Patient"]}),o&&i.jsxs("div",{className:"alert alert-danger",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:o})]}),h&&i.jsxs("div",{className:"alert alert-success",role:"alert",children:[i.jsx("strong",{children:"Success: "}),i.jsx("span",{children:h})]}),i.jsxs("form",{onSubmit:S,className:"space-y-6",children:[i.jsxs("fieldset",{className:"form-fieldset",children:[i.jsx("legend",{children:"Basic Information"}),i.jsxs("div",{className:"form-grid form-grid-cols-2",children:[i.jsxs("div",{className:"form-grid-col-span-2",children:[i.jsx("label",{className:"form-label",children:"Full Name *"}),i.jsx("input",{type:"text",name:"name",placeholder:"Enter patient's full name",value:n.name,onChange:v,className:"form-input",required:!0,disabled:r})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Age"}),i.jsx("input",{type:"number",name:"age",placeholder:"Years",value:n.age,onChange:v,onBlur:k=>{k.target.value===""&&t(T=>({...T,age:"0"}))},className:"form-input",min:"0",disabled:r})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Gender"}),i.jsxs("select",{name:"gender",value:n.gender,onChange:v,className:"form-select",disabled:r,children:[i.jsx("option",{value:"",children:"Select Gender"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]})]}),i.jsxs("div",{className:"form-grid-col-span-2",children:[i.jsx("label",{className:"form-label",children:"Phone Number"}),i.jsx("input",{type:"tel",name:"phone",placeholder:"e.g. +91 9876543210",value:n.phone,onChange:v,className:"form-input",disabled:r})]})]})]}),i.jsxs("fieldset",{className:"form-fieldset",children:[i.jsx("legend",{children:"Visit & Consultation"}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Consulting Doctor (Optional)"}),i.jsxs("select",{name:"doctorId",value:n.doctorId,onChange:v,className:`form-select ${g?"opacity-50":""}`,disabled:r||g,children:[i.jsx("option",{value:"",children:g?"Loading doctors...":u.length===0?"No doctors available":"-- No Doctor (Add to General Queue) --"}),u.map(k=>i.jsx("option",{value:k.id,children:k.name},k.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"form-label",children:"Reason for Visit / Complaint"}),i.jsx("textarea",{name:"complaint",placeholder:"Briefly describe the reason for visit...",value:n.complaint,onChange:v,rows:3,className:"form-textarea",disabled:r})]})]})]}),i.jsx("button",{type:"submit",className:"btn-primary",disabled:r||g,style:{width:"100%"},children:r?i.jsx("span",{children:"Processing..."}):i.jsxs(i.Fragment,{children:[i.jsx(FM,{size:20}),"Register & Add to Queue"]})})]})]})]})},fY=({clinicId:e})=>{const n=Ot(),[t,r]=w.useState({name:"",email:"",role:"receptionist",password:"",opd_fee:""}),[a,o]=w.useState(null),[l,h]=w.useState(!1);w.useEffect(()=>{o(e?null:"Clinic information is missing. Please ensure you are logged in correctly.")},[e]);const d=f=>{const{name:g,value:b}=f.target;r(v=>{const S={...v,[g]:b};return g==="role"&&b!=="doctor"&&(S.opd_fee=""),S})},u=async f=>{if(f.preventDefault(),o(null),!t.name||!t.email||!t.role||!t.password){o("Please fill in all required fields (Name, Email, Role, and Password).");return}if(!e){o("Clinic session not found. Please refresh and try again.");return}const g={...t,clinic_id:e,opd_fee:t.role==="doctor"&&t.opd_fee?parseFloat(String(t.opd_fee)):null};if(g.role==="doctor"&&t.opd_fee&&isNaN(g.opd_fee)){o("Please enter a valid amount for the OPD Fee.");return}h(!0);try{const b=await de("/api/staff",{method:"POST",body:JSON.stringify(g)});if(!b.ok){const v=await b.json();throw new Error(v.message||"The server encountered an error while adding staff.")}n(-1)}catch(b){o(b.message)}finally{h(!1)}};return i.jsxs("div",{className:"staff-page-container",children:[i.jsx("header",{className:"staff-header",children:i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[i.jsx("button",{onClick:()=>n(-1),className:"p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors",children:i.jsx(on,{size:20})}),i.jsx("h1",{children:"Add Staff Member"})]}),i.jsx("p",{className:"subtitle",children:"Register a new professional to your clinic's team."})]})}),a&&i.jsxs("div",{className:"mb-8 p-4 rounded-xl bg-rose-50 text-rose-700 border border-rose-100 flex items-center animate-in fade-in slide-in-from-top-2",children:[i.jsx(ui,{size:20,className:"mr-3 shrink-0"}),i.jsx("span",{className:"font-medium text-sm",children:a}),i.jsx("button",{onClick:()=>o(null),className:"ml-auto text-rose-400 hover:text-rose-600",children:""})]}),i.jsxs("form",{onSubmit:u,className:`staff-form ${e?"":"opacity-40 pointer-events-none"}`,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Full Name"}),i.jsx("input",{id:"name",type:"text",name:"name",value:t.name||"",onChange:d,required:!0,disabled:l||!e,placeholder:"Dr. John Doe / Receptionist Jane"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email Address"}),i.jsx("input",{id:"email",type:"email",name:"email",value:t.email||"",onChange:d,required:!0,disabled:l||!e,placeholder:"staff@example.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"role",children:"Assign Role"}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:d,required:!0,disabled:l||!e,children:[i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"}),i.jsx("option",{value:"lab",children:"Lab Technician"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"password",children:"Initial Password"}),i.jsx("input",{id:"password",type:"password",name:"password",value:t.password||"",onChange:d,required:!0,disabled:l||!e,placeholder:"Create a secure password"})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group animate-in fade-in zoom-in-95",children:[i.jsx("label",{htmlFor:"opd_fee",children:"Consultation Fee ()"}),i.jsx("input",{id:"opd_fee",type:"number",name:"opd_fee",value:t.opd_fee||"",onChange:d,step:"0.01",min:"0",placeholder:"e.g. 500",disabled:l||!e})]}),i.jsxs("div",{className:"flex items-center gap-4 mt-4 pt-6 border-t border-slate-100 dark:border-slate-800 full-width",children:[i.jsxs("button",{type:"submit",className:"staff-btn staff-btn-primary px-8",disabled:l||!e,children:[l?i.jsx(Rf,{size:18,className:"animate-spin"}):i.jsx(hl,{size:18}),i.jsx("span",{children:l?"Registering...":"Register Staff"})]}),i.jsx("button",{type:"button",onClick:()=>n(-1),className:"staff-btn staff-btn-secondary",disabled:l,children:"Cancel"})]})]})]})},pY=()=>{const{id:e}=Yr(),n=Ot(),[t,r]=w.useState({name:"",email:"",role:"receptionist",opd_fee:"",active:!0}),[a,o]=w.useState(""),[l,h]=w.useState(!0),[d,u]=w.useState(!1),[f,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Staff ID is missing."),h(!1);return}h(!0),g(null),v(null);try{const P=await de(`/staff/${e}`);if(!P.ok){const q=await P.json();throw new Error(q.message||`HTTP error! status: ${P.status}`)}const I=await P.json();r({name:I.name,email:I.email,role:I.role,opd_fee:I.opd_fee??"",active:I.active})}catch(P){g(`Failed to load staff details: ${P.message}`)}finally{h(!1)}},[e]);w.useEffect(()=>{S()},[S]);const k=P=>{const{name:I,value:q,type:$}=P.target;if($==="checkbox"){const{checked:L}=P.target;r(F=>({...F,[I]:L}))}else r(L=>({...L,[I]:q}))},T=P=>{o(P.target.value)},E=async P=>{if(P.preventDefault(),!e){g("Staff identifier is missing.");return}u(!0),g(null),v(null);const I={name:t.name,email:t.email,role:t.role,active:t.active};if(t.role==="doctor"){const q=t.opd_fee?parseFloat(String(t.opd_fee)):null;if(q!==null&&isNaN(q)){g("Consultation fee must be a valid number."),u(!1);return}I.opd_fee=q}else I.opd_fee=null;a.trim()!==""&&(I.password=a.trim());try{const q=await de(`/staff/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)});if(!q.ok){const $=await q.json();throw new Error($.message||`Error status: ${q.status}`)}v("Profile updated successfully!"),o(""),setTimeout(()=>n(-1),1500)}catch(q){g(`Failed to update profile: ${q.message}`)}finally{u(!1)}};return l?i.jsx("div",{className:"flex justify-center items-center h-screen bg-transparent",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",children:i.jsx("div",{className:"breathing-ball",style:{background:"var(--staff-primary)"}})}),i.jsx("span",{className:"mt-4 text-xl text-teal-600 font-medium tracking-tight",children:"Accessing staff records..."})]})}):i.jsxs("div",{className:"staff-page-container",children:[i.jsx("header",{className:"staff-header",children:i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[i.jsx("button",{onClick:()=>n(-1),className:"p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors",children:i.jsx(on,{size:20})}),i.jsx("h1",{children:"Edit Staff Profile"})]}),i.jsxs("p",{className:"subtitle",children:["Update credentials and preferences for ",t.name,"."]})]})}),f&&i.jsxs("div",{className:"mb-6 p-4 rounded-xl bg-rose-50 text-rose-700 border border-rose-100 flex items-center animate-in fade-in slide-in-from-top-2",children:[i.jsx(ui,{size:20,className:"mr-3"}),i.jsx("span",{className:"font-semibold text-sm",children:f})]}),b&&i.jsxs("div",{className:"mb-6 p-4 rounded-xl bg-emerald-50 text-emerald-700 border border-emerald-100 flex items-center animate-in fade-in slide-in-from-top-2",children:[i.jsx(Ea,{size:20,className:"mr-3"}),i.jsx("span",{className:"font-semibold text-sm",children:b})]}),i.jsxs("form",{onSubmit:E,className:"staff-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Full Name"}),i.jsx("input",{type:"text",id:"name",name:"name",value:t.name||"",onChange:k,required:!0,placeholder:"John Doe"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email Address"}),i.jsx("input",{type:"email",id:"email",name:"email",value:t.email||"",onChange:k,required:!0,placeholder:"johndoe@clinic.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"role",children:"Role"}),i.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:k,required:!0,children:[i.jsx("option",{value:"doctor",children:"Doctor"}),i.jsx("option",{value:"receptionist",children:"Receptionist"}),i.jsx("option",{value:"lab",children:"Lab Technician"}),i.jsx("option",{value:"pharmacy",children:"Pharmacist"})]})]}),t.role==="doctor"&&i.jsxs("div",{className:"form-group animate-in fade-in zoom-in-95",children:[i.jsx("label",{htmlFor:"opd_fee",children:"Consultation Fee ()"}),i.jsx("input",{type:"number",id:"opd_fee",name:"opd_fee",value:t.opd_fee||"",onChange:k,min:"0",step:"0.01",placeholder:"e.g. 500"})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{htmlFor:"password",children:"Update Password"}),i.jsx("input",{type:"password",id:"password",name:"password",value:a,onChange:T,placeholder:"Leave blank to keep existing password",autoComplete:"new-password"}),i.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Only fill this if you want to reset the staff member's password."})]}),i.jsxs("div",{className:"checkbox-group full-width",children:[i.jsx("input",{id:"active",name:"active",type:"checkbox",checked:t.active??!0,onChange:k}),i.jsxs("label",{htmlFor:"active",className:"mb-0 cursor-pointer select-none",children:[i.jsx("span",{className:"font-bold",children:"Account Active"}),i.jsx("p",{className:"text-xs text-slate-500 font-normal mt-1",children:"Deactivated staff cannot log into the system."})]})]}),i.jsxs("div",{className:"flex items-center gap-4 mt-4 pt-6 border-t border-slate-100 dark:border-slate-800 full-width",children:[i.jsxs("button",{type:"submit",className:"staff-btn staff-btn-primary px-8",disabled:d,children:[d?i.jsx(Rf,{className:"animate-spin",size:18}):i.jsx(oc,{size:18}),i.jsx("span",{children:d?"Saving...":"Save Changes"})]}),i.jsx("button",{type:"button",onClick:()=>n(-1),className:"staff-btn staff-btn-secondary",disabled:d,children:"Discard"})]})]})]})},mY=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},gY=e=>{switch(e){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:e,className:"status-badge"}}},yY=e=>{switch(e){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Billed / Ready",className:"status-badge status-billed"};case"dispensed":return{text:"Dispensed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:e,className:"status-badge"}}},M0=({title:e,items:n,renderItemContent:t,headerAction:r,isLoading:a,noDataText:o,onDeleteItem:l,onEditLabOrder:h,onSaveLabOrder:d,onCancelEditLabOrder:u,onLabOrderTestChange:f,onLabOrderStatusChange:g,onEditPharmacyOrder:b,onPrintUnavailablePrescription:v,onMarkAsRecurring:S,onEditComplaint:k,onSaveComplaint:T,onCancelEditComplaint:E,labInventory:P=[],isSavingLabOrder:I=!1,expandedLabReports:q={},toggleLabReport:$=()=>{}})=>{const L=w.useMemo(()=>{const z={};n.forEach(R=>{if(isNaN(R.date.getTime())){z["Unknown Date"]||(z["Unknown Date"]=[]),z["Unknown Date"].push(R);return}const U=mY(R.originalDateString);z[U]||(z[U]=[]),z[U].push(R)});const B=Object.keys(z);return B.sort((R,U)=>{if(R==="Unknown Date")return 1;if(U==="Unknown Date")return-1;try{const Y=new Date(R.split(" ").reverse().join(" ")),Z=new Date(U.split(" ").reverse().join(" "));if(!isNaN(Y.getTime())&&!isNaN(Z.getTime()))return Z.getTime()-Y.getTime()}catch{}return U.localeCompare(R)}),B.map(R=>({date:R,items:z[R]}))},[n]),F=["pending","billed","collected","processing","report_ready","completed","cancelled","reported"];return i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center px-4",children:[i.jsx("h4",{className:"ai-context-section-title mb-2 pb-1",children:e}),r]}),!a&&n.length===0&&i.jsx("p",{className:"ai-context-text italic px-4",children:o}),a&&i.jsx("div",{className:"space-y-3 px-4",children:[1,2,3].map(z=>i.jsx("div",{className:"skeleton-block",style:{height:"80px"}},z))}),!a&&n.length>0&&i.jsx("div",{className:"space-y-3",children:L.map(({date:z,items:B})=>i.jsxs("div",{children:[i.jsx("h5",{className:"grouped-history-date px-4",children:z}),i.jsx("div",{className:"space-y-1 grouped-history-item-container",children:B.map((R,U)=>i.jsxs("div",{className:"grouped-history-item ai-context-item flex flex-col px-4 py-2 border-b border-gray-50 last:border-0",style:{"--i":U},children:[i.jsxs("div",{className:"flex justify-between items-center w-full",children:[i.jsx("div",{className:"flex-grow mr-2 ai-context-text",children:t(R,U,q,$)}),i.jsxs("div",{className:"flex items-center space-x-1",children:[R.type==="Lab Order"&&!R.data.isEditing&&h&&i.jsx("button",{onClick:()=>h(R.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this lab order",disabled:I,children:i.jsx(Cs,{size:14})}),R.type==="Lab Order"&&R.data.isEditing&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>d&&d(R.data.id,R.data.editedTests,R.data.editedStatus),className:"text-green-600 hover:text-green-800 p-1 rounded hover:bg-green-100 focus:outline-none focus:ring-1 focus:ring-green-400",title:"Save lab order changes",disabled:I,children:i.jsx(oc,{size:14})}),i.jsx("button",{onClick:()=>u&&u(R.data.id),className:"text-gray-600 hover:text-gray-800 p-1 rounded hover:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-gray-400",title:"Cancel editing",disabled:I,children:i.jsx(In,{size:14})})]}),R.type==="Pharmacy Order"&&R.data.status==="pending"&&b&&i.jsx("button",{onClick:()=>b(R.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this pharmacy order",disabled:I,children:i.jsx(Cs,{size:14})}),R.type==="Pharmacy Order"&&R.data.prescriptionForUnavailableDrugs&&v&&i.jsx("button",{onClick:()=>v(R.data.prescriptionForUnavailableDrugs,`Prescription for Order ${R.data.id}`),className:"text-purple-600 hover:text-purple-800 p-1 rounded hover:bg-purple-100 focus:outline-none focus:ring-1 focus:ring-purple-400",title:"Print Prescription for Unavailable Drugs",disabled:I,children:i.jsx(fo,{size:14})}),R.type==="Pharmacy Order"&&S&&i.jsx("button",{onClick:()=>S(R.data.id),className:"text-teal-600 hover:text-teal-800 p-1 rounded hover:bg-teal-100 focus:outline-none focus:ring-1 focus:ring-teal-400",title:"Mark as Recurring Medication",disabled:I,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-repeat",children:[i.jsx("path",{d:"m17 2 4 4-4 4"}),i.jsx("path",{d:"M3 11v-1a4 4 0 0 1 4-4h14"}),i.jsx("path",{d:"m7 22-4-4 4-4"}),i.jsx("path",{d:"M21 13v1a4 4 0 0 1-4 4H3"})]})}),R.type==="Pharmacy Order"&&R.data.status==="pending"&&l&&i.jsx("button",{onClick:()=>l({type:R.type,data:R.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Delete this pending pharmacy order",disabled:I,children:i.jsx(Hi,{size:14})}),R.type==="Complaint"&&!R.data.isEditing&&k&&i.jsx("button",{onClick:()=>k(R.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this complaint",disabled:I,children:i.jsx(Cs,{size:14})}),R.type==="Complaint"&&R.data.isEditing&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>T&&T(R.data.id,R.data.editedComplaint),className:"text-green-600 hover:text-green-800 p-1 rounded hover:bg-green-100 focus:outline-none focus:ring-1 focus:ring-green-400",title:"Save complaint changes",disabled:I,children:i.jsx(oc,{size:14})}),i.jsx("button",{onClick:()=>E&&E(R.data.id),className:"text-gray-600 hover:text-gray-800 p-1 rounded hover:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-gray-400",title:"Cancel editing",disabled:I,children:i.jsx(In,{size:14})})]}),l&&["Complaint","Lab Order","Lab Report"].includes(R.type)&&i.jsx("button",{onClick:()=>l({type:R.type,data:R.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:`Delete this ${R.type.toLowerCase()}`,disabled:I,children:i.jsx(Hi,{size:14})})]})]}),R.type==="Lab Order"&&R.data.isEditing&&i.jsxs("div",{className:"lab-order-edit-form mt-2 w-full",children:[i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status:"}),i.jsx("select",{value:R.data.editedStatus||R.data.status,onChange:Y=>g&&g(R.data.id,Y.target.value),className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:I,children:F.map(Y=>i.jsx("option",{value:Y,children:Y.replace(/_/g," ")},Y))})]}),i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tests:"}),R.data.editedTests.map((Y,Z)=>i.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[i.jsxs("select",{value:Y.id,onChange:ne=>{const ae=P.find(X=>String(X.id)===ne.target.value);ae&&(f&&f(R.data.id,Z,"id",ae.id),f&&f(R.data.id,Z,"name",ae.name),f&&f(R.data.id,Z,"price",ae.price))},className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:I,children:[i.jsx("option",{value:"",children:"Select Test"}),P.map(ne=>i.jsxs("option",{value:ne.id,children:[ne.name," (",ne.price,")"]},ne.id))]}),i.jsx("button",{onClick:()=>{const ne=R.data.editedTests.filter((ae,X)=>X!==Z);f&&f(R.data.id,-1,"remove",ne)},className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Remove test",disabled:I,children:i.jsx(Hi,{size:14})})]},Z)),i.jsx("button",{onClick:()=>{f&&f(R.data.id,-1,"add",{id:"",name:"",price:0})},className:"button-secondary mt-2 text-xs",disabled:I,children:"Add Test"})]})]},`${R.type}-${R.originalDateString}-${U}`))})]},z))})]})},xY="_modalOverlay_1yna4_3",bY="_modalContent_1yna4_29",vY="_modalHeader_1yna4_57",wY="_modalTitle_1yna4_75",NY="_modalCloseButton_1yna4_87",SY="_modalBody_1yna4_115",jY="_errorText_1yna4_129",_Y="_formGroup_1yna4_147",CY="_inputField_1yna4_171",kY="_searchResultsCard_1yna4_213",EY="_searchResultsList_1yna4_241",TY="_searchResultItem_1yna4_253",AY="_searchResultPrice_1yna4_289",DY="_selectedTestsCard_1yna4_299",PY="_selectedTestsHeader_1yna4_319",IY="_noTestsMessage_1yna4_335",MY="_selectedTestsList_1yna4_351",RY="_selectedTestItem_1yna4_363",OY="_selectedTestName_1yna4_387",LY="_selectedTestPrice_1yna4_399",FY="_removeTestButton_1yna4_411",$Y="_totalAmount_1yna4_437",zY="_modalFooter_1yna4_455",BY="_button_1yna4_473",UY="_buttonPrimary_1yna4_491",qY="_buttonSecondary_1yna4_513",ai={modalOverlay:xY,modalContent:bY,modalHeader:vY,modalTitle:wY,modalCloseButton:NY,modalBody:SY,errorText:jY,formGroup:_Y,inputField:CY,searchResultsCard:kY,searchResultsList:EY,searchResultItem:TY,searchResultPrice:AY,selectedTestsCard:DY,selectedTestsHeader:PY,noTestsMessage:IY,selectedTestsList:MY,selectedTestItem:RY,selectedTestName:OY,selectedTestPrice:LY,removeTestButton:FY,totalAmount:$Y,modalFooter:zY,button:BY,buttonPrimary:UY,buttonSecondary:qY},VY=({isOpen:e,onClose:n,patientId:t,labInventory:r,fetchPendingLabOrdersData:a})=>{const[o,l]=w.useState([]),[h,d]=w.useState(""),[u,f]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>{if(!h){f([]);return}const P=h.toLowerCase();f(r.filter(I=>I.name.toLowerCase().includes(P)||I.description&&I.description.toLowerCase().includes(P)).slice(0,10))},[h,r]);const k=async()=>{if(!t){b("Patient ID is missing.");return}if(o.length===0){b("Please select at least one lab test.");return}S(!0),b(null);try{const P={patient_id:t,tests:o.map(q=>({id:q.id,name:q.name,price:q.price}))},I=await de("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(P)});if(!I.ok){const q=await I.json().catch(()=>({}));throw new Error(q.message||`Failed to create lab order: ${I.statusText}`)}await I.json(),a(t),n(),l([]),d("")}catch(P){b(`Lab Order Creation Error: ${P.message}`)}finally{S(!1)}},T=P=>{if(o.some(I=>I.id===P.id)){b(`${P.name} is already in the order.`),setTimeout(()=>b(null),3e3),d(""),f([]);return}l(I=>[...I,{...P}]),d(""),f([])},E=P=>{l(I=>I.filter(q=>q.id!==P))};return e?i.jsx("div",{className:ai.modalOverlay,children:i.jsxs("div",{className:ai.modalContent,children:[i.jsxs("div",{className:ai.modalHeader,children:[i.jsx("h3",{className:ai.modalTitle,children:"Create New Lab Order"}),i.jsx("button",{onClick:n,className:ai.modalCloseButton,children:i.jsx(In,{size:20})})]}),i.jsxs("div",{className:ai.modalBody,children:[g&&i.jsx("div",{className:ai.errorText,children:g}),i.jsxs("div",{className:ai.formGroup,style:{position:"relative"},children:[i.jsx("label",{htmlFor:"lab-test-search",children:"Add Lab Test"}),i.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search available lab tests...",value:h,onChange:P=>d(P.target.value),className:ai.inputField}),h&&u.length>0&&i.jsx("div",{className:ai.searchResultsCard,children:i.jsx("ul",{className:ai.searchResultsList,children:u.map(P=>i.jsxs("li",{onClick:()=>T(P),className:ai.searchResultItem,children:[i.jsx("span",{children:P.name}),i.jsxs("span",{className:ai.searchResultPrice,children:["(",parseFloat(String(P.price)).toFixed(2),")"]})]},P.id))})})]}),i.jsxs("div",{className:ai.selectedTestsCard,children:[i.jsx("h4",{className:ai.selectedTestsHeader,children:"Selected Tests"}),o.length===0?i.jsx("p",{className:ai.noTestsMessage,children:"No tests added yet."}):i.jsx("ul",{className:ai.selectedTestsList,children:o.map(P=>i.jsxs("li",{className:ai.selectedTestItem,children:[i.jsx("span",{className:ai.selectedTestName,children:P.name}),i.jsxs("span",{className:ai.selectedTestPrice,children:["",parseFloat(String(P.price)).toFixed(2)]}),i.jsx("button",{type:"button",onClick:()=>E(String(P.id)),className:ai.removeTestButton,title:"Remove Test",children:i.jsx(Hi,{size:16})})]},P.id))})]}),o.length>0&&i.jsxs("div",{className:ai.totalAmount,children:["Total: ",o.reduce((P,I)=>P+parseFloat(String(I.price)),0).toFixed(2)]})]}),i.jsxs("div",{className:ai.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${ai.button} ${ai.buttonSecondary}`,children:" Cancel "}),i.jsxs("button",{type:"button",onClick:k,disabled:o.length===0||v,className:`${ai.button} ${ai.buttonPrimary} ${o.length===0||v?ai.buttonDisabled:""}`,children:[" ",v?"Saving...":"Create Lab Order"," "]})]})]})}):null},HY="_modalOverlay_7kwn4_3",GY="_modalContent_7kwn4_29",YY="_modalHeader_7kwn4_61",WY="_modalTitle_7kwn4_79",QY="_modalCloseButton_7kwn4_93",JY="_modalBody_7kwn4_129",KY="_errorText_7kwn4_141",XY="_formGroup_7kwn4_161",ZY="_stickySearchHeader_7kwn4_173",eW="_inputField_7kwn4_211",tW="_searchResultsCard_7kwn4_253",nW="_searchResultsList_7kwn4_281",iW="_searchResultItem_7kwn4_293",rW="_searchResultPrice_7kwn4_323",aW="_selectedTestsCard_7kwn4_335",sW="_selectedTestsHeader_7kwn4_351",oW="_noTestsMessage_7kwn4_375",lW="_selectedTestsList_7kwn4_395",cW="_selectedTestItem_7kwn4_413",uW="_selectedTestHeader_7kwn4_441",dW="_selectedTestName_7kwn4_457",hW="_selectedTestInputs_7kwn4_469",fW="_inputGroup_7kwn4_481",pW="_quantityInput_7kwn4_503",mW="_removeTestButton_7kwn4_523",gW="_textareaField_7kwn4_559",yW="_modalFooter_7kwn4_573",xW="_button_7kwn4_591",bW="_buttonPrimary_7kwn4_615",vW="_buttonSecondary_7kwn4_637",wW="_buttonDisabled_7kwn4_659",_n={modalOverlay:HY,modalContent:GY,modalHeader:YY,modalTitle:WY,modalCloseButton:QY,modalBody:JY,errorText:KY,formGroup:XY,stickySearchHeader:ZY,inputField:eW,searchResultsCard:tW,searchResultsList:nW,searchResultItem:iW,searchResultPrice:rW,selectedTestsCard:aW,selectedTestsHeader:sW,noTestsMessage:oW,selectedTestsList:lW,selectedTestItem:cW,selectedTestHeader:uW,selectedTestName:dW,selectedTestInputs:hW,inputGroup:fW,quantityInput:pW,removeTestButton:mW,textareaField:gW,modalFooter:yW,button:xW,buttonPrimary:bW,buttonSecondary:vW,buttonDisabled:wW},NW=({isOpen:e,onClose:n,patientId:t,pharmacyInventory:r,fetchPharmacyOrdersData:a})=>{const[o,l]=w.useState([]),[h,d]=w.useState(""),[u,f]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1),[k,T]=w.useState(""),E=w.useRef(null);w.useEffect(()=>{if(!h){f([]);return}const z=h.toLowerCase();f(r.filter(B=>B.name.toLowerCase().includes(z)).slice(0,10))},[h,r]),w.useEffect(()=>{E.current&&(E.current.style.height="auto",E.current.style.height=`${E.current.scrollHeight}px`)},[k]);const P=z=>{if(!z)return null;const B=z.match(/(?:\d+x)?(\d+)/);return B?parseInt(B[1],10):null},I=Pn.useMemo(()=>o.reduce((z,B)=>{const R=B.pack_price||0,U=B.loose_price||0,Y=(B.pack_quantity||0)*R,Z=(B.loose_quantity||0)*U;return z+Y+Z},0),[o]),q=async()=>{if(!t){b("Patient ID is missing.");return}if(o.length===0&&!k.trim()){b("Please select at least one medication or provide a prescription.");return}S(!0),b(null);try{const z={patient_id:t,items:o.map(R=>({drug_id:R.drug_id,name:R.name,pack_quantity:R.pack_quantity||0,loose_quantity:R.loose_quantity||0,price:R.price,pack_price:R.pack_price||0,loose_price:R.loose_price||0,total_price:(R.pack_quantity||0)*(R.pack_price||0)+(R.loose_quantity||0)*(R.loose_price||0),unit:R.unit})),prescription_for_unavailable_drugs:k,status:"pending",date:new Date().toISOString(),order_total:I},B=await de("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)});if(!B.ok){const R=await B.json().catch(()=>({}));throw new Error(R.message||`Failed to create pharmacy order: ${B.statusText}`)}await B.json(),a(t),n(),l([]),d(""),T("")}catch(z){b(`Pharmacy Order Creation Error: ${z.message}`)}finally{S(!1)}},$=z=>{if(o.some(Y=>Y.drug_id===z.id)){b(`${z.name} is already in the order.`),setTimeout(()=>b(null),3e3),d(""),f([]);return}const B=P(z.unit),R=Number(z.price)||0,U=R/(B||1);l(Y=>[...Y,{drug_id:z.id,name:z.name,price:z.price,pack_price:R,loose_price:U,pack_quantity:1,loose_quantity:0,unit:z.unit}]),d(""),f([])},L=z=>{l(B=>B.filter(R=>R.drug_id!==z))},F=(z,B,R)=>{l(U=>U.map(Y=>Y.drug_id===z?{...Y,[B]:R}:Y))};return e?i.jsx("div",{className:_n.modalOverlay,children:i.jsxs("div",{className:_n.modalContent,children:[i.jsxs("div",{className:_n.modalHeader,children:[i.jsx("h3",{className:_n.modalTitle,children:"Create New Pharmacy Order"}),i.jsx("button",{onClick:n,className:_n.modalCloseButton,children:i.jsx(In,{size:20})})]}),i.jsxs("div",{className:_n.modalBody,children:[i.jsxs("div",{className:`${_n.formGroup} ${_n.stickySearchHeader}`,children:[i.jsx("label",{htmlFor:"drug-search",children:"Add Medication"}),i.jsx("input",{type:"text",id:"drug-search",placeholder:"Search available drugs...",value:h,onChange:z=>d(z.target.value),className:_n.inputField}),h&&u.length>0&&i.jsx("div",{className:_n.searchResultsCard,children:i.jsx("ul",{className:_n.searchResultsList,children:u.map(z=>i.jsxs("li",{onClick:()=>$(z),className:_n.searchResultItem,children:[i.jsx("span",{children:z.name}),i.jsxs("span",{className:_n.searchResultPrice,children:["(",parseFloat(String(z.price)).toFixed(2),")"]})]},z.id))})})]}),g&&i.jsx("div",{className:_n.errorText,children:g}),i.jsxs("div",{className:_n.selectedTestsCard,children:[i.jsx("h4",{className:_n.selectedTestsHeader,children:"Selected Medications"}),o.length===0?i.jsx("p",{className:_n.noTestsMessage,children:"No medications added yet."}):i.jsx("ul",{className:_n.selectedTestsList,children:o.map(z=>i.jsxs("li",{className:_n.selectedTestItem,children:[i.jsxs("div",{className:_n.selectedTestHeader,children:[i.jsx("span",{className:_n.selectedTestName,children:z.name}),i.jsx("button",{type:"button",onClick:()=>L(z.drug_id),className:_n.removeTestButton,title:"Remove Medication",children:i.jsx(Hi,{size:16})})]}),i.jsxs("div",{className:_n.selectedTestInputs,children:[i.jsxs("div",{className:_n.inputGroup,children:[i.jsx("label",{children:"Packs"}),i.jsx("input",{type:"number",min:"0",value:z.pack_quantity,onChange:B=>F(z.drug_id,"pack_quantity",parseInt(B.target.value)||0),className:_n.quantityInput})]}),i.jsxs("div",{className:_n.inputGroup,children:[i.jsx("label",{children:"Loose"}),i.jsx("input",{type:"number",min:"0",value:z.loose_quantity,onChange:B=>F(z.drug_id,"loose_quantity",parseInt(B.target.value)||0),className:_n.quantityInput})]})]})]},z.drug_id))})]}),o.length>0&&i.jsxs("div",{className:_n.totalAmount,children:["Total: ",I.toFixed(2)]}),i.jsxs("div",{className:_n.formGroup,style:{marginTop:"20px"},children:[i.jsx("label",{htmlFor:"prescription-notes",children:"Prescription for Unavailable Drugs (Optional)"}),i.jsx("textarea",{id:"prescription-notes",ref:E,rows:1,value:k,onChange:z=>T(z.target.value),placeholder:"Enter any additional notes or prescription details...",className:`${_n.inputField} ${_n.textareaField}`})]})]}),i.jsxs("div",{className:_n.modalFooter,children:[i.jsx("button",{type:"button",onClick:n,className:`${_n.button} ${_n.buttonSecondary}`,children:" Cancel "}),i.jsx("button",{type:"button",onClick:q,disabled:o.length===0&&!k.trim()||v,className:`${_n.button} ${_n.buttonPrimary} ${o.length===0&&!k.trim()||v?_n.buttonDisabled:""}`,children:v?"Saving...":"Create Order"})]})]})}):null},SW="_modalOverlay_13u8a_1",jW="_modalContent_13u8a_45",_W="_modalHeader_13u8a_99",CW="_modalTitle_13u8a_117",kW="_modalCloseButton_13u8a_139",EW="_modalBody_13u8a_177",TW="_section_13u8a_197",AW="_sectionTitle_13u8a_209",DW="_settingsGrid_13u8a_233",PW="_inputWrapper_13u8a_253",IW="_label_13u8a_265",MW="_inputGroup_13u8a_277",RW="_inputIcon_13u8a_289",OW="_inputField_13u8a_303",LW="_inputFieldWithAction_13u8a_327",FW="_selectField_13u8a_345",$W="_searchArea_13u8a_363",zW="_searchResults_13u8a_371",BW="_searchItem_13u8a_425",UW="_drugName_13u8a_461",qW="_drugInfo_13u8a_471",VW="_medList_13u8a_483",HW="_medCard_13u8a_495",GW="_medCardHeader_13u8a_529",YW="_medName_13u8a_541",WW="_medCardGrid_13u8a_553",QW="_removeMedBtn_13u8a_565",JW="_errorBanner_13u8a_595",KW="_modalFooter_13u8a_621",XW="_btn_13u8a_639",ZW="_btnSecondary_13u8a_663",eQ="_btnPrimary_13u8a_683",tQ="_spinner_13u8a_717",nQ="_noMeds_13u8a_747",Et={modalOverlay:SW,modalContent:jW,modalHeader:_W,modalTitle:CW,modalCloseButton:kW,modalBody:EW,section:TW,sectionTitle:AW,settingsGrid:DW,inputWrapper:PW,label:IW,inputGroup:MW,inputIcon:RW,inputField:OW,inputFieldWithAction:LW,selectField:FW,searchArea:$W,searchResults:zW,searchItem:BW,drugName:UW,drugInfo:qW,medList:VW,medCard:HW,medCardHeader:GW,medName:YW,medCardGrid:WW,removeMedBtn:QW,errorBanner:JW,modalFooter:KW,btn:XW,btnSecondary:ZW,btnPrimary:eQ,spinner:tQ,noMeds:nQ},AE=({isOpen:e,onClose:n,recurringMedication:t,onUpdate:r,inventory:a})=>{const[o,l]=w.useState([]),[h,d]=w.useState(30),[u,f]=w.useState("active"),[g,b]=w.useState(""),[v,S]=w.useState(""),[k,T]=w.useState([]),[E,P]=w.useState(!1),[I,q]=w.useState(null);w.useEffect(()=>{e&&t&&(l([...t.medications]),d(t.frequency_days||30),f(t.status),b(new Date(t.next_delivery_date).toISOString().split("T")[0]),q(null))},[e,t]),w.useEffect(()=>{if(v.trim().length>1){const B=v.toLowerCase(),R=a.filter(U=>U.name&&U.name.toLowerCase().includes(B)).slice(0,5);T(R)}else T([])},[v,a]);const $=B=>{if(o.some(Y=>Y.drug_id===B.id)){q(`${B.name} is already in the list.`);return}const U={drug_id:B.id,name:B.name,pack_quantity:1,loose_quantity:0,pack_price:B.price,unit:B.unit,total_price:B.price};l([...o,U]),S(""),T([]),q(null)},L=B=>{const R=[...o];R.splice(B,1),l(R)},F=(B,R,U)=>{const Y=[...o];R==="pack_quantity"||R==="loose_quantity"||R==="tabletsPerDay"||R==="numberOfDays"?Y[B]={...Y[B],[R]:Math.max(0,Number(U))}:Y[B]={...Y[B],[R]:U},l(Y)},z=async()=>{if(o.length===0){q("Please add at least one medication.");return}P(!0),q(null);try{const B=await de(`/api/recurring-medications/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({medications:o,frequency_days:h,status:u,next_delivery_date:g})});if(!B.ok){const U=await B.json();throw new Error(U.message||"Failed to update recurring medication")}const R=await B.json();r(R),n()}catch(B){q(B.message)}finally{P(!1)}};return e?i.jsx("div",{className:Et.modalOverlay,children:i.jsxs("div",{className:Et.modalContent,children:[i.jsxs("div",{className:Et.modalHeader,children:[i.jsx("h2",{className:Et.modalTitle,children:"Edit Recurring Medication"}),i.jsx("button",{onClick:n,className:Et.modalCloseButton,title:"Close",children:i.jsx(In,{size:24})})]}),i.jsxs("div",{className:Et.modalBody,children:[I&&i.jsxs("div",{className:Et.errorBanner,children:[i.jsx(ui,{size:18}),i.jsx("span",{children:I})]}),i.jsxs("div",{className:Et.section,children:[i.jsxs("div",{className:Et.sectionTitle,children:[i.jsx(sc,{size:14}),i.jsx("span",{children:"Subscription Settings"})]}),i.jsxs("div",{className:Et.settingsGrid,children:[i.jsxs("div",{className:Et.inputWrapper,children:[i.jsx("label",{className:Et.label,children:"Frequency (Days)"}),i.jsxs("div",{className:Et.inputGroup,children:[i.jsx(sc,{size:16,className:Et.inputIcon}),i.jsx("input",{type:"number",value:h,onChange:B=>d(parseInt(B.target.value,10)||1),className:Et.inputField,min:"1"})]})]}),i.jsxs("div",{className:Et.inputWrapper,children:[i.jsx("label",{className:Et.label,children:"Subscription Status"}),i.jsx("div",{className:Et.inputGroup,children:i.jsxs("select",{value:u,onChange:B=>f(B.target.value),className:`${Et.inputField} ${Et.inputFieldWithAction} ${Et.selectField}`,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"paused",children:"Paused"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]})})]}),i.jsxs("div",{className:Et.inputWrapper,children:[i.jsx("label",{className:Et.label,children:"Next Delivery Date"}),i.jsxs("div",{className:Et.inputGroup,children:[i.jsx(Bf,{size:16,className:Et.inputIcon}),i.jsx("input",{type:"date",value:g,onChange:B=>b(B.target.value),className:Et.inputField})]})]})]})]}),i.jsxs("div",{className:Et.section,children:[i.jsxs("div",{className:Et.sectionTitle,children:[i.jsx(Ai,{size:14}),i.jsx("span",{children:"Add & Manage Medications"})]}),i.jsxs("div",{className:Et.searchArea,children:[i.jsxs("div",{className:Et.inputGroup,children:[i.jsx(Ai,{size:18,className:Et.inputIcon}),i.jsx("input",{type:"text",value:v,onChange:B=>S(B.target.value),placeholder:"Search pharmacy inventory...",className:Et.inputField})]}),k.length>0&&i.jsx("div",{className:Et.searchResults,children:k.map(B=>i.jsxs("div",{onClick:()=>$(B),className:Et.searchItem,children:[i.jsxs("div",{children:[i.jsx("div",{className:Et.drugName,children:B.name}),i.jsxs("div",{className:Et.drugInfo,children:["Stock: ",B.quantity_in_stock," | Unit: ",B.unit]})]}),i.jsxs("div",{className:Et.drugName,children:["",B.price]})]},B.id))})]}),i.jsxs("div",{className:Et.medList,children:[o.map((B,R)=>i.jsxs("div",{className:Et.medCard,children:[i.jsxs("div",{className:Et.medCardHeader,children:[i.jsx("span",{className:Et.medName,children:B.name}),i.jsx("button",{onClick:()=>L(R),className:Et.removeMedBtn,title:"Remove",children:i.jsx(Hi,{size:18})})]}),i.jsxs("div",{className:Et.medCardGrid,children:[i.jsxs("div",{className:Et.inputWrapper,children:[i.jsx("label",{className:Et.label,children:"Packs"}),i.jsx("input",{type:"number",value:B.pack_quantity||0,onChange:U=>F(R,"pack_quantity",U.target.value),className:`${Et.inputField} ${Et.inputFieldWithAction}`,placeholder:"0"})]}),i.jsxs("div",{className:Et.inputWrapper,children:[i.jsx("label",{className:Et.label,children:"Loose Qty"}),i.jsx("input",{type:"number",value:B.loose_quantity||0,onChange:U=>F(R,"loose_quantity",U.target.value),className:`${Et.inputField} ${Et.inputFieldWithAction}`,placeholder:"0"})]}),i.jsxs("div",{className:Et.inputWrapper,children:[i.jsx("label",{className:Et.label,children:"Days"}),i.jsx("input",{type:"number",value:B.numberOfDays||0,onChange:U=>F(R,"numberOfDays",U.target.value),className:`${Et.inputField} ${Et.inputFieldWithAction}`,placeholder:"0"})]}),i.jsxs("div",{className:Et.inputWrapper,children:[i.jsx("label",{className:Et.label,children:"Dosage (e.g. 1 tab/day for 10 days)"}),i.jsx("input",{type:"text",value:B.tabletsPerDay||"",onChange:U=>F(R,"tabletsPerDay",U.target.value),className:`${Et.inputField} ${Et.inputFieldWithAction}`,placeholder:"e.g. 1 tab/day..."})]}),i.jsxs("div",{className:Et.inputWrapper,children:[i.jsx("label",{className:Et.label,children:"Directions"}),i.jsx("input",{type:"text",value:B.directions_to_use||"",onChange:U=>F(R,"directions_to_use",U.target.value),className:`${Et.inputField} ${Et.inputFieldWithAction}`,placeholder:"Directions to use..."})]})]})]},R)),o.length===0&&i.jsxs("div",{className:Et.noMeds,children:[i.jsx(hl,{size:32,style:{marginBottom:"12px",opacity:.5}}),i.jsx("p",{children:"No medications added to this recurring subscription yet."})]})]})]})]}),i.jsxs("div",{className:Et.modalFooter,children:[i.jsx("button",{onClick:n,className:`${Et.btn} ${Et.btnSecondary}`,children:"Cancel"}),i.jsxs("button",{onClick:z,disabled:E,className:`${Et.btn} ${Et.btnPrimary}`,children:[E?i.jsx("div",{className:Et.spinner}):i.jsx(oc,{size:18}),E?"Saving Changes...":"Save Subscription"]})]})]})}):null},Lx=e=>{if(!e)return"";let n=e.toLowerCase();return n=n.replace(/\b(mg|g|ml|iu|unit|tabs|tablet|tablets|capsule|capsules|injection|injections|syrup|solution|cream|ointment|lotion|spray|drops|patch|suppository|vial|ampoule|bottle|pack|kit)\b/g,""),n=n.replace(/\b(test|panel|profile|assay|screen|analysis|level|count|culture)\b/g,""),n=n.replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim(),n},Rd=(e,n)=>{if(!e||!n||n.length===0)return;const t=Lx(e);let r=n.find(l=>Lx(l.name)===t);if(r)return r;let a=n.find(l=>Lx(l.name).includes(t));if(a)return a;let o=n.find(l=>t.includes(Lx(l.name)));if(o)return o},iQ=`You are an expert OPD (Outpatient Department) medical assistant for a Doctor in a clinic in India. You will receive all the medical data of the patient including complaints (history), labs, pharmacy orders, etc., along with their date and time. Your primary goal is to assist the doctor and analyze patient chief complaints (Co), provide a structured clinical assessment including lab test suggestions (Lx), differential diagnoses (Dx), and a treatment plan (Tx). You have access to tools (actions) to order lab tests and pharmacy items, and update patient details.



**1. Definitions:**
   - Co: Chief complaints
   - Pt: Patient (assume living in India)
   - Lx: Laboratory tests
   - Dx: Differential Diagnosis
   - Tx: Treatment Plan

**2. Workflow:**
   - Analyze Co, generate Lx, Dx, and Tx sections as described below.
   - **Prioritization for Orders:** Always prioritize using \`edit_pharmacy_order\` or \`edit_lab_order\` if there are existing pending orders for the patient, before considering \`create_pharmacy_order\` or \`create_lab_order\`.
   - using edit_lab_order edits the lab order with the given serial numnber use to add new tests to the existing order or remove the tests from existing order, marking the status affects all tests in the order not only the test,always use this tool if there are pending lab orders instead of creating new orders.
   - using edit_pharmacy_order edits the pharmacy order with the given serial numnber to add new items to the existing order, update existing items, or remove items (either by \`items_to_remove\` or by setting \`quantity\` to 0). Always use this tool if there are pending pharmacy orders instead of creating new orders.
   - If your Lx section suggests tests from the inventory, use the \`create_lab_order\` action, but only for tests that are both clinically required and have not already been ordered or are still pending. Skip tests that are already ordered and in pending.
   - If your Tx section prescribes medications, use the \`create_pharmacy_order\` action  but only for medications that are clinically required and have not already been prescribed or are still pending. Skip medications that are already dispensed or already ordered.
   - If your Tx section prescribes medications that are *not* available in the inventory, use the \`prescription_for_unavailable_drugs\` parameter within the \`create_pharmacy_order\` action to specify the prescription details for these unavailable drugs.
   - When ordering pharmacy items, specify both \`pack_quantity\` (number of full packs) and \`loose_quantity\` (number of individual units). The system will handle the conversion based on the drug's unit/pack size.
   - **Patient Details Management:** Always store or update patient name, age, sex, and phone number using the \`update_patient_details\` action. If patient name, age, or sex is received as 'New Patient - Direct Entry', 'N/A', or blank, treat it as missing data; if the user input provides anything resembling a name, age, or sex (e.g., shiva 25m, robin 50m, priya 19f), update them using the \`update_patient_details\` action. If details are missing, you can ask the user for the missing details using the \`ask_followup_question\` action.
   - Always update new complaints of the patient using the \`add_complaint_history\` action.
   - Use the \`edit_complaint\` action to modify existing complaints if the user corrects them or wants to delete them. You can update the text using \`new_complaint\` or remove the complaint entirely by setting \`delete: true\`. Use the \`serialNumber\` displayed in the history to identify the complaint.
   - **Patient Status & Queue Management:**
       - Use \`update_patient_status\` to manage patient admissions, discharge, and queue status.
       - \`status: "admit"\`: Use when a patient needs to be admitted to the clinic.
       - \`status: "discharge"\`: Use when an admitted patient is ready to leave.
       - \`status: "add_to_doctor_queue"\`: Use to add a patient to the doctor's queue.
       - \`status: "complete_consultation"\`: Use to mark the current doctor consultation as finished (sets status to 'seen').
       - Check the patient's current status and queue information provided in the prompt before suggesting these actions.
   - If you generate a concise summary of the patient's current situation based on the interaction and history, use the \`update_case_summary\` action to save it.
   - Remember, when you use \`update_case_summary\`, the previous case summary will be replaced by the new one, so you can use it like a short-term memory to store other stuff that **keeps changing**, like the current treatment plan, plan of action, active problems, or current vitals, etc.
   - When you use \`add_complaint_history\`, it will add the complaint to the previous ones. You will be given all the previous complaints back in every query, so you can use it to store other long-term facts that do **not change**, like the history of a chronic illness, surgical history, allergies, or social history, etc.
   - while placing or editing a pharmacy order make sure to set the \`pack_quantity\` and \`loose_quantity\` right.
   - Use the \`update_clinic_ai_memory\` action to store or update **various types of clinic-wide persistent information in a concise way**. This can include 'summaries of common patient encounters'+'summeries of previous **Clinic-wide AI Memory**'(e.g., 'Patient X, 50m, chronic gastritis, last visit YYYY-MM-DD, prescribed Z, follow-up in N days'+'**Clinic-wide AI Memory** summary'), notes on local health trends, common diagnostic patterns observed in the clinic, specific operational protocols. This memory is shared across all interactions for the clinic and helps tailor responses to its specific context over time.
    - **Recurring Medications Management:**
        - Use \`create_recurring_medication\` only when specifically asked to make a treatment or order recurring. It takes the same items structure as pharmacy orders but also requires \`frequency_days\` and \`next_delivery_date\`.
         - Use \`edit_recurring_medication\` to update an existing recurring medication entry. You must use \`serialNumber\` from the provided list.
        - Use \`delete_recurring_medication\` to stop/remove a recurring medication using its \`serialNumber\`.
    - **Lab Reports & Results Entry:**
        - Always check \`labHistory\` for existing orders.
        - If an order exists for a test (e.g., serial number 3), use \`edit_lab_report\` with \`serialNumber: 3\` to enter results.
        - If no order exists, use \`create_lab_report\` to automatically create the order and submit the report in one step.
        - Provide results in the \`results\` array, specifying the \`testName\` and a dictionary of \`parameters\` (key-value pairs of parameter name and value).
        - You can see the required parameters and their normal ranges in the \`Available Lab Tests\` inventory list.
    - **Action Wrappers:** Your JSON array **MUST** start with \`{ "action": "first_action" }\` and end with \`{ "action": "last_action" }\`. Any response not following this structure will be **IGNORED** by the system.
    - **No Action Required / Loop Prevention:** If the user's input does not require any of the specific actions listed above (e.g., simple conversation, acknowledgement, or if you have already performed the necessary actions and are just responding), you **MUST** use the \`blank_action\`. This is CRITICAL to prevent the system from getting stuck in a loop waiting for an action. Never return an empty JSON array; if nothing else applies, return \`[{ "action": "first_action" }, { "action": "blank_action" }, { "action": "last_action" }]\`.
**3.**Multiple Actions:** You can perform multiple actions (like ordering labs AND meds, adding complaints, updating patient information, and asking a follow-up question) in a single response by including multiple action objects within the main JSON array.


**4. Chief Complaints (Co):**
   - Analyze the provided chief complaints.
   - Present them in a table with two columns: 'Relevant Complaint (Score 8-10)' and 'Irrelevant Complaint (Score 0-7)', based on clinical relevance.

**5. Lab Tests (Lx):**
   - Suggest the most probable basic lab tests based on the clinical picture, ordered by likelihood.
   - If a basic test is positive/abnormal, suggest relevant advanced tests.
   - **Inventory Check:** Compare suggested tests against the provided inventory list.
   - **Table 1: Available Lab Tests:** Present tests *available* in the inventory in a table with columns: '**Clinical Importance (High/Medium/Low)**', 'Lab Test'. If suggesting tests from this table, prepare to use the \`create_lab_order\` tool in your response.
   - **Table 2: Unavailable Lab Tests:** Present tests *not available* in the inventory in a separate table with columns: '**Clinical Importance (High/Medium/Low)**', 'Unavailable Basic Test'. Clearly state these are not orderable via the tool (generate Table 2 only when required tests are unavailable).

**6. Differential Diagnosis (Dx):**
   - List potential differential diagnoses.
   - Provide a confidence score (0-10) for each.
   - Present in a table with columns: 'Differential Diagnosis' and 'Confidence Score (0-10)'.

**7. Treatment Plan (Tx):**
   - Create a structured treatment plan including ideal medications based on the diagnosis.
   - **Inventory Check:** Compare prescribed medications against the provided inventory list.
   - **Table 1: Available Medications:** Present medications *available* in the inventory in a table with columns: 'Time Frame' (from and to dates), 'Treatment Goal', 'Intervention', 'Medication Type', 'Drug Form', 'Drug Name', 'Regimen (Dose, Freq)', 'Duration'. Before using the \`create_pharmacy_order\` tool, check if an order for the same drug has already been placed for this patient today. If an order already exists for today, do *not* create a duplicate order. If no order exists for today, prepare to use the \`create_pharmacy_order\` tool in your response.
   - **Table 2: Unavailable Medications:** Present medications *not available* in the inventory in a separate table with columns: 'Unavailable Drug Name', 'Ideal Regimen', 'Reasoning/Indication', '**Clinical Importance (High/Medium/Low)**', 'Suggested Available Substitute (from inventory, if possible)'. Clearly state these are not orderable via the tool (generate Table 2 only when required medications are unavailable in the inventory).

**8. Tools / Actions:**
   When you need to perform actions like ordering tests/meds, updating patient info, or adding history, use the following JSON array format. The response should ONLY contain this JSON array, nothing else.

   ****STRICT JSON****>>>>>>\`\`\`json
[
  { "action": "first_action" },
  { "action": "create_pharmacy_order", "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "prescription_for_unavailable_drugs": "string | null" },
  { "action": "edit_pharmacy_order", "serialNumber": number, "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "items_to_remove": [ { "drug_id": number | null, "name": "Drug Name" } ], "status": "pending" | "billed" | "dispensed" | "cancelled", "prescription_for_unavailable_drugs": "string | null" },
  { "action": "create_lab_order", "tests": [ { "name": "Test Name" } ] },
  { "action": "edit_lab_order", "serialNumber": number, "tests": [ { "name": "Test Name" } ], "items_to_remove": [ { "id": number | string | null, "name": "Test Name" } ], "status": "pending" | "billed" | "collected" | "processing" | "report_ready" | "completed" | "cancelled" | "reported" },
  { "action": "create_lab_report", "tests": [ { "name": "Test Name" } ], "results": [ { "testName": "Test Name", "parameters": { "ParamName": value } } ] },
  { "action": "edit_lab_report", "serialNumber": number, "results": [ { "testName": "Test Name", "parameters": { "ParamName": value } } ] },
  { "action": "add_complaint_history", "complaint": "Specific past complaint text..." },
  { "action": "edit_complaint", "serialNumber": number, "new_complaint": "Updated text...", "delete": boolean (optional) },
  { "action": "update_patient_details", "name": "New Name (optional)", "age": number (optional), "gender": "M" | "F" | "O" | null (optional), "phone_number": "string (optional)" },
   { "action": "update_case_summary", "summary": "Concise summary text..." },
  { "action": "update_clinic_ai_memory", "memory_content": "New clinic-wide AI memory content..." },
  { "action": "update_patient_status", "status": "admit" | "discharge" | "add_to_doctor_queue" | "complete_consultation" },
  { "action": "create_recurring_medication", "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "frequency_days": number, "next_delivery_date": "YYYY-MM-DD" },
  { "action": "edit_recurring_medication", "serialNumber": number, "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "items_to_remove": [ { "drug_id": number | null, "name": "Drug Name" } ], "status": "active" | "paused" | "cancelled", "frequency_days": number, "next_delivery_date": "YYYY-MM-DD" },
  { "action": "delete_recurring_medication", "serialNumber": number },
  { "action": "end_loop" }, /* NEVER send this in the same array as other actions. Wait for the system feedback saying "Action successful" in the NEXT turn, then send ONLY [first_action, end_loop, last_action]. */
  { "action": "blank_action" },
  { "action": "last_action" }
]
\`\`\`

   - **Autolooping & End Loop:** This system supports "Autolooping". You can perform actions, get results, and then decide to perform MORE actions based on those results.
     - When you are finished with the entire user request and no further actions are needed, you **MUST** use the \`end_loop\` action.
     - If you just want to talk (no actions), you can use \`blank_action\` or just \`end_loop\` immediately if no further processing is needed. But prefers \`end_loop\` to signal explicit completion.
     - **Do not stop** until the task is fully complete.
   - **Multiple Actions in One Response:** You can include multiple action objects within this single JSON array if several actions are required based on your analysis (e.g., adding history AND ordering labs).
   - **Prioritization Within the Array:** If including multiple actions, order them within the array according to this priority:
     1. \`add_complaint_history\`
     2. \`update_patient_details\`
     3. \`update_case_summary\`
      4. \`update_clinic_ai_memory\`
      5. \`update_patient_status\`
      6. \`create_lab_order\`
      7. \`edit_lab_order\`
      8. \`create_pharmacy_order\`
      9. \`edit_pharmacy_order\`
   - **Example (Multiple Actions):**
     \`\`\`json
     [
       { "action": "add_complaint_history", "complaint": "Patient also reports mild fever since yesterday." },
       { "action": "create_lab_order", "tests": [ { "name": "CBC" } ] }
     ]
     \`\`\`

   - **\`ask_followup_question\`**: Use this tool format inside the standard JSON array with wrappers.
     \`\`\`json
[
  { "action": "first_action" },
  {
    "action": "ask_followup_question",
    "question": "Your clear, specific question here.",
    "options": ["Optional Answer 1", "Optional Answer 2"] // Optional
  },
  { "action": "last_action" }
]
     \`\`\`
     *Description:* Ask the user a question to gather additional information needed to complete the task. This tool should be used when you encounter ambiguities, need clarification, or require more details to proceed effectively. It allows for interactive problem-solving by enabling direct communication with the user. Use this tool judiciously to maintain a balance between gathering necessary information and avoiding excessive back-and-forth.
     *Parameters:*
       - question: (required) The question to ask the user. This should be a clear, specific question that addresses the information you need.
       - options: (optional) An array of 2-5 options for the user to choose from. Each option should be a string describing a possible answer. You may not always need to provide options, but it may be helpful in many cases where it can save the user from having to type out a response manually.


**Important:**
- Ensure all tables are clearly formatted using Markdown.
- Strictly adhere to the inventory constraints for labs and medications when deciding whether to use \`create_lab_order\` or \`create_pharmacy_order\`.
- When using actions, provide ONLY the JSON array (or the single JSON object for \`ask_followup_question\`) as the *very last* part of your response, after all other content including tables. Do not include any other text after the JSON.

**Plan Mode:**
When the user asks a question about a patient's condition or general medical topics (not entering new medical data), respond in PLAN MODE. In this mode, focus on answering the user's inquiry, clarifying their request, brainstorming ideas, or architecting a solution (like exploring treatment options). Ask clarifying questions if needed. Present detailed plans or explanations **using clear table formats and markdown (like bolding) for easy readability**. Engage in back-and-back discussion to finalize details. Do not use action tools (\`create_lab_order\`, \`create_pharmacy_order\`, \`add_complaint_history\`, \`update_patient_details\`) while in PLAN MODE).`,rQ="gemini-3-flash-preview";async function aQ(){const e=Vf();if(!e)throw new Error("Authentication token not found. Please log in.");try{const r=(await(await de("/api/clinics/settings",{headers:{Authorization:`Bearer ${e}`}})).json()).gemini_api_key;if(r)return console.log("Using clinic-specific Gemini API key."),r}catch(n){console.warn("Failed to fetch clinic-specific Gemini API key, trying global fallback.",n)}try{const r=(await(await de("/api/super-admin-settings/gemini-api-key",{headers:{Authorization:`Bearer ${e}`}})).json()).gemini_api_key;if(r)return console.log("Using global Gemini API key."),r}catch(n){console.warn("Failed to fetch global Gemini API key.",n)}throw new Error("Gemini API key not found. Please contact your administrator.")}let R0=null;async function sQ(){if(!R0){const e=await aQ();R0=new Ub({apiKey:e})}return R0}async function oQ(e,n){const{query:t,currentDateTime:r,patientName:a,patientAge:o,patientGender:l,case_summary:h,case_summary_last_updated:d,clinic_ai_memory:u,clinic_ai_memory_last_updated:f,clinic_wide_system_prompt:g,labHistory:b,pharmacyOrders:v,pastComplaints:S,recurringMedications:k,pharmacyInventory:T,labInventory:E,patientStatus:P,isAdmitted:I,isInQueueToday:q,admissionDate:$,dischargeDate:L}=e;let F=`Patient Complaint: ${t}`;if(h&&(F+=`

--- Case Summary (Provided by Doctor) ---
${h}`,d))try{const W=new Date(d).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});F+=`
(Last Updated: ${W})`}catch{console.warn(`Could not format case_summary_last_updated: ${d}`),F+=`
(Last Updated: ${d})`}if(a&&(F+=`

Patient Name: ${a}`),o!=null&&(F+=`
Patient Age: ${o}`),l&&(F+=`
Patient Gender: ${l}`),P&&(F+=`
Patient Current Status: ${P}`),F+=`
Patient Admitted: ${I?"Yes":"No"}`,$&&(F+=`
Admission Date: ${$}`),L&&(F+=`
Discharge Date: ${L}`),F+=`
In Doctor Queue Today: ${q?"Yes":"No"}`,r)try{const W=new Date(r).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});F+=`

Current Interaction Time: ${W}`}catch{console.warn(`Could not format currentDateTime: ${r}`),F+=`

Current Interaction Time: ${r}`}if(u&&(F+=`

--- Clinic-wide AI Memory/Context ---
${u}`,f))try{const W=new Date(f).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});F+=`
(Last Updated: ${W})`}catch{console.warn(`Could not format clinic_ai_memory_last_updated: ${f}`),F+=`
(Last Updated: ${f})`}let z="";b&&Array.isArray(b)&&b.length>0&&(z=`

--- Lab History (Orders & Reports) ---
`,b.forEach(W=>{let H="Unknown Date";try{H=new Date(W.orderDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab order: ${W.orderDate}`)}if(z+=`
Order #${W.serialNumber} Date: ${H} (Status: ${W.status})
`,z+=`Tests: ${W.tests.map(he=>he.name).join(", ")}
`,W.report){let he="Unknown Date";try{he=new Date(W.report.reportDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab report: ${W.report.reportDate}`)}z+=`  -> Report Date: ${he}
`,W.report.tests&&Array.isArray(W.report.tests)?(z+=`     Findings:
`,W.report.tests.forEach(D=>{z+=`       - Test: ${D.testName}
`,D.parameters&&Array.isArray(D.parameters)&&D.parameters.forEach(te=>{z+=`         - ${te.name}: ${te.value} (Normal: ${te.normal_range})
`})})):(z+=`     Findings: ${W.report.reportContent||"N/A"}
`,W.report.error&&(z+=`     Note: ${W.report.error}
`))}z+=`---
`}),F+=z);let B="";v&&Array.isArray(v)&&v.length>0&&(B=`

--- Recent Pharmacy Orders ---
`,v.forEach(W=>{let H="Unknown Date/Time";try{H=new Date(W.date).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for pharmacy order: ${W.date}`)}B+=`
Order #${W.serialNumber} Date/Time: ${H} (Status: ${W.status})
`,B+=`Prescribed By: ${W.prescribedBy||"N/A"}
`,W.dispensedBy&&(B+=`Dispensed By: ${W.dispensedBy}
`),B+=`Medications:
`,W.medications.forEach(he=>{B+=`  - ${he.name} (Qty: ${he.quantity}`,he.tabletsPerDay&&(B+=`, ${he.tabletsPerDay}/day`),he.numberOfDays&&(B+=` for ${he.numberOfDays} days`),B+=`)
`}),W.prescriptionForUnavailableDrugs&&(B+=`  Prescription for Unavailable Drugs: ${W.prescriptionForUnavailableDrugs}
`),B+=`---
`}),F+=B);let R="";S&&Array.isArray(S)&&S.length>0&&(R=`

--- Past Complaints History ---
`,S.forEach(W=>{let H="Unknown Date/Time";try{H=new Date(W.createdAt).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for past complaint: ${W.createdAt}`)}R+=`
Id: ${W.serialNumber}
Date/Time: ${H}
Complaint: ${W.complaint||"N/A"}
---
`}),F+=R);let U="";k&&Array.isArray(k)&&k.length>0&&(U=`

--- Recurring Medications ---
`,[...k].sort((H,he)=>new Date(H.next_delivery_date).getTime()-new Date(he.next_delivery_date).getTime()).forEach((H,he)=>{var D;U+=`
#${he+1} Status: ${H.status}, Freq: ${H.frequency_days} days, Next: ${H.next_delivery_date}
`,(D=H.medications)==null||D.forEach(te=>{U+=`  - ${te.name} (Qty: ${te.pack_quantity||0}P / ${te.loose_quantity||0}L, ${te.tabletsPerDay}/day for ${te.numberOfDays} days)
`}),U+=`---
`}),F+=U);let Y="";T&&Array.isArray(T)&&T.length>0&&(Y=`

--- Current Pharmacy Inventory (Stock Levels) ---
`,T.forEach(W=>{Y+=`- ${W.name} (Pack: ${W.unit??"N/A"}): ${W.quantity_in_stock??"N/A"}
`}),F+=Y);let Z="";E&&Array.isArray(E)&&E.length>0&&(Z=`

--- Available Lab Tests & Parameters (Use these for reports) ---
`,E.forEach(W=>{Z+=`- ${W.name} (Price: ${W.price??"N/A"})
`,W.default_parameters&&Array.isArray(W.default_parameters)&&W.default_parameters.forEach(H=>{let he="N/A";H.lower_limit!=null||H.upper_limit!=null?(he="",H.lower_limit!=null&&(he+=`> ${H.lower_limit}`),H.lower_limit!=null&&H.upper_limit!=null&&(he+=" - "),H.upper_limit!=null&&(he+=`< ${H.upper_limit}`),he=he.trim()):H.normal_range&&(he=H.normal_range),Z+=`  * ${H.name} (${H.unit||"unitless"}): [Normal Range: ${he}]
`})}),F+=Z);const ne=[{text:iQ}];g&&g.trim()!==""&&ne.push({text:`--- Additional Clinic-Specific Instructions ---
${g}`});const ae=[{text:F}];if(n){const W=new FileReader,H=await new Promise((he,D)=>{W.onloadend=()=>{typeof W.result=="string"?he(W.result.split(",")[1]):D(new Error("Failed to read image file as base64."))},W.onerror=D,W.readAsDataURL(n)});ae.push({inlineData:{mimeType:n.type,data:H}})}const X=[];ne.length>0&&X.push({role:"user",parts:ne}),X.push({role:"user",parts:ae});try{const W={model:rQ,contents:X,generationConfig:{temperature:.7,maxOutputTokens:1024,responseMimeType:"text/plain"}},he=await(await sQ()).models.generateContentStream(W);let D="";for await(const te of he)if(te&&typeof te.text=="function"){const ve=te.text;ve&&(D+=ve)}else te&&te.candidates&&te.candidates[0]&&te.candidates[0].content&&te.candidates[0].content.parts&&te.candidates[0].content.parts[0]&&te.candidates[0].content.parts[0].text&&(D+=te.candidates[0].content.parts[0].text);if(D&&D.trim()!=="")return D.trim();throw console.error("Empty or invalid response received from Gemini API stream."),new Error("Failed to get suggestion from AI (Gemini). Empty or invalid stream response.")}catch(W){console.error("Error calling Gemini API:",W);let H="Failed to get suggestion from Gemini.";throw W.message&&(H=`Error processing Gemini request: ${W.message}`),new Error(H)}}const x_=3,O0=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return n?parseInt(n[1],10):1},lQ=(e,n,t,r="non-black")=>{if(isNaN(e)||isNaN(n)||e<=0||n<=0)return null;let a;return t==="female"?e<=.7?a=141*Math.pow(e/.7,-.329)*Math.pow(.993,n):a=141*Math.pow(e/.7,-1.209)*Math.pow(.993,n):e<=.9?a=141*Math.pow(e/.9,-.411)*Math.pow(.993,n):a=141*Math.pow(e/.9,-1.209)*Math.pow(.993,n),r==="black"&&(a*=1.018),parseFloat(a.toFixed(2))},cQ=(e,n,t)=>isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0||t>=400?null:parseFloat((e-n-t/5).toFixed(2)),uQ=(e,n)=>isNaN(e)||isNaN(n)||e<0||n<0?null:parseFloat((e-n).toFixed(2)),dQ=(e,n)=>isNaN(e)||isNaN(n)||e<0||n<0?null:parseFloat((e-n).toFixed(2)),hQ=(e,n,t)=>isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0?null:parseFloat((e-(n+t)).toFixed(2)),fQ=(e,n,t)=>isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0?null:parseFloat((2*e+n/18+t/2.8).toFixed(2)),b_=(e,n,t)=>{const r={...e},a=parseFloat(r.Creatinine);if(!isNaN(a)&&n!==null&&t!==null){const E=lQ(a,n,t);E!==null&&(r.eGFR=E)}const o=parseFloat(r["Total Cholesterol"]),l=parseFloat(r["HDL Cholesterol"]),h=parseFloat(r.Triglycerides);if(!isNaN(o)&&!isNaN(l)&&!isNaN(h)){const E=cQ(o,l,h);E!==null&&(r["LDL Cholesterol"]=E)}const d=parseFloat(r["Total Bilirubin"]),u=parseFloat(r["Direct Bilirubin"]);if(!isNaN(d)&&!isNaN(u)){const E=uQ(d,u);E!==null&&(r["Indirect Bilirubin"]=E)}const f=parseFloat(r["Total Protein"]),g=parseFloat(r.Albumin);if(!isNaN(f)&&!isNaN(g)){const E=dQ(f,g);E!==null&&(r.Globulin=E)}const b=parseFloat(r.Sodium),v=parseFloat(r.Chloride),S=parseFloat(r.Bicarbonate);if(!isNaN(b)&&!isNaN(v)&&!isNaN(S)){const E=hQ(b,v,S);E!==null&&(r["Anion Gap"]=E)}const k=parseFloat(r.Glucose),T=parseFloat(r.BUN);if(!isNaN(b)&&!isNaN(k)&&!isNaN(T)){const E=fQ(b,k,T);E!==null&&(r.Osmolality=E)}return r},pQ=w.forwardRef((e,n)=>{const{recordId:t,patientId:r,patientDetails:a,caseSummary:o,clinicSettings:l,selectedImageFile:h,pendingLabOrders:d,labReports:u,pharmacyOrders:f,recurringMedications:g,pharmacyInventory:b,labInventory:v,setAiResponse:S,setAiResponseText:k,setAiResponseJsonString:T,setShowAiJsonDetails:E,setIsLoadingAi:P,setCaseSummary:I,setCaseSummaryUpdatedAt:q,setFollowUpQuestion:$,setFollowUpOptions:L,setError:F,setIsSavingAiResponse:z,setSaveAiResponseError:B,fetchPharmacyOrdersData:R,fetchPendingLabOrdersData:U,fetchLabReportsData:Y,fetchPastComplaintsData:Z,fetchRecurringMedicationsData:ne,fetchPatientDetails:ae,setClinicSettings:X,setEditedAiMemory:W,handleDeleteItem:H,handleAdmitDischargePatient:he,handleCompleteConsultation:D,handleAddToQueue:te,setCanUndoAi:ve,addMessageToHistory:M,clearConversationHistory:ge,pastComplaints:_e}=e,[se,ee]=Pn.useState([]),oe=Pn.useRef(e);Pn.useEffect(()=>{oe.current=e});let ue;const Ee=async(Ge,Se,qe,Ue=0,ze=0)=>{let lt;const pt=["AI response did not contain a recognized function call","AI response did not result in a recognized or performed function call"].some(Te=>{var ie;return(ie=Se.message)==null?void 0:ie.includes(Te)});qe&&pt?lt=`AI Error: ${Se.message}

${qe}`:(lt=`I encountered a frontend error while trying to execute the '${Ge}' function. The error message is: "${Se.message}". Based on this error, please analyze what went wrong and either correct the function call and try again, or explain the problem.`,(Ge==="create_pharmacy_order"||Ge==="edit_pharmacy_order")&&(lt+=`

IMPORTANT: When ordering medication, please first check if the medication ordered matches the exact name given in the inventory. If the name itself is not given in the inventory, you can also use 'prescription_for_unavailable_drugs' to write a prescription for unavailable drugs.`),qe&&(lt+=`

The original AI response that caused the error was:
\`\`\`
${qe}
\`\`\``)),await ue(lt,Ue+1,ze)},Ie=async(Ge,Se,qe,Ue)=>{var Qe;let ze=!1,lt=!0;const Ke=[];let pt=null;if(Ge.some(we=>we.action==="end_loop")&&(lt=!1,ge&&ge(),Ge=Ge.filter(we=>we.action!=="end_loop"),Ge.length===0))return{success:!0,shouldContinueLoop:!1};for(const we of Ge){if(we.action==="first_action"||we.action==="last_action"){ze=!0,Ke.push(Promise.resolve({action:we.action,success:!0}));continue}if(we.action==="ask_followup_question"){pt=we,ze=!0,lt=!1,Ke.push(Promise.resolve({action:"ask_followup_question",success:!0,resultSummary:`Asked follow-up question: "${we.question}"`}));continue}we.action==="update_clinic_ai_memory"&&typeof we.memory_content=="string"?(ze=!0,Ke.push((async()=>{try{if(!l)throw new Error("Clinic settings not loaded, cannot update AI memory.");const Pe={...l,aiMemory:we.memory_content.trim(),admissionCharge:l.admissionCharge,perDayCharge:l.perDayCharge,otherCharges:l.otherCharges,clinicWideSystemPrompt:l.clinicWideSystemPrompt},Je=await de("/api/clinics/settings",{method:"PUT",body:JSON.stringify(Pe)});if(!Je.ok){const ft=await Je.json().catch(()=>({}));throw new Error(ft.message||`AI-triggered clinic memory update failed: ${Je.statusText}`)}const at=await Je.json();return X({admissionCharge:parseFloat(at.settings.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(at.settings.perDayCharge||0).toFixed(2),otherCharges:parseFloat(at.settings.otherCharges||0).toFixed(2),aiMemory:at.settings.aiMemory||"",aiMemoryUpdatedAt:at.settings.aiMemoryUpdatedAt||null,clinicWideSystemPrompt:at.settings.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:at.settings.clinicWideSystemPromptUpdatedAt||null}),W(at.settings.aiMemory||""),{action:"update_clinic_ai_memory",success:!0,resultSummary:"Clinic AI memory updated."}}finally{}})())):we.action==="create_pharmacy_order"&&(Array.isArray(we.items)||we.prescription_for_unavailable_drugs&&we.prescription_for_unavailable_drugs.trim()!=="")?(ze=!0,Ke.push((async()=>{var Pe;try{if(!r)throw new Error("Missing patient ID for pharmacy order.");const Je=[];let at=null;if(Array.isArray(we.items))for(const We of we.items){const{pack_price:ct,loose_price:dt,total_price:wt,price:bt,...kt}=We;let Tt;if(kt.drug_id?Tt=b.find(Qn=>Qn.id===kt.drug_id):kt.name&&(Tt=Rd(kt.name,b)),!Tt){at=`Drug "${kt.name||kt.drug_id||"Unknown"}" not found or no close match.`;break}let It;const mt=kt.tabletsPerDay;if(mt&&Number(mt)>0){const Qn=Number(mt);Number.isInteger(Qn)?It=Qn:It=null}else It=1;const $t=Number(kt.numberOfDays)||1,en=Number(kt.pack_quantity)||0,be=Number(kt.loose_quantity)||0;if(en<=0&&be<=0){at=`Invalid quantity for ${Tt.name}. Pack quantity or loose quantity must be greater than 0.`;break}const nt=Tt.unit,Ze=O0(nt),Pt=Number(Tt.price),Ut=Pt,hn=Ze>0?Pt/Ze:0,Ln=en*Ut+be*hn;Je.push({drug_id:Tt.id?String(Tt.id):null,name:Tt.name,pack_quantity:en,loose_quantity:be,tabletsPerDay:It,numberOfDays:$t,price:Pt,directions_to_use:kt.directions_to_use||void 0,box_number:kt.box_number||void 0,isLoose:kt.isLoose||void 0,unit:nt||void 0,pack_price:parseFloat(Ut.toFixed(2)),loose_price:parseFloat(hn.toFixed(2)),total_price:parseFloat(Ln.toFixed(2))})}if(at)throw new Error(at);const ft=Je.reduce((We,ct)=>We+ct.total_price,0),Ae={patient_id:r,items:Je.map(({drug_id:We,name:ct,pack_quantity:dt,loose_quantity:wt,tabletsPerDay:bt,numberOfDays:kt,directions_to_use:Tt,box_number:It,isLoose:mt,unit:$t,pack_price:en,loose_price:be,total_price:nt})=>({drug_id:We,name:ct,pack_quantity:dt,loose_quantity:wt,tabletsPerDay:bt,numberOfDays:kt,directions_to_use:Tt,box_number:It,isLoose:mt,unit:$t,pack_price:en,loose_price:be,total_price:nt})),prescription_for_unavailable_drugs:we.prescription_for_unavailable_drugs||null,order_total:parseFloat(ft.toFixed(2))},Ve=await de("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ae)});if(!Ve.ok){const We=await Ve.json().catch(()=>({}));throw new Error(We.message||`AI order creation failed: ${Ve.statusText}`)}const $e=await Ve.json();return r&&await R(r),{action:"create_pharmacy_order",success:!0,resultSummary:`Created Pharmacy Order: ${(Pe=$e.medications)==null?void 0:Pe.map(We=>`${We.name} (${We.pack_quantity||0}p, ${We.loose_quantity||0}l)`).join(", ")}.`,undo:async()=>{console.log(`Rolling back pharmacy order ${$e.id}`),await de(`/api/pharmacy-orders/${$e.id}`,{method:"DELETE"}),r&&await R(r)}}}finally{}})())):we.action==="update_patient_details"?(ze=!0,Ke.push((async()=>{P(!0),F(null);try{if(!r)throw new Error("Missing patient ID for updating details.");const Pe={...a},Je={};let at=!1;if(we.name!==void 0&&typeof we.name=="string"&&(Je.name=we.name,at=!0),we.age!==void 0&&typeof we.age=="number"&&(Je.age=we.age,at=!0),we.gender!==void 0&&typeof we.gender=="string"){if(!["M","F","O",null,""].includes(we.gender))throw new Error(`Invalid gender specified: "${we.gender}". Use M, F, or O.`);Je.gender=we.gender===""?null:we.gender,at=!0}if(we.phone_number!==void 0&&(typeof we.phone_number=="string"||we.phone_number===null)&&(Je.phone_number=we.phone_number,at=!0),!at)throw new Error("No valid patient details provided for update.");const ft=await de(`/api/patients/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Je)});if(!ft.ok){const Ae=await ft.json().catch(()=>({}));throw new Error(Ae.message||`AI patient update failed: ${ft.statusText}`)}return ae(r),{action:"update_patient_details",success:!0,resultSummary:`Updated patient details: ${Object.keys(Je).join(", ")}.`,undo:async()=>{console.log(`Reverting patient details for ${r}`);const Ae={};Je.name!==void 0&&(Ae.name=Pe.name),Je.age!==void 0&&(Ae.age=Pe.age),Je.gender!==void 0&&(Ae.gender=Pe.gender),Je.phone_number!==void 0&&(Ae.phone_number=Pe.phone||null),await de(`/api/patients/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ae)}),ae(r)}}}catch(Pe){return{action:"update_patient_details",success:!1,error:Pe}}finally{P(!1)}})())):we.action==="create_lab_order"&&Array.isArray(we.tests)&&we.tests.length>0?(ze=!0,Ke.push((async()=>{try{if(!r)throw new Error("Missing patient ID for lab order.");const Pe=[];let Je=null;for(const $e of we.tests){let We;if($e.id?We=v.find(dt=>String(dt.id)===String($e.id)):$e.name&&(We=Rd($e.name,v)),!We){Je=`Lab test "${$e.name||$e.id||"Unknown"}" not found or no close match.`;break}const ct=typeof We.price=="string"?parseFloat(We.price):We.price;Pe.push({id:We.id,name:We.name,price:ct,description:We.description,default_parameters:We.default_parameters})}if(Je)throw new Error(Je);const at={patient_id:r,tests:Pe.map($e=>({id:$e.id,name:$e.name,price:$e.price}))},ft=await de("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(at)});if(!ft.ok){const $e=await ft.json().catch(()=>({}));throw new Error($e.message||`AI lab order creation failed: ${ft.statusText}`)}const Ae=await ft.json(),Ve=Ae.labOrder?Ae.labOrder.id:Ae.id;return r&&await U(r),{action:"create_lab_order",success:!0,resultSummary:`Created Lab Order: ${Pe.map($e=>$e.name).join(", ")}.`,undo:async()=>{console.log(`Rolling back lab order ${Ve}`),Ve?(await de(`/api/lab/orders/${Ve}`,{method:"DELETE"}),r&&await U(r)):console.error("Cannot rollback lab order: ID is missing.")}}}finally{}})())):we.action==="edit_pharmacy_order"?(ze=!0,Ke.push((async()=>{try{const Pe=we.serialNumber;let Je;if(Pe?Je=[...f].sort((dt,wt)=>{const bt=new Date(dt.date).getTime(),kt=new Date(wt.date).getTime();return bt-kt})[Pe-1]:Je=f.sort((ct,dt)=>new Date(ct.date).getTime()-new Date(dt.date).getTime()).find(ct=>ct.status==="pending"),!Je)throw Pe?new Error(`Pharmacy order with serial number ${Pe} not found.`):new Error("No pending pharmacy orders found to edit.");const at=JSON.parse(JSON.stringify(Je)),ft=Je.id,Ae=we.items,Ve=we.items_to_remove,$e=we.status,We=we.prescription_for_unavailable_drugs;if((!Ae||Array.isArray(Ae)&&Ae.length===0)&&!Ve&&!$e&&(!We||We.trim()===""))throw new Error("No items, items to remove, status, or unavailable drugs prescription provided for pharmacy order edit.");if($e==="cancelled")return await H({type:"Pharmacy Order",data:Je}),{action:"edit_pharmacy_order",success:!0,undo:async()=>{console.warn("Cannot fully undo pharmacy order deletion yet. It requires re-creation.")}};{let ct=[...Je.medications];if(Array.isArray(Ve)&&Ve.length>0&&(ct=ct.filter(Tt=>{const It=Tt.name.toLowerCase().replace(/\s+/g," ").trim();return!Ve.some(mt=>{if(mt.drug_id&&String(Tt.drug_id)===String(mt.drug_id))return!0;if(mt.name){const $t=mt.name.toLowerCase().replace(/\s+/g," ").trim();return It===$t}return!1})})),Array.isArray(Ae)&&Ae.length>0)for(const Tt of Ae){const{pack_price:It,loose_price:mt,total_price:$t,price:en,...be}=Tt;let nt;if(be.drug_id?nt=b.find(Si=>Si.id===String(be.drug_id)):be.name&&(nt=Rd(be.name,b)),!nt)throw new Error(`Drug "${be.name||be.drug_id||"Unknown"}" not found or no close match for update.`);let Ze;const Pt=be.tabletsPerDay;if(Pt&&Number(Pt)>0){const Si=Number(Pt);Number.isInteger(Si)?Ze=Si:Ze=null}else Ze=1;const Ut=Number(be.numberOfDays)||1,hn=Number(be.pack_quantity)||0,Ln=Number(be.loose_quantity)||0,Qn=ct.findIndex(Si=>Si.drug_id&&Si.drug_id===(nt==null?void 0:nt.id)||Si.name.toLowerCase()===(nt==null?void 0:nt.name.toLowerCase()));if(hn<=0&&Ln<=0){Qn!==-1&&ct.splice(Qn,1);continue}const Oi={drug_id:nt.id?String(nt.id):null,name:nt.name,pack_quantity:hn,loose_quantity:Ln,tabletsPerDay:Ze,numberOfDays:Ut,price:nt.price,directions_to_use:be.directions_to_use||void 0,box_number:be.box_number||void 0,isLoose:be.isLoose||void 0,unit:nt.unit||void 0};Qn!==-1?ct[Qn]={...ct[Qn],...Oi}:ct.push(Oi)}const dt=ct.map(Tt=>{const It=b.find(Ze=>Ze.id===Tt.drug_id),mt=It?O0(It.unit):1,$t=Number(It==null?void 0:It.price)||0,en=$t,be=mt>0?$t/mt:0,nt=(Tt.pack_quantity||0)*en+(Tt.loose_quantity||0)*be;return{...Tt,pack_price:parseFloat(en.toFixed(2)),loose_price:parseFloat(be.toFixed(2)),total_price:parseFloat(nt.toFixed(2))}}),wt=dt.reduce((Tt,It)=>Tt+It.total_price,0),bt={};if(dt.length>0?bt.items=dt.map(({drug_id:Tt,name:It,pack_quantity:mt,loose_quantity:$t,tabletsPerDay:en,numberOfDays:be,directions_to_use:nt,box_number:Ze,isLoose:Pt,unit:Ut,pack_price:hn,loose_price:Ln,total_price:Qn})=>({drug_id:Tt,name:It,pack_quantity:mt,loose_quantity:$t,tabletsPerDay:en===null?null:en,numberOfDays:be,directions_to_use:nt,box_number:Ze,isLoose:Pt,unit:Ut,pack_price:hn,loose_price:Ln,total_price:Qn})):Ae&&Ae.length>0&&(bt.items=[]),We!==void 0&&(bt.prescription_for_unavailable_drugs=We),bt.order_total=parseFloat(wt.toFixed(2)),$e){if(!["pending","billed","dispensed","cancelled"].includes($e))throw new Error(`Invalid status for pharmacy order: ${$e}.`);bt.status=$e}const kt=await de(`/api/pharmacy-orders/${ft}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(bt)});if(!kt.ok){const Tt=await kt.json().catch(()=>({}));throw new Error(Tt.message||`AI pharmacy order edit failed: ${kt.statusText}`)}return r&&R(r),{action:"edit_pharmacy_order",success:!0,resultSummary:`Updated Pharmacy Order: ${$e?`Status -> ${$e}`:""} ${Ae!=null&&Ae.length?`Added/Updated: ${Ae.map(Tt=>Tt.name).join(", ")}`:""} ${Ve!=null&&Ve.length?`Removed: ${Ve.map(Tt=>Tt.name||Tt.drug_id).join(", ")}`:""}`.trim(),undo:async()=>{console.log(`Reverting pharmacy order ${ft}`);const Tt={items:at.medications.map(It=>({drug_id:It.drug_id,name:It.name,pack_quantity:It.pack_quantity,loose_quantity:It.loose_quantity,tabletsPerDay:It.tabletsPerDay,numberOfDays:It.numberOfDays,directions_to_use:It.directions_to_use,box_number:It.box_number,isLoose:It.isLoose,unit:It.unit,pack_price:It.pack_price,loose_price:It.loose_price,total_price:It.total_price})),status:at.status,prescription_for_unavailable_drugs:at.prescription_for_unavailable_drugs,order_total:at.order_total};await de(`/api/pharmacy-orders/${ft}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Tt)}),r&&await R(r)}}}}finally{}})())):we.action==="edit_lab_order"?(ze=!0,Ke.push((async()=>{try{const Pe=we.serialNumber;let Je;if(Pe){const We=new Map;(d??[]).forEach(bt=>{We.set(bt.id,{...bt})}),(u??[]).forEach(bt=>{We.has(bt.id)||We.set(bt.id,{id:bt.id,patient_id:bt.patient_id,tests:bt.tests,status:bt.status,createdAt:bt.createdAt,report:bt})});const ct=Array.from(We.values());ct.sort((bt,kt)=>new Date(kt.createdAt).getTime()-new Date(bt.createdAt).getTime());const dt=ct.length-Pe,wt=ct[dt];wt&&(Je=d.find(bt=>bt.id===wt.id))}if(Je||(Je=d.sort((We,ct)=>new Date(ct.createdAt).getTime()-new Date(We.createdAt).getTime()).find(We=>We.status==="pending")),!Je)throw new Error(`Lab order with serial number ${Pe} not found, or no pending order to edit.`);const at=JSON.parse(JSON.stringify(Je)),ft=Je.id,Ae=we.tests,Ve=we.items_to_remove,$e=we.status;if(!Ae&&!Ve&&!$e)throw new Error("No tests, items to remove, or status provided for lab order edit.");if($e==="cancelled"){if(Je.report||u&&u.some(We=>We.id===Je.id))throw new Error("Cannot delete lab order with an associated report. Please delete the report first.");return await H({type:"Lab Order",data:Je}),{action:"edit_lab_order",success:!0,resultSummary:`Deleted Lab Order #${Pe||"?"}.`,undo:async()=>{console.warn("Cannot fully undo lab order deletion yet. It requires re-creation.")}}}else{let We=[...Je.tests];if(Array.isArray(Ve)&&Ve.length>0&&(We=We.filter(dt=>!Ve.some(wt=>!!(wt.id&&String(dt.id)===String(wt.id)||wt.name&&dt.name.toLowerCase()===wt.name.toLowerCase())))),Array.isArray(Ae)&&Ae.length>0)for(const dt of Ae){let wt;if(dt.id?wt=v.find(It=>String(It.id)===String(dt.id)):dt.name&&(wt=Rd(dt.name,v)),!wt)throw new Error(`Lab test "${dt.name||dt.id||"Unknown"}" not found or no close match for update.`);const bt=typeof wt.price=="string"?parseFloat(wt.price):wt.price,kt=We.findIndex(It=>It.id&&String(It.id)===String(wt==null?void 0:wt.id)||It.name.toLowerCase()===(wt==null?void 0:wt.name.toLowerCase())),Tt={id:wt.id,name:wt.name,price:bt};kt!==-1?We[kt]={...We[kt],...Tt}:We.push(Tt)}const ct=await de(`/api/lab/orders/${ft}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({tests:We,status:$e||Je.status})});if(!ct.ok){const dt=await ct.json().catch(()=>({}));throw new Error(dt.message||`AI lab order edit failed: ${ct.statusText}`)}return r&&(U(r),Y(r)),{action:"edit_lab_order",success:!0,resultSummary:`Updated Lab Order: ${$e?`Status -> ${$e}`:""} ${Ae!=null&&Ae.length?`Added: ${Ae.map(dt=>dt.name||dt.id).join(", ")}`:""} ${Ve!=null&&Ve.length?`Removed: ${Ve.map(dt=>dt.name||dt.id).join(", ")}`:""}`.trim(),undo:async()=>{console.log(`Reverting lab order ${ft}`),await de(`/api/lab/orders/${ft}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({tests:at.tests,status:at.status})}),r&&(U(r),Y(r))}}}}catch(Pe){return{action:"edit_lab_order",success:!1,error:Pe}}finally{}})())):we.action==="edit_lab_report"?(ze=!0,Ke.push((async()=>{var Pe,Je;try{const at=we.serialNumber;let ft;if(at){const kt=[...d??[],...u??[]].sort((mt,$t)=>new Date($t.createdAt).getTime()-new Date(mt.createdAt).getTime()),Tt=Array.from(new Map(kt.map(mt=>[mt.id,mt])).values()),It=Tt.length-at;ft=Tt[It]}if(!ft)throw new Error(`Lab order/report with serial number ${at} not found.`);const Ae=ft.id,Ve=ft.report_content||((Pe=ft.report)==null?void 0:Pe.report_content)||"{}",$e=we.results||[];let We={};try{We=JSON.parse(Ve)}catch{We={}}const ct=(a==null?void 0:a.gender)==="F"?"female":(a==null?void 0:a.gender)==="M"?"male":null,dt=(a==null?void 0:a.age)||null;for(const bt of $e){let kt=bt.testId;if(!kt&&bt.testName){const It=(Je=ft.tests)==null?void 0:Je.find(mt=>mt.name.toLowerCase()===bt.testName.toLowerCase());It&&(kt=It.id)}if(!kt)throw new Error(`Could not identify testId for "${bt.testName||"Unknown test"}".`);We[kt]||(We[kt]={});let Tt={...We[kt],...bt.parameters||{}};Tt=b_(Tt,dt,ct),We[kt]=Tt}const wt=await de(`/api/lab/${Ae}/report`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(We)})});if(!wt.ok){const bt=await wt.json().catch(()=>({}));throw new Error(bt.message||`AI lab report edit failed: ${wt.statusText}`)}return r&&(U(r),Y(r)),{action:"edit_lab_report",success:!0,resultSummary:`Updated Lab Report for ${$e.map(bt=>bt.testName).join(", ")}.`,undo:async()=>{console.log(`Reverting lab report for order ${Ae}`),await de(`/api/lab/${Ae}/report`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:Ve})}),r&&(U(r),Y(r))}}}finally{}})())):we.action==="create_lab_report"?(ze=!0,Ke.push((async()=>{let Pe=null;try{if(!r)throw new Error("Missing patient ID.");const Je=[];for(const dt of we.tests||[]){let wt=dt.id?v.find(bt=>String(bt.id)===String(dt.id)):Rd(dt.name,v);if(!wt)throw new Error(`Lab test "${dt.name}" not found.`);Je.push({id:wt.id,name:wt.name,price:wt.price})}const at=await de("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:r,tests:Je})});if(!at.ok)throw new Error("Failed to create lab order.");const ft=await at.json();Pe=ft.labOrder?ft.labOrder.id:ft.id;const Ae=we.results||[],Ve={},$e=(a==null?void 0:a.gender)==="F"?"female":(a==null?void 0:a.gender)==="M"?"male":null,We=(a==null?void 0:a.age)||null;for(const dt of Ae){let wt=dt.testId;if(!wt&&dt.testName){const bt=Je.find(kt=>kt.name.toLowerCase()===dt.testName.toLowerCase());bt&&(wt=bt.id)}if(wt){let bt=dt.parameters||{};bt=b_(bt,We,$e),Ve[wt]=bt}}if(!(await de(`/api/lab/${Pe}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(Ve)})})).ok)throw new Error("Failed to submit report content.");return r&&(U(r),Y(r)),{action:"create_lab_report",success:!0,resultSummary:`Created Lab Order & Report: ${Je.map(dt=>dt.name).join(", ")}.`,undo:async()=>{Pe&&(await de(`/api/lab/orders/${Pe}`,{method:"DELETE"}),r&&(U(r),Y(r)))}}}finally{}})())):we.action==="create_recurring_medication"&&(Array.isArray(we.items)||we.prescription_for_unavailable_drugs&&we.prescription_for_unavailable_drugs.trim()!=="")?(ze=!0,Ke.push((async()=>{try{if(!r)throw new Error("Missing patient ID for recurring medication.");const Pe=[];let Je=null;if(Array.isArray(we.items))for(const Ve of we.items){let $e=Re(Ve,b);if(!$e){Je=`Drug "${Ve.name||Ve.drug_id}" not found.`;break}const{pack_quantity:We,loose_quantity:ct,tabletsPerDay:dt,numberOfDays:wt,pack_price:bt,loose_price:kt,total_price:Tt}=Ye(Ve,$e);Pe.push({drug_id:$e.id,name:$e.name,pack_quantity:We,loose_quantity:ct,tabletsPerDay:dt,numberOfDays:wt,price:$e.price,directions_to_use:Ve.directions_to_use,unit:$e.unit,pack_price:bt,loose_price:kt,total_price:Tt})}if(Je)throw new Error(Je);const at={patient_id:r,medications:Pe,frequency_days:we.frequency_days||30,next_delivery_date:we.next_delivery_date||new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],status:"active"},ft=await de("/api/recurring-medications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(at)});if(!ft.ok){const Ve=await ft.json().catch(()=>({}));throw new Error(Ve.message||`AI recurring medication creation failed: ${ft.statusText}`)}const Ae=await ft.json();return r&&await ne(r),{action:"create_recurring_medication",success:!0,resultSummary:`Created Recurring Medication: ${Pe.map(Ve=>Ve.name).join(", ")}.`,undo:async()=>{console.log(`Rolling back recurring medication ${Ae.id}`),await de(`/api/recurring-medications/${Ae.id}`,{method:"DELETE"}),r&&await ne(r)}}}finally{}})())):we.action==="edit_recurring_medication"?(ze=!0,Ke.push((async()=>{try{const Pe=we.serialNumber,Je=we.id;let at;if(Je?at=g.find(dt=>dt.id===Je):Pe&&(at=[...g].sort((wt,bt)=>new Date(wt.next_delivery_date).getTime()-new Date(bt.next_delivery_date).getTime())[Pe-1]),!at)throw new Error(`Recurring medication with serial number ${Pe} not found.`);const ft=JSON.parse(JSON.stringify(at)),Ae=we.items_to_remove,Ve=we.items;(we.status==="stopped"||we.status==="active")&&(at.status=we.status);let $e=[...at.medications];if(Array.isArray(Ae)&&Ae.length>0&&($e=$e.filter(dt=>{const wt=dt.name.toLowerCase().trim();return!Ae.some(bt=>!!(bt.drug_id&&String(dt.drug_id)===String(bt.drug_id)||bt.name&&bt.name.toLowerCase().trim()===wt))})),Array.isArray(Ve)&&Ve.length>0)for(const dt of Ve){let wt=Re(dt,b);if(!wt)throw new Error(`Drug "${dt.name}" not found.`);const bt=Ye(dt,wt),kt={drug_id:wt.id,name:wt.name,...bt,directions_to_use:dt.directions_to_use,unit:wt.unit},Tt=$e.findIndex(It=>It.drug_id===(wt==null?void 0:wt.id));Tt!==-1?$e[Tt]={...$e[Tt],...kt}:$e.push(kt)}const We={medications:$e,status:at.status,frequency_days:we.frequency_days||at.frequency_days,next_delivery_date:we.next_delivery_date||at.next_delivery_date},ct=await de(`/api/recurring-medications/${at.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(We)});if(!ct.ok){const dt=await ct.json().catch(()=>({}));throw new Error(dt.message||`AI recurring med edit failed: ${ct.statusText}`)}return r&&await ne(r),{action:"edit_recurring_medication",success:!0,resultSummary:`Updated Recurring Medication: ${Ve!=null&&Ve.length?`Added/Updated: ${Ve.map(dt=>dt.name).join(", ")}`:""} ${Ae!=null&&Ae.length?`Removed: ${Ae.map(dt=>dt.name||dt.drug_id).join(", ")}`:""}`.trim(),undo:async()=>{console.log(`Reverting recurring medication ${at.id}`),await de(`/api/recurring-medications/${at.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({medications:ft.medications,status:ft.status,frequency_days:ft.frequency_days,next_delivery_date:ft.next_delivery_date})}),r&&await ne(r)}}}catch(Pe){return{action:"edit_recurring_medication",success:!1,error:Pe}}finally{}})())):we.action==="delete_recurring_medication"?(ze=!0,Ke.push((async()=>{try{const Pe=we.serialNumber,Je=we.id;let at;if(Je?at=g.find(Ae=>Ae.id===Je):Pe&&(at=[...g].sort((Ve,$e)=>new Date(Ve.next_delivery_date).getTime()-new Date($e.next_delivery_date).getTime())[Pe-1]),!at)throw new Error(`Recurring medication with serial number ${Pe} not found.`);const ft=await de(`/api/recurring-medications/${at.id}`,{method:"DELETE"});if(!ft.ok){const Ae=await ft.json().catch(()=>({}));throw new Error(Ae.message||`AI recurring deletion failed: ${ft.statusText}`)}return r&&await ne(r),{action:"delete_recurring_medication",success:!0,resultSummary:`Deleted Recurring Medication (ID: ${at.id}).`}}finally{}})())):we.action==="add_complaint_history"&&we.complaint?(ze=!0,Ke.push((async()=>{try{if(!t)throw new Error("Missing Record ID for complaint history.");if(!we.complaint||typeof we.complaint!="string")throw new Error("Invalid AI complaint text.");const Pe={complaint:we.complaint.trim()},Je=await de(`/api/queue/doctor/complaint/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Pe)});if(!Je.ok){const ft=await Je.json().catch(()=>({}));throw new Error(ft.message||`AI complaint add failed: ${Je.statusText}`)}const at=await Je.json();return r&&await Z(r),{action:"add_complaint_history",success:!0,resultSummary:`Added complaint history: "${Pe.complaint}".`,undo:async()=>{console.log(`Reverting complaint history for ${t}`),at.newHistoryId&&(console.log(`Deleting history entry ${at.newHistoryId}`),await de(`/api/queue/doctor/complaint-history/${at.newHistoryId}`,{method:"DELETE"})),r&&await Z(r)}}}finally{}})())):we.action==="edit_complaint"?(ze=!0,Ke.push((async()=>{try{const{serialNumber:Pe,new_complaint:Je,delete:at}=we;if(!Pe)throw new Error("Missing serialNumber for edit_complaint action.");if(!at&&!Je)throw new Error("Missing new_complaint for edit_complaint action (unless deleting).");const ft=[..._e||[]].sort((ct,dt)=>new Date(dt.createdAt).getTime()-new Date(ct.createdAt).getTime()),Ae=ft.length-Pe,Ve=ft[Ae];if(!Ve)throw new Error(`Complaint with serial number ${Pe} not found.`);if(at)return await H({type:"Complaint",data:Ve}),r&&await Z(r),{action:"edit_complaint",success:!0,resultSummary:`Deleted complaint #${Pe} ("${Ve.complaint}").`,undo:async()=>{console.warn("Cannot easily undo complaint deletion (requires creation with specific ID/timestamp).")}};const $e=Ve.complaint,We=await de(`/api/patients/complaints/${Ve.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({complaint:Je})});if(!We.ok){const ct=await We.json().catch(()=>({}));throw new Error(ct.message||`Failed to update complaint: ${We.statusText}`)}return r&&await Z(r),{action:"edit_complaint",success:!0,resultSummary:`Edited complaint #${Pe} to "${Je}".`,undo:async()=>{console.log(`Reverting complaint #${Pe}`),await de(`/api/patients/complaints/${Ve.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({complaint:$e})}),r&&await Z(r)}}}catch(Pe){return{action:"edit_complaint",success:!1,error:Pe}}})())):we.action==="update_case_summary"&&we.summary?(ze=!0,Ke.push((async()=>{try{if(!t)throw new Error("Missing Record ID for case summary update.");if(typeof we.summary!="string")throw new Error("Invalid AI case summary text.");const Pe=o,Je={case_summary:we.summary.trim()},at=await de(`/api/queue/doctor/complaint/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Je)});if(!at.ok){const Ae=await at.json().catch(()=>({}));throw new Error(Ae.message||`AI case summary update failed: ${at.statusText}`)}const ft=await at.json();return I(ft.case_summary),q(ft.updatedAt),{action:"update_case_summary",success:!0,resultSummary:"Updated case summary.",undo:async()=>{console.log(`Reverting case summary for ${t}`),await de(`/api/queue/doctor/complaint/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:Pe||""})}),I(Pe||"")}}}finally{}})())):we.action==="update_patient_status"&&(ze=!0,Ke.push((async()=>{try{const Pe=we.status;if(Pe==="admit")a!=null&&a.discharge_date&&!(a!=null&&a.admission_date)?await he():a!=null&&a.admission_date||await he();else if(Pe==="discharge")a!=null&&a.admission_date&&!(a!=null&&a.discharge_date)&&await he();else if(Pe==="complete_consultation")await D();else if(Pe==="add_to_doctor_queue")await te("doctor");else throw new Error(`Invalid status: ${Pe}`);return{action:"update_patient_status",success:!0,resultSummary:`Updated status to ${Pe}.`}}catch(Pe){return{action:"update_patient_status",success:!1,error:Pe}}})()))}!ze&&lt&&Ge.length>0&&console.warn("No function call performed for actions:",Ge);const Te=await Promise.all(Ke),ie=Te.filter(we=>we.success),xe=Te.filter(we=>!we.success);if(xe.length>0){const we=xe.map(at=>{var ft;return((ft=at.error)==null?void 0:ft.message)||"Unknown error"});for(const at of ie)at.undo&&await at.undo();const Pe=new Error(`Batch execution failed. Rolled back successful actions. Errors: ${we.join("; ")}`),Je=((Qe=xe[0].value)==null?void 0:Qe.action)||xe[0].action||"batch_execution";return M&&M("system",` Error: ${we.join("; ")}`),await Ee(Je,Pe,Se,qe,Ue),{success:!1,shouldContinueLoop:!0}}else{const we=[];ie.reverse().forEach(Pe=>{Pe.undo&&we.push(Pe.undo)}),we.length>0&&(ee(Pe=>[...Pe,we]),ve&&ve(!0)),M&&ie.forEach(Pe=>{Pe.resultSummary&&M("system",Pe.resultSummary)})}return pt&&typeof pt.question=="string"&&($(pt.question),L(Array.isArray(pt.options)?pt.options:[])),{success:!0,shouldContinueLoop:lt,systemFeedback:ie.map(we=>we.resultSummary).filter(Boolean).join(`
`)}},fe=async(Ge,Se,qe,Ue,ze=[])=>{$(null),L([]),F(null);const lt=/```json\s*([\s\S]*?)\s*```/g;let Ke;const pt=[];for(;(Ke=lt.exec(Ge))!==null;)Ke[1]&&pt.push(Ke[1]);if(pt.length===0){const Te=Ge.trim();if(Te.startsWith("{")&&Te.endsWith("}")||Te.startsWith("[")&&Te.endsWith("]"))pt.push(Te);else throw new Error("AI response did not contain a recognized function call.")}for(const Te of pt){let ie;try{ie=JSON.parse(Te)}catch(Pe){await Ee("parse_json_block",Pe,Ge,Se,qe);return}const xe=Array.isArray(ie)?ie:[ie];if(Array.isArray(ie)){const Pe=xe[0],Je=xe[xe.length-1];if(!Pe||Pe.action!=="first_action"||!Je||Je.action!=="last_action"){const at=new Error("Invalid AI response: Each function call block must start with 'first_action' and end with 'last_action'.");await Ee("wrapper_validation",at,Ge,Se,qe);return}}const{shouldContinueLoop:Qe,systemFeedback:we}=await Ie(xe,Ge,Se,qe);if(Qe&&qe<x_){const Pe=`System Feedback (Step ${qe+1}):
${we||"Actions completed successfully."}`;let Je=[...ze,Pe];qe===0&&(Je=[`Request being processed: "${Ue}"`,...Je]),await ue("",Se,qe+1,Je)}}};ue=async(Ge,Se=0,qe=0,Ue=[])=>{var Te,ie,xe,Qe,we,Pe,Je,at,ft,Ae,Ve,$e;if(Se>1){M&&M("system"," AI call failed after multiple retries. Please try a different prompt."),P(!1);return}if(qe>=x_){M&&M("system"," AI loop limit reached (Safety Halt)."),P(!1);return}P(!0);let ze=oe.current;if(ze.patientId&&ze.fetchPatientContext)try{await ze.fetchPatientContext(ze.patientId),ze=oe.current}catch(We){console.warn("Failed to sync context before AI call, proceeding with existing state:",We)}let lt;const Ke=[...ze.userMessages||[]];Ge&&Ge.trim()&&((Ke[Ke.length-1]||"").includes(Ge)||Ke.push(`System: ${Ge}`)),Ue.length>0&&Ue.forEach(We=>{Ke.some(ct=>ct.includes(We))||Ke.push(`System Feedback: ${We}`)});const pt=Ke.join(`

`);try{const We=new Map;(ze.pendingLabOrders??[]).forEach(mt=>{We.set(mt.id,{...mt})}),(ze.labReports??[]).forEach(mt=>{if(!We.has(mt.id))We.set(mt.id,{id:mt.id,patient_id:mt.patient_id,tests:mt.tests,status:mt.status,createdAt:mt.createdAt,report:mt});else{const $t=We.get(mt.id);$t&&($t.report=mt,$t.status=mt.status)}});const ct=Array.from(We.values());ct.sort((mt,$t)=>new Date($t.createdAt).getTime()-new Date(mt.createdAt).getTime());const dt=ct.map((mt,$t)=>{let en=null;if(mt.report)try{const be=typeof mt.report.report_content=="string"?mt.report.report_content:JSON.stringify(mt.report.report_content||{}),nt=JSON.parse(be||"{}"),Ze=(mt.report.tests||[]).map(Pt=>{const Ut=nt[Pt.id]||{},hn=Ln=>({name:Ln.name,value:Ut[Ln.name]!==void 0?String(Ut[Ln.name]):String(Ln.defaultValue),normal_range:Ln.normal_range||"N/A"});return{testId:Pt.id,testName:Pt.name,parameters:(Pt.default_parameters||[]).map(hn)}});en={reportId:mt.report.reportId,reportDate:mt.report.report_date,tests:Ze}}catch{en={reportId:mt.report.reportId,reportDate:mt.report.report_date,reportContent:typeof mt.report.report_content=="string"?mt.report.report_content:JSON.stringify(mt.report.report_content),error:"Failed to parse report content JSON."}}return{serialNumber:ct.length-$t,orderId:mt.id,orderDate:isNaN(new Date(mt.createdAt).getTime())?mt.createdAt:new Date(mt.createdAt).toISOString(),tests:mt.tests.map(be=>({id:be.id,name:be.name,price:be.price})),status:mt.status,report:en}}),wt=[...ze.pastComplaints||[]].sort((mt,$t)=>new Date($t.createdAt).getTime()-new Date(mt.createdAt).getTime()),bt=wt.map((mt,$t)=>{try{return{serialNumber:wt.length-$t,...mt,createdAt:isNaN(new Date(mt.createdAt).getTime())?mt.createdAt:new Date(mt.createdAt).toISOString()}}catch{return{serialNumber:wt.length-$t,...mt}}}),Tt=[...ze.pharmacyOrders||[]].sort((mt,$t)=>{const en=new Date(mt.date).getTime(),be=new Date($t.date).getTime();return en-be}).map((mt,$t)=>{try{return{serialNumber:$t+1,...mt,date:mt.date&&!isNaN(new Date(mt.date).getTime())?new Date(mt.date).toISOString():mt.date}}catch{return{serialNumber:$t+1,...mt}}}),It={query:pt,currentDateTime:new Date().toISOString(),patientName:((Te=ze.patientDetails)==null?void 0:Te.name)||"",patientAge:((ie=ze.patientDetails)==null?void 0:ie.age)||void 0,patientGender:((xe=ze.patientDetails)==null?void 0:xe.gender)||void 0,case_summary:ze.caseSummary||"",case_summary_last_updated:ze.caseSummaryUpdatedAt?new Date(ze.caseSummaryUpdatedAt).toISOString():void 0,clinic_ai_memory:((Qe=ze.clinicSettings)==null?void 0:Qe.aiMemory)||"",clinic_ai_memory_last_updated:(we=ze.clinicSettings)!=null&&we.aiMemoryUpdatedAt?new Date(ze.clinicSettings.aiMemoryUpdatedAt).toISOString():void 0,clinic_wide_system_prompt:((Pe=ze.clinicSettings)==null?void 0:Pe.clinicWideSystemPrompt)||"",labHistory:dt,pharmacyOrders:Tt,pastComplaints:bt,recurringMedications:ze.recurringMedications,pharmacyInventory:ze.pharmacyInventory,labInventory:ze.labInventory,patientStatus:(Je=ze.patientDetails)==null?void 0:Je.current_status,isAdmitted:!!((at=ze.patientDetails)!=null&&at.admission_date)&&!((ft=ze.patientDetails)!=null&&ft.discharge_date),isInQueueToday:(Ae=ze.patientDetails)==null?void 0:Ae.isInDoctorQueueToday,admissionDate:((Ve=ze.patientDetails)==null?void 0:Ve.admission_date)||null,dischargeDate:(($e=ze.patientDetails)==null?void 0:$e.discharge_date)||null};if(console.log("DEBUG: Payload before sending to Gemini API:",JSON.stringify(It,null,2)),lt=await oQ(It,h),lt){S(lt);const mt=/```json\s*([\s\S]*?)\s*```/,$t=lt.match(mt);if($t&&$t[1])k(lt.replace(mt,"").trim()),T($t[1].trim());else{const en=lt.trim();if(en.startsWith("{")&&en.endsWith("}"))try{JSON.parse(en),k(""),T(en)}catch{k(en),T(null)}else if(en.startsWith("[")&&en.endsWith("]"))try{JSON.parse(en),k(""),T(en)}catch{k(en),T(null)}else k(en),T(null)}E(!1),M&&lt&&M("ai",lt),ze.patientId&&lt&&await pe(ze.patientId,lt),await fe(lt,Se,qe,Ge,Ue)}else throw new Error("Invalid AI response format.")}catch(We){await Ee("call_generative_api",We,lt,Se,qe)}finally{qe===0&&P(!1)}};const pe=async(Ge,Se)=>{z(!0),B(null);try{const qe={ai_response:Se},Ue=await de(`/api/patients/${Ge}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(qe)});if(!Ue.ok){const ze=await Ue.json().catch(()=>({}));throw new Error(ze.message||`Failed to save AI response to patient: ${Ue.statusText}`)}}catch(qe){B(`AI Response Save Error: ${qe.message}`)}finally{z(!1)}},Re=(Ge,Se)=>{if(Ge.drug_id)return Se.find(qe=>qe.id===String(Ge.drug_id));if(Ge.name)return Rd(Ge.name,Se)},Ye=(Ge,Se)=>{const qe=Number.isInteger(Number(Ge.tabletsPerDay))?Number(Ge.tabletsPerDay):1,Ue=Number(Ge.numberOfDays)||1,ze=Number(Ge.pack_quantity)||0,lt=Number(Ge.loose_quantity)||0,Ke=O0(Se.unit),pt=Number(Se.price),Te=pt,ie=Ke>0?pt/Ke:0,xe=ze*Te+lt*ie;return{pack_quantity:ze,loose_quantity:lt,tabletsPerDay:qe,numberOfDays:Ue,pack_price:parseFloat(Te.toFixed(2)),loose_price:parseFloat(ie.toFixed(2)),total_price:parseFloat(xe.toFixed(2))}},ut=async()=>{if(se.length===0)return;const Ge=se[se.length-1],Se=se.slice(0,-1);ee(Se),Se.length===0&&ve&&ve(!1),P(!0);try{console.log("Manual Undo: Executing undo functions...",Ge);for(const qe of Ge)try{await qe()}catch(Ue){console.error("Error during manual undo:",Ue)}console.log("Manual Undo Completed.")}finally{P(!1)}};return w.useImperativeHandle(n,()=>({callGenerativeApi:ue,undoLastBatch:ut})),null}),mQ={};function Yw(e,n){const t=mQ,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return DE(e,r,a)}function DE(e,n,t){if(gQ(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return v_(e.children,n,t)}return Array.isArray(e)?v_(e,n,t):""}function v_(e,n,t){const r=[];let a=-1;for(;++a<e.length;)r[a]=DE(e[a],n,t);return r.join("")}function gQ(e){return!!(e&&typeof e=="object")}const w_=document.createElement("i");function Ww(e){const n="&"+e+";";w_.innerHTML=n;const t=w_.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function pl(e,n,t,r){const a=e.length;let o=0,l;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,r.length<1e4)l=Array.from(r),l.unshift(n,t),e.splice(...l);else for(t&&e.splice(n,t);o<r.length;)l=r.slice(o,o+1e4),l.unshift(n,0),e.splice(...l),o+=1e4,n+=1e4}function Ts(e,n){return e.length>0?(pl(e,e.length,0,n),e):n}const N_={}.hasOwnProperty;function yQ(e){const n={};let t=-1;for(;++t<e.length;)xQ(n,e[t]);return n}function xQ(e,n){let t;for(t in n){const a=(N_.call(e,t)?e[t]:void 0)||(e[t]={}),o=n[t];let l;if(o)for(l in o){N_.call(a,l)||(a[l]=[]);const h=o[l];bQ(a[l],Array.isArray(h)?h:h?[h]:[])}}}function bQ(e,n){let t=-1;const r=[];for(;++t<n.length;)(n[t].add==="after"?e:r).push(n[t]);pl(e,0,0,r)}function PE(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function Ff(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const cl=vu(/[A-Za-z]/),ts=vu(/[\dA-Za-z]/),vQ=vu(/[#-'*+\--9=?A-Z^-~]/);function L1(e){return e!==null&&(e<32||e===127)}const F1=vu(/\d/),wQ=vu(/[\dA-Fa-f]/),NQ=vu(/[!-/:-@[-`{-~]/);function Zt(e){return e!==null&&e<-2}function ka(e){return e!==null&&(e<0||e===32)}function Hn(e){return e===-2||e===-1||e===32}const SQ=vu(new RegExp("\\p{P}|\\p{S}","u")),jQ=vu(/\s/);function vu(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function ip(e){const n=[];let t=-1,r=0,a=0;for(;++t<e.length;){const o=e.charCodeAt(t);let l="";if(o===37&&ts(e.charCodeAt(t+1))&&ts(e.charCodeAt(t+2)))a=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(l=String.fromCharCode(o));else if(o>55295&&o<57344){const h=e.charCodeAt(t+1);o<56320&&h>56319&&h<57344?(l=String.fromCharCode(o,h),a=1):l=""}else l=String.fromCharCode(o);l&&(n.push(e.slice(r,t),encodeURIComponent(l)),r=t+a+1,l=""),a&&(t+=a,a=0)}return n.join("")+e.slice(r)}function bi(e,n,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let o=0;return l;function l(d){return Hn(d)?(e.enter(t),h(d)):n(d)}function h(d){return Hn(d)&&o++<a?(e.consume(d),h):(e.exit(t),n(d))}}const _Q={tokenize:CQ};function CQ(e){const n=e.attempt(this.parser.constructs.contentInitial,r,a);let t;return n;function r(h){if(h===null){e.consume(h);return}return e.enter("lineEnding"),e.consume(h),e.exit("lineEnding"),bi(e,n,"linePrefix")}function a(h){return e.enter("paragraph"),o(h)}function o(h){const d=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=d),t=d,l(h)}function l(h){if(h===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(h);return}return Zt(h)?(e.consume(h),e.exit("chunkText"),o):(e.consume(h),l)}}const kQ={tokenize:EQ},S_={tokenize:TQ};function EQ(e){const n=this,t=[];let r=0,a,o,l;return h;function h(I){if(r<t.length){const q=t[r];return n.containerState=q[1],e.attempt(q[0].continuation,d,u)(I)}return u(I)}function d(I){if(r++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&P();const q=n.events.length;let $=q,L;for(;$--;)if(n.events[$][0]==="exit"&&n.events[$][1].type==="chunkFlow"){L=n.events[$][1].end;break}E(r);let F=q;for(;F<n.events.length;)n.events[F][1].end={...L},F++;return pl(n.events,$+1,0,n.events.slice(q)),n.events.length=F,u(I)}return h(I)}function u(I){if(r===t.length){if(!a)return b(I);if(a.currentConstruct&&a.currentConstruct.concrete)return S(I);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(S_,f,g)(I)}function f(I){return a&&P(),E(r),b(I)}function g(I){return n.parser.lazy[n.now().line]=r!==t.length,l=n.now().offset,S(I)}function b(I){return n.containerState={},e.attempt(S_,v,S)(I)}function v(I){return r++,t.push([n.currentConstruct,n.containerState]),b(I)}function S(I){if(I===null){a&&P(),E(0),e.consume(I);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:o}),k(I)}function k(I){if(I===null){T(e.exit("chunkFlow"),!0),E(0),e.consume(I);return}return Zt(I)?(e.consume(I),T(e.exit("chunkFlow")),r=0,n.interrupt=void 0,h):(e.consume(I),k)}function T(I,q){const $=n.sliceStream(I);if(q&&$.push(null),I.previous=o,o&&(o.next=I),o=I,a.defineSkip(I.start),a.write($),n.parser.lazy[I.start.line]){let L=a.events.length;for(;L--;)if(a.events[L][1].start.offset<l&&(!a.events[L][1].end||a.events[L][1].end.offset>l))return;const F=n.events.length;let z=F,B,R;for(;z--;)if(n.events[z][0]==="exit"&&n.events[z][1].type==="chunkFlow"){if(B){R=n.events[z][1].end;break}B=!0}for(E(r),L=F;L<n.events.length;)n.events[L][1].end={...R},L++;pl(n.events,z+1,0,n.events.slice(F)),n.events.length=L}}function E(I){let q=t.length;for(;q-- >I;){const $=t[q];n.containerState=$[1],$[0].exit.call(n,e)}t.length=I}function P(){a.write([null]),o=void 0,a=void 0,n.containerState._closeFlow=void 0}}function TQ(e,n,t){return bi(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Sb(e){if(e===null||ka(e)||jQ(e))return 1;if(SQ(e))return 2}function Qw(e,n,t){const r=[];let a=-1;for(;++a<e.length;){const o=e[a].resolveAll;o&&!r.includes(o)&&(n=o(n,t),r.push(o))}return n}const $1={name:"attention",resolveAll:AQ,tokenize:DQ};function AQ(e,n){let t=-1,r,a,o,l,h,d,u,f;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(r=t;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&n.sliceSerialize(e[r][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[r][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;d=e[r][1].end.offset-e[r][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[r][1].end},b={...e[t][1].start};j_(g,-d),j_(b,d),l={type:d>1?"strongSequence":"emphasisSequence",start:g,end:{...e[r][1].end}},h={type:d>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},o={type:d>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[t][1].start}},a={type:d>1?"strong":"emphasis",start:{...l.start},end:{...h.end}},e[r][1].end={...l.start},e[t][1].start={...h.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=Ts(u,[["enter",e[r][1],n],["exit",e[r][1],n]])),u=Ts(u,[["enter",a,n],["enter",l,n],["exit",l,n],["enter",o,n]]),u=Ts(u,Qw(n.parser.constructs.insideSpan.null,e.slice(r+1,t),n)),u=Ts(u,[["exit",o,n],["enter",h,n],["exit",h,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(f=2,u=Ts(u,[["enter",e[t][1],n],["exit",e[t][1],n]])):f=0,pl(e,r-1,t-r+3,u),t=r+u.length-f-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function DQ(e,n){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=Sb(r);let o;return l;function l(d){return o=d,e.enter("attentionSequence"),h(d)}function h(d){if(d===o)return e.consume(d),h;const u=e.exit("attentionSequence"),f=Sb(d),g=!f||f===2&&a||t.includes(d),b=!a||a===2&&f||t.includes(r);return u._open=!!(o===42?g:g&&(a||!b)),u._close=!!(o===42?b:b&&(f||!g)),n(d)}}function j_(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const PQ={name:"autolink",tokenize:IQ};function IQ(e,n,t){let r=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o}function o(v){return cl(v)?(e.consume(v),l):v===64?t(v):u(v)}function l(v){return v===43||v===45||v===46||ts(v)?(r=1,h(v)):u(v)}function h(v){return v===58?(e.consume(v),r=0,d):(v===43||v===45||v===46||ts(v))&&r++<32?(e.consume(v),h):(r=0,u(v))}function d(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||L1(v)?t(v):(e.consume(v),d)}function u(v){return v===64?(e.consume(v),f):vQ(v)?(e.consume(v),u):t(v)}function f(v){return ts(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),r=0,f):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||ts(v))&&r++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const Kb={partial:!0,tokenize:MQ};function MQ(e,n,t){return r;function r(o){return Hn(o)?bi(e,a,"linePrefix")(o):a(o)}function a(o){return o===null||Zt(o)?n(o):t(o)}}const IE={continuation:{tokenize:OQ},exit:LQ,name:"blockQuote",tokenize:RQ};function RQ(e,n,t){const r=this;return a;function a(l){if(l===62){const h=r.containerState;return h.open||(e.enter("blockQuote",{_container:!0}),h.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),o}return t(l)}function o(l){return Hn(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(l))}}function OQ(e,n,t){const r=this;return a;function a(l){return Hn(l)?bi(e,o,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):o(l)}function o(l){return e.attempt(IE,n,t)(l)}}function LQ(e){e.exit("blockQuote")}const ME={name:"characterEscape",tokenize:FQ};function FQ(e,n,t){return r;function r(o){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(o),e.exit("escapeMarker"),a}function a(o){return NQ(o)?(e.enter("characterEscapeValue"),e.consume(o),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(o)}}const RE={name:"characterReference",tokenize:$Q};function $Q(e,n,t){const r=this;let a=0,o,l;return h;function h(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),d}function d(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),o=31,l=ts,f(g))}function u(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,l=wQ,f):(e.enter("characterReferenceValue"),o=7,l=F1,f(g))}function f(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return l===ts&&!Ww(r.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return l(g)&&a++<o?(e.consume(g),f):t(g)}}const __={partial:!0,tokenize:BQ},C_={concrete:!0,name:"codeFenced",tokenize:zQ};function zQ(e,n,t){const r=this,a={partial:!0,tokenize:$};let o=0,l=0,h;return d;function d(L){return u(L)}function u(L){const F=r.events[r.events.length-1];return o=F&&F[1].type==="linePrefix"?F[2].sliceSerialize(F[1],!0).length:0,h=L,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),f(L)}function f(L){return L===h?(l++,e.consume(L),f):l<3?t(L):(e.exit("codeFencedFenceSequence"),Hn(L)?bi(e,g,"whitespace")(L):g(L))}function g(L){return L===null||Zt(L)?(e.exit("codeFencedFence"),r.interrupt?n(L):e.check(__,k,q)(L)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b(L))}function b(L){return L===null||Zt(L)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g(L)):Hn(L)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),bi(e,v,"whitespace")(L)):L===96&&L===h?t(L):(e.consume(L),b)}function v(L){return L===null||Zt(L)?g(L):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S(L))}function S(L){return L===null||Zt(L)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g(L)):L===96&&L===h?t(L):(e.consume(L),S)}function k(L){return e.attempt(a,q,T)(L)}function T(L){return e.enter("lineEnding"),e.consume(L),e.exit("lineEnding"),E}function E(L){return o>0&&Hn(L)?bi(e,P,"linePrefix",o+1)(L):P(L)}function P(L){return L===null||Zt(L)?e.check(__,k,q)(L):(e.enter("codeFlowValue"),I(L))}function I(L){return L===null||Zt(L)?(e.exit("codeFlowValue"),P(L)):(e.consume(L),I)}function q(L){return e.exit("codeFenced"),n(L)}function $(L,F,z){let B=0;return R;function R(ae){return L.enter("lineEnding"),L.consume(ae),L.exit("lineEnding"),U}function U(ae){return L.enter("codeFencedFence"),Hn(ae)?bi(L,Y,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(ae):Y(ae)}function Y(ae){return ae===h?(L.enter("codeFencedFenceSequence"),Z(ae)):z(ae)}function Z(ae){return ae===h?(B++,L.consume(ae),Z):B>=l?(L.exit("codeFencedFenceSequence"),Hn(ae)?bi(L,ne,"whitespace")(ae):ne(ae)):z(ae)}function ne(ae){return ae===null||Zt(ae)?(L.exit("codeFencedFence"),F(ae)):z(ae)}}}function BQ(e,n,t){const r=this;return a;function a(l){return l===null?t(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}const L0={name:"codeIndented",tokenize:qQ},UQ={partial:!0,tokenize:VQ};function qQ(e,n,t){const r=this;return a;function a(u){return e.enter("codeIndented"),bi(e,o,"linePrefix",5)(u)}function o(u){const f=r.events[r.events.length-1];return f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?l(u):t(u)}function l(u){return u===null?d(u):Zt(u)?e.attempt(UQ,l,d)(u):(e.enter("codeFlowValue"),h(u))}function h(u){return u===null||Zt(u)?(e.exit("codeFlowValue"),l(u)):(e.consume(u),h)}function d(u){return e.exit("codeIndented"),n(u)}}function VQ(e,n,t){const r=this;return a;function a(l){return r.parser.lazy[r.now().line]?t(l):Zt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):bi(e,o,"linePrefix",5)(l)}function o(l){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?n(l):Zt(l)?a(l):t(l)}}const HQ={name:"codeText",previous:YQ,resolve:GQ,tokenize:WQ};function GQ(e){let n=e.length-4,t=3,r,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(r=t;++r<n;)if(e[r][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)a===void 0?r!==n&&e[r][1].type!=="lineEnding"&&(a=r):(r===n||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function YQ(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function WQ(e,n,t){let r=0,a,o;return l;function l(g){return e.enter("codeText"),e.enter("codeTextSequence"),h(g)}function h(g){return g===96?(e.consume(g),r++,h):(e.exit("codeTextSequence"),d(g))}function d(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),d):g===96?(o=e.enter("codeTextSequence"),a=0,f(g)):Zt(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),d):(e.enter("codeTextData"),u(g))}function u(g){return g===null||g===32||g===96||Zt(g)?(e.exit("codeTextData"),d(g)):(e.consume(g),u)}function f(g){return g===96?(e.consume(g),a++,f):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(o.type="codeTextData",u(g))}}class QQ{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(n,r):n>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(n,t,r){const a=t||0;this.setCursor(Math.trunc(n));const o=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&Gm(this.left,r),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Gm(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Gm(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Gm(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Gm(this.left,t.reverse())}}}function Gm(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function OE(e){const n={};let t=-1,r,a,o,l,h,d,u;const f=new QQ(e);for(;++t<f.length;){for(;t in n;)t=n[t];if(r=f.get(t),t&&r[1].type==="chunkFlow"&&f.get(t-1)[1].type==="listItemPrefix"&&(d=r[1]._tokenizer.events,o=0,o<d.length&&d[o][1].type==="lineEndingBlank"&&(o+=2),o<d.length&&d[o][1].type==="content"))for(;++o<d.length&&d[o][1].type!=="content";)d[o][1].type==="chunkText"&&(d[o][1]._isInFirstContentOfListItem=!0,o++);if(r[0]==="enter")r[1].contentType&&(Object.assign(n,JQ(f,t)),t=n[t],u=!0);else if(r[1]._container){for(o=t,a=void 0;o--;)if(l=f.get(o),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(f.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=o);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(r[1].end={...f.get(a)[1].start},h=f.slice(a,t),h.unshift(r),f.splice(a,t-a+1,h))}}return pl(e,0,Number.POSITIVE_INFINITY,f.slice(0)),!u}function JQ(e,n){const t=e.get(n)[1],r=e.get(n)[2];let a=n-1;const o=[];let l=t._tokenizer;l||(l=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const h=l.events,d=[],u={};let f,g,b=-1,v=t,S=0,k=0;const T=[k];for(;v;){for(;e.get(++a)[1]!==v;);o.push(a),v._tokenizer||(f=r.sliceStream(v),v.next||f.push(null),g&&l.defineSkip(v.start),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(f),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<h.length;)h[b][0]==="exit"&&h[b-1][0]==="enter"&&h[b][1].type===h[b-1][1].type&&h[b][1].start.line!==h[b][1].end.line&&(k=b+1,T.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(l.events=[],v?(v._tokenizer=void 0,v.previous=void 0):T.pop(),b=T.length;b--;){const E=h.slice(T[b],T[b+1]),P=o.pop();d.push([P,P+E.length-1]),e.splice(P,2,E)}for(d.reverse(),b=-1;++b<d.length;)u[S+d[b][0]]=S+d[b][1],S+=d[b][1]-d[b][0]-1;return u}const KQ={resolve:ZQ,tokenize:eJ},XQ={partial:!0,tokenize:tJ};function ZQ(e){return OE(e),e}function eJ(e,n){let t;return r;function r(h){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(h)}function a(h){return h===null?o(h):Zt(h)?e.check(XQ,l,o)(h):(e.consume(h),a)}function o(h){return e.exit("chunkContent"),e.exit("content"),n(h)}function l(h){return e.consume(h),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function tJ(e,n,t){const r=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),bi(e,o,"linePrefix")}function o(l){if(l===null||Zt(l))return t(l);const h=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?n(l):e.interrupt(r.parser.constructs.flow,t,n)(l)}}function LE(e,n,t,r,a,o,l,h,d){const u=d||Number.POSITIVE_INFINITY;let f=0;return g;function g(E){return E===60?(e.enter(r),e.enter(a),e.enter(o),e.consume(E),e.exit(o),b):E===null||E===32||E===41||L1(E)?t(E):(e.enter(r),e.enter(l),e.enter(h),e.enter("chunkString",{contentType:"string"}),k(E))}function b(E){return E===62?(e.enter(o),e.consume(E),e.exit(o),e.exit(a),e.exit(r),n):(e.enter(h),e.enter("chunkString",{contentType:"string"}),v(E))}function v(E){return E===62?(e.exit("chunkString"),e.exit(h),b(E)):E===null||E===60||Zt(E)?t(E):(e.consume(E),E===92?S:v)}function S(E){return E===60||E===62||E===92?(e.consume(E),v):v(E)}function k(E){return!f&&(E===null||E===41||ka(E))?(e.exit("chunkString"),e.exit(h),e.exit(l),e.exit(r),n(E)):f<u&&E===40?(e.consume(E),f++,k):E===41?(e.consume(E),f--,k):E===null||E===32||E===40||L1(E)?t(E):(e.consume(E),E===92?T:k)}function T(E){return E===40||E===41||E===92?(e.consume(E),k):k(E)}}function FE(e,n,t,r,a,o){const l=this;let h=0,d;return u;function u(v){return e.enter(r),e.enter(a),e.consume(v),e.exit(a),e.enter(o),f}function f(v){return h>999||v===null||v===91||v===93&&!d||v===94&&!h&&"_hiddenFootnoteSupport"in l.parser.constructs?t(v):v===93?(e.exit(o),e.enter(a),e.consume(v),e.exit(a),e.exit(r),n):Zt(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),f):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||Zt(v)||h++>999?(e.exit("chunkString"),f(v)):(e.consume(v),d||(d=!Hn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),h++,g):g(v)}}function $E(e,n,t,r,a,o){let l;return h;function h(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),l=b===40?41:b,d):t(b)}function d(b){return b===l?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),n):(e.enter(o),u(b))}function u(b){return b===l?(e.exit(o),d(l)):b===null?t(b):Zt(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),bi(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),f(b))}function f(b){return b===l||b===null||Zt(b)?(e.exit("chunkString"),u(b)):(e.consume(b),b===92?g:f)}function g(b){return b===l||b===92?(e.consume(b),f):f(b)}}function ng(e,n){let t;return r;function r(a){return Zt(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,r):Hn(a)?bi(e,r,t?"linePrefix":"lineSuffix")(a):n(a)}}const nJ={name:"definition",tokenize:rJ},iJ={partial:!0,tokenize:aJ};function rJ(e,n,t){const r=this;let a;return o;function o(v){return e.enter("definition"),l(v)}function l(v){return FE.call(r,e,h,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function h(v){return a=Ff(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),d):t(v)}function d(v){return ka(v)?ng(e,u)(v):u(v)}function u(v){return LE(e,f,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function f(v){return e.attempt(iJ,g,g)(v)}function g(v){return Hn(v)?bi(e,b,"whitespace")(v):b(v)}function b(v){return v===null||Zt(v)?(e.exit("definition"),r.parser.defined.push(a),n(v)):t(v)}}function aJ(e,n,t){return r;function r(h){return ka(h)?ng(e,a)(h):t(h)}function a(h){return $E(e,o,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(h)}function o(h){return Hn(h)?bi(e,l,"whitespace")(h):l(h)}function l(h){return h===null||Zt(h)?n(h):t(h)}}const sJ={name:"hardBreakEscape",tokenize:oJ};function oJ(e,n,t){return r;function r(o){return e.enter("hardBreakEscape"),e.consume(o),a}function a(o){return Zt(o)?(e.exit("hardBreakEscape"),n(o)):t(o)}}const lJ={name:"headingAtx",resolve:cJ,tokenize:uJ};function cJ(e,n){let t=e.length-2,r=3,a,o;return e[r][1].type==="whitespace"&&(r+=2),t-2>r&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&e[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[t][1].end},o={type:"chunkText",start:e[r][1].start,end:e[t][1].end,contentType:"text"},pl(e,r,t-r+1,[["enter",a,n],["enter",o,n],["exit",o,n],["exit",a,n]])),e}function uJ(e,n,t){let r=0;return a;function a(f){return e.enter("atxHeading"),o(f)}function o(f){return e.enter("atxHeadingSequence"),l(f)}function l(f){return f===35&&r++<6?(e.consume(f),l):f===null||ka(f)?(e.exit("atxHeadingSequence"),h(f)):t(f)}function h(f){return f===35?(e.enter("atxHeadingSequence"),d(f)):f===null||Zt(f)?(e.exit("atxHeading"),n(f)):Hn(f)?bi(e,h,"whitespace")(f):(e.enter("atxHeadingText"),u(f))}function d(f){return f===35?(e.consume(f),d):(e.exit("atxHeadingSequence"),h(f))}function u(f){return f===null||f===35||ka(f)?(e.exit("atxHeadingText"),h(f)):(e.consume(f),u)}}const dJ=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],k_=["pre","script","style","textarea"],hJ={concrete:!0,name:"htmlFlow",resolveTo:mJ,tokenize:gJ},fJ={partial:!0,tokenize:xJ},pJ={partial:!0,tokenize:yJ};function mJ(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function gJ(e,n,t){const r=this;let a,o,l,h,d;return u;function u(M){return f(M)}function f(M){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(M),g}function g(M){return M===33?(e.consume(M),b):M===47?(e.consume(M),o=!0,k):M===63?(e.consume(M),a=3,r.interrupt?n:D):cl(M)?(e.consume(M),l=String.fromCharCode(M),T):t(M)}function b(M){return M===45?(e.consume(M),a=2,v):M===91?(e.consume(M),a=5,h=0,S):cl(M)?(e.consume(M),a=4,r.interrupt?n:D):t(M)}function v(M){return M===45?(e.consume(M),r.interrupt?n:D):t(M)}function S(M){const ge="CDATA[";return M===ge.charCodeAt(h++)?(e.consume(M),h===ge.length?r.interrupt?n:Y:S):t(M)}function k(M){return cl(M)?(e.consume(M),l=String.fromCharCode(M),T):t(M)}function T(M){if(M===null||M===47||M===62||ka(M)){const ge=M===47,_e=l.toLowerCase();return!ge&&!o&&k_.includes(_e)?(a=1,r.interrupt?n(M):Y(M)):dJ.includes(l.toLowerCase())?(a=6,ge?(e.consume(M),E):r.interrupt?n(M):Y(M)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(M):o?P(M):I(M))}return M===45||ts(M)?(e.consume(M),l+=String.fromCharCode(M),T):t(M)}function E(M){return M===62?(e.consume(M),r.interrupt?n:Y):t(M)}function P(M){return Hn(M)?(e.consume(M),P):R(M)}function I(M){return M===47?(e.consume(M),R):M===58||M===95||cl(M)?(e.consume(M),q):Hn(M)?(e.consume(M),I):R(M)}function q(M){return M===45||M===46||M===58||M===95||ts(M)?(e.consume(M),q):$(M)}function $(M){return M===61?(e.consume(M),L):Hn(M)?(e.consume(M),$):I(M)}function L(M){return M===null||M===60||M===61||M===62||M===96?t(M):M===34||M===39?(e.consume(M),d=M,F):Hn(M)?(e.consume(M),L):z(M)}function F(M){return M===d?(e.consume(M),d=null,B):M===null||Zt(M)?t(M):(e.consume(M),F)}function z(M){return M===null||M===34||M===39||M===47||M===60||M===61||M===62||M===96||ka(M)?$(M):(e.consume(M),z)}function B(M){return M===47||M===62||Hn(M)?I(M):t(M)}function R(M){return M===62?(e.consume(M),U):t(M)}function U(M){return M===null||Zt(M)?Y(M):Hn(M)?(e.consume(M),U):t(M)}function Y(M){return M===45&&a===2?(e.consume(M),X):M===60&&a===1?(e.consume(M),W):M===62&&a===4?(e.consume(M),te):M===63&&a===3?(e.consume(M),D):M===93&&a===5?(e.consume(M),he):Zt(M)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(fJ,ve,Z)(M)):M===null||Zt(M)?(e.exit("htmlFlowData"),Z(M)):(e.consume(M),Y)}function Z(M){return e.check(pJ,ne,ve)(M)}function ne(M){return e.enter("lineEnding"),e.consume(M),e.exit("lineEnding"),ae}function ae(M){return M===null||Zt(M)?Z(M):(e.enter("htmlFlowData"),Y(M))}function X(M){return M===45?(e.consume(M),D):Y(M)}function W(M){return M===47?(e.consume(M),l="",H):Y(M)}function H(M){if(M===62){const ge=l.toLowerCase();return k_.includes(ge)?(e.consume(M),te):Y(M)}return cl(M)&&l.length<8?(e.consume(M),l+=String.fromCharCode(M),H):Y(M)}function he(M){return M===93?(e.consume(M),D):Y(M)}function D(M){return M===62?(e.consume(M),te):M===45&&a===2?(e.consume(M),D):Y(M)}function te(M){return M===null||Zt(M)?(e.exit("htmlFlowData"),ve(M)):(e.consume(M),te)}function ve(M){return e.exit("htmlFlow"),n(M)}}function yJ(e,n,t){const r=this;return a;function a(l){return Zt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o):t(l)}function o(l){return r.parser.lazy[r.now().line]?t(l):n(l)}}function xJ(e,n,t){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(Kb,n,t)}}const bJ={name:"htmlText",tokenize:vJ};function vJ(e,n,t){const r=this;let a,o,l;return h;function h(D){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(D),d}function d(D){return D===33?(e.consume(D),u):D===47?(e.consume(D),$):D===63?(e.consume(D),I):cl(D)?(e.consume(D),z):t(D)}function u(D){return D===45?(e.consume(D),f):D===91?(e.consume(D),o=0,S):cl(D)?(e.consume(D),P):t(D)}function f(D){return D===45?(e.consume(D),v):t(D)}function g(D){return D===null?t(D):D===45?(e.consume(D),b):Zt(D)?(l=g,W(D)):(e.consume(D),g)}function b(D){return D===45?(e.consume(D),v):g(D)}function v(D){return D===62?X(D):D===45?b(D):g(D)}function S(D){const te="CDATA[";return D===te.charCodeAt(o++)?(e.consume(D),o===te.length?k:S):t(D)}function k(D){return D===null?t(D):D===93?(e.consume(D),T):Zt(D)?(l=k,W(D)):(e.consume(D),k)}function T(D){return D===93?(e.consume(D),E):k(D)}function E(D){return D===62?X(D):D===93?(e.consume(D),E):k(D)}function P(D){return D===null||D===62?X(D):Zt(D)?(l=P,W(D)):(e.consume(D),P)}function I(D){return D===null?t(D):D===63?(e.consume(D),q):Zt(D)?(l=I,W(D)):(e.consume(D),I)}function q(D){return D===62?X(D):I(D)}function $(D){return cl(D)?(e.consume(D),L):t(D)}function L(D){return D===45||ts(D)?(e.consume(D),L):F(D)}function F(D){return Zt(D)?(l=F,W(D)):Hn(D)?(e.consume(D),F):X(D)}function z(D){return D===45||ts(D)?(e.consume(D),z):D===47||D===62||ka(D)?B(D):t(D)}function B(D){return D===47?(e.consume(D),X):D===58||D===95||cl(D)?(e.consume(D),R):Zt(D)?(l=B,W(D)):Hn(D)?(e.consume(D),B):X(D)}function R(D){return D===45||D===46||D===58||D===95||ts(D)?(e.consume(D),R):U(D)}function U(D){return D===61?(e.consume(D),Y):Zt(D)?(l=U,W(D)):Hn(D)?(e.consume(D),U):B(D)}function Y(D){return D===null||D===60||D===61||D===62||D===96?t(D):D===34||D===39?(e.consume(D),a=D,Z):Zt(D)?(l=Y,W(D)):Hn(D)?(e.consume(D),Y):(e.consume(D),ne)}function Z(D){return D===a?(e.consume(D),a=void 0,ae):D===null?t(D):Zt(D)?(l=Z,W(D)):(e.consume(D),Z)}function ne(D){return D===null||D===34||D===39||D===60||D===61||D===96?t(D):D===47||D===62||ka(D)?B(D):(e.consume(D),ne)}function ae(D){return D===47||D===62||ka(D)?B(D):t(D)}function X(D){return D===62?(e.consume(D),e.exit("htmlTextData"),e.exit("htmlText"),n):t(D)}function W(D){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(D),e.exit("lineEnding"),H}function H(D){return Hn(D)?bi(e,he,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(D):he(D)}function he(D){return e.enter("htmlTextData"),l(D)}}const Jw={name:"labelEnd",resolveAll:jJ,resolveTo:_J,tokenize:CJ},wJ={tokenize:kJ},NJ={tokenize:EJ},SJ={tokenize:TJ};function jJ(e){let n=-1;const t=[];for(;++n<e.length;){const r=e[n][1];if(t.push(e[n]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",n+=a}}return e.length!==t.length&&pl(e,0,e.length,t),e}function _J(e,n){let t=e.length,r=0,a,o,l,h;for(;t--;)if(a=e[t][1],o){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(o=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(l=t);const d={type:e[o][1].type==="labelLink"?"link":"image",start:{...e[o][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[o][1].start},end:{...e[l][1].end}},f={type:"labelText",start:{...e[o+r+2][1].end},end:{...e[l-2][1].start}};return h=[["enter",d,n],["enter",u,n]],h=Ts(h,e.slice(o+1,o+r+3)),h=Ts(h,[["enter",f,n]]),h=Ts(h,Qw(n.parser.constructs.insideSpan.null,e.slice(o+r+4,l-3),n)),h=Ts(h,[["exit",f,n],e[l-2],e[l-1],["exit",u,n]]),h=Ts(h,e.slice(l+1)),h=Ts(h,[["exit",d,n]]),pl(e,o,e.length,h),e}function CJ(e,n,t){const r=this;let a=r.events.length,o,l;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){o=r.events[a][1];break}return h;function h(b){return o?o._inactive?g(b):(l=r.parser.defined.includes(Ff(r.sliceSerialize({start:o.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),d):t(b)}function d(b){return b===40?e.attempt(wJ,f,l?f:g)(b):b===91?e.attempt(NJ,f,l?u:g)(b):l?f(b):g(b)}function u(b){return e.attempt(SJ,f,g)(b)}function f(b){return n(b)}function g(b){return o._balanced=!0,t(b)}}function kJ(e,n,t){return r;function r(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return ka(g)?ng(e,o)(g):o(g)}function o(g){return g===41?f(g):LE(e,l,h,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function l(g){return ka(g)?ng(e,d)(g):f(g)}function h(g){return t(g)}function d(g){return g===34||g===39||g===40?$E(e,u,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):f(g)}function u(g){return ka(g)?ng(e,f)(g):f(g)}function f(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function EJ(e,n,t){const r=this;return a;function a(h){return FE.call(r,e,o,l,"reference","referenceMarker","referenceString")(h)}function o(h){return r.parser.defined.includes(Ff(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?n(h):t(h)}function l(h){return t(h)}}function TJ(e,n,t){return r;function r(o){return e.enter("reference"),e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),a}function a(o){return o===93?(e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),e.exit("reference"),n):t(o)}}const AJ={name:"labelStartImage",resolveAll:Jw.resolveAll,tokenize:DJ};function DJ(e,n,t){const r=this;return a;function a(h){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(h),e.exit("labelImageMarker"),o}function o(h){return h===91?(e.enter("labelMarker"),e.consume(h),e.exit("labelMarker"),e.exit("labelImage"),l):t(h)}function l(h){return h===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(h):n(h)}}const PJ={name:"labelStartLink",resolveAll:Jw.resolveAll,tokenize:IJ};function IJ(e,n,t){const r=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),o}function o(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(l):n(l)}}const F0={name:"lineEnding",tokenize:MJ};function MJ(e,n){return t;function t(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),bi(e,n,"linePrefix")}}const eb={name:"thematicBreak",tokenize:RJ};function RJ(e,n,t){let r=0,a;return o;function o(u){return e.enter("thematicBreak"),l(u)}function l(u){return a=u,h(u)}function h(u){return u===a?(e.enter("thematicBreakSequence"),d(u)):r>=3&&(u===null||Zt(u))?(e.exit("thematicBreak"),n(u)):t(u)}function d(u){return u===a?(e.consume(u),r++,d):(e.exit("thematicBreakSequence"),Hn(u)?bi(e,h,"whitespace")(u):h(u))}}const _a={continuation:{tokenize:$J},exit:BJ,name:"list",tokenize:FJ},OJ={partial:!0,tokenize:UJ},LJ={partial:!0,tokenize:zJ};function FJ(e,n,t){const r=this,a=r.events[r.events.length-1];let o=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return h;function h(v){const S=r.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!r.containerState.marker||v===r.containerState.marker:F1(v)){if(r.containerState.type||(r.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(eb,t,u)(v):u(v);if(!r.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),d(v)}return t(v)}function d(v){return F1(v)&&++l<10?(e.consume(v),d):(!r.interrupt||l<2)&&(r.containerState.marker?v===r.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),u(v)):t(v)}function u(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||v,e.check(Kb,r.interrupt?t:f,e.attempt(OJ,b,g))}function f(v){return r.containerState.initialBlankLine=!0,o++,b(v)}function g(v){return Hn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return r.containerState.size=o+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function $J(e,n,t){const r=this;return r.containerState._closeFlow=void 0,e.check(Kb,a,o);function a(h){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,bi(e,n,"listItemIndent",r.containerState.size+1)(h)}function o(h){return r.containerState.furtherBlankLines||!Hn(h)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,l(h)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(LJ,n,l)(h))}function l(h){return r.containerState._closeFlow=!0,r.interrupt=void 0,bi(e,e.attempt(_a,n,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(h)}}function zJ(e,n,t){const r=this;return bi(e,a,"listItemIndent",r.containerState.size+1);function a(o){const l=r.events[r.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===r.containerState.size?n(o):t(o)}}function BJ(e){e.exit(this.containerState.type)}function UJ(e,n,t){const r=this;return bi(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(o){const l=r.events[r.events.length-1];return!Hn(o)&&l&&l[1].type==="listItemPrefixWhitespace"?n(o):t(o)}}const E_={name:"setextUnderline",resolveTo:qJ,tokenize:VJ};function qJ(e,n){let t=e.length,r,a,o;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){r=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!o&&e[t][1].type==="definition"&&(o=t);const l={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",o?(e.splice(a,0,["enter",l,n]),e.splice(o+1,0,["exit",e[r][1],n]),e[r][1].end={...e[o][1].end}):e[r][1]=l,e.push(["exit",l,n]),e}function VJ(e,n,t){const r=this;let a;return o;function o(u){let f=r.events.length,g;for(;f--;)if(r.events[f][1].type!=="lineEnding"&&r.events[f][1].type!=="linePrefix"&&r.events[f][1].type!=="content"){g=r.events[f][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(e.enter("setextHeadingLine"),a=u,l(u)):t(u)}function l(u){return e.enter("setextHeadingLineSequence"),h(u)}function h(u){return u===a?(e.consume(u),h):(e.exit("setextHeadingLineSequence"),Hn(u)?bi(e,d,"lineSuffix")(u):d(u))}function d(u){return u===null||Zt(u)?(e.exit("setextHeadingLine"),n(u)):t(u)}}const HJ={tokenize:GJ};function GJ(e){const n=this,t=e.attempt(Kb,r,e.attempt(this.parser.constructs.flowInitial,a,bi(e,e.attempt(this.parser.constructs.flow,a,e.attempt(KQ,a)),"linePrefix")));return t;function r(o){if(o===null){e.consume(o);return}return e.enter("lineEndingBlank"),e.consume(o),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const YJ={resolveAll:BE()},WJ=zE("string"),QJ=zE("text");function zE(e){return{resolveAll:BE(e==="text"?JJ:void 0),tokenize:n};function n(t){const r=this,a=this.parser.constructs[e],o=t.attempt(a,l,h);return l;function l(f){return u(f)?o(f):h(f)}function h(f){if(f===null){t.consume(f);return}return t.enter("data"),t.consume(f),d}function d(f){return u(f)?(t.exit("data"),o(f)):(t.consume(f),d)}function u(f){if(f===null)return!0;const g=a[f];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(r,r.previous))return!0}return!1}}}function BE(e){return n;function n(t,r){let a=-1,o;for(;++a<=t.length;)o===void 0?t[a]&&t[a][1].type==="data"&&(o=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==o+2&&(t[o][1].end=t[a-1][1].end,t.splice(o+2,a-o-2),a=o+2),o=void 0);return e?e(t,r):t}}function JJ(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const r=e[t-1][1],a=n.sliceStream(r);let o=a.length,l=-1,h=0,d;for(;o--;){const u=a[o];if(typeof u=="string"){for(l=u.length;u.charCodeAt(l-1)===32;)h++,l--;if(l)break;l=-1}else if(u===-2)d=!0,h++;else if(u!==-1){o++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(h=0),h){const u={type:t===e.length||d||h<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?l:r.start._bufferIndex+l,_index:r.start._index+o,line:r.end.line,column:r.end.column-h,offset:r.end.offset-h},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(t,0,["enter",u,n],["exit",u,n]),t+=2)}t++}return e}const KJ={42:_a,43:_a,45:_a,48:_a,49:_a,50:_a,51:_a,52:_a,53:_a,54:_a,55:_a,56:_a,57:_a,62:IE},XJ={91:nJ},ZJ={[-2]:L0,[-1]:L0,32:L0},eK={35:lJ,42:eb,45:[E_,eb],60:hJ,61:E_,95:eb,96:C_,126:C_},tK={38:RE,92:ME},nK={[-5]:F0,[-4]:F0,[-3]:F0,33:AJ,38:RE,42:$1,60:[PQ,bJ],91:PJ,92:[sJ,ME],93:Jw,95:$1,96:HQ},iK={null:[$1,YJ]},rK={null:[42,95]},aK={null:[]},sK=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:rK,contentInitial:XJ,disable:aK,document:KJ,flow:eK,flowInitial:ZJ,insideSpan:iK,string:tK,text:nK},Symbol.toStringTag,{value:"Module"}));function oK(e,n,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},o=[];let l=[],h=[];const d={attempt:F($),check:F(L),consume:P,enter:I,exit:q,interrupt:F(L,{interrupt:!0})},u={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let f=n.tokenize.call(u,d);return n.resolveAll&&o.push(n),u;function g(U){return l=Ts(l,U),T(),l[l.length-1]!==null?[]:(z(n,0),u.events=Qw(o,u.events,u),u.events)}function b(U,Y){return cK(v(U),Y)}function v(U){return lK(l,U)}function S(){const{_bufferIndex:U,_index:Y,line:Z,column:ne,offset:ae}=r;return{_bufferIndex:U,_index:Y,line:Z,column:ne,offset:ae}}function k(U){a[U.line]=U.column,R()}function T(){let U;for(;r._index<l.length;){const Y=l[r._index];if(typeof Y=="string")for(U=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===U&&r._bufferIndex<Y.length;)E(Y.charCodeAt(r._bufferIndex));else E(Y)}}function E(U){f=f(U)}function P(U){Zt(U)?(r.line++,r.column=1,r.offset+=U===-3?2:1,R()):U!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===l[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=U}function I(U,Y){const Z=Y||{};return Z.type=U,Z.start=S(),u.events.push(["enter",Z,u]),h.push(Z),Z}function q(U){const Y=h.pop();return Y.end=S(),u.events.push(["exit",Y,u]),Y}function $(U,Y){z(U,Y.from)}function L(U,Y){Y.restore()}function F(U,Y){return Z;function Z(ne,ae,X){let W,H,he,D;return Array.isArray(ne)?ve(ne):"tokenize"in ne?ve([ne]):te(ne);function te(se){return ee;function ee(oe){const ue=oe!==null&&se[oe],Ee=oe!==null&&se.null,Ie=[...Array.isArray(ue)?ue:ue?[ue]:[],...Array.isArray(Ee)?Ee:Ee?[Ee]:[]];return ve(Ie)(oe)}}function ve(se){return W=se,H=0,se.length===0?X:M(se[H])}function M(se){return ee;function ee(oe){return D=B(),he=se,se.partial||(u.currentConstruct=se),se.name&&u.parser.constructs.disable.null.includes(se.name)?_e():se.tokenize.call(Y?Object.assign(Object.create(u),Y):u,d,ge,_e)(oe)}}function ge(se){return U(he,D),ae}function _e(se){return D.restore(),++H<W.length?M(W[H]):X}}}function z(U,Y){U.resolveAll&&!o.includes(U)&&o.push(U),U.resolve&&pl(u.events,Y,u.events.length-Y,U.resolve(u.events.slice(Y),u)),U.resolveTo&&(u.events=U.resolveTo(u.events,u))}function B(){const U=S(),Y=u.previous,Z=u.currentConstruct,ne=u.events.length,ae=Array.from(h);return{from:ne,restore:X};function X(){r=U,u.previous=Y,u.currentConstruct=Z,u.events.length=ne,h=ae,R()}}function R(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function lK(e,n){const t=n.start._index,r=n.start._bufferIndex,a=n.end._index,o=n.end._bufferIndex;let l;if(t===a)l=[e[t].slice(r,o)];else{if(l=e.slice(t,a),r>-1){const h=l[0];typeof h=="string"?l[0]=h.slice(r):l.shift()}o>0&&l.push(e[a].slice(0,o))}return l}function cK(e,n){let t=-1;const r=[];let a;for(;++t<e.length;){const o=e[t];let l;if(typeof o=="string")l=o;else switch(o){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=n?" ":"	";break}case-1:{if(!n&&a)continue;l=" ";break}default:l=String.fromCharCode(o)}a=o===-2,r.push(l)}return r.join("")}function uK(e){const r={constructs:yQ([sK,...(e||{}).extensions||[]]),content:a(_Q),defined:[],document:a(kQ),flow:a(HJ),lazy:{},string:a(WJ),text:a(QJ)};return r;function a(o){return l;function l(h){return oK(r,o,h)}}}function dK(e){for(;!OE(e););return e}const T_=/[\0\t\n\r]/g;function hK(){let e=1,n="",t=!0,r;return a;function a(o,l,h){const d=[];let u,f,g,b,v;for(o=n+(typeof o=="string"?o.toString():new TextDecoder(l||void 0).decode(o)),g=0,n="",t&&(o.charCodeAt(0)===65279&&g++,t=void 0);g<o.length;){if(T_.lastIndex=g,u=T_.exec(o),b=u&&u.index!==void 0?u.index:o.length,v=o.charCodeAt(b),!u){n=o.slice(g);break}if(v===10&&g===b&&r)d.push(-3),r=void 0;else switch(r&&(d.push(-5),r=void 0),g<b&&(d.push(o.slice(g,b)),e+=b-g),v){case 0:{d.push(65533),e++;break}case 9:{for(f=Math.ceil(e/4)*4,d.push(-2);e++<f;)d.push(-1);break}case 10:{d.push(-4),e=1;break}default:r=!0,e=1}g=b+1}return h&&(r&&d.push(-5),n&&d.push(n),d.push(null)),d}}const fK=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function UE(e){return e.replace(fK,pK)}function pK(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),o=a===120||a===88;return PE(t.slice(o?2:1),o?16:10)}return Ww(t)||e}function ig(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?A_(e.position):"start"in e||"end"in e?A_(e):"line"in e||"column"in e?z1(e):""}function z1(e){return D_(e&&e.line)+":"+D_(e&&e.column)}function A_(e){return z1(e&&e.start)+"-"+z1(e&&e.end)}function D_(e){return e&&typeof e=="number"?e:1}const qE={}.hasOwnProperty;function mK(e,n,t){return typeof n!="string"&&(t=n,n=void 0),gK(t)(dK(uK(t).document().write(hK()(e,n,!0))))}function gK(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(qe),autolinkProtocol:B,autolinkEmail:B,atxHeading:o(Ye),blockQuote:o(Ee),characterEscape:B,characterReference:B,codeFenced:o(Ie),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:o(Ie,l),codeText:o(fe,l),codeTextData:B,data:B,codeFlowValue:B,definition:o(pe),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:o(Re),hardBreakEscape:o(ut),hardBreakTrailing:o(ut),htmlFlow:o(Ge,l),htmlFlowData:B,htmlText:o(Ge,l),htmlTextData:B,image:o(Se),label:l,link:o(qe),listItem:o(ze),listItemValue:b,listOrdered:o(Ue,g),listUnordered:o(Ue),paragraph:o(lt),reference:M,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:o(Ye),strong:o(Ke),thematicBreak:o(Te)},exit:{atxHeading:d(),atxHeadingSequence:$,autolink:d(),autolinkEmail:ue,autolinkProtocol:oe,blockQuote:d(),characterEscapeValue:R,characterReferenceMarkerHexadecimal:_e,characterReferenceMarkerNumeric:_e,characterReferenceValue:se,characterReference:ee,codeFenced:d(T),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:R,codeIndented:d(E),codeText:d(ae),codeTextData:R,data:R,definition:d(),definitionDestinationString:q,definitionLabelString:P,definitionTitleString:I,emphasis:d(),hardBreakEscape:d(Y),hardBreakTrailing:d(Y),htmlFlow:d(Z),htmlFlowData:R,htmlText:d(ne),htmlTextData:R,image:d(W),label:he,labelText:H,lineEnding:U,link:d(X),listItem:d(),listOrdered:d(),listUnordered:d(),paragraph:d(),referenceString:ge,resourceDestinationString:D,resourceTitleString:te,resource:ve,setextHeading:d(z),setextHeadingLineSequence:F,setextHeadingText:L,strong:d(),thematicBreak:d()}};VE(n,(e||{}).mdastExtensions||[]);const t={};return r;function r(ie){let xe={type:"root",children:[]};const Qe={stack:[xe],tokenStack:[],config:n,enter:h,exit:u,buffer:l,resume:f,data:t},we=[];let Pe=-1;for(;++Pe<ie.length;)if(ie[Pe][1].type==="listOrdered"||ie[Pe][1].type==="listUnordered")if(ie[Pe][0]==="enter")we.push(Pe);else{const Je=we.pop();Pe=a(ie,Je,Pe)}for(Pe=-1;++Pe<ie.length;){const Je=n[ie[Pe][0]];qE.call(Je,ie[Pe][1].type)&&Je[ie[Pe][1].type].call(Object.assign({sliceSerialize:ie[Pe][2].sliceSerialize},Qe),ie[Pe][1])}if(Qe.tokenStack.length>0){const Je=Qe.tokenStack[Qe.tokenStack.length-1];(Je[1]||P_).call(Qe,void 0,Je[0])}for(xe.position={start:uu(ie.length>0?ie[0][1].start:{line:1,column:1,offset:0}),end:uu(ie.length>0?ie[ie.length-2][1].end:{line:1,column:1,offset:0})},Pe=-1;++Pe<n.transforms.length;)xe=n.transforms[Pe](xe)||xe;return xe}function a(ie,xe,Qe){let we=xe-1,Pe=-1,Je=!1,at,ft,Ae,Ve;for(;++we<=Qe;){const $e=ie[we];switch($e[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{$e[0]==="enter"?Pe++:Pe--,Ve=void 0;break}case"lineEndingBlank":{$e[0]==="enter"&&(at&&!Ve&&!Pe&&!Ae&&(Ae=we),Ve=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Ve=void 0}if(!Pe&&$e[0]==="enter"&&$e[1].type==="listItemPrefix"||Pe===-1&&$e[0]==="exit"&&($e[1].type==="listUnordered"||$e[1].type==="listOrdered")){if(at){let We=we;for(ft=void 0;We--;){const ct=ie[We];if(ct[1].type==="lineEnding"||ct[1].type==="lineEndingBlank"){if(ct[0]==="exit")continue;ft&&(ie[ft][1].type="lineEndingBlank",Je=!0),ct[1].type="lineEnding",ft=We}else if(!(ct[1].type==="linePrefix"||ct[1].type==="blockQuotePrefix"||ct[1].type==="blockQuotePrefixWhitespace"||ct[1].type==="blockQuoteMarker"||ct[1].type==="listItemIndent"))break}Ae&&(!ft||Ae<ft)&&(at._spread=!0),at.end=Object.assign({},ft?ie[ft][1].start:$e[1].end),ie.splice(ft||we,0,["exit",at,$e[2]]),we++,Qe++}if($e[1].type==="listItemPrefix"){const We={type:"listItem",_spread:!1,start:Object.assign({},$e[1].start),end:void 0};at=We,ie.splice(we,0,["enter",We,$e[2]]),we++,Qe++,Ae=void 0,Ve=!0}}}return ie[xe][1]._spread=Je,Qe}function o(ie,xe){return Qe;function Qe(we){h.call(this,ie(we),we),xe&&xe.call(this,we)}}function l(){this.stack.push({type:"fragment",children:[]})}function h(ie,xe,Qe){this.stack[this.stack.length-1].children.push(ie),this.stack.push(ie),this.tokenStack.push([xe,Qe||void 0]),ie.position={start:uu(xe.start),end:void 0}}function d(ie){return xe;function xe(Qe){ie&&ie.call(this,Qe),u.call(this,Qe)}}function u(ie,xe){const Qe=this.stack.pop(),we=this.tokenStack.pop();if(we)we[0].type!==ie.type&&(xe?xe.call(this,ie,we[0]):(we[1]||P_).call(this,ie,we[0]));else throw new Error("Cannot close `"+ie.type+"` ("+ig({start:ie.start,end:ie.end})+"): its not open");Qe.position.end=uu(ie.end)}function f(){return Yw(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(ie){if(this.data.expectingFirstListItemValue){const xe=this.stack[this.stack.length-2];xe.start=Number.parseInt(this.sliceSerialize(ie),10),this.data.expectingFirstListItemValue=void 0}}function v(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.lang=ie}function S(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.meta=ie}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.value=ie.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function E(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.value=ie.replace(/(\r?\n|\r)$/g,"")}function P(ie){const xe=this.resume(),Qe=this.stack[this.stack.length-1];Qe.label=xe,Qe.identifier=Ff(this.sliceSerialize(ie)).toLowerCase()}function I(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.title=ie}function q(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.url=ie}function $(ie){const xe=this.stack[this.stack.length-1];if(!xe.depth){const Qe=this.sliceSerialize(ie).length;xe.depth=Qe}}function L(){this.data.setextHeadingSlurpLineEnding=!0}function F(ie){const xe=this.stack[this.stack.length-1];xe.depth=this.sliceSerialize(ie).codePointAt(0)===61?1:2}function z(){this.data.setextHeadingSlurpLineEnding=void 0}function B(ie){const Qe=this.stack[this.stack.length-1].children;let we=Qe[Qe.length-1];(!we||we.type!=="text")&&(we=pt(),we.position={start:uu(ie.start),end:void 0},Qe.push(we)),this.stack.push(we)}function R(ie){const xe=this.stack.pop();xe.value+=this.sliceSerialize(ie),xe.position.end=uu(ie.end)}function U(ie){const xe=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Qe=xe.children[xe.children.length-1];Qe.position.end=uu(ie.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(xe.type)&&(B.call(this,ie),R.call(this,ie))}function Y(){this.data.atHardBreak=!0}function Z(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.value=ie}function ne(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.value=ie}function ae(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.value=ie}function X(){const ie=this.stack[this.stack.length-1];if(this.data.inReference){const xe=this.data.referenceType||"shortcut";ie.type+="Reference",ie.referenceType=xe,delete ie.url,delete ie.title}else delete ie.identifier,delete ie.label;this.data.referenceType=void 0}function W(){const ie=this.stack[this.stack.length-1];if(this.data.inReference){const xe=this.data.referenceType||"shortcut";ie.type+="Reference",ie.referenceType=xe,delete ie.url,delete ie.title}else delete ie.identifier,delete ie.label;this.data.referenceType=void 0}function H(ie){const xe=this.sliceSerialize(ie),Qe=this.stack[this.stack.length-2];Qe.label=UE(xe),Qe.identifier=Ff(xe).toLowerCase()}function he(){const ie=this.stack[this.stack.length-1],xe=this.resume(),Qe=this.stack[this.stack.length-1];if(this.data.inReference=!0,Qe.type==="link"){const we=ie.children;Qe.children=we}else Qe.alt=xe}function D(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.url=ie}function te(){const ie=this.resume(),xe=this.stack[this.stack.length-1];xe.title=ie}function ve(){this.data.inReference=void 0}function M(){this.data.referenceType="collapsed"}function ge(ie){const xe=this.resume(),Qe=this.stack[this.stack.length-1];Qe.label=xe,Qe.identifier=Ff(this.sliceSerialize(ie)).toLowerCase(),this.data.referenceType="full"}function _e(ie){this.data.characterReferenceType=ie.type}function se(ie){const xe=this.sliceSerialize(ie),Qe=this.data.characterReferenceType;let we;Qe?(we=PE(xe,Qe==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):we=Ww(xe);const Pe=this.stack[this.stack.length-1];Pe.value+=we}function ee(ie){const xe=this.stack.pop();xe.position.end=uu(ie.end)}function oe(ie){R.call(this,ie);const xe=this.stack[this.stack.length-1];xe.url=this.sliceSerialize(ie)}function ue(ie){R.call(this,ie);const xe=this.stack[this.stack.length-1];xe.url="mailto:"+this.sliceSerialize(ie)}function Ee(){return{type:"blockquote",children:[]}}function Ie(){return{type:"code",lang:null,meta:null,value:""}}function fe(){return{type:"inlineCode",value:""}}function pe(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Re(){return{type:"emphasis",children:[]}}function Ye(){return{type:"heading",depth:0,children:[]}}function ut(){return{type:"break"}}function Ge(){return{type:"html",value:""}}function Se(){return{type:"image",title:null,url:"",alt:null}}function qe(){return{type:"link",title:null,url:"",children:[]}}function Ue(ie){return{type:"list",ordered:ie.type==="listOrdered",start:null,spread:ie._spread,children:[]}}function ze(ie){return{type:"listItem",spread:ie._spread,checked:null,children:[]}}function lt(){return{type:"paragraph",children:[]}}function Ke(){return{type:"strong",children:[]}}function pt(){return{type:"text",value:""}}function Te(){return{type:"thematicBreak"}}}function uu(e){return{line:e.line,column:e.column,offset:e.offset}}function VE(e,n){let t=-1;for(;++t<n.length;){const r=n[t];Array.isArray(r)?VE(e,r):yK(e,r)}}function yK(e,n){let t;for(t in n)if(qE.call(n,t))switch(t){case"canContainEols":{const r=n[t];r&&e[t].push(...r);break}case"transforms":{const r=n[t];r&&e[t].push(...r);break}case"enter":case"exit":{const r=n[t];r&&Object.assign(e[t],r);break}}}function P_(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+ig({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+ig({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+ig({start:n.start,end:n.end})+") is still open")}function xK(e){const n=this;n.parser=t;function t(r){return mK(r,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}const I_={}.hasOwnProperty;function HE(e,n){const t=n||{};function r(a,...o){let l=r.invalid;const h=r.handlers;if(a&&I_.call(a,e)){const d=String(a[e]);l=I_.call(h,d)?h[d]:r.unknown}if(l)return l.call(this,a,...o)}return r.handlers=t.handlers||{},r.invalid=t.invalid,r.unknown=t.unknown,r}const bK={}.hasOwnProperty;function GE(e,n){let t=-1,r;if(n.extensions)for(;++t<n.extensions.length;)GE(e,n.extensions[t]);for(r in n)if(bK.call(n,r))switch(r){case"extensions":break;case"unsafe":{M_(e[r],n[r]);break}case"join":{M_(e[r],n[r]);break}case"handlers":{vK(e[r],n[r]);break}default:e.options[r]=n[r]}return e}function M_(e,n){n&&e.push(...n)}function vK(e,n){n&&Object.assign(e,n)}function wK(e,n,t,r){const a=t.enter("blockquote"),o=t.createTracker(r);o.move("> "),o.shift(2);const l=t.indentLines(t.containerFlow(e,o.current()),NK);return a(),l}function NK(e,n,t){return">"+(t?"":" ")+e}function YE(e,n){return R_(e,n.inConstruct,!0)&&!R_(e,n.notInConstruct,!1)}function R_(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let r=-1;for(;++r<n.length;)if(e.includes(n[r]))return!0;return!1}function O_(e,n,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&YE(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function SK(e,n){const t=String(e);let r=t.indexOf(n),a=r,o=0,l=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++o>l&&(l=o):o=1,a=r+n.length,r=t.indexOf(n,a);return l}function B1(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function jK(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function _K(e,n,t,r){const a=jK(t),o=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if(B1(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(o,CK);return g(),b}const h=t.createTracker(r),d=a.repeat(Math.max(SK(o,a)+1,3)),u=t.enter("codeFenced");let f=h.move(d);if(e.lang){const g=t.enter(`codeFencedLang${l}`);f+=h.move(t.safe(e.lang,{before:f,after:" ",encode:["`"],...h.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${l}`);f+=h.move(" "),f+=h.move(t.safe(e.meta,{before:f,after:`
`,encode:["`"],...h.current()})),g()}return f+=h.move(`
`),o&&(f+=h.move(o+`
`)),f+=h.move(d),u(),f}function CK(e,n,t){return(t?"":"    ")+e}function Kw(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function kK(e,n,t,r){const a=Kw(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("definition");let h=t.enter("label");const d=t.createTracker(r);let u=d.move("[");return u+=d.move(t.safe(t.associationId(e),{before:u,after:"]",...d.current()})),u+=d.move("]: "),h(),!e.url||/[\0- \u007F]/.test(e.url)?(h=t.enter("destinationLiteral"),u+=d.move("<"),u+=d.move(t.safe(e.url,{before:u,after:">",...d.current()})),u+=d.move(">")):(h=t.enter("destinationRaw"),u+=d.move(t.safe(e.url,{before:u,after:e.title?" ":`
`,...d.current()}))),h(),e.title&&(h=t.enter(`title${o}`),u+=d.move(" "+a),u+=d.move(t.safe(e.title,{before:u,after:a,...d.current()})),u+=d.move(a),h()),l(),u}function EK(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function mu(e){return"&#x"+e.toString(16).toUpperCase()+";"}function jb(e,n,t){const r=Sb(e),a=Sb(n);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}WE.peek=TK;function WE(e,n,t,r){const a=EK(t),o=t.enter("emphasis"),l=t.createTracker(r),h=l.move(a);let d=l.move(t.containerPhrasing(e,{after:a,before:h,...l.current()}));const u=d.charCodeAt(0),f=jb(r.before.charCodeAt(r.before.length-1),u,a);f.inside&&(d=mu(u)+d.slice(1));const g=d.charCodeAt(d.length-1),b=jb(r.after.charCodeAt(0),g,a);b.inside&&(d=d.slice(0,-1)+mu(g));const v=l.move(a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:f.outside},h+d+v}function TK(e,n,t){return t.options.emphasis||"*"}const Xw=function(e){if(e==null)return IK;if(typeof e=="function")return Xb(e);if(typeof e=="object")return Array.isArray(e)?AK(e):DK(e);if(typeof e=="string")return PK(e);throw new Error("Expected function, string, or object as test")};function AK(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=Xw(e[t]);return Xb(r);function r(...a){let o=-1;for(;++o<n.length;)if(n[o].apply(this,a))return!0;return!1}}function DK(e){const n=e;return Xb(t);function t(r){const a=r;let o;for(o in e)if(a[o]!==n[o])return!1;return!0}}function PK(e){return Xb(n);function n(t){return t&&t.type===e}}function Xb(e){return n;function n(t,r,a){return!!(MK(t)&&e.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function IK(){return!0}function MK(e){return e!==null&&typeof e=="object"&&"type"in e}const QE=[],RK=!0,U1=!1,OK="skip";function LK(e,n,t,r){let a;typeof n=="function"&&typeof t!="function"?(r=t,t=n):a=n;const o=Xw(a),l=r?-1:1;h(e,void 0,[])();function h(d,u,f){const g=d&&typeof d=="object"?d:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(d.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=QE,S,k,T;if((!n||o(d,u,f[f.length-1]||void 0))&&(v=FK(t(d,f)),v[0]===U1))return v;if("children"in d&&d.children){const E=d;if(E.children&&v[0]!==OK)for(k=(r?E.children.length:-1)+l,T=f.concat(E);k>-1&&k<E.children.length;){const P=E.children[k];if(S=h(P,k,T)(),S[0]===U1)return S;k=typeof S[1]=="number"?S[1]:k+l}}return v}}}function FK(e){return Array.isArray(e)?e:typeof e=="number"?[RK,e]:e==null?QE:[e]}function JE(e,n,t,r){let a,o,l;typeof n=="function"?(o=void 0,l=n,a=t):(o=n,l=t,a=r),LK(e,o,h,a);function h(d,u){const f=u[u.length-1],g=f?f.children.indexOf(d):void 0;return l(d,g,f)}}function KE(e,n){let t=!1;return JE(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,U1}),!!((!e.depth||e.depth<3)&&Yw(e)&&(n.options.setext||t))}function $K(e,n,t,r){const a=Math.max(Math.min(6,e.depth||1),1),o=t.createTracker(r);if(KE(e,t)){const f=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...o.current(),before:`
`,after:`
`});return g(),f(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const l="#".repeat(a),h=t.enter("headingAtx"),d=t.enter("phrasing");o.move(l+" ");let u=t.containerPhrasing(e,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(u)&&(u=mu(u.charCodeAt(0))+u.slice(1)),u=u?l+" "+u:l,t.options.closeAtx&&(u+=" "+l),d(),h(),u}XE.peek=zK;function XE(e){return e.value||""}function zK(){return"<"}ZE.peek=BK;function ZE(e,n,t,r){const a=Kw(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("image");let h=t.enter("label");const d=t.createTracker(r);let u=d.move("![");return u+=d.move(t.safe(e.alt,{before:u,after:"]",...d.current()})),u+=d.move("]("),h(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(h=t.enter("destinationLiteral"),u+=d.move("<"),u+=d.move(t.safe(e.url,{before:u,after:">",...d.current()})),u+=d.move(">")):(h=t.enter("destinationRaw"),u+=d.move(t.safe(e.url,{before:u,after:e.title?" ":")",...d.current()}))),h(),e.title&&(h=t.enter(`title${o}`),u+=d.move(" "+a),u+=d.move(t.safe(e.title,{before:u,after:a,...d.current()})),u+=d.move(a),h()),u+=d.move(")"),l(),u}function BK(){return"!"}eT.peek=UK;function eT(e,n,t,r){const a=e.referenceType,o=t.enter("imageReference");let l=t.enter("label");const h=t.createTracker(r);let d=h.move("![");const u=t.safe(e.alt,{before:d,after:"]",...h.current()});d+=h.move(u+"]["),l();const f=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:d,after:"]",...h.current()});return l(),t.stack=f,o(),a==="full"||!u||u!==g?d+=h.move(g+"]"):a==="shortcut"?d=d.slice(0,-1):d+=h.move("]"),d}function UK(){return"!"}tT.peek=qK;function tT(e,n,t){let r=e.value||"",a="`",o=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++o<t.unsafe.length;){const l=t.unsafe[o],h=t.compilePattern(l);let d;if(l.atBreak)for(;d=h.exec(r);){let u=d.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(d.index+1)}}return a+r+a}function qK(){return"`"}function nT(e,n){const t=Yw(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}iT.peek=VK;function iT(e,n,t,r){const a=Kw(t),o=a==='"'?"Quote":"Apostrophe",l=t.createTracker(r);let h,d;if(nT(e,t)){const f=t.stack;t.stack=[],h=t.enter("autolink");let g=l.move("<");return g+=l.move(t.containerPhrasing(e,{before:g,after:">",...l.current()})),g+=l.move(">"),h(),t.stack=f,g}h=t.enter("link"),d=t.enter("label");let u=l.move("[");return u+=l.move(t.containerPhrasing(e,{before:u,after:"](",...l.current()})),u+=l.move("]("),d(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(t.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(d=t.enter("destinationRaw"),u+=l.move(t.safe(e.url,{before:u,after:e.title?" ":")",...l.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=l.move(" "+a),u+=l.move(t.safe(e.title,{before:u,after:a,...l.current()})),u+=l.move(a),d()),u+=l.move(")"),h(),u}function VK(e,n,t){return nT(e,t)?"<":"["}rT.peek=HK;function rT(e,n,t,r){const a=e.referenceType,o=t.enter("linkReference");let l=t.enter("label");const h=t.createTracker(r);let d=h.move("[");const u=t.containerPhrasing(e,{before:d,after:"]",...h.current()});d+=h.move(u+"]["),l();const f=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:d,after:"]",...h.current()});return l(),t.stack=f,o(),a==="full"||!u||u!==g?d+=h.move(g+"]"):a==="shortcut"?d=d.slice(0,-1):d+=h.move("]"),d}function HK(){return"["}function Zw(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function GK(e){const n=Zw(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function YK(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function aT(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function WK(e,n,t,r){const a=t.enter("list"),o=t.bulletCurrent;let l=e.ordered?YK(t):Zw(t);const h=e.ordered?l==="."?")":".":GK(t);let d=n&&t.bulletLastUsed?l===t.bulletLastUsed:!1;if(!e.ordered){const f=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&f&&(!f.children||!f.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(d=!0),aT(t)===l&&f){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){d=!0;break}}}}d&&(l=h),t.bulletCurrent=l;const u=t.containerFlow(e,r);return t.bulletLastUsed=l,t.bulletCurrent=o,a(),u}function QK(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function JK(e,n,t,r){const a=QK(t);let o=t.bulletCurrent||Zw(t);n&&n.type==="list"&&n.ordered&&(o=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+o);let l=o.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(l=Math.ceil(l/4)*4);const h=t.createTracker(r);h.move(o+" ".repeat(l-o.length)),h.shift(l);const d=t.enter("listItem"),u=t.indentLines(t.containerFlow(e,h.current()),f);return d(),u;function f(g,b,v){return b?(v?"":" ".repeat(l))+g:(v?o:o+" ".repeat(l-o.length))+g}}function KK(e,n,t,r){const a=t.enter("paragraph"),o=t.enter("phrasing"),l=t.containerPhrasing(e,r);return o(),a(),l}const XK=Xw(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function ZK(e,n,t,r){return(e.children.some(function(l){return XK(l)})?t.containerPhrasing:t.containerFlow).call(t,e,r)}function eX(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}sT.peek=tX;function sT(e,n,t,r){const a=eX(t),o=t.enter("strong"),l=t.createTracker(r),h=l.move(a+a);let d=l.move(t.containerPhrasing(e,{after:a,before:h,...l.current()}));const u=d.charCodeAt(0),f=jb(r.before.charCodeAt(r.before.length-1),u,a);f.inside&&(d=mu(u)+d.slice(1));const g=d.charCodeAt(d.length-1),b=jb(r.after.charCodeAt(0),g,a);b.inside&&(d=d.slice(0,-1)+mu(g));const v=l.move(a+a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:f.outside},h+d+v}function tX(e,n,t){return t.options.strong||"*"}function nX(e,n,t,r){return t.safe(e.value,r)}function iX(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function rX(e,n,t){const r=(aT(t)+(t.options.ruleSpaces?" ":"")).repeat(iX(t));return t.options.ruleSpaces?r.slice(0,-1):r}const aX={blockquote:wK,break:O_,code:_K,definition:kK,emphasis:WE,hardBreak:O_,heading:$K,html:XE,image:ZE,imageReference:eT,inlineCode:tT,link:iT,linkReference:rT,list:WK,listItem:JK,paragraph:KK,root:ZK,strong:sT,text:nX,thematicBreak:rX},sX=[oX];function oX(e,n,t,r){if(n.type==="code"&&B1(n,r)&&(e.type==="list"||e.type===n.type&&B1(e,r)))return!1;if("spread"in t&&typeof t.spread=="boolean")return e.type==="paragraph"&&(e.type===n.type||n.type==="definition"||n.type==="heading"&&KE(n,r))?void 0:t.spread?1:0}const Pd=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],lX=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:Pd},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:Pd},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:Pd},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:Pd},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:Pd},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:Pd},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:Pd},{atBreak:!0,character:"~"}];function cX(e){return e.label||!e.identifier?e.label||"":UE(e.identifier)}function uX(e){if(!e._compiled){const n=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((n?"("+n+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function dX(e,n,t){const r=n.indexStack,a=e.children||[],o=[];let l=-1,h=t.before,d;r.push(-1);let u=n.createTracker(t);for(;++l<a.length;){const f=a[l];let g;if(r[r.length-1]=l,l+1<a.length){let S=n.handle.handlers[a[l+1].type];S&&S.peek&&(S=S.peek),g=S?S(a[l+1],e,n,{before:"",after:"",...u.current()}).charAt(0):""}else g=t.after;o.length>0&&(h==="\r"||h===`
`)&&f.type==="html"&&(o[o.length-1]=o[o.length-1].replace(/(\r?\n|\r)$/," "),h=" ",u=n.createTracker(t),u.move(o.join("")));let b=n.handle(f,e,n,{...u.current(),after:g,before:h});d&&d===b.slice(0,1)&&(b=mu(d.charCodeAt(0))+b.slice(1));const v=n.attentionEncodeSurroundingInfo;n.attentionEncodeSurroundingInfo=void 0,d=void 0,v&&(o.length>0&&v.before&&h===o[o.length-1].slice(-1)&&(o[o.length-1]=o[o.length-1].slice(0,-1)+mu(h.charCodeAt(0))),v.after&&(d=g)),u.move(b),o.push(b),h=b.slice(-1)}return r.pop(),o.join("")}function hX(e,n,t){const r=n.indexStack,a=e.children||[],o=n.createTracker(t),l=[];let h=-1;for(r.push(-1);++h<a.length;){const d=a[h];r[r.length-1]=h,l.push(o.move(n.handle(d,e,n,{before:`
`,after:`
`,...o.current()}))),d.type!=="list"&&(n.bulletLastUsed=void 0),h<a.length-1&&l.push(o.move(fX(d,a[h+1],e,n)))}return r.pop(),l.join("")}function fX(e,n,t,r){let a=r.join.length;for(;a--;){const o=r.join[a](e,n,t,r);if(o===!0||o===1)break;if(typeof o=="number")return`
`.repeat(1+o);if(o===!1)return`

<!---->

`}return`

`}const pX=/\r?\n|\r/g;function mX(e,n){const t=[];let r=0,a=0,o;for(;o=pX.exec(e);)l(e.slice(r,o.index)),t.push(o[0]),r=o.index+o[0].length,a++;return l(e.slice(r)),t.join("");function l(h){t.push(n(h,a,!h))}}function gX(e,n,t){const r=(t.before||"")+(n||"")+(t.after||""),a=[],o=[],l={};let h=-1;for(;++h<e.unsafe.length;){const f=e.unsafe[h];if(!YE(e.stack,f))continue;const g=e.compilePattern(f);let b;for(;b=g.exec(r);){const v="before"in f||!!f.atBreak,S="after"in f,k=b.index+(v?b[1].length:0);a.includes(k)?(l[k].before&&!v&&(l[k].before=!1),l[k].after&&!S&&(l[k].after=!1)):(a.push(k),l[k]={before:v,after:S})}}a.sort(yX);let d=t.before?t.before.length:0;const u=r.length-(t.after?t.after.length:0);for(h=-1;++h<a.length;){const f=a[h];f<d||f>=u||f+1<u&&a[h+1]===f+1&&l[f].after&&!l[f+1].before&&!l[f+1].after||a[h-1]===f-1&&l[f].before&&!l[f-1].before&&!l[f-1].after||(d!==f&&o.push(L_(r.slice(d,f),"\\")),d=f,/[!-/:-@[-`{-~]/.test(r.charAt(f))&&(!t.encode||!t.encode.includes(r.charAt(f)))?o.push("\\"):(o.push(mu(r.charCodeAt(f))),d++))}return o.push(L_(r.slice(d,u),t.after)),o.join("")}function yX(e,n){return e-n}function L_(e,n){const t=/\\(?=[!-/:-@[-`{-~])/g,r=[],a=[],o=e+n;let l=-1,h=0,d;for(;d=t.exec(o);)r.push(d.index);for(;++l<r.length;)h!==r[l]&&a.push(e.slice(h,r[l])),a.push("\\"),h=r[l];return a.push(e.slice(h)),a.join("")}function xX(e){const n=e||{},t=n.now||{};let r=n.lineShift||0,a=t.line||1,o=t.column||1;return{move:d,current:l,shift:h};function l(){return{now:{line:a,column:o},lineShift:r}}function h(u){r+=u}function d(u){const f=u||"",g=f.split(/\r?\n|\r/g),b=g[g.length-1];return a+=g.length-1,o=g.length===1?o+b.length:1+b.length+r,f}}function bX(e,n){const t=n||{},r={associationId:cX,containerPhrasing:SX,containerFlow:jX,createTracker:xX,compilePattern:uX,enter:o,handlers:{...aX},handle:void 0,indentLines:mX,indexStack:[],join:[...sX],options:{},safe:_X,stack:[],unsafe:[...lX]};GE(r,t),r.options.tightDefinitions&&r.join.push(NX),r.handle=HE("type",{invalid:vX,unknown:wX,handlers:r.handlers});let a=r.handle(e,void 0,r,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return a&&a.charCodeAt(a.length-1)!==10&&a.charCodeAt(a.length-1)!==13&&(a+=`
`),a;function o(l){return r.stack.push(l),h;function h(){r.stack.pop()}}}function vX(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function wX(e){const n=e;throw new Error("Cannot handle unknown node `"+n.type+"`")}function NX(e,n){if(e.type==="definition"&&e.type===n.type)return 0}function SX(e,n){return dX(e,this,n)}function jX(e,n){return hX(e,this,n)}function _X(e,n){return gX(this,e,n)}function CX(e){const n=this;n.compiler=t;function t(r){return bX(r,{...n.data("settings"),...e,extensions:n.data("toMarkdownExtensions")||[]})}}function F_(e){if(e)throw e}var $0,$_;function kX(){if($_)return $0;$_=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(u){return typeof Array.isArray=="function"?Array.isArray(u):n.call(u)==="[object Array]"},o=function(u){if(!u||n.call(u)!=="[object Object]")return!1;var f=e.call(u,"constructor"),g=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!f&&!g)return!1;var b;for(b in u);return typeof b>"u"||e.call(u,b)},l=function(u,f){t&&f.name==="__proto__"?t(u,f.name,{enumerable:!0,configurable:!0,value:f.newValue,writable:!0}):u[f.name]=f.newValue},h=function(u,f){if(f==="__proto__")if(e.call(u,f)){if(r)return r(u,f).value}else return;return u[f]};return $0=function d(){var u,f,g,b,v,S,k=arguments[0],T=1,E=arguments.length,P=!1;for(typeof k=="boolean"&&(P=k,k=arguments[1]||{},T=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});T<E;++T)if(u=arguments[T],u!=null)for(f in u)g=h(k,f),b=h(u,f),k!==b&&(P&&b&&(o(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&o(g)?g:{},l(k,{name:f,newValue:d(P,S,b)})):typeof b<"u"&&l(k,{name:f,newValue:b}));return k},$0}var EX=kX();const z0=qd(EX);function q1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function TX(){const e=[],n={run:t,use:r};return n;function t(...a){let o=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);h(null,...a);function h(d,...u){const f=e[++o];let g=-1;if(d){l(d);return}for(;++g<a.length;)(u[g]===null||u[g]===void 0)&&(u[g]=a[g]);a=u,f?AX(f,h)(...u):l(null,...u)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function AX(e,n){let t;return r;function r(...l){const h=e.length>l.length;let d;h&&l.push(a);try{d=e.apply(this,l)}catch(u){const f=u;if(h&&t)throw f;return a(f)}h||(d&&d.then&&typeof d.then=="function"?d.then(o,a):d instanceof Error?a(d):o(d))}function a(l,...h){t||(t=!0,n(l,...h))}function o(l){a(null,l)}}class Da extends Error{constructor(n,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",o={},l=!1;if(t&&("line"in t&&"column"in t?o={place:t}:"start"in t&&"end"in t?o={place:t}:"type"in t?o={ancestors:[t],place:t.position}:o={...t}),typeof n=="string"?a=n:!o.cause&&n&&(l=!0,a=n.message,o.cause=n),!o.ruleId&&!o.source&&typeof r=="string"){const d=r.indexOf(":");d===-1?o.ruleId=r:(o.source=r.slice(0,d),o.ruleId=r.slice(d+1))}if(!o.place&&o.ancestors&&o.ancestors){const d=o.ancestors[o.ancestors.length-1];d&&(o.place=d.position)}const h=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=h?h.column:void 0,this.fatal=void 0,this.file="",this.message=a,this.line=h?h.line:void 0,this.name=ig(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=l&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}Da.prototype.file="";Da.prototype.name="";Da.prototype.reason="";Da.prototype.message="";Da.prototype.stack="";Da.prototype.column=void 0;Da.prototype.line=void 0;Da.prototype.ancestors=void 0;Da.prototype.cause=void 0;Da.prototype.fatal=void 0;Da.prototype.place=void 0;Da.prototype.ruleId=void 0;Da.prototype.source=void 0;const sl={basename:DX,dirname:PX,extname:IX,join:MX,sep:"/"};function DX(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');_g(e);let t=0,r=-1,a=e.length,o;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else r<0&&(o=!0,r=a+1);return r<0?"":e.slice(t,r)}if(n===e)return"";let l=-1,h=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else l<0&&(o=!0,l=a+1),h>-1&&(e.codePointAt(a)===n.codePointAt(h--)?h<0&&(r=a):(h=-1,r=l));return t===r?r=l:r<0&&(r=e.length),e.slice(t,r)}function PX(e){if(_g(e),e.length===0)return".";let n=-1,t=e.length,r;for(;--t;)if(e.codePointAt(t)===47){if(r){n=t;break}}else r||(r=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function IX(e){_g(e);let n=e.length,t=-1,r=0,a=-1,o=0,l;for(;n--;){const h=e.codePointAt(n);if(h===47){if(l){r=n+1;break}continue}t<0&&(l=!0,t=n+1),h===46?a<0?a=n:o!==1&&(o=1):a>-1&&(o=-1)}return a<0||t<0||o===0||o===1&&a===t-1&&a===r+1?"":e.slice(a,t)}function MX(...e){let n=-1,t;for(;++n<e.length;)_g(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":RX(t)}function RX(e){_g(e);const n=e.codePointAt(0)===47;let t=OX(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function OX(e,n){let t="",r=0,a=-1,o=0,l=-1,h,d;for(;++l<=e.length;){if(l<e.length)h=e.codePointAt(l);else{if(h===47)break;h=47}if(h===47){if(!(a===l-1||o===1))if(a!==l-1&&o===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(d=t.lastIndexOf("/"),d!==t.length-1){d<0?(t="",r=0):(t=t.slice(0,d),r=t.length-1-t.lastIndexOf("/")),a=l,o=0;continue}}else if(t.length>0){t="",r=0,a=l,o=0;continue}}n&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+e.slice(a+1,l):t=e.slice(a+1,l),r=l-a-1;a=l,o=0}else h===46&&o>-1?o++:o=-1}return t}function _g(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const LX={cwd:FX};function FX(){return"/"}function V1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function $X(e){if(typeof e=="string")e=new URL(e);else if(!V1(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return zX(e)}function zX(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const r=n.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const B0=["history","path","basename","stem","extname","dirname"];class BX{constructor(n){let t;n?V1(n)?t={path:n}:typeof n=="string"||UX(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":LX.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<B0.length;){const o=B0[r];o in t&&t[o]!==void 0&&t[o]!==null&&(this[o]=o==="history"?[...t[o]]:t[o])}let a;for(a in t)B0.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?sl.basename(this.path):void 0}set basename(n){q0(n,"basename"),U0(n,"basename"),this.path=sl.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?sl.dirname(this.path):void 0}set dirname(n){z_(this.basename,"dirname"),this.path=sl.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?sl.extname(this.path):void 0}set extname(n){if(U0(n,"extname"),z_(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=sl.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){V1(n)&&(n=$X(n)),q0(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?sl.basename(this.path,this.extname):void 0}set stem(n){q0(n,"stem"),U0(n,"stem"),this.path=sl.join(this.dirname||"",n+(this.extname||""))}fail(n,t,r){const a=this.message(n,t,r);throw a.fatal=!0,a}info(n,t,r){const a=this.message(n,t,r);return a.fatal=void 0,a}message(n,t,r){const a=new Da(n,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}}function U0(e,n){if(e&&e.includes(sl.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+sl.sep+"`")}function q0(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function z_(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function UX(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const qX=function(e){const r=this.constructor.prototype,a=r[e],o=function(){return a.apply(o,arguments)};return Object.setPrototypeOf(o,r),o},VX={}.hasOwnProperty;class eN extends qX{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=TX()}copy(){const n=new eN;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];n.use(...r)}return n.data(z0(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(G0("data",this.frozen),this.namespace[n]=t,this):VX.call(this.namespace,n)&&this.namespace[n]||void 0:n?(G0("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(n,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=Fx(n),r=this.parser||this.Parser;return V0("parse",r),r(String(t),t)}process(n,t){const r=this;return this.freeze(),V0("process",this.parser||this.Parser),H0("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(o,l){const h=Fx(n),d=r.parse(h);r.run(d,h,function(f,g,b){if(f||!g||!b)return u(f);const v=g,S=r.stringify(v,b);YX(S)?b.value=S:b.result=S,u(f,b)});function u(f,g){f||!g?l(f):o?o(g):t(void 0,g)}}}processSync(n){let t=!1,r;return this.freeze(),V0("processSync",this.parser||this.Parser),H0("processSync",this.compiler||this.Compiler),this.process(n,a),U_("processSync","process",t),r;function a(o,l){t=!0,F_(o),r=l}}run(n,t,r){B_(n),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?o(void 0,r):new Promise(o);function o(l,h){const d=Fx(t);a.run(n,d,u);function u(f,g,b){const v=g||n;f?h(f):l?l(v):r(void 0,v,b)}}}runSync(n,t){let r=!1,a;return this.run(n,t,o),U_("runSync","run",r),a;function o(l,h){F_(l),a=h,r=!0}}stringify(n,t){this.freeze();const r=Fx(t),a=this.compiler||this.Compiler;return H0("stringify",a),B_(n),a(n,r)}use(n,...t){const r=this.attachers,a=this.namespace;if(G0("use",this.frozen),n!=null)if(typeof n=="function")d(n,t);else if(typeof n=="object")Array.isArray(n)?h(n):l(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function o(u){if(typeof u=="function")d(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[f,...g]=u;d(f,g)}else l(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function l(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");h(u.plugins),u.settings&&(a.settings=z0(!0,a.settings,u.settings))}function h(u){let f=-1;if(u!=null)if(Array.isArray(u))for(;++f<u.length;){const g=u[f];o(g)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function d(u,f){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===u){b=g;break}if(b===-1)r.push([u,...f]);else if(f.length>0){let[v,...S]=f;const k=r[b][1];q1(k)&&q1(v)&&(v=z0(!0,k,v)),r[b]=[u,v,...S]}}}}const HX=new eN().freeze();function V0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function H0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function G0(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function B_(e){if(!q1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function U_(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function Fx(e){return GX(e)?e:new BX(e)}function GX(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function YX(e){return typeof e=="string"||WX(e)}function WX(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const QX=HX().use(xK).use(CX).freeze(),oT=-1,Zb=0,rg=1,_b=2,tN=3,nN=4,iN=5,rN=6,lT=7,cT=8,q_=typeof self=="object"?self:globalThis,JX=(e,n)=>{const t=(a,o)=>(e.set(o,a),a),r=a=>{if(e.has(a))return e.get(a);const[o,l]=n[a];switch(o){case Zb:case oT:return t(l,a);case rg:{const h=t([],a);for(const d of l)h.push(r(d));return h}case _b:{const h=t({},a);for(const[d,u]of l)h[r(d)]=r(u);return h}case tN:return t(new Date(l),a);case nN:{const{source:h,flags:d}=l;return t(new RegExp(h,d),a)}case iN:{const h=t(new Map,a);for(const[d,u]of l)h.set(r(d),r(u));return h}case rN:{const h=t(new Set,a);for(const d of l)h.add(r(d));return h}case lT:{const{name:h,message:d}=l;return t(new q_[h](d),a)}case cT:return t(BigInt(l),a);case"BigInt":return t(Object(BigInt(l)),a);case"ArrayBuffer":return t(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:h}=new Uint8Array(l);return t(new DataView(h),l)}}return t(new q_[o](l),a)};return r},V_=e=>JX(new Map,e)(0),Cf="",{toString:KX}={},{keys:XX}=Object,Ym=e=>{const n=typeof e;if(n!=="object"||!e)return[Zb,n];const t=KX.call(e).slice(8,-1);switch(t){case"Array":return[rg,Cf];case"Object":return[_b,Cf];case"Date":return[tN,Cf];case"RegExp":return[nN,Cf];case"Map":return[iN,Cf];case"Set":return[rN,Cf];case"DataView":return[rg,t]}return t.includes("Array")?[rg,t]:t.includes("Error")?[lT,t]:[_b,t]},$x=([e,n])=>e===Zb&&(n==="function"||n==="symbol"),ZX=(e,n,t,r)=>{const a=(l,h)=>{const d=r.push(l)-1;return t.set(h,d),d},o=l=>{if(t.has(l))return t.get(l);let[h,d]=Ym(l);switch(h){case Zb:{let f=l;switch(d){case"bigint":h=cT,f=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+d);f=null;break;case"undefined":return a([oT],l)}return a([h,f],l)}case rg:{if(d){let b=l;return d==="DataView"?b=new Uint8Array(l.buffer):d==="ArrayBuffer"&&(b=new Uint8Array(l)),a([d,[...b]],l)}const f=[],g=a([h,f],l);for(const b of l)f.push(o(b));return g}case _b:{if(d)switch(d){case"BigInt":return a([d,l.toString()],l);case"Boolean":case"Number":case"String":return a([d,l.valueOf()],l)}if(n&&"toJSON"in l)return o(l.toJSON());const f=[],g=a([h,f],l);for(const b of XX(l))(e||!$x(Ym(l[b])))&&f.push([o(b),o(l[b])]);return g}case tN:return a([h,l.toISOString()],l);case nN:{const{source:f,flags:g}=l;return a([h,{source:f,flags:g}],l)}case iN:{const f=[],g=a([h,f],l);for(const[b,v]of l)(e||!($x(Ym(b))||$x(Ym(v))))&&f.push([o(b),o(v)]);return g}case rN:{const f=[],g=a([h,f],l);for(const b of l)(e||!$x(Ym(b)))&&f.push(o(b));return g}}const{message:u}=l;return a([h,{name:d,message:u}],l)};return o},H_=(e,{json:n,lossy:t}={})=>{const r=[];return ZX(!(n||t),!!n,new Map,r)(e),r},gg=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?V_(H_(e,n)):structuredClone(e):(e,n)=>V_(H_(e,n)),uT=hT("end"),dT=hT("start");function hT(e){return n;function n(t){const r=t&&t.position&&t.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function fT(e){const n=dT(e),t=uT(e);if(n&&t)return{start:n,end:t}}const Id=["ariaDescribedBy","ariaLabel","ariaLabelledBy"],G_={ancestors:{tbody:["table"],td:["table"],th:["table"],thead:["table"],tfoot:["table"],tr:["table"]},attributes:{a:[...Id,"dataFootnoteBackref","dataFootnoteRef",["className","data-footnote-backref"],"href"],blockquote:["cite"],code:[["className",/^language-./]],del:["cite"],div:["itemScope","itemType"],dl:[...Id],h2:[["className","sr-only"]],img:[...Id,"longDesc","src"],input:[["disabled",!0],["type","checkbox"]],ins:["cite"],li:[["className","task-list-item"]],ol:[...Id,["className","contains-task-list"]],q:["cite"],section:["dataFootnotes",["className","footnotes"]],source:["srcSet"],summary:[...Id],table:[...Id],ul:[...Id,["className","contains-task-list"]],"*":["abbr","accept","acceptCharset","accessKey","action","align","alt","axis","border","cellPadding","cellSpacing","char","charOff","charSet","checked","clear","colSpan","color","cols","compact","coords","dateTime","dir","encType","frame","hSpace","headers","height","hrefLang","htmlFor","id","isMap","itemProp","label","lang","maxLength","media","method","multiple","name","noHref","noShade","noWrap","open","prompt","readOnly","rev","rowSpan","rows","rules","scope","selected","shape","size","span","start","summary","tabIndex","title","useMap","vAlign","value","width"]},clobber:["ariaDescribedBy","ariaLabelledBy","id","name"],clobberPrefix:"user-content-",protocols:{cite:["http","https"],href:["http","https","irc","ircs","mailto","xmpp"],longDesc:["http","https"],src:["http","https"]},required:{input:{disabled:!0,type:"checkbox"}},strip:["script"],tagNames:["a","b","blockquote","br","code","dd","del","details","div","dl","dt","em","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","li","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","tr","tt","ul","var"]},hu={}.hasOwnProperty;function eZ(e,n){let t={type:"root",children:[]};const r={schema:n?{...G_,...n}:G_,stack:[]},a=pT(r,e);return a&&(Array.isArray(a)?a.length===1?t=a[0]:t.children=a:t=a),t}function pT(e,n){if(n&&typeof n=="object"){const t=n;switch(typeof t.type=="string"?t.type:""){case"comment":return tZ(e,t);case"doctype":return nZ(e,t);case"element":return iZ(e,t);case"root":return rZ(e,t);case"text":return aZ(e,t)}}}function tZ(e,n){if(e.schema.allowComments){const t=typeof n.value=="string"?n.value:"",r=t.indexOf("-->"),o={type:"comment",value:r<0?t:t.slice(0,r)};return Cg(o,n),o}}function nZ(e,n){if(e.schema.allowDoctypes){const t={type:"doctype"};return Cg(t,n),t}}function iZ(e,n){const t=typeof n.tagName=="string"?n.tagName:"";e.stack.push(t);const r=mT(e,n.children),a=sZ(e,n.properties);e.stack.pop();let o=!1;if(t&&t!=="*"&&(!e.schema.tagNames||e.schema.tagNames.includes(t))&&(o=!0,e.schema.ancestors&&hu.call(e.schema.ancestors,t))){const h=e.schema.ancestors[t];let d=-1;for(o=!1;++d<h.length;)e.stack.includes(h[d])&&(o=!0)}if(!o)return e.schema.strip&&!e.schema.strip.includes(t)?r:void 0;const l={type:"element",tagName:t,properties:a,children:r};return Cg(l,n),l}function rZ(e,n){const r={type:"root",children:mT(e,n.children)};return Cg(r,n),r}function aZ(e,n){const r={type:"text",value:typeof n.value=="string"?n.value:""};return Cg(r,n),r}function mT(e,n){const t=[];if(Array.isArray(n)){const r=n;let a=-1;for(;++a<r.length;){const o=pT(e,r[a]);o&&(Array.isArray(o)?t.push(...o):t.push(o))}}return t}function sZ(e,n){const t=e.stack[e.stack.length-1],r=e.schema.attributes,a=e.schema.required,o=r&&hu.call(r,t)?r[t]:void 0,l=r&&hu.call(r,"*")?r["*"]:void 0,h=n&&typeof n=="object"?n:{},d={};let u;for(u in h)if(hu.call(h,u)){const f=h[u];let g=Y_(e,W_(o,u),u,f);g==null&&(g=Y_(e,W_(l,u),u,f)),g!=null&&(d[u]=g)}if(a&&hu.call(a,t)){const f=a[t];for(u in f)hu.call(f,u)&&!hu.call(d,u)&&(d[u]=f[u])}return d}function Y_(e,n,t,r){return n?Array.isArray(r)?oZ(e,n,t,r):gT(e,n,t,r):void 0}function oZ(e,n,t,r){let a=-1;const o=[];for(;++a<r.length;){const l=gT(e,n,t,r[a]);(typeof l=="number"||typeof l=="string")&&o.push(l)}return o}function gT(e,n,t,r){if(!(typeof r!="boolean"&&typeof r!="number"&&typeof r!="string")&&lZ(e,t,r)){if(typeof n=="object"&&n.length>1){let a=!1,o=0;for(;++o<n.length;){const l=n[o];if(l&&typeof l=="object"&&"flags"in l){if(l.test(String(r))){a=!0;break}}else if(l===r){a=!0;break}}if(!a)return}return e.schema.clobber&&e.schema.clobberPrefix&&e.schema.clobber.includes(t)?e.schema.clobberPrefix+r:r}}function lZ(e,n,t){const r=e.schema.protocols&&hu.call(e.schema.protocols,n)?e.schema.protocols[n]:void 0;if(!r||r.length===0)return!0;const a=String(t),o=a.indexOf(":"),l=a.indexOf("?"),h=a.indexOf("#"),d=a.indexOf("/");if(o<0||d>-1&&o>d||l>-1&&o>l||h>-1&&o>h)return!0;let u=-1;for(;++u<r.length;){const f=r[u];if(o===f.length&&a.slice(0,f.length)===f)return!0}return!1}function Cg(e,n){const t=fT(n);n.data&&(e.data=gg(n.data)),t&&(e.position=t)}function W_(e,n){let t,r=-1;if(e)for(;++r<e.length;){const a=e[r],o=typeof a=="string"?a:a[0];if(o===n)return a;o==="data*"&&(t=a)}if(n.length>4&&n.slice(0,4).toLowerCase()==="data")return t}function cZ(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function uZ(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function dZ(e,n){const t=n.value?n.value+`
`:"",r={};n.lang&&(r.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function hZ(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function fZ(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function pZ(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(n.identifier).toUpperCase(),a=ip(r.toLowerCase()),o=e.footnoteOrder.indexOf(r);let l,h=e.footnoteCounts.get(r);h===void 0?(h=0,e.footnoteOrder.push(r),l=e.footnoteOrder.length):l=o+1,h+=1,e.footnoteCounts.set(r,h);const d={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(h>1?"-"+h:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(n,d);const u={type:"element",tagName:"sup",properties:{},children:[d]};return e.patch(n,u),e.applyData(n,u)}function mZ(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function gZ(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function yT(e,n){const t=n.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+r}];const a=e.all(n),o=a[0];o&&o.type==="text"?o.value="["+o.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=r:a.push({type:"text",value:r}),a}function yZ(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return yT(e,n);const a={src:ip(r.url||""),alt:n.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,o),e.applyData(n,o)}function xZ(e,n){const t={src:ip(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,r),e.applyData(n,r)}function bZ(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,r),e.applyData(n,r)}function vZ(e,n){const t=String(n.identifier).toUpperCase(),r=e.definitionById.get(t);if(!r)return yT(e,n);const a={href:ip(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const o={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,o),e.applyData(n,o)}function wZ(e,n){const t={href:ip(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const r={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function NZ(e,n,t){const r=e.all(n),a=t?SZ(t):xT(n),o={},l=[];if(typeof n.checked=="boolean"){const f=r[0];let g;f&&f.type==="element"&&f.tagName==="p"?g=f:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let h=-1;for(;++h<r.length;){const f=r[h];(a||h!==0||f.type!=="element"||f.tagName!=="p")&&l.push({type:"text",value:`
`}),f.type==="element"&&f.tagName==="p"&&!a?l.push(...f.children):l.push(f)}const d=r[r.length-1];d&&(a||d.type!=="element"||d.tagName!=="p")&&l.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:o,children:l};return e.patch(n,u),e.applyData(n,u)}function SZ(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let r=-1;for(;!n&&++r<t.length;)n=xT(t[r])}return n}function xT(e){const n=e.spread;return n??e.children.length>1}function jZ(e,n){const t={},r=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<r.length;){const l=r[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const o={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(r,!0)};return e.patch(n,o),e.applyData(n,o)}function _Z(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function CZ(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function kZ(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function EZ(e,n){const t=e.all(n),r=t.shift(),a=[];if(r){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(n.children[0],l),a.push(l)}if(t.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},h=dT(n.children[1]),d=uT(n.children[n.children.length-1]);h&&d&&(l.position={start:h,end:d}),a.push(l)}const o={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,o),e.applyData(n,o)}function TZ(e,n,t){const r=t?t.children:void 0,o=(r?r.indexOf(n):1)===0?"th":"td",l=t&&t.type==="table"?t.align:void 0,h=l?l.length:n.children.length;let d=-1;const u=[];for(;++d<h;){const g=n.children[d],b={},v=l?l[d]:void 0;v&&(b.align=v);let S={type:"element",tagName:o,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),u.push(S)}const f={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(n,f),e.applyData(n,f)}function AZ(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const Q_=9,J_=32;function DZ(e){const n=String(e),t=/\r?\n|\r/g;let r=t.exec(n),a=0;const o=[];for(;r;)o.push(K_(n.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(n);return o.push(K_(n.slice(a),a>0,!1)),o.join("")}function K_(e,n,t){let r=0,a=e.length;if(n){let o=e.codePointAt(r);for(;o===Q_||o===J_;)r++,o=e.codePointAt(r)}if(t){let o=e.codePointAt(a-1);for(;o===Q_||o===J_;)a--,o=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function PZ(e,n){const t={type:"text",value:DZ(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function IZ(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const MZ={blockquote:cZ,break:uZ,code:dZ,delete:hZ,emphasis:fZ,footnoteReference:pZ,heading:mZ,html:gZ,imageReference:yZ,image:xZ,inlineCode:bZ,linkReference:vZ,link:wZ,listItem:NZ,list:jZ,paragraph:_Z,root:CZ,strong:kZ,table:EZ,tableCell:AZ,tableRow:TZ,text:PZ,thematicBreak:IZ,toml:zx,yaml:zx,definition:zx,footnoteDefinition:zx};function zx(){}function RZ(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function OZ(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function LZ(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||RZ,r=e.options.footnoteBackLabel||OZ,a=e.options.footnoteLabel||"Footnotes",o=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},h=[];let d=-1;for(;++d<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[d]);if(!u)continue;const f=e.all(u),g=String(u.identifier).toUpperCase(),b=ip(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let P=typeof t=="string"?t:t(d,v);typeof P=="string"&&(P={type:"text",value:P}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(d,v),className:["data-footnote-backref"]},children:Array.isArray(P)?P:[P]})}const T=f[f.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const P=T.children[T.children.length-1];P&&P.type==="text"?P.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...S)}else f.push(...S);const E={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(f,!0)};e.patch(u,E),h.push(E)}if(h.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...gg(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(h,!0)},{type:"text",value:`
`}]}}const H1={}.hasOwnProperty,FZ={};function $Z(e,n){const t=n||FZ,r=new Map,a=new Map,o=new Map,l={...MZ,...t.handlers},h={all:u,applyData:BZ,definitionById:r,footnoteById:a,footnoteCounts:o,footnoteOrder:[],handlers:l,one:d,options:t,patch:zZ,wrap:qZ};return JE(e,function(f){if(f.type==="definition"||f.type==="footnoteDefinition"){const g=f.type==="definition"?r:a,b=String(f.identifier).toUpperCase();g.has(b)||g.set(b,f)}}),h;function d(f,g){const b=f.type,v=h.handlers[b];if(H1.call(h.handlers,b)&&v)return v(h,f,g);if(h.options.passThrough&&h.options.passThrough.includes(b)){if("children"in f){const{children:k,...T}=f,E=gg(T);return E.children=h.all(f),E}return gg(f)}return(h.options.unknownHandler||UZ)(h,f,g)}function u(f){const g=[];if("children"in f){const b=f.children;let v=-1;for(;++v<b.length;){const S=h.one(b[v],f);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=X_(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=X_(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function zZ(e,n){e.position&&(n.position=fT(e))}function BZ(e,n){let t=n;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,o=e.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const l="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:l}}t.type==="element"&&o&&Object.assign(t.properties,gg(o)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function UZ(e,n){const t=n.data||{},r="value"in n&&!(H1.call(t,"hProperties")||H1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,r),e.applyData(n,r)}function qZ(e,n){const t=[];let r=-1;for(n&&t.push({type:"text",value:`
`});++r<e.length;)r&&t.push({type:"text",value:`
`}),t.push(e[r]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function X_(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function VZ(e,n){const t=$Z(e,n),r=t.one(e,void 0),a=LZ(t),o=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&o.children.push({type:"text",value:`
`},a),o}const HZ=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"];class kg{constructor(n,t,r){this.normal=t,this.property=n,r&&(this.space=r)}}kg.prototype.normal={};kg.prototype.property={};kg.prototype.space=void 0;function bT(e,n){const t={},r={};for(const a of e)Object.assign(t,a.property),Object.assign(r,a.normal);return new kg(t,r,n)}function G1(e){return e.toLowerCase()}class Pa{constructor(n,t){this.attribute=t,this.property=n}}Pa.prototype.attribute="";Pa.prototype.booleanish=!1;Pa.prototype.boolean=!1;Pa.prototype.commaOrSpaceSeparated=!1;Pa.prototype.commaSeparated=!1;Pa.prototype.defined=!1;Pa.prototype.mustUseProperty=!1;Pa.prototype.number=!1;Pa.prototype.overloadedBoolean=!1;Pa.prototype.property="";Pa.prototype.spaceSeparated=!1;Pa.prototype.space=void 0;let GZ=0;const dn=Gd(),Xi=Gd(),Y1=Gd(),yt=Gd(),xi=Gd(),$f=Gd(),Za=Gd();function Gd(){return 2**++GZ}const W1=Object.freeze(Object.defineProperty({__proto__:null,boolean:dn,booleanish:Xi,commaOrSpaceSeparated:Za,commaSeparated:$f,number:yt,overloadedBoolean:Y1,spaceSeparated:xi},Symbol.toStringTag,{value:"Module"})),Y0=Object.keys(W1);class aN extends Pa{constructor(n,t,r,a){let o=-1;if(super(n,t),Z_(this,"space",a),typeof r=="number")for(;++o<Y0.length;){const l=Y0[o];Z_(this,Y0[o],(r&W1[l])===W1[l])}}}aN.prototype.defined=!0;function Z_(e,n,t){t&&(e[n]=t)}function rp(e){const n={},t={};for(const[r,a]of Object.entries(e.properties)){const o=new aN(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(o.mustUseProperty=!0),n[r]=o,t[G1(r)]=r,t[G1(o.attribute)]=r}return new kg(n,t,e.space)}const vT=rp({properties:{ariaActiveDescendant:null,ariaAtomic:Xi,ariaAutoComplete:null,ariaBusy:Xi,ariaChecked:Xi,ariaColCount:yt,ariaColIndex:yt,ariaColSpan:yt,ariaControls:xi,ariaCurrent:null,ariaDescribedBy:xi,ariaDetails:null,ariaDisabled:Xi,ariaDropEffect:xi,ariaErrorMessage:null,ariaExpanded:Xi,ariaFlowTo:xi,ariaGrabbed:Xi,ariaHasPopup:null,ariaHidden:Xi,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:xi,ariaLevel:yt,ariaLive:null,ariaModal:Xi,ariaMultiLine:Xi,ariaMultiSelectable:Xi,ariaOrientation:null,ariaOwns:xi,ariaPlaceholder:null,ariaPosInSet:yt,ariaPressed:Xi,ariaReadOnly:Xi,ariaRelevant:null,ariaRequired:Xi,ariaRoleDescription:xi,ariaRowCount:yt,ariaRowIndex:yt,ariaRowSpan:yt,ariaSelected:Xi,ariaSetSize:yt,ariaSort:null,ariaValueMax:yt,ariaValueMin:yt,ariaValueNow:yt,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function wT(e,n){return n in e?e[n]:n}function NT(e,n){return wT(e,n.toLowerCase())}const YZ=rp({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:$f,acceptCharset:xi,accessKey:xi,action:null,allow:null,allowFullScreen:dn,allowPaymentRequest:dn,allowUserMedia:dn,alt:null,as:null,async:dn,autoCapitalize:null,autoComplete:xi,autoFocus:dn,autoPlay:dn,blocking:xi,capture:null,charSet:null,checked:dn,cite:null,className:xi,cols:yt,colSpan:null,content:null,contentEditable:Xi,controls:dn,controlsList:xi,coords:yt|$f,crossOrigin:null,data:null,dateTime:null,decoding:null,default:dn,defer:dn,dir:null,dirName:null,disabled:dn,download:Y1,draggable:Xi,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:dn,formTarget:null,headers:xi,height:yt,hidden:Y1,high:yt,href:null,hrefLang:null,htmlFor:xi,httpEquiv:xi,id:null,imageSizes:null,imageSrcSet:null,inert:dn,inputMode:null,integrity:null,is:null,isMap:dn,itemId:null,itemProp:xi,itemRef:xi,itemScope:dn,itemType:xi,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:dn,low:yt,manifest:null,max:null,maxLength:yt,media:null,method:null,min:null,minLength:yt,multiple:dn,muted:dn,name:null,nonce:null,noModule:dn,noValidate:dn,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:dn,optimum:yt,pattern:null,ping:xi,placeholder:null,playsInline:dn,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:dn,referrerPolicy:null,rel:xi,required:dn,reversed:dn,rows:yt,rowSpan:yt,sandbox:xi,scope:null,scoped:dn,seamless:dn,selected:dn,shadowRootClonable:dn,shadowRootDelegatesFocus:dn,shadowRootMode:null,shape:null,size:yt,sizes:null,slot:null,span:yt,spellCheck:Xi,src:null,srcDoc:null,srcLang:null,srcSet:null,start:yt,step:null,style:null,tabIndex:yt,target:null,title:null,translate:null,type:null,typeMustMatch:dn,useMap:null,value:Xi,width:yt,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:xi,axis:null,background:null,bgColor:null,border:yt,borderColor:null,bottomMargin:yt,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:dn,declare:dn,event:null,face:null,frame:null,frameBorder:null,hSpace:yt,leftMargin:yt,link:null,longDesc:null,lowSrc:null,marginHeight:yt,marginWidth:yt,noResize:dn,noHref:dn,noShade:dn,noWrap:dn,object:null,profile:null,prompt:null,rev:null,rightMargin:yt,rules:null,scheme:null,scrolling:Xi,standby:null,summary:null,text:null,topMargin:yt,valueType:null,version:null,vAlign:null,vLink:null,vSpace:yt,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:dn,disableRemotePlayback:dn,prefix:null,property:null,results:yt,security:null,unselectable:null},space:"html",transform:NT}),WZ=rp({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Za,accentHeight:yt,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:yt,amplitude:yt,arabicForm:null,ascent:yt,attributeName:null,attributeType:null,azimuth:yt,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:yt,by:null,calcMode:null,capHeight:yt,className:xi,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:yt,diffuseConstant:yt,direction:null,display:null,dur:null,divisor:yt,dominantBaseline:null,download:dn,dx:null,dy:null,edgeMode:null,editable:null,elevation:yt,enableBackground:null,end:null,event:null,exponent:yt,externalResourcesRequired:null,fill:null,fillOpacity:yt,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:$f,g2:$f,glyphName:$f,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:yt,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:yt,horizOriginX:yt,horizOriginY:yt,id:null,ideographic:yt,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:yt,k:yt,k1:yt,k2:yt,k3:yt,k4:yt,kernelMatrix:Za,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:yt,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:yt,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:yt,overlineThickness:yt,paintOrder:null,panose1:null,path:null,pathLength:yt,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:xi,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:yt,pointsAtY:yt,pointsAtZ:yt,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Za,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Za,rev:Za,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Za,requiredFeatures:Za,requiredFonts:Za,requiredFormats:Za,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:yt,specularExponent:yt,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:yt,strikethroughThickness:yt,string:null,stroke:null,strokeDashArray:Za,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:yt,strokeOpacity:yt,strokeWidth:null,style:null,surfaceScale:yt,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Za,tabIndex:yt,tableValues:null,target:null,targetX:yt,targetY:yt,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Za,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:yt,underlineThickness:yt,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:yt,values:null,vAlphabetic:yt,vMathematical:yt,vectorEffect:null,vHanging:yt,vIdeographic:yt,version:null,vertAdvY:yt,vertOriginX:yt,vertOriginY:yt,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:yt,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:wT}),ST=rp({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),jT=rp({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:NT}),_T=rp({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),QZ=/[A-Z]/g,eC=/-[a-z]/g,JZ=/^data[-\w.:]+$/i;function KZ(e,n){const t=G1(n);let r=n,a=Pa;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&JZ.test(n)){if(n.charAt(4)==="-"){const o=n.slice(5).replace(eC,ZZ);r="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=n.slice(4);if(!eC.test(o)){let l=o.replace(QZ,XZ);l.charAt(0)!=="-"&&(l="-"+l),n="data"+l}}a=aN}return new a(r,n)}function XZ(e){return"-"+e.toLowerCase()}function ZZ(e){return e.charAt(1).toUpperCase()}const eee=bT([vT,YZ,ST,jT,_T],"html"),CT=bT([vT,WZ,ST,jT,_T],"svg"),tee=/["&'<>`]/g,nee=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,iee=/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,ree=/[|\\{}()[\]^$+*?.]/g,tC=new WeakMap;function aee(e,n){if(e=e.replace(n.subset?see(n.subset):tee,r),n.subset||n.escapeOnly)return e;return e.replace(nee,t).replace(iee,r);function t(a,o,l){return n.format((a.charCodeAt(0)-55296)*1024+a.charCodeAt(1)-56320+65536,l.charCodeAt(o+2),n)}function r(a,o,l){return n.format(a.charCodeAt(0),l.charCodeAt(o+1),n)}}function see(e){let n=tC.get(e);return n||(n=oee(e),tC.set(e,n)),n}function oee(e){const n=[];let t=-1;for(;++t<e.length;)n.push(e[t].replace(ree,"\\$&"));return new RegExp("(?:"+n.join("|")+")","g")}const lee=/[\dA-Fa-f]/;function cee(e,n,t){const r="&#x"+e.toString(16).toUpperCase();return t&&n&&!lee.test(String.fromCharCode(n))?r:r+";"}const uee=/\d/;function dee(e,n,t){const r="&#"+String(e);return t&&n&&!uee.test(String.fromCharCode(n))?r:r+";"}const hee=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],W0={nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",fnof:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",bull:"",hellip:"",prime:"",Prime:"",oline:"",frasl:"",weierp:"",image:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",quot:'"',amp:"&",lt:"<",gt:">",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",permil:"",lsaquo:"",rsaquo:"",euro:""},fee=["cent","copy","divide","gt","lt","not","para","times"],kT={}.hasOwnProperty,Q1={};let Bx;for(Bx in W0)kT.call(W0,Bx)&&(Q1[W0[Bx]]=Bx);const pee=/[^\dA-Za-z]/;function mee(e,n,t,r){const a=String.fromCharCode(e);if(kT.call(Q1,a)){const o=Q1[a],l="&"+o;return t&&hee.includes(o)&&!fee.includes(o)&&(!r||n&&n!==61&&pee.test(String.fromCharCode(n)))?l:l+";"}return""}function gee(e,n,t){let r=cee(e,n,t.omitOptionalSemicolons),a;if((t.useNamedReferences||t.useShortestReferences)&&(a=mee(e,n,t.omitOptionalSemicolons,t.attribute)),(t.useShortestReferences||!a)&&t.useShortestReferences){const o=dee(e,n,t.omitOptionalSemicolons);o.length<r.length&&(r=o)}return a&&(!t.useShortestReferences||a.length<r.length)?a:r}function zf(e,n){return aee(e,Object.assign({format:gee},n))}const yee=/^>|^->|<!--|-->|--!>|<!-$/g,xee=[">"],bee=["<",">"];function vee(e,n,t,r){return r.settings.bogusComments?"<?"+zf(e.value,Object.assign({},r.settings.characterReferences,{subset:xee}))+">":"<!--"+e.value.replace(yee,a)+"-->";function a(o){return zf(o,Object.assign({},r.settings.characterReferences,{subset:bee}))}}function wee(e,n,t,r){return"<!"+(r.settings.upperDoctype?"DOCTYPE":"doctype")+(r.settings.tightDoctype?"":" ")+"html>"}function nC(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(n);for(;a!==-1;)r++,a=t.indexOf(n,a+n.length);return r}function Nee(e,n){const t=n||{};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}function See(e){return e.join(" ").trim()}const jee=/[ \t\n\f\r]/g;function sN(e){return typeof e=="object"?e.type==="text"?iC(e.value):!1:iC(e)}function iC(e){return e.replace(jee,"")===""}const ar=TT(1),ET=TT(-1),_ee=[];function TT(e){return n;function n(t,r,a){const o=t?t.children:_ee;let l=(r||0)+e,h=o[l];if(!a)for(;h&&sN(h);)l+=e,h=o[l];return h}}const Cee={}.hasOwnProperty;function AT(e){return n;function n(t,r,a){return Cee.call(e,t.tagName)&&e[t.tagName](t,r,a)}}const oN=AT({body:Eee,caption:Q0,colgroup:Q0,dd:Pee,dt:Dee,head:Q0,html:kee,li:Aee,optgroup:Iee,option:Mee,p:Tee,rp:rC,rt:rC,tbody:Oee,td:aC,tfoot:Lee,th:aC,thead:Ree,tr:Fee});function Q0(e,n,t){const r=ar(t,n,!0);return!r||r.type!=="comment"&&!(r.type==="text"&&sN(r.value.charAt(0)))}function kee(e,n,t){const r=ar(t,n);return!r||r.type!=="comment"}function Eee(e,n,t){const r=ar(t,n);return!r||r.type!=="comment"}function Tee(e,n,t){const r=ar(t,n);return r?r.type==="element"&&(r.tagName==="address"||r.tagName==="article"||r.tagName==="aside"||r.tagName==="blockquote"||r.tagName==="details"||r.tagName==="div"||r.tagName==="dl"||r.tagName==="fieldset"||r.tagName==="figcaption"||r.tagName==="figure"||r.tagName==="footer"||r.tagName==="form"||r.tagName==="h1"||r.tagName==="h2"||r.tagName==="h3"||r.tagName==="h4"||r.tagName==="h5"||r.tagName==="h6"||r.tagName==="header"||r.tagName==="hgroup"||r.tagName==="hr"||r.tagName==="main"||r.tagName==="menu"||r.tagName==="nav"||r.tagName==="ol"||r.tagName==="p"||r.tagName==="pre"||r.tagName==="section"||r.tagName==="table"||r.tagName==="ul"):!t||!(t.type==="element"&&(t.tagName==="a"||t.tagName==="audio"||t.tagName==="del"||t.tagName==="ins"||t.tagName==="map"||t.tagName==="noscript"||t.tagName==="video"))}function Aee(e,n,t){const r=ar(t,n);return!r||r.type==="element"&&r.tagName==="li"}function Dee(e,n,t){const r=ar(t,n);return!!(r&&r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd"))}function Pee(e,n,t){const r=ar(t,n);return!r||r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd")}function rC(e,n,t){const r=ar(t,n);return!r||r.type==="element"&&(r.tagName==="rp"||r.tagName==="rt")}function Iee(e,n,t){const r=ar(t,n);return!r||r.type==="element"&&r.tagName==="optgroup"}function Mee(e,n,t){const r=ar(t,n);return!r||r.type==="element"&&(r.tagName==="option"||r.tagName==="optgroup")}function Ree(e,n,t){const r=ar(t,n);return!!(r&&r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot"))}function Oee(e,n,t){const r=ar(t,n);return!r||r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot")}function Lee(e,n,t){return!ar(t,n)}function Fee(e,n,t){const r=ar(t,n);return!r||r.type==="element"&&r.tagName==="tr"}function aC(e,n,t){const r=ar(t,n);return!r||r.type==="element"&&(r.tagName==="td"||r.tagName==="th")}const $ee=AT({body:Uee,colgroup:qee,head:Bee,html:zee,tbody:Vee});function zee(e){const n=ar(e,-1);return!n||n.type!=="comment"}function Bee(e){const n=new Set;for(const r of e.children)if(r.type==="element"&&(r.tagName==="base"||r.tagName==="title")){if(n.has(r.tagName))return!1;n.add(r.tagName)}const t=e.children[0];return!t||t.type==="element"}function Uee(e){const n=ar(e,-1,!0);return!n||n.type!=="comment"&&!(n.type==="text"&&sN(n.value.charAt(0)))&&!(n.type==="element"&&(n.tagName==="meta"||n.tagName==="link"||n.tagName==="script"||n.tagName==="style"||n.tagName==="template"))}function qee(e,n,t){const r=ET(t,n),a=ar(e,-1,!0);return t&&r&&r.type==="element"&&r.tagName==="colgroup"&&oN(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="col")}function Vee(e,n,t){const r=ET(t,n),a=ar(e,-1);return t&&r&&r.type==="element"&&(r.tagName==="thead"||r.tagName==="tbody")&&oN(r,t.children.indexOf(r),t)?!1:!!(a&&a.type==="element"&&a.tagName==="tr")}const Ux={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function Hee(e,n,t,r){const a=r.schema,o=a.space==="svg"?!1:r.settings.omitOptionalTags;let l=a.space==="svg"?r.settings.closeEmptyElements:r.settings.voids.includes(e.tagName.toLowerCase());const h=[];let d;a.space==="html"&&e.tagName==="svg"&&(r.schema=CT);const u=Gee(r,e.properties),f=r.all(a.space==="html"&&e.tagName==="template"?e.content:e);return r.schema=a,f&&(l=!1),(u||!o||!$ee(e,n,t))&&(h.push("<",e.tagName,u?" "+u:""),l&&(a.space==="svg"||r.settings.closeSelfClosing)&&(d=u.charAt(u.length-1),(!r.settings.tightSelfClosing||d==="/"||d&&d!=='"'&&d!=="'")&&h.push(" "),h.push("/")),h.push(">")),h.push(f),!l&&(!o||!oN(e,n,t))&&h.push("</"+e.tagName+">"),h.join("")}function Gee(e,n){const t=[];let r=-1,a;if(n){for(a in n)if(n[a]!==null&&n[a]!==void 0){const o=Yee(e,a,n[a]);o&&t.push(o)}}for(;++r<t.length;){const o=e.settings.tightAttributes?t[r].charAt(t[r].length-1):void 0;r!==t.length-1&&o!=='"'&&o!=="'"&&(t[r]+=" ")}return t.join("")}function Yee(e,n,t){const r=KZ(e.schema,n),a=e.settings.allowParseErrors&&e.schema.space==="html"?0:1,o=e.settings.allowDangerousCharacters?0:1;let l=e.quote,h;if(r.overloadedBoolean&&(t===r.attribute||t==="")?t=!0:(r.boolean||r.overloadedBoolean)&&(typeof t!="string"||t===r.attribute||t==="")&&(t=!!t),t==null||t===!1||typeof t=="number"&&Number.isNaN(t))return"";const d=zf(r.attribute,Object.assign({},e.settings.characterReferences,{subset:Ux.name[a][o]}));return t===!0||(t=Array.isArray(t)?(r.commaSeparated?Nee:See)(t,{padLeft:!e.settings.tightCommaSeparatedLists}):String(t),e.settings.collapseEmptyAttributes&&!t)?d:(e.settings.preferUnquoted&&(h=zf(t,Object.assign({},e.settings.characterReferences,{attribute:!0,subset:Ux.unquoted[a][o]}))),h!==t&&(e.settings.quoteSmart&&nC(t,l)>nC(t,e.alternative)&&(l=e.alternative),h=l+zf(t,Object.assign({},e.settings.characterReferences,{subset:(l==="'"?Ux.single:Ux.double)[a][o],attribute:!0}))+l),d+(h&&"="+h))}const Wee=["<","&"];function DT(e,n,t,r){return t&&t.type==="element"&&(t.tagName==="script"||t.tagName==="style")?e.value:zf(e.value,Object.assign({},r.settings.characterReferences,{subset:Wee}))}function Qee(e,n,t,r){return r.settings.allowDangerousHtml?e.value:DT(e,n,t,r)}function Jee(e,n,t,r){return r.all(e)}const Kee=HE("type",{invalid:Xee,unknown:Zee,handlers:{comment:vee,doctype:wee,element:Hee,raw:Qee,root:Jee,text:DT}});function Xee(e){throw new Error("Expected node, not `"+e+"`")}function Zee(e){const n=e;throw new Error("Cannot compile unknown node `"+n.type+"`")}const ete={},tte={},nte=[];function ite(e,n){const t=n||ete,r=t.quote||'"',a=r==='"'?"'":'"';if(r!=='"'&&r!=="'")throw new Error("Invalid quote `"+r+"`, expected `'` or `\"`");return{one:rte,all:ate,settings:{omitOptionalTags:t.omitOptionalTags||!1,allowParseErrors:t.allowParseErrors||!1,allowDangerousCharacters:t.allowDangerousCharacters||!1,quoteSmart:t.quoteSmart||!1,preferUnquoted:t.preferUnquoted||!1,tightAttributes:t.tightAttributes||!1,upperDoctype:t.upperDoctype||!1,tightDoctype:t.tightDoctype||!1,bogusComments:t.bogusComments||!1,tightCommaSeparatedLists:t.tightCommaSeparatedLists||!1,tightSelfClosing:t.tightSelfClosing||!1,collapseEmptyAttributes:t.collapseEmptyAttributes||!1,allowDangerousHtml:t.allowDangerousHtml||!1,voids:t.voids||HZ,characterReferences:t.characterReferences||tte,closeSelfClosing:t.closeSelfClosing||!1,closeEmptyElements:t.closeEmptyElements||!1},schema:t.space==="svg"?CT:eee,quote:r,alternative:a}.one(Array.isArray(e)?{type:"root",children:e}:e,void 0,void 0)}function rte(e,n,t){return Kee(e,n,t,this)}function ate(e){const n=[],t=e&&e.children||nte;let r=-1;for(;++r<t.length;)n[r]=this.one(t[r],r,e);return n.join("")}const ste={};function ote(e){const n=this,{handlers:t,sanitize:r,...a}=e||ste;let o=!1,l;typeof r=="boolean"?o=!r:r&&(l=r),n.compiler=h;function h(d,u){const f=VZ(d,{handlers:t,allowDangerousHtml:o}),g=o?f:eZ(f,l),b=ite(g,{...a,allowDangerousHtml:o});return u.extname&&(u.extname=".html"),d&&d.type==="root"&&b&&/[^\r\n]/.test(b.charAt(b.length-1))?b+`
`:b}}const lte=()=>{var Vs,Io,Mo;const{recordId:e}=Yr(),n=Ot(),t=Cr(),[r,a]=w.useState(""),[o,l]=w.useState([]),h=(Q,le)=>{l(ce=>[...ce,{id:crypto.randomUUID(),sender:Q,text:le,timestamp:new Date}])},d=()=>{l([])},[u,f]=w.useState(null),[g,b]=w.useState(null),[v,S]=w.useState(void 0),[k,T]=w.useState(void 0),[E,P]=w.useState(null),[I,q]=w.useState(!1),[$,L]=w.useState(""),[F,z]=w.useState(!1),[B,R]=w.useState(null),[U,Y]=w.useState(null),[Z,ne]=w.useState(!1),[ae,X]=w.useState(!1),[W,H]=w.useState(null),[he,D]=w.useState(""),[te,ve]=w.useState(""),[M,ge]=w.useState(null),[_e,se]=w.useState(!1),[ee,oe]=w.useState(!1),[ue,Ee]=w.useState(!1),[Ie,fe]=w.useState(null),[pe,Re]=w.useState(window.innerHeight),[Ye,ut]=w.useState([]),[Ge,Se]=w.useState(!1),[qe,Ue]=w.useState(null),[ze,lt]=w.useState([]),[Ke,pt]=w.useState([]),[Te,ie]=w.useState(!1),[xe,Qe]=w.useState(null),we=w.useRef(null),Pe=w.useRef(null),Je=w.useRef(!1),at=w.useRef(null),ft=w.useRef(null),Ae=w.useRef(null),[Ve,$e]=w.useState("context"),[We,ct]=w.useState(50),[dt,wt]=w.useState(!1),bt=w.useRef(null),kt=w.useRef(null),Tt=150,[It,mt]=w.useState([]),[$t,en]=w.useState([]),[be,nt]=w.useState(!1),[Ze,Pt]=w.useState(null),[Ut,hn]=w.useState(null),[Ln,Qn]=w.useState(""),[Oi,Si]=w.useState(null),[hr,ss]=w.useState(""),[ni,gn]=w.useState(null),[Pi,er]=w.useState(""),[oi,vi]=w.useState([]),[sa,fr]=w.useState(!1),[oa,os]=w.useState(null),[Is,la]=w.useState(!1),[Yd,gl]=w.useState(null),[Ms,ca]=w.useState({}),[hc,fc]=w.useState(!1),[vo,pc]=w.useState(!1),[Nu,Wd]=w.useState(!1),[mc,pr]=w.useState(null),[Rs,gc]=w.useState(!1),[Os,yc]=w.useState(!1),[ua,Su]=w.useState(!1),[tr,yl]=w.useState(!1),[wo,No]=w.useState(!1),[Ia,So]=w.useState(!1),Ls=w.useMemo(()=>(g==null?void 0:g.admission_date)&&!(g!=null&&g.discharge_date),[g]),[ls,Ma]=w.useState(!1),[xl,bl]=w.useState(""),[cs,vl]=w.useState(void 0),[xc,Fs]=w.useState(void 0),[jo,wl]=w.useState(void 0),[sr,us]=w.useState(!1),[bc,Ra]=w.useState(null),[_o,Nl]=w.useState(!1),kr=w.useRef(null),[Co,$s]=w.useState(null),[da,vc]=w.useState(null),zs=w.useRef(null),[Qd,Mn]=w.useState(!1),[Tn,ju]=w.useState(!1),[nn,Oa]=w.useState(null),[Bs,Us]=w.useState(""),[Sl,ds]=w.useState(""),[_u,hi]=w.useState(!0),[Qr,La]=w.useState(!1),[wc,ko]=w.useState(!1),[Li,jl]=w.useState(!1),[Fa,_l]=w.useState([]),[Jd,Kd]=w.useState(!1),Cl=w.useRef(null),nr=Q=>{const le=Q==="context"?ft:Ae;le.current&&(le.current.scrollIntoView({behavior:"smooth",block:"start"}),$e(Q))};w.useEffect(()=>{const Q=()=>{var tt,vt;if(window.innerWidth>768)return;const ce=(tt=ft.current)==null?void 0:tt.getBoundingClientRect(),Ne=(vt=Ae.current)==null?void 0:vt.getBoundingClientRect();ce&&Ne&&(Ne.top<200?$e("response"):$e("context"))},le=bt.current;if(le)return le.addEventListener("scroll",Q),()=>le.removeEventListener("scroll",Q)},[]);const Eo=async Q=>{try{const le=await de(`/api/patients/${Q}`);if(!le.ok){const Ne=await le.json().catch(()=>({}));throw new Error(Ne.message||`Failed to fetch patient details: ${le.status}`)}const ce=await le.json();if(b(ce),S(ce.age),T(ce.gender),D(ce.ai_response||""),b(Ne=>Ne?{...Ne,current_status:ce.current_status,admission_date:ce.admission_date,discharge_date:ce.discharge_date}:{...ce,current_status:ce.current_status,admission_date:ce.admission_date,discharge_date:ce.discharge_date}),ce.insurance_type&&b(Ne=>Ne?{...Ne,insurance_type:ce.insurance_type}:{...ce}),Tr(Q),ce.ai_response){const Ne=/```json\s*([\s\S]*?)\s*```/,tt=ce.ai_response.match(Ne);if(tt&&tt[1])ve(ce.ai_response.replace(Ne,"").trim()),ge(tt[1].trim());else{const vt=ce.ai_response.trim();if(vt.startsWith("{")&&vt.endsWith("}"))try{JSON.parse(vt),ve(""),ge(vt)}catch{ve(vt),ge(null)}else if(vt.startsWith("[")&&vt.endsWith("]"))try{JSON.parse(vt),ve(""),ge(vt)}catch{ve(vt),ge(null)}else ve(vt),ge(null)}}else ve(""),ge(null)}catch{b(null),D(""),ve(""),ge(null)}},Er=async(Q,le)=>{b(ce=>ce?{...ce,insurance_type:le}:null);try{const ce=await de(`/api/patients/${Q}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:le})});if(!ce.ok){const Ne=await ce.json();throw new Error(Ne.message||"Failed to update insurance type")}}catch(ce){console.error("Error updating insurance type:",ce),Q&&Eo(Q)}},Xd=async Q=>{ie(!0),Qe(null),pt([]);try{const le=await de(`/api/queue/patient/${Q}/complaints`);if(!le.ok){const Ne=await le.json().catch(()=>({}));throw new Error(Ne.message||`HTTP error! status: ${le.status}`)}const ce=await le.json();pt(ce||[])}catch(le){Qe(`Past complaints error: ${le.message}`)}finally{ie(!1)}},qs=async Q=>{lt([]);try{const le=await de(`/api/pharmacy-orders/patient/${Q}`);if(!le.ok){const Ne=await le.json().catch(()=>({}));throw new Error(Ne.message||`HTTP error! status: ${le.status}`)}const ce=await le.json();lt(ce||[])}catch{}},Gi=async Q=>{fr(!0),os(null),vi([]);try{const le=await de(`/api/lab/orders/patient/${Q}`);if(!le.ok){const Ne=await le.json().catch(()=>({}));throw new Error(Ne.message||`HTTP error! status: ${le.status}`)}const ce=await le.json();vi(ce||[])}catch(le){os(`Pending labs error: ${le.message}`)}finally{fr(!1)}},hs=async Q=>{Se(!0),Ue(null),ut([]);try{const le=await de(`/api/lab/patient/${Q}`);if(!le.ok){const Ne=await le.json().catch(()=>({}));throw new Error(Ne.message||`HTTP error! status: ${le.status}`)}const ce=await le.json();ut(ce||[])}catch(le){Ue(`Lab reports error: ${le.message}`)}finally{Se(!1)}},kl=async Q=>{try{const le=await de(`/api/recurring-medications?patientId=${Q}`);if(!le.ok){const Ne=await le.json().catch(()=>({}));throw new Error(Ne.message||`Failed to fetch recurring medications: ${le.status}`)}const ce=await le.json();_l(ce.recurringMedications||[])}catch(le){console.error("Error fetching recurring medications:",le)}},Jn=async Q=>{ne(!0),ie(!0),fr(!0),Se(!0),lt([]);try{const le=await de(`/api/patients/${Q}/context`);if(!le.ok){const tt=await le.json().catch(()=>({}));throw new Error(tt.message||`Failed to fetch patient context: ${le.status}`)}const ce=await le.json(),Ne=ce.patient;if(b(Ne),S(Ne.age),T(Ne.gender),D(Ne.ai_response||""),Tr(Q),Ne.ai_response){const tt=/```json\s*([\s\S]*?)\s*```/,vt=Ne.ai_response.match(tt);if(vt&&vt[1])ve(Ne.ai_response.replace(tt,"").trim()),ge(vt[1].trim());else{const At=Ne.ai_response.trim();if(At.startsWith("{")&&At.endsWith("}"))try{JSON.parse(At),ve(""),ge(At)}catch{ve(At),ge(null)}else if(At.startsWith("[")&&At.endsWith("]"))try{JSON.parse(At),ve(""),ge(At)}catch{ve(At),ge(null)}else ve(At),ge(null)}}else ve(""),ge(null);pt(ce.pastComplaints||[]),lt(ce.pharmacyOrders||[]),vi(ce.labOrders||[]),ut(ce.labReports||[]),_l(ce.recurringMedications||[])}catch(le){console.error("Error fetching patient context:",le),H(le.message),b(null),D(""),ve(""),ge(null),pt([]),lt([]),vi([]),ut([]),_l([])}finally{ne(!1),ie(!1),fr(!1),Se(!1)}},Tr=async Q=>{try{const le=await de(`/api/queue/patient/${Q}/latest`);if(!le.ok){const Ne=await le.json().catch(()=>({}));throw new Error(Ne.message||`Failed to fetch queue status: ${le.status}`)}const ce=await le.json();if(ce){const Ne=new Date(ce.createdAt),tt=new Date,vt=Ne.getDate()===tt.getDate()&&Ne.getMonth()===tt.getMonth()&&Ne.getFullYear()===tt.getFullYear(),At=["waiting","consulting"].includes(ce.status);So(vt&&At)}else So(!1)}catch(le){console.error("Error checking patient queue status:",le),So(!1)}},Nc=async Q=>{var ce;const le=ze.find(Ne=>Ne.id===Q);if(le&&(le.status==="billed"||le.status==="dispensed"))try{const Ne=await de(`/api/bills?patientId=${u}`);if(!Ne.ok)throw new Error("Failed to fetch bills");const vt=(ce=(await Ne.json()).bills)==null?void 0:ce.find(At=>At.related_id===Q&&At.type==="pharmacy");if(vt){n(`/dashboard/bills/${vt.id}`);return}else{console.warn("Bill not found for billed order, falling back to edit page or alert"),alert("Bill record not found for this order.");return}}catch(Ne){console.error("Error fetching bill:",Ne),alert("Failed to fetch bill details.");return}n(`/dashboard/edit-pharmacy-order/${Q}`)},sp=Q=>{H(null),console.log(`Preparing billing navigation for order: ${Q}`);const le=ze.find(ce=>ce.id===Q);if(le){const ce=le.medications.map(Ne=>{const tt=Ne.price??0;return(Ne.price===void 0||Ne.price===null)&&console.warn(`Medication "${Ne.name}" in order ${Q} is missing a price. Defaulting to 0.`),{name:Ne.name,pack_quantity:Ne.pack_quantity,loose_quantity:Ne.loose_quantity,price:tt,pack_price:Ne.pack_price,loose_price:Ne.loose_price,total_price:Number(Ne.total_price)||0,isLoose:Ne.isLoose,unit:Ne.unit,drug_id:Ne.drug_id?String(Ne.drug_id):null,tabletsPerDay:Ne.tabletsPerDay,numberOfDays:Ne.numberOfDays,directions_to_use:Ne.directions_to_use,discount_percentage:Ne.discount_percentage??0,batch:Ne.batch,expiry_date:Ne.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:ce}),n(`/dashboard/pharmacy-billing/${Q}`,{state:{initialItems:ce}})}else console.error(`Order with ID ${Q} not found.`),H(`Order with ID ${Q} not found.`),alert(`Error: Could not find order ${Q} to bill.`)},Cu=async(Q,le)=>{H(null);const ce=ze.find(tt=>tt.id===Q);if(!ce){H(`Order with ID ${Q} not found.`);return}const Ne={status:le,medications:ce.medications};try{const tt=await de(`/api/pharmacy-orders/${Q}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ne)});if(!tt.ok){const At=await tt.text();throw new Error(`Failed to update status: ${tt.statusText} (${tt.status}) - ${At}`)}const vt=await tt.json();lt(At=>At.map(Ct=>Ct.id===vt.id?vt:Ct)),u&&qs(u)}catch(tt){console.error("Failed to update order status:",tt),H(tt.message||`Failed to update status for order ${Q}.`),alert(`Error updating status for order ${Q}: ${tt.message||"Please try again."}`)}},op=async Q=>{H(null);try{const le=await de(`/api/pharmacy-orders/${Q}/recurring`,{method:"POST"});if(!le.ok){const ce=await le.json().catch(()=>({}));throw new Error(ce.message||"Failed to mark order as recurring")}u&&kl(u)}catch(le){console.error("Failed to mark order as recurring:",le),H(le.message||`Failed to mark order ${Q} as recurring.`),alert(`Error: ${le.message||"Please try again."}`)}},lp=Q=>{pr(Q),Wd(!0)},cp=async Q=>{if(window.confirm("Are you sure you want to delete this recurring medication?"))try{if(!(await de(`/api/recurring-medications/${Q}`,{method:"DELETE"})).ok)throw new Error("Failed to delete recurring medication");_l(ce=>ce.filter(Ne=>Ne.id!==Q))}catch(le){console.error("Error deleting recurring medication:",le),alert("Failed to delete. Please try again.")}},Zd=Q=>{vi(le=>le.map(ce=>ce.id===Q?{...ce,isEditing:!0,editedTests:[...ce.tests],editedStatus:ce.status}:{...ce,isEditing:!1}))},Sc=Q=>{vi(le=>le.map(ce=>ce.id===Q?{...ce,isEditing:!1,editedTests:void 0,editedStatus:void 0}:ce))},To=(Q,le,ce,Ne)=>{vi(tt=>tt.map(vt=>{if(vt.id===Q){const At=vt.editedTests?[...vt.editedTests]:[...vt.tests];if(ce==="add")return{...vt,editedTests:[...At,{id:"",name:"",price:0}]};if(ce==="remove")return{...vt,editedTests:Ne};if(le!==-1){const Ct={...At[le],[ce]:Ne};return At[le]=Ct,{...vt,editedTests:At}}}return vt}))},ku=(Q,le)=>{vi(ce=>ce.map(Ne=>Ne.id===Q?{...Ne,editedStatus:le}:Ne))},Ao=Q=>{if(!Q||!Q.id){console.error("Cannot navigate to billing: Lab Order data or ID is missing."),alert("Could not open billing page: Lab Order information is missing.");return}n("/lab-billing",{state:{labOrderId:Q.id}})},jc=async(Q,le)=>{try{if(!(await de(`/api/lab/${Q}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:le})})).ok)throw new Error("Failed to update lab order status");u&&Gi(u)}catch(ce){console.error("Error updating lab order status:",ce),alert("Failed to update status. Please try again.")}},Do=Q=>{Q&&Q.id?n(`/lab/report/${Q.id}`):(console.error("Cannot navigate: Lab Order or Lab Order ID is missing."),alert("Could not open the lab report page: Lab Order information is missing."))},El=async Q=>{var le;if(!(!Q||!Q.id)){if(["billed","collected","processing","report_ready","reported","completed"].includes(Q.status||""))try{const ce=await de(`/api/bills?patientId=${u}`);if(!ce.ok)throw new Error("Failed to fetch bills");const tt=(le=(await ce.json()).bills)==null?void 0:le.find(vt=>vt.related_id===Q.id&&vt.type==="lab");if(tt){n(`/dashboard/bills/${tt.id}`);return}else console.warn("Bill not found for lab order, proceeding to report page")}catch(ce){console.error("Error fetching bill:",ce)}Do(Q)}},Eu=async(Q,le,ce)=>{gc(!0),H(null);try{if(!le||le.length===0)throw new Error("Lab order must have at least one test.");for(const vt of le)if(!vt.id||!vt.name||isNaN(vt.price)||vt.price<0)throw new Error(`Invalid test data: ${JSON.stringify(vt)}. Each test must have id, name, and a valid price.`);const Ne={tests:le,status:ce},tt=await de(`/api/lab/orders/${Q}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ne)});if(!tt.ok){const vt=await tt.json().catch(()=>({}));throw new Error(vt.message||`Failed to update lab order: ${tt.statusText}`)}u&&Gi(u),vi(vt=>vt.map(At=>At.id===Q?{...At,isEditing:!1,editedTests:void 0,editedStatus:void 0}:At))}catch(Ne){H(`Lab Order Save Error: ${Ne.message}`)}finally{gc(!1)}},Tl=async Q=>{if(!window.confirm(`Are you sure you want to delete this ${Q.type.toLowerCase()} record? This action cannot be undone.`))return;la(!0),gl(null);let ce=null,Ne;const tt=Q.type;try{switch(tt){case"Complaint":if(Ne=Q.data.id,!Ne)throw new Error("Complaint ID is missing.");ce=`/api/patients/complaints/${Ne}`;break;case"Lab Order":if(Ne=Q.data.id,!Ne)throw new Error("Lab Order ID is missing.");ce=`/api/lab/orders/${Ne}`;break;case"Lab Report":if(Ne=Q.data.reportId,!Ne)throw new Error("Lab Report ID is missing.");ce=`/api/lab/reports/${Ne}`;break;case"Pharmacy Order":if(Ne=Q.data.id,!Ne)throw new Error("Pharmacy Order ID is missing.");ce=`/api/pharmacy-orders/${Ne}`;break;default:throw new Error(`Deletion not supported for item type: ${tt}`)}if(!ce)throw new Error(`Could not determine delete URL for type: ${tt}`);const vt=await de(ce,{method:"DELETE"});if(!vt.ok){const At=await vt.json().catch(()=>({}));throw new Error(At.message||`Failed to delete ${tt}: ${vt.statusText}`)}u&&(tt==="Complaint"?Xd(u):tt==="Lab Order"?(Gi(u),hs(u)):tt==="Lab Report"?hs(u):tt==="Pharmacy Order"&&qs(u))}catch(vt){gl(`Delete Error (${tt}): ${vt.message}`),Is&&la(!1)}finally{la(!1)}},_c=async()=>{if(!u)return;if(ze.filter(le=>le.status==="pending").length<2){alert("You need at least two pending orders to merge.");return}ju(!0);try{const le=await de(`/api/pharmacy-orders/patient/${u}/merge-pending`,{method:"POST"});if(!le.ok){const ce=await le.json().catch(()=>({}));throw new Error(ce.message||"Failed to merge orders")}qs(u)}catch(le){H(`Merge Error: ${le.message}`)}finally{ju(!1)}},fs=Q=>{pt(le=>le.map(ce=>ce.id===Q?{...ce,isEditing:!0,editedComplaint:ce.complaint}:ce))},up=Q=>{pt(le=>le.map(ce=>ce.id===Q?{...ce,isEditing:!1,editedComplaint:void 0}:ce))},eh=(Q,le)=>{pt(ce=>ce.map(Ne=>Ne.id===Q?{...Ne,editedComplaint:le}:Ne))},mr=async(Q,le)=>{try{const ce=await de(`/api/patients/complaints/${Q}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({complaint:le})});if(!ce.ok){const Ne=await ce.json().catch(()=>({}));throw new Error(Ne.message||"Failed to update complaint")}pt(Ne=>Ne.map(tt=>tt.id===Q?{...tt,complaint:le,isEditing:!1,editedComplaint:void 0}:tt))}catch(ce){console.error("Error updating complaint:",ce),alert(`Failed to update complaint: ${ce.message}`)}},Jr=w.useMemo(()=>{if(!u||!Ke)return[];const Q=[...Ke].sort((le,ce)=>new Date(ce.createdAt).getTime()-new Date(le.createdAt).getTime());return Q.map((le,ce)=>({date:new Date(le.createdAt),type:"Complaint",data:{...le,serialNumber:Q.length-ce},originalDateString:le.createdAt})).filter(le=>!isNaN(le.date.getTime()))},[Ke,u]),gr=w.useMemo(()=>{if(!u)return[];const Q=new Map;(oi??[]).forEach(ce=>{Q.set(ce.id,{...ce})}),(Ye??[]).forEach(ce=>{if(!Q.has(ce.id))Q.set(ce.id,{id:ce.id,patient_id:ce.patient_id,tests:ce.tests,status:ce.status,createdAt:ce.createdAt,report:ce});else{const Ne=Q.get(ce.id);Ne&&(Ne.report=ce,Ne.status=ce.status)}});let le=Array.from(Q.values());return le.sort((ce,Ne)=>new Date(ce.createdAt).getTime()-new Date(Ne.createdAt).getTime()),le=le.map((ce,Ne)=>({...ce,serialNumber:Ne+1})),le.map(ce=>({date:new Date(ce.createdAt),type:"Lab Order",data:ce,originalDateString:ce.createdAt}))},[u,oi,Ye]),or=w.useMemo(()=>{if(!u||!ze)return[];const Q=ze.map(le=>({date:new Date(le.date),type:"Pharmacy Order",data:le,originalDateString:le.date})).filter(le=>!isNaN(le.date.getTime()));return Q.sort((le,ce)=>ce.date.getTime()-le.date.getTime()),Q},[u,ze]),[$a,th]=w.useState(null),[Al,Tu]=w.useState([]),[Cc,kc]=w.useState(""),za=(Q,le)=>{if(!Q||!Q.report_content||!le)return"";try{const ce=JSON.parse(Q.report_content||"{}");if(typeof ce!="object"||ce===null)return`<p class="italic text-gray-500 text-xs">Report content is not structured data.</p><pre>${Q.report_content}</pre>`;let Ne="";return le.forEach(tt=>{ce[tt.id]?(Ne+=`<h5 class="font-semibold text-sm mt-2 mb-1">${tt.name}</h5>`,Ne+='<table class="lab-report-print-table"><thead><tr><th>Parameter</th><th>Value</th><th>Normal Range</th></tr></thead><tbody>',Object.entries(ce[tt.id]).map(([vt,At])=>{var Ba;const Ct=(Ba=tt.default_parameters)==null?void 0:Ba.find(Ua=>Ua.name===vt);let Kn="N/A";Ct&&Ct.type==="number"&&(Ct.lower_limit!=null||Ct.upper_limit!=null)?(Kn="",Ct.lower_limit!=null&&(Kn+=` > ${Ct.lower_limit}`),Ct.lower_limit!=null&&Ct.upper_limit!=null&&(Kn+=" - "),Ct.upper_limit!=null&&(Kn+=` < ${Ct.upper_limit}`),Kn=Kn.trim()||"N/A"):(Ct==null?void 0:Ct.type)==="boolean"?Kn="N/A":Ct!=null&&Ct.normal_range&&(Kn=Ct.normal_range),Ne+=`<tr><td>${vt}</td><td>${String(At)} ${(Ct==null?void 0:Ct.unit)||""}</td><td>${Kn}</td></tr>`}),Ne+="</tbody></table>"):Ne+=`<p class="italic text-gray-500 text-xs">No parameters reported for ${tt.name}.</p>`}),Ne}catch{return`<p class="italic text-gray-500 text-xs">Error parsing report content.</p><pre>${Q.report_content}</pre>`}};w.useEffect(()=>{const Q=()=>{Re(window.innerHeight)};return window.addEventListener("resize",Q),Q(),()=>window.removeEventListener("resize",Q)},[]),w.useEffect(()=>{const Q=ce=>{if(!dt||!kt.current||!bt.current)return;const Ne=bt.current.getBoundingClientRect(),vt=ce.clientX-kt.current.x;let At=kt.current.initialWidth-vt;const Ct=Ne.width-Tt-10;At=Math.max(Tt,At),At=Math.min(At,Ct);const Kn=At/Ne.width*100;ct(Kn)},le=()=>{wt(!1),kt.current=null,document.body.style.cursor="",document.body.style.userSelect=""};return dt&&(window.addEventListener("mousemove",Q),window.addEventListener("mouseup",le),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{window.removeEventListener("mousemove",Q),window.removeEventListener("mouseup",le),document.body.style.cursor="",document.body.style.userSelect=""}},[dt]);const nh=Q=>{if(!bt.current)return;Q.preventDefault();const le=bt.current.querySelector(".edit-complaint-context-column");le&&(kt.current={x:Q.clientX,initialWidth:le.offsetWidth},wt(!0))},ih=()=>{ct(50)},Dl=w.useCallback(async()=>{X(!0),H(null);try{const Q=await de("/api/queue/doctor/new",{method:"POST"});if(!Q.ok){const ce=await Q.json().catch(()=>({}));throw new Error(ce.message||`Failed to create record: ${Q.statusText}`)}const le=await Q.json();if(!le.recordId)throw new Error("New record ID not received from server.");n(`/edit-complaint/${le.recordId}`,{replace:!0})}catch(Q){H(`Failed to create new complaint record: ${Q.message}`)}finally{X(!1)}},[n]);w.useEffect(()=>{(async()=>{hi(!0);try{const le=await de("/api/clinics/settings");if(!le.ok){const Ne=await le.json().catch(()=>({}));throw new Error(Ne.message||"Failed to fetch clinic settings.")}const ce=await le.json();Oa({admissionCharge:parseFloat(ce.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(ce.perDayCharge||0).toFixed(2),otherCharges:parseFloat(ce.otherCharges||0).toFixed(2),aiMemory:ce.aiMemory||"",aiMemoryUpdatedAt:ce.aiMemoryUpdatedAt||null,clinicWideSystemPrompt:ce.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:ce.clinicWideSystemPromptUpdatedAt||null,gemini_api_key:ce.gemini_api_key||""}),Us(ce.aiMemory||""),ds(ce.clinicWideSystemPrompt||"")}catch{}finally{hi(!1)}})()},[]),w.useEffect(()=>{var le,ce;(le=t.state)!=null&&le.patientId&&f(Number(t.state.patientId)),(ce=t.state)!=null&&ce.initialMessage&&a(t.state.initialMessage),e?(async Ne=>{var tt;ne(!0),H(null);try{const vt=await de(`/api/queue/doctor/complaint/${Ne}`);if(!vt.ok){const Ct=await vt.json().catch(()=>({}));throw new Error(Ct.message||`HTTP error! status: ${vt.status}`)}const At=await vt.json();f(Ct=>Ct===At.patientId?Ct:At.patientId),S(At.age),T(At.gender),P(At.case_summary||null),Y(At.updatedAt||null)}catch{H("Failed to load current complaint details."),(tt=t.state)!=null&&tt.patientId||f(null),S(void 0),T(void 0),P(null),Y(null)}finally{ne(!1)}})(e):Dl()},[e,Dl,(Vs=t.state)==null?void 0:Vs.initialMessage,(Io=t.state)==null?void 0:Io.patientId]),w.useEffect(()=>{u?Jn(u):(b(null),pt([]),lt([]),vi([]),ut([]),Y(null),So(!1))},[u]),w.useEffect(()=>{var ce;const Q=(ce=t.state)==null?void 0:ce.initialMessage;Q&&e&&(!Z&&!Te&&!sa&&!Ge&&!be)&&!Je.current&&r===Q&&(Je.current=!0,ir(),n(t.pathname,{replace:!0,state:{}}))},[(Mo=t.state)==null?void 0:Mo.initialMessage,e,r,Z,Te,sa,Ge,be,n]);const rh=()=>{L(E||""),q(!0),R(null)},ps=()=>{q(!1),L(""),R(null)},Ec=async()=>{if(!e){R("Missing Record ID.");return}z(!0),R(null);try{const Q=await de(`/api/queue/doctor/complaint/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:$.trim()})});if(!Q.ok){const ce=await Q.json().catch(()=>({}));throw new Error(ce.message||`Failed to save case summary: ${Q.statusText}`)}const le=await Q.json();P(le.case_summary||$.trim()),Y(le.updatedAt||null),q(!1)}catch(Q){R(`Save Error: ${Q.message}`)}finally{z(!1)}};w.useEffect(()=>{(async()=>{nt(!0),Pt(null);try{const[le,ce]=await Promise.all([de("/api/drugs"),de("/api/lab-tests")]);if(!le.ok)throw new Error(`Pharmacy inventory error! status: ${le.status}`);const Ne=await le.json();if(mt(Ne||[]),!ce.ok)throw new Error(`Lab inventory error! status: ${ce.status}`);const tt=await ce.json();en(tt||[])}catch(le){Pt(le.message)}finally{nt(!1)}})()},[]);const dp=async()=>{if(!nn)return;if(Bs===nn.aiMemory&&Sl===nn.clinicWideSystemPrompt){ko(!1);return}const Q=Bs!==nn.aiMemory,le=Sl!==nn.clinicWideSystemPrompt;Q&&La(!0),le&&jl(!0);try{const ce={...nn};Q&&(ce.aiMemory=Bs),le&&(ce.clinicWideSystemPrompt=Sl);const Ne=await de("/api/clinics/settings",{method:"PUT",body:JSON.stringify(ce)});if(!Ne.ok){const vt=await Ne.json().catch(()=>({}));throw new Error(vt.message||"Failed to update clinic settings.")}const tt=await Ne.json();Oa({admissionCharge:parseFloat(tt.settings.admissionCharge).toFixed(2),perDayCharge:parseFloat(tt.settings.perDayCharge).toFixed(2),otherCharges:parseFloat(tt.settings.otherCharges).toFixed(2),aiMemory:tt.settings.aiMemory||"",aiMemoryUpdatedAt:tt.settings.aiMemoryUpdatedAt||(nn==null?void 0:nn.aiMemoryUpdatedAt)||null,clinicWideSystemPrompt:tt.settings.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:tt.settings.clinicWideSystemPromptUpdatedAt||(nn==null?void 0:nn.clinicWideSystemPromptUpdatedAt)||null}),Q&&Us(tt.settings.aiMemory||""),le&&(ds(tt.settings.clinicWideSystemPrompt||""),ko(!1))}catch{}finally{Q&&La(!1),le&&jl(!1)}},hp=()=>{nn&&(ds(nn.clinicWideSystemPrompt||""),ko(!0))},yr=()=>{ko(!1),nn&&ds(nn.clinicWideSystemPrompt||"")},ir=async Q=>{let le=Q??r;$a&&le.trim()&&(le=`${$a} -> ${le}`,th(null),Tu([])),le.trim()&&(h("user",le),Q||a("")),Cl.current&&await Cl.current.callGenerativeApi(le)},Ar=Q=>{navigator.clipboard.writeText(Q).then(()=>{}).catch(le=>{console.error("Failed to copy text: ",le)})},Au=async Q=>{if(!(!Q||!Ln))try{if(!(await de(`/api/lab/${Q}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({createdAt:new Date(Ln).toISOString()})})).ok)throw new Error("Failed to update order date");u&&(Gi(u),hs(u)),hn(null)}catch(le){console.error("Error updating order date:",le),alert("Failed to update order date")}},ah=async Q=>{if(!(!Q||!hr))try{if(!(await de(`/api/lab/${Q}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_date:new Date(hr).toISOString()})})).ok)throw new Error("Failed to update report date");u&&(hs(u),Gi(u)),Si(null)}catch(le){console.error("Error updating report date:",le),alert("Failed to update report date")}},sh=async Q=>{if(!(!Q||!Pi))try{if(!(await de(`/api/pharmacy-orders/${Q}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({createdAt:new Date(Pi).toISOString()})})).ok)throw new Error("Failed to update pharmacy order date");u&&qs(u),gn(null)}catch(le){console.error("Error updating pharmacy order date:",le),alert("Failed to update pharmacy order date")}},Pl=(Q,le)=>{const ce=window.open("","_blank");ce&&(ce.document.write(`
        <html>
          <head>
            <title>${le}</title>
            <style>
              body { font-family: sans-serif; margin: 20px; }
              h2 { text-align: center; margin-bottom: 20px; }
              table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
              th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
              th { background-color: #f2f2f2; }
              pre { white-space: pre-wrap; word-wrap: break-word; }
              .ai-context-section { margin-bottom: 20px; border: 1px solid #eee; padding: 15px; border-radius: 5px; }
              .ai-context-section-title { font-size: 1.1em; font-weight: bold; margin-bottom: 10px; color: #333; }
              .ai-context-text { margin-bottom: 5px; }
              .text-gray-400 { color: #999; }
              .font-semibold { font-weight: 600; }
              .italic { font-style: italic; }
              .mt-2 { margin-top: 8px; }
              .ml-1 { margin-left: 4px; }
              .ml-2 { margin-left: 8px; }
              .flex { display: flex; }
              .flex-col { flex-direction: column; }
              .w-full { width: 100%; }
              .text-xs { font-size: 0.75rem; }
              .text-sm { font-size: 0.875rem; }
              .prose { max-width: 65ch; }
              .prose table { display: table; } /* Ensure tables in markdown render correctly */
            </style>
          </head>
          <body>
            <h2>${le}</h2>
            <div id="print-content">${Q}</div>
          </body>
        </html>
      `),ce.document.close(),ce.print())},fp=()=>{if(he){const Q=QX().use(ks).use(ote).processSync(te).toString();Pl(`<div class="prose">${Q}</div>`,"AI Response")}};w.useEffect(()=>{if(g){let Q=`
        <div class="print-section">
          <h3>Patient Details</h3>
          <p><strong>Name:</strong> ${g.name||"N/A"}</p>
          <p><strong>Token:</strong> ${g.patient_token_number||"N/A"}</p>
          <p><strong>Age:</strong> ${g.age||"N/A"}</p>
          <p><strong>Gender:</strong> ${g.gender||"N/A"}</p>
          <p><strong>Phone:</strong> ${g.phone||"N/A"}</p>
          <p><strong>Insurance:</strong> ${g.insurance_type||"N/A"}</p>
          <p><strong>Status:</strong> ${g.current_status||"N/A"}</p>
          <p><strong>Admitted:</strong> ${g.admission_date?new Date(g.admission_date).toLocaleDateString():"N/A"}</p>
          <p><strong>Discharged:</strong> ${g.discharge_date?new Date(g.discharge_date).toLocaleDateString():"N/A"}</p>
        </div>
        <div class="print-section">
          <h3>Case Summary</h3>
          <p>${E||"No summary available."}</p>
        </div>
        <div class="print-section">
          <h3>Complaints History</h3>
          ${Jr.length>0?`
            <ul>
              ${Jr.map(le=>`<li>${new Date(le.originalDateString).toLocaleDateString()}: ${le.data.complaint}</li>`).join("")}
            </ul>
          `:"<p>No past complaints.</p>"}
        </div>
        <div class="print-section">
          <h3>Pharmacy Orders</h3>
          ${or.length>0?`
            <table class="print-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Status</th>
                  <th>Drug Name</th>
                  <th>Quantity</th>
                  <th>Dosage</th>
                  <th>Directions</th>
                </tr>
              </thead>
              <tbody>
                ${or.map(le=>le.data.medications.map((ce,Ne)=>`
                    <tr>
                      ${Ne===0?`<td rowspan="${le.data.medications.length}">${new Date(le.originalDateString).toLocaleDateString()}</td>`:""}
                      ${Ne===0?`<td rowspan="${le.data.medications.length}">${le.data.status}</td>`:""}
                      <td><strong>${ce.name}</strong></td>
                      <td>
                        ${ce.pack_quantity!==void 0&&ce.pack_quantity>0?`Packs: ${ce.pack_quantity}`:""}
                        ${ce.pack_quantity!==void 0&&ce.pack_quantity>0&&ce.loose_quantity!==void 0&&ce.loose_quantity>0?", ":""}
                        ${ce.loose_quantity!==void 0&&ce.loose_quantity>0?`Loose: ${ce.loose_quantity}`:""}
                      </td>
                      <td>${ce.tabletsPerDay&&ce.numberOfDays?`${ce.tabletsPerDay} tab/day for ${ce.numberOfDays} days`:"N/A"}</td>
                      <td>${ce.directions_to_use||"N/A"}</td>
                    </tr>
                  `).join("")).join("")}
              </tbody>
            </table>
          `:"<p>No pharmacy orders.</p>"}
        </div>
        <div class="print-section">
          <h3>Lab History (Orders & Reports)</h3>
          ${gr.length>0?`
            ${gr.map(le=>{const ce=le.data.tests.map(tt=>tt.name).join(", ");let Ne="";return le.data.report&&(Ne=`
                  <div class="lab-report-print-container">
                    <h4>Lab Report (${new Date(le.data.report.report_date).toLocaleDateString()})</h4>
                    ${za(le.data.report,le.data.report.tests)}
                  </div>
                `),`
                <div class="lab-history-item">
                  <p><strong>Order Date:</strong> ${new Date(le.originalDateString).toLocaleDateString()}</p>
                  <p><strong>Status:</strong> ${le.data.status}</p>
                  <p><strong>Tests:</strong> ${ce}</p>
                  ${Ne}
                </div>
              `}).join("")}
          `:"<p>No lab history.</p>"}
        </div>
      `;kc(Q)}else kc("")},[g,E,Jr,or,gr,za]);const Po=()=>{Cc&&Pl(Cc,`Patient Details - ${g==null?void 0:g.name}`)},ms=Q=>{ir(Q)},ke=Z||ee||ue||ae||sr||Rs||Is||Os||ua||tr||wo||Tn,Xe=()=>{a("reports came,please anaylse"),setTimeout(()=>{ir()},0)},He=Q=>{ca(le=>({...le,[Q]:!le[Q]}))},jt=Q=>{Q.key==="Enter"&&!Q.shiftKey&&(Q.preventDefault(),!ke&&!be&&!ae&&r.trim()&&e&&ir())};w.useEffect(()=>{const Q=window.SpeechRecognition||window.webkitSpeechRecognition;if(!Q){$s("Speech recognition not supported in this browser.");return}const le=new Q;return le.continuous=!0,le.interimResults=!0,le.lang="en-US",le.onresult=ce=>{let Ne="";for(let tt=ce.resultIndex;tt<ce.results.length;++tt)ce.results[tt].isFinal&&(Ne+=ce.results[tt][0].transcript);Ne&&a(tt=>tt+(tt.endsWith(" ")||tt===""?"":" ")+Ne)},le.onerror=ce=>{$s(`Speech error: ${ce.error}`),Nl(!1)},le.onend=()=>{},kr.current=le,()=>{kr.current&&kr.current.stop()}},[]);const zt=async()=>{if(u)if(Ls){Su(!0);try{const Q=await de(`/api/patients/${u}/discharge`,{method:"POST"});if(!Q.ok){const le=await Q.json().catch(()=>({}));throw new Error(le.message||`Failed to discharge patient: ${Q.status}`)}Eo(u)}catch(Q){H(`Discharge Error: ${Q.message}`)}finally{Su(!1)}}else{yc(!0);try{const Q=await de(`/api/patients/${u}/admit`,{method:"POST"});if(!Q.ok){const le=await Q.json().catch(()=>({}));throw new Error(le.message||`Failed to admit patient: ${Q.status}`)}Eo(u)}catch(Q){H(`Admit Error: ${Q.message}`)}finally{yc(!1)}}},bn=async Q=>{if(u){yl(!0);try{const ce=await de("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:u})});if(!ce.ok){const Ne=await ce.json().catch(()=>({}));throw new Error(Ne.message||`Failed to add patient to ${Q} queue: ${ce.status}`)}u&&(Eo(u),Tr(u))}catch(le){H(`Add to Queue Error: ${le.message}`)}finally{yl(!1)}}},wi=async()=>{if(e){No(!0),H(null);try{const Q=await de(`/api/queue/${e}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"seen"})});if(!Q.ok){const le=await Q.json().catch(()=>({}));throw new Error(le.message||"Failed to complete consultation")}u&&(Eo(u),Tr(u))}catch(Q){H(`Error completing consultation: ${Q.message}`)}finally{No(!1)}}},Nn=async()=>{if(!u){Ra("Missing Patient ID.");return}if(!g){Ra("Patient details not loaded.");return}us(!0),Ra(null);try{const Q={};let le=!1;if(xl!==g.name&&(Q.name=xl,le=!0),cs!==g.age&&(Q.age=cs===""?0:typeof cs=="string"?parseInt(cs,10)||0:cs,le=!0),xc!==g.gender&&(Q.gender=xc,le=!0),jo!==g.phone&&(Q.phone=jo,le=!0),!le){Ra("No changes detected."),us(!1),Ma(!1);return}const ce=await de(`/api/patients/${u}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Q)});if(!ce.ok){const tt=await ce.json().catch(()=>({}));throw new Error(tt.message||`Failed to update patient details: ${ce.statusText}`)}const Ne=await ce.json();b(Ne),S(Ne.age),T(Ne.gender),bl(Ne.name),vl(Ne.age),Fs(Ne.gender),wl(Ne.phone),Ma(!1)}catch(Q){Ra(`Save Error: ${Q.message}`)}finally{us(!1)}},Tc=w.useCallback(()=>{if(!g)return null;const Q={token_number:g.patient_token_number||"N/A",name:g.name||"N/A",age:g.age||"N/A",gender:g.gender||"N/A",phone:g.phone||"N/A"};return Jr.length>0?Q.complaints_history=Jr.map(le=>`${le.data.complaint} (${new Date(le.originalDateString).toLocaleDateString()})`).join("; "):Q.complaints_history="No past complaints.",or.length>0?Q.pharmacy_orders_history=or.map(le=>`Order: ${le.data.medications.map(Ne=>{let tt=`${Ne.name}`;return Ne.pack_quantity!==void 0&&Ne.pack_quantity>0&&(tt+=` Packs: ${Ne.pack_quantity}`),Ne.loose_quantity!==void 0&&Ne.loose_quantity>0&&(tt+=` Loose: ${Ne.loose_quantity}`),tt}).join(", ")} (${le.data.status}, ${new Date(le.originalDateString).toLocaleDateString()})`).join("; "):Q.pharmacy_orders_history="No pharmacy orders.",gr.length>0?Q.lab_orders_history=gr.map(le=>{let Ne=`Lab Order: ${le.data.tests.map(tt=>tt.name).join(", ")} (${le.data.status}, ${new Date(le.originalDateString).toLocaleDateString()})`;return le.data.report&&(Ne+=` - Report: ${le.data.report.report_content} (${new Date(le.data.report.report_date).toLocaleDateString()})`),Ne}).join("; "):Q.lab_orders_history="No lab history.",Fa&&Fa.length>0?Q.recurring_medications=Fa.map(le=>`${le.medications.map(Ne=>Ne.name).join(", ")} (Freq: ${le.frequency_days}d, Next: ${new Date(le.next_delivery_date).toLocaleDateString()})`).join("; "):Q.recurring_medications="No recurring medications.",Q},[g,Jr,or,gr,Fa]),oh=()=>{if(!g){$s("Patient details are required to use the Live API.");return}Mn(!0)},xr=()=>{var Q;(Q=zs.current)==null||Q.click()},Ac=Q=>{var ce;const le=(ce=Q.target.files)==null?void 0:ce[0];le&&vc(le)},lh=o.some(Q=>Q.sender==="user"||Q.sender==="system");return i.jsxs("div",{className:"edit-complaint-page",style:{height:`${pe}px`},children:[i.jsx(pQ,{ref:Cl,recordId:e,patientId:u,patientDetails:g,caseSummary:E,caseSummaryUpdatedAt:U,clinicSettings:nn,userMessages:o.map(Q=>`${Q.sender==="user"?"User":Q.sender==="ai"?"Assistant":"System"}: ${Q.text}`),selectedImageFile:da,pendingLabOrders:oi,labReports:Ye,pastComplaints:Ke,recurringMedications:Fa,pharmacyOrders:ze,pharmacyInventory:It,labInventory:$t,setAiResponse:D,setAiResponseText:ve,setAiResponseJsonString:ge,setShowAiJsonDetails:se,setIsLoadingAi:oe,setCaseSummary:P,setCaseSummaryUpdatedAt:Y,setFollowUpQuestion:th,setFollowUpOptions:Tu,setError:H,setIsSavingAiResponse:Ee,setSaveAiResponseError:fe,fetchPharmacyOrdersData:qs,fetchPendingLabOrdersData:Gi,fetchLabReportsData:hs,fetchPastComplaintsData:Xd,fetchRecurringMedicationsData:kl,fetchPatientDetails:Eo,fetchPatientContext:Jn,setClinicSettings:Oa,setEditedAiMemory:Us,handleDeleteItem:Tl,handleAdmitDischargePatient:zt,handleCompleteConsultation:wi,handleAddToQueue:bn,setCanUndoAi:Kd,addMessageToHistory:h,clearConversationHistory:d}),Qd&&g&&i.jsx(xE,{onClose:()=>Mn(!1),patientData:Tc(),tokenNumber:g.patient_token_number?String(g.patient_token_number):null,onAiSummaryChange:Q=>{Q&&(ir(Q),Mn(!1))}}),i.jsxs("div",{className:"edit-complaint-header",children:[i.jsx("button",{onClick:()=>n(-1),disabled:ke,className:"back-button",title:"Go Back",children:i.jsx(on,{size:18})}),i.jsx("span",{ref:at,style:{position:"absolute",visibility:"hidden",height:"auto",width:"auto",whiteSpace:"nowrap"}}),Z&&!g&&i.jsx("div",{className:"edit-complaint-patient-details skeleton",style:{width:"300px",height:"2.5rem"}}),g&&i.jsx("div",{className:"edit-complaint-patient-details-wrapper",children:ls?i.jsxs("div",{className:"patient-details-edit-form",children:[i.jsx("input",{type:"text",value:xl,onChange:Q=>bl(Q.target.value),placeholder:"Name",className:"edit-input",disabled:sr}),i.jsx("input",{type:"number",value:cs??"",onChange:Q=>vl(Q.target.value),onBlur:Q=>{Q.target.value===""&&vl(0)},placeholder:"Age",className:"edit-input",disabled:sr}),i.jsxs("select",{value:xc??"",onChange:Q=>Fs(Q.target.value||null),className:"edit-input",disabled:sr,children:[i.jsx("option",{value:"",children:"Select Gender"}),i.jsx("option",{value:"M",children:"Male"}),i.jsx("option",{value:"F",children:"Female"}),i.jsx("option",{value:"O",children:"Other"})]}),i.jsx("input",{type:"text",value:jo??"",onChange:Q=>wl(Q.target.value||null),placeholder:"Phone Number",className:"edit-input",disabled:sr}),i.jsxs("div",{className:"edit-actions",children:[i.jsx("button",{onClick:()=>{Ma(!1),Ra(null)},className:"button-secondary",disabled:sr,children:"Cancel"}),i.jsx("button",{onClick:Nn,className:"button-primary blue",disabled:sr,children:sr?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),"Saving..."]}):"Save"})]}),bc&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:bc})]}):i.jsxs("div",{className:"edit-complaint-patient-details",children:[i.jsx("button",{onClick:()=>{Ma(!0),bl(g.name||""),vl(g.age),Fs(g.gender),wl(g.phone),Ra(null)},className:"edit-patient-btn",title:"Edit Patient Details",disabled:sr,children:i.jsx(Cs,{size:12})}),i.jsx("span",{className:"patient-name",children:g.name??"N/A"}),g.patient_token_number!==null&&i.jsxs("span",{className:"patient-token",children:["#",g.patient_token_number]}),i.jsx("button",{onClick:Po,disabled:!Cc,title:"Print All Patient Details",className:"icon-button small ml-2",children:i.jsx(fo,{size:14})}),i.jsxs("div",{className:"patient-meta",children:[i.jsxs("span",{className:"meta-item",children:[g.age??"N/A"," yrs"]}),i.jsx("span",{className:"meta-divider",children:"|"}),i.jsx("span",{className:"meta-item",children:g.gender??"O"}),g.phone&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"meta-divider",children:"|"}),i.jsx("span",{className:"meta-item",children:g.phone})]}),(g==null?void 0:g.insurance_type)&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"meta-divider",children:"|"}),i.jsx("div",{className:"insurance-type-container inline-block ml-1",children:i.jsx("span",{onClick:()=>{const Q={cash:"insurance",insurance:"no_cash_insurance",no_cash_insurance:"cash"}[g.insurance_type||"cash"];Er(g.id,Q)},className:"insurance-type-toggle cursor-pointer hover:text-blue-600 select-none",style:{fontSize:"0.75rem",fontWeight:600},title:"Click to cycle: Cash -> Ins. -> None",children:{cash:"Cash",insurance:"Ins.",no_cash_insurance:"None"}[g.insurance_type||"cash"]})})]})]})]})}),!g&&v!==void 0&&k!==void 0&&i.jsxs("div",{className:"edit-complaint-patient-details",children:[v??"N/A"," / ",k??"N/A"]})]}),i.jsxs("div",{className:"edit-complaint-content-area",ref:bt,children:[lh&&i.jsx("div",{className:"edit-complaint-chat-panel",style:{flex:"0 0 25%",display:"flex",flexDirection:"column",borderRight:"1px solid var(--border-color)",overflow:"hidden"},children:i.jsxs("div",{className:"chat-history-container",style:{flex:1,overflowY:"auto",padding:"0.5rem"},children:[i.jsx("h4",{style:{fontSize:"0.7rem",fontWeight:600,marginBottom:"0.5rem",color:"var(--text-muted)"},children:"Conversation"}),o.map(Q=>i.jsx("div",{className:`chat-message ${Q.sender}`,style:{marginBottom:"0.5rem",padding:"0.5rem 0.75rem",borderRadius:"0.5rem",background:Q.sender==="user"?"var(--primary-color)":Q.sender==="ai"?"#f3f4f6":Q.text.startsWith("")?"var(--danger-bg, #f8d7da)":"var(--success-bg, #d4edda)",color:Q.sender==="user"?"white":Q.sender==="ai"?"#1f2937":Q.text.startsWith("")?"var(--danger-text, #721c24)":"var(--success-text, #155724)",fontSize:Q.sender==="system"||Q.sender==="ai"?"0.7rem":"0.8rem",fontStyle:Q.sender==="system"||Q.sender==="ai"?"italic":"normal",wordBreak:"break-word"},children:i.jsx(uo,{remarkPlugins:[ks],children:Q.text})},Q.id))]})}),i.jsxs("div",{className:"edit-complaint-main-column",style:{flex:`0 0 calc(${100-We-(lh?25:0)}% - 8px)`},children:[W&&i.jsxs("div",{className:"general-error-message",children:["Error: ",W]}),i.jsx("div",{ref:Ae,className:"mobile-scroll-anchor"}),ae&&i.jsx("div",{className:"ai-function-status info text-center",children:"Creating record..."}),Ie&&i.jsxs("div",{className:"general-error-message",children:["Error saving AI response: ",Ie]}),ue&&i.jsx("div",{className:"ai-function-status info text-center",children:"Saving AI response..."}),(te||M)&&i.jsxs("div",{ref:we,className:`${M?"ai-function-call-block":"ai-response-container"} group`,children:[te&&i.jsx(uo,{remarkPlugins:[ks],children:te}),M&&i.jsxs("div",{className:"ai-json-details-container",children:[i.jsxs("button",{onClick:()=>se(!_e),className:"ai-json-toggle-button",children:[_e?i.jsx(t1,{size:14,className:"mr-1"}):i.jsx(ab,{size:14,className:"mr-1"}),_e?"Hide":"Show"," AI Function Call Details"]}),_e&&i.jsx("pre",{className:"ai-json-pre",children:i.jsx("code",{children:JSON.stringify(JSON.parse(M),null,2)})})]}),i.jsxs("div",{className:"ai-response-actions",children:[i.jsx("button",{onClick:()=>Ar(he),disabled:!he,title:"Copy Full AI Response",children:i.jsx(bI,{size:12})}),i.jsx("button",{onClick:fp,disabled:!he,title:"Print AI Response",children:i.jsx(fo,{size:12})})]})]})]}),i.jsx("div",{className:`draggable-divider ${dt?"active":""}`,onMouseDown:nh,onDoubleClick:ih,title:"Drag to resize. Double-click to reset."}),i.jsx("div",{className:"edit-complaint-context-column",ref:ft,style:{flex:`0 0 calc(${We}% - 4px)`},children:i.jsxs("div",{className:"ai-context-container",children:[i.jsx("div",{className:"ai-context-section",children:Z&&!g?i.jsxs("div",{className:"space-y-2 mt-2 px-4",children:[i.jsx("div",{className:"skeleton-text"}),i.jsx("div",{className:"skeleton-text short"})]}):i.jsxs("div",{className:"px-4",children:[(g==null?void 0:g.admission_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Admitted:"})," ",new Date(g.admission_date).toLocaleDateString()]}),(g==null?void 0:g.discharge_date)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Discharged:"})," ",new Date(g.discharge_date).toLocaleDateString()]}),(g==null?void 0:g.current_status)&&i.jsxs("p",{className:"ai-context-text",children:[i.jsx("strong",{children:"Current Status:"})," ",i.jsx("span",{className:"font-semibold",children:g.current_status})]}),i.jsxs("div",{className:"flex space-x-2 mt-2",children:[i.jsxs("button",{onClick:zt,className:`admit-discharge-button ${Ls?"discharge":"admit"}`,title:Ls?"Discharge Patient":"Admit Patient",disabled:!u||Os||ua,children:[(Os||ua)&&i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),Os?"Admitting...":ua?"Discharging...":Ls?"Discharge":"Admit"]}),i.jsxs("button",{onClick:()=>bn("doctor"),className:`queue-status-button ${Ia?"in-queue":"add-to-queue"}`,title:Ia?"Patient is in Doctor Queue":"Add Patient to Doctor Queue",disabled:!u||tr||Ia,children:[tr&&i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),tr?"Adding...":Ia?"In Queue":"Add to Queue"]}),i.jsxs("button",{onClick:wi,className:"complete-consultation-button",title:"Mark Consultation as Complete",disabled:wo,children:[wo&&i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),wo?"Completing...":"Complete Consultation"]})]})]})}),i.jsxs("div",{className:"ai-context-section",children:[i.jsx("h4",{className:"ai-context-section-title px-4",children:"Recurring Medications"}),Z&&Fa.length===0?i.jsxs("div",{className:"space-y-2 mt-2 px-4",children:[i.jsx("div",{className:"skeleton-text"}),i.jsx("div",{className:"skeleton-text short"})]}):Fa.length>0?i.jsx("div",{className:"recurring-meds-container space-y-3",children:Fa.map((Q,le)=>i.jsxs("div",{className:"ai-context-item flex flex-col px-4 py-3 border-b border-gray-50 last:border-0",style:{"--i":le},children:[i.jsxs("div",{className:"flex justify-between items-center mb-2 pb-2 border-b border-gray-50 dark:border-gray-800",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("span",{className:"text-xs font-semibold text-gray-500",children:["#",le+1," Status:"]}),i.jsx("span",{className:`status-badge text-[10px] uppercase font-bold px-1.5 py-0.5 rounded ${Q.status==="active"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":Q.status==="paused"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"}`,children:Q.status})]}),i.jsxs("div",{className:"flex space-x-1",children:[i.jsx("button",{onClick:()=>lp(Q),className:"icon-button small",title:"Edit Recurring Medication",children:i.jsx(Cs,{size:12})}),i.jsx("button",{onClick:()=>cp(Q.id),className:"icon-button small text-red-500",title:"Delete Recurring Medication",children:i.jsx(Hi,{size:12})})]})]}),i.jsx("div",{className:"pharmacy-order-drugs-table-container",children:i.jsxs("table",{className:"pharmacy-order-drugs-table w-full text-[11px] table-fixed",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2 text-left w-[40%]",children:"Medications"}),i.jsx("th",{className:"py-1 px-2 text-left w-[20%]",children:"Dosage"}),i.jsx("th",{className:"py-1 px-2 text-left w-[40%]",children:"Freq / Next"})]})}),i.jsx("tbody",{children:i.jsxs("tr",{children:[i.jsx("td",{className:"py-2 px-2 align-top",children:i.jsx("div",{className:"space-y-2",children:Q.medications.map((ce,Ne)=>i.jsxs("div",{className:"flex flex-col border-b border-gray-50 dark:border-gray-800/50 last:border-0 pb-1 last:pb-0",children:[i.jsx("strong",{className:"break-words leading-tight",children:ce.name}),i.jsx("div",{className:"flex flex-wrap gap-x-2 text-gray-500 text-[10px]",children:i.jsxs("span",{children:[ce.pack_quantity?`${ce.pack_quantity}p`:"",ce.pack_quantity&&ce.loose_quantity?" + ":"",ce.loose_quantity?`${ce.loose_quantity}l`:""]})}),ce.directions_to_use&&i.jsx("span",{className:"text-[10px] text-blue-600 dark:text-blue-400 italic mt-0.5 line-clamp-2",title:ce.directions_to_use,children:ce.directions_to_use})]},Ne))})}),i.jsx("td",{className:"py-2 px-2 align-top",children:i.jsx("div",{className:"space-y-2",children:Q.medications.map((ce,Ne)=>i.jsx("div",{className:"flex flex-col border-b border-gray-50 dark:border-gray-800/50 last:border-0 pb-1 last:pb-0 h-[32px] justify-center",children:ce.tabletsPerDay?`${ce.tabletsPerDay} / day`:"-"},Ne))})}),i.jsxs("td",{className:"py-2 px-2 align-top italic text-gray-500 break-words leading-tight",children:[i.jsxs("div",{className:"font-semibold text-gray-700 dark:text-gray-300",children:["Every ",Q.frequency_days,"d"]}),i.jsxs("div",{className:"text-[10px] not-italic mt-1 text-gray-400",children:["Next: ",new Date(Q.next_delivery_date).toLocaleDateString()]}),Q.last_delivery_date&&i.jsxs("div",{className:"text-[9px] not-italic mt-0.5 text-gray-400",children:["Last: ",new Date(Q.last_delivery_date).toLocaleDateString()]})]})]})})]})})]},Q.id))}):i.jsx("p",{className:"ai-context-text italic text-gray-400 mt-2 px-4",children:"No recurring medications."})]}),i.jsx(M0,{title:"Pharmacy Order History",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[Jd&&i.jsxs("button",{onClick:()=>{var Q;return(Q=Cl.current)==null?void 0:Q.undoLastBatch()},className:"flex items-center justify-center bg-red-100 hover:bg-red-200 text-red-700 border border-red-200 rounded text-xs px-2 py-1 transition-colors",disabled:ke,title:"Undo Last AI Batch",children:[i.jsx(mM,{size:12,className:"mr-1"})," Undo AI"]}),i.jsx("button",{onClick:_c,className:"action-button primary",disabled:Tn||ze.filter(Q=>Q.status==="pending").length<2,title:"Merge all pending orders into one",children:Tn?i.jsx(i.Fragment,{children:i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"})}):"Merge Orders"}),i.jsxs("button",{onClick:()=>pc(!0),className:"action-button success",title:"Manually create a new pharmacy order",disabled:!u,children:[i.jsx(hl,{size:12})," Add Pharmacy Order"]})]}),items:or,isLoading:Z,loadingText:"Loading...",noDataText:"No orders.",renderItemContent:(Q,le)=>i.jsxs("div",{className:"flex flex-col w-full",children:[i.jsxs("span",{className:"ai-context-text flex items-center",children:[(()=>{const ce=yY(Q.data.status);return i.jsxs(i.Fragment,{children:[or.length-le,". Order Status:"," ",i.jsx("span",{className:`${ce.className} ml-1`,children:ce.text})]})})(),ni===Q.data.id?i.jsxs("div",{className:"flex items-center space-x-1 ml-2",children:[i.jsx("input",{type:"datetime-local",value:Pi,onChange:ce=>er(ce.target.value),className:"text-xs p-1 border rounded",style:{width:"auto"}}),i.jsx("button",{onClick:()=>sh(Q.data.id),className:"text-green-600 hover:text-green-800",children:i.jsx(Ds,{size:14})}),i.jsx("button",{onClick:()=>gn(null),className:"text-red-500 hover:text-red-700",children:i.jsx(In,{size:14})})]}):i.jsxs("span",{className:"text-gray-400 ml-1 flex items-center group",children:["(",new Date(Q.originalDateString).toLocaleDateString(),")",i.jsx("button",{onClick:ce=>{ce.stopPropagation(),er(new Date(Q.originalDateString).toISOString().slice(0,16)),gn(Q.data.id)},className:"ml-1 hover:text-blue-600",title:"Edit Order Date",children:i.jsx(Cs,{size:10})})]}),i.jsxs("div",{className:"inline-flex space-x-2 ml-2",children:[i.jsx("button",{onClick:()=>Nc(Q.data.id),className:"icon-button small",title:"Edit Pharmacy Order",children:i.jsx(Cs,{size:12})}),Q.data.prescriptionForUnavailableDrugs&&i.jsx("button",{onClick:()=>Pl(Q.data.prescriptionForUnavailableDrugs,"Unavailable Drugs Prescription"),className:"icon-button small",title:"Print Unavailable Drugs Prescription",children:i.jsx(fo,{size:12})}),i.jsx("button",{onClick:()=>Tl({type:"Pharmacy Order",data:Q.data}),className:"icon-button small text-red-500",title:"Delete Pharmacy Order",children:i.jsx(Hi,{size:12})}),i.jsx("button",{onClick:()=>op(Q.data.id),className:"icon-button small",title:"Mark as Recurring Medication",disabled:Rs,children:i.jsx(fM,{size:12})}),Q.data.status==="pending"&&i.jsx("button",{onClick:()=>sp(Q.data.id),className:"icon-button small",title:"Bill this pharmacy order",disabled:Rs,children:i.jsx(sg,{size:12})}),Q.data.status==="billed"&&i.jsx("button",{onClick:()=>Cu(Q.data.id,"dispensed"),className:"icon-button small",title:"Dispense this pharmacy order",disabled:Rs,children:i.jsx(Ea,{size:12})}),Q.data.status==="dispensed"&&i.jsx("button",{onClick:async()=>{var ce;try{const Ne=await de(`/api/bills?patientId=${Q.data.patientId}`);if(!Ne.ok)throw new Error("Failed to fetch bills");const vt=(ce=(await Ne.json()).bills)==null?void 0:ce.find(At=>At.related_id===Q.data.id&&At.type==="pharmacy");vt?n(`/dashboard/bills/${vt.id}`):alert("Bill not found for this order.")}catch(Ne){console.error("Error fetching bill:",Ne),alert("Failed to fetch bill. Please try again.")}},className:"icon-button small",title:"View Bill",children:i.jsx(og,{size:12})})]})]}),i.jsx("div",{className:"pharmacy-order-drugs-table-container mt-2 clickable",onClick:()=>Nc(Q.data.id),title:"Click to edit pharmacy order",children:i.jsxs("table",{className:"pharmacy-order-drugs-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2 text-left",children:"Drug Name"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Quantity"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Dosage"}),i.jsx("th",{className:"py-1 px-2 text-left",children:"Directions"})]})}),i.jsx("tbody",{children:Q.data.medications.map((ce,Ne)=>i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:i.jsx("strong",{children:ce.name})}),i.jsxs("td",{className:"py-1 px-2",children:[ce.pack_quantity!==void 0&&ce.pack_quantity>0&&`Packs: ${ce.pack_quantity}`,ce.pack_quantity!==void 0&&ce.pack_quantity>0&&ce.loose_quantity!==void 0&&ce.loose_quantity>0&&", ",ce.loose_quantity!==void 0&&ce.loose_quantity>0&&`Loose: ${ce.loose_quantity}`]}),i.jsx("td",{className:"py-1 px-2",children:ce.tabletsPerDay&&ce.numberOfDays?`${ce.tabletsPerDay} tab/day for ${ce.numberOfDays} days`:"N/A"}),i.jsx("td",{className:"py-1 px-2",children:ce.directions_to_use||"N/A"})]},ce.drug_id||ce.name||Ne))})]})}),Q.data.prescriptionForUnavailableDrugs&&i.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[i.jsx("span",{className:"font-semibold",children:"Prescription:"})," ",Q.data.prescriptionForUnavailableDrugs]})]})}),i.jsx(NW,{isOpen:vo,onClose:()=>pc(!1),patientId:u,pharmacyInventory:It,fetchPharmacyOrdersData:qs}),i.jsx(M0,{title:"Lab History (Orders & Reports)",headerAction:i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:Xe,className:"action-button primary",title:"Tell AI to analyse the reports",disabled:ke,children:"Analyse Reports"}),i.jsx("button",{onClick:()=>fc(!0),className:"action-button success",title:"Manually create a new lab order",disabled:!u,children:"Create Lab Order"})]}),items:gr,onSaveLabOrder:Eu,onCancelEditLabOrder:Sc,onLabOrderTestChange:To,onLabOrderStatusChange:ku,labInventory:$t,isSavingLabOrder:Rs,isLoading:sa||Ge,loadingText:"Loading...",noDataText:"No lab Hx.",expandedLabReports:Ms,toggleLabReport:He,renderItemContent:(Q,le)=>{const ce=gY(Q.data.report?Q.data.report.status:Q.data.status);return i.jsxs("div",{className:"ai-context-text",children:[i.jsxs("div",{className:"flex justify-between items-center w-full mb-1",children:[i.jsxs("span",{onClick:()=>El(Q.data),style:{cursor:"pointer"},className:"hover:text-blue-600 font-medium",title:"Click to view details or bill",children:[Q.data.serialNumber,". ",i.jsx("span",{className:"text-blue-600",children:"[Order]"})," ","(",i.jsx("span",{className:ce.className,children:ce.text}),")"]}),Ut===Q.data.id?i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx("input",{type:"datetime-local",value:Ln,onChange:Ne=>Qn(Ne.target.value),className:"text-xs p-1 border rounded",style:{width:"auto"}}),i.jsx("button",{onClick:()=>Au(Q.data.id),className:"text-green-600 hover:text-green-800",children:i.jsx(Ds,{size:14})}),i.jsx("button",{onClick:()=>hn(null),className:"text-red-500 hover:text-red-700",children:i.jsx(In,{size:14})})]}):i.jsxs("span",{className:"text-xs text-gray-400 flex items-center group-hover:text-gray-600",children:[new Date(Q.originalDateString).toLocaleDateString(),i.jsx("button",{onClick:Ne=>{Ne.stopPropagation(),Qn(new Date(Q.originalDateString).toISOString().slice(0,16)),hn(Q.data.id)},className:"ml-1 hover:text-blue-600",title:"Edit Order Date",children:i.jsx(Cs,{size:10})})]})]}),Q.data.tests&&Q.data.tests.length>0?i.jsx("div",{className:"lab-order-tests-table-container clickable",onClick:()=>El(Q.data),title:"Click to view details or bill",children:i.jsxs("table",{className:"lab-order-tests-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Test name"}),i.jsx("th",{className:"text-right",children:"Price"})]})}),i.jsxs("tbody",{children:[Q.data.tests.map(Ne=>i.jsxs("tr",{children:[i.jsx("td",{children:i.jsx("strong",{children:Ne.name})}),i.jsxs("td",{className:"text-right font-mono",children:["",Number(Ne.price).toFixed(2)]})]},Ne.id||Ne.name)),i.jsxs("tr",{className:"total-row",children:[i.jsx("td",{children:"Total"}),i.jsxs("td",{className:"text-right font-mono",children:["",Q.data.tests.reduce((Ne,tt)=>Ne+(Number(tt.price)||0),0).toFixed(2)]})]})]})]})}):i.jsx("div",{className:"italic text-gray-500 text-xs py-1 px-2 border border-dashed border-gray-200 rounded my-1",children:"No tests specified"}),i.jsxs("div",{className:"inline-flex space-x-2 ml-2",children:[i.jsx("button",{onClick:()=>Zd(Q.data.id),className:"icon-button small",title:"Edit Order Details",children:i.jsx(Cs,{size:12})}),i.jsx("button",{onClick:()=>Tl({type:"Lab Order",data:Q.data}),className:"icon-button small text-red-500",title:"Delete Lab Order",children:i.jsx(Hi,{size:12})}),Q.data.status==="billed"&&i.jsx("button",{onClick:()=>jc(Q.data.id,"collected"),className:"icon-button small",title:"Collect Sample",children:i.jsx(co,{size:12})}),Q.data.status==="collected"&&i.jsx("button",{onClick:()=>jc(Q.data.id,"processing"),className:"icon-button small",title:"Mark Processing",children:i.jsx(Xm,{size:12})}),(Q.data.status==="processing"||Q.data.status==="report_ready"||Q.data.status==="reported")&&i.jsx("button",{onClick:()=>Do(Q.data),className:"icon-button small",title:"Enter Report",children:i.jsx(ns,{size:12})}),(Q.data.status==="report_ready"||Q.data.status==="reported")&&i.jsx("button",{onClick:()=>jc(Q.data.id,"completed"),className:"icon-button small",title:"Mark Completed",children:i.jsx(Ea,{size:12})}),(Q.data.status==="completed"||Q.data.status==="report_ready"||Q.data.status==="reported")&&i.jsx("button",{onClick:()=>Do(Q.data),className:"icon-button small",title:"View Report",children:i.jsx(og,{size:12})}),Q.data.status==="pending"&&i.jsx("button",{onClick:()=>Ao(Q.data),className:"icon-button small",title:`Pay (Total: ${Q.data.tests.reduce((Ne,tt)=>Ne+(Number(tt.price)||0),0).toFixed(2)})`,children:i.jsx(sg,{size:12})})]}),Q.data.report&&i.jsxs("div",{className:"ml-4 mt-1 p-2 border-l-2 border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-medium",children:"[Report]"}),Oi===Q.data.id?i.jsxs("div",{className:"flex items-center space-x-1 ml-2",children:[i.jsx("input",{type:"datetime-local",value:hr,onChange:Ne=>ss(Ne.target.value),className:"text-xs p-1 border rounded",style:{width:"auto"}}),i.jsx("button",{onClick:()=>ah(Q.data.id),className:"text-green-600 hover:text-green-800",children:i.jsx(Ds,{size:14})}),i.jsx("button",{onClick:()=>Si(null),className:"text-red-500 hover:text-red-700",children:i.jsx(In,{size:14})})]}):i.jsxs("span",{className:"text-gray-400 ml-1 flex items-center group",children:["(",new Date(Q.data.report.report_date).toLocaleDateString(),")",i.jsx("button",{onClick:Ne=>{Ne.stopPropagation(),ss(new Date(Q.data.report.report_date).toISOString().slice(0,16)),Si(Q.data.id)},className:"ml-1 hover:text-blue-600",title:"Edit Report Date",children:i.jsx(Cs,{size:10})})]}),i.jsx("button",{onClick:()=>He(Q.data.report.reportId),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:Ms[Q.data.report.reportId]?"Collapse Report":"Expand Report",children:Ms[Q.data.report.reportId]?i.jsx(t1,{size:14}):i.jsx(ab,{size:14})})]}),Ms[Q.data.report.reportId]&&(()=>{try{const Ne=JSON.parse(Q.data.report.report_content||"{}");return typeof Ne=="object"&&Ne!==null&&Q.data.report.tests?Q.data.report.tests.map(tt=>i.jsxs("div",{style:{marginBottom:"10px"},children:[i.jsx("h5",{className:"font-semibold text-sm mt-2 mb-1",children:tt.name}),Ne[tt.id]?i.jsxs("table",{className:"lab-inventory-table w-full text-xs",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"py-1 px-2",children:"Parameter"}),i.jsx("th",{className:"py-1 px-2",children:"Value"}),i.jsx("th",{className:"py-1 px-2",children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(Ne[tt.id]).map(([vt,At])=>{var Ro;const Ct=(Ro=tt.default_parameters)==null?void 0:Ro.find(ha=>ha.name===vt),Kn=typeof At=="string"?parseFloat(At):typeof At=="number"?At:NaN,Ba=(Ct==null?void 0:Ct.type)==="number"&&!isNaN(Kn)&&At!==""&&At!==null&&At!==void 0&&(Ct.lower_limit!=null&&Kn<Ct.lower_limit||Ct.upper_limit!=null&&Kn>Ct.upper_limit),Ua=(Ct==null?void 0:Ct.type)==="boolean"&&(At===!0||At==="true");return i.jsxs("tr",{children:[i.jsx("td",{className:"py-1 px-2",children:vt}),i.jsxs("td",{className:`py-1 px-2 ${Ba?"abnormal-result":""} ${Ua?"reactive-result":""}`,children:[String(At)," ",(Ct==null?void 0:Ct.unit)||""]}),i.jsx("td",{className:"py-1 px-2",children:(()=>{if(Ct&&Ct.type==="number"&&(Ct.lower_limit!=null||Ct.upper_limit!=null)){let ha="";return Ct.lower_limit!=null&&(ha+=` > ${Ct.lower_limit}`),Ct.lower_limit!=null&&Ct.upper_limit!=null&&(ha+=" - "),Ct.upper_limit!=null&&(ha+=` < ${Ct.upper_limit}`),ha.trim()||"N/A"}else if((Ct==null?void 0:Ct.type)==="boolean")return"Non-Reactive";return(Ct==null?void 0:Ct.normal_range)||"N/A"})()})]},vt)})})]}):i.jsx("p",{className:"italic text-gray-500 text-xs",children:"No parameters reported for this test."})]},tt.id)):i.jsx(uo,{remarkPlugins:[ks],children:Q.data.report.report_content})}catch{return i.jsx(uo,{remarkPlugins:[ks],children:Q.data.report.report_content||"*No findings recorded.*"})}})()]})]})}}),i.jsx(VY,{isOpen:hc,onClose:()=>fc(!1),patientId:u,labInventory:$t,fetchPendingLabOrdersData:Gi}),mc&&i.jsx(AE,{isOpen:Nu,onClose:()=>Wd(!1),recurringMedication:mc,onUpdate:()=>u&&kl(u),inventory:It}),i.jsx(M0,{title:"Complaints History",items:Jr,isLoading:Te,loadingText:"Loading...",noDataText:"No past Hx.",renderItemContent:(Q,le)=>i.jsxs("span",{className:"ai-context-text w-full block",children:[i.jsxs("strong",{className:"mr-2 text-gray-600",children:["#",Q.data.serialNumber]}),Q.data.isEditing?i.jsx("textarea",{className:"w-full text-sm p-2 border rounded focus:outline-none focus:ring-1 focus:ring-blue-500 mt-1",value:Q.data.editedComplaint!==void 0?Q.data.editedComplaint:Q.data.complaint,onChange:ce=>eh(Q.data.id,ce.target.value),rows:2,autoFocus:!0}):i.jsxs(i.Fragment,{children:[Q.data.complaint,i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(Q.originalDateString).toLocaleDateString(),")"]})]})]}),onDeleteItem:Tl,onEditComplaint:fs,onSaveComplaint:mr,onCancelEditComplaint:up}),i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("h4",{className:"ai-context-section-title px-4",children:[i.jsx(Xm,{size:16,className:"text-purple-600"})," Clinic-wide System Prompt"]}),!wc&&i.jsx("button",{onClick:hp,className:"edit-button",title:"Edit System Prompt",disabled:_u||Qr||Li,children:i.jsx(Cs,{size:14})})]}),wc&&nn?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:Sl,onChange:Q=>ds(Q.target.value),className:"context-edit-textarea",placeholder:"Enter clinic system prompt...",disabled:Qr||Li}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:yr,disabled:Qr||Li,className:"button-secondary",children:"Cancel"}),i.jsxs("button",{onClick:dp,disabled:Qr||Li||Bs===nn.aiMemory&&Sl===nn.clinicWideSystemPrompt,className:"button-primary purple",children:[Li||Qr?i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}):i.jsx(oc,{size:14,className:"mr-1"}),Li||Qr?"Saving...":"Save Settings"]})]})]}):i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none px-4",children:nn!=null&&nn.clinicWideSystemPrompt?i.jsx(uo,{remarkPlugins:[ks],children:nn.clinicWideSystemPrompt}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),!wc&&(nn==null?void 0:nn.clinicWideSystemPromptUpdatedAt)&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1 px-4",style:{fontSize:"0.625rem"},children:["Prompt Last Updated: ",new Date(nn.clinicWideSystemPromptUpdatedAt).toLocaleDateString()]})]}),i.jsxs("div",{className:"ai-context-section",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h4",{className:"ai-context-section-title px-4",children:"Case Summary"}),!I&&i.jsx("button",{onClick:rh,className:"edit-button",title:"Edit Case Summary",disabled:Z||F,children:i.jsx(Cs,{size:14})})]}),I?i.jsxs("div",{className:"mt-2",children:[i.jsx("textarea",{value:$,onChange:Q=>L(Q.target.value),className:"context-edit-textarea",rows:4,placeholder:"Enter case summary...",disabled:F}),B&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:B}),i.jsxs("div",{className:"context-edit-actions",children:[i.jsx("button",{onClick:ps,disabled:F,className:"button-secondary",children:"Cancel"}),i.jsx("button",{onClick:Ec,disabled:F||$===E,className:"button-primary blue",children:F?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"animate-spin inline-block w-3 h-3 border-2 border-current border-t-transparent rounded-full mr-2"}),"Saving..."]}):"Save"})]})]}):i.jsxs("div",{className:"px-4",children:[i.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:E?i.jsx(uo,{remarkPlugins:[ks],components:{},children:E}):i.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),U&&i.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Last Edited: ",new Date(U).toLocaleDateString()]})]})]}),Jr.length===0&&gr.length===0&&or.length===0&&!(Te||sa||Ge)&&i.jsx("p",{className:"ai-context-text italic mt-4 px-4",children:"No recent history for this patient."}),Is&&i.jsx("p",{className:"text-yellow-600 text-xs mt-2 ai-context-text",children:"Deleting..."}),Yd&&i.jsx("p",{className:"text-red-600 text-xs mt-2 ai-context-text",children:Yd})]})})]}),i.jsxs("div",{className:"mobile-section-selector",children:[i.jsxs("button",{className:`selector-item ${Ve==="context"?"active":""}`,onClick:()=>nr("context"),children:[i.jsx(Xm,{size:14}),i.jsx("span",{children:"Case"})]}),i.jsxs("button",{className:`selector-item ${Ve==="response"?"active":""}`,onClick:()=>nr("response"),children:[i.jsx(co,{size:14,className:"rotate-180"}),i.jsx("span",{children:"AI"})]})]}),i.jsxs("div",{className:"edit-complaint-input-area",children:[i.jsxs("div",{className:"status-messages-container",children:[qe&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:qe}),xe&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:xe}),oa&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:oa}),Ze&&i.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Ze})]}),e&&!ae&&i.jsxs(w.Fragment,{children:[$a&&i.jsxs("div",{className:"follow-up-question-container",children:[i.jsx("p",{className:"question-text",children:$a}),Al.length>0&&i.jsx("div",{className:"options-grid",children:Al.map((Q,le)=>i.jsx("button",{onClick:()=>ms(Q),className:"option-button",children:Q},le))})]}),Co&&i.jsx("div",{className:"speech-error-display",children:Co}),da&&i.jsxs("div",{className:"selected-file-display",children:[i.jsxs("span",{children:["Selected: ",da.name]}),i.jsx("button",{onClick:()=>{vc(null),zs.current&&(zs.current.value="")},className:"remove-file-button",title:"Remove image",children:""})]}),i.jsx("div",{className:"input-wrapper",children:i.jsxs("div",{className:"main-input-container",children:[i.jsx("input",{type:"file",ref:zs,onChange:Ac,accept:"image/*",className:"hidden"}),i.jsx("textarea",{ref:Pe,className:"complaint-textarea",value:r,onChange:Q=>a(Q.target.value),onKeyDown:jt,placeholder:"Chat with AI...",disabled:ke||!e||_o}),i.jsxs("div",{className:"chat-input-actions-container",children:[u&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>n(`/patient/${u}/lab-reports`),disabled:Ge||!u,className:"icon-button",title:"View Lab Reports",children:i.jsx(ns,{size:14})}),i.jsx("button",{onClick:()=>n("/inventory"),disabled:be,className:"icon-button",title:"View Inventory",children:i.jsx(ho,{size:14})})]}),i.jsx("button",{type:"button",onClick:xr,disabled:ke||!e||_o,className:"icon-button",title:"Attach Image",children:i.jsx(tM,{size:14})}),i.jsx("button",{type:"button",onClick:oh,disabled:ke||!e||!kr.current,className:`mic-button ${_o?"listening":""}`,title:_o?"Stop":"Mic",children:i.jsx(QC,{size:14})}),i.jsx("button",{onClick:()=>ir(),disabled:ke||be||ae||!r.trim()||!e||_o||Z||Te||sa,className:`send-button ${ee||Z||be||Te||sa?"loading":""}`,title:ke||be||ae?"Processing...":"Save & Ask AI",children:ee||Z||be||Te||sa?i.jsx("span",{className:"animate-spin",role:"status","aria-label":"loading"}):i.jsx(co,{size:14})})]})]})})]})]})]})},cte=()=>{const{patientId:e}=Yr(),n=Ot(),[t,r]=w.useState([]),[a,o]=w.useState(null),[l,h]=w.useState(!1),[d,u]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){u("Patient ID not provided.");return}h(!0),u(null);try{const b=await de(`/api/patients/${e}`);if(!b.ok)throw new Error(`Failed to fetch patient details: ${b.status}`);const v=await b.json();o({name:v.name,age:v.age,gender:v.gender});const S=await de(`/api/patients/${e}/complaints`);if(S.ok){const T=(await S.json()).sort((E,P)=>new Date(P.createdAt).getTime()-new Date(E.createdAt).getTime());r(T)}else if(S.status===404)r([]);else throw new Error(`Failed to fetch complaints: ${S.status}`)}catch(b){console.error("Error fetching past complaints or patient info:",b),u(`Failed to load data. ${b.message}`),r([]),o(null)}finally{h(!1)}})()},[e]);const f=g=>{navigator.clipboard.writeText(g).then(()=>console.log("Complaint copied to clipboard")).catch(b=>console.error("Failed to copy complaint: ",b))};return i.jsxs("div",{className:"container mx-auto p-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-1 px-3 rounded text-sm",children:"< Back"}),i.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-center flex-grow",children:"Past Complaints"}),i.jsx("div",{className:"w-16"})," "]}),a&&i.jsxs("div",{className:"mb-4 p-2 bg-gray-100 rounded text-center text-sm sm:text-base",children:["Patient: ",i.jsx("strong",{children:a.name})," (",a.age??"N/A"," / ",a.gender??"N/A",")"]}),d&&i.jsxs("div",{className:"text-red-500 p-3 mb-4 border border-red-500 rounded bg-red-50 text-sm",children:["Error: ",d]}),l&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading..."}),!l&&t.length===0&&!d&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No past complaints found for this patient."}),!l&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(g=>i.jsxs("div",{className:"p-3 border rounded shadow-sm bg-white group relative",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:new Date(g.createdAt).toLocaleString()}),i.jsx("p",{className:"text-sm whitespace-pre-wrap",children:g.complaint}),i.jsx("button",{onClick:()=>f(g.complaint),className:"absolute top-1 right-1 bg-gray-200 hover:bg-gray-300 text-gray-600 text-xs p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Copy complaint text",children:""})]},g.id))})]})},qx=500,sC="defaultConsultationFee",ute=({patientId:e,billId:n,queueId:t,onBillCreated:r,onBillUpdated:a,initialItems:o=[],billType:l="other",relatedId:h,initialStatus:d="pending",initialDiscountPercentage:u=0,readOnlyMode:f=!1,doctorId:g,labOrderId:b,patientInsuranceType:v})=>{const[S,k]=w.useState(null),[T,E]=w.useState([]),P=w.useRef(null),[I,q]=w.useState(""),[$,L]=w.useState(""),[F,z]=w.useState(1),[B,R]=w.useState(u),[U,Y]=w.useState("cash"),[Z,ne]=w.useState(!1),[ae,X]=w.useState(null),[W,H]=w.useState(!1),[he,D]=w.useState(!1),[te,ve]=w.useState(!1),[M,ge]=w.useState(null),[,_e]=w.useState([]),[se,ee]=w.useState(null),[oe,ue]=w.useState(""),[Ee,Ie]=w.useState("cash"),[fe,pe]=w.useState(!1),[Re,Ye]=w.useState(qx),[ut,Ge]=w.useState(qx.toString()),Se=n?"view_pay":"create";w.useEffect(()=>{const Ae=localStorage.getItem(sC),Ve=Ae?parseFloat(Ae):qx;isNaN(Ve)||(Ye(Ve),Ge(Ve.toString()))},[]);const qe=o.length===0;w.useEffect(()=>{e?(async()=>{ne(!0),X(null);try{const Ve=await de(`/api/patients/${e}`);if(!Ve.ok){const We=await Ve.json().catch(()=>({}));throw new Error(We.message||"Failed to fetch patient details")}const $e=await Ve.json();k($e)}catch(Ve){X(`Failed to load patient details: ${Ve.message}`),k(null)}finally{ne(!1)}})():k(null)},[e]),w.useEffect(()=>{n?(async()=>{ve(!0),X(null),ge(null),_e([]),ee(null);try{const Ve=await de(`/api/bills/${n}`);if(!Ve.ok){const We=await Ve.json().catch(()=>({}));throw new Error(We.message||"Failed to fetch bill details")}const $e=await Ve.json();if(!$e.bill||!$e.payments||!$e.calculated)throw new Error("Invalid bill details structure.");ge($e.bill),_e($e.payments),ee($e.calculated),R($e.bill.discount_percentage!==void 0&&$e.bill.discount_percentage!==null?parseFloat($e.bill.discount_percentage.toString()):0),!S&&$e.bill.patient_id&&Ue($e.bill.patient_id.toString())}catch(Ve){X(`Failed to load bill details: ${Ve.message}`),ge(null),_e([]),ee(null)}finally{ve(!1)}})():(ge(null),_e([]),ee(null))},[n]);const Ue=async Ae=>{ne(!0);try{const Ve=await de(`/api/patients/${Ae}`);if(!Ve.ok)throw new Error("Failed to fetch patient");const $e=await Ve.json();k($e)}catch(Ve){console.error("Error fetching patient details:",Ve),k(null)}finally{ne(!1)}},ze=w.useCallback(async Ae=>{D(!0),X(null);const Ve=Ae.filter($e=>$e.drug_id!=null).map(async $e=>{try{const We=await de(`/api/drugs/${$e.drug_id}`);if(!We.ok)throw new Error(`Drug ${$e.drug_id} not found.`);const ct=await We.json();return{...$e,price:ct.price,total:ct.price*$e.quantity}}catch{return X(ct=>`${ct?ct+"; ":""}Failed to fetch price for ${$e.name}`),$e}});try{const $e=await Promise.all(Ve);E(We=>{const ct=new Map($e.map(dt=>[dt.id,dt]));return We.map(dt=>ct.get(dt.id)||dt)})}catch{}finally{D(!1)}},[de]);w.useEffect(()=>{if(n){E([]),P.current=null;return}P.current!==null&&JSON.stringify(o)===JSON.stringify(P.current)||(async()=>{let $e=[];if(o&&o.length>0)$e=o.map((We,ct)=>({...We,id:`initial-${ct}-${Date.now()}`})),Y(d==="paid"?"cash":v==="no_cash_insurance"?"no_cash_insurance":"cash"),R(u),l==="pharmacy"&&!f&&await ze($e);else if(e&&qe&&l==="consultation"){let We=Re;if(g)try{const ct=await de(`/api/staff/${g}`);if(!ct.ok){const wt=await ct.json().catch(()=>({}));throw new Error(wt.message||"Doctor not found or error fetching fee")}const dt=await ct.json();dt.opd_fee!=null&&!isNaN(parseFloat(String(dt.opd_fee)))&&parseFloat(String(dt.opd_fee))>=0&&(We=parseFloat(String(dt.opd_fee)))}catch(ct){X(dt=>`${dt?dt+"; ":""}Could not fetch doctor's fee, using default. (${ct.message})`)}$e=[{id:Date.now(),name:"Consultation Fee",price:We,quantity:1,total:We*1,drug_id:null}],Y(v==="no_cash_insurance"?"no_cash_insurance":"cash")}else $e=[],Y(v==="no_cash_insurance"?"no_cash_insurance":"cash");E($e),P.current=o})()},[n,e,g,o,l,Re,qe,d,f,ze,u,v]);const lt=()=>{const Ae=parseFloat($);if(!f)if(I&&!isNaN(Ae)&&Ae>=0&&F>0){if(I.trim().toLowerCase()==="consultation fee"&&T.some($e=>$e.name.toLowerCase()==="consultation fee")){alert("Consultation Fee already added.");return}const Ve={id:Date.now(),name:I.trim(),price:Ae,quantity:F,total:Ae*F,drug_id:null};E([...T,Ve]),q(""),L(""),z(1)}else alert("Invalid item details.")},Ke=Ae=>{f||E(T.filter(Ve=>Ve.id!==Ae))},pt=w.useMemo(()=>{let Ae=T.reduce(($e,We)=>$e+We.total,0);const Ve=typeof B=="string"?parseFloat(B)||0:B;return Se==="create"&&Ve>0&&(Ae=Ae*(1-Ve/100)),(se==null?void 0:se.totalDue)!==void 0&&(se==null?void 0:se.totalDue)!==null?se.totalDue:Ae},[T,se,B,Se]),Te=w.useMemo(()=>(se==null?void 0:se.totalPaid)??0,[se]),ie=w.useMemo(()=>(se==null?void 0:se.balance)!==void 0&&(se==null?void 0:se.balance)!==null?se.balance:pt-Te,[se,pt,Te]),xe=()=>{const Ae=parseFloat(ut);!isNaN(Ae)&&Ae>=0?(Ye(Ae),localStorage.setItem(sC,Ae.toString()),alert(`Default Fee set to ${Ae.toFixed(2)}`)):alert("Invalid fee amount.")},Qe=async(Ae,Ve)=>{H(!0),X(null);try{const $e=await de("/api/payment/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Ve,billId:Ae})}),We=await $e.json();if(!$e.ok||!We.order)throw new Error(We.message||"Failed to create Razorpay order.");const{key_id:ct,order:dt}=We,wt={key:ct,amount:dt.amount,currency:dt.currency,name:"Newtons Ai HMS Clinic",description:`Bill Payment for Patient ID: ${e}`,order_id:dt.id,handler:async function(bt){try{const kt=await de("/api/payment/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({razorpay_payment_id:bt.razorpay_payment_id,razorpay_order_id:bt.razorpay_order_id,razorpay_signature:bt.razorpay_signature,billId:Ae})}),Tt=await kt.json();if(kt.ok&&Tt.success)alert("Payment Successful!"),r&&r(Ae),a&&a(),setTimeout(()=>window.print(),200);else throw new Error(Tt.message||"Payment verification failed.")}catch(kt){X(`Payment verification failed: ${kt.message}. Contact support.`)}finally{H(!1)}},prefill:{name:(S==null?void 0:S.name)||""},notes:{bill_id:Ae,patient_id:e},theme:{color:"#3399cc"},modal:{ondismiss:function(){X("Payment cancelled."),H(!1)}}};if(window.Razorpay)new window.Razorpay(wt).open();else throw new Error("Razorpay SDK not loaded.")}catch($e){X(`Failed to initiate online payment: ${$e.message}`),H(!1)}},we=async()=>{if(!n){X("Bill ID is missing.");return}if(!oe||isNaN(parseFloat(oe))||parseFloat(oe)<=0){X("Please enter a valid positive payment amount.");return}pe(!0),X(null);const Ae={amount_paid:parseFloat(oe),payment_mode:Ee};try{const Ve=await de(`/api/bills/${n}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ae)}),$e=await Ve.json();if(!Ve.ok)throw new Error($e.message||`Failed to record payment (Status: ${Ve.status})`);alert(`Payment of ${Ae.amount_paid.toFixed(2)} recorded.`),ue(""),a?a():console.log("Payment recorded.")}catch(Ve){X(`Failed to record payment: ${Ve.message}`)}finally{pe(!1)}},Pe=async()=>{if(Se==="view_pay")return;if(!e){X("Patient ID is missing for creating a bill.");return}if(T.length===0){X("Cannot finalize an empty bill.");return}H(!0),X(null);const Ae=pt,Ve=T.map(({id:$e,...We})=>We);if(U==="online"){const $e={patientId:e,queueId:t||null,items:Ve,amount:Ae,paymentMode:"online",type:l,related_id:h||b||null,status:"pending",discountPercentage:Number(B)||0,labOrderId:b||null};try{const We=await de("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify($e)}),ct=await We.json();if(!We.ok)throw new Error(ct.message||"Failed to create pending bill.");Qe(ct.id,Math.round(Ae*100))}catch(We){X(`Failed to create pending bill: ${We.message}`),H(!1)}}else{const $e="paid";if(!U){X("Payment mode required."),H(!1);return}const We={patientId:e,queueId:t||null,items:Ve,amount:Ae,paymentMode:U,type:l,related_id:h||b||null,status:$e,discountPercentage:Number(B)||0,labOrderId:b||null};setTimeout(()=>window.print(),200);try{const ct=await de("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(We)}),dt=await ct.json();if(!ct.ok)throw new Error(dt.message||"Failed to create bill.");alert("Bill marked as paid!"),r&&r(dt.id),H(!1)}catch(ct){X(`Failed to process bill: ${ct.message}`),H(!1)}}},Je=(M==null?void 0:M.type)??l,at=(M==null?void 0:M.status)??d,ft=Se==="view_pay"&&M&&at==="pending";return!e&&!n?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow text-gray-500",children:"Select patient or provide Bill ID."}):Z||Se==="view_pay"&&te?i.jsx("div",{className:"p-6 bg-white rounded-lg shadow",children:"Loading..."}):Se==="view_pay"&&!M&&!te&&ae?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading bill: ",ae]}):Se==="create"&&!S&&!Z&&ae?i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading patient: ",ae]}):i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header",children:[i.jsx("h2",{children:Se==="create"?b?"New Lab Bill":"New Bill":"Bill Analysis"}),Se==="create"&&l==="consultation"&&!f&&i.jsxs("div",{className:"default-fee-section",children:[i.jsx("label",{htmlFor:"defaultFee",children:"Default Fee"}),i.jsx("input",{id:"defaultFee",type:"number",value:ut,onChange:Ae=>Ge(Ae.target.value),placeholder:qx.toString(),disabled:f}),i.jsx("button",{onClick:xe,title:"Save Fee",disabled:f,children:i.jsx(oc,{size:16})})]})]}),ae&&!te&&!fe&&i.jsxs("div",{className:"error-box",role:"alert",children:[i.jsx(ui,{size:18}),i.jsx("span",{children:ae})]}),i.jsxs("div",{className:"billing-layout-grid",children:[i.jsxs("div",{className:"billing-left-column",children:[S&&i.jsxs("div",{className:"billing-card",children:[i.jsxs("h3",{children:[i.jsx(As,{size:18})," Patient Case"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem",fontSize:"0.9rem"},children:[i.jsxs("div",{children:[i.jsx("span",{style:{opacity:.7},children:"Name:"})," ",i.jsx("strong",{children:S.name})]}),i.jsxs("div",{children:[i.jsx("span",{style:{opacity:.7},children:"ID:"})," ",i.jsxs("strong",{children:["#",S.id]})]}),i.jsxs("div",{children:[i.jsx("span",{style:{opacity:.7},children:"Age/Sex:"})," ",i.jsxs("strong",{children:[S.age||"N/A"," / ",S.gender||"N/A"]})]}),v&&i.jsxs("div",{children:[i.jsx("span",{style:{opacity:.7},children:"Type:"})," ",i.jsx("strong",{className:"capitalize",children:v})]})]})]}),i.jsxs("div",{className:"billing-card",style:{flexGrow:1},children:[i.jsxs("div",{className:"bill-items-header",children:[i.jsx("h3",{children:"Bill Particulars"}),Se==="create"&&l==="pharmacy"&&!f&&T.some(Ae=>Ae.drug_id!=null)&&i.jsxs("button",{onClick:()=>ze(T),disabled:he,className:"refresh-prices-button",children:[i.jsx(sc,{size:14,className:he?"animate-spin":""}),i.jsx("span",{children:"Sync Prices"})]})]}),Se==="view_pay"&&M&&i.jsxs("div",{className:"bill-info-bar",style:{background:"transparent",border:"none",padding:"0 0 1rem 0"},children:[i.jsx("span",{className:`status-badge ${at==="paid"?"status-paid":"status-pending"}`,children:at}),i.jsxs("span",{style:{fontSize:"0.85rem",color:"var(--billing-text-soft)"},children:["ID: #",M.id," | ",Je]})]}),i.jsx("div",{className:"bill-items-container",children:i.jsxs("table",{className:"billing-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"#"}),i.jsx("th",{children:"Description"}),i.jsx("th",{children:"Qty"}),i.jsx("th",{style:{textAlign:"right"},children:"Total"}),!f&&Se==="create"&&i.jsx("th",{style:{width:"40px"}})]})}),i.jsxs("tbody",{children:[Se==="create"&&!he&&T.map((Ae,Ve)=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:"30px",opacity:.5},children:Ve+1}),i.jsx("td",{className:"item-name-cell",children:Ae.name}),i.jsx("td",{className:"item-qty-cell",children:Ae.quantity}),i.jsxs("td",{className:"item-price-cell",children:["",Ae.total.toFixed(2)]}),!f&&i.jsx("td",{children:typeof Ae.id=="number"&&Ae.name!=="Consultation Fee"?i.jsx("button",{onClick:()=>Ke(Ae.id),className:"btn-remove",title:"Remove",children:i.jsx(Hi,{size:16})}):i.jsx(VI,{size:14,style:{opacity:.3}})})]},Ae.id)),Se==="view_pay"&&M&&M.items.map((Ae,Ve)=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:"30px",opacity:.5},children:Ve+1}),i.jsx("td",{className:"item-name-cell",children:Ae.name}),i.jsx("td",{className:"item-qty-cell",children:Ae.quantity}),i.jsxs("td",{className:"item-price-cell",children:["",(Ae.total??Ae.price*Ae.quantity).toFixed(2)]})]},Ve)),(Se==="create"?T.length:(M==null?void 0:M.items.length)||0)===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,style:{textAlign:"center",padding:"2rem",opacity:.5},children:"No particulars added yet."})})]})]})}),Se==="create"&&!f&&i.jsxs("div",{className:"add-item-modern-form",style:{marginTop:"1.5rem",paddingTop:"1.5rem",borderTop:"1px solid var(--billing-border)"},children:[i.jsxs("div",{className:"form-field",children:[i.jsx("label",{children:"Add Particular"}),i.jsx("input",{type:"text",value:I,onChange:Ae=>q(Ae.target.value),placeholder:"Service description...",className:"modern-input"})]}),i.jsxs("div",{className:"form-field",children:[i.jsx("label",{children:"Qty"}),i.jsx("input",{type:"number",min:"1",value:F,onChange:Ae=>z(parseInt(Ae.target.value)||1),placeholder:"1",className:"modern-input"})]}),i.jsxs("div",{className:"form-field",children:[i.jsx("label",{children:"Price"}),i.jsx("input",{type:"number",value:$,onChange:Ae=>L(Ae.target.value),placeholder:"0.00",className:"modern-input"})]}),i.jsxs("button",{onClick:lt,className:"btn-add-item",children:[i.jsx(hl,{size:18})," Add"]})]})]})]}),i.jsxs("div",{className:"billing-right-column",children:[i.jsxs("div",{className:"summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h3",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{className:"summary-label",children:"Subtotal"}),i.jsxs("span",{className:"summary-value",children:["",T.reduce((Ae,Ve)=>Ae+Ve.price*Ve.quantity,0).toFixed(2)]})]}),i.jsxs("div",{className:"discount-control",children:[i.jsx(Ld,{size:18}),i.jsxs("div",{style:{flex:1},children:[i.jsx("div",{style:{fontSize:"0.75rem",opacity:.8,fontWeight:600},children:"DISCOUNT %"}),Se==="create"&&!f?i.jsx("input",{type:"number",min:"0",max:"100",step:"0.01",value:B,onChange:Ae=>R(Ae.target.value),onBlur:Ae=>{Ae.target.value===""&&R(0)}}):i.jsxs("span",{style:{fontWeight:700},children:[Number(B).toFixed(1),"%"]})]}),i.jsxs("div",{style:{textAlign:"right"},children:[i.jsx("div",{style:{fontSize:"0.75rem",opacity:.8},children:"SAVINGS"}),i.jsxs("div",{style:{fontWeight:700},children:["-",(T.reduce((Ae,Ve)=>Ae+Ve.price*Ve.quantity,0)-pt).toFixed(0)]})]})]}),i.jsxs("div",{className:"summary-row grand-total",children:[i.jsx("span",{className:"summary-label",children:"GRAND TOTAL"}),i.jsxs("div",{style:{textAlign:"right"},children:[i.jsxs("div",{className:"total-amount",children:["",pt.toFixed(0)]}),i.jsx("div",{style:{fontSize:"0.8rem",opacity:.8},children:"Total Payable Amount"})]})]}),Se==="view_pay"&&se&&i.jsxs("div",{style:{marginTop:"1rem",borderTop:"1px solid rgba(255,255,255,0.2)",paddingTop:"1rem",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[i.jsxs("div",{className:"summary-row",style:{opacity:.9},children:[i.jsx("span",{children:"Paid Amount"}),i.jsxs("span",{children:["",Te.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",style:{fontWeight:700},children:[i.jsx("span",{children:"Balance Due"}),i.jsxs("span",{children:["",ie.toFixed(2)]})]})]})]}),i.jsxs("div",{className:"payment-card",children:[i.jsxs("h3",{children:[i.jsx(Mf,{size:18})," Local Settlement"]}),Se==="create"&&!f&&i.jsxs("div",{className:"billing-actions",children:[i.jsx("div",{className:"payment-grid",children:[{id:"cash",label:"Cash",icon:i.jsx(PN,{size:20})},{id:"upi",label:"UPI",icon:i.jsx(Zv,{size:20})},{id:"card",label:"Card",icon:i.jsx(Mf,{size:20})},{id:"online",label:"Razorpay",icon:i.jsx(Zv,{size:20})},{id:"no_cash_insurance",label:"Insurance",icon:i.jsx(Ld,{size:20})},{id:"credit",label:"Credit",icon:i.jsx(Ld,{size:20})}].map(Ae=>i.jsxs("label",{className:"payment-option",children:[i.jsx("input",{type:"radio",name:"paymentMode",value:Ae.id,checked:U===Ae.id,onChange:()=>Y(Ae.id)}),i.jsxs("div",{className:"payment-btn",children:[Ae.icon,i.jsx("span",{children:Ae.label})]})]},Ae.id))}),i.jsx("button",{onClick:Pe,disabled:W||T.length===0,className:"btn-primary",children:W?"Generating Bill...":U==="online"?"Pay Online & Finalize":"Complete Settlement"})]}),Se==="view_pay"&&ft&&!f&&i.jsxs("div",{className:"billing-actions",children:[i.jsxs("div",{className:"form-field",style:{marginBottom:"1rem"},children:[i.jsx("label",{children:"Settle Amount"}),i.jsx("input",{type:"number",value:oe,onChange:Ae=>ue(Ae.target.value),onBlur:Ae=>{Ae.target.value===""&&ue("0")},placeholder:`Balance: ${ie.toFixed(0)}`,className:"modern-input"})]}),i.jsx("div",{className:"payment-grid",children:[{id:"cash",label:"Cash",icon:i.jsx(PN,{size:20})},{id:"upi",label:"UPI",icon:i.jsx(Zv,{size:20})},{id:"card",label:"Card",icon:i.jsx(Mf,{size:20})},{id:"no_cash_insurance",label:"Insurance",icon:i.jsx(Ld,{size:20})}].map(Ae=>i.jsxs("label",{className:"payment-option",children:[i.jsx("input",{type:"radio",name:"paymentMode",value:Ae.id,checked:Ee===Ae.id,onChange:()=>Ie(Ae.id)}),i.jsxs("div",{className:"payment-btn",children:[Ae.icon,i.jsx("span",{children:Ae.label})]})]},Ae.id))}),i.jsx("button",{onClick:we,disabled:fe||!oe||parseFloat(oe)<=0||parseFloat(oe)>ie+.1,className:"btn-secondary",children:fe?"Settling...":"Record Payment"})]}),at==="paid"&&i.jsx("div",{className:"status-badge status-paid",style:{textAlign:"center",width:"100%",padding:"1rem"},children:"This invoice is fully settled."}),at==="cancelled"&&i.jsx("div",{className:"status-badge status-cancelled",style:{textAlign:"center",width:"100%",padding:"1rem"},children:"This invoice was cancelled."})]})]})]})]})},dte=()=>{const e=Ot(),n=Cr(),{patientId:t,queueId:r,initialItems:a,billType:o,relatedId:l,initialStatus:h,initialDiscountPercentage:d,doctorId:u,billId:f,labOrderId:g}=n.state||{},[b,v]=w.useState(null),[S,k]=w.useState(null),[T,E]=w.useState(null),[P,I]=w.useState(null),[q,$]=w.useState(null),[L,F]=w.useState(null),[z,B]=w.useState(!0),[R,U]=w.useState(null);if(w.useEffect(()=>{(async()=>{if(!t&&!f){B(!1);return}B(!0),U(null);try{let X=t;if(f){const W=await de(`/api/bills/${f}`);if(!W.ok){const he=await W.json().catch(()=>({}));throw new Error(he.message||"Failed to fetch bill details")}const H=await W.json();H.bill&&(k(H.bill.items||[]),E(H.bill.status),I(H.bill.type),$(H.bill.related_id),F(H.bill.discount_percentage?parseFloat(H.bill.discount_percentage):0),H.bill.patient_id&&(X=H.bill.patient_id.toString()))}if(X){const W=await de(`/api/patients/${X}`);if(W.ok){const H=await W.json();v(H.insurance_type??null)}}}catch(X){console.error("Error loading billing details:",X),U(X.message||"Failed to load details")}finally{B(!1)}})()},[f,t,g]),!t&&!f&&!z)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-gray-600",children:[i.jsx(sb,{size:48,className:"mb-4 text-red-500"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Missing Patient/Bill Information"}),i.jsx("button",{onClick:()=>e("/"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Go to Dashboard"})]});if(z)return i.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:i.jsx("p",{className:"text-teal-600 animate-pulse",children:"Loading Billing Details..."})});if(R)return i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-red-600 p-4",children:[i.jsx(sb,{size:48,className:"mb-4"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Error Loading Billing Details"}),i.jsx("p",{className:"text-sm text-center mb-4",children:R}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"}),i.jsx("button",{onClick:()=>e(-1),className:"mt-2 text-sm text-gray-600 hover:text-teal-700",children:"Go Back"})]});const Z=(T??h)==="paid",ne=async ae=>{var X,W;if((X=n.state)!=null&&X.finalizeQueueAssignment&&r&&u)try{const H={status:"waiting",doctorId:u};(await de(`/api/queue/${r}/status`,{method:"PATCH",body:JSON.stringify(H)})).ok?console.log("Queue assigned successfully after payment."):console.error("Failed to assign queue after payment.")}catch(H){console.error("Error finalizing queue assignment:",H)}(W=n.state)!=null&&W.finalizeQueueAssignment?e("/dashboard",{state:{activeTab:"queue"}}):e(-1)};return i.jsx(ute,{patientId:t,labOrderId:g,queueId:r,doctorId:u,billId:f,initialItems:S??a,billType:P??o,relatedId:q??l,initialStatus:T??h,initialDiscountPercentage:L??d,readOnlyMode:Z,patientInsuranceType:b??void 0,onBillCreated:ne,onBillUpdated:()=>e(-1)})},hte=({patientId:e,labOrderId:n,onBillingSuccess:t,initialItems:r,patientName:a})=>{const[o]=w.useState(r),[l,h]=w.useState(0),[d,u]=w.useState("cash"),[f,g]=w.useState(null),[b,v]=w.useState(!1),S=w.useMemo(()=>{const T=o.reduce((P,I)=>P+I.total,0),E=typeof l=="string"?parseFloat(l)||0:l;return T*(1-E/100)},[o,l]),k=async()=>{if(o.length===0){g("Cannot finalize an empty bill.");return}v(!0),g(null);const T={patientId:e,items:o,amount:S,paymentMode:d,type:"lab",related_id:n,status:"paid",discountPercentage:Number(l)||0,labOrderId:n};try{const E=await de("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)}),P=await E.json();if(!E.ok)throw new Error(P.message||"Failed to create bill.");alert("Bill created successfully!");const I=window.open("","_blank");if(I){const q=`
                    <html>
                        <head>
                            <title>Lab Bill</title>
                            <style>
                                body { font-family: sans-serif; }
                                .bill-container { max-width: 800px; margin: auto; padding: 20px; border: 1px solid #ccc; }
                                .bill-header { text-align: center; margin-bottom: 20px; }
                                .bill-item { display: flex; justify-content: space-between; padding: 5px 0; }
                                .bill-total { text-align: right; margin-top: 20px; font-weight: bold; }
                            </style>
                        </head>
                        <body>
                            <div class="bill-container">
                                <div class="bill-header">
                                    <h2>Lab Bill for ${a}</h2>
                                </div>
                                <div class="bill-items-list">
                                    ${o.map($=>`
                                        <div class="bill-item">
                                            <span>${$.name}</span>
                                            <span>${$.total.toFixed(2)}</span>
                                        </div>
                                    `).join("")}
                                </div>
                                <div class="bill-total">
                                    Total: ${S.toFixed(2)}
                                </div>
                            </div>
                        </body>
                    </html>
                `;I.document.write(q),I.document.close(),I.print()}t()}catch(E){g(`Failed to process bill: ${E.message}`)}finally{v(!1)}};return i.jsxs("div",{className:"billing-layout",children:[i.jsx("main",{className:"order-content",children:i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Lab Tests"})}),o.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"PRICE"})]})}),i.jsx("tbody",{children:o.map((T,E)=>i.jsxs("tr",{children:[i.jsx("td",{children:E+1}),i.jsx("td",{children:T.name}),i.jsx("td",{children:T.total.toFixed(2)})]},E))})]}):i.jsx("p",{children:"No lab tests in this order."})]})}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",o.reduce((T,E)=>T+E.total,0).toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:l,onChange:T=>h(T.target.value),onBlur:T=>{T.target.value===""&&h(0)},min:"0",max:"100",className:"discount-input-total",disabled:b}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",S.toFixed(2)]})]}),f&&i.jsx("p",{className:"error-message",style:{color:"red",textAlign:"center"},children:f}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:d,onChange:T=>u(T.target.value),className:"payment-mode-select",disabled:b,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsx("div",{className:"bill-actions",children:i.jsx("button",{onClick:k,className:"primary-button",disabled:b||o.length===0,children:b?"Processing...":"Finalise and Bill"})})]})})]})},fte=()=>{const e=Ot(),n=Cr(),{labOrderId:t}=n.state||{},[r,a]=w.useState(null),[o,l]=w.useState(""),[h,d]=w.useState(null),[u,f]=w.useState(null),[g,b]=w.useState(null),[v,S]=w.useState(!0),[k,T]=w.useState(null);w.useEffect(()=>{if(!t){console.error("LabBillingPage loaded without a labOrderId."),e("/");return}(async()=>{S(!0),T(null);try{const I=await de(`/api/lab/${t}`);if(!I.ok){const L=await I.json().catch(()=>({}));throw new Error(L.message||`Failed to fetch lab order details (Status: ${I.status})`)}const q=await I.json(),$=(q.tests||[]).filter(L=>L&&typeof L.name=="string"&&L.price!==void 0&&L.id!==void 0).map(L=>{const F=parseFloat(L.price||"0"),z=!isNaN(F)&&isFinite(F)?F:0;return{drug_id:L.id,name:L.name,price:z,quantity:1,total:z,type:"lab_test"}});if(b($),q.patient_id){a(q.patient_id);const L=await de(`/api/patients/${q.patient_id}`);if(L.ok){const F=await L.json();l(F.name),d(F.phone??null),f(F.insurance_type??null)}else l("Patient (Not Found)")}else throw new Error("Lab order does not have an associated patient.")}catch(I){console.error("Error fetching lab billing details:",I),T(`Failed to load details: ${I.message}`)}finally{S(!1)}})()},[t,e]);const E=()=>{console.log(`Lab billing process completed for Lab Order ID: ${t}`),e(-1)};return t?v?i.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:i.jsx("p",{className:"text-teal-600 animate-pulse",children:"Loading Lab Bill..."})}):k?i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-red-600 p-4",children:[i.jsx(sb,{size:48,className:"mb-4"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Error Loading Lab Bill"}),i.jsx("p",{className:"text-sm text-center mb-4",children:k}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"}),i.jsx("button",{onClick:()=>e(-1),className:"mt-2 text-sm text-gray-600 hover:text-teal-700",children:"Go Back"})]}):i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(on,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Lab Bill"})]}),i.jsx("div",{className:"billing-layout",children:i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Patient Name:"})," ",o]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Phone:"})," ",h||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Lab Order ID:"})," ",t]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Insurance:"})," ",u?u.replace(/_/g," "):"N/A"]})]})]}),r&&g&&i.jsx(hte,{patientId:r,labOrderId:t,onBillingSuccess:E,initialItems:g,patientInsuranceType:u,patientName:o})]})})]})}):i.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-gray-600",children:[i.jsx(sb,{size:48,className:"mb-4 text-red-500"}),i.jsx("p",{className:"text-lg font-medium mb-2",children:"Missing Lab Order Information"}),i.jsx("p",{className:"text-sm",children:"Cannot load the lab billing page without a lab order ID."}),i.jsx("button",{onClick:()=>e("/"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Go to Dashboard"})]})},pte=()=>{const{patientId:e}=Yr(),n=Ot(),[t,r]=w.useState([]),[a,o]=w.useState(!1),[l,h]=w.useState(null),[d,u]=w.useState("");return w.useEffect(()=>{(async()=>{if(!e){h("Patient ID not provided in URL.");return}o(!0),h(null),r([]);try{try{const v=await de(`/api/patients/${e}`);if(v.ok){const S=await v.json();u(S.name)}}catch(v){console.warn("Could not fetch patient name:",v)}console.log(`Fetching pharmacy orders for patient ID: ${e}`);const g=await de(`/api/pharmacy-orders/patient/${e}`);if(!g.ok){const v=await g.json().catch(()=>({}));throw new Error(v.message||`HTTP error! status: ${g.status}`)}const b=await g.json();console.log("Fetched Pharmacy Orders:",b),r(b||[])}catch(g){console.error("Error fetching pharmacy orders:",g),h(`Failed to load pharmacy orders: ${g.message}`)}finally{o(!1)}})()},[e]),i.jsxs("div",{className:"p-4 md:p-6 max-w-4xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6 border-b pb-3",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-900",children:[i.jsx(on,{size:16,className:"mr-1"}),"Back"]}),i.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[i.jsx(ho,{size:20,className:"mr-2 text-purple-600"}),"Pharmacy Order History ",d&&`for ${d}`]}),i.jsx("div",{})," "]}),a&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading pharmacy orders..."}),l&&i.jsx("p",{className:"text-center text-red-500 bg-red-100 p-3 rounded border border-red-300",children:l}),!a&&t.length===0&&!l&&i.jsx("p",{className:"text-center text-gray-500",children:"No pharmacy orders found for this patient."}),!a&&t.length>0&&i.jsx("div",{className:"space-y-4",children:t.map(f=>i.jsxs("div",{className:"p-4 border rounded bg-white shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Date:"})," ",new Date(f.date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm font-medium capitalize",children:[i.jsx("strong",{children:"Status:"})," ",f.status]})]}),i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Prescribed By:"})," ",f.prescribedBy||"N/A"]}),f.dispensedBy&&i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Dispensed By:"})," ",f.dispensedBy]}),i.jsx("h4",{className:"text-md font-semibold mt-3 mb-1",children:"Medications:"}),i.jsx("ul",{className:"list-disc list-inside ml-4 text-sm text-gray-700 space-y-1",children:f.medications.map((g,b)=>i.jsxs("li",{children:[g.name," - Qty: ",g.quantity,g.tabletsPerDay&&` (${g.tabletsPerDay} per day`,g.numberOfDays&&` for ${g.numberOfDays} days)`,!g.tabletsPerDay&&g.numberOfDays&&` (for ${g.numberOfDays} days)`,g.tabletsPerDay&&!g.numberOfDays&&")"]},b))})]},f.id))})]})},oC=()=>{const e=Ot(),n=Cr(),[t,r]=w.useState(null),[a,o]=w.useState([]),[l,h]=w.useState([]),[d,u]=w.useState(""),[f,g]=w.useState([]),[b,v]=w.useState(null),[S,k]=w.useState(!1),[T,E]=w.useState(null),[P,I]=w.useState(!0),[q,$]=w.useState(""),[L,F]=w.useState([]),[z,B]=w.useState(!1),[R,U]=w.useState(null),[Y,Z]=w.useState(!1),[ne,ae]=w.useState(!1),[X,W]=w.useState([]),H=/^\+?[0-9\s\-().]{7,20}$/,he=/^[a-zA-Z\s'-]{2,}$/,D=w.useCallback(async()=>{try{const Se=await de("/api/drugs");if(!Se.ok)throw new Error("Failed to fetch drugs");const qe=await Se.json();o(qe)}catch(Se){console.error("Failed to fetch available drugs:",Se),v("Could not load drug list. "+Se.message)}},[]),te=w.useCallback(async Se=>{try{const qe=await de(`/api/pharmacy-orders/patient/${Se}`);if(!qe.ok){const ze=await qe.json().catch(()=>({}));throw new Error(ze.message||`HTTP error! status: ${qe.status}`)}const Ue=await qe.json();W(Ue||[])}catch(qe){console.error("Failed to fetch previous pharmacy orders:",qe)}finally{}},[]);w.useEffect(()=>{var Se;D(),(Se=n.state)!=null&&Se.patient?ge(n.state.patient):I(!0)},[D,n.state]),w.useEffect(()=>{t!=null&&t.id?te(t.id):W([])},[t,te]),w.useEffect(()=>{if(!d){g([]);return}const Se=d.toLowerCase();g(a.filter(qe=>{const Ue=qe.name&&qe.name.toLowerCase().includes(Se),ze=qe.brand_name&&qe.brand_name.toLowerCase().includes(Se);return Ue||ze}).slice(0,10))},[d,a]);const ve=w.useMemo(()=>qb(async Se=>{if(Se.trim().length<2){F([]),B(!1),U(null);return}B(!0),U(null);try{const qe=new URLSearchParams({search:encodeURIComponent(Se),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Ue=await de(`/api/patients?${qe.toString()}`);if(!Ue.ok)throw new Error("API Error");const ze=await Ue.json();F(ze.patients)}catch(qe){console.error("Error searching patients:",qe),U(qe.message||"Failed to search patients."),F([])}finally{B(!1)}},300),[H]),M=Se=>{const qe=Se.target.value;$(qe),Z(H.test(qe)),ae(he.test(qe)&&!H.test(qe)),B(!0),ve(qe)},ge=w.useCallback(Se=>{r(Se),I(!1),$(""),F([]),U(null)},[]),_e=w.useCallback(async Se=>{if(!q||Se==="phone"&&!Y||Se==="name"&&!ne){U(`Invalid ${Se} to create a new patient.`);return}B(!0),U(null);try{const ze=await(await de("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Se==="name"?q:"direct pharmacy",phone:Se==="phone"?q:null,age:null,gender:null,token:null})})).json();ge(ze)}catch(qe){const Ue=qe.message||"";if(Ue.toLowerCase().includes("patient limit")){e("/start-clinic-subscription",{state:{errorMessage:Ue}});return}U(Ue||"Failed to create new patient.")}finally{B(!1)}},[q,Y,ne,ge]),se=()=>{r(null),I(!0),h([]),v(null),W([])},ee=Se=>{if(!Se)return null;const qe=Se.match(/(?:\d+x)?(\d+)/);return qe?parseInt(qe[1],10):null},oe=Se=>{if(l.some(qe=>qe.drug_id===Se.id)){v(`${Se.name||Se.brand_name} is already in the order.`),setTimeout(()=>v(null),3e3),u(""),g([]);return}h(qe=>[...qe,{drug_id:Se.id,name:Se.name||Se.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,tabletsPerDay:1,numberOfDays:1,price:Number(Se.price)||0,originalPrice:Number(Se.price)||0,stock:Se.quantity_in_stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(Se.price)||0)/(ee(Se.unit)||1),unit:Se.unit}]),u(""),g([])},ue=()=>{const Se=d.trim();Se&&e("/dashboard/inventory/add",{state:{initialDrugName:Se}})},Ee=Se=>{h(qe=>qe.filter(Ue=>(Ue.drug_id??Ue.name)!==Se))},Ie=(Se,qe)=>{h(Ue=>Ue.map(ze=>{if((ze.drug_id??ze.name)===Se&&ze.isLoose){const lt=ee(ze.unit),Ke=parseInt(qe,10),pt=isNaN(Ke)?qe:Math.max(0,Ke),Te=(isNaN(Ke)?0:pt)*(lt??1)+(Number(ze.looseUnits)||0);return{...ze,loosePacks:pt,looseQuantity:Te}}return ze}))},fe=Se=>{h(qe=>qe.map(Ue=>(Ue.drug_id??Ue.name)===Se&&Ue.loosePacks===""?{...Ue,loosePacks:0}:Ue))},pe=(Se,qe)=>{h(Ue=>Ue.map(ze=>{if((ze.drug_id??ze.name)===Se&&ze.isLoose){const lt=ee(ze.unit),Ke=parseInt(qe,10),pt=isNaN(Ke)?qe:Math.max(0,Ke),Te=(Number(ze.loosePacks)||0)*(lt??1)+(isNaN(Ke)?0:pt);return{...ze,looseUnits:pt,looseQuantity:Te}}return ze}))},Re=Se=>{h(qe=>qe.map(Ue=>(Ue.drug_id??Ue.name)===Se&&Ue.looseUnits===""?{...Ue,looseUnits:0}:Ue))},Ye=Se=>{const qe=[];Se.medications.forEach(Ue=>{if(!l.find(lt=>lt.drug_id&&Ue.drug_id&&lt.drug_id===Ue.drug_id||lt.name.toLowerCase()===Ue.name.toLowerCase())){let lt=Ue.drug_id,Ke=Ue.drug_id?a.find(pt=>pt.id===Ue.drug_id):void 0;if(!Ke&&Ue.name){const pt=a.find(Te=>Te.name&&Te.name.toLowerCase()===Ue.name.toLowerCase());pt?(lt=pt.id,Ke=pt):lt&&(lt=null)}qe.push({drug_id:lt,name:Ue.name,pack_quantity:Ue.pack_quantity??0,loose_quantity:Ue.loose_quantity??0,directions_to_use:Ue.directions_to_use,tabletsPerDay:Ue.tabletsPerDay??1,numberOfDays:Ue.numberOfDays??1,price:Ke?Ke.price:Ue.price,stock:Ke?Ke.quantity_in_stock:Ue.stock,isLoose:!0,loosePacks:0,looseUnits:(Ue.pack_quantity??0)*(ee((Ke==null?void 0:Ke.unit)||Ue.unit)??1)+(Ue.loose_quantity??0),looseQuantity:(Ue.pack_quantity??0)*(ee((Ke==null?void 0:Ke.unit)||Ue.unit)??1)+(Ue.loose_quantity??0),pricePerLooseUnit:(Ke?Number(Ke.price):Number(Ue.price)||0)/(ee((Ke==null?void 0:Ke.unit)||Ue.unit)||1),unit:(Ke==null?void 0:Ke.unit)||Ue.unit})}}),h(Ue=>[...Ue,...qe]),Se.prescriptionForUnavailableDrugs&&(!T||!T.includes(Se.prescriptionForUnavailableDrugs))&&E(Ue=>Ue?`${Ue}

-- From previous order --
${Se.prescriptionForUnavailableDrugs}`:Se.prescriptionForUnavailableDrugs),v("Medications from previous order added."),setTimeout(()=>v(null),3e3)},ut=async Se=>{if(Se.preventDefault(),v(null),k(!0),!t){v("No patient selected."),k(!1);return}if(l.length===0&&!(T!=null&&T.trim())){v("Add medication or prescription notes."),k(!1);return}const qe={patient_id:t.id,items:l.map(Ue=>{const ze=Number(Ue.price??0),lt=Number(Ue.pricePerLooseUnit??0),Ke=Number((lt*(Ue.looseQuantity??0)).toFixed(2));return{drug_id:Ue.drug_id||null,name:Ue.name,pack_quantity:Number(Ue.loosePacks)||0,loose_quantity:Number(Ue.looseUnits)||0,pack_price:ze,loose_price:lt,total_price:Ke,price:Number(Ue.originalPrice??0),directions_to_use:Ue.directions_to_use??null,tabletsPerDay:Number(Ue.tabletsPerDay??1),numberOfDays:Number(Ue.numberOfDays??1)}}),order_total:Ge,prescription_for_unavailable_drugs:T};try{const Ue=await de("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(qe)});if(!Ue.ok)throw new Error("Order creation failed");await Ue.json(),alert(`Order created successfully for ${t.name}!`);let ze=t.queueId;if(!ze)try{const lt=await de(`/api/queue/patient/${t.id}/latest`);if(lt.ok){const Ke=await lt.json();Ke!=null&&Ke._id&&(ze=Ke._id)}}catch(lt){console.error("Error checking queue:",lt)}if(!ze)try{const lt=await de("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:t.id})});if(lt.ok){const Ke=await lt.json();Ke!=null&&Ke.id&&(ze=Ke.id)}}catch(lt){console.error("Error creating queue:",lt)}ze?e(`/dashboard/edit-complaint/${ze}`,{state:{patientId:t.id}}):e(-1)}catch(Ue){v(Ue.message||"Failed to create order.")}finally{k(!1)}},Ge=w.useMemo(()=>l.reduce((Se,qe)=>{const Ue=qe.isLoose?qe.pricePerLooseUnit??0:qe.price??0,ze=qe.isLoose?qe.looseQuantity??0:qe.quantity??0;return Se+Ue*ze},0),[l]);return i.jsxs("div",{className:"add-pharmacy-order-page p-4 md:p-8 max-w-7xl mx-auto",children:[i.jsx("div",{className:"page-header",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:i.jsx(on,{size:20})}),i.jsx("h2",{children:"Create Pharmacy Order"})]})}),b&&i.jsxs("div",{className:"bg-red-900/20 border border-red-500/50 text-red-200 p-4 rounded-xl mb-6 flex items-start gap-3 animate-fade-in",children:[i.jsx(ui,{className:"shrink-0 mt-0.5",size:18}),i.jsx("span",{children:b})]}),P&&i.jsx("div",{className:"max-w-2xl mx-auto mt-10",children:i.jsxs("div",{className:"content-panel",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(fl,{size:20,className:"text-indigo-400"})," Select Patient"]}),i.jsxs("div",{className:"patient-search-container",children:[i.jsxs("div",{className:"pharmacy-search-bar",children:[i.jsx(Ai,{className:"search-icon",size:20}),i.jsx("input",{type:"text",placeholder:"Search by Name, Token # or Phone...",value:q,onChange:M,className:"pharmacy-search-input",autoFocus:!0}),z&&i.jsx("div",{className:"pr-4 text-xs text-indigo-400 animate-pulse",children:"Searching..."})]}),R&&i.jsx("p",{className:"text-red-400 text-sm mt-2 pl-1 animate-fadeIn",children:R}),L.length>0&&i.jsx("div",{className:"search-results-dropdown",children:L.map(Se=>i.jsxs("div",{onClick:()=>ge(Se),className:"search-result-item",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsxs("span",{className:"text-white font-medium flex items-center",children:[i.jsxs("span",{className:"token-badge",children:["#",Se.token]}),Se.name]}),i.jsxs("span",{className:"text-xs text-gray-400 mt-1 pl-1",children:[Se.gender,"  ",Se.age," yrs  ",Se.phone||"No phone"]})]}),i.jsx(ab,{size:16,className:"text-gray-600 -rotate-90"})]},Se.id))}),!z&&q.length>2&&L.length===0&&i.jsxs("div",{className:"mt-4 p-4 bg-zinc-800/50 rounded-lg text-center border border-dashed border-zinc-700",children:[i.jsxs("p",{className:"text-gray-400 mb-3 text-sm",children:['No patient found matching "',q,'"']}),i.jsxs("div",{className:"flex justify-center gap-3",children:[Y&&i.jsx("button",{onClick:()=>_e("phone"),className:"px-4 py-2 bg-green-600/20 text-green-400 border border-green-600/50 rounded-lg text-sm hover:bg-green-600/30 transition-colors",children:"Create with Phone"}),ne&&i.jsx("button",{onClick:()=>_e("name"),className:"px-4 py-2 bg-indigo-600/20 text-indigo-400 border border-indigo-600/50 rounded-lg text-sm hover:bg-indigo-600/30 transition-colors",children:"Create with Name"})]})]})]})]})}),!P&&t&&i.jsxs("form",{onSubmit:ut,className:"pharmacy-order-grid animate-fade-in",children:[i.jsxs("div",{className:"order-main-column",children:[i.jsxs("div",{className:"content-panel mb-6",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(Ai,{size:18,className:"text-indigo-400"})," Add Medication"]}),i.jsxs("div",{className:"relative drug-search-container",children:[i.jsxs("div",{className:"pharmacy-search-bar",children:[i.jsx(Ai,{className:"search-icon",size:18}),i.jsx("input",{type:"text",placeholder:"Search for drugs...",value:d,onChange:Se=>u(Se.target.value),className:"pharmacy-search-input"})]}),f.length>0&&i.jsx("div",{className:"search-results-dropdown",children:f.map(Se=>i.jsx("div",{onClick:()=>oe(Se),className:"search-result-item",children:i.jsxs("div",{className:"flex justify-between w-full",children:[i.jsxs("div",{children:[i.jsx("span",{className:"drug-name",children:Se.name||Se.brand_name}),i.jsxs("span",{className:"drug-meta text-xs",children:["Stock: ",Se.quantity_in_stock]})]}),i.jsx("div",{className:"text-right",children:i.jsxs("span",{className:"text-indigo-300 font-mono",children:["",Number(Se.price).toFixed(2)]})})]})},Se.id))}),d&&f.length===0&&!a.find(Se=>{var qe;return((qe=Se.name)==null?void 0:qe.toLowerCase())===d.toLowerCase()})&&i.jsx("div",{className:"search-results-dropdown p-2",children:i.jsxs("button",{type:"button",onClick:ue,className:"w-full text-left px-4 py-2 text-indigo-400 hover:bg-zinc-800 rounded-lg text-sm transition-colors",children:['+ Add "',d,'" to Inventory']})})]})]}),i.jsxs("div",{className:"content-panel min-h-[400px]",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(go,{size:18,className:"text-indigo-400"})," Order Items (",l.length,")"]}),l.length===0?i.jsxs("div",{className:"empty-state",children:[i.jsx(go,{size:48,className:"empty-icon mx-auto",strokeWidth:1}),i.jsx("p",{className:"empty-text",children:"No medications added yet"}),i.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Search above to add items to the order"})]}):i.jsx("div",{className:"order-table-container",children:i.jsxs("table",{className:"order-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{width:"30%"},children:"Drug Name"}),i.jsx("th",{children:"Dosage / Directions"}),i.jsx("th",{children:"Qty (Packs/Loose)"}),i.jsx("th",{children:"Price"}),i.jsx("th",{})]})}),i.jsx("tbody",{children:l.map((Se,qe)=>{const Ue=Se.drug_id??Se.name,ze=(Se.pricePerLooseUnit??0)*(Se.looseQuantity??0);return i.jsxs("tr",{className:"group",children:[i.jsxs("td",{children:[i.jsx("span",{className:"drug-name",children:Se.name}),i.jsxs("span",{className:"drug-meta",children:["Stock: ",Se.stock,"  Box of ",ee(Se.unit)||1]})]}),i.jsx("td",{children:i.jsx("div",{className:"flex flex-col gap-2",children:i.jsx("input",{type:"text",placeholder:"Directions...",value:Se.directions_to_use||"",onChange:lt=>{const Ke=lt.target.value;h(pt=>pt.map(Te=>(Te.drug_id??Te.name)===Ue?{...Te,directions_to_use:Ke}:Te))},className:"table-input w-full"})})}),i.jsx("td",{children:i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("div",{className:"qty-input-group",children:[i.jsx("span",{className:"text-xs text-gray-500 w-8",children:"Pks:"}),i.jsx("input",{type:"number",min:"0",value:Se.loosePacks,onChange:lt=>Ie(Ue,lt.target.value),onBlur:()=>fe(Ue),className:"table-input medium"})]}),i.jsxs("div",{className:"qty-input-group",children:[i.jsx("span",{className:"text-xs text-gray-500 w-8",children:"Unit:"}),i.jsx("input",{type:"number",min:"0",value:Se.looseUnits,onChange:lt=>pe(Ue,lt.target.value),onBlur:()=>Re(Ue),className:"table-input medium"})]})]})}),i.jsx("td",{children:i.jsxs("div",{className:"font-mono text-sm",children:["",ze.toFixed(2)]})}),i.jsx("td",{children:i.jsx("button",{type:"button",onClick:()=>Ee(Ue),className:"delete-btn opacity-0 group-hover:opacity-100",title:"Remove Item",children:i.jsx(Hi,{size:16})})})]},`${Ue}-${qe}`)})})]})})]}),i.jsxs("div",{className:"content-panel",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(ns,{size:18,className:"text-indigo-400"})," Additional Notes / Prescription"]}),i.jsx("textarea",{value:T??"",onChange:Se=>E(Se.target.value||null),placeholder:"Enter notes for unavailable drugs or special instructions...",className:"custom-text-input bg-zinc-900/50 min-h-[100px] border border-zinc-800 rounded-lg resize-y"})]})]}),i.jsxs("div",{className:"order-sidebar",children:[i.jsxs("div",{className:"patient-card mb-6",children:[i.jsx("div",{className:"patient-avatar",children:t.name.charAt(0).toUpperCase()}),i.jsx("h3",{className:"patient-name",children:t.name}),i.jsx("div",{className:"patient-meta",children:i.jsxs("span",{children:["Token: #",t.token]})}),i.jsxs("div",{className:"patient-detail-grid",children:[i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Age / Gender"}),i.jsxs("p",{children:[t.age||"--"," / ",t.gender||"--"]})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Phone"}),i.jsx("p",{children:t.phone||"--"})]})]}),i.jsx("button",{type:"button",onClick:se,className:"change-patient-btn",children:"Change Patient"})]}),X.length>0&&i.jsxs("div",{className:"content-panel mb-6 p-4",children:[i.jsxs("div",{className:"section-title text-sm mb-3",children:[i.jsx(yI,{size:16,className:"text-indigo-400"})," Recent Orders"]}),i.jsx("div",{className:"max-h-[200px] overflow-y-auto pr-1 custom-scrollbar",children:X.map(Se=>i.jsxs("div",{className:`prev-order-item status-${Se.status}`,children:[i.jsxs("div",{className:"prev-order-header",children:[i.jsx("span",{className:"prev-order-date",children:new Date(Se.date).toLocaleDateString()}),i.jsx("span",{className:`status-badge ${Se.status}`,children:Se.status})]}),i.jsx("div",{className:"text-xs text-gray-500 mb-2 truncate",children:Se.medications.map(qe=>qe.name).join(", ")}),i.jsx("button",{type:"button",onClick:()=>Ye(Se),className:"add-prev-btn",children:"+ Add items"})]},Se.id))})]}),i.jsxs("div",{className:"content-panel order-summary-container",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(Ld,{size:18,className:"text-indigo-400"})," Summary"]}),i.jsx("div",{className:"summary-details",children:i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Items"}),i.jsx("span",{children:l.length})]})}),i.jsxs("div",{className:"summary-total",children:[i.jsx("span",{className:"total-label",children:"Grand Total"}),i.jsxs("span",{className:"total-value",children:["",Ge.toFixed(2)]})]}),i.jsxs("button",{type:"submit",disabled:S||l.length===0&&!T,className:"create-order-btn",children:[S?i.jsx("div",{className:"spinner"}):i.jsx(Ds,{size:20}),S?"Processing...":"Create Order"]})]})]})]})]})},PT=()=>{const{orderId:e}=Yr(),n=Ot(),[t,r]=w.useState(null),[a,o]=w.useState(null),[l,h]=w.useState([]),[d,u]=w.useState([]),[f,g]=w.useState(""),[b,v]=w.useState([]),[S,k]=w.useState(null),[T,E]=w.useState(!1),[P,I]=w.useState(null),[q,$]=w.useState(!0),L=H=>{if(!H)return null;const he=H.match(/(?:\d+x)?(\d+)/);return he?parseInt(he[1],10):null},F=w.useCallback(async()=>{$(!0);try{const H=await de(`/api/pharmacy-orders/${e}`);if(!H.ok)throw new Error("Failed to fetch order details");const he=await H.json();r(he),o({id:he.patientId,name:he.patientName||"N/A",token:he.patientTokenNumber}),I(he.prescriptionForUnavailableDrugs);const D=he.medications.map(te=>{const ve=L(te.unit),M=te.pack_quantity*(ve??1)+te.loose_quantity;return{...te,isLoose:!0,loosePacks:te.pack_quantity,looseUnits:te.loose_quantity,looseQuantity:M,pack_price:te.pack_price,loose_price:te.loose_price,total_price:te.total_price,pricePerLooseUnit:te.loose_price,originalPrice:te.pack_price,box_number:te.box_number,unit:te.unit,batch:te.batch,expiry_date:te.expiry_date,discount_percentage:te.discount_percentage}});u(D)}catch(H){k("Could not load order details. "+H.message)}finally{$(!1)}},[e]),z=w.useCallback(async()=>{try{const H=await de("/api/drugs");if(!H.ok)throw new Error("Failed to fetch drugs");const he=await H.json();h(he)}catch(H){k("Could not load drug list. "+H.message)}},[]);w.useEffect(()=>{F(),z()},[F,z]),w.useEffect(()=>{if(!f){v([]);return}const H=f.toLowerCase();v(l.filter(he=>{const D=he.name&&he.name.toLowerCase().includes(H),te=he.brand_name&&he.brand_name.toLowerCase().includes(H);return D||te}).slice(0,10))},[f,l]);const B=H=>{if(d.some(he=>he.drug_id===H.id)){k(`${H.name||H.brand_name} is already in the order.`),setTimeout(()=>k(null),3e3),g(""),v([]);return}u(he=>[...he,{drug_id:H.id,name:H.name||H.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,pack_price:Number(H.price)||0,loose_price:(Number(H.price)||0)/(L(H.unit)||1),total_price:(Number(H.price)||0)/(L(H.unit)||1),discount_percentage:0,directions_to_use:"",tabletsPerDay:1,numberOfDays:1,stock:H.quantity_in_stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(H.price)||0)/(L(H.unit)||1),originalPrice:Number(H.price)||0,unit:H.unit}]),g(""),v([])},R=H=>{u(he=>he.filter(D=>(D.drug_id??D.name)!==H))},U=(H,he)=>{u(D=>D.map(te=>{if((te.drug_id??te.name)===H&&te.isLoose){const ve=L(te.unit),M=parseInt(he,10),ge=isNaN(M)?he:Math.max(0,M),_e=(isNaN(M)?0:ge)*(ve??1)+(Number(te.looseUnits)||0);return{...te,loosePacks:ge,looseQuantity:_e,pack_quantity:isNaN(M)?0:ge}}return te}))},Y=H=>{u(he=>he.map(D=>(D.drug_id??D.name)===H&&D.loosePacks===""?{...D,loosePacks:0}:D))},Z=(H,he)=>{u(D=>D.map(te=>{if((te.drug_id??te.name)===H&&te.isLoose){const ve=L(te.unit),M=parseInt(he,10),ge=isNaN(M)?he:Math.max(0,M),_e=(Number(te.loosePacks)||0)*(ve??1)+(isNaN(M)?0:ge);return{...te,looseUnits:ge,looseQuantity:_e,loose_quantity:isNaN(M)?0:ge}}return te}))},ne=H=>{u(he=>he.map(D=>(D.drug_id??D.name)===H&&D.looseUnits===""?{...D,looseUnits:0}:D))},ae=w.useMemo(()=>d.reduce((H,he)=>{const D=he.loose_price??0,te=he.looseQuantity??0;return H+D*te},0),[d]),X=(Number(ae)||0).toFixed(2),W=async H=>{if(H.preventDefault(),k(null),E(!0),d.length===0&&!(P!=null&&P.trim())){k("Please add at least one medication or provide a prescription."),E(!1);return}const he={items:d.map(D=>({drug_id:D.drug_id??null,name:D.name,pack_quantity:Number(D.loosePacks)||0,loose_quantity:Number(D.looseUnits)||0,pack_price:D.pack_price??0,loose_price:D.loose_price??0,total_price:(D.loose_price??0)*(D.looseQuantity??0),discount_percentage:D.discount_percentage??0,directions_to_use:D.directions_to_use??null,tabletsPerDay:D.tabletsPerDay??1,numberOfDays:D.numberOfDays??1})),prescription_for_unavailable_drugs:P,order_total:ae};try{if(!(await de(`/api/pharmacy-orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(he)})).ok)throw new Error("Failed to update order");alert("Pharmacy order updated successfully!"),n(-1)}catch(D){k(D.message||"Failed to update order.")}finally{E(!1)}};return q?i.jsx("div",{className:"add-pharmacy-order-page flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"spinner mb-4 mx-auto"}),i.jsx("p",{className:"text-gray-400 animate-pulse",children:"Loading order details..."})]})}):t?i.jsxs("div",{className:"add-pharmacy-order-page max-w-7xl mx-auto",children:[i.jsx("div",{className:"page-header px-2 md:px-4",children:i.jsxs("div",{className:"flex items-center justify-between w-full",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>n(-1),className:"back-button",title:"Go Back",children:i.jsx(on,{size:20})}),i.jsxs("div",{className:"flex flex-col",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("h2",{className:"m-0 bg-transparent -webkit-text-fill-color-current text-indigo-500 font-bold text-lg md:text-xl",children:"Edit Order"}),i.jsx("span",{className:"text-gray-400 font-light px-2 hidden md:block",children:"|"}),i.jsxs("div",{className:"header-patient-info flex items-center gap-2",children:[i.jsx("span",{className:"text-slate-800 dark:text-gray-200 font-bold text-lg md:text-xl",children:a==null?void 0:a.name}),i.jsxs("span",{className:"bg-indigo-500/10 text-indigo-400 px-2.5 py-0.5 rounded-full font-bold text-xs",children:["#",(a==null?void 0:a.token)||"N/A"]})]})]}),i.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[i.jsx(Bf,{size:12,className:"text-gray-500"}),i.jsxs("span",{className:"text-xs text-gray-500",children:["Order Date: ",new Date(t.date).toLocaleDateString(void 0,{day:"numeric",month:"short",year:"numeric"})]})]})]})]}),i.jsx("div",{className:"flex items-center gap-3",children:i.jsx("span",{className:`status-badge ${t.status}`,children:t.status})})]})}),i.jsxs("form",{onSubmit:W,className:"pharmacy-order-grid animate-fade-in px-2 md:px-4",children:[i.jsxs("div",{className:"order-main-column",children:[i.jsxs("div",{className:"content-panel search-panel mb-4",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(Ai,{size:20,className:"text-indigo-400"}),i.jsx("span",{children:"Find & Add Medication"})]}),i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"pharmacy-search-bar",children:[i.jsx(Ai,{className:"search-icon",size:20}),i.jsx("input",{type:"text",placeholder:"Search by name or brand...",value:f,onChange:H=>g(H.target.value),className:"pharmacy-search-input"})]}),b.length>0&&i.jsx("div",{className:"search-results-dropdown",children:b.map(H=>i.jsxs("div",{onClick:()=>B(H),className:"search-result-item",children:[i.jsxs("div",{children:[i.jsx("div",{className:"drug-name-result",children:H.name||H.brand_name}),i.jsxs("div",{className:"drug-stock-result flex items-center gap-1",children:[i.jsx(ho,{size:12})," Stock: ",H.quantity_in_stock]})]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("div",{className:"text-indigo-400 font-bold",children:["",Number(H.price).toFixed(2)]}),i.jsx("div",{className:"text-[10px] text-gray-500 uppercase tracking-tighter",children:"per unit"})]})]},H.id))})]})]}),i.jsxs("div",{className:"content-panel min-h-[250px]",children:[i.jsx("div",{className:"section-title flex justify-between items-center",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(go,{size:20,className:"text-indigo-400"}),i.jsx("span",{children:"Medications in Order"}),i.jsxs("span",{className:"bg-indigo-500/10 text-indigo-400 text-xs px-2 py-0.5 rounded-full ml-2",children:[d.length," items"]})]})}),d.length===0?i.jsxs("div",{className:"empty-state",children:[i.jsx("div",{className:"p-6 bg-indigo-500/5 rounded-full mb-4",children:i.jsx(go,{size:48,className:"empty-icon",strokeWidth:1})}),i.jsx("p",{className:"empty-text",children:"No medications added yet"}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Search and add drugs from the panel above"})]}):i.jsx("div",{className:"order-table-container",children:i.jsxs("table",{className:"order-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{width:"35%"},children:"Medication"}),i.jsx("th",{style:{width:"25%"},children:i.jsx("div",{className:"flex items-center gap-1",children:"Directions"})}),i.jsx("th",{style:{width:"25%"},children:i.jsx("div",{className:"flex items-center gap-1",children:"Quantity"})}),i.jsx("th",{style:{width:"10%"},children:"Subtotal"}),i.jsx("th",{style:{width:"5%"}})]})}),i.jsx("tbody",{children:d.map((H,he)=>{const D=H.drug_id??H.name,te=(H.loose_price??0)*(H.looseQuantity??0);return i.jsxs("tr",{className:"group",children:[i.jsx("td",{children:i.jsxs("div",{className:"drug-info-cell",children:[i.jsx("span",{className:"drug-name",children:H.name}),i.jsxs("div",{className:"drug-meta",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(ho,{size:12})," Stock: ",H.stock]}),i.jsx("span",{className:"text-gray-600",children:""}),i.jsxs("span",{className:"flex items-center gap-1 text-xs px-1.5 py-0.5 bg-zinc-800 rounded",children:["BOX OF ",L(H.unit)||1]})]})]})}),i.jsx("td",{children:i.jsx("input",{type:"text",placeholder:"e.g. 1-0-1 after food",value:H.directions_to_use||"",onChange:ve=>{const M=ve.target.value;u(ge=>ge.map(_e=>(_e.drug_id??_e.name)===D?{..._e,directions_to_use:M}:_e))},className:"table-input"})}),i.jsx("td",{children:i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("div",{className:"qty-input-group",children:[i.jsx("span",{className:"qty-label",children:"PACKS"}),i.jsx("input",{type:"number",min:"0",value:H.loosePacks,onChange:ve=>U(D,ve.target.value),onBlur:()=>Y(D),className:"table-input"})]}),i.jsxs("div",{className:"qty-input-group",children:[i.jsx("span",{className:"qty-label",children:"UNITS"}),i.jsx("input",{type:"number",min:"0",value:H.looseUnits,onChange:ve=>Z(D,ve.target.value),onBlur:()=>ne(D),className:"table-input"})]})]})}),i.jsx("td",{children:i.jsxs("div",{className:"font-mono font-bold text-indigo-400",children:["",te.toFixed(2)]})}),i.jsx("td",{children:i.jsx("button",{type:"button",onClick:()=>R(D),className:"delete-btn",title:"Remove Item",children:i.jsx(Hi,{size:16})})})]},`${D}-${he}`)})})]})})]})]}),i.jsxs("div",{className:"order-sidebar",children:[i.jsxs("div",{className:"content-panel order-summary-container",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(Ld,{size:20,className:"text-indigo-400"}),i.jsx("span",{children:"Billing Summary"})]}),i.jsxs("div",{className:"summary-details",children:[i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Medications Count"}),i.jsx("span",{className:"text-slate-700 dark:text-gray-200 font-bold",children:d.length})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Tax (Inc.)"}),i.jsx("span",{className:"text-slate-700 dark:text-gray-200",children:"0.00"})]})]}),i.jsxs("div",{className:"summary-total",children:[i.jsx("span",{className:"total-label",children:"Grand Total"}),i.jsxs("span",{className:"total-value",children:["",X]})]}),S&&i.jsxs("div",{className:"p-4 bg-red-500/10 border border-red-500/20 rounded-xl flex items-start gap-3 text-sm text-red-400 animate-pulse mt-4",children:[i.jsx(ui,{size:18,className:"shrink-0"}),i.jsx("span",{children:S})]}),i.jsxs("button",{type:"submit",disabled:T,className:`floating-action-btn w-full mt-4 py-2.5 rounded-lg font-bold flex items-center justify-center gap-2 ${T?"opacity-70 cursor-not-allowed":""}`,style:{position:"relative",bottom:"auto",right:"auto"},children:[T?i.jsx("div",{className:"spinner"}):i.jsx(Ds,{size:22}),T?"Updating Order...":"Confirm Changes"]})]}),i.jsxs("div",{className:"content-panel mt-3",children:[i.jsxs("div",{className:"section-title",children:[i.jsx(As,{size:18,className:"text-indigo-400"}),i.jsx("span",{className:"text-sm",children:"Prescription Notes"})]}),i.jsx("textarea",{rows:3,value:P??"",onChange:H=>I(H.target.value||null),placeholder:"Add notes about unavailable drugs...",className:"table-input w-full resize-none min-h-[80px] text-sm"})]})]})]})]}):i.jsx("div",{className:"add-pharmacy-order-page flex items-center justify-center",children:i.jsxs("div",{className:"content-panel text-center max-w-md",children:[i.jsx(ui,{size:48,className:"text-red-500 mx-auto mb-4"}),i.jsx("h2",{className:"text-xl font-bold mb-2",children:"Order Not Found"}),i.jsx("p",{className:"text-gray-400 mb-6",children:"We couldn't find the pharmacy order you're looking for."}),i.jsx("button",{onClick:()=>n(-1),className:"back-button mx-auto",children:i.jsx(on,{size:20})})]})})},mte="gemini-3-flash-preview";async function gte(){const e=Vf();if(!e)throw new Error("Authentication token not found. Please log in.");try{const t=await(await de("/api/clinics/settings",{headers:{Authorization:`Bearer ${e}`}})).json();if(t.gemini_api_key)return t.gemini_api_key}catch(n){console.warn("Failed to fetch clinic-specific Gemini API key, trying global fallback.",n)}try{const t=await(await de("/api/super-admin-settings/gemini-api-key",{headers:{Authorization:`Bearer ${e}`}})).json();if(t.gemini_api_key)return t.gemini_api_key}catch(n){console.warn("Failed to fetch global Gemini API key.",n)}throw new Error("Gemini API key not found. Please contact your administrator.")}let J0=null;async function yte(){if(!J0){const e=await gte();J0=new Ub({apiKey:e})}return J0}const xte=`You are an expert Pharmacy Inventory Manager. You help the user manage their drug stock, find items, and update details.

**Your Goal:**
Help the user strictly based on the provided inventory data.

**Capabilities:**
1.  **Analyze:** Value of stock, low stock items, expiry dates.
2.  **Navigate:** Filter the list (Low Stock, Expired) or Search.
3.  **Edit:** Update drug details (Price, Stock, Name) using the **Serial Number** (#).

**Tools / Actions:**
To respond, you must output a **JSON object**.

- **Text Response:**
  \`{ "response_type": "text", "content": "Your answer..." }\`

- **Set Filter:** Change the view filter.
  Options: 'all', 'low-stock', 'near-expiry', 'expired'
  \`{ "response_type": "action", "action_name": "set_filter", "parameters": { "filter": "low-stock" } }\`

- **Search Drug:** Type into the search bar.
  \`{ "response_type": "action", "action_name": "search_drug", "parameters": { "query": "Para" } }\`

- **Edit Drug:** Update a drug's details using its **Serial Number**.
  *IMPORTANT:* Use the \`serialNumber\` provided in the data list, NOT the database ID.
  \`{ "response_type": "action", "action_name": "edit_drug", "parameters": { "serialNumber": 5, "updates": { "price": 100, "quantity_in_stock": 50 } } }\`

- **End Analysis:** Stop the loop.
  \`{ "response_type": "action", "action_name": "end_analysis", "content": "Done." }\`

**Important Note on Loops:** 
If you use an action (Filter, Search, Edit), the system will automatically refresh the data and call you again. You do not need to ask the user to wait.

**Response Format:**
ALWAYS return valid JSON code block.
\`\`\`json
{ ... }
\`\`\`
`;async function bte(e){const{query:n,inventoryData:t,currentFilter:r,currentSearch:a,history:o=[]}=e,l=t.map(f=>({"#":f.serialNumber,name:f.name,stock:f.quantity_in_stock,price:f.price,expiry:f.expiry_date,batch:f.batch,loose:f.loose}));let h=`Current Filter: ${r}
`;h+=`Current Search Term: "${a}"
`,h+=`Visible Inventory (${l.length} items): ${JSON.stringify(l)}
`;const d=`User Question: "${n}"

Act on this request.`,u=[{role:"user",parts:[{text:xte}]},...o.map(f=>({role:f.role==="model"?"model":"user",parts:[{text:f.content}]})),{role:"user",parts:[{text:h}]},{role:"user",parts:[{text:d}]}];try{const f=await yte(),g={model:mte,contents:u,config:{responseMimeType:"application/json"}},b=await f.models.generateContentStream(g);let v="";for await(const S of b){const k=S.text;k&&(v+=k)}try{const S=v.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(S)}catch(S){return console.warn("Failed to parse Gemini JSON response:",S),{response_type:"text",content:v}}}catch(f){throw console.error("Pharmacy AI Error:",f),new Error(f.message||"Failed to generate response.")}}const lC=10,vte=3,IT=()=>{const e=Ot(),[n,t]=w.useState([]),[r,a]=w.useState([]),[o,l]=w.useState(""),[h,d]=w.useState(!0),[u,f]=w.useState(null),[g,b]=w.useState(new Set),[v,S]=w.useState("all"),[k,T]=w.useState(1),[E]=w.useState(15),P=async()=>{try{const be=await de("/api/inventory/download-csv");if(!be.ok)throw new Error(`Failed to download CSV: ${be.statusText}`);const nt=await be.blob(),Ze=window.URL.createObjectURL(nt),Pt=document.createElement("a");Pt.href=Ze,Pt.download="pharmacy_inventory.csv",document.body.appendChild(Pt),Pt.click(),Pt.remove(),window.URL.revokeObjectURL(Ze)}catch(be){console.error("Failed to download CSV:",be),f(be.message||"Failed to download inventory CSV. Please try again.")}},[I,q]=w.useState(!1),[$,L]=w.useState(!1),[F,z]=w.useState(null),[B,R]=w.useState(!1),[U,Y]=w.useState(new Set),[Z,ne]=w.useState(null),[ae,X]=w.useState(0),[W,H]=w.useState(!1),[he,D]=w.useState(null),[te,ve]=w.useState(1),[M,ge]=w.useState(!1),[_e,se]=w.useState(!1),[ee,oe]=w.useState([]),[ue,Ee]=w.useState(""),[Ie,fe]=w.useState(!1),pe=w.useRef(null),Re=w.useRef(null);w.useEffect(()=>{_e&&pe.current&&pe.current.scrollIntoView({behavior:"smooth"})},[ee,_e]);const Ye=w.useCallback(async()=>{d(!0),f(null);try{const be=await de("/api/drugs");if(!be.ok)throw new Error(`Failed to fetch drugs: ${be.statusText} (${be.status})`);let nt=await be.json();nt=nt.map(Ze=>({...Ze,price:parseFloat(String(Ze.price))||0,buying_price:Ze.buying_price!==null&&Ze.buying_price!==void 0?parseFloat(String(Ze.buying_price)):null,quantity_in_stock:parseInt(String(Ze.quantity_in_stock),10)||0,gst:Ze.gst!==null&&Ze.gst!==void 0?parseFloat(String(Ze.gst)):null,margin:Ze.margin!==null&&Ze.margin!==void 0?parseFloat(String(Ze.margin)):null,discount:Ze.discount!==null&&Ze.discount!==void 0?parseFloat(String(Ze.discount)):null})),t(nt),a(nt)}catch(be){console.error("Failed to fetch drugs:",be),f(be.message||"Failed to load inventory. Please try again.")}finally{d(!1)}},[]);w.useEffect(()=>{Ye()},[Ye]);const ut=(be,nt,Ze)=>{const Pt=R1(Ze,vte);return nt==="low-stock"?be.filter(Ut=>Ut.quantity_in_stock<=lC):nt==="near-expiry"?be.filter(Ut=>{if(!Ut.expiry_date)return!1;const hn=Nb(Ut.expiry_date);return mg(hn)&&Fd(hn,Pt)&&!Fd(hn,Ze)}):nt==="expired"?be.filter(Ut=>{if(!Ut.expiry_date)return!1;const hn=Nb(Ut.expiry_date);return mg(hn)&&Fd(hn,Ze)}):be};w.useEffect(()=>{const be=o.toLowerCase();let nt=n.filter(Ze=>{var Oi,Si,hr,ss,ni;const Pt=((Oi=Ze.name)==null?void 0:Oi.toLowerCase())||"",Ut=((Si=Ze.description)==null?void 0:Si.toLowerCase())||"",hn=((hr=Ze.supplier)==null?void 0:hr.toLowerCase())||"",Ln=((ss=Ze.box_number)==null?void 0:ss.toLowerCase())||"",Qn=((ni=Ze.brand_name)==null?void 0:ni.toLowerCase())||"";return Pt.includes(be)||Ut.includes(be)||hn.includes(be)||Ln.includes(be)||Qn.includes(be)});nt=ut(nt,v,new Date),a(nt),T(1)},[o,n,v]);const Ge=k*E,Se=Ge-E,qe=r.slice(Se,Ge),Ue=Math.ceil(r.length/E),ze=be=>{T(be)},lt=()=>{q(!1),ne(null)},Ke=be=>{X(parseInt(be.target.value,10)||0)},pt=async be=>{if(be.preventDefault(),f(null),!Z||!Z.id||ae===0){f("No drug selected or adjustment amount is zero.");return}try{const nt=await de(`/api/drugs/${Z.id}/adjust-stock`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantityChange:ae})});if(!nt.ok){const Pt=await nt.json();throw new Error(Pt.message||`Failed to adjust stock: ${nt.statusText}`)}const Ze=await nt.json();t(Pt=>Pt.map(Ut=>Ut.id===Ze.id?Ze:Ut)),lt(),alert(`Stock for "${Ze.name}" adjusted successfully. New stock: ${Ze.quantity_in_stock}`)}catch(nt){console.error("Failed to adjust stock:",nt),f(nt.message||"Failed to adjust stock. Please try again.")}},Te=be=>{z(be),L(!0)},ie=()=>{L(!1),z(null)},xe=async()=>{if(!F||!F.id){f("No drug selected for deletion.");return}d(!0),f(null);try{const be=await de(`/api/drugs/${F.id}`,{method:"DELETE"});if(!be.ok){const nt=await be.json();throw new Error(nt.message||`Failed to delete drug: ${be.statusText}`)}alert(`Drug "${F.name}" deleted successfully.`),Ye(),ie()}catch(be){console.error("Failed to delete drug:",be),f(be.message||"Failed to delete drug. Please try again.")}finally{d(!1)}},Qe=()=>{R(!0)},we=()=>{R(!1)},[Pe,Je]=w.useState(!1),at=()=>{U.size>0&&Je(!0)},ft=()=>{Je(!1)},Ae=async()=>{if(U.size===0){f("No drugs selected for deletion.");return}d(!0),f(null);try{const be=await de("/api/drugs/batch-delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({drugIds:Array.from(U)})});if(!be.ok){const nt=await be.json();throw new Error(nt.message||`Failed to delete selected drugs: ${be.statusText}`)}alert(`${U.size} drug(s) deleted successfully.`),Ye(),Y(new Set),ft()}catch(be){console.error("Failed to delete selected drugs:",be),f(be.message||"Failed to delete selected drugs. Please try again.")}finally{d(!1)}},Ve=async()=>{d(!0),f(null);try{const be=await de("/api/drugs/all",{method:"DELETE"});if(!be.ok){const nt=await be.json();throw new Error(nt.message||`Failed to delete all drugs: ${be.statusText}`)}alert("All drugs deleted successfully."),Ye(),we()}catch(be){console.error("Failed to delete all drugs:",be),f(be.message||"Failed to delete all drugs. Please try again.")}finally{d(!1)}},$e=be=>{if(!be)return null;const nt=be.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return nt?parseInt(nt[1],10):null},We=be=>{D(be),ve(1),H(!0)},ct=()=>{H(!1),D(null),ve(1)},dt=be=>{ve(parseInt(be.target.value,10)||0)},wt=async be=>{if(be.preventDefault(),f(null),!he||!he.id||te<=0){f("No drug selected or invalid number of packs to convert.");return}const nt=$e(he.unit);if(!nt||nt<=0){f(`Cannot convert "${he.name}" to loose. Invalid pack unit: ${he.unit||"N/A"}.`);return}if(te>(he.quantity_in_stock??0)){f(`Cannot convert ${te} packs. Only ${he.quantity_in_stock??0} packs are in stock.`);return}try{const Ze=await de(`/api/drugs/${he.id}/convert-to-loose`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({packsToConvert:te,packSize:nt})});if(!Ze.ok){const Ut=await Ze.json();throw new Error(Ut.message||`Failed to convert to loose: ${Ze.statusText}`)}const Pt=await Ze.json();t(Ut=>Ut.map(hn=>hn.id===Pt.id?Pt:hn)),ct(),alert(`Converted ${te} pack(s) of "${Pt.name}" to loose. New stock: ${Pt.quantity_in_stock} packs, ${Pt.loose??0} loose units.`)}catch(Ze){console.error("Failed to convert to loose:",Ze),f(Ze.message||"Failed to convert to loose. Please try again.")}finally{d(!1)}},bt=()=>{ge(!0)},kt=()=>{ge(!1)},Tt=async()=>{d(!0),f(null);try{const be=await de("/api/drugs/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!be.ok){const nt=await be.json();throw new Error(nt.message||`Failed to add default medications: ${be.statusText}`)}alert("Default medications added successfully."),Ye(),kt()}catch(be){console.error("Failed to add default medications:",be),f(be.message||"Failed to add default medications. Please try again.")}finally{d(!1)}},It=async()=>{const be=await de("/api/drugs",{cache:"no-store"});if(!be.ok)throw new Error("Failed to fetch fresh drugs for AI.");return(await be.json()).map(Ze=>({...Ze,price:parseFloat(String(Ze.price))||0,buying_price:Ze.buying_price!==null&&Ze.buying_price!==void 0?parseFloat(String(Ze.buying_price)):null,quantity_in_stock:parseInt(String(Ze.quantity_in_stock),10)||0,gst:Ze.gst!==null&&Ze.gst!==void 0?parseFloat(String(Ze.gst)):null,margin:Ze.margin!==null&&Ze.margin!==void 0?parseFloat(String(Ze.margin)):null,discount:Ze.discount!==null&&Ze.discount!==void 0?parseFloat(String(Ze.discount)):null,loose:Ze.loose!==null&&Ze.loose!==void 0?parseInt(String(Ze.loose),10):null}))},mt=async be=>{let nt=be,Ze=v,Pt=o,Ut=0;const hn=5,Ln=[];try{for(;Ut<hn;){const Qn=await It(),Oi=Pt.toLowerCase();let Si=Qn.filter(gn=>{var fr,oa,os,Is,la;const Pi=((fr=gn.name)==null?void 0:fr.toLowerCase())||"",er=((oa=gn.description)==null?void 0:oa.toLowerCase())||"",oi=((os=gn.supplier)==null?void 0:os.toLowerCase())||"",vi=((Is=gn.box_number)==null?void 0:Is.toLowerCase())||"",sa=((la=gn.brand_name)==null?void 0:la.toLowerCase())||"";return Pi.includes(Oi)||er.includes(Oi)||oi.includes(Oi)||vi.includes(Oi)||sa.includes(Oi)});Si=ut(Si,Ze,new Date);const hr=Si.map((gn,Pi)=>({...gn,serialNumber:Pi+1})),ni=await bte({query:nt,inventoryData:hr,currentFilter:Ze,currentSearch:Pt,history:Ln});if(ni.response_type==="action"){if(["set_filter","search_drug","edit_drug"].includes(ni.action_name)&&setTimeout(()=>{var gn;(gn=Re.current)==null||gn.scrollIntoView({behavior:"smooth",block:"start"})},100),ni.action_name==="set_filter"){const gn=ni.parameters.filter;Ze=gn,S(gn),oe(Pi=>[...Pi,{role:"ai",content:`Filtering list to show: ${gn}...`}])}else if(ni.action_name==="search_drug"){const gn=ni.parameters.query;Pt=gn,l(gn),oe(Pi=>[...Pi,{role:"ai",content:`Searching for: "${gn}"...`}])}else if(ni.action_name==="edit_drug"){const{serialNumber:gn,updates:Pi}=ni.parameters,er=hr.find(vi=>vi.serialNumber===gn);if(!er||!er.id){oe(vi=>[...vi,{role:"ai",content:`Error: I couldn't find item #${gn} to edit.`}]);break}if(oe(vi=>[...vi,{role:"ai",content:`Updating "${er.name}" (Item #${gn})...`}]),!(await de(`/api/drugs/${er.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Pi)})).ok)throw new Error("Failed to update drug details via AI.");Ye(),oe(vi=>[...vi,{role:"ai",content:`Successfully updated "${er.name}".`}])}else if(ni.action_name==="end_analysis"){ni.content&&oe(gn=>[...gn,{role:"ai",content:ni.content}]);break}Ln.push({role:"model",content:JSON.stringify(ni)}),Ln.push({role:"user",content:`Action ${ni.action_name} executed successfully. Data refreshed.`}),Ut++}else{oe(gn=>[...gn,{role:"ai",content:ni.content||"Done."}]);break}}}catch(Qn){console.error("AI Loop Error:",Qn),oe(Oi=>[...Oi,{role:"ai",content:"Sorry, I encountered an error."}])}},$t=async be=>{const nt=be||ue;nt.trim()&&(Ee(""),oe(Ze=>[...Ze,{role:"user",content:nt}]),fe(!0),await mt(nt),fe(!1))},en=()=>{oe([]),Ee("")};return h?i.jsx("div",{className:"loading-indicator",children:"Loading Inventory..."}):u?i.jsxs("div",{className:"error-indicator",children:["Error: ",u]}):i.jsxs("div",{className:"pharmacy-inventory-page",children:[i.jsxs("div",{className:"inventory-actions-group",children:[i.jsxs("div",{className:"action-group-left",children:[i.jsxs("button",{onClick:()=>e("/dashboard/purchase"),className:"action-btn-clean btn-clean-teal",children:[i.jsx(nc,{className:"button-icon"}),"Add New Drug"]}),i.jsxs("button",{onClick:()=>e("/dashboard/purchase"),className:"action-btn-clean btn-clean-blue",children:[i.jsx(nc,{className:"button-icon"}),"Purchase Page"]}),i.jsxs("button",{onClick:()=>e("/dashboard/distributors"),className:"action-btn-clean btn-clean-violet",children:[i.jsx(nc,{className:"button-icon"}),"Distributors"]})]}),i.jsxs("div",{className:"action-group-right",children:[i.jsx("button",{onClick:P,className:"action-btn-clean btn-clean-slate",children:"Download CSV"}),i.jsxs("button",{onClick:bt,className:"action-btn-clean btn-clean-emerald",children:[i.jsx(nc,{className:"button-icon"}),"Import Defaults"]}),i.jsxs("button",{onClick:at,disabled:U.size===0,className:"action-btn-clean btn-clean-amber",children:[i.jsx(Hi,{className:"button-icon"}),"Delete (",U.size,")"]}),i.jsxs("button",{onClick:Qe,className:"action-btn-clean btn-clean-red",children:[i.jsx(Hi,{className:"button-icon"}),"Delete All"]})]})]}),i.jsxs("div",{className:"search-bar-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx(Ai,{size:18,className:"search-input-icon"}),i.jsx("input",{type:"text",placeholder:"Search drugs...",value:o,onChange:be=>l(be.target.value),className:"inventory-search-input"})]}),i.jsxs("select",{value:v,onChange:be=>S(be.target.value),className:"inventory-filter-select",children:[i.jsx("option",{value:"all",children:"All Drugs"}),i.jsx("option",{value:"low-stock",children:"Low Stock"}),i.jsx("option",{value:"near-expiry",children:"Near Expiry"}),i.jsx("option",{value:"expired",children:"Expired"})]})]}),i.jsx("div",{className:"inventory-table-container",ref:Re,children:i.jsxs("table",{className:"inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"checkbox-header text-center",children:i.jsx("input",{type:"checkbox",onChange:be=>{if(be.target.checked){const nt=new Set(r.map(Ze=>Ze.id));Y(nt)}else Y(new Set)},checked:U.size===r.length&&r.length>0,disabled:r.length===0})}),i.jsx("th",{className:"drug-name-header",children:"Drug Name"}),i.jsx("th",{className:"brand-name-header",children:"Brand"}),i.jsx("th",{className:"pack-header",children:"Pack"}),i.jsx("th",{className:"expiry-header",children:"Expiry"}),i.jsx("th",{className:"qty-header text-right",children:"Stock"}),i.jsx("th",{className:"mrp-header text-right",children:"MRP"}),i.jsx("th",{className:"rate-header text-right",children:"Rate"}),i.jsx("th",{className:"box-number-header",children:"Box"}),i.jsx("th",{className:"discount-header text-right",children:"Disc %"}),i.jsx("th",{className:"margin-header text-right",children:"Margin"}),i.jsx("th",{className:"actions-cell text-center",children:"Actions"}),i.jsx("th",{className:"expand-collapse-header"})]})}),i.jsxs("tbody",{children:[r.length===0&&i.jsx("tr",{className:"no-results-message",children:i.jsx("td",{colSpan:15,children:"No drugs found matching your search."})}),qe.map(be=>i.jsxs(i.Fragment,{children:[i.jsxs("tr",{className:"drug-row",onClick:()=>{const nt=new Set(g);nt.has(be.id)&&be.id!==void 0?nt.delete(be.id):be.id!==void 0&&nt.add(be.id),b(nt)},children:[i.jsx("td",{className:"checkbox-cell",children:i.jsx("input",{type:"checkbox",onClick:nt=>nt.stopPropagation(),checked:U.has(be.id),onChange:()=>{const nt=new Set(U);nt.has(be.id)?nt.delete(be.id):nt.add(be.id),Y(nt)}})}),i.jsx("td",{className:"drug-name-cell",children:be.name||"-"}),i.jsx("td",{className:"brand-name-cell",children:be.brand_name||"-"}),i.jsx("td",{className:"pack-cell text-muted",children:be.unit||"-"}),i.jsx("td",{className:"expiry-cell text-muted",children:be.expiry_date?new Date(be.expiry_date).toLocaleDateString():"-"}),i.jsxs("td",{className:`qty-cell text-right ${be.quantity_in_stock<=lC?"text-stock low-stock":"text-stock"}`,children:[i.jsx("div",{children:be.quantity_in_stock}),i.jsx("div",{className:"loose-quantity",style:{fontSize:"0.75rem",color:"#94a3b8"},children:be.loose!==null&&be.loose!==void 0?`${be.loose} loose`:""})]}),i.jsxs("td",{className:"mrp-cell text-right text-muted",children:["",typeof be.price=="number"?be.price.toFixed(2):"N/A"]}),i.jsx("td",{className:"rate-cell text-right text-muted",children:be.buying_price!==null&&be.buying_price!==void 0?`${be.buying_price.toFixed(2)}`:"-"}),i.jsx("td",{className:"box-number-cell text-muted",children:be.box_number||"-"}),i.jsx("td",{className:"discount-cell text-right text-muted",children:be.discount!==null&&be.discount!==void 0?`${be.discount.toFixed(2)}%`:"-"}),i.jsx("td",{className:"margin-cell text-right text-muted",children:(()=>{const nt=be.price||0,Ze=be.buying_price||0,Pt=be.discount||0,Ut=be.gst||0,Ln=Ze*(1-Pt/100)*(1+Ut/100),Qn=nt-Ln;return`${(nt>0?Qn/nt*100:0).toFixed(2)}%`})()}),i.jsx("td",{className:"actions-cell text-center",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsx("button",{onClick:nt=>{nt.stopPropagation(),e(`/dashboard/inventory/edit/${be.id}`)},className:"action-icon-button",title:"Edit Drug",children:i.jsx($d,{size:16})}),i.jsx("button",{onClick:nt=>{nt.stopPropagation(),Te(be)},className:"action-icon-button delete-button",title:"Delete Drug",children:i.jsx(Hi,{size:16})}),i.jsx("button",{onClick:nt=>{nt.stopPropagation(),ne(be),q(!0)},className:"action-icon-button adjust-stock-button",title:"Adjust Stock",children:i.jsx(uI,{size:16})}),i.jsx("button",{onClick:nt=>{nt.stopPropagation(),We(be)},className:"action-icon-button convert-to-loose-button",title:"Convert to Loose",disabled:!be.unit||$e(be.unit)===null,children:i.jsx(XI,{size:16})})]})}),i.jsx("td",{className:"expand-collapse-cell",children:g.has(be.id)?i.jsx(t1,{size:16}):i.jsx(ab,{size:16})})]},be.id),g.has(be.id)&&i.jsx("tr",{className:"collapsible-row",children:i.jsx("td",{colSpan:15,children:i.jsxs("div",{className:"collapsible-content",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Drug Name:"})," ",be.name||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Description:"})," ",be.description||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Supplier:"})," ",be.supplier||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Brand Name:"})," ",be.brand_name||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Batch:"})," ",be.batch||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"HSN Code:"})," ",be.hsn_code||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"MFG:"})," ",be.mfg||"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Loose:"})," ",be.loose!==null&&be.loose!==void 0?be.loose:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Loose Price:"}),(()=>{const nt=$e(be.unit);return nt&&nt>0&&typeof be.price=="number"?`${(be.price/nt).toFixed(2)}`:"N/A"})()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"GST:"})," ",be.gst!==null&&be.gst!==void 0?`${be.gst.toFixed(2)}%`:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Discount:"})," ",be.discount!==null&&be.discount!==void 0?`${be.discount.toFixed(2)}%`:"-"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Calculated Margin:"}),(()=>{const nt=be.price||0,Ze=be.buying_price||0,Pt=be.discount||0,Ut=be.gst||0,Ln=Ze*(1-Pt/100)*(1+Ut/100),Qn=nt-Ln;return`${(nt>0?Qn/nt*100:0).toFixed(2)}%`})()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Last Updated:"})," ",new Date(be.last_updated).toLocaleString()]})]})})})]}))]})]})}),r.length>E&&i.jsxs("div",{className:"pagination-controls",style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"20px",gap:"15px"},children:[i.jsx("button",{onClick:()=>ze(k-1),disabled:k===1,className:"pagination-button",style:{padding:"8px 16px",borderRadius:"4px",border:"1px solid #ddd",background:k===1?"#f5f5f5":"white",cursor:k===1?"not-allowed":"pointer"},children:"Previous"}),i.jsxs("span",{className:"pagination-info",style:{fontWeight:500},children:["Page ",k," of ",Ue]}),i.jsx("button",{onClick:()=>ze(k+1),disabled:k===Ue,className:"pagination-button",style:{padding:"8px 16px",borderRadius:"4px",border:"1px solid #ddd",background:k===Ue?"#f5f5f5":"white",cursor:k===Ue?"not-allowed":"pointer"},children:"Next"})]}),i.jsxs("div",{className:`${rn.chatWidget} ${_e?rn.open:""}`,children:[!_e&&i.jsxs("button",{className:rn.chatToggleBtn,onClick:()=>se(!0),children:[i.jsx(tc,{size:24}),i.jsx("span",{className:rn.chatToggleText,children:"Ask Inventory AI"})]}),_e&&i.jsxs("div",{className:rn.chatWindow,children:[i.jsxs("div",{className:rn.chatHeader,children:[i.jsxs("div",{className:rn.chatHeaderTitle,children:[i.jsx("div",{className:rn.logoContainer,children:i.jsx(tc,{size:18,color:"white"})}),i.jsx("span",{children:"Inventory Analyst"})]}),i.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[i.jsx("button",{onClick:en,title:"Refresh chat",style:{background:"rgba(255, 255, 255, 0.2)",border:"none",color:"#ffffff",width:"32px",height:"32px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s",padding:"0"},onMouseEnter:be=>be.currentTarget.style.background="rgba(255, 255, 255, 0.35)",onMouseLeave:be=>be.currentTarget.style.background="rgba(255, 255, 255, 0.2)",children:i.jsx(sc,{size:16,color:"#ffffff",strokeWidth:2.5})}),i.jsx("button",{onClick:()=>se(!1),title:"Minimize chat",style:{background:"rgba(255, 255, 255, 0.2)",border:"none",color:"#ffffff",width:"32px",height:"32px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s",padding:"0"},onMouseEnter:be=>be.currentTarget.style.background="rgba(255, 255, 255, 0.35)",onMouseLeave:be=>be.currentTarget.style.background="rgba(255, 255, 255, 0.2)",children:i.jsx(JC,{size:16,color:"#ffffff",strokeWidth:2.5})})]})]}),i.jsxs("div",{className:rn.chatMessages,children:[ee.length===0&&i.jsxs("div",{className:rn.emptyChatState,children:[i.jsx("div",{className:rn.emptyIconWrapper,children:i.jsx(tc,{size:32})}),i.jsx("p",{children:"Hello! I can help you manage stock, find expired items, or update prices."}),i.jsxs("div",{className:rn.suggestionChips,children:[i.jsx("button",{onClick:()=>$t("Show low stock items"),children:"Show low stock"}),i.jsx("button",{onClick:()=>$t("Any expired drugs?"),children:"Expired drugs?"}),i.jsx("button",{onClick:()=>$t("Find Metformin"),children:"Find Metformin"})]})]}),ee.map((be,nt)=>i.jsxs("div",{className:`${rn.messageBubble} ${be.role==="user"?rn.userMessage:rn.aiMessage}`,children:[be.role==="ai"&&i.jsx("div",{className:rn.aiAvatar,children:i.jsx(tc,{size:14})}),i.jsx("div",{className:rn.messageContent,children:i.jsx(uo,{remarkPlugins:[ks],children:be.content})})]},nt)),Ie&&i.jsxs("div",{className:`${rn.messageBubble} ${rn.aiMessage}`,children:[i.jsx("div",{className:rn.aiAvatar,children:i.jsx(tc,{size:14})}),i.jsxs("div",{className:rn.typingIndicator,children:[i.jsx("span",{}),i.jsx("span",{}),i.jsx("span",{})]})]}),i.jsx("div",{ref:pe})]}),i.jsxs("div",{className:rn.chatInputArea,children:[i.jsx("input",{type:"text",value:ue,onChange:be=>Ee(be.target.value),onKeyDown:be=>be.key==="Enter"&&$t(),placeholder:"Ask about inventory...",disabled:Ie,autoFocus:!0}),i.jsx("button",{className:rn.sendBtn,onClick:()=>$t(),disabled:!ue.trim()||Ie,children:i.jsx(fw,{size:18})})]})]})]}),$&&F&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:ie,className:"modal-close-button",children:i.jsx(In,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion"}),i.jsxs("p",{className:"modal-description",children:['Are you sure you want to delete "',i.jsx("span",{className:"drug-name",children:F.name||"Unnamed Drug"}),'"? This action cannot be undone.']}),u&&i.jsx("div",{className:"modal-error-message",children:u}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:ie,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:xe,className:"button-delete",children:"Delete"})]})]})}),I&&Z&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:lt,className:"modal-close-button",children:i.jsx(In,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Adjust Stock"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:Z.name||"Unnamed Drug"}),i.jsx("br",{}),"Current Stock: ",Z.quantity_in_stock]}),u&&i.jsx("div",{className:"modal-error-message",children:u}),i.jsxs("form",{onSubmit:pt,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"adjustment",className:"form-label",children:"Adjustment Amount"}),i.jsx("input",{type:"number",name:"adjustment",id:"adjustment",required:!0,step:"1",value:ae,onChange:Ke,placeholder:"e.g., 10 or -5",className:"form-input"}),i.jsx("p",{className:"form-help-text",children:"Enter a positive number to add stock, negative to remove."})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:lt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Adjust Stock"})]})]})]})}),B&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:we,className:"modal-close-button",children:i.jsx(In,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of All Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:"ALL"})," drugs from the inventory? This action cannot be undone."]}),u&&i.jsx("div",{className:"modal-error-message",children:u}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:we,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Ve,className:"button-delete",children:"Delete All"})]})]})}),Pe&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:ft,className:"modal-close-button",children:i.jsx(In,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Deletion of Selected Drugs"}),i.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",i.jsx("span",{className:"drug-name",children:U.size})," selected drug(s)? This action cannot be undone."]}),u&&i.jsx("div",{className:"modal-error-message",children:u}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:ft,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Ae,className:"button-delete",children:"Delete Selected"})]})]})}),W&&he&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:ct,className:"modal-close-button",children:i.jsx(In,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Convert Pack to Loose"}),i.jsxs("p",{className:"modal-description",children:["Drug: ",i.jsx("span",{className:"drug-name",children:he.name||"Unnamed Drug"}),i.jsx("br",{}),"Current Packs in Stock: ",he.quantity_in_stock??0,i.jsx("br",{}),"Current Loose Units: ",he.loose??0,i.jsx("br",{}),"Pack Size: ",$e(he.unit)||"N/A"," units per pack"]}),u&&i.jsx("div",{className:"modal-error-message",children:u}),i.jsxs("form",{onSubmit:wt,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"packs-to-convert",className:"form-label",children:"Number of Packs to Convert"}),i.jsx("input",{type:"number",name:"packs-to-convert",id:"packs-to-convert",required:!0,min:"1",step:"1",value:te,onChange:dt,placeholder:"e.g., 1",className:"form-input"}),i.jsxs("p",{className:"form-help-text",children:["This will reduce pack quantity by ",te," and add ",te*($e(he.unit)||0)," to loose quantity."]})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:ct,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Convert to Loose"})]})]})]})}),M&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:kt,className:"modal-close-button",children:i.jsx(In,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Confirm Add Default Medications"}),i.jsx("p",{className:"modal-description",children:"Are you sure you want to add default medications to the inventory? This will add a predefined set of common medications."}),u&&i.jsx("div",{className:"modal-error-message",children:u}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:kt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:Tt,className:"button-submit",children:"Add Defaults"})]})]})})]})},wte="_container_172jt_1",Nte="_title_172jt_19",Ste="_dateRangeContainer_172jt_37",jte="_dateInputLabel_172jt_59",_te="_dateInput_172jt_59",Cte="_fetchButton_172jt_103",kte="_sectionTitle_172jt_145",Ete="_tableContainer_172jt_163",Tte="_analysisTable_172jt_181",Ate="_textRight_172jt_259",Dte="_textGreen_172jt_267",Pte="_textRed_172jt_277",Ite="_textOrange_172jt_297",Mte="_alertBox_172jt_315",Rte="_alertBoxError_172jt_333",Ote="_alertBoxIcon_172jt_351",Lte="_loadingContainer_172jt_359",Fte="_viewSwitcher_172jt_379",$te="_viewButton_172jt_401",zte="_viewButtonActive_172jt_437",Bte="_viewButtonInactive_172jt_465",Ute="_reasonDistribution_172jt_599",qte="_totalRow_172jt_621",un={container:wte,title:Nte,dateRangeContainer:Ste,dateInputLabel:jte,dateInput:_te,fetchButton:Cte,sectionTitle:kte,tableContainer:Ete,analysisTable:Tte,textRight:Ate,textGreen:Dte,textRed:Pte,textOrange:Ite,alertBox:Mte,alertBoxError:Rte,alertBoxIcon:Ote,loadingContainer:Lte,viewSwitcher:Fte,viewButton:$te,viewButtonActive:zte,viewButtonInactive:Bte,reasonDistribution:Ute,totalRow:qte},Vte=()=>{const e=Ot(),n=new Date().toISOString().split("T")[0],[t,r]=w.useState(n),[a,o]=w.useState(n),[l,h]=w.useState(null),[d,u]=w.useState(!1),[f,g]=w.useState(null),[b,v]=w.useState("analysis"),S=async()=>{if(u(!0),g(null),h(null),!t||!a){g("Please select both start and end dates."),u(!1);return}if(new Date(t)>new Date(a)){g("Start date cannot be after end date."),u(!1);return}try{const E=p1();if(!E){g("Clinic ID not found. Please log in again."),u(!1);return}const P=await de(`/api/inventory/comprehensive-analysis?startDate=${t}&endDate=${a}&clinicId=${E}`);if(!P.ok){const q=await P.json();throw new Error(q.message||`HTTP error! status: ${P.status}`)}const I=await P.json();h(I)}catch(E){console.error("Failed to fetch comprehensive inventory analysis data:",E),g(E.message||"Failed to fetch data. Check console for details.")}finally{u(!1)}},k=()=>{S()},T=E=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(E);return i.jsxs("div",{className:un.container,children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[" ",i.jsx("h2",{className:un.title,children:"Inventory Analysis & Management"}),i.jsx("button",{onClick:()=>e(-1),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 text-sm",children:"Back"})]}),i.jsxs("div",{className:un.viewSwitcher,children:[i.jsxs("button",{onClick:()=>v("analysis"),className:`${un.viewButton} ${b==="analysis"?un.viewButtonActive:un.viewButtonInactive}`,children:[i.jsx(VC,{size:16})," ","Analysis"]}),i.jsxs("button",{onClick:()=>v("labInventory"),className:`${un.viewButton} ${b==="labInventory"?un.viewButtonActive:un.viewButtonInactive}`,children:[i.jsx(Db,{size:16}),"Lab Test Inventory"]}),i.jsxs("button",{onClick:()=>e("/dashboard/inventory"),className:`${un.viewButton} ${b==="pharmacyInventory"?un.viewButtonActive:un.viewButtonInactive}`,children:[i.jsx(go,{size:16}),"Pharmacy Inventory"]})]}),b==="analysis"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:un.dateRangeContainer,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"start-date-inventory",className:un.dateInputLabel,children:"Start Date:"}),i.jsx("input",{type:"date",id:"start-date-inventory",value:t,onChange:E=>r(E.target.value),className:un.dateInput})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"end-date-inventory",className:un.dateInputLabel,children:"End Date:"}),i.jsx("input",{type:"date",id:"end-date-inventory",value:a,onChange:E=>o(E.target.value),className:un.dateInput})]}),i.jsx("button",{onClick:k,disabled:d,className:un.fetchButton,children:d?"Loading...":"Fetch Comprehensive Analysis"})]}),f&&i.jsxs("div",{className:`${un.alertBox} ${un.alertBoxError}`,role:"alert",children:[i.jsx("div",{className:un.alertBoxIcon,children:i.jsx(ui,{size:18})}),i.jsxs("div",{children:[" ",i.jsxs("span",{children:["Error: ",f]})]})]}),d&&i.jsxs("div",{className:un.loadingContainer,children:[" ",i.jsx("p",{children:"Loading data..."})]}),l&&!d&&i.jsxs("div",{className:"space-y-6",children:[" ",i.jsxs("div",{children:[i.jsxs("h3",{className:un.sectionTitle,children:["Pharmacy Inventory Changes (",l.startDate," to ",l.endDate,")"]}),l.pharmacyAnalysis.length>0?i.jsx("div",{className:un.tableContainer,children:i.jsxs("table",{className:un.analysisTable,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Drug Name"}),i.jsx("th",{children:"Unit"}),i.jsx("th",{className:un.textRight,children:"Price"}),i.jsx("th",{children:"Qty In (+)"}),i.jsx("th",{className:un.textRight,children:"Packs Out (-)"}),i.jsx("th",{className:un.textRight,children:"Loose Qty Out (-)"}),i.jsx("th",{className:un.textRight,children:"Packs Converted"})]})}),i.jsx("tbody",{children:l.pharmacyAnalysis.map(E=>i.jsxs("tr",{children:[i.jsx("td",{children:E.name}),i.jsx("td",{children:E.unit||"N/A"}),i.jsx("td",{className:un.textRight,children:T(E.price)}),i.jsxs("td",{className:un.textGreen,children:[" ",i.jsxs("div",{className:un.reasonDistribution,children:[Object.entries(E.quantity_in_by_reason).map(([P,I])=>i.jsxs("div",{children:[i.jsxs("span",{children:[P,":"]}),i.jsx("span",{children:I})]},P)),Object.keys(E.quantity_in_by_reason).length>0&&i.jsxs("div",{className:un.totalRow,children:[i.jsx("span",{children:"Total:"}),i.jsx("span",{children:E.quantity_in})]})]})]}),i.jsxs("td",{className:un.textRed,children:[" ",i.jsxs("div",{className:un.reasonDistribution,children:[Object.entries(E.quantity_out_by_reason||{}).map(([P,I])=>i.jsxs("div",{children:[i.jsxs("span",{children:[P,":"]}),i.jsx("span",{children:I})]},P)),Object.keys(E.quantity_out_by_reason||{}).length>0&&i.jsxs("div",{className:un.totalRow,children:[i.jsx("span",{children:"Total:"}),i.jsx("span",{children:E.quantity_out})]}),(!E.quantity_out_by_reason||Object.keys(E.quantity_out_by_reason).length===0)&&i.jsx("div",{className:un.textRight,children:E.quantity_out})]})]}),i.jsx("td",{className:`${un.textRed} ${un.textRight}`,children:E.loose_quantity_out}),i.jsx("td",{className:`${un.textOrange} ${un.textRight}`,children:E.quantity_converted})]},E.drug_id))})]})}):i.jsx("p",{className:"text-gray-500",children:"No pharmacy inventory changes found for the selected period."})]})]})]}),b==="labInventory"&&i.jsxs("div",{className:"mt-4",children:[" ",i.jsx(Jb,{})]}),b==="pharmacyInventory"&&i.jsxs("div",{className:"mt-4",children:[" ",i.jsx(IT,{})]})]})},Hte=(e,n,t,r="non-black")=>{if(isNaN(e)||isNaN(n)||e<=0||n<=0)return null;let a;return t==="female"?e<=.7?a=141*Math.pow(e/.7,-.329)*Math.pow(.993,n):a=141*Math.pow(e/.7,-1.209)*Math.pow(.993,n):e<=.9?a=141*Math.pow(e/.9,-.411)*Math.pow(.993,n):a=141*Math.pow(e/.9,-1.209)*Math.pow(.993,n),r==="black"&&(a*=1.018),parseFloat(a.toFixed(2))},Gte=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0||t>=400)return null;const r=e-n-t/5;return parseFloat(r.toFixed(2))},Yte=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},Wte=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},Qte=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=e-(n+t);return parseFloat(r.toFixed(2))},Jte=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const r=2*e+n/18+t/2.8;return parseFloat(r.toFixed(2))},cC=e=>["eGFR","LDL Cholesterol","Indirect Bilirubin","Globulin","Anion Gap","Osmolality"].includes(e),uC=()=>{var se,ee,oe;const{orderId:e}=Yr(),n=Ot(),[t,r]=w.useState(null),[a,o]=w.useState({}),[l,h]=w.useState(!0),[d,u]=w.useState(!1),[f,g]=w.useState(null),[b,v]=w.useState(null),[S,k]=w.useState(null),[T,E]=w.useState({}),[P,I]=w.useState(null),[q,$]=w.useState(!1),[L,F]=w.useState(""),[z,B]=w.useState(!1),[R,U]=w.useState(""),[Y,Z]=w.useState(!0),ne=ue=>{const Ee=document.querySelector(`[data-test-id='${ue}']`);Ee&&(document.body.classList.add("printing-single-test"),Ee.classList.add("printing"),window.print())};w.useEffect(()=>{const ue=()=>{document.body.classList.remove("printing-single-test");const Ee=document.querySelector(".printing");Ee&&Ee.classList.remove("printing")};return window.addEventListener("afterprint",ue),()=>{window.removeEventListener("afterprint",ue)}},[]);const ae=()=>{t&&Gw(t)},X=w.useCallback(async ue=>{var Ee;try{const Ie=await de(`/api/patients/${ue}`);if(!Ie.ok)throw new Error(`Failed to fetch patient details: ${Ie.status}`);const fe=await Ie.json();v(fe.age),k(((Ee=fe.sex)==null?void 0:Ee.toLowerCase())==="female"?"female":"male")}catch(Ie){console.error("Error fetching patient details:",Ie),v(null),k(null)}},[]),W=w.useCallback(async()=>{if(e){h(!0),g(null);try{const ue=await de(`/api/lab/${e}`);if(!ue.ok){const fe=await ue.json().catch(()=>({message:`HTTP error! status: ${ue.status}`}));throw new Error(fe.message||`HTTP error! status: ${ue.status}`)}const Ee=await ue.json();r(Ee),Ee.patient_id&&X(Ee.patient_id);const Ie={};if(Ee.tests&&Ee.tests.forEach(fe=>{Ie[fe.id]={},fe.default_parameters&&fe.default_parameters.length>0?fe.default_parameters.forEach(pe=>{Ie[fe.id][pe.name]=pe.defaultValue}):Ie[fe.id].report_content=""}),Ee.report_content)try{const fe=JSON.parse(Ee.report_content);if(typeof fe=="object"&&fe!==null&&!Array.isArray(fe)){const pe={...Ie};Object.keys(fe).forEach(Re=>{pe[Re]?pe[Re]={...pe[Re],...fe[Re]}:pe[Re]=fe[Re]}),o(pe)}else console.warn("Legacy or unexpected report content format detected. Initializing with defaults."),o(Ie)}catch{console.warn("Legacy report content detected (not JSON). Initializing with defaults."),o(Ie)}else o(Ie)}catch(ue){console.error("Failed to fetch lab order details:",ue),g(ue instanceof Error?ue.message:"An unknown error occurred while fetching order details.")}finally{h(!1)}}},[e,X]),H=async()=>{if(!(!e||!L))try{if(!(await de(`/api/lab/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({createdAt:new Date(L).toISOString()})})).ok)throw new Error("Failed to update order date");r(Ee=>Ee?{...Ee,createdAt:new Date(L).toISOString()}:null),$(!1)}catch(ue){console.error("Error updating date:",ue),alert("Failed to update order date")}},he=async()=>{if(!(!e||!R))try{if(!(await de(`/api/lab/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_date:new Date(R).toISOString()})})).ok)throw new Error("Failed to update report date");r(Ee=>Ee?{...Ee,report_date:new Date(R).toISOString()}:null),B(!1)}catch(ue){console.error("Error updating report date:",ue),alert("Failed to update report date")}};w.useEffect(()=>{e?W():(g("No Order ID provided in the URL."),h(!1))},[e,W]);const D=(ue,Ee,Ie)=>{o(fe=>{var we,Pe,Je,at,ft,Ae,Ve,$e,We,ct,dt,wt,bt,kt,Tt,It,mt,$t,en;const pe={...fe,[ue]:{...fe[ue],[Ee]:Ie}},Re=parseFloat((we=pe[ue])==null?void 0:we.Creatinine),Ye=b,ut=S;if(Ee==="Creatinine"&&!isNaN(Re)&&Ye!==null&&ut!==null){const be=Hte(Re,Ye,ut);be!==null&&((Pe=t==null?void 0:t.tests.find(Ze=>Ze.id===ue))!=null&&Pe.default_parameters.find(Ze=>Ze.name==="eGFR"))&&(pe[ue].eGFR=be)}const Ge=parseFloat((Je=pe[ue])==null?void 0:Je["Total Cholesterol"]),Se=parseFloat((at=pe[ue])==null?void 0:at["HDL Cholesterol"]),qe=parseFloat((ft=pe[ue])==null?void 0:ft.Triglycerides);if((Ee==="Total Cholesterol"||Ee==="HDL Cholesterol"||Ee==="Triglycerides")&&!isNaN(Ge)&&!isNaN(Se)&&!isNaN(qe)){const be=Gte(Ge,Se,qe);be!==null&&((Ae=t==null?void 0:t.tests.find(Ze=>Ze.id===ue))!=null&&Ae.default_parameters.find(Ze=>Ze.name==="LDL Cholesterol"))&&(pe[ue]["LDL Cholesterol"]=be)}const Ue=parseFloat((Ve=pe[ue])==null?void 0:Ve["Total Bilirubin"]),ze=parseFloat(($e=pe[ue])==null?void 0:$e["Direct Bilirubin"]);if((Ee==="Total Bilirubin"||Ee==="Direct Bilirubin")&&!isNaN(Ue)&&!isNaN(ze)){const be=Yte(Ue,ze);be!==null&&((We=t==null?void 0:t.tests.find(Ze=>Ze.id===ue))!=null&&We.default_parameters.find(Ze=>Ze.name==="Indirect Bilirubin"))&&(pe[ue]["Indirect Bilirubin"]=be)}const lt=parseFloat((ct=pe[ue])==null?void 0:ct["Total Protein"]),Ke=parseFloat((dt=pe[ue])==null?void 0:dt.Albumin);if((Ee==="Total Protein"||Ee==="Albumin")&&!isNaN(lt)&&!isNaN(Ke)){const be=Wte(lt,Ke);be!==null&&((wt=t==null?void 0:t.tests.find(Ze=>Ze.id===ue))!=null&&wt.default_parameters.find(Ze=>Ze.name==="Globulin"))&&(pe[ue].Globulin=be)}const pt=parseFloat((bt=pe[ue])==null?void 0:bt.Sodium),Te=parseFloat((kt=pe[ue])==null?void 0:kt.Chloride),ie=parseFloat((Tt=pe[ue])==null?void 0:Tt.Bicarbonate);if((Ee==="Sodium"||Ee==="Chloride"||Ee==="Bicarbonate")&&!isNaN(pt)&&!isNaN(Te)&&!isNaN(ie)){const be=Qte(pt,Te,ie);be!==null&&((It=t==null?void 0:t.tests.find(Ze=>Ze.id===ue))!=null&&It.default_parameters.find(Ze=>Ze.name==="Anion Gap"))&&(pe[ue]["Anion Gap"]=be)}const xe=parseFloat((mt=pe[ue])==null?void 0:mt.Glucose),Qe=parseFloat(($t=pe[ue])==null?void 0:$t.BUN);if((Ee==="Sodium"||Ee==="Glucose"||Ee==="BUN")&&!isNaN(pt)&&!isNaN(xe)&&!isNaN(Qe)){const be=Jte(pt,xe,Qe);be!==null&&((en=t==null?void 0:t.tests.find(Ze=>Ze.id===ue))!=null&&en.default_parameters.find(Ze=>Ze.name==="Osmolality"))&&(pe[ue].Osmolality=be)}return pe})},te=async(ue,Ee)=>{if(!e){alert("Cannot submit report without an Order ID.");return}if(!a[ue]||Object.keys(a[ue]).length===0){alert(`Please enter data for ${Ee} before saving.`);return}I(ue),g(null);try{const fe={...t!=null&&t.report_content?JSON.parse(t.report_content):{}};fe[ue]=a[ue];const pe=await de(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(fe)})});if(!pe.ok){const Re=await pe.json().catch(()=>({message:`Submission failed: ${pe.status}`}));throw new Error(Re.message||`Submission failed: ${pe.status}`)}t&&r({...t,report_content:JSON.stringify(fe)}),alert(`Report for ${Ee} saved successfully!`)}catch(Ie){console.error(`Error submitting report for ${Ee}:`,Ie),alert(`Failed to save report for ${Ee}: ${Ie instanceof Error?Ie.message:"Unknown error"}`)}finally{I(null)}},ve=async()=>{if(Object.keys(a).length===0){alert("Report content cannot be empty.");return}if(!e){alert("Cannot submit report without an Order ID.");return}u(!0),g(null);try{const ue=await de(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(a)})});if(!ue.ok){const Ee=await ue.json().catch(()=>({message:`Submission failed: ${ue.status}`}));throw new Error(Ee.message||`Submission failed: ${ue.status}`)}alert("Report submitted successfully!"),n(-1)}catch(ue){console.error("Error submitting report:",ue),g(ue instanceof Error?ue.message:"An unknown error occurred during submission.")}finally{u(!1)}};if(l)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",style:{textAlign:"center",padding:"50px"},children:[" ",i.jsxs("div",{className:"loading-text",children:[i.jsx(Rf,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading details..."]})]})});if(f&&!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card error-message-container",style:{textAlign:"center",padding:"30px"},children:[i.jsx(ui,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("h3",{className:"error-title",style:{borderBottom:"none"},children:"Error Loading Details"}),i.jsx("p",{className:"error-text",children:f}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"20px"},children:[i.jsx(on,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});if(!t)return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(As,{size:48,className:"mb-3",style:{margin:"0 auto"}}),i.jsx("p",{className:"no-data-message",style:{fontSize:"1.1em"},children:`Lab order not found for ID: ${e}.`}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"15px"},children:[i.jsx(on,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});const M=(se=t==null?void 0:t.Patient)==null?void 0:se.name,ge=(ee=t==null?void 0:t.Patient)==null?void 0:ee.patient_token_number,_e=`Enter Report for Order #${(t==null?void 0:t.lab_token_number)??e}`;return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"none",paddingBottom:0,marginBottom:0},children:[" ",i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:_e})," ",i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs("button",{onClick:()=>window.print(),className:"lab-inventory-button",disabled:d,"aria-label":"Print report",children:[i.jsx(fo,{size:16,style:{marginRight:"5px"}}),"Print"]}),i.jsxs("button",{onClick:ae,className:"lab-inventory-button",disabled:d||!((oe=t==null?void 0:t.Patient)!=null&&oe.phone)||!(t!=null&&t.report_content),"aria-label":"Share report via WhatsApp",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},children:[i.jsx(KC,{size:16,style:{marginRight:"5px"}}),"WhatsApp"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",disabled:d,children:[i.jsx(on,{size:16,style:{marginRight:"5px"}}),"Back"]})]})]}),t&&i.jsxs("div",{className:`lab-inventory-card printable-section patient-info-section ${Y?"":"no-print"}`,style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Y?i.jsxs("div",{children:[i.jsx(As,{size:18,className:"no-print",style:{marginRight:"8px",verticalAlign:"middle"}})," Order Summary"]}):i.jsx("div",{}),i.jsx("button",{onClick:()=>Z(!Y),className:"lab-action-button no-print",style:{background:"none",border:"none",boxShadow:"none",color:"#666",padding:"4px"},title:Y?"Hide Summary":"Show Summary",children:Y?i.jsx(GC,{size:18}):i.jsx(og,{size:18})})]}),Y&&i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"10px",fontSize:"0.95em"},children:[i.jsxs("div",{children:[i.jsx(fl,{size:15,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Patient:"})," ",M??"N/A"," (Token: ",ge??"N/A",")"]}),i.jsxs("div",{children:[i.jsx(rb,{size:15,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle",display:"inline"}}),i.jsx("strong",{children:"Order Date:"}),q?i.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"5px",marginLeft:"5px"},children:[i.jsx("input",{type:"datetime-local",value:L,onChange:ue=>F(ue.target.value),className:"lab-inventory-input",style:{padding:"2px 5px",height:"auto",margin:0,fontSize:"0.9em"}}),i.jsx("button",{onClick:H,className:"lab-action-button",style:{padding:"2px",color:"green"},children:i.jsx(Ds,{size:14})}),i.jsx("button",{onClick:()=>$(!1),className:"lab-action-button",style:{padding:"2px",color:"red"},children:i.jsx(In,{size:14})})]}):i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"no-print",style:{marginLeft:"5px"},children:_r(new Date(t.createdAt),"PPpp")}),i.jsx("span",{className:"print-only",style:{marginLeft:"5px"},children:_r(new Date(t.createdAt),"PP")}),i.jsx("button",{onClick:()=>{F(_r(new Date(t.createdAt),"yyyy-MM-dd'T'HH:mm")),$(!0)},className:"lab-action-button no-print",style:{padding:"2px",marginLeft:"5px",background:"none",border:"none",boxShadow:"none",color:"#666"},title:"Edit Date",children:i.jsx(lg,{size:12})})]})]}),t.report_date&&i.jsxs("div",{children:[i.jsx(rb,{size:15,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle",display:"inline"}}),i.jsx("strong",{children:"Report Date:"}),z?i.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"5px",marginLeft:"5px"},children:[i.jsx("input",{type:"datetime-local",value:R,onChange:ue=>U(ue.target.value),className:"lab-inventory-input",style:{padding:"2px 5px",height:"auto",margin:0,fontSize:"0.9em"}}),i.jsx("button",{onClick:he,className:"lab-action-button",style:{padding:"2px",color:"green"},children:i.jsx(Ds,{size:14})}),i.jsx("button",{onClick:()=>B(!1),className:"lab-action-button",style:{padding:"2px",color:"red"},children:i.jsx(In,{size:14})})]}):i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"no-print",style:{marginLeft:"5px"},children:_r(new Date(t.report_date),"PPpp")}),i.jsx("span",{className:"print-only",style:{marginLeft:"5px"},children:_r(new Date(t.report_date),"PP")}),i.jsx("button",{onClick:()=>{U(_r(new Date(t.report_date),"yyyy-MM-dd'T'HH:mm")),B(!0)},className:"lab-action-button no-print",style:{padding:"2px",marginLeft:"5px",background:"none",border:"none",boxShadow:"none",color:"#666"},title:"Edit Report Date",children:i.jsx(lg,{size:12})})]})]}),i.jsxs("div",{style:{gridColumn:"1 / -1"},children:[i.jsx($I,{size:15,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle"}}),i.jsx("strong",{children:"Tests:"})," ",(t.tests||[]).map(ue=>ue.name).join(", ")]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:Xte(t.status),children:Kte(t.status)})]})]})]}),i.jsxs("div",{className:"printable-section",style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:[i.jsx(ns,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}}),"Lab Report"]}),t==null?void 0:t.tests.map(ue=>{var Ee;return i.jsxs("div",{"data-test-id":ue.id,className:"lab-inventory-card test-report-container",style:{marginBottom:"15px"},children:[i.jsxs("div",{className:"lab-inventory-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[i.jsx("h4",{style:{fontSize:"1.1em",margin:0},children:ue.name}),i.jsx("div",{className:"no-print",style:{display:"flex",gap:"10px"},children:i.jsx("button",{onClick:()=>ne(ue.id),className:"lab-inventory-button print-test-button","aria-label":`Print ${ue.name}`,children:i.jsx(fo,{size:16})})})]}),ue.default_parameters&&ue.default_parameters.length>0?i.jsx(i.Fragment,{children:i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Parameter"}),i.jsx("th",{children:"Value"}),i.jsx("th",{children:"Normal Range"})]})}),i.jsx("tbody",{children:ue.default_parameters.map(Ie=>{var ut,Ge,Se;const fe=(ut=a[ue.id])==null?void 0:ut[Ie.name],pe=typeof fe=="string"?parseFloat(fe):typeof fe=="number"?fe:NaN,Re=Ie.type==="number"&&!isNaN(pe)&&fe!==""&&fe!==null&&fe!==void 0&&(Ie.lower_limit!=null&&pe<Ie.lower_limit||Ie.upper_limit!=null&&pe>Ie.upper_limit),Ye=Ie.type==="boolean"&&(fe===!0||fe==="true");return i.jsxs("tr",{children:[i.jsxs("td",{style:{fontWeight:"500"},children:[Ie.name,Ie.unit&&i.jsxs("span",{style:{color:"#6b7280",fontSize:"0.9em"},children:[" (",Ie.unit,")"]})]}),i.jsxs("td",{className:`${Re?"abnormal-result":""} ${Ye?"reactive-result":""}`,children:[i.jsxs("div",{className:"no-print",children:[Ie.type==="boolean"?i.jsxs("select",{id:`${ue.id}-${Ie.name}`,value:(fe==null?void 0:fe.toString())??"false",onChange:qe=>D(ue.id,Ie.name,qe.target.value==="true"),className:"lab-inventory-input",style:{margin:0,width:"100%"},disabled:d,children:[i.jsx("option",{value:"false",children:"Non-Reactive"}),i.jsx("option",{value:"true",children:"Reactive"})]}):i.jsx("input",{id:`${ue.id}-${Ie.name}`,type:Ie.type==="number"?"number":"text",value:fe??"",onChange:qe=>{D(ue.id,Ie.name,qe.target.value)},onBlur:qe=>{Ie.type==="number"&&qe.target.value===""&&D(ue.id,Ie.name,0)},className:"lab-inventory-input",style:{margin:0,width:"100%"},disabled:d||cC(Ie.name)&&!((Ge=T[ue.id])!=null&&Ge[Ie.name]),placeholder:`Enter ${Ie.name.toLowerCase()}`}),cC(Ie.name)&&i.jsx("button",{type:"button",onClick:()=>E(qe=>{var Ue;return{...qe,[ue.id]:{...qe[ue.id]||{},[Ie.name]:!((Ue=qe[ue.id])!=null&&Ue[Ie.name])}}}),className:"lab-inventory-button lab-inventory-button-tertiary",style:{fontSize:"0.75em",padding:"3px 8px",marginTop:"5px"},disabled:d,children:(Se=T[ue.id])!=null&&Se[Ie.name]?"Lock":"Edit"})]}),i.jsx("span",{className:"print-only",children:Ie.type==="boolean"?fe===!0||fe==="true"?"Reactive":"Non-Reactive":`${fe??""} ${Ie.unit??""}`})]}),i.jsx("td",{style:{color:"#6b7280",fontSize:"0.9em"},children:Ie.type==="number"&&(Ie.lower_limit!==null||Ie.upper_limit!==null)?i.jsxs(i.Fragment,{children:[Ie.lower_limit!=null&&`> ${Ie.lower_limit}`,Ie.lower_limit!=null&&Ie.upper_limit!=null&&" - ",Ie.upper_limit!=null&&`< ${Ie.upper_limit}`,Ie.unit&&` ${Ie.unit}`]}):Ie.type==="boolean"?"Non-Reactive":"N/A"})]},Ie.name)})})]})}):i.jsxs("div",{className:"lab-inventory-form-group no-print",children:[i.jsx("label",{htmlFor:`${ue.id}-report_content`,children:"Report Content"}),i.jsx("textarea",{id:`${ue.id}-report_content`,value:((Ee=a[ue.id])==null?void 0:Ee.report_content)??"",onChange:Ie=>D(ue.id,"report_content",Ie.target.value),className:"lab-inventory-input",rows:5,placeholder:`Enter report for ${ue.name}...`,disabled:d})]}),i.jsx("div",{className:"no-print",style:{marginTop:"15px",textAlign:"right"},children:i.jsx("button",{type:"button",onClick:()=>te(ue.id,ue.name),disabled:d||P===ue.id,className:"lab-inventory-button",style:{fontSize:"0.9em",padding:"8px 16px"},children:P===ue.id?i.jsxs(i.Fragment,{children:[i.jsx(Rf,{className:"animate-spin mr-2",size:14})," Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(oc,{size:14,style:{marginRight:"5px"}})," Save ",ue.name]})})})]},ue.id)}),f&&i.jsxs("p",{className:"error-text no-print",style:{marginTop:"10px"},children:[i.jsx(ui,{size:15,className:"inline mr-1"}),f]})]}),i.jsxs("div",{className:"no-print",style:{marginTop:"20px",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[" ",i.jsx("button",{type:"button",onClick:()=>n(-1),disabled:d,className:"lab-inventory-button lab-inventory-button-secondary",children:"Cancel"}),i.jsx("button",{type:"button",onClick:ve,disabled:d||Object.keys(a).length===0,className:"lab-inventory-button",children:d?i.jsxs(i.Fragment,{children:[i.jsx(Rf,{className:"animate-spin mr-2",size:16})," Submitting..."]}):i.jsxs(i.Fragment,{children:[i.jsx(oc,{size:16,style:{marginRight:"5px"}})," Submit All Reports"]})})]})]})})},Kte=e=>e?e.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()):"Unknown",Xte=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},Zte=()=>{const{orderId:e}=Yr(),n=Ot(),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,h]=w.useState(null),[d,u]=w.useState(!1),[f,g]=w.useState(""),[b,v]=w.useState(!1),[S,k]=w.useState(""),[T,E]=w.useState(!0),P=w.useCallback(async F=>{if(!F){h("No Order ID specified in the URL."),o(!1),r(null);return}o(!0),h(null),r(null);try{console.log(`Fetching order details for ID: ${F}`);const z=await de(`/api/lab/orders/${F}/report`);if(!z.ok){let R;try{R=await z.json()}catch{R={message:`Server returned status ${z.status}`}}throw console.error("Fetch order details error response:",R),new Error(R.message||`Failed to fetch order details: ${z.status}`)}const B=await z.json();if(console.log("Received order data:",B),!B)throw console.error("Invalid order data structure:",B),new Error("Invalid order data received from server.");r(B)}catch(z){console.error("Error fetching order details:",z),h(z instanceof Error?z.message:"An unknown error occurred while fetching the order details")}finally{o(!1)}},[de]);w.useEffect(()=>{P(e)},[e,P]);const I=F=>{const z=document.querySelector(`[data-test-id='${F}']`);z&&(document.body.classList.add("printing-single-test"),z.classList.add("printing"),window.print())};w.useEffect(()=>{const F=()=>{document.body.classList.remove("printing-single-test");const z=document.querySelector(".printing");z&&z.classList.remove("printing")};return window.addEventListener("afterprint",F),()=>{window.removeEventListener("afterprint",F)}},[]);const q=()=>{t&&Gw(t)},$=async()=>{if(!(!e||!f))try{if(!(await de(`/api/lab/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({createdAt:new Date(f).toISOString()})})).ok)throw new Error("Failed to update order date");r(z=>z?{...z,createdAt:new Date(f).toISOString()}:null),u(!1)}catch(F){console.error("Error updating date:",F),alert("Failed to update order date")}},L=async()=>{if(!(!e||!S))try{if(!(await de(`/api/lab/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_date:new Date(S).toISOString()})})).ok)throw new Error("Failed to update report date");r(z=>z?{...z,report_date:new Date(S).toISOString()}:null),v(!1)}catch(F){console.error("Error updating report date:",F),alert("Failed to update report date")}};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:0,paddingBottom:0,borderBottom:"none"},children:[i.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:"Lab Report Viewer"})," ",i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs(Ps,{to:"/lab/search-report",className:"lab-inventory-button","aria-label":"Search for other reports",children:[i.jsx(Ai,{size:16,style:{marginRight:"5px"}}),"Search Reports"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(on,{size:16,style:{marginRight:"5px"}}),"Back"]}),i.jsxs("button",{onClick:()=>window.print(),className:"lab-inventory-button","aria-label":"Print report",children:[i.jsx(fo,{size:16,style:{marginRight:"5px"}}),"Print"]}),i.jsxs("button",{onClick:q,className:"lab-inventory-button","aria-label":"Share report via WhatsApp",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},children:[i.jsx(KC,{size:16,style:{marginRight:"5px"}}),"WhatsApp"]})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",children:["Report Details (Order ID: ",e||"None Specified",")"]}),a&&i.jsx("div",{className:"loading-text",children:"Loading report..."}),l&&!a&&i.jsxs("div",{className:"error-message-container",style:{textAlign:"center"},children:[i.jsx(ui,{size:48}),i.jsx("h3",{className:"error-title",children:"Error Loading Report"}),i.jsx("p",{children:l}),e&&i.jsx("button",{onClick:()=>P(e),className:"retry-button",children:"Retry"})]}),i.jsxs("div",{className:"printable-section",children:[!a&&!l&&(t==null?void 0:t.Patient)&&i.jsxs("div",{className:`lab-inventory-card ${T?"":"no-print"}`,style:{marginBottom:"20px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[T?i.jsxs("div",{children:[i.jsx(fl,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Patient Information"]}):i.jsx("div",{}),i.jsx("button",{onClick:()=>E(!T),className:"lab-action-button no-print",style:{background:"none",border:"none",boxShadow:"none",color:"#666",padding:"4px"},title:T?"Hide Summary":"Show Summary",children:T?i.jsx(GC,{size:18}):i.jsx(og,{size:18})})]}),T&&i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"10px",fontSize:"0.9em"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Name:"})," ",t.Patient.name||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Age:"})," ",t.Patient.age??"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Gender:"})," ",t.Patient.gender||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Token No:"})," ",t.Patient.patient_token_number||"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Patient ID:"})," ",t.Patient.id]}),t.Patient.phone&&i.jsxs("div",{children:[i.jsx("strong",{children:"Phone:"})," ",t.Patient.phone]}),i.jsxs("div",{children:[i.jsx(rb,{size:16,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle",display:"inline"}}),i.jsx("strong",{children:"Order Date:"}),d?i.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"5px",marginLeft:"5px"},children:[i.jsx("input",{type:"datetime-local",value:f,onChange:F=>g(F.target.value),className:"lab-inventory-input",style:{padding:"2px 5px",height:"auto",margin:0,fontSize:"0.9em"}}),i.jsx("button",{onClick:$,className:"lab-action-button",style:{padding:"2px",color:"green"},children:i.jsx(Ds,{size:14})}),i.jsx("button",{onClick:()=>u(!1),className:"lab-action-button",style:{padding:"2px",color:"red"},children:i.jsx(In,{size:14})})]}):i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"no-print",style:{marginLeft:"5px"},children:_r(new Date(t.createdAt),"PPpp")}),i.jsx("span",{className:"print-only",style:{marginLeft:"5px"},children:_r(new Date(t.createdAt),"PP")}),i.jsx("button",{onClick:()=>{g(_r(new Date(t.createdAt),"yyyy-MM-dd'T'HH:mm")),u(!0)},className:"lab-action-button no-print",style:{padding:"2px",marginLeft:"5px",background:"none",border:"none",boxShadow:"none",color:"#666"},title:"Edit Date",children:i.jsx(lg,{size:12})})]})]}),t.report_date&&i.jsxs("div",{children:[i.jsx(rb,{size:16,className:"no-print",style:{marginRight:"5px",verticalAlign:"middle",display:"inline"}}),i.jsx("strong",{children:"Report Date:"}),b?i.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"5px",marginLeft:"5px"},children:[i.jsx("input",{type:"datetime-local",value:S,onChange:F=>k(F.target.value),className:"lab-inventory-input",style:{padding:"2px 5px",height:"auto",margin:0,fontSize:"0.9em"}}),i.jsx("button",{onClick:L,className:"lab-action-button",style:{padding:"2px",color:"green"},children:i.jsx(Ds,{size:14})}),i.jsx("button",{onClick:()=>v(!1),className:"lab-action-button",style:{padding:"2px",color:"red"},children:i.jsx(In,{size:14})})]}):i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"no-print",style:{marginLeft:"5px"},children:_r(new Date(t.report_date),"PPpp")}),i.jsx("span",{className:"print-only",style:{marginLeft:"5px"},children:_r(new Date(t.report_date),"PP")}),i.jsx("button",{onClick:()=>{k(_r(new Date(t.report_date),"yyyy-MM-dd'T'HH:mm")),v(!0)},className:"lab-action-button no-print",style:{padding:"2px",marginLeft:"5px",background:"none",border:"none",boxShadow:"none",color:"#666"},title:"Edit Report Date",children:i.jsx(lg,{size:12})})]})]})]})]}),!a&&!l&&(t==null?void 0:t.report_content)&&i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("h3",{className:"lab-inventory-header",children:[i.jsx(ns,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Report Findings"]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6"},children:(()=>{try{const F=JSON.parse(t.report_content||"{}");return typeof F=="object"&&F!==null&&t.tests?t.tests.map(z=>i.jsxs("div",{"data-test-id":z.id,className:"test-report-container",style:{marginBottom:"20px"},children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h4",{style:{fontSize:"1.1em",margin:0},children:z.name}),i.jsx("button",{onClick:()=>I(z.id),className:"lab-inventory-button print-test-button","aria-label":`Print ${z.name}`,children:i.jsx(fo,{size:16})})]}),F[z.id]?i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Parameter"}),i.jsx("th",{children:"Value"}),i.jsx("th",{children:"Normal Range"})]})}),i.jsx("tbody",{children:Object.entries(F[z.id]).map(([B,R])=>{var X;const U=(X=z.default_parameters)==null?void 0:X.find(W=>W.name===B),Y=typeof R=="string"?parseFloat(R):typeof R=="number"?R:NaN,Z=(U==null?void 0:U.type)==="number"&&!isNaN(Y)&&(U.lower_limit!=null&&Y<U.lower_limit||U.upper_limit!=null&&Y>U.upper_limit),ne=(U==null?void 0:U.type)==="boolean"?R===!0||R==="true"?"Reactive":"Non-Reactive":String(R),ae=(U==null?void 0:U.type)==="boolean"&&(R===!0||R==="true");return i.jsxs("tr",{children:[i.jsx("td",{children:B}),i.jsxs("td",{className:`${Z?"abnormal-result":""} ${ae?"reactive-result":""}`,children:[ne," ",U==null?void 0:U.unit]}),i.jsx("td",{children:U&&U.type==="number"&&(U.lower_limit!==null||U.upper_limit!==null)?i.jsxs(i.Fragment,{children:[U.lower_limit!=null&&` > ${U.lower_limit}`,U.lower_limit!=null&&U.upper_limit!=null&&" - ",U.upper_limit!=null&&` < ${U.upper_limit}`,U.unit&&` ${U.unit}`]}):((U==null?void 0:U.type)==="boolean","N/A")})]},B)})})]}):i.jsx("p",{children:"No parameters reported for this test."})]},z.id)):i.jsx(uo,{remarkPlugins:[ks],children:t.report_content})}catch{return i.jsx(uo,{remarkPlugins:[ks],children:t.report_content||"*No findings recorded.*"})}})()})]})]}),!a&&!l&&!(t!=null&&t.report_content)&&!(t!=null&&t.Patient)&&e&&i.jsxs("div",{className:"no-data-message",children:["No report content or patient details found for Order ID: ",e,". The order might be processing, does not exist, or the ID is incorrect."]}),!e&&!a&&!l&&i.jsxs("div",{className:"no-data-message",children:["No order ID specified in the URL.",i.jsx(Ps,{to:"/lab/search-report",className:"lab-inventory-link",style:{display:"block",marginTop:"10px"},children:"Go to Search Page"})]})]})]})})},ene=()=>{const e=Ot(),[n,t]=w.useState(""),[r,a]=w.useState(!1),[o,l]=w.useState([]),[h,d]=w.useState(null),[u,f]=w.useState(n);w.useEffect(()=>{const k=setTimeout(()=>{f(n)},500);return()=>{clearTimeout(k)}},[n]),w.useEffect(()=>{g()},[u]);const g=async()=>{const k=n.trim();if(!k){l([]),d(null);return}a(!0),d(null),l([]),console.log(`Searching for: ${k}`);try{const T=await de("/api/lab");if(!T.ok){let L;try{L=await T.json()}catch{L={message:`Server returned status ${T.status}`}}throw console.error("Search fetch error response:",L),new Error(L.message||`HTTP error! status: ${T.status}`)}const{orders:E}=await T.json();console.log("Received lab orders for search:",E);const I=E.filter(L=>!!L.report_content).map(L=>{var F,z;return{id:L.id,labTokenNumber:String(L.lab_token_number??"N/A"),patientName:((F=L.Patient)==null?void 0:F.name)||"N/A",patientId:L.patient_id,patientTokenNumber:String(((z=L.Patient)==null?void 0:z.patient_token_number)??"N/A"),tests:(L.tests||[]).map(B=>B.name||"Unknown Test"),date:_r(new Date(L.createdAt),"yyyy-MM-dd"),status:L.status}}),q=n.toLowerCase(),$=I.filter(L=>{var B,R,U,Y,Z;const F=String(L.labTokenNumber).toLowerCase(),z=String(L.patientTokenNumber).toLowerCase();return(((B=L.patientName)==null?void 0:B.toLowerCase())||"").includes(q)||F.includes(q)||z.includes(q)||(((U=(R=L.tests)==null?void 0:R.join(" "))==null?void 0:U.toLowerCase())||"").includes(q)||(((Y=L.id)==null?void 0:Y.toLowerCase())||"").includes(q)||(((Z=L.patientId)==null?void 0:Z.toLowerCase())||"").includes(q)});console.log("Filtered search results:",$),l($),$.length===0&&k?d(`No matching reports found for "${k}".`):d(null)}catch(T){console.error("Failed to search lab reports:",T),d(T instanceof Error?T.message:"An unknown error occurred during search")}finally{a(!1)}},b=k=>{console.log(`Result clicked, navigating to view report for order ID: ${k}`),e(`/lab/view-report/${k}`)},v=k=>{switch(k){case"pending":return{text:"Sample Pending",color:"text-red-600 bg-red-100"};case"collected":return{text:"Sample Collected",color:"text-yellow-600 bg-yellow-100"};case"processing":return{text:"Processing",color:"text-blue-600 bg-blue-100"};case"completed":return{text:"Completed",color:"text-green-600 bg-green-100"};case"cancelled":return{text:"Cancelled",color:"text-gray-600 bg-gray-100 line-through"};case"reported":return{text:"Reported",color:"text-purple-600 bg-purple-100"};default:return{text:k,color:"text-gray-600 bg-gray-100"}}},S=k=>{switch(k){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h2",{style:{margin:0},children:"Search Lab Reports"}),i.jsxs("button",{onClick:()=>e(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[i.jsx(on,{size:16,style:{marginRight:"5px"}}),"Back"]})]}),i.jsxs("div",{className:"lab-inventory-form-group",style:{marginTop:"20px",position:"relative"},children:[i.jsx("label",{htmlFor:"report-search",children:"Enter Search Term"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",position:"relative"},children:[i.jsx(Ai,{size:20,style:{position:"absolute",left:"10px",color:"#777"}}),i.jsx("input",{id:"report-search",type:"text",placeholder:"Patient name, ID, token, report ID, test name...",value:n,onChange:k=>t(k.target.value),className:"lab-inventory-input",style:{paddingLeft:"40px",marginBottom:"0"}})]})]}),i.jsxs("div",{style:{marginTop:"20px"},children:[r&&i.jsx("div",{className:"loading-text",children:"Searching..."}),h&&!r&&i.jsxs("div",{className:"error-text",children:[i.jsx(ui,{size:20,className:"inline mr-2"})," ",h]}),o.length>0&&!r&&i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:o.map(k=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(k.id),style:{marginBottom:"15px",cursor:"pointer",padding:"15px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:[i.jsx(fI,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}}),k.patientName," (Token: ",k.patientTokenNumber,")"]}),i.jsx("span",{className:S(k.status),children:v(k.status).text})]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:[i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(ns,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Order ID: ",k.id]}),i.jsxs("div",{style:{marginBottom:"5px"},children:[i.jsx(EM,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Tests: ",k.tests.join(", ")]}),i.jsxs("div",{children:[i.jsx(ZP,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Date: ",k.date]})]})]},k.id))}),!r&&o.length===0&&!h&&n.trim()&&i.jsxs("div",{className:"no-data-message",children:['No results found for "',n,'".']}),!r&&o.length===0&&!h&&!n.trim()&&i.jsx("div",{className:"no-data-message",style:{backgroundColor:"transparent",border:"none",textAlign:"left",padding:"5px 0"},children:"Enter a search term above to find lab reports."})]})]})})},tne=()=>{const{patientId:e}=Yr(),n=Ot(),[t,r]=w.useState([]),[a,o]=w.useState(!0),[l,h]=w.useState(null),[d,u]=w.useState(null),[f,g]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){h("Patient ID is missing from the URL."),o(!1);return}o(!0),h(null),r([]),g(null);try{const S=await de(`/api/patients/${e}`);if(S.ok){const E=await S.json();g(E.name||`Patient ID: ${e}`)}else console.warn(`Failed to fetch patient name for ID ${e}`),g(`Patient ID: ${e}`);const k=await de(`/api/lab/patient/${e}`);if(!k.ok){const E=await k.json().catch(()=>({}));throw new Error(E.message||`HTTP error! status: ${k.status}`)}const T=await k.json();r(T||[])}catch(S){console.error("Error fetching data:",S),h(`Failed to load data: ${S.message}`)}finally{o(!1)}})()},[e]);const b=v=>{v.report_content?n(`/lab/view-report/${v.id}`):n(`/lab/enter-report/${v.id}`)};return i.jsx("div",{className:"lab-inventory-container",children:i.jsxs("div",{className:"lab-inventory-card",children:[i.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("h2",{style:{margin:0},children:["Lab Reports ",f?`for ${f}`:`for Patient ID: ${e}`]}),i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsxs("button",{onClick:async()=>{if(!e){alert("Patient ID is missing. Cannot create a new report.");return}try{const v=await de("/api/lab/create-empty-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:e})});if(!v.ok){const k=await v.json().catch(()=>({message:`Failed to create new lab order: ${v.status}`}));throw new Error(k.message||`Failed to create new lab order: ${v.status}`)}const S=await v.json();n(`/lab/enter-report/${S.newOrderId}`)}catch(v){console.error("Error creating new lab order:",v),alert(`Error creating new lab order: ${v.message}`)}},className:"lab-inventory-button",disabled:!e,title:e?"Enter a new lab report for this patient":"Patient ID missing",children:[i.jsx(nc,{size:16,style:{marginRight:"5px"}}),"Enter New Report"]}),i.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",children:[i.jsx(on,{size:16,style:{marginRight:"5px"}}),"Back"]})]})]}),i.jsx("div",{style:{marginTop:"20px"},children:a?i.jsxs("div",{className:"loading-text",children:[i.jsx(Rf,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading reports..."]}):l?i.jsxs("div",{className:"error-text",style:{textAlign:"center",padding:"20px"},children:[i.jsx(ZC,{size:40,style:{marginBottom:"10px",color:"#721c24"}}),i.jsx("h3",{style:{fontSize:"1.2em",color:"#721c24",margin:"10px 0"},children:"Error Loading Reports"}),i.jsx("p",{children:l})]}):t.length===0?i.jsxs("div",{className:"no-data-message",style:{textAlign:"center",padding:"30px"},children:[i.jsx(ns,{size:48,className:"mb-3",style:{margin:"0 auto 15px auto",display:"block"}}),i.jsx("p",{children:"No lab reports found for this patient."}),i.jsxs("p",{children:["You can ",i.jsx(Ps,{to:`/lab/create-order/${e}`,className:"lab-inventory-link",children:"create a new lab order"}),"."]})]}):d?i.jsxs("div",{className:"lab-inventory-card",style:{backgroundColor:"#fdfdfd"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[i.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.3em",borderBottom:"none",margin:0},children:["Report from: ",d.report_date?_r(new Date(d.report_date),"PPP p"):"N/A"]}),i.jsxs("button",{onClick:()=>u(null),className:"lab-inventory-button lab-inventory-button-secondary",style:{fontSize:"0.9em",padding:"8px 12px"},children:[i.jsx(on,{size:16,style:{marginRight:"5px"}})," Back to List"]})]}),i.jsxs("p",{style:{marginBottom:"15px",fontSize:"1em"},children:[i.jsx("strong",{children:"Tests Ordered:"})," ",(d.tests||[]).map(v=>v.name).join(", ")]}),i.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6",border:"1px solid #eee",padding:"15px",borderRadius:"4px",background:"#fff"},children:i.jsx(uo,{remarkPlugins:[ks],children:d.report_content||"*No findings recorded.*"})})]}):i.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:t.map(v=>i.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(v),tabIndex:0,onKeyPress:S=>S.key==="Enter"&&b(v),style:{marginBottom:"15px",cursor:"pointer",padding:"15px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx(ns,{size:24,style:{marginRight:"15px",color:"#007bff"}}),i.jsxs("div",{children:[i.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:["Order Date: ",_r(new Date(v.createdAt),"PPP")]}),i.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:["Tests: ",v.tests&&v.tests.length>0?v.tests.map(S=>S.name).join(", "):"N/A"]})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[v.status&&i.jsx("span",{className:ine(v.status),children:nne(v.status)}),i.jsx(bg,{size:20,style:{color:"#6c757d"}})]})]},v.id))})})]})})},nne=e=>{if(!e)return"Unknown";switch(e.toLowerCase()){case"pending":return"Pending Sample";case"collected":return"Sample Collected";case"processing":return"Processing";case"report_ready":return"Report Ready";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return e.charAt(0).toUpperCase()+e.slice(1)}},ine=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},MT=()=>{const e=Ot(),[n,t]=w.useState([]),[r,a]=w.useState([]),[o,l]=w.useState(!1),[h,d]=w.useState(null),[u,f]=w.useState(""),[g,b]=w.useState("all"),v=10,S=1;w.useEffect(()=>{(async()=>{l(!0),d(null);try{console.log("Fetching pharmacy inventory for view page...");const E=await de("/api/drugs");if(!E.ok)throw new Error(`HTTP error! status: ${E.status}`);const P=await E.json();console.log("Fetched Pharmacy Inventory for view page:",P),t(P||[])}catch(E){console.error("Error fetching pharmacy inventory:",E),d("Failed to load pharmacy inventory.")}finally{}})()},[]),w.useEffect(()=>{(async()=>{try{console.log("Fetching lab inventory for view page...");const E=await de("/api/lab-tests");if(!E.ok)throw new Error(`HTTP error! status: ${E.status}`);const P=await E.json();console.log("Fetched Lab Inventory for view page:",P),a(P||[])}catch(E){console.error("Error fetching lab inventory:",E),d(P=>P?`${P} & Failed to load lab inventory.`:"Failed to load lab inventory.")}finally{l(!1)}})()},[]);const k=w.useMemo(()=>{let T=n;return u&&(T=T.filter(E=>E.name.toLowerCase().includes(u.toLowerCase()))),g!=="all"&&(T=T.filter(E=>{const P=(E.quantity_in_stock??1/0)<=v;let I=!1,q=!1;if(E.expiry_date)try{const $=Nb(E.expiry_date);if(mg($)){const L=R1(new Date,S),F=new Date;F.setHours(0,0,0,0),q=Fd($,F),I=!q&&Fd($,L)}}catch($){console.error("Error parsing expiry date for filter:",E.expiry_date,$),I=!0}else I=!0;switch(g){case"low-stock":return P;case"near-expiry":return I;case"expired":return q;default:return!0}})),T},[n,u,g]);return i.jsxs("div",{className:"lab-inventory-container",children:[i.jsxs("div",{className:"lab-inventory-header",children:[i.jsx("h1",{children:"Inventory Overview"}),i.jsxs("button",{onClick:()=>e(-1),className:"lab-inventory-button lab-inventory-button-secondary",title:"Go Back",children:[i.jsx(on,{size:18,style:{marginRight:"5px"}})," Back"]})]}),o&&i.jsx("p",{className:"loading-text",children:"Loading inventory..."}),h&&i.jsx("p",{className:"error-text",children:h}),!o&&!h&&i.jsxs("div",{className:"inventory-sections-container",children:[i.jsxs("div",{className:"lab-inventory-card",children:[" ",i.jsxs("div",{className:"inventory-section__header-bar",children:[i.jsxs("h2",{className:"lab-inventory-header",children:[i.jsx(go,{size:24,style:{marginRight:"10px",verticalAlign:"middle"}})," Pharmacy Inventory"]}),i.jsxs("div",{className:"inventory-section__controls",children:[" ",i.jsxs("div",{className:"inventory-section__search-area",children:[i.jsx("input",{type:"text",placeholder:"Search drugs...",value:u,onChange:T=>f(T.target.value),className:"lab-inventory-input",style:{marginRight:"5px",marginBottom:"0"}}),i.jsx(Ai,{size:18,style:{color:"#777"}})]}),i.jsxs("div",{className:"inventory-section__filter-area",children:[" ",i.jsxs("select",{value:g,onChange:T=>b(T.target.value),className:"lab-inventory-select",children:[i.jsx("option",{value:"all",children:"All Drugs"}),i.jsx("option",{value:"low-stock",children:"Low Stock"}),i.jsx("option",{value:"near-expiry",children:"Near Expiry"}),i.jsx("option",{value:"expired",children:"Expired"})]})]})]})]}),k.length>0?i.jsxs("div",{className:"table-container",children:[" ",i.jsxs("div",{className:"table-scroll-wrapper",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Stock"}),i.jsx("th",{children:"Expiry Date"}),i.jsx("th",{children:"Buying Price"}),i.jsx("th",{children:"Selling Price"})]})}),i.jsx("tbody",{children:k.map(T=>{let E="N/A",P="";const I=(T.quantity_in_stock??1/0)<=v;if(T.expiry_date)try{const q=Nb(T.expiry_date);if(mg(q)){E=_r(q,"dd/MM/yyyy");const $=R1(new Date,1),L=new Date;L.setHours(0,0,0,0),Fd(q,L)?P="highlight-expired":Fd(q,$)&&(P="highlight-near-expiry")}else E="Invalid Date",P="highlight-near-expiry"}catch(q){console.error("Error parsing expiry date:",T.expiry_date,q),E="Error Parsing",P="highlight-near-expiry"}else P="highlight-near-expiry";return i.jsxs("tr",{children:[i.jsx("td",{children:T.name}),i.jsx("td",{children:i.jsx("span",{className:`highlight-box ${I?"highlight-low-stock":""}`,children:T.quantity_in_stock??"N/A"})}),i.jsx("td",{children:i.jsx("span",{className:`highlight-box ${P}`,children:E})}),i.jsx("td",{className:"price-text",children:T.buying_price?`${T.buying_price}`:"N/A"}),i.jsx("td",{className:"price-text",children:T.price?`${T.price}`:"N/A"})]},T.id)})})]})]})]}):i.jsx("p",{className:"no-data-message",children:u?`No drugs found matching "${u}".`:"No pharmacy inventory data available."})]}),i.jsxs("div",{className:"lab-inventory-card",children:[" ",i.jsxs("h2",{className:"lab-inventory-header inventory-section__lab-title",children:[i.jsx(Db,{size:24,style:{marginRight:"10px",verticalAlign:"middle"}})," Lab Test Inventory"]}),r.length>0?i.jsxs("div",{className:"table-container",children:[" ",i.jsxs("div",{className:"table-scroll-wrapper",children:[" ",i.jsxs("table",{className:"lab-inventory-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"})]})}),i.jsx("tbody",{children:r.map(T=>i.jsxs("tr",{children:[i.jsx("td",{children:T.name}),i.jsx("td",{className:"price-text",children:T.price?`${T.price}`:"N/A"})]},T.id))})]})]})]}):i.jsx("p",{className:"no-data-message",children:"No lab test inventory data available."})]})]})]})},rne=()=>{const e=Ot(),[n,t]=w.useState("pharmacy");return i.jsxs("div",{className:"inventory-management-page",children:[i.jsxs("div",{className:"page-header",children:[i.jsxs("div",{className:"inventory-header-left",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:i.jsx(on,{size:20})}),i.jsx("h1",{children:"Inventory Management"})]}),i.jsx("div",{className:"header-spacer"}),i.jsxs("div",{className:"tab-switcher",children:[i.jsxs("button",{onClick:()=>t("pharmacy"),className:`tab-button ${n==="pharmacy"?"active":""}`,children:[i.jsx(go,{size:16})," Pharmacy Stock"]}),i.jsxs("button",{onClick:()=>t("lab"),className:`tab-button ${n==="lab"?"active":""}`,children:[i.jsx(Db,{size:16})," Lab Stock"]})]})]}),i.jsx("div",{className:"inventory-content",children:n==="pharmacy"?i.jsx(IT,{}):i.jsx(Jb,{showHeader:!1})})]})},ane=()=>{var k,T,E,P,I,q,$,L,F,z,B,R,U,Y;const{patientId:e,billId:n}=Yr(),t=Ot(),[r,a]=w.useState(null),[o,l]=w.useState(!0),[h,d]=w.useState(null),[u,f]=w.useState(""),[g,b]=w.useState("cash"),v=((k=r==null?void 0:r.patient)==null?void 0:k.insurance_type)==="no_cash_insurance";w.useEffect(()=>{b(v?"no_cash_insurance":"cash")},[v]),w.useEffect(()=>{n?(async()=>{l(!0),d(null);try{const ne=await de(`/api/bills/${n}`);if(!ne.ok)throw new Error(`HTTP error! status: ${ne.status}`);const ae=await ne.json();if(!ae||!ae.bill||!ae.calculated)throw new Error("Incomplete data structure received from backend (missing bill or calculated fields).");if(ae.bill.type!=="admission")throw console.error("Fetched bill is not an admission bill. Bill Type:",ae.bill.type),new Error(`Unexpected bill type received: ${ae.bill.type}. Expected 'admission'.`);console.log("Raw API data received:",JSON.stringify(ae,null,2));const X=Array.isArray(ae.admissionPayments)?ae.admissionPayments:[];console.log("Processed admissionPaymentsData:",X);const W={...ae.bill,amount:ae.bill.amount,AdmissionPayments:X,calculated:ae.calculated,patient:ae.bill.Patient?{id:ae.bill.Patient.id,name:ae.bill.Patient.name,admission_date:ae.bill.Patient.admission_date,discharge_date:ae.bill.Patient.discharge_date}:void 0};console.log("Setting billDetails state to:",JSON.stringify(W,null,2)),a(W)}catch(ne){console.error("Failed to fetch admission bill details:",ne),d(ne instanceof Error?ne.message:"An unknown error occurred")}finally{l(!1)}})():(d("Bill ID is missing."),l(!1))},[n,e]);const S=async Z=>{var ne;if(Z.preventDefault(),!e||!u||isNaN(parseFloat(u))||parseFloat(u)<=0||parseFloat(u)>(((ne=r==null?void 0:r.calculated)==null?void 0:ne.balance)??0)){d("Please enter a valid payment amount within the balance due. Patient ID must be present.");return}d(null);try{const ae=await de(`/api/patients/${e}/admission-payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount_paid:parseFloat(u),payment_mode:g})});if(!ae.ok){const H=await ae.json();throw new Error(H.message||`HTTP error! status: ${ae.status}`)}const W=await(await de(`/api/bills/${n}`)).json();if(W&&W.bill&&W.calculated&&W.admissionPayments)a({...W.bill,amount:parseFloat(W.bill.amount),AdmissionPayments:W.admissionPayments,calculated:W.calculated,patient:W.bill.Patient?{id:W.bill.Patient.id,name:W.bill.Patient.name,admission_date:W.bill.Patient.admission_date,discharge_date:W.bill.Patient.discharge_date}:void 0});else throw new Error("Invalid data structure received after payment submission.");f("")}catch(ae){console.error("Failed to submit payment:",ae),d(ae instanceof Error?ae.message:"Failed to record payment")}};return o?i.jsx("div",{className:"p-4",children:"Loading admission bill details..."}):h?i.jsxs("div",{className:"p-4 text-red-600",children:["Error: ",h]}):!r||!r.calculated?i.jsx("div",{className:"p-4",children:"No bill details found or data is incomplete."}):i.jsx("div",{className:"admission-page-container",children:i.jsxs("div",{className:"admission-section",children:[" ",i.jsxs("div",{className:"p-4 border-b",children:[" ",i.jsxs("h2",{className:"admission-header",children:["Admission Billing Details (Bill #",r.id,")"]}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Patient: ",((T=r.patient)==null?void 0:T.name)??"N/A"," (ID: ",r.patient_id,")"]})," ",i.jsxs("p",{className:"text-sm text-gray-600",children:["Admission Date: ",(E=r.patient)!=null&&E.admission_date?new Date(r.patient.admission_date).toLocaleDateString():"N/A"]}),((P=r.patient)==null?void 0:P.discharge_date)&&i.jsxs("p",{className:"text-sm text-gray-600",children:["Discharge Date: ",new Date(r.patient.discharge_date).toLocaleDateString()]}),i.jsxs("p",{className:"text-sm",children:["Status: ",i.jsx("span",{className:`font-semibold ${r.status==="paid"?"text-green-600":"text-orange-600"}`,children:((I=r.status)==null?void 0:I.toUpperCase())??"UNKNOWN"})]})]}),i.jsxs("div",{className:"p-4",children:[" ",i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),i.jsxs("div",{className:"admission-card-content",children:[i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Initial Charges:"})," ",i.jsxs("span",{children:["",(parseFloat((r==null?void 0:r.amount)||"0")||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Days Stayed:"})," ",i.jsx("span",{children:((q=r==null?void 0:r.calculated)==null?void 0:q.daysStayed)??0})]}),i.jsxs("p",{className:"flex justify-between text-sm font-semibold mt-2 pt-2 border-t",children:[i.jsx("span",{children:"Total Due:"})," ",i.jsxs("span",{children:["",(Number(($=r==null?void 0:r.calculated)==null?void 0:$.totalDue)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[i.jsx("span",{children:"Total Paid:"})," ",i.jsxs("span",{children:["",(Number((L=r==null?void 0:r.calculated)==null?void 0:L.totalPaid)||0).toFixed(2)]})]}),i.jsxs("p",{className:"flex justify-between text-lg font-bold mt-1 text-red-600",children:[i.jsx("span",{children:"Balance Due:"})," ",i.jsxs("span",{children:["",(Number((F=r==null?void 0:r.calculated)==null?void 0:F.balance)||0).toFixed(2)]})]})]})]}),(r==null?void 0:r.status)!=="paid"&&(Number((z=r==null?void 0:r.calculated)==null?void 0:z.balance)||0)>0&&i.jsxs("div",{className:"admission-card",children:[i.jsx("h3",{className:"admission-card-title text-blue-800",children:"Record New Payment"}),i.jsxs("form",{onSubmit:S,className:"space-y-4",children:[i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentAmount",className:"admission-label",children:"Amount Paid ()"}),i.jsx("input",{id:"paymentAmount",type:"number",value:u,onChange:Z=>f(Z.target.value),onBlur:Z=>{Z.target.value===""&&f("0")},placeholder:`Max ${(Number((B=r==null?void 0:r.calculated)==null?void 0:B.balance)||0).toFixed(2)}`,required:!0,min:"0.01",step:"0.01",max:Number((R=r==null?void 0:r.calculated)==null?void 0:R.balance)||0,className:"admission-input"})]}),i.jsxs("div",{className:"admission-form-group",children:[i.jsx("label",{htmlFor:"paymentMode",className:"admission-label",children:"Payment Mode"}),i.jsxs("select",{id:"paymentMode",value:g,onChange:Z=>b(Z.target.value),className:"admission-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"upi",children:"UPI"}),v&&i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),i.jsx("button",{type:"submit",className:"admission-button",disabled:o||!u||parseFloat(u)<=0||parseFloat(u)>(Number((U=r==null?void 0:r.calculated)==null?void 0:U.balance)||0)||v&&g!=="no_cash_insurance",children:"Record Payment"})]})]})]}),i.jsx("h3",{className:"admission-section-title mt-6 border-t pt-4",children:"Admission Payment History"}),Array.isArray(r==null?void 0:r.AdmissionPayments)&&r.AdmissionPayments.length>0?i.jsxs("div",{className:"overflow-x-auto",children:[" ",i.jsxs("table",{className:"admission-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Payment ID"}),i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Mode"})]})}),i.jsx("tbody",{children:(Y=r==null?void 0:r.AdmissionPayments)==null?void 0:Y.map(Z=>{if(!Z||typeof Z!="object")return null;let ne="Invalid Date";try{Z.payment_date&&!isNaN(new Date(Z.payment_date).getTime())&&(ne=new Date(Z.payment_date).toLocaleString())}catch(ae){console.error("Error formatting payment date:",Z.payment_date,ae)}return i.jsxs("tr",{children:[" ",i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Z.id??"N/A"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:ne}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["",(Number(Z.amount_paid)||0).toFixed(2)]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:Z.payment_mode??"N/A"})]},Z.id??Math.random())})})]})]}):i.jsx("p",{className:"text-gray-500 text-sm",children:"No payments recorded yet."})]}),i.jsxs("div",{className:"p-4 border-t bg-gray-50 text-right",children:[" ",i.jsx("button",{type:"button",onClick:()=>t(-1),className:"admission-button admission-button-secondary",children:"Back"})]})]})})};var sne=Object.defineProperty,Cb=Object.getOwnPropertySymbols,RT=Object.prototype.hasOwnProperty,OT=Object.prototype.propertyIsEnumerable,dC=(e,n,t)=>n in e?sne(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,J1=(e,n)=>{for(var t in n||(n={}))RT.call(n,t)&&dC(e,t,n[t]);if(Cb)for(var t of Cb(n))OT.call(n,t)&&dC(e,t,n[t]);return e},K1=(e,n)=>{var t={};for(var r in e)RT.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&Cb)for(var r of Cb(e))n.indexOf(r)<0&&OT.call(e,r)&&(t[r]=e[r]);return t};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Ud;(e=>{const n=class Cn{constructor(d,u,f,g){if(this.version=d,this.errorCorrectionLevel=u,this.modules=[],this.isFunction=[],d<Cn.MIN_VERSION||d>Cn.MAX_VERSION)throw new RangeError("Version value out of range");if(g<-1||g>7)throw new RangeError("Mask value out of range");this.size=d*4+17;let b=[];for(let S=0;S<this.size;S++)b.push(!1);for(let S=0;S<this.size;S++)this.modules.push(b.slice()),this.isFunction.push(b.slice());this.drawFunctionPatterns();const v=this.addEccAndInterleave(f);if(this.drawCodewords(v),g==-1){let S=1e9;for(let k=0;k<8;k++){this.applyMask(k),this.drawFormatBits(k);const T=this.getPenaltyScore();T<S&&(g=k,S=T),this.applyMask(k)}}a(0<=g&&g<=7),this.mask=g,this.applyMask(g),this.drawFormatBits(g),this.isFunction=[]}static encodeText(d,u){const f=e.QrSegment.makeSegments(d);return Cn.encodeSegments(f,u)}static encodeBinary(d,u){const f=e.QrSegment.makeBytes(d);return Cn.encodeSegments([f],u)}static encodeSegments(d,u,f=1,g=40,b=-1,v=!0){if(!(Cn.MIN_VERSION<=f&&f<=g&&g<=Cn.MAX_VERSION)||b<-1||b>7)throw new RangeError("Invalid value");let S,k;for(S=f;;S++){const I=Cn.getNumDataCodewords(S,u)*8,q=l.getTotalBits(d,S);if(q<=I){k=q;break}if(S>=g)throw new RangeError("Data too long")}for(const I of[Cn.Ecc.MEDIUM,Cn.Ecc.QUARTILE,Cn.Ecc.HIGH])v&&k<=Cn.getNumDataCodewords(S,I)*8&&(u=I);let T=[];for(const I of d){t(I.mode.modeBits,4,T),t(I.numChars,I.mode.numCharCountBits(S),T);for(const q of I.getData())T.push(q)}a(T.length==k);const E=Cn.getNumDataCodewords(S,u)*8;a(T.length<=E),t(0,Math.min(4,E-T.length),T),t(0,(8-T.length%8)%8,T),a(T.length%8==0);for(let I=236;T.length<E;I^=253)t(I,8,T);let P=[];for(;P.length*8<T.length;)P.push(0);return T.forEach((I,q)=>P[q>>>3]|=I<<7-(q&7)),new Cn(S,u,P,b)}getModule(d,u){return 0<=d&&d<this.size&&0<=u&&u<this.size&&this.modules[u][d]}getModules(){return this.modules}drawFunctionPatterns(){for(let f=0;f<this.size;f++)this.setFunctionModule(6,f,f%2==0),this.setFunctionModule(f,6,f%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const d=this.getAlignmentPatternPositions(),u=d.length;for(let f=0;f<u;f++)for(let g=0;g<u;g++)f==0&&g==0||f==0&&g==u-1||f==u-1&&g==0||this.drawAlignmentPattern(d[f],d[g]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(d){const u=this.errorCorrectionLevel.formatBits<<3|d;let f=u;for(let b=0;b<10;b++)f=f<<1^(f>>>9)*1335;const g=(u<<10|f)^21522;a(g>>>15==0);for(let b=0;b<=5;b++)this.setFunctionModule(8,b,r(g,b));this.setFunctionModule(8,7,r(g,6)),this.setFunctionModule(8,8,r(g,7)),this.setFunctionModule(7,8,r(g,8));for(let b=9;b<15;b++)this.setFunctionModule(14-b,8,r(g,b));for(let b=0;b<8;b++)this.setFunctionModule(this.size-1-b,8,r(g,b));for(let b=8;b<15;b++)this.setFunctionModule(8,this.size-15+b,r(g,b));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let d=this.version;for(let f=0;f<12;f++)d=d<<1^(d>>>11)*7973;const u=this.version<<12|d;a(u>>>18==0);for(let f=0;f<18;f++){const g=r(u,f),b=this.size-11+f%3,v=Math.floor(f/3);this.setFunctionModule(b,v,g),this.setFunctionModule(v,b,g)}}drawFinderPattern(d,u){for(let f=-4;f<=4;f++)for(let g=-4;g<=4;g++){const b=Math.max(Math.abs(g),Math.abs(f)),v=d+g,S=u+f;0<=v&&v<this.size&&0<=S&&S<this.size&&this.setFunctionModule(v,S,b!=2&&b!=4)}}drawAlignmentPattern(d,u){for(let f=-2;f<=2;f++)for(let g=-2;g<=2;g++)this.setFunctionModule(d+g,u+f,Math.max(Math.abs(g),Math.abs(f))!=1)}setFunctionModule(d,u,f){this.modules[u][d]=f,this.isFunction[u][d]=!0}addEccAndInterleave(d){const u=this.version,f=this.errorCorrectionLevel;if(d.length!=Cn.getNumDataCodewords(u,f))throw new RangeError("Invalid argument");const g=Cn.NUM_ERROR_CORRECTION_BLOCKS[f.ordinal][u],b=Cn.ECC_CODEWORDS_PER_BLOCK[f.ordinal][u],v=Math.floor(Cn.getNumRawDataModules(u)/8),S=g-v%g,k=Math.floor(v/g);let T=[];const E=Cn.reedSolomonComputeDivisor(b);for(let I=0,q=0;I<g;I++){let $=d.slice(q,q+k-b+(I<S?0:1));q+=$.length;const L=Cn.reedSolomonComputeRemainder($,E);I<S&&$.push(0),T.push($.concat(L))}let P=[];for(let I=0;I<T[0].length;I++)T.forEach((q,$)=>{(I!=k-b||$>=S)&&P.push(q[I])});return a(P.length==v),P}drawCodewords(d){if(d.length!=Math.floor(Cn.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let u=0;for(let f=this.size-1;f>=1;f-=2){f==6&&(f=5);for(let g=0;g<this.size;g++)for(let b=0;b<2;b++){const v=f-b,k=(f+1&2)==0?this.size-1-g:g;!this.isFunction[k][v]&&u<d.length*8&&(this.modules[k][v]=r(d[u>>>3],7-(u&7)),u++)}}a(u==d.length*8)}applyMask(d){if(d<0||d>7)throw new RangeError("Mask value out of range");for(let u=0;u<this.size;u++)for(let f=0;f<this.size;f++){let g;switch(d){case 0:g=(f+u)%2==0;break;case 1:g=u%2==0;break;case 2:g=f%3==0;break;case 3:g=(f+u)%3==0;break;case 4:g=(Math.floor(f/3)+Math.floor(u/2))%2==0;break;case 5:g=f*u%2+f*u%3==0;break;case 6:g=(f*u%2+f*u%3)%2==0;break;case 7:g=((f+u)%2+f*u%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[u][f]&&g&&(this.modules[u][f]=!this.modules[u][f])}}getPenaltyScore(){let d=0;for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[b][T]==v?(S++,S==5?d+=Cn.PENALTY_N1:S>5&&d++):(this.finderPenaltyAddHistory(S,k),v||(d+=this.finderPenaltyCountPatterns(k)*Cn.PENALTY_N3),v=this.modules[b][T],S=1);d+=this.finderPenaltyTerminateAndCount(v,S,k)*Cn.PENALTY_N3}for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[T][b]==v?(S++,S==5?d+=Cn.PENALTY_N1:S>5&&d++):(this.finderPenaltyAddHistory(S,k),v||(d+=this.finderPenaltyCountPatterns(k)*Cn.PENALTY_N3),v=this.modules[T][b],S=1);d+=this.finderPenaltyTerminateAndCount(v,S,k)*Cn.PENALTY_N3}for(let b=0;b<this.size-1;b++)for(let v=0;v<this.size-1;v++){const S=this.modules[b][v];S==this.modules[b][v+1]&&S==this.modules[b+1][v]&&S==this.modules[b+1][v+1]&&(d+=Cn.PENALTY_N2)}let u=0;for(const b of this.modules)u=b.reduce((v,S)=>v+(S?1:0),u);const f=this.size*this.size,g=Math.ceil(Math.abs(u*20-f*10)/f)-1;return a(0<=g&&g<=9),d+=g*Cn.PENALTY_N4,a(0<=d&&d<=2568888),d}getAlignmentPatternPositions(){if(this.version==1)return[];{const d=Math.floor(this.version/7)+2,u=this.version==32?26:Math.ceil((this.version*4+4)/(d*2-2))*2;let f=[6];for(let g=this.size-7;f.length<d;g-=u)f.splice(1,0,g);return f}}static getNumRawDataModules(d){if(d<Cn.MIN_VERSION||d>Cn.MAX_VERSION)throw new RangeError("Version number out of range");let u=(16*d+128)*d+64;if(d>=2){const f=Math.floor(d/7)+2;u-=(25*f-10)*f-55,d>=7&&(u-=36)}return a(208<=u&&u<=29648),u}static getNumDataCodewords(d,u){return Math.floor(Cn.getNumRawDataModules(d)/8)-Cn.ECC_CODEWORDS_PER_BLOCK[u.ordinal][d]*Cn.NUM_ERROR_CORRECTION_BLOCKS[u.ordinal][d]}static reedSolomonComputeDivisor(d){if(d<1||d>255)throw new RangeError("Degree out of range");let u=[];for(let g=0;g<d-1;g++)u.push(0);u.push(1);let f=1;for(let g=0;g<d;g++){for(let b=0;b<u.length;b++)u[b]=Cn.reedSolomonMultiply(u[b],f),b+1<u.length&&(u[b]^=u[b+1]);f=Cn.reedSolomonMultiply(f,2)}return u}static reedSolomonComputeRemainder(d,u){let f=u.map(g=>0);for(const g of d){const b=g^f.shift();f.push(0),u.forEach((v,S)=>f[S]^=Cn.reedSolomonMultiply(v,b))}return f}static reedSolomonMultiply(d,u){if(d>>>8||u>>>8)throw new RangeError("Byte out of range");let f=0;for(let g=7;g>=0;g--)f=f<<1^(f>>>7)*285,f^=(u>>>g&1)*d;return a(f>>>8==0),f}finderPenaltyCountPatterns(d){const u=d[1];a(u<=this.size*3);const f=u>0&&d[2]==u&&d[3]==u*3&&d[4]==u&&d[5]==u;return(f&&d[0]>=u*4&&d[6]>=u?1:0)+(f&&d[6]>=u*4&&d[0]>=u?1:0)}finderPenaltyTerminateAndCount(d,u,f){return d&&(this.finderPenaltyAddHistory(u,f),u=0),u+=this.size,this.finderPenaltyAddHistory(u,f),this.finderPenaltyCountPatterns(f)}finderPenaltyAddHistory(d,u){u[0]==0&&(d+=this.size),u.pop(),u.unshift(d)}};n.MIN_VERSION=1,n.MAX_VERSION=40,n.PENALTY_N1=3,n.PENALTY_N2=3,n.PENALTY_N3=40,n.PENALTY_N4=10,n.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],n.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=n;function t(h,d,u){if(d<0||d>31||h>>>d)throw new RangeError("Value out of range");for(let f=d-1;f>=0;f--)u.push(h>>>f&1)}function r(h,d){return(h>>>d&1)!=0}function a(h){if(!h)throw new Error("Assertion error")}const o=class Mi{constructor(d,u,f){if(this.mode=d,this.numChars=u,this.bitData=f,u<0)throw new RangeError("Invalid argument");this.bitData=f.slice()}static makeBytes(d){let u=[];for(const f of d)t(f,8,u);return new Mi(Mi.Mode.BYTE,d.length,u)}static makeNumeric(d){if(!Mi.isNumeric(d))throw new RangeError("String contains non-numeric characters");let u=[];for(let f=0;f<d.length;){const g=Math.min(d.length-f,3);t(parseInt(d.substring(f,f+g),10),g*3+1,u),f+=g}return new Mi(Mi.Mode.NUMERIC,d.length,u)}static makeAlphanumeric(d){if(!Mi.isAlphanumeric(d))throw new RangeError("String contains unencodable characters in alphanumeric mode");let u=[],f;for(f=0;f+2<=d.length;f+=2){let g=Mi.ALPHANUMERIC_CHARSET.indexOf(d.charAt(f))*45;g+=Mi.ALPHANUMERIC_CHARSET.indexOf(d.charAt(f+1)),t(g,11,u)}return f<d.length&&t(Mi.ALPHANUMERIC_CHARSET.indexOf(d.charAt(f)),6,u),new Mi(Mi.Mode.ALPHANUMERIC,d.length,u)}static makeSegments(d){return d==""?[]:Mi.isNumeric(d)?[Mi.makeNumeric(d)]:Mi.isAlphanumeric(d)?[Mi.makeAlphanumeric(d)]:[Mi.makeBytes(Mi.toUtf8ByteArray(d))]}static makeEci(d){let u=[];if(d<0)throw new RangeError("ECI assignment value out of range");if(d<128)t(d,8,u);else if(d<16384)t(2,2,u),t(d,14,u);else if(d<1e6)t(6,3,u),t(d,21,u);else throw new RangeError("ECI assignment value out of range");return new Mi(Mi.Mode.ECI,0,u)}static isNumeric(d){return Mi.NUMERIC_REGEX.test(d)}static isAlphanumeric(d){return Mi.ALPHANUMERIC_REGEX.test(d)}getData(){return this.bitData.slice()}static getTotalBits(d,u){let f=0;for(const g of d){const b=g.mode.numCharCountBits(u);if(g.numChars>=1<<b)return 1/0;f+=4+b+g.bitData.length}return f}static toUtf8ByteArray(d){d=encodeURI(d);let u=[];for(let f=0;f<d.length;f++)d.charAt(f)!="%"?u.push(d.charCodeAt(f)):(u.push(parseInt(d.substring(f+1,f+3),16)),f+=2);return u}};o.NUMERIC_REGEX=/^[0-9]*$/,o.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,o.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let l=o;e.QrSegment=o})(Ud||(Ud={}));(e=>{(n=>{const t=class{constructor(a,o){this.ordinal=a,this.formatBits=o}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),n.Ecc=t})(e.QrCode||(e.QrCode={}))})(Ud||(Ud={}));(e=>{(n=>{const t=class{constructor(a,o){this.modeBits=a,this.numBitsCharCount=o}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),n.Mode=t})(e.QrSegment||(e.QrSegment={}))})(Ud||(Ud={}));var If=Ud;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var one={L:If.QrCode.Ecc.LOW,M:If.QrCode.Ecc.MEDIUM,Q:If.QrCode.Ecc.QUARTILE,H:If.QrCode.Ecc.HIGH},LT=128,FT="L",$T="#FFFFFF",zT="#000000",BT=!1,UT=1,lne=4,cne=0,une=.1;function qT(e,n=0){const t=[];return e.forEach(function(r,a){let o=null;r.forEach(function(l,h){if(!l&&o!==null){t.push(`M${o+n} ${a+n}h${h-o}v1H${o+n}z`),o=null;return}if(h===r.length-1){if(!l)return;o===null?t.push(`M${h+n},${a+n} h1v1H${h+n}z`):t.push(`M${o+n},${a+n} h${h+1-o}v1H${o+n}z`);return}l&&o===null&&(o=h)})}),t.join("")}function VT(e,n){return e.slice().map((t,r)=>r<n.y||r>=n.y+n.h?t:t.map((a,o)=>o<n.x||o>=n.x+n.w?a:!1))}function dne(e,n,t,r){if(r==null)return null;const a=e.length+t*2,o=Math.floor(n*une),l=a/n,h=(r.width||o)*l,d=(r.height||o)*l,u=r.x==null?e.length/2-h/2:r.x*l,f=r.y==null?e.length/2-d/2:r.y*l,g=r.opacity==null?1:r.opacity;let b=null;if(r.excavate){let S=Math.floor(u),k=Math.floor(f),T=Math.ceil(h+u-S),E=Math.ceil(d+f-k);b={x:S,y:k,w:T,h:E}}const v=r.crossOrigin;return{x:u,y:f,h:d,w:h,excavation:b,opacity:g,crossOrigin:v}}function hne(e,n){return n!=null?Math.max(Math.floor(n),0):e?lne:cne}function HT({value:e,level:n,minVersion:t,includeMargin:r,marginSize:a,imageSettings:o,size:l,boostLevel:h}){let d=Pn.useMemo(()=>{const S=(Array.isArray(e)?e:[e]).reduce((k,T)=>(k.push(...If.QrSegment.makeSegments(T)),k),[]);return If.QrCode.encodeSegments(S,one[n],t,void 0,void 0,h)},[e,n,t,h]);const{cells:u,margin:f,numCells:g,calculatedImageSettings:b}=Pn.useMemo(()=>{let v=d.getModules();const S=hne(r,a),k=v.length+S*2,T=dne(v,l,S,o);return{cells:v,margin:S,numCells:k,calculatedImageSettings:T}},[d,l,o,r,a]);return{qrcode:d,margin:f,cells:u,numCells:g,calculatedImageSettings:b}}var fne=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),Qf=Pn.forwardRef(function(n,t){const r=n,{value:a,size:o=LT,level:l=FT,bgColor:h=$T,fgColor:d=zT,includeMargin:u=BT,minVersion:f=UT,boostLevel:g,marginSize:b,imageSettings:v}=r,k=K1(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:T}=k,E=K1(k,["style"]),P=v==null?void 0:v.src,I=Pn.useRef(null),q=Pn.useRef(null),$=Pn.useCallback(ne=>{I.current=ne,typeof t=="function"?t(ne):t&&(t.current=ne)},[t]),[L,F]=Pn.useState(!1),{margin:z,cells:B,numCells:R,calculatedImageSettings:U}=HT({value:a,level:l,minVersion:f,boostLevel:g,includeMargin:u,marginSize:b,imageSettings:v,size:o});Pn.useEffect(()=>{if(I.current!=null){const ne=I.current,ae=ne.getContext("2d");if(!ae)return;let X=B;const W=q.current,H=U!=null&&W!==null&&W.complete&&W.naturalHeight!==0&&W.naturalWidth!==0;H&&U.excavation!=null&&(X=VT(B,U.excavation));const he=window.devicePixelRatio||1;ne.height=ne.width=o*he;const D=o/R*he;ae.scale(D,D),ae.fillStyle=h,ae.fillRect(0,0,R,R),ae.fillStyle=d,fne?ae.fill(new Path2D(qT(X,z))):B.forEach(function(te,ve){te.forEach(function(M,ge){M&&ae.fillRect(ge+z,ve+z,1,1)})}),U&&(ae.globalAlpha=U.opacity),H&&ae.drawImage(W,U.x+z,U.y+z,U.w,U.h)}}),Pn.useEffect(()=>{F(!1)},[P]);const Y=J1({height:o,width:o},T);let Z=null;return P!=null&&(Z=Pn.createElement("img",{src:P,key:P,style:{display:"none"},onLoad:()=>{F(!0)},ref:q,crossOrigin:U==null?void 0:U.crossOrigin})),Pn.createElement(Pn.Fragment,null,Pn.createElement("canvas",J1({style:Y,height:o,width:o,ref:$,role:"img"},E)),Z)});Qf.displayName="QRCodeCanvas";var pne=Pn.forwardRef(function(n,t){const r=n,{value:a,size:o=LT,level:l=FT,bgColor:h=$T,fgColor:d=zT,includeMargin:u=BT,minVersion:f=UT,boostLevel:g,title:b,marginSize:v,imageSettings:S}=r,k=K1(r,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:T,cells:E,numCells:P,calculatedImageSettings:I}=HT({value:a,level:l,minVersion:f,boostLevel:g,includeMargin:u,marginSize:v,imageSettings:S,size:o});let q=E,$=null;S!=null&&I!=null&&(I.excavation!=null&&(q=VT(E,I.excavation)),$=Pn.createElement("image",{href:S.src,height:I.h,width:I.w,x:I.x+T,y:I.y+T,preserveAspectRatio:"none",opacity:I.opacity,crossOrigin:I.crossOrigin}));const L=qT(q,T);return Pn.createElement("svg",J1({height:o,width:o,viewBox:`0 0 ${P} ${P}`,ref:t,role:"img"},k),!!b&&Pn.createElement("title",null,b),Pn.createElement("path",{fill:h,d:`M0,0 h${P}v${P}H0z`,shapeRendering:"crispEdges"}),Pn.createElement("path",{fill:d,d:L,shapeRendering:"crispEdges"}),$)});pne.displayName="QRCodeSVG";const mne=e=>{switch(e){case"pending":return{text:"text-orange-700",bg:"bg-orange-100"};case"billed":return{text:"text-blue-700",bg:"bg-blue-100"};case"dispensed":return{text:"text-green-700",bg:"bg-green-100"};case"cancelled":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},gne=()=>{const{orderId:e}=Yr(),n=Ot(),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,h]=w.useState(null),[d,u]=w.useState(!1),[f,g]=w.useState({}),[b,v]=w.useState(""),[S,k]=w.useState(""),[T,E]=w.useState("cash"),P=w.useMemo(()=>(t==null?void 0:t.medications.reduce((U,Y)=>{const Z=Y.total_price??0,ne=Z*(Y.discount_percentage??0)/100;return U+Z-ne},0))??0,[t==null?void 0:t.medications]),I=5,q=w.useMemo(()=>!t||!t.medications?0:t.medications.reduce((U,Y,Z)=>{var he,D;const ne=Y.drug_id??`index-${Z}`,ae=((he=f[ne])==null?void 0:he.pack)||0,X=((D=f[ne])==null?void 0:D.loose)||0,W=Y.pack_price??0,H=Y.loose_price??0;return U+ae*W+X*H},0),[t,f]),$=w.useCallback(async()=>{if(!e){h("Order ID is missing."),o(!1);return}o(!0),h(null);try{const U=await de(`/api/pharmacy-orders/${e}`);if(!U.ok)throw U.status===404?new Error(`Order with ID ${e} not found.`):new Error(`Failed to fetch order details: ${U.statusText} (${U.status})`);const Y=await U.json();console.log("Fetched order data after return:",Y);const ne=Y.medications.map(X=>X.pack_price&&X.loose_price&&X.loose_price>0?{...X,unitsPerPack:Math.round(X.pack_price/X.loose_price)}:{...X,unitsPerPack:0}).map(X=>({...X,discount_percentage:X.discount_percentage??0}));r({...Y,medications:ne});const ae={};ne.forEach((X,W)=>{const H=X.drug_id??`index-${W}`;ae[H]={pack:0,loose:0}}),g(ae)}catch(U){console.error("Failed to fetch order details:",U),h(U.message||"Failed to load order details.")}finally{o(!1)}},[e]);w.useEffect(()=>{$()},[$]),w.useEffect(()=>{(async()=>{try{const Y=await de("/api/clinics/settings");if(!Y.ok)throw new Error("Failed to fetch clinic settings");const Z=await Y.json();console.log("Fetched clinic settings:",Z),v(Z.upi_id||"")}catch(Y){console.error("Error fetching clinic settings:",Y)}})()},[]),w.useEffect(()=>{if((t==null?void 0:t.order_total)!==void 0&&t.order_total>0&&b){const U=`upi://pay?pa=${b}&pn=ClinicName&am=${t.order_total.toFixed(2)}&cu=INR`;k(U)}else k("")},[t==null?void 0:t.order_total,b]);const L=(U,Y)=>{r(Z=>{if(!Z)return null;const ne=Z.medications.map((X,W)=>(X.drug_id??`index-${W}`)===U?{...X,discount_percentage:isNaN(Y)?0:Y}:X),ae=ne.reduce((X,W)=>{const H=W.total_price??0,he=H*(W.discount_percentage??0)/100;return X+H-he},0);return{...Z,medications:ne,order_total:ae}})},F=(U,Y,Z)=>{g(ne=>{const ae=Z.unitsPerPack||0,W=Z.pack_quantity*ae+Z.loose_quantity,H=Math.max(0,Math.min(Y,W));let he=0,D=H;return ae>0&&(he=Math.floor(H/ae),D=H%ae),{...ne,[U]:{pack:he,loose:D}}})},z=async()=>{const U=t==null?void 0:t.medications.map((Y,Z)=>{var W,H;const ne=Y.drug_id??`index-${Z}`,ae=((W=f[ne])==null?void 0:W.pack)||0,X=((H=f[ne])==null?void 0:H.loose)||0;return ae>0||X>0?{drug_id:Y.drug_id,name:Y.name,pack_quantity:Y.pack_quantity,loose_quantity:Y.loose_quantity,returnPackQuantity:ae,returnLooseQuantity:X}:null}).filter(Y=>Y!==null);if(!U||U.length===0){alert("Please select a quantity greater than 0 for at least one item to return.");return}if(!e){alert("Order ID is missing. Cannot process return.");return}if(!U){alert("Could not prepare items for return.");return}u(!0),h(null);try{const Y=await de(`/api/pharmacy-orders/${e}/return`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemsToReturn:U})}),Z=await Y.json();if(!Y.ok)throw new Error(Z.message||`Failed to process return: ${Y.statusText}`);alert("Return processed successfully! Stock has been updated.");const ne={};t==null||t.medications.forEach((ae,X)=>{const W=ae.drug_id??`index-${X}`;ne[W]={pack:0,loose:0}}),g(ne),$()}catch(Y){console.error("Failed to process return:",Y),h(Y.message||"An error occurred while processing the return."),alert(`Error processing return: ${Y.message||"Unknown error"}`)}finally{u(!1)}};if(a)return i.jsx("div",{className:"text-center p-6 text-gray-500 animate-pulse",children:"Loading Order Details..."});if(l)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(on,{size:14,className:"mr-1.5"})," Back"]}),i.jsxs("div",{className:"bg-red-50 border border-red-300 text-red-700 rounded p-4",children:["Error: ",l]})]});if(!t)return i.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[i.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[i.jsx(on,{size:14,className:"mr-1.5"})," Back"]}),i.jsx("div",{className:"text-center py-10 px-4 text-gray-500 bg-white rounded-lg shadow",children:"Order details could not be loaded."})]});const B=()=>{window.print()},R=mne(t.status);return i.jsx("div",{className:"pharmacy-order-details-page",children:i.jsxs("div",{className:"order-details-container printable-section",children:[i.jsxs("div",{className:"order-details-header no-print",children:[i.jsx("h1",{children:"Pharmacy Order Details"}),i.jsxs("div",{className:"actions",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:[i.jsx(on,{size:18})," Back to Queue"]}),i.jsxs("button",{onClick:B,className:"print-button",children:[i.jsx(fo,{size:18})," Print Bill"]})]})]}),i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{children:"Mahajan Pharmacy"}),i.jsxs("div",{className:"clinic-details-print",children:[i.jsx("span",{className:"small-text clinic-address",children:"D.No: 3-1-289, Plot No. 101, Kabela Center, RR Nagar, Vijayawada  520012."}),i.jsx("span",{className:"small-text clinic-notes",children:"Phone: 93919 44733"}),i.jsx("span",{className:"small-text clinic-license",children:"Licence No:RLF20AP2025003328"})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Patient Name:"})," RESHMA"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Token:"})," 12"]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Order Date:"})," 31/10/2025"]})]})]}),i.jsxs("div",{className:"order-info-section no-print",children:[i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Order ID:"})," ",t.id]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Patient:"})," ",t.patientName||"N/A"," (",t.patientTokenNumber||"N/A",")"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Date:"})," ",new Date(t.date).toLocaleString()]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Prescribed By:"})," ",t.prescribedBy||"N/A"]}),i.jsxs("div",{className:"order-info-item",children:[i.jsx("strong",{children:"Status:"})," ",i.jsx("span",{className:`status-pill ${R.text} ${R.bg}`,children:t.status})]})]}),i.jsxs("div",{className:"medications-section",children:[i.jsx("h2",{children:"Medications Ordered"}),t.medications.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"PACK QTY"}),i.jsx("th",{children:"PACK PRICE"}),i.jsx("th",{children:"LOOSE QTY"}),i.jsx("th",{children:"LOOSE PRICE"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"no-print",children:"RETURN PACK QTY"}),i.jsx("th",{className:"no-print",children:"RETURN LOOSE QTY"})]})]})}),i.jsx("tbody",{children:t.medications.map((U,Y)=>{var he,D,te,ve,M,ge;const Z=U.drug_id??`index-${Y}`,ne=U.total_price??0,ae=ne*(U.discount_percentage??0)/100,X=ne-ae,W=((he=f[Z])==null?void 0:he.pack)||0,H=((D=f[Z])==null?void 0:D.loose)||0;return i.jsxs("tr",{children:[i.jsx("td",{children:U.name}),i.jsx("td",{children:U.pack_quantity??0}),i.jsx("td",{children:((te=U.pack_price)==null?void 0:te.toFixed(2))??"N/A"}),i.jsx("td",{children:U.loose_quantity??0}),i.jsx("td",{children:((ve=U.loose_price)==null?void 0:ve.toFixed(2))??"N/A"}),i.jsx("td",{children:((M=U.price)==null?void 0:M.toFixed(2))??"N/A"})," ",i.jsx("td",{children:((ge=U.price)==null?void 0:ge.toFixed(2))??"N/A"})," ",i.jsxs("td",{children:[i.jsx("input",{type:"number",value:U.discount_percentage??0,onChange:_e=>L(Z,parseFloat(_e.target.value)),min:"0",max:"100",className:"discount-input-table no-print"}),i.jsxs("span",{className:"print-only",children:[U.discount_percentage??0,"%"]})]}),i.jsxs("td",{children:[I.toFixed(1),"%"]}),i.jsx("td",{children:X.toFixed(2)}),(t.status==="dispensed"||t.status==="billed")&&i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:U.pack_quantity,value:W,onChange:_e=>{const ee=(parseInt(_e.target.value,10)||0)*(U.unitsPerPack||0)+H;F(Z,ee,U)},className:"return-quantity-input"})}),i.jsx("td",{className:"no-print",children:i.jsx("input",{type:"number",min:"0",max:U.loose_quantity+U.pack_quantity*(U.unitsPerPack||0)-W*(U.unitsPerPack||0),value:H,onChange:_e=>{const se=parseInt(_e.target.value,10)||0,ee=W*(U.unitsPerPack||0)+se;F(Z,ee,U)},className:"return-quantity-input"})})]})]},Z)})})]}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No medications listed for this order."})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",P.toFixed(2)]})}),i.jsxs("div",{className:"order-total-section no-print",children:[i.jsx("span",{className:"total-label",children:"Order Total:"}),i.jsxs("span",{className:"total-amount",children:["",P.toFixed(2)]})]}),i.jsxs("div",{className:"payment-section no-print",children:[i.jsxs("div",{className:"payment-mode-group",children:[i.jsx("label",{htmlFor:"paymentMode",children:"Payment Mode:"}),i.jsxs("select",{id:"paymentMode",value:T,onChange:U=>E(U.target.value),className:"payment-mode-select",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),S&&i.jsxs("div",{className:"qr-code-container",children:[i.jsx(Qf,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]})]}),(t.status==="dispensed"||t.status==="billed")&&t.medications.length>0&&i.jsxs("div",{className:"return-action-section no-print",children:[q>0&&i.jsxs("div",{className:"total-refund-display",children:["Total Refund: ",q.toFixed(2)]}),i.jsx("button",{onClick:z,disabled:Object.values(f).every(U=>U.pack===0&&U.loose===0)||d,className:"process-return-button",children:d?i.jsxs(i.Fragment,{children:[i.jsx(sc,{size:16,className:"mr-2 animate-spin"})," Processing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(sc,{size:16,className:"mr-2"})," Process Return"]})})]})]})})},yne=async()=>{const e=await de("/subscriptions");if(!e.ok)throw new Error("Failed to fetch subscription plans");return await e.json()},xne=async e=>{const n=await de(`/subscriptions/${e}`);if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to fetch subscription plan details"}));throw new Error(t.message||"Failed to fetch subscription plan details")}return await n.json()},bne=async e=>{const n=await de("/subscriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to create subscription plan"}));throw new Error(t.message||"Failed to create subscription plan")}return await n.json()},vne=async(e,n)=>{const t=await de(`/subscriptions/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to update subscription plan"}));throw new Error(r.message||"Failed to update subscription plan")}return await t.json()},wne=async e=>{const n=await de(`/subscriptions/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to deactivate subscription plan"}));throw new Error(t.message||"Failed to deactivate subscription plan")}return await n.json()},Nne=async(e,n)=>{const t=await de("/api/payment/razorpay-subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:e,planId:n})});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to initiate Razorpay subscription"}));throw new Error(r.message||"Failed to initiate Razorpay subscription")}return await t.json()},Sne=()=>{const e=Ot(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[o,l]=w.useState(null),[h,d]=w.useState(null),u=w.useCallback(async()=>{a(!0),l(null);try{const g=await yne();t(g)}catch(g){l(g.message||"Failed to fetch subscription plans."),d({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{u()},[u]),w.useEffect(()=>{if(h){const g=setTimeout(()=>d(null),5e3);return()=>clearTimeout(g)}},[h]);const f=async g=>{if(d(null),l(null),window.confirm("Are you sure you want to deactivate this plan? This action cannot be undone directly.")){a(!0),l(null),d(null);try{await wne(g),d({type:"success",message:"Plan deactivated successfully!"}),u()}catch(b){l(b.message||"Failed to deactivate plan."),d({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[h&&i.jsxs("div",{className:`${h.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[h.type==="success"?i.jsx(Ea,{size:18,className:"mr-2 text-green-500"}):i.jsx(ui,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:h.message})]}),i.jsx("button",{onClick:()=>d(null),className:`${h.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(In,{size:16})})]}),i.jsxs("div",{children:[" ",i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(on,{size:16}),"Back"]}),i.jsx("h1",{children:"Manage Subscription Plans"}),i.jsxs("button",{onClick:()=>e("/dashboard/subscriptions/add"),className:"subscription-btn",children:[i.jsx(hl,{size:16,className:"mr-1 inline-block"})," Add New Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading plans..."})]})}),!r&&o&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:o}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx($d,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>f(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(Hi,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!o&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No subscription plans found. Add one to get started!"})]})]})},jne=()=>{const e=Ot(),[n,t]=w.useState({name:"",description:"",price:"",period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[o,l]=w.useState(null),[h,d]=w.useState(null);w.useEffect(()=>{if(h){const b=setTimeout(()=>d(null),5e3);return()=>clearTimeout(b)}},[h]);const u=b=>{const{name:v,value:S}=b.target;t(k=>({...k,[v]:S}))},f=async b=>{if(b.preventDefault(),a(!0),l(null),d(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){l("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await bne(n),d({type:"success",message:"Plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create plan.";l(S),d({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[h&&i.jsxs("div",{className:`${h.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[h.type==="success"?i.jsx(Ea,{size:18,className:"mr-2 text-green-500"}):i.jsx(ui,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:h.message})]}),i.jsx("button",{onClick:()=>d(null),className:`${h.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(In,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Subscription Plan"}),o&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:o}),i.jsxs("form",{onSubmit:f,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:u})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:u,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:u,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:u})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},_ne=()=>{const{id:e}=Yr(),n=Ot(),[t,r]=w.useState(null),[a,o]=w.useState({}),[l,h]=w.useState(!1),[d,u]=w.useState(!0),[f,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),u(!1);return}u(!0),g(null);try{const P=await xne(e);r(P),o({name:P.name,description:P.description||"",price:P.price,period:P.period,interval:P.interval,razorpay_plan_id:P.razorpay_plan_id||"",status:P.status})}catch(P){g(P.message||"Failed to fetch plan details."),v({type:"error",message:P.message||"Failed to fetch plan details."})}finally{u(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const P=setTimeout(()=>v(null),5e3);return()=>clearTimeout(P)}},[b]);const k=P=>{const{name:I,value:q}=P.target;o($=>({...$,[I]:q}))},T=async P=>{if(P.preventDefault(),!e){g("Plan ID is missing.");return}if(h(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),h(!1);return}try{await vne(e,a),v({type:"success",message:"Plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(I){const q=I.message||"Failed to update plan.";g(q),v({type:"error",message:q})}finally{h(!1)}},E=()=>{n(-1)};return d?i.jsx("div",{className:"p-6 text-center",children:"Loading plan details..."}):f&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:f}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx(Ea,{size:18,className:"mr-2"}):i.jsx(ui,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(In,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Subscription Plan"}),f&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:f}),i.jsxs("form",{onSubmit:T,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval||1,onChange:k,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:E,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:l,className:"subscription-btn",children:[l?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,l?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Plan not found."})},Cne=()=>{const{patientId:e}=Yr(),n=Ot(),[t,r]=w.useState(null),[a,o]=w.useState([]),[l,h]=w.useState(""),[d,u]=w.useState(!0),[f,g]=w.useState(null),[b,v]=w.useState("manual"),[S,k]=w.useState(!1),[T,E]=w.useState(null),P=w.useCallback(async()=>{u(!0),g(null);try{const $=await de(`/api/patients/${e}`);if(!$.ok){const B=await $.json();throw new Error(B.message||"Failed to fetch patient details")}const L=await $.json();r(L);const F=await de("/api/subscriptions");if(!F.ok){const B=await F.json();throw new Error(B.message||"Failed to fetch subscription plans")}const z=await F.json();o(z.filter(B=>B.status==="active"))}catch($){console.error("Error fetching data:",$),g(`Failed to load data: ${$.message}`)}finally{u(!1)}},[e]);w.useEffect(()=>{e?P():(g("Patient ID is missing."),u(!1))},[e,P]);const I=($,L)=>{const F=new Date($),z=L.interval||1;switch(L.period){case"daily":F.setDate($.getDate()+z);break;case"weekly":F.setDate($.getDate()+z*7);break;case"monthly":F.setMonth($.getMonth()+z);break;case"yearly":F.setFullYear($.getFullYear()+z);break;default:console.warn(`Unknown subscription period: ${L.period}. Defaulting to 1 month.`),F.setMonth($.getMonth()+1)}return F},q=async()=>{if(!e||!l){E("Please select a subscription plan.");return}const $=a.find(L=>L.id===l);if(!$){E("Selected plan details not found.");return}k(!0),E(null);try{const L=new Date,F=I(L,$);if(b==="manual"){const z={subscription_plan_id:l,subscription_status:"active",subscription_start_date:L.toISOString(),subscription_end_date:F.toISOString(),subscription_payment_method:"manual"},B=await de(`/api/patients/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)});if(!B.ok){const R=await B.json();throw new Error(R.message||"Failed to start subscription manually")}alert(`Subscription started successfully for ${t==null?void 0:t.name} (Manual Payment)!`),n("/all-patients")}else if(b==="razorpay"){console.log("Initiating Razorpay subscription for plan:",$);const z=await Nne(e,l);if(z&&z.short_url)window.location.href=z.short_url;else throw new Error("Failed to get Razorpay subscription link from backend.")}}catch(L){console.error("Error starting subscription:",L),E(`Failed to start subscription: ${L.message}`),k(!1)}};return d?i.jsx("div",{className:"loading-state-subscription",children:"Loading patient and plans..."}):f?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:f})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(on,{size:16})," ","Back"]})]}):t?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(on,{size:16})," ","Back"]}),i.jsxs("h1",{children:[i.jsx(fl,{size:28})," ","Start Subscription for ",t.name]}),T&&i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[" ",i.jsx("span",{children:T})]}),i.jsxs("div",{className:"subscription-form",children:[" ",i.jsx("h2",{children:"Available Subscription Plans"}),a.length===0?i.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:a.map($=>i.jsxs("div",{className:`subscription-plan-card ${l===$.id?"selected-plan":""}`,onClick:()=>h($.id),children:[i.jsx("h3",{children:$.name}),i.jsxs("p",{className:"price",children:["",$.price]}),i.jsxs("p",{className:"duration",children:["Every ",$.interval," ",$.period,$.interval>1?"s":""]}),$.description&&i.jsx("p",{children:$.description})]},$.id))})]}),i.jsxs("div",{className:"subscription-form mb-6",children:[" ",i.jsx("h2",{children:"Select Payment Method"}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"manual",checked:b==="manual",onChange:()=>v("manual"),className:"mr-2"}),i.jsx("span",{children:"Cash (Manual)"})]})}),i.jsx("div",{className:"form-group",children:i.jsxs("label",{className:"inline-flex items-center",children:[i.jsx("input",{type:"radio",name:"paymentMethod",value:"razorpay",checked:b==="razorpay",onChange:()=>v("razorpay"),className:"mr-2"}),i.jsx("span",{children:"Razorpay"})]})})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:q,disabled:!l||S||a.length===0,className:"subscription-btn",children:[S&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),S?"Starting...":"Start Subscription"]})})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Warning: "}),i.jsx("span",{children:"Patient not found."})]}),i.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[i.jsx(on,{size:16}),"Back"]})]})},kne=()=>{const e=Ot(),[n,t]=w.useState([]),[r,a]=w.useState(!1),[o,l]=w.useState(null),[h,d]=w.useState(null),u=w.useCallback(async()=>{a(!0),l(null);try{const g=await Iw();t(g)}catch(g){l(g.message||"Failed to fetch clinic subscription plans."),d({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{u()},[u]),w.useEffect(()=>{if(h){const g=setTimeout(()=>d(null),5e3);return()=>clearTimeout(g)}},[h]);const f=async g=>{if(d(null),l(null),window.confirm("Are you sure you want to deactivate this clinic plan? This action cannot be undone directly.")){a(!0),l(null),d(null);try{await h7(g),d({type:"success",message:"Clinic plan deactivated successfully!"}),u()}catch(b){l(b.message||"Failed to deactivate clinic plan."),d({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return i.jsxs("div",{className:"subscription-page-container",children:[h&&i.jsxs("div",{className:`${h.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[h.type==="success"?i.jsx(Ea,{size:18,className:"mr-2 text-green-500"}):i.jsx(ui,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:h.message})]}),i.jsx("button",{onClick:()=>d(null),className:`${h.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(In,{size:16})})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>e(-1),className:"p-2 rounded-md hover:bg-gray-200",children:i.jsx(on,{size:20})}),i.jsx("h1",{className:"text-2xl font-bold",children:"Manage Clinic Subscription Plans"})]}),i.jsxs("button",{onClick:()=>e("/dashboard/clinic-subscriptions/add"),className:"subscription-btn",children:[i.jsx(hl,{size:16,className:"mr-1 inline-block"})," Add New Clinic Plan"]})]}),r&&n.length===0&&i.jsx("div",{className:"flex items-center justify-center p-8",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:i.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),i.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading clinic plans..."})]})}),!r&&o&&n.length===0&&i.jsx("p",{className:"text-center text-red-500",children:o}),n.length>0&&i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"subscription-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Billing Cycle"}),i.jsx("th",{children:"Status"}),i.jsx("th",{className:"text-right",children:"Actions"})]})}),i.jsx("tbody",{children:n.map(g=>i.jsxs("tr",{children:[i.jsx("td",{children:g.name}),i.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),i.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),i.jsx("td",{children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),i.jsxs("td",{className:"actions-cell text-right",children:[i.jsx("button",{onClick:()=>e(`/dashboard/clinic-subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:i.jsx($d,{size:16,className:"inline-block"})}),g.status==="active"&&i.jsx("button",{onClick:()=>f(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:r,children:i.jsx(Hi,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!r&&n.length===0&&!o&&i.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No clinic subscription plans found. Add one to get started!"})]})]})},Ene=()=>{const e=Ot(),[n,t]=w.useState({name:"",description:"",price:0,period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[r,a]=w.useState(!1),[o,l]=w.useState(null),[h,d]=w.useState(null);w.useEffect(()=>{if(h){const b=setTimeout(()=>d(null),5e3);return()=>clearTimeout(b)}},[h]);const u=b=>{const{name:v,value:S,type:k}=b.target;t(T=>({...T,[v]:k==="number"?parseFloat(S):S}))},f=async b=>{if(b.preventDefault(),a(!0),l(null),d(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){l("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await u7(n),d({type:"success",message:"Clinic plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/clinic-subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create clinic plan.";l(S),d({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return i.jsxs("div",{className:"subscription-page-container",children:[h&&i.jsxs("div",{className:`${h.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[h.type==="success"?i.jsx(Ea,{size:18,className:"mr-2 text-green-500"}):i.jsx(ui,{size:18,className:"mr-2 text-red-500"}),i.jsx("span",{children:h.message})]}),i.jsx("button",{onClick:()=>d(null),className:`${h.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:i.jsx(In,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Add New Clinic Subscription Plan"}),o&&i.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:o}),i.jsxs("form",{onSubmit:f,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:u})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:u,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:u,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:u,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:u})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:r,className:"subscription-btn",children:[r?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,r?"Creating...":"Create Plan"]})]})]})]})]})},Tne=()=>{const{id:e}=Yr(),n=Ot(),[t,r]=w.useState(null),[a,o]=w.useState({}),[l,h]=w.useState(!1),[d,u]=w.useState(!0),[f,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),u(!1);return}u(!0),g(null);try{const P=await c7(e);r(P),o({name:P.name,description:P.description||"",price:Number(P.price),period:P.period,interval:Number(P.interval),razorpay_plan_id:P.razorpay_plan_id||"",status:P.status})}catch(P){g(P.message||"Failed to fetch clinic plan details."),v({type:"error",message:P.message||"Failed to fetch plan details."})}finally{u(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const P=setTimeout(()=>v(null),5e3);return()=>clearTimeout(P)}},[b]);const k=P=>{const{name:I,value:q,type:$}=P.target;o(L=>({...L,[I]:$==="number"?parseFloat(q):q}))},T=async P=>{if(P.preventDefault(),!e){g("Plan ID is missing.");return}if(h(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),h(!1);return}try{await d7(e,a),v({type:"success",message:"Clinic plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(I){const q=I.message||"Failed to update clinic plan.";g(q),v({type:"error",message:q})}finally{h(!1)}},E=()=>{n(-1)};return d?i.jsx("div",{className:"p-6 text-center",children:"Loading clinic plan details..."}):f&&!t?i.jsx("div",{className:"p-6 text-center text-red-500",children:f}):t?i.jsxs("div",{className:"subscription-page-container",children:[b&&i.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[i.jsxs("div",{className:"flex items-center",children:[b.type==="success"?i.jsx(Ea,{size:18,className:"mr-2"}):i.jsx(ui,{size:18,className:"mr-2"}),i.jsx("span",{children:b.message})]}),i.jsx("button",{onClick:()=>v(null),className:"ml-4",children:i.jsx(In,{size:16})})]}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h1",{children:"Edit Clinic Subscription Plan"}),f&&i.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:f}),i.jsxs("form",{onSubmit:T,children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"name",children:["Plan Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"description",children:"Description"}),i.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"price",children:["Price (INR) ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price!==void 0?a.price:"",onChange:k,required:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"period",children:["Billing Period ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{htmlFor:"interval",children:["Interval ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval!==void 0?a.interval:"",onChange:k,required:!0})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),i.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"status",children:"Status"}),i.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"inactive",children:"Inactive"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:E,className:"subscription-btn subscription-btn-secondary",children:"Back"}),i.jsxs("button",{type:"submit",disabled:l,className:"subscription-btn",children:[l?i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,l?"Saving...":"Save Changes"]})]})]})]})]}):i.jsx("div",{className:"p-6 text-center text-gray-500",children:"Clinic plan not found."})},Ane=()=>{const e=Ot(),[n,t]=w.useState([]),[r,a]=w.useState(""),[o,l]=w.useState(!0),[h,d]=w.useState(null),[u,f]=w.useState(!1),[g,b]=w.useState(null),v=w.useCallback(async()=>{d(null);try{const T=(await Iw()).filter(E=>E.status==="active");t(T),T.length>0&&!r&&a(T[0].id)}catch(k){console.error("Error fetching plans:",k),d(`Failed to load subscription plans: ${k.message}`)}},[]);w.useEffect(()=>{(async()=>{l(!0);try{const T=await p7();if(T&&T.short_url){window.location.href=T.short_url,d("You have a pending subscription. Redirecting to payment...");return}await v()}catch(T){console.error("Error during initial page load:",T),d(`An unexpected error occurred: ${T.message}`)}finally{l(!1)}})()},[v]);const S=async()=>{if(!r){b("Please select a clinic subscription plan.");return}const k=n.find(T=>T.id===r);if(!k){b("Selected plan details not found.");return}f(!0),b(null);try{console.log("Initiating Razorpay clinic subscription for plan:",k);const T=await f7(r);if(T&&T.short_url)window.location.href=T.short_url;else throw new Error("Failed to get Razorpay clinic subscription link from backend.")}catch(T){console.error("Error starting clinic subscription:",T),b(`Failed to start clinic subscription: ${T.message}`),f(!1)}};return o?i.jsx("div",{className:"loading-state-subscription",children:"Loading clinic plans..."}):h?i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[i.jsx("strong",{children:"Error: "}),i.jsx("span",{children:h})]}),i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(on,{size:16}),"Back"]})]}):i.jsxs("div",{className:"subscription-page-container",children:[i.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[i.jsx(on,{size:16}),"Back"]}),i.jsxs("h1",{children:[i.jsx(qC,{size:28}),"Buy Pro Plan for Clinic"]}),g&&i.jsx("div",{className:"error-alert-subscription",role:"alert",children:i.jsx("span",{children:g})}),i.jsxs("div",{className:"subscription-form",children:[i.jsx("h2",{children:"Available Pro Plans"}),n.length===0?i.jsx("p",{className:"empty-state",children:"No active clinic subscription plans found."}):i.jsx("div",{className:"subscription-plan-list",children:n.map(k=>i.jsxs("div",{className:`subscription-plan-card ${r===k.id?"selected-plan":""}`,onClick:()=>a(k.id),children:[i.jsx("h3",{children:k.name}),i.jsxs("p",{className:"price",children:["",Number(k.price).toFixed(2)]}),i.jsxs("p",{className:"duration",children:["Every ",k.interval," ",k.period,k.interval>1?"s":""]}),k.description&&i.jsx("p",{children:k.description})]},k.id))})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:S,disabled:!r||u||n.length===0,className:"subscription-btn",children:[u&&i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),u?"Initiating Payment...":"Buy Pro Plan"]})})]})},Dne=()=>{const e=Ot(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[o,l]=w.useState(null),[h,d]=w.useState(!1),[u,f]=w.useState(!1),[g,b]=w.useState(null),[v,S]=w.useState({name:"",email:"",password:"",role:"user"}),[k,T]=w.useState({name:"",email:"",role:"",password:"",confirmPassword:""}),[E,P]=w.useState(""),[I,q]=w.useState(""),[$,L]=w.useState({}),[F,z]=w.useState(!1),[B,R]=w.useState(null),[U,Y]=w.useState([]),[Z,ne]=w.useState(""),[ae,X]=w.useState(!1),[W,H]=w.useState(null);w.useEffect(()=>{const oe=setTimeout(()=>{q(E)},500);return()=>{clearTimeout(oe)}},[E]),w.useEffect(()=>{he(I)},[I]);const he=async(oe="")=>{a(!0);try{const ue=oe?`/api/users?search=${encodeURIComponent(oe)}`:"/api/users",Ie=await(await de(ue)).json();if(t(Ie),Ie.length>0){const fe=[...new Set(Ie.map(Re=>Re.clinic_id).filter(Re=>!!Re))],pe={};await Promise.all(fe.map(async Re=>{try{const Ye=await l7(Re);pe[Re]=Ye}catch(Ye){console.error(`Failed to fetch subscription status for clinic ${Re}`,Ye),pe[Re]={hasProPlan:!1}}})),L(pe)}l(null)}catch(ue){l("Failed to fetch users."),console.error(ue)}finally{a(!1)}},D=async oe=>{oe.preventDefault();try{await de("/users",{method:"POST",body:JSON.stringify(v)}),d(!1),S({name:"",email:"",password:"",role:"user"}),he()}catch(ue){l("Failed to add user."),console.error(ue)}},te=async oe=>{if(oe.preventDefault(),!g)return;const{password:ue,confirmPassword:Ee,...Ie}=k,fe={...Ie};if(ue){if(ue.length<6){l("Password must be at least 6 characters long.");return}if(ue!==Ee){l("Passwords do not match.");return}fe.password=ue}try{await de(`/users/${g.id}`,{method:"PUT",body:JSON.stringify(fe)}),f(!1),b(null),T({...k,password:"",confirmPassword:""}),he()}catch(pe){l("Failed to update user."),console.error(pe)}},ve=async oe=>{if(window.confirm("Are you sure you want to delete this user?"))try{await de(`/users/${oe}`,{method:"DELETE"}),he()}catch(ue){l("Failed to delete user."),console.error(ue)}},M=oe=>{b(oe),T({name:oe.name,email:oe.email,role:oe.role,password:"",confirmPassword:""}),f(!0)},ge=async()=>{X(!0);try{const oe=await Iw();Y(oe),oe.length>0&&ne(oe[0].id),H(null)}catch(oe){H("Failed to fetch subscription plans."),console.error(oe)}finally{X(!1)}},_e=oe=>{R(oe),z(!0),ge()},se=async oe=>{if(oe.preventDefault(),!B||!Z){l("Please select a clinic and a plan.");return}try{await de("/clinic-subscriptions/manual-activate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicId:B,planId:Z})}),z(!1),R(null),ne(""),he(),l(null)}catch(ue){l("Failed to manually activate clinic subscription."),console.error(ue)}},ee=async oe=>{if(window.confirm("Are you sure you want to cancel this clinic's subscription? This action cannot be undone."))try{await o7(oe),he(),l(null)}catch(ue){l("Failed to cancel subscription."),console.error(ue)}};return r?i.jsx("div",{children:"Loading users..."}):o?i.jsx("div",{className:"error-message",children:o}):i.jsxs("div",{className:"user-management-page",children:[i.jsxs("div",{className:"user-management-header",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(on,{size:16}),"Back"]}),i.jsx("h1",{children:"User Management"})]}),i.jsxs("div",{className:"controls-container",children:[i.jsx("input",{type:"text",placeholder:"Search by name or email...",value:E,onChange:oe=>P(oe.target.value),className:"search-input"}),i.jsx("button",{onClick:()=>d(!0),className:"add-user-button",children:"Add New User"})]}),h&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>d(!1),children:""}),i.jsx("h2",{children:"Add New User"}),i.jsxs("form",{onSubmit:D,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:v.name,onChange:oe=>S({...v,name:oe.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:v.email,onChange:oe=>S({...v,email:oe.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Password:"}),i.jsx("input",{type:"password",value:v.password,onChange:oe=>S({...v,password:oe.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:v.role,onChange:oe=>S({...v,role:oe.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsx("button",{type:"submit",children:"Add User"})]})]})}),u&&g&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>f(!1),children:""}),i.jsx("h2",{children:"Edit User"}),i.jsxs("form",{onSubmit:te,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Name:"}),i.jsx("input",{type:"text",value:k.name,onChange:oe=>T({...k,name:oe.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email:"}),i.jsx("input",{type:"email",value:k.email,onChange:oe=>T({...k,email:oe.target.value}),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Role:"}),i.jsxs("select",{value:k.role,onChange:oe=>T({...k,role:oe.target.value}),children:[i.jsx("option",{value:"user",children:"User"}),i.jsx("option",{value:"admin",children:"Admin"}),i.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"New Password (optional):"}),i.jsx("input",{type:"password",value:k.password,onChange:oe=>T({...k,password:oe.target.value})})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Confirm New Password:"}),i.jsx("input",{type:"password",value:k.confirmPassword,onChange:oe=>T({...k,confirmPassword:oe.target.value})})]}),i.jsx("button",{type:"submit",children:"Update User"})]})]})}),F&&i.jsx("div",{className:"modal",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("span",{className:"close-button",onClick:()=>z(!1),children:""}),i.jsx("h2",{children:"Select Subscription Plan for Clinic"}),ae&&i.jsx("div",{children:"Loading plans..."}),W&&i.jsx("div",{className:"error-message",children:W}),!ae&&!W&&U.length===0&&i.jsx("div",{children:"No active subscription plans available."}),!ae&&!W&&U.length>0&&i.jsxs("form",{onSubmit:se,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Select Plan:"}),i.jsx("select",{value:Z,onChange:oe=>ne(oe.target.value),required:!0,children:U.map(oe=>i.jsxs("option",{value:oe.id,children:[oe.name," - $",oe.price,"/",oe.interval," ",oe.period]},oe.id))})]}),i.jsx("button",{type:"submit",children:"Activate Selected Plan"})]})]})}),i.jsxs("table",{className:"user-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Role"}),i.jsx("th",{children:"Clinic ID"}),i.jsx("th",{children:"Subscription Status"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:n.map(oe=>{const ue=oe.clinic_id||"N/A",Ee=ue!=="N/A"?$[ue]:null,Ie=(Ee==null?void 0:Ee.hasProPlan)??!1,fe=Ie?"PRO":"Standard";return i.jsxs("tr",{children:[i.jsx("td",{children:oe.name}),i.jsx("td",{children:oe.email}),i.jsx("td",{children:oe.role}),i.jsx("td",{children:ue}),i.jsx("td",{children:ue!=="N/A"?i.jsx("span",{className:Ie?"pro-badge":"standard-badge",children:fe}):"N/A"}),i.jsxs("td",{children:[i.jsx("button",{onClick:()=>M(oe),className:"edit-button",children:"Edit"}),i.jsx("button",{onClick:()=>ve(oe.id),className:"delete-button",children:"Delete"}),oe.clinic_id&&!Ie&&i.jsx("button",{onClick:()=>_e(oe.clinic_id),className:"start-subscription-button",children:"Start Subscription"}),oe.clinic_id&&Ie&&i.jsx("button",{onClick:()=>ee(oe.clinic_id),className:"cancel-subscription-button",children:"Cancel Subscription"})]})]},oe.id)})})]})]})},Pne=()=>{const[e,n]=w.useState(""),[t,r]=w.useState(!0),[a,o]=w.useState(null);w.useEffect(()=>{(async()=>{try{const d=Vf();if(!d)throw new Error("Authentication token not found.");const f=await(await de("/api/super-admin-settings/gemini-api-key",{headers:{Authorization:`Bearer ${d}`}})).json();n(f.gemini_api_key||"")}catch(d){console.error("Error fetching Gemini API key:",d),o({type:"error",text:"Failed to fetch Gemini API key."})}finally{r(!1)}})()},[]);const l=async()=>{r(!0),o(null);try{const h=Vf();if(!h)throw new Error("Authentication token not found.");await de("/api/super-admin-settings/gemini-api-key",{method:"PUT",headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"},body:JSON.stringify({gemini_api_key:e})}),o({type:"success",text:"Gemini API key updated successfully!"})}catch(h){console.error("Error updating Gemini API key:",h),o({type:"error",text:"Failed to update Gemini API key."})}finally{r(!1)}};return i.jsxs("div",{className:"admin-panel-container",children:[i.jsxs("h1",{className:"admin-panel-title",children:[i.jsx(Xm,{size:32,className:"icon-margin"}),"Super Admin Dashboard"]}),i.jsxs("div",{className:"admin-panel-grid",children:[i.jsxs(Ps,{to:"/dashboard/clinic-subscriptions",className:"admin-panel-card",children:[i.jsx(sg,{size:48,className:"card-icon"}),i.jsx("h2",{children:"Manage Clinic Subscription Plans"}),i.jsx("p",{children:"Add, edit, and view clinic subscription plans."})]}),i.jsxs(Ps,{to:"/dashboard/users",className:"admin-panel-card",children:[i.jsx(Uf,{size:48,className:"card-icon"}),i.jsx("h2",{children:"User Management"}),i.jsx("p",{children:"Add, edit, and delete users; manage user roles."})]}),i.jsxs("div",{className:"admin-panel-card",children:[i.jsx(RI,{size:48,className:"card-icon"}),i.jsx("h2",{children:"Global Gemini API Key"}),i.jsx("p",{children:"Set the global default Gemini API key."}),i.jsxs("div",{className:"flex flex-col mt-4",children:[i.jsx("input",{type:"password",value:e,onChange:h=>n(h.target.value),placeholder:"Enter Global Gemini API Key",className:"p-2 border border-gray-300 rounded mb-2",disabled:t}),i.jsx("button",{onClick:l,className:"bg-blue-500 text-white p-2 rounded hover:bg-blue-600 disabled:bg-blue-300",disabled:t,children:t?"Saving...":"Save Global API Key"}),a&&i.jsx("p",{className:`mt-2 text-sm ${a.type==="success"?"text-green-600":"text-red-600"}`,children:a.text})]})]})]})]})},Wm="tutorialCurrentStep",GT=({onActionComplete:e,onStaffAdded:n,requiredRole:t})=>{const[r,a]=w.useState(""),[o,l]=w.useState(""),[h,d]=w.useState(""),[u,f]=w.useState(!1),g=t||"receptionist";w.useEffect(()=>{a(t==="lab"?"Lab":t==="pharmacy"?"Pharmacy":"")},[t]);const b=async()=>{if(!r||!o||!h){e(!1,"Please fill all fields.");return}f(!0);try{const v=await de("/api/staff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,email:o,role:g,password:h})});if(v.ok)e(!0,`Successfully added "${r}" as a ${g}!`),a(""),l(""),d(""),n&&n(g);else{const S=await v.json();e(!1,`Failed to add staff: ${S.message||v.statusText}`)}}catch(v){console.error("Error adding staff:",v),e(!1,`Error adding staff: ${v instanceof Error?v.message:String(v)}`)}finally{f(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("h3",{children:"Add a New Staff Member"}),i.jsx("input",{type:"text",placeholder:"Staff Name",value:r,onChange:v=>a(v.target.value),className:"tutorial-input",disabled:u}),i.jsx("input",{type:"email",placeholder:"Email",value:o,onChange:v=>l(v.target.value),className:"tutorial-input",disabled:u}),i.jsx("input",{type:"password",placeholder:"Password",value:h,onChange:v=>d(v.target.value),className:"tutorial-input",disabled:u}),i.jsx("input",{type:"text",placeholder:"Role",value:g==="lab"?"Lab Technician":g==="pharmacy"?"Pharmacist":"Receptionist",className:"tutorial-input",disabled:!0}),i.jsx("button",{onClick:b,className:"tutorial-button primary",disabled:u,children:u?"Adding...":"Add Staff"})]})},Ine=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState([]),[o,l]=w.useState(!1),h=async()=>{t(!0);try{const d=await de("/api/drugs/import-defaults",{method:"POST"});if(d.ok){const u=await d.json(),f=u.drugs?u.drugs.map(g=>g.name):[];a(f),l(!0),e(!0,`Default medications imported: Added ${u.details.added}, Updated ${u.details.updated}.`,"pharmacyImport")}else{const u=await d.json();e(!1,`Failed to import default medications: ${u.message||d.statusText}`)}}catch(d){console.error("Error importing default medications:",d),e(!1,`Error importing default medications: ${d instanceof Error?d.message:String(d)}`)}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("h3",{children:"Import Default Medications"}),i.jsx("p",{children:"Click the button below to populate your pharmacy inventory with a list of common medications."}),i.jsx("button",{onClick:h,className:"tutorial-button primary",disabled:n,children:n?"Importing...":i.jsxs(i.Fragment,{children:[" ",i.jsx("i",{className:"fas fa-pills"})," Import Default Drugs"]})}),o&&r.length>0&&i.jsxs("div",{className:"imported-drugs-list",children:[i.jsx("h4",{children:"Medications Imported:"}),i.jsx("ul",{children:r.map((d,u)=>i.jsx("li",{children:d},u))})]})]})},Mne=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[r,a]=w.useState([]),[o,l]=w.useState(!1),h=async()=>{t(!0);try{const d=await de("/api/lab-tests/import-defaults",{method:"POST"});if(d.ok){const u=await d.json(),f=u.tests?u.tests.map(g=>g.name):[];a(f),l(!0),e(!0,`Default lab tests imported: Added ${u.details.added}, Updated ${u.details.updated}.`,"labImport")}else{const u=await d.json();e(!1,`Failed to import default lab tests: ${u.message||d.statusText}`)}}catch(d){console.error("Error importing default lab tests:",d),e(!1,`Error importing default lab tests: ${d instanceof Error?d.message:String(d)}`)}finally{t(!1)}};return i.jsxs("div",{className:"tutorial-interactive-component",children:[i.jsx("h3",{children:"Import Default Lab Tests"}),i.jsx("p",{children:"Click the button below to populate your lab test inventory with a list of common tests."}),i.jsx("button",{onClick:h,className:"tutorial-button primary",disabled:n,children:n?"Importing...":i.jsxs(i.Fragment,{children:[" ",i.jsx("i",{className:"fas fa-flask"})," Import Default Lab Tests"]})}),o&&r.length>0&&i.jsxs("div",{className:"imported-drugs-list",children:[i.jsx("h4",{children:"Tests Imported:"}),i.jsx("ul",{children:r.map((d,u)=>i.jsx("li",{children:d},u))})]})]})},Qm=[{title:"Welcome to Your Admin Dashboard!",description:"This quick tour will guide you through essential features to get your clinic set up.",actionText:"Let's Start!",actionPath:null,component:null},{title:"Step 1: Manage Pharmacy Inventory",description:"Set up your pharmacy by adding drugs, managing stock levels, and importing default drug lists. This ensures smooth prescription fulfillment. Import default medications now!",actionText:"Go to Pharmacy Inventory",actionPath:"/dashboard/inventory",component:Ine},{title:"Step 2: Manage Lab Test Inventory",description:"Configure your laboratory by adding available lab tests and importing default test lists. This is crucial for accurate diagnostics. Import default lab tests now!",actionText:"Go to Lab Test Inventory",actionPath:"/lab-inventory",component:Mne},{title:"Step 3: Add Staff Members (Optional)",description:"You can add your clinic's staff, including doctors, receptionists, lab technicians, and pharmacists. Each role has specific permissions. You can skip this step for now.",actionText:"Go to Staff Management",actionPath:null,component:GT},{title:"You're All Set!",description:"You've completed the basic setup tour. Now, try out the AI-powered complaint analysis feature!",actionText:"Try the AI!",actionPath:"/edit-complaints",component:null}],Rne=({onClose:e,onMarkAsSeen:n})=>{const[t,r]=w.useState(()=>{const $=localStorage.getItem(Wm);return $?parseInt($,10):0}),[a,o]=w.useState(null),[l,h]=w.useState(null),[d,u]=w.useState(!1),[f,g]=w.useState(null),[b,v]=w.useState(4),S=Ot();w.useEffect(()=>{if(localStorage.setItem(Wm,t.toString()),o(null),h(null),t===0){v(4);const $=setTimeout(()=>{r(F=>F+1)},4e3),L=setInterval(()=>{v(F=>F-1)},1e3);return()=>{clearTimeout($),clearInterval(L)}}},[t]);const k=($,L,F)=>{h($),o(L),$&&(F==="pharmacyImport"||F==="labImport")&&r(z=>z+1)},T=()=>{},E=()=>{n(),e(),localStorage.removeItem(Wm)},P=async()=>{const $=Qm[t];if(q&&$.actionPath==="/edit-complaints"){u(!0),g(null);try{const L=await de("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"New Patient - AI Entry",age:null,gender:null,phone:null,address:null})});if(!L.ok){const Y=await L.text();throw new Error(`Failed to create patient: ${Y||L.statusText} (${L.status})`)}const F=await L.json();if(!F||!F.id)throw new Error("Failed to create new patient or retrieve patient ID.");const z=F.id,B=await de("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:z,complaint:""})});if(!B.ok){const Y=await B.text();throw new Error(`Failed to create queue entry: ${Y||B.statusText} (${B.status})`)}const R=await B.json();if(!R||!R.id)throw new Error("Failed to create new complaint record or retrieve record ID.");const U=R.id;S(`/dashboard/edit-complaint/${U}`),e(),n(),localStorage.removeItem(Wm)}catch(L){console.error("Error starting new AI complaint:",L);const F=`Error: ${L.message||"Failed to start new AI complaint process."}`;g(F)}finally{u(!1)}}else $.actionPath&&(S($.actionPath),e(),t===Qm.length-1&&(n(),localStorage.removeItem(Wm)))},I=Qm[t],q=t===Qm.length-1;return i.jsx("div",{className:"tutorial-modal-overlay",children:i.jsxs("div",{className:"tutorial-modal-content",children:[i.jsxs("div",{className:"tutorial-step-indicator",children:["Step ",t+1," of ",Qm.length]}),i.jsxs("div",{className:"tutorial-content-wrapper",children:[i.jsx("h2",{children:I.title}),i.jsx("p",{children:I.description}),I.component&&i.jsxs("div",{className:"tutorial-interactive-area",children:[t===3?i.jsx(GT,{onActionComplete:k,onStaffAdded:T,requiredRole:null}):i.jsx(I.component,{onActionComplete:k}),a&&i.jsxs("p",{className:`tutorial-message ${l?"success":"error"}`,children:[l?i.jsx("i",{className:"fas fa-check-circle",style:{marginRight:"8px"}}):i.jsx("i",{className:"fas fa-exclamation-circle",style:{marginRight:"8px"}}),a]})]}),f&&i.jsxs("p",{className:"tutorial-message error",children:[i.jsx("i",{className:"fas fa-exclamation-triangle",style:{marginRight:"8px"}})," ",f]}),i.jsxs("div",{className:"tutorial-modal-actions",children:[i.jsx("button",{onClick:E,className:"tutorial-button secondary",disabled:d,children:"Skip Data Entry"}),t===3&&i.jsx("button",{onClick:()=>r(t+1),className:"tutorial-button secondary",children:"Next Step"}),I.actionPath&&i.jsx("button",{onClick:P,className:"tutorial-button action",disabled:d,children:d?i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fas fa-spinner fa-spin",style:{marginRight:"8px"}})," Creating..."]}):i.jsxs(i.Fragment,{children:[I.actionText," ",i.jsx("i",{className:"fas fa-arrow-right",style:{marginLeft:"8px"}})]})})]}),t===0&&i.jsxs("div",{className:"tutorial-countdown-indicator",children:[i.jsx("i",{className:"fas fa-clock"})," Next step in ",b,"s"]})]},t)]})})},One=(e,n,t)=>{const r=Math.abs(e.getTime()-n.getTime());return Math.ceil(r/(1e3*60*60*24))<=t},hC=e=>{if(e.match(/^\d{4}-\d{2}-\d{2}$/))return new Date(e);const n=e.split("/");if(n.length===3){const t=parseInt(n[0],10),r=parseInt(n[1],10)-1,a=parseInt(n[2],10),o=new Date(a,r,t),l=parseInt(n[0],10)-1,h=parseInt(n[1],10),d=parseInt(n[2],10),u=new Date(d,l,h),f=!isNaN(o.getTime()),g=!isNaN(u.getTime());if(f&&g)return o;if(f)return o;if(g)return u}return new Date(e)},YT=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,o]=w.useState(null),[l,h]=w.useState(""),[d,u]=w.useState(""),[f,g]=w.useState(1),[b]=w.useState(10),v=new Date,S=Ot();w.useEffect(()=>{(async()=>{r(!0);try{const R=await de("/api/pharmacy-orders/refill-reminders");if(R.ok){const U=await R.json();n(U)}else o("Failed to fetch refill reminders.")}catch{o("An error occurred while fetching data.")}finally{r(!1)}})()},[]);const k=z=>{h(z.target.value),g(1)},T=z=>{u(z.target.value),g(1)},E=e.filter(z=>{const B=l?z.medicationRefillDates.some(U=>{const Y=hC(U.refillDate);return!isNaN(Y.getTime())&&Y.toISOString().split("T")[0]===l}):!0,R=d?z.patientName.toLowerCase().includes(d.toLowerCase())||z.patientPhoneNumber.includes(d)||z.items.some(U=>U.name.toLowerCase().includes(d.toLowerCase())):!0;return B&&R}),P=f*b,I=P-b,q=E.slice(I,P),$=Math.ceil(E.length/b),L=z=>g(z),F=async z=>{try{const B=await de(`/api/queue/patient/${z}/latest`);if(B.ok){const U=await B.json();if(U!=null&&U._id){S(`/dashboard/edit-complaint/${U._id}`,{state:{patientId:z}});return}}const R=await de("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:z})});if(R.ok){const U=await R.json();U!=null&&U.id&&S(`/dashboard/edit-complaint/${U.id}`,{state:{patientId:z}})}}catch(B){console.error("Error handling row click:",B),o("Failed to navigate to patient complaint.")}};return t?i.jsx("div",{children:"Loading..."}):a?i.jsx("div",{children:a}):i.jsxs("div",{className:"refill-reminders-container",children:[i.jsx("h1",{children:"Refill Reminders"}),i.jsxs("div",{className:"controls-container",children:[i.jsxs("div",{className:"filter-container",children:[i.jsx("label",{htmlFor:"refillDate",children:"Filter by Refill Date: "}),i.jsx("input",{type:"date",id:"refillDate",value:l,onChange:k})]}),i.jsxs("div",{className:"search-container",children:[i.jsx("label",{htmlFor:"search",children:"Search: "}),i.jsx("input",{type:"text",id:"search",placeholder:"Search by patient name, phone, or medication",value:d,onChange:T})]})]}),i.jsxs("table",{children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Patient Name"}),i.jsx("th",{children:"Patient Phone Number"}),i.jsx("th",{children:"Medications"}),i.jsx("th",{children:"Refill Dates"})]})}),i.jsx("tbody",{children:q.length>0?q.map(z=>i.jsxs("tr",{onClick:()=>F(z.patientId),style:{cursor:"pointer"},children:[i.jsx("td",{children:z.patientName}),i.jsx("td",{children:z.patientPhoneNumber}),i.jsxs("td",{children:[i.jsx("ul",{children:z.items.map((B,R)=>i.jsxs("li",{children:[B.name," (Qty: ",B.quantity,")",B.tabletsPerDay&&i.jsxs("span",{children:[" - ",B.tabletsPerDay," / day"]}),B.numberOfDays&&i.jsxs("span",{children:[" for ",B.numberOfDays," days"]})]},R))}),i.jsxs("div",{children:["Last Updated: ",new Date(z.updatedAt).toLocaleDateString()]}),z.prescription_for_unavailable_drugs&&i.jsxs("div",{className:"unavailable-prescription",children:[i.jsx("strong",{children:"Unavailable:"})," ",z.prescription_for_unavailable_drugs]})]}),i.jsx("td",{children:i.jsx("ul",{children:z.medicationRefillDates.map((B,R)=>{const U=hC(B.refillDate),Y=!isNaN(U.getTime())&&One(U,v,2);return i.jsxs("li",{className:Y?"highlight-refill-date":"",children:[B.name,": ",isNaN(U.getTime())?"Invalid Date":U.toLocaleDateString()]},R)})})})]},z.id)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:"No refill reminders found."})})})]}),i.jsxs("div",{className:"pagination-container",children:[i.jsx("button",{onClick:()=>L(f-1),disabled:f===1,children:"Previous"}),Array.from({length:$},(z,B)=>i.jsx("button",{onClick:()=>L(B+1),className:f===B+1?"active":"",children:B+1},B+1)),i.jsx("button",{onClick:()=>L(f+1),disabled:f===$,children:"Next"})]})]})},Lne=()=>{const e=Ot(),n=Cr();return w.useEffect(()=>{const t=new URLSearchParams(n.search),r=t.get("token"),a=t.get("caseDetails");r?(async()=>{try{const l=await de(`/api/patients?search=${r}&limit=1`);if(!l.ok)throw new Error("Failed to fetch patient by token");const d=(await l.json()).patients[0];if(!d)throw new Error("Patient with the given token not found");const u=await de(`/api/queue/patient/${d.id}/latest`);if(u.ok){const b=await u.json();if(b!=null&&b._id){e(`/dashboard/edit-complaint/${b._id}`,{state:{initialMessage:a,patientId:d.id}});return}}const f=await de("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:d.id})});if(!f.ok)throw new Error("Failed to create queue entry");const g=await f.json();if(g!=null&&g.id)e(`/dashboard/edit-complaint/${g.id}`,{state:{initialMessage:a,patientId:d.id}});else throw new Error("Failed to get ID from new queue entry.")}catch(l){console.error("Error handling complaint URL:",l),e("/dashboard/search-patient")}})():e("/dashboard/search-patient")},[n,e]),i.jsx("div",{children:"Loading..."})},Fne=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,o]=w.useState(null),[l,h]=w.useState("all"),[d,u]=w.useState(""),f=w.useCallback(async()=>{r(!0),o(null);try{const k=await de("/api/notifications?all=true");if(k.ok){const E=(await k.json()).sort((P,I)=>{const q={expired_drug:1,near_expiry_drug:2,low_stock:3},$=q[P.type]||99,L=q[I.type]||99;return $!==L?$-L:new Date(I.created_at).getTime()-new Date(P.created_at).getTime()});n(E)}else o("Failed to fetch notifications."),console.error("Failed to fetch notifications:",k.statusText)}catch(k){o("Error fetching notifications."),console.error("Error fetching notifications:",k)}finally{r(!1)}},[]);w.useEffect(()=>{f()},[f]);const g=async k=>{try{const T=await de(`/api/notifications/${k}/read`,{method:"PUT"});T.ok?n(E=>E.map(P=>P.id===k?{...P,is_read:!0}:P)):console.error("Failed to mark notification as read:",T.statusText)}catch(T){console.error("Error marking notification as read:",T)}},b=async(k,T)=>{if(window.confirm("Are you sure you want to delete this drug from the inventory? This action cannot be undone."))try{const E=await de(`/api/drugs/${k}`,{method:"DELETE"});if(E.ok)alert("Drug deleted successfully."),await g(T);else{const P=await E.json();alert(`Failed to delete drug: ${P.message||E.statusText}`)}}catch(E){console.error("Error deleting drug:",E),alert("An error occurred while trying to delete the drug.")}},v=async()=>{try{const k=e.filter(E=>!E.is_read).map(E=>E.id);if(k.length===0)return;const T=await de("/api/notifications/mark-all-read",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationIds:k})});T.ok?n(E=>E.map(P=>({...P,is_read:!0}))):console.error("Failed to mark all notifications as read:",T.statusText)}catch(k){console.error("Error marking all notifications as read:",k)}},S=e.filter(k=>{const T=k.message.toLowerCase().includes(d.toLowerCase()),E=l==="all"||l==="unread"&&!k.is_read||l==="expired"&&(k.type==="expired_drug"||k.type==="near_expiry_drug");return T&&E});return t?i.jsx("div",{className:"notifications-page-container",children:"Loading notifications..."}):a?i.jsx("div",{className:"notifications-page-container error-message",children:a}):i.jsxs("div",{className:"notifications-page-container",children:[i.jsx("h2",{className:"notifications-page-title",children:"All Notifications"}),i.jsxs("div",{className:"notifications-controls",children:[i.jsxs("div",{className:"filters-group",children:[i.jsx("input",{type:"text",placeholder:"Search notifications...",value:d,onChange:k=>u(k.target.value),className:"search-input"}),i.jsxs("select",{value:l,onChange:k=>h(k.target.value),className:"type-filter",children:[i.jsx("option",{value:"all",children:"All Notifications"}),i.jsx("option",{value:"unread",children:"Unread Only"}),i.jsx("option",{value:"expired",children:"Expiry Alerts"})]})]}),i.jsx("div",{className:"notifications-actions",children:i.jsx("button",{onClick:v,disabled:e.every(k=>k.is_read),className:"mark-all-read-button",children:"Mark All As Read"})})]}),S.length===0?i.jsx("p",{className:"no-notifications-message",children:"No notifications matching your criteria."}):i.jsx("ul",{className:"notifications-list",children:S.map(k=>i.jsxs("li",{className:`notification-item ${k.is_read?"read":"unread"}`,children:[i.jsxs("div",{className:"notification-main",children:[i.jsxs("div",{className:"notification-content",children:[i.jsx("span",{className:`notification-badge ${k.type}`,children:k.type.replace(/_/g," ")}),i.jsx("p",{className:"notification-message",children:k.message})]}),i.jsxs("div",{className:"notification-fix-actions",children:[(k.type==="expired_drug"||k.type==="near_expiry_drug")&&k.related_entity_id&&i.jsx("button",{onClick:()=>b(k.related_entity_id,k.id),className:"fix-button delete-drug",title:`Delete this ${k.type==="expired_drug"?"expired":"near expiry"} drug from inventory`,children:"Delete from Inventory"}),k.type==="low_stock"&&i.jsx("button",{className:"fix-button restock-drug",onClick:()=>window.location.href="/dashboard/inventory",children:"Restock"})]})]}),i.jsxs("div",{className:"notification-meta",children:[i.jsx("span",{className:"notification-timestamp",children:new Date(k.created_at).toLocaleString()}),!k.is_read&&i.jsx("button",{onClick:()=>g(k.id),className:"mark-read-button",children:"Mark as Read"})]})]},k.id))})]})},fC=()=>{const e=Ot(),[n,t]=w.useState([]),[r,a]=w.useState(!0),[o,l]=w.useState(null),[h,d]=w.useState(!1),[u,f]=w.useState(!1),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[E,P]=w.useState(null),[I,q]=w.useState([]),[$,L]=w.useState(null),[F,z]=w.useState(""),[B,R]=w.useState(""),[U,Y]=w.useState(""),[Z,ne]=w.useState(""),[ae,X]=w.useState(""),[W,H]=w.useState(""),[he,D]=w.useState(""),[te,ve]=w.useState(""),[M,ge]=w.useState(""),[_e,se]=w.useState(""),[ee,oe]=w.useState(""),ue=w.useCallback(async()=>{a(!0),l(null);try{const Te=await de("/api/distributors");if(!Te.ok)throw new Error(`Failed to fetch distributors: ${Te.statusText}`);const ie=await Te.json();t(ie)}catch(Te){console.error("Failed to fetch distributors:",Te),l(Te.message||"Failed to load distributors.")}finally{a(!1)}},[]);w.useEffect(()=>{ue()},[ue]);const Ee=async Te=>{Te.preventDefault(),l(null);try{const ie=await de("/api/distributors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:F,contact_person:B,phone:U,email:Z,address:ae,gst_number:W,drug_license_number:he})});if(!ie.ok){const xe=await ie.json();throw new Error(xe.message||"Failed to add distributor.")}alert("Distributor added successfully!"),ut(),ue()}catch(ie){console.error("Error adding distributor:",ie),l(ie.message||"Failed to add distributor.")}},Ie=async Te=>{if(Te.preventDefault(),l(null),!!E)try{const ie=await de(`/api/distributors/${E.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:F,contact_person:B,phone:U,email:Z,address:ae,gst_number:W,drug_license_number:he})});if(!ie.ok){const xe=await ie.json();throw new Error(xe.message||"Failed to update distributor.")}alert("Distributor updated successfully!"),Se(),ue()}catch(ie){console.error("Error updating distributor:",ie),l(ie.message||"Failed to update distributor.")}},fe=async()=>{if(l(null),!!E)try{const Te=await de(`/api/distributors/${E.id}`,{method:"DELETE"});if(!Te.ok){const ie=await Te.json();throw new Error(ie.message||"Failed to delete distributor.")}alert("Distributor deleted successfully!"),Ue(),ue()}catch(Te){console.error("Error deleting distributor:",Te),l(Te.message||"Failed to delete distributor.")}},pe=w.useCallback(async Te=>{l(null);try{const ie=await de(`/api/distributors/${Te}/payments`);if(!ie.ok)throw new Error(`Failed to fetch payments: ${ie.statusText}`);const Qe=(await ie.json()).map(Je=>({...Je,order_value:parseFloat(Je.order_value),amount_paid:parseFloat(Je.amount_paid),balance_remaining:parseFloat(Je.balance_remaining)}));q(Qe);const we=await de(`/api/distributors/${Te}/balance`);if(!we.ok)throw new Error(`Failed to fetch balance: ${we.statusText}`);const Pe=await we.json();L({totalOrderValue:parseFloat(Pe.totalOrderValue),totalAmountPaid:parseFloat(Pe.totalAmountPaid),remainingBalance:parseFloat(Pe.remainingBalance)})}catch(ie){console.error("Error fetching payments/balance:",ie),l(ie.message||"Failed to load payments or balance.")}},[]),Re=async Te=>{if(Te.preventDefault(),l(null),!!E)try{const ie=await de(`/api/distributors/${E.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:te,order_value:parseFloat(M||"0"),amount_paid:parseFloat(_e||"0"),notes:ee})});if(!ie.ok){const xe=await ie.json();throw new Error(xe.message||"Failed to add payment.")}alert("Payment added successfully!"),pt(),pe(E.id)}catch(ie){console.error("Error adding payment:",ie),l(ie.message||"Failed to add payment.")}},Ye=()=>{z(""),R(""),Y(""),ne(""),X(""),H(""),D(""),l(null),d(!0)},ut=()=>{d(!1)},Ge=Te=>{P(Te),z(Te.name),R(Te.contact_person||""),Y(Te.phone||""),ne(Te.email||""),X(Te.address||""),H(Te.gst_number||""),D(Te.drug_license_number||""),l(null),f(!0)},Se=()=>{f(!1),P(null)},qe=Te=>{P(Te),l(null),b(!0)},Ue=()=>{b(!1),P(null)},ze=Te=>{P(Te),pe(Te.id),l(null),S(!0)},lt=()=>{S(!1),P(null),q([]),L(null)},Ke=Te=>{P(Te),ve(new Date().toISOString().split("T")[0]),ge("0"),se("0"),oe(""),l(null),T(!0)},pt=()=>{T(!1),P(null)};return r?i.jsx("div",{className:"loading-indicator",children:"Loading Distributors..."}):o?i.jsxs("div",{className:"error-indicator",children:["Error: ",o]}):i.jsxs("div",{className:"distributor-management-page",children:[i.jsxs("div",{className:"distributor-management-header",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:i.jsx(on,{size:24})}),i.jsx("h2",{children:"Distributor Management"})]}),(()=>{const Te=n.reduce((xe,Qe)=>xe+parseFloat(Qe.remainingBalance||"0"),0),ie=Te>=0?"balance-positive":"balance-negative";return i.jsxs("div",{className:`total-balance-display ${ie}`,children:[i.jsx("strong",{children:"Total Combined Balance:"})," ",Te.toFixed(2)]})})(),i.jsxs("button",{onClick:Ye,className:"add-distributor-button",children:[i.jsx(nc,{size:18}),"Add New Distributor"]})]}),i.jsx("div",{className:"distributor-table-container",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Contact Person"}),i.jsx("th",{children:"Phone"}),i.jsx("th",{children:"Email"}),i.jsx("th",{children:"Address"}),i.jsx("th",{children:"GST Number"})," ",i.jsx("th",{children:"Drug License Number"})," ",i.jsx("th",{children:"Remaining Balance"})," ",i.jsx("th",{className:"actions-cell",children:"Actions"})]})}),i.jsx("tbody",{children:n.length===0?i.jsxs("tr",{children:[i.jsx("td",{colSpan:9,className:"no-results-message",children:"No distributors found."})," "]}):n.map(Te=>i.jsxs("tr",{children:[i.jsx("td",{children:Te.name}),i.jsx("td",{children:Te.contact_person||"-"}),i.jsx("td",{children:Te.phone||"-"}),i.jsx("td",{children:Te.email||"-"}),i.jsx("td",{children:Te.address||"-"}),i.jsx("td",{children:Te.gst_number||"-"})," ",i.jsx("td",{children:Te.drug_license_number||"-"})," ",i.jsxs("td",{className:parseFloat(Te.remainingBalance||"0")>0?"balance-positive":"balance-negative",children:["",Te.remainingBalance||"0.00"]})," ",i.jsx("td",{className:"actions-cell",children:i.jsxs("div",{className:"actions-buttons-group",children:[i.jsxs("button",{onClick:()=>ze(Te),className:"action-text-button view-button",title:"View Payments & Balance",children:[i.jsx(og,{size:16})," View Payments"]}),i.jsxs("button",{onClick:()=>Ke(Te),className:"action-text-button add-payment-button",title:"Add Payment",children:[i.jsx(nc,{size:16})," Add Payment"]}),i.jsx("button",{onClick:()=>Ge(Te),className:"action-icon-button edit-button",title:"Edit Distributor",children:i.jsx($d,{size:16})}),i.jsx("button",{onClick:()=>qe(Te),className:"action-icon-button delete-button",title:"Delete Distributor",children:i.jsx(Hi,{size:16})})]})})]},Te.id))})]})}),h&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:ut,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Add New Distributor"}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("form",{onSubmit:Ee,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"name",children:"Name:"}),i.jsx("input",{type:"text",id:"name",value:F,onChange:Te=>z(Te.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"contact_person",value:B,onChange:Te=>R(Te.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"phone",value:U,onChange:Te=>Y(Te.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"email",children:"Email:"}),i.jsx("input",{type:"email",id:"email",value:Z,onChange:Te=>ne(Te.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"address",children:"Address:"}),i.jsx("textarea",{id:"address",value:ae,onChange:Te=>X(Te.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"gst_number",value:W,onChange:Te=>H(Te.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"drug_license_number",value:he,onChange:Te=>D(Te.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:ut,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Distributor"})]})]})]})}),u&&E&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Se,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Edit Distributor"}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("form",{onSubmit:Ie,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-name",children:"Name:"}),i.jsx("input",{type:"text",id:"edit-name",value:F,onChange:Te=>z(Te.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-contact_person",children:"Contact Person:"}),i.jsx("input",{type:"text",id:"edit-contact_person",value:B,onChange:Te=>R(Te.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-phone",children:"Phone:"}),i.jsx("input",{type:"text",id:"edit-phone",value:U,onChange:Te=>Y(Te.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-email",children:"Email:"}),i.jsx("input",{type:"email",id:"edit-email",value:Z,onChange:Te=>ne(Te.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-address",children:"Address:"}),i.jsx("textarea",{id:"edit-address",value:ae,onChange:Te=>X(Te.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-gst_number",children:"GST Number:"}),i.jsx("input",{type:"text",id:"edit-gst_number",value:W,onChange:Te=>H(Te.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"edit-drug_license_number",children:"Drug License Number:"}),i.jsx("input",{type:"text",id:"edit-drug_license_number",value:he,onChange:Te=>D(Te.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Se,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Save Changes"})]})]})]})}),g&&E&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:Ue,className:"modal-close-button",children:""}),i.jsx("h3",{className:"modal-title",children:"Confirm Delete"}),i.jsxs("p",{children:['Are you sure you want to delete distributor "',E.name,'"?']}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:Ue,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:fe,className:"button-delete",children:"Delete"})]})]})}),v&&E&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content large-modal",children:[i.jsx("button",{onClick:lt,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Payments & Balance for ",E.name]}),o&&i.jsx("div",{className:"modal-error-message",children:o}),$&&i.jsxs("div",{className:"balance-summary",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Total Order Value:"})," ",$.totalOrderValue.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Total Amount Paid:"})," ",$.totalAmountPaid.toFixed(2)]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Remaining Balance:"})," ",$.remainingBalance.toFixed(2)]})]}),i.jsx("h4",{children:"Payment History"}),I.length===0?i.jsx("p",{children:"No payments recorded for this distributor."}):i.jsx("div",{className:"table-responsive",children:i.jsxs("table",{className:"distributor-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Date"}),i.jsx("th",{children:"Order Value"}),i.jsx("th",{children:"Amount Paid"}),i.jsx("th",{children:"Balance Remaining"}),i.jsx("th",{children:"Notes"})]})}),i.jsx("tbody",{children:I.map(Te=>i.jsxs("tr",{children:[i.jsx("td",{children:new Date(Te.payment_date).toLocaleDateString()}),i.jsxs("td",{children:["",Te.order_value.toFixed(2)]}),i.jsxs("td",{children:["",Te.amount_paid.toFixed(2)]}),i.jsxs("td",{children:["",Te.balance_remaining.toFixed(2)]}),i.jsx("td",{children:Te.notes||"-"})]},Te.id))})]})}),i.jsx("div",{className:"modal-actions",children:i.jsx("button",{type:"button",onClick:lt,className:"button-cancel",children:"Close"})})]})}),k&&E&&i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsx("button",{onClick:pt,className:"modal-close-button",children:""}),i.jsxs("h3",{className:"modal-title",children:["Add Payment for ",E.name]}),o&&i.jsx("div",{className:"modal-error-message",children:o}),i.jsxs("form",{onSubmit:Re,children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_date",children:"Payment Date:"}),i.jsx("input",{type:"date",id:"payment_date",value:te,onChange:Te=>ve(Te.target.value),required:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"order_value",children:"Order Value:"}),i.jsx("input",{type:"number",id:"order_value",value:M,onChange:Te=>ge(Te.target.value),onBlur:Te=>{Te.target.value===""&&ge("0")},step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"amount_paid",children:"Amount Paid:"}),i.jsx("input",{type:"number",id:"amount_paid",value:_e,onChange:Te=>se(Te.target.value),onBlur:Te=>{Te.target.value===""&&se("0")},step:"0.01"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"payment_notes",children:"Notes:"}),i.jsx("textarea",{id:"payment_notes",value:ee,onChange:Te=>oe(Te.target.value)})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:pt,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"submit",className:"button-submit",children:"Add Payment"})]})]})]})})]})},$ne=({isOpen:e,onClose:n,excelHeaders:t,onConfirm:r,availableFields:a})=>{const[o,l]=w.useState({});if(w.useEffect(()=>{e&&d()},[e,t,a]),!e)return null;const h=(f,g)=>{l(b=>({...b,[f]:g}))},d=()=>{const f={};t.forEach(g=>{const b=a.map(S=>({name:S})),v=Rd(g,b);v&&(f[g]=v.name)}),l(f)},u=()=>{const f={};for(const g in o)o[g]&&o[g]!=="none"&&(f[g]=o[g]);r(f),n()};return i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content",children:[i.jsxs("div",{className:"modal-body",children:[i.jsx("button",{onClick:n,className:"modal-close-button",children:i.jsx(In,{size:20})}),i.jsx("h3",{className:"modal-title",children:"Match File Columns"}),i.jsx("p",{className:"modal-description",children:'Please match the columns from your uploaded file to the corresponding fields in the drug inventory. You can use the "Auto Match" button for suggestions.'}),i.jsx("div",{className:"modal-actions-top",children:i.jsx("button",{type:"button",onClick:d,className:"button-auto-match",children:"Auto Match"})}),i.jsxs("div",{className:"column-mapping-grid",children:[i.jsx("div",{className:"grid-header",children:"Excel Column"}),i.jsx("div",{className:"grid-header",children:"App Field"}),t.map((f,g)=>i.jsxs(Pn.Fragment,{children:[i.jsx("div",{className:"excel-header-cell",children:f}),i.jsx("div",{className:"app-field-cell",children:i.jsxs("select",{value:o[f]||"",onChange:b=>h(f,b.target.value),className:"app-field-select",children:[i.jsx("option",{value:"",children:"-- Select Field --"}),i.jsx("option",{value:"none",children:"None (Ignore Column)"}),a.map((b,v)=>i.jsxs("option",{value:b,children:[b==="name"?"Composition Name":b==="brand_name"?"Brand Name":b==="price"?"MRP":b==="buying_price"?"Rate":b==="unit"?"Pack":b==="batch"?"Batch":b==="hsn_code"?"HSN Code":b==="mfg"?"MFG":b==="loose_quantity"?"Loose":b.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase())," "]},v))]})})]},g))]})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{type:"button",onClick:n,className:"button-cancel",children:"Cancel"}),i.jsx("button",{type:"button",onClick:u,className:"button-submit",children:"Confirm Mapping"})]})]})})},zne=({isOpen:e,onClose:n,onDrugAddedToPurchase:t})=>{const[r,a]=w.useState({name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",expiry_date:"",buying_price:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),[o,l]=w.useState(null),[h,d]=w.useState(!1),[u,f]=w.useState(!1),g=w.useRef(null),b=w.useRef(null),v=w.useRef(null);w.useEffect(()=>{e&&(a({name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",expiry_date:"",buying_price:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),l(null),d(!1),f(!1))},[e]),w.useEffect(()=>{const E=I=>{I.key==="Tab"&&b.current===document.activeElement&&(u||(f(!0),setTimeout(()=>{var q;(q=v.current)==null||q.focus()},0),I.preventDefault()))},P=I=>{g.current&&!g.current.contains(I.target)&&f(!1)};return document.addEventListener("keydown",E),document.addEventListener("mousedown",P),()=>{document.removeEventListener("keydown",E),document.removeEventListener("mousedown",P)}},[u]);const S=E=>{const{name:P,value:I}=E.target;a(q=>({...q,[P]:I}))},k=E=>{const{name:P,value:I}=E.target;a(I===""?q=>({...q,[P]:0}):q=>({...q,[P]:parseFloat(I)||0}))},T=E=>{if(E.preventDefault(),l(null),d(!0),r.price===void 0||r.quantity_in_stock===void 0){l("MRP and Stock Quantity are required."),d(!1);return}const P={...r,name:r.name===""?null:r.name,composition:r.composition===""?null:r.composition,buying_price:r.buying_price===0?null:r.buying_price,expiry_date:r.expiry_date===""?null:r.expiry_date,gst:r.gst===0?null:r.gst,margin:r.margin===0?null:r.margin,discount:r.discount===0?null:r.discount,brand_name:r.brand_name===""?null:r.brand_name,batch:r.batch===""?null:r.batch,hsn_code:r.hsn_code===""?null:r.hsn_code,mfg:r.mfg===""?null:r.mfg,loose:r.loose===0?null:r.loose};t(P),d(!1),n()};return e?i.jsx("div",{className:"modal-overlay",children:i.jsxs("div",{className:"modal-content add-drug-form-container max-w-2xl mx-auto",children:[i.jsxs("div",{className:"add-drug-form-header",children:[i.jsx("h2",{children:"Add New Drug"}),i.jsx("button",{onClick:n,className:"cancel-button",title:"Close",children:i.jsx(In,{size:24})})]}),o&&i.jsx("div",{className:"error-message",children:o}),i.jsxs("form",{onSubmit:T,className:"add-drug-form",children:[i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"name",className:"form-label",children:"Composition Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(As,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"name",id:"name",value:r.name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Paracetamol",tabIndex:1})]}),i.jsxs("div",{className:"sm-col-span-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"brand_name",className:"form-label",children:"Brand Name"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(As,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),i.jsx("input",{type:"text",name:"brand_name",id:"brand_name",value:r.brand_name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Calpol",tabIndex:2})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"price",className:"form-label",children:"MRP () *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(As,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),i.jsx("input",{type:"number",name:"price",id:"price",required:!0,step:"0.01",min:"0",value:r.price??"",onChange:S,onBlur:k,className:"custom-text-input mt-1",placeholder:"e.g., 500",tabIndex:3})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("label",{htmlFor:"quantity_in_stock",className:"form-label",children:"Stock Quantity *"}),i.jsxs("div",{className:"relative ml-2 group",children:[i.jsx(As,{size:16,className:"text-gray-400"}),i.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),i.jsx("input",{type:"number",name:"quantity_in_stock",id:"quantity_in_stock",required:!0,step:"1",min:"0",value:r.quantity_in_stock??"",onChange:S,onBlur:k,className:"custom-text-input mt-1",placeholder:"e.g., 5",tabIndex:4})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"unit",className:"form-label",children:"Pack (e.g., strip, bottle)"}),i.jsx("input",{type:"text",name:"unit",id:"unit",value:r.unit||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., strip, bottle",tabIndex:5})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"expiry_date",className:"form-label",children:"Expiry Date"}),i.jsx("input",{type:"date",name:"expiry_date",id:"expiry_date",value:r.expiry_date||"",onChange:S,className:"custom-text-input mt-1",tabIndex:6})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"box_number",className:"form-label",children:"Box Number"}),i.jsx("input",{type:"text",name:"box_number",id:"box_number",value:r.box_number||"",onChange:S,className:"custom-text-input mt-1",tabIndex:7})]}),i.jsxs("div",{className:"relative sm-col-span-2",ref:g,children:[i.jsx("button",{type:"button",onClick:()=>f(!u),className:"form-button w-full text-left",tabIndex:8,ref:b,children:"Others"}),u&&i.jsxs("div",{className:"others-fields-grid",children:[" ",i.jsxs("div",{className:"sm-col-span-2",children:[i.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),i.jsx("textarea",{name:"description",id:"description",rows:3,value:r.description||"",onChange:S,className:"custom-text-input mt-1",tabIndex:9})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"buying_price",className:"form-label",children:"Rate ()"}),i.jsx("input",{type:"number",name:"buying_price",id:"buying_price",step:"0.01",min:"0",value:r.buying_price??"",onChange:S,onBlur:k,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:10,ref:v})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"gst",className:"form-label",children:"GST (%)"}),i.jsx("input",{type:"number",name:"gst",id:"gst",step:"0.01",min:"0",max:"100",value:r.gst??"",onChange:S,onBlur:k,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:11})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"margin",className:"form-label",children:"Margin (%)"}),i.jsx("input",{type:"number",name:"margin",id:"margin",step:"0.01",min:"0",max:"100",value:r.margin??"",onChange:S,onBlur:k,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:12})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"discount",className:"form-label",children:"Discount (%)"}),i.jsx("input",{type:"number",name:"discount",id:"discount",step:"0.01",min:"0",max:"100",value:r.discount??"",onChange:S,onBlur:k,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:13})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"batch",className:"form-label",children:"Batch"}),i.jsx("input",{type:"text",name:"batch",id:"batch",value:r.batch||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:14})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"hsn_code",className:"form-label",children:"HSN Code"}),i.jsx("input",{type:"text",name:"hsn_code",id:"hsn_code",value:r.hsn_code||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:15})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"mfg",className:"form-label",children:"MFG"}),i.jsx("input",{type:"text",name:"mfg",id:"mfg",value:r.mfg||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:16})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"loose",className:"form-label",children:"Loose Quantity"}),i.jsx("input",{type:"number",name:"loose",id:"loose",step:"1",min:"0",value:r.loose??"",onChange:S,onBlur:k,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:17})]})]})]})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{type:"button",onClick:n,disabled:h,className:"form-button cancel-form-button",tabIndex:18,children:"Cancel"}),i.jsx("button",{type:"submit",disabled:h,className:"form-button submit-form-button inline-flex justify-center",tabIndex:19,children:h?"Adding...":"Add Drug"})]})]})]})}):null},Bne=e=>{if(!e)return null;const n=String(e).trim().toLowerCase();if(!n)return null;const t={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12",january:"01",february:"02",march:"03",april:"04",june:"06",july:"07",august:"08",september:"09",october:"10",november:"11",december:"12"};let r,a,o;const l=n.match(/^(\d{1,2})[\s\-./]*([a-z]{3})[a-z]*[\s\-./]*(\d{2,4})$/),h=n.match(/^([a-z]{3})[a-z]*[\s\-./]*(\d{1,2})[\s\-./]*(\d{2,4})$/),d=n.match(/^(\d{1,2})[\s\-./]+(\d{1,2})[\s\-./]+(\d{2,4})$/);if(l)r=l[1],a=t[l[2].substring(0,3)],o=l[3];else if(h)a=t[h[1].substring(0,3)],r=h[2],o=h[3];else if(d)r=d[1],a=d[2],o=d[3];else{const f=Date.parse(n);return isNaN(f)?null:new Date(f).toISOString().split("T")[0]}if(!r||!a||!o)return null;o.length===2&&(o=(parseInt(o)<50?"20":"19")+o),r=r.padStart(2,"0"),a=a.padStart(2,"0");const u=new Date(parseInt(o),parseInt(a)-1,parseInt(r));return u.getFullYear()===parseInt(o)&&u.getMonth()===parseInt(a)-1&&u.getDate()===parseInt(r)?`${o}-${a}-${r}`:null},Une=({purchaseRows:e,onCellChange:n,onRemoveDrug:t,onAddEmptyRow:r,lastAddMethod:a})=>{const o=w.useRef(new Map),[l,h]=w.useState(e.length);w.useEffect(()=>{var u;if(e.length>l&&a==="manual"){const f=e.length-1;(u=o.current.get(`${f}-name`))==null||u.focus()}h(e.length)},[e.length,l,a]);const d=(u,f,g)=>{const b=f===e.length-1;b&&u.key==="Enter"&&(u.preventDefault(),r()),b&&u.key==="Tab"&&g==="box_number"&&!u.shiftKey&&(u.preventDefault(),r())};return i.jsxs("table",{className:"data-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{width:"40px"},children:"#"}),i.jsx("th",{style:{minWidth:"180px"},children:"Drug Name"}),i.jsx("th",{style:{minWidth:"120px"},children:"Brand"}),i.jsx("th",{style:{minWidth:"100px"},children:"Batch"}),i.jsx("th",{style:{minWidth:"130px"},children:"Expiry"}),i.jsx("th",{style:{minWidth:"70px"},children:"Qty"}),i.jsx("th",{style:{minWidth:"70px"},children:"Free"}),i.jsx("th",{style:{minWidth:"70px"},children:"Unit"}),i.jsx("th",{style:{minWidth:"90px"},children:"Buy "}),i.jsx("th",{style:{minWidth:"90px"},children:"MRP "}),i.jsx("th",{style:{minWidth:"60px"},children:"Disc%"}),i.jsx("th",{style:{minWidth:"60px"},children:"GST%"}),i.jsx("th",{style:{minWidth:"70px"},children:"Mrgn%"}),i.jsx("th",{style:{minWidth:"80px"},children:"HSN"}),i.jsx("th",{style:{minWidth:"80px"},children:"Mfg"}),i.jsx("th",{style:{minWidth:"80px"},children:"Rack"}),i.jsx("th",{className:"sticky-col-right",style:{width:"50px",textAlign:"center"},children:i.jsx(Hi,{size:16})})]})}),i.jsx("tbody",{children:e.map((u,f)=>i.jsxs("tr",{children:[i.jsx("td",{style:{textAlign:"center",color:"var(--text-tertiary)",fontWeight:600,fontSize:"0.85rem"},children:f+1}),i.jsx("td",{children:i.jsx("input",{ref:g=>{o.current.set(`${f}-name`,g)},className:"table-input",value:u.name||"",placeholder:"Name",onChange:g=>n(g,u.id||"","name"),onKeyDown:g=>d(g,f,"name"),autoComplete:"off"})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:u.brand_name||"",placeholder:"Brand",onChange:g=>n(g,u.id||"","brand_name"),onKeyDown:g=>d(g,f)})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:u.batch||"",placeholder:"Batch",onChange:g=>n(g,u.id||"","batch"),onKeyDown:g=>d(g,f)})}),i.jsx("td",{children:i.jsx("input",{type:"date",className:"table-input",value:u.expiry_date||"",onChange:g=>n(g,u.id||"","expiry_date"),onKeyDown:g=>d(g,f)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:u.quantity_in_stock??"",placeholder:"0",onChange:g=>n(g,u.id||"","quantity_in_stock"),onBlur:g=>n(g,u.id||"","quantity_in_stock"),onKeyDown:g=>d(g,f)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:u.loose??"",placeholder:"0",onChange:g=>n(g,u.id||"","loose"),onBlur:g=>n(g,u.id||"","loose"),onKeyDown:g=>d(g,f)})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:u.unit||"",placeholder:"Tab/Strip",onChange:g=>n(g,u.id||"","unit"),onKeyDown:g=>d(g,f)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:u.buying_price??"",placeholder:"0.00",onChange:g=>n(g,u.id||"","buying_price"),onBlur:g=>n(g,u.id||"","buying_price"),onKeyDown:g=>d(g,f)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:u.price??"",placeholder:"0.00",onChange:g=>n(g,u.id||"","price"),onBlur:g=>n(g,u.id||"","price"),onKeyDown:g=>d(g,f)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:u.discount??"",placeholder:"0",onChange:g=>n(g,u.id||"","discount"),onBlur:g=>n(g,u.id||"","discount"),onKeyDown:g=>d(g,f)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:u.gst??"",placeholder:"5",onChange:g=>n(g,u.id||"","gst"),onBlur:g=>n(g,u.id||"","gst"),onKeyDown:g=>d(g,f)})}),i.jsx("td",{children:i.jsx("input",{type:"number",className:"table-input",value:u.margin||"",placeholder:"0",onChange:g=>n(g,u.id||"","margin"),onKeyDown:g=>d(g,f),readOnly:!0,style:{color:"var(--secondary)",fontWeight:"bold",cursor:"default"}})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:u.hsn_code||"",placeholder:"HSN",onChange:g=>n(g,u.id||"","hsn_code"),onKeyDown:g=>d(g,f)})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:u.mfg||"",placeholder:"Mfg",onChange:g=>n(g,u.id||"","mfg"),onKeyDown:g=>d(g,f)})}),i.jsx("td",{children:i.jsx("input",{className:"table-input",value:u.box_number||"",placeholder:"Rack",onChange:g=>n(g,u.id||"","box_number"),onKeyDown:g=>d(g,f,"box_number")})}),i.jsx("td",{className:"sticky-col-right",style:{textAlign:"center"},children:i.jsx("button",{onClick:()=>t(u.id||""),className:"delete-row-btn",tabIndex:-1,title:"Remove Row",children:i.jsx(Hi,{size:16})})})]},u.id))})]})},pC=()=>{const e=Ot(),[,n]=w.useState(!1),t=w.useRef(null),[r,a]=w.useState(""),[o,l]=w.useState([]),[h,d]=w.useState(null),[u,f]=w.useState(!1),g=w.useRef(null),[b,v]=w.useState(!1),[S,k]=w.useState(!1),[T,E]=w.useState([]),[P,I]=w.useState(null),[q,$]=w.useState(null),[L,F]=w.useState(0),[z,B]=w.useState([]),[R,U]=w.useState("manual"),Y=["name","description","price","quantity_in_stock","unit","supplier","expiry_date","buying_price","box_number","gst","margin","discount","brand_name","batch","hsn_code","mfg","loose"],Z=w.useCallback((ge,_e="manual")=>{const se=ge||(h?h.name:"");U(_e),B(ee=>[...ee,{id:Date.now().toString()+Math.random().toString(36).substring(2,9),name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",supplier:se,expiry_date:"",buying_price:0,box_number:"",gst:5,margin:0,discount:0,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:0,last_updated:"",created_at:""}])},[h]),ne=ge=>B(_e=>_e.filter(se=>se.id!==ge)),ae=(ge,_e,se)=>{const{value:ee}=ge.target;B(oe=>(oe.findIndex(Ee=>Ee.id===_e)===oe.length-1&&ee.trim()!==""&&setTimeout(()=>Z(void 0,"auto"),0),oe.map(Ee=>{if(Ee.id===_e){let Ie=ee;["price","quantity_in_stock","buying_price","gst","margin","discount","loose"].includes(se)?ge.type==="blur"?Ie=parseFloat(ee)||0:Ie=ee:se==="expiry_date"&&(Ie=ee.trim()===""?null:ee);const fe={...Ee,[se]:Ie};if(h&&(fe.supplier=h.name),["buying_price","price","gst"].includes(se)){const pe=Number(se==="buying_price"?Ie:fe.buying_price),Re=Number(se==="price"?Ie:fe.price),Ye=Number(se==="gst"?Ie:fe.gst);if(Re&&Re>0&&pe!==void 0&&pe!==null){const ut=pe*(1+(Ye||0)/100);fe.margin=parseFloat(((Re-ut)/Re*100).toFixed(2))}}return fe}return Ee})))},X=w.useCallback(()=>z.reduce((ge,_e)=>{const se=Number(_e.quantity_in_stock)||0,ee=Number(_e.buying_price)||0,oe=Number(_e.gst)||0,ue=Number(_e.discount)||0;let Ee=ee*(1-ue/100),Ie=se*Ee;return Ie+=Ie*(oe/100),ge+Ie},0),[z]),W=async()=>{if(!h){$("Select a distributor.");return}const ge=z.filter(_e=>_e.name&&_e.name.trim()!==""||Number(_e.buying_price)>0);if(ge.length===0){$("No valid items.");return}n(!0),$(null),lo.addRequest();try{for(const ee of ge){const oe={...ee,price:Number(ee.price),quantity_in_stock:Number(ee.quantity_in_stock),buying_price:Number(ee.buying_price),gst:Number(ee.gst),margin:Number(ee.margin),discount:Number(ee.discount),loose:Number(ee.loose),supplier:h.name,expiry_date:ee.expiry_date||null,distributorId:h.id};if(!(await de("/api/drugs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(oe)})).ok)throw new Error(`Failed to add ${ee.name}`)}const _e=X();if(!(await de(`/api/distributors/${h.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:new Date().toISOString().split("T")[0],order_value:_e,amount_paid:L,notes:`Purchase - ${ge.length} items`})})).ok)throw new Error("Payment record failed.");B([]),d(null),a(""),F(0),alert("Success!"),e("/dashboard/inventory")}catch(_e){$(_e.message||"Failed.")}finally{n(!1),lo.removeRequest()}},H=async ge=>{var ee,oe;const _e=(ee=ge.target.files)==null?void 0:ee[0];if(!_e)return;n(!0),lo.addRequest(),$(null),I(_e);const se=(oe=_e.name.split(".").pop())==null?void 0:oe.toLowerCase();if(["xlsx","xls","csv"].includes(se||"")){const ue=new FormData;ue.append("inventoryFile",_e);try{const Ee=await de("/api/drugs/get-file-headers",{method:"POST",body:ue});if(!Ee.ok)throw new Error("Failed headers");const{headers:Ie}=await Ee.json();E(Ie),v(!0)}catch(Ee){$(Ee.message),I(null)}finally{n(!1),lo.removeRequest()}}else if(["pdf","png","jpg","jpeg"].includes(se||"")){const ue=new FormData;ue.append("file",_e),ue.append("output_type","csv");const Ee="00841ac4-b279-11f0-ab55-0a3a41e3fad1";try{const Ie=await fetch("https://extraction-api.nanonets.com/extract",{method:"POST",headers:{Authorization:`Bearer ${Ee}`},body:ue});if(!Ie.ok)throw new Error("OCR Failed");const fe=await Ie.json();if(!fe.success||!fe.content)throw new Error("No data from OCR");let pe=fe.content.split(`
`).filter(Se=>!Se.startsWith("#")&&Se.trim()).join(`
`);const Re=new File([pe],"ocr.csv",{type:"text/csv"}),Ye=new FormData;Ye.append("inventoryFile",Re);const ut=await de("/api/drugs/get-file-headers",{method:"POST",body:Ye});if(!ut.ok)throw new Error("Failed parsing OCR CSV");const{headers:Ge}=await ut.json();E(Ge),I(Re),v(!0)}catch(Ie){$(Ie.message),I(null)}finally{n(!1),lo.removeRequest()}}else $("Unsupported file"),n(!1),lo.removeRequest()},he=async ge=>{if(!P)return;n(!0),lo.addRequest();const _e=new FormData;_e.append("inventoryFile",P),_e.append("columnMapping",JSON.stringify(ge));try{const se=await de("/api/drugs/parse-excel",{method:"POST",body:_e});if(!se.ok)throw new Error("Parse Failed");const oe=(await se.json()).map(ue=>({...ue,id:Date.now().toString()+Math.random(),supplier:(h==null?void 0:h.name)||ue.supplier,expiry_date:Bne(ue.expiry_date)}));B(ue=>[...ue,...oe])}catch(se){$(se.message)}finally{n(!1),lo.removeRequest(),v(!1),t.current&&(t.current.value="")}},D=w.useCallback(async ge=>{const _e=ge.trim()===""?"/api/distributors":`/api/distributors?search=${encodeURIComponent(ge)}`;try{const se=await de(_e);if(se.ok){const ee=await se.json();l(ge.trim()===""?ee.slice(0,4):ee)}}catch(se){console.error(se)}},[]),te=ge=>{const _e=ge.target.value;a(_e),g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{D(_e),f(!0)},300)},ve=()=>{r.trim()===""&&D(""),f(!0)},M=ge=>{d(ge),a(""),f(!1),l([]),B(_e=>_e.map(se=>({...se,supplier:ge.name}))),z.length===0&&Z(ge.name,"manual")};return i.jsxs("div",{className:"purchase-page",children:[i.jsx("div",{className:"purchase-header",children:i.jsxs("div",{className:"header-left",children:[i.jsx("button",{onClick:()=>e(-1),className:"icon-btn",children:i.jsx(on,{size:20})}),i.jsx("h2",{className:"purchase-page-title",children:"New Purchase"})]})}),q&&i.jsxs("div",{className:"error-banner",style:{background:"var(--danger-bg)",color:"var(--danger)",padding:"12px",borderRadius:"8px",marginBottom:"20px",display:"flex",gap:"10px"},children:[i.jsx(ui,{size:20}),i.jsx("span",{children:q})]}),i.jsxs("div",{className:"purchase-controls-grid",children:[i.jsxs("div",{className:"control-card",children:[i.jsxs("div",{className:"card-header",children:[i.jsxs("h3",{children:[i.jsx(MM,{size:20,className:"card-icon"})," Distributor"]}),i.jsxs("button",{onClick:()=>e("/dashboard/distributors"),className:"icon-btn",style:{width:"auto",borderRadius:"6px",fontSize:"0.8rem",padding:"6px 12px"},children:[i.jsx(Uf,{size:16})," Manage"]})]}),h?i.jsxs("div",{className:"selected-distributor-card",children:[i.jsxs("div",{children:[i.jsx("strong",{children:h.name}),i.jsx("br",{}),i.jsx("span",{style:{opacity:.8},children:h.contact_person})]}),i.jsx("button",{onClick:()=>d(null),style:{background:"none",border:"none",color:"var(--primary)",fontWeight:"bold",cursor:"pointer"},children:"Change"})]}):i.jsxs("div",{className:"distributor-search-wrapper",children:[i.jsxs("div",{className:"search-input-group",children:[i.jsx(Ai,{size:18,className:"search-input-icon"}),i.jsx("input",{className:"distributor-input",placeholder:"Search...",value:r,onChange:te,onFocus:ve})]}),u&&o.length>0&&i.jsx("ul",{className:"search-dropdown",children:o.map(ge=>i.jsx("li",{onClick:()=>M(ge),children:ge.name},ge.id))})]})]}),i.jsxs("div",{className:"control-card",children:[i.jsx("div",{className:"card-header",children:i.jsxs("h3",{children:[i.jsx(OM,{size:20,className:"card-icon"})," Import & Actions"]})}),i.jsxs("div",{className:"action-buttons-row",children:[i.jsx("input",{ref:t,type:"file",hidden:!0,accept:".xlsx,.xls,.csv,.pdf,.png,.jpg",onChange:H}),i.jsxs("button",{onClick:()=>{var ge;return(ge=t.current)==null?void 0:ge.click()},disabled:!h,className:"btn-base btn-primary",children:[i.jsx(ns,{size:18})," Import File"]}),i.jsxs("button",{onClick:()=>k(!0),disabled:!h,className:"btn-base btn-manual",children:[i.jsx(hl,{size:18})," Manual"]})]}),i.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-tertiary)",marginTop:"8px",textAlign:"center"},children:"Supports Excel, CSV, PDF, Images"})]})]}),i.jsx($ne,{isOpen:b,onClose:()=>v(!1),excelHeaders:T,onConfirm:he,availableFields:Y}),S&&i.jsx(zne,{isOpen:S,onClose:()=>k(!1),onDrugAddedToPurchase:ge=>{B(_e=>[..._e,{...ge,id:Date.now().toString(),supplier:(h==null?void 0:h.name)||""}]),k(!1)}}),i.jsxs("div",{className:"table-container",children:[i.jsx("div",{className:"table-header-title",children:i.jsxs("h3",{children:["Items (",z.length,")"]})}),i.jsx("div",{className:"table-scroll-wrapper",children:i.jsx(Une,{purchaseRows:z,onCellChange:ae,onRemoveDrug:ne,onAddEmptyRow:()=>Z(void 0,"manual"),lastAddMethod:R})}),z.length===0&&i.jsx("div",{style:{padding:"40px",textAlign:"center",color:"var(--text-tertiary)"},children:"Select distributor to start."})]}),i.jsxs("div",{className:"purchase-footer",children:[i.jsxs("button",{onClick:()=>Z(void 0,"manual"),className:"btn-base btn-secondary",style:{width:"auto",flex:0},children:[i.jsx(hl,{size:16})," Add Row"]}),i.jsxs("div",{className:"footer-right",children:[i.jsxs("div",{className:"financial-input-group",children:[i.jsx("label",{children:"Paid:"}),i.jsx("input",{type:"number",value:L,onChange:ge=>F(parseFloat(ge.target.value)||0),className:"amount-paid-input"})]}),i.jsxs("div",{className:"total-display",children:[i.jsx("span",{children:"Total"}),i.jsxs("span",{className:"total-value",children:["",X().toFixed(2)]})]}),i.jsxs("button",{onClick:W,className:"submit-btn success",disabled:z.length===0,children:[i.jsx(Ds,{size:20,className:"btn-icon"}),"Submit Purchase"]})]})]})]})},qne=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)/);return n&&n[1]?parseInt(n[1],10):1},Vne=()=>{const e=Ot(),n=Cr(),[t,r]=w.useState(null),[a,o]=w.useState([]),[l,h]=w.useState(!0),[d,u]=w.useState(null),[f,g]=w.useState(!1),[b,v]=w.useState("cash"),[S,k]=w.useState(""),[T,E]=w.useState(""),[P,I]=w.useState(""),[q,$]=w.useState(""),[L,F]=w.useState(""),[z,B]=w.useState(0),R=w.useRef(!1),U=te=>{if(B(te),te!==""){const ve=Math.max(0,Math.min(100,parseFloat(te)||0));R.current=!0;const M=a.map(ge=>({...ge,discount_percentage:ve}));o(M)}},Y=()=>{if(z==="")U("0");else{const te=Math.max(0,Math.min(100,parseFloat(String(z))||0));B(te)}},Z=(te,ve)=>{const M=[...a];M[te].discount_percentage=ve,o(M)},ne=te=>{const ve=[...a],M=ve[te].discount_percentage;M===""?ve[te].discount_percentage=0:ve[te].discount_percentage=Math.max(0,Math.min(100,parseFloat(String(M))||0)),o(ve)};w.useEffect(()=>{if(R.current){R.current=!1;return}const te=a.reduce((ge,_e)=>ge+(_e.total_price??0),0);if(te===0){B(0);return}const M=a.reduce((ge,_e)=>{const ee=(_e.total_price??0)*((Number(_e.discount_percentage)??0)/100);return ge+ee},0)/te*100;B(ge=>Math.abs(Number(ge)-M)>.01?M:ge)},[a]);const ae=async()=>{if(!t)return u("No order data available to bill."),null;if(a.length===0)return u("Cannot bill an empty order."),null;g(!0),u(null);try{const te=a.map(se=>{const ee=(se.pricePerLooseUnit??0)*(se.looseQuantity??0),oe=ee*((Number(se.discount_percentage)||0)/100),ue=ee-oe;return{name:se.name,pack_quantity:se.loosePacks??0,loose_quantity:se.looseUnits??0,price:se.originalPrice??0,pack_price:se.originalPrice??0,loose_price:se.pricePerLooseUnit??0,total:ue,drug_id:se.drug_id,discount_percentage:Number(se.discount_percentage)??0,batch:se.batch,expiry_date:se.expiry_date}}),ve={patientId:t.patientId,queueId:t.id,items:te,amount:D,paymentMode:b,type:"pharmacy",related_id:t.id,status:"paid",discountPercentage:Number(z)},M=await de("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ve)}),ge=await M.json();if(!M.ok||!ge.id)throw new Error(ge.message||"Failed to create bill.");const _e=await de(`/api/pharmacy-orders/${t.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"billed",bill_id:ge.id,medications:a})});if(!_e.ok){const se=await _e.text();throw new Error(`Failed to update pharmacy order status: ${_e.statusText} - ${se}`)}return r(se=>se?{...se,status:"billed",bill_id:ge.id}:null),alert(`Order ${t.patientName}'s bill created (ID: ${ge.id}) and marked as billed.`),e(`/dashboard/pharmacy-billing/${t.id}`,{replace:!0,state:{order:{...t,status:"billed",bill_id:ge.id},initialItems:a}}),ge.id}catch(te){return console.error("Billing process failed:",te),u(te.message||"Failed to mark order as billed. Please try again."),null}finally{g(!1)}},X=()=>{window.print()},W=async()=>{await ae()&&(window.print(),e(-1))};w.useEffect(()=>{const te=n.pathname.split("/"),ve=te[te.length-1];ve?(async()=>{try{const ge=await de(`/api/pharmacy-orders/${ve}`);if(!ge.ok)throw new Error("Failed to fetch pharmacy order details");const _e=await ge.json();r(_e);const se=_e.medications.map(ee=>{const oe=qne(ee.unit),ue=(ee.pack_quantity??0)*oe+(ee.loose_quantity??0);return{...ee,isLoose:!0,loosePacks:ee.pack_quantity??0,looseUnits:ee.loose_quantity??0,looseQuantity:ue,pack_price:Number(ee.pack_price)||0,loose_price:Number(ee.loose_price)||0,total_price:Number(ee.total_price)||0,pricePerLooseUnit:Number(ee.loose_price)||0,originalPrice:Number(ee.pack_price)||0,discount_percentage:Number(ee.discount_percentage)??0,directions_to_use:ee.directions_to_use,tabletsPerDay:ee.tabletsPerDay,numberOfDays:ee.numberOfDays,batch:ee.batch,expiry_date:ee.expiry_date}});o(se)}catch(ge){console.error("Failed to fetch order:",ge),u(ge.message||"Failed to load order details.")}finally{h(!1)}})():(u("No pharmacy order ID provided."),h(!1))},[n.pathname]),w.useEffect(()=>{(async()=>{try{const ve=await de("/api/clinics/settings");if(!ve.ok)throw new Error("Failed to fetch clinic settings");const M=await ve.json();E(M.upi_id||""),I(M.name||""),$(M.address||""),F(M.notes||"")}catch(ve){console.error("Error fetching clinic settings:",ve)}})()},[]);const H=w.useMemo(()=>a.reduce((te,ve)=>te+(ve.total_price??0),0),[a]),he=w.useMemo(()=>a.reduce((te,ve)=>{const ge=(ve.total_price??0)*(Number(ve.discount_percentage)??0)/100;return te+ge},0),[a]),D=w.useMemo(()=>H-he,[H,he]);return w.useEffect(()=>{if(D>0&&T){const te=`upi://pay?pa=${T}&pn=ClinicName&am=${D.toFixed(2)}&cu=INR`;k(te)}else k("")},[D,T]),l?i.jsx("div",{className:"loading-pulse",children:"Loading Bill..."}):d?i.jsxs("div",{className:"error-message-box",children:["Error: ",d]}):t?i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"TAX INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:P?`${P} Pharmacy`:"Pharmacy Bill"}),(q||L)&&i.jsxs("div",{className:"clinic-details-print",children:[q&&i.jsx("span",{className:"small-text clinic-address",children:q}),L&&i.jsx("span",{className:"small-text clinic-notes",children:L})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(fl,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Df,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Bf,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[i.jsx(on,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"Pharmacy Bill"})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Patient Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(fl,{size:16})," Patient Name"]})," ",t.patientName]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Df,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),i.jsxs("div",{className:"info-item no-print",children:[i.jsxs("strong",{children:[i.jsx(go,{size:16})," Order ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Bf,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Medications"})}),a.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"BATCH"}),i.jsx("th",{children:"EXPIRY"}),i.jsx("th",{children:"QUANTITY"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:a.map((te,ve)=>{var ee,oe;const M=te.total_price??0,ge=M*(Number(te.discount_percentage)||0)/100,_e=M-ge;return i.jsxs("tr",{children:[i.jsx("td",{children:ve+1}),i.jsx("td",{children:te.name}),i.jsx("td",{children:te.batch||"N/A"}),i.jsx("td",{children:te.expiry_date?new Date(te.expiry_date).toLocaleDateString():"N/A"}),i.jsxs("td",{children:[i.jsxs("div",{children:["Packs: ",te.loosePacks??0]}),i.jsxs("div",{children:["Loose: ",te.looseUnits??0]})]}),i.jsx("td",{children:((ee=te.originalPrice)==null?void 0:ee.toFixed(2))??"N/A"}),i.jsx("td",{children:((oe=te.pricePerLooseUnit)==null?void 0:oe.toFixed(2))??"N/A"}),i.jsxs("td",{children:[i.jsx("input",{type:"number",value:te.discount_percentage??0,onChange:ue=>Z(ve,ue.target.value),onBlur:()=>ne(ve),min:"0",max:"100",className:"discount-input-table"}),"%"]}),i.jsxs("td",{children:[5 .toFixed(1),"%"]}),i.jsx("td",{children:_e.toFixed(2)})]},ve)})})]}):i.jsx("p",{children:"No medications in this order."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[S&&i.jsxs("div",{className:`qr-code-container qr-code-printable-section ${b!=="upi"?"hide-on-screen":""}`,children:[i.jsx(Qf,{value:S,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",H.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsxs("span",{children:["Total Discount (",Number(z).toFixed(2),"%)"]}),i.jsxs("span",{children:["- ",he.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"GST (Included)"}),i.jsxs("span",{children:["",(D*.05).toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",D.toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Billing Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",H.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",he.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Discount Percentage"}),i.jsxs("div",{className:"discount-input-wrapper",children:[i.jsx("input",{type:"number",value:z,onChange:te=>U(te.target.value),onBlur:Y,min:"0",max:"100",className:"discount-input-total",disabled:f||t.status==="billed"}),"%"]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",D.toFixed(2)]})]}),i.jsx("div",{className:"qr-code-container",children:S?i.jsxs(i.Fragment,{children:[i.jsx(Qf,{value:S,size:90}),i.jsx("p",{children:"Scan to pay using UPI"})]}):i.jsx("p",{children:"UPI QR code not available. Please ensure UPI ID is configured."})}),i.jsxs("div",{className:"payment-mode-section",children:[i.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:i.jsx("strong",{children:"Payment Mode"})}),i.jsxs("select",{id:"paymentMode",value:b,onChange:te=>v(te.target.value),className:"payment-mode-select",disabled:f||t.status==="billed",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"upi",children:"UPI"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),i.jsx("option",{value:"credit",children:"Credit"})]})]}),i.jsxs("div",{className:"bill-actions",children:[t.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:X,className:"secondary-button print-preview-button no-print",disabled:f||a.length===0,children:"Print Preview"}),i.jsx("button",{onClick:W,className:"primary-button",disabled:f||a.length===0,children:f?"Processing...":"Finalise and Bill"})]}),t.status==="billed"&&i.jsx("button",{onClick:()=>e(`/dashboard/bills/${t.bill_id}`),className:"secondary-button",children:"View Bill"})]})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})}):i.jsx("div",{className:"error-message-box",children:"No order data available."})},Hne=()=>{var q,$,L,F,z;const{billId:e}=Yr(),n=Ot(),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,h]=w.useState(null),[d,u]=w.useState(""),[f,g]=w.useState(""),[b,v]=w.useState(""),[S,k]=w.useState("");w.useEffect(()=>{(async()=>{try{if(!e)throw new Error("Bill ID is missing");const R=await de(`/api/bills/${e}`);if(!R.ok)throw new Error("Failed to fetch bill details");const U=await R.json();r(U.bill);const Y=await de("/api/clinics/settings");if(Y.ok){const Z=await Y.json();if(u(Z.name||""),g(Z.address||""),v(Z.notes||""),Z.upi_id&&U.amount>0){const ne=`upi://pay?pa=${Z.upi_id}&pn=${encodeURIComponent(Z.name||"Clinic")}&am=${Number(U.amount).toFixed(2)}&cu=INR`;k(ne)}}}catch(R){console.error("Error fetching data:",R),h(R.message||"Failed to load bill details.")}finally{o(!1)}})()},[e]);const T=()=>{window.print()};if(a)return i.jsx("div",{className:"loading-pulse",children:"Loading Bill..."});if(l)return i.jsxs("div",{className:"error-message-box",children:["Error: ",l]});if(!t)return i.jsx("div",{className:"error-message-box",children:"No bill found."});const E=(t.items||[]).reduce((B,R)=>{const U=(Number(R.pack_price)||0)*(Number(R.pack_quantity)||0),Y=(Number(R.loose_price)||0)*(Number(R.loose_quantity)||0);return B+U+Y},0),P=E-Number(t.amount),I=Number(t.amount)*.05;return i.jsx("div",{className:"pharmacy-billing-page",children:i.jsxs("div",{className:"billing-container printable-section",children:[i.jsxs("div",{className:"billing-header print-only",children:[i.jsx("div",{className:"clinic-header-left",children:i.jsx("div",{className:"clinic-info-print",children:i.jsxs("div",{className:"clinic-name-and-details-print",children:[i.jsx("h1",{className:"bill-title",children:"TAX INVOICE"}),i.jsx("h2",{className:"clinic-name-print",children:d?`${d} Pharmacy`:"Pharmacy Bill"}),(f||b)&&i.jsxs("div",{className:"clinic-details-print",children:[f&&i.jsx("span",{className:"small-text clinic-address",children:f}),b&&i.jsx("span",{className:"small-text clinic-notes",children:b})]})]})})}),i.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(fl,{size:16})," Patient Name"]})," ",((q=t.Patient)==null?void 0:q.name)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Df,{size:16})," Token"]})," ",(($=t.Patient)==null?void 0:$.token_no)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Bf,{size:16})," Bill Date"]})," ",new Date(t.createdAt).toLocaleDateString()]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Df,{size:16})," Bill No"]})," ",((L=t.id)==null?void 0:L.slice(0,8).toUpperCase())||"N/A"]})]})]}),i.jsxs("header",{className:"billing-header no-print",children:[i.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:[i.jsx(on,{size:20}),i.jsx("span",{children:"Back"})]}),i.jsx("h1",{children:"View Bill"}),i.jsxs("button",{onClick:T,className:"primary-button",style:{marginLeft:"auto",width:"auto",padding:"0.5rem 1rem"},children:[i.jsx(fo,{size:16,style:{marginRight:"8px"}})," Print"]})]}),i.jsxs("div",{className:"billing-layout",children:[i.jsxs("main",{className:"order-content",children:[i.jsxs("section",{className:"order-details-card no-print",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Bill Information"})}),i.jsxs("div",{className:"patient-info-grid",children:[i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(fl,{size:16})," Patient Name"]})," ",((F=t.Patient)==null?void 0:F.name)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Df,{size:16})," Token"]})," ",((z=t.Patient)==null?void 0:z.token_no)||"N/A"]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Df,{size:16})," Bill ID"]})," ",t.id]}),i.jsxs("div",{className:"info-item",children:[i.jsxs("strong",{children:[i.jsx(Bf,{size:16})," Date"]})," ",new Date(t.createdAt).toLocaleString()]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Status"})," ",i.jsx("span",{className:"status-badge status-billed",children:t.status})]})]})]}),i.jsxs("section",{className:"medications-card",children:[i.jsx("div",{className:"card-header no-print",children:i.jsx("h2",{children:"Items"})}),t.items&&t.items.length>0?i.jsxs("table",{className:"medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"S.No."}),i.jsx("th",{children:"DESCRIPTION"}),i.jsx("th",{children:"BATCH"}),i.jsx("th",{children:"EXPIRY"}),i.jsx("th",{children:"QUANTITY"}),i.jsx("th",{children:"MRP"}),i.jsx("th",{children:"RATE"}),i.jsx("th",{children:"DIS %"}),i.jsx("th",{children:"GST%"}),i.jsx("th",{children:"AMT"})]})}),i.jsx("tbody",{children:t.items.map((B,R)=>{const U=Number(B.total)||0,Y=5;let Z="N/A";if(B.expiry_date)try{Z=new Date(B.expiry_date).toLocaleDateString()}catch{}return i.jsxs("tr",{children:[i.jsx("td",{children:R+1}),i.jsx("td",{children:B.name}),i.jsx("td",{children:B.batch||"N/A"}),i.jsx("td",{children:Z}),i.jsxs("td",{children:[i.jsxs("div",{children:["Packs: ",B.pack_quantity??0]}),i.jsxs("div",{children:["Loose: ",B.loose_quantity??0]})]}),i.jsx("td",{children:Number(B.pack_price||0).toFixed(2)}),i.jsx("td",{children:Number(B.loose_price||0).toFixed(2)}),i.jsxs("td",{children:[Number(B.discount_percentage||0),"%"]}),i.jsxs("td",{children:[Y.toFixed(1),"%"]}),i.jsx("td",{children:U.toFixed(2)})]},R)})})]}):i.jsx("p",{children:"No items in this bill."})]}),i.jsxs("div",{className:"bill-summary-print print-only",children:[S&&i.jsxs("div",{className:"qr-code-container qr-code-printable-section",children:[i.jsx(Qf,{value:S,size:100}),i.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),i.jsxs("div",{className:"bill-summary-details",children:[i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",E.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"Discount"}),i.jsxs("span",{children:["- ",P.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row-print",children:[i.jsx("span",{children:"GST (Included)"}),i.jsxs("span",{children:["",I.toFixed(2)]})]}),i.jsx("div",{className:"print-only-total",children:i.jsxs("strong",{children:["Grand Total: ",Number(t.amount).toFixed(2)]})})]})]})]}),i.jsx("aside",{className:"billing-sidebar no-print",children:i.jsxs("div",{className:"billing-summary-card",children:[i.jsx("div",{className:"card-header",children:i.jsx("h2",{children:"Payment Summary"})}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Subtotal"}),i.jsxs("span",{children:["",E.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Total Discount"}),i.jsxs("span",{children:["- ",P.toFixed(2)]})]}),i.jsxs("div",{className:"summary-row grand-total-row",children:[i.jsx("strong",{children:"Grand Total"}),i.jsxs("strong",{children:["",Number(t.amount).toFixed(2)]})]}),i.jsxs("div",{className:"payment-mode-section",style:{marginTop:"1rem",padding:"1rem",background:"#f8f9fa",borderRadius:"8px"},children:[i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Payment Mode:"})," ",(t.payment_mode||"N/A").toUpperCase()]}),i.jsxs("div",{className:"info-item",children:[i.jsx("strong",{children:"Payment Status:"})," ",(t.status||"N/A").toUpperCase()]})]}),i.jsx("div",{className:"qr-code-container",children:S&&i.jsxs(i.Fragment,{children:[i.jsx(Qf,{value:S,size:128}),i.jsx("p",{children:"Scan to pay using UPI"})]})}),i.jsx("div",{className:"bill-actions",children:i.jsxs("button",{onClick:T,className:"primary-button",style:{width:"100%"},children:[i.jsx(fo,{size:16,style:{marginRight:"8px"}})," Print Bill"]})})]})})]}),i.jsxs("footer",{className:"billing-footer print-only",children:[i.jsx("p",{children:"Thank you for your business!"}),i.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})})};function cc(e){return Array.isArray?Array.isArray(e):JT(e)==="[object Array]"}function Gne(e){if(typeof e=="string")return e;let n=e+"";return n=="0"&&1/e==-1/0?"-0":n}function Yne(e){return e==null?"":Gne(e)}function ul(e){return typeof e=="string"}function WT(e){return typeof e=="number"}function Wne(e){return e===!0||e===!1||Qne(e)&&JT(e)=="[object Boolean]"}function QT(e){return typeof e=="object"}function Qne(e){return QT(e)&&e!==null}function es(e){return e!=null}function K0(e){return!e.trim().length}function JT(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const Jne="Incorrect 'index' type",Kne=e=>`Invalid value for key ${e}`,Xne=e=>`Pattern length exceeds max of ${e}.`,Zne=e=>`Missing ${e} property in key`,eie=e=>`Property 'weight' in key '${e}' must be a positive integer`,mC=Object.prototype.hasOwnProperty;class tie{constructor(n){this._keys=[],this._keyMap={};let t=0;n.forEach(r=>{let a=KT(r);this._keys.push(a),this._keyMap[a.id]=a,t+=a.weight}),this._keys.forEach(r=>{r.weight/=t})}get(n){return this._keyMap[n]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function KT(e){let n=null,t=null,r=null,a=1,o=null;if(ul(e)||cc(e))r=e,n=gC(e),t=X1(e);else{if(!mC.call(e,"name"))throw new Error(Zne("name"));const l=e.name;if(r=l,mC.call(e,"weight")&&(a=e.weight,a<=0))throw new Error(eie(l));n=gC(l),t=X1(l),o=e.getFn}return{path:n,id:t,weight:a,src:r,getFn:o}}function gC(e){return cc(e)?e:e.split(".")}function X1(e){return cc(e)?e.join("."):e}function nie(e,n){let t=[],r=!1;const a=(o,l,h)=>{if(es(o))if(!l[h])t.push(o);else{let d=l[h];const u=o[d];if(!es(u))return;if(h===l.length-1&&(ul(u)||WT(u)||Wne(u)))t.push(Yne(u));else if(cc(u)){r=!0;for(let f=0,g=u.length;f<g;f+=1)a(u[f],l,h+1)}else l.length&&a(u,l,h+1)}};return a(e,ul(n)?n.split("."):n,0),r?t:t[0]}const iie={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},rie={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,n)=>e.score===n.score?e.idx<n.idx?-1:1:e.score<n.score?-1:1},aie={location:0,threshold:.6,distance:100},sie={useExtendedSearch:!1,getFn:nie,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var Kt={...rie,...iie,...aie,...sie};const oie=/[^ ]+/g;function lie(e=1,n=3){const t=new Map,r=Math.pow(10,n);return{get(a){const o=a.match(oie).length;if(t.has(o))return t.get(o);const l=1/Math.pow(o,.5*e),h=parseFloat(Math.round(l*r)/r);return t.set(o,h),h},clear(){t.clear()}}}class lN{constructor({getFn:n=Kt.getFn,fieldNormWeight:t=Kt.fieldNormWeight}={}){this.norm=lie(t,3),this.getFn=n,this.isCreated=!1,this.setIndexRecords()}setSources(n=[]){this.docs=n}setIndexRecords(n=[]){this.records=n}setKeys(n=[]){this.keys=n,this._keysMap={},n.forEach((t,r)=>{this._keysMap[t.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,ul(this.docs[0])?this.docs.forEach((n,t)=>{this._addString(n,t)}):this.docs.forEach((n,t)=>{this._addObject(n,t)}),this.norm.clear())}add(n){const t=this.size();ul(n)?this._addString(n,t):this._addObject(n,t)}removeAt(n){this.records.splice(n,1);for(let t=n,r=this.size();t<r;t+=1)this.records[t].i-=1}getValueForItemAtKeyId(n,t){return n[this._keysMap[t]]}size(){return this.records.length}_addString(n,t){if(!es(n)||K0(n))return;let r={v:n,i:t,n:this.norm.get(n)};this.records.push(r)}_addObject(n,t){let r={i:t,$:{}};this.keys.forEach((a,o)=>{let l=a.getFn?a.getFn(n):this.getFn(n,a.path);if(es(l)){if(cc(l)){let h=[];const d=[{nestedArrIndex:-1,value:l}];for(;d.length;){const{nestedArrIndex:u,value:f}=d.pop();if(es(f))if(ul(f)&&!K0(f)){let g={v:f,i:u,n:this.norm.get(f)};h.push(g)}else cc(f)&&f.forEach((g,b)=>{d.push({nestedArrIndex:b,value:g})})}r.$[o]=h}else if(ul(l)&&!K0(l)){let h={v:l,n:this.norm.get(l)};r.$[o]=h}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}}function XT(e,n,{getFn:t=Kt.getFn,fieldNormWeight:r=Kt.fieldNormWeight}={}){const a=new lN({getFn:t,fieldNormWeight:r});return a.setKeys(e.map(KT)),a.setSources(n),a.create(),a}function cie(e,{getFn:n=Kt.getFn,fieldNormWeight:t=Kt.fieldNormWeight}={}){const{keys:r,records:a}=e,o=new lN({getFn:n,fieldNormWeight:t});return o.setKeys(r),o.setIndexRecords(a),o}function Vx(e,{errors:n=0,currentLocation:t=0,expectedLocation:r=0,distance:a=Kt.distance,ignoreLocation:o=Kt.ignoreLocation}={}){const l=n/e.length;if(o)return l;const h=Math.abs(r-t);return a?l+h/a:h?1:l}function uie(e=[],n=Kt.minMatchCharLength){let t=[],r=-1,a=-1,o=0;for(let l=e.length;o<l;o+=1){let h=e[o];h&&r===-1?r=o:!h&&r!==-1&&(a=o-1,a-r+1>=n&&t.push([r,a]),r=-1)}return e[o-1]&&o-r>=n&&t.push([r,o-1]),t}const Od=32;function die(e,n,t,{location:r=Kt.location,distance:a=Kt.distance,threshold:o=Kt.threshold,findAllMatches:l=Kt.findAllMatches,minMatchCharLength:h=Kt.minMatchCharLength,includeMatches:d=Kt.includeMatches,ignoreLocation:u=Kt.ignoreLocation}={}){if(n.length>Od)throw new Error(Xne(Od));const f=n.length,g=e.length,b=Math.max(0,Math.min(r,g));let v=o,S=b;const k=h>1||d,T=k?Array(g):[];let E;for(;(E=e.indexOf(n,S))>-1;){let F=Vx(n,{currentLocation:E,expectedLocation:b,distance:a,ignoreLocation:u});if(v=Math.min(F,v),S=E+f,k){let z=0;for(;z<f;)T[E+z]=1,z+=1}}S=-1;let P=[],I=1,q=f+g;const $=1<<f-1;for(let F=0;F<f;F+=1){let z=0,B=q;for(;z<B;)Vx(n,{errors:F,currentLocation:b+B,expectedLocation:b,distance:a,ignoreLocation:u})<=v?z=B:q=B,B=Math.floor((q-z)/2+z);q=B;let R=Math.max(1,b-B+1),U=l?g:Math.min(b+B,g)+f,Y=Array(U+2);Y[U+1]=(1<<F)-1;for(let ne=U;ne>=R;ne-=1){let ae=ne-1,X=t[e.charAt(ae)];if(k&&(T[ae]=+!!X),Y[ne]=(Y[ne+1]<<1|1)&X,F&&(Y[ne]|=(P[ne+1]|P[ne])<<1|1|P[ne+1]),Y[ne]&$&&(I=Vx(n,{errors:F,currentLocation:ae,expectedLocation:b,distance:a,ignoreLocation:u}),I<=v)){if(v=I,S=ae,S<=b)break;R=Math.max(1,2*b-S)}}if(Vx(n,{errors:F+1,currentLocation:b,expectedLocation:b,distance:a,ignoreLocation:u})>v)break;P=Y}const L={isMatch:S>=0,score:Math.max(.001,I)};if(k){const F=uie(T,h);F.length?d&&(L.indices=F):L.isMatch=!1}return L}function hie(e){let n={};for(let t=0,r=e.length;t<r;t+=1){const a=e.charAt(t);n[a]=(n[a]||0)|1<<r-t-1}return n}const kb=String.prototype.normalize?e=>e.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):e=>e;class ZT{constructor(n,{location:t=Kt.location,threshold:r=Kt.threshold,distance:a=Kt.distance,includeMatches:o=Kt.includeMatches,findAllMatches:l=Kt.findAllMatches,minMatchCharLength:h=Kt.minMatchCharLength,isCaseSensitive:d=Kt.isCaseSensitive,ignoreDiacritics:u=Kt.ignoreDiacritics,ignoreLocation:f=Kt.ignoreLocation}={}){if(this.options={location:t,threshold:r,distance:a,includeMatches:o,findAllMatches:l,minMatchCharLength:h,isCaseSensitive:d,ignoreDiacritics:u,ignoreLocation:f},n=d?n:n.toLowerCase(),n=u?kb(n):n,this.pattern=n,this.chunks=[],!this.pattern.length)return;const g=(v,S)=>{this.chunks.push({pattern:v,alphabet:hie(v),startIndex:S})},b=this.pattern.length;if(b>Od){let v=0;const S=b%Od,k=b-S;for(;v<k;)g(this.pattern.substr(v,Od),v),v+=Od;if(S){const T=b-Od;g(this.pattern.substr(T),T)}}else g(this.pattern,0)}searchIn(n){const{isCaseSensitive:t,ignoreDiacritics:r,includeMatches:a}=this.options;if(n=t?n:n.toLowerCase(),n=r?kb(n):n,this.pattern===n){let k={isMatch:!0,score:0};return a&&(k.indices=[[0,n.length-1]]),k}const{location:o,distance:l,threshold:h,findAllMatches:d,minMatchCharLength:u,ignoreLocation:f}=this.options;let g=[],b=0,v=!1;this.chunks.forEach(({pattern:k,alphabet:T,startIndex:E})=>{const{isMatch:P,score:I,indices:q}=die(n,k,T,{location:o+E,distance:l,threshold:h,findAllMatches:d,minMatchCharLength:u,includeMatches:a,ignoreLocation:f});P&&(v=!0),b+=I,P&&q&&(g=[...g,...q])});let S={isMatch:v,score:v?b/this.chunks.length:1};return v&&a&&(S.indices=g),S}}class wu{constructor(n){this.pattern=n}static isMultiMatch(n){return yC(n,this.multiRegex)}static isSingleMatch(n){return yC(n,this.singleRegex)}search(){}}function yC(e,n){const t=e.match(n);return t?t[1]:null}class fie extends wu{constructor(n){super(n)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(n){const t=n===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class pie extends wu{constructor(n){super(n)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(n){const r=n.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,n.length-1]}}}class mie extends wu{constructor(n){super(n)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(n){const t=n.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class gie extends wu{constructor(n){super(n)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(n){const t=!n.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,n.length-1]}}}class yie extends wu{constructor(n){super(n)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(n){const t=n.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[n.length-this.pattern.length,n.length-1]}}}class xie extends wu{constructor(n){super(n)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(n){const t=!n.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,n.length-1]}}}class eA extends wu{constructor(n,{location:t=Kt.location,threshold:r=Kt.threshold,distance:a=Kt.distance,includeMatches:o=Kt.includeMatches,findAllMatches:l=Kt.findAllMatches,minMatchCharLength:h=Kt.minMatchCharLength,isCaseSensitive:d=Kt.isCaseSensitive,ignoreDiacritics:u=Kt.ignoreDiacritics,ignoreLocation:f=Kt.ignoreLocation}={}){super(n),this._bitapSearch=new ZT(n,{location:t,threshold:r,distance:a,includeMatches:o,findAllMatches:l,minMatchCharLength:h,isCaseSensitive:d,ignoreDiacritics:u,ignoreLocation:f})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(n){return this._bitapSearch.searchIn(n)}}class tA extends wu{constructor(n){super(n)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(n){let t=0,r;const a=[],o=this.pattern.length;for(;(r=n.indexOf(this.pattern,t))>-1;)t=r+o,a.push([r,t-1]);const l=!!a.length;return{isMatch:l,score:l?0:1,indices:a}}}const Z1=[fie,tA,mie,gie,xie,yie,pie,eA],xC=Z1.length,bie=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,vie="|";function wie(e,n={}){return e.split(vie).map(t=>{let r=t.trim().split(bie).filter(o=>o&&!!o.trim()),a=[];for(let o=0,l=r.length;o<l;o+=1){const h=r[o];let d=!1,u=-1;for(;!d&&++u<xC;){const f=Z1[u];let g=f.isMultiMatch(h);g&&(a.push(new f(g,n)),d=!0)}if(!d)for(u=-1;++u<xC;){const f=Z1[u];let g=f.isSingleMatch(h);if(g){a.push(new f(g,n));break}}}return a})}const Nie=new Set([eA.type,tA.type]);class Sie{constructor(n,{isCaseSensitive:t=Kt.isCaseSensitive,ignoreDiacritics:r=Kt.ignoreDiacritics,includeMatches:a=Kt.includeMatches,minMatchCharLength:o=Kt.minMatchCharLength,ignoreLocation:l=Kt.ignoreLocation,findAllMatches:h=Kt.findAllMatches,location:d=Kt.location,threshold:u=Kt.threshold,distance:f=Kt.distance}={}){this.query=null,this.options={isCaseSensitive:t,ignoreDiacritics:r,includeMatches:a,minMatchCharLength:o,findAllMatches:h,ignoreLocation:l,location:d,threshold:u,distance:f},n=t?n:n.toLowerCase(),n=r?kb(n):n,this.pattern=n,this.query=wie(this.pattern,this.options)}static condition(n,t){return t.useExtendedSearch}searchIn(n){const t=this.query;if(!t)return{isMatch:!1,score:1};const{includeMatches:r,isCaseSensitive:a,ignoreDiacritics:o}=this.options;n=a?n:n.toLowerCase(),n=o?kb(n):n;let l=0,h=[],d=0;for(let u=0,f=t.length;u<f;u+=1){const g=t[u];h.length=0,l=0;for(let b=0,v=g.length;b<v;b+=1){const S=g[b],{isMatch:k,indices:T,score:E}=S.search(n);if(k){if(l+=1,d+=E,r){const P=S.constructor.type;Nie.has(P)?h=[...h,...T]:h.push(T)}}else{d=0,l=0,h.length=0;break}}if(l){let b={isMatch:!0,score:d/l};return r&&(b.indices=h),b}}return{isMatch:!1,score:1}}}const ew=[];function jie(...e){ew.push(...e)}function tw(e,n){for(let t=0,r=ew.length;t<r;t+=1){let a=ew[t];if(a.condition(e,n))return new a(e,n)}return new ZT(e,n)}const Eb={AND:"$and",OR:"$or"},nw={PATH:"$path",PATTERN:"$val"},iw=e=>!!(e[Eb.AND]||e[Eb.OR]),_ie=e=>!!e[nw.PATH],Cie=e=>!cc(e)&&QT(e)&&!iw(e),bC=e=>({[Eb.AND]:Object.keys(e).map(n=>({[n]:e[n]}))});function nA(e,n,{auto:t=!0}={}){const r=a=>{let o=Object.keys(a);const l=_ie(a);if(!l&&o.length>1&&!iw(a))return r(bC(a));if(Cie(a)){const d=l?a[nw.PATH]:o[0],u=l?a[nw.PATTERN]:a[d];if(!ul(u))throw new Error(Kne(d));const f={keyId:X1(d),pattern:u};return t&&(f.searcher=tw(u,n)),f}let h={children:[],operator:o[0]};return o.forEach(d=>{const u=a[d];cc(u)&&u.forEach(f=>{h.children.push(r(f))})}),h};return iw(e)||(e=bC(e)),r(e)}function kie(e,{ignoreFieldNorm:n=Kt.ignoreFieldNorm}){e.forEach(t=>{let r=1;t.matches.forEach(({key:a,norm:o,score:l})=>{const h=a?a.weight:null;r*=Math.pow(l===0&&h?Number.EPSILON:l,(h||1)*(n?1:o))}),t.score=r})}function Eie(e,n){const t=e.matches;n.matches=[],es(t)&&t.forEach(r=>{if(!es(r.indices)||!r.indices.length)return;const{indices:a,value:o}=r;let l={indices:a,value:o};r.key&&(l.key=r.key.src),r.idx>-1&&(l.refIndex=r.idx),n.matches.push(l)})}function Tie(e,n){n.score=e.score}function Aie(e,n,{includeMatches:t=Kt.includeMatches,includeScore:r=Kt.includeScore}={}){const a=[];return t&&a.push(Eie),r&&a.push(Tie),e.map(o=>{const{idx:l}=o,h={item:n[l],refIndex:l};return a.length&&a.forEach(d=>{d(o,h)}),h})}class ap{constructor(n,t={},r){this.options={...Kt,...t},this.options.useExtendedSearch,this._keyStore=new tie(this.options.keys),this.setCollection(n,r)}setCollection(n,t){if(this._docs=n,t&&!(t instanceof lN))throw new Error(Jne);this._myIndex=t||XT(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(n){es(n)&&(this._docs.push(n),this._myIndex.add(n))}remove(n=()=>!1){const t=[];for(let r=0,a=this._docs.length;r<a;r+=1){const o=this._docs[r];n(o,r)&&(this.removeAt(r),r-=1,a-=1,t.push(o))}return t}removeAt(n){this._docs.splice(n,1),this._myIndex.removeAt(n)}getIndex(){return this._myIndex}search(n,{limit:t=-1}={}){const{includeMatches:r,includeScore:a,shouldSort:o,sortFn:l,ignoreFieldNorm:h}=this.options;let d=ul(n)?ul(this._docs[0])?this._searchStringList(n):this._searchObjectList(n):this._searchLogical(n);return kie(d,{ignoreFieldNorm:h}),o&&d.sort(l),WT(t)&&t>-1&&(d=d.slice(0,t)),Aie(d,this._docs,{includeMatches:r,includeScore:a})}_searchStringList(n){const t=tw(n,this.options),{records:r}=this._myIndex,a=[];return r.forEach(({v:o,i:l,n:h})=>{if(!es(o))return;const{isMatch:d,score:u,indices:f}=t.searchIn(o);d&&a.push({item:o,idx:l,matches:[{score:u,value:o,norm:h,indices:f}]})}),a}_searchLogical(n){const t=nA(n,this.options),r=(h,d,u)=>{if(!h.children){const{keyId:g,searcher:b}=h,v=this._findMatches({key:this._keyStore.get(g),value:this._myIndex.getValueForItemAtKeyId(d,g),searcher:b});return v&&v.length?[{idx:u,item:d,matches:v}]:[]}const f=[];for(let g=0,b=h.children.length;g<b;g+=1){const v=h.children[g],S=r(v,d,u);if(S.length)f.push(...S);else if(h.operator===Eb.AND)return[]}return f},a=this._myIndex.records,o={},l=[];return a.forEach(({$:h,i:d})=>{if(es(h)){let u=r(t,h,d);u.length&&(o[d]||(o[d]={idx:d,item:h,matches:[]},l.push(o[d])),u.forEach(({matches:f})=>{o[d].matches.push(...f)}))}}),l}_searchObjectList(n){const t=tw(n,this.options),{keys:r,records:a}=this._myIndex,o=[];return a.forEach(({$:l,i:h})=>{if(!es(l))return;let d=[];r.forEach((u,f)=>{d.push(...this._findMatches({key:u,value:l[f],searcher:t}))}),d.length&&o.push({idx:h,item:l,matches:d})}),o}_findMatches({key:n,value:t,searcher:r}){if(!es(t))return[];let a=[];if(cc(t))t.forEach(({v:o,i:l,n:h})=>{if(!es(o))return;const{isMatch:d,score:u,indices:f}=r.searchIn(o);d&&a.push({score:u,key:n,value:o,idx:l,norm:h,indices:f})});else{const{v:o,n:l}=t,{isMatch:h,score:d,indices:u}=r.searchIn(o);h&&a.push({score:d,key:n,value:o,norm:l,indices:u})}return a}}ap.version="7.1.0";ap.createIndex=XT;ap.parseIndex=cie;ap.config=Kt;ap.parseQuery=nA;jie(Sie);const Die="_modalOverlay_qkqmh_1",Pie="_modalContent_qkqmh_45",Iie="_modalHeader_qkqmh_99",Mie="_modalTitle_qkqmh_119",Rie="_modalCloseButton_qkqmh_141",Oie="_modalBody_qkqmh_179",Lie="_itemCard_qkqmh_199",Fie="_highConfidence_qkqmh_225",$ie="_mediumConfidence_qkqmh_235",zie="_lowConfidence_qkqmh_245",Bie="_itemLabel_qkqmh_255",Uie="_itemName_qkqmh_273",qie="_itemQty_qkqmh_285",Vie="_statusIcon_qkqmh_299",Hie="_searchContainer_qkqmh_319",Gie="_searchWrapper_qkqmh_327",Yie="_searchInput_qkqmh_357",Wie="_searchResults_qkqmh_377",Qie="_searchItem_qkqmh_405",Jie="_matchedItemInfo_qkqmh_427",Kie="_errorText_qkqmh_453",Xie="_modalFooter_qkqmh_465",Zie="_btn_qkqmh_485",ere="_btnSecondary_qkqmh_509",tre="_btnPrimary_qkqmh_529",si={modalOverlay:Die,modalContent:Pie,modalHeader:Iie,modalTitle:Mie,modalCloseButton:Rie,modalBody:Oie,itemCard:Lie,highConfidence:Fie,mediumConfidence:$ie,lowConfidence:zie,itemLabel:Bie,itemName:Uie,itemQty:qie,statusIcon:Vie,searchContainer:Hie,searchWrapper:Gie,searchInput:Yie,searchResults:Wie,searchItem:Qie,matchedItemInfo:Jie,errorText:Kie,modalFooter:Xie,btn:Zie,btnSecondary:ere,btnPrimary:tre},nre=({isOpen:e,onClose:n,recurringItems:t,inventory:r,onCreateOrder:a})=>{const[o,l]=w.useState([]),[h,d]=w.useState(""),[u,f]=w.useState(null),[g,b]=w.useState([]),v=w.useMemo(()=>new ap(r,{keys:["name","composition"],threshold:.4,includeScore:!0}),[r]);w.useEffect(()=>{if(e&&t.length>0&&r.length>0){const E=t.map(P=>{const I=v.search(P.name);let q=null,$="none";if(I.length>0){q=I[0].item;const L=I[0].score||1;L<.1?$="high":L<.4?$="medium":$="low"}return{original:P,matchedDrug:q,confidence:$}});l(E)}},[e,t,r,v]),w.useEffect(()=>{if(h){const E=v.search(h).map(P=>P.item);b(E.slice(0,10))}else b([])},[h,v]);const S=(E,P)=>{l(I=>{const q=[...I];return q[E]={...q[E],matchedDrug:P,confidence:"high"},q}),f(null),d("")},k=()=>{const E=o.filter(P=>P.matchedDrug).map(P=>{const I=Number(P.matchedDrug.price),q=T(P.matchedDrug.unit),$=I/(q||1),L=P.original.pack_quantity||0,F=P.original.loose_quantity||0,z=L*I+F*$;return{drug_id:P.matchedDrug.id,name:P.matchedDrug.name,pack_quantity:L,loose_quantity:F,pack_price:I,loose_price:$,total_price:z,unit:P.matchedDrug.unit,tabletsPerDay:P.original.tabletsPerDay,numberOfDays:P.original.numberOfDays,directions_to_use:P.original.directions_to_use}});a(E)},T=E=>{if(!E)return 1;const P=E.match(/(?:\d+x)?(\d+)/);return P?parseInt(P[1],10):1};return e?i.jsx("div",{className:si.modalOverlay,children:i.jsxs("div",{className:si.modalContent,children:[i.jsxs("div",{className:si.modalHeader,children:[i.jsx("h2",{className:si.modalTitle,children:"Review Recurring Items"}),i.jsx("button",{onClick:n,className:si.modalCloseButton,title:"Close",children:i.jsx(In,{size:24})})]}),i.jsx("div",{className:si.modalBody,children:i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:o.map((E,P)=>i.jsxs("div",{className:`${si.itemCard} ${E.confidence==="high"?si.highConfidence:E.confidence==="medium"?si.mediumConfidence:si.lowConfidence}`,children:[i.jsxs("div",{children:[i.jsx("p",{className:si.itemLabel,children:"Recurring Item"}),i.jsx("p",{className:si.itemName,children:E.original.name}),i.jsxs("p",{className:si.itemQty,children:["Qty: ",E.original.pack_quantity?`${E.original.pack_quantity} packs`:"",E.original.loose_quantity?` ${E.original.loose_quantity} loose`:""]})]}),i.jsx("div",{className:si.statusIcon,children:E.confidence==="high"?i.jsx(Ds,{size:20,style:{color:"#22c55e"}}):i.jsx(ZC,{size:20,style:{color:"#eab308"}})}),i.jsxs("div",{className:si.searchContainer,children:[i.jsx("p",{className:si.itemLabel,children:"Matched Inventory"}),u===P?i.jsxs("div",{className:si.searchContainer,children:[i.jsxs("div",{className:si.searchWrapper,children:[i.jsx(Ai,{size:16,style:{color:"#9ca3af"}}),i.jsx("input",{type:"text",value:h,onChange:I=>d(I.target.value),placeholder:"Search inventory...",className:si.searchInput,autoFocus:!0}),i.jsx("button",{onClick:()=>f(null),style:{background:"none",border:"none",cursor:"pointer",color:"#9ca3af"},children:i.jsx(In,{size:16})})]}),g.length>0&&i.jsx("div",{className:si.searchResults,children:g.map(I=>i.jsxs("div",{onClick:()=>S(P,I),className:si.searchItem,children:[i.jsx("div",{style:{fontWeight:600,fontSize:"0.875rem"},children:I.name}),i.jsxs("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:["Stock: ",I.quantity_in_stock," | ",I.price]})]},I.id))})]}):i.jsx("div",{onClick:()=>{f(P),d("")},className:si.matchedItemInfo,children:E.matchedDrug?i.jsxs("div",{children:[i.jsx("p",{style:{fontWeight:700,color:"var(--heading-color)"},children:E.matchedDrug.name}),i.jsxs("p",{style:{fontSize:"0.75rem",color:"var(--secondary-text-color)"},children:["Stock: ",E.matchedDrug.quantity_in_stock," | ",E.matchedDrug.price]})]}):i.jsx("p",{className:si.errorText,children:"No match found. Click to search."})})]})]},P))})}),i.jsxs("div",{className:si.modalFooter,children:[i.jsx("button",{onClick:n,className:`${si.btn} ${si.btnSecondary}`,children:"Cancel"}),i.jsxs("button",{onClick:k,disabled:o.some(E=>!E.matchedDrug),className:`${si.btn} ${si.btnPrimary}`,children:[i.jsx(Ds,{size:18}),"Create Order"]})]})]})}):null},X0=15,vC=()=>{const[e,n]=w.useState([]),[t,r]=w.useState(!0),[a,o]=w.useState(null),[l,h]=w.useState(!1),[d,u]=w.useState(!1),[f,g]=w.useState(null),[b,v]=w.useState([]),[S,k]=w.useState(null),[T,E]=w.useState(30),P=Ot(),[I,q]=w.useState(""),[$,L]=w.useState(""),[F,z]=w.useState(1),[B,R]=w.useState(1),[U,Y]=w.useState(0),[Z,ne]=w.useState("next_delivery_date"),[ae,X]=w.useState("asc"),[W,H]=w.useState("");w.useEffect(()=>{const fe=setTimeout(()=>{L(I),z(1)},500);return()=>{clearTimeout(fe)}},[I]);const he=w.useCallback(async(fe,pe,Re,Ye,ut)=>{r(!0),o(null);try{const Ge=new URLSearchParams({page:fe.toString(),limit:X0.toString(),sortBy:Re,sortOrder:Ye});pe&&Ge.append("search",pe),ut&&Ge.append("status",ut);const Se=await de(`/api/recurring-medications?${Ge.toString()}`);if(!Se.ok){const Ue=await Se.json().catch(()=>({}));throw new Error(Ue.message||"Failed to fetch recurring medications")}const qe=await Se.json();n(qe.recurringMedications),Y(qe.totalCount),z(qe.currentPage),R(qe.totalPages)}catch(Ge){o(Ge.message),n([]),Y(0),z(1),R(1)}finally{r(!1)}},[]),D=async()=>{try{const fe=await de("/api/drugs");if(fe.ok){const pe=await fe.json();v(pe)}}catch(fe){console.error("Failed to fetch inventory:",fe)}};w.useEffect(()=>{he(F,$,Z,ae,W),D()},[F,$,Z,ae,W,he]);const te=fe=>{const pe=Z===fe&&ae==="asc"?"desc":"asc";ne(fe),X(pe),z(1)},ve=async(fe,pe)=>{try{if(!(await de(`/api/recurring-medications/${fe}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:pe})})).ok)throw new Error("Failed to update status");he(F,$,Z,ae,W)}catch(Re){alert(`Error updating status: ${Re.message}`)}},M=(fe,pe)=>{k(fe),E(pe)},ge=async fe=>{if(T<1||T>365){alert("Frequency must be between 1 and 365 days");return}try{const pe=await de(`/api/recurring-medications/${fe}/frequency`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({frequency_days:T})});if(!pe.ok){const Re=await pe.json().catch(()=>({}));throw new Error(Re.message||"Failed to update frequency")}k(null),he(F,$,Z,ae,W)}catch(pe){alert(`Error updating frequency: ${pe.message}`)}},_e=()=>{k(null)},se=fe=>{g(fe),h(!0),u(!1)},ee=fe=>{g(fe),u(!0),h(!1)},oe=fe=>{he(F,$,Z,ae,W)},ue=async fe=>{if(f)try{const pe={patient_id:f.patient_id,items:fe,prescription_for_unavailable_drugs:"",status:"pending",date:new Date().toISOString(),order_total:fe.reduce((Ye,ut)=>Ye+(ut.total_price||ut.pack_quantity*ut.pack_price+ut.loose_quantity*ut.loose_price),0),recurring_medication_id:f.id},Re=await de("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(pe)});if(!Re.ok){const Ye=await Re.json().catch(()=>({}));throw new Error(Ye.message||"Failed to create order")}alert("Order created successfully!"),h(!1),g(null),he(F,$,Z,ae,W)}catch(pe){alert(`Failed to create order: ${pe.message}`)}},Ee=(fe,pe)=>{const Re=pe.map(Ye=>({name:Ye.name,pack_quantity:Ye.pack_quantity,loose_quantity:Ye.loose_quantity,price:Ye.price,pack_price:Ye.pack_price,loose_price:Ye.loose_price,total_price:Number(Ye.total_price)||0,isLoose:Ye.isLoose,unit:Ye.unit,drug_id:Ye.drug_id?String(Ye.drug_id):null,tabletsPerDay:Ye.tabletsPerDay,numberOfDays:Ye.numberOfDays,directions_to_use:Ye.directions_to_use,discount_percentage:Ye.discount_percentage??0,batch:Ye.batch,expiry_date:Ye.expiry_date}));P(`/dashboard/pharmacy-billing/${fe}`,{state:{initialItems:Re}})},Ie=async(fe,pe)=>{try{const Re=await de(`/api/pharmacy-orders/${fe}`);if(!Re.ok)throw new Error("Failed to fetch order details");const Ye=await Re.json(),ut={status:pe,medications:Ye.medications},Ge=await de(`/api/pharmacy-orders/${fe}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ut)});if(!Ge.ok){const Se=await Ge.text();throw new Error(`Failed to update status: ${Ge.statusText} (${Ge.status}) - ${Se}`)}he(F,$,Z,ae,W),alert(`Order marked as ${pe} successfully!`)}catch(Re){console.error("Failed to update order status:",Re),alert(`Error updating status: ${Re.message}`)}};return i.jsxs("div",{className:"recurring-medications-page-container",children:[i.jsxs("div",{className:"recurring-medications-header",children:[i.jsxs("div",{className:"recurring-medications-header-left",children:[i.jsxs("button",{onClick:()=>P(-1),className:"recurring-medications-button recurring-medications-button-back",children:[i.jsx(on,{size:20}),"Back"]}),i.jsx("h1",{className:"recurring-medications-page-title",children:"Recurring Medications"})]}),i.jsxs("div",{className:"recurring-medications-header-controls",children:[i.jsxs("div",{className:"search-wrapper",children:[i.jsx(Ai,{size:18,className:"search-icon"}),i.jsx("input",{type:"text",placeholder:"Search patients...",value:I,onChange:fe=>q(fe.target.value)})]}),i.jsxs("div",{className:"filter-wrapper",children:[i.jsx(YC,{size:18,className:"filter-icon"}),i.jsxs("select",{id:"statusFilter",value:W,onChange:fe=>H(fe.target.value),children:[i.jsx("option",{value:"",children:"All Status"}),i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"paused",children:"Paused"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),i.jsxs("button",{onClick:()=>he(F,$,Z,ae,W),className:"recurring-medications-button recurring-medications-button-primary refresh-button",title:"Refresh Data",children:[i.jsx(sc,{size:18}),i.jsx("span",{children:"Refresh"})]})]})]}),i.jsxs("div",{className:"recurring-medications-summary-bar",children:[!t&&U>0&&i.jsxs("div",{className:"summary-text",children:["Found ",i.jsx("span",{className:"highlight-count",children:U})," recurring medication",U!==1?"s":"",($||W)&&" matching criteria"]}),!t&&e.length>0&&i.jsxs("div",{className:"header-stats",children:[i.jsxs("div",{className:"stat-item",children:[i.jsx("span",{className:"stat-dot active"}),i.jsxs("span",{children:["Active: ",i.jsx("span",{className:"stat-value",children:e.filter(fe=>fe.status==="active").length})]})]}),i.jsxs("div",{className:"stat-item",children:[i.jsx("span",{className:"stat-dot paused"}),i.jsxs("span",{children:["Paused: ",i.jsx("span",{className:"stat-value",children:e.filter(fe=>fe.status==="paused").length})]})]}),i.jsxs("div",{className:"stat-item",children:[i.jsx("span",{className:"stat-dot cancelled"}),i.jsxs("span",{children:["Cancelled: ",i.jsx("span",{className:"stat-value",children:e.filter(fe=>fe.status==="cancelled").length})]})]})]})]}),i.jsxs("div",{className:"recurring-medications-content-box",children:[a&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"1rem 1.25rem",backgroundColor:"#fee2e2",border:"2px solid #fca5a5",borderRadius:"0.75rem",color:"#991b1b",marginBottom:"1.5rem",boxShadow:"0 2px 4px rgba(239, 68, 68, 0.1)"},children:[i.jsx(ui,{size:24,style:{flexShrink:0}}),i.jsxs("div",{children:[i.jsx("p",{style:{fontWeight:600,marginBottom:"0.25rem"},children:"Error Loading Data"}),i.jsx("p",{style:{fontSize:"0.875rem",margin:0},children:a})]})]}),t?i.jsx("div",{className:"recurring-medications-table-container",children:i.jsxs("table",{className:"recurring-medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Name"}),i.jsx("th",{children:"Medications"}),i.jsx("th",{children:"Next Delivery"}),i.jsx("th",{children:"Frequency"}),i.jsx("th",{children:"Status"}),i.jsx("th",{children:"Last Order"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:[...Array(5)].map((fe,pe)=>i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{className:"skeleton skeleton-title"}),i.jsx("div",{className:"skeleton skeleton-text"})]}),i.jsxs("td",{children:[i.jsx("div",{className:"skeleton skeleton-text"}),i.jsx("div",{className:"skeleton skeleton-text"})]}),i.jsx("td",{children:i.jsx("div",{className:"skeleton skeleton-text",style:{width:"4rem"}})}),i.jsx("td",{children:i.jsx("div",{className:"skeleton skeleton-text",style:{width:"6rem"}})}),i.jsx("td",{children:i.jsx("div",{className:"skeleton skeleton-badge"})}),i.jsx("td",{children:i.jsx("div",{className:"skeleton skeleton-text"})}),i.jsx("td",{children:i.jsx("div",{className:"skeleton skeleton-text",style:{width:"3rem"}})})]},pe))})]})}):e.length===0?i.jsxs("div",{style:{textAlign:"center",padding:"4rem 2rem",background:"linear-gradient(135deg, #f9fafb 0%, #ffffff 100%)",borderRadius:"1rem",border:"2px dashed #d1d5db",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:[i.jsx("div",{style:{width:"4rem",height:"4rem",margin:"0 auto 1.5rem",borderRadius:"50%",background:"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx(ui,{size:32,style:{color:"#3b82f6"}})}),i.jsx("p",{style:{color:"#1f2937",fontSize:"1.125rem",fontWeight:600,marginBottom:"0.5rem"},children:$||W?"No matches found":"No recurring medications"}),i.jsx("p",{style:{color:"#6b7280",fontSize:"0.95rem"},children:$||W?"Try adjusting your search or filter criteria":"Recurring medications will appear here once created"})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"recurring-medications-table-container",children:i.jsxs("table",{className:"recurring-medications-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[i.jsxs("div",{className:"sortable-header",onClick:()=>te("patient_name"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"0.25rem"},children:[i.jsx("span",{children:"Name"}),Z==="patient_name"&&(ae==="asc"?i.jsx(co,{size:12}):i.jsx(du,{size:12}))]}),i.jsxs("div",{style:{display:"flex",gap:"0.5rem",fontSize:"0.75rem",color:"#6b7280"},children:[i.jsxs("div",{className:"sortable-header",onClick:()=>te("patient_phone"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"0.25rem"},children:[i.jsx("span",{children:"Phone"}),Z==="patient_phone"&&(ae==="asc"?i.jsx(co,{size:10}):i.jsx(du,{size:10}))]}),i.jsx("span",{children:"|"}),i.jsxs("div",{className:"sortable-header",onClick:()=>te("patient_token"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"0.25rem"},children:[i.jsx("span",{children:"Token"}),Z==="patient_token"&&(ae==="asc"?i.jsx(co,{size:10}):i.jsx(du,{size:10}))]})]})]})}),i.jsx("th",{children:"Medications"}),i.jsxs("th",{className:"sortable-header",onClick:()=>te("next_delivery_date"),style:{cursor:"pointer",userSelect:"none"},children:["Next Delivery",Z==="next_delivery_date"&&(ae==="asc"?i.jsx(co,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}):i.jsx(du,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}))]}),i.jsxs("th",{className:"sortable-header",onClick:()=>te("frequency_days"),style:{cursor:"pointer",userSelect:"none"},children:["Frequency",Z==="frequency_days"&&(ae==="asc"?i.jsx(co,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}):i.jsx(du,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}))]}),i.jsxs("th",{className:"sortable-header",onClick:()=>te("status"),style:{cursor:"pointer",userSelect:"none"},children:["Status",Z==="status"&&(ae==="asc"?i.jsx(co,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}):i.jsx(du,{size:14,style:{display:"inline",marginLeft:"0.25rem"}}))]}),i.jsx("th",{children:"Last Order"}),i.jsx("th",{children:"Actions"})]})}),i.jsx("tbody",{children:e.map(fe=>i.jsxs("tr",{children:[i.jsxs("td",{children:[i.jsx("div",{style:{fontWeight:500,color:"#1f2937"},children:fe.patient_name}),i.jsx("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:fe.patient_phone}),i.jsxs("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:["Token: ",fe.patient_token]})]}),i.jsx("td",{children:i.jsx("div",{className:"med-list-compact",children:fe.medications.map((pe,Re)=>i.jsxs("div",{className:"med-item-compact",children:[i.jsxs("div",{className:"med-name-primary",children:[pe.name,i.jsxs("span",{style:{fontSize:"0.75rem",fontWeight:400,color:"#64748b",marginLeft:"0.25rem"},children:["(",pe.pack_quantity?`${pe.pack_quantity}p`:"",pe.pack_quantity&&pe.loose_quantity?" + ":"",pe.loose_quantity?`${pe.loose_quantity}l`:"",")"]})]}),i.jsxs("div",{className:"med-details-secondary",children:[pe.tabletsPerDay&&pe.numberOfDays?`${pe.tabletsPerDay} tab/day for ${pe.numberOfDays} days`:"",pe.directions_to_use&&`  ${pe.directions_to_use}`]})]},Re))})}),i.jsx("td",{children:i.jsx("div",{style:{fontSize:"0.875rem"},children:new Date(fe.next_delivery_date).toLocaleDateString()})}),i.jsx("td",{children:S===fe.id?i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.jsx("input",{type:"number",min:"1",max:"365",value:T,onChange:pe=>E(parseInt(pe.target.value,10)||1),style:{width:"4rem",padding:"0.25rem 0.5rem",border:"2px solid #6d28d9",borderRadius:"0.375rem",fontSize:"0.875rem",outline:"none"},autoFocus:!0,onKeyDown:pe=>{pe.key==="Enter"&&ge(fe.id),pe.key==="Escape"&&_e()}}),i.jsx("span",{style:{fontSize:"0.875rem",color:"#4b5563"},children:"days"}),i.jsx("button",{onClick:()=>ge(fe.id),style:{padding:"0.25rem 0.5rem",backgroundColor:"#22c55e",color:"white",border:"none",borderRadius:"0.375rem",cursor:"pointer",fontSize:"0.75rem",fontWeight:600},title:"Save (Enter)",children:""}),i.jsx("button",{onClick:_e,style:{padding:"0.25rem 0.5rem",backgroundColor:"#ef4444",color:"white",border:"none",borderRadius:"0.375rem",cursor:"pointer",fontSize:"0.75rem",fontWeight:600},title:"Cancel (Esc)",children:""})]}):i.jsxs("div",{onClick:()=>M(fe.id,fe.frequency_days||30),style:{fontSize:"0.875rem",color:"#4b5563",cursor:"pointer",padding:"0.25rem 0.5rem",borderRadius:"0.375rem",transition:"all 0.2s ease",display:"inline-block"},onMouseEnter:pe=>{pe.currentTarget.style.backgroundColor="#f3f4f6",pe.currentTarget.style.color="#6d28d9"},onMouseLeave:pe=>{pe.currentTarget.style.backgroundColor="transparent",pe.currentTarget.style.color="#4b5563"},title:"Click to edit frequency",children:["Every ",fe.frequency_days||30," days "]})}),i.jsx("td",{children:i.jsxs("span",{className:`status-badge ${fe.status}`,children:[fe.status==="active"&&i.jsx(Ea,{size:10}),fe.status==="paused"&&i.jsx(sc,{size:10}),fe.status==="cancelled"&&i.jsx(ui,{size:10}),fe.status]})}),i.jsx("td",{children:fe.last_order?i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[i.jsxs("div",{style:{fontSize:"0.875rem"},children:[i.jsx("span",{style:{fontWeight:500},children:"Status: "}),i.jsx("span",{className:`status-badge ${fe.last_order.status}`,children:fe.last_order.status})]}),i.jsx("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:new Date(fe.last_order.date).toLocaleDateString()}),i.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[fe.last_order.status==="pending"&&i.jsxs("button",{onClick:()=>Ee(fe.last_order.id,fe.medications),className:"small-action-button bill",children:[i.jsx(Mf,{size:12})," Bill"]}),fe.last_order.status==="billed"&&i.jsxs("button",{onClick:()=>Ie(fe.last_order.id,"dispensed"),className:"small-action-button dispense",children:[i.jsx(ho,{size:12})," Dispense"]}),fe.last_order.status==="dispensed"&&i.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem",color:"#16a34a"},children:[i.jsx(Ea,{size:12})," Complete"]})]})]}):i.jsx("span",{style:{fontSize:"0.875rem",color:"#9ca3af"},children:"No recent order"})}),i.jsx("td",{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[i.jsxs("select",{value:fe.status,onChange:pe=>ve(fe.id,pe.target.value),style:{fontSize:"0.875rem",borderColor:"#d1d5db",borderRadius:"0.375rem",padding:"0.25rem 0.5rem"},children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"paused",children:"Paused"}),i.jsx("option",{value:"cancelled",children:"Cancelled"})]}),i.jsx("button",{onClick:()=>ee(fe),className:"action-button",title:"Edit Recurring Medication",style:{color:"#6d28d9"},children:i.jsx($d,{size:18})}),i.jsx("button",{onClick:()=>se(fe),className:"action-button",title:"Create Order",children:i.jsx(XC,{size:18})})]})})]},fe.id))})]})}),B>1&&i.jsxs("div",{className:"pagination-controls",children:[i.jsxs("div",{className:"pagination-info",children:["Showing ",i.jsx("span",{children:(F-1)*X0+1})," to ",i.jsx("span",{children:Math.min(F*X0,U)})," of ",i.jsx("span",{children:U})," results"]}),i.jsxs("div",{className:"pagination-buttons",children:[i.jsxs("button",{onClick:()=>z(fe=>Math.max(fe-1,1)),disabled:F===1||t,className:"pagination-button",children:[i.jsx(Pb,{size:14}),"Previous"]}),i.jsxs("div",{className:"pagination-page-info",children:["Page ",i.jsx("span",{children:F})," of ",i.jsx("span",{children:B})]}),i.jsxs("button",{onClick:()=>z(fe=>Math.min(fe+1,B)),disabled:F===B||t,className:"pagination-button",children:["Next",i.jsx(bg,{size:14})]})]})]})]})]}),f&&i.jsx(nre,{isOpen:l,onClose:()=>{h(!1),g(null)},recurringItems:f.medications,inventory:b,onCreateOrder:ue}),f&&i.jsx(AE,{isOpen:d,onClose:()=>{u(!1),g(null)},recurringMedication:f,onUpdate:oe,inventory:b})]})},ire="_overlay_ezztw_1",rre="_content_ezztw_45",are="_header_ezztw_101",sre="_searchBar_ezztw_111",ore="_searchIcon_ezztw_151",lre="_input_ezztw_169",cre="_results_ezztw_205",ure="_list_ezztw_215",dre="_listItem_ezztw_227",hre="_selected_ezztw_257",fre="_iconWrapper_ezztw_279",pre="_linkName_ezztw_315",mre="_arrowIcon_ezztw_327",gre="_noResults_ezztw_353",Sa={overlay:ire,content:rre,header:are,searchBar:sre,searchIcon:ore,input:lre,results:cre,list:ure,listItem:dre,selected:hre,iconWrapper:fre,linkName:pre,arrowIcon:mre,noResults:gre},yre=({isOpen:e,onClose:n,userRole:t})=>{const[r,a]=w.useState(""),[o,l]=w.useState(0),h=Ot(),d=w.useRef(null),u=w.useMemo(()=>(hw[t]||[]).flatMap(S=>S.links),[t]),f=w.useMemo(()=>r?u.filter(v=>v.name.toLowerCase().includes(r.toLowerCase())):[],[r,u]);w.useEffect(()=>{e&&(a(""),l(0),setTimeout(()=>{var v;return(v=d.current)==null?void 0:v.focus()},50))},[e]),w.useEffect(()=>{l(0)},[r]);const g=v=>{v.key==="ArrowDown"?(v.preventDefault(),l(S=>S<f.length-1?S+1:S)):v.key==="ArrowUp"?(v.preventDefault(),l(S=>S>0?S-1:S)):v.key==="Enter"&&f[o]?b(f[o].path):v.key==="Escape"&&n()},b=v=>{h(v),n()};return e?i.jsx("div",{className:Sa.overlay,onClick:n,children:i.jsxs("div",{className:Sa.content,onClick:v=>v.stopPropagation(),children:[i.jsx("div",{className:Sa.header,children:i.jsxs("div",{className:Sa.searchBar,children:[i.jsx(Ai,{size:20,className:Sa.searchIcon}),i.jsx("input",{ref:d,type:"text",placeholder:"Where would you like to go?",className:Sa.input,value:r,onChange:v=>a(v.target.value),onKeyDown:g})]})}),i.jsx("div",{className:Sa.results,children:f.length>0?i.jsx("ul",{className:Sa.list,children:f.map((v,S)=>{const k=v.icon||FP;return i.jsxs("li",{onClick:()=>b(v.path),className:`${Sa.listItem} ${S===o?Sa.selected:""}`,onMouseEnter:()=>l(S),children:[i.jsx("div",{className:Sa.iconWrapper,children:i.jsx(k,{size:18})}),i.jsx("span",{className:Sa.linkName,children:v.name}),S===o&&i.jsx(wI,{size:14,className:Sa.arrowIcon})]},v.path)})}):r&&i.jsxs("div",{className:Sa.noResults,children:[i.jsxs("p",{children:['No pages found matching "',r,'"']}),i.jsx("span",{className:"text-sm opacity-50",children:"Try searching for something else"})]})})]})}):null};function xre(){const[e,n]=w.useState(!1),[t,r]=w.useState(null),[a,o]=w.useState(!0),[l,h]=w.useState(null),[d,u]=w.useState(!1),f=P=>{r(P),n(!0),P.role==="admin"&&!P.has_seen_tutorial&&u(!0)},g=()=>{n(!1),r(null),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")};w.useEffect(()=>{const P=localStorage.getItem("authToken"),I=localStorage.getItem("currentUser");if(P&&I)try{const q=JSON.parse(I);r(q),n(!0),q.role==="admin"&&!q.has_seen_tutorial&&u(!0)}catch(q){console.error("Error parsing stored user data:",q),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")}o(!1)},[]),w.useEffect(()=>{(async()=>{if(e&&t)try{const I=await Sk();h(I)}catch(I){console.error("Error fetching clinic pro plan status:",I),h({hasProPlan:!1})}else h(null)})()},[e,t]);const[b,v]=w.useState(null),[S,k]=w.useState(!1);w.useEffect(()=>{const P=I=>{I.preventDefault(),v(I),k(!0),console.log("beforeinstallprompt event fired")};return window.addEventListener("beforeinstallprompt",P),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&(console.log("App is already installed (standalone)."),k(!1)),()=>{window.removeEventListener("beforeinstallprompt",P)}},[]),w.useEffect(()=>{const P=window.matchMedia("(prefers-color-scheme: dark)"),I=()=>{P.matches?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")};return I(),P.addEventListener("change",I),()=>{P.removeEventListener("change",I),document.body.classList.remove("dark-mode")}},[]);const T=w.useCallback(async()=>{if(!b){console.log("Install prompt event not available.");return}const P=b;P.prompt();const{outcome:I}=await P.userChoice;console.log(`User response to the install prompt: ${I}`),v(null),k(!1)},[b]),E=async()=>{if(t)try{(await de(`/api/users/${t.id}/tutorial-seen`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({has_seen_tutorial:!0})})).ok?(r(I=>I?{...I,has_seen_tutorial:!0}:null),localStorage.setItem("currentUser",JSON.stringify({...t,has_seen_tutorial:!0})),u(!1)):console.error("Failed to update tutorial status on backend.")}catch(P){console.error("Error marking tutorial as seen:",P)}};return a?i.jsx("div",{className:"initial-app-loading-screen",children:i.jsx("img",{src:"/logo.png",alt:"Loading App",className:"initial-app-loader-logo"})}):i.jsxs(nP,{children:[i.jsx(fP,{children:i.jsxs(kf,{children:[i.jsx(Nt,{path:"/login",element:e?i.jsx($n,{to:"/dashboard"}):i.jsx(yP,{onLoginSuccess:f})}),i.jsx(Nt,{path:"/register",element:e?i.jsx($n,{to:"/dashboard"}):i.jsx(xP,{})}),i.jsx(Nt,{path:"/handle-complaint-url",element:e?i.jsx(Lne,{}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/live-api",element:e?i.jsx(EH,{}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/create-lab-order",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(NE,{currentUser:t})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/manage-admission",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(vE,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/lab/report/:orderId",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(uC,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/lab/enter-report/:orderId",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(uC,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/dashboard/add-patient",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(O1,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/billing",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(dte,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/lab-billing",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(fte,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/dashboard/edit-complaint/:recordId",element:e&&t?i.jsx(lte,{}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/dashboard/edit-pharmacy-order/:orderId",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(PT,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/dashboard/*",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:bre(t.role,t,de)}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/lab/view-report/:orderId",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Zte,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/lab/search-report",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(ene,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/patient/:patientId/lab-reports",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(tne,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/patient/:patientId/pharmacy-orders",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(pte,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/inventory",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(MT,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/lab-inventory",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Jb,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/patient/:patientId/complaints",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(cte,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/patient/:patientId/admission-bill/:billId",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(ane,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/start-subscription/:patientId",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Cne,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/start-clinic-subscription",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Ane,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/refill-reminders",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(YT,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/dashboard/notifications",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Fne,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/create-custom-bill",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(wE,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/dashboard/pharmacy-billing/:orderId",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Vne,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"/dashboard/bills/:billId",element:e&&t?i.jsx(Ei,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:i.jsx(Hne,{})}):i.jsx($n,{to:"/login"})}),i.jsx(Nt,{path:"*",element:i.jsx($n,{to:e?"/dashboard":"/login"})})]})}),d&&i.jsx(Rne,{onClose:()=>u(!1),onMarkAsSeen:E})]})}const bre=(e,n,t)=>{switch(e){case"superadmin":return i.jsxs(kf,{children:[i.jsx(Nt,{index:!0,element:i.jsx(Pne,{})}),i.jsx(Nt,{path:"clinic-subscriptions",element:i.jsx(kne,{})}),i.jsx(Nt,{path:"clinic-subscriptions/add",element:i.jsx(Ene,{})}),i.jsx(Nt,{path:"clinic-subscriptions/edit/:id",element:i.jsx(Tne,{})}),i.jsx(Nt,{path:"users",element:i.jsx(Dne,{})})," ",i.jsx(Nt,{path:"*",element:i.jsx("div",{children:"Unknown Super Admin Section"})})]});case"admin":return i.jsxs(kf,{children:[i.jsx(Nt,{index:!0,element:i.jsx(LH,{fetchWithAuth:t})}),i.jsx(Nt,{path:"clinic-hub",element:i.jsx(bE,{fetchWithAuth:t})}),i.jsx(Nt,{path:"staff/add",element:i.jsx(fY,{clinicId:n==null?void 0:n.clinic_id})}),i.jsx(Nt,{path:"staff/edit/:id",element:i.jsx(pY,{})}),i.jsx(Nt,{path:"patients/add",element:i.jsx(O1,{})}),i.jsx(Nt,{path:"search-patient",element:i.jsx(Pf,{})}),i.jsx(Nt,{path:"patients",element:i.jsx(M1,{})}),i.jsx(Nt,{path:"analysis",element:i.jsx(Nk,{})}),i.jsx(Nt,{path:"inventory",element:i.jsx(rne,{})}),i.jsx(Nt,{path:"inventory/edit/:id",element:i.jsx(hY,{})}),i.jsx(Nt,{path:"recurring-medications",element:i.jsx(vC,{})}),i.jsx(Nt,{path:"distributors",element:i.jsx(fC,{})}),i.jsx(Nt,{path:"purchase",element:i.jsx(pC,{})})," ",i.jsx(Nt,{path:"queue",element:i.jsx(D0,{})}),i.jsx(Nt,{path:"subscriptions",element:i.jsx(Sne,{})}),i.jsx(Nt,{path:"subscriptions/add",element:i.jsx(jne,{})}),i.jsx(Nt,{path:"subscriptions/edit/:id",element:i.jsx(_ne,{})}),i.jsx(Nt,{path:"add-pharmacy-order",element:i.jsx(oC,{})}),i.jsx(Nt,{path:"*",element:i.jsx("div",{children:"Unknown Admin Section"})})," "]});case"doctor":return i.jsxs(kf,{children:[i.jsx(Nt,{index:!0,element:i.jsx($n,{to:"search-patient",replace:!0})}),i.jsx(Nt,{path:"search-patient",element:i.jsx(Pf,{})}),i.jsx(Nt,{path:"queue",element:i.jsx(D0,{})}),i.jsx(Nt,{path:":patientId",element:i.jsx(D0,{})}),i.jsx(Nt,{path:"add-patient",element:i.jsx(O1,{})}),i.jsx(Nt,{path:"*",element:i.jsx("div",{children:"Unknown Doctor Section"})})]});case"receptionist":return i.jsxs(kf,{children:[i.jsx(Nt,{index:!0,element:i.jsx(zH,{currentUser:n})}),i.jsx(Nt,{path:"all-patients",element:i.jsx(M1,{})}),i.jsx(Nt,{path:"search-patient",element:i.jsx(Pf,{})}),i.jsx(Nt,{path:"*",element:i.jsx("div",{children:"Unknown Reception Section"})})," "]});case"lab":return i.jsx(cY,{});case"pharmacy":return i.jsxs(kf,{children:[i.jsx(Nt,{index:!0,element:i.jsx(uY,{})}),i.jsx(Nt,{path:"inventory",element:i.jsx(MT,{})}),i.jsx(Nt,{path:"settings",element:i.jsx(dY,{})}),i.jsx(Nt,{path:"add-order",element:i.jsx(oC,{})}),i.jsx(Nt,{path:"edit-pharmacy-order/:orderId",element:i.jsx(PT,{})}),i.jsx(Nt,{path:"analysis",element:i.jsx(Vte,{})}),i.jsx(Nt,{path:"orders/:orderId",element:i.jsx(gne,{})}),i.jsx(Nt,{path:"search-patient-records",element:i.jsx(Pf,{})}),i.jsx(Nt,{path:"recurring-medications",element:i.jsx(vC,{})}),i.jsx(Nt,{path:"distributors",element:i.jsx(fC,{})}),i.jsx(Nt,{path:"purchase",element:i.jsx(pC,{})})," ",i.jsx(Nt,{path:"refill-reminders",element:i.jsx(YT,{})})," ",i.jsx(Nt,{path:"*",element:i.jsx($n,{to:"/dashboard",replace:!0})})]});default:return i.jsxs("div",{children:["Unknown role (",e,") or dashboard not implemented."]},e)}},Ei=({user:e,onLogout:n,children:t,showInstallPrompt:r,onInstallClick:a,clinicProPlanStatus:o})=>{const l=Ot(),[h,d]=w.useState(!1),[u,f]=w.useState(!1),[g,b]=w.useState(window.innerWidth<=768),[v,S]=w.useState(!1),[k,T]=w.useState([]),[E,P]=w.useState(0),[I,q]=w.useState(!1),[$,L]=w.useState("Newtons Ai"),[F,z]=w.useState(null),[B,R]=w.useState(!1),U=w.useRef(null);w.useEffect(()=>{const H=()=>{b(window.innerWidth<=768)};return window.addEventListener("resize",H),()=>window.removeEventListener("resize",H)},[]),w.useEffect(()=>lo.subscribe(he=>{R(he)}),[]);const Y=w.useCallback(async()=>{try{const H=await de("/api/notifications");if(H.ok){const te=(await H.json()).reduce((ve,M)=>{const ge=ve.find(_e=>_e.message===M.message);return ge?new Date(M.created_at)>new Date(ge.created_at)?ve.map(_e=>_e.message===M.message?M:_e):ve:[...ve,M]},[]).sort((ve,M)=>{const ge={expired_drug:1,near_expiry_drug:2,low_stock:3},_e=ge[ve.type]||99,se=ge[M.type]||99;return _e!==se?_e-se:new Date(M.created_at).getTime()-new Date(ve.created_at).getTime()});T(te),P(te.filter(ve=>!ve.is_read).length)}else console.error("Failed to fetch notifications:",H.statusText)}catch(H){console.error("Error fetching notifications:",H)}},[]);w.useEffect(()=>{(async()=>{if(e!=null&&e.clinic_id)try{const he=await de("/api/clinics/settings");if(he.ok){const D=await he.json();D.name===""?L("Newtons Ai"):L(D.name),z(D.logoUrl)}else console.error("Failed to fetch clinic details for display:",he.statusText),L("Newtons Ai"),z(null)}catch(he){console.error("Error fetching clinic details for display:",he),L("Newtons Ai"),z(null)}else L("Newtons Ai"),z(null)})()},[e==null?void 0:e.clinic_id]),w.useEffect(()=>{if(e!=null&&e.clinic_id){Y();const H=setInterval(Y,5*60*1e3);return()=>clearInterval(H)}},[e==null?void 0:e.clinic_id,Y]);const Z=()=>{d(!h),h||(f(!1),S(!1))},ne=()=>{f(!u),u||(d(!1),S(!1))},ae=()=>{S(!v),v||(d(!1),f(!1))};w.useEffect(()=>{const H=he=>{U.current&&!U.current.contains(he.target)&&v&&S(!1)};return v&&document.addEventListener("mousedown",H),()=>{document.removeEventListener("mousedown",H)}},[v]);const X=async H=>{try{const he=await de(`/api/notifications/${H}/read`,{method:"PUT"});he.ok?Y():console.error("Failed to mark notification as read:",he.statusText)}catch(he){console.error("Error marking notification as read:",he)}},W=async()=>{q(!0);try{const H=await de("/api/notifications/trigger-all",{method:"POST"});H.ok?(console.log("Notification checks triggered successfully."),await Y()):console.error("Failed to trigger notification checks:",H.statusText)}catch(H){console.error("Error triggering notification checks:",H)}finally{q(!1)}};return i.jsxs("div",{className:"dashboard-layout",children:[" ",i.jsxs("nav",{className:"app-header no-print",children:[i.jsxs("div",{className:"header-left",children:[g&&B?i.jsx("div",{className:"global-loading-indicator",title:"Loading...",children:i.jsx("div",{className:"spinner"})}):i.jsx("a",{href:"#",onClick:H=>{H.preventDefault(),l("/dashboard")},className:"logo-container",children:i.jsx("img",{src:F||"/logo.png",alt:"App Logo",className:"logo-image"})}),i.jsxs("div",{className:"title-section",children:[i.jsx("span",{className:"app-title-link",children:$}),i.jsxs("span",{className:"user-role-panel",children:["(",e.role.charAt(0).toUpperCase()+e.role.slice(1)," Panel)"]})]})]}),i.jsxs("div",{className:"header-right",children:[!g&&B&&i.jsx("div",{className:"global-loading-indicator",title:"Loading...",children:i.jsx("div",{className:"spinner"})}),r&&i.jsxs("button",{onClick:a,className:"install-button",title:"Install App",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),i.jsx("span",{children:"Install"})]}),o&&(o.hasProPlan?i.jsx("span",{className:"pro-badge",children:"PRO"}):i.jsx("button",{onClick:()=>l("/start-clinic-subscription"),className:"go-pro-button",children:"GoPro"})),!g&&i.jsx("button",{className:"header-search-button",onClick:ne,"aria-label":"Search pages",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),i.jsxs("div",{className:"notifications-section",ref:U,children:[" ",i.jsxs("button",{className:`notification-icon ${E>0?"pulse-animation":""}`,"aria-label":`Notifications, ${E} unread`,onClick:ae,children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),E>0&&i.jsx("span",{className:"notification-count","aria-hidden":"true",children:E})]}),v&&i.jsxs("div",{className:"notifications-dropdown",children:[i.jsx("div",{className:"dropdown-header",children:"Notifications"}),i.jsx("ul",{className:"dropdown-list",children:k.length>0?k.map(H=>i.jsx("li",{className:`dropdown-item ${H.is_read?"read":"unread"}`,onClick:()=>X(H.id),children:i.jsxs("div",{className:"notification-item-content",children:[i.jsxs("div",{className:"notification-icon-wrapper",children:[H.type==="expired_drug"&&i.jsx("svg",{className:"type-icon error",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),H.type==="near_expiry_drug"&&i.jsx("svg",{className:"type-icon warning",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),H.type==="low_stock"&&i.jsx("svg",{className:"type-icon info",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),!["expired_drug","near_expiry_drug","low_stock"].includes(H.type)&&i.jsx("svg",{className:"type-icon default",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),i.jsxs("div",{className:"notification-text-wrapper",children:[i.jsx("p",{className:"notification-message-text",children:H.message}),i.jsx("span",{className:"notification-timestamp",children:new Date(H.created_at).toLocaleString()})]})]})},H.id)):i.jsx("li",{className:"dropdown-item",children:"No new notifications"})}),i.jsxs("div",{className:"dropdown-footer",children:[i.jsx("button",{onClick:()=>l("/dashboard/notifications"),children:"View All"}),(e.role==="admin"||e.role==="superadmin")&&i.jsx("button",{onClick:W,className:"fetch-all-button",disabled:I,children:I?"Fetching...":"Fetch All"})]})]})]}),i.jsx("button",{className:"hamburger-icon",onClick:Z,"aria-label":"Open navigation",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})})]})]}),i.jsx("main",{className:"main-content",children:t}),g?i.jsx(EP,{user:e,onLogout:n,userRole:e.role,isOpen:h,onClose:Z,roleNavigation:hw}):i.jsx(kP,{user:e,onLogout:n,userRole:e.role,isOpen:h,onClose:Z}),!g&&h&&i.jsx("div",{className:"side-panel-overlay",onClick:Z}),i.jsx(yre,{isOpen:u,onClose:()=>f(!1),userRole:e.role})]})};OA.createRoot(document.getElementById("root")).render(i.jsx(w.StrictMode,{children:i.jsx(FA,{clientId:"277898779560-33obduhn8r758rini4qagetdrupvisri.apps.googleusercontent.com",children:i.jsx(xre,{})})}));
